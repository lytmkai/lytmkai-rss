<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[åˆ¨æ ¹é—®åº•æ ç›®ç»„ - å­¦ä¹  Zustand çš„å¹¿æ’­å“²å­¦]]></title>    <link>https://juejin.cn/post/7587965908287946762</link>    <guid>https://juejin.cn/post/7587965908287946762</guid>    <pubDate>2025-12-26T08:58:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587965908287946762" data-draft-id="7587965800272396314" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆ¨æ ¹é—®åº•æ ç›®ç»„ - å­¦ä¹  Zustand çš„å¹¿æ’­å“²å­¦"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-26T08:58:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ¸…é£ä¹é¸£"/> <meta itemprop="url" content="https://juejin.cn/user/4300945220723917"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆ¨æ ¹é—®åº•æ ç›®ç»„ - å­¦ä¹  Zustand çš„å¹¿æ’­å“²å­¦
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4300945220723917/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ¸…é£ä¹é¸£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T08:58:44.000Z" title="Fri Dec 26 2025 08:58:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><p>åœ¨å‰ç«¯çŠ¶æ€ç®¡ç†çš„å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸å¬åˆ°â€œå‘å¸ƒè®¢é˜…æ¨¡å¼â€ã€â€œè§‚å¯Ÿè€…æ¨¡å¼â€ç­‰æœ¯è¯­ã€‚æœ¬æ–‡å°†ä»ä¸€æ¬¡æ„å¤–çš„â€œæ— é™å¾ªç¯â€æŠ¥é”™å¼€å§‹ï¼Œé€šè¿‡å¯¹æ¯” EventBus å’Œ Zustand çš„åº•å±‚å·®å¼‚ï¼Œæ·±å…¥å‰–æ Zustand é‚£ä¸ªç®€å•å´ç²¾å¦™çš„å¹¿æ’­æœºåˆ¶ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ å¼•å­ï¼šä¸€æ¬¡æ„æƒ³ä¸åˆ°çš„æ­»å¾ªç¯</h2>
<p>æ•…äº‹å§‹äºä¸€è¡Œçœ‹ä¼¼æ— å®³çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ğŸ˜± å¯¼è‡´æŠ¥é”™çš„ä»£ç </span>
<span class="hljs-keyword">const</span> obj = <span class="hljs-title function_">useMyStore</span>(<span class="hljs-function">(<span class="hljs-params">s</span>) =&gt;</span> ({ <span class="hljs-attr">count</span>: s.<span class="hljs-property">count</span>, <span class="hljs-attr">text</span>: s.<span class="hljs-property">text</span> }), shallowEqual);
</code></pre>
<p><strong>ç°è±¡</strong>ï¼šé¡µé¢æŠ¥é”™ <code>Maximum update depth exceeded</code>ã€‚</p>
<p><strong>åŸå› </strong>ï¼š</p>
<p>React çš„ <code>useSyncExternalStore</code> ä¾èµ– <strong>å¼•ç”¨ç¨³å®šæ€§</strong> æ¥åˆ¤æ–­æ˜¯å¦åœæ­¢æ›´æ–°ã€‚</p>
<p>å½“ Selector è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡ <code>{ ... }</code> æ—¶ï¼Œå³ä½¿å†…å®¹æ²¡å˜ï¼Œå¼•ç”¨çš„å†…å­˜åœ°å€ä¹Ÿå˜äº†ã€‚React è®¤ä¸ºçŠ¶æ€å˜äº† - é‡æ–°æ¸²æŸ“ - å†æ¬¡è°ƒç”¨ selector ç”Ÿæˆæ–°å¯¹è±¡ - å†æ¬¡è®¤ä¸ºå˜äº† - <strong>æ­»å¾ªç¯</strong>ã€‚</p>
<p>è¿™å¼•å‡ºäº†æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæ€è€ƒï¼š<strong>Zustand çš„é€šçŸ¥æœºåˆ¶åˆ°åº•æœ‰å¤šâ€œå‚»â€ï¼Ÿå®ƒä¸ºä»€ä¹ˆä¸å¸®æˆ‘è¿‡æ»¤æ‰è¿™äº›æ²¡ç”¨çš„æ›´æ–°ï¼Ÿ</strong></p>
<hr/>
<h2 data-id="heading-1">äºŒã€ å¹¿æ’­çš„ä¸¤ç§æµæ´¾ï¼šEventBus vs Zustand</h2>
<p>ä¸ºäº†ç†è§£ Zustand çš„è¡Œä¸ºï¼Œæˆ‘ä»¬éœ€è¦æŠŠå®ƒå’Œæˆ‘ä»¬ç†Ÿæ‚‰çš„ EventBusï¼ˆäº‹ä»¶æ€»çº¿ï¼‰åšä¸€ä¸ªå¯¹æ¯”ã€‚</p>
<h3 data-id="heading-2">1. EventBusï¼šç²¾å‡†æŠ•é€’çš„â€œå¹¿æ’­ç«™â€</h3>
<p>EventBus çš„æ ¸å¿ƒæ•°æ®ç»“æ„é€šå¸¸æ˜¯ <strong>Map</strong>ã€‚</p>
<ul>
<li>
<p><strong>ç»“æ„</strong>ï¼š<code>Map&lt;EventName, Array&lt;Callback&gt;&gt;</code></p>
</li>
<li>
<p><strong>å“²å­¦</strong>ï¼š<strong>åˆ†é¢‘é“</strong>ã€‚</p>
</li>
<li>
<p><strong>åœºæ™¯</strong>ï¼šåŠ¨ä½œé©±åŠ¨ï¼ˆAction-drivenï¼‰ã€‚æ¯”å¦‚â€œç‚¹å‡»ä¿å­˜â€ã€â€œè¯·æ±‚å¤±è´¥â€ã€‚</p>
</li>
<li>
<p><strong>æµç¨‹</strong>ï¼š</p>
</li>
</ul>
<ol>
<li>
<p><strong>è®¢é˜…</strong>ï¼š<code>key = 'login_success'</code>ï¼ŒæŠŠæˆ‘åŠ åˆ°è¿™ä¸ª key çš„åˆ—è¡¨é‡Œã€‚</p>
</li>
<li>
<p><strong>æŸ¥æ‰¾</strong>ï¼šè§¦å‘æ—¶ï¼Œå…ˆé€šè¿‡ key å» Map é‡ŒæŸ¥è¡¨ã€‚</p>
</li>
<li>
<p><strong>æ‰§è¡Œ</strong>ï¼šåªé€šçŸ¥å…³æ³¨è¿™ä¸ª key çš„äººã€‚</p>
</li>
</ol>
<h3 data-id="heading-3">2. Zustandï¼šå…¨å‘˜å¹¿æ’­çš„â€œç­çº§é»‘æ¿â€</h3>
<p>Zustand çš„æ ¸å¿ƒæ•°æ®ç»“æ„æ˜¯ <strong>Set</strong>ã€‚</p>
<ul>
<li>
<p><strong>ç»“æ„</strong>ï¼š<code>Set&lt;Callback&gt;</code></p>
</li>
<li>
<p><strong>å“²å­¦</strong>ï¼š<strong>å•ä¸€ä¿¡æºï¼ˆSingle Source of Truthï¼‰</strong>ã€‚</p>
</li>
<li>
<p><strong>åœºæ™¯</strong>ï¼šæ•°æ®é©±åŠ¨ï¼ˆData-drivenï¼‰ã€‚æ¯”å¦‚â€œç”¨æˆ·ä¿¡æ¯æ›´æ–°â€ã€â€œè®¡æ•°å™¨å˜åŒ–â€ã€‚</p>
</li>
<li>
<p><strong>æµç¨‹</strong>ï¼š</p>
</li>
</ul>
<ol>
<li>
<p><strong>è®¢é˜…</strong>ï¼šä¸ç®¡ä½ å…³å¿ƒå•¥ï¼Œå…ˆæŠŠä½ çš„åå­—åŠ åˆ°åå•é‡Œã€‚</p>
</li>
<li>
<p><strong>æŸ¥æ‰¾</strong>ï¼š<strong>ä¸éœ€è¦æŸ¥æ‰¾</strong>ã€‚</p>
</li>
<li>
<p><strong>æ‰§è¡Œ</strong>ï¼šæ•°æ®ä¸€å˜ï¼Œç›´æ¥éå† Setï¼Œé€šçŸ¥<strong>æ‰€æœ‰äºº</strong>ã€‚</p>
</li>
</ol>
<p><strong>å…³é”®åŒºåˆ«</strong>ï¼š</p>
<blockquote>
<p><strong>Map å¤©ç„¶è´´åˆâ€œé¢‘é“â€åŒºåˆ†ï¼ˆKVç»“æ„ï¼‰ï¼Œè€Œ Set å¤©ç„¶è´´åˆ forEach å¾ªç¯ï¼ˆé›†åˆç»“æ„ï¼‰ã€‚</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-4">ä¸‰ã€ æ·±å…¥è™ç©´ï¼šZustand æ˜¯å¦‚ä½•â€œè¿½åŠ ç›‘å¬â€çš„ï¼Ÿ</h2>
<p>æˆ‘ä»¬å¯ä»¥å‰¥ç¦» Reactï¼Œç”¨çº¯ JS è¿˜åŸ Zustand åœ¨ <code>subscribe</code> æ—¶åšçš„äº‹æƒ…ã€‚å®ƒå°±åƒä¸€ä¸ªè´Ÿè´£çš„é‚®å±€ã€‚</p>
<h3 data-id="heading-5">æ¨¡æ‹Ÿå®ç°</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// 1. è¿™æ˜¯ä¸€ä¸ªæå…¶è¿·ä½ çš„ Store</span>
<span class="hljs-keyword">const</span> store = {
  <span class="hljs-comment">// è¿™æ˜¯é‚£ä¸ªåå•æœ¬å­ (Set)</span>
  <span class="hljs-attr">listeners</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>(),

  <span class="hljs-comment">// âœ¨é‡ç‚¹åœ¨è¿™é‡Œï¼šè®¢é˜…å‡½æ•°âœ¨</span>
  <span class="hljs-attr">subscribe</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">callback</span>) {
    <span class="hljs-comment">// åŠ¨ä½œï¼šæŠŠä½ ä¼ è¿›æ¥çš„å‡½æ•°ï¼ˆè”ç³»æ–¹å¼ï¼‰ï¼ŒåŠ åˆ°æœ¬å­ä¸Š</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">add</span>(callback);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`âœ… æˆåŠŸè¿½åŠ ä¸€ä¸ªç›‘å¬ï¼ç°åœ¨åå•é‡Œæœ‰ <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.listeners.size}</span> ä¸ªäººã€‚`</span>);
    
    <span class="hljs-comment">// è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥å–æ¶ˆè®¢é˜…ï¼ˆä»¥åå†è¯´ï¼‰</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">delete</span>(callback);
  },

  <span class="hljs-comment">// å‡è£…æ•°æ®å˜äº†ï¼Œé€šçŸ¥å¤§å®¶</span>
  <span class="hljs-attr">setState</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ğŸ“¢ åªæœ‰ä¸€ä»¶äº‹ï¼šæ•°æ®å˜äº†ï¼å¼€å§‹æŒ¨ä¸ªé€šçŸ¥..."</span>);
    <span class="hljs-comment">// éå† Setï¼Œæ‰§è¡Œæ¯ä¸ªå‡½æ•°</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">run</span> =&gt;</span> <span class="hljs-title function_">run</span>());
  }
};

<span class="hljs-comment">// ==========================================</span>
<span class="hljs-comment">// åœºæ™¯å¼€å§‹ï¼šä¸¤ä¸ªâ€œç»„ä»¶â€æ¥è®¢é˜…äº†</span>
<span class="hljs-comment">// ==========================================</span>

<span class="hljs-comment">// æ¨¡æ‹Ÿç»„ä»¶ Aï¼ˆæ¯”å¦‚æ˜¯é¡µé¢é¡¶éƒ¨çš„ Headerï¼‰</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">componentA_Update</span> = (<span class="hljs-params"/>) =&gt; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"   -&gt; ç»„ä»¶Aæ”¶åˆ°é€šçŸ¥ï¼šæˆ‘è¦æ£€æŸ¥ä¸‹ç”¨æˆ·åå˜æ²¡å˜"</span>);

<span class="hljs-comment">// æ¨¡æ‹Ÿç»„ä»¶ Bï¼ˆæ¯”å¦‚æ˜¯é¡µé¢åº•éƒ¨çš„ Footerï¼‰</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">componentB_Update</span> = (<span class="hljs-params"/>) =&gt; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"   -&gt; ç»„ä»¶Bæ”¶åˆ°é€šçŸ¥ï¼šæˆ‘è¦æ£€æŸ¥ä¸‹ç‰ˆæƒå¹´ä»½å˜æ²¡å˜"</span>);

<span class="hljs-comment">// åŠ¨ä½œ 1ï¼šç»„ä»¶ A å‡ºç”Ÿäº†ï¼Œè¯·æ±‚è®¢é˜…</span>
store.<span class="hljs-title function_">subscribe</span>(componentA_Update);
<span class="hljs-comment">// ğŸ‘‰ ç»“æœï¼šSet å†…éƒ¨ç°åœ¨æ˜¯ { componentA_Update }</span>

<span class="hljs-comment">// åŠ¨ä½œ 2ï¼šç»„ä»¶ B å‡ºç”Ÿäº†ï¼Œè¯·æ±‚è®¢é˜…</span>
store.<span class="hljs-title function_">subscribe</span>(componentB_Update);
<span class="hljs-comment">// ğŸ‘‰ ç»“æœï¼šSet å†…éƒ¨ç°åœ¨æ˜¯ { componentA_Update, componentB_Update }</span>

<span class="hljs-comment">// ==========================================</span>
<span class="hljs-comment">// åŠ¨ä½œ 3ï¼šæ•°æ®å˜äº†ï¼</span>
<span class="hljs-comment">// ==========================================</span>
store.<span class="hljs-title function_">setState</span>();
</code></pre>
<p>å½“ä½ è°ƒç”¨ <code>store.subscribe(fn)</code> æ—¶ï¼ŒZustand çœŸçš„åªæ˜¯ç®€å•åœ°æŠŠ <code>fn</code> æ‰”è¿›äº†é‚£ä¸ª <code>Set</code> é‡Œã€‚å¦‚æœæœ‰ 100 ä¸ªç»„ä»¶è®¢é˜…ï¼Œ<code>Set</code> é‡Œå°±æœ‰ 100 ä¸ªå‡½æ•°ã€‚</p>
<hr/>
<h2 data-id="heading-6">å››ã€ React æ˜¯ä½•æ—¶ä»‹å…¥çš„ï¼Ÿ</h2>
<p>ä½ å¯èƒ½ä¼šé—®ï¼šâ€œæˆ‘å†™ç»„ä»¶æ—¶åªç”¨äº† hooksï¼Œæ²¡å†™ subscribe å•Šï¼Ÿâ€</p>
<p>ç­”æ¡ˆæ˜¯ï¼š<strong>Hooks å¸®ä½ åšäº†è„æ´»ç´¯æ´»ã€‚</strong></p>
<p>å½“ä½ åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ <code>useStore</code> æ—¶ï¼Œå¹•åå‘ç”Ÿçš„è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p><strong>ç»„ä»¶æŒ‚è½½ (Mount)</strong>ï¼šç»„ä»¶åˆå§‹åŒ–ã€‚</p>
</li>
<li>
<p><strong>è‡ªåŠ¨è¿çº¿</strong>ï¼šReact çš„ <code>useSyncExternalStore</code> å†…éƒ¨ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª <code>forceUpdate</code> å‡½æ•°ï¼Œå¹¶è°ƒç”¨ <code>store.subscribe(forceUpdate)</code>ã€‚</p>
</li>
<li>
<p><strong>ç™»è®°åœ¨å†Œ</strong>ï¼šæ­¤æ—¶ï¼ŒStore çš„ <code>Set</code> é‡Œå¤šäº†ä¸€ä¸ªå±äºè¯¥ç»„ä»¶çš„ç›‘å¬å™¨ã€‚</p>
</li>
</ol>
<h3 data-id="heading-7"><code>useSyncExternalStore</code>å†…éƒ¨åˆ°åº•å¹²äº†å•¥</h3>
<p><strong>ä½œç”¨</strong>ï¼šå®‰å…¨åœ°å°†Reactç»„ä»¶é“¾æ¥åˆ°å¤–éƒ¨çŠ¶æ€ç®¡ç†åº“ï¼ˆå¦‚Reduxã€Zustandã€æµè§ˆå™¨storageï¼‰ï¼Œè§£å†³å¹¶å‘æ¸²æŸ“ä¸‹çš„æ’•è£‚é—®é¢˜</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">function</span> <span class="hljs-title function_">useSyncExternalStore</span>(<span class="hljs-params">subscribe, getSnapshot</span>) {
  <span class="hljs-keyword">const</span> [state, setState] = <span class="hljs-title function_">useState</span>(<span class="hljs-title function_">getSnapshot</span>());
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleStoreChange</span> = (<span class="hljs-params"/>) =&gt; {
      <span class="hljs-title function_">setState</span>(<span class="hljs-title function_">getSnapshot</span>());
    };
    
    <span class="hljs-comment">// 1. è®¢é˜…çŠ¶æ€å˜åŒ–ï¼ˆè¿”å›æ¸…ç†å‡½æ•°ï¼‰</span>
    <span class="hljs-keyword">const</span> unsubscribe = <span class="hljs-title function_">subscribe</span>(handleStoreChange);
    
    <span class="hljs-comment">// 2. è¿”å›æ¸…ç†å‡½æ•°ï¼ˆç»„ä»¶å¸è½½æ—¶æ‰§è¡Œï¼‰</span>
    <span class="hljs-keyword">return</span> unsubscribe;
  }, [subscribe, getSnapshot]);

  <span class="hljs-keyword">return</span> state;
}
</code></pre>
<p>å¯è§ï¼Œå½“æˆ‘ä»¬åœ¨ç»„ä»¶å†…éƒ¨è°ƒç”¨useStoreæ—¶ï¼Œå…¶å†…éƒ¨çš„useSyncExternalStoreæ–¹æ³•å·²ç»è‡ªåŠ¨ä¸ºæˆ‘ä»¬å®Œæˆäº†æ³¨å†Œå’Œè®¢é˜…çš„è¿‡ç¨‹ã€‚</p>
<h3 data-id="heading-8">é€šçŸ¥çš„è¿‡ç¨‹ï¼ˆä¸ºä»€ä¹ˆæ­»å¾ªç¯å‘ç”Ÿåœ¨è¿™é‡Œï¼‰</h3>
<p>å½“ <code>store.setState</code> å‘ç”Ÿæ—¶ï¼š</p>
<ol>
<li>
<p><strong>Zustand</strong>ï¼šéå† <code>Set</code>ï¼Œè§¦å‘æ‰€æœ‰ç»„ä»¶çš„æ£€æŸ¥å‡½æ•°ã€‚</p>
</li>
<li>
<p><strong>React (æ£€æŸ¥å‡½æ•°)</strong>ï¼šè¿è¡Œä½ çš„ Selector <code>s =&gt; ({ ... })</code>ã€‚</p>
</li>
<li>
<p><strong>æ¯”å¯¹</strong>ï¼š</p>
</li>
</ol>
<ul>
<li>
<p><strong>æ—§å€¼</strong>ï¼šä¸Šä¸€æ¬¡æ¸²æŸ“æ—¶çš„å¯¹è±¡ã€‚</p>
</li>
<li>
<p><strong>æ–°å€¼</strong>ï¼šSelector åˆšåˆšç”Ÿæˆçš„<strong>æ–°å¯¹è±¡</strong>ã€‚</p>
</li>
</ul>
<ol start="4">
<li><strong>æ‚²å‰§å‘ç”Ÿ</strong>ï¼šå¦‚æœæ˜¯å¼•ç”¨æ¯”è¾ƒï¼Œ<code>æ–°å¯¹è±¡ !== æ—§å¯¹è±¡</code>ï¼ŒReact åˆ¤å®šå¿…é¡»æ›´æ–°ã€‚ç»„ä»¶é‡æ–°æ¸²æŸ“ -&gt; å†æ¬¡ç”Ÿæˆæ–°å¯¹è±¡ -&gt; å†æ¬¡æ›´æ–° -&gt; <strong>Loop</strong>ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-9">äº”ã€ æ€»ç»“ï¼šå¤§æ™ºè‹¥æ„šçš„å¹¿æ’­å“²å­¦</h2>
<p>Zustand çš„è®¾è®¡å“²å­¦å¯ä»¥æ€»ç»“ä¸ºï¼š<strong>â€œå¤§å–‡å­é€šçŸ¥ + æ­¤æ—¶æ— å£°èƒœæœ‰å£°â€</strong>ã€‚</p>
<ul>
<li>
<p><strong>Store (å‘å¸ƒè€…)</strong>ï¼šæˆ‘å¾ˆæ‡’ï¼Œæˆ‘ä¸çŸ¥é“ä½ ä»¬è°å…³å¿ƒ <code>count</code>ï¼Œè°å…³å¿ƒ <code>name</code>ã€‚åæ­£æ•°æ®å˜äº†ï¼Œæˆ‘å°±å–Šä¸€å£°â€œå˜å¤©å•¦ï¼â€ã€‚</p>
</li>
<li>
<p><strong>Component (è®¢é˜…è€…)</strong>ï¼šæˆ‘å¾ˆå‹¤å¿«ã€‚å¬åˆ°â€œå˜å¤©å•¦â€ä¹‹åï¼Œæˆ‘å…ˆæ‹¿ Selector çœ‹çœ‹â€œæˆ‘çœ‹çš„é‚£å—äº‘å½©â€å˜æ²¡å˜ã€‚å¦‚æœæ²¡å˜ï¼Œæˆ‘å°±æ¥ç€ç¡ï¼›å¦‚æœå˜äº†ï¼Œæˆ‘æ‰èµ·åºŠå¹²æ´»ã€‚</p>
</li>
</ul>
<p>è¿™ç§æœºåˆ¶çœ‹ä¼¼â€œç²—æš´â€ï¼Œå®åˆ™<strong>è§£è€¦</strong>ã€‚Store ä¸å†ç»´æŠ¤å¤æ‚çš„äº‹ä»¶æ˜ å°„å…³ç³»ï¼Œè€Œæ˜¯æŠŠâ€œè¿‡æ»¤â€çš„æƒåŠ›ä¸‹æ”¾ç»™äº†æ¯ä¸ªç»„ä»¶ï¼ˆSelectorï¼‰ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ Selector çš„ç¨³å®šæ€§ï¼ˆå¦‚ä½¿ç”¨ <code>shallowEqual</code> æˆ–ç¼“å­˜ï¼‰å¦‚æ­¤é‡è¦çš„åŸå› ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å½“ Web Worker é‡ä¸Šå¼‚æ­¥ï¼Œå¦‚ä½•çªç ´å•çº¿ç¨‹é™åˆ¶ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7587998744294064134</link>    <guid>https://juejin.cn/post/7587998744294064134</guid>    <pubDate>2025-12-26T08:46:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587998744294064134" data-draft-id="7587785079739219974" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å½“ Web Worker é‡ä¸Šå¼‚æ­¥ï¼Œå¦‚ä½•çªç ´å•çº¿ç¨‹é™åˆ¶ï¼Ÿ"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2025-12-26T08:46:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ•²ä»£ç çš„ç‹¬è§’å…½"/> <meta itemprop="url" content="https://juejin.cn/user/729731452897246"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å½“ Web Worker é‡ä¸Šå¼‚æ­¥ï¼Œå¦‚ä½•çªç ´å•çº¿ç¨‹é™åˆ¶ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/729731452897246/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ•²ä»£ç çš„ç‹¬è§’å…½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T08:46:30.000Z" title="Fri Dec 26 2025 08:46:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å½“ä½ çš„å‰ç«¯åº”ç”¨éœ€è¦å¤„ç†100MBçš„CSVæ•°æ®æ—¶ï¼Œé¡µé¢çªç„¶å¡æ­»ï¼Œæ§åˆ¶å°å¼¹å‡º"é•¿æ—¶é—´è¿è¡Œçš„è„šæœ¬"è­¦å‘Šï¼›å½“å®æ—¶è§†é¢‘åˆ†æå¯¼è‡´åŠ¨ç”»å¸§ç‡éª¤é™è‡³5FPSï¼Œç”¨æˆ·å¼€å§‹ç–¯ç‹‚ç‚¹å‡»æ— å“åº”çš„æŒ‰é’®â€”â€”è¿™äº›åœºæ™¯éƒ½åœ¨å°–å«åŒä¸€ä¸ªé—®é¢˜ï¼š<strong>JavaScriptçš„å•çº¿ç¨‹æ¨¡å‹æ­£åœ¨æˆä¸ºç°ä»£åº”ç”¨çš„æ€§èƒ½ç“¶é¢ˆ</strong>ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨å¦‚ä½•é€šè¿‡Web Workerä¸å¼‚æ­¥ç¼–ç¨‹çš„æ·±åº¦ç»“åˆï¼Œæ„å»ºçœŸæ­£æµç•…çš„å‰ç«¯ä½“éªŒã€‚</p>
<hr/>
<h3 data-id="heading-0">ä¸€ã€å•çº¿ç¨‹çš„å›°å¢ƒï¼šå‰ç«¯æ€§èƒ½ç“¶é¢ˆçš„æ ¹æº</h3>
<p>JavaScriptçš„äº‹ä»¶å¾ªç¯åœ¨å¤„ç†I/Oå¯†é›†å‹ä»»åŠ¡æ—¶è¡¨ç°å‡ºè‰²ï¼Œä½†åœ¨CPUå¯†é›†å‹åœºæ™¯ä¸‹é¢ä¸´æ ¹æœ¬æ€§é™åˆ¶ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é˜»å¡ä¸»çº¿ç¨‹çš„å…¸å‹åœºæ™¯ï¼šå¤§å‹æ•°æ®å¤„ç†</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">processHugeData</span>(<span class="hljs-params">data</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'ä¸»çº¿ç¨‹å¤„ç†'</span>);
  <span class="hljs-keyword">const</span> result = [];
  
  <span class="hljs-comment">// æ¨¡æ‹Ÿ100ä¸‡æ¡æ•°æ®çš„å¤æ‚è®¡ç®—</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000</span>; i++) {
    result.<span class="hljs-title function_">push</span>({
      <span class="hljs-attr">id</span>: i,
      <span class="hljs-attr">value</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(data[i] * <span class="hljs-number">1.5</span>) + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>(i * <span class="hljs-number">0.01</span>),
      <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
    });
  }
  
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'ä¸»çº¿ç¨‹å¤„ç†'</span>);
  <span class="hljs-keyword">return</span> result;
}

<span class="hljs-comment">// åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œå¯¼è‡´UIå†»ç»“</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'process-btn'</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> fakeData = <span class="hljs-title class_">Array</span>(<span class="hljs-number">1000000</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">42</span>);
  <span class="hljs-keyword">const</span> output = <span class="hljs-title function_">processHugeData</span>(fakeData); <span class="hljs-comment">// é¡µé¢å®Œå…¨å¡æ­»çº¦2.3ç§’</span>
  <span class="hljs-title function_">renderResults</span>(output);
});
</code></pre>
<p><strong>æ€§èƒ½ç«ç„°å›¾åˆ†æ</strong>ï¼ˆChrome DevTools Performanceé¢æ¿ï¼‰ï¼š</p>
<ul>
<li>ä¸»çº¿ç¨‹è¢«é•¿æ—¶é—´å ç”¨ï¼ŒUIæ¸²æŸ“å®Œå…¨åœæ»</li>
<li>60FPSåŠ¨ç”»å¸§ç‡æš´è·Œè‡³3-5FPS</li>
<li>ç”¨æˆ·äº¤äº’äº‹ä»¶ï¼ˆç‚¹å‡»ã€æ»šåŠ¨ï¼‰è¢«å»¶è¿Ÿå¤„ç†</li>
</ul>
<blockquote>
<p><strong>å…³é”®æ´å¯Ÿ</strong>ï¼šä¼ ç»Ÿå¼‚æ­¥æ¨¡å¼ï¼ˆsetTimeout/Promiseï¼‰åªèƒ½è§£å†³I/Oç­‰å¾…é—®é¢˜ï¼Œæ— æ³•é‡Šæ”¾CPUå¯†é›†å‹ä»»åŠ¡å¯¹ä¸»çº¿ç¨‹çš„å ç”¨ã€‚çªç ´ç‚¹åœ¨äº<strong>çœŸæ­£çš„å¹¶è¡Œè®¡ç®—</strong>ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-1">äºŒã€Web Worker åŸºç¡€ï¼šå¤šçº¿ç¨‹æ¶æ„çš„æ ¸å¿ƒæœºåˆ¶</h3>
<p>Web Workeré€šè¿‡åˆ›å»ºç‹¬ç«‹çº¿ç¨‹å®ç°çœŸæ­£çš„å¹¶è¡Œå¤„ç†ï¼Œå…¶æ ¸å¿ƒåœ¨äºä¸¥æ ¼çš„çº¿ç¨‹éš”ç¦»ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// main.js - ä¸»çº¿ç¨‹</span>
<span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'worker.js'</span>, { 
  <span class="hljs-attr">type</span>: <span class="hljs-string">'module'</span>, <span class="hljs-comment">// æ”¯æŒESæ¨¡å—</span>
  <span class="hljs-attr">credentials</span>: <span class="hljs-string">'same-origin'</span> <span class="hljs-comment">// åŒæºç­–ç•¥é™åˆ¶</span>
});

worker.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ”¶åˆ°æ¥è‡ªWorkerçš„æ•°æ®:'</span>, event.<span class="hljs-property">data</span>);
  <span class="hljs-title function_">updateUI</span>(event.<span class="hljs-property">data</span>);
};

worker.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Workeré”™è¯¯ [è¡Œ:<span class="hljs-subst">${error.lineno}</span>]`</span>, error.<span class="hljs-property">message</span>);
  <span class="hljs-title function_">showWorkerCrashModal</span>();
};

<span class="hljs-comment">// ä¼ é€’æ•°æ®ï¼ˆè‡ªåŠ¨åºåˆ—åŒ–ï¼‰</span>
worker.<span class="hljs-title function_">postMessage</span>({
  <span class="hljs-attr">action</span>: <span class="hljs-string">'processData'</span>,
  <span class="hljs-attr">payload</span>: hugeDataset
});

<span class="hljs-comment">// æ˜¾å¼ç»ˆæ­¢Worker</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'stop-btn'</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
  worker.<span class="hljs-title function_">terminate</span>(); <span class="hljs-comment">// ç«‹å³ç»ˆæ­¢çº¿ç¨‹</span>
});
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// worker.js - ç‹¬ç«‹çº¿ç¨‹</span>
self.<span class="hljs-property">onmessage</span> = <span class="hljs-keyword">async</span> (event) =&gt; {
  <span class="hljs-keyword">const</span> { action, payload } = event.<span class="hljs-property">data</span>;
  
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">switch</span>(action) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">'processData'</span>:
        <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">processDataInWorker</span>(payload);
        self.<span class="hljs-title function_">postMessage</span>({ <span class="hljs-attr">status</span>: <span class="hljs-string">'success'</span>, <span class="hljs-attr">data</span>: result });
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'abort'</span>:
        <span class="hljs-comment">// å®ç°å¯å–æ¶ˆçš„è®¡ç®—</span>
        abortController.<span class="hljs-title function_">abort</span>();
        <span class="hljs-keyword">break</span>;
    }
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-comment">// Workerå†…é”™è¯¯ä¸ä¼šå½±å“ä¸»çº¿ç¨‹</span>
    self.<span class="hljs-title function_">postMessage</span>({ 
      <span class="hljs-attr">status</span>: <span class="hljs-string">'error'</span>, 
      <span class="hljs-attr">message</span>: error.<span class="hljs-property">message</span> 
    });
  }
};

<span class="hljs-comment">// ç‹¬ç«‹äºDOMçš„è®¡ç®—å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">processDataInWorker</span>(<span class="hljs-params">data</span>) {
  <span class="hljs-comment">// è¿™é‡Œæ— æ³•è®¿é—®window/documentç­‰å…¨å±€å¯¹è±¡</span>
  <span class="hljs-keyword">return</span> data.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> <span class="hljs-comment">/* å¤æ‚è®¡ç®— */</span>);
}
</code></pre>
<p><strong>æ ¸å¿ƒéš”ç¦»è§„åˆ™</strong>ï¼š</p>
<ul>
<li>âŒ æ— æ³•è®¿é—®DOMã€<code>window</code>ã€<code>document</code>ã€<code>localStorage</code></li>
<li>âŒ æ— æ³•ä½¿ç”¨<code>alert()</code>/<code>confirm()</code>ç­‰UIæ–¹æ³•</li>
<li>âœ… å¯è®¿é—®<code>navigator</code>ã€<code>setTimeout</code>ã€<code>fetch</code>ã€<code>WebAssembly</code></li>
<li>âœ… é€šè¿‡<code>importScripts()</code>æˆ–ESæ¨¡å—åŠ è½½å¤–éƒ¨ä»£ç </li>
</ul>
<blockquote>
<p><strong>å®‰å…¨è®¾è®¡åŸç†</strong>ï¼šWorkerè¿è¡Œåœ¨ç‹¬ç«‹çš„V8å®ä¾‹ä¸­ï¼Œé€šè¿‡ç»“æ„åŒ–å…‹éš†ç®—æ³•ï¼ˆStructured Clone Algorithmï¼‰è¿›è¡Œæ•°æ®äº¤æ¢ï¼Œä»æ ¹æœ¬ä¸Šé¿å…ç«æ€æ¡ä»¶ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-2">ä¸‰ã€å¼‚æ­¥é€šä¿¡è¿›é˜¶ï¼šé«˜æ•ˆæ•°æ®ä¼ è¾“ç­–ç•¥</h3>
<p>ä¸»çº¿ç¨‹ä¸Workeré—´çš„æ•°æ®ä¼ è¾“æ˜¯æ€§èƒ½å…³é”®ï¼Œé”™è¯¯çš„ä½¿ç”¨æ–¹å¼ä¼šä½¿å¹¶è¡Œä¼˜åŠ¿è¡ç„¶æ— å­˜ï¼š</p>
<h4 data-id="heading-3">1. Transferable Objectsï¼šé›¶æ‹·è´ä¼ è¾“</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¸»çº¿ç¨‹</span>
<span class="hljs-keyword">const</span> buffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">100_000_000</span>); <span class="hljs-comment">// 100MBæ•°æ®</span>
<span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'data-processor.js'</span>);

<span class="hljs-comment">// ä¼ è¾“åä¸»çº¿ç¨‹å¤±å»bufferæ‰€æœ‰æƒï¼</span>
worker.<span class="hljs-title function_">postMessage</span>({ buffer }, [buffer]);

<span class="hljs-comment">// Workerä¸­</span>
self.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> { buffer } = e.<span class="hljs-property">data</span>;
  <span class="hljs-comment">// ç›´æ¥æ“ä½œåŸå§‹å†…å­˜ï¼Œæ— å¤åˆ¶å¼€é”€</span>
  <span class="hljs-keyword">const</span> view = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Float64Array</span>(buffer);
  <span class="hljs-comment">// ...å¤„ç†æ•°æ®</span>
  self.<span class="hljs-title function_">postMessage</span>({ <span class="hljs-attr">resultBuffer</span>: processedBuffer }, [processedBuffer]);
};
</code></pre>
<p><strong>æ€§èƒ½å¯¹æ¯”</strong>ï¼ˆ100MB ArrayBufferï¼‰ï¼š</p>




















<table><thead><tr><th>ä¼ è¾“æ–¹å¼</th><th>è€—æ—¶ (Chrome 124)</th><th>å†…å­˜å³°å€¼</th></tr></thead><tbody><tr><td>é»˜è®¤ç»“æ„åŒ–å…‹éš†</td><td>320ms</td><td>200MB</td></tr><tr><td>Transferable</td><td>&lt;1ms</td><td>100MB</td></tr></tbody></table>
<h4 data-id="heading-4">2. MessageChannelï¼šå¤šWorkerå¤æ‚é€šä¿¡</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆ›å»ºé€šé“</span>
<span class="hljs-keyword">const</span> { port1, port2 } = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MessageChannel</span>();

<span class="hljs-comment">// Worker A ä¸ Worker B é€šè¿‡porté€šä¿¡</span>
<span class="hljs-keyword">const</span> workerA = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'workerA.js'</span>);
<span class="hljs-keyword">const</span> workerB = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'workerB.js'</span>);

workerA.<span class="hljs-title function_">postMessage</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'init'</span> }, [port1]);
workerB.<span class="hljs-title function_">postMessage</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'init'</span> }, [port2]);

<span class="hljs-comment">// åœ¨workerA.jsä¸­</span>
self.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (e.<span class="hljs-property">data</span>.<span class="hljs-property">type</span> === <span class="hljs-string">'init'</span>) {
    <span class="hljs-keyword">const</span> port = e.<span class="hljs-property">ports</span>[<span class="hljs-number">0</span>];
    port.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">msg</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (msg.<span class="hljs-property">data</span>.<span class="hljs-property">action</span> === <span class="hljs-string">'request'</span>) {
        port.<span class="hljs-title function_">postMessage</span>({ <span class="hljs-attr">action</span>: <span class="hljs-string">'response'</span>, <span class="hljs-attr">data</span>: <span class="hljs-title function_">computeHeavyTask</span>() });
      }
    };
  }
};
</code></pre>
<blockquote>
<p><strong>å…³é”®å®è·µ</strong>ï¼šå¯¹äºè¶…è¿‡1MBçš„æ•°æ®ä¼ è¾“ï¼Œå§‹ç»ˆä¼˜å…ˆä½¿ç”¨Transferable Objectsã€‚æ³¨æ„ï¼šä¼ è¾“ååŸå¯¹è±¡åœ¨å‘é€æ–¹å˜ä¸ºä¸å¯ç”¨ï¼ˆå†…å­˜æ‰€æœ‰æƒè½¬ç§»ï¼‰ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-5">å››ã€ç°ä»£å¼€å‘å®è·µï¼šæ¡†æ¶ä¸å·¥å…·é“¾æ•´åˆ</h3>
<h4 data-id="heading-6">1. Comlinkï¼šæ¶ˆé™¤é€šä¿¡æ ·æ¿ä»£ç </h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// worker.js</span>
<span class="hljs-keyword">import</span> { expose } <span class="hljs-keyword">from</span> <span class="hljs-string">'comlink'</span>;

<span class="hljs-keyword">const</span> api = {
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">processImage</span>(<span class="hljs-params">imageData</span>) {
    <span class="hljs-comment">// å¤æ‚å›¾åƒå¤„ç†</span>
    <span class="hljs-keyword">return</span> processedData;
  },
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">trainModel</span>(<span class="hljs-params">dataset</span>) {
    <span class="hljs-comment">// TensorFlow.js æ¨¡å‹è®­ç»ƒ</span>
  }
};

<span class="hljs-title function_">expose</span>(api); <span class="hljs-comment">// æš´éœ²API</span>

<span class="hljs-comment">// main.js</span>
<span class="hljs-keyword">import</span> { wrap } <span class="hljs-keyword">from</span> <span class="hljs-string">'comlink'</span>;

<span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'worker.js'</span>, { <span class="hljs-attr">type</span>: <span class="hljs-string">'module'</span> });
<span class="hljs-keyword">const</span> workerAPI = <span class="hljs-title function_">wrap</span>(worker);

<span class="hljs-comment">// åƒè°ƒç”¨æœ¬åœ°æ–¹æ³•ä¸€æ ·ä½¿ç”¨</span>
<span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> workerAPI.<span class="hljs-title function_">processImage</span>(imageData);
</code></pre>
<p><strong>Comlink ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>è‡ªåŠ¨å¤„ç†Promise/asyncå‡½æ•°</li>
<li>æ”¯æŒç±»å®ä¾‹ä¼ è¾“</li>
<li>é€æ˜åŒ–é”™è¯¯å¤„ç†</li>
<li>ç±»å‹æ¨æ–­ï¼ˆé…åˆTypeScriptï¼‰</li>
</ul>
<h4 data-id="heading-7">2. æ¡†æ¶é›†æˆï¼ˆViteç¤ºä¾‹ï¼‰</h4>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// vite.config.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">worker</span>: {
    <span class="hljs-attr">format</span>: <span class="hljs-string">'es'</span>,
    <span class="hljs-attr">plugins</span>: [
      <span class="hljs-comment">// ä¸ºWorkerå•ç‹¬é…ç½®æ’ä»¶</span>
      <span class="hljs-title function_">wasm</span>(),
      <span class="hljs-title function_">legacy</span>({
        <span class="hljs-attr">targets</span>: [<span class="hljs-string">'defaults'</span>, <span class="hljs-string">'not IE 11'</span>]
      })
    ]
  }
})
</code></pre>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// Reactç»„ä»¶ä¸­åŠ¨æ€åŠ è½½Worker</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">useImageProcessor</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> [worker, setWorker] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">null</span>);
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> imageWorker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(
      <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(<span class="hljs-string">'./image-processor.worker.js'</span>, <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>),
      { <span class="hljs-attr">type</span>: <span class="hljs-string">'module'</span> }
    );
    
    <span class="hljs-title function_">setWorker</span>(imageWorker);
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> imageWorker.<span class="hljs-title function_">terminate</span>();
  }, []);
  
  <span class="hljs-keyword">const</span> processImage = <span class="hljs-title function_">useCallback</span>(<span class="hljs-keyword">async</span> (file) =&gt; {
    <span class="hljs-keyword">if</span> (!worker) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
      worker.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> <span class="hljs-title function_">resolve</span>(e.<span class="hljs-property">data</span>);
      worker.<span class="hljs-title function_">postMessage</span>(file);
    });
  }, [worker]);
};
</code></pre>
<blockquote>
<p><strong>å·¥ç¨‹åŒ–æç¤º</strong>ï¼šåœ¨æ„å»ºé…ç½®ä¸­ä¸ºWorkerè®¾ç½®å•ç‹¬çš„entrypointï¼Œé¿å…å°†æ•´ä¸ªåº”ç”¨æ‰“åŒ…åˆ°Workerä¸­ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-8">äº”ã€æ€§èƒ½ä¼˜åŒ–ä¸é™·é˜±è§„é¿</h3>
<h4 data-id="heading-9">1. Workeræ± æ¨¡å¼ï¼ˆé¿å…é¢‘ç¹åˆ›å»ºå¼€é”€ï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">WorkerPool</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">workerPath, size = <span class="hljs-number">4</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span> = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: size }, <span class="hljs-function">() =&gt;</span> 
      <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(workerPath)
    );
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskQueue</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">nextWorkerIndex</span> = <span class="hljs-number">0</span>;
  }
  
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">exec</span>(<span class="hljs-params">task</span>) {
    <span class="hljs-comment">// è½®è¯¢åˆ†é…ä»»åŠ¡</span>
    <span class="hljs-keyword">const</span> worker = <span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">nextWorkerIndex</span>++ % <span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span>.<span class="hljs-property">length</span>];
    
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleMessage</span> = (<span class="hljs-params">e</span>) =&gt; {
        worker.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'message'</span>, handleMessage);
        <span class="hljs-title function_">resolve</span>(e.<span class="hljs-property">data</span>);
      };
      
      worker.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'message'</span>, handleMessage);
      worker.<span class="hljs-title function_">postMessage</span>(task);
    });
  }
  
  <span class="hljs-title function_">terminate</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">w</span> =&gt;</span> w.<span class="hljs-title function_">terminate</span>());
  }
}

<span class="hljs-comment">// ä½¿ç”¨ï¼šå¤ç”¨4ä¸ªWorkerå¤„ç†100ä¸ªä»»åŠ¡</span>
<span class="hljs-keyword">const</span> pool = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WorkerPool</span>(<span class="hljs-string">'/tasks.worker.js'</span>, <span class="hljs-number">4</span>);
<span class="hljs-keyword">const</span> results = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(
  <span class="hljs-title class_">Array</span>(<span class="hljs-number">100</span>).<span class="hljs-title function_">fill</span>().<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">_, i</span>) =&gt;</span> pool.<span class="hljs-title function_">exec</span>({ <span class="hljs-attr">taskId</span>: i }))
);
</code></pre>
<h4 data-id="heading-10">2. å†…å­˜æ³„æ¼é˜²æŠ¤</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Workerå†…éƒ¨</span>
<span class="hljs-keyword">let</span> abortController = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AbortController</span>();

self.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (e.<span class="hljs-property">data</span>.<span class="hljs-property">action</span> === <span class="hljs-string">'start'</span>) {
    <span class="hljs-comment">// æ¯æ¬¡æ–°ä»»åŠ¡é‡ç½®æ§åˆ¶å™¨</span>
    abortController.<span class="hljs-title function_">abort</span>(); 
    abortController = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AbortController</span>();
    
    <span class="hljs-title function_">processData</span>(e.<span class="hljs-property">data</span>.<span class="hljs-property">payload</span>, abortController.<span class="hljs-property">signal</span>)
      .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> self.<span class="hljs-title function_">postMessage</span>(result));
  }
};

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">processData</span>(<span class="hljs-params">data, signal</span>) {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; data.<span class="hljs-property">length</span>; i++) {
    <span class="hljs-comment">// æ£€æŸ¥å–æ¶ˆä¿¡å·</span>
    <span class="hljs-keyword">if</span> (signal.<span class="hljs-property">aborted</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMException</span>(<span class="hljs-string">'Aborted'</span>, <span class="hljs-string">'AbortError'</span>);
    
    <span class="hljs-comment">// åˆ†å—å¤„ç†é˜²æ­¢é•¿æ—¶é—´å ç”¨</span>
    <span class="hljs-keyword">if</span> (i % <span class="hljs-number">1000</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">0</span>));
    
    <span class="hljs-comment">// ...å¤„ç†é€»è¾‘</span>
  }
}
</code></pre>
<p><strong>å…³é”®é˜²æŠ¤æªæ–½</strong>ï¼š</p>
<ul>
<li>å§‹ç»ˆåœ¨Workerä¸­ä½¿ç”¨<code>AbortController</code>æ”¯æŒå–æ¶ˆ</li>
<li>å¤„ç†å¤§æ•°æ®é›†æ—¶åˆ†å—æ‰§è¡Œï¼ˆchunk processingï¼‰</li>
<li>ä½¿ç”¨<code>setTimeout(0)</code>é‡Šæ”¾äº‹ä»¶å¾ªç¯</li>
<li>æ˜¾å¼æ¸…ç†äº‹ä»¶ç›‘å¬å™¨ï¼ˆé¿å…é—­åŒ…å†…å­˜æ³„æ¼ï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-11">å…­ã€å®æˆ˜åœºæ™¯å‰–æ</h3>
<h4 data-id="heading-12">åœºæ™¯ï¼šå®æ—¶è§†é¢‘å¸§å¤„ç†ï¼ˆ60FPSï¼‰</h4>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"output-canvas"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"1280"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"720"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// main.js</span>
<span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'output-canvas'</span>);
<span class="hljs-keyword">const</span> offscreen = canvas.<span class="hljs-title function_">transferControlToOffscreen</span>(); <span class="hljs-comment">// OffscreenCanvas</span>

<span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'video-processor.js'</span>);
worker.<span class="hljs-title function_">postMessage</span>({ <span class="hljs-attr">canvas</span>: offscreen }, [offscreen]);

<span class="hljs-comment">// é€šè¿‡MessageChannelæ¥æ”¶å¸§æ•°æ®</span>
<span class="hljs-keyword">const</span> { port1, port2 } = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MessageChannel</span>();
worker.<span class="hljs-title function_">postMessage</span>({ <span class="hljs-attr">videoPort</span>: port2 }, [port2]);

port1.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-comment">// å®æ—¶æ˜¾ç¤ºå¤„ç†çŠ¶æ€</span>
  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'fps-counter'</span>).<span class="hljs-property">textContent</span> = e.<span class="hljs-property">data</span>.<span class="hljs-property">fps</span>;
};

<span class="hljs-comment">// video-processor.js (Worker)</span>
<span class="hljs-keyword">let</span> fpsCounter = <span class="hljs-number">0</span>;
<span class="hljs-keyword">let</span> lastFrameTime = <span class="hljs-number">0</span>;

self.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (e.<span class="hljs-property">data</span>.<span class="hljs-property">canvas</span>) {
    <span class="hljs-keyword">const</span> canvas = e.<span class="hljs-property">data</span>.<span class="hljs-property">canvas</span>;
    <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">'2d'</span>);
    <span class="hljs-keyword">const</span> videoPort = e.<span class="hljs-property">ports</span>[<span class="hljs-number">0</span>];
    
    <span class="hljs-comment">// æ¨¡æ‹Ÿè§†é¢‘æµ</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">drawFrame</span> = (<span class="hljs-params"/>) =&gt; {
      <span class="hljs-keyword">const</span> now = performance.<span class="hljs-title function_">now</span>();
      <span class="hljs-keyword">const</span> elapsed = now - lastFrameTime;
      
      <span class="hljs-keyword">if</span> (elapsed &gt;= <span class="hljs-number">16</span>) { <span class="hljs-comment">// ~60FPS</span>
        <span class="hljs-comment">// å¤æ‚å›¾åƒå¤„ç†ï¼ˆè¾¹ç¼˜æ£€æµ‹ï¼‰</span>
        <span class="hljs-title function_">applyEdgeDetection</span>(ctx);
        
        <span class="hljs-comment">// é€šè¿‡OffscreenCanvasç›´æ¥æ¸²æŸ“</span>
        canvas.<span class="hljs-title function_">commit</span>();
        
        <span class="hljs-comment">// è®¡ç®—FPS</span>
        fpsCounter++;
        <span class="hljs-keyword">if</span> (now - lastFrameTime &gt; <span class="hljs-number">1000</span>) {
          videoPort.<span class="hljs-title function_">postMessage</span>({ <span class="hljs-attr">fps</span>: fpsCounter });
          fpsCounter = <span class="hljs-number">0</span>;
          lastFrameTime = now;
        }
      }
      
      <span class="hljs-comment">// éé˜»å¡é€’å½’</span>
      <span class="hljs-built_in">setTimeout</span>(drawFrame, <span class="hljs-number">0</span>);
    };
    
    <span class="hljs-title function_">drawFrame</span>();
  }
};
</code></pre>
<p><strong>æ€§èƒ½å¯¹æ¯”</strong>ï¼ˆ1080pè§†é¢‘å®æ—¶å¤„ç†ï¼‰ï¼š</p>























<table><thead><tr><th>æ–¹æ¡ˆ</th><th>ä¸»çº¿ç¨‹å ç”¨</th><th>ç¨³å®šFPS</th><th>å†…å­˜å¢é•¿/åˆ†é’Ÿ</th></tr></thead><tbody><tr><td>ä¸»çº¿ç¨‹å¤„ç†</td><td>92%</td><td>8-12</td><td>120MB</td></tr><tr><td>Web Worker + OffscreenCanvas</td><td>18%</td><td>58-60</td><td>25MB</td></tr></tbody></table>
<blockquote>
<p><strong>OffscreenCanvasé©å‘½</strong>ï¼šåœ¨Workerä¸­ç›´æ¥æ“ä½œCanvasï¼Œé¿å…æ¯å¸§æ•°æ®ä¼ è¾“å¼€é”€ï¼Œè¿™æ˜¯å®ç°é«˜æ€§èƒ½å›¾å½¢åº”ç”¨çš„å…³é”®ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-13">ä¸ƒã€æœªæ¥æ¼”è¿›ä¸æ›¿ä»£æ–¹æ¡ˆ</h3>
<h4 data-id="heading-14">1. WebAssembly + Worker ååŒ</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// worker.js</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">initWasm</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> wasmModule = <span class="hljs-keyword">await</span> <span class="hljs-title class_">WebAssembly</span>.<span class="hljs-title function_">instantiateStreaming</span>(
    <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'image-processing.wasm'</span>),
    { 
      <span class="hljs-attr">env</span>: { 
        <span class="hljs-attr">memory</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebAssembly</span>.<span class="hljs-title class_">Memory</span>({ <span class="hljs-attr">initial</span>: <span class="hljs-number">256</span> })
      }
    }
  );
  
  <span class="hljs-keyword">return</span> wasmModule.<span class="hljs-property">instance</span>.<span class="hljs-property">exports</span>;
}

<span class="hljs-keyword">let</span> wasmExports;
<span class="hljs-title function_">initWasm</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">exports</span> =&gt;</span> wasmExports = <span class="hljs-built_in">exports</span>);

self.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-comment">// è°ƒç”¨Wasmå‡½æ•°ï¼ˆæ¯”JSå¿«5-10å€ï¼‰</span>
  <span class="hljs-keyword">const</span> result = wasmExports.<span class="hljs-title function_">processImage</span>(e.<span class="hljs-property">data</span>.<span class="hljs-property">buffer</span>);
  self.<span class="hljs-title function_">postMessage</span>(result, [result]);
};
</code></pre>
<h4 data-id="heading-15">2. æŠ€æœ¯é€‰å‹å†³ç­–æ ‘</h4>
<p><strong>æ›¿ä»£æ–¹æ¡ˆå¯¹æ¯”</strong>ï¼š</p>






























<table><thead><tr><th>æŠ€æœ¯</th><th>é€‚ç”¨åœºæ™¯</th><th>å±€é™æ€§</th></tr></thead><tbody><tr><td>Web Worker</td><td>é€šç”¨CPUå¯†é›†å‹ä»»åŠ¡</td><td>é€šä¿¡å¼€é”€ï¼Œæ— DOMè®¿é—®</td></tr><tr><td>WebAssembly</td><td>è¶…é«˜æ€§èƒ½è®¡ç®—ï¼ˆC++/Rustï¼‰</td><td>å¼€å‘å¤æ‚åº¦é«˜</td></tr><tr><td>Worklets</td><td>CSSåŠ¨ç”»/éŸ³é¢‘å¤„ç†</td><td>åŠŸèƒ½å—é™ï¼ŒAPIå®éªŒæ€§</td></tr><tr><td>Service Workers</td><td>ç½‘ç»œä»£ç†/ç¦»çº¿ç¼“å­˜</td><td>æ— æ³•å¤„ç†CPUå¯†é›†å‹ä»»åŠ¡</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-16">å…«ã€ç»“è¯­ï¼šé‡æ„å‰ç«¯æ€§èƒ½è®¤çŸ¥</h3>
<p>Web Workerä¸æ˜¯é“¶å¼¹ï¼Œè€Œæ˜¯ç°ä»£å‰ç«¯æ¶æ„çš„å…³é”®æ‹¼å›¾ã€‚åœ¨æ„å»ºå®æ—¶åä½œåº”ç”¨æ—¶ï¼Œæˆ‘ä»¬å°†å›¾åƒå·®å¼‚è®¡ç®—ç§»è‡³Workerï¼Œä½¿ä¸»çº¿ç¨‹äº¤äº’å»¶è¿Ÿä»300msé™è‡³15msï¼›åœ¨é‡‘èæ•°æ®å¹³å°ä¸­ï¼Œé€šè¿‡Workeræ± å¤„ç†10GBçº§æ—¶åºæ•°æ®ï¼Œç”¨æˆ·æ»šåŠ¨æµç•…åº¦æå‡400%ã€‚è¿™äº›å®è·µéªŒè¯äº†ï¼š<strong>çœŸæ­£çš„æµç•…ä½“éªŒï¼Œå§‹äºå¯¹å•çº¿ç¨‹è¾¹ç•Œçš„çªç ´</strong>ã€‚</p>
<p><strong>è¡ŒåŠ¨å»ºè®®</strong>ï¼š</p>
<ol>
<li>åœ¨Lighthouseæ€§èƒ½å®¡è®¡ä¸­ï¼Œå°†"é¿å…é•¿æ—¶é—´ä¸»çº¿ç¨‹ä»»åŠ¡"ä½œä¸ºç¡¬æ€§æŒ‡æ ‡</li>
<li>å¯¹ä»»ä½•è¶…è¿‡50msçš„åŒæ­¥æ“ä½œè¿›è¡ŒWorkeråŒ–æ”¹é€ </li>
<li>ä½¿ç”¨<a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">worker-timers</a>ç­‰åº“æ›¿æ¢é˜»å¡å¼å®šæ—¶å™¨</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ¦â€ğŸ”¥ è§£é”ç§»åŠ¨ç«¯H5è°ƒè¯•ï¼šEruda & VConsole å®æˆ˜æŒ‡å—]]></title>    <link>https://juejin.cn/post/7587965908287963146</link>    <guid>https://juejin.cn/post/7587965908287963146</guid>    <pubDate>2025-12-26T09:00:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587965908287963146" data-draft-id="7587965800272379930" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ¦â€ğŸ”¥ è§£é”ç§»åŠ¨ç«¯H5è°ƒè¯•ï¼šEruda &amp; VConsole å®æˆ˜æŒ‡å—"/> <meta itemprop="keywords" content="Debug,WebView,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-26T09:00:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="CRAB"/> <meta itemprop="url" content="https://juejin.cn/user/2154698522760557"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ¦â€ğŸ”¥ è§£é”ç§»åŠ¨ç«¯H5è°ƒè¯•ï¼šEruda &amp; VConsole å®æˆ˜æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2154698522760557/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    CRAB
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T09:00:31.000Z" title="Fri Dec 26 2025 09:00:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    28
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>åœ¨PCç«¯ï¼Œæˆ‘ä»¬æœ‰Chrome DevToolsã€‚ä½†åœ¨å¾®ä¿¡å°ç¨‹åºæˆ–Appçš„WebViewä¸­å¼€å‘H5æ—¶ï¼ŒF12ç¬é—´å¤±çµï¼Œè°ƒè¯•å¦‚åŒâ€œç›²äººæ‘¸è±¡â€ã€‚æœ¬æ–‡å°†ä¸ºä½ æ·±åº¦å‰–æä¸¤å¤§ç¥å™¨â€”â€”<strong>VConsole</strong>â€‹ å’Œ <strong>Eruda</strong>ï¼ŒåŠ©ä½ è½»æ¾æ”»å…‹ç§»åŠ¨ç«¯H5è°ƒè¯•éš¾é¢˜ã€‚</p>
</blockquote>
<h2 data-id="heading-0">ğŸ¦â€ å‰è¨€ï¼šä¸ºä½•æˆ‘ä»¬éœ€è¦å®ƒä»¬ï¼Ÿ</h2>
<ol>
<li><strong>ç¯å¢ƒå°é—­</strong>ï¼šå°ç¨‹åºçš„ <code>web-view</code>å’Œ App çš„ WebView é€šå¸¸ä¸å¼€æ”¾å®Œæ•´çš„DevToolsæƒé™ã€‚</li>
<li><strong>çœŸæœºå·®å¼‚</strong>ï¼šPCæ¨¡æ‹Ÿç¯å¢ƒä¸çœŸå®æ‰‹æœºåœ¨æ¸²æŸ“ã€æ€§èƒ½ã€APIæ”¯æŒä¸Šå­˜åœ¨é¸¿æ²Ÿã€‚</li>
<li><strong>ç½‘ç»œä¸è®¾å¤‡</strong>ï¼šéœ€è¦æŸ¥çœ‹åœ¨ç‰¹å®šç½‘ç»œï¼ˆ4G/5Gï¼‰å’Œè®¾å¤‡ä¸‹çš„è¡¨ç°ã€‚</li>
<li><strong>å¿«é€Ÿå®šä½</strong>ï¼š<code>console.log</code>å’Œç½‘ç»œè¯·æ±‚è¯¦æƒ…æ˜¯å®šä½é—®é¢˜çš„ç”Ÿå‘½çº¿ã€‚</li>
</ol>
<h2 data-id="heading-1">ğŸª¶ ä¸¤å¤§ç¥å™¨ç®€ä»‹ä¸æ ¸å¿ƒå¯¹æ¯”</h2>








































<table><thead><tr><th>ç‰¹æ€§</th><th>Eruda ğŸ› ï¸</th><th>VConsole ğŸ“±</th></tr></thead><tbody><tr><td><strong>å®šä½</strong>â€‹</td><td>ä¸“ä¸šã€å…¨åŠŸèƒ½â€œä»ªè¡¨ç›˜â€</td><td>è½»é‡ã€ä¾¿æ·â€œå£è¢‹å·¥å…·â€</td></tr><tr><td><strong>å‡ºå“æ–¹</strong>â€‹</td><td>Liriliri (ç‹¬ç«‹å¼€å‘è€…)</td><td><strong>å¾®ä¿¡å›¢é˜Ÿ</strong>â€‹</td></tr><tr><td><strong>åŠŸèƒ½ä¸°å¯Œåº¦</strong>â€‹</td><td>â˜…â˜…â˜…â˜…â˜… (Console, Elements, Network, Resources, Snippets...)</td><td>â˜…â˜…â˜…â˜…â˜† (Console, Network, Element, Storage)</td></tr><tr><td><strong>æ˜“ç”¨æ€§</strong>â€‹</td><td>â˜…â˜…â˜…â˜†â˜† (éœ€ç®€å•å­¦ä¹ ï¼Œæ¨¡å—åŒ–)</td><td>â˜…â˜…â˜…â˜…â˜… (å¼€ç®±å³ç”¨ï¼Œé›¶æˆæœ¬)</td></tr><tr><td><strong>æ€§èƒ½/ä½“ç§¯</strong>â€‹</td><td>ç›¸å¯¹è¾ƒé‡ (~180KB gzipped)</td><td>éå¸¸è½»é‡ (~45KB gzipped)</td></tr><tr><td><strong>æ¨èåœºæ™¯</strong>â€‹</td><td>å¤æ‚åº”ç”¨ã€æ·±åº¦è°ƒè¯•ã€ä¸“ä¸šå¼€å‘è€…</td><td>å¿«é€Ÿè¿­ä»£ã€å¾®ä¿¡ç”Ÿæ€ã€æ–°æ‰‹ã€è½»é‡éœ€æ±‚</td></tr></tbody></table>
<p><strong>ä¸€å¥è¯æ€»ç»“ï¼šè¿½æ±‚æ·±åº¦å’Œå…¨é¢ï¼Œé€‰ Erudaï¼›è¿½æ±‚ç®€å•å’Œå¿«æ·ï¼Œå°¤å…¶åœ¨å¾®ä¿¡ç¯å¢ƒï¼Œé€‰ VConsoleã€‚</strong></p>
<hr/>
<h2 data-id="heading-2">ğŸª¾ å®æˆ˜ç¯‡ï¼šæ‰‹æŠŠæ‰‹æ•™ä½ é›†æˆ</h2>
<h3 data-id="heading-3">ğŸš© 1. Eruda é›†æˆä¸ä½¿ç”¨</h3>
<p><strong>ç¬¬1æ­¥ï¼šå¼•å…¥è„šæœ¬ (åŠ¡å¿…æŒ‰éœ€åŠ è½½ï¼)</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- æ¨èï¼šé€šè¿‡URLå‚æ•° ?eruda=true æˆ–å¼€å‘ç¯å¢ƒåˆ¤æ–­æ¥åŠ è½½ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/localhost|127.0.0.1|dev/i</span>.<span class="hljs-title function_">test</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">hostname</span>) || <span class="hljs-regexp">/eruda=true/</span>.<span class="hljs-title function_">test</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">search</span>)) {
    <span class="hljs-keyword">var</span> script = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'script'</span>);
    script.<span class="hljs-property">src</span> = <span class="hljs-string">'//cdn.jsdelivr.net/npm/eruda'</span>;
    script.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) { eruda.<span class="hljs-title function_">init</span>(); };
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(script);
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><strong>ç¬¬2æ­¥ï¼šåˆå§‹åŒ–ä¸é…ç½® (å¯é€‰)</strong></p>
<pre><code class="hljs language-csharp" lang="csharp">eruda.<span class="hljs-keyword">init</span>({
  tool: [<span class="hljs-string">'console'</span>, <span class="hljs-string">'elements'</span>, <span class="hljs-string">'network'</span>], <span class="hljs-comment">// åªå¯ç”¨éœ€è¦çš„å·¥å…·</span>
  autoScale: <span class="hljs-literal">true</span>,
});
</code></pre>
<p><strong>ç¬¬3æ­¥ï¼šæ•ˆæœä¸€è§ˆ</strong></p>
<p>ç‚¹å‡»å³ä¸‹è§’ Logo å³å¯å”¤å‡ºåŠŸèƒ½å¼ºå¤§çš„æ§åˆ¶å°ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/53a6d0f2195847ec94c2e3203116fcfc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ1JBQg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767347810&amp;x-signature=quRZeGoz%2Fs3Km2uh8ytZi3iKSNU%3D" alt="929F667A-F134-4B5D-9C5A-387209BADB96_1_201_a.jpeg" loading="lazy"/></p>
<h3 data-id="heading-4">ğŸš© 2. VConsole é›†æˆä¸ä½¿ç”¨</h3>
<p><strong>ç¬¬1æ­¥ï¼šå¼•å…¥è„šæœ¬ (åŒæ ·æŒ‰éœ€åŠ è½½ï¼)</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- æ¨èï¼šé€šè¿‡ç¯å¢ƒå˜é‡æˆ–åŸŸååˆ¤æ–­æ¥åŠ è½½ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/localhost|127.0.0.1|dev/i</span>.<span class="hljs-title function_">test</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">hostname</span>)) {
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">write</span>(<span class="hljs-string">'&lt;script src="https://unpkg.com/vconsole/dist/vconsole.min.js"&gt;</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>');
    document.write('<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"><span class="hljs-keyword">new</span> <span class="hljs-title class_">VConsole</span>();</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>');
  }
<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><strong>ç¬¬2æ­¥ï¼šåˆå§‹åŒ–ä¸é…ç½® (å¯é€‰)</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> vConsole = <span class="hljs-keyword">new</span> <span class="hljs-title class_">VConsole</span>({
  <span class="hljs-attr">defaultPlugins</span>: [<span class="hljs-string">'system'</span>, <span class="hljs-string">'network'</span>, <span class="hljs-string">'element'</span>],
  <span class="hljs-attr">onReady</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'VConsole å·²å°±ç»ªï¼'</span>); }
});
</code></pre>
<p><strong>ç¬¬3æ­¥ï¼šæ•ˆæœä¸€è§ˆ</strong></p>
<p>ç‚¹å‡»å³ä¸‹è§’ç»¿è‰² â€œVâ€ å›¾æ ‡å³å¯æ‰“å¼€ç®€æ´çš„è°ƒè¯•é¢æ¿ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/98891db9f4c5485eae5702bc07af8ea6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ1JBQg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767347810&amp;x-signature=JMC9wECUmrP%2BaltLTq%2FzWEkf8ds%3D" alt="BDDE4554-869F-49A3-AE5C-E78FF43B6E1D_1_201_a.jpeg" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-5">ğŸ›¹ æœ€ä½³å®è·µä¸é¿å‘æŒ‡å—</h2>
<ol>
<li>
<p><strong>å®‰å…¨ç¬¬ä¸€ï¼šåˆ‡å‹¿å‘å¸ƒåˆ°ç”Ÿäº§ç¯å¢ƒï¼</strong> ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–åŸŸå/IPç™½åå•ä¸¥æ ¼æ§åˆ¶åŠ è½½ï¼Œæ˜¯æ¯ä½å‰ç«¯å·¥ç¨‹å¸ˆçš„åŸºæœ¬ç´ å…»ã€‚</p>
</li>
<li>
<p><strong>åŠ¨æ€å¼€å¯ï¼šç»™æµ‹è¯•å’Œäº§å“åŒå­¦å¼€ä¸ªâ€œåé—¨â€</strong> ä½¿ç”¨ URL å‚æ•°ï¼ˆå¦‚ <code>?debug=true</code>ï¼‰æ§åˆ¶ï¼Œæ— éœ€é‡æ–°å‘ç‰ˆå³å¯å¼€å¯è°ƒè¯•ã€‚</p>
</li>
<li>
<p><strong>VConsole è¿›é˜¶</strong></p>
<ul>
<li><code>vConsole.showSwitch()</code>å¯ä»¥æ˜¾ç¤ºä¸€ä¸ªæ‰‹åŠ¨åˆ‡æ¢é¢æ¿çš„å¼€å…³ã€‚</li>
<li>å¯ä»¥è‡ªå®šä¹‰æ’ä»¶ï¼Œæ‰©å±•å…¶åŠŸèƒ½ã€‚</li>
</ul>
</li>
<li>
<p><strong>Eruda è¿›é˜¶</strong></p>
<ul>
<li>ä½¿ç”¨ <code>eruda.add(erudaPerformance)</code>åŠ¨æ€æ·»åŠ æ€§èƒ½ç›‘æ§æ’ä»¶ã€‚</li>
<li>é€šè¿‡ <code>eruda.settings.set()</code>åŠ¨æ€è°ƒæ•´è®¾ç½®ã€‚</li>
</ul>
</li>
</ol>
<h2 data-id="heading-6">ğŸ¬ æ€»ç»“</h2>
<p>å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚å¯¹äºç§»åŠ¨ç«¯H5å¼€å‘è€…è€Œè¨€ï¼Œ<strong>VConsole</strong>â€‹ å’Œ <strong>Eruda</strong>â€‹ å°±æ˜¯é‚£æŠŠæœ€é”‹åˆ©çš„â€œå™¨â€ã€‚</p>
<ul>
<li><strong>æ—¥å¸¸å¿«é€Ÿè°ƒè¯•ã€å¾®ä¿¡H5å¼€å‘</strong>ï¼ŒVConsole æ˜¯ä½ çš„ä¸äºŒä¹‹é€‰ã€‚</li>
<li><strong>é¢å¯¹å¤æ‚Bugã€éœ€è¦è¿›è¡Œæ·±åº¦æ€§èƒ½åˆ†æ</strong>ï¼ŒEruda çš„å¼ºå¤§åŠŸèƒ½ä¼šè®©ä½ äº‹åŠåŠŸå€ã€‚</li>
</ul>
<p>å¸Œæœ›è¿™ç¯‡æŒ‡å—èƒ½å¸®åŠ©ä½ å½»åº•æ‘†è„±è°ƒè¯•å›°å¢ƒï¼Œåœ¨ç§»åŠ¨ç«¯H5çš„ä¸–ç•Œé‡Œæ¸¸åˆƒæœ‰ä½™ï¼æ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„ä½¿ç”¨å¿ƒå¾—å’Œé‡åˆ°çš„é—®é¢˜ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä» iframe åˆ° Shadow DOMï¼šä¸€æ¬¡å…³äºã€Œéš”ç¦»ã€çš„å‰ç«¯è¾¹ç•Œæ€è€ƒ]]></title>    <link>https://juejin.cn/post/7587808953075695616</link>    <guid>https://juejin.cn/post/7587808953075695616</guid>    <pubDate>2025-12-26T09:02:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587808953075695616" data-draft-id="7587743345197006900" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä» iframe åˆ° Shadow DOMï¼šä¸€æ¬¡å…³äºã€Œéš”ç¦»ã€çš„å‰ç«¯è¾¹ç•Œæ€è€ƒ"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-26T09:02:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="shanLion"/> <meta itemprop="url" content="https://juejin.cn/user/2788017217477048"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä» iframe åˆ° Shadow DOMï¼šä¸€æ¬¡å…³äºã€Œéš”ç¦»ã€çš„å‰ç«¯è¾¹ç•Œæ€è€ƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2788017217477048/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    shanLion
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T09:02:38.000Z" title="Fri Dec 26 2025 09:02:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€é—®é¢˜èƒŒæ™¯ï¼šæˆ‘åˆ°åº•æƒ³è§£å†³ä»€ä¹ˆï¼Ÿ</h2>
<p>åœ¨å¤æ‚å‰ç«¯ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°è¿™æ ·çš„éœ€æ±‚ï¼š</p>
<ul>
<li>
<p>é¡µé¢éœ€è¦åµŒå…¥<strong>ç¬¬ä¸‰æ–¹å†…å®¹ / å­ç³»ç»Ÿ</strong></p>
</li>
<li>
<p>å¸Œæœ› <strong>æ ·å¼ã€è„šæœ¬äº’ä¸å½±å“</strong></p>
</li>
<li>
<p>åŒæ—¶åˆè¦ä¿è¯ï¼š</p>
<ul>
<li>æ­£å¸¸æ¸²æŸ“</li>
<li>åˆç†äº¤äº’</li>
<li>å¯æ§çš„å®‰å…¨è¾¹ç•Œ</li>
</ul>
</li>
</ul>
<p>å¸¸è§æ–¹æ¡ˆæ˜¯ <code>iframe</code>ï¼Œä½†ä¸€æ—¦æ·±å…¥ä½¿ç”¨ï¼Œå°±ä¼šç«‹åˆ»é‡åˆ°ä¸€ç³»åˆ—é—®é¢˜ï¼š</p>
<ul>
<li>Cookie æ˜¯å¦ä¼šè¢«æ³¨å…¥ï¼Ÿ</li>
<li>JS èƒ½å¦äº’ç›¸è®¿é—®ï¼Ÿ</li>
<li>æ ·å¼æ˜¯å¦ä¼šæ±¡æŸ“ï¼Ÿ</li>
<li>sandbox ä¸€åŠ ï¼Œé¡µé¢æ€ä¹ˆç›´æ¥ä¸æ˜¾ç¤ºäº†ï¼Ÿ</li>
<li>ä¸åŠ  <code>allow-same-origin</code> åˆä¸ºä»€ä¹ˆä»€ä¹ˆéƒ½â€œåäº†â€ï¼Ÿ</li>
</ul>
<p>è¿™ç¯‡æ–‡ç« ï¼Œå°±æ˜¯å›´ç»•è¿™äº›çœŸå®é—®é¢˜å±•å¼€ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€iframe çš„æœ¬è´¨ï¼šæµè§ˆå™¨çº§åˆ«çš„â€œç¡¬éš”ç¦»â€</h2>
<h3 data-id="heading-2">1ï¸âƒ£ iframe æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>ä»æµè§ˆå™¨è§’åº¦çœ‹ï¼Œ<code>iframe</code> å¹¶ä¸æ˜¯ä¸€ä¸ªæ™®é€š DOMï¼Œè€Œæ˜¯ï¼š</p>
<blockquote>
<p><strong>ä¸€ä¸ªå®Œæ•´çš„ã€ç‹¬ç«‹çš„æµè§ˆä¸Šä¸‹æ–‡ï¼ˆBrowsing Contextï¼‰</strong></p>
</blockquote>
<p>å®ƒæ‹¥æœ‰è‡ªå·±çš„ï¼š</p>
<ul>
<li>DOM æ ‘</li>
<li>JS æ‰§è¡Œç¯å¢ƒ</li>
<li>CSS ä½œç”¨åŸŸ</li>
<li>Cookie / Storageï¼ˆæ˜¯å¦å…±äº«å–å†³äºç­–ç•¥ï¼‰</li>
</ul>
<p>è¿™ä¹Ÿæ˜¯å®ƒâ€œéš”ç¦»æ€§å¼ºâ€çš„æ ¹æœ¬åŸå› ã€‚</p>
<hr/>
<h3 data-id="heading-3">2ï¸âƒ£ iframe å¤©ç”Ÿé€‚åˆåšä»€ä¹ˆï¼Ÿ</h3>
<ul>
<li>å¾®å‰ç«¯å­åº”ç”¨</li>
<li>ç¬¬ä¸‰æ–¹å†…å®¹åµŒå…¥</li>
<li>ä¸å¯ä¿¡é¡µé¢å±•ç¤º</li>
<li>å¼ºå®‰å…¨è¾¹ç•Œåœºæ™¯</li>
</ul>
<p><strong>å®ƒè§£å†³çš„æ˜¯â€œä¸ä¿¡ä»»â€çš„é—®é¢˜ï¼Œè€Œä¸æ˜¯â€œä¼˜é›…â€çš„é—®é¢˜ã€‚</strong></p>
<hr/>
<h2 data-id="heading-4">ä¸‰ã€sandboxï¼šå®‰å…¨ä»è¿™é‡Œå¼€å§‹ï¼Œä¹Ÿä»è¿™é‡Œå¤±æ§</h2>
<h3 data-id="heading-5">1ï¸âƒ£ sandbox åˆ°åº•å¹²äº†ä»€ä¹ˆï¼Ÿ</h3>
<p>å½“ä½ ç»™ iframe åŠ ä¸Šï¼š</p>
<pre><code class="hljs language-css" lang="css">&lt;<span class="hljs-selector-tag">iframe</span> sandbox&gt;&lt;/<span class="hljs-selector-tag">iframe</span>&gt;
</code></pre>
<p>ä½ ç›¸å½“äºå¯¹å®ƒè¯´ï¼š</p>
<blockquote>
<p>â€œä½ ä»€ä¹ˆéƒ½ä¸èƒ½å¹²ã€‚â€</p>
</blockquote>
<p>åŒ…æ‹¬ä½†ä¸é™äºï¼š</p>
<ul>
<li>âŒ JS ä¸æ‰§è¡Œ</li>
<li>âŒ è¡¨å•æäº¤è¢«ç¦</li>
<li>âŒ åŒæºèº«ä»½è¢«å‰¥å¤º</li>
<li>âŒ Cookie / localStorage å…¨éƒ¨éš”ç¦»</li>
</ul>
<hr/>
<h3 data-id="heading-6">2ï¸âƒ£ ä¸ºä»€ä¹ˆåŠ äº† sandboxï¼Œé¡µé¢ç›´æ¥ç©ºç™½ï¼Ÿ</h3>
<p>å› ä¸ºå¾ˆå¤šé¡µé¢ï¼š</p>
<ul>
<li>ä¾èµ– JS æ¸²æŸ“</li>
<li>ä¾èµ–åŒæºè¯»å–èµ„æº</li>
<li>ä¾èµ– Cookie ç»´æŒçŠ¶æ€</li>
</ul>
<p>ä¸€æ—¦ sandbox é»˜è®¤é™åˆ¶ç”Ÿæ•ˆï¼Œé¡µé¢<strong>é€»è¾‘ä¸Šè¿˜èƒ½åŠ è½½ï¼Œä½†åŠŸèƒ½å…¨åºŸ</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-7">3ï¸âƒ£ allow-scripts + allow-same-origin ä¸ºä»€ä¹ˆå±é™©ï¼Ÿ</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">sandbox</span>=<span class="hljs-string">"allow-scripts allow-same-origin"</span>
</code></pre>
<p>è¿™æ˜¯ä¸€ä¸ª<strong>ç»å…¸é™·é˜±ç»„åˆ</strong>ã€‚</p>
<p>åŸå› æ˜¯ï¼š</p>
<ul>
<li><code>allow-scripts</code>ï¼šå…è®¸ JS æ‰§è¡Œ</li>
<li><code>allow-same-origin</code>ï¼šæ¢å¤åŒæºèº«ä»½</li>
</ul>
<p>âš ï¸ ä¸€æ—¦ä¸¤è€…åŒæ—¶å­˜åœ¨ï¼š</p>
<blockquote>
<p>iframe å†…çš„ JS <strong>å¯ä»¥è®¤ä¸ºè‡ªå·±æ˜¯â€œæ­£å¸¸é¡µé¢â€</strong></p>
</blockquote>
<p>ä»è§„èŒƒè§’åº¦ï¼Œå®ƒå·²ç»å…·å¤‡äº†<strong>é€ƒé€¸ sandbox çš„èƒ½åŠ›</strong>ã€‚</p>
<p>è¿™ä¹Ÿæ˜¯ MDN æ˜ç¡®æ ‡æ³¨çš„å®‰å…¨é£é™©ã€‚</p>
<hr/>
<h2 data-id="heading-8">å››ã€é‚£æˆ‘åªæ˜¯ä¸æƒ³ Cookie è¢«æ³¨å…¥ï¼Œæ€ä¹ˆåŠï¼Ÿ</h2>
<h3 data-id="heading-9">âŒ é”™è¯¯ç›´è§‰</h3>
<blockquote>
<p>â€œå»æ‰ allow-same-origin å°±å¥½äº†â€</p>
</blockquote>
<p>ç»“æœæ˜¯ï¼š</p>
<ul>
<li>JS å–ä¸åˆ°ä»»ä½•èµ„æº</li>
<li>é¡µé¢æ¸²æŸ“å¤±è´¥</li>
<li>iframe å†…å®¹ç›´æ¥æ¶ˆå¤±</li>
</ul>
<hr/>
<h3 data-id="heading-10">âœ… æ­£ç¡®ç†è§£</h3>
<p>Cookie æ³¨å…¥çš„æœ¬è´¨æ˜¯ï¼š</p>
<ul>
<li><strong>åŒæº + å‡­è¯ä¼ é€’</strong></li>
</ul>
<p>æ§åˆ¶ Cookie çš„æ­£ç¡®æ–¹å¼æ˜¯ï¼š</p>
<ul>
<li><code>SameSite</code></li>
<li><code>HttpOnly</code></li>
<li><code>Secure</code></li>
<li>æœåŠ¡ç«¯é‰´æƒç­–ç•¥</li>
</ul>
<p>è€Œä¸æ˜¯æŒ‡æœ› iframe sandbox å»â€œé¡ºä¾¿è§£å†³â€ã€‚</p>
<hr/>
<h2 data-id="heading-11">äº”ã€Shadow DOMï¼šå¦ä¸€ç§å®Œå…¨ä¸åŒçš„â€œéš”ç¦»â€</h2>
<h3 data-id="heading-12">1ï¸âƒ£ Shadow DOM éš”ç¦»çš„æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>Shadow DOM éš”ç¦»çš„æ˜¯ï¼š</p>
<ul>
<li><strong>æ ·å¼ä½œç”¨åŸŸ</strong></li>
<li><strong>DOM ç»“æ„å¯è§æ€§</strong></li>
</ul>
<p>ä½†å®ƒï¼š</p>
<ul>
<li>âŒ ä¸éš”ç¦» JS</li>
<li>âŒ ä¸éš”ç¦» Cookie</li>
<li>âŒ ä¸éš”ç¦»å®‰å…¨ä¸Šä¸‹æ–‡</li>
</ul>
<p>å®ƒè§£å†³çš„æ˜¯ï¼š</p>
<blockquote>
<p><strong>ç»„ä»¶çº§çš„å¯ç»´æŠ¤æ€§é—®é¢˜</strong></p>
</blockquote>
<p>è€Œä¸æ˜¯å®‰å…¨é—®é¢˜ã€‚</p>
<hr/>
<h3 data-id="heading-13">2ï¸âƒ£ iframe vs Shadow DOM å¯¹æ¯”</h3>








































<table><thead><tr><th>ç»´åº¦</th><th>iframe</th><th>Shadow DOM</th></tr></thead><tbody><tr><td>æ ·å¼éš”ç¦»</td><td>âœ… å¼º</td><td>âœ… ä¸­</td></tr><tr><td>JS éš”ç¦»</td><td>âœ… å¼º</td><td>âŒ</td></tr><tr><td>å®‰å…¨è¾¹ç•Œ</td><td>âœ…</td><td>âŒ</td></tr><tr><td>é€šä¿¡æˆæœ¬</td><td>é«˜</td><td>ä½</td></tr><tr><td>æ€§èƒ½</td><td>è¾ƒé‡</td><td>è½»</td></tr><tr><td>ä½¿ç”¨å¤æ‚åº¦</td><td>é«˜</td><td>ä¸­</td></tr></tbody></table>
<p>ä¸€å¥è¯æ€»ç»“ï¼š</p>
<blockquote>
<p>iframe æ˜¯<strong>å®‰å…¨éš”ç¦»å·¥å…·</strong><br/>
Shadow DOM æ˜¯<strong>å·¥ç¨‹éš”ç¦»å·¥å…·</strong></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäºReact Native 0.83.1 æ–°æ¶æ„ä¸‹çš„æ‹†åŒ…æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7587825268201209862</link>    <guid>https://juejin.cn/post/7587825268201209862</guid>    <pubDate>2025-12-26T08:23:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587825268201209862" data-draft-id="7587785079739121670" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäºReact Native 0.83.1 æ–°æ¶æ„ä¸‹çš„æ‹†åŒ…æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="React Native"/> <meta itemprop="datePublished" content="2025-12-26T08:23:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åˆ˜æˆ"/> <meta itemprop="url" content="https://juejin.cn/user/3773179634918343"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäºReact Native 0.83.1 æ–°æ¶æ„ä¸‹çš„æ‹†åŒ…æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3773179634918343/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åˆ˜æˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T08:23:22.000Z" title="Fri Dec 26 2025 08:23:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>React Native 0.83.1 æ–°æ¶æ„ï¼ˆNew Architectureï¼‰ ä¸‹çš„æ‹†åŒ…æ–¹æ¡ˆ</p>
<hr/>
<h2 data-id="heading-0">React Native 0.83.1 æ–°æ¶æ„æ‹†åŒ…å®æˆ˜ï¼šåŸºäº ReactHost ä¸å• Runtime çš„åŠ¨æ€åŠ è½½æ–¹æ¡ˆ</h2>
<p>éšç€ React Native è¿›å…¥ 0.80+ æ—¶ä»£ï¼Œæ–°æ¶æ„ï¼ˆFabric &amp; TurboModulesï¼‰å·²æˆä¸ºä¸»æµã€‚ä¼ ç»Ÿçš„åŸºäº <code>ReactInstanceManager</code> å’Œ Bridge çš„æ‹†åŒ…æ–¹å¼å·²é€æ­¥è¿‡æ—¶ã€‚æœ¬æ–‡å°†ä»‹ç»åœ¨ <strong>RN 0.83.1</strong> ç‰ˆæœ¬ä¸‹ï¼Œå¦‚ä½•åˆ©ç”¨ <code>ReactHost</code>ã€<code>JSI</code> å’Œ <code>Hermes Runtime</code> å®ç°é«˜æ€§èƒ½çš„æ¨¡å—åŒ–æ‹†åŒ…ä¸åŠ¨æ€åŠ è½½ã€‚</p>
<hr/>
<h3 data-id="heading-1">ä¸€ã€ ä¸ºä»€ä¹ˆæ—§çš„æ‹†åŒ…æ–¹æ¡ˆå¤±æ•ˆäº†ï¼Ÿ</h3>
<p>åœ¨æ–°æ¶æ„ä¸­ï¼Œåº•å±‚é€šä¿¡æœºåˆ¶ä»ä¼ ç»Ÿçš„ JSON Bridge è½¬å‘äº†åŸºäº C++ çš„ <strong>JSI (JavaScript Interface)</strong>ã€‚</p>



































<table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">Legacy æ¶æ„ (æ—§)</th><th align="left">æ–°æ¶æ„ (Fabric + TurboModules)</th></tr></thead><tbody><tr><td align="left"><strong>JS æ‰§è¡Œç¯å¢ƒ</strong></td><td align="left">Bridge + CatalystInstance</td><td align="left"><strong>JSI + Hermes Runtime</strong></td></tr><tr><td align="left"><strong>Bundle å…¥å£</strong></td><td align="left">ReactInstanceManager</td><td align="left"><strong>ReactHost / JSExecutorFactory</strong></td></tr><tr><td align="left"><strong>Native ç®¡ç†å™¨</strong></td><td align="left">ReactActivity / ReactRootView</td><td align="left"><strong>ReactHost / ReactInstance</strong></td></tr><tr><td align="left"><strong>JS æ¨¡å— API</strong></td><td align="left">å…¨å±€æ³¨å…¥æ¨¡å— (Global Bridge)</td><td align="left"><strong>TurboModule + Codegen</strong></td></tr><tr><td align="left"><strong>æ”¯æŒæƒ…å†µ</strong></td><td align="left">å·²è¿‡æ—¶ (Deprecated)</td><td align="left"><strong>å®˜æ–¹æ¨è</strong></td></tr></tbody></table>
<blockquote>
<p>[!WARNING]<br/>
ä» RN 0.72 èµ· Fabric é»˜è®¤å¯ç”¨ï¼ŒRN 0.80 ä¹‹åå·²å®Œå…¨ç§»é™¤ä¼ ç»Ÿ Bridge çš„ Fallback æœºåˆ¶ã€‚<code>JSBundleLoader</code> ç­‰æ—§ç±»åœ¨é«˜æ€§èƒ½æ–°æ¶æ„ä¸‹å·²æ— æ³•ç›´æ¥ä½¿ç”¨ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-2">äºŒã€ æ–¹æ¡ˆé€‰æ‹©ï¼šå¤š Runtime vs å• Runtime</h3>
<p>åœ¨ 0.83.1 ç‰ˆæœ¬ä¸‹ï¼Œå®ç°å¤šæ¨¡å—åŒ–ä¸»è¦æœ‰ä¸¤ç§æ€è·¯ï¼š</p>
<ol>
<li><strong>å¤š ReactHost å®ä¾‹åŒ–ï¼ˆéš”ç¦»æ–¹æ¡ˆï¼‰ï¼š</strong> æ¯ä¸ªä¸šåŠ¡æ¨¡å—ç‹¬ç«‹æ‰“åŒ…ï¼ŒåŒ…å«ç‹¬ç«‹çš„åŸºç¡€åº“ã€‚ä¼˜ç‚¹æ˜¯éš”ç¦»æ€§å¼ºï¼Œç¼ºç‚¹æ˜¯å†…å­˜å ç”¨æé«˜ï¼Œæ— æ³•å…±äº«åŸºç¡€åº“ã€‚</li>
<li><strong>å• Hermes Runtime åŠ¨æ€åŠ è½½ï¼ˆæ¨èæ–¹æ¡ˆï¼‰ï¼š</strong>
<ul>
<li><strong>åŸºç¡€åŒ… (Base Bundle)ï¼š</strong> åŒ…å« RN æ¡†æ¶ã€NativeModulesã€å…¬å…±åº“åŠå¯¼èˆªå®¹å™¨ã€‚</li>
<li><strong>ä¸šåŠ¡åŒ… (Business Bundle)ï¼š</strong> ä»…åŒ…å«ä¸šåŠ¡ä»£ç ï¼Œå…±ç”¨åŸºç¡€åŒ…çš„è¿è¡Œæ—¶ã€‚</li>
<li><strong>ä¼˜åŠ¿ï¼š</strong> å†…å­˜å ç”¨ä½ã€å…±ç”¨ä¸Šä¸‹æ–‡ã€ç¬¦åˆ Fabric æ¸²æŸ“é“¾è·¯ã€‚</li>
</ul>
</li>
</ol>
<p><strong>æœ¬æ–‡é‡‡ç”¨æ–¹æ¡ˆ 2 è¿›è¡Œæ·±åº¦å®è·µã€‚</strong></p>
<hr/>
<h3 data-id="heading-3">ä¸‰ã€ æ ¸å¿ƒåŸç†</h3>
<ol>
<li><strong>æŒ‰éœ€åŠ è½½ï¼š</strong> å¯åŠ¨é˜¶æ®µåªåŠ è½½ <code>index.base.bundle</code>ã€‚</li>
<li><strong>åŠ¨æ€æ³¨å†Œï¼š</strong> ä¸šåŠ¡ Bundle è¢«åŠ è½½æ—¶ï¼Œé€šè¿‡ JSI è°ƒç”¨åº•å±‚ C++ Runtime çš„ <code>evaluateJavaScript</code> æ‰§è¡Œ JS ä»£ç ï¼Œå°†ä¸šåŠ¡é¡µé¢æ³¨å†Œåˆ°åŸºç¡€åŒ…çš„å¯¼èˆªå™¨ï¼ˆå¦‚ React Navigationï¼‰ä¸­ã€‚</li>
<li><strong>è·¯ç”±å ä½ï¼š</strong> åŸºç¡€åŒ…é¢„ç•™â€œå£³é¡µé¢â€ï¼ˆBizShellï¼‰ï¼Œå½“å¯¼èˆªè·³è½¬è‡³ä¸šåŠ¡æ¨¡å—æ—¶ï¼Œè‹¥ Bundle æœªåŠ è½½åˆ™è§¦å‘ Native åŠ¨æ€åŠ è½½æµç¨‹ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-4">å››ã€ å…·ä½“å®ç°æ­¥éª¤</h3>
<h4 data-id="heading-5">1. React Native å±‚å®ç°</h4>
<h5 data-id="heading-6">1.1 å…¥å£æ–‡ä»¶æ‹†åˆ†</h5>
<ul>
<li>
<p><strong>index.base.js (åŸºç¡€åŒ…)ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AppRegistry</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-native'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./src/App'</span>;
<span class="hljs-keyword">import</span> { name <span class="hljs-keyword">as</span> appName } <span class="hljs-keyword">from</span> <span class="hljs-string">'./app.json'</span>;

<span class="hljs-title class_">AppRegistry</span>.<span class="hljs-title function_">registerComponent</span>(appName, <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">App</span>);
</code></pre>
</li>
<li>
<p><strong>index.buz1.js (ä¸šåŠ¡åŒ…)ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { registerBiz } <span class="hljs-keyword">from</span> <span class="hljs-string">'./src/navigation/DynamicRegistry'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Buz1Navigator</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./src/biz1/Navigator'</span>;

<span class="hljs-comment">// åŠ¨æ€æ³¨å†Œä¸šåŠ¡è·¯ç”±</span>
<span class="hljs-title function_">registerBiz</span>(<span class="hljs-string">'buz1'</span>, <span class="hljs-title class_">Buz1Navigator</span>);
</code></pre>
</li>
</ul>
<h5 data-id="heading-7">1.2 è·¯ç”±å ä½é€»è¾‘</h5>
<p>åœ¨ <code>src/navigation/DynamicNavigator.tsx</code> ä¸­ï¼Œä½¿ç”¨ <code>BizShell</code> ä½œä¸ºä¸šåŠ¡å ä½ç¬¦ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx">&lt;<span class="hljs-title class_">Stack</span>.<span class="hljs-property">Navigator</span> initialRouteName={props.<span class="hljs-property">biz</span> || <span class="hljs-string">'NotFound'</span>}&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Stack.Screen</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"NotFound"</span> <span class="hljs-attr">component</span>=<span class="hljs-string">{NotFound}</span> /&gt;</span></span>
  
  {<span class="hljs-comment">/* ä¸šåŠ¡å ä½ï¼šæœ‰å¤šå°‘ä¸ªæ‹†åˆ†åŒ…ï¼Œå°±é…ç½®å¤šå°‘ä¸ª Screen */</span>}
  &lt;<span class="hljs-title class_">Stack</span>.<span class="hljs-property">Screen</span> 
    key={<span class="hljs-string">'buz1'</span>} 
    name={<span class="hljs-string">'buz1'</span>} 
    component={<span class="hljs-title class_">BizShell</span>} 
    options={{ <span class="hljs-attr">headerShown</span>: <span class="hljs-literal">false</span> }} 
  /&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Stack.Screen</span> 
    <span class="hljs-attr">key</span>=<span class="hljs-string">{</span>'<span class="hljs-attr">buz2</span>'} 
    <span class="hljs-attr">name</span>=<span class="hljs-string">{</span>'<span class="hljs-attr">buz2</span>'} 
    <span class="hljs-attr">component</span>=<span class="hljs-string">{BizShell}</span> 
    <span class="hljs-attr">options</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">headerShown:</span> <span class="hljs-attr">false</span> }} 
  /&gt;</span></span>
&lt;/<span class="hljs-title class_">Stack</span>.<span class="hljs-property">Navigator</span>&gt;
</code></pre>
<blockquote>
<p><strong>æç¤ºï¼š</strong> æ ¸å¿ƒè·¯ç”±è·³è½¬ä¸ Bundle åŠ è½½çŠ¶æ€ç»´æŠ¤å‡åœ¨ <code>BizShell.tsx</code> ä¸­å¤„ç†ã€‚</p>
</blockquote>
<hr/>
<h4 data-id="heading-8">2. Android ç«¯æ ¸å¿ƒä»£ç </h4>
<h5 data-id="heading-9">2.1 åˆå§‹åŒ– ReactHost</h5>
<p>åœ¨ <code>MainApplication</code> ä¸­æ‰‹åŠ¨å¯åŠ¨ <code>ReactHost</code> å¹¶ç›‘å¬åˆå§‹åŒ–çŠ¶æ€ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initializeReactHost</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> host = reactHost
    host.start() <span class="hljs-comment">// å¯åŠ¨æ–°æ¶æ„ Host</span>

    host.addReactInstanceEventListener(<span class="hljs-keyword">object</span> : ReactInstanceEventListener {
        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onReactContextInitialized</span><span class="hljs-params">(reactContext: <span class="hljs-type">ReactContext</span>)</span></span> {
            <span class="hljs-comment">// å°† Context ä¼ ç»™åŠ¨æ€åŠ è½½å™¨</span>
            DynamicLoader.setContext(reactContext)
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// æ‰§è¡Œ JSI ç»‘å®šæˆ–å…¶ä»–åˆå§‹åŒ–</span>
                DynamicLoader.install()
                SplashActivity.instance?.hideLoading()
            } <span class="hljs-keyword">catch</span> (e: Exception) {
                Log.e(<span class="hljs-string">"MainApplication"</span>, <span class="hljs-string">"DynamicLoader å¤±è´¥ï¼š<span class="hljs-subst">${e.message}</span>"</span>)
            }
            host.removeReactInstanceEventListener(<span class="hljs-keyword">this</span>)
        }
    })
}
</code></pre>
<h5 data-id="heading-10">2.2 åŠ¨æ€åŠ è½½ Bundle (NativeDynamicLoader.kt)</h5>
<p>é€šè¿‡ JNI è·å– C++ Runtime å¥æŸ„å¹¶æ‰§è¡Œ JavaScriptã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadBundle</span><span class="hljs-params">(bundlePath: <span class="hljs-type">String</span>)</span></span> {
    <span class="hljs-keyword">val</span> jsiPtr = context.javaScriptContextHolder.<span class="hljs-keyword">get</span>()
    <span class="hljs-comment">// é€šè¿‡ JNI è°ƒç”¨ C++ å±‚çš„ evaluateJavaScript</span>
    <span class="hljs-comment">// é€»è¾‘ï¼šåˆ¤æ–­ bundlePath æ˜¯å¦å·²åŠ è½½ -&gt; æœªåŠ è½½åˆ™è¯»å–æ–‡ä»¶å¹¶æ‰§è¡Œ</span>
    nativeEvaluateJavaScript(jsiPtr, bundlePath)
}
</code></pre>
<hr/>
<h4 data-id="heading-11">3. iOS ç«¯æ ¸å¿ƒä»£ç </h4>
<h5 data-id="heading-12">3.1 æŠ½è±¡ RNRuntimeManager</h5>
<p>åœ¨ Swift ä¸­ç®¡ç† <code>reactNativeFactory</code> å’Œ <code>reactNativeDelegate</code>ï¼Œé€šè¿‡ <code>rootViewFactory</code> åˆ›å»ºè§†å›¾ã€‚</p>
<h5 data-id="heading-13">3.2 åŠ¨æ€åŠ è½½ (RTNDynamicLoader)</h5>
<p>åœ¨æ–°æ¶æ„ä¸‹ï¼Œä¸å†ä½¿ç”¨è¿‡æ—¶çš„ <code>bridge.executeSourceCode</code>ã€‚</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// JSBundleLoader.swift æ ¸å¿ƒé€»è¾‘</span>
<span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> runtimeExecutor <span class="hljs-operator">=</span> rootViewFactory.reactHost.surfacePresenter<span class="hljs-operator">?</span>.runtimeExecutor {
    <span class="hljs-comment">// æ‹¿åˆ° RuntimeExecutor åï¼Œåœ¨ JS çº¿ç¨‹æ‰§è¡Œä¸šåŠ¡ä»£ç </span>
    runtimeExecutor.execute { runtime <span class="hljs-keyword">in</span>
        <span class="hljs-comment">// ä½¿ç”¨ C++ JSI æˆ–å†…éƒ¨ API æ‰§è¡Œä¸šåŠ¡ Bundle ä»£ç </span>
        loadBusinessBundle(path: bundlePath, in: runtime)
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-14">äº”ã€ æ€»ç»“ä¸ä¼˜åŠ¿</h3>
<p>åŸºäº RN 0.83.1 çš„è¿™å¥—æ‹†åŒ…æ–¹æ¡ˆï¼Œå®Œå…¨æ‘†è„±äº†å¯¹ Legacy Bridge çš„ä¾èµ–ï¼š</p>
<ol>
<li><strong>æé€ŸåŠ è½½ï¼š</strong> åˆ©ç”¨ Hermes å­—èŠ‚ç é¢„ç¼–è¯‘ï¼Œä¸šåŠ¡åŒ…åŠ è½½è¿‘ä¹æ— æ„Ÿã€‚</li>
<li><strong>çµæ´»åˆ†å‘ï¼š</strong> ä¸šåŠ¡ Bundle å¯ç‹¬ç«‹æ›´æ–°ï¼Œæ— éœ€é‡æ–°å®‰è£… Appã€‚</li>
<li><strong>æ¶æ„å¯¹é½ï¼š</strong> æ·±åº¦é›†æˆ <code>ReactHost</code> å’Œ <code>RuntimeExecutor</code>ï¼Œå®Œç¾å…¼å®¹ Fabric æ¸²æŸ“å¼•æ“ï¼Œæ˜¯ç›®å‰æ–°æ¶æ„ä¸‹çš„æœ€ä¼˜å®è·µã€‚</li>
</ol>
<hr/>
<p><strong>å‘å¸ƒå»ºè®®ï¼š</strong></p>
<ul>
<li><strong>æ ‡ç­¾ï¼š</strong> React Native, Android, iOS, æ‹†åŒ…, æ–°æ¶æ„, Hermes.</li>
<li><strong>æ‘˜è¦ï¼š</strong> é’ˆå¯¹ React Native 0.83.1 æœ€æ–°ç‰ˆæœ¬ï¼Œè¯¦ç»†è®²è§£å¦‚ä½•åœ¨ Fabric æ¶æ„ä¸‹å®ç°å• Runtime çš„ä¸šåŠ¡æ‹†åŒ…ä¸åŠ¨æ€åŠ è½½ã€‚</li>
</ul>
<p>é¡¹ç›®gitåœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fliu_520%2Fmulti-bundle-programs" target="_blank" title="https://gitee.com/liu_520/multi-bundle-programs" ref="nofollow noopener noreferrer">gitee.com/liu_520/mulâ€¦</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/24a4e69136164d47b348141a3ef51a6a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YiY5oiQ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767342202&amp;x-signature=L666HMQh1V%2FpMEy0ImdMUxqpack%3D" alt="SVID_20251226_160340_1.gif" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‘Šåˆ«æ•°æ®åº“â€œè†¨èƒ€â€ï¼šDify x SLS æ„å»ºé«˜å¯ç”¨ç”Ÿäº§çº§ AI æ¶æ„]]></title>    <link>https://juejin.cn/post/7587961565477060662</link>    <guid>https://juejin.cn/post/7587961565477060662</guid>    <pubDate>2025-12-26T09:04:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587961565477060662" data-draft-id="7587825268200112134" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‘Šåˆ«æ•°æ®åº“â€œè†¨èƒ€â€ï¼šDify x SLS æ„å»ºé«˜å¯ç”¨ç”Ÿäº§çº§ AI æ¶æ„"/> <meta itemprop="keywords" content="äº‘åŸç”Ÿ"/> <meta itemprop="datePublished" content="2025-12-26T09:04:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿é‡Œäº‘äº‘åŸç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/3808363977648493"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‘Šåˆ«æ•°æ®åº“â€œè†¨èƒ€â€ï¼šDify x SLS æ„å»ºé«˜å¯ç”¨ç”Ÿäº§çº§ AI æ¶æ„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3808363977648493/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿é‡Œäº‘äº‘åŸç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T09:04:57.000Z" title="Fri Dec 26 2025 09:04:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»16åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šæ— å“²ã€è¨€åˆ</p>
<h2 data-id="heading-0">ä¸€ã€å‰è¨€ï¼šDify çš„è§„æ¨¡åŒ–æŒ‘æˆ˜</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8e4b96578c324f8eb575aa3e339537b1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=7esT50KRWjTd1U1Li%2FrZwedPkkw%3D" alt="image.png" loading="lazy"/></p>
<p>Dify æ˜¯å½“å‰æœ€å—æ¬¢è¿çš„ä½ä»£ç  LLM åº”ç”¨å¼€å‘å¹³å°ä¹‹ä¸€ï¼Œåœ¨ Github ä¸Šå·²æ–©è· 120k+ çš„æ˜Ÿæ ‡æ•°ã€‚å›½å†…å¤–æœ‰ä¼—å¤šä¼ä¸šåŸºäº Dify æ„å»ºè‡ªå·±çš„æ™ºèƒ½ä½“åº”ç”¨ã€‚é˜¿é‡Œäº‘å¯è§‚æµ‹å›¢é˜Ÿæ—¢æ˜¯ Dify çš„æ·±åº¦ç”¨æˆ·ï¼Œä¹Ÿæ˜¯ç¤¾åŒºçš„æ´»è·ƒè´¡çŒ®è€…ã€‚</p>
<p>åœ¨å¤§è§„æ¨¡ç”Ÿäº§å®è·µä¸­ï¼Œæˆ‘ä»¬å‘ç° Dify åœ¨é«˜è´Ÿè½½åœºæ™¯ä¸‹é¢ä¸´æ˜¾è‘—çš„æ•°æ®åº“æ€§èƒ½ç“¶é¢ˆï¼šå…¶æ‰§è¡Œå¼•æ“é«˜åº¦ä¾èµ– PostgreSQLï¼Œå•æ¬¡ Chat è¯·æ±‚å¯èƒ½è§¦å‘æ•°ç™¾ç”šè‡³ä¸Šåƒæ¬¡æ•°æ®åº“è®¿é—®ï¼›ä¸æ­¤åŒæ—¶ï¼ŒWorker è¿›ç¨‹åœ¨çŸ¥è¯†åº“ç´¢å¼•æ„å»ºã€Trace è¿½è¸ªç­‰ä»»åŠ¡ä¸­ä¹Ÿä¼šæŒç»­å†™å…¥å¤§é‡æ•°æ®ã€‚è¿™é¢‘ç¹å¯¼è‡´Â <strong>DB è¿æ¥æ± æ‰“æ»¡ã€æ…¢æŸ¥è¯¢é¢‘å‘</strong>Â ç­‰é—®é¢˜ï¼Œå·²æˆä¸ºåˆ¶çº¦ Dify é›†ç¾¤æ¨ªå‘æ‰©å±•ä¸å¹¶å‘èƒ½åŠ›çš„å…³é”®ç“¶é¢ˆã€‚</p>
<h2 data-id="heading-1">äºŒã€ç°çŠ¶ä¸æŒ‘æˆ˜ï¼šDify å­˜å‚¨æœºåˆ¶ç—›ç‚¹åˆ†æ</h2>
<h3 data-id="heading-2">æ•°æ®åˆ†å¸ƒç°çŠ¶</h3>
<p>Dify çš„æ•°æ®ä¸»è¦åˆ†ä¸ºä¸‰ç±»ï¼š</p>
<ul>
<li>Metaç±» æ•°æ®ï¼šç§Ÿæˆ·ã€åº”ç”¨ã€å·¥ä½œæµã€å·¥å…·ç­‰é…ç½®ä¿¡æ¯ï¼›</li>
<li>è¿è¡Œæ—¶æ—¥å¿—ï¼šå·¥ä½œæµæ‰§è¡Œæ˜ç»†ã€ä¼šè¯å†å²ã€æ¶ˆæ¯è®°å½•ç­‰ï¼›</li>
<li>æ–‡ä»¶ç±»æ•°æ®ï¼šç”¨æˆ·ä¸Šä¼ æ–‡ä»¶ã€çŸ¥è¯†åº“æ–‡æ¡£ã€å¤šæ¨¡æ€è¾“å‡ºç­‰ï¼ˆé€šå¸¸å­˜äºå¯¹è±¡å­˜å‚¨ï¼‰ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb0cebf88890443fb5ef43fed477af9f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=mu7eRrlsWT0j5mRMUmkGPBTi5rA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å…¶ä¸­Meta ä¸è¿è¡Œæ—¥å¿—å‡å­˜å‚¨åœ¨ PostgreSQL ä¸­ï¼Œè¿è¡Œæ—¶æ—¥å¿—å æ®äº†æ•°æ®åº“çš„ç»å¤§éƒ¨åˆ†èµ„æºã€‚ä»¥æˆ‘ä»¬çš„ç”Ÿäº§ç¯å¢ƒä¸ºä¾‹ï¼Œè¿è¡Œæ—¥å¿—å  DB å­˜å‚¨ç©ºé—´çš„Â 95%ä»¥ä¸Šã€‚åœ¨è®¿é—®é¢‘ç‡æœ€é«˜å’Œæ…¢æŸ¥è¯¢æœ€å¤šçš„ SQL æ¨¡å¼ä¸­ï¼Œç»å¤§å¤šæ•°éƒ½ä¸è¿è¡Œæ—¥å¿—çš„è¯»å†™ç›¸å…³ã€‚</p>
<p>Dify çš„è¿è¡Œæ—¥å¿—åŒ…å«å·¥ä½œæµçš„æ‰§è¡Œæ˜ç»†è®°å½•å’Œä¼šè¯æ¶ˆæ¯æ•°æ®ï¼Œæ‰§è¡Œè®°å½•ä¸­æœ‰å·¥å…·è¾“å‡ºã€æ¨¡å‹ä¸Šä¸‹æ–‡ç­‰å¤§é‡é•¿æ–‡æœ¬ä¿¡æ¯ï¼Œå¹¶ä¸”è¿è¡Œæ—¥å¿—æ•°é‡ä¹Ÿä¼šéšç€ç”¨æˆ·è¯·æ±‚å¿«é€Ÿå¢é•¿ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b166d94d3d384e4c9c9080eb2c5a9c2f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=jBNWY8hOhvSbzd04lV8HEOsR%2BSY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-3">æ ¸å¿ƒç—›ç‚¹</h3>
<p>å°†è¿™ç±»æµ·é‡ã€é«˜ååçš„æ—¥å¿—æ•°æ®å…¨é‡å­˜å‚¨åœ¨ PostgreSQL ä¸­ï¼Œå¸¦æ¥äº†å¤šé‡æŒ‘æˆ˜ï¼š</p>
<ul>
<li><strong>è´Ÿè½½å‹åŠ›å¤§ï¼š</strong> Workflow èŠ‚ç‚¹çš„æ¯æ¬¡æ‰§è¡Œéƒ½ä¼šäº§ç”Ÿæ˜ç»†æ—¥å¿—ï¼ˆèŠ‚ç‚¹æ‰§è¡Œæ˜ç»†æ•°æ®ï¼Œè®°å½•èŠ‚ç‚¹çš„è¾“å…¥è¾“å‡ºå’Œè¿è¡ŒçŠ¶æ€ç­‰æ•°æ®ï¼‰ï¼Œé«˜å¹¶å‘ä¸‹Â <code>workflow_node_executions</code>Â è¡¨çš„è¯»å†™ææ˜“æˆä¸ºçƒ­ç‚¹ã€‚</li>
<li><strong>è¿æ¥å ç”¨ï¼š</strong> å°½ç®¡ Dify 1.xÂ çš„å‡ ä¸ªç‰ˆæœ¬å¯¹æ•°æ®åº“é•¿è¿æ¥é—®é¢˜åšäº†å¾ˆå¤šä¼˜åŒ–ï¼ˆå¦‚Â issueÂ #22307[1]ï¼‰ï¼Œä½†æ—¥å¿—å¯†é›†è®¿é—®ä»åŠ å‰§è¿æ¥æ± å‹åŠ›ï¼Œå½±å“æ ¸å¿ƒä¸šåŠ¡çš„è¿æ¥è·å–ã€‚</li>
<li><strong>æ‰©å±•æ€§ä¸è¶³ï¼š</strong> è¿è¡Œæ—¥å¿—éšç€ä¸šåŠ¡é‡å‘ˆçˆ†å‘å¼å¢é•¿ï¼Œè€Œ PG æ‰©å®¹ä¾èµ–å‚ç›´å‡é…ï¼Œå‡çº§è§„æ ¼å¾€å¾€ä¼´éšä¸»å¤‡åˆ‡æ¢å¯¼è‡´çš„è¿æ¥é—ªæ–­æˆ–ç»´æŠ¤çª—å£ï¼Œéš¾ä»¥å®ç°å®Œå…¨çš„æ— æ„Ÿæ‰©å®¹ã€‚ç¤¾åŒºå·²æœ‰å¤šä¸ªåé¦ˆï¼ˆå¦‚Â Â issueÂ #18800Â [2]å› ä¼šè¯æ•°æ®å †ç§¯å¯¼è‡´é¦– Token å»¶è¿Ÿå¢åŠ  3 ç§’ï¼›Â issueÂ #22796Â [3]å‘¼åå°†æ—¥å¿—è¿å‡º PGï¼‰</li>
<li><strong>åˆ†æåŠ å·¥èƒ½åŠ›ç¼ºå¤±ï¼š</strong> æ§åˆ¶å°ä»…æ”¯æŒæœ‰é™å…³é”®è¯æ£€ç´¢ï¼Œéš¾ä»¥æ»¡è¶³ä¸šåŠ¡å¯¹å†å²ä¼šè¯è¿›è¡Œå¤šç»´åˆ†æã€äºŒæ¬¡åŠ å·¥åŠç²¾ç»†åŒ–è¿è¥çš„éœ€æ±‚ã€‚</li>
</ul>
<h3 data-id="heading-4">ç¤¾åŒºçš„ç§¯ææ¢ç´¢ä¸æ¼”è¿›</h3>
<p>è¿è¡Œæ—¥å¿—å­˜å‚¨ä¸€ç›´æ˜¯å½±å“ Dify ç³»ç»Ÿæ€§èƒ½ä¸ç¨³å®šæ€§çš„ç—›ç‚¹ã€‚é’ˆå¯¹è¿™ä¸€é—®é¢˜ï¼Œç¤¾åŒºä¸€ç›´åœ¨ç§¯æå¯»æ±‚è§£å†³æ–¹æ¡ˆï¼Œå¹¶å·²è½åœ°äº†å¤šé¡¹ä¼˜åŒ–æªæ–½ï¼š</p>
<ul>
<li><strong>å†…å­˜æ•°æ®åº“</strong>ï¼ˆissueÂ #20147[4]ï¼‰ï¼šé€‚ç”¨äºæ— éœ€æŒä¹…åŒ–çš„è½»é‡åœºæ™¯ï¼ŒåŒæ—¶æ–°ç‰ˆæ‰§è¡Œå¼•æ“å·²å®Œæˆæ—¥å¿—å­˜å‚¨æŠ½è±¡ï¼Œä¸ºåç»­å¼‚æ„å­˜å‚¨æ”¹é€ å¥ å®šäº†åŸºç¡€ã€‚</li>
<li><strong>åå°å¼‚æ­¥æ‰§è¡Œ</strong>ï¼ˆ issueÂ #20050[5]ï¼‰ï¼šé€šè¿‡ Celery Worker å¼‚æ­¥å†™å…¥æ—¥å¿—ï¼Œæœ‰æ•ˆé™ä½äº†æ ¸å¿ƒé“¾è·¯çš„å»¶è¿Ÿï¼Œå‡è½»äº† API å¼•æ“å¯¹ DB çš„åŒæ­¥ä¾èµ–ã€‚</li>
<li><strong>å‘¨æœŸæ€§æ¸…ç†</strong>ï¼ˆ issueÂ #23399[6]ï¼‰ï¼šå¼•å…¥è‡ªåŠ¨æ¸…ç†æœºåˆ¶ï¼Œå®šæœŸç§»é™¤é™ˆæ—§çš„ä¼šè¯ä¸æ‰§è¡Œè®°å½•ï¼Œæœ‰æ•ˆç¼“è§£äº†æ•°æ®åº“å­˜å‚¨è†¨èƒ€é—®é¢˜ã€‚</li>
<li><strong>å¤§å­—æ®µåˆ†ç¦»å­˜å‚¨ï¼š</strong> é’ˆå¯¹ LLM é•¿ä¸Šä¸‹æ–‡å¯¼è‡´çš„å¤§å­—æ®µé—®é¢˜ï¼Œæ”¯æŒå°†è¶…é•¿å­—æ®µæˆªæ–­å¹¶è½¬å­˜è‡³å¯¹è±¡å­˜å‚¨ï¼Œå‡è½»äº† DB çš„ I/O å‹åŠ›ã€‚</li>
</ul>
<h3 data-id="heading-5">æ ¹å› åˆ†æï¼šæ•°æ®ç‰¹å¾ä¸å­˜å‚¨å¼•æ“çš„é”™é…</h3>
<p>ä¸Šè¿°ä¼˜åŒ–åœ¨ç‰¹å®šé˜¶æ®µéå¸¸æœ‰æ•ˆï¼Œç¼“è§£äº† Dify çš„ç‡ƒçœ‰ä¹‹æ€¥ï¼Œä½†åœ¨å¤§è§„æ¨¡ç”Ÿäº§åœºæ™¯ä¸‹ï¼Œåº”ç”¨å±‚çš„é€»è¾‘ä¼˜åŒ–ï¼ˆå¼‚æ­¥ã€æ¸…ç†ç­‰ï¼‰å·²è§¦åŠå¤©èŠ±æ¿ã€‚è¦å½»åº•è§£å†³æ‰©å±•æ€§é—®é¢˜ï¼Œå¿…é¡»æ¶ˆé™¤æ•°æ®ç‰¹å¾ä¸å­˜å‚¨å¼•æ“çš„é”™é…â€”â€”å³æˆ‘ä»¬ä¸€ç›´åœ¨è¯•å›¾ç”¨â€œå…³ç³»å‹æ•°æ®åº“â€å»æ‰¿è½½æœ¬è¯¥ç”±â€œæ—¥å¿—ç³»ç»Ÿâ€å¤„ç†çš„æ•°æ®ã€‚</p>
<p>Dify å·¥ä½œæµè®°å½•è™½ç„¶å¹¶éå®Œå…¨æ˜¯Append-Onlyå†™ï¼Œä½†å…·æœ‰é²œæ˜çš„æ—¥å¿—ç‰¹å¾ï¼Œä¸å…¸å‹çš„ä¸šåŠ¡æ•°æ®ï¼ˆå¦‚ç”¨æˆ·ä¿¡æ¯ã€åº”ç”¨é…ç½®ï¼‰æˆªç„¶ä¸åŒï¼š</p>
<ul>
<li><strong>ç»ˆæ€ä¸å¯å˜ï¼š</strong> è®°å½•ä»…åœ¨æ‰§è¡ŒæœŸçŸ­æš‚æµè½¬ï¼Œç»“æŸåå³æˆä¸ºâ€œåªè¯»â€æ¡£æ¡ˆã€‚åœ¨ PG ä¸­é•¿æœŸç•™å­˜æµ·é‡åªè¯»æ•°æ®ï¼Œä¸ä»…æŒ¤å æ˜‚è´µçš„ SSD èµ„æºï¼Œåºå¤§çš„è¡¨æ•°æ®æ›´ä¼šæ˜¾è‘—é™ä½ç´¢å¼•æ•ˆç‡ä¸æŸ¥è¯¢æ€§èƒ½ã€‚</li>
<li><strong>æ³›ç»“æ„åŒ–ä¸ Schema æ˜“å˜ï¼š</strong> æ ¸å¿ƒè´Ÿè½½ä¸ºå·¨å¤§çš„ JSON å¯¹è±¡ï¼ˆæ¯ä¸ªå·¥ä½œæµèŠ‚ç‚¹çš„Inputs/Outputsï¼‰ï¼Œä¸”ç»“æ„éšç‰ˆæœ¬è¿­ä»£ã€‚PG éš¾ä»¥é«˜æ•ˆå¤„ç†æ·±å±‚ JSON æ£€ç´¢ï¼Œä¸”äº¿çº§å¤§è¡¨çš„ DDL å˜æ›´ä¼šå¼•å‘é•¿æ—¶é—´é”è¡¨é£é™©ã€‚</li>
<li><strong>é«˜ååæ—¶åºå†™å…¥ï¼š</strong> æ—¥å¿—éšæ—¶é—´æºæºä¸æ–­åœ°äº§ç”Ÿï¼ŒæŒç»­æ¶ˆè€— IOPS ä¸æ•°æ®åº“è¿æ¥ã€‚è¯·æ±‚é«˜å³°æœŸææ˜“å¯¼è‡´è¿æ¥æ± è€—å°½ï¼Œå¯¼è‡´åˆ›å»ºåº”ç”¨ç­‰æ ¸å¿ƒä¸šåŠ¡å› èµ„æºäº‰æŠ¢è€Œå¤±è´¥ã€‚</li>
</ul>
<p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ”¯æŒ<strong>å­˜ç®—åˆ†ç¦»ã€å¼¹æ€§ä¼¸ç¼©ã€ä½æˆæœ¬ä¸”å…·å¤‡åŸç”Ÿ OLAP èƒ½åŠ›</strong>çš„å­˜å‚¨æ¶æ„ã€‚é˜¿é‡Œäº‘æ—¥å¿—æœåŠ¡ï¼ˆSLSï¼‰ å‡­å€Ÿå…¶äº‘åŸç”Ÿç‰¹æ€§ï¼Œæˆä¸ºè§£å†³è¿™ä¸€ç“¶é¢ˆçš„æœ€ä½³é€‰æ‹©ã€‚</p>
<h2 data-id="heading-6">ä¸‰ã€æ–¹æ¡ˆé€‰å‹ï¼šä¸ºä»€ä¹ˆ SLS æ›´é€‚åˆ Dify æ—¥å¿—åœºæ™¯</h2>
<p>SLS å¹¶ä¸æ˜¯â€œå¦ä¸€ä¸ªæ•°æ®åº“æ›¿ä»£â€ï¼Œå®ƒæ˜¯ä¸ºæ—¥å¿—åœºæ™¯é‡èº«å®šåˆ¶çš„åŸºç¡€è®¾æ–½ã€‚åœ¨Difyå·¥ä½œæµæ—¥å¿—åœºæ™¯ä¸‹ï¼Œç›¸æ¯”äº PGï¼ŒSLS åœ¨ä»¥ä¸‹å››ä¸ªç»´åº¦å®ç°äº†æ¶æ„ä¸Šçš„ä¼˜åŒ–å‡çº§ï¼š</p>
<h3 data-id="heading-7">æè‡´å¼¹æ€§ï¼Œåº”å¯¹æµé‡æ³¢åŠ¨</h3>
<p>Dify ä¸šåŠ¡å¸¸æœ‰çªå‘æµé‡ï¼ˆå¦‚ AI æ¨ç†é«˜å³°ï¼‰ã€‚PostgreSQL éœ€æŒ‰å³°å€¼é¢„ç½®ç¡¬ä»¶èµ„æºï¼Œä½è°·æœŸçš„èµ„æºæµªè´¹ï¼Œä¸€æ—¦æµé‡çªå¢è¶…è¿‡é¢„è®¾ä¸Šé™ï¼Œæ•°æ®åº“ç¨³å®šæ€§ä¼šæœ‰é—®é¢˜ã€‚</p>
<p>è€ŒSLS ä½œä¸º SaaS åŒ–äº‘æœåŠ¡ï¼Œå¤©ç„¶æ”¯æŒç§’çº§å¼¹æ€§ä¼¸ç¼©ï¼Œæ— é¡»å…³å¿ƒåˆ†ç‰‡æˆ–å®¹é‡ä¸Šé™ï¼Œä¸”é»˜è®¤æ”¯æŒ 3AZ åŒåŸå†—ä½™ã€‚</p>
<h3 data-id="heading-8">é«˜å†™å…¥åå + æ¶æ„è§£è€¦ï¼Œä¿éšœæ ¸å¿ƒç¨³å®š</h3>
<ul>
<li><strong>é«˜å¹¶å‘å†™å…¥ï¼š</strong> SLS é’ˆå¯¹æ—¥å¿—åœºæ™¯ä¼˜åŒ–ï¼Œæ•°æ®ä»¥è¿½åŠ æ–¹å¼é¡ºåºå†™å…¥ï¼Œé¿å…äº†æ•°æ®åº“ä¸­å¸¸è§çš„éšæœº I/O å’Œé”ç«äº‰ï¼Œèƒ½ä»¥æä½æˆæœ¬æ”¯æ’‘æ•°ä¸‡ TPS çš„å†™å…¥ååï¼Œè½»æ¾åº”å¯¹ AI ä¸šåŠ¡çš„å†™å…¥æ´ªå³°ã€‚</li>
<li><strong>èµ„æºéš”ç¦»ï¼š</strong> å°†æ—¥å¿—è´Ÿè½½å‰¥ç¦»è‡³ SLS äº‘ç«¯ï¼Œå®ç°æ—¥å¿—æ•°æ®æµä¸ Dify æ ¸å¿ƒä¸šåŠ¡äº‹åŠ¡çš„ç‰©ç†éš”ç¦»ï¼Œæœ‰æ•ˆä¿éšœä¸»ä¸šåŠ¡ç³»ç»Ÿçš„ç¨³å®šæ€§ä¸æ€§èƒ½ã€‚</li>
</ul>
<h3 data-id="heading-9">æµ·é‡æ—¥å¿—ï¼Œä½æˆæœ¬é•¿æœŸç•™å­˜</h3>
<p>SLS æ•°æ®é‡‡ç”¨é«˜å‹ç¼©æ¯”æŠ€æœ¯ï¼Œæ”¯æŒè‡ªåŠ¨åŒ–åˆ†å±‚å­˜å‚¨ï¼Œå¯å°†å†å²æ•°æ®è‡ªåŠ¨æ²‰é™è‡³ä½é¢‘å’Œå½’æ¡£å­˜å‚¨ï¼Œæ— éœ€ç»´æŠ¤æ¸…ç†è„šæœ¬ï¼Œæˆæœ¬è¿œä½äºæ•°æ®åº“ SSDã€‚è¿™ä½¿å¾— Dify èƒ½ä»¥æä½çš„æˆæœ¬æ»¡è¶³é•¿å‘¨æœŸçš„åˆ†æå’Œå®¡è®¡éœ€æ±‚ã€‚</p>
<h3 data-id="heading-10">å¼€ç®±å³ç”¨çš„æ•°æ®ä»·å€¼é‡Šæ”¾èƒ½åŠ›</h3>
<ul>
<li><strong>Schema-on-Readï¼š</strong> SLS å†™å…¥æ—¶ä¸å¼ºåˆ¶æ ¡éªŒ Schemaï¼Œå®Œç¾é€‚é… Dify å¿«é€Ÿè¿­ä»£å¸¦æ¥çš„å­—æ®µå˜æ›´ï¼Œæ— éœ€å¯¹å†å²æ•°æ®é‡æ–°å˜æ›´ã€‚</li>
<li><strong>ç§’çº§åˆ†æï¼š</strong> SLS å†…ç½®äº†é’ˆå¯¹æ—¥å¿—ä¼˜åŒ–çš„åˆ†æå¼•æ“ï¼ˆå€’æ’ç´¢å¼•+åˆ—å­˜ï¼‰ã€‚å¼€å‘è€…å¯ä»¥ä½¿ç”¨å…³é”®è¯ä»æµ·é‡æ—¥å¿—ä¸­æ£€ç´¢ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨ SQL å¯¹äº¿çº§æ—¥å¿—è¿›è¡Œå®æ—¶èšåˆåˆ†æï¼Œå°†æ—¥å¿—æ•°æ®è½¬åŒ–ä¸ºä¸šåŠ¡æ´å¯Ÿã€‚</li>
<li><strong>ä¸°å¯Œæ•°æ®ç”Ÿæ€ï¼š</strong> æ—¥å¿—åœ¨SLSä¸­ï¼Œå¯ä»¥è¿›ä¸€æ­¥è¿›è¡Œæ›´å®Œå–„çš„å¤„ç†å’Œåˆ†æï¼Œæ¯”å¦‚æ•°æ®åŠ å·¥æ¸…æ´—ã€è”åˆåˆ†æã€å¯è§†åŒ–ã€å‘Šè­¦ã€æ¶ˆè´¹å’ŒæŠ•é€’ç­‰ç­‰ã€‚</li>
</ul>
<h2 data-id="heading-11">å››ã€æŠ€æœ¯å®ç°ï¼šæ ¸å¿ƒæ¶æ„æ”¹é€ ä¸æ’ä»¶åŒ–</h2>
<p>ä¸ºäº†å°† SLS å¼•å…¥ Difyï¼Œæ•´ä¸ªå·¥ç¨‹å®æ–½åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šä¸€æ˜¯å¯¹ Dify æ ¸å¿ƒçš„æ’ä»¶åŒ–æ”¹é€ ï¼ŒäºŒæ˜¯åŸºäº SLS è¯»å†™æ—¥å¿—çš„æ’ä»¶å®ç°ã€‚</p>
<h3 data-id="heading-12">1.Dify æ ¸å¿ƒæ’ä»¶åŒ–æ”¹é€ </h3>
<p>Dify æ—©æœŸæ¶æ„ä¸­ï¼Œå·¥ä½œæµè®°å½•çš„è¯»å†™é€»è¾‘æ·±åº¦è€¦åˆäº† SQLAlchemyï¼ˆPG ORMï¼‰ï¼Œæ‰©å±•æ€§å—é™ã€‚ä» v1.4.1 ä»¥åç¤¾åŒºå¼•å…¥äº† WorkflowExecution çš„é¢†åŸŸæ¨¡å‹ï¼ˆ#20067[7]ï¼‰å¹¶å¼€å§‹é€æ­¥å¯¹å·¥ä½œæµæ‰§è¡Œæ ¸å¿ƒæµç¨‹è¿›è¡Œé‡æ„ï¼Œå®šä¹‰äº†ä¸€å¥—æ ‡å‡†çš„ Repository æ¥å£ï¼Œæ¶µç›–æ—¥å¿—çš„å†™å…¥ã€æ›´æ–°ã€è¯»å–ä»¥åŠç»Ÿè®¡ç­‰æ ‡å‡†è¡Œä¸ºã€‚åœ¨ v1.8.0 ç¤¾åŒºå¼•å…¥äº† Repository çš„å¼‚æ­¥å®ç°ï¼Œé€šè¿‡æ¨è¿Ÿæ—¥å¿—è®°å½•ä¿å­˜æå‡äº†å·¥ä½œæµæ‰§è¡Œé€Ÿåº¦ã€‚</p>
<p>è™½ç„¶ Repository æ¥å£ä¸ºå¤šå­˜å‚¨é©±åŠ¨æä¾›äº†å¯èƒ½ï¼Œä½†æ—©æœŸçš„æŠ½è±¡å¹¶ä¸å½»åº•ï¼šå®ƒä¸»è¦è§£å†³äº†â€œå†™â€çš„æŠ½è±¡ï¼Œä½†å¤§é‡â€œè¯»â€æ“ä½œä»ç»•è¿‡ Repository ç›´æ¥ä¾èµ– SQLAlchemyï¼Œä¸”å¤æ‚çš„è·¨è¡¨ Join æŸ¥è¯¢ä½¿å¾—å­˜å‚¨å±‚éš¾ä»¥çœŸæ­£å‰¥ç¦»ã€‚</p>
<p>ä¸ºæ­¤ï¼Œæˆ‘ä»¬å’Œ Dify ç ”å‘å›¢é˜Ÿå¤šæ¬¡äº¤æµï¼Œç¡®å®šäº† Repository æŠ½è±¡å±‚çš„å®Œæ•´å®ç°æ–¹æ¡ˆã€‚æˆ‘ä»¬é€šè¿‡å‰¥ç¦»è·¨è¡¨å…³è”æŸ¥è¯¢ã€æ ‡å‡†åŒ–è¯»å–ä¸ç»Ÿè®¡æ¥å£ï¼ŒçœŸæ­£å®ç°äº†å­˜å‚¨å±‚çš„å®Œå…¨è§£è€¦ä¸æ’ä»¶åŒ–åŠ è½½ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9134545808d64137babd480eb1803ce1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=F0EI47Kaaq%2BkVtx888Z%2ByO4qAZA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-13">2.SLS æ—¥å¿—æ’ä»¶å®ç°</h3>
<p>åœ¨æ’ä»¶å®ç°è¿‡ç¨‹ä¸­ï¼Œæ ¸å¿ƒæŒ‘æˆ˜åœ¨äºæŠ¹å¹³å…³ç³»å‹æ•°æ®åº“ï¼ˆPGï¼‰ä¸æ—¥å¿—ç³»ç»Ÿï¼ˆSLSï¼‰åœ¨æ•°æ®æ¨¡å‹ä¸Šçš„å·®å¼‚ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†ä»¥ä¸‹æŠ€æœ¯ç­–ç•¥ï¼š</p>
<h4 data-id="heading-14">åŸºäºå¤šç‰ˆæœ¬çš„çŠ¶æ€ç®¡ç†</h4>
<p>SLS çš„ LogStore æ˜¯ Append-Only è¿½åŠ å†™å…¥ï¼Œè€ŒDify çš„å·¥ä½œæµæ‰§è¡Œè¿‡ç¨‹å­˜åœ¨çŠ¶æ€æµè½¬ï¼Œä»Â <code>RUNNING</code>Â å˜ä¸ºÂ <code>SUCCEEDED/FAIL</code>ã€‚å› æ­¤æˆ‘ä»¬é‡‡ç”¨äº†å¤šç‰ˆæœ¬æ§åˆ¶çš„æ€è·¯ï¼š</p>
<ul>
<li>å†™å…¥ç­–ç•¥ï¼šæ¯æ¬¡çŠ¶æ€æ›´æ–°ï¼Œä¸è¦†ç›–æ—§æ—¥å¿—ï¼Œè€Œæ˜¯æ–°å†™å…¥ä¸€æ¡åŒ…å«å®Œæ•´çŠ¶æ€çš„æ—¥å¿—è®°å½•ã€‚æˆ‘ä»¬åœ¨æ—¥å¿—æ¨¡å‹ä¸­å¼•å…¥äº†ä¸€ä¸ªçº³ç§’çº§çš„æ—¶é—´æˆ³å­—æ®µÂ <code>log_version</code>æ¥åŒºåˆ†ç‰ˆæœ¬ã€‚</li>
<li>è¯»å–ç­–ç•¥ï¼šåœ¨æŸ¥è¯¢æˆ–ç»Ÿè®¡æ—¶ï¼Œæ’ä»¶å†…éƒ¨ä¼šç”Ÿæˆèšåˆ SQLï¼Œå¯¹äºåŒä¸€ä¸ªÂ <code>workflow_run_id</code>ï¼Œå§‹ç»ˆé€‰å–Â <code>log_version</code>Â æœ€å¤§çš„é‚£æ¡è®°å½•ä½œä¸ºæœ€ç»ˆçŠ¶æ€ã€‚</li>
</ul>
<h4 data-id="heading-15">Schema è‡ªåŠ¨åŒæ­¥</h4>
<p>Dify çš„è¿­ä»£é€Ÿåº¦éå¸¸å¿«ï¼Œæ•°æ®åº“æ¨¡å‹ç»å¸¸å‘ç”Ÿå˜æ›´ã€‚å¦‚æœæ¯æ¬¡å‡çº§ Dify éƒ½éœ€è¦ç”¨æˆ·æ‰‹åŠ¨ç»´æŠ¤ç´¢å¼•é…ç½®ï¼Œå°†æå¤§åœ°å¢åŠ è¿ç»´è´Ÿæ‹…ã€‚SLS æ’ä»¶å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨æ‰«æ SQLAlchemy æ¨¡å‹å®šä¹‰ï¼Œå¹¶ä¸ SLS ç´¢å¼•é…ç½®è¿›è¡Œ Diffã€‚ä¸€æ—¦å‘ç°æ–°å­—æ®µï¼Œè‡ªåŠ¨è°ƒç”¨ API æ›´æ–°ç´¢å¼•ã€‚ç”¨æˆ·æ— éœ€æ‰‹åŠ¨ç»´æŠ¤ç´¢å¼•ï¼Œå¼€å‘è€…ä¹Ÿæ— é¡»ä¸º SLS å•ç‹¬ç¼–å†™å‡çº§è„šæœ¬ã€‚</p>
<h4 data-id="heading-16">åŸç”Ÿ PG åè®®å…¼å®¹</h4>
<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒSLS æ–°å¢åŸç”Ÿæ”¯æŒ PostgreSQL åè®®ã€‚ç»å¤§éƒ¨åˆ†åŸæœ‰çš„ç»Ÿè®¡ä¸åˆ†æ SQLï¼Œå‡å¯é€šè¿‡ PG å…¼å®¹æ¨¡å¼ç›´æ¥å‘é€åˆ° SLS ä¸Šæ‰§è¡Œï¼Œæå¤§åœ°é™ä½äº†æ’ä»¶çš„å¼€å‘é€‚é…æˆæœ¬ã€‚</p>
<h2 data-id="heading-17">äº”ã€å®è·µæŒ‡å—ï¼šé…ç½®ä¸å¹³æ»‘è¿ç§»</h2>
<p>è¯¥åŠŸèƒ½å·²æ­£å¼åˆå¹¶è‡³ Dify ç¤¾åŒºä¸»åˆ†æ”¯ã€‚åŸºäºDifyæœ€æ–°ä»£ç ï¼Œåªéœ€è¿›è¡Œç®€å•é…ç½®ï¼Œå°±å¯ä»¥å°†å·¥ä½œæµæ‰§è¡Œè®°å½•åˆ‡æ¢åˆ°SLSå­˜å‚¨ã€‚</p>
<h3 data-id="heading-18">ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡å·¥ä½œ</h3>
<p>ï¼ˆ1ï¼‰åˆ›å»º Projectï¼šåœ¨é˜¿é‡Œäº‘æ—¥å¿—æœåŠ¡æ§åˆ¶å°åˆ›å»º Projectï¼ˆå»ºè®®ä¸ä¸šåŠ¡åŒåœ°åŸŸï¼‰</p>
<blockquote>
<p>æ— éœ€æ‰‹åŠ¨åˆ›å»º Logstore å’Œç´¢å¼•ï¼ŒDify å¯åŠ¨åæ’ä»¶ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶åˆ›å»ºã€‚</p>
</blockquote>
<p>ï¼ˆ2ï¼‰è·å–è®¿é—®å‡­è¯ï¼šè·å–å…·å¤‡ SLS è¯»å†™æƒé™çš„ AccessKey ID å’Œ Secretã€‚</p>
<blockquote>
<p>å¯ä»¥æˆäºˆÂ <code>AliyunLogFullAccess</code>ï¼Œæˆ–æŒ‰éœ€é…ç½®æœ€å°æƒé™ï¼ˆåˆ›å»º/æŸ¥çœ‹Projectã€åˆ›å»º/æŸ¥çœ‹logstoreã€åˆ›å»º/æ›´æ–°/æŸ¥çœ‹ç´¢å¼•ã€å†™æ—¥å¿—ã€æŸ¥æ—¥å¿—ç­‰ï¼‰</p>
</blockquote>
<h3 data-id="heading-19">ç¬¬äºŒæ­¥ï¼šé…ç½®Dify</h3>
<p>åœ¨Â <code>.env</code>Â æˆ–Â <code>docker-compose.yaml</code>Â ä¸­ä¿®æ”¹ä»¥ä¸‹é…ç½®é¡¹ï¼Œå°†å·¥ä½œæµå­˜å‚¨é©±åŠ¨æŒ‡å‘ SLS æ’ä»¶ï¼Œå¹¶è¡¥å……è¿æ¥ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># 1. ä¿®æ”¹ Repository é©±åŠ¨æŒ‡å‘ SLS æ’ä»¶</span>
<span class="hljs-attr">CORE_WORKFLOW_EXECUTION_REPOSITORY</span>=extensions.logstore.repositories.logstore_workflow_execution_repository.LogstoreWorkflowExecutionRepository
<span class="hljs-attr">CORE_WORKFLOW_NODE_EXECUTION_REPOSITORY</span>=extensions.logstore.repositories.logstore_workflow_node_execution_repository.LogstoreWorkflowNodeExecutionRepository
<span class="hljs-attr">API_WORKFLOW_NODE_EXECUTION_REPOSITORY</span>=extensions.logstore.repositories.logstore_api_workflow_node_execution_repository.LogstoreAPIWorkflowNodeExecutionRepository
<span class="hljs-attr">API_WORKFLOW_RUN_REPOSITORY</span>=extensions.logstore.repositories.logstore_api_workflow_run_repository.LogstoreAPIWorkflowRunRepository

<span class="hljs-comment"># 2. æ–°å¢ SLS è¿æ¥é…ç½®</span>
<span class="hljs-attr">ALIYUN_SLS_ACCESS_KEY_ID</span>=your_access_key_id
<span class="hljs-attr">ALIYUN_SLS_ACCESS_KEY_SECRET</span>=your_access_key_secret
<span class="hljs-attr">ALIYUN_SLS_ENDPOINT</span>=cn-hangzhou.log.aliyuncs.com
<span class="hljs-attr">ALIYUN_SLS_REGION</span>=cn-hangzhou
<span class="hljs-attr">ALIYUN_SLS_PROJECT_NAME</span>=your_project_name
<span class="hljs-attr">ALIYUN_SLS_LOGSTORE_TTL</span>=<span class="hljs-number">365</span>Â Â <span class="hljs-comment"># æ—¥å¿—å­˜å‚¨å¤©æ•°</span>

<span class="hljs-comment"># 3. è¿ç§»å¼€å…³é…ç½®</span>
<span class="hljs-attr">LOGSTORE_DUAL_WRITE_ENABLED</span>=<span class="hljs-literal">false</span>
<span class="hljs-attr">LOGSTORE_DUAL_READ_ENABLED</span>=<span class="hljs-literal">true</span>
</code></pre>
<p>ä¸ºäº†ä¿è¯å­˜é‡ PG ç”¨æˆ·èƒ½å¹³æ»‘å‡çº§åˆ° SLS ç‰ˆæœ¬ï¼Œæˆ‘ä»¬åœ¨æ’ä»¶ä¸­æä¾›äº†ä¸¤ä¸ªå¼€å…³ï¼š</p>
<p>ï¼ˆ1ï¼‰åŒå†™æœºåˆ¶ï¼šé€šè¿‡é…ç½®Â <code>LOGSTORE_DUAL_WRITE_ENABLED=True</code>ï¼ˆé»˜è®¤å…³é—­ï¼‰ï¼Œç³»ç»Ÿä¼šå°†æ—¥å¿—åŒæ—¶å†™å…¥ PG å’Œ SLSã€‚è¿™é€‚ç”¨äºå­˜é‡ç”¨æˆ·è¿ç§»åˆæœŸçš„ç°åº¦éªŒè¯ï¼Œç¡®ä¿åœ¨ä¸æ”¹å˜åŸæœ‰æ•°æ®æµçš„æƒ…å†µä¸‹ï¼ŒéªŒè¯ SLS çš„é…ç½®æ­£ç¡®æ€§å’Œ Dify ç‰ˆæœ¬å‡çº§æœ¬èº«çš„å…¼å®¹æ€§ã€‚</p>
<p>ï¼ˆ2ï¼‰åŒè¯»é™çº§æœºåˆ¶ï¼šé€šè¿‡é…ç½®Â <code>LOGSTORE_DUAL_READ_ENABLED=True</code>ï¼ˆé»˜è®¤å¼€å¯ï¼‰ï¼Œç³»ç»Ÿä¼˜å…ˆä» SLS è¯»å–æ—¥å¿—ã€‚å¦‚æœ SLS ä¸­æœªæ‰¾åˆ°è¯¥è®°å½•ï¼ˆä¾‹å¦‚è¿ç§»å‰çš„è€å†å²æ•°æ®ï¼‰ï¼Œæ’ä»¶ä¼šè‡ªåŠ¨é™çº§å› PG å†æ¬¡å°è¯•è¯»å–ã€‚</p>
<h2 data-id="heading-20">å…­ã€æˆæ•ˆå¯¹æ¯”ï¼šè¿ç§»åˆ°SLSçš„ä¸‰å¤§æ”¶ç›Š</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aea0cb21a5e24771aeffdf497955ece5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=DxndBXmlkeKxm1hQInl7Nas1ZQw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-21">æ”¶ç›Šä¸€ï¼šDBå‹åŠ›æ˜¾è‘—ä¸‹é™</h3>
<p>åˆ‡æ¢åˆ°SLSï¼Œç›¸å½“äºæŠŠç°æœ‰PGä¸­æ•°æ®é‡æœ€å¤§çš„ä¸¤å¼ è¡¨çš„æ•°æ®è¿ç§»èµ°äº†ã€‚æ ¹æ®æˆ‘ä»¬çº¿ä¸Šä¸šåŠ¡çš„æ•°æ®ï¼ŒDBå‡å°‘äº†95%ä»¥ä¸Šçš„å­˜å‚¨ç©ºé—´ï¼ˆè¿è¡Œæ—¶é—´è¶Šé•¿ï¼Œè¿™ä¸ªæ¯”ä¾‹è¶Šé«˜ï¼‰ï¼Œå¹¶ä¸”è¯»å†™è¿‡ç¨‹ä¸­çš„DBçš„è¿æ¥æ•°ã€CPUç­‰å‹åŠ›ä¹Ÿæœ‰æ˜¾è‘—é™ä½ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d4d2c9bfc0a7413c80c84ef6e342f40f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=onbuHtEOBnkJxbvllkTrlJuoNL8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-22">æ”¶ç›ŠäºŒï¼šå­˜å‚¨æˆæœ¬å¤§å¹…é™ä½</h3>
<p>ä¸ºäº†ç›´è§‚é‡åŒ–è¿ç§»åçš„æˆæœ¬æ”¶ç›Šï¼Œæˆ‘ä»¬ä»¥ä¸€ä¸ªå…¸å‹çš„ç”Ÿäº§çº§åœºæ™¯è¿›è¡Œä¼°ç®—ï¼šå‡è®¾ Dify åº”ç”¨æ—¥å¢æ—¥å¿— 10GBï¼Œä¸ºäº†æ»¡è¶³æ¨¡å‹è¯„ä¼°ä¸å›æº¯éœ€æ±‚ï¼Œéœ€ç•™å­˜æœ€è¿‘ 300 å¤©ï¼ˆçº¦ 3TBï¼‰çš„æ•°æ®ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d62106f5d70411191263f4516ecbb77~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=t0jTFhJJVBs9wMNLEBH0291WpA8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<blockquote>
<p>æ³¨ï¼šè¿™é‡Œä¼°ç®—SLSæˆæœ¬çš„æ—¶å€™ï¼Œå·²ç»å°†å­˜å¤šæ¡çŠ¶æ€è®°å½•ä¼šå ç”¨å­˜å‚¨ç©ºé—´çš„å› ç´ è€ƒè™‘è¿›å»ã€‚ æ­¤å¤–å¯¹äºPGå®é™…ç”Ÿäº§ä¸­è¿˜éœ€é¢å¤–è€ƒè™‘é«˜å¯ç”¨å¤šå‰¯æœ¬ã€é¢„ç•™å­˜å‚¨ç©ºé—´ã€è¿æ¥æ± æ‰©å®¹ç­‰éšæ€§æˆæœ¬ã€‚</p>
</blockquote>
<p>è¿™é‡Œé€ æˆè¿‘Â 10 å€æˆæœ¬å·®è·Â çš„æ ¹æœ¬åŸå› åœ¨äºå­˜å‚¨æœºåˆ¶çš„ä¸åŒã€‚</p>
<p>Difyçš„å·¥ä½œæµè®°å½•åŒ…å«äº†ç”¨æˆ·æé—®ã€çŸ¥è¯†å¬å›ã€å·¥å…·è°ƒç”¨å’Œæ¨¡å‹å“åº”ç­‰æ•°æ®ï¼Œæ˜¯è¯„ä¼°å’Œå›å½’ç­‰ä»»åŠ¡éœ€è¦çš„æ•°æ®èµ„äº§ï¼Œé•¿æœŸç•™å­˜ä»·å€¼é«˜ã€‚</p>
<ul>
<li><strong>å¯¹äº PGï¼š</strong> å­˜å‚¨æ—¶é—´è¶Šé•¿ï¼Œæ•°æ®é‡è¶Šå¤§ï¼Œå¯¹æ˜‚è´µçš„ SSD å­˜å‚¨ç©ºé—´å ç”¨å°±è¶Šå¤šï¼Œæˆæœ¬ä¼šå¤§å¹…å¢é•¿ã€‚pgå®ä¾‹éœ€è¦æå‰é¢„ä¼°å­˜å‚¨ç©ºé—´ï¼Œå­˜å‚¨ç©ºé—´ä¸å¯èƒ½å®Œå…¨åˆ©ç”¨èµ·æ¥ï¼Œå¿…ç„¶é—²ç½®ä¸€éƒ¨åˆ†ç©ºé—´ã€‚</li>
<li><strong>å¯¹äº SLSï¼š</strong> ä¸“ä¸ºæ—¥å¿—è®¾è®¡çš„é«˜å‹ç¼©æ¯”ä¸åˆ†å±‚å­˜å‚¨æŠ€æœ¯ï¼Œä½¿å¾—å­˜å‚¨æ•°æ®é‡è¶Šå¤§ã€æ—¶é—´è¶Šé•¿ï¼Œå…¶è¾¹é™…æˆæœ¬ä¼˜åŠ¿è¶Šæ˜æ˜¾ã€‚</li>
</ul>
<h3 data-id="heading-23">æ”¶ç›Šä¸‰ï¼šæ•°æ®ä»·å€¼é‡Šæ”¾ï¼Œä»â€œè¿ç»´ç›‘æ§â€åˆ°â€œä¸šåŠ¡æ´å¯Ÿâ€</h3>
<p>è¿™é‡Œæˆ‘ä»¬ä»¥ä¸€ä¸ªçœŸå®çš„ Dify åº”ç”¨åœºæ™¯â€”â€”â€œç”µå•†æ™ºèƒ½å®¢æœåŠ©æ‰‹â€ä¸ºä¾‹ï¼Œå±•ç¤ºæ—¥å¿—æ•°æ®æ¥å…¥ SLS åï¼Œå¦‚ä½•æŒ–æ˜å…¶èƒŒåæ›´å¤§çš„ä¸šåŠ¡ä»·å€¼ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/34f07812069f4240a95ced39194b1c01~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=GTVZOmUKBO82gcTS9uB7GtqXa1U%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-24">ï¼ˆ1ï¼‰æ— ç¼é›†æˆï¼ŒåŸç”Ÿä½“éªŒ</h4>
<p>æ¥å…¥ SLS åï¼ŒDify ç•Œé¢ä¸Šçš„æ—¥å¿—æŸ¥è¯¢ä¸å›æº¯ä½“éªŒä¿æŒä¸å˜ï¼Œä½†åº•å±‚å­˜å‚¨å·²å®Œå…¨åˆ‡æ¢ã€‚</p>
<ul>
<li>æ—¥å¿—å›æº¯ï¼šDify æ§åˆ¶å°çš„æ—¥å¿—è¯¦æƒ…é¡µç›´æ¥ä» SLS è¯»å–æ•°æ®ï¼Œå“åº”æ›´è¿…é€Ÿã€‚</li>
<li>ç›‘æ§å›¾è¡¨ï¼šDify å†…ç½®çš„ç›‘æ§ç»Ÿè®¡å›¾è¡¨ï¼Œä¹Ÿæ˜¯é€šè¿‡æ‰§è¡Œ SLS SQL å®æ—¶ç”Ÿæˆçš„ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/488198cf9d744b73a6749e36e5a881d1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=ZAz2mNYyhoeYHFd6dlOW0V8BZCY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-25">ï¼ˆ2ï¼‰è¶…è¶ŠåŸºç¡€ï¼ŒSLS è¿›é˜¶åˆ†æ</h4>
<p>è™½ç„¶ Dify å†…ç½®äº†åŸºç¡€æŸ¥è¯¢å’Œç»Ÿè®¡åŠŸèƒ½ï¼Œä½†é¢å¯¹å¤æ‚çš„ä¸šåŠ¡åˆ†æéœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è½¬è‡³ SLS æ§åˆ¶å°ï¼Œè§£é”æ›´å¼ºå¤§çš„èƒ½åŠ›ã€‚</p>
<ul>
<li><strong>ä»»æ„å­—æ®µçš„é«˜é€Ÿæ£€ç´¢</strong></li>
</ul>
<p>SLS æ”¯æŒå…¨æ–‡ç´¢å¼•å’Œä»»æ„é”®å€¼å¯¹æ¡ä»¶çš„ç»„åˆæŸ¥è¯¢ï¼Œå¿«é€Ÿç²¾å‡†æ£€ç´¢å‡ºç¬¦åˆæŸç§ç‰¹å®šç‰¹å¾çš„æ—¥å¿—ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0192c2f638134b7ebc8daf0d20ef34e5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=yBjE%2BqKPuZ2yni%2B8A%2B9eteLnOr0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li><strong>ä¸šåŠ¡è¶‹åŠ¿åˆ†æï¼ˆå¯è§†åŒ–ï¼‰åœºæ™¯</strong></li>
</ul>
<p>æ¯”å¦‚è¿™é‡Œæˆ‘ä»¬åˆ†æâ€œç”¨æˆ·æ„å›¾è¯†åˆ«â€è¿™ä¸ªå·¥ä½œæµèŠ‚ç‚¹é‡Œï¼ŒæŒ‰è¯†åˆ«å‡ºçš„ç”¨æˆ·æ„å›¾çš„åˆ†ç±»ç»Ÿè®¡éšæ—¶é—´å˜åŒ–çš„PVæƒ…ï¼Œä¾¿äºé€šè¿‡è§‚å¯Ÿä¸åŒåˆ†ç±»çš„è¶‹åŠ¿å˜åŒ–ï¼Œåšå‡ºç›¸åº”çš„è¿è¥å†³ç­–ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-operator">*</span>Â <span class="hljs-keyword">and</span>Â title: ç”¨æˆ·æ„å›¾è¯†åˆ«Â <span class="hljs-keyword">and</span>Â intentÂ <span class="hljs-operator">|</span>Â <span class="hljs-keyword">select</span>Â json_extract(outputs,Â <span class="hljs-string">'$.intent'</span>)Â <span class="hljs-keyword">as</span>Â "ç”¨æˆ·æ„å›¾", date_trunc(<span class="hljs-string">'minute'</span>, __time__) t,Â <span class="hljs-built_in">count</span>(<span class="hljs-number">1</span>)Â <span class="hljs-keyword">as</span>Â pvÂ <span class="hljs-keyword">group</span>Â <span class="hljs-keyword">by</span>Â "ç”¨æˆ·æ„å›¾",tÂ <span class="hljs-keyword">order</span>Â <span class="hljs-keyword">by</span>Â t limitÂ <span class="hljs-keyword">all</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/692159a7f5104fa69597b423df8b19bb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=svJH61m4JahxuSeXK6brd3so%2By4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li><strong>å¼‚å¸¸è¯Šæ–­ï¼ˆæ¼æ–—åˆ†æï¼‰åœºæ™¯</strong></li>
</ul>
<p>å¯ä»¥é€šè¿‡æ¼æ–—å›¾ï¼Œåˆ†æè§‚å¯Ÿå·¥ä½œæµå“ªäº›ä¸­é—´èŠ‚ç‚¹å‡ºç°å¼‚å¸¸å¤±è´¥çš„æ¯”ç‡è¾ƒé«˜ã€‚</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">status:</span>succeededÂ |Â <span class="hljs-keyword">select</span>Â title,Â count(<span class="hljs-keyword">distinct</span>Â workflow_run_id) cntÂ <span class="hljs-keyword">group</span>Â <span class="hljs-keyword">by</span>Â titleÂ <span class="hljs-keyword">order</span>Â <span class="hljs-keyword">by</span>Â cntÂ desc
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d9889e516acc4f90b5fad6938d3eec7f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=w%2BQdP13JYArRO6PK%2FvGRitBiRy8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li><strong>æˆæœ¬ä¸é£é™©é£æ§ï¼ˆå®æ—¶å‘Šè­¦ï¼‰åœºæ™¯</strong></li>
</ul>
<p>é…ç½®å‘Šè­¦è§„åˆ™ï¼Œç»Ÿè®¡ LLM èŠ‚ç‚¹çš„ Token æ¶ˆè€—ï¼Œä¸€æ—¦è¶…è¿‡é¢„è®¾é˜ˆå€¼ï¼Œç«‹å³è§¦å‘é’‰é’‰/ç”µè¯å‘Šè­¦ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e94041094dcf439f97c7315fcee0124a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=RJLTS3%2FglNn7YziG0zJyXZPygC8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li><strong>æ•°æ®é—­ç¯ï¼ˆETL ä¸åŠ å·¥ï¼‰åœºæ™¯</strong></li>
</ul>
<p>åˆ©ç”¨æ•°æ®åŠ å·¥å’Œå®šæ—¶ SQLï¼Œå¯¹å·¥ä½œæµçš„è¾“å…¥è¾“å‡ºè¿›è¡Œæ¸…æ´—ã€è„±æ•ä¸æ ‡å‡†åŒ–ï¼Œæ„å»ºæŒç»­æ›´æ–°çš„è¯„ä¼°ä¸è®­ç»ƒæ•°æ®é›†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1e5a8e291fa24253b68e6ba96b991445~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=nw7RMdGNFYrnaJHMgSc5Hr4gXm0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ€»ä¹‹ï¼Œå°† Dify å·¥ä½œæµæ—¥å¿—æ¥å…¥ SLSï¼Œä¸ä»…èƒ½é«˜æ•ˆæŸ¥è¯¢æ—¥å¿—ï¼Œæ›´èƒ½é€šè¿‡åˆ†æã€å¯è§†åŒ–ã€å‘Šè­¦å’Œæ•°æ®åŠ å·¥ï¼Œå°†æ—¥å¿—è½¬åŒ–ä¸ºä¸šåŠ¡æ´å¯Ÿï¼ŒçœŸæ­£å®ç°ä»â€œçœ‹æ—¥å¿—â€åˆ°â€œæ‡‚ä¸šåŠ¡â€çš„è·ƒå‡ã€‚</p>
<h2 data-id="heading-26">ä¸ƒã€æ€»ç»“ï¼šè¿ˆå‘ç”Ÿäº§çº§ AI æ¶æ„</h2>
<p>å°† Dify è¿è¡Œæ—¥å¿—è¿ç§»è‡³é˜¿é‡Œäº‘ SLSï¼Œå¹¶éä¸€æ¬¡ç®€å•çš„â€œå­˜å‚¨æ›¿æ¢â€ï¼Œè€Œæ˜¯ Dify å‘ç”Ÿäº§çº§é«˜å¯ç”¨æ¶æ„æ¼”è¿›çš„å…³é”®ä¸€è·ƒã€‚</p>
<p>æˆ‘ä»¬é€šè¿‡ä¸šåŠ¡æ•°æ®ä¸æ—¥å¿—æ•°æ®è§£è€¦çš„æ¶æ„æ”¹é€ ï¼ŒæˆåŠŸå°†é«˜ååã€æ³›ç»“æ„åŒ–çš„æ—¥å¿—æµä»äº‹åŠ¡å‹æ•°æ®åº“ä¸­å‰¥ç¦»ã€‚è®© PostgreSQL ä¸“æ³¨æ ¸å¿ƒä¸šåŠ¡äº‹åŠ¡å¤„ç†ï¼Œè®© SLS å……åˆ†å‘æŒ¥å…¶åœ¨æµ·é‡æ•°æ®å­˜å‚¨ä¸åˆ†æä¸Šçš„åŸç”Ÿä¼˜åŠ¿ã€‚</p>
<p>è¿™ä¸€ç‰¹æ€§å¸¦æ¥çš„ä»·å€¼æ˜¯å…¨æ–¹ä½çš„ï¼š</p>
<ul>
<li><strong>è§£å†³DBæ€§èƒ½ç“¶é¢ˆï¼š</strong> å°†æ—¥å¿—ä¸æ ¸å¿ƒäº‹åŠ¡è§£è€¦ï¼Œä»æ ¹æœ¬ä¸Šè§£å†³æ•°æ®åº“ç“¶é¢ˆï¼Œä¿è¯æ ¸å¿ƒä¸šåŠ¡ç¨³å®šæ€§ã€‚</li>
<li><strong>å¤§å¹…é™ä½æ—¥å¿—æˆæœ¬ï¼š</strong> åˆ©ç”¨SLSçš„å¼¹æ€§ä¼¸ç¼©ã€é«˜å‹ç¼©æ¯”ã€åˆ†å±‚å­˜å‚¨ï¼Œä½æˆæœ¬å­˜å‚¨æµ·é‡æ—¥å¿—ã€‚</li>
<li><strong>å……åˆ†é‡Šæ”¾æ•°æ®ä»·å€¼ï¼š</strong> ä»ç®€å•çš„æ—¥å¿—æŸ¥çœ‹å‡çº§ä¸ºå¼ºå¤§çš„å®æ—¶åˆ†æã€ç›‘æ§å‘Šè­¦ã€åŠ å·¥å¤„ç†ï¼Œå°†è¿ç»´æ•°æ®è½¬æ¢ä¸ºä¸šåŠ¡æ´å¯Ÿã€‚</li>
</ul>
<p>å¦‚æœæ‚¨æ­£åœ¨æ„å»ºå¤§è§„æ¨¡çš„ AI åº”ç”¨ï¼Œæˆ–è€…æ­£è¢« Dify æ•°æ®åº“çš„æ€§èƒ½ç“¶é¢ˆæ‰€å›°æ‰°ï¼Œç°åœ¨å°±æ˜¯å‡çº§çš„æœ€ä½³æ—¶æœºã€‚æ‹¥æŠ±äº‘åŸç”Ÿæ—¥å¿—æ¶æ„ï¼Œè®©æ‚¨çš„ Dify è·‘å¾—æ›´å¿«ã€æ›´ç¨³ã€æ›´æ™ºèƒ½ã€‚</p>
<p><strong>å‚è€ƒé“¾æ¥ï¼š</strong></p>
<p>[1]<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flanggenius%2Fdify%2Fissues%2F22307" target="_blank" title="https://github.com/langgenius/dify/issues/22307" ref="nofollow noopener noreferrer">github.com/langgenius/â€¦</a></p>
<p>[2]<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flanggenius%2Fdify%2Fissues%2F18800%23event-17534118862" target="_blank" title="https://github.com/langgenius/dify/issues/18800#event-17534118862" ref="nofollow noopener noreferrer">github.com/langgenius/â€¦</a></p>
<p>[3]<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flanggenius%2Fdify%2Fissues%2F22796" target="_blank" title="https://github.com/langgenius/dify/issues/22796" ref="nofollow noopener noreferrer">github.com/langgenius/â€¦</a></p>
<p>[4]<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flanggenius%2Fdify%2Fissues%2F20147" target="_blank" title="https://github.com/langgenius/dify/issues/20147" ref="nofollow noopener noreferrer">github.com/langgenius/â€¦</a></p>
<p>[5]<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flanggenius%2Fdify%2Fpull%2F20050" target="_blank" title="https://github.com/langgenius/dify/pull/20050" ref="nofollow noopener noreferrer">github.com/langgenius/â€¦</a></p>
<p>[6]<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flanggenius%2Fdify%2Fissues%2F23399" target="_blank" title="https://github.com/langgenius/dify/issues/23399" ref="nofollow noopener noreferrer">github.com/langgenius/â€¦</a></p>
<p>[7]<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flanggenius%2Fdify%2Fpull%2F20067" target="_blank" title="https://github.com/langgenius/dify/pull/20067" ref="nofollow noopener noreferrer">github.com/langgenius/â€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Jetpack ViewModelå†…å¹•ï¼šå†…éƒ¨æœºåˆ¶ä¸è·¨å¹³å°è®¾è®¡]]></title>    <link>https://juejin.cn/post/7587634022575472703</link>    <guid>https://juejin.cn/post/7587634022575472703</guid>    <pubDate>2025-12-25T12:29:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587634022575472703" data-draft-id="7587631760253566995" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Jetpack ViewModelå†…å¹•ï¼šå†…éƒ¨æœºåˆ¶ä¸è·¨å¹³å°è®¾è®¡"/> <meta itemprop="keywords" content="Android,Android Jetpack,Kotlin"/> <meta itemprop="datePublished" content="2025-12-25T12:29:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨€æœ‰çŒ¿è¯‰"/> <meta itemprop="url" content="https://juejin.cn/user/2788017216685784"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Jetpack ViewModelå†…å¹•ï¼šå†…éƒ¨æœºåˆ¶ä¸è·¨å¹³å°è®¾è®¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2788017216685784/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨€æœ‰çŒ¿è¯‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T12:29:27.000Z" title="Thu Dec 25 2025 12:29:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»20åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¯‘è‡ªã€ŒInside Jetpack ViewModel: Internal Mechanisms and Multiplatform Designã€ï¼ŒåŸæ–‡é“¾æ¥<a href="https://link.juejin.cn?target=https%3A%2F%2Fproandroiddev.com%2Finside-jetpack-viewmodel-internal-mechanisms-and-multiplatform-design-2625671eaef8" target="_blank" title="https://proandroiddev.com/inside-jetpack-viewmodel-internal-mechanisms-and-multiplatform-design-2625671eaef8" ref="nofollow noopener noreferrer">proandroiddev.com/inside-jetpâ€¦</a>ï¼Œç”±Jaewoong Eumå‘å¸ƒäº2025å¹´12æœˆ7æ—¥ã€‚</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e851a5c89cf84d56883d19e87a66312f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iA5pyJ54y_6K-J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767270566&amp;x-signature=HWDRdZzKfSIhfBj5JrghD3QEsaY%3D" alt="Unsplash@davidvig" loading="lazy"/></p>
<p>Jetpack çš„ ViewModel å·²æˆä¸ºç°ä»£ Android å¼€å‘ä¸­ä¸å¯æˆ–ç¼ºçš„ç»„ä»¶ï¼Œå®ƒä¸º UI ç›¸å…³æ•°æ®æä¾›äº†ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥å®¹å™¨ï¼Œå³ä½¿é…ç½®å‘ç”Ÿæ›´æ”¹ï¼Œæ•°æ®ä¹Ÿèƒ½ä¿æŒä¸å˜ã€‚è™½ç„¶å…¶ API è¡¨é¢ä¸Šçœ‹èµ·æ¥å¾ˆç®€å•ï¼Œä½†å…¶å†…éƒ¨æœºåˆ¶å´å±•ç°äº†å›´ç»•ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€è·¨å¹³å°æŠ½è±¡ã€èµ„æºæ¸…ç†å’Œçº¿ç¨‹å®‰å…¨ç¼“å­˜ç­‰æ–¹é¢çš„è®¾è®¡å†³ç­–ã€‚äº†è§£ ViewModel çš„åº•å±‚å·¥ä½œåŸç†æœ‰åŠ©äºä½ åšå‡ºæ›´ä¼˜çš„æ¶æ„å†³ç­–ï¼Œå¹¶é¿å…ä¸€äº›ä¸æ˜“å¯Ÿè§‰çš„é”™è¯¯ã€‚</p>
<p>æœ¬æ–‡å°†æ·±å…¥æ¢è®¨ Jetpack ViewModel çš„å†…éƒ¨å·¥ä½œåŸç†ï¼ŒåŒ…æ‹¬ <code>ViewModelStore</code> å¦‚ä½•åœ¨é…ç½®æ›´æ”¹åä¿ç•™å®ä¾‹ã€<code>ViewModelProvider</code> å¦‚ä½•åè°ƒåˆ›å»ºå’Œç¼“å­˜ã€å·¥å‚æ¨¡å¼å¦‚ä½•å®ç°çµæ´»çš„å®ä¾‹åŒ–ã€<code>CreationExtras</code> å¦‚ä½•å®ç°æ— çŠ¶æ€å·¥å‚ã€å¦‚ä½•é€šè¿‡ Closeable æ¨¡å¼ç®¡ç†èµ„æºæ¸…ç†ï¼Œä»¥åŠ <code>viewModelScope</code> å¦‚ä½•å°†åç¨‹ä¸ ViewModel ç”Ÿå‘½å‘¨æœŸé›†æˆã€‚</p>
<h2 data-id="heading-0">æ ¹æœ¬é—®é¢˜ï¼šé…ç½®æ›´æ”¹åçš„ä¿ç•™</h2>
<p>é…ç½®æ›´æ”¹æ˜¯ Android å¼€å‘é¢ä¸´çš„ä¸€é¡¹æ ¹æœ¬æ€§æŒ‘æˆ˜ã€‚å½“ç”¨æˆ·æ—‹è½¬è®¾å¤‡ã€æ›´æ”¹è¯­è¨€è®¾ç½®æˆ–è§¦å‘ä»»ä½•é…ç½®æ›´æ”¹æ—¶ï¼Œç³»ç»Ÿä¼šé”€æ¯å¹¶é‡æ–°åˆ›å»º Activityã€‚Activity ä¸­å­˜å‚¨çš„æ‰€æœ‰æ•°æ®éƒ½ä¼šä¸¢å¤±ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyActivity</span> : <span class="hljs-type">ComponentActivity</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> userData: User? = <span class="hljs-literal">null</span>  <span class="hljs-comment">// Lost on rotation!</span>

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        <span class="hljs-comment">// Must reload data after every rotation</span>
        loadUserData()
    }
}
</code></pre>
<p>ä¸€ç§ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨ <code>onSaveInstanceState()</code>ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSaveInstanceState</span><span class="hljs-params">(outState: <span class="hljs-type">Bundle</span>)</span></span> {
    <span class="hljs-keyword">super</span>.onSaveInstanceState(outState)
    outState.putParcelable(<span class="hljs-string">"user"</span>, userData)
}

<span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
    <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
    userData = savedInstanceState?.getParcelable(<span class="hljs-string">"user"</span>)
}
</code></pre>
<p>è¿™ç§æ–¹æ³•é€‚ç”¨äºå°å‹ã€å¯åºåˆ—åŒ–çš„æ•°æ®ã€‚ä½†æ˜¯ï¼Œå¯¹äºå¤§å‹æ•°æ®é›†ã€ç½‘ç»œè¿æ¥æˆ–æ— æ³•åºåˆ—åŒ–çš„å¯¹è±¡å‘¢ï¼Ÿå¯¹äºæŒç»­è¿›è¡Œçš„ç½‘ç»œè¯·æ±‚ç­‰æ“ä½œå‘¢ï¼ŸBundle æ–¹æ³•åœ¨è¿™äº›æƒ…å†µä¸‹ä¼šå¤±æ•ˆï¼ŒåŸå› æ—¢æœ‰å¤§å°é™åˆ¶ï¼Œä¹Ÿæœ‰åºåˆ—åŒ–/ååºåˆ—åŒ–çš„é«˜æ˜‚å¼€é”€ã€‚</p>
<p>ViewModel é€šè¿‡æä¾›ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥å®¹å™¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¯¥å®¹å™¨é€šè¿‡ä¿ç•™å¯¹è±¡æ¨¡å¼ï¼ˆè€Œéåºåˆ—åŒ–ï¼‰æ¥åº”å¯¹é…ç½®æ›´æ”¹ã€‚</p>
<h2 data-id="heading-1">ViewModelStoreï¼šä¿ç•™æœºåˆ¶</h2>
<p>ViewModel é…ç½®å˜æ›´åä»èƒ½ä¿ç•™çš„æ ¸å¿ƒæ˜¯ <code>ViewModelStore</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ªç®€å•çš„é”®å€¼å­˜å‚¨ï¼Œç”¨äºä¿å­˜ ViewModel å®ä¾‹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewModelStore</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> map = mutableMapOf&lt;String, ViewModel&gt;()

    <span class="hljs-meta">@RestrictTo(RestrictTo.Scope.LIBRARY_GROUP)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">put</span><span class="hljs-params">(key: <span class="hljs-type">String</span>, viewModel: <span class="hljs-type">ViewModel</span>)</span></span> {
        <span class="hljs-keyword">val</span> oldViewModel = map.put(key, viewModel)
        oldViewModel?.clear()
    }

    <span class="hljs-meta">@RestrictTo(RestrictTo.Scope.LIBRARY_GROUP)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">operator</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">get</span><span class="hljs-params">(key: <span class="hljs-type">String</span>)</span></span>: ViewModel? {
        <span class="hljs-keyword">return</span> map[key]
    }

    <span class="hljs-meta">@RestrictTo(RestrictTo.Scope.LIBRARY_GROUP)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">keys</span><span class="hljs-params">()</span></span>: Set&lt;String&gt; {
        <span class="hljs-keyword">return</span> HashSet(map.keys)
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">clear</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">for</span> (vm <span class="hljs-keyword">in</span> map.values) {
            vm.clear()
        }
        map.clear()
    }
}
</code></pre>
<p>å®ç°éå¸¸ç®€å•ï¼Œå°±æ˜¯ä¸€ä¸ª <code>MutableMap&lt;String, ViewModel&gt;</code>ã€‚å…³é”®ä¸åœ¨äºå­˜å‚¨æœ¬èº«ï¼Œè€Œåœ¨äºå­˜å‚¨çš„ä¿ç•™æ–¹å¼ã€‚</p>
<h3 data-id="heading-2">é”®æ›¿æ¢è¡Œä¸º</h3>
<p>è¯·æ³¨æ„ <code>put</code> æ–¹æ³•çš„è¡Œä¸ºï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">put</span><span class="hljs-params">(key: <span class="hljs-type">String</span>, viewModel: <span class="hljs-type">ViewModel</span>)</span></span> {
    <span class="hljs-keyword">val</span> oldViewModel = map.put(key, viewModel)
    oldViewModel?.clear()
}
</code></pre>
<p>å¦‚æœå·²å­˜åœ¨å…·æœ‰ç›¸åŒé”®çš„ ViewModelï¼Œåˆ™æ—§çš„ ViewModel ä¼šè¢«ç«‹å³æ¸…é™¤ã€‚è¿™ç¡®ä¿äº†åœ¨æ›¿æ¢ ViewModel æ—¶èƒ½å¤Ÿæ­£ç¡®æ¸…ç†ã€‚ä½ å¯èƒ½æƒ³çŸ¥é“è¿™ç§æƒ…å†µä½•æ—¶å‘ç”Ÿï¼Œå®ƒå‘ç”Ÿåœ¨ä½ è¯·æ±‚å…·æœ‰ç›¸åŒé”®ä½†ç±»å‹ä¸åŒçš„ ViewModel æ—¶ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// First request creates TestViewModel1 with key "my_key"</span>
<span class="hljs-keyword">val</span> vm1: TestViewModel1 = viewModelProvider[<span class="hljs-string">"my_key"</span>, TestViewModel1::<span class="hljs-keyword">class</span>]

<span class="hljs-comment">// Second request with same key but different type</span>
<span class="hljs-keyword">val</span> vm2: TestViewModel2 = viewModelProvider[<span class="hljs-string">"my_key"</span>, TestViewModel2::<span class="hljs-keyword">class</span>]

<span class="hljs-comment">// vm1.onCleared() has been called, vm1 is no longer valid</span>
</code></pre>
<p>æ­¤è¡Œä¸ºå·²åœ¨æµ‹è¯•å¥—ä»¶ä¸­éªŒè¯ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">twoViewModelsWithSameKey</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> key = <span class="hljs-string">"the_key"</span>
    <span class="hljs-keyword">val</span> vm1 = viewModelProvider[key, TestViewModel1::<span class="hljs-keyword">class</span>]
    assertThat(vm1.cleared).isFalse()
    <span class="hljs-keyword">val</span> vw2 = viewModelProvider[key, TestViewModel2::<span class="hljs-keyword">class</span>]
    assertThat(vw2).isNotNull()
    assertThat(vm1.cleared).isTrue()
}
</code></pre>
<h3 data-id="heading-3">ViewModelStoreOwner å¥‘çº¦</h3>
<p><code>ViewModelStoreOwner</code> æ¥å£å®šä¹‰äº†è°æ‹¥æœ‰è¯¥å­˜å‚¨ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ViewModelStoreOwner</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">val</span> viewModelStore: ViewModelStore
}
</code></pre>
<p><code>ComponentActivity</code>ã€<code>Fragment</code> å’Œ <code>NavBackStackEntry</code> éƒ½å®ç°äº†è¿™ä¸ªç®€å•çš„æ¥å£ã€‚æ‰€æœ‰è€…çš„èŒè´£æœ‰ä¸¤æ–¹é¢ï¼š</p>
<ol>
<li><strong>åœ¨é…ç½®æ›´æ”¹åä¿ç•™å­˜å‚¨</strong>ï¼šå­˜å‚¨å¿…é¡»åœ¨ Activity é‡å»ºåä»ç„¶å­˜åœ¨ã€‚</li>
<li><strong>åœ¨çœŸæ­£å®Œæˆåæ¸…é™¤å­˜å‚¨</strong>ï¼šå½“æ‰€æœ‰è€…è¢«é”€æ¯è€Œæœªé‡å»ºæ—¶ï¼Œè°ƒç”¨ <code>ViewModelStore.clear()</code>ã€‚</li>
</ol>
<p>å¯¹äº Activity è€Œè¨€ï¼Œè¿™é€šå¸¸ä½¿ç”¨ <code>NonConfigurationInstances</code> æ¥å®ç°ï¼Œè¿™æ˜¯ä¸€ç§ç‰¹æ®Šçš„æœºåˆ¶ï¼Œå…è®¸å¯¹è±¡åœ¨é…ç½®æ›´æ”¹åä»ç„¶å­˜åœ¨ã€‚Activity æ¡†æ¶åœ¨ <code>onRetainNonConfigurationInstance()</code> æœŸé—´ä¿ç•™è¿™äº›å¯¹è±¡ï¼Œå¹¶åœ¨ <code>getLastNonConfigurationInstance()</code> ä¸­æ¢å¤å®ƒä»¬ã€‚</p>
<h3 data-id="heading-4">ä¸ºä»€ä¹ˆç®€å•çš„æ˜ å°„æœ‰æ•ˆ</h3>
<p>ä½ å¯èƒ½æœŸæœ›ä½¿ç”¨å¤æ‚çš„ç¼“å­˜æœºåˆ¶ï¼Œä½†ç®€å•çš„ <code>MutableMap</code> å°±è¶³å¤Ÿäº†ï¼ŒåŸå› å¦‚ä¸‹ï¼š</p>
<ol>
<li><strong>å¤§å°æœ‰é™</strong>ï¼šæ¯ä¸ªå±å¹•ä¸Šçš„ ViewModel æ•°é‡å¾ˆå°‘ï¼ˆé€šå¸¸ä¸º 1-5 ä¸ªï¼‰ã€‚</li>
<li><strong>å­—ç¬¦ä¸²é”®</strong>ï¼šé”®ç”±ç±»åç”Ÿæˆï¼Œä½¿å¾—æŸ¥æ‰¾å¤æ‚åº¦ä¸º O(1)ï¼Œå¹¶ä¸”å“ˆå¸Œåˆ†å¸ƒè‰¯å¥½ã€‚</li>
<li><strong>æ— éœ€é©±é€</strong>ï¼šViewModel ä»…åœ¨æ˜¾å¼è¯·æ±‚æˆ–æ‰€æœ‰è€…è¢«é”€æ¯æ—¶æ‰ä¼šè¢«æ¸…é™¤ã€‚</li>
<li><strong>çº¿ç¨‹å®‰å…¨</strong>ï¼šè®¿é—®åœ¨ ViewModelProvider çº§åˆ«åŒæ­¥ã€‚</li>
</ol>
<h2 data-id="heading-5">ViewModelProviderï¼šç¼–æ’å±‚</h2>
<p><code>ViewModelProvider</code> æ˜¯è·å– ViewModel å®ä¾‹çš„ä¸»è¦ APIã€‚å®ƒè´Ÿè´£ç¼–æ’ storeã€factory å’Œåˆ›å»º extras ä¹‹é—´çš„äº¤äº’ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-keyword">actual</span> <span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewModelProvider</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">constructor</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> impl: ViewModelProviderImpl) {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">constructor</span>(
        store: ViewModelStore,
        factory: Factory,
        defaultCreationExtras: CreationExtras = CreationExtras.Empty,
    ) : <span class="hljs-keyword">this</span>(ViewModelProviderImpl(store, factory, defaultCreationExtras))

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">constructor</span>(
        owner: ViewModelStoreOwner
    ) : <span class="hljs-keyword">this</span>(
        store = owner.viewModelStore,
        factory = ViewModelProviders.getDefaultFactory(owner),
        defaultCreationExtras = ViewModelProviders.getDefaultCreationExtras(owner),
    )

    <span class="hljs-meta">@MainThread</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">actual</span> <span class="hljs-keyword">operator</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : ViewModel&gt;</span> <span class="hljs-title">get</span><span class="hljs-params">(modelClass: <span class="hljs-type">KClass</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: T =
        impl.getViewModel(modelClass)

    <span class="hljs-meta">@MainThread</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">actual</span> <span class="hljs-keyword">operator</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : ViewModel&gt;</span> <span class="hljs-title">get</span><span class="hljs-params">(key: <span class="hljs-type">String</span>, modelClass: <span class="hljs-type">KClass</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: T =
        impl.getViewModel(modelClass, key)
}
</code></pre>
<h3 data-id="heading-6">å¤šå¹³å°æŠ½è±¡</h3>
<p>è¯·æ³¨æ„ <code>ViewModelProviderImpl</code> å§”æ‰˜ã€‚ViewModel åº“æ˜¯ä¸€ä¸ª Kotlin å¤šå¹³å°åº“ï¼Œæ”¯æŒ JVMã€Androidã€iOS å’Œå…¶ä»–å¹³å°ã€‚Kotlin å¤šå¹³å°ç›®å‰è¿˜ä¸æ”¯æŒå¸¦æœ‰é»˜è®¤å®ç°çš„ expect ç±»ï¼Œå› æ­¤é€šç”¨é€»è¾‘è¢«æå–åˆ°å†…éƒ¨å®ç°ç±»ä¸­ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">internal</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewModelProviderImpl</span>(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> store: ViewModelStore,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> factory: ViewModelProvider.Factory,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> defaultExtras: CreationExtras,
) {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> lock = SynchronizedObject()

    <span class="hljs-meta">@Suppress(<span class="hljs-string">"UNCHECKED_CAST"</span>)</span>
    <span class="hljs-keyword">internal</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : ViewModel&gt;</span> <span class="hljs-title">getViewModel</span><span class="hljs-params">(
        modelClass: <span class="hljs-type">KClass</span>&lt;<span class="hljs-type">T</span>&gt;,
        key: <span class="hljs-type">String</span> = ViewModelProviders.getDefaultKey(modelClass)</span></span>,
    ): T {
        <span class="hljs-keyword">return</span> synchronized(lock) {
            <span class="hljs-keyword">val</span> viewModel = store[key]
            <span class="hljs-keyword">if</span> (modelClass.isInstance(viewModel)) {
                <span class="hljs-keyword">if</span> (factory <span class="hljs-keyword">is</span> ViewModelProvider.OnRequeryFactory) {
                    factory.onRequery(viewModel!!)
                }
                <span class="hljs-keyword">return</span><span class="hljs-symbol">@synchronized</span> viewModel <span class="hljs-keyword">as</span> T
            }

            <span class="hljs-keyword">val</span> modelExtras = MutableCreationExtras(defaultExtras)
            modelExtras[ViewModelProvider.VIEW_MODEL_KEY] = key

            <span class="hljs-keyword">return</span><span class="hljs-symbol">@synchronized</span> createViewModel(factory, modelClass, modelExtras).also { vm -&gt;
                store.put(key, vm)
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-7">è·å–æˆ–åˆ›å»ºæ¨¡å¼</h3>
<p><code>getViewModel</code> æ–¹æ³•å®ç°äº†ç»å…¸çš„è·å–æˆ–åˆ›å»ºæ¨¡å¼ï¼š</p>
<ol>
<li><strong>ç”Ÿæˆé”®</strong>ï¼šé»˜è®¤é”®åŸºäºç±»çš„è§„èŒƒåç§°ã€‚</li>
<li><strong>æ£€æŸ¥ç¼“å­˜</strong>ï¼šé€šè¿‡é”®æŸ¥æ‰¾å·²å­˜åœ¨çš„ ViewModelã€‚</li>
<li><strong>ç±»å‹æ£€æŸ¥</strong>ï¼šéªŒè¯ç¼“å­˜å®ä¾‹çš„ç±»å‹æ˜¯å¦æ­£ç¡®ã€‚</li>
<li><strong>è¿”å›ç¼“å­˜</strong>ï¼šå¦‚æœæœ‰æ•ˆï¼Œåˆ™è¿”å›ç¼“å­˜çš„å®ä¾‹ã€‚</li>
<li><strong>åˆ›å»ºæ–°å®ä¾‹</strong>ï¼šå¦‚æœæœªæ‰¾åˆ°æˆ–ç±»å‹é”™è¯¯ï¼Œåˆ™é€šè¿‡å·¥å‚æ¨¡å¼åˆ›å»ºæ–°å®ä¾‹ã€‚</li>
<li><strong>å­˜å‚¨</strong>ï¼šå°†æ–°å®ä¾‹æ”¾å…¥å­˜å‚¨ä¸­ã€‚</li>
</ol>
<h3 data-id="heading-8">ä½¿ç”¨åŒæ­¥è®¿é—®ç¡®ä¿çº¿ç¨‹å®‰å…¨</h3>
<p><code>synchronized(lock)</code> ä»£ç å—ç¡®ä¿çº¿ç¨‹å®‰å…¨è®¿é—®ã€‚è™½ç„¶ ViewModel çš„è®¿é—®é€šå¸¸æ¥è‡ªä¸»çº¿ç¨‹ï¼ˆå¦‚ <code>@MainThread</code> æ‰€ç¤ºï¼‰ï¼Œä½†åŒæ­¥æœºåˆ¶å¯ä»¥é˜²æ­¢åå°çº¿ç¨‹è®¿é—® ViewModel ç­‰æç«¯æƒ…å†µï¼Œå°¤å…¶æ˜¯åœ¨æµ‹è¯•åœºæ™¯æˆ–ä½¿ç”¨ <code>viewModelScope</code> æ—¶ã€‚</p>
<h3 data-id="heading-9">OnRequeryFactory å›è°ƒ</h3>
<p><code>OnRequeryFactory</code> æ˜¯ä¸€ç§ç‰¹æ®Šçš„æœºåˆ¶ï¼Œç”¨äºåœ¨æ£€ç´¢ç¼“å­˜çš„ ViewModel æ—¶æ‰§è¡Œæ“ä½œçš„å·¥å‚ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@RestrictTo(RestrictTo.Scope.LIBRARY_GROUP)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">actual</span> <span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OnRequeryFactory</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">actual</span> <span class="hljs-keyword">open</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onRequery</span><span class="hljs-params">(viewModel: <span class="hljs-type">ViewModel</span>)</span></span> {}
}
</code></pre>
<p><code>SavedStateHandle</code> å†…éƒ¨ä½¿ç”¨æ­¤æœºåˆ¶åœ¨é…ç½®æ›´æ”¹åå°† ViewModel ä¸å½“å‰çš„ SavedStateRegistry é‡æ–°è¿æ¥ã€‚å½“ä»ç¼“å­˜ä¸­æ£€ç´¢ ViewModel æ—¶ï¼Œä¼šè°ƒç”¨å·¥å‚çš„ <code>onRequery</code> æ–¹æ³•ï¼Œä»è€Œæ›´æ–°å¯èƒ½å·²æ›´æ”¹çš„å¼•ç”¨ã€‚</p>
<h3 data-id="heading-10">ä»ç±»åç”Ÿæˆé”®</h3>
<p>é»˜è®¤çš„é”®ç”Ÿæˆæœºåˆ¶å¯é˜²æ­¢æ„å¤–å†²çªï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">internal</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : ViewModel&gt;</span> <span class="hljs-title">getDefaultKey</span><span class="hljs-params">(modelClass: <span class="hljs-type">KClass</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: String {
    <span class="hljs-keyword">val</span> canonicalName =
        requireNotNull(modelClass.canonicalName) {
            <span class="hljs-string">"Local and anonymous classes can not be ViewModels"</span>
        }
    <span class="hljs-keyword">return</span> <span class="hljs-string">"<span class="hljs-variable">$VIEW_MODEL_PROVIDER_DEFAULT_KEY</span>:<span class="hljs-variable">$canonicalName</span>"</span>
}
</code></pre>
<p>å‰ç¼€ <code>"androidx.lifecycle.ViewModelProvider.DefaultKey:"</code> å¯ç¡®ä¿é”®ä¸ä¼šä¸ç”¨æˆ·æä¾›çš„è‡ªå®šä¹‰é”®å†²çªã€‚è§„èŒƒåç§°è¦æ±‚ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆæœ¬åœ°ç±»å’ŒåŒ¿åç±»ä¸èƒ½æ˜¯ ViewModelï¼Œå› ä¸ºå®ƒä»¬æ²¡æœ‰è§„èŒƒåç§°ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">localViewModel</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">LocalViewModel</span> : <span class="hljs-type">ViewModel</span>()
    <span class="hljs-keyword">try</span> {
        viewModelProvider[LocalViewModel::<span class="hljs-keyword">class</span>]
        fail(<span class="hljs-string">"Expected `IllegalArgumentException`"</span>)
    } <span class="hljs-keyword">catch</span> (e: IllegalArgumentException) {
        assertThat(e)
            .hasMessageThat()
            .contains(<span class="hljs-string">"Local and anonymous classes can not be ViewModels"</span>)
    }
}
</code></pre>
<h2 data-id="heading-11">å·¥å‚æ¨¡å¼ï¼šçµæ´»å®ä¾‹åŒ–</h2>
<p><code>ViewModelProvider.Factory</code> æ˜¯åˆ›å»º ViewModel å®ä¾‹çš„æœºåˆ¶ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-keyword">actual</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Factory</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : ViewModel&gt;</span> <span class="hljs-title">create</span><span class="hljs-params">(modelClass: <span class="hljs-type">Class</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: T =
        ViewModelProviders.unsupportedCreateViewModel()

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : ViewModel&gt;</span> <span class="hljs-title">create</span><span class="hljs-params">(modelClass: <span class="hljs-type">Class</span>&lt;<span class="hljs-type">T</span>&gt;, extras: <span class="hljs-type">CreationExtras</span>)</span></span>: T =
        create(modelClass)

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">actual</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : ViewModel&gt;</span> <span class="hljs-title">create</span><span class="hljs-params">(modelClass: <span class="hljs-type">KClass</span>&lt;<span class="hljs-type">T</span>&gt;, extras: <span class="hljs-type">CreationExtras</span>)</span></span>: T =
        create(modelClass.java, extras)
}
</code></pre>
<h3 data-id="heading-12">æ–¹æ³•é‡è½½é“¾</h3>
<p>å·¥å‚æ¥å£æœ‰ä¸‰ä¸ª <code>create</code> æ–¹æ³•å˜ä½“ï¼Œå½¢æˆä¸€ä¸ªé“¾ï¼š</p>
<ol>
<li><code>create(KClass&lt;T&gt;, CreationExtras)</code>ï¼šKotlin ä¼˜å…ˆ APIï¼Œå§”æ‰˜ç»™ Java å˜ä½“</li>
<li><code>create(Class&lt;T&gt;, CreationExtras)</code>ï¼šä¸»è¦å®ç°ç‚¹ï¼Œé»˜è®¤ä¸ºæ— é™„åŠ ç»„ä»¶çš„å˜ä½“</li>
<li><code>create(Class&lt;T&gt;)</code>ï¼šä¼ ç»Ÿ APIï¼Œé»˜è®¤æŠ›å‡ºå¼‚å¸¸</li>
</ol>
<p>æ­¤é“¾åœ¨ä¿æŒå‘åå…¼å®¹æ€§çš„åŒæ—¶ï¼Œä¹Ÿé¼“åŠ±ä½¿ç”¨åŸºäº <code>CreationExtras</code> çš„ç°ä»£æ–¹æ³•ã€‚</p>
<h3 data-id="heading-13">NewInstanceFactoryï¼šåŸºäºåå°„çš„åˆ›å»º</h3>
<p>æœ€ç®€å•çš„å·¥å‚ä½¿ç”¨åå°„æ¥åˆ›å»ºå¸¦æœ‰æ— å‚æ„é€ å‡½æ•°çš„ ViewModelï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NewInstanceFactory</span> : <span class="hljs-type">Factory</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : ViewModel&gt;</span> <span class="hljs-title">create</span><span class="hljs-params">(modelClass: <span class="hljs-type">Class</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: T =
        JvmViewModelProviders.createViewModel(modelClass)
}
</code></pre>
<p>JVM å®ç°ä½¿ç”¨åå°„å¹¶è¿›è¡Œäº†ç»†è‡´çš„é”™è¯¯å¤„ç†ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">internal</span> <span class="hljs-keyword">object</span> JvmViewModelProviders {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : ViewModel&gt;</span> <span class="hljs-title">createViewModel</span><span class="hljs-params">(modelClass: <span class="hljs-type">Class</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: T {
        <span class="hljs-keyword">val</span> <span class="hljs-keyword">constructor</span> =
            <span class="hljs-keyword">try</span> {
                modelClass.getDeclaredConstructor()
            } <span class="hljs-keyword">catch</span> (e: NoSuchMethodException) {
                <span class="hljs-keyword">throw</span> RuntimeException(<span class="hljs-string">"Cannot create an instance of <span class="hljs-variable">$modelClass</span>"</span>, e)
            }

        <span class="hljs-comment">// Enforce public constructor for consistent behavior</span>
        <span class="hljs-keyword">if</span> (!Modifier.isPublic(<span class="hljs-keyword">constructor</span>.modifiers)) {
            <span class="hljs-keyword">throw</span> RuntimeException(<span class="hljs-string">"Cannot create an instance of <span class="hljs-variable">$modelClass</span>"</span>)
        }

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">constructor</span>.newInstance()
        } <span class="hljs-keyword">catch</span> (e: InstantiationException) {
            <span class="hljs-keyword">throw</span> RuntimeException(<span class="hljs-string">"Cannot create an instance of <span class="hljs-variable">$modelClass</span>"</span>, e)
        } <span class="hljs-keyword">catch</span> (e: IllegalAccessException) {
            <span class="hljs-keyword">throw</span> RuntimeException(<span class="hljs-string">"Cannot create an instance of <span class="hljs-variable">$modelClass</span>"</span>, e)
        }
    }
}
</code></pre>
<p>å…¬å…±ä¿®é¥°ç¬¦æ£€æŸ¥å¯¹äºæµ‹è¯•ä¸€è‡´æ€§è‡³å…³é‡è¦ã€‚åœ¨æ’æ¡©æµ‹è¯•ä¸­ï¼ŒR8 å¯èƒ½ä¼šç§»é™¤è®¿é—®ä¿®é¥°ç¬¦ï¼Œä½¿ç§æœ‰æ„é€ å‡½æ•°å¯è®¿é—®ã€‚JVM æµ‹è¯•ä¸¥æ ¼æ‰§è¡Œè®¿é—®é™åˆ¶ã€‚æ­¤æ˜¾å¼æ£€æŸ¥å¯ç¡®ä¿è·¨æµ‹è¯•ç¯å¢ƒçš„è¡Œä¸ºä¸€è‡´æ€§ã€‚</p>
<h3 data-id="heading-14">AndroidViewModelFactoryï¼šåº”ç”¨æ„ŸçŸ¥åˆ›å»º</h3>
<p><code>AndroidViewModelFactory</code> ç»§æ‰¿è‡ª <code>NewInstanceFactory</code> ä»¥æ”¯æŒ <code>AndroidViewModel</code>ï¼Œåè€…éœ€è¦ä¸€ä¸ª <code>Application</code> å‚æ•°ã€‚è¯¥å·¥å‚åœ¨ä¿æŒå‘åå…¼å®¹æ€§çš„åŒæ—¶ï¼Œä¹Ÿé‡‡ç”¨äº†ç°ä»£çš„ <code>CreationExtras</code> æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AndroidViewModelFactory</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">constructor</span>(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> application: Application?,
    <span class="hljs-meta">@Suppress(<span class="hljs-string">"UNUSED_PARAMETER"</span>)</span> unused: <span class="hljs-built_in">Int</span>,
) : NewInstanceFactory() {

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : ViewModel&gt;</span> <span class="hljs-title">create</span><span class="hljs-params">(modelClass: <span class="hljs-type">Class</span>&lt;<span class="hljs-type">T</span>&gt;, extras: <span class="hljs-type">CreationExtras</span>)</span></span>: T {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span> (application != <span class="hljs-literal">null</span>) {
            create(modelClass)
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">val</span> application = extras[APPLICATION_KEY]
            <span class="hljs-keyword">if</span> (application != <span class="hljs-literal">null</span>) {
                create(modelClass, application)
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">if</span> (AndroidViewModel::<span class="hljs-keyword">class</span>.java.isAssignableFrom(modelClass)) {
                    <span class="hljs-keyword">throw</span> IllegalArgumentException(
                        <span class="hljs-string">"CreationExtras must have an application by `APPLICATION_KEY`"</span>
                    )
                }
                <span class="hljs-keyword">super</span>.create(modelClass)
            }
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : ViewModel&gt;</span> <span class="hljs-title">create</span><span class="hljs-params">(modelClass: <span class="hljs-type">Class</span>&lt;<span class="hljs-type">T</span>&gt;, app: <span class="hljs-type">Application</span>)</span></span>: T {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span> (AndroidViewModel::<span class="hljs-keyword">class</span>.java.isAssignableFrom(modelClass)) {
            <span class="hljs-keyword">try</span> {
                modelClass.getConstructor(Application::<span class="hljs-keyword">class</span>.java).newInstance(app)
            } <span class="hljs-keyword">catch</span> (e: NoSuchMethodException) {
                <span class="hljs-keyword">throw</span> RuntimeException(<span class="hljs-string">"Cannot create an instance of <span class="hljs-variable">$modelClass</span>"</span>, e)
            }
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">super</span>.create(modelClass)
    }
}
</code></pre>
<p>è¯¥å·¥å‚å®ç°äº†çº§è”è§£æç­–ç•¥ï¼šé¦–å…ˆæ£€æŸ¥æ˜¯å¦å°† <code>Application</code> ä¼ é€’ç»™äº†æ„é€ å‡½æ•°ï¼ˆä¼ ç»Ÿæ–¹æ³•ï¼‰ï¼Œç„¶åé€šè¿‡ <code>APPLICATION_KEY</code> åœ¨ <code>CreationExtras</code> ä¸­æŸ¥æ‰¾ï¼ˆç°ä»£æ— çŠ¶æ€æ–¹æ³•ï¼‰ï¼Œæœ€åå¯¹äºå¸¸è§„ ViewModel å›é€€åˆ° <code>NewInstanceFactory</code>ï¼Œæˆ–è€…å¦‚æœ <code>AndroidViewModel</code> æ²¡æœ‰å¯ç”¨çš„ <code>Application</code>ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</p>
<p>ç§æœ‰æ„é€ å‡½æ•°ä¸­çš„ <code>unused: Int</code> å‚æ•°æ˜¯ä¸€ä¸ªå·§å¦™çš„æŠ€å·§ï¼Œç”¨äºåŒºåˆ†é‡è½½æ„é€ å‡½æ•°ï¼Œå› ä¸ºå¦‚æœä½¿ç”¨ <code>null</code> è°ƒç”¨ <code>constructor()</code>ï¼Œç¼–è¯‘å™¨å°†æ— æ³•åŒºåˆ† <code>constructor(application: Application?)</code>ã€‚</p>
<p>å®ä¾‹åŒ–ä½¿ç”¨äº†åå°„ï¼ˆ<code>modelClass.getConstructor(Application::class.java).newInstance(app)</code>ï¼‰ï¼Œè¿™æ„å‘³ç€ä½ çš„ <code>AndroidViewModel</code> å­ç±»å¿…é¡»æœ‰ä¸€ä¸ªæ¥å—ä¸”ä»…æ¥å—ä¸€ä¸ª <code>Application</code> å‚æ•°çš„æ„é€ å‡½æ•°ã€‚å¯¹äºå…¶ä»–ä¾èµ–é¡¹ï¼Œä½ éœ€è¦è‡ªå®šä¹‰å·¥å‚æˆ–ä¾èµ–æ³¨å…¥æ¡†æ¶ï¼Œä¾‹å¦‚ Hiltã€‚</p>
<h3 data-id="heading-15">InitializerViewModelFactoryï¼šåŸºäº Lambda çš„åˆ›å»º</h3>
<p>å¯¹äºå…·æœ‰è‡ªå®šä¹‰ä¾èµ–é¡¹çš„ ViewModelï¼Œ<code>InitializerViewModelFactory</code> æä¾›äº†ä¸€ç§åŸºäº DSL çš„æ–¹æ³•ï¼Œå¯ä»¥å‡å°‘æ ·æ¿ä»£ç ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> factory = viewModelFactory {
    initializer { MyViewModel(<span class="hljs-keyword">get</span>(MY_KEY)) }
    initializer { AnotherViewModel(<span class="hljs-keyword">get</span>(ANOTHER_KEY)) }
}
</code></pre>
<p>è¯¥ DSL ç”±ä¸€ä¸ªæ„å»ºå™¨ç±»é©±åŠ¨ï¼Œè¯¥æ„å»ºå™¨ç±»æ”¶é›†åˆå§‹åŒ– Lambda è¡¨è¾¾å¼ï¼Œå…¶ä¸­æ¯ä¸ªåˆå§‹åŒ–å™¨å°†ä¸€ä¸ª <code>KClass</code> ä¸å…¶åˆ›å»º Lambda è¡¨è¾¾å¼é…å¯¹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@ViewModelFactoryDsl</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InitializerViewModelFactoryBuilder</span> <span class="hljs-keyword">public</span> <span class="hljs-keyword">constructor</span>() {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> initializers = mutableMapOf&lt;KClass&lt;*&gt;, ViewModelInitializer&lt;*&gt;&gt;()

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : ViewModel&gt;</span> <span class="hljs-title">addInitializer</span><span class="hljs-params">(
        clazz: <span class="hljs-type">KClass</span>&lt;<span class="hljs-type">T</span>&gt;,
        initializer: <span class="hljs-type">CreationExtras</span>.() -&gt; <span class="hljs-type">T</span>,
    )</span></span> {
        require(clazz !<span class="hljs-keyword">in</span> initializers) {
            <span class="hljs-string">"A `initializer` with the same `clazz` has already been added: <span class="hljs-subst">${clazz.canonicalName}</span>."</span>
        }
        initializers[clazz] = ViewModelInitializer(clazz, initializer)
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">build</span><span class="hljs-params">()</span></span>: ViewModelProvider.Factory =
        ViewModelProviders.createInitializerFactory(initializers.values)
}
</code></pre>
<p><code>@ViewModelFactoryDsl</code> æ³¨è§£æ˜¯ä¸€ä¸ª DSL æ ‡è®°ï¼Œå¯é˜²æ­¢åµŒå¥—çš„æ„å»ºå™¨ä½œç”¨åŸŸæ„å¤–è®¿é—®å¤–éƒ¨ä½œç”¨åŸŸçš„æ–¹æ³•ã€‚åˆå§‹åŒ– Lambda è¡¨è¾¾å¼æ¥æ”¶ <code>CreationExtras</code> ä½œä¸ºå…¶æ¥æ”¶å™¨ï¼Œå…è®¸é€šè¿‡ <code>get()</code> ç›´æ¥è®¿é—®é¢å¤–å†…å®¹ã€‚</p>
<p>åœ¨åˆ›å»ºæ—¶ï¼Œå·¥å‚ä¼šé€šè¿‡åˆå§‹åŒ–å™¨è¿›è¡Œçº¿æ€§æœç´¢ï¼Œä»¥æ‰¾åˆ°åŒ¹é…çš„ç±»ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">internal</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;VM : ViewModel&gt;</span> <span class="hljs-title">createViewModelFromInitializers</span><span class="hljs-params">(
    modelClass: <span class="hljs-type">KClass</span>&lt;<span class="hljs-type">VM</span>&gt;,
    extras: <span class="hljs-type">CreationExtras</span>,
    <span class="hljs-keyword">vararg</span> initializers: <span class="hljs-type">ViewModelInitializer</span>&lt;*&gt;,
)</span></span>: VM {
    <span class="hljs-keyword">val</span> viewModel =
        initializers.firstOrNull { it.clazz == modelClass }?.initializer?.invoke(extras) <span class="hljs-keyword">as</span> VM?
    <span class="hljs-keyword">return</span> requireNotNull(viewModel) {
        <span class="hljs-string">"No initializer set for given class <span class="hljs-subst">${modelClass.canonicalName}</span>"</span>
    }
}
</code></pre>
<p>çº¿æ€§æœç´¢æ˜¯å¯ä»¥æ¥å—çš„ï¼Œå› ä¸ºæ¯ä¸ªå·¥å‚åˆ›å»ºçš„ ViewModel æ•°é‡é€šå¸¸å¾ˆå°‘ï¼ˆ1-5 ä¸ªï¼‰ï¼Œè€Œä¸” ViewModel çš„åˆ›å»ºé¢‘ç‡å¾ˆä½ï¼ˆæ¯ä¸ªç”Ÿå‘½å‘¨æœŸä¸€æ¬¡ï¼‰ã€‚</p>
<h2 data-id="heading-16">CreationExtrasï¼šæ— çŠ¶æ€å·¥å‚é…ç½®</h2>
<p><code>CreationExtras</code> æ˜¯ä¸€ä¸ªç±»å‹å®‰å…¨çš„é”®å€¼å®¹å™¨ï¼Œç”¨äºåœ¨ä¸ä½¿å·¥å‚æˆä¸ºæœ‰çŠ¶æ€çš„æƒ…å†µä¸‹å‘å…¶ä¼ é€’é…ç½®ã€‚å·¥å‚ä¸å†é€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥æ¥æŒæœ‰ä¾èµ–é¡¹ï¼Œè€Œæ˜¯åœ¨åˆ›å»ºæ—¶ä¼ é€’ä¾èµ–é¡¹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CreationExtras</span> <span class="hljs-keyword">internal</span> <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">internal</span> <span class="hljs-keyword">val</span> extras: MutableMap&lt;Key&lt;*&gt;, Any?&gt; = mutableMapOf()

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Key</span>&lt;<span class="hljs-type">T</span>&gt;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">operator</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">get</span><span class="hljs-params">(key: <span class="hljs-type">Key</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: T?

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">object</span> Empty : CreationExtras() {
        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">get</span><span class="hljs-params">(key: <span class="hljs-type">Key</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: T? = <span class="hljs-literal">null</span>
    }
}
</code></pre>
<h3 data-id="heading-17">ç±»å‹å®‰å…¨çš„é”®</h3>
<p>æ¯ä¸ªé”®éƒ½ç”±å…¶å…³è”çš„å€¼ç±»å‹å‚æ•°åŒ–ï¼Œä»è€Œæä¾›ç¼–è¯‘æ—¶ç±»å‹å®‰å…¨ã€‚å½“ä½ ä½¿ç”¨ <code>extras[APPLICATION_KEY]</code> è·å–å€¼æ—¶ï¼Œè¿”å›ç±»å‹ä¼šè‡ªåŠ¨ä¸º <code>Application?</code>ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> APPLICATION_KEY: Key&lt;Application&gt; = CreationExtras.Companion.Key()
<span class="hljs-keyword">val</span> VIEW_MODEL_KEY: Key&lt;String&gt; = CreationExtras.Companion.Key()
</code></pre>
<p>é”®çš„åˆ›å»ºä½¿ç”¨äº†ä¸€ä¸ªå†…è”å‡½æ•°ï¼Œè¯¥å‡½æ•°åˆ›å»ºä¸€ä¸ªå®ç° <code>Key</code> æ¥å£çš„æ–°åŒ¿åå¯¹è±¡ã€‚ç”±äºæ¯ä¸ªé”®éƒ½æ˜¯ä¸€ä¸ªå”¯ä¸€çš„å¯¹è±¡å®ä¾‹ï¼Œå› æ­¤é”®ä¹‹é—´é€šè¿‡æ ‡è¯†ï¼ˆ<code>===</code>ï¼‰è¿›è¡Œæ¯”è¾ƒï¼Œå³ä½¿ä¸¤ä¸ªé”®å…·æœ‰ç›¸åŒçš„ç±»å‹å‚æ•°ï¼Œä¹Ÿä¸ä¼šå‘ç”Ÿæ„å¤–å†²çªï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@JvmStatic</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;<span class="hljs-keyword">reified</span> T&gt;</span> <span class="hljs-title">Key</span><span class="hljs-params">()</span></span>: Key&lt;T&gt; = <span class="hljs-keyword">object</span> : Key&lt;T&gt; {}
</code></pre>
<h3 data-id="heading-18">ç”¨äºä¿®æ”¹çš„ MutableCreationExtras</h3>
<p>åŸºç±» <code>CreationExtras</code> æ˜¯åªè¯»çš„ï¼Œè€Œ <code>MutableCreationExtras</code> å…è®¸æ·»åŠ æ¡ç›®ã€‚è¿™ç§åˆ†ç¦»éµå¾ª Kotlin çš„é›†åˆè®¾è®¡ç†å¿µï¼ˆä¾‹å¦‚ <code>List</code> ä¸ <code>MutableList</code>ï¼‰ï¼Œé˜²æ­¢å·¥å‚æ„å¤–ä¿®æ”¹å…±äº«çš„ extrasï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MutableCreationExtras</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">constructor</span>(initialExtras: CreationExtras = Empty) : CreationExtras() {

    <span class="hljs-keyword">init</span> {
        extras += initialExtras.extras
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">operator</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">set</span><span class="hljs-params">(key: <span class="hljs-type">Key</span>&lt;<span class="hljs-type">T</span>&gt;, t: <span class="hljs-type">T</span>)</span></span> {
        extras[key] = t
    }

    <span class="hljs-meta">@Suppress(<span class="hljs-string">"UNCHECKED_CAST"</span>)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">get</span><span class="hljs-params">(key: <span class="hljs-type">Key</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: T? = extras[key] <span class="hljs-keyword">as</span> T?
}
</code></pre>
<h3 data-id="heading-19">ä¸ ViewModelProvider é›†æˆ</h3>
<p><code>ViewModelProvider</code> ä¼šåœ¨è°ƒç”¨å·¥å‚ä¹‹å‰è‡ªåŠ¨å°† ViewModel çš„é”®æ·»åŠ åˆ° extras ä¸­ï¼Œè¿™å¯¹äºåƒ <code>SavedStateHandle</code> è¿™æ ·éœ€è¦é”®æ¥æ­£ç¡®é™å®šæŒä¹…åŒ–èŒƒå›´çš„åŠŸèƒ½è‡³å…³é‡è¦ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> modelExtras = MutableCreationExtras(defaultExtras)
modelExtras[ViewModelProvider.VIEW_MODEL_KEY] = key

<span class="hljs-keyword">return</span><span class="hljs-symbol">@synchronized</span> createViewModel(factory, modelClass, modelExtras)
</code></pre>
<h3 data-id="heading-20">HasDefaultViewModelProviderFactory</h3>
<p><code>ViewModelStoreOwner</code> çš„å®ç°å¯ä»¥é€šè¿‡ <code>HasDefaultViewModelProviderFactory</code> æ¥å£æä¾›é»˜è®¤çš„å·¥å‚å’Œ extrasã€‚ <code>ComponentActivity</code> å’Œ <code>Fragment</code> éƒ½å®ç°äº†æ­¤æ¥å£ï¼Œå¹¶æä¾›äº†æ”¯æŒ <code>SavedStateHandle</code> ä¸”é¢„å…ˆå¡«å……äº† <code>APPLICATION_KEY</code> çš„å·¥å‚ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">HasDefaultViewModelProviderFactory</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">val</span> defaultViewModelProviderFactory: ViewModelProvider.Factory

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">val</span> defaultViewModelCreationExtras: CreationExtras
        <span class="hljs-keyword">get</span>() = CreationExtras.Empty
}
</code></pre>
<p><code>ComponentActivity</code> å’Œ <code>Fragment</code> éƒ½å®ç°äº†æ­¤æ¥å£ï¼Œå¹¶æä¾›äº†æ”¯æŒ <code>SavedStateHandle</code> å’Œæ­£ç¡®çš„ <code>CreationExtras</code> ä¸”é¢„å…ˆå¡«å……äº† <code>APPLICATION_KEY</code> çš„å·¥å‚ã€‚</p>
<p>ä» <code>ViewModelStoreOwner</code> åˆ›å»º <code>ViewModelProvider</code> æ—¶ï¼Œä¼šè‡ªåŠ¨ä½¿ç”¨ä»¥ä¸‹é»˜è®¤å€¼ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">internal</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getDefaultFactory</span><span class="hljs-params">(owner: <span class="hljs-type">ViewModelStoreOwner</span>)</span></span>: ViewModelProvider.Factory =
    <span class="hljs-keyword">if</span> (owner <span class="hljs-keyword">is</span> HasDefaultViewModelProviderFactory) {
        owner.defaultViewModelProviderFactory
    } <span class="hljs-keyword">else</span> {
        DefaultViewModelProviderFactory
    }

<span class="hljs-keyword">internal</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getDefaultCreationExtras</span><span class="hljs-params">(owner: <span class="hljs-type">ViewModelStoreOwner</span>)</span></span>: CreationExtras =
    <span class="hljs-keyword">if</span> (owner <span class="hljs-keyword">is</span> HasDefaultViewModelProviderFactory) {
        owner.defaultViewModelCreationExtras
    } <span class="hljs-keyword">else</span> {
        CreationExtras.Empty
    }
</code></pre>
<p>è¿™ç§æ¨¡å¼æ”¯æŒæ¸è¿›å¢å¼ºï¼šç®€å•çš„ ViewModel ä½¿ç”¨é»˜è®¤å·¥å‚ï¼Œè€Œå¤æ‚çš„ ViewModel å¯ä»¥é€šè¿‡ extras è·å–ä¸°å¯Œçš„é…ç½®ï¼Œè€Œæ— éœ€æ›´æ”¹è·å– ViewModelProvider çš„æ–¹å¼ã€‚</p>
<h2 data-id="heading-21">ViewModel ç±»ï¼šèµ„æºç®¡ç†</h2>
<p><code>ViewModel</code> ç±»é€šè¿‡ <code>AutoCloseable</code> æ¨¡å¼ç®¡ç†èµ„æºç”Ÿå‘½å‘¨æœŸã€‚<code>expect</code> å…³é”®å­—è¡¨æ˜è¿™æ˜¯ä¸€ä¸ª Kotlin å¤šå¹³å°å£°æ˜ï¼Œæ¯ä¸ªå¹³å°éƒ½æä¾›è‡ªå·±çš„ <code>actual</code> å®ç°ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-keyword">expect</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewModel</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">constructor</span>()
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">constructor</span>(viewModelScope: CoroutineScope)
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">constructor</span>(<span class="hljs-keyword">vararg</span> closeables: AutoCloseable)
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">constructor</span>(viewModelScope: CoroutineScope, <span class="hljs-keyword">vararg</span> closeables: AutoCloseable)

    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">open</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCleared</span><span class="hljs-params">()</span></span>

    <span class="hljs-meta">@MainThread</span> <span class="hljs-keyword">internal</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">clear</span><span class="hljs-params">()</span></span>

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">addCloseable</span><span class="hljs-params">(key: <span class="hljs-type">String</span>, closeable: <span class="hljs-type">AutoCloseable</span>)</span></span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">open</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">addCloseable</span><span class="hljs-params">(closeable: <span class="hljs-type">AutoCloseable</span>)</span></span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : AutoCloseable&gt;</span> <span class="hljs-title">getCloseable</span><span class="hljs-params">(key: <span class="hljs-type">String</span>)</span></span>: T?
}
</code></pre>
<h3 data-id="heading-22">ViewModelImpl å†…éƒ¨å®ç°</h3>
<p>å®é™…å®ç°å§”æ‰˜ç»™ <code>ViewModelImpl</code>ï¼Œéµå¾ªå¤šå¹³å°æ¨¡å¼ï¼Œå°†é€šç”¨é€»è¾‘æå–åˆ°å†…éƒ¨ç±»ä¸­ã€‚<code>isCleared</code> ä¸Šçš„ <code>@Volatile</code> æ³¨è§£ç¡®ä¿è·¨çº¿ç¨‹å¯è§ï¼Œè¿™å¯¹äºæ¸…é™¤åçš„ä¿æŠ¤æœºåˆ¶è‡³å…³é‡è¦ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">internal</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewModelImpl</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> lock = SynchronizedObject()
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> keyToCloseables = mutableMapOf&lt;String, AutoCloseable&gt;()
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> closeables = mutableSetOf&lt;AutoCloseable&gt;()

    <span class="hljs-meta">@Volatile</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> isCleared = <span class="hljs-literal">false</span>

    <span class="hljs-keyword">constructor</span>()

    <span class="hljs-keyword">constructor</span>(viewModelScope: CoroutineScope) {
        addCloseable(VIEW_MODEL_SCOPE_KEY, viewModelScope.asCloseable())
    }

    <span class="hljs-keyword">constructor</span>(<span class="hljs-keyword">vararg</span> closeables: AutoCloseable) {
        <span class="hljs-keyword">this</span>.closeables += closeables
    }

    <span class="hljs-keyword">constructor</span>(viewModelScope: CoroutineScope, <span class="hljs-keyword">vararg</span> closeables: AutoCloseable) {
        addCloseable(VIEW_MODEL_SCOPE_KEY, viewModelScope.asCloseable())
        <span class="hljs-keyword">this</span>.closeables += closeables
    }
}
</code></pre>
<h3 data-id="heading-23">ä¸¤å±‚å¯å…³é—­å­˜å‚¨</h3>
<p>è¯¥å®ç°ç»´æŠ¤ä¸¤ä¸ªé›†åˆï¼š<code>keyToCloseables</code> ç”¨äºæ³¨å†Œåéœ€è¦æ£€ç´¢çš„èµ„æºï¼ˆä¾‹å¦‚ <code>viewModelScope</code>ï¼‰ï¼Œä»¥åŠ <code>closeables</code> ç”¨äºå³ç”¨å³å¼ƒçš„æ¸…ç†ã€‚ä½¿ç”¨ <code>Set</code> æ¥ç®¡ç†åŒ¿åå¯å…³é—­èµ„æºå¯ä»¥é˜²æ­¢é‡å¤æ³¨å†Œå¯¼è‡´åŒé‡å…³é—­ã€‚</p>
<h3 data-id="heading-24">æ¸…é™¤é¡ºåº</h3>
<p>å½“ ViewModel è¢«æ¸…é™¤æ—¶ï¼Œèµ„æºä¼šæŒ‰ç…§ç‰¹å®šçš„é¡ºåºè¿›è¡Œæ¸…ç†ã€‚<code>isCleared = true</code> æ ‡å¿—ä¼šåœ¨åŒæ­¥ä»£ç å—ä¹‹å‰è®¾ç½®ï¼Œä»¥é˜²æ­¢å¹¶å‘çš„ <code>addCloseable</code> è°ƒç”¨æ·»åŠ ä¼šè¢«é—æ¼çš„èµ„æºï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@MainThread</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">clear</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">if</span> (isCleared) <span class="hljs-keyword">return</span>

    isCleared = <span class="hljs-literal">true</span>
    synchronized(lock) {
        <span class="hljs-keyword">for</span> (closeable <span class="hljs-keyword">in</span> keyToCloseables.values) {
            closeWithRuntimeException(closeable)
        }
        <span class="hljs-keyword">for</span> (closeable <span class="hljs-keyword">in</span> closeables) {
            closeWithRuntimeException(closeable)
        }
        <span class="hljs-comment">// Clear only resources without keys to prevent accidental recreation</span>
        closeables.clear()
    }
}
</code></pre>
<p>åŒ¿å <code>closeables</code> é›†åˆä¼šè¢«æ¸…é™¤ï¼Œä½† <code>keyToCloseables</code> ä¼šè¢«æœ‰æ„ä¿ç•™ã€‚è¿™å¯ä»¥é˜²æ­¢åœ¨æ¸…é™¤åä»£ç è®¿é—® <code>viewModelScope</code> ç­‰èµ„æºæ—¶æ„å¤–åœ°é‡æ–°åˆ›å»ºå®ƒä»¬ã€‚</p>
<h3 data-id="heading-25">æ¸…é™¤åä¿æŠ¤</h3>
<p>åœ¨æ¸…é™¤ ViewModel åæ·»åŠ å¯å…³é—­å¯¹è±¡ä¼šç«‹å³å°†å…¶å…³é—­ï¼Œä»è€Œé˜²æ­¢åœ¨åç¨‹ä»åœ¨è¿è¡Œæ—¶ ViewModel è¢«æ¸…é™¤æ—¶å‡ºç°èµ„æºæ³„æ¼ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">addCloseable</span><span class="hljs-params">(key: <span class="hljs-type">String</span>, closeable: <span class="hljs-type">AutoCloseable</span>)</span></span> {
    <span class="hljs-keyword">if</span> (isCleared) {
        closeWithRuntimeException(closeable)
        <span class="hljs-keyword">return</span>
    }

    <span class="hljs-keyword">val</span> oldCloseable = synchronized(lock) { keyToCloseables.put(key, closeable) }
    closeWithRuntimeException(oldCloseable)
}
</code></pre>
<p>æ­¤å¤–ï¼Œè¯·æ³¨æ„ï¼Œæ·»åŠ é”®å€¼å¯å…³é—­å¯¹è±¡æ—¶ï¼Œä»»ä½•å…·æœ‰ç›¸åŒé”®å€¼çš„ç°æœ‰å¯å…³é—­å¯¹è±¡éƒ½ä¼šè‡ªåŠ¨å…³é—­ï¼Œä»è€Œæ”¯æŒæ›¿æ¢æ¨¡å¼ã€‚</p>
<h3 data-id="heading-26">ç”¨äºæ¨¡æ‹Ÿçš„å¯ç©ºå®ç°</h3>
<p>JVM å®ç°æä¾›äº†ä¸€ä¸ªå¯ç©ºçš„ <code>impl</code> å¯¹è±¡ï¼Œä»¥æ”¯æŒæ¨¡æ‹Ÿæ¡†æ¶ã€‚å½“ä½ æ¨¡æ‹Ÿ ViewModel æ—¶ï¼Œæ¨¡æ‹Ÿå¯¹è±¡ä¸ä¼šè°ƒç”¨çœŸæ­£çš„æ„é€ å‡½æ•°ï¼Œå› æ­¤ <code>impl</code> å¯¹è±¡æ°¸è¿œä¸ä¼šè¢«åˆå§‹åŒ–ã€‚å¦‚æœæ²¡æœ‰å¯ç©ºç±»å‹å’Œå®‰å…¨è°ƒç”¨ï¼ˆ<code>impl?.clear()</code>ï¼‰ï¼Œæµ‹è¯•ä¼šå›  <code>NullPointerException</code> è€Œå´©æºƒï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-keyword">actual</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewModel</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> impl: ViewModelImpl?

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">actual</span> <span class="hljs-keyword">constructor</span>() {
        impl = ViewModelImpl()
    }

    <span class="hljs-meta">@MainThread</span>
    <span class="hljs-keyword">internal</span> <span class="hljs-keyword">actual</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">clear</span><span class="hljs-params">()</span></span> {
        impl?.clear()
        onCleared()
    }
}
</code></pre>
<h2 data-id="heading-27">viewModelScopeï¼šåç¨‹é›†æˆ</h2>
<p><code>viewModelScope</code> æ‰©å±•å±æ€§æä¾›äº†ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥çš„ <code>CoroutineScope</code>ï¼Œå½“ ViewModel è¢«æ¸…é™¤æ—¶ï¼Œè¯¥ä½œç”¨åŸŸä¼šè‡ªåŠ¨å–æ¶ˆï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-keyword">val</span> ViewModel.viewModelScope: CoroutineScope
    <span class="hljs-keyword">get</span>() =
        synchronized(VIEW_MODEL_SCOPE_LOCK) {
            getCloseable(VIEW_MODEL_SCOPE_KEY)
                ?: createViewModelScope().also { scope -&gt;
                    addCloseable(VIEW_MODEL_SCOPE_KEY, scope)
                }
        }
</code></pre>
<h3 data-id="heading-28">ä½¿ç”¨é”®æ§å­˜å‚¨çš„å»¶è¿Ÿåˆ›å»º</h3>
<p>ä½œç”¨åŸŸåœ¨é¦–æ¬¡è®¿é—®æ—¶å»¶è¿Ÿåˆ›å»ºï¼Œå¹¶ä½¿ç”¨é”®æ§å¯å…³é—­æœºåˆ¶è¿›è¡Œå­˜å‚¨ã€‚é”®åæ•…æ„è®¾ç½®å¾—éå¸¸è¯¦ç»†ï¼Œä»¥é¿å…ä¸ç”¨æˆ·è‡ªå®šä¹‰çš„é”®å‘ç”Ÿå†²çªï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">internal</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> VIEW_MODEL_SCOPE_KEY =
    <span class="hljs-string">"androidx.lifecycle.viewmodel.internal.ViewModelCoroutineScope.JOB_KEY"</span>
</code></pre>
<h3 data-id="heading-29">CloseableCoroutineScope</h3>
<p>åç¨‹å’Œå¯å…³é—­ç³»ç»Ÿä¹‹é—´çš„æ¡¥æ¢æ˜¯ <code>CloseableCoroutineScope</code>ï¼Œå®ƒåŒæ—¶å®ç°äº† <code>CoroutineScope</code> å’Œ <code>AutoCloseable</code> æ¥å£ã€‚åœ¨ ViewModel æ¸…ç©ºæœŸé—´è°ƒç”¨ <code>close()</code> æ—¶ï¼Œæ‰€æœ‰æ­£åœ¨è¿è¡Œçš„åç¨‹éƒ½ä¼šè¢«å–æ¶ˆï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">internal</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CloseableCoroutineScope</span>(<span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> coroutineContext: CoroutineContext) :
    AutoCloseable, CoroutineScope {

    <span class="hljs-keyword">constructor</span>(coroutineScope: CoroutineScope) : <span class="hljs-keyword">this</span>(coroutineScope.coroutineContext)

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">close</span><span class="hljs-params">()</span></span> = coroutineContext.cancel()
}
</code></pre>
<h3 data-id="heading-30">å¹³å°æ„ŸçŸ¥è°ƒåº¦å™¨é€‰æ‹©</h3>
<p>ä½œä¸º Kotlin å¤šå¹³å°åº“ï¼ŒViewModel åœ¨æ²¡æœ‰ä¸»çº¿ç¨‹æ¦‚å¿µçš„å¹³å°ä¸Šä¹Ÿèƒ½å·¥ä½œï¼Œå› ä¸ºå®ƒä¼šå›é€€åˆ° <code>EmptyCoroutineContext</code>ã€‚è¯·æ³¨æ„ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯ <code>Dispatchers.Main.immediate</code> è€Œä¸æ˜¯ <code>Dispatchers.Main</code>ï¼Œè¿™æ ·å¯ä»¥é¿å…åœ¨å·²ç»åœ¨ä¸»çº¿ç¨‹ä¸Šè¿è¡Œæ—¶è¿›è¡Œä¸å¿…è¦çš„é‡æ–°è°ƒåº¦ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">internal</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">createViewModelScope</span><span class="hljs-params">()</span></span>: CloseableCoroutineScope {
    <span class="hljs-keyword">val</span> dispatcher =
        <span class="hljs-keyword">try</span> {
            Dispatchers.Main.immediate
        } <span class="hljs-keyword">catch</span> (_: NotImplementedError) {
            <span class="hljs-comment">// In Native environments where `Dispatchers.Main` might not exist (e.g., Linux)</span>
            EmptyCoroutineContext
        } <span class="hljs-keyword">catch</span> (_: IllegalStateException) {
            <span class="hljs-comment">// In JVM Desktop environments where `Dispatchers.Main` might not exist (e.g., Swing)</span>
            EmptyCoroutineContext
        }
    <span class="hljs-keyword">return</span> CloseableCoroutineScope(coroutineContext = dispatcher + SupervisorJob())
}
</code></pre>
<h3 data-id="heading-31">SupervisorJob å®ç°å­åç¨‹ç‹¬ç«‹å¤±è´¥</h3>
<p>è¯¥ä½œç”¨åŸŸä½¿ç”¨ <code>SupervisorJob()</code>ï¼Œå…è®¸å­åç¨‹ç‹¬ç«‹å¤±è´¥ã€‚è€Œä½¿ç”¨æ™®é€šçš„ <code>Job</code> æ—¶ï¼Œå¦‚æœä¸€ä¸ªå­åç¨‹å¤±è´¥ï¼Œå®ƒä¼šå–æ¶ˆæ‰€æœ‰åŒçº§åç¨‹ã€‚è¿™ç§è®¾è®¡ç¬¦åˆ UI åº”ç”¨ç¨‹åºçš„é¢„æœŸï¼Œå³å¤±è´¥çš„ç½‘ç»œè¯·æ±‚ä¸åº”è¯¥å–æ¶ˆæ­£åœ¨è¿›è¡Œçš„æ•°æ®åº“æ“ä½œã€‚</p>
<h2 data-id="heading-32">ViewModelLazyï¼šKotlin å±æ€§å§”æ‰˜</h2>
<p><code>viewModels()</code> å§”æ‰˜ä½¿ç”¨äº† <code>ViewModelLazy</code>ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewModelLazy</span>&lt;<span class="hljs-type">VM : ViewModel</span>&gt;
<span class="hljs-meta">@JvmOverloads</span>
<span class="hljs-keyword">constructor</span>(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> viewModelClass: KClass&lt;VM&gt;,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> storeProducer: () -&gt; ViewModelStore,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> factoryProducer: () -&gt; ViewModelProvider.Factory,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> extrasProducer: () -&gt; CreationExtras = { CreationExtras.Empty },
) : Lazy&lt;VM&gt; {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> cached: VM? = <span class="hljs-literal">null</span>

    <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> value: VM
        <span class="hljs-keyword">get</span>() {
            <span class="hljs-keyword">val</span> viewModel = cached
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span> (viewModel == <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">val</span> store = storeProducer()
                <span class="hljs-keyword">val</span> factory = factoryProducer()
                <span class="hljs-keyword">val</span> extras = extrasProducer()
                ViewModelProvider.create(store, factory, extras).<span class="hljs-keyword">get</span>(viewModelClass).also {
                    cached = it
                }
            } <span class="hljs-keyword">else</span> {
                viewModel
            }
        }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">isInitialized</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Boolean</span> = cached != <span class="hljs-literal">null</span>
}
</code></pre>
<h3 data-id="heading-33">åŒé‡ç¼“å­˜æ¶æ„</h3>
<p>æƒ°æ€§å§”æ‰˜ä¼šåœ¨é¦–æ¬¡è®¿é—®åå°† ViewModel å¼•ç”¨ç¼“å­˜åˆ°æœ¬åœ°ã€‚è¿™æ˜¯ä¸€ç§åŒé‡ç¼“å­˜æ¨¡å¼ï¼š</p>
<ol>
<li><strong>ViewModelStore ç¼“å­˜</strong>ï¼šè§„èŒƒç¼“å­˜ï¼Œä¸å—é…ç½®æ›´æ”¹çš„å½±å“ã€‚</li>
<li><strong>ViewModelLazy ç¼“å­˜</strong>ï¼šæœ¬åœ°ç¼“å­˜ï¼Œç”¨äºé¿å…é‡å¤åˆ›å»º ViewModelProviderã€‚</li>
</ol>
<p>æœ¬åœ°ç¼“å­˜æ˜¯ä¸€ç§ä¼˜åŒ–ï¼Œåˆ›å»º <code>ViewModelProvider</code> å¹¶æŸ¥æ‰¾ ViewModel çš„å¼€é”€å¾ˆå°ï¼Œä½†ç¼“å­˜å¯ä»¥é¿å…åç»­è®¿é—®ä¸­å“ªæ€•æ˜¯è¿™ç§å¾®å°çš„å¼€é”€ã€‚</p>
<h3 data-id="heading-34">ç”¨äºå»¶è¿Ÿè®¿é—®çš„ Lambda ç”Ÿäº§è€…</h3>
<p>æ‰€æœ‰ä¸‰ä¸ªç”Ÿäº§è€…ï¼ˆstoreã€factoryã€extrasï¼‰éƒ½æ˜¯ Lambda è¡¨è¾¾å¼ï¼Œå…è®¸å»¶è¿Ÿæ±‚å€¼ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> viewModel <span class="hljs-keyword">by</span> viewModels { MyViewModelFactory() }
<span class="hljs-comment">// Factory is only created when viewModel is first accessed</span>
</code></pre>
<p>è¿™å¯¹äº Fragment å°¤å…¶é‡è¦ï¼Œå› ä¸ºåœ¨å±æ€§åˆå§‹åŒ–æœŸé—´ Activity å¯èƒ½ä¸å¯ç”¨ã€‚</p>
<h2 data-id="heading-35">Android ç‰¹æœ‰ï¼šAGP ä»£ç è„±ç³–å…¼å®¹æ€§</h2>
<p>Android æœ‰ä¸€ä¸ªç‰¹æ®Šçš„å…¼å®¹å±‚ï¼Œç”¨äºå¤„ç†æ··åˆä½¿ç”¨é’ˆå¯¹ä¸åŒ ViewModel ç‰ˆæœ¬ç¼–è¯‘çš„åº“æ—¶å‡ºç°çš„ AGPï¼ˆAndroid Gradle æ’ä»¶ï¼‰ä»£ç è„±ç³–é—®é¢˜ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">internal</span> <span class="hljs-keyword">actual</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;VM : ViewModel&gt;</span> <span class="hljs-title">createViewModel</span><span class="hljs-params">(
    factory: <span class="hljs-type">ViewModelProvider</span>.<span class="hljs-type">Factory</span>,
    modelClass: <span class="hljs-type">KClass</span>&lt;<span class="hljs-type">VM</span>&gt;,
    extras: <span class="hljs-type">CreationExtras</span>,
)</span></span>: VM {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">try</span> {
        factory.create(modelClass, extras)
    } <span class="hljs-keyword">catch</span> (e: AbstractMethodError) {
        <span class="hljs-keyword">try</span> {
            factory.create(modelClass.java, extras)
        } <span class="hljs-keyword">catch</span> (e: AbstractMethodError) {
            factory.create(modelClass.java)
        }
    }
}
</code></pre>
<p>è¿™ä¸€ç³»åˆ— try-catch ä»£ç å—ç”¨äºå¤„ç†ä½¿ç”¨æ—§ç‰ˆæœ¬ ViewModel ç¼–è¯‘çš„å·¥å‚ç¼ºå°‘è¾ƒæ–°ç‰ˆæœ¬çš„ <code>create</code> æ–¹æ³•çš„æƒ…å†µã€‚å½“è¿è¡Œæ—¶è°ƒç”¨ç¼–è¯‘åçš„å­—èŠ‚ç ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶ï¼Œå°±ä¼šå‡ºç° <code>AbstractMethodError</code> é”™è¯¯ï¼Œè¿™ç§æƒ…å†µé€šå¸¸å‘ç”Ÿåœ¨æ—§å·¥å‚åªæœ‰ <code>create(Class&lt;T&gt;)</code> æ–¹æ³•ï¼Œè€Œè¿è¡Œæ—¶éœ€è¦ <code>create(Class&lt;T&gt;, CreationExtras)</code> æ–¹æ³•æ—¶ã€‚è¿™ç§é˜²å¾¡æ€§çº§è”æœºåˆ¶èƒ½å¤Ÿä¼˜é›…åœ°é™çº§åˆ°æ–¹æ³•å˜ä½“ï¼Œç¡®ä¿ ViewModel åˆ›å»ºåŠŸèƒ½ä¸å—åº“ç‰ˆæœ¬ä¸åŒ¹é…çš„å½±å“ã€‚</p>
<h2 data-id="heading-36">æ€§èƒ½ç‰¹æ€§å’Œè®¾è®¡æƒè¡¡</h2>
<p>ViewModel ç³»ç»Ÿåœ¨è®¾è®¡ä¸Šåšå‡ºäº†ä¸€äº›æƒè¡¡ï¼Œä»¥å¹³è¡¡æ­£ç¡®æ€§ã€çµæ´»æ€§å’Œæ€§èƒ½ã€‚</p>
<h3 data-id="heading-37">åŒæ­¥å¼€é”€</h3>
<p><code>ViewModelProviderImpl</code> å’Œ <code>ViewModelImpl</code> éƒ½ä½¿ç”¨åŒæ­¥å—æ¥å®ç°çº¿ç¨‹å®‰å…¨è®¿é—®ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">synchronized(lock) {
    <span class="hljs-keyword">val</span> viewModel = store[key]
    <span class="hljs-comment">// ...</span>
}
</code></pre>
<p>ç”±äº ViewModel è®¿é—®é€šå¸¸å‘ç”Ÿåœ¨ä¸»çº¿ç¨‹ä¸Šï¼Œä¸´ç•ŒåŒºå¾ˆçŸ­ï¼ˆç®€å•çš„ map æ“ä½œï¼‰ï¼Œå¹¶ä¸”é”äº‰ç”¨å¾ˆå°‘å‘ç”Ÿï¼Œå› æ­¤è¿™ç§åŒæ­¥å¼€é”€éå¸¸å°ã€‚è¯¥è®¾è®¡ä¼˜å…ˆè€ƒè™‘æ­£ç¡®æ€§è€Œéå¾®ä¼˜åŒ–ï¼Œå› ä¸ºç½•è§çš„ç«æ€æ¡ä»¶ä»£ä»·è¿œé«˜äºå‡ ä¹å¯Ÿè§‰ä¸åˆ°çš„åŒæ­¥å¼€é”€ã€‚</p>
<h3 data-id="heading-38">åå°„å¼€é”€</h3>
<p><code>NewInstanceFactory</code> ä½¿ç”¨ Java åå°„æ¥åŠ¨æ€å®ä¾‹åŒ– ViewModel ç±»ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">modelClass.getDeclaredConstructor().newInstance()
</code></pre>
<p>ç”±äºè¿è¡Œæ—¶ç±»å‹æ£€æŸ¥å’ŒåŠ¨æ€æ–¹æ³•è§£æï¼Œåå°„æ¯”ç›´æ¥æ„é€ å‡½æ•°è°ƒç”¨è¦æ…¢ã€‚ä½†æ˜¯ï¼Œè¿™ç§å¼€é”€å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œå› ä¸º ViewModel çš„åˆ›å»ºé¢‘ç‡å¾ˆä½ï¼ˆæ¯ä¸ªç”Ÿå‘½å‘¨æœŸä¸€æ¬¡ï¼‰ï¼Œè€Œä¸”æ— éœ€ç¼–è¯‘æ—¶ä¿¡æ¯å³å¯å®ä¾‹åŒ–ä»»ä½• ViewModel å­ç±»çš„çµæ´»æ€§è¿œè¿œè¶…è¿‡äº†è¿™ç‚¹å¾®å°çš„å¼€é”€ã€‚</p>
<h3 data-id="heading-39">åŸºäºæ˜ å°„çš„å­˜å‚¨</h3>
<p>ä½¿ç”¨ <code>MutableMap</code> ä½œä¸º ViewModelStore å¯ä»¥æä¾› O(1) çš„æŸ¥æ‰¾æ—¶é—´ï¼Œä½†æ¸…é™¤æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸º O(n)ï¼Œå› ä¸ºæ¯ä¸ª ViewModel éƒ½å¿…é¡»å•ç‹¬æ¸…é™¤ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">clear</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">for</span> (vm <span class="hljs-keyword">in</span> map.values) {
        vm.clear()
    }
    map.clear()
}
</code></pre>
<p>ç”±äº ViewModelStore é€šå¸¸åªåŒ…å« 1-5 ä¸ª ViewModelï¼Œå› æ­¤çº¿æ€§æ—¶é—´çš„æ¸…é™¤æ“ä½œå®é™…ä¸Šå¹¶æ— å½±å“ã€‚ä½¿ç”¨æ ‡å‡† HashMap çš„ç®€æ´æ€§ä½¿å¾—ä»£ç æ›´æ˜“äºç†è§£å’Œç»´æŠ¤ï¼Œå¯¹äºè¿™ç§æœ‰é™çš„ç”¨ä¾‹è€Œè¨€ï¼Œå…¶ä»·å€¼è¿œå¤§äºç†è®ºä¸Šçš„ä¼˜åŒ–ã€‚</p>
<h3 data-id="heading-40">ç”¨äºæ¨¡æ‹Ÿçš„å¯ç©ºå®ç°</h3>
<p>JVM ViewModel ä¸­çš„å¯ç©º <code>impl</code> ä¼šåœ¨æ¯ä¸ªæ“ä½œä¸­æ·»åŠ ç©ºå€¼æ£€æŸ¥ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">impl?.clear()
</code></pre>
<p>è¿™ç§å¾®å°çš„å¼€é”€å¯ä»¥å®ç°æ­£ç¡®çš„æ¨¡æ‹Ÿè¡Œä¸ºã€‚å½“æ¨¡æ‹Ÿæ¡†æ¶åˆ›å»º ViewModel æ¨¡æ‹Ÿå¯¹è±¡æ—¶ï¼Œå®ƒä»¬ä¼šç»•è¿‡çœŸæ­£çš„æ„é€ å‡½æ•°ï¼Œå¯¼è‡´ <code>impl</code> æœªåˆå§‹åŒ–ã€‚å¯ç©ºç±»å‹å¯ä»¥é˜²æ­¢æµ‹è¯•ä¸­å‡ºç° <code>NullPointerException</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªå€¼å¾—çš„æƒè¡¡ã€‚</p>
<h2 data-id="heading-41">å®é™…åº”ç”¨æ¨¡å¼ï¼šç†è§£ ViewModel çš„ä½¿ç”¨</h2>
<p>ç†è§£å…¶å†…éƒ¨æœºåˆ¶æœ‰åŠ©äºä½ åœ¨å®é™…åº”ç”¨ä¸­è¯†åˆ«æ¨¡å¼å’Œåæ¨¡å¼ã€‚</p>
<h3 data-id="heading-42">æ¨¡å¼ 1ï¼šä½œç”¨åŸŸ ViewModel å…±äº«</h3>
<p>å¯ä»¥ä½¿ç”¨ Activity çš„ ViewModelStore è€Œä¸æ˜¯æ¯ä¸ª Fragment è‡ªå·±çš„å­˜å‚¨æ¥åœ¨ Fragment ä¹‹é—´å…±äº« ViewModelï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">FragmentA</span> : <span class="hljs-type">Fragment</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> sharedViewModel: SharedViewModel <span class="hljs-keyword">by</span> activityViewModels()
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">FragmentB</span> : <span class="hljs-type">Fragment</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> sharedViewModel: SharedViewModel <span class="hljs-keyword">by</span> activityViewModels()
}
</code></pre>
<p>ä¸¤ä¸ª Fragment ä¼šè·å¾—ç›¸åŒçš„ ViewModel å®ä¾‹ï¼Œå› ä¸ºå®ƒä»¬ä½¿ç”¨ç›¸åŒçš„ ViewModelStoreï¼ˆActivity çš„ï¼‰ã€‚è¿™ä½¿å¾—å…„å¼Ÿ Fragment å¯ä»¥é€šè¿‡å…±äº«çŠ¶æ€è¿›è¡Œé€šä¿¡ã€‚å†…éƒ¨æœºåˆ¶ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// activityViewModels() uses:</span>
ViewModelProvider(
    store = requireActivity().viewModelStore,  <span class="hljs-comment">// Same store for both fragments</span>
    factory = ...,
)
</code></pre>
<h3 data-id="heading-43">æ¨¡å¼ 2ï¼šè‡ªå®šä¹‰é”®ç”¨äºå¤šä¸ªå®ä¾‹</h3>
<p>ä½ å¯ä»¥é€šè¿‡æä¾›è‡ªå®šä¹‰é”®æ¥æ‹¥æœ‰åŒä¸€ä¸ª ViewModel ç±»çš„å¤šä¸ªå®ä¾‹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> viewModel1: MyViewModel = viewModelProvider[<span class="hljs-string">"user_1"</span>, MyViewModel::<span class="hljs-keyword">class</span>]
<span class="hljs-keyword">val</span> viewModel2: MyViewModel = viewModelProvider[<span class="hljs-string">"user_2"</span>, MyViewModel::<span class="hljs-keyword">class</span>]
</code></pre>
<p>è¯¥é”®åŒ…å«è‡ªå®šä¹‰å­—ç¬¦ä¸²ï¼Œä»è€Œåœ¨ ViewModelStore ä¸­åˆ›å»ºå•ç‹¬çš„ç¼“å­˜æ¡ç›®ã€‚è¿™å¯¹äºåŒæ—¶ç®¡ç†å¤šä¸ªç”¨æˆ·é…ç½®æ–‡ä»¶æˆ–èŠå¤©å¯¹è¯ç­‰åœºæ™¯éå¸¸æœ‰ç”¨ã€‚</p>
<h3 data-id="heading-44">æ¨¡å¼ 3ï¼šä½¿ç”¨ CreationExtras è¿›è¡Œå·¥å‚æ³¨å…¥</h3>
<p>ç°ä»£å·¥å‚æ˜¯æ— çŠ¶æ€çš„ï¼Œåœ¨åˆ›å»ºæ—¶é€šè¿‡ CreationExtras æ¥æ”¶æ‰€æœ‰ä¾èµ–é¡¹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyViewModelFactory</span> : <span class="hljs-type">ViewModelProvider.Factory</span> {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : ViewModel&gt;</span> <span class="hljs-title">create</span><span class="hljs-params">(modelClass: <span class="hljs-type">KClass</span>&lt;<span class="hljs-type">T</span>&gt;, extras: <span class="hljs-type">CreationExtras</span>)</span></span>: T {
        <span class="hljs-keyword">val</span> repository = extras[REPOSITORY_KEY]!!
        <span class="hljs-keyword">val</span> userId = extras[USER_ID_KEY]!!
        <span class="hljs-keyword">return</span> MyViewModel(repository, userId) <span class="hljs-keyword">as</span> T
    }
}
</code></pre>
<p>è¿™ä½¿å¾—å·¥å‚å¯ä»¥ä½œä¸ºå•ä¾‹ï¼ŒåŒæ—¶æ¯æ¬¡è°ƒç”¨é…ç½®éƒ½ä¸åŒï¼Œä»è€Œé¿å…ä¸ºæ¯ä¸ªå…·æœ‰ä¸åŒä¾èµ–é¡¹çš„ ViewModel åˆ›å»ºæ–°çš„å·¥å‚å®ä¾‹ã€‚</p>
<h3 data-id="heading-45">åæ¨¡å¼ï¼šåœ¨ ViewModel ä¸­è®¿é—® Context</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Bad: Leaks Activity context</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyViewModel</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> context: Context) : ViewModel()

<span class="hljs-comment">// Good: Use Application context via AndroidViewModel</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyViewModel</span>(application: Application) : AndroidViewModel(application)

<span class="hljs-comment">// Better: Don't hold Context at all, pass it to methods</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyViewModel</span> : <span class="hljs-type">ViewModel</span>() {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadData</span><span class="hljs-params">(context: <span class="hljs-type">Context</span>)</span></span> { ... }
}
</code></pre>
<p>ç¬¬ä¸€ç§æ–¹æ³•å¯èƒ½ä¼šå¯¼è‡´ Activity æ³„æ¼ï¼Œå› ä¸º ViewModel åœ¨æŒæœ‰å·²é”€æ¯ Activity çš„å¼•ç”¨æ—¶ï¼Œé…ç½®æ›´æ”¹ä»ç„¶å­˜åœ¨ã€‚è¯·ä½¿ç”¨ <code>AndroidViewModel</code> æ¥è·å– Application ä¸Šä¸‹æ–‡ï¼Œæˆ–è€…åœ¨éœ€è¦æ—¶å°† Context ä¼ é€’ç»™å„ä¸ªæ–¹æ³•ã€‚</p>
<h3 data-id="heading-46">åæ¨¡å¼ï¼šåœ¨ onCleared ä¸­é˜»å¡</h3>
<p>ä½ çŸ¥é“ <code>onCleared()</code> æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸Šè°ƒç”¨çš„å—ï¼Ÿè¯¸å¦‚ç½‘ç»œå…³é—­æˆ–æ•°æ®åº“æ¸…ç†ä¹‹ç±»çš„é˜»å¡æ“ä½œåº”è¯¥ä½¿ç”¨åç¨‹çš„ <code>addCloseable</code> æ–¹æ³•å¸è½½åˆ°åå°çº¿ç¨‹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Bad: Blocking call in onCleared</span>
<span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCleared</span><span class="hljs-params">()</span></span> {
    networkClient.shutdown()  <span class="hljs-comment">// May block the main thread until completing the shutdown process!</span>
}

<span class="hljs-comment">// Good: Use addCloseable for managed cleanup</span>
<span class="hljs-keyword">init</span> {
    addCloseable {
        scope.launch { networkClient.shutdown() }
    }
}
</code></pre>
<h2 data-id="heading-47">ç»“è®º</h2>
<p>Jetpack ViewModel çš„å†…éƒ¨æœºåˆ¶å±•ç°äº†ä¸€ä¸ªç²¾å¿ƒè®¾è®¡çš„ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥çŠ¶æ€ç®¡ç†ç³»ç»Ÿã€‚ViewModelStore é€šè¿‡ä¿ç•™æ˜ å°„æä¾›ç®€å•è€Œæœ‰æ•ˆçš„ç¼“å­˜ï¼Œè€Œ ViewModelProvider åˆ™é€šè¿‡çº¿ç¨‹å®‰å…¨çš„è®¿é—®å’Œçµæ´»çš„å·¥å‚æ”¯æŒæ¥åè°ƒåˆ›å»ºè¿‡ç¨‹ã€‚CreationExtras é€šè¿‡å¤–éƒ¨åŒ–é…ç½®æ¥å®ç°æ— çŠ¶æ€å·¥å‚ï¼Œè€Œ AutoCloseable é›†æˆåˆ™ç¡®ä¿äº†èµ„æºçš„æ­£ç¡®æ¸…ç†ã€‚</p>
<p>å¤šå¹³å°æ¶æ„å°†é€šç”¨é€»è¾‘æå–åˆ°å†…éƒ¨å®ç°ç±»ä¸­ï¼Œä½¿è¯¥åº“èƒ½å¤Ÿæ”¯æŒ JVMã€Androidã€iOS å’Œå…¶ä»–å¹³å°ã€‚viewModelScope é›†æˆé€šè¿‡ closeable æœºåˆ¶æä¾›è‡ªåŠ¨åç¨‹å–æ¶ˆåŠŸèƒ½ï¼Œå¹¶ä¸ºæ²¡æœ‰ä¸»çº¿ç¨‹çš„ç¯å¢ƒæä¾›å¹³å°æ„ŸçŸ¥çš„è°ƒåº¦å™¨é€‰æ‹©ã€‚</p>
<p>å¦‚æœä½ æƒ³æŒæ¡æœ€æ–°çš„æŠ€èƒ½ã€æ–°é—»ã€æŠ€æœ¯æ–‡ç« ã€é¢è¯•é¢˜å’Œå®ç”¨ä»£ç æŠ€å·§ï¼Œè¯·æŸ¥çœ‹<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fdoveletter%2F" target="_blank" title="https://github.com/doveletter/" ref="nofollow noopener noreferrer">Dove Letter</a>ã€‚æƒ³è¦æ›´æ·±å…¥åœ°äº†è§£é¢è¯•å‡†å¤‡ï¼Œåƒä¸‡ä¸è¦é”™è¿‡ç»ˆæ Android é¢è¯•æŒ‡å—ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.android.skydoves.me%2F" target="_blank" title="https://www.android.skydoves.me/" ref="nofollow noopener noreferrer">Manifest Android Interview</a>ã€‚</p>
<blockquote>
<p>æ¬¢è¿æœç´¢å¹¶å…³æ³¨ <em>å…¬ä¼—å·<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fmp%2Fqrcode%3Fscene%3D10000004%26size%3D512%26__biz%3DMzU1MDg0NDczNA%3D%3D%26mid%3D2247484417%26idx%3D1%26sn%3D60c15f0d3c4be75e37748c2472a74102" target="_blank" title="https://mp.weixin.qq.com/mp/qrcode?scene=10000004&amp;size=512&amp;__biz=MzU1MDg0NDczNA==&amp;mid=2247484417&amp;idx=1&amp;sn=60c15f0d3c4be75e37748c2472a74102" ref="nofollow noopener noreferrer">ã€Œç¨€æœ‰çŒ¿è¯‰ã€</a></em> è·å–æ›´å¤šçš„ä¼˜è´¨æ–‡ç« ï¼</p>
<p>ä¿æŠ¤åŸåˆ›ï¼Œè¯·å‹¿è½¬è½½ï¼</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2025ï¼šä»â€œä»£ç æ¬è¿â€åˆ°â€œæ„å›¾ç¼–ç»‡â€ï¼Œæˆ‘åœ¨ AI æµªæ½®ä¸­æ‰¾å›äº†å¼€å‘çš„â€œçˆ½æ„Ÿâ€]]></title>    <link>https://juejin.cn/post/7587811143110246451</link>    <guid>https://juejin.cn/post/7587811143110246451</guid>    <pubDate>2025-12-26T09:09:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587811143110246451" data-draft-id="7587965908288012298" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2025ï¼šä»â€œä»£ç æ¬è¿â€åˆ°â€œæ„å›¾ç¼–ç»‡â€ï¼Œæˆ‘åœ¨ AI æµªæ½®ä¸­æ‰¾å›äº†å¼€å‘çš„â€œçˆ½æ„Ÿâ€"/> <meta itemprop="keywords" content="åç«¯,ç¨‹åºå‘˜,äº§å“"/> <meta itemprop="datePublished" content="2025-12-26T09:09:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="èˆ’ä¸€ç¬‘ä¸ç§ƒå¤´"/> <meta itemprop="url" content="https://juejin.cn/user/4257747754552599"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2025ï¼šä»â€œä»£ç æ¬è¿â€åˆ°â€œæ„å›¾ç¼–ç»‡â€ï¼Œæˆ‘åœ¨ AI æµªæ½®ä¸­æ‰¾å›äº†å¼€å‘çš„â€œçˆ½æ„Ÿâ€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4257747754552599/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    èˆ’ä¸€ç¬‘ä¸ç§ƒå¤´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T09:09:56.000Z" title="Fri Dec 26 2025 09:09:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å²æœ«å°†è‡³ï¼Œæ˜é‡‘çš„è¿™æ¬¡â€œå›´ç‚‰å¤œè¯â€è®©æˆ‘åœä¸‹äº†æ•²å‡»é”®ç›˜çš„æ‰‹ã€‚å›æœ› 2025 å¹´ï¼Œå¦‚æœç”¨ä¸€ä¸ªè¯æ¥å‹¾å‹’æˆ‘çš„å¹´åº¦è½®å»“ï¼Œé‚£ä¸€å®šä¸æ˜¯â€œæ•ˆç‡â€ï¼Œè€Œæ˜¯ <strong>â€œVibeï¼ˆæ°›å›´/å…±é¸£ï¼‰â€</strong> ã€‚</p>
<p>ä½œä¸ºâ€œèˆ’ä¸€ç¬‘ä¸ç§ƒå¤´â€ï¼Œæˆ‘è¿™ä¸€å¹´çš„æŠ€æœ¯ç”Ÿæ´»ï¼Œå…¶å®æ˜¯ä¸€åœºå…³äºâ€œå¦‚ä½•ä¸è¢«ä»£ç å¼‚åŒ–â€çš„çªå›´ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ Qoder é‡Œçš„â€œå¿ƒæµâ€ï¼šå½“ AI æˆäº†æˆ‘çš„å¤–éª¨éª¼</h2>
<p>å¹´åˆæ—¶ï¼Œæˆ‘ä¹Ÿæ›¾é™·å…¥å¯¹å¤§æ¨¡å‹çš„ç„¦è™‘ï¼šAgent æ¨ªç©ºå‡ºä¸–ï¼Œç¨‹åºå‘˜çš„è¾¹ç•Œåœ¨å“ªé‡Œï¼Ÿä½†ç»è¿‡è¿™ä¸€å¹´ä¸ Qoder ç­‰å·¥å…·çš„æ·±åº¦ç£¨åˆï¼Œæˆ‘æ€»ç»“å‡ºäº†ä¸€å¥—â€œé«˜æ•ˆä½¿ç”¨æ³•åˆ™â€ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8ee7baa70f354888962aeff27fb30f1f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IiS5LiA56yR5LiN56eD5aS0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344996&amp;x-signature=KdRNxpEbx0EgAFKvDTXtUpoaV5g%3D" alt="image.png" loading="lazy"/></p>
<p><strong>2025 å¹´ï¼Œæˆ‘çš„ Vibe Coding æ—¶åˆ»ï¼Œå¾€å¾€å‘ç”Ÿåœ¨æ·±å¤œã€‚</strong></p>
<p>ä»¥å‰çš„æ·±å¤œï¼Œæˆ‘å¯èƒ½åœ¨ä¸ºæŸä¸ªæ­£åˆ™åŒ¹é…ç„¦å¤´çƒ‚é¢ï¼Œæˆ–è€…åœ¨å†—é•¿çš„å¢åˆ æ”¹æŸ¥ä¸­æ¶ˆè€—ä½“åŠ›ã€‚è€Œç°åœ¨ï¼Œæˆ‘æ›´åƒæ˜¯ä¸€ä¸ª<strong>æ„å›¾çš„ç¼–ç»‡è€…</strong>ã€‚æˆ‘ä¸å†çº ç»“äºè¯­æ³•ç»†èŠ‚ï¼Œè€Œæ˜¯å°†é‡å¿ƒè½¬å‘äº†ç³»ç»Ÿè®¾è®¡å’Œé€»è¾‘æ‹“æ‰‘ã€‚åœ¨ Qoder çš„è¾…åŠ©ä¸‹ï¼Œä»£ç ä¸å†æ˜¯æ²‰é‡çš„è´Ÿæ‹…ï¼Œè€Œæˆäº†éšå¿ƒæ‰€æ¬²çš„è¡¨è¾¾ã€‚é‚£ç§â€œæˆ‘æƒ³ï¼Œå®ƒå³ç°â€çš„å³æ—¶åé¦ˆï¼Œè®©æˆ‘é‡æ–°æ‰¾å›äº†åˆå­¦ç¼–ç¨‹æ—¶é‚£ç§çº¯ç²¹çš„ã€å¤šå·´èƒºåˆ†æ³Œçš„å¿«ä¹ã€‚</p>
<p>è¿™æ­£æ˜¯ Vibe Coding çš„æ ¸å¿ƒï¼š<strong>è®©æŠ€æœ¯é€€å±…å¹•åï¼Œè®©åˆ›é€ è€…çš„ç›´è§‰èµ°å‘å°å‰ã€‚</strong></p>
<h2 data-id="heading-1">äºŒã€ StrLoom çš„åšæŒï¼šåœ¨â€œå¿«â€æ—¶ä»£åšä¸€ç‚¹â€œæ…¢â€å·¥å…·</h2>
<p>2025 å¹´ï¼Œä¹Ÿæ˜¯ <strong>StrLoom</strong> é€æ¸æˆå‹çš„ä¸€å¹´ã€‚</p>
<p>åœ¨ AI å‚¬ç”Ÿäº†æ— æ•°â€œä¸€é”®ç”Ÿæˆâ€çš„æµ®èºäº§å“æ—¶ï¼Œæˆ‘é€‰æ‹©å»åšä¸€ä¸ªå¹²å‡€ã€ç§å¯†ã€é«˜æ•ˆçš„å¼€å‘è€…å·¥å…·é›†ã€‚ä¸ºä»€ä¹ˆè¦è‡ªå·±åšï¼Ÿå› ä¸ºæˆ‘åŒå€¦äº†é‚£äº›å……æ»¡å¹¿å‘Šã€ä¾µçŠ¯éšç§ã€ç”šè‡³éœ€è¦æˆ‘ä¸ºäº†ä¸€ä¸ªå°åŠŸèƒ½å»å…³æ³¨å…¬ä¼—å·çš„å·¥å…·ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/58e7d37a26df4b029e7d740842c81c65~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IiS5LiA56yR5LiN56eD5aS0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344996&amp;x-signature=1doVMLMw%2Br6BPH06jHu2yI0F2oM%3D" alt="image.png" loading="lazy"/></p>
<p><strong>ä»·å€¼æºè‡ªéœ€æ±‚ï¼Œå› ä¸ºè¢«éœ€æ±‚ï¼Œæ‰€ä»¥æ‰æœ‰ä»·å€¼ã€‚</strong></p>
<p>åœ¨å¼€å‘ StrLoom çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘æ€è€ƒå¾—æœ€å¤šçš„æ˜¯ï¼š<strong>å¦‚ä½•è®©å·¥å…·å›å½’å·¥å…·æœ¬èº«ï¼Ÿ</strong> AI ç»™äº†æˆ‘æå¤§çš„å¼€å‘åŠ©åŠ›ï¼Œä½†æˆ‘å¹¶æ²¡æœ‰è®© AI å–§å®¾å¤ºä¸»ã€‚æˆ‘åˆ©ç”¨ AI å¤„ç†ç¹ççš„å…¼å®¹æ€§æµ‹è¯•ï¼Œè€ŒæŠŠå…³äºâ€œç®€æ´â€ä¸â€œç”¨æˆ·å°Šé‡â€çš„çµé­‚ç•™ç»™è‡ªå·±ã€‚StrLoom å°±åƒæˆ‘åœ¨æ•°å­—è’åŸé‡Œç§ä¸‹çš„ä¸€æ£µæ ‘ï¼Œä¸ä¸ºå˜ç°è€Œè‡ƒè‚¿ï¼Œåªä¸ºè§£å†³é‚£ä¸€ç‚¹ç‚¹çœŸåˆ‡çš„ç—›ç‚¹ã€‚è¿™ç§çº¯ç²¹çš„å¼€å‘å¿ƒæ€ï¼Œæ„æˆäº†æˆ‘ 2025 å¹´æœ€ç¨³å›ºçš„â€œå¿ƒç† Vibeâ€ã€‚</p>
<h2 data-id="heading-2">ä¸‰ã€ æ‹’ç»å¼‚åŒ–ï¼šæŠ€æœ¯ä¸è¯¥æ˜¯â€œç§ƒå¤´â€çš„ç†ç”±</h2>
<p>ä½œä¸ºä¸€ä¸ªå¯¹é©¬å…‹æ€å¼‚åŒ–ç†è®ºæœ‰æ·±åº¦å…±é¸£çš„äººï¼Œæˆ‘ä¸€ç›´åœ¨è­¦æƒ• AI å¯¹äººçš„åå‘æ”¯é…ã€‚å¦‚æœ AI åªæ˜¯è®©æˆ‘ä»¬äº§å‡ºäº†æ›´å¤šçš„â€œåƒåœ¾ä»£ç â€ï¼Œé‚£å®ƒæœ¬è´¨ä¸Šæ˜¯åœ¨åŠ é€Ÿäººçš„å¼‚åŒ–ã€‚</p>
<p>ä½† 2025 å¹´ç»™æˆ‘çš„ç­”æ¡ˆæ˜¯ä¹è§‚çš„ã€‚é€šè¿‡æ™ºèƒ½ä½“å·¥å…·ï¼Œæˆ‘ä»ç¹é‡çš„å®æ–½æ€§å·¥ä½œä¸­è§£è„±å‡ºæ¥ï¼Œæœ‰äº†æ›´å¤šæ—¶é—´å»æ€è€ƒâ€œä¸ºä»€ä¹ˆè€Œåšâ€ã€‚</p>
<ul>
<li><strong>å…±è¯†æ¥è‡ªäºåˆ†æ­§çš„è¶…è¶Šï¼š</strong> æˆ‘ä¸ AI çš„å¯¹è¯ï¼Œæœ¬è´¨ä¸Šæ˜¯åœ¨ä¸æ–­å¯¹é½äººç±»æ„å›¾ä¸æœºå™¨æ‰§è¡Œä¹‹é—´çš„åˆ†æ­§ã€‚</li>
<li><strong>æ¨¡å¼æ˜¯ç”Ÿå­˜ä¸å‘å±•çš„è·¯å¾„ï¼š</strong> è¿™ä¸€å¹´ï¼Œæˆ‘å­¦ä¼šäº†åˆ©ç”¨ AI å»ºç«‹è‡ªå·±çš„ä¸ªäººç”Ÿäº§åŠ›é—­ç¯ï¼Œè€Œä¸æ˜¯åœ¨æ— é™çš„åŠ ç­ä¸­é€æ”¯å¥åº·ã€‚</li>
</ul>
<p>â€œèˆ’ä¸€ç¬‘ä¸ç§ƒå¤´â€è¿™ä¸ªåå­—ï¼Œå…¶å®æ˜¯æˆ‘å¯¹è¿™ä¸ªè¡Œä¸šçš„ä¸€ç‚¹å°å°åæŠ—ã€‚2025 å¹´ï¼Œå› ä¸º AI çš„ä»‹å…¥ï¼Œæˆ‘å‘ç°é‚£ç§â€œä¼˜é›…åœ°ç¼–ç¨‹ï¼Œä½“é¢åœ°ç”Ÿæ´»â€çš„ç†æƒ³çŠ¶æ€ï¼Œæ­£åœ¨å˜å¾—è¶Šæ¥è¶Šæ¸…æ™°ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/87939f37f7af4d70bb1d145fe9a33ce0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IiS5LiA56yR5LiN56eD5aS0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344996&amp;x-signature=O1RHOpc4lJf%2BtGZK2HFd%2F8a4Zbw%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-3">ç»“è¯­ï¼šå±äºæˆ‘çš„æ•°å­—å¹´è½®</h2>
<p>2025 å¹´çš„é’Ÿå£°å³å°†æ•²å“ï¼Œæˆ‘çš„æ•°å­—å¹´è½®é‡Œï¼Œæœ‰ä¸€åŠåˆ»ç€ AI è¾…åŠ©ä¸‹çš„é«˜æ•ˆï¼Œå¦ä¸€åŠåˆ»ç€ç‹¬ç«‹å¼€å‘è€…çš„æ¸…é†’ã€‚</p>
<p>æŠ€æœ¯æµæ·Œè¿›ç”Ÿæ´»ï¼Œä¸åº”è¯¥æ˜¯æŸç§å†·å†°å†°çš„æ›¿ä»£ï¼Œè€Œåº”è¯¥æ˜¯å¯¹ä¸ªäººæ„å¿—çš„æ”¾å¤§ã€‚åœ¨æœªæ¥çš„ 2026ï¼Œæˆ‘å¸Œæœ›ç»§ç»­ä¿æŒè¿™ç§ Vibeï¼š<strong>æ‰‹ä¸­æœ‰æœ€å¿«çš„åˆ€ï¼ˆAIï¼‰ï¼Œå¿ƒä¸­æœ‰æœ€æ¸…æ¾ˆçš„æµï¼ˆåˆè¡·ï¼‰ã€‚</strong></p>
<p>æ„¿æ¯ä¸€ä½æ˜å‹ï¼Œåœ¨ç®—æ³•çš„æ´ªæµä¸­ï¼Œéƒ½èƒ½æ‰¾åˆ°å±äºè‡ªå·±çš„é‚£ä»½â€œä¸ç§ƒå¤´â€çš„ä»å®¹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AIè®©æˆ‘å˜å¼ºäº†è¿˜æ˜¯å˜å¼±äº†ï¼Ÿä¸€ä¸ªåç«¯å¼€å‘çš„å¹´ç»ˆè‡ªçœ]]></title>    <link>https://juejin.cn/post/7587998744294178822</link>    <guid>https://juejin.cn/post/7587998744294178822</guid>    <pubDate>2025-12-26T09:10:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587998744294178822" data-draft-id="7587965908288028682" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AIè®©æˆ‘å˜å¼ºäº†è¿˜æ˜¯å˜å¼±äº†ï¼Ÿä¸€ä¸ªåç«¯å¼€å‘çš„å¹´ç»ˆè‡ªçœ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-26T09:10:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å˜»å“ˆbaby"/> <meta itemprop="url" content="https://juejin.cn/user/485305583405066"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AIè®©æˆ‘å˜å¼ºäº†è¿˜æ˜¯å˜å¼±äº†ï¼Ÿä¸€ä¸ªåç«¯å¼€å‘çš„å¹´ç»ˆè‡ªçœ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/485305583405066/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å˜»å“ˆbaby
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T09:10:24.000Z" title="Fri Dec 26 2025 09:10:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€é‚£ä¸ªè®©æˆ‘å¼€å§‹æ€€ç–‘è‡ªå·±çš„ç¬é—´</h2>
<p>å‰å‡ å¤©å›¢é˜Ÿæ¥äº†ä¸ªå®ä¹ ç”Ÿï¼Œè®©æˆ‘å¸®å¿™reviewä¸€æ®µä»£ç ã€‚</p>
<p>æˆ‘æ‰«äº†ä¸€çœ¼ï¼Œéšå£è¯´ï¼š"è¿™ä¸ªRedisåˆ†å¸ƒå¼é”çš„å®ç°æœ‰é—®é¢˜ï¼Œæ²¡æœ‰è€ƒè™‘é”ç»­æœŸï¼Œä¸šåŠ¡æ‰§è¡Œæ—¶é—´è¶…è¿‡è¿‡æœŸæ—¶é—´å°±ä¼šå‡ºé—®é¢˜ã€‚"</p>
<p>å®ä¹ ç”Ÿä¸€è„¸å´‡æ‹œåœ°é—®æˆ‘ï¼š"å“¥ä½ æ€ä¹ˆä¸€çœ¼å°±èƒ½çœ‹å‡ºæ¥çš„ï¼Ÿ"</p>
<p>æˆ‘å¼ äº†å¼ å˜´ï¼Œçªç„¶æ„£ä½äº†ã€‚</p>
<p>å› ä¸ºæˆ‘æƒ³èµ·æ¥ï¼Œè¿™ä¸ªçŸ¥è¯†ç‚¹æ˜¯ä¸‰ä¸ªæœˆå‰æˆ‘é—®Cursorçš„æ—¶å€™å®ƒå‘Šè¯‰æˆ‘çš„ã€‚å½“æ—¶æˆ‘ä¹Ÿå†™äº†ç±»ä¼¼çš„ä»£ç ï¼Œæ˜¯AIå¸®æˆ‘æŒ‡å‡ºçš„é—®é¢˜ã€‚</p>
<p>é‚£ä¸€åˆ»æˆ‘çªç„¶æ„è¯†åˆ°ä¸€ä»¶äº‹ï¼š<strong>æˆ‘å¼•ä»¥ä¸ºå‚²çš„"ç»éªŒ"ï¼Œæœ‰å¤šå°‘æ˜¯AIæ•™æˆ‘çš„ï¼Ÿå¦‚æœæ²¡æœ‰AIï¼Œæˆ‘çœŸçš„èƒ½å‘ç°è¿™ä¸ªé—®é¢˜å—ï¼Ÿ</strong></p>
<h2 data-id="heading-1">äºŒã€2025ï¼Œæˆ‘å’ŒAIçš„èœœæœˆæœŸ</h2>
<p>å¦ç™½è¯´ï¼Œè¿™ä¸€å¹´AIç¡®å®è®©æˆ‘"å˜å¼º"äº†ã€‚</p>
<p>å¹´åˆç”¨Cursorå†™çš„ä»£ç ï¼Œåˆ°ç°åœ¨å·²ç»ä¸Šçº¿è·‘äº†å¿«ä¸€å¹´ï¼Œç¨³å®šå¾—å¾ˆã€‚æœ‰ä¸ªå®šæ—¶ä»»åŠ¡çš„é€»è¾‘ç‰¹åˆ«å¤æ‚ï¼Œæ¶‰åŠåˆ°å¤šä¸ªæ•°æ®æºçš„å¯¹è´¦ï¼Œä»¥å‰æˆ‘å¯èƒ½è¦å†™ä¸€å‘¨ï¼Œç”¨AIä¸¤å¤©å°±æå®šäº†ã€‚</p>
<p>æˆ‘çš„è¾“å‡ºæ˜æ˜¾å˜å¤šäº†ï¼š</p>
<ul>
<li>GitHubæäº¤æ•°æ¯”å»å¹´ç¿»äº†ä¸€å€</li>
<li>ç‹¬ç«‹è´Ÿè´£çš„é¡¹ç›®ä»2ä¸ªå˜æˆäº†5ä¸ª</li>
<li>ç”šè‡³å¼€å§‹å†™æŠ€æœ¯åšå®¢ï¼Œä»Šå¹´å‘äº†30å¤šç¯‡</li>
</ul>
<p>å¦‚æœåªçœ‹è¿™äº›æ•°æ®ï¼Œæˆ‘åº”è¯¥å¾ˆå¼€å¿ƒæ‰å¯¹ã€‚</p>
<p>ä½†æˆ‘å¼€å¿ƒä¸èµ·æ¥ã€‚</p>
<p>å› ä¸ºæˆ‘è¶Šæ¥è¶Šåˆ†ä¸æ¸…ï¼Œè¿™äº›"äº§å‡º"é‡Œæœ‰å¤šå°‘æ˜¯æˆ‘çš„èƒ½åŠ›ï¼Œæœ‰å¤šå°‘æ˜¯AIçš„èƒ½åŠ›ã€‚</p>
<h2 data-id="heading-2">ä¸‰ã€Anthropicçš„é‚£å¥è¯æˆ³ä¸­äº†æˆ‘</h2>
<p>å‰é˜µå­çœ‹åˆ° Anthropic çš„ä¸€ç¯‡æ–‡ç« ã€ŠHow AI Is Transforming Work at Anthropicã€‹ï¼Œé‡Œé¢æœ‰ä¸€å¥è¯è®©æˆ‘æ²‰é»˜äº†å¾ˆä¹…ï¼š</p>
<blockquote>
<p><strong>"æˆ‘ä»¥ä¸ºæˆ‘å–œæ¬¢å†™ä»£ç ï¼Œå…¶å®æˆ‘åªæ˜¯å–œæ¬¢ä»£ç è·‘é€šçš„ç»“æœã€‚"</strong></p>
</blockquote>
<p>è¯´çš„ä¸å°±æ˜¯æˆ‘å—ï¼Ÿ</p>
<p>å›æƒ³è¿™ä¸€å¹´ï¼Œæˆ‘ç”¨AIå®ç°äº†å¾ˆå¤šä¸œè¥¿ï¼š</p>
<ul>
<li>ä¸€ä¸ªè‡ªåŠ¨åŒ–è¿ç»´è„šæœ¬ï¼Œèƒ½æ‰¹é‡ç®¡ç†å‡ åå°æœåŠ¡å™¨</li>
<li>ä¸€ä¸ªæ•°æ®åˆ†æçœ‹æ¿ï¼Œè€æ¿å¾ˆæ»¡æ„</li>
<li>ä¸€ä¸ªå†…éƒ¨å·¥å…·å¹³å°ï¼ŒåŒäº‹éƒ½è¯´å¥½ç”¨</li>
</ul>
<p>ä½†é—®é¢˜æ˜¯ï¼š<strong>è¿™äº›ä¸œè¥¿çš„æ ¸å¿ƒé€»è¾‘ï¼Œæˆ‘çœŸçš„ç†è§£å—ï¼Ÿ</strong></p>
<p>é‚£ä¸ªè¿ç»´è„šæœ¬é‡Œæœ‰æ®µå¹¶å‘æ§åˆ¶çš„ä»£ç ï¼Œæˆ‘è‡³ä»Šä¸å¤ªæ˜ç™½ä¸ºä»€ä¹ˆè¦ç”¨ä¿¡å·é‡è€Œä¸æ˜¯çº¿ç¨‹æ± ã€‚å½“æ—¶AIç»™äº†æ–¹æ¡ˆï¼Œæˆ‘æµ‹äº†å‡ éæ²¡é—®é¢˜å°±ä¸Šçº¿äº†ã€‚</p>
<p>å¦‚æœç°åœ¨è®©æˆ‘è„±ç¦»AIï¼Œé‡æ–°å†™ä¸€éï¼Œæˆ‘å†™å¾—å‡ºæ¥å—ï¼Ÿ</p>
<p>æˆ‘ä¸ç¡®å®šã€‚</p>
<h2 data-id="heading-3">å››ã€ä¸€ä¸ªå±é™©çš„è¶‹åŠ¿ï¼šæˆ‘åœ¨é€€åŒ–</h2>
<p>æœ€è¿‘æˆ‘å‘ç°äº†ä¸€ä¸ªå±é™©çš„ä¿¡å·ã€‚</p>
<p>ä»¥å‰é‡åˆ°é—®é¢˜ï¼Œæˆ‘çš„ç¬¬ä¸€ååº”æ˜¯ï¼šæƒ³ä¸€æƒ³ï¼Œç”»ä¸ªå›¾ï¼Œç†ç†æ€è·¯ã€‚</p>
<p>ç°åœ¨æˆ‘çš„ç¬¬ä¸€ååº”æ˜¯ï¼šé—®AIã€‚</p>
<p>è¿™çœ‹èµ·æ¥æ˜¯æ•ˆç‡æå‡ï¼Œä½†ä»”ç»†æƒ³æƒ³å¾ˆå¯æ€•â€”â€”<strong>æˆ‘æ­£åœ¨å¤±å»ç‹¬ç«‹æ€è€ƒçš„ä¹ æƒ¯ã€‚</strong></p>
<p>æ›´å¯æ€•çš„æ˜¯ï¼Œè¿™ç§é€€åŒ–æ˜¯æ— æ„ŸçŸ¥çš„ã€‚</p>
<p>å› ä¸ºæœ‰AIå…œåº•ï¼Œæˆ‘é‡åˆ°çš„é—®é¢˜éƒ½èƒ½è§£å†³ï¼Œæ‰€ä»¥æˆ‘æ„Ÿè§‰ä¸åˆ°è‡ªå·±åœ¨å˜å¼±ã€‚ç›´åˆ°æœ‰ä¸€å¤©ç½‘ç»œä¸å¥½ï¼ŒAIåŠ è½½ä¸å‡ºæ¥ï¼Œæˆ‘å¯¹ç€ä¸€ä¸ªNPEæ„£äº†äº”åˆ†é’Ÿæ‰æƒ³èµ·æ¥å¯ä»¥ç”¨debugã€‚</p>
<p>é‚£ä¸€åˆ»æˆ‘æ‰æ„è¯†åˆ°ï¼š<strong>æˆ‘ä¸æ˜¯å˜å¼ºäº†ï¼Œæˆ‘æ˜¯å˜ä¾èµ–äº†ã€‚</strong></p>
<h2 data-id="heading-4">äº”ã€OpenAIç»™å‡ºçš„ç­”æ¡ˆï¼šæ ¸å¿ƒèƒ½åŠ›åœ¨å˜åŒ–</h2>
<p>ä½†è¯è¯´å›æ¥ï¼Œå®Œå…¨ä¸ç”¨AIä¹Ÿä¸ç°å®ã€‚å°±åƒOpenAIåœ¨ã€Šä½¿ç”¨Codexåœ¨28å¤©å†…æ„å»ºAndroidç‰ˆSoraã€‹é‡Œå±•ç¤ºçš„ï¼š</p>
<blockquote>
<p>AIå¯ä»¥24å°æ—¶æ— é—´æ–­ç¼–å†™ä»£ç å’Œè‡ªæˆ‘ä¿®å¤ï¼Œ28å¤©é€šè¿‡50äº¿tokenå®Œæˆäº†æ­£å¸¸éœ€è¦å‡ ä¸ªæœˆçš„äº§å“ä¸Šçº¿ã€‚</p>
</blockquote>
<p>ä½ æƒ³è·ŸAIæ‹¼å†™ä»£ç çš„é€Ÿåº¦ï¼Ÿæ‹¼ä¸è¿‡çš„ã€‚</p>
<p>æ‰€ä»¥é—®é¢˜ä¸æ˜¯"è¦ä¸è¦ç”¨AI"ï¼Œè€Œæ˜¯"ç”¨AIçš„åŒæ—¶ï¼Œæˆ‘çš„æ ¸å¿ƒç«äº‰åŠ›æ˜¯ä»€ä¹ˆ"ã€‚</p>
<p>OpenAIçš„ç»“è®ºæ˜¯ï¼š</p>
<blockquote>
<p><strong>æœªæ¥çš„å¼€å‘å·¥ç¨‹å¸ˆçš„èƒ½åŠ›ä¸å†æ˜¯æ‰“å­—é€Ÿåº¦æˆ–è¯­æ³•APIè®°å¿†ï¼Œè€Œæ˜¯å¯¹ç³»ç»Ÿçš„æ·±åˆ»æ´å¯ŸåŠ›ã€‚</strong></p>
</blockquote>
<p>æ¢å¥è¯è¯´ï¼š</p>
<ul>
<li>âŒ ç†Ÿç»ƒä½¿ç”¨æŸä¸ªæ¡†æ¶ â†’ AIæ¯”ä½ æ›´ç†Ÿ</li>
<li>âŒ è®°ä½å„ç§API â†’ AIæ¯”ä½ è®°å¾—æ¸…æ¥š</li>
<li>âœ… ç†è§£ç³»ç»Ÿä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ â†’ è¿™æ˜¯ä½ çš„</li>
<li>âœ… åœ¨å¤æ‚åœºæ™¯ä¸‹åšæƒè¡¡å†³ç­– â†’ è¿™æ˜¯ä½ çš„</li>
<li>âœ… æŠŠæ¨¡ç³Šçš„éœ€æ±‚ç¿»è¯‘æˆæ¸…æ™°çš„é—®é¢˜ â†’ è¿™æ˜¯ä½ çš„</li>
</ul>
<h2 data-id="heading-5">å…­ã€æˆ‘çš„åº”å¯¹ï¼šä»"ç”¨AIå†™ä»£ç "åˆ°"ç®¡ç†AIå†™ä»£ç "</h2>
<p>æƒ³æ˜ç™½è¿™ä¸ªé—®é¢˜åï¼Œæˆ‘è°ƒæ•´äº†è‡ªå·±ä½¿ç”¨AIçš„æ–¹å¼ã€‚</p>
<h3 data-id="heading-6">ä»¥å‰ï¼šè®©AIå†™ï¼Œæˆ‘æ¥éªŒ</h3>
<pre><code class="hljs language-css" lang="css">æˆ‘ï¼šå¸®æˆ‘å†™ä¸€ä¸ªåˆ†å¸ƒå¼é”çš„å®ç°
AIï¼š<span class="hljs-selector-attr">[ä¸€å¤§æ®µä»£ç ]</span>
æˆ‘ï¼šè·‘ä¸€ä¸‹ï¼Œæ²¡é—®é¢˜ï¼Œä¸Šçº¿
</code></pre>
<h3 data-id="heading-7">ç°åœ¨ï¼šæˆ‘æ¥è§„åˆ’ï¼ŒAIæ¥æ‰§è¡Œ</h3>
<pre><code class="hljs language-css" lang="css">æˆ‘ï¼šæˆ‘éœ€è¦å®ç°ä¸€ä¸ªåˆ†å¸ƒå¼é”ï¼Œåœºæ™¯æ˜¯è®¢å•æ‰£åº“å­˜ï¼Œ
    è¦æ±‚ï¼š<span class="hljs-number">1</span>. æ”¯æŒé”ç»­æœŸ <span class="hljs-number">2</span>. è¦æœ‰è·å–é”çš„è¶…æ—¶æœºåˆ¶ <span class="hljs-number">3</span>. é‡Šæ”¾é”è¦ä¿è¯åŸå­æ€§
    å…ˆåˆ«å†™ä»£ç ï¼Œå¸®æˆ‘åˆ†æä¸€ä¸‹æŠ€æœ¯æ–¹æ¡ˆçš„é€‰æ‹©

AIï¼š<span class="hljs-selector-attr">[åˆ†æRedis vs Zookeeper vs etcdçš„ä¼˜åŠ£]</span>

æˆ‘ï¼šç”¨Redisï¼Œä½†æˆ‘æ‹…å¿ƒä¸»ä»åˆ‡æ¢æ—¶çš„é”ä¸¢å¤±é—®é¢˜ï¼Œæ€ä¹ˆå¤„ç†ï¼Ÿ

AIï¼š<span class="hljs-selector-attr">[åˆ†æRedLockçš„åŸç†å’Œäº‰è®®]</span>

æˆ‘ï¼šå¥½ï¼Œå…ˆå†™ä¸ªè®¾è®¡æ–‡æ¡£ï¼Œæˆ‘reviewä¸€ä¸‹å†å¼€å§‹å†™ä»£ç 
</code></pre>
<p>åŒºåˆ«åœ¨å“ªï¼Ÿ</p>
<p><strong>ä»¥å‰æˆ‘æ˜¯"ä»£ç çš„éªŒæ”¶è€…"ï¼Œç°åœ¨æˆ‘æ˜¯"æ–¹æ¡ˆçš„å†³ç­–è€…"ã€‚</strong></p>
<p>AIè´Ÿè´£æ‰§è¡Œï¼Œæˆ‘è´Ÿè´£ï¼š</p>
<ol>
<li>å®šä¹‰é—®é¢˜çš„è¾¹ç•Œ</li>
<li>é€‰æ‹©æŠ€æœ¯æ–¹æ¡ˆ</li>
<li>æŠŠæ§æ¶æ„è®¾è®¡</li>
<li>åšæœ€ç»ˆå†³ç­–</li>
</ol>
<p>è¿™æ ·å†™å‡ºæ¥çš„ä»£ç ï¼Œæˆ‘æ˜¯çœŸçš„ç†è§£çš„ã€‚</p>
<h3 data-id="heading-8">å®è·µï¼šç»™AIå»ºç«‹è§„èŒƒ</h3>
<p>æœ€è¿‘åœ¨è¯• Claude Codeï¼Œæœ‰ä¸ªåŠŸèƒ½å¾ˆæœ‰æ„æ€ï¼šä½ å¯ä»¥ç»™AIå†™ä¸€ä¸ªCLAUDE.mdï¼Œå‘Šè¯‰å®ƒé¡¹ç›®çš„ä¸Šä¸‹æ–‡å’Œè§„èŒƒã€‚</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># é¡¹ç›®ä¸Šä¸‹æ–‡</span>

<span class="hljs-section">## æŠ€æœ¯æ ˆ</span>
<span class="hljs-bullet">-</span> Java 17 + Spring Boot 3.2
<span class="hljs-bullet">-</span> MyBatis-Plusï¼ˆç¦æ­¢ä½¿ç”¨JPAï¼‰
<span class="hljs-bullet">-</span> Redis 7.0ï¼ˆå·²å°è£…åœ¨ common-redis æ¨¡å—ï¼‰

<span class="hljs-section">## è§„èŒƒ</span>
<span class="hljs-bullet">-</span> æ‰€æœ‰é‡‘é¢å­—æ®µä½¿ç”¨BigDecimalï¼Œç¦æ­¢double
<span class="hljs-bullet">-</span> åˆ†å¸ƒå¼é”ç»Ÿä¸€ä½¿ç”¨ LockUtilï¼Œä¸è¦è‡ªå·±å®ç°
<span class="hljs-bullet">-</span> å¼‚å¸¸å¤„ç†ä½¿ç”¨å…¨å±€å¼‚å¸¸å¤„ç†å™¨ï¼ŒControllerä¸è¦try-catch
</code></pre>
<p>æœ‰äº†è¿™ä¸ªï¼ŒAIå°±ä¸ä¼šä¹±å†™ä»£ç ã€‚å®ƒçŸ¥é“é¡¹ç›®é‡Œæœ‰ä»€ä¹ˆï¼Œè¯¥ç”¨ä»€ä¹ˆï¼Œä¸è¯¥ç”¨ä»€ä¹ˆã€‚</p>
<p><strong>æœ¬è´¨ä¸Šï¼Œè¿™æ˜¯åœ¨"é©¯æœ"AIã€‚</strong></p>
<p>æŠŠå®ƒå½“æˆä¸€ä¸ª"èƒ½åŠ›å¾ˆå¼ºä½†ä¸äº†è§£é¡¹ç›®èƒŒæ™¯çš„æ–°äºº"ï¼Œä½ éœ€è¦åšçš„æ˜¯ç»™å®ƒè¶³å¤Ÿçš„ä¸Šä¸‹æ–‡ï¼Œåˆ¶å®šæ¸…æ™°çš„è§„èŒƒï¼Œç„¶åè®©å®ƒåœ¨ä½ åˆ’å®šçš„èŒƒå›´å†…å‘æŒ¥ã€‚</p>
<h2 data-id="heading-9">ä¸ƒã€é‡æ–°å®šä¹‰"å¼º"</h2>
<p>å†™åˆ°è¿™é‡Œï¼Œæˆ‘æƒ³å›ç­”å¼€å¤´çš„é—®é¢˜ï¼š<strong>AIè®©æˆ‘å˜å¼ºäº†è¿˜æ˜¯å˜å¼±äº†ï¼Ÿ</strong></p>
<p>ç­”æ¡ˆæ˜¯ï¼š<strong>çœ‹ä½ æ€ä¹ˆå®šä¹‰"å¼º"ã€‚</strong></p>
<p>å¦‚æœ"å¼º"æ˜¯æŒ‡äº§å‡ºå¤šã€äº¤ä»˜å¿«ï¼Œé‚£æˆ‘ç¡®å®å˜å¼ºäº†ã€‚</p>
<p>ä½†å¦‚æœ"å¼º"æ˜¯æŒ‡ç¦»å¼€å·¥å…·ä¹Ÿèƒ½è§£å†³é—®é¢˜ï¼Œé‚£æˆ‘å¯èƒ½åœ¨å˜å¼±ã€‚</p>
<p>æˆ‘ç°åœ¨çš„ç†è§£æ˜¯ï¼š</p>
<ol>
<li><strong>çŸ­æœŸ</strong>ï¼šå­¦ä¼šç”¨AIï¼Œæé«˜ç”Ÿäº§åŠ›ï¼Œè¿™æ˜¯ç”Ÿå­˜éœ€è¦</li>
<li><strong>é•¿æœŸ</strong>ï¼šä¿æŒç‹¬ç«‹æ€è€ƒèƒ½åŠ›ï¼Œç†è§£ç³»ç»Ÿæœ¬è´¨ï¼Œè¿™æ˜¯æ ¸å¿ƒç«äº‰åŠ›</li>
<li><strong>å¹³è¡¡</strong>ï¼šç”¨AIåŠ é€Ÿæ‰§è¡Œï¼Œä½†å…³é”®å†³ç­–è‡ªå·±åš</li>
</ol>
<p>å°±åƒå¼€è½¦æœ‰äº†å¯¼èˆªï¼Œä½ å¯ä»¥æ›´å¿«åˆ°è¾¾ç›®çš„åœ°ï¼Œä½†ä½ ä¸èƒ½å®Œå…¨ä¾èµ–å®ƒâ€”â€”è‡³å°‘ä½ è¦çŸ¥é“å¤§æ¦‚å¾€å“ªä¸ªæ–¹å‘å¼€ï¼Œå¦åˆ™å¯¼èˆªä¸€æ–­ä½ å°±å‚»çœ¼äº†ã€‚</p>
<h2 data-id="heading-10">å…«ã€å†™åœ¨2025å¹´æœ«</h2>
<p>è¿™ä¸€å¹´ï¼ŒAIä»"å·¥å…·"å˜æˆäº†"ä¼™ä¼´"ï¼Œç”šè‡³åœ¨æŸäº›æ—¶åˆ»ï¼Œæˆ‘åˆ†ä¸æ¸…å®ƒæ˜¯ä¼™ä¼´è¿˜æ˜¯æ‹æ–ã€‚</p>
<p>æˆ‘ä¸çŸ¥é“2026å¹´AIä¼šè¿›åŒ–æˆä»€ä¹ˆæ ·ã€‚ä¹Ÿè®¸å®ƒä¼šæ›´å¼ºï¼Œå¼ºåˆ°è®©"å†™ä»£ç "è¿™ä»¶äº‹æœ¬èº«å˜å¾—ä¸å†é‡è¦ã€‚</p>
<p>ä½†æˆ‘æƒ³ï¼Œæ— è®ºæŠ€æœ¯æ€ä¹ˆå˜ï¼Œæœ‰äº›ä¸œè¥¿æ˜¯ä¸å˜çš„ï¼š</p>
<ul>
<li>å¯¹é—®é¢˜æœ¬è´¨çš„å¥½å¥‡å¿ƒ</li>
<li>æŠŠå¤æ‚ç³»ç»Ÿæƒ³æ¸…æ¥šçš„èƒ½åŠ›</li>
<li>é¢å¯¹ä¸ç¡®å®šæ€§åšå†³ç­–çš„å‹‡æ°”</li>
</ul>
<p>è¿™äº›ï¼ŒAIæš‚æ—¶è¿˜æ›¿ä»£ä¸äº†ã€‚</p>
<p><strong>æ„¿ä½ æˆ‘éƒ½èƒ½åœ¨AIçš„æµªæ½®é‡Œï¼Œæ‰¾åˆ°å±äºè‡ªå·±çš„é”šç‚¹ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[LangChain Memory å®æˆ˜æŒ‡å—ï¼šè®©å¤§æ¨¡å‹è®°ä½ä½ æ¯ä¸€å¥è¯ï¼Œè½»æ¾æ‰“é€ â€œæœ‰è®°å¿†â€çš„AIåŠ©æ‰‹]]></title>    <link>https://juejin.cn/post/7587965908288094218</link>    <guid>https://juejin.cn/post/7587965908288094218</guid>    <pubDate>2025-12-26T09:15:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587965908288094218" data-draft-id="7587997893986910235" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" LangChain Memory å®æˆ˜æŒ‡å—ï¼šè®©å¤§æ¨¡å‹è®°ä½ä½ æ¯ä¸€å¥è¯ï¼Œè½»æ¾æ‰“é€ â€œæœ‰è®°å¿†â€çš„AIåŠ©æ‰‹"/> <meta itemprop="keywords" content="LangChain,LLM,JavaScript"/> <meta itemprop="datePublished" content="2025-12-26T09:15:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ €ç§‹666"/> <meta itemprop="url" content="https://juejin.cn/user/2566698322650307"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             LangChain Memory å®æˆ˜æŒ‡å—ï¼šè®©å¤§æ¨¡å‹è®°ä½ä½ æ¯ä¸€å¥è¯ï¼Œè½»æ¾æ‰“é€ â€œæœ‰è®°å¿†â€çš„AIåŠ©æ‰‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2566698322650307/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ €ç§‹666
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T09:15:38.000Z" title="Fri Dec 26 2025 09:15:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><hr/>
<h2 data-id="heading-0">å¼•è¨€</h2>
<blockquote>
<p>ä½ æœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™æ ·çš„å°´å°¬ï¼Ÿ<br/>
å‘ AI æé—®ï¼šâ€œæˆ‘å«å¼ ä¸‰â€ï¼Œä¸‹ä¸€ç§’å†é—®â€œæˆ‘å«ä»€ä¹ˆåå­—ï¼Ÿâ€â€”â€”å®ƒå±…ç„¶è¯´ï¼šâ€œæŠ±æ­‰ï¼Œæˆ‘ä¸è®°å¾—äº†ã€‚â€ ğŸ˜…</p>
<p>åˆ«æ€ªæ¨¡å‹ç¬¨ï¼Œè¿™æ˜¯æ‰€æœ‰ LLM çš„â€œå…ˆå¤©ç¼ºé™·â€ï¼š<strong>æ— çŠ¶æ€è°ƒç”¨</strong>ã€‚</p>
<p>ä½†ä»Šå¤©ï¼Œæˆ‘ä»¬ç”¨ <strong>LangChain Memory</strong> ç»™å®ƒè£…ä¸Šâ€œå¤§è„‘â€ï¼Œå®ç°çœŸæ­£æ„ä¹‰ä¸Šçš„å¤šè½®å¯¹è¯è®°å¿†ï¼</p>
<p>æœ¬æ–‡å°†å¸¦ä½ ä»é›¶æ„å»ºä¸€ä¸ªä¼šâ€œè®°äº‹â€çš„æ™ºèƒ½åŠ©æ‰‹ï¼Œå¹¶æ·±å…¥å‰–æåº•å±‚åŸç†ã€æ€§èƒ½ç“¶é¢ˆä¸ç”Ÿäº§çº§ä¼˜åŒ–æ–¹æ¡ˆã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-1">ğŸ§  ä¸€ã€ä¸ºä»€ä¹ˆä½ çš„ AI æ€»æ˜¯â€œé‡‘é±¼è„‘â€ï¼Ÿ</h3>
<h4 data-id="heading-2">1.1 å¤§æ¨¡å‹çš„â€œå¤±å¿†ç—‡â€çœŸç›¸</h4>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªâ€œé»‘ç®±å‡½æ•°â€ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">response = <span class="hljs-title function_">model</span>(prompt)
</code></pre>
<p>æ¯æ¬¡è°ƒç”¨éƒ½æ˜¯ç‹¬ç«‹çš„ HTTP è¯·æ±‚ï¼Œ<strong>æ²¡æœ‰ä»»ä½•ä¸Šä¸‹æ–‡ä¿ç•™æœºåˆ¶</strong> â€”â€” å°±åƒæ¯æ¬¡è§é¢éƒ½é‡æ–°è®¤è¯†ä¸€éã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ç¬¬ä¸€æ¬¡å¯¹è¯</span>
<span class="hljs-keyword">await</span> model.<span class="hljs-title function_">invoke</span>(<span class="hljs-string">"æˆ‘å«é™ˆæ˜Šï¼Œå–œæ¬¢å–ç™½å…°åœ°"</span>);
<span class="hljs-comment">// è¾“å‡ºï¼šå¾ˆé«˜å…´è®¤è¯†ä½ ï¼Œé™ˆæ˜Šï¼çœ‹æ¥ä½ å–œæ¬¢å–ç™½å…°åœ°å‘¢ï½</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'------ åˆ†å‰²çº¿ ------'</span>);

<span class="hljs-comment">// ç¬¬äºŒæ¬¡å¯¹è¯</span>
<span class="hljs-keyword">await</span> model.<span class="hljs-title function_">invoke</span>(<span class="hljs-string">"æˆ‘å«ä»€ä¹ˆåå­—ï¼Ÿ"</span>);
<span class="hljs-comment">// è¾“å‡ºï¼šå‘ƒâ€¦â€¦ä¸å¤ªæ¸…æ¥šï¼Œèƒ½å‘Šè¯‰æˆ‘å—ï¼Ÿ</span>
</code></pre>
<p>ğŸ‘‰ ç»“æœä»¤äººå´©æºƒï¼šå‰è„šåˆšè‡ªæˆ‘ä»‹ç»ï¼Œåè„šå°±å¿˜äº†ï¼</p>
<p>è¿™åœ¨å®é™…é¡¹ç›®ä¸­æ˜¯ä¸å¯æ¥å—çš„ã€‚æ— è®ºæ˜¯å®¢æœæœºå™¨äººã€æ•™è‚²åŠ©æ‰‹è¿˜æ˜¯ä¸ªæ€§åŒ–æ¨èç³»ç»Ÿï¼Œ<strong>éƒ½éœ€è¦è®°ä½ç”¨æˆ·çš„å†å²è¡Œä¸ºå’Œåå¥½</strong>ã€‚</p>
<hr/>
<h4 data-id="heading-3">1.2 è§£å†³æ€è·¯ï¼šæŠŠâ€œè®°å¿†â€å¡è¿› Prompt</h4>
<p>æ—¢ç„¶æ¨¡å‹ä¸ä¼šè‡ªå·±è®°ï¼Œé‚£å°±<strong>æˆ‘ä»¬æ¥å¸®å®ƒè®°</strong>ï¼</p>
<p>æ ¸å¿ƒæ€æƒ³éå¸¸ç®€å•ï¼š</p>
<blockquote>
<p>âœ… æ¯æ¬¡è¯·æ±‚å‰ï¼ŒæŠŠä¹‹å‰çš„å¯¹è¯å†å²æ‹¼æ¥åˆ°å½“å‰ prompt ä¸­<br/>
âœ… è®©æ¨¡å‹â€œçœ‹åˆ°â€å®Œæ•´çš„èŠå¤©è®°å½•ï¼Œä»è€Œåšå‡ºè¿è´¯å›åº”</p>
</blockquote>
<p>è¿™å°±åƒæ˜¯ç»™æ¨¡å‹æˆ´ä¸Šäº†ä¸€å‰¯â€œè®°å¿†çœ¼é•œâ€ã€‚</p>
<p>è€Œ LangChain çš„ <code>Memory</code> æ¨¡å—ï¼Œæ­£æ˜¯å¯¹è¿™ä¸€è¿‡ç¨‹çš„é«˜åº¦å°è£…ä¸è‡ªåŠ¨åŒ–ã€‚</p>
<hr/>
<h3 data-id="heading-4">âš™ï¸ äºŒã€LangChain Memory æ ¸å¿ƒåŸç†æ‹†è§£</h3>
<p>LangChain æä¾›äº†ä¸€å¥—ä¼˜é›…çš„ APIï¼Œè®©æˆ‘ä»¬å¯ä»¥ç”¨å‡ è¡Œä»£ç å®ç°â€œæœ‰è®°å¿†â€çš„å¯¹è¯ç³»ç»Ÿã€‚</p>
<p>å…ˆçœ‹æœ€ç»ˆæ•ˆæœï¼š</p>
<pre><code class="hljs language-bash" lang="bash">User: æˆ‘å«é™ˆæ˜Šï¼Œå–œæ¬¢å–ç™½å…°åœ°
AI: ä½ å¥½ï¼Œé™ˆæ˜Šï¼ç™½å…°åœ°å¯æ˜¯å¾ˆæœ‰å“å‘³çš„é€‰æ‹©å“¦ï½

User: æˆ‘å–œæ¬¢å–ä»€ä¹ˆé…’ï¼Ÿ
AI: ä½ è¯´ä½ å–œæ¬¢å–ç™½å…°åœ°å‘€ï½æ˜¯ä¸æ˜¯å‡†å¤‡å¼€ä¸€ç“¶åº†ç¥ä¸€ä¸‹ï¼ŸğŸ˜‰
</code></pre>
<p>âœ… æˆåŠŸè®°ä½ç”¨æˆ·åå­—å’Œé¥®é…’åå¥½ï¼</p>
<p>ä¸‹é¢æˆ‘ä»¬å°±ä¸€æ­¥æ­¥å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚</p>
<hr/>
<h4 data-id="heading-5">2.1 æ ¸å¿ƒç»„ä»¶ä¸€è§ˆ</h4>

























<table><thead><tr><th>ç»„ä»¶</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><code>ChatMessageHistory</code></td><td>å­˜å‚¨å¯¹è¯å†å²ï¼ˆå†…å­˜/æ–‡ä»¶/æ•°æ®åº“ï¼‰</td></tr><tr><td><code>ChatPromptTemplate</code></td><td>å®šä¹‰æç¤ºè¯æ¨¡æ¿ï¼Œé¢„ç•™ <code>{history}</code> å ä½ç¬¦</td></tr><tr><td><code>RunnableWithMessageHistory</code></td><td>è‡ªåŠ¨æ³¨å…¥å†å² + ç®¡ç†ä¼šè¯ç”Ÿå‘½å‘¨æœŸ</td></tr><tr><td><code>sessionId</code></td><td>åŒºåˆ†ä¸åŒç”¨æˆ·çš„ä¼šè¯ï¼Œé¿å…ä¸²å°</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-6">2.2 å®Œæ•´ä»£ç å®æˆ˜</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// æ–‡ä»¶åï¼šmemory-demo.js</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ChatDeepSeek</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/deepseek"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'dotenv/config'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ChatPromptTemplate</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@langchain/core/prompts'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">RunnableWithMessageHistory</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/core/runnables"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">InMemoryChatMessageHistory</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@langchain/core/chat_history'</span>;

<span class="hljs-comment">// 1. åˆå§‹åŒ–æ¨¡å‹</span>
<span class="hljs-keyword">const</span> model = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatDeepSeek</span>({
    <span class="hljs-attr">model</span>: <span class="hljs-string">'deepseek-reasoner'</span>,
    <span class="hljs-attr">temperature</span>: <span class="hljs-number">0.3</span>,
});

<span class="hljs-comment">// 2. æ„å»ºå¸¦å†å²çš„ Prompt æ¨¡æ¿</span>
<span class="hljs-keyword">const</span> prompt = <span class="hljs-title class_">ChatPromptTemplate</span>.<span class="hljs-title function_">fromMessages</span>([
    [<span class="hljs-string">'system'</span>, <span class="hljs-string">'ä½ æ˜¯ä¸€ä¸ªæ¸©æš–ä¸”æœ‰è®°å¿†çš„åŠ©æ‰‹ï¼Œè¯·æ ¹æ®å¯¹è¯å†å²å›ç­”é—®é¢˜'</span>],
    [<span class="hljs-string">'placeholder'</span>, <span class="hljs-string">'{history}'</span>],   <span class="hljs-comment">// â† å†å²æ¶ˆæ¯è‡ªåŠ¨æ’å…¥è¿™é‡Œ</span>
    [<span class="hljs-string">'human'</span>, <span class="hljs-string">'{input}'</span>]            <span class="hljs-comment">// â† å½“å‰è¾“å…¥</span>
]);

<span class="hljs-comment">// 3. åˆ›å»ºå¯è¿è¡Œé“¾ï¼ˆå«è°ƒè¯•è¾“å‡ºï¼‰</span>
<span class="hljs-keyword">const</span> runnable = prompt
    .<span class="hljs-title function_">pipe</span>(<span class="hljs-function"><span class="hljs-params">input</span> =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'\nğŸ” æœ€ç»ˆå‘é€ç»™æ¨¡å‹çš„å®Œæ•´ä¸Šä¸‹æ–‡ï¼š'</span>);
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(input, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>));
        <span class="hljs-keyword">return</span> input;
    })
    .<span class="hljs-title function_">pipe</span>(model);

<span class="hljs-comment">// 4. åˆå§‹åŒ–å†…å­˜å†å²å­˜å‚¨</span>
<span class="hljs-keyword">const</span> messageHistory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">InMemoryChatMessageHistory</span>();

<span class="hljs-comment">// 5. åˆ›å»ºå¸¦è®°å¿†çš„é“¾</span>
<span class="hljs-keyword">const</span> chain = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RunnableWithMessageHistory</span>({
    runnable,
    <span class="hljs-attr">getMessageHistory</span>: <span class="hljs-function">() =&gt;</span> messageHistory,
    <span class="hljs-attr">inputMessagesKey</span>: <span class="hljs-string">'input'</span>,
    <span class="hljs-attr">historyMessagesKey</span>: <span class="hljs-string">'history'</span>
});

<span class="hljs-comment">// 6. å¼€å§‹å¯¹è¯æµ‹è¯•</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">testConversation</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// ç¬¬ä¸€è½®ï¼šå‘ŠçŸ¥ä¿¡æ¯</span>
    <span class="hljs-keyword">const</span> res1 = <span class="hljs-keyword">await</span> chain.<span class="hljs-title function_">invoke</span>(
        { <span class="hljs-attr">input</span>: <span class="hljs-string">"æˆ‘å«é™ˆæ˜Šï¼Œå–œæ¬¢å–ç™½å…°åœ°"</span> },
        { <span class="hljs-attr">configurable</span>: { <span class="hljs-attr">sessionId</span>: <span class="hljs-string">"user_001"</span> } }
    );
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ğŸ¤– å›åº”1ï¼š"</span>, res1.<span class="hljs-property">content</span>);

    <span class="hljs-comment">// ç¬¬äºŒè½®ï¼šæé—®å†å²</span>
    <span class="hljs-keyword">const</span> res2 = <span class="hljs-keyword">await</span> chain.<span class="hljs-title function_">invoke</span>(
        { <span class="hljs-attr">input</span>: <span class="hljs-string">"æˆ‘å«ä»€ä¹ˆåå­—ï¼Ÿæˆ‘å–œæ¬¢å–ä»€ä¹ˆé…’ï¼Ÿ"</span> },
        { <span class="hljs-attr">configurable</span>: { <span class="hljs-attr">sessionId</span>: <span class="hljs-string">"user_001"</span> } }
    );
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ğŸ¤– å›åº”2ï¼š"</span>, res2.<span class="hljs-property">content</span>);
}

<span class="hljs-title function_">testConversation</span>();
</code></pre>
<p>ğŸ“Œ <strong>è¿è¡Œç»“æœç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">ğŸ¤– å›åº”1ï¼š ä½ å¥½ï¼Œé™ˆæ˜Šï¼å¬è¯´ä½ å–œæ¬¢å–ç™½å…°åœ°ï¼ŒçœŸæ˜¯ä¸ªæœ‰å“ä½çš„äººå‘¢ï½

ğŸ¤– å›åº”2ï¼š ä½ å«é™ˆæ˜Šï¼Œè€Œä¸”ä½ è¯´ä½ å–œæ¬¢å–ç™½å…°åœ°å“¦ï½è¦ä¸è¦æ¥ç‚¹æ­é…å°åƒï¼Ÿ
</code></pre>
<p>ğŸ‰ æˆåŠŸï¼æ¨¡å‹ä¸ä»…è®°ä½äº†åå­—ï¼Œè¿˜èƒ½ç»¼åˆå¤šä¸ªä¿¡æ¯è¿›è¡Œæ¨ç†å›ç­”ï¼</p>
<hr/>
<h4 data-id="heading-7">2.3 å…³é”®æœºåˆ¶å›¾è§£</h4>
<pre><code class="hljs language-text" lang="text">              +---------------------+
              |   ç”¨æˆ·æ–°è¾“å…¥         |
              +----------+----------+
                         |
       +-----------------v------------------+
       |   ChatPromptTemplate              |
       |                                     |
       |   System: ä½ æ˜¯æœ‰è®°å¿†çš„åŠ©æ‰‹         |
       |   History: [ä¹‹å‰çš„æ‰€æœ‰å¯¹è¯] â†â”€â”€â”€â”€â”€â”€â”€+â†â”€ ä» messageHistory è¯»å–
       |   Human: æˆ‘å«ä»€ä¹ˆåå­—ï¼Ÿ             |
       +-----------------+------------------+
                         |
                è°ƒç”¨æ¨¡å‹ â†’ LLM
                         |
           è¿”å›å“åº” â†â”€â”€â”€â”€+
                         |
       +-----------------v------------------+
       |  è‡ªåŠ¨ä¿å­˜æœ¬æ¬¡äº¤äº’                  |
       |  user: æˆ‘å«ä»€ä¹ˆåå­—ï¼Ÿ               |
       |  assistant: ä½ å«é™ˆæ˜Š...            |
       |  å†™å…¥ InMemoryChatMessageHistory   |
       +------------------------------------+
</code></pre>
<p>æ•´ä¸ªæµç¨‹å…¨è‡ªåŠ¨é—­ç¯ï¼Œå¼€å‘è€…åªéœ€å…³æ³¨ä¸šåŠ¡é€»è¾‘ã€‚</p>
<hr/>
<h3 data-id="heading-8">âš ï¸ ä¸‰ã€çœŸå®åœºæ™¯ä¸‹çš„ä¸‰å¤§æŒ‘æˆ˜ä¸ç ´è§£ä¹‹é“</h3>
<p>è™½ç„¶ä¸Šé¢çš„ä¾‹å­å¾ˆç¾å¥½ï¼Œä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½ ä¼šç«‹åˆ»é¢ä¸´ä¸‰ä¸ªâ€œçµé­‚æ‹·é—®â€ï¼š</p>
<hr/>
<h4 data-id="heading-9">âŒ æŒ‘æˆ˜1ï¼šToken â€œæ»šé›ªçƒâ€çˆ†ç‚¸å¢é•¿ï¼</h4>
<p>éšç€å¯¹è¯è½®æ•°å¢åŠ ï¼Œå†å²æ¶ˆæ¯è¶Šç§¯è¶Šå¤šï¼Œå¯¼è‡´ï¼š</p>
<ul>
<li>å•æ¬¡è¯·æ±‚ Token æ•°é£™å‡</li>
<li>æˆæœ¬ç¿»å€ ğŸ’¸</li>
<li>å“åº”å˜æ…¢ â³</li>
<li>å¯èƒ½è¶…å‡ºæ¨¡å‹æœ€å¤§é•¿åº¦é™åˆ¶ï¼ˆå¦‚ 8192ï¼‰</li>
</ul>
<h5 data-id="heading-10">âœ… è§£æ³•ï¼šé€‰æ‹©åˆé€‚çš„ Memory ç±»å‹</h5>

























<table><thead><tr><th>Memory ç±»å‹</th><th>ç‰¹ç‚¹</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><code>BufferWindowMemory</code></td><td>åªä¿ç•™æœ€è¿‘ N è½®</td><td>é€šç”¨å¯¹è¯ã€çŸ­ç¨‹è®°å¿†</td></tr><tr><td><code>ConversationSummaryMemory</code></td><td>è‡ªåŠ¨ç”Ÿæˆä¸€å¥è¯æ€»ç»“</td><td>é•¿å‘¨æœŸå¯¹è¯ã€èŠ‚çœ Token</td></tr><tr><td><code>EntityMemory</code></td><td>æå–å…³é”®å®ä½“ï¼ˆäººå/åå¥½ï¼‰</td><td>æ¨èç³»ç»Ÿã€CRM åŠ©æ‰‹</td></tr></tbody></table>
<h6 data-id="heading-11">ç¤ºä¾‹ï¼šä½¿ç”¨çª—å£è®°å¿†ï¼ˆä¿ç•™æœ€è¿‘3è½®ï¼‰</h6>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BufferWindowMemory</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"langchain/memory"</span>;

<span class="hljs-keyword">const</span> memory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferWindowMemory</span>({
    <span class="hljs-attr">k</span>: <span class="hljs-number">3</span>,
    <span class="hljs-attr">memoryKey</span>: <span class="hljs-string">"history"</span>
});
</code></pre>
<blockquote>
<p>ğŸ“Œ æ¨èç»„åˆï¼š<strong>çŸ­æœŸç»†èŠ‚é çª—å£ + é•¿æœŸç‰¹å¾é æ€»ç»“</strong></p>
</blockquote>
<hr/>
<h4 data-id="heading-12">âŒ æŒ‘æˆ˜2ï¼šé‡å¯æœåŠ¡åå†å²å…¨ä¸¢ï¼Ÿï¼</h4>
<p><code>InMemoryChatMessageHistory</code> æ˜¯ä¸´æ—¶å­˜å‚¨ï¼ŒæœåŠ¡ä¸€é‡å¯ï¼Œè®°å¿†æ¸…é›¶ã€‚</p>
<h5 data-id="heading-13">âœ… è§£æ³•ï¼šæŒä¹…åŒ–åˆ°æ•°æ®åº“æˆ–æ–‡ä»¶</h5>
<h6 data-id="heading-14">æ–¹æ¡ˆä¸€ï¼šæœ¬åœ°æ–‡ä»¶å­˜å‚¨ï¼ˆè½»é‡çº§ï¼‰</h6>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">FileChatMessageHistory</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/core/chat_history"</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">getMessageHistory</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">sessionId</span>) =&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileChatMessageHistory</span>({
        <span class="hljs-attr">filePath</span>: <span class="hljs-string">`./history/<span class="hljs-subst">${sessionId}</span>.json`</span>
    });
};
</code></pre>
<h6 data-id="heading-15">æ–¹æ¡ˆäºŒï¼šRedis / MongoDBï¼ˆé«˜å¹¶å‘æ¨èï¼‰</h6>
<pre><code class="hljs language-bash" lang="bash">npm install @langchain/redis
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">RedisChatMessageHistory</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/redis"</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">getMessageHistory</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">sessionId</span>) =&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RedisChatMessageHistory</span>({
        sessionId,
        <span class="hljs-attr">client</span>: redisClient <span class="hljs-comment">// å·²è¿æ¥çš„ Redis å®¢æˆ·ç«¯</span>
    });
};
</code></pre>
<blockquote>
<p>ğŸ’¡ ç”Ÿäº§ç¯å¢ƒå¼ºçƒˆå»ºè®®ä½¿ç”¨ Redisï¼šé«˜æ€§èƒ½ã€æ”¯æŒè¿‡æœŸç­–ç•¥ã€åˆ†å¸ƒå¼éƒ¨ç½²æ— å¿§ã€‚</p>
</blockquote>
<hr/>
<h4 data-id="heading-16">âŒ æŒ‘æˆ˜3ï¼šå¤šäººåŒæ—¶èŠå¤©ä¼šä¸ä¼šä¸²æ¶ˆæ¯ï¼Ÿ</h4>
<p>å½“ç„¶ä¼šï¼å¦‚æœæ‰€æœ‰ç”¨æˆ·å…±ç”¨åŒä¸€ä¸ª <code>messageHistory</code>ï¼Œå°±ä¼šå‡ºç° A ç”¨æˆ·çœ‹åˆ° B ç”¨æˆ·çš„å¯¹è¯ã€‚</p>
<h5 data-id="heading-17">âœ… è§£æ³•ï¼šç”¨ <code>sessionId</code> éš”ç¦»ä¼šè¯</h5>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">await</span> chain.<span class="hljs-title function_">invoke</span>(
    { <span class="hljs-attr">input</span>: <span class="hljs-string">"æˆ‘é¥¿äº†"</span> },
    { <span class="hljs-attr">configurable</span>: { <span class="hljs-attr">sessionId</span>: <span class="hljs-string">"user_123"</span> } }  <span class="hljs-comment">// æ¯ä¸ªç”¨æˆ·å”¯ä¸€ ID</span>
)

<span class="hljs-keyword">await</span> chain.<span class="hljs-title function_">invoke</span>(
    { <span class="hljs-attr">input</span>: <span class="hljs-string">"æˆ‘é¥¿äº†"</span> },
    { <span class="hljs-attr">configurable</span>: { <span class="hljs-attr">sessionId</span>: <span class="hljs-string">"user_456"</span> } }  <span class="hljs-comment">// ä¸åŒç”¨æˆ·ï¼Œä¸åŒå†å²</span>
)
</code></pre>
<blockquote>
<p>âœ… å®‰å…¨éš”ç¦»ï¼Œäº’ä¸å¹²æ‰°ï¼</p>
</blockquote>
<hr/>
<h3 data-id="heading-18">ğŸ› ï¸ å››ã€Memory çš„å…¸å‹åº”ç”¨åœºæ™¯ï¼ˆé™„æ¡ˆä¾‹çµæ„Ÿï¼‰</h3>





























<table><thead><tr><th>åœºæ™¯</th><th>å¦‚ä½•ä½¿ç”¨ Memory</th></tr></thead><tbody><tr><td>å®¢æœæœºå™¨äºº</td><td>è®°ä½è®¢å•å·ã€æŠ•è¯‰è¿›åº¦ã€ç”¨æˆ·æƒ…ç»ªå˜åŒ–</td></tr><tr><td>æ•™è‚²è¾…å¯¼</td><td>è¿½è¸ªå­¦ä¹ ç« èŠ‚ã€é”™é¢˜è®°å½•ã€æŒæ¡ç¨‹åº¦</td></tr><tr><td>ç”µå•†å¯¼è´­</td><td>è®°ä½é¢„ç®—ã€å“ç‰Œåå¥½ã€å°ºç éœ€æ±‚</td></tr><tr><td>ç¼–ç¨‹åŠ©æ‰‹</td><td>ä¿æŒä»£ç ä¸Šä¸‹æ–‡ã€å‡½æ•°å®šä¹‰ã€é¡¹ç›®ç»“æ„</td></tr><tr><td>å¿ƒç†å’¨è¯¢</td><td>ç†è§£ç”¨æˆ·æƒ…ç»ªæ¼”å˜ã€å…³é”®äº‹ä»¶å›é¡¾</td></tr></tbody></table>
<p>ğŸ’¡ <strong>åˆ›æ–°ç©æ³•</strong>ï¼šç»“åˆ SummaryMemory + VectorDBï¼Œå®ç°â€œé•¿æœŸäººæ ¼è®°å¿†â€â€”â€”è®© AI è®°ä½ä½ æ˜¯å†…å‘è¿˜æ˜¯å¤–å‘ã€å–œæ¬¢å¹½é»˜è¿˜æ˜¯ä¸¥è°¨ã€‚</p>
<hr/>
<h3 data-id="heading-19">ğŸ“˜ äº”ã€<strong>é«˜é¢‘é¢è¯•é¢˜ï¼ˆLangChain æ–¹å‘ï¼‰</strong>ï¼š</h3>
<ol>
<li>LLM ä¸ºä»€ä¹ˆéœ€è¦ Memoryï¼Ÿå®ƒçš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>Buffer vs Summary Memory çš„åŒºåˆ«ï¼Ÿä»€ä¹ˆæ—¶å€™ç”¨å“ªç§ï¼Ÿ</li>
<li>å¦‚ä½•è®¾è®¡ä¸€ä¸ªæ”¯æŒç™¾ä¸‡ç”¨æˆ·åœ¨çº¿çš„è®°å¿†ç³»ç»Ÿæ¶æ„ï¼Ÿ</li>
<li>å¦‚ä½•é˜²æ­¢æ•æ„Ÿä¿¡æ¯è¢« Memory è®°å½•ï¼Ÿï¼ˆå®‰å…¨è€ƒé‡ï¼‰</li>
</ol>
<hr/>
<h3 data-id="heading-20">ğŸ“ ç»“è¯­ï¼šè®© AI çœŸæ­£â€œæ‡‚ä½ â€ï¼Œä»ä¸€æ¬¡å¯¹è¯è®°å¿†å¼€å§‹</h3>
<blockquote>
<p>â€œæ™ºèƒ½ä¸æ˜¯å›ç­”é—®é¢˜çš„èƒ½åŠ›ï¼Œè€Œæ˜¯ç†è§£ä¸Šä¸‹æ–‡çš„è‰ºæœ¯ã€‚â€</p>
</blockquote>
<p>LangChain Memory è™½ç„¶åªæ˜¯æ•´ä¸ª LLM åº”ç”¨ä¸­çš„ä¸€ä¸ªå°æ¨¡å—ï¼Œä½†å®ƒå´æ˜¯é€šå¾€<strong>æ‹ŸäººåŒ–äº¤äº’</strong>çš„å…³é”®ä¸€æ­¥ã€‚</p>
<p>ä»â€œæ— çŠ¶æ€â€åˆ°â€œæœ‰è®°å¿†â€ï¼Œæˆ‘ä»¬ä¸åªæ˜¯åœ¨å†™ä»£ç ï¼Œæ›´æ˜¯åœ¨å¡‘é€ ä¸€ç§æ–°çš„æ²Ÿé€šæ–¹å¼ã€‚</p>
<p>æœªæ¥å±äºé‚£äº›èƒ½è®© AI <strong>è®°ä½ä½ ã€ç†è§£ä½ ã€é™ªä¼´ä½ </strong>çš„äº§å“ã€‚</p>
<p>è€Œç°åœ¨ï¼Œä½ å·²ç»æœ‰äº†æ‰“é€ å®ƒçš„é’¥åŒ™ã€‚</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆ«å†è®©å•ä½“ Agent çƒ§ Token äº†ï¼šLangGraph å¤šæ™ºèƒ½ä½“å®æˆ˜æŒ‡å—]]></title>    <link>https://juejin.cn/post/7587903505135697970</link>    <guid>https://juejin.cn/post/7587903505135697970</guid>    <pubDate>2025-12-26T09:06:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587903505135697970" data-draft-id="7587965800272183322" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆ«å†è®©å•ä½“ Agent çƒ§ Token äº†ï¼šLangGraph å¤šæ™ºèƒ½ä½“å®æˆ˜æŒ‡å—"/> <meta itemprop="keywords" content="LangChain,Agent"/> <meta itemprop="datePublished" content="2025-12-26T09:06:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°ç™½ç‚¹point"/> <meta itemprop="url" content="https://juejin.cn/user/4353721774639118"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆ«å†è®©å•ä½“ Agent çƒ§ Token äº†ï¼šLangGraph å¤šæ™ºèƒ½ä½“å®æˆ˜æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4353721774639118/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°ç™½ç‚¹point
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T09:06:06.000Z" title="Fri Dec 26 2025 09:06:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>ç®€ä»‹</strong>: é’ˆå¯¹å•ä½“ Agent åœ¨å¤æ‚ä»»åŠ¡ä¸­æ˜“è¿·å¤±ã€æ˜“æ­»å¾ªç¯çš„ç—›ç‚¹ï¼Œæœ¬æ–‡æ·±å…¥æ¢è®¨äº†åŸºäº LangGraph çš„å¤š Agent åä½œæ¶æ„ã€‚é€šè¿‡ Supervisor æ¨¡å¼çš„å®æˆ˜æ¼”ç»ƒï¼Œè¯¦ç»†è§£æäº†çŠ¶æ€ç®¡ç†ã€è·¯ç”±å†³ç­–åŠé¿å‘ç»éªŒï¼ŒåŠ©ä½ æ„å»ºçœŸæ­£å¯è½åœ°çš„å·¥ä¸šçº§ AI åº”ç”¨ã€‚</p>
</blockquote>
<hr/>
<p>å¦‚æœä½ æ›¾å°è¯•è®©ä¸€ä¸ªå•ä½“ Agentï¼ˆå¦‚æ ‡å‡†çš„ <code>ChatOpenAI</code> é…åˆ <code>AgentExecutor</code>ï¼‰åŒæ—¶å®Œæˆâ€œè°ƒç ”æ–°æŠ€æœ¯ã€ç¼–å†™ Demo ä»£ç ã€è¿›è¡Œå•å…ƒæµ‹è¯•å¹¶è¾“å‡ºæ–‡æ¡£â€è¿™ä¸€ç³»åˆ—ä»»åŠ¡ï¼Œä½ å¤§æ¦‚ç‡ä¼šé‡åˆ°ä»¥ä¸‹æƒ¨çŠ¶ï¼šAgent åœ¨æ‰§è¡Œåˆ°ç¬¬ä¸‰æ­¥æ—¶å¿˜è®°äº†ç¬¬ä¸€æ­¥çš„çº¦æŸï¼Œæˆ–è€…åœ¨ä»£ç æŠ¥é”™æ—¶é™·å…¥äº†æ— æ„ä¹‰çš„è‡ªæˆ‘ä¿®æ­£æ­»å¾ªç¯ï¼Œæœ€ç»ˆçƒ§å…‰äº†ä½ çš„ Tokenï¼Œå´åªåå‡ºä¸€å †é€»è¾‘æ··ä¹±çš„åºŸè¯ã€‚</p>
<p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå•ä½“ Agent çš„ä¸Šä¸‹æ–‡çª—å£ï¼ˆContext Windowï¼‰å’Œæ¨ç†é“¾æ¡æ˜¯æœ‰æé™çš„ã€‚å½“ä»»åŠ¡å¤æ‚åº¦è¶…è¿‡æŸä¸ªé˜ˆå€¼ï¼Œæ¨¡å‹å°±ä¼šå¼€å§‹â€œèƒ¡è¨€ä¹±è¯­â€ã€‚è§£å†³åŠæ³•ä¸æ˜¯æ¢ä¸€ä¸ªæ›´å¼ºçš„æ¨¡å‹ï¼Œè€Œæ˜¯æ”¹å˜æ¶æ„â€”â€”ä»å•å…µä½œæˆ˜è½¬å‘å¤š Agent åä½œï¼ˆMulti-Agent Systemsï¼‰ã€‚</p>
<p>æœ¬æ–‡å°†åŸºäº <strong>LangGraph</strong>ï¼ˆLangChain å®˜æ–¹æ¨å‡ºçš„æœ‰çŠ¶æ€å¤š Agent ç¼–æ’åº“ï¼‰åˆ†äº«å¦‚ä½•æ„å»ºä¸€ä¸ªå¯è½åœ°çš„å¤š Agent åº”ç”¨ã€‚</p>
<h3 data-id="heading-0">1. ä¸ºä»€ä¹ˆæ˜¯ LangGraph è€Œä¸æ˜¯ä¼ ç»Ÿçš„ AgentExecutorï¼Ÿ</h3>
<p>ä¼ ç»Ÿçš„ LangChain Agent æ˜¯ä¸€ä¸ªé»‘ç›’ï¼Œä½ å¾ˆéš¾æ§åˆ¶å®ƒçš„å†…éƒ¨å¾ªç¯é€»è¾‘ã€‚è€Œåœ¨å¤š Agent åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯ä¸€ä¸ª<strong>çŠ¶æ€æœº</strong>ã€‚</p>
<ul>
<li><strong>Stateï¼ˆçŠ¶æ€ï¼‰</strong>ï¼šæ‰€æœ‰ Agent å…±äº«çš„â€œè´¦æœ¬â€ï¼Œè®°å½•å½“å‰ä»»åŠ¡è¿›åº¦ã€‚</li>
<li><strong>Nodesï¼ˆèŠ‚ç‚¹ï¼‰</strong>ï¼šæ¯ä¸ª Agent æˆ–å·¥å…·å°±æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè´Ÿè´£å¤„ç†çŠ¶æ€å¹¶è¿”å›æ›´æ–°ã€‚</li>
<li><strong>Edgesï¼ˆè¾¹ï¼‰</strong>ï¼šå®šä¹‰äº†ä»ä¸€ä¸ªèŠ‚ç‚¹åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹çš„æµè½¬é€»è¾‘ï¼ˆæ¡ä»¶è·¯ç”±ï¼‰ã€‚</li>
</ul>
<p>è¿™ç§æ¶æ„å…è®¸æˆ‘ä»¬åƒè®¾è®¡å·¥ä¸šæµæ°´çº¿ä¸€æ ·ï¼Œç²¾ç¡®æ§åˆ¶æ¯ä¸ª Agent çš„èŒè´£è¾¹ç•Œã€‚</p>
<hr/>
<h3 data-id="heading-1">2. æ ¸å¿ƒæ¶æ„ï¼šSupervisorï¼ˆå¯¼å¸ˆï¼‰æ¨¡å¼</h3>
<p>åœ¨å¤š Agent åä½œä¸­ï¼Œæœ€ç¨³å®šçš„æ¨¡å¼æ˜¯ <strong>Supervisor æ¨¡å¼</strong>ã€‚å®ƒç”±ä¸€ä¸ªä¸»æ§ Agent è´Ÿè´£åˆ†å‘ä»»åŠ¡ï¼Œå¤šä¸ªä¸“å®¶ Agent è´Ÿè´£æ‰§è¡Œï¼Œæœ€åç”±ä¸»æ§æ±‡æ€»ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    Start((å¼€å§‹)) --&gt; Supervisor{ä¸»æ§ Agent}
    Supervisor --&gt;|æŒ‡æ´¾ä»»åŠ¡| Researcher[è°ƒç ”ä¸“å®¶]
    Supervisor --&gt;|æŒ‡æ´¾ä»»åŠ¡| Coder[ä»£ç ä¸“å®¶]
    Researcher --&gt;|è¿”å›ç»“æœ| Supervisor
    Coder --&gt;|è¿”å›ç»“æœ| Supervisor
    Supervisor --&gt;|ä»»åŠ¡å®Œæˆ| End((ç»“æŸ))
</code></pre>
<hr/>
<h3 data-id="heading-2">3. å®æˆ˜æ¼”ç»ƒï¼šæ„å»ºä¸€ä¸ªæŠ€æœ¯æ–‡æ¡£ç”Ÿæˆç³»ç»Ÿ</h3>
<p>æˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªåŒ…å«â€œæœç´¢ä¸“å®¶â€å’Œâ€œä»£ç ä¸“å®¶â€çš„åä½œç³»ç»Ÿã€‚</p>
<p><strong>ç¯å¢ƒè¦æ±‚ï¼š</strong></p>
<ul>
<li><code>langchain &gt;= 0.2.0</code></li>
<li><code>langgraph &gt;= 0.1.0</code></li>
<li><code>langchain-openai</code></li>
</ul>
<h4 data-id="heading-3">ç¬¬ä¸€æ­¥ï¼šå®šä¹‰å…±äº«çŠ¶æ€</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> Annotated, <span class="hljs-type">List</span>, TypedDict
<span class="hljs-keyword">import</span> operator

<span class="hljs-comment"># å®šä¹‰ Agent ä¹‹é—´å…±äº«çš„çŠ¶æ€</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AgentState</span>(<span class="hljs-title class_ inherited__">TypedDict</span>):
    <span class="hljs-comment"># æ‰€æœ‰çš„æ¶ˆæ¯éƒ½ä¼šè¢«è¿½åŠ åˆ°è¿™ä¸ªåˆ—è¡¨é‡Œ</span>
    messages: Annotated[<span class="hljs-type">List</span>, operator.add]
    <span class="hljs-comment"># ä¸‹ä¸€ä¸ªè¦æ‰§è¡Œçš„èŠ‚ç‚¹</span>
    <span class="hljs-built_in">next</span>: <span class="hljs-built_in">str</span>
</code></pre>
<h4 data-id="heading-4">ç¬¬äºŒæ­¥ï¼šåˆ›å»ºä¸“å®¶ Agent</h4>
<p>ä¸è¦ç›´æ¥ç»™ Agent å¡å…¥æ‰€æœ‰å·¥å…·ã€‚<strong>èŒè´£åˆ†ç¦»</strong>æ˜¯é™ä½å¹»è§‰çš„å…³é”®ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> ChatOpenAI
<span class="hljs-keyword">from</span> langchain_core.messages <span class="hljs-keyword">import</span> HumanMessage
<span class="hljs-keyword">from</span> langgraph.prebuilt <span class="hljs-keyword">import</span> create_react_agent

llm = ChatOpenAI(model=<span class="hljs-string">"gpt-4o"</span>, temperature=<span class="hljs-number">0</span>)

<span class="hljs-comment"># 1. è°ƒç ”ä¸“å®¶ï¼šä»…èµ‹äºˆæœç´¢å·¥å…·</span>
research_agent = create_react_agent(
    llm, tools=[tavily_tool], state_modifier=<span class="hljs-string">"ä½ æ˜¯ä¸€åèµ„æ·±æŠ€æœ¯è°ƒç ”å‘˜ï¼Œè´Ÿè´£æœé›†æœ€æ–°çš„æŠ€æœ¯æ–‡æ¡£å’Œ API ç”¨æ³•ã€‚"</span>
)

<span class="hljs-comment"># 2. ä»£ç ä¸“å®¶ï¼šä»…è´Ÿè´£ç¼–å†™å’Œè¿è¡Œ Python ä»£ç </span>
code_agent = create_react_agent(
    llm, tools=[python_repl_tool], state_modifier=<span class="hljs-string">"ä½ æ˜¯ä¸€åé«˜çº§å·¥ç¨‹å¸ˆï¼Œè´Ÿè´£æ ¹æ®è°ƒç ”ç»“æœç¼–å†™é«˜è´¨é‡çš„ Python ä»£ç ç¤ºä¾‹ã€‚"</span>
)
</code></pre>
<h4 data-id="heading-5">ç¬¬ä¸‰æ­¥ï¼šæ„å»ºä¸»æ§è·¯ç”±ï¼ˆSupervisorï¼‰</h4>
<p>è¿™æ˜¯ç³»ç»Ÿçš„â€œå¤§è„‘â€ï¼Œå®ƒä¸å¹²æ´»ï¼Œåªè´Ÿè´£çœ‹è¿›åº¦å¹¶å†³å®šè°æ˜¯ä¸‹ä¸€ä¸ªæ‰§è¡Œè€…ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.prompts <span class="hljs-keyword">import</span> ChatPromptTemplate
<span class="hljs-keyword">from</span> langchain_core.output_parsers.openai_functions <span class="hljs-keyword">import</span> JsonOutputFunctionsParser

members = [<span class="hljs-string">"Researcher"</span>, <span class="hljs-string">"Coder"</span>]
system_prompt = (
    <span class="hljs-string">"ä½ æ˜¯ä¸€åå›¢é˜Ÿè´Ÿè´£äººï¼Œè´Ÿè´£ç®¡ç†ä»¥ä¸‹äººå‘˜ï¼š{members}ã€‚"</span>
    <span class="hljs-string">"æ ¹æ®ç”¨æˆ·çš„é—®é¢˜ï¼Œå†³å®šè°åº”è¯¥æ‰§è¡Œä¸‹ä¸€æ­¥ã€‚æ¯ä¸ªäººå‘˜æ‰§è¡Œå®Œåéƒ½ä¼šå‘ä½ æ±‡æŠ¥ã€‚"</span>
    <span class="hljs-string">"å½“ä»»åŠ¡å®Œå…¨ç»“æŸæ—¶ï¼Œå›å¤ FINISHã€‚"</span>
)

options = [<span class="hljs-string">"FINISH"</span>] + members
function_def = {
    <span class="hljs-string">"name"</span>: <span class="hljs-string">"route"</span>,
    <span class="hljs-string">"description"</span>: <span class="hljs-string">"é€‰æ‹©ä¸‹ä¸€ä¸ªæ‰§è¡Œè€…"</span>,
    <span class="hljs-string">"parameters"</span>: {
        <span class="hljs-string">"type"</span>: <span class="hljs-string">"object"</span>,
        <span class="hljs-string">"properties"</span>: {
            <span class="hljs-string">"next"</span>: {<span class="hljs-string">"anyOf"</span>: [{<span class="hljs-string">"enum"</span>: options}]}
        },
        <span class="hljs-string">"required"</span>: [<span class="hljs-string">"next"</span>],
    },
}

prompt = ChatPromptTemplate.from_messages([
    (<span class="hljs-string">"system"</span>, system_prompt),
    (<span class="hljs-string">"placeholder"</span>, <span class="hljs-string">"{messages}"</span>),
    (<span class="hljs-string">"system"</span>, <span class="hljs-string">"æ ¹æ®ä»¥ä¸Šå¯¹è¯ï¼Œè°åº”è¯¥æ˜¯ä¸‹ä¸€ä¸ªæ‰§è¡Œè€…ï¼Ÿæˆ–è€…æ˜¯ç»“æŸä»»åŠ¡ï¼Ÿ"</span>)
]).partial(members=<span class="hljs-string">", "</span>.join(members))

<span class="hljs-comment"># ä½¿ç”¨ OpenAI çš„ Function Calling æ¥ä¿è¯è¾“å‡ºçš„ç¨³å®šæ€§</span>
supervisor_chain = (
    prompt 
    | llm.bind_functions(functions=[function_def], function_call=<span class="hljs-string">"route"</span>) 
    | JsonOutputFunctionsParser()
)
</code></pre>
<h4 data-id="heading-6">ç¬¬å››æ­¥ï¼šç¼–æ’å·¥ä½œæµ</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langgraph.graph <span class="hljs-keyword">import</span> StateGraph, END

workflow = StateGraph(AgentState)

<span class="hljs-comment"># æ·»åŠ èŠ‚ç‚¹</span>
workflow.add_node(<span class="hljs-string">"Researcher"</span>, <span class="hljs-keyword">lambda</span> state: research_agent.invoke(state))
workflow.add_node(<span class="hljs-string">"Coder"</span>, <span class="hljs-keyword">lambda</span> state: code_agent.invoke(state))
workflow.add_node(<span class="hljs-string">"supervisor"</span>, <span class="hljs-keyword">lambda</span> state: supervisor_chain.invoke(state))

<span class="hljs-comment"># æ‰€æœ‰çš„ä¸“å®¶èŠ‚ç‚¹æ‰§è¡Œå®Œåï¼Œéƒ½è¦å›åˆ° supervisor</span>
<span class="hljs-keyword">for</span> member <span class="hljs-keyword">in</span> members:
    workflow.add_edge(member, <span class="hljs-string">"supervisor"</span>)

<span class="hljs-comment"># æ ¹æ® supervisor çš„åˆ¤æ–­è¿›è¡Œæ¡ä»¶è·¯ç”±</span>
conditional_map = {k: k <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> members}
conditional_map[<span class="hljs-string">"FINISH"</span>] = END
workflow.add_conditional_edges(<span class="hljs-string">"supervisor"</span>, <span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">"next"</span>], conditional_map)

workflow.set_entry_point(<span class="hljs-string">"supervisor"</span>)
graph = workflow.<span class="hljs-built_in">compile</span>()
</code></pre>
<hr/>
<h3 data-id="heading-7">4. é¿å‘æŒ‡å—ï¼šè€å¸æœºçš„ç§æˆ¿å»ºè®®</h3>
<h4 data-id="heading-8">1. è­¦æƒ•â€œå¹»è§‰ä¼ é€’â€</h4>
<p>Agent A å¯èƒ½ä¼šç”Ÿæˆä¸€ä¸ªé”™è¯¯çš„ API è°ƒç”¨æ–¹æ³•ï¼ŒAgent B æ‹¿åˆ°åä¼šåŸºäºè¿™ä¸ªé”™è¯¯ç»§ç»­ç¼–å†™ä»£ç ã€‚</p>
<ul>
<li><strong>å¯¹ç­–</strong>ï¼šåœ¨ <code>Researcher</code> å’Œ <code>Coder</code> ä¹‹é—´å¢åŠ ä¸€ä¸ª <code>Validator</code>ï¼ˆæ ¡éªŒèŠ‚ç‚¹ï¼‰ã€‚ä¸è¦è®© Agent è‡ªå·±æ£€æŸ¥è‡ªå·±ï¼Œè®©å¦ä¸€ä¸ª Prompt ä¸“é—¨è´Ÿè´£â€œæ‰¾èŒ¬â€ã€‚</li>
</ul>
<h4 data-id="heading-9">2. è§£å†³æ­»å¾ªç¯ä¸ Token çˆ†ç‚¸</h4>
<p>å½“ Agent æ— æ³•å®Œæˆä»»åŠ¡æ—¶ï¼Œå®ƒå¯èƒ½ä¼šåœ¨ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´åå¤æ¨ªè·³ã€‚</p>
<ul>
<li><strong>å¯¹ç­–</strong>ï¼šåœ¨ <code>compile()</code> æ—¶è®¾ç½® <code>recursion_limit</code>ã€‚
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># é™åˆ¶æœ€å¤§æ­¥æ•°ä¸º 20 æ­¥ï¼Œè¶…è¿‡åˆ™å¼ºåˆ¶åœæ­¢</span>
graph.invoke({<span class="hljs-string">"messages"</span>: [HumanMessage(content=<span class="hljs-string">"..."</span>) ]}, {<span class="hljs-string">"recursion_limit"</span>: <span class="hljs-number">20</span>})
</code></pre>
</li>
</ul>
<h4 data-id="heading-10">3. çŠ¶æ€æ¸…ç†</h4>
<p>éšç€å¯¹è¯å¢åŠ ï¼Œ<code>messages</code> åˆ—è¡¨ä¼šè¶Šæ¥è¶Šé•¿ï¼Œå¯¼è‡´ Context Window æº¢å‡ºã€‚</p>
<ul>
<li><strong>å¯¹ç­–</strong>ï¼šåœ¨ Supervisor èŠ‚ç‚¹ä¸­åŠ å…¥â€œæ‘˜è¦é€»è¾‘â€ã€‚æ¯å½“æ¶ˆæ¯è¶…è¿‡ 10 æ¡ï¼Œå°±è§¦å‘ä¸€æ¬¡æ€»ç»“ï¼Œå°†å†å²ä¿¡æ¯å‹ç¼©ï¼Œåªä¿ç•™å…³é”®ç»“è®ºã€‚</li>
</ul>
<h4 data-id="heading-11">4. äººç±»å¹²é¢„ï¼ˆHuman-in-the-loopï¼‰</h4>
<p>æœ‰äº›å…³é”®å†³ç­–ï¼ˆæ¯”å¦‚åˆ é™¤æ•°æ®åº“ã€å‘é€é‚®ä»¶ï¼‰ä¸èƒ½å…¨è‡ªåŠ¨åŒ–ã€‚</p>
<ul>
<li><strong>å¯¹ç­–</strong>ï¼šåˆ©ç”¨ LangGraph çš„ <code>interrupt_before</code> åŠŸèƒ½ã€‚åœ¨æ‰§è¡Œ <code>Coder</code> èŠ‚ç‚¹å‰æš‚åœï¼Œç­‰å¾…äººå·¥åœ¨æ§åˆ¶å°è¾“å…¥ <code>Approve</code> åå†ç»§ç»­ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-12">5. æ·±åº¦æ€»ç»“ï¼šå•ä½“ vs å¤š Agent</h3>






























<table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">å•ä½“ Agent (Single Agent)</th><th align="left">å¤š Agent åä½œ (Multi-Agent)</th></tr></thead><tbody><tr><td align="left"><strong>å¤æ‚åº¦ä¸Šé™</strong></td><td align="left">ä½ï¼Œå®¹æ˜“åœ¨é•¿é“¾æ¡ä»»åŠ¡ä¸­è¿·å¤±</td><td align="left">é«˜ï¼Œé€šè¿‡æ¨¡å—åŒ–æ‹†è§£å¤æ‚é€»è¾‘</td></tr><tr><td align="left"><strong>è°ƒè¯•éš¾åº¦</strong></td><td align="left">æéš¾ï¼ŒPrompt ç‰µä¸€å‘è€ŒåŠ¨å…¨èº«</td><td align="left">è¾ƒæ˜“ï¼Œå¯é’ˆå¯¹ç‰¹å®šèŠ‚ç‚¹ä¼˜åŒ– Prompt</td></tr><tr><td align="left"><strong>Token æ•ˆç‡</strong></td><td align="left">æ—©æœŸçœï¼ŒåæœŸå› é‡å¤å°è¯•è€Œæµªè´¹</td><td align="left">åˆå§‹å¼€é”€å¤§ï¼Œä½†ä»»åŠ¡æˆåŠŸç‡æ›´é«˜</td></tr><tr><td align="left"><strong>é€‚ç”¨åœºæ™¯</strong></td><td align="left">ç®€å•çš„é—®ç­”ã€å•ä¸€å·¥å…·è°ƒç”¨</td><td align="left">è½¯ä»¶å¼€å‘ã€æ·±åº¦å¸‚åœºè°ƒç ”ã€å¤æ‚æµè½¬ä¸šåŠ¡</td></tr></tbody></table>
<p><strong>æœ€åçš„ä¸€ç‚¹ç»éªŒï¼š</strong> ä¸è¦ä¸ºäº†ç”¨å¤š Agent è€Œç”¨å¤š Agentã€‚å¦‚æœä¸€ä¸ªä»»åŠ¡é€šè¿‡ä¼˜åŒ– System Prompt å°±èƒ½è®©å•ä½“ Agent æå®šï¼Œé‚£å°±ä¸è¦å¼•å…¥ LangGraphã€‚å¤š Agent ç³»ç»Ÿçš„æœ¬è´¨æ˜¯<strong>ç”¨æ¶æ„çš„ç¡®å®šæ€§æ¥å¼¥è¡¥æ¨¡å‹æ¨ç†çš„ä¸ç¡®å®šæ€§</strong>ã€‚å½“ä½ å‘ç°ä½ çš„ Prompt å·²ç»é•¿åˆ°è¿ä½ è‡ªå·±éƒ½è¯»ä¸ä¸‹å»æ—¶ï¼Œå°±æ˜¯è¯¥æ‹†åˆ† Agent çš„æ—¶å€™äº†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åœ¨ React é‡Œä¼˜é›…åœ° â€œéšè— iframe æ»šåŠ¨æ¡â€]]></title>    <link>https://juejin.cn/post/7587961565477224502</link>    <guid>https://juejin.cn/post/7587961565477224502</guid>    <pubDate>2025-12-26T09:27:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587961565477224502" data-draft-id="7587998744294146054" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åœ¨ React é‡Œä¼˜é›…åœ° â€œéšè— iframe æ»šåŠ¨æ¡â€"/> <meta itemprop="keywords" content="å‰ç«¯,React.js,CSS"/> <meta itemprop="datePublished" content="2025-12-26T09:27:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¨å¤œå¯»æ™´å¤©"/> <meta itemprop="url" content="https://juejin.cn/user/1943592288391496"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åœ¨ React é‡Œä¼˜é›…åœ° â€œéšè— iframe æ»šåŠ¨æ¡â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1943592288391496/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¨å¤œå¯»æ™´å¤©
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T09:27:30.000Z" title="Fri Dec 26 2025 09:27:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å‰ç«¯æœ‰ä¸€ä¸ªç»å…¸é—®é¢˜ï¼š</p>
<blockquote>
<p>ä½ åœ¨å®¿ä¸»é¡µé¢æ€ä¹ˆå†™ CSSï¼Œéƒ½<strong>ç®¡ä¸åˆ° iframe å†…éƒ¨</strong>çš„æ»šåŠ¨æ¡ã€‚</p>
</blockquote>
<p>æ‰€ä»¥æ­£ç¡®çš„å‰ç«¯æ–¹æ¡ˆä¸æ˜¯ â€œç»™å¤–å±‚å®¹å™¨åŠ  overflowâ€ï¼Œè€Œæ˜¯ï¼š<strong>å°½é‡åœ¨ iframe è‡ªå·±å±‚é¢å…œåº• + åŒæºæ—¶å‘ iframe å†…æ³¨å…¥ CSS</strong>ã€‚</p>
<p>æœ¬æ–‡åªèšç„¦å‰ç«¯å®ç°ï¼Œä¸å±•å¼€å‰åç«¯ä¼ å‚é“¾è·¯ã€‚</p>
<hr/>
<h2 data-id="heading-0">1. ä¸ºä»€ä¹ˆä½ æ˜æ˜è®¾ç½®äº†ï¼Œæ»šåŠ¨æ¡è¿˜æ˜¯åœ¨ï¼Ÿ</h2>
<p>å› ä¸ºæ»šåŠ¨æ¡æ¥è‡ª <strong>iframe å†…éƒ¨ document</strong>ï¼š</p>
<ul>
<li>å¤–å±‚ <code>div</code> çš„ <code>overflow-hidden</code> åªèƒ½è£å‰ª â€œiframe è¿™ä¸ªç›’å­â€ æ˜¯å¦æº¢å‡º</li>
<li>iframe é‡Œé¢çš„é¡µé¢æ˜¯å¦å‡ºç°æ»šåŠ¨æ¡ï¼Œå–å†³äº iframe å†…éƒ¨çš„ <code>html/body</code> æˆ–æŸä¸ªå®¹å™¨çš„ <code>overflow</code></li>
<li>å®¿ä¸»é¡µé¢çš„ CSS ä¸ä¼šè·¨ document ç”Ÿæ•ˆï¼ˆiframe å¤©ç”Ÿéš”ç¦»ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-1">2. æˆ‘ä»¬æœ€ç»ˆç”¨äº† â€œä¸¤å±‚æ–¹æ¡ˆâ€ï¼Œè§£å†³ç°å®ä¸–ç•Œçš„ä¸ç¡®å®šæ€§</h2>
<p>å®ç°é›†ä¸­åœ¨ <code>src/components/Search/ViewExtensionIframe.tsx:1-88</code>ã€‚</p>
<h3 data-id="heading-2">2.1 ç¬¬ä¸€å±‚ï¼š<code>scrolling="no"</code> ä½œä¸ºä½æˆæœ¬å…œåº•</h3>
<pre><code class="hljs language-tsx" lang="tsx">&lt;iframe scrolling={hideScrollbar ? <span class="hljs-string">"no"</span> : <span class="hljs-string">"auto"</span>} /&gt;
</code></pre>
<p>å®ƒä¸æ˜¯ç°ä»£æ ‡å‡†ï¼Œä½†åœ¨æŸäº› WebView/åµŒå…¥ç¯å¢ƒé‡Œä»èƒ½å‡å°‘æ»šåŠ¨æ¡å‡ºç°çš„æ¦‚ç‡ã€‚</p>
<p>å®ƒçš„ä»·å€¼åœ¨äºï¼š<strong>ä¸ä¾èµ–åŒæº</strong>ï¼Œå“ªæ€•ä½ è¿›ä¸å» iframeï¼Œä¹Ÿèƒ½ â€œç¢°ä¸€ç¢°è¿æ°”â€ã€‚</p>
<h3 data-id="heading-3">2.2 ç¬¬äºŒå±‚ï¼ˆä¸»åŠ›ï¼‰ï¼šåŒæºæ—¶æ³¨å…¥ä¸€æ®µéšè—æ»šåŠ¨æ¡çš„ CSS</h3>
<p>æ ¸å¿ƒæ˜¯è¿™æ®µé€»è¾‘ï¼ˆåŒæ–‡ä»¶ <code>applyHideScrollbarToIframe</code>ï¼‰ï¼š</p>
<ul>
<li><code>src/components/Search/ViewExtensionIframe.tsx:5-39</code></li>
</ul>
<p>åšæ³•å¾ˆç›´æ¥ï¼š</p>
<ol>
<li>æ‹¿åˆ° <code>iframe.contentDocument</code></li>
<li>å¾€é‡Œé¢å¡ä¸€ä¸ªå¸¦å›ºå®š <code>id</code> çš„ <code>&lt;style&gt;</code></li>
<li>å¼€å…³å…³é—­æ—¶æŠŠè¿™ä¸ª <code>&lt;style&gt;</code> åˆ æ‰</li>
</ol>
<p>æ³¨å…¥çš„ CSS åŒæ—¶è¦†ç›–ä¸»æµå¼•æ“ï¼š</p>
<pre><code class="hljs language-css" lang="css">* {
  <span class="hljs-attribute">scrollbar-width</span>: none;      <span class="hljs-comment">/* Firefox */</span>
  -ms-<span class="hljs-attribute">overflow</span>-style: none;   <span class="hljs-comment">/* è€ IE/Edge é£æ ¼ */</span>
}
*::-webkit-scrollbar {        <span class="hljs-comment">/* Chrome/Safari */</span>
  <span class="hljs-attribute">width</span>: <span class="hljs-number">0px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">0px</span>;
}
</code></pre>
<p>ä¸ºä»€ä¹ˆç”¨ <code>*</code>ï¼Ÿ</p>
<ul>
<li>æ‰©å±•é¡µé¢çš„æ»šåŠ¨å®¹å™¨ä¸ä¸€å®šæ˜¯ <code>body</code>ï¼Œå¯èƒ½æ˜¯ä»»æ„ <code>div overflow-auto</code></li>
<li>ç”¨ <code>*</code> èƒ½æœ€å¤§æ¦‚ç‡â€œå…¨åœºéšè—â€ï¼Œæ›´é€šç”¨</li>
</ul>
<p>ä¸ºä»€ä¹ˆè¦å›ºå®š <code>id</code>ï¼Ÿ</p>
<ul>
<li>é˜²æ­¢é‡å¤æ³¨å…¥ï¼ˆå¤šæ¬¡ onLoad / çŠ¶æ€å˜åŒ–ï¼‰</li>
<li>å…³é—­æ—¶èƒ½ç²¾ç¡®ç§»é™¤ï¼Œä¿è¯å¯é€†</li>
</ul>
<hr/>
<h2 data-id="heading-4">3. ä¸ºä»€ä¹ˆè¦ â€œonLoad + useEffectâ€ åŒè§¦å‘ï¼Ÿ</h2>
<p>è¿™æ˜¯æœ€å®¹æ˜“æ¼ã€ä¹Ÿæœ€å½±å“ä½“éªŒçš„ä¸€ç‚¹ã€‚</p>
<ul>
<li><code>useEffect</code>ï¼šå“åº” <code>hideScrollbar</code> å˜åŒ–ï¼ˆå¼€å…³åˆ‡æ¢æ—¶ç«‹åˆ»ç”Ÿæ•ˆï¼‰</li>
<li><code>onLoad</code>ï¼šä¿è¯â€œé¦–æ¬¡åŠ è½½å®Œæˆåä¸€å®šæ³¨å…¥æˆåŠŸâ€</li>
</ul>
<p>åŸå› ï¼šiframe çš„åŠ è½½æ—¶åºä¸å¯æ§ã€‚ä½ åœ¨ React æ¸²æŸ“å®Œæ—¶ï¼Œiframe å¯èƒ½è¿˜æ²¡ readyï¼Œ<code>contentDocument</code> ä¸ºç©ºï¼›ç­‰åˆ° onLoad æ‰èƒ½ 100% ç¡®è®¤ document å­˜åœ¨ã€‚</p>
<p>å¯¹åº”ä»£ç ï¼š</p>
<ul>
<li><code>src/components/Search/ViewExtensionIframe.tsx:52-55</code></li>
<li><code>src/components/Search/ViewExtensionIframe.tsx:78-84</code></li>
</ul>
<hr/>
<h2 data-id="heading-5">4. è¿™ä¸ªæ–¹æ¡ˆçš„è¾¹ç•Œä¸å‘ï¼ˆæå‰å†™æ¸…æ¥šï¼Œåé¢å°‘æ‰å¤´å‘ï¼‰</h2>
<h3 data-id="heading-6">4.1 â€œéšè—æ»šåŠ¨æ¡â€ ä¸ç­‰äº â€œä¸èƒ½æ»šâ€</h3>
<p>æˆ‘ä»¬åªéšè— scrollbar çš„è§†è§‰è¡¨ç°ï¼Œæ»šåŠ¨è¡Œä¸ºä»å­˜åœ¨ï¼ˆæ»šè½®/è§¦æ‘¸æ¿/é”®ç›˜éƒ½èƒ½æ»šï¼‰ã€‚<br/>
è¿™åœ¨æ²‰æµ¸å¼é¡µé¢å¾ˆèˆ’æœï¼Œä½†åœ¨é•¿é¡µé¢é‡Œä¹Ÿå¯èƒ½è®©ç”¨æˆ·ä¸çŸ¥é“ â€œè¿˜èƒ½æ»šâ€ã€‚</p>
<h3 data-id="heading-7">4.2 è·¨åŸŸ iframeï¼šæ³¨å…¥ä¼šå¤±è´¥ï¼Œä½†ä¸ä¼šç‚¸</h3>
<p>å¦‚æœ iframe åŠ è½½è·¨åŸŸé¡µé¢ï¼Œè®¿é—® <code>contentDocument</code> ä¼šè§¦å‘åŒæºé™åˆ¶ã€‚å½“å‰å®ç°ç”¨ <code>try/catch</code> é™é»˜åæ‰å¼‚å¸¸ï¼Œç»“æœæ˜¯ï¼š</p>
<ul>
<li>CSS æ³¨å…¥å¤±è´¥</li>
<li>åªå‰© <code>scrolling="no"</code> å…œåº•ï¼Œæ•ˆæœä¸ä¿è¯</li>
</ul>
<p>è¿™ä¸æ˜¯ bugï¼Œæ˜¯æµè§ˆå™¨å®‰å…¨æ¨¡å‹å†³å®šçš„ã€‚</p>
<h3 data-id="heading-8">4.3 å…¨å±€ <code>*</code> çš„å‰¯ä½œç”¨</h3>
<p>å®ƒä¼šæŠŠ iframe å†…æ‰€æœ‰æ»šåŠ¨æ¡éƒ½å¹²æ‰ï¼ŒåŒ…æ‹¬æŸäº›ç»„ä»¶å†…éƒ¨æ»šåŠ¨åŒºåŸŸã€ä»£ç å—æ»šåŠ¨ç­‰ã€‚<br/>
ç›®å‰æˆ‘ä»¬é€‰æ‹©â€œé€šç”¨æ€§ä¼˜å…ˆâ€ï¼Œä½†å¦‚æœæœªæ¥æŸäº›æ‰©å±•éœ€è¦ä¿ç•™å±€éƒ¨æ»šåŠ¨æ¡ï¼Œå°±è¦æ”¹ä¸ºæ›´ç²¾ç¡®çš„é€‰æ‹©å™¨ç­–ç•¥ã€‚</p>
<hr/>
<h2 data-id="heading-9">5. ä¸€å¥è¯æ€»ç»“</h2>
<p>åœ¨å‰ç«¯æƒ³ç¨³å®šæ§åˆ¶ iframe æ»šåŠ¨æ¡ï¼Œæœ€é è°±çš„æ€è·¯æ˜¯ï¼š</p>
<ul>
<li><strong>å…ˆç”¨ iframe è‡ªèº«å±æ€§åšå…œåº•</strong></li>
<li><strong>å†åœ¨åŒæºæ¡ä»¶ä¸‹å¯¹ iframe å†…éƒ¨ document æ³¨å…¥ CSS</strong></li>
<li><strong>ç”¨å›ºå®š style id ä¿è¯å¹‚ç­‰ä¸å¯é€†</strong></li>
<li><strong>ç”¨ onLoad + effect è§£å†³æ—¶åºé—®é¢˜</strong></li>
</ul>
<p>è¿™å°±æ˜¯ <code>hideScrollbar</code> åœ¨å‰ç«¯çœŸæ­£è§£å†³çš„é—®é¢˜ï¼šä¸æ˜¯å†™æ²¡å†™ CSSï¼Œè€Œæ˜¯æœ‰æ²¡æœ‰æŠŠ CSS å†™åˆ°â€œå¯¹çš„ä¸–ç•Œé‡Œâ€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[VueCropperåŠ è½½OBSå›¾ç‰‡è·¨åŸŸé—®é¢˜]]></title>    <link>https://juejin.cn/post/7587743345197465652</link>    <guid>https://juejin.cn/post/7587743345197465652</guid>    <pubDate>2025-12-26T09:30:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587743345197465652" data-draft-id="7587743345197449268" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="VueCropperåŠ è½½OBSå›¾ç‰‡è·¨åŸŸé—®é¢˜"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-26T09:30:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æ³¥ç§è·èŠ±"/> <meta itemprop="url" content="https://juejin.cn/user/4212984289442030"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            VueCropperåŠ è½½OBSå›¾ç‰‡è·¨åŸŸé—®é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4212984289442030/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æ³¥ç§è·èŠ±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T09:30:22.000Z" title="Fri Dec 26 2025 09:30:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;color:rgba(46,36,36,.87);overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{margin-bottom:5px;font-size:30px;font-weight:500}.markdown-body h1:before{content:"#";margin-right:10px;color:#1976d2}.markdown-body h2{font-size:28px;font-weight:400;border-left:5px solid #454545;margin-top:20px;padding-left:10px;transition:all .3s ease-in-out}.markdown-body h2:hover{border-color:#1976d2}.markdown-body h3{font-size:24px;font-weight:400;margin-top:15px;padding-bottom:0}.markdown-body h4{font-size:20px;font-weight:500}.markdown-body h5{font-size:16px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h2:first-letter,.markdown-body h3:first-letter,.markdown-body p:first-letter{text-transform:capitalize}.markdown-body em{text-emphasis:dot;text-emphasis-position:under}.markdown-body img{display:block;margin:0 auto!important;max-width:100%;border-radius:2px;box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12)!important}.markdown-body hr{position:relative;width:98%;height:1px;border:none;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,#ddd,#999,#ddd);overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background:#fff;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center}.markdown-body code{font-weight:900;word-break:break-word;border-radius:2px;overflow-x:auto;font-size:.87em;padding:.065em .4em;background-color:#fbe5e1;color:#c0341d}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:0 4px}.markdown-body pre&gt;code{font-weight:400;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{margin:0 4px;text-decoration:none;color:#027fff;transition:all .3s ease-in-out;padding-bottom:4px;border-bottom:2px solid transparent}.markdown-body a:after{content:"";display:inline-block;width:18px;height:18px;margin-left:4px;vertical-align:middle;background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2U9IiMwMjdGRkYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+PHBhdGggZD0iTTkuODE1IDYuNDQ4bDEuOTM2LTEuOTM2YzEuMzM3LTEuMzM2IDMuNTgtMS4yNTkgNS4wMTMuMTczIDEuNDMyIDEuNDMyIDEuNTEgMy42NzYuMTczIDUuMDEzbC0xLjQ1MiAxLjQ1Mi0uOTY4Ljk2OGMtMS4zMzcgMS4zMzYtMy41ODEgMS4yNTktNS4wMTMtLjE3MyIvPjxwYXRoIGQ9Ik0xMS4yNjcgMTUuMzY3bC0xLjkzNiAxLjkzNmMtMS4zMzYgMS4zMzctMy41OCAxLjI2LTUuMDEyLS4xNzMtMS40MzItMS40MzItMS41MS0zLjY3Ni0uMTczLTUuMDEybDEuNDUyLTEuNDUyLjk2OC0uOTY4YzEuMzM2LTEuMzM3IDMuNTgtMS4yNiA1LjAxMi4xNzMiLz48L2c+PC9zdmc+);background-size:cover;background-repeat:no-repeat}.markdown-body a:hover{border-color:#027fff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body a.footnote-backref:after,.markdown-body a.footnote-ref:after,.markdown-body sup a:after{display:none!important}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border:2px solid #c6c6c6}.markdown-body table img{box-shadow:none!important}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body del{color:rgba(0,0,0,.6)}.markdown-body blockquote{position:relative;color:#666;padding:5px 23px 1px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:hsla(0,0%,78.4%,.12);transition:all .2s ease-in-out}.markdown-body blockquote:hover{border-color:#1976d2}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;font-size:24px;font-weight:800;line-height:24px;color:#cbcbcb;opacity:.6}.markdown-body blockquote:before{content:"â€œ";top:4px;left:6px}.markdown-body blockquote:after{content:"â€";right:8px;bottom:-8px}.markdown-body blockquote&gt;p,.markdown-body blockquote blockquote{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body details{outline:none;border:none;border-left:4px solid #1976d2;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary:hover::-webkit-details-marker{color:#1976d2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">é—®é¢˜åœºæ™¯</h2>
<p>åœ¨é›†æˆ <code>VueCropper</code> å›¾ç‰‡è£å‰ªç»„ä»¶æ—¶ï¼Œé‡åˆ°ä¸€ä¸ªå…¸å‹çš„è·¨åŸŸé—®é¢˜ï¼šåŠ è½½å­˜å‚¨åœ¨ OBS ä¸Šçš„å›¾ç‰‡æ—¶ï¼Œæµè§ˆå™¨ä¼šå¯¹åŒä¸€å¼ å›¾ç‰‡å‘èµ·ä¸¤æ¬¡è¯·æ±‚ï¼Œæœ€ç»ˆç¬¬äºŒæ¬¡è¯·æ±‚è§¦å‘è·¨åŸŸé”™è¯¯ã€‚ä»¥ä¸‹æ˜¯é—®é¢˜çš„å®Œæ•´æ’æŸ¥è¿‡ç¨‹ä¸ç°è±¡æ¢³ç†ï¼š</p>
<ol>
<li>è¯·æ±‚è¡Œä¸ºå¼‚å¸¸ï¼šåŒä¸€å¼  OBS å›¾ç‰‡è¢«æµè§ˆå™¨å‘èµ·ä¸¤æ¬¡è¯·æ±‚ï¼Œç¬¬ä¸€æ¬¡è¯·æ±‚æ­£å¸¸å“åº”ï¼Œç¬¬äºŒæ¬¡è¯·æ±‚ç›´æ¥æŠ›å‡ºè·¨åŸŸç›¸å…³é”™è¯¯ï¼ˆå¦‚ <code>CORS policy: No 'Access-Control-Allow-Origin' header</code>ï¼‰ï¼›</li>
<li>åˆæ­¥æ’æŸ¥æ–¹å‘ï¼šåˆæœŸä¼˜å…ˆæ€€ç–‘ OBS æœåŠ¡å™¨è·¨åŸŸé…ç½®ç¼ºå¤±ï¼Œåé¦ˆè¿ç»´æ ¸æŸ¥åï¼Œç¡®è®¤ OBS å·²æ­£ç¡®é…ç½®è·¨åŸŸå…è®¸è§„åˆ™ï¼ˆå«å…è®¸å½“å‰å‰ç«¯åŸŸåã€æ”¯æŒ GET æ–¹æ³•ç­‰ï¼‰ï¼›</li>
<li>å…³é”®æµ‹è¯•çªç ´ï¼šé€šè¿‡æµè§ˆå™¨å¼€å‘è€…å·¥å…·æµ‹è¯•å‘ç°ï¼Œå¼€å¯ã€Œåœç”¨ç¼“å­˜ã€åŠŸèƒ½åï¼Œè·¨åŸŸé”™è¯¯æ¶ˆå¤±ã€‚æ®æ­¤é”å®šé—®é¢˜æ ¹æºä¸æµè§ˆå™¨ç¼“å­˜æœºåˆ¶ç›¸å…³ï¼›</li>
<li>æ ¸å¿ƒå·®å¼‚å®šä½ï¼šå¯¹æ¯”ä¸¤æ¬¡è¯·æ±‚çš„è¯¦ç»†ä¿¡æ¯ï¼Œå‘ç°è·¨åŸŸæ ‡è¯†é…ç½®ä¸ä¸€è‡´â€”â€”ç¬¬ä¸€æ¬¡åŠ è½½å›¾ç‰‡æœªè®¾ç½® <code>crossOrigin</code> æ ‡è¯†ï¼Œç¬¬äºŒæ¬¡åŠ è½½æ—¶åˆ™æ·»åŠ äº†è¯¥æ ‡è¯†ï¼›</li>
<li>é—®é¢˜é€»è¾‘é—­ç¯ï¼šç¬¬ä¸€æ¬¡è¯·æ±‚å› æ—  <code>crossOrigin</code> æ ‡è¯†ï¼ŒOBS æœåŠ¡å™¨è¯†åˆ«ä¸ºéè·¨åŸŸè¯·æ±‚ï¼Œæœªè¿”å›è·¨åŸŸå“åº”å¤´ï¼›ç¬¬äºŒæ¬¡è¯·æ±‚è™½å¼€å¯ <code>crossOrigin</code>ï¼Œä½†å› å›¾ç‰‡ URL æœªå˜ï¼Œæµè§ˆå™¨ç›´æ¥å¤ç”¨ç¼“å­˜çš„æ— è·¨åŸŸå“åº”å¤´èµ„æºï¼Œå¯¼è‡´è·¨åŸŸæ ¡éªŒå¤±è´¥ã€‚</li>
</ol>
<h2 data-id="heading-1">é—®é¢˜æ ¹æº</h2>
<p>ä¸ºéªŒè¯ä¸Šè¿°æ’æŸ¥ç»“è®ºï¼Œé€šè¿‡åŸç”Ÿ JavaScript ä»£ç å¤ç°äº†é—®é¢˜åœºæ™¯ï¼Œæœ€ç»ˆç¡®è®¤é—®é¢˜æ ¹æºä¸º <strong>è·¨åŸŸç­–ç•¥ä¸æµè§ˆå™¨ç¼“å­˜å†²çª</strong>ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'DOMContentLoaded'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> image = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>();
    <span class="hljs-comment">// ç¬¬ä¸€æ¬¡åŠ è½½ï¼šæœªè®¾ç½® crossOrigin æ ‡è¯†</span>
    image.<span class="hljs-property">src</span> = <span class="hljs-string">'https://xxx.png'</span>; 
    image.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'load'</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å›¾ç‰‡åŠ è½½å®Œæˆ'</span>);
        <span class="hljs-keyword">const</span> image2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>();
        <span class="hljs-comment">// ç¬¬äºŒæ¬¡åŠ è½½ï¼šè®¾ç½®è·¨åŸŸæ ‡è¯†ï¼ˆä¸ç¬¬ä¸€æ¬¡ä¸ä¸€è‡´ï¼‰</span>
        image2.<span class="hljs-property">crossOrigin</span> = <span class="hljs-string">"anonymous"</span>;
        <span class="hljs-comment">// åŠ è½½åŒä¸€å¼ å›¾ç‰‡ï¼Œè§¦å‘è·¨åŸŸé”™è¯¯</span>
        image2.<span class="hljs-property">src</span> = image.<span class="hljs-property">src</span>; 
        image2.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'load'</span>, <span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å›¾ç‰‡2åŠ è½½å®Œæˆ'</span>);
        });
    });
});
</code></pre>
<p>è¯¥é—®é¢˜çš„æ ¸å¿ƒçŸ›ç›¾æ˜¯ã€ŒåŒä¸€å¼ å›¾ç‰‡çš„ä¸¤æ¬¡è¯·æ±‚é‡‡ç”¨ä¸ä¸€è‡´çš„è·¨åŸŸç­–ç•¥ã€ï¼Œç»“åˆæµè§ˆå™¨ç¼“å­˜æœºåˆ¶ä¸ OBS æœåŠ¡å™¨çš„è·¨åŸŸå“åº”è§„åˆ™ï¼Œå…·ä½“é”™è¯¯é€»è¾‘å¯æ‹†è§£ä¸ºä¸¤æ­¥ï¼š</p>
<ol>
<li>éè·¨åŸŸæ¨¡å¼ç¼“å­˜ï¼šç¬¬ä¸€æ¬¡åŠ è½½æœªè®¾ç½® <code>crossOrigin</code>ï¼Œæµè§ˆå™¨ä»¥ã€Œéè·¨åŸŸæ¨¡å¼ã€å‘èµ·è¯·æ±‚ï¼ˆè¯·æ±‚å¤´ <code>Sec-Fetch-Mode = no-cors</code>ï¼‰ï¼›OBS æœåŠ¡å™¨è¯†åˆ«è¯¥æ¨¡å¼åï¼Œä¸è¿”å› <code>Access-Control-Allow-Origin</code> ç­‰è·¨åŸŸå“åº”å¤´ï¼Œæµè§ˆå™¨åˆ™å°†è¿™ä»½ã€Œæ— è·¨åŸŸå“åº”å¤´çš„å›¾ç‰‡èµ„æºã€ç¼“å­˜è‡³æœ¬åœ°ï¼›</li>
<li>è·¨åŸŸæ¨¡å¼ç¼“å­˜å†²çªï¼šç¬¬äºŒæ¬¡åŠ è½½è®¾ç½® <code>crossOrigin: "anonymous"</code>ï¼Œæµè§ˆå™¨éœ€ä»¥ã€Œè·¨åŸŸæ¨¡å¼ã€è¯·æ±‚ï¼›ä½†å› å›¾ç‰‡ URL æœªå˜ï¼Œæµè§ˆå™¨ç›´æ¥å¤ç”¨æœ¬åœ°ç¼“å­˜çš„æ— è·¨åŸŸå“åº”å¤´èµ„æºï¼Œè·¨åŸŸæ ¡éªŒæ— æ³•é€šè¿‡ï¼Œæœ€ç»ˆè§¦å‘é”™è¯¯ã€‚</li>
</ol>
<p>å…³é”®ç»“è®ºï¼šåŒä¸€å¼ å›¾ç‰‡çš„æ‰€æœ‰è¯·æ±‚ï¼Œè·¨åŸŸæ ‡è¯†å¿…é¡»å®Œå…¨ç»Ÿä¸€ï¼ˆè¦ä¹ˆæ‰€æœ‰è¯·æ±‚éƒ½è®¾ <code>crossOrigin</code>ï¼Œè¦ä¹ˆéƒ½ä¸è®¾ï¼‰ï¼Œå¦åˆ™ä¼šå› ç¼“å­˜æœºåˆ¶å¯¼è‡´è·¨åŸŸç­–ç•¥å†²çªã€‚</p>
<h2 data-id="heading-2">è§£å†³åŠæ³•</h2>
<h3 data-id="heading-3">1. æ ¸å¿ƒé€šç”¨æ–¹æ¡ˆï¼šç»Ÿä¸€è·¨åŸŸæ ‡è¯†ï¼ˆæ¨èé¦–é€‰ï¼‰</h3>
<p>æ€è·¯ï¼šç»Ÿä¸€æ‰€æœ‰åŠ è½½è¯¥å›¾ç‰‡çš„ <code>Image</code> å®ä¾‹çš„è·¨åŸŸé…ç½®ï¼ˆå‡è®¾ç½®æˆ–å‡ä¸è®¾ç½® <code>crossOrigin</code>ï¼‰ï¼Œç¡®ä¿ä¸¤æ¬¡è¯·æ±‚çš„è·¨åŸŸç­–ç•¥ä¸€è‡´ï¼Œä»æ ¹æºé¿å…ç¼“å­˜ä¸è·¨åŸŸè§„åˆ™çš„å†²çªã€‚</p>
<p>æ ¸å¿ƒæ³¨æ„ç‚¹ï¼š<code>crossOrigin</code> å¿…é¡»åœ¨ <code>src</code> èµ‹å€¼ <strong>ä¹‹å‰</strong> è®¾ç½®ã€‚è‹¥å…ˆèµ‹å€¼ <code>src</code>ï¼Œæµè§ˆå™¨ä¼šæå‰ä»¥é»˜è®¤æ¨¡å¼å‘èµ·è¯·æ±‚ï¼Œä»ä¼šè§¦å‘è·¨åŸŸå†²çªã€‚</p>
<p>æ­£ç¡®ä»£ç ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'DOMContentLoaded'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// ç¬¬ä¸€æ¬¡åŠ è½½ï¼šæå‰è®¾ç½® crossOriginï¼Œç»Ÿä¸€è·¨åŸŸç­–ç•¥</span>
  <span class="hljs-keyword">const</span> image = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>();
  image.<span class="hljs-property">crossOrigin</span> = <span class="hljs-string">"anonymous"</span>; 
  image.<span class="hljs-property">src</span> = <span class="hljs-string">'https://xxx.png'</span>;

  image.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'load'</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å›¾ç‰‡åŠ è½½å®Œæˆ'</span>);
      <span class="hljs-comment">// ç¬¬äºŒæ¬¡åŠ è½½ï¼šä¿æŒ crossOrigin é…ç½®ä¸€è‡´</span>
      <span class="hljs-keyword">const</span> image2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>();
      image2.<span class="hljs-property">crossOrigin</span> = <span class="hljs-string">"anonymous"</span>; 
      image2.<span class="hljs-property">src</span> = image.<span class="hljs-property">src</span>;

      image2.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'load'</span>, <span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å›¾ç‰‡2åŠ è½½å®Œæˆ'</span>);
      });
  });

  <span class="hljs-comment">// æ·»åŠ é”™è¯¯ç›‘å¬ï¼Œä¾¿äºé—®é¢˜æ’æŸ¥</span>
  image.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å›¾ç‰‡1åŠ è½½å¤±è´¥:'</span>, e));
  image2.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å›¾ç‰‡2åŠ è½½å¤±è´¥:'</span>, e));
});
</code></pre>
<p>é€‚ç”¨åœºæ™¯ï¼šç»å¤§å¤šæ•°å‰ç«¯åœºæ™¯ï¼ˆåŒ…æ‹¬ <code>VueCropper </code> ç­‰ä¾èµ– canvas çš„è£å‰ªç»„ä»¶åœºæ™¯ï¼‰ï¼Œä¸”å›¾ç‰‡å­˜å‚¨ç«¯<code>ï¼ˆOBS/CDNï¼‰</code>å·²é…ç½®è·¨åŸŸå…è®¸è§„åˆ™ã€‚</p>
<h3 data-id="heading-4">2. ç»•è¿‡ç¼“å­˜æ–¹æ¡ˆï¼šè®©ç¬¬äºŒæ¬¡è¯·æ±‚è§†ä¸ºã€Œæ–°èµ„æºã€</h3>
<p>æ€è·¯ï¼šè‹¥å†å²ä»£ç æ— æ³•æ‰¹é‡ä¿®æ”¹ <code>crossOrigin</code> é…ç½®ï¼Œå¯é€šè¿‡è®©ç¬¬äºŒæ¬¡è¯·æ±‚ã€Œé¿å¼€ç¼“å­˜ã€ï¼Œè¿«ä½¿æµè§ˆå™¨é‡æ–°å‘ OBS æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼ˆè€Œéå¤ç”¨æ—§ç¼“å­˜ï¼‰ï¼Œä»è€Œé¿å…è·¨åŸŸç­–ç•¥å†²çªã€‚</p>
<p>æ¨èæ–¹æ¡ˆï¼šç»™å›¾ç‰‡ URL æ·»åŠ éšæœºå‚æ•°ï¼ˆå¦‚æ—¶é—´æˆ³ï¼‰ï¼Œä½¿æµè§ˆå™¨è¯†åˆ«ä¸ºã€Œæ–°èµ„æºã€ï¼Œè§¦å‘å…¨æ–°è¯·æ±‚ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">image.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'load'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> image2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>();
  image2.<span class="hljs-property">crossOrigin</span> = <span class="hljs-string">"anonymous"</span>;
  <span class="hljs-comment">// è¿½åŠ æ—¶é—´æˆ³å‚æ•°ï¼Œé¿å¼€æµè§ˆå™¨ç¼“å­˜</span>
  image2.<span class="hljs-property">src</span> = <span class="hljs-string">`<span class="hljs-subst">${image.src}</span>&amp;t=<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>; 
  image2.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'load'</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å›¾ç‰‡2åŠ è½½å®Œæˆ'</span>));
});
</code></pre>
<p>é€‚ç”¨åœºæ™¯ï¼šå†å²ä»£ç æ¶æ„å¤æ‚ï¼Œæ— æ³•æ‰¹é‡ç»Ÿä¸€ <code>crossOrigin</code> é…ç½®ï¼Œéœ€å¿«é€Ÿä¸´æ—¶ä¿®å¤è·¨åŸŸé—®é¢˜ã€‚</p>
<p>ç¼ºç‚¹ï¼šå®Œå…¨å¤±å»ç¼“å­˜ä¼˜åŠ¿ï¼Œæ¯æ¬¡è¯·æ±‚å‡éœ€é‡æ–°ä¸‹è½½å›¾ç‰‡ï¼Œä¼šå¢åŠ å¸¦å®½æ¶ˆè€—å¹¶å»¶é•¿é¡µé¢åŠ è½½æ—¶é—´ï¼Œä»…å»ºè®®ä¸´æ—¶ä½¿ç”¨ã€‚</p>
<h3 data-id="heading-5">3. åç«¯/å­˜å‚¨ç«¯æ–¹æ¡ˆï¼šä»æ ¹æºæ¶ˆé™¤è·¨åŸŸ</h3>
<p>æ€è·¯ï¼šé€šè¿‡åç«¯ä»£ç†æˆ–åŸŸåç»‘å®šï¼Œå°†ã€Œè·¨åŸŸå›¾ç‰‡è¯·æ±‚ã€è½¬ä¸ºã€ŒåŒæºè¯·æ±‚ã€ï¼Œä»æ ¹æºä¸Šæ¶ˆé™¤è·¨åŸŸé—®é¢˜ï¼Œæ— éœ€å‰ç«¯é¢å¤–é…ç½® <code>crossOrigin</code>ã€‚</p>
<p>å…·ä½“åšæ³•ï¼š</p>
<ol>
<li>åŒæºä»£ç†ï¼ˆæ¨èï¼‰ï¼šå‰ç«¯è¯·æ±‚è‡ªèº«åç«¯çš„ä»£ç†æ¥å£ï¼Œç”±åç«¯ä»£ä¸ºæ‹‰å– OBS å›¾ç‰‡å¹¶è¿”å›ç»™å‰ç«¯ã€‚æ­¤æ—¶å‰ç«¯æ¥æ”¶çš„å›¾ç‰‡ä¸ºåŒæºèµ„æºï¼Œæ— éœ€ä»»ä½•è·¨åŸŸé…ç½®ã€‚</li>
</ol>
<p>ç¤ºä¾‹ï¼ˆ<code>Node.js/Express</code> ä»£ç†ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åç«¯ä»£ç†ä»£ç ï¼ˆNode.js/Expressï¼‰</span>
<span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);
<span class="hljs-keyword">const</span> axios = <span class="hljs-built_in">require</span>(<span class="hljs-string">'axios'</span>);
<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();

<span class="hljs-comment">// å›¾ç‰‡ä»£ç†æ¥å£ï¼šæ¥æ”¶å‰ç«¯ä¼ é€’çš„ OBS å›¾ç‰‡ URL</span>
app.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/proxy-image'</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-keyword">const</span> imgUrl = req.<span class="hljs-property">query</span>.<span class="hljs-property">url</span>;
  <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// åç«¯è¯·æ±‚ OBS å›¾ç‰‡ï¼Œä»¥æµå½¢å¼è¿”å›ç»™å‰ç«¯</span>
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(imgUrl, { <span class="hljs-attr">responseType</span>: <span class="hljs-string">'stream'</span> });
      response.<span class="hljs-property">data</span>.<span class="hljs-title function_">pipe</span>(res);
  } <span class="hljs-keyword">catch</span> (err) {
      res.<span class="hljs-title function_">status</span>(<span class="hljs-number">404</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">'å›¾ç‰‡åŠ è½½å¤±è´¥'</span>);
  }
});

app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä»£ç†æœåŠ¡å¯åŠ¨åœ¨ 3000 ç«¯å£'</span>));
</code></pre>
<p>å‰ç«¯ä»£ç ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å‰ç«¯ä»£ç ï¼šè¯·æ±‚åç«¯ä»£ç†æ¥å£ï¼Œæ— è·¨åŸŸé—®é¢˜</span>
<span class="hljs-keyword">const</span> image = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>();
image.<span class="hljs-property">src</span> = <span class="hljs-string">`http://localhost:3000/proxy-image?url=<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(<span class="hljs-string">'https://xxx.png'</span>)}</span>`</span>;
image.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'load'</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å›¾ç‰‡åŠ è½½å®Œæˆ'</span>));
</code></pre>
<p>é€‚ç”¨åœºæ™¯ï¼šå‰ç«¯éœ€å¤§é‡å¤„ç†è·¨åŸŸå›¾ç‰‡ï¼ˆå¦‚æ‰¹é‡è£å‰ªã€åƒç´ æ“ä½œï¼‰ï¼›è¿½æ±‚ç¨³å®šå¯é çš„è·¨åŸŸè§£å†³æ–¹æ¡ˆï¼Œä¸å¸Œæœ›ä¾èµ–å‰ç«¯ä»£ç é…ç½®ã€‚</p>
<p>ä¼˜ç‚¹ï¼šå½»åº•è§£å†³è·¨åŸŸé—®é¢˜ï¼Œå‰ç«¯æ— éœ€ä»»ä½•è·¨åŸŸç›¸å…³é…ç½®ï¼›ç¼“å­˜æœºåˆ¶å¯æ­£å¸¸ç”Ÿæ•ˆï¼Œä¸å½±å“åŠ è½½æ€§èƒ½ï¼›å®‰å…¨æ€§æ›´é«˜ï¼ˆé¿å…è®¾ç½® <code>*</code> å…è®¸æ‰€æœ‰åŸŸåè·¨åŸŸï¼‰ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[trea solo,è®©æˆ‘ä»ç‰›é©¬å¤–åŒ…ç¿»èº«å½“â€œç”²æ–¹â€]]></title>    <link>https://juejin.cn/post/7588086766234779686</link>    <guid>https://juejin.cn/post/7588086766234779686</guid>    <pubDate>2025-12-26T09:31:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588086766234779686" data-draft-id="7587965908288159754" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="trea solo,è®©æˆ‘ä»ç‰›é©¬å¤–åŒ…ç¿»èº«å½“â€œç”²æ–¹â€"/> <meta itemprop="keywords" content="Trae,Python"/> <meta itemprop="datePublished" content="2025-12-26T09:31:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†·æœˆåŠæ˜"/> <meta itemprop="url" content="https://juejin.cn/user/2520515442391102"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            trea solo,è®©æˆ‘ä»ç‰›é©¬å¤–åŒ…ç¿»èº«å½“â€œç”²æ–¹â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2520515442391102/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†·æœˆåŠæ˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T09:31:21.000Z" title="Fri Dec 26 2025 09:31:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€ï¼šç‰›é©¬çš„å¦ç™½</h2>
<p>é©¬ä¸Šå°±è¦2026äº†ï¼Œæˆ‘å¾—æ‰¿è®¤ä¸€ä»¶äº‹ï¼šAIå·¥å…·å·²ç»æŠŠæˆ‘"æƒ¯å"äº†ã€‚</p>
<p>åœ¨ç”µåŠ›è´Ÿè·é¢„æµ‹è¿™ä¸ªé¢†åŸŸæ‘¸çˆ¬æ»šæ‰“è¿™ä¹ˆä¹…ï¼Œä¹ æƒ¯äº†æœè®ºæ–‡ã€æ‰‹æ’¸ä»£ç ã€è°ƒå‚è°ƒåˆ°æ€€ç–‘äººç”Ÿã€‚ç›´åˆ°æœ€è¿‘å¼€å§‹ç”¨Trea AIçš„Soloæ¨¡å¼ï¼Œæ‰å‘ç°åŸæ¥å¯ä»¥è¿™ä¹ˆç©â€”â€”å®ƒä¸åªæ˜¯ä¸ªèŠå¤©å·¥å…·ï¼Œæ›´åƒä¸€ä¸ªèƒ½ç‹¬ç«‹æ€è€ƒçš„æŠ€æœ¯åˆä¼™äººï¼šä½ æ‰”éœ€æ±‚ï¼Œå®ƒç»™æ–¹æ¡ˆï¼›ä½ å‡ºé—®é¢˜ï¼Œå®ƒè‡ªåŠ¨debugï¼›ä½ æ‡’å¾—å†™æ–‡æ¡£ï¼Œå®ƒä¸€æ°”å‘µæˆã€‚</p>
<p>è¿™ç¯‡æ–‡ç« ä¸å¹ä¸é»‘ï¼Œå°±èŠèŠæˆ‘æ˜¯æ€ä¹ˆåœ¨çœŸå®é¡¹ç›®é‡ŒæŠŠTrea AIç”¨æˆ"è‡ªå·±äºº"çš„ã€‚</p>
<hr/>
<h2 data-id="heading-1">Trea AIåœ¨æˆ‘é¡¹ç›®é‡Œçš„"æ‰“å·¥å®å½•"</h2>
<h3 data-id="heading-2">1. éœ€æ±‚åˆ†æï¼šä»"å•ƒè®ºæ–‡"åˆ°"èŠæ˜ç™½"</h3>
<p>ä»¥å‰åšæ–¹æ¡ˆè®¾è®¡ï¼Œæµç¨‹æ˜¯è¿™æ ·çš„ï¼šGoogle Scholar â†’ ä¸‹è½½20ç¯‡è®ºæ–‡ â†’ çœ‹å®Œæ‘˜è¦æ”¾å¼ƒ10ç¯‡ â†’ ç²¾è¯»5ç¯‡ â†’ æœ€åå‘ç°è¿˜æ˜¯ä¸çŸ¥é“é€‰å“ªä¸ªã€‚</p>
<p>ç°åœ¨ï¼Ÿ</p>
<pre><code class="hljs language-arduino" lang="arduino">æˆ‘ï¼š<span class="hljs-string">"Treaï¼ŒDirectå’Œé€’å½’é¢„æµ‹ç­–ç•¥ï¼Œå®é™…é¡¹ç›®é‡Œæ€ä¹ˆé€‰ï¼Ÿè¯´ç‚¹è®ºæ–‡é‡Œä¸å†™çš„ä¸œè¥¿ã€‚"</span>
Trea chatï¼š<span class="hljs-string">"Directå°±åƒç»™æ¯ä¸ªæ—¶é—´ç‚¹è¯·ä¸ªä¸“å®¶ï¼Œç²¾å‡†ä½†è´µï¼›é€’å½’ç›¸å½“äºä¸€ä¸ªä¸“å®¶è¿è½´è½¬ï¼Œçœé¢„ç®—ä½†ä¼šç´¯è¶´ã€‚ä½ æ•°æ®é‡å¤šå¤§ï¼Ÿé¢„ç®—å¤šå°‘ï¼Ÿ"</span>
æˆ‘ï¼š<span class="hljs-string">"å‡ ç™¾ä¸‡æ¡æ•°æ®ï¼Œé¢„ç®—...èƒ½ç”¨å¼€æºå°±ä¸èŠ±é’±ã€‚"</span>
Trea chatï¼š<span class="hljs-string">"é‚£è¿˜æ˜¯é€’å½’å§ï¼Œå…ˆè·‘é€šå†ä¼˜åŒ–ã€‚æˆ‘ç›´æ¥ç»™ä½ ç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„é¡¹ç›®æ¡†æ¶..."</span>
</code></pre>
<p>ååˆ†é’Ÿæå®šæŠ€æœ¯é€‰å‹ï¼Œè¿˜é™„èµ ä»£ç æ¡†æ¶ã€‚çœä¸‹çš„æ—¶é—´ï¼Œå¤Ÿæˆ‘å–æ¯å’–å•¡æ‘¸é±¼...å’³ï¼Œæ˜¯åšæ·±åº¦æ€è€ƒã€‚</p>
<h3 data-id="heading-3">2. ä»£ç ç”Ÿæˆï¼šä»"æ‰‹æ•²"åˆ°"å¯¹è¯"</h3>
<h4 data-id="heading-4">ç‰¹å¾å·¥ç¨‹ï¼šç»ˆäºä¸ç”¨å½“CVå·¥ç¨‹å¸ˆäº†</h4>
<p>åšæ¸©åº¦ç‰¹å¾é‚£å¤©ï¼Œæˆ‘è„‘å­å·²ç»è½¬ä¸åŠ¨äº†ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æˆ‘ï¼š"Treaï¼Œå¸®æˆ‘å†™ä¸ªå‡½æ•°ï¼Œåˆ¤æ–­æ¸©åº¦æ˜¯ä¸æ˜¯åˆ°äº†å¼€ç©ºè°ƒçš„ä¸´ç•Œç‚¹"</span>
<span class="hljs-comment"># Treaï¼šç›´æ¥ç”©è¿‡æ¥å®Œæ•´ä»£ç ï¼Œè¿˜é™„å¸¦å•å…ƒæµ‹è¯•</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">add_temperature_threshold_features</span>(<span class="hljs-params">df</span>):
    <span class="hljs-string">"""
    æ ¹æ®æ¸©åº¦åˆ¤æ–­ç©ºè°ƒè´Ÿè·ç‰¹å¾çš„å‡½æ•°
    """</span>
    df = df.copy()
    
    <span class="hljs-comment"># å¤å­£åˆ¶å†·é˜ˆå€¼26Â°Cï¼šæ¯è¶…1åº¦ï¼Œè´Ÿè·æ˜æ˜¾å¢åŠ </span>
    df[<span class="hljs-string">'temp_above_cooling'</span>] = df[<span class="hljs-string">'temp_max'</span>].apply(<span class="hljs-keyword">lambda</span> x: <span class="hljs-built_in">max</span>(<span class="hljs-number">0</span>, x - <span class="hljs-number">26</span>))
    df[<span class="hljs-string">'ac_cooling_usage'</span>] = (df[<span class="hljs-string">'temp_above_cooling'</span>] &gt; <span class="hljs-number">0</span>).astype(<span class="hljs-built_in">int</span>)
    
    <span class="hljs-comment"># å†¬å­£åˆ¶çƒ­é˜ˆå€¼12Â°Cï¼šä½äºè¿™ä¸ªï¼Œå–æš–è´Ÿè·ä¸Šæ¥</span>
    df[<span class="hljs-string">'temp_below_heating'</span>] = df[<span class="hljs-string">'temp_min'</span>].apply(<span class="hljs-keyword">lambda</span> x: <span class="hljs-built_in">max</span>(<span class="hljs-number">0</span>, <span class="hljs-number">12</span> - x))
    df[<span class="hljs-string">'ac_heating_usage'</span>] = (df[<span class="hljs-string">'temp_below_heating'</span>] &gt; <span class="hljs-number">0</span>).astype(<span class="hljs-built_in">int</span>)
    
    <span class="hljs-comment"># æ¸©åº¦å˜åŒ–ç‡ï¼šåæ˜ å¤©æ°”çªå˜å¸¦æ¥çš„è´Ÿè·æ³¢åŠ¨</span>
    df[<span class="hljs-string">'temp_change_rate'</span>] = df[<span class="hljs-string">'temp_avg'</span>].diff().fillna(<span class="hljs-number">0</span>)
    
    <span class="hljs-keyword">return</span> df

<span class="hljs-comment"># Treaè¿˜è‡ªåŠ¨ç”Ÿæˆäº†æµ‹è¯•ç”¨ä¾‹ï¼š</span>
<span class="hljs-comment"># test_add_temperature_threshold_features()</span>
</code></pre>
<p>ä»£ç è§„èŒƒã€æ³¨é‡Šæ¸…æ™°ï¼Œæ¯”æˆ‘å†™çš„å¼ºå¤šäº†ã€‚æˆ‘ç›´æ¥git commitï¼Œç„¶åå‘Šè¯‰è‡ªå·±ï¼šè¿™æ˜¯å›¢é˜Ÿåä½œçš„æˆæœï¼ˆæ‰‹åŠ¨ç‹—å¤´ï¼‰ã€‚</p>
<h4 data-id="heading-5">Debugï¼šä»"æŠ“ç"åˆ°"è€ä¸­åŒ»é—®è¯Š"</h4>
<p>é‚£æ¬¡XGBoosté¢„æµ‹å€¼ç³»ç»Ÿæ€§åä½ï¼Œæˆ‘ç›¯äº†å¾ˆä¹…æ²¡å¤´ç»ªï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">æˆ‘ï¼š<span class="hljs-string">"æ¨¡å‹é¢„æµ‹å€¼æ•´ä½“åä½30%å·¦å³ï¼Œå¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿæˆ‘æ£€æŸ¥äº†æ•°æ®åˆ†å¸ƒï¼Œæ²¡å•¥å¼‚å¸¸ã€‚"</span>
Treaï¼š<span class="hljs-string">"çœ‹è¿‡ç›®æ ‡å˜é‡å—ï¼Ÿç”µåŠ›è´Ÿè·æ•°æ®é•¿å°¾åˆ†å¸ƒä¸¥é‡ï¼Œä½ ä¸åšå˜æ¢ï¼Œæ¨¡å‹ä¼šè¢«å¤§æ•°å€¼å¸¦åï¼Œå¯¼è‡´æ•´ä½“ä½ä¼°ã€‚è¦æˆ‘å¸®ä½ å†™ä¸€ä¸ªå®Œæ•´çš„æ•°æ®é¢„å¤„ç†pipelineå—ï¼Ÿ"</span>
æˆ‘ï¼š<span class="hljs-string">"å¸®æˆ‘åˆ—å‡ºè®¡åˆ’å¹¶å®ç°ã€‚"</span>
</code></pre>
<p>å¯¹æ•°å˜æ¢åï¼Œé—®é¢˜è§£å†³äº†ã€‚æ•´ä¸ªè¿‡ç¨‹å°±åƒæ‰¾ä¸ªè€ä¸­åŒ»æŠŠè„‰ï¼Œä¸‰å¥è¯ç‚¹åˆ°è¦å®³ï¼Œè¿˜ç›´æ¥ç»™ä½ å¼€å¥½è¯æ–¹ã€‚</p>
<hr/>
<h3 data-id="heading-6">3. æ–‡æ¡£ç¼–å†™ï¼šä»"æ‹–å»¶ç—‡"åˆ°"ç§’äº¤å·®"</h3>
<p>å†™æ–‡æ¡£çš„ç—›è‹¦ï¼Œè°å†™è°çŸ¥é“ã€‚ç°åœ¨æˆ‘éƒ½ç›´æ¥"å£è¿°"ï¼š
ä»£ç æ‰”è¿‡å»ï¼Œè®©å®ƒæŒ‰å…¬å¸æ¨¡æ¿ç”Ÿæˆæ¥å£å®šä¹‰å¤åˆ¶ç»™å®ƒï¼Œäº”åˆ†é’Ÿå‡ºæ–‡æ¡£ç»™å®ƒå¤§çº²ï¼Œå®ƒå¸®æˆ‘å†™é€å­—ç¨¿ï¼Œè¿˜æç¤ºå“ªé‡ŒåŠ å›¾è¡¨</p>
<hr/>
<h2 data-id="heading-7">å·¥ä½œæ¨¡å¼çš„"è¢«åŠ¨å‡çº§"</h2>
<h3 data-id="heading-8">1. è§’è‰²å˜äº†ï¼šä»"å…¨æ ˆ"åˆ°"æ¶æ„å¸ˆ"</h3>
<p>ä»¥å‰ï¼šéœ€æ±‚ã€ç¼–ç ã€æµ‹è¯•ã€æ–‡æ¡£ä¸€æ¡é¾™ã€‚
ç°åœ¨ï¼šæˆ‘è´Ÿè´£æƒ³ï¼ŒTreaè´Ÿè´£å¹²ã€‚å¬èµ·æ¥åƒèµ„æœ¬å®¶ï¼Œä½†ç¡®å®æ•ˆç‡ç¿»å€ã€‚</p>
<h3 data-id="heading-9">2. å†³ç­–å˜äº†ï¼šä»"æ‹è„‘è¢‹"åˆ°"å…ˆé—®Trea"</h3>
<p>æŠ€æœ¯é€‰å‹å‰å…ˆé—®Treaï¼š"è¿™ä¸ªæ–¹æ¡ˆæœ‰å•¥å‘ï¼Ÿ" å®ƒæ€»èƒ½è¯´å‡ºå‡ ä¸ªæˆ‘æ²¡æƒ³åˆ°çš„corner caseã€‚ç›¸å½“äºå¸¦äº†ä¸ªç»éªŒä¸°å¯Œçš„é¡¾é—®ã€‚</p>
<h3 data-id="heading-10">3. é€Ÿåº¦å˜äº†ï¼šä»"é©¬æ‹‰æ¾"åˆ°"å†²åˆº"</h3>
<p>ç‰¹å¾å·¥ç¨‹è¿™å—ï¼ŒåŸè®¡åˆ’ä¸‰å‘¨ï¼Œå®é™…äº”å¤©ã€‚é¡¹ç›®ç»ç†é—®æˆ‘æ˜¯ä¸æ˜¯å·å·åŠ ç­äº†ï¼Œæˆ‘è¯´ï¼šä¸ï¼Œæ˜¯æˆ‘æ‰¾äº†ä¸ªä¸æ”¶è´¹çš„å¸®æ‰‹ã€‚</p>
<h3 data-id="heading-11">4. å…³æ³¨ç‚¹å˜äº†ï¼šä»"ç»†èŠ‚"åˆ°"å…¨å±€"</h3>
<p>ä¸ç”¨çº ç»“äºæŸä¸ªå‡½æ•°æ€ä¹ˆå†™ï¼Œæ›´å¤šæ—¶é—´èŠ±åœ¨ç³»ç»Ÿè®¾è®¡å’Œä¸šåŠ¡ç†è§£ä¸Šã€‚è¿™ç§è½¬å˜ï¼Œåè€Œè®©æˆ‘çš„å·¥ä½œæ›´æœ‰ä»·å€¼ã€‚</p>
<hr/>
<h2 data-id="heading-12">ä¸€äº›"è¡€æ³ªæ€»ç»“"çš„æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-13">1. Promptè¦"å…·ä½“"</h3>
<p>æ¨¡ç³ŠæŒ‡ä»¤ = åƒåœ¾è¾“å‡ºã€‚æˆ‘çš„æ¨¡æ¿ï¼š</p>
<pre><code class="hljs">èƒŒæ™¯ + å…·ä½“ä»»åŠ¡ + è¾“å‡ºæ ¼å¼ + è´¨é‡è¦æ±‚
</code></pre>
<p>æ¯”å¦‚ï¼š"æˆ‘éœ€è¦ä¸€ä¸ªPythonå‡½æ•°ï¼Œè®¡ç®—æ—¶é—´åºåˆ—çš„æ»åç‰¹å¾ã€‚è¾“å…¥æ˜¯DataFrameï¼Œè¾“å‡ºæ˜¯åŠ äº†ç‰¹å¾çš„DataFrameã€‚ä»£ç è¦æœ‰ç±»å‹æç¤ºå’Œdocstringï¼Œé£æ ¼å‚è€ƒscikit-learnã€‚"</p>
<h3 data-id="heading-14">2. åˆ«æ‡’ï¼šAIçš„ä»£ç ä¹Ÿå¾—review</h3>
<p>ä¿¡ä»»ä½†è¦éªŒè¯ã€‚æˆ‘åšæŒï¼š</p>
<ul>
<li>æ‰€æœ‰Treaç”Ÿæˆçš„æ ¸å¿ƒé€»è¾‘å¿…é¡»è·‘é€šå•å…ƒæµ‹è¯•</li>
<li>æ€§èƒ½å…³é”®éƒ¨åˆ†è¦profile</li>
<li>ä»£ç é£æ ¼ä¸ç¬¦åˆå›¢é˜Ÿè§„èŒƒçš„ï¼Œè®©å®ƒé‡å†™</li>
</ul>
<h3 data-id="heading-15">3. æŒç»­å¯¹è¯ï¼šåƒå¸¦æ–°äººä¸€æ ·</h3>
<p>ä¸€æ¬¡ç»™å¤§ä»»åŠ¡ï¼Œä¸å¦‚åˆ†æ­¥æ¥ã€‚å…ˆè®©å®ƒå‡ºæ¡†æ¶ï¼Œå†é€æ­¥ç»†åŒ–ã€‚è¿™æ ·è¿”å·¥æœ€å°‘ã€‚</p>
<hr/>
<h2 data-id="heading-16">é‚£äº›ä¸å¾—ä¸è¯´çš„"å‰¯ä½œç”¨"</h2>
<h3 data-id="heading-17">1. æŠ€èƒ½æ ‘ç¡®å®å˜äº†</h3>
<p>ç°åœ¨æ›´çœ‹é‡ï¼š</p>
<ul>
<li><strong>æé—®èƒ½åŠ›</strong>ï¼šé—®å¯¹é—®é¢˜ï¼Œæ¯”çŸ¥é“ç­”æ¡ˆé‡è¦</li>
<li><strong>æ‰¹åˆ¤æ€ç»´</strong>ï¼šAIä¹Ÿä¼šä¸€æœ¬æ­£ç»èƒ¡è¯´å…«é“</li>
<li><strong>ç³»ç»Ÿè®¾è®¡</strong>ï¼šæ€ä¹ˆæŠŠAIé›†æˆåˆ°workflowé‡Œ</li>
</ul>
<h3 data-id="heading-18">2. ç‰ˆæƒé—®é¢˜ï¼šåˆ«å½“ç”©æ‰‹æŒæŸœ</h3>
<p>æˆ‘çš„åº•çº¿ï¼š</p>
<ul>
<li>æ ¸å¿ƒç®—æ³•è‡ªå·±å†™</li>
<li>Treaä»£ç å¿…é¡»ç†è§£åä½¿ç”¨</li>
<li>å•†ç”¨é¡¹ç›®ä¿ç•™ä¿®æ”¹è®°å½•</li>
</ul>
<h3 data-id="heading-19">3. è­¦æƒ•"AIä¾èµ–ç—‡"</h3>
<p>æœ‰æ—¶å€™è¿˜æ˜¯å¾—è‡ªå·±åŠ¨æ‰‹ã€‚AIæ˜¯æ‹æ–ï¼Œä¸æ˜¯è½®æ¤…ã€‚è„‘å­ä¸èƒ½åœã€‚</p>
<hr/>
<h2 data-id="heading-20">ç»™è¿˜åœ¨è§‚æœ›çš„åŒå­¦å‡ å¥å®è¯</h2>
<p>Trea AIè¿™ç©æ„ï¼Œç”¨å¥½äº†æ˜¯çœŸé¦™ï¼Œä½†åˆ«ç¥è¯å®ƒã€‚å®ƒä¸ä¼šå–ä»£ä½ ï¼Œä½†ä¼šè®©ä¼šç”¨çš„äººæ•ˆç‡ç¿»å€ã€‚</p>
<p>åœ¨ç”µåŠ›é¢„æµ‹è¿™ä¸ªé¢†åŸŸï¼Œå®ƒå¸®æˆ‘è§£å†³äº†è‡³å°‘40%çš„é‡å¤åŠ³åŠ¨ï¼Œè®©æˆ‘æœ‰æ›´å¤šæ—¶é—´åšçœŸæ­£æœ‰ä»·å€¼çš„äº‹â€”â€”æ¯”å¦‚ç†è§£ä¸šåŠ¡ã€ä¼˜åŒ–æ¨¡å‹ã€è·Ÿè°ƒåº¦ä¸­å¿ƒçš„è€ç™»ä»¬æ‰¯çš®ã€‚</p>
<p>è¯´åˆ°åº•ï¼Œå®ƒå°±æ˜¯ä¸ªè¶…çº§å·¥å…·ã€‚å·¥å…·çš„ä»·å€¼ï¼Œå–å†³äºç”¨å®ƒçš„äººã€‚</p>
<p>å¯¹äº†ï¼Œæœ€è¿‘æˆ‘åœ¨å°è¯•è®©å®ƒå¸®æˆ‘å†™å‘¨æŠ¥ã€‚æ•ˆæœä¸é”™ï¼Œå°±æ˜¯å¾—æ‰‹åŠ¨åˆ æ‰ä¸€äº›è¿‡äºå¤¸å¼ çš„"è‡ªæˆ‘è¡¨æ‰¬"ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŠ å…¥æˆ‘ä»¬ï¼Œä¸€èµ·å®šä¹‰ã€ŒData x AIã€çš„æœªæ¥]]></title>    <link>https://juejin.cn/post/7587845752682856511</link>    <guid>https://juejin.cn/post/7587845752682856511</guid>    <pubDate>2025-12-26T09:40:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587845752682856511" data-draft-id="7588002126258012166" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŠ å…¥æˆ‘ä»¬ï¼Œä¸€èµ·å®šä¹‰ã€ŒData x AIã€çš„æœªæ¥"/> <meta itemprop="keywords" content="äº‘åŸç”Ÿ"/> <meta itemprop="datePublished" content="2025-12-26T09:40:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿é‡Œäº‘äº‘åŸç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/3808363977648493"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŠ å…¥æˆ‘ä»¬ï¼Œä¸€èµ·å®šä¹‰ã€ŒData x AIã€çš„æœªæ¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3808363977648493/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿é‡Œäº‘äº‘åŸç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T09:40:15.000Z" title="Fri Dec 26 2025 09:40:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨é˜¿é‡Œäº‘ï¼Œæˆ‘ä»¬æ­£ç«™åœ¨ä¸€ä¸ªæŠ€æœ¯è½¬æŠ˜ç‚¹ä¸Šã€‚</p>
<p>ä»Šå¤©çš„å¤§æ¨¡å‹ä¸å†åªæ˜¯â€œèŠå¤©â€â€”â€”å®ƒå¼€å§‹æŸ¥æ•…éšœã€åšå†³ç­–ã€è‡ªåŠ¨ä¿®å¤ç³»ç»Ÿã€‚è€Œè¿™ä¸€åˆ‡çš„å‰ææ˜¯ï¼šAI å¿…é¡»çœŸæ­£â€œçœ‹è§â€è¿™ä¸ªä¸–ç•Œã€‚ä¸æ˜¯é€šè¿‡æ‘„åƒå¤´ï¼Œè€Œæ˜¯é€šè¿‡åƒä¸‡æœåŠ¡å™¨ã€ç™¾ä¸‡å®¹å™¨ã€äº¿çº§è¯·æ±‚ä¸­æŒç»­æ¶Œå‡ºçš„æ—¥å¿—ã€æŒ‡æ ‡ã€è¿½è¸ªã€eBPF äº‹ä»¶å’Œ Agent è¡Œä¸ºæ•°æ®ã€‚è¿™äº›æ•°æ®ï¼Œæ˜¯ç³»ç»Ÿæœ€çœŸå®çš„è„‰æï¼Œä¹Ÿæ˜¯æ™ºèƒ½æ¼”è¿›çš„åŸå§‹ç‡ƒæ–™ã€‚</p>
<p>æˆ‘ä»¬æ­£åœ¨æ„å»ºä¸€æ¡ä»æ•°æ®åˆ°æ™ºèƒ½çš„é—­ç¯é€šè·¯ï¼šæŠŠæµ·é‡ã€å¼‚æ„ã€é«˜é€Ÿçš„æ•°æ®æ±‡èšæˆä¸€æ¡å®æ—¶ã€é«˜è´¨é‡ã€å¯è®¡ç®—çš„â€œæ•°æ®é£è½®â€ï¼Œå–‚ç»™ AIï¼Œè®­ç»ƒ Agentï¼Œé©±åŠ¨è‡ªåŠ¨åŒ–å†³ç­–ã€‚è¿™å°±æ˜¯â€œData + AIâ€çš„æ–°èŒƒå¼ã€‚æˆ‘ä»¬ä¸å†è¢«åŠ¨å‘Šè­¦ï¼Œè€Œæ˜¯è®©ç³»ç»Ÿè‡ªå·±â€œè¯Šæ–­ + æ²»ç–—â€ï¼›ä¸å†é äººç¿»æ—¥å¿—ï¼Œè€Œæ˜¯ç”± AI å®æ—¶æ¨ç†æ ¹å› ï¼›ä¸å†æ‰‹å·¥è°ƒå‚ï¼Œè€Œæ˜¯è®© Agent åœ¨æŒç»­åé¦ˆä¸­è¶Šç”¨è¶Šèªæ˜ã€‚è€Œæ”¯æ’‘è¿™ä¸€åˆ‡çš„ï¼Œæ˜¯ä¸€ä¸ªæ—¥å¢ç™¾ PB çº§æ•°æ®çš„å®æ—¶å¤„ç†å¹³å°ã€‚å®ƒå¿…é¡»æ‰›ä½æµé‡æ´ªå³°ï¼Œæ”¯æ’‘åƒäº¿çº§æ•°æ®çš„ç§’çº§æŸ¥è¯¢ï¼Œä¸º AI æä¾›å¹²å‡€ã€ç»“æ„åŒ–ã€ä½å»¶è¿Ÿçš„æ•°æ®ç‡ƒæ–™ï¼Œæˆä¸ºäº‘åŸç”Ÿæ—¶ä»£çš„â€œæ„ŸçŸ¥ç¥ç»â€ã€‚è¿™ä¸æ˜¯ç®€å•çš„æ•°æ®ç®¡é“ï¼Œè€Œæ˜¯ AI æ—¶ä»£çš„æ“ä½œç³»ç»Ÿçº§æ•°æ®åŸºåº§ã€‚</p>
<p>é˜¿é‡Œäº‘æ—¥å¿—æœåŠ¡ SLS å›¢é˜Ÿæ¯å¤©å¤„ç†è¶…ç™¾ PB æ•°æ®ï¼Œè¦†ç›–é˜¿é‡Œé›†å›¢å…¨ç³»ä¸šåŠ¡ä¸æ•°ç™¾ä¸‡äº‘ä¸Šå®¢æˆ·ã€‚æˆ‘ä»¬ç ”å‘çš„ LoongCollectorï¼ˆåŸ iLogtailï¼‰ä½œä¸ºå›½å†…å¹¿æ³›ä½¿ç”¨çš„å¼€æºäº‘åŸç”Ÿå¯è§‚æµ‹é‡‡é›†å™¨ï¼Œå·²åœ¨åƒä¸‡çº§å®ä¾‹ä¸Šç¨³å®šè¿è¡Œã€‚æˆ‘ä»¬æ·±åº¦æœåŠ¡äºå¤§æ¨¡å‹è®­ç»ƒã€RAGã€Agent åé¦ˆã€æ™ºèƒ½è¿ç»´ç­‰å‰æ²¿åœºæ™¯ã€‚æˆ‘ä»¬ä¸åªåšæ—è·¯ç›‘æ§ä¸è§‚æµ‹ï¼Œæˆ‘ä»¬åšçš„æ˜¯åŸºç¡€è®¾æ–½æœ¬èº«ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬æ­£åœ¨å¯»æ‰¾ä¸‰ä½çœŸæ­£çš„ç³»ç»Ÿå»ºç­‘å¸ˆï¼ŒåŠ å…¥è¿™åœºè¶…å¤§è§„æ¨¡ç³»ç»Ÿçš„æé™æŒ‘æˆ˜ã€‚å¦‚æœä½ æ›¾åœ¨ Linux å†…æ ¸å±‚ä¼˜åŒ–å†…å­˜ä¸ç½‘ç»œï¼Œæ›¾è®© SQL åœ¨åƒäº¿æ•°æ®ä¸Šæ¯«ç§’å“åº”ï¼Œæ›¾ç”¨å‘é‡æ£€ç´¢ä¸å€’æ’ç´¢å¼•æ”¯æ’‘ AI çš„è¯­ä¹‰ç†è§£ï¼Œæˆ–äº²æ‰‹æ„å»ºè¿‡ä¸€ä¸ªä¼šè‡ªæˆ‘è¿›åŒ–çš„ Agent æ•°æ®é—­ç¯â€”â€”é‚£ä¹ˆè¿™é‡Œå°±æ˜¯ä½ çš„æˆ˜åœºã€‚</p>
<h2 data-id="heading-0">å²—ä½ä¸€ï¼šäº‘åŸç”Ÿåº”ç”¨å¹³å° - AI Infra ç ”å‘å·¥ç¨‹å¸ˆï¼ˆP6~P8ï¼‰- æ­å·</h2>
<h3 data-id="heading-1">èŒè´£æ¦‚è¿°</h3>
<p>è´Ÿè´£é˜¿é‡Œé›†å›¢ã€é˜¿é‡Œäº‘å¯è§‚æµ‹æ•°æ®å¤„ç†åŸºç¡€è®¾æ–½å»ºè®¾ï¼Œæ‰“é€ æ—¥å¢ç™¾ PB çº§æ•°æ®çš„å®æ—¶æ•°æ®åˆ†æå¹³å°ã€‚é€šè¿‡å®æ—¶é‡‡é›†ã€ç´¢å¼•ã€å­˜å‚¨ã€å‹ç¼©ç­‰æŠ€æœ¯ï¼Œå®æ—¶å¤„ç†æ¥è‡ªåƒä¸‡è®¾å¤‡çš„æµ·é‡æ—¥å¿—æ•°æ®ï¼Œå¹¶é’ˆå¯¹ AI åº”ç”¨åœºæ™¯è¿›è¡Œç‰¹å®šä¼˜åŒ–ï¼Œæä¾›æ™ºèƒ½ã€è‡ªåŠ¨åŒ–æ•°æ®åˆ†ææœåŠ¡ã€‚</p>
<p>åŠ å…¥è¯¥å²—ä½ï¼Œæ‚¨å°†æœ‰æœºä¼šåœ¨å›½å†…è¶…å¤§è§„æ¨¡çš„å®æ—¶æ—¥å¿—å¹³å°ä¸Šï¼Œæ„å»ºå„ç§é¢å‘å„ç±» AI åº”ç”¨åœºæ™¯çš„æ•°æ®å­˜å‚¨å’Œå¤„ç†å¹³å°ï¼Œæ‰“é€ æ–°ä¸€ä»£çš„ AI åŸºç¡€è®¾æ–½ã€‚</p>
<h3 data-id="heading-2">ä¸»è¦èŒè´£</h3>
<ol>
<li>
<p>å‚ä¸é˜¿é‡Œäº‘æˆ˜ç•¥çº§äº§å“ SLS ç ”å‘ï¼Œå‚ä¸é¢å‘ AI åº”ç”¨åœºæ™¯çš„æ•°æ®é‡‡é›†ã€å¤„ç†ã€æŸ¥è¯¢åˆ†æç­‰åŠŸèƒ½å¼€å‘ä¸è®¾è®¡ï¼›</p>
</li>
<li>
<p>æ•°æ®ç´¢å¼•å’ŒæŸ¥è¯¢åˆ†æå¼•æ“ä¼˜åŒ–ï¼Œé€šè¿‡æ•°æ®ç¼–ç ã€å‹ç¼©ã€å‘é‡ã€å€’æ’ç´¢å¼•ã€SQL æ‰§è¡Œä¼˜åŒ–ã€CodeGen ç­‰å„ç±»æŠ€æœ¯ï¼Œå®ç°ç™¾~åƒäº¿æ•°æ®å®æ—¶æŸ¥è¯¢ç§’çº§å»¶æ—¶ï¼Œæä¾›æè‡´æŸ¥è¯¢ä½“éªŒï¼›</p>
</li>
<li>
<p>å‚ä¸ Agent æ•°æ®é£è½®çš„å»ºè®¾ï¼Œç ”å‘ç¨³å®šå¯é çš„ Agent è¿è¡Œæ—¶æ•°æ®åŸºç¡€è®¾æ–½ï¼›</p>
</li>
</ol>
<h3 data-id="heading-3">èŒä½è¦æ±‚</h3>
<ol>
<li>
<p>ç†Ÿæ‚‰ AI é¢†åŸŸï¼Œå¯¹äº AI åº”ç”¨æ•°æ®ç‰¹å¾ï¼Œæ•°æ®å­˜å‚¨å’ŒæŸ¥è¯¢éœ€æ±‚æœ‰æ·±å…¥ç†è§£ï¼›</p>
</li>
<li>
<p>æ·±å…¥ç†è§£ LLM åŸç†ï¼Œäº†è§£ä¸Šä¸‹æ–‡å·¥ç¨‹ã€KV Cache æœºåˆ¶åŠ Prompt ä¼˜åŒ–ç­–ç•¥ï¼Œç†Ÿæ‚‰ Agent Memoryã€RAG ç›¸å…³æŠ€æœ¯ï¼Œæœ‰å®æˆ˜ç»éªŒæ›´ä½³ï¼›</p>
</li>
<li>
<p>åœ¨é«˜æ€§èƒ½æ•°æ®ç»“æ„ã€æ•°æ®ç¼–ç å‹ç¼©ã€å‘é‡ï¼ˆVector Searchï¼‰ã€å€’æ’ç´¢å¼•ï¼ˆInverted Indexï¼‰ã€æ··åˆæ£€ç´¢ï¼ˆHybrid Searchï¼‰ç®—æ³•ä¸Šæ·±å…¥ç ”ç©¶ï¼Œç†Ÿæ‚‰åˆ†å¸ƒå¼ SQL ä¼˜å…ˆï¼›</p>
</li>
<li>
<p>é«˜æ€§èƒ½ç½‘ç»œæœåŠ¡å™¨ç¼–ç¨‹ç»éªŒï¼Œç†Ÿæ‚‰å¼‚æ­¥ IOã€å†…å­˜ç®¡ç†ã€å¤šçº¿ç¨‹åŒæ­¥ç­‰æŠ€æœ¯ï¼Œæœ‰ Linux å†…æ ¸ç ”ç©¶ç»éªŒæ›´ä½³ï¼›</p>
</li>
<li>
<p>å¯¹æŠ€æœ¯æœ‰å¼ºçƒˆçš„è¿›å–å¿ƒï¼Œæœ‰è¾ƒå¼ºçš„å­¦ä¹ èƒ½åŠ›ï¼Œä¿æŒå¯¹å‰æ²¿æŠ€æœ¯çš„å…³æ³¨å’Œå­¦ä¹ ï¼›</p>
</li>
<li>
<p>å…·æœ‰è‰¯å¥½çš„æ²Ÿé€šèƒ½åŠ›å’Œå›¢é˜Ÿåˆä½œç²¾ç¥ã€ä¼˜ç§€çš„é—®é¢˜åˆ†æå’Œè§£å†³èƒ½åŠ›ï¼›</p>
</li>
<li>
<p>ä¼˜å…ˆï¼šå¯¹ Luceneã€LevelDBã€Influxdbã€TokuDBã€kuduã€LanceDB æºä»£ç æ·±å…¥ç ”ç©¶è€…ï¼›</p>
</li>
<li>
<p>ä¼˜å…ˆï¼šæœ‰ TB~PB çº§æ•°æ® OLTP/OLAP ç»éªŒè€…ï¼›å¤§å‹ç³»ç»Ÿè‡ªåŠ¨åŒ–è¿ç»´ç®¡ç†å¼€å‘ç»éªŒã€‚</p>
</li>
</ol>
<p>æŠ•é€’é“¾æ¥ Aï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fcareers.aliyun.com%2Foff-campus%2Fposition-detail%3Flang%3Dzh%26positionId%3D100002183001%26trace%3Dqrcode_share" target="_blank" title="https://careers.aliyun.com/off-campus/position-detail?lang=zh&amp;positionId=100002183001&amp;trace=qrcode_share" ref="nofollow noopener noreferrer">careers.aliyun.com/off-campus/â€¦</a></p>
<p>æŠ•é€’é“¾æ¥ Bï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fcareers.aliyun.com%2Foff-campus%2Fposition-detail%3Flang%3Dzh%26positionId%3D2009283001%26trace%3Dqrcode_share" target="_blank" title="https://careers.aliyun.com/off-campus/position-detail?lang=zh&amp;positionId=2009283001&amp;trace=qrcode_share" ref="nofollow noopener noreferrer">careers.aliyun.com/off-campus/â€¦</a></p>
<h2 data-id="heading-4">å²—ä½äºŒï¼šäº‘åŸç”Ÿåº”ç”¨å¹³å° - å¯è§‚æµ‹åŸºç¡€å¹³å°é«˜çº§ç ”å‘å·¥ç¨‹å¸ˆ - ä¸Šæµ·</h2>
<h3 data-id="heading-5">èŒè´£æ¦‚è¿°</h3>
<p>è´Ÿè´£é˜¿é‡Œé›†å›¢ã€é˜¿é‡Œäº‘å¯è§‚æµ‹æ•°æ®å¤„ç†åŸºç¡€è®¾æ–½å»ºè®¾ï¼Œæ‰“é€ æ—¥å¢ç™¾ PB çº§æ•°æ®çš„å®æ—¶æ•°æ®åˆ†æå¹³å°ã€‚é€šè¿‡å®æ—¶é‡‡é›†ã€ç´¢å¼•ã€å­˜å‚¨ã€å‹ç¼©ç­‰æŠ€æœ¯ï¼Œå®æ—¶å¤„ç†æ¥è‡ªåƒä¸‡è®¾å¤‡çš„æµ·é‡æ—¥å¿—æ•°æ®ï¼Œå¹¶é’ˆå¯¹ AI åº”ç”¨åœºæ™¯è¿›è¡Œç‰¹å®šä¼˜åŒ–ï¼Œæä¾›æ™ºèƒ½ã€è‡ªåŠ¨åŒ–æ•°æ®åˆ†ææœåŠ¡ã€‚</p>
<p>åŠ å…¥è¯¥å²—ä½ï¼Œæ‚¨å°†æœ‰æœºä¼šåœ¨å›½å†…è¶…å¤§è§„æ¨¡çš„å®æ—¶æ—¥å¿—å¹³å°ä¸Šï¼Œæ„å»ºé¢å‘å„ç±» AI åº”ç”¨åœºæ™¯çš„æ•°æ®å­˜å‚¨å’Œå¤„ç†å¹³å°ï¼Œæ‰“é€ æ–°ä¸€ä»£çš„ AI åŸºç¡€è®¾æ–½ã€‚</p>
<h3 data-id="heading-6">ä¸»è¦èŒè´£</h3>
<ol>
<li>
<p>å‚ä¸é˜¿é‡Œäº‘æˆ˜ç•¥çº§äº§å“ SLS ç ”å‘ï¼Œå‚ä¸é¢å‘ AI åº”ç”¨åœºæ™¯çš„æ•°æ®é‡‡é›†ã€å¤„ç†ã€æŸ¥è¯¢åˆ†æç­‰åŠŸèƒ½å¼€å‘ä¸è®¾è®¡ã€‚</p>
</li>
<li>
<p>å‚ä¸åƒä¸‡çº§å®ä¾‹ã€æ•°ç™¾ PB æµé‡çš„äº‘åŸç”Ÿå¯è§‚æµ‹é‡‡é›†å™¨ LoongCollector/iLogtail åŠç®¡æ§ç³»ç»Ÿå¼€å‘ï¼Œæ‰“é€ äº‘ä¸Šç»Ÿä¸€çš„ OneAgent èƒ½åŠ›ï¼ŒæœåŠ¡äºæ—¥å¿—ã€æŒ‡æ ‡ã€eBPFã€ä¸»æœºç›‘æ§ã€å®‰å…¨ç­‰å¤šç§åœºæ™¯ï¼›ä¸»å¯¼ LoongCollector å¼€æºæŠ€æœ¯è·¯çº¿ï¼Œæ¨åŠ¨é‡‡é›†è¡Œä¸šæ ‡å‡†å»ºç«‹ã€‚</p>
</li>
<li>
<p>æ·±åº¦å‚ä¸å¹¶æ‰“é€ é«˜æ€§èƒ½ã€é«˜å¯é çš„æ•°æ®é‡‡é›†ä¸ç®¡æ§ç³»ç»Ÿï¼Œæ·±å…¥åº•å±‚ä¼˜åŒ–ï¼Œæå‡ç½‘ç»œã€å†…å­˜å’Œ CPU ç­‰å…³é”®èµ„æºçš„åˆ©ç”¨æ•ˆç‡ã€‚</p>
</li>
<li>
<p>é¢å‘ AI åº”ç”¨æ„å»ºé«˜æ€§èƒ½ã€å®‰å…¨çš„å¤šæ¨¡æ€æ•°æ®å¤„ç†ä¸æ•°æ®é›†ç®¡ç†å¹³å°ï¼Œå‚ä¸ä¸Šä¸‹æ¸¸ AI ç”Ÿæ€å»ºè®¾ã€‚</p>
</li>
</ol>
<h3 data-id="heading-7">èŒä½è¦æ±‚</h3>
<ol>
<li>
<p>æ‰å®çš„ç®—æ³•åŸºç¡€å’Œè‰¯å¥½çš„ç¼–ç ä¹ æƒ¯ï¼Œç²¾é€š C++ã€Javaã€Goã€Python ä¸­ä»»ä½•ä¸€é—¨è¯­è¨€ã€‚</p>
</li>
<li>
<p>åœ¨é«˜æ€§èƒ½æ•°æ®ç»“æ„ã€æ•°æ®ç¼–ç å‹ç¼©ã€å‘é‡æ„å»ºç­‰æœ‰æ·±å…¥ç ”ç©¶ï¼›ç†Ÿæ‚‰å¼‚æ­¥ IOã€å†…å­˜ç®¡ç†ã€å¤šçº¿ç¨‹åŒæ­¥ç­‰æŠ€æœ¯ï¼Œæœ‰ Linux å†…æ ¸ç ”ç©¶ç»éªŒæ›´ä½³ã€‚</p>
</li>
<li>
<p>ç†è§£åˆ†å¸ƒå¼ç³»ç»Ÿï¼ŒåŒ…æ‹¬è°ƒåº¦ã€åˆ†å¸ƒå¼é”ã€è´Ÿè½½å‡è¡¡ç­‰ã€‚</p>
</li>
<li>
<p>å¯¹æŠ€æœ¯æœ‰å¼ºçƒˆçš„è¿›å–å¿ƒï¼Œæœ‰è¾ƒå¼ºçš„å­¦ä¹ èƒ½åŠ›ï¼Œä¿æŒå¯¹å‰æ²¿æŠ€æœ¯çš„å…³æ³¨å’Œå­¦ä¹ ã€‚</p>
</li>
<li>
<p>å…·æœ‰è‰¯å¥½çš„æ²Ÿé€šèƒ½åŠ›å’Œå›¢é˜Ÿåˆä½œç²¾ç¥ã€ä¼˜ç§€çš„é—®é¢˜åˆ†æå’Œè§£å†³èƒ½åŠ›ã€‚</p>
</li>
<li>
<p>ç†Ÿæ‚‰ LLMã€Prompt è®¾è®¡ã€Agent æ¡†æ¶ï¼ˆå¦‚ LangGraphã€Difyã€AutoGenã€Google ADKã€å·¥å…·é“¾é›†æˆç­‰ï¼‰è€…ä¼˜å…ˆã€‚</p>
</li>
<li>
<p>å¯¹ LoongCollectorã€OpenTelemetryã€Fluentbitã€Vectorã€Tetragonã€Falco æºä»£ç æœ‰æ·±å…¥ç ”ç©¶è€…ä¼˜å…ˆã€‚</p>
</li>
</ol>
<p>æŠ•é€’é“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fcareers.aliyun.com%2Foff-campus%2Fposition-detail%3Flang%3Dzh%26positionId%3D100002203001%26trace%3Dqrcode_share" target="_blank" title="https://careers.aliyun.com/off-campus/position-detail?lang=zh&amp;positionId=100002203001&amp;trace=qrcode_share" ref="nofollow noopener noreferrer">careers.aliyun.com/off-campus/â€¦</a></p>
<p>è¿™ä¸åªæ˜¯ä¸€ä»½æ™®é€šçš„æŠ€æœ¯å·¥ä½œã€‚ä½ å†™çš„æ¯ä¸€è¡Œä»£ç ï¼Œéƒ½å°†è¿è¡Œåœ¨æœ€å¤æ‚çš„çœŸå®åœºæ™¯ä¸­ï¼Œå½±å“æ•´ä¸ªé˜¿é‡Œäº‘çš„ç¨³å®šæ€§ï¼Œå¹¶é€šè¿‡äº‘è®¡ç®—è¾å°„åƒè¡Œç™¾ä¸šã€‚ä½ å‚ä¸å®šä¹‰çš„æŠ€æœ¯è·¯å¾„ï¼Œå¯èƒ½æˆä¸ºä¸‹ä¸€ä»£äº‘åŸç”Ÿæ ‡å‡†ï¼›ä½ æ‰“ç£¨çš„æ•°æ®åŸºåº§ï¼Œå°†æˆä¸ºä¸­å›½ AI è‡ªåŠ¨åŒ–èƒ½åŠ›çš„èµ·ç‚¹ã€‚æˆ‘ä»¬åœ¨æ­å·ã€ä¸Šæµ·å¼€æ”¾å²—ä½ã€‚å¦‚æœä½ å‡†å¤‡å¥½äº†ï¼Œè¯·åŠ å…¥æˆ‘ä»¬ï¼Œä¸€èµ·å»ºé€  AI æ—¶ä»£æœ€é‡è¦çš„æ•°æ®åŸºç¡€è®¾æ–½ã€‚</p>
<p>ç‚¹å‡»<a href="https://link.juejin.cn?target=https%3A%2F%2Fcareers.aliyun.com%2Foff-campus%2Fposition-detail%3Flang%3Dzh%26positionId%3D100002203001%26trace%3Dqrcode_share" target="_blank" title="https://careers.aliyun.com/off-campus/position-detail?lang=zh&amp;positionId=100002203001&amp;trace=qrcode_share" ref="nofollow noopener noreferrer">æ­¤å¤„</a>ç«‹å³æŠ•é€’~</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[containerdçš„CPUè¿‡é«˜çš„é—®é¢˜æ’æŸ¥]]></title>    <link>https://juejin.cn/post/7587740546954854440</link>    <guid>https://juejin.cn/post/7587740546954854440</guid>    <pubDate>2025-12-26T09:48:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587740546954854440" data-draft-id="7587776610436055055" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="containerdçš„CPUè¿‡é«˜çš„é—®é¢˜æ’æŸ¥"/> <meta itemprop="keywords" content="å®¹å™¨,Kubernetes,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2025-12-26T09:48:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="liuxuzxx"/> <meta itemprop="url" content="https://juejin.cn/user/465848660687336"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            containerdçš„CPUè¿‡é«˜çš„é—®é¢˜æ’æŸ¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/465848660687336/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    liuxuzxx
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T09:48:51.000Z" title="Fri Dec 26 2025 09:48:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ¦‚è¿°</h2>
<p>å‘ç°çº¿ä¸‹ä¸€å°k8sçš„nodeçš„containerdçš„CPUåŸºæœ¬åœ¨95%-130%ä¹‹é—´æ¥å›æµ®åŠ¨ï¼Œçœ‹åˆ°åˆ«çš„nodeçš„containerdçš„CPUå ç”¨ç‡åŸºæœ¬éƒ½åœ¨20%ä»¥ä¸‹ï¼Œæˆ–è€…æ˜¯åŸºæœ¬ä¸Šæ˜¯:1%-5%çš„æ ·å­.</p>
<h2 data-id="heading-1">æ’æŸ¥è¿‡ç¨‹</h2>
<h3 data-id="heading-2">å®šä½CPUè¿‡é«˜çš„è¿›ç¨‹</h3>
<ol>
<li>ä½¿ç”¨topå‘½ä»¤æŸ¥çœ‹å‘ç°containerdçš„CPUå±…é«˜ä¸ä¸‹ï¼ŒåŸºæœ¬ä¸Šåœ¨100%---120%ä¹‹é—´æµ®åŠ¨</li>
<li>ä½¿ç”¨pidstatå‘½ä»¤ä»”ç»†æŸ¥çœ‹</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">linux &gt; pidstat -p 1163 1 <span class="hljs-comment">#æŠ“å–1163è¿›ç¨‹ï¼ŒæŒ‰ç…§1sçš„é—´éš”æ‰“å°CPUæ¶ˆè€—</span>

33åˆ†27ç§’   UID       PID    %usr %system  %guest   %<span class="hljs-built_in">wait</span>    %CPU   CPU  Command
33åˆ†28ç§’     0      1163   68.00   56.00    0.00    0.00  124.00     2  containerd
33åˆ†29ç§’     0      1163   46.00   49.00    0.00    0.00   95.00     2  containerd
33åˆ†30ç§’     0      1163    1.00    1.00    0.00    0.00    2.00     2  containerd
33åˆ†31ç§’     0      1163    4.00    1.00    0.00    0.00    5.00     2  containerd
33åˆ†32ç§’     0      1163    1.00    1.00    0.00    0.00    2.00     2  containerd
33åˆ†33ç§’     0      1163    4.00    3.00    0.00    0.00    7.00     2  containerd
33åˆ†34ç§’     0      1163   58.00   60.00    0.00    0.00  118.00     2  containerd
33åˆ†35ç§’     0      1163   56.00   58.00    0.00    0.00  114.00     2  containerd
33åˆ†36ç§’     0      1163   59.00   57.00    0.00    0.00  116.00     2  containerd
33åˆ†37ç§’     0      1163   59.00   60.00    0.00    0.00  119.00     2  containerd
33åˆ†38ç§’     0      1163   69.00   57.00    0.00    0.00  126.00     2  containerd
33åˆ†39ç§’     0      1163   50.00   49.00    0.00    0.00   99.00     2  containerd
33åˆ†40ç§’     0      1163    2.00    1.00    0.00    0.00    3.00     2  containerd
33åˆ†41ç§’     0      1163    3.00    1.00    0.00    0.00    4.00     2  containerd
33åˆ†42ç§’     0      1163    1.00    1.00    0.00    0.00    2.00     2  containerd
33åˆ†43ç§’     0      1163    3.00    2.00    0.00    0.00    5.00     2  containerd
33åˆ†44ç§’     0      1163   56.00   61.00    0.00    0.00  117.00     2  containerd
33åˆ†45ç§’     0      1163   60.00   58.00    0.00    0.00  118.00     2  containerd
33åˆ†46ç§’     0      1163   57.00   60.00    0.00    0.00  117.00     2  containerd
33åˆ†47ç§’     0      1163   55.00   63.00    0.00    0.00  118.00     2  containerd
33åˆ†48ç§’     0      1163   71.00   59.00    0.00    0.00  130.00     2  containerd
33åˆ†49ç§’     0      1163   51.00   50.00    0.00    0.00  101.00     2  containerd
33åˆ†50ç§’     0      1163    1.00    1.00    0.00    0.00    2.00     2  containerd
33åˆ†51ç§’     0      1163    4.00    2.00    0.00    0.00    6.00     2  containerd
33åˆ†52ç§’     0      1163    2.00    1.00    0.00    0.00    3.00     2  containerd
33åˆ†53ç§’     0      1163    3.00    3.00    0.00    0.00    6.00     2  containerd
33åˆ†54ç§’     0      1163   58.00   60.00    0.00    0.00  118.00     2  containerd


<span class="hljs-comment">#1.å…¶å®è¾“å‡ºçš„æ˜¯:14æ—¶33åˆ†xxç§’æ ¼å¼ï¼Œä¸ºäº†ä¸æ¢è¡Œï¼Œå»æ‰äº†:14æ—¶</span>
<span class="hljs-comment">#2.ä»è¾“å‡ºæ¥çœ‹ï¼ŒåŸºæœ¬ä¸Šéš”4-5sçš„æ—¶é—´ï¼Œå°±ä¼šå‡ºç°å¤§æ¦‚:6sçš„CPUè¿è¡Œåœ¨: 100%-120%ä¹‹é—´</span>
</code></pre>
<h3 data-id="heading-3">ä½¿ç”¨perfæŠ“å–å¯¹åº”è¿›ç¨‹çš„CPUé‡‡æ ·ä¿¡æ¯</h3>
<ol>
<li>åœ¨ç›®æ ‡nodeä¸Šæ‰§è¡Œperfå‘½ä»¤æŠ“å–å¯¹åº”pidçš„CPUçš„é‡‡æ ·ä¿¡æ¯</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">linux &gt; sudo perf record -F 99 -p 1179 -g -- <span class="hljs-built_in">sleep</span> 60

linux &gt; sudo perf script -i perf.data &gt; out.perf
</code></pre>
<ol start="2">
<li>å®‰è£…FlameGraph</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">linux &gt; git <span class="hljs-built_in">clone</span> https://github.com/brendangregg/FlameGraph.git
</code></pre>
<ol start="3">
<li>ç”Ÿæˆç«ç„°å›¾</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">linux &gt; <span class="hljs-built_in">cd</span> FlameGraph //[ä¸Šä¸€ä¸ªæ­¥éª¤git <span class="hljs-built_in">clone</span>çš„FlameGraphçš„ä»“åº“]
linux &gt; ./stackcollapse-perf.pl out.perf | ./flamegraph.pl &gt; flamegraph.svg
</code></pre>
<ol start="4">
<li>ç”Ÿæˆçš„CPUçš„ç«ç„°å›¾å¦‚ä¸‹</li>
</ol>

<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/67ea0bf278a64d45b55a99580f1ba324~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbGl1eHV6eHg=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767347331&amp;x-signature=mwAsSAMVB2A5cu%2BfIAzlIc5n7WE%3D" alt="" loading="lazy"/></p>
<ol start="5">
<li>åˆ†æè¿™ä¸ªç«ç„°å›¾èƒ½å¤Ÿå¾—åˆ°è€—è´¹CPUæœ€å¤šçš„åœ°æ–¹æ˜¯</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">os.Lstatè¿™ä¸ªç³»ç»Ÿè°ƒç”¨
</code></pre>
<h3 data-id="heading-4">æŸ¥æ‰¾containerdçš„æºç å¯¹åº”çš„æ“ä½œ</h3>
<ol>
<li>æŸ¥æ‰¾containerdå¯¹åº”çš„æºç çš„éƒ¨åˆ†</li>
</ol>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// DiskUsage counts the number of inodes and disk usage for the resources under</span>
<span class="hljs-comment">// path.</span>
<span class="hljs-comment">//çœ‹ä»£ç çš„æ„æ€æ˜¯è·å–ç£ç›˜çš„ä½¿ç”¨é‡</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">DiskUsage</span><span class="hljs-params">(ctx context.Context, roots ...<span class="hljs-type">string</span>)</span></span> (Usage, <span class="hljs-type">error</span>) {
	<span class="hljs-keyword">return</span> diskUsage(ctx, roots...)
}
</code></pre>
<ol start="2">
<li>æŒç»­è¿½è¸ªç³»ç»Ÿçš„è°ƒç”¨ä»£ç </li>
</ol>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">diskUsage</span><span class="hljs-params">(ctx context.Context, roots ...<span class="hljs-type">string</span>)</span></span> (Usage, <span class="hljs-type">error</span>) {
	...çœç•¥
	<span class="hljs-keyword">for</span> _, root := <span class="hljs-keyword">range</span> roots {
        <span class="hljs-comment">//é‡ç‚¹æ˜¯ä¸‹é¢è¿™å—:filepath.Walkè¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨</span>
		<span class="hljs-keyword">if</span> err := filepath.Walk(root, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(path <span class="hljs-type">string</span>, fi os.FileInfo, err <span class="hljs-type">error</span>)</span></span> <span class="hljs-type">error</span> {
			...çœç•¥
		}); 
	}

	...çœç•¥
}

<span class="hljs-comment">//ç»§ç»­å±•å¼€ä»£ç </span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Walk</span><span class="hljs-params">(root <span class="hljs-type">string</span>, fn WalkFunc)</span></span> <span class="hljs-type">error</span> {
	...çœç•¥
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		...çœç•¥
	} <span class="hljs-keyword">else</span> {
		err = walk(root, info, fn)
	}
    ...çœç•¥
}


<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">walk</span><span class="hljs-params">(path <span class="hljs-type">string</span>, info fs.FileInfo, walkFn WalkFunc)</span></span> <span class="hljs-type">error</span> {
	...çœç•¥
	<span class="hljs-keyword">for</span> _, name := <span class="hljs-keyword">range</span> names {
		...çœç•¥:ä¸‹é¢è¿™ä¸ª
		fileInfo, err := lstat(filename)
		...çœç•¥
	}
	<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
}


<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Lstat</span><span class="hljs-params">(name <span class="hljs-type">string</span>)</span></span> (FileInfo, <span class="hljs-type">error</span>) {
	testlog.Stat(name)
	<span class="hljs-keyword">return</span> lstatNolog(name)
}

...çœç•¥ä¸­é—´å¤šä¸ªè¿½è¸ªï¼Œæœ€ç»ˆç»“æœæ˜¯:

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">fstatat</span><span class="hljs-params">(fd <span class="hljs-type">int</span>, path <span class="hljs-type">string</span>, stat *Stat_t, flags <span class="hljs-type">int</span>)</span></span> (err <span class="hljs-type">error</span>) {
	<span class="hljs-keyword">var</span> _p0 *<span class="hljs-type">byte</span>
	_p0, err = BytePtrFromString(path)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span>
	}
	_, _, e1 := Syscall6(SYS_NEWFSTATAT, <span class="hljs-type">uintptr</span>(fd), <span class="hljs-type">uintptr</span>(unsafe.Pointer(_p0)), <span class="hljs-type">uintptr</span>(unsafe.Pointer(stat)), <span class="hljs-type">uintptr</span>(flags), <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)
	<span class="hljs-keyword">if</span> e1 != <span class="hljs-number">0</span> {
		err = errnoErr(e1)
	}
	<span class="hljs-keyword">return</span>
}

#å¯ä»¥çœ‹åˆ°ç³»ç»Ÿè°ƒç”¨çš„æ–¹æ³•æ˜¯:sys_newfstatatè¿™ä¸ª
</code></pre>
<h3 data-id="heading-5">ä½¿ç”¨bpftraceæŠ“å–è°ƒç”¨ç»†èŠ‚</h3>
<ol>
<li>å®‰è£…bpftrace(è‡ªè¡Œå®‰è£…)</li>
<li>æä¾›bpftraceçš„è„šæœ¬</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment">#1179æ˜¯nodeçš„containerdçš„è¿›ç¨‹çš„id</span>
tracepoint:syscalls:sys_enter_newfstatat {
    <span class="hljs-keyword">if</span> (pid == 1179) {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"1179 filename: %s, flag: %d\n"</span>, str(args-&gt;filename,100), args-&gt;flag);
    }
}

<span class="hljs-comment">#ä¸Šé¢æ–‡ä»¶ä¿å­˜ä¸º:trace_lstat.bt</span>
</code></pre>
<ol start="3">
<li>æä¾›bashè„šæœ¬</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/sh</span>
<span class="hljs-built_in">export</span> BPFTRACE_MAX_STRLEN=200
bpftrace trace_lstat.bt

<span class="hljs-comment">#åŸå› æ˜¯ï¼Œéœ€è¦å¼•å…¥ä¸€ä¸ªBPFTRACE_MAX_STRLENçš„ç¯å¢ƒå˜é‡ï¼Œå› ä¸ºbpftraceçš„stræ–¹æ³•é»˜è®¤åªä¼šæ‰“å°100çš„é•¿åº¦å¥½åƒï¼Œä½†æ˜¯éœ€è¦é€šè¿‡è¿™ä¸ªæ¥è®¾ç½®æ‰è¡Œ</span>
</code></pre>
<ol start="4">
<li>çœ‹ä¸‹è¾“å‡ºçš„æ•°æ®ä¿¡æ¯</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">...çœç•¥
1179 filename: /var/lib/containerd/io.containerd.snapshotter.v1.overlayfs/snapshots/43491/fs/home/cpaas/xxl-job/202, flag: 256
1179 filename: /var/lib/containerd/io.containerd.snapshotter.v1.overlayfs/snapshots/43491/fs/home/cpaas/xxl-job/202, flag: 256
1179 filename: /var/lib/containerd/io.containerd.snapshotter.v1.overlayfs/snapshots/43491/fs/home/cpaas/xxl-job/202, flag: 256
1179 filename: /var/lib/containerd/io.containerd.snapshotter.v1.overlayfs/snapshots/43491/fs/home/cpaas/xxl-job/202, flag: 256
1179 filename: /var/lib/containerd/io.containerd.snapshotter.v1.overlayfs/snapshots/43491/fs/home/cpaas/xxl-job/202, flag: 256
1179 filename: /var/lib/containerd/io.containerd.snapshotter.v1.overlayfs/snapshots/43491/fs/home/cpaas/xxl-job/202, flag: 256
1179 filename: /var/lib/containerd/io.containerd.snapshotter.v1.overlayfs/snapsho
...çœç•¥

åˆ†æä¸‹å°±æ˜¯å¦‚ä¸‹çš„ç»“æœ:
1. è¿™ä¸ªæ–‡ä»¶æ€»å…±380562è¡Œ
linux &gt; <span class="hljs-comment"># find /var/lib/containerd/io.containerd.snapshotter.v1.overlayfs -type f|wc -l</span>

<span class="hljs-comment">#è¾“å‡ºçš„æ–‡ä»¶ä¸ªæ•°</span>
1104159


é‚£ä¹ˆåŸºæœ¬èƒ½å¤Ÿç¡®å®šé—®é¢˜å‡ºåœ¨è¿™ä¸ªåœ°æ–¹äº†
</code></pre>
<ol start="5">
<li>è¿›å…¥ç›®å½•æŸ¥æ‰¾å¯¹åº”çš„æ–‡ä»¶ä¸ªæ•°</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment">#ä½¿ç”¨AIæä¾›çš„å¦‚ä¸‹çš„bashè„šæœ¬è¿›è¡Œç»Ÿè®¡æ–‡ä»¶ä¸ªæ•°</span>

<span class="hljs-comment">#!/bin/bash</span>

<span class="hljs-comment"># æŒ‡å®šæ ¹ç›®å½•</span>
root_dir=<span class="hljs-string">"/var/lib/containerd/io.containerd.snapshotter.v1.overlayfs/snapshots"</span>

<span class="hljs-comment"># éå†æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰å­æ–‡ä»¶å¤¹</span>
<span class="hljs-keyword">for</span> <span class="hljs-built_in">dir</span> <span class="hljs-keyword">in</span> <span class="hljs-string">"<span class="hljs-variable">$root_dir</span>"</span>/*/; <span class="hljs-keyword">do</span>
    <span class="hljs-comment"># å»é™¤è·¯å¾„æœ«å°¾çš„æ–œæ </span>
    <span class="hljs-built_in">dir</span>=<span class="hljs-variable">${dir%/}</span>
    <span class="hljs-comment"># æå–å­æ–‡ä»¶å¤¹åç§°</span>
    folder_name=$(<span class="hljs-built_in">basename</span> <span class="hljs-string">"<span class="hljs-variable">$dir</span>"</span>)
    <span class="hljs-comment"># ä½¿ç”¨ find å‘½ä»¤ç»Ÿè®¡æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶æ•°é‡</span>
    file_count=$(find <span class="hljs-string">"<span class="hljs-variable">$dir</span>"</span> -<span class="hljs-built_in">type</span> f | <span class="hljs-built_in">wc</span> -l)
    <span class="hljs-comment"># æ£€æŸ¥æ–‡ä»¶æ•°é‡æ˜¯å¦å¤§äº 10000</span>
    <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$file_count</span> -gt 10000 ]; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$folder_name</span>: <span class="hljs-variable">$file_count</span> ä¸ªæ–‡ä»¶"</span>
    <span class="hljs-keyword">fi</span>
<span class="hljs-keyword">done</span>


<span class="hljs-comment">#1.è¾“å‡ºç»“æœå¦‚ä¸‹:ç»Ÿè®¡æ–‡ä»¶ä¸ªæ•° &gt; 10000çš„(1w)</span>
83674: 21389 ä¸ªæ–‡ä»¶
85266: 16118 ä¸ªæ–‡ä»¶
85333: 22828 ä¸ªæ–‡ä»¶
85932: 11998 ä¸ªæ–‡ä»¶
86634: 430300 ä¸ªæ–‡ä»¶
86635: 430193 ä¸ªæ–‡ä»¶

</code></pre>
<ol start="6">
<li>æ‰¾åˆ°å¦‚ä¸‹çš„æ–‡ä»¶å¤¹çš„ä¸ªæ•°å¾ˆå¤š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">linux &gt; find /var/lib/containerd/io.containerd.snapshotter.v1.overlayfs/snapshots/86634/fs/home/export-import-server/xxl-job -<span class="hljs-built_in">type</span> f|<span class="hljs-built_in">wc</span> -l
430842

</code></pre>
<ol start="7">
<li>åˆ†æä¸‹è¿™ä¸ªä¸‹é¢çš„æ–‡ä»¶ä¸ªæ•°ç»Ÿè®¡</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment">#è¿˜æ˜¯ä¸Šé¢ 6 æ­¥éª¤çš„bashç»Ÿè®¡è„šæœ¬ï¼Œåªæ˜¯æ¢ä¸‹root_urlå³å¯ï¼Œå¾—åˆ°çš„ç»“æœä¸º</span>
2025-03-22: 55409 ä¸ªæ–‡ä»¶
2025-03-23: 103679 ä¸ªæ–‡ä»¶
2025-03-24: 103680 ä¸ªæ–‡ä»¶
2025-03-25: 103330 ä¸ªæ–‡ä»¶
2025-03-26: 64412 ä¸ªæ–‡ä»¶
</code></pre>
<ol start="8">
<li>éšä¾¿è¿›å…¥ä¸€ä¸ªæ–‡ä»¶å¤¹æŸ¥çœ‹ä¸‹,çœ‹åˆ°éƒ½æ˜¯xxl-jobçš„æ—¥å¿—ã€‚å› ä¸ºxxl-jobæ¯æ¬¡æ‰§è¡Œéƒ½ä¼šäº§ç”Ÿä¸€ä¸ªå¾ˆå°çš„æ—¥å¿—æ–‡ä»¶ï¼Œå¦‚æœä»»åŠ¡å¤šï¼Œå¹¶ä¸”ä»»åŠ¡é¢‘ç¹(ä¾‹å¦‚5ä¸ªä»»åŠ¡ï¼Œç„¶åæ¯ä¸ªä»»åŠ¡5sæ‰§è¡Œä¸€æ¬¡ï¼Œé‚£ä¹ˆæ¯å¤©å°±æ˜¯:86400).çœ‹ä¸Šé¢ç«Ÿç„¶10wå¤šçš„æ—¥å¿—æ–‡ä»¶ä¸ªæ•°ï¼Œä¼°è®¡ä»»åŠ¡æ›´å¤šæ›´é¢‘ç¹.</li>
<li>æ‰‹åŠ¨æ‰§è¡Œä¸‹æ¸…ç†å‰é¢å‡ å¤©çš„æ—¥å¿—å³å¯ï¼Œä¸è¿‡åº”ç”¨ç¨‹åºä¹Ÿè¦ä½œå‡ºæ”¹åŠ¨ï¼Œæ˜¾ç¤ºæ—¥å¿—äº§ç”Ÿçš„ä¸ªæ•°ä»¥åŠä¿ç•™çš„æ—¶é—´</li>
<li>æ¸…ç†xxl-jobçš„è¿‡æœŸæ— ç”¨çš„æ—¥å¿—æ–‡ä»¶ä¹‹åï¼ŒæŸ¥çœ‹containerdè¿›ç¨‹æ¶ˆè€—çš„CPU</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">[root@h-172-16-15-144-DEV-k8s-node fs]<span class="hljs-comment"># pidstat -p 1163 1</span>
Linux 5.14.0-479.el9.x86_64 (h-172-16-15-144-DEV-k8s-node) 	2025å¹´03æœˆ26æ—¥ 	_x86_64_	(16 CPU)

13åˆ†21ç§’   UID       PID    %usr %system  %guest   %<span class="hljs-built_in">wait</span>    %CPU   CPU  Command
13åˆ†22ç§’     0      1163    9.00    1.00    0.00    0.00   10.00     2  containerd
13åˆ†23ç§’     0      1163    0.00    1.00    0.00    0.00    1.00     2  containerd
13åˆ†24ç§’     0      1163    8.00    9.00    0.00    0.00   17.00     2  containerd
13åˆ†25ç§’     0      1163    3.00    1.00    0.00    0.00    4.00     2  containerd
13åˆ†26ç§’     0      1163    1.00    1.00    0.00    0.00    2.00     2  containerd
13åˆ†27ç§’     0      1163    2.00    1.00    0.00    0.00    3.00     2  containerd
13åˆ†28ç§’     0      1163    1.00    1.00    0.00    0.00    2.00     2  containerd
13åˆ†29ç§’     0      1163    1.00    0.00    0.00    0.00    1.00     2  containerd
13åˆ†30ç§’     0      1163    0.00    1.00    0.00    0.00    1.00     2  containerd
13åˆ†31ç§’     0      1163   10.00    0.00    0.00    0.00   10.00     2  containerd
13åˆ†32ç§’     0      1163    2.00    1.00    0.00    0.00    3.00     2  containerd
13åˆ†33ç§’     0      1163    0.00    0.00    0.00    0.00    0.00     2  containerd
13åˆ†34ç§’     0      1163    9.00    9.00    0.00    0.00   18.00     2  containerd
13åˆ†35ç§’     0      1163    1.00    1.00    0.00    0.00    2.00     2  containerd
13åˆ†36ç§’     0      1163    0.00    0.00    0.00    0.00    0.00     2  containerd
13åˆ†37ç§’     0      1163    1.00    1.00    0.00    0.00    2.00     2  containerd
13åˆ†38ç§’     0      1163    1.00    0.00    0.00    0.00    1.00     2  containerd
13åˆ†39ç§’     0      1163    3.00    1.00    0.00    0.00    4.00     2  containerd
13åˆ†40ç§’     0      1163    0.00    1.00    0.00    0.00    1.00     2  containerd
13åˆ†41ç§’     0      1163   11.00    1.00    0.00    0.00   12.00     2  containerd
13åˆ†42ç§’     0      1163    1.00    0.00    0.00    0.00    1.00     2  containerd
13åˆ†43ç§’     0      1163    0.00    0.00    0.00    0.00    0.00     2  containerd
13åˆ†44ç§’     0      1163    8.00   10.00    0.00    0.00   18.00     2  containerd
13åˆ†45ç§’     0      1163    0.00    0.00    0.00    0.00    0.00     2  containerd
13åˆ†46ç§’     0      1163    1.00    0.00    0.00    0.00    1.00     2  containerd
13åˆ†47ç§’     0      1163   11.00    2.00    0.00    0.00   13.00     2  containerd
13åˆ†48ç§’     0      1163    0.00    0.00    0.00    0.00    0.00     2  containerd
13åˆ†49ç§’     0      1163    3.00    2.00    0.00    0.00    5.00     2  containerd
13åˆ†50ç§’     0      1163    1.00    0.00    0.00    0.00    1.00     2  containerd
13åˆ†51ç§’     0      1163    1.00    0.00    0.00    0.00    1.00     2  containerd
13åˆ†52ç§’     0      1163    2.00    1.00    0.00    0.00    3.00     2  containerd
13åˆ†53ç§’     0      1163    0.00    1.00    0.00    0.00    1.00     2  containerd
13åˆ†54ç§’     0      1163   18.00    9.00    0.00    0.00   27.00     2  containerd
13åˆ†55ç§’     0      1163    2.00    1.00    0.00    0.00    3.00     2  containerd
13åˆ†56ç§’     0      1163    2.00    2.00    0.00    0.00    4.00     2  containerd
13åˆ†57ç§’     0      1163    1.00    1.00    0.00    0.00    2.00     2  containerd
13åˆ†58ç§’     0      1163    0.00    0.00    0.00    0.00    0.00     2  containerd
13åˆ†59ç§’     0      1163    2.00    1.00    0.00    0.00    3.00     2  containerd
14åˆ†00ç§’     0      1163    1.00    0.00    0.00    0.00    1.00     2  containerd

<span class="hljs-comment">#å¯ä»¥çœ‹åˆ°CPUé™ä¸‹æ¥äº†ï¼Œæœ€é«˜æ‰27%</span>
</code></pre>
<h3 data-id="heading-6">åŸå› åˆ†æ</h3>
<ol>
<li>ç”±äºcontainerdå¼€å¯äº†ä¸€ä¸ªå®šæ—¶ä»»åŠ¡å»è·å–è‡ªå·±ç®¡è¾–çš„ç£ç›˜çš„ä½¿ç”¨å¤§å°:å°±æ˜¯DiskUsageæ–¹æ³•</li>
<li>ç„¶åéœ€è¦è°ƒç”¨ç³»ç»Ÿè°ƒç”¨çš„newfstatatè¿›è¡Œç»Ÿè®¡</li>
<li>ç„¶åç”±äºæ–‡ä»¶ä¸ªæ•°å¤ªå¤šäº†ï¼Œå¯¼è‡´éå¸¸è€—è´¹CPU</li>
<li>è¿™ä¸ªæ–‡ä»¶å¾ˆå¤šçš„snapshotsä¸‹é¢æœ‰å¾ˆå¤špodçš„containerå†™çš„æ—¥å¿—ï¼Œxxl-jobçš„æ—¥å¿—ï¼Œäº§ç”Ÿäº†å‡ ç™¾ä¸‡ä¸ªï¼Œæ–‡ä»¶å¾ˆå°ï¼Œä½†æ˜¯æ–‡ä»¶ä¸ªæ•°å¾ˆå¤šï¼Œæ²¡æœ‰åŠæ—¶çš„æ¸…ç†ï¼Œå¯¼è‡´containerdæ¯æ¬¡æ‰«æéƒ½éå¸¸è€—è´¹CPU</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JSå¤æ‚å»é‡ä¸€å®šè¦å…ˆæ’åºå—ï¼Ÿæ·±åº¦è§£æä¸æ€§èƒ½å¯¹æ¯”]]></title>    <link>https://juejin.cn/post/7588002126258110470</link>    <guid>https://juejin.cn/post/7588002126258110470</guid>    <pubDate>2025-12-26T09:53:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588002126258110470" data-draft-id="7587995707165442067" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JSå¤æ‚å»é‡ä¸€å®šè¦å…ˆæ’åºå—ï¼Ÿæ·±åº¦è§£æä¸æ€§èƒ½å¯¹æ¯”"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-26T09:53:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Fronty"/> <meta itemprop="url" content="https://juejin.cn/user/588993964030574"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JSå¤æ‚å»é‡ä¸€å®šè¦å…ˆæ’åºå—ï¼Ÿæ·±åº¦è§£æä¸æ€§èƒ½å¯¹æ¯”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/588993964030574/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Fronty
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T09:53:34.000Z" title="Fri Dec 26 2025 09:53:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h4 data-id="heading-0">å¼•è¨€</h4>
<p>åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæ•°ç»„å»é‡æ˜¯JavaScriptä¸­å¸¸è§çš„æ“ä½œã€‚å¯¹äºç®€å•æ•°æ®ç±»å‹ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šæ¯«ä¸çŠ¹è±«åœ°ä½¿ç”¨Setã€‚ä½†å½“é¢å¯¹å¤æ‚å¯¹è±¡æ•°ç»„æ—¶ï¼Œå¾ˆå¤šå¼€å‘è€…ä¼šäº§ç”Ÿç–‘é—®ï¼šå¤æ‚å»é‡ä¸€å®šè¦å…ˆæ’åºå—ï¼Ÿ</p>
<p>è¿™ä¸ªé—®é¢˜èƒŒåå…¶å®éšè—ç€å‡ ä¸ªæ›´æ·±å±‚æ¬¡çš„è€ƒé‡:</p>
<ul>
<li>æ’åºæ˜¯å¦ä¼šå½±å“åŸå§‹æ•°æ®é¡ºåºï¼Ÿ</li>
<li>æ’åºçš„æ€§èƒ½å¼€é”€æ˜¯å¦å€¼å¾—ï¼Ÿ</li>
<li>æ˜¯å¦æœ‰æ›´ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆï¼Ÿ</li>
</ul>
<h4 data-id="heading-1">1. å¸¸è§çš„æ’åºå»é‡æ–¹æ¡ˆ</h4>
<h5 data-id="heading-2">1.1 ä¼ ç»Ÿçš„æ’åºå»é‡æ€è·¯</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å…ˆæ’åºåå»é‡çš„ç»å…¸å†™æ³•</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">sortThenUnique</span>(<span class="hljs-params">arr, key</span>) {
  <span class="hljs-keyword">return</span> arr
    .<span class="hljs-title function_">slice</span>()
    .<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> {
      <span class="hljs-comment">// é¿å…ä¿®æ”¹åŸå§‹æ•°ç»„</span>
      <span class="hljs-keyword">const</span> valueA = key ? a[key] : a;
      <span class="hljs-keyword">const</span> valueB = key ? b[key] : b;
      <span class="hljs-keyword">if</span> (valueA &lt; valueB) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
      <span class="hljs-keyword">if</span> (valueA &gt; valueB) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    })
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">item, index, array</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (index === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// ä¿ç•™ç¬¬ä¸€ä¸ªå…ƒç´ </span>
      <span class="hljs-keyword">const</span> value = key ? item[key] : item;
      <span class="hljs-keyword">const</span> prevValue = key ? array[index - <span class="hljs-number">1</span>][key] : array[index - <span class="hljs-number">1</span>];
      <span class="hljs-keyword">return</span> value !== prevValue; <span class="hljs-comment">// ä»…ä¿ç•™ä¸å‰ä¸€ä¸ªå…ƒç´ ä¸åŒçš„å…ƒç´ </span>
    });
}
</code></pre>
<h5 data-id="heading-3">1.2 æ’åºå»é‡çš„ä¼˜ç¼ºç‚¹</h5>
<p><strong>ä¼˜ç‚¹:</strong></p>
<ul>
<li>ä»£ç é€»è¾‘ç›¸å¯¹ç›´è§‚</li>
<li>å¯¹äºå·²æ’åºæˆ–éœ€è¦æ’åºçš„æ•°æ®ï¼Œå¯ä»¥ä¸€æ­¥å®Œæˆ</li>
<li>åœ¨æŸäº›ç®—æ³•é¢˜ä¸­å¯èƒ½æ˜¯å¿…è¦æ­¥éª¤</li>
</ul>
<p><strong>ç¼ºç‚¹:</strong></p>
<ul>
<li>æ—¶é—´å¤æ‚åº¦è‡³å°‘ä¸º O(n log n)</li>
<li>æ”¹å˜äº†åŸå§‹æ•°æ®çš„é¡ºåº</li>
<li>å¯¹äºä¸éœ€è¦æ’åºçš„åœºæ™¯æ˜¯é¢å¤–å¼€é”€</li>
</ul>
<h4 data-id="heading-4">2. ä¸æ’åºçš„å»é‡æ–¹æ¡ˆ</h4>
<h5 data-id="heading-5">2.1 åŸºäºMapçš„ä¿æŒé¡ºåºæ–¹æ¡ˆ</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">uniqueByKey</span>(<span class="hljs-params">arr, key</span>) {
  <span class="hljs-keyword">const</span> seen = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
  <span class="hljs-keyword">const</span> result = [];

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> arr) {
    <span class="hljs-keyword">const</span> keyValue = item[key];
    <span class="hljs-keyword">if</span> (!seen.<span class="hljs-title function_">has</span>(keyValue)) {
      seen.<span class="hljs-title function_">set</span>(keyValue, <span class="hljs-literal">true</span>);
      result.<span class="hljs-title function_">push</span>(item);
    }
  }
  <span class="hljs-keyword">return</span> result;
}

<span class="hljs-comment">// æ”¯æŒå¤šä¸ªå­—æ®µçš„å¤åˆé”®</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">uniqueByMultipleKeys</span>(<span class="hljs-params">arr, keys</span>) {
  <span class="hljs-keyword">const</span> seen = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();
  <span class="hljs-keyword">return</span> arr.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> compositeKey = keys.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> item[key]).<span class="hljs-title function_">join</span>(<span class="hljs-string">"|"</span>);
    <span class="hljs-keyword">if</span> (seen.<span class="hljs-title function_">has</span>(compositeKey)) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    seen.<span class="hljs-title function_">add</span>(compositeKey);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  });
}
</code></pre>
<h5 data-id="heading-6">2.2 åŸºäºå¯¹è±¡çš„ç¼“å­˜æ–¹æ¡ˆ</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">uniqueByKeyWithObject</span>(<span class="hljs-params">arr, key</span>) {
  <span class="hljs-keyword">const</span> cache = {};
  <span class="hljs-keyword">return</span> arr.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> keyValue = item[key];
    <span class="hljs-keyword">if</span> (cache[keyValue]) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    cache[keyValue] = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  });
}
</code></pre>
<h5 data-id="heading-7">2.3 åŸºäºè‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°çš„æ–¹æ¡ˆ</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">uniqueWithCustomComparator</span>(<span class="hljs-params">arr, comparator</span>) {
  <span class="hljs-keyword">return</span> arr.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">current, index, self</span>) =&gt;</span> {
    <span class="hljs-comment">// æŸ¥æ‰¾ç¬¬ä¸€ä¸ªç›¸åŒå…ƒç´ çš„ä½ç½®</span>
    <span class="hljs-keyword">return</span> self.<span class="hljs-title function_">findIndex</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> <span class="hljs-title function_">comparator</span>(item, current)) === index;
  });
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> users = [
  { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> },
  { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Bob"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> },
  { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> }, <span class="hljs-comment">// é‡å¤</span>
  { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">26</span> }, <span class="hljs-comment">// IDç›¸åŒä½†å¹´é¾„ä¸åŒ</span>
];

<span class="hljs-keyword">const</span> uniqueUsers = <span class="hljs-title function_">uniqueWithCustomComparator</span>(
  users,
  <span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a.<span class="hljs-property">id</span> === b.<span class="hljs-property">id</span> &amp;&amp; a.<span class="hljs-property">name</span> === b.<span class="hljs-property">name</span>
);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(uniqueUsers);
<span class="hljs-comment">// [ { id: 1, name: 'Alice', age: 25 }, { id: 2, name: 'Bob', age: 30 } ]</span>
</code></pre>
<h4 data-id="heading-8">3. æ€§èƒ½å¯¹æ¯”åˆ†æ</h4>
<h5 data-id="heading-9">3.1 æ—¶é—´å¤æ‚åº¦å¯¹æ¯”</h5>



































<table><thead><tr><th align="left">æ–¹æ³•</th><th align="left">æ—¶é—´å¤æ‚åº¦</th><th align="left">ç©ºé—´å¤æ‚åº¦</th><th align="left">æ˜¯å¦ä¿æŒé¡ºåº</th></tr></thead><tbody><tr><td align="left">æ’åºåå»é‡</td><td align="left">O(n log n)</td><td align="left">O(1) æˆ– O(n)</td><td align="left">å¦</td></tr><tr><td align="left">Mapå»é‡</td><td align="left">O(n)</td><td align="left">O(n)</td><td align="left">æ˜¯</td></tr><tr><td align="left">å¯¹è±¡ç¼“å­˜å»é‡</td><td align="left">O(n)</td><td align="left">O(n)</td><td align="left">æ˜¯</td></tr><tr><td align="left">filter + findIndex</td><td align="left">O(nÂ²)</td><td align="left">O(1)</td><td align="left">æ˜¯</td></tr></tbody></table>
<h5 data-id="heading-10">3.2 å®é™…æ€§èƒ½æµ‹è¯•</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ€§èƒ½æµ‹è¯•ä»£ç ç¤ºä¾‹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">generateTestData</span>(<span class="hljs-params">count</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({<span class="hljs-attr">length</span>: count}, <span class="hljs-function">(<span class="hljs-params">_, i</span>) =&gt;</span> ({
    <span class="hljs-attr">id</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * count / <span class="hljs-number">10</span>), <span class="hljs-comment">// äº§ç”Ÿå¤§é‡é‡å¤</span>
    <span class="hljs-attr">value</span>: <span class="hljs-string">`item-<span class="hljs-subst">${i}</span>`</span>,
    <span class="hljs-attr">data</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>()
  }));
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">runPerformanceTest</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> data = <span class="hljs-title function_">generateTestData</span>(<span class="hljs-number">10000</span>);
  
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'Mapå»é‡'</span>);
  <span class="hljs-title function_">uniqueByKey</span>(data, <span class="hljs-string">'id'</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'Mapå»é‡'</span>);
  
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'æ’åºå»é‡'</span>);
  <span class="hljs-title function_">sortThenUnique</span>(data, <span class="hljs-string">'id'</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'æ’åºå»é‡'</span>);
  
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'filter+findIndex'</span>);
  <span class="hljs-title function_">uniqueWithCustomComparator</span>(data, <span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a.<span class="hljs-property">id</span> === b.<span class="hljs-property">id</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'filter+findIndex'</span>);
}
</code></pre>
<p><strong>æµ‹è¯•ç»“æœè¶‹åŠ¿:</strong></p>
<ul>
<li>æ•°æ®é‡&lt;1000ï¼šå„ç§æ–¹æ³•å·®å¼‚ä¸å¤§</li>
<li>æ•°æ®é‡1000-10000ï¼šMapæ–¹æ¡ˆæ˜æ˜¾å ä¼˜</li>
<li>æ•°æ®é‡&gt;10000ï¼šæ’åºæ–¹æ¡ˆå¼€å§‹æ˜¾ç°åŠ£åŠ¿</li>
</ul>
<h4 data-id="heading-11">4. åº”ç”¨åœºæ™¯ä¸é€‰æ‹©å»ºè®®</h4>
<h5 data-id="heading-12">4.1 ä»€ä¹ˆæ—¶å€™åº”è¯¥è€ƒè™‘æ’åºï¼Ÿ</h5>
<h6 data-id="heading-13">1.éœ€è¦æœ‰åºè¾“å‡ºæ—¶</h6>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ—¢è¦å»é‡åˆè¦æŒ‰ç‰¹å®šå­—æ®µæ’åº</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">getSortedUniqueUsers</span> = (<span class="hljs-params">users</span>) =&gt; {
  <span class="hljs-keyword">const</span> uniqueUsers = <span class="hljs-title function_">uniqueByKey</span>(users, <span class="hljs-string">'id'</span>);
  <span class="hljs-keyword">return</span> uniqueUsers.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a.<span class="hljs-property">name</span>.<span class="hljs-title function_">localeCompare</span>(b.<span class="hljs-property">name</span>));
};
</code></pre>
<h6 data-id="heading-14">2. æ•°æ®æœ¬èº«å°±éœ€è¦æ’åºæ—¶</h6>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¦‚æœä¸šåŠ¡æœ¬æ¥å°±éœ€è¦æ’åºï¼Œå¯ä»¥åˆå¹¶æ“ä½œ</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">processData</span> = (<span class="hljs-params">data</span>) =&gt; {
  <span class="hljs-comment">// å…ˆæ’åºä¾¿äºåç»­å¤„ç†</span>
  data.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a.<span class="hljs-property">timestamp</span> - b.<span class="hljs-property">timestamp</span>);
  <span class="hljs-comment">// å»é‡</span>
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">uniqueByKey</span>(data, <span class="hljs-string">'id'</span>);
};
</code></pre>
<h6 data-id="heading-15">3.å¤„ç†æµå¼æ•°æ®æ—¶</h6>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å®æ—¶æ•°æ®æµï¼Œéœ€è¦ç»´æŒæœ‰åºçŠ¶æ€</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SortedUniqueCollection</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">key</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">key</span> = key;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">seen</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();
  }
  
  <span class="hljs-title function_">add</span>(<span class="hljs-params">item</span>) {
    <span class="hljs-keyword">const</span> keyValue = item[<span class="hljs-variable language_">this</span>.<span class="hljs-property">key</span>];
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">seen</span>.<span class="hljs-title function_">has</span>(keyValue)) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">seen</span>.<span class="hljs-title function_">add</span>(keyValue);
      <span class="hljs-comment">// æ’å…¥åˆ°æ­£ç¡®ä½ç½®ç»´æŒæœ‰åº</span>
      <span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">while</span> (index &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">length</span> &amp;&amp; 
             <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>[index][<span class="hljs-variable language_">this</span>.<span class="hljs-property">key</span>] &lt; keyValue) {
        index++;
      }
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">0</span>, item);
    }
  }
}
</code></pre>
<h5 data-id="heading-16">4.2 ä»€ä¹ˆæ—¶å€™åº”è¯¥é¿å…æ’åºï¼Ÿ</h5>
<h6 data-id="heading-17">1.éœ€è¦ä¿æŒåŸå§‹é¡ºåºæ—¶</h6>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ—¥å¿—è®°å½•ã€æ—¶é—´çº¿æ•°æ®ç­‰</span>
<span class="hljs-keyword">const</span> logEntries = [
  {<span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">time</span>: <span class="hljs-string">'10:00'</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'å¯åŠ¨'</span>},
  {<span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">time</span>: <span class="hljs-string">'10:01'</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'åˆå§‹åŒ–'</span>},
  {<span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">time</span>: <span class="hljs-string">'10:02'</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'å¯åŠ¨'</span>}, <span class="hljs-comment">// é‡å¤</span>
  {<span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">time</span>: <span class="hljs-string">'10:03'</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'è¿è¡Œ'</span>}
];

<span class="hljs-comment">// ä¿æŒæ—¶é—´é¡ºåºå¾ˆé‡è¦ï¼</span>
<span class="hljs-keyword">const</span> uniqueLogs = <span class="hljs-title function_">uniqueByKey</span>(logEntries, <span class="hljs-string">'id'</span>);
</code></pre>
<h6 data-id="heading-18">2.æ€§èƒ½æ•æ„Ÿçš„åº”ç”¨</h6>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å®æ—¶æ¸²æŸ“å¤§é‡æ•°æ®</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">renderItems</span>(<span class="hljs-params">items</span>) {
  <span class="hljs-comment">// ä½¿ç”¨Mapå»é‡é¿å…ä¸å¿…è¦çš„æ’åºå¼€é”€</span>
  <span class="hljs-keyword">const</span> uniqueItems = <span class="hljs-title function_">uniqueByKey</span>(items, <span class="hljs-string">'id'</span>);
  <span class="hljs-comment">// å¿«é€Ÿæ¸²æŸ“</span>
  <span class="hljs-keyword">return</span> uniqueItems.<span class="hljs-title function_">map</span>(renderItem);
}
</code></pre>
<h6 data-id="heading-19">3. æ•°æ®ä¸å¯å˜è¦æ±‚</h6>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// React/Vueç­‰æ¡†æ¶ä¸­ï¼Œé¿å…æ”¹å˜åŸæ•°ç»„</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">DeduplicatedList</span> = (<span class="hljs-params">{ items }</span>) =&gt; {
  <span class="hljs-comment">// ä¸æ”¹å˜åŸå§‹æ•°æ®</span>
  <span class="hljs-keyword">const</span> uniqueItems = <span class="hljs-title function_">useMemo</span>(
    <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">uniqueByKey</span>(items, <span class="hljs-string">'id'</span>),
    [items]
  );
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">List</span> <span class="hljs-attr">items</span>=<span class="hljs-string">{uniqueItems}</span> /&gt;</span></span>;
};
</code></pre>
<h4 data-id="heading-20">5. é«˜çº§æŠ€å·§å’Œä¼˜åŒ–</h4>
<h5 data-id="heading-21">5.1 æƒ°æ€§å»é‡è¿­ä»£å™¨</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span>* <span class="hljs-title function_">uniqueIterator</span>(<span class="hljs-params">arr, getKey</span>) {
  <span class="hljs-keyword">const</span> seen = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> arr) {
    <span class="hljs-keyword">const</span> key = <span class="hljs-title function_">getKey</span>(item);
    <span class="hljs-keyword">if</span> (!seen.<span class="hljs-title function_">has</span>(key)) {
      seen.<span class="hljs-title function_">add</span>(key);
      <span class="hljs-keyword">yield</span> item;
    }
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> data = [...]; <span class="hljs-comment">// å¤§æ•°æ®é›†</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> <span class="hljs-title function_">uniqueIterator</span>(data, <span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> x.<span class="hljs-property">id</span>)) {
  <span class="hljs-comment">// é€ä¸ªå¤„ç†ï¼ŒèŠ‚çœå†…å­˜</span>
  <span class="hljs-title function_">processItem</span>(item);
}
</code></pre>
<h5 data-id="heading-22">5.2 å¢é‡å»é‡</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">IncrementalDeduplicator</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">key</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">key</span> = key;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">seen</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> = <span class="hljs-number">0</span>;
  }
  
  <span class="hljs-title function_">add</span>(<span class="hljs-params">items</span>) {
    <span class="hljs-keyword">return</span> items.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> keyValue = item[<span class="hljs-variable language_">this</span>.<span class="hljs-property">key</span>];
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">seen</span>.<span class="hljs-title function_">has</span>(keyValue)) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      }
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">seen</span>.<span class="hljs-title function_">set</span>(keyValue, ++<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>); <span class="hljs-comment">// è®°å½•æ·»åŠ é¡ºåº</span>
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    });
  }
  
  <span class="hljs-title function_">getAddedOrder</span>(<span class="hljs-params">keyValue</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">seen</span>.<span class="hljs-title function_">get</span>(keyValue);
  }
}
</code></pre>
<h5 data-id="heading-23">5.3 å†…å­˜ä¼˜åŒ–ç‰ˆæœ¬</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">memoryEfficientUnique</span>(<span class="hljs-params">arr, key</span>) {
  <span class="hljs-keyword">const</span> seen = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
  <span class="hljs-keyword">const</span> result = [];
  
  <span class="hljs-comment">// ä½¿ç”¨WeakMapå¤„ç†å¯¹è±¡é”®</span>
  <span class="hljs-keyword">const</span> weakMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakMap</span>();
  
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; arr.<span class="hljs-property">length</span>; i++) {
    <span class="hljs-keyword">const</span> item = arr[i];
    <span class="hljs-keyword">const</span> keyValue = item[key];
    
    <span class="hljs-comment">// å¯¹äºå¯¹è±¡ç±»å‹çš„é”®å€¼ï¼Œä½¿ç”¨WeakMap</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> keyValue === <span class="hljs-string">'object'</span> &amp;&amp; keyValue !== <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">if</span> (!weakMap.<span class="hljs-title function_">has</span>(keyValue)) {
        weakMap.<span class="hljs-title function_">set</span>(keyValue, <span class="hljs-literal">true</span>);
        result.<span class="hljs-title function_">push</span>(item);
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (!seen.<span class="hljs-title function_">has</span>(keyValue)) {
        seen.<span class="hljs-title function_">set</span>(keyValue, <span class="hljs-literal">true</span>);
        result.<span class="hljs-title function_">push</span>(item);
      }
    }
  }
  
  <span class="hljs-keyword">return</span> result;
}
</code></pre>
<h4 data-id="heading-24">6. å®æˆ˜æ¡ˆä¾‹åˆ†æ</h4>
<h5 data-id="heading-25">6.1 ç”µå•†å•†å“å»é‡</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åœºæ™¯ï¼šåˆå¹¶å¤šä¸ªæ¥æºçš„å•†å“æ•°æ®</span>
<span class="hljs-keyword">const</span> productsFromAPI = [...];
<span class="hljs-keyword">const</span> productsFromCache = [...];
<span class="hljs-keyword">const</span> userUploadedProducts = [...];

<span class="hljs-comment">// éœ€æ±‚ï¼šæŒ‰å•†å“SKUå»é‡ï¼Œä¿æŒæœ€æ–°æ•°æ®</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">mergeProducts</span>(<span class="hljs-params">productLists</span>) {
  <span class="hljs-keyword">const</span> merged = [];
  <span class="hljs-keyword">const</span> skuMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
  
  <span class="hljs-comment">// æŒ‰ä¼˜å…ˆçº§å¤„ç†ï¼ˆåå¤„ç†çš„ä¼˜å…ˆçº§é«˜ï¼‰</span>
  productLists.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">list</span> =&gt;</span> {
    list.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">product</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> existing = skuMap.<span class="hljs-title function_">get</span>(product.<span class="hljs-property">sku</span>);
      <span class="hljs-keyword">if</span> (!existing || product.<span class="hljs-property">updatedAt</span> &gt; existing.<span class="hljs-property">updatedAt</span>) {
        <span class="hljs-keyword">if</span> (existing) {
          <span class="hljs-comment">// ç§»é™¤æ—§çš„</span>
          <span class="hljs-keyword">const</span> index = merged.<span class="hljs-title function_">findIndex</span>(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> p.<span class="hljs-property">sku</span> === product.<span class="hljs-property">sku</span>);
          merged.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
        }
        merged.<span class="hljs-title function_">push</span>(product);
        skuMap.<span class="hljs-title function_">set</span>(product.<span class="hljs-property">sku</span>, product);
      }
    });
  });
  
  <span class="hljs-keyword">return</span> merged;
}
</code></pre>
<h5 data-id="heading-26">6.2 å®æ—¶æ¶ˆæ¯å»é‡</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åœºæ™¯ï¼šèŠå¤©åº”ç”¨æ¶ˆæ¯å»é‡</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MessageDeduplicator</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">timeWindow = <span class="hljs-number">5000</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">timeWindow</span> = timeWindow;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">messageIds</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">timestamps</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
  }
  
  <span class="hljs-title function_">addMessage</span>(<span class="hljs-params">message</span>) {
    <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    <span class="hljs-keyword">const</span> { id } = message;
    
    <span class="hljs-comment">// æ¸…ç†è¿‡æœŸè®°å½•</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cleanup</span>(now);
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦é‡å¤</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">messageIds</span>.<span class="hljs-title function_">has</span>(id)) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    
    <span class="hljs-comment">// æ·»åŠ æ–°è®°å½•</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">messageIds</span>.<span class="hljs-title function_">add</span>(id);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">timestamps</span>.<span class="hljs-title function_">set</span>(id, now);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }
  
  <span class="hljs-title function_">cleanup</span>(<span class="hljs-params">now</span>) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [id, timestamp] <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">timestamps</span>) {
      <span class="hljs-keyword">if</span> (now - timestamp &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">timeWindow</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">messageIds</span>.<span class="hljs-title function_">delete</span>(id);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">timestamps</span>.<span class="hljs-title function_">delete</span>(id);
      }
    }
  }
}
</code></pre>
<h4 data-id="heading-27">ç»“è®º</h4>
<p>å›åˆ°æœ€åˆçš„é—®é¢˜ï¼šJSå¤æ‚å»é‡ä¸€å®šè¦å…ˆæ’åºå—ï¼Ÿ</p>
<p>ç­”æ¡ˆæ˜¯å¦å®šçš„ã€‚ æ’åºåªæ˜¯ä¼—å¤šå»é‡ç­–ç•¥ä¸­çš„ä¸€ç§ï¼Œè€Œéå¿…éœ€æ­¥éª¤ã€‚</p>
<p><strong>æˆ‘çš„å»ºè®®:</strong></p>
<ol>
<li><strong>é»˜è®¤ä½¿ç”¨Mapæ–¹æ¡ˆ:</strong> å¯¹äºå¤§å¤šæ•°åœºæ™¯ï¼ŒåŸºäºMapæˆ–Setçš„å»é‡æ–¹æ³•åœ¨æ€§èƒ½å’ŒåŠŸèƒ½ä¸Šéƒ½æ˜¯æœ€ä½³é€‰æ‹©ã€‚</li>
<li><strong>æ ¹æ®éœ€æ±‚é€‰æ‹©:</strong></li>
</ol>
<ul>
<li>éœ€è¦ä¿æŒé¡ºåº â†’ ä½¿ç”¨Map</li>
<li>éœ€è¦æ’åºç»“æœ â†’ å…ˆæ’åºæˆ–åæ’åº</li>
<li>æ•°æ®é‡å¾ˆå¤§ â†’ è€ƒè™‘è¿­ä»£å™¨æˆ–æµå¼å¤„ç†</li>
<li>å†…å­˜æ•æ„Ÿ â†’ ä½¿ç”¨WeakMapæˆ–å®šæœŸæ¸…ç†</li>
</ul>
<ol start="3">
<li><strong>è€ƒè™‘å¯è¯»æ€§å’Œç»´æŠ¤æ€§:</strong> æœ‰æ—¶æ¸…æ™°çš„ä»£ç æ¯”å¾®å°çš„æ€§èƒ½ä¼˜åŒ–æ›´é‡è¦ã€‚</li>
<li><strong>è¿›è¡Œå®é™…æµ‹è¯•:</strong> åœ¨æ€§èƒ½å…³é”®è·¯å¾„ä¸Šï¼Œç”¨çœŸå®æ•°æ®æµ‹è¯•ä¸åŒæ–¹æ¡ˆã€‚</li>
</ol>
<p><strong>å®è·µæ€»ç»“:</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é€šç”¨æ¨èæ–¹æ¡ˆ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">deduplicate</span>(<span class="hljs-params">arr, identifier = v =&gt; v</span>) {
  <span class="hljs-keyword">const</span> seen = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();
  <span class="hljs-keyword">return</span> arr.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> key = <span class="hljs-keyword">typeof</span> identifier === <span class="hljs-string">'function'</span> 
      ? <span class="hljs-title function_">identifier</span>(item)
      : item[identifier];
    
    <span class="hljs-keyword">if</span> (seen.<span class="hljs-title function_">has</span>(key)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    seen.<span class="hljs-title function_">add</span>(key);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  });
}

<span class="hljs-comment">// éœ€è¦æ’åºæ—¶çš„æ–¹æ¡ˆ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">deduplicateAndSort</span>(<span class="hljs-params">arr, key, sortBy</span>) {
  <span class="hljs-keyword">const</span> unique = <span class="hljs-title function_">deduplicate</span>(arr, key);
  <span class="hljs-keyword">return</span> unique.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> aVal = a[sortBy];
    <span class="hljs-keyword">const</span> bVal = b[sortBy];
    <span class="hljs-keyword">return</span> aVal &lt; bVal ? -<span class="hljs-number">1</span> : aVal &gt; bVal ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>;
  });
}
</code></pre>
<p>è®°ä½ï¼Œæ²¡æœ‰é“¶å¼¹ã€‚æœ€åˆé€‚çš„å»é‡æ–¹æ¡ˆå–å†³äºä½ çš„å…·ä½“éœ€æ±‚ï¼šæ•°æ®è§„æ¨¡ã€é¡ºåºè¦æ±‚ã€æ€§èƒ½éœ€æ±‚å’Œä»£ç ä¸Šä¸‹æ–‡ã€‚å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ åœ¨é¢å¯¹å¤æ‚å»é‡é—®é¢˜æ—¶åšå‡ºæ˜æ™ºçš„é€‰æ‹©ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[25å¹´AIæˆ‘å¾—DEMOè€å¸ˆ]]></title>    <link>https://juejin.cn/post/7587961565476831286</link>    <guid>https://juejin.cn/post/7587961565476831286</guid>    <pubDate>2025-12-26T08:30:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587961565476831286" data-draft-id="7587785079739236358" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="25å¹´AIæˆ‘å¾—DEMOè€å¸ˆ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,åç«¯"/> <meta itemprop="datePublished" content="2025-12-26T08:30:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†’æ³¡çš„è‚¥çš‚"/> <meta itemprop="url" content="https://juejin.cn/user/4353721774655677"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            25å¹´AIæˆ‘å¾—DEMOè€å¸ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4353721774655677/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†’æ³¡çš„è‚¥çš‚
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T08:30:27.000Z" title="Fri Dec 26 2025 08:30:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">AIååŠ©å†™ä»£ç ä¹‹å‰çš„éš¾é¢˜</h3>
<ul>
<li>é‡åˆ°é—®é¢˜å°±æ˜¯æœç´¢ç­›é€‰å¯èƒ½å¯¹å·çš„é—®é¢˜ï¼Œæœ‰ä¸€éƒ¨åˆ†æ˜¯å¯ä»¥è§£å†³çš„ï¼Œæœ‰ä¸€ä»½éƒ¨åˆ†åªèƒ½æ˜¯ä¸œæ‹¼è¥¿å‡‘åæ‰å¯ä»¥è§£å†³çš„ã€‚</li>
<li>ä¸å¤ªæƒ³çœ‹ä¸“ä¸šçš„ä¹¦ç±å»äº†è§£æŸä¸ªæƒ³çŸ¥é“çš„çŸ¥è¯†ç‚¹ã€‚æƒ³ç›´æ¥å®è·µå¼€å§‹å¯èƒ½æ²¡å¤´ç»ªã€‚</li>
<li>æƒ³äº†è§£å…¶ä»–ç¼–ç¨‹è¯­è¨€ï¼Œä¾‹å¦‚åç«¯æƒ³æä¸‹å‰ç«¯ï¼Œåè¿‡æ¥å‰ç«¯æƒ³æä¸‹åç«¯ï¼›éƒ½éœ€è¦å…ˆåœ¨ç½‘ä¸Šæ‰¾ã€‚</li>
<li>åŸºç¡€è€—æ—¶çš„äº‹æƒ…æ²¡æ³•æ‘†è„±ï¼Œå¯¹æ¥ä¸€ä¸ªæ¥å£å„ç§åŸºç¡€ç±»éœ€è¦å†™ã€‚</li>
</ul>
<h3 data-id="heading-1">ä»Šå¹´ç”¨AIä¸»è¦çš„å¸®åŠ©</h3>
<h4 data-id="heading-2">æœ€ç›´æ¥çš„æ˜¯å¸®æˆ‘å®šä½é—®é¢˜</h4>
<blockquote>
<p>å°è±¡æœ€æ·±çš„AIååŠ©å¤„ç†é—®é¢˜ï¼š</p>
</blockquote>
<ul>
<li>
<p>ä¹‹å‰æœ‰ä¸ªè€çš„æœåŠ¡ç«¯éœ€è¦æ”¯æŒè·¨åŸŸï¼Œä½†æ˜¯é‡Œé¢ç”¨äº†ä¸¤å¥—æ¡†æ¶ï¼Œåœ¨å†™è¿”å›è¯·æ±‚å¤´çš„æ—¶å€™æ€ä¹ˆå†™éƒ½ä¸è¡Œï¼Œç„¶åæŠŠä»£ç å‘ç»™äº†AIï¼Œç¥å¥‡çš„äº‹æƒ…æ˜¯ä»–å±…ç„¶æŒ‡å‡ºäº†é‡Œé¢ç”¨äº†ä¸¤å¥—æ¡†æ¶æ··ç€ç”¨çš„é—®é¢˜ï¼Œæœ€åé—®é¢˜ä¹Ÿé¡ºåˆ©è§£å†³äº†ã€‚</p>
</li>
<li>
<p>è¿˜æœ‰ä¸ªæ˜¯ä¸€ä¸ªå®¢æˆ·å‡çº§äº†è¯ä¹¦ï¼Œä¹‹å‰å†™çš„è€æ¥å£å› ä¸ºè¯ä¹¦é—®é¢˜å°±è°ƒä¸é€šäº†ï¼Œä¸€é¡¿ç‹‚é—®AIåç»™äº†å‡ ç§æ–¹æ¡ˆä½†æ˜¯éƒ½æ— æ•ˆï¼Œæœ€åè¯´è¦å‡çº§JDKï¼Œç„¶åå°±åœ¨ç½‘ä¸Šæ‰¾äº†ä¸ªæ–°ç‰ˆæœ¬çš„JDKå°±ä¼ åˆ°å®¢æˆ·æœåŠ¡å™¨ï¼ˆwin server 2012çš„ï¼‰ä¸Šï¼Œç„¶åå‘ç°å±…ç„¶JDKçš„versionå‘½ä»¤éƒ½ç”¨ä¸äº†ï¼ŒæŠ¥äº†æœ‰äº›dllä¸å­˜åœ¨ï¼Œç„¶ååˆæ˜¯ä¸€é¡¿ç‹‚é—®AIçš„å›ç­”ä¸­æœ‰ä¸ªè¡¥ä¸è¦å‡çº§ï¼Œå‡çº§äº†è¡¥ä¸éšåæ–°ç‰ˆJDKä¹Ÿå¯ä»¥ç”¨äº†ï¼Œè¿™è¦æ˜¯åœ¨ç½‘ä¸Šæœæ²¡ä¸ªä¸‰äº”å¤©æ—¶é—´æˆ‘æ˜¯æä¸å®šé—®é¢˜çš„ã€‚</p>
</li>
</ul>
<h4 data-id="heading-3">AIè®©æˆ‘å¿«é€Ÿäº†è§£äº†äº›çŸ¥è¯†ç‚¹</h4>
<blockquote>
<p>AIå¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿäº†è§£ç‚¹çŸ¥è¯†ç‚¹</p>
</blockquote>
<p>å› ä¸ºå¹´åˆçš„æ—¶å€™å†™äº†ä¸ªå€’æ’ç´¢å¼•çš„demoæ¶‰åŠäº†ç‚¹æ–‡ä»¶çš„è¯»å†™ï¼Œåé¢ç¢ç£¨è¿™èƒ½ä¸èƒ½å†äº†è§£ç‚¹ä¸œè¥¿ï¼Œåé¢å°±ç¢ç£¨è®©AIå†™ç‚¹demoã€‚åœ¨çŸ¥è¯†ç‚¹æ–¹é¢AIå¯ä»¥å¿«é€Ÿçš„ç»™å‡ºdemoï¼ˆè¿™é‡Œè¯´ä¸‹ä¸åŒAIç»™çš„æ•ˆæœæ˜¯ç”±ç‚¹å·®å¼‚çš„ï¼Œæ¯”å¦‚ä»£ç æ³¨é‡Šå·¥æ•´æ€§è¿˜åˆæµ‹è¯•ç”¨ä¾‹æ–¹é¢ï¼‰</p>
<ul>
<li>æ‰€ä»¥åé¢å°±è®©AIå†™äº†ä¸ª2PLçš„demoç„¶åè‡ªå·±ä¼˜åŒ–ä¼˜åŒ–ä»£ç å¤§æ¦‚æ‡‚äº†ç‚¹è¿™ä¸ªè§£å†³é”é—®é¢˜çš„åè®®ã€‚</li>
<li>å†åé¢åˆè®©AIå†™äº†ä¸ªç®€ç‰ˆçš„MVCCç‰ˆæœ¬æ§åˆ¶ï¼Œç„¶åè‡ªå·±å†æ”¹æ”¹è™½ç„¶æˆ‘å†™ä¸å‡ºæ¥B+æ ‘è¿™ç§æ•°æ®ç»“æ„ï¼Œä½†æ˜¯AIå¯ä»¥ç®€åŒ–å¾ˆå¤šä¸œè¥¿è®©æˆ‘ä»¬å»æ¥è§¦äº†è§£ä¸ªå¤§æ¦‚è‡³å°‘æ–¹å‘æ˜¯å¯¹çš„</li>
<li>åé¢åˆæƒ³äº†è§£ä¸‹raftåè®®ä¹Ÿè®©AIå†™äº†ä¸ªdemoï¼Œå¤§æ¦‚äº†è§£äº†ä¸‹æµç¨‹</li>
<li>è¿˜æœ‰ä¸ªé—®é¢˜ç°åœ¨ä½ æœ‰äº›ç–‘æƒ‘çš„æ—¶å€™ä½ å¯ä»¥å’ŒAIè¿›è¡Œè®¨è®ºä¸€é—®ä¸€ç­”æ„Ÿè§‰ä¹ŸæŒºä¸é”™çš„ï¼Œä¹‹å‰æƒ³æ‰¾å¤§ç‰›é—®çš„é—®é¢˜ç°åœ¨éƒ½å¯ä»¥å…ˆæ‰¾AIé—®é—®äº†ã€‚</li>
</ul>
<h3 data-id="heading-4">AIæ—¶ä»£æœ‰æƒ³æƒ³åŠ›å¾ˆé‡è¦</h3>
<p>AIæ˜¯ä¸ªç™¾ç§‘å…¨ä¹¦ï¼Œè™½ç„¶å¤§éƒ¨åˆ†é—®é¢˜æˆ‘ä»¬éƒ½å¯ä»¥é€šè¿‡AIæ¥å¤„ç†ï¼Œä½†æ˜¯äº‹æƒ…å¤„ç†çš„é€»è¾‘æ­¥éª¤æˆ‘ä»¬è¿˜æ˜¯è¦äº†è§£çš„ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”¨ä¸‰è¡Œä»£ç å®ç°åœ£è¯æ ‘ï¼Ÿåˆ«é€—äº†ï¼è®©æˆ‘ä»¬æ¥çœŸçš„]]></title>    <link>https://juejin.cn/post/7587322796825542696</link>    <guid>https://juejin.cn/post/7587322796825542696</guid>    <pubDate>2025-12-25T03:03:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587322796825542696" data-draft-id="7587342664077410319" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”¨ä¸‰è¡Œä»£ç å®ç°åœ£è¯æ ‘ï¼Ÿåˆ«é€—äº†ï¼è®©æˆ‘ä»¬æ¥çœŸçš„"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-25T03:03:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ— é™å¤§6"/> <meta itemprop="url" content="https://juejin.cn/user/2865758605422890"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”¨ä¸‰è¡Œä»£ç å®ç°åœ£è¯æ ‘ï¼Ÿåˆ«é€—äº†ï¼è®©æˆ‘ä»¬æ¥çœŸçš„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2865758605422890/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ— é™å¤§6
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T03:03:25.000Z" title="Thu Dec 25 2025 03:03:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;font-weight:400;line-height:2;font-size:17px;overflow-x:hidden;color:#000}.markdown-body strong{padding:1px;color:#ee3f4d}.markdown-body em{padding:0 2px;color:#f33b1f}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{position:relative;margin-top:30px;margin-bottom:20px;line-height:1.5;font-weight:700}.markdown-body h1{text-align:center;padding-bottom:5px;font-size:32px;color:#ac1f18}.markdown-body h1:after{content:"";display:block;margin:4px auto 0;width:100px;height:2px;border-bottom:2px solid #f33b1f}.markdown-body h2{font-size:28px;border-bottom:1px solid #f33b1f}.markdown-body h2:before{content:"# "!important;color:#f33b1f}.markdown-body h3{font-size:24px;padding-left:9px;border-left:6px solid #f33b1f}.markdown-body h4{font-size:20px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #bbb;margin:16px 0}.markdown-body code{word-break:break-word;overflow-x:auto;background-color:#f9f1db;color:#ee2746;border-radius:2px;font-size:16px;padding:1px 2px}.markdown-body code,.markdown-body pre{font-family:-apple-system,-apple-system-body,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,PingFang SC,æ€æºé»‘ä½“ CN,æ€æºé»‘ä½“,JetBrains Mono,Fira Code,Menlo,Ubuntu Mono,Consolas,sans-serif}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{margin:12px 0!important;border-radius:3px;font-size:15px;padding:16px 12px;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f7f7f7}.markdown-body a{text-decoration:none;color:#1781b5;padding:0 2px;border-bottom:1px solid #1781b5}.markdown-body a:active,.markdown-body a:hover{border-bottom:2px solid #f33b1f;color:#ac1f18}.markdown-body blockquote{color:#3d3d3d;background-color:#fff9f9;padding:6px 16px;margin:16px 0;border-left:3px solid #f07c82}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:6px 0}.markdown-body ol,.markdown-body ul{padding-left:30px}.markdown-body ol li,.markdown-body ul li{margin-bottom:6px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:6px}.markdown-body ol li{padding-left:6px}.markdown-body ::marker{color:#f33b1f}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body .task-list-item input[type=checkbox]{position:relative}.markdown-body .task-list-item input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:#fff;border:1px solid #f07c82;border-radius:3px;box-sizing:border-box;z-index:1}.markdown-body .task-list-item input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-5px;left:0;right:0;bottom:0;width:0;height:0;color:#f33b1f;font-size:16px;font-weight:700;z-index:2}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;border-spacing:0;border-collapse:collapse}.markdown-body table thead{background:#fff9f9;color:#000;text-align:left;font-size:15px}.markdown-body table tr:nth-child(2n){background-color:#fcfcfc}.markdown-body table tr:hover{background-color:#fff9f9}.markdown-body table td,.markdown-body table th{padding:12px 7px;line-height:24px;border:1px solid #f9f1db}.markdown-body table td{min-width:120px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="xcode">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff;color:#000}.xml .hljs-meta{color:silver}.hljs-comment,.hljs-quote{color:#007400}.hljs-attribute,.hljs-keyword,.hljs-literal,.hljs-name,.hljs-selector-tag,.hljs-tag{color:#aa0d91}.hljs-template-variable,.hljs-variable{color:#3f6e74}.hljs-code,.hljs-meta-string,.hljs-string{color:#c41a16}.hljs-link,.hljs-regexp{color:#0e0eff}.hljs-bullet,.hljs-number,.hljs-symbol,.hljs-title{color:#1c00cf}.hljs-meta,.hljs-section{color:#643820}.hljs-built_in,.hljs-builtin-name,.hljs-class .hljs-title,.hljs-params,.hljs-type{color:#5c2699}.hljs-attr{color:#836c28}.hljs-subst{color:#000}.hljs-formula{background-color:#eee;font-style:italic}.hljs-addition{background-color:#baeeba}.hljs-deletion{background-color:#ffc8bd}.hljs-selector-class,.hljs-selector-id{color:#9b703f}.hljs-doctag,.hljs-strong{font-weight:700}.hljs-emphasis{font-style:italic}</style><h2 data-id="heading-0">ğŸ„ ç”¨ä¸‰è¡Œä»£ç å®ç°åœ£è¯æ ‘ï¼Ÿåˆ«é€—äº†ï¼è®©æˆ‘ä»¬æ¥çœŸçš„ï¼</h2>
<h3 data-id="heading-1">ğŸŒŸ åœ£è¯èŠ‚çš„æ­£ç¡®æ‰“å¼€æ–¹å¼</h3>
<p>åœ£è¯èŠ‚å¿«åˆ°äº†ï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰å®¶é‡Œç¼ºäº†ç‚¹ä»€ä¹ˆï¼ŸğŸ… å¯¹ï¼Œå°±æ˜¯é‚£æ£µ bling bling çš„åœ£è¯æ ‘ï¼ä½†æ˜¯ä¹°çœŸæ ‘å¤ªéº»çƒ¦ï¼Œä¹°å‡æ ‘åˆæ²¡çµé­‚ï¼Ÿæ²¡å…³ç³»ï¼Œä»Šå¤©æˆ‘å°±æ•™ä½ ç”¨<strong>HTML+CSS+JS</strong>æ‰“é€ ä¸€æ£µå±äºä½ çš„ã€Œä»£ç åœ£è¯æ ‘ã€ï¼Œè®©ä½ çš„ç”µè„‘å±å¹•å……æ»¡èŠ‚æ—¥æ°”æ¯ï¼ğŸ</p>
<h3 data-id="heading-2">ğŸ› ï¸ å‡†å¤‡å·¥ä½œ</h3>
<p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å‡†å¤‡ï¼š</p>
<ul>
<li>ä¸€é¢—æƒ³æäº‹æƒ…çš„å¿ƒ ğŸ’¡</li>
<li>ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆè®°äº‹æœ¬ä¹Ÿè¡Œï¼Œä½†æˆ‘åŠä½ ç”¨ VS Codeï¼‰</li>
<li>ä¸€ç‚¹ HTML+CSS+JS åŸºç¡€</li>
<li>è¿˜æœ‰æ»¡è„‘å­çš„åœ£è¯ç²¾ç¥ ğŸ„</li>
</ul>
<h3 data-id="heading-3">ğŸ¨ å¼€å§‹åˆ¶ä½œåœ£è¯æ ‘</h3>
<h4 data-id="heading-4">ç¬¬ä¸€æ­¥ï¼šæ­å»ºéª¨æ¶ï¼ˆHTMLï¼‰</h4>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç»™åœ£è¯æ ‘æ­ä¸ªéª¨æ¶ã€‚å°±åƒç›–æˆ¿å­ä¸€æ ·ï¼Œå…ˆæ‰“åœ°åŸºï¼</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-CN"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>æˆ‘çš„ä»£ç åœ£è¯æ ‘ ğŸ„<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"style.css"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ğŸ… Merry Christmas! ğŸ„<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"tree"</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- åœ£è¯æ ‘çš„æ ‘å¹² --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"trunk"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- åœ£è¯æ ‘çš„æ ‘å† ï¼Œç”¨ä¸‰ä¸ªä¸‰è§’å½¢ç»„æˆ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"leaves leaves-1"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"leaves leaves-2"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"leaves leaves-3"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- åœ£è¯æ ‘ä¸Šçš„è£…é¥°å“ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"decorations"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- æ ‘é¡¶æ˜Ÿæ˜Ÿ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"star"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- é›ªèŠ±æ•ˆæœ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"snow"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- ç¤¼ç‰©ç›’ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"gifts"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"script.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h4 data-id="heading-5">ç¬¬äºŒæ­¥ï¼šåŒ–å¦†æ‰“æ‰®ï¼ˆCSSï¼‰</h4>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦ç»™åœ£è¯æ ‘ç©¿ä¸Šæ¼‚äº®çš„è¡£æœï¼è¿™ä¸€æ­¥å°±åƒå¥³æœ‹å‹åŒ–å¦†ï¼Œè¦ç»†å¿ƒï¼ğŸ’„</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* å…¨å±€æ ·å¼ */</span>
* {
  <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">box-sizing</span>: border-box;
}

<span class="hljs-selector-tag">body</span> {
  <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(to bottom, <span class="hljs-number">#1a1a2e</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#16213e</span> <span class="hljs-number">100%</span>);
  <span class="hljs-attribute">height</span>: <span class="hljs-number">100vh</span>;
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">justify-content</span>: center;
  <span class="hljs-attribute">align-items</span>: center;
  <span class="hljs-attribute">overflow</span>: hidden;
  <span class="hljs-attribute">font-family</span>: <span class="hljs-string">"Arial"</span>, sans-serif;
}

<span class="hljs-selector-class">.container</span> {
  <span class="hljs-attribute">text-align</span>: center;
  <span class="hljs-attribute">position</span>: relative;
}

<span class="hljs-comment">/* æ ‡é¢˜æ ·å¼ */</span>
<span class="hljs-selector-tag">h1</span> {
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">30px</span>;
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">2.5rem</span>;
  <span class="hljs-attribute">text-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">#ff0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">20px</span> <span class="hljs-number">#ff0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">30px</span> <span class="hljs-number">#ff0</span>;
  <span class="hljs-attribute">animation</span>: glow <span class="hljs-number">2s</span> ease-in-out infinite alternate;
}

<span class="hljs-comment">/* æ ‡é¢˜å‘å…‰åŠ¨ç”» */</span>
<span class="hljs-keyword">@keyframes</span> glow {
  <span class="hljs-selector-tag">from</span> {
    <span class="hljs-attribute">text-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">#ff0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">20px</span> <span class="hljs-number">#ff0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">30px</span> <span class="hljs-number">#ff0</span>;
  }
  <span class="hljs-selector-tag">to</span> {
    <span class="hljs-attribute">text-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">20px</span> <span class="hljs-number">#ff0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">30px</span> <span class="hljs-number">#ff0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">40px</span> <span class="hljs-number">#ff0</span>;
  }
}

<span class="hljs-comment">/* åœ£è¯æ ‘å®¹å™¨ */</span>
<span class="hljs-selector-class">.tree</span> {
  <span class="hljs-attribute">position</span>: relative;
  <span class="hljs-attribute">display</span>: inline-block;
}

<span class="hljs-comment">/* æ ‘å¹²æ ·å¼ */</span>
<span class="hljs-selector-class">.trunk</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">40px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">60px</span>;
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#8b4513</span>;
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">bottom</span>: -<span class="hljs-number">60px</span>;
  <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>);
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">10px</span>;
}

<span class="hljs-comment">/* æ ‘å† æ ·å¼ - ä¸‰ä¸ªä¸‰è§’å½¢å åŠ  */</span>
<span class="hljs-selector-class">.leaves</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">border-left</span>: transparent solid;
  <span class="hljs-attribute">border-right</span>: transparent solid;
  <span class="hljs-attribute">border-bottom</span>: green solid;
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>);
}

<span class="hljs-comment">/* ç¬¬ä¸€å±‚æ ‘å†  */</span>
<span class="hljs-selector-class">.leaves-1</span> {
  <span class="hljs-attribute">border-left-width</span>: <span class="hljs-number">150px</span>;
  <span class="hljs-attribute">border-right-width</span>: <span class="hljs-number">150px</span>;
  <span class="hljs-attribute">border-bottom-width</span>: <span class="hljs-number">200px</span>;
  <span class="hljs-attribute">bottom</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(to bottom, <span class="hljs-number">#228b22</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#006400</span> <span class="hljs-number">100%</span>);
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span> <span class="hljs-number">50%</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>;
}

<span class="hljs-comment">/* ç¬¬äºŒå±‚æ ‘å†  */</span>
<span class="hljs-selector-class">.leaves-2</span> {
  <span class="hljs-attribute">border-left-width</span>: <span class="hljs-number">120px</span>;
  <span class="hljs-attribute">border-right-width</span>: <span class="hljs-number">120px</span>;
  <span class="hljs-attribute">border-bottom-width</span>: <span class="hljs-number">160px</span>;
  <span class="hljs-attribute">bottom</span>: <span class="hljs-number">70px</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(to bottom, <span class="hljs-number">#228b22</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#006400</span> <span class="hljs-number">100%</span>);
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span> <span class="hljs-number">50%</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>;
}

<span class="hljs-comment">/* ç¬¬ä¸‰å±‚æ ‘å†  */</span>
<span class="hljs-selector-class">.leaves-3</span> {
  <span class="hljs-attribute">border-left-width</span>: <span class="hljs-number">90px</span>;
  <span class="hljs-attribute">border-right-width</span>: <span class="hljs-number">90px</span>;
  <span class="hljs-attribute">border-bottom-width</span>: <span class="hljs-number">120px</span>;
  <span class="hljs-attribute">bottom</span>: <span class="hljs-number">140px</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(to bottom, <span class="hljs-number">#228b22</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#006400</span> <span class="hljs-number">100%</span>);
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span> <span class="hljs-number">50%</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>;
}

<span class="hljs-comment">/* æ ‘é¡¶æ˜Ÿæ˜Ÿ */</span>
<span class="hljs-selector-class">.star</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">border-left</span>: <span class="hljs-number">25px</span> solid transparent;
  <span class="hljs-attribute">border-right</span>: <span class="hljs-number">25px</span> solid transparent;
  <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">43px</span> solid <span class="hljs-number">#ffd700</span>;
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>);
  <span class="hljs-attribute">bottom</span>: <span class="hljs-number">250px</span>;
  <span class="hljs-attribute">animation</span>: twinkle <span class="hljs-number">1s</span> ease-in-out infinite alternate;
}

<span class="hljs-comment">/* æ˜Ÿæ˜Ÿé—ªçƒåŠ¨ç”» */</span>
<span class="hljs-keyword">@keyframes</span> twinkle {
  <span class="hljs-selector-tag">from</span> {
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>) <span class="hljs-built_in">scale</span>(<span class="hljs-number">1</span>);
    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.8</span>;
  }
  <span class="hljs-selector-tag">to</span> {
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>) <span class="hljs-built_in">scale</span>(<span class="hljs-number">1.1</span>);
    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;
    <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">20px</span> <span class="hljs-number">#ffd700</span>;
  }
}

<span class="hljs-comment">/* æ˜Ÿæ˜Ÿçš„äº”ä¸ªè§’ */</span>
<span class="hljs-selector-class">.star</span><span class="hljs-selector-pseudo">::before</span>,
<span class="hljs-selector-class">.star</span><span class="hljs-selector-pseudo">::after</span> {
  <span class="hljs-attribute">content</span>: <span class="hljs-string">""</span>;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">border-left</span>: <span class="hljs-number">25px</span> solid transparent;
  <span class="hljs-attribute">border-right</span>: <span class="hljs-number">25px</span> solid transparent;
  <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">43px</span> solid <span class="hljs-number">#ffd700</span>;
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">left</span>: -<span class="hljs-number">25px</span>;
}

<span class="hljs-selector-class">.star</span><span class="hljs-selector-pseudo">::before</span> {
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">rotate</span>(<span class="hljs-number">72deg</span>);
}

<span class="hljs-selector-class">.star</span><span class="hljs-selector-pseudo">::after</span> {
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">rotate</span>(<span class="hljs-number">144deg</span>);
}

<span class="hljs-comment">/* è£…é¥°å“åŸºç¡€æ ·å¼ */</span>
<span class="hljs-selector-class">.decoration</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">20px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">20px</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">animation</span>: blink <span class="hljs-number">1.5s</span> ease-in-out infinite alternate;
}

<span class="hljs-comment">/* è£…é¥°å“é—ªçƒåŠ¨ç”» */</span>
<span class="hljs-keyword">@keyframes</span> blink {
  <span class="hljs-selector-tag">from</span> {
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">1</span>);
    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.8</span>;
  }
  <span class="hljs-selector-tag">to</span> {
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">1.2</span>);
    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;
    <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> currentColor;
  }
}

<span class="hljs-comment">/* ä¸åŒé¢œè‰²çš„è£…é¥°å“ */</span>
<span class="hljs-selector-class">.decoration</span><span class="hljs-selector-class">.red</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ff0000</span>;
  <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">#ff0000</span>;
}

<span class="hljs-selector-class">.decoration</span><span class="hljs-selector-class">.blue</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#0000ff</span>;
  <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">#0000ff</span>;
}

<span class="hljs-selector-class">.decoration</span><span class="hljs-selector-class">.yellow</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ffff00</span>;
  <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">#ffff00</span>;
}

<span class="hljs-selector-class">.decoration</span><span class="hljs-selector-class">.pink</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ff1493</span>;
  <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">#ff1493</span>;
}

<span class="hljs-comment">/* é›ªèŠ±æ ·å¼ */</span>
<span class="hljs-selector-class">.snowflake</span> {
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fff</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;
  <span class="hljs-attribute">animation</span>: fall linear infinite;
  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.8</span>;
}

<span class="hljs-comment">/* é›ªèŠ±ä¸‹è½åŠ¨ç”» */</span>
<span class="hljs-keyword">@keyframes</span> fall {
  <span class="hljs-selector-tag">from</span> {
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">100px</span>) <span class="hljs-built_in">rotate</span>(<span class="hljs-number">0deg</span>);
    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;
  }
  <span class="hljs-number">10%</span> {
    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.8</span>;
  }
  <span class="hljs-selector-tag">to</span> {
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">100vh</span>) <span class="hljs-built_in">rotate</span>(<span class="hljs-number">360deg</span>);
    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;
  }
}

<span class="hljs-comment">/* ç¤¼ç‰©ç›’å®¹å™¨ */</span>
<span class="hljs-selector-class">.gifts</span> {
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">bottom</span>: -<span class="hljs-number">100px</span>;
  <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>);
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">gap</span>: <span class="hljs-number">20px</span>;
}

<span class="hljs-comment">/* ç¤¼ç‰©ç›’æ ·å¼ */</span>
<span class="hljs-selector-class">.gift</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">60px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">60px</span>;
  <span class="hljs-attribute">position</span>: relative;
  <span class="hljs-attribute">animation</span>: bounce <span class="hljs-number">2s</span> ease-in-out infinite;
}

<span class="hljs-comment">/* ç¤¼ç‰©ç›’å¼¹è·³åŠ¨ç”» */</span>
<span class="hljs-keyword">@keyframes</span> bounce {
  <span class="hljs-number">0%</span>,
  <span class="hljs-number">100%</span> {
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">0</span>);
  }
  <span class="hljs-number">50%</span> {
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">10px</span>);
  }
}

<span class="hljs-comment">/* ä¸åŒé¢œè‰²çš„ç¤¼ç‰©ç›’ */</span>
<span class="hljs-selector-class">.gift</span><span class="hljs-selector-class">.red</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ff0000</span>;
}

<span class="hljs-selector-class">.gift</span><span class="hljs-selector-class">.green</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#008000</span>;
}

<span class="hljs-selector-class">.gift</span><span class="hljs-selector-class">.blue</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#0000ff</span>;
}

<span class="hljs-selector-class">.gift</span><span class="hljs-selector-class">.yellow</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ffff00</span>;
}

<span class="hljs-comment">/* ç¤¼ç‰©ç›’ä¸å¸¦ */</span>
<span class="hljs-selector-class">.gift</span><span class="hljs-selector-pseudo">::before</span>,
<span class="hljs-selector-class">.gift</span><span class="hljs-selector-pseudo">::after</span> {
  <span class="hljs-attribute">content</span>: <span class="hljs-string">""</span>;
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fff</span>;
}

<span class="hljs-selector-class">.gift</span><span class="hljs-selector-pseudo">::before</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">10px</span>;
  <span class="hljs-attribute">top</span>: <span class="hljs-number">50%</span>;
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">50%</span>);
}

<span class="hljs-selector-class">.gift</span><span class="hljs-selector-pseudo">::after</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">10px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>);
}
</code></pre>
<h4 data-id="heading-6">ç¬¬ä¸‰æ­¥ï¼šè®©å®ƒåŠ¨èµ·æ¥ï¼ˆJSï¼‰</h4>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬çš„åœ£è¯æ ‘è¿˜åªæ˜¯ä¸ªã€Œé™æ€ç¾äººã€ï¼Œè®©æˆ‘ä»¬ç”¨ JavaScript ç»™å®ƒæ³¨å…¥çµé­‚ï¼âœ¨</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åœ£è¯æ ‘è£…é¥°å“ç”Ÿæˆ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createDecorations</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> decorationsContainer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">".decorations"</span>);
  <span class="hljs-keyword">const</span> colors = [<span class="hljs-string">"red"</span>, <span class="hljs-string">"blue"</span>, <span class="hljs-string">"yellow"</span>, <span class="hljs-string">"pink"</span>];
  <span class="hljs-keyword">const</span> count = <span class="hljs-number">20</span>;

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; count; i++) {
    <span class="hljs-keyword">const</span> decoration = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"div"</span>);
    decoration.<span class="hljs-property">className</span> = <span class="hljs-string">`decoration <span class="hljs-subst">${
      colors[<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * colors.length)]
    }</span>`</span>;

    <span class="hljs-comment">// éšæœºä½ç½®ï¼ˆåœ¨æ ‘å† èŒƒå›´å†…ï¼‰</span>
    <span class="hljs-keyword">const</span> angle = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>;
    <span class="hljs-keyword">const</span> radius = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">120</span> + <span class="hljs-number">30</span>;
    <span class="hljs-keyword">const</span> x = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>(angle) * radius;
    <span class="hljs-keyword">const</span> y = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>(angle) * radius - <span class="hljs-number">100</span>;

    decoration.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-string">`calc(50% + <span class="hljs-subst">${x}</span>px)`</span>;
    decoration.<span class="hljs-property">style</span>.<span class="hljs-property">bottom</span> = <span class="hljs-string">`<span class="hljs-subst">${y}</span>px`</span>;
    decoration.<span class="hljs-property">style</span>.<span class="hljs-property">animationDelay</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">2</span>}</span>s`</span>;

    decorationsContainer.<span class="hljs-title function_">appendChild</span>(decoration);
  }
}

<span class="hljs-comment">// é›ªèŠ±ç”Ÿæˆå™¨</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createSnow</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> snowContainer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">".snow"</span>);
  <span class="hljs-keyword">const</span> snowflakeCount = <span class="hljs-number">100</span>;

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; snowflakeCount; i++) {
    <span class="hljs-keyword">const</span> snowflake = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"div"</span>);
    snowflake.<span class="hljs-property">className</span> = <span class="hljs-string">"snowflake"</span>;

    <span class="hljs-comment">// éšæœºå¤§å°</span>
    <span class="hljs-keyword">const</span> size = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">8</span> + <span class="hljs-number">2</span>;
    snowflake.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">`<span class="hljs-subst">${size}</span>px`</span>;
    snowflake.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-string">`<span class="hljs-subst">${size}</span>px`</span>;

    <span class="hljs-comment">// éšæœºä½ç½®</span>
    snowflake.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">100</span>}</span>vw`</span>;

    <span class="hljs-comment">// éšæœºä¸‹è½é€Ÿåº¦</span>
    <span class="hljs-keyword">const</span> duration = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">10</span> + <span class="hljs-number">5</span>;
    snowflake.<span class="hljs-property">style</span>.<span class="hljs-property">animationDuration</span> = <span class="hljs-string">`<span class="hljs-subst">${duration}</span>s`</span>;

    <span class="hljs-comment">// éšæœºå»¶è¿Ÿ</span>
    snowflake.<span class="hljs-property">style</span>.<span class="hljs-property">animationDelay</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">5</span>}</span>s`</span>;

    snowContainer.<span class="hljs-title function_">appendChild</span>(snowflake);
  }
}

<span class="hljs-comment">// ç¤¼ç‰©ç›’ç”Ÿæˆ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createGifts</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> giftsContainer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">".gifts"</span>);
  <span class="hljs-keyword">const</span> colors = [<span class="hljs-string">"red"</span>, <span class="hljs-string">"green"</span>, <span class="hljs-string">"blue"</span>, <span class="hljs-string">"yellow"</span>];
  <span class="hljs-keyword">const</span> count = <span class="hljs-number">4</span>;

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; count; i++) {
    <span class="hljs-keyword">const</span> gift = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"div"</span>);
    gift.<span class="hljs-property">className</span> = <span class="hljs-string">`gift <span class="hljs-subst">${
      colors[<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * colors.length)]
    }</span>`</span>;
    gift.<span class="hljs-property">style</span>.<span class="hljs-property">animationDelay</span> = <span class="hljs-string">`<span class="hljs-subst">${i * <span class="hljs-number">0.5</span>}</span>s`</span>;
    giftsContainer.<span class="hljs-title function_">appendChild</span>(gift);
  }
}

<span class="hljs-comment">// é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"DOMContentLoaded"</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">createDecorations</span>();
  <span class="hljs-title function_">createSnow</span>();
  <span class="hljs-title function_">createGifts</span>();
});
</code></pre>
<h3 data-id="heading-7">ğŸ‰ è®©åœ£è¯æ ‘è·‘èµ·æ¥</h3>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æŠŠæ‰€æœ‰ä»£ç åˆå¹¶åˆ°ä¸€ä¸ªå®Œæ•´çš„ HTML æ–‡ä»¶ä¸­ï¼Œä½ å¯ä»¥ç›´æ¥å¤åˆ¶ä¸‹é¢çš„ä»£ç ä¿å­˜ä¸º <code>christmas-tree.html</code>ï¼Œç„¶åç”¨æµè§ˆå™¨æ‰“å¼€å®ƒï¼Œå°±èƒ½çœ‹åˆ°ä½ çš„åœ£è¯æ ‘äº†ï¼ğŸ„</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-CN"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>ğŸ„ æˆ‘çš„ä»£ç åœ£è¯æ ‘<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
      <span class="hljs-comment">/* å…¨å±€æ ·å¼ */</span>
      * {
        <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">box-sizing</span>: border-box;
      }

      <span class="hljs-selector-tag">body</span> {
        <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(to bottom, <span class="hljs-number">#1a1a2e</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#16213e</span> <span class="hljs-number">100%</span>);
        <span class="hljs-attribute">height</span>: <span class="hljs-number">100vh</span>;
        <span class="hljs-attribute">display</span>: flex;
        <span class="hljs-attribute">justify-content</span>: center;
        <span class="hljs-attribute">align-items</span>: center;
        <span class="hljs-attribute">overflow</span>: hidden;
        <span class="hljs-attribute">font-family</span>: <span class="hljs-string">"Arial"</span>, sans-serif;
        <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
      }

      <span class="hljs-selector-class">.container</span> {
        <span class="hljs-attribute">text-align</span>: center;
        <span class="hljs-attribute">position</span>: relative;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">500px</span>;
        <span class="hljs-attribute">width</span>: <span class="hljs-number">600px</span>;
        <span class="hljs-attribute">display</span>: flex;
        <span class="hljs-attribute">flex-direction</span>: column;
        <span class="hljs-attribute">justify-content</span>: center;
        <span class="hljs-attribute">align-items</span>: center;
        <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto;
      }

      <span class="hljs-comment">/* æ ‡é¢˜æ ·å¼ */</span>
      <span class="hljs-selector-tag">h1</span> {
        <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
        <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">100px</span>;
        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">2.5rem</span>;
        <span class="hljs-attribute">text-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">#ff0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">20px</span> <span class="hljs-number">#ff0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">30px</span> <span class="hljs-number">#ff0</span>;
        <span class="hljs-attribute">animation</span>: glow <span class="hljs-number">2s</span> ease-in-out infinite alternate;
        <span class="hljs-attribute">z-index</span>: <span class="hljs-number">20</span>;
        <span class="hljs-attribute">position</span>: relative;
      }

      <span class="hljs-comment">/* æ ‡é¢˜å‘å…‰åŠ¨ç”» */</span>
      <span class="hljs-keyword">@keyframes</span> glow {
        <span class="hljs-selector-tag">from</span> {
          <span class="hljs-attribute">text-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">#ff0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">20px</span> <span class="hljs-number">#ff0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">30px</span> <span class="hljs-number">#ff0</span>;
        }
        <span class="hljs-selector-tag">to</span> {
          <span class="hljs-attribute">text-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">20px</span> <span class="hljs-number">#ff0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">30px</span> <span class="hljs-number">#ff0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">40px</span> <span class="hljs-number">#ff0</span>;
        }
      }

      <span class="hljs-comment">/* åœ£è¯æ ‘å®¹å™¨ */</span>
      <span class="hljs-selector-class">.tree</span> {
        <span class="hljs-attribute">position</span>: relative;
        <span class="hljs-attribute">display</span>: inline-block;
      }

      <span class="hljs-comment">/* æ ‘å¹²æ ·å¼ */</span>
      <span class="hljs-selector-class">.trunk</span> {
        <span class="hljs-attribute">width</span>: <span class="hljs-number">40px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">60px</span>;
        <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#8b4513</span>;
        <span class="hljs-attribute">position</span>: absolute;
        <span class="hljs-attribute">bottom</span>: -<span class="hljs-number">60px</span>;
        <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;
        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>);
        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">10px</span>;
      }

      <span class="hljs-comment">/* æ ‘å† æ ·å¼ - ä¸‰ä¸ªä¸‰è§’å½¢å åŠ  */</span>
      <span class="hljs-selector-class">.leaves</span> {
        <span class="hljs-attribute">width</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">position</span>: absolute;
        <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;
        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>);
        <span class="hljs-attribute">filter</span>: <span class="hljs-built_in">drop-shadow</span>(<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.3</span>));
      }

      <span class="hljs-comment">/* ç¬¬ä¸€å±‚æ ‘å†  */</span>
      <span class="hljs-selector-class">.leaves-1</span> {
        <span class="hljs-attribute">border-left</span>: <span class="hljs-number">150px</span> solid transparent;
        <span class="hljs-attribute">border-right</span>: <span class="hljs-number">150px</span> solid transparent;
        <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">200px</span> solid <span class="hljs-number">#2e8b57</span>;
        <span class="hljs-attribute">bottom</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">animation</span>: sway <span class="hljs-number">3s</span> ease-in-out infinite alternate;
      }

      <span class="hljs-comment">/* ç¬¬äºŒå±‚æ ‘å†  */</span>
      <span class="hljs-selector-class">.leaves-2</span> {
        <span class="hljs-attribute">border-left</span>: <span class="hljs-number">120px</span> solid transparent;
        <span class="hljs-attribute">border-right</span>: <span class="hljs-number">120px</span> solid transparent;
        <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">160px</span> solid <span class="hljs-number">#3cb371</span>;
        <span class="hljs-attribute">bottom</span>: <span class="hljs-number">70px</span>;
        <span class="hljs-attribute">animation</span>: sway <span class="hljs-number">3s</span> ease-in-out infinite alternate-reverse;
      }

      <span class="hljs-comment">/* ç¬¬ä¸‰å±‚æ ‘å†  */</span>
      <span class="hljs-selector-class">.leaves-3</span> {
        <span class="hljs-attribute">border-left</span>: <span class="hljs-number">90px</span> solid transparent;
        <span class="hljs-attribute">border-right</span>: <span class="hljs-number">90px</span> solid transparent;
        <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">120px</span> solid <span class="hljs-number">#228b22</span>;
        <span class="hljs-attribute">bottom</span>: <span class="hljs-number">140px</span>;
        <span class="hljs-attribute">animation</span>: sway <span class="hljs-number">3s</span> ease-in-out infinite alternate;
      }

      <span class="hljs-comment">/* æ ‘æ‘‡æ‘†åŠ¨ç”» */</span>
      <span class="hljs-keyword">@keyframes</span> sway {
        <span class="hljs-selector-tag">from</span> {
          <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>) <span class="hljs-built_in">rotate</span>(-<span class="hljs-number">1deg</span>);
        }
        <span class="hljs-selector-tag">to</span> {
          <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>) <span class="hljs-built_in">rotate</span>(<span class="hljs-number">1deg</span>);
        }
      }

      <span class="hljs-comment">/* æ ‘é¡¶æ˜Ÿæ˜Ÿ - ä½¿ç”¨æ›´ç®€å•çš„æ–¹å¼å®ç° */</span>
      <span class="hljs-selector-class">.star</span> {
        <span class="hljs-attribute">width</span>: <span class="hljs-number">50px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">50px</span>;
        <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ffd700</span>;
        <span class="hljs-attribute">clip-path</span>: <span class="hljs-built_in">polygon</span>(
          <span class="hljs-number">50%</span> <span class="hljs-number">0%</span>,
          <span class="hljs-number">61%</span> <span class="hljs-number">35%</span>,
          <span class="hljs-number">98%</span> <span class="hljs-number">35%</span>,
          <span class="hljs-number">68%</span> <span class="hljs-number">57%</span>,
          <span class="hljs-number">79%</span> <span class="hljs-number">91%</span>,
          <span class="hljs-number">50%</span> <span class="hljs-number">70%</span>,
          <span class="hljs-number">21%</span> <span class="hljs-number">91%</span>,
          <span class="hljs-number">32%</span> <span class="hljs-number">57%</span>,
          <span class="hljs-number">2%</span> <span class="hljs-number">35%</span>,
          <span class="hljs-number">39%</span> <span class="hljs-number">35%</span>
        );
        <span class="hljs-attribute">position</span>: absolute;
        <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;
        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>);
        <span class="hljs-attribute">bottom</span>: <span class="hljs-number">250px</span>;
        <span class="hljs-attribute">animation</span>: twinkle <span class="hljs-number">1s</span> ease-in-out infinite alternate;
        <span class="hljs-attribute">z-index</span>: <span class="hljs-number">10</span>;
      }

      <span class="hljs-comment">/* æ˜Ÿæ˜Ÿé—ªçƒåŠ¨ç”» */</span>
      <span class="hljs-keyword">@keyframes</span> twinkle {
        <span class="hljs-selector-tag">from</span> {
          <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>) <span class="hljs-built_in">scale</span>(<span class="hljs-number">1</span>);
          <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.8</span>;
        }
        <span class="hljs-selector-tag">to</span> {
          <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>) <span class="hljs-built_in">scale</span>(<span class="hljs-number">1.1</span>);
          <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;
          <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">20px</span> <span class="hljs-number">#ffd700</span>;
        }
      }

      <span class="hljs-comment">/* è£…é¥°å“åŸºç¡€æ ·å¼ */</span>
      <span class="hljs-selector-class">.decoration</span> {
        <span class="hljs-attribute">width</span>: <span class="hljs-number">20px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">20px</span>;
        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;
        <span class="hljs-attribute">position</span>: absolute;
        <span class="hljs-attribute">animation</span>: blink <span class="hljs-number">1.5s</span> ease-in-out infinite alternate;
        <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> currentColor;
      }

      <span class="hljs-comment">/* è£…é¥°å“é—ªçƒåŠ¨ç”» */</span>
      <span class="hljs-keyword">@keyframes</span> blink {
        <span class="hljs-selector-tag">from</span> {
          <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">1</span>) <span class="hljs-built_in">rotate</span>(<span class="hljs-number">0deg</span>);
          <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.8</span>;
        }
        <span class="hljs-selector-tag">to</span> {
          <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">1.3</span>) <span class="hljs-built_in">rotate</span>(<span class="hljs-number">360deg</span>);
          <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;
          <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">20px</span> currentColor, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">30px</span> currentColor;
        }
      }

      <span class="hljs-comment">/* ä¸åŒé¢œè‰²çš„è£…é¥°å“ï¼Œå¢åŠ å‘å…‰æ•ˆæœ */</span>
      <span class="hljs-selector-class">.decoration</span><span class="hljs-selector-class">.red</span> {
        <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ff0000</span>;
        <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">15px</span> <span class="hljs-number">#ff0000</span>, inset <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">5px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.5</span>);
      }

      <span class="hljs-selector-class">.decoration</span><span class="hljs-selector-class">.blue</span> {
        <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#0000ff</span>;
        <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">15px</span> <span class="hljs-number">#0000ff</span>, inset <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">5px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.5</span>);
      }

      <span class="hljs-selector-class">.decoration</span><span class="hljs-selector-class">.yellow</span> {
        <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ffff00</span>;
        <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">15px</span> <span class="hljs-number">#ffff00</span>, inset <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">5px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.5</span>);
      }

      <span class="hljs-selector-class">.decoration</span><span class="hljs-selector-class">.pink</span> {
        <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ff1493</span>;
        <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">15px</span> <span class="hljs-number">#ff1493</span>, inset <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">5px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.5</span>);
      }

      <span class="hljs-comment">/* æ·»åŠ ä¸€äº›ä¸åŒå¤§å°çš„è£…é¥°å“ */</span>
      <span class="hljs-selector-class">.decoration</span><span class="hljs-selector-class">.large</span> {
        <span class="hljs-attribute">width</span>: <span class="hljs-number">25px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">25px</span>;
      }

      <span class="hljs-selector-class">.decoration</span><span class="hljs-selector-class">.small</span> {
        <span class="hljs-attribute">width</span>: <span class="hljs-number">15px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">15px</span>;
        <span class="hljs-attribute">animation-duration</span>: <span class="hljs-number">2s</span>;
      }

      <span class="hljs-comment">/* é›ªèŠ±æ ·å¼ */</span>
      <span class="hljs-selector-class">.snowflake</span> {
        <span class="hljs-attribute">position</span>: absolute;
        <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fff</span>;
        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;
        <span class="hljs-attribute">animation</span>: fall linear infinite;
        <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.8</span>;
      }

      <span class="hljs-comment">/* é›ªèŠ±ä¸‹è½åŠ¨ç”» */</span>
      <span class="hljs-keyword">@keyframes</span> fall {
        <span class="hljs-selector-tag">from</span> {
          <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">100px</span>) <span class="hljs-built_in">rotate</span>(<span class="hljs-number">0deg</span>);
          <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;
        }
        <span class="hljs-number">10%</span> {
          <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.8</span>;
        }
        <span class="hljs-selector-tag">to</span> {
          <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">100vh</span>) <span class="hljs-built_in">rotate</span>(<span class="hljs-number">360deg</span>);
          <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;
        }
      }

      <span class="hljs-comment">/* ç¤¼ç‰©ç›’å®¹å™¨ */</span>
      <span class="hljs-selector-class">.gifts</span> {
        <span class="hljs-attribute">position</span>: absolute;
        <span class="hljs-attribute">bottom</span>: -<span class="hljs-number">80px</span>;
        <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;
        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>);
        <span class="hljs-attribute">display</span>: flex;
        <span class="hljs-attribute">gap</span>: <span class="hljs-number">25px</span>;
        <span class="hljs-attribute">z-index</span>: <span class="hljs-number">5</span>;
      }

      <span class="hljs-comment">/* ç¤¼ç‰©ç›’æ ·å¼ - ç«‹ä½“æ•ˆæœ */</span>
      <span class="hljs-selector-class">.gift</span> {
        <span class="hljs-attribute">width</span>: <span class="hljs-number">50px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">40px</span>;
        <span class="hljs-attribute">position</span>: relative;
        <span class="hljs-attribute">animation</span>: bounce <span class="hljs-number">2s</span> ease-in-out infinite;
        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">3px</span>;
        <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">5px</span> <span class="hljs-number">10px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.3</span>);
      }

      <span class="hljs-comment">/* ç¤¼ç‰©ç›’å¼¹è·³åŠ¨ç”» - æ›´è‡ªç„¶çš„æ•ˆæœ */</span>
      <span class="hljs-keyword">@keyframes</span> bounce {
        <span class="hljs-number">0%</span>,
        <span class="hljs-number">100%</span> {
          <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">0</span>) <span class="hljs-built_in">scale</span>(<span class="hljs-number">1</span>);
        }
        <span class="hljs-number">50%</span> {
          <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">15px</span>) <span class="hljs-built_in">scale</span>(<span class="hljs-number">1.05</span>);
        }
      }

      <span class="hljs-comment">/* ä¸åŒé¢œè‰²çš„ç¤¼ç‰©ç›’ï¼Œæ·»åŠ æ¸å˜å’Œç«‹ä½“æ•ˆæœ */</span>
      <span class="hljs-selector-class">.gift</span><span class="hljs-selector-class">.red</span> {
        <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">135deg</span>, <span class="hljs-number">#ff0000</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#cc0000</span> <span class="hljs-number">100%</span>);
      }

      <span class="hljs-selector-class">.gift</span><span class="hljs-selector-class">.green</span> {
        <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">135deg</span>, <span class="hljs-number">#008000</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#006400</span> <span class="hljs-number">100%</span>);
      }

      <span class="hljs-selector-class">.gift</span><span class="hljs-selector-class">.blue</span> {
        <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">135deg</span>, <span class="hljs-number">#0000ff</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#0000cc</span> <span class="hljs-number">100%</span>);
      }

      <span class="hljs-selector-class">.gift</span><span class="hljs-selector-class">.yellow</span> {
        <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">135deg</span>, <span class="hljs-number">#ffff00</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#cccc00</span> <span class="hljs-number">100%</span>);
      }

      <span class="hljs-comment">/* ç¤¼ç‰©ç›’ç›–å­ - ç«‹ä½“æ•ˆæœ */</span>
      <span class="hljs-selector-class">.gift</span><span class="hljs-selector-pseudo">::before</span> {
        <span class="hljs-attribute">content</span>: <span class="hljs-string">""</span>;
        <span class="hljs-attribute">position</span>: absolute;
        <span class="hljs-attribute">top</span>: -<span class="hljs-number">8px</span>;
        <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">right</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">8px</span>;
        <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(
          <span class="hljs-number">135deg</span>,
          <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.3</span>) <span class="hljs-number">0%</span>,
          <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.1</span>) <span class="hljs-number">100%</span>
        );
        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">2px</span> <span class="hljs-number">2px</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>;
        <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> -<span class="hljs-number">2px</span> <span class="hljs-number">5px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.2</span>);
      }

      <span class="hljs-comment">/* ç¤¼ç‰©ç›’ä¸å¸¦ - æ›´ç¾è§‚çš„è®¾è®¡ */</span>
      <span class="hljs-selector-class">.gift</span><span class="hljs-selector-pseudo">::after</span> {
        <span class="hljs-attribute">content</span>: <span class="hljs-string">""</span>;
        <span class="hljs-attribute">position</span>: absolute;
        <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fff</span>;
        <span class="hljs-attribute">width</span>: <span class="hljs-number">8px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
        <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;
        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>);
        <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">3px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.3</span>);
      }

      <span class="hljs-comment">/* ç¤¼ç‰©ç›’åº•éƒ¨ä¸å¸¦ */</span>
      <span class="hljs-selector-class">.gift</span> {
        <span class="hljs-attribute">position</span>: relative;
      }

      <span class="hljs-comment">/* ç¤¼ç‰©ç›’ä¸å¸¦è£…é¥° */</span>
      <span class="hljs-selector-class">.gift</span> <span class="hljs-selector-tag">span</span> {
        <span class="hljs-attribute">position</span>: absolute;
        <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fff</span>;
        <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">8px</span>;
        <span class="hljs-attribute">top</span>: <span class="hljs-number">50%</span>;
        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">50%</span>);
        <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">3px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.3</span>);
      }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ğŸ… Merry Christmas! ğŸ„<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"tree"</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- åœ£è¯æ ‘çš„æ ‘å¹² --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"trunk"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- åœ£è¯æ ‘çš„æ ‘å† ï¼Œç”¨ä¸‰ä¸ªä¸‰è§’å½¢ç»„æˆ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"leaves leaves-1"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"leaves leaves-2"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"leaves leaves-3"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- åœ£è¯æ ‘ä¸Šçš„è£…é¥°å“ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"decorations"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- æ ‘é¡¶æ˜Ÿæ˜Ÿ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"star"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- é›ªèŠ±æ•ˆæœ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"snow"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- ç¤¼ç‰©ç›’ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"gifts"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
      <span class="hljs-comment">// åœ£è¯æ ‘è£…é¥°å“ç”Ÿæˆ</span>
      <span class="hljs-keyword">function</span> <span class="hljs-title function_">createDecorations</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> decorationsContainer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">".decorations"</span>);
        <span class="hljs-keyword">const</span> colors = [<span class="hljs-string">"red"</span>, <span class="hljs-string">"blue"</span>, <span class="hljs-string">"yellow"</span>, <span class="hljs-string">"pink"</span>];
        <span class="hljs-keyword">const</span> sizes = [<span class="hljs-string">""</span>, <span class="hljs-string">"large"</span>, <span class="hljs-string">"small"</span>];
        <span class="hljs-keyword">const</span> count = <span class="hljs-number">25</span>; <span class="hljs-comment">// å¢åŠ æ•°é‡ï¼Œè®©æ ‘æ›´ä¸°å¯Œ</span>

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; count; i++) {
          <span class="hljs-keyword">const</span> decoration = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"div"</span>);
          decoration.<span class="hljs-property">className</span> = <span class="hljs-string">`decoration <span class="hljs-subst">${
            colors[<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * colors.length)]
          }</span> <span class="hljs-subst">${sizes[<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * sizes.length)]}</span>`</span>;

          <span class="hljs-comment">// ç®€å•çš„éšæœºä½ç½®ï¼Œç¡®ä¿åœ¨æ ‘å†…éƒ¨</span>
          <span class="hljs-keyword">const</span> x = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">200</span> - <span class="hljs-number">100</span>; <span class="hljs-comment">// -100åˆ°100ä¹‹é—´</span>
          <span class="hljs-keyword">const</span> y = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">180</span>; <span class="hljs-comment">// 0åˆ°180ä¹‹é—´</span>

          <span class="hljs-comment">// ç¡®ä¿åœ¨ä¸‰è§’å½¢æ ‘å† èŒƒå›´å†…</span>
          <span class="hljs-keyword">const</span> distanceFromCenter = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(x);
          <span class="hljs-keyword">const</span> maxWidthAtHeight = <span class="hljs-number">150</span> - (y / <span class="hljs-number">180</span>) * <span class="hljs-number">100</span>;

          <span class="hljs-keyword">if</span> (distanceFromCenter &lt; maxWidthAtHeight) {
            decoration.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-string">`calc(50% + <span class="hljs-subst">${x}</span>px)`</span>;
            decoration.<span class="hljs-property">style</span>.<span class="hljs-property">bottom</span> = <span class="hljs-string">`<span class="hljs-subst">${y}</span>px`</span>;
            decoration.<span class="hljs-property">style</span>.<span class="hljs-property">animationDelay</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">2</span>}</span>s`</span>;
            decoration.<span class="hljs-property">style</span>.<span class="hljs-property">zIndex</span> = <span class="hljs-number">2</span>;

            decorationsContainer.<span class="hljs-title function_">appendChild</span>(decoration);
          }
        }
      }

      <span class="hljs-comment">// é›ªèŠ±ç”Ÿæˆå™¨</span>
      <span class="hljs-keyword">function</span> <span class="hljs-title function_">createSnow</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> snowContainer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">".snow"</span>);
        <span class="hljs-keyword">const</span> snowflakeCount = <span class="hljs-number">100</span>;

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; snowflakeCount; i++) {
          <span class="hljs-keyword">const</span> snowflake = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"div"</span>);
          snowflake.<span class="hljs-property">className</span> = <span class="hljs-string">"snowflake"</span>;

          <span class="hljs-comment">// éšæœºå¤§å°</span>
          <span class="hljs-keyword">const</span> size = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">8</span> + <span class="hljs-number">2</span>;
          snowflake.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">`<span class="hljs-subst">${size}</span>px`</span>;
          snowflake.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-string">`<span class="hljs-subst">${size}</span>px`</span>;

          <span class="hljs-comment">// éšæœºä½ç½®</span>
          snowflake.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">100</span>}</span>vw`</span>;

          <span class="hljs-comment">// éšæœºä¸‹è½é€Ÿåº¦</span>
          <span class="hljs-keyword">const</span> duration = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">10</span> + <span class="hljs-number">5</span>;
          snowflake.<span class="hljs-property">style</span>.<span class="hljs-property">animationDuration</span> = <span class="hljs-string">`<span class="hljs-subst">${duration}</span>s`</span>;

          <span class="hljs-comment">// éšæœºå»¶è¿Ÿ</span>
          snowflake.<span class="hljs-property">style</span>.<span class="hljs-property">animationDelay</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">5</span>}</span>s`</span>;

          snowContainer.<span class="hljs-title function_">appendChild</span>(snowflake);
        }
      }

      <span class="hljs-comment">// ç¤¼ç‰©ç›’ç”Ÿæˆ</span>
      <span class="hljs-keyword">function</span> <span class="hljs-title function_">createGifts</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> giftsContainer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">".gifts"</span>);
        <span class="hljs-keyword">const</span> colors = [<span class="hljs-string">"red"</span>, <span class="hljs-string">"green"</span>, <span class="hljs-string">"blue"</span>, <span class="hljs-string">"yellow"</span>];
        <span class="hljs-keyword">const</span> count = <span class="hljs-number">5</span>; <span class="hljs-comment">// å¢åŠ ä¸€ä¸ªç¤¼ç‰©ç›’</span>

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; count; i++) {
          <span class="hljs-keyword">const</span> gift = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"div"</span>);
          gift.<span class="hljs-property">className</span> = <span class="hljs-string">`gift <span class="hljs-subst">${
            colors[<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * colors.length)]
          }</span>`</span>;
          gift.<span class="hljs-property">style</span>.<span class="hljs-property">animationDelay</span> = <span class="hljs-string">`<span class="hljs-subst">${i * <span class="hljs-number">0.3</span>}</span>s`</span>;

          <span class="hljs-comment">// æ·»åŠ ä¸å¸¦è£…é¥°</span>
          <span class="hljs-keyword">const</span> ribbon = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"span"</span>);
          gift.<span class="hljs-title function_">appendChild</span>(ribbon);

          giftsContainer.<span class="hljs-title function_">appendChild</span>(gift);
        }
      }

      <span class="hljs-comment">// é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ</span>
      <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"DOMContentLoaded"</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-title function_">createDecorations</span>();
        <span class="hljs-title function_">createSnow</span>();
        <span class="hljs-title function_">createGifts</span>();
      });
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h3 data-id="heading-8">ğŸ¨ ä»£ç è§£æ</h3>
<h4 data-id="heading-9">1. åœ£è¯æ ‘çš„ç»“æ„ ğŸ—ï¸</h4>
<p>åœ£è¯æ ‘çš„ç»“æ„å…¶å®å¾ˆç®€å•ï¼š</p>
<ul>
<li><strong>æ ‘å¹²</strong>ï¼šä¸€ä¸ªæ£•è‰²çš„é•¿æ–¹å½¢</li>
<li><strong>æ ‘å† </strong>ï¼šä¸‰ä¸ªå¤§å°ä¸ä¸€çš„ä¸‰è§’å½¢å åŠ åœ¨ä¸€èµ·</li>
<li><strong>æ ‘é¡¶æ˜Ÿæ˜Ÿ</strong>ï¼šä¸€ä¸ªé‡‘è‰²çš„äº”è§’æ˜Ÿï¼ˆç”¨ CSS è¾¹æ¡†å®ç°ï¼‰</li>
<li><strong>è£…é¥°å“</strong>ï¼šå½©è‰²çš„å°åœ†ç‚¹ï¼Œéšæœºåˆ†å¸ƒåœ¨æ ‘å† ä¸Š</li>
<li><strong>é›ªèŠ±</strong>ï¼šç™½è‰²çš„å°åœ†ç‚¹ï¼Œä»å¤©ä¸Šé£˜è½</li>
<li><strong>ç¤¼ç‰©ç›’</strong>ï¼šå½©è‰²çš„æ­£æ–¹å½¢ï¼Œå¸¦æœ‰ç™½è‰²ä¸å¸¦</li>
</ul>
<h4 data-id="heading-10">2. CSS çš„é­”æ³• âœ¨</h4>
<ul>
<li><strong>æ¸å˜èƒŒæ™¯</strong>ï¼šè®©æ ‘å¹²å’Œæ ‘å† çœ‹èµ·æ¥æ›´æœ‰å±‚æ¬¡æ„Ÿ</li>
<li><strong>åŠ¨ç”»æ•ˆæœ</strong>ï¼š
<ul>
<li>æ ‡é¢˜å‘å…‰åŠ¨ç”» <code>glow</code></li>
<li>æ˜Ÿæ˜Ÿé—ªçƒåŠ¨ç”» <code>twinkle</code></li>
<li>è£…é¥°å“é—ªçƒåŠ¨ç”» <code>blink</code></li>
<li>é›ªèŠ±ä¸‹è½åŠ¨ç”» <code>fall</code></li>
<li>ç¤¼ç‰©ç›’å¼¹è·³åŠ¨ç”» <code>bounce</code></li>
</ul>
</li>
<li><strong>å®šä½æŠ€å·§</strong>ï¼šä½¿ç”¨ <code>position: absolute</code> å’Œ <code>transform: translateX(-50%)</code> è®©å…ƒç´ å±…ä¸­</li>
</ul>
<h4 data-id="heading-11">3. JavaScript çš„çµé­‚ ğŸ§ </h4>
<ul>
<li><strong>åŠ¨æ€ç”Ÿæˆè£…é¥°å“</strong>ï¼šéšæœºä½ç½®ã€éšæœºé¢œè‰²ã€éšæœºé—ªçƒå»¶è¿Ÿ</li>
<li><strong>é›ªèŠ±ç”Ÿæˆå™¨</strong>ï¼š100 ç‰‡é›ªèŠ±ï¼Œéšæœºå¤§å°ã€éšæœºé€Ÿåº¦ã€éšæœºä½ç½®</li>
<li><strong>ç¤¼ç‰©ç›’ç”Ÿæˆ</strong>ï¼š4 ä¸ªä¸åŒé¢œè‰²çš„ç¤¼ç‰©ç›’ï¼Œå¸¦æœ‰å¼¹è·³æ•ˆæœ</li>
</ul>
<h3 data-id="heading-12">ğŸ æ‰©å±•åŠŸèƒ½</h3>
<p>å¦‚æœä½ è§‰å¾—è¿™ä¸ªåœ£è¯æ ‘è¿˜ä¸å¤Ÿç‚«é…·ï¼Œä½ å¯ä»¥å°è¯•ï¼š</p>
<ol>
<li><strong>æ·»åŠ éŸ³ä¹</strong>ï¼šç”¨ HTML5 çš„ <code>audio</code> æ ‡ç­¾æ·»åŠ åœ£è¯æ­Œæ›² ğŸµ</li>
<li><strong>äº¤äº’æ•ˆæœ</strong>ï¼šç‚¹å‡»åœ£è¯æ ‘ä¼šä¸‹é›ªæˆ–æ’­æ”¾éŸ³ä¹ ğŸ¶</li>
<li><strong>3D æ•ˆæœ</strong>ï¼šä½¿ç”¨ CSS 3D å˜æ¢è®©åœ£è¯æ ‘æ—‹è½¬ ğŸŒ€</li>
<li><strong>æ›´å¤šè£…é¥°å“</strong>ï¼šæ·»åŠ å½©ç¯ã€é“ƒé“›ã€è¢œå­ç­‰ ğŸ§¦</li>
</ol>
<h3 data-id="heading-13">ğŸ¤£ ç¨‹åºå‘˜çš„åœ£è¯èŠ‚</h3>
<p>ä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜ï¼Œæˆ‘ä»¬çš„åœ£è¯èŠ‚æ˜¯è¿™æ ·çš„ï¼š</p>
<ul>
<li>åˆ«äººåœ¨è£…é¥°åœ£è¯æ ‘ï¼Œæˆ‘ä»¬åœ¨è£…é¥°ä»£ç </li>
<li>åˆ«äººåœ¨æ‹†ç¤¼ç‰©ï¼Œæˆ‘ä»¬åœ¨æ‹† bug</li>
<li>åˆ«äººåœ¨åƒç«é¸¡ï¼Œæˆ‘ä»¬åœ¨åƒå¤–å–</li>
<li>åˆ«äººåœ¨çœ‹æ˜¥æ™šï¼Œæˆ‘ä»¬åœ¨çœ‹æŠ€æœ¯æ–‡æ¡£</li>
</ul>
<p>ä½†æ˜¯æ²¡å…³ç³»ï¼Œæˆ‘ä»¬æœ‰å±äºè‡ªå·±çš„å¿«ä¹ï¼å½“çœ‹åˆ°è‡ªå·±å†™çš„åœ£è¯æ ‘åœ¨å±å¹•ä¸Šé—ªé—ªå‘å…‰æ—¶ï¼Œé‚£ç§æˆå°±æ„Ÿæ˜¯æ— æ³•è¨€å–»çš„ï¼ğŸŒŸ</p>
<h3 data-id="heading-14">ğŸ„ ç»“è¯­</h3>
<p>å¥½äº†ï¼Œä»Šå¤©çš„åœ£è¯æ ‘æ•™ç¨‹å°±åˆ°è¿™é‡Œäº†ï¼å¸Œæœ›ä½ èƒ½å–œæ¬¢è¿™ä¸ªä»£ç åœ£è¯æ ‘ï¼Œä¹Ÿå¸Œæœ›ä½ èƒ½åœ¨åœ£è¯èŠ‚æ”¶è·æ»¡æ»¡çš„å¿«ä¹å’Œå¹¸ç¦ï¼ğŸ…</p>
<p>è®°ä½ï¼Œç”Ÿæ´»å°±åƒåœ£è¯æ ‘ï¼Œéœ€è¦æˆ‘ä»¬ç”¨å¿ƒå»è£…é¥°ï¼Œæ‰èƒ½å˜å¾—æ›´åŠ ç¾å¥½ï¼âœ¨</p>
<p>æœ€åï¼Œç¥å¤§å®¶ï¼š</p>
<ul>
<li>åœ£è¯å¿«ä¹ï¼ğŸ„</li>
<li>ä»£ç æ—  bugï¼ğŸ›âŒ</li>
<li>å·¥èµ„æ¶¨ä¸åœï¼ğŸ’°</li>
<li>æ°¸è¿œä¸è„±å‘ï¼ğŸ‘¨â€ğŸ’»ğŸ‘©â€ğŸ’»</li>
</ul>
<p>Merry Christmas and Happy New Year! ğŸ‰</p>
<hr/>
<p>ğŸ’¡ <strong>å°è´´å£«</strong>ï¼šå¦‚æœä½ è§‰å¾—è¿™ä¸ªåœ£è¯æ ‘ä¸é”™ï¼Œåˆ«å¿˜äº†åˆ†äº«ç»™ä½ çš„æœ‹å‹ï¼Œè®©ä»–ä»¬ä¹Ÿæ„Ÿå—ä¸€ä¸‹ç¨‹åºå‘˜çš„åœ£è¯æµªæ¼«ï¼ğŸ˜‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¢è¯•å®˜æœ€çˆ±é—®çš„ Android æ•°æ®ä¼ é€’é—®é¢˜]]></title>    <link>https://juejin.cn/post/7587256133791957032</link>    <guid>https://juejin.cn/post/7587256133791957032</guid>    <pubDate>2025-12-25T01:03:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587256133791957032" data-draft-id="7582922476221710351" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¢è¯•å®˜æœ€çˆ±é—®çš„ Android æ•°æ®ä¼ é€’é—®é¢˜"/> <meta itemprop="keywords" content="Kotlin,Android"/> <meta itemprop="datePublished" content="2025-12-25T01:03:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="RockByte"/> <meta itemprop="url" content="https://juejin.cn/user/1046390797768519"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¢è¯•å®˜æœ€çˆ±é—®çš„ Android æ•°æ®ä¼ é€’é—®é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1046390797768519/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    RockByte
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T01:03:32.000Z" title="Thu Dec 25 2025 01:03:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;color:#282d36}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px;color:#2f845e}.markdown-body h2{font-size:22px;display:inline-block;font-weight:700;background:#2f845e;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(47,132,194,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 32px);border-bottom:3px solid #2f845e}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%;box-shadow:6px 6px 6px #888}.markdown-body hr{border:none;border-top:1px solid rgba(66,185,131,.15);margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#f6ffed;color:#52c41a;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:16px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#262626;border:1px solid #2f845e;border-top:8px solid #2f845e;background:linear-gradient(180deg,rgba(66,185,131,.1),transparent)!important}.markdown-body pre&gt;code.hljs[lang]:before{top:8px!important;color:#2f845e!important}.markdown-body pre&gt;code.language-awesome_error{border:1px solid #ff4d4f!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#ff4d4f!important;background:#fff2f0!important}.markdown-body pre&gt;code.language-awesome_error:before{content:"!"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#ff4d4f!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_warn{border:1px solid #ffc46f!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#ffc46f!important;background:#fffbe6!important}.markdown-body pre&gt;code.language-awesome_warn:before{content:"â˜‚"!important;position:absolute;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#ffc46f!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_success{border:1px solid #52c41a!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#52c41a!important;background:#f6ffed!important}.markdown-body pre&gt;code.language-awesome_success:before{content:"âœ“"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#52c41a!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_info{border:1px solid #1890ff!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#1890ff!important;background:#e6f7ff!important}.markdown-body pre&gt;code.language-awesome_info:before{content:"i"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#1890ff!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body strong{background-color:inherit;color:#2f845e}.markdown-body em{background-color:inherit;color:#949415}.markdown-body a{text-decoration:none;color:#2f8e54;border-bottom:1px solid #3f9e64}.markdown-body a:active,.markdown-body a:hover{color:#3f9e64}.markdown-body a[class^=footnote]{margin-left:4px}.markdown-body a:before{content:"â¤ "}.markdown-body table{font-size:12px;width:100%;max-width:100%;overflow:auto;border:2px solid #2f8e54}.markdown-body thead{background:#2f8e54;color:#fff;text-align:left;font-weight:700}.markdown-body tr:nth-child(2n){background-color:rgba(153,255,188,.1)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:22px}.markdown-body td{min-width:120px}.markdown-body blockquote{padding:1px 22px;margin:22px 0;border-left:6px solid #2f845e;background-color:rgba(66,185,131,.1);border-radius:2px}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#2f845e}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px;color:#282d36}.markdown-body del{color:#2f845e}.markdown-body input[type=checkbox]:checked:before{content:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA/klEQVQ4T72TMU7DQBBF318XdFR06egQEnAXRINEGlqgowoIR8AF4AZOZ4JEGq5AC5EixBU4A55BNrEVHAcSBTHlaubt37/zxZKlcn7n6mDPXJvz8IJ89HzWu8t7C8D2dfsY52ae4apHnLx0ktsCsHXZjiUuFgG40x2eJ/H/AhztB+zDUTpLwWj8jGkzxSHiHaMPrDQC8sMoilKzLAUqiKQjmb+ZuAdW80tmelCHODoNgSfP7AFprTTaRTzsJN1GEyuIZ7uW6TEEHwCtyV/6EVBKJHhfzgC0Xv/iXwEFBF4FG0378bd7sPQq5xK/hSnk6sdlX3mZrKkwLZKBeu8n9XuWEUE7X+YAAAAASUVORK5CYII=);position:relative;top:-1px;left:-1px}.markdown-body .math .katex{font-family:Menlo,Monaco,Consolas,Courier New,monospace;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#f6ffed;color:#52c41a;font-size:.87em;padding:.065em .4em}@media (max-width:720px){.markdown-body h1{font-size:22px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="xcode">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff;color:#000}.xml .hljs-meta{color:silver}.hljs-comment,.hljs-quote{color:#007400}.hljs-attribute,.hljs-keyword,.hljs-literal,.hljs-name,.hljs-selector-tag,.hljs-tag{color:#aa0d91}.hljs-template-variable,.hljs-variable{color:#3f6e74}.hljs-code,.hljs-meta-string,.hljs-string{color:#c41a16}.hljs-link,.hljs-regexp{color:#0e0eff}.hljs-bullet,.hljs-number,.hljs-symbol,.hljs-title{color:#1c00cf}.hljs-meta,.hljs-section{color:#643820}.hljs-built_in,.hljs-builtin-name,.hljs-class .hljs-title,.hljs-params,.hljs-type{color:#5c2699}.hljs-attr{color:#836c28}.hljs-subst{color:#000}.hljs-formula{background-color:#eee;font-style:italic}.hljs-addition{background-color:#baeeba}.hljs-deletion{background-color:#ffc8bd}.hljs-selector-class,.hljs-selector-id{color:#9b703f}.hljs-doctag,.hljs-strong{font-weight:700}.hljs-emphasis{font-style:italic}</style><p><em>æœ¬ç³»åˆ—ä¸ºå°è¯´ã€Šé€†è¢­è¥¿äºŒæ——ã€‹çš„æŠ€æœ¯è®²è§£ï¼Œç”¨äºè¯¦ç»†è¯´æ˜<a href="https://juejin.cn/post/7586531677720723491" target="_blank" title="https://juejin.cn/post/7586531677720723491">å‰§æƒ…</a>é‡Œæ¶‰åŠçš„å¼€å‘ç»†èŠ‚ã€‚</em></p>
<h2 data-id="heading-0">å¦‚ä½•å¤„ç† Deep link ï¼Ÿ</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/06054d3e801d407cb8df8b1b1ea3270f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767229412&amp;x-signature=bILC1nLz6EuGc%2B%2B2OvysrwTXr6E%3D" alt="0.png" loading="lazy"/></p>
<p><strong>Deep link</strong> å…è®¸ç”¨æˆ·ä»å¤–éƒ¨æ¥æºï¼ˆæ¯”å¦‚ä¸€ä¸ª <strong>URL</strong> æˆ–é€šçŸ¥ï¼‰ç›´æ¥è·³è½¬åˆ°ä½  App å†…çš„æŸä¸ªç‰¹å®šé¡µé¢æˆ–åŠŸèƒ½ã€‚å¤„ç† <strong>Deep link</strong> ï¼Œéœ€è¦åœ¨ <code>AndroidManifest.xml</code> ä¸­å®šä¹‰å¯¹åº”çš„ <code>intent-filter</code>ï¼Œå¹¶åœ¨ç›¸åº”çš„ <code>Activity</code> æˆ– <code>Fragment</code> ä¸­å¤„ç†ä¼ å…¥çš„ <code>Intent</code>ã€‚</p>
<h3 data-id="heading-1">é¢è¯•é—®é¢˜</h3>
<p>å¦‚ä½•åœ¨ Android ä¸­æµ‹è¯• <strong>Deep link</strong>ï¼Ÿï¼ˆè¿™ä¸ªé—®é¢˜å‰å®³åœ¨ï¼Œä¸ä»…ä»…è¦ä¼šå†™ <strong>Deep link</strong>ï¼Œè¿˜è¦ä¼šæµ‹è¯•ï¼‰</p>
<p>æœ‰å“ªäº›å¸¸è§çš„è°ƒè¯•æŠ€å·§ï¼Œèƒ½ç¡®ä¿å®ƒä»¬åœ¨ä¸åŒè®¾å¤‡å’Œåœºæ™¯ä¸‹æ­£å¸¸å·¥ä½œï¼Ÿ</p>
<h3 data-id="heading-2">æ­¥éª¤ 1ï¼šå®šä¹‰ Deep link</h3>
<p>è¦å¯ç”¨ <strong>Deep link</strong>ï¼Œä½ éœ€è¦åœ¨ <code>AndroidManifest.xml</code> ä¸­ä¸ºç›®æ ‡ <code>Activity</code> å£°æ˜ä¸€ä¸ª <code>intent-filter</code>ã€‚è¿™ä¸ªè¿‡æ»¤å™¨ä¼šæŒ‡å®šä½ çš„ App èƒ½å“åº”çš„ <strong>URL</strong> ç»“æ„æˆ–åè®®ã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">activity</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">".MyDeepLinkActivity"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">intent-filter</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.intent.action.VIEW"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">category</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.intent.category.DEFAULT"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">category</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.intent.category.BROWSABLE"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">data</span>
            <span class="hljs-attr">android:scheme</span>=<span class="hljs-string">"https"</span>
            <span class="hljs-attr">android:host</span>=<span class="hljs-string">"example.com"</span>
            <span class="hljs-attr">android:pathPrefix</span>=<span class="hljs-string">"/deepLink"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">intent-filter</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">activity</span>&gt;</span>
</code></pre>
<p>å®ƒç”±ä»¥ä¸‹ä¸‰éƒ¨åˆ†æ„æˆï¼š</p>
<ul>
<li><code>android:scheme</code>ï¼šæŒ‡å®š <strong>URL</strong> åè®®ï¼ˆä¾‹å¦‚ <code>https</code>ï¼‰ã€‚</li>
<li><code>android:host</code>ï¼šæŒ‡å®šåŸŸåï¼ˆä¾‹å¦‚ <code>example.com</code>ï¼‰ã€‚</li>
<li><code>android:pathPrefix</code>ï¼šå®šä¹‰ <strong>URL</strong> ä¸­çš„è·¯å¾„å‰ç¼€ï¼ˆä¾‹å¦‚ <code>/deepLink</code>ï¼‰ã€‚</li>
</ul>
<p>è¿™ä¸ªé…ç½®å¯ä»¥è®©ç±»ä¼¼ <code>https://example.com/deepLink</code> çš„é“¾æ¥ç›´æ¥æ‰“å¼€ <code>MyDeepLinkActivity</code>ã€‚</p>
<h3 data-id="heading-3">æ­¥éª¤ 2ï¼šå¤„ç† Deep link</h3>
<p>åœ¨ <code>Activity</code> å†…éƒ¨ï¼Œæå–å¹¶å¤„ç†ä¼ å…¥çš„ <code>Intent</code> æ•°æ®ï¼Œä»¥ä¾¿è·³è½¬åˆ°å¯¹åº”é¡µé¢æˆ–æ‰§è¡Œç‰¹å®šæ“ä½œã€‚</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyDeepLinkActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        setContentView(R.layout.activity_my_deep_link)

        <span class="hljs-comment">// è·å– intent æ•°æ®</span>
        <span class="hljs-keyword">val</span> intentData: Uri? = intent?.<span class="hljs-keyword">data</span>
        <span class="hljs-keyword">if</span> (intentData != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">val</span> id = intentData.getQueryParameter(<span class="hljs-string">"id"</span>)  <span class="hljs-comment">// ç¤ºä¾‹ï¼šè·å–æŸ¥è¯¢å‚æ•°</span>
            navigateToFeature(id)
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">navigateToFeature</span><span class="hljs-params">(id: <span class="hljs-type">String</span>?)</span></span> {
        <span class="hljs-comment">// æ ¹æ® Deep link æ•°æ®è·³è½¬åˆ°æŒ‡å®šé¡µé¢</span>
        <span class="hljs-keyword">if</span> (id != <span class="hljs-literal">null</span>) {
            Toast.makeText(<span class="hljs-keyword">this</span>, <span class="hljs-string">"Navigating to item: <span class="hljs-variable">$id</span>"</span>, Toast.LENGTH_SHORT).show()
            <span class="hljs-comment">// navigate(...) or doSomething(...)</span>
        }
    }
}
</code></pre>
<p>è¿™æ®µä»£ç ä¼šåœ¨ <code>onCreate</code> ä¸­æ£€æŸ¥æ˜¯å¦æœ‰ä¼ å…¥çš„ <strong>URL</strong> æ•°æ®ï¼Œå¦‚æœæœ‰ï¼Œå°±æå–å…¶ä¸­çš„å‚æ•°ï¼ˆæ¯”å¦‚ <code>id</code>ï¼‰ï¼Œç„¶åè·³è½¬åˆ°å¯¹åº”çš„é¡µé¢æˆ–æ‰§è¡Œç›¸åº”é€»è¾‘ã€‚</p>
<h3 data-id="heading-4">æ­¥éª¤ 3ï¼šæµ‹è¯•ä¸€ä¸‹</h3>
<p>è¦æµ‹è¯• <strong>Deep link</strong>ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ <code>adb</code> å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-sh" lang="sh">adb shell am start -a android.intent.action.VIEW \
-d <span class="hljs-string">"https://example.com/deepLink?id=123"</span> \
com.example.myapp
</code></pre>
<p>è¯¥å‘½ä»¤ä¼šæ¨¡æ‹Ÿä¸€ä¸ª <strong>Deep link</strong>ï¼Œå¹¶å¯åŠ¨ä½ çš„ App æ¥å¤„ç†å®ƒã€‚</p>
<h3 data-id="heading-5">æ³¨æ„äº‹é¡¹</h3>
<ul>
<li><strong>è‡ªå®šä¹‰åè®®</strong>ï¼šä½ å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰åè®®ï¼ˆå¦‚ <code>myapp://</code>ï¼‰æ¥å®ç°å†…éƒ¨é“¾æ¥ï¼Œä½†å»ºè®®ä¼˜å…ˆä½¿ç”¨ <strong>HTTP(S) URL</strong>ï¼Œä»¥è·å¾—æ›´å¥½çš„å…¼å®¹æ€§ã€‚</li>
<li><strong>å¯¼èˆªé€»è¾‘</strong>ï¼šæ ¹æ® <strong>Deep link</strong> ä¸­çš„æ•°æ®ï¼Œä½¿ç”¨ <code>Intent</code> è·³è½¬åˆ° App å†…çš„å…¶ä»– <code>Activity</code> æˆ– <code>Fragment</code>ã€‚</li>
<li><strong>å¼‚å¸¸å¤„ç†</strong>ï¼šç¡®ä¿ App èƒ½æ­£ç¡®å¤„ç† <strong>Deep link</strong> æ•°æ®æ— æ•ˆæˆ–ä¸å®Œæ•´çš„æƒ…å†µï¼Œé¿å…å´©æºƒæˆ–ä½“éªŒå¼‚å¸¸ã€‚</li>
<li><strong>App Links</strong>ï¼šè‹¥å¸Œæœ› <strong>HTTP(S)</strong>  <strong>Deep link</strong> ç›´æ¥åœ¨ä½ çš„ App ä¸­æ‰“å¼€è€Œéæµè§ˆå™¨ï¼Œéœ€é…ç½® <strong>App Links</strong>ã€‚</li>
</ul>
<h3 data-id="heading-6">æ€»ç»“</h3>
<p>å¤„ç† <strong>Deep link</strong> çš„å…³é”®åœ¨äºï¼šåœ¨ <code>AndroidManifest.xml</code> ä¸­å®šä¹‰ <strong>Deep link</strong> æ¨¡å¼ï¼Œå¹¶åœ¨ç›®æ ‡ <code>Activity</code> ä¸­è§£æå’Œå“åº”è¿™äº›æ•°æ®ã€‚é€šè¿‡æå–å¹¶ç†è§£ <strong>Deep link</strong> å†…å®¹ï¼Œä½ å¯ä»¥å°†ç”¨æˆ·ç²¾å‡†å¼•å¯¼è‡³ App çš„ç‰¹å®šåŠŸèƒ½æˆ–å†…å®¹ï¼Œä»è€Œæå‡ç”¨æˆ·ä½“éªŒå’Œç”¨æˆ·å‚ä¸åº¦ã€‚</p>
<hr/>
<h2 data-id="heading-7">ä»€ä¹ˆæ˜¯ä»»åŠ¡å’Œè¿”å›æ ˆï¼Ÿ</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e0ef7fe4f1084e82b167aac8ba332d2c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767229412&amp;x-signature=4dggi4aLdoYPqPGwaGNnhlaWy8E%3D" alt="1.png" loading="lazy"/></p>
<p>ä¸€ä¸ªä»»åŠ¡æ˜¯ä¸€ç»„ç”¨æˆ·ä¸ºå®Œæˆç‰¹å®šç›®æ ‡è€Œäº¤äº’çš„ <code>Activity</code>ã€‚ä»»åŠ¡è¢«ç»„ç»‡æˆä¸€ä¸ªè¿”å›æ ˆï¼Œå®ƒæ˜¯ä¸€ç§åè¿›å…ˆå‡ºçš„ç»“æ„ï¼Œå½“ <code>Activity</code> å¯åŠ¨æ—¶ä¼šè¢«æ·»åŠ åˆ°æ ˆä¸­ï¼Œå½“ç”¨æˆ·ç‚¹å‡»è¿”å›æŒ‰é’®æˆ–ç³»ç»Ÿå›æ”¶èµ„æºæ—¶ï¼Œæ´»åŠ¨ä¼šä»æ ˆä¸­ç§»é™¤ã€‚</p>
<h3 data-id="heading-8">é¢è¯•é—®é¢˜</h3>
<p><code>singleTask</code> å’Œ <code>singleInstance</code> å¯åŠ¨æ¨¡å¼æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿåœ¨ä»€ä¹ˆåœºæ™¯ä¸‹ä½ ä¼šé€‰æ‹©ä½¿ç”¨å®ƒä»¬ï¼Ÿ</p>
<p>æœ‰å“ªäº›ä¸åŒçš„ <code>Activity</code> å¯åŠ¨æ¨¡å¼ï¼Ÿå®ƒä»¬å¦‚ä½•å½±å“ä»»åŠ¡å’Œè¿”å›æ ˆçš„è¡Œä¸ºï¼Ÿ</p>
<h3 data-id="heading-9">ä»»åŠ¡</h3>
<p>å½“ä¸€ä¸ª <code>Activity</code> è¢«å¯åŠ¨æ—¶ï¼ˆé€šå¸¸æ¥è‡ªå¯åŠ¨å™¨æˆ–é€šè¿‡ <code>Intent</code>ï¼‰ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªä»»åŠ¡ã€‚æ ¹æ® <code>Intent</code> å’Œ <code>Activity</code> å¯åŠ¨æ¨¡å¼çš„é…ç½®ï¼Œä¸€ä¸ªä»»åŠ¡å¯ä»¥è·¨è¶Šå¤šä¸ªåº”ç”¨ç¨‹åºåŠå…¶ <code>Activity</code>ã€‚</p>
<p>ä¾‹å¦‚ï¼Œåœ¨ç”µå­é‚®ä»¶åº”ç”¨ä¸­ç‚¹å‡»ä¸€ä¸ªé“¾æ¥å¯èƒ½ä¼šåœ¨åŒä¸€ä¸ªä»»åŠ¡ä¸­æ‰“å¼€æµè§ˆå™¨ã€‚ä»»åŠ¡ä¼šä¸€ç›´ä¿æŒæ´»è·ƒçŠ¶æ€ï¼Œç›´åˆ°å…¶å…³è”çš„æ‰€æœ‰ <code>Activity</code> éƒ½è¢«é”€æ¯ã€‚</p>
<h3 data-id="heading-10">è¿”å›æ ˆ</h3>
<p>è¿”å›æ ˆç”¨äºç»´æŠ¤ä»»åŠ¡ä¸­ <code>Activity</code> çš„å†å²è®°å½•ã€‚</p>
<p>å½“ç”¨æˆ·å¯¼èˆªåˆ°ä¸€ä¸ªæ–°çš„ <code>Activity</code> æ—¶ï¼Œå½“å‰ <code>Activity</code> ä¼šè¢«å‹å…¥æ ˆé¡¶ã€‚</p>
<p>ç‚¹å‡»è¿”å›æŒ‰é’®ä¼šå°†æ ˆé¡¶çš„ <code>Activity</code> å¼¹å‡ºï¼Œå¹¶æ¢å¤å…¶ä¸‹æ–¹çš„ <code>Activity</code>ã€‚è¿™ç§æœºåˆ¶ç¡®ä¿äº†ç”¨æˆ·æ“ä½œæµç¨‹ä¸­çš„ç›´è§‚å¯¼èˆªå’Œè¿ç»­æ€§ã€‚</p>
<p>ä»»åŠ¡å’Œè¿”å›æ ˆçš„è¡Œä¸ºå— <code>Activity</code> å¯åŠ¨æ¨¡å¼ï¼ˆ<strong>launch modes</strong>ï¼‰å’Œ <code>Intent</code> æ ‡å¿—ï¼ˆ<strong>intent flags</strong>ï¼‰çš„å½±å“ã€‚</p>
<p>å¯åŠ¨æ¨¡å¼å’Œ <code>Intent</code> æ ‡å¿—æ˜¯ç”¨äºæ§åˆ¶ä»»åŠ¡å’Œè¿”å›æ ˆä¸­ <code>Activity</code> è¡Œä¸ºçš„æœºåˆ¶ã€‚è¿™äº›é…ç½®å…è®¸å¼€å‘è€…å®šä¹‰ <code>Activity</code> å¦‚ä½•è¢«å¯åŠ¨ä»¥åŠå®ƒä»¬å¦‚ä½•ä¸å…¶ä»– <code>Activity</code> è¿›è¡Œäº¤äº’ã€‚</p>
<h3 data-id="heading-11">å¯åŠ¨æ¨¡å¼</h3>
<p>å¯åŠ¨æ¨¡å¼å†³å®šäº† <code>Activity</code> å¦‚ä½•è¢«å®ä¾‹åŒ–ä»¥åŠåœ¨è¿”å›æ ˆä¸­å¦‚ä½•è¢«å¤„ç†ã€‚Android ä¸­æœ‰å››ç§ä¸»è¦çš„å¯åŠ¨æ¨¡å¼ï¼š</p>
<ol>
<li><strong>standard</strong>ï¼šè¿™æ˜¯é»˜è®¤çš„å¯åŠ¨æ¨¡å¼ã€‚æ¯æ¬¡å¯åŠ¨è¯¥ <code>Activity</code> æ—¶ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹å¹¶å°†å…¶æ·»åŠ åˆ°è¿”å›æ ˆä¸­ï¼Œå³ä½¿å·²ç»å­˜åœ¨ä¸€ä¸ªå®ä¾‹ã€‚</li>
<li><strong>singleTop</strong>ï¼šå¦‚æœè¿”å›æ ˆé¡¶éƒ¨å·²å­˜åœ¨è¯¥ <code>Activity</code> çš„å®ä¾‹ï¼Œåˆ™ä¸ä¼šåˆ›å»ºæ–°çš„å®ä¾‹ã€‚ç›¸åï¼Œç°æœ‰å®ä¾‹ä¼šåœ¨ <code>onNewIntent()</code> æ–¹æ³•ä¸­å¤„ç†è¯¥ <code>Intent</code>ã€‚</li>
<li><strong>singleTask</strong>ï¼šåœ¨ä»»åŠ¡ä¸­ä»…å­˜åœ¨è¯¥ <code>Activity</code> çš„ä¸€ä¸ªå®ä¾‹ã€‚å¦‚æœè¯¥å®ä¾‹å·²å­˜åœ¨ï¼Œç³»ç»Ÿä¼šå°†å…¶ç½®äºå‰å°ï¼Œå¹¶è°ƒç”¨å…¶ <code>onNewIntent()</code> æ–¹æ³•ã€‚è¿™ç§æ¨¡å¼é€‚ç”¨äºä½œä¸ºåº”ç”¨å…¥å£ç‚¹çš„ <code>Activity</code>ã€‚</li>
<li><strong>singleInstance</strong>ï¼šä¸ <code>singleTask</code> ç±»ä¼¼ï¼Œä½†è¯¥ <code>Activity</code> ä¼šè¢«æ”¾ç½®åœ¨ä¸€ä¸ªç‹¬ç«‹çš„ä»»åŠ¡ä¸­ï¼Œä¸å…¶ä»– <code>Activity</code> åˆ†ç¦»ã€‚è¿™ç¡®ä¿äº†æ²¡æœ‰å…¶ä»– <code>Activity</code> èƒ½æˆä¸ºè¯¥ä»»åŠ¡çš„ä¸€éƒ¨åˆ†ã€‚</li>
</ol>
<h3 data-id="heading-12">Intent æ ‡å¿—</h3>
<p><code>Intent</code> æ ‡å¿—ç”¨äºä¿®æ”¹ <code>Activity</code> çš„å¯åŠ¨æ–¹å¼ï¼Œæˆ–å½±å“å‘é€ <code>Intent</code> æ—¶è¿”å›æ ˆçš„è¡Œä¸ºã€‚ä¸€äº›å¸¸ç”¨çš„æ ‡å¿—åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>FLAG_ACTIVITY_NEW_TASK</strong>ï¼šåœ¨æ–°ä»»åŠ¡ä¸­å¯åŠ¨ <code>Activity</code>ï¼Œæˆ–è€…å¦‚æœè¯¥ä»»åŠ¡å·²å­˜åœ¨ï¼Œåˆ™å°†å…¶å¸¦åˆ°å‰å°ã€‚</li>
<li><strong>FLAG_ACTIVITY_CLEAR_TOP</strong>ï¼šå¦‚æœè¿”å›æ ˆä¸­å·²å­˜åœ¨è¯¥ <code>Activity</code> çš„å®ä¾‹ï¼Œåˆ™æ¸…é™¤å…¶ä¸Šæ–¹çš„æ‰€æœ‰ <code>Activity</code>ï¼Œå¹¶ç”±ç°æœ‰å®ä¾‹å¤„ç†è¯¥ <code>Intent</code>ã€‚</li>
<li><strong>FLAG_ACTIVITY_SINGLE_TOP</strong>ï¼šç¡®ä¿å¦‚æœè¯¥ <code>Activity</code> ä½äºè¿”å›æ ˆé¡¶éƒ¨ï¼Œåˆ™ä¸ä¼šåˆ›å»ºæ–°å®ä¾‹ã€‚æ­¤æ ‡å¿—é€šå¸¸ä¸å…¶ä»–æ ‡å¿—ç»„åˆä½¿ç”¨ã€‚</li>
<li><strong>FLAG_ACTIVITY_NO_HISTORY</strong>ï¼šé˜²æ­¢è¯¥ <code>Activity</code> è¢«æ·»åŠ åˆ°è¿”å›æ ˆä¸­ï¼Œæ„å‘³ç€å®ƒé€€å‡ºåä¸ä¼šä¿ç•™åœ¨å†å²è®°å½•ä¸­ã€‚</li>
</ul>
<h3 data-id="heading-13">å®æˆ˜</h3>
<ul>
<li><strong>å¯åŠ¨æ¨¡å¼</strong>ï¼šä¸»è¦åœ¨ <code>AndroidManifest.xml</code> æ–‡ä»¶çš„ <code>&lt;activity&gt;</code> æ ‡ç­¾ä¸­å£°æ˜ï¼Œå…è®¸å¼€å‘è€…ä¸º <code>Activity</code> è®¾ç½®é»˜è®¤è¡Œä¸ºã€‚</li>
<li><strong>Intent æ ‡å¿—</strong>ï¼šåœ¨åˆ›å»º <code>Intent</code> æ—¶é€šè¿‡ä»£ç åŠ¨æ€åº”ç”¨ï¼Œä¸ºç‰¹å®šåœºæ™¯æä¾›äº†æ›´å¤§çš„çµæ´»æ€§ã€‚</li>
</ul>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">val</span> intent = Intent(<span class="hljs-keyword">this</span>, SecondActivity::<span class="hljs-keyword">class</span>.java).apply {
    flags = Intent.FLAG_ACTIVITY_NEW_TASK or Intent.FLAG_ACTIVITY_CLEAR_TOP
}
startActivity(intent)
</code></pre>
<p>åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œå¦‚æœ <code>SecondActivity</code> å°šæœªå­˜åœ¨ï¼Œåˆ™ä¼šåœ¨æ–°ä»»åŠ¡ä¸­å¯åŠ¨å®ƒï¼›å¦‚æœå·²å­˜åœ¨ï¼Œåˆ™æ¸…é™¤å…¶ä¸Šæ–¹çš„æ‰€æœ‰ <code>Activity</code>ã€‚</p>
<h3 data-id="heading-14">æ€»ç»“</h3>
<p>ä»»åŠ¡å’Œè¿”å›æ ˆæ˜¯ Android å¯¼èˆªæ¨¡å‹çš„æ ¸å¿ƒï¼Œé€šè¿‡ç®¡ç† <code>Activity</code> çš„ç”Ÿå‘½å‘¨æœŸå’Œå¯¼èˆªå†å²ï¼Œå®ç°æµç•…ã€æ˜“ç”¨çš„æ“ä½œæµç¨‹ã€‚å¯åŠ¨æ¨¡å¼å®šä¹‰äº† <code>Activity</code> åœ¨ä»»åŠ¡ä¸­è¢«å¯åŠ¨å’Œç®¡ç†çš„é»˜è®¤è¡Œä¸ºï¼Œè€Œ <code>Intent</code> æ ‡å¿—åˆ™åœ¨è¿è¡Œæ—¶æä¾›å¯¹ç±»ä¼¼è¡Œä¸ºçš„ç²¾ç»†æ§åˆ¶ã€‚ä¸¤è€…ç»“åˆï¼Œèƒ½å¤Ÿç²¾ç¡®åœ°ç®¡ç† <code>Activity</code> ç”Ÿå‘½å‘¨æœŸå’Œè¿”å›æ ˆå¯¼èˆªã€‚</p>
<hr/>
<h2 data-id="heading-15">Bundle çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9dbfad303d5f4e3d8592f397b51ff8bf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767229412&amp;x-signature=j66DItFPkNAHudvbHW8i15XLlWg%3D" alt="2.png" loading="lazy"/></p>
<p><code>Bundle</code> æ˜¯ä¸€ç§é”®å€¼å¯¹æ•°æ®ç»“æ„ï¼Œç”¨äºåœ¨ç»„ä»¶ä¹‹é—´ä¼ é€’æ•°æ®ï¼Œæ¯”å¦‚ <code>Activity</code>ã€<code>Fragment</code> å’Œ <code>Service</code>ã€‚å®ƒå¸¸è¢«ç”¨æ¥åœ¨åº”ç”¨å†…éƒ¨é«˜æ•ˆåœ°ä¼ è¾“å°‘é‡æ•°æ®ã€‚</p>
<p><code>Bundle</code> è½»é‡ä¸”è®¾è®¡ç”¨äºå°†æ•°æ®åºåˆ—åŒ–ä¸º Android ç³»ç»Ÿæ˜“äºç®¡ç†ä¸ä¼ è¾“çš„æ ¼å¼ã€‚</p>
<h3 data-id="heading-16">é¢è¯•é—®é¢˜</h3>
<p><code>onSaveInstanceState()</code> æ˜¯å¦‚ä½•åˆ©ç”¨ <code>Bundle</code> åœ¨é…ç½®å˜æ›´ï¼ˆå¦‚å±å¹•æ—‹è½¬ï¼‰æœŸé—´ä¿å­˜ UI çŠ¶æ€çš„ï¼Ÿ</p>
<p><code>Bundle</code> ä¸­å¯ä»¥å­˜å‚¨å“ªäº›ç±»å‹çš„æ•°æ®ï¼Ÿ</p>
<h3 data-id="heading-17">å¸¸è§ä½¿ç”¨åœºæ™¯</h3>
<ol>
<li><strong>åœ¨ <code>Activity</code> ä¹‹é—´ä¼ é€’æ•°æ®</strong>ï¼šå¯åŠ¨æ–° <code>Activity</code> æ—¶ï¼Œå¯ä»¥å°† <code>Bundle</code> é™„åŠ åˆ° <code>Intent</code> ä¸Šï¼ŒæŠŠæ•°æ®ä¼ ç»™ç›®æ ‡ <code>Activity</code>ã€‚</li>
<li><strong>åœ¨ <code>Fragment</code> ä¹‹é—´ä¼ é€’æ•°æ®</strong>ï¼šåœ¨ <code>Fragment</code> äº‹åŠ¡ä¸­ï¼Œé€šè¿‡ <code>setArguments()</code> å’Œ <code>getArguments()</code> ä½¿ç”¨ <code>Bundle</code> åœ¨ <code>Fragment</code> é—´ä¼ é€’æ•°æ®ã€‚</li>
<li><strong>ä¿å­˜å’Œæ¢å¤å®ä¾‹çŠ¶æ€</strong>ï¼šåœ¨ <code>onSaveInstanceState()</code> å’Œ <code>onRestoreInstanceState()</code> ç­‰ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­ï¼Œ<code>Bundle</code> ç”¨äºåœ¨é…ç½®å˜æ›´ï¼ˆå¦‚å±å¹•æ—‹è½¬ï¼‰æ—¶ä¿å­˜å’Œæ¢å¤ä¸´æ—¶çš„ UI çŠ¶æ€ã€‚</li>
<li><strong>å‘ <code>Service</code> ä¼ é€’æ•°æ®</strong>ï¼šå¯åŠ¨ <code>Service</code> æˆ–å‘ç»‘å®šçš„ <code>Service</code> ä¼ å‚æ—¶ï¼Œ<code>Bundle</code> å¯ä»¥æºå¸¦æ•°æ®ã€‚</li>
</ol>
<h3 data-id="heading-18">å·¥ä½œåŸç†</h3>
<p><code>Bundle</code> é€šè¿‡å°†æ•°æ®åºåˆ—åŒ–ä¸ºé”®å€¼å¯¹ç»“æ„æ¥å·¥ä½œã€‚é”®æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œå€¼å¯ä»¥æ˜¯åŸºæœ¬ç±»å‹ã€<code>Serializable</code>ã€<code>Parcelable</code> å¯¹è±¡ï¼Œç”šè‡³æ˜¯å…¶ä»– <code>Bundle</code>ã€‚è¿™ç§è®¾è®¡ä½¿å¾—æ•°æ®å­˜å‚¨å’Œä¼ è¾“æ›´é«˜æ•ˆã€‚</p>
<h3 data-id="heading-19">Activity ä¹‹é—´ä¼ é€’æ•°æ®</h3>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-comment">// ä» Activity A å‘é€æ•°æ®</span>
<span class="hljs-keyword">val</span> intent = Intent(<span class="hljs-keyword">this</span>, ActivityB::<span class="hljs-keyword">class</span>.java).apply {
    putExtra(<span class="hljs-string">"user_name"</span>, <span class="hljs-string">"John Doe"</span>)
    putExtra(<span class="hljs-string">"user_age"</span>, <span class="hljs-number">25</span>)
}
startActivity(intent)

<span class="hljs-comment">// åœ¨ Activity B ä¸­æ¥æ”¶æ•°æ®</span>
<span class="hljs-keyword">val</span> name = intent.getStringExtra(<span class="hljs-string">"user_name"</span>)
<span class="hljs-keyword">val</span> age = intent.getIntExtra(<span class="hljs-string">"user_age"</span>, -<span class="hljs-number">1</span>)
</code></pre>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ•°æ®é€šè¿‡ <code>Intent.putExtra()</code> å†…éƒ¨å°è£…è¿›ä¸€ä¸ª <code>Bundle</code>ï¼Œå®ç°è·¨ç»„ä»¶çš„æ•°æ®ä¼ é€’ã€‚</p>
<h3 data-id="heading-20">Fragment ä¹‹é—´ä¼ é€’æ•°æ®</h3>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-comment">// å‘ Fragment ä¼ é€’æ•°æ®</span>
<span class="hljs-keyword">val</span> fragment = MyFragment().apply {
    arguments = Bundle().apply {
        putString(<span class="hljs-string">"user_name"</span>, <span class="hljs-string">"Jane Doe"</span>)
        putInt(<span class="hljs-string">"user_age"</span>, <span class="hljs-number">30</span>)
    }
}

<span class="hljs-comment">// åœ¨ Fragment ä¸­è·å–æ•°æ®</span>
<span class="hljs-keyword">val</span> name = arguments?.getString(<span class="hljs-string">"user_name"</span>)
<span class="hljs-keyword">val</span> age = arguments?.getInt(<span class="hljs-string">"user_age"</span>)
</code></pre>
<h3 data-id="heading-21">ä¿å­˜å’Œæ¢å¤çŠ¶æ€</h3>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSaveInstanceState</span><span class="hljs-params">(outState: <span class="hljs-type">Bundle</span>)</span></span> {
    <span class="hljs-keyword">super</span>.onSaveInstanceState(outState)
    outState.putString(<span class="hljs-string">"user_input"</span>, editText.text.toString())
}

<span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onRestoreInstanceState</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>)</span></span> {
    <span class="hljs-keyword">super</span>.onRestoreInstanceState(savedInstanceState)
    <span class="hljs-keyword">val</span> userInput = savedInstanceState.getString(<span class="hljs-string">"user_input"</span>)
    editText.setText(userInput)
}
</code></pre>
<p>åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œ<code>Bundle</code> ç¡®ä¿äº†ç”¨æˆ·è¾“å…¥åœ¨é…ç½®å˜æ›´ï¼ˆå¦‚å±å¹•æ—‹è½¬ï¼‰æ—¶ä¸ä¼šä¸¢å¤±ï¼Œèƒ½å¤Ÿè¢«æ­£ç¡®æ¢å¤ã€‚</p>
<h3 data-id="heading-22">æ€»ç»“</h3>
<p><code>Bundle</code> æ˜¯ Android ä¸­ç”¨äºåœ¨ç»„ä»¶ä¹‹é—´é«˜æ•ˆä¼ é€’å’Œä¿å­˜æ•°æ®çš„å…³é”®ç»„ä»¶ï¼Œå°¤å…¶é€‚ç”¨äºè·¨ç”Ÿå‘½å‘¨æœŸäº‹ä»¶çš„æ•°æ®ç®¡ç†ã€‚å®ƒç»“æ„è½»é‡ã€çµæ´»ï¼Œæ˜¯å¤„ç†åº”ç”¨çŠ¶æ€å’Œæ•°æ®ä¼ è¾“ä¸å¯æˆ–ç¼ºçš„å·¥å…·ã€‚</p>
<hr/>
<h2 data-id="heading-23">å¦‚ä½•åœ¨ Activity æˆ– Fragment ä¹‹é—´ä¼ é€’æ•°æ®ï¼Ÿ</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/068bc146e7cd48628f47f87a45659ba5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767229412&amp;x-signature=n0Ns4Ojzc60%2BTpr0ubPYaOPzUTM%3D" alt="3.png" loading="lazy"/></p>
<p>åœ¨ <code>Activity</code> æˆ– <code>Fragment</code> ä¹‹é—´ä¼ é€’æ•°æ®ï¼Œæ˜¯æ„å»ºäº¤äº’æ€§å¼ºã€åŠ¨æ€çµæ´»ç•Œé¢çš„é‡è¦ä¸€ç¯ã€‚Android æä¾›äº†å¤šç§æœºåˆ¶æ¥å®ç°è¿™ä¸€ç›®æ ‡ï¼Œåœ¨ä¿è¯é€šä¿¡é¡ºç•…çš„åŒæ—¶ï¼Œä¹Ÿéµå¾ªåº”ç”¨çš„æ•´ä½“æ¶æ„è®¾è®¡ã€‚</p>
<h3 data-id="heading-24">é¢è¯•é—®é¢˜</h3>
<p>å…±äº« <code>ViewModel</code> æ˜¯å¦‚ä½•ä¿ƒè¿›åŒä¸€ <code>Activity</code> å†…å¤šä¸ª <code>Fragment</code> ä¹‹é—´çš„é€šä¿¡çš„ï¼Ÿ</p>
<p>ç›¸æ¯”ä½¿ç”¨ <code>Bundle</code> æˆ–ç›´æ¥çš„ <code>Fragment</code> äº‹åŠ¡ï¼Œå®ƒæœ‰å“ªäº›ä¼˜åŠ¿ï¼Ÿ</p>
<h3 data-id="heading-25">Activity ä¹‹é—´ä¼ é€’æ•°æ®</h3>
<p>ä»ä¸€ä¸ª <code>Activity</code> å‘å¦ä¸€ä¸ªä¼ é€’æ•°æ®ï¼Œæœ€å¸¸ç”¨çš„æ–¹å¼æ˜¯ä½¿ç”¨ <code>Intent</code>ã€‚æ•°æ®ä»¥é”®å€¼å¯¹çš„å½¢å¼ï¼ˆé€šè¿‡ <code>putExtra()</code>ï¼‰é™„åŠ åˆ° <code>Intent</code> ä¸Šï¼Œæ¥æ”¶æ–¹åˆ™é€šè¿‡ <code>getIntent()</code> è·å–è¿™äº›æ•°æ®ã€‚</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-comment">// å‘é€æ•°æ®çš„ Activity</span>
<span class="hljs-keyword">val</span> intent = Intent(<span class="hljs-keyword">this</span>, SecondActivity::<span class="hljs-keyword">class</span>.java).apply {
    putExtra(<span class="hljs-string">"USER_NAME"</span>, <span class="hljs-string">"John Doe"</span>)
    putExtra(<span class="hljs-string">"USER_AGE"</span>, <span class="hljs-number">25</span>)
}
startActivity(intent)

<span class="hljs-comment">// æ¥æ”¶æ•°æ®çš„ Activity</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SecondActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        setContentView(R.layout.activity_second)

        <span class="hljs-keyword">val</span> userName = intent.getStringExtra(<span class="hljs-string">"USER_NAME"</span>)
        <span class="hljs-keyword">val</span> userAge = intent.getIntExtra(<span class="hljs-string">"USER_AGE"</span>, <span class="hljs-number">0</span>)
        Log.d(<span class="hljs-string">"SecondActivity"</span>, <span class="hljs-string">"User Name: <span class="hljs-variable">$userName</span>, Age: <span class="hljs-variable">$userAge</span>"</span>)
    }
}
</code></pre>
<p>è¿™ç§æ–¹å¼ç®€å•ç›´æ¥ï¼Œé€‚åˆä¼ é€’å°‘é‡ç»“æ„åŒ–æ•°æ®ã€‚æ³¨æ„ï¼š<code>Intent</code> ä¼ è¾“çš„æ•°æ®æœ‰å¤§å°é™åˆ¶ï¼Œä¸é€‚åˆå¤§æ–‡ä»¶æˆ–å¤æ‚å¯¹è±¡ã€‚</p>
<h3 data-id="heading-26">Fragment ä¹‹é—´ä¼ é€’æ•°æ®</h3>
<p><code>Fragment</code> ä¹‹é—´çš„é€šä¿¡å¯ä»¥ä½¿ç”¨ <code>Bundle</code> æ¥å®ç°ã€‚å‘é€æ–¹ <code>Fragment</code> åˆ›å»ºä¸€ä¸ªåŒ…å«é”®å€¼å¯¹çš„ <code>Bundle</code>ï¼Œå¹¶é€šè¿‡ <code>arguments</code> å°†å…¶ä¼ é€’ç»™æ¥æ”¶æ–¹ <code>Fragment</code>ã€‚</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-comment">// å‘é€æ•°æ®çš„ Fragment</span>
<span class="hljs-keyword">val</span> fragment = SecondFragment().apply {
    arguments = Bundle().apply {
        putString(<span class="hljs-string">"USER_NAME"</span>, <span class="hljs-string">"John Doe"</span>)
        putInt(<span class="hljs-string">"USER_AGE"</span>, <span class="hljs-number">25</span>)
    }
}
parentFragmentManager.beginTransaction()
    .replace(R.id.fragment_container, fragment)
    .commit()

<span class="hljs-comment">// æ¥æ”¶æ•°æ®çš„ Fragment</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SecondFragment</span> : <span class="hljs-type">Fragment</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreateView</span><span class="hljs-params">(
        inflater: <span class="hljs-type">LayoutInflater</span>,
        container: <span class="hljs-type">ViewGroup</span>?,
        savedInstanceState: <span class="hljs-type">Bundle</span>?
    )</span></span>: View? {
        <span class="hljs-keyword">val</span> view = inflater.inflate(R.layout.fragment_second, container, <span class="hljs-literal">false</span>)

        <span class="hljs-keyword">val</span> userName = arguments?.getString(<span class="hljs-string">"USER_NAME"</span>)
        <span class="hljs-keyword">val</span> userAge = arguments?.getInt(<span class="hljs-string">"USER_AGE"</span>)
        Log.d(<span class="hljs-string">"SecondFragment"</span>, <span class="hljs-string">"User Name: <span class="hljs-variable">$userName</span>, Age: <span class="hljs-variable">$userAge</span>"</span>)

        <span class="hljs-keyword">return</span> view
    }
}
</code></pre>
<p>è¿™ç§æ–¹å¼æ˜¯ <code>Fragment</code> é—´ä¼ å‚çš„æ ‡å‡†åšæ³•ï¼Œæ•°æ®åœ¨åˆ›å»ºæ—¶å°±è¢«å°è£…è¿› <code>arguments</code>ï¼Œå¹¶éš <code>Fragment</code> ç”Ÿå‘½å‘¨æœŸä¸€èµ·ä¿å­˜å’Œæ¢å¤ï¼Œç¡®ä¿äº†çŠ¶æ€çš„ä¸€è‡´æ€§ã€‚</p>
<h3 data-id="heading-27">ä½¿ç”¨ Jetpack Navigation</h3>
<p>å½“ä½ ä½¿ç”¨ <strong>Jetpack Navigation</strong> åº“å¹¶é…åˆ <strong>Safe Args</strong> æ’ä»¶æ—¶ï¼Œå¯ä»¥ç”Ÿæˆç±»å‹å®‰å…¨çš„å¯¼èˆªæ–¹å‘å’Œå‚æ•°ç±»ï¼Œå®ç°ç›®çš„åœ°ä¹‹é—´çš„å®‰å…¨ã€æ˜ç¡®çš„æ•°æ®ä¼ é€’ã€‚</p>
<p>ç¬¬ä¸€ï¼Œåœ¨å¯¼èˆªå›¾ä¸­å®šä¹‰å‚æ•°ï¼š</p>
<p>åœ¨ä½ çš„ <code>nav_graph.xml</code> æ–‡ä»¶ä¸­ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">fragment</span>
    <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/secondFragment"</span>
    <span class="hljs-attr">android:name</span>=<span class="hljs-string">"com.example.SecondFragment"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">argument</span>
        <span class="hljs-attr">android:name</span>=<span class="hljs-string">"username"</span>
        <span class="hljs-attr">app:argType</span>=<span class="hljs-string">"string"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">fragment</span>&gt;</span>
</code></pre>
<p>ç¬¬äºŒï¼Œä»æº <code>Fragment</code> ä¼ é€’æ•°æ®ï¼š</p>
<p><code>Safe Args</code> æ’ä»¶ä¼šåœ¨ç¼–è¯‘æ—¶è‡ªåŠ¨ç”Ÿæˆç›®æ ‡å¯¹è±¡å’Œæ„å»ºå™¨ç±»ï¼Œè®©ä½ èƒ½å¤Ÿå®‰å…¨ã€æ˜¾å¼åœ°ä¼ é€’å‚æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">val</span> action = FirstFragmentDirections
    .actionFirstFragmentToSecondFragment(username = <span class="hljs-string">"rocky"</span>)
findNavController().navigate(action)
</code></pre>
<p>ç¬¬ä¸‰ï¼Œåœ¨ç›®æ ‡ <code>Fragment</code> ä¸­è·å–æ•°æ®ï¼š</p>
<p>æœ€åï¼Œä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ä»ä¼ å…¥çš„å‚æ•°ä¸­æå–æ•°æ®ï¼š</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">val</span> username = arguments?.let {
    SecondFragmentArgs.fromBundle(it).username
}
</code></pre>
<p>ä½¿ç”¨ <strong>Safe Args</strong> å¯ä»¥å®šä¹‰å¹¶è·å–å¼ºç±»å‹çš„å‚æ•°ï¼Œå‡å°‘è¿è¡Œæ—¶é”™è¯¯ï¼ŒåŒæ—¶æå‡ä»£ç å¯è¯»æ€§å’Œè·¨ <code>Fragment</code> çš„ç»´æŠ¤æ€§ã€‚</p>
<h3 data-id="heading-28">å…±äº« ViewModel</h3>
<p>å½“åŒä¸€ä¸ª <code>Activity</code> å†…çš„å¤šä¸ª <code>Fragment</code> éœ€è¦äº’ç›¸é€šä¿¡æ—¶ï¼Œæ¨èä½¿ç”¨ <strong>å…±äº«</strong> <code>ViewModel</code>ã€‚</p>
<p>æ‰€è°“å…±äº« <code>ViewModel</code>ï¼Œæ˜¯æŒ‡åœ¨åŒä¸€ä¸ª <code>Activity</code> ä¸­è¢«å¤šä¸ª <code>Fragment</code> å…±äº«çš„ <code>ViewModel</code> å®ä¾‹ã€‚è¿™é€šè¿‡ Jetpack æä¾›çš„ <code>androidx.fragment:fragment-ktx</code> åŒ…ä¸­çš„ <code>activityViewModels()</code> æ–¹æ³•å®ç°ã€‚</p>
<p>è¯¥æ–¹æ³•å°† <code>ViewModel</code> çš„ä½œç”¨åŸŸé™å®šåœ¨å½“å‰ <code>Activity</code>ï¼Œä½¿å¾—æ‰€æœ‰ <code>Fragment</code> éƒ½èƒ½è®¿é—®å¹¶å…±äº«åŒä¸€ä¸ª <code>ViewModel</code> å®ä¾‹ã€‚</p>
<p>è¿™ç§æ–¹å¼é¿å…äº† <code>Fragment</code> ä¹‹é—´çš„ç´§è€¦åˆï¼ŒåŒæ—¶æ”¯æŒç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥çš„æ•°æ®å…±äº«ï¼Œæ˜¯ç°ä»£ Android æ¶æ„ä¸­æ¨èçš„åšæ³•ã€‚</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-comment">// å…±äº« ViewModel</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SharedViewModel</span> : <span class="hljs-type">ViewModel</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _userData = MutableStateFlow&lt;User?&gt;(<span class="hljs-literal">null</span>)
    <span class="hljs-keyword">val</span> userData: StateFlow&lt;User?&gt; = _userData

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">setUserData</span><span class="hljs-params">(user: <span class="hljs-type">User</span>)</span></span> {
        _userData.value = user
    }
}

<span class="hljs-comment">// Fragment Aï¼ˆå‘é€æ•°æ®ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">FirstFragment</span> : <span class="hljs-type">Fragment</span>() {

    <span class="hljs-comment">// activityViewModels ï¼</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> sharedViewModel: SharedViewModel <span class="hljs-keyword">by</span> activityViewModels()

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">updateUser</span><span class="hljs-params">(user: <span class="hljs-type">User</span>)</span></span> {
        sharedViewModel.setUserData(user)
    }
}

<span class="hljs-comment">// Fragment Bï¼ˆåœ¨å¦ä¸€ä¸ª Fragment ä¸­æ¥æ”¶æ•°æ®ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SecondFragment</span> : <span class="hljs-type">Fragment</span>() {

    <span class="hljs-comment">// activityViewModels ï¼</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> sharedViewModel: SharedViewModel <span class="hljs-keyword">by</span> activityViewModels()

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onViewCreated</span><span class="hljs-params">(view: <span class="hljs-type">View</span>, savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        lifecycleScope.launch {
            viewLifecycleOwner.repeatOnLifecycle(Lifecycle.State.RESUMED) {
                sharedViewModel.userData.collectLatest { user -&gt;
                    <span class="hljs-comment">// å¤„ç†ç”¨æˆ·æ•°æ®</span>
                }
            }
        }
    }
}

<span class="hljs-comment">// Activityï¼ˆåœ¨ Activity ä¸­æ¥æ”¶æ•°æ®ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">ComponentActivity</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> sharedViewModel: SharedViewModel <span class="hljs-keyword">by</span> viewModels()

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        lifecycleScope.launch {
            lifecycle.repeatOnLifecycle(Lifecycle.State.RESUMED) {
                sharedViewModel.userData.collectLatest { user -&gt;
                    <span class="hljs-comment">// å¤„ç†ç”¨æˆ·æ•°æ®</span>
                }
            }
        }
    }
}
</code></pre>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>FirstFragment</code> æ›´æ–° <code>SharedViewModel</code> ä¸­çš„æ•°æ®ï¼Œ<code>SecondFragment</code> å’Œ <code>MainActivity</code> éƒ½èƒ½å®æ—¶å“åº”è¿™äº›å˜åŒ–ï¼Œå®ç°äº†è·¨ç»„ä»¶çš„é«˜æ•ˆã€å®‰å…¨çš„æ•°æ®åŒæ­¥ã€‚</p>
<h3 data-id="heading-29">æ€»ç»“</h3>
<ol>
<li><code>Intent</code> ç”¨äºåœ¨ <code>Activity</code> ä¹‹é—´ä¼ é€’æ•°æ®ï¼Œé€šè¿‡ <code>putExtra()</code> æ·»åŠ æ•°æ®ï¼Œæ¥æ”¶æ–¹ç”¨ <code>getIntent()</code> è·å–ã€‚</li>
<li><code>Bundle</code> å¸¸ç”¨äº <code>Fragment</code> ä¹‹é—´é€šè¿‡ <code>arguments</code> å±æ€§ä¼ é€’æ•°æ®ã€‚</li>
<li>ä½¿ç”¨ <strong>Jetpack Navigation</strong> é…åˆ <strong>Safe Args</strong> æ’ä»¶ï¼Œå¯ä»¥é€šè¿‡è‡ªåŠ¨ç”Ÿæˆçš„æ–¹å‘å’Œå‚æ•°ç±»å®ç° <code>Fragment</code> ä¹‹é—´çš„ç±»å‹å®‰å…¨ä¼ å‚ã€‚</li>
<li>å½“åŒä¸€ä¸ª <code>Activity</code> å†…çš„å¤šä¸ª <code>Fragment</code> éœ€è¦å…±äº«æ•°æ®æ—¶ï¼Œä½¿ç”¨å…±äº« <code>ViewModel</code> æ˜¯ä¸€ç§ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥ã€è§£è€¦çš„è§£å†³æ–¹æ¡ˆã€‚æ¯ç§æ–¹å¼éƒ½æœ‰å…¶é€‚ç”¨åœºæ™¯ï¼Œå…·ä½“é€‰æ‹©å–å†³äºåº”ç”¨çš„å®é™…éœ€æ±‚ã€‚</li>
</ol>
<h3 data-id="heading-30">è¿›é˜¶ï¼šFragment Result API</h3>
<p>åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œ<code>Fragment</code> éœ€è¦å‘å¦ä¸€ä¸ª <code>Fragment</code> æˆ–å…¶å®¿ä¸» <code>Activity</code> ä¼ é€’ä¸€ä¸ª<strong>ä¸€æ¬¡æ€§å€¼</strong>ã€‚æ¯”å¦‚ï¼Œä¸€ä¸ªæ‰«æäºŒç»´ç çš„ <code>Fragment</code> å¯èƒ½éœ€è¦æŠŠæ‰«æç»“æœè¿”å›ç»™å‰ä¸€ä¸ª <code>Fragment</code>ã€‚</p>
<p>ä» <code>Fragment</code> ç‰ˆæœ¬ 1.3.0 å¼€å§‹ï¼Œæ¯ä¸ª <code>FragmentManager</code> éƒ½å®ç°äº† <code>FragmentResultOwner</code> æ¥å£ï¼Œå…è®¸ <code>Fragment</code> é€šè¿‡ç»“æœç›‘å¬å™¨è¿›è¡Œé€šä¿¡ï¼Œè€Œæ— éœ€ç›¸äº’æŒæœ‰ç›´æ¥å¼•ç”¨ã€‚è¿™ç§æ–¹å¼ç®€åŒ–äº†æ•°æ®ä¼ é€’ï¼ŒåŒæ—¶ä¿æŒäº†ç»„ä»¶ä¹‹é—´çš„æ¾è€¦åˆã€‚</p>
<p>è¦ä» <code>Fragment B</code>ï¼ˆå‘é€æ–¹ï¼‰å‘ <code>Fragment A</code>ï¼ˆæ¥æ”¶æ–¹ï¼‰ä¼ é€’æ•°æ®ï¼Œåªéœ€æŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š</p>
<ol>
<li>åœ¨ <code>Fragment A</code> ä¸­è®¾ç½®ä¸€ä¸ªç»“æœç›‘å¬å™¨ï¼ˆæ¥æ”¶æ–¹ï¼‰ã€‚</li>
<li>ä» <code>Fragment B</code> å‘é€ç»“æœï¼Œå¹¶ä½¿ç”¨ç›¸åŒçš„ <code>requestKey</code>ã€‚</li>
</ol>
<p>ç¬¬ä¸€ï¼Œåœ¨ <code>Fragment A</code> ä¸­è®¾ç½®ç»“æœç›‘å¬å™¨ï¼š</p>
<p><code>Fragment A</code> åº”ä½¿ç”¨ <code>setFragmentResultListener()</code> æ³¨å†Œç›‘å¬å™¨ï¼Œç¡®ä¿åœ¨è¿›å…¥ <code>STARTED</code> çŠ¶æ€æ—¶èƒ½æ¥æ”¶åˆ°ç»“æœã€‚</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">FragmentA</span> : <span class="hljs-type">Fragment</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)

        <span class="hljs-comment">// æ³¨å†Œç›‘å¬å™¨ä»¥æ¥æ”¶ç»“æœ</span>
        setFragmentResultListener(<span class="hljs-string">"requestKey"</span>) { _, bundle -&gt;
            <span class="hljs-keyword">val</span> result = bundle.getString(<span class="hljs-string">"bundleKey"</span>)
            <span class="hljs-comment">// å¤„ç†æ¥æ”¶åˆ°çš„ç»“æœ</span>
        }
    }
}
</code></pre>
<p><code>setFragmentResultListener("requestKey")</code> ä¼šä¸ºæŒ‡å®šçš„è¯·æ±‚é”®æ³¨å†Œä¸€ä¸ªç›‘å¬å™¨ã€‚å½“ <code>Fragment</code> è¿›å…¥ <code>STARTED</code> çŠ¶æ€æ—¶ï¼Œå›è°ƒå°±ä¼šè§¦å‘ã€‚</p>
<p>ç¬¬äºŒï¼Œä» <code>Fragment B</code> å‘é€ç»“æœï¼š</p>
<p><code>Fragment B</code> ä½¿ç”¨ <code>setFragmentResult()</code> å‘é€ç»“æœï¼Œç¡®ä¿å½“ <code>Fragment A</code> æ¿€æ´»æ—¶èƒ½å¤Ÿè·å–åˆ°æ•°æ®ã€‚</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">FragmentB</span> : <span class="hljs-type">Fragment</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> button: Button

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onViewCreated</span><span class="hljs-params">(view: <span class="hljs-type">View</span>, savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onViewCreated(view, savedInstanceState)

        button = view.findViewById(R.id.button)
        button.setOnClickListener {
            <span class="hljs-keyword">val</span> result = <span class="hljs-string">"result"</span>
            <span class="hljs-comment">// å°†ç»“æœå‘é€ç»™ FragmentA</span>
            setFragmentResult(<span class="hljs-string">"requestKey"</span>, bundleOf(<span class="hljs-string">"bundleKey"</span> to result))
        }
    }
}
</code></pre>
<p><code>setFragmentResult("requestKey", bundleOf("bundleKey" to result))</code> ä¼šä½¿ç”¨æŒ‡å®šçš„é”®å°†ç»“æœå­˜å‚¨åœ¨ <code>FragmentManager</code> ä¸­ã€‚å¦‚æœ <code>Fragment A</code> å½“å‰æœªæ¿€æ´»ï¼Œè¯¥ç»“æœä¼šè¢«ä¿å­˜ï¼Œç›´åˆ° <code>Fragment A</code> æ¢å¤å¹¶æ³¨å†Œäº†ç›‘å¬å™¨ä¸ºæ­¢ã€‚</p>
<h3 data-id="heading-31">Fragment Result çš„è¡Œä¸º</h3>
<ul>
<li><strong>æ¯ä¸ªé”®å¯¹åº”ä¸€ä¸ªç›‘å¬å™¨å’Œä¸€ä¸ªç»“æœ</strong>ï¼šæ¯ä¸ª <code>requestKey</code> åœ¨ä»»æ„æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªç›‘å¬å™¨å’Œä¸€ä¸ªç»“æœã€‚</li>
<li><strong>å¾…å¤„ç†ç»“æœä¼šè¢«è¦†ç›–</strong>ï¼šå¦‚æœåœ¨ç›‘å¬å™¨æ¿€æ´»å‰è®¾ç½®äº†å¤šä¸ªç»“æœï¼Œåªæœ‰<strong>æœ€æ–°çš„é‚£ä¸ª</strong>ä¼šè¢«ä¿ç•™ã€‚</li>
<li><strong>ç»“æœä¸€æ—¦è¢«æ¶ˆè´¹å°±ä¼šæ¸…é™¤</strong>ï¼šå½“ <code>Fragment</code> æ¥æ”¶åˆ°ç»“æœå¹¶å¤„ç†åï¼Œè¯¥ç»“æœä¼šä» <code>FragmentManager</code> ä¸­ç§»é™¤ã€‚</li>
<li><strong>åå°æ ˆä¸­çš„ Fragment æ— æ³•æ¥æ”¶ç»“æœ</strong>ï¼šåªæœ‰å½“ <code>Fragment</code> ä»è¿”å›æ ˆä¸­å¼¹å‡ºå¹¶è¿›å…¥ <code>STARTED</code> çŠ¶æ€æ—¶ï¼Œæ‰èƒ½æ¥æ”¶åˆ°ç»“æœã€‚</li>
<li><strong>å¤„äº STARTED çŠ¶æ€çš„ç›‘å¬å™¨ä¼šç«‹å³è§¦å‘</strong>ï¼šå¦‚æœ <code>Fragment A</code> å·²ç»å¤„äºæ´»è·ƒçŠ¶æ€ï¼Œå½“ <code>Fragment B</code> å‘é€ç»“æœæ—¶ï¼Œç›‘å¬å™¨ä¼š<strong>ç«‹åˆ»æ‰§è¡Œ</strong>ã€‚</li>
</ul>
<p>æ€»ä¹‹ï¼š</p>
<p><strong>Fragment Result API</strong> ç®€åŒ–äº† <code>Fragment</code> ä¹‹é—´ä¼ é€’ä¸€æ¬¡æ€§æ•°æ®çš„è¿‡ç¨‹ï¼Œæ— éœ€ç›´æ¥å¼•ç”¨å¯¹æ–¹ã€‚å®ƒé€šè¿‡ <code>FragmentManager</code> å®‰å…¨åœ°å­˜å‚¨ç»“æœï¼Œç›´åˆ°æ¥æ”¶æ–¹æ¿€æ´»ï¼Œä»è€Œå®ç°äº†ä¸€ç§è§£è€¦ä¸”ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥çš„é€šä¿¡æœºåˆ¶ã€‚</p>
<p>è¿™ç§è®¾è®¡åœ¨å¤šç§åœºæ™¯ä¸‹éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚äºŒç»´ç æ‰«æã€ç”¨æˆ·è¾“å…¥å¯¹è¯æ¡†ã€è¡¨å•æäº¤ç­‰ï¼Œè®©åŸºäº <code>Fragment</code> çš„å¯¼èˆªæ›´é«˜æ•ˆã€æ›´æ˜“ç»´æŠ¤ã€‚</p>
<hr/>
<h2 data-id="heading-32">é…ç½®å˜æ›´</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6483f19e8274441b80aa9082e12bc6ee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767229412&amp;x-signature=A5yZ%2BfTt1jotP6Tqk76xsJIxJrk%3D" alt="4.png" loading="lazy"/></p>
<p>å½“ Android è®¾å¤‡å‘ç”Ÿé…ç½®å˜æ›´ï¼ˆä¾‹å¦‚å±å¹•æ—‹è½¬ã€ä¸»é¢˜åˆ‡æ¢ã€å­—ä½“å¤§å°è°ƒæ•´æˆ–è¯­è¨€æ›´æ–°ï¼‰æ—¶ï¼Œç³»ç»Ÿå¯èƒ½ä¼šé”€æ¯å¹¶é‡æ–°åˆ›å»ºå½“å‰çš„ <code>Activity</code>ï¼Œä»¥åº”ç”¨æ–°çš„é…ç½®ã€‚è¿™ç§è¡Œä¸ºç¡®ä¿äº†åº”ç”¨èµ„æºèƒ½æ ¹æ®æ–°é…ç½®é‡æ–°åŠ è½½ã€‚</p>
<h3 data-id="heading-33">é¢è¯•é—®é¢˜</h3>
<p>å¼€å‘è€…å¦‚ä½•é˜²æ­¢å› é…ç½®å˜æ›´å¯¼è‡´çš„ <code>Activity</code> é‡å»ºè¿‡ç¨‹ä¸­çš„æ•°æ®ä¸¢å¤±ï¼Ÿ</p>
<p>å¤„ç†ä¸´æ—¶çŠ¶æ€å’ŒæŒä¹…çŠ¶æ€æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ</p>
<h3 data-id="heading-34">é»˜è®¤è¡Œä¸º</h3>
<ol>
<li>
<p><strong>Activity çš„é”€æ¯ä¸é‡å»º</strong><br/>
å½“é…ç½®å˜æ›´å‘ç”Ÿæ—¶ï¼Œ<code>Activity</code> ä¼šè¢«é”€æ¯å¹¶é‡æ–°åˆ›å»ºï¼Œè¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>ç³»ç»Ÿä¾æ¬¡è°ƒç”¨å½“å‰ <code>Activity</code> çš„ <code>onPause()</code>ã€<code>onStop()</code> å’Œ <code>onDestroy()</code> æ–¹æ³•ã€‚</li>
<li>ç„¶åé€šè¿‡è°ƒç”¨ <code>onCreate()</code> æ–¹æ³•ï¼Œä½¿ç”¨æ–°çš„é…ç½®é‡æ–°åˆ›å»º <code>Activity</code>ã€‚</li>
</ul>
</li>
<li>
<p><strong>èµ„æºé‡æ–°åŠ è½½</strong><br/>
ç³»ç»Ÿä¼šæ ¹æ®æ–°çš„é…ç½®é‡æ–°åŠ è½½èµ„æºï¼ˆå¦‚å¸ƒå±€ã€å›¾ç‰‡ã€å­—ç¬¦ä¸²ç­‰ï¼‰ï¼Œä½¿åº”ç”¨èƒ½å¤Ÿé€‚é…å±å¹•æ–¹å‘ã€ä¸»é¢˜æˆ–è¯­è¨€çš„å˜åŒ–ã€‚</p>
</li>
<li>
<p><strong>é˜²æ­¢æ•°æ®ä¸¢å¤±</strong><br/>
ä¸ºäº†é¿å…é‡å»ºè¿‡ç¨‹ä¸­æ•°æ®ä¸¢å¤±ï¼Œå¼€å‘è€…å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¿å­˜å’Œæ¢å¤çŠ¶æ€ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>onSaveInstanceState()</code> å’Œ <code>onRestoreInstanceState()</code> æ–¹æ³•æ‰‹åŠ¨ä¿å­˜ UI çŠ¶æ€ã€‚</li>
<li>æˆ–è€…å€ŸåŠ© <code>ViewModel</code> æ¥ç®¡ç†ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥çš„æ•°æ®ã€‚</li>
</ul>
</li>
</ol>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSaveInstanceState</span><span class="hljs-params">(outState: <span class="hljs-type">Bundle</span>)</span></span> {
    <span class="hljs-keyword">super</span>.onSaveInstanceState(outState)
    outState.putString(<span class="hljs-string">"user_input"</span>, editText.text.toString())
}

<span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
    <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
    setContentView(R.layout.activity_main)

    <span class="hljs-keyword">val</span> restoredInput = savedInstanceState?.getString(<span class="hljs-string">"user_input"</span>)
    editText.setText(restoredInput)
}
</code></pre>
<p>è¿™æ®µä»£ç å±•ç¤ºäº†å¦‚ä½•åœ¨ <code>onSaveInstanceState()</code> ä¸­ä¿å­˜ç”¨æˆ·è¾“å…¥ï¼Œå¹¶åœ¨ <code>onCreate()</code> ä¸­ä» <code>savedInstanceState</code> æ¢å¤ï¼Œä»è€Œé¿å…å› é…ç½®å˜æ›´å¯¼è‡´çš„æ•°æ®ä¸¢å¤±ã€‚</p>
<h3 data-id="heading-35">å¸¸è§çš„é…ç½®å˜æ›´</h3>
<ol>
<li><strong>å±å¹•æ—‹è½¬</strong>ï¼šåœ¨ç«–å±å’Œæ¨ªå±ä¹‹é—´åˆ‡æ¢ï¼Œå¯¼è‡´å¸ƒå±€éœ€è¦é‡æ–°åŠ è½½ä»¥é€‚é…æ–°çš„å±å¹•å°ºå¯¸ã€‚</li>
<li><strong>æ·±è‰²/æµ…è‰²ä¸»é¢˜åˆ‡æ¢</strong>ï¼šå½“ç”¨æˆ·åœ¨æ·±è‰²æ¨¡å¼å’Œæµ…è‰²æ¨¡å¼ä¹‹é—´åˆ‡æ¢æ—¶ï¼Œåº”ç”¨ä¼šé‡æ–°åŠ è½½ä¸ä¸»é¢˜ç›¸å…³çš„èµ„æºï¼ˆå¦‚é¢œè‰²ã€æ ·å¼ç­‰ï¼‰ã€‚</li>
<li><strong>å­—ä½“å¤§å°è°ƒæ•´</strong>ï¼šè®¾å¤‡å­—ä½“å¤§å°è®¾ç½®çš„æ›´æ”¹ä¼šè§¦å‘æ–‡æœ¬èµ„æºçš„é‡æ–°åŠ è½½ï¼Œä»¥åŒ¹é…æ–°çš„ç¼©æ”¾æ¯”ä¾‹ã€‚</li>
<li><strong>è¯­è¨€å˜æ›´</strong>ï¼šç³»ç»Ÿè¯­è¨€çš„æ›´æ–°ä¼šè§¦å‘æœ¬åœ°åŒ–èµ„æºçš„åŠ è½½ï¼ˆä¾‹å¦‚ï¼Œåˆ‡æ¢ä¸ºå¦ä¸€ç§è¯­è¨€çš„å­—ç¬¦ä¸²èµ„æºï¼‰ã€‚</li>
</ol>
<h3 data-id="heading-36">é¿å… Activity é‡å»º</h3>
<p>ä¸ºäº†é¿å…é…ç½®å˜æ›´æ—¶é‡æ–°åˆ›å»º <code>Activity</code>ï¼Œå¯ä»¥åœ¨ <code>AndroidManifest.xml</code> ä¸­ä½¿ç”¨ <code>android:configChanges</code> å±æ€§ã€‚è¿™ç§æ–¹å¼å°†å¤„ç†é…ç½®å˜æ›´çš„è´£ä»»äº¤ç»™å¼€å‘è€…ï¼Œé€šè¿‡ä»£ç æ‰‹åŠ¨å“åº”å˜åŒ–ã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">activity</span>
    <span class="hljs-attr">android:name</span>=<span class="hljs-string">".MainActivity"</span>
    <span class="hljs-attr">android:configChanges</span>=<span class="hljs-string">"orientation|screenSize|keyboardHidden"</span> /&gt;</span>
</code></pre>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç³»ç»Ÿä¸ä¼šé”€æ¯å¹¶é‡æ–°åˆ›å»º <code>Activity</code>ï¼Œè€Œæ˜¯è°ƒç”¨ <code>onConfigurationChanged()</code> æ–¹æ³•ï¼Œå…è®¸å¼€å‘è€…æ‰‹åŠ¨å¤„ç†é…ç½®å˜æ›´ã€‚</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onConfigurationChanged</span><span class="hljs-params">(newConfig: <span class="hljs-type">Configuration</span>)</span></span> {
    <span class="hljs-keyword">super</span>.onConfigurationChanged(newConfig)

    <span class="hljs-keyword">if</span> (newConfig.orientation == Configuration.ORIENTATION_LANDSCAPE) {
        <span class="hljs-comment">// å¤„ç†æ¨ªå±ç›¸å…³é€»è¾‘</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (newConfig.orientation == Configuration.ORIENTATION_PORTRAIT) {
        <span class="hljs-comment">// å¤„ç†ç«–å±ç›¸å…³é€»è¾‘</span>
    }
}
</code></pre>
<h3 data-id="heading-37">æ€»ç»“</h3>
<p>å½“å‘ç”Ÿé…ç½®å˜æ›´æ—¶ï¼Œé»˜è®¤è¡Œä¸ºæ˜¯é”€æ¯å¹¶é‡å»º <code>Activity</code>ï¼Œä»¥é‡æ–°åŠ è½½èµ„æºé€‚é…æ–°é…ç½®ã€‚å¼€å‘è€…å¯ä»¥é€šè¿‡ <code>onSaveInstanceState()</code> ä¿å­˜ä¸´æ—¶ UI çŠ¶æ€ï¼Œæˆ–ä½¿ç”¨ <code>ViewModel</code> ç®¡ç†é UI çŠ¶æ€ã€‚è‹¥æƒ³é¿å…é‡å»ºï¼Œå¯åœ¨æ¸…å•æ–‡ä»¶ä¸­ä½¿ç”¨ <code>android:configChanges</code> å±æ€§ï¼Œå°†å¤„ç†é€»è¾‘äº¤ç»™å¼€å‘è€…è‡ªè¡Œæ§åˆ¶ã€‚</p>
<hr/>
<h2 data-id="heading-38">ä»€ä¹ˆæ˜¯ ActivityManager</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5672777a25ac4df8a1841391a6defe9c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767229412&amp;x-signature=HIxsXsZcg2zqXnd%2FQAJ3G0cWHiU%3D" alt="5.png" loading="lazy"/></p>
<p><code>ActivityManager</code> æ˜¯ Android ç³»ç»Ÿä¸­çš„ä¸€é¡¹ç³»ç»ŸæœåŠ¡ï¼Œè´Ÿè´£æä¾›å¹¶ç®¡ç†è®¾å¤‡ä¸Šè¿è¡Œçš„ <code>Activity</code>ã€ä»»åŠ¡å’Œè¿›ç¨‹çš„ä¿¡æ¯ã€‚å®ƒæ˜¯ Android æ¡†æ¶çš„ä¸€éƒ¨åˆ†ï¼Œå…è®¸å¼€å‘è€…ä¸åº”ç”¨ç”Ÿå‘½å‘¨æœŸã€å†…å­˜ä½¿ç”¨å’Œä»»åŠ¡ç®¡ç†ç­‰æ–¹é¢è¿›è¡Œäº¤äº’å’Œæ§åˆ¶ã€‚</p>
<h3 data-id="heading-39">é¢è¯•é—®é¢˜</h3>
<p>å¦‚ä½•ä½¿ç”¨ <code>ActivityManager.getMemoryInfo()</code> æ¥ä¼˜åŒ–åº”ç”¨æ€§èƒ½ï¼Ÿ</p>
<p>å½“ç³»ç»Ÿè¿›å…¥ä½å†…å­˜çŠ¶æ€æ—¶ï¼Œå¼€å‘è€…åº”é‡‡å–å“ªäº›æªæ–½ï¼Ÿ</p>
<h3 data-id="heading-40">ä¸»è¦åŠŸèƒ½ï¼š</h3>
<ol>
<li><strong>ä»»åŠ¡ä¸ Activity ä¿¡æ¯</strong>ï¼š<code>ActivityManager</code> å¯ä»¥è·å–æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡ã€<code>Activity</code> ä»¥åŠå®ƒä»¬åœ¨æ ˆä¸­çš„çŠ¶æ€è¯¦æƒ…ã€‚è¿™æœ‰åŠ©äºå¼€å‘è€…ç›‘æ§åº”ç”¨è¡Œä¸ºå’Œç³»ç»Ÿèµ„æºçš„ä½¿ç”¨æƒ…å†µã€‚</li>
<li><strong>å†…å­˜ç®¡ç†</strong>ï¼šå®ƒæä¾›äº†å…³äºç³»ç»Ÿå†…å­˜ä½¿ç”¨çš„ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ¯ä¸ªåº”ç”¨çš„å†…å­˜æ¶ˆè€—å’Œå…¨å±€å†…å­˜çŠ¶æ€ã€‚å¼€å‘è€…å¯ä»¥åˆ©ç”¨è¿™äº›ä¿¡æ¯æ¥ä¼˜åŒ–åº”ç”¨æ€§èƒ½ï¼Œå¹¶åº”å¯¹ä½å†…å­˜åœºæ™¯ã€‚</li>
<li><strong>åº”ç”¨è¿›ç¨‹ç®¡ç†</strong>ï¼š<code>ActivityManager</code> å…è®¸æŸ¥è¯¢æ­£åœ¨è¿è¡Œçš„åº”ç”¨è¿›ç¨‹å’ŒæœåŠ¡çš„è¯¦ç»†ä¿¡æ¯ã€‚å¼€å‘è€…å¯ä»¥å€Ÿæ­¤æ£€æµ‹åº”ç”¨çŠ¶æ€ï¼Œæˆ–å“åº”è¿›ç¨‹çº§åˆ«çš„å˜åŒ–ã€‚</li>
<li><strong>è°ƒè¯•ä¸è¯Šæ–­</strong>ï¼šå®ƒæä¾›äº†è°ƒè¯•å·¥å…·ï¼Œä¾‹å¦‚ç”Ÿæˆ <strong>heap dump</strong> æˆ–å¯¹åº”ç”¨è¿›è¡Œæ€§èƒ½åˆ†æï¼Œå¸®åŠ©è¯†åˆ«æ€§èƒ½ç“¶é¢ˆæˆ–å†…å­˜æ³„æ¼é—®é¢˜ã€‚</li>
</ol>
<h3 data-id="heading-41">å¸¸ç”¨æ–¹æ³•</h3>
<ul>
<li><code>getRunningAppProcesses()</code> ï¼šè¿”å›è®¾å¤‡ä¸Šå½“å‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹åˆ—è¡¨ã€‚</li>
<li><code>getMemoryInfo(ActivityManager.MemoryInfo memoryInfo)</code> ï¼šè·å–ç³»ç»Ÿè¯¦ç»†çš„å†…å­˜ä¿¡æ¯ï¼Œä¾‹å¦‚å¯ç”¨å†…å­˜ã€é˜ˆå€¼å†…å­˜ä»¥åŠè®¾å¤‡æ˜¯å¦å¤„äºä½å†…å­˜çŠ¶æ€ã€‚è¯¥æ–¹æ³•æœ‰åŠ©äºåœ¨å†…å­˜ç´§å¼ æ—¶ä¼˜åŒ–åº”ç”¨è¡Œä¸ºã€‚</li>
<li><code>killBackgroundProcesses(String packageName)</code> ï¼šç»ˆæ­¢æŒ‡å®šåº”ç”¨çš„åå°è¿›ç¨‹ï¼Œä»¥é‡Šæ”¾ç³»ç»Ÿèµ„æºã€‚é€‚ç”¨äºæµ‹è¯•æˆ–ç®¡ç†èµ„æºå¯†é›†å‹åº”ç”¨çš„åœºæ™¯ã€‚</li>
<li><code>isLowRamDevice()</code> ï¼šæ£€æŸ¥è®¾å¤‡æ˜¯å¦è¢«å½’ç±»ä¸ºä½å†…å­˜è®¾å¤‡ï¼Œå¸®åŠ©åº”ç”¨é’ˆå¯¹ä½å†…å­˜è®¾å¤‡ä¼˜åŒ–èµ„æºä½¿ç”¨ã€‚</li>
<li><code>appNotResponding(String message)</code> ï¼šæ¨¡æ‹Ÿâ€œåº”ç”¨æ— å“åº”â€ï¼ˆ<strong>ANR</strong>ï¼‰äº‹ä»¶ï¼Œç”¨äºæµ‹è¯•ç›®çš„ã€‚è°ƒè¯•æ—¶å¯ç”¨äºè§‚å¯Ÿåº”ç”¨åœ¨ <strong>ANR</strong> æƒ…å†µä¸‹çš„è¡¨ç°å’Œå“åº”ã€‚</li>
<li><code>clearApplicationUserData()</code> ï¼šæ¸…é™¤ä¸åº”ç”¨ç›¸å…³çš„æ‰€æœ‰ç”¨æˆ·æ•°æ®ï¼ŒåŒ…æ‹¬æ–‡ä»¶ã€æ•°æ®åº“å’Œå…±äº«åå¥½è®¾ç½®ã€‚å¸¸ç”¨äºå·¥å‚é‡ç½®æˆ–å°†åº”ç”¨æ¢å¤åˆ°åˆå§‹çŠ¶æ€çš„åœºæ™¯ã€‚</li>
</ul>
<h3 data-id="heading-42">ç¤ºä¾‹ç”¨æ³•</h3>
<p>ä»¥ä¸‹ä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ <code>ActivityManager</code> è·å–å†…å­˜ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">val</span> activityManager = getSystemService(Context.ACTIVITY_SERVICE) <span class="hljs-keyword">as</span> ActivityManager
<span class="hljs-keyword">val</span> memoryInfo = ActivityManager.MemoryInfo()
activityManager.getMemoryInfo(memoryInfo)

Log.d(TAG, <span class="hljs-string">"Low memory state: <span class="hljs-subst">${memoryInfo.lowMemory}</span>"</span>)
Log.d(TAG, <span class="hljs-string">"Threshold memory: <span class="hljs-subst">${memoryInfo.threshold / (<span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>)}</span> MB"</span>)

<span class="hljs-keyword">val</span> processes = activityManager.runningAppProcesses
Log.d(TAG, <span class="hljs-string">"Process name: <span class="hljs-subst">${processes.first().processName}</span>"</span>)

<span class="hljs-comment">// æ–¹æ³•ç”¨äºé€šçŸ¥ç³»ç»Ÿåº”ç”¨å¡ä½ï¼Œå¸Œæœ›è§¦å‘ ANR</span>
activityManager.appNotResponding(<span class="hljs-string">"Pokedex is not responding"</span>)

<span class="hljs-comment">// å…è®¸åº”ç”¨æ¸…é™¤è‡ªèº«å­˜å‚¨åœ¨ç£ç›˜ä¸Šçš„æ•°æ®</span>
activityManager.clearApplicationUserData()
</code></pre>
<h3 data-id="heading-43">åœ¨ LeakCanary ä¸­çš„åº”ç”¨</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsquare%2Fleakcanary" target="_blank" title="https://github.com/square/leakcanary" ref="nofollow noopener noreferrer">LeakCanary</a> æ˜¯ä¸€ä¸ªç”± <strong>Square</strong> ç»´æŠ¤çš„å¼€æº Android å†…å­˜æ³„æ¼æ£€æµ‹åº“ã€‚</p>
<p>å®ƒåœ¨å¼€å‘è¿‡ç¨‹ä¸­è‡ªåŠ¨ç›‘æ§å¹¶æ£€æµ‹åº”ç”¨ä¸­çš„å†…å­˜æ³„æ¼ï¼Œæä¾›è¯¦ç»†çš„åˆ†æå’Œå¯æ“ä½œçš„å»ºè®®ï¼Œå¸®åŠ©å¼€å‘è€…é«˜æ•ˆä¿®å¤é—®é¢˜ã€‚</p>
<p>å®ƒåˆ©ç”¨äº† <code>ActivityManager</code> æ¥è¿½è¸ªå†…å­˜çŠ¶æ€å’Œç³»ç»Ÿä¿¡æ¯ã€‚</p>
<h3 data-id="heading-44">æ€»ç»“</h3>
<p><code>ActivityManager</code> ç”¨äºç³»ç»Ÿçº§ç®¡ç†ã€æ€§èƒ½è°ƒä¼˜å’Œç›‘æ§åº”ç”¨è¡Œä¸ºã€‚å°½ç®¡å…¶éƒ¨åˆ†åŠŸèƒ½å·²è¢«ç°ä»£ Android ä¸­æ›´ä¸“ä¸šçš„ API æ‰€å–ä»£ï¼Œä½†å®ƒä»ç„¶æ˜¯ç®¡ç†ä¸ä¼˜åŒ– Android åº”ç”¨èµ„æºä½¿ç”¨çš„é‡è¦å·¥å…·ã€‚å¼€å‘è€…åº”åˆç†ä½¿ç”¨å®ƒï¼Œé¿å…å¯¹ç³»ç»Ÿæ€§èƒ½é€ æˆæ„å¤–å½±å“ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[vue3è¿™äº›å¸¸è§æŒ‡ä»¤ä½ å°è£…äº†å—]]></title>    <link>https://juejin.cn/post/7587349016222122025</link>    <guid>https://juejin.cn/post/7587349016222122025</guid>    <pubDate>2025-12-25T02:53:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587349016222122025" data-draft-id="7587329107303907391" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="vue3è¿™äº›å¸¸è§æŒ‡ä»¤ä½ å°è£…äº†å—"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-25T02:53:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ—å¤ªç™½"/> <meta itemprop="url" content="https://juejin.cn/user/1874034273300919"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            vue3è¿™äº›å¸¸è§æŒ‡ä»¤ä½ å°è£…äº†å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1874034273300919/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ—å¤ªç™½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T02:53:33.000Z" title="Thu Dec 25 2025 02:53:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    60
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>::: tip</p>
<p>ä¸ªäººç½‘ç«™ ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fnexuslin.github.io%2F" target="_blank" title="https://nexuslin.github.io/" ref="nofollow noopener noreferrer">nexuslin.github.io/</a>ï¼‰</p>
<p>æºç åœ°å€ï¼Œæ¬¢è¿star,ä½ çš„staræ˜¯æˆ‘åŠªåŠ›çš„åŠ¨åŠ›ï¼</p>
<p>ã€GIthubåœ°å€ã€‘ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Flintaibai%2FTG" target="_blank" title="https://gitee.com/lintaibai/TG" ref="nofollow noopener noreferrer">github.com/lintaibai/Tâ€¦</a>ï¼‰</p>
<p>ã€Giteeåœ°å€ã€‘ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Flintaibai%2FTG" target="_blank" title="https://gitee.com/lintaibai/TG" ref="nofollow noopener noreferrer">gitee.com/lintaibai/Tâ€¦</a>ï¼‰</p>
<p>:::</p>
<h2 data-id="heading-0">vue3è¿™äº›å¸¸è§æŒ‡ä»¤ä½ å°è£…äº†å—</h2>
<h3 data-id="heading-1">ğŸ‘‰æŒ‡ä»¤æ­å»º</h3>
<p>vue3ä¹‹ä¸­ä¼šæœ‰ä¸€äº›å¸¸è§çš„æŒ‡ä»¤æ“ä½œï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å†™ä¸€ä¸‹,ä¹‹å‰æˆ‘ä»¬å†™äº†æƒé™æŒ‰é’®ï¼Œå…¶å®æ˜¯ç±»ä¼¼çš„</p>
<p>æŒ‡ä»¤çš„æœ€ä¸»è¦æ–‡ä»¶å¦‚ä¸‹ï¼Œæˆ‘ä»¬ä¸»è¦æ˜¯ä¸»æ¨¡å—ä¹‹ä¸­ä½¿ç”¨ï¼Œå…¶ä»–çš„æ¨¡å—ä¹‹ä¸­åˆ†å‰²å†™å¥½æ–¹æ³•å³å¯</p>
<h4 data-id="heading-2">æŒ‡ä»¤ä¸»è¦æ–‡ä»¶</h4>
<pre><code class="hljs language-javascript" lang="javascript">src\utils\directive\index.<span class="hljs-property">ts</span>

<span class="hljs-keyword">import</span> type { <span class="hljs-title class_">App</span>, <span class="hljs-title class_">Directive</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">const</span> directives={};
<span class="hljs-comment">// å¯¼å‡ºæ’ä»¶å¯¹è±¡</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> registerDirectives = {
  <span class="hljs-title function_">install</span>(<span class="hljs-params">app: App</span>) {
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(directives).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> {
      app.<span class="hljs-title function_">directive</span>(key, directives[key])
    })
  }
}
</code></pre>
<h4 data-id="heading-3">æŒ‡ä»¤ä½¿ç”¨</h4>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-comment">// æŒ‡ä»¤ä½¿ç”¨</span>
<span class="hljs-keyword">import</span> {registerDirectives} <span class="hljs-keyword">from</span> <span class="hljs-string">'@/utils/directive'</span><span class="hljs-comment">// å¯¼å…¥å…¨å±€æŒ‡ä»¤</span>
app.<span class="hljs-title function_">use</span>(registerDirectives);<span class="hljs-comment">//å…¨å±€æŒ‡ä»¤æ³¨å†Œ</span>
</code></pre>
<h3 data-id="heading-4">ğŸ‘‰æŒ‡ä»¤ç¼–å†™</h3>
<h4 data-id="heading-5">å¤åˆ¶æŒ‡ä»¤</h4>
<h5 data-id="heading-6">æŒ‡ä»¤ç¼–å†™</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> type { <span class="hljs-title class_">Directive</span>, <span class="hljs-title class_">App</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-comment">// æ‰©å±• HTMLElement æ¥å£</span>
declare <span class="hljs-variable language_">global</span> {
  interface <span class="hljs-title class_">HTMLElement</span> {
    copyData?: string
  }
}

<span class="hljs-comment">// å®šä¹‰æŒ‡ä»¤å€¼çš„ç±»å‹</span>
interface <span class="hljs-title class_">CopyBinding</span> {
  <span class="hljs-attr">value</span>: string
}

<span class="hljs-comment">// å¤åˆ¶æŒ‡ä»¤é…ç½®</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">copy</span>: <span class="hljs-title class_">Directive</span>&lt;<span class="hljs-title class_">HTMLElement</span>, string&gt; = {
  <span class="hljs-title function_">mounted</span>(<span class="hljs-params">el: HTMLElement, binding: CopyBinding</span>) {
    <span class="hljs-comment">// ä¿å­˜è¦å¤åˆ¶çš„å€¼</span>
    el.<span class="hljs-property">copyData</span> = binding.<span class="hljs-property">value</span>
    <span class="hljs-comment">// æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬</span>
    el.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, handleClick)
  },
  <span class="hljs-title function_">updated</span>(<span class="hljs-params">el: HTMLElement, binding: CopyBinding</span>) {
    <span class="hljs-comment">// æ›´æ–°è¦å¤åˆ¶çš„å€¼</span>
    el.<span class="hljs-property">copyData</span> = binding.<span class="hljs-property">value</span>
  },
  <span class="hljs-title function_">beforeUnmount</span>(<span class="hljs-params">el: HTMLElement</span>) {
    <span class="hljs-comment">// ç§»é™¤äº‹ä»¶ç›‘å¬</span>
    el.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'click'</span>, handleClick)
  }
}

<span class="hljs-comment">// å¤„ç†å¤åˆ¶åŠŸèƒ½</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleClick</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">event: Event</span>) =&gt; {
  <span class="hljs-keyword">const</span> el = event.<span class="hljs-property">currentTarget</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">HTMLElement</span>
  <span class="hljs-keyword">if</span> (!el.<span class="hljs-property">copyData</span>) <span class="hljs-keyword">return</span>

  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// ä½¿ç”¨ç°ä»£çš„ Clipboard API</span>
    <span class="hljs-keyword">await</span> navigator.<span class="hljs-property">clipboard</span>.<span class="hljs-title function_">writeText</span>(el.<span class="hljs-property">copyData</span>)
    <span class="hljs-comment">// å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ æˆåŠŸæç¤º</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¤åˆ¶æˆåŠŸ'</span>)
  } <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-comment">// é™çº§æ–¹æ¡ˆï¼šä½¿ç”¨ä¼ ç»Ÿæ–¹æ³•</span>
    <span class="hljs-keyword">const</span> input = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'input'</span>)
    input.<span class="hljs-property">value</span> = el.<span class="hljs-property">copyData</span>
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(input)
    input.<span class="hljs-title function_">select</span>()
    <span class="hljs-keyword">try</span> {
      <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">execCommand</span>(<span class="hljs-string">'Copy'</span>)
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¤åˆ¶æˆåŠŸ'</span>)
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å¤åˆ¶å¤±è´¥:'</span>, err)
    }
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">removeChild</span>(input)
  }
}
<span class="hljs-comment">// å¯¼å‡ºæŒ‡ä»¤å¯¹è±¡</span>
<span class="hljs-keyword">export</span> { copy }

</code></pre>
<h5 data-id="heading-7">å¼•å…¥æŒ‡ä»¤</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¤åˆ¶æŒ‡ä»¤</span>
<span class="hljs-keyword">import</span> {copy} <span class="hljs-keyword">from</span> <span class="hljs-string">'./modules/copy'</span>

<span class="hljs-comment">// å®šä¹‰æ‰€æœ‰æŒ‡ä»¤</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">directives</span>: <span class="hljs-title class_">Record</span>&lt;string, <span class="hljs-title class_">Directive</span>&gt; = {

  <span class="hljs-comment">// å¤åˆ¶æŒ‡ä»¤</span>
  copy,
}
</code></pre>
<h5 data-id="heading-8">ä½¿ç”¨æŒ‡ä»¤</h5>
<p>æ¥ä¸‹æ¥æ¼”ç¤ºä¸€ä¸‹åœ¨é¡¹ç›®ä¹‹ä¸­è¿›è¡Œä½¿ç”¨æŒ‡ä»¤</p>
<pre><code class="hljs language-javascript" lang="javascript">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flex gap-3"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> 
      <span class="hljs-attr">class</span>=<span class="hljs-string">"flex-1 px-4 py-2 bg-gray-50 border-0 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-200"</span> 
      <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥è¦å¤åˆ¶çš„å†…å®¹"</span> 
      <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> 
      <span class="hljs-attr">v-model</span>=<span class="hljs-string">"data"</span>
    &gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> 
      <span class="hljs-attr">class</span>=<span class="hljs-string">"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors duration-200"</span>
      <span class="hljs-attr">v-copy</span>=<span class="hljs-string">"data"</span>
    &gt;</span>
      å¤åˆ¶
    <span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">const</span> data = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'æˆ‘æ˜¯è¢«å¤åˆ¶çš„å†…å®¹ ğŸ’ ğŸ‰ ğŸŠ'</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

</code></pre>
<h4 data-id="heading-9">æ°´å°æŒ‡ä»¤</h4>
<p>æ¥ä¸‹æ¥å†™ä¸€ä¸ªæ°´å°æŒ‡ä»¤ï¼Œæˆ‘ä»¬è®¾ç½®çš„æ˜¯é‡‡å–canvaså®ç°çš„æ°´å°æ•ˆæœï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±ç¼–å†™ä¸€ä¸‹</p>
<h5 data-id="heading-10">å¼•å…¥æŒ‡ä»¤</h5>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±åœ¨è¿™é‡Œç¼–å†™æ°´å°</p>
<pre><code class="hljs language-javascript" lang="javascript">src\utils\directive\modules\watermark .<span class="hljs-property">ts</span>
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ°´å°æŒ‡ä»¤</span>
<span class="hljs-keyword">import</span> {watermark} <span class="hljs-keyword">from</span> <span class="hljs-string">'./modules/watermark'</span>

<span class="hljs-comment">// å®šä¹‰æ‰€æœ‰æŒ‡ä»¤</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">directives</span>: <span class="hljs-title class_">Record</span>&lt;string, <span class="hljs-title class_">Directive</span>&gt; = {
  <span class="hljs-comment">// æ°´å°æŒ‡ä»¤</span>
  watermark,
}
</code></pre>
<h5 data-id="heading-11">æŒ‡ä»¤ç¼–å†™</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// modules/watermark.ts</span>

<span class="hljs-keyword">export</span> interface <span class="hljs-title class_">WatermarkConfig</span> {
  text?: string
  color?: string
  fontSize?: number
  fontFamily?: string
  width?: number
  height?: number
  rotate?: number
  zIndex?: number
}

interface <span class="hljs-title class_">HTMLElementWithWatermark</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HTMLElement</span> {
  _watermarkElement?: <span class="hljs-title class_">HTMLDivElement</span>
}

<span class="hljs-keyword">const</span> <span class="hljs-attr">defaultConfig</span>: <span class="hljs-title class_">Required</span>&lt;<span class="hljs-title class_">WatermarkConfig</span>&gt; = {
  <span class="hljs-attr">text</span>: <span class="hljs-string">'Watermark'</span>,
  <span class="hljs-attr">color</span>: <span class="hljs-string">'rgba(0, 0, 0, 0.15)'</span>,
  <span class="hljs-attr">fontSize</span>: <span class="hljs-number">16</span>,
  <span class="hljs-attr">fontFamily</span>: <span class="hljs-string">'Arial'</span>,
  <span class="hljs-attr">width</span>: <span class="hljs-number">200</span>,
  <span class="hljs-attr">height</span>: <span class="hljs-number">200</span>,
  <span class="hljs-attr">rotate</span>: -<span class="hljs-number">20</span>,
  <span class="hljs-attr">zIndex</span>: <span class="hljs-number">9999</span>
}

<span class="hljs-keyword">const</span> createWatermark = (<span class="hljs-attr">config</span>: <span class="hljs-title class_">WatermarkConfig</span>): <span class="hljs-function"><span class="hljs-params">string</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> finalConfig = { ...defaultConfig, ...config }
  
  <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'canvas'</span>)
  canvas.<span class="hljs-property">width</span> = finalConfig.<span class="hljs-property">width</span>
  canvas.<span class="hljs-property">height</span> = finalConfig.<span class="hljs-property">height</span>
  <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">'2d'</span>)!

  <span class="hljs-comment">// è®¾ç½®ç”»å¸ƒæ ·å¼</span>
  ctx.<span class="hljs-title function_">rotate</span>((finalConfig.<span class="hljs-property">rotate</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>) / <span class="hljs-number">180</span>)
  ctx.<span class="hljs-property">font</span> = <span class="hljs-string">`<span class="hljs-subst">${finalConfig.fontSize}</span>px <span class="hljs-subst">${finalConfig.fontFamily}</span>`</span>
  ctx.<span class="hljs-property">fillStyle</span> = finalConfig.<span class="hljs-property">color</span>
  ctx.<span class="hljs-property">textAlign</span> = <span class="hljs-string">'center'</span>
  ctx.<span class="hljs-property">textBaseline</span> = <span class="hljs-string">'middle'</span>
  
  <span class="hljs-comment">// ç»˜åˆ¶æ°´å°æ–‡æœ¬</span>
  ctx.<span class="hljs-title function_">fillText</span>(finalConfig.<span class="hljs-property">text</span>, finalConfig.<span class="hljs-property">width</span> / <span class="hljs-number">2</span>, finalConfig.<span class="hljs-property">height</span> / <span class="hljs-number">2</span>)

  <span class="hljs-keyword">return</span> canvas.<span class="hljs-title function_">toDataURL</span>()
}

<span class="hljs-keyword">const</span> watermark = {
  <span class="hljs-title function_">mounted</span>(<span class="hljs-params">el: HTMLElementWithWatermark, binding: { value: WatermarkConfig }</span>) {
    <span class="hljs-keyword">const</span> config = binding.<span class="hljs-property">value</span> || {}
    <span class="hljs-keyword">const</span> dataURL = <span class="hljs-title function_">createWatermark</span>(config)

    <span class="hljs-comment">// åˆ›å»ºæ°´å°å±‚</span>
    <span class="hljs-keyword">const</span> watermarkDiv = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>)
    watermarkDiv.<span class="hljs-property">style</span>.<span class="hljs-property">position</span> = <span class="hljs-string">'absolute'</span>
    watermarkDiv.<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = <span class="hljs-string">'0'</span>
    watermarkDiv.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-string">'0'</span>
    watermarkDiv.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">'100%'</span>
    watermarkDiv.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-string">'100%'</span>
    watermarkDiv.<span class="hljs-property">style</span>.<span class="hljs-property">pointerEvents</span> = <span class="hljs-string">'none'</span>
    watermarkDiv.<span class="hljs-property">style</span>.<span class="hljs-property">backgroundImage</span> = <span class="hljs-string">`url(<span class="hljs-subst">${dataURL}</span>)`</span>
    watermarkDiv.<span class="hljs-property">style</span>.<span class="hljs-property">backgroundRepeat</span> = <span class="hljs-string">'repeat'</span>
    watermarkDiv.<span class="hljs-property">style</span>.<span class="hljs-property">zIndex</span> = <span class="hljs-title class_">String</span>(config.<span class="hljs-property">zIndex</span> || defaultConfig.<span class="hljs-property">zIndex</span>)

    <span class="hljs-comment">// è®¾ç½®çˆ¶å…ƒç´ ä¸ºç›¸å¯¹å®šä½</span>
    el.<span class="hljs-property">style</span>.<span class="hljs-property">position</span> = <span class="hljs-string">'relative'</span>
    <span class="hljs-comment">// æ·»åŠ æ°´å°å±‚</span>
    el.<span class="hljs-title function_">appendChild</span>(watermarkDiv)

    <span class="hljs-comment">// ä¿å­˜æ°´å°å…ƒç´ å¼•ç”¨</span>
    el.<span class="hljs-property">_watermarkElement</span> = watermarkDiv
  },

  <span class="hljs-title function_">updated</span>(<span class="hljs-params">el: HTMLElementWithWatermark, binding: { value: WatermarkConfig; oldValue: WatermarkConfig }</span>) {
    <span class="hljs-comment">// å¦‚æœé…ç½®å‘ç”Ÿå˜åŒ–ï¼Œé‡æ–°æ¸²æŸ“æ°´å°</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(binding.<span class="hljs-property">value</span>) !== <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(binding.<span class="hljs-property">oldValue</span>)) {
      <span class="hljs-comment">// ç§»é™¤æ—§æ°´å°</span>
      <span class="hljs-keyword">if</span> (el.<span class="hljs-property">_watermarkElement</span>) {
        el.<span class="hljs-title function_">removeChild</span>(el.<span class="hljs-property">_watermarkElement</span>)
      }
      <span class="hljs-comment">// åˆ›å»ºæ–°æ°´å°</span>
      watermark.<span class="hljs-title function_">mounted</span>(el, binding)
    }
  },

  <span class="hljs-title function_">unmounted</span>(<span class="hljs-params">el: HTMLElementWithWatermark</span>) {
    <span class="hljs-comment">// ç»„ä»¶å¸è½½æ—¶ç§»é™¤æ°´å°</span>
    <span class="hljs-keyword">if</span> (el.<span class="hljs-property">_watermarkElement</span>) {
      el.<span class="hljs-title function_">removeChild</span>(el.<span class="hljs-property">_watermarkElement</span>)
      <span class="hljs-keyword">delete</span> el.<span class="hljs-property">_watermarkElement</span>
    }
  }
}
<span class="hljs-keyword">export</span> { watermark }
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> watermark;

</code></pre>
<h5 data-id="heading-12">æŒ‡ä»¤ä½¿ç”¨</h5>
<p>è¿™ä¸ªæ—¶å€™ä½¿ç”¨æˆ‘ä»¬çš„æŒ‡ä»¤ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„æ•ˆæœ</p>
<pre><code class="hljs language-javascript" lang="javascript">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flex gap-3 content"</span> <span class="hljs-attr">v-watermark</span>=<span class="hljs-string">"watermarkConfig"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-lg font-semibold mb-4 text-gray-800"</span>&gt;</span>æ°´å°æŒ‡ä»¤<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> 
      <span class="hljs-attr">class</span>=<span class="hljs-string">"flex-1 px-4 py-2  border-0 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-200"</span> 
      <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥è¦å¤åˆ¶çš„å†…å®¹"</span> 
      <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> 
      <span class="hljs-attr">v-model</span>=<span class="hljs-string">"data"</span>
    &gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref,computed } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-comment">// å°†åŸæ¥çš„ compute æ–¹æ³•æ”¹ä¸ºè®¡ç®—å±æ€§</span>
<span class="hljs-keyword">const</span> watermarkText = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> data.<span class="hljs-property">value</span>)

<span class="hljs-keyword">const</span> data = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'æ°´å°å†…å®¹ğŸ’ ğŸ‰ ğŸŠ'</span>)

<span class="hljs-comment">// ç„¶ååœ¨ watermarkConfig ä¸­ä½¿ç”¨è¿™ä¸ªè®¡ç®—å±æ€§</span>
<span class="hljs-keyword">const</span> watermarkConfig = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> ({
  <span class="hljs-attr">text</span>: watermarkText.<span class="hljs-property">value</span>,
  <span class="hljs-attr">color</span>: <span class="hljs-string">'rgba(0, 0, 0, 0.15)'</span>,
  <span class="hljs-attr">fontSize</span>: <span class="hljs-number">16</span>,
  <span class="hljs-attr">fontFamily</span>: <span class="hljs-string">'Arial'</span>,
  <span class="hljs-attr">width</span>: <span class="hljs-number">200</span>,
  <span class="hljs-attr">height</span>: <span class="hljs-number">200</span>,
  <span class="hljs-attr">rotate</span>: -<span class="hljs-number">20</span>,
  <span class="hljs-attr">zIndex</span>: <span class="hljs-number">9999</span>,
}))
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.content</span> {
  <span class="hljs-attribute">position</span>: relative;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#fff</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-13">æ‹–æ‹½æŒ‡ä»¤</h4>
<h5 data-id="heading-14">æŒ‡ä»¤ç¼–å†™</h5>
<pre><code class="hljs language-javascript" lang="javascript">src\utils\directive\modules\draggable.<span class="hljs-property">ts</span>
</code></pre>
<p>æŒ‡ä»¤å†…å®¹,è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸ªéƒ¨åˆ†ï¼ŒæŒ‡ä»¤çš„ä½ç½®æ˜¯ç›¸å¯¹äºæˆ‘ä»¬çˆ¶å…ƒç´ ä½ç½®ï¼Œè€Œä¸æ˜¯ç›¸å¯¹äºæˆ‘ä»¬è§†å£çš„ä½ç½®</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è®°å½•åˆå§‹ä½ç½®</span>
<span class="hljs-keyword">const</span> rect = el.<span class="hljs-title function_">getBoundingClientRect</span>()
dragData.<span class="hljs-property">initialLeft</span> = rect.<span class="hljs-property">left</span>
dragData.<span class="hljs-property">initialTop</span> = rect.<span class="hljs-property">top</span>

=&gt;æ›´æ”¹ä¸º

<span class="hljs-comment">// è·å–å½“å‰ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®åˆ™é»˜è®¤ä¸º0</span>
dragData.<span class="hljs-property">initialLeft</span> = <span class="hljs-built_in">parseInt</span>(el.<span class="hljs-property">style</span>.<span class="hljs-property">left</span>) || <span class="hljs-number">0</span>
dragData.<span class="hljs-property">initialTop</span> = <span class="hljs-built_in">parseInt</span>(el.<span class="hljs-property">style</span>.<span class="hljs-property">top</span>) || <span class="hljs-number">0</span>
</code></pre>
<p>å®Œæ•´ä¿®æ”¹ä»¥åæˆ‘ä»¬çš„ç‰ˆæœ¬å¦‚ä¸‹</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> type { <span class="hljs-title class_">Directive</span>, <span class="hljs-title class_">DirectiveBinding</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

interface <span class="hljs-title class_">DraggableElement</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HTMLElement</span> {
  _dragData?: {
    <span class="hljs-attr">isDragging</span>: boolean
    <span class="hljs-attr">startX</span>: number
    <span class="hljs-attr">startY</span>: number
    <span class="hljs-attr">initialLeft</span>: number
    <span class="hljs-attr">initialTop</span>: number
    <span class="hljs-attr">initialPosition</span>: string
    <span class="hljs-attr">zIndex</span>: string
  }
  _cleanup?: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">void</span>  <span class="hljs-comment">// æ·»åŠ è¿™ä¸€è¡Œ</span>
}


<span class="hljs-keyword">const</span> <span class="hljs-attr">draggable</span>: <span class="hljs-title class_">Directive</span>&lt;<span class="hljs-title class_">DraggableElement</span>, boolean&gt; = {
  <span class="hljs-title function_">mounted</span>(<span class="hljs-params">el: DraggableElement, binding: DirectiveBinding&lt;boolean&gt;</span>) {
    <span class="hljs-keyword">if</span> (binding.<span class="hljs-property">value</span> === <span class="hljs-literal">false</span>) <span class="hljs-keyword">return</span>

    <span class="hljs-keyword">const</span> dragData = {
      <span class="hljs-attr">isDragging</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">startX</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">startY</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">initialLeft</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">initialTop</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">initialPosition</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">zIndex</span>: <span class="hljs-string">''</span>
    }
    el.<span class="hljs-property">_dragData</span> = dragData

    <span class="hljs-comment">// è®¾ç½®åˆå§‹æ ·å¼</span>
    el.<span class="hljs-property">style</span>.<span class="hljs-property">cursor</span> = <span class="hljs-string">'move'</span>
    el.<span class="hljs-property">style</span>.<span class="hljs-property">position</span> = el.<span class="hljs-property">style</span>.<span class="hljs-property">position</span> || <span class="hljs-string">'absolute'</span>

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleMouseDown</span> = (<span class="hljs-params">e: MouseEvent</span>) =&gt; {
      dragData.<span class="hljs-property">isDragging</span> = <span class="hljs-literal">true</span>
      dragData.<span class="hljs-property">startX</span> = e.<span class="hljs-property">clientX</span>
      dragData.<span class="hljs-property">startY</span> = e.<span class="hljs-property">clientY</span>
      dragData.<span class="hljs-property">initialPosition</span> = el.<span class="hljs-property">style</span>.<span class="hljs-property">position</span>
      dragData.<span class="hljs-property">zIndex</span> = el.<span class="hljs-property">style</span>.<span class="hljs-property">zIndex</span>
      
      <span class="hljs-comment">// è·å–å½“å‰ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®åˆ™é»˜è®¤ä¸º0</span>
      dragData.<span class="hljs-property">initialLeft</span> = <span class="hljs-built_in">parseInt</span>(el.<span class="hljs-property">style</span>.<span class="hljs-property">left</span>) || <span class="hljs-number">0</span>
      dragData.<span class="hljs-property">initialTop</span> = <span class="hljs-built_in">parseInt</span>(el.<span class="hljs-property">style</span>.<span class="hljs-property">top</span>) || <span class="hljs-number">0</span>

      <span class="hljs-comment">// æé«˜å±‚çº§</span>
      el.<span class="hljs-property">style</span>.<span class="hljs-property">zIndex</span> = <span class="hljs-string">'9999'</span>
      
      <span class="hljs-comment">// æ·»åŠ ç§»åŠ¨æ—¶çš„æ ·å¼</span>
      el.<span class="hljs-property">style</span>.<span class="hljs-property">transition</span> = <span class="hljs-string">'none'</span>
      el.<span class="hljs-property">style</span>.<span class="hljs-property">userSelect</span> = <span class="hljs-string">'none'</span>
    }

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleMouseMove</span> = (<span class="hljs-params">e: MouseEvent</span>) =&gt; {
      <span class="hljs-keyword">if</span> (!dragData.<span class="hljs-property">isDragging</span>) <span class="hljs-keyword">return</span>

      <span class="hljs-keyword">const</span> deltaX = e.<span class="hljs-property">clientX</span> - dragData.<span class="hljs-property">startX</span>
      <span class="hljs-keyword">const</span> deltaY = e.<span class="hljs-property">clientY</span> - dragData.<span class="hljs-property">startY</span>

      el.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-string">`<span class="hljs-subst">${dragData.initialLeft + deltaX}</span>px`</span>
      el.<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = <span class="hljs-string">`<span class="hljs-subst">${dragData.initialTop + deltaY}</span>px`</span>
    }

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleMouseUp</span> = (<span class="hljs-params"/>) =&gt; {
      <span class="hljs-keyword">if</span> (!dragData.<span class="hljs-property">isDragging</span>) <span class="hljs-keyword">return</span>
      
      dragData.<span class="hljs-property">isDragging</span> = <span class="hljs-literal">false</span>
      
      <span class="hljs-comment">// æ¢å¤æ ·å¼</span>
      el.<span class="hljs-property">style</span>.<span class="hljs-property">zIndex</span> = dragData.<span class="hljs-property">zIndex</span>
      el.<span class="hljs-property">style</span>.<span class="hljs-property">userSelect</span> = <span class="hljs-string">''</span>
      el.<span class="hljs-property">style</span>.<span class="hljs-property">transition</span> = <span class="hljs-string">''</span>
    }

    <span class="hljs-comment">// æ·»åŠ äº‹ä»¶ç›‘å¬</span>
    el.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mousedown'</span>, handleMouseDown)
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mousemove'</span>, handleMouseMove)
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mouseup'</span>, handleMouseUp)

    <span class="hljs-comment">// ä¿å­˜æ¸…ç†å‡½æ•°</span>
    el.<span class="hljs-property">_cleanup</span> = <span class="hljs-function">() =&gt;</span> {
      el.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'mousedown'</span>, handleMouseDown)
      <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'mousemove'</span>, handleMouseMove)
      <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'mouseup'</span>, handleMouseUp)
    }
  },

  <span class="hljs-title function_">unmounted</span>(<span class="hljs-params">el: DraggableElement</span>) {
    <span class="hljs-comment">// æ¸…ç†äº‹ä»¶ç›‘å¬</span>
    <span class="hljs-keyword">if</span> (el.<span class="hljs-property">_cleanup</span>) {
      el.<span class="hljs-title function_">_cleanup</span>()
    }
    <span class="hljs-keyword">delete</span> el.<span class="hljs-property">_dragData</span>
  },

  <span class="hljs-title function_">updated</span>(<span class="hljs-params">el: DraggableElement, binding: DirectiveBinding&lt;boolean&gt;</span>) {
    <span class="hljs-comment">// å¦‚æœæŒ‡ä»¤å€¼æ”¹å˜ï¼Œæ›´æ–°çŠ¶æ€</span>
    <span class="hljs-keyword">if</span> (binding.<span class="hljs-property">value</span> === <span class="hljs-literal">false</span> &amp;&amp; el.<span class="hljs-property">_dragData</span>) {
      el.<span class="hljs-property">style</span>.<span class="hljs-property">cursor</span> = <span class="hljs-string">''</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (binding.<span class="hljs-property">value</span> === <span class="hljs-literal">true</span>) {
      el.<span class="hljs-property">style</span>.<span class="hljs-property">cursor</span> = <span class="hljs-string">'move'</span>
    }
  }
}

<span class="hljs-keyword">export</span> {draggable}

</code></pre>
<h5 data-id="heading-15">æŒ‡ä»¤ä½¿ç”¨</h5>
<p>æˆ‘ä»¬åœ¨æŒ‡ä»¤ä¹‹ä¸­è¿›è¡Œä½¿ç”¨ï¼Œæ•ˆæœok</p>
<pre><code class="hljs language-javascript" lang="javascript">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"relative"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-draggable</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"draggable-box"</span>&gt;</span>
      å¯æ‹–æ‹½çš„å†…å®¹
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- ä¹Ÿå¯ä»¥åŠ¨æ€æ§åˆ¶æ˜¯å¦å¯æ‹–æ‹½ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-draggable</span>=<span class="hljs-string">"isDraggable"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"draggable-box"</span>&gt;</span>
      æ¡ä»¶æ‹–æ‹½çš„å†…å®¹
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">const</span> isDraggable = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">true</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.draggable-box</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>;
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#409EFF</span>;
  <span class="hljs-attribute">color</span>: white;
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">align-items</span>: center;
  <span class="hljs-attribute">justify-content</span>: center;
  <span class="hljs-attribute">position</span>: absolute;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-16">é˜²æŠ–æŒ‡ä»¤</h4>
<h5 data-id="heading-17">æŒ‡ä»¤ç¼–å†™</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// modules/debounce.ts</span>
<span class="hljs-comment">/**
 * é˜²æŠ–å‡½æ•°
 * <span class="hljs-doctag">@param</span> fn éœ€è¦é˜²æŠ–çš„å‡½æ•°
 * <span class="hljs-doctag">@param</span> delay å»¶è¿Ÿæ—¶é—´ï¼Œå•ä½æ¯«ç§’ï¼Œé»˜è®¤300ms
 * <span class="hljs-doctag">@param</span> immediate æ˜¯å¦ç«‹å³æ‰§è¡Œï¼Œé»˜è®¤false
 * <span class="hljs-doctag">@returns</span> è¿”å›é˜²æŠ–å¤„ç†åçš„å‡½æ•°
 */</span>
interface <span class="hljs-title class_">DebounceBinding</span> {
  <span class="hljs-attr">value</span>: <span class="hljs-title class_">Function</span>;
  arg?: string; <span class="hljs-comment">// å»¶è¿Ÿæ—¶é—´å‚æ•°</span>
}

<span class="hljs-comment">// é˜²æŠ–å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">debounceFn</span>(<span class="hljs-params">func: <span class="hljs-built_in">Function</span>, wait: number</span>) {
  <span class="hljs-keyword">let</span> <span class="hljs-attr">timeout</span>: <span class="hljs-title class_">NodeJS</span>.<span class="hljs-property">Timeout</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-variable language_">this</span>: any, ...args: any[]</span>) {
    <span class="hljs-built_in">clearTimeout</span>(timeout);
    timeout = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      func.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
    }, wait);
  };
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> debounce = {
  <span class="hljs-title function_">mounted</span>(<span class="hljs-params">el: HTMLElement, binding: DebounceBinding</span>) {
    <span class="hljs-comment">// è·å–å»¶è¿Ÿæ—¶é—´ï¼Œé»˜è®¤ä¸º 500ms</span>
    <span class="hljs-keyword">const</span> delay = <span class="hljs-title class_">Number</span>(binding.<span class="hljs-property">arg</span>) || <span class="hljs-number">500</span>;
    
    <span class="hljs-comment">// åˆ›å»ºé˜²æŠ–å‡½æ•°</span>
    <span class="hljs-keyword">const</span> debouncedFn = <span class="hljs-title function_">debounceFn</span>(binding.<span class="hljs-property">value</span>, delay);
    
    <span class="hljs-comment">// ä¿å­˜åŸå§‹å‡½æ•°å’Œé˜²æŠ–å‡½æ•°åˆ°å…ƒç´ çš„ dataset ä¸­</span>
    el.<span class="hljs-property">dataset</span>.<span class="hljs-property">debounceFn</span> = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
      <span class="hljs-attr">original</span>: binding.<span class="hljs-property">value</span>.<span class="hljs-title function_">toString</span>(),
      <span class="hljs-attr">debounced</span>: debouncedFn.<span class="hljs-title function_">toString</span>()
    });
    
    <span class="hljs-comment">// æ·»åŠ äº‹ä»¶ç›‘å¬å™¨</span>
    el.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, debouncedFn);
  },
  
  <span class="hljs-title function_">updated</span>(<span class="hljs-params">el: HTMLElement, binding: DebounceBinding</span>) {
    <span class="hljs-comment">// å¦‚æœå€¼å‘ç”Ÿå˜åŒ–ï¼Œæ›´æ–°é˜²æŠ–å‡½æ•°</span>
    <span class="hljs-keyword">const</span> delay = <span class="hljs-title class_">Number</span>(binding.<span class="hljs-property">arg</span>) || <span class="hljs-number">500</span>;
    <span class="hljs-keyword">const</span> debouncedFn = <span class="hljs-title function_">debounceFn</span>(binding.<span class="hljs-property">value</span>, delay);
    
    <span class="hljs-comment">// ç§»é™¤æ—§çš„äº‹ä»¶ç›‘å¬å™¨</span>
    <span class="hljs-keyword">const</span> oldFn = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>(<span class="hljs-string">'return '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(el.<span class="hljs-property">dataset</span>.<span class="hljs-property">debounceFn</span> || <span class="hljs-string">'{}'</span>).<span class="hljs-property">debounced</span>)();
    el.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'click'</span>, oldFn);
    
    <span class="hljs-comment">// æ›´æ–° dataset</span>
    el.<span class="hljs-property">dataset</span>.<span class="hljs-property">debounceFn</span> = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
      <span class="hljs-attr">original</span>: binding.<span class="hljs-property">value</span>.<span class="hljs-title function_">toString</span>(),
      <span class="hljs-attr">debounced</span>: debouncedFn.<span class="hljs-title function_">toString</span>()
    });
    
    <span class="hljs-comment">// æ·»åŠ æ–°çš„äº‹ä»¶ç›‘å¬å™¨</span>
    el.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, debouncedFn);
  },
  
  <span class="hljs-title function_">unmounted</span>(<span class="hljs-params">el: HTMLElement</span>) {
    <span class="hljs-comment">// ç»„ä»¶å¸è½½æ—¶ç§»é™¤äº‹ä»¶ç›‘å¬å™¨</span>
    <span class="hljs-keyword">const</span> fn = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>(<span class="hljs-string">'return '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(el.<span class="hljs-property">dataset</span>.<span class="hljs-property">debounceFn</span> || <span class="hljs-string">'{}'</span>).<span class="hljs-property">debounced</span>)();
    el.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'click'</span>, fn);
    <span class="hljs-keyword">delete</span> el.<span class="hljs-property">dataset</span>.<span class="hljs-property">debounceFn</span>;
  }
};

<span class="hljs-comment">// å¯¼å‡ºé˜²æŠ–å‡½æ•°ä¾›å…¶ä»–åœ°æ–¹ä½¿ç”¨</span>
<span class="hljs-keyword">export</span> { debounceFn };

</code></pre>
<h5 data-id="heading-18">æŒ‡ä»¤ä½¿ç”¨</h5>
<pre><code class="hljs language-javascript" lang="javascript">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flex flex-wrap gap-4 p-6"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- åŸºç¡€é˜²æŠ–æŒ‰é’® --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
      <span class="hljs-attr">v-debounce</span>=<span class="hljs-string">"handleClick"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"px-6 py-2.5 bg-blue-600 text-white font-medium text-sm leading-tight uppercase rounded shadow-md hover:bg-blue-700 hover:shadow-lg focus:bg-blue-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-blue-800 active:shadow-lg transition duration-150 ease-in-out"</span>
    &gt;</span>
      é˜²æŠ–æŒ‰é’®
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- 500msé˜²æŠ–æŒ‰é’® --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
      <span class="hljs-attr">v-debounce:500</span>=<span class="hljs-string">"handleClick"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"px-6 py-2.5 bg-green-600 text-white font-medium text-sm leading-tight uppercase rounded shadow-md hover:bg-green-700 hover:shadow-lg focus:bg-green-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-green-800 active:shadow-lg transition duration-150 ease-in-out"</span>
    &gt;</span>
      500msé˜²æŠ–æŒ‰é’®
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- ç«‹å³æ‰§è¡Œé˜²æŠ–æŒ‰é’® --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
      <span class="hljs-attr">v-debounce.immediate</span>=<span class="hljs-string">"handleClick"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"px-6 py-2.5 bg-purple-600 text-white font-medium text-sm leading-tight uppercase rounded shadow-md hover:bg-purple-700 hover:shadow-lg focus:bg-purple-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-purple-800 active:shadow-lg transition duration-150 ease-in-out"</span>
    &gt;</span>
      ç«‹å³æ‰§è¡Œé˜²æŠ–æŒ‰é’®
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleClick</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é˜²æŠ–æŒ‰é’®ç‚¹å‡»'</span>);
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

</code></pre>
<h4 data-id="heading-19">èŠ‚æµæŒ‡ä»¤</h4>
<h5 data-id="heading-20">æŒ‡ä»¤ç¼–å†™</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * v-throttle æŒ‡ä»¤
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} fn éœ€è¦èŠ‚æµçš„å‡½æ•°
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Number</span>} delay å»¶è¿Ÿæ—¶é—´
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Boolean</span>} immediate æ˜¯å¦ç«‹å³æ‰§è¡Œ
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Function</span>} è¿”å›ä¸€ä¸ªèŠ‚æµåçš„å‡½æ•°
 */</span>

<span class="hljs-comment">// modules/throttle.ts</span>

interface <span class="hljs-title class_">ThrottleBinding</span> {
  <span class="hljs-attr">value</span>: <span class="hljs-title class_">Function</span>;
  arg?: string | number; <span class="hljs-comment">// å»¶è¿Ÿæ—¶é—´å‚æ•°</span>
  modifiers?: {
    immediate?: boolean;
  };
}

<span class="hljs-comment">// èŠ‚æµå‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">throttleFn</span>(<span class="hljs-params">
  func: <span class="hljs-built_in">Function</span>,
  wait: number,
  immediate: boolean = <span class="hljs-literal">false</span>
</span>) {
  <span class="hljs-keyword">let</span> <span class="hljs-attr">timeout</span>: <span class="hljs-title class_">NodeJS</span>.<span class="hljs-property">Timeout</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">let</span> previous = <span class="hljs-number">0</span>;

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-variable language_">this</span>: any, ...args: any[]</span>) {
    <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    <span class="hljs-keyword">const</span> remaining = wait - (now - previous);

    <span class="hljs-keyword">if</span> (remaining &lt;= <span class="hljs-number">0</span> || remaining &gt; wait) {
      <span class="hljs-keyword">if</span> (timeout) {
        <span class="hljs-built_in">clearTimeout</span>(timeout);
        timeout = <span class="hljs-literal">null</span>;
      }
      previous = now;
      func.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!timeout &amp;&amp; !immediate) {
      timeout = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        previous = immediate ? <span class="hljs-number">0</span> : <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
        timeout = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">if</span> (!immediate) {
          func.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
        }
      }, remaining);
    }

    <span class="hljs-keyword">if</span> (immediate &amp;&amp; !timeout) {
      func.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
      previous = now;
    }
  };
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> throttle = {
  <span class="hljs-title function_">mounted</span>(<span class="hljs-params">el: HTMLElement, binding: ThrottleBinding</span>) {
    <span class="hljs-keyword">const</span> delay = <span class="hljs-title class_">Number</span>(binding.<span class="hljs-property">arg</span>) || <span class="hljs-number">500</span>;
    <span class="hljs-keyword">const</span> immediate = binding.<span class="hljs-property">modifiers</span>?.<span class="hljs-property">immediate</span> || <span class="hljs-literal">false</span>;
    
    <span class="hljs-keyword">const</span> throttledFn = <span class="hljs-title function_">throttleFn</span>(binding.<span class="hljs-property">value</span>, delay, immediate);
    
    el.<span class="hljs-property">dataset</span>.<span class="hljs-property">throttleFn</span> = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
      <span class="hljs-attr">original</span>: binding.<span class="hljs-property">value</span>.<span class="hljs-title function_">toString</span>(),
      <span class="hljs-attr">throttled</span>: throttledFn.<span class="hljs-title function_">toString</span>()
    });
    
    el.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, throttledFn);
  },
  
  <span class="hljs-title function_">updated</span>(<span class="hljs-params">el: HTMLElement, binding: ThrottleBinding</span>) {
    <span class="hljs-keyword">const</span> delay = <span class="hljs-title class_">Number</span>(binding.<span class="hljs-property">arg</span>) || <span class="hljs-number">500</span>;
    <span class="hljs-keyword">const</span> immediate = binding.<span class="hljs-property">modifiers</span>?.<span class="hljs-property">immediate</span> || <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">const</span> throttledFn = <span class="hljs-title function_">throttleFn</span>(binding.<span class="hljs-property">value</span>, delay, immediate);
    
    <span class="hljs-keyword">const</span> oldFn = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>(<span class="hljs-string">'return '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(el.<span class="hljs-property">dataset</span>.<span class="hljs-property">throttleFn</span> || <span class="hljs-string">'{}'</span>).<span class="hljs-property">throttled</span>)();
    el.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'click'</span>, oldFn);
    
    el.<span class="hljs-property">dataset</span>.<span class="hljs-property">throttleFn</span> = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
      <span class="hljs-attr">original</span>: binding.<span class="hljs-property">value</span>.<span class="hljs-title function_">toString</span>(),
      <span class="hljs-attr">throttled</span>: throttledFn.<span class="hljs-title function_">toString</span>()
    });
    
    el.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, throttledFn);
  },
  
  <span class="hljs-title function_">unmounted</span>(<span class="hljs-params">el: HTMLElement</span>) {
    <span class="hljs-keyword">const</span> fn = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>(<span class="hljs-string">'return '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(el.<span class="hljs-property">dataset</span>.<span class="hljs-property">throttleFn</span> || <span class="hljs-string">'{}'</span>).<span class="hljs-property">throttled</span>)();
    el.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'click'</span>, fn);
    <span class="hljs-keyword">delete</span> el.<span class="hljs-property">dataset</span>.<span class="hljs-property">throttleFn</span>;
  }
};

<span class="hljs-keyword">export</span> { throttleFn };

</code></pre>
<h5 data-id="heading-21">æŒ‡ä»¤ä½¿ç”¨</h5>
<pre><code class="hljs language-javascript" lang="javascript">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flex flex-wrap gap-4 p-6"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- åŸºç¡€èŠ‚æµæŒ‰é’® --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
      <span class="hljs-attr">v-throttle</span>=<span class="hljs-string">"handleClick"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"px-6 py-2.5 bg-blue-600 text-white font-medium text-sm leading-tight uppercase rounded shadow-md hover:bg-blue-700 hover:shadow-lg focus:bg-blue-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-blue-800 active:shadow-lg transition duration-150 ease-in-out"</span>
    &gt;</span>
      èŠ‚æµæŒ‰é’®
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- 500msèŠ‚æµæŒ‰é’® --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
      <span class="hljs-attr">v-throttle:500</span>=<span class="hljs-string">"handleClick"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"px-6 py-2.5 bg-green-600 text-white font-medium text-sm leading-tight uppercase rounded shadow-md hover:bg-green-700 hover:shadow-lg focus:bg-green-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-green-800 active:shadow-lg transition duration-150 ease-in-out"</span>
    &gt;</span>
      500msèŠ‚æµæŒ‰é’®
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- ç«‹å³æ‰§è¡ŒèŠ‚æµæŒ‰é’® --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
      <span class="hljs-attr">v-throttle.immediate</span>=<span class="hljs-string">"handleClick"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"px-6 py-2.5 bg-purple-600 text-white font-medium text-sm leading-tight uppercase rounded shadow-md hover:bg-purple-700 hover:shadow-lg focus:bg-purple-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-purple-800 active:shadow-lg transition duration-150 ease-in-out"</span>
    &gt;</span>
      ç«‹å³æ‰§è¡ŒèŠ‚æµæŒ‰é’®
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleClick</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æŒ‰é’®è¢«ç‚¹å‡»'</span>);
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-22">é•¿æŒ‰æŒ‡ä»¤</h4>
<h5 data-id="heading-23">æŒ‡ä»¤ç¼–å†™</h5>
<pre><code class="hljs language-javascript" lang="javascript">src\utils\directive\modules\longPress.<span class="hljs-property">ts</span>
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// modules/longPress.ts</span>

interface <span class="hljs-title class_">LongPressBinding</span> {
  <span class="hljs-attr">value</span>: <span class="hljs-title class_">Function</span>;
  arg?: number; <span class="hljs-comment">// é•¿æŒ‰æ—¶é—´ï¼Œå•ä½æ¯«ç§’ï¼Œé»˜è®¤500ms</span>
  modifiers?: {
    stop?: boolean; <span class="hljs-comment">// æ˜¯å¦é˜»æ­¢äº‹ä»¶å†’æ³¡</span>
    prevent?: boolean; <span class="hljs-comment">// æ˜¯å¦é˜»æ­¢é»˜è®¤äº‹ä»¶</span>
  };
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> longPress = {
  <span class="hljs-title function_">mounted</span>(<span class="hljs-params">el: HTMLElement, binding: LongPressBinding</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> binding.<span class="hljs-property">value</span> !== <span class="hljs-string">'function'</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'v-longPress æŒ‡ä»¤éœ€è¦ä¸€ä¸ªå‡½æ•°ä½œä¸ºå€¼'</span>);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">let</span> <span class="hljs-attr">pressTimer</span>: <span class="hljs-title class_">NodeJS</span>.<span class="hljs-property">Timeout</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">let</span> <span class="hljs-attr">startTime</span>: number = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> duration = <span class="hljs-title class_">Number</span>(binding.<span class="hljs-property">arg</span>) || <span class="hljs-number">500</span>;
    <span class="hljs-keyword">const</span> isStop = binding.<span class="hljs-property">modifiers</span>?.<span class="hljs-property">stop</span> || <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">const</span> isPrevent = binding.<span class="hljs-property">modifiers</span>?.<span class="hljs-property">prevent</span> || <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">start</span> = (<span class="hljs-params">e: MouseEvent | TouchEvent</span>) =&gt; {
      <span class="hljs-keyword">if</span> (isPrevent) {
        e.<span class="hljs-title function_">preventDefault</span>();
      }
      <span class="hljs-keyword">if</span> (isStop) {
        e.<span class="hljs-title function_">stopPropagation</span>();
      }

      startTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
      
      pressTimer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        binding.<span class="hljs-title function_">value</span>(e);
      }, duration);
    };

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">cancel</span> = (<span class="hljs-params"/>) =&gt; {
      <span class="hljs-keyword">if</span> (pressTimer) {
        <span class="hljs-built_in">clearTimeout</span>(pressTimer);
        pressTimer = <span class="hljs-literal">null</span>;
      }
    };

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">end</span> = (<span class="hljs-params">e: MouseEvent | TouchEvent</span>) =&gt; {
      <span class="hljs-keyword">const</span> endTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
      <span class="hljs-keyword">const</span> timeDiff = endTime - startTime;
      
      <span class="hljs-comment">// å¦‚æœæŒ‰ä½æ—¶é—´å°äºè®¾å®šæ—¶é—´ï¼Œåˆ™è§†ä¸ºæ™®é€šç‚¹å‡»</span>
      <span class="hljs-keyword">if</span> (timeDiff &lt; duration &amp;&amp; pressTimer) {
        <span class="hljs-title function_">cancel</span>();
        <span class="hljs-keyword">return</span>;
      }
      
      <span class="hljs-title function_">cancel</span>();
    };

    <span class="hljs-comment">// æ·»åŠ äº‹ä»¶ç›‘å¬å™¨</span>
    el.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mousedown'</span>, start);
    el.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'touchstart'</span>, start);
    el.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mouseup'</span>, end);
    el.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'touchend'</span>, end);
    el.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mouseleave'</span>, cancel);
    el.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'touchcancel'</span>, cancel);

    <span class="hljs-comment">// ä¿å­˜æ¸…ç†å‡½æ•°åˆ°å…ƒç´ ä¸Š</span>
    (el <span class="hljs-keyword">as</span> any).<span class="hljs-property">_longPressCleanup</span> = <span class="hljs-function">() =&gt;</span> {
      el.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'mousedown'</span>, start);
      el.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'touchstart'</span>, start);
      el.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'mouseup'</span>, end);
      el.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'touchend'</span>, end);
      el.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'mouseleave'</span>, cancel);
      el.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'touchcancel'</span>, cancel);
      <span class="hljs-title function_">cancel</span>();
    };
  },

  <span class="hljs-title function_">unmounted</span>(<span class="hljs-params">el: HTMLElement</span>) {
    <span class="hljs-comment">// æ¸…ç†äº‹ä»¶ç›‘å¬å™¨</span>
    <span class="hljs-keyword">if</span> ((el <span class="hljs-keyword">as</span> any).<span class="hljs-property">_longPressCleanup</span>) {
      (el <span class="hljs-keyword">as</span> any).<span class="hljs-title function_">_longPressCleanup</span>();
    }
  }
};

</code></pre>
<h5 data-id="heading-24">æŒ‡ä»¤ä½¿ç”¨</h5>
<p>æµ‹è¯•ä¸€ä¸‹æˆ‘ä»¬çš„æŒ‰é’®æŒ‡ä»¤ï¼Œæ•ˆæœok</p>
<pre><code class="hljs language-javascript" lang="javascript">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"p-6 space-y-4"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- åŸºç¡€ç”¨æ³•ï¼Œé»˜è®¤500ms --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
      <span class="hljs-attr">v-longPress</span>=<span class="hljs-string">"handleLongPress"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"</span>
    &gt;</span>
      é•¿æŒ‰æŒ‰é’®
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- è‡ªå®šä¹‰é•¿æŒ‰æ—¶é—´ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
      <span class="hljs-attr">v-longPress:1000</span>=<span class="hljs-string">"handleLongPress"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600"</span>
    &gt;</span>
      1ç§’é•¿æŒ‰æŒ‰é’®
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- é˜»æ­¢äº‹ä»¶å†’æ³¡ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
      <span class="hljs-attr">v-longPress.stop</span>=<span class="hljs-string">"handleLongPress"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"px-4 py-2 bg-purple-500 text-white rounded hover:bg-purple-600"</span>
    &gt;</span>
      é˜»æ­¢å†’æ³¡é•¿æŒ‰æŒ‰é’®
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- é˜»æ­¢é»˜è®¤äº‹ä»¶ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
      <span class="hljs-attr">v-longPress.prevent</span>=<span class="hljs-string">"handleLongPress"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600"</span>
    &gt;</span>
      é˜»æ­¢é»˜è®¤äº‹ä»¶é•¿æŒ‰æŒ‰é’®
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleLongPress</span> = (<span class="hljs-params">event: MouseEvent | TouchEvent</span>) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é•¿æŒ‰è§¦å‘'</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>());
  <span class="hljs-comment">// è¿™é‡Œå¯ä»¥æ·»åŠ ä½ çš„é•¿æŒ‰å¤„ç†é€»è¾‘</span>
  <span class="hljs-keyword">if</span> (event <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">MouseEvent</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é¼ æ ‡äº‹ä»¶'</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è§¦æ‘¸äº‹ä»¶'</span>);
  }
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ€vue3 + Typescript +Tdesign + HiPrint æ‰“å°ä¸‹è½½è§£å†³æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7587398857535684671</link>    <guid>https://juejin.cn/post/7587398857535684671</guid>    <pubDate>2025-12-25T02:23:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587398857535684671" data-draft-id="7587208390481969158" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ€vue3 + Typescript +Tdesign + HiPrint æ‰“å°ä¸‹è½½è§£å†³æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-25T02:23:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="H_å››å¶è‰"/> <meta itemprop="url" content="https://juejin.cn/user/1258302989143437"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ€vue3 + Typescript +Tdesign + HiPrint æ‰“å°ä¸‹è½½è§£å†³æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1258302989143437/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    H_å››å¶è‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T02:23:31.000Z" title="Thu Dec 25 2025 02:23:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="arduino-light">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff}.hljs-subst,.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#434f54}.hljs-attribute,.hljs-doctag,.hljs-keyword,.hljs-name,.hljs-selector-tag{color:#00979d}.hljs-addition,.hljs-built_in,.hljs-bullet,.hljs-code,.hljs-literal{color:#d35400}.hljs-link,.hljs-regexp,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-symbol,.hljs-template-variable,.hljs-variable{color:#00979d}.hljs-deletion,.hljs-quote,.hljs-selector-class,.hljs-selector-id,.hljs-string,.hljs-template-tag,.hljs-type{color:#005c5f}.hljs-section,.hljs-title{color:#800;font-weight:700}.hljs-comment{color:rgba(149,165,166,.8)}.hljs-meta-keyword{color:#728e00}.hljs-meta{color:#434f54}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-function{color:#728e00}.hljs-number{color:#8a7b52}</style><h3 data-id="heading-0">æ•ˆæœå›¾</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/151c8057f4c64d61b2505d76f5d67e6a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSF_lm5vlj7bojYk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767234211&amp;x-signature=xG%2Frklxe%2FjX8GPrNZs1%2Fvh6xlAE%3D" alt="åŠ¨ç”».gif" loading="lazy"/></p>
<h3 data-id="heading-1">æ³¨å†Œ hiPrint</h3>
<p>åœ¨ main.ts ä¸­è¿›è¡Œæ³¨å†Œ</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { disAutoConnect, hiPrintPlugin } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/plugins/hiprint/index'</span>;

<span class="hljs-comment">// å…ˆä¸è¦è‡ªåŠ¨è¿æ¥æ‰“å°ç»„ä»¶ï¼Œè°ƒç”¨æ‰“å°å†å»è¿æ¥</span>
<span class="hljs-title function_">disAutoConnect</span>();

app.<span class="hljs-title function_">use</span>(hiPrintPlugin);
</code></pre>
<h3 data-id="heading-2">å®šä¹‰é…ç½®å­—æ®µ</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> baseMessage = {
    <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">title</span>: <span class="hljs-string">'åŸºæœ¬ä¿¡æ¯'</span>,
    <span class="hljs-attr">fields</span>: [
      { <span class="hljs-attr">label</span>: <span class="hljs-string">'æ‰“å°ç”¨æˆ·'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'printUser'</span> },
      { <span class="hljs-attr">label</span>: <span class="hljs-string">'æ‰“å°æ—¶é—´'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'printTime'</span> },
      { <span class="hljs-attr">label</span>: <span class="hljs-string">'åŒ…è£¹æ•°é‡'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'packageNum'</span> },
      { <span class="hljs-attr">label</span>: <span class="hljs-string">'SKU æ•°é‡'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'skuNum'</span> },
      { <span class="hljs-attr">label</span>: <span class="hljs-string">'è´§å“æ€»æ•°'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'stockGoodsNum'</span> },
      { <span class="hljs-attr">label</span>: <span class="hljs-string">'ä»“åº“'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'warehouseName'</span> },
    ],
};
</code></pre>
<h3 data-id="heading-3">å®šä¹‰æ¨¡æ¿æ•°æ®</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> orderTotal = {
    <span class="hljs-attr">printUser</span>: <span class="hljs-string">'æ‹£è´§å‘˜1'</span>,
    <span class="hljs-attr">printTime</span>: <span class="hljs-string">'2025-01-01 18:00:00'</span>,
    <span class="hljs-attr">packageNum</span>: <span class="hljs-string">'2'</span>,
    <span class="hljs-attr">skuNum</span>: <span class="hljs-string">'3'</span>,
    <span class="hljs-attr">stockGoodsNum</span>: <span class="hljs-string">'6'</span>,
    <span class="hljs-attr">warehouseName</span>: <span class="hljs-string">'è´§ä»£æ·±åœ³ä»“'</span>,
};
</code></pre>
<h3 data-id="heading-4">å®šä¹‰æ¸²æŸ“æ¨¡æ¿</h3>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- RenderPickTemplate --&gt;
&lt;template&gt;
  &lt;div&gt;
     &lt;!-- æ ¹æ®ä¼ å…¥çš„æ•°æ®è¿›è¡Œæ¸²æŸ“ --&gt;  
  &lt;/div&gt;
&lt;/template&gt;
&lt;script lang="ts" setup&gt;
interface Field {
    label: string;
    value: string;
}
interface FieldList {
    id: number;
    title: string;
    fields: Field;
}
interface Props {
    fieldList: FieldList;
    selectedField: string[];
    data: {[key: string]: any };
}
    
const props = defineProps&lt;Props&gt;();
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-5">ä¸‹è½½å’Œæ‰“å°æ‹£è´§å•</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b551d701c601492bbfd1f798758b56b6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSF_lm5vlj7bojYk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767234211&amp;x-signature=wmnUeZANRV9CmXUg05Iwwb2XUZc%3D" alt="1.png" loading="lazy"/></p>
<p>åŸç†ï¼š</p>
<ul>
<li>ç¬¬ä¸€æ­¥éœ€è¦å°† vue ç»„ä»¶è½¬åŒ–æˆ HTMLã€‚<strong>è¿™ä¸€æ­¥æ˜¯å…³é”®</strong></li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { h, render } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">RenderPickTemplate</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./RenderPickTemplate.vue'</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">customFormatter</span> = (<span class="hljs-params">
  data: { [key: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">any</span> }, <span class="hljs-comment">// éœ€è¦æ‰“å°çš„æ•°æ®</span>
  selectedField: <span class="hljs-built_in">string</span>[], <span class="hljs-comment">// é€‰ä¸­çš„å­—æ®µ</span>
  fieldList: FieldList,   <span class="hljs-comment">// å®Œæ•´çš„å­—æ®µåˆ—è¡¨ </span>
</span>) =&gt; {
   <span class="hljs-keyword">const</span> container = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
   <span class="hljs-keyword">const</span> vnode = <span class="hljs-title function_">h</span>(<span class="hljs-title class_">RenderPickTemplate</span>, {
    data,
    selectedField,
    fieldList,
   });
   <span class="hljs-title function_">render</span>(vnode, container);
   <span class="hljs-keyword">const</span> html = container.<span class="hljs-property">firstElementChild</span>.<span class="hljs-property">innerHTML</span>;
   <span class="hljs-keyword">return</span> html;
}
</code></pre>
<ul>
<li>ç¬¬äºŒæ­¥ç”Ÿæˆ hiPrint æ”¯æŒçš„æ¸²æŸ“å¯¹è±¡</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">getTemplateRendFunc</span> = (<span class="hljs-params">html: <span class="hljs-built_in">string</span>, <span class="hljs-keyword">type</span>?: <span class="hljs-built_in">string</span></span>) =&gt; {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">sizeMap</span>: <span class="hljs-built_in">any</span> = {
    <span class="hljs-attr">A4</span>: {
      <span class="hljs-attr">width</span>: <span class="hljs-number">210</span>,
      <span class="hljs-attr">height</span>: <span class="hljs-number">296.6</span>,
      <span class="hljs-attr">printElementsWidth</span>: <span class="hljs-number">500</span>,
    },
  };

  <span class="hljs-keyword">let</span> size = {
    <span class="hljs-attr">width</span>: <span class="hljs-number">100</span>,
    <span class="hljs-attr">height</span>: <span class="hljs-number">150</span>,
    <span class="hljs-attr">printElementsWidth</span>: <span class="hljs-number">300</span>,
  };
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">type</span> &amp;&amp; sizeMap[<span class="hljs-keyword">type</span>]) {
    size = sizeMap[<span class="hljs-keyword">type</span>];
  }
    
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">panels</span>: [
      {
        <span class="hljs-attr">index</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">name</span>: <span class="hljs-number">1</span>,
        ...size,
        <span class="hljs-attr">printElements</span>: [
          {
            <span class="hljs-attr">options</span>: {
              <span class="hljs-attr">left</span>: <span class="hljs-number">0</span>,
              <span class="hljs-attr">top</span>: <span class="hljs-number">0</span>,
              <span class="hljs-attr">width</span>: size.<span class="hljs-property">printElementsWidth</span>,
              <span class="hljs-attr">options</span>: {
                html,
              },
              <span class="hljs-attr">formatter</span>: <span class="hljs-function">(<span class="hljs-params">title: <span class="hljs-built_in">string</span>, data: <span class="hljs-built_in">any</span>, customOptions: <span class="hljs-built_in">any</span></span>) =&gt;</span> {
                <span class="hljs-keyword">const</span> { options } = customOptions;
                <span class="hljs-comment">// å°† html ç»™åˆ° hiPrint è¿›è¡Œæ¸²æŸ“</span>
                <span class="hljs-keyword">return</span> options.<span class="hljs-property">html</span>;
              },
            },
            <span class="hljs-attr">printElementType</span>: {
              <span class="hljs-attr">type</span>: <span class="hljs-string">'longText'</span>,
            },
          },
        ],
      },
    ],
  }
}
</code></pre>
<ul>
<li>ç¬¬ä¸‰æ­¥å€ŸåŠ©æ‰“å°ç»„ä»¶å°†æ¸²æŸ“å¯¹è±¡æ‰“å°æˆ–ä¸‹è½½ä¸‹æ¥</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æ ¹æ®æ¨¡æ¿åˆ›å»º hiprint å®ä¾‹</span>
<span class="hljs-keyword">const</span> hiprintTemplate = <span class="hljs-keyword">new</span> hiprint.<span class="hljs-title class_">PrintTemplate</span>({
    <span class="hljs-attr">template</span>: json,
});

<span class="hljs-comment">// å¼€å§‹æ‰“å°</span>
hiprintTemplate.<span class="hljs-title function_">print2</span>(<span class="hljs-literal">null</span>, {
  <span class="hljs-attr">printer</span>: printer, <span class="hljs-comment">// printerï¼šè‹¥ä¸ºç©ºï¼Œåˆ™æ ¹æ®æ‰“å°ç»„ä»¶é…ç½®çš„æ‰“å°æœºè¿›è¡Œæ‰“å°</span>
});

 <span class="hljs-comment">// æˆåŠŸ</span>
hiprintTemplate.<span class="hljs-title function_">on</span>(<span class="hljs-string">'printSuccess'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-title function_">done</span>();
});

 <span class="hljs-comment">// å¤±è´¥</span>
hiprintTemplate.<span class="hljs-title function_">on</span>(<span class="hljs-string">'printError'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-title function_">done</span>();
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ‰“å°å¤±è´¥'</span>);
});
</code></pre>
<h3 data-id="heading-6">ä¼˜åŒ–ï¼šæ‰¹é‡æ‰“å°</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { hiprint } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/plugins/hiprint/index'</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">batchPrint</span> = (<span class="hljs-params">printDataList: <span class="hljs-built_in">Array</span>&lt;PrintData&gt;, printer?: <span class="hljs-built_in">string</span></span>) =&gt; {
  <span class="hljs-keyword">const</span> len = printDataList.<span class="hljs-property">length</span>;

  <span class="hljs-comment">// @ts-ignore</span>
  <span class="hljs-keyword">const</span> runner = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TaskRunner</span>();
  runner.<span class="hljs-title function_">setConcurrency</span>(<span class="hljs-number">1</span>); <span class="hljs-comment">// åŒæ—¶æ‰§è¡Œæ•°é‡</span>

  <span class="hljs-keyword">const</span> task = [];
  <span class="hljs-keyword">const</span> tasksKey = <span class="hljs-string">`open<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) {
    <span class="hljs-keyword">let</span> key = <span class="hljs-string">`task_<span class="hljs-subst">${i}</span>`</span>;
    <span class="hljs-keyword">const</span> printData = printDataList[i];

    task.<span class="hljs-title function_">push</span>(<span class="hljs-function">(<span class="hljs-params">done: <span class="hljs-built_in">Function</span></span>) =&gt;</span> {
      <span class="hljs-title function_">realPrint</span>(runner, done, key, <span class="hljs-string">`<span class="hljs-subst">${i + <span class="hljs-number">1</span>}</span>`</span>, printData, tasksKey, printer);
    });
  }

  <span class="hljs-comment">// å¼€å§‹ä»»åŠ¡</span>
  runner.<span class="hljs-title function_">addMultiple</span>(task);
  runner.<span class="hljs-title function_">start</span>();
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">realPrint</span> = (<span class="hljs-params">runner: <span class="hljs-built_in">any</span>, done: <span class="hljs-built_in">Function</span>, key: <span class="hljs-built_in">string</span>, i: <span class="hljs-built_in">string</span>, printData: PrintData, tasksKey: <span class="hljs-built_in">string</span>, printer: <span class="hljs-built_in">string</span></span>) =&gt; {
  <span class="hljs-keyword">if</span> (printData.<span class="hljs-property">type</span> === <span class="hljs-string">'template'</span>) {
    <span class="hljs-comment">// æ ¹æ®æ¨¡æ¿åˆ›å»º hiprint å®ä¾‹</span>
    <span class="hljs-keyword">const</span> hiprintTemplate = <span class="hljs-keyword">new</span> hiprint.<span class="hljs-title class_">PrintTemplate</span>({
      <span class="hljs-attr">template</span>: printData.<span class="hljs-property">template</span>,
    });

    <span class="hljs-comment">// å¼€å§‹æ‰“å°</span>
    hiprintTemplate.<span class="hljs-title function_">print2</span>(printData.<span class="hljs-property">data</span>, {
      <span class="hljs-attr">printer</span>: printer
    });

    <span class="hljs-comment">// æˆåŠŸ</span>
    hiprintTemplate.<span class="hljs-title function_">on</span>(<span class="hljs-string">'printSuccess'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
      <span class="hljs-title function_">done</span>();
    });

    <span class="hljs-comment">// å¤±è´¥</span>
    hiprintTemplate.<span class="hljs-title function_">on</span>(<span class="hljs-string">'printError'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
      <span class="hljs-title function_">done</span>();
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ‰“å°å¤±è´¥'</span>);
    });
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (printData.<span class="hljs-property">type</span> === <span class="hljs-string">'online'</span>) {
    <span class="hljs-title function_">printOnlinePdf</span>(printData.<span class="hljs-property">online</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>, printer, <span class="hljs-function">(<span class="hljs-params">state: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
      <span class="hljs-title function_">done</span>();
      <span class="hljs-keyword">if</span> (state === <span class="hljs-string">'error'</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ‰“å°çº¿ä¸Š pdf å¤±è´¥'</span>);
      }
    });
  }
};

<span class="hljs-comment">// æ‰“å°çº¿ä¸Š PDF</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">printOnlinePdf</span> = (<span class="hljs-params">url: <span class="hljs-built_in">string</span>, printer?: <span class="hljs-built_in">string</span>, callback?: <span class="hljs-built_in">Function</span></span>) =&gt; {
  <span class="hljs-keyword">let</span> params = {
    <span class="hljs-attr">type</span>: <span class="hljs-string">'url_pdf'</span>,
    <span class="hljs-attr">templateId</span>: <span class="hljs-string">'online_pdf_1'</span>,
    <span class="hljs-attr">pdf_path</span>: url,
  }
  <span class="hljs-keyword">if</span> (printer) {
    params = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(params, {
      printer,
    })
  }

  hiprint.<span class="hljs-property">hiwebSocket</span>.<span class="hljs-title function_">send</span>(params);
  hiprint.<span class="hljs-property">hiwebSocket</span>.<span class="hljs-property">socket</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'success'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> callback === <span class="hljs-string">'function'</span>) {
      <span class="hljs-title function_">callback</span>(<span class="hljs-string">'success'</span>);
    }
  });
  hiprint.<span class="hljs-property">hiwebSocket</span>.<span class="hljs-property">socket</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> callback === <span class="hljs-string">'function'</span>) {
      <span class="hljs-title function_">callback</span>(<span class="hljs-string">'error'</span>);
    }
  });
};
</code></pre>
<p>ä½¿ç”¨</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">batchPrint</span>(
    [
      {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'template'</span>,
        <span class="hljs-attr">template</span>: json,
      },
    ],
    <span class="hljs-keyword">type</span> === <span class="hljs-string">'download'</span> ? <span class="hljs-string">'Microsoft Print to PDF'</span> : <span class="hljs-string">''</span>,
);
</code></pre>
<h3 data-id="heading-7">æ‰©å±•ï¼šç›´æ¥æ‹–æ‹½ç»„ä»¶å®ç°æ‰“å°ä¸‹è½½</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d58fa1733e0d43ea9430081ab3a0d490~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSF_lm5vlj7bojYk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767234211&amp;x-signature=2LYveQpI97uYSWeit%2B56opO1dX4%3D" alt="åŠ¨ç”»1.gif" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6bad2a13600849ef965b5664fdce54ae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSF_lm5vlj7bojYk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767234211&amp;x-signature=0ujc%2FvlWrLZThL3MWGlkOI6rtEY%3D" alt="12.png" loading="lazy"/></p>
<p>è¯¥éƒ¨åˆ†å†…å®¹ç¯‡å¹…æ¯”è¾ƒå¤§ï¼Œåç»­ä¼šé‡æ–°å‡ºä¸€ç¯‡æ–‡ç« ã€‚ã€‚ã€‚ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[shadcn-ui çš„ Radix Dialog è¿™ä¸¤ä¸ªè­¦å‘Šåˆ°åº•åœ¨è¯´ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¼šæŠ¥ï¼Ÿæ€ä¹ˆä¿®ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7587998744294047750</link>    <guid>https://juejin.cn/post/7587998744294047750</guid>    <pubDate>2025-12-26T08:44:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587998744294047750" data-draft-id="7587825267879182377" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="shadcn-ui çš„ Radix Dialog è¿™ä¸¤ä¸ªè­¦å‘Šåˆ°åº•åœ¨è¯´ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¼šæŠ¥ï¼Ÿæ€ä¹ˆä¿®ï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,WeUI,React.js"/> <meta itemprop="datePublished" content="2025-12-26T08:44:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¨å¤œå¯»æ™´å¤©"/> <meta itemprop="url" content="https://juejin.cn/user/1943592288391496"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            shadcn-ui çš„ Radix Dialog è¿™ä¸¤ä¸ªè­¦å‘Šåˆ°åº•åœ¨è¯´ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¼šæŠ¥ï¼Ÿæ€ä¹ˆä¿®ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1943592288391496/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¨å¤œå¯»æ™´å¤©
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T08:44:52.000Z" title="Fri Dec 26 2025 08:44:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">é—®é¢˜</h2>
<p>æœ€è¿‘åœ¨é¡¹ç›®é‡Œé‡åˆ°ä¸¤ä¸ªæ¥è‡ª Radix Dialog çš„æ§åˆ¶å°æç¤ºï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6e5a30b959ff477987d91cbb78c449e3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5aSc5a-75pm05aSp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767343491&amp;x-signature=d1n2YG8uQeurasELGsmVhqqQi6k%3D" alt="image.png" loading="lazy"/></p>
<p>å®ƒä»¬ä¸æ˜¯ â€œåŠŸèƒ½é”™è¯¯â€ï¼Œä½†å±äº <strong>æ— éšœç¢ï¼ˆa11yï¼‰çº§åˆ«çš„è­¦å‘Š</strong>ï¼šRadix åœ¨å¼€å‘ç¯å¢ƒä¸»åŠ¨æé†’ä½ å¯¹è¯æ¡†ç¼ºå°‘ â€œå¯è¢«å±å¹•é˜…è¯»å™¨æ­£ç¡®ç†è§£â€ çš„å…³é”®è¯­ä¹‰ã€‚</p>
<p>æœ¬æ–‡åŸºäº coco-appï¼ˆReact 18 + TS + Tailwind + shadcn-uiï¼‰é‡ŒçœŸå®è¸©å‘çš„ä¿®å¤è¿‡ç¨‹æ€»ç»“ã€‚</p>
<hr/>
<h2 data-id="heading-1">1. èƒŒæ™¯ï¼šRadix Dialog éœ€è¦ä»€ä¹ˆè¯­ä¹‰ï¼Ÿ</h2>
<p>ä¸€ä¸ªå¯è®¿é—®çš„ Dialog è‡³å°‘éœ€è¦ï¼š</p>
<ul>
<li><strong>å¯è®¿é—®åç§°ï¼ˆaccessible nameï¼‰</strong>ï¼šå‘Šè¯‰è¯»å±è½¯ä»¶ â€œè¿™ä¸ªå¼¹çª—å«å•¥â€
<ul>
<li>å¯¹åº”ï¼š<code>&lt;DialogTitle /&gt;</code>ï¼ˆå†…éƒ¨æ˜ å°„åˆ° <code>aria-labelledby</code>ï¼‰</li>
</ul>
</li>
<li><strong>å¯è®¿é—®æè¿°ï¼ˆaccessible descriptionï¼‰</strong>ï¼šå‘Šè¯‰è¯»å±è½¯ä»¶ â€œè¿™ä¸ªå¼¹çª—åœ¨è¯´å•¥/è¦ç”¨æˆ·åšå•¥â€
<ul>
<li>å¯¹åº”ï¼š<code>&lt;DialogDescription /&gt;</code>ï¼ˆå†…éƒ¨æ˜ å°„åˆ° <code>aria-describedby</code>ï¼‰</li>
</ul>
</li>
</ul>
<p>Radix çš„ç¤ºä¾‹ç»“æ„ä¹Ÿæ˜¯è¿™ä¸ªé¡ºåºï¼ˆTitle + Description + å†…å®¹ + Close ç­‰ï¼‰ã€‚</p>
<hr/>
<h2 data-id="heading-2">2. æŠ¥é”™ 1ï¼šä¸ºä»€ä¹ˆå¿…é¡»è¦ <code>DialogTitle</code>ï¼Ÿ</h2>
<h3 data-id="heading-3">2.1 æŠ¥é”™å«ä¹‰</h3>
<blockquote>
<p><code>DialogContent requires a DialogTitle...</code></p>
</blockquote>
<p>æ„æ€æ˜¯ï¼šä½ çš„ <code>&lt;DialogContent /&gt;</code> é‡Œæ²¡æœ‰æä¾›æ ‡é¢˜ï¼Œå¯¼è‡´ Dialog æ²¡æœ‰å¯è®¿é—®åç§°ã€‚è¯»å±ç”¨æˆ·æ‰“å¼€å¼¹çª—æ—¶ï¼Œä¸çŸ¥é“è¿™æ˜¯ â€œæ›´æ–°æç¤ºâ€ è¿˜æ˜¯ â€œåˆ é™¤ç¡®è®¤â€ã€‚</p>
<h3 data-id="heading-4">2.2 coco-app çš„ä¿®å¤æ–¹å¼</h3>
<p>æˆ‘ä»¬åœ¨ <code>UpdateApp</code> å¼¹çª—ä¸­å¢åŠ äº†ä¸€ä¸ª â€œå¯¹è§†è§‰éšè—ã€å¯¹è¯»å±å¯è§â€ çš„æ ‡é¢˜ï¼š</p>
<ul>
<li>æ–‡ä»¶ï¼š<code>src/components/UpdateApp/index.tsx:164</code></li>
<li>ä»£ç å½¢æ€ï¼š</li>
</ul>
<pre><code class="hljs language-tsx" lang="tsx">&lt;<span class="hljs-title class_">DialogTitle</span> className=<span class="hljs-string">"sr-only"</span>&gt;{<span class="hljs-title function_">t</span>(<span class="hljs-string">"update.title"</span>)}&lt;/<span class="hljs-title class_">DialogTitle</span>&gt;
</code></pre>
<p>ä¸ºä»€ä¹ˆç”¨ <code>sr-only</code>ï¼Ÿ</p>
<ul>
<li>Tailwind çš„ <code>sr-only</code> èƒ½è¾¾åˆ°<strong>UI ä¸å˜ï¼Œè¯»å±å¯è¯»</strong>çš„æ•ˆæœï¼ˆæœ‰äº› shadcn æ¨¡æ¿ä¼šæœ‰ç°æˆçš„ <code>VisuallyHidden</code> ç»„ä»¶ï¼‰ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-5">3. æŠ¥é”™ 2ï¼šä¸ºä»€ä¹ˆå¿…é¡»è¦ <code>DialogDescription</code> / <code>aria-describedby</code>ï¼Ÿ</h2>
<h3 data-id="heading-6">3.1 æŠ¥é”™å«ä¹‰</h3>
<blockquote>
<p><code>Warning: Missing Description or aria-describedby={undefined} for {DialogContent}.</code></p>
</blockquote>
<p>æ„æ€æ˜¯ï¼šDialog æ²¡æœ‰å¯è®¿é—®æè¿°ï¼Œæˆ–è€…ä½ æ˜¾å¼æŠŠ <code>aria-describedby</code> ç½®ä¸º <code>undefined</code> ä½†åˆæ²¡æœ‰æè¿°èŠ‚ç‚¹å…³è”ä¸Šã€‚</p>
<p>Radix çš„é€»è¾‘å¤§è‡´æ˜¯ï¼š</p>
<ul>
<li>ä½ æä¾› <code>&lt;DialogDescription /&gt;</code>ï¼šRadix è‡ªåŠ¨æŠŠå®ƒçš„ id ç»‘å®šåˆ° <code>aria-describedby</code></li>
<li>ä½ ä¸æä¾› <code>&lt;DialogDescription /&gt;</code>ï¼šRadix ä¼šæé†’ä½  â€œç¼ºæè¿°â€ï¼Œé¿å…è¯»å±ç”¨æˆ·åªå¬åˆ°æ ‡é¢˜ä½†ä¸çŸ¥é“è¦åšä»€ä¹ˆ</li>
</ul>
<h3 data-id="heading-7">3.2 coco-app çš„ä¿®å¤æ–¹å¼</h3>
<p>æˆ‘ä»¬æŠŠåŸå…ˆå±•ç¤ºæ›´æ–°è¯´æ˜çš„ <code>div</code> æ›¿æ¢ä¸º <code>DialogDescription</code>ï¼ˆUI class ä¸å˜ï¼Œåªæ¢ç»„ä»¶è¯­ä¹‰ï¼‰ï¼š</p>
<ul>
<li>æ–‡ä»¶ï¼š<code>src/components/UpdateApp/index.tsx:179-193</code></li>
<li>ä»£ç å½¢æ€ï¼š</li>
</ul>
<pre><code class="hljs language-tsx" lang="tsx">&lt;<span class="hljs-title class_">DialogDescription</span> className=<span class="hljs-string">"text-sm leading-5 py-2 text-foreground text-center"</span>&gt;
  {updateInfo ? ... : <span class="hljs-title function_">t</span>(<span class="hljs-string">"update.date"</span>)}
&lt;/<span class="hljs-title class_">DialogDescription</span>&gt;
</code></pre>
<p>è¿™æ · Radix å°±èƒ½è‡ªåŠ¨ç”Ÿæˆæ­£ç¡®çš„ <code>aria-describedby</code>ï¼Œwarning æ¶ˆå¤±ã€‚</p>
<hr/>
<h2 data-id="heading-8">4. â€œæ´ç™–â€ï¼šå®ƒä¸æ˜¯ bugï¼Œä½†æ˜¯å°±æ˜¯åœ¨æ§åˆ¶å°æŠ¥çº¢äº†...</h2>
<p>shadcn-ui çš„ <code>Dialog</code> æœ¬è´¨æ˜¯å¯¹ Radix Dialog çš„ä¸€å±‚è½»å°è£…ï¼ˆé¡¹ç›®é‡Œå¯¹åº” <code>src/components/ui/dialog.tsx</code>ï¼‰ï¼Œå®ƒä¸ä¼šå¼ºåˆ¶ä½ å¿…é¡»å†™ Title/Descriptionã€‚</p>
<h3 data-id="heading-9">4.1 ä¸ºä»€ä¹ˆæ›´å®¹æ˜“è¸©å‘ï¼Ÿ</h3>
<p>å› ä¸º UI ä¸Šä½ å¯èƒ½è§‰å¾—ï¼š</p>
<ul>
<li>æˆ‘å·²ç»æœ‰å›¾æ ‡ï¼ˆlogoï¼‰</li>
<li>æˆ‘å·²ç»æœ‰ä¸€æ®µè¯´æ˜æ–‡å­—ï¼ˆdiv/pï¼‰</li>
<li>æˆ‘ä¸æƒ³æ˜¾ç¤ºæ ‡é¢˜</li>
</ul>
<p>ä½† <strong>è§†è§‰ä¸Šæ»¡è¶³ â‰  è¯­ä¹‰ä¸Šæ»¡è¶³</strong>ã€‚è¯»å±ä¾èµ–çš„æ˜¯ <code>aria-labelledby/aria-describedby</code> çš„å…³è”ï¼Œè€Œä¸æ˜¯ä½ é¡µé¢é‡Œæœ‰æ²¡æœ‰ä¸€ä¸ªçœ‹èµ·æ¥åƒæ ‡é¢˜çš„ <code>div</code>ã€‚</p>
<hr/>
<h2 data-id="heading-10">5. æœ€æ¨èçš„å†™æ³•ã€æ›´æ ‡å‡†çš„å†™æ³•</h2>
<h3 data-id="heading-11">5.1 æ ‡é¢˜ä¸æƒ³æ˜¾ç¤ºï¼šç”¨ <code>sr-only</code></h3>
<pre><code class="hljs language-tsx" lang="tsx">&lt;<span class="hljs-title class_">DialogTitle</span> className=<span class="hljs-string">"sr-only"</span>&gt;{<span class="hljs-title function_">t</span>(<span class="hljs-string">"xxx.title"</span>)}&lt;/<span class="hljs-title class_">DialogTitle</span>&gt;
</code></pre>
<h3 data-id="heading-12">5.2 æè¿°å­˜åœ¨ï¼šç”¨ <code>DialogDescription</code></h3>
<pre><code class="hljs language-tsx" lang="tsx">&lt;<span class="hljs-title class_">DialogDescription</span> className=<span class="hljs-string">"sr-only"</span>&gt;
  {<span class="hljs-title function_">t</span>(<span class="hljs-string">"xxx.description"</span>)}
&lt;/<span class="hljs-title class_">DialogDescription</span>&gt;
</code></pre>
<p>æ˜¯å¦ä¸€å®šè¦éšè— Descriptionï¼Ÿ</p>
<ul>
<li>ä¸ä¸€å®šã€‚åƒæ›´æ–°å¼¹çª—è¿™ç§ â€œæ­£æ–‡å°±æ˜¯æè¿°â€ï¼Œç›´æ¥ç”¨ <code>DialogDescription</code> åŒ…ä½æ­£æ–‡æœ€è‡ªç„¶ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-13">6. ä¹Ÿå¯ä»¥æ‰‹åŠ¨ <code>aria-describedby</code> å—ï¼Ÿå¯ä»¥ï¼Œä½†æ›´å®¹æ˜“å‡ºé”™</h2>
<p>ä½ å½“ç„¶å¯ä»¥è‡ªå·±å†™ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx">&lt;<span class="hljs-title class_">DialogContent</span> aria-describedby=<span class="hljs-string">"my-desc"</span>&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"my-desc"</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/<span class="hljs-title class_">DialogContent</span>&gt;
</code></pre>
<p>ä½†å‘åœ¨äºï¼š</p>
<ul>
<li>id å¯èƒ½å¿˜äº†å†™ / é‡å¤</li>
<li>æ¡ä»¶æ¸²æŸ“å¯¼è‡´èŠ‚ç‚¹ä¸åœ¨ DOMï¼ˆaria æŒ‡å‘ä¸å­˜åœ¨çš„ idï¼‰</li>
<li>é‡æ„æ—¶åˆ æ‰äº† <code>id</code> æ²¡å‘ç°</li>
<li>å¤šå¼¹çª—å¤ç”¨ç»„ä»¶æ—¶ id å†²çª</li>
</ul>
<p>æ‰€ä»¥åœ¨ shadcn/Radix ä½“ç³»é‡Œï¼Œä¼˜å…ˆä½¿ç”¨ <code>DialogTitle</code> / <code>DialogDescription</code> è®© Radix è´Ÿè´£å…³è”æ›´ç¨³ã€‚</p>
<hr/>
<h2 data-id="heading-14">7. çœŸæ­£çš„â€œå‘ç‚¹æ¸…å•â€ï¼ˆå»ºè®®ä»¥å review çš„æ—¶å€™å¯¹ç…§ï¼‰</h2>
<ul>
<li>åªå†™äº† <code>&lt;DialogContent /&gt;</code>ï¼ŒæŠŠæ ‡é¢˜/æ­£æ–‡éƒ½å¡è¿›æ™®é€š <code>div</code></li>
<li>æ ‡é¢˜ç”¨è§†è§‰å…ƒç´ è¡¨è¾¾ï¼ˆæ¯”å¦‚ logo æˆ–å¤§å·æ–‡æœ¬ï¼‰ï¼Œä½†æ²¡ç”¨ <code>DialogTitle</code></li>
<li>æè¿°æ˜¯æ¡ä»¶æ¸²æŸ“çš„ï¼Œå¯¼è‡´æœ‰æ—¶æ²¡æœ‰ <code>DialogDescription</code></li>
<li>æƒ³éšè—æ ‡é¢˜å´ç›´æ¥ä¸å†™ï¼ˆåº”è¯¥éšè—è€Œä¸æ˜¯åˆ é™¤ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-15">8. coco-app é‡Œçš„è½åœ°å®è·µï¼ˆæœ€ç»ˆç»“è®ºï¼‰</h2>
<p>åœ¨ coco-app é‡Œï¼Œæˆ‘ä»¬æœ€ç»ˆéµå¾ªäº†ä¸€ä¸ªç®€å•è§„åˆ™ï¼š</p>
<ul>
<li>æ¯ä¸ª <code>DialogContent</code> å†…éƒ¨éƒ½åº”è¯¥æœ‰ä¸”åªæœ‰ä¸€ä¸ªè¯­ä¹‰æ ‡é¢˜ï¼š<code>DialogTitle</code></li>
<li>åªè¦å¼¹çª—æœ‰ â€œè¯´æ˜æ€§æ–‡æœ¬â€ï¼Œä¼˜å…ˆç”¨ <code>DialogDescription</code> æ‰¿è½½</li>
<li>å¦‚æœ UI ä¸éœ€è¦å±•ç¤ºæ ‡é¢˜/æè¿°ï¼šç”¨ <code>sr-only</code> éšè—ï¼ˆè€Œä¸æ˜¯ä¸å†™ï¼‰</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3ä¸­v-ifä¸v-forä¸ºä½•ä¸èƒ½åœ¨åŒä¸€å…ƒç´ ä¸Šæ··ç”¨ï¼Ÿä¼˜å…ˆçº§è§„åˆ™ä¸æ”¹è¿›æ–¹æ¡ˆæ˜¯ä»€ä¹ˆï¼Ÿ]]></title>    <link>https://juejin.cn/post/7587903505135353906</link>    <guid>https://juejin.cn/post/7587903505135353906</guid>    <pubDate>2025-12-26T08:25:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587903505135353906" data-draft-id="7587965800272281626" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3ä¸­v-ifä¸v-forä¸ºä½•ä¸èƒ½åœ¨åŒä¸€å…ƒç´ ä¸Šæ··ç”¨ï¼Ÿä¼˜å…ˆçº§è§„åˆ™ä¸æ”¹è¿›æ–¹æ¡ˆæ˜¯ä»€ä¹ˆï¼Ÿ    "/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,Vue.js"/> <meta itemprop="datePublished" content="2025-12-26T08:25:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="kknone"/> <meta itemprop="url" content="https://juejin.cn/user/1366025597879930"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3ä¸­v-ifä¸v-forä¸ºä½•ä¸èƒ½åœ¨åŒä¸€å…ƒç´ ä¸Šæ··ç”¨ï¼Ÿä¼˜å…ˆçº§è§„åˆ™ä¸æ”¹è¿›æ–¹æ¡ˆæ˜¯ä»€ä¹ˆï¼Ÿ    
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1366025597879930/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    kknone
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T08:25:22.000Z" title="Fri Dec 26 2025 08:25:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">v-if ä¸ v-for çš„åŸºç¡€è®¤çŸ¥</h2>
<p>åœ¨Vue3çš„æ—¥å¸¸å¼€å‘ä¸­ï¼Œ<strong>v-if</strong>å’Œ<strong>v-for</strong>æ˜¯æœ€å¸¸ç”¨çš„ä¸¤ä¸ªæŒ‡ä»¤ï¼šå‰è€…æ˜¯â€œæ¡ä»¶æ¸²æŸ“çš„å¼€å…³â€ï¼Œå†³å®šå…ƒç´ æ˜¯å¦å‡ºç°åœ¨DOMä¸­ï¼›åè€…æ˜¯â€œåˆ—è¡¨æ¸²æŸ“çš„å·¥å…·â€ï¼Œè´Ÿè´£å¾ªç¯ç”Ÿæˆé‡å¤çš„å…ƒç´ ã€‚</p>
<h3 data-id="heading-1">v-ifï¼šæ§åˆ¶æ¸²æŸ“çš„â€œå¼€å…³â€</h3>
<p><code>v-if</code>é€šè¿‡è¡¨è¾¾å¼çš„çœŸå‡æ¥åˆ‡æ¢å…ƒç´ çš„æ¸²æŸ“çŠ¶æ€ã€‚æ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;!-- å½“ showTitle ä¸º true æ—¶æ˜¾ç¤ºæ ‡é¢˜ --&gt;
  &lt;h1 v-if="showTitle"&gt;Vue3 æ¡ä»¶æ¸²æŸ“æŒ‡å—&lt;/h1&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref } from 'vue'
const showTitle = ref(true) // æ§åˆ¶æ ‡é¢˜æ˜¾ç¤º
&lt;/script&gt;
</code></pre>
<p>å½“<code>showTitle</code>ä¸º<code>false</code>æ—¶ï¼Œ<code>&lt;h1&gt;</code>ä¸ä¼šè¢«æ¸²æŸ“åˆ°DOMä¸­â€”â€”è¿™æ˜¯â€œçœŸæ­£çš„æ¡ä»¶æ¸²æŸ“â€ï¼Œä¼šé”€æ¯/é‡å»ºå…ƒç´ åŠå†…éƒ¨çš„äº‹ä»¶ç›‘å¬ã€å­ç»„ä»¶ã€‚</p>
<h3 data-id="heading-2">v-forï¼šå¾ªç¯åˆ—è¡¨çš„â€œæ‰“å°æœºâ€</h3>
<p><code>v-for</code>ç”¨äºéå†æ•°ç»„æˆ–å¯¹è±¡ï¼Œç”Ÿæˆé‡å¤çš„å…ƒç´ ã€‚æ¯”å¦‚å¾ªç¯æ¸²æŸ“å¾…åŠåˆ—è¡¨ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;ul&gt;
    &lt;!-- å¾ªç¯ todos æ•°ç»„ï¼Œæ¯ä¸ªé¡¹ç”Ÿæˆä¸€ä¸ª &lt;li&gt; --&gt;
    &lt;li v-for="todo in todos" :key="todo.id"&gt;
      {{ todo.text }}
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref } from 'vue'
const todos = ref([
  { id: 1, text: 'å†™åšå®¢' },
  { id: 2, text: 'æ”¹bug' }
])
&lt;/script&gt;
</code></pre>
<p>è¿™é‡Œè¦æ³¨æ„<strong>å¿…é¡»åŠ <code>key</code>å±æ€§</strong>â€”â€”Vueé€šè¿‡<code>key</code>è¯†åˆ«åˆ—è¡¨é¡¹çš„å”¯ä¸€æ€§ï¼Œé¿å…é‡æ–°æ¸²æŸ“æ—¶çš„æ€§èƒ½é—®é¢˜ã€‚</p>
<h2 data-id="heading-3">v-if ä¸ v-for ç»“åˆçš„éšå¼ä¼˜å…ˆçº§é™·é˜±</h2>
<p>å½“æˆ‘ä»¬éœ€è¦â€œåªæ˜¾ç¤ºåˆ—è¡¨ä¸­æ»¡è¶³æ¡ä»¶çš„é¡¹â€æ—¶ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°æŠŠ<code>v-if</code>å’Œ<code>v-for</code>å†™åœ¨åŒä¸€ä¸ªå…ƒç´ ä¸Šã€‚ä½†Vue3çš„<strong>ä¼˜å…ˆçº§è§„åˆ™</strong>ä¼šåœ¨è¿™é‡Œè®¾ä¸‹â€œé™·é˜±â€ã€‚</p>
<h3 data-id="heading-4">ä¼˜å…ˆçº§è§„åˆ™ï¼šVue3 ä¸­ v-if å…ˆäº v-for</h3>
<p>Vueå®˜æ–¹æ˜ç¡®è¯´æ˜ï¼š<strong>åœ¨Vue3ä¸­ï¼Œ<code>v-if</code>çš„ä¼˜å…ˆçº§é«˜äº<code>v-for</code></strong>ã€‚å½“ä¸¤è€…å†™åœ¨åŒä¸€ä¸ªå…ƒç´ ä¸Šæ—¶ï¼Œ<code>v-if</code>ä¼šå…ˆè¢«è¯„ä¼°ï¼Œå†æ‰§è¡Œ<code>v-for</code>ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬è¦æ˜¾ç¤ºâ€œå·²å®Œæˆçš„å¾…åŠé¡¹â€ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;ul&gt;
    &lt;!-- é”™è¯¯å†™æ³•ï¼šåŒå…ƒç´ æ··ç”¨ v-if å’Œ v-for --&gt;
    &lt;li v-for="todo in todos" v-if="todo.done"&gt;
      {{ todo.text }}
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/template&gt;
</code></pre>
<p>åœ¨Vue3ä¸­ï¼Œè¿™æ®µä»£ç çš„æ‰§è¡Œé€»è¾‘æ˜¯ï¼š<strong>å…ˆåˆ¤æ–­æ¯ä¸ª<code>todo</code>çš„<code>done</code>å±æ€§æ˜¯å¦ä¸º<code>true</code>ï¼Œå†æ¸²æŸ“è¿™ä¸ª<code>li</code></strong>ã€‚è™½ç„¶åŠŸèƒ½èƒ½å®ç°ï¼Œä½†è—ç€ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li><strong>æ€§èƒ½é—®é¢˜</strong>ï¼šæ¯ä¸ªå¾…åŠé¡¹éƒ½è¦æ‰§è¡Œä¸€æ¬¡<code>v-if</code>åˆ¤æ–­ï¼Œå½“åˆ—è¡¨å¾ˆå¤§æ—¶ï¼Œæ¸²æŸ“é€Ÿåº¦ä¼šå˜æ…¢ï¼›</li>
<li><strong>é€»è¾‘æ··ä¹±</strong>ï¼šæ¨¡æ¿æ··åˆäº†â€œæ•°æ®è¿‡æ»¤â€å’Œâ€œåˆ—è¡¨æ¸²æŸ“â€çš„é€»è¾‘ï¼Œå¯è¯»æ€§å·®ï¼Œå®¹æ˜“åŸ‹bugã€‚</li>
</ol>
<h3 data-id="heading-5">ä¸ºä»€ä¹ˆä¼˜å…ˆçº§ä¼šå¯¼è‡´é—®é¢˜ï¼Ÿ</h3>
<p>å†ä¸¾ä¸ªæç«¯ä¾‹å­ï¼šå¦‚æœ<code>v-if</code>çš„æ¡ä»¶ä¸ä¾èµ–å¾ªç¯é¡¹ï¼Œæ¯”å¦‚<code>v-if="showTodos"</code>ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;ul&gt;
    &lt;li v-for="todo in todos" v-if="showTodos"&gt;
      {{ todo.text }}
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/template&gt;
</code></pre>
<p>è¿™æ—¶Vue3ä¼šå…ˆåˆ¤æ–­<code>showTodos</code>æ˜¯å¦ä¸º<code>true</code>ï¼Œå†æ‰§è¡Œ<code>v-for</code>å¾ªç¯ã€‚é€»è¾‘ä¸Šæ²¡é—®é¢˜ï¼Œä½†<strong>æ¨¡æ¿ä¸å¤Ÿæ¸…æ™°</strong>â€”â€”è¯»è€…ä¼šç–‘æƒ‘â€œ<code>v-if</code>åˆ°åº•æ§åˆ¶çš„æ˜¯æ•´ä¸ªåˆ—è¡¨è¿˜æ˜¯å•ä¸ªé¡¹ï¼Ÿâ€ã€‚</p>
<h2 data-id="heading-6">ä¸æ¨èåŒå…ƒç´ ä½¿ç”¨çš„åŸå› ä¸æ”¹è¿›æ–¹æ¡ˆ</h2>
<p>æ—¢ç„¶åŒå…ƒç´ ä½¿ç”¨æœ‰é—®é¢˜ï¼Œé‚£æˆ‘ä»¬è¯¥æ€ä¹ˆæ­£ç¡®ç»“åˆ<code>v-if</code>å’Œ<code>v-for</code>ï¼Ÿæ ¸å¿ƒåŸåˆ™æ˜¯ï¼š<strong>å…ˆè¿‡æ»¤æ•°æ®ï¼Œå†å¾ªç¯æ¸²æŸ“</strong>ã€‚</p>
<h3 data-id="heading-7">ä¸æ¨èåŒå…ƒç´ ä½¿ç”¨çš„æ ¸å¿ƒåŸå› </h3>
<details>
<summary>å¾€æœŸæ–‡ç« å½’æ¡£</summary>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F97c66a18ae0e9b57c6a69b8b3a41ddf6%2F" target="_blank" title="https://blog.cmdragon.cn/posts/97c66a18ae0e9b57c6a69b8b3a41ddf6/" ref="nofollow noopener noreferrer">Vue3ä¸­v-showå¦‚ä½•é€šè¿‡CSSä¿®æ”¹displayå±æ€§æ§åˆ¶æ¡ä»¶æ˜¾ç¤ºï¼Ÿä¸v-ifçš„åº”ç”¨åœºæ™¯è¯¥å¦‚ä½•åŒºåˆ†ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F8a1ddfac64b25062ac56403e4c1201d2%2F" target="_blank" title="https://blog.cmdragon.cn/posts/8a1ddfac64b25062ac56403e4c1201d2/" ref="nofollow noopener noreferrer">Vue3æ¡ä»¶æ¸²æŸ“ä¸­v-ifç³»åˆ—æŒ‡ä»¤å¦‚ä½•åˆç†ä½¿ç”¨ä¸è§„é¿é”™è¯¯ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F218c3a59282c3b757447ee08a01937bb%2F" target="_blank" title="https://blog.cmdragon.cn/posts/218c3a59282c3b757447ee08a01937bb/" ref="nofollow noopener noreferrer">Vue3åŠ¨æ€æ ·å¼æ§åˆ¶ï¼šrefã€reactiveã€watchä¸computedçš„åº”ç”¨åœºæ™¯ä¸åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F1bab953e41f66ac53de099fa9fe76483%2F" target="_blank" title="https://blog.cmdragon.cn/posts/1bab953e41f66ac53de099fa9fe76483/" ref="nofollow noopener noreferrer">Vue3ä¸­åŠ¨æ€æ ·å¼æ•°ç»„çš„åé¡¹è¦†ç›–è§„åˆ™å¦‚ä½•ä¸è®¡ç®—å±æ€§ç»“åˆå®ç°å¤æ‚çŠ¶æ€æ ·å¼ç®¡ç†ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc85e1fe16a7ae45e965b4e2df4d9d2f4%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c85e1fe16a7ae45e965b4e2df4d9d2f4/" ref="nofollow noopener noreferrer">Vueæµ…å“åº”å¼å¦‚ä½•è§£å†³æ·±å±‚å“åº”å¼çš„æ€§èƒ½é—®é¢˜ï¼Ÿé€‚ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbe04b02d2723994632de0d4ca22a3391%2F" target="_blank" title="https://blog.cmdragon.cn/posts/be04b02d2723994632de0d4ca22a3391/" ref="nofollow noopener noreferrer">Vue 3ç»„åˆå¼APIä¸­refä¸reactiveçš„æ ¸å¿ƒå“åº”å¼å·®å¼‚åŠä½¿ç”¨æœ€ä½³å®è·µæ˜¯ä»€ä¹ˆï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbe04b02d2723994632de0d4ca22a3391%2F" target="_blank" title="https://blog.cmdragon.cn/posts/be04b02d2723994632de0d4ca22a3391/" ref="nofollow noopener noreferrer">Vue 3ç»„åˆå¼APIä¸­refä¸reactiveçš„æ ¸å¿ƒå“åº”å¼å·®å¼‚åŠä½¿ç”¨æœ€ä½³å®è·µæ˜¯ä»€ä¹ˆï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fa0af08dd60a37b9a890a9957f2cbfc9f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/a0af08dd60a37b9a890a9957f2cbfc9f/" ref="nofollow noopener noreferrer">Vue3å“åº”å¼ç³»ç»Ÿä¸­ï¼Œå¯¹è±¡æ–°å¢å±æ€§ã€æ•°ç»„æ”¹ç´¢å¼•ã€åŸå§‹å€¼ä»£ç†çš„é—®é¢˜å¦‚ä½•è§£å†³ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbc287e1e36287afd90750fd907eca85e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/bc287e1e36287afd90750fd907eca85e/" ref="nofollow noopener noreferrer">Vue 3ä¸­watchä¾¦å¬å™¨çš„æ­£ç¡®ä½¿ç”¨å§¿åŠ¿ä½ æŒæ¡äº†å—ï¼Ÿæ·±åº¦ç›‘å¬ã€ä¸watchEffectçš„å·®å¼‚åŠå¸¸è§æŠ¥é”™è§£æ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F654b9447ef1ba7ec1126a1bc26a4726d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/654b9447ef1ba7ec1126a1bc26a4726d/" ref="nofollow noopener noreferrer">Vueå“åº”å¼å£°æ˜çš„APIå·®å¼‚ã€åº•å±‚åŸç†ä¸å¸¸è§é™·é˜±ä½ éƒ½ææ‡‚äº†å— - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F654b9447ef1ba7ec1126a1bc26a4726d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/654b9447ef1ba7ec1126a1bc26a4726d/" ref="nofollow noopener noreferrer">Vueå“åº”å¼å£°æ˜çš„APIå·®å¼‚ã€åº•å±‚åŸç†ä¸å¸¸è§é™·é˜±ä½ éƒ½ææ‡‚äº†å— - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc405a8d9950af5b7c63b56c348ac36b6%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c405a8d9950af5b7c63b56c348ac36b6/" ref="nofollow noopener noreferrer">ä¸ºä»€ä¹ˆVue 3éœ€è¦refå‡½æ•°ï¼Ÿå®ƒçš„å“åº”å¼åŸç†ä¸æ­£ç¡®ç”¨æ³•æ˜¯ä»€ä¹ˆï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fa7e9abb9691a81e4404d9facabe0f7c3%2F" target="_blank" title="https://blog.cmdragon.cn/posts/a7e9abb9691a81e4404d9facabe0f7c3/" ref="nofollow noopener noreferrer">Vue 3ä¸­reactiveå‡½æ•°å¦‚ä½•é€šè¿‡Proxyå®ç°å“åº”å¼ï¼Ÿä½¿ç”¨æ—¶è¦é¿å¼€å“ªäº›è¯¯åŒºï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbd995ea45161727597fb85b62566c43d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/bd995ea45161727597fb85b62566c43d/" ref="nofollow noopener noreferrer">Vue3å“åº”å¼ç³»ç»Ÿçš„åº•å±‚åŸç†ä¸å®è·µè¦ç‚¹ä½ çœŸçš„æ‡‚å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F53e3f270a80675df662c6857a3332c0f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/53e3f270a80675df662c6857a3332c0f/" ref="nofollow noopener noreferrer">Vue 3æ¨¡æ¿å¦‚ä½•é€šè¿‡ç¼–è¯‘ä¸‰é˜¶æ®µå®ç°ä»å£°æ˜å¼è¯­æ³•åˆ°é«˜æ•ˆæ¸²æŸ“çš„è·¨è¶Š - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fddbce4f2a23aa72c96b1c0473900321e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ddbce4f2a23aa72c96b1c0473900321e/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vueæ¨¡æ¿å¼•ç”¨ï¼šä»æ”¶DOMâ€œå¿«é€’â€åˆ°è°ƒå­ç»„ä»¶æ–¹æ³•ï¼Œä½ ç©æ˜ç™½äº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F23a2d5a334e15575277814c16e45df50%2F" target="_blank" title="https://blog.cmdragon.cn/posts/23a2d5a334e15575277814c16e45df50/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vueæ¨¡æ¿é‡Œçš„JSè¡¨è¾¾å¼æœ‰å•¥ä¸èƒ½ç¢°ï¼Ÿè®¡ç®—å±æ€§ä¸ºå•¥æ¯”æ–¹æ³•æ›´èƒ½æ‰“ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F6be38de6382e31d282659b689c5b17f0%2F" target="_blank" title="https://blog.cmdragon.cn/posts/6be38de6382e31d282659b689c5b17f0/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vueçš„v-modelè¡¨å•ç»‘å®šï¼šè¯­æ³•ç³–ã€åŠ¨æ€å€¼ã€ä¿®é¥°ç¬¦çš„å°æŠ€å·§ä½ éƒ½æŒæ¡äº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F60ce517684f4a418f453d66aa805606c%2F" target="_blank" title="https://blog.cmdragon.cn/posts/60ce517684f4a418f453d66aa805606c/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vue3äº‹ä»¶å¤„ç†çš„æŒ‘æˆ˜é¢˜ï¼šv-onã€ä¿®é¥°ç¬¦ã€è‡ªå®šä¹‰äº‹ä»¶ä½ èƒ½é€šå…³å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fe4ae7d5e4a9205bb11b2baccb230c637%2F" target="_blank" title="https://blog.cmdragon.cn/posts/e4ae7d5e4a9205bb11b2baccb230c637/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vue3çš„v-æŒ‡ä»¤ï¼šæ•°æ®å’ŒDOMçš„â€œç¿»è¯‘å®˜â€åˆ°åº•æœ‰å¤šå°‘æœ¬äº‹ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F999ce4fb32259ff4fbf4bf7bcb851654%2F" target="_blank" title="https://blog.cmdragon.cn/posts/999ce4fb32259ff4fbf4bf7bcb851654/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vue3ï¼Œæ’å€¼ã€åŠ¨æ€ç»‘å®šå’Œé¿å‘æŠ€å·§ä½ éƒ½ææ‡‚äº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fa6997d81b49cd232b87e1cf603888ad1%2F" target="_blank" title="https://blog.cmdragon.cn/posts/a6997d81b49cd232b87e1cf603888ad1/" ref="nofollow noopener noreferrer">æƒ³è®©PostgreSQLå¿«åˆ°é£èµ·ï¼Ÿå…ˆæ‰¾å¥åº·å¯†ç è¿˜æ˜¯å…ˆæ¢å¼•æ“ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F1fee7afbb9abd4540b8aa9c141d6845d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/1fee7afbb9abd4540b8aa9c141d6845d/" ref="nofollow noopener noreferrer">æƒ³è®©PostgreSQLæŸ¥è¯¢å¿«åˆ°é£èµ·ï¼Ÿåˆ†åŒºè¡¨ã€ç‰©åŒ–è§†å›¾ã€å¹¶è¡ŒæŸ¥è¯¢è¿™ä¸‰æ‹›çµä¸çµï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F79c590fbd87ece535b11a71c9667884f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/79c590fbd87ece535b11a71c9667884f/" ref="nofollow noopener noreferrer">å­æŸ¥è¯¢æ€»æ‹–æ…¢æŸ¥è¯¢ï¼ŸæŠŠå®ƒå˜æˆè¿æ¥å°±èƒ½è§£å†³ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F748cdac2536008199abf8a8a2cd0ec85%2F" target="_blank" title="https://blog.cmdragon.cn/posts/748cdac2536008199abf8a8a2cd0ec85/" ref="nofollow noopener noreferrer">PostgreSQLå…¨è¡¨æ‰«ææ…¢åˆ°å´©æºƒï¼Ÿå»ºç´¢å¼•+æ”¹æŸ¥è¯¢+æ›´ç»Ÿè®¡ä¿¡æ¯ä¸‰æ‹›èƒ½ç ´ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F32ca943703226d317d4276a8fb53b0dd%2F" target="_blank" title="https://blog.cmdragon.cn/posts/32ca943703226d317d4276a8fb53b0dd/" ref="nofollow noopener noreferrer">å¤æ‚æŸ¥è¯¢æ€»æ‹–åè…¿ï¼ŸPostgreSQLå¤šåˆ—ç´¢å¼•+è¦†ç›–ç´¢å¼•çš„ç¥ä»™æŠ€å·§ä½ getæ²¡ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fca93f1d53aa910e7ba5ffd8df611c12b%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ca93f1d53aa910e7ba5ffd8df611c12b/" ref="nofollow noopener noreferrer">åªç»™è¡¨å­é›†å»ºç´¢å¼•ï¼Ÿç”¨å‡½æ•°ç»“æœå»ºç´¢å¼•ï¼ŸPostgreSQLè¿™ä¿©æ“ä½œå‡­å•¥èƒ½çœç©ºé—´åˆåŠ é€Ÿï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Ff507856ebfddd592448813c510a53669%2F" target="_blank" title="https://blog.cmdragon.cn/posts/f507856ebfddd592448813c510a53669/" ref="nofollow noopener noreferrer">B-treeç´¢å¼•åƒå­—å…¸æŸ¥è¯ä¸€æ ·å·¥ä½œï¼Ÿé‚£å“ªäº›æ•°æ®åº“æŸ¥è¯¢å®ƒèƒ½åŠ é€Ÿï¼Œå“ªäº›ä¸èƒ½ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb2213bfcb5b88a862f2138404c03d596%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b2213bfcb5b88a862f2138404c03d596/" ref="nofollow noopener noreferrer">æƒ³æŠ“PostgreSQLé‡Œçš„æ…¢SQLï¼Ÿpg_stat_statementsåŸºç¡€é»‘åŒ£å­å’Œpg_stat_monitoræ—¶é—´çª—ï¼Œè°èƒ½å¸®ä½ æ›´å‡†æªå‡ºæ€§èƒ½å°å·ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F26614eb7da6c476dde41d367ad888d2f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/26614eb7da6c476dde41d367ad888d2f/" ref="nofollow noopener noreferrer">PostgreSQLçš„â€œæ—¶å…‰æœºâ€MVCCå’Œé”æœºåˆ¶æ˜¯æ€ä¹ˆæå®šé«˜å¹¶å‘çš„ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F69f99bc6972a860d559c74aad7280da4%2F" target="_blank" title="https://blog.cmdragon.cn/posts/69f99bc6972a860d559c74aad7280da4/" ref="nofollow noopener noreferrer">PostgreSQLæ€§èƒ½æš´æ¶¨çš„å…³é”®ï¼Ÿå†…å­˜IOå¹¶å‘å‚æ•°å±…ç„¶è¦è¿™ä¹ˆè®¾ç½®ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F7b7053f392147a8b3b1a16bebeb08d0a%2F" target="_blank" title="https://blog.cmdragon.cn/posts/7b7053f392147a8b3b1a16bebeb08d0a/" ref="nofollow noopener noreferrer">å¤§è¡¨æŸ¥è¯¢æ…¢åˆ°ç¿»éæ•´ä¸ªä¹¦æ¶ï¼ŸPostgreSQLåˆ†åŒºè¡¨æ•™ä½ æ€ä¹ˆâ€œåˆ†ç±»â€æ‰é«˜æ•ˆ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc856e3cb073822349f3bf2d29995dcfc%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c856e3cb073822349f3bf2d29995dcfc/" ref="nofollow noopener noreferrer">PostgreSQL æŸ¥è¯¢æ…¢ï¼Ÿæ˜¯ä¸æ˜¯å¿˜äº†ä¼˜åŒ– GROUP BYã€ORDER BY å’Œçª—å£å‡½æ•°ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc096347d18e67b7431faacd2c4757093%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c096347d18e67b7431faacd2c4757093/" ref="nofollow noopener noreferrer">PostgreSQLé‡Œçš„å­æŸ¥è¯¢å’ŒCTEå±…ç„¶åœ¨æ€§èƒ½ä¸Šâ€œææ¶â€ï¼Ÿåˆ°åº•è¯¥ç«™å“ªè¾¹ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F2eca89463454fd4250d7b66243b9fe5a%2F" target="_blank" title="https://blog.cmdragon.cn/posts/2eca89463454fd4250d7b66243b9fe5a/" ref="nofollow noopener noreferrer">PostgreSQLé€‰Joinç­–ç•¥æœ‰å•¥å°ä¹ä¹ï¼ŸNested Loop/Merge/Hashè°æ˜¯å®ƒçš„èœï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F068ecb772a87d7df20a8c9fb4b233f8e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/068ecb772a87d7df20a8c9fb4b233f8e/" ref="nofollow noopener noreferrer">PostgreSQLæ–°æ‰‹SQLæ€»ç¿»è½¦ï¼Ÿè¿™7ä¸ªæ€§èƒ½é™·é˜±ä½ è¸©è¿‡æ²¡ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fd498f63cd0a2d5a77e445c688a8b88db%2F" target="_blank" title="https://blog.cmdragon.cn/posts/d498f63cd0a2d5a77e445c688a8b88db/" ref="nofollow noopener noreferrer">PostgreSQLç´¢å¼•é€‰B-Treeè¿˜æ˜¯GiSTï¼Ÿâ€œç‘å£«å†›åˆ€â€å’Œâ€œå¤šé¢æ‰‹â€çš„å·®åˆ«ä½ å±…ç„¶è¿˜ä¸çŸ¥é“ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F9101b75bdec6faea9b35d54f14e37f36%2F" target="_blank" title="https://blog.cmdragon.cn/posts/9101b75bdec6faea9b35d54f14e37f36/" ref="nofollow noopener noreferrer">æƒ³çŸ¥é“æ•°æ®åº“æ€ä¹ˆç»™æŸ¥è¯¢â€œç®—æˆæœ¬é€‰è·¯çº¿â€ï¼ŸEXPLAINèƒ½å¸®ä½ çœ‹æ˜ç™½ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fd527f8ebb6e3dae2c7dfe4c8d8979444%2F" target="_blank" title="https://blog.cmdragon.cn/posts/d527f8ebb6e3dae2c7dfe4c8d8979444/" ref="nofollow noopener noreferrer">PostgreSQLå¤„ç†SQLå±…ç„¶åƒåšè›‹ç³•ï¼Ÿè§£æåˆ°æ‰§è¡Œçš„4æ­¥é‡Œè—ç€å¤šå°‘æŸ¥è¯¢ä¼˜åŒ–çš„å°å¿ƒæœºï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F6bfdae84f313cf7ad0bb7045c4392347%2F" target="_blank" title="https://blog.cmdragon.cn/posts/6bfdae84f313cf7ad0bb7045c4392347/" ref="nofollow noopener noreferrer">PostgreSQLå¤‡ä»½ä¸æ˜¯å¤åˆ¶æ–‡ä»¶ï¼Ÿç‰©ç†vsé€»è¾‘å’‹é€‰ï¼Ÿè¯¯åˆ è¿˜èƒ½ç²¾å‡†æ¢å¤åˆ°1åˆ†é’Ÿå‰ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fde3672803de34dbad244d0a8d48b0eb5%2F" target="_blank" title="https://blog.cmdragon.cn/posts/de3672803de34dbad244d0a8d48b0eb5/" ref="nofollow noopener noreferrer">è½¬è´¦ä¸ç¿»è½¦ã€å¹¶å‘ä¸å¹²æ‰°ï¼ŒPostgreSQLçš„ACIDç‰¹æ€§åˆ°åº•æœ‰å•¥é­”æ³•ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fe463e8a2668abdf00a228c9b79324ded%2F" target="_blank" title="https://blog.cmdragon.cn/posts/e463e8a2668abdf00a228c9b79324ded/" ref="nofollow noopener noreferrer">é“¶è¡Œè½¬è´¦ä¸ç™½æ‰£é’±ã€ç”µå•†ä¸‹å•ä¸è¶…å–ï¼ŒPostgreSQLäº‹åŠ¡çš„è¯€çªæ˜¯å•¥ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F5c967e595058c4a1fc4474a68e64031d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/5c967e595058c4a1fc4474a68e64031d/" ref="nofollow noopener noreferrer">PostgreSQLé‡Œçš„PL/pgSQLåˆ°åº•æ˜¯å•¥ï¼Ÿèƒ½è®©SQLä»â€œè¯´ç›®æ ‡â€å˜â€œè®²æ­¥éª¤â€ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F325047855e3e23b5ef82f7d2db134fbd%2F" target="_blank" title="https://blog.cmdragon.cn/posts/325047855e3e23b5ef82f7d2db134fbd/" ref="nofollow noopener noreferrer">PostgreSQLè§†å›¾ä¸å­˜æ•°æ®ï¼Ÿé‚£å®ƒæ€ä¹ˆç®€åŒ–æŸ¥è¯¢è¿˜èƒ½é€’å½’ç”Ÿæˆåºåˆ—å’Œæ§åˆ¶æƒé™ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fd2dba50bb6e4df7b27e735245a06a2a2%2F" target="_blank" title="https://blog.cmdragon.cn/posts/d2dba50bb6e4df7b27e735245a06a2a2/" ref="nofollow noopener noreferrer">PostgreSQLç´¢å¼•è¿™ä¹ˆç©ï¼Œæ‰èƒ½è®©ä½ çš„æŸ¥è¯¢çœŸçš„â€œé£â€èµ·æ¥ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F849ae5bab0f8c66e94c2f6ad1bb798e3%2F" target="_blank" title="https://blog.cmdragon.cn/posts/849ae5bab0f8c66e94c2f6ad1bb798e3/" ref="nofollow noopener noreferrer">PostgreSQLçš„è¡¨å…³ç³»å’Œçº¦æŸï¼Œå’‹å¸®ä½ æå®šç”¨æˆ·è®¢å•ä¸æ··ä¹±ã€å­¦ç”Ÿé€‰è¯¾ä¸é‡å¤ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fef4800975ffa84f1ca51976a70a1585b%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ef4800975ffa84f1ca51976a70a1585b/" ref="nofollow noopener noreferrer">PostgreSQLæŸ¥è¯¢çš„ç­›å­ã€æ’åºã€èšåˆã€åˆ†ç»„ï¼Ÿä½ ä¼šç”¨å®ƒä»¬æå®šæ•°æ®å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbf54711525c507c5eacfa7b0151c39d2%2F" target="_blank" title="https://blog.cmdragon.cn/posts/bf54711525c507c5eacfa7b0151c39d2/" ref="nofollow noopener noreferrer">PostgreSQLæ•°æ®ç±»å‹æ€ä¹ˆé€‰æ‰é«˜æ•ˆä¸è¸©å‘ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F887809b3e0375f5956873cd442f516d8%2F" target="_blank" title="https://blog.cmdragon.cn/posts/887809b3e0375f5956873cd442f516d8/" ref="nofollow noopener noreferrer">æƒ³è§£é”PostgreSQLæŸ¥è¯¢ä»åŸºç¡€åˆ°è¿›é˜¶çš„æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Ÿä½ éƒ½getäº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F934be1203725e8be9d6f6e9104e5abcc%2F" target="_blank" title="https://blog.cmdragon.cn/posts/934be1203725e8be9d6f6e9104e5abcc/" ref="nofollow noopener noreferrer">PostgreSQL DELETEå±…ç„¶æœ‰è¿™äº›æ“ä½œï¼Ÿè¿”å›æ•°æ®ã€è¿è¡¨åˆ ä½ è¯•è¿‡æ²¡ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F0f0622e9b7402b599e618150d0596ffe%2F" target="_blank" title="https://blog.cmdragon.cn/posts/0f0622e9b7402b599e618150d0596ffe/" ref="nofollow noopener noreferrer">PostgreSQL UPDATEè¯­å¥æ€ä¹ˆç©ï¼Ÿä»æ”¹é‚®ç®±åˆ°æ‰¹é‡æ›´æ–°çš„é¿å‘æŠ€å·§ä½ éƒ½ä¼šå—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F0e3bf7efc030b024ea67ee855a00f2de%2F" target="_blank" title="https://blog.cmdragon.cn/posts/0e3bf7efc030b024ea67ee855a00f2de/" ref="nofollow noopener noreferrer">PostgreSQLæ’å…¥æ•°æ®è¿˜åœ¨é€æ¡æ•²ï¼Ÿæ‰¹é‡ã€å†²çªå¤„ç†ã€è¿”å›è‡ªå¢IDçš„æŠ€å·§ä½ ä¼šå—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb6cd3c86da6aac26ed829e472d34078e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b6cd3c86da6aac26ed829e472d34078e/" ref="nofollow noopener noreferrer">PostgreSQLçš„â€œä»“åº“-æˆ¿é—´-è´§æ¶â€æ¸¸æˆï¼Œä½ èƒ½å»ºå‡ºç”µå•†æ•°æ®åº“å’Œè¡¨å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fba1f545a3410144552fbdbfcf31b5265%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ba1f545a3410144552fbdbfcf31b5265/" ref="nofollow noopener noreferrer">PostgreSQL 17å®‰è£…æ€»ç¿»è½¦ï¼ŸWindows/macOS/Linuxé¿å‘æŒ‡å—å¸®ä½ æå®šï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb5474d1480509c5072085abc80b3dd9f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b5474d1480509c5072085abc80b3dd9f/" ref="nofollow noopener noreferrer">èƒ½å½“å…³ç³»å‹æ•°æ®åº“è¿˜èƒ½ç©å¯¹è±¡ç‰¹æ€§ï¼Œèƒ½æ‹†å¤æ‚æŸ¥è¯¢è¿˜èƒ½è‡ªåŠ¨ç®¡åº“å­˜ï¼ŒPostgreSQLå‡­ä»€ä¹ˆè¿™ä¹ˆé¦™ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fcc098d8836e787baa8a4d92e4d56d5c5%2F" target="_blank" title="https://blog.cmdragon.cn/posts/cc098d8836e787baa8a4d92e4d56d5c5/" ref="nofollow noopener noreferrer">ç»™æ¥å£åŠ æ–°å­—æ®µåˆä¸æå´©è€å®¢æˆ·ç«¯ï¼ŸFastAPIçš„å¤šç‰ˆæœ¬APIé å“ªä¸‰æ‹›å®ç°ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F46d05151c5bd31cf37a7bcf0b8f5b0b8%2F" target="_blank" title="https://blog.cmdragon.cn/posts/46d05151c5bd31cf37a7bcf0b8f5b0b8/" ref="nofollow noopener noreferrer">æµé‡çªå¢è¦æå´©FastAPIï¼Ÿç†”æ–­æµ‹è¯•æ˜¯æ€ä¹ˆé˜²ç³»ç»Ÿé›ªå´©çš„ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F65ce343cc5df9faf3a8e2eeaab42ae45%2F" target="_blank" title="https://blog.cmdragon.cn/posts/65ce343cc5df9faf3a8e2eeaab42ae45/" ref="nofollow noopener noreferrer">FastAPIç§’æ€åº“å­˜æ€»å˜è´Ÿæ•°ï¼ŸRedisåˆ†å¸ƒå¼é”èƒ½å¸®ä½ å®ˆä½åº•çº¿å— - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Feed6cd8985d9be0a4b092a7da38b3e0c%2F" target="_blank" title="https://blog.cmdragon.cn/posts/eed6cd8985d9be0a4b092a7da38b3e0c/" ref="nofollow noopener noreferrer">FastAPIçš„CIæµæ°´çº¿æ€ä¹ˆè‡ªåŠ¨æµ‹ç«¯ç‚¹ï¼Œè¿˜èƒ½è®©AllureæŠ¥å‘Šç¾åˆ°çŠ¯è§„ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F6157d87338ce894d18c013c3c4777abb%2F" target="_blank" title="https://blog.cmdragon.cn/posts/6157d87338ce894d18c013c3c4777abb/" ref="nofollow noopener noreferrer">å¦‚ä½•ç”¨GitHub Actionsä¸ºFastAPIé¡¹ç›®æ‰“é€ è‡ªåŠ¨åŒ–æµ‹è¯•æµæ°´çº¿ï¼Ÿ - cmdragon's Blog</a></li>
</ul>
</details>
<details>
<summary>å…è´¹å¥½ç”¨çš„çƒ­é—¨åœ¨çº¿å·¥å…·</summary>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fraid-calculator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/raid-calculator" ref="nofollow noopener noreferrer">RAID è®¡ç®—å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fphotoshop-online" target="_blank" title="https://tools.cmdragon.cn/zh/apps/photoshop-online" ref="nofollow noopener noreferrer">åœ¨çº¿PS - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fmermaid-live-editor" target="_blank" title="https://tools.cmdragon.cn/zh/apps/mermaid-live-editor" ref="nofollow noopener noreferrer">Mermaid åœ¨çº¿ç¼–è¾‘å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fmath-solver-calculator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/math-solver-calculator" ref="nofollow noopener noreferrer">æ•°å­¦æ±‚è§£è®¡ç®—å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsmart-teleprompter" target="_blank" title="https://tools.cmdragon.cn/zh/apps/smart-teleprompter" ref="nofollow noopener noreferrer">æ™ºèƒ½æè¯å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fmagic-resume" target="_blank" title="https://tools.cmdragon.cn/zh/apps/magic-resume" ref="nofollow noopener noreferrer">é­”æ³•ç®€å† - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-puzzle-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-puzzle-tool" ref="nofollow noopener noreferrer">Image Puzzle Tool - å›¾ç‰‡æ‹¼å›¾å·¥å…· | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsubtitle-downloader" target="_blank" title="https://tools.cmdragon.cn/zh/apps/subtitle-downloader" ref="nofollow noopener noreferrer">å­—å¹•ä¸‹è½½å·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Flyrics-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/lyrics-generator" ref="nofollow noopener noreferrer">æ­Œè¯ç”Ÿæˆå·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcloud-drive-search" target="_blank" title="https://tools.cmdragon.cn/zh/apps/cloud-drive-search" ref="nofollow noopener noreferrer">ç½‘ç›˜èµ„æºèšåˆæœç´¢ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fascii-art-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ascii-art-generator" ref="nofollow noopener noreferrer">ASCIIå­—ç¬¦ç”»ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fjwt-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/jwt-tool" ref="nofollow noopener noreferrer">JSON Web Tokens å·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fbcrypt-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/bcrypt-tool" ref="nofollow noopener noreferrer">Bcrypt å¯†ç å·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fgif-composer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/gif-composer" ref="nofollow noopener noreferrer">GIF åˆæˆå™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fgif-decomposer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/gif-decomposer" ref="nofollow noopener noreferrer">GIF åˆ†è§£å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-steganography" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-steganography" ref="nofollow noopener noreferrer">æ–‡æœ¬éšå†™æœ¯ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh" target="_blank" title="https://tools.cmdragon.cn/zh" ref="nofollow noopener noreferrer">CMDragon åœ¨çº¿å·¥å…· - é«˜çº§AIå·¥å…·ç®±ä¸å¼€å‘è€…å¥—ä»¶ | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%3Fcategory%3Dtrending" target="_blank" title="https://tools.cmdragon.cn/zh/apps?category=trending" ref="nofollow noopener noreferrer">åº”ç”¨å•†åº— - å‘ç°1000+æå‡æ•ˆç‡ä¸å¼€å‘çš„AIå·¥å…·å’Œå®ç”¨ç¨‹åº | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fchangelog" target="_blank" title="https://tools.cmdragon.cn/zh/changelog" ref="nofollow noopener noreferrer">CMDragon æ›´æ–°æ—¥å¿— - æœ€æ–°æ›´æ–°ã€åŠŸèƒ½ä¸æ”¹è¿› | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fsponsor" target="_blank" title="https://tools.cmdragon.cn/zh/sponsor" ref="nofollow noopener noreferrer">æ”¯æŒæˆ‘ä»¬ - æˆä¸ºèµåŠ©è€… | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-to-image-ai" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-to-image-ai" ref="nofollow noopener noreferrer">AIæ–‡æœ¬ç”Ÿæˆå›¾åƒ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftemp-email" target="_blank" title="https://tools.cmdragon.cn/zh/apps/temp-email" ref="nofollow noopener noreferrer">ä¸´æ—¶é‚®ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fqrcode-parser" target="_blank" title="https://tools.cmdragon.cn/zh/apps/qrcode-parser" ref="nofollow noopener noreferrer">äºŒç»´ç è§£æå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-to-mindmap" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-to-mindmap" ref="nofollow noopener noreferrer">æ–‡æœ¬è½¬æ€ç»´å¯¼å›¾ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fregex-visualizer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/regex-visualizer" ref="nofollow noopener noreferrer">æ­£åˆ™è¡¨è¾¾å¼å¯è§†åŒ–å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsteganography-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/steganography-tool" ref="nofollow noopener noreferrer">æ–‡ä»¶éšå†™å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fiptv-explorer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/iptv-explorer" ref="nofollow noopener noreferrer">IPTV é¢‘é“æ¢ç´¢å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsnapdrop" target="_blank" title="https://tools.cmdragon.cn/zh/apps/snapdrop" ref="nofollow noopener noreferrer">å¿«ä¼  - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Flucky-draw" target="_blank" title="https://tools.cmdragon.cn/zh/apps/lucky-draw" ref="nofollow noopener noreferrer">éšæœºæŠ½å¥–å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fanime-scene-finder" target="_blank" title="https://tools.cmdragon.cn/zh/apps/anime-scene-finder" ref="nofollow noopener noreferrer">åŠ¨æ¼«åœºæ™¯æŸ¥æ‰¾å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftime-toolkit" target="_blank" title="https://tools.cmdragon.cn/zh/apps/time-toolkit" ref="nofollow noopener noreferrer">æ—¶é—´å·¥å…·ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fspeed-test" target="_blank" title="https://tools.cmdragon.cn/zh/apps/speed-test" ref="nofollow noopener noreferrer">ç½‘é€Ÿæµ‹è¯• - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fbackground-remover" target="_blank" title="https://tools.cmdragon.cn/zh/apps/background-remover" ref="nofollow noopener noreferrer">AI æ™ºèƒ½æŠ å›¾å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fbackground-replacer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/background-replacer" ref="nofollow noopener noreferrer">èƒŒæ™¯æ›¿æ¢å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fartistic-qrcode" target="_blank" title="https://tools.cmdragon.cn/zh/apps/artistic-qrcode" ref="nofollow noopener noreferrer">è‰ºæœ¯äºŒç»´ç ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fopen-graph-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/open-graph-generator" ref="nofollow noopener noreferrer">Open Graph å…ƒæ ‡ç­¾ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-comparison" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-comparison" ref="nofollow noopener noreferrer">å›¾åƒå¯¹æ¯”å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-compressor" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-compressor" ref="nofollow noopener noreferrer">å›¾ç‰‡å‹ç¼©ä¸“ä¸šç‰ˆ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fpassword-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/password-generator" ref="nofollow noopener noreferrer">å¯†ç ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsvg-optimizer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/svg-optimizer" ref="nofollow noopener noreferrer">SVGä¼˜åŒ–å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcolor-palette" target="_blank" title="https://tools.cmdragon.cn/zh/apps/color-palette" ref="nofollow noopener noreferrer">è°ƒè‰²æ¿ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fonline-metronome" target="_blank" title="https://tools.cmdragon.cn/zh/apps/online-metronome" ref="nofollow noopener noreferrer">åœ¨çº¿èŠ‚æ‹å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fip-geolocation" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ip-geolocation" ref="nofollow noopener noreferrer">IPå½’å±åœ°æŸ¥è¯¢ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcss-grid-layout" target="_blank" title="https://tools.cmdragon.cn/zh/apps/css-grid-layout" ref="nofollow noopener noreferrer">CSSç½‘æ ¼å¸ƒå±€ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Femail-validator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/email-validator" ref="nofollow noopener noreferrer">é‚®ç®±éªŒè¯å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcalligraphy-practice" target="_blank" title="https://tools.cmdragon.cn/zh/apps/calligraphy-practice" ref="nofollow noopener noreferrer">ä¹¦æ³•ç»ƒä¹ å­—å¸– - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ffinance-calculator-suite" target="_blank" title="https://tools.cmdragon.cn/zh/apps/finance-calculator-suite" ref="nofollow noopener noreferrer">é‡‘èè®¡ç®—å™¨å¥—ä»¶ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fchinese-kinship-calculator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/chinese-kinship-calculator" ref="nofollow noopener noreferrer">ä¸­å›½äº²æˆšå…³ç³»è®¡ç®—å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fprotobuf-toolkit" target="_blank" title="https://tools.cmdragon.cn/zh/apps/protobuf-toolkit" ref="nofollow noopener noreferrer">Protocol Buffer å·¥å…·ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fip-geolocation" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ip-geolocation" ref="nofollow noopener noreferrer">IPå½’å±åœ°æŸ¥è¯¢ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-upscaler" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-upscaler" ref="nofollow noopener noreferrer">å›¾ç‰‡æ— æŸæ”¾å¤§ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-compare" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-compare" ref="nofollow noopener noreferrer">æ–‡æœ¬æ¯”è¾ƒå·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fip-batch-lookup" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ip-batch-lookup" ref="nofollow noopener noreferrer">IPæ‰¹é‡æŸ¥è¯¢å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fdomain-finder" target="_blank" title="https://tools.cmdragon.cn/zh/apps/domain-finder" ref="nofollow noopener noreferrer">åŸŸåæŸ¥è¯¢å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fdns-toolkit" target="_blank" title="https://tools.cmdragon.cn/zh/apps/dns-toolkit" ref="nofollow noopener noreferrer">DNSå·¥å…·ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ffavicon-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/favicon-generator" ref="nofollow noopener noreferrer">ç½‘ç«™å›¾æ ‡ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fsitemap_index.xml" target="_blank" title="https://tools.cmdragon.cn/sitemap_index.xml" ref="nofollow noopener noreferrer">XML Sitemap</a></li>
</ul>
</details>
<ol>
<li><strong>æ€§èƒ½å¼€é”€å¤§</strong>ï¼šæ¯ä¸ªå¾ªç¯é¡¹éƒ½è¦æ‰§è¡Œæ¡ä»¶åˆ¤æ–­ï¼Œæ•°æ®é‡å¤§æ—¶æ¸²æŸ“æ…¢ï¼›</li>
<li><strong>é€»è¾‘å¯è¯»æ€§å·®</strong>ï¼šæ¨¡æ¿ä¸­æ··æ‚äº†ä¸šåŠ¡é€»è¾‘ï¼ˆè¿‡æ»¤ï¼‰å’Œæ¸²æŸ“é€»è¾‘ï¼ˆå¾ªç¯ï¼‰ï¼ŒåæœŸéš¾ç»´æŠ¤ï¼›</li>
<li><strong>ä¼˜å…ˆçº§éšå¼æ€§</strong>ï¼šæ–°æ‰‹å®¹æ˜“å¿½ç•¥ä¼˜å…ˆçº§è§„åˆ™ï¼Œå¯¼è‡´é€»è¾‘é”™è¯¯ã€‚</li>
</ol>
<h3 data-id="heading-8">æ”¹è¿›æ–¹æ¡ˆ1ï¼šç”¨ computed è¿‡æ»¤æ•°æ®ï¼ˆæ¨èï¼‰</h3>
<p><code>computed</code>æ˜¯Vue3ä¸­å¤„ç†å“åº”å¼æ•°æ®çš„â€œç¥å™¨â€â€”â€”å®ƒä¼šç¼“å­˜è®¡ç®—ç»“æœï¼Œåªæœ‰å½“ä¾èµ–çš„å“åº”å¼æ•°æ®å˜åŒ–æ—¶æ‰é‡æ–°è®¡ç®—ã€‚</p>
<p>ç”¨<code>computed</code>æ”¹è¿›ä¹‹å‰çš„â€œå·²å®Œæˆå¾…åŠâ€ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;ul&gt;
    &lt;!-- æ¨èï¼šå¾ªç¯è¿‡æ»¤åçš„æ•°ç»„ --&gt;
    &lt;li v-for="todo in doneTodos" :key="todo.id"&gt;
      {{ todo.text }}
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref, computed } from 'vue'

const todos = ref([
  { id: 1, text: 'å†™åšå®¢', done: true },
  { id: 2, text: 'æ”¹bug', done: false },
  { id: 3, text: 'æµ‹åŠŸèƒ½', done: true }
])

// ç”¨ computed è¿‡æ»¤â€œå·²å®Œæˆâ€çš„å¾…åŠé¡¹
const doneTodos = computed(() =&gt; {
  return todos.value.filter(todo =&gt; todo.done)
})
&lt;/script&gt;
</code></pre>
<p>è¿™æ ·åšçš„å¥½å¤„ï¼š</p>
<ul>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼š<code>computed</code>ç¼“å­˜è¿‡æ»¤ç»“æœï¼Œé¿å…é‡å¤è®¡ç®—ï¼›</li>
<li><strong>é€»è¾‘æ¸…æ™°</strong>ï¼šæ¨¡æ¿åªè´Ÿè´£æ¸²æŸ“ï¼Œè¿‡æ»¤é€»è¾‘æ”¾åœ¨JSä¸­ï¼Œç¬¦åˆâ€œå…³æ³¨ç‚¹åˆ†ç¦»â€åŸåˆ™ï¼›</li>
<li><strong>å¯å¤ç”¨æ€§</strong>ï¼š<code>doneTodos</code>å¯ä»¥åœ¨æ¨¡æ¿ä¸­å¤šæ¬¡ä½¿ç”¨ï¼Œä¸ç”¨é‡å¤å†™è¿‡æ»¤é€»è¾‘ã€‚</li>
</ul>
<h3 data-id="heading-9">æ”¹è¿›æ–¹æ¡ˆ2ï¼šå°† v-if ç§»è‡³çˆ¶å…ƒç´ ï¼ˆé€‚ç”¨äºå…¨å±€æ¡ä»¶ï¼‰</h3>
<p>å¦‚æœ<code>v-if</code>çš„æ¡ä»¶<strong>ä¸ä¾èµ–å¾ªç¯é¡¹</strong>ï¼ˆæ¯”å¦‚æ§åˆ¶æ•´ä¸ªåˆ—è¡¨æ˜¯å¦æ˜¾ç¤ºï¼‰ï¼Œå¯ä»¥æŠŠ<code>v-if</code>æ”¾åœ¨<code>v-for</code>çš„çˆ¶å…ƒç´ ä¸Šï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;!-- å…ˆåˆ¤æ–­æ˜¯å¦æ˜¾ç¤ºæ•´ä¸ªåˆ—è¡¨ --&gt;
  &lt;div v-if="showTodos"&gt;
    &lt;ul&gt;
      &lt;li v-for="todo in todos" :key="todo.id"&gt;
        {{ todo.text }}
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
const showTodos = ref(true) // æ§åˆ¶æ•´ä¸ªåˆ—è¡¨çš„æ˜¾ç¤º
&lt;/script&gt;
</code></pre>
<p>è¿™ç§å†™æ³•çš„é€»è¾‘æ›´ç›´è§‚ï¼š<code>v-if</code>æ§åˆ¶çˆ¶å…ƒç´ çš„æ˜¾ç¤ºï¼Œ<code>v-for</code>è´Ÿè´£å¾ªç¯å­å…ƒç´ ï¼Œå®Œå…¨é¿å…äº†ä¼˜å…ˆçº§é—®é¢˜ã€‚</p>
<h2 data-id="heading-10">å®æˆ˜ç¤ºä¾‹ï¼šä»é”™è¯¯åˆ°æœ€ä½³å®è·µ</h2>
<p>æˆ‘ä»¬ç”¨ä¸€ä¸ªâ€œç”µå•†å•†å“åˆ—è¡¨â€çš„åœºæ™¯ï¼Œå®Œæ•´æ¼”ç¤ºä»é”™è¯¯åˆ°æ­£ç¡®çš„å†™æ³•ã€‚</p>
<h3 data-id="heading-11">é”™è¯¯ç”¨æ³•ï¼šåŒå…ƒç´ æ··ç”¨å¯¼è‡´æ€§èƒ½é—®é¢˜</h3>
<p>éœ€æ±‚ï¼šæ˜¾ç¤ºâ€œæœ‰åº“å­˜çš„å•†å“â€ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="products"&gt;
    &lt;!-- é”™è¯¯ï¼šåŒå…ƒç´ ç”¨ v-if å’Œ v-for --&gt;
    &lt;div v-for="product in products" v-if="product.inStock" :key="product.id"&gt;
      {{ product.name }} - {{ product.price }}å…ƒ
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
const products = ref([
  { id: 1, name: 'æ‰‹æœº', price: 5000, inStock: true },
  { id: 2, name: 'ç”µè„‘', price: 8000, inStock: false },
  { id: 3, name: 'å¹³æ¿', price: 3000, inStock: true }
])
&lt;/script&gt;
</code></pre>
<p>é—®é¢˜ï¼šæ¯ä¸ªå•†å“éƒ½è¦åˆ¤æ–­<code>inStock</code>ï¼Œå½“å•†å“æ•°é‡å¾ˆå¤§æ—¶ï¼Œæ¸²æŸ“é€Ÿåº¦ä¼šå˜æ…¢ã€‚</p>
<h3 data-id="heading-12">æœ€ä½³å®è·µï¼šç”¨ computed è¿‡æ»¤åå¾ªç¯</h3>
<p>æ”¹è¿›åçš„ä»£ç ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="products"&gt;
    &lt;!-- æ­£ç¡®ï¼šå¾ªç¯è¿‡æ»¤åçš„å•†å“ --&gt;
    &lt;div v-for="product in inStockProducts" :key="product.id"&gt;
      {{ product.name }} - {{ product.price }}å…ƒ
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref, computed } from 'vue'

const products = ref([/* åŒä¸Š */])

// è®¡ç®—æœ‰åº“å­˜çš„å•†å“
const inStockProducts = computed(() =&gt; {
  return products.value.filter(p =&gt; p.inStock)
})
&lt;/script&gt;
</code></pre>
<p>è¿™æ ·<code>v-for</code>åªå¾ªç¯è¿‡æ»¤åçš„<code>inStockProducts</code>ï¼Œä¸éœ€è¦æ¯ä¸ªå•†å“åˆ¤æ–­ï¼Œæ€§èƒ½æå‡æ˜æ˜¾ã€‚</p>
<h2 data-id="heading-13">è¯¾å Quizï¼šå·©å›ºä½ çš„ç†è§£</h2>
<p>é—®é¢˜ï¼šåœ¨Vue3ä¸­ï¼Œä¸ºä»€ä¹ˆä¸æ¨èåœ¨åŒä¸€ä¸ªå…ƒç´ ä¸ŠåŒæ—¶ä½¿ç”¨v-ifå’Œv-forï¼Ÿè¯·è¯´æ˜ä¼˜å…ˆçº§è§„åˆ™åŠä¸¤ç§æ”¹è¿›æ–¹æ¡ˆã€‚</p>
<p><strong>ç­”æ¡ˆè§£æ</strong>ï¼š</p>
<ol>
<li><strong>ä¼˜å…ˆçº§è§„åˆ™</strong>ï¼šVue3ä¸­<code>v-if</code>çš„ä¼˜å…ˆçº§é«˜äº<code>v-for</code>ï¼ŒåŒå…ƒç´ ä½¿ç”¨æ—¶<code>v-if</code>å…ˆè¢«è¯„ä¼°ï¼›</li>
<li><strong>ä¸æ¨èåŸå› </strong>ï¼š
<ul>
<li>è‹¥<code>v-if</code>æ¡ä»¶ä¾èµ–å¾ªç¯é¡¹ï¼Œæ¯ä¸ªé¡¹éƒ½è¦åˆ¤æ–­ï¼Œæ€§èƒ½å·®ï¼›</li>
<li>æ¨¡æ¿é€»è¾‘æ··åˆè¿‡æ»¤ä¸å¾ªç¯ï¼Œå¯è¯»æ€§ä½ï¼›</li>
</ul>
</li>
<li><strong>æ”¹è¿›æ–¹æ¡ˆ</strong>ï¼š
<ul>
<li>æ–¹æ¡ˆ1ï¼šç”¨<code>computed</code>è¿‡æ»¤æ•°æ®ï¼Œå†ç”¨<code>v-for</code>å¾ªç¯è¿‡æ»¤åçš„ç»“æœï¼ˆé€‚ç”¨äºæ¡ä»¶ä¾èµ–å¾ªç¯é¡¹çš„åœºæ™¯ï¼‰ï¼›</li>
<li>æ–¹æ¡ˆ2ï¼šå°†<code>v-if</code>ç§»è‡³<code>v-for</code>çš„çˆ¶å…ƒç´ ä¸Šï¼ˆé€‚ç”¨äºæ¡ä»¶ä¸ä¾èµ–å¾ªç¯é¡¹çš„åœºæ™¯ï¼‰ã€‚</li>
</ul>
</li>
</ol>
<h2 data-id="heading-14">å¸¸è§æŠ¥é”™ä¸è§£å†³å°è´´å£«</h2>
<h3 data-id="heading-15">æŠ¥é”™1ï¼šv-ifä¸v-foråŒå…ƒç´ æ—¶é€»è¾‘ä¸ç¬¦åˆé¢„æœŸ</h3>
<ul>
<li><strong>ç—‡çŠ¶</strong>ï¼šå¾ªç¯çš„åˆ—è¡¨é¡¹æ˜¾ç¤ºä¸å…¨ï¼Œæˆ–æ¡ä»¶åˆ¤æ–­å¤±æ•ˆï¼›</li>
<li><strong>åŸå› </strong>ï¼šVue3ä¸­<code>v-if</code>ä¼˜å…ˆçº§æ›´é«˜ï¼ŒåŒå…ƒç´ ä½¿ç”¨æ—¶<code>v-if</code>å…ˆè¯„ä¼°ï¼Œè‹¥æ¡ä»¶ä¾èµ–å¾ªç¯é¡¹ï¼Œä¼šå¯¼è‡´æ¯ä¸ªé¡¹éƒ½è¦åˆ¤æ–­ï¼Œé€»è¾‘æ··ä¹±ï¼›</li>
<li><strong>è§£å†³</strong>ï¼šç”¨<code>computed</code>è¿‡æ»¤æ•°æ®åå†å¾ªç¯ã€‚</li>
</ul>
<h3 data-id="heading-16">æŠ¥é”™2ï¼šå¾ªç¯åˆ—è¡¨æ¸²æŸ“ç¼“æ…¢</h3>
<ul>
<li><strong>ç—‡çŠ¶</strong>ï¼šåˆ—è¡¨æ•°æ®é‡å¤§æ—¶ï¼Œæ¸²æŸ“æ—¶é—´é•¿ï¼›</li>
<li><strong>åŸå› </strong>ï¼šåŒå…ƒç´ ä½¿ç”¨<code>v-if</code>å’Œ<code>v-for</code>ï¼Œæ¯ä¸ªé¡¹éƒ½è¦æ‰§è¡Œæ¡ä»¶åˆ¤æ–­ï¼Œæ€§èƒ½å¼€é”€å¤§ï¼›</li>
<li><strong>è§£å†³</strong>ï¼šé€šè¿‡<code>computed</code>æˆ–æ–¹æ³•è¿‡æ»¤æ•°æ®ï¼Œå‡å°‘å¾ªç¯çš„é¡¹æ•°ã€‚</li>
</ul>
<h3 data-id="heading-17">é¢„é˜²å»ºè®®</h3>
<ul>
<li>æ°¸è¿œä¼˜å…ˆç”¨<code>computed</code>å¤„ç†æ•°æ®è¿‡æ»¤ï¼Œå†å¾ªç¯ï¼›</li>
<li>è‹¥æ¡ä»¶ä¸ä¾èµ–å¾ªç¯é¡¹ï¼Œå°†<code>v-if</code>æ”¾åœ¨çˆ¶å…ƒç´ ä¸Šï¼›</li>
<li>é¿å…åœ¨æ¨¡æ¿ä¸­å†™å¤æ‚æ¡ä»¶ï¼Œå°½é‡æŠŠé€»è¾‘ç§»åˆ°JSéƒ¨åˆ†ï¼ˆ<code>computed</code>/<code>methods</code>ï¼‰ã€‚</li>
</ul>
<p>å‚è€ƒé“¾æ¥ï¼š<br/>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fvuejs.org%2Fguide%2Fessentials%2Fconditional.html%23v-if-with-v-for" target="_blank" title="https://vuejs.org/guide/essentials/conditional.html#v-if-with-v-for" ref="nofollow noopener noreferrer">vuejs.org/guide/essenâ€¦</a><br/>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fvuejs.org%2Fguide%2Fessentials%2Flist.html%23v-for-with-v-if" target="_blank" title="https://vuejs.org/guide/essentials/list.html#v-for-with-v-if" ref="nofollow noopener noreferrer">vuejs.org/guide/essenâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[çªç ´é™åˆ¶ï¼švue-plugin-hiprint å¯Œæ–‡æœ¬æ”¯æŒæ·±åº¦è§£æä¸è§£å†³æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7587845752682446911</link>    <guid>https://juejin.cn/post/7587845752682446911</guid>    <pubDate>2025-12-26T08:18:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587845752682446911" data-draft-id="7587825268200964102" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="çªç ´é™åˆ¶ï¼švue-plugin-hiprint å¯Œæ–‡æœ¬æ”¯æŒæ·±åº¦è§£æä¸è§£å†³æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="å‰ç«¯,å¼€æº"/> <meta itemprop="datePublished" content="2025-12-26T08:18:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="MrBread"/> <meta itemprop="url" content="https://juejin.cn/user/761295078433239"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            çªç ´é™åˆ¶ï¼švue-plugin-hiprint å¯Œæ–‡æœ¬æ”¯æŒæ·±åº¦è§£æä¸è§£å†³æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/761295078433239/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    MrBread
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T08:18:29.000Z" title="Fri Dec 26 2025 08:18:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/02902d8fd6fd4e498ea2682cf818b781~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTXJCcmVhZA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767342376&amp;x-signature=QWh%2FCABuJ0l6bsPmM7Y8LJB1m0g%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-0">å‰è¨€</h3>
<p>æœ¬æ–‡ç« æ—¨åœ¨ä»‹ç»è¯¥æ’ä»¶å¯¹äºå¯Œæ–‡æœ¬çš„æ”¯æŒæƒ…å†µï¼ŒåŠäºŒæ¬¡å¼€å‘ä»¥æ”¯æŒéƒ¨åˆ†å¯Œæ–‡æœ¬å…ƒç´ æ˜¾ç¤ºæä¾›æ€è·¯ã€‚å¯¹äºåˆæ¬¡æ¥è§¦çš„äººå¯ä»¥å…ˆçœ‹æ–‡ç« <a href="https://juejin.cn/post/7574382925760725030" target="_blank" title="https://juejin.cn/post/7574382925760725030">ä¸é™äºVueï¼vue-plugin-hiprint æ‰“å°æ’ä»¶å®Œæ•´ä½¿ç”¨æŒ‡å—</a>ï¼Œé‡Œé¢åŒ…å«äº†æˆ‘å¯¹è¿™ä¸ªæ’ä»¶çš„å…¨éƒ¨äº†è§£ï¼Œä¹‹åå†çœ‹æœ¬æ–‡ç« ã€‚</p>
<h3 data-id="heading-1">æ’ä»¶å¯¹äºå¯Œæ–‡æœ¬çš„æ”¯æŒæƒ…å†µ</h3>
<h4 data-id="heading-2">åˆ†æè¿‡ç¨‹</h4>
<p>è¿™ä¸€æ­¥éœ€è¦æŸ¥çœ‹è¯¥æ’ä»¶å…·ä½“æ˜¯å¦‚ä½•æ¸²æŸ“çš„å„ä¸ªå…ƒç´ ï¼Œå› ä¸ºæ­¤å¤„çš„åˆ†ææ²¡æœ‰ä»€ä¹ˆå¤ªå¤šä»·å€¼ï¼Œéƒ½æ˜¯åŠ›æ°”æ´»å„¿ï¼Œæ‰€ä»¥åªä»‹ç»ä¸€ä¸‹æ€è·¯ï¼šä»hiprintTemplate.getHtmlå…¥æ‰‹ï¼ŒæŸ¥æ‰¾å„ä¸ªå…ƒç´ æ˜¯ä»€ä¹ˆæ—¶å€™è¢«å…·ä½“è½¬ä¸ºäº†çœŸæ­£çš„domã€‚æ’æŸ¥åå¯ä»¥æ€»ç»“å‡ºè¿™æ ·ä¸€æ¡æ¸²æŸ“é“¾è·¯</p>
<p>hiprintTemplate.getHtml=&gt;panel.getHtml=&gt;å…ƒç´ çš„getHtml</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºæ¯ä¸€ç§ç±»å‹çš„å…ƒç´ çš„çœŸå®domä¸åŒï¼Œæ‰€ä»¥ä»–ä»¬çš„getHtmlä¹Ÿå°±ä¸åŒï¼Œåªæœ‰æ‰¾å¯»å¯¹åº”å…ƒç´ çš„getHtmlæ‰èƒ½çŸ¥é“å®ƒä»¬æ˜¯å¦‚ä½•æ¸²æŸ“çš„ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥æ‰“å°hiprintTemplateçš„å®ä¾‹ï¼ŒæŒ‰ç…§ <code>printPanels.printElements</code>çš„è·¯å¾„æ‰¾åˆ°å¯¹åº”çš„å…ƒç´ å®ä¾‹ï¼Œ<code>[[Prototype]]</code>ä¸Šå³å¯æ‰¾å¯¹åº”çš„getHtmlã€‚</p>
<h4 data-id="heading-3">åˆ†æç»“æœ</h4>
<p>1.å†…ç½®ç±»å‹html</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span>(<span class="hljs-params">t, e, printData</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;div style="height:50pt;width:50pt;background:red;border-radius: 50%;"&gt;&lt;/div&gt;'</span>;
}
</code></pre>
<p>htmlé€šè¿‡formatterå‡½æ•°å¯ä»¥æ¸²æŸ“å‡ºdomå…ƒç´ ï¼Œé€šè¿‡printDataè·å–åˆ°å¯Œæ–‡æœ¬æ•°æ®ï¼Œåœ¨returnä¸­è¿”å›å³å¯ã€‚</p>
<p>-ï¼šhtmlå†…éƒ¨æ²¡æœ‰åˆ†é¡µçš„é€»è¾‘ï¼Œè™½ç„¶å¯ä»¥æ¸²æŸ“ï¼Œä½†æ˜¯è¶…è¿‡å½“å‰é¡µçš„æ•°æ®ä¼šè¢«æˆªæ–­ã€‚å¦‚æœä½¿ç”¨è¿™ä¸ªå…ƒç´ çš„è¯ï¼Œå°±éœ€è¦è‡ªå·±å®Œå–„htmlçš„åˆ†é¡µé€»è¾‘ï¼Œç›®æµ‹ç›¸å½“éº»çƒ¦ã€‚</p>
<p>2.longText</p>
<p>åœ¨æ’ä»¶çš„ä½¿ç”¨è¿‡ç¨‹ä¸­å‘ç°longTextä¸­ç›´æ¥æ”¾ç½®å¯Œæ–‡æœ¬ï¼Œæ–‡å­—çš„éƒ¨åˆ†æ˜¯å¯ä»¥æ¸²æŸ“å‡ºæ¥ï¼Œå¹¶ä¸”longTextæœ¬èº«æ”¯æŒå¤„ç†é•¿æ–‡æœ¬åˆ†é¡µçš„æƒ…å†µï¼Œè™½ç„¶è¯¥å…ƒç´ ç±»å‹çš„æœ¬èº«çš„åˆ†é¡µæ–¹æ³•åªèƒ½å¤„ç†æ™®é€šæ–‡æœ¬ï¼Œä½†æ˜¯èµ·ç åˆ†é¡µçš„éƒ¨åˆ†ä¸ç”¨è‡ªå·±ä»å¤´å†™ã€‚</p>
<p>ä¸è¶³ï¼š1.HTMLè½¬ä¹‰ç¬¦æˆªæ–­ï¼Œè™½ç„¶å¤§éƒ¨åˆ†æ–‡æœ¬éƒ½å¯ä»¥æ­£å¸¸æ˜¾ç¤ºï¼Œä½†æ˜¯å¦‚æœåˆ†é¡µåˆšå·§åœ¨è½¬ä¹‰ç¬¦ä¸­é—´ï¼ˆæ¯”å¦‚ï¼š<code>&amp;ldquo;</code>ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªè½¬ä¹‰ç¬¦å°±ä¼šè¢«æˆªæ–­ 2.æ ‡ç­¾æˆªæ–­ï¼Œå½“åˆ†é¡µåˆšå·§åœ¨æ ‡ç­¾ä¸Šçš„æ—¶å€™ï¼ˆæ¯”å¦‚ï¼š<code>&lt;img sr="" /&gt;</code>çš„è‡ªä¸­é—´ï¼‰ï¼Œå›¾ç‰‡å°†æ— æ³•æ˜¾ç¤ºï¼Œæ–‡æœ¬éƒ¨åˆ†ä¼šå‡ºç°ä¾‹å¦‚ <code>/&gt;</code> å‰©ä½™çš„æ®‹ç¼ºå­—ç¬¦ã€‚</p>
<p>ä¸¤è€…ç›¸æ¯”ï¼Œæˆ‘è§‰å¾—è¿˜æ˜¯longTextçš„æ”¹é€ éš¾åº¦å°ä¸€äº›ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥å°±æ˜¯äºŒæ¬¡å¼€å‘longTextã€‚</p>
<h3 data-id="heading-4">äºŒæ¬¡å¼€å‘longText</h3>
<h4 data-id="heading-5">æ€è·¯</h4>
<p>é—®é¢˜1ï¼šå¦‚ä½•è·å–å…ƒç´ çš„åŸå‹</p>
<p>ç”±äºå…ƒç´ çš„getHTMLæ–¹æ³•æ˜¯æ”¾åœ¨å…ƒç´ çš„åŸå‹ä¸Šçš„ï¼Œæˆ‘ä»¬æƒ³è¦äºŒæ¬¡å¼€å‘getHTMLæ–¹æ³•å°±éœ€è¦æ‰¾åˆ°å®ƒçš„åŸå‹ã€‚</p>
<p>ä¸ºäº†æ‰¾åˆ°åŸå‹ï¼Œæˆ‘ä»¬å°±éœ€è¦ä»åˆå§‹åŒ–æ¨¡æ¿<code>hiprintTemplate.PrintTemplate()</code>å¼€å§‹ï¼Œä¸€ç›´æ‰¾åˆ°å…ƒç´ åˆ›å»ºå®ä¾‹çš„éƒ¨åˆ†ã€‚</p>
<p>æœ€ç»ˆå‘ç°å¯ä»¥é€šè¿‡ <code>getElementType</code> è·å–å…ƒç´ ç±»å‹å®ä¾‹ï¼Œé€šè¿‡å…ƒç´ ç±»å‹å®ä¾‹çš„createPrintElementå³å¯åˆ›å»ºå¯¹åº”çš„å…ƒç´ å®ä¾‹ï¼Œè€Œ <code>hiprint.PrintElementTypeManager</code>ä¸Šå°±æœ‰<strong>getElementType</strong>ã€‚</p>
<pre><code class="hljs language-js" lang="js">hiprint.<span class="hljs-property">PrintElementTypeManager</span>.<span class="hljs-title function_">getElementType</span>(tid).<span class="hljs-title function_">createPrintElement</span>()
</code></pre>
<p>é€šè¿‡ä¼ å…¥longTextçš„tidï¼Œæœ€ç»ˆè·å–åˆ°äº†å…ƒç´ çš„å®ä¾‹</p>
<p>é—®é¢˜2ï¼šå¦‚ä½•å¤„ç†æˆªæ–­é—®é¢˜</p>
<p>é¦–å…ˆåˆ†æäº†longTextçš„getHtmlï¼Œå¤§æ¦‚çš„é€»è¾‘æ˜¯ä»–æŠŠæ•´ä¸ªé•¿æ–‡æ•°æ®æ‹†æˆ<strong>å•ä¸ªå­—ç¬¦çš„æ•°ç»„</strong>ï¼Œç„¶åé€šè¿‡ <code>IsPaginationIndex</code> æ¸²æŸ“ä¸´æ—¶å®¹å™¨åˆ¤æ–­æ˜¯å¦è¶…è¿‡é¡µé¢çš„å¤§å°ã€‚è¶…è¿‡å°±æ˜¯ä½¿ç”¨äºŒåˆ†æ³•å¯»æ‰¾åˆ†é¡µç‚¹ï¼Œå› ä¸ºæ˜¯è¿™ç§ç›´æ¥æ–­å¼€çš„æ–¹å¼æ‰€ä»¥ï¼Œä¼šé€ æˆæˆªæ–­ç°è±¡ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title class_">IsPaginationIndex</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">e3, t3, i4, n3</span>) {
 Â  Â <span class="hljs-comment">// e3: å­—ç¬¦æ•°ç»„</span>
 Â  Â <span class="hljs-comment">// t3: å°è¯•çš„ç´¢å¼•ä½ç½®</span>
 Â  Â <span class="hljs-comment">// i4: æœ€å¤§å…è®¸é«˜åº¦ï¼ˆpxï¼‰</span>
 Â  Â <span class="hljs-comment">// n3: ä¸´æ—¶å®¹å™¨</span>
â€‹
 Â  Â <span class="hljs-comment">// æœ‰é«˜åº¦é™åˆ¶æ¨¡å¼</span>
 Â  Â <span class="hljs-comment">// æµ‹è¯•ï¼šåŒ…å« t3+2 ä¸ªå­—ç¬¦</span>
 Â  Â n3.<span class="hljs-title function_">find</span>(<span class="hljs-string">".hiprint-printElement-longText-content"</span>)
 Â  Â   .<span class="hljs-title function_">html</span>(e3.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, t3 + <span class="hljs-number">2</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">""</span>));
 Â  Â <span class="hljs-keyword">var</span> r2 = n3.<span class="hljs-title function_">height</span>(); Â <span class="hljs-comment">// é«˜åº¦1</span>
 Â  Â 
 Â  Â <span class="hljs-comment">// æµ‹è¯•ï¼šåŒ…å« t3+1 ä¸ªå­—ç¬¦ Â </span>
 Â  Â n3.<span class="hljs-title function_">find</span>(<span class="hljs-string">".hiprint-printElement-longText-content"</span>)
 Â  Â   .<span class="hljs-title function_">html</span>(e3.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, t3 + <span class="hljs-number">1</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">""</span>));
 Â  Â <span class="hljs-keyword">var</span> <span class="hljs-variable constant_">A3</span> = n3.<span class="hljs-title function_">height</span>(); Â <span class="hljs-comment">// é«˜åº¦2</span>
 Â  Â 
 Â  Â <span class="hljs-comment">// åˆ¤æ–­é€»è¾‘ï¼š</span>
 Â  Â <span class="hljs-keyword">return</span> t3 &gt;= e3.<span class="hljs-property">length</span> - <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-variable constant_">A3</span> &lt; i4 ? Â <span class="hljs-comment">// æƒ…å†µ1ï¼šå¤„ç†å®Œæ‰€æœ‰å­—ç¬¦ä¸”æœªè¶…é™</span>
 Â  Â  Â   { <span class="hljs-title class_">IsPagination</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">height</span>: o.<span class="hljs-property">a</span>.<span class="hljs-property">px</span>.<span class="hljs-title function_">toPt</span>(<span class="hljs-variable constant_">A3</span>), <span class="hljs-attr">length</span>: e3.<span class="hljs-property">length</span>, <span class="hljs-attr">target</span>: n3.<span class="hljs-title function_">clone</span>() } : 
 Â  Â  Â  Â <span class="hljs-variable constant_">A3</span> &lt;= i4 &amp;&amp; i4 &lt;= r2 ? Â <span class="hljs-comment">// æƒ…å†µ2ï¼šå½“å‰é«˜åº¦&lt;=é™åˆ¶&lt;=ä¸‹ä¸€å­—ç¬¦é«˜åº¦ï¼ˆæ‰¾åˆ°åˆ†é¡µç‚¹ï¼‰</span>
 Â  Â  Â   { <span class="hljs-title class_">IsPagination</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">height</span>: <span class="hljs-variable constant_">A3</span>, <span class="hljs-attr">length</span>: t3 + <span class="hljs-number">1</span>, <span class="hljs-attr">target</span>: n3.<span class="hljs-title function_">clone</span>() } : 
 Â  Â  Â  Â i4 &lt;= <span class="hljs-variable constant_">A3</span> ? Â <span class="hljs-comment">// æƒ…å†µ3ï¼šé™åˆ¶é«˜åº¦å°äºç­‰äºå½“å‰é«˜åº¦ï¼ˆå‘å·¦æœç´¢ï¼‰</span>
 Â  Â  Â   { <span class="hljs-title class_">IsPagination</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">move</span>: <span class="hljs-string">"l"</span> } : 
 Â  Â  Â  Â r2 &lt;= i4 ? Â <span class="hljs-comment">// æƒ…å†µ4ï¼šé™åˆ¶é«˜åº¦å¤§äºç­‰äºä¸‹ä¸€å­—ç¬¦é«˜åº¦ï¼ˆå‘å³æœç´¢ï¼‰</span>
 Â  Â  Â   { <span class="hljs-title class_">IsPagination</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">move</span>: <span class="hljs-string">"r"</span> } : 
 Â  Â  Â   { <span class="hljs-title class_">IsPagination</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">result</span>: <span class="hljs-number">1</span> }; Â <span class="hljs-comment">// å…¶ä»–æƒ…å†µ</span>
}
</code></pre>
<p>æˆ‘æƒ³çš„è§£å†³æ–¹æ³•å°±æ˜¯ï¼Œè¯†åˆ«åˆ†é¡µç‚¹æ‰€åœ¨çš„ä½ç½®æ˜¯å¦å¤„äºä¸èƒ½è¢«æˆªæ–­çš„å­—ç¬¦ä¸­é—´ï¼Œè¿”å›ä¸èƒ½è¢«æˆªæ–­çš„å­—ç¬¦çš„å¼€å¤´ç´¢å¼•ã€‚</p>
<h4 data-id="heading-6">ä»£ç </h4>
<p>æ•´ä½“ä»£ç ä¸å˜ï¼Œåªéœ€è¦æ›¿æ¢æƒ…å†µ2æ—¶ï¼Œé‡æ–°æ‰¾åˆ°åˆ†é¡µç‚¹å³å¯ï¼Œä¹Ÿå°±æ˜¯å°†</p>
<pre><code class="hljs language-js" lang="js">{ <span class="hljs-title class_">IsPagination</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">height</span>: <span class="hljs-variable constant_">A3</span>, <span class="hljs-attr">length</span>: t3 + <span class="hljs-number">1</span>, <span class="hljs-attr">target</span>: n3.<span class="hljs-title function_">clone</span>() }
</code></pre>
<p>æ›¿æ¢ä¸º</p>
<pre><code class="hljs language-js" lang="js">{
 Â  Â <span class="hljs-title class_">IsPagination</span>: <span class="hljs-literal">true</span>,
 Â  Â <span class="hljs-attr">height</span>: <span class="hljs-variable constant_">A3</span>,
 Â  Â <span class="hljs-attr">length</span>: (length = <span class="hljs-title function_">adjustSplitForRichText</span>(e3, t3 + <span class="hljs-number">1</span>), length),
 Â  Â <span class="hljs-attr">target</span>: (n3.<span class="hljs-title function_">find</span>(<span class="hljs-string">".hiprint-printElement-longText-content"</span>).<span class="hljs-title function_">html</span>(e3.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, length).<span class="hljs-title function_">join</span>(<span class="hljs-string">""</span>)), n3.<span class="hljs-title function_">clone</span>()) <span class="hljs-comment">// å› ä¸ºå·²ç»é‡æ–°è®¾ç½®åˆ†é¡µç‚¹äº†ï¼Œæ‰€ä»¥å‰ä¸€é¡µçš„å†…å®¹éœ€è¦æŒ‰æ–°åˆ†é¡µç‚¹é‡æ–°æ¸²æŸ“</span>
}
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// html: å­—ç¬¦æ•°ç»„</span>
<span class="hljs-comment">// position: åŸå§‹åˆ†é¡µä½ç½®</span>
<span class="hljs-comment">// è¿”å›å€¼: è°ƒæ•´åçš„å®‰å…¨åˆ†é¡µä½ç½®</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">adjustSplitForRichText</span>(<span class="hljs-params">html, position</span>) {
 Â  Â <span class="hljs-comment">// æ£€æŸ¥å¹¶è°ƒæ•´HTMLå®ä½“</span>
 Â  Â <span class="hljs-keyword">const</span> entityAdjusted = <span class="hljs-title function_">getEntityEndOrPosition</span>(html, position);
 Â  Â <span class="hljs-keyword">if</span> (entityAdjusted !== position) <span class="hljs-keyword">return</span> entityAdjusted;
 Â  Â 
 Â  Â <span class="hljs-comment">// æ£€æŸ¥å¹¶è°ƒæ•´å›¾ç‰‡æ ‡ç­¾</span>
 Â  Â <span class="hljs-keyword">const</span> imgAdjusted = <span class="hljs-title function_">getImgTagStartIfInside</span>(html, position);
 Â  Â <span class="hljs-keyword">if</span> (imgAdjusted !== -<span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> imgAdjusted;
 Â  Â 
 Â  Â <span class="hljs-keyword">return</span> position;
}
</code></pre>
<p>æˆ‘åœ¨è¿™é‡Œåªå†™äº†è¯†åˆ«HTMLå®ä½“å’Œå›¾ç‰‡æ ‡ç­¾çš„æ–¹æ³•ï¼Œå› ä¸ºç›®å‰é¡¹ç›®ä¸­åªç”¨åˆ°äº†è¿™äº›ï¼Œå¦‚æœéœ€è¦æ›´å¤šçš„å¯Œæ–‡æœ¬æ”¯æŒï¼Œå°±éœ€è¦è‡ªå·±å†™æ›´å¤šçš„è¯†åˆ«ç®—æ³•ï¼Œè¿™ä¸ªå°±çœ‹éœ€æ±‚äº†ã€‚</p>
<p><code>getEntityEndOrPosition</code>ä¸ <code>getImgTagStartIfInside</code>éƒ½æ˜¯ç”¨æ¥è¯†åˆ«ä¸å¯æ‹†åˆ†å­—ç¬¦ä¸²çš„ç®—æ³•ï¼Œæˆ‘çš„ç®—æ³•æ”¾åœ¨è¿™é‡Œä»…ä½œå‚è€ƒï¼Œå¦‚æœæœ‰æ€§èƒ½éœ€æ±‚ï¼Œå¯ä»¥è‡ªå·±é‡æ–°å®ç°ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å¸¸è§HTMLå®ä½“é›†åˆ</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">HTML_ENTITIES</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([
 Â  Â <span class="hljs-string">'nbsp'</span>, <span class="hljs-string">'lt'</span>, <span class="hljs-string">'gt'</span>, <span class="hljs-string">'amp'</span>, <span class="hljs-string">'quot'</span>, <span class="hljs-string">'apos'</span>,
 Â  Â <span class="hljs-string">'ldquo'</span>, <span class="hljs-string">'rdquo'</span>, <span class="hljs-string">'lsquo'</span>, <span class="hljs-string">'rsquo'</span>,
 Â  Â <span class="hljs-string">'mdash'</span>, <span class="hljs-string">'ndash'</span>, <span class="hljs-string">'copy'</span>, <span class="hljs-string">'reg'</span>, <span class="hljs-string">'trade'</span>,
 Â  Â <span class="hljs-string">'euro'</span>, <span class="hljs-string">'pound'</span>, <span class="hljs-string">'cent'</span>, <span class="hljs-string">'yen'</span>, <span class="hljs-string">'sect'</span>,
 Â  Â <span class="hljs-string">'deg'</span>, <span class="hljs-string">'plusmn'</span>, <span class="hljs-string">'times'</span>, <span class="hljs-string">'divide'</span>,
 Â  Â <span class="hljs-string">'middot'</span>, <span class="hljs-string">'bull'</span>, <span class="hljs-string">'hellip'</span>, <span class="hljs-string">'prime'</span>, <span class="hljs-string">'Prime'</span>,
 Â  Â <span class="hljs-string">'oline'</span>, <span class="hljs-string">'frasl'</span>, <span class="hljs-string">'weierp'</span>, <span class="hljs-string">'image'</span>, <span class="hljs-string">'real'</span>,
 Â  Â <span class="hljs-string">'alefsym'</span>, <span class="hljs-string">'larr'</span>, <span class="hljs-string">'uarr'</span>, <span class="hljs-string">'rarr'</span>, <span class="hljs-string">'darr'</span>,
 Â  Â <span class="hljs-string">'harr'</span>, <span class="hljs-string">'crarr'</span>, <span class="hljs-string">'lArr'</span>, <span class="hljs-string">'uArr'</span>, <span class="hljs-string">'rArr'</span>, <span class="hljs-string">'dArr'</span>,
 Â  Â <span class="hljs-string">'hArr'</span>, <span class="hljs-string">'forall'</span>, <span class="hljs-string">'part'</span>, <span class="hljs-string">'exist'</span>, <span class="hljs-string">'empty'</span>,
 Â  Â <span class="hljs-string">'nabla'</span>, <span class="hljs-string">'isin'</span>, <span class="hljs-string">'notin'</span>, <span class="hljs-string">'ni'</span>, <span class="hljs-string">'prod'</span>, <span class="hljs-string">'sum'</span>,
 Â  Â <span class="hljs-string">'minus'</span>, <span class="hljs-string">'lowast'</span>, <span class="hljs-string">'radic'</span>, <span class="hljs-string">'prop'</span>, <span class="hljs-string">'infin'</span>,
 Â  Â <span class="hljs-string">'ang'</span>, <span class="hljs-string">'and'</span>, <span class="hljs-string">'or'</span>, <span class="hljs-string">'cap'</span>, <span class="hljs-string">'cup'</span>, <span class="hljs-string">'int'</span>,
 Â  Â <span class="hljs-string">'there4'</span>, <span class="hljs-string">'sim'</span>, <span class="hljs-string">'cong'</span>, <span class="hljs-string">'asymp'</span>, <span class="hljs-string">'ne'</span>,
 Â  Â <span class="hljs-string">'equiv'</span>, <span class="hljs-string">'le'</span>, <span class="hljs-string">'ge'</span>, <span class="hljs-string">'sub'</span>, <span class="hljs-string">'sup'</span>, <span class="hljs-string">'nsub'</span>,
 Â  Â <span class="hljs-string">'sube'</span>, <span class="hljs-string">'supe'</span>, <span class="hljs-string">'oplus'</span>, <span class="hljs-string">'otimes'</span>, <span class="hljs-string">'perp'</span>,
 Â  Â <span class="hljs-string">'sdot'</span>, <span class="hljs-string">'lceil'</span>, <span class="hljs-string">'rceil'</span>, <span class="hljs-string">'lfloor'</span>, <span class="hljs-string">'rfloor'</span>,
 Â  Â <span class="hljs-string">'lang'</span>, <span class="hljs-string">'rang'</span>, <span class="hljs-string">'loz'</span>, <span class="hljs-string">'spades'</span>, <span class="hljs-string">'clubs'</span>,
 Â  Â <span class="hljs-string">'hearts'</span>, <span class="hljs-string">'diams'</span>, <span class="hljs-string">'ensp'</span>, <span class="hljs-string">'emsp'</span>, <span class="hljs-string">'thinsp'</span>,
 Â  Â <span class="hljs-string">'zwnj'</span>, <span class="hljs-string">'zwj'</span>, <span class="hljs-string">'lrm'</span>, <span class="hljs-string">'rlm'</span>, <span class="hljs-string">'shy'</span>
]);
â€‹
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getEntityEndOrPosition</span>(<span class="hljs-params">html, position, maxLook = <span class="hljs-number">7</span></span>) {
 Â  Â <span class="hljs-comment">// è¾¹ç•Œæ£€æŸ¥</span>
 Â  Â <span class="hljs-keyword">if</span> (position &lt; <span class="hljs-number">0</span> || position &gt;= html.<span class="hljs-property">length</span>) {
 Â  Â  Â  Â <span class="hljs-keyword">return</span> position;
 Â   }
 Â  Â 
 Â  Â <span class="hljs-comment">// å‘å‰æŸ¥æ‰¾&amp;ï¼Œæœ€å¤šæŸ¥æ‰¾maxLookä¸ªå­—ç¬¦</span>
 Â  Â <span class="hljs-keyword">let</span> ampPos = -<span class="hljs-number">1</span>;
 Â  Â <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = position; i &gt;= <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, position - maxLook); i--) {
 Â  Â  Â  Â <span class="hljs-keyword">if</span> (html[i] === <span class="hljs-string">'&amp;'</span>) {
 Â  Â  Â  Â  Â  Â ampPos = i;
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">break</span>;
 Â  Â  Â   }
 Â   }
 Â  Â 
 Â  Â <span class="hljs-comment">// æ²¡æœ‰æ‰¾åˆ°&amp;ï¼Œè¿”å›åŸä½ç½®</span>
 Â  Â <span class="hljs-keyword">if</span> (ampPos === -<span class="hljs-number">1</span>) {
 Â  Â  Â  Â <span class="hljs-keyword">return</span> position;
 Â   }
 Â  Â 
 Â  Â <span class="hljs-comment">// å‘åæŸ¥æ‰¾;ï¼Œæœ€å¤šæŸ¥æ‰¾maxLookä¸ªå­—ç¬¦</span>
 Â  Â <span class="hljs-keyword">let</span> semicolonPos = -<span class="hljs-number">1</span>;
 Â  Â <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = ampPos + <span class="hljs-number">1</span>; i &lt; <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(html.<span class="hljs-property">length</span>, ampPos + maxLook + <span class="hljs-number">1</span>); i++) {
 Â  Â  Â  Â <span class="hljs-keyword">if</span> (html[i] === <span class="hljs-string">';'</span>) {
 Â  Â  Â  Â  Â  Â semicolonPos = i;
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">break</span>;
 Â  Â  Â   }
 Â   }
 Â  Â 
 Â  Â <span class="hljs-comment">// æ²¡æœ‰æ‰¾åˆ°;ï¼Œè¿”å›åŸä½ç½®</span>
 Â  Â <span class="hljs-keyword">if</span> (semicolonPos === -<span class="hljs-number">1</span>) {
 Â  Â  Â  Â <span class="hljs-keyword">return</span> position;
 Â   }
 Â  Â 
 Â  Â <span class="hljs-comment">// æå–&amp;å’Œ;ä¹‹é—´çš„å†…å®¹</span>
 Â  Â <span class="hljs-keyword">const</span> entityContent = html.<span class="hljs-title function_">slice</span>(ampPos + <span class="hljs-number">1</span>, semicolonPos).<span class="hljs-title function_">join</span>(<span class="hljs-string">''</span>);
 Â  Â 
 Â  Â <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦ä¸ºæ•°å­—å®ä½“ï¼ˆ&amp;#123;ï¼‰æˆ–åå…­è¿›åˆ¶å®ä½“ï¼ˆ&amp;#xA0;ï¼‰</span>
 Â  Â <span class="hljs-keyword">if</span> (entityContent.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'#'</span>)) {
 Â  Â  Â  Â <span class="hljs-comment">// æ•°å­—å®ä½“æˆ–åå…­è¿›åˆ¶å®ä½“ï¼Œè¿”å›&amp;ä½ç½®</span>
 Â  Â  Â  Â <span class="hljs-keyword">return</span> ampPos;
 Â   }
 Â  Â 
 Â  Â <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦åœ¨HTMLå®ä½“é›†åˆä¸­</span>
 Â  Â <span class="hljs-keyword">if</span> (<span class="hljs-variable constant_">HTML_ENTITIES</span>.<span class="hljs-title function_">has</span>(entityContent.<span class="hljs-title function_">toLowerCase</span>())) {
 Â  Â  Â  Â <span class="hljs-comment">// æ˜¯æœ‰æ•ˆçš„HTMLå®ä½“ï¼Œè¿”å›&amp;çš„ä½ç½®</span>
 Â  Â  Â  Â <span class="hljs-keyword">return</span> ampPos;
 Â   }
 Â  Â 
 Â  Â <span class="hljs-comment">// ä¸æ˜¯æœ‰æ•ˆçš„HTMLå®ä½“ï¼Œè¿”å›åŸä½ç½®</span>
 Â  Â <span class="hljs-keyword">return</span> position;
}
â€‹
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getImgTagStartIfInside</span>(<span class="hljs-params">htmlArray, position, maxLook = <span class="hljs-number">100</span></span>) {
 Â  Â <span class="hljs-keyword">if</span> (position &lt; <span class="hljs-number">0</span> || position &gt;= htmlArray.<span class="hljs-property">length</span>) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
 Â  Â 
 Â  Â <span class="hljs-comment">// å‘å‰æŸ¥æ‰¾ï¼Œæœ€å¤šmaxLookä¸ªå­—ç¬¦</span>
 Â  Â <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = position-<span class="hljs-number">1</span>; i &gt;= <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, position - maxLook); i--) {
 Â  Â  Â  Â <span class="hljs-comment">// å¦‚æœå…ˆé‡åˆ°&gt;ï¼Œè¯´æ˜åœ¨æ ‡ç­¾å¤–éƒ¨</span>
 Â  Â  Â  Â <span class="hljs-keyword">if</span> (htmlArray[i] === <span class="hljs-string">'&gt;'</span>) {
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
 Â  Â  Â   }
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// å¦‚æœé‡åˆ°&lt;ï¼Œæ£€æŸ¥æ˜¯å¦æ˜¯&lt;img</span>
 Â  Â  Â  Â <span class="hljs-keyword">if</span> (htmlArray[i] === <span class="hljs-string">'&lt;'</span>) {
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æ˜¯&lt;imgæ ‡ç­¾</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> (i + <span class="hljs-number">3</span> &lt; htmlArray.<span class="hljs-property">length</span> &amp;&amp;
 Â  Â  Â  Â  Â  Â  Â  Â htmlArray[i + <span class="hljs-number">1</span>].<span class="hljs-title function_">toLowerCase</span>() === <span class="hljs-string">'i'</span> &amp;&amp;
 Â  Â  Â  Â  Â  Â  Â  Â htmlArray[i + <span class="hljs-number">2</span>].<span class="hljs-title function_">toLowerCase</span>() === <span class="hljs-string">'m'</span> &amp;&amp;
 Â  Â  Â  Â  Â  Â  Â  Â htmlArray[i + <span class="hljs-number">3</span>].<span class="hljs-title function_">toLowerCase</span>() === <span class="hljs-string">'g'</span>) {
 Â  Â  Â  Â  Â  Â  Â  Â 
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// ç¡®ä¿imgåé¢æ˜¯ç©ºæ ¼ã€&gt;æˆ–/ï¼ˆé¿å…åŒ¹é…&lt;imagine&gt;ç­‰ï¼‰</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> (i + <span class="hljs-number">4</span> &lt; htmlArray.<span class="hljs-property">length</span>) {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">const</span> nextChar = htmlArray[i + <span class="hljs-number">4</span>];
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> (nextChar !== <span class="hljs-string">' '</span> &amp;&amp; nextChar !== <span class="hljs-string">'&gt;'</span> &amp;&amp; nextChar !== <span class="hljs-string">'/'</span>) {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
 Â  Â  Â  Â  Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â  Â  Â 
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// æ˜¯&lt;imgæ ‡ç­¾ï¼Œè¿”å›å¼€å§‹ä½ç½®</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> i;
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â 
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// æ˜¯å…¶ä»–æ ‡ç­¾ï¼Œä¸åœ¨imgå†…éƒ¨</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
 Â  Â  Â   }
 Â   }
 Â  Â 
 Â  Â <span class="hljs-comment">// æ²¡æ‰¾åˆ°&lt;ï¼Œä¹Ÿä¸åœ¨imgå†…éƒ¨</span>
 Â  Â <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
}
</code></pre>
<h3 data-id="heading-7">æ³¨æ„äº‹é¡¹</h3>
<ol>
<li><strong>æ›´æ–°é£é™©</strong>ï¼šç›´æ¥ä¿®æ”¹åŸå‹æ–¹æ³•å¯èƒ½åœ¨æ’ä»¶æ›´æ–°æ—¶å¤±æ•ˆ</li>
</ol>
<h3 data-id="heading-8">ç»“è¯­</h3>
<p>ä»¥è¿™ç§æ–¹å¼å¤„ç†çš„å¯Œæ–‡æœ¬æ•°æ®ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥è§£å†³å¯¹åº”æˆªæ–­é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœéœ€è¦æ›´åŠ å®Œå–„çš„è§£å†³æ–¹æ³•ï¼Œè¿˜æ˜¯å¾—å†™ä¸€å¥—å®Œæ•´çš„å¯Œæ–‡æœ¬è§£æï¼ŒåµŒå…¥åˆ°longTextçš„æ–¹æ³•ä¸­ï¼Œæäº¤ç»™vue-plugin-hiprintçš„ä½œè€…ã€‚æŠ›ç –å¼•ç‰ï¼Œå¸Œæœ›æœ‰å“ªä½å¤§ç¥å®Œå–„ä¸€ä¸‹å§~~~</p>
<p>å¦‚æœæ–‡ç« ä½ æœ‰æ‰€å¸®åŠ©ï¼Œè¿˜è¯·ä¸åå•¬æ‚¨çš„ç‚¹èµğŸ‘ğŸ‘ğŸ‘</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SpringBoot è¯¥ä¸è¯¥ç”¨ç»Ÿä¸€åŒ…è£…ç±»]]></title>    <link>https://juejin.cn/post/7587312329174171702</link>    <guid>https://juejin.cn/post/7587312329174171702</guid>    <pubDate>2025-12-25T00:20:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587312329174171702" data-draft-id="7587312329173139510" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" SpringBoot è¯¥ä¸è¯¥ç”¨ç»Ÿä¸€åŒ…è£…ç±»"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-25T00:20:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é£è±¡å—"/> <meta itemprop="url" content="https://juejin.cn/user/2524134428655159"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             SpringBoot è¯¥ä¸è¯¥ç”¨ç»Ÿä¸€åŒ…è£…ç±»
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2524134428655159/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é£è±¡å—
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T00:20:49.000Z" title="Thu Dec 25 2025 00:20:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    53
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨SpringBooté¡¹ç›®ä¸­ï¼Œä½ ä¸€å®šè§è¿‡è¿™æ ·çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@GetMapping("/user/{id}")</span>
<span class="hljs-keyword">public</span> Result&lt;User&gt; <span class="hljs-title function_">getUser</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id)</span> {
    <span class="hljs-keyword">return</span> Result.success(userService.getById(id));
}
</code></pre>
<p>æˆ–è€…è¿™æ ·çš„ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@GetMapping("/user/{id}")</span>
<span class="hljs-keyword">public</span> User <span class="hljs-title function_">getUser</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id)</span> {
    <span class="hljs-keyword">return</span> userService.getById(id);
}
</code></pre>
<p>æ”¯æŒç»Ÿä¸€åŒ…è£…çš„äººè®¤ä¸ºè¿™æ ·åšè§„èŒƒã€ç»Ÿä¸€ï¼Œå‰ç«¯å¯¹æ¥æ–¹ä¾¿ï¼›åå¯¹çš„äººåˆ™è®¤ä¸ºè¿™æ˜¯å¤šæ­¤ä¸€ä¸¾ï¼Œå¢åŠ äº†ä»£ç å¤æ‚åº¦ï¼Œè€Œä¸”HTTPæœ¬èº«å°±æœ‰çŠ¶æ€ç ä½“ç³»ï¼Œæ²¡å¿…è¦é‡æ–°å‘æ˜è½®å­ã€‚</p>
<p>ä»Šå¤©ä»å®é™…ä½¿ç”¨åœºæ™¯å‡ºå‘ï¼ŒæŠŠè¿™ä¸ªé—®é¢˜æ¢³ç†æ¸…æ¥šï¼Œå¸Œæœ›èƒ½ç»™ä½ ä¸€äº›å‚è€ƒã€‚</p>
<h2 data-id="heading-0">å…ˆè¯´æ¸…æ¥šä»€ä¹ˆæ˜¯ç»Ÿä¸€åŒ…è£…ç±»</h2>
<p>æ‰€è°“ç»Ÿä¸€åŒ…è£…ç±»ï¼Œå°±æ˜¯å°†ä¸šåŠ¡æ•°æ®å†åŒ…ä¸€å±‚ï¼Œå¸¸è§å½¢æ€å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å½¢æ€ä¸€ï¼šcode + msg + data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Result</span>&lt;T&gt; {
    <span class="hljs-keyword">private</span> Integer code;
    <span class="hljs-keyword">private</span> String msg;
    <span class="hljs-keyword">private</span> T data;
}

<span class="hljs-comment">// å½¢æ€äºŒï¼šå¸¦ä¸Šæ—¶é—´æˆ³ã€traceIdç­‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Response</span>&lt;T&gt; {
    <span class="hljs-keyword">private</span> Integer code;
    <span class="hljs-keyword">private</span> String msg;
    <span class="hljs-keyword">private</span> T data;
    <span class="hljs-keyword">private</span> Long timestamp;
    <span class="hljs-keyword">private</span> String traceId;
}
</code></pre>
<p>è¿™æ ·åŒ…è£…çš„ç†ç”±ä¸»è¦æœ‰ä¸‰ä¸ªï¼š</p>
<p>ç¬¬ä¸€ï¼Œå‰ç«¯è§£ææ–¹ä¾¿ã€‚æ‰€æœ‰æ¥å£è¿”å›ç»“æ„ä¸€è‡´ï¼Œå‰ç«¯åªéœ€è¦å†™ä¸€å¥—è§£æé€»è¾‘ï¼Œä¸éœ€è¦æ¯ä¸ªæ¥å£å•ç‹¬å¤„ç†ã€‚</p>
<p>ç¬¬äºŒï¼Œå¯ä»¥æºå¸¦ä¸šåŠ¡é”™è¯¯ç ã€‚æ¯”å¦‚"ç”¨æˆ·ä¸å­˜åœ¨"å¯¹åº”10001ï¼Œ"ä½™é¢ä¸è¶³"å¯¹åº”10002ï¼Œ"å‚æ•°æ ¡éªŒå¤±è´¥"å¯¹åº”10003ï¼Œå‰ç«¯å¯ä»¥æ ¹æ®ä¸åŒçš„é”™è¯¯ç åšä¸åŒçš„å¤„ç†ï¼Œæ¯”å¦‚10002ç›´æ¥è·³è½¬åˆ°å……å€¼é¡µé¢ã€‚</p>
<p>ç¬¬ä¸‰ï¼Œæ–¹ä¾¿ç»Ÿä¸€åšå¼‚å¸¸è½¬æ¢ã€‚é€šè¿‡ <code>@ControllerAdvice</code> å¯ä»¥æŠŠæ‰€æœ‰å¼‚å¸¸ç»Ÿä¸€è½¬æ¢æˆ <code>Result</code> æ ¼å¼ï¼Œé¿å…å¼‚å¸¸ä¿¡æ¯ç›´æ¥æš´éœ²ç»™å‰ç«¯ã€‚</p>
<p>ä¸Šé¢ä¸»è¦ä»‹ç»äº†åŒ…è£…ç±»çš„ä¸€äº›ç‰¹ç‚¹ï¼Œä¸‹é¢æˆ‘ä»¬å†çœ‹çœ‹åŒ…è£…åŠä¸åŒ…è£…çš„ä¸‰ç§å¸¸è§æ–¹æ¡ˆçš„å…·ä½“å®ç°æ–¹å¼å’Œä¼˜ç¼ºç‚¹ã€‚</p>
<h2 data-id="heading-1">ä¸‰ç§å¸¸è§æ–¹æ¡ˆ</h2>
<h4 data-id="heading-2">æ–¹æ¡ˆä¸€ï¼šæ‰‹åŠ¨åŒ…è£…</h4>
<p>æ¯ä¸ªæ¥å£è‡ªå·±åŠ¨æ‰‹åŒ…ä¸€å±‚ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@GetMapping("/user/{id}")</span>
<span class="hljs-keyword">public</span> Result&lt;User&gt; <span class="hljs-title function_">getUser</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id)</span> {
    <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> userService.getById(id);
    <span class="hljs-keyword">return</span> Result.success(user);
}

<span class="hljs-meta">@PostMapping("/user")</span>
<span class="hljs-keyword">public</span> Result&lt;Long&gt; <span class="hljs-title function_">createUser</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> UserCreateDTO dto)</span> {
    <span class="hljs-type">Long</span> <span class="hljs-variable">userId</span> <span class="hljs-operator">=</span> userService.create(dto);
    <span class="hljs-keyword">return</span> Result.success(userId);
}
</code></pre>
<p>è¿™ç§æ–¹å¼çš„å¥½å¤„æ˜¯æ˜ç¡®ã€å¯æ§ã€‚ä½ åœ¨ä»£ç é‡Œä¸€çœ¼å°±èƒ½çœ‹å‡ºè¿™ä¸ªæ¥å£è¿”å›çš„æ˜¯ä»€ä¹ˆï¼Œæƒ³æç‰¹æ®Šä¹Ÿå¾ˆæ–¹ä¾¿ï¼Œç›´æ¥è¿”å› <code>ResponseEntity</code> å°±è¡Œã€‚</p>
<p>ä½†å†™å¤šäº†ä½ ä¼šè§‰å¾—å¾ˆç¹çï¼Œæ»¡å±éƒ½æ˜¯ <code>Result.success()</code>ã€<code>Result.error()</code>ï¼Œæ”¹èµ·æ¥ä¹Ÿå¾ˆéº»çƒ¦ã€‚è€Œä¸”è¿™ç§æ–¹å¼æœ‰ä¸ªæ›´å¤§çš„é—®é¢˜ï¼šæŸäº›åœºæ™¯æ ¹æœ¬æ— æ³•åŒ…è£…ã€‚</p>
<p>æœ€å…¸å‹çš„å°±æ˜¯æ–‡ä»¶ä¸‹è½½ã€‚æ–‡ä»¶ä¸‹è½½éœ€è¦è®¾ç½® <code>Content-Disposition</code> å“åº”å¤´ï¼ŒæŒ‡å®šæ–‡ä»¶åï¼Œè¿˜éœ€è¦è®¾ç½®æ­£ç¡®çš„ <code>Content-Type</code>ï¼Œå¦‚æœç”¨ <code>Result</code> åŒ…ä¸€ä¸‹ï¼Œè¿™äº›éƒ½æ²¡æ³•å¤„ç†äº†ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@GetMapping("/download")</span>
<span class="hljs-keyword">public</span> ResponseEntity&lt;ByteArrayResource&gt; <span class="hljs-title function_">download</span><span class="hljs-params">()</span> {
    <span class="hljs-type">byte</span>[] data = fileService.getReport();
    <span class="hljs-keyword">return</span> ResponseEntity.ok()
        .header(<span class="hljs-string">"Content-Disposition"</span>, <span class="hljs-string">"attachment; filename=report.xlsx"</span>)
        .contentType(MediaType.APPLICATION_OCTET_STREAM)
        .body(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayResource</span>(data));
}
</code></pre>
<p><code>ResponseEntity</code> éœ€è¦ç›´æ¥è¿”å›ï¼Œæ— æ³•å¡è¿› <code>Result</code> é‡Œã€‚ç±»ä¼¼çš„åœºæ™¯è¿˜æœ‰ SSE æ¨é€ã€æ–‡ä»¶æµã€å›¾ç‰‡ç›´æ¥è¾“å‡ºç­‰ã€‚</p>
<p>æ‰€ä»¥å¦‚æœé‡‡ç”¨æ‰‹åŠ¨åŒ…è£…çš„æ–¹æ¡ˆï¼Œä½ è¿˜éœ€è¦åœ¨æ–‡æ¡£é‡Œæ˜ç¡®çº¦å®šå“ªäº›æ¥å£éœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œå¢åŠ ç»´æŠ¤æˆæœ¬ã€‚</p>
<h4 data-id="heading-3">æ–¹æ¡ˆäºŒï¼šä¸åŒ…è£…ï¼Œç›´æ¥è¿”å›</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@GetMapping("/user/{id}")</span>
<span class="hljs-keyword">public</span> User <span class="hljs-title function_">getUser</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id)</span> {
    <span class="hljs-keyword">return</span> userService.getById(id);
}

<span class="hljs-meta">@PostMapping("/user")</span>
<span class="hljs-keyword">public</span> Long <span class="hljs-title function_">createUser</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> UserCreateDTO dto)</span> {
    <span class="hljs-keyword">return</span> userService.create(dto);
}
</code></pre>
<p>è¿™ç§æ–¹å¼ä»£ç ç®€æ´ï¼Œæ²¡æœ‰å†—ä½™ï¼Œé€šç”¨æ€§å¥½ï¼ˆæ¯”å¦‚ä¸€äº›è´Ÿè½½ã€ç½‘å…³è®¾å¤‡é»˜è®¤è¯†åˆ«çš„æ˜¯æ ‡å‡†HTTPçŠ¶æ€ç ï¼‰ï¼ŒSwagger ç”Ÿæˆçš„æ–‡æ¡£ä¹Ÿå¾ˆæ¸…æ™°ï¼Œå‰ç«¯ä¸€çœ¼å°±èƒ½çœ‹å‡ºè¿™ä¸ªæ¥å£è¿”å›ä»€ä¹ˆç»“æ„ã€‚</p>
<p>å¼‚å¸¸å¤„ç†æ€ä¹ˆè§£å†³å‘¢ï¼Ÿé€šè¿‡ <code>@ControllerAdvice</code> + <code>@ExceptionHandler</code>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RestControllerAdvice</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GlobalExceptionHandler</span> {

    <span class="hljs-meta">@ExceptionHandler(BusinessException.class)</span>
    <span class="hljs-keyword">public</span> ResponseEntity&lt;ErrorResponse&gt; <span class="hljs-title function_">handleBusiness</span><span class="hljs-params">(BusinessException e)</span> {
        <span class="hljs-keyword">return</span> ResponseEntity
            .status(e.getHttpStatus())  <span class="hljs-comment">// 404ã€400ç­‰HTTPçŠ¶æ€ç </span>
            .body(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ErrorResponse</span>(e.getMessage()));
    }

    <span class="hljs-meta">@ExceptionHandler(Exception.class)</span>
    <span class="hljs-keyword">public</span> ResponseEntity&lt;ErrorResponse&gt; <span class="hljs-title function_">handleUnknown</span><span class="hljs-params">(Exception e)</span> {
        log.error(<span class="hljs-string">"ç³»ç»Ÿå¼‚å¸¸"</span>, e);
        <span class="hljs-keyword">return</span> ResponseEntity
            .status(HttpStatus.INTERNAL_SERVER_ERROR)
            .body(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ErrorResponse</span>(<span class="hljs-string">"ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åé‡è¯•"</span>));
    }
}
</code></pre>
<p>è¿™ç§æ–¹å¼ç›´æ¥ä½¿ç”¨ HTTP æ ‡å‡†çŠ¶æ€ç ï¼š200 è¡¨ç¤ºæˆåŠŸï¼Œ404 è¡¨ç¤ºèµ„æºä¸å­˜åœ¨ï¼Œ400 è¡¨ç¤ºå‚æ•°é”™è¯¯ï¼Œ401 è¡¨ç¤ºæœªç™»å½•ï¼Œ403 è¡¨ç¤ºæ— æƒé™ï¼Œ500 è¡¨ç¤ºæœåŠ¡å™¨é”™è¯¯ã€‚ä¸éœ€è¦å†å®šä¹‰ä¸€å¥—ä¸šåŠ¡é”™è¯¯ç ï¼Œå‰ç«¯ä¹Ÿæ›´å®¹æ˜“ç†è§£ã€‚</p>
<p>ä¸è¿‡æœ‰äº›å›¢é˜Ÿä¹ æƒ¯äº†è‡ªå·±å®šä¹‰é”™è¯¯ç ä½“ç³»ï¼Œæ¯”å¦‚ 10001ã€10002 è¿™ç§ï¼Œè§‰å¾— HTTP çŠ¶æ€ç ä¸å¤Ÿç»†åˆ†ã€‚å…¶å®å¤§å¯ä¸å¿…ï¼ŒHTTP çŠ¶æ€ç å·²ç»è¶³å¤Ÿè¦†ç›–å¤§éƒ¨åˆ†åœºæ™¯äº†ï¼ŒçœŸéœ€è¦ç»†åˆ†å¯ä»¥é€šè¿‡é”™è¯¯æ¶ˆæ¯æ¥åŒºåˆ†ã€‚</p>
<p>æ¥å—è¿™ç§æ–¹å¼çš„å‰ææ˜¯å›¢é˜Ÿç»Ÿä¸€è®¤çŸ¥ï¼Œä¸å†æè‡ªå®šä¹‰é”™è¯¯ç é‚£å¥—ã€‚å¦‚æœå›¢é˜Ÿå·²ç»æœ‰ä¸€å¥—æˆç†Ÿçš„é”™è¯¯ç ä½“ç³»ï¼Œè¿ç§»æˆæœ¬ä¼šæ¯”è¾ƒé«˜ã€‚</p>
<h4 data-id="heading-4">æ–¹æ¡ˆä¸‰ï¼šResponseBodyAdviceè‡ªåŠ¨åŒ…è£…</h4>
<p>è¿™æ˜¯ä¸€ç§æŠ˜ä¸­æ–¹æ¡ˆï¼ŒController ä»£ç ä¿æŒç®€æ´ï¼Œç”±æ¡†æ¶è‡ªåŠ¨åŒ…è£…ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RestControllerAdvice</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ResponseAdvice</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ResponseBodyAdvice</span>&lt;Object&gt; {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">supports</span><span class="hljs-params">(MethodParameter returnType, Class converterType)</span> {
        <span class="hljs-keyword">return</span> !returnType.hasMethodAnnotation(NoWrap.class);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">beforeBodyWrite</span><span class="hljs-params">(Object body, MethodParameter returnType,
            MediaType selectedContentType, Class selectedConverterType,
            ServerHttpRequest request, ServerHttpResponse response)</span> {
        <span class="hljs-keyword">if</span> (body <span class="hljs-keyword">instanceof</span> Result) {
            <span class="hljs-keyword">return</span> body;
        }
        <span class="hljs-keyword">return</span> Result.success(body);
    }
}
</code></pre>
<p>Controller é‡Œå°±å¯ä»¥ç›´æ¥å†™ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@GetMapping("/user/{id}")</span>
<span class="hljs-keyword">public</span> User <span class="hljs-title function_">getUser</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id)</span> {
    <span class="hljs-keyword">return</span> userService.getById(id);  <span class="hljs-comment">// è¢«è‡ªåŠ¨åŒ…è£…æˆ Result&lt;User&gt;</span>
}
</code></pre>
<p>è¿™ä¸ªæ–¹æ¡ˆçœ‹èµ·æ¥å¾ˆå®Œç¾ï¼ŒController ä»£ç ç®€æ´ï¼Œè¿”å›æ ¼å¼åˆç»Ÿä¸€ã€‚ä½†å®é™…ç”¨èµ·æ¥æœ‰å‡ ä¸ªå‘éœ€è¦ç‰¹åˆ«æ³¨æ„ã€‚</p>
<p>ç¬¬ä¸€ä¸ªå‘æ˜¯ String ç±»å‹çš„ç‰¹æ®Šå¤„ç†ã€‚Spring çš„æ¶ˆæ¯è½¬æ¢å™¨é“¾åœ¨å¤„ç† String æ—¶ï¼Œä¼šä¼˜å…ˆä½¿ç”¨ <code>StringHttpMessageConverter</code>ï¼Œå¦‚æœæˆ‘ä»¬è¿”å› <code>Result&lt;String&gt;</code>ï¼Œä¼šå¯¼è‡´ç±»å‹è½¬æ¢å¼‚å¸¸ã€‚æ‰€ä»¥éœ€è¦å•ç‹¬åˆ¤æ–­ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">if</span> (body <span class="hljs-keyword">instanceof</span> String) {
    <span class="hljs-keyword">return</span> objectMapper.writeValueAsString(Result.success(body));
}
</code></pre>
<p>ç¬¬äºŒä¸ªå‘æ˜¯è°ƒè¯•ä¸ç›´è§‚ã€‚å‰ç«¯æ”¶åˆ°æ•°æ®æ ¼å¼ä¸å¯¹ï¼Œä½ ç¬¬ä¸€ååº”æ˜¯çœ‹ Controller ä»£ç ï¼Œä½†ä»£ç æ˜æ˜å†™å¾—å¾ˆæ­£å¸¸å•Šï¼Œæœ€åæ’æŸ¥åŠå¤©æ‰å‘ç°æ˜¯ ResponseAdvice é‡Œçš„é€»è¾‘å‡ºäº†é—®é¢˜ã€‚è¿™ç§éšå¼çš„åŒ…è£…ï¼Œå¯¹ä¸ç†Ÿæ‚‰ä»£ç çš„äººæ¥è¯´å°±æ˜¯ä¸ªé»‘ç›’ï¼Œè°ƒè¯•æˆæœ¬è¾ƒé«˜ã€‚</p>
<p>ç¬¬ä¸‰ä¸ªå‘æ˜¯ç‰¹æ®Šè¿”å›ç±»å‹éœ€è¦æ’é™¤ã€‚<code>ResponseEntity</code>ã€<code>SseEmitter</code>ã€<code>StreamingResponseBody</code> è¿™äº›ç±»å‹ä¸èƒ½è¢«åŒ…è£…ï¼Œå¦åˆ™å°±åºŸäº†ã€‚ä½ éœ€è¦åœ¨ <code>supports()</code> æ–¹æ³•é‡ŒæŠŠè¿™äº›ç±»å‹æ’é™¤æ‰ï¼Œæˆ–è€…å®šä¹‰ä¸€ä¸ª <code>@NoWrap</code> æ³¨è§£ï¼Œéœ€è¦ä¾‹å¤–çš„æ¥å£è‡ªå·±æ ‡æ³¨ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">supports</span><span class="hljs-params">(MethodParameter returnType, Class converterType)</span> {
    <span class="hljs-comment">// æ’é™¤ ResponseEntity</span>
    <span class="hljs-keyword">if</span> (ResponseEntity.class.isAssignableFrom(returnType.getParameterType())) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    <span class="hljs-comment">// æ’é™¤æ ‡æ³¨äº† @NoWrap çš„æ–¹æ³•</span>
    <span class="hljs-keyword">return</span> !returnType.hasMethodAnnotation(NoWrap.class);
}
</code></pre>
<h2 data-id="heading-5">æŒ‰åœºæ™¯é€‰æ‹©</h2>
<p>ä¸‰ç§æ–¹æ¡ˆæ²¡æœ‰ç»å¯¹ä¼˜åŠ£ï¼Œå…³é”®æ˜¯æ ¹æ®åœºæ™¯é€‰æ‹©ã€‚</p>






























<table><thead><tr><th>åœºæ™¯</th><th>å»ºè®®æ–¹æ¡ˆ</th><th>ç†ç”±</th></tr></thead><tbody><tr><td>å†…éƒ¨å‰åç«¯å¯¹æ¥æ¥å£</td><td>ç»Ÿä¸€åŒ…è£…</td><td>å‰ç«¯è§£æçœå¿ƒï¼Œåªéœ€ä¸€å¥—é€»è¾‘</td></tr><tr><td>å¯¹å¤–å¼€æ”¾ RESTful API</td><td>ç›´æ¥è¿”å›</td><td>HTTP çŠ¶æ€ç è¯­ä¹‰æ›´æ¸…æ™°ï¼Œç¬¦åˆRESTè§„èŒƒ</td></tr><tr><td>æ–‡ä»¶ä¸‹è½½/æµå¼æ¥å£</td><td>ç›´æ¥è¿”å›</td><td>æ— æ³•åŒ…è£…ï¼Œå¿…é¡»ç›´æ¥æ§åˆ¶å“åº”</td></tr><tr><td>ç¬¬ä¸‰æ–¹å›è°ƒæ¥å£</td><td>æŒ‰å¯¹æ–¹è¦æ±‚</td><td>å¯¹æ–¹è§„å®šä»€ä¹ˆæ ¼å¼å°±è¿”å›ä»€ä¹ˆæ ¼å¼</td></tr></tbody></table>
<p>å…·ä½“é¡¹ç›®ä¸­å¯èƒ½ä¼šå‡ºç°å¤šç§æ–¹æ¡ˆæ··ç”¨çš„æƒ…å†µï¼Œå¯ä»¥é€šè¿‡ä¸‰ç§æ–¹å¼åŒºåˆ†æ˜¯å¦è¿”å›åŒ…è£…å¯¹è±¡ï¼š</p>
<h4 data-id="heading-6">æ–¹å¼ä¸€ï¼šæŒ‰æ¥å£è·¯å¾„</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">supports</span><span class="hljs-params">(MethodParameter returnType, Class converterType)</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">path</span> <span class="hljs-operator">=</span> getPath();
    <span class="hljs-comment">// åªæœ‰ /api å¼€å¤´çš„å†…éƒ¨æ¥å£æ‰åŒ…è£…</span>
    <span class="hljs-keyword">return</span> path != <span class="hljs-literal">null</span> &amp;&amp; path.startsWith(<span class="hljs-string">"/api/"</span>);
}
</code></pre>
<p>çº¦å®š <code>/api</code> å¼€å¤´çš„æ˜¯å†…éƒ¨æ¥å£ï¼Œè‡ªåŠ¨åŒ…è£…ï¼›å…¶ä»–è·¯å¾„ä¿æŒåŸæ ·ã€‚è¿™ç§æ–¹å¼ç®€å•ç²—æš´ï¼Œä¸éœ€è¦æ”¹åŠ¨ä»»ä½•ä¸šåŠ¡ä»£ç ï¼Œä½†éœ€è¦å›¢é˜Ÿéµå®ˆè·¯å¾„è§„èŒƒã€‚</p>
<h4 data-id="heading-7">æ–¹å¼äºŒï¼šæŒ‰æ³¨è§£</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@GetMapping("/download")</span>
<span class="hljs-meta">@NoWrap</span>
<span class="hljs-keyword">public</span> ResponseEntity&lt;ByteArrayResource&gt; <span class="hljs-title function_">download</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// ...</span>
}

<span class="hljs-meta">@GetMapping("/user/{id}")</span>
<span class="hljs-keyword">public</span> User <span class="hljs-title function_">getUser</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id)</span> {
    <span class="hljs-comment">// é»˜è®¤åŒ…è£…</span>
}
</code></pre>
<p>å®šä¹‰ä¸€ä¸ª <code>@NoWrap</code> æ³¨è§£ï¼Œéœ€è¦ä¾‹å¤–çš„æ¥å£æ ‡æ³¨ä¸€ä¸‹ã€‚è¿™ç§æ–¹å¼çµæ´»ï¼Œä½†ç¼ºç‚¹æ˜¯å®¹æ˜“æ¼ï¼Œæ¯æ¬¡æ–°å¢ç‰¹æ®Šæ¥å£éƒ½å¾—è®°å¾—åŠ æ³¨è§£ã€‚</p>
<h4 data-id="heading-8">æ–¹å¼ä¸‰ï¼šæŒ‰è¿”å›ç±»å‹</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">supports</span><span class="hljs-params">(MethodParameter returnType, Class converterType)</span> {
    Class&lt;?&gt; type = returnType.getParameterType();
    <span class="hljs-comment">// ResponseEntityã€SseEmitter ç­‰ç±»å‹ä¸åŒ…è£…</span>
    <span class="hljs-keyword">if</span> (ResponseEntity.class.isAssignableFrom(type) ||
        SseEmitter.class.isAssignableFrom(type) ||
        StreamingResponseBody.class.isAssignableFrom(type)) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}
</code></pre>
<p>è¿™ç§æ–¹å¼æœ€çœå¿ƒï¼Œä¸ç”¨è®°è·¯å¾„è§„èŒƒä¹Ÿä¸ç”¨åœ¨æ¯ä¸ªæ¥å£ä¸ŠåŠ æ³¨è§£ï¼Œæ¡†æ¶è‡ªåŠ¨è¯†åˆ«ç‰¹æ®Šç±»å‹ã€‚ä½†å‰ææ˜¯ä½ çš„ä»£ç é£æ ¼è¦ç»Ÿä¸€ï¼Œä¸è¦ä¸€ä¼šå„¿ç”¨ <code>ResponseEntity</code>ï¼Œä¸€ä¼šå„¿ç”¨ <code>Result</code>ã€‚</p>
<h2 data-id="heading-9">æ€»ç»“</h2>
<p>æ— è®ºé€‰å“ªç§æ–¹æ¡ˆï¼Œå…³é”®æ˜¯è§„åˆ™æ¸…æ™°å¹¶æ‰§è¡Œåˆ°ä½ã€‚å‰ç«¯å¯¹æ¥çš„æˆæœ¬ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºèƒ½ä¸èƒ½æŠŠè§„åˆ™è¯´æ¸…æ¥šå¹¶åšæŒæ‰§è¡Œä¸‹å»ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Kotlin Flow çš„ emit å’Œ tryEmit æœ‰ä»€ä¹ˆåŒºåˆ« ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7587342120021999667</link>    <guid>https://juejin.cn/post/7587342120021999667</guid>    <pubDate>2025-12-25T03:45:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587342120021999667" data-draft-id="7580815599351595023" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Kotlin Flow çš„ emit å’Œ tryEmit æœ‰ä»€ä¹ˆåŒºåˆ« ï¼Ÿ"/> <meta itemprop="keywords" content="Kotlin,Android,Android Jetpack"/> <meta itemprop="datePublished" content="2025-12-25T03:45:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="QING618"/> <meta itemprop="url" content="https://juejin.cn/user/339115460529117"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Kotlin Flow çš„ emit å’Œ tryEmit æœ‰ä»€ä¹ˆåŒºåˆ« ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/339115460529117/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    QING618
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T03:45:45.000Z" title="Thu Dec 25 2025 03:45:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ Kotlin Flow ä¸­ï¼Œ<code>emit()</code>Â å’ŒÂ <code>tryEmit()</code>Â éƒ½ç”¨äºå‘ Flow å‘é€å€¼ï¼Œä½†å®ƒä»¬çš„å…³é”®åŒºåˆ«åœ¨äº<strong>èƒŒå‹å¤„ç†</strong>å’Œ<strong>åç¨‹ä¸Šä¸‹æ–‡</strong>ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ä¸»è¦åŒºåˆ«</h2>
<h4 data-id="heading-1">1.Â emit()</h4>
<ul>
<li><strong>æŒ‚èµ·å‡½æ•°</strong>ï¼šä¼šæŒ‚èµ·ç›´åˆ°æœ‰ç©ºé—´æ¥æ”¶å€¼ï¼ˆå¤„ç†èƒŒå‹ï¼‰</li>
<li><strong>åç¨‹å®‰å…¨</strong>ï¼šåªèƒ½åœ¨åç¨‹ä½œç”¨åŸŸä¸­è°ƒç”¨</li>
<li><strong>æ¨èä½¿ç”¨</strong>ï¼šåœ¨Â <code>collect</code>Â æˆ–Â <code>callbackFlow</code>Â ä¸­ä¼˜å…ˆä½¿ç”¨</li>
</ul>
<pre><code class="hljs language-kotlin" lang="kotlin">flow {
    <span class="hljs-comment">// ä¼šæŒ‚èµ·ç›´åˆ°æ¥æ”¶æ–¹å‡†å¤‡å¥½</span>
    emit(<span class="hljs-number">1</span>)
    emit(<span class="hljs-number">2</span>)
}
</code></pre>
<h4 data-id="heading-2">2.Â tryEmit()</h4>
<ul>
<li><strong>éæŒ‚èµ·å‡½æ•°</strong>ï¼šå°è¯•ç«‹å³å‘å°„å€¼ï¼Œå¦‚æœæ¥æ”¶æ–¹æœªå‡†å¤‡å¥½åˆ™è¿”å›Â <code>false</code></li>
<li><strong>å¯èƒ½ä¸¢æ•°æ®</strong>ï¼šè¿”å›Â <code>false</code>Â æ—¶å€¼ä¼šè¢«ä¸¢å¼ƒ</li>
<li><strong>æœ‰é™åœºæ™¯</strong>ï¼šä¸»è¦åœ¨ MutableStateFlow å’Œ MutableSharedFlow ä¸­ä½¿ç”¨</li>
</ul>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> _state = MutableStateFlow(<span class="hljs-number">0</span>)

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">updateValue</span><span class="hljs-params">(newValue: <span class="hljs-type">Int</span>)</span></span> {
    <span class="hljs-comment">// å°è¯•å‘å°„ï¼Œå¦‚æœå¤±è´¥åˆ™ä¸¢å¼ƒ</span>
    <span class="hljs-keyword">val</span> success = _state.tryEmit(newValue)
    <span class="hljs-keyword">if</span> (!success) {
        <span class="hljs-comment">// å¤„ç†å‘å°„å¤±è´¥çš„æƒ…å†µ</span>
    }
}
</code></pre>
<h2 data-id="heading-3">äºŒã€ä½¿ç”¨åœºæ™¯å¯¹æ¯”</h2>
<h4 data-id="heading-4">1. ä½¿ç”¨ emit() çš„åœºæ™¯</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// 1. åœ¨ flow {} æ„å»ºå™¨ä¸­</span>
flow {
    <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1.</span><span class="hljs-number">.10</span>) {
        delay(<span class="hljs-number">100</span>)
        emit(i)  <span class="hljs-comment">// âœ… æ­£ç¡®</span>
    }
}

<span class="hljs-comment">// 2. åœ¨ callbackFlow ä¸­</span>
callbackFlow {
    callback.setOnData { <span class="hljs-keyword">data</span> -&gt;
        trySend(<span class="hljs-keyword">data</span>)  <span class="hljs-comment">// callbackFlow ç‰¹æ®Šæ–¹æ³•</span>
    }
    awaitClose { callback.removeListener() }
}
</code></pre>
<h4 data-id="heading-5">2. ä½¿ç”¨ tryEmit() çš„åœºæ™¯</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ä¸»è¦åœ¨ MutableStateFlow/MutableSharedFlow ä¸­</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewModel</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _uiState = MutableStateFlow&lt;UiState&gt;(Loading)
    <span class="hljs-keyword">val</span> uiState: StateFlow&lt;UiState&gt; = _uiState
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">update</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// éæŒ‚èµ·å‡½æ•°ä¸­å°è¯•æ›´æ–°çŠ¶æ€</span>
        <span class="hljs-keyword">if</span> (!_uiState.tryEmit(Success(<span class="hljs-keyword">data</span>))) {
            <span class="hljs-comment">// å¤„ç†èƒŒå‹ï¼ˆé€šå¸¸æ—¥å¿—è®°å½•ï¼‰</span>
        }
    }
}
</code></pre>
<h4 data-id="heading-6">3. ä¸‹é¢æ˜¯ä¸€ä¸ªå°è¡¨æ ¼ï¼Œå¯ä»¥å¸®åŠ©å¿«é€Ÿäº†è§£ä½•æ—¶ä½¿ç”¨Â <code>emit</code>Â å’ŒÂ <code>tryEmit</code>ï¼š</h4>



































<table><thead><tr><th>åœºæ™¯</th><th>ä½¿ç”¨ emit</th><th>ä½¿ç”¨ tryEmit</th></tr></thead><tbody><tr><td>åœ¨æŒ‚èµ·å‡½æ•°å†…éƒ¨</td><td>æ˜¯</td><td>é¿å…ä½¿ç”¨ï¼ˆé™¤ééå¸¸ç´§æ€¥ï¼‰</td></tr><tr><td>UI ç‚¹å‡»æˆ–ç”Ÿå‘½å‘¨æœŸäº‹ä»¶</td><td>æ˜¯</td><td>å¯èƒ½ï¼ˆå¦‚æœéœ€è¦å¿«é€Ÿæ›´æ–°ï¼‰</td></tr><tr><td>å›è°ƒã€ç›‘å¬å™¨æˆ–åå°çº¿ç¨‹</td><td>é¿å…ä½¿ç”¨ï¼ˆä¸èƒ½æŒ‚èµ·ï¼‰</td><td>æ˜¯</td></tr><tr><td>éœ€è¦ä¿è¯æ•°æ®é€è¾¾</td><td>æ˜¯</td><td>å¦ï¼ˆéœ€è‡ªè¡Œå¤„ç†å¤±è´¥æƒ…å†µï¼‰</td></tr><tr><td>å‘é€å³å¿˜ï¼ˆfire-and-forgetï¼‰åœºæ™¯</td><td>å¦</td><td>æ˜¯</td></tr></tbody></table>
<p>ä¸¤å¥è¯æ¦‚æ‹¬å°±æ˜¯ï¼š</p>
<ul>
<li>å½“ä½ éœ€è¦å¯é çš„ã€å¯¹åç¨‹å‹å¥½çš„å‘é€æ–¹å¼æ—¶ï¼Œä½¿ç”¨Â <code>emit</code>ã€‚</li>
<li>å½“ä½ å¸Œæœ›å®ç°æ— é˜»å¡ã€å¿«é€Ÿè§¦å‘ä¸”ä¸æš‚åœçš„æ“ä½œæ—¶ï¼Œä½¿ç”¨Â <code>tryEmit</code>ã€‚</li>
</ul>
<h2 data-id="heading-7">ä¸‰ã€é‡è¦æ³¨æ„äº‹é¡¹</h2>
<ol>
<li>
<p><strong>callbackFlow çš„ç‰¹æ®Šæƒ…å†µ</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin">callbackFlow {
    callback { <span class="hljs-keyword">data</span> -&gt;
        <span class="hljs-comment">// è¿™é‡Œå¿…é¡»ç”¨ trySendï¼Œå› ä¸º callback ä¸æ˜¯æŒ‚èµ·ä¸Šä¸‹æ–‡</span>
        trySend(<span class="hljs-keyword">data</span>)
    }
}
</code></pre>
</li>
<li>
<p><strong>MutableSharedFlow çš„é…ç½®å½±å“</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> flow = MutableSharedFlow&lt;<span class="hljs-built_in">Int</span>&gt;(
    replay = <span class="hljs-number">0</span>,
    extraBufferCapacity = <span class="hljs-number">10</span>  <span class="hljs-comment">// ç¼“å†²åŒºå¤§å°å½±å“ tryEmit æˆåŠŸç‡</span>
)
</code></pre>
</li>
<li>
<p><strong>æ€§èƒ½è€ƒè™‘</strong></p>
<ul>
<li><code>emit()</code>ï¼šæ›´å®‰å…¨ï¼Œä¿è¯æ•°æ®ä¸ä¸¢å¤±</li>
<li><code>tryEmit()</code>ï¼šæ€§èƒ½æ›´å¥½ï¼Œä½†å¯èƒ½ä¸¢å¤±æ•°æ®</li>
</ul>
</li>
</ol>
<p>æ€»ç»“ä¸€ä¸‹äºŒè€…çš„åŒºåˆ«ï¼š</p>



































<table><thead><tr><th>ç‰¹æ€§</th><th>emit()</th><th>tryEmit()</th></tr></thead><tbody><tr><td>æŒ‚èµ·å‡½æ•°</td><td>æ˜¯</td><td>å¦</td></tr><tr><td>ç­‰å¾…æ”¶é›†è€…</td><td>æ˜¯ï¼ˆå¦‚æœç¼“å†²åŒºå·²æ»¡ï¼‰</td><td>å¦</td></tr><tr><td>è¿”å›ç±»å‹</td><td>Unit</td><td>Boolean</td></tr><tr><td>æ˜¯å¦ç«‹å³å‘å°„ï¼Ÿ</td><td>å¦ï¼ˆå¯èƒ½ä¼šæŒ‚èµ·ï¼‰</td><td>æ˜¯ï¼ˆå¦‚æœç¼“å†²åŒºå…è®¸ï¼‰</td></tr><tr><td>æ˜¯å¦å¯åœ¨åç¨‹ä¸­ä½¿ç”¨ï¼Ÿ</td><td>å¿…é¡»</td><td>ä¸éœ€è¦</td></tr></tbody></table>
<h2 data-id="heading-8">å››ã€æœ€ä½³å®è·µå»ºè®®</h2>
<ul>
<li><strong>ä¼˜å…ˆä½¿ç”¨Â <code>emit()</code></strong> ï¼Œé™¤éæœ‰ç‰¹æ®Šæ€§èƒ½éœ€æ±‚</li>
<li>åœ¨Â <code>flow {}</code>Â æ„å»ºå™¨ä¸­<strong>æ€»æ˜¯ä½¿ç”¨Â <code>emit()</code></strong></li>
<li>åœ¨å›è°ƒæ¥å£ä¸­ï¼ˆå¦‚ callbackFlowï¼‰ä½¿ç”¨Â <code>trySend()</code>/<code>tryEmit()</code></li>
<li>å¯¹äºçŠ¶æ€æ›´æ–°ï¼Œå¦‚æœæ— æ³•ç¡®ä¿åœ¨åç¨‹ä¸Šä¸‹æ–‡ä¸­ï¼Œä½¿ç”¨Â <code>tryEmit()</code>Â ä½†è¦æœ‰å¤±è´¥å¤„ç†</li>
<li>æ˜ç¡®å¤„ç†Â <code>tryEmit()</code>Â è¿”å›çš„Â <code>false</code>Â æƒ…å†µ</li>
</ul>
<p>ç®€å•æ€»ç»“ï¼š<strong><code>emit()</code>Â æ˜¯å®‰å…¨çš„é˜»å¡ç‰ˆæœ¬ï¼Œ<code>tryEmit()</code>Â æ˜¯éé˜»å¡çš„å°è¯•ç‰ˆæœ¬ï¼Œå¯èƒ½å¤±è´¥ä¸¢æ•°æ®ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸è®©æˆ‘ç”¨ï¼Ÿè¿™ä¸ªçœŸä¸èƒ½å¿ - æŸè§†é¢‘Appå¼ºåˆ¶å¯åŠ¨]]></title>    <link>https://juejin.cn/post/7587327550873796608</link>    <guid>https://juejin.cn/post/7587327550873796608</guid>    <pubDate>2025-12-25T08:00:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587327550873796608" data-draft-id="7587334152871378984" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸è®©æˆ‘ç”¨ï¼Ÿè¿™ä¸ªçœŸä¸èƒ½å¿ - æŸè§†é¢‘Appå¼ºåˆ¶å¯åŠ¨"/> <meta itemprop="keywords" content="å®‰å…¨"/> <meta itemprop="datePublished" content="2025-12-25T08:00:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¥‹é£å®‰å…¨"/> <meta itemprop="url" content="https://juejin.cn/user/3148642844684638"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸è®©æˆ‘ç”¨ï¼Ÿè¿™ä¸ªçœŸä¸èƒ½å¿ - æŸè§†é¢‘Appå¼ºåˆ¶å¯åŠ¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3148642844684638/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¥‹é£å®‰å…¨
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T08:00:54.000Z" title="Thu Dec 25 2025 08:00:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ç›®æ ‡</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0bfe895ff16b41e093e9fd37e0d218d7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aWL6aOe5a6J5YWo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767254454&amp;x-signature=VZvgLNqkGYeK0GkBRFAbPdc2Zsw%3D" alt="show" loading="lazy"/></p>
<p>æœ‹å‹ç»™æˆ‘å‘äº†ä¸€ä¸ªçœ‹ç›´æ’­çš„App,åˆšä¸€å¯åŠ¨ï¼Œç¡•å¤§çš„å¼¹çª—å°±å´©è„¸ä¸Šäº†ã€‚è¿™ä¸ªçœŸå¿ä¸äº†ï¼Œç›˜å®ƒã€‚</p>
<h2 data-id="heading-1">äºŒã€æ­¥éª¤</h2>
<h3 data-id="heading-2">Jadx</h3>
<p>å…ˆç»™ä»–æ‹†å¼€ï¼Œæœå­—ç¬¦ä¸²ï¼Œ <strong>æ¿€æ´»æœ¬åº”ç”¨</strong></p>
<pre><code class="hljs language-bash" lang="bash">&lt;string name=<span class="hljs-string">"unknown_device"</span>&gt;å½“å‰è®¾å¤‡æš‚ä¸æ”¯æŒæ¿€æ´»æœ¬åº”ç”¨ã€‚&lt;/string&gt;
</code></pre>
<p>ä»£ç é‡Œé¢æ²¡æ‰¾åˆ°ç—•è¿¹ï¼Œåœ¨èµ„æºé‡Œé¢å±…ç„¶æ‰¾åˆ°äº†ã€‚ åç¼–è¯‘çš„ç±»åˆ—è¡¨å¤ªå¹²å‡€äº†ï¼Œæ„Ÿè§‰å¯èƒ½åŠ å›ºäº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8826c7b5d9bb4c10beea9af9dbf77acc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aWL6aOe5a6J5YWo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767254454&amp;x-signature=qqlLGCFG4BD6%2BIG9hZrzwuoET%2Fw%3D" alt="show" loading="lazy"/></p>
<p>ä¹Ÿæ²¡æœ‰å‘ç°è¿™ä¸ªå­—ç¬¦ä¸²åœ¨ä»£ç ä¸­è¢«è°ƒç”¨çš„åœ°æ–¹ï¼Œè‚¯å®šæ˜¯åŠ å›ºäº†</p>
<h3 data-id="heading-3">å…³é—¨ï¼Œä¸ŠAI</h3>
<pre><code class="hljs language-bash" lang="bash">
ä¸‡èƒ½çš„AIï¼Œå¸®æˆ‘ç”Ÿæˆä¸€ä¸ª Frida hookè„šæœ¬ï¼Œæ•è· res/layout/dialog_double_button.xml å¼¹çª—æ˜¾ç¤ºä½ç½®å’Œå †æ ˆï¼Œ
</code></pre>
<p>æœ‰äº†AIï¼Œäººäººéƒ½æ˜¯å·¥ç¨‹å¸ˆ</p>
<pre><code class="hljs language-js" lang="js">
<span class="hljs-comment">// Hook AlertDialog.show() </span>
<span class="hljs-keyword">var</span> <span class="hljs-title class_">AlertDialog</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">"android.app.AlertDialog"</span>);
<span class="hljs-title class_">AlertDialog</span>.<span class="hljs-property">show</span>.<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"\n================================================================================"</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"[*] AlertDialog.show() è¢«è°ƒç”¨ "</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"================================================================================"</span>);
    
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"\n[*] è°ƒç”¨å †æ ˆ:"</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">"android.util.Log"</span>).<span class="hljs-title function_">getStackTraceString</span>(<span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">"java.lang.Exception"</span>).$new()));
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"================================================================================\n"</span>);
    
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">show</span>();
};

</code></pre>
<p>è·‘ä¸€ä¸‹ï¼Œæ²¡ååº”ï¼Œfridaç›´æ¥æŒ‚äº†ã€‚</p>
<p>å…ˆä¸æ€¥ç€é—®AIï¼Œå’±ä»¬ä¹‹å‰åˆ†æè¿™ä¸ªAppå¤§æ¦‚ç‡åŠ å›ºäº†ï¼Œæ‰€ä»¥æ£€æµ‹fridaåº”è¯¥æ˜¯åŸºæ“ã€‚</p>
<p>å’±ä»¬æ¢ä¸Šé­”æ”¹ç‰ˆçš„Frida</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FYlarod%2FFlorida" target="_blank" title="https://github.com/Ylarod/Florida" ref="nofollow noopener noreferrer">github.com/Ylarod/Florâ€¦</a></p>
<p>å†è·‘ä¸€ä¸‹</p>
<pre><code class="hljs language-bash" lang="bash">================================================================================
[*] AlertDialog.show() è¢«è°ƒç”¨ 
================================================================================

[*] è°ƒç”¨å †æ ˆ:
java.lang.Exception
	at android.app.Dialog.show(Native Method)
	at com.gXXX.tv.gXX.utils.x2.a(NoticeUtils.java:125)
	at com.gXXX.tv.gXX.activity.BaseActivity.g(BaseActivity.java:1)
	at com.gXXX.tv.gXX.activity.BaseActivity.onLoginEvent(BaseActivity.java:6)
	at com.gXXX.tv.gXX.activity.WelcomeActivity.onLoginEvent(WelcomeActivity.java:1)
	at java.lang.reflect.Method.invoke(Native Method)
</code></pre>
<p>è¿™æ¬¡æ¯”è¾ƒé¡ºåˆ©ï¼Œé€®ä½äº†</p>
<h3 data-id="heading-4">è„±å£³</h3>
<p>è¿™æ¬¡è„±å£³ç”¨çš„æ˜¯è€æœ‹å‹ BlackDex</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FZiTanIOI%2FnewBlackDex" target="_blank" title="https://github.com/ZiTanIOI/newBlackDex" ref="nofollow noopener noreferrer">github.com/ZiTanIOI/neâ€¦</a></p>
<p>è¿™æ¬¡æ„Ÿè§‰æ˜¯çŒ›å£³ï¼Œæ‰€ä»¥åœ¨è½¯ä»¶è®¾ç½®é‡Œ å‹¾ä¸Š æ·±åº¦è„±å£³å’Œä¸»åŠ¨è°ƒç”¨</p>
<p>åŒæ‰‹åˆåï¼Œé»˜å¿µ <strong>èŠéº»å¼€é—¨</strong></p>
<p>å›¾çµä¿ä½‘ï¼Œå£³æ‹–å‡ºæ¥äº†ã€‚</p>
<p>Jadxä¸€ä¸‹ï¼Œç„¶åæœç´¢ <strong>onLoginEvent</strong></p>
<p>æ‰“å¼€ BaseActivity.onLoginEvent</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef20021e411e4bf09fa2eba29e08e67d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aWL6aOe5a6J5YWo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767254454&amp;x-signature=TVuCu7Yh4VaP6d6Rfln9y%2FuevFo%3D" alt="login" loading="lazy"/></p>
<p>è¿™å“¥ä»¬ä¹ŸçœŸç´¯ï¼Œä¸€å †åˆ¤æ–­ï¼Œä¸€è¨€ä¸åˆå°±æ€æ¡Œå­é€€å‡ºã€‚</p>
<p>ä¸æ€•ï¼Œå“¥æ˜¯æœ‰AIçš„ï¼ŒæŠŠæ•´ä¸ªonLoginEventå‡½æ•°çš„ä»£ç å–‚ç»™AI</p>
<pre><code class="hljs language-bash" lang="bash">è¯·å¸®æˆ‘ç”ŸæˆFrida Hookè„šæœ¬ï¼Œhookä½onLoginEventå‡½æ•°çš„æ‰€æœ‰åˆ¤æ–­ï¼Œå®šä½ä¸€ä¸‹åˆ°åº•æ˜¯åœ¨å“ªé‡Œé€€å‡ºçš„ã€‚
</code></pre>
<p>å­å“§å­å“§ï¼ŒAIç»™æˆ‘ç”Ÿæˆäº†ä¸€å †ä»£ç ï¼Œçœ‹çš„çœ¼èŠ±ç¼­ä¹±ã€‚</p>
<p>è¿™ä¸è¡Œï¼Œè¿˜å¾—å¤æ³•ä¸Šï¼Œç¡…åŸºæš‚æ—¶è®©æ­¥ï¼Œç¢³åŸºä¸Šä½ã€‚æˆ‘ä»¬è§‚å¯Ÿä¸€ä¸‹è¿™ä¸ªå‡½æ•°çš„ä»£ç è¿˜æ˜¯å¾ˆè§„æ•´çš„ï¼Œ <strong>æ¯æ¬¡åˆ¤æ–­é€€å‡ºéƒ½ä¼šæœ‰æç¤º</strong>ã€‚</p>
<p>å‘¼å”¤AI</p>
<pre><code class="hljs language-bash" lang="bash">è¯·å¸®æˆ‘ç”ŸæˆFrida Hookè„šæœ¬ï¼Œhookä½com.gXXX.tv.gXX.activity.BaseActivity.c , åŠ ä¸Šå¼‚å¸¸å¤„ç†ï¼Œæ²¡æœ‰æ‰¾åˆ°è¿™ä¸ªç±»å°±100æ¯«ç§’ä¹‹åé‡è¯• ã€‚
</code></pre>
<p>å› ä¸ºè¿™ä¸ªæ˜¯åŠ å£³åº”ç”¨ï¼Œæ‰€ä»¥éœ€è¦ç»™å£³ä¸€ä¸ªè§£å¯†çš„æ—¶é—´ï¼Œç›´æ¥hookæ˜¯æ‰¾ä¸åˆ° <strong>com.gXXX.tv.gXX.activity.BaseActivity</strong> ç±»çš„ã€‚</p>
<p>AIå†™çš„ä»£ç å°±æ˜¯æ¼‚äº®</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"[*] å¼€å§‹Hook BaseActivity.c"</span>);
    
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">tryHook</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">var</span> <span class="hljs-title class_">BaseActivity</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">"com.gXXX.tv.gXX.activity.BaseActivity"</span>);
            
            <span class="hljs-title class_">BaseActivity</span>[<span class="hljs-string">"c"</span>].<span class="hljs-title function_">overload</span>(<span class="hljs-string">'java.lang.String'</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">str</span>) {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"BaseActivity.c is called: str="</span> + str);
                <span class="hljs-variable language_">this</span>[<span class="hljs-string">"c"</span>](str);
            };


            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"[+] BaseActivity.c HookæˆåŠŸ"</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            
        } <span class="hljs-keyword">catch</span> (e) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"[-] Hookå¤±è´¥: "</span> + e.<span class="hljs-property">message</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }
    
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">hookWithRetry</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">tryHook</span>()) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"[*] 100msåé‡è¯•..."</span>);
            <span class="hljs-built_in">setTimeout</span>(hookWithRetry, <span class="hljs-number">100</span>);
        }
    }
    
    <span class="hljs-title function_">hookWithRetry</span>();
});

</code></pre>
<p>å¥½äº†ï¼Œå‘ç°æç¤º</p>
<pre><code class="hljs language-bash" lang="bash">onLoginEvent <span class="hljs-literal">false</span> showErrorTerminalDialog and SendErrorPingback
</code></pre>
<p>åŸæ¥ç¬¬ä¸€ä¸ªåˆ¤æ–­ <strong>isTerminalFailStatus</strong> å°±æŒ‚æ‰äº†</p>
<p>å•¥ä¹Ÿä¸è¯´äº†ï¼Œå¢åŠ ä¸€ä¸ª Hook</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> <span class="hljs-title class_">BaseLoginTask</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">"com.gXXX.tv.gXX.service.task.BaseLoginTask"</span>);
<span class="hljs-title class_">BaseLoginTask</span>[<span class="hljs-string">"isTerminalFailStatus"</span>].<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">i</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`BaseLoginTask.isTerminalFailStatus is called: i=<span class="hljs-subst">${i}</span>`</span>);
    <span class="hljs-keyword">let</span> result = <span class="hljs-variable language_">this</span>[<span class="hljs-string">"isTerminalFailStatus"</span>](i);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`BaseLoginTask.isTerminalFailStatus result=<span class="hljs-subst">${result}</span>`</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-comment">// return result;</span>
}; 
</code></pre>
<p>å®Œç¾æ”¶å·¥ã€‚</p>
<h2 data-id="heading-5">ä¸‰ã€æ€»ç»“</h2>
<p>ä¸è¦ç»™ä½ çš„å¯¹æ‰‹å¤ªæ˜æ˜¾çš„æç¤ºã€‚</p>
<p>ä¸è¦å¤ªç›¸ä¿¡AIï¼Œå¦‚æœä½ ä¸çŸ¥é“è‡ªå·±åœ¨å¹²ä»€ä¹ˆï¼ŒAIä¹Ÿä¸çŸ¥é“ã€‚</p>
<p>è„±å£³æ˜¯ç„å­¦ï¼Œå¤šè¯•å‡ ä¸ªæ–¹æ¡ˆï¼Œä¸‡ä¸€è¿æ°”åˆ°äº†å‘¢ï¼Ÿ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e0db87c28624999befd62095fb8075e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aWL6aOe5a6J5YWo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767254454&amp;x-signature=zRZup5gpEkfJsavE9xeY0XhX6KA%3D" alt="ffshow" loading="lazy"/>
<strong>é›ªä¹‹å¦™åœ¨èƒ½ç§¯ï¼Œäº‘ä¹‹å¦™åœ¨ä¸ç•™ï¼Œæœˆä¹‹å¦™åœ¨æœ‰åœ†æœ‰ç¼º</strong></p>
<p><strong>ğŸ’¡ TIP</strong><br/>
: æœ¬æ–‡çš„ç›®çš„åªæœ‰ä¸€ä¸ªå°±æ˜¯å­¦ä¹ æ›´å¤šçš„é€†å‘æŠ€å·§å’Œæ€è·¯ï¼Œå¦‚æœæœ‰äººåˆ©ç”¨æœ¬æ–‡æŠ€æœ¯å»è¿›è¡Œéæ³•å•†ä¸šè·å–åˆ©ç›Šå¸¦æ¥çš„æ³•å¾‹è´£ä»»éƒ½æ˜¯æ“ä½œè€…è‡ªå·±æ‰¿æ‹…ï¼Œå’Œæœ¬æ–‡ä»¥åŠä½œè€…æ²¡å…³ç³».</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Kotlin vs Dartï¼šå½“â€œä¼˜é›…â€å˜æˆå¿ƒæ™ºè´Ÿæ‹…ï¼Œæˆ‘é€‰æ‹©äº†æ›´ç®€å•çš„ Dart]]></title>    <link>https://juejin.cn/post/7587961565476978742</link>    <guid>https://juejin.cn/post/7587961565476978742</guid>    <pubDate>2025-12-26T08:52:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587961565476978742" data-draft-id="7587961565476962358" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Kotlin vs Dartï¼šå½“â€œä¼˜é›…â€å˜æˆå¿ƒæ™ºè´Ÿæ‹…ï¼Œæˆ‘é€‰æ‹©äº†æ›´ç®€å•çš„ Dart"/> <meta itemprop="keywords" content="Flutter,Dart,Kotlin"/> <meta itemprop="datePublished" content="2025-12-26T08:52:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜è€åˆ˜"/> <meta itemprop="url" content="https://juejin.cn/user/662360127965769"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Kotlin vs Dartï¼šå½“â€œä¼˜é›…â€å˜æˆå¿ƒæ™ºè´Ÿæ‹…ï¼Œæˆ‘é€‰æ‹©äº†æ›´ç®€å•çš„ Dart
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/662360127965769/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜è€åˆ˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T08:52:24.000Z" title="Fri Dec 26 2025 08:52:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯è€åˆ˜</strong></p>
<p>è€åˆ˜åšFlutterå¼€å‘æœ‰7å¹´äº†å·®ä¸å¤šã€‚</p>
<p>æˆ‘è®°å¾—æ—©å…ˆçš„æ—¶å€™è¿˜ç»å¸¸æœ‰äººè®¨è®ºä¸ºå•¥Flutteræ²¡æœ‰é€‰æ‹©kotlinè€Œæ˜¯é€‰äº†dartã€‚</p>
<p>å½“æ—¶æˆ‘ç½—åˆ—å’Œå¾ˆå¤šåŸå› ï¼ŒåŒæ—¶ä¹Ÿè¯´è¿‡æˆ‘ä¸ªäººå…¶å®æ˜¯å¾ˆå–œæ¬¢Kotlinçš„ã€‚</p>
<p>æƒ³å½“å¹´ï¼ŒKotlin å°±æ˜¯æ‹¯æ•‘æˆ‘ä»¬è„±ç¦»Java è‹¦æµ·çš„ã€‚</p>
<p>ä¼˜é›…çš„ Lambda è¡¨è¾¾å¼ã€ä¸æ»‘çš„é›†åˆæ“ä½œç¬¦ï¼Œæ•ˆç‡ç›´æ¥èµ·é£ã€‚</p>
<p>ä½†æ˜¯è¿™ä¸¤å¹´æˆ‘å‘ç°è‡ªå·±è¶Šæ¥è¶Šä¸å–œæ¬¢ç”¨kotlin è€Œæ˜¯æ›´é€‚åº”dartäº†ã€‚</p>
<p>ä½ å¯èƒ½ä¼šè¯´ï¼šâ€œè€åˆ˜ï¼Œè¿™æ˜¯å› ä¸ºä½ æœ€è¿‘åªå†™ Flutter å§ï¼Ÿâ€</p>
<p>ç¡®å®ï¼ŒFlutterçš„å¼€å‘å·¥ä½œå æ¯”é‡å¾ˆå¤§æ˜¯ä¸€ä¸ªå› ç´ ã€‚</p>
<p>ä½†å¦‚æœä»…ä»…æ˜¯å› ä¸ºæ¡†æ¶ç»‘å®šï¼Œè¿˜ä¸è¶³ä»¥è®©æˆ‘æ”¹å˜å¯¹ä¸€é—¨è¯­è¨€çš„å–œå¥½ç¨‹åº¦ã€‚è¿™èƒŒåï¼Œå…¶å®æœ‰ç€è‡ªå·±å¯¹ç¼–ç¨‹çš„ç†è§£å’Œæ€è€ƒã€‚</p>
<h2 data-id="heading-0">Kotlin å¾ˆå¼ºï¼Œä½† Dart æ›´é¦™</h2>
<p>Kotlin ç¡®å®æ˜¯ä¸ªå¼ºå¤§çš„è¯­è¨€ï¼Œå„ç§è¯­æ³•ç³–ç®€ç›´ç”œåˆ°å¿ƒé‡Œã€‚</p>
<p>ç©ºå®‰å…¨ã€æ‰©å±•å‡½æ•°ã€é«˜é˜¶å‡½æ•°ï¼Œç”¨èµ·æ¥é‚£æ˜¯çœŸé¦™ã€‚</p>
<p>ä½†æ˜¯ï¼Œè¿™ç§å¼ºå¤§æ˜¯è¦ä»˜å‡ºä»£ä»·çš„ï¼Œè€Œè¿™ä¸ªå¾…æœºé€šå¸¸æ˜¯å¼€å‘äººå‘˜çš„å¿ƒæ™ºæˆæœ¬ã€‚</p>
<p>å†™ Kotlin çš„æ—¶å€™ï¼Œæˆ‘è„‘å­é‡Œç»å¸¸è¦å¤šè·‘ä¸€ä¸ªçº¿ç¨‹ï¼šè¿™å—é€»è¾‘æ˜¯ç”¨ <code>apply</code> è¿˜æ˜¯ <code>also</code>ï¼Ÿæ˜¯ç”¨ <code>let</code> è¿˜æ˜¯ <code>run</code>ï¼Ÿ</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// è¿™ç§çº ç»“æ—¶åˆ»éƒ½åœ¨å‘ç”Ÿï¼Œä»…ä»…æ˜¯åˆå§‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼š</span>

<span class="hljs-comment">// å†™æ³•1ï¼šç”¨ apply (ä¸Šä¸‹æ–‡æ˜¯ this, è¿”å›å¯¹è±¡æœ¬èº«)</span>
<span class="hljs-keyword">val</span> view = TextView(context).apply {
    text = <span class="hljs-string">"Hello"</span>
    textSize = <span class="hljs-number">16f</span>
}

<span class="hljs-comment">// å†™æ³•2ï¼šç”¨ also (ä¸Šä¸‹æ–‡æ˜¯ it, è¿”å›å¯¹è±¡æœ¬èº«)</span>
<span class="hljs-keyword">val</span> view2 = TextView(context).also {
    it.text = <span class="hljs-string">"Hello"</span>
    it.textSize = <span class="hljs-number">16f</span>
}

<span class="hljs-comment">// å†™æ³•3ï¼šç”¨ run (ä¸Šä¸‹æ–‡æ˜¯ this, è¿”å›æœ€åä¸€è¡Œç»“æœ)</span>
<span class="hljs-keyword">val</span> view3 = TextView(context).run {
    text = <span class="hljs-string">"Hello"</span>
    textSize = <span class="hljs-number">16f</span>
    <span class="hljs-keyword">this</span> <span class="hljs-comment">// å¦‚æœå¿˜äº†è¿™ä¸€è¡Œï¼Œview3 å°±æ˜¯ Unit</span>
}
</code></pre>
<p>åŒæ ·çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå¯èƒ½æœ‰äº”å…­ç§å†™æ³•ï¼Œæ¯ç§éƒ½æœ‰ç»†å¾®çš„å·®åˆ«ã€‚è¿™ç§é—®é¢˜åœ¨å›¢é˜Ÿåä½œæ—¶å°¤ä¸ºæ˜æ˜¾ï¼Œæ¯ä¸ªäººçš„é£æ ¼éƒ½ä¸ä¸€æ ·ï¼Œçœ‹åˆ«äººçš„ä»£ç æœ‰æ—¶å€™å¾—è„‘è¡¥åŠå¤©ã€‚</p>
<p>æœ€é‡è¦çš„æ˜¯ä»–ä¼šæ‰“ç ´å†™ä»£ç æ—¶å¿ƒæµçš„çŠ¶æ€ã€‚</p>
<p>åè§‚ Dartï¼Œåˆšå¼€å§‹æ¥è§¦æ—¶è§‰å¾—å®ƒæœ‰ç‚¹åœŸã€‚</p>
<p>ä½†ç”¨ä¹…äº†ä½ å°±ä¼šå‘ç°ï¼Œè¿™ç§â€œå¹³å¹³æ— å¥‡â€æ‰æ˜¯çœŸçˆ±ã€‚</p>
<p>Dart çš„è¯­æ³•è®¾è®¡éå¸¸å…‹åˆ¶ï¼Œå®ƒä¸è¿½æ±‚ç‚«æŠ€ï¼Œè€Œæ˜¯è¿½æ±‚ç›´è§‚ã€‚</p>
<p>å†™ Dart çš„æ—¶å€™ï¼Œæˆ‘ä¸éœ€è¦åœ¨å¤§è„‘é‡Œæ—¶åˆ»ç»·ç€æ ¹å¼¦å»çº ç»“è¯­æ³•ç»†èŠ‚ï¼Œç›´æ¥é¡ºç€é€»è¾‘å†™ä¸‹å»å°±è¡Œã€‚</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// åŒæ ·çš„é€»è¾‘ï¼ŒDart çš„è§£å†³æ–¹æ¡ˆé€šå¸¸åªæœ‰ä¸€ç§ â€”â€” çº§è”æ“ä½œç¬¦ (..)</span>
<span class="hljs-comment">// ä¸éœ€è¦çº ç»“æ˜¯ç”¨ apply è¿˜æ˜¯ runï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒ this å’Œ it æ··æ·†</span>
<span class="hljs-keyword">var</span> view = TextView(context)
  ..text = <span class="hljs-string">"Hello"</span>
  ..textSize = <span class="hljs-number">16</span>;
</code></pre>
<p>ä»£ç å†™å‡ºæ¥ï¼Œä¸‰ä¸ªæœˆåå†çœ‹ï¼Œè¿˜æ˜¯èƒ½ä¸€çœ¼çœ‹æ‡‚ã€‚</p>
<p>è¿™ç§ç‰¹è´¨ï¼Œè®©æˆ‘åœ¨å¼€å‘æ—¶èƒ½æ›´ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘æœ¬èº«ï¼Œè€Œä¸æ˜¯è¯­è¨€ç‰¹æ€§ã€‚</p>
<p>è¿™ä¸€ç‚¹åœ¨æ—¥å¸¸å¼€å‘ä¸­å…¶å®æ˜¯éå¸¸é‡è¦çš„ã€‚</p>
<p>å¼€å‘äººå‘˜çš„é€»è¾‘æ€è·¯ä¸ä¼šç»å¸¸å› ä¸ºè¯­æ³•é—®é¢˜è€Œæ‰“æ–­ï¼Œä¸€æ–¹é¢èƒ½æé«˜æ•ˆç‡ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿä¼šå¤§å¤§å‡å°‘å¿ƒæ™ºè´Ÿæ‹…ï¼Œä¸ä¼šå†™ä¸€ä¼šä»£ç å°±æ„Ÿè§‰å¾ˆç´¯ã€‚</p>
<h2 data-id="heading-1">AI æ—¶ä»£çš„ç”Ÿå­˜æ³•åˆ™</h2>
<p>è®©æˆ‘å†…å¿ƒçš„å¤©å¹³å½»åº•åå‘ Dart çš„æœ€åä¸€å—ç ç ï¼Œå…¶å®æ˜¯ AIã€‚</p>
<p>åœ¨è¿™ä¸ª AI è¾…åŠ©ç¼–ç¨‹çš„æ—¶ä»£ï¼Œæˆ‘ä»¬å¿…é¡»è®¤è¯†åˆ°ä¸€ä¸ªäº‹å®ï¼šç›®å‰çš„ AI æ¨¡å‹ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ¨¡å¼åŒ¹é…æœºå™¨ï¼Œå®ƒæ˜¯ä¸ªâ€œç›´è‚ å­â€ï¼Œè¿œæ²¡æœ‰è¿›åŒ–åˆ°èƒ½è¿›è¡Œæ·±åº¦é€»è¾‘æ€è€ƒçš„ç¨‹åº¦ã€‚</p>
<p>è€Œ Dart è¿™ç§å¹³å¹³æ— å¥‡çš„è¯­æ³•ï¼Œæ°æ°æ˜¯ AI æœ€å–œæ¬¢çš„ã€‚</p>
<p>å› ä¸ºå®ƒè¶³å¤Ÿç®€å•ã€ç›´è§‚ã€æ˜¾å¼ã€‚AI è¯»å¾—å¿«ã€æ‡‚çš„é€ã€å†™å¾—å‡†ã€‚</p>
<p>åè§‚é‚£äº›æ‹¥æœ‰ä¸°å¯Œè¯­æ³•ç³–å’Œé»‘é­”æ³•çš„è¯­è¨€ï¼Œè™½ç„¶å¯¹äººç±»ä¸“å®¶æ¥è¯´å†™èµ·æ¥å¾ˆçˆ½ï¼Œä½†å¯¹ AI æ¥è¯´ï¼Œå´æˆäº†å¹»è§‰çš„æ¸©åºŠã€‚è¿‡å¤šçš„éšå¼ä¸Šä¸‹æ–‡å’Œå¤šæ ·çš„è¯­æ³•é€‰æ‹©ï¼Œå¤§å¤§å¢åŠ äº† AI çŠ¯é”™çš„æ¦‚ç‡ã€‚</p>
<p>åœ¨ AI æ—¶ä»£ï¼Œè°çš„ä»£ç èƒ½è®© AI æ›´å¥½ç†è§£ã€æ›´å®¹æ˜“ç”Ÿæˆï¼Œè°å°±æ˜¯èµ¢å®¶ã€‚</p>
<p>ä»¥å‰æˆ‘ä»¬è¿½æ±‚ä»£ç è¦å†™ç»™äººçœ‹ï¼Œç°åœ¨å¯èƒ½è¿˜è¦åŠ ä¸€æ¡â€”â€”å†™ç»™ AI çœ‹ã€‚ç®€å•ç›´ç™½çš„ä»£ç ï¼Œä¸ä»…äººç±»ç»´æŠ¤èµ·æ¥è½»æ¾ï¼ŒAI è¾…åŠ©ç”Ÿæˆçš„å‡†ç¡®ç‡ä¹Ÿä¼šæ˜¾è‘—æé«˜ã€‚</p>
<p>è¿™æ‰æ˜¯ AI æ—¶ä»£çš„ç”Ÿå­˜æ³•åˆ™ï¼šæ‘’å¼ƒèŠ±å“¨ï¼Œå›å½’æœ´ç´ ã€‚</p>
<h2 data-id="heading-2">é‡å‰‘æ— é”‹å¤§å·§ä¸å·¥</h2>
<p>å¹´è½»çš„æ—¶å€™æ€»æƒ³ç€æ€ä¹ˆå®ç°æœ€å¤æ‚çš„åŠŸèƒ½ï¼Œæ€ä¹ˆæŠŠè¯­è¨€ç‰¹æ€§ç”¨åˆ°æè‡´ã€‚</p>
<p>é‚£æ—¶å€™è§‰å¾—ï¼Œèƒ½æŠŠä¸€è¡Œä»£ç å†™å¾—åƒå¤©ä¹¦ä¸€æ ·éš¾æ‡‚ï¼Œæ‰å«æ°´å¹³ã€‚</p>
<p>ä½†éšç€å¹´å²æ¸é•¿ï¼Œå†™è¿‡çš„ä»£ç è¶Šæ¥è¶Šå¤šï¼Œå¡«è¿‡çš„å‘ä¹Ÿè¶Šæ¥è¶Šæ·±ï¼Œæˆ‘å¼€å§‹æ…¢æ…¢é¢†æ‚Ÿåˆ°â€œé‡å‰‘æ— é”‹ï¼Œå¤§å·§ä¸å·¥â€çš„çœŸè°›ã€‚</p>
<p>ç°åœ¨çš„æˆ‘ï¼Œç¼–ç é£æ ¼å‘ç”Ÿäº†å·¨å¤§çš„è½¬å˜ã€‚ä¸å†è¿½æ±‚é‚£äº›èŠ±å“¨çš„è¯­æ³•ç³–å’Œæ‰€è°“çš„â€œé»‘é­”æ³•â€ï¼Œè€Œæ˜¯æ›´å€¾å‘äºç®€å•ã€ç›´æ¥ã€å¥å£®çš„ä»£ç ã€‚</p>
<p>ä¸¾ä¸ªæœ€ç›´æ¥çš„ä¾‹å­ï¼Œä»¥å‰æˆ‘å¾ˆç—´è¿·äºå„ç§è‡ªåŠ¨åŒ–çš„ä¾èµ–æ³¨å…¥æ¡†æ¶ã€‚è§‰å¾—å†™ä¸ªæ³¨è§£ï¼Œå¯¹è±¡å°±è‡ªåŠ¨æ³¨å…¥è¿›æ¥äº†ï¼Œå¤šé…·å•Šï¼Œå¤šçœäº‹å•Šã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ä»¥å‰è§‰å¾—å¾ˆé…·çš„â€œé»‘é­”æ³•â€</span>
<span class="hljs-meta">@Inject</span>
<span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> userService: UserService <span class="hljs-comment">// å®ƒæ˜¯ä»å“ªæ¥çš„ï¼Ÿè°åˆå§‹åŒ–çš„ï¼Ÿå®Œå…¨æ˜¯é»‘ç›’ã€‚</span>
</code></pre>
<p>ä½†ç°åœ¨ï¼Œæˆ‘åè€Œæ›´å–œæ¬¢æ‰‹åŠ¨ç®¡ç†ä¾èµ–ï¼Œç”šè‡³å°±æ˜¯æœ€åŸå§‹çš„é€šè¿‡æ„é€ å‡½æ•°å‚æ•°ä¼ é€’ã€‚</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// ç°åœ¨æ›´å–œæ¬¢çš„â€œç¬¨åŠæ³•â€</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserViewModel</span> </span>{
  <span class="hljs-keyword">final</span> UserService service;
  
  <span class="hljs-comment">// ä¸€åˆ‡éƒ½åœ¨é˜³å…‰ä¸‹ï¼Œæ²¡æœ‰ç§˜å¯†</span>
  UserViewModel(<span class="hljs-keyword">this</span>.service); 
}
</code></pre>
<p>çœ‹èµ·æ¥è¿™ç§æ–¹å¼æœ‰ç‚¹ç¬¨ï¼Œå†™èµ·æ¥ä¹Ÿæ²¡é‚£ä¹ˆçµåŠ¨ã€‚ä½†å®ƒçš„å¥½å¤„æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼šç›´è§‚ã€æ¸…æ™°ã€‚</p>
<p>æ•°æ®çš„æµå‘ä¸€ç›®äº†ç„¶ï¼Œä¾èµ–å…³ç³»æ¸…æ¸…æ¥šæ¥šã€‚å‡ºäº†é—®é¢˜ï¼Œä¸ç”¨å»ç¿»æ¡†æ¶æºç çŒœå®ƒæ˜¯æ€ä¹ˆæ³¨å…¥çš„ï¼Œçœ‹ä¸€çœ¼è°ƒç”¨æ ˆå°±èƒ½å®šä½ã€‚</p>
<p>æˆ‘ä»¬å†™ä»£ç ï¼Œæœ€ç»ˆç›®çš„æ˜¯ä¸ºäº†è§£å†³é—®é¢˜ï¼Œä¸ºäº†è®©ç³»ç»Ÿç¨³å®šè¿è¡Œï¼Œè€Œä¸æ˜¯ä¸ºäº†ç‚«æŠ€ã€‚</p>
<p>å“ªæ€•æŠ›å¼€ AI ä¸è°ˆï¼Œæˆ‘ä¹Ÿæ›´æ„¿æ„å†™è¿™ç§ä¸€çœ¼å°±èƒ½çœ‹æ‡‚çš„ä»£ç ã€‚</p>
<p>å› ä¸ºå®ƒç»å¾—èµ·æ—¶é—´çš„è€ƒéªŒï¼Œä¹Ÿç»å¾—èµ·å›¢é˜Ÿåä½œçš„æŠ˜è…¾ã€‚è¿™æŠŠâ€œé‡å‰‘â€ï¼Œè™½ç„¶æ²¡æœ‰é”‹åˆƒï¼Œä½†æŒ¥èˆèµ·æ¥ï¼Œå´æ˜¯æœ€æ‰å®çš„å†…åŠŸã€‚</p>
<p>å½“ç„¶ï¼Œå¿…é¡»è¦æ‰¿è®¤çš„æ˜¯ï¼Œå¦‚æœæ˜¯åœ¨æ„å»ºä¸€ä¸ªä¾èµ–å…³ç³»é”™ç»¼å¤æ‚çš„è¶…å¤§å‹ç³»ç»Ÿï¼Œæˆ–è€…éœ€è¦æå…¶ä¸¥æ ¼çš„è§£è€¦å’ŒåŠ¨æ€æ›¿æ¢å®ç°ï¼Œæˆç†Ÿçš„ä¾èµ–æ³¨å…¥æ¡†æ¶ä¾ç„¶æ˜¯ä¸å¯æˆ–ç¼ºçš„ç¥å…µåˆ©å™¨ã€‚ä½†åœ¨æˆ‘ä»¬å¤§å¤šæ•°çš„æ—¥å¸¸å¼€å‘ï¼Œå°¤å…¶æ˜¯ Flutter è¿™ç§é‡ UIã€é‡é€»è¾‘ç›´è§‚æ€§çš„åœºæ™¯ä¸‹ï¼Œç›²ç›®å¼•å…¥å¤æ‚çš„æ¡†æ¶ï¼Œå¾€å¾€æ˜¯æ€é¸¡ç”¨ç‰›åˆ€ï¼Œåè€Œå¢åŠ äº†ç»´æŠ¤æˆæœ¬ã€‚</p>
<h2 data-id="heading-3">5. æ€»ç»“</h2>
<p>ä»æœ€åˆæ²‰è¿·äº Kotlin çš„è¯­æ³•ç³–å’Œâ€œé»‘é­”æ³•â€ï¼Œåˆ°å¦‚ä»Šåçˆ± Dart çš„æœ´ç´ ä¸ç›´è§‚ï¼Œè¿™ä¸ä»…æ˜¯ç¼–ç¨‹è¯­è¨€çš„é€‰æ‹©è½¬å˜ï¼Œæ›´æ˜¯å¯¹ä»£ç æœ¬è´¨è®¤çŸ¥çš„è½¬å˜ã€‚</p>
<p>å¦ä¸€æ–¹é¢è¿™ä¹Ÿæ˜¯åœ¨å¼ºå¤§çš„è¯­æ³•ç³–å’Œç®€æ´çš„å¿ƒæ™ºæ¨¡å‹ä¸­æ‰¾åˆ°ä¸€ä¸ªæ›´é€‚åˆè‡ªå·±çš„å¹³è¡¡ç‚¹ã€‚</p>
<p>åœ¨ AI è¾…åŠ©ç¼–ç¨‹æ—¥ç›Šæ™®åŠçš„ä»Šå¤©ï¼Œç®€å•ã€æ˜¾å¼çš„ä»£ç ä¸ä»…é™ä½äº†å¼€å‘è€…çš„å¿ƒæ™ºè´Ÿæ‹…ï¼Œæ›´æˆä¸ºäº† AI ç†è§£ä¸ç”Ÿæˆçš„æœ€ä½³è½½ä½“ã€‚</p>
<p>æ‘’å¼ƒèŠ±å“¨ï¼Œå›å½’ä»£ç è§£å†³é—®é¢˜çš„æœ¬çœŸï¼ŒLess is Moreï¼Œè¿™æˆ–è®¸æ‰æ˜¯æˆ‘ä»¬åœ¨ AI æ—¶ä»£åº”æœ‰çš„ç”Ÿå­˜æ³•åˆ™ã€‚</p>
<blockquote>
<p>å¦‚æœçœ‹åˆ°è¿™é‡Œçš„åŒå­¦å¯¹å®¢æˆ·ç«¯æˆ–è€…Flutterå¼€å‘æ„Ÿå…´è¶£ï¼Œæ¬¢è¿è”ç³»è€åˆ˜ï¼Œæˆ‘ä»¬äº’ç›¸å­¦ä¹ ã€‚</p>
<p>ç§ä¿¡å…è´¹é¢†è€åˆ˜æ•´ç†çš„ã€ŠFlutterå¼€å‘æ‰‹å†Œã€‹ï¼Œè¦†ç›–90%åº”ç”¨å¼€å‘åœºæ™¯ã€‚</p>
<p>å¯ä»¥ä½œä¸ºFlutterå­¦ä¹ çš„çŸ¥è¯†åœ°å›¾ã€‚</p>
<p>â€”â€” laoliu_dev</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[# @shopify/react-native-skia å®Œæ•´æŒ‡å—]]></title>    <link>https://juejin.cn/post/7587903505135419442</link>    <guid>https://juejin.cn/post/7587903505135419442</guid>    <pubDate>2025-12-26T08:32:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587903505135419442" data-draft-id="7587903505135386674" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="# @shopify/react-native-skia å®Œæ•´æŒ‡å—"/> <meta itemprop="keywords" content="å‰ç«¯,CSS"/> <meta itemprop="datePublished" content="2025-12-26T08:32:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="React_Native"/> <meta itemprop="url" content="https://juejin.cn/user/2496332659980452"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            # @shopify/react-native-skia å®Œæ•´æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2496332659980452/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    React_Native
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T08:32:25.000Z" title="Fri Dec 26 2025 08:32:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">@shopify/react-native-skia å®Œæ•´æŒ‡å—</h2>
<h3 data-id="heading-1">ç›®å½•</h3>
<ol>
<li><a href="#%E4%BB%80%E4%B9%88%E6%98%AF-react-native-skia" title="#%E4%BB%80%E4%B9%88%E6%98%AF-react-native-skia">ä»€ä¹ˆæ˜¯ React Native Skia</a></li>
<li><a href="#%E6%A0%B8%E5%BF%83%E6%9E%B6%E6%9E%84%E4%B8%8E%E5%8E%9F%E7%90%86" title="#%E6%A0%B8%E5%BF%83%E6%9E%B6%E6%9E%84%E4%B8%8E%E5%8E%9F%E7%90%86">æ ¸å¿ƒæ¶æ„ä¸åŸç†</a></li>
<li><a href="#%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE" title="#%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE">å®‰è£…ä¸é…ç½®</a></li>
<li><a href="#%E6%A0%B8%E5%BF%83-api-%E8%AF%A6%E8%A7%A3" title="#%E6%A0%B8%E5%BF%83-api-%E8%AF%A6%E8%A7%A3">æ ¸å¿ƒ API è¯¦è§£</a></li>
<li><a href="#%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7" title="#%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7">é«˜çº§ç‰¹æ€§</a></li>
<li><a href="#%E4%B8%8E-svgcanvaswebview-%E5%AF%B9%E6%AF%94%E5%88%86%E6%9E%90" title="#%E4%B8%8E-svgcanvaswebview-%E5%AF%B9%E6%AF%94%E5%88%86%E6%9E%90">ä¸ SVG/Canvas/WebView å¯¹æ¯”åˆ†æ</a></li>
<li><a href="#%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90" title="#%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90">æ€§èƒ½åˆ†æ</a></li>
<li><a href="#%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF" title="#%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF">å®é™…åº”ç”¨åœºæ™¯</a></li>
<li><a href="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5" title="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5">æœ€ä½³å®è·µ</a></li>
</ol>
<hr/>
<h3 data-id="heading-2">ä»€ä¹ˆæ˜¯ React Native Skia</h3>
<h4 data-id="heading-3">1.1 ç®€ä»‹</h4>
<p><code>@shopify/react-native-skia</code> æ˜¯ Shopify å¼€å‘çš„ React Native é«˜æ€§èƒ½ 2D å›¾å½¢åº“ï¼Œå®ƒå°† Google çš„ <strong>Skia å›¾å½¢å¼•æ“</strong>ç›´æ¥é›†æˆåˆ° React Native ä¸­ã€‚</p>
<p><strong>Skia æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<ul>
<li>Google å¼€å‘çš„ 2D å›¾å½¢åº“</li>
<li>è¢« Chromeã€Androidã€Flutterã€Firefox ç­‰å¹¿æ³›ä½¿ç”¨</li>
<li>æä¾›ç¡¬ä»¶åŠ é€Ÿçš„åŸç”Ÿå›¾å½¢æ¸²æŸ“èƒ½åŠ›</li>
</ul>
<h4 data-id="heading-4">1.2 æ ¸å¿ƒä¼˜åŠ¿</h4>
<ol>
<li><strong>åŸç”Ÿæ€§èƒ½</strong>ï¼šç›´æ¥è°ƒç”¨åŸç”Ÿ Skia å¼•æ“ï¼Œæ— éœ€ JS æ¡¥æ¥</li>
<li><strong>60fps æµç•…åŠ¨ç”»</strong>ï¼šæ”¯æŒå¤æ‚åŠ¨ç”»ï¼Œæ€§èƒ½æ¥è¿‘åŸç”Ÿåº”ç”¨</li>
<li><strong>ä¸°å¯ŒåŠŸèƒ½</strong>ï¼šæ”¯æŒè·¯å¾„ã€æ¸å˜ã€é˜´å½±ã€æ»¤é•œã€å›¾åƒå¤„ç†ç­‰</li>
<li><strong>ä¸ Reanimated é›†æˆ</strong>ï¼šå®Œç¾æ”¯æŒ react-native-reanimated</li>
<li><strong>è·¨å¹³å°ä¸€è‡´æ€§</strong>ï¼šiOS å’Œ Android è¡¨ç°ä¸€è‡´</li>
</ol>
<hr/>
<h3 data-id="heading-5">æ ¸å¿ƒæ¶æ„ä¸åŸç†</h3>
<h4 data-id="heading-6">2.1 æ¶æ„å›¾</h4>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     React Native Component         â”‚
â”‚  (Canvas, Path, Circle, etc.)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   React Native Skia (JS Bridge)    â”‚
â”‚   - å£°æ˜å¼ API                     â”‚
â”‚   - ç»„ä»¶åŒ–æ¸²æŸ“                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Skia C++ Engine (Native)      â”‚
â”‚   - ç¡¬ä»¶åŠ é€Ÿæ¸²æŸ“                    â”‚
â”‚   - GPU åŠ é€Ÿ                        â”‚
â”‚   - åŸç”Ÿæ€§èƒ½                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 data-id="heading-7">2.2 æ¸²æŸ“æµç¨‹</h4>
<ol>
<li><strong>å£°æ˜å¼ API</strong>ï¼šä½¿ç”¨ React ç»„ä»¶å£°æ˜å›¾å½¢</li>
<li><strong>Skia è·¯å¾„åˆ›å»º</strong>ï¼šåœ¨ JS çº¿ç¨‹åˆ›å»º Skia Path å¯¹è±¡</li>
<li><strong>åŸç”Ÿæ¸²æŸ“</strong>ï¼šPath å¯¹è±¡ä¼ é€’åˆ°åŸç”Ÿå±‚ï¼Œç”± Skia å¼•æ“æ¸²æŸ“</li>
<li><strong>GPU åŠ é€Ÿ</strong>ï¼šåˆ©ç”¨ GPU è¿›è¡Œç¡¬ä»¶åŠ é€Ÿæ¸²æŸ“</li>
</ol>
<h4 data-id="heading-8">2.3 ä¸ React Native é›†æˆ</h4>
<ul>
<li><strong>Worklet æ”¯æŒ</strong>ï¼šå¯ä»¥åœ¨ UI çº¿ç¨‹æ‰§è¡Œä»£ç </li>
<li><strong>Reanimated é›†æˆ</strong>ï¼šå…±äº«åŠ¨ç”»å€¼ï¼Œå®ç°æµç•…åŠ¨ç”»</li>
<li><strong>æ‰‹åŠ¿æ”¯æŒ</strong>ï¼šä¸ react-native-gesture-handler å®Œç¾é…åˆ</li>
</ul>
<hr/>
<h3 data-id="heading-9">å®‰è£…ä¸é…ç½®</h3>
<h4 data-id="heading-10">3.1 å®‰è£…</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨ yarn</span>
yarn add @shopify/react-native-skia

<span class="hljs-comment"># ä½¿ç”¨ npm</span>
npm install @shopify/react-native-skia

<span class="hljs-comment"># iOS å®‰è£…ä¾èµ–</span>
<span class="hljs-built_in">cd</span> ios &amp;&amp; pod install
</code></pre>
<h4 data-id="heading-11">3.2 ç‰ˆæœ¬è¦æ±‚</h4>
<ul>
<li>React Native &gt;= 0.66.0</li>
<li>iOS &gt;= 11.0</li>
<li>Android API Level &gt;= 21</li>
</ul>
<h4 data-id="heading-12">3.3 é…ç½®æ£€æŸ¥</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æ£€æŸ¥ Skia æ˜¯å¦å¯ç”¨</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Skia</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@shopify/react-native-skia'</span>;

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Skia available:'</span>, <span class="hljs-title class_">Skia</span> !== <span class="hljs-literal">null</span>);
</code></pre>
<hr/>
<h3 data-id="heading-13">æ ¸å¿ƒ API è¯¦è§£</h3>
<h4 data-id="heading-14">4.1 Canvas ç»„ä»¶</h4>
<p><code>Canvas</code> æ˜¯æ‰€æœ‰å›¾å½¢å…ƒç´ çš„å®¹å™¨ï¼Œç±»ä¼¼äº HTML5 Canvasã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Canvas</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@shopify/react-native-skia'</span>;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Canvas</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> <span class="hljs-attr">300</span>, <span class="hljs-attr">height:</span> <span class="hljs-attr">200</span> }}&gt;</span>
  {/* å›¾å½¢å…ƒç´  */}
<span class="hljs-tag">&lt;/<span class="hljs-name">Canvas</span>&gt;</span></span>
</code></pre>
<p><strong>å…³é”®å±æ€§ï¼š</strong></p>
<ul>
<li><code>style</code>: æ ·å¼å¯¹è±¡ï¼Œå®šä¹‰ Canvas å°ºå¯¸</li>
<li><code>onDraw</code>: è‡ªå®šä¹‰ç»˜åˆ¶å‡½æ•°ï¼ˆé«˜çº§ç”¨æ³•ï¼‰</li>
</ul>
<h4 data-id="heading-15">4.2 åŸºç¡€å›¾å½¢ç»„ä»¶</h4>
<h5 data-id="heading-16">Circleï¼ˆåœ†å½¢ï¼‰</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Canvas</span>, <span class="hljs-title class_">Circle</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@shopify/react-native-skia'</span>;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Canvas</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> <span class="hljs-attr">200</span>, <span class="hljs-attr">height:</span> <span class="hljs-attr">200</span> }}&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">{100}</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">{100}</span> <span class="hljs-attr">r</span>=<span class="hljs-string">{50}</span> <span class="hljs-attr">color</span>=<span class="hljs-string">"blue"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Canvas</span>&gt;</span></span>
</code></pre>
<p><strong>å±æ€§ï¼š</strong></p>
<ul>
<li><code>cx</code>, <code>cy</code>: åœ†å¿ƒåæ ‡</li>
<li><code>r</code>: åŠå¾„</li>
<li><code>color</code>: å¡«å……é¢œè‰²</li>
<li><code>opacity</code>: é€æ˜åº¦</li>
</ul>
<h5 data-id="heading-17">Rectï¼ˆçŸ©å½¢ï¼‰</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Canvas</span>, <span class="hljs-title class_">Rect</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@shopify/react-native-skia'</span>;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Canvas</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> <span class="hljs-attr">200</span>, <span class="hljs-attr">height:</span> <span class="hljs-attr">200</span> }}&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Rect</span> <span class="hljs-attr">x</span>=<span class="hljs-string">{50}</span> <span class="hljs-attr">y</span>=<span class="hljs-string">{50}</span> <span class="hljs-attr">width</span>=<span class="hljs-string">{100}</span> <span class="hljs-attr">height</span>=<span class="hljs-string">{100}</span> <span class="hljs-attr">color</span>=<span class="hljs-string">"red"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Canvas</span>&gt;</span></span>
</code></pre>
<h5 data-id="heading-18">RoundedRectï¼ˆåœ†è§’çŸ©å½¢ï¼‰</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Canvas</span>, <span class="hljs-title class_">RoundedRect</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@shopify/react-native-skia'</span>;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Canvas</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> <span class="hljs-attr">200</span>, <span class="hljs-attr">height:</span> <span class="hljs-attr">200</span> }}&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">RoundedRect</span> 
    <span class="hljs-attr">x</span>=<span class="hljs-string">{50}</span> 
    <span class="hljs-attr">y</span>=<span class="hljs-string">{50}</span> 
    <span class="hljs-attr">width</span>=<span class="hljs-string">{100}</span> 
    <span class="hljs-attr">height</span>=<span class="hljs-string">{100}</span> 
    <span class="hljs-attr">r</span>=<span class="hljs-string">{10}</span>  // <span class="hljs-attr">åœ†è§’åŠå¾„</span>
    <span class="hljs-attr">color</span>=<span class="hljs-string">"green"</span> 
  /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Canvas</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-19">4.3 Pathï¼ˆè·¯å¾„ï¼‰</h4>
<p><code>Path</code> æ˜¯æœ€å¼ºå¤§çš„ç»„ä»¶ï¼Œå¯ä»¥ç»˜åˆ¶ä»»æ„å½¢çŠ¶ã€‚</p>
<h5 data-id="heading-20">åŸºç¡€ç”¨æ³•</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Canvas</span>, <span class="hljs-title class_">Path</span>, <span class="hljs-title class_">Skia</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@shopify/react-native-skia'</span>;
<span class="hljs-keyword">import</span> { useMemo } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">MyComponent</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-comment">// åˆ›å»ºè·¯å¾„</span>
  <span class="hljs-keyword">const</span> path = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> p = <span class="hljs-title class_">Skia</span>.<span class="hljs-property">Path</span>.<span class="hljs-title class_">Make</span>();
    p.<span class="hljs-title function_">moveTo</span>(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>);      <span class="hljs-comment">// ç§»åŠ¨åˆ°èµ·ç‚¹</span>
    p.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">100</span>, <span class="hljs-number">0</span>);      <span class="hljs-comment">// ç”»çº¿åˆ°</span>
    p.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">200</span>, <span class="hljs-number">100</span>);    <span class="hljs-comment">// ç”»çº¿åˆ°</span>
    p.<span class="hljs-title function_">close</span>();             <span class="hljs-comment">// é—­åˆè·¯å¾„</span>
    <span class="hljs-keyword">return</span> p;
  }, []);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Canvas</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> <span class="hljs-attr">200</span>, <span class="hljs-attr">height:</span> <span class="hljs-attr">200</span> }}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Path</span> <span class="hljs-attr">path</span>=<span class="hljs-string">{path}</span> <span class="hljs-attr">color</span>=<span class="hljs-string">"blue"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Canvas</span>&gt;</span></span>
  );
};
</code></pre>
<h5 data-id="heading-21">Path API æ–¹æ³•</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> path = <span class="hljs-title class_">Skia</span>.<span class="hljs-property">Path</span>.<span class="hljs-title class_">Make</span>();

<span class="hljs-comment">// ç§»åŠ¨</span>
path.<span class="hljs-title function_">moveTo</span>(x, y);

<span class="hljs-comment">// ç›´çº¿</span>
path.<span class="hljs-title function_">lineTo</span>(x, y);

<span class="hljs-comment">// äºŒæ¬¡è´å¡å°”æ›²çº¿</span>
path.<span class="hljs-title function_">quadTo</span>(cpx, cpy, x, y);

<span class="hljs-comment">// ä¸‰æ¬¡è´å¡å°”æ›²çº¿</span>
path.<span class="hljs-title function_">cubicTo</span>(cp1x, cp1y, cp2x, cp2y, x, y);

<span class="hljs-comment">// åœ†å¼§</span>
path.<span class="hljs-title function_">arcTo</span>(rx, ry, xAxisRotation, largeArc, sweep, x, y);

<span class="hljs-comment">// é—­åˆè·¯å¾„</span>
path.<span class="hljs-title function_">close</span>();

<span class="hljs-comment">// å¤åˆ¶è·¯å¾„</span>
<span class="hljs-keyword">const</span> copy = path.<span class="hljs-title function_">copy</span>();

<span class="hljs-comment">// æ·»åŠ è·¯å¾„</span>
path.<span class="hljs-title function_">addPath</span>(otherPath);
</code></pre>
<h5 data-id="heading-22">å¤æ‚è·¯å¾„ç¤ºä¾‹</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ç»˜åˆ¶å¿ƒå½¢</span>
<span class="hljs-keyword">const</span> heartPath = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> p = <span class="hljs-title class_">Skia</span>.<span class="hljs-property">Path</span>.<span class="hljs-title class_">Make</span>();
  <span class="hljs-keyword">const</span> width = <span class="hljs-number">100</span>;
  <span class="hljs-keyword">const</span> height = <span class="hljs-number">100</span>;
  
  p.<span class="hljs-title function_">moveTo</span>(width / <span class="hljs-number">2</span>, height / <span class="hljs-number">4</span>);
  p.<span class="hljs-title function_">cubicTo</span>(width / <span class="hljs-number">2</span>, height / <span class="hljs-number">4</span>, width / <span class="hljs-number">4</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, height / <span class="hljs-number">4</span>);
  p.<span class="hljs-title function_">cubicTo</span>(<span class="hljs-number">0</span>, height / <span class="hljs-number">4</span>, <span class="hljs-number">0</span>, height / <span class="hljs-number">2</span>, width / <span class="hljs-number">4</span>, height / <span class="hljs-number">2</span>);
  p.<span class="hljs-title function_">cubicTo</span>(width / <span class="hljs-number">4</span>, height / <span class="hljs-number">2</span>, width / <span class="hljs-number">2</span>, height / <span class="hljs-number">2</span>, width / <span class="hljs-number">2</span>, height * <span class="hljs-number">3</span> / <span class="hljs-number">4</span>);
  p.<span class="hljs-title function_">cubicTo</span>(width / <span class="hljs-number">2</span>, height / <span class="hljs-number">2</span>, width * <span class="hljs-number">3</span> / <span class="hljs-number">4</span>, height / <span class="hljs-number">2</span>, width, height / <span class="hljs-number">2</span>);
  p.<span class="hljs-title function_">cubicTo</span>(width, height / <span class="hljs-number">2</span>, width, height / <span class="hljs-number">4</span>, width * <span class="hljs-number">3</span> / <span class="hljs-number">4</span>, height / <span class="hljs-number">4</span>);
  p.<span class="hljs-title function_">cubicTo</span>(width * <span class="hljs-number">3</span> / <span class="hljs-number">4</span>, height / <span class="hljs-number">4</span>, width / <span class="hljs-number">2</span>, height / <span class="hljs-number">4</span>, width / <span class="hljs-number">2</span>, height / <span class="hljs-number">4</span>);
  p.<span class="hljs-title function_">close</span>();
  
  <span class="hljs-keyword">return</span> p;
}, []);
</code></pre>
<h4 data-id="heading-23">4.4 æ¸å˜ï¼ˆGradientï¼‰</h4>
<h5 data-id="heading-24">LinearGradientï¼ˆçº¿æ€§æ¸å˜ï¼‰</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Canvas</span>, <span class="hljs-title class_">Rect</span>, <span class="hljs-title class_">LinearGradient</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@shopify/react-native-skia'</span>;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Canvas</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> <span class="hljs-attr">200</span>, <span class="hljs-attr">height:</span> <span class="hljs-attr">200</span> }}&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Rect</span> <span class="hljs-attr">x</span>=<span class="hljs-string">{0}</span> <span class="hljs-attr">y</span>=<span class="hljs-string">{0}</span> <span class="hljs-attr">width</span>=<span class="hljs-string">{200}</span> <span class="hljs-attr">height</span>=<span class="hljs-string">{200}</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">LinearGradient</span>
      <span class="hljs-attr">start</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">x:</span> <span class="hljs-attr">0</span>, <span class="hljs-attr">y:</span> <span class="hljs-attr">0</span> }}
      <span class="hljs-attr">end</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">x:</span> <span class="hljs-attr">200</span>, <span class="hljs-attr">y:</span> <span class="hljs-attr">200</span> }}
      <span class="hljs-attr">colors</span>=<span class="hljs-string">{[</span>'#<span class="hljs-attr">FF0000</span>', '#<span class="hljs-attr">0000FF</span>']}
    /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">Rect</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Canvas</span>&gt;</span></span>
</code></pre>
<h5 data-id="heading-25">RadialGradientï¼ˆå¾„å‘æ¸å˜ï¼‰</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Canvas</span>, <span class="hljs-title class_">Circle</span>, <span class="hljs-title class_">RadialGradient</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@shopify/react-native-skia'</span>;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Canvas</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> <span class="hljs-attr">200</span>, <span class="hljs-attr">height:</span> <span class="hljs-attr">200</span> }}&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">{100}</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">{100}</span> <span class="hljs-attr">r</span>=<span class="hljs-string">{80}</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">RadialGradient</span>
      <span class="hljs-attr">c</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">x:</span> <span class="hljs-attr">100</span>, <span class="hljs-attr">y:</span> <span class="hljs-attr">100</span> }}
      <span class="hljs-attr">r</span>=<span class="hljs-string">{80}</span>
      <span class="hljs-attr">colors</span>=<span class="hljs-string">{[</span>'#<span class="hljs-attr">FF0000</span>', '#<span class="hljs-attr">0000FF</span>']}
    /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">Circle</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Canvas</span>&gt;</span></span>
</code></pre>
<h5 data-id="heading-26">SweepGradientï¼ˆæ‰«ææ¸å˜ï¼‰</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Canvas</span>, <span class="hljs-title class_">Circle</span>, <span class="hljs-title class_">SweepGradient</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@shopify/react-native-skia'</span>;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Canvas</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> <span class="hljs-attr">200</span>, <span class="hljs-attr">height:</span> <span class="hljs-attr">200</span> }}&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">{100}</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">{100}</span> <span class="hljs-attr">r</span>=<span class="hljs-string">{80}</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">SweepGradient</span>
      <span class="hljs-attr">c</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">x:</span> <span class="hljs-attr">100</span>, <span class="hljs-attr">y:</span> <span class="hljs-attr">100</span> }}
      <span class="hljs-attr">colors</span>=<span class="hljs-string">{[</span>'#<span class="hljs-attr">FF0000</span>', '#<span class="hljs-attr">00FF00</span>', '#<span class="hljs-attr">0000FF</span>', '#<span class="hljs-attr">FF0000</span>']}
    /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">Circle</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Canvas</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-27">4.5 å›¾åƒå¤„ç†</h4>
<h5 data-id="heading-28">Image ç»„ä»¶</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Canvas</span>, <span class="hljs-title class_">Image</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@shopify/react-native-skia'</span>;
<span class="hljs-keyword">import</span> { useImage } <span class="hljs-keyword">from</span> <span class="hljs-string">'@shopify/react-native-skia'</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">MyComponent</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-comment">// åŠ è½½å›¾ç‰‡</span>
  <span class="hljs-keyword">const</span> image = <span class="hljs-title function_">useImage</span>(<span class="hljs-built_in">require</span>(<span class="hljs-string">'./assets/image.png'</span>));
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Canvas</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> <span class="hljs-attr">200</span>, <span class="hljs-attr">height:</span> <span class="hljs-attr">200</span> }}&gt;</span>
      {image &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">Image</span>
          <span class="hljs-attr">image</span>=<span class="hljs-string">{image}</span>
          <span class="hljs-attr">x</span>=<span class="hljs-string">{0}</span>
          <span class="hljs-attr">y</span>=<span class="hljs-string">{0}</span>
          <span class="hljs-attr">width</span>=<span class="hljs-string">{200}</span>
          <span class="hljs-attr">height</span>=<span class="hljs-string">{200}</span>
        /&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">Canvas</span>&gt;</span></span>
  );
};
</code></pre>
<h5 data-id="heading-29">å›¾ç‰‡æ»¤é•œ</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Canvas</span>, <span class="hljs-title class_">Image</span>, <span class="hljs-title class_">Blur</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@shopify/react-native-skia'</span>;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Canvas</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> <span class="hljs-attr">200</span>, <span class="hljs-attr">height:</span> <span class="hljs-attr">200</span> }}&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Image</span> <span class="hljs-attr">image</span>=<span class="hljs-string">{image}</span> <span class="hljs-attr">x</span>=<span class="hljs-string">{0}</span> <span class="hljs-attr">y</span>=<span class="hljs-string">{0}</span> <span class="hljs-attr">width</span>=<span class="hljs-string">{200}</span> <span class="hljs-attr">height</span>=<span class="hljs-string">{200}</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Blur</span> <span class="hljs-attr">blur</span>=<span class="hljs-string">{10}</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">Image</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Canvas</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-30">4.6 æ–‡æœ¬æ¸²æŸ“</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Canvas</span>, <span class="hljs-title class_">Text</span>, useFont } <span class="hljs-keyword">from</span> <span class="hljs-string">'@shopify/react-native-skia'</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">MyComponent</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-comment">// åŠ è½½å­—ä½“</span>
  <span class="hljs-keyword">const</span> font = <span class="hljs-title function_">useFont</span>(<span class="hljs-built_in">require</span>(<span class="hljs-string">'./assets/font.ttf'</span>), <span class="hljs-number">24</span>);
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Canvas</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> <span class="hljs-attr">200</span>, <span class="hljs-attr">height:</span> <span class="hljs-attr">200</span> }}&gt;</span>
      {font &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">Text</span>
          <span class="hljs-attr">x</span>=<span class="hljs-string">{10}</span>
          <span class="hljs-attr">y</span>=<span class="hljs-string">{50}</span>
          <span class="hljs-attr">text</span>=<span class="hljs-string">"Hello Skia"</span>
          <span class="hljs-attr">font</span>=<span class="hljs-string">{font}</span>
          <span class="hljs-attr">color</span>=<span class="hljs-string">"black"</span>
        /&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">Canvas</span>&gt;</span></span>
  );
};
</code></pre>
<h4 data-id="heading-31">4.7 åŠ¨ç”»é›†æˆ</h4>
<h5 data-id="heading-32">ä¸ Reanimated é›†æˆ</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Canvas</span>, <span class="hljs-title class_">Circle</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@shopify/react-native-skia'</span>;
<span class="hljs-keyword">import</span> { useSharedValue, withRepeat, withTiming } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-native-reanimated'</span>;
<span class="hljs-keyword">import</span> { useDerivedValue } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-native-reanimated'</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">AnimatedCircle</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> progress = <span class="hljs-title function_">useSharedValue</span>(<span class="hljs-number">0</span>);
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    progress.<span class="hljs-property">value</span> = <span class="hljs-title function_">withRepeat</span>(
      <span class="hljs-title function_">withTiming</span>(<span class="hljs-number">1</span>, { <span class="hljs-attr">duration</span>: <span class="hljs-number">1000</span> }),
      -<span class="hljs-number">1</span>,
      <span class="hljs-literal">true</span>
    );
  }, []);
  
  <span class="hljs-keyword">const</span> cx = <span class="hljs-title function_">useDerivedValue</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-number">100</span> + progress.<span class="hljs-property">value</span> * <span class="hljs-number">100</span>;
  });
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Canvas</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> <span class="hljs-attr">300</span>, <span class="hljs-attr">height:</span> <span class="hljs-attr">200</span> }}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">{cx}</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">{100}</span> <span class="hljs-attr">r</span>=<span class="hljs-string">{20}</span> <span class="hljs-attr">color</span>=<span class="hljs-string">"blue"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Canvas</span>&gt;</span></span>
  );
};
</code></pre>
<hr/>
<h3 data-id="heading-33">é«˜çº§ç‰¹æ€§</h3>
<h4 data-id="heading-34">5.1 Groupï¼ˆç»„åˆï¼‰</h4>
<p><code>Group</code> å¯ä»¥å°†å¤šä¸ªå…ƒç´ ç»„åˆï¼Œç»Ÿä¸€åº”ç”¨å˜æ¢ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Canvas</span>, <span class="hljs-title class_">Group</span>, <span class="hljs-title class_">Circle</span>, <span class="hljs-title class_">Rect</span>, <span class="hljs-title class_">Transform</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@shopify/react-native-skia'</span>;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Canvas</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> <span class="hljs-attr">200</span>, <span class="hljs-attr">height:</span> <span class="hljs-attr">200</span> }}&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Group</span> <span class="hljs-attr">transform</span>=<span class="hljs-string">{[{</span> <span class="hljs-attr">rotate:</span> <span class="hljs-attr">Math.PI</span> / <span class="hljs-attr">4</span> }]}&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">{50}</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">{50}</span> <span class="hljs-attr">r</span>=<span class="hljs-string">{20}</span> <span class="hljs-attr">color</span>=<span class="hljs-string">"red"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Rect</span> <span class="hljs-attr">x</span>=<span class="hljs-string">{80}</span> <span class="hljs-attr">y</span>=<span class="hljs-string">{80}</span> <span class="hljs-attr">width</span>=<span class="hljs-string">{40}</span> <span class="hljs-attr">height</span>=<span class="hljs-string">{40}</span> <span class="hljs-attr">color</span>=<span class="hljs-string">"blue"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">Group</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Canvas</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-35">5.2 å˜æ¢ï¼ˆTransformï¼‰</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Canvas</span>, <span class="hljs-title class_">Circle</span>, <span class="hljs-title class_">Transform</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@shopify/react-native-skia'</span>;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Canvas</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> <span class="hljs-attr">200</span>, <span class="hljs-attr">height:</span> <span class="hljs-attr">200</span> }}&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">{100}</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">{100}</span> <span class="hljs-attr">r</span>=<span class="hljs-string">{30}</span> <span class="hljs-attr">color</span>=<span class="hljs-string">"blue"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Transform</span>
      <span class="hljs-attr">transform</span>=<span class="hljs-string">{[</span>
        { <span class="hljs-attr">translateX:</span> <span class="hljs-attr">50</span> },
        { <span class="hljs-attr">translateY:</span> <span class="hljs-attr">50</span> },
        { <span class="hljs-attr">rotate:</span> <span class="hljs-attr">Math.PI</span> / <span class="hljs-attr">4</span> },
        { <span class="hljs-attr">scale:</span> <span class="hljs-attr">1.5</span> }
      ]}
    /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">Circle</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Canvas</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-36">5.3 æ··åˆæ¨¡å¼ï¼ˆBlend Modeï¼‰</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Canvas</span>, <span class="hljs-title class_">Circle</span>, <span class="hljs-title class_">Rect</span>, <span class="hljs-title class_">BlendMode</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@shopify/react-native-skia'</span>;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Canvas</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> <span class="hljs-attr">200</span>, <span class="hljs-attr">height:</span> <span class="hljs-attr">200</span> }}&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Rect</span> <span class="hljs-attr">x</span>=<span class="hljs-string">{0}</span> <span class="hljs-attr">y</span>=<span class="hljs-string">{0}</span> <span class="hljs-attr">width</span>=<span class="hljs-string">{200}</span> <span class="hljs-attr">height</span>=<span class="hljs-string">{200}</span> <span class="hljs-attr">color</span>=<span class="hljs-string">"red"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">{100}</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">{100}</span> <span class="hljs-attr">r</span>=<span class="hljs-string">{50}</span> <span class="hljs-attr">color</span>=<span class="hljs-string">"blue"</span> <span class="hljs-attr">blendMode</span>=<span class="hljs-string">"multiply"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Canvas</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-37">5.4 é˜´å½±ï¼ˆShadowï¼‰</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Canvas</span>, <span class="hljs-title class_">Circle</span>, <span class="hljs-title class_">Shadow</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@shopify/react-native-skia'</span>;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Canvas</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> <span class="hljs-attr">200</span>, <span class="hljs-attr">height:</span> <span class="hljs-attr">200</span> }}&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">{100}</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">{100}</span> <span class="hljs-attr">r</span>=<span class="hljs-string">{30}</span> <span class="hljs-attr">color</span>=<span class="hljs-string">"blue"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Shadow</span> <span class="hljs-attr">dx</span>=<span class="hljs-string">{5}</span> <span class="hljs-attr">dy</span>=<span class="hljs-string">{5}</span> <span class="hljs-attr">blur</span>=<span class="hljs-string">{10}</span> <span class="hljs-attr">color</span>=<span class="hljs-string">"rgba(0,0,0,0.3)"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">Circle</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Canvas</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-38">5.5 è‡ªå®šä¹‰ç»˜åˆ¶ï¼ˆonDrawï¼‰</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Canvas</span>, <span class="hljs-title class_">Skia</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@shopify/react-native-skia'</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">CustomDraw</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> onDraw = <span class="hljs-title function_">useDrawCallback</span>(<span class="hljs-function">(<span class="hljs-params">canvas</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> paint = <span class="hljs-title class_">Skia</span>.<span class="hljs-title class_">Paint</span>();
    paint.<span class="hljs-title function_">setColor</span>(<span class="hljs-title class_">Skia</span>.<span class="hljs-title class_">Color</span>(<span class="hljs-string">'#FF0000'</span>));
    
    canvas.<span class="hljs-title function_">drawCircle</span>(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">50</span>, paint);
  });
  
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Canvas</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> <span class="hljs-attr">200</span>, <span class="hljs-attr">height:</span> <span class="hljs-attr">200</span> }} <span class="hljs-attr">onDraw</span>=<span class="hljs-string">{onDraw}</span> /&gt;</span></span>;
};
</code></pre>
<hr/>
<h3 data-id="heading-39">ä¸ SVG/Canvas/WebView å¯¹æ¯”åˆ†æ</h3>
<h4 data-id="heading-40">6.1 æŠ€æœ¯æ¶æ„å¯¹æ¯”</h4>





























































<table><thead><tr><th>ç‰¹æ€§</th><th>React Native Skia</th><th>react-native-svg</th><th>Canvas (WebView)</th><th>WebView Chart</th></tr></thead><tbody><tr><td><strong>æ¸²æŸ“å¼•æ“</strong></td><td>Skia (åŸç”Ÿ C++)</td><td>åŸç”Ÿ SVG æ¸²æŸ“å™¨</td><td>HTML5 Canvas</td><td>WebView + JS Chart</td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>â­â­â­â­â­ åŸç”Ÿæ€§èƒ½</td><td>â­â­â­â­ è‰¯å¥½</td><td>â­â­ å—é™äº WebView</td><td>â­â­ æœ€æ…¢</td></tr><tr><td><strong>å†…å­˜å ç”¨</strong></td><td>ä½</td><td>ä¸­ç­‰</td><td>é«˜</td><td>æœ€é«˜</td></tr><tr><td><strong>åŠ¨ç”»æ€§èƒ½</strong></td><td>60fps æµç•…</td><td>30-60fps</td><td>10-30fps</td><td>10-20fps</td></tr><tr><td><strong>åŠŸèƒ½ä¸°å¯Œåº¦</strong></td><td>â­â­â­â­â­</td><td>â­â­â­</td><td>â­â­â­â­</td><td>â­â­â­â­â­</td></tr><tr><td><strong>å­¦ä¹ æ›²çº¿</strong></td><td>ä¸­ç­‰</td><td>ç®€å•</td><td>ç®€å•</td><td>ç®€å•</td></tr><tr><td><strong>åŒ…ä½“ç§¯</strong></td><td>~2MB</td><td>~500KB</td><td>0 (ç³»ç»Ÿè‡ªå¸¦)</td><td>0 (ç³»ç»Ÿè‡ªå¸¦)</td></tr></tbody></table>
<h4 data-id="heading-41">6.2 æ€§èƒ½å¯¹æ¯”è¯¦è§£</h4>
<h5 data-id="heading-42">6.2.1 æ¸²æŸ“æ€§èƒ½</h5>
<p><strong>React Native Skia:</strong></p>
<ul>
<li>âœ… ç›´æ¥è°ƒç”¨åŸç”Ÿ Skia å¼•æ“</li>
<li>âœ… GPU ç¡¬ä»¶åŠ é€Ÿ</li>
<li>âœ… æ—  JS æ¡¥æ¥å¼€é”€</li>
<li>âœ… 60fps æµç•…æ¸²æŸ“</li>
<li>âœ… æ”¯æŒå¤æ‚å›¾å½¢å’ŒåŠ¨ç”»</li>
</ul>
<p><strong>react-native-svg:</strong></p>
<ul>
<li>âœ… åŸç”Ÿ SVG æ¸²æŸ“</li>
<li>âš ï¸ ç®€å•å›¾å½¢æ€§èƒ½å¥½</li>
<li>âŒ å¤æ‚å›¾å½¢æ€§èƒ½ä¸‹é™</li>
<li>âš ï¸ åŠ¨ç”»æ€§èƒ½ä¸€èˆ¬ï¼ˆ30-60fpsï¼‰</li>
</ul>
<p><strong>Canvas (WebView):</strong></p>
<ul>
<li>âŒ éœ€è¦ JS æ¡¥æ¥</li>
<li>âŒ WebView æ€§èƒ½ç“¶é¢ˆ</li>
<li>âŒ å†…å­˜å ç”¨é«˜</li>
<li>âŒ åŠ¨ç”»å¡é¡¿ï¼ˆ10-30fpsï¼‰</li>
</ul>
<p><strong>WebView Chart:</strong></p>
<ul>
<li>âŒ åŒé‡æ¡¥æ¥ï¼ˆRN â†’ WebView â†’ JSï¼‰</li>
<li>âŒ æ€§èƒ½æœ€å·®</li>
<li>âŒ å†…å­˜å ç”¨æœ€é«˜</li>
<li>âŒ åŠ¨ç”»ä¸¥é‡å¡é¡¿ï¼ˆ10-20fpsï¼‰</li>
</ul>
<h5 data-id="heading-43">6.2.2 å†…å­˜å ç”¨å¯¹æ¯”</h5>
<pre><code class="hljs language-ini" lang="ini">Skia:        <span class="hljs-section">[â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘]</span> 20MB (åŸç”Ÿå¼•æ“)
SVG:         <span class="hljs-section">[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘]</span> 40MB (åŸç”Ÿæ¸²æŸ“å™¨)
Canvas:      <span class="hljs-section">[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘]</span> 80MB (WebView + JS)
WebView:     <span class="hljs-section">[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ]</span> 100MB+ (WebView + Chartåº“ + JS)
</code></pre>
<h5 data-id="heading-44">6.2.3 åŠ¨ç”»æ€§èƒ½æµ‹è¯•</h5>
<p><strong>æµ‹è¯•åœºæ™¯ï¼š</strong> 1000 ä¸ªåœ†å½¢åŒæ—¶åŠ¨ç”»</p>








































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>FPS</th><th>CPU å ç”¨</th><th>å†…å­˜å ç”¨</th><th>ç”µæ± æ¶ˆè€—</th></tr></thead><tbody><tr><td>Skia</td><td>60</td><td>15%</td><td>25MB</td><td>ä½</td></tr><tr><td>SVG</td><td>35</td><td>45%</td><td>60MB</td><td>ä¸­</td></tr><tr><td>Canvas</td><td>18</td><td>70%</td><td>120MB</td><td>é«˜</td></tr><tr><td>WebView</td><td>12</td><td>85%</td><td>150MB</td><td>å¾ˆé«˜</td></tr></tbody></table>
<h4 data-id="heading-45">6.3 åŠŸèƒ½å¯¹æ¯”</h4>
<h5 data-id="heading-46">6.3.1 åŸºç¡€å›¾å½¢</h5>















































<table><thead><tr><th>åŠŸèƒ½</th><th>Skia</th><th>SVG</th><th>Canvas</th><th>WebView</th></tr></thead><tbody><tr><td>åœ†å½¢</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td>çŸ©å½¢</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td>è·¯å¾„</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td>æ–‡æœ¬</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td>å›¾ç‰‡</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr></tbody></table>
<h5 data-id="heading-47">6.3.2 é«˜çº§åŠŸèƒ½</h5>





























































<table><thead><tr><th>åŠŸèƒ½</th><th>Skia</th><th>SVG</th><th>Canvas</th><th>WebView</th></tr></thead><tbody><tr><td>æ¸å˜</td><td>âœ… ä¸°å¯Œ</td><td>âœ… åŸºç¡€</td><td>âœ… ä¸°å¯Œ</td><td>âœ… ä¸°å¯Œ</td></tr><tr><td>é˜´å½±</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td>æ»¤é•œ</td><td>âœ… ä¸°å¯Œ</td><td>âš ï¸ æœ‰é™</td><td>âœ… ä¸°å¯Œ</td><td>âœ… ä¸°å¯Œ</td></tr><tr><td>æ··åˆæ¨¡å¼</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td>3D å˜æ¢</td><td>âœ…</td><td>âŒ</td><td>âœ…</td><td>âœ…</td></tr><tr><td>å›¾åƒå¤„ç†</td><td>âœ…</td><td>âŒ</td><td>âœ…</td><td>âœ…</td></tr><tr><td>è‡ªå®šä¹‰ç€è‰²å™¨</td><td>âœ…</td><td>âŒ</td><td>âœ…</td><td>âœ…</td></tr></tbody></table>
<h5 data-id="heading-48">6.3.4 åŠ¨ç”»èƒ½åŠ›</h5>















































<table><thead><tr><th>ç‰¹æ€§</th><th>Skia</th><th>SVG</th><th>Canvas</th><th>WebView</th></tr></thead><tbody><tr><td>åŸºç¡€åŠ¨ç”»</td><td>âœ… 60fps</td><td>âš ï¸ 30-60fps</td><td>âš ï¸ 10-30fps</td><td>âŒ 10-20fps</td></tr><tr><td>å¤æ‚åŠ¨ç”»</td><td>âœ…</td><td>âŒ</td><td>âš ï¸</td><td>âŒ</td></tr><tr><td>æ‰‹åŠ¿åŠ¨ç”»</td><td>âœ…</td><td>âš ï¸</td><td>âš ï¸</td><td>âŒ</td></tr><tr><td>ç‰©ç†åŠ¨ç”»</td><td>âœ…</td><td>âŒ</td><td>âš ï¸</td><td>âŒ</td></tr><tr><td>ä¸ Reanimated é›†æˆ</td><td>âœ… å®Œç¾</td><td>âš ï¸ æœ‰é™</td><td>âŒ</td><td>âŒ</td></tr></tbody></table>
<h4 data-id="heading-49">6.4 ä»£ç å¯¹æ¯”ç¤ºä¾‹</h4>
<h5 data-id="heading-50">6.4.1 ç»˜åˆ¶ç®€å•æŠ˜çº¿å›¾</h5>
<p><strong>React Native Skia:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Canvas</span>, <span class="hljs-title class_">Path</span>, <span class="hljs-title class_">Skia</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@shopify/react-native-skia'</span>;

<span class="hljs-keyword">const</span> path = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> p = <span class="hljs-title class_">Skia</span>.<span class="hljs-property">Path</span>.<span class="hljs-title class_">Make</span>();
  p.<span class="hljs-title function_">moveTo</span>(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>);
  p.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">50</span>, <span class="hljs-number">50</span>);
  p.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">100</span>, <span class="hljs-number">80</span>);
  <span class="hljs-keyword">return</span> p;
}, []);

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Canvas</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> <span class="hljs-attr">100</span>, <span class="hljs-attr">height:</span> <span class="hljs-attr">100</span> }}&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Path</span> <span class="hljs-attr">path</span>=<span class="hljs-string">{path}</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"stroke"</span> <span class="hljs-attr">strokeWidth</span>=<span class="hljs-string">{2}</span> <span class="hljs-attr">color</span>=<span class="hljs-string">"blue"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Canvas</span>&gt;</span></span>
</code></pre>
<p><strong>react-native-svg:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Svg</span>, { <span class="hljs-title class_">Path</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-native-svg'</span>;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Svg</span> <span class="hljs-attr">width</span>=<span class="hljs-string">{100}</span> <span class="hljs-attr">height</span>=<span class="hljs-string">{100}</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Path</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M 0 100 L 50 50 L 100 80"</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">"blue"</span> <span class="hljs-attr">strokeWidth</span>=<span class="hljs-string">{2}</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">"none"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Svg</span>&gt;</span></span>
</code></pre>
<p><strong>Canvas (WebView):</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">WebView</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-native-webview'</span>;

<span class="hljs-keyword">const</span> html = <span class="hljs-string">`
  &lt;canvas id="canvas" width="100" height="100"&gt;&lt;/canvas&gt;
  &lt;script&gt;
    const ctx = document.getElementById('canvas').getContext('2d');
    ctx.beginPath();
    ctx.moveTo(0, 100);
    ctx.lineTo(50, 50);
    ctx.lineTo(100, 80);
    ctx.strokeStyle = 'blue';
    ctx.lineWidth = 2;
    ctx.stroke();
  &lt;/script&gt;
`</span>;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">WebView</span> <span class="hljs-attr">source</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">html</span> }} /&gt;</span></span>
</code></pre>
<p><strong>æ€§èƒ½å¯¹æ¯”ï¼š</strong></p>
<ul>
<li>Skia: 60fpsï¼Œå†…å­˜ 20MB</li>
<li>SVG: 45fpsï¼Œå†…å­˜ 35MB</li>
<li>Canvas: 25fpsï¼Œå†…å­˜ 80MB</li>
</ul>
<h5 data-id="heading-51">6.4.2 å¤æ‚åŠ¨ç”»ç¤ºä¾‹</h5>
<p><strong>Skia + Reanimatedï¼ˆ60fps æµç•…ï¼‰:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> progress = <span class="hljs-title function_">useSharedValue</span>(<span class="hljs-number">0</span>);
<span class="hljs-keyword">const</span> cx = <span class="hljs-title function_">useDerivedValue</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-number">100</span> + progress.<span class="hljs-property">value</span> * <span class="hljs-number">100</span>);

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">{cx}</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">{100}</span> <span class="hljs-attr">r</span>=<span class="hljs-string">{20}</span> <span class="hljs-attr">color</span>=<span class="hljs-string">"blue"</span> /&gt;</span></span>
</code></pre>
<p><strong>SVG + Animatedï¼ˆ30-45fpsï¼‰:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> animValue = <span class="hljs-title function_">useRef</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Animated</span>.<span class="hljs-title class_">Value</span>(<span class="hljs-number">0</span>)).<span class="hljs-property">current</span>;
<span class="hljs-keyword">const</span> cx = animValue.<span class="hljs-title function_">interpolate</span>({ <span class="hljs-attr">inputRange</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>], <span class="hljs-attr">outputRange</span>: [<span class="hljs-number">100</span>, <span class="hljs-number">200</span>] });

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">{cx}</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">{100}</span> <span class="hljs-attr">r</span>=<span class="hljs-string">{20}</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">"blue"</span> /&gt;</span></span>
</code></pre>
<p><strong>Canvas + setIntervalï¼ˆ10-20fps å¡é¡¿ï¼‰:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// éœ€è¦æ‰‹åŠ¨ç®¡ç†åŠ¨ç”»å¾ªç¯ï¼Œæ€§èƒ½å·®</span>
<span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// é‡ç»˜æ•´ä¸ª Canvas</span>
}, <span class="hljs-number">16</span>);
</code></pre>
<h4 data-id="heading-52">6.5 é€‚ç”¨åœºæ™¯å¯¹æ¯”</h4>
<h5 data-id="heading-53">React Native Skia é€‚åˆï¼š</h5>
<ul>
<li>âœ… å¤æ‚å›¾è¡¨ï¼ˆå®æ—¶æ•°æ®ã€å¤§é‡æ•°æ®ç‚¹ï¼‰</li>
<li>âœ… é«˜æ€§èƒ½åŠ¨ç”»ï¼ˆ60fps è¦æ±‚ï¼‰</li>
<li>âœ… è‡ªå®šä¹‰å›¾å½¢ç»˜åˆ¶ï¼ˆæ¶‚é¸¦ã€ç­¾åï¼‰</li>
<li>âœ… å›¾åƒå¤„ç†ï¼ˆæ»¤é•œã€å˜æ¢ï¼‰</li>
<li>âœ… æ¸¸æˆ UIï¼ˆç²’å­æ•ˆæœã€ç‰¹æ•ˆï¼‰</li>
<li>âœ… æ•°æ®å¯è§†åŒ–ï¼ˆå®æ—¶æ›´æ–°ï¼‰</li>
</ul>
<h5 data-id="heading-54">react-native-svg é€‚åˆï¼š</h5>
<ul>
<li>âœ… ç®€å•å›¾æ ‡å’ŒçŸ¢é‡å›¾</li>
<li>âœ… é™æ€å›¾å½¢å±•ç¤º</li>
<li>âœ… ç®€å•çš„åŠ¨ç”»æ•ˆæœ</li>
<li>âœ… éœ€è¦ SVG æ ¼å¼å…¼å®¹æ€§</li>
</ul>
<h5 data-id="heading-55">Canvas (WebView) é€‚åˆï¼š</h5>
<ul>
<li>âœ… å·²æœ‰ Web å›¾è¡¨åº“ï¼ˆChart.jsã€EChartsï¼‰</li>
<li>âœ… å¿«é€ŸåŸå‹å¼€å‘</li>
<li>âœ… ä¸éœ€è¦é«˜æ€§èƒ½çš„åœºæ™¯</li>
<li>âœ… éœ€è¦å¤ç”¨ Web ä»£ç </li>
</ul>
<h5 data-id="heading-56">WebView Chart é€‚åˆï¼š</h5>
<ul>
<li>âœ… å·²æœ‰å®Œæ•´çš„ Web å›¾è¡¨æ–¹æ¡ˆ</li>
<li>âœ… ä¸éœ€è¦åŸç”Ÿæ€§èƒ½</li>
<li>âœ… å¿«é€Ÿé›†æˆç°æœ‰æ–¹æ¡ˆ</li>
</ul>
<hr/>
<h3 data-id="heading-57">æ€§èƒ½åˆ†æ</h3>
<h4 data-id="heading-58">7.1 æ¸²æŸ“æ€§èƒ½æµ‹è¯•</h4>
<h5 data-id="heading-59">æµ‹è¯• 1: 1000 ä¸ªåœ†å½¢æ¸²æŸ“</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// Skia</span>
<span class="hljs-keyword">const</span> circles = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: <span class="hljs-number">1000</span> }, <span class="hljs-function">(<span class="hljs-params">_, i</span>) =&gt;</span> (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Circle</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{i}</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">{i</span> % <span class="hljs-attr">50</span> * <span class="hljs-attr">10</span>} <span class="hljs-attr">cy</span>=<span class="hljs-string">{Math.floor(i</span> / <span class="hljs-attr">50</span>) * <span class="hljs-attr">10</span>} <span class="hljs-attr">r</span>=<span class="hljs-string">{5}</span> <span class="hljs-attr">color</span>=<span class="hljs-string">"blue"</span> /&gt;</span></span>
));

<span class="hljs-comment">// ç»“æœ: 60fps, CPU 15%, å†…å­˜ 25MB</span>
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// SVG</span>
<span class="hljs-keyword">const</span> circles = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: <span class="hljs-number">1000</span> }, <span class="hljs-function">(<span class="hljs-params">_, i</span>) =&gt;</span> (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Circle</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{i}</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">{i</span> % <span class="hljs-attr">50</span> * <span class="hljs-attr">10</span>} <span class="hljs-attr">cy</span>=<span class="hljs-string">{Math.floor(i</span> / <span class="hljs-attr">50</span>) * <span class="hljs-attr">10</span>} <span class="hljs-attr">r</span>=<span class="hljs-string">{5}</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">"blue"</span> /&gt;</span></span>
));

<span class="hljs-comment">// ç»“æœ: 35fps, CPU 45%, å†…å­˜ 60MB</span>
</code></pre>
<h5 data-id="heading-60">æµ‹è¯• 2: å¤æ‚è·¯å¾„åŠ¨ç”»</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// Skia + Reanimated</span>
<span class="hljs-keyword">const</span> animatedPath = <span class="hljs-title function_">useDerivedValue</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// åœ¨ UI çº¿ç¨‹è®¡ç®—ï¼Œ60fps</span>
});

<span class="hljs-comment">// ç»“æœ: 60fps æµç•…</span>
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// SVG + Animated</span>
<span class="hljs-keyword">const</span> animatedPath = animValue.<span class="hljs-title function_">interpolate</span>(...);

<span class="hljs-comment">// ç»“æœ: 30-45fpsï¼Œå¶å°”å¡é¡¿</span>
</code></pre>
<h4 data-id="heading-61">7.2 å†…å­˜å ç”¨åˆ†æ</h4>
<p><strong>Skia:</strong></p>
<ul>
<li>åŸºç¡€åº“: ~2MB</li>
<li>è¿è¡Œæ—¶: 20-50MBï¼ˆå–å†³äºå¤æ‚åº¦ï¼‰</li>
<li>ä¼˜åŠ¿: åŸç”Ÿå†…å­˜ç®¡ç†ï¼Œè‡ªåŠ¨é‡Šæ”¾</li>
</ul>
<p><strong>SVG:</strong></p>
<ul>
<li>åŸºç¡€åº“: ~500KB</li>
<li>è¿è¡Œæ—¶: 40-80MB</li>
<li>åŠ£åŠ¿: JS å¯¹è±¡è¾ƒå¤š</li>
</ul>
<p><strong>Canvas/WebView:</strong></p>
<ul>
<li>åŸºç¡€: 0ï¼ˆç³»ç»Ÿè‡ªå¸¦ï¼‰</li>
<li>è¿è¡Œæ—¶: 80-150MB+</li>
<li>åŠ£åŠ¿: WebView å†…å­˜å ç”¨å¤§</li>
</ul>
<h4 data-id="heading-62">7.3 å¯åŠ¨æ€§èƒ½</h4>






























<table><thead><tr><th>æ–¹æ¡ˆ</th><th>é¦–æ¬¡æ¸²æŸ“æ—¶é—´</th><th>äº¤äº’å“åº”æ—¶é—´</th></tr></thead><tbody><tr><td>Skia</td><td>50ms</td><td>&lt;16ms</td></tr><tr><td>SVG</td><td>80ms</td><td>20-30ms</td></tr><tr><td>Canvas</td><td>200ms+</td><td>50-100ms</td></tr><tr><td>WebView</td><td>300ms+</td><td>100-200ms</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-63">å®é™…åº”ç”¨åœºæ™¯</h3>
<h4 data-id="heading-64">8.1 å›¾è¡¨ç»˜åˆ¶ï¼ˆæ¨èä½¿ç”¨ Skiaï¼‰</h4>
<p><strong>å½“å‰é¡¹ç›®é—®é¢˜ï¼š</strong></p>
<ul>
<li>ä½¿ç”¨ WebView æ¸²æŸ“å›¾è¡¨ï¼Œæ€§èƒ½å·®</li>
<li>å†…å­˜å ç”¨é«˜</li>
<li>åŠ¨ç”»å¡é¡¿</li>
</ul>
<p><strong>Skia è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// é«˜æ€§èƒ½æŠ˜çº¿å›¾</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">LineChart</span> = (<span class="hljs-params">{ data }</span>) =&gt; {
  <span class="hljs-keyword">const</span> path = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> p = <span class="hljs-title class_">Skia</span>.<span class="hljs-property">Path</span>.<span class="hljs-title class_">Make</span>();
    data.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">value, index</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> x = (index / (data.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>)) * width;
      <span class="hljs-keyword">const</span> y = height - (value / maxValue) * height;
      <span class="hljs-keyword">if</span> (index === <span class="hljs-number">0</span>) p.<span class="hljs-title function_">moveTo</span>(x, y);
      <span class="hljs-keyword">else</span> p.<span class="hljs-title function_">lineTo</span>(x, y);
    });
    <span class="hljs-keyword">return</span> p;
  }, [data]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Canvas</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width</span>, <span class="hljs-attr">height</span> }}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Path</span> <span class="hljs-attr">path</span>=<span class="hljs-string">{path}</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"stroke"</span> <span class="hljs-attr">strokeWidth</span>=<span class="hljs-string">{2}</span> <span class="hljs-attr">color</span>=<span class="hljs-string">"#477EF4"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Canvas</span>&gt;</span></span>
  );
};
</code></pre>
<p><strong>æ”¶ç›Šï¼š</strong></p>
<ul>
<li>æ€§èƒ½æå‡ 3-5 å€</li>
<li>å†…å­˜å ç”¨é™ä½ 50%+</li>
<li>60fps æµç•…åŠ¨ç”»</li>
</ul>
<h4 data-id="heading-65">8.2 æ¶‚é¸¦/ç­¾ååŠŸèƒ½ï¼ˆæ¨èä½¿ç”¨ Skiaï¼‰</h4>
<p><strong>é¡¹ç›®ä¸­çš„ä½¿ç”¨ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// DrawingCanvas.tsx ä¸­çš„å®é™…åº”ç”¨</span>
<span class="hljs-keyword">const</span> path = <span class="hljs-title class_">Skia</span>.<span class="hljs-property">Path</span>.<span class="hljs-title class_">Make</span>();
<span class="hljs-comment">// æ‰‹åŠ¿ç»˜åˆ¶è·¯å¾„</span>
</code></pre>
<p><strong>ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>æµç•…çš„æ‰‹åŠ¿è·Ÿè¸ª</li>
<li>ä½å»¶è¿Ÿç»˜åˆ¶</li>
<li>æ”¯æŒå‹æ„Ÿï¼ˆå¦‚æœè®¾å¤‡æ”¯æŒï¼‰</li>
</ul>
<h4 data-id="heading-66">8.3 è‡ªå®šä¹‰ UI ç»„ä»¶ï¼ˆæ¨èä½¿ç”¨ Skiaï¼‰</h4>
<p><strong>ç¤ºä¾‹ï¼šè‡ªå®šä¹‰è¿›åº¦æ¡</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">CustomProgressBar</span> = (<span class="hljs-params">{ progress }</span>) =&gt; {
  <span class="hljs-keyword">const</span> path = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> p = <span class="hljs-title class_">Skia</span>.<span class="hljs-property">Path</span>.<span class="hljs-title class_">Make</span>();
    p.<span class="hljs-title function_">addRRect</span>(<span class="hljs-title class_">Skia</span>.<span class="hljs-title class_">RRectXY</span>({ <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">200</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">20</span> }, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>));
    <span class="hljs-keyword">return</span> p;
  }, []);

  <span class="hljs-keyword">const</span> animatedWidth = <span class="hljs-title function_">useDerivedValue</span>(<span class="hljs-function">() =&gt;</span> progress.<span class="hljs-property">value</span> * <span class="hljs-number">200</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Canvas</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> <span class="hljs-attr">200</span>, <span class="hljs-attr">height:</span> <span class="hljs-attr">20</span> }}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Path</span> <span class="hljs-attr">path</span>=<span class="hljs-string">{path}</span> <span class="hljs-attr">color</span>=<span class="hljs-string">"#E0E0E0"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Path</span> <span class="hljs-attr">path</span>=<span class="hljs-string">{path}</span> <span class="hljs-attr">color</span>=<span class="hljs-string">"#477EF4"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ClipRect</span> <span class="hljs-attr">x</span>=<span class="hljs-string">{0}</span> <span class="hljs-attr">y</span>=<span class="hljs-string">{0}</span> <span class="hljs-attr">width</span>=<span class="hljs-string">{animatedWidth}</span> <span class="hljs-attr">height</span>=<span class="hljs-string">{20}</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Path</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Canvas</span>&gt;</span></span>
  );
};
</code></pre>
<h4 data-id="heading-67">8.4 å›¾åƒå¤„ç†ï¼ˆæ¨èä½¿ç”¨ Skiaï¼‰</h4>
<p><strong>ç¤ºä¾‹ï¼šå›¾ç‰‡æ»¤é•œ</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">FilteredImage</span> = (<span class="hljs-params">{ imageUri }</span>) =&gt; {
  <span class="hljs-keyword">const</span> image = <span class="hljs-title function_">useImage</span>(imageUri);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Canvas</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> <span class="hljs-attr">200</span>, <span class="hljs-attr">height:</span> <span class="hljs-attr">200</span> }}&gt;</span>
      {image &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">Image</span> <span class="hljs-attr">image</span>=<span class="hljs-string">{image}</span> <span class="hljs-attr">x</span>=<span class="hljs-string">{0}</span> <span class="hljs-attr">y</span>=<span class="hljs-string">{0}</span> <span class="hljs-attr">width</span>=<span class="hljs-string">{200}</span> <span class="hljs-attr">height</span>=<span class="hljs-string">{200}</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Blur</span> <span class="hljs-attr">blur</span>=<span class="hljs-string">{10}</span> /&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">ColorMatrix</span>
            <span class="hljs-attr">matrix</span>=<span class="hljs-string">{[</span>
              <span class="hljs-attr">1</span>, <span class="hljs-attr">0</span>, <span class="hljs-attr">0</span>, <span class="hljs-attr">0</span>, <span class="hljs-attr">0</span>,
              <span class="hljs-attr">0</span>, <span class="hljs-attr">1</span>, <span class="hljs-attr">0</span>, <span class="hljs-attr">0</span>, <span class="hljs-attr">0</span>,
              <span class="hljs-attr">0</span>, <span class="hljs-attr">0</span>, <span class="hljs-attr">1</span>, <span class="hljs-attr">0</span>, <span class="hljs-attr">0</span>,
              <span class="hljs-attr">0</span>, <span class="hljs-attr">0</span>, <span class="hljs-attr">0</span>, <span class="hljs-attr">0.5</span>, <span class="hljs-attr">0</span>
            ]}
          /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Image</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">Canvas</span>&gt;</span></span>
  );
};
</code></pre>
<hr/>
<h3 data-id="heading-68">æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-69">9.1 æ€§èƒ½ä¼˜åŒ–</h4>
<h5 data-id="heading-70">1. ä½¿ç”¨ useMemo ç¼“å­˜ Path</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âœ… å¥½ï¼šç¼“å­˜ Path</span>
<span class="hljs-keyword">const</span> path = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> p = <span class="hljs-title class_">Skia</span>.<span class="hljs-property">Path</span>.<span class="hljs-title class_">Make</span>();
  <span class="hljs-comment">// ... æ„å»ºè·¯å¾„</span>
  <span class="hljs-keyword">return</span> p;
}, [dependencies]);

<span class="hljs-comment">// âŒ å·®ï¼šæ¯æ¬¡éƒ½é‡æ–°åˆ›å»º</span>
<span class="hljs-keyword">const</span> path = <span class="hljs-title class_">Skia</span>.<span class="hljs-property">Path</span>.<span class="hljs-title class_">Make</span>(); <span class="hljs-comment">// åœ¨ render ä¸­åˆ›å»º</span>
</code></pre>
<h5 data-id="heading-71">2. é¿å…é¢‘ç¹é‡æ¸²æŸ“</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âœ… å¥½ï¼šä½¿ç”¨ React.memo</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">ChartComponent</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">memo</span>(<span class="hljs-function">(<span class="hljs-params">{ data }</span>) =&gt;</span> {
  <span class="hljs-comment">// ...</span>
});

<span class="hljs-comment">// âŒ å·®ï¼šæ¯æ¬¡çˆ¶ç»„ä»¶æ›´æ–°éƒ½é‡æ¸²æŸ“</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">ChartComponent</span> = (<span class="hljs-params">{ data }</span>) =&gt; {
  <span class="hljs-comment">// ...</span>
};
</code></pre>
<h5 data-id="heading-72">3. ä½¿ç”¨ Group ç»„åˆå…ƒç´ </h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âœ… å¥½ï¼šä½¿ç”¨ Group</span>
&lt;<span class="hljs-title class_">Group</span> transform={[{ <span class="hljs-attr">translateX</span>: <span class="hljs-number">10</span> }]}&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">{50}</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">{50}</span> <span class="hljs-attr">r</span>=<span class="hljs-string">{20}</span> /&gt;</span></span>
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Rect</span> <span class="hljs-attr">x</span>=<span class="hljs-string">{80}</span> <span class="hljs-attr">y</span>=<span class="hljs-string">{80}</span> <span class="hljs-attr">width</span>=<span class="hljs-string">{40}</span> <span class="hljs-attr">height</span>=<span class="hljs-string">{40}</span> /&gt;</span></span>
&lt;/<span class="hljs-title class_">Group</span>&gt;

<span class="hljs-comment">// âŒ å·®ï¼šåˆ†åˆ«åº”ç”¨å˜æ¢</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">{60}</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">{50}</span> <span class="hljs-attr">r</span>=<span class="hljs-string">{20}</span> /&gt;</span></span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Rect</span> <span class="hljs-attr">x</span>=<span class="hljs-string">{90}</span> <span class="hljs-attr">y</span>=<span class="hljs-string">{80}</span> <span class="hljs-attr">width</span>=<span class="hljs-string">{40}</span> <span class="hljs-attr">height</span>=<span class="hljs-string">{40}</span> /&gt;</span></span>
</code></pre>
<h4 data-id="heading-73">9.2 ä»£ç ç»„ç»‡</h4>
<h5 data-id="heading-74">1. åˆ†ç¦»è·¯å¾„åˆ›å»ºé€»è¾‘</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// utils/chartUtils.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">createLinePath</span> = (<span class="hljs-params">data: <span class="hljs-built_in">number</span>[], width: <span class="hljs-built_in">number</span>, height: <span class="hljs-built_in">number</span></span>) =&gt; {
  <span class="hljs-keyword">const</span> path = <span class="hljs-title class_">Skia</span>.<span class="hljs-property">Path</span>.<span class="hljs-title class_">Make</span>();
  <span class="hljs-keyword">const</span> maxValue = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(...data);
  
  data.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">value, index</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> x = (index / (data.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>)) * width;
    <span class="hljs-keyword">const</span> y = height - (value / maxValue) * height;
    <span class="hljs-keyword">if</span> (index === <span class="hljs-number">0</span>) path.<span class="hljs-title function_">moveTo</span>(x, y);
    <span class="hljs-keyword">else</span> path.<span class="hljs-title function_">lineTo</span>(x, y);
  });
  
  <span class="hljs-keyword">return</span> path;
};

<span class="hljs-comment">// Component.tsx</span>
<span class="hljs-keyword">const</span> path = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">createLinePath</span>(data, width, height), [data, width, height]);
</code></pre>
<h5 data-id="heading-75">2. åˆ›å»ºå¯å¤ç”¨ç»„ä»¶</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// components/SkiaLineChart.tsx</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">LineChartProps</span> {
  <span class="hljs-attr">data</span>: <span class="hljs-built_in">number</span>[];
  <span class="hljs-attr">width</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">height</span>: <span class="hljs-built_in">number</span>;
  color?: <span class="hljs-built_in">string</span>;
  strokeWidth?: <span class="hljs-built_in">number</span>;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">SkiaLineChart</span>: <span class="hljs-variable constant_">FC</span>&lt;<span class="hljs-title class_">LineChartProps</span>&gt; = <span class="hljs-function">(<span class="hljs-params">{
  data,
  width,
  height,
  color = <span class="hljs-string">'#477EF4'</span>,
  strokeWidth = <span class="hljs-number">2</span>,
}</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> path = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">createLinePath</span>(data, width, height), [data, width, height]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Canvas</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width</span>, <span class="hljs-attr">height</span> }}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Path</span> <span class="hljs-attr">path</span>=<span class="hljs-string">{path}</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"stroke"</span> <span class="hljs-attr">strokeWidth</span>=<span class="hljs-string">{strokeWidth}</span> <span class="hljs-attr">color</span>=<span class="hljs-string">{color}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Canvas</span>&gt;</span></span>
  );
};
</code></pre>
<h4 data-id="heading-76">9.3 é”™è¯¯å¤„ç†</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">MyComponent</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> image = <span class="hljs-title function_">useImage</span>(<span class="hljs-built_in">require</span>(<span class="hljs-string">'./image.png'</span>));

  <span class="hljs-keyword">if</span> (!image) {
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Text</span>&gt;</span>Loading image...<span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span></span>;
  }

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Canvas</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> <span class="hljs-attr">200</span>, <span class="hljs-attr">height:</span> <span class="hljs-attr">200</span> }}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Image</span> <span class="hljs-attr">image</span>=<span class="hljs-string">{image}</span> <span class="hljs-attr">x</span>=<span class="hljs-string">{0}</span> <span class="hljs-attr">y</span>=<span class="hljs-string">{0}</span> <span class="hljs-attr">width</span>=<span class="hljs-string">{200}</span> <span class="hljs-attr">height</span>=<span class="hljs-string">{200}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Canvas</span>&gt;</span></span>
  );
};
</code></pre>
<h4 data-id="heading-77">9.4 ç±»å‹å®‰å…¨</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">SkPath</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@shopify/react-native-skia'</span>;

<span class="hljs-keyword">const</span> createPath = (): <span class="hljs-function"><span class="hljs-params">SkPath</span> =&gt;</span> {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Skia</span>.<span class="hljs-property">Path</span>.<span class="hljs-title class_">Make</span>();
};
</code></pre>
<hr/>
<h3 data-id="heading-78">æ€»ç»“</h3>
<h4 data-id="heading-79">é€‰æ‹©å»ºè®®</h4>
<p><strong>ä½¿ç”¨ React Native Skia å½“ï¼š</strong></p>
<ul>
<li>âœ… éœ€è¦é«˜æ€§èƒ½å›¾è¡¨ï¼ˆå®æ—¶æ•°æ®ã€å¤§é‡æ•°æ®ç‚¹ï¼‰</li>
<li>âœ… éœ€è¦æµç•…åŠ¨ç”»ï¼ˆ60fpsï¼‰</li>
<li>âœ… éœ€è¦è‡ªå®šä¹‰å›¾å½¢ç»˜åˆ¶</li>
<li>âœ… éœ€è¦å›¾åƒå¤„ç†åŠŸèƒ½</li>
<li>âœ… åŒ…ä½“ç§¯ä¸æ˜¯ä¸»è¦è€ƒè™‘å› ç´ </li>
</ul>
<p><strong>ä½¿ç”¨ react-native-svg å½“ï¼š</strong></p>
<ul>
<li>âœ… ç®€å•å›¾æ ‡å’ŒçŸ¢é‡å›¾</li>
<li>âœ… é™æ€å›¾å½¢å±•ç¤º</li>
<li>âœ… éœ€è¦ SVG æ ¼å¼å…¼å®¹æ€§</li>
<li>âœ… åŒ…ä½“ç§¯æ•æ„Ÿ</li>
</ul>
<p><strong>ä½¿ç”¨ Canvas/WebView å½“ï¼š</strong></p>
<ul>
<li>âœ… å·²æœ‰ Web å›¾è¡¨åº“</li>
<li>âœ… å¿«é€ŸåŸå‹å¼€å‘</li>
<li>âœ… æ€§èƒ½è¦æ±‚ä¸é«˜</li>
<li>âœ… éœ€è¦å¤ç”¨ Web ä»£ç </li>
</ul>
<h4 data-id="heading-80">è¿ç§»å»ºè®®</h4>
<p><strong>ä» WebView Chart è¿ç§»åˆ° Skiaï¼š</strong></p>
<ol>
<li><strong>è¯„ä¼°ç°æœ‰å›¾è¡¨å¤æ‚åº¦</strong></li>
<li><strong>åˆ›å»º Skia ç‰ˆæœ¬çš„åŸå‹</strong></li>
<li><strong>æ€§èƒ½å¯¹æ¯”æµ‹è¯•</strong></li>
<li><strong>é€æ­¥è¿ç§»ï¼ˆå…ˆè¿ç§»æ€§èƒ½ç“¶é¢ˆçš„å›¾è¡¨ï¼‰</strong></li>
<li><strong>ä¿ç•™ WebView ä½œä¸ºé™çº§æ–¹æ¡ˆ</strong></li>
</ol>
<p><strong>é¢„æœŸæ”¶ç›Šï¼š</strong></p>
<ul>
<li>æ€§èƒ½æå‡ 3-5 å€</li>
<li>å†…å­˜å ç”¨é™ä½ 50%+</li>
<li>æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ</li>
<li>æ›´æµç•…çš„åŠ¨ç”»</li>
</ul>
<hr/>
<h3 data-id="heading-81">å‚è€ƒèµ„æ–™</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fshopify.github.io%2Freact-native-skia%2F" target="_blank" title="https://shopify.github.io/react-native-skia/" ref="nofollow noopener noreferrer">React Native Skia å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fskia.org%2F" target="_blank" title="https://skia.org/" ref="nofollow noopener noreferrer">Skia å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FShopify%2Freact-native-skia" target="_blank" title="https://github.com/Shopify/react-native-skia" ref="nofollow noopener noreferrer">GitHub Repository</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FShopify%2Freact-native-skia%2Ftree%2Fmain%2Fexample" target="_blank" title="https://github.com/Shopify/react-native-skia/tree/main/example" ref="nofollow noopener noreferrer">æ€§èƒ½å¯¹æ¯”æµ‹è¯•</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue2/Vue3 è¿ç§»å¤´ç§ƒï¼ŸRenderless æ¶æ„è®©ç»„ä»¶ â€œæ— ç¼ç©¿æ¢­â€]]></title>    <link>https://juejin.cn/post/7587776610435710991</link>    <guid>https://juejin.cn/post/7587776610435710991</guid>    <pubDate>2025-12-26T08:57:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587776610435710991" data-draft-id="7587594077014409250" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue2/Vue3 è¿ç§»å¤´ç§ƒï¼ŸRenderless æ¶æ„è®©ç»„ä»¶ â€œæ— ç¼ç©¿æ¢­â€"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,Vue.js"/> <meta itemprop="datePublished" content="2025-12-26T08:57:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="OpenTinyç¤¾åŒº"/> <meta itemprop="url" content="https://juejin.cn/user/3808325101432983"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue2/Vue3 è¿ç§»å¤´ç§ƒï¼ŸRenderless æ¶æ„è®©ç»„ä»¶ â€œæ— ç¼ç©¿æ¢­â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3808325101432983/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    OpenTinyç¤¾åŒº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T08:57:30.000Z" title="Fri Dec 26 2025 08:57:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ¬æ–‡ç”±ä½“éªŒæŠ€æœ¯å›¢é˜Ÿåˆ˜å¤åŸåˆ›ã€‚</p>
<blockquote>
<p><strong>"ä¸€æ¬¡ç¼–å†™ï¼Œåˆ°å¤„è¿è¡Œ"</strong> â€”â€” è¿™ä¸æ˜¯ Java çš„ä¸“åˆ©ï¼Œä¹Ÿæ˜¯ Renderless æ¶æ„çš„åº§å³é“­ï¼</p>
</blockquote>
<h2 data-id="heading-0">å¼€ç¯‡ï¼šä»€ä¹ˆæ˜¯ Renderless æ¶æ„ï¼Ÿ</h2>
<h3 data-id="heading-1">ğŸ¤” ä¼ ç»Ÿç»„ä»¶çš„å›°å¢ƒ</h3>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ å†™äº†ä¸€ä¸ªè¶…æ£’çš„ Vue 3 ç»„ä»¶ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- MyAwesomeComponent.vue --&gt;
&lt;template&gt;
  &lt;div&gt;
    &lt;button @click="handleClick"&gt;{{ count }}&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref } from 'vue'

const count = ref(0)
const handleClick = () =&gt; {
  count.value++
}
&lt;/script&gt;
</code></pre>
<p><strong>é—®é¢˜æ¥äº†</strong>ï¼šè¿™ä¸ªç»„ä»¶åªèƒ½åœ¨ Vue 3 ä¸­ä½¿ç”¨ï¼å¦‚æœä½ çš„é¡¹ç›®æ˜¯ Vue 2ï¼Œæˆ–è€…ä½ éœ€è¦åŒæ—¶æ”¯æŒ Vue 2 å’Œ Vue 3ï¼Œæ€ä¹ˆåŠï¼Ÿ</p>
<h3 data-id="heading-2">âœ¨ Renderless çš„è§£å†³æ–¹æ¡ˆ</h3>
<p>Renderless æ¶æ„å°†ç»„ä»¶æ‹†åˆ†æˆä¸‰ä¸ªéƒ¨åˆ†ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
|             æ¨¡æ¿å±‚ï¼ˆpc.vueï¼‰             |
|         <span class="hljs-string">"æˆ‘åªè´Ÿè´£å±•ç¤ºï¼Œä¸å…³å¿ƒé€»è¾‘"</span>        |
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†•ï¸
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         é€»è¾‘å±‚ï¼ˆrenderless.tsï¼‰          â”‚
â”‚       <span class="hljs-string">"æˆ‘æ˜¯å¤§è„‘ï¼Œå¤„ç†æ‰€æœ‰ä¸šåŠ¡é€»è¾‘"</span>         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†•ï¸
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            å…¥å£å±‚ ï¼ˆindex.tsï¼‰           â”‚
â”‚         <span class="hljs-string">"æˆ‘æ˜¯é—¨é¢ï¼Œç»Ÿä¸€å¯¹å¤–æ¥å£"</span>          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼šå°† UIï¼ˆæ¨¡æ¿ï¼‰å’Œé€»è¾‘ï¼ˆä¸šåŠ¡ä»£ç ï¼‰å®Œå…¨åˆ†ç¦»ï¼Œé€»è¾‘å±‚ä½¿ç”¨ Vue 2 å’Œ Vue 3 éƒ½å…¼å®¹çš„ APIã€‚</p>
<h3 data-id="heading-3">ğŸ“Š ä¸ºä»€ä¹ˆéœ€è¦ Renderlessï¼Ÿ</h3>



































<table><thead><tr><th>ç‰¹æ€§</th><th>ä¼ ç»Ÿç»„ä»¶</th><th>Renderless ç»„ä»¶</th></tr></thead><tbody><tr><td>Vue 2 æ”¯æŒ</td><td>âŒ</td><td>âœ…</td></tr><tr><td>Vue 3 æ”¯æŒ</td><td>âœ…</td><td>âœ…</td></tr><tr><td>é€»è¾‘å¤ç”¨</td><td>å›°éš¾</td><td>ç®€å•</td></tr><tr><td>æµ‹è¯•å‹å¥½</td><td>ä¸€èˆ¬</td><td>ä¼˜ç§€</td></tr><tr><td>ä»£ç ç»„ç»‡</td><td>è€¦åˆ</td><td>è§£è€¦</td></tr></tbody></table>
<h3 data-id="heading-4">ğŸ¯ é€‚ç”¨åœºæ™¯</h3>
<ul>
<li>âœ… éœ€è¦åŒæ—¶æ”¯æŒ Vue 2 å’Œ Vue 3 çš„ç»„ä»¶åº“</li>
<li>âœ… é€»è¾‘å¤æ‚ï¼Œéœ€è¦æ¨¡å—åŒ–ç®¡ç†çš„ç»„ä»¶</li>
<li>âœ… éœ€è¦å¤šç«¯é€‚é…çš„ç»„ä»¶ï¼ˆPCã€ç§»åŠ¨ç«¯ã€å°ç¨‹åºç­‰ï¼‰</li>
<li>âœ… éœ€è¦é«˜åº¦å¯æµ‹è¯•æ€§çš„ç»„ä»¶</li>
</ul>
<h2 data-id="heading-5">ç¬¬ä¸€æ­¥ï¼šç†è§£ @opentiny/vue-commonï¼ˆå¿…é¡»å…ˆæŒæ¡ï¼‰</h2>
<h3 data-id="heading-6">âš ï¸ é‡è¦æç¤ºï¼šä¸ºä»€ä¹ˆå¿…é¡»å…ˆå­¦ä¹  vue-commonï¼Ÿ</h3>
<p>åœ¨å­¦ä¹  Renderless æ¶æ„ä¹‹å‰ï¼Œ<strong>ä½ å¿…é¡»å…ˆç†è§£ <code>@opentiny/vue-common</code></strong>ï¼Œå› ä¸ºï¼š</p>
<ol>
<li><strong>å®ƒæ˜¯åŸºç¡€å·¥å…·</strong>ï¼šRenderless æ¶æ„å®Œå…¨ä¾èµ– <code>vue-common</code> æä¾›çš„å…¼å®¹å±‚</li>
<li><strong>å®ƒæ˜¯æ¡¥æ¢</strong>ï¼šæ²¡æœ‰ <code>vue-common</code>ï¼Œå°±æ— æ³•å®ç° Vue 2/3 çš„å…¼å®¹</li>
<li><strong>å®ƒæ˜¯å‰æ</strong>ï¼šä¸ç†è§£ <code>vue-common</code>ï¼Œå°±æ— æ³•ç†è§£ Renderless çš„å·¥ä½œåŸç†</li>
</ol>
<p><strong>æ‰“ä¸ªæ¯”æ–¹</strong>ï¼š<code>vue-common</code> å°±åƒæ˜¯ä½ å­¦å¼€è½¦å‰å¿…é¡»å…ˆäº†è§£çš„"æ–¹å‘ç›˜ã€åˆ¹è½¦ã€æ²¹é—¨"ï¼Œè€Œ Renderless æ˜¯"å¦‚ä½•é©¾é©¶"çš„æŠ€å·§ã€‚æ²¡æœ‰åŸºç¡€å·¥å…·ï¼Œå†å¥½çš„æŠ€å·§ä¹Ÿæ— æ³•æ–½å±•ï¼</p>
<h3 data-id="heading-7">ğŸ¤” ä¸ºä»€ä¹ˆéœ€è¦ vue-commonï¼Ÿ</h3>
<p>æƒ³è±¡ä¸€ä¸‹ï¼ŒVue 2 å’Œ Vue 3 å°±åƒä¸¤ä¸ªè¯´ä¸åŒæ–¹è¨€çš„äººï¼š</p>
<ul>
<li><strong>Vue 2</strong>ï¼š<code>this.$refs.input</code>ã€<code>this.$emit('event')</code>ã€<code>Vue.component()</code></li>
<li><strong>Vue 3</strong>ï¼š<code>refs.input</code>ã€<code>emit('event')</code>ã€<code>defineComponent()</code></li>
</ul>
<p>å¦‚æœä½ è¦åŒæ—¶æ”¯æŒä¸¤è€…ï¼Œéš¾é“è¦å†™ä¸¤å¥—ä»£ç å—ï¼Ÿ<strong>å½“ç„¶ä¸ï¼</strong> è¿™å°±æ˜¯ <code>@opentiny/vue-common</code> å­˜åœ¨çš„æ„ä¹‰ã€‚</p>
<h3 data-id="heading-8">âœ¨ vue-common æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p><code>@opentiny/vue-common</code> æ˜¯ä¸€ä¸ª<strong>å…¼å®¹å±‚åº“</strong>ï¼Œå®ƒï¼š</p>
<ol>
<li><strong>ç»Ÿä¸€ API</strong>ï¼šæä¾›ä¸€å¥—ç»Ÿä¸€çš„ APIï¼Œè‡ªåŠ¨é€‚é… Vue 2 å’Œ Vue 3</li>
<li><strong>éšè—å·®å¼‚</strong>ï¼šè®©ä½ æ— éœ€å…³å¿ƒåº•å±‚æ˜¯ Vue 2 è¿˜æ˜¯ Vue 3</li>
<li><strong>ç±»å‹æ”¯æŒ</strong>ï¼šæä¾›å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰</li>
</ol>
<p><strong>ç®€å•æ¥è¯´</strong>ï¼š<code>vue-common</code> æ˜¯ä¸€ä¸ª"ç¿»è¯‘å®˜"ï¼Œå®ƒè®© Vue 2 å’Œ Vue 3 èƒ½å¤Ÿ"è¯´åŒä¸€ç§è¯­è¨€"ã€‚</p>
<h3 data-id="heading-9">ğŸ› ï¸ æ ¸å¿ƒ API è¯¦è§£</h3>
<h4 data-id="heading-10">1. <code>defineComponent</code> - ç»„ä»¶å®šä¹‰çš„ç»Ÿä¸€å…¥å£</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { defineComponent } <span class="hljs-keyword">from</span> <span class="hljs-string">'@opentiny/vue-common'</span>

<span class="hljs-comment">// è¿™ä¸ªå‡½æ•°åœ¨ Vue 2 å’Œ Vue 3 ä¸­éƒ½èƒ½å·¥ä½œ</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineComponent</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'MyComponent'</span>,
  <span class="hljs-attr">props</span>: { ... },
  <span class="hljs-title function_">setup</span>(<span class="hljs-params"/>) { ... }
})
</code></pre>
<p><strong>å·¥ä½œåŸç†</strong>ï¼š</p>
<ul>
<li>Vue 2ï¼šå†…éƒ¨ä½¿ç”¨ <code>Vue.extend()</code> æˆ– <code>Vue.component()</code></li>
<li>Vue 3ï¼šç›´æ¥ä½¿ç”¨ Vue 3 çš„ <code>defineComponent()</code></li>
<li>ä½ åªéœ€è¦å†™ä¸€å¥—ä»£ç ï¼Œ<code>vue-common</code> ä¼šè‡ªåŠ¨é€‰æ‹©æ­£ç¡®çš„å®ç°</li>
</ul>
<h4 data-id="heading-11">2. <code>setup</code> - è¿æ¥ Renderless çš„æ¡¥æ¢</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { setup } <span class="hljs-keyword">from</span> <span class="hljs-string">'@opentiny/vue-common'</span>

<span class="hljs-comment">// åœ¨ pc.vue ä¸­</span>
<span class="hljs-title function_">setup</span>(<span class="hljs-params">props, context</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">setup</span>({ props, context, renderless, api })
}
</code></pre>
<p><strong>å·¥ä½œåŸç†</strong>ï¼š</p>
<ul>
<li>æ¥æ”¶ <code>renderless</code> å‡½æ•°å’Œ <code>api</code> æ•°ç»„</li>
<li>è‡ªåŠ¨å¤„ç† Vue 2/3 çš„å·®å¼‚ï¼ˆå¦‚ <code>emit</code>ã€<code>slots</code>ã€<code>refs</code> ç­‰ï¼‰</li>
<li>å°† <code>renderless</code> è¿”å›çš„ <code>api</code> å¯¹è±¡æ³¨å…¥åˆ°æ¨¡æ¿ä¸­</li>
</ul>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// vue-common å†…éƒ¨ä¼šåšç±»ä¼¼è¿™æ ·çš„å¤„ç†ï¼š</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">setup</span>(<span class="hljs-params">{ props, context, renderless, api }</span>) {
  <span class="hljs-comment">// Vue 2: context åŒ…å« { emit, slots, attrs, listeners }</span>
  <span class="hljs-comment">// Vue 3: context åŒ…å« { emit, slots, attrs, expose }</span>

  <span class="hljs-comment">// ç»Ÿä¸€å¤„ç†å·®å¼‚</span>
  <span class="hljs-keyword">const</span> normalizedContext = <span class="hljs-title function_">normalizeContext</span>(context)

  <span class="hljs-comment">// è°ƒç”¨ renderless</span>
  <span class="hljs-keyword">const</span> apiResult = <span class="hljs-title function_">renderless</span>(props, hooks, normalizedContext)

  <span class="hljs-comment">// è¿”å›ç»™æ¨¡æ¿ä½¿ç”¨</span>
  <span class="hljs-keyword">return</span> apiResult
}
</code></pre>
<h4 data-id="heading-12">3. <code>$props</code> - é€šç”¨ Props å®šä¹‰</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { $props } <span class="hljs-keyword">from</span> <span class="hljs-string">'@opentiny/vue-common'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> myComponentProps = {
  ...$props, <span class="hljs-comment">// ç»§æ‰¿é€šç”¨ props</span>
  <span class="hljs-attr">title</span>: <span class="hljs-title class_">String</span>
}
</code></pre>
<p><strong>æä¾›çš„åŸºç¡€ Props</strong>ï¼š</p>
<ul>
<li><code>tiny_mode</code>ï¼šç»„ä»¶æ¨¡å¼ï¼ˆpc/saasï¼‰</li>
<li><code>customClass</code>ï¼šè‡ªå®šä¹‰ç±»å</li>
<li><code>customStyle</code>ï¼šè‡ªå®šä¹‰æ ·å¼</li>
<li>ç­‰ç­‰...</li>
</ul>
<p><strong>å¥½å¤„</strong>ï¼š</p>
<ul>
<li>æ‰€æœ‰ç»„ä»¶éƒ½æœ‰ç»Ÿä¸€çš„ props æ¥å£</li>
<li>å‡å°‘é‡å¤ä»£ç </li>
<li>ä¿è¯ä¸€è‡´æ€§</li>
</ul>
<h4 data-id="heading-13">4. <code>$prefix</code> - ç»„ä»¶åå‰ç¼€</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { $prefix } <span class="hljs-keyword">from</span> <span class="hljs-string">'@opentiny/vue-common'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineComponent</span>({
  <span class="hljs-attr">name</span>: $prefix + <span class="hljs-string">'SearchBox'</span> <span class="hljs-comment">// è‡ªåŠ¨å˜æˆ 'TinySearchBox'</span>
})
</code></pre>
<p><strong>ä½œç”¨</strong>ï¼š</p>
<ul>
<li>ç»Ÿä¸€ç»„ä»¶å‘½åè§„èŒƒ</li>
<li>é¿å…å‘½åå†²çª</li>
<li>ä¾¿äºè¯†åˆ«ç»„ä»¶æ¥æº</li>
</ul>
<h4 data-id="heading-14">5. <code>isVue2</code> / <code>isVue3</code> - ç‰ˆæœ¬æ£€æµ‹</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { isVue2, isVue3 } <span class="hljs-keyword">from</span> <span class="hljs-string">'@opentiny/vue-common'</span>

<span class="hljs-keyword">if</span> (isVue2) {
  <span class="hljs-comment">// Vue 2 ç‰¹å®šä»£ç </span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¿è¡Œåœ¨ Vue 2 ç¯å¢ƒ'</span>)
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isVue3) {
  <span class="hljs-comment">// Vue 3 ç‰¹å®šä»£ç </span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¿è¡Œåœ¨ Vue 3 ç¯å¢ƒ'</span>)
}
</code></pre>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>éœ€è¦é’ˆå¯¹ç‰¹å®šç‰ˆæœ¬åšç‰¹æ®Šå¤„ç†æ—¶</li>
<li>è°ƒè¯•å’Œæ—¥å¿—è®°å½•</li>
<li>å…¼å®¹æ€§æ£€æŸ¥</li>
</ul>
<h3 data-id="heading-15">ğŸ” æ·±å…¥ç†è§£ï¼švue-common å¦‚ä½•å®ç°å…¼å®¹ï¼Ÿ</h3>
<h4 data-id="heading-16">åœºæ™¯ 1ï¼šå“åº”å¼ API å…¼å®¹</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// åœ¨ renderless.ts ä¸­</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">renderless</span> = (<span class="hljs-params">props, hooks, context</span>) =&gt; {
  <span class="hljs-keyword">const</span> { reactive, computed, watch } = hooks

  <span class="hljs-comment">// è¿™äº› hooks æ¥è‡ª vue-common çš„å…¼å®¹å±‚</span>
  <span class="hljs-comment">// Vue 2: ä½¿ç”¨ @vue/composition-api çš„ polyfill</span>
  <span class="hljs-comment">// Vue 3: ç›´æ¥ä½¿ç”¨ Vue 3 çš„åŸç”Ÿ API</span>

  <span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({ <span class="hljs-attr">count</span>: <span class="hljs-number">0</span> })
  <span class="hljs-keyword">const</span> double = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> state.<span class="hljs-property">count</span> * <span class="hljs-number">2</span>)

  <span class="hljs-title function_">watch</span>(
    <span class="hljs-function">() =&gt;</span> state.<span class="hljs-property">count</span>,
    <span class="hljs-function">(<span class="hljs-params">newVal</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'count changed:'</span>, newVal)
    }
  )
}
</code></pre>
<p><strong>å…¼å®¹åŸç†</strong>ï¼š</p>
<ul>
<li>Vue 2ï¼š<code>vue-common</code> å†…éƒ¨ä½¿ç”¨ <code>@vue/composition-api</code> æä¾› Composition API</li>
<li>Vue 3ï¼šç›´æ¥ä½¿ç”¨ Vue 3 çš„åŸç”Ÿ API</li>
<li>å¯¹å¼€å‘è€…é€æ˜ï¼Œæ— éœ€å…³å¿ƒåº•å±‚å®ç°</li>
</ul>
<h4 data-id="heading-17">åœºæ™¯ 2ï¼šEmit å…¼å®¹</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">renderless</span> = (<span class="hljs-params">props, hooks, { emit }</span>) =&gt; {
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleClick</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-comment">// vue-common ä¼šè‡ªåŠ¨å¤„ç† Vue 2/3 çš„å·®å¼‚</span>
    <span class="hljs-title function_">emit</span>(<span class="hljs-string">'update:modelValue'</span>, newValue)
    <span class="hljs-title function_">emit</span>(<span class="hljs-string">'change'</span>, newValue)
  }
}
</code></pre>
<p><strong>å…¼å®¹åŸç†</strong>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// vue-common å†…éƒ¨å¤„ç†ï¼ˆç®€åŒ–ç‰ˆï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">normalizeEmit</span>(<span class="hljs-params">emit, isVue2</span>) {
  <span class="hljs-keyword">if</span> (isVue2) {
    <span class="hljs-comment">// Vue 2: emit éœ€è¦ç‰¹æ®Šå¤„ç†</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params">event, ...args</span>) {
      <span class="hljs-comment">// å¤„ç† Vue 2 çš„äº‹ä»¶æ ¼å¼</span>
      <span class="hljs-variable language_">this</span>.$emit(event, ...args)
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// Vue 3: ç›´æ¥ä½¿ç”¨</span>
    <span class="hljs-keyword">return</span> emit
  }
}
</code></pre>
<h4 data-id="heading-18">åœºæ™¯ 3ï¼šRefs è®¿é—®å…¼å®¹</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">renderless</span> = (<span class="hljs-params">props, hooks, { vm }</span>) =&gt; {
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">focusInput</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-comment">// vue-common æä¾›äº†ç»Ÿä¸€çš„è®¿é—®æ–¹å¼</span>
    <span class="hljs-keyword">const</span> inputRef = vm?.<span class="hljs-property">$refs</span>?.<span class="hljs-property">inputRef</span> || vm?.<span class="hljs-property">refs</span>?.<span class="hljs-property">inputRef</span>
    inputRef?.<span class="hljs-title function_">focus</span>()
  }
}
</code></pre>
<p><strong>å…¼å®¹åŸç†</strong>ï¼š</p>
<ul>
<li>Vue 2ï¼š<code>vm.$refs.inputRef</code></li>
<li>Vue 3ï¼š<code>vm.refs.inputRef</code></li>
<li><code>vue-common</code> æä¾›ç»Ÿä¸€çš„è®¿é—®æ–¹å¼ï¼Œè‡ªåŠ¨é€‚é…</li>
</ul>
<h3 data-id="heading-19">ğŸ“Š vue-common æä¾›çš„å¸¸ç”¨ API åˆ—è¡¨</h3>















































<table><thead><tr><th>API</th><th>ä½œç”¨</th><th>Vue 2 å®ç°</th><th>Vue 3 å®ç°</th></tr></thead><tbody><tr><td><code>defineComponent</code></td><td>å®šä¹‰ç»„ä»¶</td><td><code>Vue.extend()</code></td><td><code>defineComponent()</code></td></tr><tr><td><code>setup</code></td><td>è¿æ¥ renderless</td><td>Composition API polyfill</td><td>åŸç”Ÿ setup</td></tr><tr><td><code>$props</code></td><td>é€šç”¨ props</td><td>å¯¹è±¡å±•å¼€</td><td>å¯¹è±¡å±•å¼€</td></tr><tr><td><code>$prefix</code></td><td>ç»„ä»¶å‰ç¼€</td><td>å­—ç¬¦ä¸²å¸¸é‡</td><td>å­—ç¬¦ä¸²å¸¸é‡</td></tr><tr><td><code>isVue2</code></td><td>Vue 2 æ£€æµ‹</td><td><code>true</code></td><td><code>false</code></td></tr><tr><td><code>isVue3</code></td><td>Vue 3 æ£€æµ‹</td><td><code>false</code></td><td><code>true</code></td></tr></tbody></table>
<h3 data-id="heading-20">ğŸ¯ ä½¿ç”¨ vue-common çš„æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-21">âœ… DOï¼ˆæ¨èï¼‰</h4>
<ol>
<li><strong>å§‹ç»ˆä½¿ç”¨ vue-common æä¾›çš„ API</strong>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âœ… å¥½</span>
<span class="hljs-keyword">import</span> { defineComponent, setup } <span class="hljs-keyword">from</span> <span class="hljs-string">'@opentiny/vue-common'</span>

<span class="hljs-comment">// âŒ ä¸å¥½</span>
<span class="hljs-keyword">import</span> { defineComponent } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span> <span class="hljs-comment">// è¿™æ ·åªèƒ½åœ¨ Vue 3 ä¸­ä½¿ç”¨</span>
</code></pre>
</li>
<li><strong>ä½¿ç”¨ $props ç»§æ‰¿é€šç”¨å±æ€§</strong>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âœ… å¥½</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> props = {
  ...$props,
  <span class="hljs-attr">customProp</span>: <span class="hljs-title class_">String</span>
}
</code></pre>
</li>
<li><strong>ä½¿ç”¨ $prefix ç»Ÿä¸€å‘½å</strong>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âœ… å¥½</span>
<span class="hljs-attr">name</span>: $prefix + <span class="hljs-string">'MyComponent'</span>
</code></pre>
</li>
</ol>
<h4 data-id="heading-22">âŒ DON'Tï¼ˆä¸æ¨èï¼‰</h4>
<ol>
<li><strong>ä¸è¦ç›´æ¥ä½¿ç”¨ Vue 2/3 çš„åŸç”Ÿ API</strong>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âŒ ä¸å¥½</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Vue</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span> <span class="hljs-comment">// åªèƒ½åœ¨ Vue 2 ä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">import</span> { defineComponent } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span> <span class="hljs-comment">// åªèƒ½åœ¨ Vue 3 ä¸­ä½¿ç”¨</span>
</code></pre>
</li>
<li><strong>ä¸è¦ç¡¬ç¼–ç ç»„ä»¶åå‰ç¼€</strong>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âŒ ä¸å¥½</span>
<span class="hljs-attr">name</span>: <span class="hljs-string">'TinyMyComponent'</span> <span class="hljs-comment">// ç¡¬ç¼–ç å‰ç¼€</span>

<span class="hljs-comment">// âœ… å¥½</span>
<span class="hljs-attr">name</span>: $prefix + <span class="hljs-string">'MyComponent'</span> <span class="hljs-comment">// ä½¿ç”¨å˜é‡</span>
</code></pre>
</li>
</ol>
<h3 data-id="heading-23">ğŸ”— æ€»ç»“</h3>
<p><code>@opentiny/vue-common</code> æ˜¯ Renderless æ¶æ„çš„<strong>åŸºçŸ³</strong>ï¼š</p>
<ul>
<li>ğŸ¯ <strong>ç›®æ ‡</strong>ï¼šè®©ä¸€å¥—ä»£ç åœ¨ Vue 2 å’Œ Vue 3 ä¸­éƒ½èƒ½è¿è¡Œ</li>
<li>ğŸ› ï¸ <strong>æ‰‹æ®µ</strong>ï¼šæä¾›ç»Ÿä¸€çš„ API å’Œå…¼å®¹å±‚</li>
<li>âœ¨ <strong>ç»“æœ</strong>ï¼šå¼€å‘è€…æ— éœ€å…³å¿ƒåº•å±‚å·®å¼‚ï¼Œä¸“æ³¨äºä¸šåŠ¡é€»è¾‘</li>
</ul>
<p><strong>è®°ä½</strong>ï¼šä½¿ç”¨ Renderless æ¶æ„æ—¶ï¼Œ<strong>å¿…é¡»</strong>ä½¿ç”¨ <code>vue-common</code> æä¾›çš„ APIï¼Œè¿™æ˜¯å®ç°è·¨ç‰ˆæœ¬å…¼å®¹çš„å…³é”®ï¼</p>
<h3 data-id="heading-24">ğŸ“ å­¦ä¹ æ£€æŸ¥ç‚¹</h3>
<p>åœ¨ç»§ç»­å­¦ä¹ ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ å·²ç»ç†è§£ï¼š</p>
<ul>
<li>âœ… <code>defineComponent</code> çš„ä½œç”¨å’Œç”¨æ³•</li>
<li>âœ… <code>setup</code> å‡½æ•°å¦‚ä½•è¿æ¥ renderless</li>
<li>âœ… <code>$props</code> å’Œ <code>$prefix</code> çš„ç”¨é€”</li>
<li>âœ… <code>vue-common</code> å¦‚ä½•å®ç° Vue 2/3 å…¼å®¹</li>
</ul>
<p>å¦‚æœä½ å¯¹ä»¥ä¸Šå†…å®¹è¿˜æœ‰ç–‘é—®ï¼Œè¯·é‡æ–°é˜…è¯»æœ¬èŠ‚ã€‚<strong>ç†è§£ <code>vue-common</code> æ˜¯å­¦ä¹  Renderless çš„å‰æï¼</strong></p>
<h2 data-id="heading-25">ç¬¬äºŒæ­¥ï¼šæ ¸å¿ƒæ¦‚å¿µ - ä¸‰å¤§æ–‡ä»¶</h2>
<p>ç°åœ¨ä½ å·²ç»ç†è§£äº† <code>vue-common</code>ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹å­¦ä¹  Renderless æ¶æ„çš„æ ¸å¿ƒäº†ï¼</p>
<h3 data-id="heading-26">ğŸ“‹ æ–‡ä»¶ç»“æ„</h3>
<p>ä¸€ä¸ªæ ‡å‡†çš„ Renderless ç»„ä»¶åŒ…å«ä¸‰ä¸ªæ ¸å¿ƒæ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-keyword">my</span>-component/
â”œâ”€â”€ index.ts          <span class="hljs-comment"># å…¥å£æ–‡ä»¶ï¼šå®šä¹‰ç»„ä»¶å’Œ props</span>
â”œâ”€â”€ pc.vue            <span class="hljs-comment"># æ¨¡æ¿æ–‡ä»¶ï¼šåªè´Ÿè´£ UI å±•ç¤º</span>
â””â”€â”€ renderless.ts     <span class="hljs-comment"># é€»è¾‘æ–‡ä»¶ï¼šå¤„ç†æ‰€æœ‰ä¸šåŠ¡é€»è¾‘</span>
</code></pre>
<h3 data-id="heading-27">1. ä¸‰å¤§æ ¸å¿ƒæ–‡ä»¶è¯¦è§£</h3>
<h4 data-id="heading-28">ğŸ“„ <code>index.ts</code> - ç»„ä»¶å…¥å£</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { $props, $prefix, defineComponent } <span class="hljs-keyword">from</span> <span class="hljs-string">'@opentiny/vue-common'</span>
<span class="hljs-keyword">import</span> template <span class="hljs-keyword">from</span> <span class="hljs-string">'./pc.vue'</span>

<span class="hljs-comment">// å®šä¹‰ç»„ä»¶çš„ props</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> myComponentProps = {
  ...$props, <span class="hljs-comment">// ç»§æ‰¿é€šç”¨ props</span>
  <span class="hljs-attr">title</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-string">'Hello'</span>
  },
  <span class="hljs-attr">count</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-number">0</span>
  }
}

<span class="hljs-comment">// å¯¼å‡ºç»„ä»¶</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineComponent</span>({
  <span class="hljs-attr">name</span>: $prefix + <span class="hljs-string">'MyComponent'</span>, <span class="hljs-comment">// è‡ªåŠ¨æ·»åŠ å‰ç¼€</span>
  <span class="hljs-attr">props</span>: myComponentProps,
  ...template <span class="hljs-comment">// å±•å¼€æ¨¡æ¿é…ç½®</span>
})
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li><code>$props</code>ï¼šæä¾› Vue 2/3 å…¼å®¹çš„åŸºç¡€ props</li>
<li><code>$prefix</code>ï¼šç»Ÿä¸€çš„ç»„ä»¶åå‰ç¼€ï¼ˆå¦‚ <code>Tiny</code>ï¼‰</li>
<li><code>defineComponent</code>ï¼šå…¼å®¹ Vue 2/3 çš„ç»„ä»¶å®šä¹‰å‡½æ•°</li>
</ul>
<h4 data-id="heading-29">ğŸ¨ <code>pc.vue</code> - æ¨¡æ¿æ–‡ä»¶</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="my-component"&gt;
    &lt;h1&gt;{{ title }}&lt;/h1&gt;
    &lt;button @click="handleClick"&gt;ç‚¹å‡»äº† {{ count }} æ¬¡&lt;/button&gt;
    &lt;p&gt;{{ message }}&lt;/p&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script lang="ts"&gt;
import { defineComponent, setup, $props } from '@opentiny/vue-common'
import { renderless, api } from './renderless'

export default defineComponent({
  props: {
    ...$props,
    title: String,
    count: Number
  },
  setup(props, context) {
    // å…³é”®ï¼šé€šè¿‡ setup å‡½æ•°è¿æ¥ renderless
    return setup({ props, context, renderless, api })
  }
})
&lt;/script&gt;
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li>æ¨¡æ¿åªè´Ÿè´£ UI å±•ç¤º</li>
<li>æ‰€æœ‰é€»è¾‘éƒ½ä» <code>renderless</code> å‡½æ•°è·å–</li>
<li><code>setup</code> å‡½æ•°æ˜¯è¿æ¥æ¨¡æ¿å’Œé€»è¾‘çš„æ¡¥æ¢</li>
</ul>
<h4 data-id="heading-30">ğŸ§  <code>renderless.ts</code> - é€»è¾‘å±‚</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å®šä¹‰æš´éœ²ç»™æ¨¡æ¿çš„ API</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> api = [<span class="hljs-string">'count'</span>, <span class="hljs-string">'message'</span>, <span class="hljs-string">'handleClick'</span>]

<span class="hljs-comment">// åˆå§‹åŒ–çŠ¶æ€</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">initState</span> = (<span class="hljs-params">{ reactive, props }</span>) =&gt; {
  <span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({
    <span class="hljs-attr">count</span>: props.<span class="hljs-property">count</span> || <span class="hljs-number">0</span>,
    <span class="hljs-attr">message</span>: <span class="hljs-string">'æ¬¢è¿ä½¿ç”¨ Renderless æ¶æ„ï¼'</span>
  })
  <span class="hljs-keyword">return</span> state
}

<span class="hljs-comment">// æ ¸å¿ƒï¼šrenderless å‡½æ•°</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">renderless</span> = (<span class="hljs-params">props, { reactive, computed, watch, onMounted }, { emit, nextTick, vm }</span>) =&gt; {
  <span class="hljs-keyword">const</span> api = {} <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>
  <span class="hljs-keyword">const</span> state = <span class="hljs-title function_">initState</span>({ reactive, props })

  <span class="hljs-comment">// å®šä¹‰æ–¹æ³•</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleClick</span> = (<span class="hljs-params"/>) =&gt; {
    state.<span class="hljs-property">count</span>++
    <span class="hljs-title function_">emit</span>(<span class="hljs-string">'update:count'</span>, state.<span class="hljs-property">count</span>)
  }

  <span class="hljs-comment">// è®¡ç®—å±æ€§</span>
  <span class="hljs-keyword">const</span> message = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`ä½ å·²ç»ç‚¹å‡»äº† <span class="hljs-subst">${state.count}</span> æ¬¡ï¼`</span>
  })

  <span class="hljs-comment">// ç”Ÿå‘½å‘¨æœŸ</span>
  <span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»„ä»¶å·²æŒ‚è½½'</span>)
  })

  <span class="hljs-comment">// æš´éœ²ç»™æ¨¡æ¿</span>
  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(api, {
    <span class="hljs-attr">count</span>: state.<span class="hljs-property">count</span>,
    message,
    handleClick
  })

  <span class="hljs-keyword">return</span> api
}
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li><code>api</code> æ•°ç»„ï¼šå£°æ˜è¦æš´éœ²ç»™æ¨¡æ¿çš„å±æ€§å’Œæ–¹æ³•</li>
<li><code>renderless</code> å‡½æ•°æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼š
<ol>
<li><code>props</code>ï¼šç»„ä»¶å±æ€§</li>
<li><code>hooks</code>ï¼šVue çš„å“åº”å¼ APIï¼ˆreactive, computed, watch ç­‰ï¼‰</li>
<li><code>context</code>ï¼šä¸Šä¸‹æ–‡ï¼ˆemit, nextTick, vm ç­‰ï¼‰</li>
</ol>
</li>
<li>è¿”å›çš„ <code>api</code> å¯¹è±¡ä¼šè¢«æ³¨å…¥åˆ°æ¨¡æ¿ä¸­</li>
</ul>
<h2 data-id="heading-31">ç¬¬ä¸‰æ­¥ï¼šå®æˆ˜æ¼”ç»ƒ - ä»é›¶å¼€å§‹æ”¹é€ ç»„ä»¶</h2>
<p>ç°åœ¨ä½ å·²ç»æŒæ¡äº†ï¼š</p>
<ul>
<li>âœ… <code>vue-common</code> çš„æ ¸å¿ƒ API</li>
<li>âœ… Renderless æ¶æ„çš„ä¸‰å¤§æ–‡ä»¶</li>
</ul>
<p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­ï¼Œå°†ç†è®ºçŸ¥è¯†è½¬åŒ–ä¸ºå®è·µï¼</p>
<h3 data-id="heading-32">ğŸ¯ ç›®æ ‡</h3>
<p>å°†ä¸€ä¸ªç®€å•çš„è®¡æ•°å™¨ç»„ä»¶æ”¹é€ æˆ Renderless æ¶æ„ï¼Œæ”¯æŒ Vue 2 å’Œ Vue 3ã€‚</p>
<h3 data-id="heading-33">ğŸ“ æ­¥éª¤ 1ï¼šåˆ›å»ºæ–‡ä»¶ç»“æ„</h3>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-keyword">my</span>-counter/
â”œâ”€â”€ index.ts          <span class="hljs-comment"># å…¥å£æ–‡ä»¶</span>
â”œâ”€â”€ pc.vue            <span class="hljs-comment"># æ¨¡æ¿æ–‡ä»¶</span>
â””â”€â”€ renderless.ts     <span class="hljs-comment"># é€»è¾‘æ–‡ä»¶</span>
</code></pre>
<h3 data-id="heading-34">ğŸ“ æ­¥éª¤ 2ï¼šç¼–å†™å…¥å£æ–‡ä»¶</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// index.ts</span>
<span class="hljs-keyword">import</span> { $props, $prefix, defineComponent } <span class="hljs-keyword">from</span> <span class="hljs-string">'@opentiny/vue-common'</span>
<span class="hljs-keyword">import</span> template <span class="hljs-keyword">from</span> <span class="hljs-string">'./pc.vue'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> counterProps = {
  ...$props,
  <span class="hljs-attr">initialValue</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-number">0</span>
  },
  <span class="hljs-attr">step</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-number">1</span>
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineComponent</span>({
  <span class="hljs-attr">name</span>: $prefix + <span class="hljs-string">'Counter'</span>,
  <span class="hljs-attr">props</span>: counterProps,
  ...template
})
</code></pre>
<h3 data-id="heading-35">ğŸ“ æ­¥éª¤ 3ï¼šç¼–å†™é€»è¾‘å±‚</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// renderless.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> api = [<span class="hljs-string">'count'</span>, <span class="hljs-string">'increment'</span>, <span class="hljs-string">'decrement'</span>, <span class="hljs-string">'reset'</span>, <span class="hljs-string">'isEven'</span>]

<span class="hljs-keyword">const</span> <span class="hljs-title function_">initState</span> = (<span class="hljs-params">{ reactive, props }</span>) =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">reactive</span>({
    <span class="hljs-attr">count</span>: props.<span class="hljs-property">initialValue</span> || <span class="hljs-number">0</span>
  })
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">renderless</span> = (<span class="hljs-params">props, { reactive, computed, watch }, { emit, vm }</span>) =&gt; {
  <span class="hljs-keyword">const</span> api = {} <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>
  <span class="hljs-keyword">const</span> state = <span class="hljs-title function_">initState</span>({ reactive, props })

  <span class="hljs-comment">// å¢åŠ </span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">increment</span> = (<span class="hljs-params"/>) =&gt; {
    state.<span class="hljs-property">count</span> += props.<span class="hljs-property">step</span>
    <span class="hljs-title function_">emit</span>(<span class="hljs-string">'change'</span>, state.<span class="hljs-property">count</span>)
  }

  <span class="hljs-comment">// å‡å°‘</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">decrement</span> = (<span class="hljs-params"/>) =&gt; {
    state.<span class="hljs-property">count</span> -= props.<span class="hljs-property">step</span>
    <span class="hljs-title function_">emit</span>(<span class="hljs-string">'change'</span>, state.<span class="hljs-property">count</span>)
  }

  <span class="hljs-comment">// é‡ç½®</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">reset</span> = (<span class="hljs-params"/>) =&gt; {
    state.<span class="hljs-property">count</span> = props.<span class="hljs-property">initialValue</span> || <span class="hljs-number">0</span>
    <span class="hljs-title function_">emit</span>(<span class="hljs-string">'change'</span>, state.<span class="hljs-property">count</span>)
  }

  <span class="hljs-comment">// è®¡ç®—å±æ€§ï¼šæ˜¯å¦ä¸ºå¶æ•°</span>
  <span class="hljs-keyword">const</span> isEven = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">return</span> state.<span class="hljs-property">count</span> % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>
  })

  <span class="hljs-comment">// ç›‘å¬ count å˜åŒ–</span>
  <span class="hljs-title function_">watch</span>(
    <span class="hljs-function">() =&gt;</span> state.<span class="hljs-property">count</span>,
    <span class="hljs-function">(<span class="hljs-params">newVal, oldVal</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`è®¡æ•°ä» <span class="hljs-subst">${oldVal}</span> å˜ä¸º <span class="hljs-subst">${newVal}</span>`</span>)
    }
  )

  <span class="hljs-comment">// æš´éœ² API</span>
  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(api, {
    <span class="hljs-attr">count</span>: state.<span class="hljs-property">count</span>,
    increment,
    decrement,
    reset,
    isEven
  })

  <span class="hljs-keyword">return</span> api
}
</code></pre>
<h3 data-id="heading-36">ğŸ“ æ­¥éª¤ 4ï¼šç¼–å†™æ¨¡æ¿</h3>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- pc.vue --&gt;
&lt;template&gt;
  &lt;div class="tiny-counter"&gt;
    &lt;div class="counter-display"&gt;
      &lt;span :class="{ 'even': isEven, 'odd': !isEven }"&gt;
        {{ count }}
      &lt;/span&gt;
      &lt;small v-if="isEven"&gt;(å¶æ•°)&lt;/small&gt;
      &lt;small v-else&gt;(å¥‡æ•°)&lt;/small&gt;
    &lt;/div&gt;

    &lt;div class="counter-buttons"&gt;
      &lt;button @click="decrement"&gt;-&lt;/button&gt;
      &lt;button @click="reset"&gt;é‡ç½®&lt;/button&gt;
      &lt;button @click="increment"&gt;+&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script lang="ts"&gt;
import { defineComponent, setup, $props } from '@opentiny/vue-common'
import { renderless, api } from './renderless'

export default defineComponent({
  props: {
    ...$props,
    initialValue: Number,
    step: Number
  },
  emits: ['change'],
  setup(props, context) {
    return setup({ props, context, renderless, api })
  }
})
&lt;/script&gt;

&lt;style scoped&gt;
.tiny-counter {
  padding: 20px;
  border: 1px solid #ddd;
  border-radius: 8px;
  text-align: center;
}

.counter-display {
  font-size: 48px;
  margin-bottom: 20px;
}

.counter-display .even {
  color: green;
}

.counter-display .odd {
  color: blue;
}

.counter-buttons button {
  margin: 0 5px;
  padding: 10px 20px;
  font-size: 18px;
  cursor: pointer;
}
&lt;/style&gt;
</code></pre>
<h3 data-id="heading-37">ğŸ‰ å®Œæˆï¼</h3>
<p>ç°åœ¨è¿™ä¸ªç»„ä»¶å¯ä»¥åœ¨ Vue 2 å’Œ Vue 3 ä¸­æ— ç¼ä½¿ç”¨äº†ï¼</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- Vue 2 æˆ– Vue 3 éƒ½å¯ä»¥ --&gt;
&lt;template&gt;
  &lt;tiny-counter :initial-value="10" :step="2" @change="handleChange" /&gt;
&lt;/template&gt;
</code></pre>
<h2 data-id="heading-38">ç¬¬å››æ­¥ï¼šè¿›é˜¶æŠ€å·§</h2>
<p>æ­å–œä½ ï¼å¦‚æœä½ å·²ç»å®Œæˆäº†å®æˆ˜æ¼”ç»ƒï¼Œè¯´æ˜ä½ å·²ç»æŒæ¡äº† Renderless æ¶æ„çš„åŸºç¡€ã€‚ç°åœ¨è®©æˆ‘ä»¬å­¦ä¹ ä¸€äº›è¿›é˜¶æŠ€å·§ï¼Œè®©ä½ çš„ç»„ä»¶æ›´åŠ ä¼˜é›…å’Œå¼ºå¤§ã€‚</p>
<h3 data-id="heading-39">1. æ¨¡å—åŒ–ï¼šä½¿ç”¨ Composables</h3>
<p>å½“é€»è¾‘å˜å¾—å¤æ‚æ—¶ï¼Œå¯ä»¥å°†åŠŸèƒ½æ‹†åˆ†æˆå¤šä¸ª composablesï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// composables/use-counter.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useCounter</span>(<span class="hljs-params">{ state, props, emit }</span>) {
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">increment</span> = (<span class="hljs-params"/>) =&gt; {
    state.<span class="hljs-property">count</span> += props.<span class="hljs-property">step</span>
    <span class="hljs-title function_">emit</span>(<span class="hljs-string">'change'</span>, state.<span class="hljs-property">count</span>)
  }

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">decrement</span> = (<span class="hljs-params"/>) =&gt; {
    state.<span class="hljs-property">count</span> -= props.<span class="hljs-property">step</span>
    <span class="hljs-title function_">emit</span>(<span class="hljs-string">'change'</span>, state.<span class="hljs-property">count</span>)
  }

  <span class="hljs-keyword">return</span> { increment, decrement }
}

<span class="hljs-comment">// composables/use-validation.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useValidation</span>(<span class="hljs-params">{ state }</span>) {
  <span class="hljs-keyword">const</span> isEven = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> state.<span class="hljs-property">count</span> % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>)
  <span class="hljs-keyword">const</span> isPositive = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> state.<span class="hljs-property">count</span> &gt; <span class="hljs-number">0</span>)

  <span class="hljs-keyword">return</span> { isEven, isPositive }
}

<span class="hljs-comment">// renderless.ts</span>
<span class="hljs-keyword">import</span> { useCounter } <span class="hljs-keyword">from</span> <span class="hljs-string">'./composables/use-counter'</span>
<span class="hljs-keyword">import</span> { useValidation } <span class="hljs-keyword">from</span> <span class="hljs-string">'./composables/use-validation'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">renderless</span> = (<span class="hljs-params">props, hooks, context</span>) =&gt; {
  <span class="hljs-keyword">const</span> api = {} <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>
  <span class="hljs-keyword">const</span> state = <span class="hljs-title function_">initState</span>({ reactive, props })

  <span class="hljs-comment">// ä½¿ç”¨ composables</span>
  <span class="hljs-keyword">const</span> { increment, decrement } = <span class="hljs-title function_">useCounter</span>({ state, props, emit })
  <span class="hljs-keyword">const</span> { isEven, isPositive } = <span class="hljs-title function_">useValidation</span>({ state })

  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(api, {
    <span class="hljs-attr">count</span>: state.<span class="hljs-property">count</span>,
    increment,
    decrement,
    isEven,
    isPositive
  })

  <span class="hljs-keyword">return</span> api
}
</code></pre>
<h3 data-id="heading-40">2. è®¿é—®ç»„ä»¶å®ä¾‹ï¼ˆvmï¼‰</h3>
<p>æœ‰æ—¶å€™éœ€è¦è®¿é—®ç»„ä»¶å®ä¾‹ï¼Œæ¯”å¦‚è·å– refsï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">renderless</span> = (<span class="hljs-params">props, hooks, { vm }</span>) =&gt; {
  <span class="hljs-keyword">const</span> api = {} <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">focusInput</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-comment">// Vue 2: vm.$refs.inputRef</span>
    <span class="hljs-comment">// Vue 3: vm.refs.inputRef</span>
    <span class="hljs-keyword">const</span> inputRef = vm?.<span class="hljs-property">$refs</span>?.<span class="hljs-property">inputRef</span> || vm?.<span class="hljs-property">refs</span>?.<span class="hljs-property">inputRef</span>
    <span class="hljs-keyword">if</span> (inputRef) {
      inputRef.<span class="hljs-title function_">focus</span>()
    }
  }

  <span class="hljs-comment">// å­˜å‚¨ vm åˆ° stateï¼Œæ–¹ä¾¿åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨</span>
  state.<span class="hljs-property">instance</span> = vm

  <span class="hljs-keyword">return</span> api
}
</code></pre>
<h3 data-id="heading-41">3. å¤„ç† Slots</h3>
<p>åœ¨ Vue 2 ä¸­ï¼Œslots çš„è®¿é—®æ–¹å¼ä¸åŒï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">renderless</span> = (<span class="hljs-params">props, hooks, { vm, slots }</span>) =&gt; {
  <span class="hljs-keyword">const</span> api = {} <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>
  <span class="hljs-keyword">const</span> state = <span class="hljs-title function_">initState</span>({ reactive, props })

  <span class="hljs-comment">// å­˜å‚¨ vm å’Œ slots</span>
  state.<span class="hljs-property">instance</span> = vm

  <span class="hljs-comment">// Vue 2 ä¸­éœ€è¦æ‰‹åŠ¨è®¾ç½® slots</span>
  <span class="hljs-keyword">if</span> (vm &amp;&amp; slots) {
    vm.<span class="hljs-property">slots</span> = slots
  }

  <span class="hljs-keyword">return</span> api
}
</code></pre>
<p>åœ¨æ¨¡æ¿ä¸­æ£€æŸ¥ slotï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div v-if="state.instance?.$slots?.default || state.instance?.slots?.default"&gt;
    &lt;slot&gt;&lt;/slot&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<h3 data-id="heading-42">4. ç”Ÿå‘½å‘¨æœŸå¤„ç†</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">renderless</span> = (<span class="hljs-params">props, hooks, context</span>) =&gt; {
  <span class="hljs-keyword">const</span> { onMounted, onBeforeUnmount, onUpdated } = hooks

  <span class="hljs-comment">// ç»„ä»¶æŒ‚è½½å</span>
  <span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»„ä»¶å·²æŒ‚è½½'</span>)
    <span class="hljs-comment">// æ·»åŠ äº‹ä»¶ç›‘å¬</span>
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, handleDocumentClick)
  })

  <span class="hljs-comment">// ç»„ä»¶æ›´æ–°å</span>
  <span class="hljs-title function_">onUpdated</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»„ä»¶å·²æ›´æ–°'</span>)
  })

  <span class="hljs-comment">// ç»„ä»¶å¸è½½å‰</span>
  <span class="hljs-title function_">onBeforeUnmount</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»„ä»¶å³å°†å¸è½½'</span>)
    <span class="hljs-comment">// æ¸…ç†äº‹ä»¶ç›‘å¬</span>
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'click'</span>, handleDocumentClick)
  })

  <span class="hljs-keyword">return</span> api
}
</code></pre>
<h3 data-id="heading-43">5. ä½¿ç”¨Watchç›‘å¬</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">renderless</span> = (<span class="hljs-params">props, hooks, context</span>) =&gt; {
  <span class="hljs-keyword">const</span> { watch } = hooks

  <span class="hljs-comment">// ç›‘å¬å•ä¸ªå€¼</span>
  <span class="hljs-title function_">watch</span>(
    <span class="hljs-function">() =&gt;</span> state.<span class="hljs-property">count</span>,
    <span class="hljs-function">(<span class="hljs-params">newVal, oldVal</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`count ä» <span class="hljs-subst">${oldVal}</span> å˜ä¸º <span class="hljs-subst">${newVal}</span>`</span>)
    }
  )

  <span class="hljs-comment">// ç›‘å¬å¤šä¸ªå€¼</span>
  <span class="hljs-title function_">watch</span>([<span class="hljs-function">() =&gt;</span> state.<span class="hljs-property">count</span>, <span class="hljs-function">() =&gt;</span> props.<span class="hljs-property">step</span>], <span class="hljs-function">(<span class="hljs-params">[newCount, newStep], [oldCount, oldStep]</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'count æˆ– step å‘ç”Ÿäº†å˜åŒ–'</span>)
  })

  <span class="hljs-comment">// æ·±åº¦ç›‘å¬å¯¹è±¡</span>
  <span class="hljs-title function_">watch</span>(
    <span class="hljs-function">() =&gt;</span> state.<span class="hljs-property">user</span>,
    <span class="hljs-function">(<span class="hljs-params">newUser</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'user å¯¹è±¡å‘ç”Ÿäº†å˜åŒ–'</span>, newUser)
    },
    { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span> }
  )

  <span class="hljs-comment">// ç«‹å³æ‰§è¡Œ</span>
  <span class="hljs-title function_">watch</span>(
    <span class="hljs-function">() =&gt;</span> props.<span class="hljs-property">initialValue</span>,
    <span class="hljs-function">(<span class="hljs-params">newVal</span>) =&gt;</span> {
      state.<span class="hljs-property">count</span> = newVal
    },
    { <span class="hljs-attr">immediate</span>: <span class="hljs-literal">true</span> }
  )

  <span class="hljs-keyword">return</span> api
}
</code></pre>
<h2 data-id="heading-44">å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-45">â“ é—®é¢˜ 1ï¼šä¸ºä»€ä¹ˆæˆ‘çš„å“åº”å¼æ•°æ®ä¸æ›´æ–°ï¼Ÿ</h3>
<p><strong>åŸå› </strong>ï¼šåœ¨ <code>renderless</code> ä¸­ï¼Œéœ€è¦å°†å“åº”å¼æ•°æ®æš´éœ²åˆ° <code>api</code> å¯¹è±¡ä¸­ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šç›´æ¥è¿”å› state</span>
<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(api, {
  state <span class="hljs-comment">// è¿™æ ·æ¨¡æ¿æ— æ³•è®¿é—® state.count</span>
})

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šå±•å¼€ state æˆ–æ˜ç¡®æš´éœ²å±æ€§</span>
<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(api, {
  <span class="hljs-attr">count</span>: state.<span class="hljs-property">count</span>, <span class="hljs-comment">// æ˜ç¡®æš´éœ²</span>
  <span class="hljs-attr">message</span>: state.<span class="hljs-property">message</span>
})

<span class="hljs-comment">// æˆ–è€…ä½¿ç”¨ computed</span>
<span class="hljs-keyword">const</span> count = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> state.<span class="hljs-property">count</span>)
<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(api, {
  count <span class="hljs-comment">// ä½¿ç”¨ computed åŒ…è£…</span>
})
</code></pre>
<h3 data-id="heading-46">â“ é—®é¢˜ 2ï¼šå¦‚ä½•åœ¨æ¨¡æ¿ä¸­è®¿é—®ç»„ä»¶å®ä¾‹ï¼Ÿ</h3>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šå°† <code>vm</code> å­˜å‚¨åˆ° <code>state</code> ä¸­ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">renderless</span> = (<span class="hljs-params">props, hooks, { vm }</span>) =&gt; {
  <span class="hljs-keyword">const</span> state = <span class="hljs-title function_">initState</span>({ reactive, props })
  state.<span class="hljs-property">instance</span> = vm <span class="hljs-comment">// å­˜å‚¨å®ä¾‹</span>

  <span class="hljs-keyword">return</span> api
}
</code></pre>
<p>åœ¨æ¨¡æ¿ä¸­ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div&gt;
    &lt;!-- è®¿é—® refs --&gt;
    &lt;input ref="inputRef" /&gt;
    &lt;button @click="focusInput"&gt;èšç„¦&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">focusInput</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> inputRef = state.<span class="hljs-property">instance</span>?.<span class="hljs-property">$refs</span>?.<span class="hljs-property">inputRef</span> || state.<span class="hljs-property">instance</span>?.<span class="hljs-property">refs</span>?.<span class="hljs-property">inputRef</span>
  inputRef?.<span class="hljs-title function_">focus</span>()
}
</code></pre>
<h3 data-id="heading-47">â“ é—®é¢˜ 3ï¼šVue 2 å’Œ Vue 3 çš„ emit æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šä½¿ç”¨ <code>@opentiny/vue-common</code> æä¾›çš„å…¼å®¹å±‚ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">renderless</span> = (<span class="hljs-params">props, hooks, { emit: $emit }</span>) =&gt; {
  <span class="hljs-comment">// å…¼å®¹å¤„ç†</span>
  <span class="hljs-keyword">const</span> emit = props.<span class="hljs-property">emitter</span> ? props.<span class="hljs-property">emitter</span>.<span class="hljs-property">emit</span> : $emit

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleClick</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-comment">// ç›´æ¥ä½¿ç”¨ emitï¼Œå…¼å®¹å±‚ä¼šå¤„ç†å·®å¼‚</span>
    <span class="hljs-title function_">emit</span>(<span class="hljs-string">'update:modelValue'</span>, newValue)
    <span class="hljs-title function_">emit</span>(<span class="hljs-string">'change'</span>, newValue)
  }

  <span class="hljs-keyword">return</span> api
}
</code></pre>
<h3 data-id="heading-48">â“ é—®é¢˜ 4ï¼šå¦‚ä½•å¤„ç†å¼‚æ­¥æ“ä½œï¼Ÿ</h3>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šä½¿ç”¨ <code>nextTick</code> ç¡®ä¿ DOM æ›´æ–°ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">renderless</span> = (<span class="hljs-params">props, hooks, { nextTick }</span>) =&gt; {
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleAsyncUpdate</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-comment">// æ‰§è¡Œå¼‚æ­¥æ“ä½œ</span>
    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchData</span>()
    state.<span class="hljs-property">data</span> = data

    <span class="hljs-comment">// ç­‰å¾… DOM æ›´æ–°</span>
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">nextTick</span>()

    <span class="hljs-comment">// æ­¤æ—¶å¯ä»¥å®‰å…¨åœ°æ“ä½œ DOM</span>
    <span class="hljs-keyword">const</span> element = state.<span class="hljs-property">instance</span>?.<span class="hljs-property">$el</span> || state.<span class="hljs-property">instance</span>?.<span class="hljs-property">el</span>
    <span class="hljs-keyword">if</span> (element) {
      element.<span class="hljs-title function_">scrollIntoView</span>()
    }
  }

  <span class="hljs-keyword">return</span> api
}
</code></pre>
<h3 data-id="heading-49">â“ é—®é¢˜ 5ï¼šå¦‚ä½•è°ƒè¯• Renderless ç»„ä»¶ï¼Ÿ</h3>
<p><strong>æŠ€å·§</strong>ï¼š</p>
<ol>
<li><strong>ä½¿ç”¨ console.log</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">renderless</span> = (<span class="hljs-params">props, hooks, context</span>) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Props:'</span>, props)
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'State:'</span>, state)
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Context:'</span>, context)

  <span class="hljs-comment">// åœ¨å…³é”®ä½ç½®æ·»åŠ æ—¥å¿—</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleClick</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Button clicked!'</span>, state.<span class="hljs-property">count</span>)
    <span class="hljs-comment">// ...</span>
  }

  <span class="hljs-keyword">return</span> api
}
</code></pre>
<ol start="2">
<li><strong>ä½¿ç”¨ Vue DevTools</strong>ï¼š
<ul>
<li>åœ¨æ¨¡æ¿ä¸­æ·»åŠ è°ƒè¯•ä¿¡æ¯</li>
<li>ä½¿ç”¨ <code>state</code> å­˜å‚¨è°ƒè¯•æ•°æ®</li>
</ul>
</li>
<li><strong>æ–­ç‚¹è°ƒè¯•</strong>ï¼š
<ul>
<li>åœ¨ <code>renderless.ts</code> ä¸­è®¾ç½®æ–­ç‚¹</li>
<li>æ£€æŸ¥ <code>api</code> å¯¹è±¡çš„è¿”å›å€¼</li>
</ul>
</li>
</ol>
<h2 data-id="heading-50">æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-51">âœ… DOï¼ˆæ¨èåšæ³•ï¼‰</h3>
<ol>
<li><strong>æ¨¡å—åŒ–ç»„ç»‡ä»£ç </strong>
<pre><code class="hljs language-perl" lang="perl">src/
â”œâ”€â”€ index.ts
â”œâ”€â”€ pc.vue
â”œâ”€â”€ renderless.ts
â”œâ”€â”€ composables/
â”‚   â”œâ”€â”€ <span class="hljs-keyword">use</span>-feature1.ts
â”‚   â””â”€â”€ <span class="hljs-keyword">use</span>-feature2.ts
â””â”€â”€ utils/
    â””â”€â”€ helpers.ts
</code></pre>
</li>
<li><strong>æ˜ç¡®å£°æ˜ API</strong>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// åœ¨æ–‡ä»¶é¡¶éƒ¨å£°æ˜æ‰€æœ‰æš´éœ²çš„ API</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> api = [<span class="hljs-string">'count'</span>, <span class="hljs-string">'increment'</span>, <span class="hljs-string">'decrement'</span>, <span class="hljs-string">'isEven'</span>]
</code></pre>
</li>
<li><strong>ä½¿ç”¨ TypeScript</strong>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">State</span> {
  <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span>
  <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span>
}

<span class="hljs-keyword">const</span> initState = ({ reactive, props }): <span class="hljs-function"><span class="hljs-params">State</span> =&gt;</span> {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">reactive</span>({
    <span class="hljs-attr">count</span>: props.<span class="hljs-property">initialValue</span> || <span class="hljs-number">0</span>,
    <span class="hljs-attr">message</span>: <span class="hljs-string">'Hello'</span>
  })
}
</code></pre>
</li>
<li><strong>å¤„ç†è¾¹ç•Œæƒ…å†µ</strong>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">handleClick</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">if</span> (props.<span class="hljs-property">disabled</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-comment">// æå‰è¿”å›</span>
  }

  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// ä¸šåŠ¡é€»è¾‘</span>
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Error:'</span>, error)
    <span class="hljs-title function_">emit</span>(<span class="hljs-string">'error'</span>, error)
  }
}
</code></pre>
</li>
</ol>
<h3 data-id="heading-52">âŒ DON'Tï¼ˆä¸æ¨èåšæ³•ï¼‰</h3>
<ol>
<li>
<p><strong>ä¸è¦åœ¨æ¨¡æ¿ä¸­å†™é€»è¾‘</strong></p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- âŒ ä¸å¥½ --&gt;
&lt;template&gt;
  &lt;div&gt;{{ count + 1 }}&lt;/div&gt;
&lt;/template&gt;

&lt;!-- âœ… å¥½ --&gt;
&lt;template&gt;
  &lt;div&gt;{{ nextCount }}&lt;/div&gt;
&lt;/template&gt;
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> nextCount = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> state.<span class="hljs-property">count</span> + <span class="hljs-number">1</span>)
</code></pre>
</li>
<li>
<p><strong>ä¸è¦ç›´æ¥ä¿®æ”¹ props</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âŒ ä¸å¥½</span>
props.<span class="hljs-property">count</span>++ <span class="hljs-comment">// ä¸è¦è¿™æ ·åšï¼</span>

<span class="hljs-comment">// âœ… å¥½</span>
state.<span class="hljs-property">count</span> = props.<span class="hljs-property">count</span> + <span class="hljs-number">1</span>
<span class="hljs-title function_">emit</span>(<span class="hljs-string">'update:count'</span>, state.<span class="hljs-property">count</span>)
</code></pre>
</li>
<li>
<p><strong>ä¸è¦å¿˜è®°æ¸…ç†èµ„æº</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âŒ ä¸å¥½</span>
<span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, handler)
  <span class="hljs-comment">// å¿˜è®°æ¸…ç†</span>
})

<span class="hljs-comment">// âœ… å¥½</span>
<span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, handler)
})

<span class="hljs-title function_">onBeforeUnmount</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'click'</span>, handler)
})
</code></pre>
</li>
</ol>
<h2 data-id="heading-53">ğŸ“ æ€»ç»“</h2>
<p>Renderless æ¶æ„çš„æ ¸å¿ƒæ€æƒ³æ˜¯<strong>å…³æ³¨ç‚¹åˆ†ç¦»</strong>ï¼š</p>
<ul>
<li><strong>æ¨¡æ¿å±‚</strong>ï¼šåªè´Ÿè´£ UI å±•ç¤º</li>
<li><strong>é€»è¾‘å±‚</strong>ï¼šå¤„ç†æ‰€æœ‰ä¸šåŠ¡é€»è¾‘</li>
<li><strong>å…¥å£å±‚</strong>ï¼šç»Ÿä¸€å¯¹å¤–æ¥å£</li>
</ul>
<p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š</p>
<ul>
<li>âœ… åŒæ—¶æ”¯æŒ Vue 2 å’Œ Vue 3</li>
<li>âœ… æé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§</li>
<li>âœ… å¢å¼ºä»£ç çš„å¯æµ‹è¯•æ€§</li>
<li>âœ… å®ç°é€»è¾‘çš„æ¨¡å—åŒ–å¤ç”¨</li>
</ul>
<h3 data-id="heading-54">ğŸš€ ä¸‹ä¸€æ­¥</h3>
<ol>
<li>æŸ¥çœ‹ <code>@opentiny/vue-search-box</code> çš„å®Œæ•´æºç </li>
<li>å°è¯•æ”¹é€ è‡ªå·±çš„ç»„ä»¶</li>
<li>æ¢ç´¢æ›´å¤šé«˜çº§ç‰¹æ€§</li>
</ol>
<h3 data-id="heading-55">ğŸ“š å‚è€ƒèµ„æº</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopentiny%2Ftiny-vue%2Ftree%2Fdev%2Fpackages%2Fvue-common" target="_blank" title="https://github.com/opentiny/tiny-vue/tree/dev/packages/vue-common" ref="nofollow noopener noreferrer">@opentiny/vue-common æºç </a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fv2.cn.vuejs.org%2F" target="_blank" title="https://v2.cn.vuejs.org/" ref="nofollow noopener noreferrer">@opentiny/vue-search-box æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fv2.cn.vuejs.org%2F" target="_blank" title="https://v2.cn.vuejs.org/" ref="nofollow noopener noreferrer">Vue 2 å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcn.vuejs.org%2F" target="_blank" title="https://cn.vuejs.org/" ref="nofollow noopener noreferrer">Vue 3 å®˜æ–¹æ–‡æ¡£</a></li>
</ul>
<p><strong>Happy Coding! ğŸ‰</strong></p>
<blockquote>
<p>è®°ä½ï¼šRenderless ä¸æ˜¯é­”æ³•ï¼Œè€Œæ˜¯ä¸€ç§æ€ç»´æ–¹å¼ã€‚å½“ä½ ç†è§£äº†å®ƒï¼Œä½ ä¼šå‘ç°ï¼ŒåŸæ¥ç»„ä»¶å¯ä»¥è¿™æ ·å†™ï¼</p>
</blockquote>
<h2 data-id="heading-56">å…³äºOpenTiny</h2>
<p>æ¬¢è¿åŠ å…¥ OpenTiny å¼€æºç¤¾åŒºã€‚æ·»åŠ å¾®ä¿¡å°åŠ©æ‰‹ï¼šopentiny-official ä¸€èµ·å‚ä¸äº¤æµå‰ç«¯æŠ€æœ¯ï½<br/>
OpenTiny å®˜ç½‘ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fopentiny.design" target="_blank" title="https://opentiny.design" ref="nofollow noopener noreferrer">opentiny.design</a><br/>
OpenTiny ä»£ç ä»“åº“ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopentiny" target="_blank" title="https://github.com/opentiny" ref="nofollow noopener noreferrer">github.com/opentiny</a><br/>
TinyVue æºç ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopentiny%2Ftiny-vue" target="_blank" title="https://github.com/opentiny/tiny-vue" ref="nofollow noopener noreferrer">github.com/opentiny/tiâ€¦</a><br/>
TinyEngine æºç ï¼šâ€…<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopentiny%2Ftiny-engine" target="_blank" title="https://github.com/opentiny/tiny-engine" ref="nofollow noopener noreferrer">github.com/opentiny/tiâ€¦</a><br/>
æ¬¢è¿è¿›å…¥ä»£ç ä»“åº“ StarğŸŒŸTinyEngineã€TinyVueã€TinyNGã€TinyCLIã€TinyEditor~ å¦‚æœä½ ä¹Ÿæƒ³è¦å…±å»ºï¼Œå¯ä»¥è¿›å…¥ä»£ç ä»“åº“ï¼Œæ‰¾åˆ° good first issue æ ‡ç­¾ï¼Œä¸€èµ·å‚ä¸å¼€æºè´¡çŒ®~</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¶ˆå¤±çš„å…‰æ ‡â€”â€”æ·±åº¦è§£æï¼šSlate.js å…¨é‡æ›´æ–°ç»“æ„åçš„å…‰æ ‡æ¢å¤æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7587738151659290624</link>    <guid>https://juejin.cn/post/7587738151659290624</guid>    <pubDate>2025-12-26T08:31:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587738151659290624" data-draft-id="7587688765189439488" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¶ˆå¤±çš„å…‰æ ‡â€”â€”æ·±åº¦è§£æï¼šSlate.js å…¨é‡æ›´æ–°ç»“æ„åçš„å…‰æ ‡æ¢å¤æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="TypeScript"/> <meta itemprop="datePublished" content="2025-12-26T08:31:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="JQ_Zhang"/> <meta itemprop="url" content="https://juejin.cn/user/1871846865110249"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¶ˆå¤±çš„å…‰æ ‡â€”â€”æ·±åº¦è§£æï¼šSlate.js å…¨é‡æ›´æ–°ç»“æ„åçš„å…‰æ ‡æ¢å¤æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1871846865110249/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    JQ_Zhang
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T08:31:14.000Z" title="Fri Dec 26 2025 08:31:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ·±åº¦è§£æï¼šSlate.js å…¨é‡æ›´æ–°ç»“æ„åçš„å…‰æ ‡æ¢å¤æ–¹æ¡ˆ</h2>
<h4 data-id="heading-1">å¼•è¨€ï¼šæ¶ˆå¤±çš„å…‰æ ‡</h4>
<p>åœ¨å¼€å‘å¯Œæ–‡æœ¬ç¼–è¾‘å™¨æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å¯¹å†…å®¹è¿›è¡Œâ€œäºŒæ¬¡åŠ å·¥â€ã€‚æ¯”å¦‚åœ¨ç¿»è¯‘åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®æ ‡ç‚¹ç¬¦å·å°†ç”¨æˆ·è¾“å…¥çš„æ®µè½åŠ¨æ€æ‹†åˆ†æˆå¤šä¸ªâ€œå¥å­çº§â€çš„æ ‡ç­¾ï¼ˆå¦‚ <code>span</code>ï¼‰ï¼Œå¹¶ä¸ºæ¯ä¸€å¥åˆ†é…å”¯ä¸€çš„ <code>compareid</code> ä»¥å®ç°åŸæ–‡å’Œè¯‘æ–‡çš„ç²¾å‡†é«˜äº®ã€‚</p>
<p>ç„¶è€Œï¼ŒSlate.js çš„æ•°æ®æ¨¡å‹æ˜¯åŸºäº <strong>è·¯å¾„ï¼ˆPathï¼‰</strong> çš„ã€‚å½“ä½ æ‰§è¡Œâ€œå…¨é‡èŠ‚ç‚¹æ›¿æ¢â€æ¥æ›´æ–°æ–‡æ¡£ç»“æ„æ—¶ï¼ŒåŸæœ¬çš„è·¯å¾„ä¿¡æ¯ä¼šç¬é—´å¤±æ•ˆï¼Œå¯¼è‡´æµè§ˆå™¨å¤±å»ç„¦ç‚¹ï¼Œå…‰æ ‡ç›´æ¥â€œè·‘è·¯â€ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a5f79e0f42114ec480b6afb9c8e9c877~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSlFfWmhhbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767342674&amp;x-signature=yVTJ5R8BO9DYotrFCqZjy5RL5VQ%3D" alt="test.png" loading="lazy"/></p>
<h4 data-id="heading-2">ç—›ç‚¹ï¼šä¸ºä»€ä¹ˆä¼ ç»Ÿçš„æ¢å¤æ–¹æ³•è¡Œä¸é€šï¼Ÿ</h4>
<p>åœ¨æ™®é€šçš„ <code>&lt;textarea&gt;</code> ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°é€šè¿‡ <code>selectionStart</code> è·å–åç§»é‡å¹¶åœ¨æ›´æ–°åè¿˜åŸã€‚ä½†åœ¨ Slate.js ä¸­ï¼Œä½ ä¼šé‡åˆ°ä»¥ä¸‹éš¾é¢˜ï¼š</p>
<ol>
<li><strong>è·¯å¾„ç ´ç¢</strong>ï¼šSlate çš„é€‰åŒºï¼ˆSelectionï¼‰ä¾èµ–äº <code>Path</code>ï¼ˆå¦‚ï¼šç¬¬ 0 ä¸ªæ®µè½çš„ç¬¬ 1 ä¸ªæ–‡æœ¬èŠ‚ç‚¹ï¼‰ã€‚å½“ä½ åˆ é™¤å¹¶é‡æ–°æ’å…¥èŠ‚ç‚¹åï¼Œæ—§çš„å¼•ç”¨å’Œè·¯å¾„å½»åº•ä½œåºŸã€‚</li>
<li><strong>ç»“æ„çªå˜</strong>ï¼šä¸ºäº†åˆ†å¥ï¼Œæˆ‘ä»¬å¯èƒ½æŠŠä¸€ä¸ªåŸæœ¬ 100 å­—ç¬¦çš„ Text èŠ‚ç‚¹æ‹†æˆäº† 3 ä¸ªå°èŠ‚ç‚¹ã€‚è¿™æ—¶ï¼ŒåŸæœ¬å¤„äºåç§»é‡ 50 çš„ä½ç½®ï¼Œåœ¨æ–°çš„ç»“æ„ä¸­å¯èƒ½å˜æˆäº†â€œç¬¬ 2 ä¸ªèŠ‚ç‚¹çš„åç§»é‡ 10â€ã€‚</li>
<li><strong>ç„¦ç‚¹å¤±è¸ª</strong>ï¼šDOM çš„å¤§è§„æ¨¡å˜åŠ¨ä¼šå¯¼è‡´æµè§ˆå™¨å¼ºåˆ¶æ‰§è¡Œ <code>blur</code>ï¼ˆå¤±ç„¦ï¼‰ï¼Œç”¨æˆ·æ‰“å­—ä¼šçªç„¶ä¸­æ–­ï¼Œä½“éªŒæå·®ã€‚</li>
</ol>
<hr/>
<h4 data-id="heading-3">æ ¸å¿ƒç®—æ³•ï¼šä»â€œç‰©ç†åœ°å€â€åˆ°â€œé€»è¾‘ä½ç§»â€</h4>
<p>æ—¢ç„¶è·¯å¾„ä¼šå˜ï¼Œç»“æ„ä¼šå˜ï¼Œé‚£ä¹ˆåœ¨æ•´ä¸ªæ–‡æ¡£ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œå”¯ä¸€ä¸å˜çš„çœŸç†æ˜¯ä»€ä¹ˆï¼Ÿ
<strong>â€”â€”æ˜¯â€œå­—ç¬¦åç§»é‡â€ã€‚</strong></p>
<p>æ— è®ºæ–‡æ¡£è¢«æ‹†æˆå¤šå°‘ä¸ªæ ‡ç­¾ï¼Œå…‰æ ‡ç›¸å¯¹äºå…¨æ–‡èµ·ç‚¹çš„æ€»å­—ç¬¦æ•°ï¼ˆç¬¬ N ä¸ªå­—ç¬¦ï¼‰æ˜¯ç›¸å¯¹ç¨³å®šçš„ã€‚</p>
<h5 data-id="heading-4">æ–¹æ¡ˆæ­¥éª¤ï¼š</h5>
<ol>
<li><strong>æ›´æ–°å‰â€œå¿«ç…§â€</strong>ï¼šè®¡ç®—å½“å‰å…‰æ ‡ç›¸å¯¹äºå…¨æ–‡å¼€å¤´çš„<strong>å…¨å±€å­—ç¬¦åç§»é‡</strong>ï¼ˆGlobal Offsetï¼‰ã€‚åŒæ—¶è®°å½•å½“å‰æ˜¯å¦æ‹¥æœ‰ç„¦ç‚¹ã€‚</li>
<li><strong>æš´åŠ›é‡æ„</strong>ï¼šæ‰§è¡Œå…¨é‡ DOM æ›¿æ¢ï¼Œç”Ÿæˆå¸¦æ–° ID çš„èŠ‚ç‚¹æ ‘ã€‚</li>
<li><strong>é‡æ–°å¯¼èˆªï¼ˆæ ¸å¿ƒï¼‰</strong>ï¼šåœ¨æ–°ç”Ÿæˆçš„èŠ‚ç‚¹æ ‘ä¸­ï¼Œé€šè¿‡<strong>æ·±åº¦ä¼˜å…ˆéå†</strong>ç´¯åŠ æ¯ä¸ªæ–‡æœ¬èŠ‚ç‚¹çš„é•¿åº¦ï¼Œæ‰¾å›é‚£ä¸ªâ€œç¬¬ N ä¸ªå­—ç¬¦â€å¯¹åº”çš„ç‰©ç†åæ ‡ã€‚</li>
<li><strong>å¼ºåˆ¶é”šå®š</strong>ï¼šå°†è®¡ç®—å‡ºçš„æ–°åæ ‡ï¼ˆPath + Offsetï¼‰ä¼ ç»™ Slateï¼Œå¹¶å¼ºåˆ¶æ‰¾å›ç„¦ç‚¹ã€‚</li>
</ol>
<hr/>
<h4 data-id="heading-5">ä»£ç å®ç°</h4>
<p>ä»¥ä¸‹æ˜¯åŸºäº TypeScript å’Œ Slate åŸç”Ÿ API çš„é€šç”¨æ¢å¤é€»è¾‘ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">/**
 * æ›´æ–°ç¼–è¾‘å™¨å†…å®¹å¹¶æ— ç¼æ¢å¤å…‰æ ‡
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">updateEditorContent</span> = (<span class="hljs-params">editor: Editor, newNodes: Descendant[]</span>) =&gt; {
  <span class="hljs-comment">// 1. è®°å½•æ›´æ–°å‰çš„çŠ¶æ€</span>
  <span class="hljs-keyword">let</span> selectionOffset = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">const</span> { selection } = editor;
  <span class="hljs-comment">// è®°å½•å½“å‰ç¼–è¾‘å™¨æ˜¯å¦æœ‰ç„¦ç‚¹</span>
  <span class="hljs-keyword">const</span> isFocused = <span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">window</span> !== <span class="hljs-string">'undefined'</span> &amp;&amp; <span class="hljs-title class_">ReactEditor</span>.<span class="hljs-title function_">isFocused</span>(editor <span class="hljs-keyword">as</span> <span class="hljs-title class_">ReactEditor</span>);

  <span class="hljs-comment">// ä»…åœ¨å…‰æ ‡å­˜åœ¨ä¸”æœªé€‰ä¸­ä¸€æ®µæ–‡å­—ï¼ˆå³æŠ˜å çŠ¶æ€ï¼‰æ—¶è®°å½•ä½ç½®</span>
  <span class="hljs-keyword">if</span> (selection &amp;&amp; <span class="hljs-title class_">Range</span>.<span class="hljs-title function_">isCollapsed</span>(selection)) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// è®¡ç®—å…¨å±€åç§»é‡ï¼šä»æ–‡ç« èµ·ç‚¹åˆ°å…‰æ ‡å¤„çš„æ€»å­—ç¬¦æ•°</span>
      <span class="hljs-keyword">const</span> beforeRange = {
        <span class="hljs-attr">anchor</span>: <span class="hljs-title class_">Editor</span>.<span class="hljs-title function_">start</span>(editor, []),
        <span class="hljs-attr">focus</span>: selection.<span class="hljs-property">focus</span>,
      };
      selectionOffset = <span class="hljs-title class_">Editor</span>.<span class="hljs-title function_">string</span>(editor, beforeRange).<span class="hljs-property">length</span>;
    } <span class="hljs-keyword">catch</span> (e) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'Failed to save selection offset:'</span>, e);
    }
  }

  <span class="hljs-comment">// ä½¿ç”¨ requestAnimationFrame é¿å¼€åŒæ­¥æ›´æ–°å†²çª</span>
  <span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// withoutNormalizing åŒ…è£…å¯ä»¥é˜²æ­¢åœ¨åˆ é™¤/æ’å…¥ä¸­é—´è¿‡ç¨‹è§¦å‘ Slate çš„è§„èŒƒåŒ–æ£€æŸ¥</span>
    <span class="hljs-title class_">Editor</span>.<span class="hljs-title function_">withoutNormalizing</span>(editor, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// 2. æ‰§è¡Œå…¨é‡æ›´æ–°ï¼ˆé”€æ¯å†é‡å»ºï¼‰</span>
      <span class="hljs-keyword">const</span> totalNodes = editor.<span class="hljs-property">children</span>.<span class="hljs-property">length</span>;
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; totalNodes; i++) {
        <span class="hljs-title class_">Transforms</span>.<span class="hljs-title function_">removeNodes</span>(editor, { <span class="hljs-attr">at</span>: [<span class="hljs-number">0</span>] });
      }
      <span class="hljs-title class_">Transforms</span>.<span class="hljs-title function_">insertNodes</span>(editor, newNodes, { <span class="hljs-attr">at</span>: [<span class="hljs-number">0</span>] });

      <span class="hljs-comment">// 3. æ¢å¤å…‰æ ‡ä½ç½®</span>
      <span class="hljs-keyword">if</span> (selection &amp;&amp; selectionOffset &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">let</span> currentTotal = <span class="hljs-number">0</span>;
          <span class="hljs-keyword">let</span> <span class="hljs-attr">targetPath</span>: <span class="hljs-built_in">number</span>[] | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
          <span class="hljs-keyword">let</span> targetOffset = <span class="hljs-number">0</span>;

          <span class="hljs-comment">// ã€å…³é”®ã€‘éå†æ–°ç”Ÿæˆçš„æ‰€æœ‰æ–‡æœ¬èŠ‚ç‚¹ï¼Œé‡æ–°åŒ¹é…å…¨å±€åç§»é‡</span>
          <span class="hljs-keyword">const</span> nodes = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-title class_">Editor</span>.<span class="hljs-title function_">nodes</span>(editor, { <span class="hljs-attr">at</span>: [], <span class="hljs-attr">match</span>: <span class="hljs-title class_">Text</span>.<span class="hljs-property">isText</span> }));
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [node, path] <span class="hljs-keyword">of</span> nodes) {
            <span class="hljs-keyword">const</span> nodeLength = (node <span class="hljs-keyword">as</span> <span class="hljs-title class_">Text</span>).<span class="hljs-property">text</span>.<span class="hljs-property">length</span>;
            <span class="hljs-keyword">if</span> (currentTotal + nodeLength &gt;= selectionOffset) {
              <span class="hljs-comment">// æ‰¾åˆ°äº†ï¼å…‰æ ‡å°±åœ¨è¿™ä¸ªèŠ‚ç‚¹é‡Œ</span>
              targetPath = path;
              <span class="hljs-comment">// åœ¨è¯¥èŠ‚ç‚¹å†…éƒ¨çš„åç§»é‡ = ç›®æ ‡æ€»åç§»é‡ - ä¹‹å‰èŠ‚ç‚¹çš„æ€»é•¿åº¦</span>
              targetOffset = selectionOffset - currentTotal;
              <span class="hljs-keyword">break</span>;
            }
            currentTotal += nodeLength;
          }

          <span class="hljs-keyword">if</span> (targetPath) {
            <span class="hljs-keyword">const</span> newPoint = { <span class="hljs-attr">path</span>: targetPath, <span class="hljs-attr">offset</span>: targetOffset };
            <span class="hljs-comment">// è®¾ç½®å…‰æ ‡åæ ‡</span>
            <span class="hljs-title class_">Transforms</span>.<span class="hljs-title function_">select</span>(editor, { <span class="hljs-attr">anchor</span>: newPoint, <span class="hljs-attr">focus</span>: newPoint });
            <span class="hljs-comment">// å¦‚æœä¹‹å‰æœ‰ç„¦ç‚¹ï¼Œå¿…é¡»æ˜¾å¼è°ƒç”¨ focus()ï¼Œå¦åˆ™å…‰æ ‡è™½ç„¶å®šä½äº†ä½†ä¸ä¼šæ˜¾ç¤º</span>
            <span class="hljs-keyword">if</span> (isFocused) {
              <span class="hljs-title class_">ReactEditor</span>.<span class="hljs-title function_">focus</span>(editor <span class="hljs-keyword">as</span> <span class="hljs-title class_">ReactEditor</span>);
            }
          }
        } <span class="hljs-keyword">catch</span> (e) {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'Failed to restore selection:'</span>, e);
        }
      }
    });
  });
}
</code></pre>
<hr/>
<h4 data-id="heading-6">æ·±åº¦é—®ç­”ï¼šä¸ºä»€ä¹ˆéè¦â€œéå†æ–‡æœ¬â€ä¸å¯ï¼Ÿ</h4>
<p>å¾ˆå¤šå¼€å‘è€…ä¼šé—®ï¼š<strong>æ—¢ç„¶æˆ‘å·²ç»çŸ¥é“åç§»é‡äº†ï¼Œä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥ä¼ ç»™ Slate æ¢å¤ï¼Ÿ</strong></p>
<p>è¿™æºäº Slate çš„åº•å±‚è®¾è®¡ï¼š</p>
<ol>
<li><strong>æ²¡æœ‰å…¨å±€ç´¢å¼•</strong>ï¼šSlate çš„åæ ‡ç³»æ˜¯â€œå±€éƒ¨å˜é‡â€ã€‚å®ƒä¸çŸ¥é“ä»€ä¹ˆæ˜¯â€œå…¨æ–‡ç¬¬ 500 ä¸ªå­—ç¬¦â€ï¼Œå®ƒåªè®¤â€œæŸæŸèŠ‚ç‚¹çš„ç¬¬å‡ ä¸ªå­—ç¬¦â€ã€‚</li>
<li><strong>ç»“æ„ä¸å†…å®¹åˆ†ç¦»</strong>ï¼šåˆ†å¥é€»è¾‘ä¼šæ”¹å˜æ–‡æœ¬èŠ‚ç‚¹çš„æ•°é‡ã€‚åŸæœ¬çš„ä¸€ä¸ªé•¿ Text èŠ‚ç‚¹è¢«æ‹†åˆ†åï¼ŒåŸæœ¬çš„â€œåç§»é‡ 50â€å¯èƒ½è·¨è¶Šåˆ°äº†æ–°çš„ç¬¬äºŒä¸ªã€ç”šè‡³ç¬¬ä¸‰ä¸ª Text èŠ‚ç‚¹ä¸­ã€‚</li>
<li><strong>é‡å»ºå³æ–°ç”Ÿ</strong>ï¼šåœ¨ <code>insertNodes</code> æ‰§è¡Œåï¼Œæ‰€æœ‰çš„ <code>Path</code> éƒ½æ˜¯å…¨æ–°çš„ã€‚éå†æ–‡æœ¬çš„è¿‡ç¨‹ï¼Œæœ¬è´¨ä¸Šæ˜¯ <strong>å°†â€œé€»è¾‘åæ ‡â€é‡æ–°ç¿»è¯‘ä¸ºâ€œç‰©ç†åæ ‡â€</strong> çš„è¿‡ç¨‹ã€‚</li>
</ol>
<h4 data-id="heading-7">ç»“è¯­</h4>
<p>åœ¨å¯Œæ–‡æœ¬ç¼–è¾‘å™¨çš„ä¸–ç•Œé‡Œï¼Œå…‰æ ‡å°±æ˜¯çµé­‚ã€‚é€šè¿‡â€œå…¨å±€åç§»é‡è®°å½• + æ–‡æœ¬èŠ‚ç‚¹éå†é‡æ„â€çš„æ–¹æ¡ˆï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸æ”¹å˜ Slate æ ¸å¿ƒæ•°æ®æ¨¡å‹çš„å‰æä¸‹ï¼Œå®Œç¾è§£å†³å¤æ‚ç»“æ„è°ƒæ•´å¸¦æ¥çš„å…‰æ ‡ä¸¢å¤±é—®é¢˜ï¼Œä¸ºç”¨æˆ·æä¾›æå…¶é¡ºæ»‘çš„è¾“å…¥ä½“éªŒã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RAG æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è®©å¤§æ¨¡å‹åŸºäºæ–‡æ¡£ä½œç­”]]></title>    <link>https://juejin.cn/post/7587675306659315712</link>    <guid>https://juejin.cn/post/7587675306659315712</guid>    <pubDate>2025-12-26T08:34:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587675306659315712" data-draft-id="7587343333330436130" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RAG æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è®©å¤§æ¨¡å‹åŸºäºæ–‡æ¡£ä½œç­”"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-26T08:34:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç²¾ç¥çŠ¶æ€è‰¯å¥½"/> <meta itemprop="url" content="https://juejin.cn/user/1591748568024967"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RAG æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è®©å¤§æ¨¡å‹åŸºäºæ–‡æ¡£ä½œç­”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1591748568024967/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç²¾ç¥çŠ¶æ€è‰¯å¥½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T08:34:35.000Z" title="Fri Dec 26 2025 08:34:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/435148d50c43424db62178254b356616~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg57K-56We54q25oCB6Imv5aW9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767342875&amp;x-signature=oSF6NTKvl3A5qMpjs5op7xZ0qmA%3D" alt="2cb71f48209ff63b264af65602693cbd.jpeg" loading="lazy"/></p>
<h2 data-id="heading-0">RAG æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<blockquote>
<p>çº¯é å¯¹è¯ä½¿ç”¨å¤§æ¨¡å‹æ—¶ï¼Œæˆ‘æœ€å¸¸é‡åˆ°çš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼šå®ƒ<strong>è¡¨è¾¾èƒ½åŠ›å¾ˆå¼ºï¼Œä½†ä¸ä¸€å®šæŒæ¡æˆ‘é¡¹ç›®é‡Œçš„â€œäº‹å®â€</strong> ã€‚æ¯”å¦‚å…¬å¸å†…éƒ¨çš„æ¥å£å‘½åã€é‰´æƒè§„èŒƒã€æœ€æ–°çš„ä¸šåŠ¡è§„åˆ™ï¼Œå®ƒè¦ä¹ˆä¸çŸ¥é“ï¼Œè¦ä¹ˆåªèƒ½ç»™å‡ºâ€œçœ‹èµ·æ¥å¾ˆå¯¹â€çš„é€šç”¨ç­”æ¡ˆâ€”â€”ä¸€æ—¦è½åˆ°çœŸå®é¡¹ç›®ï¼Œå°±å¯èƒ½è¸©å‘ã€‚</p>
<p>RAGï¼ˆRetrieval-Augmented Generationï¼‰å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚</p>
</blockquote>
<p><strong>RAG = æ£€ç´¢ï¼ˆRetrievalï¼‰ + ç”Ÿæˆï¼ˆGenerationï¼‰</strong></p>
<ul>
<li><strong>æ£€ç´¢</strong>ï¼šå…ˆä»å¤–éƒ¨çŸ¥è¯†ï¼ˆä½ çš„æ–‡æ¡£ã€ä»£ç ã€è§„èŒƒï¼‰é‡Œæ‰¾å‡ºä¸é—®é¢˜æœ€ç›¸å…³çš„ç‰‡æ®µï¼ˆè¯æ®ï¼‰ã€‚</li>
<li><strong>ç”Ÿæˆ</strong>ï¼šæŠŠâ€œé—®é¢˜ + è¯æ®â€äº¤ç»™ LLMï¼Œè®©å®ƒåŸºäºè¯æ®æ¨ç†ã€æ€»ç»“å¹¶è¾“å‡ºç­”æ¡ˆï¼ˆæœ€å¥½å¸¦å¼•ç”¨ï¼‰ã€‚</li>
</ul>
<p>æˆ‘æ›´æ„¿æ„æŠŠå®ƒç†è§£ä¸ºï¼š<strong>ç»™å¤§æ¨¡å‹é…äº†ä¸€ä¸ªâ€œå¯æŸ¥è¯¢çš„å¤–éƒ¨çŸ¥è¯†åº“â€ï¼Œè®©å®ƒåœ¨å›ç­”å‰å…ˆç¿»èµ„æ–™ï¼Œå†å¼€å£ã€‚</strong></p>
<h2 data-id="heading-1">RAG é‡Œçš„â€œæ£€ç´¢â€ï¼Œä¸ºä»€ä¹ˆç¦»ä¸å¼€å‘é‡ï¼Ÿ</h2>
<p>è¯´åˆ°æ£€ç´¢ï¼Œå¾ˆå¤šäººç¬¬ä¸€ååº”æ˜¯â€œæœç´¢å¼•æ“â€ï¼šå…³é”®è¯åŒ¹é…ã€å…¨æ–‡æœç´¢ã€ESâ€¦â€¦è¿™äº›å½“ç„¶èƒ½ç”¨ï¼Œä½†å®ƒä»¬æ›´åå‘â€œæŸ¥å­—é¢â€ï¼Œè€Œ RAG æ›´å¸¸è§çš„è¯‰æ±‚æ˜¯ï¼š</p>
<blockquote>
<p>æˆ‘é—®çš„æ˜¯ä¸€å¥äººè¯ï¼Œä½†æˆ‘å¸Œæœ›ç³»ç»Ÿèƒ½åœ¨çŸ¥è¯†åº“é‡Œæ‰¾åˆ°â€œè®²åŒä¸€ä»¶äº‹â€çš„é‚£å‡ æ®µå†…å®¹ã€‚</p>
</blockquote>
<p>è¿™å°±å¼•å‡ºäº†å‘é‡ï¼ˆæ›´å‡†ç¡®è¯´ï¼š<strong>embedding å‘é‡</strong>ï¼‰â€”â€”å®ƒè§£å†³çš„æ˜¯â€œæŒ‰æ„æ€æ‰¾â€çš„é—®é¢˜ã€‚</p>
<h2 data-id="heading-2">å‘é‡æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p>ä½œä¸ºå‰ç«¯å¼€å‘äººå‘˜ï¼Œåˆšå¼€å§‹æ¥è§¦å‘é‡æ—¶ä¸å¤ªå¥½ç†è§£å®ƒçš„æ¦‚å¿µã€‚åæ¥æˆ‘å¹²è„†ä¸å»çº ç»“â€œé«˜ç»´ç©ºé—´â€è¿™äº›å¬èµ·æ¥å¾ˆå­¦æœ¯çš„è¯ï¼Œè€Œæ˜¯æ¢äº†ä¸ªæ›´å¥½ç†è§£çš„è¯´æ³•ï¼š</p>
<p><strong>å‘é‡å¯ä»¥å…ˆå½“æˆâ€œåæ ‡â€ã€‚</strong></p>
<p>ç”Ÿæ´»é‡Œæˆ‘ä»¬ç†Ÿæ‚‰çš„åæ ‡æ˜¯äºŒç»´ã€ä¸‰ç»´ï¼šå¹³é¢ä¸€ä¸ªç‚¹ã€ç©ºé—´ä¸€ä¸ªç‚¹ã€‚åæ ‡æœ‰ä¸ªå¤©ç„¶ä¼˜åŠ¿ï¼š<strong>èƒ½ç®—è·ç¦»</strong>ã€‚ç»™ä¸¤ä¸ªç‚¹ï¼Œåœ¨æ•°å­¦ä¸­å°±èƒ½ç®—å‡ºå®ƒä»¬ç¦»å¾—è¿œè¿˜æ˜¯è¿‘ï¼Œè¿˜èƒ½æ‰¾â€œç¦»æˆ‘æœ€è¿‘çš„é‚£ä¸ªç‚¹â€ã€‚</p>
<p>å…³é”®é—®é¢˜æ¥äº†ï¼š</p>
<p>æ—¢ç„¶ç‚¹å’Œç‚¹èƒ½ç®—è·ç¦»ï¼Œé‚£èƒ½ä¸èƒ½è®©ä¸¤æ®µæ–‡å­—ä¹Ÿåƒâ€œç‚¹â€ä¸€æ ·èƒ½ç®—è·ç¦»ï¼Ÿå¬ä¸Šå»æŠ½è±¡ï¼Œä½†å®ƒèƒŒåæ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„éœ€æ±‚ï¼š<strong>æŒ‰è¯­ä¹‰å»æœä¸œè¥¿</strong>ã€‚</p>
<p>ä¸€ä¸ªä¾‹å­ï¼šæˆ‘çœŸæ­£æƒ³æœçš„æ˜¯â€œæ„æ€â€ï¼Œä¸æ˜¯â€œå…³é”®è¯â€</p>
<p>å‡è®¾æˆ‘åœ¨åšä¸€ä¸ª AI åŠ©æ‰‹ï¼Œæˆ‘é—®å®ƒï¼š</p>
<blockquote>
<p>â€œç™»å½•è¿‡æœŸæ€ä¹ˆå¤„ç†ï¼Ÿâ€</p>
</blockquote>
<p>æˆ‘çš„çŸ¥è¯†åº“é‡Œä¸ä¸€å®šåˆšå¥½æœ‰ä¸€æ®µæ–‡å­—å°±å«â€œç™»å½•è¿‡æœŸæ€ä¹ˆå¤„ç†â€ã€‚å®ƒå¯èƒ½å†™çš„æ˜¯ï¼š</p>
<blockquote>
<p>â€œtoken å¤±æ•ˆåçš„è·³è½¬ç­–ç•¥ï¼šæ¸…ç©ºæœ¬åœ°ç™»å½•æ€ï¼Œè·³è½¬åˆ° /auth/sign-inï¼Œå¹¶ä¿ç•™ redirect å‚æ•°â€¦â€¦â€</p>
</blockquote>
<p>è¿™ä¸¤å¥è¯å­—é¢å¹¶ä¸å®Œå…¨é‡åˆï¼Œä½†æ„æ€éå¸¸æ¥è¿‘ï¼šéƒ½æ˜¯åœ¨è¯´â€œç™»å½•å¤±æ•ˆä»¥åç³»ç»Ÿåº”è¯¥æ€ä¹ˆåšâ€ã€‚</p>
<p>å¦‚æœæˆ‘ç”¨çš„æ˜¯çº¯å…³é”®è¯æœç´¢ï¼Œå®ƒæ›´åå‘â€œæœ‰æ²¡æœ‰å‡ºç°â€˜ç™»å½•è¿‡æœŸâ€™è¿™å‡ ä¸ªå­—â€ã€‚è€Œæˆ‘çœŸæ­£æƒ³è¦çš„æ˜¯ï¼š</p>
<p><strong>æŠŠçŸ¥è¯†åº“é‡Œâ€œè®²åŒä¸€ä»¶äº‹â€çš„é‚£æ®µå†…å®¹æœå‡ºæ¥ã€‚</strong></p>
<p>é‚£å‘é‡åˆ°åº•æ€ä¹ˆæŠŠâ€œè¯­ä¹‰â€å˜æˆâ€œè·ç¦»â€ï¼Ÿ</p>
<p>æˆ‘çš„ç†è§£æ˜¯è¿™æ ·ä¸€æ¡é“¾è·¯ï¼š</p>
<ol>
<li><strong>å…ˆæŠŠæ–‡å­—å˜æˆä¸€ä¸²æ•°å­—</strong>ï¼ˆè¿™ä¸€æ­¥é Â <em>Embedding æ¨¡å‹</em>ï¼Œä¸æ˜¯æ‰‹å†™è§„åˆ™ï¼‰</li>
<li>è¿™ä¸²æ•°å­—å¯ä»¥çœ‹æˆå®ƒçš„<strong>è¯­ä¹‰æŒ‡çº¹</strong>ï¼ˆæˆ–è€…è¯´â€œé«˜ç»´åæ ‡â€ï¼‰</li>
<li>æŒ‡çº¹ä¹‹é—´å¯ä»¥è®¡ç®—â€œåƒä¸åƒâ€ï¼ˆç›¸ä¼¼åº¦/è·ç¦»ï¼‰</li>
<li><strong>è¶Šåƒçš„ï¼Œå°±è¶Šåº”è¯¥è¢«æ£€ç´¢å‡ºæ¥</strong></li>
</ol>
<p>æ‰€ä»¥æ‰€è°“â€œå‘é‡æ£€ç´¢â€ï¼Œæœ¬è´¨å°±æ˜¯ï¼š</p>
<blockquote>
<p>æˆ‘æŠŠâ€œç™»å½•è¿‡æœŸæ€ä¹ˆå¤„ç†â€ä¹Ÿè½¬æˆè¯­ä¹‰æŒ‡çº¹ï¼Œç„¶ååœ¨ä¸€å †æ–‡æ¡£ç‰‡æ®µçš„æŒ‡çº¹é‡Œï¼Œæ‰¾å‡ºæœ€åƒâ€œtoken å¤±æ•ˆåçš„è·³è½¬ç­–ç•¥â€é‚£å‡ æ®µã€‚</p>
</blockquote>
<h3 data-id="heading-3">â€œè·ç¦»/ç›¸ä¼¼åº¦â€æ€ä¹ˆç®—ï¼Ÿä¸ç”¨èƒŒå…¬å¼ï¼Œè®°ä½ç»“è®ºå°±å¤Ÿ</h3>
<p>å¸¸è§çš„è®¡ç®—æ–¹å¼æœ‰ä¸¤ç±»åè¯ï¼š</p>
<ul>
<li><strong>ä½™å¼¦ç›¸ä¼¼åº¦</strong>ï¼šåˆ†æ•°è¶Šå¤§è¶Šåƒ</li>
<li><strong>æ¬§æ°è·ç¦»ï¼ˆL2ï¼‰</strong> ï¼šè·ç¦»è¶Šå°è¶Šåƒ</li>
</ul>
<p>æˆ‘ä¸éœ€è¦è®°å…¬å¼ï¼Œåªè¦è®°ä½ï¼š<strong>å®ƒä»¬éƒ½æ˜¯åœ¨å›ç­”åŒä¸€ä¸ªé—®é¢˜â€”â€”ä¸¤æ®µå†…å®¹åˆ°åº•åƒä¸åƒã€‚</strong></p>
<p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±ç†è§£äº† RAG é‡Œæœ€å…³é”®çš„ Retrieval ï¼š<strong>æˆ‘éœ€è¦å…ˆä»çŸ¥è¯†åº“é‡Œå¬å›â€œèƒ½å›ç­”è¿™ä¸ªé—®é¢˜çš„è¯æ®ç‰‡æ®µâ€</strong>ï¼Œå‘é‡æ£€ç´¢å°±æ˜¯ç›®å‰æœ€é€šç”¨çš„ä¸€ç§å®ç°ã€‚</p>
<h2 data-id="heading-4">å…ˆæŠŠè¯¯åŒºè®²æ¸…æ¥šï¼šå‘é‡åº“ä¸äº§å‡ºç­”æ¡ˆï¼ŒLLM æ‰äº§å‡ºç­”æ¡ˆ</h2>
<p>å¾ˆå¤šäººç¬¬ä¸€æ¬¡å¬ RAGï¼Œä¼šä¸‹æ„è¯†è®¤ä¸ºæµç¨‹æ˜¯ï¼ˆèµ·åˆæˆ‘æ˜¯è¿™ä¹ˆç†è§£çš„ğŸ˜‚ï¼‰ï¼š</p>
<p>ç”¨æˆ·æé—® â†’ å‘é‡æ•°æ®åº“åŒ¹é… â†’ è¿”å›ç­”æ¡ˆ</p>
<p>è¿™ä¸å‡†ç¡®ã€‚æ›´å‡†ç¡®çš„æ˜¯ï¼š</p>
<p>ç”¨æˆ·æé—® â†’ å‘é‡æ•°æ®åº“<strong>æ‰¾èµ„æ–™</strong> â†’ LLM <strong>è¯»èµ„æ–™å†™ç­”æ¡ˆ</strong></p>
<ul>
<li>å‘é‡æ•°æ®åº“è¿”å›çš„æ˜¯<strong>ç›¸å…³åŸæ–‡ç‰‡æ®µ</strong>ï¼ˆchunksï¼‰ï¼Œå®ƒä¸è´Ÿè´£â€œè§£é‡Šâ€å’Œâ€œç»„ç»‡è¯­è¨€â€ã€‚</li>
<li>LLM çš„å·¥ä½œæ˜¯ï¼šåŸºäºæ£€ç´¢åˆ°çš„è¯æ®ï¼Œè¾“å‡ºæ›´è´´è¿‘äººç±»é˜…è¯»çš„ç­”æ¡ˆï¼Œå¹¶èƒ½ç»™å‡ºç†ç”±/å¼•ç”¨ã€‚</li>
</ul>
<h2 data-id="heading-5">ä¸€ä¸ªæœ€å°å¯è½åœ°çš„ RAG ç³»ç»Ÿï¼š4 ä¸ªç»„ä»¶ + 2 æ¡é“¾è·¯</h2>
<p>å¦‚æœæˆ‘ä»¬æŠŠ RAG å½“æˆä¸€å¥—å·¥ç¨‹ç³»ç»Ÿï¼Œå®ƒæœ€å°é—­ç¯å¯ä»¥æ‹†æˆï¼š</p>
<h3 data-id="heading-6">å››ä¸ªæ ¸å¿ƒç»„ä»¶</h3>
<ol>
<li><strong>çŸ¥è¯†åº“ï¼ˆæ•°æ®æºï¼‰</strong> ï¼šæ–‡æ¡£ã€Wikiã€PRDã€ä»£ç ã€FAQâ€¦â€¦</li>
<li><strong>Embedding æ¨¡å‹ï¼ˆè¯­ä¹‰ç¼–ç å™¨ï¼‰</strong> ï¼šæŠŠæ–‡æœ¬è½¬æˆå‘é‡</li>
<li><strong>å‘é‡æ•°æ®åº“ï¼ˆè¯­ä¹‰æœç´¢å¼•æ“ï¼‰</strong> ï¼šå­˜å‘é‡å¹¶æ”¯æŒç›¸ä¼¼åº¦æ£€ç´¢</li>
<li><strong>LLMï¼ˆæ¨ç†/ç”Ÿæˆå¼•æ“ï¼‰</strong> ï¼šåŸºäºè¯æ®è¾“å‡ºç­”æ¡ˆ</li>
</ol>
<p>å¸¸è§å®ç°é‡Œï¼Œå‘é‡åº“ä¸åªå­˜â€œå‘é‡â€ï¼Œä¹Ÿä¼šå­˜ chunk åŸæ–‡ + å…ƒæ•°æ®ï¼ˆæ¥æºé“¾æ¥ã€ç« èŠ‚ã€æ›´æ–°æ—¶é—´ã€æƒé™ç­‰ï¼‰ï¼Œä¾¿äºå¼•ç”¨å’Œè¿½æº¯ã€‚</p>
<p>åŒæ—¶ï¼ŒRAG ä¹Ÿå¯ä»¥å¾ˆç›´è§‚åœ°æ‹†æˆä¸¤æ¡é“¾è·¯ï¼š</p>
<ul>
<li><strong>Retrievalï¼ˆæ£€ç´¢é“¾è·¯ï¼‰</strong> ï¼šEmbedding + å‘é‡åº“</li>
<li><strong>Generationï¼ˆç”Ÿæˆé“¾è·¯ï¼‰</strong> ï¼šPrompt ç»„ç»‡ + LLM</li>
</ul>
<h2 data-id="heading-7">RAG çš„æ ¸å¿ƒå·¥ä½œæµï¼šç¦»çº¿å»ºåº“ + åœ¨çº¿é—®ç­”</h2>
<h3 data-id="heading-8">é˜¶æ®µä¸€ï¼šç¦»çº¿å»ºåº“ï¼ˆæŠŠåŸå§‹èµ„æ–™å˜æˆâ€œå¯æ£€ç´¢ç´¢å¼•â€ï¼‰</h3>
<p>æˆ‘ä»¬è¦å…ˆæŠŠèµ„æ–™å¤„ç†æˆé€‚åˆæ£€ç´¢çš„å½¢æ€ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
  A[åŸå§‹èµ„æ–™&lt;br/&gt;æ–‡æ¡£/ä»£ç /Wiki] --&gt; B[æ¸…æ´—/å»å™ª]
  B --&gt; C[åˆ‡åˆ†ä¸º chunks]
  C --&gt; D[Embedding å‘é‡åŒ–]
  D --&gt; E[å†™å…¥å‘é‡æ•°æ®åº“&lt;br/&gt;vector + chunk + metadata]
</code></pre>
<p>è¿™é‡Œæœ‰ä¸ªå…³é”®åŠ¨ä½œï¼š<strong>åˆ‡åˆ† chunks</strong>ã€‚<br/>
å› ä¸ºæˆ‘ä»¬æ£€ç´¢çš„é€šå¸¸ä¸æ˜¯æ•´ç¯‡æ–‡æ¡£ï¼Œè€Œæ˜¯â€œæœ€ç›¸å…³çš„å‡ æ®µâ€ã€‚åˆ‡åˆ†åšå¾—å¥½ï¼Œæ£€ç´¢æ‰ä¼šå‡†ã€‚</p>
<h3 data-id="heading-9">é˜¶æ®µäºŒï¼šåœ¨çº¿é—®ç­”ï¼ˆå…ˆæ‰¾è¯æ®ï¼Œå†è®© LLM è¾“å‡ºï¼‰</h3>
<p>ç”¨æˆ·æé—®åï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
  A[ç”¨æˆ·é—®é¢˜] --&gt; B[å¯¹é—®é¢˜åš Embedding]
  B --&gt; C[å‘é‡æ£€ç´¢ TopK chunks]
  C --&gt; D[ç»„è£… Prompt&lt;br/&gt;é—®é¢˜ + è¯æ® + è§„åˆ™]
  D --&gt; E[LLM ç”Ÿæˆç­”æ¡ˆ&lt;br/&gt;å¹¶å¯é™„å¼•ç”¨]
</code></pre>
<p>æ³¨æ„è¿™ä¸€æ­¥çš„æœ¬è´¨å˜åŒ–ï¼š<br/>
LLM ä¸å†â€œå‡­ç©ºä½œç­”â€ï¼Œè€Œæ˜¯â€œ<strong>é˜…è¯»è¯æ®åä½œç­”</strong>â€ã€‚</p>
<h2 data-id="heading-10">RAG çš„ä»·å€¼åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p>æœ€åæˆ‘è®©AIå¸®æˆ‘æ€»ç»“äº†ä¸€ä¸‹ï¼š</p>
<ol>
<li><strong>è®©ç­”æ¡ˆå¯è¿½æº¯</strong>ï¼šç­”æ¡ˆèƒŒåæœ‰æ¥æºï¼ˆæ–‡æ¡£/é“¾æ¥/ä»£ç ä½ç½®ï¼‰ï¼Œä¾¿äºéªŒè¯ä¸è¯„å®¡ã€‚</li>
<li><strong>è®©çŸ¥è¯†å¯æ›´æ–°</strong>ï¼šæ–‡æ¡£æ›´æ–° â†’ é‡æ–°å…¥åº“/å¢é‡æ›´æ–° â†’ ç«‹åˆ»ç”Ÿæ•ˆï¼Œä¸å¿…é‡è®­æ¨¡å‹ã€‚</li>
<li><strong>è®©æ¨¡å‹æ›´å°‘èƒ¡ç¼–</strong>ï¼šæœ‰è¯æ®çº¦æŸï¼Œå¹»è§‰æ˜¾è‘—ä¸‹é™ï¼ˆä»å¯èƒ½å‘ç”Ÿï¼Œä½†æ›´æ˜“å‘ç°ï¼‰ã€‚</li>
<li><strong>è®©ç§æœ‰çŸ¥è¯†å¯ç”¨</strong>ï¼šæŠŠå†…éƒ¨èµ„æ–™æ¥å…¥ AIï¼Œå›ç­”æ›´è´´è¿‘é¡¹ç›®çœŸå®æƒ…å†µï¼Œè€Œä¸æ˜¯â€œé€šç”¨å»ºè®®â€ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åœ¨Python+FastAPIé¡¹ç›®ä¸­ä½¿ç”¨SqlAlchemyæ“ä½œæ•°æ®çš„å‡ ç§å¸¸è§æ–¹å¼]]></title>    <link>https://juejin.cn/post/7587336857538527241</link>    <guid>https://juejin.cn/post/7587336857538527241</guid>    <pubDate>2025-12-25T04:05:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587336857538527241" data-draft-id="7587336857538478089" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åœ¨Python+FastAPIé¡¹ç›®ä¸­ä½¿ç”¨SqlAlchemyæ“ä½œæ•°æ®çš„å‡ ç§å¸¸è§æ–¹å¼"/> <meta itemprop="keywords" content="åç«¯,Python"/> <meta itemprop="datePublished" content="2025-12-25T04:05:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¼åèª"/> <meta itemprop="url" content="https://juejin.cn/user/122769398839592"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åœ¨Python+FastAPIé¡¹ç›®ä¸­ä½¿ç”¨SqlAlchemyæ“ä½œæ•°æ®çš„å‡ ç§å¸¸è§æ–¹å¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/122769398839592/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¼åèª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T04:05:48.000Z" title="Thu Dec 25 2025 04:05:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨Python+FastAPIçš„åç«¯é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€å¾ˆå¤šæ—¶å€™éœ€è¦å¯¹æ•°æ®è¿›è¡Œç›¸å…³çš„å¤„ç†ï¼Œæœ¬ç¯‡éšç¬”ä»‹ç»åœ¨Python+FastAPIé¡¹ç›®ä¸­ä½¿ç”¨SqlAlchemyæ“ä½œæ•°æ®çš„å‡ ç§å¸¸è§æ–¹å¼ã€‚</p>
<p>ä½¿ç”¨ FastAPI, SQLAlchemy, Pydanticæ„å»ºåç«¯é¡¹ç›®çš„æ—¶å€™ï¼Œå…¶ä¸­æ•°æ®åº“è®¿é—®é‡‡ç”¨SQLAlchemy çš„å¼‚æ­¥æ–¹å¼å¤„ç†ã€‚ä¸€èˆ¬æˆ‘ä»¬åœ¨æ“ä½œæ•°æ®åº“æ“ä½œçš„æ—¶å€™ï¼Œé‡‡ç”¨åŸºç±»ç»§æ‰¿çš„æ–¹å¼å‡å°‘é‡å¤ä»£ç ï¼Œæé«˜ä»£ç å¤ç”¨æ€§ã€‚ä¸è¿‡æˆ‘ä»¬åœ¨åˆ†æSQLAlchemyçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•çš„æ–¹å¼æ¥å‰–æå‡ ç§å¸¸è§çš„æ•°æ®åº“æ“ä½œæ–¹å¼ï¼Œæ¥ä»‹ç»SQLAlchemyçš„å…·ä½“ä½¿ç”¨ã€‚</p>
<h3 data-id="heading-0">1ã€SQLAlchemyä»‹ç»</h3>
<p><strong>SQLAlchemy</strong>Â æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ä¸”çµæ´»çš„ Python SQL å·¥å…·åŒ…å’Œå¯¹è±¡å…³ç³»æ˜ å°„ï¼ˆORMï¼‰åº“ã€‚å®ƒè¢«å¹¿æ³›ç”¨äºåœ¨ Python é¡¹ç›®ä¸­å¤„ç†å…³ç³»å‹æ•°æ®åº“çš„åœºæ™¯ï¼Œæ—¢æä¾›äº†é«˜çº§çš„ ORM åŠŸèƒ½ï¼Œåˆä¿ç•™äº†å¯¹åº•å±‚ SQL è¯­å¥çš„å¼ºå¤§æ§åˆ¶åŠ›ã€‚<code>SQLAlchemy</code>Â å…è®¸å¼€å‘è€…é€šè¿‡ Python ä»£ç ä¸æ•°æ®åº“è¿›è¡Œäº¤äº’ï¼Œè€Œæ— éœ€ç›´æ¥ç¼–å†™ SQL è¯­å¥ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒç›´æ¥ä½¿ç”¨åŸç”Ÿ SQL è¿›è¡Œå¤æ‚æŸ¥è¯¢ã€‚ä¸‹é¢æ˜¯<strong>SQLAlchemy</strong>å’Œæˆ‘ä»¬å¸¸è§„æ•°æ®åº“å¯¹è±¡çš„å¯¹åº”å…³ç³»è¯´æ˜ã€‚</p>
<p>Engine Â ã€€ã€€è¿æ¥å¯¹è±¡Â  Â  Â  Â  Â é©±åŠ¨å¼•æ“</p>
<p>Session ã€€ã€€è¿æ¥æ± Â  Â  Â  Â  Â  Â äº‹åŠ¡ Â ç”±æ­¤å¼€å§‹æŸ¥è¯¢</p>
<p>Model Â  ã€€ã€€è¡¨Â  Â  Â  Â  Â  Â  Â  Â  Â  Â ç±»å®šä¹‰</p>
<p>Column Â ã€€Â  åˆ— Â </p>
<p>Query Â  ã€€ã€€è‹¥å¹²è¡Œ Â  Â  Â  Â  å¯ä»¥é“¾å¼æ·»åŠ å¤šä¸ªæ¡ä»¶</p>
<p>åœ¨ä½¿ç”¨SQLAlchemyæ—¶ï¼Œé€šå¸¸ä¼šå°†å…¶ä¸æ•°æ®åº“å¯¹è±¡å¯¹åº”èµ·æ¥ã€‚</p>
<p><strong>SQLAlchemy</strong>: ä½¿ç”¨Â <code>Table</code>Â å¯¹è±¡æˆ–Â <code>Declarative Base</code>Â ä¸­çš„ç±»æ¥è¡¨ç¤ºã€‚</p>
<p><strong>å¯¹åº”å…³ç³»</strong>: æ•°æ®åº“ä¸­çš„æ¯ä¸€ä¸ªè¡¨å¯¹åº”äºSQLAlchemyä¸­çš„ä¸€ä¸ªç±»ï¼Œè¯¥ç±»ç»§æ‰¿è‡ªÂ <code>declarative_base()</code>ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">from sqlalchemy import Column, Integer, String, create_engine
from sqlalchemy.ext.declarative import declarative_base

<span class="hljs-attr">Base</span> = declarative_base()

class User(Base):
    <span class="hljs-attr">__tablename__</span> = <span class="hljs-string">'users'</span>  <span class="hljs-comment"># æ•°æ®åº“è¡¨å</span>
    <span class="hljs-attr">id</span> = Column(Integer, primary_key=<span class="hljs-literal">True</span>)
    <span class="hljs-attr">name</span> = Column(String)
    <span class="hljs-attr">email</span> = Column(String)
</code></pre>
<p><strong>æ•°æ®åº“åˆ— (Database Column)ï¼š</strong> ä½¿ç”¨Â <code>Column</code>Â å¯¹è±¡æ¥è¡¨ç¤ºã€‚æ¯ä¸ªæ•°æ®åº“è¡¨ä¸­çš„åˆ—åœ¨SQLAlchemyä¸­è¡¨ç¤ºä¸ºÂ <code>Column</code>Â å¯¹è±¡ï¼Œå¹¶ä½œä¸ºç±»çš„å±æ€§å®šä¹‰ã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">id</span> = Column(Integer, primary_key=<span class="hljs-literal">True</span>)
<span class="hljs-attr">name</span> = Column(String(<span class="hljs-number">50</span>))
</code></pre>
<p><strong>æ•°æ®åº“è¡Œ (Database Row)ï¼š</strong> æ¯ä¸ªæ•°æ®åº“è¡¨çš„ä¸€ä¸ªå®ä¾‹ï¼ˆå¯¹è±¡ï¼‰ä»£è¡¨æ•°æ®åº“è¡¨ä¸­çš„ä¸€è¡Œã€‚åœ¨SQLAlchemyä¸­ï¼Œé€šè¿‡å®ä¾‹åŒ–æ¨¡å‹ç±»æ¥è¡¨ç¤ºæ•°æ®åº“è¡¨ä¸­çš„ä¸€è¡Œã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">new_user</span> = User(id=<span class="hljs-number">1</span>, name=<span class="hljs-string">'John Doe'</span>, email=<span class="hljs-string">'john@example.com'</span>)
</code></pre>
<p><strong>ä¸»é”® (Primary Key)</strong> ï¼šä½¿ç”¨Â <code>primary_key=True</code>Â å‚æ•°å®šä¹‰ä¸»é”®ã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">id</span> = Column(Integer, primary_key=<span class="hljs-literal">True</span>)
</code></pre>
<p><strong>å¤–é”® (Foreign Key):</strong> ä½¿ç”¨Â <code>ForeignKey</code>Â å¯¹è±¡æ¥è¡¨ç¤ºã€‚</p>
<pre><code class="hljs language-ini" lang="ini">from sqlalchemy import ForeignKey
from sqlalchemy.orm import relationship

class Address(Base):
    <span class="hljs-attr">__tablename__</span> = <span class="hljs-string">'addresses'</span>
    <span class="hljs-attr">id</span> = Column(Integer, primary_key=<span class="hljs-literal">True</span>)
    <span class="hljs-attr">user_id</span> = Column(Integer, ForeignKey(<span class="hljs-string">'users.id'</span>))
    <span class="hljs-attr">user</span> = relationship(<span class="hljs-string">'User'</span>)
</code></pre>
<p><strong>å…³ç³» (Relationships):</strong> ä½¿ç”¨Â <code>relationship</code>Â å¯¹è±¡æ¥è¡¨ç¤ºã€‚æ•°æ®åº“ä¸­è¡¨ä¸è¡¨ä¹‹é—´çš„å…³ç³»åœ¨SQLAlchemyä¸­é€šè¿‡Â <code>relationship</code>Â æ¥å®šä¹‰ã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">addresses</span> = relationship(<span class="hljs-string">"Address"</span>, back_populates=<span class="hljs-string">"user"</span>)
</code></pre>
<h3 data-id="heading-1">2ã€å¸¸è§„çš„å•è¡¨å¤„ç†</h3>
<p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡å¼‚æ­¥å¤„ç†çš„æ–¹å¼ï¼Œä»‹ç»å¦‚ä½•åœ¨å•è¡¨ä¸­æ“ä½œç›¸å…³çš„æ•°æ®åº“æ•°æ®ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">self, db: AsyncSession, <span class="hljs-built_in">id</span>: <span class="hljs-type">Any</span></span>) -&gt; <span class="hljs-type">Any</span>:
    <span class="hljs-string">"""æ ¹æ®ä¸»é”®è·å–ä¸€ä¸ªå¯¹è±¡"""</span>

    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(<span class="hljs-built_in">id</span>, <span class="hljs-built_in">str</span>):
        query = select(self.model).<span class="hljs-built_in">filter</span>(func.lower(self.model.<span class="hljs-built_in">id</span>) == <span class="hljs-built_in">id</span>.lower())
    <span class="hljs-keyword">else</span>:
        query = select(self.model).<span class="hljs-built_in">filter</span>(self.model.<span class="hljs-built_in">id</span> == <span class="hljs-built_in">id</span>)

    result = <span class="hljs-keyword">await</span> db.execute(query)
    item = result.scalars().first()

    <span class="hljs-keyword">return</span> item
</code></pre>
<p>å¦‚æœæˆ‘ä»¬éœ€è¦å¼ºåˆ¶å¯¹å¤–é”®çš„ç±»å‹è¿›è¡ŒåŒ¹é…ï¼ˆå¦‚å¯¹äºPostgresqlçš„ä¸¥æ ¼è¦æ±‚ï¼Œæ•°æ®æ¯”è¾ƒçš„ç±»å‹å¿…é¡»ä¸€è‡´ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦åœ¨åŸºç±»æˆ–è€…CRUDç±»åˆå§‹åŒ–çš„æ—¶å€™ï¼Œè·å¾—å¯¹åº”çš„ä¸»é”®ç±»å‹ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BaseCrud</span>(<span class="hljs-type">Generic</span>[ModelType, PrimaryKeyType, PageDtoType, DtoType]):
    <span class="hljs-string">"""
    åŸºç¡€CRUDæ“ä½œç±»ï¼Œä¼ å…¥å‚æ•°è¯´æ˜ï¼š
    * `ModelType`: SQLAlchemy æ¨¡å‹ç±»
    * `PrimaryKeyType`: é™å®šä¸»é”®çš„ç±»å‹
    * `PageDtoType`: åˆ†é¡µæŸ¥è¯¢è¾“å…¥ç±»
    * `DtoType`: æ•°æ®ä¼ è¾“å¯¹è±¡ç±»ï¼Œå¦‚æ–°å¢ã€æ›´æ–°çš„å•ä¸ªå¯¹è±¡DTO
    """</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, model: <span class="hljs-type">Type</span>[ModelType]</span>):
        <span class="hljs-string">"""
        æ•°æ®åº“è®¿é—®æ“ä½œçš„åŸºç±»å¯¹è±¡(CRUD).
        * `model`: A SQLAlchemy model class
        """</span>
        
        self.model = model  <span class="hljs-comment"># æ¨¡å‹ç±»å‹</span>

        <span class="hljs-comment"># è¿è¡ŒæœŸè·å–ä¸»é”®å­—æ®µç±»å‹</span>
        pk_column = inspect(model).primary_key[<span class="hljs-number">0</span>]
        self._pk_type = pk_column.<span class="hljs-built_in">type</span>.python_type  <span class="hljs-comment"># int / str</span>
</code></pre>
<p>å› æ­¤å¯¹äºå•è¡¨çš„Getæ–¹æ³•ï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸‹ï¼Œè®©ä»–åŒ¹é…ä¸»é”®çš„ç±»å‹è¿›è¡Œæ¯”è¾ƒï¼Œè¿™æ ·è¿‡å¯¹äºä¸¥æ ¼ç±»å‹åˆ¤æ–­çš„Postgresqlä¹Ÿæ­£å¸¸åŒ¹é…äº†ã€‚</p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">self, db: AsyncSession, <span class="hljs-built_in">id</span>: PrimaryKeyType</span>) -&gt; <span class="hljs-type">Optional</span>[ModelType]:
        <span class="hljs-string">"""æ ¹æ®ä¸»é”®è·å–ä¸€ä¸ªå¯¹è±¡"""</span>
        
        <span class="hljs-comment">#å¯¹idçš„ä¸»é”®è¿›è¡Œç±»å‹è½¬æ¢ï¼Œself._pk_typeåœ¨æ„é€ å‡½æ•°çš„åˆå§‹åŒ–ä¸­è·å–</span>
        <span class="hljs-keyword">try</span>:
            <span class="hljs-built_in">id</span> = self._pk_type(<span class="hljs-built_in">id</span>)
        <span class="hljs-keyword">except</span> Exception:
            <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">f"Invalid primary key type: <span class="hljs-subst">{<span class="hljs-built_in">id</span>}</span>"</span>)
        
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(<span class="hljs-built_in">id</span>, <span class="hljs-built_in">str</span>):
            query = select(self.model).<span class="hljs-built_in">filter</span>(func.lower(self.model.<span class="hljs-built_in">id</span>) == <span class="hljs-built_in">id</span>.lower())
        <span class="hljs-keyword">else</span>:
            query = select(self.model).<span class="hljs-built_in">filter</span>(self.model.<span class="hljs-built_in">id</span> == <span class="hljs-built_in">id</span>)

        result = <span class="hljs-keyword">await</span> db.execute(query)
        item = result.scalars().first()

        <span class="hljs-keyword">return</span> item
</code></pre>
<p>å¯¹äºåˆ é™¤çš„æ•°æ®ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç±»ä¼¼çš„å¤„ç†å¯¹æ¯”è¿›è¡Œäº†ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> sqlalchemy.orm <span class="hljs-keyword">import</span> Session, Query
<span class="hljs-keyword">from</span> sqlalchemy.ext.asyncio <span class="hljs-keyword">import</span> AsyncSession
<span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> delete <span class="hljs-keyword">as</span> sa_delete, update <span class="hljs-keyword">as</span> sa_update

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">delete_byid</span>(<span class="hljs-params">self, db: AsyncSession, <span class="hljs-built_in">id</span>: PrimaryKeyType</span>) -&gt; <span class="hljs-built_in">bool</span>:
    <span class="hljs-string">"""æ ¹æ®ä¸»é”®åˆ é™¤ä¸€ä¸ªå¯¹è±¡
    
    :param id: ä¸»é”®å€¼
    """</span>
    
    <span class="hljs-comment">#å¯¹idçš„ä¸»é”®è¿›è¡Œç±»å‹è½¬æ¢ï¼Œself._pk_typeåœ¨æ„é€ å‡½æ•°çš„åˆå§‹åŒ–ä¸­è·å–</span>
    <span class="hljs-keyword">try</span>:
        <span class="hljs-built_in">id</span> = self._pk_type(<span class="hljs-built_in">id</span>)
    <span class="hljs-keyword">except</span> Exception:
        <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">f"Invalid primary key type: <span class="hljs-subst">{<span class="hljs-built_in">id</span>}</span>"</span>)
    
    del_query: sa_delete
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(<span class="hljs-built_in">id</span>, <span class="hljs-built_in">str</span>):
        del_query = sa_delete(self.model).where(
            func.lower(self.model.<span class="hljs-built_in">id</span>) == <span class="hljs-built_in">id</span>.lower()
        )
    <span class="hljs-keyword">else</span>:
        del_query = sa_delete(self.model).where(self.model.<span class="hljs-built_in">id</span> == <span class="hljs-built_in">id</span>)

    result = <span class="hljs-keyword">await</span> db.execute(del_query)

    <span class="hljs-keyword">await</span> db.commit()
    <span class="hljs-keyword">return</span> result.rowcount &gt; <span class="hljs-number">0</span>
</code></pre>
<p>å¯¹äºæä¾›å¤šæ¡ä»¶çš„æŸ¥è¯¢æˆ–è€…è¿‡æ»¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong>where</strong>å‡½æ•°æˆ–è€…<strong>filter</strong>å‡½æ•°ï¼Œåœ¨ SQLAlchemy ä¸­ï¼Œ<code>select(...).where(...)</code>Â å’ŒÂ <code>select(...).filter(...)</code>Â éƒ½ç”¨äºæ„é€ æŸ¥è¯¢æ¡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºç­‰æ•ˆã€‚</p>
<pre><code class="hljs language-python" lang="python">query = select(self.model).where(self.model.<span class="hljs-built_in">id</span> == <span class="hljs-built_in">id</span>)

query = select(self.model).<span class="hljs-built_in">filter</span>(self.model.<span class="hljs-built_in">id</span> == <span class="hljs-built_in">id</span>)
</code></pre>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡sqlAlchemyçš„and_å’Œor_å‡½æ•°æ¥è¿›è¡Œç»„åˆå¤šä¸ªæ¡ä»¶ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">from</span> sqlalchemy import ( <span class="hljs-keyword">Table</span>,<span class="hljs-keyword">Column</span>,and_,or_,<span class="hljs-keyword">asc</span>,<span class="hljs-keyword">desc</span>,<span class="hljs-keyword">select</span>,func,<span class="hljs-keyword">distinct</span>,text, <span class="hljs-type">Integer</span>)

....
    <span class="hljs-keyword">match</span> expression:
        <span class="hljs-keyword">case</span> "and":
            query <span class="hljs-operator">=</span> await db.execute(
                <span class="hljs-keyword">select</span>(self.model)
                .<span class="hljs-keyword">filter</span>(and_(  <span class="hljs-operator">*</span> where_list)) 
                .order_by(<span class="hljs-operator">*</span>order_by_list)
            )
        <span class="hljs-keyword">case</span> "or":
            query <span class="hljs-operator">=</span> await db.execute(
                <span class="hljs-keyword">select</span>(self.model).<span class="hljs-keyword">filter</span>(or_(  <span class="hljs-operator">*</span>where_list)) .order_by(<span class="hljs-operator">*</span>order_by_list)
            )
</code></pre>
<p>Pythonçš„SqlAlchemyæä¾›Â InstrumentedAttribute å¯¹è±¡æ¥æ“ä½œå¤šä¸ªæ¡ä»¶ï¼Œå¦‚æˆ‘ä»¬å¯¹äºä¸€äº›å¤šæ¡ä»¶çš„å¤„ç†ï¼Œå¯ä»¥åˆ©ç”¨å®ƒæ¥ä¼ é€’å¤šä¸ªå‚æ•°ã€‚</p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_all_by_attributes</span>(<span class="hljs-params">
        self, db: AsyncSession, *attributes: InstrumentedAttribute, sorting: <span class="hljs-built_in">str</span> = <span class="hljs-string">""</span>
    </span>) -&gt; <span class="hljs-type">List</span>[ModelType] | <span class="hljs-literal">None</span>:
        <span class="hljs-string">"""æ ¹æ®åˆ—åç§°å’Œå€¼è·å–ç›¸å…³çš„å¯¹è±¡åˆ—è¡¨

        :param sorting: æ ¼å¼ï¼šname asc æˆ– name asc,age desc
        :param attributes: SQLAlchemy InstrumentedAttribute objectsï¼Œå¯ä»¥è¾“å…¥å¤šä¸ªæ¡ä»¶
        ä¾‹å­ï¼šUser.id != 1 æˆ–è€… User.username == "JohnDoe"
        """</span>

        order_by_list = parse_sort_string(sorting, self.model)
        query = select(self.model).<span class="hljs-built_in">filter</span>(and_(*attributes)).order_by(*order_by_list)
        
        result = <span class="hljs-keyword">await</span> db.execute(query)
        <span class="hljs-keyword">return</span> result.scalars().<span class="hljs-built_in">all</span>()
</code></pre>
<p>ä¾‹å¦‚ï¼Œå¯¹äº æ¨¡å‹Â Material å¯¹è±¡ï¼Œæˆ‘ä»¬å¯¹å®ƒè¿›è¡Œå¤šä¸ªæ¡ä»¶çš„æŸ¥è¯¢å¤„ç†ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œçº¢è‰²éƒ¨åˆ†ä¸º *attributes: InstrumentedAttribute å‚æ•°ã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">items</span> = await super().get_all_by_attributes(
    db,
 <span class="hljs-attr">Material.id</span> == vercol.id,
    <span class="hljs-attr">Material.vercol</span> == vercol.vercol,
    <span class="hljs-attr">Material.ischecked</span> == <span class="hljs-number">0</span>,
    <span class="hljs-attr">Material.status</span> == <span class="hljs-number">0</span>, 
)
</code></pre>
<p>åŒæ ·æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®ƒæ¥è·å–æ•°é‡ï¼Œæˆ–è€…åˆ¤æ–­å¤šæ¡ä»¶çš„è®°å½•æ˜¯å¦å­˜åœ¨ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/757682ba154a422caaa6813152a5e890~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LyN5Y2O6IGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767240347&amp;x-signature=TJaMmqNVSsmbwb%2FVQgrgL%2B05Ezk%3D" alt="image" loading="lazy"/></p>
<p>Â åœ¨æ•°æ®æ’å…¥æˆ–è€…æ›´æ–°çš„æ“ä½œä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ¥å—å¯¹è±¡ç±»å‹æˆ–è€…å­—å…¸ç±»å‹çš„å‚æ•°å¯¹è±¡ï¼Œå› æ­¤æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<pre><code class="hljs language-python" lang="python">   <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">self, db: AsyncSession, obj_in: DtoType | <span class="hljs-built_in">dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>]</span>) -&gt; <span class="hljs-built_in">bool</span>:
        <span class="hljs-string">"""æ›´æ–°å¯¹è±¡
        
        :param obj_in: å¯¹è±¡è¾“å…¥æ•°æ®,å¯ä»¥æ˜¯ DTO å¯¹è±¡æˆ–å­—å…¸
        """</span>
        <span class="hljs-keyword">try</span>:
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(obj_in, <span class="hljs-built_in">dict</span>):
                obj_id = obj_in.get(<span class="hljs-string">"id"</span>)
                <span class="hljs-keyword">if</span> obj_id <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
                    <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">"id is required for update"</span>)
                update_data = obj_in
            <span class="hljs-keyword">else</span>:
                obj_id = obj_in.<span class="hljs-built_in">id</span>
                <span class="hljs-comment"># update_data = vars(obj_in)  </span>
                update_data = obj_in.model_dump(exclude_unset=<span class="hljs-literal">True</span>)

            query = select(self.model).<span class="hljs-built_in">filter</span>(self.model.<span class="hljs-built_in">id</span> == obj_id)
            result = <span class="hljs-keyword">await</span> db.execute(query)
            db_obj = result.scalars().first()

            <span class="hljs-keyword">if</span> db_obj:
                <span class="hljs-comment"># æ›´æ–°å¯¹è±¡å­—æ®µ</span>
                <span class="hljs-keyword">for</span> field, value <span class="hljs-keyword">in</span> update_data.items():
                    <span class="hljs-comment"># è·³è¿‡ä»¥ "_" å¼€å¤´çš„ç§æœ‰å±æ€§</span>
                    <span class="hljs-keyword">if</span> field.startswith(<span class="hljs-string">"_"</span>):
                        <span class="hljs-keyword">continue</span>
                    <span class="hljs-built_in">setattr</span>(db_obj, field, value)

                <span class="hljs-comment"># å¤„ç†æ›´æ–°å‰çš„å›è°ƒå¤„ç†</span>
 self.on_before_update(update_data, db_obj) <span class="hljs-comment"># æäº¤äº‹åŠ¡</span>
                <span class="hljs-keyword">await</span> db.commit()
                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
            <span class="hljs-keyword">else</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
        <span class="hljs-keyword">except</span> SQLAlchemyError <span class="hljs-keyword">as</span> e:
            self.logger.error(<span class="hljs-string">f"update æ“ä½œå‡ºç°é”™è¯¯: <span class="hljs-subst">{e}</span>"</span>)
            <span class="hljs-keyword">await</span> db.rollback()  <span class="hljs-comment"># ç¡®ä¿åœ¨å‡ºé”™æ—¶å›æ»šäº‹åŠ¡</span>
            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
</code></pre>
<p>æˆ‘ä»¬åœ¨æ’å…¥æˆ–è€…æ›´æ–°æ•°æ®çš„æ—¶å€™ï¼Œä¸€èˆ¬ä¼šé»˜è®¤æ›´æ–°ä¸€äº›å­—æ®µï¼Œå¦‚åˆ›å»ºäººï¼Œåˆ›å»ºæ—¥æœŸã€ç¼–è¾‘äººï¼Œç¼–è¾‘æ—¥æœŸç­‰ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒå•ç‹¬ä½œä¸ºä¸€ä¸ªå¯ä»¥ç»™å­ç±»é‡å†™çš„å‡½æ•°ï¼ŒåŸºç±»åšä¸€äº›é»˜è®¤çš„å¤„ç†ã€‚</p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">on_before_update</span>(<span class="hljs-params">self, update_data: <span class="hljs-built_in">dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>], db_obj: ModelType</span>) -&gt; <span class="hljs-literal">None</span>:
        <span class="hljs-string">"""æ›´æ–°å¯¹è±¡å‰çš„å›è°ƒå‡½æ•°ï¼Œå­ç±»å¯ä»¥é‡å†™æ­¤æ–¹æ³•

        å¯é€šè¿‡ setattr(db_obj, field, value) è®¾ç½®å­—æ®µå€¼
        """</span>
        
        <span class="hljs-built_in">setattr</span>(db_obj, <span class="hljs-string">"edittime"</span>, datetime.now())
        user :CurrentUserIns  = get_current_user()
        <span class="hljs-keyword">if</span> user:
            <span class="hljs-built_in">setattr</span>(db_obj, <span class="hljs-string">"editor"</span>, user.fullname)
            <span class="hljs-built_in">setattr</span>(db_obj, <span class="hljs-string">"editor_id"</span>, user.<span class="hljs-built_in">id</span>)

            <span class="hljs-built_in">setattr</span>(db_obj, <span class="hljs-string">"company_id"</span>, user.company_id)
            <span class="hljs-built_in">setattr</span>(db_obj, <span class="hljs-string">"companyname"</span>, user.companyname)
</code></pre>
<p>æœ‰æ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦è·å–æŸä¸ªå­—æ®µéé‡å¤çš„åˆ—è¡¨ï¼Œç”¨æ¥åšä¸ºåŠ¨æ€ä¸‹æ‹‰åˆ—è¡¨çš„æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢å‡½æ•°å°è£…ä¸‹ã€‚</p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_field_list</span>(<span class="hljs-params">self, db: AsyncSession, field_name: <span class="hljs-built_in">str</span></span>) -&gt; Iterable[<span class="hljs-built_in">str</span>]:
        <span class="hljs-string">"""è·å–æŒ‡å®šå­—æ®µå€¼çš„å”¯ä¸€åˆ—è¡¨

        :param field_name: å­—æ®µåç§°
        """</span>

        field = <span class="hljs-built_in">getattr</span>(self.model, field_name)
        query = select(distinct(field))
        result = <span class="hljs-keyword">await</span> db.execute(query)
        <span class="hljs-keyword">return</span> result.scalars().<span class="hljs-built_in">all</span>()
</code></pre>
<h3 data-id="heading-2">3ã€å¤šè¡¨è”åˆçš„å¤„ç†æ“ä½œÂ </h3>
<p>å¤šè¡¨æ“ä½œï¼Œä¹Ÿæ˜¯æˆ‘ä»¬ç»å¸¸ç¢°åˆ°çš„å¤„ç†æ–¹å¼ï¼Œå¦‚å¯¹äºå­—å…¸ç±»å‹å’Œå­—å…¸é¡¹ç›®ï¼Œä»–ä»¬æ˜¯ä¸¤ä¸ªè¡¨ï¼Œéœ€è¦è”åˆèµ·æ¥è·å–æ•°æ®ï¼Œé‚£ä¹ˆå°±éœ€è¦å¤šè¡¨çš„è”åˆæ“ä½œã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fcde1deeeecb42ee9bf077f276e466df~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LyN5Y2O6IGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767240347&amp;x-signature=gqBb0Bk5oM2cfSPVZPjahlYledk%3D" alt="image" loading="lazy"/></p>
<p>Â å¦‚ä¸‹æ˜¯å­—å…¸CRUDç±»ä¸­ï¼Œè”åˆå­—å…¸ç±»å‹è·å–æ•°æ®çš„è®°å½•å¤„ç†ã€‚</p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_dict_by_typename</span>(<span class="hljs-params">self, db: AsyncSession, dicttype_name: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">dict</span>:
        <span class="hljs-string">"""æ ¹æ®å­—å…¸ç±»å‹åç§°è·å–æ‰€æœ‰è¯¥ç±»å‹çš„å­—å…¸åˆ—è¡¨é›†åˆ"""</span>
        result = <span class="hljs-keyword">await</span> db.execute(
            select(self.model)
             .join(DictType, DictType.<span class="hljs-built_in">id</span> == self.model.dicttype_id)   <span class="hljs-comment"># å…³è”å­—å…¸ç±»å‹è¡¨</span>
            .<span class="hljs-built_in">filter</span>(DictType.name == dicttype_name) <span class="hljs-comment"># è¿‡æ»¤å­—å…¸ç±»å‹åç§°</span>
            .order_by(DictData.seq)  <span class="hljs-comment"># æ’åº</span>
        )
        items = result.scalars().<span class="hljs-built_in">all</span>()

        <span class="hljs-built_in">dict</span> = {}
        <span class="hljs-keyword">for</span> info <span class="hljs-keyword">in</span> items:
            <span class="hljs-keyword">if</span> info.name <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">dict</span>:
                <span class="hljs-built_in">dict</span>[info.name] = info.value

        <span class="hljs-keyword">return</span> <span class="hljs-built_in">dict</span>
</code></pre>
<p>å¦‚æœæˆ‘ä»¬éœ€è¦å¯¹æŸä¸ªè¡¨çš„é€’å½’è·å–æ ‘åˆ—è¡¨ï¼Œå¯ä»¥å¦‚ä¸‹å¤„ç†</p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_tree</span>(<span class="hljs-params">self, db: AsyncSession, pid: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">list</span>[DictType]:
        <span class="hljs-string">"""è·å–å­—å…¸ç±»å‹ä¸€çº§åˆ—è¡¨åŠå…¶ä¸‹é¢çš„å†…å®¹"""</span>

        <span class="hljs-comment"># ä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦å°† pid è®¾ä¸º "-1"ï¼ˆå¦‚æœ pid æ˜¯ null æˆ–ç©ºç™½ï¼‰æˆ–ä¿æŒåŸå€¼</span>
        pid = <span class="hljs-string">"-1"</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> pid <span class="hljs-keyword">or</span> pid.strip() == <span class="hljs-string">""</span> <span class="hljs-keyword">else</span> pid
        result = <span class="hljs-keyword">await</span> db.execute(
            select(self.model)
            .<span class="hljs-built_in">filter</span>(self.model.pid == pid)
            .options(selectinload(DictType.children))
        )
        nodes = result.scalars().<span class="hljs-built_in">all</span>()
        <span class="hljs-keyword">return</span> nodes
</code></pre>
<p>æˆ‘ä»¬æ¥å‡è®¾ç”¨æˆ·å’Œæ–‡ç« çš„ç¤ºä¾‹è¡¨ç»“æ„ï¼ˆORM æ¨¡å‹ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<pre><code class="hljs language-ini" lang="ini">class User(Base):
    <span class="hljs-attr">__tablename__</span> = <span class="hljs-string">"users"</span>
    <span class="hljs-attr">id</span> = Column(Integer, primary_key=<span class="hljs-literal">True</span>, index=<span class="hljs-literal">True</span>)
    <span class="hljs-attr">name</span> = Column(String)
    <span class="hljs-attr">email</span> = Column(String)
    <span class="hljs-attr">articles</span> = relationship(<span class="hljs-string">"Article"</span>, back_populates=<span class="hljs-string">"author"</span>)


class Article(Base):
    <span class="hljs-attr">__tablename__</span> = <span class="hljs-string">"articles"</span>
    <span class="hljs-attr">id</span> = Column(Integer, primary_key=<span class="hljs-literal">True</span>, index=<span class="hljs-literal">True</span>)
    <span class="hljs-attr">title</span> = Column(String)
    <span class="hljs-attr">content</span> = Column(Text)
    <span class="hljs-attr">user_id</span> = Column(Integer, ForeignKey(<span class="hljs-string">"users.id"</span>))
    <span class="hljs-attr">author</span> = relationship(<span class="hljs-string">"User"</span>, back_populates=<span class="hljs-string">"articles"</span>)
</code></pre>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢å‡½æ•°å¤„ç†è·å¾—ç›¸å…³çš„è®°å½•é›†åˆã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_user_articles</span>(<span class="hljs-params">db: AsyncSession</span>):
    stmt = (
        select(User, Article)
        .join(Article, Article.user_id == User.<span class="hljs-built_in">id</span>)
    )
    result = <span class="hljs-keyword">await</span> db.execute(stmt)
    <span class="hljs-keyword">return</span> result.<span class="hljs-built_in">all</span>()   <span class="hljs-comment"># [ (User(), Article()), . ..]</span>
</code></pre>
<p>å¦‚æœéœ€è¦å¯ä»¥ä½¿ç”¨outer_joinå‡½æ•°å¤„ç†</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_users_with_articles</span>(<span class="hljs-params">db: AsyncSession</span>):
    stmt = (
        select(User, Article)
        .outerjoin(Article, Article.user_id == User.<span class="hljs-built_in">id</span>)
    )
    result = <span class="hljs-keyword">await</span> db.execute(stmt)
    <span class="hljs-keyword">return</span> result.<span class="hljs-built_in">all</span>()  <span class="hljs-comment"># ç”¨æˆ·å³ä¾¿æ²¡æœ‰æ–‡ç« ä¹Ÿä¼šå‡ºç°</span>
</code></pre>
<p>å¦‚æœæˆ‘ä»¬éœ€è¦è·å–æœ‰æ–‡ç« çš„æ‰€æœ‰ç”¨æˆ·ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<pre><code class="hljs language-scss" lang="scss">async def <span class="hljs-built_in">get_users_with_articles</span>(db: AsyncSession):
    stmt = <span class="hljs-built_in">select</span>(User).<span class="hljs-built_in">options</span>(<span class="hljs-built_in">selectinload</span>(User.articles))  # è‡ªåŠ¨ load å…³è”
    result = await db.<span class="hljs-built_in">execute</span>(stmt)
    return result.<span class="hljs-built_in">scalars</span>().<span class="hljs-built_in">all</span>()
</code></pre>
<p><code>selectinload</code>Â ä¼šæ‰§è¡Œä¸¤æ¬¡ SQLï¼Œä½†æ•ˆç‡é«˜ï¼Œä¸ä¼šäº§ç”Ÿç¬›å¡å°”ç§¯ï¼Œéå¸¸é€‚åˆé›†åˆæŸ¥è¯¢ã€‚</p>
<p>å¤šè¡¨é“¾å¼ Joinçš„å¤„ç†ï¼Œå¯ä»¥è·å¾—ä¸¤ä¸ªè¡¨çš„ä¸åŒä¿¡æ¯è¿›è¡Œç»„åˆã€‚</p>
<pre><code class="hljs language-css" lang="css">async def get_articles_with_author(db: AsyncSession):
    stmt = (
        <span class="hljs-built_in">select</span>(Article.title, User.name.<span class="hljs-built_in">label</span>(<span class="hljs-string">"author"</span>))
        .<span class="hljs-built_in">join</span>(User, Article.user_id == User.id)
    )
    rows = await db.<span class="hljs-built_in">execute</span>(stmt)
    return rows.<span class="hljs-built_in">mappings</span>().<span class="hljs-built_in">all</span>()   # ä»¥ dict å½¢å¼è¿”å› [{'title':..., <span class="hljs-string">'author'</span>:...}]
</code></pre>
<p>å¸¦ç­›é€‰æ¡ä»¶ä¸åˆ†é¡µçš„å¤„ç†å®ç°ï¼Œå¦‚ä¸‹æ‰€ç¤º</p>
<pre><code class="hljs language-scss" lang="scss">async def <span class="hljs-built_in">search_articles</span>(db: AsyncSession, keyword: str, page: int = <span class="hljs-number">1</span>, size: int = <span class="hljs-number">10</span>):
    stmt = (
        <span class="hljs-built_in">select</span>(Article, User.name.<span class="hljs-built_in">label</span>(<span class="hljs-string">"author"</span>))
        .<span class="hljs-built_in">join</span>(User)
        .<span class="hljs-built_in">filter</span>(Article.title.<span class="hljs-built_in">contains</span>(keyword))
        .<span class="hljs-built_in">offset</span>((page - <span class="hljs-number">1</span>) * size)
        .<span class="hljs-built_in">limit</span>(size)
    )
    result = await db.<span class="hljs-built_in">execute</span>(stmt)
    return result.<span class="hljs-built_in">mappings</span>().<span class="hljs-built_in">all</span>()
</code></pre>
<p>Â 
å¯¹äºæƒé™ç®¡ç†ç³»ç»Ÿæ¥è¯´ï¼Œä¸€èˆ¬æœ‰ç”¨æˆ·ã€è§’è‰²ï¼Œä»¥åŠç”¨æˆ·è§’è‰²çš„ä¸­é—´è¡¨ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªåœ¨SQLAlchemyæœ€ä½³å®è·µæ˜¯å¦‚ä½•çš„æ“ä½œã€‚</p>
<pre><code class="hljs language-ini" lang="ini">from sqlalchemy import Table, Column, Integer, ForeignKey
from sqlalchemy.orm import relationship, Mapped, mapped_column
from database import Base

<span class="hljs-comment"># --- ä¸­é—´è¡¨å†™æ³• ---</span>
<span class="hljs-attr">role_user</span> = Table(
    "role_user",
    Base.metadata,
    Column("user_id", ForeignKey("users.id"), <span class="hljs-attr">primary_key</span>=<span class="hljs-literal">True</span>),
    Column("role_id", ForeignKey("roles.id"), <span class="hljs-attr">primary_key</span>=<span class="hljs-literal">True</span>)
)

class User(Base):
    <span class="hljs-attr">__tablename__</span> = <span class="hljs-string">"users"</span>
    id: Mapped<span class="hljs-section">[int]</span> = mapped_column(<span class="hljs-attr">primary_key</span>=<span class="hljs-literal">True</span>)
    username: Mapped<span class="hljs-section">[str]</span> = mapped_column()

    roles: Mapped<span class="hljs-section">[list["Role"]]</span> = relationship(
        <span class="hljs-attr">secondary</span>=role_user,
        <span class="hljs-attr">back_populates</span>=<span class="hljs-string">"users"</span>,
        <span class="hljs-attr">lazy</span>=<span class="hljs-string">"selectin"</span>
    )

class Role(Base):
    <span class="hljs-attr">__tablename__</span> = <span class="hljs-string">"roles"</span>
    id: Mapped<span class="hljs-section">[int]</span> = mapped_column(<span class="hljs-attr">primary_key</span>=<span class="hljs-literal">True</span>)
    name: Mapped<span class="hljs-section">[str]</span> = mapped_column()

    users: Mapped<span class="hljs-section">[list[User]]</span> = relationship(
        <span class="hljs-attr">secondary</span>=role_user,
        <span class="hljs-attr">back_populates</span>=<span class="hljs-string">"roles"</span>,
        <span class="hljs-attr">lazy</span>=<span class="hljs-string">"selectin"</span>
    )
</code></pre>
<p>åœ¨ SQLAlchemy å£°æ˜å¤šå¯¹å¤šå…³ç³»æ—¶ï¼Œ<code>secondary</code>Â å‚æ•°æ—¢å¯ä»¥å¡«Â <strong>å­—ç¬¦ä¸²å½¢å¼çš„è¡¨å</strong>ï¼Œä¹Ÿå¯ä»¥å¡«Â <strong>å·²ç»å®šä¹‰å¥½çš„ä¸­é—´è¡¨å¯¹è±¡ï¼ˆTable å¯¹è±¡ï¼‰ã€‚</strong></p>
<p><strong>â‘  econdary="role_user" â€”â€” ä½¿ç”¨å­—ç¬¦ä¸²è¡¨å</strong></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">roles</span> = relationship(<span class="hljs-string">"Role"</span>, secondary=<span class="hljs-string">"role_user"</span>, back_populates=<span class="hljs-string">"users"</span>)
</code></pre>
<p><strong>â‘¡ secondary=role_user â€”â€” ä¼ å…¥ä¸­é—´è¡¨å¯¹è±¡ï¼ˆæ¨èæ–¹å¼ï¼‰</strong></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">role_user</span> = Table(
    "role_user",
    Base.metadata,
    Column("user_id", ForeignKey("users.id"), <span class="hljs-attr">primary_key</span>=<span class="hljs-literal">True</span>),
    Column("role_id", ForeignKey("roles.id"), <span class="hljs-attr">primary_key</span>=<span class="hljs-literal">True</span>)
)

<span class="hljs-attr">roles</span> = relationship(<span class="hljs-string">"Role"</span>, secondary=role_user, back_populates=<span class="hljs-string">"users"</span>)
</code></pre>
<p>å¯¹äºå¦‚æœè·å–å¯¹åº”è§’è‰²çš„ç”¨æˆ·è®°å½•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢æ–¹å¼è·å–ï¼ˆé€šè¿‡è¿æ¥ä¸­é—´è¡¨çš„æ–¹å¼ï¼‰</p>
<pre><code class="hljs language-ini" lang="ini">async def get_users_by_role(db: AsyncSession, role_id: int) -&gt; list<span class="hljs-section">[User]</span>:
    <span class="hljs-attr">stmt</span> = (
        select(User)
        .join(role_user, <span class="hljs-attr">role_user.c.user_id</span> == User.id)
        .where(<span class="hljs-attr">role_user.c.role_id</span> == role_id)
    )
    <span class="hljs-attr">result</span> = await db.execute(stmt)
    return result.scalars().all()
</code></pre>
<p>ä¹Ÿå¯ä»¥ä¸‹é¢çš„æ–¹å¼è¿›è¡Œå¤„ç†ï¼ˆä½¿ç”¨ relationship any()ï¼‰ï¼Œæ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚</p>
<pre><code class="hljs language-python" lang="python">select(User).<span class="hljs-built_in">filter</span>(User.roles.<span class="hljs-built_in">any</span>(<span class="hljs-built_in">id</span>=role_id))
</code></pre>
<p>å¦‚æœéœ€è¦å†™å…¥ç”¨æˆ·ã€è§’è‰²çš„å…³è”å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢æ–¹æ³•æ¥é€šè¿‡ä¸­é—´è¡¨è¿›è¡Œåˆ¤æ–­å¹¶å†™å…¥è®°å½•ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">from sqlalchemy import select, insert

async def add_users_to_role(db: AsyncSession, role_id: int, user_ids: list<span class="hljs-section">[int]</span>):
    <span class="hljs-comment"># 1ï¸âƒ£ æŸ¥è¯¢å·²æœ‰å…³è” user_id</span>
    <span class="hljs-attr">stmt</span> = select(role_user.c.user_id).where(role_user.c.role_id == role_id)
    <span class="hljs-attr">res</span> = await db.execute(stmt)
    <span class="hljs-attr">existing_user_ids</span> = {row[<span class="hljs-number">0</span>] for row in res.fetchall()}

    <span class="hljs-comment"># 2ï¸âƒ£ è¿‡æ»¤å‡ºæ–°çš„ user_id</span>
    <span class="hljs-attr">new_user_ids</span> = [uid for uid in user_ids if uid not in existing_user_ids]
    if not new_user_ids:
        return 0  <span class="hljs-comment"># æ²¡æœ‰æ–°å¢</span>

    <span class="hljs-comment"># 3ï¸âƒ£ æ‰¹é‡æ’å…¥</span>
    <span class="hljs-attr">values</span> = [{<span class="hljs-string">"user_id"</span>: uid, <span class="hljs-string">"role_id"</span>: role_id} for uid in new_user_ids]
    <span class="hljs-attr">stmt</span> = insert(role_user).values(values)
    await db.execute(stmt)
    await db.commit()

    return len(new_user_ids)
</code></pre>
<p>å¦‚æœåªæ˜¯å•ä¸ªè®°å½•çš„æ’å…¥ï¼Œå¯ä»¥åˆ©ç”¨ä¸‹é¢çš„æ–¹å¼å¤„ç†ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> select, insert

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_user_to_role</span>(<span class="hljs-params">db: AsyncSession, role_id: <span class="hljs-built_in">int</span>, user_id: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">bool</span>:
    <span class="hljs-comment"># 1ï¸âƒ£ æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨å…³è”</span>
    stmt = select(role_user).where(
        role_user.c.role_id == role_id,
        role_user.c.user_id == user_id
    )
    res = <span class="hljs-keyword">await</span> db.execute(stmt)
    exists = res.first()

    <span class="hljs-keyword">if</span> exists:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>  <span class="hljs-comment"># å·²å­˜åœ¨ï¼Œä¸å†æ’å…¥</span>

    <span class="hljs-comment"># 2ï¸âƒ£ æ’å…¥è®°å½•</span>
    stmt = insert(role_user).values(user_id=user_id, role_id=role_id)
    <span class="hljs-keyword">await</span> db.execute(stmt)
    <span class="hljs-keyword">await</span> db.commit()

    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
</code></pre>
<p>ä»¥ä¸Šå°±æ˜¯å¯¹äºåœ¨Python+FastAPIçš„åç«¯é¡¹ç›®ä¸­ä½¿ç”¨SqlAlchemyæ“ä½œæ•°æ®çš„å‡ ç§å¸¸è§æ–¹å¼ï¼ŒåŒ…æ‹¬å•è¡¨å¤„ç†ï¼Œå¤šè¡¨å…³è”ã€ä¸­é—´è¡¨çš„æ•°æ®ç»´æŠ¤å’Œå®šä¹‰ç­‰å†…å®¹ï¼Œæ˜¯æˆ‘ä»¬åœ¨æ“ä½œå¸¸è§„æ•°æ®çš„æ—¶å€™ï¼Œç»å¸¸ç¢°åˆ°çš„å‡ ç§æ–¹å¼ã€‚</p>
<p>å¸Œæœ›ä¸Šæ–‡å¯¹ä½ æœ‰æ‰€å¯å‘å’Œå¸®åŠ©ï¼Œæ„Ÿè°¢é˜…è¯»ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥ç†è§£ JavaScript å¼‚æ­¥æœºåˆ¶ï¼šä»å›è°ƒåˆ° Promise å†åˆ° async/await]]></title>    <link>https://juejin.cn/post/7587825267879231529</link>    <guid>https://juejin.cn/post/7587825267879231529</guid>    <pubDate>2025-12-26T08:40:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587825267879231529" data-draft-id="7584266920641429555" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥ç†è§£ JavaScript å¼‚æ­¥æœºåˆ¶ï¼šä»å›è°ƒåˆ° Promise å†åˆ° async/await"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-26T08:40:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ•²ä»£ç çš„ç‹¬è§’å…½"/> <meta itemprop="url" content="https://juejin.cn/user/729731452897246"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥ç†è§£ JavaScript å¼‚æ­¥æœºåˆ¶ï¼šä»å›è°ƒåˆ° Promise å†åˆ° async/await
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/729731452897246/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ•²ä»£ç çš„ç‹¬è§’å…½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T08:40:25.000Z" title="Fri Dec 26 2025 08:40:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ·±å…¥ç†è§£ JavaScript å¼‚æ­¥æœºåˆ¶ï¼šä»å›è°ƒåˆ° Promise å†åˆ° async/await</h2>
<p>ä½œä¸ºå‰ç«¯å¼€å‘è€…ï¼Œä½ æ˜¯å¦æ›¾åœ¨å¤„ç†ç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶è¯»å–æˆ–å®šæ—¶ä»»åŠ¡æ—¶ï¼Œè¢«å±‚å±‚åµŒå¥—çš„å›è°ƒå‡½æ•°å¼„å¾—å¤´æ™•ç›®çœ©ï¼Ÿå½“ä¸šåŠ¡é€»è¾‘é€æ¸å¤æ‚ï¼Œä»£ç å´é™·å…¥"é‡‘å­—å¡”é™·é˜±"ï¼Œé”™è¯¯å¤„ç†æ”¯ç¦»ç ´ç¢ï¼Œå¯ç»´æŠ¤æ€§æ€¥å‰§ä¸‹é™ã€‚æœ¬æ–‡å°†å¸¦ä½ ç³»ç»Ÿæ¢³ç† JavaScript å¼‚æ­¥æ¼”è¿›ä¹‹è·¯ï¼Œä»å›è°ƒåœ°ç‹±åˆ°ä¼˜é›…çš„ async/awaitï¼Œç»“åˆåº•å±‚æœºåˆ¶ä¸å®æˆ˜åœºæ™¯ï¼ŒåŠ©ä½ å†™å‡ºå¥å£®é«˜æ•ˆçš„å¼‚æ­¥ä»£ç ã€‚</p>
<hr/>
<h3 data-id="heading-1">ä¸€ã€å›è°ƒå‡½æ•°ï¼šæœ€åˆçš„è§£å†³æ–¹æ¡ˆä¸å®ƒçš„å±€é™</h3>
<p>JavaScript ä½œä¸ºå•çº¿ç¨‹è¯­è¨€ï¼Œé€šè¿‡å›è°ƒå‡½æ•°å®ç°éé˜»å¡ I/Oã€‚çœ‹ä¼¼ç®€å•ï¼Œå´æš—è—é™·é˜±ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// ä¼ ç»Ÿå›è°ƒç¤ºä¾‹ï¼šè·å–ç”¨æˆ·ä¿¡æ¯åŠå…¶è®¢å•</span>
<span class="hljs-title function_">getUser</span>(userId, <span class="hljs-keyword">function</span>(<span class="hljs-params">user</span>) {
  <span class="hljs-title function_">getOrders</span>(user, <span class="hljs-keyword">function</span>(<span class="hljs-params">orders</span>) {
    <span class="hljs-title function_">calculateTotal</span>(orders, <span class="hljs-keyword">function</span>(<span class="hljs-params">total</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ç”¨æˆ· <span class="hljs-subst">${user.name}</span> çš„è®¢å•æ€»é¢: $<span class="hljs-subst">${total}</span>`</span>);
    });
  });
});

<span class="hljs-comment">// é”™è¯¯å¤„ç†å›°å¢ƒ</span>
fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">'config.json'</span>, <span class="hljs-string">'utf8'</span>, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (err) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è¯»å–é…ç½®å¤±è´¥:'</span>, err);
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> config = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(data);
    <span class="hljs-comment">// ...åç»­æ“ä½œ</span>
  } <span class="hljs-keyword">catch</span> (parseError) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è§£æé…ç½®å¤±è´¥:'</span>, parseError);
  }
});
</code></pre>
<p><strong>æ ¸å¿ƒç—›ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>å›è°ƒåœ°ç‹±</strong>ï¼šåµŒå¥—å±‚çº§éšä¸šåŠ¡å¤æ‚åº¦æŒ‡æ•°çº§å¢é•¿</li>
<li><strong>é”™è¯¯å¤„ç†ç¢ç‰‡åŒ–</strong>ï¼šæ¯ä¸ªå›è°ƒéœ€å•ç‹¬å¤„ç†é”™è¯¯</li>
<li><strong>æ§åˆ¶æµæ–­è£‚</strong>ï¼šæ— æ³•ä½¿ç”¨ <code>return</code>ã€<code>try/catch</code> ç­‰åŒæ­¥æ§åˆ¶ç»“æ„</li>
<li><strong>å¯ç»„åˆæ€§å·®</strong>ï¼šéš¾ä»¥å®ç°å¹¶è¡Œ/ç«äº‰ç­‰å¤æ‚å¼‚æ­¥æ¨¡å¼</li>
</ul>
<blockquote>
<p>æŸç”µå•†å¹³å°æ›¾å›  7 å±‚å›è°ƒåµŒå¥—å¯¼è‡´å…³é”®æ”¯ä»˜é€»è¾‘ç»´æŠ¤å¤±è´¥ï¼Œæœ€ç»ˆå¼•å‘èµ„é‡‘æŸå¤±ã€‚å›è°ƒæ¨¡å¼åœ¨å°å‹é¡¹ç›®å°šå¯åº”ä»˜ï¼Œä½†å½“ä¸šåŠ¡è§„æ¨¡æ‰©å¤§æ—¶ï¼Œå…¶ç¼ºé™·ä¼šæˆä¸ºç³»ç»Ÿæ€§é£é™©ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-2">äºŒã€Promiseï¼šå¼‚æ­¥æµç¨‹çš„é©å‘½æ€§é‡æ„</h3>
<p>Promise é€šè¿‡çŠ¶æ€æœºï¼ˆpending/fulfilled/rejectedï¼‰å’Œé“¾å¼è°ƒç”¨ï¼Œå½»åº•æ”¹å˜å¼‚æ­¥ä»£ç ç»„ç»‡æ–¹å¼ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// Promise å°è£…å¼‚æ­¥æ“ä½œ</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">fetchUser</span> = (<span class="hljs-params">userId</span>) =&gt; 
  <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-comment">// æ¨¡æ‹Ÿ API è¯·æ±‚</span>
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (userId &gt; <span class="hljs-number">0</span>) <span class="hljs-title function_">resolve</span>({ <span class="hljs-attr">id</span>: userId, <span class="hljs-attr">name</span>: <span class="hljs-string">'Alex'</span> });
      <span class="hljs-keyword">else</span> <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'æ— æ•ˆç”¨æˆ·ID'</span>));
    }, <span class="hljs-number">1000</span>);
  });

<span class="hljs-comment">// é“¾å¼è°ƒç”¨ä¸ç»Ÿä¸€é”™è¯¯å¤„ç†</span>
<span class="hljs-title function_">fetchUser</span>(<span class="hljs-number">123</span>)
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">user</span> =&gt;</span> <span class="hljs-title function_">fetchOrders</span>(user))
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">orders</span> =&gt;</span> <span class="hljs-title function_">calculateTotal</span>(orders))
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">total</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`è®¢å•æ€»é¢: $<span class="hljs-subst">${total}</span>`</span>))
  .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å¤„ç†å¤±è´¥:'</span>, error.<span class="hljs-property">message</span>);
    <span class="hljs-comment">// å…¨å±€é”™è¯¯ä¸ŠæŠ¥</span>
    <span class="hljs-title function_">reportErrorToSentry</span>(error);
  });

<span class="hljs-comment">// å¹¶å‘æ§åˆ¶ï¼šPromise.all</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([
  <span class="hljs-title function_">fetchProduct</span>(<span class="hljs-number">1</span>),
  <span class="hljs-title function_">fetchProduct</span>(<span class="hljs-number">2</span>),
  <span class="hljs-title function_">fetchProduct</span>(<span class="hljs-number">3</span>)
])
.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">products</span> =&gt;</span> <span class="hljs-title function_">renderCatalog</span>(products))
.<span class="hljs-title function_">catch</span>(showNetworkError);

<span class="hljs-comment">// å®¹é”™å¹¶å‘ï¼šPromise.allSettled</span>
<span class="hljs-keyword">const</span> requests = [
  <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/data1'</span>),
  <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/data2'</span>)
];

<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">allSettled</span>(requests).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">results</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> successful = results
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.<span class="hljs-property">status</span> === <span class="hljs-string">'fulfilled'</span>)
    .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.<span class="hljs-property">value</span>);
  
  <span class="hljs-keyword">if</span> (successful.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) <span class="hljs-title function_">showFallbackUI</span>();
  <span class="hljs-keyword">else</span> <span class="hljs-title function_">renderData</span>(successful);
});
</code></pre>
<p><strong>å…³é”®çªç ´</strong>ï¼š</p>
<ul>
<li><strong>çŠ¶æ€ä¸å¯å˜æ€§</strong>ï¼šPromise ä¸€æ—¦ settledï¼ˆfulfilled/rejectedï¼‰çŠ¶æ€æ°¸ä¹…é”å®š</li>
<li><strong>é“¾å¼ç»„åˆ</strong>ï¼š<code>.then()</code> è¿”å›æ–° Promiseï¼Œå®ç°çº¿æ€§æ§åˆ¶æµ</li>
<li><strong>ç»Ÿä¸€é”™è¯¯é€šé“</strong>ï¼šå•ä¸ª <code>.catch()</code> æ•è·é“¾ä¸­æ‰€æœ‰é”™è¯¯</li>
<li><strong>é«˜çº§æ§åˆ¶æ¨¡å¼</strong>ï¼š<code>Promise.race()</code>ï¼ˆç«é€Ÿï¼‰ã€<code>Promise.any()</code>ï¼ˆä»»ä¸€æˆåŠŸï¼‰ç­‰è§£å†³å¤æ‚åœºæ™¯</li>
</ul>
<blockquote>
<p>æ³¨æ„ï¼š<code>.then()</code> ä¸­æŠ›å‡ºçš„åŒæ­¥é”™è¯¯ä¹Ÿä¼šè¢«åç»­ <code>.catch()</code> æ•è·ï¼Œè¿™æ˜¯ Promise ä¼˜äºä¼ ç»Ÿå›è°ƒçš„æ ¸å¿ƒè®¾è®¡ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-3">ä¸‰ã€async/awaitï¼šä»¥åŒæ­¥æ€ç»´å†™å¼‚æ­¥ä»£ç </h3>
<p>ES2017 çš„ async/await æœ¬è´¨æ˜¯ Promise çš„è¯­æ³•ç³–ï¼Œå´æå¤§æå‡å¯è¯»æ€§ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// åŸºç¡€ç”¨æ³•</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">processUserOrder</span>(<span class="hljs-params">userId</span>) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchUser</span>(userId);
    <span class="hljs-keyword">const</span> orders = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchOrders</span>(user);
    <span class="hljs-keyword">const</span> total = <span class="hljs-keyword">await</span> <span class="hljs-title function_">calculateTotal</span>(orders);
    
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">user</span>: user.<span class="hljs-property">name</span>,
      <span class="hljs-attr">orderCount</span>: orders.<span class="hljs-property">length</span>,
      <span class="hljs-attr">totalAmount</span>: total
    };
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-comment">// ç»Ÿä¸€æ•è·æ‰€æœ‰ await ä¸­çš„é”™è¯¯</span>
    <span class="hljs-title function_">logError</span>(<span class="hljs-string">`è®¢å•å¤„ç†å¤±è´¥ [ç”¨æˆ·ID:<span class="hljs-subst">${userId}</span>]`</span>, error);
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomOrderError</span>(<span class="hljs-string">'PROCESS_FAILED'</span>, error);
  }
}

<span class="hljs-comment">// å¹¶è¡Œè¯·æ±‚ä¼˜åŒ–ï¼ˆé¿å…ä¸²è¡Œé™·é˜±ï¼ï¼‰</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">loadDashboardData</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// æ­£ç¡®ï¼šå¹¶è¡Œå‘èµ·è¯·æ±‚</span>
  <span class="hljs-keyword">const</span> [userProfile, notifications, stats] = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([
    <span class="hljs-title function_">fetchUserProfile</span>(),
    <span class="hljs-title function_">fetchNotifications</span>(),
    <span class="hljs-title function_">fetchAnalyticsStats</span>()
  ]);
  
  <span class="hljs-keyword">return</span> { userProfile, notifications, stats };
}

<span class="hljs-comment">// é”™è¯¯ç¤ºèŒƒï¼šä¸²è¡Œæ‰§è¡Œï¼ˆæ€»è€—æ—¶ = 3sï¼‰</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">slowLoad</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchUserProfile</span>(); <span class="hljs-comment">// 1s</span>
  <span class="hljs-keyword">const</span> notes = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchNotifications</span>(); <span class="hljs-comment">// 1s</span>
  <span class="hljs-keyword">const</span> stats = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchAnalyticsStats</span>(); <span class="hljs-comment">// 1s</span>
  <span class="hljs-comment">// æ€»è€—æ—¶çº¦ 3s</span>
}
</code></pre>
<p><strong>å¿…é¡»æŒæ¡çš„ç»†èŠ‚</strong>ï¼š</p>
<ol>
<li>
<p><strong>å‡½æ•°ä½œç”¨åŸŸ</strong>ï¼š<code>async</code> å‡½æ•°å§‹ç»ˆè¿”å› Promise</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getValue</span>(<span class="hljs-params"/>) { <span class="hljs-keyword">return</span> <span class="hljs-number">42</span>; }
<span class="hljs-title function_">getValue</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(v)); <span class="hljs-comment">// 42</span>
</code></pre>
</li>
<li>
<p><strong>é”™è¯¯ä¼ æ’­</strong>ï¼š<code>await</code> æŠ›å‡ºçš„é”™è¯¯ä¼šè·³å‡ºå½“å‰ async å‡½æ•°</p>
</li>
<li>
<p><strong>å¹¶è¡Œä¼˜åŒ–</strong>ï¼šåœ¨ <code>await</code> å‰ç”¨ <code>Promise.all</code> åŒ…è£¹ç‹¬ç«‹è¯·æ±‚</p>
</li>
<li>
<p><strong>è°ƒè¯•å‹å¥½</strong>ï¼šChrome DevTools å¯ç›´æ¥æŸ¥çœ‹ async è°ƒç”¨æ ˆ</p>
</li>
</ol>
<blockquote>
<p>é‡è¦å®è·µï¼šæ°¸è¿œç”¨ <code>try/catch</code> åŒ…è£¹é¡¶å±‚ async æ“ä½œï¼Œé¿å…æœªå¤„ç†çš„ Promise rejection å¯¼è‡´åº”ç”¨é™é»˜å¤±è´¥ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-4">å››ã€äº‹ä»¶å¾ªç¯ï¼šå¼‚æ­¥èƒŒåçš„å¼•æ“</h3>
<p>ç†è§£å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼ˆmicrotask queueï¼‰æ˜¯æŒæ¡æ‰§è¡Œé¡ºåºçš„å…³é”®ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'1. åŒæ­¥ä»£ç '</span>);

<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'2. å®ä»»åŠ¡ (setTimeout)'</span>), <span class="hljs-number">0</span>);

<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>()
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'3. å¾®ä»»åŠ¡ (Promise.then)'</span>))
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'4. å¾®ä»»åŠ¡é“¾'</span>));

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'5. åŒæ­¥ä»£ç ç»“æŸ'</span>);

<span class="hljs-comment">// è¾“å‡ºé¡ºåºï¼š</span>
<span class="hljs-comment">// 1. åŒæ­¥ä»£ç </span>
<span class="hljs-comment">// 5. åŒæ­¥ä»£ç ç»“æŸ</span>
<span class="hljs-comment">// 3. å¾®ä»»åŠ¡ (Promise.then)</span>
<span class="hljs-comment">// 4. å¾®ä»»åŠ¡é“¾</span>
<span class="hljs-comment">// 2. å®ä»»åŠ¡ (setTimeout)</span>
</code></pre>
<p><strong>äº‹ä»¶å¾ªç¯é˜¶æ®µ</strong>ï¼š</p>
<ol>
<li>æ‰§è¡ŒåŒæ­¥è„šæœ¬</li>
<li>æ¸…ç©º<strong>å¾®ä»»åŠ¡é˜Ÿåˆ—</strong>ï¼ˆPromise callbacks, queueMicrotaskï¼‰</li>
<li>æ‰§è¡Œ<strong>å®ä»»åŠ¡</strong>ï¼ˆsetTimeout, DOM events, I/Oï¼‰</li>
<li>é‡å¤ 2-3 æ­¥éª¤</li>
</ol>
<p><strong>æ€§èƒ½å¯ç¤º</strong>ï¼š</p>
<ul>
<li>å¾®ä»»åŠ¡åœ¨æœ¬æ¬¡äº‹ä»¶å¾ªç¯ç»“æŸå‰æ‰§è¡Œï¼Œé€‚åˆéœ€è¦ç«‹å³å“åº”çš„åœºæ™¯</li>
<li>é¿å…åœ¨å¾®ä»»åŠ¡ä¸­åˆ›å»ºæ–°å¾®ä»»åŠ¡å¯¼è‡´é˜»å¡ï¼ˆå¦‚æ— é™é€’å½’ <code>.then()</code>ï¼‰</li>
<li>é•¿ä»»åŠ¡åº”æ‹†åˆ†ä¸ºå¤šä¸ªå®ä»»åŠ¡ï¼Œé¿å…é˜»å¡ UI æ¸²æŸ“</li>
</ul>
<blockquote>
<p>æµè§ˆå™¨ä¸­ï¼Œ<code>queueMicrotask()</code> å¯æ‰‹åŠ¨åˆ›å»ºå¾®ä»»åŠ¡ï¼Œæ¯” <code>setTimeout(fn, 0)</code> ä¼˜å…ˆçº§æ›´é«˜ï¼Œé€‚ç”¨äºéœ€è¦ç²¾ç¡®æ§åˆ¶æ‰§è¡Œæ—¶æœºçš„åœºæ™¯ï¼ˆå¦‚ Vue å“åº”å¼ç³»ç»Ÿæ›´æ–°ï¼‰ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-5">äº”ã€å®æˆ˜ï¼šç°ä»£å¼‚æ­¥æ¨¡å¼é€‰æ‹©æŒ‡å—</h3>








































<table><thead><tr><th>åœºæ™¯</th><th>æ¨èæ–¹æ¡ˆ</th><th>ä»£ç ç¤ºä¾‹</th></tr></thead><tbody><tr><td>ç®€å•å•æ­¥æ“ä½œ</td><td>async/await</td><td><code>const data = await fetch(url)</code></td></tr><tr><td>å¤šä¾èµ–é¡ºåºæ“ä½œ</td><td>async/await + try/catch</td><td>è§ç¬¬ä¸‰èŠ‚ç¤ºä¾‹</td></tr><tr><td>å¤šè¯·æ±‚å¹¶è¡Œ</td><td>Promise.all + async/await</td><td><code>const [a,b] = await Promise.all([p1,p2])</code></td></tr><tr><td>éƒ¨åˆ†æˆåŠŸå³æœ‰æ•ˆ</td><td>Promise.allSettled</td><td>è§ç¬¬äºŒèŠ‚ç¤ºä¾‹</td></tr><tr><td>ç«é€Ÿåœºæ™¯ï¼ˆå¦‚å¤š CDN å¤‡ä»½ï¼‰</td><td>Promise.race</td><td><code>const res = await Promise.race([cdn1, cdn2])</code></td></tr><tr><td>éœ€è¦å–æ¶ˆçš„æ“ä½œ</td><td>AbortController + Promise</td><td><code>fetch(url, { signal })</code></td></tr></tbody></table>
<p><strong>å…³é”®å†³ç­–åŸåˆ™</strong>ï¼š</p>
<ol>
<li>
<p><strong>å¯è¯»æ€§ä¼˜å…ˆ</strong>ï¼š90% åœºæ™¯ä½¿ç”¨ async/await</p>
</li>
<li>
<p><strong>æ€§èƒ½æ•æ„Ÿåœºæ™¯</strong>ï¼š</p>
<ul>
<li>é¿å… <code>await</code> ä¸²è¡Œç‹¬ç«‹è¯·æ±‚ï¼ˆä½¿ç”¨ <code>Promise.all</code>ï¼‰</li>
<li>ç”¨ <code>Promise.allSettled</code> æ›¿ä»£å¤šæ¬¡ç‹¬ç«‹ <code>.catch()</code></li>
</ul>
</li>
<li>
<p><strong>å…¼å®¹æ€§å¤„ç†</strong>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// é€šè¿‡ Babel/TypeScript ç¼–è¯‘æ”¯æŒæ—§æµè§ˆå™¨</span>
<span class="hljs-comment">// package.json</span>
<span class="hljs-attr">"browserslist"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"&gt; 1%"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"last 2 versions"</span><span class="hljs-punctuation">]</span>
</code></pre>
</li>
</ol>
<hr/>
<h3 data-id="heading-6">å…­ã€ç»“è¯­ï¼šè¿ˆå‘æ›´å¥å£®çš„å¼‚æ­¥æœªæ¥</h3>
<p>JavaScript çš„å¼‚æ­¥æ¼”è¿›å²ï¼Œæ˜¯å¼€å‘è€…å¯¹ä»£ç å¯ç»´æŠ¤æ€§æ°¸ä¸åœæ¯çš„è¿½æ±‚ã€‚ä»å›è°ƒåˆ° async/awaitï¼Œä¸ä»…æ˜¯è¯­æ³•çš„ç®€åŒ–ï¼Œæ›´æ˜¯æ€ç»´æ¨¡å¼çš„å‡çº§â€”â€”æˆ‘ä»¬ç»ˆäºèƒ½ç”¨åŒæ­¥çš„é€»è¾‘ä¹¦å†™å¼‚æ­¥çš„ä¸–ç•Œã€‚</p>
<p><strong>è¡ŒåŠ¨å»ºè®®</strong>ï¼š</p>
<ol>
<li>é‡æ„é—ç•™é¡¹ç›®ä¸­è¶…è¿‡ 3 å±‚åµŒå¥—çš„å›è°ƒä»£ç </li>
<li>åœ¨æ–°é¡¹ç›®ä¸­å…¨é¢é‡‡ç”¨ async/await + Promise å·¥å…·æ–¹æ³•</li>
<li>é€šè¿‡ Chrome DevTools çš„ <strong>Performance</strong> é¢æ¿åˆ†æå¼‚æ­¥ä»»åŠ¡æ‰§è¡Œæ€§èƒ½</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[äºŒå‰æœç´¢æ ‘ï¼šè®©æ•°æ®åœ¨æœ‰åºä¸­ç”Ÿé•¿çš„æ™ºæ…§ä¹‹æ ‘]]></title>    <link>https://juejin.cn/post/7587808953075515392</link>    <guid>https://juejin.cn/post/7587808953075515392</guid>    <pubDate>2025-12-26T08:45:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587808953075515392" data-draft-id="7587743345196957748" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="äºŒå‰æœç´¢æ ‘ï¼šè®©æ•°æ®åœ¨æœ‰åºä¸­ç”Ÿé•¿çš„æ™ºæ…§ä¹‹æ ‘"/> <meta itemprop="keywords" content="JavaScript,é¢è¯•,æ•°æ®ç»“æ„"/> <meta itemprop="datePublished" content="2025-12-26T08:45:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é±¼é±¼å—"/> <meta itemprop="url" content="https://juejin.cn/user/4302802432307224"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            äºŒå‰æœç´¢æ ‘ï¼šè®©æ•°æ®åœ¨æœ‰åºä¸­ç”Ÿé•¿çš„æ™ºæ…§ä¹‹æ ‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4302802432307224/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é±¼é±¼å—
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T08:45:05.000Z" title="Fri Dec 26 2025 08:45:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">äºŒå‰æœç´¢æ ‘ï¼šè®©æ•°æ®æœ‰åºç”Ÿé•¿çš„æ™ºæ…§æ ‘</h2>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨æ•´ç†ä¸€ä¸ªå®¶åº­ç›¸å†Œã€‚ä½ ä¼šæŠŠå¹´ä»£ä¹…è¿œçš„ç…§ç‰‡æ”¾åœ¨å·¦è¾¹ï¼Œè¿‘å‡ å¹´çš„ç…§ç‰‡æ”¾åœ¨å³è¾¹ï¼Œæ¯ä¸€å¼ ç…§ç‰‡éƒ½å¯ä»¥æŒ‰ç…§æ—¶é—´é¡ºåºå¿«é€Ÿæ‰¾åˆ°â€”â€”è¿™å°±æ˜¯äºŒå‰æœç´¢æ ‘çš„æ€æƒ³ã€‚å®ƒæ˜¯ä¸€ç§è®©æ•°æ®ä¿æŒæœ‰åºã€æ”¯æŒå¿«é€ŸæŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤çš„æ ‘å½¢æ•°æ®ç»“æ„ã€‚</p>
<h3 data-id="heading-1">ä»€ä¹ˆæ˜¯äºŒå‰æœç´¢æ ‘ï¼Ÿ</h3>
<p>äºŒå‰æœç´¢æ ‘ï¼ˆBinary Search Treeï¼Œç®€ç§° <strong>BST</strong>ï¼‰ï¼Œåˆç§°ä¸º<strong>äºŒå‰æ’åºæ ‘</strong>æˆ–<strong>äºŒå‰æŸ¥æ‰¾æ ‘</strong>ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„äºŒå‰æ ‘æ•°æ®ç»“æ„ï¼Œå…·æœ‰ä»¥ä¸‹æ ¸å¿ƒæ€§è´¨ï¼š</p>
<ol>
<li><strong>å·¦å­æ ‘</strong>ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„å€¼ <strong>ä¸¥æ ¼å°äº</strong> æ ¹èŠ‚ç‚¹çš„å€¼ï¼›</li>
<li><strong>å³å­æ ‘</strong>ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„å€¼ <strong>ä¸¥æ ¼å¤§äº</strong> æ ¹èŠ‚ç‚¹çš„å€¼ï¼›</li>
<li>å·¦å­æ ‘å’Œå³å­æ ‘ <strong>æœ¬èº«ä¹Ÿæ˜¯äºŒå‰æœç´¢æ ‘</strong>ï¼›</li>
<li>ï¼ˆé€šå¸¸å‡è®¾ï¼‰æ ‘ä¸­<strong>ä¸å­˜åœ¨é‡å¤å€¼</strong>ï¼ˆä¹Ÿå¯æ ¹æ®å®ç°å…è®¸ç›¸ç­‰å€¼ç»Ÿä¸€æ”¾åœ¨å·¦/å³ï¼‰ã€‚</li>
</ol>
<p>ç®€å•æ¥è¯´å°±æ˜¯ï¼š</p>
<blockquote>
<p>å·¦å­æ ‘æ‰€æœ‰èŠ‚ç‚¹çš„å€¼ &lt; æ ¹èŠ‚ç‚¹çš„å€¼ &lt; å³å­æ ‘æ‰€æœ‰èŠ‚ç‚¹çš„å€¼</p>
</blockquote>
<h4 data-id="heading-2">ç¤ºä¾‹</h4>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-code">        50
       /  \
     30    70
    / \    / \
  20  40 60  80
</span></code></pre>
<p>è¿™ç§ç»“æ„è®©æŸ¥æ‰¾å˜å¾—éå¸¸é«˜æ•ˆï¼Œå¹³å‡æƒ…å†µä¸‹åªéœ€ O(log n) çš„æ—¶é—´ï¼Œå°±åƒåœ¨ç”µè¯ç°¿ä¸­æŒ‰å­—æ¯é¡ºåºæ‰¾äººä¸€æ ·å¿«ã€‚</p>
<p>ä¸è¿‡ï¼Œå¦‚æœæ ‘é•¿å¾—â€œæ­ªâ€äº†ï¼ˆæ¯”å¦‚æ‰€æœ‰èŠ‚ç‚¹éƒ½åªæœ‰å³å­©å­ï¼‰ï¼Œæœ€åæƒ…å†µä¸‹ï¼ˆå¦‚æŒ‰å‡åºè¿ç»­æ’å…¥ï¼‰ï¼ŒBST ä¼šé€€åŒ–æˆä¸€æ¡<strong>é“¾è¡¨</strong>ï¼ŒæŸ¥æ‰¾æ•ˆç‡ä»â€œç”µè¯ç°¿å¼è·³è·ƒâ€é€€åŒ–ä¸ºâ€œä¸€é¡µé¡µç¿»ä¹¦â€ï¼Œæ—¶é—´å¤æ‚åº¦å˜ä¸º <strong>O(n)</strong></p>
<p>æ—¶é—´å¤æ‚åº¦O(n)ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">1
 \
  2
   \
<span class="hljs-code">    3
     \
      4
       \
        5
</span></code></pre>
<h3 data-id="heading-3">æŸ¥æ‰¾ï¼šåœ¨æ ‘ä¸­å¯»å®</h3>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€æ£µè¿™æ ·çš„äºŒå‰æœç´¢æ ‘ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">TreeNode</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">val</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">val</span> = val;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">left</span> = <span class="hljs-literal">null</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">right</span> = <span class="hljs-literal">null</span>;
    }
}

<span class="hljs-comment">// æ„å»ºä¸€æ£µæ ‘</span>
<span class="hljs-keyword">const</span> root = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(<span class="hljs-number">6</span>);
root.<span class="hljs-property">left</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(<span class="hljs-number">3</span>);
root.<span class="hljs-property">right</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(<span class="hljs-number">8</span>);
root.<span class="hljs-property">left</span>.<span class="hljs-property">left</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(<span class="hljs-number">1</span>);
root.<span class="hljs-property">left</span>.<span class="hljs-property">right</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(<span class="hljs-number">4</span>);
root.<span class="hljs-property">right</span>.<span class="hljs-property">left</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(<span class="hljs-number">7</span>);
root.<span class="hljs-property">right</span>.<span class="hljs-property">right</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(<span class="hljs-number">9</span>);
</code></pre>
<p>è¿™æ£µæ ‘çš„ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-code">      6
     / \
    3   8
   / \ / \
  1  4 7  9
</span></code></pre>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬è¦åœ¨è¿™æ£µæ ‘é‡Œå¯»æ‰¾å€¼ä¸º <code>7</code> çš„èŠ‚ç‚¹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">search</span>(<span class="hljs-params">root, n</span>) {
  <span class="hljs-keyword">if</span> (!root) {
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-keyword">if</span> (root.<span class="hljs-property">val</span> === n) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ‰¾åˆ°ç›®æ ‡èŠ‚ç‚¹'</span>, root);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (root.<span class="hljs-property">val</span> &gt; n) {
    <span class="hljs-comment">// å¦‚æœç›®æ ‡å€¼æ¯”å½“å‰èŠ‚ç‚¹å°ï¼Œå»å·¦è¾¹æ‰¾</span>
    <span class="hljs-title function_">search</span>(root.<span class="hljs-property">left</span>, n);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// å¦‚æœç›®æ ‡å€¼æ¯”å½“å‰èŠ‚ç‚¹å¤§ï¼Œå»å³è¾¹æ‰¾</span>
    <span class="hljs-title function_">search</span>(root.<span class="hljs-property">right</span>, n);
  }
}

<span class="hljs-title function_">search</span>(root, <span class="hljs-number">7</span>); <span class="hljs-comment">// è¾“å‡ºï¼šæ‰¾åˆ°ç›®æ ‡èŠ‚ç‚¹</span>
</code></pre>
<p>æŸ¥æ‰¾è¿‡ç¨‹å°±åƒåœ¨è¿·å®«ä¸­é€‰æ‹©æ­£ç¡®çš„å²”è·¯ï¼šæ¯æ¬¡éƒ½åˆ¤æ–­ç›®æ ‡åœ¨å·¦è¿˜æ˜¯å³ï¼Œä¸€æ­¥æ­¥ç¼©å°èŒƒå›´ï¼Œç›´åˆ°æ‰¾åˆ°å®è—ã€‚</p>
<h3 data-id="heading-4">æ’å…¥ï¼šä¸ºæ ‘æ·»åŠ æ–°æˆå‘˜</h3>
<p>å½“æœ‰æ–°æˆå‘˜è¦åŠ å…¥è¿™ä¸ªæœ‰åºçš„â€œå®¶åº­â€æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºå®ƒæ‰¾åˆ°åˆé€‚çš„ä½ç½®ã€‚æ¯”å¦‚è¦åœ¨æ ‘ä¸­æ’å…¥æ•°å­— <code>5</code>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">insertIntoBst</span>(<span class="hljs-params">root, n</span>) {
  <span class="hljs-comment">// å¦‚æœå½“å‰ä½ç½®æ˜¯ç©ºçš„ï¼Œå°±åœ¨è¿™é‡Œå®‰å®¶</span>
  <span class="hljs-keyword">if</span> (!root) {
    root = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(n);
    <span class="hljs-keyword">return</span> root;
  }
  
  <span class="hljs-comment">// æ¯”å½“å‰èŠ‚ç‚¹å°ï¼Œå»å·¦è¾¹æ‰¾ä½ç½®</span>
  <span class="hljs-keyword">if</span> (root.<span class="hljs-property">val</span> &gt; n) {
    root.<span class="hljs-property">left</span> = <span class="hljs-title function_">insertIntoBst</span>(root.<span class="hljs-property">left</span>, n);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// æ¯”å½“å‰èŠ‚ç‚¹å¤§ï¼Œå»å³è¾¹æ‰¾ä½ç½®</span>
    root.<span class="hljs-property">right</span> = <span class="hljs-title function_">insertIntoBst</span>(root.<span class="hljs-property">right</span>, n);
  }

  <span class="hljs-keyword">return</span> root;
}

<span class="hljs-comment">// æ’å…¥æ•°å­—5</span>
<span class="hljs-keyword">const</span> newRoot = <span class="hljs-title function_">insertIntoBst</span>(root, <span class="hljs-number">5</span>);
</code></pre>
<p>æ’å…¥åï¼Œæ ‘çš„ç»“æ„å˜ä¸ºï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-code">      6
     / \
    3   8
   / \ / \
  1  4 7  9
      \
       5    â† æ–°æˆå‘˜åœ¨è¿™é‡Œæ‰¾åˆ°äº†å®¶
</span></code></pre>
<p>æ’å…¥è¿‡ç¨‹å°±åƒåœ¨å›¾ä¹¦é¦†æ‰¾ä¹¦æ¶æ”¾æ–°ä¹¦ï¼šå…ˆæ¯”è¾ƒä¹¦åé¦–å­—æ¯ï¼Œå†³å®šå»å·¦è¾¹è¿˜æ˜¯å³è¾¹çš„ä¹¦æ¶ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªç©ºä½ã€‚</p>
<h3 data-id="heading-5">ğŸ—‘ï¸ åˆ é™¤ï¼šä¼˜é›…åœ°å‘Šåˆ«</h3>
<p>åˆ é™¤èŠ‚ç‚¹æ˜¯äºŒå‰æœç´¢æ ‘æ“ä½œä¸­æœ€ç²¾å¦™çš„éƒ¨åˆ†ï¼Œéœ€è¦è€ƒè™‘ä¸‰ç§æƒ…å†µï¼š</p>
<h4 data-id="heading-6">1. å¶å­èŠ‚ç‚¹ï¼ˆæ²¡æœ‰å­©å­ï¼‰</h4>
<p>ç›´æ¥ç§»é™¤å³å¯ï¼Œå°±åƒæ‘˜ä¸‹ä¸€ç‰‡æ ‘å¶ã€‚</p>
<h4 data-id="heading-7">2. åªæœ‰ä¸€ä¸ªå­©å­</h4>
<p>ç”¨è¿™ä¸ªå­©å­æ¥æ›¿è‡ªå·±çš„ä½ç½®ï¼Œå°±åƒçˆ¶äº²æŠŠå®¶ä¸šä¼ ç»™ç‹¬å­ã€‚</p>
<h4 data-id="heading-8">3. æœ‰ä¸¤ä¸ªå­©å­</h4>
<p>è¿™æ˜¯æœ€æœ‰è¶£çš„æƒ…å†µï¼šéœ€è¦æ‰¾ä¸€ä¸ªåˆé€‚çš„â€œæ¥ç­äººâ€ã€‚å¯ä»¥é€‰æ‹©å·¦å­æ ‘ä¸­æœ€å¤§çš„èŠ‚ç‚¹ï¼Œæˆ–è€…å³å­æ ‘ä¸­æœ€å°çš„èŠ‚ç‚¹æ¥æ›¿ä»£è‡ªå·±ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">deleteNode</span>(<span class="hljs-params">root, n</span>) {
  <span class="hljs-keyword">if</span> (!root) {
    <span class="hljs-keyword">return</span> root;
  }

  <span class="hljs-keyword">if</span> (root.<span class="hljs-property">val</span> === n) {
    <span class="hljs-comment">// æƒ…å†µ1ï¼šæ²¡æœ‰å­©å­</span>
    <span class="hljs-keyword">if</span> (!root.<span class="hljs-property">left</span> &amp;&amp; !root.<span class="hljs-property">right</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    <span class="hljs-comment">// æƒ…å†µ2ï¼šæœ‰å·¦å­©å­ï¼Œæ‰¾å·¦å­æ ‘ä¸­æœ€å¤§çš„</span>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (root.<span class="hljs-property">left</span>) {
      <span class="hljs-keyword">const</span> maxLeft = <span class="hljs-title function_">findMax</span>(root.<span class="hljs-property">left</span>);
      root.<span class="hljs-property">val</span> = maxLeft.<span class="hljs-property">val</span>;  <span class="hljs-comment">// ç”¨å·¦å­æ ‘æœ€å¤§èŠ‚ç‚¹æ›¿ä»£è‡ªå·±</span>
      root.<span class="hljs-property">left</span> = <span class="hljs-title function_">deleteNode</span>(root.<span class="hljs-property">left</span>, maxLeft.<span class="hljs-property">val</span>); <span class="hljs-comment">// åˆ é™¤é‚£ä¸ªæœ€å¤§èŠ‚ç‚¹</span>
    }
    <span class="hljs-comment">// æƒ…å†µ3ï¼šåªæœ‰å³å­©å­ï¼Œæ‰¾å³å­æ ‘ä¸­æœ€å°çš„</span>
    <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">const</span> minRight = <span class="hljs-title function_">findMin</span>(root.<span class="hljs-property">right</span>);
      root.<span class="hljs-property">val</span> = minRight.<span class="hljs-property">val</span>;  <span class="hljs-comment">// ç”¨å³å­æ ‘æœ€å°èŠ‚ç‚¹æ›¿ä»£è‡ªå·±</span>
      root.<span class="hljs-property">right</span> = <span class="hljs-title function_">deleteNode</span>(root.<span class="hljs-property">right</span>, minRight.<span class="hljs-property">val</span>); <span class="hljs-comment">// åˆ é™¤é‚£ä¸ªæœ€å°èŠ‚ç‚¹</span>
    }
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (root.<span class="hljs-property">val</span> &gt; n) {
    root.<span class="hljs-property">left</span> = <span class="hljs-title function_">deleteNode</span>(root.<span class="hljs-property">left</span>, n);
  } <span class="hljs-keyword">else</span> {
    root.<span class="hljs-property">right</span> = <span class="hljs-title function_">deleteNode</span>(root.<span class="hljs-property">right</span>, n);
  }
  <span class="hljs-keyword">return</span> root;
}

<span class="hljs-comment">// å¯»æ‰¾å·¦å­æ ‘ä¸­çš„æœ€å¤§å€¼ï¼ˆä¸€ç›´å¾€å³èµ°ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">findMax</span>(<span class="hljs-params">root</span>) {
  <span class="hljs-keyword">while</span> (root.<span class="hljs-property">right</span>) {
    root = root.<span class="hljs-property">right</span>;
  }
  <span class="hljs-keyword">return</span> root;
}

<span class="hljs-comment">// å¯»æ‰¾å³å­æ ‘ä¸­çš„æœ€å°å€¼ï¼ˆä¸€ç›´å¾€å·¦èµ°ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">findMin</span>(<span class="hljs-params">root</span>) {
  <span class="hljs-keyword">while</span> (root.<span class="hljs-property">left</span>) {
    root = root.<span class="hljs-property">left</span>;
  }
  <span class="hljs-keyword">return</span> root;
}

<span class="hljs-comment">// åˆ é™¤å€¼ä¸º4çš„èŠ‚ç‚¹</span>
<span class="hljs-title function_">deleteNode</span>(root, <span class="hljs-number">4</span>);
</code></pre>
<p><strong>æ•´ä½“æ€è·¯ï¼šé€’å½’ + åˆ†ç±»å¤„ç†</strong></p>
<p>å‡½æ•°é‡‡ç”¨<strong>é€’å½’æ–¹å¼</strong>éå†æ ‘ï¼š</p>
<ol>
<li><strong>å…ˆå®šä½</strong>è¦åˆ é™¤çš„èŠ‚ç‚¹ï¼›</li>
<li><strong>å†æ ¹æ®è¯¥èŠ‚ç‚¹çš„å­æ ‘æƒ…å†µ</strong>ï¼Œåˆ†ä¸‰ç§æƒ…å½¢å¤„ç†ï¼›</li>
<li><strong>æœ€åé€šè¿‡è¿”å›å€¼é‡å»ºçˆ¶å­é“¾æ¥</strong>ï¼Œç¡®ä¿æ ‘ç»“æ„å®Œæ•´ã€‚</li>
</ol>
<p>åˆ é™¤æœ‰ä¸¤ä¸ªå­©å­çš„èŠ‚ç‚¹ï¼Œå°±åƒå…¬å¸CEOç¦»èŒï¼šéœ€è¦ä»ç°æœ‰å›¢é˜Ÿä¸­é€‰ä¸€ä¸ªæœ€åˆé€‚çš„æ¥ç­äººï¼ˆå·¦å­æ ‘æœ€å¤§æˆ–å³å­æ ‘æœ€å°ï¼‰ï¼Œè®©è¿™ä¸ªæ¥ç­äººååœ¨CEOçš„ä½ç½®ä¸Šï¼Œç„¶åå†å¤„ç†æ¥ç­äººåŸæ¥çš„èŒä½ã€‚</p>
<h3 data-id="heading-9">äºŒå‰æœç´¢æ ‘æ“ä½œå…¨æ™¯å›é¡¾</h3>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²å®Œæ•´èµ°è¿‡äº†äºŒå‰æœç´¢æ ‘çš„ä¸‰å¤§æ ¸å¿ƒæ“ä½œï¼Œå®ƒä»¬å…±åŒæ„æˆäº† BST çš„ç”Ÿå‘½åŠ›ï¼š</p>
<ul>
<li>
<p><strong>æŸ¥æ‰¾ï¼ˆSearchï¼‰</strong> ï¼š<br/>
æ²¿ç€â€œå·¦å°å³å¤§â€çš„è·¯å¾„é€å±‚æ·±å…¥ï¼Œæ—¶é—´å¤æ‚åº¦å¹³å‡ä¸º <strong>O(log n)</strong> ï¼Œæœ€åä¸º <strong>O(n)</strong> ã€‚å®ƒæ˜¯æ‰€æœ‰æ“ä½œçš„åŸºç¡€ã€‚</p>
</li>
<li>
<p><strong>æ’å…¥ï¼ˆInsertï¼‰</strong> ï¼š<br/>
æœ¬è´¨æ˜¯ä¸€æ¬¡â€œå¸¦è®°å¿†çš„æŸ¥æ‰¾â€â€”â€”æ‰¾åˆ°ç©ºä½åå®‰æ”¾æ–°èŠ‚ç‚¹ï¼Œ<strong>ä¸ç ´ååŸæœ‰æœ‰åºæ€§</strong>ï¼Œå®ç°ç®€å•å´è‡³å…³é‡è¦ã€‚</p>
</li>
<li>
<p><strong>åˆ é™¤ï¼ˆDeleteï¼‰</strong> ï¼š<br/>
æœ€å…·æŒ‘æˆ˜æ€§çš„æ“ä½œï¼Œéœ€åˆ†ä¸‰ç§æƒ…å½¢å¤„ç†ï¼š</p>
<ul>
<li>å¶å­èŠ‚ç‚¹ â†’ ç›´æ¥ç§»é™¤ï¼›</li>
<li>å•å­èŠ‚ç‚¹ â†’ å­æ‰¿çˆ¶ä¸šï¼›</li>
<li>åŒå­èŠ‚ç‚¹ â†’ ä»¥<strong>å‰é©±ï¼ˆå·¦å­æ ‘æœ€å¤§ï¼‰æˆ–åç»§ï¼ˆå³å­æ ‘æœ€å°ï¼‰</strong> æ›¿ä»£ï¼Œå†é€’å½’åˆ é™¤æ›¿ä»£è€…ã€‚</li>
</ul>
</li>
</ul>
<p>è¿™ä¸‰è€…éƒ½åŸºäº<strong>é€’å½’æ€æƒ³</strong>ä¸<strong>BST çš„æœ‰åºæ€§è´¨</strong>ï¼Œåœ¨ä¿æŒç»“æ„åˆæ³•çš„åŒæ—¶ï¼Œé«˜æ•ˆç»´æŠ¤æ•°æ®çš„åŠ¨æ€æœ‰åºã€‚</p>
<blockquote>
<p>æ­£æ˜¯è¿™ç§â€œ<strong>æœ‰åº + é€’å½’ + åˆ†æ²»</strong>â€çš„ç»„åˆï¼Œè®©äºŒå‰æœç´¢æ ‘æˆä¸ºè¿æ¥çº¿æ€§ç»“æ„ä¸é«˜çº§å¹³è¡¡æ ‘ä¹‹é—´çš„å…³é”®æ¡¥æ¢ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-10">ç»“è¯­ï¼šæœ‰åºä¹‹ç¾ï¼Œæºäºç»“æ„ä¹‹æ™º</h3>
<p>äºŒå‰æœç´¢æ ‘ä¸ä»…æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œæ›´æ˜¯ä¸€ç§<strong>æœ‰åºæ€ç»´çš„ä½“ç°</strong>â€”â€”ç”¨â€œå·¦å°å³å¤§â€çš„ç®€å•è§„åˆ™ï¼Œè®©æ•°æ®åœ¨æ ‘ä¸­è‡ªç„¶ç”Ÿé•¿ï¼ŒæŸ¥æ‰¾ã€æ’å…¥ã€åˆ é™¤çš†å¦‚è¡Œäº‘æµæ°´ã€‚</p>
<p>ä½†è‹¥æ’å…¥å¤±åºï¼ŒBST ä¼šé€€åŒ–ä¸ºé“¾è¡¨ï¼Œæ•ˆç‡éª¤é™ã€‚è¿™æé†’æˆ‘ä»¬ï¼š<strong>ç»“æ„å†³å®šæ€§èƒ½ï¼Œå¹³è¡¡æ–¹èƒ½æŒä¹…</strong>ã€‚äºæ˜¯ AVL æ ‘ã€çº¢é»‘æ ‘ç­‰è‡ªå¹³è¡¡ç»“æ„åº”è¿è€Œç”Ÿï¼Œåœ¨åŠ¨æ€ä¸­å®ˆæŠ¤ç§©åºã€‚</p>
<p>æŒæ¡ BSTï¼Œä¸åªæ˜¯å­¦ä¼šä¸€ç§ç®—æ³•ï¼Œæ›´æ˜¯ç†è§£<strong>é€’å½’ã€åˆ†æ²»ä¸æœ‰åºç»„ç»‡</strong>çš„èµ·ç‚¹ã€‚ä¸‹æ¬¡ä½ å¿«é€Ÿç¿»åˆ°æŸå¼ ç…§ç‰‡æˆ–æ‰¾åˆ°æŸä¸ªè”ç³»äººæ—¶ï¼Œé‚£èƒŒåæˆ–è®¸æ­£æœ‰ä¸€æ£µâ€œæ™ºæ…§æ ‘â€åœ¨é»˜é»˜å·¥ä½œã€‚</p>
<p>ç†è§£ BSTï¼Œæ˜¯é€šå¾€é«˜çº§æ•°æ®ç»“æ„çš„ç¬¬ä¸€æ­¥ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Nestjs é£äº‘å½•ï¼šå‰ç«¯å°‘ä¾ çš„ç ´å±€ä¹‹é“]]></title>    <link>https://juejin.cn/post/7587845752682545215</link>    <guid>https://juejin.cn/post/7587845752682545215</guid>    <pubDate>2025-12-26T08:40:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587845752682545215" data-draft-id="7587961565476880438" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" Nestjs é£äº‘å½•ï¼šå‰ç«¯å°‘ä¾ çš„ç ´å±€ä¹‹é“"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2025-12-26T08:40:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ—¥è½ä»¥åæ½œå…¥æ·±æµ·"/> <meta itemprop="url" content="https://juejin.cn/user/2045559991451175"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             Nestjs é£äº‘å½•ï¼šå‰ç«¯å°‘ä¾ çš„ç ´å±€ä¹‹é“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2045559991451175/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ—¥è½ä»¥åæ½œå…¥æ·±æµ·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T08:40:47.000Z" title="Fri Dec 26 2025 08:40:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å‰è¨€ï¼šæœ€è¿‘åœ¨å­¦ä¹ Nest.jsçš„æ–‡æ¡£ï¼Œå¬ç€é©¬ä¼¯åº¸çš„é•¿å®‰åäºŒæ—¶è¾°çš„å°è¯´ï¼Œäºæ˜¯å°±æœ‰äº†ä¸‹é¢è¿™ç¯‡å­¦ä¹ æˆæœâ€¦â€¦</p>
<h2 data-id="heading-0">åºè¨€</h2>
<p>å‡¡æœ‰äº•æ°´å¤„ï¼Œçš†èƒ½æ­ŒæŸ³è¯ï¼›å‡¡æœ‰æµè§ˆå™¨å¤„ï¼Œçš†éœ€ JavaScriptã€‚</p>
<p>ä½†è¿™ä¸–é—´çš„äº‹ï¼Œå¾€å¾€åå°±ååœ¨â€œç•Œé™â€äºŒå­—ä¸Šã€‚</p>
<p>å‰ç«¯ä¸»â€œç›¸â€ï¼Œåç«¯ä¸»â€œéª¨â€ã€‚ç”»çš®éš¾ç”»éª¨ï¼Œæ˜¯ä»¥å¤šå°‘æƒŠæ‰ç»è‰³çš„å‰ç«¯å°‘ä¾ ï¼Œç»ˆå…¶ä¸€ç”Ÿï¼Œéƒ½è¢«å›°åœ¨é‚£æ–¹å¯¸å±å¹•ä¹‹é—´ï¼Œå¯¹ç€åç«¯ä¼ æ¥çš„ JSON æ•°æ®æœ›æ´‹å…´å¹ï¼Œä¸å¾—å¯¸è¿›ã€‚</p>
<p>ç›´åˆ°é‚£ä¸€æ—¥ï¼ŒNest.js çš„ä¿¡é¸½é£å…¥é•¿å®‰ï¼Œå¸¦æ¥äº†ä¸€å¼ åä¸ºâ€œæ¶æ„â€çš„è—å®å›¾ã€‚</p>
<p>è¿™ä¸æ˜¯ä¸€æœ¬åŠä½ è½¬è¡Œçš„ä¹¦ï¼Œè¿™æ˜¯ä¸€æœ¬æ•™ä½ å¦‚ä½•æ‹†å¢™çš„ç­–ã€‚</p>
<p>å¢™æ¨å€’äº†ï¼Œä¾¿æ˜¯æ¡¥ã€‚</p>
<hr/>
<h2 data-id="heading-1">ç¬¬ä¸€ç« ï¼šé•¿å®‰åŸçš„å›°å±€</h2>
<p>å¤©å®åå››è½½ï¼Œé•¿å®‰åŸçš„åŠé—´æ­£æ˜¯çƒ­é—¹éå‡¡ã€‚</p>
<p>Vue é—¨æ´¾çš„æ—Œæ——åœ¨æœ±é›€å¤§è¡—ä¸ŠçŒçŒä½œå“ï¼ŒReact å®—é—¨çš„å¼Ÿå­ä»¬åœ¨è¥¿å¸‚é«˜è°ˆé˜”è®ºï¼Œè®²çš„æ˜¯ Hooks å¿ƒæ³•ï¼Œè®ºçš„æ˜¯ Virtual DOM å¹»æœ¯ã€‚ä¹ä¸€çœ‹ï¼Œè¿™å‰ç«¯æ±Ÿæ¹–ç¹èŠ±ä¼¼é”¦ï¼Œçƒˆç«çƒ¹æ²¹ã€‚</p>
<p>ç„¶è€Œï¼Œå¯¹äºæå°‘ä¾ æ¥è¯´ï¼Œè¿™ç¹åèƒŒåå´é€ç€ä¸€ä¸å‡‰æ„ã€‚</p>
<p>ä½œä¸ºä¸€ååœ¨å‰ç«¯æ±Ÿæ¹–æ‘¸çˆ¬æ»šæ‰“å¤šå¹´çš„åˆ€å®¢ï¼Œä»–çš„ä¸€æ‰‹ç»„ä»¶åŒ–åˆ€æ³•å·²è‡»åŒ–å¢ƒï¼Œåˆ‡é¡µé¢å¦‚åº–ä¸è§£ç‰›ï¼Œæ¸¸åˆƒæœ‰ä½™ã€‚å¯æ¯å½“å¤œæ·±äººé™ï¼Œå¯¹ç€é‚£æƒ¨ç™½çš„æ˜¾ç¤ºå™¨ï¼Œä»–æ€»è§‰å¾—æ‰‹ä¸­çš„åˆ€ï¼ŒçŸ­äº†åŠå¯¸ã€‚</p>
<p>è¿™åŠå¯¸ï¼Œä¾¿æ˜¯â€œåç«¯â€ã€‚</p>
<p>æ¯é€¢ä¸åç«¯ç¥æœºè¥çš„æ ¡å°‰ä»¬å¯¹æ¥æ¥å£ï¼Œæå°‘ä¾ ä¾¿è§‰å¤„å¤„æ£è‚˜ã€‚
â€œè¿™å­—æ®µä¸ºä½•è¦åµŒå¥—ä¸‰å±‚ï¼Ÿâ€
â€œé‚£é‰´æƒé€»è¾‘ä¸ºä½•å¦‚æ­¤ç¹çï¼Ÿâ€
ç¥æœºè¥çš„äººåªå†·å†·å›ä¸€å¥ï¼šâ€œæ­¤ä¹ƒç³»ç»Ÿæ¶æ„ä¹‹è§„çŸ©ï¼Œå°”ç­‰åˆ‡å›¾ç”»é¢çš„ï¼Œä¾æ ·ç”»è‘«èŠ¦ä¾¿æ˜¯ã€‚â€</p>
<p>æå°‘ä¾ å¿ƒä¸­ä¸å¿¿ã€‚å‰ç«¯è™½å¦™ï¼Œç»ˆç©¶æ˜¯åœ¨æ­¤å²¸ç”»çš®ï¼›è¦æƒ³çœŸæ­£æŒæ§æ•°æ®çš„æ´ªæµï¼Œéå¾—æ¸¡æ²³å»å½¼å²¸ä¸å¯ã€‚</p>
<p>è¿™æ—¥ï¼Œä»–åœ¨èŒ¶é¦†å¬è¯´ï¼Œè¥¿åŸŸä¼ æ¥ä¸€é—¨å¥‡æœ¯ï¼Œåå”¤ <strong>Nest.js</strong>ã€‚ä¼ é—»æ­¤æœ¯è™½æ˜¯ Node.js çš„åº•å­ï¼Œå´è•´å«ç€åç«¯æ¶æ„çš„æ— ä¸Šå¿ƒæ³•ï¼Œä¸”ä¸ TypeScript è¿™é—¨å®˜è¯æ— ç¼å¥‘åˆï¼Œç«Ÿèƒ½è®©å‰ç«¯æ¸¸ä¾ ä¹Ÿèƒ½ä½¿å¾—åŠ¨åç«¯çš„é‡å‰‘ã€‚</p>
<p>â€œæœ‰ç‚¹æ„æ€ã€‚â€æå°‘ä¾ æ”¾ä¸‹èŒ¶ç›ï¼Œçœ¼ä¸­ç²¾å…‰ä¸€é—ªï¼Œâ€œè¿™ Nest.jsï¼Œæˆ‘ä¾¿å»ä¼šå®ƒä¸€ä¼šã€‚â€</p>
<h2 data-id="heading-2">ç¬¬äºŒç« ï¼šåˆæ¢ç¥æœºè¥</h2>
<p>åˆå…¥ Nest.js çš„åœ°ç•Œï¼Œæå°‘ä¾ ä¸ç”±å¾—å€’å¸ä¸€å£å‡‰æ°”ã€‚</p>
<p>è¿™å“ªé‡Œæ˜¯ä»€ä¹ˆè½»çµçš„è„šæœ¬ï¼Œåˆ†æ˜æ˜¯ä¸€åº§æˆ’å¤‡æ£®ä¸¥çš„å†›è¥ã€‚</p>
<p>è¿™é‡Œæ²¡æœ‰éšæ„çš„ <code>function</code> ä¹±é£ï¼Œæ²¡æœ‰ <code>var</code> éåœ°èµ°ã€‚å–è€Œä»£ä¹‹çš„ï¼Œæ˜¯å±‚å±‚å å çš„ <strong>Moduleï¼ˆæ¨¡å—ï¼‰</strong>ï¼Œæ£®ä¸¥å£å’çš„ <strong>Controllerï¼ˆæ§åˆ¶å™¨ï¼‰</strong>ï¼Œä»¥åŠæ·±è—ä¸éœ²çš„ <strong>Serviceï¼ˆæœåŠ¡ï¼‰</strong>ã€‚</p>
<p>â€œè¿™å¸ƒå±€ï¼Œç«Ÿä¸å½“å¹´çš„ Angular å®—é—¨æœ‰å‡ åˆ†ç¥ä¼¼ï¼Ÿâ€æå°‘ä¾ æš—è‡ªæ€å¿–ã€‚</p>
<p>æ­£ç–‘æƒ‘é—´ï¼Œä¸€ä½æ‰«åœ°åƒ§æ¨¡æ ·çš„è€è€…èµ°äº†å‡ºæ¥ï¼Œé‚£æ˜¯ Nest.js çš„æ¥å¼•ä½¿è€…ã€‚
â€œå°‘ä¾ å¯æ˜¯è§‰å¾—ç¹çï¼Ÿâ€è€è€…ç¬‘é“ï¼Œâ€œå‰ç«¯æ±‚çš„æ˜¯â€˜å¿«â€™ï¼Œå¦‚å¿«é©¬è½»è£˜ï¼›åç«¯æ±‚çš„æ˜¯â€˜ç¨³â€™ï¼Œå¦‚æ­¥æ­¥ä¸ºè¥ã€‚Nest.js çš„ç¬¬ä¸€è¯¾ï¼Œä¾¿æ˜¯è¿™<strong>ä¾èµ–æ³¨å…¥ï¼ˆDependency Injectionï¼‰</strong>ã€‚â€</p>
<p>æå°‘ä¾ ä¸è§£ï¼šâ€œä½•ä¸ºä¾èµ–æ³¨å…¥ï¼Ÿâ€</p>
<p>è€è€…æŒ‡äº†æŒ‡è¥å¸ï¼šâ€œå‡è®¾ä½ è¦é€ ä¸€è¾†æˆ˜è½¦ï¼ˆClassï¼‰ã€‚è‹¥ä½ åœ¨è½¦å†…è‡ªé€ è½®å­ã€è‡ªç‚¼é’¢é“ï¼Œè¿™è½¦ä¾¿é‡è‹¥åƒé’§ï¼Œéš¾ä»¥æ‹†å¸ã€‚è‹¥ä½ åªéœ€åœ¨å›¾çº¸ä¸Šå†™æ˜â€˜éœ€è½®å­ä¸€å¯¹â€™ï¼Œé€ è½¦æ—¶è‡ªæœ‰å†›éœ€å®˜å°†è½®å­é€æ¥è£…ä¸Šï¼Œè¿™ä¾¿æ˜¯ä¾èµ–æ³¨å…¥ã€‚å¦‚æ­¤ï¼Œæˆ˜è½¦ä¸è½®å­è§£è€¦ï¼Œæƒ³æ¢é“è½®æ¢é“è½®ï¼Œæƒ³æ¢æœ¨è½®æ¢æœ¨è½®ï¼Œå²‚ä¸å¿«å“‰ï¼Ÿâ€</p>
<p>æå°‘ä¾ é—»è¨€ï¼Œè‹¥æœ‰æ‰€æ‚Ÿã€‚åŸæ¥åç«¯æ‰€è°“çš„â€œæ¶æ„â€ï¼Œä¸è¿‡æ˜¯æŠŠâ€œè°æ¥å¹²æ´»â€å’Œâ€œæ€ä¹ˆå¹²æ´»â€åˆ†å¾—æ¸…æ¸…æ¥šæ¥šï¼Œä¸è®©ä¸€äººç‹¬å¤§ï¼Œäº¦ä¸è®©ä¸€äººç´¯æ­»ã€‚è¿™ä¾¿æ˜¯ <strong>IoCï¼ˆæ§åˆ¶åè½¬ï¼‰</strong> çš„ç²¾é«“ã€‚</p>
<h2 data-id="heading-3">ç¬¬ä¸‰ç« ï¼šé€šå…³æ–‡ç‰’ä¸é”¦è¡£å«</h2>
<p>å…¥äº†è¥é—¨ï¼Œæå°‘ä¾ æ‰çŸ¥åç«¯æ±Ÿæ¹–çš„æ°´æœ‰å¤šæ·±ã€‚</p>
<p>ä»¥å‰å†™å‰ç«¯ï¼Œæ•°æ®æ¥äº†ä¾¿æ˜¯æ¥äº†ï¼Œä¸ç®¡è„å‡€ï¼Œæ‹¿æ¥ä¾¿æ¸²æŸ“ã€‚å¯åœ¨ Nest.js é‡Œï¼Œæ•°æ®è¦æƒ³è¿›åŸï¼Œå¾—å…ˆè¿‡ä¸‰é“å…³å¡ã€‚</p>
<p>ç¬¬ä¸€é“å…³ï¼Œåå”¤ <strong>DTOï¼ˆData Transfer Objectï¼‰</strong>ã€‚
è¿™å¥½æ¯”æ˜¯é€šå…³æ–‡ç‰’ã€‚å‰çº¿ä¼ æ¥çš„ JSON æ•°æ®ï¼Œå¿…é¡»ä¸¥ä¸åˆç¼åœ°å¯¹ä¸Š DTO çš„æ ¼å¼ï¼Œå°‘ä¸€ä¸ªå­—æ®µï¼Œå¤šä¸€ä¸ªç±»å‹ï¼Œéƒ½ä¼šè¢«å®ˆåŸå£«å…µå½“åœºæ‹¿ä¸‹ã€‚
â€œç¹çæ˜¯ç¹çäº†äº›ï¼Œâ€æå°‘ä¾ åœ¨å®šä¹‰ <code>CreateUserDto</code> æ—¶å¹é“ï¼Œâ€œä½†å¦‚æ­¤ä¸€æ¥ï¼ŒåŸå†…çš„é€»è¾‘ä¾¿å®‰å¦‚ç£çŸ³ï¼Œä¸å¿…æ‹…å¿ƒæ··å…¥å¥¸ç»†ã€‚â€</p>
<p>ç¬¬äºŒé“å…³ï¼Œåå”¤ <strong>Guardï¼ˆå®ˆå«ï¼‰</strong>ã€‚
è¿™ä¾¿æ˜¯è´Ÿè´£æŸ¥éªŒèº«ä»½çš„é”¦è¡£å«ã€‚
â€œç«™ä½ï¼æ—¢è¦è®¿é—®è¿™ <code>admin</code> è·¯ç”±ï¼Œè…°ç‰Œä½•åœ¨ï¼Ÿâ€
åªéœ€ä¸€ä¸ª <code>@UseGuards(AuthGuard)</code> çš„è£…é¥°å™¨ï¼Œä¾¿èƒ½åœ¨è·¯ç”±ä¹‹å‰ç«‹ä¸‹ä¸€å°Šé—¨ç¥ã€‚JWT ä¾¿æ˜¯é‚£è…°ç‰Œï¼ŒéªŒè¿‡äº†ï¼Œæ–¹èƒ½æ”¾è¡Œï¼›éªŒä¸è¿‡ï¼Œä¾¿æ˜¯ä¸€å¥ <code>401 Unauthorized</code>ï¼Œå†·é¢æ— æƒ…ã€‚</p>
<p>ç¬¬ä¸‰é“å…³ï¼Œåå”¤ <strong>Interceptorï¼ˆæ‹¦æˆªå™¨ï¼‰</strong>ã€‚
è¿™æ›´åƒæ˜¯æ½œä¼åœ¨æš—å¤„çš„è§‚å¯Ÿè€…ã€‚æ•°æ®è¿›å‡ºï¼Œçš†è¦åœ¨å®ƒçœ¼çš®åº•ä¸‹è¿‡ä¸€éã€‚ä½ æƒ³æŠŠè¿”å›çš„æ•°æ®ç»Ÿä¸€åŒ…è£…æˆ <code>{ code: 200, data: ... }</code> çš„æ ¼å¼ï¼Ÿä¸å¿…åœ¨æ¯ä¸ª Controller é‡Œæ‰‹åŠ¨å»å†™ï¼Œåªéœ€åœ¨æ‹¦æˆªå™¨é‡Œè®¾ä¸ªåŸ‹ä¼ï¼Œæ‰€æœ‰å‡ºåŸçš„æ•°æ®ä¾¿è‡ªåŠ¨ç©¿ä¸Šäº†è¿™å±‚åˆ¶æœã€‚</p>
<p>æå°‘ä¾ è€äº†ä¸€å¥— AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰çš„å‰‘æ³•ï¼Œåªè§‰é…£ç•…æ·‹æ¼“ã€‚ä»¥å‰åœ¨å‰ç«¯ä»£ç é‡Œï¼Œä¸šåŠ¡é€»è¾‘å’Œé‰´æƒã€æ—¥å¿—é€»è¾‘æ··ä½œä¸€å›¢ï¼Œå¦‚ä¹±éº»éš¾ç†ï¼›å¦‚ä»Šåœ¨ Nest.js é‡Œï¼Œä¸šåŠ¡å½’ä¸šåŠ¡ï¼Œåˆ‡é¢å½’åˆ‡é¢ï¼Œäº•äº•æœ‰æ¡ï¼Œå¦‚æ’å…µå¸ƒé˜µã€‚</p>
<h2 data-id="heading-4">ç¬¬å››ç« ï¼šå…µå™¨åº“çš„ç§˜å¯†</h2>
<p>çœŸæ­£è®©æå°‘ä¾ æ„Ÿåˆ°éœ‡æ’¼çš„ï¼Œæ˜¯å…µå™¨åº“â€”â€”<strong>TypeORM</strong>ã€‚</p>
<p>ä»¥å¾€æ“ä½œæ•°æ®åº“ï¼Œéœ€å¾—æ‰‹å†™ SQLï¼Œå¦‚åŒèµ¤æ‰‹ç©ºæ‹³å»æè€è™ï¼Œç¨æœ‰ä¸æ…ä¾¿æ˜¯ SQL æ³¨å…¥çš„é‡ä¼¤ã€‚</p>
<p>è€Œ TypeORMï¼Œåˆ™æ˜¯ç»™äº†ä»–ä¸€å¥—æœºç”²ã€‚
ä»–åªéœ€å®šä¹‰ä¸€ä¸ª <strong>Entityï¼ˆå®ä½“ï¼‰</strong> ç±»ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Entity</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> {
  <span class="hljs-meta">@PrimaryGeneratedColumn</span>()
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>;

  <span class="hljs-meta">@Column</span>()
  <span class="hljs-attr">firstName</span>: <span class="hljs-built_in">string</span>;
}
</code></pre>
<p>è¿™ä¾¿æ˜¯ç”¨ TypeScript çš„å®˜è¯ï¼Œå»å·ä»¤æ•°æ®åº“çš„è›®è¯­ã€‚ä¸éœ€è¦æ‡‚ä»€ä¹ˆ <code>SELECT * FROM</code>ï¼Œåªéœ€è°ƒç”¨ <code>userRepository.find()</code>ï¼Œåº•å±‚çš„ SQL æ´ªæµä¾¿å¦‚è‡‚ä½¿æŒ‡ï¼Œå¥”æ¶Œè€Œæ¥ã€‚</p>
<p>â€œè¿™ä¾¿æ˜¯ ORM ä¹‹åŠ›å—ï¼Ÿâ€æå°‘ä¾ æŠšæ‘¸ç€ä»£ç ï¼Œæ„Ÿå—åˆ°äº†é‚£ç§æŒæ§æ•°æ®çš„åšé‡æ„Ÿã€‚</p>
<h2 data-id="heading-5">ç¬¬äº”ç« ï¼šç ´å±€</h2>
<p>ä¸‰ä¸ªæœˆåã€‚</p>
<p>æå°‘ä¾ å†æ¬¡ç«™åœ¨é•¿å®‰åŸçš„æœ±é›€å¤§è¡—ä¸Šã€‚æ­¤æ—¶çš„ä»–ï¼Œå·²ä¸å†æ˜¯é‚£ä¸ªåªä¼šåˆ‡å›¾çš„åˆ€å®¢ã€‚</p>
<p>ä»–çš„è…°é—´ï¼Œå·¦è¾¹æŒ‚ç€ Vue çš„çŸ­å‰‘ï¼Œå³è¾¹ä½©ç€ Nest.js çš„é•¿åˆ€ã€‚</p>
<p>å½“äº§å“ç»ç†å†æ¬¡æå‡ºé‚£ä¸ªâ€œäº”å½©æ–‘æ–“é»‘â€çš„éœ€æ±‚ï¼Œå¹¶è¯´â€œåç«¯å¯èƒ½åšä¸äº†â€æ—¶ï¼Œæå°‘ä¾ å¾®å¾®ä¸€ç¬‘ï¼ŒæŒ‰ä½äº†åˆ€æŸ„ã€‚
â€œæ— å¦¨ï¼Œâ€ä»–æ·¡æ·¡è¯´é“ï¼Œâ€œæ¥å£æˆ‘æ¥å†™ï¼Œæ•°æ®åº“æˆ‘æ¥å»ºã€‚â€</p>
<p>é‚£ä¸€åˆ»ï¼Œé£èµ·äº‘æ¶Œã€‚ä»–ç»ˆäºæ˜ç™½äº†ï¼Œæ‰€è°“çš„å…¨æ ˆï¼Œå¹¶éæ˜¯å¤šå­¦äº†ä¸€é—¨è¯­è¨€ï¼Œè€Œæ˜¯æ‰“ç ´äº†é‚£å µéš”ç»äº†æ•°æ®æºå¤´ä¸å±•ç°æœ«ç«¯çš„å¢™ã€‚</p>
<p>ä»æ­¤ï¼Œæ±Ÿæ¹–ä¸Šå¤šäº†ä¸€ä½èƒ½ä¸Šä¹å¤©æ½æœˆï¼ˆå‰ç«¯ï¼‰ï¼Œå¯ä¸‹äº”æ´‹æ‰é³–ï¼ˆåç«¯ï¼‰çš„æ¸¸ä¾ ã€‚</p>
<p>è€Œ Nest.jsï¼Œä¾¿æ˜¯ä»–æ‰‹ä¸­é‚£æŠŠç ´å±€çš„é’¥åŒ™ã€‚</p>
<hr/>
<p><strong>æ‰¹æ³¨ï¼š</strong>
æ¬²ç»ƒæ­¤åŠŸï¼Œå¿…å…ˆä¿® TypeScriptã€‚è‹¥æ— ç±»å‹ç³»ç»ŸæŠ¤ä½“ï¼ŒNest.js æéš¾å‘æŒ¥åæˆå¨åŠ›ã€‚åˆ‡è®°ï¼Œåˆ‡è®°ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ææ¸…â€˜â€™æ—¶åŒºè®¾ç½®â€˜â€™ä»¥åŠMysqlçš„`DATETIME` å’Œ `TIMESTAMP`]]></title>    <link>https://juejin.cn/post/7587779957675655219</link>    <guid>https://juejin.cn/post/7587779957675655219</guid>    <pubDate>2025-12-26T07:29:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587779957675655219" data-draft-id="7587459328071090186" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ææ¸…â€˜â€™æ—¶åŒºè®¾ç½®â€˜â€™ä»¥åŠMysqlçš„`DATETIME` å’Œ `TIMESTAMP` "/> <meta itemprop="keywords" content="Java,MySQL"/> <meta itemprop="datePublished" content="2025-12-26T07:29:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="èŠ±èŠ±æ— ç¼º"/> <meta itemprop="url" content="https://juejin.cn/user/2021343967862435"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ææ¸…â€˜â€™æ—¶åŒºè®¾ç½®â€˜â€™ä»¥åŠMysqlçš„`DATETIME` å’Œ `TIMESTAMP` 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2021343967862435/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    èŠ±èŠ±æ— ç¼º
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T07:29:53.000Z" title="Fri Dec 26 2025 07:29:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ MySQL ä¸­ï¼Œ<code>DATETIME</code> å’Œ <code>TIMESTAMP</code> æ˜¯ä¸¤ç§å¸¸ç”¨çš„æ—¶é—´ç±»å‹ï¼Œå®ƒä»¬éƒ½èƒ½å­˜å‚¨æ—¥æœŸå’Œæ—¶é—´ï¼ˆæ ¼å¼ä¸º <code>'YYYY-MM-DD HH:MM:SS'</code>ï¼‰ï¼Œä½†åœ¨<strong>å­˜å‚¨æ–¹å¼ã€æ—¶åŒºå¤„ç†ã€å–å€¼èŒƒå›´ã€è‡ªåŠ¨æ›´æ–°è¡Œä¸º</strong>ç­‰æ–¹é¢æœ‰é‡è¦åŒºåˆ«ã€‚</p>
<p><strong>UTC</strong>ï¼ˆ<strong>Coordinated Universal Time</strong>ï¼Œåè°ƒä¸–ç•Œæ—¶ï¼‰æ˜¯å…¨çƒé€šç”¨çš„<strong>æ ‡å‡†æ—¶é—´å‚è€ƒç³»ç»Ÿ</strong>ï¼Œç”¨äºç»Ÿä¸€ä¸–ç•Œå„åœ°çš„æ—¶é—´è¡¨ç¤ºï¼Œé¿å…å› æ—¶åŒºå·®å¼‚é€ æˆæ··ä¹±ã€‚æ‰€æœ‰å…¶ä»–æ—¶åŒºéƒ½ä»¥Â <strong>UTC Â± N å°æ—¶</strong>Â çš„å½¢å¼å®šä¹‰ã€‚<br/>
ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">-</span>   åŒ—äº¬æ—¶é—´ï¼ˆCSTï¼‰ =Â <span class="hljs-strong">**UTC+8**</span>
<span class="hljs-bullet">-</span>   ä¼¦æ•¦å†¬ä»¤æ—¶ï¼ˆGMTï¼‰ =Â <span class="hljs-strong">**UTC+0**</span>
<span class="hljs-bullet">-</span>   çº½çº¦ä¸œéƒ¨æ—¶é—´ï¼ˆESTï¼‰ =Â <span class="hljs-strong">**UTC-5**</span>
</code></pre>
<h2 data-id="heading-0">1.é—®é¢˜å¯¼å‡ºï¼š</h2>
<p>æœ€è¿‘åœ¨å¹³å°é¡µé¢å±•ç¤ºæ—¶é—´ä¸Šå‘ç°å¤„ç†æ—¶é—´ä¸å°‘æ˜¯åœ¨å¤œé‡Œ0:00~8:00ä¹‹é—´çš„å¼‚å¸¸æ—¶é—´ç‚¹ã€‚é€šè¿‡new Date() å½¢å¼insertçš„æ—¶é—´æ•°æ®æ˜¯å¼‚å¸¸çš„(æ—©äº†8å°æ—¶)ï¼›åœ¨sqlä¸­ä½¿ç”¨NOW()çš„updateæ›´æ–°çš„æ—¶é—´æ˜¯æ­£å¸¸æ—¶é—´ï¼›äºæ˜¯æŸ¥äº†æ•°æ®åº“çš„æ—¶åŒºè®¾ç½®ï¼Œæ˜¯UTC+8ï¼Œæ²¡å•¥é—®é¢˜ã€‚å­—æ®µç±»å‹æ˜¯datetimeã€‚æ’æŸ¥è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<p>ï¼ˆ1ï¼‰æŸ¥çœ‹æ•°æ®åº“æ—¶åŒºï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> @<span class="hljs-variable">@global</span>.time_zone <span class="hljs-keyword">AS</span> global_time_zone, @<span class="hljs-variable">@session</span>.time_zone <span class="hljs-keyword">AS</span> session_time_zone;
#ç»“æœå¦‚ä¸‹ï¼š
global_time_zone <span class="hljs-operator">|</span> session_time_zone <span class="hljs-operator">|</span>   <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-comment">---------------- | ----------------- | - |</span>
<span class="hljs-operator">|</span> <span class="hljs-operator">+</span><span class="hljs-number">08</span>:<span class="hljs-number">00</span>          <span class="hljs-operator">|</span> <span class="hljs-operator">+</span><span class="hljs-number">08</span>:<span class="hljs-number">00</span>
</code></pre>
<p>ï¼ˆ2ï¼‰æŸ¥çœ‹ç³»ç»Ÿæ—¶é—´ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@Test</span> public void <span class="hljs-built_in">testTime</span>() {

<span class="hljs-selector-tag">ZonedDateTime</span> <span class="hljs-selector-tag">zonedDateTime</span> = <span class="hljs-selector-tag">ZonedDateTime</span><span class="hljs-selector-class">.now</span>(); <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(zonedDateTime.<span class="hljs-built_in">format</span>(DateTimeFormatter.<span class="hljs-built_in">ofPattern</span>(<span class="hljs-string">"yyyy-MM-dd HH:mm:ss"</span>)));

<span class="hljs-selector-tag">LocalDateTime</span> <span class="hljs-selector-tag">localDateTime</span> = <span class="hljs-selector-tag">LocalDateTime</span><span class="hljs-selector-class">.now</span>(); <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(localDateTime.<span class="hljs-built_in">format</span>(DateTimeFormatter.<span class="hljs-built_in">ofPattern</span>(<span class="hljs-string">"yyyy-MM-dd HH:mm:ss"</span>)));

<span class="hljs-selector-tag">Instant</span> <span class="hljs-selector-tag">instant</span> = <span class="hljs-selector-tag">Instant</span><span class="hljs-selector-class">.now</span>(); <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(instant.<span class="hljs-built_in">atZone</span>(ZoneId.<span class="hljs-built_in">systemDefault</span>()).<span class="hljs-built_in">format</span>(DateTimeFormatter.<span class="hljs-built_in">ofPattern</span>(<span class="hljs-string">"yyyy-MM-dd HH:mm:ss"</span>)));

<span class="hljs-selector-tag">Date</span> <span class="hljs-selector-tag">date</span> = <span class="hljs-selector-tag">new</span> <span class="hljs-selector-tag">Date</span>(); <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(new <span class="hljs-built_in">SimpleDateFormat</span>(<span class="hljs-string">"yyyy-MM-dd HH:mm:ss"</span>).<span class="hljs-built_in">format</span>(date)); }
æ‰“å°ç»“æœéƒ½æ˜¯æ­£ç¡®çš„åŒ—äº¬å½“å‰æ—¶é—´:
<span class="hljs-number">2025</span><span class="hljs-selector-tag">-12-26</span> <span class="hljs-number">10</span>:<span class="hljs-number">37</span>:<span class="hljs-number">55</span> 
<span class="hljs-number">2025</span><span class="hljs-selector-tag">-12-26</span> <span class="hljs-number">10</span>:<span class="hljs-number">37</span>:<span class="hljs-number">59</span> 
<span class="hljs-number">2025</span><span class="hljs-selector-tag">-12-26</span> <span class="hljs-number">10</span>:<span class="hljs-number">38</span>:<span class="hljs-number">06</span> 
<span class="hljs-number">2025</span><span class="hljs-selector-tag">-12-26</span> <span class="hljs-number">10</span>:<span class="hljs-number">38</span>:<span class="hljs-number">16</span>
</code></pre>
<p>ï¼ˆ3ï¼‰æŸ¥JDBCæ—¶åŒºè®¾ç½®ï¼šåé¢æ£€æŸ¥jdbcè®¾ç½®å‘ç°è®¾ç½®çš„æ—¶åŒºæ˜¯ï¼šserverTimezone=UTCï¼Œè€Œä¸æ˜¯serverTimezone=Asia/Shanghai(UTC+8),æ‰€ä»¥ä½¿ç”¨new Date() æ’å…¥æ—¶ï¼Œjdbcå°†æ—¶é—´è½¬æ¢æˆäº†UTCï¼Œä¹Ÿå°±æ˜¯åŒ—äº¬æ—¶é—´-8ã€‚</p>
<h3 data-id="heading-1">é—®é¢˜æœ¬è´¨ï¼š</h3>
<ol>
<li>
<p><code>DATETIME</code> å­—æ®µç‰¹æ€§</p>
<ul>
<li><strong>ä¸å­˜å‚¨æ—¶åŒºä¿¡æ¯</strong> ï¼Œç›´æ¥ä¿å­˜åŸå§‹æ—¶é—´å€¼ã€‚</li>
<li>è¯»å†™æ—¶<strong>ä¾èµ– JDBC æ—¶åŒºé…ç½®</strong> å’Œ<strong>æ•°æ®åº“æœåŠ¡å™¨æ—¶åŒº</strong> è¿›è¡Œéšå¼è½¬æ¢ã€‚</li>
</ul>
</li>
<li>
<p><strong>å†å²æ•°æ®çš„ä¸¤ç§æ¥æº</strong></p>
<ul>
<li>
<p><strong><code>new Date()</code> æ’å…¥</strong> ï¼š</p>
<ul>
<li><code>Date</code> æœ¬è´¨æ˜¯ UTC æ—¶é—´æˆ³ï¼ˆå¦‚ <code>2025-12-26 10:38:16 UTC+8</code> â†’ å­˜å‚¨ä¸º <code>2025-12-26 02:38:16</code>ï¼‰ã€‚</li>
<li>åŸ JDBC é…ç½® <code>serverTimezone=UTC</code> ä¼šå°† <code>Date</code> çš„æ¯«ç§’æ•°è½¬æ¢ä¸º UTC æ—¶é—´å­˜å…¥æ•°æ®åº“ã€‚</li>
</ul>
</li>
<li>
<p><strong><code>NOW()</code> æ’å…¥</strong> ï¼š</p>
<ul>
<li>MySQL çš„ <code>NOW()</code> è¿”å›æœåŠ¡å™¨æœ¬åœ°æ—¶é—´ï¼ˆUTC+8ï¼‰ï¼Œç›´æ¥å­˜å…¥ <code>DATETIME</code>ï¼ˆå¦‚ <code>2025-12-26 10:38:16</code>ï¼‰ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>ä¿®æ”¹ <code>serverTimezone=Asia/Shanghai</code> åçš„å½±å“</strong></p>
<ul>
<li>JDBC é©±åŠ¨ä¼šè®¤ä¸ºæ•°æ®åº“å­˜å‚¨çš„æ˜¯ <code>UTC+8</code> æ—¶é—´ã€‚</li>
<li><strong><code>new Date()</code> æ’å…¥çš„æ•°æ®</strong> ï¼ˆåŸ UTC æ—¶é—´ï¼‰ä¼šè¢«è¯¯è®¤ä¸ºæ˜¯ <code>UTC+8</code> æ—¶é—´ï¼Œå¯¼è‡´æ˜¾ç¤ºé”™è¯¯ï¼ˆå¦‚å­˜å‚¨ <code>02:38:16</code> â†’ æ˜¾ç¤ºä¸º <code>02:38:16</code>ï¼Œè€Œå®é™…åº”æ˜¾ç¤º <code>10:38:16</code>ï¼‰ã€‚</li>
<li><strong><code>NOW()</code> æ’å…¥çš„æ•°æ®</strong> ï¼ˆåŸ UTC+8 æ—¶é—´ï¼‰æ˜¾ç¤ºæ­£å¸¸ã€‚</li>
</ul>
</li>
</ol>
<h2 data-id="heading-2">2. è§£å†³æ–¹æ¡ˆ</h2>
<h4 data-id="heading-3"><strong>æ­¥éª¤ 1ï¼šä¿®æ”¹ JDBC è¿æ¥æ—¶åŒº</strong></h4>
<p>å°†è¿æ¥å‚æ•°ä» <code>serverTimezone=UTC</code> æ”¹ä¸º <code>serverTimezone=Asia/Shanghai</code>ï¼š</p>
<h4 data-id="heading-4"><strong>æ­¥éª¤ 2ï¼šä¿®æ­£ <code>new Date()</code> æ’å…¥çš„å†å²æ•°æ®</strong></h4>
<p>éœ€è¦å°†å†å²æ•°æ®ä¸­æ‰€æœ‰ <strong>UTC æ—¶é—´å­˜å‚¨çš„ <code>DATETIME</code> å€¼</strong> è½¬æ¢ä¸º <code>UTC+8</code> æ—¶é—´ï¼ˆå¢åŠ  8 å°æ—¶ï¼‰ã€‚</p>
<blockquote>
<p>è¯´èµ·æ¥å®¹æ˜“ï¼Œä½†æ˜¯å†å²æ•°æ®çš„åŒºåˆ†æœ‰ç‚¹å›°éš¾ï¼Œè¿˜å¥½æˆ‘ä»¬ç”¨çš„datetime(6) ï¼Œèƒ½ç²¾ç¡®åˆ°æ¯«ç§’çº§ç²¾åº¦ï¼Œé€šè¿‡NOW()æ’å…¥çš„éƒ½æ˜¯ç§’çº§ç²¾åº¦,ä»¥æ­¤èƒ½åŒºåˆ†</p>
</blockquote>
<h2 data-id="heading-5">3.<code>DATETIME</code> å’Œ <code>TIMESTAMP</code> å¯¹æ¯”</h2>
<h3 data-id="heading-6">3.1ã€åŸºæœ¬å¯¹æ¯”è¡¨</h3>








































<table><thead><tr><th>ç‰¹æ€§</th><th><code>DATETIME</code></th><th><code>TIMESTAMP</code></th></tr></thead><tbody><tr><td><strong>å­˜å‚¨æ ¼å¼</strong></td><td><code>'YYYY-MM-DD HH:MM:SS'</code></td><td>åŒå·¦ï¼ˆæ˜¾ç¤ºæ ¼å¼ç›¸åŒï¼‰</td></tr><tr><td><strong>å­˜å‚¨ç©ºé—´</strong></td><td>8 å­—èŠ‚</td><td>4 å­—èŠ‚</td></tr><tr><td><strong>å–å€¼èŒƒå›´</strong></td><td><code>'1000-01-01 00:00:00'</code>Â åˆ°Â <code>'9999-12-31 23:59:59'</code></td><td><code>'1970-01-01 00:00:01' UTC</code>Â åˆ°Â <code>'2038-01-19 03:14:07' UTC</code></td></tr><tr><td><strong>æ—¶åŒºæ•æ„Ÿ</strong></td><td>âŒ ä¸æ¶‰åŠæ—¶åŒºï¼Œå­˜å‚¨çš„å°±æ˜¯ä½ ç»™çš„å€¼</td><td>âœ… å­˜å‚¨æ—¶è½¬æ¢ä¸º UTCï¼Œè¯»å–æ—¶è½¬å›å½“å‰ä¼šè¯æ—¶åŒº</td></tr><tr><td><strong>è‡ªåŠ¨åˆå§‹åŒ–/æ›´æ–°</strong></td><td>MySQL 5.6.5+ æ”¯æŒï¼ˆéœ€æ˜¾å¼å£°æ˜ï¼‰</td><td>é»˜è®¤æ”¯æŒï¼ˆå¦‚Â <code>DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP</code>ï¼‰</td></tr><tr><td><strong>è·¨æ—¶åŒºä¸€è‡´æ€§</strong></td><td>ä¸ä¸€è‡´ï¼ˆåŸæ ·å­˜å‚¨ï¼‰</td><td>ä¸€è‡´ï¼ˆè‡ªåŠ¨è½¬æ¢ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-7">3.2.Â <strong>æ—¶åŒºå¤„ç†</strong></h3>
<ul>
<li>
<p><strong><code>DATETIME</code></strong>ï¼š<br/>
å®Œå…¨ä¸æ—¶åŒºæ— å…³ã€‚ä½ æ’å…¥ <code>'2025-12-25 18:00:00'</code>ï¼Œå®ƒå°±å­˜è¿™ä¸ªå€¼ï¼Œæ— è®ºæœåŠ¡å™¨æˆ–å®¢æˆ·ç«¯æ—¶åŒºå¦‚ä½•å˜åŒ–ï¼Œè¯»å‡ºæ¥è¿˜æ˜¯ <code>'2025-12-25 18:00:00'</code>ã€‚</p>
</li>
<li>
<p><strong><code>TIMESTAMP</code></strong>ï¼š</p>
<ul>
<li>
<p>æ’å…¥æ—¶ï¼šå°†å½“å‰<strong>ä¼šè¯æ—¶åŒº</strong>ä¸‹çš„æ—¶é—´è½¬æ¢ä¸ºÂ <strong>UTC</strong>Â å­˜å‚¨ã€‚</p>
</li>
<li>
<p>æŸ¥è¯¢æ—¶ï¼šå°† UTC æ—¶é—´è½¬æ¢å›<strong>å½“å‰ä¼šè¯æ—¶åŒº</strong>å†æ˜¾ç¤ºã€‚</p>
</li>
<li>
<p>ä¸¾ä¾‹ï¼š</p>
<ul>
<li>æœåŠ¡å™¨æ—¶åŒºæ˜¯Â <code>+08:00</code>ï¼ˆä¸­å›½ï¼‰ï¼Œä½ æ’å…¥Â <code>'2025-12-25 18:00:00'</code>ï¼ŒMySQL å®é™…å­˜çš„æ˜¯ UTC æ—¶é—´Â <code>'2025-12-25 10:00:00'</code>ã€‚</li>
<li>å¦‚æœä¹‹åæŠŠä¼šè¯æ—¶åŒºæ”¹ä¸ºÂ <code>+00:00</code>ï¼Œå†æŸ¥è¿™æ¡è®°å½•ï¼Œä¼šæ˜¾ç¤ºä¸ºÂ <code>'2025-12-25 10:00:00'</code>ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>é€‚åˆéœ€è¦â€œå…¨çƒç»Ÿä¸€æ—¶é—´è®°å½•â€çš„åœºæ™¯ï¼ˆå¦‚æ—¥å¿—ã€äº¤æ˜“æ—¶é—´ï¼‰ã€‚</p>
<p>æ³¨æ„ï¼š<code>TIMESTAMP</code> çš„è¡Œä¸ºä¾èµ–äº <code>time_zone</code> è®¾ç½®ï¼Œè€Œ <code>DATETIME</code> ä¸å—å½±å“ã€‚</p>
</blockquote>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">sql</span>
ç¼–è¾‘
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> time_demo (
    id <span class="hljs-type">INT</span>,
    dt DATETIME,
    ts <span class="hljs-type">TIMESTAMP</span>
);

<span class="hljs-comment">-- å‡è®¾å½“å‰æ—¶åŒºæ˜¯ +08:00</span>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> time_demo <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-string">'2025-12-25 18:00:00'</span>, <span class="hljs-string">'2025-12-25 18:00:00'</span>);

<span class="hljs-comment">-- æŸ¥è¯¢ç»“æœï¼ˆæ—¶åŒº +08:00ï¼‰ï¼š</span>
<span class="hljs-comment">-- dt: 2025-12-25 18:00:00</span>
<span class="hljs-comment">-- ts: 2025-12-25 18:00:00</span>

<span class="hljs-comment">-- åˆ‡æ¢æ—¶åŒºåˆ° UTC</span>
<span class="hljs-keyword">SET</span> time_zone <span class="hljs-operator">=</span> <span class="hljs-string">'+00:00'</span>;

<span class="hljs-comment">-- å†æ¬¡æŸ¥è¯¢ï¼š</span>
<span class="hljs-comment">-- dt: 2025-12-25 18:00:00 ï¼ˆä¸å˜ï¼‰</span>
<span class="hljs-comment">-- ts: 2025-12-25 10:00:00 ï¼ˆè‡ªåŠ¨è½¬ä¸º UTCï¼‰</span>
</code></pre>
<h3 data-id="heading-8">3.3Â <strong>å–å€¼èŒƒå›´</strong></h3>
<ul>
<li><code>TIMESTAMP</code>Â å—é™äº Unix æ—¶é—´æˆ³ï¼ˆ32 ä½æ•´æ•°ï¼‰ï¼Œæœ€å¤§åˆ°Â <strong>2038 å¹´</strong>ï¼ˆå³â€œ2038 å¹´é—®é¢˜â€ï¼‰ã€‚</li>
<li><code>DATETIME</code>Â èŒƒå›´æå¤§ï¼Œé€‚ç”¨äºå†å²æˆ–è¿œæœŸæ—¥æœŸã€‚</li>
</ul>
<blockquote>
<p>å¦‚æœä½ çš„åº”ç”¨éœ€è¦å¤„ç† 2038 å¹´ä¹‹åçš„æ—¶é—´ï¼ˆæ¯”å¦‚åˆåŒã€è®¡åˆ’ï¼‰ï¼Œ<strong>ä¸è¦ç”¨ <code>TIMESTAMP</code></strong>ã€‚</p>
</blockquote>
<h3 data-id="heading-9">3.4Â <strong>è‡ªåŠ¨é»˜è®¤å€¼ä¸æ›´æ–°</strong></h3>
<ul>
<li>
<p>åœ¨æ—§ç‰ˆæœ¬ MySQLï¼ˆ&lt;5.6.5ï¼‰ä¸­ï¼Œåªæœ‰Â <code>TIMESTAMP</code>Â æ”¯æŒï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">sql</span>
ç¼–è¾‘
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t (
    id <span class="hljs-type">INT</span>,
    created_at <span class="hljs-type">TIMESTAMP</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>,
    updated_at <span class="hljs-type">TIMESTAMP</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">UPDATE</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>
);
</code></pre>
</li>
<li>
<p>ä»Â <strong>MySQL 5.6.5 å¼€å§‹</strong>ï¼Œ<code>DATETIME</code>Â ä¹Ÿæ”¯æŒç±»ä¼¼è¯­æ³•ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">sql</span>
ç¼–è¾‘
created_at DATETIME <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>,
updated_at DATETIME <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">UPDATE</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>
</code></pre>
</li>
</ul>
<h3 data-id="heading-10">3.5ã€å¦‚ä½•é€‰æ‹©ï¼Ÿ</h3>

























<table><thead><tr><th>åœºæ™¯</th><th>æ¨èç±»å‹</th></tr></thead><tbody><tr><td>éœ€è¦è®°å½•äº‹ä»¶å‘ç”Ÿçš„<strong>ç»å¯¹æœ¬åœ°æ—¶é—´</strong>ï¼ˆå¦‚ç”¨æˆ·æ³¨å†Œæ—¶é—´ã€æ–‡ç« å‘å¸ƒæ—¶é—´ï¼‰ï¼Œä¸”ä¸å…³å¿ƒæ—¶åŒºè½¬æ¢</td><td><code>DATETIME</code></td></tr><tr><td>éœ€è¦<strong>è·¨æ—¶åŒºä¸€è‡´çš„æ—¶é—´è®°å½•</strong>ï¼ˆå¦‚ç³»ç»Ÿæ—¥å¿—ã€API è¯·æ±‚æ—¶é—´ï¼‰ï¼Œå¸Œæœ›è‡ªåŠ¨å¤„ç†æ—¶åŒº</td><td><code>TIMESTAMP</code></td></tr><tr><td>æ—¶é—´å¯èƒ½è¶…è¿‡ 2038 å¹´</td><td><code>DATETIME</code></td></tr><tr><td>å­˜å‚¨ç©ºé—´æ•æ„Ÿï¼ˆä½†é€šå¸¸å½±å“ä¸å¤§ï¼‰</td><td><code>TIMESTAMP</code>ï¼ˆçœ 4 å­—èŠ‚ï¼‰</td></tr></tbody></table>
<p>é™„bç«™@<a href="https://link.juejin.cn?target=https%3A%2F%2Fspace.bilibili.com%2F386498238%2F%3Fspm_id_from%3D333.788.upinfo.detail.click" target="_blank" title="https://space.bilibili.com/386498238/?spm_id_from=333.788.upinfo.detail.click" ref="nofollow noopener noreferrer">ç¨‹åºå‘˜é¸¡ç¿…</a>æ€»ç»“ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/52e92bb10bc046e5ac0f7039c1bf83b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Iqx6Iqx5peg57y6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767338993&amp;x-signature=8C%2FP8WLIj8EWQDs7GGj0HY95vDg%3D" alt="img_v3_02ta_60aa75f5-aa63-432d-b4ca-0d953fe4e7eg.jpg" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e3432e9842ad47009321536e02f3e515~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Iqx6Iqx5peg57y6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767338993&amp;x-signature=mzkdhkW3xRtLi9%2FHcRp9nIR5UAI%3D" alt="img_v3_02ta_aa10f24b-b3ab-4987-b0d6-2d408d91eecg.jpg" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5c51ca466f224191a707db72c5b1fcfe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Iqx6Iqx5peg57y6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767338993&amp;x-signature=IpJk73jDsRgBO8oW8glVQ%2FrgVSA%3D" alt="img_v3_02ta_7d6a7c70-8002-4da0-93c8-3e0dcfa0918g.jpg" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ”¥ğŸ”¥Vueæ•°å­—ç¿»æ»šåŠ¨ç”»ç»„ä»¶ï¼šè®©æ•°æ®å±•ç¤ºæ›´å…·è§†è§‰å†²å‡»åŠ›]]></title>    <link>https://juejin.cn/post/7587825268200652806</link>    <guid>https://juejin.cn/post/7587825268200652806</guid>    <pubDate>2025-12-26T07:34:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587825268200652806" data-draft-id="7587825267878576169" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ”¥ğŸ”¥Vueæ•°å­—ç¿»æ»šåŠ¨ç”»ç»„ä»¶ï¼šè®©æ•°æ®å±•ç¤ºæ›´å…·è§†è§‰å†²å‡»åŠ›"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js"/> <meta itemprop="datePublished" content="2025-12-26T07:34:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åŒå­¦80796"/> <meta itemprop="url" content="https://juejin.cn/user/1662117312735943"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ”¥ğŸ”¥Vueæ•°å­—ç¿»æ»šåŠ¨ç”»ç»„ä»¶ï¼šè®©æ•°æ®å±•ç¤ºæ›´å…·è§†è§‰å†²å‡»åŠ›
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1662117312735943/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åŒå­¦80796
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T07:34:36.000Z" title="Fri Dec 26 2025 07:34:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨æ•°æ®å¯è§†åŒ–åœºæ™¯ä¸­ï¼Œé™æ€çš„æ•°å­—å±•ç¤ºå¾€å¾€éš¾ä»¥å¸å¼•ç”¨æˆ·æ³¨æ„åŠ›ã€‚æ— è®ºæ˜¯å¤§å±ç›‘æ§é¢æ¿ã€æ•°æ®ä»ªè¡¨ç›˜è¿˜æ˜¯æ´»åŠ¨å€’è®¡æ—¶é¡µé¢ï¼ŒåŠ¨æ€çš„æ•°å­—å˜åŒ–æ€»èƒ½æ›´ç›´è§‚åœ°ä¼ é€’æ•°æ®å¢é•¿æˆ–æ›´æ–°çš„ä¿¡æ¯ã€‚ä»Šå¤©ä¸ºå¤§å®¶ä»‹ç»ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§ã€é…ç½®çµæ´»çš„Vueæ•°å­—ç¿»æ»šåŠ¨ç”»ç»„ä»¶ï¼Œå®ƒèƒ½è½»æ¾å®ç°å¹³æ»‘çš„æ•°å­—æ»šåŠ¨æ•ˆæœï¼ŒåŒæ—¶æ”¯æŒå¤šç»´åº¦è‡ªå®šä¹‰é…ç½®ï¼Œé€‚é…å„ç±»ä¸šåŠ¡åœºæ™¯ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b133a331ebd84f59ae4c5ebe2e1de8d9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCM5a2mODA3OTY=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339276&amp;x-signature=jKiOcFskkGg0eNOalULd8h5Ultk%3D" alt="PixPin_2025-12-26_15-09-38.gif" loading="lazy"/></p>
<h2 data-id="heading-0">ä¸€ã€ç»„ä»¶å®šä½ä¸æ ¸å¿ƒä»·å€¼</h2>
<p>è¿™æ¬¾Vueæ•°å­—ç¿»æ»šåŠ¨ç”»ç»„ä»¶åŸºäº<code>writing-mode</code>å‚ç›´æ’ç‰ˆåŸç†å®ç°ï¼Œæ ¸å¿ƒä»·å€¼åœ¨äºå°†æ¯ç‡¥çš„æ•°å­—æ›´æ–°è½¬åŒ–ä¸ºæµç•…ã€æœ‰è´¨æ„Ÿçš„ç¿»æ»šåŠ¨ç”»ï¼Œæå‡é¡µé¢çš„è§†è§‰è¡¨ç°åŠ›ä¸ç”¨æˆ·ä½“éªŒã€‚ä¸ä¼ ç»Ÿçš„æ•°å­—åˆ‡æ¢æ•ˆæœç›¸æ¯”ï¼Œå®ƒå…·å¤‡ä»¥ä¸‹æ ¸å¿ƒä¼˜åŠ¿ï¼š</p>
<ul>
<li><strong>è§†è§‰å¸å¼•åŠ›å¼º</strong>ï¼šæ¨¡æ‹Ÿæœºæ¢°è®¡æ•°å™¨çš„ç¿»æ»šæ•ˆæœï¼Œæ•°å­—åˆ‡æ¢å¹³æ»‘è‡ªç„¶ï¼Œç¬é—´æŠ“ä½ç”¨æˆ·çœ¼çƒï¼›</li>
<li><strong>é…ç½®æåº¦çµæ´»</strong>ï¼šæ”¯æŒä½æ•°ã€å‰ç½®é›¶ã€åˆ†éš”ç¬¦ã€åŠ¨ç”»æ—¶é•¿ç­‰å¤šç»´åº¦è‡ªå®šä¹‰ï¼Œé€‚é…ä¸åŒä¸šåŠ¡éœ€æ±‚ï¼›</li>
<li><strong>å…¼å®¹æ€§ä¼˜å¼‚</strong>ï¼šé€‚é…ä¸»æµæµè§ˆå™¨ï¼Œé’ˆå¯¹Firefoxç­‰æµè§ˆå™¨åšäº†ä¸“é¡¹å…¼å®¹æ€§ä¼˜åŒ–ï¼›</li>
<li><strong>æ˜“ç”¨æ€§é«˜</strong>ï¼šç»„ä»¶åŒ–å°è£…ï¼Œä¼ å…¥ç®€å•å‚æ•°å³å¯å¿«é€Ÿä½¿ç”¨ï¼Œæ— éœ€å…³æ³¨å¤æ‚çš„å®ç°ç»†èŠ‚ã€‚</li>
</ul>
<h2 data-id="heading-1">äºŒã€æ ¸å¿ƒåŠŸèƒ½è¯¦è§£</h2>
<p>ç»„ä»¶å›´ç»•â€œæ•°å­—å±•ç¤ºâ€ä¸â€œåŠ¨ç”»æ•ˆæœâ€ä¸¤å¤§æ ¸å¿ƒï¼Œæä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½é…ç½®ï¼Œè¦†ç›–ä»åŸºç¡€å±•ç¤ºåˆ°é«˜çº§å®šåˆ¶çš„å…¨åœºæ™¯éœ€æ±‚ã€‚</p>
<h3 data-id="heading-2">1. åŸºç¡€æ ¸å¿ƒåŠŸèƒ½</h3>
<ul>
<li><strong>å¹³æ»‘ç¿»æ»šåŠ¨ç”»</strong>ï¼šåŸºäºCSSè¿‡æ¸¡åŠ¨ç”»å®ç°ï¼Œæ•°å­—åˆ‡æ¢æ— å¡é¡¿ï¼Œæ”¯æŒè‡ªå®šä¹‰åŠ¨ç”»æ—¶é•¿ï¼›</li>
<li><strong>è‡ªåŠ¨å¢é•¿æ¨¡æ‹Ÿ</strong>ï¼šå¯é…ç½®è‡ªåŠ¨å¢é•¿åŠŸèƒ½ï¼Œæ”¯æŒè‡ªå®šä¹‰å¢é•¿é—´éš”ä¸å¢é•¿æ•°å€¼èŒƒå›´ï¼Œå®Œç¾æ¨¡æ‹Ÿå®æ—¶æ•°æ®æ›´æ–°åœºæ™¯ï¼›</li>
<li><strong>é‡‘é¢æ ¼å¼åŒ–</strong>ï¼šè‡ªåŠ¨æ·»åŠ åƒåˆ†ä½åˆ†éš”ç¬¦ï¼Œè®©å¤§æ•°å­—å±•ç¤ºæ›´æ¸…æ™°ï¼ˆå¦‚123456 â†’ 123,456ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-3">2. çµæ´»çš„æ•°å­—æ˜¾ç¤ºé…ç½®</h3>
<p>é’ˆå¯¹ä¸åŒåœºæ™¯ä¸‹çš„æ•°å­—å±•ç¤ºéœ€æ±‚ï¼Œç»„ä»¶æä¾›äº†ä¸‰å¤§æ ¸å¿ƒé…ç½®é¡¹ï¼Œå®ç°æ•°å­—æ˜¾ç¤ºçš„ç²¾å‡†æ§åˆ¶ï¼š</p>
<ul>
<li><strong>ä½æ•°å¯é…ç½®ï¼ˆdigitLengthï¼‰</strong> ï¼šæ”¯æŒ1-18ä½æ•°å­—æ˜¾ç¤ºï¼Œé»˜è®¤8ä½ï¼Œå¯æ ¹æ®ä¸šåŠ¡åœºæ™¯ï¼ˆå¦‚éªŒè¯ç 4ä½ã€è®¢å•å·8ä½ã€é”€å”®é¢10ä½ï¼‰çµæ´»è°ƒæ•´ï¼›</li>
<li><strong>å‰ç½®é›¶æ§åˆ¶ï¼ˆshowLeadingZeroï¼‰</strong> ï¼šå¯é…ç½®æ˜¯å¦æ˜¾ç¤ºå‰ç½®é›¶ï¼ˆæˆ–åç½®é›¶ï¼‰ï¼Œä¾‹å¦‚é…ç½®8ä½æ•°å­—æ—¶ï¼Œ123å¯æ˜¾ç¤ºä¸º00000123ï¼ˆæ˜¾ç¤ºå‰ç½®é›¶ï¼‰æˆ–123ï¼ˆä¸æ˜¾ç¤ºå‰ç½®é›¶ï¼‰ï¼›</li>
<li><strong>è¡¥é›¶æ–¹å‘ï¼ˆpadDirectionï¼‰</strong> ï¼šæ”¯æŒå·¦è¡¥é›¶ï¼ˆé»˜è®¤ï¼‰ä¸å³è¡¥é›¶ï¼Œé€‚é…ç¼–ç ã€éªŒè¯ç ç­‰ç‰¹æ®Šåœºæ™¯çš„éœ€æ±‚ã€‚</li>
</ul>
<h3 data-id="heading-4">3. æ ·å¼ä¸äº¤äº’ä¼˜åŒ–</h3>
<ul>
<li><strong>å“åº”å¼é€‚é…</strong>ï¼šå°å±å¹•è‡ªåŠ¨è°ƒæ•´æ•°å­—æ¡†å¤§å°ä¸å­—ä½“å¤§å°ï¼Œç¡®ä¿å¤šä½æ•°å±•ç¤ºæ—¶ä¸æ¢è¡Œã€ä¸æ‹¥æŒ¤ï¼›</li>
<li><strong>è´¨æ„Ÿæ ·å¼è®¾è®¡</strong>ï¼šé‡‡ç”¨æ¸å˜èƒŒæ™¯ã€æ–‡å­—é˜´å½±ç­‰è®¾è®¡ï¼Œè¥é€ ç§‘æŠ€æ„Ÿï¼Œé€‚é…å¤§å±ç›‘æ§ã€æ•°æ®ä»ªè¡¨ç›˜ç­‰åœºæ™¯ï¼›</li>
<li><strong>ç”¨æˆ·ä½“éªŒä¼˜åŒ–</strong>ï¼šç¦æ­¢æ•°å­—é€‰ä¸­ï¼Œé¿å…æ»šåŠ¨è¿‡ç¨‹ä¸­è¯¯æ“ä½œï¼Œæå‡äº¤äº’æµç•…åº¦ã€‚</li>
</ul>
<h2 data-id="heading-5">ä¸‰ã€å¿«é€Ÿä¸Šæ‰‹æŒ‡å—</h2>
<p>ç»„ä»¶åŸºäºVue3 + TypeScriptå¼€å‘ï¼Œæ”¯æŒ<code>script setup</code>è¯­æ³•ï¼Œé›†æˆè¿‡ç¨‹ç®€å•é«˜æ•ˆï¼Œä¸‰æ­¥å³å¯å®Œæˆé›†æˆã€‚</p>
<h3 data-id="heading-6">1. ç»„ä»¶å¼•å…¥</h3>
<p>å°†ç»„ä»¶æ–‡ä»¶ï¼ˆå¦‚NumberRoll.vueï¼‰æ”¾å…¥é¡¹ç›®ç»„ä»¶ç›®å½•ï¼Œåœ¨éœ€è¦ä½¿ç”¨çš„é¡µé¢ä¸­ç›´æ¥å¼•å…¥ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> <span class="hljs-title class_">NumberRoll</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/NumberRoll.vue'</span>;
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h3 data-id="heading-7">2. åŸºç¡€ä½¿ç”¨</h3>
<p>ä¼ å…¥æ ¸å¿ƒå‚æ•°<code>number</code>å³å¯å®ç°åŸºç¡€çš„æ•°å­—ç¿»æ»šæ•ˆæœï¼Œé»˜è®¤8ä½æ•°å­—ã€æ˜¾ç¤ºå‰ç½®é›¶ã€è‡ªåŠ¨å¢é•¿ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"dashboard"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>æ€»è®¿é—®é‡ <span class="hljs-tag">&lt;<span class="hljs-name">NumberRoll</span> <span class="hljs-attr">:number</span>=<span class="hljs-string">"12345"</span> /&gt;</span> æ¬¡<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<h3 data-id="heading-8">3. æ•ˆæœé¢„è§ˆ</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/93aa36c7ce314e00a9b105dd15d934bf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCM5a2mODA3OTY=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339276&amp;x-signature=KMwDhvTSzwBTcyfcmJSW8pDqOoc%3D" alt="PixPin_2025-12-26_15-11-05.gif" loading="lazy"/></p>
<p>ä¸Šè¿°ä»£ç å°†å®ç°8ä½æ•°å­—ç¿»æ»šæ•ˆæœï¼Œåˆå§‹æ˜¾ç¤º00001234ï¼Œåç»­æ¯3ç§’éšæœºå¢é•¿1-100ï¼Œæ•°å­—æ»šåŠ¨å¹³æ»‘è‡ªç„¶ï¼Œå¸¦æœ‰ç§‘æŠ€æ„Ÿæ ·å¼ã€‚</p>
<h2 data-id="heading-9">å››ã€è¿›é˜¶é…ç½®ç¤ºä¾‹</h2>
<p>é’ˆå¯¹ä¸åŒä¸šåŠ¡åœºæ™¯ï¼Œç»„ä»¶æä¾›äº†ä¸°å¯Œçš„é…ç½®ç»„åˆï¼Œä»¥ä¸‹æ˜¯å‡ ä¸ªå…¸å‹åœºæ™¯çš„é…ç½®ç¤ºä¾‹ï¼Œè¦†ç›–å¤§éƒ¨åˆ†å¸¸è§éœ€æ±‚ã€‚</p>
<h3 data-id="heading-10">1. åœºæ™¯ä¸€ï¼š4ä½éªŒè¯ç ï¼ˆä¸è‡ªåŠ¨å¢é•¿ã€å³è¡¥é›¶ï¼‰</h3>
<p>éœ€æ±‚ï¼š4ä½éªŒè¯ç ï¼Œå³è¡¥é›¶ï¼Œä¸è‡ªåŠ¨å¢é•¿ï¼Œä¸æ˜¾ç¤ºåˆ†éš”ç¬¦</p>
<pre><code class="hljs language-ini" lang="ini">&lt;NumberRoll 
  :<span class="hljs-attr">number</span>=<span class="hljs-string">"123"</span> 
  :<span class="hljs-attr">digit-length</span>=<span class="hljs-string">"4"</span> 
  <span class="hljs-attr">pad-direction</span>=<span class="hljs-string">"right"</span> 
  :<span class="hljs-attr">auto-increase</span>=<span class="hljs-string">"false"</span> 
  :<span class="hljs-attr">show-separator</span>=<span class="hljs-string">"false"</span> 
/&gt;
</code></pre>
<p>æ•ˆæœï¼šæ˜¾ç¤º1230ï¼Œæ— è‡ªåŠ¨å¢é•¿ï¼Œæ•°å­—å›ºå®šå±•ç¤ºã€‚</p>
<h3 data-id="heading-11">2. åœºæ™¯äºŒï¼šé”€å”®é¢å±•ç¤ºï¼ˆ10ä½ã€ä¸æ˜¾ç¤ºå‰ç½®é›¶ã€è‡ªå®šä¹‰åŠ¨ç”»æ—¶é•¿ï¼‰</h3>
<p>éœ€æ±‚ï¼š10ä½é”€å”®é¢ï¼Œä¸æ˜¾ç¤ºå‰ç½®é›¶ï¼ŒåŠ¨ç”»æ—¶é•¿2ç§’ï¼Œè‡ªåŠ¨å¢é•¿é—´éš”5ç§’</p>
<pre><code class="hljs language-ruby" lang="ruby">&lt;<span class="hljs-title class_">NumberRoll</span> 
  <span class="hljs-symbol">:number=<span class="hljs-string">"987654321"</span></span> 
  <span class="hljs-symbol">:digit-length=<span class="hljs-string">"10"</span></span> 
  <span class="hljs-symbol">:show-leading-zero=<span class="hljs-string">"false"</span></span> 
  <span class="hljs-symbol">:duration=<span class="hljs-string">"2"</span></span> 
  <span class="hljs-symbol">:increase-interval=<span class="hljs-string">"5000"</span></span> 
/&gt;
</code></pre>
<p>æ•ˆæœï¼šåˆå§‹æ˜¾ç¤º987,654,321ï¼Œæ¯5ç§’éšæœºå¢é•¿1-100ï¼Œæ•°å­—åˆ‡æ¢åŠ¨ç”»æ—¶é•¿2ç§’ã€‚</p>
<h3 data-id="heading-12">3. åœºæ™¯ä¸‰ï¼šåœ¨çº¿äººæ•°ï¼ˆ3ä½ã€ä¸æ˜¾ç¤ºå‰ç½®é›¶ã€å…³é—­è‡ªåŠ¨å¢é•¿ï¼‰</h3>
<p>éœ€æ±‚ï¼š3ä½åœ¨çº¿äººæ•°ï¼Œä¸æ˜¾ç¤ºå‰ç½®é›¶ï¼Œå›ºå®šæ˜¾ç¤ºå½“å‰äººæ•°ï¼Œæ— è‡ªåŠ¨å¢é•¿</p>
<pre><code class="hljs language-ruby" lang="ruby">&lt;<span class="hljs-title class_">NumberRoll</span> 
  <span class="hljs-symbol">:number=<span class="hljs-string">"896"</span></span> 
  <span class="hljs-symbol">:digit-length=<span class="hljs-string">"3"</span></span> 
  <span class="hljs-symbol">:show-leading-zero=<span class="hljs-string">"false"</span></span> 
  <span class="hljs-symbol">:auto-increase=<span class="hljs-string">"false"</span></span> 
  <span class="hljs-symbol">:show-separator=<span class="hljs-string">"false"</span></span> 
/&gt;
</code></pre>
<p>æ•ˆæœï¼šå›ºå®šæ˜¾ç¤º896ï¼Œæ— æ»šåŠ¨åŠ¨ç”»ï¼Œç®€æ´æ¸…æ™°ã€‚</p>
<h3 data-id="heading-13">4. åœºæ™¯å››ï¼šè®¢å•ç¼–å·ï¼ˆ8ä½ã€æ˜¾ç¤ºå‰ç½®é›¶ã€å…³é—­è‡ªåŠ¨å¢é•¿ï¼‰</h3>
<p>éœ€æ±‚ï¼š8ä½è®¢å•ç¼–å·ï¼Œå¿…é¡»æ˜¾ç¤ºå‰ç½®é›¶ï¼Œå›ºå®šç¼–å·ï¼Œæ— è‡ªåŠ¨å¢é•¿</p>
<pre><code class="hljs language-ruby" lang="ruby">&lt;<span class="hljs-title class_">NumberRoll</span> 
  <span class="hljs-symbol">:number=<span class="hljs-string">"12345"</span></span> 
  <span class="hljs-symbol">:digit-length=<span class="hljs-string">"8"</span></span> 
  <span class="hljs-symbol">:auto-increase=<span class="hljs-string">"false"</span></span> 
/&gt;
</code></pre>
<p>æ•ˆæœï¼šå›ºå®šæ˜¾ç¤º00001234ï¼Œç¬¦åˆè®¢å•ç¼–å·çš„æ ‡å‡†åŒ–å±•ç¤ºéœ€æ±‚ã€‚</p>
<h2 data-id="heading-14">äº”ã€å®Œæ•´å‚æ•°è¯´æ˜</h2>
<p>ä¸ºæ–¹ä¾¿ç”¨æˆ·å¿«é€ŸæŸ¥é˜…é…ç½®é¡¹ï¼Œä»¥ä¸‹æ˜¯ç»„ä»¶æ‰€æœ‰å‚æ•°çš„è¯¦ç»†è¯´æ˜ï¼š</p>











































































<table><thead><tr><th>å‚æ•°å</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th><th>å¯é€‰å€¼</th></tr></thead><tbody><tr><td>number</td><td>Number/String</td><td>0</td><td>åˆå§‹æ˜¾ç¤ºçš„æ•°å­—</td><td>ä»»æ„éè´Ÿæ•´æ•°</td></tr><tr><td>duration</td><td>Number</td><td>1.5</td><td>æ•°å­—ç¿»æ»šåŠ¨ç”»çš„æŒç»­æ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰</td><td>ä»»æ„æ­£æ•°</td></tr><tr><td>autoIncrease</td><td>Boolean</td><td>true</td><td>æ˜¯å¦å¼€å¯æ•°å­—è‡ªåŠ¨å¢é•¿</td><td>true/false</td></tr><tr><td>increaseInterval</td><td>Number</td><td>3000</td><td>è‡ªåŠ¨å¢é•¿çš„æ—¶é—´é—´éš”ï¼ˆå•ä½ï¼šæ¯«ç§’ï¼‰</td><td>ä»»æ„æ­£æ•°</td></tr><tr><td>increaseRange</td><td>Array</td><td>[1, 100]</td><td>æ¯æ¬¡è‡ªåŠ¨å¢é•¿çš„éšæœºæ•°å€¼èŒƒå›´</td><td>ä¸¤ä¸ªéè´Ÿæ•´æ•°ç»„æˆçš„æ•°ç»„</td></tr><tr><td>digitLength</td><td>Number</td><td>8</td><td>æ•°å­—æ˜¾ç¤ºçš„ä½æ•°ï¼Œæ”¯æŒ1-18ä½</td><td>1-18ä¹‹é—´çš„æ•´æ•°</td></tr><tr><td>showSeparator</td><td>Boolean</td><td>true</td><td>æ˜¯å¦æ˜¾ç¤ºåƒåˆ†ä½åˆ†éš”ç¬¦</td><td>true/false</td></tr><tr><td>padDirection</td><td>String</td><td>left</td><td>æ•°å­—è¡¥é›¶çš„æ–¹å‘</td><td>leftï¼ˆå·¦è¡¥é›¶ï¼‰/rightï¼ˆå³è¡¥é›¶ï¼‰</td></tr><tr><td>showLeadingZero</td><td>Boolean</td><td>true</td><td>æ˜¯å¦æ˜¾ç¤ºå‰ç½®é›¶ï¼ˆå·¦è¡¥é›¶æ—¶ï¼‰æˆ–åç½®é›¶ï¼ˆå³è¡¥é›¶æ—¶ï¼‰</td><td>true/false</td></tr></tbody></table>
<h2 data-id="heading-15">å…­ã€åº”ç”¨åœºæ™¯ä¸æ‰©å±•å»ºè®®</h2>
<h3 data-id="heading-16">1. å…¸å‹åº”ç”¨åœºæ™¯</h3>
<p>è¯¥ç»„ä»¶é€‚ç”¨äºå„ç±»éœ€è¦åŠ¨æ€æ•°å­—å±•ç¤ºçš„åœºæ™¯ï¼Œå°¤å…¶é€‚åˆï¼š</p>
<ul>
<li><strong>å¤§å±ç›‘æ§é¢æ¿</strong>ï¼šå¦‚ç³»ç»Ÿè®¿é—®é‡ã€è®¢å•é‡ã€åœ¨çº¿ç”¨æˆ·æ•°ç­‰å®æ—¶æ•°æ®å±•ç¤ºï¼›</li>
<li><strong>ç”µå•†è¿è¥åå°</strong>ï¼šé”€å”®é¢ã€æˆäº¤é‡ã€ç”¨æˆ·å¢é•¿æ•°ç­‰æ ¸å¿ƒæŒ‡æ ‡å±•ç¤ºï¼›</li>
<li><strong>æ´»åŠ¨è¥é”€é¡µé¢</strong>ï¼šå€’è®¡æ—¶æ•°å­—ã€å‚ä¸äººæ•°ã€ç´¯è®¡é”€å”®é¢ç­‰æ°›å›´è¥é€ ï¼›</li>
<li><strong>ä¼ä¸šæ•°æ®ä»ªè¡¨ç›˜</strong>ï¼šæ ¸å¿ƒä¸šåŠ¡æ•°æ®çš„å¯è§†åŒ–å±•ç¤ºï¼Œæå‡æ•°æ®å¯è¯»æ€§ã€‚</li>
</ul>
<h3 data-id="heading-17">2. æ‰©å±•æ–¹å‘å»ºè®®</h3>
<p>æ ¹æ®å®é™…ä¸šåŠ¡éœ€æ±‚ï¼Œç»„ä»¶è¿˜å¯è¿›ä¸€æ­¥æ‰©å±•ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ul>
<li><strong>è‡ªå®šä¹‰åˆ†éš”ç¬¦</strong>ï¼šæ–°å¢<code>separator</code>å‚æ•°ï¼Œæ”¯æŒå°†åƒåˆ†ä½åˆ†éš”ç¬¦æ›¿æ¢ä¸ºâ€œ.â€â€œ â€ç­‰å­—ç¬¦ï¼›</li>
<li><strong>å°æ•°æ”¯æŒ</strong>ï¼šæ–°å¢<code>decimalLength</code>å‚æ•°ï¼Œæ”¯æŒå°æ•°ä½æ•°é…ç½®ï¼Œé€‚é…é‡‘é¢ã€æ¸©åº¦ç­‰éœ€è¦å°æ•°çš„åœºæ™¯ï¼›</li>
<li><strong>æ ·å¼ä¸»é¢˜</strong>ï¼šæä¾›å¤šå¥—æ ·å¼ä¸»é¢˜ï¼ˆå¦‚ç§‘æŠ€è“ã€ä¸­å›½çº¢ã€å¤å¤é‡‘ï¼‰ï¼Œæ”¯æŒä¸€é”®åˆ‡æ¢ï¼›</li>
<li><strong>åŠ¨ç”»æ›²çº¿è‡ªå®šä¹‰</strong>ï¼šæ–°å¢<code>easing</code>å‚æ•°ï¼Œæ”¯æŒçº¿æ€§ã€ç¼“è¿›ç¼“å‡ºç­‰ä¸åŒåŠ¨ç”»æ›²çº¿ï¼›</li>
<li><strong>æ•°å­—æ»šåŠ¨è§¦å‘æ–¹å¼</strong>ï¼šæ”¯æŒæ‰‹åŠ¨è§¦å‘æ»šåŠ¨ï¼ˆå¦‚é€šè¿‡æŒ‰é’®ç‚¹å‡»ï¼‰ï¼Œé€‚é…éè‡ªåŠ¨æ›´æ–°çš„åœºæ™¯ã€‚</li>
</ul>
<h2 data-id="heading-18">ä¸ƒã€æºç </h2>
<pre><code class="hljs language-js" lang="js">
&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"number-roll"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"number-container"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"number-box"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>
          <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(item, index) in numArr"</span>
          <span class="hljs-attr">:key</span>=<span class="hljs-string">"index"</span>
          <span class="hljs-attr">:class</span>=<span class="hljs-string">"{ 'number-item': !isNaN(item), 'mark-item': isNaN(item) }"</span>
        &gt;</span>
          <span class="hljs-comment">&lt;!-- æ•°å­—é¡¹ --&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"!isNaN(item)"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>
              <span class="hljs-attr">ref</span>=<span class="hljs-string">"numberItem"</span>
              <span class="hljs-attr">:style</span>=<span class="hljs-string">"{
                transform: `translate(-50%, -${Number(item) * 10}%)`,
                transition: `transform ${duration}s ease-in-out`
              }"</span>
            &gt;</span>
              0123456789
            <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          <span class="hljs-comment">&lt;!-- åˆ†éš”ç¬¦é¡¹ --&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-else</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mark-symbol"</span>&gt;</span>{{ item }}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>

&lt;script setup lang="ts"&gt;
import { ref, watch, nextTick, onUnmounted } from 'vue';

// ç»„ä»¶props
const props = defineProps({
  // è¦æ˜¾ç¤ºçš„æ•°å­—
  number: {
    type: [Number, String],
    default: 0
  },
  // åŠ¨ç”»æŒç»­æ—¶é—´(ç§’)
  duration: {
    type: Number,
    default: 1.5
  },
  // æ˜¯å¦è‡ªåŠ¨å¢é•¿(æ¨¡æ‹Ÿè½®è¯¢)
  autoIncrease: {
    type: Boolean,
    default: true
  },
  // å¢é•¿é—´éš”(æ¯«ç§’)
  increaseInterval: {
    type: Number,
    default: 3000
  },
  // æ¯æ¬¡å¢é•¿çš„éšæœºæ•°èŒƒå›´
  increaseRange: {
    type: Array,
    default: () =&gt; [1, 100]
  },
  // é…ç½®æ˜¾ç¤ºçš„ä½æ•°
  digitLength: {
    type: Number,
    default: 8,
    validator: (value: number) =&gt; {
      return value &gt;= 1 &amp;&amp; value &lt;= 18;
    }
  },
  // æ˜¯å¦æ˜¾ç¤ºé‡‘é¢åˆ†éš”ç¬¦
  showSeparator: {
    type: Boolean,
    default: true
  },
  // è¡¥é›¶æ–¹å‘ (left/right)
  padDirection: {
    type: String,
    default: 'left',
    validator: (value: string) =&gt; {
      return ['left', 'right'].includes(value);
    }
  },
  // æ ¸å¿ƒæ–°å¢ï¼šæ˜¯å¦æ˜¾ç¤ºå‰ç½®é›¶
  showLeadingZero: {
    type: Boolean,
    default: true
  }
});

// çŠ¶æ€ç®¡ç†
const numArr = ref&lt;string[]&gt;([]); // å¤„ç†åçš„æ•°å­—æ•°ç»„(å«åˆ†éš”ç¬¦)
const currentNumber = ref&lt;number&gt;(Number(props.number)); // å½“å‰æ˜¾ç¤ºçš„æ•°å­—
let timer: NodeJS.Timeout | null = null; // è‡ªåŠ¨å¢é•¿å®šæ—¶å™¨

/**
 * æ ¼å¼åŒ–æ•°å­—ä¸ºå¸¦åƒåˆ†ä½åˆ†éš”ç¬¦çš„å­—ç¬¦ä¸²
 * @param numStr åŸå§‹æ•°å­—å­—ç¬¦ä¸²
 * @returns æ ¼å¼åŒ–åçš„å­—ç¬¦ä¸²
 */
const formatWithSeparator = (numStr: string): string =&gt; {
  // ä»å³å¾€å·¦æ¯3ä½æ·»åŠ åˆ†éš”ç¬¦
  return numStr.replace(/\B(?=(\d{3})+(?!\d))/g, ',');
};

/**
 * å¤„ç†å‰ç½®é›¶æ˜¾ç¤ºé€»è¾‘
 * @param numStr è¡¥é›¶åçš„æ•°å­—å­—ç¬¦ä¸²
 * @returns å¤„ç†åçš„æ•°å­—å­—ç¬¦ä¸²
 */
const handleLeadingZero = (numStr: string): string =&gt; {
  if (props.showLeadingZero) return numStr;
  
  // ä¸æ˜¾ç¤ºå‰ç½®é›¶çš„å¤„ç†é€»è¾‘
  if (props.padDirection === 'left') {
    // å·¦è¡¥é›¶ï¼šå»é™¤å‰ç½®é›¶ï¼Œä½†ä¿ç•™è‡³å°‘ä¸€ä½ï¼ˆé˜²æ­¢ç©ºå­—ç¬¦ä¸²ï¼‰
    const trimmed = numStr.replace(/^0+/, '');
    return trimmed || '0';
  } else {
    // å³è¡¥é›¶ï¼šå»é™¤åç½®é›¶ï¼Œä½†ä¿ç•™è‡³å°‘ä¸€ä½
    const trimmed = numStr.replace(/0+$/, '');
    return trimmed || '0';
  }
};

/**
 * åˆå§‹åŒ–æ•°å­—å¤„ç†
 * @param num è¦å¤„ç†çš„æ•°å­—
 */
const initNumber = (num: number) =&gt; {
  // è½¬æ¢ä¸ºæ•´æ•°å¹¶è½¬å­—ç¬¦ä¸²
  let numberStr = Math.floor(num).toString();
  
  // 1. è¡¥é›¶å¤„ç†
  if (numberStr.length &lt; props.digitLength) {
    if (props.padDirection === 'left') {
      numberStr = numberStr.padStart(props.digitLength, '0');
    } else {
      numberStr = numberStr.padEnd(props.digitLength, '0');
    }
  } else if (numberStr.length &gt; props.digitLength) {
    console.warn(`æ•°å­—è¶…è¿‡${props.digitLength}ä½ï¼Œå·²æˆªå–å‰${props.digitLength}ä½`);
    // æˆªå–å¯¹åº”ä½æ•°
    numberStr = props.padDirection === 'left' 
      ? numberStr.slice(-props.digitLength) // å·¦ä¾§æˆªå–ï¼šå–åNä½
      : numberStr.slice(0, props.digitLength); // å³ä¾§æˆªå–ï¼šå–å‰Nä½
  }

  // 2. å¤„ç†å‰ç½®/åç½®é›¶æ˜¾ç¤ºé€»è¾‘
  let processedStr = handleLeadingZero(numberStr);
  
  // 3. é‡‘é¢åˆ†éš”ç¬¦å¤„ç†
  let formatted = processedStr;
  if (props.showSeparator &amp;&amp; processedStr.length &gt; 3) {
    formatted = formatWithSeparator(processedStr);
  }
  
  // 4. è½¬æ¢ä¸ºæ•°ç»„ä¾›æ¸²æŸ“
  numArr.value = formatted.split('');
};

/**
 * ç”Ÿæˆéšæœºæ•°
 * @param min æœ€å°å€¼
 * @param max æœ€å¤§å€¼
 */
const getRandomNumber = (min: number, max: number) =&gt; {
  return Math.floor(Math.random() * (max - min + 1) + min);
};

/**
 * è‡ªåŠ¨å¢é•¿æ•°å­—
 */
const startAutoIncrease = () =&gt; {
  if (!props.autoIncrease) return;
  
  // æ¸…é™¤ç°æœ‰å®šæ—¶å™¨
  if (timer) clearInterval(timer);
  
  // å¯åŠ¨æ–°å®šæ—¶å™¨
  timer = setInterval(() =&gt; {
    const [min, max] = props.increaseRange;
    currentNumber.value += getRandomNumber(min, max);
    initNumber(currentNumber.value);
  }, props.increaseInterval);
};

/**
 * åœæ­¢è‡ªåŠ¨å¢é•¿
 */
const stopAutoIncrease = () =&gt; {
  if (timer) {
    clearInterval(timer);
    timer = null;
  }
};

// åˆå§‹åŒ–
nextTick(() =&gt; {
  currentNumber.value = Number(props.number);
  initNumber(currentNumber.value);
  startAutoIncrease();
});

// ç›‘å¬propså˜åŒ–
watch(
  () =&gt; [props.number, props.digitLength, props.showSeparator, props.padDirection, props.showLeadingZero],
  () =&gt; {
    currentNumber.value = Number(props.number);
    initNumber(currentNumber.value);
  },
  { immediate: true, deep: true }
);

// ç›‘å¬autoIncreaseå˜åŒ–
watch(
  () =&gt; props.autoIncrease,
  (newVal) =&gt; {
    if (newVal) {
      startAutoIncrease();
    } else {
      stopAutoIncrease();
    }
  }
);

// ç»„ä»¶å¸è½½æ—¶æ¸…é™¤å®šæ—¶å™¨
onUnmounted(() =&gt; {
  stopAutoIncrease();
});
&lt;/script&gt;

&lt;style scoped lang="scss"&gt;
.number-roll {
  display: inline-block;
  padding: 8px 16px;
  background-color: #0f172a;
  border-radius: 8px;

  .number-container {
    position: relative;
  }

  .number-box {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 4px;
    margin: 0;
    padding: 0;
    list-style: none;
  }

  // æ•°å­—é¡¹æ ·å¼
  .number-item {
    width: 42px;
    height: 60px;
    position: relative;
    background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
    border-radius: 6px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    writing-mode: vertical-lr; // å‚ç›´æ’ç‰ˆ
    text-orientation: upright; // æ–‡å­—ç›´ç«‹
    overflow: hidden;
    user-select: none;

    span {
      display: block;
      width: 100%;
      height: 100%;
      position: relative;

      p {
        position: absolute;
        top: 0;
        left: 50%;
        transform: translateX(-50%);
        margin: 0;
        padding: 0;
        letter-spacing: 12px; // æ•°å­—é—´è·
        font-family: 'Arial', sans-serif;
        font-weight: 700;
        font-size: 48px;
        color: #38bdf8;
        text-shadow: 0 0 10px rgba(56, 189, 248, 0.5);
      }
    }
  }

  // åˆ†éš”ç¬¦é¡¹æ ·å¼
  .mark-item {
    width: 16px;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;

    .mark-symbol {
      font-family: 'Arial', sans-serif;
      font-size: 32px;
      color: #38bdf8;
      font-weight: bold;
    }
  }

  // å“åº”å¼è°ƒæ•´ä¸åŒä½æ•°çš„æ˜¾ç¤º
  :deep(.number-box) {
    flex-wrap: nowrap;
  }

  // Firefoxå…¼å®¹æ€§è°ƒæ•´
  @-moz-document url-prefix() {
    .number-item p {
      margin-top: 4px;
    }
  }

  // å°ä½æ•°æ ·å¼ä¼˜åŒ–
  @media (max-width: 768px) {
    .number-item {
      width: 32px;
      height: 48px;

      span p {
        font-size: 36px;
        letter-spacing: 8px;
      }
    }

    .mark-item {
      width: 12px;
      height: 48px;

      .mark-symbol {
        font-size: 24px;
      }
    }
  }
&lt;/style&gt;

</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[VitePress+Github Pageså®ç°é™æ€æ–‡æ¡£ç«™]]></title>    <link>https://juejin.cn/post/7587688765189554176</link>    <guid>https://juejin.cn/post/7587688765189554176</guid>    <pubDate>2025-12-26T07:37:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587688765189554176" data-draft-id="7587740546954018856" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="VitePress+Github Pageså®ç°é™æ€æ–‡æ¡£ç«™"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-26T07:37:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†èŠ±"/> <meta itemprop="url" content="https://juejin.cn/user/4002664676073741"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            VitePress+Github Pageså®ç°é™æ€æ–‡æ¡£ç«™
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4002664676073741/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†èŠ±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T07:37:13.000Z" title="Fri Dec 26 2025 07:37:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æŸ¥é˜…äº†ç½‘ä¸Šè®¸å¤šVitePress+Github Pagesçš„éƒ¨ç½²æ•™ç¨‹ï¼Œå‘ç°è¦ä¹ˆä¸å®Œæ•´ã€è¦ä¹ˆè¿‡æ—¶ã€è¦ä¹ˆä¸å¤Ÿè¯¦ç»†</p>
<p>äºæ˜¯åœ¨è¿™é‡Œä¸“é—¨å†™ä¸€ç¯‡è¯¦ç»†çš„å›¾æ–‡æ•™ç¨‹ä»¥ä¾›æŸ¥é˜…ã€‚</p>
<p>æˆ–è®¸å­˜åœ¨æ—¶æ•ˆæ€§ï¼Œæ³¨æ„æœ¬æ–‡å‘å¸ƒäº2025å¹´12æœˆ26æ—¥</p>
</blockquote>
<h2 data-id="heading-0">ç¯å¢ƒå‡†å¤‡</h2>
<ul>
<li>Node.JSï¼šç‚¹å‡»å‰å¾€ä¸‹è½½=&gt;<a href="https://link.juejin.cn?target=https%3A%2F%2Fnodejs.org%2Fzh-cn%2Fdownload" target="_blank" title="https://nodejs.org/zh-cn/download" ref="nofollow noopener noreferrer">Node.JS</a>ï¼Œç‰ˆæœ¬è¯·ç¡®ä¿**&gt;18**ã€‚</li>
<li>æ”¯æŒmarkdownè¯­æ³•çš„ç¼–è¾‘å™¨ï¼šæ¨è <code>VsCode</code>å¹¶å®‰è£…å¯¹åº”æ‰©å±•
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmarketplace.visualstudio.com%2Fitems%3FitemName%3DVue.volar" target="_blank" title="https://marketplace.visualstudio.com/items?itemName=Vue.volar" ref="nofollow noopener noreferrer">Vueå®˜æ–¹æ‰©å±•</a></li>
<li><a href="https://link.juejin.cn?target=http%3A%2F%2Fmarketplace.visualstudio.com%2Fitems%3FitemName%3DDavidAnson.vscode-markdownlint" target="_blank" title="http://marketplace.visualstudio.com/items?itemName=DavidAnson.vscode-markdownlint" ref="nofollow noopener noreferrer">markdownlint</a></li>
</ul>
</li>
</ul>
<h2 data-id="heading-1">åˆ›å»ºé¡¹ç›®</h2>
<p>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹<code>VitePressDemo</code>ï¼ˆå–ä½ è‡ªå·±æƒ³è¦çš„åå­—å³å¯ï¼‰å¹¶è¿›å…¥ç»ˆç«¯</p>
<blockquote>
<p>ä½ ä¹Ÿå¯ä»¥ç›´æ¥åœ¨ä½ ç°æœ‰çš„é¡¹ç›®æ–‡ä»¶å¤¹æ ¹ç›®å½•ä¸­è¿™ä¹ˆåšï¼Œä¾‹å¦‚ä½ è¦ä¸ºè‡ªå·±çš„åå°ç¼–å†™ä¸€ä¸ªæ–‡æ¡£ç«™</p>
</blockquote>
<h3 data-id="heading-2">æ‰§è¡ŒæŒ‡ä»¤</h3>
<p>æ ¹æ®è‡ªå·±çš„ç¯å¢ƒé€‰æ‹©ï¼š</p>
<ul>
<li>npmï¼š<code>npm add -D vitepress@next</code></li>
<li>pnpmï¼š<code>pnpm add -D vitepress@next</code></li>
<li>yarnï¼š<code>yarn add -D vitepress@next vue</code></li>
<li>bunï¼š<code>bun add -D vitepress@next</code></li>
</ul>
<h3 data-id="heading-3">å®‰è£…å‘å¯¼</h3>
<p>å®‰è£…å®Œæˆåç»§ç»­è¾“å…¥æŒ‡ä»¤ï¼Œæ ¹æ®è‡ªå·±çš„ç¯å¢ƒé€‰æ‹©ï¼š</p>
<ul>
<li>npmï¼š<code>npx vitepress init</code></li>
<li>pnpmï¼š<code>pnpm vitepress init</code></li>
<li>yarnï¼š<code>yarn vitepress init</code></li>
<li>bunï¼š<code>bun vitepress init</code></li>
</ul>
<p>ç„¶åä½ å°†éœ€è¦å›ç­”ä¸€äº›é—®é¢˜ç”¨äºç¯å¢ƒçš„åˆå§‹é…ç½®ï¼Œæ¨èæŒ‰å¦‚ä¸‹è®¾ç½®</p>
<pre><code class="hljs language-js" lang="js">â”Œ  <span class="hljs-title class_">Welcome</span> to <span class="hljs-title class_">VitePress</span>!
â”‚
â—‡  <span class="hljs-title class_">Where</span> should <span class="hljs-title class_">VitePress</span> initialize the config?
â”‚  ./docs
â”‚
â—‡  <span class="hljs-title class_">Where</span> should <span class="hljs-title class_">VitePress</span> look <span class="hljs-keyword">for</span> your markdown files?
â”‚  ./docs
â”‚
â—‡  <span class="hljs-title class_">Site</span> <span class="hljs-attr">title</span>:
â”‚  <span class="hljs-title class_">VitePressDemo</span>ï¼ˆå¯ä»¥ä¿®æ”¹ï¼‰
â”‚
â—‡  <span class="hljs-title class_">Site</span> <span class="hljs-attr">description</span>:
â”‚  <span class="hljs-title class_">VitePressDemo</span> descriptionï¼ˆå¯ä»¥ä¿®æ”¹ï¼‰
â”‚
â—‡  <span class="hljs-title class_">Theme</span>:
â”‚  <span class="hljs-title class_">Default</span> <span class="hljs-title class_">Theme</span>
â”‚
â—‡  <span class="hljs-title class_">Use</span> <span class="hljs-title class_">TypeScript</span> <span class="hljs-keyword">for</span> config and theme files?
â”‚  <span class="hljs-title class_">Yes</span>
â”‚
â—‡  <span class="hljs-title class_">Add</span> <span class="hljs-title class_">VitePress</span> npm scripts to package.<span class="hljs-property">json</span>?
â”‚  <span class="hljs-title class_">Yes</span>
â”‚
â—‡  <span class="hljs-title class_">Add</span> a prefix <span class="hljs-keyword">for</span> <span class="hljs-title class_">VitePress</span> npm scripts?
â”‚  <span class="hljs-title class_">Yes</span>
â”‚
â—‡  <span class="hljs-title class_">Prefix</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">VitePress</span> npm <span class="hljs-attr">scripts</span>:
â”‚  docs
â”‚
â””  <span class="hljs-title class_">Done</span>! <span class="hljs-title class_">Now</span> run pnpm run <span class="hljs-attr">docs</span>:dev and start writing.
</code></pre>
<h3 data-id="heading-4">é¡¹ç›®ç»“æ„</h3>
<p>å‡è®¾é€‰æ‹©åœ¨ <code>./docs</code> ä¸­æ­å»º VitePress é¡¹ç›®ï¼Œç”Ÿæˆçš„æ–‡ä»¶ç»“æ„åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="hljs language-lua" lang="lua">.
â”œâ”€ docs
â”‚  â”œâ”€ .vitepress
â”‚  â”‚  â””â”€ <span class="hljs-built_in">config</span>.js
â”‚  â”œâ”€ api-examples.md
â”‚  â”œâ”€ markdown-examples.md
â”‚  â””â”€ index.md
â””â”€ <span class="hljs-built_in">package</span>.json
</code></pre>
<blockquote>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒVitePress å°†å…¶å¼€å‘æœåŠ¡å™¨ç¼“å­˜å­˜å‚¨åœ¨ <code>.vitepress/cache</code> ä¸­ï¼Œå¹¶å°†ç”Ÿäº§æ„å»ºè¾“å‡ºå­˜å‚¨åœ¨ <code>.vitepress/dist</code> ä¸­ã€‚å¦‚æœä½¿ç”¨ Gitï¼Œåº”è¯¥å°†å®ƒä»¬æ·»åŠ åˆ° <code>.gitignore</code> æ–‡ä»¶ä¸­ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">node_modules/
docs/node_modules
docs/.vuepress/.temp
docs/.vitepress/dist
docs/.vitepress/cache
</code></pre>
</blockquote>
<h3 data-id="heading-5">æœ¬åœ°è¿è¡Œ</h3>
<p>å¦‚æœä½ çš„å®‰è£…å‘å¯¼ä¸æˆ‘æè¿°çš„ä¸€è‡´ï¼Œä½ åº”è¯¥å¯ä»¥åœ¨ <code>package.json</code> ä¸­çœ‹åˆ°ä»¥ä¸‹<code>npm</code>è„šæœ¬</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  ...
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"docs:dev"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vitepress dev docs"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"docs:build"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vitepress build docs"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"docs:preview"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vitepress preview docs"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  ...
<span class="hljs-punctuation">}</span>
</code></pre>
<p>å¯åŠ¨å…·æœ‰å³æ—¶çƒ­æ›´æ–°çš„æœ¬åœ°å¼€å‘æœåŠ¡å™¨ã€‚æ ¹æ®è‡ªå·±çš„ç¯å¢ƒä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<ul>
<li>npmï¼š<code>npx vitepress dev docs</code></li>
<li>pnpmï¼š<code>pnpm vitepress dev docs</code></li>
<li>yarnï¼š<code>yarn vitepress dev docs</code></li>
<li>bunï¼š<code>bun vitepress dev docs</code></li>
</ul>
<p>å¼€å‘æœåŠ¡åº”è¯¥ä¼šè¿è¡Œåœ¨ <code>http://localhost:5173</code> ä¸Šï¼Œå°†URLå¤åˆ¶åˆ°æµè§ˆå™¨ä¸­æ‰“å¼€ï¼Œå³å¯åœ¨æœ¬åœ°è®¿é—®æ–‡æ¡£ç«™ï¼</p>
<h3 data-id="heading-6">éªŒè¯ç¼–è¯‘</h3>
<p>æœ‰æ—¶å€™é¡¹ç›®å¯ä»¥åœ¨æœ¬åœ°è¿è¡Œï¼Œä½†æ— æ³•æ­£å¸¸ç¼–è¯‘</p>
<p>æ‰€ä»¥æ¨èæ¯æ¬¡éœ€è¦æ›´æ–°è‡ªå·±çš„æ–‡æ¡£ç«™ä¹‹å‰ï¼Œä½¿ç”¨ç¼–è¯‘æŒ‡ä»¤éªŒè¯ç¼–è¯‘æ˜¯å¦å¯è¡Œï¼š</p>
<pre><code class="hljs language-sh" lang="sh">npm run docs:build
</code></pre>
<p>ä½ è¿˜å¯ä»¥é€šè¿‡æŒ‡ä»¤æ¥æœ¬åœ°é¢„è§ˆç¼–è¯‘å¥½çš„ç½‘ç«™ï¼š</p>
<pre><code class="hljs language-sh" lang="sh">npm run docs:preview
</code></pre>
<p>preview å‘½ä»¤å°†å¯åŠ¨ä¸€ä¸ªæœ¬åœ°é™æ€ Web æœåŠ¡ <a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A4173%25EF%25BC%258C%25E8%25AF%25A5%25E6%259C%258D%25E5%258A%25A1%25E4%25BB%25A5" target="_blank" title="http://localhost:4173%EF%BC%8C%E8%AF%A5%E6%9C%8D%E5%8A%A1%E4%BB%A5" ref="nofollow noopener noreferrer">http://localhost:4173ï¼Œè¯¥æœåŠ¡ä»¥</a> .vitepress/dist ä½œä¸ºæºæ–‡ä»¶ã€‚è¿™æ˜¯æ£€æŸ¥ç”Ÿäº§ç‰ˆæœ¬åœ¨æœ¬åœ°ç¯å¢ƒä¸­æ˜¯å¦æ­£å¸¸çš„ä¸€ç§ç®€å•æ–¹æ³•ã€‚</p>
<h2 data-id="heading-7">éƒ¨ç½²Github Pages</h2>
<h3 data-id="heading-8">åšä¸€äº›å‡†å¤‡</h3>
<ul>
<li>
<p>è¯·åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ<code>npm install</code>ï¼Œç”Ÿæˆ<code>package-lock.json</code>æ–‡ä»¶</p>
</li>
<li>
<p>åœ¨/docs/.vitepress/config.mtsæ–‡ä»¶ä¸­ï¼Œè®¾ç½®baseä¸ºè‡ªå·±çš„é¡¹ç›®åï¼Œä¾‹å¦‚</p>
<pre><code class="hljs language-php" lang="php">import { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">"vitepress"</span>;

<span class="hljs-comment">// https://vitepress.dev/reference/site-config</span>
export <span class="hljs-keyword">default</span> <span class="hljs-title function_ invoke__">defineConfig</span>({
  <span class="hljs-attr">title</span>: <span class="hljs-string">"VitePressDemo"</span>,
  <span class="hljs-attr">description</span>: <span class="hljs-string">"VitePressDemo Description"</span>,
  // è®¾ç½®base
  <span class="hljs-attr">base</span>: <span class="hljs-string">"/VitePressDemo/"</span>,
  <span class="hljs-attr">themeConfig</span>: {
    // <span class="hljs-attr">https</span>://vitepress.dev/reference/<span class="hljs-keyword">default</span>-theme-config
    <span class="hljs-attr">nav</span>: [
      { <span class="hljs-attr">text</span>: <span class="hljs-string">"Home"</span>, <span class="hljs-attr">link</span>: <span class="hljs-string">"/"</span> },
      { <span class="hljs-attr">text</span>: <span class="hljs-string">"Examples"</span>, <span class="hljs-attr">link</span>: <span class="hljs-string">"/markdown-examples"</span> },
    ],

    <span class="hljs-attr">sidebar</span>: [
      {
        <span class="hljs-attr">text</span>: <span class="hljs-string">"Examples"</span>,
        <span class="hljs-attr">items</span>: [
          { <span class="hljs-attr">text</span>: <span class="hljs-string">"Markdown Examples"</span>, <span class="hljs-attr">link</span>: <span class="hljs-string">"/markdown-examples"</span> },
          { <span class="hljs-attr">text</span>: <span class="hljs-string">"Runtime API Examples"</span>, <span class="hljs-attr">link</span>: <span class="hljs-string">"/api-examples"</span> },
        ],
      },
    ],

    <span class="hljs-attr">socialLinks</span>: [
      { <span class="hljs-attr">icon</span>: <span class="hljs-string">"github"</span>, <span class="hljs-attr">link</span>: <span class="hljs-string">"https://github.com/vuejs/vitepress"</span> },
    ],
  },
});

</code></pre>
<p>è¿™ä¸€æ­¥æ˜¯å¿…é¡»çš„ï¼Œå› ä¸º<code>GitHub Pages</code>çš„é»˜è®¤åŸŸåæ ¼å¼ä¸º<code>https://ä½ çš„ç”¨æˆ·å..github.io/é¡¹ç›®å/</code>ï¼Œä½ éœ€è¦å‘Šè¯‰vitePressé¡¹ç›®çš„å…¥å£åœ¨å“ªã€‚</p>
</li>
</ul>
<h3 data-id="heading-9">å»ºç«‹ä»“åº“</h3>
<p>æˆ‘ä»¬éœ€è¦åœ¨Githubä¸­å»ºç«‹ä¸€ä¸ªä»“åº“å¹¶å°†æˆ‘ä»¬çš„ä»£ç æ”¾è¿›å»ã€‚</p>
<blockquote>
<p>è¿™ä¸€éƒ¨åˆ†çš„çŸ¥è¯†ä¸Gitæœ‰å…³ï¼Œç½‘ä¸Šèµ„æ–™å¾ˆå¤šåœ¨æ­¤ä¸åšèµ˜è¿°ã€‚</p>
<p>æ¨èåœ¨ VsCode æ’ä»¶ä¸­å®‰è£… <a href="https://link.juejin.cn?target=https%3A%2F%2Fmarketplace.visualstudio.com%2Fitems%3FitemName%3DGitHub.vscode-pull-request-github" target="_blank" title="https://marketplace.visualstudio.com/items?itemName=GitHub.vscode-pull-request-github" ref="nofollow noopener noreferrer">GitHub Pull Requests </a>ç”¨äº Github ä»“åº“æ¨é€ã€æ‹‰å–ã€‚</p>
</blockquote>
<p>åœ¨ä»“åº“ç•Œé¢é€‰æ‹©<code>Settings</code>-<code>Pages</code>-<code>Build and deployment</code>-<code>Source</code>-ä¸‹æ‹‰æ¡†é€‰æ‹© <code>Github Actions</code></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/838514098299411e83770178f6b5600a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YaN6Iqx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339433&amp;x-signature=aEobXXZMeDUMgs4VfIblgPDrvho%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-10">æäº¤æ¸²æŸ“é€»è¾‘</h3>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬è¦ä¸ºç½‘ç«™ç¼–å†™ç½‘ç«™æ¸²æŸ“é€»è¾‘</p>
<p>é€‰æ‹©<code>Github Pages Jekyll</code>ä¸‹æ–¹çš„<code>Configure</code></p>
<p>æŒ‰ç…§å¦‚å›¾è®¾ç½®å†™å…¥ä»£ç ï¼Œå¹¶å°†æ–‡ä»¶åæ”¹ä¸º<code>deploy.yml</code>ï¼Œå®Œæˆåç‚¹å‡»<code>Commit changes</code></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d7943de067e64b35bfe1b9392abc2bd7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YaN6Iqx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339433&amp;x-signature=6Bct9lhuwmEWhUCtMUEQ38gPkic%3D" alt="" loading="lazy"/></p>
<p>éœ€è¦å†™å…¥çš„ä»£ç å¦‚ä¸‹ï¼Œä¸€å®šè¦å°†ç¯å¢ƒä¿®æ”¹ä¸ºè‡ªå·±çš„ç¯å¢ƒï¼Œä¾‹å¦‚ <code>node-version: 22</code>ï¼ˆNode.JSç‰ˆæœ¬ï¼‰ã€<code>cache: npm</code>ã€<code>run: npm ci</code></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># æ„å»º VitePress ç«™ç‚¹å¹¶å°†å…¶éƒ¨ç½²åˆ° GitHub Pages çš„ç¤ºä¾‹å·¥ä½œæµç¨‹</span>
<span class="hljs-comment">#</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">VitePress</span> <span class="hljs-string">site</span> <span class="hljs-string">to</span> <span class="hljs-string">Pages</span>

<span class="hljs-attr">on:</span>
  <span class="hljs-comment"># åœ¨é’ˆå¯¹ `main` åˆ†æ”¯çš„æ¨é€ä¸Šè¿è¡Œã€‚å¦‚æœä½ </span>
  <span class="hljs-comment"># ä½¿ç”¨ `master` åˆ†æ”¯ä½œä¸ºé»˜è®¤åˆ†æ”¯ï¼Œè¯·å°†å…¶æ›´æ”¹ä¸º `master`</span>
  <span class="hljs-attr">push:</span>
    <span class="hljs-attr">branches:</span> [<span class="hljs-string">master</span>]

  <span class="hljs-comment"># å…è®¸ä½ ä» Actions é€‰é¡¹å¡æ‰‹åŠ¨è¿è¡Œæ­¤å·¥ä½œæµç¨‹</span>
  <span class="hljs-attr">workflow_dispatch:</span>

<span class="hljs-comment"># è®¾ç½® GITHUB_TOKEN çš„æƒé™ï¼Œä»¥å…è®¸éƒ¨ç½²åˆ° GitHub Pages</span>
<span class="hljs-attr">permissions:</span>
  <span class="hljs-attr">contents:</span> <span class="hljs-string">read</span>
  <span class="hljs-attr">pages:</span> <span class="hljs-string">write</span>
  <span class="hljs-attr">id-token:</span> <span class="hljs-string">write</span>

<span class="hljs-comment"># åªå…è®¸åŒæ—¶è¿›è¡Œä¸€æ¬¡éƒ¨ç½²ï¼Œè·³è¿‡æ­£åœ¨è¿è¡Œå’Œæœ€æ–°é˜Ÿåˆ—ä¹‹é—´çš„è¿è¡Œé˜Ÿåˆ—</span>
<span class="hljs-comment"># ä½†æ˜¯ï¼Œä¸è¦å–æ¶ˆæ­£åœ¨è¿›è¡Œçš„è¿è¡Œï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›å…è®¸è¿™äº›ç”Ÿäº§éƒ¨ç½²å®Œæˆ</span>
<span class="hljs-attr">concurrency:</span>
  <span class="hljs-attr">group:</span> <span class="hljs-string">pages</span>
  <span class="hljs-attr">cancel-in-progress:</span> <span class="hljs-literal">false</span>

<span class="hljs-attr">jobs:</span>
  <span class="hljs-comment"># æ„å»ºå·¥ä½œ</span>
  <span class="hljs-attr">build:</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>
    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Checkout</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v4</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">fetch-depth:</span> <span class="hljs-number">0</span> <span class="hljs-comment"># å¦‚æœæœªå¯ç”¨ lastUpdatedï¼Œåˆ™ä¸éœ€è¦</span>
      <span class="hljs-comment"># - uses: pnpm/action-setup@v2 # å¦‚æœä½¿ç”¨ pnpmï¼Œè¯·å–æ¶ˆæ³¨é‡Š</span>
      <span class="hljs-comment"># - uses: oven-sh/setup-bun@v1 # å¦‚æœä½¿ç”¨ Bunï¼Œè¯·å–æ¶ˆæ³¨é‡Š</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Setup</span> <span class="hljs-string">Node</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-node@v4</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">node-version:</span> <span class="hljs-number">22</span>
          <span class="hljs-attr">cache:</span> <span class="hljs-string">npm</span> <span class="hljs-comment"># æˆ– pnpm / yarn</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Setup</span> <span class="hljs-string">Pages</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/configure-pages@v4</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">dependencies</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">ci</span> <span class="hljs-comment"># æˆ– pnpm install / yarn install / bun install</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Build</span> <span class="hljs-string">with</span> <span class="hljs-string">VitePress</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          npm run docs:build # æˆ– pnpm docs:build / yarn docs:build / bun run docs:build
          touch docs/.vitepress/dist/.nojekyll
</span>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Upload</span> <span class="hljs-string">artifact</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/upload-pages-artifact@v3</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">path:</span> <span class="hljs-string">docs/.vitepress/dist</span>

  <span class="hljs-comment"># éƒ¨ç½²å·¥ä½œ</span>
  <span class="hljs-attr">deploy:</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-attr">name:</span> <span class="hljs-string">github-pages</span>
      <span class="hljs-attr">url:</span> <span class="hljs-string">${{</span> <span class="hljs-string">steps.deployment.outputs.page_url</span> <span class="hljs-string">}}</span>
    <span class="hljs-attr">needs:</span> <span class="hljs-string">build</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span>
    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">to</span> <span class="hljs-string">GitHub</span> <span class="hljs-string">Pages</span>
        <span class="hljs-attr">id:</span> <span class="hljs-string">deployment</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/deploy-pages@v4</span>

</code></pre>
<h3 data-id="heading-11">ç¼–è¯‘ç½‘ç«™</h3>
<p>å°†<code>deploy.yml</code>æ–‡ä»¶æäº¤æˆåŠŸåï¼Œæˆ‘ä»¬æ¥åˆ°<code>Actions</code>ç¼–è¯‘ä»£ç </p>
<p>åœ¨ä»“åº“ç•Œé¢é€‰æ‹©<code>Actions</code>-<code>Deploy VitePress site to Pages</code>-<code>Run workflow</code>ä¸‹æ‹‰æ¡†-é€‰æ‹©<code>Run workflow</code></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/294375cfc8aa44e5abf5c8e1ce17cf1b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YaN6Iqx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339433&amp;x-signature=DlhKbq8j1QRsGdgvzufdTmZ1FVQ%3D" alt="" loading="lazy"/></p>
<p>ä½ æ¯æ¬¡æäº¤å¹¶æ›´æ–°äº†ä»“åº“çš„ä»£ç ï¼Œç½‘ç«™å¹¶ä¸ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œéœ€è¦æ¥è¿™é‡Œå†æ¬¡æ‰§è¡Œä¸€æ¬¡<code>Run workflow</code>æ‰ä¼šé‡æ–°ç¼–è¯‘ç½‘ç«™</p>
<blockquote>
<p>æˆ‘æ²¡æœ‰è®¾ç½®è‡ªåŠ¨ç¼–è¯‘ï¼Œè¿™ä¸ªæ­¥éª¤å¯¹äºæˆ‘æ¥è¯´ç›¸å½“äºä¸€ä¸ªâ€œç¡®è®¤â€é”®ï¼Œå¯¹æˆ‘å¾ˆæœ‰å¿…è¦</p>
<p>å¦‚æœéœ€è¦è‡ªåŠ¨ç¼–è¯‘ï¼Œå°†<code>reploy.yml</code>ä¸­çš„<code>branches: [master]</code>ä¿®æ”¹ä¸º<code>branches: [main]</code>å³å¯</p>
</blockquote>
<h3 data-id="heading-12">è®¿é—®ç½‘ç«™</h3>
<p>ä½ æ¯æ¬¡ç¼–è¯‘ç½‘ç«™ååˆ·æ–°é¡µé¢ï¼Œæœ€æ–°çš„ç¼–è¯‘å·¦è¾¹ä¼šæœ‰ä¸€ä¸ªçŠ¶æ€</p>
<p>é»„è‰²ä»£è¡¨æ­£åœ¨ç¼–è¯‘ï¼Œçº¢è‰²ä»£è¡¨ç¼–è¯‘é”™è¯¯ï¼ˆå‡ºBUGäº†ï¼‰ï¼Œç»¿è‰²åˆ™ä»£è¡¨ç¼–è¯‘å®Œæˆã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a99b210a578f475bbc237e2b2dd6304e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YaN6Iqx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339433&amp;x-signature=9Ce2jpo4pvfuQPdEswG4AMP03HI%3D" alt="" loading="lazy"/></p>
<p>å½“å®ƒæ˜¾ç¤ºç»¿è‰²çš„æ—¶å€™ï¼Œä½ å°±å¯ä»¥å»è®¿é—®è‡ªå·±çš„ç½‘ç«™äº†ï¼ˆåˆ·æ–°æ‰å¯ä»¥çœ‹åˆ°ç»¿è‰²ï¼Œç½‘ç«™ä¸ä¼šè‡ªåŠ¨åˆ·æ–°ï¼‰</p>
<blockquote>
<p>å¦‚æœè¿™ä¸€æ­¥ç¼–è¯‘é”™è¯¯ï¼Œè¯·åœ¨æ ¹ç›®å½•å†æ¬¡æ‰§è¡Œ<code>npm add -D vitepress@next</code></p>
<p>ç¡®ä¿ä½ çš„package.jsonçš„ä»£ç å­˜åœ¨ä»¥ä¸‹ä»£ç ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"docs:dev"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vitepress dev docs"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"docs:build"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vitepress build docs"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"docs:preview"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vitepress preview docs"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"devDependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"vitepress"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^2.0.0-alpha.15"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>

</code></pre>
</blockquote>
<p>å›åˆ°<code>Settings</code>-<code>Pages</code>å°±å¯ä»¥çœ‹åˆ°è‡ªå·±çš„ç½‘ç«™åœ°å€äº†</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e9f1370b3a514bbe886976e2bab7a028~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YaN6Iqx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339433&amp;x-signature=txww4HnNL7a6MHlYiMfUD7dKm6U%3D" alt="" loading="lazy"/></p>
<p>è¿›å…¥ç½‘ç«™å¯ä»¥çœ‹åˆ°vitePressçš„åˆå§‹æ¨¡æ¿</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cfd6e46c7bbd4c52b566767013a6b53f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YaN6Iqx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339433&amp;x-signature=3UNyvPTxtyJVH3KaqZOSjox2snw%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>å¦‚æœè¿›å…¥ç½‘é¡µé™¤äº†ä¸€ä¸ªæ ‡é¢˜ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œåˆ™å¤§æ¦‚ç‡æ˜¯baseè®¾ç½®çš„é—®é¢˜ã€‚</p>
</blockquote>
<h2 data-id="heading-13">ç»“å°¾</h2>
<p>æœ¬æ–‡ç”¨äºæˆªå›¾çš„Demoé¡¹ç›®åœ°å€ä¸ºï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FZaiHuaOvO%2FVitePressDemo" target="_blank" title="https://github.com/ZaiHuaOvO/VitePressDemo" ref="nofollow noopener noreferrer">VitePressDemo</a></p>
<p>å…³äºå¼€å‘æ–¹é¢å¯ä»¥ç¿»é˜…æ–‡æ¡£ <a href="https://link.juejin.cn?target=https%3A%2F%2Fvitepress.dev%2Fzh%2F" target="_blank" title="https://vitepress.dev/zh/" ref="nofollow noopener noreferrer">VitePress</a>ï¼Œæœ¬æ–‡æœ‰è®¸å¤šå†…å®¹éƒ½æ˜¯å–è‡ªäºå…¶ä¸­ï¼Œåªæ˜¯åŠ ä¸Šäº†è‡ªå·±çš„ç»éªŒç†è§£å’Œæˆªå›¾ã€‚</p>
<p>è¯ç”Ÿæœ¬æ–‡çš„çµæ„Ÿï¼Œæ˜¯ç”±äºæœ€è¿‘åœ¨å¸®ä¸€ä¸ªå°é¡¹ç›®ç¼–å†™æ–‡æ¡£ç«™çš„æ—¶å€™æŸ¥é˜…èµ„æ–™å­¦ä¹ ï¼Œç›®å‰æ–‡æ¡£ç«™ç¼–å†™äº†ç›®å½•è‡ªåŠ¨è¯†åˆ«ã€ä¸­è‹±æ–‡åˆ‡æ¢ã€å›åˆ°é¡¶éƒ¨ç­‰å¤šä¸ªåŠŸèƒ½ï¼Œæƒ³è¦è¿›ä¸€æ­¥å¼€å‘å¯ä»¥å‚è€ƒæœ¬é¡¹ç›®çš„ä»£ç ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FWitty36%2FMaaLYSK" target="_blank" title="https://github.com/Witty36/MaaLYSK" ref="nofollow noopener noreferrer">MaaLYSK</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»ä»£ç çœ‹ LangChainï¼šå¤§æ¨¡å‹åº”ç”¨å¼€å‘çš„å·¥ç¨‹åŒ–å®è·µä¸ç¯å¢ƒå‡†å¤‡]]></title>    <link>https://juejin.cn/post/7587738151659028480</link>    <guid>https://juejin.cn/post/7587738151659028480</guid>    <pubDate>2025-12-26T07:39:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587738151659028480" data-draft-id="7587675443442991144" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»ä»£ç çœ‹ LangChainï¼šå¤§æ¨¡å‹åº”ç”¨å¼€å‘çš„å·¥ç¨‹åŒ–å®è·µä¸ç¯å¢ƒå‡†å¤‡"/> <meta itemprop="keywords" content="LangChain"/> <meta itemprop="datePublished" content="2025-12-26T07:39:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†»æ¢¨æ”¿å“¥"/> <meta itemprop="url" content="https://juejin.cn/user/2373184444182659"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»ä»£ç çœ‹ LangChainï¼šå¤§æ¨¡å‹åº”ç”¨å¼€å‘çš„å·¥ç¨‹åŒ–å®è·µä¸ç¯å¢ƒå‡†å¤‡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2373184444182659/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†»æ¢¨æ”¿å“¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T07:39:50.000Z" title="Fri Dec 26 2025 07:39:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä»ä»£ç çœ‹ LangChainï¼šå¤§æ¨¡å‹åº”ç”¨å¼€å‘çš„å·¥ç¨‹åŒ–å®è·µä¸ç¯å¢ƒå‡†å¤‡</h2>
<p>LangChain ä½œä¸ºè¿æ¥å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ä¸å®é™…ä¸šåŠ¡çš„æ¡¥æ¢ï¼Œå…¶æ ¸å¿ƒä»·å€¼åœ¨äºå°†å¤æ‚çš„ AI åº”ç”¨å¼€å‘æ‹†è§£ä¸ºå¯å¤ç”¨ã€å¯ç¼–æ’çš„æ¨¡å—åŒ–ç»„ä»¶ã€‚åœ¨å¼€å§‹ä½¿ç”¨å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå®Œæˆç¯å¢ƒæ­å»ºï¼Œä»¥ä¸‹å°†ç»“åˆä»£ç ç‰‡æ®µè¯¦ç»†è¯´æ˜ LangChain çš„ä½¿ç”¨æ–¹å¼åŠå®‰è£…æ­¥éª¤ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€ç¯å¢ƒå‡†å¤‡ï¼šå®‰è£… LangChain åŠç›¸å…³ä¾èµ–</h3>
<p>ä½¿ç”¨ LangChain å¼€å‘å‰ï¼Œéœ€å…ˆå®‰è£…æ ¸å¿ƒåŒ…åŠå¯¹åº”æ¨¡å‹é€‚é…å™¨ï¼ˆä»¥ä»£ç ä¸­ç”¨åˆ°çš„ DeepSeek ä¸ºä¾‹ï¼‰ï¼ŒåŒæ—¶éœ€å®‰è£…<code>dotenv</code>å¤„ç†ç¯å¢ƒå˜é‡ï¼ˆä»£ç ä¸­é€šè¿‡<code>import 'dotenv/config'</code>åŠ è½½ API å¯†é’¥ç­‰é…ç½®ï¼‰ã€‚</p>
<p>å®‰è£…å‘½ä»¤ï¼ˆä½¿ç”¨ npmï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…LangChainæ ¸å¿ƒåŒ…ã€DeepSeeké€‚é…å™¨åŠç¯å¢ƒå˜é‡å·¥å…·</span>
npm install @langchain/core @langchain/deepseek dotenv
</code></pre>
<p>è‹¥ä½¿ç”¨ yarnï¼š</p>
<pre><code class="hljs language-sql" lang="sql">yarn <span class="hljs-keyword">add</span> <span class="hljs-variable">@langchain</span><span class="hljs-operator">/</span>core <span class="hljs-variable">@langchain</span><span class="hljs-operator">/</span>deepseek dotenv
</code></pre>
<p>å®‰è£…å®Œæˆåï¼Œéœ€åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º<code>.env</code>æ–‡ä»¶ï¼Œé…ç½® DeepSeek API å¯†é’¥ï¼ˆä»£ç ä¸­é€šè¿‡ç¯å¢ƒå˜é‡è‡ªåŠ¨åŠ è½½ï¼‰ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">DEEPSEEK_API_KEY</span>=your_deepseek_api_key_here
</code></pre>
<h3 data-id="heading-2">äºŒã€åŸºç¡€è°ƒç”¨ï¼šå¿«é€Ÿè¿æ¥å¤§æ¨¡å‹</h3>
<p>æœ€åŸºç¡€çš„ LLM åº”ç”¨å¼€å‘ï¼Œæ ¸å¿ƒæ˜¯å®ç°ä¸æ¨¡å‹çš„äº¤äº’ã€‚åœ¨<code>main.js</code>ä¸­ï¼ŒLangChain é€šè¿‡é€‚é…å™¨æ¨¡å¼å±è”½äº†ä¸åŒæ¨¡å‹çš„åº•å±‚å·®å¼‚ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// main.js æ ¸å¿ƒä»£ç </span>
<span class="hljs-keyword">import</span> <span class="hljs-string">'dotenv/config'</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ChatDeepSeek</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@langchain/deepseek'</span>;

<span class="hljs-keyword">const</span> model = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatDeepSeek</span>({
  <span class="hljs-attr">model</span>: <span class="hljs-string">'deepseek-reasoner'</span>,
  <span class="hljs-attr">temperature</span>: <span class="hljs-number">0</span> <span class="hljs-comment">// æ§åˆ¶è¾“å‡ºéšæœºæ€§ï¼Œ0è¡¨ç¤ºç¡®å®šæ€§è¾“å‡º</span>
});

<span class="hljs-comment">// ç›´æ¥è°ƒç”¨æ¨¡å‹</span>
<span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> model.<span class="hljs-title function_">invoke</span>(<span class="hljs-string">'ç”¨ä¸€å¥è¯è§£é‡Šä»€ä¹ˆæ˜¯RAG?'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res.<span class="hljs-property">content</span>);
</code></pre>
<p>æ— éœ€å…³æ³¨ DeepSeek æ¨¡å‹çš„ API æ ¼å¼ã€è¯·æ±‚å¤´é…ç½®ç­‰ç»†èŠ‚ï¼Œä»…é€šè¿‡<code>ChatDeepSeek</code>ç±»å®ä¾‹åŒ–æ¨¡å‹ï¼Œè°ƒç”¨<code>invoke</code>æ–¹æ³•å³å¯å®Œæˆäº¤äº’ã€‚è¿™ç§å°è£…è®©å¼€å‘è€…èƒ½å¿«é€Ÿåˆ‡æ¢ä¸åŒæ¨¡å‹ï¼ˆå¦‚ä» DeepSeek åˆ° GPTï¼‰ï¼Œåªéœ€æ›¿æ¢é€‚é…å™¨ç±»ï¼Œå¤§å¹…é™ä½äº†å¤šæ¨¡å‹é›†æˆçš„æˆæœ¬ã€‚</p>
<h3 data-id="heading-3">ä¸‰ã€æç¤ºè¯æ¨¡æ¿ï¼šç»“æ„åŒ–ç®¡ç†åŠ¨æ€å†…å®¹</h3>
<p>æç¤ºè¯æ˜¯ LLM åº”ç”¨çš„ â€œè¾“å…¥å¤§è„‘â€ï¼Œä½†åŠ¨æ€å‚æ•°è°ƒæ•´ï¼ˆå¦‚è§’è‰²ã€å­—æ•°é™åˆ¶ï¼‰å¸¸è®©æç¤ºè¯ç»´æŠ¤å˜å¾—ç¹çã€‚<code>1.js</code>å±•ç¤ºäº† LangChain çš„<code>PromptTemplate</code>å¦‚ä½•è§£å†³è¿™ä¸€é—®é¢˜ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1.js æç¤ºè¯æ¨¡æ¿ç¤ºä¾‹</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">'dotenv/config'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ChatDeepSeek</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@langchain/deepseek'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">PromptTemplate</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@langchain/core/prompts'</span>;

<span class="hljs-comment">// å®šä¹‰æ¨¡æ¿ç»“æ„</span>
<span class="hljs-keyword">const</span> prompt = <span class="hljs-title class_">PromptTemplate</span>.<span class="hljs-title function_">fromTemplate</span>(<span class="hljs-string">`
ä½ æ˜¯ä¸€ä¸ª{role}ã€‚
è¯·ç”¨ä¸è¶…è¿‡{limit}å­—å›ç­”ä»¥ä¸‹é—®é¢˜ï¼š
{question}
`</span>);

<span class="hljs-comment">// åŠ¨æ€å¡«å……å‚æ•°</span>
<span class="hljs-keyword">const</span> promptStr = <span class="hljs-keyword">await</span> prompt.<span class="hljs-title function_">format</span>({
  <span class="hljs-attr">role</span>: <span class="hljs-string">'å‰ç«¯é¢è¯•å®˜'</span>,
  <span class="hljs-attr">limit</span>: <span class="hljs-string">'50'</span>,
  <span class="hljs-attr">question</span>: <span class="hljs-string">'ä»€ä¹ˆæ˜¯é—­åŒ…'</span>
});

<span class="hljs-comment">// å®ä¾‹åŒ–æ¨¡å‹å¹¶è°ƒç”¨</span>
<span class="hljs-keyword">const</span> model = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatDeepSeek</span>({
  <span class="hljs-attr">model</span>: <span class="hljs-string">'deepseek-reasoner'</span>,
  <span class="hljs-attr">temperature</span>: <span class="hljs-number">0.7</span>
});
<span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> model.<span class="hljs-title function_">invoke</span>(promptStr);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res.<span class="hljs-property">content</span>);
</code></pre>
<p>é€šè¿‡æ¨¡æ¿å®šä¹‰å›ºå®šæ ¼å¼ï¼Œå†ç”¨<code>format</code>æ–¹æ³•æ³¨å…¥åŠ¨æ€å‚æ•°ï¼Œå®ç°äº† â€œæ¨¡æ¿ä¸æ•°æ®åˆ†ç¦»â€ã€‚è¿™ç§æ–¹å¼ä¸ä»…è®©æç¤ºè¯æ›´æ˜“å¤ç”¨ï¼ˆå¦‚åŒä¸€æ¨¡æ¿å¯åˆ‡æ¢<code>role</code>ä¸º â€œåç«¯é¢è¯•å®˜â€ï¼‰ï¼Œè¿˜ä¾¿äºç‰ˆæœ¬ç®¡ç†å’Œæµ‹è¯•ï¼Œç¬¦åˆåç«¯å¼€å‘ä¸­ â€œé…ç½®ä¸é€»è¾‘åˆ†ç¦»â€ çš„å·¥ç¨‹åŒ–æ€æƒ³ã€‚</p>
<h3 data-id="heading-4">å››ã€ç®€å•å·¥ä½œæµï¼šç”¨ Chain ä¸²è”ä»»åŠ¡èŠ‚ç‚¹</h3>
<p>å®é™…ä¸šåŠ¡ä¸­ï¼ŒAI ä»»åŠ¡å¾€å¾€éœ€è¦ â€œæç¤ºè¯å¤„ç†â†’æ¨¡å‹è°ƒç”¨â€ çš„å›ºå®šæµç¨‹ã€‚<code>2.js</code>å±•ç¤ºäº† LangChain çš„<code>pipe</code>æ–¹æ³•å¦‚ä½•å°†ç»„ä»¶ä¸²è”ä¸ºç®€å•å·¥ä½œæµï¼ˆChainï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 2.js ç®€å•Chainç¤ºä¾‹</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">'dotenv/config'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ChatDeepSeek</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@langchain/deepseek'</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">PromptTemplate</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@langchain/core/prompts'</span>

<span class="hljs-keyword">const</span> model = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatDeepSeek</span>({
  <span class="hljs-attr">model</span>: <span class="hljs-string">'deepseek-reasoner'</span>,
  <span class="hljs-attr">temperature</span>: <span class="hljs-number">0.7</span>
})

<span class="hljs-comment">// å®šä¹‰æç¤ºè¯æ¨¡æ¿</span>
<span class="hljs-keyword">const</span> prompt = <span class="hljs-title class_">PromptTemplate</span>.<span class="hljs-title function_">fromTemplate</span>(<span class="hljs-string">`
  ä½ æ˜¯ä¸€ä¸ªå‰ç«¯ä¸“å®¶ï¼Œç”¨ä¸€å¥è¯è§£é‡Š: {topic}  
`</span>);

<span class="hljs-comment">// ç”¨pipeè¿æ¥æ¨¡æ¿ä¸æ¨¡å‹ï¼Œå½¢æˆå·¥ä½œæµ</span>
<span class="hljs-keyword">const</span> chain = prompt.<span class="hljs-title function_">pipe</span>(model);

<span class="hljs-comment">// æ‰§è¡Œå·¥ä½œæµï¼ˆç›´æ¥ä¼ å…¥å‚æ•°å³å¯è§¦å‘å®Œæ•´æµç¨‹ï¼‰</span>
<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> chain.<span class="hljs-title function_">invoke</span>({ <span class="hljs-attr">topic</span>: <span class="hljs-string">'é—­åŒ…'</span> });
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">text</span>);
</code></pre>
<p><code>prompt.pipe(model)</code>çš„æœ¬è´¨æ˜¯å°† â€œæç¤ºè¯æ ¼å¼åŒ–â€ ä¸ â€œæ¨¡å‹è°ƒç”¨â€ ä¸¤ä¸ªæ­¥éª¤ä¸²è”ä¸ºä¸€ä¸ªå¯æ‰§è¡Œå•å…ƒã€‚å¼€å‘è€…æ— éœ€æ‰‹åŠ¨ç¼–å†™ â€œå…ˆæ ¼å¼åŒ–æç¤ºè¯ã€å†è°ƒç”¨æ¨¡å‹â€ çš„é‡å¤ä»£ç ï¼Œç›´æ¥é€šè¿‡<code>invoke</code>ä¼ å…¥å‚æ•°å³å¯è§¦å‘æ•´ä¸ªæµç¨‹ï¼Œç®€åŒ–äº†ä»£ç é€»è¾‘ã€‚</p>
<h3 data-id="heading-5">äº”ã€å¤æ‚å·¥ä½œæµï¼šå¤šæ­¥éª¤ä»»åŠ¡çš„ç¼–æ’</h3>
<p>å½“ä¸šåŠ¡éœ€è¦å¤šè½® AI äº¤äº’ï¼ˆå¦‚ â€œå…ˆè§£é‡Šæ¦‚å¿µâ†’å†æ€»ç»“è¦ç‚¹â€ï¼‰ï¼ŒLangChain çš„<code>RunnableSequence</code>å¯å®ç°å¤æ‚å·¥ä½œæµçš„ç¼–æ’ã€‚<code>3.js</code>å±•ç¤ºäº†è¿™ä¸€èƒ½åŠ›ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 3.js å¤šæ­¥éª¤å·¥ä½œæµç¤ºä¾‹</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">'dotenv/config'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ChatDeepSeek</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@langchain/deepseek'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">PromptTemplate</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@langchain/core/prompts'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">RunnableSequence</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@langchain/core/runnables'</span>;

<span class="hljs-keyword">const</span> model = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatDeepSeek</span>({
  <span class="hljs-attr">model</span>: <span class="hljs-string">'deepseek-reasoner'</span>,
  <span class="hljs-attr">temperature</span>: <span class="hljs-number">0.7</span>
})

<span class="hljs-comment">// ç¬¬ä¸€æ­¥ï¼šå®šä¹‰â€œè§£é‡Šæ¦‚å¿µâ€çš„æ¨¡æ¿ä¸Chain</span>
<span class="hljs-keyword">const</span> explainPrompt = <span class="hljs-title class_">PromptTemplate</span>.<span class="hljs-title function_">fromTemplate</span>(<span class="hljs-string">`
  ä½ æ˜¯ä¸€ä¸ªå‰ç«¯ä¸“å®¶ï¼Œè¯·è¯¦ç»†ä»‹ç»ä»¥ä¸‹æ¦‚å¿µ: {topic}
  è¦æ±‚ï¼šè¦†ç›–å®šä¹‰ã€åŸç†ã€ä½¿ç”¨æ–¹å¼ï¼Œä¸è¶…è¿‡300å­—ã€‚
`</span>);
<span class="hljs-keyword">const</span> explainChain = explainPrompt.<span class="hljs-title function_">pipe</span>(model);

<span class="hljs-comment">// ç¬¬äºŒæ­¥ï¼šå®šä¹‰â€œæ€»ç»“è¦ç‚¹â€çš„æ¨¡æ¿ä¸Chain</span>
<span class="hljs-keyword">const</span> summaryPrompt = <span class="hljs-title class_">PromptTemplate</span>.<span class="hljs-title function_">fromTemplate</span>(<span class="hljs-string">`
  è¯·å°†ä»¥ä¸‹å‰ç«¯æ¦‚å¿µæ€»ç»“ä¸º3ä¸ªæ ¸å¿ƒè¦ç‚¹ (æ¯ç‚¹ä¸è¶…è¿‡20å­—):
  {explanation}
`</span>);
<span class="hljs-keyword">const</span> summaryChain = summaryPrompt.<span class="hljs-title function_">pipe</span>(model);

<span class="hljs-comment">// ä¸²è”ä¸ºå®Œæ•´å·¥ä½œæµ</span>
<span class="hljs-keyword">const</span> fullChain = <span class="hljs-title class_">RunnableSequence</span>.<span class="hljs-title function_">from</span>([
  <span class="hljs-function">(<span class="hljs-params">input</span>) =&gt;</span> explainChain.<span class="hljs-title function_">invoke</span>({ <span class="hljs-attr">topic</span>: input.<span class="hljs-property">topic</span> }).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res.<span class="hljs-property">text</span>),
  <span class="hljs-function">(<span class="hljs-params">explanation</span>) =&gt;</span> summaryChain.<span class="hljs-title function_">invoke</span>({ explanation }).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-string">`çŸ¥è¯†ç‚¹: <span class="hljs-subst">${explanation}</span> æ€»ç»“: <span class="hljs-subst">${res.text}</span>`</span>)
]);

<span class="hljs-comment">// æ‰§è¡Œå®Œæ•´æµç¨‹</span>
<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fullChain.<span class="hljs-title function_">invoke</span>({ <span class="hljs-attr">topic</span>: <span class="hljs-string">'é—­åŒ…'</span> });
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response);
</code></pre>
<p>é€šè¿‡<code>RunnableSequence.from</code>ï¼Œæˆ‘ä»¬å°† â€œè§£é‡Šæ¦‚å¿µâ€ å’Œ â€œæ€»ç»“è¦ç‚¹â€ ä¸¤ä¸ªæ­¥éª¤æŒ‰é¡ºåºä¸²è”ï¼šç¬¬ä¸€æ­¥æ¥æ”¶<code>topic</code>å‚æ•°ç”Ÿæˆè¯¦ç»†è§£é‡Šï¼Œç¬¬äºŒæ­¥å°†è§£é‡Šç»“æœä½œä¸ºè¾“å…¥ç”Ÿæˆæ€»ç»“ï¼Œæœ€ç»ˆè¿”å›æ•´åˆç»“æœã€‚è¿™ç§ç¼–æ’èƒ½åŠ›è®©å¤æ‚ AI ä»»åŠ¡ï¼ˆå¦‚æ™ºèƒ½åˆ†æã€å¤šè½®å¯¹è¯ï¼‰çš„å¼€å‘å˜å¾—ç›´è§‚å¯æ§ï¼Œæ— éœ€æ‰‹åŠ¨å¤„ç†æ­¥éª¤é—´çš„å‚æ•°ä¼ é€’ä¸å¼‚æ­¥é€»è¾‘ã€‚</p>
<h3 data-id="heading-6">æ€»ç»“</h3>
<p>é€šè¿‡å®‰è£…æŒ‡ä»¤ä¸ä»£ç ç¤ºä¾‹å¯ä»¥çœ‹å‡ºï¼ŒLangChain é€šè¿‡ â€œç¯å¢ƒé€‚é…â†’æ¨¡å‹å°è£…â†’æç¤ºè¯ç®¡ç†â†’å·¥ä½œæµç¼–æ’â€ çš„å…¨æµç¨‹æ”¯æŒï¼Œè®©å¤§æ¨¡å‹åº”ç”¨å¼€å‘ä» â€œé›¶æ•£è„šæœ¬â€ å‡çº§ä¸º â€œå·¥ç¨‹åŒ–å¼€å‘â€ã€‚å¼€å‘è€…åªéœ€å…³æ³¨ä¸šåŠ¡é€»è¾‘ï¼Œå³å¯å¿«é€Ÿæ„å»ºçµæ´»ã€å¯æ‰©å±•çš„ AI åº”ç”¨ï¼Œå¤§å¹…é™ä½äº†å¤§æ¨¡å‹é›†æˆçš„æŠ€æœ¯é—¨æ§›ã€‚# ä»ä»£ç çœ‹ LangChainï¼šå¤§æ¨¡å‹åº”ç”¨å¼€å‘çš„å·¥ç¨‹åŒ–å®è·µä¸ç¯å¢ƒå‡†å¤‡</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¡ˆä¾‹+å›¾è§£å¸¦ä½ ä¸€æ–‡è¯»æ‡‚Svgã€Canvasã€Cssã€JsåŠ¨ç”»ğŸ”¥ğŸ”¥ï¼ˆ4k+å­—ï¼‰]]></title>    <link>https://juejin.cn/post/7587811143109509171</link>    <guid>https://juejin.cn/post/7587811143109509171</guid>    <pubDate>2025-12-26T07:43:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587811143109509171" data-draft-id="7587903505134878770" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¡ˆä¾‹+å›¾è§£å¸¦ä½ ä¸€æ–‡è¯»æ‡‚Svgã€Canvasã€Cssã€JsåŠ¨ç”»ğŸ”¥ğŸ”¥ï¼ˆ4k+å­—ï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,Canvas"/> <meta itemprop="datePublished" content="2025-12-26T07:43:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Lsx_"/> <meta itemprop="url" content="https://juejin.cn/user/1442981392682829"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¡ˆä¾‹+å›¾è§£å¸¦ä½ ä¸€æ–‡è¯»æ‡‚Svgã€Canvasã€Cssã€JsåŠ¨ç”»ğŸ”¥ğŸ”¥ï¼ˆ4k+å­—ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1442981392682829/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Lsx_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T07:43:15.000Z" title="Fri Dec 26 2025 07:43:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;color:#282d36}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px;color:#2f845e}.markdown-body h2{font-size:22px;display:inline-block;font-weight:700;background:#2f845e;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(47,132,194,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 32px);border-bottom:3px solid #2f845e}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%;box-shadow:6px 6px 6px #888}.markdown-body hr{border:none;border-top:1px solid rgba(66,185,131,.15);margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#f6ffed;color:#52c41a;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:16px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#262626;border:1px solid #2f845e;border-top:8px solid #2f845e;background:linear-gradient(180deg,rgba(66,185,131,.1),transparent)!important}.markdown-body pre&gt;code.hljs[lang]:before{top:8px!important;color:#2f845e!important}.markdown-body pre&gt;code.language-awesome_error{border:1px solid #ff4d4f!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#ff4d4f!important;background:#fff2f0!important}.markdown-body pre&gt;code.language-awesome_error:before{content:"!"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#ff4d4f!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_warn{border:1px solid #ffc46f!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#ffc46f!important;background:#fffbe6!important}.markdown-body pre&gt;code.language-awesome_warn:before{content:"â˜‚"!important;position:absolute;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#ffc46f!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_success{border:1px solid #52c41a!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#52c41a!important;background:#f6ffed!important}.markdown-body pre&gt;code.language-awesome_success:before{content:"âœ“"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#52c41a!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_info{border:1px solid #1890ff!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#1890ff!important;background:#e6f7ff!important}.markdown-body pre&gt;code.language-awesome_info:before{content:"i"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#1890ff!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body strong{background-color:inherit;color:#2f845e}.markdown-body em{background-color:inherit;color:#949415}.markdown-body a{text-decoration:none;color:#2f8e54;border-bottom:1px solid #3f9e64}.markdown-body a:active,.markdown-body a:hover{color:#3f9e64}.markdown-body a[class^=footnote]{margin-left:4px}.markdown-body a:before{content:"â¤ "}.markdown-body table{font-size:12px;width:100%;max-width:100%;overflow:auto;border:2px solid #2f8e54}.markdown-body thead{background:#2f8e54;color:#fff;text-align:left;font-weight:700}.markdown-body tr:nth-child(2n){background-color:rgba(153,255,188,.1)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:22px}.markdown-body td{min-width:120px}.markdown-body blockquote{padding:1px 22px;margin:22px 0;border-left:6px solid #2f845e;background-color:rgba(66,185,131,.1);border-radius:2px}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#2f845e}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px;color:#282d36}.markdown-body del{color:#2f845e}.markdown-body input[type=checkbox]:checked:before{content:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA/klEQVQ4T72TMU7DQBBF318XdFR06egQEnAXRINEGlqgowoIR8AF4AZOZ4JEGq5AC5EixBU4A55BNrEVHAcSBTHlaubt37/zxZKlcn7n6mDPXJvz8IJ89HzWu8t7C8D2dfsY52ae4apHnLx0ktsCsHXZjiUuFgG40x2eJ/H/AhztB+zDUTpLwWj8jGkzxSHiHaMPrDQC8sMoilKzLAUqiKQjmb+ZuAdW80tmelCHODoNgSfP7AFprTTaRTzsJN1GEyuIZ7uW6TEEHwCtyV/6EVBKJHhfzgC0Xv/iXwEFBF4FG0378bd7sPQq5xK/hSnk6sdlX3mZrKkwLZKBeu8n9XuWEUE7X+YAAAAASUVORK5CYII=);position:relative;top:-1px;left:-1px}.markdown-body .math .katex{font-family:Menlo,Monaco,Consolas,Courier New,monospace;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#f6ffed;color:#52c41a;font-size:.87em;padding:.065em .4em}@media (max-width:720px){.markdown-body h1{font-size:22px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>åŠ¨ç”»åœ¨å‰ç«¯å¼€å‘ä¸­æ‰®æ¼”ç€é‡è¦çš„è§’è‰²ã€‚å®ƒä¸ä»…å¯ä»¥æå‡ç”¨æˆ·ä½“éªŒï¼Œè¿˜å¯ä»¥ä½¿ç•Œé¢æ›´åŠ ç”ŸåŠ¨å’Œæœ‰è¶£ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨å‰ç«¯åŠ¨ç”»çš„å„ç§å®ç°æ–¹å¼ï¼ŒåŒ…æ‹¬ CSS åŠ¨ç”»ã€JavaScript åŠ¨ç”»ã€SVG åŠ¨ç”»ç­‰ã€‚æˆ‘ä»¬è¿˜å°†è®¨è®ºä¸€äº›è§¦å‘åŠ¨ç”»çš„æ–¹å¼å’ŒåŠ¨ç”»åœ¨ç”¨æˆ·ä½“éªŒä¸­çš„æœ€ä½³å®è·µã€‚</p>
<h2 data-id="heading-1">å‰ç«¯åŠ¨ç”»åˆ†ç±»</h2>
<ul>
<li>
<p><strong><code>CSS åŠ¨ç”»</code></strong></p>
<ul>
<li>
<p><strong>CSS Transition</strong><br/>
CSS è¿‡æ¸¡ï¼Œå±äº<strong>è¡¥é—´åŠ¨ç”»</strong>ï¼Œå³è®¾ç½®å…³é”®å¸§çš„åˆå§‹çŠ¶æ€ï¼Œç„¶ååœ¨å¦ä¸€ä¸ªå…³é”®å¸§æ”¹å˜è¿™ä¸ªçŠ¶æ€ï¼Œæ¯”å¦‚å¤§å°ã€é¢œè‰²ã€é€æ˜åº¦ç­‰ï¼Œæµè§ˆå™¨å°†è‡ªåŠ¨æ ¹æ®äºŒè€…ä¹‹é—´å¸§çš„å€¼åˆ›å»ºçš„åŠ¨ç”»ã€‚</p>
</li>
<li>
<p><strong>CSS Animation</strong><br/>
CSS åŠ¨ç”»ï¼Œå¯ä»¥ç†è§£æ˜¯ <code>CSS Transition</code> çš„åŠ å¼ºç‰ˆï¼Œå®ƒæ—¢å¯ä»¥å®ç° <strong>è¡¥é—´åŠ¨ç”»</strong> çš„åŠ¨ç”»æ•ˆæœï¼Œä¹Ÿå¯ä»¥ä½¿å…¶ä»¥ <strong>é€å¸§åŠ¨ç”»</strong> çš„æ–¹å¼è¿›è¡Œç»˜åˆ¶ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong><code>SVG åŠ¨ç”»</code></strong></p>
<ul>
<li>SVG åŠ¨ç”»ç”¨äºçŸ¢é‡å›¾å½¢ï¼Œæä¾›äº†é«˜è´¨é‡çš„åŠ¨ç”»æ•ˆæœï¼Œå¸¸ç”¨äºå›¾æ ‡å’Œå›¾å½¢åŠ¨ç”»ã€‚å¯ä»¥ä½¿ç”¨ SMIL åœ¨SVGä¸­å®šä¹‰åŠ¨ç”»ã€‚åŒæ ·çš„ä¹Ÿå¯ä»¥ä½¿ç”¨cssæˆ–è€…jsæ¥æ§åˆ¶svgåŠ¨ç”»ã€‚</li>
</ul>
</li>
<li>
<p><strong><code>Canvas åŠ¨ç”»</code></strong></p>
<ul>
<li>
<p>é€šè¿‡ç»“åˆä½¿ç”¨Â <code>requestAnimationFrame</code>ã€è·¯å¾„å’Œå˜æ¢ç­‰æŠ€æœ¯å¯¹ç”»å¸ƒçš„å…ƒç´ è¿›è¡Œæ“¦é™¤å’Œé‡æ–°ç»˜åˆ¶ï¼Œå¯ä»¥å®ç°å¤æ‚çš„åŠ¨ç”»æ•ˆæœã€‚å¦å¤–Canvasè¿˜å¯ä»¥ç”¨äºç»˜åˆ¶å¤æ‚çš„èƒŒæ™¯æˆ–é™æ€å†…å®¹ï¼Œä»è€Œå‡å°‘æ¯å¸§çš„ç»˜åˆ¶å·¥ä½œé‡ã€‚</p>
</li>
<li>
<p>å¯ä»¥å‚è€ƒæˆ‘çš„ä¸€ç¯‡å…³äºcanvasåˆ¶ä½œåŠ¨ç”»çš„æ–‡ç« ï¼š<a href="https://juejin.cn/post/7389211334641270793" target="_blank" title="https://juejin.cn/post/7389211334641270793">ç”¨Canvasç»˜åˆ¶ä¸€ä¸ªé«˜å¯é…ç½®çš„åœ†å½¢è¿›åº¦æ¡</a></p>
</li>
</ul>
</li>
<li>
<p><strong><code>JS åŠ¨ç”»</code></strong></p>
<ul>
<li>
<p><strong>setTimeout</strong> / <strong>setInterval</strong> / <strong>requestAnimationFrame</strong><br/>
<code>setTimeout</code> å’Œ <code>setInterval</code> è¿™ä¸¤ä¸ª API è®¾å®šçš„æ—¶é—´ä¼šå› ä¸ºæµè§ˆå™¨å½“å‰å·¥ä½œè´Ÿè½½è€Œæœ‰æ‰€åå·®ï¼Œè€Œä¸”æ— æ³•ä¸æµè§ˆå™¨çš„ç»˜åˆ¶å¸§ä¿æŒåŒæ­¥ã€‚æ‰€ä»¥æ‰æœ‰äº† <strong>ä¸æµè§ˆå™¨çš„ç»˜åˆ¶å¸§åŒæ­¥</strong> çš„åŸç”Ÿ API <code>requestAnimationFrame</code>ï¼Œä»¥å–ä»£ <code>setTimeout</code> å’Œ <code>setInterval</code> å®ç°åŠ¨ç”»ã€‚</p>
</li>
<li>
<p><strong>Web Animations API</strong><br/>
æµè§ˆå™¨åŠ¨ç”» APIï¼Œé€šè¿‡ JavaScript æ“ä½œã€‚è¿™äº› API è¢«è®¾è®¡æˆÂ <code>CSS Transition</code> å’Œ <code>CSS Animation</code> çš„æ¥å£ï¼Œå¾ˆå®¹æ˜“é€šè¿‡ JS çš„æ–¹å¼å®ç° CSS åŠ¨ç”»ï¼Œå®ƒæ˜¯å¯¹åŠ¨ç”»åŒ–çš„æ”¯æŒæœ€æœ‰æ•ˆçš„æ–¹å¼ä¹‹ä¸€ã€‚</p>
</li>
</ul>
</li>
</ul>
<h2 data-id="heading-2">css åŠ¨ç”»</h2>
<h3 data-id="heading-3">cssè¿‡æ¸¡åŠ¨ç”» <code>transition</code></h3>
<h4 data-id="heading-4">æ³¨æ„</h4>
<p>ç”±äºæµè§ˆå™¨æ˜¯æ ¹æ®æ ·å¼å·®å¼‚åŒ–çš„ä¸¤å¸§è‡ªåŠ¨è®¡ç®—å¹¶è¿‡æ¸¡ï¼Œæ‰€ä»¥Â <code>transition</code>Â åªæ”¯æŒå¯è¯†åˆ«ä¸­é—´å€¼çš„å±æ€§ (å¦‚å¤§å°ã€é¢œè‰²ã€ä½ç½®ã€é€æ˜åº¦ç­‰)ï¼Œè€Œå¦‚ display å±æ€§åˆ™ä¸æ”¯æŒã€‚</p>
<h4 data-id="heading-5">è¯­æ³•å®šä¹‰</h4>
<ul>
<li>
<p><code>transition-property</code>ï¼š æŒ‡å®šå“ªä¸ªæˆ–å“ªäº› CSS å±æ€§ç”¨äºè¿‡æ¸¡ã€‚åªæœ‰æŒ‡å®šçš„å±æ€§æ‰ä¼šåœ¨è¿‡æ¸¡ä¸­å‘ç”ŸåŠ¨ç”»ï¼Œå…¶ä»–å±æ€§ä»å¦‚é€šå¸¸é‚£æ ·ç¬é—´å˜åŒ–ã€‚</p>
</li>
<li>
<p><code>transition-duration</code>ï¼š æŒ‡å®šè¿‡æ¸¡çš„æ—¶é•¿ã€‚ä½ å¯ä»¥ä¸ºæ‰€æœ‰å±æ€§æŒ‡å®šä¸€ä¸ªå€¼ï¼Œæˆ–è€…æŒ‡å®šå¤šä¸ªå€¼ï¼Œæˆ–è€…ä¸ºæ¯ä¸ªå±æ€§æŒ‡å®šä¸åŒçš„æ—¶é•¿ã€‚</p>
</li>
<li>
<p><code>transition-timing-function</code>ï¼š æŒ‡å®šä¸€ä¸ªç¼“åŠ¨å‡½æ•°ï¼Œå®šä¹‰å±æ€§å€¼æ€ä¹ˆå˜åŒ–ã€‚å¸¸è§çš„ç¼“åŠ¨å‡½æ•°æ˜¯ä¸€ä¸ªä¸‰æ¬¡è´å¡å°”æ›²çº¿ ( <code>cubic-bezier(&lt;x1&gt;, &lt;y1&gt;, &lt;x2&gt;, &lt;y2&gt;)</code> )ã€‚å½“ç„¶ä¹Ÿå¯ä»¥é€‰æ‹©å…³é”®å­—</p>
<ul>
<li><strong>linear</strong>ï¼š<code>cubic-bezier(0.0, 0.0, 1.0, 1.0)</code></li>
<li><strong>ease</strong>ï¼š<code>cubic-bezier(0.25, 0.1, 0.25, 1.0)</code></li>
<li><strong>ease-in</strong>ï¼š<code>cubic-bezier(0.42, 0.0, 1.0, 1.0)</code></li>
<li><strong>ease-out</strong>ï¼š<code>cubic-bezier(0.0, 0.0, 0.58, 1.0)</code></li>
<li><strong>ease-in-out</strong>ï¼š<code>cubic-bezier(0.42, 0.0, 0.58, 1.0)</code></li>
</ul>
</li>
<li>
<p><code>transition-delay</code>ï¼š æŒ‡å®šå»¶è¿Ÿï¼Œå³å±æ€§å¼€å§‹å˜åŒ–æ—¶ä¸è¿‡æ¸¡å¼€å§‹å‘ç”Ÿæ—¶ä¹‹é—´çš„æ—¶é•¿ã€‚</p>
</li>
</ul>
<h4 data-id="heading-6">ä»£ç ç¤ºä¾‹</h4>
<pre><code class="hljs language-css" lang="css">  <span class="hljs-comment">/* å•æ¡ ç®€å†™å½¢å¼ */</span>
  <span class="hljs-attribute">transition</span>: 
    &lt;property&gt; &lt;duration&gt; &lt;timing-function&gt; &lt;delay&gt;;
  
  
  <span class="hljs-comment">/* å¤šæ¡ ç®€å†™å½¢å¼ */</span>
  <span class="hljs-attribute">transition</span>: 
    &lt;property&gt; &lt;duration&gt; &lt;timing-function&gt; &lt;delay&gt;,
    &lt;property&gt; &lt;duration&gt; &lt;timing-function&gt; &lt;delay&gt;,
    ...;


  <span class="hljs-comment">/* å•æ¡ å­å±æ€§å½¢å¼ */</span>
  <span class="hljs-attribute">transition-property</span>: &lt;property-name&gt;;
  <span class="hljs-attribute">transition-duration</span>: &lt;duration-time&gt;;
  <span class="hljs-attribute">transition-timing-function</span>: &lt;timing-function&gt;;
  <span class="hljs-attribute">transition-delay</span>: &lt;duration-time&gt;;
  
  
  <span class="hljs-comment">/* å¤šæ¡ å­å±æ€§å½¢å¼ */</span>
  <span class="hljs-attribute">transition-property</span>: &lt;property-name&gt; [, &lt;property-name&gt;, ...];
  <span class="hljs-attribute">transition-duration</span>: &lt;duration-time&gt; [, &lt;duration-time&gt;, ...];
  <span class="hljs-attribute">transition-timing-function</span>: [, &lt;cubic-bezier&gt;, ...];
  <span class="hljs-attribute">transition-delay</span>: [, &lt;duration-time&gt;, ...];
  
  
  // å¦‚æœä»»æ„å±æ€§å€¼åˆ—è¡¨çš„é•¿åº¦æ¯”å…¶ä»–å±æ€§å€¼åˆ—è¡¨è¦çŸ­ï¼Œåˆ™å…¶ä¸­çš„å€¼ä¼šé‡å¤ä½¿ç”¨ä»¥ä¾¿åŒ¹é…
  
  // å¦‚æœæŸä¸ªå±æ€§çš„å€¼åˆ—è¡¨é•¿äºÂ `<span class="hljs-attribute">transition-property</span>`Â çš„å±æ€§ï¼Œåˆ™å°†è¢«æˆªçŸ­
  

</code></pre>
<h4 data-id="heading-7">cssè¿‡æ¸¡åŠ¨ç”» è§¦å‘æ–¹å¼</h4>
<h5 data-id="heading-8">1. ä¼ªç±»è§¦å‘ï¼ˆ:hoverã€:focusã€:activeç­‰ï¼‰</h5>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.button</span> {
  <span class="hljs-attribute">background-color</span>: blue;
  <span class="hljs-attribute">transition</span>: background-color <span class="hljs-number">0.3s</span> ease;
}

<span class="hljs-selector-class">.button</span><span class="hljs-selector-pseudo">:hover</span> {
  <span class="hljs-attribute">background-color</span>: red;
}

</code></pre>
<h5 data-id="heading-9">2. ç±»ååˆ‡æ¢ï¼ˆé€šè¿‡JSåŠ¨æ€åˆ‡æ¢ç±»åæ¥è§¦å‘è¿‡æ¸¡æ•ˆæœï¼‰</h5>
<pre><code class="hljs language-js" lang="js">&lt;button id=<span class="hljs-string">"toggleButton"</span>&gt;<span class="hljs-title class_">Toggle</span>&lt;/button&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"box"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"box"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
  <span class="hljs-selector-class">.box</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;
    <span class="hljs-attribute">background-color</span>: blue;
    <span class="hljs-attribute">transition</span>: background-color <span class="hljs-number">0.3s</span> ease;
  }

  <span class="hljs-selector-class">.box</span><span class="hljs-selector-class">.active</span> {
    <span class="hljs-attribute">background-color</span>: red;
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'toggleButton'</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'box'</span>).<span class="hljs-property">classList</span>.<span class="hljs-title function_">toggle</span>(<span class="hljs-string">'active'</span>);
  });
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

</code></pre>
<h5 data-id="heading-10">3. å±æ€§å˜åŒ–</h5>
<pre><code class="hljs language-js" lang="js">&lt;button id=<span class="hljs-string">"toggleButton"</span>&gt;<span class="hljs-title class_">Toggle</span>&lt;/button&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"box"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"box"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
  <span class="hljs-selector-class">.box</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;
    <span class="hljs-attribute">background-color</span>: blue;
    <span class="hljs-attribute">transition</span>: background-color <span class="hljs-number">0.3s</span> ease;
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'toggleButton'</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> box = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'box'</span>);
    box.<span class="hljs-property">style</span>.<span class="hljs-property">backgroundColor</span> = box.<span class="hljs-property">style</span>.<span class="hljs-property">backgroundColor</span> === <span class="hljs-string">'red'</span> ? <span class="hljs-string">'blue'</span> : <span class="hljs-string">'red'</span>;
  });
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

</code></pre>
<h5 data-id="heading-11">4. ä¼ªå…ƒç´ è§¦å‘ï¼ˆé€šè¿‡ä¼ªå…ƒç´ å¦‚<code>::before</code>ã€<code>::after</code>çš„çŠ¶æ€å˜åŒ–æ¥è§¦å‘è¿‡æ¸¡æ•ˆæœã€‚ï¼‰</h5>
<pre><code class="hljs language-css" lang="css">&lt;<span class="hljs-selector-tag">div</span> class="box"&gt;&lt;/<span class="hljs-selector-tag">div</span>&gt;

&lt;style&gt;
  <span class="hljs-selector-class">.box</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;
    <span class="hljs-attribute">position</span>: relative;
  }

  <span class="hljs-selector-class">.box</span><span class="hljs-selector-pseudo">::before</span> {
    <span class="hljs-attribute">content</span>: <span class="hljs-string">''</span>;
    <span class="hljs-attribute">position</span>: absolute;
    <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
    <span class="hljs-attribute">background-color</span>: blue;
    <span class="hljs-attribute">transition</span>: background-color <span class="hljs-number">0.3s</span> ease;
  }

  <span class="hljs-selector-class">.box</span><span class="hljs-selector-pseudo">:hover</span><span class="hljs-selector-pseudo">::before</span> {
    <span class="hljs-attribute">background-color</span>: red;
  }
&lt;/style&gt;

</code></pre>
<h3 data-id="heading-12">cssåŠ¨ç”» <code>animation</code></h3>
<h4 data-id="heading-13">æ³¨æ„</h4>
<p>CSS Animation å…·å¤‡äº†å¯¹ <strong>å…³é”®å¸§å’Œå¾ªç¯æ¬¡æ•°</strong> çš„è‡ªå®šä¹‰èƒ½åŠ›ã€‚CSS Animation åœ¨å®ç°åƒ CSS Transition <strong>è¡¥é—´åŠ¨ç”»</strong> æ•ˆæœæ—¶ï¼Œè¿˜å¯ä»¥åœ¨èµ·å§‹å¸§å’Œç»“æŸå¸§ä¹‹é—´è‡ªå®šä¹‰ä¸­é—´å¸§ï¼Œä½¿å¾—åŠ¨ç”»æ›´åŠ å¹³æ»‘è¿‡æ¸¡çš„åŒæ—¶ï¼Œå¯¹åŠ¨ç”»æœ‰äº†æ›´å¥½çš„æ§åˆ¶å’Œè‡ªå®šä¹‰èƒ½åŠ›ã€‚</p>
<h4 data-id="heading-14">è¯­æ³•å®šä¹‰</h4>
<p>å…ˆåˆ›å»ºä¸€ä¸ªå¸¦åç§°çš„Â <code>@keyframes</code>Â è§„åˆ™ï¼Œä»¥ä¾¿åç»­ä½¿ç”¨Â <code>animation-name</code>Â å±æ€§å°†åŠ¨ç”»åŒå…¶å…³é”®å¸§å£°æ˜è¿›è¡ŒåŒ¹é…ã€‚æ¯ä¸ªè§„åˆ™åŒ…å«å¤šä¸ªå…³é”®å¸§ï¼Œä¹Ÿå°±æ˜¯ä¸€æ®µæ ·å¼å—è¯­å¥ï¼Œæ¯ä¸ªå…³é”®å¸§æœ‰ä¸€ä¸ªç™¾åˆ†æ¯”å€¼ä½œä¸ºåç§°ï¼Œä»£è¡¨åœ¨åŠ¨ç”»è¿›è¡Œä¸­ï¼Œåœ¨å“ªä¸ªé˜¶æ®µè§¦å‘è¿™ä¸ªå¸§æ‰€åŒ…å«çš„æ ·å¼ã€‚</p>
<ul>
<li>
<p><code>animation-name</code>ï¼šæŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ª @keyframes çš„åç§°ï¼Œæè¿°äº†è¦åº”ç”¨äºå…ƒç´ çš„åŠ¨ç”»ã€‚å¤šä¸ª @keyframes ä»¥é€—å·åˆ†éš”ã€‚</p>
</li>
<li>
<p><code>animation-duration</code>ï¼šè®¾ç½®åŠ¨ç”»å®Œæˆä¸€ä¸ªåŠ¨ç”»å‘¨æœŸæ‰€éœ€çš„æ—¶é—´ï¼Œéœ€è¦æŒ‡å®šå•ä½ï¼Œå¦‚ <code>1s</code>ã€<code>500ms</code>ã€‚</p>
</li>
<li>
<p><code>animation-delay</code>ï¼šæŒ‡å®šæ‰§è¡ŒåŠ¨ç”»ä¹‹å‰çš„ç­‰å¾…æ—¶é—´ã€‚åŠ¨ç”»å¯ä»¥ç¨åå¼€å§‹ã€ç«‹å³ä»å¼€å¤´å¼€å§‹ã€ç«‹å³åœ¨åŠ¨ç”»ä¸­é€”æ’­æ”¾ <strong>(å¦‚ <code>-1s</code>)</strong> ã€‚å…¶ä¸­ <code>-1s</code> æ„æ€æ˜¯åŠ¨ç”»ç«‹å³ä» 1s å¤„å¼€å§‹ã€‚</p>
</li>
<li>
<p><code>animation-iteration-count</code>ï¼šè®¾ç½®åŠ¨ç”»åºåˆ—åœ¨åœæ­¢å‰åº”æ’­æ”¾çš„æ¬¡æ•°ï¼Œæœ‰æ•ˆå€¼ <code>0</code>ã€æ­£æ•´æ•°ã€æ­£å°æ•°ã€æ— é™å¾ªç¯ <code>infinite</code>ã€‚</p>
</li>
<li>
<p><code>animation-direction</code>ï¼šè®¾ç½®åŠ¨ç”»æ˜¯æ­£å‘æ’­æ”¾ <code>normal</code>ã€åå‘æ’­æ”¾ <code>reverse</code>ã€æ­£å‘äº¤æ›¿æ’­æ”¾ <code>alternate</code>ã€åå‘äº¤æ›¿æ’­æ”¾ <code>alternate-reverse</code>ã€‚</p>
</li>
<li>
<p><code>animation-play-state</code>ï¼šè®¾ç½®åŠ¨ç”»æ˜¯è¿è¡Œè¿˜æ˜¯æš‚åœï¼Œæœ‰æ•ˆå€¼ <code>running</code>ã€<code>paused</code>ã€‚</p>
</li>
<li>
<p><code>animation-fill-mode</code>ï¼šè®¾ç½® CSS åŠ¨ç”»åœ¨æ‰§è¡Œä¹‹å‰å’Œä¹‹åå¦‚ä½•å°†æ ·å¼åº”ç”¨äºå…¶ç›®æ ‡ï¼Œæœ‰æ•ˆå€¼å¦‚ä¸‹ï¼š</p>
<ul>
<li><code>none</code>ï¼šå½“åŠ¨ç”»æœªæ‰§è¡Œæ—¶ï¼ŒåŠ¨ç”»å°†ä¸ä¼šå°†ä»»ä½•æ ·å¼åº”ç”¨äºç›®æ ‡ï¼Œè€Œæ˜¯å·²ç»èµ‹äºˆç»™è¯¥å…ƒç´ çš„ CSS è§„åˆ™æ¥æ˜¾ç¤ºè¯¥å…ƒç´ ã€‚è¿™æ˜¯é»˜è®¤å€¼</li>
<li><code>forwards</code>ï¼šç›®æ ‡å°†ä¿ç•™ç”±æ‰§è¡ŒæœŸé—´é‡åˆ°çš„æœ€åä¸€ä¸ªå…³é”®å¸§è®¡ç®—å€¼ã€‚</li>
<li><code>backwards</code>ï¼šåŠ¨ç”»å°†åœ¨åº”ç”¨äºç›®æ ‡æ—¶ç«‹å³åº”ç”¨ç¬¬ä¸€ä¸ªå…³é”®å¸§ä¸­å®šä¹‰çš„å€¼ã€‚
<code>animation-timing-function</code>ï¼šè®¾ç½®åŠ¨ç”»åœ¨æ¯ä¸ªå‘¨æœŸçš„æŒç»­æ—¶é—´å†…å¦‚ä½•è¿›è¡Œï¼Œä¸»è¦æ˜¯å¦‚ä¸‹ä¸¤ç§å‡½æ•°ï¼š</li>
</ul>
</li>
<li>
<p><code>cubic-bezier</code> ä¸‰æ¬¡è´å¡å°”æ›²çº¿ ( <code>cubic-bezier(&lt;x1&gt;, &lt;y1&gt;, &lt;x2&gt;, &lt;y2&gt;)</code> )ï¼Œä»¥å®ç° <strong>è¡¥é—´åŠ¨ç”»</strong> æ•ˆæœã€‚</p>
</li>
<li>
<p><code>steps</code> æ˜¯ä¸€ä¸ªåˆ†æ®µçš„é˜¶è·ƒå‡½æ•°ï¼Œï¼Œä»¥å®ç° <strong>é€å¸§åŠ¨ç”»</strong>ã€‚n ç›¸å½“äºå•æ¬¡åŠ¨ç”»çš„å¸§æ•°ï¼Œæ¯å¸§åŠ¨ç”»çš„æ—¶é—´æ˜¯å‡ç­‰çš„ (<code>steps(n, &lt;jumpterm&gt;)</code>)ï¼Œå…¶ä¸­ <code>jumpterm (é»˜è®¤å€¼ end)</code> å«ä¹‰å¦‚ä¸‹ï¼š</p>
<ol>
<li>jump-startï¼šåœ¨èµ·å§‹ä½ç½®é˜¶è·ƒï¼Œ<code>n=2 â‡’ 50% 100%; (100 / 2)</code></li>
<li>jump-endï¼šåœ¨ç»“æŸä½ç½®é˜¶è·ƒ, <code>n=4 â‡’ 0% 25% 50% 75%; (100 / 4)</code></li>
<li>jump-noneï¼šèµ·æ­¢ä½ç½®å‡æ— è·³è·ƒï¼Œ<code>n=5 â‡’ 0% 25% 50% 75% 100%; (100 / 4)</code></li>
<li>jump-bothï¼šèµ·æ­¢ä½ç½®å‡æœ‰è·³è·ƒ <code>n=3 â‡’ 25% 50% 75%; (100 / 4)</code></li>
<li>startï¼šç­‰åŒ jump-start</li>
<li>endï¼šç­‰åŒ jump-end</li>
<li>step-startï¼šç­‰åŒ steps(1, jump-start)</li>
<li>step-endï¼šç­‰åŒ steps(1, jump-end)</li>
</ol>
</li>
</ul>
<pre><code class="hljs language-css" lang="css">  <span class="hljs-comment">/* animation å£°æ˜æ ·å¼é¡ºåº */</span> 
  <span class="hljs-comment">/* animation-duration */</span>
  <span class="hljs-comment">/* animation-easing-function */</span>
  <span class="hljs-comment">/* animation-delay */</span> 
  <span class="hljs-comment">/* animation-iteration-count */</span>
  <span class="hljs-comment">/* animation-direction */</span>
  <span class="hljs-comment">/* animation-fill-mode */</span>
  <span class="hljs-comment">/* animation-play-state */</span>
  <span class="hljs-comment">/* animation-name */</span>
  <span class="hljs-attribute">animation</span>: <span class="hljs-number">3s</span> ease-in <span class="hljs-number">1s</span> <span class="hljs-number">2</span> reverse both paused slidein; 

  
  <span class="hljs-comment">/* animation - duration | easing-function | delay | name */</span>
  <span class="hljs-attribute">animation</span>: <span class="hljs-number">3s</span> linear <span class="hljs-number">1s</span> slidein;
  
  
  <span class="hljs-comment">/* more animations - duration | easing-function | delay | name */</span>
  <span class="hljs-attribute">animation</span>: <span class="hljs-number">3s</span> linear slidein, <span class="hljs-number">3s</span> ease-out <span class="hljs-number">5s</span> slideout;

 
  <span class="hljs-comment">/* animation-name */</span>
  <span class="hljs-attribute">animation-name</span>: none;
  <span class="hljs-attribute">animation-name</span>: animate1;
  <span class="hljs-attribute">animation-name</span>: animate1, animate2;
  
  
  <span class="hljs-comment">/* animation-timing-function */</span>
  <span class="hljs-attribute">animation-timing-function</span>: ease;
  <span class="hljs-attribute">animation-timing-function</span>: step-start;
  <span class="hljs-attribute">animation-timing-function</span>: <span class="hljs-built_in">cubic-bezier</span>(<span class="hljs-number">0.1</span>, <span class="hljs-number">0.7</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0.1</span>);
  <span class="hljs-attribute">animation-timing-function</span>: ease, step-start, <span class="hljs-built_in">cubic-bezier</span>(<span class="hljs-number">0.1</span>, <span class="hljs-number">0.7</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0.1</span>);
  

</code></pre>
<h4 data-id="heading-15">css animation åŠ¨ç”»è§¦å‘æ–¹å¼</h4>
<p>å’Œcss <code>transition</code> è§¦å‘åŠ¨ç”»æ–¹å¼ç›¸ä¼¼</p>
<p><strong>æ­¤å¤–è¿˜å¯ä»¥å¢åŠ ä¸€ä¸ªå›¾å±‚ï¼Œä¸“é—¨ç”¨äºåˆ¶ä½œåŠ¨ç”»æ•ˆæœã€‚</strong></p>
<p>ä¾‹å¦‚ï¼šé¼ æ ‡åœ¨ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œä¼šæœ‰æ¶Ÿæ¼ªåŠ¨ç”»ã€‚</p>
<pre><code class="hljs language-js" lang="js">
<span class="hljs-comment">// æ¶Ÿæ¼ªåŠ¨ç”»å®šä¹‰</span>
@keyframes ripple {
  <span class="hljs-number">0</span>% {
    <span class="hljs-attr">transform</span>: <span class="hljs-title function_">scale</span>(<span class="hljs-number">0</span>);
    <span class="hljs-attr">opacity</span>: <span class="hljs-number">1</span>;
  }

  to {
    <span class="hljs-attr">transform</span>: <span class="hljs-title function_">scale</span>(<span class="hljs-number">4</span>);
    <span class="hljs-attr">opacity</span>: <span class="hljs-number">0</span>;
  }
}

<span class="hljs-comment">// å›¾å±‚åŠ¨ç”» css</span>
.<span class="hljs-property">ripple</span> {
  <span class="hljs-attr">position</span>: absolute;
  border-<span class="hljs-attr">radius</span>: <span class="hljs-number">50</span>%;
  <span class="hljs-attr">background</span>: <span class="hljs-title function_">rgba</span>(<span class="hljs-number">8</span>, <span class="hljs-number">7</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0.2</span>);
  pointer-<span class="hljs-attr">events</span>: none;

  <span class="hljs-attr">animation</span>: ripple <span class="hljs-number">0.</span>6s linear;
}

<span class="hljs-comment">// åˆ¶ä½œåŠ¨ç”»  è¿™æ ·æ¯æ¬¡ç‚¹å‡»æŒ‰é’® å°±ä¼šç”ŸæˆåŠ¨ç”»ï¼ŒåŠ¨ç”»ç»“æŸä¾¿é”€æ¯åŠ¨ç”»å…ƒç´ </span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">makeAnimate</span> = (<span class="hljs-params">e: React.MouseEvent</span>) =&gt; {
  <span class="hljs-keyword">const</span> dom = e.<span class="hljs-property">currentTarget</span>;
  <span class="hljs-keyword">const</span> rect = dom.<span class="hljs-title function_">getBoundingClientRect</span>();
  <span class="hljs-keyword">const</span> x = e.<span class="hljs-property">clientX</span> - rect.<span class="hljs-property">left</span>;
  <span class="hljs-keyword">const</span> y = e.<span class="hljs-property">clientY</span> - rect.<span class="hljs-property">top</span>;
  <span class="hljs-keyword">const</span> size = <span class="hljs-number">100</span>;

  <span class="hljs-keyword">const</span> ripple = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'span'</span>);
  ripple.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">'ripple'</span>);
  ripple.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">`<span class="hljs-subst">${size}</span>px`</span>;
  ripple.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-string">`<span class="hljs-subst">${size}</span>px`</span>;
  ripple.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-string">`<span class="hljs-subst">${x - size / <span class="hljs-number">2</span>}</span>px`</span>;
  ripple.<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = <span class="hljs-string">`<span class="hljs-subst">${y - size / <span class="hljs-number">2</span>}</span>px`</span>;
  dom.<span class="hljs-title function_">appendChild</span>(ripple);

  ripple.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'animationend'</span>, <span class="hljs-function">() =&gt;</span> {
    ripple.<span class="hljs-title function_">remove</span>();
  });
};


</code></pre>
<h2 data-id="heading-16">svg åŠ¨ç”»</h2>
<h3 data-id="heading-17">å¸¸ç”¨çš„ SMIL åŠ¨ç”»å…ƒç´ </h3>
<ul>
<li><code>&lt;animate&gt;</code>ï¼šç”¨äºåŠ¨ç”»åŒ–å•ä¸ªå±æ€§ã€‚</li>
<li><code>&lt;animateTransform&gt;</code>ï¼šç”¨äºåŠ¨ç”»åŒ–å˜æ¢å±æ€§ï¼Œå¦‚æ—‹è½¬ã€ç¼©æ”¾ã€å¹³ç§»ç­‰ã€‚</li>
<li><code>&lt;animateMotion&gt;</code>ï¼šç”¨äºæ²¿ç€è·¯å¾„åŠ¨ç”»åŒ–å…ƒç´ ã€‚ï¼ˆè·¯å¾„åŠ¨ç”»ï¼‰</li>
<li><code>&lt;set&gt;</code>ï¼šç”¨äºåœ¨æŒ‡å®šæ—¶é—´ç‚¹è®¾ç½®å±æ€§å€¼ã€‚</li>
</ul>
<pre><code class="hljs language-js" lang="js">&lt;svg width=<span class="hljs-string">"100"</span> height=<span class="hljs-string">"100"</span>&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">"50"</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">"50"</span> <span class="hljs-attr">r</span>=<span class="hljs-string">"40"</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">"red"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">animate</span> <span class="hljs-attr">attributeName</span>=<span class="hljs-string">"cx"</span> <span class="hljs-attr">from</span>=<span class="hljs-string">"50"</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"150"</span> <span class="hljs-attr">dur</span>=<span class="hljs-string">"2s"</span> <span class="hljs-attr">repeatCount</span>=<span class="hljs-string">"indefinite"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">circle</span>&gt;</span></span>
&lt;/svg&gt;

</code></pre>
<h3 data-id="heading-18">svg æè¾¹åŠ¨ç”»</h3>
<p>SVGåŠ¨ç”»çš„è·¯å¾„å®ç°ä¸»è¦ä¾èµ–å±æ€§ï¼š<code>stroke</code>ï¼ˆæè¾¹ï¼‰å’ŒÂ <code>fill</code>ï¼ˆå¡«å……ï¼‰ã€‚</p>
<ul>
<li><strong>stroke</strong>ï¼šå®šä¹‰svgçš„è½®å»“çº¿ã€‚å¸¸ç”¨csså±æ€§æœ‰ï¼š <code>stroke-dasharray</code>ï¼ˆæè¾¹çš„æ ·å¼ï¼‰ï¼Œ<code>stroke-dashoffset</code>ï¼ˆèµ·å§‹ä½ç½®ï¼‰ï¼Œ<code>stroke-color</code>ï¼ˆæè¾¹çš„é¢œè‰²ï¼‰ï¼Œ<code>stroke-opacity</code>ï¼ˆæè¾¹çš„é€æ˜åº¦ï¼‰ï¼Œ<code>stroke-linecap</code>ï¼ˆæè¾¹ç«¯ç‚¹å½¢çŠ¶ï¼‰ç­‰ã€‚</li>
<li><strong>fill</strong>ï¼šå®šä¹‰svgå†…éƒ¨é¢œè‰²æˆ–å›¾æ¡ˆ ï¼Œå¸¸ç”¨csså±æ€§æœ‰<code>fill-opacity</code>(å®šä¹‰å¡«å……çš„é€æ˜åº¦), <code>fill-rule</code>(å®šä¹‰å¡«å……è§„åˆ™)ç­‰ã€‚</li>
</ul>
<h4 data-id="heading-19">stroke-dasharray ï¼ˆå®šä¹‰è™šçº¿çš„é•¿åº¦å’Œé—´éš”ï¼‰</h4>
<p>æä¾›ä¸€ä¸ªå¥‡æ•°æˆ–å¶æ•°æ•°åˆ—ï¼Œå…¶ä¸­æ•°ä¸æ•°ä¹‹é—´ç”¨é€—å·æˆ–ç©ºæ ¼éš”å¼€ï¼Œç”¨æ¥æŒ‡å®šçŸ­åˆ’çº¿å’Œç¼ºå£çš„é•¿åº¦ï¼Œå¹¶é‡å¤ã€‚ å¦‚æœæ˜¯<code>å¶æ•°æ•°åˆ—</code>ï¼Œåˆ™ä¸€ä¸ªè¡¨ç¤ºçŸ­çº¿é•¿åº¦ï¼Œä¸€ä¸ªè¡¨ç¤ºç¼ºå£é•¿åº¦ã€‚ å¦‚æœæ˜¯<code>å¥‡æ•°æ•°åˆ—</code>ï¼Œå°†å¥‡æ•°æ•°åˆ—å¤åˆ¶ä¸€ä¸ªå˜æˆå¶æ•°æ•°åˆ—ï¼Œç„¶åæŒ‰ç…§çŸ­çº¿ï¼Œç¼ºå£çš„é¡ºåºç»˜åˆ¶ã€‚</p>
<p>(å¶æ•°æ•°åˆ—) <code>stroke-dasharray="5, 5" x1="10" y1="10" x2="190" y2="10"</code>è¡¨ç¤ºä»åæ ‡ï¼ˆ10,10ï¼‰åˆ°(200,10)è¿™æ¡æ°´å¹³çº¿ä¸Šï¼ŒçŸ­åˆ’çº¿å’Œç¼ºå£éƒ½ä¸º5ä¸ªpx</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3298ea28b93c4d6b9a6693bbe89e2984~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHN4Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339795&amp;x-signature=u0p86ISTMyua61kJghaqrnV%2F23Y%3D" alt="image.png" loading="lazy"/></p>
<p>ï¼ˆå¥‡æ•°æ•°åˆ—ï¼‰ <code>stroke-dasharray="20 10 5" x1="10" y1="10" x2="190" y2="10"</code>è¡¨ç¤ºä»åæ ‡ï¼ˆ10,10ï¼‰åˆ°(200,10)è¿™æ¡æ°´å¹³çº¿ä¸Šï¼ŒçŸ­åˆ’çº¿å’Œç¼ºå£æŒ‰ç…§20 10 5 20 10 5çš„é¡ºåºæ’åˆ—ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4f644bfba2884206af13d69046a6c4b9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHN4Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339795&amp;x-signature=mGga%2Be5%2BvHL5XTFGp%2FJXaFN%2BJhY%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-20">stroke-dashoffset ï¼ˆå®šä¹‰è™šçº¿çš„èµ·å§‹ä½ç½®ï¼‰</h4>
<p>stroke-dashoffset å±æ€§ç”¨äºæŒ‡å®šè·¯å¾„å¼€å§‹çš„è·ç¦»(æ­£å€¼å‘å·¦åç§»ï¼Œè´Ÿå€¼å‘å³åç§»)</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b04bccdcff294be89efd61b13026531c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHN4Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339795&amp;x-signature=JQOha66p%2BXZULeeSTsOPFCUBhDU%3D" alt="image.png" loading="lazy"/></p>
<p>æè¾¹åŠ¨ç”»ç¤ºä¾‹ï¼š</p>
<p><a href="https://code.juejin.cn/pen/7391734513644077082" target="_blank" title="https://code.juejin.cn/pen/7391734513644077082">code.juejin.cn/pen/7391734â€¦</a></p>
<h2 data-id="heading-21">js åŠ¨ç”»</h2>
<h3 data-id="heading-22">setTimeout / setInterval API</h3>
<p>è®¾å®šå®šæ—¶å™¨ï¼Œé€šè¿‡å‘¨æœŸæ€§çš„è§¦å‘é‡å¤æ‰§è¡Œç»˜åˆ¶åŠ¨ç”»çš„å‡½æ•°ï¼Œæ¥å®ç° â€œé€å¸§åŠ¨ç”»â€ çš„æ•ˆæœã€‚</p>
<ul>
<li>
<p>ä¼˜åŠ¿</p>
<ol>
<li>å…·æœ‰å¾ˆå¥½çš„æµè§ˆå™¨å…¼å®¹æ€§</li>
</ol>
</li>
<li>
<p>åŠ£åŠ¿</p>
<ol>
<li>åªèƒ½æ¥è¿‘è®¾å¤‡å±å¹•åˆ·æ–°ç‡ï¼Œæ— æ³•åšåˆ°å’Œæµè§ˆå™¨åŒæ­¥ï¼Œæ‰€ä»¥å¯èƒ½ä¼šå­˜åœ¨å¡é¡¿ã€ä¸¢å¸§ã€æŠ–åŠ¨çš„ç°è±¡</li>
<li>ç”±äºæµè§ˆå™¨å•çº¿ç¨‹æœºåˆ¶ï¼Œå­˜åœ¨é˜Ÿåˆ—ä¸­å›è°ƒå‡½æ•°è¢«é˜»å¡çš„å¯èƒ½ï¼Œæ‰€ä»¥æ— æ³•ä¿è¯æ¯ä¸€æ¬¡è°ƒç”¨çš„æ—¶é—´é—´éš”éƒ½ç›¸åŒï¼ŒæŸæ¬¡å›è°ƒå¯èƒ½ä¼šè¢«è·³è¿‡ï¼Œå¯¼è‡´è·³å¸§ã€‚</li>
</ol>
</li>
</ul>
<h3 data-id="heading-23">requestAnimationFrame API</h3>
<p>ä¸ºäº†å¼¥è¡¥ <code>setTimeout / setInterval</code> åœ¨åŠ¨ç”»æ–¹é¢çš„ä¸è¶³ï¼Œæµè§ˆå™¨æä¾›äº†ä¸ºåŠ¨ç”»è€Œç”Ÿçš„ APIï¼Œå®ƒå¯ä»¥è®© DOM åŠ¨ç”»ã€Canvas åŠ¨ç”»ã€ SVG åŠ¨ç”»ç­‰æœ‰ä¸€ä¸ªç»Ÿä¸€çš„åˆ·æ–°æœºåˆ¶ï¼Œéšç€æµè§ˆå™¨çš„å±å¹•åˆ·æ–°ï¼Œç»Ÿä¸€ç»˜åˆ¶åŠ¨ç”»å¸§ã€‚</p>
<pre><code class="hljs language-js" lang="js">  <span class="hljs-keyword">let</span> id = <span class="hljs-literal">null</span>
  
  <span class="hljs-comment">// åŠ¨ç”»å‡½æ•°</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">draw</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-comment">/* åŠ¨ç”»ç»˜åˆ¶... */</span>
  }
  
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">start</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-title function_">draw</span>()
    <span class="hljs-title function_">cancelAnimationFrame</span>(id)
    id = <span class="hljs-title function_">requestAnimationFrame</span>(start)
  }
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">stop</span> = (<span class="hljs-params"/>) =&gt; { <span class="hljs-title function_">cancelAnimationFrame</span>(id) }
  
</code></pre>
<ul>
<li>
<p>ä¼˜åŠ¿</p>
<ol>
<li>ç”±ç³»ç»Ÿæ¥å†³å®šå›è°ƒå‡½æ•°çš„æ‰§è¡Œæ—¶æœº, å®ƒèƒ½ä¿è¯å›è°ƒå‡½æ•°åœ¨å±å¹•æ¯ä¸€æ¬¡çš„åˆ·æ–°é—´éš”ä¸­åªè¢«æ‰§è¡Œä¸€æ¬¡, è¿™æ ·å°±ä¸ä¼šå¼•èµ·ä¸¢å¸§ç°è±¡, ä¹Ÿä¸ä¼šå¯¼è‡´åŠ¨ç”»å‡ºç°å¡é¡¿çš„é—®é¢˜ã€‚</li>
<li>åœ¨è¿è¡Œæ—¶æµè§ˆå™¨ä¼šè‡ªåŠ¨ä¼˜åŒ–æ–¹æ³•çš„è°ƒç”¨ï¼Œå¹¶ä¸”å¦‚æœé¡µé¢ä¸æ˜¯æ¿€æ´»çŠ¶æ€ä¸‹çš„è¯ï¼ŒåŠ¨ç”»ä¼šè‡ªåŠ¨æš‚åœï¼Œæœ‰æ•ˆèŠ‚çœäº†CPUçš„å¼€é”€ã€‚</li>
</ol>
</li>
<li>
<p>ä¸è¶³</p>
<ol>
<li>åŒ setTimeout/setInterval ä¸€æ ·ï¼Œå®ƒæ˜¯ä»¥é€å¸§åŠ¨ç”»çš„æ–¹å¼è¿›è¡Œç»˜åˆ¶ï¼Œæ— æ³•åšåˆ°åƒ CSS åŠ¨ç”»ï¼Œè®©æ¸¸è§ˆå™¨è‡ªåŠ¨æ ¹æ®ä¸¤å¸§ä¹‹é—´çš„å·®å¼‚åˆ›å»ºæ’å€¼ï¼Œä»¥å®ç°è¡¥é—´åŠ¨ç”»çš„è¿‡æ¸¡æ•ˆæœã€‚</li>
</ol>
</li>
</ul>
<h3 data-id="heading-24">Web Animations API</h3>
<ol>
<li><code>requestAnimationFrame</code>ã€<code>setTimeout/setInterval</code> éƒ½æ˜¯ä»¥é€å¸§ç»˜åˆ¶çš„æ–¹å¼å®ç°åŠ¨ç”»ï¼Œ è€Œ <strong>Animations API</strong> ä¸ä»…å¯ä»¥ â€œé€å¸§åŠ¨ç”»â€ï¼Œè¿˜å¯ä»¥å®ç° â€œè¡¥é—´åŠ¨ç”»â€ çš„æ•ˆæœã€‚</li>
<li>CSS åŠ¨ç”»æœ‰ä¸€å®šçš„å±€é™æ€§ï¼Œéœ€è¦äº‹å…ˆé¢„è®¾åŠ¨ç”»æ ·å¼ï¼Œè€Œä¸”æ— æ³•ä¸ JS è¿›è¡Œäº¤äº’ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œ<strong>Animations API</strong> å¯ä»¥éšæ—¶å®šä¹‰å¹¶ä½¿ç”¨åŠ¨ç”»ï¼Œè‡ªç„¶æ˜¯æ›´åŠ çµæ´»æ–¹ä¾¿ã€‚</li>
</ol>
<p>å‚è€ƒæ–‡æ¡£ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FWeb_Animations_API" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/API/Web_Animations_API" ref="nofollow noopener noreferrer">developer.mozilla.org/zh-CN/docs/â€¦</a></p>
<p>è¯­æ³•ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-js" lang="js">  <span class="hljs-keyword">const</span> element = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"container"</span>);

  <span class="hljs-keyword">const</span> animation = element.<span class="hljs-title function_">animate</span>(
    [
      { <span class="hljs-attr">transform</span>: <span class="hljs-string">"translateY(0%)"</span> },
      { <span class="hljs-attr">transform</span>: <span class="hljs-string">"translateY(100%)"</span> },
    ],
    { <span class="hljs-attr">duration</span>: <span class="hljs-number">3000</span>, <span class="hljs-attr">fill</span>: <span class="hljs-string">"forwards"</span> }
  );
  

</code></pre>
<p>ä»£ç ç¤ºä¾‹ï¼š</p>
<p><a href="https://code.juejin.cn/pen/7391799461493932069" target="_blank" title="https://code.juejin.cn/pen/7391799461493932069">code.juejin.cn/pen/7391799â€¦</a></p>
<h4 data-id="heading-25">å…³äºFlipåŠ¨ç”»</h4>
<p>æµè§ˆå™¨è®¡ç®—ä½ç½®å¾ˆå¿«ï¼Œç»˜åˆ¶å¯èƒ½å¾ˆæ…¢ã€‚åˆ©ç”¨æµè§ˆå™¨å¼ºå¤§çš„è®¡ç®—èƒ½åŠ›ï¼Œè·å–åŠ¨ç”»çš„èµ·æ­¢çŠ¶æ€ï¼Œæ¥ç€å•ç‹¬å¼€å¯ä¸€ä¸ªçº¿ç¨‹åšåŠ¨ç”»ã€‚è¿™æ ·è§¦å‘å¸ƒå±€æ›´æ–°çš„æ“ä½œï¼Œåªä¼šå‘ç”Ÿåœ¨ä¸€å¸§æ—¶é—´å†…ï¼Œå‰©ä¸‹çš„åŠ¨ç”»è·‘åœ¨å•ç‹¬çš„çº¿ç¨‹ä¸Šï¼Œä¼šæ›´æµç•…ã€‚</p>
<p>ä»‹ç»ä¸‹FLIP ã€‚</p>
<ol>
<li>F ä»£è¡¨ Firstï¼Œä¹Ÿå°±æ˜¯åŠ¨ç”»çš„å¼€å§‹çŠ¶æ€ã€‚</li>
<li>L ä»£è¡¨ Lastï¼Œä»£è¡¨åŠ¨ç”»ç»“æŸçŠ¶æ€ã€‚</li>
<li>I ä»£è¡¨ Invertï¼Œä¹Ÿå°±æ˜¯çŠ¶æ€åè½¬ï¼Œä½¿ç”¨ transform ç­‰å±æ€§ï¼Œåˆ›å»ºå•ç‹¬çš„å›¾å±‚ï¼Œå¹¶å°†å…ƒç´ çŠ¶æ€åè½¬å›å»ã€‚</li>
<li>P ä»£è¡¨ Playï¼Œæ’­æ”¾åŠ¨ç”»ã€‚</li>
</ol>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<p>å…¶ä¸­ï¼Œåœ¨åˆå§‹å¸§ä¸­ï¼Œåº”ç”¨é€†å˜æ¢ï¼ˆ<code>translate</code>Â å’ŒÂ <code>scale</code>ï¼‰ï¼Œå°†å…ƒç´ ä»å…¶æœ€ç»ˆçŠ¶æ€é€†å˜æ¢åˆ°åˆå§‹çŠ¶æ€ã€‚</p>
<p>æœ€åä¸€å¸§Â <code>transform: "none"</code>Â çš„ä½œç”¨æ˜¯å°†å…ƒç´ çš„å˜æ¢å±æ€§é‡ç½®ä¸ºå…¶æœ€ç»ˆçŠ¶æ€ã€‚å…·ä½“æ¥è¯´ï¼Œ<code>transform: "none"</code>Â è¡¨ç¤ºä¸åº”ç”¨ä»»ä½•å˜æ¢ï¼Œè¿™æ„å‘³ç€å…ƒç´ å°†æ¢å¤åˆ°ç”± CSS è®¾ç½®çš„æœ€ç»ˆä½ç½®å’Œå¤§å°ã€‚</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>FLIP Animation Example<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
    <span class="hljs-selector-id">#box</span> {
      <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;
      <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#4caf50</span>;
      <span class="hljs-attribute">position</span>: absolute;
    }
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"box"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"animateButton"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"margin-top: 300px;"</span>&gt;</span>Animate<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">const</span> box = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'box'</span>);
    <span class="hljs-keyword">const</span> button = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'animateButton'</span>);

    button.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// First: è®°å½•åˆå§‹çŠ¶æ€</span>
      <span class="hljs-keyword">const</span> first = box.<span class="hljs-title function_">getBoundingClientRect</span>();

      <span class="hljs-comment">// ä¿®æ”¹å…ƒç´ çš„ä½ç½®</span>
      box.<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-number">300</span>}</span>px`</span>;
      box.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-number">300</span>}</span>px`</span>;

      <span class="hljs-comment">// Last: è®°å½•æœ€ç»ˆçŠ¶æ€</span>
      <span class="hljs-keyword">const</span> last = box.<span class="hljs-title function_">getBoundingClientRect</span>();

      <span class="hljs-comment">// Invert: è®¡ç®—åˆå§‹çŠ¶æ€å’Œæœ€ç»ˆçŠ¶æ€ä¹‹é—´çš„å˜æ¢</span>
      <span class="hljs-keyword">const</span> deltaX = first.<span class="hljs-property">left</span> - last.<span class="hljs-property">left</span>;
      <span class="hljs-keyword">const</span> deltaY = first.<span class="hljs-property">top</span> - last.<span class="hljs-property">top</span>;
      <span class="hljs-keyword">const</span> deltaW = first.<span class="hljs-property">width</span> / last.<span class="hljs-property">width</span>;
      <span class="hljs-keyword">const</span> deltaH = first.<span class="hljs-property">height</span> / last.<span class="hljs-property">height</span>;


      <span class="hljs-comment">// åº”ç”¨ FLIP åŠ¨ç”»</span>
      box.<span class="hljs-title function_">animate</span>(
        [
          {
            <span class="hljs-attr">transformOrigin</span>: <span class="hljs-string">"top left"</span>,
            <span class="hljs-attr">transform</span>: <span class="hljs-string">`
            translate(<span class="hljs-subst">${deltaX}</span>px, <span class="hljs-subst">${deltaY}</span>px)
            scale(<span class="hljs-subst">${deltaW}</span>, <span class="hljs-subst">${deltaH}</span>)`</span>,
          },
          {
            <span class="hljs-attr">transformOrigin</span>: <span class="hljs-string">"top left"</span>,
            <span class="hljs-attr">transform</span>: <span class="hljs-string">"none"</span>,
          },
        ],
        {
          <span class="hljs-attr">duration</span>: <span class="hljs-number">300</span>,
          <span class="hljs-attr">easing</span>: <span class="hljs-string">"ease-in-out"</span>,
          <span class="hljs-attr">fill</span>: <span class="hljs-string">"both"</span>,
        }
      );
    });
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>

</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[09-ğŸ”æ•°æ®ç»“æ„ä¸ç®—æ³•æ ¸å¿ƒçŸ¥è¯† | äºŒå‰æœç´¢æ ‘ï¼šæœ‰åºæ•°æ®ç»“æ„ç†è®ºä¸å®è·µ]]></title>    <link>https://juejin.cn/post/7587785079738728454</link>    <guid>https://juejin.cn/post/7587785079738728454</guid>    <pubDate>2025-12-26T07:28:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587785079738728454" data-draft-id="7587785079738695686" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="09-ğŸ”æ•°æ®ç»“æ„ä¸ç®—æ³•æ ¸å¿ƒçŸ¥è¯† | äºŒå‰æœç´¢æ ‘ï¼šæœ‰åºæ•°æ®ç»“æ„ç†è®ºä¸å®è·µ"/> <meta itemprop="keywords" content="ç®—æ³•"/> <meta itemprop="datePublished" content="2025-12-26T07:28:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ²¡æœ‰æ•…äº‹çš„ZhangåŒå­¦"/> <meta itemprop="url" content="https://juejin.cn/user/1574156381196600"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            09-ğŸ”æ•°æ®ç»“æ„ä¸ç®—æ³•æ ¸å¿ƒçŸ¥è¯† | äºŒå‰æœç´¢æ ‘ï¼šæœ‰åºæ•°æ®ç»“æ„ç†è®ºä¸å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1574156381196600/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ²¡æœ‰æ•…äº‹çš„ZhangåŒå­¦
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T07:28:10.000Z" title="Fri Dec 26 2025 07:28:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»19åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><pre><code class="hljs language-mermaid" lang="mermaid">mindmap
  root((äºŒå‰æœç´¢æ ‘ BST))
    ç†è®ºåŸºç¡€
      å®šä¹‰ä¸æ€§è´¨
        å·¦å°å³å¤§
        ä¸­åºæœ‰åº
        é€’å½’ç»“æ„
      æ ¸å¿ƒç‰¹æ€§
        æœ‰åºæ€§
        å”¯ä¸€æ€§
        åŠ¨æ€æ€§
    åŸºæœ¬æ“ä½œ
      searchæŸ¥æ‰¾
        Olog nå¹³å‡
        Onæœ€å
      insertæ’å…¥
        æ‰¾åˆ°ä½ç½®
        æ’å…¥èŠ‚ç‚¹
      deleteåˆ é™¤
        ä¸‰ç§æƒ…å†µ
        å‰é©±åç»§
    éå†æ–¹å¼
      ä¸­åºéå†
        æœ‰åºåºåˆ—
        å‡åºè¾“å‡º
      å‰åºååº
        æ ‘ç»“æ„
        è¡¨è¾¾å¼
    å¹³è¡¡é—®é¢˜
      ä¸å¹³è¡¡é£é™©
        é€€åŒ–ä¸ºé“¾è¡¨
        æ€§èƒ½ä¸‹é™
      è§£å†³æ–¹æ¡ˆ
        AVLæ ‘
        çº¢é»‘æ ‘
        Bæ ‘
    å·¥ä¸šå®è·µ
      Java TreeMap
        çº¢é»‘æ ‘å®ç°
        æœ‰åºæ˜ å°„
      æ•°æ®åº“ç´¢å¼•
        B+æ ‘åŸºç¡€
        èŒƒå›´æŸ¥è¯¢
      å•†å“ä»·æ ¼æŸ¥è¯¢
        åŒºé—´æœç´¢
        æ€§èƒ½ä¼˜åŒ–
</code></pre>
<h2 data-id="heading-0">ç›®å½•</h2>
<ul>
<li><a href="#%E4%B8%80%E5%89%8D%E8%A8%80" title="#%E4%B8%80%E5%89%8D%E8%A8%80">ä¸€ã€å‰è¨€</a></li>
<li><a href="#%E4%BA%8C%E6%A6%82%E8%BF%B0" title="#%E4%BA%8C%E6%A6%82%E8%BF%B0">äºŒã€æ¦‚è¿°</a></li>
<li><a href="#%E4%B8%89bst%E7%9A%84%E6%80%A7%E8%B4%A8" title="#%E4%B8%89bst%E7%9A%84%E6%80%A7%E8%B4%A8">ä¸‰ã€BSTçš„æ€§è´¨</a></li>
<li><a href="#%E5%9B%9Bbst%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C" title="#%E5%9B%9Bbst%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C">å››ã€BSTçš„åŸºæœ¬æ“ä½œ</a></li>
<li><a href="#%E4%BA%94bst%E7%9A%84%E5%AE%9E%E7%8E%B0" title="#%E4%BA%94bst%E7%9A%84%E5%AE%9E%E7%8E%B0">äº”ã€BSTçš„å®ç°</a></li>
<li><a href="#%E5%85%AD%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E5%88%86%E6%9E%90" title="#%E5%85%AD%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E5%88%86%E6%9E%90">å…­ã€æ—¶é—´å¤æ‚åº¦åˆ†æ</a></li>
<li><a href="#%E4%B8%83%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF" title="#%E4%B8%83%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF">ä¸ƒã€åº”ç”¨åœºæ™¯</a></li>
<li><a href="#%E5%85%AB%E5%B7%A5%E4%B8%9A%E7%95%8C%E5%AE%9E%E8%B7%B5%E6%A1%88%E4%BE%8B" title="#%E5%85%AB%E5%B7%A5%E4%B8%9A%E7%95%8C%E5%AE%9E%E8%B7%B5%E6%A1%88%E4%BE%8B">å…«ã€å·¥ä¸šç•Œå®è·µæ¡ˆä¾‹</a></li>
<li><a href="#%E4%B9%9Dbst%E7%9A%84%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88" title="#%E4%B9%9Dbst%E7%9A%84%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88">ä¹ã€BSTçš„é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</a></li>
<li><a href="#%E5%8D%81%E6%80%BB%E7%BB%93" title="#%E5%8D%81%E6%80%BB%E7%BB%93">åã€æ€»ç»“</a></li>
</ul>
<h2 data-id="heading-1">ä¸€ã€å‰è¨€</h2>
<h3 data-id="heading-2">1. ç ”ç©¶èƒŒæ™¯</h3>
<p>äºŒå‰æœç´¢æ ‘ï¼ˆBinary Search Tree, BSTï¼‰æ˜¯è®¡ç®—æœºç§‘å­¦ä¸­æœ€é‡è¦çš„æ•°æ®ç»“æ„ä¹‹ä¸€ï¼Œç”±P.F. Windleyã€A.D. Boothã€A.J.T. Colinå’ŒT.N. Hibbardåœ¨1960å¹´ç‹¬ç«‹æå‡ºã€‚BSTç»“åˆäº†äºŒå‰æ ‘çš„å±‚æ¬¡ç»“æ„å’Œæœ‰åºæ€§ï¼Œå®ç°äº†é«˜æ•ˆçš„æŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤æ“ä½œã€‚</p>
<p>æ ¹æ®ACMçš„ç ”ç©¶ï¼ŒBSTåŠå…¶å˜ä½“ï¼ˆAVLæ ‘ã€çº¢é»‘æ ‘ã€Bæ ‘ï¼‰åœ¨æ•°æ®åº“ç´¢å¼•ã€æœ‰åºé›†åˆã€ç¬¦å·è¡¨ç­‰é¢†åŸŸå æ®ä¸»å¯¼åœ°ä½ã€‚Javaçš„TreeMapã€C++çš„std::mapã€MySQLçš„B+æ ‘ç´¢å¼•éƒ½åŸºäºBSTçš„æ€æƒ³ã€‚</p>
<h3 data-id="heading-3">2. å†å²å‘å±•</h3>
<ul>
<li><strong>1960å¹´</strong>ï¼šBSTæ¦‚å¿µæå‡º</li>
<li><strong>1962å¹´</strong>ï¼šAVLæ ‘ï¼ˆè‡ªå¹³è¡¡BSTï¼‰å‡ºç°</li>
<li><strong>1972å¹´</strong>ï¼šçº¢é»‘æ ‘æå‡º</li>
<li><strong>1970s</strong>ï¼šBæ ‘åœ¨æ•°æ®åº“ç³»ç»Ÿä¸­åº”ç”¨</li>
<li><strong>1990sè‡³ä»Š</strong>ï¼šå„ç§å¹³è¡¡BSTå˜ä½“å’Œä¼˜åŒ–</li>
</ul>
<h2 data-id="heading-4">äºŒã€æ¦‚è¿°</h2>
<h3 data-id="heading-5">1. å®šä¹‰ä¸æ ¸å¿ƒæ€§è´¨</h3>
<p>äºŒå‰æœç´¢æ ‘ï¼ˆBinary Search Treeï¼ŒBSTï¼‰æ˜¯äºŒå‰æ ‘çš„å­é›†ï¼Œæ»¡è¶³ä»¥ä¸‹æ€§è´¨ï¼š</p>
<p><strong>æ ¸å¿ƒæ€§è´¨</strong>ï¼ˆæ ¹æ®CLRSå®šä¹‰ï¼‰ï¼š</p>
<ol>
<li><strong>å·¦å­æ ‘æ€§è´¨</strong>ï¼šå·¦å­æ ‘æ‰€æœ‰å…ƒç´  &lt; å½“å‰èŠ‚ç‚¹å…ƒç´ </li>
<li><strong>å³å­æ ‘æ€§è´¨</strong>ï¼šå³å­æ ‘æ‰€æœ‰å…ƒç´  &gt; å½“å‰èŠ‚ç‚¹å…ƒç´ </li>
<li><strong>é€’å½’æ€§è´¨</strong>ï¼šå·¦å³å­æ ‘ä¹Ÿéƒ½æ˜¯äºŒå‰æœç´¢æ ‘</li>
<li><strong>å¯æ¯”è¾ƒæ€§</strong>ï¼šå…ƒç´ å¯æ¯”è¾ƒï¼ˆå¦‚intã€Stringï¼Œè‡ªå®šä¹‰ç±»å‹éœ€å®ç°<code>Comparable</code>ï¼‰</li>
</ol>
<p><strong>å½¢å¼åŒ–å®šä¹‰</strong>ï¼ˆæ ¹æ®CLRSå®šä¹‰ï¼‰ï¼š</p>
<p>å¯¹äºBSTä¸­çš„ä»»æ„èŠ‚ç‚¹xï¼š</p>
<ul>
<li>å¦‚æœyæ˜¯xå·¦å­æ ‘ä¸­çš„èŠ‚ç‚¹ï¼Œåˆ™<code>y.key â‰¤ x.key</code></li>
<li>å¦‚æœyæ˜¯xå³å­æ ‘ä¸­çš„èŠ‚ç‚¹ï¼Œåˆ™<code>y.key â‰¥ x.key</code></li>
</ul>
<p><strong>æ•°å­¦è¡¨è¿°</strong>ï¼š</p>
<p>è®¾BST Tï¼Œå¯¹äºæ ‘ä¸­çš„ä»»æ„èŠ‚ç‚¹vï¼š</p>
<ul>
<li>å¦‚æœ<code>left_subtree(v) â‰  âˆ…</code>ï¼Œåˆ™å¯¹äºæ‰€æœ‰<code>u âˆˆ left_subtree(v)</code>ï¼š<code>u.key â‰¤ v.key</code></li>
<li>å¦‚æœ<code>right_subtree(v) â‰  âˆ…</code>ï¼Œåˆ™å¯¹äºæ‰€æœ‰<code>u âˆˆ right_subtree(v)</code>ï¼š<code>u.key â‰¥ v.key</code></li>
</ul>
<p><strong>BSTä¸å˜æ€§ï¼ˆInvariantï¼‰</strong>ï¼š</p>
<p>å¯¹äºBSTä¸­çš„ä»»æ„èŠ‚ç‚¹vï¼Œå§‹ç»ˆæ»¡è¶³ï¼š</p>
<ul>
<li>å·¦å­æ ‘æ‰€æœ‰èŠ‚ç‚¹çš„å…³é”®å­— â‰¤ v.key</li>
<li>å³å­æ ‘æ‰€æœ‰èŠ‚ç‚¹çš„å…³é”®å­— â‰¥ v.key</li>
<li>è¿™ä¸ªæ€§è´¨åœ¨æ’å…¥å’Œåˆ é™¤æ“ä½œåå¿…é¡»ä¿æŒ</li>
</ul>
<p><strong>å­¦æœ¯å‚è€ƒ</strong>ï¼š</p>
<ul>
<li>CLRS Chapter 12: Binary Search Trees</li>
<li>Knuth, D. E. (1997). <em>The Art of Computer Programming, Volume 3</em>. Section 6.2.2: Binary Tree Searching</li>
<li>Weiss, M. A. (2011). <em>Data Structures and Algorithm Analysis in Java</em>. Chapter 4: Trees</li>
<li>Knuth, D. E. (1997). <em>The Art of Computer Programming, Volume 3</em>. Section 6.2.2: Binary Tree Searching</li>
</ul>
<h3 data-id="heading-6">2. BSTçš„ç¤ºæ„å›¾</h3>
<pre><code class="hljs language-erlang" lang="erlang">ç¤ºä¾‹BST:
        <span class="hljs-number">8</span>
       / \
      <span class="hljs-number">3</span>   <span class="hljs-number">10</span>
     / \    \
    <span class="hljs-number">1</span>   <span class="hljs-number">6</span>    <span class="hljs-number">14</span>
       / \  /
      <span class="hljs-number">4</span>  <span class="hljs-number">7</span> <span class="hljs-number">13</span>

æ€§è´¨éªŒè¯:
- èŠ‚ç‚¹8: å·¦å­æ ‘<span class="hljs-params">(<span class="hljs-number">3</span>,<span class="hljs-number">1</span>,<span class="hljs-number">6</span>,<span class="hljs-number">4</span>,<span class="hljs-number">7</span>)</span> &lt; 8 &lt; å³å­æ ‘<span class="hljs-params">(<span class="hljs-number">10</span>,<span class="hljs-number">14</span>,<span class="hljs-number">13</span>)</span> âœ“
- èŠ‚ç‚¹3: å·¦å­æ ‘<span class="hljs-params">(<span class="hljs-number">1</span>)</span> &lt; 3 &lt; å³å­æ ‘<span class="hljs-params">(<span class="hljs-number">6</span>,<span class="hljs-number">4</span>,<span class="hljs-number">7</span>)</span> âœ“
- èŠ‚ç‚¹6: å·¦å­æ ‘<span class="hljs-params">(<span class="hljs-number">4</span>)</span> &lt; 6 &lt; å³å­æ ‘<span class="hljs-params">(<span class="hljs-number">7</span>)</span> âœ“

ä¸­åºéå†ç»“æœï¼š1, 3, 4, 6, 7, 8, 10, 13, 14ï¼ˆå‡åºï¼‰âœ“
</code></pre>
<h3 data-id="heading-7">3. BSTçš„æ ¸å¿ƒç‰¹æ€§</h3>
<ol>
<li><strong>æœ‰åºæ€§</strong>ï¼šä¸­åºéå†BSTå¾—åˆ°æœ‰åºåºåˆ—ï¼ˆå‡åºæˆ–é™åºï¼‰</li>
<li><strong>å”¯ä¸€æ€§</strong>ï¼šé€šå¸¸ä¸å…è®¸é‡å¤å€¼ï¼ˆæˆ–å¯å®šä¹‰å¤„ç†è§„åˆ™ï¼Œå¦‚è¦†ç›–æˆ–è®¡æ•°ï¼‰</li>
<li><strong>é€’å½’ç»“æ„</strong>ï¼šå·¦å³å­æ ‘éƒ½æ˜¯BST</li>
<li><strong>åŠ¨æ€æ€§</strong>ï¼šæ”¯æŒé«˜æ•ˆçš„åŠ¨æ€æ’å…¥å’Œåˆ é™¤æ“ä½œ</li>
</ol>
<h2 data-id="heading-8">ä¸‰ã€BSTçš„æ€§è´¨</h2>
<ol>
<li><strong>æœ‰åºæ€§</strong>ï¼šä¸­åºéå†BSTå¾—åˆ°æœ‰åºåºåˆ—</li>
<li><strong>å”¯ä¸€æ€§</strong>ï¼šé€šå¸¸ä¸å…è®¸é‡å¤å€¼ï¼ˆæˆ–å¯å®šä¹‰å¤„ç†è§„åˆ™ï¼‰</li>
<li><strong>é€’å½’ç»“æ„</strong>ï¼šå·¦å³å­æ ‘éƒ½æ˜¯BST</li>
</ol>
<h3 data-id="heading-9">ä¸­åºéå†ç»“æœ</h3>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">ç¤ºä¾‹BST:</span>
        8
       / \
      3   10
     / \    \
    1   6    14

<span class="hljs-section">ä¸­åºéå†: 1, 3, 4, 6, 7, 8, 10, 13, 14 ï¼ˆæœ‰åºï¼‰</span>
</code></pre>
<h2 data-id="heading-10">å››ã€BSTçš„æ ¸å¿ƒæ“ä½œ</h2>
<h3 data-id="heading-11">1. æ·»åŠ å…ƒç´ </h3>
<p><strong>ç®—æ³•æ€è·¯</strong>ï¼š</p>
<ol>
<li>ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œæ¯”è¾ƒå…ƒç´ å€¼</li>
<li>å¦‚æœå°äºå½“å‰èŠ‚ç‚¹ï¼Œè¿›å…¥å·¦å­æ ‘</li>
<li>å¦‚æœå¤§äºå½“å‰èŠ‚ç‚¹ï¼Œè¿›å…¥å³å­æ ‘</li>
<li>å¦‚æœç­‰äºå½“å‰èŠ‚ç‚¹ï¼Œè¦†ç›–æ—§å€¼ï¼ˆå»é‡ï¼‰</li>
<li>æ‰¾åˆ°ç©ºä½ç½®åï¼Œåˆ›å»ºæ–°èŠ‚ç‚¹å¹¶æ’å…¥</li>
</ol>
<p><strong>ä»£ç å®ç°</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * æ·»åŠ å…ƒç´ åˆ°BST
 * 
 * æ—¶é—´å¤æ‚åº¦ï¼šO(h)ï¼Œhä¸ºæ ‘é«˜åº¦ï¼ˆå¹³å‡O(log n)ï¼Œæœ€åO(n)ï¼‰
 * ç©ºé—´å¤æ‚åº¦ï¼šO(1)ï¼ˆè¿­ä»£å®ç°ï¼‰æˆ–O(h)ï¼ˆé€’å½’å®ç°ï¼‰
 * 
 * å­¦æœ¯å‚è€ƒï¼šCLRS Chapter 12.3: Insertion and deletion
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(E element)</span> {
    <span class="hljs-comment">// ç©ºå€¼æ£€æŸ¥</span>
    elementNotNullCheck(element);
    
    <span class="hljs-comment">// ç©ºæ ‘ï¼šæ–°å»ºæ ¹èŠ‚ç‚¹</span>
    <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">null</span>) {
        root = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>&lt;&gt;(element, <span class="hljs-literal">null</span>);
        size++;
        <span class="hljs-keyword">return</span>;
    }
    
    <span class="hljs-comment">// æ‰¾åˆ°æ’å…¥ä½ç½®</span>
    Node&lt;E&gt; cur = root;
    Node&lt;E&gt; parent = <span class="hljs-literal">null</span>;
    <span class="hljs-type">int</span> <span class="hljs-variable">cmp</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">while</span> (cur != <span class="hljs-literal">null</span>) {
        cmp = compare(element, cur.element);
        parent = cur;
        
        <span class="hljs-keyword">if</span> (cmp &lt; <span class="hljs-number">0</span>) {
            cur = cur.left;  <span class="hljs-comment">// è¿›å…¥å·¦å­æ ‘</span>
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (cmp &gt; <span class="hljs-number">0</span>) {
            cur = cur.right; <span class="hljs-comment">// è¿›å…¥å³å­æ ‘</span>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// å…ƒç´ å·²å­˜åœ¨ï¼Œè¦†ç›–æ—§å€¼ï¼ˆå»é‡ï¼‰</span>
            cur.element = element;
            <span class="hljs-keyword">return</span>;
        }
    }
    
    <span class="hljs-comment">// åˆ›å»ºæ–°èŠ‚ç‚¹å¹¶æŒ‚è½½åˆ°çˆ¶èŠ‚ç‚¹</span>
    Node&lt;E&gt; newNode = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>&lt;&gt;(element, parent);
    
    <span class="hljs-keyword">if</span> (cmp &lt; <span class="hljs-number">0</span>) {
        parent.left = newNode;
    } <span class="hljs-keyword">else</span> {
        parent.right = newNode;
    }
    
    size++;
}

<span class="hljs-comment">/**
 * æ¯”è¾ƒå™¨ï¼ˆæ”¯æŒè‡ªå®šä¹‰æ¯”è¾ƒé€»è¾‘ï¼‰
 * 
 * <span class="hljs-doctag">@param</span> e1 å…ƒç´ 1
 * <span class="hljs-doctag">@param</span> e2 å…ƒç´ 2
 * <span class="hljs-doctag">@return</span> è´Ÿæ•°è¡¨ç¤ºe1 &lt; e2ï¼Œ0è¡¨ç¤ºç›¸ç­‰ï¼Œæ­£æ•°è¡¨ç¤ºe1 &gt; e2
 */</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compare</span><span class="hljs-params">(E e1, E e2)</span> {
    <span class="hljs-keyword">if</span> (comparator != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span> comparator.compare(e1, e2);
    }
    <span class="hljs-keyword">return</span> ((Comparable&lt;E&gt;) e1).compareTo(e2);
}
</code></pre>
<p><strong>æ’å…¥è¿‡ç¨‹ç¤ºä¾‹</strong>ï¼ˆæ’å…¥å…ƒç´ 5ï¼‰ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">åˆå§‹BST:</span>
        8
       / \
      3   10
     / \
    1   6

<span class="hljs-section">æ’å…¥5:</span>
<span class="hljs-section">æ­¥éª¤1: 5 &lt; 8ï¼Œè¿›å…¥å·¦å­æ ‘</span>
<span class="hljs-section">æ­¥éª¤2: 5 &gt; 3ï¼Œè¿›å…¥å³å­æ ‘</span>
<span class="hljs-section">æ­¥éª¤3: 5 &lt; 6ï¼Œè¿›å…¥å·¦å­æ ‘ï¼ˆç©ºä½ç½®ï¼‰</span>
<span class="hljs-section">æ­¥éª¤4: åˆ›å»ºèŠ‚ç‚¹5ï¼ŒæŒ‚è½½åˆ°èŠ‚ç‚¹6çš„å·¦å­æ ‘</span>

<span class="hljs-section">ç»“æœ:</span>
        8
       / \
      3   10
     / \
    1   6
       /
      5
</code></pre>
<p><strong>ä¼ªä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">ALGORITHM <span class="hljs-built_in">BSTInsert</span>(root, element)
    <span class="hljs-comment">// è¾“å…¥ï¼šBSTæ ¹èŠ‚ç‚¹rootï¼Œè¦æ’å…¥çš„å…ƒç´ element</span>
    <span class="hljs-comment">// è¾“å‡ºï¼šæ›´æ–°åçš„BST</span>
    
    IF root = NULL THEN
        root â† <span class="hljs-built_in">NewNode</span>(element, NULL)
        RETURN
    
    cur â† root
    parent â† NULL
    
    WHILE cur â‰  NULL DO
        parent â† cur
        cmp â† <span class="hljs-built_in">Compare</span>(element, cur.element)
        
        IF cmp &lt; <span class="hljs-number">0</span> THEN
            cur â† cur<span class="hljs-selector-class">.left</span>
        ELSE IF cmp &gt; <span class="hljs-number">0</span> THEN
            cur â† cur<span class="hljs-selector-class">.right</span>
        ELSE
            cur<span class="hljs-selector-class">.element</span> â† element  <span class="hljs-comment">// è¦†ç›–æ—§å€¼</span>
            RETURN
    
    <span class="hljs-comment">// åˆ›å»ºæ–°èŠ‚ç‚¹</span>
    newNode â† <span class="hljs-built_in">NewNode</span>(element, parent)
    
    IF cmp &lt; <span class="hljs-number">0</span> THEN
        parent<span class="hljs-selector-class">.left</span> â† newNode
    ELSE
        parent<span class="hljs-selector-class">.right</span> â† newNode
</code></pre>
<h3 data-id="heading-12">2. åˆ é™¤å…ƒç´ </h3>
<p><strong>åˆ é™¤éœ€åˆ†3ç§æƒ…å†µ</strong>ï¼ˆæ ¹æ®èŠ‚ç‚¹çš„åº¦ï¼‰ï¼š</p>
<ol>
<li><strong>åº¦ä¸º0çš„èŠ‚ç‚¹</strong>ï¼ˆå¶å­èŠ‚ç‚¹ï¼‰ï¼šç›´æ¥åˆ é™¤</li>
<li><strong>åº¦ä¸º1çš„èŠ‚ç‚¹</strong>ï¼šç”¨å­èŠ‚ç‚¹æ›¿ä»£</li>
<li><strong>åº¦ä¸º2çš„èŠ‚ç‚¹</strong>ï¼šç”¨å‰é©±æˆ–åç»§æ›¿ä»£ï¼Œç„¶ååˆ é™¤å‰é©±/åç»§ï¼ˆè½¬ä¸ºæƒ…å†µ1æˆ–2ï¼‰</li>
</ol>
<p><strong>ä»£ç å®ç°</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * åˆ é™¤å…ƒç´ 
 * 
 * æ—¶é—´å¤æ‚åº¦ï¼šO(h)ï¼Œhä¸ºæ ‘é«˜åº¦
 * ç©ºé—´å¤æ‚åº¦ï¼šO(1)
 * 
 * <span class="hljs-doctag">@param</span> element è¦åˆ é™¤çš„å…ƒç´ 
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">remove</span><span class="hljs-params">(E element)</span> {
    Node&lt;E&gt; node = node(element);  <span class="hljs-comment">// å…ˆæ‰¾åˆ°å…ƒç´ å¯¹åº”çš„èŠ‚ç‚¹</span>
    remove(node);
}

<span class="hljs-comment">/**
 * åˆ é™¤èŠ‚ç‚¹ï¼ˆæ ¸å¿ƒæ–¹æ³•ï¼‰
 * 
 * <span class="hljs-doctag">@param</span> node è¦åˆ é™¤çš„èŠ‚ç‚¹
 */</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">remove</span><span class="hljs-params">(Node&lt;E&gt; node)</span> {
    <span class="hljs-keyword">if</span> (node == <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span>;
    }
    
    size--;
    
    <span class="hljs-comment">// æƒ…å†µ1ï¼šåº¦ä¸º2çš„èŠ‚ç‚¹ï¼ˆç”¨å‰é©±/åç»§æ›¿ä»£ï¼‰</span>
    <span class="hljs-keyword">if</span> (node.hasTwoChildren()) {
        <span class="hljs-comment">// æ‰¾åç»§èŠ‚ç‚¹ï¼ˆå³å­æ ‘çš„æœ€å·¦èŠ‚ç‚¹ï¼‰</span>
        Node&lt;E&gt; successor = successor(node);
        
        <span class="hljs-comment">// ç”¨åç»§èŠ‚ç‚¹çš„å€¼è¦†ç›–å½“å‰èŠ‚ç‚¹</span>
        node.element = successor.element;
        
        <span class="hljs-comment">// è½¬ä¸ºåˆ é™¤åç»§èŠ‚ç‚¹ï¼ˆåº¦0æˆ–1ï¼‰</span>
        node = successor;
    }
    
    <span class="hljs-comment">// æƒ…å†µ2ï¼šåº¦ä¸º0æˆ–1çš„èŠ‚ç‚¹</span>
    Node&lt;E&gt; child = (node.left != <span class="hljs-literal">null</span>) ? node.left : node.right;
    Node&lt;E&gt; parent = node.parent;
    
    <span class="hljs-keyword">if</span> (parent == <span class="hljs-literal">null</span>) {
        <span class="hljs-comment">// èŠ‚ç‚¹æ˜¯æ ¹èŠ‚ç‚¹</span>
        root = child;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (parent.left == node) {
        parent.left = child;
    } <span class="hljs-keyword">else</span> {
        parent.right = child;
    }
    
    <span class="hljs-comment">// ç»‘å®šçˆ¶èŠ‚ç‚¹</span>
    <span class="hljs-keyword">if</span> (child != <span class="hljs-literal">null</span>) {
        child.parent = parent;
    }
}

<span class="hljs-comment">/**
 * æ‰¾åç»§èŠ‚ç‚¹ï¼ˆä¸­åºéå†çš„åä¸€ä¸ªèŠ‚ç‚¹ï¼‰
 * 
 * ç®—æ³•ï¼š
 * 1. å¦‚æœå³å­æ ‘ä¸ä¸ºç©ºï¼Œæ‰¾å³å­æ ‘çš„æœ€å·¦èŠ‚ç‚¹
 * 2. å¦‚æœå³å­æ ‘ä¸ºç©ºï¼Œå‘ä¸Šæ‰¾çˆ¶èŠ‚ç‚¹ï¼Œç›´åˆ°å½“å‰èŠ‚ç‚¹æ˜¯çˆ¶èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹
 * 
 * <span class="hljs-doctag">@param</span> node å½“å‰èŠ‚ç‚¹
 * <span class="hljs-doctag">@return</span> åç»§èŠ‚ç‚¹
 */</span>
<span class="hljs-keyword">private</span> Node&lt;E&gt; <span class="hljs-title function_">successor</span><span class="hljs-params">(Node&lt;E&gt; node)</span> {
    <span class="hljs-keyword">if</span> (node == <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    
    <span class="hljs-comment">// å³å­æ ‘ä¸ä¸ºç©ºï¼Œæ‰¾å³å­æ ‘çš„æœ€å·¦èŠ‚ç‚¹</span>
    Node&lt;E&gt; cur = node.right;
    <span class="hljs-keyword">if</span> (cur != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">while</span> (cur.left != <span class="hljs-literal">null</span>) {
            cur = cur.left;
        }
        <span class="hljs-keyword">return</span> cur;
    }
    
    <span class="hljs-comment">// å³å­æ ‘ä¸ºç©ºï¼Œå‘ä¸Šæ‰¾çˆ¶èŠ‚ç‚¹</span>
    <span class="hljs-keyword">while</span> (node.parent != <span class="hljs-literal">null</span> &amp;&amp; node == node.parent.right) {
        node = node.parent;
    }
    
    <span class="hljs-keyword">return</span> node.parent;
}
</code></pre>
<p><strong>åˆ é™¤è¿‡ç¨‹ç¤ºä¾‹</strong>ï¼ˆåˆ é™¤èŠ‚ç‚¹3ï¼Œåº¦ä¸º2ï¼‰ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">åˆå§‹BST:</span>
        8
       / \
      3   10
     / \
    1   6
       / \
      4   7

<span class="hljs-section">åˆ é™¤èŠ‚ç‚¹3ï¼ˆåº¦ä¸º2ï¼‰:</span>
<span class="hljs-section">æ­¥éª¤1: æ‰¾åç»§èŠ‚ç‚¹ï¼ˆèŠ‚ç‚¹3çš„å³å­æ ‘6çš„æœ€å·¦èŠ‚ç‚¹4ï¼‰</span>
<span class="hljs-section">æ­¥éª¤2: ç”¨èŠ‚ç‚¹4çš„å€¼è¦†ç›–èŠ‚ç‚¹3</span>
<span class="hljs-section">æ­¥éª¤3: åˆ é™¤èŠ‚ç‚¹4ï¼ˆåº¦ä¸º0ï¼Œç›´æ¥åˆ é™¤ï¼‰</span>

<span class="hljs-section">ç»“æœ:</span>
        8
       / \
      4   10
     / \
    1   6
         \
          7
</code></pre>
<p><strong>ä¼ªä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">ALGORITHM <span class="hljs-built_in">BSTDelete</span>(root, element)
    <span class="hljs-comment">// è¾“å…¥ï¼šBSTæ ¹èŠ‚ç‚¹rootï¼Œè¦åˆ é™¤çš„å…ƒç´ element</span>
    <span class="hljs-comment">// è¾“å‡ºï¼šæ›´æ–°åçš„BST</span>
    
    node â† <span class="hljs-built_in">BSTSearch</span>(root, element)
    IF node = NULL THEN
        RETURN
    
    IF node<span class="hljs-selector-class">.hasTwoChildren</span>() THEN
        successor â† <span class="hljs-built_in">Successor</span>(node)
        node<span class="hljs-selector-class">.element</span> â† successor<span class="hljs-selector-class">.element</span>
        node â† successor
    
    <span class="hljs-comment">// åˆ é™¤åº¦ä¸º0æˆ–1çš„èŠ‚ç‚¹</span>
    child â† IF node<span class="hljs-selector-class">.left</span> â‰  NULL THEN node<span class="hljs-selector-class">.left</span> ELSE node<span class="hljs-selector-class">.right</span>
    parent â† node<span class="hljs-selector-class">.parent</span>
    
    IF parent = NULL THEN
        root â† child
    ELSE IF parent<span class="hljs-selector-class">.left</span> = node THEN
        parent<span class="hljs-selector-class">.left</span> â† child
    ELSE
        parent<span class="hljs-selector-class">.right</span> â† child
    
    IF child â‰  NULL THEN
        child<span class="hljs-selector-class">.parent</span> â† parent
</code></pre>
<h3 data-id="heading-13">3. æŸ¥æ‰¾ï¼ˆSearchï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * æŸ¥æ‰¾å…ƒç´ 
 * 
 * æ—¶é—´å¤æ‚åº¦ï¼šO(h)ï¼Œhä¸ºæ ‘é«˜åº¦ï¼ˆå¹³å‡O(log n)ï¼Œæœ€åO(n)ï¼‰
 * ç©ºé—´å¤æ‚åº¦ï¼šO(1)ï¼ˆè¿­ä»£å®ç°ï¼‰æˆ–O(h)ï¼ˆé€’å½’å®ç°ï¼‰
 * 
 * <span class="hljs-doctag">@param</span> element è¦æŸ¥æ‰¾çš„å…ƒç´ 
 * <span class="hljs-doctag">@return</span> åŒ…å«è¯¥å…ƒç´ çš„èŠ‚ç‚¹ï¼Œå¦‚æœä¸å­˜åœ¨è¿”å›null
 */</span>
<span class="hljs-keyword">public</span> Node&lt;E&gt; <span class="hljs-title function_">node</span><span class="hljs-params">(E element)</span> {
    Node&lt;E&gt; cur = root;
    
    <span class="hljs-keyword">while</span> (cur != <span class="hljs-literal">null</span>) {
        <span class="hljs-type">int</span> <span class="hljs-variable">cmp</span> <span class="hljs-operator">=</span> compare(element, cur.element);
        
        <span class="hljs-keyword">if</span> (cmp &lt; <span class="hljs-number">0</span>) {
            cur = cur.left;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (cmp &gt; <span class="hljs-number">0</span>) {
            cur = cur.right;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> cur;  <span class="hljs-comment">// æ‰¾åˆ°</span>
        }
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;  <span class="hljs-comment">// æœªæ‰¾åˆ°</span>
}

<span class="hljs-comment">// é€’å½’å®ç°</span>
<span class="hljs-keyword">public</span> TreeNode <span class="hljs-title function_">search</span><span class="hljs-params">(TreeNode root, <span class="hljs-type">int</span> val)</span> {
    <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">null</span> || root.val == val) {
        <span class="hljs-keyword">return</span> root;
    }
    
    <span class="hljs-keyword">if</span> (val &lt; root.val) {
        <span class="hljs-keyword">return</span> search(root.left, val);
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> search(root.right, val);
    }
}

<span class="hljs-comment">// è¿­ä»£å®ç°</span>
<span class="hljs-keyword">public</span> TreeNode <span class="hljs-title function_">searchIterative</span><span class="hljs-params">(TreeNode root, <span class="hljs-type">int</span> val)</span> {
    <span class="hljs-type">TreeNode</span> <span class="hljs-variable">cur</span> <span class="hljs-operator">=</span> root;
    <span class="hljs-keyword">while</span> (cur != <span class="hljs-literal">null</span> &amp;&amp; cur.val != val) {
        <span class="hljs-keyword">if</span> (val &lt; cur.val) {
            cur = cur.left;
        } <span class="hljs-keyword">else</span> {
            cur = cur.right;
        }
    }
    <span class="hljs-keyword">return</span> cur;
}
</code></pre>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># é€’å½’å®ç°</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">search</span>(<span class="hljs-params">root, val</span>):
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> root <span class="hljs-keyword">or</span> root.val == val:
        <span class="hljs-keyword">return</span> root
    
    <span class="hljs-keyword">if</span> val &lt; root.val:
        <span class="hljs-keyword">return</span> search(root.left, val)
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">return</span> search(root.right, val)

<span class="hljs-comment"># è¿­ä»£å®ç°</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">search_iterative</span>(<span class="hljs-params">root, val</span>):
    cur = root
    <span class="hljs-keyword">while</span> cur <span class="hljs-keyword">and</span> cur.val != val:
        <span class="hljs-keyword">if</span> val &lt; cur.val:
            cur = cur.left
        <span class="hljs-keyword">else</span>:
            cur = cur.right
    <span class="hljs-keyword">return</span> cur
</code></pre>
<h3 data-id="heading-14">2. æ’å…¥ï¼ˆInsertï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// é€’å½’å®ç°</span>
<span class="hljs-keyword">public</span> TreeNode <span class="hljs-title function_">insert</span><span class="hljs-params">(TreeNode root, <span class="hljs-type">int</span> val)</span> {
    <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(val);
    }
    
    <span class="hljs-keyword">if</span> (val &lt; root.val) {
        root.left = insert(root.left, val);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (val &gt; root.val) {
        root.right = insert(root.right, val);
    }
    <span class="hljs-comment">// val == root.val å¯ä»¥å¿½ç•¥æˆ–å®šä¹‰å¤„ç†è§„åˆ™</span>
    
    <span class="hljs-keyword">return</span> root;
}

<span class="hljs-comment">// è¿­ä»£å®ç°</span>
<span class="hljs-keyword">public</span> TreeNode <span class="hljs-title function_">insertIterative</span><span class="hljs-params">(TreeNode root, <span class="hljs-type">int</span> val)</span> {
    <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(val);
    }
    
    <span class="hljs-type">TreeNode</span> <span class="hljs-variable">cur</span> <span class="hljs-operator">=</span> root;
    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
        <span class="hljs-keyword">if</span> (val &lt; cur.val) {
            <span class="hljs-keyword">if</span> (cur.left == <span class="hljs-literal">null</span>) {
                cur.left = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(val);
                <span class="hljs-keyword">break</span>;
            }
            cur = cur.left;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (val &gt; cur.val) {
            <span class="hljs-keyword">if</span> (cur.right == <span class="hljs-literal">null</span>) {
                cur.right = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(val);
                <span class="hljs-keyword">break</span>;
            }
            cur = cur.right;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">break</span>;  <span class="hljs-comment">// å€¼å·²å­˜åœ¨</span>
        }
    }
    
    <span class="hljs-keyword">return</span> root;
}
</code></pre>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># é€’å½’å®ç°</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">insert</span>(<span class="hljs-params">root, val</span>):
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> root:
        <span class="hljs-keyword">return</span> TreeNode(val)
    
    <span class="hljs-keyword">if</span> val &lt; root.val:
        root.left = insert(root.left, val)
    <span class="hljs-keyword">elif</span> val &gt; root.val:
        root.right = insert(root.right, val)
    <span class="hljs-comment"># val == root.val å¯ä»¥å¿½ç•¥</span>
    
    <span class="hljs-keyword">return</span> root

<span class="hljs-comment"># è¿­ä»£å®ç°</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">insert_iterative</span>(<span class="hljs-params">root, val</span>):
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> root:
        <span class="hljs-keyword">return</span> TreeNode(val)
    
    cur = root
    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
        <span class="hljs-keyword">if</span> val &lt; cur.val:
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> cur.left:
                cur.left = TreeNode(val)
                <span class="hljs-keyword">break</span>
            cur = cur.left
        <span class="hljs-keyword">elif</span> val &gt; cur.val:
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> cur.right:
                cur.right = TreeNode(val)
                <span class="hljs-keyword">break</span>
            cur = cur.right
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">break</span>  <span class="hljs-comment"># å€¼å·²å­˜åœ¨</span>
    
    <span class="hljs-keyword">return</span> root
</code></pre>
<h3 data-id="heading-15">3. åˆ é™¤ï¼ˆDeleteï¼‰</h3>
<p>åˆ é™¤èŠ‚ç‚¹æœ‰ä¸‰ç§æƒ…å†µï¼š</p>
<ul>
<li><strong>å¶å­èŠ‚ç‚¹</strong>ï¼šç›´æ¥åˆ é™¤</li>
<li><strong>åªæœ‰ä¸€ä¸ªå­èŠ‚ç‚¹</strong>ï¼šç”¨å­èŠ‚ç‚¹æ›¿æ¢</li>
<li><strong>æœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹</strong>ï¼šç”¨å³å­æ ‘çš„æœ€å°å€¼ï¼ˆæˆ–å·¦å­æ ‘çš„æœ€å¤§å€¼ï¼‰æ›¿æ¢</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> TreeNode <span class="hljs-title function_">deleteNode</span><span class="hljs-params">(TreeNode root, <span class="hljs-type">int</span> val)</span> {
    <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    
    <span class="hljs-keyword">if</span> (val &lt; root.val) {
        root.left = deleteNode(root.left, val);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (val &gt; root.val) {
        root.right = deleteNode(root.right, val);
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// æ‰¾åˆ°è¦åˆ é™¤çš„èŠ‚ç‚¹</span>
        <span class="hljs-keyword">if</span> (root.left == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> root.right;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (root.right == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> root.left;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// æœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹</span>
            <span class="hljs-comment">// æ‰¾åˆ°å³å­æ ‘çš„æœ€å°å€¼</span>
            <span class="hljs-type">TreeNode</span> <span class="hljs-variable">minNode</span> <span class="hljs-operator">=</span> findMin(root.right);
            root.val = minNode.val;
            root.right = deleteNode(root.right, minNode.val);
        }
    }
    
    <span class="hljs-keyword">return</span> root;
}

<span class="hljs-keyword">private</span> TreeNode <span class="hljs-title function_">findMin</span><span class="hljs-params">(TreeNode node)</span> {
    <span class="hljs-keyword">while</span> (node.left != <span class="hljs-literal">null</span>) {
        node = node.left;
    }
    <span class="hljs-keyword">return</span> node;
}
</code></pre>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">delete_node</span>(<span class="hljs-params">root, val</span>):
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> root:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
    
    <span class="hljs-keyword">if</span> val &lt; root.val:
        root.left = delete_node(root.left, val)
    <span class="hljs-keyword">elif</span> val &gt; root.val:
        root.right = delete_node(root.right, val)
    <span class="hljs-keyword">else</span>:
        <span class="hljs-comment"># æ‰¾åˆ°è¦åˆ é™¤çš„èŠ‚ç‚¹</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> root.left:
            <span class="hljs-keyword">return</span> root.right
        <span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> root.right:
            <span class="hljs-keyword">return</span> root.left
        <span class="hljs-keyword">else</span>:
            <span class="hljs-comment"># æœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹</span>
            <span class="hljs-comment"># æ‰¾åˆ°å³å­æ ‘çš„æœ€å°å€¼</span>
            min_node = find_min(root.right)
            root.val = min_node.val
            root.right = delete_node(root.right, min_node.val)
    
    <span class="hljs-keyword">return</span> root

<span class="hljs-keyword">def</span> <span class="hljs-title function_">find_min</span>(<span class="hljs-params">node</span>):
    <span class="hljs-keyword">while</span> node.left:
        node = node.left
    <span class="hljs-keyword">return</span> node
</code></pre>
<h2 data-id="heading-16">äº”ã€BSTçš„å®ç°</h2>
<h3 data-id="heading-17">Java å®Œæ•´å®ç°</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BST</span> {
    <span class="hljs-keyword">private</span> TreeNode root;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> size;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">BST</span><span class="hljs-params">()</span> {
        root = <span class="hljs-literal">null</span>;
        size = <span class="hljs-number">0</span>;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">size</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> size;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isEmpty</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> size == <span class="hljs-number">0</span>;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-type">int</span> val)</span> {
        root = add(root, val);
    }
    
    <span class="hljs-keyword">private</span> TreeNode <span class="hljs-title function_">add</span><span class="hljs-params">(TreeNode node, <span class="hljs-type">int</span> val)</span> {
        <span class="hljs-keyword">if</span> (node == <span class="hljs-literal">null</span>) {
            size++;
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(val);
        }
        
        <span class="hljs-keyword">if</span> (val &lt; node.val) {
            node.left = add(node.left, val);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (val &gt; node.val) {
            node.right = add(node.right, val);
        }
        
        <span class="hljs-keyword">return</span> node;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">contains</span><span class="hljs-params">(<span class="hljs-type">int</span> val)</span> {
        <span class="hljs-keyword">return</span> contains(root, val);
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">contains</span><span class="hljs-params">(TreeNode node, <span class="hljs-type">int</span> val)</span> {
        <span class="hljs-keyword">if</span> (node == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        
        <span class="hljs-keyword">if</span> (val == node.val) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (val &lt; node.val) <span class="hljs-keyword">return</span> contains(node.left, val);
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> contains(node.right, val);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">remove</span><span class="hljs-params">(<span class="hljs-type">int</span> val)</span> {
        root = remove(root, val);
    }
    
    <span class="hljs-keyword">private</span> TreeNode <span class="hljs-title function_">remove</span><span class="hljs-params">(TreeNode node, <span class="hljs-type">int</span> val)</span> {
        <span class="hljs-keyword">if</span> (node == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        
        <span class="hljs-keyword">if</span> (val &lt; node.val) {
            node.left = remove(node.left, val);
            <span class="hljs-keyword">return</span> node;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (val &gt; node.val) {
            node.right = remove(node.right, val);
            <span class="hljs-keyword">return</span> node;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">if</span> (node.left == <span class="hljs-literal">null</span>) {
                size--;
                <span class="hljs-keyword">return</span> node.right;
            }
            
            <span class="hljs-keyword">if</span> (node.right == <span class="hljs-literal">null</span>) {
                size--;
                <span class="hljs-keyword">return</span> node.left;
            }
            
            <span class="hljs-type">TreeNode</span> <span class="hljs-variable">successor</span> <span class="hljs-operator">=</span> findMin(node.right);
            successor.right = removeMin(node.right);
            successor.left = node.left;
            
            <span class="hljs-keyword">return</span> successor;
        }
    }
    
    <span class="hljs-keyword">private</span> TreeNode <span class="hljs-title function_">findMin</span><span class="hljs-params">(TreeNode node)</span> {
        <span class="hljs-keyword">if</span> (node.left == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> node;
        <span class="hljs-keyword">return</span> findMin(node.left);
    }
    
    <span class="hljs-keyword">private</span> TreeNode <span class="hljs-title function_">removeMin</span><span class="hljs-params">(TreeNode node)</span> {
        <span class="hljs-keyword">if</span> (node.left == <span class="hljs-literal">null</span>) {
            size--;
            <span class="hljs-keyword">return</span> node.right;
        }
        node.left = removeMin(node.left);
        <span class="hljs-keyword">return</span> node;
    }
}
</code></pre>
<h3 data-id="heading-18">Python å®Œæ•´å®ç°</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BST</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        self.root = <span class="hljs-literal">None</span>
        self.size = <span class="hljs-number">0</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__len__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">return</span> self.size
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">is_empty</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">return</span> self.size == <span class="hljs-number">0</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">self, val</span>):
        self.root = self._add(self.root, val)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_add</span>(<span class="hljs-params">self, node, val</span>):
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> node:
            self.size += <span class="hljs-number">1</span>
            <span class="hljs-keyword">return</span> TreeNode(val)
        
        <span class="hljs-keyword">if</span> val &lt; node.val:
            node.left = self._add(node.left, val)
        <span class="hljs-keyword">elif</span> val &gt; node.val:
            node.right = self._add(node.right, val)
        
        <span class="hljs-keyword">return</span> node
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">contains</span>(<span class="hljs-params">self, val</span>):
        <span class="hljs-keyword">return</span> self._contains(self.root, val)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_contains</span>(<span class="hljs-params">self, node, val</span>):
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> node:
            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
        
        <span class="hljs-keyword">if</span> val == node.val:
            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
        <span class="hljs-keyword">elif</span> val &lt; node.val:
            <span class="hljs-keyword">return</span> self._contains(node.left, val)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">return</span> self._contains(node.right, val)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">remove</span>(<span class="hljs-params">self, val</span>):
        self.root = self._remove(self.root, val)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_remove</span>(<span class="hljs-params">self, node, val</span>):
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> node:
            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
        
        <span class="hljs-keyword">if</span> val &lt; node.val:
            node.left = self._remove(node.left, val)
            <span class="hljs-keyword">return</span> node
        <span class="hljs-keyword">elif</span> val &gt; node.val:
            node.right = self._remove(node.right, val)
            <span class="hljs-keyword">return</span> node
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> node.left:
                self.size -= <span class="hljs-number">1</span>
                <span class="hljs-keyword">return</span> node.right
            
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> node.right:
                self.size -= <span class="hljs-number">1</span>
                <span class="hljs-keyword">return</span> node.left
            
            successor = self._find_min(node.right)
            successor.right = self._remove_min(node.right)
            successor.left = node.left
            
            <span class="hljs-keyword">return</span> successor
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_find_min</span>(<span class="hljs-params">self, node</span>):
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> node.left:
            <span class="hljs-keyword">return</span> node
        <span class="hljs-keyword">return</span> self._find_min(node.left)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_remove_min</span>(<span class="hljs-params">self, node</span>):
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> node.left:
            self.size -= <span class="hljs-number">1</span>
            <span class="hljs-keyword">return</span> node.right
        node.left = self._remove_min(node.left)
        <span class="hljs-keyword">return</span> node
</code></pre>
<h2 data-id="heading-19">å…­ã€æ—¶é—´å¤æ‚åº¦åˆ†æ</h2>
<h3 data-id="heading-20">å¹³è¡¡BST</h3>



































<table><thead><tr><th>æ“ä½œ</th><th>æ—¶é—´å¤æ‚åº¦</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>æŸ¥æ‰¾</td><td>O(log n)</td><td>æ¯æ¬¡å‡å°‘ä¸€åŠæœç´¢ç©ºé—´</td></tr><tr><td>æ’å…¥</td><td>O(log n)</td><td>éœ€è¦æ‰¾åˆ°æ’å…¥ä½ç½®</td></tr><tr><td>åˆ é™¤</td><td>O(log n)</td><td>éœ€è¦æ‰¾åˆ°åˆ é™¤ä½ç½®</td></tr><tr><td>æœ€å°å€¼</td><td>O(log n)</td><td>æœ€å·¦èŠ‚ç‚¹</td></tr><tr><td>æœ€å¤§å€¼</td><td>O(log n)</td><td>æœ€å³èŠ‚ç‚¹</td></tr></tbody></table>
<h3 data-id="heading-21">ä¸å¹³è¡¡BSTï¼ˆæœ€åæƒ…å†µï¼‰</h3>

























<table><thead><tr><th>æ“ä½œ</th><th>æ—¶é—´å¤æ‚åº¦</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>æŸ¥æ‰¾</td><td>O(n)</td><td>é€€åŒ–ä¸ºé“¾è¡¨</td></tr><tr><td>æ’å…¥</td><td>O(n)</td><td>é€€åŒ–ä¸ºé“¾è¡¨</td></tr><tr><td>åˆ é™¤</td><td>O(n)</td><td>é€€åŒ–ä¸ºé“¾è¡¨</td></tr></tbody></table>
<h2 data-id="heading-22">ä¸ƒã€åº”ç”¨åœºæ™¯</h2>
<h3 data-id="heading-23">1. æœ‰åºæ•°æ®çš„æŸ¥æ‰¾</h3>
<p>BSTæä¾›äº†å¿«é€Ÿçš„æŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤æ“ä½œã€‚</p>
<h3 data-id="heading-24">2. èŒƒå›´æŸ¥è¯¢</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æŸ¥æ‰¾èŒƒå›´å†…çš„æ‰€æœ‰å€¼</span>
<span class="hljs-keyword">public</span> List&lt;Integer&gt; <span class="hljs-title function_">rangeSearch</span><span class="hljs-params">(TreeNode root, <span class="hljs-type">int</span> min, <span class="hljs-type">int</span> max)</span> {
    List&lt;Integer&gt; result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    rangeSearchHelper(root, min, max, result);
    <span class="hljs-keyword">return</span> result;
}

<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">rangeSearchHelper</span><span class="hljs-params">(TreeNode node, <span class="hljs-type">int</span> min, <span class="hljs-type">int</span> max, List&lt;Integer&gt; result)</span> {
    <span class="hljs-keyword">if</span> (node == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-keyword">if</span> (min &lt; node.val) {
        rangeSearchHelper(node.left, min, max, result);
    }
    
    <span class="hljs-keyword">if</span> (min &lt;= node.val &amp;&amp; node.val &lt;= max) {
        result.add(node.val);
    }
    
    <span class="hljs-keyword">if</span> (max &gt; node.val) {
        rangeSearchHelper(node.right, min, max, result);
    }
}
</code></pre>
<h3 data-id="heading-25">3. å‰é©±å’Œåç»§</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æŸ¥æ‰¾å‰é©±ï¼ˆå°äºvalçš„æœ€å¤§å€¼ï¼‰</span>
<span class="hljs-keyword">public</span> TreeNode <span class="hljs-title function_">predecessor</span><span class="hljs-params">(TreeNode root, <span class="hljs-type">int</span> val)</span> {
    <span class="hljs-type">TreeNode</span> <span class="hljs-variable">pred</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
    <span class="hljs-type">TreeNode</span> <span class="hljs-variable">cur</span> <span class="hljs-operator">=</span> root;
    
    <span class="hljs-keyword">while</span> (cur != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">if</span> (val &lt;= cur.val) {
            cur = cur.left;
        } <span class="hljs-keyword">else</span> {
            pred = cur;
            cur = cur.right;
        }
    }
    
    <span class="hljs-keyword">return</span> pred;
}

<span class="hljs-comment">// æŸ¥æ‰¾åç»§ï¼ˆå¤§äºvalçš„æœ€å°å€¼ï¼‰</span>
<span class="hljs-keyword">public</span> TreeNode <span class="hljs-title function_">successor</span><span class="hljs-params">(TreeNode root, <span class="hljs-type">int</span> val)</span> {
    <span class="hljs-type">TreeNode</span> <span class="hljs-variable">succ</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
    <span class="hljs-type">TreeNode</span> <span class="hljs-variable">cur</span> <span class="hljs-operator">=</span> root;
    
    <span class="hljs-keyword">while</span> (cur != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">if</span> (val &gt;= cur.val) {
            cur = cur.right;
        } <span class="hljs-keyword">else</span> {
            succ = cur;
            cur = cur.left;
        }
    }
    
    <span class="hljs-keyword">return</span> succ;
}
</code></pre>
<h3 data-id="heading-26">4. å®é™…åº”ç”¨</h3>
<ul>
<li><strong>Java</strong>: TreeSet, TreeMap</li>
<li><strong>æ•°æ®åº“ç´¢å¼•</strong>: Bæ ‘ã€B+æ ‘åŸºäºBSTæ€æƒ³</li>
<li><strong>ç¬¦å·è¡¨</strong>: å®ç°æœ‰åºç¬¦å·è¡¨</li>
</ul>
<h2 data-id="heading-27">å…«ã€å·¥ä¸šç•Œå®è·µæ¡ˆä¾‹</h2>
<h3 data-id="heading-28">1. æ¡ˆä¾‹1ï¼šJava TreeMapçš„å®ç°ï¼ˆOracle/Sun Microsystemså®è·µï¼‰</h3>
<p><strong>èƒŒæ™¯</strong>ï¼šJavaçš„TreeMapä½¿ç”¨çº¢é»‘æ ‘ï¼ˆè‡ªå¹³è¡¡BSTï¼‰å®ç°æœ‰åºæ˜ å°„ã€‚</p>
<p><strong>æŠ€æœ¯å®ç°åˆ†æ</strong>ï¼ˆåŸºäºOracle Javaæºç ï¼‰ï¼š</p>
<ol>
<li>
<p><strong>çº¢é»‘æ ‘ä¿è¯å¹³è¡¡</strong>ï¼š</p>
<ul>
<li><strong>å¹³è¡¡æœºåˆ¶</strong>ï¼šé€šè¿‡é¢œè‰²çº¦æŸå’Œæ—‹è½¬æ“ä½œç»´æŠ¤å¹³è¡¡</li>
<li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šæœ€åæƒ…å†µO(log n)ï¼Œå¹³å‡æƒ…å†µO(log n)</li>
<li><strong>æ ‘é«˜ä¿è¯</strong>ï¼šh â‰¤ 2log(n+1)ï¼Œä¿è¯æŸ¥æ‰¾æ€§èƒ½</li>
</ul>
</li>
<li>
<p><strong>æœ‰åºæ€§æ”¯æŒ</strong>ï¼š</p>
<ul>
<li><strong>èŒƒå›´æŸ¥è¯¢</strong>ï¼šä½¿ç”¨<code>subMap()</code>æ–¹æ³•ï¼Œæ—¶é—´å¤æ‚åº¦O(log n + k)</li>
<li><strong>å‰é©±åç»§</strong>ï¼šä½¿ç”¨<code>lowerEntry()</code>å’Œ<code>higherEntry()</code>æ–¹æ³•ï¼ŒO(log n)</li>
<li><strong>ä¸­åºéå†</strong>ï¼šæŒ‰å…³é”®å­—é¡ºåºéå†ï¼ŒO(n)</li>
</ul>
</li>
<li>
<p><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li><strong>è¿­ä»£å™¨ä¼˜åŒ–</strong>ï¼šç¼“å­˜å½“å‰ä½ç½®ï¼Œæ”¯æŒO(1)çš„next()æ“ä½œ</li>
<li><strong>æ‰¹é‡æ“ä½œ</strong>ï¼š<code>putAll()</code>æ–¹æ³•ä¼˜åŒ–ï¼Œå‡å°‘å¹³è¡¡è°ƒæ•´æ¬¡æ•°</li>
</ul>
</li>
</ol>
<p><strong>æ€§èƒ½æ•°æ®</strong>ï¼ˆOracle Javaå›¢é˜Ÿæµ‹è¯•ï¼Œ1000ä¸‡æ¬¡æ“ä½œï¼‰ï¼š</p>



































<table><thead><tr><th>æ“ä½œ</th><th>TreeMapï¼ˆçº¢é»‘æ ‘ï¼‰</th><th>HashMap</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>æŸ¥æ‰¾</td><td>O(log n)</td><td>O(1)</td><td>HashMapæ›´å¿«</td></tr><tr><td>æ’å…¥</td><td>O(log n)</td><td>O(1)</td><td>HashMapæ›´å¿«</td></tr><tr><td>èŒƒå›´æŸ¥è¯¢</td><td>O(log n + k)</td><td>ä¸æ”¯æŒ</td><td>TreeMapä¼˜åŠ¿</td></tr><tr><td>æœ‰åºéå†</td><td>O(n)</td><td>ä¸æ”¯æŒ</td><td>TreeMapä¼˜åŠ¿</td></tr></tbody></table>
<p><strong>å­¦æœ¯å‚è€ƒ</strong>ï¼š</p>
<ul>
<li>Oracle Java Documentation: TreeMap Class</li>
<li>Java Source Code: java.util.TreeMap</li>
<li>CLRS Chapter 13: Red-Black Trees</li>
</ul>
<p><strong>ä¼ªä»£ç ï¼šTreeMapèŒƒå›´æŸ¥è¯¢</strong></p>
<pre><code class="hljs language-scss" lang="scss">ALGORITHM <span class="hljs-built_in">TreeMapRangeSearch</span>(treeMap, minKey, maxKey)
    result â† <span class="hljs-built_in">EmptyList</span>()
    
    <span class="hljs-comment">// æ‰¾åˆ°èµ·å§‹èŠ‚ç‚¹</span>
    node â† treeMap<span class="hljs-selector-class">.ceilingEntry</span>(minKey)
    
    <span class="hljs-comment">// ä¸­åºéå†èŒƒå›´å†…çš„èŠ‚ç‚¹</span>
    WHILE node â‰  NULL AND node<span class="hljs-selector-class">.key</span> â‰¤ maxKey DO
        result<span class="hljs-selector-class">.add</span>(node.value)
        node â† treeMap<span class="hljs-selector-class">.higherEntry</span>(node.key)
    
    RETURN result
</code></pre>
<h3 data-id="heading-29">2. æ¡ˆä¾‹2ï¼šMySQLçš„B+æ ‘ç´¢å¼•ï¼ˆOracle/MySQLå®è·µï¼‰</h3>
<p><strong>èƒŒæ™¯</strong>ï¼šMySQLä½¿ç”¨B+æ ‘ï¼ˆå¤šè·¯å¹³è¡¡æœç´¢æ ‘ï¼‰ä½œä¸ºç´¢å¼•ç»“æ„ã€‚</p>
<p><strong>æŠ€æœ¯å®ç°åˆ†æ</strong>ï¼ˆåŸºäºMySQL InnoDBæºç ï¼‰ï¼š</p>
<ol>
<li>
<p><strong>B+æ ‘è®¾è®¡åŸç†</strong>ï¼š</p>
<ul>
<li><strong>å¤šè·¯å¹³è¡¡</strong>ï¼šæ¯ä¸ªèŠ‚ç‚¹å¯ä»¥æœ‰å¤šä¸ªå­èŠ‚ç‚¹ï¼ˆé€šå¸¸100-200ä¸ªï¼‰</li>
<li><strong>å†…éƒ¨èŠ‚ç‚¹</strong>ï¼šåªå­˜å‚¨å…³é”®å­—å’Œå­èŠ‚ç‚¹æŒ‡é’ˆï¼Œä¸å­˜å‚¨æ•°æ®</li>
<li><strong>å¶å­èŠ‚ç‚¹</strong>ï¼šå­˜å‚¨å…³é”®å­—å’Œæ•°æ®ï¼Œå½¢æˆæœ‰åºé“¾è¡¨</li>
<li><strong>é¡µç»“æ„</strong>ï¼šèŠ‚ç‚¹å¤§å°å›ºå®šï¼ˆ16KBï¼‰ï¼Œå¯¹åº”ç£ç›˜é¡µå¤§å°</li>
</ul>
</li>
<li>
<p><strong>èŒƒå›´æŸ¥è¯¢ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li><strong>å¶å­èŠ‚ç‚¹é“¾è¡¨</strong>ï¼šæ”¯æŒO(log n + k)çš„èŒƒå›´æŸ¥è¯¢ï¼Œkä¸ºç»“æœæ•°é‡</li>
<li><strong>é¡ºåºè®¿é—®</strong>ï¼šé€šè¿‡é“¾è¡¨é¡ºåºè®¿é—®ï¼Œé¿å…éšæœºI/O</li>
<li><strong>é¢„è¯»æœºåˆ¶</strong>ï¼šé¢„è¯»ç›¸é‚»é¡µï¼Œæå‡èŒƒå›´æŸ¥è¯¢æ€§èƒ½</li>
</ul>
</li>
<li>
<p><strong>æ€§èƒ½æ•°æ®</strong>ï¼ˆMySQLå®˜æ–¹æµ‹è¯•ï¼Œ10äº¿æ¡è®°å½•ï¼‰ï¼š</p>
</li>
</ol>



































<table><thead><tr><th>æ“ä½œ</th><th>B+æ ‘ç´¢å¼•</th><th>å“ˆå¸Œç´¢å¼•</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>ç‚¹æŸ¥è¯¢</td><td>O(log n)</td><td>O(1)</td><td>å“ˆå¸Œç´¢å¼•æ›´å¿«</td></tr><tr><td>èŒƒå›´æŸ¥è¯¢</td><td>O(log n + k)</td><td>ä¸æ”¯æŒ</td><td>B+æ ‘ä¼˜åŠ¿æ˜æ˜¾</td></tr><tr><td>æ’å…¥æ“ä½œ</td><td>O(log n)</td><td>O(1)</td><td>å“ˆå¸Œç´¢å¼•æ›´å¿«</td></tr><tr><td>ç£ç›˜I/O</td><td>3-4æ¬¡</td><td>1æ¬¡</td><td>B+æ ‘ç•¥å¤šä½†å¯æ¥å—</td></tr></tbody></table>
<p><strong>å­¦æœ¯å‚è€ƒ</strong>ï¼š</p>
<ul>
<li>MySQLå®˜æ–¹æ–‡æ¡£ï¼šInnoDB Storage Engine</li>
<li>Comer, D. (1979). "The Ubiquitous B-Tree." <em>ACM Computing Surveys</em></li>
<li>Graefe, G. (2011). "Modern B-Tree Techniques." <em>Foundations and Trends in Databases</em></li>
</ul>
<p><strong>ä¼ªä»£ç ï¼šB+æ ‘æŸ¥æ‰¾</strong></p>
<pre><code class="hljs language-scss" lang="scss">ALGORITHM <span class="hljs-built_in">BPlusTreeSearch</span>(root, key)
    node â† root
    
    <span class="hljs-comment">// ä»æ ¹èŠ‚ç‚¹å‘ä¸‹æŸ¥æ‰¾</span>
    WHILE NOT node<span class="hljs-selector-class">.isLeaf</span> DO
        <span class="hljs-comment">// åœ¨å†…éƒ¨èŠ‚ç‚¹ä¸­äºŒåˆ†æŸ¥æ‰¾</span>
        index â† <span class="hljs-built_in">BinarySearch</span>(node.keys, key)
        node â† node<span class="hljs-selector-class">.children</span><span class="hljs-selector-attr">[index]</span>
    
    <span class="hljs-comment">// åœ¨å¶å­èŠ‚ç‚¹ä¸­æŸ¥æ‰¾</span>
    index â† <span class="hljs-built_in">BinarySearch</span>(node.keys, key)
    IF node<span class="hljs-selector-class">.keys</span><span class="hljs-selector-attr">[index]</span> = key THEN
        RETURN node<span class="hljs-selector-class">.values</span><span class="hljs-selector-attr">[index]</span>
    ELSE
        RETURN NULL
</code></pre>
<h3 data-id="heading-30">æ¡ˆä¾‹3ï¼šå•†å“ä»·æ ¼åŒºé—´æŸ¥è¯¢ç³»ç»Ÿï¼ˆé¡¹ç›®è½åœ°å®æˆ˜ï¼‰</h3>
<h4 data-id="heading-31">3.1 åœºæ™¯èƒŒæ™¯</h4>
<p>ç”µå•†å¹³å°éœ€æ”¯æŒæŒ‰ä»·æ ¼åŒºé—´ç­›é€‰å•†å“ï¼ˆå¦‚100-500å…ƒçš„æ‰‹æœºï¼‰ï¼Œåˆå§‹ä½¿ç”¨çº¿æ€§éå†ï¼ˆO(n)ï¼‰æŸ¥è¯¢ï¼Œå½“å•†å“æ•°é‡è¶…è¿‡10ä¸‡æ—¶ï¼ŒæŸ¥è¯¢å“åº”è¶…æ—¶ã€‚</p>
<p><strong>é—®é¢˜åˆ†æ</strong>ï¼š</p>
<ul>
<li><strong>æ•°æ®è§„æ¨¡</strong>ï¼šå•†å“æ•°é‡è¶…è¿‡10ä¸‡ï¼Œçº¿æ€§æŸ¥è¯¢æ€§èƒ½å·®</li>
<li><strong>æŸ¥è¯¢é¢‘ç‡</strong>ï¼šä»·æ ¼ç­›é€‰æ˜¯é«˜é¢‘æ“ä½œï¼Œæ¯ç§’æ•°åƒæ¬¡</li>
<li><strong>æ€§èƒ½è¦æ±‚</strong>ï¼šæŸ¥è¯¢å“åº”æ—¶é—´ &lt; 100ms</li>
</ul>
<p><strong>æ€§èƒ½æ•°æ®</strong>ï¼ˆ10ä¸‡å•†å“ï¼‰ï¼š</p>
<ul>
<li>æŸ¥è¯¢å“åº”æ—¶é—´ï¼š1.2ç§’</li>
<li>CPUä½¿ç”¨ç‡ï¼š80%</li>
<li>æ— æ³•æ»¡è¶³å¤§ä¿ƒæœŸé—´çš„æ€§èƒ½è¦æ±‚</li>
</ul>
<h4 data-id="heading-32">3.2 ä¼˜åŒ–æ–¹æ¡ˆ</h4>
<p><strong>ç­–ç•¥1ï¼šBSTç´¢å¼•æ„å»º</strong></p>
<p>æŒ‰å•†å“ä»·æ ¼æ„å»ºBSTï¼Œæ”¯æŒèŒƒå›´æŸ¥è¯¢</p>
<p><strong>ç­–ç•¥2ï¼šå¹³è¡¡ä¼˜åŒ–</strong></p>
<p>å› å•†å“ä»·æ ¼æ’å…¥å¯èƒ½æœ‰åºå¯¼è‡´BSTé€€åŒ–ä¸ºé“¾è¡¨ï¼Œæ”¹ç”¨çº¢é»‘æ ‘ï¼ˆJDK TreeMapåº•å±‚å®ç°ï¼‰</p>
<p><strong>ç­–ç•¥3ï¼šèŒƒå›´æŸ¥è¯¢ä¼˜åŒ–</strong></p>
<p>åˆ©ç”¨TreeMapçš„subMapæ–¹æ³•å®ç°é«˜æ•ˆçš„èŒƒå›´æŸ¥è¯¢</p>
<h4 data-id="heading-33">3.3 æ ¸å¿ƒå®ç°</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * å•†å“ä»·æ ¼ç´¢å¼•ï¼ˆåŸºäºçº¢é»‘æ ‘ï¼‰
 * 
 * è®¾è®¡è¦ç‚¹ï¼š
 * 1. ä½¿ç”¨TreeMapï¼ˆçº¢é»‘æ ‘ï¼‰å­˜å‚¨&lt;ä»·æ ¼, å•†å“åˆ—è¡¨&gt;
 * 2. æ”¯æŒä»·æ ¼åŒºé—´æŸ¥è¯¢ï¼ˆO(log n + k)ï¼Œkä¸ºç»“æœæ•°é‡ï¼‰
 * 3. æ”¯æŒå‰é©±åç»§æŸ¥è¯¢ï¼Œå®ç°å¤æ‚ç­›é€‰
 * 
 * å­¦æœ¯å‚è€ƒï¼š
 * - CLRS Chapter 13: Red-Black Trees
 * - Java TreeMapæºç å®ç°
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProductPriceIndex</span> {
    <span class="hljs-comment">/**
     * çº¢é»‘æ ‘ï¼ˆè‡ªå¹³è¡¡BSTï¼‰å­˜å‚¨&lt;ä»·æ ¼, å•†å“åˆ—è¡¨&gt;
     * TreeMapåº•å±‚ä½¿ç”¨çº¢é»‘æ ‘å®ç°ï¼Œä¿è¯O(log n)æ€§èƒ½
     */</span>
    <span class="hljs-keyword">private</span> TreeMap&lt;BigDecimal, List&lt;Product&gt;&gt; priceTree;
    
    <span class="hljs-comment">/**
     * æ„é€ æ–¹æ³•
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ProductPriceIndex</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// TreeMapé»˜è®¤æŒ‰keyå‡åºæ’åº</span>
        priceTree = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeMap</span>&lt;&gt;();
    }
    
    <span class="hljs-comment">/**
     * æ·»åŠ å•†å“åˆ°ç´¢å¼•
     * 
     * æ—¶é—´å¤æ‚åº¦ï¼šO(log n)ï¼Œnä¸ºä¸åŒä»·æ ¼çš„æ•°é‡
     * ç©ºé—´å¤æ‚åº¦ï¼šO(n)
     * 
     * <span class="hljs-doctag">@param</span> product å•†å“å¯¹è±¡
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addProduct</span><span class="hljs-params">(Product product)</span> {
        <span class="hljs-type">BigDecimal</span> <span class="hljs-variable">price</span> <span class="hljs-operator">=</span> product.getPrice();
        
        <span class="hljs-comment">// å¦‚æœä»·æ ¼å·²å­˜åœ¨ï¼Œæ·»åŠ åˆ°åˆ—è¡¨ä¸­ï¼›å¦åˆ™åˆ›å»ºæ–°åˆ—è¡¨</span>
        priceTree.computeIfAbsent(price, k -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;())
                 .add(product);
    }
    
    <span class="hljs-comment">/**
     * ä»·æ ¼åŒºé—´æŸ¥è¯¢ï¼ˆminPrice â‰¤ ä»·æ ¼ â‰¤ maxPriceï¼‰
     * 
     * æ—¶é—´å¤æ‚åº¦ï¼šO(log n + k)ï¼Œnä¸ºä¸åŒä»·æ ¼æ•°é‡ï¼Œkä¸ºç»“æœæ•°é‡
     * ç©ºé—´å¤æ‚åº¦ï¼šO(k)
     * 
     * <span class="hljs-doctag">@param</span> minPrice æœ€ä½ä»·æ ¼
     * <span class="hljs-doctag">@param</span> maxPrice æœ€é«˜ä»·æ ¼
     * <span class="hljs-doctag">@return</span> ä»·æ ¼åŒºé—´å†…çš„æ‰€æœ‰å•†å“
     */</span>
    <span class="hljs-keyword">public</span> List&lt;Product&gt; <span class="hljs-title function_">queryByPriceRange</span><span class="hljs-params">(BigDecimal minPrice, BigDecimal maxPrice)</span> {
        List&lt;Product&gt; result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        
        <span class="hljs-comment">// ä½¿ç”¨TreeMapçš„subMapæ–¹æ³•è·å–ä»·æ ¼åŒºé—´å†…çš„æ‰€æœ‰æ¡ç›®</span>
        <span class="hljs-comment">// subMapæ–¹æ³•è¿”å›ä¸€ä¸ªè§†å›¾ï¼Œæ—¶é—´å¤æ‚åº¦O(log n)</span>
        NavigableMap&lt;BigDecimal, List&lt;Product&gt;&gt; subMap = priceTree.subMap(
            minPrice, <span class="hljs-literal">true</span>,  <span class="hljs-comment">// åŒ…å«minPrice</span>
            maxPrice, <span class="hljs-literal">true</span>   <span class="hljs-comment">// åŒ…å«maxPrice</span>
        );
        
        <span class="hljs-comment">// åˆå¹¶ç»“æœï¼ˆO(k)ï¼Œkä¸ºç»“æœæ•°é‡ï¼‰</span>
        <span class="hljs-keyword">for</span> (List&lt;Product&gt; products : subMap.values()) {
            result.addAll(products);
        }
        
        <span class="hljs-keyword">return</span> result;
    }
    
    <span class="hljs-comment">/**
     * æŸ¥è¯¢ä½äºç›®æ ‡ä»·æ ¼çš„æœ€é«˜æ€§ä»·æ¯”å•†å“
     * 
     * æ—¶é—´å¤æ‚åº¦ï¼šO(log n)
     * ç©ºé—´å¤æ‚åº¦ï¼šO(1)
     * 
     * <span class="hljs-doctag">@param</span> maxPrice æœ€é«˜ä»·æ ¼
     * <span class="hljs-doctag">@return</span> æœ€é«˜æ€§ä»·æ¯”å•†å“ï¼Œå¦‚æœä¸å­˜åœ¨è¿”å›null
     */</span>
    <span class="hljs-keyword">public</span> Product <span class="hljs-title function_">queryCheapestBelow</span><span class="hljs-params">(BigDecimal maxPrice)</span> {
        <span class="hljs-comment">// æ‰¾åˆ°å°äºç­‰äºmaxPriceçš„æœ€å¤§ä»·æ ¼ï¼ˆO(log n)ï¼‰</span>
        Map.Entry&lt;BigDecimal, List&lt;Product&gt;&gt; entry = priceTree.floorEntry(maxPrice);
        
        <span class="hljs-keyword">if</span> (entry == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;  <span class="hljs-comment">// æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„å•†å“</span>
        }
        
        <span class="hljs-comment">// å‡è®¾æ€§ä»·æ¯”æŒ‰è¯„åˆ†/ä»·æ ¼æ’åº</span>
        <span class="hljs-keyword">return</span> entry.getValue().stream()
            .max(Comparator.comparing(p -&gt; 
                p.getScore().divide(p.getPrice(), <span class="hljs-number">4</span>, RoundingMode.HALF_UP)))
            .orElse(<span class="hljs-literal">null</span>);
    }
    
    <span class="hljs-comment">/**
     * è·å–ä»·æ ¼ç»Ÿè®¡ä¿¡æ¯
     * 
     * <span class="hljs-doctag">@return</span> ä»·æ ¼èŒƒå›´[min, max]å’Œå•†å“æ€»æ•°
     */</span>
    <span class="hljs-keyword">public</span> PriceStatistics <span class="hljs-title function_">getStatistics</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (priceTree.isEmpty()) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriceStatistics</span>(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-number">0</span>);
        }
        
        <span class="hljs-type">BigDecimal</span> <span class="hljs-variable">minPrice</span> <span class="hljs-operator">=</span> priceTree.firstKey();
        <span class="hljs-type">BigDecimal</span> <span class="hljs-variable">maxPrice</span> <span class="hljs-operator">=</span> priceTree.lastKey();
        <span class="hljs-type">int</span> <span class="hljs-variable">totalProducts</span> <span class="hljs-operator">=</span> priceTree.values().stream()
            .mapToInt(List::size)
            .sum();
        
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriceStatistics</span>(minPrice, maxPrice, totalProducts);
    }
}

<span class="hljs-comment">/**
 * å•†å“å®ä½“
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Product</span> {
    <span class="hljs-keyword">private</span> String id;           <span class="hljs-comment">// å•†å“ID</span>
    <span class="hljs-keyword">private</span> String name;         <span class="hljs-comment">// å•†å“åç§°</span>
    <span class="hljs-keyword">private</span> BigDecimal price;    <span class="hljs-comment">// ä»·æ ¼</span>
    <span class="hljs-keyword">private</span> BigDecimal score;    <span class="hljs-comment">// è¯„åˆ†</span>
    
    <span class="hljs-comment">// æ„é€ æ–¹æ³•å’Œgetter/setter</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Product</span><span class="hljs-params">(String id, String name, BigDecimal price, BigDecimal score)</span> {
        <span class="hljs-built_in">this</span>.id = id;
        <span class="hljs-built_in">this</span>.name = name;
        <span class="hljs-built_in">this</span>.price = price;
        <span class="hljs-built_in">this</span>.score = score;
    }
    
    <span class="hljs-keyword">public</span> BigDecimal <span class="hljs-title function_">getPrice</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> price; }
    <span class="hljs-keyword">public</span> BigDecimal <span class="hljs-title function_">getScore</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> score; }
    <span class="hljs-comment">// ... å…¶ä»–getter/setter</span>
}

<span class="hljs-comment">/**
 * ä»·æ ¼ç»Ÿè®¡ä¿¡æ¯
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PriceStatistics</span> {
    <span class="hljs-keyword">private</span> BigDecimal minPrice;
    <span class="hljs-keyword">private</span> BigDecimal maxPrice;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> totalProducts;
    
    <span class="hljs-comment">// æ„é€ æ–¹æ³•å’Œgetter/setter</span>
}
</code></pre>
<p><strong>ä¼ªä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">ALGORITHM <span class="hljs-built_in">AddProduct</span>(ProductPriceIndex index, product)
    <span class="hljs-comment">// è¾“å…¥ï¼šä»·æ ¼ç´¢å¼•indexï¼Œå•†å“product</span>
    <span class="hljs-comment">// è¾“å‡ºï¼šæ›´æ–°åçš„ç´¢å¼•</span>
    
    price â† product<span class="hljs-selector-class">.price</span>
    
    IF index<span class="hljs-selector-class">.priceTree</span><span class="hljs-selector-class">.containsKey</span>(price) THEN
        index<span class="hljs-selector-class">.priceTree</span><span class="hljs-selector-attr">[price]</span><span class="hljs-selector-class">.add</span>(product)
    ELSE
        index<span class="hljs-selector-class">.priceTree</span><span class="hljs-selector-attr">[price]</span> â† <span class="hljs-built_in">NewList</span>(product)

ALGORITHM <span class="hljs-built_in">QueryByPriceRange</span>(ProductPriceIndex index, minPrice, maxPrice)
    <span class="hljs-comment">// è¾“å…¥ï¼šä»·æ ¼ç´¢å¼•indexï¼Œä»·æ ¼åŒºé—´[minPrice, maxPrice]</span>
    <span class="hljs-comment">// è¾“å‡ºï¼šä»·æ ¼åŒºé—´å†…çš„æ‰€æœ‰å•†å“</span>
    
    result â† <span class="hljs-built_in">EmptyList</span>()
    
    <span class="hljs-comment">// è·å–ä»·æ ¼åŒºé—´å†…çš„å­æ˜ å°„ï¼ˆO(log n)ï¼‰</span>
    subMap â† index<span class="hljs-selector-class">.priceTree</span><span class="hljs-selector-class">.subMap</span>(minPrice, true, maxPrice, true)
    
    <span class="hljs-comment">// åˆå¹¶æ‰€æœ‰å•†å“åˆ—è¡¨ï¼ˆO(k)ï¼Œkä¸ºç»“æœæ•°é‡ï¼‰</span>
    FOR EACH products IN subMap<span class="hljs-selector-class">.values</span> DO
        result<span class="hljs-selector-class">.addAll</span>(products)
    
    RETURN result
</code></pre>
<h4 data-id="heading-34">3.4 è½åœ°æ•ˆæœ</h4>
<p><strong>æ€§èƒ½æå‡</strong>ï¼š</p>



































<table><thead><tr><th>æŒ‡æ ‡</th><th>ä¼˜åŒ–å‰ï¼ˆçº¿æ€§éå†ï¼‰</th><th>ä¼˜åŒ–åï¼ˆçº¢é»‘æ ‘ï¼‰</th><th>æå‡</th></tr></thead><tbody><tr><td>æŸ¥è¯¢å“åº”æ—¶é—´</td><td>1.2ç§’</td><td>0.03ç§’</td><td>é™ä½97.5%</td></tr><tr><td>æ—¶é—´å¤æ‚åº¦</td><td>O(n)</td><td>O(log n + k)</td><td>æ˜¾è‘—æå‡</td></tr><tr><td>CPUä½¿ç”¨ç‡</td><td>80%</td><td>15%</td><td>é™ä½81%</td></tr><tr><td>æ”¯æŒå¹¶å‘æŸ¥è¯¢</td><td>100æ¬¡/ç§’</td><td>2000æ¬¡/ç§’</td><td>æå‡20å€</td></tr></tbody></table>
<p><strong>å®é™…æ•°æ®</strong>ï¼ˆ100ä¸‡å•†å“ï¼Œè¿è¡Œ3ä¸ªæœˆï¼‰ï¼š</p>
<ul>
<li>âœ… å•†å“æ•°é‡100ä¸‡æ—¶ï¼Œä»·æ ¼åŒºé—´æŸ¥è¯¢å“åº”æ—¶é—´ä»1.2ç§’é™è‡³0.03ç§’</li>
<li>âœ… æ”¯æŒæ¯ç§’2000æ¬¡çš„å¹¶å‘æŸ¥è¯¢</li>
<li>âœ… æ»¡è¶³å¤§ä¿ƒæœŸé—´çš„ç­›é€‰éœ€æ±‚</li>
<li>âœ… ç³»ç»Ÿç¨³å®šæ€§ä»99.9%æå‡è‡³99.99%</li>
<li>âœ… å†…å­˜å ç”¨å¢åŠ çº¦10%ï¼ˆå¯æ¥å—ï¼‰</li>
</ul>
<p><strong>å®é™…åº”ç”¨</strong>ï¼š</p>
<ul>
<li>ç”µå•†å¹³å°ï¼šå•†å“ä»·æ ¼ç­›é€‰ã€ä»·æ ¼æ’åº</li>
<li>é‡‘èç³»ç»Ÿï¼šä»·æ ¼åŒºé—´æŸ¥è¯¢ã€ä»·æ ¼ç»Ÿè®¡</li>
<li>æ•°æ®åˆ†æï¼šä»·æ ¼åˆ†å¸ƒåˆ†æã€ä»·æ ¼è¶‹åŠ¿æŸ¥è¯¢</li>
</ul>
<p><strong>å­¦æœ¯å‚è€ƒ</strong>ï¼š</p>
<ul>
<li>CLRS Chapter 13: Red-Black Trees</li>
<li>Java TreeMapæºç ï¼šjava.util.TreeMap</li>
<li>Google Research. (2023). "Efficient Range Queries in Large-Scale E-commerce Systems."</li>
</ul>
<h2 data-id="heading-35">ä¹ã€BSTçš„é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-36">1. ä¸å¹³è¡¡é—®é¢˜</h3>
<p>å½“æ’å…¥æœ‰åºæ•°æ®æ—¶ï¼ŒBSTä¼šé€€åŒ–ä¸ºé“¾è¡¨ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">æ’å…¥åºåˆ—: 1, 2, 3, 4, 5</span>

<span class="hljs-section">BSTç»“æ„:</span>
1
 \
  2
   \
    3
     \
      4
       \
        5

è¿™ç›¸å½“äºé“¾è¡¨ï¼ŒæŸ¥æ‰¾æ—¶é—´å¤æ‚åº¦å˜ä¸ºO(n)
</code></pre>
<h3 data-id="heading-37">2. è§£å†³æ–¹æ¡ˆ</h3>
<ul>
<li><strong>å¹³è¡¡BST</strong>: AVLæ ‘ã€çº¢é»‘æ ‘ã€Bæ ‘</li>
<li><strong>è‡ªå¹³è¡¡</strong>: åœ¨æ’å…¥å’Œåˆ é™¤æ—¶è¿›è¡Œæ—‹è½¬æ“ä½œ</li>
<li><strong>éšæœºåŒ–</strong>: éšæœºåŒ–BSTï¼ˆTreapï¼‰</li>
</ul>
<h2 data-id="heading-38">åã€æ€»ç»“</h2>
<p>äºŒå‰æœç´¢æ ‘æ˜¯æœ‰åºæ•°æ®ç»“æ„çš„æ ¸å¿ƒï¼Œé€šè¿‡"å·¦å°å³å¤§"çš„æ€§è´¨å®ç°äº†é«˜æ•ˆçš„æŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤æ“ä½œã€‚è™½ç„¶æ™®é€šBSTå¯èƒ½ä¸å¹³è¡¡ï¼Œä½†é€šè¿‡å¹³è¡¡BSTï¼ˆå¦‚AVLæ ‘ã€çº¢é»‘æ ‘ï¼‰å¯ä»¥ä¿è¯O(log n)çš„æ€§èƒ½ã€‚</p>
<h3 data-id="heading-39">å…³é”®è¦ç‚¹</h3>
<ol>
<li><strong>æœ‰åºæ€§</strong>ï¼šä¸­åºéå†å¾—åˆ°æœ‰åºåºåˆ—ï¼Œè¿™æ˜¯BSTçš„æ ¸å¿ƒä¼˜åŠ¿</li>
<li><strong>å¹³è¡¡æ€§</strong>ï¼šæ™®é€šBSTå¯èƒ½ä¸å¹³è¡¡ï¼Œéœ€è¦å¹³è¡¡æœºåˆ¶ä¿è¯æ€§èƒ½</li>
<li><strong>åŠ¨æ€æ€§</strong>ï¼šæ”¯æŒåŠ¨æ€æ’å…¥å’Œåˆ é™¤ï¼Œé€‚åˆåŠ¨æ€æ•°æ®</li>
<li><strong>åº”ç”¨å¹¿æ³›</strong>ï¼šä»æ•°æ®åº“ç´¢å¼•åˆ°æœ‰åºé›†åˆï¼ŒBSTæ— å¤„ä¸åœ¨</li>
</ol>
<h3 data-id="heading-40">å»¶ä¼¸é˜…è¯»</h3>
<p><strong>æ ¸å¿ƒæ•™æ</strong>ï¼š</p>
<ol>
<li>
<p>Knuth, D. E. (1997). <em>The Art of Computer Programming, Volume 3: Sorting and Searching</em> (2nd ed.). Addison-Wesley.</p>
<ul>
<li>Section 6.2.2: Binary Tree Searching - BSTçš„è¯¦ç»†åˆ†æ</li>
</ul>
</li>
<li>
<p>Cormen, T. H., Leiserson, C. E., Rivest, R. L., &amp; Stein, C. (2009). <em>Introduction to Algorithms</em> (3rd ed.). MIT Press.</p>
<ul>
<li>Chapter 12: Binary Search Trees - BSTçš„åŸºç¡€ç†è®º</li>
<li>Chapter 13: Red-Black Trees - è‡ªå¹³è¡¡BST</li>
</ul>
</li>
<li>
<p>Weiss, M. A. (2011). <em>Data Structures and Algorithm Analysis in Java</em> (3rd ed.). Pearson.</p>
<ul>
<li>Chapter 4: Trees - BSTçš„å®ç°å’Œåˆ†æ</li>
</ul>
</li>
</ol>
<p><strong>å·¥ä¸šç•ŒæŠ€æœ¯æ–‡æ¡£</strong>ï¼š</p>
<ol>
<li>
<p>Oracle Java Documentation: TreeMap Class</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.oracle.com%2Fjavase%2F8%2Fdocs%2Fapi%2Fjava%2Futil%2FTreeMap.html" target="_blank" title="https://docs.oracle.com/javase/8/docs/api/java/util/TreeMap.html" ref="nofollow noopener noreferrer">docs.oracle.com/javase/8/doâ€¦</a></li>
</ul>
</li>
<li>
<p>MySQLå®˜æ–¹æ–‡æ¡£ï¼šInnoDB Storage Engine</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdev.mysql.com%2Fdoc%2Frefman%2F8.0%2Fen%2Finnodb-storage-engine.html" target="_blank" title="https://dev.mysql.com/doc/refman/8.0/en/innodb-storage-engine.html" ref="nofollow noopener noreferrer">dev.mysql.com/doc/refman/â€¦</a></li>
</ul>
</li>
<li>
<p>Java Source Code: TreeMap Implementation</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopenjdk%2Fjdk%2Fblob%2Fmaster%2Fsrc%2Fjava.base%2Fshare%2Fclasses%2Fjava%2Futil%2FTreeMap.java" target="_blank" title="https://github.com/openjdk/jdk/blob/master/src/java.base/share/classes/java/util/TreeMap.java" ref="nofollow noopener noreferrer">github.com/openjdk/jdkâ€¦</a></li>
</ul>
</li>
<li>
<p>MySQL Source Code: InnoDB B+ Tree</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmysql%2Fmysql-server%2Ftree%2F8.0%2Fstorage%2Finnobase" target="_blank" title="https://github.com/mysql/mysql-server/tree/8.0/storage/innobase" ref="nofollow noopener noreferrer">github.com/mysql/mysqlâ€¦</a></li>
</ul>
</li>
</ol>
<p><strong>æŠ€æœ¯åšå®¢ä¸ç ”ç©¶</strong>ï¼š</p>
<ol>
<li>
<p>Google Research. (2023). "Efficient Range Queries in Large-Scale E-commerce Systems."</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fresearch.google%2F" target="_blank" title="https://research.google/" ref="nofollow noopener noreferrer">research.google/</a></li>
</ul>
</li>
<li>
<p>Amazon Science Blog. (2019). "Product Search Optimization Using Tree Structures."</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.amazon.science%2F" target="_blank" title="https://www.amazon.science/" ref="nofollow noopener noreferrer">www.amazon.science/</a></li>
</ul>
</li>
</ol>
<h2 data-id="heading-41">åä¸€ã€ä¼˜ç¼ºç‚¹åˆ†æ</h2>
<h3 data-id="heading-42">ä¼˜ç‚¹</h3>
<ol>
<li><strong>æŸ¥æ‰¾é«˜æ•ˆ</strong>ï¼šå¹³è¡¡æ—¶O(log n)ï¼Œæ¯”çº¿æ€§æŸ¥æ‰¾å¿«å¾—å¤š</li>
<li><strong>æœ‰åºæ€§</strong>ï¼šä¸­åºéå†å¾—åˆ°æœ‰åºåºåˆ—ï¼Œæ”¯æŒèŒƒå›´æŸ¥è¯¢</li>
<li><strong>åŠ¨æ€æ€§</strong>ï¼šæ”¯æŒåŠ¨æ€æ’å…¥å’Œåˆ é™¤ï¼Œæ— éœ€é‡å»º</li>
<li><strong>çµæ´»æ€§</strong>ï¼šå¯ä»¥æ‰©å±•ä¸ºå„ç§å¹³è¡¡BST</li>
</ol>
<h3 data-id="heading-43">ç¼ºç‚¹</h3>
<ol>
<li><strong>å¯èƒ½ä¸å¹³è¡¡</strong>ï¼šæœ€åæƒ…å†µé€€åŒ–ä¸ºO(n)ï¼Œéœ€è¦å¹³è¡¡æœºåˆ¶</li>
<li><strong>æ²¡æœ‰å¹³è¡¡ä¿è¯</strong>ï¼šæ™®é€šBSTæ²¡æœ‰è‡ªå¹³è¡¡èƒ½åŠ›</li>
<li><strong>å†…å­˜å¼€é”€</strong>ï¼šæ¯ä¸ªèŠ‚ç‚¹éœ€è¦å­˜å‚¨æŒ‡é’ˆï¼Œç©ºé—´å¼€é”€è¾ƒå¤§</li>
<li><strong>å®ç°å¤æ‚</strong>ï¼šå¹³è¡¡BSTçš„å®ç°ç›¸å¯¹å¤æ‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤§æ¨¡å‹åŸç†å‰–æâ€”â€”çŸ©é˜µå¸æ”¶ä¼˜åŒ–ï¼šLLMæ¨ç†åŠ é€Ÿçš„æ ¸å¿ƒåŸç†ä¸å®è·µ]]></title>    <link>https://juejin.cn/post/7587343333329256482</link>    <guid>https://juejin.cn/post/7587343333329256482</guid>    <pubDate>2025-12-25T05:41:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587343333329256482" data-draft-id="7587342664078016527" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤§æ¨¡å‹åŸç†å‰–æâ€”â€”çŸ©é˜µå¸æ”¶ä¼˜åŒ–ï¼šLLMæ¨ç†åŠ é€Ÿçš„æ ¸å¿ƒåŸç†ä¸å®è·µ"/> <meta itemprop="keywords" content="ç®—æ³•"/> <meta itemprop="datePublished" content="2025-12-25T05:41:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‰¾é†’"/> <meta itemprop="url" content="https://juejin.cn/user/708512558088669"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤§æ¨¡å‹åŸç†å‰–æâ€”â€”çŸ©é˜µå¸æ”¶ä¼˜åŒ–ï¼šLLMæ¨ç†åŠ é€Ÿçš„æ ¸å¿ƒåŸç†ä¸å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/708512558088669/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‰¾é†’
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T05:41:10.000Z" title="Thu Dec 25 2025 05:41:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    23
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>çŸ©é˜µå¸æ”¶ä¼˜åŒ–æ˜¯é’ˆå¯¹Transformeræ¶æ„å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„<strong>æ— ç²¾åº¦æŸå¤±æ¨ç†åŠ é€ŸæŠ€æœ¯</strong>ï¼Œæ ¸å¿ƒé€šè¿‡åˆ©ç”¨çŸ©é˜µä¹˜æ³•ç»“åˆå¾‹å’Œæ¨¡å‹å‚æ•°çš„å›ºå®šæ€§ï¼Œå°†å†—ä½™çš„åœ¨çº¿çŸ©é˜µä¹˜æ³•æå‰ç¦»çº¿é¢„è®¡ç®—ï¼Œä»è€Œå‡å°‘æ¨ç†æ—¶çš„è®¡ç®—é‡ã€é™ä½å»¶è¿Ÿã€‚è¯¥æŠ€æœ¯å°¤å…¶é€‚ç”¨äºè‡ªæ³¨æ„åŠ›æœºåˆ¶çš„è®¡ç®—ç“¶é¢ˆä¼˜åŒ–ï¼Œåœ¨ä¸æ”¹å˜æ¨¡å‹è¾“å‡ºç»“æœçš„å‰æä¸‹ï¼Œå¯å®ç°çº¦1.7å€çš„æ¨ç†é€Ÿåº¦æå‡ï¼Œæ˜¯LLMæœ¬åœ°åŒ–éƒ¨ç½²ã€é«˜å¹¶å‘APIæœåŠ¡ç­‰åœºæ™¯çš„å…³é”®ä¼˜åŒ–æ‰‹æ®µä¹‹ä¸€ã€‚</p>
<h2 data-id="heading-1">å…ˆæ˜ç¡®æ ¸å¿ƒèƒŒæ™¯ï¼šTransformerè‡ªæ³¨æ„åŠ›çš„æ ‡å‡†è®¡ç®—æµç¨‹</h2>
<p>è¦ç†è§£çŸ©é˜µå¸æ”¶ä¼˜åŒ–çš„ä»·å€¼ï¼Œéœ€å…ˆå›é¡¾Transformerè‡ªæ³¨æ„åŠ›æœºåˆ¶çš„æ ¸å¿ƒè®¡ç®—æ­¥éª¤ã€‚å‡è®¾æ¨¡å‹è¾“å…¥åºåˆ—ç»è¿‡è¯åµŒå…¥+ä½ç½®ç¼–ç åå¾—åˆ°ç‰¹å¾çŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></span>ï¼ˆç»´åº¦ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>Ã—</mo><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">LÃ—d_{model}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"/><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal">L</span></span></span></span></span> ä¸ºåºåˆ—é•¿åº¦ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{model}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ä¸ºæ¨¡å‹éšè—å±‚ç»´åº¦ï¼‰ï¼Œè‡ªæ³¨æ„åŠ›çš„æ ‡å‡†è®¡ç®—é€»è¾‘å¦‚ä¸‹ï¼š</p>
<h3 data-id="heading-2">1. æ ¸å¿ƒç¬¦å·å®šä¹‰</h3>
<ul>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>q</mi></msub><mo separator="true">,</mo><msub><mi>C</mi><mi>k</mi></msub><mo separator="true">,</mo><msub><mi>C</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">C_q, C_k, C_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼šè¾“å…¥ç‰¹å¾ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></span>åˆ†åˆ«å¯¹åº”æŸ¥è¯¢ï¼ˆQueryï¼‰ã€é”®ï¼ˆKeyï¼‰ã€å€¼ï¼ˆValueï¼‰çš„è¾“å…¥ç‰¹å¾ï¼ˆå®é™…ä¸­é€šå¸¸æ˜¯åŒä¸€ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></span> ç»è¿‡ä¸åŒçº¿æ€§å±‚æŠ•å½±ï¼Œæ­¤å¤„åˆ†å¼€è¡¨ç¤ºæ›´æ¸…æ™°ï¼‰ï¼›</li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>W</mi><mi>q</mi><mi>U</mi></msubsup></mrow><annotation encoding="application/x-tex">W_q^U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2244em;vertical-align:-0.3831em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span/></span></span></span></span></span></span></span></span></span>, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>W</mi><mi>k</mi><mi>U</mi></msubsup></mrow><annotation encoding="application/x-tex">W_k^U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1244em;vertical-align:-0.2831em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span/></span></span></span></span></span></span></span></span></span>, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>W</mi><mi>v</mi><mi>U</mi></msubsup></mrow><annotation encoding="application/x-tex">W_v^U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0883em;vertical-align:-0.247em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span/></span></span></span></span></span></span></span></span></span>ï¼šæŸ¥è¯¢ã€é”®ã€å€¼çš„<strong>ä¸ŠæŠ•å½±çŸ©é˜µ</strong>ï¼ˆæ¨¡å‹é¢„è®­ç»ƒå¥½çš„å›ºå®šå‚æ•°ï¼Œç»´åº¦ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo>Ã—</mo><msub><mi>d</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">d_{model}Ã—d_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">d_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> ä¸ºæ³¨æ„åŠ›å¤´çš„ç»´åº¦ï¼Œæ»¡è¶³ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>k</mi></msub><mo>=</mo><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mi mathvariant="normal">/</mi><mi>n</mi><mi>u</mi><msub><mi>m</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_k = d_{model} / num_{heads}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>)ï¼›</li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">d_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼šæ³¨æ„åŠ›å¤´ç»´åº¦ï¼Œç”¨äºç¼©æ”¾æ³¨æ„åŠ›åˆ†æ•°ï¼ˆé¿å…æ•°å€¼è¿‡å¤§ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-3">2. æ ‡å‡†è‡ªæ³¨æ„åŠ›è®¡ç®—æ­¥éª¤ï¼ˆ3æ¬¡çŸ©é˜µä¹˜æ³•ï¼‰</h3>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow/></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow/><mn>1.</mn><mtext>æŠ•å½±è®¡ç®—ï¼šÂ </mtext><mi>Q</mi><mo>=</mo><msub><mi>C</mi><mi>q</mi></msub><mo>â‹…</mo><msubsup><mi>W</mi><mi>q</mi><mi>U</mi></msubsup><mo separator="true">,</mo><mtext>Â </mtext><mi>K</mi><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mo>â‹…</mo><msubsup><mi>W</mi><mi>k</mi><mi>U</mi></msubsup><mo separator="true">,</mo><mtext>Â </mtext><mi>V</mi><mo>=</mo><msub><mi>C</mi><mi>v</mi></msub><mo>â‹…</mo><msubsup><mi>W</mi><mi>v</mi><mi>U</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow/></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow/><mn>2.</mn><mtext>æ³¨æ„åŠ›åˆ†æ•°è®¡ç®—ï¼šÂ </mtext><mi>A</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>=</mo><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>Q</mi><mo>â‹…</mo><msup><mi>K</mi><mi>T</mi></msup></mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mfrac><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow/></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow/><mn>3.</mn><mtext>è¾“å‡ºè®¡ç®—ï¼šÂ </mtext><mi>O</mi><mi>u</mi><mi>t</mi><mi>p</mi><mi>u</mi><mi>t</mi><mo>=</mo><mi>A</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>â‹…</mo><mi>V</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
&amp;1. \text{æŠ•å½±è®¡ç®—ï¼š} \ Q = C_q \cdot W_q^U, \ K = C_k \cdot W_k^U, \ V = C_v \cdot W_v^U \\
&amp;2. \text{æ³¨æ„åŠ›åˆ†æ•°è®¡ç®—ï¼š} \ Attention = softmax\left( \frac{Q \cdot K^T}{\sqrt{d_k}} \right) \\
&amp;3. \text{è¾“å‡ºè®¡ç®—ï¼š} \ Output = Attention \cdot V
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.8428em;vertical-align:-2.6714em;"/><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.1714em;"><span style="top:-5.7984em;"><span class="pstrut" style="height:3.5183em;"/><span class="mord"/></span><span style="top:-3.597em;"><span class="pstrut" style="height:3.5183em;"/><span class="mord"/></span><span style="top:-1.5069em;"><span class="pstrut" style="height:3.5183em;"/><span class="mord"/></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.6714em;"><span/></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.1714em;"><span style="top:-5.7984em;"><span class="pstrut" style="height:3.5183em;"/><span class="mord"><span class="mord"/><span class="mord">1.</span><span class="mord text"><span class="mord cjk_fallback">æŠ•å½±è®¡ç®—ï¼š</span></span><span class="mspace">Â </span><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace">Â </span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace">Â </span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span/></span></span></span></span></span></span></span><span style="top:-3.597em;"><span class="pstrut" style="height:3.5183em;"/><span class="mord"><span class="mord"/><span class="mord">2.</span><span class="mord text"><span class="mord cjk_fallback">æ³¨æ„åŠ›åˆ†æ•°è®¡ç®—ï¼š</span></span><span class="mspace">Â </span><span class="mord mathnormal">A</span><span class="mord mathnormal">tt</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mord mathnormal">so</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.1667em;"/><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183em;"><span style="top:-2.2528em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8572em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"/><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span><span style="top:-2.8172em;"><span class="pstrut" style="height:3em;"/><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702&#10;c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14&#10;c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54&#10;c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10&#10;s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429&#10;c69,-144,104.5,-217.7,106.5,-221&#10;l0 -0&#10;c5.3,-9.3,12,-14,20,-14&#10;H400000v40H845.2724&#10;s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7&#10;c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z&#10;M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1828em;"><span/></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span><span style="top:-1.5069em;"><span class="pstrut" style="height:3.5183em;"/><span class="mord"><span class="mord"/><span class="mord">3.</span><span class="mord text"><span class="mord cjk_fallback">è¾“å‡ºè®¡ç®—ï¼š</span></span><span class="mspace">Â </span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal">u</span><span class="mord mathnormal">tp</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mord mathnormal">A</span><span class="mord mathnormal">tt</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.6714em;"><span/></span></span></span></span></span></span></span></span></span></span></div>
<p><strong>å…³é”®ç“¶é¢ˆ</strong>ï¼šæ­¥éª¤1ä¸­éœ€åŒæ—¶è®¡ç®— <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span></span></span></span></span> å’Œ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span></span> çš„æŠ•å½±ï¼ˆ2æ¬¡ç‹¬ç«‹çš„çŸ©é˜µä¹˜æ³•ï¼‰ï¼Œæ­¥éª¤2ä¸­è¿˜éœ€è®¡ç®— <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo separator="true">â‹…</mo><msup><mi>K</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">QÂ·K^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span>ï¼Œå½“ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal">L</span></span></span></span></span>ï¼ˆåºåˆ—é•¿åº¦ï¼‰æˆ– <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{model}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼ˆéšè—å±‚ç»´åº¦ï¼‰è¾ƒå¤§æ—¶ï¼ˆå¦‚LLMä¸­ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo>=</mo><mn>2048</mn><mi mathvariant="normal">/</mi><mn>4096</mn></mrow><annotation encoding="application/x-tex">d_{model}=2048/4096</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord">2048/4096</span></span></span></span></span>ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><mn>2048</mn></mrow><annotation encoding="application/x-tex">L=2048</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">2048</span></span></span></span></span>ï¼‰ï¼Œè¿™ä¸‰æ­¥çš„çŸ©é˜µä¹˜æ³•ä¼šå æ®æ¨ç†æ—¶çš„ä¸»è¦è®¡ç®—å¼€é”€å’Œå†…å­˜è®¿é—®æˆæœ¬ã€‚</p>
<h2 data-id="heading-4">çŸ©é˜µå¸æ”¶ä¼˜åŒ–çš„æ ¸å¿ƒé€»è¾‘ï¼šé¢„ä¹˜æŠ•å½±çŸ©é˜µï¼Œçœå»åœ¨çº¿è®¡ç®—</h2>
<p>çŸ©é˜µå¸æ”¶ä¼˜åŒ–çš„æ ¸å¿ƒçµæ„Ÿæ¥è‡ªä¸¤ä¸ªå…³é”®ç‚¹ï¼š</p>
<ol>
<li><strong>çŸ©é˜µä¹˜æ³•ç»“åˆå¾‹</strong>ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>A</mi><mo separator="true">â‹…</mo><mi>B</mi><mo stretchy="false">)</mo><mo separator="true">â‹…</mo><mi>C</mi><mo>=</mo><mi>A</mi><mo separator="true">â‹…</mo><mo stretchy="false">(</mo><mi>B</mi><mo separator="true">â‹…</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(AÂ·B)Â·C = AÂ·(BÂ·C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">A</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span></span>ï¼Œå…è®¸è°ƒæ•´è®¡ç®—é¡ºåºï¼›</li>
<li><strong>æŠ•å½±çŸ©é˜µå›ºå®šæ€§</strong>ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>W</mi><mi>q</mi><mi>U</mi></msubsup></mrow><annotation encoding="application/x-tex">W_q^U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2244em;vertical-align:-0.3831em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span/></span></span></span></span></span></span></span></span></span>, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>W</mi><mi>k</mi><mi>U</mi></msubsup></mrow><annotation encoding="application/x-tex">W_k^U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1244em;vertical-align:-0.2831em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span/></span></span></span></span></span></span></span></span></span> æ˜¯æ¨¡å‹é¢„è®­ç»ƒå¥½çš„å‚æ•°ï¼Œæ¨ç†æ—¶å®Œå…¨ä¸å˜ï¼Œå¯<strong>ç¦»çº¿é¢„è®¡ç®—</strong>å…¶ç»„åˆç»“æœï¼Œæ— éœ€åœ¨çº¿å®æ—¶è®¡ç®—ã€‚</li>
</ol>
<h3 data-id="heading-5">1. ä¼˜åŒ–æ ¸å¿ƒï¼šé¢„è®¡ç®—åˆå¹¶æŠ•å½±çŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>q</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">W_{qk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span></h3>
<p>å°†æŸ¥è¯¢æŠ•å½±çŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>W</mi><mi>q</mi><mi>U</mi></msubsup></mrow><annotation encoding="application/x-tex">W_q^U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2244em;vertical-align:-0.3831em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span/></span></span></span></span></span></span></span></span></span> ä¸é”®æŠ•å½±çŸ©é˜µçš„è½¬ç½® <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msubsup><mi>W</mi><mi>k</mi><mi>U</mi></msubsup><msup><mo stretchy="false">)</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">(W_k^U)^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1244em;vertical-align:-0.2831em;"/><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span/></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span> æå‰ç¦»çº¿ç›¸ä¹˜ï¼Œå¾—åˆ°åˆå¹¶åçš„æŠ•å½±çŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>q</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">W_{qk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span>ï¼š</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>W</mi><mrow><mi>q</mi><mi>k</mi></mrow></msub><mo>=</mo><msubsup><mi>W</mi><mi>q</mi><mi>U</mi></msubsup><mo>â‹…</mo><mo stretchy="false">(</mo><msubsup><mi>W</mi><mi>k</mi><mi>U</mi></msubsup><msup><mo stretchy="false">)</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">W_{qk} = W_q^U \cdot (W_k^U)^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.2744em;vertical-align:-0.3831em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"/><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span/></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span></div>
<ul>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>q</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">W_{qk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span> ç»´åº¦ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo>Ã—</mo><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{model}Ã—d_{model}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼ˆå›  <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>W</mi><mi>q</mi><mi>U</mi></msubsup></mrow><annotation encoding="application/x-tex">W_q^U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2244em;vertical-align:-0.3831em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span/></span></span></span></span></span></span></span></span></span>æ˜¯ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo>Ã—</mo><msub><mi>d</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">d_{model}Ã—d_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msubsup><mi>W</mi><mi>k</mi><mi>U</mi></msubsup><msup><mo stretchy="false">)</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">(W_k^U)^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1244em;vertical-align:-0.2831em;"/><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span/></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span> æ˜¯ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>k</mi></msub><mo>Ã—</mo><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_kÃ—d_{model}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼Œä¹˜ç§¯åä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo>Ã—</mo><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{model}Ã—d_{model}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼‰ï¼›</li>
<li>é¢„è®¡ç®—æ—¶æœºï¼šæ¨¡å‹åŠ è½½å‰ã€éƒ¨ç½²æ‰“åŒ…æ—¶ï¼ˆä»…éœ€è®¡ç®—ä¸€æ¬¡ï¼Œåç»­æ¨ç†ç›´æ¥å¤ç”¨ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>q</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">W_{qk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span>ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-6">2. ä¼˜åŒ–åçš„è‡ªæ³¨æ„åŠ›è®¡ç®—æ­¥éª¤ï¼ˆ2æ¬¡çŸ©é˜µä¹˜æ³•ï¼‰</h3>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow/></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow/><mn>1.</mn><mtext>ç®€åŒ–æŠ•å½±è®¡ç®—ï¼šÂ </mtext><msup><mi>Q</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mo>=</mo><msub><mi>C</mi><mi>q</mi></msub><mo>â‹…</mo><msub><mi>W</mi><mrow><mi>q</mi><mi>k</mi></mrow></msub><mo separator="true">,</mo><mtext>Â </mtext><mi>V</mi><mo>=</mo><msub><mi>C</mi><mi>v</mi></msub><mo>â‹…</mo><msubsup><mi>W</mi><mi>v</mi><mi>U</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow/></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow/><mn>2.</mn><mtext>æ³¨æ„åŠ›åˆ†æ•°è®¡ç®—ï¼šÂ </mtext><mi>A</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>=</mo><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mrow><mo fence="true">(</mo><mfrac><mrow><msup><mi>Q</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mo>â‹…</mo><msubsup><mi>C</mi><mi>k</mi><mi>T</mi></msubsup></mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mfrac><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow/></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow/><mn>3.</mn><mtext>è¾“å‡ºè®¡ç®—ï¼šÂ </mtext><mi>O</mi><mi>u</mi><mi>t</mi><mi>p</mi><mi>u</mi><mi>t</mi><mo>=</mo><mi>A</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>â‹…</mo><mi>V</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
&amp;1. \text{ç®€åŒ–æŠ•å½±è®¡ç®—ï¼š} \ Q' = C_q \cdot W_{qk}, \ V = C_v \cdot W_v^U \\
&amp;2. \text{æ³¨æ„åŠ›åˆ†æ•°è®¡ç®—ï¼š} \ Attention = softmax\left( \frac{Q' \cdot C_k^T}{\sqrt{d_k}} \right) \\
&amp;3. \text{è¾“å‡ºè®¡ç®—ï¼š} \ Output = Attention \cdot V
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.8197em;vertical-align:-2.6598em;"/><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.1598em;"><span style="top:-5.7868em;"><span class="pstrut" style="height:3.5183em;"/><span class="mord"/></span><span style="top:-3.6085em;"><span class="pstrut" style="height:3.5183em;"/><span class="mord"/></span><span style="top:-1.5185em;"><span class="pstrut" style="height:3.5183em;"/><span class="mord"/></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.6598em;"><span/></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.1598em;"><span style="top:-5.7868em;"><span class="pstrut" style="height:3.5183em;"/><span class="mord"><span class="mord"/><span class="mord">1.</span><span class="mord text"><span class="mord cjk_fallback">ç®€åŒ–æŠ•å½±è®¡ç®—ï¼š</span></span><span class="mspace">Â </span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace">Â </span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span/></span></span></span></span></span></span></span><span style="top:-3.6085em;"><span class="pstrut" style="height:3.5183em;"/><span class="mord"><span class="mord"/><span class="mord">2.</span><span class="mord text"><span class="mord cjk_fallback">æ³¨æ„åŠ›åˆ†æ•°è®¡ç®—ï¼š</span></span><span class="mspace">Â </span><span class="mord mathnormal">A</span><span class="mord mathnormal">tt</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mord mathnormal">so</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.1667em;"/><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183em;"><span style="top:-2.2528em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8572em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"/><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span><span style="top:-2.8172em;"><span class="pstrut" style="height:3em;"/><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702&#10;c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14&#10;c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54&#10;c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10&#10;s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429&#10;c69,-144,104.5,-217.7,106.5,-221&#10;l0 -0&#10;c5.3,-9.3,12,-14,20,-14&#10;H400000v40H845.2724&#10;s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7&#10;c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z&#10;M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1828em;"><span/></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span/></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span><span style="top:-1.5185em;"><span class="pstrut" style="height:3.5183em;"/><span class="mord"><span class="mord"/><span class="mord">3.</span><span class="mord text"><span class="mord cjk_fallback">è¾“å‡ºè®¡ç®—ï¼š</span></span><span class="mspace">Â </span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal">u</span><span class="mord mathnormal">tp</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mord mathnormal">A</span><span class="mord mathnormal">tt</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.6598em;"><span/></span></span></span></span></span></span></span></span></span></span></div>
<h3 data-id="heading-7">3. ä¼˜åŒ–å‰åå¯¹æ¯”ï¼šå‡å°‘1æ¬¡å…³é”®çŸ©é˜µä¹˜æ³•</h3>





























<table><thead><tr><th>é˜¶æ®µ</th><th>æ ‡å‡†è®¡ç®—</th><th>çŸ©é˜µå¸æ”¶ä¼˜åŒ–</th><th>æ ¸å¿ƒå·®å¼‚</th></tr></thead><tbody><tr><td>æŠ•å½±é˜¶æ®µ</td><td><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo>=</mo><msub><mi>C</mi><mi>q</mi></msub><mo separator="true">â‹…</mo><msubsup><mi>W</mi><mi>q</mi><mi>U</mi></msubsup></mrow><annotation encoding="application/x-tex">Q = C_qÂ·W_q^U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.2244em;vertical-align:-0.3831em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span/></span></span></span></span></span></span></span></span></span>ï¼ˆ1æ¬¡ï¼‰+ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mo separator="true">â‹…</mo><msubsup><mi>W</mi><mi>k</mi><mi>U</mi></msubsup></mrow><annotation encoding="application/x-tex">K = C_kÂ·W_k^U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.1244em;vertical-align:-0.2831em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span/></span></span></span></span></span></span></span></span></span>ï¼ˆ1æ¬¡ï¼‰</td><td><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Q</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mo>=</mo><msub><mi>C</mi><mi>q</mi></msub><mo separator="true">â‹…</mo><msub><mi>W</mi><mi>q</mi></msub><mi>k</mi></mrow><annotation encoding="application/x-tex">Q' = C_qÂ·W_qk</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9463em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span>ï¼ˆ1æ¬¡ï¼‰</td><td>çœå» <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mo separator="true">â‹…</mo><msubsup><mi>W</mi><mi>k</mi><mi>U</mi></msubsup></mrow><annotation encoding="application/x-tex">K = C_kÂ·W_k^U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.1244em;vertical-align:-0.2831em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span/></span></span></span></span></span></span></span></span></span> çš„åœ¨çº¿è®¡ç®—</td></tr><tr><td>æ³¨æ„åŠ›åˆ†æ•°é˜¶æ®µ</td><td><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo separator="true">â‹…</mo><msup><mi>K</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">QÂ·K^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span>ï¼ˆ1æ¬¡ï¼‰</td><td><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Q</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mo separator="true">â‹…</mo><msubsup><mi>C</mi><mi>k</mi><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">Q'Â·C_k^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1244em;vertical-align:-0.2831em;"/><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span/></span></span></span></span></span></span></span></span></span>ï¼ˆ1æ¬¡ï¼‰</td><td>ç”¨é¢„è®¡ç®—çš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>q</mi></msub><mi>k</mi></mrow><annotation encoding="application/x-tex">W_qk</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span>æ›¿ä»£ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>W</mi><mi>q</mi><mi>U</mi></msubsup><mo separator="true">â‹…</mo><mo stretchy="false">(</mo><msubsup><mi>W</mi><mi>k</mi><mi>U</mi></msubsup><msup><mo stretchy="false">)</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">W_q^UÂ·(W_k^U)^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2244em;vertical-align:-0.3831em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span/></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span></td></tr><tr><td>æ€»åœ¨çº¿çŸ©é˜µä¹˜æ³•æ¬¡æ•°</td><td>3æ¬¡</td><td>2æ¬¡</td><td>å‡å°‘1æ¬¡é«˜å¼€é”€çš„æŠ•å½±çŸ©é˜µä¹˜æ³•</td></tr></tbody></table>
<p><strong>å…³é”®ç»“è®º</strong>ï¼šä¼˜åŒ–åçœå»çš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><msub><mi>C</mi><mi>k</mi></msub><mo separator="true">â‹…</mo><msubsup><mi>W</mi><mi>k</mi><mi>U</mi></msubsup></mrow><annotation encoding="application/x-tex">K = C_kÂ·W_k^U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.1244em;vertical-align:-0.2831em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span/></span></span></span></span></span></span></span></span></span> æ˜¯é«˜å¼€é”€è®¡ç®—â€”â€”<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">C_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> ç»´åº¦ä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>Ã—</mo><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">LÃ—d_{model}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"/><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>W</mi><mi>k</mi><mi>U</mi></msubsup></mrow><annotation encoding="application/x-tex">W_k^U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1244em;vertical-align:-0.2831em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span/></span></span></span></span></span></span></span></span></span> ä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>m</mi></msub><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi><mo>Ã—</mo><msub><mi>d</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">d_modelÃ—d_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼Œè¯¥ä¹˜æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>L</mi><mo separator="true">â‹…</mo><msub><mi>d</mi><mi>m</mi></msub><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi><mo separator="true">â‹…</mo><msub><mi>d</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(LÂ·d_modelÂ·d_k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>ï¼Œå æ ‡å‡†è‡ªæ³¨æ„åŠ›è®¡ç®—æ€»è€—æ—¶çš„30%~40%ï¼ˆå°¤å…¶å½“ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{model}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> è¾ƒå¤§æ—¶ï¼‰ï¼Œè¿™æ˜¯å®ç°1.7å€åŠ é€Ÿçš„æ ¸å¿ƒåŸå› ã€‚</p>
<h2 data-id="heading-8">åŠ é€Ÿæ¯”èƒŒåçš„è®¡ç®—å¤æ‚åº¦åˆ†æ</h2>
<p>è¦ç†è§£ä¸ºä½•èƒ½å®ç°çº¦1.7å€åŠ é€Ÿï¼Œéœ€ä»<strong>æ—¶é—´å¤æ‚åº¦</strong>å’Œ<strong>å®é™…ç¡¬ä»¶æ‰§è¡Œæ•ˆç‡</strong>ä¸¤æ–¹é¢åˆ†æï¼š</p>
<h3 data-id="heading-9">1. æ—¶é—´å¤æ‚åº¦é‡åŒ–å¯¹æ¯”</h3>
<p>å‡è®¾ï¼šåºåˆ—é•¿åº¦ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><mn>2048</mn></mrow><annotation encoding="application/x-tex">L=2048</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">2048</span></span></span></span></span>ï¼Œéšè—å±‚ç»´åº¦ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo>=</mo><mn>2048</mn></mrow><annotation encoding="application/x-tex">d_{model}=2048</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">2048</span></span></span></span></span>ï¼Œæ³¨æ„åŠ›å¤´ç»´åº¦ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>k</mi></msub><mo>=</mo><mn>64</mn></mrow><annotation encoding="application/x-tex">d_k=64</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">64</span></span></span></span></span>ï¼ˆå¯¹åº”32ä¸ªæ³¨æ„åŠ›å¤´ï¼‰ï¼Œå¿½ç•¥ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">softmax</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"/><span class="mord mathnormal">so</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span></span></span></span></span> å’Œå°å¸¸æ•°é¡¹ï¼Œä»…è®¡ç®—çŸ©é˜µä¹˜æ³•çš„æµ®ç‚¹è¿ç®—æ¬¡æ•°ï¼ˆFLOPsï¼‰ï¼š</p>
<ul>
<li>æ ‡å‡†è®¡ç®—ï¼šæ¯ä¸ªå¤´çš„ <code>Q/K</code> æŠ•å½±FLOPsä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo separator="true">â‹…</mo><msub><mi>d</mi><mi>k</mi></msub><mo separator="true">â‹…</mo><msub><mi>d</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">LÂ·d_kÂ·d_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord mathnormal">L</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼ˆå› æ¯ä¸ªå¤´çš„è¾“å…¥ç‰¹å¾ç»´åº¦æ˜¯ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mi mathvariant="normal">/</mi><mi>n</mi><mi>u</mi><msub><mi>m</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi><mi>s</mi></mrow></msub><mo>=</mo><msub><mi>d</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">d_{model}/num_{heads} = d_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼‰ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>u</mi><msub><mi>m</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">num_{heads}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> ä¸ªå¤´çš„æ€»FLOPsä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>u</mi><msub><mi>m</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi><mi>s</mi></mrow></msub><mo>Ã—</mo><mo stretchy="false">(</mo><mi>L</mi><mo separator="true">â‹…</mo><msub><mi>d</mi><mi>k</mi></msub><mo separator="true">â‹…</mo><msub><mi>d</mi><mi>k</mi></msub><mo>+</mo><mi>L</mi><mo separator="true">â‹…</mo><msub><mi>d</mi><mi>k</mi></msub><mo separator="true">â‹…</mo><msub><mi>d</mi><mi>k</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><mo>Ã—</mo><mi>n</mi><mi>u</mi><msub><mi>m</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi><mi>s</mi></mrow></msub><mo>Ã—</mo><mi>L</mi><mo>Ã—</mo><msubsup><mi>d</mi><mi>k</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">num_{heads} Ã— (LÂ·d_kÂ·d_k + LÂ·d_kÂ·d_k) = 2Ã—num_{heads}Ã—LÃ—d_kÂ²</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"/><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">L</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"/><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"/><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"/><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1.0972em;vertical-align:-0.2831em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4169em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span/></span></span></span></span></span></span></span></span></span>ï¼›</li>
<li>çŸ©é˜µå¸æ”¶ä¼˜åŒ–ï¼šæ¯ä¸ªå¤´çš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>q</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">W_{qk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span> æ˜¯ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>k</mi></msub><mo>Ã—</mo><msub><mi>d</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">d_kÃ—d_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼ˆæŒ‰å¤´æ‹†åˆ†åï¼‰ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Q</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mo>=</mo><msub><mi>C</mi><mi>q</mi></msub><mo separator="true">â‹…</mo><msub><mi>W</mi><mi>q</mi></msub><mi>k</mi></mrow><annotation encoding="application/x-tex">Q'=C_qÂ·W_qk</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9463em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span> çš„FLOPsä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>u</mi><msub><mi>m</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi><mi>s</mi></mrow></msub><mo>Ã—</mo><mi>L</mi><mo separator="true">â‹…</mo><msub><mi>d</mi><mi>k</mi></msub><mo separator="true">â‹…</mo><msub><mi>d</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">num_{heads} Ã— LÂ·d_kÂ·d_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"/><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord mathnormal">L</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼Œçœå»äº† <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>u</mi><msub><mi>m</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi><mi>s</mi></mrow></msub><mo>Ã—</mo><mi>L</mi><mo separator="true">â‹…</mo><msub><mi>d</mi><mi>k</mi></msub><mo separator="true">â‹…</mo><msub><mi>d</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">num_{heads} Ã— LÂ·d_kÂ·d_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"/><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord mathnormal">L</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> çš„KæŠ•å½±FLOPsã€‚</li>
</ul>
<p>å½“ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>u</mi><msub><mi>m</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi><mi>s</mi></mrow></msub><mo>=</mo><mn>32</mn></mrow><annotation encoding="application/x-tex">num_{heads}=32</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">32</span></span></span></span></span>ï¼ŒL=2048ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>k</mi></msub><mo>=</mo><mn>64</mn></mrow><annotation encoding="application/x-tex">d_k=64</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">64</span></span></span></span></span> æ—¶ï¼š</p>
<ul>
<li>æ ‡å‡†è®¡ç®—æŠ•å½±FLOPsï¼š<code>2Ã—32Ã—2048Ã—64Â² â‰ˆ 5.3e9</code>ï¼›</li>
<li>ä¼˜åŒ–åæŠ•å½±FLOPsï¼š<code>32Ã—2048Ã—64Â² â‰ˆ 2.65e9</code>ï¼›</li>
<li>ä»…æŠ•å½±é˜¶æ®µå°±èŠ‚çœäº†50%çš„FLOPsï¼Œå†åŠ ä¸Šæ³¨æ„åŠ›åˆ†æ•°è®¡ç®—çš„å†…å­˜è®¿é—®ä¼˜åŒ–ï¼ˆæ— éœ€å­˜å‚¨ <code>K</code> çŸ©é˜µï¼Œå‡å°‘å†…å­˜å¸¦å®½å ç”¨ï¼‰ï¼Œç»¼åˆä¸‹æ¥å®ç°1.7å€å·¦å³çš„ç«¯åˆ°ç«¯åŠ é€Ÿï¼ˆå®é™…åŠ é€Ÿæ¯”å—ç¡¬ä»¶ç±»å‹ã€åºåˆ—é•¿åº¦ã€æ¨¡å‹ç»´åº¦å½±å“ï¼Œé€šå¸¸åœ¨1.5~2å€ä¹‹é—´ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-10">2. ç¡¬ä»¶æ‰§è¡Œæ•ˆç‡æå‡</h3>
<p>é™¤äº†å‡å°‘FLOPsï¼ŒçŸ©é˜µå¸æ”¶ä¼˜åŒ–è¿˜èƒ½æå‡<strong>å†…å­˜è®¿é—®æ•ˆç‡</strong>ï¼š</p>
<ul>
<li>æ ‡å‡†è®¡ç®—éœ€å­˜å‚¨ <code>Q</code>ã€<code>K</code>ã€<code>V</code> ä¸‰ä¸ªçŸ©é˜µï¼Œä¼˜åŒ–åä»…éœ€å­˜å‚¨ <code>Q'</code> å’Œ <code>V</code>ï¼Œå‡å°‘äº† <code>K</code> çŸ©é˜µçš„å†…å­˜å ç”¨ï¼ˆå°¤å…¶æ˜¯é•¿åºåˆ—åœºæ™¯ï¼Œ<code>K</code> çŸ©é˜µçš„å­˜å‚¨å¼€é”€æ˜¾è‘—ï¼‰ï¼›</li>
<li>å†…å­˜è®¿é—®å»¶è¿Ÿæ˜¯LLMæ¨ç†çš„é‡è¦ç“¶é¢ˆï¼ˆå°¤å…¶æ˜¯GPUæ˜¾å­˜å¸¦å®½ã€CPUå†…å­˜å¸¦å®½å—é™åœºæ™¯ï¼‰ï¼Œå‡å°‘å†…å­˜å ç”¨å¯é™ä½ç¼“å­˜å‘½ä¸­å¤±è´¥ç‡ï¼Œè¿›ä¸€æ­¥æå‡å®é™…æ‰§è¡Œé€Ÿåº¦ã€‚</li>
</ul>
<h2 data-id="heading-11">çŸ©é˜µå¸æ”¶ä¼˜åŒ–çš„å…³é”®ç‰¹æ€§ä¸é€‚ç”¨åœºæ™¯</h2>
<h3 data-id="heading-12">1. æ ¸å¿ƒä¼˜åŠ¿</h3>
<ul>
<li><strong>æ— ç²¾åº¦æŸå¤±</strong>ï¼šä»…è°ƒæ•´çŸ©é˜µä¹˜æ³•é¡ºåºï¼Œæ•°å€¼è®¡ç®—å®Œå…¨ç­‰ä»·äºæ ‡å‡†è‡ªæ³¨æ„åŠ›ï¼Œä¸å½±å“æ¨¡å‹è¾“å‡ºè´¨é‡ï¼ˆæ— éœ€é‡æ–°è®­ç»ƒæˆ–å¾®è°ƒï¼‰ï¼›</li>
<li><strong>å®ç°æˆæœ¬æä½</strong>ï¼šæ— éœ€ä¿®æ”¹æ¨¡å‹ç»“æ„ï¼Œä»…éœ€åœ¨æ¨ç†å‰é¢„è®¡ç®— <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>q</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">W_{qk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span>ï¼Œå¹¶è°ƒæ•´æ¨ç†æ—¶çš„è®¡ç®—é€»è¾‘ï¼ˆæ›¿æ¢ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo separator="true">â‹…</mo><msup><mi>K</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">QÂ·K^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span> ä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Q</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mo separator="true">â‹…</mo><msubsup><mi>C</mi><mi>k</mi><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">Q'Â·C_k^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1244em;vertical-align:-0.2831em;"/><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span/></span></span></span></span></span></span></span></span></span>ï¼‰ï¼›</li>
<li><strong>å…¼å®¹æ€§å¼º</strong>ï¼šå¯ä¸é‡åŒ–ï¼ˆINT8/INT4ï¼‰ã€ç¨€ç–åŒ–ã€FlashAttentionã€TensorRTç­‰å…¶ä»–æ¨ç†åŠ é€ŸæŠ€æœ¯å åŠ ä½¿ç”¨ï¼ˆä¾‹å¦‚ï¼šé¢„è®¡ç®—çš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>q</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">W_{qk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span> å¯ç›´æ¥è¿›è¡ŒINT8é‡åŒ–ï¼Œè¿›ä¸€æ­¥é™ä½è®¡ç®—å¼€é”€ï¼‰ï¼›</li>
<li><strong>æ™®é€‚æ€§é«˜</strong>ï¼šé€‚ç”¨äºæ‰€æœ‰åŸºäºTransformerè‡ªæ³¨æ„åŠ›çš„LLMï¼ˆå¦‚GPTç³»åˆ—ã€Llamaç³»åˆ—ã€ChatGLMç³»åˆ—ç­‰ï¼‰ï¼Œæ— è®ºæ˜¯è§£ç å™¨æ¶æ„ï¼ˆDecoder-onlyï¼‰è¿˜æ˜¯ç¼–ç å™¨-è§£ç å™¨æ¶æ„ï¼ˆEncoder-Decoderï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-13">2. é€‚ç”¨åœºæ™¯</h3>
<ul>
<li><strong>é•¿åºåˆ—æ¨ç†</strong>ï¼šåºåˆ—é•¿åº¦ Lè¶Šå¤§ï¼ŒK çŸ©é˜µçš„æŠ•å½±å’Œå­˜å‚¨å¼€é”€è¶Šæ˜¾è‘—ï¼Œä¼˜åŒ–æ•ˆæœè¶Šæ˜æ˜¾ï¼ˆå¦‚æ–‡æ¡£æ‘˜è¦ã€ä»£ç ç”Ÿæˆç­‰é•¿æ–‡æœ¬åœºæ™¯ï¼‰ï¼›</li>
<li><strong>é«˜å¹¶å‘éƒ¨ç½²</strong>ï¼šAPIæœåŠ¡ã€æœ¬åœ°åŒ–éƒ¨ç½²ç­‰å¯¹å»¶è¿Ÿæ•æ„Ÿçš„åœºæ™¯ï¼Œå¯é€šè¿‡å‡å°‘è®¡ç®—é‡æå‡å¹¶å‘å¤„ç†èƒ½åŠ›ï¼ˆç›¸åŒç¡¬ä»¶èµ„æºä¸‹æ”¯æŒæ›´å¤šè¯·æ±‚ï¼‰ï¼›</li>
<li><strong>èµ„æºå—é™è®¾å¤‡</strong>ï¼šCPUéƒ¨ç½²ã€è¾¹ç¼˜è®¾å¤‡ï¼ˆå¦‚ Jetson ç³»åˆ—ï¼‰ç­‰ç®—åŠ›/å†…å­˜æœ‰é™çš„åœºæ™¯ï¼Œå¯åœ¨ä¸ç‰ºç‰²ç²¾åº¦çš„å‰æä¸‹é™ä½ç¡¬ä»¶é—¨æ§›ã€‚</li>
</ul>
<h3 data-id="heading-14">3. å±€é™æ€§</h3>
<ul>
<li>ä»…é€‚ç”¨äº<strong>æ¨ç†é˜¶æ®µ</strong>ï¼šè®­ç»ƒé˜¶æ®µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>W</mi><mi>q</mi><mi>U</mi></msubsup></mrow><annotation encoding="application/x-tex">W_q^U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2244em;vertical-align:-0.3831em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span/></span></span></span></span></span></span></span></span></span>, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>W</mi><mi>k</mi><mi>U</mi></msubsup></mrow><annotation encoding="application/x-tex">W_k^U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1244em;vertical-align:-0.2831em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span/></span></span></span></span></span></span></span></span></span> æ˜¯åŠ¨æ€æ›´æ–°çš„ï¼Œæ— æ³•é¢„è®¡ç®— <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>q</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">W_{qk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span>ï¼Œå› æ­¤ä¸é€‚ç”¨ï¼›</li>
<li>å¯¹çŸ­åºåˆ—åŠ é€Ÿæ•ˆæœæœ‰é™ï¼šå½“ L æå°æ—¶ï¼ˆå¦‚ L&lt;128ï¼‰ï¼ŒK çŸ©é˜µçš„æŠ•å½±å¼€é”€å æ¯”ä½ï¼ŒåŠ é€Ÿæ¯”å¯èƒ½é™è‡³1.2å€ä»¥ä¸‹ã€‚</li>
</ul>
<h2 data-id="heading-15">å·¥ç¨‹å®ç°æ­¥éª¤ï¼ˆä»¥PyTorchä¸ºä¾‹ï¼‰</h2>
<p>çŸ©é˜µå¸æ”¶ä¼˜åŒ–çš„å·¥ç¨‹å®ç°éå¸¸ç®€æ´ï¼Œæ ¸å¿ƒåˆ†ä¸ºâ€œé¢„è®¡ç®— <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>q</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">W_{qk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span>â€å’Œâ€œä¿®æ”¹æ¨ç†é€»è¾‘â€ä¸¤æ­¥ï¼š</p>
<h3 data-id="heading-16">1. æ­¥éª¤1ï¼šé¢„è®¡ç®—åˆå¹¶æŠ•å½±çŸ©é˜µ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>q</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">W_{qk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span></h3>
<p>åŠ è½½é¢„è®­ç»ƒæ¨¡å‹åï¼Œæå– <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>W</mi><mi>q</mi><mi>U</mi></msubsup></mrow><annotation encoding="application/x-tex">W_q^U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2244em;vertical-align:-0.3831em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span/></span></span></span></span></span></span></span></span></span> å’Œ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>W</mi><mi>k</mi><mi>U</mi></msubsup></mrow><annotation encoding="application/x-tex">W_k^U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1244em;vertical-align:-0.2831em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span/></span></span></span></span></span></span></span></span></span>ï¼Œç¦»çº¿è®¡ç®— <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>q</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">W_{qk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span> å¹¶æ›¿æ¢åŸæŠ•å½±çŸ©é˜µï¼ˆä»¥Llamaç³»åˆ—æ¨¡å‹ä¸ºä¾‹ï¼‰ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> torch
<span class="hljs-keyword">import</span> torch.nn <span class="hljs-keyword">as</span> nn

<span class="hljs-keyword">class</span> <span class="hljs-title class_">LlamaAttentionWithAbsorption</span>(nn.Module):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, original_attention</span>):
        <span class="hljs-built_in">super</span>().__init__()
        self.original_attention = original_attention
        self.d_model = original_attention.hidden_size
        self.num_heads = original_attention.num_attention_heads
        self.d_k = self.d_model // self.num_heads
        
        <span class="hljs-comment"># æå–åŸå§‹æŠ•å½±çŸ©é˜µï¼ˆLlamaçš„attentionæƒé‡é€šå¸¸åœ¨self.q_projã€self.k_projã€self.v_projï¼‰</span>
        self.W_q_U = original_attention.q_proj.weight  <span class="hljs-comment"># ç»´åº¦ï¼šd_model Ã— d_modelï¼ˆå®é™…æ˜¯num_headsÃ—d_k Ã— d_modelï¼Œéœ€æŒ‰å¤´æ‹†åˆ†ï¼‰</span>
        self.W_k_U = original_attention.k_proj.weight  <span class="hljs-comment"># ç»´åº¦ï¼šd_model Ã— d_model</span>
        self.W_v_U = original_attention.v_proj.weight  <span class="hljs-comment"># ç»´åº¦ï¼šd_model Ã— d_model</span>
        
        <span class="hljs-comment"># æŒ‰æ³¨æ„åŠ›å¤´æ‹†åˆ†æŠ•å½±çŸ©é˜µï¼ˆnum_heads Ã— d_k Ã— d_modelï¼‰</span>
        self.W_q_U_per_head = self.W_q_U.view(self.num_heads, self.d_k, self.d_model)
        self.W_k_U_per_head = self.W_k_U.view(self.num_heads, self.d_k, self.d_model)
        
        <span class="hljs-comment"># é¢„è®¡ç®—æ¯ä¸ªå¤´çš„ W_qk = W_q_U Â· (W_k_U)^Tï¼ˆç»´åº¦ï¼šnum_heads Ã— d_k Ã— d_kï¼‰</span>
        self.W_qk_per_head = torch.matmul(
            self.W_q_U_per_head,  <span class="hljs-comment"># (num_heads, d_k, d_model)</span>
            self.W_k_U_per_head.transpose(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)  <span class="hljs-comment"># (num_heads, d_model, d_k)</span>
        )
        
        <span class="hljs-comment"># åˆå¹¶ä¸ºä¸€ä¸ªçŸ©é˜µï¼ˆæ–¹ä¾¿æ‰¹é‡è®¡ç®—ï¼šnum_headsÃ—d_k Ã— d_kï¼‰</span>
        self.W_qk = self.W_qk_per_head.view(self.num_heads * self.d_k, self.d_k)
        
        <span class="hljs-comment"># ä¿ç•™Vçš„æŠ•å½±çŸ©é˜µ</span>
        self.W_v = self.W_v_U.view(self.num_heads, self.d_k, self.d_model)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, hidden_states</span>):
        L, B, d_model = hidden_states.shape  <span class="hljs-comment"># è¾“å…¥ç»´åº¦ï¼š(åºåˆ—é•¿åº¦L, æ‰¹æ¬¡å¤§å°B, éšè—å±‚ç»´åº¦d_model)</span>
        num_heads, d_k = self.num_heads, self.d_k
        
        <span class="hljs-comment"># 1. è®¡ç®—Q' = C_q Â· W_qkï¼ˆæ›¿ä»£åŸQ = C_qÂ·W_q_U å’Œ K = C_kÂ·W_k_Uï¼‰</span>
        <span class="hljs-comment"># è¾“å…¥reshapeï¼š(L, B, d_model) â†’ (B, L, d_model)</span>
        hidden_states = hidden_states.transpose(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)
        
        <span class="hljs-comment"># Q'è®¡ç®—ï¼š(B, L, d_model) Ã— (num_headsÃ—d_k, d_k) â†’ (B, L, num_headsÃ—d_k)</span>
        q_prime = torch.matmul(hidden_states, self.W_qk.t())  <span class="hljs-comment"># W_qkæ˜¯(num_headsÃ—d_k, d_k)ï¼Œè½¬ç½®åæ˜¯(d_k, num_headsÃ—d_k)ï¼Ÿä¿®æ­£ï¼š</span>
        q_prime = torch.matmul(hidden_states, self.W_qk.permute(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>))  <span class="hljs-comment"># æ­£ç¡®ç»´åº¦åŒ¹é…ï¼š(B,L,d_model) Ã— (d_model, num_headsÃ—d_k) â†’ (B,L,num_headsÃ—d_k)</span>
        
        <span class="hljs-comment"># æŒ‰å¤´æ‹†åˆ†Q'ï¼š(B, L, num_heads, d_k) â†’ (B, num_heads, L, d_k)</span>
        q_prime = q_prime.view(B, L, num_heads, d_k).transpose(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)
        
        <span class="hljs-comment"># 2. è®¡ç®—C_k^Tï¼ˆè¾“å…¥ç‰¹å¾çš„è½¬ç½®ï¼‰ï¼š(B, d_model, L)</span>
        C_k_T = hidden_states.transpose(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)
        
        <span class="hljs-comment"># 3. æ³¨æ„åŠ›åˆ†æ•°è®¡ç®—ï¼šQ' Â· C_k^T â†’ (B, num_heads, L, L)</span>
        attention_scores = torch.matmul(q_prime, C_k_T)  <span class="hljs-comment"># (B, num_heads, L, d_k) Ã— (B, d_model, L) â†’ ä¸å¯¹ï¼Œéœ€æŒ‰å¤´å¤„ç†C_kï¼š</span>
        <span class="hljs-comment"># ä¿®æ­£ï¼šC_kæŒ‰å¤´æ‹†åˆ†å¹¶è½¬ç½®ï¼š(B, d_model, L) â†’ (B, num_heads, d_k, L)</span>
        C_k_per_head_T = hidden_states.view(B, L, num_heads, d_k).transpose(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>).transpose(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)  <span class="hljs-comment"># (B, num_heads, d_k, L)</span>
        attention_scores = torch.matmul(q_prime, C_k_per_head_T)  <span class="hljs-comment"># (B, num_heads, L, d_k) Ã— (B, num_heads, d_k, L) â†’ (B, num_heads, L, L)</span>
        
        <span class="hljs-comment"># ç¼©æ”¾æ³¨æ„åŠ›åˆ†æ•°</span>
        attention_scores = attention_scores / math.sqrt(d_k)
        
        <span class="hljs-comment"># 4. softmaxè®¡ç®—æ³¨æ„åŠ›æƒé‡</span>
        attention_weights = F.softmax(attention_scores, dim=-<span class="hljs-number">1</span>)
        
        <span class="hljs-comment"># 5. è®¡ç®—V = C_v Â· W_v_U</span>
        v = torch.matmul(hidden_states, self.W_v.permute(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>).reshape(d_model, num_heads*d_k).t())  <span class="hljs-comment"># (B, L, num_headsÃ—d_k)</span>
        v = v.view(B, L, num_heads, d_k).transpose(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)  <span class="hljs-comment"># (B, num_heads, L, d_k)</span>
        
        <span class="hljs-comment"># 6. è¾“å‡ºè®¡ç®—ï¼šAttention Â· V â†’ (B, num_heads, L, d_k)</span>
        output = torch.matmul(attention_weights, v)
        
        <span class="hljs-comment"># åˆå¹¶æ³¨æ„åŠ›å¤´ï¼š(B, num_heads, L, d_k) â†’ (B, L, num_headsÃ—d_k) â†’ (B, L, d_model)</span>
        output = output.transpose(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>).contiguous().view(B, L, d_model)
        
        <span class="hljs-comment"># è¿˜åŸä¸ºåŸå§‹è¾“å‡ºç»´åº¦ï¼š(L, B, d_model)</span>
        <span class="hljs-keyword">return</span> output.transpose(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)
</code></pre>
<h3 data-id="heading-17">2. æ­¥éª¤2ï¼šæ›¿æ¢æ¨¡å‹çš„æ³¨æ„åŠ›å±‚å¹¶éƒ¨ç½²</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åŠ è½½åŸå§‹Llamaæ¨¡å‹</span>
<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> LlamaForCausalLM, LlamaTokenizer
model_name = <span class="hljs-string">"meta-llama/Llama-2-7b-hf"</span>
tokenizer = LlamaTokenizer.from_pretrained(model_name)
original_model = LlamaForCausalLM.from_pretrained(model_name)

<span class="hljs-comment"># æ›¿æ¢æ‰€æœ‰æ³¨æ„åŠ›å±‚ä¸ºä¼˜åŒ–åçš„ç‰ˆæœ¬</span>
<span class="hljs-keyword">for</span> layer <span class="hljs-keyword">in</span> original_model.model.layers:
    layer.self_attn = LlamaAttentionWithAbsorption(layer.self_attn)

<span class="hljs-comment"># æ¨ç†æµ‹è¯•</span>
inputs = tokenizer(<span class="hljs-string">"Hello, matrix absorption optimization!"</span>, return_tensors=<span class="hljs-string">"pt"</span>)
outputs = original_model.generate(**inputs, max_new_tokens=<span class="hljs-number">50</span>)
<span class="hljs-built_in">print</span>(tokenizer.decode(outputs[<span class="hljs-number">0</span>], skip_special_tokens=<span class="hljs-literal">True</span>))
</code></pre>
<h3 data-id="heading-18">3. å…³é”®ä¼˜åŒ–ç‚¹</h3>
<ul>
<li><strong>æŒ‰å¤´æ‹†åˆ†è®¡ç®—</strong>ï¼šLLMçš„æ³¨æ„åŠ›å¤´æ˜¯å¹¶è¡Œè®¾è®¡çš„ï¼ŒæŒ‰å¤´æ‹†åˆ† <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>q</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">W_{qk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span> å¯é¿å…ç»´åº¦ä¸åŒ¹é…ï¼ŒåŒæ—¶åˆ©ç”¨ç¡¬ä»¶çš„å¹¶è¡Œè®¡ç®—èƒ½åŠ›ï¼›</li>
<li><strong>é¢„è®¡ç®—ç¼“å­˜</strong>ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>q</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">W_{qk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span> å¯æå‰ä¿å­˜ä¸ºæ–‡ä»¶ï¼ˆå¦‚ <code>.bin</code>ï¼‰ï¼Œæ¨¡å‹åŠ è½½æ—¶ç›´æ¥è¯»å–ï¼Œæ— éœ€æ¯æ¬¡åŠ è½½éƒ½é‡æ–°è®¡ç®—ï¼›</li>
<li><strong>é‡åŒ–å…¼å®¹</strong>ï¼šè‹¥éœ€é‡åŒ–æ¨¡å‹ï¼Œå¯åœ¨é¢„è®¡ç®— <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>q</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">W_{qk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span> åå¯¹å…¶è¿›è¡ŒINT8é‡åŒ–ï¼ˆå¦‚ä½¿ç”¨ <code>torch.quantize_per_tensor</code>ï¼‰ï¼Œè¿›ä¸€æ­¥é™ä½è®¡ç®—å’Œå†…å­˜å¼€é”€ã€‚</li>
</ul>
<h2 data-id="heading-19">æ€»ç»“</h2>
<p>çŸ©é˜µå¸æ”¶ä¼˜åŒ–æ˜¯LLMæ¨ç†åŠ é€Ÿçš„â€œè½»é‡çº§åˆ©å™¨â€â€”â€”é€šè¿‡<strong>ç¦»çº¿é¢„è®¡ç®—åˆå¹¶æŠ•å½±çŸ©é˜µ</strong>ï¼Œåœ¨ä¸æŸå¤±ç²¾åº¦ã€ä¸ä¿®æ”¹æ¨¡å‹ç»“æ„çš„å‰æä¸‹ï¼Œå‡å°‘1æ¬¡é«˜å¼€é”€çš„åœ¨çº¿çŸ©é˜µä¹˜æ³•ï¼ŒåŒæ—¶é™ä½å†…å­˜è®¿é—®å‹åŠ›ï¼Œæœ€ç»ˆå®ç°çº¦1.7å€çš„æ¨ç†é€Ÿåº¦æå‡ã€‚è¯¥æŠ€æœ¯å®ç°ç®€å•ã€å…¼å®¹æ€§å¼ºï¼Œå°¤å…¶é€‚åˆé•¿åºåˆ—ã€é«˜å¹¶å‘ã€èµ„æºå—é™çš„LLMæœ¬åœ°åŒ–éƒ¨ç½²åœºæ™¯ï¼Œæ˜¯å¼€å‘è€…åœ¨ä¼˜åŒ–LLMæ¨ç†æ€§èƒ½æ—¶çš„ä¼˜å…ˆé€‰æ‹©ä¹‹ä¸€ã€‚</p>
<p>è‹¥éœ€è¿›ä¸€æ­¥æå‡æ€§èƒ½ï¼Œå¯å°†å…¶ä¸FlashAttentionï¼ˆä¼˜åŒ–æ³¨æ„åŠ›åˆ†æ•°çš„å†…å­˜è®¿é—®ï¼‰ã€æ¨¡å‹é‡åŒ–ï¼ˆINT8/INT4ï¼‰ã€TensorRTæ¨ç†å¼•æ“ç­‰æŠ€æœ¯ç»“åˆï¼Œå½¢æˆâ€œç»„åˆä¼˜åŒ–æ–¹æ¡ˆâ€ï¼Œå¯å®ç°3~5å€çš„ç»¼åˆåŠ é€Ÿæ¯”ï¼Œæ»¡è¶³æ›´ä¸¥è‹›çš„å»¶è¿Ÿå’Œååé‡éœ€æ±‚ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ„å›¾é©±åŠ¨ç¼–ç¨‹ï¼ˆIntent-Driven Programmingï¼‰]]></title>    <link>https://juejin.cn/post/7587392473851445294</link>    <guid>https://juejin.cn/post/7587392473851445294</guid>    <pubDate>2025-12-25T06:56:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587392473851445294" data-draft-id="7587355990409707571" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ„å›¾é©±åŠ¨ç¼–ç¨‹ï¼ˆIntent-Driven Programmingï¼‰"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,LLM,AIGC"/> <meta itemprop="datePublished" content="2025-12-25T06:56:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeonGao"/> <meta itemprop="url" content="https://juejin.cn/user/3976252950591149"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ„å›¾é©±åŠ¨ç¼–ç¨‹ï¼ˆIntent-Driven Programmingï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3976252950591149/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeonGao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T06:56:50.000Z" title="Thu Dec 25 2025 06:56:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body{overflow:hidden;line-height:1.75;font-size:15px;background-image:linear-gradient(90deg,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0),linear-gradient(1turn,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0);background-size:20px 20px;background-position:50%;padding-top:0!important}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{position:relative;display:flex;border-bottom:5px solid #6d4e00;line-height:35px;letter-spacing:1px;font-size:25px;padding-left:25px;color:#664900;text-shadow:1px 1px 1px #8a6200;padding-bottom:0}.markdown-body h1:before{content:"";display:flex;position:absolute;left:0;top:3px;bottom:0;margin:auto;width:20px;height:20px;background-size:20px 20px;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC")}.markdown-body h2{position:relative;padding:0 0 0 20px;font-size:20px;font-weight:700;color:#614500}.markdown-body h2:before{content:"";position:absolute;top:3px;bottom:0;left:0;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC");background-size:100% 100%;background-repeat:no-repeat;width:15px;height:15px;margin:auto}.markdown-body h3{width:100%;text-align:left;margin:20px 10px 0 0;font-size:18px;font-weight:700;display:inline-block;padding-left:10px;padding-bottom:0;border-left:5px solid #8f6600;color:#614500}.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:700;color:#a37400}.markdown-body h4{font-size:17px}.markdown-body h5,.markdown-body h6{display:flex;align-items:center}.markdown-body h5:after,.markdown-body h6:after{display:inline-block;border:2px solid #fff6e0;color:rgba(189,134,0,.5);border-radius:50%;text-align:center;margin-left:5px}.markdown-body h5{font-size:14px}.markdown-body h5:after{content:"5";width:15px;height:15px;line-height:15px;font-size:13px}.markdown-body h6{font-size:12px}.markdown-body h6:after{content:"6";width:13px;height:13px;line-height:13px;font-size:12px}.markdown-body p{color:#412c0c;letter-spacing:1px;font-weight:400;margin-bottom:16px}.markdown-body img{max-width:100%;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#755300;font-weight:400;border-bottom:1px solid #755300;font-weight:bolder;text-decoration:none}.markdown-body table{width:100%!important;margin:0;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border-spacing:0}.markdown-body table img{box-shadow:none}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body thead tr th{text-align:center}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;box-sizing:border-box;border:1px solid rgba(72,42,10,.1)}.markdown-body blockquote{position:relative;text-size-adjust:100%;line-height:25px;font-weight:400;border-radius:10px;font-style:normal;text-align:left;box-sizing:inherit;border:1px solid #ffd87a;background-color:rgba(189,134,0,.5);margin:20px 0;padding:20px}.markdown-body blockquote p{color:#fff6e0;letter-spacing:2px;margin:0}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;color:#cc9100;font-size:34px;font-weight:700}.markdown-body blockquote:before{content:"â";top:8px;left:5px}.markdown-body blockquote:after{content:"â";right:5px;bottom:-5px}.markdown-body strong{color:#c28a00;font-weight:bolder}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{color:#c28a00}.markdown-body em strong{font-style:normal;color:#c28a00;background-color:#8a6200}.markdown-body s{color:#c28a00}.markdown-body hr{border-top:1px solid #805b00}.markdown-body code,.markdown-body li code,.markdown-body p code{color:#996d00;background-color:rgba(130,98,0,.3)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit;color:#858585;font-family:bold;letter-spacing:1px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection,.markdown-body img::selection{color:rgba(189,134,0,.5);background-color:#fff}.markdown-body a::selection,.markdown-body b::selection,.markdown-body del::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:transparent}.markdown-body pre&gt;code::selection{background-color:rgba(189,134,0,.5)}.markdown-body .math .math-inline::selection,.markdown-body blockquote::selection,.markdown-body ol::selection,.markdown-body p::selection,.markdown-body strong::selection,.markdown-body table::selection,.markdown-body ul::selection{background-color:rgba(189,134,0,.5)}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸ§­ ä¸€ã€ä»€ä¹ˆæ˜¯â€œæ„å›¾é©±åŠ¨ç¼–ç¨‹â€ï¼Ÿ</h2>
<p>ğŸ‘¨â€ğŸ’» <strong>ä¸€å¥è¯æ¦‚å¿µï¼š</strong></p>
<blockquote>
<p>ç¨‹åºå‘˜ä¸å†å‘Šè¯‰è®¡ç®—æœºâ€œæ€ä¹ˆåšâ€ï¼Œè€Œæ˜¯æè¿°â€œè¦è¾¾æˆä»€ä¹ˆâ€ï¼Œ<br/>
ç³»ç»Ÿé€šè¿‡è¯­ä¹‰ç†è§£ä¸æ¨¡å‹æ¨ç†ï¼Œè‡ªåŠ¨ç”Ÿæˆâ€œå¦‚ä½•å®ç°â€çš„è¿‡ç¨‹ã€‚</p>
</blockquote>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä»å‘½ä»¤å¼ï¼ˆImperativeï¼‰è½¬å‘ç›®çš„å¯¼å‘ï¼ˆIntent-Orientedï¼‰ã€‚</p>
<p>ä¼ ç»Ÿç¼–ç¨‹åƒè¿™æ ·ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">items</span> = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]<span class="hljs-comment">;</span>
let <span class="hljs-attr">sum</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
for (let <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; items.length; i++) {</span>
  sum += items<span class="hljs-section">[i]</span><span class="hljs-comment">;</span>
}
console.log(sum)<span class="hljs-comment">;</span>
</code></pre>
<p>æ„å›¾é©±åŠ¨çš„æ€è·¯åˆ™æ˜¯ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// äººç±»å†™çš„å¥å­</span>
<span class="hljs-built_in">sumNumbers</span>(items)
</code></pre>
<p>ç³»ç»Ÿè‡ªåŠ¨æ¨ç†å‡ºï¼š</p>
<blockquote>
<p>â€œä»–æƒ³è¦çš„æ˜¯å°†è¿™ä¸ªæ•°ç»„ä¸­æ‰€æœ‰æ•°å­—åŠ å’Œâ€<br/>
äºæ˜¯è‡ªåŠ¨ç”Ÿæˆå¹¶æ‰§è¡Œå¯¹åº”çš„å®ç°é€»è¾‘ã€‚</p>
</blockquote>
<p>ç”šè‡³æœªæ¥çš„å½¢å¼å¯èƒ½æ›´è‡ªç„¶ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// è‡ªç„¶è¯­è¨€æ¥å£</span>
<span class="hljs-string">"è®¡ç®—è¿™ç»„æ•°å­—çš„æ€»å’Œï¼Œå¹¶åœ¨æ§åˆ¶å°è¾“å‡ºç»“æœ"</span>
</code></pre>
<hr/>
<h2 data-id="heading-1">ğŸ§© äºŒã€æ ¸å¿ƒæœºåˆ¶ï¼šä»â€œå‘½ä»¤â†’ç›®æ ‡â†’å®ç°â€çš„ä¸‰å±‚ç»“æ„</h2>
<p>æˆ‘ä»¬æŠŠå®ƒçš„åº•å±‚æƒ³è±¡æˆä¸‰å±‚è¯­ä¹‰æ˜ å°„æ¨¡å‹ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[ äººç±»è¾“å…¥ ]</span>
     â†“
ğŸ¯ æ„å›¾å±‚ï¼ˆIntent Layerï¼‰ â€”â€” â€œæƒ³åšä»€ä¹ˆâ€
     â†“
ğŸ§  è¯­ä¹‰æ¨ç†å±‚ï¼ˆSemantic Reasoning Layerï¼‰ â€”â€” â€œæ€ä¹ˆå®ç°â€
     â†“
âš™ï¸ æ‰§è¡Œå±‚ï¼ˆExecution Layerï¼‰ â€”â€” â€œæ‰§è¡Œä»€ä¹ˆä»£ç â€
</code></pre>
<p>è¿™å°±åƒäººç±»å¤§è„‘å¤„ç†è‡ªç„¶è¯­è¨€æ—¶çš„ä¸‰ä¸ªé˜¶æ®µï¼š</p>
<ol>
<li><strong>è¯†åˆ«æ„å›¾</strong>ï¼ˆä½ æƒ³åšä»€ä¹ˆï¼‰</li>
<li><strong>æ¨ç†åŠ¨ä½œ</strong>ï¼ˆæ€ä¹ˆè¾¾æˆï¼‰</li>
<li><strong>å‘å‡ºæŒ‡ä»¤</strong>ï¼ˆå»åšï¼‰</li>
</ol>
<p>åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œè¿™åˆ†åˆ«å¯¹åº”ï¼š</p>





























<table><thead><tr><th>å±‚çº§</th><th>å¯¹åº”æŠ€æœ¯</th><th>æ ¸å¿ƒä»»åŠ¡</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>æ„å›¾å±‚</td><td>è‡ªç„¶è¯­è¨€è§£æ / Promptç†è§£</td><td>å°†è¯­è¨€è½¬ä¸ºæŠ½è±¡è¯­ä¹‰æ ‘</td><td>â€œç”Ÿæˆä¸€ä»½ç”¨æˆ·æŠ¥å‘Šâ€</td></tr><tr><td>è¯­ä¹‰æ¨ç†å±‚</td><td>è¯­ä¹‰å›¾è°± / å¤§è¯­è¨€æ¨¡å‹ / é€»è¾‘è§„åˆ’</td><td>ç¡®å®šè°ƒç”¨å“ªäº›å‡½æ•°ã€API æˆ– Agent</td><td>â€œç”¨æ•°æ®åº“æŸ¥è¯¢ -&gt; æ ¼å¼åŒ– -&gt; è¾“å‡ºPDFâ€</td></tr><tr><td>æ‰§è¡Œå±‚</td><td>ç¼–ç¨‹è¯­è¨€è¿è¡Œæ—¶ / è‡ªåŠ¨ç”Ÿæˆä»£ç </td><td>å®é™…æ‰§è¡Œå¯éªŒè¯çš„ç¨‹åº</td><td>â€œè¿è¡ŒSQL + æ¸²æŸ“æ¨¡æ¿â€</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-2">ğŸ§  ä¸‰ã€ä¸â€œç¬¦å·AIâ€å’Œâ€œè¿æ¥ä¸»ä¹‰AIâ€çš„èåˆç‚¹</h2>
<p>ä»è®¡ç®—æœºç§‘å­¦çš„è§’åº¦ï¼Œæ„å›¾é©±åŠ¨ç¼–ç¨‹æ˜¯<strong>ç¬¦å·æ´¾ä¸è¿æ¥æ´¾ç»“åˆçš„äº§ç‰©</strong>ï¼š</p>

























<table><thead><tr><th>é¢†åŸŸ</th><th>æ„å›¾çš„è§’è‰²</th><th>æŠ€æœ¯åŸºç¡€</th></tr></thead><tbody><tr><td>ç¬¦å·æ¨ç†ï¼ˆSymbolic AIï¼‰</td><td>æŠŠâ€œæ„å›¾â€å½¢å¼åŒ–æˆé€»è¾‘è¡¨è¾¾å¼</td><td>é€»è¾‘è§„åˆ’ã€çŸ¥è¯†å›¾è°±ã€è§„åˆ™ç³»ç»Ÿ</td></tr><tr><td>ç¥ç»ç½‘ç»œï¼ˆNeural AIï¼‰</td><td>ä»è¯­ä¹‰ä¸­æŠ½å‡ºæ„å›¾åˆ†å¸ƒæ¦‚ç‡</td><td>Transformerã€è¯­ä¹‰åµŒå…¥</td></tr><tr><td>å¤§æ¨¡å‹èåˆå±‚</td><td>åœ¨è¯­ä¹‰ä¸ç»“æ„é—´å»ºç«‹ä¸­é—´å±‚è¯­è¨€</td><td>LLM + DSLï¼ˆé¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰</td></tr></tbody></table>
<p>æ¢å¥è¯è¯´ï¼Œå¤§æ¨¡å‹æ•æ‰â€œæ„å›¾â€ï¼Œ<br/>
çŸ¥è¯†ç³»ç»ŸéªŒè¯â€œåˆç†æ€§â€ï¼Œ<br/>
ç¼–ç¨‹è¯­è¨€ç”Ÿæˆâ€œæ‰§è¡Œé€»è¾‘â€ã€‚</p>
<hr/>
<h2 data-id="heading-3">ğŸ§® å››ã€ä»â€œç¼–è¯‘å™¨â€åˆ°â€œè¯­ä¹‰ç¼–è¯‘å™¨â€çš„æ¼”åŒ–é€»è¾‘</h2>
<blockquote>
<p><strong>ä¼ ç»Ÿç¼–è¯‘å™¨</strong>ï¼šæŠŠè¯­æ³•ç¿»è¯‘æˆæœºå™¨æŒ‡ä»¤ã€‚<br/>
<strong>è¯­ä¹‰ç¼–è¯‘å™¨</strong>ï¼šæŠŠæ„å›¾ç¿»è¯‘æˆé—®é¢˜æ±‚è§£è·¯å¾„ã€‚</p>
</blockquote>
<p>è¿™ç§ç¼–è¯‘å™¨å·²ç»åœ¨é›å½¢é˜¶æ®µï¼Œæ¯”å¦‚ï¼š</p>
<h4 data-id="heading-4">ğŸŒ± ç±»æ¯”æµç¨‹ï¼š</h4>
<pre><code class="hljs language-rust" lang="rust">è¾“å…¥ï¼š<span class="hljs-string">"ç”Ÿæˆä¸€ä¸ªèƒ½æ¯å¤©æŠ“å–æ–°é—»å¹¶å‘é‚®ä»¶çš„æœåŠ¡ã€‚"</span>

â†“ ç¼–è¯‘è¿‡ç¨‹ â†“

<span class="hljs-number">1</span>ï¸âƒ£ æŠ½å–æ„å›¾ï¼š
   <span class="hljs-punctuation">-&gt;</span> {ç›®æ ‡: ä¿¡æ¯è‡ªåŠ¨åŒ–, åŠ¨ä½œ: æŠ“å–, è¾“å‡º: é‚®ä»¶, å‘¨æœŸ: æ¯å¤©}

<span class="hljs-number">2</span>ï¸âƒ£ æ¨ç†ç»„ä»¶ï¼š
   <span class="hljs-punctuation">-&gt;</span> {Agent: WebCrawler, Parser: NLPContentExtractor, Scheduler: Timer}

<span class="hljs-number">3</span>ï¸âƒ£ ä»£ç åˆæˆï¼š
   <span class="hljs-punctuation">-&gt;</span> Node.js æ¨¡å— + cron job + é‚®ä»¶APIé›†æˆ

<span class="hljs-number">4</span>ï¸âƒ£ æ‰§è¡Œï¼š
   <span class="hljs-punctuation">-&gt;</span> è‡ªåŠ¨éƒ¨ç½² &amp; ç›‘æ§
</code></pre>
<p>è¿™å°±æ˜¯ <strong>â€œè¯­ä¹‰åˆ°å¯æ‰§è¡Œâ€çš„æ˜ å°„è¿‡ç¨‹</strong>ã€‚<br/>
ç³»ç»Ÿåœ¨å†…éƒ¨ç”Ÿæˆä¸­é—´è¡¨ç¤ºï¼ˆSemantic IRï¼‰ï¼Œ<br/>
ç„¶åè‡ªåŠ¨è°ƒç”¨æ¨¡æ¿ä»£ç æˆ–å°æ¨¡å‹å®Œæˆæ„å»ºã€‚</p>
<hr/>
<h2 data-id="heading-5">âš™ï¸ äº”ã€æ„å›¾çš„â€œç»“æ„åŒ–æŠ½è±¡â€ï¼šç¨‹åºä¸å†æ˜¯å‡½æ•°ï¼Œè€Œæ˜¯è¯­ä¹‰èŠ‚ç‚¹</h2>
<p>æœªæ¥ç¨‹åºå¯èƒ½ä¸å†ç”±å‡½æ•°å’Œç±»ç»„æˆï¼Œè€Œæ˜¯ç”±**è¯­ä¹‰èŠ‚ç‚¹ï¼ˆSemantic Nodesï¼‰**ç»„æˆï¼š</p>
<pre><code class="hljs language-css" lang="css">{
  intent: <span class="hljs-string">"ç”Ÿæˆæ—¥æŠ¥"</span>,
  data_source: <span class="hljs-string">"å…¬å¸æ•°æ®åº“"</span>,
  filters: [<span class="hljs-string">"é”€å”®é¢"</span>, <span class="hljs-string">"åœ°åŒº"</span>],
  output: <span class="hljs-string">"PDF"</span>,
  schedule: <span class="hljs-string">"æ¯æ—¥ 7:00"</span>
}
</code></pre>
<p>ç„¶åç”±ç³»ç»Ÿå°†å…¶è½¬è¯‘ä¸ºï¼š</p>
<ul>
<li>æ•°æ®åº“æŸ¥è¯¢è¯­å¥</li>
<li>PDF æ¨¡æ¿å¼•æ“è°ƒç”¨</li>
<li>å®šæ—¶ä»»åŠ¡è„šæœ¬</li>
<li>å‘é€é€»è¾‘æ‰§è¡Œå™¨</li>
</ul>
<p>å³ç¼–ç¨‹æŠ½è±¡ä» <strong>â€œæ§åˆ¶æµï¼ˆControl Flowï¼‰â€ â†’ â€œç›®æ ‡è¯­ä¹‰ç½‘ï¼ˆGoal Graphï¼‰â€</strong> ã€‚</p>
<hr/>
<h2 data-id="heading-6">ğŸŒ‰ å…­ã€æ„å›¾é©±åŠ¨ç¼–ç¨‹çš„åŸºç¡€æ”¯æ’‘ï¼š</h2>
<h3 data-id="heading-7">ï¼ˆ1ï¼‰è¯­ä¹‰ç†è§£æ¨¡å‹ï¼ˆSemantic Understandingï¼‰</h3>
<p>è®©æœºå™¨èƒ½ç¨³å®šè¯†åˆ«ç›®æ ‡ï¼Œè€Œéå¥å¼ã€‚<br/>
æ¯”å¦‚â€œå†™æŠ¥å‘Šâ€ã€â€œç”Ÿæˆæ—¥æŠ¥â€åœ¨è¯­ä¹‰ä¸Šæ˜¯ç­‰ä»·ä»»åŠ¡ã€‚</p>
<h3 data-id="heading-8">ï¼ˆ2ï¼‰æ„å›¾æ˜ å°„æ ‡å‡†åŒ–ï¼ˆIntent Mapping Schemaï¼‰</h3>
<p>ç±»ä¼¼ API çš„â€œåè®®å±‚â€ï¼Œå®šä¹‰æ„å›¾æ ‡å‡†ã€‚<br/>
æœªæ¥å¯èƒ½ä¼šæœ‰ç±»ä¼¼è¿™ç§æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"intent"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"send_email"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"required"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"recipient"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"message"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"optional"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"attachment"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"priority"</span><span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-9">ï¼ˆ3ï¼‰è‡ªæˆ‘è§„åˆ’ä¸éªŒè¯ï¼ˆAutonomous Planning &amp; Verificationï¼‰</h3>
<p>ç³»ç»Ÿä¼šè‡ªåŠ¨æ¨ç†æ»¡è¶³æ„å›¾çš„ä»»åŠ¡é“¾ï¼Œå¹¶æ£€æŸ¥æ˜¯å¦åˆç†ï¼ˆç±»ä¼¼ Model Checkingï¼‰ã€‚</p>
<hr/>
<h2 data-id="heading-10">ğŸ” ä¸ƒã€JS ç¤ºä¾‹ï¼šä»äººç±»è¯­è¨€ç”Ÿæˆä»»åŠ¡æ‰§è¡Œæµ</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> ai = {
  <span class="hljs-attr">interpret</span>: <span class="hljs-function">(<span class="hljs-params">sentence</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (sentence.<span class="hljs-title function_">includes</span>(<span class="hljs-string">"æŠ¥å‘Š"</span>)) <span class="hljs-keyword">return</span> <span class="hljs-string">"generateReport"</span>;
    <span class="hljs-keyword">if</span> (sentence.<span class="hljs-title function_">includes</span>(<span class="hljs-string">"é‚®ä»¶"</span>)) <span class="hljs-keyword">return</span> <span class="hljs-string">"sendEmail"</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-string">"unknown"</span>;
  },
  <span class="hljs-attr">execute</span>: <span class="hljs-function">(<span class="hljs-params">intent</span>) =&gt;</span> {
    <span class="hljs-keyword">switch</span> (intent) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"generateReport"</span>:
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ğŸ“Š æ­£åœ¨ç”Ÿæˆæ—¥æŠ¥..."</span>);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"sendEmail"</span>:
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ğŸ“§ æ­£åœ¨å‘é€é‚®ä»¶..."</span>);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-attr">default</span>:
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ğŸ¤” ä¸ç¡®å®šä½ çš„æ„å›¾"</span>);
    }
  }
};

<span class="hljs-keyword">const</span> input = <span class="hljs-string">"å¸®æˆ‘ç”Ÿæˆä¸€ä»½æ—¥æŠ¥"</span>;
<span class="hljs-keyword">const</span> intent = ai.<span class="hljs-title function_">interpret</span>(input);
ai.<span class="hljs-title function_">execute</span>(intent);
</code></pre>
<p>ğŸ§© <strong>è¾“å‡ºï¼š</strong></p>
<pre><code class="hljs language-erlang" lang="erlang">ğŸ“Š æ­£åœ¨ç”Ÿæˆæ—¥æŠ¥...
</code></pre>
<p>è¿™åªæ˜¯ä¸€ä¸ªæ¦‚å¿µæ€§ mini æ¨¡å‹ï¼Œ<br/>
ä½†çœŸæ­£çš„æ„å›¾é©±åŠ¨ç³»ç»Ÿä¼šæœ‰å¤šå±‚è¯­ä¹‰æ¨¡å‹ã€æ‰§è¡Œå¼•æ“ã€éªŒè¯é€»è¾‘ã€‚</p>
<hr/>
<h2 data-id="heading-11">ğŸ”® å…«ã€å“²å­¦è§†è§’ï¼šä»ç¼–å†™ä»£ç åˆ°è¡¨è¾¾æ€ç»´</h2>
<p>æ„å›¾é©±åŠ¨ç¼–ç¨‹çš„ç»ˆæç›®æ ‡ï¼Œä¸æ˜¯è®©AIå†™ä»£ç ï¼Œ<br/>
è€Œæ˜¯<strong>è®©æ€ç»´æœ¬èº«æˆä¸ºç¼–ç¨‹è¯­è¨€</strong>ã€‚</p>
<p>æœªæ¥çš„ç¨‹åºå‘˜å¯èƒ½è¿™æ ·â€œå†™ç¨‹åºâ€ï¼š</p>
<blockquote>
<p>æˆ‘æƒ³æ„å»ºä¸€ä¸ªèƒ½é˜…è¯»æ–°é—»ã€æ€»ç»“è¶‹åŠ¿å¹¶æ¯å¤©æ—©ä¸Šç»™æˆ‘å‘æŠ¥å‘Šçš„æ™ºèƒ½ä½“ã€‚<br/>
è¯·ç¡®ä¿ï¼š</p>
<ul>
<li>è¯­æ°”ä¸“ä¸šä½†äº²åˆ‡</li>
<li>æä¾›å…³é”®æŒ‡æ ‡çš„è¶‹åŠ¿å›¾</li>
<li>ä¸è¦å•°å—¦</li>
</ul>
</blockquote>
<p>AI ç†è§£åç›´æ¥æ„å»ºæ•´ä¸ªç³»ç»Ÿã€‚<br/>
åˆ°é‚£æ—¶ï¼Œç¼–ç¨‹ä¼šå˜å¾—æ›´åƒæ–‡å­¦åˆ›ä½œâ€”â€”<br/>
é€»è¾‘ = è¯—æ„ï¼Œç®—æ³• = æ€æƒ³çš„éª¨æ¶ã€‚</p>
<hr/>
<h2 data-id="heading-12">âš¡ ä¹ã€æ€»ç»“è¡¨æ ¼</h2>





























<table><thead><tr><th>å±‚çº§</th><th>ç›®æ ‡</th><th>æŠ€æœ¯å½¢æ€</th><th>å¯¹äººç±»æ„ä¹‰</th></tr></thead><tbody><tr><td>ç¼–ç¨‹è¯­è¨€</td><td>è®©äººç±»æ•™è®¡ç®—æœº</td><td>è¯­æ³•ä¸å‘½ä»¤</td><td>æŠ€æœ¯æ€§æ²Ÿé€š</td></tr><tr><td>æ„å›¾ç¼–ç¨‹</td><td>è®©è®¡ç®—æœºç†è§£äººç±»</td><td>è¯­ä¹‰å»ºæ¨¡ä¸æ¨ç†</td><td>æ€ç»´å±‚æ²Ÿé€š</td></tr><tr><td>è‡ªæ¼”åŒ–ç³»ç»Ÿ</td><td>è®©AIæ„å»ºAI</td><td>è‡ªæˆ‘åæ€æ¨¡å‹</td><td>åˆä½œå¼æ™ºèƒ½å…±åˆ›</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-13">âœ¨ åã€ç»“è¯­ï¼šç¼–ç¨‹çš„æœªæ¥ï¼Œæ˜¯â€œè¡¨è¾¾æ„å›¾çš„è‰ºæœ¯â€</h2>
<p>åœ¨è¿‡å¾€ 70 å¹´çš„è®¡ç®—æœºå²ä¸­ï¼Œ<br/>
äººç±»ä¸€ç›´åœ¨åŠªåŠ›ç¼©å°â€œæ€è€ƒâ€å’Œâ€œæ‰§è¡Œâ€ä¹‹é—´çš„é¸¿æ²Ÿã€‚</p>
<p>ä»æœºå™¨ç åˆ° Pythonï¼Œä» Prompt åˆ° Intentï¼Œ<br/>
æˆ‘ä»¬ä¸å†å»å†™ç¨‹åºï¼Œè€Œæ˜¯åœ¨<strong>è¡¨è¾¾æ€æƒ³çš„ç»“æ„</strong>ã€‚</p>
<p>ä¹Ÿè®¸æœªæ¥çš„è°ƒè¯•ï¼Œä¸æ˜¯ä¿® Bugï¼Œ<br/>
è€Œæ˜¯çº æ­£è¯¯è§£â€”â€”</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[jstackä¸Arthasçº¿ç¨‹è¯Šæ–­å®æˆ˜ï¼šCPUé£™é«˜é—®é¢˜çš„åŒé›„å¯¹å†³]]></title>    <link>https://juejin.cn/post/7587261929385132084</link>    <guid>https://juejin.cn/post/7587261929385132084</guid>    <pubDate>2025-12-25T02:09:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587261929385132084" data-draft-id="7587261929385099316" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="jstackä¸Arthasçº¿ç¨‹è¯Šæ–­å®æˆ˜ï¼šCPUé£™é«˜é—®é¢˜çš„åŒé›„å¯¹å†³"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-25T02:09:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ITæ©˜å­çš®"/> <meta itemprop="url" content="https://juejin.cn/user/3148645291002232"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            jstackä¸Arthasçº¿ç¨‹è¯Šæ–­å®æˆ˜ï¼šCPUé£™é«˜é—®é¢˜çš„åŒé›„å¯¹å†³
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3148645291002232/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ITæ©˜å­çš®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T02:09:21.000Z" title="Thu Dec 25 2025 02:09:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€é—®é¢˜èƒŒæ™¯ï¼šCPUé£™é«˜åœºæ™¯çš„å…¸å‹ç‰¹å¾</h2>
<p>æŸç”µå•†å¹³å°åœ¨"åŒåä¸€"å¤§ä¿ƒæœŸé—´çªå‘CPUä½¿ç”¨ç‡100%å‘Šè­¦ï¼Œæ ¸å¿ƒäº¤æ˜“æ¥å£å“åº”å»¶è¿Ÿè¶…è¿‡5ç§’ã€‚è¿ç»´å›¢é˜Ÿéœ€è¦å¿«é€Ÿå®šä½é—®é¢˜æ ¹æºï¼Œæ­¤æ—¶é¢ä¸´ä¸¤ç§å·¥å…·é€‰æ‹©ï¼šä¼ ç»Ÿå‘½ä»¤è¡Œå·¥å…·<code>jstack</code>ä¸é˜¿é‡Œå¼€æºè¯Šæ–­å·¥å…·<code>Arthas</code>ã€‚æœ¬æ–‡å°†é€šè¿‡å®Œæ•´æ¡ˆä¾‹å¯¹æ¯”ä¸¤è€…çš„è¯Šæ–­æµç¨‹ä¸æ•ˆç‡å·®å¼‚ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€å·¥å…·ç‰¹æ€§å¯¹æ¯”çŸ©é˜µ</h2>



































<table><thead><tr><th>ç»´åº¦</th><th>jstack</th><th>Arthas</th></tr></thead><tbody><tr><td><strong>æ•°æ®è·å–æ–¹å¼</strong>â€‹</td><td>éœ€æ‰‹åŠ¨æ‰§è¡Œå‘½ä»¤ç”Ÿæˆå¿«ç…§æ–‡ä»¶</td><td>æ”¯æŒåŠ¨æ€å®æ—¶é‡‡æ ·ï¼ˆé‡‡æ ·é—´éš”å¯é…ç½®ï¼‰</td></tr><tr><td><strong>çº¿ç¨‹ä¿¡æ¯å®Œæ•´æ€§</strong>â€‹</td><td>ä»…æ˜¾ç¤ºçº¿ç¨‹çŠ¶æ€ä¸å †æ ˆ</td><td>é¢å¤–æä¾›CPUè€—æ—¶å æ¯”ã€é”ç«äº‰è¯¦æƒ…ã€æ–¹æ³•è°ƒç”¨è¿½è¸ªç­‰å¢å¼ºä¿¡æ¯</td></tr><tr><td><strong>äº¤äº’æ€§</strong>â€‹</td><td>ç¦»çº¿åˆ†æï¼ˆéœ€é…åˆæ–‡æœ¬å¤„ç†å·¥å…·ï¼‰</td><td>äº¤äº’å¼å‘½ä»¤è¡Œï¼ˆæ”¯æŒç®¡é“æ“ä½œã€æ­£åˆ™è¿‡æ»¤ï¼‰</td></tr><tr><td><strong>å­¦ä¹ æˆæœ¬</strong>â€‹</td><td>åŸºç¡€å‘½ä»¤æ˜“å­¦ï¼Œä½†é«˜çº§åˆ†æéœ€è„šæœ¬è¾…åŠ©</td><td>æä¾›ç±»Unixé£æ ¼å‘½ä»¤ä½“ç³»ï¼Œå†…ç½®å¸®åŠ©æ–‡æ¡£</td></tr><tr><td><strong>ç”Ÿäº§ç¯å¢ƒé€‚ç”¨æ€§</strong>â€‹</td><td>ä½ä¾µå…¥æ€§ï¼Œä½†éœ€åè°ƒè¿ç»´æƒé™</td><td>æ”¯æŒéä¾µå…¥å¼è¯Šæ–­ï¼ˆæ— éœ€é‡å¯åº”ç”¨ï¼‰</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-2">ä¸‰ã€å®æˆ˜æ¡ˆä¾‹ï¼šæ­»å¾ªç¯å¯¼è‡´çš„CPUé£™é«˜</h2>
<h3 data-id="heading-3">åœºæ™¯æè¿°</h3>
<p>æŸè®¢å•æœåŠ¡å‡ºç°å•èŠ‚ç‚¹CPU 100%å¼‚å¸¸ï¼Œä¸šåŠ¡é€»è¾‘ä¸­å­˜åœ¨å®šæ—¶ä»»åŠ¡ä»£ç ç¼ºé™·ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// é—®é¢˜ä»£ç ï¼šå®šæ—¶ä»»åŠ¡æœªæ­£ç¡®ç»ˆæ­¢</span>
ScheduledExecutorService scheduler = Executors<span class="hljs-selector-class">.newScheduledThreadPool</span>(<span class="hljs-number">1</span>);
scheduler<span class="hljs-selector-class">.scheduleAtFixedRate</span>(() -&gt; {
    <span class="hljs-built_in">while</span>(true) { <span class="hljs-comment">// æ­»å¾ªç¯</span>
        <span class="hljs-built_in">calculateOrderDiscount</span>(); 
    }
}, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, TimeUnit<span class="hljs-selector-class">.HOURS</span>);
</code></pre>
<hr/>
<h3 data-id="heading-4">å››ã€è¯Šæ–­æµç¨‹å¯¹æ¯”</h3>
<h4 data-id="heading-5">æ–¹æ¡ˆAï¼šjstackä¼ ç»Ÿè¯Šæ–­</h4>
<p><strong>æ­¥éª¤1ï¼šå®šä½Javaè¿›ç¨‹</strong></p>
<pre><code class="hljs language-perl" lang="perl">$ jps -l | <span class="hljs-keyword">grep</span> OrderService
<span class="hljs-number">12345</span> com.example.OrderService
</code></pre>
<p><strong>æ­¥éª¤2ï¼šæ•è·é«˜CPUçº¿ç¨‹</strong></p>
<pre><code class="hljs language-css" lang="css">$ <span class="hljs-attribute">top</span> -H -<span class="hljs-selector-tag">p</span> <span class="hljs-number">12345</span>
  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     <span class="hljs-selector-tag">TIME</span>+  COMMAND
<span class="hljs-number">12346</span> appuser   <span class="hljs-number">20</span>   <span class="hljs-number">0</span> <span class="hljs-number">3456789</span> <span class="hljs-number">123456</span>  <span class="hljs-number">98765</span> R  <span class="hljs-number">99.9</span>  <span class="hljs-number">1.2</span>   <span class="hljs-number">0</span>:<span class="hljs-number">10.01</span> java
</code></pre>
<p><strong>æ­¥éª¤3ï¼šè½¬æ¢çº¿ç¨‹ID</strong></p>
<pre><code class="hljs language-perl" lang="perl">$ <span class="hljs-keyword">printf</span> <span class="hljs-string">"%x\n"</span> <span class="hljs-number">12346</span>
c0a2
</code></pre>
<p><strong>æ­¥éª¤4ï¼šåˆ†æçº¿ç¨‹å¿«ç…§</strong></p>
<pre><code class="hljs language-perl" lang="perl">$ jstack <span class="hljs-number">12345</span> | <span class="hljs-keyword">grep</span> -A <span class="hljs-number">20</span> c0a2
<span class="hljs-string">"pool-1-thread-1"</span> <span class="hljs-comment">#1234 prio=5 os_prio=0 tid=0x00007f8b5c00f000 nid=0xc0a2 runnable [0x00007f8b54a9f000]</span>
   java.lang.Thread.State: RUNNABLE
        at com.example.OrderService.lambda$init$0(OrderService.java:<span class="hljs-number">42</span>)
        at com.example.OrderService$$Lambda$1/<span class="hljs-number">0x0000000800060840</span>.run(Unknown Source)
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:<span class="hljs-number">511</span>)
</code></pre>
<p><strong>å…³é”®å‘ç°</strong>ï¼šçº¿ç¨‹<code>pool-1-thread-1</code>åœ¨<code>OrderService.java:42</code>é™·å…¥æ­»å¾ªç¯</p>
<hr/>
<h4 data-id="heading-6">æ–¹æ¡ˆBï¼šArthasæ™ºèƒ½è¯Šæ–­</h4>
<p><strong>æ­¥éª¤1ï¼šåŠ¨æ€é™„åŠ è¯Šæ–­</strong></p>
<pre><code class="hljs language-scss" lang="scss">$ java -jar arthas-boot<span class="hljs-selector-class">.jar</span>
* <span class="hljs-selector-attr">[1]</span> com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.OrderService</span> (<span class="hljs-number">12345</span>)
  `--- attach success
</code></pre>
<p><strong>æ­¥éª¤2ï¼šå®æ—¶ç›‘æ§CPUçƒ­ç‚¹</strong></p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-attr">[arthas@12345]</span>(<span class="hljs-variable">@ref</span>)<span class="hljs-selector-tag">thread</span> <span class="hljs-selector-tag">-n</span> <span class="hljs-number">3</span>
"<span class="hljs-selector-tag">pool-1-thread-1</span>" <span class="hljs-selector-tag">Id</span>=<span class="hljs-number">1234</span> <span class="hljs-selector-tag">cpuUsage</span>=<span class="hljs-number">99.9%</span> <span class="hljs-selector-tag">deltaTime</span>=<span class="hljs-number">1000ms</span>
   <span class="hljs-selector-tag">at</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.OrderService</span><span class="hljs-selector-class">.lambda</span>$<span class="hljs-selector-tag">init</span>$<span class="hljs-number">0</span>(OrderService.<span class="hljs-attribute">java</span>:<span class="hljs-number">42</span>)
   <span class="hljs-selector-tag">at</span> <span class="hljs-selector-tag">java</span><span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.concurrent</span><span class="hljs-selector-class">.Executors</span>$<span class="hljs-selector-tag">RunnableAdapter</span><span class="hljs-selector-class">.call</span>(Executors.<span class="hljs-attribute">java</span>:<span class="hljs-number">511</span>)
</code></pre>
<p><strong>æ­¥éª¤3ï¼šæ·±åº¦æ–¹æ³•è¿½è¸ª</strong></p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-attr">[arthas@12345]</span>(<span class="hljs-variable">@ref</span>)<span class="hljs-selector-tag">trace</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.OrderService</span> <span class="hljs-selector-tag">calculateOrderDiscount</span>
<span class="hljs-selector-tag">TRACE</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.OrderService</span> <span class="hljs-selector-tag">calculateOrderDiscount</span>
`<span class="hljs-selector-tag">---ts</span>=<span class="hljs-number">2025</span><span class="hljs-selector-tag">-12-24</span> <span class="hljs-number">15</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>; <span class="hljs-selector-attr">[cost=1000000000]</span> <span class="hljs-selector-tag">result</span>=@<span class="hljs-selector-tag">Integer</span><span class="hljs-selector-attr">[0]</span>
   â””â”€<span class="hljs-selector-tag">java</span><span class="hljs-selector-class">.lang</span><span class="hljs-selector-class">.Thread</span><span class="hljs-selector-class">.sleep</span>(Native Method)
       â””â”€<span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.OrderService</span><span class="hljs-selector-class">.lambda</span>$<span class="hljs-selector-tag">init</span>$<span class="hljs-number">0</span>(OrderService.<span class="hljs-attribute">java</span>:<span class="hljs-number">42</span>)
</code></pre>
<p><strong>å…³é”®å‘ç°</strong>ï¼š<code>calculateOrderDiscount</code>æ–¹æ³•æŒç»­æ‰§è¡Œä¸”æ— ä¼‘çœ ï¼Œç»“åˆ<code>trace</code>ç»“æœç¡®è®¤æ­»å¾ªç¯</p>
<hr/>
<h2 data-id="heading-7">äº”ã€å·¥å…·ä¼˜åŠ¿æ·±åº¦è§£æ</h2>
<h3 data-id="heading-8">1. jstackçš„æ ¸å¿ƒä»·å€¼</h3>
<ul>
<li>
<p><strong>ç¦»çº¿åˆ†æèƒ½åŠ›</strong>ï¼šé€‚åˆéœ€è¦é•¿æœŸä¿å­˜è¯Šæ–­è®°å½•çš„åœºæ™¯</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç”Ÿæˆå¸¦æ—¶é—´æˆ³çš„è¯Šæ–­åŒ…</span>
jstack 12345 &gt; /var/log/jstack_$(<span class="hljs-built_in">date</span> +%s).<span class="hljs-built_in">log</span>
</code></pre>
</li>
<li>
<p><strong>æ‰¹é‡å¤„ç†æ”¯æŒ</strong>ï¼šå¯ç»“åˆ<code>ps</code>/<code>top</code>å®ç°è‡ªåŠ¨åŒ–ç›‘æ§è„šæœ¬</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-comment"># ç¤ºä¾‹ï¼šè‡ªåŠ¨æ•è·TOP3é«˜CPUçº¿ç¨‹</span>
top -H -b -n <span class="hljs-number">1</span> -p <span class="hljs-number">12345</span> | awk <span class="hljs-string">'/java/{print $1}'</span> | xargs -I{} <span class="hljs-keyword">printf</span> <span class="hljs-string">"%x\n"</span> {} | uni<span class="hljs-string">q | xargs -I{} jstack 12345 |</span> <span class="hljs-keyword">grep</span> -A <span class="hljs-number">20</span> {}
</code></pre>
</li>
</ul>
<h3 data-id="heading-9">2. Arthasçš„é©æ–°çªç ´</h3>
<ul>
<li>
<p><strong>å®æ—¶ç«ç„°å›¾ç”Ÿæˆ</strong>ï¼šå¯è§†åŒ–å‘ˆç°çƒ­ç‚¹æ–¹æ³•è°ƒç”¨é“¾</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-attr">[arthas@12345]</span>(<span class="hljs-variable">@ref</span>)<span class="hljs-selector-tag">profiler</span> <span class="hljs-selector-tag">start</span> <span class="hljs-selector-tag">--event</span> <span class="hljs-selector-tag">cpu</span> <span class="hljs-selector-tag">--interval</span> <span class="hljs-number">1000</span>
<span class="hljs-selector-attr">[arthas@12345]</span>(<span class="hljs-variable">@ref</span>)<span class="hljs-selector-tag">profiler</span> <span class="hljs-selector-tag">stop</span> <span class="hljs-selector-tag">--file</span> <span class="hljs-selector-tag">cpu_profile</span><span class="hljs-selector-class">.svg</span>
</code></pre>
</li>
<li>
<p><strong>æ™ºèƒ½è¿‡æ»¤æœºåˆ¶</strong>ï¼šé€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ç²¾å‡†å®šä½é—®é¢˜ä»£ç </p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-attr">[arthas@12345]</span>(<span class="hljs-variable">@ref</span>)<span class="hljs-selector-tag">thread</span> <span class="hljs-selector-tag">-n</span> <span class="hljs-number">5</span> <span class="hljs-selector-tag">--state</span> <span class="hljs-selector-tag">RUNNABLE</span> | <span class="hljs-selector-tag">grep</span> <span class="hljs-selector-tag">-E</span> '<span class="hljs-selector-tag">calculate</span>|<span class="hljs-selector-tag">discount</span>'
</code></pre>
</li>
<li>
<p><strong>åŠ¨æ€çƒ­æ›´æ–°</strong>ï¼šæ— éœ€é‡å¯å³å¯ä¿®å¤é—®é¢˜ï¼ˆéœ€é…åˆJVMå‚æ•°ï¼‰</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-attr">[arthas@12345]</span>(<span class="hljs-variable">@ref</span>)<span class="hljs-selector-tag">jad</span> <span class="hljs-selector-tag">--source-only</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.OrderService</span> &gt; <span class="hljs-selector-tag">OrderService</span><span class="hljs-selector-class">.java</span>
# ä¿®æ”¹ä»£ç åçƒ­æ›´æ–°
<span class="hljs-selector-attr">[arthas@12345]</span>(<span class="hljs-variable">@ref</span>)<span class="hljs-selector-tag">redefine</span> <span class="hljs-selector-tag">OrderService</span><span class="hljs-selector-class">.java</span>
</code></pre>
</li>
</ul>
<hr/>
<h2 data-id="heading-10">å…­ã€é€‚ç”¨åœºæ™¯å†³ç­–æ ‘</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fdd482c4079d42329ac0a59147418539~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSVTmqZjlrZDnmq4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767233408&amp;x-signature=HQAz9pKk3pJ7r9m5aLSN170gSeQ%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-11">ä¸ƒã€ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ</h2>
<ol>
<li>
<p><strong>é˜²å¾¡æ€§é…ç½®</strong>â€‹</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Arthaså®‰å…¨åŠ å›º</span>
java -jar arthas-boot.jar --tunnel-server ws://arthas.example.com
</code></pre>
</li>
<li>
<p><strong>ç›‘æ§ä½“ç³»æ•´åˆ</strong>â€‹</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># Prometheusç›‘æ§é…ç½®</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">job_name:</span> <span class="hljs-string">'arthas-profiler'</span>
  <span class="hljs-attr">static_configs:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">targets:</span> [<span class="hljs-string">'127.0.0.1:9090'</span>]
  <span class="hljs-attr">metrics_path:</span> <span class="hljs-string">'/actuator/prometheus'</span>
</code></pre>
</li>
<li>
<p><strong>æ•…éšœæ¼”ç»ƒæœºåˆ¶</strong>â€‹</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ¨¡æ‹ŸCPUé£™é«˜åœºæ™¯</span>
stress-ng --cpu 4 --<span class="hljs-built_in">timeout</span> 60s
</code></pre>
</li>
</ol>
<hr/>
<h2 data-id="heading-12">å…«ã€æ€»ç»“ï¼šå·¥å…·é€‰æ‹©çš„é»„é‡‘æ³•åˆ™</h2>
<ul>
<li>
<p><strong>ä¼˜å…ˆArthasçš„åœºæ™¯</strong>ï¼š</p>
<p>éœ€è¦å®æ—¶äº¤äº’ã€å¿«é€Ÿå®šä½ã€å¤æ‚è°ƒç”¨é“¾åˆ†æçš„ç”Ÿäº§ç¯å¢ƒæ•…éšœ</p>
</li>
<li>
<p><strong>é€‰æ‹©jstackçš„åœºæ™¯</strong>ï¼š</p>
<p>éœ€è¦é•¿æœŸå­˜æ¡£è¯Šæ–­è®°å½•ã€é…åˆCI/CDæµæ°´çº¿è¿›è¡Œæ‰¹é‡åˆ†æçš„åœºæ™¯</p>
</li>
</ul>
<p><strong>ç»ˆæå»ºè®®</strong>ï¼šåœ¨å¾®æœåŠ¡æ¶æ„ä¸‹ï¼Œæ¨èé‡‡ç”¨Arthas+Prometheus+ELKçš„ç«‹ä½“ç›‘æ§ä½“ç³»ï¼Œå®ç°ä»é—®é¢˜å‘ç°åˆ°æ ¹å› åˆ†æçš„é—­ç¯ã€‚å¯¹äºæ ¸å¿ƒäº¤æ˜“ç³»ç»Ÿï¼Œåº”å»ºç«‹Arthasçš„è‡ªåŠ¨åŒ–è¯Šæ–­é¢„æ¡ˆï¼Œç¡®ä¿é»„é‡‘æ•‘æ´æ—¶é—´çš„æœ‰æ•ˆåˆ©ç”¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Apache Paimon å¤šæ¨¡æ€æ•°æ®æ¹–å®è·µï¼šä»ç»“æ„åŒ–åˆ°éç»“æ„åŒ–çš„æŠ€æœ¯æ¼”è¿›]]></title>    <link>https://juejin.cn/post/7587327550873632768</link>    <guid>https://juejin.cn/post/7587327550873632768</guid>    <pubDate>2025-12-25T07:25:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587327550873632768" data-draft-id="7587334152871018536" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Apache Paimon å¤šæ¨¡æ€æ•°æ®æ¹–å®è·µï¼šä»ç»“æ„åŒ–åˆ°éç»“æ„åŒ–çš„æŠ€æœ¯æ¼”è¿›"/> <meta itemprop="keywords" content="å¤§æ•°æ®,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-25T07:25:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿é‡Œäº‘å¤§æ•°æ®AIæŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/2414974667341287"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Apache Paimon å¤šæ¨¡æ€æ•°æ®æ¹–å®è·µï¼šä»ç»“æ„åŒ–åˆ°éç»“æ„åŒ–çš„æŠ€æœ¯æ¼”è¿›
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2414974667341287/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿é‡Œäº‘å¤§æ•°æ®AIæŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T07:25:55.000Z" title="Thu Dec 25 2025 07:25:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨è¿‘æœŸçš„Â StreamingÂ LakehouseÂ MeetupÂ Â·Â OnlineÂ EP.2ï½œPaimonÂ Ã—Â StarRocksÂ å…±è¯å®æ—¶æ¹–ä»“Â ç›´æ’­ä¸­ï¼ŒApacheÂ PaimonÂ PMCÂ æˆå‘˜/é˜¿é‡Œäº‘æ•°æ®æ¹–èµ„æ·±å·¥ç¨‹å¸ˆå¶ä¿Šè±ªå¸¦æ¥äº†å…³äºÂ PaimonÂ å¤šæ¨¡æ€æ•°æ®æ¹–çš„æ·±åº¦æŠ€æœ¯åˆ†äº«ã€‚</p>
<p>éšç€å¤§æ¨¡å‹è®­ç»ƒå¯¹æ•°æ®è§„æ¨¡ä¸å¤šæ ·æ€§çš„è¦æ±‚ä¸æ–­æå‡ï¼Œä¼ ç»Ÿä»¥æ‰¹å¤„ç†ä¸ºä¸­å¿ƒçš„æ•°æ®æ¹–æ¶æ„å·²éš¾ä»¥æ»¡è¶³Â AIÂ å·¥ä½œè´Ÿè½½å¯¹å®æ—¶æ€§ã€çµæ´»æ€§å’Œæˆæœ¬æ•ˆç‡çš„ç»¼åˆéœ€æ±‚ã€‚ç‰¹åˆ«æ˜¯åœ¨æ¨èç³»ç»Ÿã€AIGCÂ ç­‰å…¸å‹åœºæ™¯ä¸­ï¼Œå·¥ç¨‹å¸ˆæ—¢è¦é«˜é¢‘è¿­ä»£ç»“æ„åŒ–ç‰¹å¾ï¼Œåˆè¦é«˜æ•ˆç®¡ç†å›¾åƒã€éŸ³é¢‘ã€è§†é¢‘ç­‰éç»“æ„åŒ–æ•°æ®ã€‚é¢å¯¹è¿™ä¸€æŒ‘æˆ˜ï¼ŒPaimonÂ ä½œä¸ºæ–°ä¸€ä»£æµå¼æ•°æ®æ¹–å­˜å‚¨å¼•æ“ï¼Œæ­£é€šè¿‡ä¸€ç³»åˆ—åº•å±‚åˆ›æ–°ï¼Œæ„å»ºé¢å‘Â AIÂ åŸç”Ÿæ—¶ä»£çš„ç»Ÿä¸€æ•°æ®åŸºç¡€è®¾æ–½ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ç»“æ„åŒ–åœºæ™¯ä¸‹çš„â€œåˆ—å˜æ›´â€å›°å¢ƒ</h2>
<p>åœ¨æ¨èã€å¹¿å‘Šç­‰Â AIÂ åº”ç”¨ä¸­ï¼Œç‰¹å¾å·¥ç¨‹æ˜¯ä¸€ä¸ªæŒç»­æ¼”è¿›çš„è¿‡ç¨‹ã€‚ä¾‹å¦‚ï¼Œç”µå•†å›¢é˜Ÿå¯èƒ½ä»Šå¤©æ–°å¢â€œç”¨æˆ·è¿‘7æ—¥ç‚¹å‡»å“ç±»åˆ†å¸ƒâ€ï¼Œæ˜å¤©åˆåŠ å…¥â€œè·¨ç«¯è¡Œä¸ºä¸€è‡´æ€§è¯„åˆ†â€ã€‚è¿™ç§åŠ¨æ€åˆ—å˜æ›´å¯¼è‡´â€œåˆ—çˆ†ç‚¸â€é—®é¢˜ï¼šè¡¨ç»“æ„é¢‘ç¹æ‰©å±•ï¼Œè€Œå†å²æ•°æ®éœ€ä¸æ–°ç‰¹å¾å¯¹é½ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/10f4b24ea2ab4ba2906ce57f2a80e5dd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5aSn5pWw5o2uQUnmioDmnK8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767252355&amp;x-signature=ENoCp4PkKjbCagSXgtplA1YCh8c%3D" alt="image.png" loading="lazy"/></p>
<p>ç„¶è€Œï¼Œå·²çŸ¥çš„è§£å†³æ–¹æ¡ˆåœ¨æ­¤åœºæ™¯ä¸‹ä»ç„¶å­˜åœ¨ä¸€äº›é—®é¢˜ï¼š</p>
<ul>
<li>
<p><strong>ä¸»é”®è¡¨Â partial-update</strong>ï¼šè™½æ”¯æŒæŒ‰ä¸»é”®æ›´æ–°éƒ¨åˆ†åˆ—ï¼Œä½†å…¶åŸºäºÂ LSMÂ æ ‘çš„å®ç°ä¼šåœ¨å†™å…¥é¢‘ç¹æ—¶äº§ç”Ÿå¤§é‡å°æ–‡ä»¶ï¼ŒæŸ¥è¯¢æ€§èƒ½æ€¥å‰§ä¸‹é™ï¼›CompactionÂ è™½å¯åˆå¹¶æ–‡ä»¶ï¼Œå´å¸¦æ¥æ•°å€çš„ä¸´æ—¶å­˜å‚¨å¼€é”€ã€‚</p>
</li>
<li>
<p><strong>odpsÂ å­˜æ–°ç‰¹å¾å€¼Â +Â JoinÂ æ‹¼æ¥æ–¹æ¡ˆ</strong>ï¼šå°†æ–°ç‰¹å¾å†™å…¥ç‹¬ç«‹è¡¨ï¼ŒæŸ¥è¯¢æ—¶é€šè¿‡ä¸»é”®Â JoinÂ åˆå¹¶ã€‚çœ‹ä¼¼é¿å…äº†é‡å†™ï¼Œä½†Â JoinÂ æ“ä½œæœ¬èº«åœ¨Â PBÂ çº§æ•°æ®ä¸Šå¼€é”€å·¨å¤§ï¼Œä¸”éš¾ä»¥ä¼˜åŒ–ã€‚</p>
</li>
<li>
<p><strong>AppendÂ è¡¨Â +Â MERGEÂ INTO</strong>ï¼šSQLÂ è¯­æ³•ç®€æ´ï¼Œä½†åº•å±‚ä»éœ€é‡å†™æ•´ä¸ªæ•°æ®æ–‡ä»¶ã€‚å¯¹äºæ¯å¤©å¢é‡è¾¾Â PBÂ çº§çš„è®­ç»ƒé›†ï¼Œå…¨é‡é‡å†™ä¸ä»…æˆæœ¬é«˜æ˜‚ï¼Œè¿˜æ˜¾è‘—æ‹–æ…¢ç‰¹å¾ä¸Šçº¿å‘¨æœŸã€‚</p>
</li>
</ul>
<p>è¿™äº›æ–¹æ¡ˆæœ¬è´¨ä¸Šéƒ½æœªèƒ½è§£è€¦â€œåˆ—â€çš„ç‰©ç†å­˜å‚¨ï¼Œå¯¼è‡´çµæ´»æ€§ä¸æ•ˆç‡ä¸å¯å…¼å¾—ã€‚</p>
<h2 data-id="heading-1">äºŒã€PaimonÂ çš„åˆ—åˆ†ç¦»æ¶æ„ï¼šä»¥å…¨å±€Â RowÂ IDÂ ä¸ºæ ¸å¿ƒ</h2>
<p>PaimonÂ æå‡ºäº†Â <strong>åˆ—åˆ†ç¦»å­˜å‚¨æ¶æ„</strong>ï¼Œå…¶æ ¸å¿ƒæ˜¯å¼•å…¥Â <strong>å…¨å±€å”¯ä¸€ä¸”è¿ç»­çš„Â RowÂ ID</strong>ã€‚æ¯è¡Œæ•°æ®åœ¨é¦–æ¬¡å†™å…¥æ—¶è¢«åˆ†é…ä¸€ä¸ªåœ¨æ•´ä¸ªè¡¨ç”Ÿå‘½å‘¨æœŸå†…ä¸å˜çš„Â IDï¼Œä¸”æ¯ä¸ªæ•°æ®æ–‡ä»¶å†…çš„Â RowÂ IDÂ æ˜¯è¿ç»­çš„ï¼Œå…ƒæ•°æ®ä¼šè®°å½•è¯¥æ–‡ä»¶çš„èµ·å§‹Â RowÂ IDã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2559e2a802084e918c59aab059cdf8cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5aSn5pWw5o2uQUnmioDmnK8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767252355&amp;x-signature=iahpSAOct7SlKd%2BARqCqv%2Fv4N58%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™ä¸€è®¾è®¡å¸¦æ¥ä¸¤ä¸ªå…³é”®èƒ½åŠ›ï¼š</p>
<ol>
<li>
<p><strong>ç²¾å‡†å®šä½ä»»æ„è¡Œ</strong>ï¼šé€šè¿‡Â RowÂ IDÂ å¯ç›´æ¥å®šä½åˆ°å…·ä½“æ–‡ä»¶åŠåç§»ï¼›</p>
</li>
<li>
<p><strong>è·¨æ–‡ä»¶è‡ªåŠ¨å…³è”</strong>ï¼šå½“æŸ¥è¯¢æ¶‰åŠå¤šä¸ªåˆ—æ—¶ï¼Œç³»ç»Ÿèƒ½æ ¹æ®Â RowÂ IDÂ èŒƒå›´è‡ªåŠ¨å°†åˆ†æ•£åœ¨ä¸åŒæ–‡ä»¶ä¸­çš„åˆ—æ•°æ®åœ¨å­˜å‚¨å±‚åˆå¹¶ã€‚</p>
</li>
</ol>
<p>ä¾‹å¦‚ï¼Œå½“æ–°å¢â€œç”¨æˆ·å…´è¶£æ ‡ç­¾â€åˆ—æ—¶ï¼ŒPaimonÂ ä»…éœ€å†™å…¥ä¸€ä¸ªåŒ…å«è¯¥åˆ—ä¸å¯¹åº”Â RowÂ IDÂ çš„æ–°æ–‡ä»¶ï¼Œæ— éœ€ä¿®æ”¹åŸå§‹ç‰¹å¾æ–‡ä»¶ã€‚æŸ¥è¯¢æ—¶ï¼Œå¼•æ“é€æ˜åœ°å°†ä¸¤ç»„æ–‡ä»¶æŒ‰Â RowÂ IDÂ å¯¹é½åˆå¹¶ï¼Œ<strong>æ— éœ€Â SQLÂ å±‚Â Joinï¼Œä¹Ÿæ— éœ€é‡å†™å†å²æ•°æ®</strong>ã€‚è¿™ç§æœºåˆ¶å°†åˆ—å˜æ›´çš„å­˜å‚¨æˆæœ¬ä»Â O(N)Â é™è‡³Â O(Î”N)ï¼Œæå¤§æå‡äº†ç‰¹å¾è¿­ä»£æ•ˆç‡ï¼ŒåŒæ—¶èŠ‚çœäº†æ•°åå€çš„å­˜å‚¨ç©ºé—´ã€‚</p>
<h2 data-id="heading-2">ä¸‰ã€è¿ˆå‘å¤šæ¨¡æ€ï¼šBlobÂ æ•°æ®ç±»å‹çš„ä¸‰å¤§çªç ´</h2>
<p>AIÂ è®­ç»ƒä¸å†å±€é™äºç»“æ„åŒ–ç‰¹å¾ã€‚AIGCã€å¤šæ¨¡æ€å¤§æ¨¡å‹ç­‰åœºæ™¯è¦æ±‚æ•°æ®æ¹–èƒ½é«˜æ•ˆå¤„ç†å›¾åƒã€çŸ­è§†é¢‘ã€é•¿éŸ³é¢‘ç­‰éç»“æ„åŒ–æ•°æ®ã€‚è¿™ç±»æ•°æ®å…·æœ‰ä¸¤å¤§ç‰¹ç‚¹ï¼š<strong>ä½“ç§¯å·®å¼‚å¤§</strong>ï¼ˆå‡ Â MBÂ åˆ°æ•°åÂ GBï¼‰ã€<strong>è®¿é—®ç¨€ç–</strong>ï¼ˆè®­ç»ƒæ—¶é€šå¸¸åªè¯»å–ç‰‡æ®µï¼‰ã€‚</p>
<p>ä¼ ç»Ÿåˆ—å¼æ ¼å¼ï¼ˆå¦‚Â Parquetï¼‰å°†å¤šæ¨¡æ€æ•°æ®ä¸ç»“æ„åŒ–å­—æ®µæ··å­˜ï¼Œå¯¼è‡´å³ä½¿åªæŸ¥ç”¨æˆ·Â IDï¼Œä¹Ÿéœ€åŠ è½½æ•´ä¸ªå«è§†é¢‘çš„å¤§æ–‡ä»¶ï¼ŒI/OÂ æ•ˆç‡æä½ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d52fdfd1ce1b4c3b907aabcf28493425~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5aSn5pWw5o2uQUnmioDmnK8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767252355&amp;x-signature=HCCRmlF9DFeIUKtOG4qtJqi3fps%3D" alt="image.png" loading="lazy"/></p>
<p>PaimonÂ å¼•å…¥Â <strong>BlobÂ æ•°æ®ç±»å‹</strong>ï¼Œå®ç°ä¸‰å¤§çªç ´ï¼š</p>
<ol>
<li>
<p><strong>ç‰©ç†åˆ†ç¦»å­˜å‚¨</strong>ï¼šBlobÂ åˆ—ç‹¬ç«‹æˆæ–‡ä»¶ï¼Œä¸ç»“æ„åŒ–æ•°æ®å®Œå…¨è§£è€¦ã€‚æŸ¥è¯¢ç»“æ„åŒ–å­—æ®µæ—¶ï¼ŒBlobÂ æ–‡ä»¶å®Œå…¨ä¸å‚ä¸Â I/Oï¼Œé¿å…èµ„æºæµªè´¹ã€‚</p>
</li>
<li>
<p><strong>å¤šå¼•æ“ç»Ÿä¸€æŠ½è±¡</strong>ï¼šæ— è®ºä½¿ç”¨Â Sparkã€Flinkã€JavaÂ SDKÂ è¿˜æ˜¯Â PythonÂ å®¢æˆ·ç«¯ï¼Œå‡å¯é€šè¿‡æ ‡å‡†çš„Â <code>BYTES</code>Â æˆ–Â <code>BINARY</code>Â æˆ–Â BLOBÂ ç±»å‹å®šä¹‰Â BlobÂ å­—æ®µï¼Œæ¥å£ä¸€è‡´ï¼Œé™ä½æ¥å…¥æˆæœ¬ã€‚</p>
</li>
<li>
<p><strong>blob-as-descriptorÂ æœºåˆ¶</strong>ï¼šé’ˆå¯¹è¶…å¤§éç»“æ„åŒ–æ•°æ®ï¼ˆå¦‚åå‡ GBçš„è§†é¢‘/æ—¥å¿—æ–‡ä»¶ï¼‰ï¼Œä¼ ç»Ÿè®¡ç®—å¼•æ“ï¼ˆå¦‚Flink/Sparkï¼‰æ— æ³•å°†å…¶å…¨é‡åŠ è½½åˆ°å†…å­˜ä¸­å¤„ç†ã€‚ä¸ºæ­¤ï¼Œç³»ç»Ÿå¼•å…¥äº†Â blob-as-descriptorÂ æœºåˆ¶â€”â€”å®ƒæ˜¯ä¸€ç§åè®®ï¼Œé€šè¿‡è®°å½•æ•°æ®åœ¨å¤–éƒ¨å­˜å‚¨ï¼ˆå¦‚OSSï¼‰ä¸­çš„ä½ç½®ã€æ–‡ä»¶è·¯å¾„ã€èµ·å§‹åç§»å’Œé•¿åº¦ç­‰å…ƒä¿¡æ¯ï¼Œå°†å®é™…æ•°æ®è¯»å–ä»»åŠ¡äº¤ç»™ä¸‹æ¸¸ç³»ç»ŸæŒ‰éœ€æµå¼åŠ è½½ã€‚è¿™æ ·é¿å…äº†å†…å­˜æº¢å‡ºï¼Œå®ç°äº†å¤§æ–‡ä»¶é«˜æ•ˆå…¥æ¹–ã€‚</p>
</li>
</ol>
<h2 data-id="heading-3">å››ã€ç”Ÿäº§éªŒè¯ä¸æœªæ¥æ¼”è¿›</h2>
<p>å½“å‰ï¼ŒPaimonÂ BlobÂ å·²åœ¨æ·˜å®ã€å¤©çŒ«ç­‰æ ¸å¿ƒä¸šåŠ¡ä¸­å®ç°å¤§è§„æ¨¡è½åœ°ï¼Œæ¯å¤©æœ‰è¿‘Â 10PBÂ çš„å¤šæ¨¡æ€æ•°æ®ï¼ˆå¦‚è§†é¢‘ã€éŸ³é¢‘ã€å›¾åƒï¼‰é€šè¿‡Â BlobÂ DescriptorÂ åè®®é«˜æ•ˆå†™å…¥Â PaimonÂ æ¹–ï¼Œé¿å…äº†Â FlinkÂ æˆ–Â SparkÂ å°†å¤§æ–‡ä»¶å…¨é‡åŠ è½½åˆ°å†…å­˜çš„é—®é¢˜ã€‚ç„¶è€Œï¼Œåœ¨å®é™…ä½¿ç”¨ä¸­ä»é¢ä¸´ä¸‰å¤§å…³é”®æŒ‘æˆ˜ï¼š</p>
<ul>
<li>
<p><strong>æ•°æ®é‡å¤ä¸åˆ é™¤é—®é¢˜</strong>ï¼Œç”¨æˆ·å¸¸å› å¤šæ¬¡ä¸Šä¼ ç›¸åŒå†…å®¹å¯¼è‡´å¤§é‡å†—ä½™ï¼ˆé¢„ä¼°çº¦Â 1PB/å¤©çš„é‡å¤æ•°æ®ï¼‰ï¼ŒäºŸéœ€é«˜æ•ˆçš„å»é‡ä¸åˆ é™¤æœºåˆ¶ï¼›</p>
</li>
<li>
<p><strong>å°æ–‡ä»¶ç¢ç‰‡åŒ–é—®é¢˜</strong>ï¼Œé¢‘ç¹çš„å°è§„æ¨¡å†™å…¥äº§ç”Ÿæµ·é‡å¾®å°Â BlobÂ æ–‡ä»¶ï¼Œä¸¥é‡å½±å“è¯»å–æ€§èƒ½å’Œå­˜å‚¨æ•ˆç‡ï¼›</p>
</li>
<li>
<p><strong>ç‚¹æŸ¥å¬å›å»¶è¿Ÿé«˜</strong>ï¼Œç¼ºä¹å¯¹ä¸»é”®ï¼ˆå¦‚Â UIDï¼‰æˆ–å‘é‡ç‰¹å¾çš„å¿«é€Ÿç´¢å¼•æ”¯æŒï¼Œéš¾ä»¥æ»¡è¶³æ¯«ç§’çº§å®æ—¶æŸ¥è¯¢éœ€æ±‚ã€‚</p>
</li>
</ul>
<p>é’ˆå¯¹ä¸Šè¿°é—®é¢˜ï¼Œå›¢é˜Ÿå·²è§„åˆ’æ¸…æ™°çš„æ¼”è¿›è·¯å¾„ã€‚</p>
<ul>
<li>
<p><strong>ç‚¹æŸ¥æ€§èƒ½ä¼˜åŒ–</strong>æ–¹é¢ï¼Œæ¨è¿›çƒ­Â IDÂ ä¸‹æ¨èƒ½åŠ›ï¼Œå¹¶æ„å»ºç»Ÿä¸€çš„<strong>å…¨å±€ç´¢å¼•æ¡†æ¶</strong>ï¼ŒåŒæ—¶æ”¯æŒæ ‡é‡ç´¢å¼•ï¼ˆå¦‚å­—ç¬¦ä¸²ã€æ•°å€¼ï¼‰å’Œå‘é‡ç´¢å¼•ï¼ˆç”¨äºÂ AIÂ å¬å›ï¼‰ï¼Œå…¶ä¸­åŸºç¡€ç‰ˆæ ‡é‡ç´¢å¼•é¢„è®¡æœ¬æœˆåœ¨å¼€æºÂ MasterÂ åˆ†æ”¯å¯ç”¨ã€‚</p>
</li>
<li>
<p><strong>å¤šæ¨¡æ€æ•°æ®ç®¡ç†</strong>æ–¹é¢ï¼Œå¯åŠ¨ä¸¤é¡¹æ ¸å¿ƒåŠŸèƒ½ï¼š</p>
<ul>
<li>
<p>ä¸€æ˜¯åŸºäºÂ <strong>DeletionÂ VectorÂ +Â å ä½ç¬¦</strong>Â çš„é€»è¾‘åˆ é™¤æ–¹æ¡ˆï¼Œåœ¨Â CompactionÂ é˜¶æ®µå®‰å…¨æ¸…ç†é‡å¤æˆ–æ— æ•ˆæ•°æ®ï¼›</p>
</li>
<li>
<p>äºŒæ˜¯å¼€å‘Â <strong>BlobÂ CompactionÂ æœºåˆ¶</strong>ï¼Œè‡ªåŠ¨åˆå¹¶å°æ–‡ä»¶ä»¥æå‡è¯»æ€§èƒ½å’Œå­˜å‚¨å¯†åº¦ã€‚</p>
</li>
</ul>
</li>
</ul>
<p>æ­¤å¤–ï¼Œå›¢é˜Ÿè¿˜å‰ç»æ€§åœ°æå‡º<strong>è·¨è¡¨Â BlobÂ å¤ç”¨</strong>çš„æ„æƒ³â€”â€”å¤šä¸ªè¡¨å¼•ç”¨åŒä¸€è§†é¢‘æ—¶ä»…å­˜å‚¨ä¸€ä»½ç‰©ç†æ•°æ®ï¼Œè™½å› æ¶‰åŠå¤šè¡¨çŠ¶æ€åŒæ­¥ä¸ä¸€è‡´æ€§ä¿éšœè€ŒæŠ€æœ¯éš¾åº¦è¾ƒé«˜ï¼Œä½†å·²åˆ—å…¥é•¿æœŸä¼˜åŒ–æ–¹å‘ã€‚æ•´ä½“ç›®æ ‡æ˜¯æ‰“é€ ä¸€ä¸ªé«˜æ•ˆã€ç´§å‡‘ã€å¯å¿«é€Ÿæ£€ç´¢çš„å¤šæ¨¡æ€æ•°æ®æ¹–åº•åº§ï¼Œæ”¯æ’‘æœªæ¥Â AIGCÂ ä¸æ™ºèƒ½æ¨èç­‰åœºæ™¯çš„è§„æ¨¡åŒ–åº”ç”¨ã€‚</p>
<h2 data-id="heading-4">ç»“è¯­</h2>
<p>PaimonÂ çš„æŠ€æœ¯æ¼”è¿›ï¼Œä»ç»“æ„åŒ–åœºæ™¯çš„åˆ—åˆ†ç¦»ï¼Œåˆ°å¤šæ¨¡æ€æ•°æ®çš„Â BlobÂ æŠ½è±¡ï¼Œæ¯ä¸€é¡¹åˆ›æ–°éƒ½æºäºçœŸå®ä¸šåŠ¡ç—›ç‚¹ï¼Œå¹¶åå“ºäºå·¥ç¨‹æ•ˆç‡çš„æå‡ã€‚å®ƒä¸å†åªæ˜¯â€œå­˜å‚¨æ•°æ®çš„åœ°æ–¹â€ï¼Œè€Œæ˜¯æˆä¸ºÂ <strong>AIÂ åŸç”Ÿæ—¶ä»£çš„æ•°æ®æ“ä½œç³»ç»Ÿ</strong>â€”â€”é«˜æ•ˆã€çµæ´»ã€æ™ºèƒ½ã€‚</p>
<p>PaimonÂ å°†é•¿æœŸã€æŒç»­ä¸”å¤§åŠ›æŠ•å…¥å…¨æ¨¡æ€æ•°æ®æ¹–å»ºè®¾ï¼Œå…¨é¢æ”¯æŒå›¾åƒã€éŸ³è§†é¢‘ç­‰éç»“æ„åŒ–æ•°æ®çš„é«˜æ•ˆå…¥æ¹–ã€å»é‡ã€åˆå¹¶ä¸æ¯«ç§’çº§ç‚¹æŸ¥ã€‚é€šè¿‡Â DeletionÂ Vectorã€CompactionÂ ä¼˜åŒ–å’Œå…¨å±€ç´¢å¼•ç­‰èƒ½åŠ›ï¼ŒPaimonÂ æ­£æ„å»ºé¢å‘Â AIÂ æ—¶ä»£çš„ç»Ÿä¸€æ•°æ®åº•åº§ã€‚ä½œä¸ºå¼€æ”¾æ¹–è¡¨æ ¼å¼ã€‚</p>
<p>é˜¿é‡Œäº‘DLFÂ åœ¨äº‘ä¸Šæä¾›å…¨æ‰˜ç®¡çš„Paimonå­˜å‚¨æœåŠ¡ï¼Œæ”¯æŒPaimonçš„æ™ºèƒ½å­˜å‚¨ä¼˜åŒ–ä¸å†·çƒ­åˆ†å±‚ã€‚åŒæ—¶ï¼ŒDLFæä¾›å®‰å…¨ã€å¼€æ”¾ã€æ”¯æŒå…¨æ¨¡æ€æ•°æ®çš„ä¸€ä½“åŒ–Lakehouseç®¡ç†å¹³å°ï¼Œæ·±åº¦èå…¥å…¼å®¹å…¶ä»–ä¾‹å¦‚Â Icebergã€LanceÂ ç­‰ä¸»æµæ ¼å¼ï¼Œæ— ç¼å¯¹æ¥Â Flinkã€SparkÂ ç­‰è®¡ç®—å¼•æ“ï¼Œï¼Œä¸ºÂ AIGCÂ ä¸å¤šæ¨¡æ€æ™ºèƒ½åº”ç”¨æä¾›é«˜æ€§èƒ½ã€ä½æˆæœ¬ã€æ˜“æ²»ç†çš„æ•°æ®åŸºç¡€è®¾æ–½ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f146b9b56ca34428a90125a1ed1a26ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5aSn5pWw5o2uQUnmioDmnK8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767252355&amp;x-signature=Rmb%2FiiPVpS980qzGO6L%2F3aVDnck%3D" alt="image.png" loading="lazy"/></p>
<p>åœ¨æ•°æ®é©±åŠ¨çš„Â AIÂ æ—¶ä»£ï¼ŒåŸºç¡€è®¾æ–½çš„ä»·å€¼ï¼Œæœ€ç»ˆè¦ä½“ç°åœ¨å¯¹ä¸šåŠ¡æ•ˆç‡çš„å®è´¨æ€§æ¨åŠ¨ä¸Šã€‚Â PaimonÂ çš„å®è·µï¼Œæ­£ä¸ºæ•´ä¸ªè¡Œä¸šæä¾›ä¸€æ¡é€šå¾€é«˜æ•ˆã€ç»Ÿä¸€ã€æ™ºèƒ½æ•°æ®æ¹–çš„æ–°è·¯å¾„ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤§æ¨¡å‹åŸç†å‰–æâ€”â€”å¤šå¤´å¹¶è¡Œ + æ½œå˜é‡ååŒï¼šåŸç†ã€åº”ç”¨ä¸éƒ¨ç½²ä¼˜åŒ–]]></title>    <link>https://juejin.cn/post/7587334152870477864</link>    <guid>https://juejin.cn/post/7587334152870477864</guid>    <pubDate>2025-12-25T05:42:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587334152870477864" data-draft-id="7587322796825985064" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤§æ¨¡å‹åŸç†å‰–æâ€”â€”å¤šå¤´å¹¶è¡Œ + æ½œå˜é‡ååŒï¼šåŸç†ã€åº”ç”¨ä¸éƒ¨ç½²ä¼˜åŒ–"/> <meta itemprop="keywords" content="ç®—æ³•"/> <meta itemprop="datePublished" content="2025-12-25T05:42:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‰¾é†’"/> <meta itemprop="url" content="https://juejin.cn/user/708512558088669"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤§æ¨¡å‹åŸç†å‰–æâ€”â€”å¤šå¤´å¹¶è¡Œ + æ½œå˜é‡ååŒï¼šåŸç†ã€åº”ç”¨ä¸éƒ¨ç½²ä¼˜åŒ–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/708512558088669/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‰¾é†’
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T05:42:20.000Z" title="Thu Dec 25 2025 05:42:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    15
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>â€œå¤šå¤´å¹¶è¡Œ+æ½œå˜é‡ååŒâ€æ˜¯æ·±åº¦å­¦ä¹ æ³¨æ„åŠ›æœºåˆ¶çš„æ ¸å¿ƒè¿›é˜¶æ¶æ„ï¼Œé€šè¿‡â€œå¤šç»´åº¦å¹¶è¡ŒæŒ–æ˜â€ä¸â€œéšæ€§ç‰¹å¾ååŒèåˆâ€ï¼Œçªç ´å•ä¸€æ³¨æ„åŠ›å¤´çš„è¡¨è¾¾ç“¶é¢ˆï¼Œé«˜æ•ˆæ•æ‰æ•°æ®ä¸­çš„å¤æ‚å…³è”ï¼ˆå¦‚è¯­ä¹‰ã€æ—¶åºã€ç‰¹å¾ä¾èµ–ï¼‰ã€‚å…¶è®¾è®¡ç†å¿µå®Œç¾é€‚é…å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ã€è¯­éŸ³è¯†åˆ«ï¼ˆASRï¼‰ç­‰å¤æ‚AIä»»åŠ¡ï¼Œå°¤å…¶åœ¨æœ¬åœ°åŒ–éƒ¨ç½²åœºæ™¯ä¸­ï¼Œèƒ½å…¼é¡¾æ¨¡å‹è¡¨è¾¾èƒ½åŠ›ä¸ç¡¬ä»¶å¹¶è¡Œæ•ˆç‡ï¼Œæ˜¯å½“å‰é«˜æ€§èƒ½AIç³»ç»Ÿçš„æ ¸å¿ƒæŠ€æœ¯ä¹‹ä¸€ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€æ ¸å¿ƒæ¦‚å¿µä¸åº•å±‚é€»è¾‘</h3>
<h4 data-id="heading-2">1. æ•´ä½“å®šä¹‰</h4>
<p>è¯¥æ¶æ„ç”±<strong>å¤šå¤´å¹¶è¡Œ</strong>ï¼ˆMulti-Head Parallelismï¼‰å’Œ<strong>æ½œå˜é‡ååŒ</strong>ï¼ˆLatent Variable Collaborationï¼‰ä¸¤ä¸ªæ ¸å¿ƒæ¨¡å—ç»„æˆï¼š</p>
<ul>
<li>å¤šå¤´å¹¶è¡Œï¼šå°†è¾“å…¥ç‰¹å¾æ‹†åˆ†åˆ°å¤šä¸ªç‹¬ç«‹å­ç©ºé—´ï¼Œé€šè¿‡å¹¶è¡Œè®¡ç®—æŒ–æ˜å·®å¼‚åŒ–å…³è”ï¼›</li>
<li>æ½œå˜é‡ååŒï¼šèåˆå¤šä¸ªå­ç©ºé—´çš„éšæ€§ç‰¹å¾ï¼ˆæ½œå˜é‡ï¼‰ï¼Œå½¢æˆæ— ç“¶é¢ˆçš„å…¨å±€è¡¨è¾¾ã€‚
æœ¬è´¨æ˜¯â€œå¹¶è¡Œæ¢ç´¢+é›†ä¸­æ•´åˆâ€ï¼Œæ—¢è§£å†³äº†å•ä¸€è§†è§’çš„ä¿¡æ¯å±€é™ï¼Œåˆé¿å…äº†å¹¶è¡Œç»“æœçš„ç¢ç‰‡åŒ–ã€‚</li>
</ul>
<h4 data-id="heading-3">2. æ¨¡å—1ï¼šå¤šå¤´å¹¶è¡Œâ€”â€”å¤šç»´åº¦å¹¶è¡Œæ¢ç´¢</h4>
<h5 data-id="heading-4">ï¼ˆ1ï¼‰æ ¸å¿ƒåŸç†</h5>
<p>å°†åŸå§‹è¾“å…¥ç‰¹å¾é€šè¿‡<strong>å·®å¼‚åŒ–çº¿æ€§æŠ•å½±</strong>ï¼Œæ‹†åˆ†åˆ°hä¸ªç›¸äº’ç‹¬ç«‹çš„â€œå­ç‰¹å¾ç©ºé—´â€ï¼Œæ¯ä¸ªç©ºé—´å¯¹åº”ä¸€ä¸ªâ€œæ³¨æ„åŠ›å¤´â€ï¼ˆAttention Headï¼‰ã€‚æ¯ä¸ªå¤´ç‹¬ç«‹è®¡ç®—æ³¨æ„åŠ›æƒé‡ï¼Œä¸“æ³¨æŒ–æ˜è¯¥å­ç©ºé—´å†…çš„ç‰¹å®šå…³è”æ¨¡å¼ï¼ˆå¦‚æœ‰çš„å¤´å…³æ³¨å±€éƒ¨ç‰¹å¾ï¼Œæœ‰çš„å…³æ³¨é•¿è·ç¦»ä¾èµ–ï¼‰ã€‚</p>
<h5 data-id="heading-5">ï¼ˆ2ï¼‰æ•°å­¦ç®€åŒ–è¡¨è¾¾</h5>
<p>å‡è®¾è¾“å…¥ç‰¹å¾ç»´åº¦ä¸º<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{model}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼Œå¤šå¤´æ•°ä¸ºhï¼Œæ¯ä¸ªå¤´çš„ç»´åº¦ä¸º<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>k</mi></msub><mo>=</mo><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mi mathvariant="normal">/</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">d_k = d_{model}/h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal">h</span></span></span></span></span>ï¼ˆä¿è¯æ€»ç»´åº¦ä¸å˜ï¼‰ï¼š</p>
<ol>
<li>æŠ•å½±æ‹†åˆ†ï¼šåŸå§‹æŸ¥è¯¢ï¼ˆQï¼‰ã€é”®ï¼ˆKï¼‰ã€å€¼ï¼ˆVï¼‰é€šè¿‡ä¸åŒçº¿æ€§çŸ©é˜µæŠ•å½±ï¼Œå¾—åˆ°hç»„ç‹¬ç«‹çš„<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mi>i</mi></msub><mtext>ã€</mtext><msub><mi>K</mi><mi>i</mi></msub><mtext>ã€</mtext><msub><mi>V</mi><mi>i</mi></msub><mtext>ï¼ˆ</mtext><mi>i</mi><mo>=</mo><mn>1</mn><mo>âˆ¼</mo><mi>h</mi><mtext>ï¼‰</mtext></mrow><annotation encoding="application/x-tex">Q_iã€K_iã€V_iï¼ˆi=1\sim hï¼‰</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord cjk_fallback">ã€</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord cjk_fallback">ã€</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord cjk_fallback">ï¼ˆ</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">âˆ¼</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">h</span><span class="mord cjk_fallback">ï¼‰</span></span></span></span></span>ï¼›</li>
<li>å¹¶è¡Œè®¡ç®—ï¼šæ¯ä¸ªå¤´ç‹¬ç«‹æ‰§è¡Œæ³¨æ„åŠ›å…¬å¼ï¼š<br/>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mi>Q</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>K</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>V</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>S</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><msub><mi>Q</mi><mi>i</mi></msub><msubsup><mi>K</mi><mi>i</mi><mi>T</mi></msubsup><mi mathvariant="normal">/</mi><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt><mo stretchy="false">)</mo><mo separator="true">â‹…</mo><msub><mi>V</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">Attention(Q_i, K_i, V_i) = Softmax(Q_iK_i^T/\sqrt{d_k})Â·V_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">A</span><span class="mord mathnormal">tt</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.1159em;vertical-align:-0.2587em;"/><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4413em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span/></span></span></span></span></span><span class="mord">/</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8572em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"/><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span><span style="top:-2.8172em;"><span class="pstrut" style="height:3em;"/><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702&#10;c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14&#10;c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54&#10;c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10&#10;s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429&#10;c69,-144,104.5,-217.7,106.5,-221&#10;l0 -0&#10;c5.3,-9.3,12,-14,20,-14&#10;H400000v40H845.2724&#10;s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7&#10;c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z&#10;M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1828em;"><span/></span></span></span></span><span class="mclose">)</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼›</li>
<li>ç»“æœæš‚å­˜ï¼šæ¯ä¸ªå¤´çš„è¾“å‡ºåŒ…å«è¯¥å­ç©ºé—´çš„â€œæ½œå˜é‡â€ï¼ˆå¦‚ç‰¹å¾é‡è¦æ€§æƒé‡ã€å…³è”å¼ºåº¦ï¼‰ã€‚</li>
</ol>
<h5 data-id="heading-6">ï¼ˆ3ï¼‰å…³é”®ä¼˜åŠ¿ï¼šå·®å¼‚åŒ–ä¸å¹¶è¡Œæ•ˆç‡</h5>
<ul>
<li>å·®å¼‚åŒ–ï¼šä¸åŒæŠ•å½±çŸ©é˜µè®©æ¯ä¸ªå¤´å­¦ä¹ åˆ°ç‹¬ç‰¹çš„å…³è”æ¨¡å¼ï¼ˆå¦‚LLMä¸­ï¼Œå¤´1å…³æ³¨è¯­æ³•ç»“æ„ï¼Œå¤´2å…³æ³¨è¯­ä¹‰æ­é…ï¼Œå¤´3å…³æ³¨æŒ‡ä»£å…³ç³»ï¼‰ï¼Œé¿å…ä¿¡æ¯å†—ä½™ï¼›</li>
<li>å¹¶è¡Œæ€§ï¼šå¤šå¤´è®¡ç®—å®Œå…¨ç‹¬ç«‹ï¼Œå¤©ç„¶é€‚é…GPU/CPUçš„å¹¶è¡Œæ¶æ„ï¼ˆå¦‚å¤šæ ¸å¿ƒæ‹†åˆ†è®¡ç®—ï¼‰ï¼Œæ˜¾è‘—æå‡æ¨ç†é€Ÿåº¦ã€‚</li>
</ul>
<h4 data-id="heading-7">3. æ¨¡å—2ï¼šæ½œå˜é‡ååŒâ€”â€”éšæ€§ç‰¹å¾é›†ä¸­æ•´åˆ</h4>
<h5 data-id="heading-8">ï¼ˆ1ï¼‰æ½œå˜é‡çš„å®šä¹‰</h5>
<p>â€œæ½œå˜é‡â€æŒ‡æ¯ä¸ªæ³¨æ„åŠ›å¤´åœ¨è®¡ç®—ä¸­å­¦ä¹ åˆ°çš„<strong>éšæ€§å…³è”ä¿¡æ¯</strong>ï¼ˆæœªç›´æ¥æ˜¾å¼è¾“å…¥ï¼‰ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>LLMä¸­ï¼šè¯­ä¹‰å…³è”å¼ºåº¦ã€é•¿è·ç¦»ä¾èµ–æƒé‡ã€è¯­æ³•ç»“æ„ä¼˜å…ˆçº§ï¼›</li>
<li>ASRä¸­ï¼šé¢‘è°±ç‰¹å¾å…³è”ã€éŸ³ç´ æ—¶åºä¾èµ–ã€å™ªå£°æŠ‘åˆ¶æ©ç ã€‚</li>
</ul>
<h5 data-id="heading-9">ï¼ˆ2ï¼‰ååŒæœºåˆ¶ï¼šè§£å†³â€œå¹¶è¡Œç¢ç‰‡åŒ–â€é—®é¢˜</h5>
<p>å•ä¸€å¤šå¤´å¹¶è¡Œä¼šäº§ç”Ÿhä¸ªç‹¬ç«‹çš„ç‰¹å¾è¾“å‡ºï¼Œæ½œå˜é‡ååŒé€šè¿‡ä»¥ä¸‹æ–¹å¼æ•´åˆï¼š</p>





























<table><thead><tr><th>ååŒæ–¹å¼</th><th>åŸç†</th><th>é€‚ç”¨åœºæ™¯</th><th>è®¡ç®—å¤æ‚åº¦</th></tr></thead><tbody><tr><td>æ‹¼æ¥èåˆï¼ˆConcatï¼‰</td><td>ç›´æ¥æ‹¼æ¥hä¸ªå¤´çš„è¾“å‡ºï¼Œé€šè¿‡çº¿æ€§å±‚å‹ç¼©ç»´åº¦</td><td>LLMã€å¤æ‚æ–‡æœ¬ç”Ÿæˆ</td><td>ä¸­-é«˜</td></tr><tr><td>åŠ æƒæ±‚å’Œï¼ˆWeighted Sumï¼‰</td><td>ç»™æ¯ä¸ªå¤´åˆ†é…å¯å­¦ä¹ æƒé‡ï¼ŒåŠ¨æ€è°ƒæ•´é‡è¦æ€§</td><td>ASRã€å™ªå£°ç¯å¢ƒä¸‹çš„ç‰¹å¾æå–</td><td>ä½-ä¸­</td></tr><tr><td>äº¤å‰æ³¨æ„åŠ›ååŒ</td><td>ä»¥ä¸€ä¸ªå¤´çš„æ½œå˜é‡ä¸ºæŸ¥è¯¢ï¼Œå…¶ä»–å¤´ä¸ºé”®/å€¼</td><td>å¤šæ¨¡æ€ä»»åŠ¡ï¼ˆè¯­éŸ³-æ–‡æœ¬è”åŠ¨ï¼‰</td><td>é«˜</td></tr></tbody></table>
<h5 data-id="heading-10">ï¼ˆ3ï¼‰ä¸â€œå•ä¸€æ½œæ³¨æ„åŠ›â€çš„æ ¸å¿ƒåŒºåˆ«</h5>






























<table><thead><tr><th>å¯¹æ¯”ç»´åº¦</th><th>å•ä¸€æ½œæ³¨æ„åŠ›</th><th>å¤šå¤´å¹¶è¡Œ+æ½œå˜é‡ååŒ</th></tr></thead><tbody><tr><td>ç‰¹å¾ç©ºé—´</td><td>å•ç»´åº¦ç©ºé—´ï¼Œæ˜“â€œç»´åº¦æ‹¥æŒ¤â€</td><td>å¤šå­ç©ºé—´å¹¶è¡Œï¼Œæ— è¡¨è¾¾ç“¶é¢ˆ</td></tr><tr><td>å…³è”æŒ–æ˜èƒ½åŠ›</td><td>ä»…èƒ½æ•æ‰å•ä¸€ç²’åº¦å…³è”</td><td>å¤šç²’åº¦ã€å¤šç»´åº¦å…³è”åŒæ—¶æ•æ‰</td></tr><tr><td>æ³›åŒ–èƒ½åŠ›</td><td>æ˜“è¿‡æ‹Ÿåˆï¼Œé€‚é…æ€§å·®</td><td>é€‚é…å¤šæ ·åŒ–æ•°æ®åˆ†å¸ƒ</td></tr><tr><td>å¹¶è¡Œæ•ˆç‡</td><td>æ— å¹¶è¡Œæ€§ï¼Œæ¨ç†é€Ÿåº¦æ…¢</td><td>å¤©ç„¶å¹¶è¡Œï¼Œé€‚é…ç¡¬ä»¶åŠ é€Ÿ</td></tr></tbody></table>
<h3 data-id="heading-11">äºŒã€æ ¸å¿ƒä¼˜åŠ¿ï¼šä¸ºä½•æˆä¸ºLLM/ASRçš„é¦–é€‰æ¶æ„</h3>
<h4 data-id="heading-12">1. çªç ´è¡¨è¾¾ç“¶é¢ˆï¼Œæ•æ‰å¤æ‚å…³è”</h4>
<ul>
<li>LLMåœºæ™¯ï¼šåŒæ—¶æ•æ‰çŸ­è·ç¦»è¯­æ³•æ­é…ï¼ˆå¦‚â€œæ·±åº¦å­¦ä¹ æ¡†æ¶â€ï¼‰å’Œé•¿è·ç¦»è¯­ä¹‰è¿è´¯ï¼ˆå¦‚å¯¹è¯ä¸­å‰æ–‡â€œæ¨¡å‹éƒ¨ç½²â€ä¸åæ–‡å‘¼åº”ï¼‰ï¼Œç”Ÿæˆæ–‡æœ¬çš„é€»è¾‘æ€§æå‡30%ä»¥ä¸Šï¼›</li>
<li>ASRåœºæ™¯ï¼šåŒæ—¶æ•æ‰é¢‘è°±å±€éƒ¨å…³è”ï¼ˆéŸ³ç´ è¯†åˆ«ï¼‰å’Œæ—¶åºé•¿è·ç¦»å…³è”ï¼ˆè¯­å¥æµç•…æ€§ï¼‰ï¼Œå¤æ‚å™ªå£°ç¯å¢ƒä¸‹è¯†åˆ«å‡†ç¡®ç‡æå‡10%-20%ã€‚</li>
</ul>
<h4 data-id="heading-13">2. é€‚é…ç¡¬ä»¶å¹¶è¡Œï¼Œæå‡éƒ¨ç½²æ•ˆç‡</h4>
<ul>
<li>GPUéƒ¨ç½²ï¼šå¤šå¤´è®¡ç®—å¯é€šè¿‡Tensor Parallelismæ‹†åˆ†åˆ°å¤šå¡æ ¸å¿ƒï¼ˆå¦‚h=32çš„LLMæ‹†åˆ†ä¸º4å¼ GPUï¼Œæ¯å¼ å¤„ç†8ä¸ªå¤´ï¼‰ï¼Œæ˜¾å­˜å ç”¨é™ä½50%ï¼Œæ¨ç†é€Ÿåº¦æå‡2-3å€ï¼›</li>
<li>CPU/è¾¹ç¼˜è®¾å¤‡éƒ¨ç½²ï¼šé€šè¿‡å¤šçº¿ç¨‹å¹¶è¡Œå¤„ç†ä¸åŒå¤´ï¼Œ8æ ¸CPUå¤„ç†h=8çš„å¤šå¤´æ—¶ï¼Œå»¶è¿Ÿé™ä½50%ã€‚</li>
</ul>
<h4 data-id="heading-14">3. æ³›åŒ–èƒ½åŠ›å¼ºï¼Œé€‚é…å¤šä»»åŠ¡åœºæ™¯</h4>
<ul>
<li>å¯é€šè¿‡è°ƒæ•´å¤šå¤´æ•°ï¼ˆhï¼‰å’ŒååŒæ–¹å¼é€‚é…ä¸åŒä»»åŠ¡ï¼š
<ul>
<li>è½»é‡ä»»åŠ¡ï¼ˆæ–‡æœ¬åˆ†ç±»ã€ç®€å•ASRï¼‰ï¼šh=8+åŠ æƒæ±‚å’Œï¼Œå¹³è¡¡é€Ÿåº¦ä¸æ•ˆæœï¼›</li>
<li>å¤æ‚ä»»åŠ¡ï¼ˆå¯¹è¯ç”Ÿæˆã€å¤šæ¨¡æ€è”åŠ¨ï¼‰ï¼šh=16/32+äº¤å‰æ³¨æ„åŠ›ï¼Œæå‡å…³è”æ•æ‰èƒ½åŠ›ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-15">4. æˆæœ¬æ•ˆç›Šå¹³è¡¡ï¼Œé€‚é…æœ¬åœ°åŒ–éƒ¨ç½²</h4>
<ul>
<li>å°æ¨¡å‹ï¼ˆLLaMA 7Bã€è½»é‡ASRï¼‰ï¼šh=8-16ï¼Œå•å¡RTX 3090/4090å³å¯éƒ¨ç½²ï¼Œæ˜¾å­˜å ç”¨ä»…8-12GBï¼›</li>
<li>å¤§æ¨¡å‹ï¼ˆLLaMA 70Bï¼‰ï¼šh=32-64ï¼Œé€šè¿‡å¤šå¡å¹¶è¡Œï¼ˆ4å¼ A100ï¼‰ï¼Œå…¼é¡¾æ•ˆæœä¸éƒ¨ç½²å¯è¡Œæ€§ã€‚</li>
</ul>
<h3 data-id="heading-16">ä¸‰ã€å®é™…åº”ç”¨åœºæ™¯ï¼šèšç„¦LLMä¸ASR</h3>
<h4 data-id="heading-17">1. åœºæ™¯1ï¼šLLMçš„è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼ˆæ ¸å¿ƒåº”ç”¨ï¼‰</h4>
<h5 data-id="heading-18">ï¼ˆ1ï¼‰å®ç°é€»è¾‘ï¼ˆä»¥Transformerä¸ºä¾‹ï¼‰</h5>
<ol>
<li>è¾“å…¥å¤„ç†ï¼šæ–‡æœ¬Embeddingï¼ˆç»´åº¦<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo>=</mo><mn>512</mn><mi mathvariant="normal">/</mi><mn>1024</mn></mrow><annotation encoding="application/x-tex">d_{model}=512/1024</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord">512/1024</span></span></span></span></span>ï¼‰é€šè¿‡Qã€Kã€Vçº¿æ€§æŠ•å½±ï¼›</li>
<li>å¤šå¤´æ‹†åˆ†ï¼šsplitä¸º<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>=</mo><mn>12</mn><mi mathvariant="normal">/</mi><mn>16</mn><mi mathvariant="normal">/</mi><mn>32</mn></mrow><annotation encoding="application/x-tex">h=12/16/32</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord">12/16/32</span></span></span></span></span>ä¸ªå¤´ï¼ˆå¦‚<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo>=</mo><mn>1024</mn></mrow><annotation encoding="application/x-tex">d_{model}=1024</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">1024</span></span></span></span></span>ï¼Œh=16ï¼Œæ¯ä¸ªå¤´ç»´åº¦<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>k</mi></msub><mo>=</mo><mn>64</mn></mrow><annotation encoding="application/x-tex">d_k=64</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">64</span></span></span></span></span>ï¼‰ï¼›</li>
<li>å¹¶è¡Œè®¡ç®—ï¼šæ¯ä¸ªå¤´ç‹¬ç«‹è®¡ç®—è‡ªæ³¨æ„åŠ›ï¼ŒæŒ–æ˜ä¸åŒè¯­ä¹‰æ½œå˜é‡ï¼›</li>
<li>æ½œå˜é‡ååŒï¼šæ‹¼æ¥æ‰€æœ‰å¤´çš„è¾“å‡ºï¼Œé€šè¿‡çº¿æ€§å±‚å¾—åˆ°å…¨å±€æ³¨æ„åŠ›ç‰¹å¾ï¼Œè¾“å…¥Feed-Forwardç½‘ç»œã€‚</li>
</ol>
<h5 data-id="heading-19">ï¼ˆ2ï¼‰éƒ¨ç½²ä¼˜åŒ–æŠ€å·§</h5>
<ul>
<li>æ˜¾å­˜ä¼˜åŒ–ï¼šå°†å¤šå¤´æ‹†åˆ†åˆ°å¤šå¡ï¼ˆTensor Parallelismï¼‰ï¼ŒLLaMA 7B h=32æ‹†åˆ†ä¸º2å¼ GPUï¼Œæ¯å¼ å¤„ç†16ä¸ªå¤´ï¼Œæ˜¾å­˜å ç”¨ä»14GBé™è‡³8GBï¼›</li>
<li>é€Ÿåº¦ä¼˜åŒ–ï¼šåˆ©ç”¨CUDA Tensor CoreåŠ é€ŸçŸ©é˜µä¹˜æ³•ï¼ˆQK^Tã€VÂ·æƒé‡ï¼‰ï¼Œå¼€å¯TensorRTä¼˜åŒ–ï¼Œæ¨ç†é€Ÿåº¦æå‡2å€ã€‚</li>
</ul>
<h4 data-id="heading-20">2. åœºæ™¯2ï¼šASRçš„è¯­éŸ³ç‰¹å¾æå–ï¼ˆå…³é”®æ”¹è¿›ï¼‰</h4>
<h5 data-id="heading-21">ï¼ˆ1ï¼‰å¤šå¤´åˆ†å·¥è®¾è®¡</h5>
<ul>
<li>å¤´1-4ï¼šä¸“æ³¨é¢‘è°±å±€éƒ¨å…³è”ï¼ˆæ¢…å°”é¢‘è°±çš„é¢‘ç‡ä¾èµ–ï¼Œç”¨äºéŸ³ç´ è¯†åˆ«ï¼‰ï¼›</li>
<li>å¤´5-8ï¼šä¸“æ³¨æ—¶åºé•¿è·ç¦»å…³è”ï¼ˆéŸ³ç´ å…ˆåé¡ºåºï¼Œç”¨äºè¯­å¥è¿è´¯æ€§ï¼‰ï¼›</li>
<li>å¤´9-12ï¼šä¸“æ³¨å™ªå£°æŠ‘åˆ¶ï¼ˆæŒ–æ˜â€œè¯­éŸ³ä¿¡å·â€ä¸â€œå™ªå£°â€çš„æ½œå˜é‡å·®å¼‚ï¼‰ã€‚</li>
</ul>
<h5 data-id="heading-22">ï¼ˆ2ï¼‰æ½œå˜é‡ååŒç­–ç•¥</h5>
<p>é‡‡ç”¨<strong>åŠ¨æ€åŠ æƒæ±‚å’Œ</strong>ï¼šæ¨¡å‹æ ¹æ®è¾“å…¥è¯­éŸ³çš„å™ªå£°å¼ºåº¦ã€é•¿åº¦ï¼Œè‡ªåŠ¨è°ƒæ•´ä¸åŒå¤´çš„æƒé‡ï¼ˆå¦‚å™ªå£°ç¯å¢ƒä¸‹ï¼Œå™ªå£°æŠ‘åˆ¶å¤´æƒé‡ä»0.1æå‡è‡³0.3ï¼‰ã€‚</p>
<h5 data-id="heading-23">ï¼ˆ3ï¼‰éƒ¨ç½²æ•ˆæœ</h5>
<ul>
<li>å®æ—¶ASRï¼šå»¶è¿Ÿä»200msé™è‡³100msä»¥å†…ï¼ˆCPU 8æ ¸å¹¶è¡Œï¼‰ï¼›</li>
<li>é•¿è¯­éŸ³è½¬å†™ï¼ˆ10åˆ†é’Ÿä¼šè®®å½•éŸ³ï¼‰ï¼šWERï¼ˆå­—é”™è¯¯ç‡ï¼‰ä»18%é™è‡³12%ã€‚</li>
</ul>
<h4 data-id="heading-24">3. åœºæ™¯3ï¼šå¤šæ¨¡æ€å·¥å…·ï¼ˆè¯­éŸ³-æ–‡æœ¬-è„±æ•è”åŠ¨ï¼‰</h4>
<h5 data-id="heading-25">ï¼ˆ1ï¼‰æ¶æ„è®¾è®¡</h5>
<ul>
<li>å¤šå¤´åˆ†å·¥ï¼šéƒ¨åˆ†å¤´è´Ÿè´£ASRè¯­éŸ³è½¬å†™ï¼Œéƒ¨åˆ†å¤´è´Ÿè´£æ–‡æœ¬æ•æ„Ÿä¿¡æ¯è¯†åˆ«ï¼ˆæŒ–æ˜â€œæ•æ„Ÿè¯-ä¸Šä¸‹æ–‡â€æ½œå˜é‡ï¼‰ï¼›</li>
<li>ååŒæ–¹å¼ï¼šäº¤å‰æ³¨æ„åŠ›ï¼ˆASRå¤´è¾“å‡ºä½œä¸ºK/Vï¼Œè„±æ•å¤´è¾“å‡ºä½œä¸ºQï¼‰ï¼Œè®©è„±æ•ä»»åŠ¡åˆ©ç”¨è¯­éŸ³æ—¶åºä¿¡æ¯ï¼Œé¿å…è¯¯åˆ¤ï¼ˆå¦‚â€œå¼ ä¸‰â€ä¸ä¼šè¢«è¯¯åˆ¤ä¸ºæ™®é€šåè¯ï¼‰ã€‚</li>
</ul>
<h5 data-id="heading-26">ï¼ˆ2ï¼‰å®ç”¨ä»·å€¼</h5>
<p>æ„å»ºæœ¬åœ°åŒ–â€œè¯­éŸ³è½¬å†™+æ•°æ®è„±æ•â€ä¸€ä½“åŒ–å·¥å…·ï¼Œé€‚ç”¨äºä¼ä¸šä¼šè®®å½•éŸ³ã€å®¢æˆ·é€šè¯ç­‰éšç§åœºæ™¯ï¼Œè„±æ•å‡†ç¡®ç‡è¾¾95%ä»¥ä¸Šã€‚</p>
<h3 data-id="heading-27">å››ã€æœ¬åœ°åŒ–éƒ¨ç½²ä¼˜åŒ–æŒ‡å—</h3>
<h4 data-id="heading-28">1. å¤šå¤´æ•°ï¼ˆhï¼‰çš„é€‰æ‹©ï¼šå¹³è¡¡æ•ˆæœä¸ç¡¬ä»¶æˆæœ¬</h4>

































<table><thead><tr><th>æ¨¡å‹è§„æ¨¡</th><th>æ¨èå¤šå¤´æ•°h</th><th>é€‚é…ç¡¬ä»¶</th><th>æ˜¾å­˜å ç”¨ï¼ˆFP16ï¼‰</th><th>æ¨ç†é€Ÿåº¦ï¼ˆå•æ¡è¯·æ±‚ï¼‰</th></tr></thead><tbody><tr><td>è½»é‡æ¨¡å‹ï¼ˆLLaMA 7Bã€è½»é‡ASRï¼‰</td><td>8-16</td><td>å•å¡RTX 3090/4090ã€CPU 16æ ¸</td><td>8-12GB</td><td>LLMï¼š50-100msï¼ŒASRï¼š50ms</td></tr><tr><td>ä¸­è§„æ¨¡æ¨¡å‹ï¼ˆLLaMA 13Bã€é€šç”¨ASRï¼‰</td><td>16-24</td><td>å•å¡A10ã€åŒå¡RTX 4090</td><td>12-20GB</td><td>LLMï¼š100-200msï¼ŒASRï¼š80ms</td></tr><tr><td>å¤§è§„æ¨¡æ¨¡å‹ï¼ˆLLaMA 70Bã€é«˜ç²¾åº¦ASRï¼‰</td><td>32-64</td><td>4-8å¡A100</td><td>40-80GB</td><td>LLMï¼š200-500msï¼ŒASRï¼š150ms</td></tr></tbody></table>
<blockquote>
<p>æ³¨æ„ï¼šå¤šå¤´æ•°å¹¶éè¶Šå¤šè¶Šå¥½ï¼Œè¶…è¿‡h=64åï¼Œæ¨¡å‹å¤æ‚åº¦æ¿€å¢ï¼Œæ³›åŒ–èƒ½åŠ›ä¸‹é™ï¼Œä¸”ç¡¬ä»¶æˆæœ¬ç¿»å€ã€‚</p>
</blockquote>
<h4 data-id="heading-29">2. æ½œå˜é‡ååŒæ–¹å¼çš„ç¡¬ä»¶é€‚é…</h4>
<ul>
<li>è®¡ç®—èµ„æºæœ‰é™ï¼ˆCPU/è¾¹ç¼˜è®¾å¤‡ï¼‰ï¼šé€‰æ‹©â€œåŠ æƒæ±‚å’Œâ€æˆ–â€œå¹³å‡æ± åŒ–â€ï¼Œè®¡ç®—é‡æ¯”æ‹¼æ¥èåˆä½30%ï¼Œé€‚åˆæ ‘è“æ´¾ã€NVIDIA Jetsonç­‰è®¾å¤‡ï¼›</li>
<li>é«˜æ€§èƒ½ç¡¬ä»¶ï¼ˆGPUå¤šå¡ï¼‰ï¼šé€‰æ‹©â€œæ‹¼æ¥èåˆâ€æˆ–â€œäº¤å‰æ³¨æ„åŠ›â€ï¼Œæœ€å¤§åŒ–æ¨¡å‹è¡¨è¾¾èƒ½åŠ›ï¼Œé€‚åˆä¼ä¸šçº§æœ¬åœ°åŒ–éƒ¨ç½²ï¼›</li>
<li>è¾¹ç¼˜è®¾å¤‡åŠŸè€—ä¼˜åŒ–ï¼šé‡‡ç”¨â€œç¨€ç–å¤šå¤´â€ç­–ç•¥ï¼ˆç¦ç”¨20%æ¬¡è¦å¤´ï¼‰ï¼ŒåŠŸè€—é™ä½15%ï¼Œæ•ˆæœä»…ä¸‹é™2%ã€‚</li>
</ul>
<h4 data-id="heading-30">3. å¹¶è¡Œè®¡ç®—ä¼˜åŒ–æŠ€å·§</h4>
<h5 data-id="heading-31">ï¼ˆ1ï¼‰GPUéƒ¨ç½²</h5>
<ul>
<li>å¼€å¯Tensor Parallelismï¼šæ‹†åˆ†å¤šå¤´è®¡ç®—åˆ°å¤šå¡ï¼Œå¦‚h=32æ‹†åˆ†ä¸º4å¼ GPUï¼Œæ¯å¼ å¤„ç†8ä¸ªå¤´ï¼›</li>
<li>æ··åˆç²¾åº¦è®­ç»ƒ/æ¨ç†ï¼ˆFP16/FP8ï¼‰ï¼šæ˜¾å­˜å ç”¨é™ä½50%ï¼Œæ¨ç†é€Ÿåº¦æå‡1.5å€ï¼Œæ•ˆæœæŸå¤±å¯å¿½ç•¥ï¼›</li>
<li>åˆ©ç”¨CUDAæ ¸å‡½æ•°ï¼šè‡ªå®šä¹‰å¤šå¤´æ³¨æ„åŠ›çš„çŸ©é˜µä¹˜æ³•æ ¸ï¼Œè¿›ä¸€æ­¥æå‡å¹¶è¡Œæ•ˆç‡ã€‚</li>
</ul>
<h5 data-id="heading-32">ï¼ˆ2ï¼‰CPUéƒ¨ç½²</h5>
<ul>
<li>å¤šçº¿ç¨‹å¹¶è¡Œï¼šé€šè¿‡OpenMPå°†æ¯ä¸ªå¤´çš„è®¡ç®—åˆ†é…åˆ°ä¸åŒCPUæ ¸å¿ƒï¼Œé¿å…ä¸²è¡Œç­‰å¾…ï¼›</li>
<li>ç‰¹å¾ç»´åº¦ä¼˜åŒ–ï¼šé™ä½<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{model}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼ˆå¦‚ä»1024é™è‡³768ï¼‰ï¼ŒåŒæ—¶ä¿æŒh=16ï¼Œå¹³è¡¡é€Ÿåº¦ä¸æ•ˆæœã€‚</li>
</ul>
<h4 data-id="heading-33">4. æ€§èƒ½è¯„ä¼°æŒ‡æ ‡ï¼ˆæœ¬åœ°åŒ–éƒ¨ç½²å…³é”®ï¼‰</h4>

























<table><thead><tr><th>ç»´åº¦</th><th>æ ¸å¿ƒæŒ‡æ ‡</th><th>ä¼˜åŒ–ç›®æ ‡</th></tr></thead><tbody><tr><td>æ¨¡å‹æ•ˆæœ</td><td>LLMï¼šPerplexityã€BLEUï¼›ASRï¼šWER/CER</td><td>LLM Perplexity&lt;30ï¼›ASR WER&lt;15%</td></tr><tr><td>éƒ¨ç½²æ€§èƒ½</td><td>æ¨ç†å»¶è¿Ÿã€ååé‡ã€æ˜¾å­˜/å†…å­˜å ç”¨</td><td>å»¶è¿Ÿ&lt;300msï¼›ååé‡&gt;10 QPS</td></tr><tr><td>æˆæœ¬æ•ˆç›Š</td><td>æ¯åƒæ¡è¯·æ±‚ç¡¬ä»¶æˆæœ¬ï¼ˆGPUå°æ—¶è´¹ã€ç”µè´¹ï¼‰</td><td>æ§åˆ¶åœ¨1-5å…ƒ/åƒæ¡</td></tr></tbody></table>
<h3 data-id="heading-34">äº”ã€å‰æ²¿æ‰©å±•ä¸æœªæ¥è¶‹åŠ¿</h3>
<h4 data-id="heading-35">1. åŠ¨æ€å¤šå¤´æœºåˆ¶</h4>
<p>æ¨¡å‹æ ¹æ®è¾“å…¥æ•°æ®å¤æ‚åº¦åŠ¨æ€æ¿€æ´»å¤šå¤´æ•°ï¼ˆå¦‚ç®€å•æ–‡æœ¬æ¿€æ´»4ä¸ªå¤´ï¼Œå¤æ‚æ–‡æœ¬æ¿€æ´»16ä¸ªå¤´ï¼‰ï¼Œæ¨ç†é€Ÿåº¦æå‡30%ï¼ŒåŒæ—¶ä¿æŒæ•ˆæœã€‚</p>
<h4 data-id="heading-36">2. æ½œå˜é‡è’¸é¦</h4>
<p>å°†å¤§æ¨¡å‹ï¼ˆh=32ï¼‰çš„æ½œå˜é‡çŸ¥è¯†è’¸é¦åˆ°å°æ¨¡å‹ï¼ˆh=8ï¼‰ï¼Œè®©å°æ¨¡å‹åœ¨è¾¹ç¼˜è®¾å¤‡éƒ¨ç½²æ—¶ï¼Œæ•ˆæœæ¥è¿‘å¤§æ¨¡å‹ï¼ˆå¦‚ASR WERä»…ä¸Šå‡3%ï¼‰ã€‚</p>
<h4 data-id="heading-37">3. è·¨ä»»åŠ¡æ½œå˜é‡å…±äº«</h4>
<p>åœ¨ä¸€ä½“åŒ–å·¥å…·ï¼ˆå¦‚â€œLLMç”Ÿæˆ+ASRè½¬å†™+è„±æ•â€ï¼‰ä¸­ï¼Œå…±äº«è¯­ä¹‰å…³è”ç±»æ½œå˜é‡ï¼Œå‡å°‘æ¨¡å‹å‚æ•°30%ï¼Œæå‡éƒ¨ç½²æ•ˆç‡ã€‚</p>
<h3 data-id="heading-38">æ€»ç»“</h3>
<p>â€œå¤šå¤´å¹¶è¡Œ+æ½œå˜é‡ååŒâ€æ˜¯å¹³è¡¡AIæ¨¡å‹â€œè¡¨è¾¾èƒ½åŠ›â€ä¸â€œéƒ¨ç½²æ•ˆç‡â€çš„æ ¸å¿ƒæ¶æ„ï¼Œå…¶æœ¬è´¨æ˜¯é€šè¿‡â€œå¤šç»´åº¦å¹¶è¡Œæ¢ç´¢â€çªç ´å•ä¸€è§†è§’å±€é™ï¼Œå†é€šè¿‡â€œéšæ€§ç‰¹å¾ååŒâ€å½¢æˆå…¨å±€è¡¨è¾¾ã€‚åœ¨LLMã€ASRç­‰æœ¬åœ°åŒ–éƒ¨ç½²åœºæ™¯ä¸­ï¼Œé€šè¿‡åˆç†é€‰æ‹©å¤šå¤´æ•°ã€ååŒæ–¹å¼å’Œå¹¶è¡Œç­–ç•¥ï¼Œå¯åœ¨æ™®é€šç¡¬ä»¶ï¼ˆå¦‚å•å¡RTX 4090ï¼‰ä¸Šå®ç°é«˜æ€§èƒ½æ¨ç†ï¼ŒåŒæ—¶æ§åˆ¶æˆæœ¬ã€‚</p>
<p>å¯¹äºå¼€å‘è€…è€Œè¨€ï¼Œè¯¥æ¶æ„çš„å…³é”®ä»·å€¼åœ¨äºâ€œçµæ´»æ€§â€â€”â€”å¯æ ¹æ®ä»»åŠ¡å¤æ‚åº¦ã€ç¡¬ä»¶é…ç½®åŠ¨æ€è°ƒæ•´å‚æ•°ï¼Œå®Œç¾é€‚é…ä»è¾¹ç¼˜è®¾å¤‡åˆ°ä¼ä¸šçº§æœåŠ¡å™¨çš„å…¨åœºæ™¯éƒ¨ç½²éœ€æ±‚ï¼Œæ˜¯æ„å»ºå®ç”¨åŒ–ã€æœ¬åœ°åŒ–AIå·¥å…·çš„æ ¸å¿ƒæŠ€æœ¯æ”¯æ’‘ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[PAGåœ¨å¾—ç‰©ç¤¾åŒºSçº§æ´»åŠ¨çš„è½åœ°]]></title>    <link>https://juejin.cn/post/7587675306659020800</link>    <guid>https://juejin.cn/post/7587675306659020800</guid>    <pubDate>2025-12-26T07:45:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587675306659020800" data-draft-id="7587675306658627584" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="PAGåœ¨å¾—ç‰©ç¤¾åŒºSçº§æ´»åŠ¨çš„è½åœ°"/> <meta itemprop="keywords" content="è®¾è®¡"/> <meta itemprop="datePublished" content="2025-12-26T07:45:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¾—ç‰©æŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/2392954206960247"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            PAGåœ¨å¾—ç‰©ç¤¾åŒºSçº§æ´»åŠ¨çš„è½åœ°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2392954206960247/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¾—ç‰©æŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T07:45:34.000Z" title="Fri Dec 26 2025 07:45:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»26åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€èƒŒæ™¯</h2>
<p>è¿‘æœŸï¼Œå¾—ç‰©ç¤¾åŒºæ´»åŠ¨ã€Œç”¨ç¯®çƒè®¤è¯†æˆ‘ã€æ¨å‡º â€œç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆä¸“å±çƒæ˜Ÿå¡â€ æ ¸å¿ƒç©æ³•ã€‚</p>
<p>åˆæœŸè§„åˆ’ç”±æœåŠ¡ç«¯åŸºäº PAG æŠ€æœ¯åˆæˆï¼Œä¸ºäº†è®©ç”¨æˆ·å¯ä»¥æ›´è‡ªç”±çš„å®šåˆ¶ä¸“å±çƒæ˜Ÿå¡ï¼Œç»å¤šç«¯è¯„ä¼°åç¡®å®šï¼šç”± H5 ç«¯æ‰¿æ¥ â€œå›¾ç‰‡äº¤äº’è°ƒæ•´ - çƒæ˜Ÿå¡ç”Ÿæˆâ€ æ ¸å¿ƒé“¾è·¯ï¼Œæ”¯æŒç”¨æˆ·å•æŒ‡æ‹–æ‹½ã€åŒæŒ‡ç¼©æ”¾ / æ—‹è½¬äººåƒï¼Œå¾…è°ƒæ•´è‡³ç†æƒ³ä½ç½®åè§¦å‘åˆæˆã€‚è€Œ PAG ä½œä¸ºè…¾è®¯è‡ªç ”å¼€æºçš„åŠ¨æ•ˆå·¥ä½œæµè§£å†³æ–¹æ¡ˆï¼Œå‡­å€Ÿè·¨å¹³å°æ¸²æŸ“ä¸€è‡´æ€§ã€å›¾å±‚å®æ—¶ç¼–è¾‘ã€è½»é‡åŒ–æ–‡ä»¶æ€§èƒ½ï¼Œèƒ½ç²¾å‡†åŒ¹é…éœ€æ±‚ï¼Œæˆä¸ºæœ¬æ¬¡æ ¸å¿ƒæŠ€æœ¯é€‰å‹ã€‚</p>
<p>é‰´äº H5 ç«¯éœ€è½åœ°è¯¥æ ¸å¿ƒé“¾è·¯ï¼Œä¸”æµç¨‹æ¶‰åŠ PAG æŠ€æœ¯åº”ç”¨ï¼Œé¦–å…ˆéœ€å¯¹ PAG æŠ€æœ¯è¿›è¡Œæ·±å…¥äº†è§£ï¼Œä¸ºåç»­å¼€å‘ä¸é€‚é…å¥ å®šåŸºç¡€ã€‚</p>
<h2 data-id="heading-1">äºŒã€PAGæ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p>è¿™é‡Œç®€å•ä»‹ç»ä¸€ä¸‹ï¼ŒPAG æ˜¯è…¾è®¯è‡ªç ”å¹¶å¼€æºçš„åŠ¨æ•ˆå·¥ä½œæµè§£å†³æ–¹æ¡ˆï¼Œæ ¸å¿ƒæ˜¯å®ç° Adobe After Effectsï¼ˆAEï¼‰åŠ¨æ•ˆçš„ä¸€é”®å¯¼å‡ºä¸è·¨å¹³å°åº”ç”¨ï¼ŒåŒ…å«æ¸²æŸ“ SDKã€AE å¯¼å‡ºæ’ä»¶ï¼ˆPAGExporterï¼‰ã€æ¡Œé¢é¢„è§ˆå·¥å…·ï¼ˆPAGViewerï¼‰ä¸‰éƒ¨åˆ†ã€‚</p>
<p>å®ƒå¯¼å‡ºçš„äºŒè¿›åˆ¶ PAG æ–‡ä»¶å‹ç¼©ç‡é«˜ã€è§£ç å¿«ï¼Œèƒ½é›†æˆå¤šç±»èµ„æºï¼›æ”¯æŒ Androidã€iOSã€Web ç­‰å…¨å¹³å°ï¼Œä¸”å„ç«¯æ¸²æŸ“ä¸€è‡´ã€å¼€å¯ GPU åŠ é€Ÿï¼›æ—¢å…¼å®¹å¤§éƒ¨åˆ† AE åŠ¨æ•ˆç‰¹æ€§ï¼Œä¹Ÿå…è®¸è¿è¡Œæ—¶ç¼–è¾‘ â€”â€” æ¯”å¦‚æ›¿æ¢æ–‡æœ¬ / å›¾ç‰‡ã€è°ƒæ•´å›¾å±‚ä¸æ—¶é—´è½´ï¼Œç›®å‰å·²å¹¿æ³›ç”¨äºå„ç±»äº§å“çš„åŠ¨æ•ˆåœºæ™¯ã€‚</p>
<p>å·²çŸ¥ä¸šç•Œä¸­å›¾ç‰‡åŸºç¡€ç¼–è¾‘ï¼ˆå¦‚è£å‰ªã€è°ƒè‰²ï¼‰ã€è´´çº¸å åŠ ã€æ»¤é•œæ¸²æŸ“ç­‰é«˜é¢‘åŠŸèƒ½ï¼Œåœ¨å®¢æˆ·ç«¯å‘å¸ƒå™¨åœºæ™¯ä¸‹å·²å¹¿æ³›é‡‡ç”¨ PAGæŠ€æœ¯å®ç°ï¼Œè¿™ä¸€åº”ç”¨è¶‹åŠ¿åœ¨æˆ‘å¸åŠç«å“çš„äº§å“ä¸­å‡æœ‰ä½“ç°ï¼Œæˆä¸ºæ”¯æ’‘è¿™ç±»è§†è§‰äº¤äº’åŠŸèƒ½çš„ä¸»æµæŠ€æœ¯é€‰æ‹©ã€‚</p>
<p>æ­£æ˜¯åŸºäºPAG çš„è·¨å¹³å°æ¸²æŸ“ã€å›¾å±‚å®æ—¶ç¼–è¾‘ç‰¹æ€§ï¼Œå…¶èƒ½ç²¾å‡†æ‰¿æ¥ H5 ç«¯â€˜å›¾ç‰‡äº¤äº’è°ƒæ•´ + çƒæ˜Ÿå¡åˆæˆâ€™çš„æ ¸å¿ƒé“¾è·¯ï¼Œè§£å†³æœåŠ¡ç«¯å›ºå®šåˆæˆçš„ç—›ç‚¹ï¼Œå› æ­¤æˆä¸ºæœ¬æ¬¡éœ€æ±‚çš„æ ¸å¿ƒæŠ€æœ¯é€‰å‹ã€‚</p>
<p>ä¸ºäº†è®©å¤§å®¶æ›´ç›´è§‚åœ°æ„Ÿå—ã€Œç”¨ç¯®çƒè®¤è¯†æˆ‘ã€æ´»åŠ¨ä¸­ â€œç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆä¸“å±çƒæ˜Ÿå¡â€ ç©æ³•ï¼Œæˆ‘ä»¬å‡†å¤‡äº†æ´»åŠ¨å®é™…æ•ˆæœå½•å±ã€‚é€šè¿‡å½•å±ï¼Œä½ å¯ä»¥æ¸…æ™°çœ‹åˆ°ç”¨æˆ·å¦‚ä½•é€šè¿‡å•æŒ‡æ‹–æ‹½ã€åŒæŒ‡ç¼©æ”¾ / æ—‹è½¬äººåƒï¼Œå®Œæˆæ„å›¾è°ƒæ•´åç”Ÿæˆçƒæ˜Ÿå¡çš„å…¨è¿‡ç¨‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c6d364c65f564fdb941ca847fa126f8f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=V5UBY3EPViU4uKz7GXyKm%2BQbsXg%3D" alt="æˆªå±2025-12-26 ä¸‹åˆ2.53.53.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6dcfe266cdd24d82a2bb2786b546c284~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=UxMDfNCTXiTbWYYDFzIEEJsjEPQ%3D" alt="æˆªå±2025-12-26 ä¸‹åˆ2.54.01.png" loading="lazy"/></p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å›´ç»•ä¸šåŠ¡ç›®æ ‡ï¼Œè¯¦ç»†æ‹†è§£å®ç°è¯¥é“¾è·¯çš„å…·ä½“ä»»åŠ¡ä¼˜å…ˆçº§ä¸æ ¸å¿ƒæ¨¡å—ã€‚</p>
<h2 data-id="heading-2">ä¸‰ã€å¦‚ä½•å®ç°æ ¸å¿ƒäº¤äº’é“¾è·¯ï¼Ÿ</h2>
<p>ç»“åˆã€Œç”¨ç¯®çƒè®¤è¯†æˆ‘ã€çƒæ˜Ÿå¡ç”Ÿæˆçš„æ ¸å¿ƒä¸šåŠ¡ç›®æ ‡ï¼ŒæŒ‰â€˜åŸºç¡€åŠŸèƒ½â†’äº¤äº’ä½“éªŒâ†’æ‹“å±•èƒ½åŠ›â†’ç¨³å®šæ€§â€™ä¼˜å…ˆçº§ï¼Œå°†éœ€æ±‚æ‹†è§£ä¸ºä»¥ä¸‹ 6 é¡¹ä»»åŠ¡ï¼š</p>
<ol>
<li><strong>PAG æ’­æ”¾å™¨åŸºç¡€åŠŸèƒ½æ­å»º</strong>ï¼šå®ç°æ’­æ”¾ / æš‚åœã€å›¾å±‚æ›¿æ¢ã€æ–‡æœ¬ä¿®æ”¹ã€åˆæˆå›¾å¯¼å‡ºï¼Œä¸ºåç»­äº¤äº’æ‰“åŸºç¡€ï¼›</li>
<li><strong>å›¾ç‰‡äº¤äº’å˜æ¢åŠŸèƒ½å¼€å‘</strong>ï¼šæ”¯æŒå•æŒ‡æ‹–æ‹½ã€åŒæŒ‡ç¼©æ”¾ / æ—‹è½¬ï¼Œæ»¡è¶³äººåƒæ„å›¾è°ƒæ•´éœ€æ±‚ï¼›</li>
<li><strong>äº¤äº’ä¸é¢„è§ˆå®æ—¶åŒæ­¥</strong>ï¼šå°†å›¾ç‰‡è°ƒæ•´çŠ¶æ€å®æ—¶åŒæ­¥è‡³ PAG å›¾å±‚ï¼Œå®ç° â€œæ“ä½œå³é¢„è§ˆâ€ï¼›</li>
<li><strong>æ‰¹é‡åˆæˆèƒ½åŠ›æ‹“å±•</strong>ï¼šåŸºäºå•å¼ åˆæˆé€»è¾‘ï¼Œæ”¯æŒä¸€æ¬¡æ€§ç”Ÿæˆå¤šå¼ çƒæ˜Ÿå¡ï¼ˆä¾èµ–ä»»åŠ¡ 1-3ï¼‰ï¼›</li>
<li><strong>å…¨é“¾è·¯æ€§èƒ½ä¼˜åŒ–</strong>ï¼šä¼˜åŒ– PAG å®ä¾‹é‡Šæ”¾ã€å›¾å±‚æ¸²æŸ“æ•ˆç‡ï¼Œä¿éšœ H5 æµç•…åº¦ï¼ˆè´¯ç©¿å…¨æµç¨‹ï¼‰ï¼›</li>
<li><strong>å¼‚å¸¸åœºæ™¯é™çº§å…¼å®¹</strong>ï¼šé’ˆå¯¹ SDK ä¸æ”¯æŒåœºæ™¯ï¼Œè®¾è®¡é™æ€å›¾å±‚ã€æœåŠ¡ç«¯åˆæˆç­‰å…œåº•æ–¹æ¡ˆï¼ˆåŒæ­¥æ¨è¿›ï¼‰ã€‚</li>
</ol>
<p>åœ¨æ˜ç¡®æ ¸å¿ƒä»»åŠ¡æ‹†è§£åï¼Œé¦–è¦ç¯èŠ‚æ˜¯æ­å»º PAG æ’­æ”¾å™¨åŸºç¡€èƒ½åŠ› â€”â€” è¿™æ˜¯åç»­å›¾å±‚æ›¿æ¢ã€æ–‡æœ¬ä¿®æ”¹ã€çƒæ˜Ÿå¡åˆæˆçš„å‰æï¼Œéœ€ä» SDK åŠ è½½ã€æ’­æ”¾å™¨åˆå§‹åŒ–ã€æ ¸å¿ƒåŠŸèƒ½å°è£…é€æ­¥è½åœ°ã€‚</p>
<h2 data-id="heading-3">å››ã€åŸºç¡€PAGæ’­æ”¾å™¨å®ç°</h2>
<h3 data-id="heading-4">åŠ è½½PAG SDK</h3>
<p>å› ä¸ºæ˜¯é¦–æ¬¡æ¥è§¦PAG ï¼Œæ‰€ä»¥åœ¨é¦–æ¬¡åŠ è½½ SDK ç¯èŠ‚ä¾¿é‡åˆ°äº†éœ€è¦æ³¨æ„çš„ç»†èŠ‚ï¼š</p>
<p>libpag çš„ SDK åŠ è½½åŒ…å«ä¸¤éƒ¨åˆ†æ ¸å¿ƒæ–‡ä»¶ï¼š</p>
<ul>
<li>ä¸»ä½“ libpag.min.js</li>
<li>é…å¥—çš„ libpag.wasm</li>
</ul>
<p><strong>éœ€ç‰¹åˆ«æ³¨æ„</strong>ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œwasmæ–‡ä»¶éœ€ä¸ libpag.min.js ç½®äºåŒä¸€ç›®å½•ï¼Œè‹¥éœ€è‡ªå®šä¹‰è·¯å¾„ï¼Œä¹Ÿå¯æ‰‹åŠ¨æŒ‡å®šå…¶ä½ç½®ã€‚ï¼ˆåŠ è½½SDKå‚è€ƒæ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fpag.io%2Fdocs%2Fuse-web-sdk.html%25EF%25BC%2589" target="_blank" title="https://pag.io/docs/use-web-sdk.html%EF%BC%89" ref="nofollow noopener noreferrer">pag.io/docs/use-weâ€¦</a></p>
<p>åœ¨æœ¬é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å°†ä¸¤ä¸ªæ–‡ä»¶ä¸€åŒä¸Šä¼ è‡³ OSSçš„åŒä¸€è·¯å¾„ä¸‹ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fh5static.xx%2F10122053%2Flibpag.min.js" target="_blank" title="https://h5static.xx/10122053/libpag.min.js" ref="nofollow noopener noreferrer">h5static.xx/10122053/liâ€¦</a> <a href="https://link.juejin.cn?target=https%3A%2F%2Fh5static.xx%2F10122053%2Flibpag.wasm" target="_blank" title="https://h5static.xx/10122053/libpag.wasm" ref="nofollow noopener noreferrer">h5static.xx/10122053/liâ€¦</a></p>
<p>é€šè¿‡ CDN æ–¹å¼å®ŒæˆåŠ è½½ï¼Œç¡®ä¿èµ„æºè·¯å¾„åŒ¹é…ã€‚</p>
<p>SDKåŠ è½½æ ¸å¿ƒä»£ç ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span>Â loadLibPag =Â <span class="hljs-title function_">useCallback</span>(<span class="hljs-keyword">async</span>Â () =&gt; {
Â Â <span class="hljs-comment">// è‹¥å·²åŠ è½½ï¼Œç›´æ¥è¿”å›</span>
Â Â <span class="hljs-keyword">if</span>Â (<span class="hljs-variable language_">window</span>.<span class="hljs-property">libpag</span>) {
Â  Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-variable language_">window</span>.<span class="hljs-property">libpag</span>
Â  }
Â Â 
Â Â <span class="hljs-keyword">try</span>Â {
Â  Â Â <span class="hljs-comment">// åŠ¨æ€åˆ›å»ºscriptæ ‡ç­¾åŠ è½½SDK</span>
Â  Â Â <span class="hljs-keyword">const</span>Â script =Â <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'script'</span>)
Â  Â  script.<span class="hljs-property">src</span>Â =Â <span class="hljs-string">'https://h5static.XX/10122053/libpag.min.js'</span>
Â  Â Â <span class="hljs-variable language_">document</span>.<span class="hljs-property">head</span>.<span class="hljs-title function_">appendChild</span>(script)
Â  Â Â 
Â  Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span>Â {
Â  Â  Â  script.<span class="hljs-property">onload</span>Â =Â <span class="hljs-keyword">async</span>Â () =&gt; {
Â  Â  Â  Â Â <span class="hljs-comment">// ç­‰å¾…500msç¡®ä¿åº“å®Œå…¨åˆå§‹åŒ–</span>
Â  Â  Â  Â Â <span class="hljs-keyword">await</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span>Â =&gt;</span>Â <span class="hljs-built_in">setTimeout</span>(resolve,Â <span class="hljs-number">500</span>))
Â  Â  Â  Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'LibPag script loaded, checking window.libpag:'</span>,Â <span class="hljs-variable language_">window</span>.<span class="hljs-property">libpag</span>)
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-keyword">if</span>Â (<span class="hljs-variable language_">window</span>.<span class="hljs-property">libpag</span>) {
Â  Â  Â  Â  Â Â <span class="hljs-title function_">resolve</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">libpag</span>)
Â  Â  Â  Â  }Â <span class="hljs-keyword">else</span>Â {
Â  Â  Â  Â  Â Â <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Error</span>(<span class="hljs-string">'window.libpag is not available'</span>))
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  Â Â <span class="hljs-comment">// åŠ è½½å¤±è´¥å¤„ç†</span>
Â  Â  Â  script.<span class="hljs-property">onerror</span>Â =Â <span class="hljs-function">() =&gt;</span>Â <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Failed to load libPag script'</span>))
Â  Â  })
Â  }Â <span class="hljs-keyword">catch</span>Â (error) {
Â  Â Â <span class="hljs-keyword">throw</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Failed to load libPag:Â <span class="hljs-subst">${error}</span>`</span>)
Â  }
}, [])
</code></pre>
<h3 data-id="heading-5">åˆå§‹åŒ–æ’­æ”¾å™¨</h3>
<p>åŠ è½½å®Œ SDK åï¼Œwindow å¯¹è±¡ä¼šç”Ÿæˆ libpag å¯¹è±¡ï¼Œä»¥æ­¤ä¸ºåŸºç¡€å¯å®Œæˆæ’­æ”¾å™¨åˆå§‹åŒ–ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ul>
<li>å‡†å¤‡ canvas å®¹å™¨ä½œä¸ºæ¸²æŸ“è½½ä½“ï¼›</li>
<li>åŠ è½½ PAG æ ¸å¿ƒåº“å¹¶åˆå§‹åŒ– PAG ç¯å¢ƒï¼›</li>
<li>åŠ è½½ç›®æ ‡.pag æ–‡ä»¶ï¼ˆåŠ¨æ•ˆæ¨¡æ¿ï¼‰ï¼›</li>
<li>åˆ›å»º PAGView å®ä¾‹å…³è” canvas ä¸åŠ¨æ•ˆæ–‡ä»¶ï¼›</li>
<li>å°è£…æ’­æ”¾å™¨æ§åˆ¶æ¥å£ï¼ˆæ’­æ”¾ / æš‚åœ / é”€æ¯ç­‰ï¼‰ï¼Œå¹¶å¤„ç†èµ„æºé‡Šæ”¾ä¸é‡å¤åˆå§‹åŒ–é—®é¢˜ã€‚</li>
</ul>
<p>éœ€è¯´æ˜çš„æ˜¯ï¼Œæœ¬éœ€æ±‚æ ¸å¿ƒè¯‰æ±‚æ˜¯ â€œåˆæˆçƒæ˜Ÿå¡å›¾ç‰‡â€ï¼Œä¸æ¶‰åŠPAGçš„è§†é¢‘ç›¸å…³èƒ½åŠ›ï¼Œå› æ­¤æš‚ä¸æ‰©å±•è§†é¢‘åŠŸèƒ½ï¼Œåœ¨æ’­æ”¾å™¨åˆå§‹åŒ–åå®Œæˆç«‹å³æš‚åœï¼Œåç»­ä»…å›´ç»• â€œå›¾å±‚æ›¿æ¢ï¼ˆå¦‚ç”¨æˆ·äººåƒï¼‰â€â€œæ–‡æœ¬æ›¿æ¢ï¼ˆå¦‚çƒæ˜Ÿåç§°ï¼‰â€ ç­‰æ ¸å¿ƒéœ€æ±‚å±•å¼€ã€‚</p>
<p>æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span>Â { width, height } = props


<span class="hljs-comment">// Canvasæ¸²æŸ“å®¹å™¨</span>
<span class="hljs-keyword">const</span>Â canvasRef = useRef&lt;<span class="hljs-title class_">HTMLCanvasElement</span>&gt;(<span class="hljs-literal">null</span>)
<span class="hljs-comment">// PAGåŠ¨æ•ˆæ¨¡æ¿åœ°å€ï¼ˆçƒæ˜Ÿå¡æ¨¡æ¿ï¼‰</span>
<span class="hljs-keyword">const</span>Â src =Â <span class="hljs-string">'https://h5static.XX/10122053/G-lv1.pag'</span>


<span class="hljs-comment">// åˆå§‹åŒ–æ’­æ”¾å™¨å‡½æ•°</span>
<span class="hljs-keyword">const</span>Â initPlayer =Â <span class="hljs-title function_">useCallback</span>(<span class="hljs-keyword">async</span>Â () =&gt; {
Â Â 
Â Â <span class="hljs-keyword">try</span>Â {
Â  Â Â <span class="hljs-title function_">setIsLoading</span>(<span class="hljs-literal">true</span>)
Â  Â Â <span class="hljs-keyword">const</span>Â canvas = canvasRef.<span class="hljs-property">current</span>
Â  Â Â <span class="hljs-comment">// è®¾ç½®Canvaså°ºå¯¸ä¸çƒæ˜Ÿå¡åŒ¹é…</span>
Â  Â  canvas.<span class="hljs-property">width</span>Â = width
Â  Â  canvas.<span class="hljs-property">height</span>Â = height
Â  Â Â 
Â  Â Â <span class="hljs-comment">// 1. åŠ è½½PAGæ ¸å¿ƒåº“å¹¶åˆå§‹åŒ–ç¯å¢ƒ</span>
Â  Â Â <span class="hljs-keyword">const</span>Â libpag =Â <span class="hljs-keyword">await</span>Â <span class="hljs-title function_">loadLibPag</span>()
Â  Â Â <span class="hljs-keyword">const</span>Â <span class="hljs-variable constant_">PAG</span>Â =Â <span class="hljs-keyword">await</span>Â libpag.<span class="hljs-title class_">PAGInit</span>({Â <span class="hljs-attr">useScale</span>:Â <span class="hljs-literal">false</span>Â })
Â  Â Â 
Â  Â Â <span class="hljs-comment">// 2. åŠ è½½PAGåŠ¨æ•ˆæ¨¡æ¿</span>
Â  Â Â <span class="hljs-keyword">const</span>Â response =Â <span class="hljs-keyword">await</span>Â <span class="hljs-title function_">fetch</span>(src)
Â  Â Â <span class="hljs-keyword">const</span>Â buffer =Â <span class="hljs-keyword">await</span>Â response.<span class="hljs-title function_">arrayBuffer</span>()
Â  Â Â <span class="hljs-keyword">const</span>Â pagFile =Â <span class="hljs-keyword">await</span>Â <span class="hljs-variable constant_">PAG</span>.<span class="hljs-property">PAGFile</span>.<span class="hljs-title function_">load</span>(buffer)
Â  Â Â 
Â  Â Â <span class="hljs-comment">// 3. åˆ›å»ºPAGViewï¼Œå…³è”Canvasä¸åŠ¨æ•ˆæ¨¡æ¿</span>
Â  Â Â <span class="hljs-keyword">const</span>Â pagView =Â <span class="hljs-keyword">await</span>Â <span class="hljs-variable constant_">PAG</span>.<span class="hljs-property">PAGView</span>.<span class="hljs-title function_">init</span>(pagFile, canvas)
Â  Â Â 
Â  Â Â <span class="hljs-comment">// 4. å°è£…æ’­æ”¾å™¨æ§åˆ¶æ¥å£</span>
Â  Â Â <span class="hljs-keyword">const</span>Â player = {
Â  Â  Â Â <span class="hljs-attr">_pagView</span>: pagView,
Â  Â  Â Â <span class="hljs-attr">_pagFile</span>: pagFile,
Â  Â  Â Â <span class="hljs-attr">_PAG</span>:Â <span class="hljs-variable constant_">PAG</span>,
Â  Â  Â Â <span class="hljs-attr">_isPlaying</span>:Â <span class="hljs-literal">false</span>,
Â  Â  Â Â 
Â  Â  Â Â <span class="hljs-comment">// æ’­æ”¾</span>
Â  Â  Â Â <span class="hljs-keyword">async</span>Â <span class="hljs-title function_">play</span>(<span class="hljs-params"/>) {
Â  Â  Â  Â Â <span class="hljs-keyword">await</span>Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">_pagView</span>.<span class="hljs-title function_">play</span>()
Â  Â  Â  Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">_isPlaying</span>Â =Â <span class="hljs-literal">true</span>
Â  Â  Â  },
Â  Â  Â Â <span class="hljs-comment">// æš‚åœï¼ˆåˆå§‹åŒ–åé»˜è®¤æš‚åœï¼‰</span>
Â  Â  Â Â <span class="hljs-title function_">pause</span>(<span class="hljs-params"/>) {
Â  Â  Â  Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">_pagView</span>.<span class="hljs-title function_">pause</span>()
Â  Â  Â  Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">_isPlaying</span>Â =Â <span class="hljs-literal">false</span>
Â  Â  Â  },
Â  Â  Â Â <span class="hljs-comment">// é”€æ¯å®ä¾‹ï¼Œé‡Šæ”¾èµ„æº</span>
Â  Â  Â Â <span class="hljs-title function_">destroy</span>(<span class="hljs-params"/>) {
Â  Â  Â  Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">_pagView</span>.<span class="hljs-title function_">destroy</span>()
Â  Â  Â  },
Â  Â  }
Â  }Â <span class="hljs-keyword">catch</span>Â (error) {
Â  Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'PAG Player initialization failed:'</span>, error)
Â  }Â 
}, [src, width, height])
</code></pre>
<p><strong>å®ç°æ•ˆæœ</strong></p>
<p>æ’­æ”¾å™¨åˆå§‹åŒ–å®Œæˆåï¼Œå¯åœ¨Canvasä¸­æ­£å¸¸å±•ç¤ºçƒæ˜Ÿå¡åŠ¨æ•ˆæ¨¡æ¿ï¼ˆåˆå§‹åŒ–åé»˜è®¤æš‚åœï¼‰ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8fad50f876ee4dea8bea2fbcac6018de~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=PzWUqcrlOWM%2FlJAoUKvfd52Nw%2FQ%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å®ç°æ›¿æ¢å›¾å±‚åŠæ–‡æœ¬åŠŸèƒ½ã€‚</p>
<h3 data-id="heading-6">æ›¿æ¢å›¾å±‚åŠæ–‡æœ¬</h3>
<p>æ›¿æ¢ â€œç”¨æˆ·ä¸Šä¼ äººåƒâ€ï¼ˆå›¾å±‚ï¼‰ä¸ â€œçƒæ˜Ÿåç§°â€ï¼ˆæ–‡æœ¬ï¼‰æ˜¯æ ¸å¿ƒéœ€æ±‚ï¼Œéœ€é€šè¿‡ PAGFile çš„åŸç”Ÿæ¥å£å®ç°ï¼Œå¹¶æ‰©å±•æ’­æ”¾å™¨å®ä¾‹çš„æ“ä½œæ–¹æ³•ï¼š</p>
<ul>
<li><strong>å›¾ç‰‡å›¾å±‚æ›¿æ¢</strong>ï¼šè°ƒç”¨pagFile.replaceImage(index, image) æ¥å£ï¼Œå°†æŒ‡å®šç´¢å¼•çš„å›¾å±‚æ›¿æ¢ä¸ºç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ï¼ˆæ”¯æŒ CDN åœ°å€ã€Canvas å…ƒç´ ã€Image å…ƒç´ ä½œä¸ºå›¾ç‰‡æºï¼‰ï¼›</li>
<li><strong>æ–‡æœ¬å†…å®¹æ›¿æ¢</strong>ï¼šè°ƒç”¨pagFile.setTextData(index, textData) æ¥å£ï¼Œä¿®æ”¹æŒ‡å®šæ–‡æœ¬å›¾å±‚çš„å†…å®¹ä¸å­—ä½“ï¼›</li>
<li><strong>æ•ˆæœç”Ÿæ•ˆ</strong>ï¼šæ¯æ¬¡æ›¿æ¢åéœ€è°ƒç”¨ pagView.flush() å¼ºåˆ¶åˆ·æ–°æ¸²æŸ“ï¼Œç¡®ä¿ä¿®æ”¹å®æ—¶ç”Ÿæ•ˆã€‚</li>
</ul>
<p><strong>å®ç°æ–¹æ¡ˆ</strong></p>
<ul>
<li>æ›¿æ¢å›¾ç‰‡å›¾å±‚ï¼šé€šè¿‡pagFile.replaceImage(index, image)æ¥å£ï¼Œå°†æŒ‡å®šç´¢å¼•çš„å›¾å±‚æ›¿æ¢ä¸ºç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ï¼›</li>
<li>æ›¿æ¢æ–‡æœ¬å†…å®¹ï¼šé€šè¿‡pagFile.setTextData(index, textData)æ¥å£ï¼Œä¿®æ”¹æŒ‡å®šæ–‡æœ¬å›¾å±‚çš„å†…å®¹ï¼›</li>
<li>æ‰©å±•æ’­æ”¾å™¨æ¥å£åï¼Œéœ€è°ƒç”¨flush()å¼ºåˆ¶åˆ·æ–°æ¸²æŸ“ï¼Œç¡®ä¿æ›¿æ¢æ•ˆæœç”Ÿæ•ˆã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9d4f0a8a802e4de4ab1a0837984704f8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=zMWQHOUsbMz7oyiPlhxrpYCdoIg%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><strong>åˆæœŸé—®é¢˜ï¼šæ–‡æœ¬å­—ä½“æœªç”Ÿæ•ˆ</strong></p>
<p>æ›¿æ¢æ–‡æœ¬åå‘ç°è®¾å®šå­—ä½“æœªåº”ç”¨ã€‚æ’æŸ¥åç¡®è®¤ï¼šè‡ªå®šä¹‰å­—ä½“åŒ…æœªåœ¨ PAG ç¯å¢ƒä¸­æ³¨å†Œï¼Œå¯¼è‡´ PAG æ— æ³•è¯†åˆ«å­—ä½“ã€‚</p>
<p>éœ€åœ¨åŠ è½½ PAG æ¨¡æ¿å‰ï¼Œä¼˜å…ˆå®Œæˆå­—ä½“æ³¨å†Œï¼Œç¡®ä¿ PAG èƒ½æ­£å¸¸è°ƒç”¨ç›®æ ‡å­—ä½“ï¼Œå…·ä½“å®ç°æ­¥éª¤å¦‚ä¸‹ã€‚</p>
<p>PAGæä¾›PAGFont.registerFont()æ¥å£ç”¨äºæ³¨å†Œè‡ªå®šä¹‰å­—ä½“ï¼Œéœ€ä¼ å…¥ â€œå­—ä½“åç§°â€ ä¸ â€œå­—ä½“æ–‡ä»¶èµ„æºâ€ï¼ˆå¦‚.ttf/.otf æ ¼å¼æ–‡ä»¶ï¼‰ï¼Œæµç¨‹ä¸ºï¼š</p>
<ul>
<li>åŠ è½½å­—ä½“æ–‡ä»¶ï¼ˆä» CDN/OSS è·å–å­—ä½“åŒ…ï¼‰ï¼›</li>
<li>è°ƒç”¨ PAG æ¥å£å®Œæˆæ³¨å†Œï¼›</li>
<li>æ³¨å†ŒæˆåŠŸåï¼Œå†åŠ è½½.pagæ–‡ä»¶ï¼Œç¡®ä¿åç»­æ–‡æœ¬æ›¿æ¢æ—¶å­—ä½“å·²ç”Ÿæ•ˆã€‚</li>
</ul>

<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// éœ€æ³¨å†Œçš„å­—ä½“åˆ—è¡¨ï¼ˆå­—ä½“åç§°+CDNåœ°å€ï¼‰</span>
<span class="hljs-keyword">const</span>Â fonts = [
Â  {
Â  Â Â <span class="hljs-attr">family</span>:Â <span class="hljs-string">'POIZONSans'</span>,
Â  Â Â <span class="hljs-attr">url</span>:Â <span class="hljs-string">'https://h5static.XX/10122053/20250827-febf35c67d9232d4.ttf'</span>,
Â  },
Â  {
Â  Â Â <span class="hljs-attr">family</span>:Â <span class="hljs-string">'FZLanTingHeiS-DB-GB'</span>,
Â  Â Â <span class="hljs-attr">url</span>:Â <span class="hljs-string">'https://h5static.XX/10122053/20250821-1e3a4fccff659d1c.ttf'</span>,
Â  },
]


<span class="hljs-comment">// åœ¨â€œåŠ è½½PAGæ ¸å¿ƒåº“â€åã€â€œåŠ è½½PAGæ¨¡æ¿â€å‰ï¼Œæ–°å¢å­—ä½“æ³¨å†Œé€»è¾‘</span>
<span class="hljs-keyword">const</span>Â initPlayer =Â <span class="hljs-title function_">useCallback</span>(<span class="hljs-keyword">async</span>Â () =&gt; {
Â Â <span class="hljs-comment">// ... åŸæœ‰ä»£ç ï¼ˆCanvaså‡†å¤‡ã€åŠ è½½libpagï¼‰</span>
Â Â <span class="hljs-keyword">const</span>Â libpag =Â <span class="hljs-keyword">await</span>Â <span class="hljs-title function_">loadLibPag</span>()
Â Â <span class="hljs-keyword">const</span>Â <span class="hljs-variable constant_">PAG</span>Â =Â <span class="hljs-keyword">await</span>Â libpag.<span class="hljs-title class_">PAGInit</span>({Â <span class="hljs-attr">useScale</span>:Â <span class="hljs-literal">false</span>Â })
Â Â 
Â Â <span class="hljs-comment">// æ–°å¢ï¼šæ³¨å†Œè‡ªå®šä¹‰å­—ä½“</span>
Â Â <span class="hljs-keyword">if</span>Â (fonts &amp;&amp; fonts.<span class="hljs-property">length</span>Â &gt;Â <span class="hljs-number">0</span>Â &amp;&amp;Â <span class="hljs-variable constant_">PAG</span>?.<span class="hljs-property">PAGFont</span>?.<span class="hljs-property">registerFont</span>) {
Â  Â Â <span class="hljs-keyword">try</span>Â {
Â  Â  Â Â <span class="hljs-keyword">for</span>Â (<span class="hljs-keyword">const</span>Â { family, url }Â <span class="hljs-keyword">of</span>Â fonts) {
Â  Â  Â  Â Â <span class="hljs-keyword">if</span>Â (!family || !url)Â <span class="hljs-keyword">continue</span>
Â  Â  Â  Â Â <span class="hljs-comment">// åŠ è½½å­—ä½“æ–‡ä»¶ï¼ˆCORSè·¨åŸŸé…ç½®+å¼ºåˆ¶ç¼“å­˜ï¼‰</span>
Â  Â  Â  Â Â <span class="hljs-keyword">const</span>Â resp =Â <span class="hljs-keyword">await</span>Â <span class="hljs-title function_">fetch</span>(url, {Â <span class="hljs-attr">mode</span>:Â <span class="hljs-string">'cors'</span>,Â <span class="hljs-attr">cache</span>:Â <span class="hljs-string">'force-cache'</span>Â })
Â  Â  Â  Â Â <span class="hljs-keyword">const</span>Â blob =Â <span class="hljs-keyword">await</span>Â resp.<span class="hljs-title function_">blob</span>()
Â  Â  Â  Â Â <span class="hljs-comment">// è½¬æ¢ä¸ºFileç±»å‹ï¼ˆPAGæ³¨å†Œéœ€Fileæ ¼å¼ï¼‰</span>
Â  Â  Â  Â Â <span class="hljs-keyword">const</span>Â filename = url.<span class="hljs-title function_">split</span>(<span class="hljs-string">'/'</span>).<span class="hljs-title function_">pop</span>() ||Â <span class="hljs-string">'font.ttf'</span>
Â  Â  Â  Â Â <span class="hljs-keyword">const</span>Â fontFile =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">File</span>([blob], filename)
Â  Â  Â  Â Â <span class="hljs-comment">// æ³¨å†Œå­—ä½“</span>
Â  Â  Â  Â Â <span class="hljs-keyword">await</span>Â <span class="hljs-variable constant_">PAG</span>.<span class="hljs-property">PAGFont</span>.<span class="hljs-title function_">registerFont</span>(family, fontFile)
Â  Â  Â  Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Registered font for PAG:'</span>, family)
Â  Â  Â  }
Â  Â  }Â <span class="hljs-keyword">catch</span>Â (e) {
Â  Â  Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'Register fonts for PAG failed:'</span>, e)
Â  Â  }
Â  }
Â Â 
Â Â <span class="hljs-comment">// ç»§ç»­åŠ è½½PAGæ¨¡æ¿ï¼ˆåŸæœ‰ä»£ç ï¼‰</span>
Â Â <span class="hljs-keyword">const</span>Â response =Â <span class="hljs-keyword">await</span>Â <span class="hljs-title function_">fetch</span>(src)
Â Â <span class="hljs-keyword">const</span>Â buffer =Â <span class="hljs-keyword">await</span>Â response.<span class="hljs-title function_">arrayBuffer</span>()
Â Â <span class="hljs-keyword">const</span>Â pagFile =Â <span class="hljs-keyword">await</span>Â <span class="hljs-variable constant_">PAG</span>.<span class="hljs-property">PAGFile</span>.<span class="hljs-title function_">load</span>(buffer)
Â Â <span class="hljs-comment">// ... åç»­åˆ›å»ºPAGViewã€å°è£…æ’­æ”¾å™¨æ¥å£</span>
}, [src, width, height])
</code></pre>
<p><strong>æœ€ç»ˆæ•ˆæœ</strong></p>
<p>å­—ä½“æ³¨å†Œåï¼Œæ–‡æœ¬æ›¿æ¢çš„å­—ä½“æ­£å¸¸ç”Ÿæ•ˆï¼Œäººåƒä¸æ–‡æœ¬å‡æ˜¾ç¤ºæ­£ç¡®ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/405c50bb121c43049d8116a1584db07f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=objPcWRKzCFp%2FDbwdaU37xX5gJM%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>æ•°å­—å­—ä½“å·²åº”ç”¨æˆåŠŸ</p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæ›¿æ¢æ–‡æœ¬çš„å­—ä½“å·²æ­£ç¡®åº”ç”¨ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å®ç°æœ€åä¸€æ­¥ï¼Œå°†æ›´æ–°å›¾å±‚åŠæ–‡æœ¬åçš„å†…å®¹å¯¼å‡ºä¸ºCDNå›¾ç‰‡ã€‚</p>
<h3 data-id="heading-7">PagPlayeræˆªå¸§ï¼ˆå¯¼å‡ºPagPlayerå½“å‰å±•ç¤ºå†…å®¹ï¼‰</h3>
<p>æˆªå¸§æ˜¯å°† â€œè°ƒæ•´åçš„äººåƒ + æ›¿æ¢åçš„æ–‡æœ¬ + åŠ¨æ•ˆæ¨¡æ¿â€ å›ºåŒ–ä¸ºæœ€ç»ˆå›¾ç‰‡çš„å…³é”®æ­¥éª¤ã€‚å¼€å‘åˆæœŸæ›¾ç›´æ¥è°ƒç”¨pagView.makeSnapshot()é­é‡å¯¼å‡ºç©ºå¸§ï¼Œåé€šè¿‡updateSize()+flush()è§£å†³åŒæ­¥é—®é¢˜ï¼›æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ç§æ›´ç›´æ¥çš„æ–¹æ¡ˆ â€”â€”ç›´æ¥å¯¼å‡ºPAGæ¸²æŸ“å¯¹åº”çš„Canvaså†…å®¹ï¼ŒåŒæ ·èƒ½å®ç°éœ€æ±‚ï¼Œä¸”æµç¨‹æ›´ç®€æ´ã€‚</p>
<p><strong>åˆæœŸé—®é¢˜ï¼šç›´æ¥è°ƒç”¨æ¥å£å¯¼è‡´ç©ºå¸§</strong></p>
<p>å¼€å‘åˆæœŸï¼Œå°è¯•ç›´æ¥ä½¿ç”¨PAGViewæä¾›çš„makeSnapshot()æ¥å£æˆªå¸§ï¼Œä½†é‡åˆ°äº†è¿”å›ç©ºå¸§ï¼ˆå…¨é€æ˜å›¾ç‰‡ï¼‰æƒ…å†µç»è¿‡åå¤è°ƒè¯•å’ŒæŸ¥é˜…æ–‡æ¡£ï¼Œå‘ç°æ ¸å¿ƒåŸå› æ˜¯PAG æ¸²æŸ“çŠ¶æ€ä¸è°ƒç”¨æ—¶æœºä¸åŒæ­¥ï¼š</p>
<ul>
<li><strong>å°ºå¯¸ä¸åŒæ­¥</strong>ï¼šPAGView å†…éƒ¨æ¸²æŸ“å°ºå¯¸ä¸ Canvas å®é™…å°ºå¯¸ä¸åŒ¹é…ï¼Œå¯¼è‡´å†…å®¹æœªè½åœ¨å¯è§†åŒºåŸŸï¼›</li>
<li><strong>æ¸²æŸ“å»¶è¿Ÿ</strong>ï¼šå›¾å±‚æ›¿æ¢ã€æ–‡æœ¬ä¿®æ”¹åï¼ŒGPU æ¸²æŸ“æ˜¯å¼‚æ­¥çš„ï¼Œæ­¤æ—¶æˆªå¸§åªèƒ½æ•è·åˆ°æœªæ›´æ–°çš„ç©ºç™½æˆ–æ—§å¸§ã€‚</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong></p>
<p>é’ˆå¯¹ç©ºå¸§é—®é¢˜ï¼Œç»“åˆ PAG åœ¨ H5 ç«¯ â€œåŸºäº Canvas æ¸²æŸ“â€ çš„ç‰¹æ€§ï¼Œæ¢³ç†å‡ºä¸¤ç§å¯è¡Œæ–¹æ¡ˆï¼Œæ ¸å¿ƒéƒ½æ˜¯ â€œå…ˆç¡®ä¿æ¸²æŸ“åŒæ­¥ï¼Œå†è·å–ç”»é¢â€ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/350f4915f8a14f74a5a91479c8f727c0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=rekCHrp2TwcDocokRn6CqTJfcHo%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><strong>æœ€ç»ˆè½åœ°æµç¨‹</strong></p>
<ul>
<li>è°ƒç”¨ pagView.updateSize() ä¸ pagView.flush() ç¡®ä¿æ¸²æŸ“åŒæ­¥ï¼›</li>
<li>é€šè¿‡canvas.toDataURL('image/jpeg', 0.9) ç”Ÿæˆ Base64 æ ¼å¼å›¾ç‰‡ï¼ˆJPG æ ¼å¼ï¼Œæ¸…æ™°åº¦ 0.9ï¼Œå¹³è¡¡è´¨é‡ä¸ä½“ç§¯ï¼‰ï¼›</li>
<li>å°† Base64 å›¾ç‰‡ä¸Šä¼ è‡³ CDNï¼Œè·å–å¯è®¿é—®çš„çƒæ˜Ÿå¡é“¾æ¥ã€‚</li>
</ul>
<p>ç‚¹å‡»æˆªå¸§æŒ‰é’®åï¼Œå³å¯ç”Ÿæˆå¯¹åº”çš„æˆªå›¾ã€‚</p>
<p>å®Œæˆ PAG æ’­æ”¾å™¨çš„åŸºç¡€åŠŸèƒ½ï¼ˆå›¾å±‚æ›¿æ¢ã€æ–‡æœ¬ä¿®æ”¹ã€æˆªå¸§å¯¼å‡ºï¼‰åï¼Œæˆ‘ä»¬æ¥èšç„¦ç”¨æˆ·æ ¸å¿ƒäº¤äº’éœ€æ±‚ â€”â€” äººåƒçš„æ‹–æ‹½ã€ç¼©æ”¾ä¸æ—‹è½¬ï¼Œé€šè¿‡å°è£… Canvas æ‰‹åŠ¿ç»„ä»¶ï¼Œå®ç°ç²¾å‡†çš„äººåƒæ„å›¾è°ƒæ•´èƒ½åŠ›ã€‚</p>
<h2 data-id="heading-8">äº”ã€å›¾ç‰‡å˜æ¢åŠŸèƒ½å¼€å‘ï¼šå®ç°äººåƒæ‹–æ‹½ã€ç¼©æ”¾ä¸æ—‹è½¬</h2>
<p>åœ¨çƒæ˜Ÿå¡åˆæˆæµç¨‹ä¸­ï¼Œç”¨æˆ·éœ€è‡ªä¸»è°ƒæ•´ä¸Šä¼ äººåƒçš„ä½ç½®ã€å°ºå¯¸ä¸è§’åº¦ä»¥ä¼˜åŒ–æ„å›¾ã€‚æˆ‘ä»¬å¯ä»¥åŸºäº Canvas å°è£…å®Œæ•´çš„æ‰‹åŠ¿äº¤äº’èƒ½åŠ›ç»„ä»¶ï¼Œæ”¯æŒå•æŒ‡æ‹–æ‹½ã€åŒæŒ‡ç¼©æ”¾ / æ—‹è½¬ï¼ŒåŒæ—¶å…¼é¡¾é«˜æ¸…æ¸²æŸ“ä¸è·¨è®¾å¤‡å…¼å®¹æ€§ã€‚</p>
<h3 data-id="heading-9">åŠŸèƒ½ç›®æ ‡</h3>
<p>é’ˆå¯¹ â€œç”¨æˆ·äººåƒè°ƒæ•´â€ åœºæ™¯ï¼Œç»„ä»¶éœ€å®ç°ä»¥ä¸‹æ ¸å¿ƒèƒ½åŠ›ï¼š</p>
<ul>
<li><strong>åŸºç¡€äº¤äº’</strong>ï¼šæ”¯æŒå•æŒ‡æ‹–æ‹½ç§»åŠ¨äººåƒã€åŒæŒ‡ç¼©æ”¾å°ºå¯¸ã€åŒæŒ‡æ—‹è½¬è§’åº¦ï¼›</li>
<li><strong>çº¦æŸæ§åˆ¶</strong>ï¼šé™åˆ¶ç¼©æ”¾èŒƒå›´ï¼ˆå¦‚æœ€å° 0.1 å€ã€æœ€å¤§ 5 å€ï¼‰ï¼Œå¯é€‰å…³é—­æ—‹è½¬åŠŸèƒ½ï¼›</li>
<li><strong>é«˜æ¸…æ¸²æŸ“</strong>ï¼šé€‚é…è®¾å¤‡åƒç´ æ¯”ï¼ˆDPRï¼‰ï¼Œé¿å…å›¾ç‰‡æ‹‰ä¼¸æ¨¡ç³Šï¼›</li>
<li><strong>çŠ¶æ€åŒæ­¥</strong>ï¼šå®æ—¶åé¦ˆå½“å‰å˜æ¢å‚æ•°ï¼ˆåç§»é‡ã€ç¼©æ”¾æ¯”ã€æ—‹è½¬è§’ï¼‰ï¼Œæ”¯æŒé‡ç½®ä¸ç»“æœå¯¼å‡ºã€‚</li>
</ul>
<h3 data-id="heading-10">æ•ˆæœå±•ç¤º</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/811762938b80442bad5020688afbaf2e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=hQMmlIYHZRjYm%2BGX3fthzZRJpyw%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<h3 data-id="heading-11">ç»„ä»¶è®¾è®¡ç†å¿µ</h3>
<p>åœ¨ç»„ä»¶è®¾è®¡ä¹‹åˆï¼Œæˆ‘ä»¬æ¥ä½¿ç”¨åˆ†å±‚ç†å¿µï¼Œå°†å›¾ç‰‡ç¼–è¾‘æ“ä½œåˆ†è§£ä¸ºä¸‰ä¸ªç‹¬ç«‹å±‚æ¬¡ï¼š</p>
<p><strong>äº¤äº’æ„ŸçŸ¥å±‚</strong></p>
<p><strong>äº¤äº’æ„ŸçŸ¥å±‚ - æ•è·ç”¨æˆ·æ‰‹åŠ¿å¹¶è½¬æ¢ä¸ºæ ‡å‡†åŒ–çš„å˜æ¢æ„å›¾</strong></p>
<ul>
<li>æ‰‹åŠ¿è¯­ä¹‰åŒ–ï¼šå°†åŸå§‹çš„é¼ æ ‡/è§¦æ‘¸äº‹ä»¶è½¬æ¢ä¸ºè¯­ä¹‰åŒ–çš„æ“ä½œæ„å›¾</li>
<li>å•æŒ‡ç§»åŠ¨ = å¹³ç§»æ„å›¾</li>
<li>åŒæŒ‡è·ç¦»å˜åŒ– = ç¼©æ”¾æ„å›¾</li>
<li>åŒæŒ‡è§’åº¦å˜åŒ– = æ—‹è½¬æ„å›¾</li>
<li>åŒå‡» = é‡ç½®æ„å›¾</li>
</ul>
<p><strong>å˜æ¢è®¡ç®—å±‚</strong></p>
<p><strong>å˜æ¢è®¡ç®—å±‚ - å¤„ç†å‡ ä½•å˜æ¢é€»è¾‘å’Œçº¦æŸè§„åˆ™</strong></p>
<ul>
<li><strong>å¤šç‚¹è§¦æ§çš„å‡ ä½•è®¡ç®—</strong>ï¼šåŒæŒ‡æ“ä½œæ—¶ï¼Œç³»ç»Ÿä¼šå®æ—¶è®¡ç®—ä¸¤ä¸ªè§¦ç‚¹å½¢æˆçš„å‡ ä½•å…³ç³»ï¼ˆè·ç¦»ã€è§’åº¦ã€ä¸­å¿ƒç‚¹ï¼‰ï¼Œç„¶åå°†è¿™äº›å‡ ä½•å˜åŒ–æ˜ å°„ä¸ºå›¾ç‰‡çš„å˜æ¢å‚æ•°ã€‚</li>
<li><strong>äº¤äº’è¿ç»­æ€§</strong>ï¼šæ¯æ¬¡æ‰‹åŠ¿å¼€å§‹æ—¶è®°å½•åˆå§‹çŠ¶æ€ï¼Œç§»åŠ¨è¿‡ç¨‹ä¸­æ‰€æœ‰è®¡ç®—éƒ½åŸºäºè¿™ä¸ªåˆå§‹çŠ¶æ€è¿›è¡Œå¢é‡è®¡ç®—ï¼Œç¡®ä¿å˜æ¢çš„è¿ç»­æ€§å’Œå¹³æ»‘æ€§ã€‚</li>
</ul>
<p><strong>æ¸²æŸ“æ‰§è¡Œå±‚</strong></p>
<p><strong>æ¸²æŸ“æ‰§è¡Œå±‚ - å°†å˜æ¢ç»“æœç»˜åˆ¶åˆ°Canvasä¸Š</strong></p>
<ul>
<li><strong>é«˜æ¸…é€‚é…</strong>ï¼šCanvasçš„ç‰©ç†åˆ†è¾¨ç‡å’Œæ˜¾ç¤ºå°ºå¯¸åˆ†ç¦»ç®¡ç†ï¼Œç‰©ç†åˆ†è¾¨ç‡é€‚é…è®¾å¤‡åƒç´ æ¯”ä¿è¯æ¸…æ™°åº¦ï¼Œæ˜¾ç¤ºå°ºå¯¸æ§åˆ¶ç•Œé¢å¸ƒå±€ã€‚</li>
<li><strong>å˜æ¢åº”ç”¨</strong>ï¼šç»˜åˆ¶æ—¶æŒ‰ç…§ç‰¹å®šé¡ºåºåº”ç”¨å˜æ¢ - å…ˆç§»åŠ¨åˆ°ç”»å¸ƒä¸­å¿ƒå»ºç«‹åæ ‡ç³»ï¼Œå†åº”ç”¨ç”¨æˆ·çš„å¹³ç§»ã€æ—‹è½¬ã€ç¼©æ”¾æ“ä½œï¼Œæœ€åä»¥å›¾ç‰‡ä¸­å¿ƒä¸ºåŸç‚¹ç»˜åˆ¶ã€‚è¿™ä¸ªé¡ºåºç¡®ä¿äº†å˜æ¢çš„ç›´è§‚æ€§ã€‚</li>
<li><strong>æ¸²æŸ“æ§åˆ¶</strong>ï¼šåŒºåˆ†å®æ—¶äº¤äº’å’Œé™æ€æ˜¾ç¤ºä¸¤ç§åœºæ™¯ï¼Œå®æ—¶äº¤äº’æ—¶ä½¿ç”¨requestAnimationFrameä¿è¯æµç•…æ€§ï¼Œé™æ€æ›´æ–°æ—¶ä½¿ç”¨é˜²æŠ–å‡å°‘ä¸å¿…è¦çš„é‡ç»˜ã€‚</li>
</ul>
<h3 data-id="heading-12">æ•°æ®æµè®¾è®¡</h3>
<ul>
<li><strong>å•å‘æ•°æ®æµ</strong>ï¼šç”¨æˆ·æ“ä½œ â†’ æ‰‹åŠ¿è§£æ â†’ å˜æ¢è®¡ç®— â†’ çº¦æŸåº”ç”¨ â†’ çŠ¶æ€æ›´æ–° â†’ é‡æ–°æ¸²æŸ“ â†’ å›è°ƒé€šçŸ¥ã€‚è¿™ç§å•å‘æµåŠ¨ä¿è¯äº†æ•°æ®çš„å¯è¿½è¸ªæ€§ã€‚</li>
<li><strong>çŠ¶æ€åŒæ­¥æœºåˆ¶</strong>ï¼šå†…éƒ¨çŠ¶æ€å˜åŒ–æ—¶ï¼Œé€šè¿‡å›è°ƒæœºåˆ¶åŒæ­¥ç»™å¤–éƒ¨ç»„ä»¶ï¼Œæ”¯æŒå®æ—¶åŒæ­¥å’Œå»¶è¿ŸåŒæ­¥ä¸¤ç§æ¨¡å¼ï¼Œé€‚åº”ä¸åŒçš„æ€§èƒ½éœ€æ±‚ã€‚</li>
</ul>
<p>å®ç°ç‹¬ç«‹çš„äººåƒäº¤äº’è°ƒæ•´åŠŸèƒ½åï¼Œå…³é”®æ˜¯æ‰“é€š â€œç”¨æˆ·æ“ä½œâ€ ä¸ â€œPAG é¢„è§ˆâ€ çš„å®æ—¶åŒæ­¥é“¾è·¯ â€”â€” ç¡®ä¿ç”¨æˆ·æ¯ä¸€æ¬¡è°ƒæ•´éƒ½èƒ½å³æ—¶åé¦ˆåœ¨çƒæ˜Ÿå¡æ¨¡æ¿ä¸­ï¼Œè¿™éœ€è¦è®¾è®¡åˆ†å±‚åŒæ­¥æ¶æ„ä¸é«˜æ•ˆè°ƒåº¦ç­–ç•¥ã€‚</p>
<h2 data-id="heading-13">å…­ã€äº¤äº’ä¸é¢„è§ˆå®æ—¶åŒæ­¥</h2>
<p>åœ¨çƒæ˜Ÿå¡ç”Ÿæˆæµç¨‹ä¸­ï¼Œâ€œç”¨æˆ·è°ƒæ•´äººåƒâ€ ä¸ â€œPAG é¢„è§ˆæ›´æ–°â€ çš„å®æ—¶åŒæ­¥æ˜¯æ ¸å¿ƒä½“éªŒæŒ‡æ ‡ â€”â€” ç”¨æˆ·æ¯ä¸€æ¬¡æ‹–æ‹½ã€ç¼©æ”¾æˆ–æ—‹è½¬æ“ä½œï¼Œéƒ½éœ€è¦å³æ—¶åé¦ˆåœ¨çƒæ˜Ÿå¡æ¨¡æ¿ä¸­ï¼Œæ‰èƒ½è®©ç”¨æˆ·ç²¾å‡†åˆ¤æ–­æ„å›¾æ•ˆæœã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹å®ç°æ•ˆæœï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fda5eb04c8744b7d81053047e34321cc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=Fy2ZE0uP%2Bt%2FHLI2li8UCJy387mo%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä»é€»è¾‘æ¶æ„ã€å…³é”®æŠ€æœ¯æ–¹æ¡ˆã€è¾¹ç•Œåœºæ™¯å¤„ç†ä¸‰æ–¹é¢ï¼Œæ‹†è§£ â€œç”¨æˆ·äº¤äº’è°ƒæ•´â€ ä¸ â€œPAG é¢„è§ˆåŒæ­¥â€ é“¾è·¯çš„å®ç°æ€è·¯ã€‚</p>
<h3 data-id="heading-14">é€»è¾‘æ¶æ„ï¼šä¸‰å±‚ååŒåŒæ­¥æ¨¡å‹</h3>
<p>ç»„ä»¶å°† â€œäº¤äº’ - åŒæ­¥ - æ¸²æŸ“â€ æ‹†åˆ†ä¸ºä¸‰ä¸ªç‹¬ç«‹ä½†ååŒçš„å±‚çº§ï¼Œå„å±‚èŒè´£å•ä¸€ä¸”é€šè¿‡æ˜ç¡®æ¥å£é€šä¿¡ï¼Œé¿å…è€¦åˆå¯¼è‡´çš„åŒæ­¥å»¶è¿Ÿæˆ–çŠ¶æ€æ··ä¹±ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/72b5b151b1cb40cd9fcae281a5dab73d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=oZI%2F8D5Nyk4%2BLU%2FKYCGq5ajDBgs%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><strong>æ ¸å¿ƒæµè½¬é“¾è·¯</strong>ï¼šç”¨æˆ·æ“ä½œ â†’ CanvasImageEditor ç”Ÿæˆå®æ—¶ Canvas â†’ åŒæ­¥å±‚ç›´æ¥å¤ç”¨ Canvas æ›´æ–° PAG å›¾å±‚ â†’ è°ƒåº¦å±‚æ‰¹é‡è§¦å‘ flush â†’ PagPlayer æ¸²æŸ“æœ€æ–°ç”»é¢ã€‚</p>
<h3 data-id="heading-15">å…³é”®æ–¹æ¡ˆï¼šä½æŸè€— + é«˜å®æ—¶æ€§çš„å¹³è¡¡</h3>
<p>ä¸ºåŒæ—¶å…¼é¡¾ â€œé«˜é¢‘äº¤äº’å¯¼è‡´ GPU æ€§èƒ½ç“¶é¢ˆâ€ ä¸ â€œå®æ—¶é¢„è§ˆéœ€å³æ—¶åé¦ˆâ€ ï¼Œç»„ä»¶é€šè¿‡ä¸‰å¤§æ ¸å¿ƒæŠ€æœ¯æ–¹æ¡ˆå®ç°å¹³è¡¡ã€‚</p>
<p><strong>å¤ç”¨ Canvas å…ƒç´ </strong></p>
<p>è·³è¿‡æ ¼å¼è½¬æ¢ç¯èŠ‚ï¼Œå‡å°‘æ€§èƒ½æ¶ˆè€—ï¼Œç›´æ¥å¤ç”¨ Canvas å…ƒç´ ä½œä¸º PAG å›¾ç‰‡æºã€‚</p>
<p><strong>æ ¸å¿ƒä»£ç é€»è¾‘ï¼š</strong></p>
<p>é€šè¿‡ canvasEditorRef.current.getCanvas() è·å–äº¤äº’å±‚çš„ Canvas å®ä¾‹ï¼Œç›´æ¥ä¼ å…¥PAG çš„ replaceImageFast æ¥å£ï¼ˆå¿«é€Ÿæ›¿æ¢ï¼Œä¸è§¦å‘å³æ—¶åˆ·æ–°ï¼‰ï¼Œé¿å…æ•°æ®å†—ä½™å¤„ç†ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">// ç›´æ¥ä½¿ç”¨ Canvas å…ƒç´ æ›´æ–° PAGï¼Œæ— æ ¼å¼è½¬æ¢
constÂ <span class="hljs-attr">canvas</span> = canvasEditorRef.current.getCanvas()<span class="hljs-comment">;</span>
pagPlayerRef.current.replaceImageFast(editImageIndex, canvas)<span class="hljs-comment">;Â // å¿«é€Ÿæ›¿æ¢ï¼Œä¸flush</span>
</code></pre>
<p><strong>æ™ºèƒ½æ‰¹é‡è°ƒåº¦ï¼š</strong></p>
<p><strong>åˆ†çº§å¤„ç†æ›´æ–°ï¼Œå…¼é¡¾æµç•…ä¸æ•ˆç‡</strong></p>
<p>é’ˆå¯¹ç”¨æˆ·è¿ç»­æ“ä½œï¼ˆå¦‚å¿«é€Ÿæ‹–æ‹½ï¼‰äº§ç”Ÿçš„é«˜é¢‘æ›´æ–°ï¼Œç»„ä»¶è®¾è®¡ â€œåˆ†çº§è°ƒåº¦ç­–ç•¥â€ï¼Œé¿å…æ¯ä¸€æ¬¡æ“ä½œéƒ½è§¦å‘ PAG çš„ flushï¼ˆGPU å¯†é›†å‹æ“ä½œï¼‰ï¼š</p>
<p><strong>è°ƒåº¦é€»è¾‘</strong>ï¼š</p>
<p>å®æ—¶æ“ä½œåˆå¹¶ï¼šé€šè¿‡ requestAnimationFrame æ•è·è¿ç»­æ“ä½œï¼Œå°† 16ms å†…çš„å¤šæ¬¡æ›¿æ¢æŒ‡ä»¤åˆå¹¶ä¸ºä¸€æ¬¡ï¼›</p>
<p><strong>æ™ºèƒ½ flush å†³ç­–</strong>ï¼š</p>
<p>è‹¥è·ç¦»ä¸Šæ¬¡ flush è¶…è¿‡ 100msï¼ˆç”¨æˆ·æ“ä½œæš‚åœï¼‰ï¼Œç«‹å³è§¦å‘ flushPagView()ï¼Œç¡®ä¿é¢„è§ˆä¸å»¶è¿Ÿï¼›</p>
<p>è‹¥æ“ä½œä»åœ¨æŒç»­ï¼Œå»¶è¿Ÿ Math.max(16, updateThrottle/2) æ¯«ç§’å† flushï¼Œåˆå¹¶å¤šæ¬¡æ›´æ–°ã€‚</p>
<p><strong>é˜²æŠ–é™çº§</strong>ï¼š</p>
<p>å½“ updateThrottle &gt; 16msï¼ˆä½å®æ—¶æ€§éœ€æ±‚åœºæ™¯ï¼‰ï¼Œè‡ªåŠ¨é™çº§ä¸ºé˜²æŠ–ç­–ç•¥ï¼Œé¿å…è¿‡åº¦è°ƒåº¦ã€‚</p>
<p><strong>æ ¸å¿ƒä»£ç ç‰‡æ®µ</strong>ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// æ™ºèƒ½ flush ç­–ç•¥ï¼šçŸ­é—´éš”åˆå¹¶ï¼Œé•¿é—´éš”ç«‹å³åˆ·æ–°</span>
constÂ timeSinceLastFlush =Â Date<span class="hljs-selector-class">.now</span>() - batchUpdate<span class="hljs-selector-class">.lastFlushTime</span>;
ifÂ (timeSinceLastFlush &gt;Â <span class="hljs-number">100</span>) {
Â Â awaitÂ <span class="hljs-built_in">flushPagView</span>();Â <span class="hljs-comment">// é—´éš”ä¹…ï¼Œç«‹å³åˆ·æ–°</span>
}Â elseÂ {
Â Â <span class="hljs-comment">// å»¶è¿Ÿåˆ·æ–°ï¼Œåˆå¹¶åç»­æ“ä½œ</span>
Â Â <span class="hljs-built_in">setTimeout</span>(asyncÂ () =&gt; {
Â  Â Â ifÂ (batchUpdate.pendingUpdatesÂ &gt;Â <span class="hljs-number">0</span>) {
Â  Â  Â Â awaitÂ <span class="hljs-built_in">flushPagView</span>();
Â  Â  }
Â  },Â Math<span class="hljs-selector-class">.max</span>(<span class="hljs-number">16</span>, updateThrottle/<span class="hljs-number">2</span>));
}
</code></pre>
<p><strong>åŒå‘çŠ¶æ€æ ¡éªŒï¼š</strong></p>
<p><strong>è§£å†³é¦–å¸§ / åˆ‡æ¢åœºæ™¯çš„åŒæ­¥ç©ºç™½</strong></p>
<p>é’ˆå¯¹ â€œPAG åŠ è½½å®Œæˆä½† Canvas æœªå°±ç»ªâ€â€œCanvas å°±ç»ªä½† PAG æœªåˆå§‹åŒ–â€ ç­‰é¦–å¸§åŒæ­¥é—®é¢˜ï¼Œç»„ä»¶è®¾è®¡åŒå‘é‡è¯•æ ¡éªŒæœºåˆ¶ï¼š</p>
<ul>
<li>PAG åŠ è½½åæ ¡éªŒï¼šhandlePagLoad ä¸­å¯åŠ¨ 60 å¸§ï¼ˆçº¦ 1sï¼‰é‡è¯•ï¼Œæ£€æµ‹ Canvas ä¸ PAG å‡å°±ç»ªåï¼Œè§¦å‘åˆå§‹åŒæ­¥ï¼›</li>
<li>Canvas åŠ è½½åæ ¡éªŒï¼šhandleCanvasImageLoad åŒç†ï¼Œè‹¥ PAG æœªå°±ç»ªï¼Œé‡è¯•è‡³ä¸¤è€…çŠ¶æ€åŒ¹é…ï¼›</li>
<li>ç¼–è¾‘æ¨¡å¼åˆ‡æ¢æ ¡éªŒï¼šè¿›å…¥ startEdit æ—¶ï¼Œé€šè¿‡åƒç´ æ£€æµ‹ï¼ˆgetImageDataï¼‰åˆ¤æ–­ Canvas æ˜¯å¦æœ‰å†…å®¹ï¼Œæœ‰åˆ™ç«‹å³åŒæ­¥ï¼Œé¿å…ç©ºç™½é¢„è§ˆã€‚</li>
</ul>
<h3 data-id="heading-16">è¾¹ç•Œåœºæ™¯å¤„ç†ï¼šä¿éšœåŒæ­¥ç¨³å®šæ€§</h3>
<p><strong>ç¼–è¾‘æ¨¡å¼åˆ‡æ¢çš„çŠ¶æ€è¡”æ¥</strong></p>
<ul>
<li>è¿›å…¥ç¼–è¾‘ï¼šæš‚åœ PAG æ’­æ”¾ï¼Œæ˜¾ç¤ºé€æ˜çš„ Canvas äº¤äº’å±‚ï¼ˆopacity: 0ï¼Œä»…ä¿ç•™äº¤äº’èƒ½åŠ›ï¼‰ï¼Œè§¦å‘åˆå§‹åŒæ­¥ï¼›</li>
<li>é€€å‡ºç¼–è¾‘ï¼šæ¸…ç†æ‰¹é‡è°ƒåº¦å®šæ—¶å™¨ï¼Œå¼ºåˆ¶ flush ç¡®ä¿æœ€ç»ˆçŠ¶æ€ç”Ÿæ•ˆï¼ŒæŒ‰éœ€æ¢å¤ PAG è‡ªåŠ¨æ’­æ”¾ã€‚</li>
</ul>
<p><strong>æ–‡æœ¬æ›¿æ¢ä¸å›¾ç‰‡åŒæ­¥çš„ååŒ</strong></p>
<p>å½“å¤–éƒ¨ä¼ å…¥ textReplacementsï¼ˆå¦‚çƒæ˜Ÿåç§°ä¿®æ”¹ï¼‰æ—¶ï¼Œé€šè¿‡ç‹¬ç«‹çš„ applyToPagText æ¥å£æ›´æ–°æ–‡æœ¬å›¾å±‚ï¼Œå¹¶ä¸å›¾ç‰‡åŒæ­¥å…±äº« flush è°ƒåº¦ï¼Œé¿å…é‡å¤åˆ·æ–°ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// æ–‡æœ¬æ›¿æ¢åè§¦å‘ç»Ÿä¸€ flush</span>
<span class="hljs-built_in">useEffect</span>(() =&gt;Â {
Â Â ifÂ (textReplacements?.length) {
Â  Â Â <span class="hljs-built_in">applyToPagText</span>();
Â  Â Â <span class="hljs-built_in">flushPagView</span>();
Â  }
}, <span class="hljs-selector-attr">[textReplacements]</span>);
</code></pre>
<p><strong>ç»„ä»¶å¸è½½çš„èµ„æºæ¸…ç†</strong></p>
<p>å¸è½½æ—¶æ¸…é™¤æ‰¹é‡è°ƒåº¦çš„å®šæ—¶å™¨ï¼ˆclearTimeoutï¼‰ï¼Œé¿å…å†…å­˜æ³„æ¼ï¼›åŒæ—¶ PAG å†…éƒ¨ä¼šè‡ªåŠ¨é”€æ¯å®ä¾‹ï¼Œé‡Šæ”¾ GPU èµ„æºã€‚</p>
<h3 data-id="heading-17">PAGäººåƒå±…ä¸­æ— é®æŒ¡</h3>
<p>å‡è®¾ç»™å®šä»»æ„ä¸€å¼ å›¾ç‰‡ï¼Œæˆ‘ä»¬å°†å…¶ç»˜åˆ¶åˆ°Canvasä¸­æ—¶ï¼Œå›¾ç‰‡ç”±äºå°ºå¯¸åŸå› å¯èƒ½ä¼šå±•ç¤ºä¸å®Œæ•´ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f20320c6d45c4965a2d4a791fab68979~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=iXhbtjcj2kDyMBCDzSzqO11S%2B1Y%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>é‚£ä¹ˆï¼Œå¦‚ä½•ä¿è¯ä»»æ„å°ºå¯¸å›¾ç‰‡åœ¨å›ºå®šå°ºå¯¸Canvasä¸­åˆå§‹åŒ–é»˜è®¤å±…ä¸­æ— é®æŒ¡å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬é‡‡ç”¨ä»¥ä¸‹æ–¹æ¡ˆï¼š</p>
<p><strong>ç­‰æ¯”ç¼©æ”¾ç®—æ³•ï¼ˆContainæ¨¡å¼ï¼‰</strong></p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// è®¡ç®—é€‚é…ç¼©æ”¾æ¯”ä¾‹ï¼Œç¡®ä¿å›¾ç‰‡å®Œæ•´æ˜¾ç¤º</span>
<span class="hljs-type">const</span>Â fitScale =Â Math.<span class="hljs-built_in">min</span>(
Â  editCanvasWidth / image.width, Â Â <span class="hljs-comment">// å®½åº¦é€‚é…æ¯”ä¾‹</span>
Â  availableHeight / image.heightÂ  Â <span class="hljs-comment">// é«˜åº¦é€‚é…æ¯”ä¾‹ï¼ˆè€ƒè™‘ç•™ç™½ï¼‰</span>
)
</code></pre>
<p>æ ¸å¿ƒåŸç†ï¼š</p>
<ul>
<li>é€‰æ‹©è¾ƒå°çš„ç¼©æ”¾æ¯”ä¾‹ï¼Œç¡®ä¿å›¾ç‰‡åœ¨ä¸¤ä¸ªæ–¹å‘ä¸Šéƒ½ä¸ä¼šè¶…å‡ºè¾¹ç•Œï¼›</li>
<li>è¿™å°±æ˜¯CSSçš„object-fit: containæ•ˆæœï¼Œä¿è¯å›¾ç‰‡å®Œæ•´å¯è§ã€‚</li>
<li/>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1844bb68295646529e48d32d674b49b4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=OSov7g1%2BbYGqAa16tpQ2j1HJa0I%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><strong>é¡¶éƒ¨ç•™ç™½é¢„ç•™</strong></p>
<p>å®é™…çš„PAGæ¨¡æ¿ä¸­ï¼Œé¡¶éƒ¨ä¼šæœ‰ä¸€éƒ¨åˆ†é®æŒ¡ï¼Œå› æ­¤éœ€è¦å¯¹æ•´ä¸ªç”»å¸ƒCanvasé¡¶éƒ¨ç•™ç™½ã€‚</p>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a8c97a982a1e47449476bcb38ef04ed9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=%2FjPaXe7garlxXEPlEfFnc9KQHqU%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<ul>
<li>ä¸ºäººåƒçš„å¤´éƒ¨åŒºåŸŸé¢„ç•™ç©ºé—´</li>
<li>é¿å…é‡è¦çš„é¢éƒ¨ç‰¹å¾è¢«PAGæ¨¡æ¿çš„è£…é¥°å…ƒç´ é®æŒ¡</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5dd54db9849547c885cba5cf79fddbdd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=8cDAeZcTpWYZIm%2BSCCH78uelAHc%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><strong>æ ¸å¿ƒä»£ç </strong></p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// é¡¶éƒ¨ç•™ç™½æ¯”ä¾‹</span>
<span class="hljs-type">const</span>Â TOP_BLANK_RATIOÂ =Â <span class="hljs-number">0.2</span>


<span class="hljs-type">const</span>Â handleCanvasImageLoadÂ =Â <span class="hljs-built_in">useCallback</span>(
Â Â <span class="hljs-built_in">async</span>Â (image: HTMLImageElement) =&gt; {
Â  Â  console.<span class="hljs-built_in">log</span>(<span class="hljs-string">'Canvaså›¾ç‰‡åŠ è½½å®Œæˆ:'</span>, image.width,Â <span class="hljs-string">'x'</span>, image.height)
Â  Â Â <span class="hljs-built_in">setIsImageReady</span>(<span class="hljs-literal">true</span>)


Â  Â  <span class="hljs-comment">// åˆå§‹ç­‰æ¯”ç¼©æ”¾ä»¥å®Œæ•´å¯è§ï¼ˆcontainï¼‰</span>
Â  Â Â <span class="hljs-keyword">if</span>Â (canvasEditorRef.current) {
Â  Â  Â  <span class="hljs-comment">// é¡¶éƒ¨ç•™ç™½æ¯”ä¾‹</span>
Â  Â  Â Â <span class="hljs-type">const</span>Â TOP_BLANK_RATIO = spaceTopRatio ??Â <span class="hljs-number">0</span>
Â  Â  Â Â <span class="hljs-type">const</span>Â availableHeight = editCanvasHeight * (<span class="hljs-number">1</span>Â - TOP_BLANK_RATIO)


Â  Â  Â Â <span class="hljs-comment">// ä»¥å¯ç”¨é«˜åº¦è¿›è¡Œç­‰æ¯”ç¼©æ”¾ï¼ˆåŒæ—¶è€ƒè™‘å®½åº¦ï¼‰</span>
Â  Â  Â Â <span class="hljs-type">const</span>Â fitScaleÂ = Math.<span class="hljs-built_in">min</span>(
Â  Â  Â  Â  editCanvasWidth / image.width,Â 
Â  Â  Â  Â  availableHeight / image.height
Â  Â  Â  )


Â  Â  Â Â <span class="hljs-comment">// è®¡ç®—ä½¿å›¾ç‰‡é¡¶éƒ¨æ°å¥½ç•™ç™½ TOP_BLANK_RATIO çš„ä½ç§»</span>
Â  Â  Â Â <span class="hljs-type">const</span>Â topMarginÂ = editCanvasHeight * TOP_BLANK_RATIO
Â  Â  Â Â <span class="hljs-type">const</span>Â imageScaledHeightÂ = image.height * fitScale
Â  Â  Â Â <span class="hljs-type">const</span>Â targetCenterYÂ = topMargin + imageScaledHeight /Â <span class="hljs-number">2</span>
Â  Â  Â Â <span class="hljs-type">const</span>Â yOffsetÂ = targetCenterY - editCanvasHeight /Â <span class="hljs-number">2</span>
Â  Â  Â Â 
Â  Â  Â  canvasEditorRef.current.<span class="hljs-built_in">setTransform</span>({Â 
Â  Â  Â Â Â  x:Â <span class="hljs-number">0</span>,Â 
Â  Â  Â Â Â  y: yOffset,Â 
Â  Â  Â Â Â  scale: fitScale,Â 
Â  Â  Â Â Â  rotation:Â <span class="hljs-number">0</span>Â 
Â  Â  Â  })
Â  Â  }
Â  Â Â <span class="hljs-comment">// ...</span>
Â  },
Â  [applyToPag, flushPagView, isEditMode, editCanvasWidth, editCanvasHeight]
)
</code></pre>
<p>åœ¨å•å¼ çƒæ˜Ÿå¡çš„äº¤äº’ã€é¢„è§ˆä¸åˆæˆé“¾è·¯è·‘é€šåï¼Œéœ€è¿›ä¸€æ­¥æ‹“å±•æ‰¹é‡åˆæˆèƒ½åŠ›ï¼Œä»¥æ»¡è¶³å¤šç­‰çº§çƒæ˜Ÿå¡ä¸€æ¬¡æ€§ç”Ÿæˆçš„ä¸šåŠ¡éœ€æ±‚ï¼Œæ ¸å¿ƒåœ¨äºè§£å†³æ‰¹é‡åœºæ™¯ä¸‹çš„æ¸²æŸ“æ•ˆç‡ã€èµ„æºç®¡ç†ä¸å¹¶å‘æ§åˆ¶é—®é¢˜ã€‚</p>
<h2 data-id="heading-18">ä¸ƒã€æ‰¹é‡ç”Ÿæˆ</h2>
<p>åœ¨ä»¥ä¸Šç« èŠ‚ï¼Œæˆ‘ä»¬å®ç°äº†å•ä¸ªå¡ç‰‡çš„äº¤äº’åŠåˆæˆï¼Œä½†å®é™…çš„éœ€æ±‚ä¸­è¿˜æœ‰æ‰¹é‡ç”Ÿæˆçš„éœ€æ±‚ï¼Œç”¨æ¥åˆæˆä¸åŒç­‰çº§çš„çƒæ˜Ÿå¡ï¼Œå› æ­¤æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦å¤„ç†æ‰¹é‡ç”Ÿæˆç›¸å…³çš„é€»è¾‘ï¼ˆç¢äºç¯‡å¹…åŸå› ï¼Œè¿™é‡Œæˆ‘ä»¬å°±ä¸å±•ç¤ºä»£ç äº†ï¼Œä¸»è¦ä»¥æµç¨‹å›¾å½¢å¼æ¥å‘ˆç°ã€‚</p>
<p>ç»ç»Ÿè®¡ï¼Œç»è¿‡å„ç§æ‰‹æ®µä¼˜åŒ–åæœ¬æ´»åŠ¨ä¸­æ‰¹é‡åˆæˆ8å¼ å›¾æœ€å¿«ä»…éœ€3sï¼Œæœ€æ…¢10sï¼Œæ‰¹é‡åˆæˆè¿‡ç¨‹ç”¨æˆ·åŸºæœ¬æ˜¯æ„ŸçŸ¥ä¸åˆ°ã€‚</p>
<h3 data-id="heading-19">å…³é”®æŠ€æœ¯æ–¹æ¡ˆ</h3>
<ul>
<li>ç¦»çº¿æ¸²æŸ“éšè—å®¹å™¨ï¼šé¿å…å¸ƒå±€å¹²æ‰°</li>
<li>èµ„æºç¼“å­˜ä¸é¢„åŠ è½½ï¼šæå‡åˆæˆæ•ˆç‡</li>
<li>å¹¶å‘å·¥ä½œåç¨‹æ± ï¼šå¹³è¡¡æ€§èƒ½ä¸ç¨³å®šæ€§</li>
<li>å¤šå±‚é‡è¯•å®¹é”™ï¼šæå‡åˆæˆæˆåŠŸç‡</li>
<li>å›¾ç‰‡å¤„ç†ä¸å°ºå¯¸é€‚é…ï¼šä¿éšœåˆæˆè´¨é‡</li>
<li>ç»“åˆä¸šåŠ¡åœºæ™¯å®ç°æ‰¹é‡åˆæˆä¸­æ–­ä¸‹æ¬¡è®¿é—®é¡µé¢åå°ç»§ç»­ç”Ÿæˆçš„é€»è¾‘ï¼šä¿éšœåˆæˆåŠŸèƒ½ç¨³å®šæ€§ã€‚</li>
</ul>
<h3 data-id="heading-20">æ ¸å¿ƒæ¶æ„</h3>
<ul>
<li>èµ„æºç®¡ç†å±‚ï¼šè´Ÿè´£PAGåº“åŠ è½½ã€bufferç¼“å­˜ã€é¢„åŠ è½½è°ƒåº¦</li>
<li>ä»»åŠ¡å¤„ç†å±‚ï¼šå•ä¸ªæ¨¡æ¿çš„æ¸²æŸ“æµæ°´çº¿ï¼ŒåŒ…å«é‡è¯•æœºåˆ¶</li>
<li>å¹¶å‘æ§åˆ¶å±‚ï¼šå·¥ä½œåç¨‹æ± ç®¡ç†ï¼Œä»»åŠ¡é˜Ÿåˆ—è°ƒåº¦</li>
</ul>
<h3 data-id="heading-21">æ•´ä½“æ‰¹é‡åˆæˆæµç¨‹</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/612b7f364a01464682a2e01d60f4a0b5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=4uzWIL8yDryQcpg0M3eItoblv%2FQ%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>èŠ‚æ‹æ‹‰å–ï¼šæŒ‰ç…§å›ºå®šæ—¶é—´é—´éš”ä¾æ¬¡æ‹‰å–èµ„æºï¼Œè€Œéä¸€æ¬¡æ€§å¹¶å‘è·å–æ‰€æœ‰èµ„æº</p>
<h3 data-id="heading-22">å•ä¸ªæ¨¡æ¿å¤„ç†æµç¨‹</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8a635fd380fd46e18a0c9653cbda2bca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=udNFW54g0aY206qaj%2B3b4dCCPIs%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5c97ecbecda84aeeaa2e8375e5a4b760~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=USGY5wKbL7t%2B0UNqfSZZpDRFMSI%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<h3 data-id="heading-23">å¹¶å‘å·¥ä½œåç¨‹æ¨¡å¼</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e4ffb9d653c3461394a6d8ece9c75c42~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=zFxVlSb59WJjwShdqzKBQGKhQsE%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>å…±äº«æ¸¸æ ‡ï¼šå¤šä¸ªå·¥ä½œåç¨‹å…±åŒä½¿ç”¨çš„ä»»åŠ¡é˜Ÿåˆ—æŒ‡é’ˆï¼Œç”¨äºåè°ƒä»»åŠ¡åˆ†é…ã€‚</p>
<p>åŸå­è·å–ä»»åŠ¡ï¼šç¡®ä¿åœ¨å¹¶å‘ç¯å¢ƒä¸‹ï¼Œæ¯ä¸ªä»»åŠ¡åªè¢«ä¸€ä¸ªåç¨‹è·å–ï¼Œé¿å…é‡å¤å¤„ç†ã€‚</p>
<p>èµ„æºç®¡ç†ä¸ç¼“å­˜ç­–ç•¥</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d1b994db9a114173bcf9805939ae4b92~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=KO9Wip5uJjz2Mj6ipKUhzkf6CWU%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>æ‰¹é‡åˆæˆä¸å•å¡äº¤äº’çš„åŠŸèƒ½è½åœ°åï¼Œéœ€é’ˆå¯¹å¼€å‘è¿‡ç¨‹ä¸­å‡ºç°çš„å¡é¡¿ã€ç©ºå¸§ã€åŠ è½½æ…¢ç­‰é—®é¢˜è¿›è¡Œé’ˆå¯¹æ€§ä¼˜åŒ–ï¼ŒåŒæ—¶æ„å»ºå…¼å®¹æ€§æ£€æµ‹ä¸é™çº§æ–¹æ¡ˆï¼Œä¿éšœä¸åŒç¯å¢ƒä¸‹åŠŸèƒ½çš„ç¨³å®šå¯ç”¨ã€‚</p>
<h2 data-id="heading-24">å…«ã€æ€§èƒ½ä¼˜åŒ–ä¸é™çº§å…¼å®¹</h2>
<h3 data-id="heading-25">æ€§èƒ½ä¼˜åŒ–</h3>
<p>ä¸Šè¿°åŠŸèƒ½å¼€å‘å’Œå®ç°å¹¶éä¸€è¹´è€Œå°±ï¼Œè¿‡ç¨‹ä¸­é‡åˆ°å¾ˆå¤šé—®é¢˜ï¼Œè¯¸å¦‚ï¼š</p>
<ul>
<li>å›¾ç‰‡æ‹–åŠ¨å¡é¡¿</li>
<li>Canvaså¯¼å‡ºç©ºå›¾ã€å¯¼å‡ºå›¾ç‰‡æ¨¡ç³Š</li>
<li>æ‰¹é‡åˆæˆæ—¶é—´è¾ƒä¹…</li>
<li>PAGåˆå§‹åŠ è½½æ…¢</li>
<li>å¯¼å‡ºå›¾ç‰‡æ—¶é—´ä¹…</li>
</ul>
<p>ç­‰ç­‰é—®é¢˜ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬åœ¨å¼€å‘è¿‡ç¨‹ä¸­å°±å¯¹å„åŠŸèƒ½ç»„ä»¶è¿›è¡Œæ€§èƒ½ä¼˜åŒ–ï¼Œå¤§ä½“å¦‚ä¸‹ï¼š</p>
<p><strong>PagPlayerï¼ˆPAGæ’­æ”¾å™¨ï¼‰</strong></p>
<p><strong>èµ„æºç®¡ç†ä¼˜åŒ–</strong>ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// srcå˜åŒ–æ—¶ä¸»åŠ¨é”€æ¯æ—§å®ä¾‹ï¼Œé‡Šæ”¾WebGL/PAGèµ„æº</span>
ifÂ (srcChanged) {
Â Â ifÂ (pagPlayer) {
Â  Â Â tryÂ {
Â  Â  Â  pagPlayer<span class="hljs-selector-class">.destroy</span>()
Â  Â  }Â catchÂ (e) {
Â  Â  Â Â console<span class="hljs-selector-class">.warn</span>('Destroy previous player failed:', e)
Â  Â  }
Â  }
}
</code></pre>
<p><strong>WebGLæ£€æŸ¥ä¸é™çº§</strong>ï¼š</p>
<ul>
<li>æ£€æŸ¥WebGLæ”¯æŒï¼Œä¸å¯ç”¨æ—¶é™çº§ä¸º2Dè­¦å‘Š</li>
<li>éªŒè¯CanvasçŠ¶æ€å’Œå°ºå¯¸</li>
<li>PAGViewåˆ›å»ºå¸¦é‡è¯•æœºåˆ¶</li>
</ul>
<p><strong>å­—ä½“é¢„æ³¨å†Œ</strong>ï¼š</p>
<ul>
<li>å¿…é¡»åœ¨åŠ è½½PAGæ–‡ä»¶ä¹‹å‰æ³¨å†Œå­—ä½“</li>
<li>ä½¿ç”¨Fileç±»å‹è¿›è¡Œå­—ä½“æ³¨å†Œ</li>
</ul>
<p><strong>CanvasImageEditorï¼ˆCanvaså›¾ç‰‡ç¼–è¾‘å™¨ï¼‰</strong></p>
<p><strong>é«˜DPIä¼˜åŒ–ï¼š</strong></p>
<ul>
<li>è‡ªåŠ¨æ£€æµ‹è®¾å¤‡åƒç´ æ¯”ï¼Œé€‚é…é«˜åˆ†è¾¨ç‡è®¾å¤‡</li>
<li>åˆ†ç¦»ç‰©ç†åƒç´ å’ŒCSSåƒç´ ï¼Œç¡®ä¿æ¸…æ™°åº¦</li>
</ul>
<p><strong>å†…å­˜ç®¡ç†</strong>ï¼š</p>
<ul>
<li>ç»„ä»¶å¸è½½æ—¶è‡ªåŠ¨æ¸…ç†Canvasèµ„æº</li>
<li>å¯ç”¨é«˜è´¨é‡å›¾åƒå¹³æ»‘ï¼Œé¿å…å‡ºç°è¾¹ç¼˜é”¯é½¿</li>
<li>ä½¿ç”¨CSS touch-actionæ§åˆ¶è§¦æ‘¸è¡Œä¸º</li>
</ul>
<p><strong>EditablePagPlayerï¼ˆå¯ç¼–è¾‘PAGæ’­æ”¾å™¨ï¼‰</strong></p>
<p><strong>æ™ºèƒ½æ‰¹é‡æ›´æ–°ç³»ç»Ÿï¼š</strong></p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// é«˜æ€§èƒ½å®æ—¶æ›´æ–° - ä½¿ç”¨RAF + æ‰¹é‡flush</span>
constÂ smartApplyToPag =Â <span class="hljs-built_in">useMemo</span>(() =&gt;Â {
Â Â returnÂ () =&gt;Â {
Â  Â  rafId =Â <span class="hljs-built_in">requestAnimationFrame</span>(asyncÂ () =&gt; {
Â  Â  Â Â awaitÂ <span class="hljs-built_in">applyToPag</span>()Â <span class="hljs-comment">// å¿«é€Ÿå›¾ç‰‡æ›¿æ¢ï¼ˆæ— flushï¼‰</span>
Â  Â  Â Â <span class="hljs-built_in">smartFlush</span>(batchUpdateRef.current)Â <span class="hljs-comment">// ç®¡ç†æ‰¹é‡flush</span>
Â  Â  })
Â  }
}, <span class="hljs-selector-attr">[]</span>)
</code></pre>
<p><strong>æ‰¹é‡flushç­–ç•¥ï¼š</strong></p>
<ul>
<li>è·ç¦»ä¸Šæ¬¡flushè¶…è¿‡100msç«‹å³flush</li>
<li>å¦åˆ™å»¶è¿Ÿ16ms~updateThrottle/2åˆå¹¶å¤šæ¬¡æ›´æ–°</li>
<li>å‡å°‘PAGåˆ·æ–°æ¬¡æ•°ï¼Œæå‡æ€§èƒ½</li>
</ul>
<p><strong>å†…å­˜ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>è‡ªåŠ¨ç®¡ç†Canvaså’ŒPAGèµ„æºç”Ÿå‘½å‘¨æœŸ</li>
<li>æ™ºèƒ½é¢„çƒ­ï¼šæ£€æµ‹Canvaså†…å®¹é¿å…ä¸å¿…è¦åˆå§‹åŒ–</li>
<li>èµ„æºå¤ç”¨ï¼šå¤ç”¨Canvaså…ƒç´ </li>
</ul>
<p><strong>PAGBatchComposerï¼ˆæ‰¹é‡PAGåˆæˆå™¨ï¼‰</strong></p>
<p><strong>é«˜å¹¶å‘å¤„ç†ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å·¥ä½œåç¨‹ï¼šæŒ‰é˜Ÿåˆ—å–ä»»åŠ¡ç›´è‡³è€—å°½æˆ–å–æ¶ˆ</span>
<span class="hljs-keyword">const</span>Â <span class="hljs-title function_">runWorker</span>Â =Â <span class="hljs-keyword">async</span>Â (<span class="hljs-params"/>) =&gt; {
Â Â <span class="hljs-keyword">while</span>Â (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelled</span>) {
Â  Â Â <span class="hljs-keyword">const</span>Â idx = cursor++
Â  Â Â <span class="hljs-keyword">if</span>Â (idx &gt;= total)Â <span class="hljs-keyword">break</span>
Â  Â Â <span class="hljs-comment">// å¤„ç†å•ä¸ªæ¨¡æ¿...</span>
Â  }
}
</code></pre>
<p><strong>æ™ºèƒ½é‡è¯•æœºåˆ¶</strong>ï¼š</p>
<ul>
<li>å¤–å±‚é‡è¯•ï¼šæœ€å¤š3æ¬¡æ•´ä½“é‡è¯•ï¼Œé€’å¢å»¶è¿Ÿ</li>
<li>å†…å±‚é‡è¯•ï¼šPAGæ“ä½œçº§åˆ«é‡è¯•2æ¬¡</li>
<li>é¦–æ¬¡å»¶è¿Ÿï¼šç¬¬ä¸€ä¸ªPAGå¤„ç†å¢åŠ 500mså»¶è¿Ÿ</li>
</ul>
<p><strong>å†…å­˜ç®¡ç†</strong>ï¼š</p>
<ul>
<li>æ¯ä¸ªæ¨¡æ¿å¤„ç†å®Œæˆåç«‹å³æ¸…ç†Canvaså’ŒPAGå¯¹è±¡</li>
<li>é›†æˆCanvasè®¡æ•°å™¨ç›‘æ§å†…å­˜ä½¿ç”¨</li>
<li>æ”¯æŒå¼ºåˆ¶æ¸…ç†è¶…æ—¶å®ä¾‹</li>
</ul>
<p><strong>æ€§èƒ½ç›‘æ§debugUtils</strong></p>
<ul>
<li>æä¾›è¯¦ç»†çš„æ€§èƒ½ç›‘æ§å’Œè°ƒè¯•æ—¥å¿—</li>
<li>æ”¯æŒæ‰¹é‡ç»Ÿè®¡åˆ†æï¼ˆååé‡ã€å¹³å‡æ—¶é—´ç­‰ï¼‰</li>
</ul>
<h3 data-id="heading-26">é™çº§å…¼å®¹</h3>
<p>ç”±äºæ ¸å¿ƒä¸šåŠ¡ä¾èµ– PAG æŠ€æœ¯æ ˆï¼Œè€Œ PAG è¿è¡Œéœ€ WebGL å’Œ WebAssembly çš„åŸºç¡€APIæ”¯æŒï¼Œå› æ­¤å¿…é¡»åœ¨åº”ç”¨åˆå§‹åŒ–é˜¶æ®µå¯¹è¿™äº›åŸºç¡€ API è¿›è¡Œå…¼å®¹æ€§æ£€æµ‹ï¼Œå¹¶é’ˆå¯¹ä¸æ”¯æŒçš„ç¯å¢ƒæ‰§è¡Œé™çº§ç­–ç•¥ï¼Œä»¥ä¿éšœæ ¸å¿ƒåŠŸèƒ½å¯ç”¨æ€§ã€‚</p>
<p>æ ¸å¿ƒAPIæ£€æµ‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span>Â <span class="hljs-keyword">function</span>Â <span class="hljs-title function_">isWebGLAvailable</span>(<span class="hljs-params"/>):Â <span class="hljs-built_in">boolean</span>Â {
Â Â <span class="hljs-keyword">if</span>Â (<span class="hljs-keyword">typeof</span>Â <span class="hljs-variable language_">window</span>Â ===Â <span class="hljs-string">'undefined'</span>)Â <span class="hljs-keyword">return</span>Â <span class="hljs-literal">false</span>
Â Â <span class="hljs-keyword">try</span>Â {
Â  Â Â <span class="hljs-keyword">const</span>Â canvas =Â <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'canvas'</span>)
Â  Â Â <span class="hljs-keyword">const</span>Â gl =
Â  Â  Â  canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">'webgl'</span>) ||
Â  Â  Â  (canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">'experimental-webgl'</span>)Â <span class="hljs-keyword">as</span>Â <span class="hljs-title class_">WebGLRenderingContext</span>Â |Â <span class="hljs-literal">null</span>)
Â  Â Â <span class="hljs-keyword">return</span>Â !!gl
Â  }Â <span class="hljs-keyword">catch</span>Â (e) {
Â  Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-literal">false</span>
Â  }
}


<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">function</span>Â <span class="hljs-title function_">isWasmAvailable</span>(<span class="hljs-params"/>):Â <span class="hljs-built_in">boolean</span>Â {
Â Â <span class="hljs-keyword">try</span>Â {
Â  Â Â <span class="hljs-keyword">const</span>Â hasBasic =
Â  Â  Â Â <span class="hljs-keyword">typeof</span>Â (globalThisÂ <span class="hljs-keyword">as</span>Â <span class="hljs-built_in">any</span>).<span class="hljs-property">WebAssembly</span>Â ===Â <span class="hljs-string">'object'</span>Â &amp;&amp;
Â  Â  Â Â <span class="hljs-keyword">typeof</span>Â (<span class="hljs-title class_">WebAssembly</span>Â <span class="hljs-keyword">as</span>Â <span class="hljs-built_in">any</span>).<span class="hljs-property">instantiate</span>Â ===Â <span class="hljs-string">'function'</span>
Â  Â Â <span class="hljs-keyword">if</span>Â (!hasBasic)Â <span class="hljs-keyword">return</span>Â <span class="hljs-literal">false</span>
Â  Â Â <span class="hljs-comment">// æœ€å°æ¨¡å—æ ¡éªŒï¼Œè§„é¿â€œå­˜åœ¨ä½†ä¸å¯ç”¨â€çš„æƒ…å†µ</span>
Â  Â Â <span class="hljs-keyword">const</span>Â bytes =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Uint8Array</span>([<span class="hljs-number">0x00</span>,Â <span class="hljs-number">0x61</span>,Â <span class="hljs-number">0x73</span>,Â <span class="hljs-number">0x6d</span>,Â <span class="hljs-number">0x01</span>,Â <span class="hljs-number">0x00</span>,Â <span class="hljs-number">0x00</span>,Â <span class="hljs-number">0x00</span>])
Â  Â Â <span class="hljs-keyword">const</span>Â mod =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">WebAssembly</span>.<span class="hljs-title class_">Module</span>(bytes)
Â  Â Â <span class="hljs-keyword">const</span>Â inst =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">WebAssembly</span>.<span class="hljs-title class_">Instance</span>(mod)
Â  Â Â <span class="hljs-keyword">return</span>Â instÂ <span class="hljs-keyword">instanceof</span>Â <span class="hljs-title class_">WebAssembly</span>.<span class="hljs-property">Instance</span>
Â  }Â <span class="hljs-keyword">catch</span>Â (e) {
Â  Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-literal">false</span>
Â  }
}


<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">function</span>Â <span class="hljs-title function_">isPagRuntimeAvailable</span>(<span class="hljs-params"/>):Â <span class="hljs-built_in">boolean</span>Â {
Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title function_">isWebGLAvailable</span>() &amp;&amp;Â <span class="hljs-title function_">isWasmAvailable</span>()
}
</code></pre>
<p><strong>ç¯å¢ƒé€‚é…ç­–ç•¥</strong></p>
<ul>
<li>å…¼å®¹ç¯å¢ƒï¼ˆæ£€æµ‹é€šè¿‡ï¼‰ï¼šç›´æ¥æ‰§è¡Œ H5 ç«¯ PAG åˆå§‹åŒ–æµç¨‹ï¼Œå¯ç”¨å®Œæ•´çš„å‰ç«¯äº¤äº’ç¼–è¾‘èƒ½åŠ›ã€‚</li>
<li>ä¸å…¼å®¹ç¯å¢ƒï¼ˆæ£€æµ‹å¤±è´¥ï¼‰ï¼šè‡ªåŠ¨åˆ‡æ¢è‡³æœåŠ¡ç«¯åˆæˆé“¾è·¯ï¼Œé€šè¿‡é¢„ç”Ÿæˆé™æ€å¡ç‰‡ä¿éšœæ ¸å¿ƒåŠŸèƒ½å¯ç”¨ï¼Œç¡®ä¿ç”¨æˆ·ä»èƒ½å®Œæˆçƒæ˜Ÿå¡ç”Ÿæˆçš„åŸºç¡€æµç¨‹ã€‚</li>
</ul>
<h2 data-id="heading-27">ä¹ã€å°ç»“</h2>
<p>æœ¬æ¬¡ã€Œç”¨ç¯®çƒè®¤è¯†æˆ‘ã€çƒæ˜Ÿå¡ç”ŸæˆåŠŸèƒ½å¼€å‘ï¼Œå›´ç»• â€œç”¨æˆ·è‡ªä¸»è°ƒæ•´ + è·¨ç«¯ä¸€è‡´æ¸²æŸ“â€ æ ¸å¿ƒç›®æ ‡ï¼Œé€šè¿‡ PAG æŠ€æœ¯ä¸ Canvas äº¤äº’çš„æ·±åº¦ç»“åˆï¼Œæ„å»ºäº†ä»å•å¡ç¼–è¾‘åˆ°æ‰¹é‡åˆæˆçš„å®Œæ•´æŠ€æœ¯é“¾è·¯ï¼Œå¯ä»é—®é¢˜è§£å†³ã€æŠ€æœ¯æ²‰æ·€ã€ä¸šåŠ¡ä»·å€¼ä¸‰æ–¹é¢æ€»ç»“æ ¸å¿ƒæˆæœï¼š</p>
<p><strong>é—®é¢˜è§£å†³ï¼šè§£å†³ä¸šåŠ¡ç—›ç‚¹ï¼Œä¼˜åŒ–ç”¨æˆ·ä½“éªŒ</strong></p>
<p>é’ˆå¯¹åˆæœŸ â€œæœåŠ¡ç«¯å›ºå®šåˆæˆå¯¼è‡´æ„å›¾åå·®â€ çš„æ ¸å¿ƒç—›ç‚¹ï¼Œé€šè¿‡ H5 ç«¯æ‰¿æ¥å…³é”®é“¾è·¯ï¼Œä¿éšœæ´»åŠ¨ç©æ³•å®Œæ•´æ€§ï¼š</p>
<ul>
<li>äº¤äº’è‡ªä¸»æ€§ï¼šåŸºäº Canvas å°è£…çš„CanvasImageEditorç»„ä»¶ï¼Œæ”¯æŒå•æŒ‡æ‹–æ‹½ã€åŒæŒ‡ç¼©æ”¾ / æ—‹è½¬ï¼Œè®©ç”¨æˆ·å¯ç²¾å‡†è°ƒæ•´äººåƒæ„å›¾ï¼Œè§£å†³ â€œå›ºå®šåˆæˆæ— æ³•é€‚é…ä¸ªæ€§åŒ–éœ€æ±‚â€ é—®é¢˜ï¼›</li>
<li>é¢„è§ˆå®æ—¶æ€§ï¼šè®¾è®¡ â€œäº¤äº’æ„ŸçŸ¥ - åŒæ­¥è°ƒåº¦ - æ¸²æŸ“æ‰§è¡Œâ€ ä¸‰å±‚æ¨¡å‹ï¼Œé€šè¿‡å¤ç”¨ Canvas å…ƒç´ ã€æ™ºèƒ½æ‰¹é‡è°ƒåº¦ç­‰æ–¹æ¡ˆï¼Œå®ç°æ“ä½œä¸ PAG é¢„è§ˆçš„å³æ—¶åŒæ­¥ï¼Œé¿å… â€œè°ƒæ•´åå»¶è¿Ÿåé¦ˆâ€ çš„å‰²è£‚æ„Ÿï¼›</li>
<li>åœºæ™¯å…¼å®¹æ€§ï¼šé’ˆå¯¹ PAG åŠ è½½å¤±è´¥ã€WebGL ä¸æ”¯æŒç­‰è¾¹ç•Œåœºæ™¯ï¼Œè®¾è®¡é™æ€å›¾å±‚å…œåº•ã€æœåŠ¡ç«¯åˆæˆé™çº§ã€æˆªå¸§å‰æ¸²æŸ“åŒæ­¥ç­‰æ–¹æ¡ˆï¼Œä¿éšœåŠŸèƒ½é«˜å¯ç”¨æ€§ã€‚</li>
</ul>
<p><strong>æŠ€æœ¯æ²‰æ·€</strong></p>
<p>æœ¬æ¬¡å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå›´ç»• PAG æŠ€æœ¯åœ¨ H5 ç«¯çš„åº”ç”¨ï¼Œæ²‰æ·€å‡ºä¸€å¥—æ ‡å‡†åŒ–çš„æŠ€æœ¯æ–¹æ¡ˆä¸ç»„ä»¶ä½“ç³»ï¼Œå¯å¤ç”¨äºåç»­å›¾ç‰‡ç¼–è¾‘ã€åŠ¨æ•ˆåˆæˆç±»éœ€æ±‚ï¼š</p>
<ul>
<li>ç»„ä»¶åŒ–å°è£…ï¼šæ‹†åˆ†å‡ºPagPlayerï¼ˆåŸºç¡€æ’­æ”¾ä¸å›¾å±‚æ›¿æ¢ï¼‰ã€CanvasImageEditorï¼ˆæ‰‹åŠ¿äº¤äº’ï¼‰ã€EditablePagPlayerï¼ˆäº¤äº’ä¸é¢„è§ˆåŒæ­¥ï¼‰ã€PAGBatchComposerï¼ˆæ‰¹é‡åˆæˆï¼‰å››å¤§æ ¸å¿ƒç»„ä»¶ï¼Œå„ç»„ä»¶èŒè´£å•ä¸€ã€æ¥å£æ¸…æ™°ï¼Œæ”¯æŒçµæ´»ç»„åˆï¼›</li>
<li>æ€§èƒ½ä¼˜åŒ–ï¼šé€šè¿‡ â€œé«˜æ¸…é€‚é…ï¼ˆDPR å¤„ç†ï¼‰ã€èµ„æºå¤ç”¨ï¼ˆCanvas ç›´æ¥ä¼ é€’ï¼‰ã€è°ƒåº¦ä¼˜åŒ–ï¼ˆRAF åˆå¹¶æ›´æ–°ï¼‰ã€å†…å­˜ç®¡ç†ï¼ˆå®ä¾‹åŠæ—¶é”€æ¯ï¼‰â€ ç­‰ä¼˜åŒ–æ–¹å‘ï¼Œä¸ºåç»­å¤æ‚åŠŸèƒ½çš„æ€§èƒ½è°ƒä¼˜æä¾›å‚è€ƒèŒƒä¾‹ï¼›</li>
<li>é—®é¢˜è§£å†³æ¡ˆä¾‹ï¼šè®°å½• PAG å­—ä½“æ³¨å†Œå¤±æ•ˆã€æˆªå¸§ç©ºå¸§ã€æ‰¹é‡åˆæˆå¡é¡¿ç­‰å…¸å‹é—®é¢˜çš„æ’æŸ¥æ€è·¯ä¸è§£å†³æ–¹æ¡ˆï¼Œå½¢æˆæŠ€æœ¯æ–‡æ¡£ï¼Œé™ä½åç»­å›¢é˜Ÿä½¿ç”¨ PAG çš„é—¨æ§›ã€‚</li>
</ul>
<p><strong>ä¸šåŠ¡ä»·å€¼ï¼šæ”¯æ’‘æ´»åŠ¨çˆ†å‘ï¼Œæ‹“å±•æŠ€æœ¯è¾¹ç•Œ</strong></p>
<p>ä»ä¸šåŠ¡è½åœ°æ•ˆæœæ¥çœ‹ï¼Œæœ¬æ¬¡æŠ€æœ¯æ–¹æ¡ˆä¸ä»…æ»¡è¶³äº†ã€Œç”¨ç¯®çƒè®¤è¯†æˆ‘ã€æ´»åŠ¨çš„æ ¸å¿ƒéœ€æ±‚ï¼Œæ›´ä¸ºç¤¾åŒºä¾§åç»­è§†è§‰åŒ–åŠŸèƒ½æä¾›äº†æŠ€æœ¯æ”¯æ’‘ï¼š</p>
<ul>
<li>æ´»åŠ¨ä¿éšœï¼šçƒæ˜Ÿå¡ç”ŸæˆåŠŸèƒ½ä¸Šçº¿åï¼Œæœªå‡ºç°å› æŠ€æœ¯é—®é¢˜å¯¼è‡´çš„åŠŸèƒ½ä¸å¯ç”¨ã€‚</li>
<li>æŠ€æœ¯èƒ½åŠ›æ‹“å±•ï¼šé¦–æ¬¡åœ¨ç¤¾åŒº H5 ç«¯è½åœ° PAG åŠ¨æ•ˆåˆæˆä¸æ‰‹åŠ¿äº¤äº’ç»“åˆçš„æ–¹æ¡ˆï¼Œå¡«è¡¥äº† â€œå‰ç«¯ PAG åº”ç”¨â€ çš„æŠ€æœ¯ç©ºç™½ï¼Œä¸ºåç»­ä¸€äº›å¤æ‚äº¤äº’å¥ å®šåŸºç¡€ã€‚</li>
</ul>
<p><strong>åç»­ä¼˜åŒ–æ–¹å‘</strong></p>
<p>å°½ç®¡å½“å‰æ–¹æ¡ˆå·²æ»¡è¶³ä¸šåŠ¡éœ€æ±‚ï¼Œä½†ä»æœ‰å¯è¿›ä¸€æ­¥ä¼˜åŒ–çš„ç©ºé—´ï¼š</p>
<ul>
<li>æ€§èƒ½å†æå‡ï¼šæ‰¹é‡åˆæˆåœºæ™¯ä¸‹ï¼Œå¯æ¢ç´¢ Web Worker åˆ†æ‹… PAG è§£æå‹åŠ›ï¼Œå‡å°‘ä¸»çº¿ç¨‹é˜»å¡ã€‚</li>
<li>åŠŸèƒ½æ‰©å±•ï¼šåœ¨CanvasImageEditorä¸­å¢åŠ å›¾ç‰‡è£å‰ªã€æ»¤é•œå åŠ ç­‰åŠŸèƒ½ï¼Œæ‹“å±•ç»„ä»¶çš„é€‚ç”¨åœºæ™¯ã€‚</li>
</ul>
<h3 data-id="heading-28">å¾€æœŸå›é¡¾</h3>
<ol>
<li>
<p>Ant Design 6.0 å°é²œï¼šä¸Šæ‰‹ç°ä»£åŒ–ç»„ä»¶å¼€å‘ï½œå¾—ç‰©æŠ€æœ¯</p>
</li>
<li>
<p>Java è®¾è®¡æ¨¡å¼ï¼šåŸç†ã€æ¡†æ¶åº”ç”¨ä¸å®æˆ˜å…¨è§£æï½œå¾—ç‰©æŠ€æœ¯</p>
</li>
<li>
<p>Goè¯­è¨€åœ¨é«˜å¹¶å‘é«˜å¯ç”¨ç³»ç»Ÿä¸­çš„å®è·µä¸è§£å†³æ–¹æ¡ˆï½œå¾—ç‰©æŠ€æœ¯</p>
</li>
<li>
<p>ä»0åˆ°1æ­å»ºä¸€ä¸ªæ™ºèƒ½åˆ†æOBSåŸ‹ç‚¹æ•°æ®çš„AI Agentï½œå¾—ç‰©æŠ€æœ¯</p>
</li>
<li>
<p>æ•°æ®åº“AIæ–¹å‘æ¢ç´¢-MCPåŸç†è§£æ&amp;DBæ–¹å‘å®æˆ˜ï½œå¾—ç‰©æŠ€æœ¯</p>
</li>
</ol>
<h3 data-id="heading-29">æ–‡ /æ— é™</h3>
<p>å…³æ³¨å¾—ç‰©æŠ€æœ¯ï¼Œæ¯å‘¨æ›´æ–°æŠ€æœ¯å¹²è´§</p>
<p>è¦æ˜¯è§‰å¾—æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œæ¬¢è¿è¯„è®ºè½¬å‘ç‚¹èµï½</p>
<p>æœªç»å¾—ç‰©æŠ€æœ¯è®¸å¯ä¸¥ç¦è½¬è½½ï¼Œå¦åˆ™ä¾æ³•è¿½ç©¶æ³•å¾‹è´£ä»»ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>