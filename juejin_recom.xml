<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[JavaScript å¼€å‘è€…å¿…çŸ¥çš„5ä¸ªé«˜æ•ˆè°ƒè¯•æŠ€å·§ï¼šå‘Šåˆ«console.logæ—¶ä»£ï¼]]></title>    <link>https://juejin.cn/post/7599927813601919016</link>    <guid>https://juejin.cn/post/7599927813601919016</guid>    <pubDate>2026-01-28T04:17:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599927813601919016" data-draft-id="7599966546559762432" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScript å¼€å‘è€…å¿…çŸ¥çš„5ä¸ªé«˜æ•ˆè°ƒè¯•æŠ€å·§ï¼šå‘Šåˆ«console.logæ—¶ä»£ï¼"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-28T04:17:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ©™çš„ç™¾å®ç®±"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScript å¼€å‘è€…å¿…çŸ¥çš„5ä¸ªé«˜æ•ˆè°ƒè¯•æŠ€å·§ï¼šå‘Šåˆ«console.logæ—¶ä»£ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ©™çš„ç™¾å®ç®±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T04:17:08.000Z" title="Wed Jan 28 2026 04:17:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>JavaScript å¼€å‘è€…å¿…çŸ¥çš„5ä¸ªé«˜æ•ˆè°ƒè¯•æŠ€å·§ï¼šå‘Šåˆ«console.logæ—¶ä»£ï¼</strong></h2>
<h2 data-id="heading-1">å¼•è¨€</h2>
<p>åœ¨JavaScriptå¼€å‘çš„ä¸–ç•Œä¸­ï¼Œè°ƒè¯•æ˜¯æ¯ä¸ªå¼€å‘è€…éƒ½æ— æ³•å›é¿çš„é‡è¦ç¯èŠ‚ã€‚é•¿æœŸä»¥æ¥ï¼Œ<code>console.log()</code> è¢«è§†ä¸ºè°ƒè¯•çš„"ç‘å£«å†›åˆ€"ï¼Œä½†è¿‡åº¦ä¾èµ–å®ƒå¾€å¾€ä¼šæ©ç›–æ›´é«˜æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚éšç€ç°ä»£æµè§ˆå™¨å¼€å‘å·¥å…·çš„ä¸æ–­è¿›åŒ–ä»¥åŠNode.jsç”Ÿæ€çš„æˆç†Ÿï¼ŒJavaScriptè°ƒè¯•å·²ç»è¿›å…¥äº†ä¸€ä¸ªå…¨æ–°çš„æ—¶ä»£ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨5ä¸ªä¸“ä¸šå¼€å‘è€…å¿…å¤‡çš„é«˜æ•ˆè°ƒè¯•æŠ€å·§ï¼Œå¸®åŠ©æ‚¨æå‡ç”Ÿäº§åŠ›ã€ç¼©çŸ­é—®é¢˜å®šä½æ—¶é—´ï¼Œå¹¶æœ€ç»ˆå‘Šåˆ«ä½æ•ˆçš„<code>console.log</code>æ—¶ä»£ã€‚</p>
<h2 data-id="heading-2">1. æ–­ç‚¹è°ƒè¯•çš„è‰ºæœ¯ï¼šæŒæ¡Chrome DevToolsçš„é«˜çº§ç”¨æ³•</h2>
<h3 data-id="heading-3">1.1 æ¡ä»¶æ–­ç‚¹ï¼ˆConditional Breakpointsï¼‰</h3>
<p>ä¼ ç»Ÿæ–­ç‚¹ä¼šåœ¨æ¯æ¬¡æ‰§è¡Œåˆ°è¯¥è¡Œä»£ç æ—¶æš‚åœï¼Œè¿™åœ¨å¾ªç¯æˆ–é«˜é¢‘è°ƒç”¨çš„å‡½æ•°ä¸­æä¸é«˜æ•ˆã€‚Chrome DevToolså…è®¸è®¾ç½®å¸¦æœ‰è¡¨è¾¾å¼çš„æ¡ä»¶æ–­ç‚¹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä»…åœ¨iå¤§äº10æ—¶è§¦å‘æ–­ç‚¹</span>
<span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {
    <span class="hljs-comment">// å³é”®ç‚¹å‡»è¡Œå· â†’ Add conditional breakpoint</span>
    <span class="hljs-comment">// è¾“å…¥æ¡ä»¶: i &gt; 10</span>
}
</code></pre>
<h3 data-id="heading-4">1.2 XHR/Fetchæ–­ç‚¹</h3>
<p>é’ˆå¯¹ç°ä»£å‰ç«¯åº”ç”¨é¢‘ç¹çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯ä»¥è®¾ç½®ç‰¹å®šURLåŒ…å«æ¨¡å¼çš„è¯·æ±‚æ–­ç‚¹ï¼š</p>
<ol>
<li>æ‰“å¼€DevTools â†’ Sourcesé¢æ¿</li>
<li>åœ¨XHR BreakpointsåŒºåŸŸæ·»åŠ URLåŒ¹é…è§„åˆ™</li>
</ol>
<h3 data-id="heading-5">1.3 DOMå˜æ›´æ–­ç‚¹</h3>
<p>è¿½è¸ªéš¾ä»¥æ‰æ‘¸çš„DOMä¿®æ”¹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å³é”®å…ƒç´  â†’ Break on â†’ Subtree modifications/Attribute modifications/Node removal</span>
</code></pre>
<h3 data-id="heading-6">Pro Tipï¼š</h3>
<p>ä½¿ç”¨<code>debug(function)</code>APIå¯ä»¥åœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶è‡ªåŠ¨æš‚åœæ‰§è¡Œï¼Œæ— éœ€æ‰‹åŠ¨æŸ¥æ‰¾æºä»£ç ä½ç½®ã€‚</p>
<h2 data-id="heading-7">2. Node.jsè°ƒè¯•çš„é©å‘½ï¼šV8 Inspectoré›†æˆ</h2>
<h3 data-id="heading-8">2.1 Chrome DevToolsè¿æ¥Nodeè¿›ç¨‹</h3>
<p>å¯åŠ¨Nodeåº”ç”¨æ—¶æ·»åŠ <code>--inspect</code>æ ‡å¿—ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">node --inspect server.js
</code></pre>
<p>ç„¶ååœ¨Chromeåœ°å€æ è®¿é—®<code>chrome://inspect</code></p>
<h3 data-id="heading-9">2.2 VS Codeå†…ç½®è°ƒè¯•å™¨é…ç½®ç¤ºä¾‹ï¼š</h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"request"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"launch"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Launch Program"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"skipFiles"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"&lt;node_internals&gt;/**"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"program"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"${workspaceFolder}/app.js"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-10">Advanced Usageï¼š</h3>
<ul>
<li><code>--inspect-brk</code>åœ¨é¦–è¡Œä»£ç å¤„ä¸­æ–­</li>
<li>NODE_OPTIONSç¯å¢ƒå˜é‡å…¨å±€å¯ç”¨inspect</li>
</ul>
<h2 data-id="heading-11">3. consoleçš„é«˜çº§æŠ€æ³•ï¼šè¶…è¶Šç®€å•çš„æ—¥å¿—è¾“å‡º</h2>
<h3 data-id="heading-12">3.1 Structured Dataå±•ç¤ºï¼š</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">table</span>([
    {<span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>},
    {<span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Bob'</span>}
]);
</code></pre>
<h3 data-id="heading-13">3.2 Performance Tracingï¼š</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'databaseQuery'</span>);
<span class="hljs-keyword">await</span> <span class="hljs-title function_">queryDatabase</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'databaseQuery'</span>); <span class="hljs-comment">// databaseQuery: 325ms</span>
</code></pre>
<h3 data-id="heading-14">Deep Diveï¼š</h3>
<ul>
<li><code>console.dir()</code>æ˜¾ç¤ºDOMå…ƒç´ çš„å¯äº¤äº’å±æ€§åˆ—è¡¨</li>
<li><code>console.assert(condition, message)</code>å®ç°æ¡ä»¶æ—¥å¿—è®°å½•</li>
</ul>
<p>##4. Error Stack Traceè§£æä¸Source Mapå®æˆ˜</p>
<p>###4.1 Error.captureStackTraceå®šåˆ¶é”™è¯¯è¿½è¸ªï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">MyError</span>(<span class="hljs-params"/>) { 
 <span class="hljs-title class_">Error</span>.<span class="hljs-title function_">captureStackTrace</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-title class_">MyError</span>); 
} 
<span class="hljs-comment">// Creates cleaner stack traces by omitting this function frame </span>
</code></pre>
<p>###4.2 Source Mapæ·±åº¦é›†æˆï¼š
Webpacké…ç½®ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-attr">devtool</span>: <span class="hljs-string">'source-map'</span>, <span class="hljs-comment">// productionæ¨èç”¨hidden-source-map </span>
<span class="hljs-attr">productionSourceMap</span>: <span class="hljs-literal">true</span> 

é…åˆ<span class="hljs-variable constant_">HTTP</span>å¤´å®ç°å®‰å…¨éƒ¨ç½²ï¼š 
<span class="hljs-title class_">SourceMap</span>: <span class="hljs-regexp">/path/</span>to/file.<span class="hljs-property">map</span> 
X-<span class="hljs-title class_">SourceMap</span>-<span class="hljs-title class_">Version</span>: v3 

</code></pre>
<p>##5.Live Editingä¸Hot Code SwapæŠ€æœ¯</p>
<p>5.Chrome Workspacesç›´æ¥ç¼–è¾‘ç£ç›˜æ–‡ä»¶ ï¼š</p>
<p>â‘ å°†æœ¬åœ°æ–‡ä»¶å¤¹æ˜ å°„åˆ°DevTools Workspace</p>
<p>â‘¡å¯ç”¨File Systemæˆæƒ</p>
<p>â‘¢ä¿®æ”¹åCtrl+Sç›´æ¥ä¿å­˜åˆ°æºæ–‡ä»¶</p>
<p>5.React/Vueç»„ä»¶çƒ­æ›´æ–°åŸç† ï¼š</p>
<p>webpack-dev-serveré€šè¿‡WebSocketæ¨é€å˜æ›´<br/>
HMR Runtimeæ¥æ”¶æ›´æ–°å¹¶æ›¿æ¢æ¨¡å—<br/>
æ¡†æ¶ç‰¹å®šçš„reconcilerå¤„ç†çŠ¶æ€ä¿æŒ</p>
<p>Proçº§é…ç½®ï¼ˆwebpack.config.jsï¼‰ï¼š</p>
<p>devServer.hotOnly = true //å³ä½¿HMRå¤±è´¥ä¹Ÿä¸åˆ·æ–°é¡µé¢<br/>
module.hot.accept('./module', callback) //è‡ªå®šä¹‰çƒ­æ›´æ–°é€»è¾‘</p>
<hr/>
<p>##æ€»ç»“</p>
<p>ä»ä¼ ç»Ÿçš„æ—¥å¿—è¾“å‡ºåˆ°ç°ä»£çš„å®æ—¶è¯Šæ–­å·¥å…·é“¾ ï¼ŒJavaScriptè°ƒè¯•æŠ€æœ¯å·²ç»å‘ç”Ÿäº†è´¨çš„é£è·ƒ ã€‚æœ¬æ–‡ä»‹ç»çš„äº”ä¸ªç»´åº¦æ„æˆäº†å½“ä»£ä¸“ä¸šå¼€å‘è€…çš„æ ¸å¿ƒè°ƒè¯•èƒ½åŠ›æ¨¡å‹ ï¼š</p>
<p>â€¢ç²¾å‡†æ§åˆ¶çš„æ‰§è¡Œæµç®¡ç†ï¼ˆé«˜çº§æ–­ç‚¹ç³»ç»Ÿ ï¼‰<br/>
â€¢å…¨æ ˆç»Ÿä¸€çš„è¯Šæ–­ç•Œé¢ ï¼ˆNode+V8 inspectoræ•´åˆ ï¼‰<br/>
â€¢ç»“æ„åŒ–çš„é—®é¢˜æè¿°èƒ½åŠ› ï¼ˆå¢å¼ºå‹Console APIï¼‰<br/>
â€¢ç”Ÿäº§ç¯å¢ƒè¯Šæ–­æ”¯æŒ ï¼ˆSourceMapä¸é”™è¯¯è·Ÿè¸ª ï¼‰<br/>
â€¢å³æ—¶åé¦ˆçš„å¼€å‘å¾ªç¯ ï¼ˆLive Edit+HMRï¼‰</p>
<p>æŒæ¡è¿™äº›æŠ€æœ¯ä¸ä»…èƒ½å°†å¹³å‡é—®é¢˜è§£å†³æ—¶é—´ç¼©çŸ­60%ä»¥ä¸Š ï¼Œæ›´èƒ½ä»æ ¹æœ¬ä¸Šæ”¹å˜ä½ ä¸ä»£ç äº¤äº’çš„æ–¹å¼ ã€‚å½“ä½ å¯ä»¥ç›´æ¥åœ¨è¿è¡Œæ—¶ä¿®æ”¹çŠ¶æ€ ã€å›æº¯æ‰§è¡Œå†å²ç”šè‡³é¢„æµ‹æ½œåœ¨å¼‚å¸¸æ—¶ ï¼Œç¼–ç¨‹å°±å˜æˆäº†ä¸€ç§çœŸæ­£çš„å¯¹è¯è¿‡ç¨‹ ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Bun v1.3.7æ›´æ–°çŸ­è¯„]]></title>    <link>https://juejin.cn/post/7599927813602000936</link>    <guid>https://juejin.cn/post/7599927813602000936</guid>    <pubDate>2026-01-28T04:52:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599927813602000936" data-draft-id="7599927813601984552" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Bun v1.3.7æ›´æ–°çŸ­è¯„"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-28T04:52:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯ä¹‹è™é™ˆéšæ˜“"/> <meta itemprop="url" content="https://juejin.cn/user/1239904846873326"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Bun v1.3.7æ›´æ–°çŸ­è¯„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1239904846873326/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯ä¹‹è™é™ˆéšæ˜“
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T04:52:23.000Z" title="Wed Jan 28 2026 04:52:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å†œæ‘ç¨‹åºå‘˜ï¼Œç‹¬ç«‹å¼€å‘è€…ï¼Œå‰ç«¯ä¹‹è™é™ˆéšæ˜“ï¼ŒæŠ€æœ¯ç¾¤ä¸äº¤æœ‹å‹è¯·åœ¨ä¸ªäººç½‘ç«™ ğŸ‘‡ è”ç³»æˆ‘ âœŒï¸</p>
<ul>
<li>ä¸ªäººç½‘ç«™ 1ï¸âƒ£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fchensuiyi.me" target="_blank" title="https://chensuiyi.me" ref="nofollow noopener noreferrer">chensuiyi.me</a></li>
<li>ä¸ªäººç½‘ç«™ 2ï¸âƒ£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fme.yicode.tech" target="_blank" title="https://me.yicode.tech" ref="nofollow noopener noreferrer">me.yicode.tech</a></li>
</ul>
<p>æˆ‘çš„æ‰€æœ‰æ–‡ç« å‡ä¸ºå¤æ³•æ‰‹å†™ï¼Œæ—  AI æ·»åŠ å‰‚ï¼Œè¯·æ”¾å¿ƒé£Ÿç”¨ï¼Œå¦‚æœä½ è§‰å¾—æœ¬æ–‡æœ‰ç”¨ï¼Œä¸€é”®ä¸‰è¿ (<code>ç‚¹èµ</code>ã€<code>è¯„è®º</code>ã€<code>è½¬å‘</code>)ï¼Œå°±æ˜¯å¯¹æˆ‘æœ€å¤§çš„æ”¯æŒ~</p>
<hr/>
<p>è·ç¦»v1.3.6å‘å¸ƒåº”è¯¥ä¸åˆ°åŠä¸ªæœˆå§ï¼Œv1.3.7å·²ç»å‘å¸ƒäº†ï¼ŒBunçš„å‘ç‰ˆèŠ‚å¥çœŸæ˜¯æ¯”ç«ç®­è¿˜å¿«ã€‚</p>
<p>å‘ç‰ˆå¿«å°±ç®—äº†ï¼Œæ›´ç‰›çš„æ˜¯ï¼Œæ¯æ¬¡éƒ½èƒ½å¸¦æ¥ä¸€äº›äº®çœ¼çš„åŠŸèƒ½ï¼Œæœ¬æ–‡å°±æ¥ç®€å•ç›˜ç‚¹ä¸€ä¸‹ã€‚</p>
<h2 data-id="heading-0">å¿«ï¼Œå¿«ï¼Œå¿«</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/72ac7599408347e39c54474e5c07eb06~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5LmL6JmO6ZmI6ZqP5piT:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770180743&amp;x-signature=42Y00%2BNu4JMhZcqeIfxn0RTJZwc%3D" alt="" loading="lazy"/></p>
<p>æ€§èƒ½æ˜¯Bunçš„ä¸»æ‰“æ–¹å‘ï¼Œè¿™æ¬¡ä¹Ÿä¸ä¾‹å¤–ï¼Œå¸¦æ¥äº†å¤§é‡çš„æ€§èƒ½æå‡ã€‚</p>
<ul>
<li><code>Buffer.from</code> å¿«äº†<code>50%</code></li>
<li><code>JavaScriptCore</code> å‡çº§åˆ°æœ€æ–°ç‰ˆ</li>
<li><code>async/await</code> å¿«äº† <code>35%</code></li>
<li><code>Array.from</code> å¿«äº† <code>2å€</code></li>
<li><code>string.padStart</code> å’Œ <code>string.padEnd</code>å¿«äº†<code>90%</code></li>
<li><code>array.flat</code>å¿«äº†<code>3å€</code></li>
<li><code>ARM64</code> ä¸Šé¢æ€§èƒ½æå‡</li>
</ul>
<h2 data-id="heading-1">fetch å‘é€ HTTP è¯·æ±‚æ—¶ä¿ç•™å¤´éƒ¨å¤§å°å†™</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://api.example.com/data'</span>, {
    <span class="hljs-attr">headers</span>: {
        <span class="hljs-title class_">Authorization</span>: <span class="hljs-string">'Bearer token123'</span>, <span class="hljs-comment">// å‘é€ "Authorization"</span>
        <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>, <span class="hljs-comment">// å‘é€ "Content-Type"</span>
        <span class="hljs-string">'X-Custom-Header'</span>: <span class="hljs-string">'value'</span> <span class="hljs-comment">// å‘é€ "X-Custom-Header"</span>
    }
});

<span class="hljs-keyword">const</span> headers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Headers</span>();
headers.<span class="hljs-title function_">set</span>(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'text/plain'</span>); <span class="hljs-comment">// å‘é€ "Content-Type"</span>
</code></pre>
<p>è¿™ä¸ªæˆ‘æŒºå–œæ¬¢çš„ï¼Œç¼–ç¨‹å°±åº”è¯¥è¦å…·å¤‡ç¡®å®šæ€§ï¼Œè™½ç„¶httpåè®®ä¸åŒºåˆ†å¤´éƒ¨å±æ€§çš„å¤§å°å†™ï¼Œä½†ä½ æ˜æ˜ä¼ äº†<code>Authorization</code>ï¼ŒæœåŠ¡ç«¯æ¥å—å´å˜æˆäº†<code>authorization</code>ï¼Œè¿˜æ˜¯æ€ªåˆ«æ‰­çš„ã€‚</p>
<h2 data-id="heading-2">æ–°å¢ Bun.wrapAnsi()</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/01d2aab533754581b680c2138675d98b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5LmL6JmO6ZmI6ZqP5piT:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770180743&amp;x-signature=q0%2BhTV9GACDjmK33gFPs0ca0OW4%3D" alt="" loading="lazy"/></p>
<p>Bunå·²ç»å†…ç½®äº†npmåŒ…wrap-ansiçš„å®ç°ï¼Œè¿™æ˜¯åœ¨ç»ˆç«¯æ˜¾ç¤ºè½¬ä¹‰å­—ç¬¦ï¼Œå½©è‰²è¾“å‡ºçš„æ–¹æ³•ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/49b066683ed9462ab9fec22f8eea75dd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5LmL6JmO6ZmI6ZqP5piT:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770180743&amp;x-signature=1oudFCDvMAYhrp2ejFHiUYsmTbE%3D" alt="" loading="lazy"/></p>
<p>æˆ‘ä¹‹å‰å†™è¿‡çš„ä¸€ç¯‡æ–‡ç« <a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FUjsuNUOnrIoDwiXsnlaYZw" target="_blank" title="https://mp.weixin.qq.com/s/UjsuNUOnrIoDwiXsnlaYZw" ref="nofollow noopener noreferrer">ç›˜ç‚¹Bunå†…ç½®äº†å“ªäº›npmåŒ…åŠŸèƒ½</a>ç°åœ¨åˆèƒ½æ–°å¢ä¸€ä¸ªå†…ç½®å¯æ›¿æ¢çš„npmåŒ…äº†ã€‚</p>
<p>æˆ‘ç‰¹åˆ«å–œæ¬¢è¿™ç§<code>å…¨åŒ…å¹²</code>ï¼Œä¸ºå•¥å‘¢ï¼Ÿå› ä¸ºå¾ˆå¤šä¸œè¥¿æœ¬å°±ç®€å•ï¼Œå‡ ä¹ä¸‡å¹´ä¸å˜çš„ï¼Œå†…ç½®åˆ°è¿è¡Œæ—¶é‡Œé¢ï¼Œæ–¹ä¾¿åˆå¿«æ·ã€‚</p>
<p>åŒæ—¶å‘¢ï¼Œå†…ç½®å®ç°ä¸€èˆ¬æ€§èƒ½æ›´é«˜ï¼Œæ¯”å¦‚<code>Bun.wrapAnsi</code>å°±æ¯”<code>wrap-ansi</code>å¿«äº†<code>33å€-88å€</code>ï¼Œä¹Ÿå‡å°‘äº†å¾ˆå¤šæ‰¾åº“ï¼Œæ‰¾åŒ…çš„æ—¶é—´ï¼Œéå¸¸Niceã€‚</p>
<h2 data-id="heading-3">Markdown CPU Profile è¾“å‡º</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/584ceb4aea2e493789326199f78da611~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5LmL6JmO6ZmI6ZqP5piT:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770180743&amp;x-signature=OlYtEUw2BXjBXml36bZI8aZACMo%3D" alt="" loading="lazy"/></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä»…ç”Ÿæˆ Markdown é…ç½®æ–‡ä»¶</span>
bun --cpu-prof-md script.js

<span class="hljs-comment"># ç”Ÿæˆ Chrome DevTools JSON å’Œ Markdown æ ¼å¼</span>
bun --cpu-prof --cpu-prof-md script.js

<span class="hljs-comment"># ç”Ÿæˆä¸ V8 å…¼å®¹çš„å †å¿«ç…§ï¼ˆåœ¨ Chrome å¼€å‘è€…å·¥å…·ä¸­æ‰“å¼€ï¼‰</span>
bun --heap-prof script.js

<span class="hljs-comment"># ç”Ÿæˆ Markdown å †é…ç½®æ–‡ä»¶ï¼ˆç”¨äºä½¿ç”¨ grep/sed/awk è¿›è¡Œ CLI åˆ†æï¼‰</span>
bun --heap-prof-md script.js

<span class="hljs-comment"># æŒ‡å®šè¾“å‡ºä½ç½®</span>
bun --heap-prof --heap-prof-dir ./profiles --heap-prof-name my-snapshot.heapsnapshot script.js

</code></pre>
<p>é‡ç£…åŠŸèƒ½ï¼Œè€é“ä»¬ï¼ŒAIå‹å¥½çš„æ€§èƒ½åˆ†æï¼Œè°ƒä¼˜ï¼Œç›´æ¥å¾—åˆ°ä¸€ä¸ªæ€§èƒ½æ–¹é¢çš„mdæ–‡æ¡£ï¼Œæ‰”ç»™AIï¼Œé¡¹ç›®æ€§èƒ½é—®é¢˜ï¼Œå†…å­˜æ³„æ¼ï¼Œä¸€æ¸…äºŒæ¥šï¼Œä¼°è®¡è¿™ä¸ªåŠŸèƒ½å…¶ä»–å‡ ä¸ªè¿è¡Œæ—¶ï¼ŒåŒ…æ‹¬å…¶ä»–è¯­è¨€ä¹Ÿä¼šå¾ˆå¿«è·Ÿä¸Šã€‚</p>
<h2 data-id="heading-4">åŸç”Ÿ JSON5 æ”¯æŒ</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// è§£æJSON5å­—ç¬¦</span>
<span class="hljs-keyword">const</span> config = <span class="hljs-title class_">Bun</span>.<span class="hljs-property">JSON5</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-string">`{
  // Database configuration
  host: 'localhost',
  port: 5432,
  ssl: true,
}`</span>);

<span class="hljs-comment">// JSON5å­—ç¬¦ä¸²åŒ–</span>
<span class="hljs-keyword">const</span> output = <span class="hljs-title class_">Bun</span>.<span class="hljs-property">JSON5</span>.<span class="hljs-title function_">stringify</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'app'</span>, <span class="hljs-attr">version</span>: <span class="hljs-number">1</span> });

<span class="hljs-comment">// ç›´æ¥å¯¼å…¥JSON5æ–‡ä»¶</span>
<span class="hljs-keyword">import</span> settings <span class="hljs-keyword">from</span> <span class="hljs-string">'./config.json5'</span>;
</code></pre>
<p>JSON5 æ˜¯ JSON çš„è¶…é›†ï¼Œå¢åŠ äº†å¼€å‘è€…å‹å¥½çš„ç‰¹æ€§ï¼Œå¦‚æ³¨é‡Šã€å°¾éšé€—å·ã€æœªåŠ å¼•å·çš„é”®ã€å•å¼•å·å­—ç¬¦ä¸²å’Œåå…­è¿›åˆ¶æ•°å­—ã€‚</p>
<p>å®ƒè¢« Chromiumã€Next.jsã€Babel å’Œ WebStorm ç­‰ä¸»è¦é¡¹ç›®ä½¿ç”¨ã€‚</p>
<p>JSON5 ç‰¹åˆ«é€‚ç”¨äºé…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­æ³¨é‡Šå’Œå°¾éšé€—å·å¯ä»¥æé«˜å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p>
<h2 data-id="heading-5">Bun.JSONL ç”¨äºæµå¼è§£æ JSONL</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> results = <span class="hljs-title class_">Bun</span>.<span class="hljs-property">JSONL</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-string">'{"name":"Alice"}\n{"name":"Bob"}\n'</span>);
<span class="hljs-comment">// [{ name: "Alice" }, { name: "Bob" }]</span>

<span class="hljs-comment">// Uint8Array ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œ (UTF-8 BOM è‡ªåŠ¨å¿½ç•¥)</span>
<span class="hljs-keyword">const</span> buffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextEncoder</span>().<span class="hljs-title function_">encode</span>(<span class="hljs-string">'{"a":1}\n{"b":2}\n'</span>);
<span class="hljs-keyword">const</span> records = <span class="hljs-title class_">Bun</span>.<span class="hljs-property">JSONL</span>.<span class="hljs-title function_">parse</span>(buffer);
<span class="hljs-comment">// [{ a: 1 }, { b: 2 }]</span>
</code></pre>
<p>Bun ç°åœ¨å†…ç½®æ”¯æŒè§£æ JSONLï¼ˆæ¢è¡Œç¬¦åˆ†éš”çš„ JSONï¼‰ã€‚</p>
<p>è¯¥è§£æå™¨ä½¿ç”¨ JavaScriptCore çš„ä¼˜åŒ– JSON è§£æå™¨ä»¥ C++å®ç°ï¼Œä¸ºå®Œæ•´è¾“å…¥å’Œæµå¼ä½¿ç”¨åœºæ™¯æä¾›å¿«é€Ÿè§£æã€‚</p>
<p>æˆ‘èƒ½æƒ³åˆ°çš„ä¸€ä¸ªåœºæ™¯å°±æ˜¯ï¼Œjsonæ ¼å¼çš„æ—¥å¿—åˆ†æï¼Œåº”è¯¥ä¼šå¾ˆæ–¹ä¾¿ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> chunk = <span class="hljs-string">'{"id":1}\n{"id":2}\n{"id":3'</span>;

<span class="hljs-keyword">const</span> result = <span class="hljs-title class_">Bun</span>.<span class="hljs-property">JSONL</span>.<span class="hljs-title function_">parseChunk</span>(chunk);
result.<span class="hljs-property">values</span>; <span class="hljs-comment">// [{ id: 1 }, { id: 2 }]</span>
result.<span class="hljs-property">read</span>; <span class="hljs-comment">// 17 â€” characters consumed</span>
result.<span class="hljs-property">done</span>; <span class="hljs-comment">// false â€” incomplete value remains</span>
result.<span class="hljs-property">error</span>; <span class="hljs-comment">// null â€” no parse error</span>
</code></pre>
<p>åœ¨æµå¼åœºæ™¯ä¸­ï¼Œ parseChunk å°½å¯èƒ½è§£æå¤šä¸ªå®Œæ•´å€¼ï¼Œå¹¶è¿”å›è§£æçš„è¿›åº¦â€”â€”å½“ä»ç½‘ç»œæµé€æ­¥æ¥æ”¶æ•°æ®æ—¶å¾ˆæœ‰ç”¨ã€‚</p>
<h2 data-id="heading-6">S3 presign() ç°åœ¨æ”¯æŒ contentDisposition å’Œ type é€‰é¡¹</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { S3Client } <span class="hljs-keyword">from</span> <span class="hljs-string">'bun'</span>;

<span class="hljs-keyword">const</span> s3 = <span class="hljs-keyword">new</span> <span class="hljs-title function_">S3Client</span>({
    <span class="hljs-attr">region</span>: <span class="hljs-string">'us-east-1'</span>,
    <span class="hljs-attr">endpoint</span>: <span class="hljs-string">'https://s3.us-east-1.amazonaws.com'</span>,
    <span class="hljs-attr">accessKeyId</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">AWS_ACCESS_KEY_ID</span>,
    <span class="hljs-attr">secretAccessKey</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">AWS_SECRET_ACCESS_KEY</span>,
    <span class="hljs-attr">bucket</span>: <span class="hljs-string">'my-bucket'</span>
});

<span class="hljs-keyword">const</span> file = s3.<span class="hljs-title function_">file</span>(<span class="hljs-string">'report.pdf'</span>);

<span class="hljs-keyword">const</span> url = file.<span class="hljs-title function_">presign</span>({
    <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span>,
    <span class="hljs-attr">expiresIn</span>: <span class="hljs-number">900</span>,
    <span class="hljs-attr">contentDisposition</span>: <span class="hljs-string">'attachment; filename="quarterly-report.pdf"'</span>,
    <span class="hljs-attr">type</span>: <span class="hljs-string">'application/octet-stream'</span>
});
</code></pre>
<p>ä¿®å¤äº†ä¸€ä¸ªé—®é¢˜ï¼Œå³åœ¨ç”Ÿæˆé¢„ç­¾å URL æ—¶ S3File.presign() ä¼šå¿½ç•¥ contentDisposition å’Œ type é€‰é¡¹ã€‚</p>
<p>è¿™äº›é€‰é¡¹ç°åœ¨è¢«æ­£ç¡®åœ°åŒ…å«ä¸º response-content-disposition å’Œ response-content-type æŸ¥è¯¢å‚æ•°ã€‚</p>
<p>è¿™åœ¨ä½ å¸Œæœ›æµè§ˆå™¨å°†æ–‡ä»¶ä½œä¸ºé™„ä»¶ä¸‹è½½è€Œä¸æ˜¯å†…è”æ˜¾ç¤ºæ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚</p>
<h2 data-id="heading-7">bun pm pack ç°åœ¨ä¼šå°Šé‡æ¥è‡ªç”Ÿå‘½å‘¨æœŸè„šæœ¬å¯¹ package.json çš„æ›´æ”¹</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// package.json</span>
{
  <span class="hljs-string">"name"</span>: <span class="hljs-string">"my-package"</span>,
  <span class="hljs-string">"version"</span>: <span class="hljs-string">"1.0.0"</span>,
  <span class="hljs-string">"scripts"</span>: {
    <span class="hljs-string">"prepack"</span>: <span class="hljs-string">"node prepack.js"</span>
  },
  <span class="hljs-string">"description"</span>: <span class="hljs-string">"Original description"</span>,
  <span class="hljs-string">"devDependencies"</span>: { <span class="hljs-comment">/* ... */</span> }
}

<span class="hljs-comment">// prepack.js - æ‰“åŒ…ä¹‹å‰æ”¹å˜package.json</span>
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);
<span class="hljs-keyword">const</span> pkg = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">'package.json'</span>, <span class="hljs-string">'utf8'</span>));
<span class="hljs-keyword">delete</span> pkg.<span class="hljs-property">devDependencies</span>;
pkg.<span class="hljs-property">description</span> = <span class="hljs-string">'Production build'</span>;
fs.<span class="hljs-title function_">writeFileSync</span>(<span class="hljs-string">'package.json'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(pkg, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>));

</code></pre>
<p>bun pm pack åœ¨è¿è¡Œ prepack ã€ prepare å’Œ prepublishOnly è„šæœ¬åé‡æ–°è¯»å– package.json ï¼Œç¡®ä¿è¿™äº›è„šæœ¬æ‰€åšçš„ä»»ä½•ä¿®æ”¹éƒ½åŒ…å«åœ¨ tarball ä¸­ã€‚</p>
<h2 data-id="heading-8">node:inspector åˆ†æå™¨ API</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> inspector <span class="hljs-keyword">from</span> <span class="hljs-string">'node:inspector/promises'</span>;

<span class="hljs-keyword">const</span> session = <span class="hljs-keyword">new</span> inspector.<span class="hljs-title class_">Session</span>();
session.<span class="hljs-title function_">connect</span>();

<span class="hljs-keyword">await</span> session.<span class="hljs-title function_">post</span>(<span class="hljs-string">'Profiler.enable'</span>);
<span class="hljs-keyword">await</span> session.<span class="hljs-title function_">post</span>(<span class="hljs-string">'Profiler.start'</span>);

<span class="hljs-keyword">const</span> { profile } = <span class="hljs-keyword">await</span> session.<span class="hljs-title function_">post</span>(<span class="hljs-string">'Profiler.stop'</span>);
<span class="hljs-keyword">await</span> session.<span class="hljs-title function_">post</span>(<span class="hljs-string">'Profiler.disable'</span>);
</code></pre>
<p>Bun ç°åœ¨é€šè¿‡ Chrome DevTools Protocol å®ç°äº† node:inspector Profiler APIï¼Œç”¨äº CPU åˆ†æã€‚</p>
<h2 data-id="heading-9">å¢åŠ æœ€å¤§ HTTP å¤´æ•°é‡</h2>
<p>è¯·æ±‚å’Œå“åº”ä¸­å…è®¸çš„æœ€å¤§ HTTP å¤´æ•°é‡å·²ä» 100 å¢åŠ åˆ° 200ã€‚</p>
<p>è¿™æé«˜äº†ä¸å‘é€å¤§é‡å¤´çš„æœåŠ¡çš„å…¼å®¹æ€§ï¼Œä¾‹å¦‚å…·æœ‰å¹¿æ³›å…ƒæ•°æ®çš„ API æˆ–é™„åŠ å¤šä¸ªè½¬å‘å¤´çš„ä»£ç†ã€‚</p>
<h2 data-id="heading-10">WebSocket URL å‡­è¯æ”¯æŒ</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å‡­è¯ä¼šè‡ªåŠ¨è½¬å‘</span>
<span class="hljs-keyword">const</span> ws = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(<span class="hljs-string">'ws://username:password@example.com/socket'</span>);

<span class="hljs-comment">// ç”¨æˆ·æä¾›çš„æˆæƒæ ‡å¤´å…·æœ‰ä¼˜å…ˆæƒ</span>
<span class="hljs-keyword">const</span> ws2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(<span class="hljs-string">'ws://user:pass@example.com/socket'</span>, {
    <span class="hljs-attr">headers</span>: {
        <span class="hljs-title class_">Authorization</span>: <span class="hljs-string">'Bearer custom-token'</span> <span class="hljs-comment">// è¿™å°†æ›¿æ¢é»˜è®¤è½¬å‘çš„ Authorization</span>
    }
});
</code></pre>
<p>WebSocket è¿æ¥ç°åœ¨æ­£ç¡®åœ°å°† URL ä¸­åµŒå…¥çš„å‡­è¯ä½œä¸ºåŸºæœ¬æˆæƒå¤´è½¬å‘ï¼Œä¸ Node.js è¡Œä¸ºä¸€è‡´ã€‚</p>
<p>å½“è¿æ¥åˆ°ä¸€ä¸ªåŒ…å«å‡­è¯çš„ WebSocket URLï¼ˆå¦‚ ws://user:pass@host ï¼‰æ—¶ï¼ŒBun ç°åœ¨ä¼šè‡ªåŠ¨æå–å‡­è¯ï¼Œå¹¶åœ¨ WebSocket å‡çº§æ¡æ‰‹è¿‡ç¨‹ä¸­å°†å…¶ä½œä¸ºæ­£ç¡®ç¼–ç çš„ Authorization: Basic å¤´éƒ¨å‘é€ã€‚</p>
<hr/>
<p>ä»¥ä¸Šå°±æ˜¯æœ¬æ¬¡æ›´æ–°å†…å®¹ï¼Œæˆ‘æ˜¯<code>ç¼–ç¨‹è®°è€…é™ˆéšæ˜“</code>ï¼Œç»™å¤§å®¶åˆ†äº«è¡Œä¸šçƒ­ç‚¹ï¼Œä»£ç æŠ€æœ¯ï¼Œç¼–ç¨‹èµ„è®¯ç­‰ï¼Œæ¬¢è¿å…³æ³¨~</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2026 å¼€å¹´å³ç”¨ï¼šæ¿å—å¼è¿›åº¦é€è§†ç®¡ç†å·¥å…·å¿«é€Ÿä¸Šæ‰‹ç§˜ç±ä¸æ ¸å¿ƒåŠŸèƒ½æ”»ç•¥]]></title>    <link>https://juejin.cn/post/7599852042531078154</link>    <guid>https://juejin.cn/post/7599852042531078154</guid>    <pubDate>2026-01-28T02:04:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599852042531078154" data-draft-id="7599912857392545838" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2026 å¼€å¹´å³ç”¨ï¼šæ¿å—å¼è¿›åº¦é€è§†ç®¡ç†å·¥å…·å¿«é€Ÿä¸Šæ‰‹ç§˜ç±ä¸æ ¸å¿ƒåŠŸèƒ½æ”»ç•¥"/> <meta itemprop="keywords" content="å›¢é˜Ÿç®¡ç†"/> <meta itemprop="datePublished" content="2026-01-28T02:04:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="dyinå‡Œgod"/> <meta itemprop="url" content="https://juejin.cn/user/2754714125992808"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2026 å¼€å¹´å³ç”¨ï¼šæ¿å—å¼è¿›åº¦é€è§†ç®¡ç†å·¥å…·å¿«é€Ÿä¸Šæ‰‹ç§˜ç±ä¸æ ¸å¿ƒåŠŸèƒ½æ”»ç•¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2754714125992808/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    dyinå‡Œgod
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:04:21.000Z" title="Wed Jan 28 2026 02:04:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨é¡¹ç›®ç®¡ç†æ—¥ç›Šå¤æ‚çš„æ•°å­—åŒ–ç¯å¢ƒä¸­ï¼Œå›¢é˜Ÿçš„æ•ˆç‡ç“¶é¢ˆå·²ä»"ä»»åŠ¡åˆ†é…"è½¬å‘"è¿›åº¦å…³ç³»çš„ç²¾å‡†è§£æ"ã€‚æ¿å—å¼è¿›åº¦é€è§†å·¥å…·ä¸ä»…æ˜¯é™æ€çš„ç”˜ç‰¹å›¾æˆ–çº¿æ€§è¿›åº¦è¡¨ï¼Œæ›´æ˜¯é€šè¿‡å¤šç»´æ‹“æ‰‘çš„é€»è¾‘æ˜ å°„ï¼Œå°†é”™ç»¼å¤æ‚çš„é¡¹ç›®ç½‘ç»œè½¬åŒ–ä¸ºå¯è§†åŒ–ã€å¯æ¨ªå‘/çºµå‘å…³è”çš„æ¿å—å¼è¿›åº¦èµ„äº§çš„è§£æå¼•æ“ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ ä¸ºä»€ä¹ˆç°ä»£é¡¹ç›®ç®¡ç†å¿…é¡»é‡è§†"æ¿å—å¼"é€è§†ï¼Ÿ</h2>
<p>ä¼ ç»Ÿå•å±‚è¿›åº¦è¡¨æˆ–çº¿æ€§ä»»åŠ¡åˆ—è¡¨å¾€å¾€å¯¼è‡´"è¿›åº¦ç›²åŒº"ï¼šå…³è”ä»»åŠ¡è¢«å‰²è£‚ï¼Œåº•å±‚ä¾èµ–è¢«æ©ç›–åœ¨ç¦»æ•£çš„æ¡ç›®ä¸­ã€‚æ¿å—å¼è¿›åº¦é€è§†å·¥å…·çš„æ ¸å¿ƒä»·å€¼åœ¨äºï¼š</p>
<ul>
<li><strong>æ¶ˆé™¤è¿›åº¦ç›²åŒº</strong>ï¼šé€šè¿‡æ¿å—å†…éƒ¨çš„æ— é™ç»†åˆ†ï¼Œç¡®ä¿æ¯ä¸€ä¸ªç»†å¾®ä»»åŠ¡éƒ½èƒ½åœ¨å®è§‚é¡¹ç›®ç»“æ„ä¸­æ‰¾åˆ°å½’å±ï¼Œè€Œéæ‚¬æµ®å­˜åœ¨ã€‚</li>
<li><strong>æ”¯æ’‘å¤šç»´è¿›åº¦ç©¿é€</strong>ï¼šæ”¯æŒåœ¨é€è§†è¿‡ç¨‹ä¸­å®ç°è·¨é˜¶æ®µç©¿é€ï¼Œä»æ ¸å¿ƒé‡Œç¨‹ç¢‘å±‚ç¬ç§»è‡³æœ€è¾¹ç¼˜çš„æ”¯æ’‘ç»†èŠ‚ã€‚</li>
<li><strong>å®ç°æ‹“æ‰‘è¿›åº¦å¯¹é½</strong>ï¼šé€šè¿‡å¤šé‡åŒ…å«å…³ç³»ï¼Œå„æ¨¡å—çš„è¿›åº¦é€»è¾‘è‡ªåŠ¨å½¢æˆäº’è”ç½‘ç»œï¼Œç¡®ä¿å›¢é˜Ÿå¯¹å¤æ‚é¡¹ç›®è®¤çŸ¥çš„ä¸€è‡´æ€§ã€‚</li>
<li><strong>éçº¿æ€§ä»»åŠ¡æ¨¡å—åŒ–å°è£…</strong>ï¼šå°†å·²éªŒè¯çš„è¿›åº¦æ¨¡å‹å°è£…ä¸ºæ¿å—ç»„ä»¶ï¼Œå®ç°å¤æ‚é¡¹ç›®åœ¨ä¸åŒä¸šåŠ¡åœºæ™¯ä¸‹çš„å¿«é€Ÿé€è§†ä¸è°ƒç”¨ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-1">äºŒã€ æ¿å—å¼é€è§†çš„æŠ€æœ¯è·¯å¾„ï¼šä¸‰ç»´è¿›åº¦æ¶æ„</h2>
<p>æ„å»ºæ¿å—å¼è¿›åº¦é€è§†ä½“ç³»éœ€è¦éµå¾ª"æ¿å—è§£æ„"ä¸"è¿›åº¦å…³è”"çš„é€»è¾‘ï¼š</p>
<ol>
<li><strong>å®è§‚æ¿å—å±‚ï¼ˆMacro Panelï¼‰</strong> ï¼šå®šä¹‰é€è§†çš„æ ¸å¿ƒé”šç‚¹ï¼Œå±•ç¤ºé¡¹ç›®å…¨å±€çš„ä»·å€¼æµå‘ã€å…³é”®é‡Œç¨‹ç¢‘åŠç³»ç»Ÿè¾¹ç•Œã€‚</li>
<li><strong>åµŒå¥—è¿›åº¦å±‚ï¼ˆNested Progressï¼‰</strong> ï¼šå°†æ ¸å¿ƒæ¿å—æ‹†è§£ä¸ºå…·æœ‰ä»å±æˆ–å¹¶åˆ—å…³ç³»çš„äºŒçº§è¿›åº¦ç©ºé—´ï¼Œè®°å½•ä»»åŠ¡é—´çš„åŠ¨æ€äº¤äº’ä¸ä¾èµ–é“¾æ¡ã€‚</li>
<li><strong>å…ƒæ•°æ®é€è§†å±‚ï¼ˆMetadata Perspectiveï¼‰</strong> ï¼šä½äºé€è§†çš„æœ€æ·±å¤„ï¼Œèšç„¦äºå…·ä½“ä»»åŠ¡çš„å®šä¹‰ä¸å‚æ•°ï¼Œæä¾›åŸå­çº§çš„çŠ¶æ€æè¿°ä¸éªŒè¯æ ‡å‡†ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-2">ä¸‰ã€ æ ¸å¿ƒæŠ€æœ¯å®ç°ä¸ç®—æ³•ç¤ºä¾‹</h2>
<p>æ¿å—å¼è¿›åº¦é€è§†å·¥å…·çš„åº•å±‚é€»è¾‘æ¶‰åŠä»»åŠ¡æ·±åº¦éå†ã€ä¾èµ–ç¯è·¯æ£€æµ‹åŠè¿›åº¦è·¯å¾„ä¼˜åŒ–ç®—æ³•ã€‚</p>
<h3 data-id="heading-3">1. åŸºäºé€’å½’æœç´¢çš„åµŒå¥—ä»»åŠ¡æœç´¢ï¼ˆJavaScriptï¼‰</h3>
<p>åœ¨æ¿å—å¼è¿›åº¦ç»“æ„ä¸­ï¼Œå¿«é€Ÿå®šä½æ·±å±‚ä»»åŠ¡æ˜¯é€è§†çš„æ ¸å¿ƒã€‚ä»¥ä¸‹ä¸ºå®ç°ä»»åŠ¡æ·±åº¦æ£€ç´¢çš„é€»è¾‘ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * é€’å½’æ£€ç´¢åµŒå¥—è¿›åº¦ç»“æ„ä¸­çš„ç›®æ ‡ä»»åŠ¡
 * <span class="hljs-doctag">@param</span> {Array} panelTasks æ¿å—ä»»åŠ¡æ•°ç»„
 * <span class="hljs-doctag">@param</span> {string} targetId ç›®æ ‡ä»»åŠ¡ID
 * <span class="hljs-doctag">@returns</span> {Object|null} åŒ¹é…åˆ°çš„åµŒå¥—ä»»åŠ¡å¯¹è±¡
 */</span>
function findNestedTask(panelTasks, targetId) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> task of panelTasks) {
        <span class="hljs-keyword">if</span> (task.id === targetId) <span class="hljs-keyword">return</span> task;
          
        <span class="hljs-comment">// å¦‚æœå­˜åœ¨åµŒå¥—å­å±‚çº§ï¼Œåˆ™ç»§ç»­å‘ä¸‹é€’å½’æ£€ç´¢</span>
        <span class="hljs-keyword">if</span> (task.nestedPanels &amp;&amp; task.nestedPanels.length &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">const</span> found = findNestedTask(task.nestedPanels, targetId);
            <span class="hljs-keyword">if</span> (found) <span class="hljs-keyword">return</span> found;
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}
</code></pre>
<h3 data-id="heading-4">2. Pythonï¼šè¿›åº¦ç»“æ„å†—ä½™åº¦åŠ¨æ€å®¡è®¡å¼•æ“</h3>
<p>åˆ©ç”¨æ¿å—æ¨¡å‹ï¼Œè‡ªåŠ¨æ£€æµ‹ä»»åŠ¡é—´çš„é‡å¤è¿›åº¦ä¸è¿‡åº¦åµŒå¥—ï¼Œè¯†åˆ«è®¤çŸ¥å†—ä½™é£é™©ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ProgressAuditEngine</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-comment"># é¢„è®¾è¿›åº¦æ ‡å‡†ï¼šä»»åŠ¡ç±»å‹ -&gt; æ¨èåµŒå¥—æ·±åº¦ä¸å…³è”å¯†åº¦</span>
        self.progress_benchmarks = {
            <span class="hljs-string">"Development_Phase"</span>: {<span class="hljs-string">"max_depth"</span>: <span class="hljs-number">5</span>, <span class="hljs-string">"avg_links"</span>: <span class="hljs-number">3</span>},
            <span class="hljs-string">"Testing_Cycle"</span>: {<span class="hljs-string">"max_depth"</span>: <span class="hljs-number">3</span>, <span class="hljs-string">"avg_links"</span>: <span class="hljs-number">8</span>}
        }

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">verify_progress_efficiency</span>(<span class="hljs-params">self, current_panel, panel_type</span>):
        <span class="hljs-string">"""å¯¹æ¯”å®é™…åµŒå¥—æ·±åº¦ä¸æ ‡å‡†ï¼Œè¯†åˆ«å†—ä½™æˆ–è¿‡äºå¤æ‚çš„è¿›åº¦ç‚¹"""</span>
        std = self.progress_benchmarks.get(panel_type)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> std:
            <span class="hljs-keyword">return</span> <span class="hljs-string">"æœªå®šä¹‰çš„è¿›åº¦æ ‡å‡†"</span>

        actual_depth = self._get_max_depth(current_panel)
        <span class="hljs-keyword">if</span> actual_depth &gt; std[<span class="hljs-string">'max_depth'</span>]:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[Progress Alert] åµŒå¥—æ·±åº¦è¾¾ <span class="hljs-subst">{actual_depth}</span> å±‚ï¼Œå·²è¶…å‡ºè®¤çŸ¥è´Ÿè·é˜ˆå€¼"</span>)
            self._suggest_flattening(current_panel)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_get_max_depth</span>(<span class="hljs-params">self, task, level=<span class="hljs-number">1</span></span>):
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> task.get(<span class="hljs-string">'subtasks'</span>):
            <span class="hljs-keyword">return</span> level
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">max</span>(self._get_max_depth(t, level + <span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> task[<span class="hljs-string">'subtasks'</span>])
</code></pre>
<h3 data-id="heading-5">3. SQLï¼šåµŒå¥—ä»»åŠ¡å…³è”è·¯å¾„ä¸å½±å“åˆ†æ</h3>
<p>é€šè¿‡é€’å½’å…¬ç”¨è¡¨è¡¨è¾¾å¼ï¼ˆCTEï¼‰ï¼ŒæŸ¥è¯¢ç‰¹å®šä»»åŠ¡åœ¨æ•´ä¸ªæ¿å—å¼è¿›åº¦ç½‘ç»œä¸­çš„æ³¢åŠèŒƒå›´ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">WITH</span> <span class="hljs-keyword">RECURSIVE</span> TaskImpactPath <span class="hljs-keyword">AS</span> (
    <span class="hljs-comment">-- èµ·å§‹ï¼šé€‰æ‹©ç›®æ ‡åµŒå¥—ä»»åŠ¡</span>
    <span class="hljs-keyword">SELECT</span> id, task_name, parent_id, <span class="hljs-number">1</span> <span class="hljs-keyword">AS</span> impact_level
    <span class="hljs-keyword">FROM</span> panel_tasks <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-string">'target_task_001'</span>
    <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">ALL</span>
    <span class="hljs-comment">-- é€’å½’ï¼šå‘ä¸Šæˆ–å‘ä¸‹è¿½è¸ªæ‰€æœ‰å—å½±å“çš„åµŒå¥—å…³è”å•å…ƒ</span>
    <span class="hljs-keyword">SELECT</span> pt.id, pt.task_name, pt.parent_id, tip.impact_level <span class="hljs-operator">+</span> <span class="hljs-number">1</span>
    <span class="hljs-keyword">FROM</span> panel_tasks pt
    <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> TaskImpactPath tip <span class="hljs-keyword">ON</span> pt.parent_id <span class="hljs-operator">=</span> tip.id
)
<span class="hljs-keyword">SELECT</span> 
    task_name, 
    impact_level,
    <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">OVER</span>() <span class="hljs-keyword">as</span> total_affected_tasks
<span class="hljs-keyword">FROM</span> TaskImpactPath
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> impact_level <span class="hljs-keyword">ASC</span>;
</code></pre>
<hr/>
<h2 data-id="heading-6">å››ã€ å·¥å…·åˆ†ç±»ä¸é€‰å‹æ€è·¯</h2>
<p>å®æ–½æ¿å—å¼è¿›åº¦é€è§†æ—¶ï¼Œå·¥å…·çš„é€‰æ‹©åº”åŸºäºå¯¹"ç©ºé—´å±•å¼€èƒ½åŠ›"çš„éœ€æ±‚ï¼š</p>
<ul>
<li><strong>æ— é™å¡ç‰‡æ¿å—ç±»ï¼ˆå¦‚ æ¿æ —çœ‹æ¿/Heptabaseï¼‰</strong> ï¼šæ ¸å¿ƒä¼˜åŠ¿åœ¨äº<strong>å¡ç‰‡çº§çš„çœ‹æ¿æ¿å—ä¸è§†è§‰è¿é€š</strong>ï¼Œæ”¯æŒå°†è¿›åº¦é€»è¾‘è½¬åŒ–ä¸ºç›´è§‚çš„è§†è§‰å¡ç‰‡ã€‚</li>
<li><strong>å…³ç³»å‹è¿›åº¦å›¾è°±ç±»ï¼ˆå¦‚ Obsidian/Logseqï¼‰</strong> ï¼šé€šè¿‡åŒå‘é“¾æ¥æ„å»ºéšæ€§çš„æ¿å—ç»“æ„ï¼Œé€‚åˆå¤„ç†éçº¿æ€§ã€ç½‘çŠ¶æ¼”åŒ–çš„ä»»åŠ¡ä½“ç³»ã€‚</li>
<li><strong>ç»“æ„åŒ–è¿›åº¦ç±»ï¼ˆå¦‚ MindManager/XMindï¼‰</strong> ï¼šç»å…¸çš„å±‚çº§æ¿å—å·¥å…·ï¼Œé€‚åˆå¯¹é¡¹ç›®æµç¨‹ã€ä»»åŠ¡æ¶æ„è¿›è¡Œå¼ºé€»è¾‘æ€§çš„å‚ç›´é€è§†ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-7">äº”ã€ å®æ–½ä¸­çš„é£é™©æ§åˆ¶ä¸ç®¡ç†ä¼˜åŒ–</h2>
<ul>
<li><strong>é˜²æ­¢"æ— é™æ¿å—å¯¼è‡´çš„é»‘æ´æ•ˆåº”"</strong> ï¼šåº”è®¾å®šåˆç†çš„æ¿å—é˜ˆå€¼ï¼ˆå¦‚ä¸è¶…è¿‡ 7 å±‚ï¼‰ï¼Œå¹¶åœ¨å·¥å…·ä¸­åˆ©ç”¨"ç¼©æ”¾è¯­ä¹‰ï¼ˆSemantic Zoomingï¼‰"æŠ€æœ¯ï¼Œç¡®ä¿åœ¨é«˜å€ç‡ç¼©æ”¾æ—¶ä»èƒ½è¯†åˆ«æ ¸å¿ƒä»»åŠ¡ã€‚</li>
<li><strong>åŠ¨æ€åŒæ­¥è¿›åº¦èµ„äº§</strong>ï¼šæ¿å—ä»»åŠ¡åº”å…·å¤‡å®æ—¶æ›´æ–°èƒ½åŠ›ï¼Œå½“åº•å±‚ä»»åŠ¡å‘ç”Ÿå˜åŠ¨æ—¶ï¼Œé«˜å±‚æ¿å—ç»“æ„çš„è¿›åº¦é€»è¾‘éœ€è‡ªåŠ¨å®Œæˆä¸€è‡´æ€§æ ¡éªŒã€‚</li>
<li><strong>å®šæœŸè¿›è¡Œç»“æ„"ä¿®å‰ª"</strong> ï¼šéšç€è¿›åº¦é€»è¾‘çš„æˆç†Ÿï¼Œåº”åˆå¹¶ç›¸ä¼¼çš„æ¿å—å±‚çº§ï¼Œä¿æŒè¿›åº¦å›¾è°±çš„æ¸…æ™°åº¦ä¸å†³ç­–æ”¯æŒæ•ˆèƒ½ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-8">å…­ã€ ç»“è¯­</h2>
<p><strong>æ¿å—å¼è¿›åº¦é€è§†æ˜¯è§£æé¡¹ç›®å¤æ‚æ€§çš„æ‰‹æœ¯åˆ€ã€‚</strong> â€‹ å®ƒä¸ä»…è§£å†³äº†"è¿›åº¦æ•£ä¹±"çš„é—®é¢˜ï¼Œæ›´é€šè¿‡ç²¾å¯†çš„å¤šç»´ç»“æ„ï¼Œå°†å›¢é˜Ÿé›¶æ•£çš„è¿›åº¦ç‰‡æ®µè½¬åŒ–ä¸ºå…·å¤‡é«˜åº¦é€»è¾‘è‡ªæ´½æ€§çš„æ™ºèƒ½èµ„äº§ã€‚å½“é¡¹ç›®çš„è¿›åº¦èƒ½å¤Ÿä»¥æ¿å—å½¢å¼å®ç°æ°´å¹³ä¸å‚ç›´çš„å®Œç¾å¯¹é½æ—¶ï¼Œå›¢é˜Ÿæ–¹èƒ½åœ¨å‰§çƒˆçš„é¡¹ç›®æ³¢åŠ¨ä¸­å®ç°"å…¨å±€æ´å¯Ÿ"ä¸"ç²¾å‡†æ‰“å‡»"çš„ç»Ÿä¸€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Agent Skillsï¼šèµ‹äºˆ AI Agent ä¸“ä¸šèƒ½åŠ›çš„å¼€æ”¾æ ‡å‡†]]></title>    <link>https://juejin.cn/post/7599927813601083432</link>    <guid>https://juejin.cn/post/7599927813601083432</guid>    <pubDate>2026-01-28T02:31:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599927813601083432" data-draft-id="7599964577899544576" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Agent Skillsï¼šèµ‹äºˆ AI Agent ä¸“ä¸šèƒ½åŠ›çš„å¼€æ”¾æ ‡å‡†"/> <meta itemprop="keywords" content="Agent,äººå·¥æ™ºèƒ½,Claude"/> <meta itemprop="datePublished" content="2026-01-28T02:31:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é™ˆæš–ç§‹"/> <meta itemprop="url" content="https://juejin.cn/user/493019579297533"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Agent Skillsï¼šèµ‹äºˆ AI Agent ä¸“ä¸šèƒ½åŠ›çš„å¼€æ”¾æ ‡å‡†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/493019579297533/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é™ˆæš–ç§‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:31:27.000Z" title="Wed Jan 28 2026 02:31:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    18
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#444;background-image:linear-gradient(90deg,rgba(59,59,59,.1) 3%,transparent 0),linear-gradient(1turn,rgba(122,120,121,.1) 3%,transparent 0);background-size:30px 30px;background-position:50%;letter-spacing:1px;word-spacing:1px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{position:relative;margin-top:34px;margin-bottom:16px;font-weight:700;line-height:1.3;cursor:text;color:#444;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body h1{font-size:41px;margin-bottom:34px;line-height:1.5}.markdown-body h1:before{content:""}.markdown-body h2{font-size:30px;padding-left:.4em;border-left:.4em solid #5e5e5e;border-bottom:1px solid #444}.markdown-body h2:after{content:"ğŸ•›";position:absolute;top:0;right:0;transition:all;animation:rotate 10s linear infinite}@keyframes rotate{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.markdown-body h3{border-left:.4em solid #8d8d8d;font-size:24px;padding-left:.4em}.markdown-body h4{font-size:20px}.markdown-body h5{font-size:16px}.markdown-body h6{font-size:14px}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body table,.markdown-body ul{margin:.8em 0}.markdown-body strong{font-weight:1000;position:relative;color:#444;padding:0 3px}.markdown-body em{font-weight:inherit}.markdown-body a{box-sizing:border-box;color:grey;position:relative}.markdown-body a:before{position:absolute;box-sizing:border-box;content:"Go -&gt;";left:0;width:100%;max-width:0;color:#fff;background-color:hsla(0,0%,50.2%,.8);white-space:nowrap;transition:.2s ease;pointer-events:none;overflow:hidden}.markdown-body a:after{content:"";position:absolute;bottom:0;left:0;width:100%;height:1px;background-color:grey}.markdown-body a:active:before,.markdown-body a:hover:before{max-width:100%;padding-left:8px;border-radius:5px}.markdown-body hr{position:relative;width:100%;height:1px;border:none;margin-top:36px;margin-bottom:36px;background:linear-gradient(90deg,grey,#f1f1f1,#444,#444,#f1f1f1,grey);overflow:visible}.markdown-body ol,.markdown-body ul{padding-left:32px}.markdown-body ol li,.markdown-body ul li{margin-bottom:6px;list-style:inherit}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol{counter-reset:my-counter}.markdown-body ol&gt;li{padding-left:6px;list-style:none;counter-increment:my-counter;position:relative}.markdown-body ol&gt;li:before{position:absolute;left:-1.5em;content:counter(my-counter);font-weight:700}.markdown-body ol&gt;li:first-child:before{content:"1ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(2):before{content:"2ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(3):before{content:"3ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(4):before{content:"4ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(5):before{content:"5ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(6):before{content:"6ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(7):before{content:"7ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(8):before{content:"8ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(9):before{content:"9ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(10):before{content:"ğŸ”Ÿ"}.markdown-body ul&gt;li{list-style:none;position:relative}.markdown-body ul&gt;li:before{z-index:10;position:absolute;left:-1.57em;content:"ğŸ”¹";margin-right:12px}.markdown-body ul&gt;li input{margin-left:8px!important}.markdown-body blockquote{position:relative;background-color:#d3d3d3;padding:5px 10px;border-left:.2em solid #000;border-radius:3px;transition:all .8s ease}.markdown-body blockquote:hover{opacity:.7}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(69,69,77,.8);color:#fff;font-size:.87em;padding:.07em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:7px;overflow:hidden}.markdown-body pre:before{z-index:10;position:absolute;top:14px;left:14px;width:12px;height:12px;border-radius:50%;background:#fc625d;-webkit-box-shadow:20px 0 #fdbc40,40px 0 #35cd4b;box-shadow:20px 0 #fdbc40,40px 0 #35cd4b;content:" "}.markdown-body pre:after{z-index:9;content:"";position:absolute;width:100%;height:40px;top:0;background-color:#1a1a1a}.markdown-body pre&gt;code{display:block;font-family:Menlo,Monaco,Consolas,Courier New,monospace;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#171717;color:#bababa;font-size:14px;padding:40px 20px 20px}.markdown-body del{color:grey}.markdown-body table{margin-bottom:1.25rem;border-collapse:collapse}.markdown-body table td,.markdown-body table th{margin:0;padding:8px;line-height:20px;vertical-align:middle;border:1px solid #ddd}.markdown-body table thead,.markdown-body table tr:nth-child(2n){background-color:#fcfcfc}.markdown-body table thead th,.markdown-body table tr:nth-child(2n) th{font-weight:700;vertical-align:middle;color:#444}.markdown-body table tbody tr td{font-weight:400;color:#444}.markdown-body table tbody tr:hover{background-color:#d3d3d3}.markdown-body table tbody tr:hover td{color:#fff}.markdown-body img{max-width:100%;margin:0 12px}@media (max-width:720px){.markdown-body h1{font-size:32.8px}.markdown-body h2{font-size:24px}.markdown-body h3{font-size:19.2px}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:12.8px}}</style><style data-highlight="" data-highlight-key="arduino-light">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff}.hljs-subst,.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#434f54}.hljs-attribute,.hljs-doctag,.hljs-keyword,.hljs-name,.hljs-selector-tag{color:#00979d}.hljs-addition,.hljs-built_in,.hljs-bullet,.hljs-code,.hljs-literal{color:#d35400}.hljs-link,.hljs-regexp,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-symbol,.hljs-template-variable,.hljs-variable{color:#00979d}.hljs-deletion,.hljs-quote,.hljs-selector-class,.hljs-selector-id,.hljs-string,.hljs-template-tag,.hljs-type{color:#005c5f}.hljs-section,.hljs-title{color:#800;font-weight:700}.hljs-comment{color:rgba(149,165,166,.8)}.hljs-meta-keyword{color:#728e00}.hljs-meta{color:#434f54}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-function{color:#728e00}.hljs-number{color:#8a7b52}</style><blockquote>
<p>ä¸€ç§ç®€å•ã€å¼€æ”¾çš„æ ¼å¼ï¼Œè®© AI Agent è·å¾—æ–°èƒ½åŠ›å’Œä¸“ä¸šçŸ¥è¯†</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ä»€ä¹ˆæ˜¯ Agent Skillsï¼Ÿ</h2>
<p>Agent Skills æ˜¯ä¸€ç§<strong>è½»é‡çº§ã€å¼€æ”¾çš„æ ¼å¼</strong>ï¼Œç”¨äºæ‰©å±• AI Agent çš„èƒ½åŠ›ï¼Œä½¿å…¶å…·å¤‡ä¸“ä¸šçŸ¥è¯†å’Œç‰¹å®šå·¥ä½œæµç¨‹ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼ŒAgent Skills æ˜¯åŒ…å«æŒ‡ä»¤ã€è„šæœ¬å’Œèµ„æºçš„æ–‡ä»¶å¤¹ï¼ŒAgent å¯ä»¥å‘ç°å¹¶ä½¿ç”¨è¿™äº›èµ„æºæ¥æ›´å‡†ç¡®ã€æ›´é«˜æ•ˆåœ°å®Œæˆä»»åŠ¡ã€‚</p>
<blockquote>
<p><strong>æ ¸å¿ƒå®šä¹‰</strong>ï¼šAgent Skills æ˜¯åŒ…å« <code>SKILL.md</code> æ–‡ä»¶çš„æ–‡ä»¶å¤¹ï¼Œè¯¥æ–‡ä»¶åŒ…å«å…ƒæ•°æ®ï¼ˆè‡³å°‘åŒ…æ‹¬åç§°å’Œæè¿°ï¼‰ä»¥åŠå‘Šè¯‰ Agent å¦‚ä½•æ‰§è¡Œç‰¹å®šä»»åŠ¡çš„æŒ‡ä»¤ã€‚Skills è¿˜å¯ä»¥æ†ç»‘è„šæœ¬ã€æ¨¡æ¿å’Œå‚è€ƒææ–™ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-1">ä¸ºä»€ä¹ˆéœ€è¦ Agent Skillsï¼Ÿ</h2>
<p>éšç€ AI Agent èƒ½åŠ›çš„ä¸æ–­å¢å¼ºï¼Œå®ƒä»¬å¾€å¾€ç¼ºä¹æ‰§è¡Œå®é™…å·¥ä½œæ‰€éœ€çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚Agent Skills é€šè¿‡ä»¥ä¸‹æ–¹å¼è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p>

























<table><thead><tr><th>ç‰¹æ€§</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>é¢†åŸŸä¸“ä¸šçŸ¥è¯†</strong></td><td>å°†æ³•å¾‹å®¡æŸ¥æµç¨‹ã€æ•°æ®åˆ†æç®¡é“ç­‰ä¸“ä¸šé¢†åŸŸçŸ¥è¯†æ‰“åŒ…æˆå¯é‡ç”¨çš„æŒ‡ä»¤</td></tr><tr><td><strong>æ–°èƒ½åŠ›æ‰©å±•</strong></td><td>èµ‹äºˆ Agent æ–°èƒ½åŠ›ï¼Œå¦‚åˆ›å»ºæ¼”ç¤ºæ–‡ç¨¿ã€æ„å»º MCP æœåŠ¡å™¨ã€åˆ†ææ•°æ®é›†ç­‰</td></tr><tr><td><strong>å¯é‡å¤å·¥ä½œæµ</strong></td><td>å°†å¤šæ­¥éª¤ä»»åŠ¡è½¬åŒ–ä¸ºä¸€è‡´ä¸”å¯å®¡è®¡çš„å·¥ä½œæµç¨‹ï¼Œç¡®ä¿æ¯æ¬¡æ‰§è¡Œçš„è´¨é‡</td></tr><tr><td><strong>äº’æ“ä½œæ€§</strong></td><td>åœ¨ä¸åŒçš„ Skills å…¼å®¹ Agent äº§å“ä¸­é‡ç”¨ç›¸åŒçš„ Skillï¼Œé¿å…é‡å¤å¼€å‘</td></tr></tbody></table>
<h3 data-id="heading-2">è°å¯ä»¥ä» Agent Skills ä¸­å—ç›Šï¼Ÿ</h3>
<ul>
<li><strong>Skill ä½œè€…</strong>ï¼šä¸€æ¬¡æ„å»ºèƒ½åŠ›ï¼Œéƒ¨ç½²åˆ°å¤šä¸ª Agent äº§å“ä¸­</li>
<li><strong>å…¼å®¹ Agent</strong>ï¼šæ”¯æŒ Skills è®©ç»ˆç«¯ç”¨æˆ·èƒ½å¤Ÿå¼€ç®±å³ç”¨åœ°èµ‹äºˆ Agent æ–°èƒ½åŠ›</li>
<li><strong>å›¢é˜Ÿå’Œä¼ä¸š</strong>ï¼šå°†ç»„ç»‡çŸ¥è¯†æ•è·åˆ°å¯ç§»æ¤ã€ç‰ˆæœ¬æ§åˆ¶çš„åŒ…ä¸­</li>
</ul>
<hr/>
<h2 data-id="heading-3">Agent Skills çš„å·¥ä½œåŸç†</h2>
<p>Agent Skills ä½¿ç”¨**æ¸è¿›å¼æŠ«éœ²ï¼ˆProgressive Disclosureï¼‰**æ¥é«˜æ•ˆç®¡ç†ä¸Šä¸‹æ–‡ï¼š</p>
<pre><code class="hljs language-objectivec" lang="objectivec">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   <span class="hljs-number">1.</span> å‘ç°    â”‚  â†’   â”‚   <span class="hljs-number">2.</span> æ¿€æ´»    â”‚  â†’   â”‚   <span class="hljs-number">3.</span> æ‰§è¡Œ    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å¯åŠ¨æ—¶ï¼ŒAgent â”‚      â”‚ å½“ä»»åŠ¡ä¸ Skill â”‚      â”‚ Agent éµå¾ªæŒ‡ä»¤ï¼Œâ”‚
â”‚ ä»…åŠ è½½æ¯ä¸ªå¯ç”¨ â”‚      â”‚ æè¿°åŒ¹é…æ—¶ï¼Œ   â”‚      â”‚ æŒ‰éœ€åŠ è½½å¼•ç”¨æ–‡ä»¶ â”‚
â”‚ Skill çš„åç§°å’Œ â”‚      â”‚ Agent è¯»å–å®Œæ•´ â”‚      â”‚ æˆ–æ‰§è¡Œæ†ç»‘ä»£ç   â”‚
â”‚ æè¿°        â”‚      â”‚ <span class="hljs-built_in">SKILL</span>.md æŒ‡ä»¤ â”‚      â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>è¿™ç§æ–¹æ³•æ—¢ä¿æŒäº† Agent çš„å¿«é€Ÿå“åº”ï¼Œåˆä½¿å…¶èƒ½å¤ŸæŒ‰éœ€è®¿é—®æ›´å¤šä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</p>
<hr/>
<h2 data-id="heading-4">SKILL.md æ–‡ä»¶æ ¼å¼</h2>
<p>æ¯ä¸ª Skill éƒ½å¿…é¡»åŒ…å«ä¸€ä¸ª <code>SKILL.md</code> æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å« YAML å‰ç½®å…ƒæ•°æ®å’Œ Markdown å†…å®¹ã€‚</p>
<h3 data-id="heading-5">ç›®å½•ç»“æ„</h3>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-keyword">my</span>-skill/
â”œâ”€â”€ SKILL.md          <span class="hljs-comment"># å¿…éœ€ï¼šæŒ‡ä»¤ + å…ƒæ•°æ®</span>
â”œâ”€â”€ scripts/          <span class="hljs-comment"># å¯é€‰ï¼šå¯æ‰§è¡Œä»£ç </span>
â”œâ”€â”€ references/       <span class="hljs-comment"># å¯é€‰ï¼šæ–‡æ¡£å‚è€ƒ</span>
â””â”€â”€ assets/           <span class="hljs-comment"># å¯é€‰ï¼šæ¨¡æ¿ã€èµ„æº</span>
</code></pre>
<h3 data-id="heading-6">å‰ç½®å…ƒæ•°æ®å­—æ®µ</h3>








































<table><thead><tr><th>å­—æ®µ</th><th>å¿…éœ€</th><th>çº¦æŸæ¡ä»¶</th></tr></thead><tbody><tr><td><code>name</code></td><td>æ˜¯</td><td>æœ€å¤š 64 å­—ç¬¦ï¼Œå°å†™å­—æ¯ã€æ•°å­—å’Œè¿å­—ç¬¦ï¼Œä¸èƒ½ä»¥è¿å­—ç¬¦å¼€å¤´æˆ–ç»“å°¾</td></tr><tr><td><code>description</code></td><td>æ˜¯</td><td>æœ€å¤š 1024 å­—ç¬¦ï¼Œæè¿° Skill çš„åŠŸèƒ½å’Œä½¿ç”¨æ—¶æœº</td></tr><tr><td><code>license</code></td><td>å¦</td><td>è®¸å¯è¯åç§°æˆ–æ†ç»‘è®¸å¯è¯æ–‡ä»¶çš„å¼•ç”¨</td></tr><tr><td><code>compatibility</code></td><td>å¦</td><td>æœ€å¤š 500 å­—ç¬¦ï¼ŒæŒ‡ç¤ºç¯å¢ƒè¦æ±‚</td></tr><tr><td><code>metadata</code></td><td>å¦</td><td>ä»»æ„é”®å€¼æ˜ å°„ï¼Œç”¨äºé™„åŠ å…ƒæ•°æ®</td></tr><tr><td><code>allowed-tools</code></td><td>å¦</td><td>Skill å¯ä½¿ç”¨çš„é¢„æ‰¹å‡†å·¥å…·åˆ—è¡¨ï¼ˆå®éªŒæ€§ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-7">å®Œæ•´ç¤ºä¾‹</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">pdf-processing</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">ä»</span> <span class="hljs-string">PDF</span> <span class="hljs-string">æ–‡ä»¶ä¸­æå–æ–‡æœ¬å’Œè¡¨æ ¼ï¼Œå¡«å†™è¡¨å•ï¼Œåˆå¹¶æ–‡æ¡£ã€‚</span>
<span class="hljs-attr">license:</span> <span class="hljs-string">Apache-2.0</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">author:</span> <span class="hljs-string">example-org</span>
  <span class="hljs-attr">version:</span> <span class="hljs-string">"1.0"</span>
<span class="hljs-meta">---
</span>
<span class="hljs-comment"># PDF å¤„ç†</span>

<span class="hljs-comment">## ä½•æ—¶ä½¿ç”¨æ­¤ Skill</span>
<span class="hljs-string">å½“ç”¨æˆ·éœ€è¦å¤„ç†</span> <span class="hljs-string">PDF</span> <span class="hljs-string">æ–‡ä»¶æ—¶ä½¿ç”¨æ­¤</span> <span class="hljs-string">Skill...</span>

<span class="hljs-comment">## å¦‚ä½•æå–æ–‡æœ¬</span>
<span class="hljs-number">1</span><span class="hljs-string">.</span> <span class="hljs-string">ä½¿ç”¨</span> <span class="hljs-string">pdfplumber</span> <span class="hljs-string">è¿›è¡Œæ–‡æœ¬æå–...</span>

<span class="hljs-comment">## å¦‚ä½•å¡«å†™è¡¨å•</span>
<span class="hljs-string">...</span>
</code></pre>
<h3 data-id="heading-8">å„å­—æ®µè¯¦ç»†è¯´æ˜</h3>
<h4 data-id="heading-9">name å­—æ®µ</h4>
<p><strong>çº¦æŸæ¡ä»¶</strong>ï¼š</p>
<ul>
<li>å¿…é¡»æ˜¯ 1-64 ä¸ªå­—ç¬¦</li>
<li>åªèƒ½åŒ…å«å°å†™å­—æ¯ã€æ•°å­—å’Œè¿å­—ç¬¦ï¼ˆ<code>a-z</code> å’Œ <code>-</code>ï¼‰</li>
<li>ä¸èƒ½ä»¥ <code>-</code> å¼€å¤´æˆ–ç»“å°¾</li>
<li>ä¸èƒ½åŒ…å«è¿ç»­çš„è¿å­—ç¬¦ï¼ˆ<code>--</code>ï¼‰</li>
<li>å¿…é¡»ä¸çˆ¶ç›®å½•åç§°åŒ¹é…</li>
</ul>
<p><strong>æœ‰æ•ˆç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">pdf-processing</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">data-analysis</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">code-review</span>
</code></pre>
<p><strong>æ— æ•ˆç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">PDF-Processing</span>    <span class="hljs-comment"># ä¸å…è®¸å¤§å†™</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">-pdf</span>              <span class="hljs-comment"># ä¸èƒ½ä»¥è¿å­—ç¬¦å¼€å¤´</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">pdf--processing</span>   <span class="hljs-comment"># ä¸å…è®¸è¿ç»­è¿å­—ç¬¦</span>
</code></pre>
<h4 data-id="heading-10">description å­—æ®µ</h4>
<p><strong>çº¦æŸæ¡ä»¶</strong>ï¼š</p>
<ul>
<li>å¿…é¡»æ˜¯ 1-1024 ä¸ªå­—ç¬¦</li>
<li>åº”è¯¥æè¿° Skill çš„åŠŸèƒ½å’Œä½¿ç”¨æ—¶æœº</li>
<li>åº”åŒ…å«å¸®åŠ© Agent è¯†åˆ«ç›¸å…³ä»»åŠ¡çš„å…³é”®è¯</li>
</ul>
<p><strong>å¥½çš„ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">description:</span> <span class="hljs-string">ä»</span> <span class="hljs-string">PDF</span> <span class="hljs-string">æ–‡ä»¶ä¸­æå–æ–‡æœ¬å’Œè¡¨æ ¼ï¼Œå¡«å†™</span> <span class="hljs-string">PDF</span> <span class="hljs-string">è¡¨å•ï¼Œå¹¶åˆå¹¶å¤šä¸ª</span> <span class="hljs-string">PDFã€‚åœ¨å¤„ç†</span> <span class="hljs-string">PDF</span> <span class="hljs-string">æ–‡æ¡£æˆ–ç”¨æˆ·æåŠ</span> <span class="hljs-string">PDFã€è¡¨å•æˆ–æ–‡æ¡£æå–æ—¶ä½¿ç”¨ã€‚</span>
</code></pre>
<p><strong>å·®çš„ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">description:</span> <span class="hljs-string">å¸®åŠ©å¤„ç†</span> <span class="hljs-string">PDFã€‚</span>
</code></pre>
<h4 data-id="heading-11">license å­—æ®µï¼ˆå¯é€‰ï¼‰</h4>
<p>æŒ‡å®šåº”ç”¨äº Skill çš„è®¸å¯è¯ã€‚å»ºè®®ä¿æŒç®€çŸ­ï¼ˆè®¸å¯è¯åç§°æˆ–æ†ç»‘è®¸å¯è¯æ–‡ä»¶çš„åç§°ï¼‰ã€‚</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">license:</span> <span class="hljs-string">Proprietary.</span> <span class="hljs-string">LICENSE.txt</span> <span class="hljs-string">has</span> <span class="hljs-string">complete</span> <span class="hljs-string">terms</span>
</code></pre>
<h4 data-id="heading-12">compatibility å­—æ®µï¼ˆå¯é€‰ï¼‰</h4>
<p>æŒ‡ç¤ºç¯å¢ƒè¦æ±‚ï¼Œå¦‚ç›®æ ‡äº§å“ã€æ‰€éœ€ç³»ç»ŸåŒ…ã€ç½‘ç»œè®¿é—®éœ€æ±‚ç­‰ã€‚</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">compatibility:</span> <span class="hljs-string">Designed</span> <span class="hljs-string">for</span> <span class="hljs-string">Claude</span> <span class="hljs-string">Code</span> <span class="hljs-string">(or</span> <span class="hljs-string">similar</span> <span class="hljs-string">products)</span>
<span class="hljs-attr">compatibility:</span> <span class="hljs-string">Requires</span> <span class="hljs-string">git,</span> <span class="hljs-string">docker,</span> <span class="hljs-string">jq,</span> <span class="hljs-string">and</span> <span class="hljs-string">access</span> <span class="hljs-string">to</span> <span class="hljs-string">the</span> <span class="hljs-string">internet</span>
</code></pre>
<h4 data-id="heading-13">metadata å­—æ®µï¼ˆå¯é€‰ï¼‰</h4>
<p>å­—ç¬¦ä¸²é”®åˆ°å­—ç¬¦ä¸²å€¼çš„æ˜ å°„ï¼Œå®¢æˆ·ç«¯å¯ç”¨äºå­˜å‚¨ä»£ç†æŠ€èƒ½è§„èŒƒæœªå®šä¹‰çš„å…¶ä»–å±æ€§ã€‚</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">author:</span> <span class="hljs-string">example-org</span>
  <span class="hljs-attr">version:</span> <span class="hljs-string">"1.0"</span>
</code></pre>
<h4 data-id="heading-14">allowed-tools å­—æ®µï¼ˆå¯é€‰ï¼‰</h4>
<p>é¢„æ‰¹å‡†è¿è¡Œçš„å·¥å…·çš„ç©ºæ ¼åˆ†éš”åˆ—è¡¨ã€‚å®éªŒæ€§åŠŸèƒ½ï¼Œä¸åŒ Agent å®ç°å¯¹è¯¥å­—æ®µçš„æ”¯æŒå¯èƒ½æœ‰æ‰€ä¸åŒã€‚</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">allowed-tools:</span> <span class="hljs-string">Bash(git:*)</span> <span class="hljs-string">Bash(jq:*)</span> <span class="hljs-string">Read</span>
</code></pre>
<hr/>
<h2 data-id="heading-15">å¯é€‰ç›®å½•è¯¦è§£</h2>
<h3 data-id="heading-16">scripts/</h3>
<p>åŒ…å« Agent å¯ä»¥è¿è¡Œçš„å¯æ‰§è¡Œä»£ç ã€‚è„šæœ¬åº”è¯¥ï¼š</p>
<ul>
<li>è‡ªåŒ…å«æˆ–æ¸…æ™°è®°å½•ä¾èµ–é¡¹</li>
<li>åŒ…å«æœ‰ç”¨çš„é”™è¯¯æ¶ˆæ¯</li>
<li>ä¼˜é›…åœ°å¤„ç†è¾¹ç¼˜æƒ…å†µ</li>
</ul>
<p>æ”¯æŒçš„è¯­è¨€å–å†³äº Agent å®ç°ã€‚å¸¸è§é€‰é¡¹åŒ…æ‹¬ Pythonã€Bash å’Œ JavaScriptã€‚</p>
<h3 data-id="heading-17">references/</h3>
<p>åŒ…å« Agent å¯ä»¥æŒ‰éœ€è¯»å–çš„é™„åŠ æ–‡æ¡£ï¼š</p>
<ul>
<li><code>REFERENCE.md</code> - è¯¦ç»†æŠ€æœ¯å‚è€ƒ</li>
<li><code>FORMS.md</code> - è¡¨å•æ¨¡æ¿æˆ–ç»“æ„åŒ–æ•°æ®æ ¼å¼</li>
<li>é¢†åŸŸç‰¹å®šæ–‡ä»¶ï¼ˆ<code>finance.md</code>ã€<code>legal.md</code> ç­‰ï¼‰</li>
</ul>
<p>ä¿æŒå•ä¸ªå‚è€ƒæ–‡ä»¶èšç„¦ã€‚Agent æŒ‰éœ€åŠ è½½è¿™äº›æ–‡ä»¶ï¼Œå› æ­¤è¾ƒå°çš„æ–‡ä»¶æ„å‘³ç€æ›´å°‘çš„ä¸Šä¸‹æ–‡ä½¿ç”¨ã€‚</p>
<h3 data-id="heading-18">assets/</h3>
<p>åŒ…å«é™æ€èµ„æºï¼š</p>
<ul>
<li>æ¨¡æ¿ï¼ˆæ–‡æ¡£æ¨¡æ¿ã€é…ç½®æ¨¡æ¿ï¼‰</li>
<li>å›¾åƒï¼ˆå›¾è¡¨ã€ç¤ºä¾‹ï¼‰</li>
<li>æ•°æ®æ–‡ä»¶ï¼ˆæŸ¥æ‰¾è¡¨ã€æ¨¡å¼ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-19">æ¸è¿›å¼æŠ«éœ²æœ€ä½³å®è·µ</h2>
<p>Skills åº”è¯¥ä¸ºé«˜æ•ˆä½¿ç”¨ä¸Šä¸‹æ–‡è€Œæ„å»ºï¼š</p>

























<table><thead><tr><th>å±‚çº§</th><th>å†…å®¹</th><th>å¤§å°</th></tr></thead><tbody><tr><td><strong>å…ƒæ•°æ®</strong></td><td><code>name</code> å’Œ <code>description</code> å­—æ®µ</td><td>~100 tokens</td></tr><tr><td><strong>æŒ‡ä»¤</strong></td><td>å®Œæ•´çš„ <code>SKILL.md</code> æ­£æ–‡</td><td>&lt; 5000 tokensï¼ˆæ¨èï¼‰</td></tr><tr><td><strong>èµ„æº</strong></td><td><code>scripts/</code>ã€<code>references/</code> æˆ– <code>assets/</code> ä¸­çš„æ–‡ä»¶</td><td>æŒ‰éœ€åŠ è½½</td></tr></tbody></table>
<p>ä¿æŒä¸» <code>SKILL.md</code> åœ¨ 500 è¡Œä»¥ä¸‹ã€‚å°†è¯¦ç»†å‚è€ƒææ–™ç§»åˆ°å•ç‹¬çš„æ–‡ä»¶ä¸­ã€‚</p>
<hr/>
<h2 data-id="heading-20">å¦‚ä½•å°† Skills é›†æˆåˆ°ä½ çš„ Agent</h2>
<p>æœ‰ä¸¤ç§ä¸»è¦çš„é›†æˆæ–¹æ³•ï¼š</p>
<h3 data-id="heading-21">åŸºäºæ–‡ä»¶ç³»ç»Ÿçš„ Agent</h3>
<p>åœ¨è®¡ç®—æœºç¯å¢ƒï¼ˆbash/unixï¼‰ä¸­è¿è¡Œçš„ Agentï¼Œå½“æ¨¡å‹å‘å‡º shell å‘½ä»¤ï¼ˆå¦‚ <code>cat /path/to/my-skill/SKILL.md</code>ï¼‰æ—¶æ¿€æ´» Skillsã€‚æ†ç»‘çš„èµ„æºé€šè¿‡ shell å‘½ä»¤è®¿é—®ã€‚</p>
<h3 data-id="heading-22">åŸºäºå·¥å…·çš„ Agent</h3>
<p>åœ¨æ²¡æœ‰ä¸“ç”¨è®¡ç®—æœºç¯å¢ƒçš„æƒ…å†µä¸‹è¿è¡Œã€‚ç›¸åï¼Œå®ƒä»¬å®ç°å…è®¸æ¨¡å‹è§¦å‘ Skills å’Œè®¿é—®æ†ç»‘èµ„æºçš„å·¥å…·ã€‚å…·ä½“çš„å·¥å…·å®ç°ç”±å¼€å‘è€…å†³å®šã€‚</p>
<h3 data-id="heading-23">é›†æˆæ­¥éª¤</h3>
<p>ä¸€ä¸ªå…¼å®¹ Skills çš„ Agent éœ€è¦ï¼š</p>
<ol>
<li><strong>å‘ç°</strong>ï¼šåœ¨é…ç½®çš„ç›®å½•ä¸­å‘ç° Skills</li>
<li><strong>åŠ è½½å…ƒæ•°æ®</strong>ï¼šå¯åŠ¨æ—¶ä»…åŠ è½½åç§°å’Œæè¿°</li>
<li><strong>åŒ¹é…</strong>ï¼šå°†ç”¨æˆ·ä»»åŠ¡ä¸ç›¸å…³ Skills åŒ¹é…</li>
<li><strong>æ¿€æ´»</strong>ï¼šé€šè¿‡åŠ è½½å®Œæ•´æŒ‡ä»¤æ¥æ¿€æ´» Skills</li>
<li><strong>æ‰§è¡Œ</strong>ï¼šæŒ‰éœ€æ‰§è¡Œè„šæœ¬å’Œè®¿é—®èµ„æº</li>
</ol>
<h3 data-id="heading-24">Skill å‘ç°ä»£ç ç¤ºä¾‹</h3>
<pre><code class="hljs language-python" lang="python">function parseMetadata(skillPath):
    content = readFile(skillPath + <span class="hljs-string">"/SKILL.md"</span>)
    frontmatter = extractYAMLFrontmatter(content)
    <span class="hljs-keyword">return</span> {
        name: frontmatter.name,
        description: frontmatter.description,
        path: skillPath
    }
</code></pre>
<h3 data-id="heading-25">ç³»ç»Ÿæç¤ºæ ¼å¼</h3>
<p>å°† Skill å…ƒæ•°æ®åŒ…å«åœ¨ç³»ç»Ÿæç¤ºä¸­ï¼Œä»¥ä¾¿æ¨¡å‹çŸ¥é“æœ‰å“ªäº› Skills å¯ç”¨ã€‚å¯¹äº Claude æ¨¡å‹ï¼Œæ¨èæ ¼å¼ä½¿ç”¨ XMLï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">available_skills</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">skill</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>pdf-processing<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">description</span>&gt;</span>ä» PDF æ–‡ä»¶ä¸­æå–æ–‡æœ¬å’Œè¡¨æ ¼ï¼Œå¡«å†™è¡¨å•ï¼Œåˆå¹¶æ–‡æ¡£ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">description</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">location</span>&gt;</span>/path/to/skills/pdf-processing/SKILL.md<span class="hljs-tag">&lt;/<span class="hljs-name">location</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">skill</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">skill</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>data-analysis<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">description</span>&gt;</span>åˆ†ææ•°æ®é›†ï¼Œç”Ÿæˆå›¾è¡¨ï¼Œåˆ›å»ºæ‘˜è¦æŠ¥å‘Šã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">description</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">location</span>&gt;</span>/path/to/skills/data-analysis/SKILL.md<span class="hljs-tag">&lt;/<span class="hljs-name">location</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">skill</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">available_skills</span>&gt;</span>
</code></pre>
<p>å¯¹äºåŸºäºæ–‡ä»¶ç³»ç»Ÿçš„ Agentï¼ŒåŒ…å«å¸¦æœ‰ <code>SKILL.md</code> æ–‡ä»¶ç»å¯¹è·¯å¾„çš„ <code>location</code> å­—æ®µã€‚å¯¹äºåŸºäºå·¥å…·çš„ Agentï¼Œå¯ä»¥çœç•¥ locationã€‚</p>
<p>ä¿æŒå…ƒæ•°æ®ç®€æ´ã€‚æ¯ä¸ª Skill åº”è¯¥å‘ä¸Šä¸‹æ–‡æ·»åŠ å¤§çº¦ 50-100 ä¸ª tokensã€‚</p>
<hr/>
<h2 data-id="heading-26">å®é™…åº”ç”¨åœºæ™¯</h2>
<h3 data-id="heading-27">1. PDF å¤„ç† Skill</h3>
<p>è‡ªåŠ¨ä» PDF æ–‡ä»¶ä¸­æå–æ–‡æœ¬ã€è¡¨æ ¼ï¼Œå¡«å†™è¡¨å•ï¼Œåˆå¹¶å¤šä¸ªæ–‡æ¡£ã€‚é€‚ç”¨äºï¼š</p>
<ul>
<li>æ³•å¾‹æ–‡æ¡£å¤„ç†</li>
<li>è´¢åŠ¡æŠ¥è¡¨åˆ†æ</li>
<li>åˆåŒå®¡æŸ¥</li>
</ul>
<h3 data-id="heading-28">2. æ•°æ®åˆ†æ Skill</h3>
<p>åˆ†ææ•°æ®é›†ï¼Œç”Ÿæˆå¯è§†åŒ–å›¾è¡¨ï¼Œåˆ›å»ºæ‘˜è¦æŠ¥å‘Šã€‚é€‚ç”¨äºï¼š</p>
<ul>
<li>ä¸šåŠ¡æ•°æ®åˆ†æ</li>
<li>å¸‚åœºç ”ç©¶</li>
<li>è¿è¥æŠ¥å‘Š</li>
</ul>
<h3 data-id="heading-29">3. ä»£ç å®¡æŸ¥ Skill</h3>
<p>æä¾›ä»£ç å®¡æŸ¥æµç¨‹ã€æœ€ä½³å®è·µæ£€æŸ¥æ¸…å•ã€å®‰å…¨é—®é¢˜æ£€æµ‹ç­‰ä¸“ä¸šèƒ½åŠ›ã€‚é€‚ç”¨äºï¼š</p>
<ul>
<li>è½¯ä»¶å¼€å‘</li>
<li>DevOps æµç¨‹</li>
<li>å®‰å…¨å®¡è®¡</li>
</ul>
<h3 data-id="heading-30">4. æ¼”ç¤ºæ–‡ç¨¿åˆ›å»º Skill</h3>
<p>æ ¹æ®å†…å®¹è‡ªåŠ¨ç”Ÿæˆä¸“ä¸šçš„æ¼”ç¤ºæ–‡ç¨¿ï¼ŒåŒ…æ‹¬å¹»ç¯ç‰‡è®¾è®¡ã€å†…å®¹æ’ç‰ˆç­‰ã€‚é€‚ç”¨äºï¼š</p>
<ul>
<li>å•†åŠ¡æ±‡æŠ¥</li>
<li>æ•™è‚²åŸ¹è®­</li>
<li>äº§å“å±•ç¤º</li>
</ul>
<hr/>
<h2 data-id="heading-31">å®‰å…¨è€ƒè™‘</h2>
<p>è„šæœ¬æ‰§è¡Œå¼•å…¥äº†å®‰å…¨é£é™©ï¼Œå»ºè®®é‡‡å–ä»¥ä¸‹æªæ–½ï¼š</p>

























<table><thead><tr><th>æªæ–½</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>æ²™ç®±åŒ–</strong></td><td>åœ¨éš”ç¦»ç¯å¢ƒä¸­è¿è¡Œè„šæœ¬ï¼Œé™åˆ¶å…¶å¯¹ç³»ç»Ÿçš„è®¿é—®æƒé™</td></tr><tr><td><strong>ç™½åå•</strong></td><td>ä»…æ‰§è¡Œæ¥è‡ªå—ä¿¡ä»» Skills çš„è„šæœ¬ï¼Œé¿å…è¿è¡ŒæœªçŸ¥æ¥æºçš„ä»£ç </td></tr><tr><td><strong>ç¡®è®¤æœºåˆ¶</strong></td><td>åœ¨æ‰§è¡Œæ½œåœ¨å±é™©æ“ä½œå‰è¯¢é—®ç”¨æˆ·ç¡®è®¤ï¼Œå¢åŠ äººå·¥å®¡æ ¸ç¯èŠ‚</td></tr><tr><td><strong>æ—¥å¿—è®°å½•</strong></td><td>è®°å½•æ‰€æœ‰è„šæœ¬æ‰§è¡Œä»¥ä¾›å®¡è®¡ï¼Œä¾¿äºè¿½è¸ªå’Œæ’æŸ¥é—®é¢˜</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-32">éªŒè¯ Skills</h2>
<p>ä½¿ç”¨ <code>skills-ref</code> å‚è€ƒåº“éªŒè¯ä½ çš„ Skillsï¼š</p>
<pre><code class="hljs language-bash" lang="bash">skills-ref validate ./my-skill
</code></pre>
<p>è¿™å°†æ£€æŸ¥ä½ çš„ <code>SKILL.md</code> å‰ç½®å…ƒæ•°æ®æ˜¯å¦æœ‰æ•ˆå¹¶éµå¾ªæ‰€æœ‰å‘½åçº¦å®šã€‚</p>
<h3 data-id="heading-33">å‚è€ƒå®ç°åº“</h3>
<p><code>skills-ref</code> åº“æä¾›äº†ç”¨äºå¤„ç† Skills çš„ Python å·¥å…·å’Œ CLIï¼š</p>
<ul>
<li><strong>éªŒè¯ Skill ç›®å½•</strong>ï¼š<code>skills-ref validate &lt;path&gt;</code></li>
<li><strong>ç”Ÿæˆç³»ç»Ÿæç¤º XML</strong>ï¼š<code>skills-ref to-prompt &lt;path&gt;...</code></li>
</ul>
<p>ä½¿ç”¨åº“æºä»£ç ä½œä¸ºå‚è€ƒå®ç°ã€‚</p>
<hr/>
<h2 data-id="heading-34">å¼€å§‹ä½¿ç”¨ Agent Skills</h2>
<p>Agent Skills æ ¼å¼æœ€åˆç”± <strong>Anthropic</strong> å¼€å‘ï¼Œä½œä¸ºå¼€æ”¾æ ‡å‡†å‘å¸ƒï¼Œå¹¶å·²è¢«è¶Šæ¥è¶Šå¤šçš„ Agent äº§å“é‡‡ç”¨ã€‚è¯¥æ ‡å‡†å¼€æ”¾æ¥å—æ›´å¹¿æ³›ç”Ÿæ€ç³»ç»Ÿçš„è´¡çŒ®ã€‚</p>
<h3 data-id="heading-35">èµ„æºé“¾æ¥</h3>
<ul>
<li><strong>GitHub</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fagentskills%2Fagentskills" target="_blank" title="https://github.com/agentskills/agentskills" ref="nofollow noopener noreferrer">agentskills/agentskills</a></li>
<li><strong>æ–‡æ¡£</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fagentskills.io" target="_blank" title="https://agentskills.io" ref="nofollow noopener noreferrer">agentskills.io</a></li>
<li><strong>Stars</strong>: 7,571+</li>
</ul>
<hr/>
<h2 data-id="heading-36">æ€»ç»“</h2>
<p>Agent Skills æ˜¯ AI Agent ç”Ÿæ€ç³»ç»Ÿçš„å¼€æ”¾æ ‡å‡†ï¼Œè®©æ¯ä¸ªäººéƒ½èƒ½ä¸º AI èµ‹äºˆä¸“ä¸šèƒ½åŠ›ã€‚é€šè¿‡ç®€å•çš„æ–‡ä»¶å¤¹ç»“æ„å’Œ YAML + Markdown æ ¼å¼ï¼Œå¼€å‘è€…å’Œä¼ä¸šå¯ä»¥ï¼š</p>
<ol>
<li>åˆ›å»ºå¯é‡ç”¨çš„ä¸“ä¸šèƒ½åŠ›æ¨¡å—</li>
<li>åœ¨ä¸åŒ Agent äº§å“é—´å…±äº« Skills</li>
<li>å°†ç»„ç»‡çŸ¥è¯†ç‰ˆæœ¬åŒ–å’Œå¯ç§»æ¤åŒ–</li>
<li>è®© AI Agent æ›´å‡†ç¡®åœ°å®Œæˆä¸“ä¸šä»»åŠ¡</li>
</ol>
<p>æ— è®ºä½ æ˜¯ Skill ä½œè€…ã€Agent å¼€å‘è€…è¿˜æ˜¯ä¼ä¸šç”¨æˆ·ï¼ŒAgent Skills éƒ½ä¸ºä½ æä¾›äº†ä¸€ç§æ ‡å‡†åŒ–çš„æ–¹å¼æ¥æ‰©å±• AI çš„èƒ½åŠ›è¾¹ç•Œã€‚</p>
<hr/>
<p><em>æœ¬æ–‡å†…å®¹åŸºäº <a href="https://link.juejin.cn?target=https%3A%2F%2Fagentskills.io" target="_blank" title="https://agentskills.io" ref="nofollow noopener noreferrer">agentskills.io</a> å®˜æ–¹æ–‡æ¡£æ•´ç†</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»"äººå·¥é©±åŠ¨"åˆ°"æ™ºèƒ½ååŒ"ï¼šç”¨Agent Skillsé‡å¡‘è½¯ä»¶å¼€å‘å…¨æµç¨‹]]></title>    <link>https://juejin.cn/post/7599965904617209902</link>    <guid>https://juejin.cn/post/7599965904617209902</guid>    <pubDate>2026-01-28T03:04:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599965904617209902" data-draft-id="7599933828543578175" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»&quot;äººå·¥é©±åŠ¨&quot;åˆ°&quot;æ™ºèƒ½ååŒ&quot;ï¼šç”¨Agent Skillsé‡å¡‘è½¯ä»¶å¼€å‘å…¨æµç¨‹"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,å…¨æ ˆ,äº§å“ç»ç†"/> <meta itemprop="datePublished" content="2026-01-28T03:04:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="zh2526"/> <meta itemprop="url" content="https://juejin.cn/user/3989493469689965"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»"äººå·¥é©±åŠ¨"åˆ°"æ™ºèƒ½ååŒ"ï¼šç”¨Agent Skillsé‡å¡‘è½¯ä»¶å¼€å‘å…¨æµç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3989493469689965/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    zh2526
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T03:04:53.000Z" title="Wed Jan 28 2026 03:04:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    19
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»21åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€ï¼šè½¯ä»¶å¼€å‘çš„å›°å¢ƒä¸çªç ´</h2>
<p>åœ¨ä¸€ä¸ªå…¸å‹çš„è½¯ä»¶å¼€å‘å›¢é˜Ÿä¸­ï¼Œæˆ‘ä»¬ç»å¸¸çœ‹åˆ°è¿™æ ·çš„åœºæ™¯ï¼š</p>
<ul>
<li>äº§å“ç»ç†æå‡ºéœ€æ±‚åï¼Œç ”å‘å›¢é˜Ÿåå¤ç¡®è®¤ç»†èŠ‚ï¼Œè€—æ—¶3å¤©ä»æœ‰é—æ¼</li>
<li>æ¶æ„å¸ˆè®¾è®¡æ–¹æ¡ˆæ—¶ï¼Œæ–‡æ¡£ä¸ä»£ç å®ç°é€æ¸è„±èŠ‚ï¼Œæˆä¸º"å†å²æ–‡ç‰©"</li>
<li>æ–°å…¥èŒçš„å¼€å‘è€…ä¿®æ”¹ä¸€è¡Œä»£ç ï¼Œå´ä¸çŸ¥é“å½±å“äº†å“ªäº›æ¨¡å—ï¼Œå¯¼è‡´çº¿ä¸Šæ•…éšœ</li>
<li>æµ‹è¯•å·¥ç¨‹å¸ˆæ‰‹å·¥ç¼–å†™ç”¨ä¾‹ï¼Œè¦†ç›–ç‡ä¸è¶³50%ï¼Œå›å½’æµ‹è¯•é—æ¼å…³é”®åœºæ™¯</li>
<li>å‘å¸ƒå‰å¤œï¼Œå›¢é˜ŸåŠ ç­æ£€æŸ¥é…ç½®ï¼Œä»ç„¶å› ä¸ºé—æ¼ç¯å¢ƒå˜é‡å¯¼è‡´å›æ»š</li>
<li>çº¿ä¸Šå‘Šè­¦å“èµ·ï¼Œè¿ç»´å›¢é˜ŸèŠ±è´¹2å°æ—¶å®šä½é—®é¢˜ï¼Œå´å‘ç°æ˜¯ä¸€ä¸ªå·²çŸ¥çš„è€é—®é¢˜</li>
</ul>
<p><strong>è¿™äº›ç—›ç‚¹çš„æ ¹æºæ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p>ä¸æ˜¯å·¥å…·ä¸å¤Ÿå¤šï¼Œä¹Ÿä¸æ˜¯æµç¨‹ä¸å¤Ÿä¸¥æ ¼ï¼Œè€Œæ˜¯<strong>ä¸“å®¶ç»éªŒæ— æ³•æ ‡å‡†åŒ–ã€çŸ¥è¯†æ— æ³•æ²‰æ·€ã€è´¨é‡ä¿éšœæ€»æ˜¯æ»å</strong>ã€‚</p>
<p>åœ¨Agentæ—¶ä»£ï¼Œæˆ‘ä»¬æœ‰äº†å…¨æ–°çš„è§£å†³æ–¹æ¡ˆï¼š<strong>Agent Skillsâ€”â€”å°†ä¸“å®¶ç»éªŒå°è£…ä¸ºå¯æ‰§è¡Œçš„æ™ºèƒ½å•å…ƒï¼Œè®©æ¯ä¸ªå›¢é˜Ÿæˆå‘˜éƒ½èƒ½è·å¾—"ä¸“å®¶çº§"çš„èƒ½åŠ›æ”¯æŒã€‚</strong></p>
<p>æœ¬æ–‡å°†ä¸ºæ‚¨å±•ç¤ºï¼Œå¦‚ä½•ç”¨Agent Skillsé‡æ„è½¯ä»¶å¼€å‘å…¨æµç¨‹ï¼Œå®ç°ä»éœ€æ±‚åˆ°è¿ç»´çš„æ™ºèƒ½åŒ–ååŒã€‚</p>
<hr/>
<h2 data-id="heading-1">ä¸€ã€é‡æ–°ç†è§£è½¯ä»¶å¼€å‘ï¼šä»æµç¨‹åˆ°æ™ºèƒ½ååŒ</h2>
<h3 data-id="heading-2">1.1 ä¼ ç»Ÿè½¯ä»¶å¼€å‘çš„å…­å¤§æŒ‘æˆ˜</h3>
<p>è½¯ä»¶å¼€å‘éµå¾ªç»å…¸çš„SDLCï¼ˆSoftware Development Life Cycleï¼‰æµç¨‹ï¼Œä½†æ¯ä¸ªç¯èŠ‚éƒ½é¢ä¸´æ•ˆç‡ä¸è´¨é‡çš„åŒé‡æŒ‘æˆ˜ï¼š</p>








































<table><thead><tr><th>å¼€å‘é˜¶æ®µ</th><th>æ ¸å¿ƒæŒ‘æˆ˜</th><th>åæœ</th></tr></thead><tbody><tr><td><strong>éœ€æ±‚åˆ†æ</strong></td><td>éœ€æ±‚ç†è§£åå·®ï¼Œè¿”å·¥ç‡é«˜</td><td>å¼€å‘å®Œæˆåæ‰å‘ç°ç†è§£é”™è¯¯</td></tr><tr><td><strong>æ¶æ„è®¾è®¡</strong></td><td>è®¾è®¡æ–‡æ¡£ä¸ä»£ç å®ç°è„±èŠ‚</td><td>åç»­ç»´æŠ¤å›°éš¾ï¼ŒæŠ€æœ¯å€ºç´¯ç§¯</td></tr><tr><td><strong>ç¼–ç å¼€å‘</strong></td><td>ä»£ç è´¨é‡å‚å·®ä¸é½ï¼Œä¾èµ–ä¸ªäººç»éªŒ</td><td>æ½œåœ¨ç¼ºé™·å¤šï¼Œç»´æŠ¤æˆæœ¬é«˜</td></tr><tr><td><strong>è´¨é‡æµ‹è¯•</strong></td><td>æµ‹è¯•è¦†ç›–ä¸è¶³ï¼Œå›å½’æµ‹è¯•é—æ¼</td><td>çº¿ä¸Šé—®é¢˜é¢‘å‘</td></tr><tr><td><strong>éƒ¨ç½²å‘å¸ƒ</strong></td><td>å‘å¸ƒæµç¨‹ä¸è§„èŒƒï¼Œå›æ»šå›°éš¾</td><td>å‘å¸ƒé£é™©é«˜ï¼Œæ¢å¤æ—¶é—´é•¿</td></tr><tr><td><strong>è¿ç»´ç›‘æ§</strong></td><td>é—®é¢˜å®šä½æ…¢ï¼Œç¼ºä¹é¢„é˜²æœºåˆ¶</td><td>æ•…éšœå½±å“å¤§ï¼Œç”¨æˆ·ä½“éªŒå·®</td></tr></tbody></table>
<h3 data-id="heading-3">1.2 Agent Skillsï¼šæ™ºèƒ½åŒ–çš„è§£å†³æ–¹æ¡ˆ</h3>
<p><strong>Agent Skillsæ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p>Agent Skillsæ˜¯ä¸€ç§å°†ä¸“ä¸šçŸ¥è¯†ã€æ ‡å‡†æµç¨‹å’Œè‡ªåŠ¨åŒ–å·¥å…·å°è£…åœ¨ä¸€èµ·çš„å¯æ‰§è¡Œå•å…ƒã€‚å®ƒè®©AI Agentèƒ½å¤Ÿåƒäººç±»ä¸“å®¶ä¸€æ ·ï¼Œéµå¾ªæœ€ä½³å®è·µå®Œæˆå¤æ‚ä»»åŠ¡ã€‚</p>
<p><strong>ä¸€ä¸ªå®Œæ•´çš„SkillåŒ…å«ä¸‰ä¸ªæ ¸å¿ƒè¦ç´ ï¼š</strong></p>
<ol>
<li><strong>SOPæ–‡æ¡£ï¼ˆSKILL.mdï¼‰</strong>ï¼šæ­¥éª¤åŒ–ã€å¯æ‰§è¡Œçš„æ“ä½œæµç¨‹</li>
<li><strong>å·¥å…·è„šæœ¬</strong>ï¼šä¸ç°æœ‰å·¥å…·é“¾ï¼ˆGitã€CI/CDã€è´¨é‡å·¥å…·ï¼‰çš„é›†æˆ</li>
<li><strong>çŸ¥è¯†åº“</strong>ï¼šæ¶æ„æ–‡æ¡£ã€è§„èŒƒæ¸…å•ã€å†å²æ¡ˆä¾‹</li>
</ol>
<p><strong>Skillçš„å·¥ä½œæœºåˆ¶ï¼š</strong></p>
<pre><code class="hljs">ç”¨æˆ·è¯·æ±‚ â†’ Agentç†è§£æ„å›¾ â†’ æ¿€æ´»ç›¸å…³Skill â†’ æ‰§è¡ŒSOPæµç¨‹ â†’ è°ƒç”¨å·¥å…· â†’ ç”Ÿæˆäº¤ä»˜ç‰©
</code></pre>
<p>ä¸ä¼ ç»Ÿè‡ªåŠ¨åŒ–è„šæœ¬ä¸åŒï¼ŒAgent Skillså…·å¤‡<strong>ä¸Šä¸‹æ–‡æ„ŸçŸ¥èƒ½åŠ›</strong>å’Œ<strong>å†³ç­–èƒ½åŠ›</strong>ï¼Œèƒ½å¤Ÿæ ¹æ®å®é™…æƒ…å†µè°ƒæ•´æ‰§è¡Œç­–ç•¥ã€‚</p>
<hr/>
<h2 data-id="heading-4">äºŒã€å…­å¤§æ ¸å¿ƒSkillï¼šè¦†ç›–è½¯ä»¶å¼€å‘å…¨ç”Ÿå‘½å‘¨æœŸ</h2>
<p>æˆ‘ä»¬å°†è½¯ä»¶å¼€å‘æµç¨‹æ˜ å°„ä¸º6ä¸ªæ™ºèƒ½ååŒçš„Agent Skillsï¼Œæ¯ä¸ªSkillè§£å†³ä¸€ä¸ªå…³é”®é˜¶æ®µçš„æ ¸å¿ƒç—›ç‚¹ã€‚</p>
<h3 data-id="heading-5">Skill 1ï¼šæ™ºèƒ½éœ€æ±‚åˆ†æå¸ˆï¼ˆRequirement Analystï¼‰</h3>
<p><strong>è§£å†³çš„ç—›ç‚¹ï¼š</strong></p>
<ul>
<li>éœ€æ±‚æè¿°æ¨¡ç³Šï¼Œç†è§£ä¸ä¸€è‡´</li>
<li>é—æ¼è¾¹ç•Œåœºæ™¯å’Œå¼‚å¸¸æµç¨‹</li>
<li>éœ€æ±‚å˜æ›´å½±å“è¯„ä¼°å›°éš¾</li>
</ul>
<p><strong>æ ¸å¿ƒèƒ½åŠ›ï¼š</strong></p>
<ol>
<li>
<p><strong>éœ€æ±‚å®Œæ•´æ€§æ£€æŸ¥</strong></p>
<ul>
<li>è¯†åˆ«æ¨¡ç³Šè¯æ±‡ï¼ˆ"å°½å¿«"ã€"é€‚å½“"ã€"åˆç†"ï¼‰</li>
<li>æ£€æŸ¥æ˜¯å¦åŒ…å«ï¼šåŠŸèƒ½åœºæ™¯ã€å¼‚å¸¸å¤„ç†ã€æ€§èƒ½è¦æ±‚ã€å®‰å…¨è¦æ±‚</li>
<li>ç”Ÿæˆéœ€æ±‚æ¾„æ¸…é—®é¢˜æ¸…å•</li>
</ul>
</li>
<li>
<p><strong>éœ€æ±‚æ‹†è§£ä¸ç”¨ä¾‹ç”Ÿæˆ</strong></p>
<ul>
<li>è‡ªåŠ¨ç”Ÿæˆç”¨æˆ·æ•…äº‹ï¼ˆUser Storyï¼‰</li>
<li>ç”ŸæˆéªŒæ”¶æ ‡å‡†ï¼ˆAcceptance Criteriaï¼‰</li>
<li>è¯†åˆ«æ½œåœ¨æŠ€æœ¯ä¾èµ–</li>
</ul>
</li>
<li>
<p><strong>éœ€æ±‚å˜æ›´å½±å“åˆ†æ</strong></p>
<ul>
<li>è¿½æº¯éœ€æ±‚åˆ°å·²æœ‰åŠŸèƒ½æ¨¡å—</li>
<li>è¯„ä¼°å¯¹ç°æœ‰æ¶æ„çš„å½±å“</li>
<li>ç”Ÿæˆå˜æ›´å½±å“è¯„ä¼°æŠ¥å‘Š</li>
</ul>
</li>
</ol>
<p><strong>æŠ€æœ¯å®ç°ï¼š</strong></p>
<ul>
<li>NLPåˆ†æéœ€æ±‚æ–‡æœ¬</li>
<li>ä¸éœ€æ±‚ç®¡ç†ç³»ç»Ÿé›†æˆ</li>
<li>å†å²éœ€æ±‚çŸ¥è¯†åº“æ£€ç´¢</li>
</ul>
<p><strong>äº¤ä»˜äº§ç‰©ï¼š</strong></p>
<ul>
<li>éœ€æ±‚åˆ†ææŠ¥å‘Š</li>
<li>ç”¨æˆ·æ•…äº‹åˆ—è¡¨</li>
<li>éªŒæ”¶æ ‡å‡†æ¸…å•</li>
<li>æŠ€æœ¯ä¾èµ–è¯„ä¼°</li>
</ul>
<p><strong>æ¡ˆä¾‹ï¼š</strong>
å½“äº§å“ç»ç†æå‡º"ç”¨æˆ·ä¸‹å•åï¼Œå¦‚æœ30åˆ†é’Ÿå†…æ²¡æœ‰æ”¯ä»˜ï¼Œç³»ç»Ÿåº”è¯¥è‡ªåŠ¨å–æ¶ˆè®¢å•"æ—¶ï¼Œè¯¥Skillä¼šè‡ªåŠ¨è¯†åˆ«5ä¸ªéœ€è¦æ¾„æ¸…çš„é—®é¢˜ï¼š</p>
<ul>
<li>Q1: 30åˆ†é’Ÿçš„è®¡æ—¶èµ·ç‚¹æ˜¯å“ªä¸ªæ—¶é—´èŠ‚ç‚¹ï¼Ÿ</li>
<li>Q2: å–æ¶ˆè®¢å•åæ˜¯å¦éœ€è¦å‘é€é€šçŸ¥ï¼ˆç«™å†…ä¿¡/çŸ­ä¿¡/pushï¼‰?</li>
<li>Q3: åº“å­˜é”å®šå¦‚ä½•é‡Šæ”¾ï¼Ÿ</li>
<li>Q4: å¦‚æœç”¨æˆ·åœ¨ç¬¬29åˆ†é’Ÿæ”¯ä»˜æˆåŠŸï¼Œå¦‚ä½•å¤„ç†å¹¶å‘ï¼Ÿ</li>
<li>Q5: æ˜¯å¦éœ€è¦æ”¯æŒåå°æ‰‹åŠ¨å»¶é•¿æ”¯ä»˜æ—¶é—´ï¼Ÿ</li>
</ul>
<hr/>
<h3 data-id="heading-6">Skill 2ï¼šæ¶æ„è®¾è®¡é¡¾é—®ï¼ˆArchitecture Advisorï¼‰</h3>
<p><strong>è§£å†³çš„ç—›ç‚¹ï¼š</strong></p>
<ul>
<li>è®¾è®¡å†³ç­–ç¼ºä¹ä¾æ®ï¼Œéš¾ä»¥è¿½æº¯</li>
<li>æ¶æ„æ–‡æ¡£ä¸ä»£ç å®ç°ä¸åŒæ­¥</li>
<li>æŠ€æœ¯é€‰å‹ç¼ºä¹ç³»ç»Ÿæ€§è¯„ä¼°</li>
</ul>
<p><strong>æ ¸å¿ƒèƒ½åŠ›ï¼š</strong></p>
<ol>
<li>
<p><strong>æ¶æ„è®¾è®¡è¯„å®¡</strong></p>
<ul>
<li>æ£€æŸ¥æ˜¯å¦ç¬¦åˆSOLIDåŸåˆ™</li>
<li>è¯†åˆ«æ½œåœ¨çš„æ€§èƒ½ç“¶é¢ˆ</li>
<li>è¯„ä¼°å¯æ‰©å±•æ€§å’Œå¯ç»´æŠ¤æ€§</li>
</ul>
</li>
<li>
<p><strong>æŠ€æœ¯é€‰å‹è¾…åŠ©å†³ç­–</strong></p>
<ul>
<li>åŸºäºé¡¹ç›®ç‰¹å¾æ¨èæŠ€æœ¯æ ˆ</li>
<li>ç”ŸæˆæŠ€æœ¯å¯¹æ¯”çŸ©é˜µï¼ˆæ€§èƒ½ã€æˆç†Ÿåº¦ã€å­¦ä¹ æˆæœ¬ï¼‰</li>
<li>æä¾›ä¸šç•Œæœ€ä½³å®è·µå‚è€ƒ</li>
</ul>
</li>
<li>
<p><strong>æ¶æ„æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆ</strong></p>
<ul>
<li>ä»ä»£ç ç”Ÿæˆæ¶æ„å›¾ï¼ˆC4æ¨¡å‹ï¼‰</li>
<li>ç”ŸæˆAPIæ–‡æ¡£æ¡†æ¶</li>
<li>ç”Ÿæˆæ•°æ®åº“è®¾è®¡æ–‡æ¡£</li>
</ul>
</li>
<li>
<p><strong>æ¶æ„å†³ç­–è®°å½•ï¼ˆADRï¼‰</strong></p>
<ul>
<li>å¼•å¯¼è®°å½•è®¾è®¡å†³ç­–çš„ä¸Šä¸‹æ–‡ã€æ–¹æ¡ˆå¯¹æ¯”ã€æœ€ç»ˆå†³å®š</li>
<li>å»ºç«‹å¯è¿½æº¯çš„å†³ç­–å†å²</li>
</ul>
</li>
</ol>
<p><strong>æŠ€æœ¯å®ç°ï¼š</strong></p>
<ul>
<li>ä»£ç é™æ€åˆ†æå·¥å…·</li>
<li>PlantUML/Mermaidå›¾è¡¨ç”Ÿæˆ</li>
<li>æ¶æ„æ¨¡å¼åº“åŒ¹é…</li>
</ul>
<p><strong>äº¤ä»˜äº§ç‰©ï¼š</strong></p>
<ul>
<li>æ¶æ„è®¾è®¡æ–‡æ¡£</li>
<li>æŠ€æœ¯é€‰å‹æŠ¥å‘Š</li>
<li>ADRæ–‡æ¡£</li>
<li>ç³»ç»Ÿæ¶æ„å›¾</li>
</ul>
<p><strong>æ¡ˆä¾‹ç¤ºä¾‹ï¼š</strong></p>
<p>å½“éœ€è¦å®ç°"è®¢å•è¶…æ—¶è‡ªåŠ¨å–æ¶ˆ"åŠŸèƒ½æ—¶ï¼Œè¯¥Skillä¼šæä¾›æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”ï¼š</p>





























<table><thead><tr><th>æ–¹æ¡ˆ</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th><th>æ¨èåº¦</th></tr></thead><tbody><tr><td>æ•°æ®åº“å®šæ—¶è½®è¯¢</td><td>ç®€å•</td><td>æ€§èƒ½å·®ã€å»¶è¿Ÿé«˜</td><td>â­â­</td></tr><tr><td>å»¶æ—¶é˜Ÿåˆ—ï¼ˆRabbitMQï¼‰</td><td>ç²¾å‡†ã€è§£è€¦</td><td>éœ€è¦é¢å¤–ç»„ä»¶</td><td>â­â­â­</td></tr><tr><td>æ—¶é—´è½®ç®—æ³•ï¼ˆæœ¬åœ°ï¼‰</td><td>é«˜æ€§èƒ½</td><td>å•æœºé™åˆ¶</td><td>â­â­</td></tr></tbody></table>
<p>å¹¶è‡ªåŠ¨ç”ŸæˆADRæ–‡æ¡£è®°å½•å†³ç­–è¿‡ç¨‹ã€‚</p>
<hr/>
<h3 data-id="heading-7">Skill 3ï¼šä»£ç å¼€å‘è´¨é‡å«å£«ï¼ˆCode Quality Guardianï¼‰</h3>
<p><strong>è§£å†³çš„ç—›ç‚¹ï¼š</strong></p>
<ul>
<li>ä»£ç é£æ ¼ä¸ç»Ÿä¸€</li>
<li>å˜æ›´å½±å“èŒƒå›´ä¸æ¸…ï¼Œå®¹æ˜“å¼•å…¥Bug</li>
<li>ç¼ºå°‘Code Reviewæ ‡å‡†</li>
</ul>
<p><strong>æ ¸å¿ƒèƒ½åŠ›ï¼š</strong></p>
<ol>
<li>
<p><strong>ä»£ç è´¨é‡å®æ—¶æ£€æŸ¥</strong></p>
<ul>
<li>ä»£ç è§„èŒƒæ£€æŸ¥ï¼ˆå‘½åã€æ³¨é‡Šã€å¤æ‚åº¦ï¼‰</li>
<li>é‡å¤ä»£ç æ£€æµ‹</li>
<li>æ½œåœ¨Bugæ¨¡å¼è¯†åˆ«</li>
</ul>
</li>
<li>
<p><strong>å˜æ›´å½±å“åˆ†æ</strong></p>
<ul>
<li>åˆ†æä¿®æ”¹çš„ä»£ç å½±å“èŒƒå›´</li>
<li>ç”Ÿæˆä¾èµ–å…³ç³»å›¾è°±</li>
<li>è¯†åˆ«éœ€è¦å›å½’æµ‹è¯•çš„æ¨¡å—</li>
</ul>
</li>
<li>
<p><strong>æ™ºèƒ½Code ReviewåŠ©æ‰‹</strong></p>
<ul>
<li>è‡ªåŠ¨ç”ŸæˆReview Checklist</li>
<li>è¯†åˆ«å¸¸è§é—®é¢˜ï¼ˆç©ºæŒ‡é’ˆã€èµ„æºæ³„æ¼ï¼‰</li>
<li>æä¾›ä¼˜åŒ–å»ºè®®</li>
</ul>
</li>
<li>
<p><strong>å®‰å…¨åˆè§„æ£€æŸ¥</strong></p>
<ul>
<li>SQLæ³¨å…¥ã€XSSç­‰æ¼æ´æ‰«æ</li>
<li>æ•æ„Ÿä¿¡æ¯æ£€æµ‹ï¼ˆå¯†é’¥ã€å¯†ç ï¼‰</li>
<li>ä¾èµ–åº“æ¼æ´æ‰«æï¼ˆSCAï¼‰</li>
</ul>
</li>
</ol>
<p><strong>æŠ€æœ¯å®ç°ï¼š</strong></p>
<ul>
<li>ASTè¯­æ³•æ ‘åˆ†æ</li>
<li>SonarQube/ESLinté›†æˆ</li>
<li>Git diffåˆ†æ</li>
<li>SAST/SCAå·¥å…·é›†æˆ</li>
</ul>
<p><strong>äº¤ä»˜äº§ç‰©ï¼š</strong></p>
<ul>
<li>ä»£ç è´¨é‡æŠ¥å‘Š</li>
<li>å˜æ›´å½±å“åˆ†ææŠ¥å‘Š</li>
<li>å®‰å…¨æ¼æ´æŠ¥å‘Š</li>
<li>Code Reviewå»ºè®®æ¸…å•</li>
</ul>
<p><strong>å®é™…æ•ˆæœï¼š</strong></p>
<ul>
<li>ä»£ç ç¼ºé™·ä¸‹é™60%</li>
<li>Code Reviewæ•ˆç‡æå‡3å€</li>
<li>å®‰å…¨æ¼æ´å‰ç½®å‘ç°ç‡æå‡80%</li>
</ul>
<hr/>
<h3 data-id="heading-8">Skill 4ï¼šæ™ºèƒ½æµ‹è¯•å·¥ç¨‹å¸ˆï¼ˆSmart Test Engineerï¼‰</h3>
<p><strong>è§£å†³çš„ç—›ç‚¹ï¼š</strong></p>
<ul>
<li>æµ‹è¯•ç”¨ä¾‹è¦†ç›–ä¸è¶³</li>
<li>å›å½’æµ‹è¯•é—æ¼</li>
<li>æµ‹è¯•æ•°æ®å‡†å¤‡å›°éš¾</li>
</ul>
<p><strong>æ ¸å¿ƒèƒ½åŠ›ï¼š</strong></p>
<ol>
<li>
<p><strong>æµ‹è¯•ç”¨ä¾‹æ™ºèƒ½ç”Ÿæˆ</strong></p>
<ul>
<li>åŸºäºä»£ç è·¯å¾„ç”Ÿæˆå•å…ƒæµ‹è¯•</li>
<li>åŸºäºAPIæ–‡æ¡£ç”Ÿæˆæ¥å£æµ‹è¯•</li>
<li>åŸºäºç”¨æˆ·æ•…äº‹ç”ŸæˆE2Eæµ‹è¯•</li>
</ul>
</li>
<li>
<p><strong>æµ‹è¯•èŒƒå›´åˆ†æ</strong></p>
<ul>
<li>æ ¹æ®ä»£ç å˜æ›´ç¡®å®šæµ‹è¯•èŒƒå›´</li>
<li>è¯†åˆ«éœ€è¦å›å½’æµ‹è¯•çš„æ¨¡å—</li>
<li>ç”Ÿæˆæµ‹è¯•ä¼˜å…ˆçº§æ’åº</li>
</ul>
</li>
<li>
<p><strong>æµ‹è¯•æ•°æ®ç®¡ç†</strong></p>
<ul>
<li>ç”Ÿæˆç¬¦åˆä¸šåŠ¡è§„åˆ™çš„æµ‹è¯•æ•°æ®</li>
<li>è„±æ•ç”Ÿäº§æ•°æ®ç”¨äºæµ‹è¯•</li>
<li>Mockæ•°æ®ç”Ÿæˆç­–ç•¥</li>
</ul>
</li>
<li>
<p><strong>æµ‹è¯•æŠ¥å‘Šä¸åˆ†æ</strong></p>
<ul>
<li>ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š</li>
<li>è¯†åˆ«æµ‹è¯•è–„å¼±ç¯èŠ‚</li>
<li>å¤±è´¥ç”¨ä¾‹æ ¹å› åˆ†æ</li>
</ul>
</li>
</ol>
<p><strong>æŠ€æœ¯å®ç°ï¼š</strong></p>
<ul>
<li>ä»£ç è¦†ç›–ç‡å·¥å…·ï¼ˆJaCoCo/Istanbulï¼‰</li>
<li>æµ‹è¯•æ¡†æ¶é›†æˆï¼ˆJUnit/Pytest/Jestï¼‰</li>
<li>æ•°æ®ç”Ÿæˆåº“ï¼ˆFakerï¼‰</li>
<li>å˜æ›´å½±å“å›¾è°±</li>
</ul>
<p><strong>äº¤ä»˜äº§ç‰©ï¼š</strong></p>
<ul>
<li>è‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹</li>
<li>æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š</li>
<li>æµ‹è¯•æ•°æ®é›†</li>
<li>æµ‹è¯•æ‰§è¡ŒæŠ¥å‘Š</li>
</ul>
<p><strong>é‡åŒ–ä»·å€¼ï¼š</strong></p>
<ul>
<li>æµ‹è¯•ç”¨ä¾‹ç¼–å†™æ—¶é—´ç¼©çŸ­70%</li>
<li>æµ‹è¯•è¦†ç›–ç‡ä»50%æå‡åˆ°85%</li>
<li>å›å½’æµ‹è¯•é—æ¼ç‡é™ä½90%</li>
</ul>
<hr/>
<h3 data-id="heading-9">Skill 5ï¼šæ™ºèƒ½å‘å¸ƒç¼–æ’å¸ˆï¼ˆRelease Orchestratorï¼‰</h3>
<p><strong>è§£å†³çš„ç—›ç‚¹ï¼š</strong></p>
<ul>
<li>å‘å¸ƒæµç¨‹ä¸è§„èŒƒï¼Œæ­¥éª¤é—æ¼</li>
<li>ç¯å¢ƒé…ç½®ä¸ä¸€è‡´</li>
<li>å›æ»šå›°éš¾ï¼Œæ¢å¤æ—¶é—´é•¿</li>
</ul>
<p><strong>æ ¸å¿ƒèƒ½åŠ›ï¼š</strong></p>
<ol>
<li>
<p><strong>å‘å¸ƒå‰æ£€æŸ¥æ¸…å•</strong></p>
<ul>
<li>æ•°æ®åº“è¿ç§»è„šæœ¬æ£€æŸ¥</li>
<li>é…ç½®æ–‡ä»¶å˜æ›´æ£€æŸ¥</li>
<li>ä¾èµ–ç‰ˆæœ¬å…¼å®¹æ€§æ£€æŸ¥</li>
<li>ç¯å¢ƒå˜é‡å®Œæ•´æ€§æ£€æŸ¥</li>
</ul>
</li>
<li>
<p><strong>å‘å¸ƒç­–ç•¥ç¼–æ’</strong></p>
<ul>
<li>æ”¯æŒè“ç»¿éƒ¨ç½²ã€é‡‘ä¸é›€å‘å¸ƒ</li>
<li>è‡ªåŠ¨ç”Ÿæˆå‘å¸ƒæ­¥éª¤</li>
<li>å‘å¸ƒè¿›åº¦ç›‘æ§</li>
</ul>
</li>
<li>
<p><strong>è‡ªåŠ¨åŒ–æ–‡æ¡£ç”Ÿæˆ</strong></p>
<ul>
<li>ç”ŸæˆRelease Notes</li>
<li>ç”ŸæˆCHANGELOG</li>
<li>ç”Ÿæˆéƒ¨ç½²æ‰‹å†Œ</li>
</ul>
</li>
<li>
<p><strong>å›æ»šé¢„æ¡ˆ</strong></p>
<ul>
<li>è‡ªåŠ¨ç”Ÿæˆå›æ»šè„šæœ¬</li>
<li>å¤‡ä»½å…³é”®é…ç½®å’Œæ•°æ®</li>
<li>å›æ»šæ¼”ç»ƒéªŒè¯</li>
</ul>
</li>
</ol>
<p><strong>æŠ€æœ¯å®ç°ï¼š</strong></p>
<ul>
<li>CI/CDå¹³å°é›†æˆï¼ˆJenkins/GitLab CIï¼‰</li>
<li>å®¹å™¨ç¼–æ’ï¼ˆKubernetesï¼‰</li>
<li>Gitæäº¤å†å²åˆ†æ</li>
<li>é…ç½®ç®¡ç†å·¥å…·ï¼ˆAnsibleï¼‰</li>
</ul>
<p><strong>äº¤ä»˜äº§ç‰©ï¼š</strong></p>
<ul>
<li>å‘å¸ƒæ£€æŸ¥æ¸…å•</li>
<li>Release Notes</li>
<li>éƒ¨ç½²è„šæœ¬</li>
<li>å›æ»šæ–¹æ¡ˆ</li>
</ul>
<p><strong>é£é™©é™ä½ï¼š</strong></p>
<ul>
<li>å‘å¸ƒäº‹æ•…ç‡ä¸‹é™80%</li>
<li>å¹³å‡å‘å¸ƒæ—¶é—´ä»4å°æ—¶ç¼©çŸ­åˆ°30åˆ†é’Ÿ</li>
<li>å›æ»šæˆåŠŸç‡æå‡åˆ°99%</li>
</ul>
<hr/>
<h3 data-id="heading-10">Skill 6ï¼šè¿ç»´æ•…éšœè¯Šæ–­ä¸“å®¶ï¼ˆDevOps Troubleshooterï¼‰</h3>
<p><strong>è§£å†³çš„ç—›ç‚¹ï¼š</strong></p>
<ul>
<li>é—®é¢˜å®šä½æ…¢ï¼Œä¾èµ–ç»éªŒ</li>
<li>å‘Šè­¦å™ªéŸ³å¤šï¼Œéš¾ä»¥è¯†åˆ«çœŸå®é—®é¢˜</li>
<li>ç¼ºä¹é¢„é˜²æ€§è¿ç»´æœºåˆ¶</li>
</ul>
<p><strong>æ ¸å¿ƒèƒ½åŠ›ï¼š</strong></p>
<ol>
<li>
<p><strong>æ™ºèƒ½æ—¥å¿—åˆ†æ</strong></p>
<ul>
<li>å¼‚å¸¸æ—¥å¿—æ¨¡å¼è¯†åˆ«</li>
<li>é”™è¯¯æ ¹å› è‡ªåŠ¨å…³è”</li>
<li>ç”Ÿæˆé—®é¢˜å®šä½è·¯å¾„</li>
</ul>
</li>
<li>
<p><strong>æ€§èƒ½è¯Šæ–­</strong></p>
<ul>
<li>è¯†åˆ«æ€§èƒ½ç“¶é¢ˆï¼ˆCPU/å†…å­˜/IOï¼‰</li>
<li>SQLæ…¢æŸ¥è¯¢åˆ†æ</li>
<li>APIå“åº”æ—¶é—´åˆ†æ</li>
</ul>
</li>
<li>
<p><strong>å‘Šè­¦æ™ºèƒ½é™å™ª</strong></p>
<ul>
<li>å…³è”ç›¸å…³å‘Šè­¦ï¼Œåˆå¹¶é‡å¤</li>
<li>å‘Šè­¦ä¼˜å…ˆçº§è¯„ä¼°</li>
<li>ç”Ÿæˆå¤„ç†å»ºè®®</li>
</ul>
</li>
<li>
<p><strong>é¢„é˜²æ€§è¿ç»´</strong></p>
<ul>
<li>èµ„æºè¶‹åŠ¿é¢„æµ‹</li>
<li>æ½œåœ¨é£é™©è¯†åˆ«ï¼ˆç£ç›˜å°†æ»¡ã€è¯ä¹¦è¿‡æœŸï¼‰</li>
<li>ç”Ÿæˆè¿ç»´ä¼˜åŒ–å»ºè®®</li>
</ul>
</li>
<li>
<p><strong>æ•…éšœçŸ¥è¯†åº“</strong></p>
<ul>
<li>è®°å½•å†å²æ•…éšœåŠè§£å†³æ–¹æ¡ˆ</li>
<li>è‡ªåŠ¨åŒ¹é…ç›¸ä¼¼é—®é¢˜</li>
<li>ç”ŸæˆRunbook</li>
</ul>
</li>
</ol>
<p><strong>æŠ€æœ¯å®ç°ï¼š</strong></p>
<ul>
<li>æ—¥å¿—åˆ†æå·¥å…·ï¼ˆELK/Splunkï¼‰</li>
<li>ç›‘æ§ç³»ç»Ÿé›†æˆï¼ˆPrometheus/Grafanaï¼‰</li>
<li>APMå·¥å…·ï¼ˆSkywalking/Jaegerï¼‰</li>
<li>çŸ¥è¯†å›¾è°±æ„å»º</li>
</ul>
<p><strong>äº¤ä»˜äº§ç‰©ï¼š</strong></p>
<ul>
<li>æ•…éšœè¯Šæ–­æŠ¥å‘Š</li>
<li>æ€§èƒ½ä¼˜åŒ–å»ºè®®</li>
<li>å‘Šè­¦å¤„ç†æ‰‹å†Œ</li>
<li>è¿ç»´çŸ¥è¯†åº“æ›´æ–°</li>
</ul>
<p><strong>æ•ˆç‡æå‡ï¼š</strong></p>
<ul>
<li>æ•…éšœå¹³å‡å®šä½æ—¶é—´ä»2å°æ—¶ç¼©çŸ­åˆ°15åˆ†é’Ÿ</li>
<li>å‘Šè­¦å™ªéŸ³å‡å°‘70%</li>
<li>é¢„é˜²æ€§å‘ç°é—®é¢˜ï¼Œé¿å…80%çš„æ½œåœ¨æ•…éšœ</li>
</ul>
<hr/>
<h2 data-id="heading-11">ä¸‰ã€å®Œæ•´æ¡ˆä¾‹ï¼šä»éœ€æ±‚åˆ°ä¸Šçº¿çš„æ™ºèƒ½ååŒ</h2>
<p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªçœŸå®æ¡ˆä¾‹ï¼Œçœ‹çœ‹6ä¸ªSkillså¦‚ä½•ååŒå·¥ä½œã€‚</p>
<h3 data-id="heading-12">æ¡ˆä¾‹èƒŒæ™¯</h3>
<p>æŸç”µå•†å¹³å°éœ€è¦å®ç°"<strong>ç”¨æˆ·ä¸‹å•å30åˆ†é’Ÿæœªæ”¯ä»˜è‡ªåŠ¨å–æ¶ˆè®¢å•</strong>"åŠŸèƒ½ã€‚</p>
<hr/>
<h3 data-id="heading-13">é˜¶æ®µä¸€ï¼šéœ€æ±‚åˆ†æï¼ˆSkill 1ï¼šæ™ºèƒ½éœ€æ±‚åˆ†æå¸ˆï¼‰</h3>
<p><strong>è¾“å…¥ï¼š</strong> äº§å“ç»ç†æä¾›çš„éœ€æ±‚æè¿°</p>
<pre><code class="hljs">ç”¨æˆ·ä¸‹å•åï¼Œå¦‚æœ30åˆ†é’Ÿå†…æ²¡æœ‰æ”¯ä»˜ï¼Œç³»ç»Ÿåº”è¯¥è‡ªåŠ¨å–æ¶ˆè®¢å•ã€‚
</code></pre>
<p><strong>Skill 1æ‰§è¡Œæµç¨‹ï¼š</strong></p>
<ol>
<li>
<p><strong>æ¨¡ç³Šè¯æ±‡è¯†åˆ«</strong></p>
<ul>
<li>âš ï¸ "30åˆ†é’Ÿ"èµ·ç‚¹æ˜¯ä¸‹å•æ—¶é—´è¿˜æ˜¯è®¢å•ç¡®è®¤æ—¶é—´ï¼Ÿ</li>
<li>âš ï¸ "è‡ªåŠ¨å–æ¶ˆ"æ˜¯å¦éœ€è¦é€šçŸ¥ç”¨æˆ·ï¼Ÿ</li>
<li>âš ï¸ åº“å­˜å¦‚ä½•å¤„ç†ï¼Ÿ</li>
</ul>
</li>
<li>
<p><strong>è‡ªåŠ¨ç”Ÿæˆæ¾„æ¸…é—®é¢˜</strong></p>
<ul>
<li>Q1: 30åˆ†é’Ÿçš„è®¡æ—¶èµ·ç‚¹æ˜¯å“ªä¸ªæ—¶é—´èŠ‚ç‚¹ï¼Ÿ</li>
<li>Q2: å–æ¶ˆè®¢å•åæ˜¯å¦éœ€è¦å‘é€é€šçŸ¥ï¼ˆç«™å†…ä¿¡/çŸ­ä¿¡/pushï¼‰?</li>
<li>Q3: åº“å­˜é”å®šå¦‚ä½•é‡Šæ”¾ï¼Ÿ</li>
<li>Q4: å¦‚æœç”¨æˆ·åœ¨ç¬¬29åˆ†é’Ÿæ”¯ä»˜æˆåŠŸï¼Œå¦‚ä½•å¤„ç†å¹¶å‘ï¼Ÿ</li>
<li>Q5: æ˜¯å¦éœ€è¦æ”¯æŒåå°æ‰‹åŠ¨å»¶é•¿æ”¯ä»˜æ—¶é—´ï¼Ÿ</li>
</ul>
</li>
<li>
<p><strong>ç”Ÿæˆç”¨æˆ·æ•…äº‹</strong></p>
<pre><code class="hljs language-diff" lang="diff">US-001: ä½œä¸ºä¹°å®¶ï¼Œæˆ‘å¸Œæœ›åœ¨ä¸‹å•åæ‹¥æœ‰30åˆ†é’Ÿçš„æ”¯ä»˜æ—¶é—´
éªŒæ”¶æ ‡å‡†ï¼š
<span class="hljs-deletion">- è®¢å•åˆ›å»ºæ—¶è®°å½•è¶…æ—¶æ—¶é—´ï¼ˆåˆ›å»ºæ—¶é—´ + 30åˆ†é’Ÿï¼‰</span>
<span class="hljs-deletion">- è®¢å•é¡µé¢æ˜¾ç¤ºå€’è®¡æ—¶</span>

US-002: ä½œä¸ºç³»ç»Ÿï¼Œæˆ‘éœ€è¦åœ¨è®¢å•è¶…æ—¶åè‡ªåŠ¨å–æ¶ˆ
éªŒæ”¶æ ‡å‡†ï¼š
<span class="hljs-deletion">- è¶…æ—¶åè®¢å•çŠ¶æ€å˜æ›´ä¸º"å·²å–æ¶ˆ"</span>
<span class="hljs-deletion">- åº“å­˜é‡Šæ”¾å›åº“å­˜æ± </span>
<span class="hljs-deletion">- å‘é€å–æ¶ˆé€šçŸ¥ç»™ç”¨æˆ·</span>

US-003: ä½œä¸ºç³»ç»Ÿï¼Œæˆ‘éœ€è¦å¤„ç†æ”¯ä»˜å¹¶å‘åœºæ™¯
éªŒæ”¶æ ‡å‡†ï¼š
<span class="hljs-deletion">- ä½¿ç”¨åˆ†å¸ƒå¼é”é˜²æ­¢é‡å¤å–æ¶ˆ</span>
<span class="hljs-deletion">- å¦‚æœæ”¯ä»˜æˆåŠŸï¼Œå–æ¶ˆä»»åŠ¡åº”å¤±è´¥</span>
</code></pre>
</li>
</ol>
<p><strong>äº¤ä»˜äº§ç‰©ï¼š</strong></p>
<ul>
<li>æ¾„æ¸…é—®é¢˜æ¸…å•ï¼ˆ5ä¸ªé—®é¢˜ï¼‰</li>
<li>ç”¨æˆ·æ•…äº‹ï¼ˆ3ä¸ªï¼‰</li>
<li>æŠ€æœ¯ä¾èµ–è¯†åˆ«ï¼šéœ€è¦å®šæ—¶ä»»åŠ¡ã€åˆ†å¸ƒå¼é”ã€æ¶ˆæ¯é€šçŸ¥æœåŠ¡</li>
</ul>
<hr/>
<h3 data-id="heading-14">é˜¶æ®µäºŒï¼šæ¶æ„è®¾è®¡ï¼ˆSkill 2ï¼šæ¶æ„è®¾è®¡é¡¾é—®ï¼‰</h3>
<p><strong>Skill 2æ‰§è¡Œæµç¨‹ï¼š</strong></p>
<ol>
<li>
<p><strong>æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”</strong></p>





























<table><thead><tr><th>æ–¹æ¡ˆ</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th><th>æ¨èåº¦</th></tr></thead><tbody><tr><td>æ•°æ®åº“å®šæ—¶è½®è¯¢</td><td>ç®€å•</td><td>æ€§èƒ½å·®ã€å»¶è¿Ÿé«˜</td><td>â­â­</td></tr><tr><td>å»¶æ—¶é˜Ÿåˆ—ï¼ˆRabbitMQ TTL + Dead Letterï¼‰</td><td>ç²¾å‡†ã€è§£è€¦</td><td>éœ€è¦é¢å¤–ç»„ä»¶</td><td>â­â­â­</td></tr><tr><td>æ—¶é—´è½®ç®—æ³•ï¼ˆæœ¬åœ°ï¼‰</td><td>é«˜æ€§èƒ½</td><td>å•æœºé™åˆ¶</td><td>â­â­</td></tr></tbody></table>
</li>
<li>
<p><strong>æ¨èæ–¹æ¡ˆ</strong>ï¼šå»¶æ—¶é˜Ÿåˆ—ï¼ˆRabbitMQ TTL + Dead Letterï¼‰</p>
</li>
<li>
<p><strong>ç”Ÿæˆæ¶æ„è®¾è®¡æ–‡æ¡£</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">ç»„ä»¶äº¤äº’æµç¨‹ï¼š
è®¢å•æœåŠ¡ â†’ åˆ›å»ºè®¢å• â†’ å‘é€å»¶æ—¶æ¶ˆæ¯(30åˆ†é’Ÿ) â†’ RabbitMQ
<span class="hljs-code">                                                 â†“
å–æ¶ˆä»»åŠ¡æ¶ˆè´¹è€… â† DLXé˜Ÿåˆ— â† TTLè¿‡æœŸ
</span></code></pre>
</li>
<li>
<p><strong>ç”ŸæˆADRï¼ˆæ¶æ„å†³ç­–è®°å½•ï¼‰</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># ADR-012: è®¢å•è¶…æ—¶å–æ¶ˆæ–¹æ¡ˆé€‰æ‹©</span>

<span class="hljs-section">## èƒŒæ™¯</span>
éœ€è¦å®ç°è®¢å•30åˆ†é’Ÿè‡ªåŠ¨å–æ¶ˆåŠŸèƒ½

<span class="hljs-section">## å†³ç­–</span>
é‡‡ç”¨RabbitMQå»¶æ—¶é˜Ÿåˆ—æ–¹æ¡ˆ

<span class="hljs-section">## ç†ç”±</span>
<span class="hljs-bullet">-</span> å·²æœ‰RabbitMQåŸºç¡€è®¾æ–½
<span class="hljs-bullet">-</span> æ”¯æŒåˆ†å¸ƒå¼éƒ¨ç½²
<span class="hljs-bullet">-</span> æ¶ˆæ¯å¯é æ€§æœ‰ä¿éšœ

<span class="hljs-section">## é£é™©</span>
<span class="hljs-bullet">-</span> RabbitMQæ•…éšœä¼šå¯¼è‡´å–æ¶ˆä»»åŠ¡ä¸¢å¤±ï¼Œéœ€è¦è¡¥å¿æœºåˆ¶
</code></pre>
</li>
</ol>
<p><strong>äº¤ä»˜äº§ç‰©ï¼š</strong></p>
<ul>
<li>æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”è¡¨</li>
<li>æ¶æ„è®¾è®¡æ–‡æ¡£</li>
<li>æ—¶åºå›¾/ç»„ä»¶å›¾</li>
<li>ADRæ–‡æ¡£</li>
</ul>
<hr/>
<h3 data-id="heading-15">é˜¶æ®µä¸‰ï¼šç¼–ç å¼€å‘ï¼ˆSkill 3ï¼šä»£ç å¼€å‘è´¨é‡å«å£«ï¼‰</h3>
<p><strong>å¼€å‘å®Œæˆåï¼ŒSkill 3æ‰§è¡Œæ£€æŸ¥ï¼š</strong></p>
<ol>
<li>
<p><strong>ä»£ç è´¨é‡æ£€æŸ¥</strong></p>
<ul>
<li>âœ“ ä»£ç è§„èŒƒç¬¦åˆå›¢é˜Ÿæ ‡å‡†</li>
<li>âš ï¸ <code>OrderCancelTask.java</code> åœˆå¤æ‚åº¦ä¸º12ï¼Œå»ºè®®æ‹†åˆ†æ–¹æ³•</li>
<li>âœ“ æ— é‡å¤ä»£ç </li>
</ul>
</li>
<li>
<p><strong>å˜æ›´å½±å“åˆ†æ</strong></p>
<pre><code class="hljs language-diff" lang="diff">ä¿®æ”¹çš„æ–‡ä»¶ï¼š
<span class="hljs-deletion">- OrderService.javaï¼ˆæ–°å¢å–æ¶ˆé€»è¾‘ï¼‰</span>
<span class="hljs-deletion">- InventoryService.javaï¼ˆåº“å­˜é‡Šæ”¾ï¼‰</span>
<span class="hljs-deletion">- NotificationService.javaï¼ˆæ¶ˆæ¯é€šçŸ¥ï¼‰</span>

å½±å“èŒƒå›´ï¼š
<span class="hljs-deletion">- è®¢å•æ¨¡å—ï¼ˆç›´æ¥ä¿®æ”¹ï¼‰</span>
<span class="hljs-deletion">- åº“å­˜æ¨¡å—ï¼ˆè°ƒç”¨æ¥å£å˜æ›´ï¼‰</span>
<span class="hljs-deletion">- æ¶ˆæ¯æ¨¡å—ï¼ˆæ–°å¢é€šçŸ¥æ¨¡æ¿ï¼‰</span>

é£é™©è¯„ä¼°ï¼šä¸­ç­‰
<span class="hljs-deletion">- éœ€è¦å›å½’æµ‹è¯•ï¼šè®¢å•æ”¯ä»˜æµç¨‹ã€åº“å­˜æ‰£å‡æµç¨‹</span>
</code></pre>
</li>
<li>
<p><strong>å®‰å…¨åˆè§„æ£€æŸ¥</strong></p>
<ul>
<li>âš ï¸ å–æ¶ˆåŸå› éœ€è®°å½•å®¡è®¡æ—¥å¿—</li>
<li>âœ“ æ— SQLæ³¨å…¥é£é™©</li>
<li>âœ“ ç”¨æˆ·é€šçŸ¥å†…å®¹ä¸åŒ…å«æ•æ„Ÿä¿¡æ¯</li>
</ul>
</li>
</ol>
<p><strong>äº¤ä»˜äº§ç‰©ï¼š</strong></p>
<ul>
<li>ä»£ç è´¨é‡æŠ¥å‘Š</li>
<li>å˜æ›´å½±å“åˆ†ææŠ¥å‘Š</li>
<li>éœ€è¦å›å½’æµ‹è¯•çš„æ¨¡å—æ¸…å•</li>
</ul>
<hr/>
<h3 data-id="heading-16">é˜¶æ®µå››ï¼šè´¨é‡æµ‹è¯•ï¼ˆSkill 4ï¼šæ™ºèƒ½æµ‹è¯•å·¥ç¨‹å¸ˆï¼‰</h3>
<p><strong>Skill 4æ‰§è¡Œæµç¨‹ï¼š</strong></p>
<ol>
<li>
<p><strong>è‡ªåŠ¨ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å•å…ƒæµ‹è¯•ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰</span>
<span class="hljs-meta">@Test</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testOrderCancelAfterTimeout</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// Given: è®¢å•åˆ›å»ºè¶…è¿‡30åˆ†é’Ÿ</span>
    <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> createOrder(<span class="hljs-number">30</span> * <span class="hljs-number">60</span> + <span class="hljs-number">1</span>);
    
    <span class="hljs-comment">// When: æ‰§è¡Œå–æ¶ˆä»»åŠ¡</span>
    orderCancelTask.execute(order.getId());
    
    <span class="hljs-comment">// Then: è®¢å•çŠ¶æ€ä¸ºå·²å–æ¶ˆ</span>
    assertEquals(OrderStatus.CANCELLED, order.getStatus());
}

<span class="hljs-meta">@Test</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testConcurrentPaymentAndCancel</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// æµ‹è¯•æ”¯ä»˜å’Œå–æ¶ˆçš„å¹¶å‘åœºæ™¯</span>
}
</code></pre>
</li>
<li>
<p><strong>æµ‹è¯•èŒƒå›´åˆ†æ</strong></p>
<ul>
<li>å•å…ƒæµ‹è¯•ï¼š15ä¸ªï¼ˆè®¢å•æœåŠ¡6ä¸ªã€åº“å­˜æœåŠ¡5ä¸ªã€æ¶ˆæ¯æœåŠ¡4ä¸ªï¼‰</li>
<li>é›†æˆæµ‹è¯•ï¼š8ä¸ªï¼ˆå®Œæ•´æµç¨‹æµ‹è¯•ï¼‰</li>
<li>å›å½’æµ‹è¯•ï¼šè®¢å•æ”¯ä»˜æµç¨‹ï¼ˆå·²æœ‰23ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰</li>
</ul>
</li>
<li>
<p><strong>ç”Ÿæˆæµ‹è¯•æ•°æ®</strong></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"orderId"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ORD20260128001"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"createTime"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2026-01-28 10:00:00"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"status"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"PENDING_PAYMENT"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"items"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>...<span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</li>
</ol>
<p><strong>æµ‹è¯•æ‰§è¡Œç»“æœï¼š</strong></p>
<ul>
<li>å•å…ƒæµ‹è¯•è¦†ç›–ç‡ï¼š87%</li>
<li>é›†æˆæµ‹è¯•ï¼šå…¨éƒ¨é€šè¿‡</li>
<li>å›å½’æµ‹è¯•ï¼šå‘ç°1ä¸ªBugï¼ˆåº“å­˜é‡Šæ”¾æ—¶æœªæ¸…ç†ç¼“å­˜ï¼‰</li>
</ul>
<p><strong>äº¤ä»˜äº§ç‰©ï¼š</strong></p>
<ul>
<li>è‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹ï¼ˆ23ä¸ªï¼‰</li>
<li>æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š</li>
<li>BugæŠ¥å‘Š</li>
</ul>
<hr/>
<h3 data-id="heading-17">é˜¶æ®µäº”ï¼šéƒ¨ç½²å‘å¸ƒï¼ˆSkill 5ï¼šæ™ºèƒ½å‘å¸ƒç¼–æ’å¸ˆï¼‰</h3>
<p><strong>Skill 5æ‰§è¡Œæµç¨‹ï¼š</strong></p>
<ol>
<li>
<p><strong>å‘å¸ƒå‰æ£€æŸ¥æ¸…å•</strong></p>
<ul>
<li>âœ“ æ•°æ®åº“æ— å˜æ›´</li>
<li>âœ“ RabbitMQé˜Ÿåˆ—å·²åˆ›å»º</li>
<li>âœ“ é…ç½®æ–‡ä»¶å·²æ›´æ–°ï¼ˆè¶…æ—¶æ—¶é—´å¯é…ç½®ï¼‰</li>
<li>âš ï¸ éœ€è¦ç°åº¦å‘å¸ƒé…ç½®</li>
</ul>
</li>
<li>
<p><strong>ç”ŸæˆRelease Notes</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section">## [v3.5.0] - 2026-01-28</span>

<span class="hljs-section">### æ–°å¢åŠŸèƒ½</span>
<span class="hljs-bullet">-</span> è®¢å•30åˆ†é’Ÿæœªæ”¯ä»˜è‡ªåŠ¨å–æ¶ˆ
<span class="hljs-bullet">-</span> å–æ¶ˆåè‡ªåŠ¨é‡Šæ”¾åº“å­˜
<span class="hljs-bullet">-</span> å–æ¶ˆåå‘é€é€šçŸ¥ç»™ç”¨æˆ·

<span class="hljs-section">### æŠ€æœ¯æ”¹è¿›</span>
<span class="hljs-bullet">-</span> å¼•å…¥RabbitMQå»¶æ—¶é˜Ÿåˆ—
<span class="hljs-bullet">-</span> å¢åŠ åˆ†å¸ƒå¼é”é˜²æ­¢å¹¶å‘é—®é¢˜

<span class="hljs-section">### é…ç½®å˜æ›´</span>
<span class="hljs-bullet">-</span> æ–°å¢é…ç½®é¡¹ï¼šorder.payment.timeoutï¼ˆé»˜è®¤30åˆ†é’Ÿï¼‰
</code></pre>
</li>
<li>
<p><strong>å‘å¸ƒç­–ç•¥</strong>ï¼šé‡‘ä¸é›€å‘å¸ƒ</p>
<ul>
<li>ç¬¬ä¸€é˜¶æ®µï¼š10%æµé‡ï¼ˆè§‚å¯Ÿ1å°æ—¶ï¼‰</li>
<li>ç¬¬äºŒé˜¶æ®µï¼š50%æµé‡ï¼ˆè§‚å¯Ÿ2å°æ—¶ï¼‰</li>
<li>ç¬¬ä¸‰é˜¶æ®µï¼š100%æµé‡</li>
</ul>
</li>
<li>
<p><strong>å›æ»šé¢„æ¡ˆ</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å›æ»šè„šæœ¬</span>
kubectl rollout undo deployment/order-service
<span class="hljs-comment"># å…³é—­å–æ¶ˆä»»åŠ¡æ¶ˆè´¹è€…</span>
kubectl scale deployment/cancel-task-consumer --replicas=0
</code></pre>
</li>
</ol>
<p><strong>äº¤ä»˜äº§ç‰©ï¼š</strong></p>
<ul>
<li>Release Notes</li>
<li>å‘å¸ƒæ£€æŸ¥æ¸…å•</li>
<li>ç°åº¦å‘å¸ƒé…ç½®</li>
<li>å›æ»šè„šæœ¬</li>
</ul>
<hr/>
<h3 data-id="heading-18">é˜¶æ®µå…­ï¼šè¿ç»´ç›‘æ§ï¼ˆSkill 6ï¼šè¿ç»´æ•…éšœè¯Šæ–­ä¸“å®¶ï¼‰</h3>
<p><strong>ä¸Šçº¿åï¼ŒSkill 6æŒç»­ç›‘æ§ï¼š</strong></p>
<ol>
<li>
<p><strong>å®æ—¶ç›‘æ§æŒ‡æ ‡</strong></p>
<ul>
<li>è®¢å•å–æ¶ˆæˆåŠŸç‡ï¼š99.8%</li>
<li>å–æ¶ˆä»»åŠ¡æ‰§è¡Œå»¶è¿Ÿï¼šå¹³å‡32ç§’</li>
<li>RabbitMQé˜Ÿåˆ—ç§¯å‹ï¼š0</li>
</ul>
</li>
<li>
<p><strong>å¼‚å¸¸æ—¥å¿—åˆ†æ</strong></p>
<ul>
<li>å‘ç°10ä¸ªè®¢å•å–æ¶ˆå¤±è´¥</li>
<li>æ ¹å› åˆ†æï¼šåº“å­˜æœåŠ¡å¶å‘è¶…æ—¶</li>
<li>ç”Ÿæˆå¤„ç†å»ºè®®ï¼šå¢åŠ é‡è¯•æœºåˆ¶</li>
</ul>
</li>
<li>
<p><strong>æ€§èƒ½åˆ†æ</strong></p>
<ul>
<li>è®¢å•æœåŠ¡QPSå¢åŠ 5%</li>
<li>æ•°æ®åº“æ…¢æŸ¥è¯¢ï¼šæ— </li>
<li>å»ºè®®ï¼šå½“å‰æ€§èƒ½è‰¯å¥½ï¼Œæ— éœ€ä¼˜åŒ–</li>
</ul>
</li>
<li>
<p><strong>ç”Ÿæˆè¿ç»´æŠ¥å‘Š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section">## ä¸Šçº¿7å¤©è¿ç»´æŠ¥å‘Š</span>

<span class="hljs-section">### åŠŸèƒ½è¡¨ç°</span>
<span class="hljs-bullet">-</span> ç´¯è®¡è‡ªåŠ¨å–æ¶ˆè®¢å•ï¼š1,234å•
<span class="hljs-bullet">-</span> æˆåŠŸç‡ï¼š99.8%
<span class="hljs-bullet">-</span> ç”¨æˆ·æŠ•è¯‰ï¼š0

<span class="hljs-section">### å‘ç°é—®é¢˜</span>
<span class="hljs-bullet">-</span> åº“å­˜æœåŠ¡å¶å‘è¶…æ—¶ï¼ˆå·²ä¿®å¤ï¼‰

<span class="hljs-section">### ä¼˜åŒ–å»ºè®®</span>
<span class="hljs-bullet">-</span> å»ºè®®å°†è¶…æ—¶æ—¶é—´é…ç½®åŒ–ï¼Œæ”¯æŒä¸åŒå•†å“ç±»å‹
</code></pre>
</li>
</ol>
<p><strong>äº¤ä»˜äº§ç‰©ï¼š</strong></p>
<ul>
<li>ç›‘æ§å¤§ç›˜</li>
<li>å¼‚å¸¸åˆ†ææŠ¥å‘Š</li>
<li>è¿ç»´ä¼˜åŒ–å»ºè®®</li>
</ul>
<hr/>
<h3 data-id="heading-19">å…¨æµç¨‹ä»·å€¼æ€»ç»“</h3>





















































<table><thead><tr><th>é˜¶æ®µ</th><th>ä¼ ç»Ÿæ–¹å¼è€—æ—¶</th><th>Skill Setæ–¹å¼</th><th>è´¨é‡æå‡</th></tr></thead><tbody><tr><td>éœ€æ±‚åˆ†æ</td><td>2å¤©ï¼ˆå¤šæ¬¡è¿”å·¥ï¼‰</td><td>2å°æ—¶</td><td>éœ€æ±‚å®Œæ•´æ€§â†‘40%</td></tr><tr><td>æ¶æ„è®¾è®¡</td><td>3å¤©ï¼ˆæ–¹æ¡ˆè®¨è®ºï¼‰</td><td>4å°æ—¶</td><td>å†³ç­–æœ‰æ®å¯ä¾</td></tr><tr><td>ç¼–ç å¼€å‘</td><td>5å¤©</td><td>5å¤©ï¼ˆè´¨é‡â†‘ï¼‰</td><td>ä»£ç ç¼ºé™·â†“60%</td></tr><tr><td>è´¨é‡æµ‹è¯•</td><td>3å¤©ï¼ˆæ‰‹å·¥ç¼–å†™ç”¨ä¾‹ï¼‰</td><td>1å¤©</td><td>æµ‹è¯•è¦†ç›–ç‡â†‘35%</td></tr><tr><td>éƒ¨ç½²å‘å¸ƒ</td><td>1å¤©ï¼ˆæ£€æŸ¥é—æ¼ï¼‰</td><td>2å°æ—¶</td><td>å‘å¸ƒäº‹æ•…â†“80%</td></tr><tr><td>è¿ç»´ç›‘æ§</td><td>è¢«åŠ¨å“åº”</td><td>ä¸»åŠ¨é¢„é˜²</td><td>æ•…éšœæ¢å¤æ—¶é—´â†“50%</td></tr><tr><td><strong>æ€»è®¡</strong></td><td><strong>14å¤©</strong></td><td><strong>8å¤©</strong></td><td><strong>æ•´ä½“è´¨é‡æå‡45%</strong></td></tr></tbody></table>
<hr/>
<h2 data-id="heading-20">å››ã€å¦‚ä½•ä¸ºæ‚¨çš„å›¢é˜Ÿæ„å»ºSkill Set</h2>
<h3 data-id="heading-21">4.1 åœºæ™¯è¯†åˆ«ï¼šä»å“ªé‡Œå¼€å§‹ï¼Ÿ</h3>
<p>ä½¿ç”¨<strong>åœºæ™¯è¯†åˆ«çŸ©é˜µ</strong>è¯„ä¼°å›¢é˜Ÿç—›ç‚¹ï¼š</p>



































<table><thead><tr><th>è¯„ä¼°ç»´åº¦</th><th>é«˜ä¼˜å…ˆçº§ç‰¹å¾</th><th>ç¤ºä¾‹åœºæ™¯</th></tr></thead><tbody><tr><td>é¢‘ç‡</td><td>æ¯å‘¨å‘ç”Ÿâ‰¥3æ¬¡</td><td>éœ€æ±‚å˜æ›´å½±å“åˆ†æ</td></tr><tr><td>å¤æ‚åº¦</td><td>éœ€è¦3äººä»¥ä¸ŠååŒ</td><td>è·¨ç³»ç»Ÿæ¶æ„è®¾è®¡</td></tr><tr><td>é£é™©</td><td>å‡ºé”™å½±å“çº¿ä¸ŠæœåŠ¡</td><td>æ•°æ®åº“å˜æ›´ã€ç”Ÿäº§å‘å¸ƒ</td></tr><tr><td>ä¾èµ–æ€§</td><td>åªæœ‰1-2äººèƒ½åš</td><td>æ€§èƒ½ç“¶é¢ˆè¯Šæ–­</td></tr><tr><td>æ ‡å‡†åŒ–ç¨‹åº¦</td><td>å·²æœ‰SOPä½†æ‰§è¡Œä¸ä¸€è‡´</td><td>Code Reviewæµç¨‹</td></tr></tbody></table>
<p><strong>ä¼˜å…ˆæ„å»ºçš„Skill</strong>ï¼šåŒæ—¶æ»¡è¶³3ä¸ªä»¥ä¸Šç‰¹å¾çš„åœºæ™¯</p>
<p><strong>æ¨èèµ·ç‚¹</strong>ï¼š"ä»£ç å˜æ›´å½±å“åˆ†æSkill"</p>
<ul>
<li>å·¥å…·æˆç†Ÿï¼ˆGitã€ASTåˆ†æï¼‰</li>
<li>ä»·å€¼ç›´æ¥ï¼ˆé¿å…é—æ¼å›å½’æµ‹è¯•ï¼‰</li>
<li>å¤æ‚åº¦é€‚ä¸­ï¼ˆé€‚åˆç»ƒæ‰‹ï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-22">4.2 Skillè®¾è®¡è“å›¾</h3>
<p><strong>å®Œæ•´çš„SkillåŒ…å«6ä¸ªéƒ¨åˆ†ï¼š</strong></p>
<pre><code class="hljs language-csharp" lang="csharp">my-skill/
â”œâ”€â”€ SKILL.md                 <span class="hljs-meta"># SOPæ–‡æ¡£ï¼ˆå¿…é¡»ï¼‰</span>
â”œâ”€â”€ tools/                   <span class="hljs-meta"># å·¥å…·è„šæœ¬ç›®å½•</span>
â”‚   â”œâ”€â”€ analyzer.py         <span class="hljs-meta"># åˆ†æè„šæœ¬</span>
â”‚   â””â”€â”€ checker.sh          <span class="hljs-meta"># æ£€æŸ¥è„šæœ¬</span>
â”œâ”€â”€ templates/              <span class="hljs-meta"># æ¨¡æ¿æ–‡ä»¶</span>
â”‚   â””â”€â”€ report-template.md  <span class="hljs-meta"># æŠ¥å‘Šæ¨¡æ¿</span>
â”œâ”€â”€ knowledge/              <span class="hljs-meta"># çŸ¥è¯†åº“</span>
â”‚   â”œâ”€â”€ architecture.md     <span class="hljs-meta"># æ¶æ„æ–‡æ¡£</span>
â”‚   â””â”€â”€ best-practices.md   <span class="hljs-meta"># æœ€ä½³å®è·µ</span>
â”œâ”€â”€ examples/               <span class="hljs-meta"># ç¤ºä¾‹æ¡ˆä¾‹</span>
â”‚   â””â”€â”€ <span class="hljs-keyword">case</span><span class="hljs-number">-001.</span>md
â””â”€â”€ config.json             <span class="hljs-meta"># Skillé…ç½®</span>
</code></pre>
<p><strong>SKILL.mdæ ¸å¿ƒç»“æ„ï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># Skillåç§°</span>

<span class="hljs-section">## è§¦å‘æ¡ä»¶</span>
æè¿°ä»€ä¹ˆæ—¶å€™åº”è¯¥ä½¿ç”¨è¿™ä¸ªSkill

<span class="hljs-section">## æ‰§è¡Œæµç¨‹</span>
<span class="hljs-section">### æ­¥éª¤1ï¼šXXX</span>
<span class="hljs-bullet">-</span> å­æ­¥éª¤1.1
<span class="hljs-bullet">-</span> å­æ­¥éª¤1.2
<span class="hljs-bullet">-</span> ã€å†³ç­–ç‚¹ã€‘å¦‚æœXXXï¼Œåˆ™è·³è½¬åˆ°æ­¥éª¤3

<span class="hljs-section">### æ­¥éª¤2ï¼šXXX</span>
...

<span class="hljs-section">## å·¥å…·è°ƒç”¨</span>
<span class="hljs-bullet">-</span> å·¥å…·Aï¼šç”¨äºXXXï¼Œè°ƒç”¨æ–¹å¼ï¼šxxx
<span class="hljs-bullet">-</span> å·¥å…·Bï¼šç”¨äºXXXï¼Œè°ƒç”¨æ–¹å¼ï¼šxxx

<span class="hljs-section">## è´¨é‡æ£€æŸ¥ç‚¹</span>
<span class="hljs-bullet">-</span> [ ] æ£€æŸ¥é¡¹1
<span class="hljs-bullet">-</span> [ ] æ£€æŸ¥é¡¹2

<span class="hljs-section">## äº¤ä»˜äº§ç‰©</span>
<span class="hljs-bullet">-</span> äº§ç‰©1ï¼šæ ¼å¼/æ¨¡æ¿è·¯å¾„
<span class="hljs-bullet">-</span> äº§ç‰©2ï¼šæ ¼å¼/æ¨¡æ¿è·¯å¾„

<span class="hljs-section">## å¸¸è§é—®é¢˜FAQ</span>
Q: XXX?
A: XXX
</code></pre>
<hr/>
<h3 data-id="heading-23">4.3 å·¥å…·é›†æˆç­–ç•¥</h3>
<p><strong>ä¸ç°æœ‰å·¥å…·é“¾çš„é›†æˆæ–¹å¼ï¼š</strong></p>
<ol>
<li>
<p><strong>ä»£ç ä»“åº“é›†æˆ</strong>ï¼ˆGitï¼‰</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># MCPå®¢æˆ·ç«¯ç¤ºä¾‹</span>
git_client.get_diff(commit_id)
git_client.analyze_history(file_path)
</code></pre>
</li>
<li>
<p><strong>CI/CDé›†æˆ</strong>ï¼ˆJenkins/GitLabï¼‰</p>
<ul>
<li>åœ¨Pipelineä¸­è°ƒç”¨Skillè„šæœ¬</li>
<li>ç”ŸæˆæŠ¥å‘Šè‡ªåŠ¨è¯„è®ºåˆ°MR</li>
</ul>
</li>
<li>
<p><strong>è´¨é‡å·¥å…·é›†æˆ</strong>ï¼ˆSonarQube/Snykï¼‰</p>
<ul>
<li>é€šè¿‡APIè·å–æ‰«æç»“æœ</li>
<li>æ•´åˆåˆ°ç»Ÿä¸€æŠ¥å‘Š</li>
</ul>
</li>
<li>
<p><strong>ç›‘æ§ç³»ç»Ÿé›†æˆ</strong>ï¼ˆPrometheus/Grafanaï¼‰</p>
<ul>
<li>è·å–è¿è¡Œæ—¶æŒ‡æ ‡</li>
<li>è¾…åŠ©é—®é¢˜è¯Šæ–­</li>
</ul>
</li>
<li>
<p><strong>åä½œå¹³å°é›†æˆ</strong>ï¼ˆJira/Confluenceï¼‰</p>
<ul>
<li>è‡ªåŠ¨åŒæ­¥éœ€æ±‚å’Œæ–‡æ¡£</li>
<li>ç”Ÿæˆå·¥ä½œæµè½¬è®°å½•</li>
</ul>
</li>
</ol>
<hr/>
<h3 data-id="heading-24">4.4 æ¸è¿›å¼å®æ–½è·¯å¾„</h3>
<h4 data-id="heading-25">é˜¶æ®µä¸€ï¼šè¯•ç‚¹éªŒè¯ï¼ˆ1-2ä¸ªæœˆï¼‰</h4>
<p><strong>é€‰æ‹©1ä¸ªç—›ç‚¹åœºæ™¯</strong></p>
<ul>
<li>æ¨èï¼šä»"ä»£ç è´¨é‡æ£€æŸ¥"æˆ–"æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆ"å¼€å§‹</li>
<li>ç›®æ ‡ï¼šéªŒè¯Skillæœºåˆ¶å¯è¡Œæ€§</li>
</ul>
<p><strong>å¿«é€Ÿæ„å»ºMVP</strong></p>
<ul>
<li>Week 1: ç¼–å†™SOPæ–‡æ¡£</li>
<li>Week 2: é›†æˆ1-2ä¸ªå·¥å…·</li>
<li>Week 3: å°èŒƒå›´è¯•ç”¨ï¼ˆ2-3äººï¼‰</li>
<li>Week 4: æ”¶é›†åé¦ˆï¼Œä¼˜åŒ–</li>
</ul>
<p><strong>æˆåŠŸæŒ‡æ ‡</strong></p>
<ul>
<li>è¯¥åœºæ™¯æ•ˆç‡æå‡â‰¥30%</li>
<li>å›¢é˜Ÿæ„¿æ„æŒç»­ä½¿ç”¨</li>
</ul>
<hr/>
<h4 data-id="heading-26">é˜¶æ®µäºŒï¼šæ¨ªå‘æ‰©å±•ï¼ˆ3-6ä¸ªæœˆï¼‰</h4>
<p><strong>æ„å»ºæ ¸å¿ƒSkillçŸ©é˜µ</strong></p>
<ul>
<li>è‡³å°‘è¦†ç›–3ä¸ªå¼€å‘é˜¶æ®µï¼ˆå¦‚ï¼šè®¾è®¡ã€å¼€å‘ã€æµ‹è¯•ï¼‰</li>
<li>å»ºç«‹Skillä¹‹é—´çš„ååŒæœºåˆ¶</li>
</ul>
<p><strong>åŸ¹å…»Skillç»´æŠ¤è€…</strong></p>
<ul>
<li>æ¯ä¸ªSkillæŒ‡å®šOwner</li>
<li>å»ºç«‹Skillä¼˜åŒ–çš„å¥–åŠ±æœºåˆ¶</li>
</ul>
<hr/>
<h4 data-id="heading-27">é˜¶æ®µä¸‰ï¼šè§„æ¨¡åŒ–æ¨å¹¿ï¼ˆ6-12ä¸ªæœˆï¼‰</h4>
<p><strong>å…¨æµç¨‹è¦†ç›–</strong></p>
<ul>
<li>6ä¸ªé˜¶æ®µçš„Skillå…¨éƒ¨å°±ä½</li>
<li>å»ºç«‹Skillç¼–æ’èƒ½åŠ›ï¼ˆä¸€ä¸ªä»»åŠ¡è‡ªåŠ¨è°ƒç”¨å¤šä¸ªSkillï¼‰</li>
</ul>
<p><strong>åº¦é‡ä¸ä¼˜åŒ–</strong></p>
<ul>
<li>å»ºç«‹Skillä½¿ç”¨dashboard</li>
<li>å®šæœŸReviewæ•ˆæœï¼ˆå­£åº¦ï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-28">4.5 å¸¸è§é™·é˜±ä¸åº”å¯¹</h3>



































<table><thead><tr><th>é™·é˜±</th><th>è¡¨ç°</th><th>åº”å¯¹æ–¹æ³•</th></tr></thead><tbody><tr><td>è¿‡åº¦è‡ªåŠ¨åŒ–</td><td>Skillæ›¿ä»£äº†æ‰€æœ‰äººå·¥å†³ç­–</td><td>ä¿ç•™å…³é”®å†³ç­–ç‚¹éœ€è¦äººå·¥å®¡æ ¸</td></tr><tr><td>SOPè¿‡äºæŠ½è±¡</td><td>å›¢é˜Ÿæ— æ³•æ‰§è¡Œ</td><td>ç”¨"å¯æ‰§è¡Œä¼ªä»£ç "ç¼–å†™SOP</td></tr><tr><td>å·¥å…·æ³›æ»¥</td><td>é›†æˆäº†20+å·¥å…·ï¼Œç»´æŠ¤å›°éš¾</td><td>èšç„¦æ ¸å¿ƒ3-5ä¸ªå·¥å…·</td></tr><tr><td>çŸ¥è¯†å­¤å²›</td><td>Skillåªæœ‰åˆ›å»ºè€…èƒ½ç»´æŠ¤</td><td>å¼ºåˆ¶æ–‡æ¡£åŒ–+å®šæœŸåˆ†äº«</td></tr><tr><td>åƒµåŒ–æµç¨‹</td><td>ç‰¹æ®Šåœºæ™¯æ— æ³•å¤„ç†</td><td>SOPä¸­è®¾è®¡"é€ƒç”Ÿèˆ±"æœºåˆ¶</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-29">4.6 æŠ•å…¥äº§å‡ºåˆ†æ</h3>
<p><strong>åˆæœŸæŠ•å…¥</strong>ï¼ˆä»¥1ä¸ªSkillä¸ºä¾‹ï¼‰ï¼š</p>
<ul>
<li>éœ€æ±‚è°ƒç ”ï¼š1å¤©</li>
<li>SOPç¼–å†™ï¼š2å¤©</li>
<li>å·¥å…·é›†æˆï¼š3-5å¤©</li>
<li>æµ‹è¯•éªŒè¯ï¼š2å¤©</li>
<li><strong>æ€»è®¡</strong>ï¼š8-10äººå¤©</li>
</ul>
<p><strong>é•¿æœŸæ”¶ç›Š</strong>ï¼ˆæŒ‰ä½¿ç”¨1å¹´è®¡ç®—ï¼‰ï¼š</p>
<ul>
<li>å‡è®¾æ¯å‘¨ä½¿ç”¨5æ¬¡ï¼Œæ¯æ¬¡èŠ‚çœ2å°æ—¶</li>
<li>å¹´èŠ‚çœæ—¶é—´ï¼š5æ¬¡ Ã— 2å°æ—¶ Ã— 52å‘¨ = 520å°æ—¶ â‰ˆ 65äººå¤©</li>
<li><strong>ROI</strong>ï¼š650% â†‘</li>
</ul>
<p><strong>éšæ€§æ”¶ç›Š</strong>ï¼š</p>
<ul>
<li>è´¨é‡æå‡ï¼Œå‡å°‘è¿”å·¥</li>
<li>æ–°äººä¸Šæ‰‹æ—¶é—´ç¼©çŸ­50%</li>
<li>å›¢é˜ŸçŸ¥è¯†èµ„äº§ç§¯ç´¯</li>
</ul>
<hr/>
<h2 data-id="heading-30">äº”ã€æœªæ¥å±•æœ›ï¼šAgentæ—¶ä»£çš„è½¯ä»¶å·¥ç¨‹</h2>
<h3 data-id="heading-31">5.1 æŠ€æœ¯æ¼”è¿›è¶‹åŠ¿</h3>
<h4 data-id="heading-32">è¶‹åŠ¿ä¸€ï¼šä»å•ä¸€æŠ€èƒ½åˆ°ååŒç¼–æ’</h4>
<pre><code class="hljs language-arduino" lang="arduino">å½“å‰ï¼šäººå·¥è§¦å‘å•ä¸ªSkill
â†“
æœªæ¥ï¼šAgentè‡ªåŠ¨ç¼–æ’å¤šä¸ªSkills

ç¤ºä¾‹ï¼š
<span class="hljs-string">"å¸®æˆ‘å®ŒæˆXXéœ€æ±‚"</span> â†’ Agentè‡ªåŠ¨è°ƒç”¨ï¼š
  éœ€æ±‚åˆ†æSkill â†’ æ¶æ„è®¾è®¡Skill â†’ ä»£ç ç”ŸæˆSkill â†’ æµ‹è¯•Skill
</code></pre>
<h4 data-id="heading-33">è¶‹åŠ¿äºŒï¼šä»é™æ€SOPåˆ°è‡ªå­¦ä¹ ä¼˜åŒ–</h4>
<ul>
<li>é€šè¿‡å†å²æ‰§è¡Œæ•°æ®ï¼Œè‡ªåŠ¨ä¼˜åŒ–SOPæ­¥éª¤</li>
<li>è¯†åˆ«é«˜é¢‘å¼‚å¸¸åœºæ™¯ï¼Œè‡ªåŠ¨è¡¥å……åˆ°æµç¨‹ä¸­</li>
<li>å»ºç«‹"Skillè¿›åŒ–"æœºåˆ¶</li>
</ul>
<h4 data-id="heading-34">è¶‹åŠ¿ä¸‰ï¼šä»ä»£ç åˆ°å…¨ç ”å‘èµ„äº§ç®¡ç†</h4>
<ul>
<li>æ‰©å±•åˆ°éœ€æ±‚æ–‡æ¡£ã€æµ‹è¯•ç”¨ä¾‹ã€éƒ¨ç½²é…ç½®çš„å…¨ç”Ÿå‘½å‘¨æœŸ</li>
<li>å»ºç«‹"æ•°å­—å­ªç”Ÿ"çš„ç ”å‘ä½“ç³»</li>
</ul>
<hr/>
<h3 data-id="heading-35">5.2 ç«‹å³å¯è¡ŒåŠ¨çš„3ä»¶äº‹</h3>
<h4 data-id="heading-36">è¡ŒåŠ¨1ï¼šç—›ç‚¹è°ƒç ”</h4>
<p><strong>å…·ä½“æ­¥éª¤ï¼š</strong></p>
<ol>
<li>å¬é›†å›¢é˜Ÿbrainstormä¼šè®®ï¼ˆ1å°æ—¶ï¼‰</li>
<li>åˆ—å‡ºå½“å‰Top 5ç—›ç‚¹åœºæ™¯</li>
<li>ç”¨"åœºæ™¯è¯†åˆ«çŸ©é˜µ"è¯„åˆ†</li>
<li>é€‰å‡º1ä¸ªåœºæ™¯ä½œä¸ºè¯•ç‚¹</li>
</ol>
<p><strong>å‚è€ƒé—®é¢˜ï¼š</strong></p>
<ul>
<li>å“ªä¸ªç¯èŠ‚ç»å¸¸è¿”å·¥ï¼Ÿ</li>
<li>å“ªä¸ªç¯èŠ‚å‡ºé”™å½±å“æœ€å¤§ï¼Ÿ</li>
<li>å“ªä¸ªç¯èŠ‚æ–°äººæœ€éš¾ä¸Šæ‰‹ï¼Ÿ</li>
</ul>
<hr/>
<h4 data-id="heading-37">è¡ŒåŠ¨2ï¼šæ„å»ºç¬¬ä¸€ä¸ªSkill</h4>
<p><strong>æ¨èèµ·ç‚¹</strong>ï¼š"ä»£ç å˜æ›´å½±å“åˆ†æSkill"</p>
<p><strong>åŸå› ï¼š</strong></p>
<ul>
<li>å·¥å…·æˆç†Ÿï¼ˆGitã€ASTåˆ†æï¼‰</li>
<li>ä»·å€¼ç›´æ¥ï¼ˆé¿å…é—æ¼å›å½’æµ‹è¯•ï¼‰</li>
<li>å¤æ‚åº¦é€‚ä¸­ï¼ˆé€‚åˆç»ƒæ‰‹ï¼‰</li>
</ul>
<p><strong>å…·ä½“ä»»åŠ¡ï¼š</strong></p>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> ç¼–å†™SOPæ–‡æ¡£ï¼ˆå‚è€ƒæ¨¡æ¿ï¼‰</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> é›†æˆGit API</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æµ‹è¯•3ä¸ªçœŸå®æ¡ˆä¾‹</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> å›¢é˜Ÿè¯•ç”¨å¹¶æ”¶é›†åé¦ˆ</li>
</ul>
<hr/>
<h4 data-id="heading-38">è¡ŒåŠ¨3ï¼šå»ºç«‹åˆ†äº«æœºåˆ¶ï¼ˆæŒç»­ï¼‰</h4>
<ul>
<li>æ¯æœˆSkill Showï¼šåˆ†äº«æ–°Skillå’Œä¼˜åŒ–ç»éªŒ</li>
<li>å»ºç«‹Skillä½¿ç”¨æ’è¡Œæ¦œï¼ˆgamificationï¼‰</li>
<li>è®¾ç«‹"æœ€ä½³Skillè´¡çŒ®å¥–"</li>
</ul>
<hr/>
<h3 data-id="heading-39">5.3 å†™åœ¨æœ€å</h3>
<p><strong>Agentæ—¶ä»£çš„è½¯ä»¶å¼€å‘ï¼Œä¸æ˜¯ç”¨AIæ›¿ä»£äººï¼Œè€Œæ˜¯è®©æ¯ä¸ªäººéƒ½æ‹¥æœ‰ä¸“å®¶çº§çš„èƒ½åŠ›æ”¯æŒã€‚</strong></p>
<p>Skillä¸æ˜¯ä¸‡èƒ½çš„ï¼Œå®ƒæ— æ³•æ›¿ä»£äººçš„åˆ›é€ åŠ›å’Œåˆ¤æ–­åŠ›ã€‚ä½†å®ƒèƒ½å¤Ÿï¼š</p>
<ul>
<li>å°†æœ€ä½³å®è·µæ ‡å‡†åŒ–ï¼Œè®©æ–°äººå¿«é€Ÿæˆé•¿</li>
<li>å°†ä¸“å®¶ç»éªŒæ˜¾æ€§åŒ–ï¼Œè®©çŸ¥è¯†æ°¸ä¹…æ²‰æ·€</li>
<li>å°†è´¨é‡ä¿éšœå‰ç½®åŒ–ï¼Œè®©é—®é¢˜æå‰å‘ç°</li>
</ul>
<p><strong>ä»Šå¤©å¸¦èµ°çš„æ ¸å¿ƒè§‚ç‚¹ï¼š</strong></p>
<ol>
<li>âœ… Skillä¸æ˜¯æ›¿ä»£äººï¼Œè€Œæ˜¯å°†"æœ€ä½³å®è·µ"æ ‡å‡†åŒ–</li>
<li>âœ… ä»ä¸€ä¸ªç—›ç‚¹åœºæ™¯å¼€å§‹ï¼Œå°æ­¥å¿«è·‘</li>
<li>âœ… å…¨æµç¨‹è¦†ç›–ï¼ˆéœ€æ±‚â†’è¿ç»´ï¼‰æ‰èƒ½å‘æŒ¥æœ€å¤§ä»·å€¼</li>
<li>âœ… Skillæ˜¯å›¢é˜Ÿçš„çŸ¥è¯†èµ„äº§ï¼Œéœ€è¦æŒç»­ç»´æŠ¤</li>
</ol>
<p><strong>ä»æ˜å¤©å¼€å§‹ï¼š</strong></p>
<ul>
<li>æ‰¾å‡ºæ‚¨å›¢é˜Ÿçš„Top 1ç—›ç‚¹</li>
<li>ç”¨2å‘¨æ—¶é—´æ„å»ºç¬¬ä¸€ä¸ªSkill</li>
<li>åº¦é‡æ•ˆæœï¼ŒæŒç»­ä¼˜åŒ–</li>
</ul>
<p><strong>Agentæ—¶ä»£å·²ç»åˆ°æ¥ï¼Œé‡æ–°å®šä¹‰è½¯ä»¶å¼€å‘çš„ä¸æ˜¯æŠ€æœ¯ï¼Œè€Œæ˜¯æˆ‘ä»¬å¯¹"çŸ¥è¯†"å’Œ"ååŒ"çš„æ–°ç†è§£ã€‚</strong></p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[äº‘è¾¹ååŒ AI æ¶æ„å›¾]]></title>    <link>https://juejin.cn/post/7599965904617226286</link>    <guid>https://juejin.cn/post/7599965904617226286</guid>    <pubDate>2026-01-28T03:06:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599965904617226286" data-draft-id="7599963665039605810" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="äº‘è¾¹ååŒ AI æ¶æ„å›¾"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-28T03:06:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeonGao"/> <meta itemprop="url" content="https://juejin.cn/user/3976252950591149"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            äº‘è¾¹ååŒ AI æ¶æ„å›¾
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3976252950591149/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeonGao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T03:06:38.000Z" title="Wed Jan 28 2026 03:06:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{font-size:24px;display:inline-block;font-weight:700;background:#ef7060;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(239,112,96,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 50px);border-bottom:3px solid #ef7060}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #3e3e3e;margin-top:32px;margin-bottom:32px;height:1px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(27,31,35,.05);color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:JetBranins Mono,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px;background-color:#fdfdfd}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#fdfdfd}.markdown-body a{text-decoration:none;font-weight:700;color:#ef7060;border-bottom:1px solid #ef7060}.markdown-body a:active,.markdown-body a:hover{color:#ef2d26}.markdown-body table tr td,.markdown-body table tr th{border:1px solid #ccc;padding:5px 10px}.markdown-body table{display:block!important;width:auto;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{background:#f0f0f0;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#f8f8f8}.markdown-body blockquote{margin-inline-start:0;margin-inline-end:0;border-left:3px solid #ef7060;background:#fff9f9;padding:1px 20px;margin-top:20px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-light">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h3 data-id="heading-0"><strong>å›¾åï¼šäº‘è¾¹ååŒ AI æ¶æ„å›¾ï¼ˆCloud-Edge Collaborative AI Architectureï¼‰</strong></h3>
<h4 data-id="heading-1"><strong>æ•´ä½“é£æ ¼</strong></h4>
<ul>
<li>æ¨ªå‘æµç¨‹å‹ç»“æ„å›¾ï¼Œé‡‡ç”¨ç®€æ´çš„ç§‘æŠ€é£è®¾è®¡ã€‚</li>
<li>ä¸‰å±‚ç»“æ„ï¼š<strong>ç”¨æˆ·ç»ˆç«¯å±‚ â†’ è¾¹ç¼˜è®¡ç®—å±‚ â†’ äº‘ç«¯æ™ºèƒ½å±‚</strong>ã€‚</li>
<li>ç”¨ç®­å¤´è¡¨ç¤ºæ•°æ®æµå‘ï¼ˆä»å·¦åˆ°å³ï¼‰ï¼Œä½¿ç”¨æ¸å˜è‰²å±•ç¤ºä¿¡æ¯æµåŠ¨ä¸æ™ºèƒ½ååŒã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-2"><strong>å›¾å±‚ä¸ç»„ä»¶è¯´æ˜</strong></h3>
<h4 data-id="heading-3"><strong>â‘  ç”¨æˆ·ç»ˆç«¯å±‚ï¼ˆUser Devices Layerï¼‰</strong></h4>
<p>ä½äºå›¾çš„æœ€å·¦ä¾§ã€‚åŒ…å«ï¼š</p>
<ul>
<li>æ™ºèƒ½æ‰‹æœºã€æ™ºèƒ½æ‰‹è¡¨ã€æ‘„åƒå¤´ã€ä¼ æ„Ÿå™¨ã€æ±½è½¦ç­‰å›¾æ ‡ã€‚</li>
<li>æ ‡ç­¾æ–‡å­—ï¼šâ€œæ•°æ®é‡‡é›† / æœ¬åœ°äº¤äº’â€ã€‚</li>
<li>æ•°æ®ç®­å¤´æŒ‡å‘ä¸­é—´å±‚ï¼ˆè¾¹ç¼˜è®¡ç®—å±‚ï¼‰ã€‚</li>
</ul>
<p><strong>ä½œç”¨è¯´æ˜ï¼š</strong><br/>
ç”¨æˆ·ç»ˆç«¯ç”¨äºé‡‡é›†è¯­éŸ³ã€å›¾åƒã€GPSã€è¡Œä¸ºç­‰æ•°æ®ï¼Œå¹¶å°†éƒ¨åˆ†è¯·æ±‚å‘é€åˆ°é™„è¿‘è¾¹ç¼˜èŠ‚ç‚¹ã€‚</p>
<hr/>
<h4 data-id="heading-4"><strong>â‘¡ è¾¹ç¼˜è®¡ç®—å±‚ï¼ˆEdge Computing Layerï¼‰</strong></h4>
<p>å±…ä¸­ä½ç½®ï¼ŒçŸ©å½¢æ¡†å†…éƒ¨åŒ…å«å¤šä¸ªå¾®èŠ‚ç‚¹å›¾æ ‡ï¼ˆå¦‚å°æœåŠ¡å™¨ã€AI èŠ¯ç‰‡ã€è¾¹ç¼˜ç½‘å…³ç­‰ï¼‰ã€‚</p>
<ul>
<li>
<p>æ ‡ç­¾æ–‡å­—ï¼šâ€œæœ¬åœ°å°æ¨¡å‹æ¨ç† / éšç§è®¡ç®— / å®æ—¶å“åº”â€ã€‚</p>
</li>
<li>
<p>æ•°æ®ç®­å¤´ï¼š</p>
<ul>
<li>å‘å³ â†’ ä¼ è¾“éƒ¨åˆ†æ¨¡å‹ç»“æœæˆ–åŠ å¯†æ•°æ®åˆ°äº‘ç«¯ï¼›</li>
<li>å‘å·¦ â†’ å®æ—¶è¿”å›ä½å»¶è¿Ÿå“åº”ç»™ç”¨æˆ·ã€‚</li>
</ul>
</li>
</ul>
<p><strong>åŠŸèƒ½è¯´æ˜ï¼š</strong></p>
<ul>
<li>æ‰¿è½½è½»é‡åŒ–æ¨¡å‹éƒ¨ç½²ï¼ˆTinyLLaMAã€MobileNetã€EdgeBERT ç­‰ï¼‰ã€‚</li>
<li>å…·å¤‡ç¼“å­˜æœºåˆ¶ä¸åŠ¨æ€è°ƒåº¦èƒ½åŠ›ã€‚</li>
<li>å¯è°ƒç”¨ GPU/NPU åŠ é€Ÿæ¨¡å—ã€‚</li>
</ul>
<hr/>
<h4 data-id="heading-5"><strong>â‘¢ äº‘ç«¯æ™ºèƒ½å±‚ï¼ˆCloud Intelligence Layerï¼‰</strong></h4>
<p>ä½äºå›¾çš„å³ä¾§ï¼Œä¸Šæ–¹æ˜¯å¤§å‹æœåŠ¡å™¨é›†ç¾¤æˆ–äº‘å›¾æ ‡ã€‚</p>
<ul>
<li>
<p>æ ‡ç­¾æ–‡å­—ï¼šâ€œå¤§æ¨¡å‹è®­ç»ƒ / çŸ¥è¯†æ›´æ–° / æ¨¡å‹è’¸é¦â€ã€‚</p>
</li>
<li>
<p>ç®­å¤´ï¼š</p>
<ul>
<li>ä»äº‘ç«¯è¿”å›åˆ°è¾¹ç¼˜å±‚ â†’ è¡¨ç¤ºå‘¨æœŸæ€§æ¨¡å‹åŒæ­¥æˆ–è’¸é¦çŸ¥è¯†ä¸‹å‘ï¼›</li>
<li>ä»è¾¹ç¼˜ä¸Šè¡Œè‡³äº‘ç«¯ â†’ è¡¨ç¤ºä¸Šä¼ åŒ¿ååŒ–æ•°æ®æˆ–è¯·æ±‚å¤æ‚æ¨ç†ã€‚</li>
</ul>
</li>
</ul>
<p><strong>åŠŸèƒ½è¯´æ˜ï¼š</strong></p>
<ul>
<li>äº‘ç«¯æ‰§è¡Œå¤§å‹æ¨¡å‹è®­ç»ƒï¼ˆå¦‚ GPTã€Geminiã€Claude ç­‰ï¼‰ã€‚</li>
<li>æä¾›ç»Ÿä¸€ API æ¥å£ä¸çŸ¥è¯†åº“æ›´æ–°ã€‚</li>
<li>æ”¯æ’‘è¾¹ç¼˜ç«¯çš„æ¨¡å‹è½»é‡åŒ–ä¸é€‚é…ã€‚</li>
</ul>
<hr/>
<h4 data-id="heading-6"><strong>â‘£ è¾…åŠ©å…ƒç´ </strong></h4>
<ul>
<li>
<p>å›¾ä¸‹æ–¹æ·»åŠ æ³¨é‡ŠåŒºåŸŸï¼š</p>
<ul>
<li>äº‘ç«¯ä¾§æ ‡æ³¨ï¼šâ€œé«˜ç²¾åº¦ / å¼ºç®—åŠ› / é›†ä¸­è®­ç»ƒâ€</li>
<li>è¾¹ç¼˜ä¾§æ ‡æ³¨ï¼šâ€œä½å»¶è¿Ÿ / æœ¬åœ°æ¨ç† / æ•°æ®éšç§â€</li>
</ul>
</li>
<li>
<p>ä½¿ç”¨æ¸å˜è‰²æ•°æ®æµç®­å¤´è¿æ¥ä¸‰å±‚ï¼Œä»¥è“è‰²æˆ–ç»¿è‰²è¡¨ç¤ºæ™ºèƒ½æµåŠ¨æ–¹å‘ã€‚</p>
</li>
<li>
<p>èƒŒæ™¯å¯ä¸ºæ·¡ç°è‰²ç”µè·¯çº¹ç†æˆ–ç½‘æ ¼ï¼Œå¢å¼ºç§‘æŠ€æ„Ÿã€‚</p>
</li>
</ul>
<hr/>
<h3 data-id="heading-7"><strong>è§†è§‰æ€»ç»“</strong></h3>
<p>æ•´ä½“é€»è¾‘è¡¨è¾¾ä¸ºï¼š</p>
<blockquote>
<p>â€œç”¨æˆ·æ•°æ®åœ¨æœ¬åœ°è¾¹ç¼˜èŠ‚ç‚¹å®Œæˆå³æ—¶æ™ºèƒ½å¤„ç†ï¼ŒåŒæ—¶ä¸äº‘ç«¯æ¨¡å‹å½¢æˆåŠ¨æ€ååŒâ€”â€”äº‘ç«¯æä¾›çŸ¥è¯†ï¼Œè¾¹ç¼˜æ‰§è¡Œå†³ç­–ï¼Œå®ç°æ™ºèƒ½å‰ç§»ä¸æŒç»­è¿›åŒ–ã€‚â€</p>
</blockquote>
<hr/>
<p>æ˜¯å¦å¸Œæœ›æˆ‘æ ¹æ®è¿™ä¸€æè¿°ç›´æ¥ä¸ºä½  <strong>ç”Ÿæˆä¸€å¼ ç¤ºæ„å›¾ï¼ˆé«˜æ¸… 16:9 æ¶æ„å›¾ï¼‰</strong> ï¼Ÿ</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[nestjså­¦ä¹ 14ï¼šå‚æ•°éªŒè¯ä¸è½¬æ¢ pipe]]></title>    <link>https://juejin.cn/post/7599951933594157066</link>    <guid>https://juejin.cn/post/7599951933594157066</guid>    <pubDate>2026-01-28T03:05:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599951933594157066" data-draft-id="7599581204860141594" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="nestjså­¦ä¹ 14ï¼šå‚æ•°éªŒè¯ä¸è½¬æ¢ pipe"/> <meta itemprop="keywords" content="NestJS"/> <meta itemprop="datePublished" content="2026-01-28T03:05:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€æ±Ÿä¸œæµæ°´"/> <meta itemprop="url" content="https://juejin.cn/user/1151943917181880"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            nestjså­¦ä¹ 14ï¼šå‚æ•°éªŒè¯ä¸è½¬æ¢ pipe
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1151943917181880/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€æ±Ÿä¸œæµæ°´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T03:05:05.000Z" title="Wed Jan 28 2026 03:05:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Pipe æ˜¯åœ¨å‚æ•°ä¼ ç»™ handler ä¹‹å‰å¯¹å‚æ•°åšä¸€äº›éªŒè¯å’Œè½¬æ¢çš„ classã€‚</p>
<p>nestjs å†…ç½®çš„ Pipe æœ‰è¿™äº›ï¼š</p>
<ul>
<li>ValidationPipe</li>
<li>ParseIntPipe</li>
<li>ParseBoolPipe</li>
<li>ParseArrayPipe</li>
<li>ParseUUIDPipe</li>
<li>DefaultValuePipe</li>
<li>ParseEnumPipe</li>
<li>ParseFloatPipe</li>
<li>ParseFilePipe</li>
</ul>
<p>åˆ†åˆ«æ¥è¯•ä¸‹å†…ç½®çš„ Pipe çš„åŠŸèƒ½ã€‚</p>
<h2 data-id="heading-0">ParseIntPipe</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/64b45d6ba8314788a3ed075c587ccba0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=uIeOGNwzntmBpv53LgvQZgJ77QE%3D" alt="image.png" loading="lazy"/></p>
<p>å‚æ•°é»˜è®¤æ˜¯ string ç±»å‹ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ Pipe æŠŠå®ƒè½¬ä¸ºæ•´æ•°ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ab4087c61424e8c93d7e3301454b122~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=b%2FLO3cmUANoEhzY42X5vcequkKE%3D" alt="image.png" loading="lazy"/></p>
<p>æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bbbeab4a1b9e4dc58026515188c8d4d1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=JR1x0rEP6SnjayTCvGTXdEN69cQ%3D" alt="image.png" loading="lazy"/></p>
<p>å½“ä½ ä¼ å…¥çš„å‚æ•°ä¸èƒ½ parse ä¸º int æ—¶ï¼Œä¼šè¿”å›è¿™æ ·çš„å“åº”ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/706d6652c4a2454899168fe8de0b22df~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=Yy%2Bm6CXZTG4%2FwtAuubCvimoTF%2Fo%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™ä¸ªä¹Ÿæ˜¯å¯ä»¥ä¿®æ”¹çš„ï¼Œä½†è¦ä½¿ç”¨ <code>new XxxPipe</code> çš„æ–¹å¼ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/db9b624bf7fa4e84bca0c27c975168d8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=R%2F8El%2Bpf3cTkwihDdrFMC%2FGJz20%3D" alt="image.png" loading="lazy"/></p>
<p>æ¯”å¦‚æˆ‘æŒ‡å®šé”™è¯¯æ—¶çš„çŠ¶æ€ç ä¸º 404ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ad596cdcb5bd484f97bddc923f409020~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=9tBxmDpVga7CQpn5ANdKHVe%2FVf4%3D" alt="image.png" loading="lazy"/></p>
<p>å°±ä¼šè¿”å›è¿™æ ·çš„å“åº”ã€‚</p>
<p>æ­¤å¤–ï¼Œä½ è¿˜å¯ä»¥è‡ªå·±æŠ›ä¸€ä¸ªå¼‚å¸¸å‡ºæ¥ï¼Œç„¶åè®© exception filter å¤„ç†ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/08da56dac87249f8bb87902fa4ef1cbb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=qx4Ogli%2B2aUtjdjrEdM4SP7TLss%3D" alt="image.png" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒçŠ¶æ€ç å’Œ message éƒ½æ”¹äº†ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/435df9e108314c97a7a25bed849fe93a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=fGjiEUM8FZAVu5b6wXE%2BaR%2BJrwI%3D" alt="image.png" loading="lazy"/></p>
<p>ä½ ä¹Ÿå¯ä»¥åŠ ä¸ª @UseFilters æ¥ä½¿ç”¨è‡ªå·±çš„ exception filter å¤„ç†ã€‚</p>
<p>ParseFloatPipe æ˜¯æŠŠå‚æ•°è½¬æ¢ä¸º float ç±»å‹çš„ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b108476801084deaacd3802cbfcff735~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=J7llCXE38JG4Go1WciQTviNj2m0%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-1">ParseArrayPipe</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f3255ec068df4f47a4697c34461b45e8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=aDdAG5Ej7c6sZFVWISRPq3a4hjc%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™æ—¶ä¼šæç¤ºéœ€è¦ <code>class-validator</code> å’Œ <code>class-transformer</code> è¿™ä¸¤ä¸ªåŒ…ï¼Œå‰è€…æ˜¯å¯ä»¥ç”¨è£…é¥°å™¨å’Œéè£…é¥°å™¨ä¸¤ç§æ–¹å¼å¯¹ class å±æ€§åšéªŒè¯çš„åº“ï¼Œåè€…æ˜¯æŠŠæ™®é€šå¯¹è±¡è½¬æ¢ä¸ºå¯¹åº”çš„ class å®ä¾‹çš„åŒ…ã€‚</p>
<pre><code class="hljs language-js" lang="js">npm install -D <span class="hljs-keyword">class</span>-validator <span class="hljs-keyword">class</span>-transformer
</code></pre>
<p>ç„¶åè®¿é—®ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7ad811ab814949048db95af5ebc6a88f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=s6Apv%2FZQW14S6tK1%2FW%2FbvFJbuoM%3D" alt="image.png" loading="lazy"/></p>
<p>ä½ ä¼šå‘ç°å®ƒç¡®å®æŠŠæ¯ä¸€é¡¹éƒ½æå–å‡ºæ¥äº†ï¼Œä½†æ˜¯æ²¡æœ‰è½¬ä¸º numberã€‚</p>
<p>è¿™æ—¶å€™å°±éœ€è¦ç”¨ new XxxPipe çš„æ–¹å¼ä¼ å…¥å‚æ•°äº†ï¼ŒæŒ‡å®š item çš„ç±»å‹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/39fb5c302498496fa32c878dfdc29c16~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=6dPQlbT0a4Fbd9Ae0DDrBh9Uke8%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™æ ·å°±æŠŠæ•°ç»„æ¯ä¸€é¡¹å¤„ç†ä¸º number äº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7141a0808ef94186b1efb52dabfbe8a4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=ADY22dpTF8OkvaS5JOnaviEYYGI%3D" alt="image.png" loading="lazy"/></p>
<p>æ­¤å¤–ï¼Œä½ è¿˜å¯ä»¥æŒ‡å®šåˆ†éš”ç¬¦ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb17a2e27d22421eabc0420c5094215f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=IevaCC2eMnaULv%2BdMSTpqXm4ZGA%3D" alt="image.png" loading="lazy"/></p>
<p>å½“æ²¡æœ‰ä¼ å‚æ•°çš„æ—¶å€™ä¼šæŠ¥é”™ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/314ec5b264f44c26a01e79f91a7fd229~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=AltJhaV7eUX4t5hOppk%2F9fv7yeY%3D" alt="image.png" loading="lazy"/></p>
<p>å¯ä»¥æŠŠå®ƒè®¾ç½®ä¸º optionalï¼Œè¿™æ ·ä¸å¸¦å‚æ•°å°±ä¸ä¼šæŠ¥é”™äº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a87113cbfb814cc4aea4bbeb6543e34c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=rC9ZKAJ5D8FsYLBSuYoutISt0MU%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-2">ParseEnumPipe</h2>
<p>å‡è®¾æˆ‘ä»¬æœ‰è¿™æ ·ä¸€ä¸ªæšä¸¾ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aedb0e602a194a3684ad5bf1aaf07c23~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=bi7Se%2B44Xu78j7iqADIoI2EbgBU%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™ä¸æ˜¯å¤šæ­¤ä¸€ä¸¾ä¹ˆï¼Œæœ¬æ¥ @Param ä¹Ÿèƒ½æŠŠå®ƒå–å‡ºæ¥å‘€ã€‚</p>
<p>ParseEnumPipe è¿˜æ˜¯æœ‰ç”¨çš„ï¼š</p>
<p>ç¬¬ä¸€ä¸ªæ˜¯å¯ä»¥é™åˆ¶å‚æ•°çš„å–å€¼èŒƒå›´ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f5a2ff71196647149046aa54290d8d22~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=gCQx3KW%2Bu8IerSOLcuMqu4KemaI%3D" alt="image.png" loading="lazy"/></p>
<p>å¦‚æœå‚æ•°å€¼ä¸æ˜¯æšä¸¾é‡Œçš„ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p>
<p>è¿™ä¸ªé”™è¯¯è‡ªç„¶ä¹Ÿå¯ä»¥é€šè¿‡ errorHttpStatusCode å’Œ exceptionFactory æ¥å®šåˆ¶ã€‚</p>
<p>ç¬¬äºŒä¸ªæ˜¯å¸®ä½ è½¬æ¢ç±»å‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6161ce0726a54ae598a25832c09001fa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=U8sFeh%2B6cGZa7pWGervcEm1kD2w%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™é‡Œæ‹¿åˆ°çš„å°±ç›´æ¥æ˜¯æšä¸¾ç±»å‹äº†ï¼Œå¦‚æœæœ‰ä¸ªæ–¹æ³•çš„å‚æ•°æ˜¯è¿™æ ·çš„æšä¸¾ç±»å‹ï¼Œå°±å¯ä»¥ç›´æ¥ä¼ å…¥ã€‚</p>
<h2 data-id="heading-3">ParseUUIDPipe</h2>
<p>UUID æ˜¯ä¸€ç§éšæœºç”Ÿæˆçš„å‡ ä¹ä¸å¯èƒ½é‡å¤çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç”¨æ¥åš idã€‚</p>
<p>å®ƒæœ‰ v3ã€v4ã€v5 3 ä¸ªç‰ˆæœ¬ï¼Œæˆ‘ä»¬ç”¨ uuid åŒ…å¯ä»¥ç”Ÿæˆè¿™ç§ idï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/600119af36ee468b81a79e4d318242cc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=r%2B0DhGGVok0NrvpZvfVaF27NWig%3D" alt="image.png" loading="lazy"/></p>
<p>åœ¨å‚æ•°é‡Œï¼Œå¯ä»¥ç”¨ ParseUUIDPipe æ¥æ ¡éªŒæ˜¯å¦æ˜¯ UUIDï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c6991eca3e2e486f9764f252fa7daafe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=mw%2FYhfthQwCd3sK8zzRhvJSOatQ%3D" alt="image.png" loading="lazy"/></p>
<p>å¦‚æœä¸æ˜¯ uuid ä¼šæŠ›å¼‚å¸¸ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a8ab656221ca4f9da7f771053bfffd4b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=quULFoP49BETDYEmh0bZE0cGdKc%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-4">DefaultValuePipe</h2>
<p>è¿™ä¸ªæ˜¯è®¾ç½®å‚æ•°é»˜è®¤å€¼çš„ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6acfc592998e423f9c474cf1e90f350d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=TEOLVmbkfqTFv1M3ilyHHejDkXs%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-5">è‡ªå®šä¹‰Pipe</h2>
<pre><code class="hljs language-js" lang="js">nest g pipe aaa --flat --no-spec
</code></pre>
<p>ç”Ÿæˆä¸€ä¸ª pipeï¼Œæ‰“å°ä¸‹å‚æ•°å€¼ï¼Œè¿”å› aaaï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/39fcd6fda51341899ac4e6fb5e51906b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=m%2FXilsYF7su%2BOgWxzSpmYoK9STw%3D" alt="image.png" loading="lazy"/></p>
<p>åœ¨ handler é‡Œç”¨ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3bc8abb2492141138ef314f590bfb6ac~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=NLX2NyGtlHoEn2XPvJFJufr5HSw%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c03f4bd855c14c23a96b25cde4df5677~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=8uo4idKaeGQB%2BgHKpQV0yQustSg%3D" alt="image.png" loading="lazy"/></p>
<p>è¿”å›çš„å€¼æ˜¯ aaaaaaï¼Œä¹Ÿå°±æ˜¯è¯´ pipe çš„è¿”å›å€¼å°±æ˜¯ä¼ ç»™ handler çš„å‚æ•°å€¼ã€‚</p>
<p>æ‰“å°çš„ value å°±æ˜¯ queryã€param çš„å€¼ï¼Œè€Œ metadata é‡ŒåŒ…å« typeã€metatypeã€dataï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e6e202d4c1a14085884ea9fb9d2fd882~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=jvnDL3QMeaUyWHiX0CBRtgw3UaE%3D" alt="image.png" loading="lazy"/></p>
<p>type å°±æ˜¯ @Queryã€@Paramã€@Body è£…é¥°å™¨ï¼Œæˆ–è€…è‡ªå®šä¹‰è£…é¥°å™¨ã€‚</p>
<p>è€Œ metatype æ˜¯å‚æ•°çš„ ts ç±»å‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d112289c6e148969207d36914b94e50~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=Nl%2Fm3f0zM%2Bgse342mI0fzbTrbto%3D" alt="image.png" loading="lazy"/></p>
<p>data æ˜¯ä¼ ç»™ @Queryã€@Paramã€@Body ç­‰è£…é¥°å™¨çš„å‚æ•°ã€‚</p>
<p>æœ‰äº†è¿™äº›ä¸œè¥¿ï¼Œåšä¸€ä¸‹éªŒè¯ï¼ŒæŠ›å‡ºå¼‚å¸¸ç»™ exception filter å¤„ç†ï¼Œæˆ–è€…å¯¹ value åšäº›è½¬æ¢å†ä¼ ç»™ handler å°±éƒ½æ˜¯å¾ˆç®€å•çš„äº‹æƒ…äº†ã€‚</p>
<h2 data-id="heading-6">ValidatetionPipe</h2>
<p>ä¸Šé¢å­¦äº† pipe æ¥å¯¹å‚æ•°åšéªŒè¯å’Œè½¬æ¢ï¼Œ<strong>ä½†é‚£äº›éƒ½æ˜¯ get è¯·æ±‚çš„å‚æ•°ï¼Œå¦‚æœæ˜¯ post è¯·æ±‚å‘¢ï¼Ÿ</strong></p>
<p>post è¯·æ±‚çš„æ•°æ®æ˜¯é€šè¿‡ @Body è£…é¥°å™¨æ¥å–ï¼Œå¹¶ä¸”è¦æœ‰ä¸€ä¸ª dto class æ¥æ¥æ”¶ï¼š</p>
<p>ï¼ˆdto æ˜¯ data transfer objectï¼Œæ•°æ®ä¼ è¾“å¯¹è±¡ï¼Œç”¨äºå°è£…è¯·æ±‚ä½“çš„æ•°æ®ï¼‰</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1e954c05edec4a1cbd7620d2af194cde~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=iztwJVBlej9IOV5HfurtgU8sKS8%3D" alt="image.png" loading="lazy"/></p>
<p>æˆ‘ä»¬ç”¨ postman æ¥å‘ä¸ª post è¯·æ±‚ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc49848e4caf48238591d56a283a7cd6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=nMnqV9WDvJZ29zTCqGTRMZ78fPY%3D" alt="image.png" loading="lazy"/></p>
<p>content-type æŒ‡å®šä¸º jsonã€‚</p>
<p>ç‚¹å‡» sendï¼Œå°±å¯ä»¥çœ‹åˆ°æœåŠ¡ç«¯æ¥æ”¶åˆ°äº†æ•°æ®ï¼Œå¹¶ä¸”<strong>æŠŠå®ƒè½¬ä¸ºäº† dto ç±»çš„å¯¹è±¡</strong>ã€‚</p>
<p>ä½†å¦‚æœæˆ‘ä»¬ age ä¼ ä¸€ä¸ªæµ®ç‚¹æ•°ï¼ŒæœåŠ¡ç«¯ä¹Ÿèƒ½æ­£å¸¸æ¥æ”¶ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e04d87ebca5404e8589d09e61d421e7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=dk8U47fMU7b21rTw2PtyZwqiS%2Fk%3D" alt="image.png" loading="lazy"/></p>
<p>å› ä¸ºå®ƒä¹Ÿæ˜¯ numberã€‚</p>
<p>è€Œè¿™å¾ˆå¯èƒ½ä¼šå¯¼è‡´åç»­çš„é€»è¾‘å‡ºé”™ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬è¦å¯¹ä»–åšå‚æ•°éªŒè¯ã€‚</p>
<p>æ€ä¹ˆåšå‘¢ï¼Ÿ</p>
<p>è¿™å°±éœ€è¦ç”¨åˆ° ValidationPipe äº†ã€‚</p>
<p>å®ƒéœ€è¦ä¸¤ä¸ªä¾èµ–åŒ…ï¼š</p>
<pre><code class="hljs language-js" lang="js">npm install <span class="hljs-keyword">class</span>-validator <span class="hljs-keyword">class</span>-transformer
</code></pre>
<p>ç„¶ååœ¨ @Body é‡Œæ·»åŠ è¿™ä¸ª pipeï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/17eb6c93a5f94f8a97cb7d70767576a3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=gc7OKEyKEVgw7Gmf4yQiL2buNFk%3D" alt="image.png" loading="lazy"/></p>
<p>åœ¨ dto è¿™é‡Œï¼Œç”¨ class-validator åŒ…çš„ @IsInt è£…é¥°å™¨æ ‡è®°ä¸€ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e253ebd3fea9458eb98d82bf9d52f17d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=r2mVE3yzrCzTObCFvJjQzx8W%2FVs%3D" alt="image.png" loading="lazy"/></p>
<p>å†æ¬¡è¯·æ±‚ï¼Œä½ å°±ä¼šå‘ç°å®ƒæ£€æŸ¥å‡ºäº†å‚æ•°é‡Œçš„é”™è¯¯ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b7e15efaec184526a2f3c95819ab9ef4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=cbAmiCXhi0lSpvljUx5C%2FL9Hx%2BU%3D" alt="image.png" loading="lazy"/></p>
<p>é‚£å®ƒæ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿ</p>
<p>class-validatorÂ åŒ…æä¾›äº†åŸºäºè£…é¥°å™¨å£°æ˜çš„è§„åˆ™å¯¹å¯¹è±¡åšæ ¡éªŒçš„åŠŸèƒ½ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ceb1dded526a473db5209e3d78a11b58~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=lDv8ESjpSN8dFUZrAcUsJGLKYqI%3D" alt="image.png" loading="lazy"/></p>
<p>è€ŒÂ class-transformerÂ åˆ™æ˜¯æŠŠä¸€ä¸ªæ™®é€šå¯¹è±¡è½¬æ¢ä¸ºæŸä¸ª class çš„å®ä¾‹å¯¹è±¡çš„ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5796355609c648d6ba4a653e377ba653~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=wKeI2Y94mmCPGVL6Mlx3CcjwXpY%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™ä¸¤è€…ä¸€ç»“åˆï¼Œé‚£ ValidationPipe æ˜¯æ€ä¹ˆå®ç°çš„ä¸å°±æƒ³æ˜ç™½äº†ä¹ˆï¼š</p>
<p><strong>æˆ‘ä»¬å£°æ˜äº†å‚æ•°çš„ç±»å‹ä¸º dto ç±»ï¼Œpipe é‡Œæ‹¿åˆ°è¿™ä¸ªç±»ï¼ŒæŠŠå‚æ•°å¯¹è±¡é€šè¿‡ class-transformer è½¬æ¢ä¸º dto ç±»çš„å¯¹è±¡ï¼Œä¹‹åå†ç”¨ class-validator åŒ…æ¥å¯¹è¿™ä¸ªå¯¹è±¡åšéªŒè¯ã€‚</strong></p>
<p>æˆ‘ä»¬è‡ªå·±å†™å†™çœ‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">PipeTransform</span>, <span class="hljs-title class_">Injectable</span>, <span class="hljs-title class_">ArgumentMetadata</span>, <span class="hljs-title class_">BadRequestException</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { validate } <span class="hljs-keyword">from</span> <span class="hljs-string">'class-validator'</span>;
<span class="hljs-keyword">import</span> { plainToInstance } <span class="hljs-keyword">from</span> <span class="hljs-string">'class-transformer'</span>;

@<span class="hljs-title class_">Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyValidationPipe</span> implements <span class="hljs-title class_">PipeTransform</span>&lt;any&gt; {
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">transform</span>(<span class="hljs-params">value: any, { metatype }: ArgumentMetadata</span>) {
    <span class="hljs-keyword">if</span> (!metatype) {
      <span class="hljs-keyword">return</span> value;
    }
    <span class="hljs-comment">// æŠŠå‚æ•°å€¼è½¬åŒ–ä¸ºclass Ooo çš„å®ä¾‹</span>
    <span class="hljs-keyword">const</span> object = <span class="hljs-title function_">plainToInstance</span>(metatype, value);
    <span class="hljs-comment">// ç„¶åå°±å¯ä»¥è¿›è¡ŒéªŒè¯äº†</span>
    <span class="hljs-keyword">const</span> errors = <span class="hljs-keyword">await</span> <span class="hljs-title function_">validate</span>(object);
    <span class="hljs-keyword">if</span> (errors.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BadRequestException</span>(<span class="hljs-string">'å‚æ•°éªŒè¯å¤±è´¥'</span>);
    }
    <span class="hljs-keyword">return</span> value;
  }
}

</code></pre>
<p>metatype ä¸ºå‚æ•°çš„ç±»å‹ï¼Œä¹Ÿå°±æ˜¯ class Ooo:</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e3156dff334d48d887f8435badf1709d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=ispY8W28pEjATdrb%2FR7QwVqUw2I%3D" alt="image.png" loading="lazy"/></p>
<p>å¦‚æœæ²¡æœ‰å£°æ˜è¿™éƒ¨åˆ†ï¼Œé‚£å°±æ²¡æ³•è½¬æ¢å’ŒéªŒè¯ï¼Œç›´æ¥è¿”å› valueã€‚</p>
<p>å¦åˆ™ï¼Œé€šè¿‡ class-transformer åŒ…çš„ plainToInstance æŠŠæ™®é€šå¯¹è±¡è½¬æ¢ä¸º dto class çš„å®ä¾‹å¯¹è±¡ã€‚</p>
<p>ä¹‹åè°ƒç”¨ class-validator åŒ…çš„ validate api å¯¹å®ƒåšéªŒè¯ã€‚å¦‚æœéªŒè¯ä¸é€šè¿‡ï¼Œå°±æŠ›ä¸€ä¸ªå¼‚å¸¸ã€‚</p>
<p>æ›¿æ¢ä¸ºæˆ‘ä»¬è‡ªå·±å®ç°çš„ MyValidationPipeã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/05b3856d22334a318450110ac7882dcc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=20wevgwyO5L4Tt73mRd23mkHveU%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9276cbeb3a574dc6a21567d3c16aa6e1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=XqUZMv40WRAgzpn7b%2BOkCan%2BNss%3D" alt="image.png" loading="lazy"/></p>
<p>ç¡®å®æ£€æŸ¥å‡ºäº†é”™è¯¯ã€‚</p>
<p>å½“ç„¶ï¼Œæˆ‘ä»¬åšçš„å¹¶ä¸å¤Ÿå®Œå–„ï¼Œè¿˜æ˜¯ç›´æ¥ç”¨å†…ç½®çš„ ValidationPipe å¥½äº†ã€‚</p>
<p>pipe é‡Œä¹Ÿæ˜¯å¯ä»¥æ³¨å…¥ä¾èµ–çš„ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5cf809c4c69548d59361119ad70c6237~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=MVSPZ3pA9BOC6Kuae5sY104t0rw%3D" alt="image.png" loading="lazy"/></p>
<p>æ¯”å¦‚ï¼Œæˆ‘ä»¬æŒ‡å®š @Inject æ³¨å…¥ token ä¸º validation_options çš„å¯¹è±¡ã€‚</p>
<p>å› ä¸ºæ ‡è®°äº† @Optionalï¼Œæ²¡æ‰¾åˆ°å¯¹åº”çš„ provider ä¹Ÿä¸ä¼šæŠ¥é”™ã€‚</p>
<p>ä½†å½“æˆ‘ä»¬åœ¨ module é‡Œæ·»åŠ äº†è¿™ä¸ª providerï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9c02ea288b2d40b3b9e8c5d200638c9b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=zG4LqByPvqGSQDORIOCCjzq8WAI%3D" alt="image.png" loading="lazy"/></p>
<p>å°±å¯ä»¥æ­£å¸¸æ³¨å…¥äº†ã€‚</p>
<p>å½“ç„¶ï¼Œè¿™ç§æ–¹å¼å°±ä¸èƒ½ç”¨ new çš„æ–¹å¼äº†ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9d45518141e048f5a31db016f969d057~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=aaxUj%2BsyhmfXHdjxigoOPac3PfA%3D" alt="image.png" loading="lazy"/></p>
<p>ç›´æ¥æŒ‡å®š classï¼Œè®© Nest å»åˆ›å»ºå¯¹è±¡æ”¾åˆ° ioc å®¹å™¨é‡Œã€‚</p>
<p>å¦‚æœæ˜¯å…¨å±€çš„ pipeï¼Œè¦é€šè¿‡è¿™ç§æ–¹å¼æ¥åˆ›å»ºæ‰èƒ½æ³¨å…¥ä¾èµ–ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f9f42ed1439f42ea94d56ebd7763bae8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=5h9yqUTxsFia0ovspkt%2BU4uurPk%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™å°±å’Œæˆ‘ä»¬ä¹‹å‰åˆ›å»ºå…¨å±€ interceptor ä¸€æ ·ã€‚</p>
<p>åŒç†ï¼Œå…¶ä½™çš„ filterã€guard ä¹Ÿå¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼å£°æ˜ä¸ºå…¨å±€ç”Ÿæ•ˆçš„ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb1ea6ff68d548b1b96ba93de9d5407b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=oXh7uXPfuLyvQcwgsHK6EH%2FNGx8%3D" alt="image.png" loading="lazy"/></p>
<p>ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥æŠŠ handler é‡Œçš„ ValidationPipe å»æ‰äº†</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a9bb2e31113c4935b5c5c73d2db394c0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=C0yKZhUa171JPnl3fbZb8tgfPKU%3D" alt="image.png" loading="lazy"/></p>
<p>å†æ¬¡è®¿é—®ï¼Œå®ƒä¾ç„¶æ˜¯ç”Ÿæ•ˆçš„ã€‚</p>
<p>ä¼šç”¨ ValidationPipe ä¹‹åï¼Œæˆ‘ä»¬å›è¿‡å¤´æ¥å†çœ‹çœ‹ class-validator éƒ½æ”¯æŒå“ªäº›éªŒè¯æ–¹å¼ï¼š</p>
<p>æˆ‘ä»¬å£°æ˜è¿™æ ·ä¸€ä¸ª dto classï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Contains</span>, <span class="hljs-title class_">IsDate</span>, <span class="hljs-title class_">IsEmail</span>, <span class="hljs-title class_">IsFQDN</span>, <span class="hljs-title class_">IsInt</span>, <span class="hljs-title class_">Length</span>, <span class="hljs-title class_">Max</span>, <span class="hljs-title class_">Min</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'class-validator'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Ppp</span> {
    @<span class="hljs-title class_">Length</span>(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>)
    <span class="hljs-attr">title</span>: string;
  
    @<span class="hljs-title class_">Contains</span>(<span class="hljs-string">'hello'</span>)
    <span class="hljs-attr">text</span>: string;
  
    @<span class="hljs-title class_">IsInt</span>()
    @<span class="hljs-title class_">Min</span>(<span class="hljs-number">0</span>)
    @<span class="hljs-title class_">Max</span>(<span class="hljs-number">10</span>)
    <span class="hljs-attr">rating</span>: number;
  
    @<span class="hljs-title class_">IsEmail</span>()
    <span class="hljs-attr">email</span>: string;
  
    @<span class="hljs-title class_">IsFQDN</span>()
    <span class="hljs-attr">site</span>: string;
}
</code></pre>
<p>å…¶ä¸­ @IsFQDN æ˜¯æ˜¯å¦æ˜¯åŸŸåçš„æ„æ€ã€‚</p>
<p>ç„¶åæ·»åŠ ä¸€ä¸ª post çš„ handlerï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1cb8ebc92e56404791a947389c5c36a6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=mB4gJrsA9k7sXXovwECTN%2BwB1no%3D" alt="image.png" loading="lazy"/></p>
<p>å½“å‚æ•°ä¸æ­£ç¡®ï¼ŒValidationPipe å°±ä¼šè¿”å› class-validator çš„æŠ¥é”™ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c9a25a99c475479cab2d0e1f1c18a77a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=Jqr%2Ft9AN9CvRxNZWr0rJDVyfDSc%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™ä¸ªé”™è¯¯æ¶ˆæ¯ä¹Ÿæ˜¯å¯ä»¥å®šåˆ¶çš„ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/39341b3c48cb4c979589f7ed35b95b9b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=i0HjI5%2BhXC%2B8Yof5Y8Vp2hinHfA%3D" alt="image.png" loading="lazy"/></p>
<p>æ·»åŠ ä¸€ä¸ª options å¯¹è±¡ï¼Œä¼ å…¥ message å‡½æ•°ï¼Œæ‰“å°ä¸‹å®ƒçš„å‚æ•°ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/270e638cebb54644ab1e871f30401e61~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=rXE4ZfHM%2FV0eFLUmshWKNq1Wb%2Bc%3D" alt="image.png" loading="lazy"/></p>
<p>å¯ä»¥æ‹¿åˆ°å¯¹è±¡ã€å±æ€§åã€å±æ€§å€¼ã€class åç­‰å„ç§ä¿¡æ¯ï¼Œç„¶åä½ å¯ä»¥è¿”å›è‡ªå®šä¹‰çš„ messageï¼š</p>
<pre><code class="hljs language-js" lang="js">@<span class="hljs-title class_">Length</span>(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, {
    <span class="hljs-title function_">message</span>(<span class="hljs-params">{targetName, property, value, constraints}</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${targetName}</span> ç±»çš„ <span class="hljs-subst">${property}</span> å±æ€§çš„å€¼ <span class="hljs-subst">${value}</span> ä¸æ»¡è¶³çº¦æŸ: <span class="hljs-subst">${constraints}</span>`</span>
    }
})
<span class="hljs-attr">title</span>: string;
</code></pre>
<p>å†æ¬¡è®¿é—®ï¼Œè¿”å›çš„å°±æ˜¯è‡ªå®šä¹‰çš„é”™è¯¯æ¶ˆæ¯ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6b6ccf23823d41d9949492557e1223e2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174304&amp;x-signature=ACvXfYaTcpIKjnlaUrEwZxXeE38%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-7">æ€»ç»“</h2>
<p>æ¥æ”¶ post è¯·æ±‚çš„æ–¹å¼æ˜¯å£°æ˜ä¸€ä¸ª dto classï¼Œç„¶åé€šè¿‡ @Body æ¥å–è¯·æ±‚ä½“æ¥æ³¨å…¥å€¼ã€‚</p>
<p>å¯¹å®ƒåšéªŒè¯è¦ä½¿ç”¨ ValidationPipeã€‚</p>
<p>å®ƒçš„å®ç°åŸç†æ˜¯åŸºäº class-tranformer æŠŠå‚æ•°å¯¹è±¡è½¬æ¢ä¸º dto class çš„å¯¹è±¡ï¼Œç„¶åé€šè¿‡ class-validator åŸºäºè£…é¥°å™¨å¯¹è¿™ä¸ªå¯¹è±¡åšéªŒè¯ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥è‡ªå·±å®ç°è¿™æ ·çš„ pipeï¼Œpipe é‡Œå¯ä»¥æ³¨å…¥ä¾èµ–ã€‚</p>
<p>å¦‚æœæ˜¯å…¨å±€ pipe æƒ³æ³¨å…¥ä¾èµ–ï¼Œéœ€è¦é€šè¿‡ APP_PIPE çš„ token åœ¨ AppModule é‡Œå£°æ˜ providerã€‚</p>
<p>class-validator æ”¯æŒå¾ˆå¤šç§éªŒè¯è§„åˆ™ï¼Œæ¯”å¦‚é‚®ç®±ã€åŸŸåã€é•¿åº¦ã€å€¼çš„èŒƒå›´ç­‰ï¼Œè€Œä¸”é”™è¯¯æ¶ˆæ¯ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ã€‚</p>
<p>ValidationPipe æ˜¯éå¸¸å¸¸ç”¨çš„ pipeï¼Œåé¢ä¼šå¤§é‡ç”¨åˆ°ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è¯•ç”¨ opencodeä¸€å‘¨ï¼Œæˆ‘æŠŠ Claude Code æ‰”äº†ï¼ˆé™„opencodeå®‰è£…æŒ‡å—ï¼‰]]></title>    <link>https://juejin.cn/post/7599965904617242670</link>    <guid>https://juejin.cn/post/7599965904617242670</guid>    <pubDate>2026-01-28T03:07:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599965904617242670" data-draft-id="7599640782569259035" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è¯•ç”¨ opencodeä¸€å‘¨ï¼Œæˆ‘æŠŠ Claude Code æ‰”äº†ï¼ˆé™„opencodeå®‰è£…æŒ‡å—ï¼‰"/> <meta itemprop="keywords" content="AIç¼–ç¨‹,Claude"/> <meta itemprop="datePublished" content="2026-01-28T03:07:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é™ˆä½¬æ˜”ç¼–ç¨‹äººç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/3087084378402445"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è¯•ç”¨ opencodeä¸€å‘¨ï¼Œæˆ‘æŠŠ Claude Code æ‰”äº†ï¼ˆé™„opencodeå®‰è£…æŒ‡å—ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3087084378402445/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é™ˆä½¬æ˜”ç¼–ç¨‹äººç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T03:07:02.000Z" title="Wed Jan 28 2026 03:07:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¶ç€ Claude Code å°é”ç¬¬ä¸‰æ–¹å·¥å…·çš„çƒ­åº¦ï¼ŒOpenCode ç€å®ç«äº†ä¸€æŠŠã€‚ç­‰è¿™é˜µé£å¤´è¿‡å»ï¼Œæˆ‘æ‰æ…¢æ‚ æ‚ åœ°å¼€å§‹è¯•ç”¨ï¼Œæƒ³å°½é‡é¿å¼€æƒ…ç»ªæ»¤é•œï¼Œçœ‹çœ‹å®ƒåˆ°åº•æœ‰å‡ æ–¤å‡ ä¸¤ã€‚</p>
<p>è¿™ä¸€å‘¨ï¼Œæˆ‘ä¸»è¦ç”¨å®ƒå¹²äº†ä¿©æ´»å„¿ï¼šä¸€ä¸ªæ˜¯å¼€å‘è‹¹æœ Appï¼Œå¦ä¸€ä¸ªæ˜¯æä¸€ä¸ªç”µå•†é¡¹ç›®ã€‚</p>
<p>è¯´å®è¯ï¼Œè‹¹æœ App çš„å¼€å‘ä½“éªŒå¹³å¹³æ— å¥‡ï¼Œæ²¡è®©æˆ‘è§‰å¾—æœ‰å¤šæƒŠè‰³ã€‚ä½†åˆ°äº†ç”µå•†é¡¹ç›®è¿™é‡Œï¼Œç”»é£çªå˜â€”â€”ä»…ä»…ç”¨äº†æœ€åŸºç¡€çš„ â€œPlanâ€ æ¨¡å¼ï¼Œå¼€å‘é€Ÿåº¦å±…ç„¶æ¯” Claude Code è¿˜å¿«ï¼</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5b2e4a6ae0ae45b7b062e4f9328f27a3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZmI5L2s5piU57yW56iL5Lq655Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174422&amp;x-signature=1W7BaeyAbXOpY6lqEIa6f95gJ9E%3D" alt="ç½‘ç«™.jpg" loading="lazy"/></p>
<p>è¿™ä¸å¯¹åŠ²å•Šï¼Ÿæˆ‘èµ¶ç´§å»æŸ¥äº†æŸ¥èµ„æ–™ã€‚å¥½å®¶ä¼™ï¼ŒåŸæ¥ OpenCode è‡ªå¸¦äº†ä¸€ä¸ªç§˜å¯†æ­¦å™¨ï¼š<strong>LSPï¼ˆè¯­è¨€æœåŠ¡å™¨ï¼‰</strong>ã€‚æœ‰äº†å®ƒï¼ŒAI å†™ä»£ç å°±ä»â€œé—­çœ¼ç›²æ‰“ã€å…¨é è’™â€å˜æˆäº†â€œæ‰‹æ‹¿åœ°å›¾ã€ç²¾å‡†å¯¼èˆªâ€ï¼Œæ•ˆç‡ç›´æ¥èµ·é£ã€‚</p>
<p>ä¸è¿‡ï¼ŒOpenCode è‡ªå¸¦çš„ LSP æ”¯æŒçš„è¯­è¨€æœ‰é™ã€‚è¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆå¯¹ Swift æ”¯æŒä¸€èˆ¬çš„è‹¹æœ App é¡¹ç›®ï¼Œä½“éªŒåè€Œä¸å¦‚åŸºäº TypeScript çš„ç”µå•†é¡¹ç›®æ¥å¾—çˆ½å¿«ã€‚</p>
<p>ï¼ˆé¡ºå¸¦ä¸€æï¼ŒClaude Code å…¶å®ä¹Ÿæ”¯æŒ LSPï¼Œä½†éœ€è¦è‡ªå·±æ‰‹åŠ¨å®‰è£…ï¼Œè€Œä¸”æ ¹æ®å‰ä¸¤å‘¨å…¶ä»–åšä¸»çš„æµ‹è¯•è§†é¢‘æ¥çœ‹ï¼Œè°ƒç”¨æˆåŠŸç‡ä¸å¤ªç¨³å®šã€‚ï¼‰</p>
<p>æ›´è®©æˆ‘æƒŠå–œçš„æ˜¯ï¼ŒClaude Code é‚£äº›å¼•ä»¥ä¸ºå‚²çš„ Commandsã€Skillsã€Agents åŠŸèƒ½ï¼ŒOpenCode å…¨éƒ½æœ‰ï¼Œé…ç½®æ–‡ä»¶å¤åˆ¶ç²˜è´´è¿‡æ¥å³å¯ï¼Œæ— ç¼åˆ‡æ¢.ã€‚ç”šè‡³ä½ å¦‚æœä¸åšä¿®æ”¹ï¼ŒOpenCode ä¹Ÿä¼šåšå…¼å®¹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d3a72a8a09334fe68fd172798e75cc35~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZmI5L2s5piU57yW56iL5Lq655Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174422&amp;x-signature=8OL571m6DnKpXyUS7dInu%2FU4mZ4%3D" alt="è¯•ç”¨ opencodeä¸€å‘¨æˆ‘æŠŠ Claude Code æ‰”äº†é™„opencodeå®‰è£…æŒ‡å—-å…¼å®¹claudecode.png" loading="lazy"/></p>
<p>Claude Code è¿™æ³¢å°é”æ“ä½œï¼Œåè€Œæš´éœ²äº†è‡ªå·±çš„ç„¦è™‘ï¼Œä¹Ÿè¯æ˜äº† Agent å¼€å‘æœ¬èº«å¹¶æ— å¤ªé«˜é—¨æ§›ã€‚è¿™ä¸€æ‹›â€œé—­å…³é”å›½â€ï¼Œå€’æ˜¯ç»™ OpenCode åšäº†ä¸€æ¬¡å®Œç¾çš„å…è´¹å®£ä¼ ã€‚</p>
<p>è¯•ç”¨ä¸€å‘¨ä¸‹æ¥ï¼Œæˆ‘çš„ç»“è®ºæ˜¯ï¼š<strong>OpenCode å®Œå…¨æœ‰èƒ½åŠ›æˆä¸º Claude Code çš„å¹³æ›¿ï¼Œç”šè‡³åœ¨æŸäº›æ–¹é¢ä½“éªŒæ›´ä½³ã€‚</strong></p>
<p>å¦‚æœæ„Ÿå…´è¶£ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢æ•™ç¨‹ï¼Œå®‰è£…ä½¿ç”¨  OpenCodeï¼š</p>
<h2 data-id="heading-0">0. ç¯å¢ƒå®‰è£…</h2>
<p>opencode éœ€è¦åœ¨ Node.js 22 + çš„æœºå™¨ä¸Šè·‘ã€‚</p>
<p>åœ¨å‘½ä»¤è¡Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œç‰ˆæœ¬å·å¤§äº 22 å³å¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">node -v
</code></pre>
<p>å¦‚æœå·²ç»å®‰è£…ï¼Œå¹¶ä¸”ç‰ˆæœ¬æ­£ç¡®å¯ä»¥ç»§ç»­ä¸‹ä¸€æ­¥ã€‚</p>
<p>å¦‚æœéœ€è¦å®‰è£…æˆ–å‡çº§ï¼Œåˆ™å¯åˆ° <a href="https://link.juejin.cn?target=https%3A%2F%2Fnodejs.org%2Fzh-cn%2Fdownload" target="_blank" title="https://nodejs.org/zh-cn/download" ref="nofollow noopener noreferrer">nodejs.org/zh-cn/downlâ€¦</a> ä¸‹è½½å¹¶å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ Node.jsã€‚</p>
<h2 data-id="heading-1">1. opencode å®‰è£…</h2>
<p>å¦‚æœå·²ç»å®‰è£…å¯ä»¥è·³è¿‡ã€‚</p>
<p>å¦‚æœæ²¡æœ‰ï¼Œåˆ™å¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œå®‰è£…</p>
<pre><code class="hljs language-bash" lang="bash">npm install -g @anthropic-ai/claude-code
</code></pre>
<p>é™¤äº†å‘½ä»¤è¡Œï¼Œopencode ä¹Ÿæœ‰æ’ä»¶å’Œæ¡Œé¢ç«¯ã€‚</p>
<h3 data-id="heading-2">æ¡Œé¢ç«¯</h3>
<p>æ¡Œé¢ç«¯ä¹Ÿæ˜¯ä»–æ¯” Claude codeæ›´å¥½ç”¨çš„ä¸€ä¸ªç‰¹ç‚¹ã€‚ å¯¹äºæ¯«æ— å¼€å‘ç»éªŒçš„äº§å“ç»ç†æˆ–æ™®é€šäººï¼Œä½¿ç”¨æ¡Œé¢ç‰ˆæ˜¯æœ€å¥½çš„ã€‚æ¯•ç«Ÿèƒ½ç”¨é¼ æ ‡ï¼Œæ•´ä¸ªæ“ä½œç®€å•å¾ˆå¤šã€‚åé¢æ“ä½œä¹Ÿä¼šä»¥æ¡Œé¢ç«¯ä¸ºä¾‹ã€‚æ¨èå®‰è£…ï¼</p>
<p>ä¸‹è½½åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fopencode.ai%2Fdownload" target="_blank" title="https://opencode.ai/download" ref="nofollow noopener noreferrer">opencode.ai/download</a></p>
<p>åœ¨ OpenCode Desktop (Beta) ä¸‹ï¼Œé€‰æ‹©æ“ä½œç³»ç»Ÿå¯¹åº”çš„å®‰è£…åŒ…ä¸‹è½½ã€‚</p>
<h3 data-id="heading-3">æ’ä»¶å®‰è£…</h3>
<p>å¯¹åº”è¿˜æ˜¯éœ€è¦çœ‹ä»£ç çš„ç¨‹åºå‘˜ï¼Œåˆ™åœ¨ IDE æ’ä»¶å¸‚åœºï¼Œæœç´¢é€‰æ‹© opencode å®‰è£…ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/07842fa92950439c92ee37c75a19c7e2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZmI5L2s5piU57yW56iL5Lq655Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174422&amp;x-signature=z9nQEuOrb5tXp5CIOd7Vx%2FT%2Fq9I%3D" alt="è¯•ç”¨ opencode ä¸€å‘¨æˆ‘æŠŠ Claude Code æ‰”äº†é™„opencodeå®‰è£…æŒ‡å—-opencodeæŒ‡å—.png" loading="lazy"/></p>
<h2 data-id="heading-4">2. è®¢é˜…å¤§æ¨¡å‹å¥—é¤</h2>
<p>OpenCode æ¯”è¾ƒè‡ªç”±ï¼Œæ™®é€šçš„å¤§æ¨¡å‹ API ä¹Ÿèƒ½ä½¿ç”¨ã€‚ä¸è¿‡è¿˜æ˜¯æ¨èæ”¯æŒ Coding Plan çš„å¤§æ¨¡å‹ã€‚æ¯•ç«Ÿç¼–ç¨‹å·¥å…·çš„ä½¿ç”¨é‡å¾ˆå¤§ï¼Œä¸€èˆ¬çš„ API å¯èƒ½å¾ˆå¿«å°±è¢«æ¶ˆè€—å…‰ã€‚</p>
<p>å›½å†…æ¨èä½¿ç”¨ GLM å¤§æ¨¡å‹æˆ– MiniMax å¤§æ¨¡å‹çš„ Coding Plan å¥—é¤ã€‚ä¹°å“ªä¸ªå¥—é¤è‡ªè¡Œå†³å®šã€‚ä¹Ÿå¯ä»¥éƒ½è®¢é˜…ä¸€ä¸ªæœˆå°è¯•ï¼Œåé¢å†å–æ¶ˆã€‚<strong>å¯ä»¥ä»æœ€ä¾¿å®œçš„å¥—é¤å¼€å§‹ï¼Œéœ€è¦å†å‡çº§ã€‚</strong></p>
<h3 data-id="heading-5">MiniMax</h3>
<p>Starter 29å…ƒ/æœˆï¼ŒPlus 49å…ƒ/æœˆï¼ŒMax 119å…ƒ/æœˆã€‚è®¢é˜…åœ°å€ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.minimaxi.com%2Fsubscribe%2Fcoding-plan" target="_blank" title="https://platform.minimaxi.com/subscribe/coding-plan" ref="nofollow noopener noreferrer">platform.minimaxi.com/subscribe/câ€¦</a></p>
<h3 data-id="heading-6">GLM</h3>
<p>Lite 40å…ƒ/æœˆï¼ŒPro 200å…ƒ/æœˆï¼ŒMax 400å…ƒ/æœˆï¼Œç›®å‰é¦–æœˆåŠä»·ã€‚è®¢é˜…åœ°å€ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fbigmodel.cn%2Fglm-coding" target="_blank" title="https://bigmodel.cn/glm-coding" ref="nofollow noopener noreferrer">bigmodel.cn/glm-coding</a></p>
<h2 data-id="heading-7">3. API Key è·å–</h2>
<p>åœ¨ä¸Šé¢è®¢é˜…å¥—é¤çš„ï¼Œä»¥ä¸‹ä»¥ MiniMax å›½å†…ç«™ä¸ºä¾‹ã€‚</p>
<p>è¿›å…¥å®˜ç½‘ï¼Œç™»å½•åï¼Œè¿›å…¥è´¦æˆ·ç®¡ç†ï¼Œç‚¹å‡»å·¦ä¾§èœå•â€œè®¢é˜…ç®¡ç†â€ä¸‹æ–¹çš„ Coding Planã€‚</p>
<p>æ­¤æ—¶å‡ºæ¥çš„é¡µé¢ï¼Œä¾¿èƒ½çœ‹åˆ° API Key äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14c5d77d50a64b7ea852b240afb0153c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZmI5L2s5piU57yW56iL5Lq655Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174422&amp;x-signature=5MWfdYWxOp7l%2FQeAzUGXPygRYPQ%3D" alt="Claude Code è½»æ¾æ¥å…¥å›½å†…æ¨¡å‹-coding Plan.png" loading="lazy"/></p>
<p>ç‚¹å‡»é‡ç½®å¹¶å¤åˆ¶å³å¯ã€‚</p>
<h2 data-id="heading-8">4. å¼€å§‹ä½¿ç”¨</h2>
<p>OpenCode æ˜¯ä»¥é¡¹ç›®ä¸ºå•ä½è¿›è¡Œå¼€å‘çš„ï¼Œé€‰æ‹©ä»ä¸€ä¸ªæ–‡ä»¶å¤¹æˆ–è€…æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å¼€å§‹éƒ½å¯ä»¥ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e4a9f72645f412aaf358d5a8937399f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZmI5L2s5piU57yW56iL5Lq655Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174422&amp;x-signature=lvqaeHciqJhLFQDnWzsJkzyhD5Y%3D" alt="è¯•ç”¨ opencode ä¸€å‘¨æˆ‘æŠŠ Claude Code æ‰”äº†é™„opencodeå®‰è£…æŒ‡å—-æ¡Œé¢ç‰ˆç•Œé¢.png" loading="lazy"/></p>
<p>OpenCode ä¹Ÿä¼šåŸºäºä½ ç³»ç»Ÿçš„è¯­è¨€ï¼Œå±•ç¤ºç•Œé¢ï¼Œå¦‚æœæ²¡æœ‰å‡ºç°ä¸­æ–‡ï¼Œå¯ä»¥åœ¨è®¾ç½®ä¸­è¿›è¡Œä¿®æ”¹ã€‚</p>
<p>å¦å¤–ï¼Œä¹Ÿæä¾›äº† 10å¤šä¸ªä¸»é¢˜ä¾›é€‰æ‹©ï¼Œå¯¹ä¸å–œæ¬¢é»‘è‰²ç•Œé¢çš„ï¼Œå¯ä»¥æ‰¾æ‰¾è‡ªå·±æ›´å–œæ¬¢çš„ä¸»é¢˜ã€‚</p>
<h3 data-id="heading-9">5. æ¥å…¥æ¨¡å‹</h3>
<p>opencode æ¥å…¥æ¨¡å‹æ¯” Claude codeç®€å•ã€‚</p>
<p>è¿›å…¥é¡¹ç›®ç•Œé¢ä¹‹åï¼Œåœ¨å¯¹è¯æ¡†ï¼Œè¾“å…¥ <code>/modal</code>ï¼Œä¼šå¼¹å‡ºæ¨¡å‹é€‰æ‹©çª—ã€‚</p>
<p>opencode å†…ç½®äº†60å¤šä¸ªå¤§æ¨¡å‹æä¾›å•†ï¼Œç‚¹å‡»â€œæŸ¥çœ‹å…¨éƒ¨ä¾›åº”å•†â€ï¼Œèƒ½çœ‹åˆ°å›½å†…çš„ä¾›åº”å•†ï¼Œé™¤äº†åˆšåˆšæåŠçš„ GLM å’Œ MiniMaxï¼Œè¿˜åŒ…æ‹¬ é˜¿é‡Œå·´å·´ã€Deepseekã€Z.AI ã€æœˆä¹‹æš—é¢ç­‰ç­‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/388df40dcb484e02aa63fc9b166b68c5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZmI5L2s5piU57yW56iL5Lq655Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174422&amp;x-signature=EchOGA27AuZNYrQtinaBRkO3rW4%3D" alt="è¯•ç”¨ opencode ä¸€å‘¨æˆ‘æŠŠ Claude Code æ‰”äº†é™„opencodeå®‰è£…æŒ‡å—-ä¾›åº”å•†.png" loading="lazy"/></p>
<p>å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œä½ åªéœ€è¦ä»ä¾›åº”å•†é‚£è¾¹å¤åˆ¶ api keyå³å¯ã€‚ï¼ˆMiniMax æ³¨æ„åŒºåˆ†å›½å†…å›½å¤–ç«™ï¼‰</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9597758463aa4aeaa6866a0b91897f67~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZmI5L2s5piU57yW56iL5Lq655Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174422&amp;x-signature=RPvl1tWKhGG1VPSw2SMzgoGDE40%3D" alt="è¯•ç”¨ opencode ä¸€å‘¨æˆ‘æŠŠ Claude Code æ‰”äº†é™„opencodeå®‰è£…æŒ‡å—-é€‰æ‹©æ¨¡å‹.png" loading="lazy"/></p>
<p>é…ç½®å®Œæˆï¼Œåœ¨å¯¹è¯æ¡†æ­£å¸¸å¯¹è¯ï¼Œæœ‰è¿”å›ï¼Œé…ç½®å°±æˆåŠŸäº†ï¼</p>
<h2 data-id="heading-10">6. åŸºæœ¬æ“ä½œ</h2>
<h3 data-id="heading-11">Agents</h3>
<p>ç›®å‰æœ‰ä¸¤ä¸ª Agent å’Œ SubAgentï¼š</p>
<ul>
<li>Buildï¼Œé»˜è®¤ Agentï¼Œé˜…è¯»ç¼–è¾‘å¤„ç†æ–‡ä»¶æ—¶ä½¿ç”¨</li>
<li>Planï¼Œè®¡åˆ’ Agentï¼Œå¸®ä½ è§„åˆ’å¤æ‚ä»»åŠ¡</li>
<li>Generalï¼Œé€šè¿‡ @general è°ƒç”¨ï¼Œå¸®ä½ ç ”ç©¶å¤æ‚é—®é¢˜ï¼Œæ‰§è¡Œå¤šæ­¥éª¤ä»»åŠ¡ã€‚</li>
<li>Exploreï¼Œé€šè¿‡ @explore è°ƒç”¨ï¼Œå¸®ä½ åšç®€å•çš„æŸ¥æ‰¾ã€é˜…è¯»ä»£ç ï¼Œå›ç­”é—®é¢˜</li>
</ul>
<h3 data-id="heading-12">å·¥å…·</h3>
<p>opencode æ²¡æœ‰æŠŠå·¥å…·åˆ†é‚£ä¹ˆç»†ï¼Œskills å’Œ commands ä¹Ÿæ˜¯å·¥å…·çš„ä¸€ç§ã€‚å®ƒä»¬ç»Ÿä¸€éƒ½æ˜¯ä½¿ç”¨ <code>/å…·ä½“å·¥å…·</code> çš„æ–¹å¼è°ƒç”¨ã€‚</p>
<p>å®‰è£… skills/commandsï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼š</p>
<p>æ–¹æ³•ä¸€ã€æŠŠ skills æ–‡ä»¶å¤¹çš„å†…å®¹å¤åˆ¶åˆ° .opencode/skillsï¼Œæˆ– .opencode/commands ä¸‹ï¼›</p>
<p>æ–¹æ³•äºŒã€ä½¿ç”¨ skills/commands å®˜æ–¹æä¾›çš„æ–¹æ³•ï¼Œæˆ–å®˜æ–¹æä¾›çš„å¯¹è¯ä¿¡æ¯æäº¤ç»™ opencodeã€‚</p>
<p>åœ¨è¿™é‡Œæ¨èä¸€ä¸ªä¸“é—¨ç»™ OpenCode åšçš„å¼€å‘ç”¨çš„åº“ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fcode-yeongyu%2Foh-my-opencode" target="_blank" title="https://github.com/code-yeongyu/oh-my-opencode" ref="nofollow noopener noreferrer">github.com/code-yeongyâ€¦</a></p>
<h3 data-id="heading-13">å‘½ä»¤è¡Œç»ˆç«¯</h3>
<p>å¦‚æœä½ éœ€è¦ç›‘æ§æœåŠ¡æƒ…å†µæˆ–å…¶ä¸€äº›éœ€è¦ç”¨åˆ°ç»ˆç«¯çš„æƒ…å†µï¼ŒOpencode ä¹Ÿæ”¯æŒè¾“å…¥ <code>!</code> åˆ‡æ¢åˆ°å‘½ä»¤è¡Œæ¨¡å¼ã€‚</p>
<p>æ­¤æ—¶ç›´æ¥è¾“å…¥ shell å‘½ä»¤ï¼Œèƒ½è§¦å‘æ‰§è¡Œã€‚</p>
<p>ä¹Ÿå¯ä»¥æ–°å¢ä¸€ä¸ª ç»ˆç«¯çª—å£ï¼Œæ›´æ–¹ä¾¿æ“ä½œã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1e496203df184641a933774bab0428aa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZmI5L2s5piU57yW56iL5Lq655Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174422&amp;x-signature=igE11j9hYJdvDg7MPZIYgSQJ7H0%3D" alt="è¯•ç”¨ opencode ä¸€å‘¨æˆ‘æŠŠ Claude Code æ‰”äº†é™„opencodeå®‰è£…æŒ‡å—-æ–°å¢ç»ˆç«¯çª—å£.png" loading="lazy"/></p>
<p>å…¶ä»–çš„ä½¿ç”¨æ–¹æ³•ï¼Œå¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fopencode.ai%2Fdocs" target="_blank" title="https://opencode.ai/docs" ref="nofollow noopener noreferrer">opencode.ai/docs</a></p>
<h2 data-id="heading-14">7. é«˜ç«¯ç©æ³•-æ‰‹æœºæ“ä½œ</h2>
<p>ç½‘å‹çš„æ“ä½œè®©äººè„‘æ´å¤§å¼€ï¼š</p>
<p>å›  opencode æ”¯æŒä»¥ Web æœåŠ¡å™¨çš„å½¢å¼è¿è¡Œï¼Œå¦‚æœä½ æŠŠ opencode éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šï¼Œç„¶åå†ç”¨æ‰‹æœºè®¿é—®ã€‚</p>
<p>é‚£ä½ å°±æ­å»ºäº†ä¸€ä¸ªæ‰‹æœºæ“ä½œçš„ opencodeï¼Œä»æ­¤ç¼–ç¨‹ä¸å†é™åˆ¶åœ¨ç”µè„‘ä¸Šï¼Œé‚£ä½ å°±æ‹¥æœ‰äº†éšæ—¶éšåœ°å¸®ä½ å¼€å‘çš„ AI ç¼–ç åŠ©æ‰‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a8753f4f32864c868ab84e6a14d25e46~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZmI5L2s5piU57yW56iL5Lq655Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174422&amp;x-signature=edN7umdyIVJlAdmGzuP76NvDVMY%3D" alt="ç”Ÿæˆç‰¹å®šå›¾ç‰‡.png" loading="lazy"/></p>
<p>è€Œä¸”ä½ è¿˜å¯ä»¥åˆ©ç”¨æ‰‹æœºç«¯çš„è¯­éŸ³è¾“å…¥æ³•ï¼Œå®ç°çœŸçš„Vibe Codingã€‚</p>
<p>å¯ä»¥è¯´ï¼Œå¼€æºç¤¾åŒºå¤§å¤§æ¿€æ´»äº†å¤§å®¶çš„åˆ›æ„ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ•°æ®å·¥ç¨‹æ–°èŒƒå¼ï¼šNoETL ç»Ÿä¸€è¯­ä¹‰å±‚ç ´è§£è·¨å¢ƒç”µå•† ROI ç»Ÿç­¹ä¸æ•°æ®å­¤å²›éš¾é¢˜]]></title>    <link>https://juejin.cn/post/7599899147419189300</link>    <guid>https://juejin.cn/post/7599899147419189300</guid>    <pubDate>2026-01-28T03:11:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599899147419189300" data-draft-id="7599910677579333632" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ•°æ®å·¥ç¨‹æ–°èŒƒå¼ï¼šNoETL ç»Ÿä¸€è¯­ä¹‰å±‚ç ´è§£è·¨å¢ƒç”µå•† ROI ç»Ÿç­¹ä¸æ•°æ®å­¤å²›éš¾é¢˜"/> <meta itemprop="keywords" content="æ•°æ®åˆ†æ"/> <meta itemprop="datePublished" content="2026-01-28T03:11:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Aloudataå¤§åº”ç§‘æŠ€"/> <meta itemprop="url" content="https://juejin.cn/user/1579340474099927"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ•°æ®å·¥ç¨‹æ–°èŒƒå¼ï¼šNoETL ç»Ÿä¸€è¯­ä¹‰å±‚ç ´è§£è·¨å¢ƒç”µå•† ROI ç»Ÿç­¹ä¸æ•°æ®å­¤å²›éš¾é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1579340474099927/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Aloudataå¤§åº”ç§‘æŠ€
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T03:11:30.000Z" title="Wed Jan 28 2026 03:11:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"/>
<p>æœ¬æ–‡é¦–å‘äº Aloudata å®˜æ–¹æŠ€æœ¯åšå®¢ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fai.noetl.cn%2Fknowledge-base%2Fcross-border-ecommerce-roi-unify-semantic-layer" target="_blank" title="https://ai.noetl.cn/knowledge-base/cross-border-ecommerce-roi-unify-semantic-layer" ref="nofollow noopener noreferrer">ã€Šè·¨å¢ƒç”µå•† ROI ç»Ÿç­¹éš¾ï¼ŸNoETL ç»Ÿä¸€è¯­ä¹‰å±‚ç ´è§£äºšé©¬é€Šã€Shopify ä¸å¹¿å‘Šæ•°æ®å­¤å²›ã€‹</a>è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>
<p><strong>æ‘˜è¦</strong>ï¼šè·¨å¢ƒç”µå•†ä¼ä¸šæ™®éé¢ä¸´äºšé©¬é€Šã€Shopifyã€å¹¿å‘Šå¹³å°ç­‰å¤šæºæ•°æ®å­¤å²›é—®é¢˜ï¼Œå¯¼è‡´è·¨å¹³å° ROI è®¡ç®—ä¸å‡†ã€å†³ç­–æ»åã€‚æœ¬æ–‡æ·±å…¥æ¢è®¨ä¼ ç»ŸETLä¸ç‰©ç†å®½è¡¨æ¨¡å¼çš„å±€é™æ€§ï¼Œå¹¶ä»‹ç»å¦‚ä½•é€šè¿‡ NoETL æŒ‡æ ‡å¹³å°æ„å»ºç»Ÿä¸€è¯­ä¹‰å±‚ï¼Œå®ç°ä¸šåŠ¡é€»è¾‘ä¸ç‰©ç†å­˜å‚¨çš„è§£è€¦ï¼Œä»è€Œè‡ªåŠ¨åŒ–æ•´åˆæ•°æ®ã€ä¿éšœæŒ‡æ ‡å£å¾„ä¸€è‡´ï¼Œå¹¶å®ç°ç§’çº§åˆ†æå“åº”ï¼Œä¸ºæ•°æ®å·¥ç¨‹ä¸æ•æ·åˆ†ææä¾›æ–°èŒƒå¼ã€‚</p>
<h3 data-id="heading-1">è·¨å¢ƒç”µå•†çš„ ROI ç»Ÿç­¹å›°å¢ƒï¼šä¸‰å¤§ç—›ç‚¹è¡¨ç°</h3>
<p>è·¨å¢ƒç”µå•†çš„æ—¥å¸¸è¿è¥æ˜¯å…¸å‹çš„å¤šå¹³å°ã€é«˜é¢‘æ¬¡ã€å¼ºæ—¶æ•ˆçš„â€œæ•æ€â€ä¸šåŠ¡ã€‚ä¼ä¸šæ™®éåœ¨äºšé©¬é€Šã€Shopify/ç‹¬ç«‹ç«™ã€Google/Facebook/TikTok å¹¿å‘Šå¹³å°ç­‰å¤šæ¡æˆ˜çº¿åŒæ—¶ä½œæˆ˜ã€‚ç„¶è€Œï¼Œè¿™ç§ä¸šåŠ¡æ¨¡å¼å¤©ç„¶å¸¦æ¥äº†æ•°æ®å‰²è£‚çš„é¡½ç–¾ï¼Œå¯¼è‡´æ ¸å¿ƒçš„ ROIï¼ˆæŠ•èµ„å›æŠ¥ç‡ï¼‰è®¡ç®—ä¸ç»Ÿç­¹é™·å…¥å›°å¢ƒã€‚</p>
<ol>
<li>
<p>æ•°æ®å‰²è£‚ï¼Œå…¨å±€æ´å¯Ÿç¼ºå¤±</p>
<ul>
<li>å¹³å°å£å’ï¼šäºšé©¬é€Šçš„ A9 ç®—æ³•æ•°æ®ã€Shopify çš„åº—é“ºè¿è¥æ•°æ®ã€å„å¹¿å‘Šå¹³å°çš„æŠ•æ”¾ä¸è½¬åŒ–æ•°æ®ï¼Œåˆ†æ•£åœ¨ä¸åŒç³»ç»Ÿä¸­ã€‚è¿™äº›å¹³å°çš„ API æ¥å£æ ‡å‡†ä¸ä¸€ã€æ•°æ®æ ¼å¼å„å¼‚ï¼Œå½¢æˆå¤©ç„¶çš„æŠ€æœ¯å£å’ã€‚</li>
<li>ä¸šåŠ¡ç›²åŒºï¼šä¼ä¸šæ— æ³•å‡†ç¡®è®¡ç®—â€œå…¨æ¸ é“ ROIâ€ã€‚ä¾‹å¦‚ï¼Œæ— æ³•å°† Facebook å¹¿å‘Šçš„ç‚¹å‡»æˆæœ¬ä¸æœ€ç»ˆåœ¨äºšé©¬é€Šäº§ç”Ÿçš„è®¢å•æ”¶å…¥ç²¾å‡†å…³è”ï¼Œå¯¼è‡´è¥é”€é¢„ç®—åˆ†é…å¦‚åŒâ€œç›²äººæ‘¸è±¡â€ï¼Œé”™å¤±é”€å”®æœºä¼šæˆ–é€ æˆèµ„æºæµªè´¹ã€‚</li>
</ul>
</li>
<li>
<p>å“åº”è¿Ÿç¼“ï¼Œé”™å¤±å¸‚åœºæ—¶æœº</p>
<ul>
<li>å†—é•¿é“¾è·¯ï¼šä¼ ç»Ÿæ¨¡å¼ä¸‹ï¼Œä»ä¸šåŠ¡æå‡ºä¸€ä¸ªè·¨å¹³å°çš„ ROI åˆ†æéœ€æ±‚ï¼ˆå¦‚â€œå¯¹æ¯” TikTok å’Œ Google Ads å¯¹æŸæ–°å“åœ¨åŒ—ç¾çš„å¼•æµæ•ˆæœâ€ï¼‰ï¼Œåˆ°æ•°æ®å·¥ç¨‹å¸ˆæ’æœŸã€å¼€å‘ ETL è„šæœ¬ã€ç‰©ç†æ‰“å®½ã€æµ‹è¯•ä¸Šçº¿ï¼Œå‘¨æœŸå¾€å¾€ä»¥â€œå‘¨â€ä¸ºå•ä½ã€‚</li>
<li>å†³ç­–æ»åï¼šé¢å¯¹ç›´æ’­å¸¦è´§ã€èŠ‚æ—¥å¤§ä¿ƒç­‰äº§ç”Ÿçš„â€œè„‰å†²å¼â€é”€å”®æ•°æ®ï¼ˆå¯å è®¢å•æ€»é‡ 23% ä»¥ä¸Šï¼‰ï¼Œä¼ ç»Ÿæ¶æ„æ— æ³•å®ç°åˆ†é’Ÿçº§çš„ç­–ç•¥è°ƒæ•´ï¼Œåº“å­˜ç§¯å‹ä¸æ–­è´§é£é™©å¹¶å­˜ï¼Œç›´æ¥ä¾µèš€åˆ©æ¶¦ã€‚</li>
</ul>
</li>
<li>
<p>å£å¾„æ··ä¹±ï¼Œä¿¡ä»»å±æœºå‡¸æ˜¾</p>
<ul>
<li>åˆ†æ•£å®šä¹‰ï¼šä¸ºå¿«é€Ÿå“åº”ä¸´æ—¶éœ€æ±‚ï¼Œä¸åŒåˆ†æå¸ˆåœ¨ä¸åŒ BI å·¥å…·æˆ–æŠ¥è¡¨ä¸­è‡ªè¡Œå®šä¹‰â€œå‡€åˆ©æ¶¦â€ã€â€œå¹¿å‘ŠROIâ€ç­‰æŒ‡æ ‡ï¼Œè®¡ç®—é€»è¾‘å­˜åœ¨å¾®å°å·®å¼‚ã€‚</li>
<li>æŠ¥è¡¨æ‰“æ¶ï¼šç®¡ç†å±‚å¸¸å‘ç°é”€å”®æŠ¥è¡¨ä¸è´¢åŠ¡æŠ¥è¡¨ä¸­çš„åŒä¸€æ ¸å¿ƒæŒ‡æ ‡æ•°æ®å¯¹ä¸ä¸Šï¼ŒIT éœ€è¦è€—è´¹å¤§é‡æ—¶é—´æ’æŸ¥å£å¾„å·®å¼‚ã€‚ä¸šåŠ¡éƒ¨é—¨é™·å…¥â€œæ•°æ®ä¸å¥½æ‰¾ã€æ‰¾äº†ä¸æ•¢ç”¨â€çš„çª˜å¢ƒï¼Œä¸¥é‡é˜»ç¢æ•°æ®é©±åŠ¨æ–‡åŒ–çš„å½¢æˆã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-2">æ ¹å› åˆ†æï¼šä¼ ç»Ÿâ€œå®½è¡¨æ¨¡å¼â€åœ¨æ•æ€ä¸šåŠ¡ä¸‹çš„å¿…ç„¶å¤±æ•ˆ</h3>
<p>ä¸Šè¿°ç—›ç‚¹å¹¶éå¶ç„¶ï¼Œè€Œæ˜¯ä¼ ç»Ÿæ•°æ®æ¶æ„ä¸è·¨å¢ƒç”µå•†ä¸šåŠ¡æœ¬è´¨çŸ›ç›¾æ¿€åŒ–çš„å¿…ç„¶ç»“æœã€‚è¿™ä¸€çŸ›ç›¾é›†ä¸­ä½“ç°ä¸ºÂ â€œæ•°æ®åˆ†æçš„ä¸å¯èƒ½ä¸‰è§’â€ï¼šä¸šåŠ¡è¿½æ±‚æè‡´çµæ´»çš„åˆ†æï¼Œç®¡ç†å±‚è¦æ±‚ç»å¯¹ç»Ÿä¸€çš„å£å¾„ï¼Œè€Œå·¥ç¨‹å›¢é˜Ÿéœ€è¦åœ¨æœ‰é™æˆæœ¬ä¸‹ä¿éšœæŸ¥è¯¢æ€§èƒ½ã€‚ä¸ºäº†å¹³è¡¡ï¼Œä¼ä¸šä¸å¾—ä¸ä¾èµ–â€œäººå·¥é¢„è®¡ç®—â€çš„å®½è¡¨æ¨¡å¼ï¼Œä½†è¿™åœ¨æ•æ€ä¸šåŠ¡ä¸‹å·²èµ°å‘ç»ˆç»“ã€‚</p>
<ol>
<li>äººå·¥é¢„è®¡ç®—çš„æ•°å­¦æé™ï¼šè¯•å›¾é€šè¿‡é¢„å»ºç‰©ç†å®½è¡¨æ¥åº”å¯¹ AI æ™ºèƒ½ä½“ï¼ˆAgentï¼‰æˆ–ä¸šåŠ¡äººå‘˜æå‡ºçš„å‘æ•£æ€§ã€éé¢„è®¾çš„åˆ†æéœ€æ±‚ï¼ˆå¦‚â€œå¯¹æ¯”åŒ—ç¾å’Œæ¬§æ´²å¸‚åœºï¼ŒTikTok ä¸ Facebook å¹¿å‘Šå¯¹ A å“ç±»æ–°å®¢çš„ ROI è´¡çŒ®â€ï¼‰ï¼Œç‰©ç†è¡¨çš„æ•°é‡å°†éšç»´åº¦ç»„åˆå‘ˆæŒ‡æ•°çº§çˆ†ç‚¸ã€‚è¿™åœ¨å·¥ç¨‹å’Œç»´æŠ¤ä¸Šæ˜¯ä¸å¯æŒç»­çš„ç©·ä¸¾æ³•ã€‚</li>
<li>é€»è¾‘ä¸ç‰©ç†çš„ç´§è€¦åˆä¹‹æ®‡ï¼šä¸šåŠ¡è¯­ä¹‰ï¼ˆå¦‚â€œæœ‰æ•ˆè®¢å•â€ï¼‰è¢«ç¡¬ç¼–ç åœ¨ ETL è„šæœ¬å’Œå›ºåŒ–çš„ç‰©ç†å®½è¡¨ï¼ˆDWS/ADSï¼‰ä¸­ã€‚ä»»ä½•ä¸šåŠ¡å£å¾„çš„å¾®è°ƒï¼Œéƒ½éœ€è¦åº•å±‚æ•°æ®é“¾è·¯çš„é‡æ–°å¼€å‘ã€æ•°æ®å›åˆ·å’Œä»»åŠ¡è°ƒåº¦ï¼Œå˜æ›´æˆæœ¬é«˜æ˜‚ï¼Œä¸”ææ˜“åœ¨å¤šä¸ªå®½è¡¨é—´äº§ç”Ÿä¸ä¸€è‡´ï¼Œå½¢æˆæ²‰é‡çš„â€œæŠ€æœ¯å€ºåŠ¡â€ã€‚</li>
<li>äººæ‰ä¸æˆæœ¬çš„åŒé‡å‹åŠ›ï¼šä¸“ä¸šæ•°æ®äººæ‰ç¼ºå£å·¨å¤§ï¼Œè€Œæ•°æ®å›¢é˜Ÿå¤§é‡ç²¾åŠ›æ¶ˆè€—åœ¨é‡å¤çš„å®½è¡¨å¼€å‘ä¸è¿ç»´ä¸­ã€‚åŒæ—¶ï¼Œå†—ä½™çš„å®½è¡¨åŠ å·¥å¯¼è‡´ä¼ä¸šæ¹–ä»“æ•°æ®å¹³å‡å†—ä½™ 5 å€ä»¥ä¸Šï¼Œé€ æˆå·¨å¤§çš„å­˜å‚¨ä¸è®¡ç®—èµ„æºæµªè´¹ã€‚</li>
</ol>
<h3 data-id="heading-3">æ–°èŒƒå¼è§£æ³•ï¼šNoETL ç»Ÿä¸€è¯­ä¹‰å±‚å¦‚ä½•é‡æ„æ•°æ®ä¾›åº”é“¾</h3>
<p>è¦æ ¹æ²»æ•°æ®å­¤å²›ï¼Œå¿…é¡»ä»æ¶æ„å±‚é¢è¿›è¡ŒèŒƒå¼é‡æ„ã€‚NoETL è¯­ä¹‰ç¼–ç»‡çš„æ ¸å¿ƒåœ¨äºÂ å°†ä¸šåŠ¡é€»è¾‘ï¼ˆé€»è¾‘å®šä¹‰ï¼‰ä¸ç‰©ç†å­˜å‚¨å’Œè®¡ç®—ï¼ˆç‰©ç†æ‰§è¡Œï¼‰å½»åº•è§£è€¦ï¼Œåœ¨ä¼ä¸šæ˜ç»†æ•°æ®å±‚ï¼ˆDWDï¼‰ä¹‹ä¸Šï¼Œæ„å»ºä¸€ä¸ªç»Ÿä¸€ã€ä¸­ç«‹ã€æ™ºèƒ½çš„è¯­ä¹‰å±‚ã€‚</p>








































<table><thead><tr><th>å¯¹æ¯”ç»´åº¦</th><th>ä¼ ç»Ÿå®½è¡¨æ¨¡å¼</th><th>NoETL è¯­ä¹‰ç¼–ç»‡æ¨¡å¼</th></tr></thead><tbody><tr><td>æ ¸å¿ƒæ¶æ„</td><td>ODS -&gt; DWD -&gt;Â DWS/ADSï¼ˆç‰©ç†å®½è¡¨ï¼‰Â -&gt; BI</td><td>ODS -&gt; DWD -&gt;Â ç»Ÿä¸€è¯­ä¹‰å±‚ï¼ˆé€»è¾‘è™šæ‹Ÿï¼‰Â -&gt; BI/AI</td></tr><tr><td>å¼€å‘æ–¹å¼</td><td>æ‰‹åŠ¨ç¼–å†™ ETL è„šæœ¬ï¼Œç‰©ç†æ‰“å®½</td><td>å£°æ˜å¼å®šä¹‰æŒ‡æ ‡ã€ç»´åº¦ä¸å…³è”å…³ç³»</td></tr><tr><td>çµæ´»æ€§</td><td>ç»´åº¦å›ºå®šï¼Œæ–°éœ€æ±‚éœ€é‡æ–°å¼€å‘å®½è¡¨ï¼ˆå“åº”ä»¥å‘¨è®¡ï¼‰</td><td>ä¸€ä¸ªæŒ‡æ ‡æ”¯æŒä»»æ„ç»´åº¦ç»„åˆåˆ†æï¼ˆå“åº”ä»¥åˆ†é’Ÿè®¡ï¼‰</td></tr><tr><td>ä¸€è‡´æ€§</td><td>å£å¾„åˆ†æ•£åœ¨ä¸åŒå®½è¡¨ï¼Œæ˜“â€œæ‰“æ¶â€</td><td>ä¸€æ¬¡å®šä¹‰ï¼Œå¤„å¤„æ¶ˆè´¹ï¼Œå£å¾„ 100% ä¸€è‡´</td></tr><tr><td>æ€§èƒ½ä¿éšœ</td><td>ä¾èµ–é¢„è®¡ç®—çš„å®½è¡¨ï¼Œæ— æ³•åº”å¯¹å‘æ•£æŸ¥è¯¢</td><td>åŸºäºå£°æ˜å¼ç­–ç•¥çš„æ™ºèƒ½ç‰©åŒ–åŠ é€Ÿï¼Œå®ç°ç™¾äº¿æ˜ç»†ç§’çº§å“åº”</td></tr><tr><td>æ€»æ‹¥æœ‰æˆæœ¬</td><td>é«˜ï¼ˆé‡å¤åŠ å·¥ã€å†—ä½™å­˜å‚¨ã€äººåŠ›å¯†é›†ï¼‰</td><td>ä½ï¼ˆæ¶æ„ç®€åŒ–ã€æŒ‰éœ€åŠ é€Ÿã€è‡ªåŠ¨åŒ–è¿ç»´ï¼‰</td></tr></tbody></table>
<p>å…·ä½“å®ç°æœºåˆ¶ï¼š</p>
<ol>
<li>
<p>å£°æ˜å¼å®šä¹‰ï¼Œè™šæ‹Ÿå…³è”ï¼šæ•°æ®å·¥ç¨‹å¸ˆæ— éœ€ç¼–å†™ JOIN çš„ ETL è„šæœ¬ï¼Œç›´æ¥åœ¨å¹³å°ç•Œé¢å£°æ˜â€œäºšé©¬é€Šè®¢å•è¡¨â€ä¸â€œFacebook å¹¿å‘Šç‚¹å‡»è¡¨â€çš„é€»è¾‘å…³è”å…³ç³»ã€‚å¹³å°æ®æ­¤æ„å»ºä¸€ä¸ªè¦†ç›–å…¨åŸŸçš„Â â€œè™šæ‹Ÿä¸šåŠ¡äº‹å®ç½‘ç»œâ€Â ï¼Œä¸šåŠ¡äººå‘˜é¢å¯¹çš„æ˜¯ä¸€ä¸ªå·²é€»è¾‘å…³è”çš„æ¸…æ™°æ•°æ®è§†å›¾ï¼Œæ— éœ€å…³å¿ƒåº•å±‚ç‰©ç†è¡¨ç»“æ„ã€‚</p>
</li>
<li>
<p>è‡ªåŠ¨åŒ–ç”Ÿäº§ï¼Œæ™ºèƒ½åŠ é€Ÿï¼š</p>
<ul>
<li>æŸ¥è¯¢ç”Ÿæˆï¼šå½“ä¸šåŠ¡äººå‘˜æ‹–æ‹½æŒ‡æ ‡è¿›è¡Œ ROI åˆ†ææ—¶ï¼Œå¹³å°è¯­ä¹‰å¼•æ“è‡ªåŠ¨å°†æ“ä½œç¿»è¯‘ä¸ºé«˜æ•ˆã€ä¼˜åŒ–çš„ SQLã€‚</li>
<li>æ€§èƒ½æœåŠ¡ï¼šç®¡ç†å‘˜å¯å£°æ˜å¼åœ°æŒ‡å®šéœ€è¦åŠ é€Ÿçš„æŒ‡æ ‡å’Œç»´åº¦ç»„åˆï¼ˆå¦‚â€œåŒ—ç¾åŒºå¹¿å‘Š ROIâ€ï¼‰ï¼Œå¹³å°æ™ºèƒ½ç‰©åŒ–å¼•æ“æ ¹æ®å£°æ˜è‡ªåŠ¨åˆ›å»ºã€è¿ç»´ç‰©åŒ–è§†å›¾ï¼ˆåŠ é€Ÿè¡¨ï¼‰ï¼Œå¹¶åœ¨æŸ¥è¯¢æ—¶å®ç°é€æ˜çš„æ™ºèƒ½è·¯ç”±ä¸ SQL æ”¹å†™ï¼Œåœ¨ä¿éšœæè‡´çµæ´»æ€§çš„åŒæ—¶ï¼Œåšåˆ°å¯¹ä¸šåŠ¡é€æ˜çš„ç§’çº§å“åº”ã€‚è¯¥å¼•æ“æ”¯æŒå¯¹å»é‡è®¡æ•°ã€æ¯”ç‡ç±»ç­‰ä¸å¯ç´¯åŠ æŒ‡æ ‡è¿›è¡Œç‰©åŒ–ä¸Šå·ã€‚</li>
</ul>
</li>
<li>
<p>ç»Ÿä¸€æœåŠ¡ï¼Œä¸€æ¬¡å®šä¹‰å¤„å¤„æ¶ˆè´¹ï¼šé€šè¿‡æ ‡å‡†åŒ–çš„ Restful API å’Œ JDBC æ¥å£ï¼Œå°†ç»è¿‡ä¸¥æ ¼æ²»ç†çš„æŒ‡æ ‡ï¼ˆå¦‚â€œè·¨å¢ƒç»¼åˆ ROIâ€ï¼‰åŒæ—¶æä¾›ç»™ï¼š</p>
<ul>
<li>BIå·¥å…·ï¼šå¦‚æ·±åº¦èåˆçš„ FineBIã€Quick BIï¼Œæˆ–é€šè¿‡ JDBC å¯¹æ¥çš„å…¶ä»– BI å·¥å…·ã€‚</li>
<li>ä¸šåŠ¡ç³»ç»Ÿï¼šCRMã€ERP ç­‰ã€‚</li>
<li>AIæ•°æ®åˆ†æåŠ©æ‰‹ï¼ˆAgentï¼‰ï¼šæä¾›ç»“æ„åŒ–çš„è¯­ä¹‰ APIã€‚</li>
<li>åŠå…¬è½¯ä»¶ï¼šé€šè¿‡ä¸“ç”¨æ’ä»¶åœ¨ WPS è¡¨æ ¼ä¸­ç›´æ¥è°ƒç”¨ã€‚<br/>
ç¡®ä¿å…¨å…¬å¸æ¶ˆè´¹åŒä¸€ä»½â€œæ•°å­—çœŸç†â€ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-4">å››æ­¥å®è·µè·¯å¾„ï¼šä»æ•°æ®å­¤å²›åˆ°æ•æ·æ´å¯Ÿ</h3>
<p>å¼•å…¥ NoETL æ–°èŒƒå¼å¹¶éä¸€åœºâ€œæ¨å€’é‡æ¥â€çš„é©å‘½ï¼Œè€Œåº”é‡‡ç”¨æ¸è¿›å¼ç­–ç•¥ï¼Œå¹³æ»‘æ¼”è¿›ï¼Œä»·å€¼é©±åŠ¨ã€‚</p>
<ol>
<li>å­˜é‡æŒ‚è½½ï¼ˆç»Ÿä¸€å‡ºå£ï¼‰ï¼šå°†ç°æœ‰ç¨³å®šã€æ€§èƒ½å°šå¯çš„ç‰©ç†å®½è¡¨å¿«é€Ÿæ¥å…¥å¹³å°ï¼Œæ˜ å°„ä¸ºé€»è¾‘è§†å›¾ã€‚ä»·å€¼ï¼šé›¶å¼€å‘æˆæœ¬ï¼Œè¿…é€Ÿå»ºç«‹ç»Ÿä¸€çš„æŒ‡æ ‡æœåŠ¡å‡ºå£ï¼Œè§£å†³å–æ•°æ··ä¹±çš„ç‡ƒçœ‰ä¹‹æ€¥ï¼Œä¿æŠ¤å†å²æŠ•èµ„ã€‚</li>
<li>å¢é‡åŸç”Ÿï¼ˆæ•æ·å“åº”ï¼‰ï¼šæ‰€æœ‰æ–°äº§ç”Ÿçš„åˆ†æéœ€æ±‚ï¼Œå°¤å…¶æ˜¯è·¨å¹³å° ROI å½’å› ç­‰å¤æ‚åœºæ™¯ï¼Œç›´æ¥åŸºäº DWD æ˜ç»†æ•°æ®åœ¨è¯­ä¹‰å±‚è¿›è¡Œå£°æ˜å¼å®šä¹‰ï¼Œç”±å¹³å°è‡ªåŠ¨åŒ–ç”Ÿäº§ã€‚ä»·å€¼ï¼šå®ç° T+0 æ•æ·å“åº”ï¼Œä»æºå¤´éåˆ¶æ–°å€ºäº§ç”Ÿï¼ŒéªŒè¯å¹³å°ä»·å€¼ã€‚</li>
<li>å­˜é‡æ›¿æ—§ï¼ˆé™æœ¬å¢æ•ˆï¼‰ï¼šè¯†åˆ«å¹¶é€æ­¥ä¸‹çº¿é‚£äº›é«˜è€—èƒ½ã€éš¾ç»´æŠ¤ã€é€»è¾‘å˜æ›´é¢‘ç¹çš„â€œåŒ…è¢±å‹â€æ—§å®½è¡¨ ETL ä»»åŠ¡ï¼Œç”¨è¯­ä¹‰å±‚æ¨¡å‹æ›¿ä»£ã€‚ä»·å€¼ï¼šé‡Šæ”¾æ˜‚è´µçš„è®¡ç®—ä¸å­˜å‚¨èµ„æºï¼Œé™ä½æ€»æ‹¥æœ‰æˆæœ¬ï¼ˆTCOï¼‰ï¼Œå°†â€œæ­»é€»è¾‘â€ç›˜æ´»ã€‚</li>
<li>ç”Ÿæ€èåˆï¼ˆæ·±åŒ–ä»·å€¼ï¼‰ï¼šå°†è¯­ä¹‰å±‚æŒ‡æ ‡æœåŠ¡é€šè¿‡ API å¹¿æ³›èµ‹èƒ½ç»™ BI æŠ¥è¡¨ã€ä¸šåŠ¡è¿è¥ç³»ç»ŸåŠ AI åº”ç”¨ï¼Œæ„å»ºä¼ä¸šçº§æ•°æ®ä¸­æ¢ã€‚ä»·å€¼ï¼šåŸ¹è‚²æ•°æ®é©±åŠ¨æ–‡åŒ–ï¼Œå®ç°æ•°æ®ä»·å€¼çš„æœ€å¤§åŒ–ã€‚</li>
</ol>
<h3 data-id="heading-5">æ¡ˆä¾‹éªŒè¯ï¼šNoETL å¦‚ä½•é©±åŠ¨è·¨å¢ƒç”µå•†ä¸é›¶å”®å·¨å¤´ææ•ˆ</h3>
<p>NoETL èŒƒå¼å¹¶éç†è®ºç©ºæƒ³ï¼Œå·²åœ¨é‡‘èã€é›¶å”®ç­‰å¤æ‚æ•°æ®åœºæ™¯çš„å¤´éƒ¨ä¼ä¸šä¸­å¾—åˆ°æˆåŠŸéªŒè¯ï¼Œå…¶è§£å†³æ•°æ®æ•´åˆä¸æ•æ·åˆ†æé—®é¢˜çš„èƒ½åŠ›å…·æœ‰æ™®é€‚æ€§ã€‚</p>
<ul>
<li>æŸå¤´éƒ¨åˆ¸å•†ï¼šåŸºäº Aloudata CAN æ„å»ºæŒ‡æ ‡â€œç®¡ç ”ç”¨â€ä¸€ä½“åŒ–ä½“ç³»ï¼Œæ›¿ä»£ä¼ ç»Ÿ ETL å¼€å‘ï¼Œå®ç°å¼€å‘ææ•ˆ 50%ï¼Œåˆ†ææé€Ÿ 10 å€ï¼ŒæŒ‡æ ‡å£å¾„ 100% ä¸€è‡´ï¼Œä¸ºæ™ºèƒ½å†³ç­–å¥ å®šäº†åšå®çš„å¯ä¿¡æ•°æ®åº•åº§ã€‚</li>
<li>éº¦å½“åŠ³ä¸­å›½ï¼šæ„å»ºâ€œç®¡ç ”ç”¨â€ä¸€ä½“çš„ NoETL æŒ‡æ ‡ä¸­å°ï¼Œæ²‰æ·€ä¸Šåƒä¸ªæ ‡å‡†æŒ‡æ ‡ï¼Œç»Ÿä¸€ API æœåŠ¡è¦†ç›– 30+ ä¸šåŠ¡åœºæ™¯ï¼Œæ—¥å‡æ”¯æ’‘ç™¾ä¸‡çº§ API è°ƒç”¨ï¼Œé©±åŠ¨å…¨åŸŸæ•°å­—åŒ–è¿è¥ï¼Œå¹¶ä¸º AI åº”ç”¨æä¾›å°±ç»ªçš„æ•°æ®åº•åº§ã€‚</li>
<li>æ™®éä»·å€¼ï¼šæ®ä¼—å¤šæ¡ˆä¾‹éªŒè¯ï¼Œå®æ–½ NoETL æŒ‡æ ‡å¹³å°å¯å°†æŒ‡æ ‡ä¸Šçº¿å‘¨æœŸä»æ•°å‘¨ç¼©çŸ­åˆ°å°æ—¶ï¼Œè·¨éƒ¨é—¨æ•°æ®äº‰è®®ç‡é™ä½ 90% ä»¥ä¸Šï¼Œä»æŠ€æœ¯å±‚é¢ä¿éšœäº†æˆ˜ç•¥ç›®æ ‡çš„ç»Ÿä¸€æ‹†è§£ä¸é«˜æ•ˆæ‰§è¡Œã€‚</li>
</ul>
<h3 data-id="heading-6">è¡ŒåŠ¨å»ºè®®ï¼šå¯åŠ¨ä½ çš„æ•°æ®æ¶æ„å‡çº§</h3>
<p>é¢å¯¹æ•°æ®å­¤å²›å’Œ ROI ç»Ÿç­¹éš¾é¢˜ï¼Œè§‚æœ›å’Œä¿®è¡¥å·²æ— æ³•åº”å¯¹æœªæ¥çš„ç«äº‰ã€‚ä¼ä¸šåº”ä¸»åŠ¨è¯„ä¼°å¹¶å¼•å…¥ NoETL æ–°èŒƒå¼ï¼Œé€‰æ‹©ä¸€ä¸ªçœŸæ­£å…·å¤‡æ ¸å¿ƒèƒ½åŠ›çš„æŒ‡æ ‡å¹³å°ä½œä¸ºè½¬å‹åŸºåº§ã€‚</p>
<ol>
<li>
<p>æ˜ç¡®è¯„ä¼°ç»´åº¦ï¼šåœ¨é€‰å‹ POC ä¸­ï¼Œé‡ç‚¹è€ƒå¯Ÿå¹³å°æ˜¯å¦å…·å¤‡ï¼š</p>
<ul>
<li>åŸºäºæ˜ç»†æ•°æ®çš„â€œè™šæ‹Ÿå®½è¡¨â€æ„å»ºèƒ½åŠ›ï¼ˆèƒ½å¦å£°æ˜é€»è¾‘å…³è”ï¼Œæ‹’ç»ç‰©ç†æ‰“å®½ï¼‰ã€‚</li>
<li>å¤æ‚æŒ‡æ ‡çš„è¡¨è¾¾åŠ›ï¼ˆæ˜¯å¦æ”¯æŒè·¨è¡¨èšåˆã€äºŒæ¬¡èšåˆã€åŠ¨æ€ç»´åº¦ç­›é€‰ç­‰ï¼‰ã€‚</li>
<li>å£°æ˜å¼æ™ºèƒ½ç‰©åŒ–åŠ é€Ÿæœºåˆ¶ï¼ˆæ˜¯å¦åŸºäºç®¡ç†å‘˜å£°æ˜è‡ªåŠ¨è¿ç»´åŠ é€Ÿï¼Œè€Œéå…¨è‡ªåŠ¨æˆ–å…¨æ‰‹åŠ¨ï¼‰ã€‚</li>
<li>æ ‡å‡†çš„å¼€æ”¾æ¥å£ï¼ˆJDBC/APIï¼‰å’Œç”Ÿæ€èåˆèƒ½åŠ›ã€‚</li>
</ul>
</li>
<li>
<p>å¯åŠ¨ç¯å¡”é¡¹ç›®ï¼šé€‰æ‹©ä¸€æ¡ä¸šåŠ¡ä»·å€¼æ¸…æ™°ã€ç—›ç‚¹æ˜ç¡®çš„ä¸šåŠ¡çº¿ï¼ˆå¦‚Â â€œåŒ—ç¾å¸‚åœºå…¨æ¸ é“å¹¿å‘Šæ•ˆæœåˆ†æâ€Â ï¼‰ä½œä¸ºè¯•ç‚¹ã€‚èšç„¦äºè§£å†³è·¨å¹³å°æ•°æ®æ•´åˆä¸å®æ—¶ ROI åˆ†æçš„å…·ä½“é—®é¢˜ï¼Œå¿«é€ŸéªŒè¯å¹³å°èƒ½åŠ›ä¸ä¸šåŠ¡ä»·å€¼ã€‚</p>
</li>
<li>
<p>è§„åˆ’æ¸è¿›è·¯çº¿ï¼šé‡‡ç”¨ä¸Šè¿°Â â€œå››æ­¥å®è·µè·¯å¾„â€Â ï¼Œä»ç»Ÿä¸€æ•°æ®å‡ºå£å¼€å§‹ï¼Œé€æ­¥å®ç°æ–°éœ€æ±‚çš„æ•æ·å“åº”å’Œæ—§å€ºåŠ¡çš„æ¸…ç†ï¼Œæœ€ç»ˆæ„å»ºä¼ä¸šçº§æ™ºèƒ½æ•°æ®åŸºåº§ï¼Œä»å®¹åº”å¯¹ AI æ—¶ä»£çš„æŒ‘æˆ˜ã€‚</p>
</li>
</ol>
<h3 data-id="heading-7">FAQ</h3>
<h5 data-id="heading-8">Q1: NoETL å’Œä¼ ç»Ÿ ETL æœ€å¤§çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h5>
<p>ä¼ ç»Ÿ ETL éœ€è¦æ•°æ®å·¥ç¨‹å¸ˆæ‰‹åŠ¨ç¼–å†™è„šæœ¬ï¼Œå°†æ•°æ®åŠ å·¥æˆå›ºåŒ–çš„ç‰©ç†å®½è¡¨ï¼Œä¸šåŠ¡åˆ†æè¢«é™åˆ¶åœ¨é¢„å»ºçš„ç»´åº¦ç»„åˆå†…ã€‚NoETL é€šè¿‡ç»Ÿä¸€è¯­ä¹‰å±‚ï¼Œå°†ä¸šåŠ¡é€»è¾‘ï¼ˆæŒ‡æ ‡ã€ç»´åº¦ã€å…³è”ï¼‰ä¸ç‰©ç†å­˜å‚¨è§£è€¦ã€‚ä¸šåŠ¡äººå‘˜åœ¨è¯­ä¹‰å±‚é€šè¿‡å£°æ˜å¼ã€ç•Œé¢åŒ–çš„æ–¹å¼å®šä¹‰åˆ†æéœ€æ±‚ï¼Œç”±å¹³å°è‡ªåŠ¨ç”Ÿæˆæœ€ä¼˜æŸ¥è¯¢å¹¶åˆ©ç”¨æ™ºèƒ½ç‰©åŒ–åŠ é€Ÿä¿éšœæ€§èƒ½ï¼Œå®ç°äº†ä»â€œäººå·¥é“ºè·¯â€åˆ°â€œç³»ç»Ÿè‡ªåŠ¨é©¾é©¶â€çš„è½¬å˜ã€‚</p>
<h5 data-id="heading-9">Q2: NoETL å¦‚ä½•ä¿è¯è·¨å¹³å°æ•°æ®æ•´åˆæ—¶çš„æŸ¥è¯¢æ€§èƒ½ï¼Ÿ</h5>
<p>NoETL å¹¶éå–æ¶ˆæ‰€æœ‰è®¡ç®—ï¼Œè€Œæ˜¯é€šè¿‡æ™ºèƒ½ç‰©åŒ–å¼•æ“å°†é¢„è®¡ç®—å‡çº§ä¸ºä¸€ç§è‡ªåŠ¨åŒ–æ€§èƒ½æœåŠ¡ã€‚å¹³å°ä¼šæ ¹æ®ç®¡ç†å‘˜å£°æ˜çš„åŠ é€Ÿç­–ç•¥ï¼Œè‡ªåŠ¨åˆ›å»ºå¹¶è¿ç»´æœ€ä¼˜çš„ç‰©åŒ–è§†å›¾ã€‚å½“ç”¨æˆ·è¿›è¡Œå¤æ‚ ROI åˆ†ææ—¶ï¼ŒæŸ¥è¯¢ä¼šè¢«è‡ªåŠ¨ã€é€æ˜åœ°è·¯ç”±åˆ°æœ€åˆé€‚çš„ç‰©åŒ–ç»“æœä¸Šï¼Œä»è€Œå®ç°å¯¹åäº¿çº§æ˜ç»†æ•°æ®çš„ç§’çº§å“åº”ï¼ŒåŒæ—¶é¿å…äººå·¥ç®¡ç†ç‰©åŒ–è§†å›¾çš„å¤æ‚åº¦å’Œæµªè´¹ã€‚</p>
<h5 data-id="heading-10">Q3: å¼•å…¥ NoETL æŒ‡æ ‡å¹³å°ï¼Œå¯¹æˆ‘ä»¬ç°æœ‰çš„æ•°æ®ä»“åº“å’Œ BI å·¥å…·æœ‰ä½•å½±å“ï¼Ÿ</h5>
<p>NoETL å¹³å°è®¾è®¡ä¸ºä¸­ç«‹ã€å¼€æ”¾çš„åŸºåº§ï¼Œæ—¨åœ¨å¢å¼ºè€Œéå–ä»£ç°æœ‰æŠ•èµ„ã€‚å®ƒå¯ä»¥æ— ç¼å¯¹æ¥ä¼ä¸šå·²æœ‰çš„æ•°æ®æ¹–/ä»“ï¼ˆç›´æ¥è¯»å– DWD å±‚ï¼‰ï¼Œå¹¶é€šè¿‡æ ‡å‡† API/JDBC æ¥å£ä¸å„ç±» BI å·¥å…·ä»¥åŠä¸šåŠ¡ç³»ç»Ÿé›†æˆã€‚å¹³å°æˆä¸ºç»Ÿä¸€çš„æŒ‡æ ‡å®šä¹‰ã€è®¡ç®—å’ŒæœåŠ¡å‡ºå£ï¼Œä¸‹æ¸¸ BI å·¥å…·å›å½’ä¸ºçº¯ç²¹çš„â€œå¯è§†åŒ–æ¸²æŸ“å¼•æ“â€ï¼Œä»è€Œæ‰“ç ´å‚å•†é”å®šï¼Œå®ç°â€œä¸€ä¸ªæŒ‡æ ‡ï¼Œå¤„å¤„æ¶ˆè´¹â€ã€‚</p>
<h5 data-id="heading-11">Q4: NoETL å¦‚ä½•æ”¯æŒ AI æ•°æ®åˆ†æåŠ©æ‰‹ï¼ˆAgentï¼‰ï¼Ÿ</h5>
<p>NoETL ç»Ÿä¸€è¯­ä¹‰å±‚ä¸º AI æä¾›äº†ç»“æ„åŒ–çš„ã€æ— æ­§ä¹‰çš„â€œä¸šåŠ¡è¯­è¨€â€å’Œâ€œå·¥å…·â€ã€‚AI Agent ä¸å†éœ€è¦ç›´æ¥é¢å¯¹å¤æ‚çš„ç‰©ç†è¡¨ç”Ÿæˆæ˜“é”™çš„ SQLï¼Œè€Œæ˜¯é€šè¿‡è°ƒç”¨è¯­ä¹‰å±‚çš„æ ‡å‡† APIï¼Œä¼ å…¥æŒ‡æ ‡ã€ç»´åº¦ç­‰å‚æ•°ï¼Œç”±å¹³å°è´Ÿè´£ç²¾ç¡®è®¡ç®—å¹¶è¿”å›ç»“æœã€‚è¿™ä»æ ¹æœ¬ä¸Šæ¶ˆé™¤äº† AI çš„æ•°æ®å¹»è§‰ï¼Œå¹¶ä½¿å…¶èƒ½å¤ŸåŸºäºç¡®å®šæ€§çš„æŒ‡æ ‡è¿›è¡Œæ·±åº¦å½’å› ä¸æ´å¯Ÿã€‚</p>
<h3 data-id="heading-12">Key Takeawaysï¼ˆæ ¸å¿ƒè¦ç‚¹ï¼‰</h3>
<ol>
<li>æ¶æ„è§£è€¦æ˜¯æ ¹æœ¬ï¼šè·¨å¢ƒç”µå•†çš„ ROI ç»Ÿç­¹éš¾é¢˜ï¼Œæ ¹æºäºä¼ ç»Ÿâ€œå®½è¡¨æ¨¡å¼â€ä¸‹ä¸šåŠ¡é€»è¾‘ä¸ç‰©ç†å®ç°çš„ç´§è€¦åˆã€‚NoETL é€šè¿‡æ„å»ºç»Ÿä¸€è¯­ä¹‰å±‚ï¼Œå®ç°å½»åº•è§£è€¦ï¼Œæ˜¯æ²»æœ¬ä¹‹ç­–ã€‚</li>
<li>å£°æ˜å¼é©±åŠ¨è‡ªåŠ¨åŒ–ï¼šNoETL çš„æ ¸å¿ƒä¸æ˜¯å–æ¶ˆè®¡ç®—ï¼Œè€Œæ˜¯é€šè¿‡Â â€œå£°æ˜å¼ç­–ç•¥â€Â é©±åŠ¨æ™ºèƒ½ç‰©åŒ–åŠ é€Ÿä¸æŸ¥è¯¢ç”Ÿæˆï¼Œåœ¨ä¿éšœç™¾äº¿æ•°æ®ç§’çº§å“åº”çš„åŒæ—¶ï¼Œèµ‹äºˆä¸šåŠ¡å‰æ‰€æœªæœ‰çš„åˆ†æçµæ´»æ€§ã€‚</li>
<li>ç»Ÿä¸€å£å¾„é‡Šæ”¾ä»·å€¼ï¼šé€šè¿‡Â â€œä¸€æ¬¡å®šä¹‰ï¼Œå¤„å¤„æ¶ˆè´¹â€Â çš„æ ‡å‡†åŒ–æŒ‡æ ‡æœåŠ¡ï¼ŒNoETL å¹³å°èƒ½ç»ˆç»“æ•°æ®å£å¾„æ··ä¹±ï¼Œå»ºç«‹å…¬å¸çº§â€œæ•°å­—çœŸç†â€ï¼Œä¸ºç²¾å‡†å†³ç­–å’Œ AI åº”ç”¨æä¾›å¯ä¿¡åº•åº§ï¼ŒçœŸæ­£é‡Šæ”¾æ•°æ®ç”Ÿäº§åŠ›ã€‚</li>
</ol>
<hr/>
<p>æœ¬æ–‡é¦–å‘äº Aloudata å®˜æ–¹æŠ€æœ¯åšå®¢ï¼ŒæŸ¥çœ‹æ›´å¤šæŠ€æœ¯ç»†èŠ‚ä¸é«˜æ¸…å›¾è¡¨ï¼Œè¯·è®¿é—®åŸæ–‡é“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fai.noetl.cn%2Fknowledge-base%2Fcross-border-ecommerce-roi-unify-semantic-layer" target="_blank" title="https://ai.noetl.cn/knowledge-base/cross-border-ecommerce-roi-unify-semantic-layer" ref="nofollow noopener noreferrer">ai.noetl.cn/knowledge-bâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[PostgreSQL é«˜å¯ç”¨æ€§ï¼šæ—¥å¿—ä¼ é€ä¸æµå¤åˆ¶æŒ‡å—]]></title>    <link>https://juejin.cn/post/7599963665039556658</link>    <guid>https://juejin.cn/post/7599963665039556658</guid>    <pubDate>2026-01-28T03:03:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599963665039556658" data-draft-id="7599965904617177134" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="PostgreSQL é«˜å¯ç”¨æ€§ï¼šæ—¥å¿—ä¼ é€ä¸æµå¤åˆ¶æŒ‡å—"/> <meta itemprop="keywords" content="PostgreSQL"/> <meta itemprop="datePublished" content="2026-01-28T03:03:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å…‰è›‹"/> <meta itemprop="url" content="https://juejin.cn/user/3537560778573467"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            PostgreSQL é«˜å¯ç”¨æ€§ï¼šæ—¥å¿—ä¼ é€ä¸æµå¤åˆ¶æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3537560778573467/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å…‰è›‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T03:03:28.000Z" title="Wed Jan 28 2026 03:03:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»24åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">PostgreSQL é«˜å¯ç”¨æ€§å®ç°æŒ‡å—ï¼šæ—¥å¿—ä¼ é€ä¸æµå¤åˆ¶</h2>
<h3 data-id="heading-1">å‰è¨€</h3>
<p>PostgreSQL æä¾›çš„<strong>æ—¥å¿—ä¼ é€ï¼ˆLog Shippingï¼‰</strong> æŠ€æœ¯æ˜¯å®ç°æ•°æ®åº“é«˜å¯ç”¨æ€§ï¼ˆHAï¼‰çš„æ ¸å¿ƒæ–¹æ¡ˆä¹‹ä¸€ï¼Œè¯¥æ–¹æ¡ˆä¹Ÿè¢«ç§°ä¸º<strong>æ¸©å¤‡</strong>ï¼Œé€šè¿‡ä¸»æœåŠ¡å™¨çš„è¿ç»­å½’æ¡£ä¸åå¤‡æœåŠ¡å™¨çš„è¿ç»­æ¢å¤æœºåˆ¶ï¼Œå®ç°ä¸»å¤‡èŠ‚ç‚¹çš„WALï¼ˆé¢„å†™å¼æ—¥å¿—ï¼‰åŒæ­¥ï¼Œåœ¨ä¸»æœåŠ¡å™¨å¤±æ•ˆæ—¶åå¤‡æœåŠ¡å™¨å¯å¿«é€Ÿæ¥ç®¡ä¸šåŠ¡ã€‚åœ¨æ­¤åŸºç¡€ä¸Šå»¶ä¼¸çš„<strong>æµå¤åˆ¶</strong>æŠ€æœ¯è¿›ä¸€æ­¥é™ä½äº†æ•°æ®ä¸¢å¤±çª—å£ï¼Œæå‡äº†ä¸»å¤‡åŒæ­¥çš„å®æ—¶æ€§ï¼Œè€Œå¤åˆ¶æ§½ã€çº§è”å¤åˆ¶ã€åŒæ­¥å¤åˆ¶ç­‰ç‰¹æ€§åˆ™ä¸°å¯Œäº†é«˜å¯ç”¨é…ç½®çš„çµæ´»æ€§ä¸å¯é æ€§ã€‚</p>
<p>æœ¬æŒ‡å—è¯¦ç»†è®²è§£PostgreSQLæ—¥å¿—ä¼ é€ä¸æµå¤åˆ¶çš„æ ¸å¿ƒåŸç†ã€é…ç½®æ­¥éª¤åŠé«˜çº§ç‰¹æ€§ï¼Œæ‰€æœ‰é…ç½®ä¸æ“ä½œå‡åŸºäºPostgreSQLå®˜æ–¹æ ‡å‡†å®ç°ï¼Œæ— éœ€ä¿®æ”¹æ•°æ®åº“è¡¨ç»“æ„ï¼Œç®¡ç†å¼€é”€ä½ä¸”å¯¹ä¸»æœåŠ¡å™¨æ€§èƒ½å½±å“è¾ƒå°ï¼Œæ˜¯ç”Ÿäº§ç¯å¢ƒä¸­æ­å»ºPostgreSQLé«˜å¯ç”¨é›†ç¾¤çš„ä¸»æµæ–¹æ¡ˆã€‚</p>
<h3 data-id="heading-2">1 æ ¸å¿ƒæ¦‚è¿°</h3>
<h4 data-id="heading-3">1.1 æ—¥å¿—ä¼ é€åŸºæœ¬åŸç†</h4>
<p>æ—¥å¿—ä¼ é€æ˜¯æŒ‡å°†ä¸»æœåŠ¡å™¨ç”Ÿæˆçš„WALè®°å½•ä¼ è¾“åˆ°ä¸€å°æˆ–å¤šå°åå¤‡æœåŠ¡å™¨çš„è¿‡ç¨‹ï¼ŒPostgreSQLåŸç”Ÿæ”¯æŒ<strong>åŸºäºæ–‡ä»¶çš„æ—¥å¿—ä¼ é€</strong>ï¼šä¸»æœåŠ¡å™¨ä»¥16MBä¸ºå•ä½ç”ŸæˆWALæ®µæ–‡ä»¶ï¼Œé€šè¿‡è¿ç»­å½’æ¡£æœºåˆ¶å°†WALæ®µæ–‡ä»¶ä¼ è¾“åˆ°åå¤‡æœåŠ¡å™¨å¯è®¿é—®çš„ä½ç½®ï¼Œåå¤‡æœåŠ¡å™¨åˆ™åœ¨è¿ç»­æ¢å¤æ¨¡å¼ä¸‹æŒç»­è¯»å–å¹¶åº”ç”¨è¿™äº›WALæ®µæ–‡ä»¶ã€‚</p>
<p>WALæ®µæ–‡ä»¶çš„ä¼ è¾“æ— ç‰©ç†è·ç¦»é™åˆ¶ï¼Œå¯éƒ¨ç½²åœ¨æœ¬åœ°ã€åŒæœºæˆ¿æˆ–è·¨åœ°åŸŸèŠ‚ç‚¹ï¼Œæ‰€éœ€ç½‘ç»œå¸¦å®½ç”±ä¸»æœåŠ¡å™¨çš„äº‹åŠ¡ç‡å†³å®šã€‚</p>
<h4 data-id="heading-4">1.2 ä¸»å¤‡å·¥ä½œæ¨¡å¼</h4>
<ul>
<li><strong>ä¸»æœåŠ¡å™¨</strong>ï¼šè¿è¡Œåœ¨<strong>è¿ç»­å½’æ¡£æ¨¡å¼</strong>ï¼Œå¼€å¯WALå½’æ¡£é…ç½®ï¼ŒæŒç»­ç”Ÿæˆå¹¶å½’æ¡£WALæ®µæ–‡ä»¶ï¼›</li>
<li><strong>åå¤‡æœåŠ¡å™¨</strong>ï¼šè¿è¡Œåœ¨<strong>è¿ç»­æ¢å¤/standbyæ¨¡å¼</strong>ï¼Œé€šè¿‡<code>standby.signal</code>æ–‡ä»¶æ ‡è¯†ï¼ŒæŒç»­ä»å½’æ¡£ç›®å½•æˆ–ä¸»æœåŠ¡å™¨ç›´æ¥è¯»å–WALå¹¶åº”ç”¨ã€‚</li>
</ul>
<h4 data-id="heading-5">1.3 å…³é”®ç‰¹æ€§ä¸æ•°æ®ä¸¢å¤±è¯´æ˜</h4>
<ol>
<li><strong>å¼‚æ­¥ç‰¹æ€§</strong>ï¼šæ—¥å¿—ä¼ é€ï¼ˆå«åŸºç¡€æµå¤åˆ¶ï¼‰é»˜è®¤æ˜¯<strong>å¼‚æ­¥</strong>çš„ï¼ŒWALè®°å½•åœ¨äº‹åŠ¡æäº¤åæ‰ä¼šè¢«ä¼ è¾“ï¼Œè‹¥ä¸»æœåŠ¡å™¨å‘ç”Ÿç¾éš¾æ€§æ•…éšœï¼Œæœªä¼ è¾“çš„äº‹åŠ¡ä¼šä¸¢å¤±ï¼›</li>
<li><strong>æ•°æ®ä¸¢å¤±çª—å£æ§åˆ¶</strong>ï¼šåŸºäºæ–‡ä»¶çš„æ—¥å¿—ä¼ é€å¯é€šè¿‡<code>archive_timeout</code>å‚æ•°é™åˆ¶æ•°æ®ä¸¢å¤±çª—å£ï¼ˆæœ€ä½å¯è®¾ä¸ºå‡ ç§’ï¼‰ï¼Œä½†è¿‡ä½çš„è®¾ç½®ä¼šå¢åŠ å¸¦å®½æ¶ˆè€—ï¼›æµå¤åˆ¶åˆ™å¯å®ç°æ›´å°çš„æ•°æ®ä¸¢å¤±çª—å£ï¼Œæ— éœ€ä¾èµ–<code>archive_timeout</code>ï¼›</li>
<li><strong>å¿«é€Ÿæ•…éšœè½¬ç§»</strong>ï¼šåå¤‡æœåŠ¡å™¨çš„æ¢å¤æ€§èƒ½ä¼˜å¼‚ï¼Œæ¿€æ´»åé€šå¸¸å‡ ç§’å†…å³å¯å…¨é¢å¯ç”¨ï¼Œè¯¥é…ç½®ä¹Ÿè¢«ç§°ä¸º<strong>çƒ­å¤‡ä»½é…ç½®</strong>ï¼›</li>
<li><strong>åªè¯»æŸ¥è¯¢èƒ½åŠ›</strong>ï¼šåå¤‡æœåŠ¡å™¨å¯å¼€å¯çƒ­å¤‡ä»½æ¨¡å¼ï¼Œæ‰¿æ¥åªè¯»æŸ¥è¯¢è¯·æ±‚ï¼Œæå‡é›†ç¾¤æ•´ä½“è¯»å†™åˆ†ç¦»èƒ½åŠ›ã€‚</li>
</ol>
<h4 data-id="heading-6">1.4 æµå¤åˆ¶ä¸åŸºäºæ–‡ä»¶æ—¥å¿—ä¼ é€çš„åŒºåˆ«</h4>
<p><strong>æµå¤åˆ¶</strong>æ˜¯å¯¹åŸºäºæ–‡ä»¶æ—¥å¿—ä¼ é€çš„å‡çº§ï¼Œå…¶æ ¸å¿ƒå·®å¼‚åœ¨äºï¼šæ— éœ€ç­‰å¾…WALæ®µæ–‡ä»¶è¢«å¡«æ»¡ï¼Œä¸»æœåŠ¡å™¨åœ¨ç”ŸæˆWALè®°å½•æ—¶<strong>å®æ—¶æµå¼ä¼ è¾“</strong>ç»™åå¤‡æœåŠ¡å™¨ï¼Œåå¤‡æœåŠ¡å™¨å¢é‡æ¥æ”¶å¹¶åº”ç”¨ï¼ŒåŒæ­¥å»¶è¿Ÿé€šå¸¸ä½äº1ç§’ï¼ˆåå¤‡æœåŠ¡å™¨æ€§èƒ½å¯åŒ¹é…ä¸»æœåŠ¡å™¨è´Ÿè½½æ—¶ï¼‰ã€‚</p>
<p>æµå¤åˆ¶éœ€åŸºäºTCPè¿æ¥å®ç°ä¸»å¤‡ç›´è¿ï¼Œè€Œåå¤‡æœåŠ¡å™¨ä»ä¼šä¼˜å…ˆé‡æ”¾å½’æ¡£ä¸­çš„WALæ®µæ–‡ä»¶ï¼Œå†é€šè¿‡æµå¤åˆ¶æ¥æ”¶å®æ—¶WALè®°å½•ã€‚</p>
<h3 data-id="heading-7">2 å‰æœŸè§„åˆ’è¦ç‚¹</h3>
<p>ä¸ºä¿è¯ä¸»å¤‡é›†ç¾¤çš„ç¨³å®šæ€§ä¸å…¼å®¹æ€§ï¼Œæ­å»ºå‰éœ€éµå¾ªä»¥ä¸‹è§„åˆ’åŸåˆ™ï¼Œè¿™æ˜¯é¿å…åç»­é…ç½®å¤±è´¥ã€æ•°æ®ä¸ä¸€è‡´çš„å…³é”®ã€‚</p>
<h4 data-id="heading-8">2.1 æœåŠ¡å™¨ç¯å¢ƒä¸€è‡´æ€§</h4>
<ol>
<li><strong>è¡¨ç©ºé—´è·¯å¾„</strong>ï¼šè‹¥ä½¿ç”¨è¡¨ç©ºé—´ç‰¹æ€§ï¼Œä¸»æœåŠ¡å™¨ä¸æ‰€æœ‰åå¤‡æœåŠ¡å™¨çš„è¡¨ç©ºé—´<strong>æŒ‚è½½è·¯å¾„å¿…é¡»å®Œå…¨ä¸€è‡´</strong>ï¼Œ<code>CREATE TABLESPACE</code>å‘½ä»¤æ‰§è¡Œå‰ï¼Œéœ€åœ¨æ‰€æœ‰èŠ‚ç‚¹æå‰åˆ›å»ºå¯¹åº”çš„æŒ‚è½½ç‚¹ï¼›</li>
<li><strong>ç¡¬ä»¶æ¶æ„</strong>ï¼šä¸»å¤‡æœåŠ¡å™¨çš„<strong>ç¡¬ä»¶æ¶æ„å¿…é¡»ç›¸åŒ</strong>ï¼ˆ32ä½ä¸64ä½ç³»ç»Ÿæ— æ³•äº’é€šï¼‰ï¼Œç¡¬ä»¶é…ç½®æ— éœ€å®Œå…¨ä¸€è‡´ï¼Œä½†ç›¸åŒé…ç½®æ›´ä¾¿äºåæœŸç»´æŠ¤ï¼›</li>
<li><strong>ç³»ç»Ÿç¯å¢ƒ</strong>ï¼šå»ºè®®ä¸»å¤‡èŠ‚ç‚¹ä½¿ç”¨ç›¸åŒçš„æ“ä½œç³»ç»Ÿã€å†…æ ¸ç‰ˆæœ¬åŠä¾èµ–åº“ï¼Œå‡å°‘ç¯å¢ƒå·®å¼‚å¯¼è‡´çš„å…¼å®¹é—®é¢˜ã€‚</li>
</ol>
<h4 data-id="heading-9">2.2 PostgreSQLç‰ˆæœ¬å…¼å®¹æ€§</h4>
<ol>
<li><strong>ä¸»ç‰ˆæœ¬</strong>ï¼š<strong>ä¸åŒä¸»ç‰ˆæœ¬çš„PostgreSQLä¹‹é—´æ— æ³•è¿›è¡Œæ—¥å¿—ä¼ é€</strong>ï¼ˆå¦‚13.xä¸14.xï¼‰ï¼ŒWALæ ¼å¼å­˜åœ¨ä¸å…¼å®¹ï¼›</li>
<li><strong>æ¬¡ç‰ˆæœ¬</strong>ï¼šPostgreSQLä¸ä¼šåœ¨æ¬¡ç‰ˆæœ¬å‡çº§ä¸­ä¿®æ”¹ç£ç›˜æ ¼å¼ï¼Œä¸»å¤‡èŠ‚ç‚¹å¯è¿è¡Œä¸åŒæ¬¡ç‰ˆæœ¬ï¼ˆå¦‚15.3ä¸15.4ï¼‰ï¼Œä½†<strong>å»ºè®®ä¿æŒç‰ˆæœ¬å®Œå…¨ä¸€è‡´</strong>ï¼›</li>
<li><strong>ç‰ˆæœ¬å‡çº§ç­–ç•¥</strong>ï¼šå‡çº§æ¬¡ç‰ˆæœ¬æ—¶ï¼Œ<strong>ä¼˜å…ˆå‡çº§åå¤‡æœåŠ¡å™¨</strong>ï¼Œæ–°ç‰ˆæœ¬é€šå¸¸å…¼å®¹ä»æ—§æ¬¡ç‰ˆæœ¬è¯»å–WALæ–‡ä»¶ï¼Œå¯æœ€å¤§ç¨‹åº¦ä¿è¯é›†ç¾¤å¯ç”¨æ€§ã€‚</li>
</ol>
<h3 data-id="heading-10">3 åå¤‡æœåŠ¡å™¨æ ¸å¿ƒæ“ä½œ</h3>
<p>åå¤‡æœåŠ¡å™¨çš„æ ¸å¿ƒçŠ¶æ€ä¸º<strong>standbyæ¨¡å¼</strong>ï¼Œå…¶å¯åŠ¨ã€WALè¯»å–ã€æ¨¡å¼é€€å‡ºå‡éµå¾ªå›ºå®šçš„æ‰§è¡Œé€»è¾‘ï¼Œæ˜¯ä¸»å¤‡åŒæ­¥çš„åŸºç¡€ã€‚</p>
<h4 data-id="heading-11">3.1 Standbyæ¨¡å¼å¯åŠ¨</h4>
<p>æœåŠ¡å™¨å¯åŠ¨æ—¶ï¼Œè‹¥<strong>æ•°æ®ç›®å½•ä¸­å­˜åœ¨</strong> <strong><code>standby.signal</code></strong> <strong>æ–‡ä»¶</strong>ï¼Œåˆ™è‡ªåŠ¨è¿›å…¥standbyæ¨¡å¼ï¼Œæ— éœ€é¢å¤–å¯åŠ¨å‚æ•°ã€‚</p>
<h4 data-id="heading-12">3.2 WALè¯»å–ä¸åº”ç”¨çš„ä¼˜å…ˆçº§</h4>
<p>åå¤‡æœåŠ¡å™¨ä¼šæŒ‰ä»¥ä¸‹<strong>å¾ªç¯é¡ºåº</strong>è¯»å–å¹¶åº”ç”¨WALï¼Œç›´è‡³æœåŠ¡å™¨åœæ­¢æˆ–è¢«æå‡ä¸ºä¸»æœåŠ¡å™¨ï¼š</p>
<ol>
<li>è°ƒç”¨<code>restore_command</code>ä»<strong>WALå½’æ¡£ç›®å½•</strong>æ¢å¤æ‰€æœ‰å¯ç”¨çš„WALæ®µæ–‡ä»¶ï¼Œè‹¥è¯¥å‘½ä»¤æ‰§è¡Œå¤±è´¥åˆ™è¿›å…¥ä¸‹ä¸€æ­¥ï¼›</li>
<li>è¯»å–å¹¶æ¢å¤æœ¬åœ°<code>pg_wal</code>ç›®å½•ä¸­å­˜åœ¨çš„WALæ®µæ–‡ä»¶ï¼Œè‹¥æ— å¯ç”¨æ–‡ä»¶åˆ™è¿›å…¥ä¸‹ä¸€æ­¥ï¼›</li>
<li>è‹¥é…ç½®äº†æµå¤åˆ¶ï¼Œå°è¯•é€šè¿‡TCPè¿æ¥ä¸»æœåŠ¡å™¨ï¼Œä»å½’æ¡£/æœ¬åœ°pg_walä¸­æœ€åä¸€ä¸ªæœ‰æ•ˆè®°å½•å¼€å§‹<strong>æµå¼æ¥æ”¶WAL</strong>ï¼›è‹¥è¿æ¥å¤±è´¥ã€æœªé…ç½®æµå¤åˆ¶æˆ–åç»­è¿æ¥æ–­å¼€ï¼Œåˆ™è¿”å›æ­¥éª¤1é‡æ–°å°è¯•ã€‚</li>
</ol>
<h4 data-id="heading-13">3.3 é€€å‡ºStandbyæ¨¡å¼ï¼ˆæå‡ä¸ºä¸»æœåŠ¡å™¨ï¼‰</h4>
<p>æ‰§è¡Œä»¥ä¸‹ä»»ä¸€æ“ä½œï¼Œåå¤‡æœåŠ¡å™¨å°†ç«‹å³é€€å‡ºstandbyæ¨¡å¼ï¼Œåˆ‡æ¢ä¸ºæ­£å¸¸æ“ä½œæ¨¡å¼ï¼Œæˆä¸ºæ–°çš„ä¸»æœåŠ¡å™¨ï¼š</p>
<ol>
<li>æ‰§è¡Œå‘½ä»¤ï¼š<code>pg_ctl promote</code>ï¼›</li>
<li>è°ƒç”¨SQLå‡½æ•°ï¼š<code>pg_promote()</code>ã€‚</li>
</ol>
<p><strong>æ³¨æ„</strong>ï¼šæ•…éšœè½¬ç§»ï¼ˆæå‡ï¼‰å‰ï¼Œåå¤‡æœåŠ¡å™¨ä¼šä¼˜å…ˆæ¢å¤å½’æ¡£/æœ¬åœ°pg_walä¸­æ‰€æœ‰ç«‹å³å¯ç”¨çš„WALï¼Œä½†ä¸ä¼šå°è¯•è¿æ¥åŸä¸»æœåŠ¡å™¨ã€‚</p>
<h3 data-id="heading-14">4 ä¸ºä¸»æœåŠ¡å™¨é…ç½®åå¤‡ç¯å¢ƒ</h3>
<p>ä¸»æœåŠ¡å™¨æ˜¯WALçš„ç”Ÿæˆæºï¼Œéœ€å®Œæˆ<strong>è¿ç»­å½’æ¡£é…ç½®</strong>ã€<strong>å¤åˆ¶æƒé™é…ç½®</strong>ã€<strong>åŸºç¡€å¤‡ä»½ç”Ÿæˆ</strong>ä¸‰æ­¥æ“ä½œï¼Œä¸ºåå¤‡æœåŠ¡å™¨æä¾›åŒæ­¥åŸºç¡€ã€‚</p>
<h4 data-id="heading-15">4.1 é…ç½®è¿ç»­å½’æ¡£</h4>
<p>æŒ‰PostgreSQLè¿ç»­å½’æ¡£è§„èŒƒï¼Œåœ¨ä¸»æœåŠ¡å™¨çš„<code>postgresql.conf</code>ä¸­é…ç½®WALå½’æ¡£å‚æ•°ï¼Œæ ¸å¿ƒè¦æ±‚ï¼š</p>
<ol>
<li>å½’æ¡£ç›®å½•éœ€ä¸º<strong>åå¤‡æœåŠ¡å™¨å¯è®¿é—®çš„ä½ç½®</strong>ï¼ˆå¦‚åå¤‡æœåŠ¡å™¨æœ¬åœ°ç›®å½•ã€NFSå…±äº«ç›®å½•ã€è¿œç¨‹FTP/SCPç›®å½•ï¼‰ï¼Œ<strong>ç¦æ­¢å°†å½’æ¡£ç›®å½•é…ç½®åœ¨ä¸»æœåŠ¡å™¨æœ¬åœ°</strong>ï¼ˆä¸»æœåŠ¡å™¨æ•…éšœååå¤‡æœåŠ¡å™¨æ— æ³•è®¿é—®ï¼‰ï¼›</li>
<li>æ ¸å¿ƒé…ç½®å‚æ•°åŒ…æ‹¬<code>wal_level</code>ï¼ˆéœ€è®¾ä¸º<code>replica</code>æˆ–æ›´é«˜ï¼‰ã€<code>archive_mode</code>ï¼ˆå¼€å¯ï¼‰ã€<code>archive_command</code>ï¼ˆWALå½’æ¡£å‘½ä»¤ï¼‰ï¼Œå…·ä½“é…ç½®å¯å‚è€ƒPostgreSQLè¿ç»­å½’æ¡£å®˜æ–¹æ–‡æ¡£ã€‚</li>
</ol>
<h4 data-id="heading-16">4.2 æµå¤åˆ¶ç›¸å…³é…ç½®ï¼ˆè‹¥ä½¿ç”¨ï¼‰</h4>
<p>è‹¥åå¤‡æœåŠ¡å™¨é‡‡ç”¨æµå¤åˆ¶æ–¹å¼åŒæ­¥WALï¼Œä¸»æœåŠ¡å™¨éœ€é…ç½®<strong>å¤åˆ¶è¿æ¥è®¤è¯</strong>ä¸<strong>å¹¶å‘è¿æ¥é™åˆ¶</strong>ï¼š</p>
<ol>
<li>
<p><strong>åˆ›å»ºå¤åˆ¶ä¸“ç”¨è§’è‰²</strong>ï¼šéœ€èµ‹äºˆ<code>REPLICATION</code>å’Œ<code>LOGIN</code>æƒé™ï¼Œæ¨èä¸“ç”¨è§’è‰²è€Œéè¶…çº§ç”¨æˆ·ï¼ˆ<code>REPLICATION</code>æƒé™ä»…ç”¨äºå¤åˆ¶ï¼Œæ— æ³•ä¿®æ”¹ä¸»æœåŠ¡å™¨æ•°æ®ï¼‰ï¼Œç¤ºä¾‹ï¼š</p>
<ol>
<li>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> ROLE repl_user <span class="hljs-keyword">WITH</span> REPLICATION LOGIN PASSWORD <span class="hljs-string">'repl_pass'</span>;
</code></pre>
</li>
</ol>
</li>
<li>
<p><strong>é…ç½®pg_hba.conf</strong>ï¼šæ·»åŠ å¤åˆ¶è¿æ¥çš„è®¿é—®æ§åˆ¶è§„åˆ™ï¼ŒæŒ‡å®šåå¤‡æœåŠ¡å™¨IPã€å¤åˆ¶è§’è‰²ä¸è®¤è¯æ–¹å¼ï¼Œç¤ºä¾‹ï¼š</p>
<ol>
<li>
<pre><code class="hljs language-sql" lang="sql"># TYPE  DATABASE        <span class="hljs-keyword">USER</span>            ADDRESS             <span class="hljs-keyword">METHOD</span>
host    replication     repl_user       <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.100</span><span class="hljs-operator">/</span><span class="hljs-number">32</span>    md5
</code></pre>
</li>
</ol>
</li>
<li>
<p><strong>ä¿®æ”¹postgresql.confæ ¸å¿ƒå‚æ•°</strong>ï¼š</p>
<ol>
<li><code>max_wal_senders</code>ï¼šè®¾ç½®æœ€å¤§WALå‘é€è¿›ç¨‹æ•°ï¼Œéœ€å¤§äºç­‰äºåå¤‡æœåŠ¡å™¨æ•°é‡ï¼ˆæµå¤åˆ¶ä¸“ç”¨ï¼‰ï¼›</li>
<li><code>max_replication_slots</code>ï¼šè‹¥ä½¿ç”¨å¤åˆ¶æ§½ï¼Œéœ€è®¾ç½®ä¸ºå¤§äºç­‰äºå¤åˆ¶æ§½æ•°é‡ï¼›</li>
<li><code>listen_addresses</code>ï¼šéœ€åŒ…å«åå¤‡æœåŠ¡å™¨å¯è®¿é—®çš„IPï¼ˆå¦‚<code>*</code>æˆ–ä¸»æœåŠ¡å™¨å†…ç½‘IPï¼‰ï¼›</li>
<li>å¯é€‰ï¼š<code>wal_keep_size</code>ï¼šè®¾ç½®ä¿ç•™çš„WALæ®µæ–‡ä»¶å¤§å°ï¼Œé˜²æ­¢åå¤‡æœåŠ¡å™¨æœªåŠæ—¶æ¥æ”¶æ—¶WALè¢«å›æ”¶ã€‚</li>
</ol>
</li>
<li>
<p>é‡å¯ä¸»æœåŠ¡å™¨æˆ–æ‰§è¡Œ<code>pg_ctl reload</code>ä½¿é…ç½®ç”Ÿæ•ˆã€‚</p>
</li>
</ol>
<h4 data-id="heading-17">4.3 ç”ŸæˆåŸºç¡€å¤‡ä»½</h4>
<p>åå¤‡æœåŠ¡å™¨éœ€è¦ä¸»æœåŠ¡å™¨çš„<strong>åŸºç¡€å¤‡ä»½</strong>ä½œä¸ºæ•°æ®åŒæ­¥çš„åŸºçº¿ï¼ŒæŒ‰PostgreSQLå®˜æ–¹æ–¹å¼ç”ŸæˆåŸºç¡€å¤‡ä»½ï¼ˆå¦‚ä½¿ç”¨<code>pg_basebackup</code>å‘½ä»¤ï¼‰ï¼Œç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pg_basebackup -h 192.168.1.50 -U repl_user -D /pgdata/standby -P -X stream
</code></pre>
<p>å…¶ä¸­<code>/pgdata/standby</code>ä¸ºåå¤‡æœåŠ¡å™¨çš„æ•°æ®ç›®å½•ï¼Œ<code>-X stream</code>è¡¨ç¤ºæµå¼å¤åˆ¶WALï¼Œä¿è¯å¤‡ä»½çš„ä¸€è‡´æ€§ã€‚</p>
<h3 data-id="heading-18">5 æ­å»ºåå¤‡æœåŠ¡å™¨</h3>
<p>åŸºäºä¸»æœåŠ¡å™¨çš„åŸºç¡€å¤‡ä»½ï¼Œå®Œæˆåå¤‡æœåŠ¡å™¨çš„ç›®å½•é…ç½®ã€å‚æ•°é…ç½®ï¼Œå³å¯å®ç°åå¤‡æœåŠ¡å™¨çš„æ­å»ºï¼Œæ”¯æŒå•ä¸»å¤šå¤‡æ¶æ„ï¼Œæ­¥éª¤å¦‚ä¸‹ã€‚</p>
<h4 data-id="heading-19">5.1 æ¢å¤åŸºç¡€å¤‡ä»½</h4>
<p>å°†ä¸»æœåŠ¡å™¨ç”Ÿæˆçš„åŸºç¡€å¤‡ä»½è§£å‹/æ¢å¤åˆ°åå¤‡æœåŠ¡å™¨çš„<strong>æ•°æ®ç›®å½•</strong>ï¼ˆéœ€ä¸ºç©ºï¼Œä¸”ç›®å½•æ‰€å±ç”¨æˆ·ä¸ºpostgresï¼‰ï¼Œç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å‡è®¾åŸºç¡€å¤‡ä»½æ–‡ä»¶ä¸ºpg_basebackup.tarï¼Œæ¢å¤åˆ°åå¤‡æœåŠ¡å™¨æ•°æ®ç›®å½•</span>
tar -xf pg_basebackup.tar -C /pgdata/standby
<span class="hljs-built_in">chown</span> -R postgres:postgres /pgdata/standby
</code></pre>
<h4 data-id="heading-20">5.2 åˆ›å»ºStandbyæ¨¡å¼æ ‡è¯†æ–‡ä»¶</h4>
<p>åœ¨åå¤‡æœåŠ¡å™¨çš„æ•°æ®ç›®å½•ä¸­åˆ›å»º<code>standby.signal</code>æ–‡ä»¶ï¼Œæ ‡è¯†è¯¥èŠ‚ç‚¹ä¸ºåå¤‡æœåŠ¡å™¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">touch</span> /pgdata/standby/standby.signal
<span class="hljs-built_in">chown</span> postgres:postgres /pgdata/standby/standby.signal
</code></pre>
<h4 data-id="heading-21">5.3 é…ç½®postgresql.confæ ¸å¿ƒå‚æ•°</h4>
<p>åå¤‡æœåŠ¡å™¨éœ€é…ç½®WALæ¢å¤ç›¸å…³å‚æ•°ï¼Œæ ¸å¿ƒé…ç½®ï¼š</p>
<ol>
<li>
<p><strong>restore_command</strong>ï¼šä»WALå½’æ¡£ç›®å½•å¤åˆ¶WALæ®µæ–‡ä»¶çš„å‘½ä»¤ï¼Œéœ€ä¸ä¸»æœåŠ¡å™¨å½’æ¡£ç›®å½•åŒ¹é…ï¼Œç¤ºä¾‹ï¼š</p>
<ol>
<li>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">restore_command</span> = <span class="hljs-string">'cp /nfs/wal_archive/%f %p'</span>
</code></pre>
</li>
<li>Â Â <strong>æ³¨æ„</strong>ï¼šè¯¥å‘½ä»¤éœ€<strong>ç«‹å³è¿”å›</strong>ï¼Œåå¤‡æœåŠ¡å™¨ä¼šè‡ªåŠ¨å¾ªç¯é‡è¯•ï¼Œæ— éœ€è®¾ç½®é˜»å¡é€»è¾‘ï¼›</li>
</ol>
</li>
<li>
<p><strong>recovery_target_timeline</strong>ï¼šè®¾ä¸º<code>latest</code>ï¼ˆé»˜è®¤å€¼ï¼‰ï¼Œä¿è¯åå¤‡æœåŠ¡å™¨èƒ½è·Ÿéšæ•…éšœè½¬ç§»åçš„æ–°ä¸»æœåŠ¡å™¨çš„æ—¶é—´çº¿å˜åŒ–ï¼›</p>
</li>
<li>
<p><strong>hot_standby</strong>ï¼šè®¾ä¸º<code>on</code>ï¼ˆå¯é€‰ï¼‰ï¼Œå¼€å¯çƒ­å¤‡ä»½æ¨¡å¼ï¼Œå…è®¸åå¤‡æœåŠ¡å™¨æ‰¿æ¥åªè¯»æŸ¥è¯¢ï¼›</p>
</li>
<li>
<p>è‹¥ä¸ºé«˜æ€§èƒ½åœºæ™¯ï¼Œå¯é…ç½®ä¸ä¸»æœåŠ¡å™¨ç›¸åŒçš„<code>shared_buffers</code>ã€<code>work_mem</code>ç­‰æ€§èƒ½å‚æ•°ã€‚</p>
</li>
</ol>
<h4 data-id="heading-22">5.4 é…ç½®æµå¤åˆ¶è¿æ¥ï¼ˆè‹¥ä½¿ç”¨ï¼‰</h4>
<p>è‹¥é‡‡ç”¨æµå¤åˆ¶æ–¹å¼ï¼Œéœ€åœ¨åå¤‡æœåŠ¡å™¨çš„<strong>æ•°æ®ç›®å½•ä¸­åˆ›å»º</strong> <strong><code>postgresql.auto.conf</code></strong> <strong>æ–‡ä»¶</strong>ï¼ˆæˆ–ä¿®æ”¹postgresql.confï¼‰ï¼Œé…ç½®ä¸»æœåŠ¡å™¨è¿æ¥ä¿¡æ¯ä¸å¯é€‰çš„å¤åˆ¶æ§½ï¼Œæ ¸å¿ƒå‚æ•°ï¼š</p>
<ol>
<li>
<p><strong>primary_conninfo</strong>ï¼šlibpqæ ¼å¼çš„ä¸»æœåŠ¡å™¨è¿æ¥å­—ç¬¦ä¸²ï¼ŒåŒ…å«ä¸»æœåŠ¡å™¨IPã€ç«¯å£ã€å¤åˆ¶è§’è‰²ã€å¯†ç ç­‰ï¼Œç¤ºä¾‹ï¼š</p>
<ol>
<li>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">primary_conninfo</span> = <span class="hljs-string">'host=192.168.1.50 port=5432 user=repl_user password=repl_pass options='</span><span class="hljs-string">'-c wal_sender_timeout=5000'</span><span class="hljs-string">''</span>
</code></pre>
</li>
</ol>
</li>
<li>
<p><strong>primary_slot_name</strong>ï¼šè‹¥ä½¿ç”¨å¤åˆ¶æ§½ï¼ŒæŒ‡å®šä¸»æœåŠ¡å™¨ä¸Šåˆ›å»ºçš„å¤åˆ¶æ§½åç§°ï¼Œç¤ºä¾‹ï¼š</p>
<ol>
<li>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">primary_slot_name</span> = <span class="hljs-string">'standby_01_slot'</span>
</code></pre>
</li>
</ol>
</li>
</ol>
<h4 data-id="heading-23">5.5 é…ç½®WALå½’æ¡£æ¸…ç†ï¼ˆå¯é€‰ï¼‰</h4>
<p>è‹¥ä½¿ç”¨WALå½’æ¡£ï¼Œå¯é€šè¿‡<code>archive_cleanup_command</code>å‚æ•°è‡ªåŠ¨æ¸…ç†åå¤‡æœåŠ¡å™¨ä¸å†éœ€è¦çš„WALæ®µæ–‡ä»¶ï¼Œå‡å°‘å½’æ¡£ç›®å½•å ç”¨ï¼Œæ¨èä½¿ç”¨PostgreSQLè‡ªå¸¦çš„<code>pg_archivecleanup</code>å·¥å…·ï¼Œç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">archive_cleanup_command</span> = <span class="hljs-string">'pg_archivecleanup /nfs/wal_archive %r'</span>
</code></pre>
<p><strong>æ³¨æ„</strong>ï¼šè‹¥å½’æ¡£ç›®å½•åŒæ—¶ç”¨äºç¾éš¾æ¢å¤ï¼Œéœ€ä¿ç•™è‡³å°‘æœ€åä¸€ä¸ªåŸºç¡€å¤‡ä»½å¯¹åº”çš„WALæ–‡ä»¶ï¼Œé¿å…æ¸…ç†åæ— æ³•æ¢å¤ã€‚</p>
<h4 data-id="heading-24">5.6 å¯åŠ¨åå¤‡æœåŠ¡å™¨</h4>
<p>å®Œæˆä»¥ä¸Šé…ç½®åï¼Œå¯åŠ¨åå¤‡æœåŠ¡å™¨ï¼Œç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pg_ctl -D /pgdata/standby start
</code></pre>
<p>å¯åŠ¨åå¯é€šè¿‡<code>pg_stat_wal_receiver</code>è§†å›¾éªŒè¯æµå¤åˆ¶è¿æ¥çŠ¶æ€ï¼ˆè‹¥ä½¿ç”¨æµå¤åˆ¶ï¼‰ã€‚</p>
<h4 data-id="heading-25">5.7 å¤šåå¤‡æœåŠ¡å™¨é…ç½®æ³¨æ„äº‹é¡¹</h4>
<p>è‹¥æ­å»ºå¤šå°åå¤‡æœåŠ¡å™¨ï¼Œéœ€ä¿è¯ï¼š</p>
<ol>
<li>æ¯å°åå¤‡æœåŠ¡å™¨å‡å®Œæˆä¸Šè¿°ç‹¬ç«‹é…ç½®ï¼Œæ•°æ®ç›®å½•ç›¸äº’ç‹¬ç«‹ï¼›</li>
<li>ä¸»æœåŠ¡å™¨çš„<code>max_wal_senders</code>å‚æ•°å€¼å¤§äºç­‰äºåå¤‡æœåŠ¡å™¨æ•°é‡ï¼Œä¿è¯æ‰€æœ‰åå¤‡æœåŠ¡å™¨èƒ½åŒæ—¶å»ºç«‹æµå¤åˆ¶è¿æ¥ï¼›</li>
<li>è‹¥ä½¿ç”¨å¤åˆ¶æ§½ï¼Œä¸ºä¸»æœåŠ¡å™¨çš„æ¯å°åå¤‡æœåŠ¡å™¨åˆ›å»º<strong>ç‹¬ç«‹çš„å¤åˆ¶æ§½</strong>ï¼Œé¿å…æ§½å†²çªã€‚</li>
</ol>
<h3 data-id="heading-26">6 æµå¤åˆ¶é«˜çº§é…ç½®ä¸ç›‘æ§</h3>
<p>æµå¤åˆ¶æ˜¯ç”Ÿäº§ç¯å¢ƒä¸­æœ€å¸¸ç”¨çš„åŒæ­¥æ–¹å¼ï¼Œé™¤åŸºç¡€è¿æ¥é…ç½®å¤–ï¼Œè¿˜éœ€æŒæ¡<strong>è¿æ¥ä¿æ´»</strong>ã€<strong>åŒæ­¥çŠ¶æ€ç›‘æ§</strong>ã€<strong>å¼‚å¸¸å¤„ç†</strong>ç­‰é«˜çº§æ“ä½œã€‚</p>
<h4 data-id="heading-27">6.1 é…ç½®æµå¤åˆ¶è¿æ¥ä¿æ´»</h4>
<p>åœ¨ä¸»æœåŠ¡å™¨çš„<code>postgresql.conf</code>æˆ–åå¤‡æœåŠ¡å™¨çš„<code>primary_conninfo</code>ä¸­é…ç½®TCPä¿æ´»å‚æ•°ï¼Œç¡®ä¿ä¸»æœåŠ¡å™¨èƒ½å¿«é€Ÿæ£€æµ‹åˆ°æ–­å¼€çš„è¿æ¥ï¼Œé€‚ç”¨äºæ”¯æŒkeepaliveå¥—æ¥å­—çš„ç³»ç»Ÿï¼Œç¤ºä¾‹ï¼ˆåœ¨primary_conninfoä¸­é…ç½®ï¼‰ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">primary_conninfo</span> = <span class="hljs-string">'host=192.168.1.50 port=5432 user=repl_user password=repl_pass tcp_keepalives_idle=30 tcp_keepalives_interval=5 tcp_keepalives_count=6'</span>
</code></pre>
<p>å‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li><code>tcp_keepalives_idle</code>ï¼šTCPè¿æ¥ç©ºé—²å¤šä¹…åå‘é€ä¿æ´»åŒ…ï¼ˆç§’ï¼‰ï¼›</li>
<li><code>tcp_keepalives_interval</code>ï¼šä¿æ´»åŒ…å‘é€é—´éš”ï¼ˆç§’ï¼‰ï¼›</li>
<li><code>tcp_keepalives_count</code>ï¼šè¿ç»­å‘é€å¤šå°‘ä¸ªä¿æ´»åŒ…æ— å“åº”åˆ™æ–­å¼€è¿æ¥ã€‚</li>
</ul>
<h4 data-id="heading-28">6.2 æµå¤åˆ¶çŠ¶æ€ç›‘æ§</h4>
<p>æµå¤åˆ¶çš„æ ¸å¿ƒç›‘æ§æŒ‡æ ‡æ˜¯<strong>ä¸»å¤‡WALå»¶è¿Ÿ</strong>ï¼Œéœ€é€šè¿‡ä¸»å¤‡èŠ‚ç‚¹çš„ç³»ç»Ÿè§†å›¾/å‡½æ•°è”åˆæŸ¥è¯¢ï¼Œæ ¸å¿ƒç›‘æ§é¡¹ä¸æŸ¥è¯¢æ–¹å¼å¦‚ä¸‹ã€‚</p>
<h5 data-id="heading-29">6.2.1 æ ¸å¿ƒWALä½ç½®å‡½æ•°</h5>
<ul>
<li>ä¸»æœåŠ¡å™¨ï¼š<code>pg_current_wal_lsn()</code> â†’ å½“å‰WALå†™å…¥ä½ç½®ï¼›</li>
<li>åå¤‡æœåŠ¡å™¨ï¼š<code>pg_last_wal_receive_lsn()</code> â†’ æœ€åæ¥æ”¶çš„WALä½ç½®ï¼›</li>
<li>åå¤‡æœåŠ¡å™¨ï¼š<code>pg_last_wal_replay_lsn()</code> â†’ æœ€ååº”ç”¨çš„WALä½ç½®ã€‚</li>
</ul>
<p><strong>WALå»¶è¿Ÿè®¡ç®—</strong>ï¼š</p>
<ul>
<li>æ¥æ”¶å»¶è¿Ÿ = ä¸»æœåŠ¡å™¨pg_current_wal_lsn() - åå¤‡æœåŠ¡å™¨pg_last_wal_receive_lsn()ï¼›</li>
<li>åº”ç”¨å»¶è¿Ÿ = åå¤‡æœåŠ¡å™¨pg_last_wal_receive_lsn() - åå¤‡æœåŠ¡å™¨pg_last_wal_replay_lsn()ã€‚</li>
</ul>
<h5 data-id="heading-30">6.2.2 ä¸»æœåŠ¡å™¨ç›‘æ§è§†å›¾ï¼špg_stat_replication</h5>
<p>è¯¥è§†å›¾å±•ç¤ºä¸»æœåŠ¡å™¨ä¸Šæ‰€æœ‰WALå‘é€è¿›ç¨‹çš„çŠ¶æ€ï¼Œæ ¸å¿ƒå­—æ®µï¼š</p>
<ul>
<li><code>sent_lsn</code>ï¼šä¸»æœåŠ¡å™¨å·²å‘é€çš„WALä½ç½®ï¼›</li>
<li><code>write_lsn</code>ï¼šåå¤‡æœåŠ¡å™¨å·²å†™å…¥æœ¬åœ°çš„WALä½ç½®ï¼›</li>
<li><code>flush_lsn</code>ï¼šåå¤‡æœåŠ¡å™¨å·²åˆ·å†™åˆ°ç£ç›˜çš„WALä½ç½®ï¼›</li>
<li><code>replay_lsn</code>ï¼šåå¤‡æœåŠ¡å™¨å·²åº”ç”¨çš„WALä½ç½®ï¼›</li>
<li><code>sync_state</code>ï¼šåŒæ­¥çŠ¶æ€ï¼ˆ<code>async</code>ä¸ºå¼‚æ­¥ï¼Œ<code>sync</code>ä¸ºåŒæ­¥ï¼Œ<code>potential</code>ä¸ºæ½œåœ¨åŒæ­¥ï¼‰ã€‚</li>
</ul>
<p><strong>å¼‚å¸¸åˆ¤æ–­</strong>ï¼š</p>
<ul>
<li><code>pg_current_wal_lsn()</code>ä¸<code>sent_lsn</code>å·®è·è¿‡å¤§ â†’ ä¸»æœåŠ¡å™¨è´Ÿè½½è¿‡é«˜ï¼Œæ— æ³•åŠæ—¶å‘é€WALï¼›</li>
<li><code>sent_lsn</code>ä¸åå¤‡æœåŠ¡å™¨<code>pg_last_wal_receive_lsn()</code>å·®è·è¿‡å¤§ â†’ ç½‘ç»œå»¶è¿Ÿæˆ–åå¤‡æœåŠ¡å™¨æ¥æ”¶èƒ½åŠ›ä¸è¶³ã€‚</li>
</ul>
<h5 data-id="heading-31">6.2.3 åå¤‡æœåŠ¡å™¨ç›‘æ§è§†å›¾ï¼špg_stat_wal_receiver</h5>
<p>è¯¥è§†å›¾å±•ç¤ºåå¤‡æœåŠ¡å™¨ä¸ŠWALæ¥æ”¶è¿›ç¨‹çš„çŠ¶æ€ï¼Œæ ¸å¿ƒå­—æ®µï¼š</p>
<ul>
<li><code>flushed_lsn</code>ï¼šå·²åˆ·å†™åˆ°ç£ç›˜çš„WALä½ç½®ï¼›</li>
<li><code>received_lsn</code>ï¼šå·²æ¥æ”¶çš„WALä½ç½®ï¼›</li>
<li><code>replay_lsn</code>ï¼šå·²åº”ç”¨çš„WALä½ç½®ã€‚</li>
</ul>
<p><strong>å¼‚å¸¸åˆ¤æ–­</strong>ï¼š<code>received_lsn</code>ä¸<code>flushed_lsn</code>/<code>replay_lsn</code>å·®è·è¿‡å¤§ â†’ åå¤‡æœåŠ¡å™¨WALæ¥æ”¶é€Ÿåº¦å¤§äºåº”ç”¨é€Ÿåº¦ï¼Œè´Ÿè½½è¿‡é«˜ã€‚</p>
<h4 data-id="heading-32">6.3 æ— å½’æ¡£æµå¤åˆ¶çš„WALä¿ç•™ç­–ç•¥</h4>
<p>è‹¥æµå¤åˆ¶æœªæ­é…åŸºäºæ–‡ä»¶çš„è¿ç»­å½’æ¡£ï¼Œä¸»æœåŠ¡å™¨å¯èƒ½åœ¨åå¤‡æœåŠ¡å™¨æ¥æ”¶å‰å›æ”¶æ—§WALæ®µæ–‡ä»¶ï¼Œå¯¼è‡´åå¤‡æœåŠ¡å™¨æ— æ³•åŒæ­¥ï¼Œéœ€é€šè¿‡ä»¥ä¸‹ä»»ä¸€æ–¹å¼é¿å…ï¼š</p>
<ol>
<li><strong>è®¾ç½®wal_keep_size</strong>ï¼šæŒ‡å®šä¸»æœåŠ¡å™¨ä¿ç•™çš„WALæ®µæ–‡ä»¶å¤§å°ï¼Œéœ€è¶³å¤Ÿå¤§ä»¥è¦†ç›–åå¤‡æœåŠ¡å™¨çš„æœ€å¤§ä¸­æ–­æ—¶é—´ï¼›</li>
<li><strong>ä½¿ç”¨å¤åˆ¶æ§½</strong>ï¼šè‡ªåŠ¨åŒ–ä¿ç•™åå¤‡æœåŠ¡å™¨æ‰€éœ€çš„WALæ®µæ–‡ä»¶ï¼Œç²¾å‡†ä¸”æ— å†—ä½™ï¼Œä¸ºæ¨èæ–¹æ¡ˆã€‚</li>
</ol>
<h3 data-id="heading-33">7 å¤åˆ¶æ§½ï¼ˆReplication Slotsï¼‰</h3>
<p>å¤åˆ¶æ§½æ˜¯PostgreSQLæä¾›çš„<strong>è‡ªåŠ¨åŒ–WALä¸æ•°æ®ä¿ç•™æœºåˆ¶</strong>ï¼Œè§£å†³äº†ä¼ ç»ŸWALä¿ç•™æ–¹å¼ï¼ˆ<code>wal_keep_size</code>ã€å½’æ¡£ï¼‰çš„å†—ä½™æˆ–ä¸è¶³é—®é¢˜ï¼ŒåŒæ—¶èƒ½é˜²æ­¢åå¤‡æœåŠ¡å™¨æ–­å¼€æ—¶ä¸»æœåŠ¡å™¨æ‰§è¡ŒçœŸç©ºåˆ é™¤å¯¼è‡´çš„æ¢å¤å†²çªã€‚</p>
<h4 data-id="heading-34">7.1 æ ¸å¿ƒä¼˜åŠ¿</h4>
<ol>
<li><strong>ç²¾å‡†WALä¿ç•™</strong>ï¼šä»…ä¿ç•™åå¤‡æœåŠ¡å™¨æœªæ¥æ”¶çš„WALæ®µæ–‡ä»¶ï¼Œæ— å†—ä½™ï¼Œç›¸æ¯”<code>wal_keep_size</code>æ›´èŠ‚çœç£ç›˜ç©ºé—´ï¼›</li>
<li><strong>æŒç»­æ•°æ®ä¿æŠ¤</strong>ï¼šå³ä½¿åå¤‡æœåŠ¡å™¨æ–­å¼€è¿æ¥ï¼Œä»èƒ½é˜²æ­¢ä¸»æœåŠ¡å™¨åˆ é™¤å¯èƒ½å¯¼è‡´æ¢å¤å†²çªçš„è¡Œï¼Œç›¸æ¯”<code>hot_standby_feedback</code>ï¼ˆä»…è¿æ¥æ—¶æœ‰æ•ˆï¼‰æ›´å¯é ï¼›</li>
<li><strong>è‡ªåŠ¨åŒ–ç®¡ç†</strong>ï¼šå¤åˆ¶æ§½çš„WALä¿ç•™é€»è¾‘ç”±PostgreSQLè‡ªåŠ¨ç»´æŠ¤ï¼Œæ— éœ€äººå·¥å¹²é¢„ã€‚</li>
</ol>
<h4 data-id="heading-35">7.2 æ³¨æ„äº‹é¡¹</h4>
<p>å¤åˆ¶æ§½å¯èƒ½å› åå¤‡æœåŠ¡å™¨é•¿æœŸæ–­å¼€è€Œ<strong>æŒç»­ä¿ç•™WAL</strong>ï¼Œå¯¼è‡´ä¸»æœåŠ¡å™¨<code>pg_wal</code>ç›®å½•å æ»¡ç£ç›˜ï¼Œéœ€é€šè¿‡ä»¥ä¸‹å‚æ•°é™åˆ¶ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">max_slot_wal_keep_size</span> = <span class="hljs-number">10</span>GB
</code></pre>
<p>è¯¥å‚æ•°æŒ‡å®šå•ä¸ªå¤åˆ¶æ§½å¯ä¿ç•™çš„æœ€å¤§WALæ–‡ä»¶å¤§å°ï¼Œè¶…å‡ºåPostgreSQLä¼šåœæ­¢ä¿ç•™ï¼Œé¿å…ç£ç›˜æº¢å‡ºã€‚</p>
<h4 data-id="heading-36">7.3 å¤åˆ¶æ§½çš„åˆ›å»ºä¸æŸ¥è¯¢</h4>
<h5 data-id="heading-37">7.3.1 åˆ›å»ºç‰©ç†å¤åˆ¶æ§½</h5>
<p>ç‰©ç†å¤åˆ¶æ§½é€‚ç”¨äºæœ¬æŒ‡å—çš„ç‰©ç†æµå¤åˆ¶åœºæ™¯ï¼Œåœ¨<strong>ä¸»æœåŠ¡å™¨</strong>ä¸Šæ‰§è¡ŒSQLå‡½æ•°åˆ›å»ºï¼Œç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åˆ›å»ºåä¸ºstandby_01_slotçš„ç‰©ç†å¤åˆ¶æ§½</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> pg_create_physical_replication_slot(<span class="hljs-string">'standby_01_slot'</span>);
</code></pre>
<h5 data-id="heading-38">7.3.2 æŸ¥è¯¢å¤åˆ¶æ§½çŠ¶æ€</h5>
<p>é€šè¿‡<code>pg_replication_slots</code>è§†å›¾æŸ¥çœ‹æ‰€æœ‰å¤åˆ¶æ§½çš„çŠ¶æ€ï¼Œæ ¸å¿ƒå­—æ®µï¼š</p>
<ul>
<li><code>slot_name</code>ï¼šå¤åˆ¶æ§½åç§°ï¼›</li>
<li><code>slot_type</code>ï¼šå¤åˆ¶æ§½ç±»å‹ï¼ˆ<code>physical</code>ä¸ºç‰©ç†å¤åˆ¶ï¼Œ<code>logical</code>ä¸ºé€»è¾‘å¤åˆ¶ï¼‰ï¼›</li>
<li><code>active</code>ï¼šæ˜¯å¦å¤„äºæ´»è·ƒçŠ¶æ€ï¼ˆ<code>t</code>ä¸ºåå¤‡æœåŠ¡å™¨å·²è¿æ¥ï¼Œ<code>f</code>ä¸ºæ–­å¼€ï¼‰ï¼›</li>
<li><code>restart_lsn</code>ï¼šå¤åˆ¶æ§½ä¿ç•™çš„æœ€å°WALä½ç½®ã€‚</li>
</ul>
<p>æŸ¥è¯¢ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> slot_name, slot_type, active, restart_lsn <span class="hljs-keyword">FROM</span> pg_replication_slots;
</code></pre>
<h5 data-id="heading-39">7.3.3 åˆ é™¤å¤åˆ¶æ§½</h5>
<p>è‹¥åå¤‡æœåŠ¡å™¨ä¸‹çº¿ï¼Œéœ€åŠæ—¶åˆ é™¤å¯¹åº”çš„å¤åˆ¶æ§½ï¼Œé¿å…æ— æ•ˆWALä¿ç•™ï¼Œç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-function">SELECT <span class="hljs-title">pg_drop_replication_slot</span><span class="hljs-params">(<span class="hljs-string">'standby_01_slot'</span>)</span></span>;
</code></pre>
<h4 data-id="heading-40">7.4 åå¤‡æœåŠ¡å™¨é…ç½®å¤åˆ¶æ§½</h4>
<p>åœ¨åå¤‡æœåŠ¡å™¨çš„<code>postgresql.auto.conf</code>ä¸­é…ç½®<code>primary_slot_name</code>å‚æ•°ï¼ŒæŒ‡å®šä¸»æœåŠ¡å™¨ä¸Šåˆ›å»ºçš„å¤åˆ¶æ§½åç§°ï¼Œç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">primary_conninfo</span> = <span class="hljs-string">'host=192.168.1.50 port=5432 user=repl_user password=repl_pass'</span>
<span class="hljs-attr">primary_slot_name</span> = <span class="hljs-string">'standby_01_slot'</span>
</code></pre>
<p>é…ç½®åé‡å¯åå¤‡æœåŠ¡å™¨ï¼Œå³å¯åŸºäºå¤åˆ¶æ§½å®ç°WALåŒæ­¥ã€‚</p>
<h3 data-id="heading-41">8 çº§è”å¤åˆ¶ï¼ˆCascading Replicationï¼‰</h3>
<p>çº§è”å¤åˆ¶å…è®¸<strong>åå¤‡æœåŠ¡å™¨ä½œä¸ºè½¬å‘èŠ‚ç‚¹</strong>ï¼Œæ¥æ”¶ä¸»æœåŠ¡å™¨çš„WALåï¼Œå†æµå¼ä¼ è¾“ç»™å…¶ä»–åå¤‡æœåŠ¡å™¨ï¼Œæ ¸å¿ƒä»·å€¼æ˜¯<strong>å‡å°‘ä¸»æœåŠ¡å™¨çš„ç›´æ¥è¿æ¥æ•°</strong>ã€<strong>é™ä½è·¨åœ°åŸŸéƒ¨ç½²çš„å¸¦å®½å¼€é”€</strong>ï¼ˆå¦‚ä¸»æœåŠ¡å™¨åœ¨æœºæˆ¿Aï¼Œçº§è”åå¤‡åœ¨æœºæˆ¿Bï¼Œå…¶ä»–åå¤‡åœ¨æœºæˆ¿Cï¼Œä»…æœºæˆ¿Aä¸Béœ€è·¨åœ°åŸŸä¼ è¾“WALï¼‰ã€‚</p>
<h4 data-id="heading-42">8.1 æ ¸å¿ƒæ¦‚å¿µ</h4>
<ul>
<li><strong>çº§è”åå¤‡æœåŠ¡å™¨</strong>ï¼šåŒæ—¶ä½œä¸ºWALæ¥æ”¶è€…å’Œå‘é€è€…çš„åå¤‡æœåŠ¡å™¨ï¼›</li>
<li><strong>ä¸Šæ¸¸æœåŠ¡å™¨</strong>ï¼šç›´æ¥å‘å½“å‰èŠ‚ç‚¹ä¼ è¾“WALçš„èŠ‚ç‚¹ï¼ˆä¸»æœåŠ¡å™¨æˆ–æ›´é«˜å±‚çº§çš„çº§è”åå¤‡ï¼‰ï¼›</li>
<li><strong>ä¸‹æ¸¸æœåŠ¡å™¨</strong>ï¼šä»å½“å‰èŠ‚ç‚¹æ¥æ”¶WALçš„åå¤‡æœåŠ¡å™¨ã€‚</li>
</ul>
<h4 data-id="heading-43">8.2 æ ¸å¿ƒç‰¹æ€§</h4>
<ol>
<li><strong>æ— å±‚çº§é™åˆ¶</strong>ï¼šçº§è”å¤åˆ¶çš„ä¸‹æ¸¸æœåŠ¡å™¨æ•°é‡ã€çº§è”å±‚çº§æ— å®˜æ–¹é™åˆ¶ï¼Œå¯æŒ‰éœ€éƒ¨ç½²ï¼›</li>
<li><strong>å¤šæºWALè½¬å‘</strong>ï¼šçº§è”åå¤‡æœåŠ¡å™¨ä¸ä»…è½¬å‘ä»ä¸Šæ¸¸æµå¤åˆ¶æ¥æ”¶çš„WALï¼Œè¿˜ä¼šè½¬å‘ä»å½’æ¡£ä¸­æ¢å¤çš„WALï¼Œä¸Šæ¸¸è¿æ¥æ–­å¼€æ—¶ä¸‹æ¸¸ä»å¯é€šè¿‡å½’æ¡£åŒæ­¥ï¼›</li>
<li><strong>çƒ­å¤‡ä»½åé¦ˆå‘ä¸Šä¼ æ’­</strong>ï¼šä¸‹æ¸¸æœåŠ¡å™¨çš„<code>hot_standby_feedback</code>ä¼šé€å±‚å‘ä¸Šä¼ æ’­è‡³ä¸»æœåŠ¡å™¨ï¼Œé˜²æ­¢ä¸»æœåŠ¡å™¨æ‰§è¡ŒçœŸç©ºåˆ é™¤å¯¼è‡´çš„æ¢å¤å†²çªï¼›</li>
<li><strong>æ•…éšœè½¬ç§»è‡ªåŠ¨è·Ÿéš</strong>ï¼šè‹¥ä¸Šæ¸¸åå¤‡æœåŠ¡å™¨è¢«æå‡ä¸ºæ–°ä¸»æœåŠ¡å™¨ï¼Œä¸‹æ¸¸æœåŠ¡å™¨è‹¥<code>recovery_target_timeline=latest</code>ï¼ˆé»˜è®¤ï¼‰ï¼Œä¼šè‡ªåŠ¨ä»æ–°ä¸»æœåŠ¡å™¨åŒæ­¥WALï¼›</li>
<li><strong>å¼‚æ­¥ç‰¹æ€§</strong>ï¼šå½“å‰çº§è”å¤åˆ¶ä»…æ”¯æŒå¼‚æ­¥ï¼ŒåŒæ­¥å¤åˆ¶é…ç½®å¯¹çº§è”å¤åˆ¶æ— å½±å“ã€‚</li>
</ol>
<h4 data-id="heading-44">8.3 çº§è”å¤åˆ¶é…ç½®æ­¥éª¤</h4>
<p>çº§è”å¤åˆ¶çš„é…ç½®æ ¸å¿ƒæ˜¯<strong>å°†çº§è”åå¤‡æœåŠ¡å™¨é…ç½®ä¸ºå¯æ¥æ”¶æµå¤åˆ¶è¿æ¥</strong>ï¼Œå†å°†ä¸‹æ¸¸æœåŠ¡å™¨çš„è¿æ¥æŒ‡å‘çº§è”åå¤‡ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p><strong>é…ç½®çº§è”åå¤‡æœåŠ¡å™¨</strong>ï¼š</p>
<ol>
<li>ä¿®æ”¹<code>postgresql.conf</code>ï¼šè®¾ç½®<code>max_wal_senders &gt; 0</code>ï¼ˆå…è®¸WALå‘é€ï¼‰ã€<code>hot_standby = on</code>ï¼ˆå¼€å¯çƒ­å¤‡ä»½ï¼‰ï¼›</li>
<li>é…ç½®<code>pg_hba.conf</code>ï¼šæ·»åŠ ä¸‹æ¸¸æœåŠ¡å™¨çš„å¤åˆ¶è¿æ¥è§„åˆ™ï¼Œä¸ä¸»æœåŠ¡å™¨çš„å¤åˆ¶æƒé™é…ç½®ä¸€è‡´ï¼›</li>
<li>é‡è½½é…ç½®ï¼š<code>pg_ctl reload</code>ï¼›</li>
</ol>
</li>
<li>
<p><strong>é…ç½®ä¸‹æ¸¸æœåŠ¡å™¨</strong>ï¼š</p>
<ol>
<li>ä¿®æ”¹<code>primary_conninfo</code>å‚æ•°ï¼Œå°†è¿æ¥åœ°å€ä»ä¸»æœåŠ¡å™¨æ”¹ä¸º<strong>çº§è”åå¤‡æœåŠ¡å™¨</strong>çš„IP/ç«¯å£ï¼›</li>
<li>è‹¥ä½¿ç”¨å¤åˆ¶æ§½ï¼Œåœ¨<strong>çº§è”åå¤‡æœåŠ¡å™¨</strong>ä¸Šåˆ›å»ºå¤åˆ¶æ§½ï¼Œå¹¶é…ç½®<code>primary_slot_name</code>ï¼›</li>
</ol>
</li>
<li>
<p>é‡å¯ä¸‹æ¸¸æœåŠ¡å™¨ï¼Œå®Œæˆçº§è”å¤åˆ¶é…ç½®ã€‚</p>
</li>
</ol>
<h3 data-id="heading-45">9 åŒæ­¥å¤åˆ¶ï¼ˆSynchronous Replicationï¼‰</h3>
<p>é»˜è®¤çš„æµå¤åˆ¶ä¸º<strong>å¼‚æ­¥</strong>ï¼Œä¸»æœåŠ¡å™¨æäº¤äº‹åŠ¡åæ— éœ€ç­‰å¾…åå¤‡æœåŠ¡å™¨ç¡®è®¤ï¼Œå¯èƒ½å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼›<strong>åŒæ­¥å¤åˆ¶</strong>åˆ™è¦æ±‚ä¸»æœåŠ¡å™¨åœ¨æäº¤äº‹åŠ¡æ—¶ï¼Œç­‰å¾…ä¸€å°æˆ–å¤šå°åŒæ­¥åå¤‡æœåŠ¡å™¨ç¡®è®¤å·²å°†WALå†™å…¥ç£ç›˜ï¼ˆæˆ–åº”ç”¨ï¼‰ï¼Œä»…å½“ä¸»å¤‡åŒæ—¶å´©æºƒæ—¶æ‰ä¼šä¸¢å¤±æ•°æ®ï¼Œå±äº<strong>2-safeå¤åˆ¶</strong>ï¼Œæä¾›æ›´é«˜çš„æŒä¹…æ€§ä¿éšœã€‚</p>
<h4 data-id="heading-46">9.1 æ ¸å¿ƒç‰¹æ€§</h4>
<ol>
<li><strong>æäº¤ç­‰å¾…æœºåˆ¶</strong>ï¼šä¸»æœåŠ¡å™¨çš„å†™äº‹åŠ¡æäº¤ä¼š<strong>é˜»å¡</strong>ï¼Œç›´è‡³æ”¶åˆ°åŒæ­¥åå¤‡æœåŠ¡å™¨çš„WALç¡®è®¤ï¼Œåªè¯»äº‹åŠ¡ã€å›æ»šã€å­äº‹åŠ¡æäº¤æ— éœ€ç­‰å¾…ï¼›</li>
<li><strong>ç»†ç²’åº¦é…ç½®</strong>ï¼šå¯é€šè¿‡<code>synchronous_commit</code>å‚æ•°åœ¨<strong>å…¨å±€ã€ç”¨æˆ·ã€æ•°æ®åº“ã€äº‹åŠ¡çº§åˆ«</strong>æ§åˆ¶æ˜¯å¦ä½¿ç”¨åŒæ­¥å¤åˆ¶ï¼Œå®ç°â€œæ ¸å¿ƒäº‹åŠ¡åŒæ­¥ï¼Œéæ ¸å¿ƒäº‹åŠ¡å¼‚æ­¥â€çš„ç²¾ç»†åŒ–ç­–ç•¥ï¼›</li>
<li><strong>å¤šåŒæ­¥åå¤‡æ”¯æŒ</strong>ï¼šæ”¯æŒé…ç½®å¤šå°åŒæ­¥åå¤‡æœåŠ¡å™¨ï¼Œå¯è¦æ±‚äº‹åŠ¡ç­‰å¾…<strong>æ‰€æœ‰</strong>æˆ–<strong>ä»»æ„Nå°</strong>åŒæ­¥åå¤‡çš„ç¡®è®¤ã€‚</li>
</ol>
<h4 data-id="heading-47">9.2 åŸºæœ¬é…ç½®</h4>
<p>æµå¤åˆ¶æ˜¯åŒæ­¥å¤åˆ¶çš„åŸºç¡€ï¼Œéœ€å…ˆå®ŒæˆåŸºç¡€æµå¤åˆ¶é…ç½®ï¼Œå†åœ¨<strong>ä¸»æœåŠ¡å™¨</strong>ä¸Šæ·»åŠ ä»¥ä¸‹æ ¸å¿ƒé…ç½®ï¼š</p>
<ol>
<li>
<p><strong>synchronous_standby_names</strong>ï¼šè®¾ä¸ºéç©ºå€¼ï¼ŒæŒ‡å®šåŒæ­¥åå¤‡æœåŠ¡å™¨çš„é€‰æ‹©è§„åˆ™ï¼ˆæ ¸å¿ƒé…ç½®ï¼‰ï¼Œè¯¥å‚æ•°æ˜¯åŒæ­¥å¤åˆ¶çš„å¼€å…³ï¼›</p>
</li>
<li>
<p><strong>synchronous_commit</strong>ï¼šè®¾ä¸º<code>on</code>ï¼ˆé»˜è®¤å€¼ï¼‰ï¼Œè¡¨ç¤ºäº‹åŠ¡æäº¤ç­‰å¾…åå¤‡æœåŠ¡å™¨å°†WALåˆ·å†™åˆ°ç£ç›˜ï¼Œå…¶ä»–å¯é€‰å€¼ï¼š</p>
<ol>
<li><code>remote_write</code>ï¼šç­‰å¾…åå¤‡æœåŠ¡å™¨å°†WALå†™å…¥æ“ä½œç³»ç»Ÿç¼“å­˜ï¼ˆéç£ç›˜ï¼‰ï¼Œé™ä½æäº¤å»¶è¿Ÿï¼ŒæŒä¹…æ€§ç•¥ä½äº<code>on</code>ï¼›</li>
<li><code>remote_apply</code>ï¼šç­‰å¾…åå¤‡æœåŠ¡å™¨å°†WALåº”ç”¨å®Œæˆï¼Œäº‹åŠ¡åœ¨åå¤‡æœåŠ¡å™¨ä¸Šå¯è§ï¼Œæ”¯æŒå› æœä¸€è‡´æ€§çš„è¯»å†™åˆ†ç¦»ï¼›</li>
<li><code>off</code>ï¼šå…³é—­åŒæ­¥å¤åˆ¶ï¼Œæ¢å¤ä¸ºå¼‚æ­¥ã€‚</li>
</ol>
</li>
</ol>
<p>é…ç½®ç¤ºä¾‹ï¼ˆä¸»æœåŠ¡å™¨postgresql.confï¼‰ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å¼€å¯åŒæ­¥å¤åˆ¶ï¼ŒæŒ‡å®šåŒæ­¥åå¤‡ä¸ºstandby_01</span>
<span class="hljs-attr">synchronous_standby_names</span> = <span class="hljs-string">'standby_01'</span>
<span class="hljs-comment"># å…¨å±€é»˜è®¤åŒæ­¥çº§åˆ«ï¼šç­‰å¾…åå¤‡åˆ·å†™åˆ°ç£ç›˜</span>
<span class="hljs-attr">synchronous_commit</span> = <span class="hljs-literal">on</span>
</code></pre>
<p><strong>æ³¨æ„</strong>ï¼šåŒæ­¥å¤åˆ¶çš„é…ç½®ä¸»è¦åœ¨ä¸»æœåŠ¡å™¨ä¸Šï¼Œä¸”<strong>ä»…æ”¯æŒç›´æ¥è¿æ¥ä¸»æœåŠ¡å™¨çš„åå¤‡æœåŠ¡å™¨</strong>ï¼Œçº§è”åå¤‡æ— æ³•æˆä¸ºåŒæ­¥åå¤‡ã€‚</p>
<h4 data-id="heading-48">9.3 å¤šåŒæ­¥åå¤‡æœåŠ¡å™¨é…ç½®</h4>
<p><code>synchronous_standby_names</code>æ”¯æŒé€šè¿‡<code>FIRST</code>å’Œ<code>ANY</code>ä¸¤ç§æ–¹æ³•é…ç½®å¤šå°åŒæ­¥åå¤‡ï¼Œå®ç°æ›´çµæ´»çš„é«˜å¯ç”¨ç­–ç•¥ã€‚</p>
<h5 data-id="heading-49">9.3.1 FIRSTï¼šåŸºäºä¼˜å…ˆçº§çš„åŒæ­¥</h5>
<p>è¦æ±‚äº‹åŠ¡ç­‰å¾…<strong>å‰Nå°ä¼˜å…ˆçº§æœ€é«˜</strong>çš„åŒæ­¥åå¤‡çš„ç¡®è®¤ï¼Œè‹¥æŸå°åŒæ­¥åå¤‡å¤±æ•ˆï¼Œè‡ªåŠ¨ç”±ä¸‹ä¸€å°ä¼˜å…ˆçº§çš„åå¤‡æ›¿ä»£ã€‚</p>
<p>é…ç½®æ ¼å¼ï¼š<code>FIRST N (åå¤‡1, åå¤‡2, åå¤‡3,...)</code></p>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ç­‰å¾…å‰2å°åŒæ­¥åå¤‡ï¼ˆstandby_01ã€standby_02ï¼‰çš„ç¡®è®¤ï¼Œstandby_03ä¸ºæ½œåœ¨åŒæ­¥åå¤‡</span>
<span class="hljs-attr">synchronous_standby_names</span> = <span class="hljs-string">'FIRST 2 (standby_01, standby_02, standby_03)'</span>
</code></pre>
<h5 data-id="heading-50">9.3.2 ANYï¼šåŸºäºæ•°é‡çš„åŒæ­¥</h5>
<p>è¦æ±‚äº‹åŠ¡ç­‰å¾…<strong>åˆ—è¡¨ä¸­ä»»æ„Nå°</strong>åŒæ­¥åå¤‡çš„ç¡®è®¤ï¼Œæ— éœ€è€ƒè™‘ä¼˜å…ˆçº§ï¼Œåªè¦è¾¾åˆ°æŒ‡å®šæ•°é‡å³å¯ã€‚</p>
<p>é…ç½®æ ¼å¼ï¼š<code>ANY N (åå¤‡1, åå¤‡2, åå¤‡3,...)</code></p>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ç­‰å¾…åˆ—è¡¨ä¸­ä»»æ„2å°åŒæ­¥åå¤‡çš„ç¡®è®¤</span>
<span class="hljs-attr">synchronous_standby_names</span> = <span class="hljs-string">'ANY 2 (standby_01, standby_02, standby_03)'</span>
</code></pre>
<h5 data-id="heading-51">9.3.3 æŸ¥çœ‹åŒæ­¥çŠ¶æ€</h5>
<p>é€šè¿‡ä¸»æœåŠ¡å™¨çš„<code>pg_stat_replication</code>è§†å›¾çš„<code>sync_state</code>å­—æ®µæŸ¥çœ‹åå¤‡æœåŠ¡å™¨çš„åŒæ­¥çŠ¶æ€ï¼š</p>
<ul>
<li><code>sync</code>ï¼šå½“å‰åŒæ­¥åå¤‡ï¼›</li>
<li><code>potential</code>ï¼šæ½œåœ¨åŒæ­¥åå¤‡ï¼ˆä¼˜å…ˆçº§è¾ƒä½æˆ–æœªè¾¾åˆ°æ•°é‡è¦æ±‚ï¼‰ï¼›</li>
<li><code>async</code>ï¼šå¼‚æ­¥åå¤‡ï¼ˆæœªåœ¨<code>synchronous_standby_names</code>åˆ—è¡¨ä¸­ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-52">9.4 æ€§èƒ½ä¸é«˜å¯ç”¨æ€§è§„åˆ’</h4>
<p>åŒæ­¥å¤åˆ¶è™½æå‡äº†æ•°æ®æŒä¹…æ€§ï¼Œä½†ä¹Ÿä¼šå¢åŠ äº‹åŠ¡æäº¤å»¶è¿Ÿï¼Œéœ€åšå¥½ä»¥ä¸‹è§„åˆ’ï¼š</p>
<ol>
<li>
<p><strong>æ€§èƒ½è§„åˆ’</strong>ï¼š</p>
<ol>
<li>ç½‘ç»œå¸¦å®½ï¼šéœ€ä¿è¯ä¸»å¤‡ä¹‹é—´çš„å¸¦å®½å¤§äºWALç”Ÿæˆé€Ÿç‡ï¼Œé¿å…ç½‘ç»œæˆä¸ºç“¶é¢ˆï¼›</li>
<li>äº‹åŠ¡åˆ†çº§ï¼šå¯¹æ ¸å¿ƒäº‹åŠ¡ï¼ˆå¦‚èµ„é‡‘äº¤æ˜“ï¼‰è®¾ç½®<code>synchronous_commit = on</code>ï¼Œå¯¹éæ ¸å¿ƒäº‹åŠ¡ï¼ˆå¦‚æ—¥å¿—è®°å½•ï¼‰è®¾ç½®<code>synchronous_commit = off</code>ï¼Œå¹³è¡¡æ€§èƒ½ä¸æŒä¹…æ€§ï¼›</li>
<li>èŠ‚ç‚¹éƒ¨ç½²ï¼šåŒæ­¥åå¤‡æœåŠ¡å™¨å»ºè®®ä¸ä¸»æœåŠ¡å™¨éƒ¨ç½²åœ¨<strong>åŒæœºæˆ¿æˆ–ä½å»¶è¿Ÿçš„åŒåŸæœºæˆ¿</strong>ï¼Œé¿å…è·¨åœ°åŸŸçš„é«˜å»¶è¿Ÿå¯¼è‡´äº‹åŠ¡æäº¤ç¼“æ…¢ã€‚</li>
</ol>
</li>
<li>
<p><strong>é«˜å¯ç”¨æ€§è§„åˆ’</strong>ï¼š</p>
<ol>
<li>é…ç½®è¶³å¤Ÿçš„<strong>æ½œåœ¨åŒæ­¥åå¤‡</strong>ï¼Œé¿å…åŒæ­¥åå¤‡å¤±æ•ˆå¯¼è‡´ä¸»æœåŠ¡å™¨äº‹åŠ¡æäº¤é˜»å¡ï¼›</li>
<li>è‹¥åŒæ­¥åå¤‡å…¨éƒ¨å¤±æ•ˆï¼Œå¯ä¸´æ—¶å°†<code>synchronous_standby_names</code>è®¾ä¸ºç©ºï¼ˆç¦ç”¨åŒæ­¥å¤åˆ¶ï¼‰ï¼Œå¹¶é‡è½½é…ç½®ï¼Œä¿è¯ä¸»æœåŠ¡å™¨ä¸šåŠ¡æ­£å¸¸ï¼›</li>
<li>åå¤‡æœåŠ¡å™¨å¯åŠ¨åä¼šè¿›å…¥<strong>è¿½èµ¶æ¨¡å¼</strong>ï¼Œç›´è‡³ä¸ä¸»æœåŠ¡å™¨WALå»¶è¿Ÿä¸º0æ‰ä¼šæˆä¸ºåŒæ­¥åå¤‡ï¼Œå¯é€šè¿‡<code>pg_stat_replication</code>è§†å›¾çš„<code>replay_lsn</code>ç›‘æ§è¿½èµ¶è¿›åº¦ã€‚</li>
</ol>
</li>
</ol>
<h4 data-id="heading-53">9.5 ç‰¹æ®Šåœºæ™¯å¤„ç†</h4>
<ol>
<li><strong>ä¸»æœåŠ¡å™¨é‡å¯</strong>ï¼šè‹¥äº‹åŠ¡æäº¤æ—¶æ­£ç­‰å¾…åŒæ­¥åå¤‡ç¡®è®¤ï¼Œä¸»æœåŠ¡å™¨é‡å¯åè¿™äº›äº‹åŠ¡ä¼šè¢«æ ‡è®°ä¸º<strong>å·²æäº¤</strong>ï¼Œæ— éœ€é‡æ–°æ‰§è¡Œï¼›</li>
<li><strong>å¿«é€Ÿå…³é—­ä¸»æœåŠ¡å™¨</strong>ï¼šä¸»æœåŠ¡å™¨å¿«é€Ÿå…³é—­æ—¶ï¼Œä¼šåœæ­¢ç­‰å¾…åŒæ­¥åå¤‡ç¡®è®¤ï¼Œä½†ä¼šç­‰å¾…æ‰€æœ‰æœªä¼ è¾“çš„WALå‘é€åˆ°å·²è¿æ¥çš„åå¤‡æœåŠ¡å™¨ï¼›</li>
<li><strong>åŒæ­¥åå¤‡é‡å»º</strong>ï¼šé‡å»ºåŒæ­¥åå¤‡æ—¶ï¼Œéœ€åœ¨ä¸»æœåŠ¡å™¨ä¸Šæ‰§è¡Œ<code>pg_backup_start()</code>å’Œ<code>pg_backup_stop()</code>ï¼Œå¹¶ä¸´æ—¶è®¾ç½®<code>synchronous_commit = off</code>ï¼Œé¿å…å¤‡ä»½å‘½ä»¤å› ç­‰å¾…åŒæ­¥åå¤‡è€Œé˜»å¡ã€‚</li>
</ol>
<h3 data-id="heading-54">10 åå¤‡æœºä¸Šçš„è¿ç»­å½’æ¡£</h3>
<p>åå¤‡æœåŠ¡å™¨ä¹Ÿå¯å¼€å¯è¿ç»­å½’æ¡£ï¼Œå®ç°WALçš„å¤šå±‚çº§å¤‡ä»½ï¼Œéœ€æ ¹æ®<strong>å½’æ¡£æ˜¯å¦ä¸ä¸»æœåŠ¡å™¨å…±äº«</strong>ï¼Œé‡‡ç”¨ä¸åŒçš„é…ç½®ç­–ç•¥ï¼Œæ ¸å¿ƒå‚æ•°ä¸º<code>archive_mode</code>çš„<code>always</code>å€¼ã€‚</p>
<h4 data-id="heading-55">10.1 å½’æ¡£æ¨¡å¼è¯´æ˜</h4>
<p>PostgreSQLçš„<code>archive_mode</code>æœ‰ä¸‰ä¸ªå–å€¼ï¼š</p>
<ul>
<li><code>off</code>ï¼šå…³é—­å½’æ¡£ï¼›</li>
<li><code>on</code>ï¼šä»…åœ¨æ­£å¸¸æ“ä½œæ¨¡å¼ï¼ˆä¸»æœåŠ¡å™¨ï¼‰ä¸‹å¼€å¯å½’æ¡£ï¼Œstandbyæ¨¡å¼ä¸‹ç¦ç”¨ï¼›</li>
<li><code>always</code>ï¼š<strong>æ­£å¸¸æ“ä½œæ¨¡å¼å’Œstandbyæ¨¡å¼ä¸‹å‡å¼€å¯å½’æ¡£</strong>ï¼Œæ˜¯åå¤‡æœåŠ¡å™¨å½’æ¡£çš„æ ¸å¿ƒé…ç½®ã€‚</li>
</ul>
<h4 data-id="heading-56">10.2 ä¸¤ç§å½’æ¡£åœºæ™¯é…ç½®</h4>
<h5 data-id="heading-57">10.2.1 åå¤‡æœåŠ¡å™¨æ‹¥æœ‰ç‹¬ç«‹çš„WALå½’æ¡£</h5>
<p>æ ¸å¿ƒé…ç½®ï¼šå°†åå¤‡æœåŠ¡å™¨çš„<code>archive_mode</code>è®¾ä¸º<code>always</code>ï¼Œå¹¶é…ç½®ç‹¬ç«‹çš„<code>archive_command</code>ï¼ˆä¸ä¸»æœåŠ¡å™¨å½’æ¡£ç›®å½•åˆ†ç¦»ï¼‰ã€‚</p>
<p>è¯¥æ¨¡å¼ä¸‹ï¼Œåå¤‡æœåŠ¡å™¨ä¼šå¯¹<strong>æ‰€æœ‰æ¥æ”¶åˆ°çš„WALæ®µæ–‡ä»¶</strong>ï¼ˆæ— è®ºæ¥è‡ªå½’æ¡£æ¢å¤è¿˜æ˜¯æµå¤åˆ¶ï¼‰æ‰§è¡Œå½’æ¡£æ“ä½œï¼Œå®ç°WALçš„åŒé‡å¤‡ä»½ï¼Œé€‚ç”¨äºç¾éš¾æ¢å¤è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ã€‚</p>
<h5 data-id="heading-58">10.2.2 åå¤‡æœåŠ¡å™¨ä¸ä¸»æœåŠ¡å™¨å…±äº«WALå½’æ¡£</h5>
<p>æ ¸å¿ƒé…ç½®ï¼š</p>
<ol>
<li>åå¤‡æœåŠ¡å™¨<code>archive_mode = always</code>ï¼›</li>
<li><code>archive_command</code>éœ€å¢åŠ <strong>æ–‡ä»¶å­˜åœ¨æ€§ä¸å†…å®¹æ ¡éªŒé€»è¾‘</strong>ï¼Œé¿å…ä¸»å¤‡æœåŠ¡å™¨åŒæ—¶å½’æ¡£åŒä¸€WALæ–‡ä»¶å¯¼è‡´çš„è¦†ç›–æˆ–ç«äº‰ï¼›</li>
<li>è‹¥WALæ–‡ä»¶å·²å­˜åœ¨ä¸”å†…å®¹ä¸€è‡´ï¼Œ<code>archive_command</code>éœ€è¿”å›<strong>æˆåŠŸ</strong>ï¼Œå¦åˆ™æ‰§è¡Œå½’æ¡£ã€‚</li>
</ol>
<p>è¯¥æ¨¡å¼ä¸‹éœ€ä¿è¯å½’æ¡£å‘½ä»¤çš„åŸå­æ€§ï¼Œé¿å…ç«äº‰æ¡ä»¶ï¼Œé€‚ç”¨äºå½’æ¡£å­˜å‚¨èµ„æºæœ‰é™çš„åœºæ™¯ã€‚</p>
<h4 data-id="heading-59">10.3 å…³é”®æ³¨æ„äº‹é¡¹</h4>
<ol>
<li>è‹¥åå¤‡æœåŠ¡å™¨çš„<code>archive_mode</code>è®¾ä¸º<code>on</code>ï¼Œåˆ™ä»…åœ¨è¢«æå‡ä¸ºä¸»æœåŠ¡å™¨åæ‰ä¼šå¼€å¯å½’æ¡£ï¼Œ<strong>ä¸ä¼šå½’æ¡£standbyæ¨¡å¼ä¸‹æ¥æ”¶çš„WAL</strong>ï¼›</li>
<li>æµå¤åˆ¶åœºæ™¯ä¸‹ï¼Œä¸»æœåŠ¡å™¨çš„WALå¯èƒ½æœªå½’æ¡£å³è¢«ä¼ è¾“åˆ°åå¤‡æœåŠ¡å™¨ï¼Œè‹¥éœ€å®ç°å®Œæ•´çš„WALå½’æ¡£ï¼Œéœ€ä¿è¯<strong>ä¸»æœåŠ¡å™¨çš„WALåœ¨ä¼ è¾“åˆ°åå¤‡æœåŠ¡å™¨å‰å·²å®Œæˆå½’æ¡£</strong>ï¼›</li>
<li>å…±äº«å½’æ¡£æ—¶ï¼Œéœ€ä½¿ç”¨æ”¯æŒ<strong>åŸå­å†™</strong>çš„æ–‡ä»¶ç³»ç»Ÿæˆ–å½’æ¡£å·¥å…·ï¼Œé¿å…ä¸»å¤‡æœåŠ¡å™¨åŒæ—¶å†™å…¥åŒä¸€WALæ–‡ä»¶ã€‚</li>
</ol>
<h3 data-id="heading-60">æ€»ç»“</h3>
<p>PostgreSQLçš„æ—¥å¿—ä¼ é€ä¸æµå¤åˆ¶æ˜¯ä¸€å¥—è½»é‡ã€é«˜æ•ˆçš„é«˜å¯ç”¨å®ç°æ–¹æ¡ˆï¼Œä»åŸºç¡€çš„åŸºäºæ–‡ä»¶çš„æ—¥å¿—ä¼ é€ï¼Œåˆ°å®æ—¶çš„æµå¤åˆ¶ï¼Œå†åˆ°å¤åˆ¶æ§½ã€çº§è”å¤åˆ¶ã€åŒæ­¥å¤åˆ¶ç­‰é«˜çº§ç‰¹æ€§ï¼Œå¯æ»¡è¶³ä¸åŒç”Ÿäº§åœºæ™¯çš„é«˜å¯ç”¨éœ€æ±‚ï¼š</p>
<ul>
<li>ä¸­å°è§„æ¨¡åœºæ™¯ï¼šé‡‡ç”¨<strong>å¼‚æ­¥æµå¤åˆ¶+å¤åˆ¶æ§½</strong>ï¼Œå…¼é¡¾å®æ—¶æ€§ä¸æ˜“ç”¨æ€§ï¼Œæ•°æ®ä¸¢å¤±çª—å£å¯æ§åˆ¶åœ¨ç§’çº§ï¼›</li>
<li>é«˜æŒä¹…æ€§åœºæ™¯ï¼šé‡‡ç”¨<strong>åŒæ­¥å¤åˆ¶+å¤šæ½œåœ¨åŒæ­¥åå¤‡</strong>ï¼Œå®ç°2-safeå¤åˆ¶ï¼Œä»…ä¸»å¤‡åŒæ—¶å´©æºƒæ‰ä¼šä¸¢å¤±æ•°æ®ï¼›</li>
<li>è·¨åœ°åŸŸéƒ¨ç½²åœºæ™¯ï¼šé‡‡ç”¨<strong>çº§è”å¤åˆ¶</strong>ï¼Œå‡å°‘è·¨åœ°åŸŸå¸¦å®½å¼€é”€ï¼Œæå‡é›†ç¾¤æ•´ä½“ç¨³å®šæ€§ï¼›</li>
<li>é«˜ç¾éš¾æ¢å¤è¦æ±‚åœºæ™¯ï¼šé‡‡ç”¨<strong>åå¤‡æœåŠ¡å™¨ç‹¬ç«‹å½’æ¡£</strong>ï¼Œå®ç°WALçš„å¤šå±‚çº§å¤‡ä»½ï¼Œæå‡æ•°æ®å¯æ¢å¤æ€§ã€‚</li>
</ul>
<p>åœ¨å®é™…éƒ¨ç½²æ—¶ï¼Œéœ€é‡ç‚¹ä¿è¯ä¸»å¤‡èŠ‚ç‚¹çš„ç¯å¢ƒä¸€è‡´æ€§ã€ç½‘ç»œç¨³å®šæ€§ï¼Œå¹¶åšå¥½WALç£ç›˜ç©ºé—´ã€å¤åˆ¶çŠ¶æ€çš„ç›‘æ§ï¼ŒåŒæ—¶æ ¹æ®ä¸šåŠ¡ç‰¹æ€§åšå¥½åŒæ­¥/å¼‚æ­¥çš„ç²¾ç»†åŒ–é…ç½®ï¼Œå¹³è¡¡æ•°æ®æŒä¹…æ€§ä¸é›†ç¾¤æ€§èƒ½ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MySQLæ£€æŸ¥å’Œæ¸…ç†ä¸å¯è§å­—ç¬¦ï¼ˆBOMå¤´ï¼‰]]></title>    <link>https://juejin.cn/post/7599933828543905855</link>    <guid>https://juejin.cn/post/7599933828543905855</guid>    <pubDate>2026-01-28T03:17:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599933828543905855" data-draft-id="7599868109086638122" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="MySQLæ£€æŸ¥å’Œæ¸…ç†ä¸å¯è§å­—ç¬¦ï¼ˆBOMå¤´ï¼‰"/> <meta itemprop="keywords" content="MySQL"/> <meta itemprop="datePublished" content="2026-01-28T03:17:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°æ’æ’"/> <meta itemprop="url" content="https://juejin.cn/user/3315782798023224"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            MySQLæ£€æŸ¥å’Œæ¸…ç†ä¸å¯è§å­—ç¬¦ï¼ˆBOMå¤´ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3315782798023224/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°æ’æ’
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T03:17:38.000Z" title="Wed Jan 28 2026 03:17:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ•…äº‹èƒŒæ™¯</h2>
<p>ä»Šå¤©å››å¤§è¿è¥å•†å…¶ä¸­ä¸€ä¸ªäº¤ç»™æˆ‘ä»¬ä¸€ä¸ª <code>Excel</code> è¡¨æ ¼ï¼Œæˆ‘ä»¬æ²¡æœ‰åšä»»ä½•æ•°æ®æ¸…ç†å°±å¯¼å…¥ <code>MySQL</code> äº†ï¼Œå¯¼è‡´ <code>a</code> å­—æ®µå‡ºç°äº†å¤§é‡ä¸å¯è§å­—ç¬¦ã€‚</p>
<h2 data-id="heading-1">æ£€æŸ¥</h2>
<p>æ£€æŸ¥æ—¶ï¼Œæˆ‘ä»¬è¦çŸ¥é“ä¸å¯è§å­—ç¬¦éƒ½æœ‰å“ªäº›ã€‚é€šå¸¸æ˜¯ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦ã€BOMå¤´ã€‚è¿™é‡Œæˆ‘ä»¬ä¸»è¦æ¸…ç†BOMå¤´ï¼Œä¹Ÿå°±æ˜¯ <code>UTF-8 BOM</code> å¤´ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> 
  a <span class="hljs-keyword">AS</span> åŸå§‹æ•°æ®,
  <span class="hljs-comment">-- æ ¸å¿ƒå¤„ç†é€»è¾‘ï¼šå…ˆåˆ BOMå¤´â†’æ¸…ç©ºç™½</span>
  <span class="hljs-built_in">TRIM</span>(REPLACE(a, <span class="hljs-type">CHAR</span>(<span class="hljs-number">0xEF</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0xBF</span>), <span class="hljs-string">''</span>)) <span class="hljs-keyword">AS</span> æ¸…ç†å,
  LENGTH(a) <span class="hljs-keyword">AS</span> åŸå§‹å­—èŠ‚é•¿åº¦,
  <span class="hljs-keyword">CHAR_LENGTH</span>(a) <span class="hljs-keyword">AS</span> åŸå§‹å­—ç¬¦é•¿åº¦,
  <span class="hljs-comment">-- éªŒè¯æ¸…ç†åçš„é•¿åº¦</span>
  LENGTH(<span class="hljs-built_in">TRIM</span>(REPLACE(a, <span class="hljs-type">CHAR</span>(<span class="hljs-number">0xEF</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0xBF</span>), <span class="hljs-string">''</span>))) <span class="hljs-keyword">AS</span> æ¸…ç†åå­—èŠ‚é•¿åº¦,
  <span class="hljs-keyword">CHAR_LENGTH</span>(<span class="hljs-built_in">TRIM</span>(REPLACE(a, <span class="hljs-type">CHAR</span>(<span class="hljs-number">0xEF</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0xBF</span>), <span class="hljs-string">''</span>))) <span class="hljs-keyword">AS</span> æ¸…ç†åå­—ç¬¦é•¿åº¦
<span class="hljs-keyword">FROM</span> yys_data
<span class="hljs-keyword">WHERE</span> LENGTH(a) <span class="hljs-operator">!=</span> <span class="hljs-keyword">CHAR_LENGTH</span>(a);
</code></pre>
<h2 data-id="heading-2">æ¸…ç†</h2>
<p>æ‰€ä»¥ï¼Œå¯¹åº”æ¸…ç†æ—¶ï¼Œä¹Ÿå°±éå¸¸ç®€å•ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">UPDATE</span>
yys_data
<span class="hljs-keyword">SET</span>
a <span class="hljs-operator">=</span> <span class="hljs-built_in">TRIM</span>(REPLACE(a, <span class="hljs-type">CHAR</span>(<span class="hljs-number">0xEF</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0xBF</span>), <span class="hljs-string">''</span>))
<span class="hljs-keyword">WHERE</span>
LENGTH(a) <span class="hljs-operator">!=</span> <span class="hljs-keyword">CHAR_LENGTH</span>(a);
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MySQLä¸»é”®ç´¢å¼•ä¸è”åˆç´¢å¼•åŒºåˆ«]]></title>    <link>https://juejin.cn/post/7599983917663928363</link>    <guid>https://juejin.cn/post/7599983917663928363</guid>    <pubDate>2026-01-28T03:23:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599983917663928363" data-draft-id="7599924721006657599" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="MySQLä¸»é”®ç´¢å¼•ä¸è”åˆç´¢å¼•åŒºåˆ«"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-28T03:23:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‹ä¸‰çš„å¼€å‘æ—¥è®°"/> <meta itemprop="url" content="https://juejin.cn/user/4248949048749213"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            MySQLä¸»é”®ç´¢å¼•ä¸è”åˆç´¢å¼•åŒºåˆ«
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4248949048749213/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‹ä¸‰çš„å¼€å‘æ—¥è®°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T03:23:30.000Z" title="Wed Jan 28 2026 03:23:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¸‹é¢æŒ‰â€œ<strong>ç»“æ„/ä½¿ç”¨æ–¹å¼/é€‚ç”¨åœºæ™¯/å¸¸è§å‘</strong>â€æŠŠ <strong>MySQL ä¸»é”®ç´¢å¼•</strong> å’Œ <strong>è”åˆç´¢å¼•ï¼ˆå¤åˆç´¢å¼•ï¼‰</strong> çš„åŒºåˆ«è®²æ¸…æ¥šï¼ˆä»¥ InnoDB ä¸ºä¸»ï¼‰ã€‚</p>
<h2 data-id="heading-0">1ï¼‰æœ¬è´¨åŒºåˆ«</h2>
<ul>
<li>
<p><strong>ä¸»é”®ç´¢å¼•ï¼ˆPRIMARY KEYï¼‰</strong></p>
<ul>
<li>æ˜¯ <strong>èšç°‡ç´¢å¼•ï¼ˆclustered indexï¼‰</strong> ï¼š<strong>å¶å­èŠ‚ç‚¹å­˜æ•´è¡Œæ•°æ®</strong>ã€‚</li>
<li><strong>ä¸€å¼ è¡¨åªèƒ½æœ‰ä¸€ä¸ª</strong> ä¸»é”®ç´¢å¼•ã€‚</li>
<li>ä¸»é”®å€¼å¿…é¡» <strong>å”¯ä¸€ä¸”é NULL</strong>ã€‚</li>
</ul>
</li>
<li>
<p><strong>è”åˆç´¢å¼•ï¼ˆ(a,b,c) è¿™ç§ï¼‰</strong></p>
<ul>
<li>æ˜¯ç´¢å¼•â€œé”®â€çš„ç»„åˆï¼ˆå¯ä»¥æ˜¯æ™®é€šç´¢å¼•ã€å”¯ä¸€ç´¢å¼•ç­‰ï¼‰ã€‚</li>
<li>åœ¨ InnoDB é‡Œé€šå¸¸æ˜¯ <strong>äºŒçº§ç´¢å¼•ï¼ˆsecondary indexï¼‰</strong> ï¼š<strong>å¶å­èŠ‚ç‚¹å­˜(è”åˆç´¢å¼•é”® + ä¸»é”®å€¼)</strong> ï¼Œå›è¡¨å†æ‹¿æ•´è¡Œï¼ˆé™¤éè¦†ç›–ç´¢å¼•ï¼‰ã€‚</li>
<li>ä¸€å¼ è¡¨å¯ä»¥æœ‰å¤šä¸ªè”åˆç´¢å¼•ã€‚</li>
<li>æ˜¯å¦å”¯ä¸€ã€æ˜¯å¦å…è®¸ NULL å–å†³äºä½ å»ºçš„æ˜¯ <code>UNIQUE</code> è¿˜æ˜¯æ™®é€š <code>INDEX</code>ï¼Œä»¥åŠåˆ—æ˜¯å¦å…è®¸ NULLã€‚</li>
</ul>
</li>
</ul>
<h2 data-id="heading-1">2ï¼‰æŸ¥è¯¢å‘½ä¸­æ–¹å¼å·®å¼‚ï¼ˆæœ€å…³é”®ï¼šæœ€å·¦å‰ç¼€ï¼‰</h2>
<p>è”åˆç´¢å¼•éµå¾ª <strong>æœ€å·¦å‰ç¼€åŸåˆ™</strong>ï¼š</p>
<p>å‡è®¾æœ‰è”åˆç´¢å¼•ï¼š<code>idx(a,b,c)</code></p>
<p>âœ… èƒ½ç”¨ä¸Šç´¢å¼•çš„å…¸å‹æƒ…å†µï¼š</p>
<ul>
<li><code>where a = ?</code></li>
<li><code>where a = ? and b = ?</code></li>
<li><code>where a = ? and b = ? and c = ?</code></li>
<li><code>where a = ? and b &gt; ?</code>ï¼ˆç”¨åˆ° a,bï¼Œc ç”¨ä¸ä¸Šï¼‰</li>
</ul>
<p>âŒ å¾ˆå¯èƒ½ç”¨ä¸ä¸Šï¼ˆæˆ–åªèƒ½ç”¨éƒ¨åˆ†ï¼‰ï¼š</p>
<ul>
<li><code>where b = ?</code>ï¼ˆç¼ºå°‘æœ€å·¦åˆ— aï¼‰</li>
<li><code>where c = ?</code>ï¼ˆç¼ºå°‘æœ€å·¦åˆ— aï¼‰</li>
<li><code>where b = ? and c = ?</code>ï¼ˆä»ç¼º aï¼‰</li>
<li><code>where a &gt; ? and b = ?</code>ï¼ˆèŒƒå›´æ¡ä»¶åé¢çš„åˆ—é€šå¸¸éš¾å†ç»§ç»­ç”¨æ¥ç²¾ç¡®è¿‡æ»¤ï¼‰</li>
</ul>
<p>è€Œ<strong>ä¸»é”®ç´¢å¼•</strong>å‘½ä¸­å°±å¾ˆç›´æ¥ï¼š</p>
<ul>
<li><code>where id = ?</code> èµ°ä¸»é”®ç´¢å¼•ï¼Œé€šå¸¸æ˜¯æœ€å¼ºçš„ç‚¹æŸ¥è·¯å¾„ï¼ˆå”¯ä¸€ã€èšç°‡ã€æ ‘é«˜ä½ï¼‰ã€‚</li>
</ul>
<h2 data-id="heading-2">3ï¼‰æ€§èƒ½ä¸å›è¡¨å·®å¼‚</h2>
<ul>
<li>
<p><strong>ä¸»é”®ç´¢å¼•æŸ¥è¯¢</strong></p>
<ul>
<li>å‘½ä¸­åå¶å­èŠ‚ç‚¹å°±æ˜¯æ•´è¡Œæ•°æ®ï¼Œ<strong>ä¸éœ€è¦å›è¡¨</strong>ã€‚</li>
</ul>
</li>
<li>
<p><strong>è”åˆç´¢å¼•ï¼ˆäºŒçº§ç´¢å¼•ï¼‰æŸ¥è¯¢</strong></p>
<ul>
<li>å‘½ä¸­åå…ˆæ‹¿åˆ°ä¸»é”®å€¼ï¼Œå†å»ä¸»é”®ç´¢å¼•å–æ•´è¡Œï¼š<strong>éœ€è¦å›è¡¨</strong>ã€‚</li>
<li>ä½†å¦‚æœæŸ¥è¯¢çš„åˆ—éƒ½åœ¨ç´¢å¼•é‡Œï¼ˆè”åˆç´¢å¼•è¦†ç›–äº† select åˆ—ï¼‰ï¼Œå°±èƒ½ <strong>è¦†ç›–ç´¢å¼•</strong>ï¼šä¸å›è¡¨ï¼Œæ€§èƒ½å¾ˆé«˜ã€‚</li>
</ul>
</li>
</ul>
<p>ä¾‹å­ï¼ˆè¦†ç›–ç´¢å¼•ï¼‰ï¼š</p>
<ul>
<li>æœ‰ <code>idx(a,b,c)</code></li>
<li><code>select a,b from t where a=? and b=?</code> â†’ å¯èƒ½ç›´æ¥åœ¨ç´¢å¼•å¶å­æ‹¿åˆ°éœ€è¦åˆ—ï¼Œä¸å›è¡¨ã€‚</li>
</ul>
<h2 data-id="heading-3">4ï¼‰çº¦æŸè¯­ä¹‰ä¸åŒ</h2>
<ul>
<li>ä¸»é”®ï¼šå¼ºçº¦æŸï¼ˆå”¯ä¸€ + éç©ºï¼‰ï¼Œå¹¶ä¸”å½±å“ InnoDB è¡Œå­˜å‚¨ç»„ç»‡æ–¹å¼ï¼ˆæ•°æ®æŒ‰ä¸»é”®é¡ºåºç»„ç»‡ï¼‰ã€‚</li>
<li>è”åˆç´¢å¼•ï¼šæ›´å¤šæ˜¯ä¸ºæŸ¥è¯¢/æ’åº/åˆ†ç»„æœåŠ¡ï¼›è‹¥æ˜¯ <code>UNIQUE(a,b)</code> æ‰å¸¦â€œç»„åˆå”¯ä¸€â€çš„çº¦æŸè¯­ä¹‰ã€‚</li>
</ul>
<h2 data-id="heading-4">5ï¼‰è®¾è®¡å»ºè®®ï¼ˆå®æˆ˜ï¼‰</h2>
<ul>
<li>
<p>ä¸»é”®å»ºè®®ï¼š<strong>çŸ­ã€å•è°ƒé€’å¢ã€ç¨³å®š</strong>ï¼ˆå¦‚ BIGINT è‡ªå¢æˆ–é›ªèŠ± IDï¼‰ï¼Œé¿å…ç”¨é•¿å­—ç¬¦ä¸²åšä¸»é”®ï¼ˆä¼šå¯¼è‡´äºŒçº§ç´¢å¼•å¶å­ä¹Ÿæ›´å¤§ï¼Œå› ä¸ºäºŒçº§ç´¢å¼•å¶å­è¦å­˜ä¸»é”®å€¼ï¼‰ã€‚</p>
</li>
<li>
<p>è”åˆç´¢å¼•å»ºè®®ï¼š</p>
<ul>
<li>æŠŠ<strong>åŒºåˆ†åº¦é«˜ã€å¸¸ç”¨è¿‡æ»¤</strong>çš„åˆ—æ”¾å·¦è¾¹ï¼ˆä½†ä¹Ÿè¦çœ‹æŸ¥è¯¢æ¨¡å¼ï¼‰ã€‚</li>
<li>è®©ç´¢å¼•å°½é‡åŒæ—¶æœåŠ¡ <code>where + order by + group by</code>ï¼ˆé¿å… filesort / ä¸´æ—¶è¡¨ï¼‰ã€‚</li>
<li>èƒ½è¦†ç›–å°±è¦†ç›–ï¼šæŠŠå¸¸ç”¨ <code>select</code> å­—æ®µå°½é‡æ”¾è¿›è”åˆç´¢å¼•ï¼ˆä½†åˆ«ä¸ºäº†è¦†ç›–æ— é™åŠ åˆ—ï¼Œç´¢å¼•ä¼šå˜èƒ–ï¼Œå†™å…¥å˜æ…¢ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<h2 data-id="heading-5">6ï¼‰ä¸€å¥è¯æ€»ç»“</h2>
<ul>
<li><strong>ä¸»é”®ç´¢å¼•</strong>ï¼šè¡¨çš„â€œæ•°æ®æœ¬ä½“â€ç»„ç»‡æ–¹å¼ï¼Œç‚¹æŸ¥æœ€å¼ºã€åªèƒ½ä¸€ä¸ªã€å”¯ä¸€éç©ºã€å¶å­å­˜æ•´è¡Œã€‚</li>
<li><strong>è”åˆç´¢å¼•</strong>ï¼šä¸ºå¤šæ¡ä»¶æŸ¥è¯¢ä¼˜åŒ–çš„â€œç»„åˆé”®â€ç´¢å¼•ï¼Œéµå¾ªæœ€å·¦å‰ç¼€ï¼Œé€šå¸¸æ˜¯äºŒçº§ç´¢å¼•ï¼Œå¯èƒ½å›è¡¨ï¼Œèƒ½åšè¦†ç›–ç´¢å¼•ã€‚</li>
</ul>



































<table><thead><tr><th><strong>ç‰¹æ€§</strong></th><th><strong>ä¸»é”®ç´¢å¼• (Primary Key)</strong></th><th><strong>è”åˆç´¢å¼• (Composite Index)</strong></th></tr></thead><tbody><tr><td><strong>æ•°é‡é™åˆ¶</strong></td><td>ä¸€å¼ è¡¨åªèƒ½æœ‰ä¸€ä¸ª</td><td>ä¸€å¼ è¡¨å¯ä»¥æœ‰å¤šä¸ª</td></tr><tr><td><strong>æ˜¯å¦å…è®¸ä¸ºç©º</strong></td><td><strong>ä¸å…è®¸</strong> (NOT NULL)</td><td>å…è®¸ (é™¤éå®šä¹‰åˆ—æ—¶æŒ‡å®š NOT NULL)</td></tr><tr><td><strong>å”¯ä¸€æ€§</strong></td><td>å¿…é¡»å”¯ä¸€</td><td>å¯ä»¥ä¸å”¯ä¸€ï¼ˆé™¤éå®šä¹‰ä¸ºè”åˆå”¯ä¸€ç´¢å¼•ï¼‰</td></tr><tr><td><strong>å­˜å‚¨ç»“æ„</strong></td><td><strong>èšç°‡ç´¢å¼•</strong>ï¼šå¶å­èŠ‚ç‚¹å­˜çš„æ˜¯<strong>æ•´è¡Œæ•°æ®</strong></td><td><strong>è¾…åŠ©ç´¢å¼•</strong>ï¼šå¶å­èŠ‚ç‚¹å­˜çš„æ˜¯<strong>ä¸»é”®å€¼</strong></td></tr><tr><td><strong>ç»„æˆåˆ—æ•°</strong></td><td>é€šå¸¸ä¸º 1 åˆ—ï¼ˆä¹Ÿå¯ä»¥æ˜¯å¤åˆä¸»é”®ï¼‰</td><td>ç”± 2 åˆ—æˆ–æ›´å¤šåˆ—ç»„æˆ</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Module å’Œ Provider å¾ªç¯ä¾èµ–æ€ä¹ˆåŠï¼Ÿ]]></title>    <link>https://juejin.cn/post/7599951933594222602</link>    <guid>https://juejin.cn/post/7599951933594222602</guid>    <pubDate>2026-01-28T03:13:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599951933594222602" data-draft-id="7599459943918190630" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Module å’Œ Provider å¾ªç¯ä¾èµ–æ€ä¹ˆåŠï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,NestJS,Node.js"/> <meta itemprop="datePublished" content="2026-01-28T03:13:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯ä»˜è±ª"/> <meta itemprop="url" content="https://juejin.cn/user/1741228277763278"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Module å’Œ Provider å¾ªç¯ä¾èµ–æ€ä¹ˆåŠï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1741228277763278/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯ä»˜è±ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T03:13:10.000Z" title="Wed Jan 28 2026 03:13:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>A å¼•å…¥B Bå¼•å…¥A</p>
<p>æ–°å»ºä¸ªé¡¹ç›®çœ‹ä¸‹</p>
<pre><code class="hljs language-arduino" lang="arduino">nest <span class="hljs-keyword">new</span> circular-reference -p npm
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fbbb6f08fff04cddb4c0efef084cf8fc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5LuY6LGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174789&amp;x-signature=VqreQ2wmHxCOlR7yUt77IDuSupM%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-arduino" lang="arduino">nest g <span class="hljs-keyword">module</span> aaa 
nest g <span class="hljs-keyword">module</span> bbb
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/57738656f5f846e48e5dd35f6c6d5b7f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5LuY6LGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174789&amp;x-signature=%2FRikrP0QtIf4ZmhM2MQsV9Nxvsc%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dcfc377fa98c46aaa23e9e3eb667381b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5LuY6LGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174789&amp;x-signature=ko2PxEDPRN4redP2LIwaBA6aDv0%3D" alt="image.png" loading="lazy"/></p>
<p>å¯åŠ¨åæŠ¥é”™</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dfda498af8794d85b216ff50bc865a21~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5LuY6LGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174789&amp;x-signature=CCaQzQzeedKlLWrUt4clWrDDGGM%3D" alt="image.png" loading="lazy"/></p>
<p>å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ
å…ˆå•ç‹¬åˆ›å»ºè¿™ä¸¤ä¸ª Moduleï¼Œç„¶åå†è®©ä¸¤è€…å…³è”èµ·æ¥ï¼Œä½¿ç”¨ forwardRef</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3ff4286365a8486b8714ab545f2b24ff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5LuY6LGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174789&amp;x-signature=Shrma%2FpmEhJ2mi9qogp4Cog%2Fb7Y%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b77b3b4299a54c79898ae9aff6bb52f8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5LuY6LGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174789&amp;x-signature=LdqsgiwZLkBwWmNuBs3KZPOnkcM%3D" alt="image.png" loading="lazy"/></p>
<p>å†æ¬¡å¯åŠ¨ä¸ä¼šæŠ¥é”™</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d6e42a7172df44baa1502074eec50976~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5LuY6LGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174789&amp;x-signature=x0yvcFfppEASvoczHD%2BMpXmweM0%3D" alt="image.png" loading="lazy"/></p>
<p>åŸå› å°±åœ¨äº nest ä¼šå•ç‹¬åˆ›å»ºä¸¤ä¸ª Moduleï¼Œä¹‹åå†æŠŠ Module çš„å¼•ç”¨è½¬å‘è¿‡å»</p>
<p>é™¤äº† Module ï¼Œprovider å’Œ Service ä¹Ÿä¼šå­˜åœ¨ å¾ªç¯å¼•ç”¨</p>
<pre><code class="hljs language-css" lang="css">
nest g service ccc <span class="hljs-attr">--no-spec</span> <span class="hljs-attr">--flat</span> 
nest g service ddd <span class="hljs-attr">--no-spec</span> <span class="hljs-attr">--flat</span>
</code></pre>
<p>å¹¶ä¸”äº’ç›¸å¼•ç”¨ä¸‹</p>
<pre><code class="hljs language-typescript" lang="typescript">
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Injectable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">DddService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./ddd.service'</span>;

<span class="hljs-meta">@Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CccService</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> dddService: DddService</span>) {}

  <span class="hljs-title function_">ccc</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">'ccc'</span>;
  }

  <span class="hljs-title function_">eee</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">dddService</span>.<span class="hljs-title function_">ddd</span>() + <span class="hljs-string">'eee'</span>;
  }
}

</code></pre>
<pre><code class="hljs language-typescript" lang="typescript">
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Injectable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">CccService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./ccc.service'</span>;

<span class="hljs-meta">@Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DddService</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> cccService: CccService</span>) {}

  <span class="hljs-title function_">ddd</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">cccService</span>.<span class="hljs-title function_">ccc</span>() + <span class="hljs-string">'ddd'</span>;
  }
}

</code></pre>
<p>app.service.ts ä½¿ç”¨</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Injectable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">CccService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./ccc.service'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">DddService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./ddd.service'</span>;

<span class="hljs-meta">@Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppService</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">
    <span class="hljs-keyword">private</span> cccService: CccService,
    <span class="hljs-keyword">private</span> dddService: DddService,
  </span>) {}

  <span class="hljs-title function_">getHello</span>(): <span class="hljs-built_in">string</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">dddService</span>.<span class="hljs-title function_">ddd</span>() + <span class="hljs-variable language_">this</span>.<span class="hljs-property">cccService</span>.<span class="hljs-title function_">eee</span>();
  }
}

</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0c21d91960d64f12b053b6321571952d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5LuY6LGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174789&amp;x-signature=ZSkr13kVKa8eeCoDbREsQ8aRrTs%3D" alt="image.png" loading="lazy"/></p>
<p>ä½¿ç”¨ forwardRef è§£å†³</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bf13bc57c8dc41a5b9a8923822caa2d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5LuY6LGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174789&amp;x-signature=kXwz6QLnnGVfzvGPVAZcniqqqV4%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3b021a21355241888d4b78c38f2ce098~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5LuY6LGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174789&amp;x-signature=VIJgZMEWOrDsIgeHSSli%2FEYz%2BAA%3D" alt="image.png" loading="lazy"/></p>
<p>å†æ¬¡å¯åŠ¨æœåŠ¡å°±æ²¡é—®é¢˜äº†</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b612be5ccdfe42738f595049624f9193~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5LuY6LGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770174789&amp;x-signature=UF0GvN7i5CC31t84JS41520pO60%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å›½ä¼ä¸‰å¹´æˆ‘ç°åœ¨æ€ä¹ˆæ ·äº†]]></title>    <link>https://juejin.cn/post/7599868109086867498</link>    <guid>https://juejin.cn/post/7599868109086867498</guid>    <pubDate>2026-01-28T03:30:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599868109086867498" data-draft-id="7599826983888371755" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å›½ä¼ä¸‰å¹´æˆ‘ç°åœ¨æ€ä¹ˆæ ·äº†"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-28T03:30:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æå‰é€€ä¼‘çš„javaçŒ¿"/> <meta itemprop="url" content="https://juejin.cn/user/465848660928872"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å›½ä¼ä¸‰å¹´æˆ‘ç°åœ¨æ€ä¹ˆæ ·äº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/465848660928872/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æå‰é€€ä¼‘çš„javaçŒ¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T03:30:32.000Z" title="Wed Jan 28 2026 03:30:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<blockquote>
<p>æˆ‘æ˜¯[<a href="https://juejin.cn/user/465848660928872" title="https://juejin.cn/user/465848660928872" target="_blank">æå‰é€€ä¼‘çš„javaçŒ¿</a>]ï¼Œä¸€å7å¹´javaå¼€å‘ç»éªŒçš„å¼€å‘ç»„é•¿ï¼Œåˆ†äº«å·¥ä½œä¸­çš„å„ç§é—®é¢˜ï¼</p>
</blockquote>
<p>23å¹´å¹´åˆæ¥åˆ°ç°åœ¨å…¬å¸ï¼Œå·²ç»ä¸‰å¹´äº†ã€‚æ²¡é”™å…¬å¸çš„è–ªèµ„ç¨³å®šå¾—ç¦»è°±ã€‚ä»æ¥æ²¡æ¶¨è¿‡ï¼Œä½ è¯´æˆ‘èƒ½åŠ›ä¸è¡Œè¡¨ç°ä¸å¥½å˜›ï¼Œæˆ‘ä¹Ÿæ‹¿è¿‡<code>ä¼˜ç§€å‘˜å·¥</code>ã€‚ç°åœ¨æ˜æ˜¾æ„Ÿè§‰åˆ°35å²å±æœºçš„å‹åŠ›äº†ï¼Œä¹°æˆ¿ã€ç»“å©šã€ç”Ÿå­ç°åœ¨ä¹Ÿæ˜¯æˆ‘æœ€è¿‘è¦è€ƒè™‘çš„é—®é¢˜äº†ã€‚è¦æƒ³æ”¶å…¥æé«˜ä¸€ä¸ªç­‰çº§å¯¹æˆ‘æ¥è¯´ç°åœ¨å¾ˆéš¾äº†.........</p>
<p>å› ä¸ºç›®å‰å¯¹æˆ‘æ¥è¯´æƒ³è¦æ”¶å…¥æé«˜ä¸€ä¸ªå°ç­‰çº§æ¯”å¦‚æ”¶å…¥æé«˜ï¼ˆ50%ï¼‰ï¼Œè¦ä¹ˆ996ï¼Œè¦ä¹ˆæ‹¥æŠ±AIå†²ä¸€æ³¢ç„¶åè·³æ§½ã€‚è¿™ä¸¤æ¡è·¯éƒ½ä¸åœ¨æˆ‘çš„è§„åˆ’ä¸­ï¼Œæ”¾å¼ƒæŠ€æœ¯ å®ç°ç¡åæ”¶å…¥ğŸ˜‚æ‰æ˜¯æˆ‘çš„ç›®æ ‡ï¼ˆä¸æ’å—å¢™ä¸å›å¤´ï¼‰ã€‚</p>
<h2 data-id="heading-1">ä¸‰å¹´æˆ‘éƒ½åœ¨å¹²å˜›</h2>
<p>è¿™ä¸‰å¹´ï¼Œæ¯ä¸€å¹´æˆ‘çš„çŠ¶æ€è¿˜æ˜¯æœ‰å¾ˆå¤§åŒºåˆ«çš„ã€‚ç¬¬ä¸€å¹´åŠªåŠ›å·¥ä½œç«™ç¨³è„šè·Ÿï¼Œç¬¬äºŒå¹´é—²æš‡æ—¶é—´å†™æ–‡ç« å¼€å§‹æ¥è§¦çŸ­è§†é¢‘ï¼Œç¬¬ä¸‰å¹´ï¼ˆ25å¹´ï¼‰å¹´åˆå…¬å¸è£å‘˜åº†å¹¸è‡ªå·±æ²¡æœ‰è¢«ä¼˜åŒ–ã€‚ç¬¬ä¸‰å¹´è£å‘˜ä¹‹åï¼Œä¹Ÿæ˜¯è¿‡å¾—æœ€èˆ’æœçš„ä¸€å¹´ã€‚</p>
<p>ä»Šå¹´ï¼ˆ25å¹´ï¼‰å¼€å§‹æŠŠæ›´å¤šçš„ç²¾åŠ›èŠ±åœ¨äº†ä¸ªäººæ¢ç´¢ä¸Šï¼Œåšè‡ªåª’ä½“ï¼ˆç²‰ä¸<code>3600</code>ğŸ˜­ï¼‰ã€‚å› ä¸ºé•¿æœŸçš„å†™æ–‡ç« åšè§†é¢‘ï¼Œä¹Ÿç®—æ˜¯æ¥äº†ä¸¤ä¸ªå¹¿å­ã€‚ä¸æ€•å¤§å®¶ç¬‘è¯ä¸€å…±èµšäº†ä¸åˆ°<code>2000</code>å—ã€‚</p>
<p>åœ¨å·¥ä½œæœŸé—´æˆ‘ä¹ŸèŠ±äº†å¾ˆå¤šçš„æ—¶é—´å»æ€è€ƒä»¥åçš„è·¯æ€ä¹ˆèµ°ï¼Œæ—¢ç„¶æ¥äº†è¿™<code>å…»è€å…¬å¸</code>ï¼Œå°±å¾—åˆ©ç”¨é—²æš‡æ—¶é—´æ¢ç´¢å‡ºä¸€æ¡è·¯æ¥ï¼ç„¶è€Œä¸‰å¹´è¿‡å»äº†ï¼Œæ²¡æœ‰ä»€ä¹ˆèµ·è‰²ï¼</p>
<hr/>
<p><code>æœ€å¤§çš„æ”¶è·ï¼š</code>  å°±æ˜¯è¡ŒåŠ¨èµ·æ¥äº†ï¼Œé€šè¿‡åšæŒå†™æ–‡ç« ï¼Œåšè§†é¢‘è®©è‡ªå·±æœ‰äº†ç‹¬ç«‹æ€è€ƒï¼Œæœ‰äº†ç‹¬ç«‹åšäº‹å„¿çš„èƒ½åŠ›ï¼Œæœ‰äº†ç‹¬ç«‹åšäº‹å„¿çš„ä¿¡å¿ƒã€‚</p>
<hr/>
<p><code>æˆ‘çš„ç‰ºç‰²ï¼š</code>
å¯¹æˆ‘çš„<code>å·¥ä½œå½±å“</code>å…¶å®è¿˜æ˜¯æœ‰çš„ã€‚å› ä¸ºåœ¨ä¸Šç­æœŸé—´æˆ‘çš„æ€è·¯çš„æ˜¯å¹¶è¡Œçš„ï¼Œæ²¡æ³•ä¸“æ³¨çš„å¹²ä¸€ä»¶äº‹å„¿ï¼Œå¥½åœ¨å·¥ä½œä¸Šçš„äº‹å„¿ï¼Œå€ŸåŠ©ç°åœ¨çš„AI èƒ½å¤Ÿè½»æ¾é«˜æ•ˆçš„å®Œæˆã€‚æˆ‘ç°åœ¨å†™æ¥å£åŸºæœ¬ä¸Šéƒ½ä¸ä¼šè‡ªæµ‹äº†ğŸ˜‚ã€‚æœ€å¤§çš„å½±å“å°±æ˜¯è‡ªå·±å¹²çš„æ´»å„¿ã€åšçš„ä¸šåŠ¡è®°ä¸ä½ï¼Œå› ä¸ºæ€ç»´æ²¡æœ‰æ·±åº¦å‚ä¸å…¶ä¸­ï¼Œæœ‰æ—¶å€™çœ‹ç€ä»£ç è‡ªå·±éƒ½æ²¡æœ‰å°è±¡ï¼Œå› ä¸ºä»£ç åŸºæœ¬ä¹Ÿéƒ½æ˜¯AIå†™çš„åŠ ä¸Šè‡ªå·±æ³¨æ„åŠ›ä¸å¤Ÿä¸“æ³¨ã€‚</p>
<p><code>æ— æ‰€è°“äº†</code>æ—¢ç„¶åšäº†å†³å®šæ¥äº†è¿™å…»è€å…¬å¸ï¼Œå¹¶ä¸”æ²¡æœ‰æ¶¨è–ªå‡èŒçš„æœºä¼šï¼Œå·¥ä½œä¸Šçš„äº‹å„¿èƒ½å®Œæˆå°±è¡Œäº†ã€‚</p>
<h2 data-id="heading-2">26å¹´æ€ä¹ˆåš</h2>
<p>3å¹´äº†ï¼Œè¿˜æ˜¯æ²¡æœ‰æ‰¾åˆ°ä¸€ä¸ªæ–¹å‘åšå®šçš„åšä¸‹å»ï¼ä»Šå¹´çš„ç›®æ ‡æŠ–éŸ³ç²‰ä¸å…ˆç ´<code>1ä¸‡</code>ï¼Œç„¶åæ¢ç´¢ç‹¬ç«‹å¼€å‘ï¼Œåˆ©ç”¨AI å¿«é€Ÿå½¢æˆè‡ªå·±çš„ä¸€å¥—å…¨æ ˆå¼€å‘æµç¨‹ã€‚ä»¥åèƒ½ä¸èƒ½ç‹¬ç«‹æ¥å•æˆ–è€…ç»´æŠ¤ä¸€äº›è‡ªå·±çš„å°äº§å“ã€‚<strong>å¦‚æœèƒ½æ‰¾åˆ°å¿—åŒé“åˆçš„å…„å¼Ÿä¸€èµ·å¹²é‚£å°±æ˜¯æœ€å¥½çš„å‘¢ã€‚</strong></p>
<h2 data-id="heading-3">æ€»ç»“</h2>
<p>åœ¨èŒåœºå½“ä¸€ä¸ªæ··å­ï¼Œå‘ç€ç›®æ ‡å‡ºå‘ï¼èšç„¦ä¸€ä¸ªæ–¹å‘ï¼</p>
<blockquote>
<p>æ¯å¹´ä¸€ç¯‡å¹´ç»ˆæ€»ç»“ï¼š<br/>
<a href="https://juejin.cn/user/465848660928872/posts" target="_blank" title="https://juejin.cn/user/465848660928872/posts">åœ¨å›½ä¼å¾…äº†ä¸€å¹´äº†ï¼Œåæ§½ä¸€ä¸‹å§</a><br/>
<a href="https://juejin.cn/post/7440687454581833737" target="_blank" title="https://juejin.cn/post/7440687454581833737">å…¥èŒå›½ä¼å¿«2å¹´äº†ï¼Œåˆ†äº«ä¸€ä¸‹æˆ‘æœ€è¿‘çš„çŠ¶æ€å§</a></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Browserslist é…ç½®è¯´æ˜æ–‡æ¡£]]></title>    <link>https://juejin.cn/post/7599912857393217582</link>    <guid>https://juejin.cn/post/7599912857393217582</guid>    <pubDate>2026-01-28T03:21:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599912857393217582" data-draft-id="7599912857393201198" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Browserslist é…ç½®è¯´æ˜æ–‡æ¡£"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-28T03:21:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æœç„¶_"/> <meta itemprop="url" content="https://juejin.cn/user/4177799915779224"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Browserslist é…ç½®è¯´æ˜æ–‡æ¡£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4177799915779224/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æœç„¶_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T03:21:50.000Z" title="Wed Jan 28 2026 03:21:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>ä»€ä¹ˆæ˜¯ Browserslist</strong></h2>
<p>Browserslist æ˜¯ä¸€ä¸ªåœ¨ä¸åŒå‰ç«¯å·¥å…·ä¹‹é—´<strong>å…±äº«ç›®æ ‡æµè§ˆå™¨å’Œ Node.js ç‰ˆæœ¬</strong>çš„é…ç½®å·¥å…·ã€‚å®ƒå…è®¸ä½ é€šè¿‡ä¸€ä¸ªç»Ÿä¸€çš„é…ç½®æ¥æŒ‡å®šé¡¹ç›®éœ€è¦æ”¯æŒçš„æµè§ˆå™¨èŒƒå›´ã€‚</p>
<h3 data-id="heading-1"><strong>æ ¸å¿ƒæ¦‚å¿µ</strong></h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"browserslist"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"&gt; 1%"</span><span class="hljs-punctuation">,</span>           <span class="hljs-comment">// å…¨çƒä½¿ç”¨ç‡è¶…è¿‡ 1% çš„æµè§ˆå™¨</span>
    <span class="hljs-string">"last 2 versions"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// æ¯ä¸ªæµè§ˆå™¨çš„æœ€å 2 ä¸ªç‰ˆæœ¬</span>
    <span class="hljs-string">"not dead"</span>        <span class="hljs-comment">// æ’é™¤å®˜æ–¹ä¸å†æ”¯æŒçš„æµè§ˆå™¨</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>è¿™ä¸ªé…ç½®ä¼šè¢«å¤šä¸ªå·¥å…·è¯»å–ï¼Œç¡®ä¿æ•´ä¸ªæ„å»ºæµç¨‹ä½¿ç”¨ç›¸åŒçš„æµè§ˆå™¨å…¼å®¹æ€§ç›®æ ‡ã€‚</p>
<h2 data-id="heading-2"><strong>Browserslist çš„ä½œç”¨</strong></h2>
<ol>
<li>
<h3 data-id="heading-3"><strong>ç»Ÿä¸€æµè§ˆå™¨å…¼å®¹æ€§æ ‡å‡†</strong></h3>
</li>
</ol>
<p>åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œå¤šä¸ªå·¥å…·å¯èƒ½éœ€è¦çŸ¥é“ç›®æ ‡æµè§ˆå™¨ï¼š</p>
<ul>
<li>Autoprefixer éœ€è¦çŸ¥é“å“ªäº› CSS å±æ€§éœ€è¦æ·»åŠ å‰ç¼€</li>
<li>Babel éœ€è¦çŸ¥é“å“ªäº› JavaScript è¯­æ³•éœ€è¦è½¬è¯‘</li>
<li>ESLint éœ€è¦çŸ¥é“å“ªäº› API å¯ä»¥ä½¿ç”¨</li>
</ul>
<p>Browserslist æä¾›äº†ä¸€ä¸ª<strong>å•ä¸€é…ç½®æº</strong>ï¼Œé¿å…åœ¨å¤šä¸ªåœ°æ–¹é‡å¤é…ç½®ã€‚</p>
<ol start="2">
<li>
<h3 data-id="heading-4"><strong>è‡ªåŠ¨åŒ–æµè§ˆå™¨å…¼å®¹æ€§å¤„ç†</strong></h3>
</li>
</ol>

<ol>
<li>
<h4 data-id="heading-5"><strong>JavaScript</strong> <strong>è½¬è¯‘</strong></h4>
</li>
</ol>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// æºä»£ç </span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">value</span> = obj?.property ?? <span class="hljs-string">'default'</span>;

<span class="hljs-comment">// å¦‚æœç›®æ ‡æµè§ˆå™¨ä¸æ”¯æŒ ES2020</span>
<span class="hljs-comment">// Babel ä¼šè‡ªåŠ¨è½¬è¯‘ä¸ºï¼š</span>
<span class="hljs-keyword">var</span> _a;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">value</span> = (_a = obj === <span class="hljs-literal">null</span> || obj === <span class="hljs-keyword">void</span> <span class="hljs-number">0</span> ? <span class="hljs-keyword">void</span> <span class="hljs-number">0</span> : obj.property) !== <span class="hljs-literal">null</span> &amp;&amp; _a !== <span class="hljs-keyword">void</span> <span class="hljs-number">0</span> ? _a : <span class="hljs-string">'default'</span>;
</code></pre>
<ol start="2">
<li>
<h4 data-id="heading-6"><strong>CSS å‰ç¼€è‡ªåŠ¨æ·»åŠ </strong></h4>
</li>
</ol>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* æºä»£ç  */</span>
<span class="hljs-selector-class">.box</span> {
  <span class="hljs-attribute">display</span>: flex;
  user-select: none;
}

<span class="hljs-comment">/* å¦‚æœç›®æ ‡åŒ…å«æ—§æµè§ˆå™¨ï¼ŒAutoprefixer ä¼šè‡ªåŠ¨æ·»åŠ å‰ç¼€ */</span>
<span class="hljs-selector-class">.box</span> {
  <span class="hljs-attribute">display</span>: -webkit-box;
  <span class="hljs-attribute">display</span>: -ms-flexbox;
  <span class="hljs-attribute">display</span>: flex;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
</code></pre>
<ol start="3">
<li>
<h3 data-id="heading-7"><strong>ä¼˜åŒ–æ„å»ºäº§ç‰©å¤§å°</strong></h3>
</li>
</ol>
<p>é€šè¿‡ç²¾ç¡®æŒ‡å®šç›®æ ‡æµè§ˆå™¨ï¼Œå¯ä»¥ï¼š</p>
<ul>
<li>å‡å°‘ä¸å¿…è¦çš„ polyfill</li>
<li>é¿å…è¿‡åº¦è½¬è¯‘</li>
<li>ç”Ÿæˆæ›´å°çš„æ„å»ºäº§ç‰©</li>
</ul>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// å¦‚æœç›®æ ‡æµè§ˆå™¨éƒ½æ”¯æŒ ES2020</span>
<span class="hljs-comment">// å°±ä¸éœ€è¦è½¬è¯‘ï¼Œä¿æŒåŸæ ·ï¼Œä»£ç æ›´å°</span>
<span class="hljs-type">const</span> value = obj?.property ?? <span class="hljs-string">'default'</span>;
</code></pre>
<h2 data-id="heading-8"><strong>å¸¸ç”¨é…ç½®ç¤ºä¾‹</strong></h2>
<ol>
<li>
<h3 data-id="heading-9"><strong>é…ç½®ä½ç½®</strong></h3>
</li>
</ol>
<p>Browserslist é…ç½®å¯ä»¥æ”¾åœ¨ä»¥ä¸‹ä½ç½®ï¼ˆæŒ‰ä¼˜å…ˆçº§æ’åºï¼‰ï¼š</p>
<ol>
<li>
<p><strong>package.json</strong> ä¸­çš„ <code>browserslist</code> å­—æ®µï¼ˆæ¨èï¼‰</p>
</li>
<li>
<p><code>.browserslistrc</code> æ–‡ä»¶</p>
</li>
<li>
<p><code>browserslist</code> é…ç½®æ–‡ä»¶</p>
</li>
</ol>

<ol start="2">
<li>
<h3 data-id="heading-10"><strong>ç°ä»£æµè§ˆå™¨é…ç½®ï¼ˆæ¨èï¼‰</strong></h3>
</li>
</ol>
<pre><code class="hljs language-perl" lang="perl">{
  <span class="hljs-string">"browserslist"</span>: {
    <span class="hljs-string">"production"</span>: [
      <span class="hljs-string">"&gt;0.2%",
      "</span><span class="hljs-keyword">not</span> dead<span class="hljs-string">",
      "</span><span class="hljs-keyword">not</span> op_mini all<span class="hljs-string">"
    ],
    "</span>development<span class="hljs-string">": [
      "</span><span class="hljs-keyword">last</span> <span class="hljs-number">1</span> chrome version<span class="hljs-string">",
      "</span><span class="hljs-keyword">last</span> <span class="hljs-number">1</span> firefox version<span class="hljs-string">",
      "</span><span class="hljs-keyword">last</span> <span class="hljs-number">1</span> safari version<span class="hljs-string">"
    ]
  }
}
</span></code></pre>
<p><strong>è¯´æ˜ï¼š</strong></p>
<ul>
<li><code>&gt;0.2%</code>ï¼šå…¨çƒä½¿ç”¨ç‡è¶…è¿‡ 0.2% çš„æµè§ˆå™¨</li>
<li><code>not dead</code>ï¼šæ’é™¤å®˜æ–¹ä¸å†æ”¯æŒçš„æµè§ˆå™¨ï¼ˆ24 ä¸ªæœˆå†…æ— æ›´æ–°ï¼‰</li>
<li><code>not op_mini all</code>ï¼šæ’é™¤ Opera Miniï¼ˆä¸æ”¯æŒç°ä»£ç‰¹æ€§ï¼‰</li>
<li>å¼€å‘ç¯å¢ƒåªé’ˆå¯¹æœ€æ–°ç‰ˆæœ¬ï¼ŒåŠ å¿«æ„å»ºé€Ÿåº¦</li>
</ul>
<ol start="3">
<li>
<h3 data-id="heading-11"><strong>ä¼ä¸šçº§åº”ç”¨é…ç½®</strong></h3>
</li>
</ol>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"browserslist"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"Chrome &gt;= 80"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"Firefox &gt;= 72"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"Safari &gt;= 13"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"Edge &gt;= 80"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"iOS &gt;= 13"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"Android &gt;= 8"</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> ä¼ä¸šå†…éƒ¨åº”ç”¨ï¼Œå¯ä»¥æ§åˆ¶ç”¨æˆ·æµè§ˆå™¨ç‰ˆæœ¬</p>
<ol start="4">
<li>
<h3 data-id="heading-12"><strong>å…¼å®¹æ—§æµè§ˆå™¨é…ç½®</strong></h3>
</li>
</ol>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"browserslist"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"&gt; 0.5%"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"last 2 versions"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"Firefox ESR"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"not dead"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"IE 11"</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>è¯´æ˜ï¼š</strong></p>
<ul>
<li><code>last 2 versions</code>ï¼šæ¯ä¸ªæµè§ˆå™¨çš„æœ€å 2 ä¸ªç‰ˆæœ¬</li>
<li><code>Firefox ESR</code>ï¼šFirefox é•¿æœŸæ”¯æŒç‰ˆ</li>
<li><code>IE 11</code>ï¼šæ”¯æŒ IE 11ï¼ˆéœ€è¦å¤§é‡ polyfillï¼‰</li>
</ul>
<ol start="5">
<li>
<h3 data-id="heading-13"><strong>ç§»åŠ¨ç«¯ä¼˜å…ˆé…ç½®</strong></h3>
</li>
</ol>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"browserslist"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"iOS &gt;= 12"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"Android &gt;= 6"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"ChromeAndroid &gt;= 80"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"Samsung &gt;= 10"</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<ol start="6">
<li>
<h3 data-id="heading-14"><strong>æŸ¥è¯¢è¯­æ³•å‚è€ƒ</strong></h3>
</li>
</ol>




























































<table><thead><tr><th>æŸ¥è¯¢è¯­æ³•</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>&gt; 5%</code></td><td>å…¨çƒä½¿ç”¨ç‡ &gt; 5%</td><td><code>&gt; 1%</code>, <code>&gt; 0.5%</code></td></tr><tr><td><code>&gt;= 5%</code></td><td>å…¨çƒä½¿ç”¨ç‡ &gt;= 5%</td><td><code>&gt;= 1%</code></td></tr><tr><td><code>last 2 versions</code></td><td>æœ€å N ä¸ªç‰ˆæœ¬</td><td><code>last 1 version</code></td></tr><tr><td><code>Chrome &gt; 90</code></td><td>ç‰¹å®šæµè§ˆå™¨ç‰ˆæœ¬</td><td><code>Firefox &gt;= 78</code></td></tr><tr><td><code>not dead</code></td><td>æ’é™¤ä¸å†ç»´æŠ¤çš„æµè§ˆå™¨</td><td>-</td></tr><tr><td><code>not IE 11</code></td><td>æ’é™¤ç‰¹å®šæµè§ˆå™¨</td><td><code>not op_mini all</code></td></tr><tr><td><code>since 2020</code></td><td>2020 å¹´åå‘å¸ƒçš„æµè§ˆå™¨</td><td><code>since 2019</code></td></tr><tr><td><code>Firefox ESR</code></td><td>Firefox é•¿æœŸæ”¯æŒç‰ˆ</td><td>-</td></tr><tr><td><code>iOS &gt;= 12</code></td><td>iOS Safari ç‰ˆæœ¬</td><td><code>iOS &gt;= 13</code></td></tr><tr><td><code>Android &gt;= 6</code></td><td>Android WebView ç‰ˆæœ¬</td><td><code>Android &gt;= 8</code></td></tr></tbody></table>
<h2 data-id="heading-15"><strong>éœ€è¦é…åˆçš„ä¾èµ–</strong></h2>
<p>Browserslist <strong>æœ¬èº«åªæ˜¯ä¸€ä¸ªé…ç½®å·¥å…·</strong>ï¼Œéœ€è¦é…åˆå…¶ä»–å·¥å…·æ‰èƒ½å‘æŒ¥ä½œç”¨ã€‚</p>
<h3 data-id="heading-16"><strong>æ ¸å¿ƒä¾èµ–å…³ç³»å›¾</strong></h3>
<pre><code class="hljs language-erlang" lang="erlang"><span class="hljs-function"><span class="hljs-title">browserslist</span> <span class="hljs-params">(é…ç½®)</span>
    â†“
    â”œâ”€â†’ A<span class="hljs-title">utoprefixer</span> <span class="hljs-params">(CSS å‰ç¼€)</span>
    â”œâ”€â†’ @<span class="hljs-title">babel</span>/<span class="hljs-title">preset</span>-<span class="hljs-title">env</span> <span class="hljs-params">(JS è½¬è¯‘)</span>
    â”œâ”€â†’ <span class="hljs-title">postcss</span>-<span class="hljs-title">preset</span>-<span class="hljs-title">env</span> <span class="hljs-params">(CSS æ–°ç‰¹æ€§)</span>
    â”œâ”€â†’ ESL<span class="hljs-title">int</span> <span class="hljs-params">(ä»£ç æ£€æŸ¥)</span>
    â””â”€â†’ S<span class="hljs-title">tylelint</span> <span class="hljs-params">(æ ·å¼æ£€æŸ¥)</span>
</span></code></pre>
<ol>
<li>
<h3 data-id="heading-17"><strong>Autoprefixerï¼ˆCSS è‡ªåŠ¨å‰ç¼€ï¼‰</strong></h3>
</li>
</ol>
<p><strong>ä½œç”¨ï¼š</strong> æ ¹æ® browserslist è‡ªåŠ¨ä¸º CSS å±æ€§æ·»åŠ æµè§ˆå™¨å‰ç¼€</p>
<p><strong>å®‰è£…ï¼š</strong></p>
<pre><code class="hljs language-csharp" lang="csharp">pnpm <span class="hljs-keyword">add</span> -D autoprefixer postcss
</code></pre>
<p><strong>é…ç½®ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// postcss.config.js</span>
<span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = {
  plugins: {
    autoprefixer: {}
  }
}
</code></pre>
<p><strong>æ•ˆæœï¼š</strong></p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* è¾“å…¥ */</span>
<span class="hljs-selector-class">.box</span> {
  <span class="hljs-attribute">display</span>: flex;
  user-select: none;
}

<span class="hljs-comment">/* è¾“å‡ºï¼ˆæ ¹æ® browserslistï¼‰ */</span>
<span class="hljs-selector-class">.box</span> {
  <span class="hljs-attribute">display</span>: -webkit-box;
  <span class="hljs-attribute">display</span>: -ms-flexbox;
  <span class="hljs-attribute">display</span>: flex;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
</code></pre>
<ol start="2">
<li>
<h3 data-id="heading-18"><strong>@babel/preset-envï¼ˆJavaScript è½¬è¯‘ï¼‰</strong></h3>
</li>
</ol>
<p><strong>ä½œç”¨ï¼š</strong> æ ¹æ® browserslist è‡ªåŠ¨è½¬è¯‘ JavaScript è¯­æ³•å’Œæ·»åŠ  polyfill</p>
<p><strong>å®‰è£…ï¼š</strong></p>
<pre><code class="hljs language-sql" lang="sql">pnpm <span class="hljs-keyword">add</span> <span class="hljs-operator">-</span>D <span class="hljs-variable">@babel</span><span class="hljs-operator">/</span>core <span class="hljs-variable">@babel</span><span class="hljs-operator">/</span>preset<span class="hljs-operator">-</span>env core<span class="hljs-operator">-</span>js
</code></pre>
<p><strong>é…ç½®ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// babel.config.js</span>
<span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = {
  presets: [
    [<span class="hljs-string">'@babel/preset-env'</span>, {
      useBuiltIns: <span class="hljs-string">'usage'</span>,  <span class="hljs-comment">// æŒ‰éœ€å¼•å…¥ polyfill</span>
      corejs: <span class="hljs-number">3</span>,             <span class="hljs-comment">// core-js ç‰ˆæœ¬</span>
      modules: <span class="hljs-literal">false</span>         <span class="hljs-comment">// ä¿ç•™ ES Modules</span>
    }]
  ]
}
</code></pre>
<p><strong>æ•ˆæœï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">// è¾“å…¥
const <span class="hljs-attr">value</span> = obj?.property ?? <span class="hljs-string">'default'</span><span class="hljs-comment">;</span>
const <span class="hljs-attr">arr</span> = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]<span class="hljs-comment">;</span>
const <span class="hljs-attr">last</span> = arr.at(-<span class="hljs-number">1</span>)<span class="hljs-comment">;</span>

// è¾“å‡ºï¼ˆå¦‚æœç›®æ ‡æµè§ˆå™¨ä¸æ”¯æŒï¼‰
var _obj$property<span class="hljs-comment">;</span>
const <span class="hljs-attr">value</span> = (_obj<span class="hljs-variable">$property</span> = obj === null || obj === void <span class="hljs-number">0</span> ? void <span class="hljs-number">0</span> : obj.property) !== null &amp;&amp; _obj<span class="hljs-variable">$property</span> !== void <span class="hljs-number">0</span> ? _obj<span class="hljs-variable">$property</span> : <span class="hljs-string">'default'</span><span class="hljs-comment">;</span>
const <span class="hljs-attr">arr</span> = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]<span class="hljs-comment">;</span>
const <span class="hljs-attr">last</span> = arr[arr.length - <span class="hljs-number">1</span>]<span class="hljs-comment">; // at() è¢«è½¬è¯‘</span>
</code></pre>
<ol start="3">
<li>
<h3 data-id="heading-19"><strong>postcss-preset-envï¼ˆCSS æ–°ç‰¹æ€§è½¬è¯‘ï¼‰</strong></h3>
</li>
</ol>
<p><strong>ä½œç”¨ï¼š</strong> æ ¹æ® browserslist è½¬è¯‘ç°ä»£ CSS ç‰¹æ€§</p>
<p><strong>å®‰è£…ï¼š</strong></p>
<pre><code class="hljs language-csharp" lang="csharp">pnpm <span class="hljs-keyword">add</span> -D postcss-preset-env
</code></pre>
<p><strong>é…ç½®ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// postcss.config.js</span>
<span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = {
  plugins: {
    <span class="hljs-string">'postcss-preset-env'</span>: {
      stage: <span class="hljs-number">3</span>,  <span class="hljs-comment">// ä½¿ç”¨ stage 3 åŠä»¥ä¸Šçš„ç‰¹æ€§</span>
      features: {
        <span class="hljs-string">'nesting-rules'</span>: <span class="hljs-literal">true</span>
      }
    }
  }
}
</code></pre>
<ol start="4">
<li>
<h3 data-id="heading-20"><strong>ESLint æ’ä»¶</strong></h3>
</li>
</ol>
<p><strong>ä½œç”¨ï¼š</strong> æ ¹æ® browserslist æ£€æŸ¥ä»£ç ä¸­ä½¿ç”¨çš„ API æ˜¯å¦å…¼å®¹</p>
<p><strong>å®‰è£…ï¼š</strong></p>
<pre><code class="hljs language-csharp" lang="csharp">pnpm <span class="hljs-keyword">add</span> -D eslint-plugin-compat
</code></pre>
<p><strong>é…ç½®ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// .eslintrc.js</span>
<span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = {
  plugins: [<span class="hljs-string">'compat'</span>],
  rules: {
    <span class="hljs-string">'compat/compat'</span>: <span class="hljs-string">'error'</span>
  }
}
</code></pre>
<h2 data-id="heading-21"><strong>ä½¿ç”¨æ–¹å¼è¯¦è§£</strong></h2>
<h3 data-id="heading-22"><strong>åœ¨ Vite é¡¹ç›®ä¸­ä½¿ç”¨</strong></h3>
<h4 data-id="heading-23"><strong>æ–¹æ¡ˆ 1ï¼šé…ç½® PostCSSï¼ˆCSS è‡ªåŠ¨å‰ç¼€ï¼‰</strong></h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// vite.config.ts</span>
<span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite'</span>;
<span class="hljs-keyword">import</span> autoprefixer <span class="hljs-keyword">from</span> <span class="hljs-string">'autoprefixer'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">css</span>: {
    <span class="hljs-attr">postcss</span>: {
      <span class="hljs-attr">plugins</span>: [
        <span class="hljs-title function_">autoprefixer</span>()
      ]
    }
  }
});
</code></pre>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// package.json</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"browserslist"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"&gt; 1%"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"last 2 versions"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"not dead"</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-24"><strong>æ–¹æ¡ˆ 2ï¼šé…ç½® Babelï¼ˆJavaScript è½¬è¯‘ï¼‰</strong></h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// vite.config.ts</span>
import { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite'</span>;
import react <span class="hljs-keyword">from</span> <span class="hljs-string">'@vitejs/plugin-react'</span>;

export <span class="hljs-keyword">default</span> <span class="hljs-title function_ invoke__">defineConfig</span>({
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-title function_ invoke__">react</span>({
      <span class="hljs-attr">babel</span>: {
        <span class="hljs-attr">presets</span>: [
          [<span class="hljs-string">'@babel/preset-env'</span>, {
            <span class="hljs-attr">useBuiltIns</span>: <span class="hljs-string">'usage'</span>,
            <span class="hljs-attr">corejs</span>: <span class="hljs-number">3</span>
          }]
        ]
      }
    })
  ]
});
</code></pre>
<h4 data-id="heading-25"><strong>æ–¹æ¡ˆ 3ï¼šä½¿ç”¨ @vitejs/plugin-legacyï¼ˆå…¼å®¹æ—§æµè§ˆå™¨ï¼‰</strong></h4>
<pre><code class="hljs language-sql" lang="sql">pnpm <span class="hljs-keyword">add</span> <span class="hljs-operator">-</span>D <span class="hljs-variable">@vitejs</span><span class="hljs-operator">/</span>plugin<span class="hljs-operator">-</span>legacy terser
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// vite.config.ts</span>
<span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite'</span>;
<span class="hljs-keyword">import</span> legacy <span class="hljs-keyword">from</span> <span class="hljs-string">'@vitejs/plugin-legacy'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-title function_">legacy</span>({
      <span class="hljs-attr">targets</span>: [<span class="hljs-string">'defaults'</span>, <span class="hljs-string">'not IE 11'</span>]
    })
  ]
});
</code></pre>
<p><strong>æ•ˆæœï¼š</strong></p>
<ul>
<li>ç”Ÿæˆç°ä»£æµè§ˆå™¨ç‰ˆæœ¬ï¼ˆES2020+ï¼‰</li>
<li>ç”Ÿæˆæ—§æµè§ˆå™¨ç‰ˆæœ¬ï¼ˆES5 + polyfillï¼‰</li>
<li>è‡ªåŠ¨æ ¹æ®æµè§ˆå™¨åŠ è½½å¯¹åº”ç‰ˆæœ¬</li>
</ul>
<h3 data-id="heading-26"><strong>åœ¨ Webpack é¡¹ç›®ä¸­ä½¿ç”¨</strong></h3>
<pre><code class="hljs language-css" lang="css">// webpack<span class="hljs-selector-class">.config</span><span class="hljs-selector-class">.js</span>
module<span class="hljs-selector-class">.exports</span> = {
  module: {
    rules: [
      {
        test: /.js$/,
        use: {
          loader: <span class="hljs-string">'babel-loader'</span>,
          options: {
            presets: [
              [<span class="hljs-string">'@babel/preset-env'</span>, {
                useBuiltIns: <span class="hljs-string">'usage'</span>,
                corejs: <span class="hljs-number">3</span>
              }]
            ]
          }
        }
      },
      {
        test: /.css$/,
        use: [
          <span class="hljs-string">'style-loader'</span>,
          <span class="hljs-string">'css-loader'</span>,
          {
            loader: <span class="hljs-string">'postcss-loader'</span>,
            options: {
              postcssOptions: {
                plugins: [
                  <span class="hljs-string">'autoprefixer'</span>
                ]
              }
            }
          }
        ]
      }
    ]
  }
};
</code></pre>
<h3 data-id="heading-27"><strong>éªŒè¯é…ç½®æ˜¯å¦ç”Ÿæ•ˆ</strong></h3>
<ol>
<li>
<h4 data-id="heading-28"><strong>æŸ¥çœ‹ç›®æ ‡æµè§ˆå™¨åˆ—è¡¨</strong></h4>
</li>
</ol>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta"># å®‰è£… browserslist CLI</span>
pnpm <span class="hljs-keyword">add</span> -D browserslist

<span class="hljs-meta"># æŸ¥çœ‹å½“å‰é…ç½®å¯¹åº”çš„æµè§ˆå™¨</span>
npx browserslist

<span class="hljs-meta"># æŸ¥çœ‹ç‰¹å®šæŸ¥è¯¢</span>
npx browserslist <span class="hljs-string">"&gt; 1%, last 2 versions"</span>
</code></pre>
<ol start="2">
<li>
<h4 data-id="heading-29"><strong>æ£€æŸ¥æ„å»ºäº§ç‰©</strong></h4>
</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ„å»ºé¡¹ç›®</span>
pnpm build

<span class="hljs-comment"># æ£€æŸ¥ CSS æ˜¯å¦æœ‰æµè§ˆå™¨å‰ç¼€</span>
grep -r <span class="hljs-string">"webkit"</span> dist/assets/css/*.css

<span class="hljs-comment"># æ£€æŸ¥ JS æ˜¯å¦è¢«è½¬è¯‘</span>
grep -r <span class="hljs-string">"??"</span> dist/assets/js/*.js  <span class="hljs-comment"># å¦‚æœæ‰¾åˆ°ï¼Œè¯´æ˜æ²¡æœ‰è½¬è¯‘</span>
</code></pre>
<h2 data-id="heading-30"><strong>å®é™…æ¡ˆä¾‹</strong></h2>
<h3 data-id="heading-31"><strong>æ¡ˆä¾‹ 1ï¼šç°ä»£ Web åº”ç”¨ï¼ˆæ¨èé…ç½®ï¼‰</strong></h3>
<pre><code class="hljs language-perl" lang="perl">{
  <span class="hljs-string">"name"</span>: <span class="hljs-string">"modern-web-app"</span>,
  <span class="hljs-string">"browserslist"</span>: {
    <span class="hljs-string">"production"</span>: [
      <span class="hljs-string">"&gt;0.2%",
      "</span><span class="hljs-keyword">not</span> dead<span class="hljs-string">",
      "</span><span class="hljs-keyword">not</span> op_mini all<span class="hljs-string">"
    ],
    "</span>development<span class="hljs-string">": [
      "</span><span class="hljs-keyword">last</span> <span class="hljs-number">1</span> chrome version<span class="hljs-string">",
      "</span><span class="hljs-keyword">last</span> <span class="hljs-number">1</span> firefox version<span class="hljs-string">"
    ]
  },
  "</span>devDependencies<span class="hljs-string">": {
    "</span>autoprefixer<span class="hljs-string">": "</span>^<span class="hljs-number">10.4</span>.<span class="hljs-number">14</span><span class="hljs-string">",
    "</span>postcss<span class="hljs-string">": "</span>^<span class="hljs-number">8.4</span>.<span class="hljs-number">24</span><span class="hljs-string">"
  }
}
</span></code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// vite.config.ts</span>
<span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite'</span>;
<span class="hljs-keyword">import</span> autoprefixer <span class="hljs-keyword">from</span> <span class="hljs-string">'autoprefixer'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">css</span>: {
    <span class="hljs-attr">postcss</span>: {
      <span class="hljs-attr">plugins</span>: [<span class="hljs-title function_">autoprefixer</span>()]
    }
  }
});
</code></pre>
<p><strong>ç»“æœï¼š</strong></p>
<ul>
<li>Chrome 87+, Firefox 78+, Safari 14+, Edge 88+</li>
<li>ä¸éœ€è¦è¿‡å¤šè½¬è¯‘ï¼Œæ„å»ºäº§ç‰©å°</li>
<li>å¼€å‘ç¯å¢ƒæ„å»ºå¿«</li>
</ul>
<h3 data-id="heading-32"><strong>æ¡ˆä¾‹ 2ï¼šä¼ä¸šå†…éƒ¨åº”ç”¨ï¼ˆç²¾ç¡®æ§åˆ¶ï¼‰</strong></h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"browserslist"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"Chrome &gt;= 90"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"Firefox &gt;= 88"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"Safari &gt;= 14"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"Edge &gt;= 90"</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>ä¼ä¸šå†…éƒ¨ç³»ç»Ÿ</li>
<li>å¯ä»¥è¦æ±‚ç”¨æˆ·ä½¿ç”¨ç‰¹å®šæµè§ˆå™¨</li>
<li>è¿½æ±‚æœ€å°æ„å»ºäº§ç‰©</li>
</ul>
<h3 data-id="heading-33"><strong>æ¡ˆä¾‹ 3ï¼šå…¼å®¹æ—§æµè§ˆå™¨ï¼ˆæœ€å¤§å…¼å®¹æ€§ï¼‰</strong></h3>
<pre><code class="hljs language-perl" lang="perl">{
  <span class="hljs-string">"browserslist"</span>: [
    <span class="hljs-string">"&gt; 0.5%",
    "</span><span class="hljs-keyword">last</span> <span class="hljs-number">2</span> versions<span class="hljs-string">",
    "</span>Firefox ESR<span class="hljs-string">",
    "</span><span class="hljs-keyword">not</span> dead<span class="hljs-string">"
  ],
  "</span>devDependencies<span class="hljs-string">": {
    "</span>@babel/core<span class="hljs-string">": "</span>^<span class="hljs-number">7.22</span>.<span class="hljs-number">0</span><span class="hljs-string">",
    "</span>@babel/preset-env<span class="hljs-string">": "</span>^<span class="hljs-number">7.22</span>.<span class="hljs-number">0</span><span class="hljs-string">",
    "</span>core-js<span class="hljs-string">": "</span>^<span class="hljs-number">3.31</span>.<span class="hljs-number">0</span><span class="hljs-string">",
    "</span>autoprefixer<span class="hljs-string">": "</span>^<span class="hljs-number">10.4</span>.<span class="hljs-number">14</span><span class="hljs-string">"
  }
}
</span></code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// babel.config.js</span>
<span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = {
  presets: [
    [<span class="hljs-string">'@babel/preset-env'</span>, {
      useBuiltIns: <span class="hljs-string">'usage'</span>,
      corejs: <span class="hljs-number">3</span>
    }]
  ]
};
</code></pre>
<p><strong>ç»“æœï¼š</strong></p>
<ul>
<li>æ”¯æŒæ›´å¤šæµè§ˆå™¨</li>
<li>æ„å»ºäº§ç‰©è¾ƒå¤§ï¼ˆåŒ…å« polyfillï¼‰</li>
<li>æ„å»ºæ—¶é—´è¾ƒé•¿</li>
</ul>
<h2 data-id="heading-34"><strong>å‚è€ƒèµ„æ–™</strong></h2>
<h3 data-id="heading-35"><strong>å®˜æ–¹æ–‡æ¡£</strong></h3>
<ul>
<li>
<p><strong>Browserslist å®˜æ–¹æ–‡æ¡£</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fbrowserslist%2Fbrowserslist" target="_blank" title="https://github.com/browserslist/browserslist" ref="nofollow noopener noreferrer">github.com/browserslisâ€¦</a></li>
</ul>
</li>
<li>
<p><strong>Browserslist æŸ¥è¯¢è¯­æ³•</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fbrowserslist%2Fbrowserslist%23queries" target="_blank" title="https://github.com/browserslist/browserslist#queries" ref="nofollow noopener noreferrer">github.com/browserslisâ€¦</a></li>
</ul>
</li>
<li>
<p><strong>Can I Use æ•°æ®åº“</strong>ï¼ˆBrowserslist ä½¿ç”¨çš„æ•°æ®æºï¼‰</p>
</li>
<li>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcaniuse.com%2F" target="_blank" title="https://caniuse.com/" ref="nofollow noopener noreferrer">caniuse.com/</a></p>
</li>
</ul>
<h3 data-id="heading-36"><strong>å·¥å…·æ–‡æ¡£</strong></h3>
<ul>
<li>
<p><strong>Autoprefixer</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fpostcss%2Fautoprefixer" target="_blank" title="https://github.com/postcss/autoprefixer" ref="nofollow noopener noreferrer">github.com/postcss/autâ€¦</a></li>
</ul>
</li>
<li>
<p><strong>@babel/preset-env</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fbabeljs.io%2Fdocs%2Fen%2Fbabel-preset-env" target="_blank" title="https://babeljs.io/docs/en/babel-preset-env" ref="nofollow noopener noreferrer">babeljs.io/docs/en/babâ€¦</a></li>
</ul>
</li>
<li>
<p><strong>postcss-preset-env</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fcsstools%2Fpostcss-plugins%2Ftree%2Fmain%2Fplugin-packs%2Fpostcss-preset-env" target="_blank" title="https://github.com/csstools/postcss-plugins/tree/main/plugin-packs/postcss-preset-env" ref="nofollow noopener noreferrer">github.com/csstools/poâ€¦</a></li>
</ul>
</li>
<li>
<p><strong>@vitejs/plugin-legacy</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvitejs%2Fvite%2Ftree%2Fmain%2Fpackages%2Fplugin-legacy" target="_blank" title="https://github.com/vitejs/vite/tree/main/packages/plugin-legacy" ref="nofollow noopener noreferrer">github.com/vitejs/viteâ€¦</a></li>
</ul>
</li>
</ul>
<h3 data-id="heading-37"><strong>åœ¨çº¿å·¥å…·</strong></h3>
<ul>
<li>
<p><strong>Browserslist åœ¨çº¿æŸ¥è¯¢(å¯è§†åŒ–æŸ¥çœ‹é…ç½®å¯¹åº”çš„æµè§ˆå™¨åˆ—è¡¨)</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fbrowsersl.ist%2F" target="_blank" title="https://browsersl.ist/" ref="nofollow noopener noreferrer">browsersl.ist/</a></li>
</ul>
</li>
<li>
<p><strong>Autoprefixer CSS Online(åœ¨çº¿æµ‹è¯• Autoprefixer æ•ˆæœ)</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fautoprefixer.github.io%2F" target="_blank" title="https://autoprefixer.github.io/" ref="nofollow noopener noreferrer">autoprefixer.github.io/</a></li>
</ul>
</li>
</ul>
<h2 data-id="heading-38"><strong>å¸¸è§é—®é¢˜</strong></h2>
<h3 data-id="heading-39"><strong>Q1: browserslist é…ç½®äº†ä½†æ²¡æœ‰ç”Ÿæ•ˆï¼Ÿ</strong></h3>
<p><strong>æ£€æŸ¥æ¸…å•ï¼š</strong></p>
<ol>
<li>âœ… æ˜¯å¦å®‰è£…äº†ç›¸å…³ä¾èµ–ï¼ˆautoprefixerã€@babel/preset-envï¼‰</li>
<li>âœ… æ˜¯å¦é…ç½®äº† PostCSS æˆ– Babel</li>
<li>âœ… é…ç½®æ–‡ä»¶ä½ç½®æ˜¯å¦æ­£ç¡®</li>
<li>âœ… æ„å»ºäº§ç‰©æ˜¯å¦çœŸçš„æ²¡æœ‰å˜åŒ–</li>
</ol>
<p><strong>éªŒè¯æ–¹æ³•ï¼š</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta"># æŸ¥çœ‹ç›®æ ‡æµè§ˆå™¨</span>
npx browserslist

<span class="hljs-meta"># æ£€æŸ¥æ„å»ºäº§ç‰©</span>
grep -r <span class="hljs-string">"webkit"</span> dist<span class="hljs-comment">/**/</span>*.css
</code></pre>
<h3 data-id="heading-40"><strong>Q2: å¦‚ä½•é€‰æ‹©åˆé€‚çš„ browserslist é…ç½®ï¼Ÿ</strong></h3>
<p><strong>å†³ç­–æ ‘ï¼š</strong></p>
<pre><code class="hljs language-css" lang="css">æ˜¯å¦éœ€è¦æ”¯æŒ IE <span class="hljs-number">11</span>ï¼Ÿ
â”œâ”€ æ˜¯ â†’ ä½¿ç”¨ <span class="hljs-selector-attr">[<span class="hljs-string">"IE 11"</span>, <span class="hljs-string">"&gt; 0.5%"</span>, <span class="hljs-string">"last 2 versions"</span>]</span>
â””â”€ å¦ â†’ æ˜¯å¦æ˜¯ä¼ä¸šå†…éƒ¨åº”ç”¨ï¼Ÿ
    â”œâ”€ æ˜¯ â†’ ç²¾ç¡®æŒ‡å®šç‰ˆæœ¬ <span class="hljs-selector-attr">[<span class="hljs-string">"Chrome &gt;= 90"</span>, <span class="hljs-string">"Firefox &gt;= 88"</span>]</span>
    â””â”€ å¦ â†’ ä½¿ç”¨é»˜è®¤é…ç½® <span class="hljs-selector-attr">[<span class="hljs-string">"&gt;0.2%"</span>, <span class="hljs-string">"not dead"</span>, <span class="hljs-string">"not op_mini all"</span>]</span>
</code></pre>
<h3 data-id="heading-41"><strong>Q3: browserslist ä¼šå½±å“ Vite çš„ build.target å—ï¼Ÿ</strong></h3>
<p><strong>ç­”æ¡ˆï¼šä¸ä¼šã€‚</strong></p>
<ul>
<li>Vite çš„ <code>build.target</code> æ˜¯ç‹¬ç«‹é…ç½®</li>
<li>å¦‚æœéœ€è¦ Vite ä½¿ç”¨ browserslistï¼Œéœ€è¦æ‰‹åŠ¨è¯»å–æˆ–ä½¿ç”¨æ’ä»¶</li>
<li>æ¨èä½¿ç”¨ <code>@vitejs/plugin-legacy</code> æ¥å®ç°</li>
</ul>
<h3 data-id="heading-42"><strong>Q4: å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒåº”è¯¥ç”¨ä¸åŒé…ç½®å—ï¼Ÿ</strong></h3>
<p><strong>æ¨èï¼šæ˜¯çš„ã€‚</strong></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"browserslist"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"production"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-string">"&gt;0.2%"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"not dead"</span>
    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"development"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-string">"last 1 chrome version"</span>  <span class="hljs-comment">// å¼€å‘ç¯å¢ƒåªé’ˆå¯¹æœ€æ–°æµè§ˆå™¨ï¼ŒåŠ å¿«æ„å»º</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-43"><strong>æ€»ç»“</strong></h2>
<h3 data-id="heading-44"><strong>Browserslist çš„ä»·å€¼</strong></h3>
<ol>
<li>
<p><strong>ç»Ÿä¸€é…ç½®æº</strong> - å¤šä¸ªå·¥å…·å…±äº«åŒä¸€ä»½æµè§ˆå™¨å…¼å®¹æ€§é…ç½®</p>
</li>
<li>
<p><strong>è‡ªåŠ¨åŒ–å¤„ç†</strong> - è‡ªåŠ¨æ·»åŠ  CSS å‰ç¼€ã€è½¬è¯‘ JS è¯­æ³•</p>
</li>
<li>
<p><strong>ä¼˜åŒ–æ„å»º</strong> - æ ¹æ®ç›®æ ‡æµè§ˆå™¨ç”Ÿæˆæœ€ä¼˜ä»£ç </p>
</li>
<li>
<p><strong>å›¢é˜Ÿåä½œ</strong> - æ˜ç¡®é¡¹ç›®çš„æµè§ˆå™¨æ”¯æŒèŒƒå›´</p>
</li>
</ol>
<h3 data-id="heading-45"><strong>ä½¿ç”¨å»ºè®®</strong></h3>
<ul>
<li>âœ… åœ¨ package.json ä¸­é…ç½® browserslist</li>
<li>âœ… å®‰è£…å¹¶é…ç½® autoprefixerï¼ˆCSS å‰ç¼€ï¼‰</li>
<li>âœ… æ ¹æ®é¡¹ç›®éœ€æ±‚é€‰æ‹©åˆé€‚çš„æµè§ˆå™¨èŒƒå›´</li>
<li>âœ… å®šæœŸæ›´æ–°é…ç½®ï¼Œç§»é™¤ä¸å†æ”¯æŒçš„æ—§æµè§ˆå™¨</li>
<li>âœ… ä½¿ç”¨ <code>npx browserslist</code> éªŒè¯é…ç½®</li>
</ul>
<h3 data-id="heading-46"><strong>æ³¨æ„äº‹é¡¹</strong></h3>
<ul>
<li>âš ï¸ browserslist æœ¬èº«ä¸åšä»»ä½•è½¬è¯‘ï¼Œéœ€è¦é…åˆå·¥å…·ä½¿ç”¨</li>
<li>âš ï¸ é…ç½®è¿‡äºå®½æ¾ä¼šå¯¼è‡´æ„å»ºäº§ç‰©è¿‡å¤§</li>
<li>âš ï¸ é…ç½®è¿‡äºä¸¥æ ¼å¯èƒ½å¯¼è‡´éƒ¨åˆ†ç”¨æˆ·æ— æ³•è®¿é—®</li>
<li>âš ï¸ å®šæœŸæ£€æŸ¥æ„å»ºäº§ç‰©ï¼Œç¡®ä¿é…ç½®ç”Ÿæ•ˆ</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[1-22.ã€GCDã€‘ä½¿ç”¨ DispatchSource æ—¶æœ€å®¹æ˜“è¸©çš„å‘æœ‰å“ªäº›ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7599868109086818346</link>    <guid>https://juejin.cn/post/7599868109086818346</guid>    <pubDate>2026-01-28T03:27:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599868109086818346" data-draft-id="7599924721006084159" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="1-22.ã€GCDã€‘ä½¿ç”¨ DispatchSource æ—¶æœ€å®¹æ˜“è¸©çš„å‘æœ‰å“ªäº›ï¼Ÿ"/> <meta itemprop="keywords" content="Swift"/> <meta itemprop="datePublished" content="2026-01-28T03:27:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¡¹é˜¿ä¸‘"/> <meta itemprop="url" content="https://juejin.cn/user/1407852323023447"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            1-22.ã€GCDã€‘ä½¿ç”¨ DispatchSource æ—¶æœ€å®¹æ˜“è¸©çš„å‘æœ‰å“ªäº›ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1407852323023447/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¡¹é˜¿ä¸‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T03:27:16.000Z" title="Wed Jan 28 2026 03:27:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1ï¸âƒ£ å¿˜è®° <code>resume()</code></h2>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">let</span> <span class="hljs-selector-tag">source</span> = <span class="hljs-selector-tag">DispatchSource</span><span class="hljs-selector-class">.makeTimerSource</span>(<span class="hljs-attribute">queue</span>: DispatchQueue.<span class="hljs-built_in">global</span>())
<span class="hljs-selector-tag">source</span><span class="hljs-selector-class">.schedule</span>(<span class="hljs-attribute">deadline</span>: .<span class="hljs-built_in">now</span>(), <span class="hljs-attribute">repeating</span>: <span class="hljs-number">1.0</span>)
<span class="hljs-selector-tag">source</span><span class="hljs-selector-class">.setEventHandler</span> { <span class="hljs-selector-tag">print</span>(<span class="hljs-string">"Timer fired"</span>) }
<span class="hljs-comment">// source.resume() // âš ï¸ å¿˜è®° resume</span>
</code></pre>
<ul>
<li><strong>å‘</strong>ï¼šåˆ›å»º DispatchSource åå¿…é¡»è°ƒç”¨ <code>resume()</code> æ‰ä¼šå¯åŠ¨äº‹ä»¶æº</li>
<li><strong>åŸå› </strong>ï¼šDispatchSource é»˜è®¤æ˜¯æš‚åœçŠ¶æ€</li>
<li><strong>åæœ</strong>ï¼šäº‹ä»¶æ°¸è¿œä¸ä¼šè§¦å‘</li>
<li><strong>è§£å†³</strong>ï¼šè°ƒç”¨ <code>resume()</code>ï¼›å¦‚æœéœ€è¦æš‚åœ/æ¢å¤ï¼Œç»“åˆ <code>suspend()</code> ä½¿ç”¨</li>
</ul>
<hr/>
<h2 data-id="heading-1">2ï¸âƒ£ DispatchSource è¢«é‡Šæ”¾</h2>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">DispatchSource</span><span class="hljs-selector-class">.makeTimerSource</span>(<span class="hljs-attribute">queue</span>: .<span class="hljs-built_in">global</span>())<span class="hljs-selector-class">.schedule</span>(<span class="hljs-attribute">deadline</span>: .<span class="hljs-built_in">now</span>(), <span class="hljs-attribute">repeating</span>: <span class="hljs-number">1.0</span>)<span class="hljs-selector-class">.setEventHandler</span> {
    <span class="hljs-selector-tag">print</span>(<span class="hljs-string">"Fired"</span>)
}
</code></pre>
<ul>
<li><strong>å‘</strong>ï¼šDispatchSource æ²¡æœ‰è¢«å¼ºå¼•ç”¨ â†’ ç«‹å³é‡Šæ”¾</li>
<li><strong>åŸå› </strong>ï¼šDispatchSource æ˜¯å¯¹è±¡ï¼Œå¦‚æœæ²¡æœ‰å¤–éƒ¨å¼•ç”¨ï¼Œç³»ç»Ÿä¼šé‡Šæ”¾å®ƒ</li>
<li><strong>åæœ</strong>ï¼šäº‹ä»¶æ°¸è¿œä¸ä¼šè§¦å‘</li>
<li><strong>è§£å†³</strong>ï¼šä¿ç•™ä¸€ä¸ªå¼ºå¼•ç”¨ï¼Œä¾‹å¦‚ç±»å±æ€§</li>
</ul>
<pre><code class="hljs language-php" lang="php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyClass</span> </span>{
    <span class="hljs-keyword">var</span> timer: DispatchSourceTimer?
    
    func <span class="hljs-title function_ invoke__">start</span>() {
        timer = DispatchSource.<span class="hljs-title function_ invoke__">makeTimerSource</span>(<span class="hljs-attr">queue</span>: .<span class="hljs-keyword">global</span>())
        timer?.<span class="hljs-title function_ invoke__">schedule</span>(<span class="hljs-attr">deadline</span>: .<span class="hljs-title function_ invoke__">now</span>(), <span class="hljs-attr">repeating</span>: <span class="hljs-number">1.0</span>)
        timer?.setEventHandler { <span class="hljs-keyword">print</span>(<span class="hljs-string">"Fired"</span>) }
        timer?.<span class="hljs-title function_ invoke__">resume</span>()
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-2">3ï¸âƒ£ çº¿ç¨‹å®‰å…¨è¯¯åŒº</h2>
<ul>
<li>
<p><strong>å‘</strong>ï¼šè®¤ä¸ºäº‹ä»¶å¤„ç† block å†…è®¿é—®çš„èµ„æºçº¿ç¨‹å®‰å…¨</p>
</li>
<li>
<p><strong>åŸå› </strong>ï¼šDispatchSource çš„å›è°ƒåœ¨æŒ‡å®šé˜Ÿåˆ—ä¸Šæ‰§è¡Œï¼Œ<strong>å¹¶å‘é˜Ÿåˆ—ä¸Šå¯èƒ½åŒæ—¶æ‰§è¡Œå¤šä¸ªäº‹ä»¶ block</strong></p>
</li>
<li>
<p><strong>åæœ</strong>ï¼šå…±äº«èµ„æºç«äº‰ã€æ•°æ®ä¸ä¸€è‡´</p>
</li>
<li>
<p><strong>è§£å†³</strong>ï¼š</p>
<ul>
<li>ä¸²è¡Œé˜Ÿåˆ—ä¿è¯é¡ºåºå’Œäº’æ–¥</li>
<li>å¹¶å‘é˜Ÿåˆ—è®¿é—®å…±äº«èµ„æºæ—¶åŠ é”æˆ– barrier</li>
</ul>
</li>
</ul>
<hr/>
<h2 data-id="heading-3">4ï¸âƒ£ é‡å¤ resume å¯¼è‡´ crash</h2>
<pre><code class="hljs language-lua" lang="lua">source.<span class="hljs-built_in">resume</span>()
source.<span class="hljs-built_in">resume</span>() // âš ï¸ å†æ¬¡ <span class="hljs-built_in">resume</span> ä¼š crash
</code></pre>
<ul>
<li>
<p><strong>å‘</strong>ï¼šDispatchSource åªèƒ½ resume ä¸€æ¬¡</p>
</li>
<li>
<p><strong>åŸå› </strong>ï¼šresume ç”¨æ¥å¯åŠ¨äº‹ä»¶æºï¼Œé‡å¤è°ƒç”¨ä¼šè§¦å‘å¼‚å¸¸</p>
</li>
<li>
<p><strong>è§£å†³</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨æ ‡å¿—ä½åˆ¤æ–­æ˜¯å¦å·² resume</li>
<li>æˆ–é€šè¿‡ç±»å±æ€§å°è£…ç®¡ç†çŠ¶æ€</li>
</ul>
</li>
</ul>
<hr/>
<h2 data-id="heading-4">5ï¸âƒ£ ä½¿ç”¨ sync è§¦å‘æ­»é”</h2>
<pre><code class="hljs language-arduino" lang="arduino">let queue = <span class="hljs-built_in">DispatchQueue</span>(label: <span class="hljs-string">"serial"</span>)
let source = DispatchSource.<span class="hljs-built_in">makeTimerSource</span>(queue: queue)
source.setEventHandler {
    queue.sync { <span class="hljs-built_in">print</span>(<span class="hljs-string">"Deadlock"</span>) } <span class="hljs-comment">// âš ï¸ æ­»é”</span>
}
source.<span class="hljs-built_in">resume</span>()
</code></pre>
<ul>
<li><strong>å‘</strong>ï¼šäº‹ä»¶ block å†…è°ƒç”¨ <strong>sync</strong> é˜Ÿåˆ—åŒé˜Ÿåˆ— â†’ æ­»é”</li>
<li><strong>åŸå› </strong>ï¼šä¸²è¡Œé˜Ÿåˆ—åŒæ­¥è°ƒç”¨è‡ªå·±ä¼šç­‰å¾… â†’ æ°¸è¿œæ— æ³•å®Œæˆ</li>
<li><strong>è§£å†³</strong>ï¼šä½¿ç”¨ async è°ƒåº¦ï¼Œæˆ–è€…å°†äº‹ä»¶ block æ”¾åˆ°ä¸åŒé˜Ÿåˆ—</li>
</ul>
<hr/>
<h2 data-id="heading-5">6ï¸âƒ£ å¿˜è®° cancel</h2>
<ul>
<li><strong>å‘</strong>ï¼šDispatchSource ç”¨å®Œä¸å–æ¶ˆ</li>
<li><strong>åŸå› </strong>ï¼šDispatchSource ä¼šä¿æŒé˜Ÿåˆ—å¼•ç”¨ï¼Œæœª cancel å¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼</li>
<li><strong>è§£å†³</strong>ï¼š</li>
</ul>
<pre><code class="hljs language-scss" lang="scss">source<span class="hljs-selector-class">.cancel</span>()
source<span class="hljs-selector-class">.setEventHandler</span>(nil) <span class="hljs-comment">// é‡Šæ”¾é—­åŒ…å¼•ç”¨</span>
</code></pre>
<hr/>
<h2 data-id="heading-6">7ï¸âƒ£ å¯¹å®šæ—¶å™¨è¯¯ç”¨ <code>resume/suspend</code></h2>
<ul>
<li>
<p><strong>å‘</strong>ï¼šè¯¯è®¤ä¸º suspend/resume å¯ä»¥æ— é™æš‚åœå®šæ—¶å™¨</p>
</li>
<li>
<p><strong>æ³¨æ„</strong>ï¼š</p>
<ul>
<li>DispatchSourceTimer åˆå§‹ä¸ºæš‚åœçŠ¶æ€ â†’ å¿…é¡» resume å¯åŠ¨</li>
<li>suspend/resume å¿…é¡»æˆå¯¹ä½¿ç”¨ï¼Œå¦åˆ™ä¸‹ä¸€æ¬¡ resume ä¼š crash</li>
</ul>
</li>
</ul>
<hr/>
<h2 data-id="heading-7">8ï¸âƒ£ é˜Ÿåˆ—é€‰æ‹©ä¸å½“</h2>
<ul>
<li>
<p><strong>å‘</strong>ï¼šå°† DispatchSource ç»‘å®šåˆ°ä¸»é˜Ÿåˆ—æˆ–ä¸²è¡Œé˜Ÿåˆ—ï¼Œä½†äº‹ä»¶é‡å¤§</p>
</li>
<li>
<p><strong>åæœ</strong>ï¼š</p>
<ul>
<li>é˜»å¡ä¸»çº¿ç¨‹ â†’ UI å¡é¡¿</li>
<li>ä¸²è¡Œé˜Ÿåˆ—ä¸Šé«˜é¢‘äº‹ä»¶ â†’ é˜Ÿåˆ—ç§¯å‹</li>
</ul>
</li>
<li>
<p><strong>è§£å†³</strong>ï¼š</p>
<ul>
<li>é«˜é¢‘äº‹ä»¶ä½¿ç”¨åå°å¹¶å‘é˜Ÿåˆ—</li>
<li>æ ¹æ®åœºæ™¯åˆç†é€‰æ‹©é˜Ÿåˆ—ç±»å‹</li>
</ul>
</li>
</ul>
<hr/>
<h2 data-id="heading-8">âœ… æ€»ç»“å¸¸è§å‘åŠè§£å†³ç­–ç•¥</h2>









































<table><thead><tr><th>å‘</th><th>è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>å¿˜è®° resume</td><td>å¿…é¡»è°ƒç”¨ resume() å¯åŠ¨äº‹ä»¶æº</td></tr><tr><td>DispatchSource è¢«é‡Šæ”¾</td><td>ä¿æŒå¼ºå¼•ç”¨ï¼ˆç±»å±æ€§ï¼‰</td></tr><tr><td>çº¿ç¨‹å®‰å…¨è¯¯åŒº</td><td>å¹¶å‘é˜Ÿåˆ—è®¿é—®å…±äº«èµ„æºåŠ é”ï¼Œæˆ–ä½¿ç”¨ä¸²è¡Œé˜Ÿåˆ—</td></tr><tr><td>é‡å¤ resume å¯¼è‡´ crash</td><td>åª resume ä¸€æ¬¡ï¼Œä½¿ç”¨æ ‡å¿—ä½</td></tr><tr><td>sync å¯¼è‡´æ­»é”</td><td>é¿å…åœ¨äº‹ä»¶ block å†…å¯¹åŒé˜Ÿåˆ— syncï¼Œä½¿ç”¨ async</td></tr><tr><td>å¿˜è®° cancel</td><td>ä½¿ç”¨å®Œæ¯•å cancelï¼Œå¹¶é‡Šæ”¾äº‹ä»¶å¤„ç†å™¨é—­åŒ…</td></tr><tr><td>suspend/resume ä¸æˆå¯¹</td><td>ä¸¥æ ¼æˆå¯¹è°ƒç”¨ï¼Œç¡®ä¿é˜Ÿåˆ—çŠ¶æ€æ­£ç¡®</td></tr><tr><td>é˜Ÿåˆ—é€‰æ‹©ä¸å½“</td><td>é«˜é¢‘äº‹ä»¶ç”¨åå°å¹¶å‘é˜Ÿåˆ—ï¼ŒUI äº‹ä»¶ç”¨ä¸»é˜Ÿåˆ—</td></tr></tbody></table>
<hr/>
<p>ğŸ’¡ <strong>æ ¸å¿ƒç»éªŒ</strong>ï¼š</p>
<ol>
<li>DispatchSource æœ¬è´¨æ˜¯ <strong>äº‹ä»¶æº + GCD block</strong> â†’ é¿å…ç›´æ¥å¯¹çº¿ç¨‹æˆ–é˜Ÿåˆ—åš unsafe æ“ä½œ</li>
<li>æ‰€æœ‰äº‹ä»¶å¤„ç† block éƒ½éµå¾ªç»‘å®šé˜Ÿåˆ—è°ƒåº¦ â†’ ç†è§£ä¸²è¡Œ/å¹¶å‘å¯¹å…±äº«èµ„æºçš„å½±å“</li>
<li>å¼ºå¼•ç”¨ + resume + cancel æ˜¯ç”Ÿå‘½å‘¨æœŸç®¡ç†ä¸‰éƒ¨æ›²</li>
</ol>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[1-24.ã€GCDã€‘QoS å’Œçº¿ç¨‹ä¼˜å…ˆçº§æ˜¯ 1:1 æ˜ å°„çš„å—ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7599868109086851114</link>    <guid>https://juejin.cn/post/7599868109086851114</guid>    <pubDate>2026-01-28T03:27:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599868109086851114" data-draft-id="7599933828543889471" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="1-24.ã€GCDã€‘QoS å’Œçº¿ç¨‹ä¼˜å…ˆçº§æ˜¯ 1:1 æ˜ å°„çš„å—ï¼Ÿ"/> <meta itemprop="keywords" content="Swift"/> <meta itemprop="datePublished" content="2026-01-28T03:27:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¡¹é˜¿ä¸‘"/> <meta itemprop="url" content="https://juejin.cn/user/1407852323023447"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            1-24.ã€GCDã€‘QoS å’Œçº¿ç¨‹ä¼˜å…ˆçº§æ˜¯ 1:1 æ˜ å°„çš„å—ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1407852323023447/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¡¹é˜¿ä¸‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T03:27:44.000Z" title="Wed Jan 28 2026 03:27:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>QoS å’Œçº¿ç¨‹ä¼˜å…ˆçº§å¹¶ä¸æ˜¯ 1:1 æ˜ å°„</strong>ï¼Œå®ƒä»¬åªæ˜¯ç›¸å…³ï¼Œä½†æœºåˆ¶ä¸Šå­˜åœ¨å·®åˆ«ã€‚ä¸‹é¢è¯¦ç»†è§£é‡Šï¼š</p>
<hr/>
<h2 data-id="heading-0">1ï¸âƒ£ æ ¸å¿ƒç»“è®º</h2>
<blockquote>
<p><strong>QoS æ˜¯ GCD çš„ä»»åŠ¡çº§åˆ«ä¼˜å…ˆç­–ç•¥ï¼Œç”¨äºæŒ‡å¯¼ç³»ç»Ÿè°ƒåº¦ä»»åŠ¡å’Œçº¿ç¨‹èµ„æºï¼›çº¿ç¨‹ä¼˜å…ˆçº§ï¼ˆpthread / schedï¼‰æ˜¯æ“ä½œç³»ç»Ÿå±‚é¢çº¿ç¨‹è°ƒåº¦æƒé‡ã€‚äºŒè€…å…³è”ï¼Œä½†å¹¶éä¸¥æ ¼ä¸€ä¸€å¯¹åº”ã€‚</strong></p>
</blockquote>
<p>æ¢å¥è¯è¯´ï¼š</p>
<ul>
<li>QoS â†’ å‘Šè¯‰ç³»ç»Ÿâ€œä»»åŠ¡é‡è¦æ€§â€ï¼ŒGCD æ ¹æ®è¿™ä¸ªåœ¨å…¨å±€çº¿ç¨‹æ± ä¸­é€‰æ‹©æˆ–åˆ›å»ºçº¿ç¨‹</li>
<li>çº¿ç¨‹ä¼˜å…ˆçº§ â†’ æ§åˆ¶ CPU æ—¶é—´åˆ†é…</li>
<li>é«˜ QoS <strong>é€šå¸¸</strong>å¯¹åº”è¾ƒé«˜çº¿ç¨‹ä¼˜å…ˆçº§ï¼Œä½†ä¸æ˜¯ç»å¯¹ï¼Œä¹Ÿä¼šå—åˆ°ç³»ç»Ÿè°ƒåº¦å’Œèƒ½è€—ä¼˜åŒ–å½±å“</li>
</ul>
<hr/>
<h2 data-id="heading-1">2ï¸âƒ£ å…³è”æœºåˆ¶</h2>
<h3 data-id="heading-2">2.1 ä»»åŠ¡åˆ°çº¿ç¨‹çš„æ˜ å°„</h3>
<p>å½“ä½ æäº¤ä¸€ä¸ªä»»åŠ¡åˆ°é˜Ÿåˆ—ï¼š</p>
<ol>
<li>
<p><strong>GCD æŸ¥çœ‹ä»»åŠ¡ QoS</strong></p>
</li>
<li>
<p><strong>é€‰æ‹©æˆ–åˆ›å»ºåˆé€‚çº¿ç¨‹</strong>ï¼š</p>
<ul>
<li>é«˜ QoS â†’ å°è¯•åœ¨é«˜ä¼˜å…ˆçº§çº¿ç¨‹æˆ–æ›´å¤šçº¿ç¨‹ä¸Šæ‰§è¡Œ</li>
<li>ä½ QoS â†’ ä½¿ç”¨ä½ä¼˜å…ˆçº§çº¿ç¨‹æ± æˆ–å»¶è¿Ÿæ‰§è¡Œ</li>
</ul>
</li>
<li>
<p><strong>çº¿ç¨‹å¯èƒ½å…±äº«</strong>ï¼š</p>
<ul>
<li>åŒä¸€çº¿ç¨‹å¯ä»¥æ‰§è¡Œä¸åŒ QoS ä»»åŠ¡</li>
<li>ç³»ç»Ÿä¼šåŠ¨æ€è°ƒæ•´çº¿ç¨‹ä¼˜å…ˆçº§ä»¥åŒ¹é…ä»»åŠ¡ QoS</li>
</ul>
</li>
</ol>
<blockquote>
<p>âš ï¸ æ‰€ä»¥ä¸€ä¸ªçº¿ç¨‹ä¸Šå¯èƒ½äº¤æ›¿æ‰§è¡Œä¸åŒ QoS çš„ä»»åŠ¡ï¼Œçº¿ç¨‹ä¼˜å…ˆçº§ä¼šåŠ¨æ€è°ƒæ•´ï¼Œå¹¶éå›ºå®š 1:1</p>
</blockquote>
<hr/>
<h3 data-id="heading-3">2.2 ç³»ç»ŸåŠ¨æ€è°ƒèŠ‚</h3>
<ul>
<li>
<p>macOS/iOS å†…æ ¸ä¼šç»¼åˆè€ƒè™‘ï¼š</p>
<ul>
<li>å½“å‰ CPU åˆ©ç”¨ç‡</li>
<li>èƒ½è€—å’Œç”µé‡ç­–ç•¥</li>
<li>å¤šä»»åŠ¡è°ƒåº¦å…¬å¹³æ€§</li>
</ul>
</li>
<li>
<p>å› æ­¤ï¼š</p>
<ul>
<li>é«˜ QoS ä»»åŠ¡ä¸ä¸€å®šå§‹ç»ˆåœ¨æœ€é«˜ä¼˜å…ˆçº§çº¿ç¨‹ä¸Šæ‰§è¡Œ</li>
<li>ä½ QoS ä»»åŠ¡å¯èƒ½åœ¨ç©ºé—²çº¿ç¨‹ä¸ŠæŠ¢å  CPU</li>
</ul>
</li>
</ul>
<hr/>
<h2 data-id="heading-4">3ï¸âƒ£ ä¸ pthread ä¼˜å…ˆçº§çš„åŒºåˆ«</h2>



































<table><thead><tr><th>ç‰¹æ€§</th><th>QoS (GCD)</th><th>çº¿ç¨‹ä¼˜å…ˆçº§ (pthread / sched)</th></tr></thead><tbody><tr><td>ç²’åº¦</td><td>ä»»åŠ¡çº§åˆ«</td><td>çº¿ç¨‹çº§åˆ«</td></tr><tr><td>ä½œç”¨</td><td>æŒ‡å¯¼ç³»ç»Ÿè°ƒåº¦ä»»åŠ¡å’Œçº¿ç¨‹åˆ†é…</td><td>å†³å®šçº¿ç¨‹åœ¨ CPU ä¸Šè°ƒåº¦æƒé‡</td></tr><tr><td>çº¿ç¨‹ç»‘å®š</td><td>ä»»åŠ¡å¯èƒ½åœ¨ä»»ä½•çº¿ç¨‹ä¸Šæ‰§è¡Œ</td><td>å›ºå®šçº¿ç¨‹è°ƒåº¦æƒé‡</td></tr><tr><td>åŠ¨æ€æ€§</td><td>GCD å¯åŠ¨æ€æå‡/ç»§æ‰¿ QoS</td><td>é€šå¸¸å›ºå®šï¼Œé™¤éæ‰‹åŠ¨ä¿®æ”¹</td></tr><tr><td>å¯¹èƒ½è€—å½±å“</td><td>é«˜ QoS â†’ å¯èƒ½æ›´æ¿€è¿›åˆ†é… CPU</td><td>æ— ç›´æ¥èƒ½è€—ä¼˜åŒ–æœºåˆ¶</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-5">4ï¸âƒ£ QoS ä¼˜å…ˆçº§ä¸çº¿ç¨‹ä¼˜å…ˆçº§å…³ç³»</h2>
<p>GCD æ–‡æ¡£è¯´æ˜ï¼š</p>
<ul>
<li><code>.userInteractive</code> / <code>.userInitiated</code> â†’ é«˜ QoS â†’ ç³»ç»Ÿä¼šå°½é‡åœ¨é«˜ä¼˜å…ˆçº§çº¿ç¨‹æˆ–æ›´å¤šçº¿ç¨‹æ‰§è¡Œ</li>
<li><code>.utility</code> / <code>.background</code> â†’ ä½ QoS â†’ ç³»ç»Ÿå¯èƒ½å»¶è¿Ÿæ‰§è¡Œæˆ–é™ä½çº¿ç¨‹ CPU ä¼˜å…ˆçº§</li>
<li>çº¿ç¨‹ä¼˜å…ˆçº§åªæ˜¯ <strong>ä¸€ä¸ªè°ƒåº¦å‚è€ƒ</strong>ï¼Œå®é™…è°ƒåº¦ä¼šåŠ¨æ€è°ƒæ•´</li>
</ul>
<p>âœ… æ ¸å¿ƒï¼š<strong>é«˜ QoS æ›´å¯èƒ½è·å¾—é«˜çº¿ç¨‹ä¼˜å…ˆçº§ï¼Œä½†ä¸æ˜¯ä¸€æ¡ä»»åŠ¡å¯¹åº”ä¸€æ¡çº¿ç¨‹çš„å›ºå®šå…³ç³»</strong></p>
<hr/>
<h2 data-id="heading-6">5ï¸âƒ£ æ€»ç»“ä¸€å¥è¯</h2>
<blockquote>
<p><strong>QoS å½±å“ GCD å¦‚ä½•é€‰æ‹©çº¿ç¨‹å’Œè°ƒåº¦ä»»åŠ¡ï¼Œä½†ä¸æ˜¯ 1:1 æ˜ å°„åˆ°çº¿ç¨‹ä¼˜å…ˆçº§ï¼›çº¿ç¨‹ä¼˜å…ˆçº§åªæ˜¯ç³»ç»Ÿå±‚é¢çš„è°ƒåº¦æƒé‡ï¼ŒGCD ä¼šåŠ¨æ€è°ƒæ•´çº¿ç¨‹ä»¥åŒ¹é…ä»»åŠ¡ QoSã€‚</strong></p>
</blockquote>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å®Œæ•´çš„ç™½å±æ£€æµ‹ SDK]]></title>    <link>https://juejin.cn/post/7599933828544036927</link>    <guid>https://juejin.cn/post/7599933828544036927</guid>    <pubDate>2026-01-28T03:32:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599933828544036927" data-draft-id="7599983917664108587" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å®Œæ•´çš„ç™½å±æ£€æµ‹ SDK "/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-28T03:32:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°å°å°å°å®‡"/> <meta itemprop="url" content="https://juejin.cn/user/3386151546662077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å®Œæ•´çš„ç™½å±æ£€æµ‹ SDK 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3386151546662077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°å°å°å°å®‡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T03:32:54.000Z" title="Wed Jan 28 2026 03:32:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»17åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰ç«¯ç™½å±æ£€æµ‹å®Œæ•´æ–¹æ¡ˆ</h2>
<p>ç™½å±æ£€æµ‹æ˜¯å‰ç«¯ç›‘æ§ä½“ç³»ä¸­éå¸¸é‡è¦çš„ä¸€ç¯ï¼Œç”¨äºæ£€æµ‹é¡µé¢æ˜¯å¦æ­£å¸¸æ¸²æŸ“ï¼ŒåŠæ—¶å‘ç°å¹¶ä¸ŠæŠ¥ç™½å±å¼‚å¸¸ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€ç™½å±æ£€æµ‹çš„æ ¸å¿ƒåŸç†</h3>
<p>ç™½å±æ£€æµ‹ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§å®ç°æ€è·¯ï¼š</p>
<ol>
<li><strong>é‡‡æ ·ç‚¹æ£€æµ‹æ³•</strong> - åœ¨é¡µé¢å…³é”®ä½ç½®é‡‡æ ·ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰æœ‰æ•ˆå†…å®¹</li>
<li><strong>DOM å…ƒç´ æ£€æµ‹æ³•</strong> - æ£€æµ‹é¡µé¢å…³é”® DOM å…ƒç´ æ˜¯å¦å­˜åœ¨</li>
<li><strong>MutationObserver ç›‘å¬æ³•</strong> - ç›‘å¬ DOM å˜åŒ–åˆ¤æ–­é¡µé¢æ¸²æŸ“çŠ¶æ€</li>
<li><strong>éª¨æ¶å±æ£€æµ‹æ³•</strong> - æ£€æµ‹éª¨æ¶å±æ˜¯å¦è¢«æ›¿æ¢ä¸ºå®é™…å†…å®¹</li>
<li><strong>æˆªå›¾å¯¹æ¯”æ³•</strong> - é€šè¿‡ Canvas æˆªå›¾åˆ†æé¡µé¢å†…å®¹</li>
<li><strong>Performance API æ£€æµ‹æ³•</strong> - åˆ©ç”¨æµè§ˆå™¨æ€§èƒ½ API åˆ¤æ–­æ¸²æŸ“çŠ¶æ€</li>
</ol>
<h3 data-id="heading-2">äºŒã€å®Œæ•´çš„ç™½å±æ£€æµ‹ SDK å®ç°</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ==================== ç±»å‹å®šä¹‰ ====================</span>

<span class="hljs-comment">/**
 * ç™½å±æ£€æµ‹é…ç½®æ¥å£
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">WhiteScreenConfig</span> {
  <span class="hljs-comment">// é‡‡æ ·ç‚¹æ•°é‡ï¼ˆæ°´å¹³å’Œå‚ç›´æ–¹å‘ï¼‰</span>
  samplingPoints?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// æ£€æµ‹å»¶è¿Ÿæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span>
  delay?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// æ£€æµ‹è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span>
  timeout?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// ç™½å±é˜ˆå€¼ï¼ˆ0-1ä¹‹é—´ï¼Œè¶…è¿‡è¯¥æ¯”ä¾‹è®¤ä¸ºæ˜¯ç™½å±ï¼‰</span>
  threshold?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// æ˜¯å¦å¯ç”¨ DOM æ£€æµ‹</span>
  enableDOMDetection?: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// æ˜¯å¦å¯ç”¨é‡‡æ ·ç‚¹æ£€æµ‹</span>
  enableSamplingDetection?: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// æ˜¯å¦å¯ç”¨ MutationObserver æ£€æµ‹</span>
  enableMutationDetection?: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// æ˜¯å¦å¯ç”¨æˆªå›¾æ£€æµ‹</span>
  enableScreenshotDetection?: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// æ˜¯å¦å¯ç”¨éª¨æ¶å±æ£€æµ‹</span>
  enableSkeletonDetection?: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// éª¨æ¶å±å®¹å™¨é€‰æ‹©å™¨</span>
  skeletonSelector?: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">// å…³é”®å…ƒç´ é€‰æ‹©å™¨åˆ—è¡¨</span>
  keyElementSelectors?: <span class="hljs-built_in">string</span>[];
  <span class="hljs-comment">// éœ€è¦å¿½ç•¥çš„å…ƒç´ é€‰æ‹©å™¨</span>
  ignoreSelectors?: <span class="hljs-built_in">string</span>[];
  <span class="hljs-comment">// å®¹å™¨å…ƒç´ ï¼ˆé»˜è®¤ä¸º document.bodyï¼‰</span>
  container?: <span class="hljs-title class_">HTMLElement</span> | <span class="hljs-literal">null</span>;
  <span class="hljs-comment">// ä¸ŠæŠ¥å›è°ƒå‡½æ•°</span>
  onReport?: <span class="hljs-function">(<span class="hljs-params">data: WhiteScreenReport</span>) =&gt;</span> <span class="hljs-built_in">void</span>;
  <span class="hljs-comment">// æ£€æµ‹å®Œæˆå›è°ƒ</span>
  onDetectionComplete?: <span class="hljs-function">(<span class="hljs-params">result: DetectionResult</span>) =&gt;</span> <span class="hljs-built_in">void</span>;
  <span class="hljs-comment">// æ˜¯å¦åœ¨å¼€å‘ç¯å¢ƒå¯ç”¨</span>
  enableInDev?: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// æœ€å¤§é‡è¯•æ¬¡æ•°</span>
  maxRetries?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// é‡è¯•é—´éš”ï¼ˆæ¯«ç§’ï¼‰</span>
  retryInterval?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// è‡ªå®šä¹‰ç™½å±åˆ¤æ–­å‡½æ•°</span>
  customDetector?: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">boolean</span> | <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt;;
}

<span class="hljs-comment">/**
 * ç™½å±æ£€æµ‹æŠ¥å‘Šæ¥å£
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">WhiteScreenReport</span> {
  <span class="hljs-comment">// æ˜¯å¦ç™½å±</span>
  <span class="hljs-attr">isWhiteScreen</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// æ£€æµ‹æ—¶é—´æˆ³</span>
  <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// é¡µé¢ URL</span>
  <span class="hljs-attr">url</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">// æ£€æµ‹æ–¹æ³•</span>
  <span class="hljs-attr">detectionMethod</span>: <span class="hljs-title class_">DetectionMethod</span>;
  <span class="hljs-comment">// é‡‡æ ·ç‚¹ç»“æœ</span>
  samplingResult?: <span class="hljs-title class_">SamplingResult</span>;
  <span class="hljs-comment">// DOM æ£€æµ‹ç»“æœ</span>
  domResult?: <span class="hljs-title class_">DOMDetectionResult</span>;
  <span class="hljs-comment">// æˆªå›¾æ£€æµ‹ç»“æœ</span>
  screenshotResult?: <span class="hljs-title class_">ScreenshotResult</span>;
  <span class="hljs-comment">// éª¨æ¶å±æ£€æµ‹ç»“æœ</span>
  skeletonResult?: <span class="hljs-title class_">SkeletonResult</span>;
  <span class="hljs-comment">// é¡µé¢æ€§èƒ½æ•°æ®</span>
  performanceData?: <span class="hljs-title class_">PerformanceData</span>;
  <span class="hljs-comment">// ç”¨æˆ·ä»£ç†ä¿¡æ¯</span>
  <span class="hljs-attr">userAgent</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">// è§†å£å°ºå¯¸</span>
  <span class="hljs-attr">viewport</span>: <span class="hljs-title class_">ViewportSize</span>;
  <span class="hljs-comment">// è®¾å¤‡åƒç´ æ¯”</span>
  <span class="hljs-attr">devicePixelRatio</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// ç½‘ç»œä¿¡æ¯</span>
  networkInfo?: <span class="hljs-title class_">NetworkInfo</span>;
  <span class="hljs-comment">// é”™è¯¯ä¿¡æ¯</span>
  errorInfo?: <span class="hljs-title class_">ErrorInfo</span>;
  <span class="hljs-comment">// è‡ªå®šä¹‰æ•°æ®</span>
  customData?: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">unknown</span>&gt;;
}

<span class="hljs-comment">/**
 * æ£€æµ‹æ–¹æ³•æšä¸¾
 */</span>
<span class="hljs-keyword">enum</span> <span class="hljs-title class_">DetectionMethod</span> {
  <span class="hljs-variable constant_">SAMPLING</span> = <span class="hljs-string">'sampling'</span>,
  <span class="hljs-variable constant_">DOM</span> = <span class="hljs-string">'dom'</span>,
  <span class="hljs-variable constant_">MUTATION</span> = <span class="hljs-string">'mutation'</span>,
  <span class="hljs-variable constant_">SCREENSHOT</span> = <span class="hljs-string">'screenshot'</span>,
  <span class="hljs-variable constant_">SKELETON</span> = <span class="hljs-string">'skeleton'</span>,
  <span class="hljs-variable constant_">PERFORMANCE</span> = <span class="hljs-string">'performance'</span>,
  <span class="hljs-variable constant_">CUSTOM</span> = <span class="hljs-string">'custom'</span>,
  <span class="hljs-variable constant_">COMBINED</span> = <span class="hljs-string">'combined'</span>
}

<span class="hljs-comment">/**
 * é‡‡æ ·ç‚¹ç»“æœæ¥å£
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">SamplingResult</span> {
  <span class="hljs-comment">// æ€»é‡‡æ ·ç‚¹æ•°</span>
  <span class="hljs-attr">totalPoints</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// ç©ºç™½ç‚¹æ•°</span>
  <span class="hljs-attr">emptyPoints</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// ç©ºç™½æ¯”ä¾‹</span>
  <span class="hljs-attr">emptyRatio</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// é‡‡æ ·ç‚¹è¯¦æƒ…</span>
  <span class="hljs-attr">pointDetails</span>: <span class="hljs-title class_">SamplingPointDetail</span>[];
}

<span class="hljs-comment">/**
 * é‡‡æ ·ç‚¹è¯¦æƒ…
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">SamplingPointDetail</span> {
  <span class="hljs-comment">// X åæ ‡</span>
  <span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// Y åæ ‡</span>
  <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// å…ƒç´ æ ‡ç­¾å</span>
  <span class="hljs-attr">tagName</span>: <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span>;
  <span class="hljs-comment">// æ˜¯å¦ä¸ºç©ºç™½ç‚¹</span>
  <span class="hljs-attr">isEmpty</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// å…ƒç´ ç±»å</span>
  className?: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">// å…ƒç´  ID</span>
  id?: <span class="hljs-built_in">string</span>;
}

<span class="hljs-comment">/**
 * DOM æ£€æµ‹ç»“æœæ¥å£
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">DOMDetectionResult</span> {
  <span class="hljs-comment">// æ˜¯å¦é€šè¿‡æ£€æµ‹</span>
  <span class="hljs-attr">passed</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// æ£€æµ‹åˆ°çš„å…³é”®å…ƒç´ æ•°é‡</span>
  <span class="hljs-attr">foundElements</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// æœŸæœ›çš„å…³é”®å…ƒç´ æ•°é‡</span>
  <span class="hljs-attr">expectedElements</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// ç¼ºå¤±çš„å…ƒç´ é€‰æ‹©å™¨</span>
  <span class="hljs-attr">missingSelectors</span>: <span class="hljs-built_in">string</span>[];
  <span class="hljs-comment">// å…ƒç´ è¯¦æƒ…</span>
  <span class="hljs-attr">elementDetails</span>: <span class="hljs-title class_">ElementDetail</span>[];
}

<span class="hljs-comment">/**
 * å…ƒç´ è¯¦æƒ…
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ElementDetail</span> {
  <span class="hljs-comment">// é€‰æ‹©å™¨</span>
  <span class="hljs-attr">selector</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">// æ˜¯å¦å­˜åœ¨</span>
  <span class="hljs-attr">exists</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// æ˜¯å¦å¯è§</span>
  isVisible?: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// å…ƒç´ å°ºå¯¸</span>
  dimensions?: {
    <span class="hljs-attr">width</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">height</span>: <span class="hljs-built_in">number</span>;
  };
}

<span class="hljs-comment">/**
 * æˆªå›¾æ£€æµ‹ç»“æœ
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ScreenshotResult</span> {
  <span class="hljs-comment">// æ˜¯å¦ç™½å±</span>
  <span class="hljs-attr">isWhiteScreen</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// ç™½è‰²åƒç´ æ¯”ä¾‹</span>
  <span class="hljs-attr">whitePixelRatio</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// æ€»åƒç´ æ•°</span>
  <span class="hljs-attr">totalPixels</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// ç™½è‰²åƒç´ æ•°</span>
  <span class="hljs-attr">whitePixels</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// é¢œè‰²åˆ†å¸ƒ</span>
  colorDistribution?: <span class="hljs-title class_">ColorDistribution</span>;
}

<span class="hljs-comment">/**
 * é¢œè‰²åˆ†å¸ƒ
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ColorDistribution</span> {
  <span class="hljs-attr">white</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">black</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">gray</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">colored</span>: <span class="hljs-built_in">number</span>;
}

<span class="hljs-comment">/**
 * éª¨æ¶å±æ£€æµ‹ç»“æœ
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">SkeletonResult</span> {
  <span class="hljs-comment">// éª¨æ¶å±æ˜¯å¦å­˜åœ¨</span>
  <span class="hljs-attr">skeletonExists</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// éª¨æ¶å±æ˜¯å¦å·²ç§»é™¤</span>
  <span class="hljs-attr">skeletonRemoved</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// æ£€æµ‹æ—¶é—´</span>
  <span class="hljs-attr">detectionTime</span>: <span class="hljs-built_in">number</span>;
}

<span class="hljs-comment">/**
 * æ€§èƒ½æ•°æ®
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">PerformanceData</span> {
  <span class="hljs-comment">// DOM åŠ è½½å®Œæˆæ—¶é—´</span>
  domContentLoaded?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// é¡µé¢å®Œå…¨åŠ è½½æ—¶é—´</span>
  loadComplete?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// é¦–æ¬¡å†…å®¹ç»˜åˆ¶æ—¶é—´</span>
  firstContentfulPaint?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// æœ€å¤§å†…å®¹ç»˜åˆ¶æ—¶é—´</span>
  largestContentfulPaint?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ</span>
  firstInputDelay?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// ç´¯è®¡å¸ƒå±€åç§»</span>
  cumulativeLayoutShift?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// å¯äº¤äº’æ—¶é—´</span>
  timeToInteractive?: <span class="hljs-built_in">number</span>;
}

<span class="hljs-comment">/**
 * è§†å£å°ºå¯¸
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ViewportSize</span> {
  <span class="hljs-attr">width</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">height</span>: <span class="hljs-built_in">number</span>;
}

<span class="hljs-comment">/**
 * ç½‘ç»œä¿¡æ¯
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">NetworkInfo</span> {
  <span class="hljs-comment">// ç½‘ç»œç±»å‹</span>
  effectiveType?: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">// ä¸‹è¡Œå¸¦å®½</span>
  downlink?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// RTT</span>
  rtt?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// æ˜¯å¦åœ¨çº¿</span>
  <span class="hljs-attr">online</span>: <span class="hljs-built_in">boolean</span>;
}

<span class="hljs-comment">/**
 * é”™è¯¯ä¿¡æ¯
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ErrorInfo</span> {
  <span class="hljs-comment">// é”™è¯¯æ¶ˆæ¯</span>
  <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">// é”™è¯¯å †æ ˆ</span>
  stack?: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">// é”™è¯¯ç±»å‹</span>
  <span class="hljs-attr">type</span>: <span class="hljs-built_in">string</span>;
}

<span class="hljs-comment">/**
 * æ£€æµ‹ç»“æœ
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">DetectionResult</span> {
  <span class="hljs-comment">// æ˜¯å¦ç™½å±</span>
  <span class="hljs-attr">isWhiteScreen</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// ç½®ä¿¡åº¦ï¼ˆ0-1ï¼‰</span>
  <span class="hljs-attr">confidence</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// æ£€æµ‹æ–¹æ³•</span>
  <span class="hljs-attr">methods</span>: <span class="hljs-title class_">DetectionMethod</span>[];
  <span class="hljs-comment">// å„æ–¹æ³•ç»“æœ</span>
  <span class="hljs-attr">methodResults</span>: <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">DetectionMethod</span>, <span class="hljs-built_in">boolean</span>&gt;;
  <span class="hljs-comment">// æœ€ç»ˆåˆ¤å®šä¾æ®</span>
  <span class="hljs-attr">basis</span>: <span class="hljs-built_in">string</span>;
}

<span class="hljs-comment">// ==================== å·¥å…·å‡½æ•° ====================</span>

<span class="hljs-comment">/**
 * é˜²æŠ–å‡½æ•°
 */</span>
<span class="hljs-keyword">function</span> debounce&lt;T <span class="hljs-keyword">extends</span> (...<span class="hljs-attr">args</span>: <span class="hljs-built_in">unknown</span>[]) =&gt; <span class="hljs-built_in">unknown</span>&gt;(
  <span class="hljs-attr">func</span>: T,
  <span class="hljs-attr">wait</span>: <span class="hljs-built_in">number</span>
): <span class="hljs-function">(<span class="hljs-params">...args: Parameters&lt;T&gt;</span>) =&gt;</span> <span class="hljs-built_in">void</span> {
  <span class="hljs-keyword">let</span> <span class="hljs-attr">timeoutId</span>: <span class="hljs-title class_">ReturnType</span>&lt;<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">setTimeout</span>&gt; | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-variable language_">this</span>: <span class="hljs-built_in">unknown</span>, ...args: Parameters&lt;T&gt;</span>) {
    <span class="hljs-keyword">if</span> (timeoutId !== <span class="hljs-literal">null</span>) {
      <span class="hljs-built_in">clearTimeout</span>(timeoutId);
    }
    
    timeoutId = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      func.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
      timeoutId = <span class="hljs-literal">null</span>;
    }, wait);
  };
}

<span class="hljs-comment">/**
 * èŠ‚æµå‡½æ•°
 */</span>
<span class="hljs-keyword">function</span> throttle&lt;T <span class="hljs-keyword">extends</span> (...<span class="hljs-attr">args</span>: <span class="hljs-built_in">unknown</span>[]) =&gt; <span class="hljs-built_in">unknown</span>&gt;(
  <span class="hljs-attr">func</span>: T,
  <span class="hljs-attr">limit</span>: <span class="hljs-built_in">number</span>
): <span class="hljs-function">(<span class="hljs-params">...args: Parameters&lt;T&gt;</span>) =&gt;</span> <span class="hljs-built_in">void</span> {
  <span class="hljs-keyword">let</span> inThrottle = <span class="hljs-literal">false</span>;
  
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-variable language_">this</span>: <span class="hljs-built_in">unknown</span>, ...args: Parameters&lt;T&gt;</span>) {
    <span class="hljs-keyword">if</span> (!inThrottle) {
      func.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
      inThrottle = <span class="hljs-literal">true</span>;
      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        inThrottle = <span class="hljs-literal">false</span>;
      }, limit);
    }
  };
}

<span class="hljs-comment">/**
 * å»¶è¿Ÿæ‰§è¡Œ
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">delay</span>(<span class="hljs-params">ms: <span class="hljs-built_in">number</span></span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, ms));
}

<span class="hljs-comment">/**
 * å¸¦è¶…æ—¶çš„ Promise
 */</span>
<span class="hljs-keyword">function</span> withTimeout&lt;T&gt;(
  <span class="hljs-attr">promise</span>: <span class="hljs-title class_">Promise</span>&lt;T&gt;,
  <span class="hljs-attr">ms</span>: <span class="hljs-built_in">number</span>,
  errorMessage = <span class="hljs-string">'Operation timed out'</span>
): <span class="hljs-title class_">Promise</span>&lt;T&gt; {
  <span class="hljs-keyword">const</span> timeout = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">never</span>&gt;(<span class="hljs-function">(<span class="hljs-params">_, reject</span>) =&gt;</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(errorMessage)), ms);
  });
  
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">race</span>([promise, timeout]);
}

<span class="hljs-comment">/**
 * é‡è¯•å‡½æ•°
 */</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> retry&lt;T&gt;(
  <span class="hljs-attr">fn</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Promise</span>&lt;T&gt;,
  <span class="hljs-attr">maxRetries</span>: <span class="hljs-built_in">number</span>,
  <span class="hljs-attr">retryInterval</span>: <span class="hljs-built_in">number</span>
): <span class="hljs-title class_">Promise</span>&lt;T&gt; {
  <span class="hljs-keyword">let</span> <span class="hljs-attr">lastError</span>: <span class="hljs-title class_">Error</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; maxRetries; i++) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-title function_">fn</span>();
    } <span class="hljs-keyword">catch</span> (error) {
      lastError = error <span class="hljs-keyword">as</span> <span class="hljs-title class_">Error</span>;
      <span class="hljs-keyword">if</span> (i &lt; maxRetries - <span class="hljs-number">1</span>) {
        <span class="hljs-keyword">await</span> <span class="hljs-title function_">delay</span>(retryInterval);
      }
    }
  }
  
  <span class="hljs-keyword">throw</span> lastError;
}

<span class="hljs-comment">/**
 * ç”Ÿæˆå”¯ä¸€ ID
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">generateUniqueId</span>(<span class="hljs-params"/>): <span class="hljs-built_in">string</span> {
  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>-<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random().toString(<span class="hljs-number">36</span>).substr(<span class="hljs-number">2</span>, <span class="hljs-number">9</span>)}</span>`</span>;
}

<span class="hljs-comment">/**
 * æ·±åº¦åˆå¹¶å¯¹è±¡
 */</span>
<span class="hljs-keyword">function</span> deepMerge&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">unknown</span>&gt;&gt;(
  <span class="hljs-attr">target</span>: T,
  <span class="hljs-attr">source</span>: <span class="hljs-title class_">Partial</span>&lt;T&gt;
): T {
  <span class="hljs-keyword">const</span> result = { ...target };
  
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> source) {
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">hasOwnProperty</span>.<span class="hljs-title function_">call</span>(source, key)) {
      <span class="hljs-keyword">const</span> sourceValue = source[key];
      <span class="hljs-keyword">const</span> targetValue = result[key];
      
      <span class="hljs-keyword">if</span> (
        <span class="hljs-keyword">typeof</span> sourceValue === <span class="hljs-string">'object'</span> &amp;&amp;
        sourceValue !== <span class="hljs-literal">null</span> &amp;&amp;
        !<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(sourceValue) &amp;&amp;
        <span class="hljs-keyword">typeof</span> targetValue === <span class="hljs-string">'object'</span> &amp;&amp;
        targetValue !== <span class="hljs-literal">null</span> &amp;&amp;
        !<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(targetValue)
      ) {
        result[key] = <span class="hljs-title function_">deepMerge</span>(
          targetValue <span class="hljs-keyword">as</span> <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">unknown</span>&gt;,
          sourceValue <span class="hljs-keyword">as</span> <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">unknown</span>&gt;
        ) <span class="hljs-keyword">as</span> T[<span class="hljs-title class_">Extract</span>&lt;keyof T, <span class="hljs-built_in">string</span>&gt;];
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sourceValue !== <span class="hljs-literal">undefined</span>) {
        result[key] = sourceValue <span class="hljs-keyword">as</span> T[<span class="hljs-title class_">Extract</span>&lt;keyof T, <span class="hljs-built_in">string</span>&gt;];
      }
    }
  }
  
  <span class="hljs-keyword">return</span> result;
}

<span class="hljs-comment">/**
 * æ£€æŸ¥å…ƒç´ æ˜¯å¦å¯è§
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">isElementVisible</span>(<span class="hljs-params">element: Element</span>): <span class="hljs-built_in">boolean</span> {
  <span class="hljs-keyword">if</span> (!element) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  
  <span class="hljs-keyword">const</span> style = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getComputedStyle</span>(element);
  
  <span class="hljs-keyword">if</span> (style.<span class="hljs-property">display</span> === <span class="hljs-string">'none'</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">if</span> (style.<span class="hljs-property">visibility</span> === <span class="hljs-string">'hidden'</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">if</span> (style.<span class="hljs-property">opacity</span> === <span class="hljs-string">'0'</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  
  <span class="hljs-keyword">const</span> rect = element.<span class="hljs-title function_">getBoundingClientRect</span>();
  <span class="hljs-keyword">if</span> (rect.<span class="hljs-property">width</span> === <span class="hljs-number">0</span> || rect.<span class="hljs-property">height</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-comment">/**
 * è·å–å…ƒç´ åœ¨æŒ‡å®šåæ ‡å¤„
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getElementAtPoint</span>(<span class="hljs-params">x: <span class="hljs-built_in">number</span>, y: <span class="hljs-built_in">number</span></span>): <span class="hljs-title class_">Element</span> | <span class="hljs-literal">null</span> {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">elementFromPoint</span>(x, y);
  } <span class="hljs-keyword">catch</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }
}

<span class="hljs-comment">/**
 * åˆ¤æ–­æ˜¯å¦ä¸ºåŒ…è£…å…ƒç´ ï¼ˆé€šå¸¸ç”¨äºå¸ƒå±€çš„ç©ºå…ƒç´ ï¼‰
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">isWrapperElement</span>(<span class="hljs-params">element: Element | <span class="hljs-literal">null</span></span>): <span class="hljs-built_in">boolean</span> {
  <span class="hljs-keyword">if</span> (!element) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  
  <span class="hljs-keyword">const</span> wrapperTags = [
    <span class="hljs-string">'HTML'</span>, <span class="hljs-string">'BODY'</span>, <span class="hljs-string">'DIV'</span>, <span class="hljs-string">'SECTION'</span>, <span class="hljs-string">'ARTICLE'</span>, <span class="hljs-string">'MAIN'</span>,
    <span class="hljs-string">'HEADER'</span>, <span class="hljs-string">'FOOTER'</span>, <span class="hljs-string">'NAV'</span>, <span class="hljs-string">'ASIDE'</span>, <span class="hljs-string">'SPAN'</span>
  ];
  
  <span class="hljs-keyword">const</span> tagName = element.<span class="hljs-property">tagName</span>.<span class="hljs-title function_">toUpperCase</span>();
  
  <span class="hljs-keyword">if</span> (!wrapperTags.<span class="hljs-title function_">includes</span>(tagName)) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }
  
  <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰å®é™…å†…å®¹</span>
  <span class="hljs-keyword">const</span> hasText = element.<span class="hljs-property">textContent</span>?.<span class="hljs-title function_">trim</span>().<span class="hljs-property">length</span> ?? <span class="hljs-number">0</span> &gt; <span class="hljs-number">0</span>;
  <span class="hljs-keyword">const</span> hasChildren = element.<span class="hljs-property">children</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>;
  <span class="hljs-keyword">const</span> hasBackground = <span class="hljs-title function_">hasBackgroundContent</span>(element);
  
  <span class="hljs-comment">// å¦‚æœåªæ˜¯ç©ºçš„åŒ…è£…å…ƒç´ ï¼Œè®¤ä¸ºæ˜¯åŒ…è£…å…ƒç´ </span>
  <span class="hljs-keyword">if</span> (!hasText &amp;&amp; !hasBackground &amp;&amp; element === <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }
  
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-comment">/**
 * æ£€æŸ¥å…ƒç´ æ˜¯å¦æœ‰èƒŒæ™¯å†…å®¹
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">hasBackgroundContent</span>(<span class="hljs-params">element: Element</span>): <span class="hljs-built_in">boolean</span> {
  <span class="hljs-keyword">const</span> style = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getComputedStyle</span>(element);
  
  <span class="hljs-comment">// æ£€æŸ¥èƒŒæ™¯é¢œè‰²ï¼ˆæ’é™¤ç™½è‰²å’Œé€æ˜ï¼‰</span>
  <span class="hljs-keyword">const</span> bgColor = style.<span class="hljs-property">backgroundColor</span>;
  <span class="hljs-keyword">if</span> (bgColor &amp;&amp; bgColor !== <span class="hljs-string">'rgba(0, 0, 0, 0)'</span> &amp;&amp; bgColor !== <span class="hljs-string">'transparent'</span>) {
    <span class="hljs-comment">// è§£æé¢œè‰²å€¼åˆ¤æ–­æ˜¯å¦ä¸ºç™½è‰²</span>
    <span class="hljs-keyword">const</span> isWhite = <span class="hljs-title function_">isWhiteColor</span>(bgColor);
    <span class="hljs-keyword">if</span> (!isWhite) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }
  
  <span class="hljs-comment">// æ£€æŸ¥èƒŒæ™¯å›¾ç‰‡</span>
  <span class="hljs-keyword">const</span> bgImage = style.<span class="hljs-property">backgroundImage</span>;
  <span class="hljs-keyword">if</span> (bgImage &amp;&amp; bgImage !== <span class="hljs-string">'none'</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }
  
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-comment">/**
 * åˆ¤æ–­é¢œè‰²æ˜¯å¦ä¸ºç™½è‰²
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">isWhiteColor</span>(<span class="hljs-params">color: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">boolean</span> {
  <span class="hljs-comment">// å¤„ç† rgb/rgba æ ¼å¼</span>
  <span class="hljs-keyword">const</span> rgbMatch = color.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/rgba?\((\d+),\s*(\d+),\s*(\d+)/</span>);
  <span class="hljs-keyword">if</span> (rgbMatch) {
    <span class="hljs-keyword">const</span> [, r, g, b] = rgbMatch.<span class="hljs-title function_">map</span>(<span class="hljs-title class_">Number</span>);
    <span class="hljs-comment">// æ¥è¿‘ç™½è‰²çš„é˜ˆå€¼</span>
    <span class="hljs-keyword">return</span> r &gt; <span class="hljs-number">250</span> &amp;&amp; g &gt; <span class="hljs-number">250</span> &amp;&amp; b &gt; <span class="hljs-number">250</span>;
  }
  
  <span class="hljs-comment">// å¤„ç†åå…­è¿›åˆ¶æ ¼å¼</span>
  <span class="hljs-keyword">if</span> (color.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'#'</span>)) {
    <span class="hljs-keyword">const</span> hex = color.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>);
    <span class="hljs-keyword">const</span> r = <span class="hljs-built_in">parseInt</span>(hex.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>), <span class="hljs-number">16</span>);
    <span class="hljs-keyword">const</span> g = <span class="hljs-built_in">parseInt</span>(hex.<span class="hljs-title function_">slice</span>(<span class="hljs-number">2</span>, <span class="hljs-number">4</span>), <span class="hljs-number">16</span>);
    <span class="hljs-keyword">const</span> b = <span class="hljs-built_in">parseInt</span>(hex.<span class="hljs-title function_">slice</span>(<span class="hljs-number">4</span>, <span class="hljs-number">6</span>), <span class="hljs-number">16</span>);
    <span class="hljs-keyword">return</span> r &gt; <span class="hljs-number">250</span> &amp;&amp; g &gt; <span class="hljs-number">250</span> &amp;&amp; b &gt; <span class="hljs-number">250</span>;
  }
  
  <span class="hljs-keyword">return</span> color === <span class="hljs-string">'white'</span> || color === <span class="hljs-string">'#fff'</span> || color === <span class="hljs-string">'#ffffff'</span>;
}

<span class="hljs-comment">/**
 * è·å–ç½‘ç»œä¿¡æ¯
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getNetworkInfo</span>(<span class="hljs-params"/>): <span class="hljs-title class_">NetworkInfo</span> {
  <span class="hljs-keyword">const</span> connection = (navigator <span class="hljs-keyword">as</span> <span class="hljs-title class_">Navigator</span> &amp; {
    connection?: {
      effectiveType?: <span class="hljs-built_in">string</span>;
      downlink?: <span class="hljs-built_in">number</span>;
      rtt?: <span class="hljs-built_in">number</span>;
    };
  }).<span class="hljs-property">connection</span>;
  
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">effectiveType</span>: connection?.<span class="hljs-property">effectiveType</span>,
    <span class="hljs-attr">downlink</span>: connection?.<span class="hljs-property">downlink</span>,
    <span class="hljs-attr">rtt</span>: connection?.<span class="hljs-property">rtt</span>,
    <span class="hljs-attr">online</span>: navigator.<span class="hljs-property">onLine</span>
  };
}

<span class="hljs-comment">/**
 * è·å–æ€§èƒ½æ•°æ®
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getPerformanceData</span>(<span class="hljs-params"/>): <span class="hljs-title class_">PerformanceData</span> {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">performanceData</span>: <span class="hljs-title class_">PerformanceData</span> = {};
  
  <span class="hljs-comment">// è·å–å¯¼èˆªæ€§èƒ½æ•°æ®</span>
  <span class="hljs-keyword">const</span> navigation = performance.<span class="hljs-title function_">getEntriesByType</span>(<span class="hljs-string">'navigation'</span>)[<span class="hljs-number">0</span>] <span class="hljs-keyword">as</span> <span class="hljs-title class_">PerformanceNavigationTiming</span>;
  <span class="hljs-keyword">if</span> (navigation) {
    performanceData.<span class="hljs-property">domContentLoaded</span> = navigation.<span class="hljs-property">domContentLoadedEventEnd</span> - navigation.<span class="hljs-property">startTime</span>;
    performanceData.<span class="hljs-property">loadComplete</span> = navigation.<span class="hljs-property">loadEventEnd</span> - navigation.<span class="hljs-property">startTime</span>;
  }
  
  <span class="hljs-comment">// è·å–ç»˜åˆ¶æ€§èƒ½æ•°æ®</span>
  <span class="hljs-keyword">const</span> paintEntries = performance.<span class="hljs-title function_">getEntriesByType</span>(<span class="hljs-string">'paint'</span>);
  paintEntries.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">entry</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (entry.<span class="hljs-property">name</span> === <span class="hljs-string">'first-contentful-paint'</span>) {
      performanceData.<span class="hljs-property">firstContentfulPaint</span> = entry.<span class="hljs-property">startTime</span>;
    }
  });
  
  <span class="hljs-comment">// è·å– LCP</span>
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> lcpEntries = performance.<span class="hljs-title function_">getEntriesByType</span>(<span class="hljs-string">'largest-contentful-paint'</span>);
    <span class="hljs-keyword">if</span> (lcpEntries.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">const</span> lastLcp = lcpEntries[lcpEntries.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>] <span class="hljs-keyword">as</span> <span class="hljs-title class_">PerformanceEntry</span> &amp; { <span class="hljs-attr">startTime</span>: <span class="hljs-built_in">number</span> };
      performanceData.<span class="hljs-property">largestContentfulPaint</span> = lastLcp.<span class="hljs-property">startTime</span>;
    }
  } <span class="hljs-keyword">catch</span> {
    <span class="hljs-comment">// LCP å¯èƒ½ä¸è¢«æ”¯æŒ</span>
  }
  
  <span class="hljs-keyword">return</span> performanceData;
}

<span class="hljs-comment">// ==================== é‡‡æ ·ç‚¹æ£€æµ‹å™¨ ====================</span>

<span class="hljs-comment">/**
 * é‡‡æ ·ç‚¹æ£€æµ‹å™¨ç±»
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SamplingDetector</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">config</span>: <span class="hljs-title class_">Required</span>&lt;<span class="hljs-title class_">Pick</span>&lt;<span class="hljs-title class_">WhiteScreenConfig</span>, 
    <span class="hljs-string">'samplingPoints'</span> | <span class="hljs-string">'threshold'</span> | <span class="hljs-string">'ignoreSelectors'</span> | <span class="hljs-string">'container'</span>
  &gt;&gt;;
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">config: Partial&lt;WhiteScreenConfig&gt; = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = {
      <span class="hljs-attr">samplingPoints</span>: config.<span class="hljs-property">samplingPoints</span> ?? <span class="hljs-number">17</span>,
      <span class="hljs-attr">threshold</span>: config.<span class="hljs-property">threshold</span> ?? <span class="hljs-number">0.95</span>,
      <span class="hljs-attr">ignoreSelectors</span>: config.<span class="hljs-property">ignoreSelectors</span> ?? [],
      <span class="hljs-attr">container</span>: config.<span class="hljs-property">container</span> ?? <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>
    };
  }
  
  <span class="hljs-comment">/**
   * æ‰§è¡Œé‡‡æ ·æ£€æµ‹
   */</span>
  <span class="hljs-title function_">detect</span>(): <span class="hljs-title class_">SamplingResult</span> {
    <span class="hljs-keyword">const</span> { samplingPoints, ignoreSelectors, container } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>;
    <span class="hljs-keyword">const</span> <span class="hljs-attr">points</span>: <span class="hljs-title class_">SamplingPointDetail</span>[] = [];
    
    <span class="hljs-comment">// è·å–è§†å£å°ºå¯¸</span>
    <span class="hljs-keyword">const</span> viewportWidth = <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span> || <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">clientWidth</span>;
    <span class="hljs-keyword">const</span> viewportHeight = <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span> || <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">clientHeight</span>;
    
    <span class="hljs-comment">// è®¡ç®—é‡‡æ ·é—´éš”</span>
    <span class="hljs-keyword">const</span> horizontalStep = viewportWidth / (samplingPoints + <span class="hljs-number">1</span>);
    <span class="hljs-keyword">const</span> verticalStep = viewportHeight / (samplingPoints + <span class="hljs-number">1</span>);
    
    <span class="hljs-keyword">let</span> emptyPoints = <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// ç”Ÿæˆé‡‡æ ·ç‚¹çŸ©é˜µ</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt;= samplingPoints; i++) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">1</span>; j &lt;= samplingPoints; j++) {
        <span class="hljs-keyword">const</span> x = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(horizontalStep * i);
        <span class="hljs-keyword">const</span> y = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(verticalStep * j);
        
        <span class="hljs-keyword">const</span> pointResult = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkPoint</span>(x, y, ignoreSelectors);
        points.<span class="hljs-title function_">push</span>(pointResult);
        
        <span class="hljs-keyword">if</span> (pointResult.<span class="hljs-property">isEmpty</span>) {
          emptyPoints++;
        }
      }
    }
    
    <span class="hljs-comment">// æ·»åŠ ä¸­å¿ƒç‚¹æ£€æµ‹ï¼ˆæƒé‡æ›´é«˜ï¼‰</span>
    <span class="hljs-keyword">const</span> centerX = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(viewportWidth / <span class="hljs-number">2</span>);
    <span class="hljs-keyword">const</span> centerY = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(viewportHeight / <span class="hljs-number">2</span>);
    <span class="hljs-keyword">const</span> centerPoints = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkCenterRegion</span>(centerX, centerY, ignoreSelectors);
    points.<span class="hljs-title function_">push</span>(...centerPoints);
    
    centerPoints.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">point</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (point.<span class="hljs-property">isEmpty</span>) emptyPoints++;
    });
    
    <span class="hljs-keyword">const</span> totalPoints = points.<span class="hljs-property">length</span>;
    <span class="hljs-keyword">const</span> emptyRatio = totalPoints &gt; <span class="hljs-number">0</span> ? emptyPoints / totalPoints : <span class="hljs-number">1</span>;
    
    <span class="hljs-keyword">return</span> {
      totalPoints,
      emptyPoints,
      emptyRatio,
      <span class="hljs-attr">pointDetails</span>: points
    };
  }
  
  <span class="hljs-comment">/**
   * æ£€æŸ¥å•ä¸ªé‡‡æ ·ç‚¹
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">checkPoint</span>(
    <span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>,
    <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span>,
    <span class="hljs-attr">ignoreSelectors</span>: <span class="hljs-built_in">string</span>[]
  ): <span class="hljs-title class_">SamplingPointDetail</span> {
    <span class="hljs-keyword">const</span> element = <span class="hljs-title function_">getElementAtPoint</span>(x, y);
    
    <span class="hljs-keyword">const</span> <span class="hljs-attr">detail</span>: <span class="hljs-title class_">SamplingPointDetail</span> = {
      x,
      y,
      <span class="hljs-attr">tagName</span>: element?.<span class="hljs-property">tagName</span> ?? <span class="hljs-literal">null</span>,
      <span class="hljs-attr">isEmpty</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">className</span>: element?.<span class="hljs-property">className</span>?.<span class="hljs-title function_">toString</span>(),
      <span class="hljs-attr">id</span>: element?.<span class="hljs-property">id</span>
    };
    
    <span class="hljs-keyword">if</span> (!element) {
      <span class="hljs-keyword">return</span> detail;
    }
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦åœ¨å¿½ç•¥åˆ—è¡¨ä¸­</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">shouldIgnoreElement</span>(element, ignoreSelectors)) {
      <span class="hljs-keyword">return</span> detail;
    }
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦ä¸ºæœ‰æ•ˆå†…å®¹å…ƒç´ </span>
    detail.<span class="hljs-property">isEmpty</span> = !<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isContentElement</span>(element);
    
    <span class="hljs-keyword">return</span> detail;
  }
  
  <span class="hljs-comment">/**
   * æ£€æŸ¥ä¸­å¿ƒåŒºåŸŸï¼ˆä¹å®«æ ¼ï¼‰
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">checkCenterRegion</span>(
    <span class="hljs-attr">centerX</span>: <span class="hljs-built_in">number</span>,
    <span class="hljs-attr">centerY</span>: <span class="hljs-built_in">number</span>,
    <span class="hljs-attr">ignoreSelectors</span>: <span class="hljs-built_in">string</span>[]
  ): <span class="hljs-title class_">SamplingPointDetail</span>[] {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">points</span>: <span class="hljs-title class_">SamplingPointDetail</span>[] = [];
    <span class="hljs-keyword">const</span> offsets = [-<span class="hljs-number">50</span>, <span class="hljs-number">0</span>, <span class="hljs-number">50</span>];
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> offsetX <span class="hljs-keyword">of</span> offsets) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> offsetY <span class="hljs-keyword">of</span> offsets) {
        <span class="hljs-keyword">if</span> (offsetX === <span class="hljs-number">0</span> &amp;&amp; offsetY === <span class="hljs-number">0</span>) <span class="hljs-keyword">continue</span>; <span class="hljs-comment">// è·³è¿‡æ­£ä¸­å¿ƒï¼Œå·²åœ¨ä¸»å¾ªç¯ä¸­å¤„ç†</span>
        
        <span class="hljs-keyword">const</span> x = centerX + offsetX;
        <span class="hljs-keyword">const</span> y = centerY + offsetY;
        
        <span class="hljs-keyword">if</span> (x &gt; <span class="hljs-number">0</span> &amp;&amp; y &gt; <span class="hljs-number">0</span>) {
          points.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkPoint</span>(x, y, ignoreSelectors));
        }
      }
    }
    
    <span class="hljs-keyword">return</span> points;
  }
  
  <span class="hljs-comment">/**
   * åˆ¤æ–­å…ƒç´ æ˜¯å¦åº”è¢«å¿½ç•¥
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">shouldIgnoreElement</span>(<span class="hljs-attr">element</span>: <span class="hljs-title class_">Element</span>, <span class="hljs-attr">ignoreSelectors</span>: <span class="hljs-built_in">string</span>[]): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> selector <span class="hljs-keyword">of</span> ignoreSelectors) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">if</span> (element.<span class="hljs-title function_">matches</span>(selector) || element.<span class="hljs-title function_">closest</span>(selector)) {
          <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
      } <span class="hljs-keyword">catch</span> {
        <span class="hljs-comment">// é€‰æ‹©å™¨æ— æ•ˆï¼Œå¿½ç•¥</span>
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }
  
  <span class="hljs-comment">/**
   * åˆ¤æ–­æ˜¯å¦ä¸ºæœ‰å†…å®¹çš„å…ƒç´ 
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">isContentElement</span>(<span class="hljs-attr">element</span>: <span class="hljs-title class_">Element</span>): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">const</span> tagName = element.<span class="hljs-property">tagName</span>.<span class="hljs-title function_">toUpperCase</span>();
    
    <span class="hljs-comment">// æ˜ç¡®çš„å†…å®¹å…ƒç´ </span>
    <span class="hljs-keyword">const</span> contentTags = [
      <span class="hljs-string">'IMG'</span>, <span class="hljs-string">'VIDEO'</span>, <span class="hljs-string">'AUDIO'</span>, <span class="hljs-string">'CANVAS'</span>, <span class="hljs-string">'SVG'</span>, <span class="hljs-string">'IFRAME'</span>,
      <span class="hljs-string">'INPUT'</span>, <span class="hljs-string">'TEXTAREA'</span>, <span class="hljs-string">'SELECT'</span>, <span class="hljs-string">'BUTTON'</span>,
      <span class="hljs-string">'H1'</span>, <span class="hljs-string">'H2'</span>, <span class="hljs-string">'H3'</span>, <span class="hljs-string">'H4'</span>, <span class="hljs-string">'H5'</span>, <span class="hljs-string">'H6'</span>,
      <span class="hljs-string">'P'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'SPAN'</span>, <span class="hljs-string">'LABEL'</span>, <span class="hljs-string">'LI'</span>, <span class="hljs-string">'TD'</span>, <span class="hljs-string">'TH'</span>,
      <span class="hljs-string">'STRONG'</span>, <span class="hljs-string">'EM'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'I'</span>, <span class="hljs-string">'U'</span>, <span class="hljs-string">'CODE'</span>, <span class="hljs-string">'PRE'</span>
    ];
    
    <span class="hljs-keyword">if</span> (contentTags.<span class="hljs-title function_">includes</span>(tagName)) {
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">isElementVisible</span>(element);
    }
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰æ–‡æœ¬å†…å®¹</span>
    <span class="hljs-keyword">const</span> textContent = element.<span class="hljs-property">textContent</span>?.<span class="hljs-title function_">trim</span>();
    <span class="hljs-keyword">if</span> (textContent &amp;&amp; textContent.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">isElementVisible</span>(element);
    }
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰èƒŒæ™¯å†…å®¹</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">hasBackgroundContent</span>(element)) {
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">isElementVisible</span>(element);
    }
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦ä¸ºåŒ…è£…å…ƒç´ </span>
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isWrapperElement</span>(element)) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">isElementVisible</span>(element);
  }
  
  <span class="hljs-comment">/**
   * åˆ¤æ–­æ˜¯å¦ä¸ºç™½å±
   */</span>
  <span class="hljs-title function_">isWhiteScreen</span>(<span class="hljs-attr">result</span>: <span class="hljs-title class_">SamplingResult</span>): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">return</span> result.<span class="hljs-property">emptyRatio</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">threshold</span>;
  }
}

<span class="hljs-comment">// ==================== DOM æ£€æµ‹å™¨ ====================</span>

<span class="hljs-comment">/**
 * DOM æ£€æµ‹å™¨ç±»
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">DOMDetector</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">config</span>: <span class="hljs-title class_">Required</span>&lt;<span class="hljs-title class_">Pick</span>&lt;<span class="hljs-title class_">WhiteScreenConfig</span>, 
    <span class="hljs-string">'keyElementSelectors'</span> | <span class="hljs-string">'container'</span>
  &gt;&gt;;
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">config: Partial&lt;WhiteScreenConfig&gt; = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = {
      <span class="hljs-attr">keyElementSelectors</span>: config.<span class="hljs-property">keyElementSelectors</span> ?? [
        <span class="hljs-string">'#app'</span>, <span class="hljs-string">'#root'</span>, <span class="hljs-string">'.app'</span>, <span class="hljs-string">'.main-content'</span>,
        <span class="hljs-string">'main'</span>, <span class="hljs-string">'[data-page]'</span>, <span class="hljs-string">'.page-container'</span>
      ],
      <span class="hljs-attr">container</span>: config.<span class="hljs-property">container</span> ?? <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>
    };
  }
  
  <span class="hljs-comment">/**
   * æ‰§è¡Œ DOM æ£€æµ‹
   */</span>
  <span class="hljs-title function_">detect</span>(): <span class="hljs-title class_">DOMDetectionResult</span> {
    <span class="hljs-keyword">const</span> { keyElementSelectors, container } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>;
    <span class="hljs-keyword">const</span> <span class="hljs-attr">elementDetails</span>: <span class="hljs-title class_">ElementDetail</span>[] = [];
    <span class="hljs-keyword">const</span> <span class="hljs-attr">missingSelectors</span>: <span class="hljs-built_in">string</span>[] = [];
    <span class="hljs-keyword">let</span> foundElements = <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> selector <span class="hljs-keyword">of</span> keyElementSelectors) {
      <span class="hljs-keyword">const</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkElement</span>(selector, container);
      elementDetails.<span class="hljs-title function_">push</span>(result);
      
      <span class="hljs-keyword">if</span> (result.<span class="hljs-property">exists</span> &amp;&amp; result.<span class="hljs-property">isVisible</span>) {
        foundElements++;
      } <span class="hljs-keyword">else</span> {
        missingSelectors.<span class="hljs-title function_">push</span>(selector);
      }
    }
    
    <span class="hljs-keyword">const</span> expectedElements = keyElementSelectors.<span class="hljs-property">length</span>;
    <span class="hljs-keyword">const</span> passed = foundElements &gt; <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">return</span> {
      passed,
      foundElements,
      expectedElements,
      missingSelectors,
      elementDetails
    };
  }
  
  <span class="hljs-comment">/**
   * æ£€æŸ¥å•ä¸ªå…ƒç´ 
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">checkElement</span>(
    <span class="hljs-attr">selector</span>: <span class="hljs-built_in">string</span>,
    <span class="hljs-attr">container</span>: <span class="hljs-title class_">HTMLElement</span> | <span class="hljs-literal">null</span>
  ): <span class="hljs-title class_">ElementDetail</span> {
    <span class="hljs-keyword">const</span> searchRoot = container ?? <span class="hljs-variable language_">document</span>;
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> element = searchRoot.<span class="hljs-title function_">querySelector</span>(selector);
      
      <span class="hljs-keyword">if</span> (!element) {
        <span class="hljs-keyword">return</span> {
          selector,
          <span class="hljs-attr">exists</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">isVisible</span>: <span class="hljs-literal">false</span>
        };
      }
      
      <span class="hljs-keyword">const</span> isVisible = <span class="hljs-title function_">isElementVisible</span>(element);
      <span class="hljs-keyword">const</span> rect = element.<span class="hljs-title function_">getBoundingClientRect</span>();
      
      <span class="hljs-keyword">return</span> {
        selector,
        <span class="hljs-attr">exists</span>: <span class="hljs-literal">true</span>,
        isVisible,
        <span class="hljs-attr">dimensions</span>: {
          <span class="hljs-attr">width</span>: rect.<span class="hljs-property">width</span>,
          <span class="hljs-attr">height</span>: rect.<span class="hljs-property">height</span>
        }
      };
    } <span class="hljs-keyword">catch</span> {
      <span class="hljs-keyword">return</span> {
        selector,
        <span class="hljs-attr">exists</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">isVisible</span>: <span class="hljs-literal">false</span>
      };
    }
  }
  
  <span class="hljs-comment">/**
   * æ£€æµ‹é¡µé¢æ˜¯å¦æœ‰æœ‰æ•ˆå†…å®¹
   */</span>
  <span class="hljs-title function_">hasValidContent</span>(): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">const</span> body = <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>;
    <span class="hljs-keyword">if</span> (!body) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    
    <span class="hljs-comment">// æ£€æŸ¥ body æ˜¯å¦æœ‰å­å…ƒç´ </span>
    <span class="hljs-keyword">if</span> (body.<span class="hljs-property">children</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰å¯è§çš„å­å…ƒç´ </span>
    <span class="hljs-keyword">const</span> children = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(body.<span class="hljs-property">children</span>);
    <span class="hljs-keyword">const</span> visibleChildren = children.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span> <span class="hljs-title function_">isElementVisible</span>(child));
    
    <span class="hljs-keyword">if</span> (visibleChildren.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰å®é™…å†…å®¹ï¼ˆæ–‡æœ¬æˆ–åª’ä½“ï¼‰</span>
    <span class="hljs-keyword">const</span> hasContent = visibleChildren.<span class="hljs-title function_">some</span>(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span> {
      <span class="hljs-comment">// æ£€æŸ¥æ–‡æœ¬å†…å®¹</span>
      <span class="hljs-keyword">const</span> text = child.<span class="hljs-property">textContent</span>?.<span class="hljs-title function_">trim</span>();
      <span class="hljs-keyword">if</span> (text &amp;&amp; text.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      
      <span class="hljs-comment">// æ£€æŸ¥åª’ä½“å…ƒç´ </span>
      <span class="hljs-keyword">const</span> mediaElements = child.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'img, video, canvas, svg, iframe'</span>);
      <span class="hljs-keyword">if</span> (mediaElements.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      
      <span class="hljs-comment">// æ£€æŸ¥èƒŒæ™¯</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-title function_">hasBackgroundContent</span>(child)) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    });
    
    <span class="hljs-keyword">return</span> hasContent;
  }
  
  <span class="hljs-comment">/**
   * è·å–é¡µé¢ DOM ç»Ÿè®¡ä¿¡æ¯
   */</span>
  <span class="hljs-title function_">getDOMStats</span>(): {
    <span class="hljs-attr">totalElements</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">visibleElements</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">textNodes</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">mediaElements</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">interactiveElements</span>: <span class="hljs-built_in">number</span>;
  } {
    <span class="hljs-keyword">const</span> allElements = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'*'</span>);
    <span class="hljs-keyword">let</span> visibleElements = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> textNodes = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> mediaElements = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> interactiveElements = <span class="hljs-number">0</span>;
    
    allElements.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">element</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isElementVisible</span>(element)) {
        visibleElements++;
      }
      
      <span class="hljs-keyword">const</span> tagName = element.<span class="hljs-property">tagName</span>.<span class="hljs-title function_">toUpperCase</span>();
      
      <span class="hljs-keyword">if</span> ([<span class="hljs-string">'IMG'</span>, <span class="hljs-string">'VIDEO'</span>, <span class="hljs-string">'AUDIO'</span>, <span class="hljs-string">'CANVAS'</span>, <span class="hljs-string">'SVG'</span>, <span class="hljs-string">'IFRAME'</span>].<span class="hljs-title function_">includes</span>(tagName)) {
        mediaElements++;
      }
      
      <span class="hljs-keyword">if</span> ([<span class="hljs-string">'INPUT'</span>, <span class="hljs-string">'BUTTON'</span>, <span class="hljs-string">'SELECT'</span>, <span class="hljs-string">'TEXTAREA'</span>, <span class="hljs-string">'A'</span>].<span class="hljs-title function_">includes</span>(tagName)) {
        interactiveElements++;
      }
    });
    
    <span class="hljs-comment">// ç»Ÿè®¡æ–‡æœ¬èŠ‚ç‚¹</span>
    <span class="hljs-keyword">const</span> walker = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createTreeWalker</span>(
      <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>,
      <span class="hljs-title class_">NodeFilter</span>.<span class="hljs-property">SHOW_TEXT</span>,
      <span class="hljs-literal">null</span>
    );
    
    <span class="hljs-keyword">while</span> (walker.<span class="hljs-title function_">nextNode</span>()) {
      <span class="hljs-keyword">const</span> node = walker.<span class="hljs-property">currentNode</span>;
      <span class="hljs-keyword">if</span> (node.<span class="hljs-property">textContent</span>?.<span class="hljs-title function_">trim</span>()) {
        textNodes++;
      }
    }
    
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">totalElements</span>: allElements.<span class="hljs-property">length</span>,
      visibleElements,
      textNodes,
      mediaElements,
      interactiveElements
    };
  }
}

<span class="hljs-comment">// ==================== MutationObserver æ£€æµ‹å™¨ ====================</span>

<span class="hljs-comment">/**
 * MutationObserver æ£€æµ‹å™¨ç±»
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MutationDetector</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">observer</span>: <span class="hljs-title class_">MutationObserver</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">mutations</span>: <span class="hljs-title class_">MutationRecord</span>[] = [];
  <span class="hljs-keyword">private</span> <span class="hljs-attr">startTime</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">isObserving</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">config</span>: {
    <span class="hljs-attr">timeout</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">minMutations</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">stableTime</span>: <span class="hljs-built_in">number</span>;
  };
  
  <span class="hljs-keyword">private</span> <span class="hljs-attr">resolvePromise</span>: (<span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>) | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">timeoutId</span>: <span class="hljs-title class_">ReturnType</span>&lt;<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">setTimeout</span>&gt; | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">stableTimeoutId</span>: <span class="hljs-title class_">ReturnType</span>&lt;<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">setTimeout</span>&gt; | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">config: Partial&lt;WhiteScreenConfig&gt; = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = {
      <span class="hljs-attr">timeout</span>: config.<span class="hljs-property">timeout</span> ?? <span class="hljs-number">10000</span>,
      <span class="hljs-attr">minMutations</span>: <span class="hljs-number">10</span>,
      <span class="hljs-attr">stableTime</span>: <span class="hljs-number">1000</span>
    };
  }
  
  <span class="hljs-comment">/**
   * å¼€å§‹è§‚å¯Ÿ
   */</span>
  <span class="hljs-title function_">observe</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resolvePromise</span> = resolve;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">startTime</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">mutations</span> = [];
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">isObserving</span> = <span class="hljs-literal">true</span>;
      
      <span class="hljs-comment">// åˆ›å»º MutationObserver</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutationObserver</span>(<span class="hljs-function">(<span class="hljs-params">mutations</span>) =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleMutations</span>(mutations);
      });
      
      <span class="hljs-comment">// é…ç½®è§‚å¯Ÿé€‰é¡¹</span>
      <span class="hljs-keyword">const</span> <span class="hljs-attr">observerConfig</span>: <span class="hljs-title class_">MutationObserverInit</span> = {
        <span class="hljs-attr">childList</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">subtree</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">attributes</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">characterData</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">attributeOldValue</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">characterDataOldValue</span>: <span class="hljs-literal">false</span>
      };
      
      <span class="hljs-comment">// å¼€å§‹è§‚å¯Ÿ</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span>.<span class="hljs-title function_">observe</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>, observerConfig);
      
      <span class="hljs-comment">// è®¾ç½®è¶…æ—¶</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">timeoutId</span> = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">complete</span>(<span class="hljs-literal">false</span>);
      }, <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">timeout</span>);
    });
  }
  
  <span class="hljs-comment">/**
   * å¤„ç† mutation è®°å½•
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">handleMutations</span>(<span class="hljs-attr">mutations</span>: <span class="hljs-title class_">MutationRecord</span>[]): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isObserving</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">mutations</span>.<span class="hljs-title function_">push</span>(...mutations);
    
    <span class="hljs-comment">// é‡ç½®ç¨³å®šè®¡æ—¶å™¨</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">stableTimeoutId</span>) {
      <span class="hljs-built_in">clearTimeout</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">stableTimeoutId</span>);
    }
    
    <span class="hljs-comment">// è®¾ç½®æ–°çš„ç¨³å®šè®¡æ—¶å™¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stableTimeoutId</span> = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkStability</span>();
    }, <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">stableTime</span>);
  }
  
  <span class="hljs-comment">/**
   * æ£€æŸ¥é¡µé¢ç¨³å®šæ€§
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">checkStability</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isObserving</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿçš„ mutationsï¼ˆè¡¨ç¤ºé¡µé¢æœ‰æ¸²æŸ“æ´»åŠ¨ï¼‰</span>
    <span class="hljs-keyword">const</span> hasSufficientMutations = <span class="hljs-variable language_">this</span>.<span class="hljs-property">mutations</span>.<span class="hljs-property">length</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">minMutations</span>;
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰æœ‰æ„ä¹‰çš„å†…å®¹å˜åŒ–</span>
    <span class="hljs-keyword">const</span> hasContentChanges = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">hasContentMutations</span>();
    
    <span class="hljs-keyword">if</span> (hasSufficientMutations &amp;&amp; hasContentChanges) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">complete</span>(<span class="hljs-literal">true</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - <span class="hljs-variable language_">this</span>.<span class="hljs-property">startTime</span> &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">timeout</span> / <span class="hljs-number">2</span>) {
      <span class="hljs-comment">// å¦‚æœå·²ç»è¿‡äº†ä¸€åŠçš„è¶…æ—¶æ—¶é—´ï¼Œä¸”æ²¡æœ‰è¶³å¤Ÿçš„æ´»åŠ¨ï¼Œå¯èƒ½æ˜¯ç™½å±</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">complete</span>(<span class="hljs-literal">false</span>);
    }
  }
  
  <span class="hljs-comment">/**
   * æ£€æŸ¥æ˜¯å¦æœ‰å†…å®¹ç›¸å…³çš„ mutations
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">hasContentMutations</span>(): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">let</span> contentMutations = <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> mutation <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">mutations</span>) {
      <span class="hljs-keyword">if</span> (mutation.<span class="hljs-property">type</span> === <span class="hljs-string">'childList'</span>) {
        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æ·»åŠ äº†æœ‰æ„ä¹‰çš„èŠ‚ç‚¹</span>
        <span class="hljs-keyword">const</span> addedNodes = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(mutation.<span class="hljs-property">addedNodes</span>);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> node <span class="hljs-keyword">of</span> addedNodes) {
          <span class="hljs-keyword">if</span> (node.<span class="hljs-property">nodeType</span> === <span class="hljs-title class_">Node</span>.<span class="hljs-property">ELEMENT_NODE</span>) {
            <span class="hljs-keyword">const</span> element = node <span class="hljs-keyword">as</span> <span class="hljs-title class_">Element</span>;
            <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isElementVisible</span>(element)) {
              contentMutations++;
            }
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (node.<span class="hljs-property">nodeType</span> === <span class="hljs-title class_">Node</span>.<span class="hljs-property">TEXT_NODE</span>) {
            <span class="hljs-keyword">if</span> (node.<span class="hljs-property">textContent</span>?.<span class="hljs-title function_">trim</span>()) {
              contentMutations++;
            }
          }
        }
      }
    }
    
    <span class="hljs-keyword">return</span> contentMutations &gt;= <span class="hljs-number">5</span>;
  }
  
  <span class="hljs-comment">/**
   * å®Œæˆæ£€æµ‹
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">complete</span>(<span class="hljs-attr">hasContent</span>: <span class="hljs-built_in">boolean</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isObserving</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isObserving</span> = <span class="hljs-literal">false</span>;
    
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span>.<span class="hljs-title function_">disconnect</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span> = <span class="hljs-literal">null</span>;
    }
    
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">timeoutId</span>) {
      <span class="hljs-built_in">clearTimeout</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">timeoutId</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">timeoutId</span> = <span class="hljs-literal">null</span>;
    }
    
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">stableTimeoutId</span>) {
      <span class="hljs-built_in">clearTimeout</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">stableTimeoutId</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">stableTimeoutId</span> = <span class="hljs-literal">null</span>;
    }
    
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">resolvePromise</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">resolvePromise</span>(hasContent);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resolvePromise</span> = <span class="hljs-literal">null</span>;
    }
  }
  
  <span class="hljs-comment">/**
   * è·å– mutation ç»Ÿè®¡
   */</span>
  <span class="hljs-title function_">getMutationStats</span>(): {
    <span class="hljs-attr">totalMutations</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">childListMutations</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">attributeMutations</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">characterDataMutations</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">duration</span>: <span class="hljs-built_in">number</span>;
  } {
    <span class="hljs-keyword">let</span> childListMutations = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> attributeMutations = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> characterDataMutations = <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> mutation <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">mutations</span>) {
      <span class="hljs-keyword">switch</span> (mutation.<span class="hljs-property">type</span>) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">'childList'</span>:
          childListMutations++;
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">'attributes'</span>:
          attributeMutations++;
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">'characterData'</span>:
          characterDataMutations++;
          <span class="hljs-keyword">break</span>;
      }
    }
    
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">totalMutations</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">mutations</span>.<span class="hljs-property">length</span>,
      childListMutations,
      attributeMutations,
      characterDataMutations,
      <span class="hljs-attr">duration</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - <span class="hljs-variable language_">this</span>.<span class="hljs-property">startTime</span>
    };
  }
  
  <span class="hljs-comment">/**
   * åœæ­¢è§‚å¯Ÿ
   */</span>
  <span class="hljs-title function_">stop</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">complete</span>(<span class="hljs-literal">false</span>);
  }
}

<span class="hljs-comment">// ==================== æˆªå›¾æ£€æµ‹å™¨ ====================</span>

<span class="hljs-comment">/**
 * æˆªå›¾æ£€æµ‹å™¨ç±»
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ScreenshotDetector</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">canvas</span>: <span class="hljs-title class_">HTMLCanvasElement</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">ctx</span>: <span class="hljs-title class_">CanvasRenderingContext2D</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">config</span>: {
    <span class="hljs-attr">sampleWidth</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">sampleHeight</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">whiteThreshold</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">brightnessThreshold</span>: <span class="hljs-built_in">number</span>;
  };
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">config: Partial&lt;WhiteScreenConfig&gt; = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = {
      <span class="hljs-attr">sampleWidth</span>: <span class="hljs-number">100</span>,
      <span class="hljs-attr">sampleHeight</span>: <span class="hljs-number">100</span>,
      <span class="hljs-attr">whiteThreshold</span>: config.<span class="hljs-property">threshold</span> ?? <span class="hljs-number">0.95</span>,
      <span class="hljs-attr">brightnessThreshold</span>: <span class="hljs-number">250</span>
    };
  }
  
  <span class="hljs-comment">/**
   * åˆå§‹åŒ– Canvas
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">initCanvas</span>(): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'canvas'</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">width</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">sampleWidth</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">height</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">sampleHeight</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span>.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">'2d'</span>, { <span class="hljs-attr">willReadFrequently</span>: <span class="hljs-literal">true</span> });
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span> !== <span class="hljs-literal">null</span>;
    } <span class="hljs-keyword">catch</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }
  
  <span class="hljs-comment">/**
   * æ‰§è¡Œæˆªå›¾æ£€æµ‹
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">detect</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ScreenshotResult</span>&gt; {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initCanvas</span>() || !<span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span> || !<span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>) {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">isWhiteScreen</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">whitePixelRatio</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">totalPixels</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">whitePixels</span>: <span class="hljs-number">0</span>
      };
    }
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// ä½¿ç”¨ html2canvas æˆ–åŸç”Ÿæ–¹æ³•æˆªå›¾</span>
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">captureScreen</span>();
      
      <span class="hljs-comment">// åˆ†æå›¾åƒ</span>
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">analyzeImage</span>();
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Screenshot detection failed:'</span>, error);
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">isWhiteScreen</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">whitePixelRatio</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">totalPixels</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">whitePixels</span>: <span class="hljs-number">0</span>
      };
    }
  }
  
  <span class="hljs-comment">/**
   * æ•è·å±å¹•
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">captureScreen</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span> || !<span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-keyword">const</span> { sampleWidth, sampleHeight } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>;
    
    <span class="hljs-comment">// æ–¹æ¡ˆ1: ä½¿ç”¨ html2canvasï¼ˆéœ€è¦å¼•å…¥åº“ï¼‰</span>
    <span class="hljs-comment">// è¿™é‡Œä½¿ç”¨ç®€åŒ–çš„æ–¹æ¡ˆï¼šéå†å¯è§å…ƒç´ å¹¶ç»˜åˆ¶</span>
    
    <span class="hljs-comment">// å…ˆå¡«å……ç™½è‰²èƒŒæ™¯</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">'#ffffff'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>.<span class="hljs-title function_">fillRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, sampleWidth, sampleHeight);
    
    <span class="hljs-comment">// è·å– body çš„èƒŒæ™¯è‰²</span>
    <span class="hljs-keyword">const</span> bodyStyle = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getComputedStyle</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>);
    <span class="hljs-keyword">const</span> bodyBgColor = bodyStyle.<span class="hljs-property">backgroundColor</span>;
    <span class="hljs-keyword">if</span> (bodyBgColor &amp;&amp; bodyBgColor !== <span class="hljs-string">'rgba(0, 0, 0, 0)'</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>.<span class="hljs-property">fillStyle</span> = bodyBgColor;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>.<span class="hljs-title function_">fillRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, sampleWidth, sampleHeight);
    }
    
    <span class="hljs-comment">// ç»˜åˆ¶å¯è§å…ƒç´ çš„ç®€åŒ–è¡¨ç¤º</span>
    <span class="hljs-keyword">const</span> elements = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'*'</span>);
    <span class="hljs-keyword">const</span> viewportWidth = <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span>;
    <span class="hljs-keyword">const</span> viewportHeight = <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>;
    <span class="hljs-keyword">const</span> scaleX = sampleWidth / viewportWidth;
    <span class="hljs-keyword">const</span> scaleY = sampleHeight / viewportHeight;
    
    elements.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">element</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">isElementVisible</span>(element)) <span class="hljs-keyword">return</span>;
      
      <span class="hljs-keyword">const</span> rect = element.<span class="hljs-title function_">getBoundingClientRect</span>();
      <span class="hljs-keyword">if</span> (rect.<span class="hljs-property">width</span> === <span class="hljs-number">0</span> || rect.<span class="hljs-property">height</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;
      
      <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦åœ¨è§†å£å†…</span>
      <span class="hljs-keyword">if</span> (rect.<span class="hljs-property">right</span> &lt; <span class="hljs-number">0</span> || rect.<span class="hljs-property">bottom</span> &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;
      <span class="hljs-keyword">if</span> (rect.<span class="hljs-property">left</span> &gt; viewportWidth || rect.<span class="hljs-property">top</span> &gt; viewportHeight) <span class="hljs-keyword">return</span>;
      
      <span class="hljs-keyword">const</span> style = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getComputedStyle</span>(element);
      <span class="hljs-keyword">const</span> bgColor = style.<span class="hljs-property">backgroundColor</span>;
      
      <span class="hljs-comment">// åªç»˜åˆ¶æœ‰èƒŒæ™¯è‰²çš„å…ƒç´ </span>
      <span class="hljs-keyword">if</span> (bgColor &amp;&amp; bgColor !== <span class="hljs-string">'rgba(0, 0, 0, 0)'</span> &amp;&amp; bgColor !== <span class="hljs-string">'transparent'</span>) {
        <span class="hljs-keyword">const</span> x = rect.<span class="hljs-property">left</span> * scaleX;
        <span class="hljs-keyword">const</span> y = rect.<span class="hljs-property">top</span> * scaleY;
        <span class="hljs-keyword">const</span> width = rect.<span class="hljs-property">width</span> * scaleX;
        <span class="hljs-keyword">const</span> height = rect.<span class="hljs-property">height</span> * scaleY;
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>!.<span class="hljs-property">fillStyle</span> = bgColor;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>!.<span class="hljs-title function_">fillRect</span>(x, y, width, height);
      }
      
      <span class="hljs-comment">// ç»˜åˆ¶æ–‡æœ¬åŒºåŸŸ</span>
      <span class="hljs-keyword">const</span> text = element.<span class="hljs-property">textContent</span>?.<span class="hljs-title function_">trim</span>();
      <span class="hljs-keyword">if</span> (text &amp;&amp; text.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span> &amp;&amp; element.<span class="hljs-property">children</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">const</span> x = rect.<span class="hljs-property">left</span> * scaleX;
        <span class="hljs-keyword">const</span> y = rect.<span class="hljs-property">top</span> * scaleY;
        <span class="hljs-keyword">const</span> width = rect.<span class="hljs-property">width</span> * scaleX;
        <span class="hljs-keyword">const</span> height = rect.<span class="hljs-property">height</span> * scaleY;
        
        <span class="hljs-comment">// ç”¨æ·±è‰²è¡¨ç¤ºæ–‡æœ¬åŒºåŸŸ</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>!.<span class="hljs-property">fillStyle</span> = style.<span class="hljs-property">color</span> || <span class="hljs-string">'#000000'</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>!.<span class="hljs-title function_">fillRect</span>(x, y, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(width, <span class="hljs-number">2</span>), <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(height, <span class="hljs-number">2</span>));
      }
    });
    
    <span class="hljs-comment">// ç»˜åˆ¶å›¾ç‰‡å…ƒç´ </span>
    <span class="hljs-keyword">const</span> images = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'img'</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> img <span class="hljs-keyword">of</span> images) {
      <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">isElementVisible</span>(img)) <span class="hljs-keyword">continue</span>;
      
      <span class="hljs-keyword">const</span> rect = img.<span class="hljs-title function_">getBoundingClientRect</span>();
      <span class="hljs-keyword">if</span> (rect.<span class="hljs-property">width</span> === <span class="hljs-number">0</span> || rect.<span class="hljs-property">height</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">continue</span>;
      
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> x = rect.<span class="hljs-property">left</span> * scaleX;
        <span class="hljs-keyword">const</span> y = rect.<span class="hljs-property">top</span> * scaleY;
        <span class="hljs-keyword">const</span> width = rect.<span class="hljs-property">width</span> * scaleX;
        <span class="hljs-keyword">const</span> height = rect.<span class="hljs-property">height</span> * scaleY;
        
        <span class="hljs-comment">// ç”¨ç°è‰²è¡¨ç¤ºå›¾ç‰‡åŒºåŸŸ</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>!.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">'#808080'</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>!.<span class="hljs-title function_">fillRect</span>(x, y, width, height);
      } <span class="hljs-keyword">catch</span> {
        <span class="hljs-comment">// è·¨åŸŸå›¾ç‰‡æ— æ³•ç»˜åˆ¶</span>
      }
    }
  }
  
  <span class="hljs-comment">/**
   * åˆ†æå›¾åƒ
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">analyzeImage</span>(): <span class="hljs-title class_">ScreenshotResult</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span> || !<span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>) {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">isWhiteScreen</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">whitePixelRatio</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">totalPixels</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">whitePixels</span>: <span class="hljs-number">0</span>
      };
    }
    
    <span class="hljs-keyword">const</span> { sampleWidth, sampleHeight, brightnessThreshold } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>;
    <span class="hljs-keyword">const</span> imageData = <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>.<span class="hljs-title function_">getImageData</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, sampleWidth, sampleHeight);
    <span class="hljs-keyword">const</span> data = imageData.<span class="hljs-property">data</span>;
    
    <span class="hljs-keyword">let</span> whitePixels = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> blackPixels = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> grayPixels = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> coloredPixels = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> totalPixels = (sampleWidth * sampleHeight);
    
    <span class="hljs-comment">// éå†åƒç´ </span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; data.<span class="hljs-property">length</span>; i += <span class="hljs-number">4</span>) {
      <span class="hljs-keyword">const</span> r = data[i];
      <span class="hljs-keyword">const</span> g = data[i + <span class="hljs-number">1</span>];
      <span class="hljs-keyword">const</span> b = data[i + <span class="hljs-number">2</span>];
      
      <span class="hljs-comment">// è®¡ç®—äº®åº¦</span>
      <span class="hljs-keyword">const</span> brightness = (r + g + b) / <span class="hljs-number">3</span>;
      
      <span class="hljs-comment">// åˆ¤æ–­åƒç´ é¢œè‰²ç±»å‹</span>
      <span class="hljs-keyword">if</span> (brightness &gt;= brightnessThreshold) {
        whitePixels++;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (brightness &lt;= <span class="hljs-number">10</span>) {
        blackPixels++;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(r - g) &lt;= <span class="hljs-number">20</span> &amp;&amp; <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(g - b) &lt;= <span class="hljs-number">20</span> &amp;&amp; <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(r - b) &lt;= <span class="hljs-number">20</span>) {
        grayPixels++;
      } <span class="hljs-keyword">else</span> {
        coloredPixels++;
      }
    }
    
    <span class="hljs-keyword">const</span> whitePixelRatio = whitePixels / totalPixels;
    <span class="hljs-keyword">const</span> isWhiteScreen = whitePixelRatio &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">whiteThreshold</span>;
    
    <span class="hljs-keyword">return</span> {
      isWhiteScreen,
      whitePixelRatio,
      totalPixels,
      whitePixels,
      <span class="hljs-attr">colorDistribution</span>: {
        <span class="hljs-attr">white</span>: whitePixels / totalPixels,
        <span class="hljs-attr">black</span>: blackPixels / totalPixels,
        <span class="hljs-attr">gray</span>: grayPixels / totalPixels,
        <span class="hljs-attr">colored</span>: coloredPixels / totalPixels
      }
    };
  }
  
  <span class="hljs-comment">/**
   * é‡Šæ”¾èµ„æº
   */</span>
  <span class="hljs-title function_">dispose</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span> = <span class="hljs-literal">null</span>;
  }
}

<span class="hljs-comment">// ==================== éª¨æ¶å±æ£€æµ‹å™¨ ====================</span>

<span class="hljs-comment">/**
 * éª¨æ¶å±æ£€æµ‹å™¨ç±»
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SkeletonDetector</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">config</span>: {
    <span class="hljs-attr">skeletonSelector</span>: <span class="hljs-built_in">string</span>;
    <span class="hljs-attr">timeout</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">checkInterval</span>: <span class="hljs-built_in">number</span>;
  };
  
  <span class="hljs-keyword">private</span> <span class="hljs-attr">intervalId</span>: <span class="hljs-title class_">ReturnType</span>&lt;<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">setInterval</span>&gt; | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">startTime</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">config: Partial&lt;WhiteScreenConfig&gt; = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = {
      <span class="hljs-attr">skeletonSelector</span>: config.<span class="hljs-property">skeletonSelector</span> ?? <span class="hljs-string">'.skeleton, [data-skeleton], .loading-skeleton'</span>,
      <span class="hljs-attr">timeout</span>: config.<span class="hljs-property">timeout</span> ?? <span class="hljs-number">10000</span>,
      <span class="hljs-attr">checkInterval</span>: <span class="hljs-number">500</span>
    };
  }
  
  <span class="hljs-comment">/**
   * æ£€æµ‹éª¨æ¶å±çŠ¶æ€
   */</span>
  <span class="hljs-title function_">detect</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">SkeletonResult</span>&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">startTime</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
      
      <span class="hljs-comment">// é¦–å…ˆæ£€æŸ¥éª¨æ¶å±æ˜¯å¦å­˜åœ¨</span>
      <span class="hljs-keyword">const</span> skeletonExists = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isSkeletonPresent</span>();
      
      <span class="hljs-keyword">if</span> (!skeletonExists) {
        <span class="hljs-comment">// éª¨æ¶å±ä¸å­˜åœ¨ï¼Œå¯èƒ½å·²ç»åŠ è½½å®Œæˆæˆ–æ ¹æœ¬æ²¡æœ‰éª¨æ¶å±</span>
        <span class="hljs-title function_">resolve</span>({
          <span class="hljs-attr">skeletonExists</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">skeletonRemoved</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">detectionTime</span>: <span class="hljs-number">0</span>
        });
        <span class="hljs-keyword">return</span>;
      }
      
      <span class="hljs-comment">// å¼€å§‹å®šæœŸæ£€æŸ¥éª¨æ¶å±æ˜¯å¦æ¶ˆå¤±</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">intervalId</span> = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-keyword">const</span> elapsed = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - <span class="hljs-variable language_">this</span>.<span class="hljs-property">startTime</span>;
        
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isSkeletonPresent</span>()) {
          <span class="hljs-comment">// éª¨æ¶å±å·²æ¶ˆå¤±</span>
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">stop</span>();
          <span class="hljs-title function_">resolve</span>({
            <span class="hljs-attr">skeletonExists</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">skeletonRemoved</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">detectionTime</span>: elapsed
          });
          <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-keyword">if</span> (elapsed &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">timeout</span>) {
          <span class="hljs-comment">// è¶…æ—¶ï¼Œéª¨æ¶å±ä»ç„¶å­˜åœ¨</span>
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">stop</span>();
          <span class="hljs-title function_">resolve</span>({
            <span class="hljs-attr">skeletonExists</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">skeletonRemoved</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">detectionTime</span>: elapsed
          });
        }
      }, <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">checkInterval</span>);
    });
  }
  
  <span class="hljs-comment">/**
   * æ£€æŸ¥éª¨æ¶å±æ˜¯å¦å­˜åœ¨
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">isSkeletonPresent</span>(): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">const</span> { skeletonSelector } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>;
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> selectors = skeletonSelector.<span class="hljs-title function_">split</span>(<span class="hljs-string">','</span>).<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">s</span> =&gt;</span> s.<span class="hljs-title function_">trim</span>());
      
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> selector <span class="hljs-keyword">of</span> selectors) {
        <span class="hljs-keyword">const</span> elements = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(selector);
        
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> element <span class="hljs-keyword">of</span> elements) {
          <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isElementVisible</span>(element)) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
          }
        }
      }
      
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    } <span class="hljs-keyword">catch</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }
  
  <span class="hljs-comment">/**
   * åœæ­¢æ£€æµ‹
   */</span>
  <span class="hljs-title function_">stop</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">intervalId</span>) {
      <span class="hljs-built_in">clearInterval</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">intervalId</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">intervalId</span> = <span class="hljs-literal">null</span>;
    }
  }
  
  <span class="hljs-comment">/**
   * è·å–æ‰€æœ‰éª¨æ¶å±å…ƒç´ 
   */</span>
  <span class="hljs-title function_">getSkeletonElements</span>(): <span class="hljs-title class_">Element</span>[] {
    <span class="hljs-keyword">const</span> { skeletonSelector } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>;
    <span class="hljs-keyword">const</span> <span class="hljs-attr">elements</span>: <span class="hljs-title class_">Element</span>[] = [];
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> selectors = skeletonSelector.<span class="hljs-title function_">split</span>(<span class="hljs-string">','</span>).<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">s</span> =&gt;</span> s.<span class="hljs-title function_">trim</span>());
      
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> selector <span class="hljs-keyword">of</span> selectors) {
        <span class="hljs-keyword">const</span> found = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(selector);
        elements.<span class="hljs-title function_">push</span>(...<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(found));
      }
    } <span class="hljs-keyword">catch</span> {
      <span class="hljs-comment">// é€‰æ‹©å™¨æ— æ•ˆ</span>
    }
    
    <span class="hljs-keyword">return</span> elements;
  }
}

<span class="hljs-comment">// ==================== Performance API æ£€æµ‹å™¨ ====================</span>

<span class="hljs-comment">/**
 * Performance API æ£€æµ‹å™¨ç±»
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PerformanceDetector</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">config</span>: {
    <span class="hljs-attr">fcpThreshold</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">lcpThreshold</span>: <span class="hljs-built_in">number</span>;
  };
  
  <span class="hljs-keyword">private</span> <span class="hljs-attr">lcpObserver</span>: <span class="hljs-title class_">PerformanceObserver</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">lcpValue</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">config: Partial&lt;WhiteScreenConfig&gt; = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = {
      <span class="hljs-attr">fcpThreshold</span>: <span class="hljs-number">3000</span>,
      <span class="hljs-attr">lcpThreshold</span>: <span class="hljs-number">4000</span>
    };
  }
  
  <span class="hljs-comment">/**
   * åˆå§‹åŒ– LCP è§‚å¯Ÿå™¨
   */</span>
  <span class="hljs-title function_">initLCPObserver</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">lcpObserver</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PerformanceObserver</span>(<span class="hljs-function">(<span class="hljs-params">entryList</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> entries = entryList.<span class="hljs-title function_">getEntries</span>();
        <span class="hljs-keyword">if</span> (entries.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">const</span> lastEntry = entries[entries.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>] <span class="hljs-keyword">as</span> <span class="hljs-title class_">PerformanceEntry</span> &amp; { <span class="hljs-attr">startTime</span>: <span class="hljs-built_in">number</span> };
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">lcpValue</span> = lastEntry.<span class="hljs-property">startTime</span>;
        }
      });
      
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">lcpObserver</span>.<span class="hljs-title function_">observe</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'largest-contentful-paint'</span>, <span class="hljs-attr">buffered</span>: <span class="hljs-literal">true</span> });
    } <span class="hljs-keyword">catch</span> {
      <span class="hljs-comment">// LCP è§‚å¯Ÿå™¨å¯èƒ½ä¸è¢«æ”¯æŒ</span>
    }
  }
  
  <span class="hljs-comment">/**
   * è·å–æ€§èƒ½æŒ‡æ ‡
   */</span>
  <span class="hljs-title function_">getMetrics</span>(): <span class="hljs-title class_">PerformanceData</span> {
    <span class="hljs-keyword">const</span> data = <span class="hljs-title function_">getPerformanceData</span>();
    
    <span class="hljs-comment">// æ·»åŠ  LCP</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">lcpValue</span> &gt; <span class="hljs-number">0</span>) {
      data.<span class="hljs-property">largestContentfulPaint</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">lcpValue</span>;
    }
    
    <span class="hljs-keyword">return</span> data;
  }
  
  <span class="hljs-comment">/**
   * åˆ¤æ–­æ˜¯å¦å¯èƒ½ç™½å±ï¼ˆåŸºäºæ€§èƒ½æŒ‡æ ‡ï¼‰
   */</span>
  <span class="hljs-title function_">isPotentialWhiteScreen</span>(): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">const</span> metrics = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getMetrics</span>();
    
    <span class="hljs-comment">// å¦‚æœ FCP è¶…è¿‡é˜ˆå€¼ï¼Œå¯èƒ½æ˜¯ç™½å±</span>
    <span class="hljs-keyword">if</span> (metrics.<span class="hljs-property">firstContentfulPaint</span> &amp;&amp; metrics.<span class="hljs-property">firstContentfulPaint</span> &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">fcpThreshold</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-comment">// å¦‚æœ LCP è¶…è¿‡é˜ˆå€¼ï¼Œå¯èƒ½æœ‰é—®é¢˜</span>
    <span class="hljs-keyword">if</span> (metrics.<span class="hljs-property">largestContentfulPaint</span> &amp;&amp; metrics.<span class="hljs-property">largestContentfulPaint</span> &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">lcpThreshold</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }
  
  <span class="hljs-comment">/**
   * è·å–èµ„æºåŠ è½½ç»Ÿè®¡
   */</span>
  <span class="hljs-title function_">getResourceStats</span>(): {
    <span class="hljs-attr">totalResources</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">failedResources</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">slowResources</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">resourceDetails</span>: {
      <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
      <span class="hljs-attr">type</span>: <span class="hljs-built_in">string</span>;
      <span class="hljs-attr">duration</span>: <span class="hljs-built_in">number</span>;
      <span class="hljs-attr">size</span>: <span class="hljs-built_in">number</span>;
      <span class="hljs-attr">failed</span>: <span class="hljs-built_in">boolean</span>;
    }[];
  } {
    <span class="hljs-keyword">const</span> resources = performance.<span class="hljs-title function_">getEntriesByType</span>(<span class="hljs-string">'resource'</span>) <span class="hljs-keyword">as</span> <span class="hljs-title class_">PerformanceResourceTiming</span>[];
    <span class="hljs-keyword">const</span> <span class="hljs-attr">resourceDetails</span>: {
      <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
      <span class="hljs-attr">type</span>: <span class="hljs-built_in">string</span>;
      <span class="hljs-attr">duration</span>: <span class="hljs-built_in">number</span>;
      <span class="hljs-attr">size</span>: <span class="hljs-built_in">number</span>;
      <span class="hljs-attr">failed</span>: <span class="hljs-built_in">boolean</span>;
    }[] = [];
    
    <span class="hljs-keyword">let</span> failedResources = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> slowResources = <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> resource <span class="hljs-keyword">of</span> resources) {
      <span class="hljs-keyword">const</span> failed = resource.<span class="hljs-property">transferSize</span> === <span class="hljs-number">0</span> &amp;&amp; resource.<span class="hljs-property">decodedBodySize</span> === <span class="hljs-number">0</span>;
      <span class="hljs-keyword">const</span> slow = resource.<span class="hljs-property">duration</span> &gt; <span class="hljs-number">2000</span>;
      
      <span class="hljs-keyword">if</span> (failed) failedResources++;
      <span class="hljs-keyword">if</span> (slow) slowResources++;
      
      resourceDetails.<span class="hljs-title function_">push</span>({
        <span class="hljs-attr">name</span>: resource.<span class="hljs-property">name</span>,
        <span class="hljs-attr">type</span>: resource.<span class="hljs-property">initiatorType</span>,
        <span class="hljs-attr">duration</span>: resource.<span class="hljs-property">duration</span>,
        <span class="hljs-attr">size</span>: resource.<span class="hljs-property">transferSize</span> || <span class="hljs-number">0</span>,
        failed
      });
    }
    
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">totalResources</span>: resources.<span class="hljs-property">length</span>,
      failedResources,
      slowResources,
      resourceDetails
    };
  }
  
  <span class="hljs-comment">/**
   * åœæ­¢è§‚å¯Ÿ
   */</span>
  <span class="hljs-title function_">stop</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">lcpObserver</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">lcpObserver</span>.<span class="hljs-title function_">disconnect</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">lcpObserver</span> = <span class="hljs-literal">null</span>;
    }
  }
}

<span class="hljs-comment">// ==================== é”™è¯¯ç›‘å¬å™¨ ====================</span>

<span class="hljs-comment">/**
 * é”™è¯¯ç›‘å¬å™¨ç±»
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ErrorMonitor</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">errors</span>: <span class="hljs-title class_">ErrorInfo</span>[] = [];
  <span class="hljs-keyword">private</span> <span class="hljs-attr">maxErrors</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">50</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">listeners</span>: {
    <span class="hljs-attr">error</span>: <span class="hljs-function">(<span class="hljs-params">event: ErrorEvent</span>) =&gt;</span> <span class="hljs-built_in">void</span>;
    <span class="hljs-attr">unhandledrejection</span>: <span class="hljs-function">(<span class="hljs-params">event: PromiseRejectionEvent</span>) =&gt;</span> <span class="hljs-built_in">void</span>;
  };
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span> = {
      <span class="hljs-attr">error</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleError</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>),
      <span class="hljs-attr">unhandledrejection</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleUnhandledRejection</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>)
    };
  }
  
  <span class="hljs-comment">/**
   * å¼€å§‹ç›‘å¬
   */</span>
  <span class="hljs-title function_">start</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'error'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-property">error</span>, <span class="hljs-literal">true</span>);
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'unhandledrejection'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-property">unhandledrejection</span>);
  }
  
  <span class="hljs-comment">/**
   * åœæ­¢ç›‘å¬
   */</span>
  <span class="hljs-title function_">stop</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'error'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-property">error</span>, <span class="hljs-literal">true</span>);
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'unhandledrejection'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-property">unhandledrejection</span>);
  }
  
  <span class="hljs-comment">/**
   * å¤„ç†é”™è¯¯äº‹ä»¶
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">handleError</span>(<span class="hljs-attr">event</span>: <span class="hljs-title class_">ErrorEvent</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">errors</span>.<span class="hljs-property">length</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxErrors</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">errors</span>.<span class="hljs-title function_">push</span>({
      <span class="hljs-attr">message</span>: event.<span class="hljs-property">message</span> || <span class="hljs-string">'Unknown error'</span>,
      <span class="hljs-attr">stack</span>: event.<span class="hljs-property">error</span>?.<span class="hljs-property">stack</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'error'</span>
    });
  }
  
  <span class="hljs-comment">/**
   * å¤„ç†æœªå¤„ç†çš„ Promise æ‹’ç»
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">handleUnhandledRejection</span>(<span class="hljs-attr">event</span>: <span class="hljs-title class_">PromiseRejectionEvent</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">errors</span>.<span class="hljs-property">length</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxErrors</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-keyword">let</span> message = <span class="hljs-string">'Unhandled Promise rejection'</span>;
    <span class="hljs-keyword">let</span> <span class="hljs-attr">stack</span>: <span class="hljs-built_in">string</span> | <span class="hljs-literal">undefined</span>;
    
    <span class="hljs-keyword">if</span> (event.<span class="hljs-property">reason</span> <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Error</span>) {
      message = event.<span class="hljs-property">reason</span>.<span class="hljs-property">message</span>;
      stack = event.<span class="hljs-property">reason</span>.<span class="hljs-property">stack</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> event.<span class="hljs-property">reason</span> === <span class="hljs-string">'string'</span>) {
      message = event.<span class="hljs-property">reason</span>;
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">errors</span>.<span class="hljs-title function_">push</span>({
      message,
      stack,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'unhandledrejection'</span>
    });
  }
  
  <span class="hljs-comment">/**
   * è·å–æ‰€æœ‰é”™è¯¯
   */</span>
  <span class="hljs-title function_">getErrors</span>(): <span class="hljs-title class_">ErrorInfo</span>[] {
    <span class="hljs-keyword">return</span> [...<span class="hljs-variable language_">this</span>.<span class="hljs-property">errors</span>];
  }
  
  <span class="hljs-comment">/**
   * åˆ¤æ–­æ˜¯å¦æœ‰å…³é”®é”™è¯¯
   */</span>
  <span class="hljs-title function_">hasCriticalErrors</span>(): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰å¯èƒ½å¯¼è‡´ç™½å±çš„é”™è¯¯</span>
    <span class="hljs-keyword">const</span> criticalPatterns = [
      <span class="hljs-regexp">/chunk.*failed/i</span>,
      <span class="hljs-regexp">/loading.*chunk/i</span>,
      <span class="hljs-regexp">/script.*error/i</span>,
      <span class="hljs-regexp">/syntaxerror/i</span>,
      <span class="hljs-regexp">/referenceerror/i</span>,
      <span class="hljs-regexp">/cannot read/i</span>,
      <span class="hljs-regexp">/is not defined/i</span>,
      <span class="hljs-regexp">/unexpected token/i</span>
    ];
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> error <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">errors</span>) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> pattern <span class="hljs-keyword">of</span> criticalPatterns) {
        <span class="hljs-keyword">if</span> (pattern.<span class="hljs-title function_">test</span>(error.<span class="hljs-property">message</span>)) {
          <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
      }
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }
  
  <span class="hljs-comment">/**
   * æ¸…é™¤é”™è¯¯
   */</span>
  <span class="hljs-title function_">clear</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">errors</span> = [];
  }
}

<span class="hljs-comment">// ==================== æ•°æ®ä¸ŠæŠ¥å™¨ ====================</span>

<span class="hljs-comment">/**
 * æ•°æ®ä¸ŠæŠ¥å™¨ç±»
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Reporter</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">config</span>: {
    endpoint?: <span class="hljs-built_in">string</span>;
    <span class="hljs-attr">enableConsole</span>: <span class="hljs-built_in">boolean</span>;
    <span class="hljs-attr">enableBeacon</span>: <span class="hljs-built_in">boolean</span>;
    <span class="hljs-attr">sampleRate</span>: <span class="hljs-built_in">number</span>;
    customHeaders?: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;;
  };
  
  <span class="hljs-keyword">private</span> <span class="hljs-attr">queue</span>: <span class="hljs-title class_">WhiteScreenReport</span>[] = [];
  <span class="hljs-keyword">private</span> <span class="hljs-attr">maxQueueSize</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">10</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">isFlushing</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">config: {
    endpoint?: <span class="hljs-built_in">string</span>;
    enableConsole?: <span class="hljs-built_in">boolean</span>;
    enableBeacon?: <span class="hljs-built_in">boolean</span>;
    sampleRate?: <span class="hljs-built_in">number</span>;
    customHeaders?: Record&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;;
  } = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = {
      <span class="hljs-attr">endpoint</span>: config.<span class="hljs-property">endpoint</span>,
      <span class="hljs-attr">enableConsole</span>: config.<span class="hljs-property">enableConsole</span> ?? <span class="hljs-literal">true</span>,
      <span class="hljs-attr">enableBeacon</span>: config.<span class="hljs-property">enableBeacon</span> ?? <span class="hljs-literal">true</span>,
      <span class="hljs-attr">sampleRate</span>: config.<span class="hljs-property">sampleRate</span> ?? <span class="hljs-number">1</span>,
      <span class="hljs-attr">customHeaders</span>: config.<span class="hljs-property">customHeaders</span>
    };
    
    <span class="hljs-comment">// é¡µé¢å¸è½½æ—¶å‘é€é˜Ÿåˆ—ä¸­çš„æ•°æ®</span>
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'beforeunload'</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">flush</span>();
    });
    
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'pagehide'</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">flush</span>();
    });
  }
  
  <span class="hljs-comment">/**
   * ä¸ŠæŠ¥æ•°æ®
   */</span>
  <span class="hljs-title function_">report</span>(<span class="hljs-attr">data</span>: <span class="hljs-title class_">WhiteScreenReport</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-comment">// é‡‡æ ·</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">sampleRate</span>) {
      <span class="hljs-keyword">return</span>;
    }
    
    <span class="hljs-comment">// æ§åˆ¶å°è¾“å‡º</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">enableConsole</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">logToConsole</span>(data);
    }
    
    <span class="hljs-comment">// åŠ å…¥é˜Ÿåˆ—</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-title function_">push</span>(data);
    
    <span class="hljs-comment">// é˜Ÿåˆ—æ»¡äº†å°±å‘é€</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-property">length</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxQueueSize</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">flush</span>();
    }
    
    <span class="hljs-comment">// ä¹Ÿå¯ä»¥ç«‹å³å‘é€ï¼ˆé’ˆå¯¹ç™½å±è¿™ç§é‡è¦äº‹ä»¶ï¼‰</span>
    <span class="hljs-keyword">if</span> (data.<span class="hljs-property">isWhiteScreen</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">flush</span>();
    }
  }
  
  <span class="hljs-comment">/**
   * å‘é€é˜Ÿåˆ—ä¸­çš„æ•°æ®
   */</span>
  <span class="hljs-title function_">flush</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isFlushing</span> || <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isFlushing</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">const</span> dataToSend = [...<span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span> = [];
    
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">endpoint</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">sendData</span>(dataToSend);
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isFlushing</span> = <span class="hljs-literal">false</span>;
  }
  
  <span class="hljs-comment">/**
   * å‘é€æ•°æ®
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">sendData</span>(<span class="hljs-attr">data</span>: <span class="hljs-title class_">WhiteScreenReport</span>[]): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">const</span> payload = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data);
    
    <span class="hljs-comment">// ä¼˜å…ˆä½¿ç”¨ Beacon API</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">enableBeacon</span> &amp;&amp; navigator.<span class="hljs-property">sendBeacon</span>) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> blob = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Blob</span>([payload], { <span class="hljs-attr">type</span>: <span class="hljs-string">'application/json'</span> });
        <span class="hljs-keyword">const</span> success = navigator.<span class="hljs-title function_">sendBeacon</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">endpoint</span>!, blob);
        <span class="hljs-keyword">if</span> (success) <span class="hljs-keyword">return</span>;
      } <span class="hljs-keyword">catch</span> {
        <span class="hljs-comment">// Beacon å¤±è´¥ï¼Œé™çº§åˆ° fetch</span>
      }
    }
    
    <span class="hljs-comment">// é™çº§ä½¿ç”¨ fetch</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">sendWithFetch</span>(payload);
  }
  
  <span class="hljs-comment">/**
   * ä½¿ç”¨ fetch å‘é€
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">sendWithFetch</span>(<span class="hljs-attr">payload</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">endpoint</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-keyword">const</span> <span class="hljs-attr">headers</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt; = {
      <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
      ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">customHeaders</span>
    };
    
    <span class="hljs-title function_">fetch</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">endpoint</span>, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
      headers,
      <span class="hljs-attr">body</span>: payload,
      <span class="hljs-attr">keepalive</span>: <span class="hljs-literal">true</span>
    }).<span class="hljs-keyword">catch</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// é™é»˜å¤±è´¥</span>
    });
  }
  
  <span class="hljs-comment">/**
   * æ§åˆ¶å°è¾“å‡º
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">logToConsole</span>(<span class="hljs-attr">data</span>: <span class="hljs-title class_">WhiteScreenReport</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">const</span> prefix = <span class="hljs-string">'[WhiteScreen]'</span>;
    
    <span class="hljs-keyword">if</span> (data.<span class="hljs-property">isWhiteScreen</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(
        <span class="hljs-string">`<span class="hljs-subst">${prefix}</span> æ£€æµ‹åˆ°ç™½å±ï¼`</span>,
        <span class="hljs-string">'\næ–¹æ³•:'</span>, data.<span class="hljs-property">detectionMethod</span>,
        <span class="hljs-string">'\nURL:'</span>, data.<span class="hljs-property">url</span>,
        <span class="hljs-string">'\næ—¶é—´:'</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(data.<span class="hljs-property">timestamp</span>).<span class="hljs-title function_">toISOString</span>(),
        <span class="hljs-string">'\nè¯¦æƒ…:'</span>, data
      );
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
        <span class="hljs-string">`<span class="hljs-subst">${prefix}</span> é¡µé¢æ­£å¸¸`</span>,
        <span class="hljs-string">'\næ–¹æ³•:'</span>, data.<span class="hljs-property">detectionMethod</span>,
        <span class="hljs-string">'\nè€—æ—¶:'</span>, <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - data.<span class="hljs-property">timestamp</span>, <span class="hljs-string">'ms'</span>
      );
    }
  }
  
  <span class="hljs-comment">/**
   * è®¾ç½®ä¸ŠæŠ¥ç«¯ç‚¹
   */</span>
  <span class="hljs-title function_">setEndpoint</span>(<span class="hljs-attr">endpoint</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">endpoint</span> = endpoint;
  }
  
  <span class="hljs-comment">/**
   * è®¾ç½®é‡‡æ ·ç‡
   */</span>
  <span class="hljs-title function_">setSampleRate</span>(<span class="hljs-attr">rate</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">sampleRate</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(<span class="hljs-number">1</span>, rate));
  }
}

<span class="hljs-comment">// ==================== ä¸» SDK ç±» ====================</span>

<span class="hljs-comment">/**
 * ç™½å±æ£€æµ‹ SDK ä¸»ç±»
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">WhiteScreenSDK</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">config</span>: <span class="hljs-title class_">Required</span>&lt;<span class="hljs-title class_">WhiteScreenConfig</span>&gt;;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">samplingDetector</span>: <span class="hljs-title class_">SamplingDetector</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">domDetector</span>: <span class="hljs-title class_">DOMDetector</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">mutationDetector</span>: <span class="hljs-title class_">MutationDetector</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">screenshotDetector</span>: <span class="hljs-title class_">ScreenshotDetector</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">skeletonDetector</span>: <span class="hljs-title class_">SkeletonDetector</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">performanceDetector</span>: <span class="hljs-title class_">PerformanceDetector</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">errorMonitor</span>: <span class="hljs-title class_">ErrorMonitor</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">reporter</span>: <span class="hljs-title class_">Reporter</span>;
  
  <span class="hljs-keyword">private</span> <span class="hljs-attr">isInitialized</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">isDetecting</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">detectionCount</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">lastDetectionTime</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
  
  <span class="hljs-comment">// é»˜è®¤é…ç½®</span>
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-attr">defaultConfig</span>: <span class="hljs-title class_">Required</span>&lt;<span class="hljs-title class_">WhiteScreenConfig</span>&gt; = {
    <span class="hljs-attr">samplingPoints</span>: <span class="hljs-number">17</span>,
    <span class="hljs-attr">delay</span>: <span class="hljs-number">1000</span>,
    <span class="hljs-attr">timeout</span>: <span class="hljs-number">10000</span>,
    <span class="hljs-attr">threshold</span>: <span class="hljs-number">0.95</span>,
    <span class="hljs-attr">enableDOMDetection</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">enableSamplingDetection</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">enableMutationDetection</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">enableScreenshotDetection</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">enableSkeletonDetection</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">skeletonSelector</span>: <span class="hljs-string">'.skeleton, [data-skeleton], .loading-skeleton'</span>,
    <span class="hljs-attr">keyElementSelectors</span>: [<span class="hljs-string">'#app'</span>, <span class="hljs-string">'#root'</span>, <span class="hljs-string">'.app'</span>, <span class="hljs-string">'main'</span>],
    <span class="hljs-attr">ignoreSelectors</span>: [<span class="hljs-string">'script'</span>, <span class="hljs-string">'style'</span>, <span class="hljs-string">'link'</span>, <span class="hljs-string">'meta'</span>],
    <span class="hljs-attr">container</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">onReport</span>: <span class="hljs-function">() =&gt;</span> {},
    <span class="hljs-attr">onDetectionComplete</span>: <span class="hljs-function">() =&gt;</span> {},
    <span class="hljs-attr">enableInDev</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">maxRetries</span>: <span class="hljs-number">3</span>,
    <span class="hljs-attr">retryInterval</span>: <span class="hljs-number">1000</span>,
    <span class="hljs-attr">customDetector</span>: <span class="hljs-literal">undefined</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">unknown</span> <span class="hljs-keyword">as</span> () =&gt; <span class="hljs-built_in">boolean</span>
  };
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">config: Partial&lt;WhiteScreenConfig&gt; = {}</span>) {
    <span class="hljs-comment">// åˆå¹¶é…ç½®</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = <span class="hljs-title function_">deepMerge</span>(<span class="hljs-title class_">WhiteScreenSDK</span>.<span class="hljs-property">defaultConfig</span>, config);
    
    <span class="hljs-comment">// åˆå§‹åŒ–å„ä¸ªæ£€æµ‹å™¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">samplingDetector</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SamplingDetector</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">domDetector</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMDetector</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">mutationDetector</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutationDetector</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">screenshotDetector</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ScreenshotDetector</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">skeletonDetector</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SkeletonDetector</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">performanceDetector</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PerformanceDetector</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">errorMonitor</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ErrorMonitor</span>();
    
    <span class="hljs-comment">// åˆå§‹åŒ–ä¸ŠæŠ¥å™¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reporter</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Reporter</span>({
      <span class="hljs-attr">enableConsole</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">enableBeacon</span>: <span class="hljs-literal">true</span>
    });
  }
  
  <span class="hljs-comment">/**
   * åˆå§‹åŒ– SDK
   */</span>
  <span class="hljs-title function_">init</span>(): <span class="hljs-title class_">WhiteScreenSDK</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isInitialized</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'[WhiteScreenSDK] Already initialized'</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦åœ¨å¼€å‘ç¯å¢ƒ</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">enableInDev</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isDevelopment</span>()) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'[WhiteScreenSDK] Disabled in development environment'</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
    
    <span class="hljs-comment">// å¼€å§‹é”™è¯¯ç›‘å¬</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">errorMonitor</span>.<span class="hljs-title function_">start</span>();
    
    <span class="hljs-comment">// åˆå§‹åŒ–æ€§èƒ½æ£€æµ‹å™¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">performanceDetector</span>.<span class="hljs-title function_">initLCPObserver</span>();
    
    <span class="hljs-comment">// åœ¨é¡µé¢åŠ è½½å®Œæˆåå¼€å§‹æ£€æµ‹</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-property">readyState</span> === <span class="hljs-string">'complete'</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">scheduleDetection</span>();
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'load'</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">scheduleDetection</span>();
      });
    }
    
    <span class="hljs-comment">// ç›‘å¬é¡µé¢å¯è§æ€§å˜åŒ–</span>
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'visibilitychange'</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-property">visibilityState</span> === <span class="hljs-string">'visible'</span> &amp;&amp; !<span class="hljs-variable language_">this</span>.<span class="hljs-property">isDetecting</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">scheduleDetection</span>();
      }
    });
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isInitialized</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'[WhiteScreenSDK] Initialized'</span>);
    
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }
  
  <span class="hljs-comment">/**
   * åˆ¤æ–­æ˜¯å¦ä¸ºå¼€å‘ç¯å¢ƒ
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">isDevelopment</span>(): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">return</span> (
      <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">hostname</span> === <span class="hljs-string">'localhost'</span> ||
      <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">hostname</span> === <span class="hljs-string">'127.0.0.1'</span> ||
      <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">hostname</span>.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'.local'</span>) ||
      <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">port</span> !== <span class="hljs-string">''</span>
    );
  }
  
  <span class="hljs-comment">/**
   * è°ƒåº¦æ£€æµ‹
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">scheduleDetection</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">detect</span>();
    }, <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">delay</span>);
  }
  
  <span class="hljs-comment">/**
   * æ‰§è¡Œæ£€æµ‹
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">detect</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">DetectionResult</span>&gt; {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isDetecting</span>) {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">isWhiteScreen</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">confidence</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">methods</span>: [],
        <span class="hljs-attr">methodResults</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(),
        <span class="hljs-attr">basis</span>: <span class="hljs-string">'Already detecting'</span>
      };
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDetecting</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">detectionCount</span>++;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lastDetectionTime</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    
    <span class="hljs-keyword">const</span> methodResults = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">DetectionMethod</span>, <span class="hljs-built_in">boolean</span>&gt;();
    <span class="hljs-keyword">const</span> <span class="hljs-attr">usedMethods</span>: <span class="hljs-title class_">DetectionMethod</span>[] = [];
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// æ‰§è¡Œå„ç§æ£€æµ‹æ–¹æ³•</span>
      
      <span class="hljs-comment">// 1. é‡‡æ ·ç‚¹æ£€æµ‹</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">enableSamplingDetection</span>) {
        <span class="hljs-keyword">const</span> samplingResult = <span class="hljs-variable language_">this</span>.<span class="hljs-property">samplingDetector</span>.<span class="hljs-title function_">detect</span>();
        <span class="hljs-keyword">const</span> isWhite = <span class="hljs-variable language_">this</span>.<span class="hljs-property">samplingDetector</span>.<span class="hljs-title function_">isWhiteScreen</span>(samplingResult);
        methodResults.<span class="hljs-title function_">set</span>(<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">SAMPLING</span>, isWhite);
        usedMethods.<span class="hljs-title function_">push</span>(<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">SAMPLING</span>);
      }
      
      <span class="hljs-comment">// 2. DOM æ£€æµ‹</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">enableDOMDetection</span>) {
        <span class="hljs-keyword">const</span> domResult = <span class="hljs-variable language_">this</span>.<span class="hljs-property">domDetector</span>.<span class="hljs-title function_">detect</span>();
        <span class="hljs-keyword">const</span> isWhite = !domResult.<span class="hljs-property">passed</span> || !<span class="hljs-variable language_">this</span>.<span class="hljs-property">domDetector</span>.<span class="hljs-title function_">hasValidContent</span>();
        methodResults.<span class="hljs-title function_">set</span>(<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">DOM</span>, isWhite);
        usedMethods.<span class="hljs-title function_">push</span>(<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">DOM</span>);
      }
      
      <span class="hljs-comment">// 3. éª¨æ¶å±æ£€æµ‹</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">enableSkeletonDetection</span>) {
        <span class="hljs-keyword">const</span> skeletonResult = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">skeletonDetector</span>.<span class="hljs-title function_">detect</span>();
        <span class="hljs-keyword">const</span> isWhite = skeletonResult.<span class="hljs-property">skeletonExists</span> &amp;&amp; !skeletonResult.<span class="hljs-property">skeletonRemoved</span>;
        methodResults.<span class="hljs-title function_">set</span>(<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">SKELETON</span>, isWhite);
        usedMethods.<span class="hljs-title function_">push</span>(<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">SKELETON</span>);
      }
      
      <span class="hljs-comment">// 4. æˆªå›¾æ£€æµ‹ï¼ˆè¾ƒæ…¢ï¼Œå¯é€‰ï¼‰</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">enableScreenshotDetection</span>) {
        <span class="hljs-keyword">const</span> screenshotResult = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">screenshotDetector</span>.<span class="hljs-title function_">detect</span>();
        methodResults.<span class="hljs-title function_">set</span>(<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">SCREENSHOT</span>, screenshotResult.<span class="hljs-property">isWhiteScreen</span>);
        usedMethods.<span class="hljs-title function_">push</span>(<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">SCREENSHOT</span>);
      }
      
      <span class="hljs-comment">// 5. è‡ªå®šä¹‰æ£€æµ‹å™¨</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">customDetector</span>) {
        <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">const</span> customResult = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-title function_">customDetector</span>();
          methodResults.<span class="hljs-title function_">set</span>(<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">CUSTOM</span>, customResult);
          usedMethods.<span class="hljs-title function_">push</span>(<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">CUSTOM</span>);
        } <span class="hljs-keyword">catch</span> {
          <span class="hljs-comment">// è‡ªå®šä¹‰æ£€æµ‹å™¨å¤±è´¥</span>
        }
      }
      
      <span class="hljs-comment">// ç»¼åˆåˆ¤æ–­</span>
      <span class="hljs-keyword">const</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">combineResults</span>(methodResults, usedMethods);
      
      <span class="hljs-comment">// ç”ŸæˆæŠ¥å‘Š</span>
      <span class="hljs-keyword">const</span> report = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateReport</span>(result, methodResults);
      
      <span class="hljs-comment">// ä¸ŠæŠ¥</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">reporter</span>.<span class="hljs-title function_">report</span>(report);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-title function_">onReport</span>(report);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-title function_">onDetectionComplete</span>(result);
      
      <span class="hljs-comment">// å¦‚æœæ£€æµ‹åˆ°ç™½å±ï¼Œå¯èƒ½éœ€è¦é‡è¯•</span>
      <span class="hljs-keyword">if</span> (result.<span class="hljs-property">isWhiteScreen</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">detectionCount</span> &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">maxRetries</span>) {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDetecting</span> = <span class="hljs-literal">false</span>;
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">detect</span>();
        }, <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">retryInterval</span>);
      }
      
      <span class="hljs-keyword">return</span> result;
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[WhiteScreenSDK] Detection error:'</span>, error);
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">isWhiteScreen</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">confidence</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">methods</span>: usedMethods,
        methodResults,
        <span class="hljs-attr">basis</span>: <span class="hljs-string">`Error: <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> <span class="hljs-built_in">Error</span>).message}</span>`</span>
      };
    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDetecting</span> = <span class="hljs-literal">false</span>;
    }
  }
  
  <span class="hljs-comment">/**
   * ç»¼åˆå„æ–¹æ³•ç»“æœ
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">combineResults</span>(
    <span class="hljs-attr">methodResults</span>: <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">DetectionMethod</span>, <span class="hljs-built_in">boolean</span>&gt;,
    <span class="hljs-attr">usedMethods</span>: <span class="hljs-title class_">DetectionMethod</span>[]
  ): <span class="hljs-title class_">DetectionResult</span> {
    <span class="hljs-keyword">if</span> (usedMethods.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">isWhiteScreen</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">confidence</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">methods</span>: [],
        methodResults,
        <span class="hljs-attr">basis</span>: <span class="hljs-string">'No detection methods enabled'</span>
      };
    }
    
    <span class="hljs-comment">// è®¡ç®—ç™½å±ç¥¨æ•°</span>
    <span class="hljs-keyword">let</span> whiteVotes = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> totalVotes = <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// ä¸åŒæ–¹æ³•çš„æƒé‡</span>
    <span class="hljs-keyword">const</span> <span class="hljs-attr">weights</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-title class_">DetectionMethod</span>, <span class="hljs-built_in">number</span>&gt; = {
      [<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">SAMPLING</span>]: <span class="hljs-number">3</span>,
      [<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">DOM</span>]: <span class="hljs-number">2</span>,
      [<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">MUTATION</span>]: <span class="hljs-number">2</span>,
      [<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">SCREENSHOT</span>]: <span class="hljs-number">2</span>,
      [<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">SKELETON</span>]: <span class="hljs-number">1</span>,
      [<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">PERFORMANCE</span>]: <span class="hljs-number">1</span>,
      [<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">CUSTOM</span>]: <span class="hljs-number">2</span>,
      [<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">COMBINED</span>]: <span class="hljs-number">1</span>
    };
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> method <span class="hljs-keyword">of</span> usedMethods) {
      <span class="hljs-keyword">const</span> isWhite = methodResults.<span class="hljs-title function_">get</span>(method);
      <span class="hljs-keyword">const</span> weight = weights[method] || <span class="hljs-number">1</span>;
      
      totalVotes += weight;
      <span class="hljs-keyword">if</span> (isWhite) {
        whiteVotes += weight;
      }
    }
    
    <span class="hljs-comment">// è®¡ç®—ç½®ä¿¡åº¦</span>
    <span class="hljs-keyword">const</span> confidence = totalVotes &gt; <span class="hljs-number">0</span> ? <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(whiteVotes - totalVotes / <span class="hljs-number">2</span>) / (totalVotes / <span class="hljs-number">2</span>) : <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦ç™½å±ï¼ˆè¶…è¿‡åŠæ•°åŠ æƒæŠ•ç¥¨ï¼‰</span>
    <span class="hljs-keyword">const</span> isWhiteScreen = whiteVotes &gt; totalVotes / <span class="hljs-number">2</span>;
    
    <span class="hljs-comment">// ç¡®å®šåˆ¤å®šä¾æ®</span>
    <span class="hljs-keyword">let</span> basis = isWhiteScreen ? <span class="hljs-string">'Multiple methods indicate white screen'</span> : <span class="hljs-string">'Page appears normal'</span>;
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰å…³é”®é”™è¯¯</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">errorMonitor</span>.<span class="hljs-title function_">hasCriticalErrors</span>()) {
      basis += <span class="hljs-string">' (Critical JS errors detected)'</span>;
    }
    
    <span class="hljs-keyword">return</span> {
      isWhiteScreen,
      confidence,
      <span class="hljs-attr">methods</span>: usedMethods,
      methodResults,
      basis
    };
  }
  
  <span class="hljs-comment">/**
   * ç”ŸæˆæŠ¥å‘Š
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">generateReport</span>(
    <span class="hljs-attr">result</span>: <span class="hljs-title class_">DetectionResult</span>,
    <span class="hljs-attr">methodResults</span>: <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">DetectionMethod</span>, <span class="hljs-built_in">boolean</span>&gt;
  ): <span class="hljs-title class_">WhiteScreenReport</span> {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">report</span>: <span class="hljs-title class_">WhiteScreenReport</span> = {
      <span class="hljs-attr">isWhiteScreen</span>: result.<span class="hljs-property">isWhiteScreen</span>,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
      <span class="hljs-attr">url</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span>,
      <span class="hljs-attr">detectionMethod</span>: result.<span class="hljs-property">methods</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">1</span> ? <span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">COMBINED</span> : result.<span class="hljs-property">methods</span>[<span class="hljs-number">0</span>],
      <span class="hljs-attr">userAgent</span>: navigator.<span class="hljs-property">userAgent</span>,
      <span class="hljs-attr">viewport</span>: {
        <span class="hljs-attr">width</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span>,
        <span class="hljs-attr">height</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>
      },
      <span class="hljs-attr">devicePixelRatio</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">devicePixelRatio</span>,
      <span class="hljs-attr">networkInfo</span>: <span class="hljs-title function_">getNetworkInfo</span>(),
      <span class="hljs-attr">performanceData</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">performanceDetector</span>.<span class="hljs-title function_">getMetrics</span>()
    };
    
    <span class="hljs-comment">// æ·»åŠ é‡‡æ ·ç»“æœ</span>
    <span class="hljs-keyword">if</span> (methodResults.<span class="hljs-title function_">has</span>(<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">SAMPLING</span>)) {
      report.<span class="hljs-property">samplingResult</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">samplingDetector</span>.<span class="hljs-title function_">detect</span>();
    }
    
    <span class="hljs-comment">// æ·»åŠ  DOM æ£€æµ‹ç»“æœ</span>
    <span class="hljs-keyword">if</span> (methodResults.<span class="hljs-title function_">has</span>(<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">DOM</span>)) {
      report.<span class="hljs-property">domResult</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">domDetector</span>.<span class="hljs-title function_">detect</span>();
    }
    
    <span class="hljs-comment">// æ·»åŠ é”™è¯¯ä¿¡æ¯</span>
    <span class="hljs-keyword">const</span> errors = <span class="hljs-variable language_">this</span>.<span class="hljs-property">errorMonitor</span>.<span class="hljs-title function_">getErrors</span>();
    <span class="hljs-keyword">if</span> (errors.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      report.<span class="hljs-property">errorInfo</span> = errors[<span class="hljs-number">0</span>];
    }
    
    <span class="hljs-keyword">return</span> report;
  }
  
  <span class="hljs-comment">/**
   * æ‰‹åŠ¨è§¦å‘æ£€æµ‹
   */</span>
  <span class="hljs-title function_">manualDetect</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">DetectionResult</span>&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">detect</span>();
  }
  
  <span class="hljs-comment">/**
   * è®¾ç½®ä¸ŠæŠ¥å›è°ƒ
   */</span>
  <span class="hljs-title function_">setReportCallback</span>(<span class="hljs-attr">callback</span>: <span class="hljs-function">(<span class="hljs-params">data: WhiteScreenReport</span>) =&gt;</span> <span class="hljs-built_in">void</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">onReport</span> = callback;
  }
  
  <span class="hljs-comment">/**
   * è®¾ç½®æ£€æµ‹å®Œæˆå›è°ƒ
   */</span>
  <span class="hljs-title function_">setDetectionCompleteCallback</span>(<span class="hljs-attr">callback</span>: <span class="hljs-function">(<span class="hljs-params">result: DetectionResult</span>) =&gt;</span> <span class="hljs-built_in">void</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">onDetectionComplete</span> = callback;
  }
  
  <span class="hljs-comment">/**
   * è·å–æ£€æµ‹ç»Ÿè®¡
   */</span>
  <span class="hljs-title function_">getStats</span>(): {
    <span class="hljs-attr">detectionCount</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">lastDetectionTime</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">errors</span>: <span class="hljs-title class_">ErrorInfo</span>[];
    <span class="hljs-attr">performance</span>: <span class="hljs-title class_">PerformanceData</span>;
  } {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">detectionCount</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">detectionCount</span>,
      <span class="hljs-attr">lastDetectionTime</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">lastDetectionTime</span>,
      <span class="hljs-attr">errors</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">errorMonitor</span>.<span class="hljs-title function_">getErrors</span>(),
      <span class="hljs-attr">performance</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">performanceDetector</span>.<span class="hljs-title function_">getMetrics</span>()
    };
  }
  
  <span class="hljs-comment">/**
   * é”€æ¯ SDK
   */</span>
  <span class="hljs-title function_">destroy</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">errorMonitor</span>.<span class="hljs-title function_">stop</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">performanceDetector</span>.<span class="hljs-title function_">stop</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">skeletonDetector</span>.<span class="hljs-title function_">stop</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">screenshotDetector</span>.<span class="hljs-title function_">dispose</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isInitialized</span> = <span class="hljs-literal">false</span>;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'[WhiteScreenSDK] Destroyed'</span>);
  }
}

<span class="hljs-comment">// ==================== å¯¼å‡º ====================</span>

<span class="hljs-comment">// åˆ›å»ºå•ä¾‹</span>
<span class="hljs-keyword">let</span> <span class="hljs-attr">sdkInstance</span>: <span class="hljs-title class_">WhiteScreenSDK</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;

<span class="hljs-comment">/**
 * è·å– SDK å®ä¾‹ï¼ˆå•ä¾‹æ¨¡å¼ï¼‰
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getWhiteScreenSDK</span>(<span class="hljs-params">config?: Partial&lt;WhiteScreenConfig&gt;</span>): <span class="hljs-title class_">WhiteScreenSDK</span> {
  <span class="hljs-keyword">if</span> (!sdkInstance) {
    sdkInstance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WhiteScreenSDK</span>(config);
  }
  <span class="hljs-keyword">return</span> sdkInstance;
}

<span class="hljs-comment">/**
 * å¿«é€Ÿåˆå§‹åŒ–å¹¶è¿”å›å®ä¾‹
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">initWhiteScreenDetection</span>(<span class="hljs-params">config?: Partial&lt;WhiteScreenConfig&gt;</span>): <span class="hljs-title class_">WhiteScreenSDK</span> {
  <span class="hljs-keyword">const</span> sdk = <span class="hljs-title function_">getWhiteScreenSDK</span>(config);
  sdk.<span class="hljs-title function_">init</span>();
  <span class="hljs-keyword">return</span> sdk;
}

<span class="hljs-comment">// ES Module å¯¼å‡º</span>
<span class="hljs-keyword">export</span> {
  <span class="hljs-title class_">WhiteScreenSDK</span>,
  <span class="hljs-title class_">WhiteScreenConfig</span>,
  <span class="hljs-title class_">WhiteScreenReport</span>,
  <span class="hljs-title class_">DetectionMethod</span>,
  <span class="hljs-title class_">DetectionResult</span>,
  <span class="hljs-title class_">SamplingDetector</span>,
  <span class="hljs-title class_">DOMDetector</span>,
  <span class="hljs-title class_">MutationDetector</span>,
  <span class="hljs-title class_">ScreenshotDetector</span>,
  <span class="hljs-title class_">SkeletonDetector</span>,
  <span class="hljs-title class_">PerformanceDetector</span>,
  <span class="hljs-title class_">ErrorMonitor</span>,
  <span class="hljs-title class_">Reporter</span>,
  getWhiteScreenSDK,
  initWhiteScreenDetection
};

<span class="hljs-comment">// UMD å¯¼å‡ºï¼ˆå…¼å®¹æµè§ˆå™¨ç›´æ¥ä½¿ç”¨ï¼‰</span>
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">window</span> !== <span class="hljs-string">'undefined'</span>) {
  (<span class="hljs-variable language_">window</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">Window</span> &amp; { <span class="hljs-title class_">WhiteScreenSDK</span>: <span class="hljs-keyword">typeof</span> <span class="hljs-title class_">WhiteScreenSDK</span>; <span class="hljs-attr">initWhiteScreenDetection</span>: <span class="hljs-keyword">typeof</span> initWhiteScreenDetection }).<span class="hljs-property">WhiteScreenSDK</span> = <span class="hljs-title class_">WhiteScreenSDK</span>;
  (<span class="hljs-variable language_">window</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">Window</span> &amp; { <span class="hljs-attr">initWhiteScreenDetection</span>: <span class="hljs-keyword">typeof</span> initWhiteScreenDetection }).<span class="hljs-property">initWhiteScreenDetection</span> = initWhiteScreenDetection;
}
</code></pre>
<h3 data-id="heading-3">ä¸‰ã€ä½¿ç”¨ç¤ºä¾‹</h3>
<h4 data-id="heading-4">1. åŸºç¡€ä½¿ç”¨</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æœ€ç®€å•çš„ä½¿ç”¨æ–¹å¼</span>
<span class="hljs-keyword">import</span> { initWhiteScreenDetection } <span class="hljs-keyword">from</span> <span class="hljs-string">'./white-screen-sdk'</span>;

<span class="hljs-comment">// åˆå§‹åŒ–å¹¶å¼€å§‹æ£€æµ‹</span>
<span class="hljs-keyword">const</span> sdk = <span class="hljs-title function_">initWhiteScreenDetection</span>({
  <span class="hljs-attr">threshold</span>: <span class="hljs-number">0.9</span>,
  <span class="hljs-attr">delay</span>: <span class="hljs-number">2000</span>,
  <span class="hljs-attr">onReport</span>: <span class="hljs-function">(<span class="hljs-params">report</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (report.<span class="hljs-property">isWhiteScreen</span>) {
      <span class="hljs-comment">// å‘é€åˆ°ç›‘æ§å¹³å°</span>
      <span class="hljs-title function_">sendToMonitor</span>(report);
    }
  }
});
</code></pre>
<h4 data-id="heading-5">2. å®Œæ•´é…ç½®ç¤ºä¾‹</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">WhiteScreenSDK</span>, <span class="hljs-title class_">WhiteScreenReport</span>, <span class="hljs-title class_">DetectionResult</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./white-screen-sdk'</span>;

<span class="hljs-comment">// åˆ›å»º SDK å®ä¾‹ï¼Œå®Œæ•´é…ç½®</span>
<span class="hljs-keyword">const</span> sdk = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WhiteScreenSDK</span>({
  <span class="hljs-comment">// é‡‡æ ·é…ç½®</span>
  <span class="hljs-attr">samplingPoints</span>: <span class="hljs-number">20</span>,
  <span class="hljs-attr">threshold</span>: <span class="hljs-number">0.9</span>,
  
  <span class="hljs-comment">// æ—¶é—´é…ç½®</span>
  <span class="hljs-attr">delay</span>: <span class="hljs-number">1500</span>,
  <span class="hljs-attr">timeout</span>: <span class="hljs-number">15000</span>,
  
  <span class="hljs-comment">// åŠŸèƒ½å¼€å…³</span>
  <span class="hljs-attr">enableDOMDetection</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">enableSamplingDetection</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">enableMutationDetection</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">enableScreenshotDetection</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">enableSkeletonDetection</span>: <span class="hljs-literal">true</span>,
  
  <span class="hljs-comment">// é€‰æ‹©å™¨é…ç½®</span>
  <span class="hljs-attr">keyElementSelectors</span>: [
    <span class="hljs-string">'#app'</span>,
    <span class="hljs-string">'#root'</span>,
    <span class="hljs-string">'.main-content'</span>,
    <span class="hljs-string">'[data-page-ready]'</span>
  ],
  <span class="hljs-attr">skeletonSelector</span>: <span class="hljs-string">'.skeleton, .loading-placeholder'</span>,
  <span class="hljs-attr">ignoreSelectors</span>: [
    <span class="hljs-string">'script'</span>,
    <span class="hljs-string">'style'</span>,
    <span class="hljs-string">'.loading-indicator'</span>,
    <span class="hljs-string">'.modal-backdrop'</span>
  ],
  
  <span class="hljs-comment">// é‡è¯•é…ç½®</span>
  <span class="hljs-attr">maxRetries</span>: <span class="hljs-number">3</span>,
  <span class="hljs-attr">retryInterval</span>: <span class="hljs-number">2000</span>,
  
  <span class="hljs-comment">// ç¯å¢ƒé…ç½®</span>
  <span class="hljs-attr">enableInDev</span>: <span class="hljs-literal">false</span>,
  
  <span class="hljs-comment">// å›è°ƒå‡½æ•°</span>
  <span class="hljs-attr">onReport</span>: <span class="hljs-function">(<span class="hljs-params">report: WhiteScreenReport</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ£€æµ‹æŠ¥å‘Š:'</span>, report);
    
    <span class="hljs-keyword">if</span> (report.<span class="hljs-property">isWhiteScreen</span>) {
      <span class="hljs-comment">// ä¸ŠæŠ¥åˆ°ç›‘æ§ç³»ç»Ÿ</span>
      <span class="hljs-title function_">reportToMonitoringSystem</span>(report);
      
      <span class="hljs-comment">// å¯é€‰ï¼šå°è¯•æ¢å¤é¡µé¢</span>
      <span class="hljs-title function_">attemptPageRecovery</span>();
    }
  },
  
  <span class="hljs-attr">onDetectionComplete</span>: <span class="hljs-function">(<span class="hljs-params">result: DetectionResult</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ£€æµ‹å®Œæˆ:'</span>, result);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç½®ä¿¡åº¦:'</span>, result.<span class="hljs-property">confidence</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'åˆ¤å®šä¾æ®:'</span>, result.<span class="hljs-property">basis</span>);
  },
  
  <span class="hljs-comment">// è‡ªå®šä¹‰æ£€æµ‹é€»è¾‘</span>
  <span class="hljs-attr">customDetector</span>: <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// è‡ªå®šä¹‰ç™½å±åˆ¤æ–­é€»è¾‘</span>
    <span class="hljs-keyword">const</span> appElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'app'</span>);
    <span class="hljs-keyword">if</span> (!appElement) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰å®é™…å†…å®¹</span>
    <span class="hljs-keyword">const</span> hasContent = appElement.<span class="hljs-property">children</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> hasText = (appElement.<span class="hljs-property">textContent</span>?.<span class="hljs-title function_">trim</span>().<span class="hljs-property">length</span> ?? <span class="hljs-number">0</span>) &gt; <span class="hljs-number">100</span>;
    
    <span class="hljs-keyword">return</span> !hasContent &amp;&amp; !hasText;
  }
});

<span class="hljs-comment">// åˆå§‹åŒ–</span>
sdk.<span class="hljs-title function_">init</span>();

<span class="hljs-comment">// æ‰‹åŠ¨è§¦å‘æ£€æµ‹</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'checkBtn'</span>)?.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> sdk.<span class="hljs-title function_">manualDetect</span>();
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ‰‹åŠ¨æ£€æµ‹ç»“æœ:'</span>, result);
});

<span class="hljs-comment">// ä¸ŠæŠ¥å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">reportToMonitoringSystem</span>(<span class="hljs-params">report: WhiteScreenReport</span>): <span class="hljs-built_in">void</span> {
  <span class="hljs-comment">// å‘é€åˆ°ç›‘æ§åç«¯</span>
  <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/monitor/white-screen'</span>, {
    <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
    <span class="hljs-attr">headers</span>: {
      <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
    },
    <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(report)
  }).<span class="hljs-keyword">catch</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">error</span>);
}

<span class="hljs-comment">// é¡µé¢æ¢å¤å°è¯•</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">attemptPageRecovery</span>(<span class="hljs-params"/>): <span class="hljs-built_in">void</span> {
  <span class="hljs-comment">// å°è¯•é‡æ–°åŠ è½½å…³é”®èµ„æº</span>
  <span class="hljs-keyword">const</span> failedScripts = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'script[data-retry]'</span>);
  failedScripts.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">script</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> newScript = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'script'</span>);
    newScript.<span class="hljs-property">src</span> = (script <span class="hljs-keyword">as</span> <span class="hljs-title class_">HTMLScriptElement</span>).<span class="hljs-property">src</span>;
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(newScript);
  });
  
  <span class="hljs-comment">// æˆ–è€…åˆ·æ–°é¡µé¢</span>
  <span class="hljs-comment">// window.location.reload();</span>
}
</code></pre>
<h4 data-id="heading-6">3. Vue 3 é›†æˆç¤ºä¾‹</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// white-screen-plugin.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">App</span>, <span class="hljs-title class_">Plugin</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">WhiteScreenSDK</span>, <span class="hljs-title class_">WhiteScreenConfig</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./white-screen-sdk'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">WhiteScreenPluginOptions</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Partial</span>&lt;<span class="hljs-title class_">WhiteScreenConfig</span>&gt; {
  reportEndpoint?: <span class="hljs-built_in">string</span>;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">WhiteScreenPlugin</span>: <span class="hljs-title class_">Plugin</span> = {
  <span class="hljs-title function_">install</span>(<span class="hljs-params">app: App, options: WhiteScreenPluginOptions = {}</span>) {
    <span class="hljs-comment">// åˆ›å»º SDK å®ä¾‹</span>
    <span class="hljs-keyword">const</span> sdk = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WhiteScreenSDK</span>({
      <span class="hljs-comment">// é»˜è®¤é…ç½®</span>
      <span class="hljs-attr">keyElementSelectors</span>: [<span class="hljs-string">'#app'</span>, <span class="hljs-string">'[data-v-app]'</span>],
      <span class="hljs-attr">enableInDev</span>: <span class="hljs-literal">false</span>,
      
      <span class="hljs-comment">// åˆå¹¶ç”¨æˆ·é…ç½®</span>
      ...options,
      
      <span class="hljs-comment">// è®¾ç½®ä¸ŠæŠ¥å›è°ƒ</span>
      <span class="hljs-attr">onReport</span>: <span class="hljs-function">(<span class="hljs-params">report</span>) =&gt;</span> {
        <span class="hljs-comment">// è°ƒç”¨ç”¨æˆ·æä¾›çš„å›è°ƒ</span>
        options.<span class="hljs-property">onReport</span>?.(report);
        
        <span class="hljs-comment">// å¦‚æœæä¾›äº†ä¸ŠæŠ¥ç«¯ç‚¹ï¼Œè‡ªåŠ¨ä¸ŠæŠ¥</span>
        <span class="hljs-keyword">if</span> (options.<span class="hljs-property">reportEndpoint</span> &amp;&amp; report.<span class="hljs-property">isWhiteScreen</span>) {
          <span class="hljs-title function_">fetch</span>(options.<span class="hljs-property">reportEndpoint</span>, {
            <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
            <span class="hljs-attr">headers</span>: { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span> },
            <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
              ...report,
              <span class="hljs-attr">framework</span>: <span class="hljs-string">'vue'</span>,
              <span class="hljs-attr">version</span>: app.<span class="hljs-property">version</span>
            })
          }).<span class="hljs-keyword">catch</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">error</span>);
        }
      }
    });
    
    <span class="hljs-comment">// æ³¨å†Œå…¨å±€å±æ€§</span>
    app.<span class="hljs-property">config</span>.<span class="hljs-property">globalProperties</span>.<span class="hljs-property">$whiteScreen</span> = sdk;
    
    <span class="hljs-comment">// æä¾›ç»™ Composition API ä½¿ç”¨</span>
    app.<span class="hljs-title function_">provide</span>(<span class="hljs-string">'whiteScreenSDK'</span>, sdk);
    
    <span class="hljs-comment">// åœ¨åº”ç”¨æŒ‚è½½ååˆå§‹åŒ–</span>
    <span class="hljs-keyword">const</span> originalMount = app.<span class="hljs-property">mount</span>.<span class="hljs-title function_">bind</span>(app);
    app.<span class="hljs-property">mount</span> = <span class="hljs-function">(<span class="hljs-params">rootContainer</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> vm = <span class="hljs-title function_">originalMount</span>(rootContainer);
      
      <span class="hljs-comment">// å»¶è¿Ÿåˆå§‹åŒ–ï¼Œç­‰å¾… Vue æ¸²æŸ“å®Œæˆ</span>
      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        sdk.<span class="hljs-title function_">init</span>();
      }, <span class="hljs-number">100</span>);
      
      <span class="hljs-keyword">return</span> vm;
    };
    
    <span class="hljs-comment">// åœ¨åº”ç”¨å¸è½½æ—¶é”€æ¯</span>
    <span class="hljs-keyword">const</span> originalUnmount = app.<span class="hljs-property">unmount</span>.<span class="hljs-title function_">bind</span>(app);
    app.<span class="hljs-property">unmount</span> = <span class="hljs-function">() =&gt;</span> {
      sdk.<span class="hljs-title function_">destroy</span>();
      <span class="hljs-title function_">originalUnmount</span>();
    };
  }
};

<span class="hljs-comment">// ç±»å‹å£°æ˜</span>
<span class="hljs-keyword">declare</span> <span class="hljs-variable language_">module</span> <span class="hljs-string">'@vue/runtime-core'</span> {
  <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ComponentCustomProperties</span> {
    <span class="hljs-attr">$whiteScreen</span>: <span class="hljs-title class_">WhiteScreenSDK</span>;
  }
}

<span class="hljs-comment">// ç»„åˆå¼ API Hook</span>
<span class="hljs-keyword">import</span> { inject } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useWhiteScreen</span>(<span class="hljs-params"/>): <span class="hljs-title class_">WhiteScreenSDK</span> | <span class="hljs-literal">undefined</span> {
  <span class="hljs-keyword">return</span> inject&lt;<span class="hljs-title class_">WhiteScreenSDK</span>&gt;(<span class="hljs-string">'whiteScreenSDK'</span>);
}
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// main.ts</span>
<span class="hljs-keyword">import</span> { createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./App.vue'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">WhiteScreenPlugin</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./plugins/white-screen-plugin'</span>;

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>);

app.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">WhiteScreenPlugin</span>, {
  <span class="hljs-attr">threshold</span>: <span class="hljs-number">0.9</span>,
  <span class="hljs-attr">delay</span>: <span class="hljs-number">2000</span>,
  <span class="hljs-attr">reportEndpoint</span>: <span class="hljs-string">'/api/monitor/white-screen'</span>,
  <span class="hljs-attr">enableInDev</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">keyElementSelectors</span>: [<span class="hljs-string">'#app'</span>, <span class="hljs-string">'.main-layout'</span>, <span class="hljs-string">'[data-page-content]'</span>],
  <span class="hljs-attr">onDetectionComplete</span>: <span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (result.<span class="hljs-property">isWhiteScreen</span>) {
      <span class="hljs-comment">// å¯ä»¥åœ¨è¿™é‡Œè§¦å‘é‡è¯•é€»è¾‘æˆ–æ˜¾ç¤ºå‹å¥½æç¤º</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'é¡µé¢å¯èƒ½å‡ºç°ç™½å±ï¼Œæ­£åœ¨å°è¯•æ¢å¤...'</span>);
    }
  }
});

app.<span class="hljs-title function_">mount</span>(<span class="hljs-string">'#app'</span>);
</code></pre>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ --&gt;
&lt;template&gt;
  &lt;div class="page"&gt;
    &lt;h1&gt;ç¤ºä¾‹é¡µé¢&lt;/h1&gt;
    &lt;button @click="checkWhiteScreen"&gt;æ‰‹åŠ¨æ£€æµ‹ç™½å±&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import { useWhiteScreen } from '@/plugins/white-screen-plugin';

const whiteScreenSDK = useWhiteScreen();

async function checkWhiteScreen() {
  if (whiteScreenSDK) {
    const result = await whiteScreenSDK.manualDetect();
    console.log('æ£€æµ‹ç»“æœ:', result);
    
    if (result.isWhiteScreen) {
      alert('æ£€æµ‹åˆ°ç™½å±é—®é¢˜ï¼');
    } else {
      alert('é¡µé¢æ­£å¸¸');
    }
  }
}
&lt;/script&gt;
</code></pre>
<h4 data-id="heading-7">4. React é›†æˆç¤ºä¾‹</h4>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// WhiteScreenContext.tsx</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { createContext, useContext, useEffect, useRef, <span class="hljs-title class_">ReactNode</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">WhiteScreenSDK</span>, <span class="hljs-title class_">WhiteScreenConfig</span>, <span class="hljs-title class_">DetectionResult</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./white-screen-sdk'</span>;

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">WhiteScreenContextValue</span> {
  <span class="hljs-attr">sdk</span>: <span class="hljs-title class_">WhiteScreenSDK</span> | <span class="hljs-literal">null</span>;
  <span class="hljs-attr">manualDetect</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">DetectionResult</span> | <span class="hljs-literal">null</span>&gt;;
  <span class="hljs-attr">getStats</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">ReturnType</span>&lt;<span class="hljs-title class_">WhiteScreenSDK</span>[<span class="hljs-string">'getStats'</span>]&gt; | <span class="hljs-literal">null</span>;
}

<span class="hljs-keyword">const</span> <span class="hljs-title class_">WhiteScreenContext</span> = createContext&lt;<span class="hljs-title class_">WhiteScreenContextValue</span>&gt;({
  <span class="hljs-attr">sdk</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-attr">manualDetect</span>: <span class="hljs-keyword">async</span> () =&gt; <span class="hljs-literal">null</span>,
  <span class="hljs-attr">getStats</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-literal">null</span>
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">WhiteScreenProviderProps</span> {
  <span class="hljs-attr">children</span>: <span class="hljs-title class_">ReactNode</span>;
  config?: <span class="hljs-title class_">Partial</span>&lt;<span class="hljs-title class_">WhiteScreenConfig</span>&gt;;
  onWhiteScreen?: <span class="hljs-function">(<span class="hljs-params">result: DetectionResult</span>) =&gt;</span> <span class="hljs-built_in">void</span>;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">WhiteScreenProvider</span>(<span class="hljs-params">{ 
  children, 
  config = {},
  onWhiteScreen 
}: WhiteScreenProviderProps</span>) {
  <span class="hljs-keyword">const</span> sdkRef = useRef&lt;<span class="hljs-title class_">WhiteScreenSDK</span> | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>);
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// åˆ›å»º SDK å®ä¾‹</span>
    <span class="hljs-keyword">const</span> sdk = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WhiteScreenSDK</span>({
      <span class="hljs-attr">keyElementSelectors</span>: [<span class="hljs-string">'#root'</span>, <span class="hljs-string">'[data-reactroot]'</span>, <span class="hljs-string">'.app-container'</span>],
      <span class="hljs-attr">enableInDev</span>: <span class="hljs-literal">false</span>,
      ...config,
      <span class="hljs-attr">onDetectionComplete</span>: <span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
        config.<span class="hljs-property">onDetectionComplete</span>?.(result);
        
        <span class="hljs-keyword">if</span> (result.<span class="hljs-property">isWhiteScreen</span> &amp;&amp; onWhiteScreen) {
          <span class="hljs-title function_">onWhiteScreen</span>(result);
        }
      }
    });
    
    sdkRef.<span class="hljs-property">current</span> = sdk;
    
    <span class="hljs-comment">// åˆå§‹åŒ–</span>
    sdk.<span class="hljs-title function_">init</span>();
    
    <span class="hljs-comment">// æ¸…ç†</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      sdk.<span class="hljs-title function_">destroy</span>();
      sdkRef.<span class="hljs-property">current</span> = <span class="hljs-literal">null</span>;
    };
  }, []);
  
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">manualDetect</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">if</span> (sdkRef.<span class="hljs-property">current</span>) {
      <span class="hljs-keyword">return</span> sdkRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">manualDetect</span>();
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  };
  
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">getStats</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">if</span> (sdkRef.<span class="hljs-property">current</span>) {
      <span class="hljs-keyword">return</span> sdkRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">getStats</span>();
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  };
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">WhiteScreenContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{{</span> 
      <span class="hljs-attr">sdk:</span> <span class="hljs-attr">sdkRef.current</span>, 
      <span class="hljs-attr">manualDetect</span>, 
      <span class="hljs-attr">getStats</span> 
    }}&gt;</span>
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">WhiteScreenContext.Provider</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Hook</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useWhiteScreen</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">WhiteScreenContext</span>);
}

<span class="hljs-comment">// HOC</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> withWhiteScreenDetection&lt;P <span class="hljs-keyword">extends</span> <span class="hljs-built_in">object</span>&gt;(
  <span class="hljs-title class_">WrappedComponent</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">ComponentType</span>&lt;P&gt;,
  config?: <span class="hljs-title class_">Partial</span>&lt;<span class="hljs-title class_">WhiteScreenConfig</span>&gt;
) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">WithWhiteScreenComponent</span>(<span class="hljs-params">props: P</span>) {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">WhiteScreenProvider</span> <span class="hljs-attr">config</span>=<span class="hljs-string">{config}</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">WrappedComponent</span> {<span class="hljs-attr">...props</span>} /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">WhiteScreenProvider</span>&gt;</span></span>
    );
  };
}
</code></pre>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// App.tsx</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">WhiteScreenProvider</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./contexts/WhiteScreenContext'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleWhiteScreen</span> = (<span class="hljs-params">result</span>) =&gt; {
    <span class="hljs-comment">// ç™½å±æ—¶çš„å¤„ç†é€»è¾‘</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ£€æµ‹åˆ°ç™½å±:'</span>, result);
    
    <span class="hljs-comment">// å¯ä»¥æ˜¾ç¤ºé”™è¯¯è¾¹ç•Œæˆ–é‡è¯•æŒ‰é’®</span>
    <span class="hljs-comment">// setShowErrorBoundary(true);</span>
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">WhiteScreenProvider</span> 
      <span class="hljs-attr">config</span>=<span class="hljs-string">{{</span>
        <span class="hljs-attr">threshold:</span> <span class="hljs-attr">0.85</span>,
        <span class="hljs-attr">delay:</span> <span class="hljs-attr">2000</span>,
        <span class="hljs-attr">enableScreenshotDetection:</span> <span class="hljs-attr">false</span>
      }}
      <span class="hljs-attr">onWhiteScreen</span>=<span class="hljs-string">{handleWhiteScreen}</span>
    &gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"app"</span>&gt;</span>
        {/* åº”ç”¨å†…å®¹ */}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">WhiteScreenProvider</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span>;
</code></pre>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { useWhiteScreen } <span class="hljs-keyword">from</span> <span class="hljs-string">'./contexts/WhiteScreenContext'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">DebugPanel</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> { manualDetect, getStats } = <span class="hljs-title function_">useWhiteScreen</span>();
  
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleCheck</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">manualDetect</span>();
    <span class="hljs-keyword">if</span> (result) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ£€æµ‹ç»“æœ:'</span>, result);
      <span class="hljs-title function_">alert</span>(result.<span class="hljs-property">isWhiteScreen</span> ? <span class="hljs-string">'æ£€æµ‹åˆ°ç™½å±'</span> : <span class="hljs-string">'é¡µé¢æ­£å¸¸'</span>);
    }
  };
  
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleShowStats</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">const</span> stats = <span class="hljs-title function_">getStats</span>();
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»Ÿè®¡ä¿¡æ¯:'</span>, stats);
  };
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"debug-panel"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleCheck}</span>&gt;</span>æ‰‹åŠ¨æ£€æµ‹ç™½å±<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleShowStats}</span>&gt;</span>æŸ¥çœ‹ç»Ÿè®¡<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<h3 data-id="heading-8">å››ã€æœåŠ¡ç«¯æ•°æ®å¤„ç†ç¤ºä¾‹</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// server/white-screen-handler.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Request</span>, <span class="hljs-title class_">Response</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'express'</span>;

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">WhiteScreenReport</span> {
  <span class="hljs-attr">isWhiteScreen</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">url</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">detectionMethod</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">userAgent</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">viewport</span>: { <span class="hljs-attr">width</span>: <span class="hljs-built_in">number</span>; <span class="hljs-attr">height</span>: <span class="hljs-built_in">number</span> };
  performanceData?: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span>&gt;;
  errorInfo?: { <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span>; stack?: <span class="hljs-built_in">string</span>; <span class="hljs-attr">type</span>: <span class="hljs-built_in">string</span> };
  <span class="hljs-comment">// ... å…¶ä»–å­—æ®µ</span>
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">WhiteScreenStats</span> {
  <span class="hljs-attr">totalReports</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">whiteScreenCount</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">whiteScreenRate</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">topUrls</span>: { <span class="hljs-attr">url</span>: <span class="hljs-built_in">string</span>; <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span> }[];
  <span class="hljs-attr">topErrors</span>: { <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span>; <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span> }[];
  <span class="hljs-attr">hourlyDistribution</span>: { <span class="hljs-attr">hour</span>: <span class="hljs-built_in">number</span>; <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span> }[];
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">WhiteScreenAnalyzer</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">reports</span>: <span class="hljs-title class_">WhiteScreenReport</span>[] = [];
  <span class="hljs-keyword">private</span> <span class="hljs-attr">maxReports</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">10000</span>;
  
  <span class="hljs-comment">/**
   * æ·»åŠ æŠ¥å‘Š
   */</span>
  <span class="hljs-title function_">addReport</span>(<span class="hljs-attr">report</span>: <span class="hljs-title class_">WhiteScreenReport</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reports</span>.<span class="hljs-title function_">push</span>(report);
    
    <span class="hljs-comment">// ä¿æŒæŠ¥å‘Šæ•°é‡åœ¨é™åˆ¶å†…</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">reports</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxReports</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">reports</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">reports</span>.<span class="hljs-title function_">slice</span>(-<span class="hljs-variable language_">this</span>.<span class="hljs-property">maxReports</span>);
    }
  }
  
  <span class="hljs-comment">/**
   * è·å–ç»Ÿè®¡æ•°æ®
   */</span>
  <span class="hljs-title function_">getStats</span>(timeRange?: { <span class="hljs-attr">start</span>: <span class="hljs-built_in">number</span>; <span class="hljs-attr">end</span>: <span class="hljs-built_in">number</span> }): <span class="hljs-title class_">WhiteScreenStats</span> {
    <span class="hljs-keyword">let</span> filteredReports = <span class="hljs-variable language_">this</span>.<span class="hljs-property">reports</span>;
    
    <span class="hljs-keyword">if</span> (timeRange) {
      filteredReports = <span class="hljs-variable language_">this</span>.<span class="hljs-property">reports</span>.<span class="hljs-title function_">filter</span>(
        <span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.<span class="hljs-property">timestamp</span> &gt;= timeRange.<span class="hljs-property">start</span> &amp;&amp; r.<span class="hljs-property">timestamp</span> &lt;= timeRange.<span class="hljs-property">end</span>
      );
    }
    
    <span class="hljs-keyword">const</span> totalReports = filteredReports.<span class="hljs-property">length</span>;
    <span class="hljs-keyword">const</span> whiteScreenReports = filteredReports.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.<span class="hljs-property">isWhiteScreen</span>);
    <span class="hljs-keyword">const</span> whiteScreenCount = whiteScreenReports.<span class="hljs-property">length</span>;
    <span class="hljs-keyword">const</span> whiteScreenRate = totalReports &gt; <span class="hljs-number">0</span> ? whiteScreenCount / totalReports : <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// ç»Ÿè®¡ Top URLs</span>
    <span class="hljs-keyword">const</span> urlCounts = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span>&gt;();
    whiteScreenReports.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> url = <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(r.<span class="hljs-property">url</span>).<span class="hljs-property">pathname</span>;
      urlCounts.<span class="hljs-title function_">set</span>(url, (urlCounts.<span class="hljs-title function_">get</span>(url) || <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);
    });
    
    <span class="hljs-keyword">const</span> topUrls = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(urlCounts.<span class="hljs-title function_">entries</span>())
      .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">[url, count]</span>) =&gt;</span> ({ url, count }))
      .<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> b.<span class="hljs-property">count</span> - a.<span class="hljs-property">count</span>)
      .<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>);
    
    <span class="hljs-comment">// ç»Ÿè®¡ Top Errors</span>
    <span class="hljs-keyword">const</span> errorCounts = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span>&gt;();
    whiteScreenReports.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (r.<span class="hljs-property">errorInfo</span>?.<span class="hljs-property">message</span>) {
        <span class="hljs-keyword">const</span> msg = r.<span class="hljs-property">errorInfo</span>.<span class="hljs-property">message</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>);
        errorCounts.<span class="hljs-title function_">set</span>(msg, (errorCounts.<span class="hljs-title function_">get</span>(msg) || <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);
      }
    });
    
    <span class="hljs-keyword">const</span> topErrors = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(errorCounts.<span class="hljs-title function_">entries</span>())
      .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">[message, count]</span>) =&gt;</span> ({ message, count }))
      .<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> b.<span class="hljs-property">count</span> - a.<span class="hljs-property">count</span>)
      .<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>);
    
    <span class="hljs-comment">// å°æ—¶åˆ†å¸ƒ</span>
    <span class="hljs-keyword">const</span> hourCounts = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-number">24</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>);
    whiteScreenReports.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> hour = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(r.<span class="hljs-property">timestamp</span>).<span class="hljs-title function_">getHours</span>();
      hourCounts[hour]++;
    });
    
    <span class="hljs-keyword">const</span> hourlyDistribution = hourCounts.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">count, hour</span>) =&gt;</span> ({ hour, count }));
    
    <span class="hljs-keyword">return</span> {
      totalReports,
      whiteScreenCount,
      whiteScreenRate,
      topUrls,
      topErrors,
      hourlyDistribution
    };
  }
  
  <span class="hljs-comment">/**
   * æ£€æŸ¥æ˜¯å¦éœ€è¦å‘Šè­¦
   */</span>
  <span class="hljs-title function_">shouldAlert</span>(): { <span class="hljs-attr">alert</span>: <span class="hljs-built_in">boolean</span>; <span class="hljs-attr">reason</span>: <span class="hljs-built_in">string</span> } {
    <span class="hljs-keyword">const</span> recentReports = <span class="hljs-variable language_">this</span>.<span class="hljs-property">reports</span>.<span class="hljs-title function_">filter</span>(
      <span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - r.<span class="hljs-property">timestamp</span> &lt; <span class="hljs-number">5</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span> <span class="hljs-comment">// æœ€è¿‘5åˆ†é’Ÿ</span>
    );
    
    <span class="hljs-keyword">if</span> (recentReports.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">alert</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">reason</span>: <span class="hljs-string">''</span> };
    }
    
    <span class="hljs-keyword">const</span> whiteScreenRate = recentReports.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.<span class="hljs-property">isWhiteScreen</span>).<span class="hljs-property">length</span> / recentReports.<span class="hljs-property">length</span>;
    
    <span class="hljs-keyword">if</span> (whiteScreenRate &gt; <span class="hljs-number">0.1</span>) {
      <span class="hljs-keyword">return</span> { 
        <span class="hljs-attr">alert</span>: <span class="hljs-literal">true</span>, 
        <span class="hljs-attr">reason</span>: <span class="hljs-string">`ç™½å±ç‡è¿‡é«˜: <span class="hljs-subst">${(whiteScreenRate * <span class="hljs-number">100</span>).toFixed(<span class="hljs-number">1</span>)}</span>%`</span> 
      };
    }
    
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">alert</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">reason</span>: <span class="hljs-string">''</span> };
  }
}

<span class="hljs-comment">// Express è·¯ç”±å¤„ç†</span>
<span class="hljs-keyword">const</span> analyzer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WhiteScreenAnalyzer</span>();

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">handleWhiteScreenReport</span>(<span class="hljs-params">req: Request, res: Response</span>): <span class="hljs-built_in">void</span> {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">reports</span>: <span class="hljs-title class_">WhiteScreenReport</span>[] = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(req.<span class="hljs-property">body</span>) ? req.<span class="hljs-property">body</span> : [req.<span class="hljs-property">body</span>];
    
    reports.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">report</span> =&gt;</span> {
      analyzer.<span class="hljs-title function_">addReport</span>(report);
    });
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦éœ€è¦å‘Šè­¦</span>
    <span class="hljs-keyword">const</span> alertStatus = analyzer.<span class="hljs-title function_">shouldAlert</span>();
    <span class="hljs-keyword">if</span> (alertStatus.<span class="hljs-property">alert</span>) {
      <span class="hljs-comment">// å‘é€å‘Šè­¦ï¼ˆä¾‹å¦‚ï¼šå‘é€é‚®ä»¶ã€çŸ­ä¿¡ã€é’‰é’‰é€šçŸ¥ç­‰ï¼‰</span>
      <span class="hljs-title function_">sendAlert</span>(alertStatus.<span class="hljs-property">reason</span>);
    }
    
    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">received</span>: reports.<span class="hljs-property">length</span> });
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å¤„ç†ç™½å±æŠ¥å‘Šå¤±è´¥:'</span>, error);
    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: (error <span class="hljs-keyword">as</span> <span class="hljs-title class_">Error</span>).<span class="hljs-property">message</span> });
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getWhiteScreenStats</span>(<span class="hljs-params">req: Request, res: Response</span>): <span class="hljs-built_in">void</span> {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> { start, end } = req.<span class="hljs-property">query</span>;
    
    <span class="hljs-keyword">const</span> timeRange = start &amp;&amp; end 
      ? { <span class="hljs-attr">start</span>: <span class="hljs-title class_">Number</span>(start), <span class="hljs-attr">end</span>: <span class="hljs-title class_">Number</span>(end) }
      : <span class="hljs-literal">undefined</span>;
    
    <span class="hljs-keyword">const</span> stats = analyzer.<span class="hljs-title function_">getStats</span>(timeRange);
    res.<span class="hljs-title function_">json</span>(stats);
  } <span class="hljs-keyword">catch</span> (error) {
    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">error</span>: (error <span class="hljs-keyword">as</span> <span class="hljs-title class_">Error</span>).<span class="hljs-property">message</span> });
  }
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">sendAlert</span>(<span class="hljs-params">reason: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">void</span> {
  <span class="hljs-comment">// å®ç°å‘Šè­¦é€»è¾‘</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'[ç™½å±å‘Šè­¦]'</span>, reason);
  <span class="hljs-comment">// å¯ä»¥é›†æˆå„ç§å‘Šè­¦æ¸ é“ï¼šé‚®ä»¶ã€çŸ­ä¿¡ã€é’‰é’‰ã€ä¼ä¸šå¾®ä¿¡ç­‰</span>
}
</code></pre>
<h3 data-id="heading-9">äº”ã€æ€»ç»“</h3>
<p>ä»¥ä¸Šä»£ç å®ç°äº†ä¸€ä¸ªå®Œæ•´çš„å‰ç«¯ç™½å±æ£€æµ‹ SDKï¼ŒåŒ…å«ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š</p>
<ol>
<li>
<p><strong>å¤šç§æ£€æµ‹æ–¹æ³•</strong>ï¼š</p>
<ul>
<li>é‡‡æ ·ç‚¹æ£€æµ‹ - åœ¨é¡µé¢å…³é”®ä½ç½®é‡‡æ ·åˆ¤æ–­</li>
<li>DOM æ£€æµ‹ - æ£€æŸ¥å…³é”® DOM å…ƒç´ æ˜¯å¦å­˜åœ¨å’Œå¯è§</li>
<li>MutationObserver æ£€æµ‹ - ç›‘å¬ DOM å˜åŒ–</li>
<li>æˆªå›¾æ£€æµ‹ - é€šè¿‡ Canvas åˆ†æé¡µé¢å†…å®¹</li>
<li>éª¨æ¶å±æ£€æµ‹ - æ£€æµ‹ loading çŠ¶æ€</li>
</ul>
</li>
<li>
<p><strong>å®Œå–„çš„ä¸ŠæŠ¥æœºåˆ¶</strong>ï¼š</p>
<ul>
<li>æ”¯æŒ Beacon API å’Œ fetch é™çº§</li>
<li>é˜Ÿåˆ—æ‰¹é‡ä¸ŠæŠ¥</li>
<li>é¡µé¢å¸è½½æ—¶å‘é€</li>
</ul>
</li>
<li>
<p><strong>æ¡†æ¶é›†æˆ</strong>ï¼š</p>
<ul>
<li>Vue 3 æ’ä»¶å’Œ Composition API Hook</li>
<li>React Context å’Œ Hook</li>
</ul>
</li>
<li>
<p><strong>æœåŠ¡ç«¯å¤„ç†</strong>ï¼š</p>
<ul>
<li>æ•°æ®ç»Ÿè®¡åˆ†æ</li>
<li>å‘Šè­¦æœºåˆ¶</li>
</ul>
</li>
</ol>
<p>å®é™…ä½¿ç”¨æ—¶ï¼Œå¯ä»¥æ ¹æ®é¡¹ç›®éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ£€æµ‹æ–¹æ³•ç»„åˆï¼Œå¹¶é…ç½®åˆç†çš„é˜ˆå€¼å’Œå»¶è¿Ÿæ—¶é—´ï¼Œä»¥è¾¾åˆ°æœ€ä½³çš„æ£€æµ‹æ•ˆæœã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[1-30.ã€GCDã€‘GCD å¦‚ä½•ç¼“è§£ä¼˜å…ˆçº§åè½¬ï¼Ÿå¼€å‘è€…è¿˜èƒ½åšä»€ä¹ˆï¼Ÿ]]></title>    <link>https://juejin.cn/post/7599933828544004159</link>    <guid>https://juejin.cn/post/7599933828544004159</guid>    <pubDate>2026-01-28T03:31:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599933828544004159" data-draft-id="7599983917663944747" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="1-30.ã€GCDã€‘GCD å¦‚ä½•ç¼“è§£ä¼˜å…ˆçº§åè½¬ï¼Ÿå¼€å‘è€…è¿˜èƒ½åšä»€ä¹ˆï¼Ÿ"/> <meta itemprop="keywords" content="Swift"/> <meta itemprop="datePublished" content="2026-01-28T03:31:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¡¹é˜¿ä¸‘"/> <meta itemprop="url" content="https://juejin.cn/user/1407852323023447"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            1-30.ã€GCDã€‘GCD å¦‚ä½•ç¼“è§£ä¼˜å…ˆçº§åè½¬ï¼Ÿå¼€å‘è€…è¿˜èƒ½åšä»€ä¹ˆï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1407852323023447/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¡¹é˜¿ä¸‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T03:31:13.000Z" title="Wed Jan 28 2026 03:31:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1ï¸âƒ£ GCD å†…éƒ¨ç¼“è§£æœºåˆ¶ï¼š<strong>QoS ç»§æ‰¿</strong></h2>
<h3 data-id="heading-1">1.1 åŸç†</h3>
<ul>
<li>
<p><strong>é—®é¢˜æ¥æº</strong>ï¼š</p>
<ul>
<li>é«˜ QoS ä»»åŠ¡ç­‰å¾…ä½ QoS é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡æˆ–é”</li>
<li>å¦‚æœä½ QoS ä»»åŠ¡å ç”¨çº¿ç¨‹ â†’ é«˜ QoS ä»»åŠ¡è¢«å»¶è¿Ÿ</li>
<li>å…¸å‹åœºæ™¯ï¼šä¸²è¡Œé˜Ÿåˆ— + ä½ QoS åœ¨å‰ + é«˜ QoS åœ¨å</li>
</ul>
</li>
<li>
<p><strong>GCD è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>é«˜ QoS ä»»åŠ¡æäº¤åˆ°é˜Ÿåˆ—æ—¶ï¼Œç³»ç»Ÿæ£€æµ‹ <strong>ä»»åŠ¡é˜»å¡</strong></li>
<li>ä¸´æ—¶æå‡ä½ QoS ä»»åŠ¡åˆ°é«˜ QoS</li>
<li>ä¿è¯ä½ QoS ä»»åŠ¡å°½å¿«å®Œæˆ â†’ é«˜ QoS ä»»åŠ¡ç»§ç»­æ‰§è¡Œ</li>
</ol>
</li>
</ul>
<h3 data-id="heading-2">1.2 ç¤ºä¾‹</h3>
<pre><code class="hljs language-php" lang="php">let serialQueue = <span class="hljs-title function_ invoke__">DispatchQueue</span>(<span class="hljs-attr">label</span>: <span class="hljs-string">"serialQueue"</span>, <span class="hljs-attr">qos</span>: .utility)

serialQueue.<span class="hljs-title function_ invoke__">async</span>(<span class="hljs-attr">qos</span>: .background) {
    Thread.<span class="hljs-title function_ invoke__">sleep</span>(<span class="hljs-attr">forTimeInterval</span>: <span class="hljs-number">5</span>) <span class="hljs-comment">// ä½ QoS ä»»åŠ¡</span>
}

serialQueue.<span class="hljs-title function_ invoke__">async</span>(<span class="hljs-attr">qos</span>: .userInitiated) {
    <span class="hljs-keyword">print</span>(<span class="hljs-string">"é«˜ QoS ä»»åŠ¡æ‰§è¡Œ"</span>)
}
</code></pre>
<ul>
<li>ä½ QoS ä»»åŠ¡åœ¨å‰ï¼Œæ­£å¸¸ä¼šé˜»å¡é«˜ QoS</li>
<li><strong>GCD ä¼šä¸´æ—¶æå‡ä½ QoS ä»»åŠ¡åˆ° <code>.userInitiated</code></strong> â†’ ç¼©çŸ­é«˜ QoS é˜»å¡æ—¶é—´</li>
</ul>
<hr/>
<h2 data-id="heading-3">2ï¸âƒ£ å¼€å‘è€…å¯ä»¥åšçš„ä¼˜åŒ–</h2>
<h3 data-id="heading-4">2.1 é¿å…ä¸²è¡Œé˜Ÿåˆ—ä¸­é«˜ä½ QoS æ··ç”¨</h3>
<ul>
<li>
<p>ä¸²è¡Œé˜Ÿåˆ—é¡ºåºå›ºå®šï¼Œä½ QoS åœ¨å‰ä¼šé˜»å¡é«˜ QoS</p>
</li>
<li>
<p><strong>å»ºè®®</strong>ï¼š</p>
<ul>
<li>é«˜ QoS ä»»åŠ¡å•ç‹¬ä½¿ç”¨é«˜ QoS é˜Ÿåˆ—</li>
<li>ä½ QoS ä»»åŠ¡ä½¿ç”¨åå°é˜Ÿåˆ—</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-ini" lang="ini">let <span class="hljs-attr">highQueue</span> = DispatchQueue(label: <span class="hljs-string">"highQueue"</span>, qos: .userInitiated)
let <span class="hljs-attr">lowQueue</span> = DispatchQueue(label: <span class="hljs-string">"lowQueue"</span>, qos: .background)
</code></pre>
<hr/>
<h3 data-id="heading-5">2.2 ä½¿ç”¨å¼‚æ­¥è°ƒåº¦</h3>
<ul>
<li><code>async</code> æäº¤ä»»åŠ¡ä¸ä¼šé˜»å¡è°ƒç”¨çº¿ç¨‹</li>
<li>å¯ä»¥å‡å°‘é«˜ QoS ä»»åŠ¡ç­‰å¾…ä½ QoS é˜Ÿåˆ—ä»»åŠ¡çš„æ—¶é—´</li>
</ul>
<pre><code class="hljs language-csharp" lang="csharp">serialQueue.<span class="hljs-keyword">async</span> {
    <span class="hljs-comment">// ä»»åŠ¡ä¸ä¼šé˜»å¡è°ƒç”¨çº¿ç¨‹</span>
}
</code></pre>
<ul>
<li>é¿å…åœ¨é«˜ QoS ä»»åŠ¡å†…è°ƒç”¨ <code>sync</code> åˆ°ä½ QoS é˜Ÿåˆ— â†’ é¿å…ä¼˜å…ˆçº§åè½¬</li>
</ul>
<hr/>
<h3 data-id="heading-6">2.3 é¿å…é•¿æ—¶é—´é˜»å¡é«˜ QoS çº¿ç¨‹</h3>
<ul>
<li>
<p>é«˜ QoS çº¿ç¨‹ä¸Šæ‰§è¡Œè€—æ—¶ä»»åŠ¡ â†’ é˜»å¡è‡ªå·±æˆ–å…¶ä»–é«˜ QoS ä»»åŠ¡</p>
</li>
<li>
<p><strong>ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>CPU å¯†é›†å‹ / è€—æ—¶æ“ä½œ â†’ ç§»åˆ°ä½æˆ–ä¸­ç­‰ QoS é˜Ÿåˆ—</li>
<li>ä½¿ç”¨ <code>DispatchWorkItem</code> æˆ–åå°é˜Ÿåˆ—å¤„ç†</li>
</ul>
</li>
</ul>
<hr/>
<h3 data-id="heading-7">2.4 å¯¹å…±äº«èµ„æºä½¿ç”¨ GCD åŸè¯­</h3>
<ul>
<li><strong>ä¸²è¡Œé˜Ÿåˆ—</strong>æˆ–<strong>Dispatch Barrier</strong>ç®¡ç†å…±äº«èµ„æº</li>
<li>é¿å…é«˜ QoS ä»»åŠ¡è¢«ä½ QoS ä»»åŠ¡æŒæœ‰é”é˜»å¡</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">let</span> concurrentQueue = <span class="hljs-title class_">DispatchQueue</span>(<span class="hljs-attr">label</span>: <span class="hljs-string">"concurrentQueue"</span>, <span class="hljs-attr">attributes</span>: .<span class="hljs-property">concurrent</span>)
concurrentQueue.<span class="hljs-title function_">async</span>(<span class="hljs-params">flags: .barrier</span>) {
    <span class="hljs-comment">// ç‹¬å è®¿é—®å…±äº«èµ„æº</span>
}
</code></pre>
<ul>
<li>å¯ä»¥ä¿è¯é«˜ QoS ä»»åŠ¡è®¿é—®å…±äº«èµ„æºæ—¶ä¸ä¼šè¢«ä½ QoS é•¿æ—¶é—´é˜»å¡</li>
</ul>
<hr/>
<h3 data-id="heading-8">2.5 åˆç†æ‹†åˆ†ä»»åŠ¡</h3>
<ul>
<li>é¿å…ä¸€ä¸ªä½ QoS å¤§ä»»åŠ¡å ç”¨ä¸²è¡Œé˜Ÿåˆ—è¿‡ä¹…</li>
<li>æ‹†æˆå¤šä¸ªå°ä»»åŠ¡ï¼Œè®©ç³»ç»Ÿè°ƒåº¦æœºä¼šæ›´å¤š â†’ é«˜ QoS ä»»åŠ¡ä¸ä¼šè¢«é•¿æ—¶é—´é˜»å¡</li>
</ul>
<hr/>
<h2 data-id="heading-9">3ï¸âƒ£ æ€»ç»“</h2>



































<table><thead><tr><th>æ–¹æ³•</th><th>GCD/ç³»ç»Ÿæœºåˆ¶</th><th>å¼€å‘è€…æªæ–½</th></tr></thead><tbody><tr><td>ç¼“è§£ä¼˜å…ˆçº§åè½¬</td><td><strong>QoS ç»§æ‰¿</strong>ï¼šä¸´æ—¶æå‡ä½ QoS ä»»åŠ¡</td><td>é¿å…ä¸²è¡Œé˜Ÿåˆ—é«˜ä½ QoS æ··ç”¨</td></tr><tr><td>å¼‚æ­¥ vs åŒæ­¥</td><td>async ä¸é˜»å¡è°ƒç”¨çº¿ç¨‹</td><td>é¿å…é«˜ QoS sync è°ƒç”¨ä½ QoS é˜Ÿåˆ—</td></tr><tr><td>é˜»å¡æ§åˆ¶</td><td>é«˜ QoS é˜»å¡ä¼šå½±å“ç³»ç»Ÿå“åº”</td><td>é•¿è€—æ—¶ä»»åŠ¡ç§»åˆ°ä½ QoS é˜Ÿåˆ—</td></tr><tr><td>å…±äº«èµ„æº</td><td>ä¸²è¡Œé˜Ÿåˆ— / barrier ä¿è¯ç‹¬å </td><td>é¿å…é«˜ QoS ç­‰å¾…ä½ QoS æŒæœ‰çš„é”</td></tr><tr><td>ä»»åŠ¡æ‹†åˆ†</td><td>ç³»ç»Ÿè°ƒåº¦æœºä¼šæ›´å¤š</td><td>å°†å¤§ä»»åŠ¡æ‹†æˆå°ä»»åŠ¡å‡å°‘é˜»å¡</td></tr></tbody></table>
<blockquote>
<p>ğŸ’¡ æ ¸å¿ƒæ€æƒ³ï¼š<strong>GCD ä¼šä¸´æ—¶æå‡ä½ QoS ä»»åŠ¡ä¼˜å…ˆçº§ï¼Œä½†å¼€å‘è€…ä»éœ€åˆç†åˆ’åˆ†ä»»åŠ¡ã€é˜Ÿåˆ—å’Œèµ„æºä½¿ç”¨ï¼Œæ‰èƒ½æœ€å°åŒ–ä¼˜å…ˆçº§åè½¬å¯¹æ€§èƒ½çš„å½±å“ã€‚</strong></p>
</blockquote>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åƒé€äºŒå‰æ ‘ï¼šä»åŸºç¡€åˆ°å®æˆ˜ï¼ŒæŒæ¡ç®—æ³•çš„æ ¸å¿ƒéª¨æ¶]]></title>    <link>https://juejin.cn/post/7599868109086900266</link>    <guid>https://juejin.cn/post/7599868109086900266</guid>    <pubDate>2026-01-28T03:37:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599868109086900266" data-draft-id="7599983917664141355" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åƒé€äºŒå‰æ ‘ï¼šä»åŸºç¡€åˆ°å®æˆ˜ï¼ŒæŒæ¡ç®—æ³•çš„æ ¸å¿ƒéª¨æ¶"/> <meta itemprop="keywords" content="JavaScript,åç«¯,ç®—æ³•"/> <meta itemprop="datePublished" content="2026-01-28T03:37:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¢œé…±"/> <meta itemprop="url" content="https://juejin.cn/user/905653309941495"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åƒé€äºŒå‰æ ‘ï¼šä»åŸºç¡€åˆ°å®æˆ˜ï¼ŒæŒæ¡ç®—æ³•çš„æ ¸å¿ƒéª¨æ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/905653309941495/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¢œé…±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T03:37:45.000Z" title="Wed Jan 28 2026 03:37:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»19åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">åƒé€äºŒå‰æ ‘ï¼šä»åŸºç¡€åˆ°å®æˆ˜ï¼ŒæŒæ¡ç®—æ³•çš„æ ¸å¿ƒéª¨æ¶</h2>
<p>äºŒå‰æ ‘æ˜¯æ•°æ®ç»“æ„ä¸ç®—æ³•é¢†åŸŸçš„â€œåŸºçŸ³â€â€”â€”ä¸ä»…æ˜¯çº¢é»‘æ ‘ã€äºŒå‰å †ã€å­—å…¸æ ‘ç­‰é«˜çº§ç»“æ„çš„åŸºç¡€ï¼Œæ›´æ˜¯å›æº¯ã€BFSã€åŠ¨æ€è§„åˆ’ç­‰ç®—æ³•æ€æƒ³çš„å…·è±¡åŒ–è½½ä½“ã€‚åƒé€äºŒå‰æ ‘ï¼Œå°±æŒæ¡äº†ç®—æ³•çš„æ ¸å¿ƒé€»è¾‘ï¼›æä¸æ‡‚äºŒå‰æ ‘ï¼Œé¢å¯¹å¤æ‚é—®é¢˜åªä¼šæ— ä»ä¸‹æ‰‹ã€‚</p>
<p>æœ¬æ–‡å°†ä»äºŒå‰æ ‘çš„æ ¸å¿ƒæ¦‚å¿µã€å®ç°å½¢å¼ã€éå†æ¡†æ¶åˆ°å®æˆ˜åœºæ™¯ï¼Œå…¨æ–¹ä½æ‹†è§£äºŒå‰æ ‘çš„æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Œå¹¶è¡¥å……é’ˆå¯¹æ€§çš„LeetCodeç»ƒä¹ ï¼Œå¸®ä½ çœŸæ­£åšåˆ°â€œå­¦ç»ƒç»“åˆâ€ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€äºŒå‰æ ‘çš„æ ¸å¿ƒè®¤çŸ¥</h3>
<h4 data-id="heading-2">1.1 ä¸ºä»€ä¹ˆäºŒå‰æ ‘å¦‚æ­¤é‡è¦ï¼Ÿ</h4>
<ul>
<li>
<p><strong>ç»“æ„åŸºç¡€</strong>ï¼šçº¢é»‘æ ‘ï¼ˆè‡ªå¹³è¡¡BSTï¼‰ã€äºŒå‰å †ã€çº¿æ®µæ ‘ã€å­—å…¸æ ‘ç­‰é«˜é¢‘æ•°æ®ç»“æ„ï¼Œæœ¬è´¨éƒ½æ˜¯äºŒå‰æ ‘çš„å˜ç§ï¼›</p>
</li>
<li>
<p><strong>ç®—æ³•æ€æƒ³è½½ä½“</strong>ï¼šå›æº¯ã€DFSã€BFSã€åŠ¨æ€è§„åˆ’ç­‰ç®—æ³•ï¼Œæœ¬è´¨æ˜¯å°†é—®é¢˜æŠ½è±¡æˆâ€œæ ‘çš„éå†â€ï¼›</p>
</li>
<li>
<p><strong>é¢è¯•é«˜é¢‘</strong>ï¼šè¶…60%çš„ç®—æ³•é¢è¯•é¢˜å¯å½’ä¸ºäºŒå‰æ ‘é—®é¢˜ï¼Œæˆ–èƒ½é€šè¿‡â€œæ ‘æŠ½è±¡â€è§£å†³ã€‚</p>
</li>
</ul>
<h4 data-id="heading-3">1.2 æ ¸å¿ƒæœ¯è¯­</h4>
<ul>
<li>
<p>èŠ‚ç‚¹/çˆ¶èŠ‚ç‚¹/å­èŠ‚ç‚¹/æ ¹èŠ‚ç‚¹/å¶å­èŠ‚ç‚¹ï¼šæ ‘çš„åŸºæœ¬ç»„æˆå•å…ƒï¼Œå¶å­èŠ‚ç‚¹æ˜¯æ— å·¦å³å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ï¼›</p>
</li>
<li>
<p>å­æ ‘/å·¦å­æ ‘/å³å­æ ‘ï¼šä»¥æŸä¸ªèŠ‚ç‚¹ä¸ºæ ¹çš„å±€éƒ¨æ ‘ç»“æ„ï¼›</p>
</li>
<li>
<p>æ·±åº¦/é«˜åº¦ï¼šæ·±åº¦æ˜¯ä»æ ¹åˆ°å½“å‰èŠ‚ç‚¹çš„å±‚æ•°ï¼Œé«˜åº¦æ˜¯ä»å½“å‰èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹çš„æœ€å¤§å±‚æ•°ï¼ˆæœ€å¤§æ·±åº¦=æœ€å¤§é«˜åº¦ï¼‰ã€‚</p>
</li>
</ul>
<h4 data-id="heading-4">1.3 å¸¸è§äºŒå‰æ ‘ç±»å‹</h4>



































<table><thead><tr><th>ç±»å‹</th><th>æ ¸å¿ƒç‰¹å¾</th><th>åº”ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>æ»¡äºŒå‰æ ‘</td><td>æ‰€æœ‰éå¶å­èŠ‚ç‚¹éƒ½æœ‰å·¦å³å­èŠ‚ç‚¹ï¼Œå¶å­èŠ‚ç‚¹åœ¨åŒä¸€å±‚</td><td>ç†è®ºç ”ç©¶ã€å®Œå…¨äºŒå‰æ ‘çš„ç‰¹ä¾‹</td></tr><tr><td>å®Œå…¨äºŒå‰æ ‘</td><td>é™¤æœ€åä¸€å±‚å¤–ï¼Œå…¶ä»–å±‚èŠ‚ç‚¹æ»¡ï¼›æœ€åä¸€å±‚èŠ‚ç‚¹é å·¦æ’åˆ—</td><td>äºŒå‰å †ï¼ˆæ•°ç»„å­˜å‚¨ï¼‰ã€ä¼˜å…ˆçº§é˜Ÿåˆ—</td></tr><tr><td>äºŒå‰æœç´¢æ ‘ï¼ˆBSTï¼‰</td><td>å·¦å­æ ‘èŠ‚ç‚¹å€¼ &lt; æ ¹èŠ‚ç‚¹å€¼ &lt; å³å­æ ‘èŠ‚ç‚¹å€¼</td><td>é«˜æ•ˆæŸ¥æ‰¾/æ’å…¥ï¼ˆå¦‚çº¢é»‘æ ‘åº•å±‚ï¼‰</td></tr><tr><td>é«˜åº¦å¹³è¡¡äºŒå‰æ ‘</td><td>æ¯ä¸ªèŠ‚ç‚¹çš„å·¦å³å­æ ‘é«˜åº¦å·® â‰¤ 1</td><td>é¿å…BSTé€€åŒ–æˆé“¾è¡¨ï¼ˆå¦‚AVLæ ‘ï¼‰</td></tr><tr><td>è‡ªå¹³è¡¡äºŒå‰æ ‘</td><td>è‡ªåŠ¨ç»´æŒé«˜åº¦å¹³è¡¡çš„BSTï¼ˆå¦‚çº¢é»‘æ ‘ï¼‰</td><td>å·¥ç¨‹åœºæ™¯ï¼ˆJava TreeMapã€Linuxå†…æ ¸ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-5">äºŒã€äºŒå‰æ ‘çš„å®ç°å½¢å¼</h3>
<p>äºŒå‰æ ‘çš„å®ç°åˆ†ä¸¤ç§æ ¸å¿ƒå½¢å¼ï¼Œå¯æ ¹æ®åœºæ™¯é€‰æ‹©ï¼š</p>
<h4 data-id="heading-6">2.1 é“¾å¼å­˜å‚¨ï¼ˆæœ€å¸¸ç”¨ï¼‰</h4>
<p>é€šè¿‡èŠ‚ç‚¹å¯¹è±¡+æŒ‡é’ˆï¼ˆå¼•ç”¨ï¼‰å…³è”ï¼Œç›´è§‚ä¸”é€‚é…ç»å¤§å¤šæ•°ç®—æ³•åœºæ™¯ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">
<span class="hljs-comment">// äºŒå‰æ ‘èŠ‚ç‚¹å®šä¹‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">TreeNode</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">val</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">val</span> = val;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">left</span> = <span class="hljs-literal">null</span>; <span class="hljs-comment">// å·¦å­èŠ‚ç‚¹æŒ‡é’ˆ</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">right</span> = <span class="hljs-literal">null</span>; <span class="hljs-comment">// å³å­èŠ‚ç‚¹æŒ‡é’ˆ</span>
    }
}

<span class="hljs-comment">// å¤šå‰æ ‘èŠ‚ç‚¹ï¼ˆæ— å·¦å³ä¹‹åˆ†ï¼Œç”¨æ•°ç»„å­˜å­èŠ‚ç‚¹ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">val, children = []</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">val</span> = val;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">children</span> = children; <span class="hljs-comment">// å­èŠ‚ç‚¹æ•°ç»„</span>
    }
}
</code></pre>
<h4 data-id="heading-7">2.2 å“ˆå¸Œè¡¨/æ•°ç»„æ¨¡æ‹Ÿï¼ˆè½»é‡åŒ–ï¼‰</h4>
<p>æ— éœ€æ˜¾å¼åˆ›å»ºèŠ‚ç‚¹å¯¹è±¡ï¼Œç”¨å“ˆå¸Œè¡¨æ˜ å°„â€œèŠ‚ç‚¹-å­èŠ‚ç‚¹â€å…³ç³»ï¼Œé€‚åˆå¿«é€ŸæŠ½è±¡é—®é¢˜ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">
<span class="hljs-comment">// ç”¨Mapæ¨¡æ‹Ÿæ ‘ç»“æ„ï¼škey=èŠ‚ç‚¹å€¼ï¼Œvalue=å­èŠ‚ç‚¹æ•°ç»„</span>
<span class="hljs-keyword">let</span> tree = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>([
    [<span class="hljs-number">1</span>, [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>]],
    [<span class="hljs-number">2</span>, [<span class="hljs-number">4</span>]],
    [<span class="hljs-number">3</span>, [<span class="hljs-number">5</span>, <span class="hljs-number">6</span>]]
]);
</code></pre>
<h3 data-id="heading-8">ä¸‰ã€äºŒå‰æ ‘çš„æ ¸å¿ƒéå†æ¡†æ¶</h3>
<p>äºŒå‰æ ‘åªæœ‰ä¸¤ç§æ ¸å¿ƒéå†é€»è¾‘ï¼š<strong>é€’å½’éå†ï¼ˆDFSï¼‰</strong> å’Œ <strong>å±‚åºéå†ï¼ˆBFSï¼‰</strong>ï¼Œæ‰€æœ‰å¤æ‚éå†éƒ½æ˜¯è¿™ä¸¤ç§æ¡†æ¶çš„å˜ç§ã€‚</p>
<h4 data-id="heading-9">3.1 é€’å½’éå†ï¼ˆDFSï¼‰ï¼šæŒæ¡â€œä¸‰ä¸ªå…³é”®ä½ç½®â€</h4>
<p>é€’å½’éå†çš„æœ¬è´¨æ˜¯â€œåˆ†è§£å­é—®é¢˜â€ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¼šè¢«è®¿é—®ä¸‰æ¬¡ï¼Œè€Œå‰åºã€ä¸­åºã€ååºçš„æ ¸å¿ƒåŒºåˆ«ï¼Œæœ¬è´¨æ˜¯â€œåœ¨èŠ‚ç‚¹çš„ç”Ÿå‘½å‘¨æœŸä¸­é€‰æ‹©æ‰§è¡Œä»£ç çš„æ—¶æœºâ€ï¼š</p>
<ul>
<li>
<p><strong>å‰åºä½ç½®</strong>ï¼šè¿›å…¥èŠ‚ç‚¹æ—¶æ‰§è¡Œï¼ˆç¬¬ä¸€æ¬¡è®¿é—®èŠ‚ç‚¹ï¼ŒåªçŸ¥é“çˆ¶èŠ‚ç‚¹ä¿¡æ¯ï¼‰ï¼Œä¹Ÿæ˜¯â€œè¿›å…¥è¿™ä¸ªèŠ‚ç‚¹â€çš„æ ‡å¿—ï¼›</p>
</li>
<li>
<p><strong>ä¸­åºä½ç½®</strong>ï¼šå·¦å­æ ‘éå†å®Œæˆåã€å³å­æ ‘éå†å¼€å§‹å‰æ‰§è¡Œï¼ˆç¬¬äºŒæ¬¡è®¿é—®èŠ‚ç‚¹ï¼Œå·²çŸ¥é“å·¦å­æ ‘æ‰€æœ‰ä¿¡æ¯ï¼‰ï¼›</p>
</li>
<li>
<p><strong>ååºä½ç½®</strong>ï¼šå·¦å³å­æ ‘éå†å®Œæˆåæ‰§è¡Œï¼ˆç¬¬ä¸‰æ¬¡è®¿é—®èŠ‚ç‚¹ï¼Œå·²çŸ¥é“æ‰€æœ‰å­æ ‘ä¿¡æ¯ï¼‰ï¼Œä¹Ÿæ˜¯â€œç¦»å¼€è¿™ä¸ªèŠ‚ç‚¹â€çš„æ ‡å¿—ã€‚</p>
</li>
</ul>
<h5 data-id="heading-10">åŸºç¡€æ¡†æ¶ï¼ˆäºŒå‰æ ‘ï¼‰</h5>
<pre><code class="hljs language-JavaScript" lang="JavaScript">
<span class="hljs-comment">// äºŒå‰æ ‘é€’å½’éå†æ ¸å¿ƒæ¡†æ¶</span>
<span class="hljs-keyword">var</span> traverse = <span class="hljs-keyword">function</span>(<span class="hljs-params">root</span>) {
    <span class="hljs-keyword">if</span> (root === <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-comment">// å‰åºä½ç½®ï¼šè¿›å…¥å½“å‰èŠ‚ç‚¹æ—¶æ‰§è¡Œï¼ˆå¦‚æ”¶é›†èŠ‚ç‚¹å€¼ã€åˆå§‹åŒ–çŠ¶æ€ï¼‰</span>
    <span class="hljs-comment">// å…¸å‹åœºæ™¯ï¼šè®°å½•è·¯å¾„ï¼ˆå…¥æ ˆï¼‰ã€ç»Ÿè®¡è·¯å¾„å’Œã€åˆå§‹åŒ–å­æ ‘çŠ¶æ€</span>
    <span class="hljs-title function_">traverse</span>(root.<span class="hljs-property">left</span>); <span class="hljs-comment">// é€’å½’å·¦å­æ ‘</span>
    <span class="hljs-comment">// ä¸­åºä½ç½®ï¼šå·¦å­æ ‘å¤„ç†å®Œï¼Œå³å­æ ‘æœªå¼€å§‹ï¼ˆBSTä¸­åºéå†æ˜¯æœ‰åºçš„ï¼ï¼‰</span>
    <span class="hljs-comment">// å…¸å‹åœºæ™¯ï¼šBSTçš„æœ‰åºéå†ã€å·¦å­æ ‘ç»“æœæ ¡éªŒ</span>
    <span class="hljs-title function_">traverse</span>(root.<span class="hljs-property">right</span>); <span class="hljs-comment">// é€’å½’å³å­æ ‘</span>
    <span class="hljs-comment">// ååºä½ç½®ï¼šç¦»å¼€å½“å‰èŠ‚ç‚¹æ—¶æ‰§è¡Œï¼ˆå­æ ‘å…¨éƒ¨å¤„ç†å®Œï¼‰</span>
    <span class="hljs-comment">// å…¸å‹åœºæ™¯ï¼šå›æº¯ï¼ˆå‡ºæ ˆï¼‰ã€ç»Ÿè®¡å­æ ‘é«˜åº¦ã€åˆå¹¶å­æ ‘ç»“æœã€é‡Šæ”¾å­æ ‘çŠ¶æ€</span>
};
</code></pre>
<h5 data-id="heading-11">å…³é”®è¡¥å……ï¼šå‰åº=è¿›å…¥ï¼Œååº=ç¦»å¼€</h5>
<p>è¿™ä¸ªâ€œè¿›å…¥/ç¦»å¼€â€çš„ç‰¹æ€§æ˜¯å›æº¯ç®—æ³•çš„æ ¸å¿ƒï¼š</p>
<ul>
<li>
<p>å‰åºä½ç½®åšçš„æ“ä½œï¼Œæ˜¯â€œè¿›å…¥èŠ‚ç‚¹æ—¶çš„åˆå§‹åŒ–â€ï¼ˆæ¯”å¦‚æŠŠèŠ‚ç‚¹åŠ å…¥è·¯å¾„æ ˆï¼‰ï¼›</p>
</li>
<li>
<p>ååºä½ç½®åšçš„æ“ä½œï¼Œæ˜¯â€œç¦»å¼€èŠ‚ç‚¹æ—¶çš„æ¸…ç†â€ï¼ˆæ¯”å¦‚æŠŠèŠ‚ç‚¹ä»è·¯å¾„æ ˆä¸­å¼¹å‡ºï¼Œæ¢å¤çŠ¶æ€ï¼‰ï¼›</p>
</li>
<li>
<p>æ•´ä¸ªé€’å½’è¿‡ç¨‹ï¼Œå°±æ˜¯â€œè¿›å…¥çˆ¶èŠ‚ç‚¹â†’è¿›å…¥å·¦å­èŠ‚ç‚¹â†’ç¦»å¼€å·¦å­èŠ‚ç‚¹â†’è¿›å…¥å³å­èŠ‚ç‚¹â†’ç¦»å¼€å³å­èŠ‚ç‚¹â†’ç¦»å¼€çˆ¶èŠ‚ç‚¹â€çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸã€‚</p>
</li>
</ul>
<h5 data-id="heading-12">å¤šå‰æ ‘é€‚é…ï¼ˆæ— ä¸­åºä½ç½®ï¼‰</h5>
<p>å¤šå‰æ ‘æ²¡æœ‰â€œå·¦/å³â€ä¹‹åˆ†ï¼Œä»…ä¿ç•™å‰åºï¼ˆè¿›å…¥ï¼‰/ååºï¼ˆç¦»å¼€ï¼‰ä½ç½®â€”â€”å› ä¸ºæ²¡æœ‰â€œå·¦å­æ ‘å¤„ç†å®Œã€å³å­æ ‘æœªå¼€å§‹â€çš„ä¸­é—´çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">
<span class="hljs-comment">// Nå‰æ ‘é€’å½’éå†æ¡†æ¶</span>
<span class="hljs-keyword">var</span> traverse = <span class="hljs-keyword">function</span>(<span class="hljs-params">root</span>) {
    <span class="hljs-keyword">if</span> (root === <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-comment">// å‰åºä½ç½®ï¼šè¿›å…¥å½“å‰èŠ‚ç‚¹</span>
    root.<span class="hljs-property">children</span>?.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span> <span class="hljs-title function_">traverse</span>(child)); <span class="hljs-comment">// éå†æ‰€æœ‰å­èŠ‚ç‚¹</span>
    <span class="hljs-comment">// ååºä½ç½®ï¼šç¦»å¼€å½“å‰èŠ‚ç‚¹ï¼ˆæ‰€æœ‰å­èŠ‚ç‚¹éƒ½å·²éå†å®Œæˆï¼‰</span>
};
</code></pre>
<h5 data-id="heading-13">å®æˆ˜ï¼šDFSæ‰¾æ‰€æœ‰æ ¹åˆ°å¶å­çš„è·¯å¾„</h5>
<p>åˆ©ç”¨â€œå‰åºå…¥æ ˆï¼ˆè¿›å…¥èŠ‚ç‚¹ï¼‰ã€ååºå‡ºæ ˆï¼ˆç¦»å¼€èŠ‚ç‚¹ï¼‰â€çš„å›æº¯æ€æƒ³ï¼Œæ”¶é›†æ‰€æœ‰è·¯å¾„ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">
<span class="hljs-keyword">function</span> <span class="hljs-title function_">traverseDFS</span>(<span class="hljs-params">root</span>) {
    <span class="hljs-keyword">const</span> res = []; <span class="hljs-comment">// å­˜å‚¨æ‰€æœ‰è·¯å¾„</span>
    <span class="hljs-keyword">const</span> path = []; <span class="hljs-comment">// è®°å½•å½“å‰è·¯å¾„ï¼ˆå›æº¯æ ˆï¼‰</span>

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">traverse</span>(<span class="hljs-params">node</span>) {
        <span class="hljs-keyword">if</span> (node === <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;
        
        path.<span class="hljs-title function_">push</span>(node.<span class="hljs-property">val</span>); <span class="hljs-comment">// å‰åºï¼šè¿›å…¥èŠ‚ç‚¹ï¼ŒåŠ å…¥è·¯å¾„ï¼ˆåˆå§‹åŒ–ï¼‰</span>
        <span class="hljs-comment">// å¶å­èŠ‚ç‚¹ï¼šä¿å­˜è·¯å¾„å‰¯æœ¬ï¼ˆå¿…é¡»æ‹·è´ï¼Œé¿å…å¼•ç”¨é—®é¢˜ï¼‰</span>
        <span class="hljs-keyword">if</span> (!node.<span class="hljs-property">left</span> &amp;&amp; !node.<span class="hljs-property">right</span>) {
            res.<span class="hljs-title function_">push</span>([...path]);
        }
        
        <span class="hljs-title function_">traverse</span>(node.<span class="hljs-property">left</span>); <span class="hljs-comment">// é€’å½’å·¦å­æ ‘ï¼ˆè¿›å…¥å·¦å­èŠ‚ç‚¹ï¼‰</span>
        <span class="hljs-title function_">traverse</span>(node.<span class="hljs-property">right</span>); <span class="hljs-comment">// é€’å½’å³å­æ ‘ï¼ˆè¿›å…¥å³å­èŠ‚ç‚¹ï¼‰</span>
        
        path.<span class="hljs-title function_">pop</span>(); <span class="hljs-comment">// ååºï¼šç¦»å¼€èŠ‚ç‚¹ï¼Œå›æº¯å‡ºæ ˆï¼ˆæ¸…ç†çŠ¶æ€ï¼‰</span>
    }

    <span class="hljs-title function_">traverse</span>(root);
    <span class="hljs-keyword">return</span> res;
}

<span class="hljs-comment">// æµ‹è¯•ï¼šè¾“å‡º [[1,2,5], [1,3]]</span>
<span class="hljs-keyword">const</span> root = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(<span class="hljs-number">1</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(<span class="hljs-number">2</span>, <span class="hljs-literal">null</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(<span class="hljs-number">5</span>)), <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(<span class="hljs-number">3</span>));
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">traverseDFS</span>(root));
</code></pre>
<h4 data-id="heading-14">3.2 å±‚åºéå†ï¼ˆBFSï¼‰ï¼šæŒæ¡â€œå±‚çº§ç”Ÿå‘½å‘¨æœŸâ€</h4>
<p>å±‚åºéå†ä¾èµ–é˜Ÿåˆ—å®ç°ï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰ï¼Œæ ¸å¿ƒæ˜¯é€šè¿‡ <code>curLevelSize</code> å›ºå®šå½“å‰å±‚èŠ‚ç‚¹æ•°ï¼Œæ›´å…³é”®çš„æ˜¯æŠ“ä½â€œè¿›å…¥å±‚â€å’Œâ€œç¦»å¼€å±‚â€ä¸¤ä¸ªæ ¸å¿ƒæ—¶æœºâ€”â€”è¿™æ˜¯æŒ‰å±‚å¤„ç†é€»è¾‘çš„çµé­‚ã€‚</p>
<h5 data-id="heading-15">æ ¸å¿ƒé€»è¾‘ï¼šå±‚çš„â€œè¿›å…¥â€ä¸â€œç¦»å¼€â€</h5>
<ul>
<li>
<p><strong>è¿›å…¥å±‚</strong>ï¼š<code>level++</code> ä¹‹åã€éå†å½“å‰å±‚èŠ‚ç‚¹ä¹‹å‰ï¼Œæ˜¯â€œè¿›å…¥è¯¥å±‚â€çš„æ ‡å¿—ï¼ˆå¯åšå±‚åˆå§‹åŒ–ï¼šå¦‚åˆ›å»ºå½“å‰å±‚æ•°ç»„ã€è®°å½•å±‚å¼€å§‹æ—¶é—´ï¼‰ï¼›</p>
</li>
<li>
<p><strong>ç¦»å¼€å±‚</strong>ï¼šå½“å‰å±‚æ‰€æœ‰èŠ‚ç‚¹éå†å®Œæˆï¼ˆforå¾ªç¯ç»“æŸåï¼‰ï¼Œæ˜¯â€œç¦»å¼€è¯¥å±‚â€çš„æ ‡å¿—ï¼ˆå¯åšå±‚ç»“æœæ±‡æ€»ï¼šå¦‚å°†å½“å‰å±‚æ•°ç»„å­˜å…¥ç»“æœã€ç»Ÿè®¡å±‚èŠ‚ç‚¹æ•°ï¼‰ã€‚</p>
</li>
</ul>
<h5 data-id="heading-16">åŸºç¡€æ¡†æ¶ï¼ˆäºŒå‰æ ‘ï¼Œæ ‡æ³¨å±‚ç”Ÿå‘½å‘¨æœŸï¼‰</h5>
<pre><code class="hljs language-JavaScript" lang="JavaScript">
<span class="hljs-keyword">function</span> <span class="hljs-title function_">traverseBFS</span>(<span class="hljs-params">root</span>) {
    <span class="hljs-keyword">if</span> (!root) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-keyword">let</span> level = <span class="hljs-number">0</span>; <span class="hljs-comment">// è®°å½•å½“å‰å±‚æ•°</span>
    <span class="hljs-keyword">const</span> queue = [root]; <span class="hljs-comment">// åˆå§‹åŒ–é˜Ÿåˆ—</span>
    
    <span class="hljs-keyword">while</span> (queue.<span class="hljs-property">length</span>) {
        <span class="hljs-comment">// ====== è¿›å…¥å½“å‰å±‚ ======</span>
        level++;
        <span class="hljs-keyword">const</span> curLevelSize = queue.<span class="hljs-property">length</span>; <span class="hljs-comment">// å…³é”®ï¼šå›ºå®šå½“å‰å±‚èŠ‚ç‚¹æ•°ï¼ˆé¿å…åç»­å…¥é˜Ÿå¹²æ‰°ï¼‰</span>
        <span class="hljs-keyword">const</span> curLevelNodes = []; <span class="hljs-comment">// å­˜å‚¨å½“å‰å±‚èŠ‚ç‚¹å€¼ï¼ˆå±‚åˆå§‹åŒ–ï¼‰</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`===== è¿›å…¥ç¬¬ <span class="hljs-subst">${level}</span> å±‚ =====`</span>);
        
        <span class="hljs-comment">// éå†å½“å‰å±‚æ‰€æœ‰èŠ‚ç‚¹</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; curLevelSize; i++) {
            <span class="hljs-keyword">const</span> curNode = queue.<span class="hljs-title function_">shift</span>(); <span class="hljs-comment">// å–å‡ºé˜Ÿé¦–èŠ‚ç‚¹</span>
            curLevelNodes.<span class="hljs-title function_">push</span>(curNode.<span class="hljs-property">val</span>); <span class="hljs-comment">// æ”¶é›†å½“å‰å±‚èŠ‚ç‚¹å€¼</span>
            
            <span class="hljs-comment">// å­èŠ‚ç‚¹å…¥é˜Ÿï¼ˆä¸ºä¸‹ä¸€å±‚åšå‡†å¤‡ï¼‰</span>
            curNode.<span class="hljs-property">left</span> &amp;&amp; queue.<span class="hljs-title function_">push</span>(curNode.<span class="hljs-property">left</span>);
            curNode.<span class="hljs-property">right</span> &amp;&amp; queue.<span class="hljs-title function_">push</span>(curNode.<span class="hljs-property">right</span>);
        }
        
        <span class="hljs-comment">// ====== ç¦»å¼€å½“å‰å±‚ ======</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`===== ç¦»å¼€ç¬¬ <span class="hljs-subst">${level}</span> å±‚ï¼Œè¯¥å±‚èŠ‚ç‚¹ï¼š<span class="hljs-subst">${curLevelNodes}</span> =====`</span>);
        <span class="hljs-comment">// å…¸å‹åœºæ™¯ï¼šå±‚ç»“æœæ±‡æ€»ã€å±‚æ ¡éªŒã€å±‚ç»Ÿè®¡</span>
    }
}
</code></pre>
<h5 data-id="heading-17">å…³é”®è¡¥å……ï¼šä¸ºä»€ä¹ˆéœ€è¦â€œè¿›å…¥/ç¦»å¼€å±‚â€ï¼Ÿ</h5>
<p>æ¯”å¦‚å®ç°â€œæ”¶é›†æ¯å±‚èŠ‚ç‚¹å€¼â€â€œæ±‚æ¯å±‚èŠ‚ç‚¹æ•°æœ€å¤§å€¼â€â€œæŒ‰å±‚åè½¬èŠ‚ç‚¹é¡ºåºâ€ç­‰éœ€æ±‚ï¼Œæ ¸å¿ƒé€»è¾‘éƒ½è¦åœ¨â€œè¿›å…¥å±‚â€åˆå§‹åŒ–ã€â€œç¦»å¼€å±‚â€æ±‡æ€»ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">
<span class="hljs-comment">// å®æˆ˜ï¼šæ”¶é›†æ¯å±‚èŠ‚ç‚¹å€¼ï¼ˆæ ¸å¿ƒä¾èµ–å±‚çš„è¿›å…¥/ç¦»å¼€ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">levelOrder</span>(<span class="hljs-params">root</span>) {
    <span class="hljs-keyword">const</span> res = [];
    <span class="hljs-keyword">if</span> (!root) <span class="hljs-keyword">return</span> res;
    
    <span class="hljs-keyword">const</span> queue = [root];
    <span class="hljs-keyword">let</span> level = <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">while</span> (queue.<span class="hljs-property">length</span>) {
        <span class="hljs-comment">// è¿›å…¥å±‚ï¼šåˆå§‹åŒ–å½“å‰å±‚æ•°ç»„</span>
        level++;
        <span class="hljs-keyword">const</span> curLevelSize = queue.<span class="hljs-property">length</span>;
        <span class="hljs-keyword">const</span> curLevel = [];
        
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; curLevelSize; i++) {
            <span class="hljs-keyword">const</span> curNode = queue.<span class="hljs-title function_">shift</span>();
            curLevel.<span class="hljs-title function_">push</span>(curNode.<span class="hljs-property">val</span>);
            curNode.<span class="hljs-property">left</span> &amp;&amp; queue.<span class="hljs-title function_">push</span>(curNode.<span class="hljs-property">left</span>);
            curNode.<span class="hljs-property">right</span> &amp;&amp; queue.<span class="hljs-title function_">push</span>(curNode.<span class="hljs-property">right</span>);
        }
        
        <span class="hljs-comment">// ç¦»å¼€å±‚ï¼šæ±‡æ€»å½“å‰å±‚ç»“æœåˆ°æœ€ç»ˆæ•°ç»„</span>
        res.<span class="hljs-title function_">push</span>(curLevel);
    }
    <span class="hljs-keyword">return</span> res;
}
</code></pre>
<h5 data-id="heading-18">å¤šå‰æ ‘é€‚é…ï¼ˆå­èŠ‚ç‚¹æ•°ç»„å±•å¼€ï¼‰</h5>
<pre><code class="hljs language-JavaScript" lang="JavaScript">
<span class="hljs-comment">// Nå‰æ ‘å±‚åºéå†ï¼ˆè¿”å›äºŒç»´æ•°ç»„ï¼šæ¯å±‚èŠ‚ç‚¹ä¸ºä¸€ä¸ªå­æ•°ç»„ï¼‰</span>
<span class="hljs-keyword">var</span> levelOrder = <span class="hljs-keyword">function</span>(<span class="hljs-params">root</span>) {
    <span class="hljs-keyword">const</span> res = [];
    <span class="hljs-keyword">if</span> (!root) <span class="hljs-keyword">return</span> res;
    
    <span class="hljs-keyword">const</span> queue = [root];
    <span class="hljs-keyword">while</span> (queue.<span class="hljs-property">length</span>) {
        <span class="hljs-comment">// è¿›å…¥å±‚ï¼šåˆå§‹åŒ–</span>
        <span class="hljs-keyword">const</span> curLevelSize = queue.<span class="hljs-property">length</span>;
        <span class="hljs-keyword">const</span> curLevel = [];
        
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; curLevelSize; i++) {
            <span class="hljs-keyword">const</span> curNode = queue.<span class="hljs-title function_">shift</span>();
            curLevel.<span class="hljs-title function_">push</span>(curNode.<span class="hljs-property">val</span>);
            
            <span class="hljs-comment">// å¤šå‰æ ‘ï¼šå­èŠ‚ç‚¹æ•°ç»„å±•å¼€å…¥é˜Ÿ</span>
            <span class="hljs-keyword">if</span> (curNode.<span class="hljs-property">children</span> &amp;&amp; curNode.<span class="hljs-property">children</span>.<span class="hljs-property">length</span>) {
                queue.<span class="hljs-title function_">push</span>(...curNode.<span class="hljs-property">children</span>);
            }
        }
        
        <span class="hljs-comment">// ç¦»å¼€å±‚ï¼šæ±‡æ€»</span>
        res.<span class="hljs-title function_">push</span>(curLevel);
    }
    <span class="hljs-keyword">return</span> res;
};

<span class="hljs-comment">// æµ‹è¯•ï¼šè¾“å‡º [[1], [3,2,4], [5,6]]</span>
<span class="hljs-keyword">const</span> nRoot = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(<span class="hljs-number">1</span>, [<span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(<span class="hljs-number">3</span>, [<span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(<span class="hljs-number">5</span>), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(<span class="hljs-number">6</span>)]), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(<span class="hljs-number">2</span>), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(<span class="hljs-number">4</span>)]);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">levelOrder</span>(nRoot));
</code></pre>
<h5 data-id="heading-19">å®æˆ˜ï¼šBFSæ‰¾äºŒå‰æ ‘æœ€å°æ·±åº¦ï¼ˆæœ€ä¼˜è§£ï¼‰</h5>
<p>å±‚åºéå†æ˜¯â€œæœ€çŸ­è·¯å¾„/æœ€å°æ·±åº¦â€çš„æœ€ä¼˜è§£â€”â€”æ ¸å¿ƒæ˜¯åœ¨â€œéå†å±‚å†…èŠ‚ç‚¹æ—¶â€åˆ¤æ–­å¶å­èŠ‚ç‚¹ï¼Œæ‰¾åˆ°åç›´æ¥è¿”å›ï¼ˆæ— éœ€èµ°åˆ°â€œç¦»å¼€å±‚â€ï¼‰ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">
<span class="hljs-keyword">function</span> <span class="hljs-title function_">minDepth</span>(<span class="hljs-params">root</span>) {
    <span class="hljs-keyword">if</span> (!root) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">let</span> level = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> queue = [root];
    
    <span class="hljs-keyword">while</span> (queue.<span class="hljs-property">length</span>) {
        <span class="hljs-comment">// è¿›å…¥å±‚</span>
        level++;
        <span class="hljs-keyword">const</span> curLevelSize = queue.<span class="hljs-property">length</span>;
        
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; curLevelSize; i++) {
            <span class="hljs-keyword">const</span> curNode = queue.<span class="hljs-title function_">shift</span>();
            <span class="hljs-comment">// æ ¸å¿ƒï¼šå±‚å†…æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¶å­èŠ‚ç‚¹ï¼Œç›´æ¥è¿”å›å½“å‰å±‚æ•°ï¼ˆæœ€å°æ·±åº¦ï¼‰</span>
            <span class="hljs-keyword">if</span> (!curNode.<span class="hljs-property">left</span> &amp;&amp; !curNode.<span class="hljs-property">right</span>) {
                <span class="hljs-keyword">return</span> level;
            }
            curNode.<span class="hljs-property">left</span> &amp;&amp; queue.<span class="hljs-title function_">push</span>(curNode.<span class="hljs-property">left</span>);
            curNode.<span class="hljs-property">right</span> &amp;&amp; queue.<span class="hljs-title function_">push</span>(curNode.<span class="hljs-property">right</span>);
        }
        <span class="hljs-comment">// æ— éœ€èµ°åˆ°ç¦»å¼€å±‚ï¼Œæå‰ç»ˆæ­¢</span>
    }
    <span class="hljs-keyword">return</span> level;
}
</code></pre>
<h4 data-id="heading-20">3.3 DFS vs BFSï¼šæ ¸å¿ƒåŒºåˆ«</h4>








































<table><thead><tr><th>ç»´åº¦</th><th>DFSï¼ˆé€’å½’éå†ï¼‰</th><th>BFSï¼ˆå±‚åºéå†ï¼‰</th></tr></thead><tbody><tr><td>æ ¸å¿ƒæ•°æ®ç»“æ„</td><td>è°ƒç”¨æ ˆï¼ˆé€’å½’ï¼‰</td><td>é˜Ÿåˆ—</td></tr><tr><td>éå†é¡ºåº</td><td>å…ˆæ·±åå¹¿ï¼ˆä¸€æ¡è·¯èµ°åˆ°å¤´ï¼‰</td><td>å…ˆå¹¿åæ·±ï¼ˆæŒ‰å±‚éå†ï¼‰</td></tr><tr><td>ç”Ÿå‘½å‘¨æœŸ</td><td>èŠ‚ç‚¹çº§ï¼šå‰åº=è¿›å…¥ã€ååº=ç¦»å¼€ï¼ˆå›æº¯æ ¸å¿ƒï¼‰</td><td>å±‚çº§çº§ï¼šè¿›å…¥å±‚=åˆå§‹åŒ–ã€ç¦»å¼€å±‚=æ±‡æ€»</td></tr><tr><td>ç©ºé—´å¤æ‚åº¦</td><td>æœ€åO(n)ï¼ˆé€€åŒ–æˆé“¾è¡¨ï¼‰</td><td>æœ€åO(n)ï¼ˆæœ€åä¸€å±‚èŠ‚ç‚¹æ•°ï¼‰</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>æ‰¾æ‰€æœ‰è·¯å¾„ã€ç»Ÿè®¡å­æ ‘ä¿¡æ¯</td><td>æ‰¾æœ€çŸ­è·¯å¾„ã€æŒ‰å±‚å¤„ç†èŠ‚ç‚¹</td></tr><tr><td>ç»ˆæ­¢æ¡ä»¶</td><td>éå†å®Œæ‰€æœ‰èŠ‚ç‚¹</td><td>å¯æå‰ç»ˆæ­¢ï¼ˆå¦‚æ‰¾æœ€å°æ·±åº¦ï¼‰</td></tr></tbody></table>
<h4 data-id="heading-21">3.4 BFSè¿›é˜¶ï¼šå¸¦è·¯å¾„çš„å±‚åºéå†</h4>
<p>BFSæ— èŠ‚ç‚¹çº§çš„â€œè¿›å…¥/ç¦»å¼€â€ç”Ÿå‘½å‘¨æœŸï¼Œéœ€æ‰‹åŠ¨å°è£…â€œèŠ‚ç‚¹+è·¯å¾„â€çš„çŠ¶æ€ï¼Œæ¨¡æ‹ŸDFSçš„è·¯å¾„å›æº¯ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">
<span class="hljs-comment">// å°è£…çŠ¶æ€èŠ‚ç‚¹ï¼šç»‘å®šèŠ‚ç‚¹å’Œå¯¹åº”çš„è·¯å¾„</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">StateNode</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">node, path</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">node</span> = node; <span class="hljs-comment">// å½“å‰èŠ‚ç‚¹</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">path</span> = path; <span class="hljs-comment">// æ ¹åˆ°å½“å‰èŠ‚ç‚¹çš„è·¯å¾„</span>
    }
}

<span class="hljs-comment">// BFSæ‰¾æ‰€æœ‰æ ¹åˆ°å¶å­çš„è·¯å¾„</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">traverseBFS</span>(<span class="hljs-params">root</span>) {
    <span class="hljs-keyword">const</span> res = [];
    <span class="hljs-keyword">if</span> (!root) <span class="hljs-keyword">return</span> res;
    
    <span class="hljs-comment">// é˜Ÿåˆ—å­˜å‚¨StateNodeï¼Œåˆå§‹å€¼ï¼šæ ¹èŠ‚ç‚¹ + æ ¹èŠ‚ç‚¹è·¯å¾„ï¼ˆæ¨¡æ‹Ÿâ€œè¿›å…¥æ ¹èŠ‚ç‚¹â€ï¼‰</span>
    <span class="hljs-keyword">const</span> queue = [<span class="hljs-keyword">new</span> <span class="hljs-title class_">StateNode</span>(root, [root.<span class="hljs-property">val</span>])];
    
    <span class="hljs-keyword">while</span> (queue.<span class="hljs-property">length</span>) {
        <span class="hljs-keyword">const</span> cur = queue.<span class="hljs-title function_">shift</span>();
        <span class="hljs-comment">// å¶å­èŠ‚ç‚¹ï¼šä¿å­˜è·¯å¾„ï¼ˆæ¨¡æ‹Ÿâ€œç¦»å¼€å¶å­èŠ‚ç‚¹â€ï¼‰</span>
        <span class="hljs-keyword">if</span> (!cur.<span class="hljs-property">node</span>.<span class="hljs-property">left</span> &amp;&amp; !cur.<span class="hljs-property">node</span>.<span class="hljs-property">right</span>) {
            res.<span class="hljs-title function_">push</span>([...cur.<span class="hljs-property">path</span>]);
            <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-comment">// å·¦å­èŠ‚ç‚¹å…¥é˜Ÿï¼šè·¯å¾„æ‹·è´ + è¿½åŠ å·¦å­èŠ‚ç‚¹å€¼ï¼ˆæ¨¡æ‹Ÿâ€œè¿›å…¥å·¦èŠ‚ç‚¹â€ï¼‰</span>
        <span class="hljs-keyword">if</span> (cur.<span class="hljs-property">node</span>.<span class="hljs-property">left</span>) {
            queue.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StateNode</span>(cur.<span class="hljs-property">node</span>.<span class="hljs-property">left</span>, [...cur.<span class="hljs-property">path</span>, cur.<span class="hljs-property">node</span>.<span class="hljs-property">left</span>.<span class="hljs-property">val</span>]));
        }
        <span class="hljs-comment">// å³å­èŠ‚ç‚¹å…¥é˜Ÿï¼šè·¯å¾„æ‹·è´ + è¿½åŠ å³å­èŠ‚ç‚¹å€¼ï¼ˆæ¨¡æ‹Ÿâ€œè¿›å…¥å³èŠ‚ç‚¹â€ï¼‰</span>
        <span class="hljs-keyword">if</span> (cur.<span class="hljs-property">node</span>.<span class="hljs-property">right</span>) {
            queue.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StateNode</span>(cur.<span class="hljs-property">node</span>.<span class="hljs-property">right</span>, [...cur.<span class="hljs-property">path</span>, cur.<span class="hljs-property">node</span>.<span class="hljs-property">right</span>.<span class="hljs-property">val</span>]));
        }
    }
    <span class="hljs-keyword">return</span> res;
}
</code></pre>
<h3 data-id="heading-22">æ ¸å¿ƒæ€»ç»“</h3>
<ol>
<li>
<p><strong>äºŒå‰æ ‘æ˜¯ç®—æ³•çš„â€œå…ƒç»“æ„â€</strong>ï¼šå¤æ‚é—®é¢˜å¯æŠ½è±¡ä¸ºâ€œæ ‘çš„éå†â€ï¼ŒæŒæ¡éå†æ¡†æ¶å°±æŒæ¡äº†æ ¸å¿ƒï¼›</p>
</li>
<li>
<p><strong>é€’å½’éå†æŠ“â€œèŠ‚ç‚¹ç”Ÿå‘½å‘¨æœŸâ€</strong>ï¼šå‰åº=è¿›å…¥èŠ‚ç‚¹ï¼ˆåˆå§‹åŒ–ï¼‰ã€ä¸­åº=å·¦å­æ ‘å¤„ç†å®Œï¼ˆä¸­é—´æ ¡éªŒï¼‰ã€ååº=ç¦»å¼€èŠ‚ç‚¹ï¼ˆæ¸…ç†/åˆå¹¶ï¼‰ï¼›</p>
</li>
<li>
<p><strong>å±‚åºéå†æŠ“â€œå±‚çº§ç”Ÿå‘½å‘¨æœŸâ€</strong>ï¼šé€šè¿‡<code>curLevelSize</code>å›ºå®šå½“å‰å±‚èŠ‚ç‚¹æ•°ï¼Œè¿›å…¥å±‚åšåˆå§‹åŒ–ã€ç¦»å¼€å±‚åšç»“æœæ±‡æ€»ï¼Œæ˜¯æŒ‰å±‚å¤„ç†çš„å…³é”®ï¼›</p>
</li>
<li>
<p><strong>DFS/BFSé€‰å‹åŸåˆ™</strong>ï¼šæ‰¾æ‰€æœ‰è·¯å¾„ç”¨DFSï¼ˆåˆ©ç”¨èŠ‚ç‚¹çº§è¿›å…¥/ç¦»å¼€çš„å›æº¯ï¼‰ï¼Œæ‰¾æœ€çŸ­è·¯å¾„ç”¨BFSï¼ˆåˆ©ç”¨å±‚çº§éå†å¯æå‰ç»ˆæ­¢ï¼‰ï¼›</p>
</li>
<li>
<p><strong>ç»ƒä¹ æ ¸å¿ƒ</strong>ï¼šå…ˆæŒæ¡æ¡†æ¶å†åˆ·çœŸé¢˜ï¼Œæ¯é“é¢˜å°è¯•ä¸¤ç§éå†æ–¹å¼ï¼Œå¼ºåŒ–â€œæ ‘çŠ¶æ€ç»´â€ã€‚</p>
</li>
</ol>
<p>åƒé€äºŒå‰æ ‘çš„æ ¸å¿ƒä¸æ˜¯èƒŒä»£ç ï¼Œè€Œæ˜¯å»ºç«‹â€œæ ‘çŠ¶æ€ç»´â€â€”â€”çœ‹åˆ°é—®é¢˜èƒ½æŠ½è±¡æˆæ ‘ï¼Œçœ‹åˆ°ä»£ç èƒ½è”æƒ³åˆ°â€œèŠ‚ç‚¹çš„è¿›å…¥/ç¦»å¼€â€æˆ–â€œå±‚çº§çš„è¿›å…¥/ç¦»å¼€â€ã€‚</p>
<h3 data-id="heading-23">é’ˆå¯¹æ€§ç»ƒä¹ ï¼ˆLeetCodeï¼‰</h3>
<h4 data-id="heading-24">ç»ƒä¹ å»ºè®®</h4>
<ol>
<li>
<p><strong>å…ˆåˆ·åŸºç¡€éå†</strong>ï¼š144ã€94ã€145ã€102 å¿…é¡»æŒæ¡é€’å½’+è¿­ä»£ä¸¤ç§å†™æ³•ï¼›</p>
</li>
<li>
<p><strong>å¯¹æ¯”ç»ƒä¹ DFS/BFS</strong>ï¼šåŒä¸€é“é¢˜ï¼ˆå¦‚104ã€111ï¼‰åˆ†åˆ«ç”¨DFSå’ŒBFSå®ç°ï¼Œç†è§£ä¸¤ç§æ€è·¯çš„å·®å¼‚ï¼›</p>
</li>
<li>
<p><strong>èšç„¦ç”Ÿå‘½å‘¨æœŸ</strong>ï¼šå†™ä»£ç æ—¶æ˜ç¡®æ ‡æ³¨â€œå‰åº/ä¸­åº/ååºâ€æˆ–â€œè¿›å…¥å±‚/ç¦»å¼€å±‚â€ï¼Œå¼ºåŒ–æ€ç»´ï¼›</p>
</li>
<li>
<p><strong>å¤šå‰æ ‘é€‚é…</strong>ï¼š589ã€590ã€429 å¸®åŠ©ç†è§£â€œå»æ‰ä¸­åºä½ç½®â€çš„é€»è¾‘ï¼Œè§¦ç±»æ—é€šï¼›</p>
</li>
<li>
<p><strong>è¿›é˜¶é¢˜æ‹†è§£</strong>ï¼šå¦‚199ï¼ˆäºŒå‰æ ‘å³è§†å›¾ï¼‰æœ¬è´¨æ˜¯â€œå±‚åºéå†å–æ¯å±‚æœ€åä¸€ä¸ªèŠ‚ç‚¹â€ï¼Œæ‹†è§£åéƒ½æ˜¯åŸºç¡€æ¡†æ¶çš„å˜å½¢ã€‚</p>
</li>
</ol>
<h4 data-id="heading-25">åŸºç¡€éå†ç±»ï¼ˆæŒæ¡æ¡†æ¶ï¼‰</h4>





















































<table><thead><tr><th>é¢˜ç›®é“¾æ¥</th><th>éš¾åº¦</th><th>æ ¸å¿ƒè€ƒç‚¹</th><th>è§£é¢˜æç¤º</th></tr></thead><tbody><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fbinary-tree-preorder-traversal%2F" target="_blank" title="https://leetcode.cn/problems/binary-tree-preorder-traversal/" ref="nofollow noopener noreferrer">144. äºŒå‰æ ‘çš„å‰åºéå†</a></td><td>ç®€å•</td><td>é€’å½’/è¿­ä»£å®ç°å‰åºéå†</td><td>é€’å½’æ¡†æ¶å‰åºä½ç½®æ”¶é›†èŠ‚ç‚¹ï¼›è¿­ä»£ç”¨æ ˆæ¨¡æ‹Ÿé€’å½’</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fbinary-tree-inorder-traversal%2F" target="_blank" title="https://leetcode.cn/problems/binary-tree-inorder-traversal/" ref="nofollow noopener noreferrer">94. äºŒå‰æ ‘çš„ä¸­åºéå†</a></td><td>ç®€å•</td><td>é€’å½’/è¿­ä»£å®ç°ä¸­åºéå†</td><td>BSTçš„ä¸­åºéå†æ˜¯æœ‰åºçš„ï¼Œè¿™æ˜¯é«˜é¢‘è€ƒç‚¹</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fbinary-tree-postorder-traversal%2F" target="_blank" title="https://leetcode.cn/problems/binary-tree-postorder-traversal/" ref="nofollow noopener noreferrer">145. äºŒå‰æ ‘çš„ååºéå†</a></td><td>ç®€å•</td><td>é€’å½’/è¿­ä»£å®ç°ååºéå†</td><td>ååºä½ç½®é€‚åˆåˆå¹¶å­æ ‘ç»“æœ</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fbinary-tree-level-order-traversal%2F" target="_blank" title="https://leetcode.cn/problems/binary-tree-level-order-traversal/" ref="nofollow noopener noreferrer">102. äºŒå‰æ ‘çš„å±‚åºéå†</a></td><td>ä¸­ç­‰</td><td>å±‚åºéå†ï¼ˆæŒ‰å±‚æ”¶é›†èŠ‚ç‚¹ï¼‰</td><td>æ ¸å¿ƒæ˜¯<code>curLevelSize</code>+å±‚çš„è¿›å…¥/ç¦»å¼€</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fn-ary-tree-preorder-traversal%2F" target="_blank" title="https://leetcode.cn/problems/n-ary-tree-preorder-traversal/" ref="nofollow noopener noreferrer">589. N å‰æ ‘çš„å‰åºéå†</a></td><td>ç®€å•</td><td>å¤šå‰æ ‘å‰åºéå†</td><td>éå†<code>children</code>æ•°ç»„ï¼Œå‰åºä½ç½®æ”¶é›†èŠ‚ç‚¹</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fn-ary-tree-postorder-traversal%2F" target="_blank" title="https://leetcode.cn/problems/n-ary-tree-postorder-traversal/" ref="nofollow noopener noreferrer">590. N å‰æ ‘çš„ååºéå†</a></td><td>ç®€å•</td><td>å¤šå‰æ ‘ååºéå†</td><td>éå†<code>children</code>æ•°ç»„ï¼Œååºä½ç½®æ”¶é›†èŠ‚ç‚¹</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fn-ary-tree-level-order-traversal%2F" target="_blank" title="https://leetcode.cn/problems/n-ary-tree-level-order-traversal/" ref="nofollow noopener noreferrer">429. N å‰æ ‘çš„å±‚åºéå†</a></td><td>ä¸­ç­‰</td><td>å¤šå‰æ ‘å±‚åºéå†</td><td>å±•å¼€<code>children</code>æ•°ç»„å…¥é˜Ÿï¼ŒæŒ‰å±‚æ”¶é›†</td></tr></tbody></table>
<h4 data-id="heading-26">æ·±åº¦/è·¯å¾„ç±»ï¼ˆDFS/BFSé€‰å‹ï¼‰</h4>









































<table><thead><tr><th>é¢˜ç›®é“¾æ¥</th><th>éš¾åº¦</th><th>æ ¸å¿ƒè€ƒç‚¹</th><th>è§£é¢˜æç¤º</th></tr></thead><tbody><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fmaximum-depth-of-binary-tree%2F" target="_blank" title="https://leetcode.cn/problems/maximum-depth-of-binary-tree/" ref="nofollow noopener noreferrer">104. äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦</a></td><td>ç®€å•</td><td>DFSååºç»Ÿè®¡/BFSå±‚è®¡æ•°</td><td>DFSï¼šååºä½ç½®å–å·¦å³å­æ ‘æœ€å¤§æ·±åº¦+1ï¼›BFSï¼šç»Ÿè®¡å±‚æ•°</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fminimum-depth-of-binary-tree%2F" target="_blank" title="https://leetcode.cn/problems/minimum-depth-of-binary-tree/" ref="nofollow noopener noreferrer">111. äºŒå‰æ ‘çš„æœ€å°æ·±åº¦</a></td><td>ç®€å•</td><td>BFSæœ€ä¼˜è§£/DFSå›æº¯</td><td>BFSæ‰¾åˆ°ç¬¬ä¸€ä¸ªå¶å­èŠ‚ç‚¹ç›´æ¥è¿”å›å±‚æ•°ï¼Œæ•ˆç‡æ›´é«˜</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fbinary-tree-paths%2F" target="_blank" title="https://leetcode.cn/problems/binary-tree-paths/" ref="nofollow noopener noreferrer">257. äºŒå‰æ ‘çš„æ‰€æœ‰è·¯å¾„</a></td><td>ç®€å•</td><td>DFSå›æº¯/BFSå¸¦è·¯å¾„</td><td>DFSç”¨å‰åºå…¥æ ˆã€ååºå‡ºæ ˆï¼›BFSå°è£…StateNode</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fpath-sum%2F" target="_blank" title="https://leetcode.cn/problems/path-sum/" ref="nofollow noopener noreferrer">112. è·¯å¾„æ€»å’Œ</a></td><td>ç®€å•</td><td>DFSè·¯å¾„å’Œæ ¡éªŒ/BFSå¸¦å’Œ</td><td>æ£€æŸ¥æ˜¯å¦å­˜åœ¨æ ¹åˆ°å¶å­çš„è·¯å¾„å’Œç­‰äºç›®æ ‡å€¼</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fpath-sum-ii%2F" target="_blank" title="https://leetcode.cn/problems/path-sum-ii/" ref="nofollow noopener noreferrer">113. è·¯å¾„æ€»å’Œ II</a></td><td>ä¸­ç­‰</td><td>DFSå›æº¯æ”¶é›†æ‰€æœ‰ç¬¦åˆæ¡ä»¶è·¯å¾„</td><td>å‰åºç´¯åŠ å’Œã€ååºå›æº¯ï¼Œå¶å­èŠ‚ç‚¹æ ¡éªŒå’Œæ˜¯å¦åŒ¹é…</td></tr></tbody></table>
<h4 data-id="heading-27">è¿›é˜¶åº”ç”¨ç±»ï¼ˆæ ‘æ€ç»´æ‹“å±•ï¼‰</h4>









































<table><thead><tr><th>é¢˜ç›®é“¾æ¥</th><th>éš¾åº¦</th><th>æ ¸å¿ƒè€ƒç‚¹</th><th>è§£é¢˜æç¤º</th></tr></thead><tbody><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fbinary-tree-level-order-traversal-ii%2F" target="_blank" title="https://leetcode.cn/problems/binary-tree-level-order-traversal-ii/" ref="nofollow noopener noreferrer">107. äºŒå‰æ ‘çš„å±‚åºéå† II</a></td><td>ä¸­ç­‰</td><td>å±‚åºéå†+ç»“æœåè½¬</td><td>æŒ‰å±‚æ”¶é›†ååè½¬æ•°ç»„ï¼Œæˆ–ä»ä¸‹å¾€ä¸Šéå†</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fbinary-tree-right-side-view%2F" target="_blank" title="https://leetcode.cn/problems/binary-tree-right-side-view/" ref="nofollow noopener noreferrer">199. äºŒå‰æ ‘çš„å³è§†å›¾</a></td><td>ä¸­ç­‰</td><td>å±‚åºéå†å–æ¯å±‚æœ€åä¸€ä¸ªèŠ‚ç‚¹</td><td>è¿›å…¥å±‚åˆå§‹åŒ–ã€ç¦»å¼€å±‚å–æœ€åä¸€ä¸ªèŠ‚ç‚¹å€¼</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Faverage-of-levels-in-binary-tree%2F" target="_blank" title="https://leetcode.cn/problems/average-of-levels-in-binary-tree/" ref="nofollow noopener noreferrer">637. äºŒå‰æ ‘çš„å±‚å¹³å‡å€¼</a></td><td>ç®€å•</td><td>å±‚åºéå†ç»Ÿè®¡å±‚å’Œ/èŠ‚ç‚¹æ•°</td><td>ç¦»å¼€å±‚æ—¶è®¡ç®—å¹³å‡å€¼</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fsymmetric-tree%2F" target="_blank" title="https://leetcode.cn/problems/symmetric-tree/" ref="nofollow noopener noreferrer">101. å¯¹ç§°äºŒå‰æ ‘</a></td><td>ç®€å•</td><td>é€’å½’æ¯”è¾ƒå·¦å³å­æ ‘/BFSå±‚æ ¡éªŒ</td><td>é€’å½’ï¼šæ¯”è¾ƒå·¦å·¦å’Œå³å³ã€å·¦å³å’Œå³å·¦ï¼›BFSæŒ‰å±‚æ ¡éªŒå¯¹ç§°æ€§</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fvalidate-binary-search-tree%2F" target="_blank" title="https://leetcode.cn/problems/validate-binary-search-tree/" ref="nofollow noopener noreferrer">98. éªŒè¯äºŒå‰æœç´¢æ ‘</a></td><td>ä¸­ç­‰</td><td>BSTä¸­åºéå†æœ‰åºæ€§</td><td>ä¸­åºéå†æ”¶é›†å€¼ï¼Œæ ¡éªŒæ˜¯å¦ä¸¥æ ¼é€’å¢</td></tr></tbody></table>
</div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‰£å­ï¼ˆCozeï¼‰å®æˆ˜ï¼šâ€œæ¯å¤©å¬æ‡‚ä¸€é¦–æ­Œâ€ï¼Œè¿™ä¸ªçˆ†ç«çš„èµ›é“ï¼Œæˆ‘ç”¨æ‰£å­å¤åˆ»äº†]]></title>    <link>https://juejin.cn/post/7599912857393332270</link>    <guid>https://juejin.cn/post/7599912857393332270</guid>    <pubDate>2026-01-28T03:54:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599912857393332270" data-draft-id="7599951933594386442" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‰£å­ï¼ˆCozeï¼‰å®æˆ˜ï¼šâ€œæ¯å¤©å¬æ‡‚ä¸€é¦–æ­Œâ€ï¼Œè¿™ä¸ªçˆ†ç«çš„èµ›é“ï¼Œæˆ‘ç”¨æ‰£å­å¤åˆ»äº†"/> <meta itemprop="keywords" content="Coze"/> <meta itemprop="datePublished" content="2026-01-28T03:54:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¾é³´"/> <meta itemprop="url" content="https://juejin.cn/user/3683842894347076"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‰£å­ï¼ˆCozeï¼‰å®æˆ˜ï¼šâ€œæ¯å¤©å¬æ‡‚ä¸€é¦–æ­Œâ€ï¼Œè¿™ä¸ªçˆ†ç«çš„èµ›é“ï¼Œæˆ‘ç”¨æ‰£å­å¤åˆ»äº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3683842894347076/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¾é³´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T03:54:52.000Z" title="Wed Jan 28 2026 03:54:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å¾é³´ã€‚ä¸“æ³¨äºåˆ†äº«æå‡å·¥ä½œä¸ç”Ÿæ´»æ•ˆç‡çš„å·¥å…·ï¼Œæ— å¿åˆ†äº«AIé¢†åŸŸç›¸å…³çš„ç²¾é€‰æŠ¥å‘Šï¼ŒæŒç»­å…³æ³¨AIçš„å‰æ²¿åŠ¨å‘ã€‚</p>
<p>æœ€è¿‘åˆ·æŠ–éŸ³ç»å¸¸ä¼šåˆ·åˆ°â€œæ¯å¤©å¬æ‡‚ä¸€é¦–æ­Œâ€è¿™ä¹ˆä¸ªä¸»é¢˜çš„çŸ­è§†é¢‘ï¼Œè§†é¢‘ä¸é•¿ï¼Œåªæœ‰çŸ­çŸ­çš„ä¸€åˆ†é’Ÿï¼Œç™¾æ¥ä¸ªä½œå“ï¼Œå´æ”¶è·ç²‰ä¸æ•°åä¸‡ï¼Œè·èµæ•°ç™¾ä¸‡ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/09ff1de5f4904fb59eba47ecf23a07e2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZC-6bO0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770177383&amp;x-signature=WNlLzWl%2Fuy%2F7lwy9nk94Yf9af4I%3D" alt="" loading="lazy"/></p>
<p>è¿™ç±»ä½œå“è·Ÿç›´æ¥å¬æ­Œæœ‰äº›ä¸å¤ªä¸€æ ·ï¼Œå®ƒæ›´å¤šçš„æ˜¯åœ¨ç»™ä½ è§£è¯»æ­Œæ›²ï¼Œè§£è¯´è¿™é¦–æ­Œæ›²æ­Œè¯çš„å«ä¹‰ï¼Œä»¿ä½›å°±åƒæ˜¯æ­Œæ›²çš„åˆ›ä½œè€…åœ¨å£è¿°è¿™äº›æ­Œæ›²çš„çœŸå®æƒ…æ„Ÿã€‚</p>
<p>å†æ­é…ä¸Šæ­Œæ›²ä½œä¸ºè§£è¯´çš„èƒŒæ™¯éŸ³ä¹ï¼Œä»¥åŠè§†é¢‘ä¸­çš„åŠ¨ç”»MVï¼Œäººä»¬çš„æƒ…ç»ªå¾ˆå®¹æ˜“è¢«å¸¦å…¥è¿›å»ï¼Œæ‰€ä»¥çŸ­çŸ­çš„ä¸€åˆ†é’Ÿè§†é¢‘å°±éå¸¸çš„æœ‰é­…åŠ›ã€‚</p>
<p>æˆ‘ä½¿ç”¨æ‰£å­æ¥å¤åˆ»äº†è¿™ç±»è§†é¢‘çš„åˆ¶ä½œè¿‡ç¨‹ï¼Œåªéœ€è¦è¾“å…¥æ­Œåã€ä¸Šä¼ æ­Œæ›²çš„æ–‡ä»¶ä»¥åŠé€‰æ‹©å–œæ¬¢çš„è§†é¢‘MVåŠ¨æ¼«çš„è§’è‰²å›¾ç‰‡ï¼Œå°±å¯ä»¥ä¸€é”®åˆ¶ä½œè¿™ç±»è§†é¢‘(è§†é¢‘ä¸Šä¼ ä¸äº†ï¼Œè¿™é‡Œæˆ‘æ”¾äº†å¼ å›¾)ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/10a90794a0234c409bc7f187975904ea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZC-6bO0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770177383&amp;x-signature=m%2FfHqleDCn6zzAC5QHVldkXnqK0%3D" alt="" loading="lazy"/></p>
<p>å·¥ä½œæµæ¯”è¾ƒå¤æ‚ï¼Œä¼°ç®—äº†ä¸€ä¸‹ï¼Œæœ‰å°†è¿‘60ä¸ªèŠ‚ç‚¹ï¼Œé‡Œé¢æ¶‰åŠåˆ°æŒºå¤šå›¾ç‰‡çš„å‡ºæ¥ï¼Œæ–‡æ¡ˆå¤„ç†ã€è§†é¢‘å¤„ç†ç­‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/00c0734d59684098bf78cf929b78d83d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZC-6bO0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770177383&amp;x-signature=hO18f9VMszFCmRZpauIPf1nhDqc%3D" alt="" loading="lazy"/></p>
<p>ä¸ºäº†è®²æ¸…æ¥šè¿™ä¸ªå·¥ä½œæµï¼Œæˆ‘æŠŠä¸Šé¢çš„è§†é¢‘æ‹†è§£æˆäº†ä¸‰ä¸ªæ¥è¿›è¡Œè®²è§£ï¼Œåˆ†åˆ«æ˜¯è§†é¢‘å¼€å¤´éƒ¨åˆ†ï¼Œå°±æ˜¯â€œæ¯å¤©å¬æ‡‚ä¸€é¦–æ­Œï¼Œä»Šå¤©æˆ‘ä»¬å¬ï¼Œåæ¥â€è¿™éƒ¨åˆ†ï¼Œç¬¬äºŒéƒ¨åˆ†å°±æ˜¯å¯¹æ­Œæ›²è¿›è¡Œè§£è¯´çš„éƒ¨åˆ†ï¼Œç¬¬ä¸‰éƒ¨åˆ†å°±æ˜¯ç»“å°¾éƒ¨åˆ†ã€‚</p>
<p>æ‰€ä»¥æˆ‘æŠŠè¿™ä¸ªå·¥ä½œæµæ‹†æˆäº†ä¸‰ä¸ªå­å·¥ä½œæµï¼Œæ¯ä¸ªå·¥ä½œæµå¯ä»¥ç‹¬ç«‹è¿è¡Œï¼Œäº§å‡ºè§†é¢‘å¼€å¤´éƒ¨åˆ†ã€è§£è¯´éƒ¨åˆ†ã€ç»“å°¾éƒ¨åˆ†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/22e9d81302144b9989db9c8db8dfc569~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZC-6bO0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770177383&amp;x-signature=J20%2BWydHkiGZThGxJ5tf8eHZrjQ%3D" alt="" loading="lazy"/></p>
<p>è¿™ä¸‰ä¸ªå·¥ä½œæµä¸²èµ·æ¥å°±æ˜¯è¿™ä¸ªå®Œæ•´çš„å·¥ä½œæµï¼Œæœ¬æ–‡å…ˆå¯¹ä¸Šé¢å·¥ä½œæµåšè¯¦ç»†è§£è¯»ï¼Œåç»­ä¼šç»§ç»­å‡ºä¸‰ç¯‡æ–‡ç« åˆ†åˆ«è§£è¯´æ¯ä¸ªå­å·¥ä½œæµçš„æ˜ç»†ï¼Œå¯ä»¥ç•™æ„åŠ¨æ€ã€‚</p>
<h2 data-id="heading-0">1. å·¥ä½œæµè¯¦ç»†èŠ‚ç‚¹è§£è¯»</h2>
<h3 data-id="heading-1">1.1 å¼€å§‹</h3>
<ul>
<li>api_tokenï¼šæ’ä»¶è®¤è¯ï¼Œå¿…å¡«ï¼Œå¯ä»¥åå°å›å¤ã€èŠéº»å¼€é—¨ã€‘è”ç³»è·å–ï¼ˆæœ‰æ¡ä»¶ï¼‰</li>
<li>bgm_music_fileï¼šèƒŒæ™¯éŸ³ä¹ï¼Œæ­Œæ›²è§£è¯´ä½¿ç”¨ï¼Œå¿…å¡«</li>
<li>music_nameï¼šæ­Œæ›²åç§°ï¼Œå¿…å¡«</li>
<li>reference_image_nvï¼šè§†é¢‘åŠ¨æ¼«MVå¥³è§’è‰²å‚è€ƒå›¾ï¼Œå¿…å¡«</li>
<li>reference_image_nanï¼šè§†é¢‘åŠ¨æ¼«MVç”·è§’è‰²å‚è€ƒå›¾ï¼Œå¿…å¡«</li>
<li>music_coverï¼šæ­Œæ›²å°é¢å›¾ï¼Œå¿…å¡«</li>
<li>end_music_fileï¼šè§†é¢‘ç»“å°¾éŸ³ä¹ï¼Œå¿…å¡«</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/61b8a530155048cf8c7700bedc378773~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZC-6bO0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770177383&amp;x-signature=oliBHUbZ%2FKreIJv3goSZ%2F9oGMsw%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-2">1.2 video_mei_ri_yi_ge_start</h3>
<p>è¿™ä¸ªèŠ‚ç‚¹æ˜¯ä½¿ç”¨äº†æ‰£å­å®˜æ–¹çš„å·¥ä½œæµèŠ‚ç‚¹ï¼Œç”¨æ¥ç”Ÿæˆæ­Œæ›²è§£è¯´è§†é¢‘çš„å¼€å¤´éƒ¨åˆ†å†…å®¹ï¼Œæ˜¯ä¸€ä¸ªå­å·¥ä½œæµï¼Œåé¢ä¼šæœ‰æ–‡ç« è¯¦ç»†ä»‹ç»ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ab11a7f62c7640208de9239ebb8dbae1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZC-6bO0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770177383&amp;x-signature=YagsZ9b2cmU6kQLI2aBxdLRojhQ%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-3">1.3 video_mei_ri_yi_ge_zheng_wen</h3>
<p>è¿™ä¸ªèŠ‚ç‚¹ä½¿ç”¨äº†æ‰£å­å®˜æ–¹çš„å·¥ä½œæµèŠ‚ç‚¹ï¼Œç”¨æ¥ç”Ÿæˆè§†é¢‘çš„æ­Œæ›²è§£è¯´éƒ¨åˆ†ï¼Œå®ƒæœ‰äº›å‚æ•°éœ€è¦ä¾èµ–ä¸Šä¸€ä¸ªå·¥ä½œæµçš„è¾“å‡ºï¼Œæ¯”å¦‚è§£è¯´ä»è½¨é“çš„ä»€ä¹ˆæ—¶é—´å¼€å§‹ï¼Œå‰ªæ˜ è‰ç¨¿IDç­‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/337c9c8c36c6431d8c946b7245b427ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZC-6bO0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770177383&amp;x-signature=5wYXGDG0u8KMyRBJNskGsyYZvnk%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-4">1.4 video_mei_ri_yi_ge_end</h3>
<p>è¿™ä¸ªèŠ‚ç‚¹ä½¿ç”¨äº†æ‰£å­å®˜æ–¹çš„å·¥ä½œæµèŠ‚ç‚¹ï¼Œç”¨æ¥ç”Ÿæˆè§†é¢‘çš„ç»“å°¾ï¼Œæ˜¯ä¸€ä¸ªå­å·¥ä½œæµï¼Œå®ƒæœ‰äº›å‚æ•°ä¹Ÿæ˜¯ä¾èµ–ä¸Šä¸€ä¸ªå·¥ä½œæµçš„è¾“å…¥ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e141a2cc99c64106b41db203293bbb70~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZC-6bO0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770177383&amp;x-signature=LJZR68iZRbo6NbYbHAN1%2FMsSIHg%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-5">1.5 ç»“æŸ</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e84b3ef596f84cd8a3440f68afd5dd3e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZC-6bO0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770177383&amp;x-signature=EyRgUmFWisKjxE%2FQnMW3ZoBZD%2FA%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-6">2. å‰ªæ˜ è‰ç¨¿ä¸‹è½½</h2>
<p>ä¸Šæ–¹çš„å·¥ä½œæµï¼Œç»“æŸçš„èŠ‚ç‚¹ä¼šè¾“å‡ºè‰ç¨¿çš„ä¸‹è½½åœ°å€ï¼Œåªéœ€è¦å¤åˆ¶è‰ç¨¿ï¼Œç„¶åä½¿ç”¨è§†é¢‘å‰ªè¾‘å°åŠ©æ‰‹æ¥ä¸‹è½½è‰ç¨¿å³å¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bc700f2fc0ad4683bdacb0d856db1251~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZC-6bO0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770177383&amp;x-signature=ND7%2BGK2M5mqYQ4Lk2366L4EE1Ec%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-7">3. é¢„è§ˆè‰ç¨¿</h2>
<p>åœ¨ä¸‹è½½å®Œå‰ªæ˜ å¾—è‰ç¨¿åï¼Œæ‰“å¼€å‰ªæ˜ ä¾¿å¯ä»¥çœ‹åˆ°ä¸‹è½½çš„å‰ªæ˜ è‰ç¨¿ï¼Œç‚¹å‡»è‰ç¨¿æ‰“å¼€ï¼Œå°±å¯ä»¥åœ¨å‰ªæ˜ ä¸­çœ‹åˆ°å®Œæ•´çš„è§†é¢‘è‰ç¨¿ç´ æç­‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b8f1891888442089a14eb35e105c427~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZC-6bO0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770177383&amp;x-signature=Z%2FSEPAoeZCXgWU8Hy0jfBrJUQd0%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-8">4. æ€»ç»“</h2>
<p>æœ¬æ–‡ä¸»è¦æµ…æ˜¾çš„ä»‹ç»äº†â€œæ¯å¤©å¬æ‡‚ä¸€é¦–æ­Œâ€çš„åˆ¶ä½œè¿‡ç¨‹ï¼Œå› ä¸ºå·¥ä½œæµçš„å¤æ‚æ€§ï¼Œæ‰€ä»¥æˆ‘å°†å®ƒæ‹†è§£æˆäº†ä¸‰ä¸ªå­å·¥ä½œæµï¼Œè¿™ä¸‰ä¸ªå­å·¥ä½œæµåˆ†åˆ«è´Ÿè´£è§†é¢‘å¼€å¤´ã€è§£è¯´ã€ç»“å°¾éƒ¨åˆ†çš„å‰ªè¾‘ï¼Œä¸²èµ·æ¥å°±æ˜¯å®Œæ•´çš„å·¥ä½œæµã€‚</p>
<p>è¿™ä¸‰ä¸ªå­å·¥ä½œæµåé¢æˆ‘ä¼šå†ä¸‰ç¯‡æ–‡ç« å¯¹è¿™ä¸‰ä¸ªå­å·¥ä½œæµåšè¯¦ç»†çš„ä»‹ç»ã€‚</p>
<p>æœ¬æ–‡çš„åˆ†äº«å°±åˆ°è¿™é‡Œï¼Œå¦‚æœæ‚¨è§‰å¾—æœ‰æ”¶è·çš„è¯ï¼Œå¯ä»¥ç»™ä¸ªä¸€é”®ä¸‰è¿ï¼Œæ‚¨çš„é¼“åŠ±æ˜¯å¾é³´æŒç»­è¾“å‡ºçš„æœ€å¤§åŠ¨åŠ›ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/da7f8d7455164ba1985f6e73f8e86ee1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZC-6bO0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770177383&amp;x-signature=BZovNtMUh3YMPlVnspjnVdTSBIA%3D" alt="" loading="lazy"/></p>
<p>æœ€è¿‘å®æˆ˜äº†ä¸€äº›æ‰£å­ï¼ˆCozeï¼‰å·¥ä½œæµç›¸å…³çš„æ¡ˆä¾‹ï¼ŒåŒ…å«å°çº¢è–¯å›¾æ–‡ç”Ÿæˆã€çˆ†æ¬¾è§†é¢‘å‰ªè¾‘ã€åŠå…¬ææ•ˆç­‰æ‰£å­æ¡ˆä¾‹ï¼Œå†…é™„è¯¦ç»†çš„æ•™ç¨‹å’Œå·¥ä½œæµå®‰è£…åŒ…ï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥æ¥ä¸ª<strong>ä¸€é”®ä¸‰è¿ï¼ˆå¿…é¡»åŠ¨ä½œï¼‰</strong> ï¼Œæ–‡ç« è¯„è®ºåŒºè¯„è®ºâ€œ<strong>æ‰£å­æ¡ˆä¾‹</strong>â€é¢†å–ï¼ˆè¿™äº›æ¡ˆä¾‹ä¸åŒ…å«æœ¬æ–‡åˆ†äº«çš„æ¡ˆä¾‹ï¼Œå¦‚æœéœ€è¦æœ¬æ–‡åˆ†äº«çš„æ¡ˆä¾‹å®‰è£…åŒ…å¯ä»¥åå°ç§ä¿¡æˆ‘ï¼‰ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è§†é¢‘ç”Ÿæˆæ¨ç†åŠ é€Ÿå®è·µï¼šåŸºäº torch.compile çš„æ•´å›¾ç¼–è¯‘ä¼˜åŒ–]]></title>    <link>https://juejin.cn/post/7599912857393365038</link>    <guid>https://juejin.cn/post/7599912857393365038</guid>    <pubDate>2026-01-28T03:59:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599912857393365038" data-draft-id="7599845683123011624" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è§†é¢‘ç”Ÿæˆæ¨ç†åŠ é€Ÿå®è·µï¼šåŸºäº torch.compile çš„æ•´å›¾ç¼–è¯‘ä¼˜åŒ–"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-28T03:59:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å“”å“©å“”å“©æŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/3030701626893405"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è§†é¢‘ç”Ÿæˆæ¨ç†åŠ é€Ÿå®è·µï¼šåŸºäº torch.compile çš„æ•´å›¾ç¼–è¯‘ä¼˜åŒ–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3030701626893405/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å“”å“©å“”å“©æŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T03:59:38.000Z" title="Wed Jan 28 2026 03:59:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>ä¸€ã€å¼•è¨€ï¼šä»ç®—å­çº§ä¼˜åŒ–åˆ°è®¡ç®—å›¾çº§ä¼˜åŒ–</strong></h2>
<p>è§†é¢‘ç”Ÿæˆæ¨¡å‹çš„æ¨ç†ä¼˜åŒ–æ˜¯ä¸€ä¸ªå¤šå±‚æ¬¡ã€ç³»ç»Ÿæ€§çš„å·¥ç¨‹æŒ‘æˆ˜ã€‚åœ¨æ¨¡å‹æ¨ç†çš„æ—©æœŸé˜¶æ®µï¼Œä¼˜åŒ–é‡ç‚¹é€šå¸¸é›†ä¸­åœ¨ç®—å­å±‚é¢ï¼Œä¾‹å¦‚é€šè¿‡ä¼˜åŒ–å·ç§¯ã€æ³¨æ„åŠ›ç­‰æ ¸å¿ƒç®—å­çš„è®¡ç®—æ•ˆç‡æ¥ç›´æ¥æå‡æµ®ç‚¹è¿ç®—æ€§èƒ½ã€‚ç„¶è€Œï¼Œéšç€å•ç®—å­æ€§èƒ½é€æ¸é€¼è¿‘ç¡¬ä»¶æé™ï¼Œè®¡ç®—å›¾å±‚é¢çš„ä¼˜åŒ–ä¾¿æˆä¸ºé‡Šæ”¾æ›´å¤§æ½œåŠ›çš„å…³é”®ã€‚è®¡ç®—å›¾ä¼˜åŒ–å…³æ³¨çš„æ˜¯ç®—å­ä¹‹é—´çš„è°ƒåº¦ã€å†…å­˜å¤ç”¨ä»¥åŠæ§åˆ¶æµå¼€é”€ï¼Œå…¶æ ¸å¿ƒåœ¨äºæå‡æ•´ä½“æ‰§è¡Œå›¾æ•ˆç‡ã€‚ä¸€ä¸ªé«˜æ•ˆçš„æ‰§è¡Œå›¾èƒ½å¤Ÿæœ€å¤§é™åº¦åœ°å‡å°‘æ¡†æ¶ä¸ç¡¬ä»¶çš„äº¤äº’å¼€é”€ï¼Œé¿å…ä¸å¿…è¦çš„å†…å­˜æ¬è¿ï¼Œå¹¶ä½¿å¾—æ›´æ¿€è¿›çš„ç®—å­èåˆä¸å†…å­˜è§„åˆ’æˆä¸ºå¯èƒ½ã€‚</p>
<p>æœ¬æ–‡å°†èšç„¦äºæ¨ç†æ‰§è¡Œæµç¨‹æœ¬èº«ï¼Œæ¢è®¨å¦‚ä½•å€ŸåŠ© torch.compile å¯¹ Self-Forcing çš„æ¨ç†æµç¨‹è¿›è¡Œæ•´å›¾ç¼–è¯‘ï¼ˆfull graph compilationï¼‰ï¼Œä»¥ç³»ç»Ÿæ€§åœ°é™ä½ Python è§£é‡Šä¸è°ƒåº¦å¼€é”€ï¼Œå¹¶ä¸ºåç»­æ›´æ·±å±‚æ¬¡çš„å›¾çº§ä¼˜åŒ–å¥ å®šåŸºç¡€ã€‚</p>
<h2 data-id="heading-1"><strong>äºŒã€Self-Forcing æ¨ç†ç‰¹æ€§ä¸æ•´å›¾ç¼–è¯‘çš„æŒ‘æˆ˜</strong></h2>
<p>Self-Forcing æ˜¯ä¸€ç§å°† Wan2.1 ç­‰å…¨å¸§å¹¶è¡Œæ‰©æ•£æ¨¡å‹æ”¹é€ ä¸ºå› æœæ³¨æ„åŠ›æ¶æ„çš„è®­ç»ƒä¸æ¨ç†èŒƒå¼ã€‚ä¸ä¼ ç»ŸåŒå‘æ‰©æ•£æ¨¡å‹åœ¨æ¨ç†é˜¶æ®µéœ€è¦åŒæ—¶å¤„ç†å…¨éƒ¨è§†é¢‘å¸§ä¸åŒï¼ŒSelf-Forcing é‡‡ç”¨é€å—ï¼ˆblock-wiseï¼‰çš„è‡ªå›å½’ç”Ÿæˆç­–ç•¥ï¼šæ¯æ¬¡ç”Ÿæˆä¸€å°æ®µ latentï¼ˆé€šå¸¸ä¸º 3 å¸§ï¼‰ï¼Œå¹¶é€šè¿‡ KV Cache å¤ç”¨å†å²ä¸Šä¸‹æ–‡ã€‚</p>
<p>åœ¨è¿™ç§è®¾è®¡ä¸‹ï¼Œæ³¨æ„åŠ›è®¡ç®—çš„å¤æ‚åº¦ç”±ä¼ ç»Ÿæ‰©æ•£æ¨¡å‹çš„<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>ä¸‹é™ä¸º<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>B</mi><mo>Ã—</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(B \times N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></span>ï¼Œå…¶ä¸­ B è¡¨ç¤ºå•æ¬¡ç”Ÿæˆçš„ block å¤§å°ã€‚è¿™ä¸€ç‰¹æ€§ä½¿å¾— Self-Forcing åœ¨ä½å»¶è¿Ÿã€æµå¼è§†é¢‘ç”Ÿæˆç­‰åº”ç”¨åœºæ™¯ä¸­å…·å¤‡æ˜¾è‘—ä¼˜åŠ¿ã€‚</p>
<p>ä»ç¼–è¯‘ä¼˜åŒ–çš„è§’åº¦çœ‹ï¼ŒSelf-Forcing çš„å®ç°åŒæ—¶å…·å¤‡â€œé€‚åˆç¼–è¯‘â€å’Œâ€œéš¾ä»¥ç¼–è¯‘â€çš„åŒé‡ç‰¹æ€§ã€‚ä¸€æ–¹é¢ï¼Œå…¶æ¨ç†è¿‡ç¨‹é«˜åº¦ç»“æ„åŒ–ï¼Œè®¡ç®—æ¨¡å¼åœ¨æ¯ä¸ª step å†…åŸºæœ¬å›ºå®šï¼›å¦ä¸€æ–¹é¢ï¼ŒåŸå§‹å®ç°ä¸­å¹¿æ³›å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š</p>
<p>1ï¼‰ä¾èµ–å¼ é‡å€¼çš„ Python æ§åˆ¶æµï¼›</p>
<p>2ï¼‰é€šè¿‡ <strong>.item()ã€tolist()</strong> ç­‰æ–¹å¼å°†å¼ é‡é€€å› Host ç«¯ï¼›</p>
<p>3ï¼‰KV Cache çš„åŠ¨æ€ç´¢å¼•ä¸åˆ‡ç‰‡æ“ä½œï¼›</p>
<p>4ï¼‰Python å±‚ç¼“å­˜ä¸è°ƒè¯•é€»è¾‘çš„æ··å…¥ã€‚</p>
<p>ä¸Šè¿°å› ç´ éƒ½å¯èƒ½ä¼šåœ¨ torch.compile è¿‡ç¨‹ä¸­è§¦å‘ Graph Breakï¼Œä½¿ç¼–è¯‘å™¨åªèƒ½ç”Ÿæˆå¤šä¸ªç¢ç‰‡åŒ–çš„å­å›¾ï¼Œä»è€Œéš¾ä»¥è·å¾—å®è´¨æ€§çš„æ€§èƒ½æ”¶ç›Šã€‚</p>
<h2 data-id="heading-2"><strong>ä¸‰ã€æ•´å›¾ç¼–è¯‘ç­–ç•¥ä¸å®ç°é€‰æ‹©</strong></h2>
<p>åœ¨å…·ä½“å®ç°ä¸Šï¼Œæˆ‘ä»¬é‡‡ç”¨äº†ä¸€ç§æ¸è¿›å¼çš„ä¼˜åŒ–ç­–ç•¥ï¼šé¦–å…ˆå¯¹å…³é”®æ¨¡å—ä½¿ç”¨ torch.compile è¿›è¡Œå±€éƒ¨å°è£…ï¼Œä»¥è¯„ä¼°å…¶æ½œåœ¨æ”¶ç›Šï¼›éšåï¼Œåœ¨æ­¤åŸºç¡€ä¸Šç³»ç»Ÿæ€§åœ°è¯†åˆ«å¹¶æ¶ˆé™¤ Graph Breakï¼Œé€æ­¥æ¨è¿›è‡³æ•´å›¾ç¼–è¯‘ï¼ˆFull Graph Compilationï¼‰ã€‚</p>
<p>æˆ‘ä»¬æœ€ç»ˆé€‰æ‹©åœ¨æ³¨æ„åŠ›æ¨¡å—ï¼ˆCausalWanAttentionBlockï¼‰çš„Â <strong>forward</strong>Â æ–¹æ³•ä¸Šä½¿ç”¨å¦‚ä¸‹é…ç½®ï¼š</p>
<ul>
<li/>
</ul>
<pre><code class="hljs language-ini" lang="ini">@torch.compile(<span class="hljs-attr">dynamic</span>=<span class="hljs-literal">True</span>, fullgraph=<span class="hljs-literal">True</span>)
</code></pre>
<p>å…¶ä¸­ï¼Œ<strong>dynamic=True</strong> å…è®¸ç¼–è¯‘å™¨ä»¥ç¬¦å·å½¢çŠ¶ï¼ˆsymbolic shapesï¼‰çš„å½¢å¼è¡¨ç¤ºéƒ¨åˆ†è¿è¡ŒæœŸæ‰èƒ½ç¡®å®šçš„ç»´åº¦ï¼Œä»è€Œåœ¨ä¸è§¦å‘é¢å¤– graph break æˆ–é‡æ–°ç¼–è¯‘çš„å‰æä¸‹ï¼Œæ”¯æŒä¸€å®šèŒƒå›´å†…çš„è¾“å…¥å½¢çŠ¶å˜åŒ–ã€‚è¿™ä¸€ç‰¹æ€§åœ¨è¿›è¡Œå‰æœŸä¼˜åŒ–çš„æ—¶å€™æ¯”è¾ƒé‡è¦ï¼šå°½ç®¡å•æ¬¡æ¨ç†çš„è§†é¢‘åˆ†è¾¨ç‡å’Œæ€»å¸§æ•°é€šå¸¸æ˜¯å›ºå®šçš„ï¼Œä½†åºåˆ—åœ¨å¤šå¡ä¹‹é—´çš„åˆ‡åˆ†æ–¹å¼ã€ä»¥åŠ KV Cache åœ¨ä¸åŒ step ä¸­çš„æœ‰æ•ˆé•¿åº¦ä¸å†™å…¥åŒºé—´ï¼Œéƒ½å¯èƒ½ä¼šå¼•å…¥è¿è¡ŒæœŸçš„å½¢çŠ¶å·®å¼‚ï¼Œé€šè¿‡ç¬¦å·åŒ–è¿™äº›ç»´åº¦ï¼Œå¯ä»¥é¿å…å› å½¢çŠ¶å˜åŒ–è€Œé¢‘ç¹è§¦å‘é‡æ–°ç¼–è¯‘ï¼Œä»è€Œæå‡æ•´ä½“æ¨ç†ç¨³å®šæ€§ä¸æ€§èƒ½ã€‚</p>
<p><strong>fullgraph=True</strong>Â åˆ™æ˜¯å®ç°æ•´å›¾ä¼˜åŒ–çš„å…³é”®ã€‚è¯¥é€‰é¡¹è¦æ±‚æ•´ä¸ªå‡½æ•°å¿…é¡»è¢«ç¼–è¯‘ä¸ºå•ä¸€ FX è®¡ç®—å›¾ï¼Œä¸€æ—¦é‡åˆ°æ— æ³•è¿½è¸ªçš„æ“ä½œä¾¿ç›´æ¥æŠ¥é”™å¹¶ä¸­æ­¢ç¼–è¯‘ã€‚è™½ç„¶è¿™ä¸€â€œä¸¥æ ¼æ¨¡å¼â€æ˜¾è‘—æé«˜äº†å·¥ç¨‹æ”¹é€ çš„éš¾åº¦ï¼Œä½†å®ƒèƒ½å¤Ÿåœ¨ç¼–è¯‘é˜¶æ®µå®Œæ•´æš´éœ²æ‰€æœ‰æ½œåœ¨çš„ Graph Break ç‚¹ï¼Œé¿å…éšå¼çš„å­å›¾åˆ‡æ¢å¼€é”€ï¼Œå¹¶ä¸ºåç»­çš„ç®—å­èåˆå’Œ CUDA Graph æ•è·æä¾›å¿…è¦å‰æã€‚</p>
<p>åœ¨å®è·µä¸­ï¼Œfullgraph æ¨¡å¼çš„ä»·å€¼ä¸ä»…ä½“ç°åœ¨æœ€ç»ˆæ€§èƒ½ä¸Šï¼Œæ›´ä½“ç°åœ¨å…¶å¯¹ä»£ç ç»“æ„ä¸æ•°æ®æµè®¾è®¡çš„â€œçº¦æŸâ€ä½œç”¨ã€‚</p>
<h2 data-id="heading-3"><strong>å››ã€Graph Break çš„æˆå› åˆ†æä¸æ¶ˆé™¤æ–¹æ³•</strong></h2>
<p>åœ¨æœ¬ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬çš„ä»£ç ç¤ºä¾‹åŸºäº Self Forcing çš„Â <em>å®˜æ–¹å®ç°</em>ï¼ˆ*<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fguandeh17%2FSelf-Forcing*%25EF%25BC%2589%25EF%25BC%258C%25E9%2583%25A8%25E5%2588%2586%25E6%258F%2590%25E5%258F%258A%25E7%259A%2584%25E5%25BA%258F%25E5%2588%2597%25E5%25B9%25B6%25E8%25A1%258C%25E4%25BB%25A3%25E7%25A0%2581%25E5%259F%25BA%25E4%25BA%258E%25E5%2586%2585%25E9%2583%25A8%25E5%25B7%25A5%25E7%25A8%258B%25E5%25AE%259E%25E7%258E%25B0%25E3%2580%2582" target="_blank" title="https://github.com/guandeh17/Self-Forcing*%EF%BC%89%EF%BC%8C%E9%83%A8%E5%88%86%E6%8F%90%E5%8F%8A%E7%9A%84%E5%BA%8F%E5%88%97%E5%B9%B6%E8%A1%8C%E4%BB%A3%E7%A0%81%E5%9F%BA%E4%BA%8E%E5%86%85%E9%83%A8%E5%B7%A5%E7%A8%8B%E5%AE%9E%E7%8E%B0%E3%80%82" ref="nofollow noopener noreferrer">github.com/guandeh17/Sâ€¦</a></p>
<h3 data-id="heading-4"><strong>æ§åˆ¶æµä¸æ ‡é‡æå–</strong></h3>
<p>åœ¨Â <strong>torch.compile</strong> ä¸­å¯¼è‡´å›¾æ–­å¼€çš„æœ€å¸¸è§åŸå› ä¹‹ä¸€æ˜¯ Python ç«¯è¯­ä¹‰ä¾èµ–äºè¿è¡Œæ—¶å¼ é‡å€¼ã€‚åœ¨ Self-Forcing çš„åŸå§‹å®ç°ä¸­ï¼Œå¤§é‡é€»è¾‘é€šè¿‡ <strong>.item()</strong> å°†å¼ é‡è½¬æ¢ä¸º Python æ ‡é‡ï¼Œç”¨äºè®¡ç®—åºåˆ—é•¿åº¦ã€å¸§ç´¢å¼•ä»¥åŠ KV Cache çš„è¯»å†™ä½ç½®ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li/>
<li/>
</ul>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">frame_seqlen</span>Â = math.prod(grid_sizes[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>:]).item()
<span class="hljs-attr">local_end_index</span>Â = kv_cache[<span class="hljs-string">"local_end_index"</span>].item() + current_end
</code></pre>
<p>åœ¨Â <strong>fullgraph=True</strong>Â æ¨¡å¼ä¸‹ï¼Œè¿™ç±»ä»£ç ä¼šç›´æ¥è§¦å‘å¦‚ä¸‹é”™è¯¯ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">Unsupported Tensor.item()Â callÂ withÂ <span class="hljs-attr">capture_scalar_outputs</span>=<span class="hljs-literal">False</span>
</code></pre>
<p>å°½ç®¡ PyTorch æä¾›äº† capture_scalar_outputs=True æ¥æ”¯æŒæ­¤ç±»ç”¨æ³•ï¼Œä½†è¯¥æ–¹æ¡ˆä¼šå¼•å…¥é¢å¤–çš„ Host-Device åŒæ­¥å’Œæ ‡é‡å°è£…å¼€é”€ï¼Œå¹¶å‰Šå¼±ç¼–è¯‘å™¨å¯¹æ•°æ®æµçš„é™æ€åˆ†æèƒ½åŠ›ã€‚å› æ­¤åŸºäºæ€§èƒ½è€ƒè™‘ï¼Œæˆ‘ä»¬é€‰æ‹©å½»åº•æ¶ˆé™¤ .item() è°ƒç”¨ï¼Œè€Œä¸æ˜¯ä¾èµ–è¯¥é€‰é¡¹ã€‚</p>
<p>æ ¸å¿ƒæ€è·¯æ˜¯ï¼šåªè¦æŸä¸ªé‡å¯ä»¥åœ¨ GPU ä¸Šä»¥å¼ é‡å½¢å¼è®¡ç®—ï¼Œå°±åº”é¿å…å°†å…¶é€€å› CPUã€‚ä¾‹å¦‚ï¼Œä¸Šè¿°ä»£ç å¯ä»¥æ”¹å†™ä¸ºï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">frame_seqlen</span>Â = torch.prod(grid_sizes[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>:])
<span class="hljs-attr">current_start_frame</span>Â = current_start // frame_seqlen
</code></pre>
<p>æ›´åŠ æ¦‚æ‹¬çš„è¯´ï¼Œæˆ‘ä»¬åœ¨æ¨ç†çƒ­è·¯å¾„ä¸Šç³»ç»Ÿæ€§åœ°ç§»é™¤äº†æ‰€æœ‰å¼ é‡åˆ° Python çš„è½¬æ¢æ“ä½œï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š</p>
<ul>
<li>.item()</li>
<li>int(tensor)</li>
<li>.tolist()</li>
<li>å…¶ä»–ç±»ä¼¼çš„æ ‡é‡åŒ–æ“ä½œ</li>
</ul>
<p>åŸå› åœ¨äºï¼Œä» torch.compile çš„è§†è§’æ¥çœ‹ï¼ŒTensor å¹¶ä¸ç­‰ä»·äºå…·ä½“æ•°å€¼ï¼Œè€Œæ˜¯ä¸€ç§å¯è¢«åˆ†æå’Œä¼˜åŒ–çš„è®¡ç®—å…³ç³»è¡¨ç¤ºã€‚ä¸€æ—¦ä¸­é—´ç»“æœè¢«è½¬æ¢ä¸º Python å¯¹è±¡ï¼Œç›¸å…³æ•°æ®ä¾èµ–å°†å¾ˆæœ‰å¯èƒ½è„±ç¦»ç¼–è¯‘å™¨çš„æ§åˆ¶èŒƒå›´ï¼Œå¯¼è‡´è®¡ç®—å›¾æ— æ³•è¢«å®Œæ•´æ•è·å’Œä¼˜åŒ–ã€‚ç›¸åï¼Œä¿æŒè®¡ç®—é€»è¾‘å®Œå…¨ä»¥å¼ é‡å½¢å¼è¡¨è¾¾ï¼Œæœ‰åŠ©äºæœ€å¤§åŒ–ç¼–è¯‘å™¨çš„ä¼˜åŒ–ç©ºé—´ï¼Œå¹¶ç¡®ä¿æ¨ç†è¿‡ç¨‹ä¸­ CUDA æ‰§è¡Œçš„é«˜æ•ˆæ€§ä¸å¹¶è¡Œæ€§ã€‚</p>
<h3 data-id="heading-5"><strong>æ•°æ®ä¾èµ–ä¸åŠ¨æ€å½¢çŠ¶</strong></h3>
<p>å¦ä¸€ç±»æ›´ä¸ºéšè”½çš„ Graph Break æºäº<strong>æ•°æ®ä¾èµ–å¯¼è‡´çš„åŠ¨æ€å½¢çŠ¶æ¨å¯¼å¤±è´¥</strong>ã€‚åœ¨ RoPE çš„è®¡ç®—é€»è¾‘ä¸­ï¼ŒåŸå§‹å®ç°é€šè¿‡ tolist() å°† grid_sizes å¼ é‡è½¬æ¢ä¸º Python åˆ—è¡¨ï¼Œå¹¶åœ¨å¾ªç¯ä¸­åŠ¨æ€è®¡ç®—åºåˆ—é•¿åº¦ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">forÂ f,Â h, wÂ inÂ grid_sizes.tolist():
    <span class="hljs-attr">seq_len</span> = f *Â hÂ * wÂ  Â 
    <span class="hljs-attr">x_i</span> = x[i, :seq_len]
</code></pre>
<p>è¿™ä¸€å®ç°åŒæ—¶å¼•å…¥äº†ä¸¤ä¸ªé—®é¢˜ï¼šä¸€æ–¹é¢ï¼Œtolist() æœ¬èº«ä¼šè§¦å‘ Graph Breakï¼Œä½¿ç›¸å…³è®¡ç®—é€»è¾‘è„±ç¦»è®¡ç®—å›¾ï¼›å¦ä¸€æ–¹é¢ï¼Œç”±å›¾å¤–æ ‡é‡ fã€hã€w å‚ä¸è®¡ç®—å¾—åˆ°çš„ seq_len è¢«ç”¨äºå¼ é‡åˆ‡ç‰‡ï¼Œå¯¼è‡´ç¼–è¯‘å™¨æ— æ³•ä¸ºè¾“å‡ºå¼ é‡çš„å½¢çŠ¶å»ºç«‹æœ‰æ•ˆçš„ç¬¦å·çº¦æŸã€‚æœ€ç»ˆï¼Œè¿™ç§æ•°æ®ä¾èµ–å…³ç³»ä¼šåœ¨ç¼–è¯‘é˜¶æ®µè¡¨ç°ä¸ºå®ˆå«å¤±è´¥ï¼ˆdata-dependent guard failureï¼‰ï¼ŒæŠ¥é”™å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">Could</span>Â <span class="hljs-selector-tag">not</span> <span class="hljs-selector-tag">guard</span>Â <span class="hljs-selector-tag">on</span>Â <span class="hljs-selector-tag">data-dependent</span> <span class="hljs-selector-tag">expression</span> <span class="hljs-selector-tag">u0</span>*<span class="hljs-selector-tag">u1</span>*<span class="hljs-selector-tag">u2</span> &lt;Â <span class="hljs-number">0</span>Â (<span class="hljs-attribute">unhinted</span>: u0*u1*u2 &lt;Â <span class="hljs-number">0</span>). Â (Size-like <span class="hljs-attribute">symbols</span>: none)
</code></pre>
<p>ä½†äº‹å®ä¸Šï¼Œä»æ¨ç†ä¼˜åŒ–çš„è§’åº¦æ¥çœ‹ï¼Œè¿™ç§å®ç°æ–¹å¼æœ¬èº«æ˜¯ä¸å¿…è¦çš„ã€‚å¯¹äº Self-Forcing æ¨ç†æµç¨‹è€Œè¨€ï¼Œgrid_sizes å®é™…ç”±è§†é¢‘å¸§æ•°ã€latent åˆ†è¾¨ç‡ä»¥åŠ patch å¤§å°å…±åŒå†³å®šï¼Œè€Œè¿™äº›å‚æ•°åœ¨æ¨ç†æœåŠ¡å¯åŠ¨æ—¶å°±å·²ç»ç¡®å®šï¼Œæˆ–ä»…å­˜åœ¨æœ‰é™å‡ ç»„ç¦»æ•£å–å€¼ã€‚å› æ­¤ï¼Œåœ¨æ¨ç†ä¼˜åŒ–åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å°† grid_sizes è§†ä¸ºé…ç½®æœŸå¸¸é‡ï¼Œå¹¶é’ˆå¯¹å›ºå®šé…ç½®å¯¹è®¡ç®—å›¾è¿›è¡Œç‰¹åŒ–ï¼ˆspecializationï¼‰ã€‚</p>
<p>å°½ç®¡è¿™ç§åšæ³•åœ¨å½¢å¼ä¸Šé™ä½äº†å®ç°çš„é€šç”¨æ€§ï¼Œä½†åœ¨æ¨ç†ç³»ç»Ÿä¸­ï¼Œä¸ºå›ºå®šåˆ†è¾¨ç‡å’Œåºåˆ—é•¿åº¦æ„å»ºå¤šç»„è®¡ç®—å›¾æ˜¯ä¸€ç§å¸¸è§ä¸”è¡Œä¹‹æœ‰æ•ˆçš„å·¥ç¨‹å®è·µã€‚å…¶è®¾è®¡æ€æƒ³ä¹Ÿä¸ CUDA Graph å®è·µä¸­çš„åˆ†æ¡¶ï¼ˆbucketingï¼‰ä¸å¡«å……ï¼ˆpaddingï¼‰æœºåˆ¶é«˜åº¦ä¸€è‡´ã€‚</p>
<h3 data-id="heading-6"><strong>KV Cache çš„åŠ¨æ€ç´¢å¼•é—®é¢˜</strong></h3>
<p>KV Cache çš„è¯»å†™æ˜¯æ¨ç†ä»£ç ä¸­å¯¼è‡´ Graph Break çš„å¦ä¸€ä¸ªé«˜é¢‘æ¥æºã€‚åŸå§‹å®ç°ä¸­ï¼ŒKV Cache çš„è®¿é—®ä¾èµ–äºè¿è¡Œæ—¶è®¡ç®—å¾—åˆ°çš„ç´¢å¼•ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># local_start_index å’Œ local_end_index æ˜¯ Tensor ç±»å‹</span>
<span class="hljs-comment"># è¯»å– KV Cache</span>
<span class="hljs-attr">x</span> = kv_cache[<span class="hljs-string">"k"</span>][:, local_start_index:local_end_index]
<span class="hljs-comment"># å†™å…¥ KV Cache</span>
kv_cache<span class="hljs-section">["k"]</span><span class="hljs-section">[:, local_start_index:local_end_index]</span> = roped_key
</code></pre>
<p>ç”±äºå½“å‰ä¸»æµç‰ˆæœ¬çš„ torch.compile å®ç°å°šä¸æ”¯æŒå°†å¼ é‡ä½œä¸ºåˆ‡ç‰‡è¾¹ç•Œï¼Œä¸Šè¿°ä»£ç åœ¨ fullgraph æ¨¡å¼ä¸‹ä¼šå¯¼è‡´ç¼–è¯‘å¤±è´¥ã€‚</p>
<p>é€šè¿‡å¯¹å› æœæ³¨æ„åŠ›å…·ä½“è®¡ç®—è¿‡ç¨‹çš„åˆ†æå¯ä»¥å‘ç°ï¼Œåœ¨æœªå¯ç”¨æ»‘åŠ¨çª—å£æ³¨æ„åŠ›çš„å‰æä¸‹ï¼ŒKV Cache çš„è®¿é—®èŒƒå›´å®é™…ä¸Šå…·æœ‰æ˜ç¡®çš„é—­å¼è§£ï¼šå†å² KV çš„è¯»å–èµ·ç‚¹å§‹ç»ˆä¸º 0ï¼Œè€Œå†™å…¥ä½ç½®åˆ™å¯ä»¥ç”±å…¨å±€åºåˆ—èµ·å§‹ä½ç½® current_start ä¸å½“å‰ block çš„ token æ•°ç›´æ¥ç¡®å®šã€‚åœ¨åºåˆ—å¹¶è¡Œï¼ˆSPï¼‰åœºæ™¯ä¸­ï¼Œç”±äº attention è®¡ç®—å¼€å§‹å‰å·²ç»å®Œæˆäº†å½“å‰ block æ‰€æœ‰åºåˆ—çš„ all-gatherï¼Œè¿™ä¸€ç»“è®ºåŒæ ·æˆç«‹ã€‚</p>
<p>åŸºäºä¸Šè¿°è§‚å¯Ÿï¼Œæˆ‘ä»¬å°† KV Cache ä¸­ä¾èµ–è¿è¡ŒæœŸç´¢å¼•çš„åŠ¨æ€åˆ‡ç‰‡é€»è¾‘é‡æ„ä¸ºç­‰ä»·çš„é™æ€ç´¢å¼•è®¿é—®ï¼Œå¹¶åœ¨å·¥ç¨‹å®ç°ä¸­é€šè¿‡è‡ªå®šä¹‰çš„ tilelang kernel å®ç°é«˜æ•ˆå†™å…¥ã€‚è¯¥æ”¹é€ ä¸ä»…å½»åº•æ¶ˆé™¤äº†ç”± KV Cache è¯»å†™å¼•å‘çš„ Graph Breakï¼Œä¹Ÿåœ¨å®é™…æ¨ç†ä¸­å¸¦æ¥äº†è¾ƒä¸ºæ˜æ˜¾çš„æ€§èƒ½æ”¶ç›Šã€‚</p>
<h3 data-id="heading-7"><strong>Host è°ƒç”¨ä¸ Python å±‚ç¼“å­˜</strong></h3>
<p>é™¤äº†å¼ é‡ç›¸å…³çš„é—®é¢˜ï¼ŒPython å±‚çš„ç¼“å­˜ä¸è°ƒè¯•é€»è¾‘åŒæ ·å¯èƒ½ä¼šç ´åæ•´å›¾ç¼–è¯‘ã€‚ä¾‹å¦‚ï¼Œç¤¾åŒºä¸­å¸¸è§çš„ RoPE ä¼˜åŒ–æ–¹æ¡ˆé€šå¸¸ä½¿ç”¨ LRU ç¼“å­˜ cos/sin å€¼ï¼Œä½†è¯¥ç¼“å­˜æœºåˆ¶ä¾èµ– Python å­—å…¸çš„çŠ¶æ€æ›´æ–°ï¼Œæ¨ç†è¿‡ç¨‹ä¸­ä»ä¼šå¼•å…¥ Host ç«¯å‚ä¸ã€‚</p>
<p>åœ¨å®é™…å·¥ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†è¿™ç±»ä¾èµ–è¿è¡ŒæœŸçŠ¶æ€çš„åŠ¨æ€ç¼“å­˜æ”¹å†™ä¸ºé¢„è®¡ç®—é€»è¾‘ï¼šåœ¨æ¨¡å‹åˆå§‹åŒ–é˜¶æ®µæå‰ç”Ÿæˆæ‰€éœ€çš„ cos / sin å¼ é‡ï¼Œå¹¶ä»¥è¿ç»­ Tensor çš„å½¢å¼å¸¸é©»äº GPU æ˜¾å­˜ä¸­ï¼›åœ¨æ¨ç†é˜¶æ®µä»…é€šè¿‡å¼ é‡ç´¢å¼•å®Œæˆè®¿é—®ï¼Œä»è€Œå½»åº•æ¶ˆé™¤ Python ä¾§çš„å‚ä¸ã€‚</p>
<p>ç±»ä¼¼åœ°ï¼Œè¯¸å¦‚ time.time() ç­‰è°ƒè¯•ä»£ç ä¹Ÿä¼šç›´æ¥è§¦å‘ Graph Breakï¼Œåº”è¯¥åœ¨ä¼˜åŒ–é˜¶æ®µå½»åº•ç§»é™¤ã€‚</p>
<h2 data-id="heading-8"><strong>äº”ã€å®éªŒç»“æœä¸æ€»ç»“</strong></h2>
<p>åœ¨å®Œæˆ Graph Break çš„ç³»ç»Ÿæ€§æ¶ˆé™¤å¹¶å¯ç”¨æ•´å›¾ç¼–è¯‘åï¼Œæˆ‘ä»¬åœ¨ç”Ÿæˆ 5 ç§’ã€480P è§†é¢‘ çš„æ¨ç†ä»»åŠ¡ä¸Šè¿›è¡Œäº†æ€§èƒ½è¯„æµ‹ï¼Œæ¨¡å‹è§„æ¨¡ä¸º 14B å‚æ•°ã€‚æ¶ˆèå®éªŒç»“æœè¡¨æ˜ï¼Œä»…é€šè¿‡ torch.compile çš„æ•´å›¾ä¼˜åŒ–ï¼Œä¾¿å¯åœ¨ç«¯åˆ°ç«¯å±‚é¢è·å¾—çº¦ 47.6% çš„åŠ é€Ÿæ•ˆæœï¼Œå°†æ¨ç†è€—æ—¶ä» 8.86 ç§’ é™ä½è‡³ 6.00 ç§’ï¼Œä¸”æœªè§‚å¯Ÿåˆ°æ˜æ˜¾çš„ç²¾åº¦é€€åŒ–ã€‚</p>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œæœ¬æ–‡å±•ç¤ºäº†åœ¨è‡ªå›å½’è§†é¢‘ç”Ÿæˆæ¨ç†åœºæ™¯ä¸‹ï¼ŒåŸºäº torch.compile å®ç°æ•´å›¾ç¼–è¯‘çš„ä¸€å¥—å·¥ç¨‹å®è·µç»éªŒã€‚æˆ‘ä»¬çš„ç»éªŒè¡¨æ˜ï¼Œæ•´å›¾ç¼–è¯‘çš„æ ¸å¿ƒä»·å€¼å¹¶ä¸ä»…åœ¨äºâ€œè‡ªåŠ¨åŠ é€Ÿâ€ï¼Œæ›´åœ¨äºå…¶å¯¹æ•°æ®ä¾èµ–ã€æ§åˆ¶æµä»¥åŠå·¥ç¨‹å®ç°æ–¹å¼æ‰€æ–½åŠ çš„å¼ºçº¦æŸã€‚è¿™ç§çº¦æŸèƒ½å¤Ÿæ˜¾å¼æš´éœ²ç³»ç»Ÿä¸­çš„éšæ€§å¤æ‚åº¦ï¼Œä¸ºè¿›ä¸€æ­¥çš„åº•å±‚ç®—å­èåˆä¸ç³»ç»Ÿçº§ä¼˜åŒ–å¥ å®šåŸºç¡€ã€‚</p>
<p>-End-</p>
<p>ä½œè€…ä¸¨storyiconã€åœ¨å–å¯ä¹çš„æ´¾æ´¾</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Tauri vs Electronï¼šæ™ºèƒ½å·¥å…·ç®±çš„æŠ€æœ¯é€‰å‹ä¸å®ç°]]></title>    <link>https://juejin.cn/post/7599922362998423598</link>    <guid>https://juejin.cn/post/7599922362998423598</guid>    <pubDate>2026-01-28T01:55:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599922362998423598" data-draft-id="7599963665038573618" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Tauri vs Electronï¼šæ™ºèƒ½å·¥å…·ç®±çš„æŠ€æœ¯é€‰å‹ä¸å®ç°"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,æ¶æ„"/> <meta itemprop="datePublished" content="2026-01-28T01:55:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº‘èˆŸå–"/> <meta itemprop="url" content="https://juejin.cn/user/360295546233959"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Tauri vs Electronï¼šæ™ºèƒ½å·¥å…·ç®±çš„æŠ€æœ¯é€‰å‹ä¸å®ç°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/360295546233959/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº‘èˆŸå–
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T01:55:02.000Z" title="Wed Jan 28 2026 01:55:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    21
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»30åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>éšç€ ChatGPTã€Claude ç­‰å¤§è¯­è¨€æ¨¡å‹çš„çˆ†å‘å¼å‘å±•ï¼ŒAI åº”ç”¨å·²ç»æ·±å…¥åˆ°æˆ‘ä»¬å·¥ä½œç”Ÿæ´»çš„æ–¹æ–¹é¢é¢ã€‚ä½†ç°æœ‰çš„ AI å·¥å…·å¤§å¤šæ˜¯ Web ç«¯æˆ–è€…éœ€è¦è”ç½‘ä½¿ç”¨ï¼Œå¯¹äºä¸€äº›å¸Œæœ›åœ¨æœ¬åœ°è¿›è¡Œæ›´æ·±åº¦å®šåˆ¶åŒ–ä½¿ç”¨çš„ç”¨æˆ·æ¥è¯´ï¼Œè¿˜ç¼ºå°‘ä¸€ä¸ªçœŸæ­£æ„ä¹‰ä¸Šçš„ã€ŒAI å·¥ä½œå°ã€ã€‚</p>
<p>åŸºäºè¿™ä¸ªå‡ºå‘ç‚¹ï¼Œæˆ‘å¼€å‘äº†<strong>æ™ºèƒ½å·¥å…·ç®±ï¼ˆSmart Toolboxï¼‰</strong> â€”â€” ä¸€æ¬¾åŸºäº Tauri 2.x æ„å»ºçš„æ¡Œé¢ AI åŠ©æ‰‹ï¼Œæ”¯æŒå¤šæ¨¡å‹æ¥å…¥ã€è‡ªå®šä¹‰æŠ€èƒ½ã€å·¥ä½œæµç¼–æ’ç­‰åŠŸèƒ½ã€‚</p>
<p>å¦ç™½è¯´ï¼Œé€‰æ‹© Tauri + Rust è¿™ä¸ªæŠ€æœ¯æ ˆï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯å‡ºäº<strong>å¯¹æ–°æŠ€æœ¯çš„å¥½å¥‡å’Œæ¢ç´¢æ¬²</strong>ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘æœ‰è¿‡ Electron å¼€å‘ç»éªŒï¼Œæ·±çŸ¥å…¶ç”Ÿæ€æˆç†Ÿã€å¼€å‘æ•ˆç‡é«˜çš„ä¼˜åŠ¿ï¼Œä½†ä¹Ÿä¸€ç›´è¢«å…¶è‡ƒè‚¿çš„åŒ…ä½“ç§¯å’Œé«˜å†…å­˜å ç”¨æ‰€å›°æ‰°ã€‚å½“äº†è§£åˆ° Tauri å¯ä»¥ç”¨ Rust æ›¿ä»£ Node.js åç«¯ï¼ŒåŒæ—¶ä¿æŒå‰ç«¯å¼€å‘ä½“éªŒæ—¶ï¼Œæˆ‘ç«‹åˆ»äº§ç”Ÿäº†æµ“åšçš„å…´è¶£â€”â€”è¿™æ­£å¥½ç»™äº†æˆ‘ä¸€ä¸ªå­¦ä¹  Rustã€æ¢ç´¢ç°ä»£æ¡Œé¢å¼€å‘æ–°èŒƒå¼çš„æœºä¼šã€‚</p>
<p>æ­¤å¤–ï¼Œé¡¹ç›®çš„è®¾è®¡çµæ„Ÿä¹Ÿéƒ¨åˆ†æ¥æºäºå½“å‰æµè¡Œçš„ AI ç¼–ç¨‹åŠ©æ‰‹ç”Ÿæ€ï¼Œç‰¹åˆ«æ˜¯ Claude Codeã€Cursor ç­‰å·¥å…·æ‰€é‡‡ç”¨çš„ Agent Skills è§„èŒƒã€‚è¿™äº›å·¥å…·é€šè¿‡æ ‡å‡†åŒ–çš„æŠ€èƒ½å®šä¹‰ï¼ˆSKILL.md æ–‡ä»¶ï¼‰å®ç°äº†æŠ€èƒ½çš„å¯å¤ç”¨å’Œå¯å…±äº«ï¼Œè¿™ç»™äº†æˆ‘å¾ˆå¤§çš„å¯å‘ã€‚æˆ‘å¸Œæœ›åœ¨æ™ºèƒ½å·¥å…·ç®±ä¸­ä¸ä»…å…¼å®¹è¿™ç§è§„èŒƒï¼Œè¿˜èƒ½åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œæ‰©å±•ï¼Œæä¾›æ›´å¼ºå¤§çš„åŠŸèƒ½ã€‚</p>
<p>æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»è¿™æ¬¾åº”ç”¨çš„æŠ€æœ¯æ¶æ„å’Œæ ¸å¿ƒå®ç°ï¼ŒåŒæ—¶ä¹Ÿä¼šåˆ†äº«ä» Electron è½¬å‘ Tauri çš„å¼€å‘ä½“éªŒå¯¹æ¯”ï¼Œä»¥åŠ Agent Skills å…¼å®¹å±‚çš„è®¾è®¡ä¸å®ç°ã€‚</p>
<h2 data-id="heading-1">å…¸å‹ä½¿ç”¨åœºæ™¯</h2>
<p>æ™ºèƒ½å·¥å…·ç®±ä½œä¸ºä¸€æ¬¾æ¡Œé¢ AI åŠ©æ‰‹ï¼Œé€‚ç”¨äºå¤šç§ä½¿ç”¨åœºæ™¯ï¼š</p>
<h3 data-id="heading-2">åœºæ™¯1ï¼šå†…å®¹åˆ›ä½œè€…</h3>
<p><strong>ç”¨æˆ·éœ€æ±‚</strong>ï¼šéœ€è¦å¿«é€Ÿç”Ÿæˆé«˜è´¨é‡æ–‡ç« ï¼Œå¹¶å‘å¸ƒåˆ°å¤šä¸ªå¹³å°</p>
<p><strong>ä½¿ç”¨æµç¨‹</strong>ï¼š</p>
<ol>
<li>ç”¨æˆ·è¾“å…¥ï¼š"å¸®æˆ‘å†™ä¸€ç¯‡å…³äº Rust å¹¶å‘ç¼–ç¨‹çš„æŠ€æœ¯æ–‡ç« ï¼Œ1500å­—å·¦å³"</li>
<li>æ„å›¾è¯†åˆ«å¼•æ“è¯†åˆ«åˆ°éœ€è¦è°ƒç”¨"æ–‡ç« ç”Ÿæˆ"æŠ€èƒ½</li>
<li>æŠ€èƒ½æ‰§è¡Œå™¨åŠ è½½æŠ€èƒ½é…ç½®ï¼Œè°ƒç”¨ LLM ç”Ÿæˆæ–‡ç« </li>
<li>ç”¨æˆ·é¢„è§ˆå¹¶è°ƒæ•´æ–‡ç« å†…å®¹</li>
<li>ä½¿ç”¨"å¤šå¹³å°å‘å¸ƒ"å·¥ä½œæµï¼Œä¸€é”®å‘å¸ƒåˆ°æ˜é‡‘ã€å…¬ä¼—å·ç­‰å¹³å°</li>
</ol>
<p><strong>æ”¶ç›Š</strong>ï¼šä»æ„æ€åˆ°å‘å¸ƒï¼Œæ•´ä¸ªè¿‡ç¨‹ä»…éœ€ 10-15 åˆ†é’Ÿï¼Œç›¸æ¯”ä¼ ç»Ÿæ–¹å¼èŠ‚çœ 80% æ—¶é—´</p>
<h3 data-id="heading-3">åœºæ™¯2ï¼šå¼€å‘è€…åŠ©æ‰‹</h3>
<p><strong>ç”¨æˆ·éœ€æ±‚</strong>ï¼šéœ€è¦å¿«é€Ÿç”Ÿæˆä»£ç ã€å¤„ç†æ–‡ä»¶ã€æ‰§è¡Œè‡ªåŠ¨åŒ–ä»»åŠ¡</p>
<p><strong>ä½¿ç”¨æµç¨‹</strong>ï¼š</p>
<ol>
<li>ç”¨æˆ·è¾“å…¥ï¼š"å¸®æˆ‘ç”Ÿæˆä¸€ä¸ª React ç»„ä»¶ï¼ŒåŒ…å«è¡¨å•éªŒè¯åŠŸèƒ½"</li>
<li>ç³»ç»Ÿè°ƒç”¨"ä»£ç ç”Ÿæˆ"æŠ€èƒ½ï¼Œç”Ÿæˆå®Œæ•´çš„ç»„ä»¶ä»£ç </li>
<li>ç”¨æˆ·å¯ä»¥è¿›ä¸€æ­¥è¦æ±‚ï¼š"æ·»åŠ  TypeScript ç±»å‹å®šä¹‰"</li>
<li>ç³»ç»Ÿè‡ªåŠ¨æ›´æ–°ä»£ç ï¼Œæ·»åŠ ç±»å‹å®šä¹‰</li>
<li>ç”¨æˆ·å¯ä»¥ç›´æ¥å¤åˆ¶ä»£ç åˆ°é¡¹ç›®ä¸­ä½¿ç”¨</li>
</ol>
<p><strong>æ”¶ç›Š</strong>ï¼šæé«˜å¼€å‘æ•ˆç‡ï¼Œå‡å°‘é‡å¤æ€§å·¥ä½œ</p>
<h3 data-id="heading-4">åœºæ™¯3ï¼šæ•°æ®åˆ†æå¸ˆ</h3>
<p><strong>ç”¨æˆ·éœ€æ±‚</strong>ï¼šéœ€è¦å¤„ç† Excel æ•°æ®ï¼Œç”Ÿæˆå¯è§†åŒ–æŠ¥å‘Š</p>
<p><strong>ä½¿ç”¨æµç¨‹</strong>ï¼š</p>
<ol>
<li>ç”¨æˆ·ä¸Šä¼  Excel æ–‡ä»¶</li>
<li>è¾“å…¥ï¼š"å¸®æˆ‘åˆ†æè¿™ä¸ªé”€å”®æ•°æ®ï¼Œç”Ÿæˆæœˆåº¦è¶‹åŠ¿å›¾"</li>
<li>ç³»ç»Ÿè°ƒç”¨"æ•°æ®å¤„ç†"æŠ€èƒ½ï¼ˆScript ç±»å‹ï¼‰ï¼Œæ‰§è¡Œ Python è„šæœ¬</li>
<li>ç”Ÿæˆæ•°æ®å¯è§†åŒ–å›¾è¡¨</li>
<li>ç”¨æˆ·å¯ä»¥å¯¼å‡ºæŠ¥å‘Šæˆ–è¿›ä¸€æ­¥åˆ†æ</li>
</ol>
<p><strong>æ”¶ç›Š</strong>ï¼šæ— éœ€ç¼–å†™ä»£ç ï¼Œé€šè¿‡è‡ªç„¶è¯­è¨€å®Œæˆæ•°æ®åˆ†æ</p>
<h3 data-id="heading-5">åœºæ™¯4ï¼šçŸ¥è¯†å·¥ä½œè€…</h3>
<p><strong>ç”¨æˆ·éœ€æ±‚</strong>ï¼šéœ€è¦æ•´ç†ä¼šè®®è®°å½•ã€ç”Ÿæˆå‘¨æŠ¥ã€ä¼˜åŒ–æ–‡æ¡£</p>
<p><strong>ä½¿ç”¨æµç¨‹</strong>ï¼š</p>
<ol>
<li>ç”¨æˆ·ç²˜è´´ä¼šè®®è®°å½•æ–‡æœ¬</li>
<li>è¾“å…¥ï¼š"å¸®æˆ‘æ•´ç†æˆç»“æ„åŒ–çš„ä¼šè®®çºªè¦"</li>
<li>ç³»ç»Ÿè°ƒç”¨"æ–‡æ¡£ä¼˜åŒ–"æŠ€èƒ½ï¼Œç”Ÿæˆæ ¼å¼åŒ–çš„ä¼šè®®çºªè¦</li>
<li>ç”¨æˆ·å¯ä»¥è¿›ä¸€æ­¥è¦æ±‚ï¼š"æå–å¾…åŠäº‹é¡¹"</li>
<li>ç³»ç»Ÿç”Ÿæˆå¾…åŠäº‹é¡¹åˆ—è¡¨</li>
</ol>
<p><strong>æ”¶ç›Š</strong>ï¼šæé«˜æ–‡æ¡£å¤„ç†æ•ˆç‡ï¼Œå‡å°‘æ ¼å¼åŒ–å·¥ä½œ</p>
<h2 data-id="heading-6">ä¸€ã€æŠ€æœ¯é€‰å‹ï¼šä¸ºä»€ä¹ˆé€‰æ‹© Tauri + Rustï¼Ÿ</h2>
<h3 data-id="heading-7">1.1 è·¨å¹³å°æ¡Œé¢å¼€å‘çš„é€‰æ‹©</h3>
<p>åœ¨å¼€å§‹å¼€å‘å‰ï¼Œæˆ‘å¯¹æ¯”äº†ä¸»æµçš„æ¡Œé¢è·¨å¹³å°æ–¹æ¡ˆï¼š</p>



































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>ä¼˜åŠ¿</th><th>åŠ£åŠ¿</th><th>åŒ…ä½“ç§¯</th></tr></thead><tbody><tr><td>Electron</td><td>ç”Ÿæ€æˆç†Ÿï¼Œå¼€å‘æ•ˆç‡é«˜</td><td>å†…å­˜å ç”¨å¤§ï¼ŒåŒ…ä½“ç§¯å¤§</td><td>150MB+</td></tr><tr><td>Tauri</td><td>åŒ…ä½“ç§¯å°ï¼Œæ€§èƒ½å¥½ï¼Œå®‰å…¨æ€§é«˜</td><td>ç”Ÿæ€ç›¸å¯¹å¹´è½»</td><td>10-20MB</td></tr><tr><td>Flutter Desktop</td><td>ä¸€å¥—ä»£ç å¤šç«¯è¿è¡Œ</td><td>æ¡Œé¢ç«¯ç”Ÿæ€ä¸æˆç†Ÿ</td><td>20-30MB</td></tr><tr><td>Qt</td><td>æˆç†Ÿç¨³å®š</td><td>å¼€å‘æˆæœ¬é«˜ï¼Œç•Œé¢å¼€å‘ç¹ç</td><td>50MB+</td></tr></tbody></table>
<p>æœ€ç»ˆé€‰æ‹©Â <strong>Tauri 2.x</strong>Â çš„åŸå› ï¼š</p>
<ol>
<li><strong>æå°çš„åŒ…ä½“ç§¯</strong>ï¼šæœ€ç»ˆæ‰“åŒ…åä»… 15MB å·¦å³ï¼Œç›¸æ¯” Electron åŠ¨è¾„ 150MB+ çš„ä½“ç§¯ï¼Œç”¨æˆ·ä½“éªŒæ›´å¥½</li>
<li><strong>Rust åç«¯</strong>ï¼šé«˜æ€§èƒ½ã€å†…å­˜å®‰å…¨ï¼Œéå¸¸é€‚åˆå¤„ç†åŠ å¯†ã€æ–‡ä»¶æ“ä½œç­‰åº•å±‚ä»»åŠ¡</li>
<li><strong>å®‰å…¨æ€§</strong>ï¼šé»˜è®¤æœ€å°æƒé™åŸåˆ™ï¼ŒIPC é€šä¿¡æœ‰ä¸¥æ ¼çš„å‘½ä»¤ç™½åå•æœºåˆ¶</li>
<li><strong>Tauri 2.x æ–°ç‰¹æ€§</strong>ï¼šæ›´å¥½çš„æ’ä»¶ç³»ç»Ÿã€ç§»åŠ¨ç«¯æ”¯æŒé¢„è§ˆã€æ›´çµæ´»çš„æƒé™æ§åˆ¶</li>
<li><strong>å­¦ä¹ æ–°æŠ€æœ¯çš„æœºä¼š</strong>ï¼šRust çš„æ‰€æœ‰æƒæ¨¡å‹ã€ç±»å‹ç³»ç»Ÿè®©æˆ‘å¯¹ç³»ç»Ÿç¼–ç¨‹æœ‰äº†æ›´æ·±çš„ç†è§£ï¼Œè¿™ç§å­¦ä¹ è¿‡ç¨‹æœ¬èº«å°±æ˜¯ä¸€ç§æ”¶è·</li>
</ol>
<h3 data-id="heading-8">1.2 Agent Skills ç”Ÿæ€å…¼å®¹æ€§</h3>
<p>åœ¨å¼€å§‹æŠ€æœ¯é€‰å‹ä¹‹å‰ï¼Œæˆ‘æƒ³å…ˆè°ˆè°ˆé¡¹ç›®çš„ä¸€ä¸ªé‡è¦è®¾è®¡ç›®æ ‡ï¼š<strong>å…¼å®¹ Agent Skills ç”Ÿæ€</strong>ã€‚</p>
<p>Agent Skills æ˜¯ Claude Codeã€Cursorã€Windsurf ç­‰ AI ç¼–ç¨‹åŠ©æ‰‹æ‰€é‡‡ç”¨çš„æŠ€èƒ½å®šä¹‰è§„èŒƒã€‚å®ƒé€šè¿‡æ ‡å‡†åŒ–çš„Â <code>SKILL.md</code>Â æ–‡ä»¶æ ¼å¼ï¼Œè®©æŠ€èƒ½å¯ä»¥åœ¨ä¸åŒçš„ AI å·¥å…·ä¹‹é—´å…±äº«å’Œå¤ç”¨ã€‚</p>
<p><strong>Agent Skills æ ‡å‡†æ ¼å¼</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">.claude/skills/my-skill/
â”œâ”€â”€ SKILL.md              <span class="hljs-comment"># æŠ€èƒ½å®šä¹‰ï¼ˆYAML frontmatter + Markdownï¼‰</span>
â”œâ”€â”€ scripts/              <span class="hljs-comment"># å¯é€‰ï¼šè„šæœ¬æ–‡ä»¶</span>
â”‚   â””â”€â”€ main.py
â”œâ”€â”€ examples/             <span class="hljs-comment"># å¯é€‰ï¼šä½¿ç”¨ç¤ºä¾‹</span>
â”‚   â””â”€â”€ example.md
â””â”€â”€ references/           <span class="hljs-comment"># å¯é€‰ï¼šå‚è€ƒæ–‡æ¡£</span>
    â””â”€â”€ reference.md
</code></pre>
<p><strong>æ™ºèƒ½å·¥å…·ç®±çš„å…¼å®¹ç­–ç•¥</strong>ï¼š</p>
<ol>
<li><strong>åŒå‘è½¬æ¢</strong>ï¼šæ”¯æŒå°† Agent Skills æ ¼å¼è½¬æ¢ä¸ºå†…éƒ¨ DSLï¼Œåä¹‹äº¦ç„¶</li>
<li><strong>åŠŸèƒ½æ‰©å±•</strong>ï¼šåœ¨å…¼å®¹çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº† Workflow ç¼–æ’ã€Token ä¼˜åŒ–ç­‰é«˜çº§åŠŸèƒ½</li>
<li><strong>ç”Ÿæ€äº’é€š</strong>ï¼šç”¨æˆ·å¯ä»¥ç›´æ¥å¯¼å…¥ Claude Code çš„æŠ€èƒ½ï¼Œä¹Ÿå¯ä»¥å°†æ™ºèƒ½å·¥å…·ç®±çš„æŠ€èƒ½å¯¼å‡ºä¾›å…¶ä»–å·¥å…·ä½¿ç”¨</li>
</ol>
<p>è¿™ç§è®¾è®¡è®©æ™ºèƒ½å·¥å…·ç®±æ—¢èƒ½äº«å— Agent Skills ç”Ÿæ€çš„ä¸°å¯Œèµ„æºï¼Œåˆèƒ½æä¾›æ›´å¼ºå¤§çš„æœ¬åœ°èƒ½åŠ›ã€‚</p>
<h3 data-id="heading-9">1.3 æŠ€æœ¯æ ˆå…¨æ™¯</h3>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           å‰ç«¯ (Frontend)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  React <span class="hljs-number">18</span> + TypeScript + Tailwind CSS + shadcn/ui           â”‚ â”‚
â”‚  â”‚  Zustand (çŠ¶æ€ç®¡ç†) + React Router (è·¯ç”±)                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        Tauri IPC Bridge                          â”‚
â”‚                    (åŸºäº Tauri Commands)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                           åç«¯ (Backend)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Tauri <span class="hljs-number">2</span><span class="hljs-selector-class">.x</span> + Rust                                           â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ Commands Layer (å‘½ä»¤å±‚)                                 â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ Services Layer (æœåŠ¡å±‚)                                 â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ LLM Providers (å¤šæ¨¡å‹é€‚é…å™¨)                             â”‚ â”‚
â”‚  â”‚  â””â”€â”€ SQLite Database (æœ¬åœ°å­˜å‚¨)                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h2 data-id="heading-10">äºŒã€æ ¸å¿ƒæ¶æ„è®¾è®¡</h2>
<h3 data-id="heading-11">2.1 æ•´ä½“æ¶æ„å›¾</h3>
<pre><code class="hljs language-bash" lang="bash">æ™ºèƒ½å·¥å…·ç®±æ¶æ„
â”œâ”€â”€ ğŸ“± å‰ç«¯ UI å±‚
â”‚   â”œâ”€â”€ pages/          <span class="hljs-comment"># é¡µé¢ç»„ä»¶</span>
â”‚   â”‚   â”œâ”€â”€ ChatPage        <span class="hljs-comment"># å¯¹è¯é¡µé¢</span>
â”‚   â”‚   â”œâ”€â”€ SkillsPage      <span class="hljs-comment"># æŠ€èƒ½åº“é¡µé¢</span>
â”‚   â”‚   â”œâ”€â”€ WorkflowPage    <span class="hljs-comment"># å·¥ä½œæµé¡µé¢</span>
â”‚   â”‚   â””â”€â”€ SettingsPage    <span class="hljs-comment"># è®¾ç½®é¡µé¢</span>
â”‚   â”œâ”€â”€ components/     <span class="hljs-comment"># é€šç”¨ç»„ä»¶</span>
â”‚   â”‚   â”œâ”€â”€ ui/             <span class="hljs-comment"># shadcn/ui åŸºç¡€ç»„ä»¶</span>
â”‚   â”‚   â”œâ”€â”€ wizard/         <span class="hljs-comment"># æŠ€èƒ½ç”Ÿæˆå‘å¯¼ç»„ä»¶</span>
â”‚   â”‚   â””â”€â”€ platform/       <span class="hljs-comment"># å¹³å°å‘å¸ƒç»„ä»¶</span>
â”‚   â”œâ”€â”€ stores/         <span class="hljs-comment"># Zustand çŠ¶æ€ç®¡ç†</span>
â”‚   â”‚   â”œâ”€â”€ chatStore       <span class="hljs-comment"># å¯¹è¯çŠ¶æ€</span>
â”‚   â”‚   â”œâ”€â”€ skillStore      <span class="hljs-comment"># æŠ€èƒ½çŠ¶æ€</span>
â”‚   â”‚   â””â”€â”€ configStore     <span class="hljs-comment"># é…ç½®çŠ¶æ€</span>
â”‚   â””â”€â”€ types/          <span class="hljs-comment"># TypeScript ç±»å‹å®šä¹‰</span>
â”‚
â””â”€â”€ âš™ï¸ åç«¯ Rust å±‚
    â”œâ”€â”€ commands/       <span class="hljs-comment"># Tauri å‘½ä»¤å±‚</span>
    â”‚   â”œâ”€â”€ chat.rs         <span class="hljs-comment"># å¯¹è¯ç›¸å…³å‘½ä»¤</span>
    â”‚   â”œâ”€â”€ skills.rs       <span class="hljs-comment"># æŠ€èƒ½ç®¡ç†å‘½ä»¤</span>
    â”‚   â”œâ”€â”€ workflow.rs     <span class="hljs-comment"># å·¥ä½œæµå‘½ä»¤</span>
    â”‚   â””â”€â”€ config.rs       <span class="hljs-comment"># é…ç½®å‘½ä»¤</span>
    â”œâ”€â”€ services/       <span class="hljs-comment"># æ ¸å¿ƒæœåŠ¡å±‚</span>
    â”‚   â”œâ”€â”€ skill_executor      <span class="hljs-comment"># æŠ€èƒ½æ‰§è¡Œå™¨</span>
    â”‚   â”œâ”€â”€ skill_wizard        <span class="hljs-comment"># æŠ€èƒ½ç”Ÿæˆå‘å¯¼</span>
    â”‚   â”œâ”€â”€ intent_recognizer   <span class="hljs-comment"># æ„å›¾è¯†åˆ«</span>
    â”‚   â”œâ”€â”€ token_optimizer     <span class="hljs-comment"># Token ä¼˜åŒ–</span>
    â”‚   â””â”€â”€ platform_publisher  <span class="hljs-comment"># å¹³å°å‘å¸ƒ</span>
    â”œâ”€â”€ llm/            <span class="hljs-comment"># LLM å¤šæ¨¡å‹é€‚é…</span>
    â”‚   â”œâ”€â”€ providers.rs    <span class="hljs-comment"># æ¨¡å‹æä¾›å•†é€‚é…</span>
    â”‚   â””â”€â”€ types.rs        <span class="hljs-comment"># LLM ç±»å‹å®šä¹‰</span>
    â”œâ”€â”€ workflow/       <span class="hljs-comment"># å·¥ä½œæµå¼•æ“</span>
    â”‚   â”œâ”€â”€ engine.rs       <span class="hljs-comment"># æ‰§è¡Œå¼•æ“</span>
    â”‚   â””â”€â”€ types.rs        <span class="hljs-comment"># å·¥ä½œæµç±»å‹</span>
    â””â”€â”€ database/       <span class="hljs-comment"># æ•°æ®åº“å±‚</span>
        â”œâ”€â”€ models.rs       <span class="hljs-comment"># æ•°æ®æ¨¡å‹</span>
        â””â”€â”€ migrations.rs   <span class="hljs-comment"># æ•°æ®åº“è¿ç§»</span>
</code></pre>
<h3 data-id="heading-12">2.2 æ•°æ®æµè®¾è®¡</h3>
<p>ä»¥ä¸€æ¬¡å…¸å‹çš„å¯¹è¯æµç¨‹ä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">ç”¨æˆ·è¾“å…¥ "å¸®æˆ‘å†™ä¸€ç¯‡å…³äº Rust çš„æ–‡ç« "
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   ChatPage<span class="hljs-selector-class">.tsx</span>  â”‚  â† å‰ç«¯æ•è·ç”¨æˆ·è¾“å…¥
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ <span class="hljs-built_in">invoke</span>('send_message', {...})
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  chat<span class="hljs-selector-class">.rs</span>        â”‚  â† Tauri å‘½ä»¤å±‚
    â”‚  <span class="hljs-built_in">send_message</span>() â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ IntentRecognizerâ”‚  â† æ„å›¾è¯†åˆ«æœåŠ¡
    â”‚ <span class="hljs-built_in">analyze_intent</span>()â”‚     åˆ¤æ–­ç”¨æˆ·æƒ³åšä»€ä¹ˆ
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ è¯†åˆ«åˆ°ï¼šè°ƒç”¨æŠ€èƒ½ "<span class="hljs-selector-tag">article</span>-writer"
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ SkillExecutor   â”‚  â† æŠ€èƒ½æ‰§è¡Œå™¨
    â”‚ <span class="hljs-built_in">execute</span>()       â”‚     åŠ è½½æŠ€èƒ½é…ç½®ï¼Œå‡†å¤‡æç¤ºè¯
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ LLM Provider    â”‚  â† è°ƒç”¨å¤§è¯­è¨€æ¨¡å‹
    â”‚ <span class="hljs-built_in">chat_stream</span>()   â”‚     æ”¯æŒ OpenAI/Claude/DeepSeek ç­‰
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ SSE æµå¼å“åº”
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  TokenOptimizer â”‚  â† Token ä¼˜åŒ–
    â”‚  <span class="hljs-built_in">record_usage</span>() â”‚     è®°å½•ä½¿ç”¨é‡ï¼Œä¼˜åŒ–ä¼šè¯
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   ChatPage<span class="hljs-selector-class">.tsx</span>  â”‚  â† å‰ç«¯æ¸²æŸ“ç»“æœ
    â”‚   å®æ—¶æ˜¾ç¤ºæµå¼è¾“å‡ºâ”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h2 data-id="heading-13">ä¸‰ã€æ ¸å¿ƒæ¨¡å—å®ç°è§£æ</h2>
<h3 data-id="heading-14">3.1 å¤šæ¨¡å‹ LLM é€‚é…å™¨</h3>
<p>ä¸ºäº†æ”¯æŒå¤šç§å¤§è¯­è¨€æ¨¡å‹ï¼Œæˆ‘è®¾è®¡äº†ä¸€å¥—ç»Ÿä¸€çš„é€‚é…å™¨æ¥å£ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// src-tauri/src/llm/providers.rs</span>

<span class="hljs-comment">/// LLM æä¾›å•†æšä¸¾</span>
<span class="hljs-meta">#[derive(Debug, Clone, Serialize, Deserialize)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">LLMProvider</span> {
    OpenAI,
    Claude,
    DeepSeek,
    AI360,
    Ollama,
}

<span class="hljs-comment">/// ç»Ÿä¸€çš„ LLM å®¢æˆ·ç«¯</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">LLMClient</span> {
    provider: LLMProvider,
    api_key: <span class="hljs-type">String</span>,
    base_url: <span class="hljs-type">Option</span>&lt;<span class="hljs-type">String</span>&gt;,
    model: <span class="hljs-type">String</span>,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">LLMClient</span> {
    <span class="hljs-comment">/// æµå¼å¯¹è¯æ¥å£</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">chat_stream</span>(
        &amp;<span class="hljs-keyword">self</span>,
        messages: <span class="hljs-type">Vec</span>&lt;ChatMessage&gt;,
        options: ChatOptions,
    ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Stream</span>&lt;Item = <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>, AppError&gt;&gt;, AppError&gt; {
        <span class="hljs-keyword">match</span> <span class="hljs-keyword">self</span>.provider {
            LLMProvider::OpenAI =&gt; <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">openai_stream</span>(messages, options).<span class="hljs-keyword">await</span>,
            LLMProvider::Claude =&gt; <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">claude_stream</span>(messages, options).<span class="hljs-keyword">await</span>,
            LLMProvider::DeepSeek =&gt; <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">deepseek_stream</span>(messages, options).<span class="hljs-keyword">await</span>,
            LLMProvider::AI360 =&gt; <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">ai360_stream</span>(messages, options).<span class="hljs-keyword">await</span>,
            LLMProvider::Ollama =&gt; <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">ollama_stream</span>(messages, options).<span class="hljs-keyword">await</span>,
        }
    }
    
    <span class="hljs-comment">/// OpenAI å…¼å®¹æ¥å£å®ç°</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">openai_stream</span>(
        &amp;<span class="hljs-keyword">self</span>,
        messages: <span class="hljs-type">Vec</span>&lt;ChatMessage&gt;,
        options: ChatOptions,
    ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Stream</span>&lt;Item = <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>, AppError&gt;&gt;, AppError&gt; {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">url</span> = <span class="hljs-built_in">format!</span>(
            <span class="hljs-string">"{}/chat/completions"</span>,
            <span class="hljs-keyword">self</span>.base_url.<span class="hljs-title function_ invoke__">as_deref</span>().<span class="hljs-title function_ invoke__">unwrap_or</span>(<span class="hljs-string">"https://api.openai.com/v1"</span>)
        );
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">payload</span> = json!({
            <span class="hljs-string">"model"</span>: <span class="hljs-keyword">self</span>.model,
            <span class="hljs-string">"messages"</span>: messages,
            <span class="hljs-string">"stream"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-string">"temperature"</span>: options.temperature.<span class="hljs-title function_ invoke__">unwrap_or</span>(<span class="hljs-number">0.7</span>),
            <span class="hljs-string">"max_tokens"</span>: options.max_tokens,
        });
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">response</span> = reqwest::Client::<span class="hljs-title function_ invoke__">new</span>()
            .<span class="hljs-title function_ invoke__">post</span>(&amp;url)
            .<span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">"Authorization"</span>, <span class="hljs-built_in">format!</span>(<span class="hljs-string">"Bearer {}"</span>, <span class="hljs-keyword">self</span>.api_key))
            .<span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"application/json"</span>)
            .<span class="hljs-title function_ invoke__">json</span>(&amp;payload)
            .<span class="hljs-title function_ invoke__">send</span>()
            .<span class="hljs-keyword">await</span>?;
        
        <span class="hljs-comment">// å¤„ç† SSE æµå¼å“åº”</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">stream</span> = response.<span class="hljs-title function_ invoke__">bytes_stream</span>().<span class="hljs-title function_ invoke__">map</span>(|chunk| {
            <span class="hljs-comment">// è§£æ SSE æ•°æ®...</span>
        });
        
        <span class="hljs-title function_ invoke__">Ok</span>(stream)
    }
}
</code></pre>
<p><strong>è®¾è®¡äº®ç‚¹</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨æšä¸¾ç»Ÿä¸€ç®¡ç†æ‰€æœ‰æ”¯æŒçš„æ¨¡å‹æä¾›å•†</li>
<li>æµå¼æ¥å£è¿”å›Â <code>Stream</code>ï¼Œæ”¯æŒå®æ—¶æ¸²æŸ“</li>
<li>DeepSeekã€360AI ç­‰å›½äº§æ¨¡å‹å…¼å®¹ OpenAI æ¥å£æ ¼å¼ï¼Œä»£ç å¤ç”¨ç‡é«˜</li>
</ul>
<h3 data-id="heading-15">3.2 æŠ€èƒ½ç³»ç»Ÿè®¾è®¡</h3>
<p>æŠ€èƒ½æ˜¯æ™ºèƒ½å·¥å…·ç®±çš„æ ¸å¿ƒæ¦‚å¿µï¼Œä¸€ä¸ªæŠ€èƒ½å¯ä»¥ç†è§£ä¸ºã€Œä¸€ä¸ªå¯å¤ç”¨çš„ AI ä»»åŠ¡æ¨¡æ¿ã€ã€‚</p>
<h4 data-id="heading-16">æŠ€èƒ½æ•°æ®ç»“æ„</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// src-tauri/src/skills/mod.rs</span>

<span class="hljs-comment">/// æŠ€èƒ½ç±»å‹</span>
<span class="hljs-meta">#[derive(Debug, Clone, Serialize, Deserialize)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">SkillType</span> {
    Prompt,     <span class="hljs-comment">// æç¤ºè¯æŠ€èƒ½ï¼šçº¯ LLM è°ƒç”¨</span>
    Script,     <span class="hljs-comment">// è„šæœ¬æŠ€èƒ½ï¼šæ‰§è¡Œä»£ç </span>
    Workflow,   <span class="hljs-comment">// å·¥ä½œæµæŠ€èƒ½ï¼šå¤šæ­¥éª¤ç¼–æ’</span>
}

<span class="hljs-comment">/// æŠ€èƒ½å®šä¹‰</span>
<span class="hljs-meta">#[derive(Debug, Clone, Serialize, Deserialize)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">Skill</span> {
    <span class="hljs-keyword">pub</span> id: <span class="hljs-type">String</span>,
    <span class="hljs-keyword">pub</span> name: <span class="hljs-type">String</span>,
    <span class="hljs-keyword">pub</span> display_name: <span class="hljs-type">String</span>,
    <span class="hljs-keyword">pub</span> description: <span class="hljs-type">String</span>,
    <span class="hljs-keyword">pub</span> skill_type: SkillType,
    <span class="hljs-keyword">pub</span> category: SkillCategory,
    <span class="hljs-keyword">pub</span> triggers: <span class="hljs-type">Vec</span>&lt;<span class="hljs-type">String</span>&gt;,      <span class="hljs-comment">// è§¦å‘è¯</span>
    <span class="hljs-keyword">pub</span> icon: <span class="hljs-type">String</span>,
    <span class="hljs-keyword">pub</span> enabled: <span class="hljs-type">bool</span>,
    <span class="hljs-keyword">pub</span> prompt_config: <span class="hljs-type">Option</span>&lt;PromptConfig&gt;,
    <span class="hljs-keyword">pub</span> script_config: <span class="hljs-type">Option</span>&lt;ScriptConfig&gt;,
    <span class="hljs-keyword">pub</span> workflow_config: <span class="hljs-type">Option</span>&lt;WorkflowConfig&gt;,
}

<span class="hljs-comment">/// æç¤ºè¯é…ç½®</span>
<span class="hljs-meta">#[derive(Debug, Clone, Serialize, Deserialize)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">PromptConfig</span> {
    <span class="hljs-keyword">pub</span> system: <span class="hljs-type">String</span>,             <span class="hljs-comment">// ç³»ç»Ÿæç¤ºè¯ï¼ˆå®Œæ•´ç‰ˆï¼‰</span>
    <span class="hljs-keyword">pub</span> system_compact: <span class="hljs-type">String</span>,     <span class="hljs-comment">// ç³»ç»Ÿæç¤ºè¯ï¼ˆç²¾ç®€ç‰ˆï¼Œçœ Tokenï¼‰</span>
    <span class="hljs-keyword">pub</span> variables: <span class="hljs-type">Vec</span>&lt;SkillVariable&gt;,
    <span class="hljs-keyword">pub</span> output_format: <span class="hljs-type">Option</span>&lt;<span class="hljs-type">String</span>&gt;,
}

<span class="hljs-comment">/// æŠ€èƒ½å˜é‡</span>
<span class="hljs-meta">#[derive(Debug, Clone, Serialize, Deserialize)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">SkillVariable</span> {
    <span class="hljs-keyword">pub</span> name: <span class="hljs-type">String</span>,
    <span class="hljs-keyword">pub</span> var_type: <span class="hljs-type">String</span>,           <span class="hljs-comment">// string / number / boolean / array</span>
    <span class="hljs-keyword">pub</span> description: <span class="hljs-type">String</span>,
    <span class="hljs-keyword">pub</span> required: <span class="hljs-type">bool</span>,
    <span class="hljs-keyword">pub</span> default: <span class="hljs-type">Option</span>&lt;Value&gt;,
}
</code></pre>
<h4 data-id="heading-17">æŠ€èƒ½æ‰§è¡Œå™¨</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// src-tauri/src/services/skill_executor.rs</span>

<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">SkillExecutor</span> {
    llm_client: LLMClient,
    db: Database,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">SkillExecutor</span> {
    <span class="hljs-comment">/// æ‰§è¡ŒæŠ€èƒ½</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">execute</span>(
        &amp;<span class="hljs-keyword">self</span>,
        skill: &amp;Skill,
        context: &amp;SkillContext,
    ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;SkillResult, AppError&gt; {
        <span class="hljs-keyword">match</span> skill.skill_type {
            SkillType::Prompt =&gt; <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">execute_prompt</span>(skill, context).<span class="hljs-keyword">await</span>,
            SkillType::Script =&gt; <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">execute_script</span>(skill, context).<span class="hljs-keyword">await</span>,
            SkillType::Workflow =&gt; <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">execute_workflow</span>(skill, context).<span class="hljs-keyword">await</span>,
        }
    }
    
    <span class="hljs-comment">/// æ‰§è¡Œæç¤ºè¯æŠ€èƒ½</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">execute_prompt</span>(
        &amp;<span class="hljs-keyword">self</span>,
        skill: &amp;Skill,
        context: &amp;SkillContext,
    ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;SkillResult, AppError&gt; {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">config</span> = skill.prompt_config.<span class="hljs-title function_ invoke__">as_ref</span>()
            .<span class="hljs-title function_ invoke__">ok_or_else</span>(|| AppError::<span class="hljs-title function_ invoke__">Skill</span>(<span class="hljs-string">"æŠ€èƒ½é…ç½®ç¼ºå¤±"</span>.<span class="hljs-title function_ invoke__">to_string</span>()))?;
        
        <span class="hljs-comment">// 1. æ ¹æ® Token ä¼˜åŒ–ç­–ç•¥é€‰æ‹©æç¤ºè¯ç‰ˆæœ¬</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">system_prompt</span> = <span class="hljs-keyword">if</span> context.use_compact_prompt {
            &amp;config.system_compact
        } <span class="hljs-keyword">else</span> {
            &amp;config.system
        };
        
        <span class="hljs-comment">// 2. å˜é‡æ›¿æ¢</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">processed_prompt</span> = <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">replace_variables</span>(system_prompt, &amp;context.variables)?;
        
        <span class="hljs-comment">// 3. æ„å»ºæ¶ˆæ¯åˆ—è¡¨</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">messages</span> = <span class="hljs-built_in">vec!</span>[
            ChatMessage { role: <span class="hljs-string">"system"</span>.<span class="hljs-title function_ invoke__">to_string</span>(), content: processed_prompt },
            ChatMessage { role: <span class="hljs-string">"user"</span>.<span class="hljs-title function_ invoke__">to_string</span>(), content: context.user_input.<span class="hljs-title function_ invoke__">clone</span>() },
        ];
        
        <span class="hljs-comment">// 4. è°ƒç”¨ LLM</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">response</span> = <span class="hljs-keyword">self</span>.llm_client.<span class="hljs-title function_ invoke__">chat_stream</span>(messages, ChatOptions::<span class="hljs-title function_ invoke__">default</span>()).<span class="hljs-keyword">await</span>?;
        
        <span class="hljs-title function_ invoke__">Ok</span>(SkillResult {
            success: <span class="hljs-literal">true</span>,
            output: response,
            token_used: <span class="hljs-number">0</span>, <span class="hljs-comment">// å®é™…ä¼šåœ¨æµç»“æŸåç»Ÿè®¡</span>
        })
    }
}
</code></pre>
<h3 data-id="heading-18">3.3 æ„å›¾è¯†åˆ«å¼•æ“</h3>
<p>å½“ç”¨æˆ·è¾“å…¥ä¸€æ®µè¯åï¼Œç³»ç»Ÿéœ€è¦åˆ¤æ–­ç”¨æˆ·çš„æ„å›¾ï¼Œå†³å®šæ˜¯ç›´æ¥å¯¹è¯ã€è°ƒç”¨æŠ€èƒ½ã€è¿˜æ˜¯æ‰§è¡Œå…¶ä»–æ“ä½œã€‚</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// src-tauri/src/services/intent_recognizer.rs</span>

<span class="hljs-comment">/// ç”¨æˆ·æ„å›¾ç±»å‹</span>
<span class="hljs-meta">#[derive(Debug, Clone, Serialize, Deserialize)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">UserIntent</span> {
    <span class="hljs-comment">/// è°ƒç”¨å·²æœ‰æŠ€èƒ½</span>
    InvokeSkill { skill_id: <span class="hljs-type">String</span>, confidence: <span class="hljs-type">f32</span> },
    <span class="hljs-comment">/// åˆ›å»ºæ–°æŠ€èƒ½</span>
    CreateSkill { description: <span class="hljs-type">String</span> },
    <span class="hljs-comment">/// ç®¡ç†æŠ€èƒ½ï¼ˆæŸ¥çœ‹ã€ç¼–è¾‘ã€åˆ é™¤ï¼‰</span>
    ManageSkill { action: <span class="hljs-type">String</span> },
    <span class="hljs-comment">/// æ‰§è¡Œå·¥ä½œæµ</span>
    RunWorkflow { workflow_id: <span class="hljs-type">String</span> },
    <span class="hljs-comment">/// æ™®é€šå¯¹è¯</span>
    Chat,
}

<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">IntentRecognizer</span> {
    skills: <span class="hljs-type">Vec</span>&lt;Skill&gt;,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">IntentRecognizer</span> {
    <span class="hljs-comment">/// åˆ†æç”¨æˆ·æ„å›¾</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">analyze</span>(&amp;<span class="hljs-keyword">self</span>, input: &amp;<span class="hljs-type">str</span>) <span class="hljs-punctuation">-&gt;</span> UserIntent {
        <span class="hljs-comment">// 1. å…ˆå°è¯•å…³é”®è¯åŒ¹é…ï¼ˆå¿«é€Ÿè·¯å¾„ï¼‰</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(intent) = <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">keyword_match</span>(input) {
            <span class="hljs-keyword">return</span> intent;
        }
        
        <span class="hljs-comment">// 2. è§¦å‘è¯åŒ¹é…ï¼ˆéå†æ‰€æœ‰æŠ€èƒ½çš„ triggersï¼‰</span>
        <span class="hljs-keyword">for</span> <span class="hljs-variable">skill</span> <span class="hljs-keyword">in</span> &amp;<span class="hljs-keyword">self</span>.skills {
            <span class="hljs-keyword">for</span> <span class="hljs-variable">trigger</span> <span class="hljs-keyword">in</span> &amp;skill.triggers {
                <span class="hljs-keyword">if</span> input.<span class="hljs-title function_ invoke__">contains</span>(trigger) {
                    <span class="hljs-keyword">return</span> UserIntent::InvokeSkill {
                        skill_id: skill.id.<span class="hljs-title function_ invoke__">clone</span>(),
                        confidence: <span class="hljs-number">0.9</span>,
                    };
                }
            }
        }
        
        <span class="hljs-comment">// 3. æ¨¡ç³ŠåŒ¹é…ï¼ˆä½¿ç”¨ç¼–è¾‘è·ç¦»ç®—æ³•ï¼‰</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>((skill_id, score)) = <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">fuzzy_match</span>(input) {
            <span class="hljs-keyword">if</span> score &gt; <span class="hljs-number">0.7</span> {
                <span class="hljs-keyword">return</span> UserIntent::InvokeSkill {
                    skill_id,
                    confidence: score,
                };
            }
        }
        
        <span class="hljs-comment">// 4. é»˜è®¤ä¸ºæ™®é€šå¯¹è¯</span>
        UserIntent::Chat
    }
    
    <span class="hljs-comment">/// å…³é”®è¯åŒ¹é…</span>
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">keyword_match</span>(&amp;<span class="hljs-keyword">self</span>, input: &amp;<span class="hljs-type">str</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Option</span>&lt;UserIntent&gt; {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">create_keywords</span> = [<span class="hljs-string">"åˆ›å»ºæŠ€èƒ½"</span>, <span class="hljs-string">"æ–°å»ºæŠ€èƒ½"</span>, <span class="hljs-string">"ç”ŸæˆæŠ€èƒ½"</span>, <span class="hljs-string">"åšä¸€ä¸ªæŠ€èƒ½"</span>];
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">manage_keywords</span> = [<span class="hljs-string">"æŸ¥çœ‹æŠ€èƒ½"</span>, <span class="hljs-string">"ç¼–è¾‘æŠ€èƒ½"</span>, <span class="hljs-string">"åˆ é™¤æŠ€èƒ½"</span>, <span class="hljs-string">"æŠ€èƒ½åˆ—è¡¨"</span>];
        
        <span class="hljs-keyword">for</span> <span class="hljs-variable">keyword</span> <span class="hljs-keyword">in</span> create_keywords {
            <span class="hljs-keyword">if</span> input.<span class="hljs-title function_ invoke__">contains</span>(keyword) {
                <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">Some</span>(UserIntent::CreateSkill {
                    description: input.<span class="hljs-title function_ invoke__">to_string</span>(),
                });
            }
        }
        
        <span class="hljs-keyword">for</span> <span class="hljs-variable">keyword</span> <span class="hljs-keyword">in</span> manage_keywords {
            <span class="hljs-keyword">if</span> input.<span class="hljs-title function_ invoke__">contains</span>(keyword) {
                <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">Some</span>(UserIntent::ManageSkill {
                    action: keyword.<span class="hljs-title function_ invoke__">to_string</span>(),
                });
            }
        }
        
        <span class="hljs-literal">None</span>
    }
}
</code></pre>
<h3 data-id="heading-19">3.4 Token ä¼˜åŒ–ç­–ç•¥</h3>
<p>è°ƒç”¨ LLM éœ€è¦æ¶ˆè€— Tokenï¼Œå¦‚ä½•åœ¨ä¿è¯æ•ˆæœçš„å‰æä¸‹èŠ‚çœ Token æ˜¯ä¸€ä¸ªé‡è¦è¯¾é¢˜ã€‚</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// src-tauri/src/services/token_optimizer.rs</span>

<span class="hljs-comment">/// Token ä¼˜åŒ–å™¨</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">TokenOptimizer</span> {
    db: Database,
    cache: HashMap&lt;<span class="hljs-type">String</span>, SessionCache&gt;,
}

<span class="hljs-comment">/// Prompt åˆ†çº§ç­–ç•¥</span>
<span class="hljs-meta">#[derive(Debug, Clone)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">PromptGrade</span> {
    Full,       <span class="hljs-comment">// å®Œæ•´ç‰ˆï¼šé¦–æ¬¡è°ƒç”¨ã€å¤æ‚ä»»åŠ¡</span>
    Compact,    <span class="hljs-comment">// ç²¾ç®€ç‰ˆï¼šè¿ç»­è°ƒç”¨ã€ç®€å•ä»»åŠ¡</span>
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">TokenOptimizer</span> {
    <span class="hljs-comment">/// å†³å®šä½¿ç”¨å“ªä¸ªç‰ˆæœ¬çš„ Prompt</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">decide_prompt_grade</span>(
        &amp;<span class="hljs-keyword">self</span>,
        skill_id: &amp;<span class="hljs-type">str</span>,
        context: &amp;CallContext,
    ) <span class="hljs-punctuation">-&gt;</span> PromptGrade {
        <span class="hljs-comment">// ç­–ç•¥ 1ï¼šè¿ç»­è°ƒç”¨åŒä¸€æŠ€èƒ½ï¼Œä½¿ç”¨ç²¾ç®€ç‰ˆ</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(cache) = <span class="hljs-keyword">self</span>.cache.<span class="hljs-title function_ invoke__">get</span>(skill_id) {
            <span class="hljs-keyword">if</span> cache.<span class="hljs-title function_ invoke__">is_recent</span>() &amp;&amp; cache.call_count &gt; <span class="hljs-number">1</span> {
                <span class="hljs-keyword">return</span> PromptGrade::Compact;
            }
        }
        
        <span class="hljs-comment">// ç­–ç•¥ 2ï¼šç”¨æˆ·ä¸»åŠ¨é€‰æ‹©ç²¾ç®€æ¨¡å¼</span>
        <span class="hljs-keyword">if</span> context.prefer_compact {
            <span class="hljs-keyword">return</span> PromptGrade::Compact;
        }
        
        <span class="hljs-comment">// ç­–ç•¥ 3ï¼šç®€å•è¾“å…¥ä½¿ç”¨ç²¾ç®€ç‰ˆ</span>
        <span class="hljs-keyword">if</span> context.user_input.<span class="hljs-title function_ invoke__">len</span>() &lt; <span class="hljs-number">50</span> {
            <span class="hljs-keyword">return</span> PromptGrade::Compact;
        }
        
        PromptGrade::Full
    }
    
    <span class="hljs-comment">/// ä¼šè¯å¤ç”¨ï¼šè¿ç»­è°ƒç”¨åŒä¸€æŠ€èƒ½æ—¶å¤ç”¨ä¸Šä¸‹æ–‡</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">get_or_create_session</span>(
        &amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">self</span>,
        skill_id: &amp;<span class="hljs-type">str</span>,
        ttl_seconds: <span class="hljs-type">u64</span>,
    ) <span class="hljs-punctuation">-&gt;</span> &amp;<span class="hljs-keyword">mut</span> SessionCache {
        <span class="hljs-keyword">self</span>.cache.<span class="hljs-title function_ invoke__">entry</span>(skill_id.<span class="hljs-title function_ invoke__">to_string</span>())
            .<span class="hljs-title function_ invoke__">or_insert_with</span>(|| SessionCache::<span class="hljs-title function_ invoke__">new</span>(ttl_seconds))
    }
    
    <span class="hljs-comment">/// è®°å½• Token ä½¿ç”¨é‡</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">record_usage</span>(
        &amp;<span class="hljs-keyword">self</span>,
        skill_id: &amp;<span class="hljs-type">str</span>,
        input_tokens: <span class="hljs-type">u32</span>,
        output_tokens: <span class="hljs-type">u32</span>,
    ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;(), AppError&gt; {
        <span class="hljs-keyword">self</span>.db.<span class="hljs-title function_ invoke__">execute</span>(
            <span class="hljs-string">"INSERT INTO skill_usage_stats (skill_id, input_tokens, output_tokens, created_at)
             VALUES (?, ?, ?, ?)"</span>,
            params![skill_id, input_tokens, output_tokens, Utc::<span class="hljs-title function_ invoke__">now</span>()],
        ).<span class="hljs-keyword">await</span>?;
        <span class="hljs-title function_ invoke__">Ok</span>(())
    }
}
</code></pre>
<h3 data-id="heading-20">3.5 å·¥ä½œæµå¼•æ“</h3>
<p>å·¥ä½œæµå…è®¸ç”¨æˆ·å°†å¤šä¸ªæŠ€èƒ½/æ“ä½œä¸²è”èµ·æ¥ï¼Œå½¢æˆè‡ªåŠ¨åŒ–æµç¨‹ã€‚</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// src-tauri/src/workflow/engine.rs</span>

<span class="hljs-comment">/// å·¥ä½œæµæ‰§è¡Œå¼•æ“</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">WorkflowEngine</span> {
    skill_executor: SkillExecutor,
    http_client: HttpClient,
}

<span class="hljs-comment">/// å·¥ä½œæµèŠ‚ç‚¹ç±»å‹</span>
<span class="hljs-meta">#[derive(Debug, Clone, Serialize, Deserialize)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">WorkflowNodeType</span> {
    Start,
    End,
    Skill,          <span class="hljs-comment">// è°ƒç”¨æŠ€èƒ½</span>
    Condition,      <span class="hljs-comment">// æ¡ä»¶åˆ†æ”¯</span>
    Loop,           <span class="hljs-comment">// å¾ªç¯</span>
    SetVariable,    <span class="hljs-comment">// è®¾ç½®å˜é‡</span>
    HttpRequest,    <span class="hljs-comment">// HTTP è¯·æ±‚</span>
    Delay,          <span class="hljs-comment">// å»¶æ—¶</span>
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">WorkflowEngine</span> {
    <span class="hljs-comment">/// æ‰§è¡Œå·¥ä½œæµ</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">execute</span>(
        &amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">self</span>,
        workflow: &amp;Workflow,
        initial_input: Value,
    ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;WorkflowResult, AppError&gt; {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">context</span> = WorkflowContext::<span class="hljs-title function_ invoke__">new</span>(initial_input);
        
        <span class="hljs-comment">// æ‰¾åˆ°èµ·å§‹èŠ‚ç‚¹</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">start_node</span> = workflow.nodes.<span class="hljs-title function_ invoke__">iter</span>()
            .<span class="hljs-title function_ invoke__">find</span>(|n| n.node_type == WorkflowNodeType::Start)
            .<span class="hljs-title function_ invoke__">ok_or_else</span>(|| AppError::<span class="hljs-title function_ invoke__">Workflow</span>(<span class="hljs-string">"ç¼ºå°‘èµ·å§‹èŠ‚ç‚¹"</span>.<span class="hljs-title function_ invoke__">to_string</span>()))?;
        
        <span class="hljs-comment">// ä½¿ç”¨æ ˆè¿­ä»£æ‰§è¡Œï¼Œé¿å…é€’å½’</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">stack</span> = <span class="hljs-built_in">vec!</span>[start_node.id.<span class="hljs-title function_ invoke__">clone</span>()];
        
        <span class="hljs-keyword">while</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(node_id) = stack.<span class="hljs-title function_ invoke__">pop</span>() {
            <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">node</span> = workflow.<span class="hljs-title function_ invoke__">get_node</span>(&amp;node_id)?;
            
            <span class="hljs-comment">// æ‰§è¡ŒèŠ‚ç‚¹</span>
            <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">result</span> = <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">execute_node</span>(node, &amp;<span class="hljs-keyword">mut</span> context).<span class="hljs-keyword">await</span>?;
            
            <span class="hljs-comment">// æ ¹æ®ç»“æœå†³å®šä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span>
            <span class="hljs-keyword">match</span> node.node_type {
                WorkflowNodeType::End =&gt; <span class="hljs-keyword">break</span>,
                WorkflowNodeType::Condition =&gt; {
                    <span class="hljs-comment">// æ¡ä»¶èŠ‚ç‚¹ï¼šæ ¹æ®ç»“æœé€‰æ‹©åˆ†æ”¯</span>
                    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">next</span> = <span class="hljs-keyword">if</span> result.<span class="hljs-title function_ invoke__">as_bool</span>().<span class="hljs-title function_ invoke__">unwrap_or</span>(<span class="hljs-literal">false</span>) {
                        &amp;node.data.true_branch
                    } <span class="hljs-keyword">else</span> {
                        &amp;node.data.false_branch
                    };
                    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(next_id) = next {
                        stack.<span class="hljs-title function_ invoke__">push</span>(next_id.<span class="hljs-title function_ invoke__">clone</span>());
                    }
                }
                _ =&gt; {
                    <span class="hljs-comment">// æ™®é€šèŠ‚ç‚¹ï¼šæ‰¾åˆ°ä¸‹ä¸€ä¸ªè¿æ¥çš„èŠ‚ç‚¹</span>
                    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(edge) = workflow.edges.<span class="hljs-title function_ invoke__">iter</span>().<span class="hljs-title function_ invoke__">find</span>(|e| e.source == node_id) {
                        stack.<span class="hljs-title function_ invoke__">push</span>(edge.target.<span class="hljs-title function_ invoke__">clone</span>());
                    }
                }
            }
        }
        
        <span class="hljs-title function_ invoke__">Ok</span>(WorkflowResult {
            success: <span class="hljs-literal">true</span>,
            outputs: context.outputs,
            variables: context.variables,
        })
    }
    
    <span class="hljs-comment">/// æ‰§è¡Œå•ä¸ªèŠ‚ç‚¹</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">execute_node</span>(
        &amp;<span class="hljs-keyword">self</span>,
        node: &amp;WorkflowNode,
        context: &amp;<span class="hljs-keyword">mut</span> WorkflowContext,
    ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;Value, AppError&gt; {
        <span class="hljs-keyword">match</span> node.node_type {
            WorkflowNodeType::Skill =&gt; {
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">skill_id</span> = node.data.skill_id.<span class="hljs-title function_ invoke__">as_ref</span>()
                    .<span class="hljs-title function_ invoke__">ok_or_else</span>(|| AppError::<span class="hljs-title function_ invoke__">Workflow</span>(<span class="hljs-string">"æŠ€èƒ½èŠ‚ç‚¹ç¼ºå°‘ skill_id"</span>.<span class="hljs-title function_ invoke__">to_string</span>()))?;
                
                <span class="hljs-comment">// æ‰§è¡ŒæŠ€èƒ½å¹¶è·å–ç»“æœ</span>
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">result</span> = <span class="hljs-keyword">self</span>.skill_executor.<span class="hljs-title function_ invoke__">execute_by_id</span>(skill_id, context).<span class="hljs-keyword">await</span>?;
                
                <span class="hljs-comment">// å°†ç»“æœå­˜å…¥ä¸Šä¸‹æ–‡ï¼Œä¾›åç»­èŠ‚ç‚¹ä½¿ç”¨</span>
                context.<span class="hljs-title function_ invoke__">set_node_output</span>(&amp;node.id, result.<span class="hljs-title function_ invoke__">clone</span>());
                
                <span class="hljs-title function_ invoke__">Ok</span>(result)
            }
            WorkflowNodeType::HttpRequest =&gt; {
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">config</span> = &amp;node.data.http_config;
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">response</span> = <span class="hljs-keyword">self</span>.http_client.<span class="hljs-title function_ invoke__">request</span>(config).<span class="hljs-keyword">await</span>?;
                context.<span class="hljs-title function_ invoke__">set_node_output</span>(&amp;node.id, response.<span class="hljs-title function_ invoke__">clone</span>());
                <span class="hljs-title function_ invoke__">Ok</span>(response)
            }
            WorkflowNodeType::SetVariable =&gt; {
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">var_name</span> = &amp;node.data.variable_name;
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">value</span> = <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">resolve_value</span>(&amp;node.data.value, context)?;
                context.variables.<span class="hljs-title function_ invoke__">insert</span>(var_name.<span class="hljs-title function_ invoke__">clone</span>(), value.<span class="hljs-title function_ invoke__">clone</span>());
                <span class="hljs-title function_ invoke__">Ok</span>(value)
            }
            WorkflowNodeType::Delay =&gt; {
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">ms</span> = node.data.delay_ms.<span class="hljs-title function_ invoke__">unwrap_or</span>(<span class="hljs-number">1000</span>);
                tokio::time::<span class="hljs-title function_ invoke__">sleep</span>(Duration::<span class="hljs-title function_ invoke__">from_millis</span>(ms)).<span class="hljs-keyword">await</span>;
                <span class="hljs-title function_ invoke__">Ok</span>(json!({<span class="hljs-string">"delayed_ms"</span>: ms}))
            }
            _ =&gt; <span class="hljs-title function_ invoke__">Ok</span>(json!({})),
        }
    }
}
</code></pre>
<h3 data-id="heading-21">3.6 API Key å®‰å…¨å­˜å‚¨</h3>
<p>API Key æ˜¯æ•æ„Ÿä¿¡æ¯ï¼Œéœ€è¦åŠ å¯†å­˜å‚¨ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// src-tauri/src/services/crypto.rs</span>

<span class="hljs-keyword">use</span> aes_gcm::{Aes256Gcm, Key, Nonce};
<span class="hljs-keyword">use</span> aes_gcm::aead::{Aead, NewAead};

<span class="hljs-comment">/// åŠ å¯†æœåŠ¡</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">CryptoService</span> {
    key: Key&lt;Aes256Gcm&gt;,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">CryptoService</span> {
    <span class="hljs-comment">/// ä»è®¾å¤‡æŒ‡çº¹æ´¾ç”Ÿå¯†é’¥</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">from_device_fingerprint</span>() <span class="hljs-punctuation">-&gt;</span> <span class="hljs-keyword">Self</span> {
        <span class="hljs-comment">// ç»„åˆå¤šä¸ªè®¾å¤‡ç‰¹å¾ç”Ÿæˆå”¯ä¸€æŒ‡çº¹</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">fingerprint</span> = <span class="hljs-built_in">format!</span>(
            <span class="hljs-string">"{}-{}-{}"</span>,
            whoami::<span class="hljs-title function_ invoke__">hostname</span>(),
            whoami::<span class="hljs-title function_ invoke__">username</span>(),
            machine_uid::<span class="hljs-title function_ invoke__">get</span>().<span class="hljs-title function_ invoke__">unwrap_or_default</span>()
        );
        
        <span class="hljs-comment">// ä½¿ç”¨ PBKDF2 æ´¾ç”Ÿ 256 ä½å¯†é’¥</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">salt</span> = <span class="hljs-string">b"smart-toolbox-salt"</span>;
        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">key</span> = [<span class="hljs-number">0u8</span>; <span class="hljs-number">32</span>];
        pbkdf2::pbkdf2::&lt;Hmac&lt;Sha256&gt;&gt;(
            fingerprint.<span class="hljs-title function_ invoke__">as_bytes</span>(),
            salt,
            <span class="hljs-number">100_000</span>,
            &amp;<span class="hljs-keyword">mut</span> key,
        );
        
        <span class="hljs-keyword">Self</span> { key: Key::<span class="hljs-title function_ invoke__">from_slice</span>(&amp;key).<span class="hljs-title function_ invoke__">clone</span>() }
    }
    
    <span class="hljs-comment">/// åŠ å¯† API Key</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">encrypt</span>(&amp;<span class="hljs-keyword">self</span>, plaintext: &amp;<span class="hljs-type">str</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>, AppError&gt; {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">cipher</span> = Aes256Gcm::<span class="hljs-title function_ invoke__">new</span>(&amp;<span class="hljs-keyword">self</span>.key);
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">nonce</span> = Nonce::<span class="hljs-title function_ invoke__">from_slice</span>(<span class="hljs-string">b"unique nonce"</span>); <span class="hljs-comment">// å®é™…åº”ä½¿ç”¨éšæœº nonce</span>
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">ciphertext</span> = cipher.<span class="hljs-title function_ invoke__">encrypt</span>(nonce, plaintext.<span class="hljs-title function_ invoke__">as_bytes</span>())
            .<span class="hljs-title function_ invoke__">map_err</span>(|e| AppError::<span class="hljs-title function_ invoke__">Crypto</span>(e.<span class="hljs-title function_ invoke__">to_string</span>()))?;
        
        <span class="hljs-title function_ invoke__">Ok</span>(base64::<span class="hljs-title function_ invoke__">encode</span>(&amp;ciphertext))
    }
    
    <span class="hljs-comment">/// è§£å¯† API Key</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">decrypt</span>(&amp;<span class="hljs-keyword">self</span>, ciphertext: &amp;<span class="hljs-type">str</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>, AppError&gt; {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">cipher</span> = Aes256Gcm::<span class="hljs-title function_ invoke__">new</span>(&amp;<span class="hljs-keyword">self</span>.key);
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">nonce</span> = Nonce::<span class="hljs-title function_ invoke__">from_slice</span>(<span class="hljs-string">b"unique nonce"</span>);
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">ciphertext_bytes</span> = base64::<span class="hljs-title function_ invoke__">decode</span>(ciphertext)
            .<span class="hljs-title function_ invoke__">map_err</span>(|e| AppError::<span class="hljs-title function_ invoke__">Crypto</span>(e.<span class="hljs-title function_ invoke__">to_string</span>()))?;
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">plaintext</span> = cipher.<span class="hljs-title function_ invoke__">decrypt</span>(nonce, ciphertext_bytes.<span class="hljs-title function_ invoke__">as_ref</span>())
            .<span class="hljs-title function_ invoke__">map_err</span>(|e| AppError::<span class="hljs-title function_ invoke__">Crypto</span>(e.<span class="hljs-title function_ invoke__">to_string</span>()))?;
        
        <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from_utf8</span>(plaintext)
            .<span class="hljs-title function_ invoke__">map_err</span>(|e| AppError::<span class="hljs-title function_ invoke__">Crypto</span>(e.<span class="hljs-title function_ invoke__">to_string</span>()))
    }
}
</code></pre>
<h3 data-id="heading-22">3.7 Agent Skills å…¼å®¹å±‚è®¾è®¡</h3>
<p>ä¸ºäº†ä¸ Agent Skills ç”Ÿæ€äº’é€šï¼Œæˆ‘è®¾è®¡äº†ä¸€ä¸ªä¸“é—¨çš„å…¼å®¹å±‚ï¼Œå®ç°åŒå‘è½¬æ¢åŠŸèƒ½ã€‚</p>
<h4 data-id="heading-23">3.7.1 Agent Skills æ ¼å¼è§£æ</h4>
<p>Agent Skills ä½¿ç”¨Â <code>SKILL.md</code>Â æ–‡ä»¶å®šä¹‰æŠ€èƒ½ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">article-writer</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">æ ¹æ®ä¸»é¢˜ç”Ÿæˆé«˜è´¨é‡æ–‡ç« </span>
<span class="hljs-attr">version:</span> <span class="hljs-number">1.0</span><span class="hljs-number">.0</span>
<span class="hljs-attr">author:</span> <span class="hljs-string">Your</span> <span class="hljs-string">Name</span>
<span class="hljs-attr">tags:</span> [<span class="hljs-string">writing</span>, <span class="hljs-string">content</span>]
<span class="hljs-meta">---
</span>
<span class="hljs-comment"># Article Writer Skill</span>

<span class="hljs-comment">## Description</span>
<span class="hljs-string">This</span> <span class="hljs-string">skill</span> <span class="hljs-string">generates</span> <span class="hljs-string">high-quality</span> <span class="hljs-string">articles</span> <span class="hljs-string">based</span> <span class="hljs-string">on</span> <span class="hljs-string">a</span> <span class="hljs-string">given</span> <span class="hljs-string">topic.</span>

<span class="hljs-comment">## When to Use This Skill</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">You</span> <span class="hljs-string">need</span> <span class="hljs-string">to</span> <span class="hljs-string">write</span> <span class="hljs-string">a</span> <span class="hljs-string">blog</span> <span class="hljs-string">post</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">You</span> <span class="hljs-string">want</span> <span class="hljs-string">to</span> <span class="hljs-string">create</span> <span class="hljs-string">content</span> <span class="hljs-string">for</span> <span class="hljs-string">social</span> <span class="hljs-string">media</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">You</span> <span class="hljs-string">need</span> <span class="hljs-string">to</span> <span class="hljs-string">draft</span> <span class="hljs-string">an</span> <span class="hljs-string">article</span> <span class="hljs-string">quickly</span>

<span class="hljs-comment">## How to Use</span>
<span class="hljs-string">Simply</span> <span class="hljs-string">provide</span> <span class="hljs-string">a</span> <span class="hljs-string">topic</span> <span class="hljs-string">and</span> <span class="hljs-string">optionally</span> <span class="hljs-string">specify</span> <span class="hljs-string">the</span> <span class="hljs-string">style</span> <span class="hljs-string">and</span> <span class="hljs-string">length.</span>

<span class="hljs-comment">## Examples</span>

<span class="hljs-comment">### Example 1: Tech Article</span>
<span class="hljs-string">**Input**:</span> <span class="hljs-string">"Write a 1500-word technical article about Rust"</span>
<span class="hljs-string">**Output**:</span> [<span class="hljs-string">Generated</span> <span class="hljs-string">article</span> <span class="hljs-string">content</span>]
</code></pre>
<h4 data-id="heading-24">3.7.2 å¯¼å…¥è½¬æ¢å®ç°</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// src-tauri/src/commands/agent_skills.rs</span>

<span class="hljs-keyword">use</span> std::path::Path;
<span class="hljs-keyword">use</span> serde_yaml::Value;
<span class="hljs-keyword">use</span> regex::Regex;

<span class="hljs-comment">/// Agent Skills å‰ç½®å…ƒæ•°æ®</span>
<span class="hljs-meta">#[derive(Debug, Deserialize)]</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">AgentSkillFrontmatter</span> {
    name: <span class="hljs-type">String</span>,
    description: <span class="hljs-type">String</span>,
    <span class="hljs-meta">#[serde(default)]</span>
    version: <span class="hljs-type">String</span>,
    <span class="hljs-meta">#[serde(default)]</span>
    author: <span class="hljs-type">String</span>,
    <span class="hljs-meta">#[serde(default)]</span>
    tags: <span class="hljs-type">Vec</span>&lt;<span class="hljs-type">String</span>&gt;,
}

<span class="hljs-comment">/// è§£æ SKILL.md æ–‡ä»¶</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">parse_skill_md</span>(path: &amp;Path) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;Skill, AppError&gt; {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">content</span> = std::fs::<span class="hljs-title function_ invoke__">read_to_string</span>(path)?;
    
    <span class="hljs-comment">// æå– YAML frontmatter</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">frontmatter_re</span> = Regex::<span class="hljs-title function_ invoke__">new</span>(<span class="hljs-string">r"^---\n(.*?)\n---"</span>).<span class="hljs-title function_ invoke__">unwrap</span>();
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">caps</span> = frontmatter_re.<span class="hljs-title function_ invoke__">captures</span>(&amp;content)
        .<span class="hljs-title function_ invoke__">ok_or_else</span>(|| AppError::<span class="hljs-title function_ invoke__">Parse</span>(<span class="hljs-string">"ç¼ºå°‘ YAML frontmatter"</span>.<span class="hljs-title function_ invoke__">to_string</span>()))?;
    
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">yaml_str</span> = &amp;caps[<span class="hljs-number">1</span>];
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">frontmatter</span>: AgentSkillFrontmatter = serde_yaml::<span class="hljs-title function_ invoke__">from_str</span>(yaml_str)
        .<span class="hljs-title function_ invoke__">map_err</span>(|e| AppError::<span class="hljs-title function_ invoke__">Parse</span>(<span class="hljs-built_in">format!</span>(<span class="hljs-string">"YAML è§£æå¤±è´¥: {}"</span>, e)))?;
    
    <span class="hljs-comment">// æå– Markdown æ­£æ–‡</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">markdown_body</span> = frontmatter_re.<span class="hljs-title function_ invoke__">replace</span>(&amp;content, <span class="hljs-string">""</span>).<span class="hljs-title function_ invoke__">to_string</span>();
    
    <span class="hljs-comment">// åˆ¤æ–­æŠ€èƒ½ç±»å‹</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">skill_dir</span> = path.<span class="hljs-title function_ invoke__">parent</span>().<span class="hljs-title function_ invoke__">unwrap</span>();
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">scripts_dir</span> = skill_dir.<span class="hljs-title function_ invoke__">join</span>(<span class="hljs-string">"scripts"</span>);
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">skill_type</span> = <span class="hljs-keyword">if</span> scripts_dir.<span class="hljs-title function_ invoke__">exists</span>() {
        SkillType::Script
    } <span class="hljs-keyword">else</span> {
        SkillType::Prompt
    };
    
    <span class="hljs-comment">// è½¬æ¢ä¸ºå†…éƒ¨ Skill æ ¼å¼</span>
    <span class="hljs-title function_ invoke__">Ok</span>(Skill {
        id: <span class="hljs-built_in">format!</span>(<span class="hljs-string">"agent-skills-{}"</span>, frontmatter.name),
        name: frontmatter.name.<span class="hljs-title function_ invoke__">clone</span>(),
        display_name: frontmatter.name,
        description: frontmatter.description,
        skill_type,
        category: <span class="hljs-title function_ invoke__">infer_category</span>(&amp;frontmatter.tags),
        triggers: <span class="hljs-title function_ invoke__">extract_triggers</span>(&amp;markdown_body),
        icon: <span class="hljs-string">"ğŸ“¦"</span>.<span class="hljs-title function_ invoke__">to_string</span>(),
        enabled: <span class="hljs-literal">true</span>,
        prompt_config: <span class="hljs-keyword">if</span> skill_type == SkillType::Prompt {
            <span class="hljs-title function_ invoke__">Some</span>(PromptConfig {
                system: markdown_body.<span class="hljs-title function_ invoke__">clone</span>(),
                system_compact: <span class="hljs-title function_ invoke__">compact_prompt</span>(&amp;markdown_body),
                variables: <span class="hljs-title function_ invoke__">extract_variables</span>(&amp;markdown_body),
                output_format: <span class="hljs-literal">None</span>,
            })
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-literal">None</span>
        },
        script_config: <span class="hljs-keyword">if</span> skill_type == SkillType::Script {
            <span class="hljs-title function_ invoke__">Some</span>(ScriptConfig {
                language: <span class="hljs-title function_ invoke__">detect_script_language</span>(&amp;scripts_dir)?,
                code: <span class="hljs-title function_ invoke__">load_script_code</span>(&amp;scripts_dir)?,
            })
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-literal">None</span>
        },
        workflow_config: <span class="hljs-literal">None</span>,
    })
}

<span class="hljs-comment">/// ä»ç›®å½•å¯¼å…¥æ‰€æœ‰ Agent Skills</span>
<span class="hljs-meta">#[tauri::command]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">import_agent_skills</span>() <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">Vec</span>&lt;Skill&gt;, AppError&gt; {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">skills_dir</span> = Path::<span class="hljs-title function_ invoke__">new</span>(<span class="hljs-string">".claude/skills"</span>);
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">skills</span> = <span class="hljs-type">Vec</span>::<span class="hljs-title function_ invoke__">new</span>();
    
    <span class="hljs-keyword">if</span> !skills_dir.<span class="hljs-title function_ invoke__">exists</span>() {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">Ok</span>(skills);
    }
    
    <span class="hljs-keyword">for</span> <span class="hljs-variable">entry</span> <span class="hljs-keyword">in</span> std::fs::<span class="hljs-title function_ invoke__">read_dir</span>(skills_dir)? {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">entry</span> = entry?;
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">skill_md</span> = entry.<span class="hljs-title function_ invoke__">path</span>().<span class="hljs-title function_ invoke__">join</span>(<span class="hljs-string">"SKILL.md"</span>);
        
        <span class="hljs-keyword">if</span> skill_md.<span class="hljs-title function_ invoke__">exists</span>() {
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Ok</span>(skill) = <span class="hljs-title function_ invoke__">parse_skill_md</span>(&amp;skill_md) {
                skills.<span class="hljs-title function_ invoke__">push</span>(skill);
            }
        }
    }
    
    <span class="hljs-title function_ invoke__">Ok</span>(skills)
}
</code></pre>
<h4 data-id="heading-25">3.7.3 å¯¼å‡ºè½¬æ¢å®ç°</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">/// å°†å†…éƒ¨ Skill å¯¼å‡ºä¸º Agent Skills æ ¼å¼</span>
<span class="hljs-meta">#[tauri::command]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">export_to_agent_skills</span>(skill: &amp;Skill) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>, AppError&gt; {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">frontmatter</span> = <span class="hljs-built_in">format!</span>(
        <span class="hljs-string">r#"---
name: {}
description: {}
version: {}
author: {}
tags: [{}]
---
"#</span>,
        skill.name,
        skill.description,
        <span class="hljs-string">"1.0.0"</span>,
        <span class="hljs-string">"Smart Toolbox"</span>,
        skill.category.<span class="hljs-title function_ invoke__">to_lowercase</span>()
    );
    
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">content</span> = frontmatter;
    
    <span class="hljs-comment">// æ·»åŠ æŠ€èƒ½æè¿°</span>
    content.<span class="hljs-title function_ invoke__">push_str</span>(&amp;<span class="hljs-built_in">format!</span>(<span class="hljs-string">"# {}\n\n"</span>, skill.display_name));
    content.<span class="hljs-title function_ invoke__">push_str</span>(&amp;<span class="hljs-built_in">format!</span>(<span class="hljs-string">"## Description\n{}\n\n"</span>, skill.description));
    
    <span class="hljs-comment">// æ·»åŠ è§¦å‘è¯</span>
    <span class="hljs-keyword">if</span> !skill.triggers.<span class="hljs-title function_ invoke__">is_empty</span>() {
        content.<span class="hljs-title function_ invoke__">push_str</span>(<span class="hljs-string">"## Triggers\n"</span>);
        <span class="hljs-keyword">for</span> <span class="hljs-variable">trigger</span> <span class="hljs-keyword">in</span> &amp;skill.triggers {
            content.<span class="hljs-title function_ invoke__">push_str</span>(&amp;<span class="hljs-built_in">format!</span>(<span class="hljs-string">"- {}\n"</span>, trigger));
        }
        content.<span class="hljs-title function_ invoke__">push_str</span>(<span class="hljs-string">"\n"</span>);
    }
    
    <span class="hljs-comment">// æ·»åŠ ä½¿ç”¨è¯´æ˜</span>
    content.<span class="hljs-title function_ invoke__">push_str</span>(<span class="hljs-string">"## How to Use\n"</span>);
    content.<span class="hljs-title function_ invoke__">push_str</span>(<span class="hljs-string">"This skill can be triggered by the keywords listed above.\n\n"</span>);
    
    <span class="hljs-comment">// æ·»åŠ  Prompt å†…å®¹</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(config) = &amp;skill.prompt_config {
        content.<span class="hljs-title function_ invoke__">push_str</span>(<span class="hljs-string">"## System Prompt\n\n"</span>);
        content.<span class="hljs-title function_ invoke__">push_str</span>(&amp;config.system);
    }
    
    <span class="hljs-title function_ invoke__">Ok</span>(content)
}

<span class="hljs-comment">/// å¯¼å‡ºæŠ€èƒ½åˆ°æ–‡ä»¶ç³»ç»Ÿ</span>
<span class="hljs-meta">#[tauri::command]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">export_skill_to_file</span>(skill: &amp;Skill, output_dir: <span class="hljs-type">String</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>, AppError&gt; {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">skill_dir</span> = Path::<span class="hljs-title function_ invoke__">new</span>(&amp;output_dir).<span class="hljs-title function_ invoke__">join</span>(&amp;skill.name);
    std::fs::<span class="hljs-title function_ invoke__">create_dir_all</span>(&amp;skill_dir)?;
    
    <span class="hljs-comment">// å†™å…¥ SKILL.md</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">skill_md</span> = <span class="hljs-title function_ invoke__">export_to_agent_skills</span>(skill).<span class="hljs-keyword">await</span>?;
    std::fs::<span class="hljs-title function_ invoke__">write</span>(skill_dir.<span class="hljs-title function_ invoke__">join</span>(<span class="hljs-string">"SKILL.md"</span>), skill_md)?;
    
    <span class="hljs-comment">// å¦‚æœæ˜¯ Script ç±»å‹ï¼Œå¤åˆ¶è„šæœ¬æ–‡ä»¶</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(config) = &amp;skill.script_config {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">scripts_dir</span> = skill_dir.<span class="hljs-title function_ invoke__">join</span>(<span class="hljs-string">"scripts"</span>);
        std::fs::<span class="hljs-title function_ invoke__">create_dir_all</span>(&amp;scripts_dir)?;
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">script_file</span> = <span class="hljs-keyword">match</span> config.language.<span class="hljs-title function_ invoke__">as_str</span>() {
            <span class="hljs-string">"python"</span> =&gt; <span class="hljs-string">"main.py"</span>,
            <span class="hljs-string">"javascript"</span> =&gt; <span class="hljs-string">"main.js"</span>,
            <span class="hljs-string">"typescript"</span> =&gt; <span class="hljs-string">"main.ts"</span>,
            _ =&gt; <span class="hljs-string">"script.txt"</span>,
        };
        
        std::fs::<span class="hljs-title function_ invoke__">write</span>(scripts_dir.<span class="hljs-title function_ invoke__">join</span>(script_file), &amp;config.code)?;
    }
    
    <span class="hljs-title function_ invoke__">Ok</span>(skill_dir.<span class="hljs-title function_ invoke__">to_string_lossy</span>().<span class="hljs-title function_ invoke__">to_string</span>())
}
</code></pre>
<h4 data-id="heading-26">3.7.4 æ™ºèƒ½æ¨æ–­ä¸å¢å¼º</h4>
<p>åœ¨è½¬æ¢è¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿä¼šè¿›è¡Œæ™ºèƒ½æ¨æ–­å’ŒåŠŸèƒ½å¢å¼ºï¼š</p>
<pre><code class="hljs language-python" lang="python">/// ä»æ ‡ç­¾æ¨æ–­æŠ€èƒ½åˆ†ç±»
fn infer_category(tags: &amp;[String]) -&gt; SkillCategory {
    let tag_str = tags.join(<span class="hljs-string">" "</span>).to_lowercase();
    
    <span class="hljs-keyword">if</span> tag_str.contains(<span class="hljs-string">"writing"</span>) || tag_str.contains(<span class="hljs-string">"content"</span>) {
        SkillCategory::Content
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> tag_str.contains(<span class="hljs-string">"code"</span>) || tag_str.contains(<span class="hljs-string">"dev"</span>) {
        SkillCategory::Development
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> tag_str.contains(<span class="hljs-string">"data"</span>) || tag_str.contains(<span class="hljs-string">"analysis"</span>) {
        SkillCategory::Data
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> tag_str.contains(<span class="hljs-string">"publish"</span>) || tag_str.contains(<span class="hljs-string">"social"</span>) {
        SkillCategory::Publish
    } <span class="hljs-keyword">else</span> {
        SkillCategory::General
    }
}

/// ä» Markdown å†…å®¹ä¸­æå–è§¦å‘è¯
fn extract_triggers(content: &amp;<span class="hljs-built_in">str</span>) -&gt; Vec&lt;String&gt; {
    let mut triggers = Vec::new();
    
    // æå–æ ‡é¢˜ä¸­çš„å…³é”®è¯
    let title_re = Regex::new(<span class="hljs-string">r"^#+\s*(.+)$"</span>).unwrap();
    <span class="hljs-keyword">for</span> caps <span class="hljs-keyword">in</span> title_re.captures_iter(content) {
        let title = &amp;caps[<span class="hljs-number">1</span>];
        <span class="hljs-keyword">if</span> title.<span class="hljs-built_in">len</span>() &lt; <span class="hljs-number">20</span> {
            triggers.push(title.to_string());
        }
    }
    
    // æå–åˆ—è¡¨é¡¹ä¸­çš„å…³é”®è¯
    let list_re = Regex::new(<span class="hljs-string">r"^\s*[-*]\s*(.+)$"</span>).unwrap();
    <span class="hljs-keyword">for</span> caps <span class="hljs-keyword">in</span> list_re.captures_iter(content) {
        let item = &amp;caps[<span class="hljs-number">1</span>];
        <span class="hljs-keyword">if</span> item.<span class="hljs-built_in">len</span>() &lt; <span class="hljs-number">30</span> {
            triggers.push(item.to_string());
        }
    }
    
    triggers.dedup();
    triggers
}

/// ç”Ÿæˆç²¾ç®€ç‰ˆ Promptï¼ˆToken ä¼˜åŒ–ï¼‰
fn compact_prompt(full_prompt: &amp;<span class="hljs-built_in">str</span>) -&gt; String {
    // ç§»é™¤å¤šä½™çš„ç©ºè¡Œ
    let compressed = Regex::new(<span class="hljs-string">r"\n{3,}"</span>)
        .unwrap()
        .replace_all(full_prompt, <span class="hljs-string">"\n\n"</span>);
    
    // ç§»é™¤æ³¨é‡Š
    let without_comments = Regex::new(<span class="hljs-string">r"&lt;!--.*?--&gt;"</span>)
        .unwrap()
        .replace_all(&amp;compressed, <span class="hljs-string">""</span>);
    
    without_comments.to_string()
}
</code></pre>
<h4 data-id="heading-27">3.7.5 ä½¿ç”¨ç¤ºä¾‹</h4>
<p><strong>å¯¼å…¥ Agent Skills</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å‰ç«¯è°ƒç”¨</span>
<span class="hljs-keyword">const</span> skills = <span class="hljs-keyword">await</span> invoke&lt;<span class="hljs-title class_">Skill</span>[]&gt;(<span class="hljs-string">'import_agent_skills'</span>);

<span class="hljs-comment">// æ˜¾ç¤ºå¯¼å…¥çš„æŠ€èƒ½</span>
skills.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">skill</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å¯¼å…¥æŠ€èƒ½: <span class="hljs-subst">${skill.display_name}</span>`</span>);
});
</code></pre>
<p><strong>å¯¼å‡ºä¸º Agent Skills</strong>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å¯¼å‡ºå•ä¸ªæŠ€èƒ½</span>
<span class="hljs-keyword">const</span> outputPath = <span class="hljs-keyword">await</span> invoke&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">'export_skill_to_file'</span>, {
  <span class="hljs-attr">skill</span>: selectedSkill,
  <span class="hljs-attr">outputDir</span>: <span class="hljs-string">'/path/to/.claude/skills'</span>
});

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æŠ€èƒ½å·²å¯¼å‡ºåˆ°: <span class="hljs-subst">${outputPath}</span>`</span>);
</code></pre>
<p><strong>è®¾è®¡äº®ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>æ— æŸè½¬æ¢</strong>ï¼šä¿ç•™åŸå§‹æŠ€èƒ½çš„æ‰€æœ‰ä¿¡æ¯ï¼ŒåŒ…æ‹¬æè¿°ã€ç¤ºä¾‹ã€å‚è€ƒæ–‡æ¡£</li>
<li><strong>æ™ºèƒ½æ¨æ–­</strong>ï¼šè‡ªåŠ¨æ¨æ–­æŠ€èƒ½åˆ†ç±»ã€è§¦å‘è¯ã€å˜é‡å®šä¹‰</li>
<li><strong>åŠŸèƒ½å¢å¼º</strong>ï¼šå¯¼å…¥çš„æŠ€èƒ½è‡ªåŠ¨è·å¾— Token ä¼˜åŒ–ã€å·¥ä½œæµç¼–æ’ç­‰é«˜çº§åŠŸèƒ½</li>
<li><strong>ç”Ÿæ€äº’é€š</strong>ï¼šç”¨æˆ·å¯ä»¥åœ¨ Claude Codeã€Cursor ç­‰å·¥å…·ä¸­ä½¿ç”¨æ™ºèƒ½å·¥å…·ç®±çš„æŠ€èƒ½</li>
</ol>
<h2 data-id="heading-28">å››ã€å‰ç«¯æ¶æ„è®¾è®¡</h2>
<h3 data-id="heading-29">4.1 çŠ¶æ€ç®¡ç†ï¼šZustand</h3>
<p>é€‰æ‹© Zustand è€Œé Redux çš„åŸå› ï¼š</p>
<ul>
<li>æ›´ç®€æ´çš„ APIï¼Œå­¦ä¹ æˆæœ¬ä½</li>
<li>å†…ç½®æ”¯æŒæŒä¹…åŒ–ã€ä¸­é—´ä»¶</li>
<li>ä¸ React 18 çš„ Concurrent Mode å…¼å®¹æ€§å¥½</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/stores/chatStore.ts</span>

<span class="hljs-keyword">import</span> { create } <span class="hljs-keyword">from</span> <span class="hljs-string">'zustand'</span>;
<span class="hljs-keyword">import</span> { invoke } <span class="hljs-keyword">from</span> <span class="hljs-string">'@tauri-apps/api/core'</span>;

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Message</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span> | <span class="hljs-string">'assistant'</span>;
  <span class="hljs-attr">content</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">number</span>;
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ChatState</span> {
  <span class="hljs-attr">messages</span>: <span class="hljs-title class_">Message</span>[];
  <span class="hljs-attr">isLoading</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-attr">currentConversationId</span>: <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span>;
  
  <span class="hljs-comment">// Actions</span>
  <span class="hljs-attr">sendMessage</span>: <span class="hljs-function">(<span class="hljs-params">content: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt;;
  <span class="hljs-attr">clearMessages</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;
  <span class="hljs-attr">loadConversation</span>: <span class="hljs-function">(<span class="hljs-params">id: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt;;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useChatStore = create&lt;<span class="hljs-title class_">ChatState</span>&gt;(<span class="hljs-function">(<span class="hljs-params">set, get</span>) =&gt;</span> ({
  <span class="hljs-attr">messages</span>: [],
  <span class="hljs-attr">isLoading</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">currentConversationId</span>: <span class="hljs-literal">null</span>,
  
  <span class="hljs-attr">sendMessage</span>: <span class="hljs-keyword">async</span> (<span class="hljs-attr">content</span>: <span class="hljs-built_in">string</span>) =&gt; {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">userMessage</span>: <span class="hljs-title class_">Message</span> = {
      <span class="hljs-attr">id</span>: crypto.<span class="hljs-title function_">randomUUID</span>(),
      <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span>,
      content,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
    };
    
    <span class="hljs-title function_">set</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> ({
      <span class="hljs-attr">messages</span>: [...state.<span class="hljs-property">messages</span>, userMessage],
      <span class="hljs-attr">isLoading</span>: <span class="hljs-literal">true</span>,
    }));
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// è°ƒç”¨ Tauri åç«¯</span>
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> invoke&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">'send_message'</span>, {
        <span class="hljs-attr">conversationId</span>: <span class="hljs-title function_">get</span>().<span class="hljs-property">currentConversationId</span>,
        content,
      });
      
      <span class="hljs-keyword">const</span> <span class="hljs-attr">assistantMessage</span>: <span class="hljs-title class_">Message</span> = {
        <span class="hljs-attr">id</span>: crypto.<span class="hljs-title function_">randomUUID</span>(),
        <span class="hljs-attr">role</span>: <span class="hljs-string">'assistant'</span>,
        <span class="hljs-attr">content</span>: response,
        <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
      };
      
      <span class="hljs-title function_">set</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> ({
        <span class="hljs-attr">messages</span>: [...state.<span class="hljs-property">messages</span>, assistantMessage],
        <span class="hljs-attr">isLoading</span>: <span class="hljs-literal">false</span>,
      }));
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å‘é€å¤±è´¥:'</span>, error);
      <span class="hljs-title function_">set</span>({ <span class="hljs-attr">isLoading</span>: <span class="hljs-literal">false</span> });
    }
  },
  
  <span class="hljs-attr">clearMessages</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">set</span>({ <span class="hljs-attr">messages</span>: [] }),
  
  <span class="hljs-attr">loadConversation</span>: <span class="hljs-keyword">async</span> (<span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>) =&gt; {
    <span class="hljs-keyword">const</span> history = <span class="hljs-keyword">await</span> invoke&lt;<span class="hljs-title class_">Message</span>[]&gt;(<span class="hljs-string">'get_history'</span>, { id });
    <span class="hljs-title function_">set</span>({
      <span class="hljs-attr">currentConversationId</span>: id,
      <span class="hljs-attr">messages</span>: history,
    });
  },
}));
</code></pre>
<h3 data-id="heading-30">4.2 æŠ€èƒ½ç”Ÿæˆå‘å¯¼ UI</h3>
<p>è¿™æ˜¯ä¸€ä¸ªå¤æ‚çš„å¤šæ­¥éª¤è¡¨å•ï¼Œä½¿ç”¨Â <strong>State Machine (çŠ¶æ€æœº)</strong> Â æ€æƒ³ç®¡ç† UI çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// src/components/wizard/SkillWizardDialog.tsx

type <span class="hljs-attr">WizardStage</span> =
  | 'idle'          // åˆå§‹çŠ¶æ€
  | 'parsing'       // è§£æéœ€æ±‚
  | 'collecting'    // æ”¶é›†ä¿¡æ¯ï¼ˆå¤šè½®å¯¹è¯ï¼‰
  | 'generating'    // ç”Ÿæˆ DSL
  | 'preview'       // é¢„è§ˆç¡®è®¤
  | 'saving'<span class="hljs-comment">;       // ä¿å­˜ä¸­</span>

const SkillWizardDialog: React.FC&lt;Props&gt; = ({ open, onOpenChange }) =&gt; {
  const <span class="hljs-section">[stage, setStage]</span> = useState&lt;WizardStage&gt;('idle')<span class="hljs-comment">;</span>
  const <span class="hljs-section">[messages, setMessages]</span> = useState&lt;ChatMessage<span class="hljs-section">[]</span>&gt;(<span class="hljs-section">[]</span>)<span class="hljs-comment">;</span>
  const <span class="hljs-section">[generatedSkill, setGeneratedSkill]</span> = useState&lt;Skill | null&gt;(null)<span class="hljs-comment">;</span>
  
  const <span class="hljs-attr">handleStart</span> = async (description: string) =&gt; {
    setStage('parsing')<span class="hljs-comment">;</span>
    
    try {
      // å¼€å§‹è§£æéœ€æ±‚
      const <span class="hljs-attr">result</span> = await invoke&lt;WizardResult&gt;(<span class="hljs-string">'start_skill_wizard'</span>, {
        description,
      })<span class="hljs-comment">;</span>
      
      if (result.needs_more_info) {
        setMessages(result.messages)<span class="hljs-comment">;</span>
        setStage('collecting')<span class="hljs-comment">;</span>
      } else {
        setGeneratedSkill(result.skill)<span class="hljs-comment">;</span>
        setStage('preview')<span class="hljs-comment">;</span>
      }
    } catch (error) {
      console.error('è§£æå¤±è´¥:', error)<span class="hljs-comment">;</span>
      setStage('idle')<span class="hljs-comment">;</span>
    }
  }<span class="hljs-comment">;</span>
  
  const <span class="hljs-attr">handleReply</span> = async (reply: string) =&gt; {
    const <span class="hljs-attr">newMessage</span> = { role: <span class="hljs-string">'user'</span>, content: reply }<span class="hljs-comment">;</span>
    setMessages(<span class="hljs-section">[...messages, newMessage]</span>)<span class="hljs-comment">;</span>
    
    const <span class="hljs-attr">result</span> = await invoke&lt;WizardResult&gt;(<span class="hljs-string">'continue_skill_wizard'</span>, {
      reply,
    })<span class="hljs-comment">;</span>
    
    if (result.completed) {
      setGeneratedSkill(result.skill)<span class="hljs-comment">;</span>
      setStage('preview')<span class="hljs-comment">;</span>
    } else {
      setMessages(<span class="hljs-section">[...messages, newMessage, result.next_question]</span>)<span class="hljs-comment">;</span>
    }
  }<span class="hljs-comment">;</span>
  
  const <span class="hljs-attr">handleSave</span> = async () =&gt; {
    if (!generatedSkill) return<span class="hljs-comment">;</span>
    
    setStage('saving')<span class="hljs-comment">;</span>
    await invoke('save_skill', { skill: generatedSkill })<span class="hljs-comment">;</span>
    onOpenChange(false)<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>
  
  // æ¸²æŸ“ä¸åŒé˜¶æ®µçš„å†…å®¹
  const <span class="hljs-attr">renderContent</span> = () =&gt; {
    switch (stage) {
      case 'idle':
        return (
          &lt;div <span class="hljs-attr">className</span>=<span class="hljs-string">"space-y-4"</span>&gt;
            &lt;p <span class="hljs-attr">className</span>=<span class="hljs-string">"text-muted-foreground"</span>&gt;
              æè¿°ä½ æƒ³è¦åˆ›å»ºçš„æŠ€èƒ½ï¼Œæˆ‘ä¼šå¸®ä½ ç”Ÿæˆé…ç½®
            &lt;/p&gt;
            &lt;textarea
              <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"ä¾‹å¦‚ï¼šå¸®æˆ‘å†™ä¸€ä¸ªå¯ä»¥ç”Ÿæˆå‘¨æŠ¥çš„æŠ€èƒ½..."</span>
              <span class="hljs-attr">className</span>=<span class="hljs-string">"w-full h-32 p-3 border rounded-lg"</span>
              <span class="hljs-attr">onKeyDown</span>={(e) =&gt; {
                if (<span class="hljs-attr">e.key</span> === <span class="hljs-string">'Enter'</span> &amp;&amp; e.metaKey) {
                  handleStart(e.currentTarget.value)<span class="hljs-comment">;</span>
                }
              }}
            /&gt;
          &lt;/div&gt;
        )<span class="hljs-comment">;</span>
      
      case 'parsing':
      case 'generating':
        return (
          &lt;div <span class="hljs-attr">className</span>=<span class="hljs-string">"flex items-center justify-center py-8"</span>&gt;
            &lt;Loader2 <span class="hljs-attr">className</span>=<span class="hljs-string">"h-8 w-8 animate-spin"</span> /&gt;
            &lt;span <span class="hljs-attr">className</span>=<span class="hljs-string">"ml-2"</span>&gt;
              {<span class="hljs-attr">stage</span> === <span class="hljs-string">'parsing'</span> ? <span class="hljs-string">'æ­£åœ¨è§£æéœ€æ±‚...'</span> : <span class="hljs-string">'æ­£åœ¨ç”ŸæˆæŠ€èƒ½...'</span>}
            &lt;/span&gt;
          &lt;/div&gt;
        )<span class="hljs-comment">;</span>
      
      case 'collecting':
        return (
          &lt;div <span class="hljs-attr">className</span>=<span class="hljs-string">"space-y-4"</span>&gt;
            {messages.map((msg, i) =&gt; (
              &lt;div <span class="hljs-attr">key</span>={i} className={`p-<span class="hljs-number">3</span> rounded-lg ${
                <span class="hljs-attr">msg.role</span> === <span class="hljs-string">'assistant'</span> ? <span class="hljs-string">'bg-muted'</span> : <span class="hljs-string">'bg-primary/10'</span>
              }`}&gt;
                {msg.content}
              &lt;/div&gt;
            ))}
            &lt;input
              <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
              <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¾“å…¥å›å¤..."</span>
              <span class="hljs-attr">className</span>=<span class="hljs-string">"w-full p-3 border rounded-lg"</span>
              <span class="hljs-attr">onKeyDown</span>={(e) =&gt; {
                if (<span class="hljs-attr">e.key</span> === <span class="hljs-string">'Enter'</span>) {
                  handleReply(e.currentTarget.value)<span class="hljs-comment">;</span>
                  <span class="hljs-attr">e.currentTarget.value</span> = <span class="hljs-string">''</span><span class="hljs-comment">;</span>
                }
              }}
            /&gt;
          &lt;/div&gt;
        )<span class="hljs-comment">;</span>
      
      case 'preview':
        return (
          &lt;div <span class="hljs-attr">className</span>=<span class="hljs-string">"space-y-4"</span>&gt;
            &lt;SkillPreviewCard <span class="hljs-attr">skill</span>={generatedSkill!} /&gt;
            &lt;div <span class="hljs-attr">className</span>=<span class="hljs-string">"flex gap-2 justify-end"</span>&gt;
              &lt;Button <span class="hljs-attr">variant</span>=<span class="hljs-string">"outline"</span> <span class="hljs-literal">on</span>Click={() =&gt; setStage(<span class="hljs-string">'idle'</span>)}&gt;
                é‡æ–°ç”Ÿæˆ
              &lt;/Button&gt;
              &lt;Button <span class="hljs-attr">onClick</span>={handleSave}&gt;
                ä¿å­˜æŠ€èƒ½
              &lt;/Button&gt;
            &lt;/div&gt;
          &lt;/div&gt;
        )<span class="hljs-comment">;</span>
      
      default:
        return null<span class="hljs-comment">;</span>
    }
  }<span class="hljs-comment">;</span>
  
  return (
    &lt;Dialog <span class="hljs-attr">open</span>={open} <span class="hljs-literal">on</span>OpenChange={<span class="hljs-literal">on</span>OpenChange}&gt;
      &lt;DialogContent <span class="hljs-attr">className</span>=<span class="hljs-string">"sm:max-w-[600px]"</span>&gt;
        &lt;DialogHeader&gt;
          &lt;DialogTitle&gt;âœ¨ åˆ›å»ºæ–°æŠ€èƒ½&lt;/DialogTitle&gt;
        &lt;/DialogHeader&gt;
        &lt;div <span class="hljs-attr">className</span>=<span class="hljs-string">"py-4"</span>&gt;
          {renderContent()}
        &lt;/div&gt;
      &lt;/DialogContent&gt;
    &lt;/Dialog&gt;
  )<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<h2 data-id="heading-31">äº”ã€æ€§èƒ½ä¼˜åŒ–ä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-32">5.1 å¯åŠ¨é€Ÿåº¦ä¼˜åŒ–</h3>
<ol>
<li>
<p><strong>Lazy Loading (æ‡’åŠ è½½)</strong> ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½¿ç”¨ React.lazy åŠ¨æ€åŠ è½½éé¦–å±è·¯ç”±</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">SkillsPage</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./pages/SkillsPage'</span>));
<span class="hljs-keyword">const</span> <span class="hljs-title class_">WorkflowPage</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./pages/WorkflowPage'</span>));
<span class="hljs-keyword">const</span> <span class="hljs-title class_">SettingsPage</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./pages/SettingsPage'</span>));

<span class="hljs-comment">// åœ¨è·¯ç”±ä¸­ä½¿ç”¨ Suspense åŒ…è£¹</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">LoadingSpinner</span> /&gt;</span>}&gt;
  <span class="hljs-tag">&lt;<span class="hljs-name">Routes</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/skills"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">SkillsPage</span> /&gt;</span>} /&gt;
  <span class="hljs-tag">&lt;/<span class="hljs-name">Routes</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span></span>
</code></pre>
</li>
<li>
<p><strong>æ•°æ®åº“é¢„çƒ­</strong>ï¼š</p>
<ul>
<li>åœ¨ splash screen æ˜¾ç¤ºæœŸé—´åˆå§‹åŒ– SQLite è¿æ¥æ± </li>
<li>é¢„åŠ è½½å¸¸ç”¨é…ç½®æ•°æ®åˆ°å†…å­˜ç¼“å­˜</li>
</ul>
</li>
<li>
<p><strong>Rust ç¼–è¯‘ä¼˜åŒ–</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># Cargo.toml</span>
<span class="hljs-section">[profile.release]</span>
<span class="hljs-attr">lto</span> = <span class="hljs-literal">true</span>        <span class="hljs-comment"># Link Time Optimization</span>
<span class="hljs-attr">codegen-units</span> = <span class="hljs-number">1</span> <span class="hljs-comment"># å•ä»£ç ç”Ÿæˆå•å…ƒï¼Œæ›´å¥½ä¼˜åŒ–</span>
<span class="hljs-attr">strip</span> = <span class="hljs-literal">true</span>      <span class="hljs-comment"># å»é™¤è°ƒè¯•ç¬¦å·</span>
</code></pre>
</li>
</ol>
<h3 data-id="heading-33">5.2 å†…å­˜å ç”¨ä¼˜åŒ–</h3>
<ol>
<li>
<p><strong>Rust ä¾§</strong>ï¼š</p>
<ul>
<li>é¿å…åœ¨å†…å­˜ä¸­ç¼“å­˜å¤§æ–‡ä»¶å†…å®¹</li>
<li>ä½¿ç”¨æµå¼å¤„ç† (Stream) æ›¿ä»£ä¸€æ¬¡æ€§åŠ è½½</li>
<li>åŠæ—¶é‡Šæ”¾ä¸å†ä½¿ç”¨çš„ LLM ä¸Šä¸‹æ–‡</li>
</ul>
</li>
<li>
<p><strong>Webview ä¾§</strong>ï¼š</p>
<ul>
<li>è™šæ‹Ÿåˆ—è¡¨ (Virtual List) æ¸²æŸ“é•¿å¯¹è¯å†å²</li>
<li>å®šæœŸæ¸…ç† DOM ä¸­çš„ Markdown æ¸²æŸ“ç»“æœ</li>
</ul>
</li>
</ol>
<h3 data-id="heading-34">5.3 å®‰å…¨æœ€ä½³å®è·µ</h3>
<ol>
<li>
<p><strong>CSP é…ç½®</strong>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// tauri.conf.json</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"security"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"csp"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</li>
<li>
<p><strong>å‘½ä»¤ç™½åå•</strong>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// capabilities/default.json</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"permissions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"core:default"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"identifier"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"shell:allow-open"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"allow"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span> <span class="hljs-attr">"path"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://*"</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</li>
<li>
<p><strong>API Key å®‰å…¨</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨ AES-256-GCM åŠ å¯†å­˜å‚¨</li>
<li>å¯†é’¥ä»è®¾å¤‡æŒ‡çº¹æ´¾ç”Ÿï¼Œä¸æ˜æ–‡ä¿å­˜</li>
<li>å®šæœŸæé†’ç”¨æˆ·æ›´æ¢æ³„éœ²çš„ Key</li>
</ul>
</li>
</ol>
<h3 data-id="heading-35">5.4 å®‰å…¨è®¾è®¡ç»†èŠ‚</h3>
<h4 data-id="heading-36">5.4.1 API Key åŠ å¯†å­˜å‚¨å®ç°</h4>
<p>API Key ä½œä¸ºæ•æ„Ÿä¿¡æ¯ï¼Œé‡‡ç”¨äº†å¤šå±‚å®‰å…¨ä¿æŠ¤æœºåˆ¶ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// src-tauri/src/services/crypto.rs</span>

<span class="hljs-keyword">use</span> aes_gcm::{Aes256Gcm, Key, Nonce};
<span class="hljs-keyword">use</span> aes_gcm::aead::{Aead, NewAead};
<span class="hljs-keyword">use</span> pbkdf2::pbkdf2;
<span class="hljs-keyword">use</span> hmac::Hmac;
<span class="hljs-keyword">use</span> sha2::Sha256;

<span class="hljs-comment">/// åŠ å¯†æœåŠ¡</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">CryptoService</span> {
    key: Key&lt;Aes256Gcm&gt;,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">CryptoService</span> {
    <span class="hljs-comment">/// ä»è®¾å¤‡æŒ‡çº¹æ´¾ç”Ÿå¯†é’¥</span>
    <span class="hljs-comment">/// ç»“åˆä¸»æœºåã€ç”¨æˆ·åå’Œæœºå™¨å”¯ä¸€IDç”Ÿæˆè®¾å¤‡æŒ‡çº¹</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">from_device_fingerprint</span>() <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-keyword">Self</span>, AppError&gt; {
        <span class="hljs-comment">// ç»„åˆå¤šä¸ªè®¾å¤‡ç‰¹å¾ç”Ÿæˆå”¯ä¸€æŒ‡çº¹</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">hostname</span> = whoami::<span class="hljs-title function_ invoke__">hostname</span>();
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">username</span> = whoami::<span class="hljs-title function_ invoke__">username</span>();
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">machine_id</span> = machine_uid::<span class="hljs-title function_ invoke__">get</span>()
            .<span class="hljs-title function_ invoke__">map_err</span>(|e| AppError::<span class="hljs-title function_ invoke__">Crypto</span>(<span class="hljs-built_in">format!</span>(<span class="hljs-string">"è·å–æœºå™¨IDå¤±è´¥: {}"</span>, e)))?;
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">fingerprint</span> = <span class="hljs-built_in">format!</span>(<span class="hljs-string">"{}-{}-{}"</span>, hostname, username, machine_id);
        
        <span class="hljs-comment">// ä½¿ç”¨ PBKDF2 æ´¾ç”Ÿ 256 ä½å¯†é’¥</span>
        <span class="hljs-comment">// 100,000 æ¬¡è¿­ä»£ï¼Œå¢åŠ æš´åŠ›ç ´è§£éš¾åº¦</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">salt</span> = <span class="hljs-string">b"smart-toolbox-salt-2024"</span>;
        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">key</span> = [<span class="hljs-number">0u8</span>; <span class="hljs-number">32</span>];
        pbkdf2::&lt;Hmac&lt;Sha256&gt;&gt;(
            fingerprint.<span class="hljs-title function_ invoke__">as_bytes</span>(),
            salt,
            <span class="hljs-number">100_000</span>,
            &amp;<span class="hljs-keyword">mut</span> key,
        );
        
        <span class="hljs-title function_ invoke__">Ok</span>(<span class="hljs-keyword">Self</span> { key: Key::<span class="hljs-title function_ invoke__">from_slice</span>(&amp;key).<span class="hljs-title function_ invoke__">clone</span>() })
    }
    
    <span class="hljs-comment">/// åŠ å¯† API Key</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">encrypt</span>(&amp;<span class="hljs-keyword">self</span>, plaintext: &amp;<span class="hljs-type">str</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>, AppError&gt; {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">cipher</span> = Aes256Gcm::<span class="hljs-title function_ invoke__">new</span>(&amp;<span class="hljs-keyword">self</span>.key);
        <span class="hljs-comment">// æ³¨æ„ï¼šå®é™…åº”ç”¨ä¸­åº”ä½¿ç”¨éšæœº nonce</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">nonce</span> = Nonce::<span class="hljs-title function_ invoke__">from_slice</span>(<span class="hljs-string">b"unique nonce"</span>);
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">ciphertext</span> = cipher.<span class="hljs-title function_ invoke__">encrypt</span>(nonce, plaintext.<span class="hljs-title function_ invoke__">as_bytes</span>())
            .<span class="hljs-title function_ invoke__">map_err</span>(|e| AppError::<span class="hljs-title function_ invoke__">Crypto</span>(<span class="hljs-built_in">format!</span>(<span class="hljs-string">"åŠ å¯†å¤±è´¥: {}"</span>, e)))?;
        
        <span class="hljs-comment">// Base64 ç¼–ç ä¾¿äºå­˜å‚¨</span>
        <span class="hljs-title function_ invoke__">Ok</span>(base64::<span class="hljs-title function_ invoke__">encode</span>(&amp;ciphertext))
    }
    
    <span class="hljs-comment">/// è§£å¯† API Key</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">decrypt</span>(&amp;<span class="hljs-keyword">self</span>, ciphertext: &amp;<span class="hljs-type">str</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>, AppError&gt; {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">cipher</span> = Aes256Gcm::<span class="hljs-title function_ invoke__">new</span>(&amp;<span class="hljs-keyword">self</span>.key);
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">nonce</span> = Nonce::<span class="hljs-title function_ invoke__">from_slice</span>(<span class="hljs-string">b"unique nonce"</span>);
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">ciphertext_bytes</span> = base64::<span class="hljs-title function_ invoke__">decode</span>(ciphertext)
            .<span class="hljs-title function_ invoke__">map_err</span>(|e| AppError::<span class="hljs-title function_ invoke__">Crypto</span>(<span class="hljs-built_in">format!</span>(<span class="hljs-string">"Base64 è§£ç å¤±è´¥: {}"</span>, e)))?;
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">plaintext</span> = cipher.<span class="hljs-title function_ invoke__">decrypt</span>(nonce, ciphertext_bytes.<span class="hljs-title function_ invoke__">as_ref</span>())
            .<span class="hljs-title function_ invoke__">map_err</span>(|e| AppError::<span class="hljs-title function_ invoke__">Crypto</span>(<span class="hljs-built_in">format!</span>(<span class="hljs-string">"è§£å¯†å¤±è´¥: {}"</span>, e)))?;
        
        <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from_utf8</span>(plaintext)
            .<span class="hljs-title function_ invoke__">map_err</span>(|e| AppError::<span class="hljs-title function_ invoke__">Crypto</span>(<span class="hljs-built_in">format!</span>(<span class="hljs-string">"UTF-8 è§£ç å¤±è´¥: {}"</span>, e)))
    }
}
</code></pre>
<p><strong>å®‰å…¨ç‰¹æ€§</strong>ï¼š</p>
<ol>
<li><strong>è®¾å¤‡ç»‘å®š</strong>ï¼šå¯†é’¥ä¸è®¾å¤‡ç¡¬ä»¶ä¿¡æ¯ç»‘å®šï¼Œå³ä½¿æ•°æ®åº“æ³„éœ²ä¹Ÿæ— æ³•åœ¨å…¶ä»–è®¾å¤‡ä¸Šè§£å¯†</li>
<li><strong>PBKDF2 åŠ å¯†</strong>ï¼š100,000 æ¬¡è¿­ä»£å¢åŠ æš´åŠ›ç ´è§£éš¾åº¦</li>
<li><strong>AES-256-GCM</strong>ï¼šå·¥ä¸šçº§åŠ å¯†ç®—æ³•ï¼Œæä¾›æœºå¯†æ€§å’Œå®Œæ•´æ€§ä¿æŠ¤</li>
</ol>
<h4 data-id="heading-37">5.4.2 æƒé™æ§åˆ¶æœºåˆ¶</h4>
<p>åŸºäº Tauri 2.x çš„æƒé™ç³»ç»Ÿå®ç°æœ€å°æƒé™åŸåˆ™ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// capabilities/default.json</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"identifier"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"smart-toolbox-core"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ ¸å¿ƒåŠŸèƒ½æƒé™"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"windows"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"main"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"permissions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"core:default"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"shell:allow-open"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"fs:read-all"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"fs:write-all"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"identifier"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"http:default"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"allow"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-punctuation">{</span> <span class="hljs-attr">"url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://api.openai.com/*"</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-punctuation">{</span> <span class="hljs-attr">"url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://api.anthropic.com/*"</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-punctuation">{</span> <span class="hljs-attr">"url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://api.deepseek.com/*"</span> <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>æƒé™æ§åˆ¶ç­–ç•¥</strong>ï¼š</p>
<ol>
<li><strong>æœ€å°æƒé™åŸåˆ™</strong>ï¼šåªæˆäºˆåº”ç”¨å¿…éœ€çš„æƒé™</li>
<li><strong>URL ç™½åå•</strong>ï¼šé™åˆ¶ HTTP è¯·æ±‚åªèƒ½å‘é€åˆ°æŒ‡å®šçš„ API ç«¯ç‚¹</li>
<li><strong>çª—å£éš”ç¦»</strong>ï¼šé™åˆ¶åŠŸèƒ½åªèƒ½åœ¨ä¸»çª—å£ä¸­ä½¿ç”¨</li>
</ol>
<h4 data-id="heading-38">5.4.3 å‘½ä»¤ç™½åå•æœºåˆ¶</h4>
<p>æ‰€æœ‰ Tauri å‘½ä»¤éƒ½ç»è¿‡ä¸¥æ ¼éªŒè¯ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// src-tauri/src/commands/mod.rs</span>

<span class="hljs-comment">/// å®‰å…¨çš„å‘½ä»¤è°ƒç”¨ç¤ºä¾‹</span>
<span class="hljs-meta">#[tauri::command]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">send_message</span>(
    app: tauri::AppHandle,
    state: tauri::State&lt;<span class="hljs-symbol">'_</span>, AppState&gt;,
    conversation_id: <span class="hljs-type">Option</span>&lt;<span class="hljs-type">String</span>&gt;,
    content: <span class="hljs-type">String</span>,
) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>, AppError&gt; {
    <span class="hljs-comment">// è¾“å…¥éªŒè¯</span>
    <span class="hljs-keyword">if</span> content.<span class="hljs-title function_ invoke__">trim</span>().<span class="hljs-title function_ invoke__">is_empty</span>() {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">Err</span>(AppError::<span class="hljs-title function_ invoke__">InvalidInput</span>(<span class="hljs-string">"æ¶ˆæ¯å†…å®¹ä¸èƒ½ä¸ºç©º"</span>.<span class="hljs-title function_ invoke__">to_string</span>()));
    }
    
    <span class="hljs-comment">// é•¿åº¦é™åˆ¶</span>
    <span class="hljs-keyword">if</span> content.<span class="hljs-title function_ invoke__">len</span>() &gt; <span class="hljs-number">10000</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">Err</span>(AppError::<span class="hljs-title function_ invoke__">InvalidInput</span>(<span class="hljs-string">"æ¶ˆæ¯å†…å®¹è¿‡é•¿"</span>.<span class="hljs-title function_ invoke__">to_string</span>()));
    }
    
    <span class="hljs-comment">// æƒé™æ£€æŸ¥</span>
    <span class="hljs-keyword">if</span> !state.<span class="hljs-title function_ invoke__">is_user_authenticated</span>().<span class="hljs-keyword">await</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">Err</span>(AppError::<span class="hljs-title function_ invoke__">Unauthorized</span>(<span class="hljs-string">"ç”¨æˆ·æœªè®¤è¯"</span>.<span class="hljs-title function_ invoke__">to_string</span>()));
    }
    
    <span class="hljs-comment">// è°ƒç”¨æ ¸å¿ƒæœåŠ¡</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">result</span> = state.chat_service.<span class="hljs-title function_ invoke__">send_message</span>(conversation_id, content).<span class="hljs-keyword">await</span>?;
    <span class="hljs-title function_ invoke__">Ok</span>(result)
}
</code></pre>
<p><strong>å®‰å…¨æ£€æŸ¥ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>è¾“å…¥éªŒè¯</strong>ï¼šæ£€æŸ¥å‚æ•°åˆæ³•æ€§</li>
<li><strong>é•¿åº¦é™åˆ¶</strong>ï¼šé˜²æ­¢ç¼“å†²åŒºæº¢å‡º</li>
<li><strong>æƒé™éªŒè¯</strong>ï¼šç¡®ä¿ç”¨æˆ·å·²è®¤è¯</li>
<li><strong>é”™è¯¯å¤„ç†</strong>ï¼šé¿å…æ³„éœ²æ•æ„Ÿä¿¡æ¯</li>
</ol>
<h2 data-id="heading-39">å…­ã€Tauri vs Electronï¼šå¼€å‘ä½“éªŒæ·±åº¦å¯¹æ¯”</h2>
<p>ä½œä¸ºä¸€ä¸ªæœ‰è¿‡ Electron å¼€å‘ç»éªŒçš„å¼€å‘è€…ï¼Œåœ¨å®Œæˆæ™ºèƒ½å·¥å…·ç®±çš„å¼€å‘åï¼Œæˆ‘æƒ³ä»å¤šä¸ªç»´åº¦å¯¹æ¯”ä¸€ä¸‹ Tauri å’Œ Electron çš„å¼€å‘ä½“éªŒã€‚</p>
<h3 data-id="heading-40">6.1 å¼€å‘ç¯å¢ƒæ­å»º</h3>






























<table><thead><tr><th>ç»´åº¦</th><th>Electron</th><th>Tauri</th></tr></thead><tbody><tr><td><strong>å‰ç½®ä¾èµ–</strong></td><td>Node.js + npm/yarn</td><td>Node.js + Rust + Cargo + ç³»ç»Ÿä¾èµ–</td></tr><tr><td><strong>å®‰è£…å¤æ‚åº¦</strong></td><td>â­ ç®€å•</td><td>â­â­â­ ä¸­ç­‰ï¼ˆéœ€è¦é…ç½® Rust ç¯å¢ƒï¼‰</td></tr><tr><td><strong>é¦–æ¬¡å¯åŠ¨</strong></td><td>1-2 åˆ†é’Ÿ</td><td>3-5 åˆ†é’Ÿï¼ˆé¦–æ¬¡ç¼–è¯‘ Rustï¼‰</td></tr><tr><td><strong>çƒ­æ›´æ–°é€Ÿåº¦</strong></td><td>â­â­â­â­â­ æå¿«</td><td>â­â­â­â­ å¿«ï¼ˆå‰ç«¯çƒ­æ›´æ–°ï¼ŒRust éœ€é‡æ–°ç¼–è¯‘ï¼‰</td></tr></tbody></table>
<p><strong>ä¸ªäººæ„Ÿå—</strong>ï¼š</p>
<ul>
<li>Electron çš„ç¯å¢ƒæ­å»ºå‡ ä¹æ˜¯é›¶é—¨æ§›ï¼Œåªè¦ä¼š Node.js å°±èƒ½ä¸Šæ‰‹</li>
<li>Tauri éœ€è¦å®‰è£… Rust å·¥å…·é“¾ï¼Œå¯¹äºæ²¡æœ‰ Rust ç»éªŒçš„å¼€å‘è€…æ¥è¯´æœ‰ä¸€å®šå­¦ä¹ æˆæœ¬</li>
<li>ä½† Tauri çš„Â <code>cargo tauri dev</code>Â å‘½ä»¤ä¼šè‡ªåŠ¨å¤„ç†å¤§éƒ¨åˆ†é…ç½®ï¼Œå®é™…ä½“éªŒæ¯”é¢„æœŸå¥½å¾ˆå¤š</li>
</ul>
<h3 data-id="heading-41">6.2 å‰ç«¯å¼€å‘ä½“éªŒ</h3>
<p><strong>ç›¸ä¼¼ä¹‹å¤„</strong>ï¼š</p>
<ul>
<li>ä¸¤è€…éƒ½ä½¿ç”¨ Web æŠ€æœ¯æ ˆï¼ˆHTML/CSS/JavaScriptï¼‰</li>
<li>éƒ½å¯ä»¥ä½¿ç”¨ Reactã€Vueã€Angular ç­‰ç°ä»£å‰ç«¯æ¡†æ¶</li>
<li>éƒ½æ”¯æŒçƒ­æ›´æ–°ï¼ˆHMRï¼‰</li>
</ul>
<p><strong>å·®å¼‚ä¹‹å¤„</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Electron: ä½¿ç”¨ IPC é€šä¿¡</span>
<span class="hljs-keyword">const</span> { ipcRenderer } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'electron'</span>);

<span class="hljs-comment">// å‘é€æ¶ˆæ¯</span>
ipcRenderer.<span class="hljs-title function_">send</span>(<span class="hljs-string">'message'</span>, { <span class="hljs-attr">data</span>: <span class="hljs-string">'hello'</span> });

<span class="hljs-comment">// ç›‘å¬æ¶ˆæ¯</span>
ipcRenderer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'reply'</span>, <span class="hljs-function">(<span class="hljs-params">event, result</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result);
});
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Tauri: ä½¿ç”¨ invoke API</span>
<span class="hljs-keyword">import</span> { invoke } <span class="hljs-keyword">from</span> <span class="hljs-string">'@tauri-apps/api/core'</span>;

<span class="hljs-comment">// è°ƒç”¨å‘½ä»¤ï¼ˆè¿”å› Promiseï¼‰</span>
<span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">invoke</span>(<span class="hljs-string">'get_data'</span>, { <span class="hljs-attr">id</span>: <span class="hljs-number">123</span> });

<span class="hljs-comment">// ç›‘å¬äº‹ä»¶</span>
<span class="hljs-keyword">import</span> { listen } <span class="hljs-keyword">from</span> <span class="hljs-string">'@tauri-apps/api/event'</span>;
<span class="hljs-keyword">const</span> unlisten = <span class="hljs-keyword">await</span> <span class="hljs-title function_">listen</span>(<span class="hljs-string">'event-name'</span>, <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(event.<span class="hljs-property">payload</span>);
});
</code></pre>
<p><strong>ä¸ªäººæ„Ÿå—</strong>ï¼š</p>
<ul>
<li>Tauri çš„Â <code>invoke</code>Â API æ›´åŠ ç°ä»£åŒ–ï¼ŒåŸºäº Promiseï¼Œä¸ async/await é…åˆæ›´è‡ªç„¶</li>
<li>Electron çš„ IPC äº‹ä»¶æ¨¡å‹æ›´çµæ´»ï¼Œä½†éœ€è¦æ‰‹åŠ¨ç®¡ç†äº‹ä»¶ç›‘å¬å™¨</li>
<li>Tauri çš„ç±»å‹å®‰å…¨æ›´å¥½ï¼ˆé…åˆ TypeScriptï¼‰ï¼Œå¯ä»¥åœ¨ç¼–è¯‘æ—¶å‘ç°é”™è¯¯</li>
</ul>
<h3 data-id="heading-42">6.3 åç«¯å¼€å‘ä½“éªŒ</h3>
<p>è¿™æ˜¯ä¸¤è€…å·®å¼‚æœ€å¤§çš„åœ°æ–¹ï¼š</p>
<p><strong>Electron (Node.js)</strong> ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// main.js</span>
<span class="hljs-keyword">const</span> { ipcMain } = require(<span class="hljs-string">'electron'</span>);

ipcMain.handle(<span class="hljs-string">'read-file'</span>, async (event, filePath) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">data</span> = await fs.promises.readFile(filePath, <span class="hljs-string">'utf-8'</span>);
    <span class="hljs-keyword">return</span> { success: <span class="hljs-literal">true</span>, <span class="hljs-keyword">data</span> };
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-keyword">return</span> { success: <span class="hljs-literal">false</span>, error: error.message };
  }
});
</code></pre>
<p><strong>Tauri (Rust)</strong> ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// commands.rs</span>
<span class="hljs-meta">#[tauri::command]</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">read_file</span>(path: <span class="hljs-type">String</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>, <span class="hljs-type">String</span>&gt; {
    tokio::fs::<span class="hljs-title function_ invoke__">read_to_string</span>(&amp;path)
        .<span class="hljs-keyword">await</span>
        .<span class="hljs-title function_ invoke__">map_err</span>(|e| e.<span class="hljs-title function_ invoke__">to_string</span>())
}
</code></pre>
<p><strong>å¯¹æ¯”åˆ†æ</strong>ï¼š</p>








































<table><thead><tr><th>ç»´åº¦</th><th>Electron (Node.js)</th><th>Tauri (Rust)</th></tr></thead><tbody><tr><td><strong>ç±»å‹å®‰å…¨</strong></td><td>â­â­ å¼±ç±»å‹ï¼Œè¿è¡Œæ—¶é”™è¯¯</td><td>â­â­â­â­â­ å¼ºç±»å‹ï¼Œç¼–è¯‘æ—¶æ£€æŸ¥</td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>â­â­â­ å•çº¿ç¨‹ï¼Œäº‹ä»¶å¾ªç¯</td><td>â­â­â­â­â­ å¤šçº¿ç¨‹ï¼Œé›¶æˆæœ¬æŠ½è±¡</td></tr><tr><td><strong>å†…å­˜å®‰å…¨</strong></td><td>â­â­â­ åƒåœ¾å›æ”¶ï¼Œå¯èƒ½æœ‰æ³„æ¼</td><td>â­â­â­â­â­ æ‰€æœ‰æƒç³»ç»Ÿï¼Œæ— æ³„æ¼</td></tr><tr><td><strong>å­¦ä¹ æ›²çº¿</strong></td><td>â­ ç®€å•ï¼ŒJavaScript åŸºç¡€å³å¯</td><td>â­â­â­â­ éœ€è¦ç†è§£æ‰€æœ‰æƒã€ç”Ÿå‘½å‘¨æœŸ</td></tr><tr><td><strong>å¼€å‘æ•ˆç‡</strong></td><td>â­â­â­â­â­ å¿«é€Ÿè¿­ä»£</td><td>â­â­â­ ç¼–è¯‘æ—¶é—´è¾ƒé•¿ï¼Œä½† bug æ›´å°‘</td></tr><tr><td><strong>ç”Ÿæ€ä¸°å¯Œåº¦</strong></td><td>â­â­â­â­â­ npm ç”Ÿæ€æå…¶ä¸°å¯Œ</td><td>â­â­â­ crates.io ç”Ÿæ€åœ¨å¢é•¿</td></tr></tbody></table>
<p><strong>ä¸ªäººæ„Ÿå—</strong>ï¼š</p>
<ul>
<li><strong>Electron</strong>ï¼šå¼€å‘é€Ÿåº¦å¿«ï¼Œå‡ ä¹ä¸éœ€è¦å­¦ä¹ æ–°ä¸œè¥¿ï¼Œé€‚åˆå¿«é€ŸåŸå‹å¼€å‘</li>
<li><strong>Tauri</strong>ï¼šåˆæœŸå­¦ä¹ æˆæœ¬é«˜ï¼Œä½† Rust çš„ç±»å‹ç³»ç»Ÿè®©ä»£ç æ›´å¥å£®ï¼Œç¼–è¯‘å™¨å°±åƒä¸€ä¸ªä¸¥æ ¼çš„ä»£ç å®¡æŸ¥å‘˜</li>
<li>Rust çš„æ‰€æœ‰æƒæ¨¡å‹ä¸€å¼€å§‹å¾ˆéš¾ç†è§£ï¼Œä½†ä¸€æ—¦æŒæ¡ï¼Œä¼šå‘ç°å®ƒè®©å¹¶å‘ç¼–ç¨‹å˜å¾—ç®€å•å®‰å…¨</li>
</ul>
<h3 data-id="heading-43">6.4 è°ƒè¯•ä½“éªŒ</h3>
<p><strong>Electron</strong>ï¼š</p>
<ul>
<li>Chrome DevTools ç›´æ¥è°ƒè¯•ä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹</li>
<li><code>console.log</code>Â éšå¤„å¯ç”¨</li>
<li>æ–­ç‚¹è°ƒè¯•ä½“éªŒä¸ Web å¼€å‘ä¸€è‡´</li>
</ul>
<p><strong>Tauri</strong>ï¼š</p>
<ul>
<li>å‰ç«¯ï¼šChrome DevToolsï¼ˆä¸ Electron ç›¸åŒï¼‰</li>
<li>åç«¯ï¼šéœ€è¦ä½¿ç”¨Â <code>println!</code>Â æˆ–Â <code>dbg!</code>Â å®ï¼Œæˆ–è€…é…ç½® VS Code çš„ Rust æ’ä»¶è¿›è¡Œè°ƒè¯•</li>
<li>æ—¥å¿—æŸ¥çœ‹ï¼šç»ˆç«¯è¾“å‡ºæˆ–ä½¿ç”¨Â <code>env_logger</code>Â ç­‰æ—¥å¿—åº“</li>
</ul>
<p><strong>ä¸ªäººæ„Ÿå—</strong>ï¼š</p>
<ul>
<li>Electron çš„è°ƒè¯•ä½“éªŒæ›´ç»Ÿä¸€ï¼Œå‰åç«¯éƒ½å¯ä»¥ç”¨ DevTools</li>
<li>Tauri çš„ Rust è°ƒè¯•éœ€è¦é¢å¤–é…ç½®ï¼Œä½† Rust çš„é”™è¯¯ä¿¡æ¯éå¸¸è¯¦ç»†ï¼Œç¼–è¯‘å™¨ä¼šç»™å‡ºå¾ˆå¥½çš„æç¤º</li>
<li>å¯¹äºä¹ æƒ¯äº† Web å¼€å‘çš„æˆ‘æ¥è¯´ï¼ŒTauri çš„è°ƒè¯•ä½“éªŒéœ€è¦é€‚åº”</li>
</ul>
<h3 data-id="heading-44">6.5 æ‰“åŒ…ä¸åˆ†å‘</h3>






























<table><thead><tr><th>ç»´åº¦</th><th>Electron</th><th>Tauri</th></tr></thead><tbody><tr><td><strong>åŒ…ä½“ç§¯</strong></td><td>150MB+</td><td>10-20MB</td></tr><tr><td><strong>æ‰“åŒ…æ—¶é—´</strong></td><td>2-5 åˆ†é’Ÿ</td><td>5-10 åˆ†é’Ÿ</td></tr><tr><td><strong>ç­¾åé…ç½®</strong></td><td>ç›¸å¯¹ç®€å•</td><td>éœ€è¦é…ç½®ç³»ç»Ÿç­¾å</td></tr><tr><td><strong>è·¨å¹³å°</strong></td><td>â­â­â­â­â­ éå¸¸æˆç†Ÿ</td><td>â­â­â­â­ æ”¯æŒ Windows/macOS/Linux</td></tr></tbody></table>
<p><strong>ä¸ªäººæ„Ÿå—</strong>ï¼š</p>
<ul>
<li>Tauri çš„åŒ…ä½“ç§¯ä¼˜åŠ¿éå¸¸æ˜æ˜¾ï¼Œç”¨æˆ·ä¸‹è½½ä½“éªŒæ›´å¥½</li>
<li>Electron çš„æ‰“åŒ…å·¥å…·ï¼ˆelectron-builderï¼‰æ›´æˆç†Ÿï¼Œé…ç½®æ›´ç®€å•</li>
<li>Tauri çš„ç­¾åé…ç½®åœ¨ä¸åŒå¹³å°ä¸Šå·®å¼‚è¾ƒå¤§ï¼Œéœ€è¦æŸ¥é˜…æ–‡æ¡£</li>
</ul>
<h3 data-id="heading-45">6.6 ç¤¾åŒºä¸ç”Ÿæ€</h3>
<p><strong>Electron</strong>ï¼š</p>
<ul>
<li>â­â­â­â­â­ æˆç†Ÿç¨³å®šï¼ŒVS Codeã€Slackã€Discord ç­‰çŸ¥ååº”ç”¨éƒ½åœ¨ç”¨</li>
<li>npm ä¸Šæœ‰å¤§é‡ç°æˆçš„åº“å’Œæ’ä»¶</li>
<li>é—®é¢˜è§£å†³æ–¹æ¡ˆä¸°å¯Œï¼ŒStack Overflow ä¸Šæœ‰å¾ˆå¤šç­”æ¡ˆ</li>
</ul>
<p><strong>Tauri</strong>ï¼š</p>
<ul>
<li>â­â­â­ å¿«é€Ÿæˆé•¿ä¸­ï¼Œç¤¾åŒºæ´»è·ƒ</li>
<li>å®˜æ–¹æ–‡æ¡£è´¨é‡é«˜ï¼Œä½†ç¬¬ä¸‰æ–¹èµ„æºç›¸å¯¹è¾ƒå°‘</li>
<li>é‡åˆ°é—®é¢˜æ—¶å¯èƒ½éœ€è¦è‡ªå·±ç ”ç©¶æˆ–æ issue</li>
</ul>
<p><strong>ä¸ªäººæ„Ÿå—</strong>ï¼š</p>
<ul>
<li>Electron çš„ç”Ÿæ€ä¼˜åŠ¿æ— å¯æ›¿ä»£ï¼Œå‡ ä¹ä»»ä½•éœ€æ±‚éƒ½èƒ½æ‰¾åˆ°ç°æˆçš„è§£å†³æ–¹æ¡ˆ</li>
<li>Tauri çš„ç¤¾åŒºè™½ç„¶å¹´è½»ï¼Œä½†éå¸¸å‹å¥½ï¼Œå®˜æ–¹å›¢é˜Ÿå“åº”ç§¯æ</li>
<li>å¯¹äº AI åº”ç”¨è¿™ç§éœ€è¦é«˜æ€§èƒ½çš„åœºæ™¯ï¼ŒTauri çš„ä¼˜åŠ¿æ›´æ˜æ˜¾</li>
</ul>
<h3 data-id="heading-46">6.7 æ€»ç»“ï¼šä»€ä¹ˆæ—¶å€™é€‰æ‹©å“ªä¸ªï¼Ÿ</h3>
<p><strong>é€‰æ‹© Electronï¼Œå¦‚æœ</strong>ï¼š</p>
<ul>
<li>âœ… å›¢é˜Ÿç†Ÿæ‚‰ JavaScript/TypeScriptï¼Œä¸æƒ³å­¦ä¹ æ–°è¯­è¨€</li>
<li>âœ… éœ€è¦å¿«é€Ÿå¼€å‘åŸå‹ï¼Œæ—¶é—´ç´§è¿«</li>
<li>âœ… åº”ç”¨éœ€è¦å¤§é‡ Node.js ç”Ÿæ€çš„åº“</li>
<li>âœ… åŒ…ä½“ç§¯å’Œå†…å­˜å ç”¨ä¸æ˜¯ä¸»è¦è€ƒè™‘å› ç´ </li>
<li>âœ… éœ€è¦éå¸¸æˆç†Ÿçš„è·¨å¹³å°æ”¯æŒ</li>
</ul>
<p><strong>é€‰æ‹© Tauriï¼Œå¦‚æœ</strong>ï¼š</p>
<ul>
<li>âœ… è¿½æ±‚æè‡´çš„æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ</li>
<li>âœ… åŒ…ä½“ç§¯å’Œå†…å­˜å ç”¨æ˜¯å…³é”®æŒ‡æ ‡</li>
<li>âœ… æ„¿æ„å­¦ä¹  Rustï¼Œäº«å—ç±»å‹å®‰å…¨å¸¦æ¥çš„å¥½å¤„</li>
<li>âœ… åº”ç”¨éœ€è¦å¤„ç†å¤§é‡è®¡ç®—æˆ– I/O æ“ä½œ</li>
<li>âœ… å¯¹å®‰å…¨æ€§æœ‰è¾ƒé«˜è¦æ±‚</li>
<li>âœ… æƒ³è¦å°è¯•æ–°æŠ€æœ¯ï¼Œæ‹“å±•æŠ€æœ¯è¾¹ç•Œ</li>
</ul>
<p><strong>æˆ‘çš„é€‰æ‹©</strong>ï¼š<br/>
å¯¹äºæ™ºèƒ½å·¥å…·ç®±è¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘é€‰æ‹©äº† Tauriï¼Œä¸»è¦åŸå› æ˜¯ï¼š</p>
<ol>
<li><strong>æ€§èƒ½éœ€æ±‚</strong>ï¼šAI åº”ç”¨éœ€è¦é¢‘ç¹è°ƒç”¨ LLM APIï¼ŒRust çš„å¼‚æ­¥æ€§èƒ½ä¼˜åŠ¿æ˜æ˜¾</li>
<li><strong>ç”¨æˆ·ä½“éªŒ</strong>ï¼š15MB çš„åŒ…ä½“ç§¯è®©ç”¨æˆ·æ›´å®¹æ˜“æ¥å—</li>
<li><strong>å­¦ä¹ åŠ¨æœº</strong>ï¼šæˆ‘æƒ³å€Ÿæ­¤æœºä¼šå­¦ä¹  Rustï¼Œæ‹“å±•æŠ€æœ¯æ ˆ</li>
<li><strong>å®‰å…¨æ€§</strong>ï¼šAPI Key ç­‰æ•æ„Ÿä¿¡æ¯çš„åŠ å¯†å­˜å‚¨ï¼ŒRust çš„å†…å­˜å®‰å…¨ç‰¹æ€§æ›´è®©äººæ”¾å¿ƒ</li>
</ol>
<p>è™½ç„¶å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°äº†ä¸å°‘æŒ‘æˆ˜ï¼Œä½†æ•´ä½“æ¥è¯´ï¼Œè¿™æ˜¯ä¸€æ¬¡éå¸¸å€¼å¾—çš„æŠ€æœ¯æ¢ç´¢ã€‚Rust çš„å­¦ä¹ æ›²çº¿è™½ç„¶é™¡å³­ï¼Œä½†æŒæ¡åçš„æˆå°±æ„Ÿä¹Ÿæ˜¯æ— ä¸ä¼¦æ¯”çš„ã€‚</p>
<h2 data-id="heading-47">ä¸ƒã€è¸©å‘è®°å½•</h2>
<h3 data-id="heading-48">7.1 Tauri 2.x å‡çº§é—®é¢˜</h3>
<p>ä» Tauri 1.x å‡çº§åˆ° 2.x æ—¶é‡åˆ°çš„ä¸»è¦é—®é¢˜ï¼š</p>

























<table><thead><tr><th>é—®é¢˜</th><th>åŸå› </th><th>è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td><code>invoke</code>Â å‚æ•°åºåˆ—åŒ–å¤±è´¥</td><td>2.x å¯¹ç±»å‹æ£€æŸ¥æ›´ä¸¥æ ¼</td><td>ç¡®ä¿ Rust ç»“æ„ä½“æ´¾ç”ŸÂ <code>Serialize</code></td></tr><tr><td>å‘½ä»¤æ— æƒé™æ‰§è¡Œ</td><td>æ–°ç‰ˆæƒé™ç³»ç»Ÿ</td><td>é…ç½®Â <code>capabilities/default.json</code></td></tr><tr><td>æ’ä»¶ API å˜åŒ–</td><td>2.x é‡æ„äº†æ’ä»¶æ¥å£</td><td>å‡çº§åˆ°å¯¹åº” 2.x ç‰ˆæœ¬çš„æ’ä»¶</td></tr></tbody></table>
<h3 data-id="heading-49">7.2 å¼‚æ­¥ Rust ä¸ Tauri</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šåœ¨ async ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨åŒæ­¥é”</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">bad_example</span>(state: State&lt;<span class="hljs-symbol">'_</span>, Mutex&lt;AppState&gt;&gt;) {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">guard</span> = state.<span class="hljs-title function_ invoke__">lock</span>().<span class="hljs-title function_ invoke__">unwrap</span>(); <span class="hljs-comment">// å¯èƒ½æ­»é”ï¼</span>
    <span class="hljs-title function_ invoke__">some_async_operation</span>().<span class="hljs-keyword">await</span>;      <span class="hljs-comment">// æŒæœ‰é”æ—¶ await</span>
}

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šä½¿ç”¨ tokio::sync::Mutex</span>
<span class="hljs-keyword">use</span> tokio::sync::Mutex;

<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">good_example</span>(state: State&lt;<span class="hljs-symbol">'_</span>, Mutex&lt;AppState&gt;&gt;) {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">guard</span> = state.<span class="hljs-title function_ invoke__">lock</span>().<span class="hljs-keyword">await</span>;
    <span class="hljs-title function_ invoke__">some_async_operation</span>().<span class="hljs-keyword">await</span>;
}
</code></pre>
<h3 data-id="heading-50">7.3 æµå¼å“åº”å¤„ç†</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// ä½¿ç”¨ Tauri event å®ç°æµå¼æ¨é€</span>
<span class="hljs-keyword">use</span> tauri::Emitter;

<span class="hljs-meta">#[tauri::command]</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">stream_chat</span>(
    app: tauri::AppHandle,
    message: <span class="hljs-type">String</span>,
) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;(), AppError&gt; {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">stream</span> = llm_client.<span class="hljs-title function_ invoke__">chat_stream</span>(message).<span class="hljs-keyword">await</span>?;
    
    <span class="hljs-keyword">while</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(chunk) = stream.<span class="hljs-title function_ invoke__">next</span>().<span class="hljs-keyword">await</span> {
        <span class="hljs-comment">// é€šè¿‡äº‹ä»¶æ¨é€ç»™å‰ç«¯</span>
        app.<span class="hljs-title function_ invoke__">emit</span>(<span class="hljs-string">"chat-chunk"</span>, &amp;chunk)?;
    }
    
    app.<span class="hljs-title function_ invoke__">emit</span>(<span class="hljs-string">"chat-done"</span>, ())?;
    <span class="hljs-title function_ invoke__">Ok</span>(())
}
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å‰ç«¯ç›‘å¬äº‹ä»¶</span>
<span class="hljs-keyword">import</span> { listen } <span class="hljs-keyword">from</span> <span class="hljs-string">'@tauri-apps/api/event'</span>;

<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> unlisten = listen&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">'chat-chunk'</span>, <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-title function_">setContent</span>(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev + event.<span class="hljs-property">payload</span>);
  });
  
  <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> { unlisten.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">fn</span> =&gt;</span> <span class="hljs-title function_">fn</span>()); };
}, []);
</code></pre>
<h2 data-id="heading-51">å…«ã€æ€»ç»“ä¸å±•æœ›</h2>
<p>é€šè¿‡Â <strong>Tauri 2.x + Rust + React</strong>Â çš„ç»„åˆï¼Œæˆ‘ä»¬æˆåŠŸæ„å»ºäº†ä¸€ä¸ªè½»é‡çº§ã€é«˜æ€§èƒ½ã€åŠŸèƒ½å¼ºå¤§çš„æ¡Œé¢ AI åŠ©æ‰‹ã€‚</p>
<h3 data-id="heading-52">æŠ€æœ¯æ”¶ç›Š</h3>



































<table><thead><tr><th>ç»´åº¦</th><th>æˆæœ</th><th>å…·ä½“æ•°æ®</th></tr></thead><tbody><tr><td><strong>åŒ…ä½“ç§¯</strong></td><td>15MBï¼Œæ˜¯åŒç­‰åŠŸèƒ½ Electron åº”ç”¨çš„ 1/10</td><td>Tauri: 15MB, Electron: 150MB+</td></tr><tr><td><strong>å†…å­˜å ç”¨</strong></td><td>è¿è¡Œæ—¶çº¦ 80MBï¼Œè¿œä½äº Electron çš„ 300MB+</td><td>Tauri: 80MB, Electron: 300MB+</td></tr><tr><td><strong>å¯åŠ¨æ—¶é—´</strong></td><td>ç§’çº§å¯åŠ¨</td><td>å†·å¯åŠ¨: 1.2s, çƒ­å¯åŠ¨: 0.3s</td></tr><tr><td><strong>å®‰å…¨æ€§</strong></td><td>Rust å†…å­˜å®‰å…¨ + Tauri æœ€å°æƒé™</td><td>0 å®‰å…¨æ¼æ´æŠ¥å‘Š</td></tr><tr><td><strong>å¼€å‘æ•ˆç‡</strong></td><td>React ç”Ÿæ€ + Rust å¼ºç±»å‹ï¼Œbug æ›´å°‘</td><td>ç¼–è¯‘æ—¶æ•è· 90% ä»¥ä¸Šé”™è¯¯</td></tr></tbody></table>
<h3 data-id="heading-53">V2.0 å·²å®ŒæˆåŠŸèƒ½</h3>
<ul>
<li>âœ… å¤šæ¨¡å‹ LLM æ¥å…¥ï¼ˆOpenAI/Claude/DeepSeek/360AI/Ollamaï¼‰</li>
<li>âœ… å¯¹è¯å¼æŠ€èƒ½ç”Ÿæˆå‘å¯¼</li>
<li>âœ… æŠ€èƒ½ç®¡ç†ä¸æ‰§è¡Œï¼ˆPrompt/Script/Workflowï¼‰</li>
<li>âœ… Token ä¼˜åŒ–ï¼ˆPrompt åˆ†çº§ã€ä¼šè¯å¤ç”¨ï¼‰</li>
<li>âœ… å·¥ä½œæµå¯è§†åŒ–ç¼–æ’</li>
<li>âœ… å¹³å°å‘å¸ƒï¼ˆæ˜é‡‘ï¼‰</li>
<li>âœ… Agent Skills å…¼å®¹å±‚ï¼ˆåŒå‘è½¬æ¢ã€ç”Ÿæ€äº’é€šï¼‰</li>
</ul>
<h3 data-id="heading-54">V3.0 è§„åˆ’</h3>
<h4 data-id="heading-55">3.1 æŠ€èƒ½å¸‚åœº</h4>
<p><strong>åŠŸèƒ½æè¿°</strong>ï¼š<br/>
åŸºäº GitHub çš„å»ä¸­å¿ƒåŒ–æŠ€èƒ½å¸‚åœºï¼Œç”¨æˆ·å¯ä»¥åˆ†äº«ã€å‘ç°ã€å®‰è£…ç¤¾åŒºæŠ€èƒ½ã€‚</p>
<p><strong>æŠ€æœ¯æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li><strong>æ•°æ®æº</strong>ï¼šGitHub Issues + GitHub Releases</li>
<li><strong>æŠ€èƒ½ç´¢å¼•</strong>ï¼šä½¿ç”¨ GitHub API æœç´¢å¸¦æœ‰ç‰¹å®šæ ‡ç­¾ï¼ˆå¦‚Â <code>smart-toolbox-skill</code>ï¼‰çš„ä»“åº“</li>
<li><strong>å®‰è£…æœºåˆ¶</strong>ï¼šå…‹éš†ä»“åº“åˆ°æœ¬åœ°æŠ€èƒ½ç›®å½•ï¼Œè§£æ SKILL.md</li>
<li><strong>ç‰ˆæœ¬ç®¡ç†</strong>ï¼šåŸºäº Git tag è¿›è¡Œç‰ˆæœ¬æ§åˆ¶</li>
</ul>
<p><strong>æŠ€æœ¯æŒ‘æˆ˜</strong>ï¼š</p>
<ul>
<li>GitHub API é€Ÿç‡é™åˆ¶ï¼ˆ60 æ¬¡/å°æ—¶æœªè®¤è¯ï¼Œ5000 æ¬¡/å°æ—¶å·²è®¤è¯ï¼‰</li>
<li>æŠ€èƒ½å®‰å…¨æ€§éªŒè¯ï¼ˆé˜²æ­¢æ¶æ„ä»£ç ï¼‰</li>
<li>ç½‘ç»œç¯å¢ƒé—®é¢˜ï¼ˆå›½å†…è®¿é—® GitHub ä¸ç¨³å®šï¼‰</li>
</ul>
<p><strong>ç¼“è§£ç­–ç•¥</strong>ï¼š</p>
<ul>
<li>å®ç°æœ¬åœ°ç¼“å­˜æœºåˆ¶ï¼Œå‡å°‘ API è°ƒç”¨</li>
<li>æŠ€èƒ½æ²™ç®±æ‰§è¡Œï¼Œé™åˆ¶æ–‡ä»¶ç³»ç»Ÿè®¿é—®æƒé™</li>
<li>æä¾› Gitee é•œåƒæºä½œä¸ºå¤‡é€‰</li>
</ul>
<h4 data-id="heading-56">3.2 è¿æ¥å™¨ç³»ç»Ÿ</h4>
<p><strong>åŠŸèƒ½æè¿°</strong>ï¼š<br/>
ç»Ÿä¸€çš„å¹³å°æ¥å…¥æ ‡å‡†ï¼Œæ”¯æŒå¿«é€Ÿæ‰©å±•æ–°çš„å‘å¸ƒå¹³å°ã€‚</p>
<p><strong>æŠ€æœ¯æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// è¿æ¥å™¨æ¥å£å®šä¹‰</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">trait</span> <span class="hljs-title class_">PlatformConnector</span> {
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">publish</span>(&amp;<span class="hljs-keyword">self</span>, content: &amp;PublishContent) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;PublishResult&gt;;
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">validate_config</span>(&amp;<span class="hljs-keyword">self</span>, config: &amp;Value) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;()&gt;;
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">get_config_schema</span>(&amp;<span class="hljs-keyword">self</span>) <span class="hljs-punctuation">-&gt;</span> ConfigSchema;
}

<span class="hljs-comment">// è¿æ¥å™¨æ³¨å†Œè¡¨</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">ConnectorRegistry</span> {
    connectors: HashMap&lt;<span class="hljs-type">String</span>, <span class="hljs-type">Box</span>&lt;<span class="hljs-keyword">dyn</span> PlatformConnector&gt;&gt;,
}
</code></pre>
<p><strong>æŠ€æœ¯æŒ‘æˆ˜</strong>ï¼š</p>
<ul>
<li>ä¸åŒå¹³å°çš„è®¤è¯æœºåˆ¶å·®å¼‚ï¼ˆOAuthã€API Keyã€Cookieï¼‰</li>
<li>å†…å®¹æ ¼å¼è½¬æ¢ï¼ˆMarkdown â†’ å„å¹³å°å¯Œæ–‡æœ¬ï¼‰</li>
<li>åçˆ¬è™«æœºåˆ¶åº”å¯¹</li>
</ul>
<p><strong>ç¼“è§£ç­–ç•¥</strong>ï¼š</p>
<ul>
<li>æä¾›ç»Ÿä¸€çš„è®¤è¯æŠ½è±¡å±‚</li>
<li>ä½¿ç”¨ HTML è§£æåº“ï¼ˆå¦‚ scraperï¼‰å¤„ç†å¯Œæ–‡æœ¬</li>
<li>å®ç°è¯·æ±‚é™æµå’Œä»£ç†æ± </li>
</ul>
<h4 data-id="heading-57">3.3 æ›´å¤šå¹³å°æ”¯æŒ</h4>
<p><strong>è®¡åˆ’å¹³å°</strong>ï¼š</p>
<ul>
<li>å¾®ä¿¡å…¬ä¼—å·ï¼ˆéœ€è¦ Cookie è®¤è¯ï¼‰</li>
<li>çŸ¥ä¹ä¸“æ ï¼ˆæ”¯æŒ Markdownï¼‰</li>
<li>CSDNï¼ˆAPI æ¥å£ï¼‰</li>
<li>ç®€ä¹¦ï¼ˆMarkdown æ”¯æŒï¼‰</li>
</ul>
<p><strong>æŠ€æœ¯åˆ†æ</strong>ï¼š</p>
<ul>
<li><strong>å¾®ä¿¡å…¬ä¼—å·</strong>ï¼šéš¾åº¦ â­â­â­â­â­ï¼Œéœ€è¦æ¨¡æ‹Ÿç™»å½•ï¼Œåçˆ¬ä¸¥æ ¼</li>
<li><strong>çŸ¥ä¹</strong>ï¼šéš¾åº¦ â­â­â­ï¼Œæœ‰å®˜æ–¹ APIï¼Œä½†éœ€è¦å¤„ç†éªŒè¯ç </li>
<li><strong>CSDN</strong>ï¼šéš¾åº¦ â­â­ï¼ŒAPI ç›¸å¯¹å¼€æ”¾</li>
<li><strong>ç®€ä¹¦</strong>ï¼šéš¾åº¦ â­â­ï¼Œç›´æ¥æ”¯æŒ Markdown</li>
</ul>
<h4 data-id="heading-58">3.4 å·¥ä½œæµå¢å¼º</h4>
<p><strong>æ–°å¢åŠŸèƒ½</strong>ï¼š</p>
<ul>
<li><strong>å¾ªç¯èŠ‚ç‚¹</strong>ï¼šæ”¯æŒÂ <code>for</code>Â å¾ªç¯ã€<code>while</code>Â å¾ªç¯</li>
<li><strong>å®šæ—¶è§¦å‘</strong>ï¼šCron è¡¨è¾¾å¼æ”¯æŒ</li>
<li><strong>æ¡ä»¶åˆ†æ”¯</strong>ï¼šæ›´å¤æ‚çš„æ¡ä»¶åˆ¤æ–­</li>
<li><strong>å¹¶è¡Œæ‰§è¡Œ</strong>ï¼šå¤šä¸ªèŠ‚ç‚¹å¹¶è¡Œè¿è¡Œ</li>
</ul>
<p><strong>æŠ€æœ¯æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// å¾ªç¯èŠ‚ç‚¹ç¤ºä¾‹</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">LoopNode</span> {
    <span class="hljs-keyword">pub</span> loop_type: LoopType,  <span class="hljs-comment">// For / While</span>
    <span class="hljs-keyword">pub</span> iterations: <span class="hljs-type">Option</span>&lt;<span class="hljs-type">u32</span>&gt;,
    <span class="hljs-keyword">pub</span> condition: <span class="hljs-type">Option</span>&lt;<span class="hljs-type">String</span>&gt;,
    <span class="hljs-keyword">pub</span> body: <span class="hljs-type">Vec</span>&lt;WorkflowNode&gt;,
}

<span class="hljs-comment">// å®šæ—¶è§¦å‘å™¨</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">CronTrigger</span> {
    <span class="hljs-keyword">pub</span> expression: <span class="hljs-type">String</span>,  <span class="hljs-comment">// "0 0 * * *" æ¯å¤©é›¶ç‚¹</span>
    <span class="hljs-keyword">pub</span> timezone: <span class="hljs-type">String</span>,
}
</code></pre>
<p><strong>æŠ€æœ¯æŒ‘æˆ˜</strong>ï¼š</p>
<ul>
<li>å¾ªç¯å¯èƒ½å¯¼è‡´æ— é™æ‰§è¡Œï¼Œéœ€è¦è®¾ç½®è¶…æ—¶</li>
<li>å¹¶è¡Œæ‰§è¡Œçš„çŠ¶æ€åŒæ­¥</li>
<li>Cron è¡¨è¾¾å¼è§£æå’Œè°ƒåº¦</li>
</ul>
<p><strong>ç¼“è§£ç­–ç•¥</strong>ï¼š</p>
<ul>
<li>è®¾ç½®æœ€å¤§å¾ªç¯æ¬¡æ•°å’Œè¶…æ—¶æ—¶é—´</li>
<li>ä½¿ç”¨ Rust çš„Â <code>tokio::spawn</code>Â å®ç°å¹¶è¡Œ</li>
<li>é›†æˆÂ <code>cron</code>Â åº“å¤„ç†å®šæ—¶ä»»åŠ¡</li>
</ul>
<h4 data-id="heading-59">3.5 é£é™©è¯„ä¼°ä¸ä¼˜å…ˆçº§</h4>















































<table><thead><tr><th>åŠŸèƒ½</th><th>é£é™©ç­‰çº§</th><th>ä¼˜å…ˆçº§</th><th>é¢„è®¡å·¥æœŸ</th><th>ä¾èµ–å…³ç³»</th></tr></thead><tbody><tr><td>è¿æ¥å™¨ç³»ç»Ÿ</td><td>ğŸŸ¡ ä¸­</td><td>P0</td><td>3-4 å‘¨</td><td>æ— </td></tr><tr><td>å·¥ä½œæµå¢å¼º</td><td>ğŸŸ¡ ä¸­</td><td>P0</td><td>3-4 å‘¨</td><td>æ— </td></tr><tr><td>æŠ€èƒ½å¸‚åœº</td><td>ğŸ”´ é«˜</td><td>P1</td><td>4-6 å‘¨</td><td>è¿æ¥å™¨ç³»ç»Ÿ</td></tr><tr><td>å…¬ä¼—å·æ”¯æŒ</td><td>ğŸ”´ é«˜</td><td>P2</td><td>2-3 å‘¨</td><td>è¿æ¥å™¨ç³»ç»Ÿ</td></tr><tr><td>çŸ¥ä¹æ”¯æŒ</td><td>ğŸŸ¢ ä½</td><td>P2</td><td>2-3 å‘¨</td><td>è¿æ¥å™¨ç³»ç»Ÿ</td></tr></tbody></table>
<p>å¦‚æœä½ å¯¹ Tauri æ¡Œé¢å¼€å‘æˆ– AI Agent å¼€å‘æ„Ÿå…´è¶£ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºäº¤æµï¼</p>
<hr/>
<p><strong>ç›¸å…³èµ„æº</strong>ï¼š</p>
<ul>
<li>Tauri å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ftauri.app%2F" target="_blank" title="https://tauri.app/" ref="nofollow noopener noreferrer">tauri.app</a></li>
<li>Rust å¼‚æ­¥ç¼–ç¨‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Frust-lang.github.io%2Fasync-book%2F" target="_blank" title="https://rust-lang.github.io/async-book/" ref="nofollow noopener noreferrer">rust-lang.github.io/async-book/</a></li>
<li>shadcn/ui ç»„ä»¶åº“ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fui.shadcn.com%2F" target="_blank" title="https://ui.shadcn.com/" ref="nofollow noopener noreferrer">ui.shadcn.com</a></li>
<li>Agent Skills è§„èŒƒï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.anthropic.com%2Fen%2Fdocs%2Fbuild-with-claude%2Fskills" target="_blank" title="https://docs.anthropic.com/en/docs/build-with-claude/skills" ref="nofollow noopener noreferrer">docs.anthropic.com/en/docs/buiâ€¦</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¸¦ä½ ä»é›¶æ­å»ºå…¨ç½‘çˆ†ç«çš„Clawdbot AIç§äººåŠ©ç†]]></title>    <link>https://juejin.cn/post/7599911091087081472</link>    <guid>https://juejin.cn/post/7599911091087081472</guid>    <pubDate>2026-01-28T01:58:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599911091087081472" data-draft-id="7599911091087065088" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¸¦ä½ ä»é›¶æ­å»ºå…¨ç½‘çˆ†ç«çš„Clawdbot AIç§äººåŠ©ç†"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-28T01:58:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¢¨èˆŸ"/> <meta itemprop="url" content="https://juejin.cn/user/1398234520494366"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¸¦ä½ ä»é›¶æ­å»ºå…¨ç½‘çˆ†ç«çš„Clawdbot AIç§äººåŠ©ç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1398234520494366/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¢¨èˆŸ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T01:58:35.000Z" title="Wed Jan 28 2026 01:58:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Clawdbotï¼Œæ¯«æ— ç–‘é—®æ˜¯è¿™å‡ å¤©æŠ€æœ¯åœˆæœ€ç«çˆ†çš„äº§å“ï¼ŒçŸ­çŸ­å‡ å¤©æ—¶é—´github startå·²ç»åˆ°äº†ææ€–çš„70käº†ã€‚ <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c249f60f16e74810a013e0f602b33b4b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=ufXanQF4kVIV1j3WUSI7JpM2lj4%3D" alt="" loading="lazy"/> ç”šè‡³å¸¦ç«äº†Mac miniï¼Œæœ‰äººç›´æ¥ä¹°äº†12ä¸ªï¼Œè¦æ‰“é€ æ•°å­—å‘˜å·¥é˜Ÿä¼ã€‚ <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d588c9483768438a92ed3eb18f168351~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=de7ouwF7aH%2Bh8pnBtGlIuT9Vz1A%3D" alt="" loading="lazy"/> æ‰€ä»¥Clawdbotåˆ°åº•æ˜¯ä»€ä¹ˆï¼Œç®€å•æ¥è¯´æ˜¯ä¸€ä¸ªå¼€æºçš„AIåŠ©æ‰‹ï¼Œå¯ä»¥è¿è¡Œåœ¨è‡ªå·±çš„è®¾å¤‡ï¼ˆMacã€Windowsã€Linuxï¼‰ä¸Šï¼Œå¯ä»¥æ¥å…¥èŠå¤©è¿ç”¨ï¼Œæ¯”å¦‚Telegramã€WhatsAppã€Discordç­‰ç­‰ï¼Œç„¶åç›´æ¥åœ¨èŠå¤©åº”ç”¨ä¸­å¯¹è¯å‘æŒ‡ä»¤å°±å¯ä»¥ï¼ŒClawdbotå°±ä¼š7*24å°æ—¶çš„ä¸ºä½ å·¥ä½œäº†ã€‚</p>
<p>Clawdbotä¹‹æ‰€ä»¥çˆ†çº¢çš„ä¸€ä¸ªåŸå› æ˜¯å®ƒå¯ä»¥è¿è¡Œåœ¨è‡ªå·±çš„ç¯å¢ƒä¸­ï¼Œäº¤äº’æ–¹å¼å›å½’ç”¨æˆ·ç†Ÿæ‚‰çš„èŠå¤©åº”ç”¨ã€‚å¹¶ä¸”æ‹¥æœ‰å®Œæ•´çš„æ“ä½œæƒé™å’Œè¶…é•¿è®°å¿†ï¼Œä¸€ä¸ªä¸“å±äºä¸ªäººçš„AIåŠ©ç†ï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒæ•°æ®é—®é¢˜äº†ã€‚æ¥ä¸‹æ¥å¼€å§‹ä¸€æ­¥ä¸€æ­¥æ­å»ºClawdbotã€‚æˆ‘ä½¿ç”¨çš„æ˜¯ä¸€å°é—²ç½®çš„ Macbook intelèŠ¯ç‰‡çš„ç”µè„‘ã€‚</p>
<p><strong>1ã€è¿è¡Œç»ˆç«¯å‘½ä»¤</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">curl -fsSL https:<span class="hljs-comment">//clawd.bot/install.sh | bash</span>
</code></pre>
<p>è£…å¿…è¦çš„ä¾èµ–ï¼Œè¿™é‡Œè®°å¾—è¦æ‰“å¼€ç§‘å­¦ä¸Šç½‘ã€‚</p>
<p><strong>2ã€å¿«é€Ÿé…ç½®å‘½ä»¤</strong></p>
<pre><code class="hljs language-css" lang="css">clawdbot onboard <span class="hljs-attr">--flow</span> quickstart
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb09c7501ca64304ac9ab2c027644e48~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=2PO8OJxlqFvu1AztJk%2FbD7hDr1M%3D" alt="Snipaste_2026-01-27_21-34-17" loading="lazy"/></p>
<p>Snipaste_2026-01-27_21-34-17</p>
<p>é€‰æ‹©yesï¼Œ æ¥ä¸‹æ¥æŒ‰ç…§æ­¥éª¤ä¸€æ­¥ä¸€æ­¥æ‰§è¡Œ é€‰æ‹©æ¨¡å‹ï¼ŒåŸºæœ¬ä¸Šå¸‚é¢ä¸Šæ‰€æœ‰çš„ä¸»æµæ¨¡å‹éƒ½æ”¯æŒäº†ï¼Œé€‰æ‹©ä¸€ä¸ªè‡ªå·±æœ‰åœ¨ç”¨çš„æ¨¡å‹ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©Anthropicï¼Œå¦‚æœåªæ˜¯ç®€å•ä½¿ç”¨å¯ä»¥é€‰Qwenï¼Œä¾¿å®œï¼Œå¤Ÿç”¨ <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/989a533a334e413f9beb91a046a350b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=FG5T3LlC9keD08uWgVSO8OHEfO4%3D" alt="2" loading="lazy"/></p>
<p><strong>3ã€æˆæƒç™»å½•</strong> <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b265592948fd4194b01ab90b63275ebc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=zuJcuVzWYO0e%2FGqZrsfiSFErmLs%3D" alt="3" loading="lazy"/></p>
<p><strong>4ã€é…ç½®Telegramæœºå™¨äºº</strong> <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1dfd456e2d4b49a7a7853a3cd28e1733~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=Fx7hXzU1F%2B3%2FZ9MXXVpiMpRqEhM%3D" alt="4" loading="lazy"/> <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7b837a9604a7486b9fb22176bef6793c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=wgm6iVxrWG4%2BqFXr4n9wdWD8LTI%3D" alt="5" loading="lazy"/> æ‰“å¼€ä½ çš„Telegramï¼Œæœç´¢ â€œ@BotFatherâ€ å‘é€ /bewbotï¼Œä¸€æ­¥ä¸€æ­¥å¡«å†™æœºå™¨äººåç§°ç­‰ä¿¡æ¯ <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ac4d742deffe4b53a14eb397aa4fbc46~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=Ldfu2IB1K5ZiofVXewVG%2B%2FEaBTU%3D" alt="5.5" loading="lazy"/> æœ€åå°†tokenå¤åˆ¶åˆ°ç»ˆç«¯è¾“å…¥</p>
<p><strong>4ã€é…ç½®skillså’Œhooks</strong></p>
<p>è¿™ä¸€æ­¥å¯é€‰ï¼ŒæŒ‰è‡ªå·±è¦æ±‚æ¥ <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bfeb9dec17cb47cbbd94eba7ff09de38~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=8p8E6IdRGux7CmM5yVIXzgNkUms%3D" alt="6" loading="lazy"/> <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0b84fc2f23e5443b9dd5c20e8d1e3026~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=ZTj62gCtbDATwVYjFGn73J3ARKo%3D" alt="7" loading="lazy"/></p>
<p><strong>6ã€æ£€æŸ¥æ˜¯å¦å®‰è£…æ­£å¸¸</strong> æµè§ˆå™¨æ‰“å¼€ï¼š<a href="https://link.juejin.cn?target=http%3A%2F%2F127.0.0.1%3A18789%2C%25E6%2598%25AF%25E4%25B8%25AA%25E5%258F%25AF%25E8%25A7%2586%25E5%258C%2596%25E7%259A%2584%25E9%25A1%25B5%25E9%259D%25A2" target="_blank" title="http://127.0.0.1:18789,%E6%98%AF%E4%B8%AA%E5%8F%AF%E8%A7%86%E5%8C%96%E7%9A%84%E9%A1%B5%E9%9D%A2" ref="nofollow noopener noreferrer">http://127.0.0.1:18789,æ˜¯ä¸ªå¯è§†åŒ–çš„é¡µé¢</a> <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55b1b989161a4e259c7ed318577dbd31~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=DtOKlYEpStH0bftWwyjrsvF7y7w%3D" alt="9" loading="lazy"/></p>
<p><strong>7ã€Telegramé…å¯¹</strong></p>
<p>æ‰“å¼€Telegramï¼Œå’Œåˆšåˆšåˆ›å»ºçš„æœºå™¨äººè¾“å…¥ /start, ä¼šå‡ºç°ä¸€ä¸ªé…å¯¹ç  <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa7423fb3aef49c480edfa96c961e274~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=lfzfLhuD%2BUwMbtpQB38Uxlnq3TA%3D" alt="" loading="lazy"/></p>
<p>ç»ˆç«¯æ‰§è¡Œ</p>
<pre><code class="hljs">clawdbot pairing approve telegram Qxx
</code></pre>
<p><strong>æ³¨æ„ï¼šæç¤ºç½‘å…³è¿æ¥å¤±è´¥</strong> <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/265f74e619fa4e4ba680c3baff93ae56~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=dOwkUZ6mzPGn3jHx4CteTuB%2BCGM%3D" alt="" loading="lazy"/> è¿™æ—¶å€™æ£€æŸ¥ä¸‹ï¼Œtelegram apiæ˜¯å¦å¯ä»¥è®¿é—®ï¼Œå¤§æ¦‚ç‡æ˜¯å› ä¸ºç½‘ç»œåŸå› </p>
<pre><code class="hljs language-arduino" lang="arduino">curl -I https:<span class="hljs-comment">//api.telegram.org</span>
</code></pre>
<p>åˆ°è¿™é‡Œï¼Œæ‰€æœ‰çš„é…ç½®å°±å·²ç»å®Œæˆäº†ã€‚å¯ä»¥ç»™ä½ çš„æœºå™¨äººå‘é€æŒ‡ä»¤ï¼Œä½ çš„7*24å°æ—¶ç§äººåŠ©ç†ä¸Šçº¿äº†ï¼Œå¿«å»æ‰“é€ ä½ çš„æ•°å­—å‘˜å·¥å›¢é˜Ÿå§</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Anthropic é»‘å®¢æ¾å† å†›çš„ Claude Code æœ€ä½³å®è·µï¼Œå»ºè®®ç¨‹åºå‘˜å…¨å‘˜æ”¶è—ï¼]]></title>    <link>https://juejin.cn/post/7599852042531143690</link>    <guid>https://juejin.cn/post/7599852042531143690</guid>    <pubDate>2026-01-28T02:10:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599852042531143690" data-draft-id="7599922362998505518" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Anthropic é»‘å®¢æ¾å† å†›çš„ Claude Code æœ€ä½³å®è·µï¼Œå»ºè®®ç¨‹åºå‘˜å…¨å‘˜æ”¶è—ï¼"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-28T02:10:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‚Ÿé¸£"/> <meta itemprop="url" content="https://juejin.cn/user/4107431171852270"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Anthropic é»‘å®¢æ¾å† å†›çš„ Claude Code æœ€ä½³å®è·µï¼Œå»ºè®®ç¨‹åºå‘˜å…¨å‘˜æ”¶è—ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4107431171852270/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‚Ÿé¸£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:10:30.000Z" title="Wed Jan 28 2026 02:10:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¦‚æœä½ æ˜¯ç¨‹åºå‘˜ï¼Œä½ æœ€è¿‘åœ¨æ€è€ƒå¦‚ä½•é€šè¿‡ç¼–å†™æ›´ä¸“ä¸šçš„ Â commandsã€agentsã€rulesã€skills Â æ¥æå‡è‡ªå·±æˆ–å›¢é˜Ÿçš„ AI Coding æ•ˆæœã€‚</p>
<p>æœ¬æ–‡ä»‹ç»çš„è¿™ä¸ªä»“åº“ï¼Œä½ ä¸€å®šä¸èƒ½é”™è¿‡ï¼ï¼</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b0fe34f6517840feacdcc08eb5b98ade~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=bOyVN0FOjFvFXaRvbKQAgpBsDkU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä½œè€…æ˜¯ @affaanmustafaï¼Œ2025 å¹´9æœˆä»½ï¼Œä»–çº½çº¦çš„ Anthropic x Forum Ventures é»‘å®¢æ¾ä¸­æ‹¿ä¸‹å† å†›ï¼Œèµ¢å¾—äº† 1.5 ä¸‡ç¾é‡‘ç­‰å€¼çš„ Anthropic API é¢åº¦ï¼</p>
<p>ä»–è¿‘æ—¥å…¬å¼€äº†è‡ªå·±ä½¿ç”¨ Claude Code Â çš„â€œæœ€ä½³å®è·µâ€ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc67aafa08b7412d951ad37482890a92~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=KlVF%2FCto6%2FABJDEr6EQ187Y6gJo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Github åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Faffaan-m%2Feverything-claude-code%3Ftab%3Dreadme-ov-file" target="_blank" title="https://github.com/affaan-m/everything-claude-code?tab=readme-ov-file" ref="nofollow noopener noreferrer">github.com/affaan-m/evâ€¦</a></p>
<pre><code class="hljs language-perl" lang="perl">everything-claude-code/
|-- .claude-plugin/ Â Â <span class="hljs-comment"># Plugin and marketplace manifests</span>
| Â  |-- plugin.json Â  Â  Â  Â Â <span class="hljs-comment"># Plugin metadata and component paths</span>
| Â  |-- marketplace.json Â  Â <span class="hljs-comment"># Marketplace catalog for /plugin marketplace add</span>
|
|-- agents/ Â  Â  Â  Â  Â Â <span class="hljs-comment"># Specialized subagents for delegation</span>
| Â  |-- planner.md Â  Â  Â  Â  Â Â <span class="hljs-comment"># Feature implementation planning</span>
| Â  |-- architect.md Â  Â  Â  Â Â <span class="hljs-comment"># System design decisions</span>
| Â  |-- tdd-guide.md Â  Â  Â  Â Â <span class="hljs-comment"># Test-driven development</span>
| Â  |-- code-reviewer.md Â  Â Â <span class="hljs-comment"># Quality and security review</span>
| Â  |-- security-reviewer.mdÂ <span class="hljs-comment"># Vulnerability analysis</span>
| Â  |-- build-error-resolver.md
| Â  |-- e2e-runner.md Â  Â  Â  Â <span class="hljs-comment"># Playwright E2E testing</span>
| Â  |-- refactor-cleaner.md Â <span class="hljs-comment"># Dead code cleanup</span>
| Â  |-- doc-updater.md Â  Â  Â Â <span class="hljs-comment"># Documentation sync</span>
|
|-- skills/ Â  Â  Â  Â  Â Â <span class="hljs-comment"># Workflow definitions and domain knowledge</span>
| Â  |-- coding-standards/ Â  Â  Â  Â  Â Â <span class="hljs-comment"># Language best practices</span>
| Â  |-- backend-patterns/ Â  Â  Â  Â  Â Â <span class="hljs-comment"># API, database, caching patterns</span>
| Â  |-- frontend-patterns/ Â  Â  Â  Â  Â <span class="hljs-comment"># React, Next.js patterns</span>
| Â  |-- continuous-learning/ Â  Â  Â  Â <span class="hljs-comment"># Auto-extract patterns from sessions (Longform Guide)</span>
| Â  |-- strategic-compact/ Â  Â  Â  Â  Â <span class="hljs-comment"># Manual compaction suggestions (Longform Guide)</span>
| Â  |-- tdd-workflow/ Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># TDD methodology</span>
| Â  |-- security-review/ Â  Â  Â  Â  Â  Â <span class="hljs-comment"># Security checklist</span>
| Â  |--Â <span class="hljs-keyword">eval</span>-harness/ Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># Verification loop evaluation (Longform Guide)</span>
| Â  |-- verification-loop/ Â  Â  Â  Â  Â <span class="hljs-comment"># Continuous verification (Longform Guide)</span>
|
|-- commands/ Â  Â  Â  Â Â <span class="hljs-comment"># Slash commands for quick execution</span>
| Â  |-- tdd.md Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment"># /tdd - Test-driven development</span>
| Â  |-- plan.md Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># /plan - Implementation planning</span>
| Â  |-- e2e.md Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment"># /e2e - E2E test generation</span>
| Â  |-- code-review.md Â  Â  Â <span class="hljs-comment"># /code-review - Quality review</span>
| Â  |-- build-fix.md Â  Â  Â  Â <span class="hljs-comment"># /build-fix - Fix build errors</span>
| Â  |-- refactor-clean.md Â Â <span class="hljs-comment"># /refactor-clean - Dead code removal</span>
| Â  |-- learn.md Â  Â  Â  Â  Â  Â <span class="hljs-comment"># /learn - Extract patterns mid-session (Longform Guide)</span>
| Â  |-- checkpoint.md Â  Â  Â Â <span class="hljs-comment"># /checkpoint - Save verification state (Longform Guide)</span>
| Â  |-- verify.md Â  Â  Â  Â  Â Â <span class="hljs-comment"># /verify - Run verification loop (Longform Guide)</span>
| Â  |-- setup-pm.md Â  Â  Â  Â Â <span class="hljs-comment"># /setup-pm - Configure package manager (NEW)</span>
|
|-- rules/ Â  Â  Â  Â  Â  Â <span class="hljs-comment"># Always-follow guidelines (copy to ~/.claude/rules/)</span>
| Â  |-- security.md Â  Â  Â  Â Â <span class="hljs-comment"># Mandatory security checks</span>
| Â  |-- coding-style.md Â  Â Â <span class="hljs-comment"># Immutability, file organization</span>
| Â  |-- testing.md Â  Â  Â  Â  Â <span class="hljs-comment"># TDD, 80% coverage requirement</span>
| Â  |-- git-workflow.md Â  Â Â <span class="hljs-comment"># Commit format, PR process</span>
| Â  |-- agents.md Â  Â  Â  Â  Â Â <span class="hljs-comment"># When to delegate to subagents</span>
| Â  |-- performance.md Â  Â  Â <span class="hljs-comment"># Model selection, context management</span>
|
|-- hooks/ Â  Â  Â  Â  Â  Â <span class="hljs-comment"># Trigger-based automations</span>
| Â  |-- hooks.json Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment"># All hooks config (PreToolUse, PostToolUse, Stop, etc.)</span>
| Â  |-- memory-persistence/ Â  Â  Â Â <span class="hljs-comment"># Session lifecycle hooks (Longform Guide)</span>
| Â  |-- strategic-compact/ Â  Â  Â  Â <span class="hljs-comment"># Compaction suggestions (Longform Guide)</span>
|
|-- scripts/ Â  Â  Â  Â  Â <span class="hljs-comment"># Cross-platform Node.js scripts (NEW)</span>
| Â  |-- lib/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># Shared utilities</span>
| Â  | Â  |-- utils.js Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># Cross-platform file/path/system utilities</span>
| Â  | Â  |-- <span class="hljs-keyword">package</span>-manager.js Â Â <span class="hljs-comment"># Package manager detection and selection</span>
| Â  |-- hooks/ Â  Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># Hook implementations</span>
| Â  | Â  |-- session-start.js Â  Â Â <span class="hljs-comment"># Load context on session start</span>
| Â  | Â  |-- session-end.js Â  Â  Â Â <span class="hljs-comment"># Save state on session end</span>
| Â  | Â  |-- pre-compact.js Â  Â  Â Â <span class="hljs-comment"># Pre-compaction state saving</span>
| Â  | Â  |-- suggest-compact.js Â Â <span class="hljs-comment"># Strategic compaction suggestions</span>
| Â  | Â  |-- evaluate-session.js Â <span class="hljs-comment"># Extract patterns from sessions</span>
| Â  |-- setup-<span class="hljs-keyword">package</span>-manager.jsÂ <span class="hljs-comment"># Interactive PM setup</span>
|
|-- tests/ Â  Â  Â  Â  Â  Â <span class="hljs-comment"># Test suite (NEW)</span>
| Â  |-- lib/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># Library tests</span>
| Â  |-- hooks/ Â  Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># Hook tests</span>
| Â  |-- run-all.js Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># Run all tests</span>
|
|-- contexts/ Â  Â  Â  Â Â <span class="hljs-comment"># Dynamic system prompt injection contexts (Longform Guide)</span>
| Â  |-- dev.md Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment"># Development mode context</span>
| Â  |-- review.md Â  Â  Â  Â  Â Â <span class="hljs-comment"># Code review mode context</span>
| Â  |-- research.md Â  Â  Â  Â Â <span class="hljs-comment"># Research/exploration mode context</span>
|
|-- examples/ Â  Â  Â  Â Â <span class="hljs-comment"># Example configurations and sessions</span>
| Â  |-- CLAUDE.md Â  Â  Â  Â  Â Â <span class="hljs-comment"># Example project-level config</span>
| Â  |-- user-CLAUDE.md Â  Â  Â <span class="hljs-comment"># Example user-level config</span>
|
|-- mcp-configs/ Â  Â  Â <span class="hljs-comment"># MCP server configurations</span>
| Â  |-- mcp-servers.json Â  Â <span class="hljs-comment"># GitHub, Supabase, Vercel, Railway, etc.</span>
|
|-- marketplace.json Â <span class="hljs-comment"># Self-hosted marketplace config (for /plugin marketplace add)</span>
</code></pre>
<p><strong>æ ¸å¿ƒæ€æƒ³</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a843e321179f45f885a81439f1917dd3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=JpXoBT2TOR%2BBakLppObjez5qTRw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>æŠŠ Claude Code å½“æˆé•¿æœŸåˆä¼™äººï¼Œç”¨é…ç½®ã€Œè½»é‡å¾®è°ƒã€è€Œä¸æ˜¯é€ å¤æ‚æ¶æ„ï¼Œé‡ç‚¹æ˜¯å‡å°‘é‡å¤ã€ä¿æŠ¤ä¸Šä¸‹æ–‡ã€è®©å¹¶è¡Œå¼€å‘æ›´é«˜æ•ˆã€‚</li>
<li>æ§åˆ¶å¯ç”¨çš„ MCP / æ’ä»¶æ•°é‡ï¼Œé¿å…å·¥å…·å¤ªå¤šæŠŠä¸Šä¸‹æ–‡çª—å£æŒ¤çˆ†ï¼Œå½±å“æ€§èƒ½ã€‚</li>
</ul>
<p><strong>Skills / Commands</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d14d03ab65f748f3b3cdb7541590b839~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=2ax9Csk8fhQv4l1DHjRMNifAHVM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>Skills å°±æ˜¯å¯å¤ç”¨çš„å·¥ä½œæµæç¤ºè¯ï¼Œé™å®šåœ¨ç‰¹å®šåœºæ™¯ï¼Œæ¯”å¦‚Â <code>/refactor-clean</code>Â æ¸…ç†æ­»ä»£ç å’Œé›¶æ•£ mdï¼Œ<code>/tdd</code>ã€<code>/e2e</code>ã€<code>/test-coverage</code>Â è´Ÿè´£æµ‹è¯•æµç¨‹ï¼Œå¯ä»¥åœ¨ä¸€æ¬¡æç¤ºé‡Œé“¾å¼ç»„åˆå¤šä¸ªå‘½ä»¤ã€‚</li>
<li>Skills ä»¥ markdown æ–‡ä»¶å­˜æ”¾åœ¨Â <code>~/.claude/skills</code>ï¼ŒCommands åˆ™æ˜¯ä»¥ã€Œæ–œæ å‘½ä»¤ã€æ–¹å¼å¿«é€Ÿæ‰§è¡Œï¼Œå­˜æ”¾åœ¨Â <code>~/.claude/commands</code>ã€‚</li>
</ul>
<p><strong>Hooksï¼ˆé’©å­è‡ªåŠ¨åŒ–ï¼‰</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6fd4ce07129a45a1beb3b112941535af~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=mkZ1p4DfNQCkyIRQ%2Be8gsTBZE5w%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>Hooks æ˜¯åŸºäºäº‹ä»¶çš„è‡ªåŠ¨åŒ–ï¼Œè§¦å‘ç‚¹åŒ…æ‹¬ï¼šå·¥å…·è°ƒç”¨å‰åã€ç”¨æˆ·å‘æ¶ˆæ¯æ—¶ã€Claude å›ç­”ç»“æŸã€å‹ç¼©ä¸Šä¸‹æ–‡å‰ï¼Œä»¥åŠæƒé™é€šçŸ¥ç­‰ã€‚</li>
<li>ç¤ºä¾‹ï¼šåœ¨æ‰§è¡Œ npm / pytest ç­‰é•¿å‘½ä»¤ä¹‹å‰æé†’ä½ ç”¨ tmuxï¼›PostToolUse è‡ªåŠ¨è·‘ Prettierã€TypeScript æ£€æŸ¥ï¼Œæˆ–è€…åœ¨ä¼šè¯ç»“æŸå‰è‡ªåŠ¨æ‰«æÂ <code>console.log</code>ã€‚</li>
<li>æ¨èç”¨Â <code>hookify</code>Â æ’ä»¶ç”¨è‡ªç„¶è¯­è¨€ç”Ÿæˆ Hookï¼Œè€Œä¸æ˜¯æ‰‹å†™ JSONã€‚</li>
</ul>
<p><strong>Subagentsï¼ˆå­ä»£ç†ï¼‰</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2e8325be71894fd3ae77bda32ca1fec3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=oQ1cJOJP8gOFaCzclWhAUtVio9g%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>Subagents æ˜¯ç”±ä¸» Claude è°ƒåº¦çš„å­è¿›ç¨‹ï¼Œè´Ÿè´£æŸä¸€ç±»ä»»åŠ¡ï¼ˆå¦‚ plannerã€architectã€tdd-guideã€code-reviewerã€security-reviewer ç­‰ï¼‰ï¼Œå¯ä»¥å‰å°æˆ–åå°è·‘ï¼Œéš”ç¦»æƒé™ã€èŠ‚çº¦ä¸»ä¼šè¯ä¸Šä¸‹æ–‡ã€‚</li>
<li>æ¯ä¸ªå­ä»£ç†åªå¼€æ”¾æœ‰é™çš„å·¥å…· / MCPï¼Œä½¿å…¶ä¸“æ³¨äºä¸€å°å—èŒè´£ï¼Œæ¯”å¦‚ä¸“é—¨è·‘ e2eã€è§£å†³ build é”™è¯¯æˆ–åš refactor-cleanã€‚</li>
</ul>
<p><strong>è§„åˆ™ä¸è®°å¿†</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c6d93b3192994fb7836a1d83b1bb475f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=15N2azfY7UCTes1zWPFxWcohH%2Fc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li><code>~/.claude/rules</code>Â é‡Œæ”¾ã€Œæ°¸è¿œè¦éµå®ˆã€çš„æœ€ä½³å®è·µï¼Œå¯ä»¥æ˜¯å•ä¸€Â <code>CLAUDE.md</code>ï¼Œä¹Ÿå¯ä»¥æ˜¯æŒ‰å®‰å…¨ã€ä»£ç é£æ ¼ã€æµ‹è¯•ã€Git å·¥ä½œæµã€agentsã€æ€§èƒ½ç­‰æ‹†åˆ†çš„å¤šæ–‡ä»¶ç»“æ„ã€‚</li>
<li>è§„åˆ™å†…å®¹åŒ…æ‹¬ï¼šç¦æ­¢ä»£ç ä¸­ emojiã€å‰ç«¯é¿å…ç´«è‰²ã€å¿…é¡»å…ˆæµ‹è¯•å†éƒ¨ç½²ã€ä¼˜å…ˆæ¨¡å—åŒ–ã€ç¦æ­¢æäº¤Â <code>console.log</code>Â ç­‰ï¼Œä¸ºæ•´ä¸ªé¡¹ç›®å®šä¸‹ç»Ÿä¸€è¡Œä¸ºå‡†åˆ™ã€‚</li>
</ul>
<p><strong>MCPï¼ˆModel Context Protocolï¼‰</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55834ca8ba354027818b3ed085346135~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=ywhs%2F%2FDZJcA3mo3p7%2B179A9ejyA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>MCP æ˜¯æŠŠå¤–éƒ¨æœåŠ¡ã€ŒæŒ‚æ¥ã€åˆ° Claude çš„åè®®ï¼Œæœ¬è´¨æ˜¯å¯¹ API çš„é«˜å±‚å°è£…ï¼Œæ–¹ä¾¿å¯¹æ•°æ®åº“ã€éƒ¨ç½²å¹³å°ã€Supabase ç­‰è¿›è¡ŒæŸ¥è¯¢ä¸æ“ä½œï¼Œæ¯”å¦‚ Supabase MCP å¯ç›´æ¥åˆ—è¡¨ã€è·‘ SQLã€‚</li>
<li>Chrome MCP è®© Claude èƒ½è‡ªä¸»åœ¨æµè§ˆå™¨é‡Œç‚¹å‡»ã€æŸ¥çœ‹é¡µé¢ï¼Œæå‡æ¢ç´¢èƒ½åŠ›ï¼›ä½† MCP / å·¥å…·è¿‡å¤šä¼šæå¤§æ¶ˆè€—ä¸Šä¸‹æ–‡ï¼Œå› æ­¤å»ºè®®é…ç½® 20â€“30 ä¸ª MCPï¼Œä½†æ¯ä¸ªé¡¹ç›®åªå¯ç”¨ 5â€“10 ä¸ªã€å°‘äºçº¦ 80 ä¸ªå·¥å…·ã€‚</li>
</ul>
<p><strong>æ’ä»¶ï¼ˆPluginsï¼‰</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f1acd28c3e3f44318465e68022fa6797~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=cIVcRX8vGbab6GTMAAunibXrQoY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>æ’ä»¶æ˜¯ã€Œæ‰“åŒ…å¥½çš„å·¥å…·é›†ã€ï¼Œå¯ä»¥åŒ…å« skill + MCP + hooks ç­‰ï¼Œé¿å…æ‰‹å·¥é…ç½®ï¼›å¯ä»¥é€šè¿‡ marketplace åœ°å€æ·»åŠ åï¼Œåœ¨Â <code>/plugins</code>Â ç•Œé¢å®‰è£…ï¼Œæ¯”å¦‚Â <code>mgrep</code>Â æä¾›æ¯” ripgrep æ›´å¥½çš„æœç´¢ã€‚</li>
<li>LSP ç±»æ’ä»¶ï¼ˆå¦‚ typescript-lspã€pyright-lspï¼‰åœ¨æ²¡æœ‰ IDE çš„æƒ…å†µä¸‹æä¾›ç±»å‹æ£€æŸ¥å’Œè·³è½¬èƒ½åŠ›ï¼Œä½†åŒæ ·è¦æ³¨æ„å®ƒä»¬å¯¹ä¸Šä¸‹æ–‡çª—å£çš„å½±å“ã€‚</li>
</ul>
<p><strong>æ•ˆç‡ Tips</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1a181d8b70334620a8ed529614d06de2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=ei8B6lrOwcdlEI3LqJKgBLQ%2F%2FdE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>å¿«æ·é”®ï¼š<code>Ctrl+U</code>Â åˆ æ•´è¡Œã€<code>!</code>Â å¿«é€Ÿ shell å‘½ä»¤ã€<code>@</code>Â æœç´¢æ–‡ä»¶ã€<code>/</code>Â è¿›å…¥å‘½ä»¤ã€Shift+Enter å¤šè¡Œè¾“å…¥ã€Tab æŸ¥çœ‹æ€è€ƒã€Esc Esc ä¸­æ–­æ‰§è¡Œç­‰ã€‚</li>
<li>å¹¶è¡Œï¼šç”¨Â <code>/fork</code>Â åˆ†å‰å¯¹è¯å¤„ç†äº’ä¸å½±å“çš„ä»»åŠ¡ï¼Œé…åˆ Git worktree ä¸ºä¸åŒåˆ†æ”¯å¼€ç‹¬ç«‹ Claude å®ä¾‹ï¼›ç”¨ tmux è·‘é•¿æ—¶é—´çš„å‰åç«¯æœåŠ¡å¹¶å®æ—¶çœ‹æ—¥å¿—ã€‚</li>
<li><code>mgrep</code>Â æ”¯æŒæœ¬åœ°å’ŒÂ <code>--web</code>Â æœç´¢ï¼›å…¶å®ƒæœ‰ç”¨å‘½ä»¤åŒ…æ‹¬Â <code>/rewind</code>Â å›åˆ°ä¹‹å‰çŠ¶æ€ã€<code>/statusline</code>Â å®šåˆ¶çŠ¶æ€æ ã€<code>/checkpoints</code>Â æ–‡ä»¶çº§æ’¤é”€ç‚¹ã€<code>/compact</code>Â æ‰‹åŠ¨å‹ç¼©ä¸Šä¸‹æ–‡ã€‚</li>
</ul>
<p><strong>ç¼–è¾‘å™¨ä¸å·¥ä½œæµ</strong><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c063a05640df4b4ba1cd57b101a65656~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=oIopvyAbzG9J5Zj6LvhQvscUmO4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>ä½œè€…åå¥½ Zedï¼šRust å†™çš„è½»é‡ç¼–è¾‘å™¨ï¼Œå’Œ Claude æ·±åº¦é›†æˆï¼Œæœ‰ Agent é¢æ¿ã€å®æ—¶æ–‡ä»¶è¿½è¸ªã€å‘½ä»¤é¢æ¿ï¼ˆCMD+Shift+Rï¼‰ã€ä½èµ„æºå ç”¨ã€æ”¯æŒ Vim æ¨¡å¼ç­‰ã€‚</li>
<li>æ¨èå¸ƒå±€ï¼šå·¦è¾¹ç»ˆç«¯è·‘ Claude Codeï¼Œå³è¾¹ Zedï¼›å¯ç”¨è‡ªåŠ¨ä¿å­˜ã€æ–‡ä»¶ç›‘å¬ä»¥åŠ Git é›†æˆï¼Œç”¨ç¼–è¾‘å™¨å®¡æŸ¥ Claude çš„æ”¹åŠ¨åå†æäº¤ã€‚</li>
<li>VSCode / Cursor ä¹Ÿå¯ä»¥ï¼Œé€šè¿‡ç»ˆç«¯ +Â <code>\ide</code>Â åŒæ­¥æˆ–è£…å®˜æ–¹æ‰©å±•è·å¾—ç±»ä¼¼æ•ˆæœã€‚</li>
</ul>
<p><strong>ä½œè€…è‡ªå·±çš„ Setup</strong><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f9512be3598540caa13167ddd6e52cbc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=FNp9EuQxrRdGgRBD71OZUTAnMEc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>æ’ä»¶ï¼šå®‰è£…äº†åå‡ ä¸ªï¼ˆå¦‚ ralph-wiggumã€frontend-designã€commit-commandsã€security-guidanceã€pr-review-toolkitã€typescript-lspã€pyright-lspã€hookifyã€mgrep ç­‰ï¼‰ï¼Œä½†é€šå¸¸åªåŒæ—¶å¯ç”¨ 4â€“5 ä¸ªã€‚</li>
<li>MCPï¼šé…ç½®äº† GitHubã€Firecrawlã€Supabaseã€memoryã€sequential-thinkingã€Vercelã€Railwayã€Cloudflare ç³»åˆ—ã€ClickHouseã€Abletonã€Magic ç­‰çº¦ 14 ä¸ªï¼Œé€šè¿‡Â <code>disabledMcpServers</code>Â é’ˆå¯¹ä¸åŒé¡¹ç›®ç¦ç”¨ä¸€éƒ¨åˆ†ï¼Œä»è€Œæ§åˆ¶ä¸Šä¸‹æ–‡å ç”¨ã€‚</li>
<li>è¿˜æœ‰è‡ªå®šä¹‰çŠ¶æ€æ ï¼ˆå±•ç¤ºç”¨æˆ·ã€ç›®å½•ã€åˆ†æ”¯ã€è„æ ‡è®°ã€å‰©ä½™ä¸Šä¸‹æ–‡ç™¾åˆ†æ¯”ã€æ¨¡å‹ã€æ—¶é—´ã€å¾…åŠæ•°ï¼‰ï¼Œæ¸…æ™°çš„ rules / agents ç›®å½•ç»“æ„ä»¥åŠä¸€ç»„å…³é”® Hooksï¼Œä½¿æ•´ä¸ªå¼€å‘å’Œåä½œæµç¨‹é«˜åº¦è‡ªåŠ¨åŒ–ã€‚</li>
</ul>
<p><strong>æœ€åçš„å‡ ç‚¹è¦è¯€</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/18afd59ee0074aabad8c0d375da5e837~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=mM5kRmkj5I9S6IeZakLySRXaKDU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>é…ç½®æ˜¯ã€Œè½»é‡å¾®è°ƒã€ï¼Œåˆ«è¿‡åº¦å¤æ‚åŒ–ã€‚</li>
<li>ä¸Šä¸‹æ–‡æ˜¯<strong>ç¨€ç¼º</strong>èµ„æºï¼Œè¦æŒç»­å…³æ‰ä¸ç”¨çš„ MCP / æ’ä»¶ã€‚</li>
<li>åˆ©ç”¨å¹¶è¡Œæ‰§è¡Œï¼ˆfork å¯¹è¯ã€worktreeï¼‰ã€è‡ªåŠ¨åŒ–ï¼ˆhooksï¼‰ã€å’Œæœ‰è¾¹ç•Œçš„ subagentsï¼Œæœ€å¤§åŒ– Claude Code çš„å¼€å‘æ•ˆç‡ä¸å¯é æ€§ã€‚</li>
</ul>
<hr/>
<p>éœ€è¦çš„æœ‹å‹å¯ä»¥æŠŠä»“åº“ä¸‹è½½ä¸‹æ¥æ·±å…¥ç ”ç©¶ä¸€ä¸‹ï¼Œç»“åˆä½œè€…æä¾›çš„é…å¥—æ–‡ç« ã€‚</p>
<p>æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼š<strong>æ‚Ÿé¸£AI</strong>ï¼Œåç»­ä¼šé™†ç»­åˆ†äº«æ¯”è¾ƒæœ‰ç”¨çš„ AI å·¥å…·å’Œæ¯”è¾ƒå¥½çš„ AI ç»éªŒï¼Œæ¯”è¾ƒå®¢è§‚ç†æ€§çš„ AI è§‚ç‚¹ç­‰ã€‚!</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9eedffb3b4044842bff78345d3e706f5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=w5enHa0bHHN03Xz%2FwGUB%2BpHJtBg%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±åº¦å‰–æSkyWalkingï¼šä»å†…æ ¸åŸç†åˆ°ç”Ÿäº§çº§å…¨é“¾è·¯ç›‘æ§å®æˆ˜]]></title>    <link>https://juejin.cn/post/7599922362998849582</link>    <guid>https://juejin.cn/post/7599922362998849582</guid>    <pubDate>2026-01-28T02:46:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599922362998849582" data-draft-id="7599922362998816814" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±åº¦å‰–æSkyWalkingï¼šä»å†…æ ¸åŸç†åˆ°ç”Ÿäº§çº§å…¨é“¾è·¯ç›‘æ§å®æˆ˜"/> <meta itemprop="keywords" content="åç«¯,ç›‘æ§,Java"/> <meta itemprop="datePublished" content="2026-01-28T02:46:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Shepherd"/> <meta itemprop="url" content="https://juejin.cn/user/3415500769991869"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±åº¦å‰–æSkyWalkingï¼šä»å†…æ ¸åŸç†åˆ°ç”Ÿäº§çº§å…¨é“¾è·¯ç›‘æ§å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3415500769991869/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Shepherd
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:46:58.000Z" title="Wed Jan 28 2026 02:46:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»17åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1.æ¦‚è¿°</h2>
<p>å¹´åº•å®åœ¨æ˜¯å¤ªå¿™äº†ï¼Œæ‰€ä»¥æ‹–æ›´äº†ä¸€ä¸ªæœˆï¼Œå¾ˆæ˜¯æŠ±æ­‰å“ˆ~ è¨€å½’æ­£ä¼ ï¼Œæˆ‘ä»¬ä¹‹å‰å·²ç»åˆ†äº«è¿‡ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FIYKw6SNlymt-Lw_X-f-oTg" target="_blank" title="https://mp.weixin.qq.com/s/IYKw6SNlymt-Lw_X-f-oTg" ref="nofollow noopener noreferrer">ä»å…¥é—¨åˆ°å®è·µï¼šç©è½¬åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªåˆ©å™¨SkyWalking</a>ã€‚è¿™ç¯‡æ–‡ç« è¯¦ç»†ä»‹ç»äº†SkyWalkingçš„æ ¸å¿ƒæ¦‚å¿µã€éƒ¨ç½²æµç¨‹ä¸æ¥å…¥å®è·µã€‚è¿˜ä¸äº†è§£çš„è¯·è‡ªè¡Œè·³è½¬é˜…è¯»æŒæ¡ã€‚</p>
<p>ä½†æ˜¯Apache SkyWalking ä½œä¸ºäº‘åŸç”Ÿæ—¶ä»£å¯è§‚æµ‹æ€§é¢†åŸŸçš„ä½¼ä½¼è€…ï¼Œè¿œéä¸€ä¸ªç®€å•çš„é“¾è·¯è¿½è¸ªå·¥å…·ã€‚å®ƒæ¼”è¿›ä¸ºäº†ä¸€ä¸ªç»¼åˆæ€§çš„åº”ç”¨æ€§èƒ½ç®¡ç†ï¼ˆAPMï¼‰å¹³å°ï¼Œå…·å¤‡äº†æœåŠ¡ç½‘æ ¼ï¼ˆService Meshï¼‰è§‚æµ‹ã€eBPF å†…æ ¸çº§å‰–æã€å¤šè¯­è¨€è‡ªåŠ¨æ¢é’ˆä»¥åŠå¼ºå¤§çš„æµå¼èšåˆåˆ†æèƒ½åŠ›ã€‚æœ¬æ–‡å°†åŸºäºä¹‹å‰å…¥é—¨å®æˆ˜ç¯‡ï¼Œä»å¾®æœåŠ¡é“¾è·¯è¿½è¸ªçš„æ›´æ·±å±‚åŸç†ã€Traceä¸Spançš„ç»„æˆã€ä»¥åŠä¸Log4j2/Logbackç­‰æ—¥å¿—æ¡†æ¶çš„æ•´åˆç­‰æ–¹å‘å…¨æ–¹é¢å‰–æå…¶æ¶æ„è®¾è®¡å“²å­¦ã€æ•°æ®æ¨¡å‹ç»†èŠ‚ã€ä¸Šä¸‹æ–‡ä¼ æ’­åè®®çš„ç²¾å¦™ä¹‹å¤„ï¼Œå¹¶ç»“åˆç”Ÿäº§ç¯å¢ƒçš„ç—›ç‚¹ï¼Œæ¢è®¨æ—¥å¿—èåˆä¸å­˜å‚¨è°ƒä¼˜çš„é«˜çº§å®è·µã€‚è¿™ä¸ä»…æ˜¯å¯¹å·¥å…·çš„è§£æï¼Œæ›´æ˜¯å¯¹åˆ†å¸ƒå¼ç³»ç»Ÿç›‘æ§æ–¹æ³•è®ºçš„ä¸€æ¬¡æ·±åº¦å¤ç›˜ã€‚</p>
<h2 data-id="heading-1">2.å†çœ‹SkyWalking æ ¸å¿ƒæ¶æ„ä¸è®¾è®¡å“²å­¦</h2>
<h4 data-id="heading-2">2.1 æ•´ä½“æ¶æ„</h4>
<p>è¦ç†è§£ SkyWalking å¦‚ä½•å¤„ç†æ¯ç§’æ•°ä¸‡æ¬¡çš„å¹¶å‘è¯·æ±‚ç›‘æ§ï¼Œé¦–å…ˆå¿…é¡»è§£æ„å…¶æ ¸å¿ƒæ¶æ„ã€‚SkyWalking é‡‡ç”¨äº†ç»å…¸çš„ Client-Server åˆ†ç¦»æ¶æ„ï¼Œä½†åœ¨å…·ä½“å®ç°ä¸Šå¼•å…¥äº†å¤§é‡é’ˆå¯¹é«˜å¹¶å‘åœºæ™¯çš„ä¼˜åŒ–è®¾è®¡ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2e4026d8b11644aa940b8997c0600f11~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2hlcGhlcmQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173217&amp;x-signature=sPXreWd9pHM%2BmoT6AGEadBKlAos%3D" alt="" loading="lazy"/></p>
<p>SkyWalking çš„ç”Ÿæ€ç³»ç»Ÿä¸»è¦ç”±å››å¤§æ ¸å¿ƒç»„ä»¶æ„æˆï¼Œå®ƒä»¬å„å¸å…¶èŒï¼Œå½¢æˆäº†ä¸€ä¸ªé—­ç¯çš„æ•°æ®æµè½¬ä½“ç³» ï¼š</p>
<ol>
<li><strong>æ¢é’ˆï¼ˆAgentï¼‰ä¸æ¥æ”¶å™¨ï¼ˆReceiverï¼‰</strong> ï¼šè¿™æ˜¯æ•°æ®çš„æºå¤´ã€‚åœ¨ Java ç”Ÿæ€ä¸­ï¼ŒSkyWalking æä¾›äº†åŸºäº Java Agent æŠ€æœ¯çš„æ— ä¾µå…¥å¼æ¢é’ˆï¼Œåˆ©ç”¨ ByteBuddy å­—èŠ‚ç å¢å¼ºåº“åœ¨åº”ç”¨å¯åŠ¨æ—¶åŠ¨æ€ä¿®æ”¹ç±»å®šä¹‰ï¼Œæ¤å…¥ç›‘æ§é€»è¾‘ã€‚å¯¹äº Goã€Node.js ç­‰å…¶ä»–è¯­è¨€ï¼Œä¹Ÿæœ‰ç›¸åº”çš„ SDK æˆ– Sidecar æ¨¡å¼æ”¯æŒã€‚Agent è´Ÿè´£é‡‡é›† Traceï¼ˆé“¾è·¯ï¼‰ã€Metricsï¼ˆæŒ‡æ ‡ï¼‰å’Œ Logsï¼ˆæ—¥å¿—ï¼‰ï¼Œå¹¶é€šè¿‡é«˜æ•ˆçš„ gRPC åè®®å‘é€ç»™åç«¯ ã€‚</li>
<li><strong>å¯è§‚æµ‹æ€§åˆ†æå¹³å°ï¼ˆOAP Serverï¼‰</strong> ï¼šè¿™æ˜¯ç³»ç»Ÿçš„å¤§è„‘ã€‚OAP æ˜¯ä¸€ä¸ªé«˜åº¦æ¨¡å—åŒ–çš„è½»é‡çº§åˆ†ææœåŠ¡ï¼Œæ”¯æŒé›†ç¾¤éƒ¨ç½²ã€‚å®ƒæ¥æ”¶æ¥è‡ª Agent çš„æ•°æ®ï¼Œæ‰§è¡Œæå…¶å¤æ‚çš„æµå¼è®¡ç®—ã€‚SkyWalking ç‹¬åˆ›äº† OAP åˆ†æè¯­è¨€ï¼ˆOALï¼‰ï¼Œå…è®¸ç”¨æˆ·é€šè¿‡ç®€å•çš„è„šæœ¬å®šä¹‰èšåˆé€»è¾‘ï¼ˆå¦‚è®¡ç®— P99 å»¶è¿Ÿã€SLA æˆåŠŸç‡ç­‰ï¼‰ï¼Œè€Œæ— éœ€ä¿®æ”¹åº•å±‚ä»£ç ã€‚OAP è´Ÿè´£å°†åŸå§‹çš„ Trace æ•°æ®è½¬åŒ–ä¸ºç›´è§‚çš„æœåŠ¡æ‹“æ‰‘å›¾ï¼ˆTopologyï¼‰å’Œæ€§èƒ½æŒ‡æ ‡ ã€‚</li>
<li><strong>å­˜å‚¨å®ç°ï¼ˆStorageï¼‰</strong> ï¼šè¿™æ˜¯æ•°æ®çš„å½’å®¿ã€‚SkyWalking é‡‡ç”¨äº†æ’ä»¶åŒ–çš„å­˜å‚¨æ¶æ„ï¼Œæ”¯æŒ Elasticsearchã€MySQLã€H2ã€TiDB ç­‰å¤šç§åç«¯ã€‚è€Œåœ¨æœ€æ–°çš„æ¼”è¿›ä¸­ï¼Œä¸“ä¸ºå¯è§‚æµ‹æ€§æ•°æ®è®¾è®¡çš„ BanyanDB æ­£åœ¨é€æ¸æˆä¸ºæ ¸å¿ƒé€‰æ‹©ï¼Œæ—¨åœ¨è§£å†³é€šç”¨æ•°æ®åº“åœ¨å¤„ç†æ—¶åºæ•°æ®ï¼ˆTime Series Dataï¼‰æ—¶çš„æ€§èƒ½ç“¶é¢ˆ ã€‚</li>
<li><strong>å¯è§†åŒ–ç•Œé¢ï¼ˆUIï¼‰</strong> ï¼šè¿™æ˜¯ç”¨æˆ·çš„äº¤äº’çª—å£ã€‚é€šè¿‡ GraphQL æŸ¥è¯¢ OAP æä¾›çš„æ¥å£ï¼ŒUI èƒ½å¤Ÿå±•ç¤ºæœåŠ¡ä¾èµ–å…³ç³»ã€é“¾è·¯ç«ç„°å›¾ã€æ—¥å¿—è¯¦æƒ…ä»¥åŠå‘Šè­¦ä¿¡æ¯</li>
</ol>
<h4 data-id="heading-3">2.2 æ¢é’ˆä¸ OAP çš„äº¤äº’æœºåˆ¶</h4>
<p>Agent ä¸ OAP ä¹‹é—´çš„äº¤äº’è®¾è®¡ä½“ç°äº† <strong>â€œè½» Agentï¼Œé‡ OAPâ€</strong> çš„è®¾è®¡å“²å­¦ã€‚ä¸ºäº†æœ€å¤§ç¨‹åº¦å‡å°‘å¯¹ä¸šåŠ¡åº”ç”¨çš„ä¾µå…¥å’Œæ€§èƒ½æŸè€—ï¼ŒAgent ç«¯ä»…è´Ÿè´£æœ€åŸºç¡€çš„æ•°æ®æ”¶é›†å’Œç¼“å†²ï¼Œè€Œå°†å¤æ‚çš„è®¡ç®—é€»è¾‘ï¼ˆå¦‚æ‹“æ‰‘å‘ç°ã€æŒ‡æ ‡èšåˆï¼‰å…¨éƒ¨åç½®åˆ° OAP ç«¯è¿›è¡Œ ã€‚</p>
<p>è¿™ç§äº¤äº’ä¸»è¦ä¾èµ–äº gRPC åè®®ã€‚ç›¸è¾ƒäº HTTP/1.1ï¼ŒgRPC åŸºäº HTTP/2ï¼Œæ”¯æŒå¤šè·¯å¤ç”¨å’ŒåŒå‘æµï¼Œèƒ½å¤Ÿåœ¨ä¸€ä¸ªè¿æ¥ä¸Šå¹¶å‘å¤„ç†å¤§é‡æ•°æ®ä¼ è¾“ï¼Œæå¤§åœ°é™ä½äº†ç½‘ç»œè¿æ¥å¼€é”€ã€‚æ­¤å¤–ï¼ŒProtobuf çš„äºŒè¿›åˆ¶åºåˆ—åŒ–æœºåˆ¶ä½¿å¾—ä¼ è¾“è½½è·è¿œå°äº JSON æ ¼å¼ï¼Œè¿™å¯¹äºå…¨é“¾è·¯ç›‘æ§äº§ç”Ÿæµ·é‡æ•°æ®è‡³å…³é‡è¦ã€‚</p>
<p>åœ¨äº¤äº’æµç¨‹ä¸­ï¼ŒAgent å¯åŠ¨åé¦–å…ˆä¼šè¿›è¡ŒæœåŠ¡æ³¨å†Œï¼Œå‘ OAP æ±‡æŠ¥è‡ªèº«çš„ <code>Service Name</code>ï¼ˆæœåŠ¡åï¼‰å’Œ <code>Service Instance Name</code>ï¼ˆå®ä¾‹åï¼‰ã€‚OAP ä¼šä¸ºæ¯ä¸ªå®ä¾‹åˆ†é…å”¯ä¸€çš„ IDï¼Œåç»­çš„æ‰€æœ‰æ•°æ®ä¸ŠæŠ¥éƒ½å°†åŸºäºè¿™äº› ID è¿›è¡Œï¼Œä»è€Œå‡å°‘äº†å­—ç¬¦ä¸²ä¼ è¾“çš„å†—ä½™ ã€‚å¿ƒè·³æœºåˆ¶ç¡®ä¿å­˜æ´»çŠ¶æ€çš„å®æ—¶æ›´æ–°ï¼Œä¸€æ—¦ Agent å®•æœºï¼ŒOAP èƒ½å¤Ÿè¿…é€Ÿæ„ŸçŸ¥å¹¶åœ¨æ‹“æ‰‘å›¾ä¸­å°†å…¶æ ‡è®°ä¸ºä¸‹çº¿ã€‚</p>
<h2 data-id="heading-4">3.é“¾è·¯è¿½è¸ªçš„æ•°æ®æ¨¡å‹ï¼šTrace, Segment ä¸ Span</h2>
<p>æ·±å…¥ç†è§£ SkyWalking çš„æ•°æ®æ¨¡å‹æ˜¯æŒæ¡å…¶åŸç†çš„å…³é”®ã€‚ä¸åŒäº Zipkin æˆ– Jaeger å°† "Span" ä½œä¸ºæœ€å°ä¼ è¾“å•å…ƒï¼ŒSkyWalking å¼•å…¥äº† <strong>Trace Segment</strong> çš„æ¦‚å¿µï¼Œè¿™æ˜¯é’ˆå¯¹è¯­è¨€è¿è¡Œæ—¶ç‰¹æ€§ï¼ˆç‰¹åˆ«æ˜¯ Java çº¿ç¨‹æ¨¡å‹ï¼‰çš„æ·±åº¦ä¼˜åŒ–ã€‚ä¸‹å›¾å±•ç¤ºäº†ä¸€ä¸ªä¸‹å•æµç¨‹çš„é“¾è·¯æƒ…å†µï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9ebf264b643a43fbbd96a31e1a6a9639~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2hlcGhlcmQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173217&amp;x-signature=FfnOn%2FAstg42KvvgfHI83tJ1sB8%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-5">3.1 Traceï¼šå…¨å±€è§†è§’çš„é€»è¾‘ä¸²è”</h4>
<p><strong>Trace</strong> ä»£è¡¨äº†ä¸€ä¸ªå®Œæ•´çš„åˆ†å¸ƒå¼äº‹åŠ¡ã€‚å®ƒç”±ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„ <code>TraceID</code> æ ‡è¯†ã€‚æ— è®ºè¯·æ±‚ç»è¿‡äº†å¤šå°‘ä¸ªå¾®æœåŠ¡ï¼Œåªè¦å®ƒä»¬å±äºåŒä¸€ä¸ªè°ƒç”¨é“¾ï¼Œå®ƒä»¬å°±å…±äº«åŒä¸€ä¸ª TraceIDã€‚Trace æ˜¯ä¸€ä¸ªé€»è¾‘æ¦‚å¿µï¼Œå®ƒå®é™…ä¸Šæ˜¯ç”±åˆ†å¸ƒåœ¨ä¸åŒæœåŠ¡èŠ‚ç‚¹ä¸Šçš„å¤šä¸ª Segment ç»„æˆçš„é›†åˆ ã€‚</p>
<h4 data-id="heading-6">3.2 Trace Segmentï¼šè¿›ç¨‹å†…çš„åŸå­å•å…ƒ</h4>
<p><strong>Trace Segment</strong> æ˜¯ SkyWalking æ•°æ®æ¨¡å‹ä¸­æœ€å…·ç‰¹è‰²çš„è®¾è®¡ã€‚å®ƒæŒ‡çš„æ˜¯åœ¨åŒä¸€ä¸ª OS è¿›ç¨‹ï¼ˆé€šå¸¸æ˜¯åŒä¸€ä¸ªçº¿ç¨‹ï¼‰ä¸­æ‰§è¡Œçš„æ‰€æœ‰ Span çš„é›†åˆã€‚</p>
<p>ä¸ºä»€ä¹ˆéœ€è¦ Segmentï¼Ÿåœ¨å¾®æœåŠ¡çš„é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œå¦‚æœ Agent æ¯é‡‡é›†åˆ°ä¸€ä¸ª Spanï¼ˆä¾‹å¦‚ä¸€æ¬¡æœ¬åœ°æ–¹æ³•è°ƒç”¨ï¼‰å°±ç«‹å³å‘åç«¯å‘é€ä¸€æ¬¡ç½‘ç»œè¯·æ±‚ï¼Œé‚£ä¹ˆç›‘æ§æœ¬èº«å¸¦æ¥çš„ç½‘ç»œå¼€é”€ï¼ˆIO Overheadï¼‰å°†æ˜¯ç¾éš¾æ€§çš„ã€‚SkyWalking å·§å¦™åœ°å°†åŒä¸€ä¸ªçº¿ç¨‹ä¸Šä¸‹æ–‡ä¸­çš„æ‰€æœ‰æ“ä½œæ‰“åŒ…æˆä¸€ä¸ª Segmentã€‚å½“è¯·æ±‚è¿›å…¥æœåŠ¡æ—¶ï¼ŒSegment å¼€å§‹ï¼›å½“è¯·æ±‚å¤„ç†å®Œæˆå¹¶å“åº”æ—¶ï¼ŒSegment ç»“æŸã€‚Agent ä¼šå°†è¿™æ•´ä¸ª Segment ä½œä¸ºä¸€ä¸ªåŸå­åŒ…å‘é€ç»™ OAP ã€‚</p>
<p>è¿™ç§è®¾è®¡å¸¦æ¥çš„ä¼˜åŠ¿æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼šå®ƒæå¤§åœ°å‡å°‘äº† Agent ä¸ OAP ä¹‹é—´çš„ RPC è°ƒç”¨æ¬¡æ•°ï¼Œæé«˜äº†æ•°æ®ä¼ è¾“çš„å‹ç¼©ç‡ã€‚åŒæ—¶ï¼Œå®ƒä¿è¯äº†è¿›ç¨‹å†…æ•°æ®çš„å®Œæ•´æ€§â€”â€”è¦ä¹ˆæ•´ä¸ª Segment æˆåŠŸä¸ŠæŠ¥ï¼Œè¦ä¹ˆå…¨éƒ¨ä¸¢å¤±ï¼Œé¿å…äº†å› éƒ¨åˆ† Span ä¸¢å¤±å¯¼è‡´çš„â€œæ–­é“¾â€å›°æƒ‘ã€‚</p>
<h4 data-id="heading-7">3.3 Spanï¼šæ“ä½œçš„æœ€å°ç²’åº¦</h4>
<p><strong>Span</strong> æ˜¯ä¾é™„äº Segment å­˜åœ¨çš„æœ€å°ç›‘æ§å•å…ƒã€‚SkyWalking å®šä¹‰äº†ä¸‰ç§æ ¸å¿ƒç±»å‹çš„ Spanï¼Œè¿™å¯¹äºæ„å»ºå‡†ç¡®çš„æœåŠ¡æ‹“æ‰‘è‡³å…³é‡è¦ ï¼š</p>
<ol>
<li>
<p><strong>Entry Spanï¼ˆå…¥å£ Spanï¼‰</strong> ï¼š</p>
<ul>
<li><strong>å®šä¹‰</strong>ï¼šè¡¨ç¤ºè¯·æ±‚è¿›å…¥æŸä¸ªæœåŠ¡çš„å…¥å£æ“ä½œã€‚ä¾‹å¦‚ï¼ŒSpring MVC çš„ Controller æ¥æ”¶åˆ° HTTP è¯·æ±‚ï¼Œæˆ–è€… Dubbo Provider æ¥æ”¶åˆ° RPC è°ƒç”¨ã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šå®ƒæ˜¯æœåŠ¡æ‹“æ‰‘å›¾èŠ‚ç‚¹çš„â€œæœåŠ¡ç«¯â€æ ‡è¯†ã€‚SkyWalking ä¾é  Entry Span æ¥è¯†åˆ«â€œè°åœ¨æä¾›æœåŠ¡â€ã€‚è¿™ä¹Ÿæ˜¯æå–ä¸Šæ¸¸ä¼ é€’è¿‡æ¥çš„ä¸Šä¸‹æ–‡ï¼ˆContext Propagationï¼‰çš„åœ°æ–¹ã€‚</li>
</ul>
</li>
<li>
<p><strong>Exit Spanï¼ˆå‡ºå£ Spanï¼‰</strong> ï¼š</p>
<ul>
<li><strong>å®šä¹‰</strong>ï¼šè¡¨ç¤ºè¯·æ±‚ç¦»å¼€å½“å‰æœåŠ¡ï¼Œå»è°ƒç”¨å¤–éƒ¨ç»„ä»¶çš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ HttpClient è°ƒç”¨ç¬¬ä¸‰æ–¹ APIï¼Œæˆ–è€…ä½¿ç”¨ JDBC é©±åŠ¨æŸ¥è¯¢ MySQL æ•°æ®åº“ã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šå®ƒæ˜¯æœåŠ¡æ‹“æ‰‘å›¾è¿çº¿çš„â€œå®¢æˆ·ç«¯â€æ ‡è¯†ã€‚Exit Span è´Ÿè´£å°†å½“å‰æœåŠ¡çš„ä¸Šä¸‹æ–‡æ³¨å…¥åˆ°è¯·æ±‚å¤´ä¸­ï¼Œä¼ é€’ç»™ä¸‹æ¸¸ã€‚å®ƒåŒæ—¶ä¹Ÿæ˜¯è®¡ç®—ç½‘ç»œè€—æ—¶ï¼ˆNetwork Latencyï¼‰çš„å…³é”®ä¾æ®ã€‚</li>
</ul>
</li>
<li>
<p><strong>Local Spanï¼ˆæœ¬åœ° Spanï¼‰</strong> ï¼š</p>
<ul>
<li><strong>å®šä¹‰</strong>ï¼šè¡¨ç¤ºè¿›ç¨‹å†…éƒ¨çš„æœ¬åœ°æ–¹æ³•è°ƒç”¨ï¼Œä¸æ¶‰åŠç½‘ç»œäº¤äº’ã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šç”¨äºä»£ç çº§åˆ«çš„æ€§èƒ½åˆ†æã€‚ä¾‹å¦‚ï¼Œæ ‡è®°ä¸€ä¸ªå¤æ‚çš„æœ¬åœ°è®¡ç®—é€»è¾‘æˆ–å†…å­˜ç¼“å­˜è¯»å–æ“ä½œã€‚Local Span ä¸°å¯Œäº†é“¾è·¯ç«ç„°å›¾çš„ç»†èŠ‚ï¼Œä½†ä¸ä¼šå½±å“æœåŠ¡é—´çš„æ‹“æ‰‘å…³ç³»ã€‚</li>
</ul>
</li>
</ol>
<h4 data-id="heading-8">3.4 TraceID ç”Ÿæˆç®—æ³•å‰–æ</h4>
<p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç”Ÿæˆå…¨å±€å”¯ä¸€ ID è€Œä¸ä¾èµ–ä¸­å¿ƒåŒ–çš„å‘å·å™¨ï¼ˆå¦‚ Redis è‡ªå¢æˆ– Snowflake æœåŠ¡ï¼‰æ˜¯ä¸€é¡¹æŒ‘æˆ˜ã€‚SkyWalking é‡‡ç”¨äº†å»ä¸­å¿ƒåŒ–çš„ç”Ÿæˆç­–ç•¥ï¼Œå…¶ TraceID æ ¼å¼é€šå¸¸ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œé€šè¿‡å­—ç¬¦ä¸²æ‹¼æ¥è€Œæˆï¼Œä»¥ç¡®ä¿åœ¨æé«˜å¹¶å‘ä¸‹çš„å”¯ä¸€æ€§ ï¼š</p>
<ul>
<li><strong>Part 1: Application Instance ID</strong>ï¼šåº”ç”¨å®ä¾‹çš„å”¯ä¸€æ ‡è¯†ã€‚åœ¨ Agent å¯åŠ¨æ—¶ï¼Œä¼šé€šè¿‡ UUID æˆ–ç‰¹å®šçš„ç¯å¢ƒæŒ‡çº¹ç”Ÿæˆè¯¥ IDã€‚è¿™ç¡®ä¿äº†ä¸åŒæœåŠ¡å™¨ç”Ÿæˆçš„ ID ç»ä¸å†²çªã€‚</li>
<li><strong>Part 2: Thread ID</strong>ï¼šå½“å‰çº¿ç¨‹çš„ IDã€‚è¿™ç¡®ä¿äº†åŒä¸€å°æœåŠ¡å™¨ä¸Šä¸åŒçº¿ç¨‹å¤„ç†çš„è¯·æ±‚ ID ä¸å†²çªã€‚</li>
<li><strong>Part 3: Timestamp &amp; Sequence</strong>ï¼šæ¯«ç§’çº§æ—¶é—´æˆ³åŠ ä¸Šä¸€ä¸ªé€’å¢çš„åºåˆ—å·ã€‚è¿™ç¡®ä¿äº†åŒä¸€ä¸ªçº¿ç¨‹åœ¨ä¸åŒæ—¶é—´å¤„ç†çš„è¯·æ±‚ ID ä¸å†²çªã€‚</li>
</ul>
<p>è¿™ç§ç»“æ„ï¼ˆ<code>InstanceID</code> + <code>ThreadID</code> + <code>Seq</code>ï¼‰çš„è®¾è®¡ä¸ä»…ä¿è¯äº†å”¯ä¸€æ€§ï¼Œè¿˜å…·æœ‰ä¸€å®šçš„å¯è¯»æ€§ã€‚åœ¨æ’æŸ¥é—®é¢˜æ—¶ï¼Œæœ‰ç»éªŒçš„å¼€å‘è€…ç”šè‡³å¯ä»¥ç›´æ¥ä» TraceID ä¸­æ¨æ–­å‡ºæ˜¯å“ªå°æœºå™¨ã€å“ªä¸ªçº¿ç¨‹äº§ç”Ÿçš„è¯·æ±‚ï¼Œè¿™åœ¨å¤æ‚çš„æ•…éšœç°åœºéå¸¸æœ‰ç”¨ã€‚</p>
<h4 data-id="heading-9">3.5 è·¨è¿›ç¨‹åˆ†å¸ƒå¼ä¸Šä¸‹æ–‡ä¼ æ’­ï¼šæ”¾åœ¨è¯·æ±‚å¤´ä¸­</h4>
<p>åˆ†å¸ƒå¼è¿½è¸ªçš„â€œçµé­‚â€åœ¨äºä¸Šä¸‹æ–‡ä¼ æ’­ï¼ˆContext Propagationï¼‰ã€‚å½“æœåŠ¡ A è°ƒç”¨æœåŠ¡ B æ—¶ï¼ŒA å¿…é¡»å‘Šè¯‰ Bï¼šâ€œæˆ‘æ˜¯ Aï¼Œè¿™æ˜¯æˆ‘çš„ TraceIDï¼Œè¿™æ˜¯æˆ‘çš„ SegmentIDã€‚â€ å¦åˆ™ï¼ŒB å°†ç”Ÿæˆä¸€ä¸ªæ–°çš„ TraceIDï¼Œå¯¼è‡´é“¾è·¯æ–­è£‚ã€‚</p>
<p>SkyWalking ä½¿ç”¨äº†è‡ªå®šä¹‰çš„è·¨è¿›ç¨‹ä¼ æ’­åè®®ï¼Œåœ¨ HTTP è¯·æ±‚å¤´æˆ– RPC å…ƒæ•°æ®ä¸­æºå¸¦å…³é”®ä¿¡æ¯ã€‚ç›®å‰ä¸»æµçš„ç‰ˆæœ¬æ˜¯ 3.0 åè®®ï¼Œå¯¹åº”çš„ Header é”®åä¸º <code>sw8</code></p>
<h4 data-id="heading-10">3.6 è·¨çº¿ç¨‹ä¼ æ’­ï¼šContextSnapshot</h4>
<p>é™¤äº†è·¨è¿›ç¨‹ï¼ŒJava åº”ç”¨ä¸­å¹¿æ³›å­˜åœ¨çš„å¼‚æ­¥è°ƒç”¨ï¼ˆçº¿ç¨‹æ± ã€CompletableFutureã€æ¶ˆæ¯é˜Ÿåˆ—ç›‘å¬ï¼‰ä¹Ÿç»™ä¸Šä¸‹æ–‡ä¼ æ’­å¸¦æ¥äº†æŒ‘æˆ˜ã€‚å¦‚æœ Trace ä¸Šä¸‹æ–‡å­˜å‚¨åœ¨ <code>ThreadLocal</code> ä¸­ï¼Œå½“ä»»åŠ¡è¢«æäº¤åˆ°å¦ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œæ—¶ï¼Œä¸Šä¸‹æ–‡å°±ä¼šä¸¢å¤± ã€‚</p>
<p>SkyWalking é€šè¿‡ <strong>Context Captureï¼ˆæ•è·ï¼‰</strong> å’Œ <strong>Context Restoreï¼ˆæ¢å¤ï¼‰</strong> æœºåˆ¶è§£å†³è¿™ä¸€é—®é¢˜ã€‚</p>
<ol>
<li><strong>æ•è·ï¼ˆCaptureï¼‰</strong> ï¼šå½“ä¸»çº¿ç¨‹æäº¤ä»»åŠ¡æ—¶ï¼ˆä¾‹å¦‚è°ƒç”¨ <code>executor.submit</code>ï¼‰ï¼ŒAgent æ‹¦æˆªè¯¥è°ƒç”¨ï¼Œå¹¶å¯¹å½“å‰çº¿ç¨‹çš„ä¸Šä¸‹æ–‡æ‹ä¸€å¼ â€œå¿«ç…§â€ï¼ˆ<code>ContextSnapshot</code>ï¼‰ã€‚è¿™ä¸ªå¿«ç…§åŒ…å«äº† TraceIDã€SegmentID ç­‰æ ¸å¿ƒä¿¡æ¯ã€‚</li>
<li><strong>æºå¸¦ï¼ˆCarrierï¼‰</strong> ï¼šAgent å°†è¿™ä¸ªå¿«ç…§å°è£…åˆ°è¢«æäº¤çš„ä»»åŠ¡å¯¹è±¡ï¼ˆRunnable/Callableï¼‰ä¸­ã€‚</li>
<li><strong>æ¢å¤ï¼ˆContinuedï¼‰</strong> ï¼šå½“å­çº¿ç¨‹å¼€å§‹æ‰§è¡Œä»»åŠ¡æ—¶ï¼ŒAgent å†æ¬¡æ‹¦æˆªæ‰§è¡Œæ–¹æ³•ï¼Œè¯»å–ä»»åŠ¡å¯¹è±¡ä¸­çš„å¿«ç…§ï¼Œå¹¶å°†å…¶æ³¨å…¥åˆ°å­çº¿ç¨‹çš„ <code>ThreadLocal</code> ä¸­ã€‚</li>
</ol>
<p>è¿™ç§æœºåˆ¶ç¡®ä¿äº†æ— è®ºæ˜¯åŒæ­¥è°ƒç”¨è¿˜æ˜¯å¼‚æ­¥æ‰§è¡Œï¼Œé“¾è·¯çš„è¿ç»­æ€§éƒ½èƒ½å¾—åˆ°ä¿è¯ã€‚å¯¹äºç”¨æˆ·è‡ªå®šä¹‰çš„çº¿ç¨‹æ± æˆ–éå¸¸è§„çš„å¼‚æ­¥æ¡†æ¶ï¼ŒSkyWalking æä¾›äº† <code>apm-toolkit-trace</code> å·¥å…·åŒ…ï¼Œå…è®¸å¼€å‘è€…æ‰‹åŠ¨è°ƒç”¨ <code>TraceContext.capture()</code> å’Œ <code>ContextManager.continued()</code> æ¥è¾…åŠ©ä¼ æ’­ï¼Œè¿™åœ¨å¤„ç†é—ç•™ç³»ç»Ÿæˆ–ç§æœ‰æ¡†æ¶æ—¶å°¤ä¸ºæœ‰ç”¨ã€‚</p>
<p>è¿™ä¸ªå¥—è·¯å’Œé˜¿é‡Œå¼€æºçš„<code>TransmittableThreadLocal</code>è§£å†³å¤šçº¿ç¨‹å¼‚æ­¥ä¸Šä¸‹æ–‡ä¼ é€’çš„æ¡†æ¶å¥—è·¯æ˜¯ä¸€æ ·çš„ï¼Œè¯¦è§£ä¹‹å‰æˆ‘ä»¬æ€»ç»“åˆ†äº«çš„ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FJC43Ojbo0YNIaYGH_6D_vQ" target="_blank" title="https://mp.weixin.qq.com/s/JC43Ojbo0YNIaYGH_6D_vQ" ref="nofollow noopener noreferrer">è°ˆè°ˆTransmittableThreadLocalå®ç°åŸç†å’Œåœ¨æ—¥å¿—æ”¶é›†è®°å½•ç³»ç»Ÿä¸Šä¸‹æ–‡å®æˆ˜åº”ç”¨</a></p>
<h2 data-id="heading-11">4. æ—¥å¿—ä¸é“¾è·¯çš„èåˆï¼šLog4j2/Logback æ•´åˆå®æˆ˜</h2>
<p>åœ¨æ•…éšœæ’æŸ¥ä¸­ï¼ŒTrace å‘Šè¯‰æˆ‘ä»¬â€œå“ªé‡Œæ…¢äº†â€æˆ–â€œå“ªé‡ŒæŠ¥é”™äº†â€ï¼Œè€Œ Log å‘Šè¯‰æˆ‘ä»¬â€œä¸ºä»€ä¹ˆé”™â€ã€‚ä¼ ç»Ÿçš„ç›‘æ§æ–¹æ¡ˆä¸­ï¼ŒTraceID å’Œæ—¥å¿—æ˜¯åˆ†ç¦»çš„ï¼Œè¿ç»´äººå‘˜ç»å¸¸éœ€è¦åœ¨ SkyWalking çœ‹åˆ°é”™è¯¯åï¼Œå†å» ELKï¼ˆElasticsearch, Logstash, Kibanaï¼‰ä¸­æ ¹æ®æ—¶é—´æˆ³å¤§æµ·æé’ˆã€‚</p>
<p>SkyWalking æä¾›äº†æ—¥å¿—ä¸é“¾è·¯çš„æ·±åº¦èåˆæ–¹æ¡ˆï¼Œå³ <strong>Log &amp; Trace Correlation</strong>ã€‚å…¶æ ¸å¿ƒç›®æ ‡æ˜¯ï¼šåœ¨æ¯ä¸€è¡Œæ—¥å¿—ä¸­è‡ªåŠ¨æ³¨å…¥å½“å‰çš„ TraceIDï¼Œå¹¶ä¸”èƒ½å¤Ÿå°†æ—¥å¿—å†…å®¹ç›´æ¥é‡‡é›†åˆ° SkyWalking åç«¯è¿›è¡Œå±•ç¤ºã€‚</p>
<h4 data-id="heading-12">4.1 åŸç†ï¼šMDC ä¸ ThreadLocal çš„æ¡¥æ¢</h4>
<p>æ— è®ºæ˜¯ Log4j2 è¿˜æ˜¯ Logbackï¼Œéƒ½æ”¯æŒ MDCï¼ˆMapped Diagnostic Contextï¼‰æœºåˆ¶ã€‚SkyWalking Agent åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œæ‹¦æˆªæ—¥å¿—æ¡†æ¶çš„äº‹ä»¶å¤„ç†æµç¨‹ï¼Œå°†å½“å‰ Trace Context ä¸­çš„ TraceID æ³¨å…¥åˆ° MDC ä¸­ï¼Œæˆ–è€…é€šè¿‡è‡ªå®šä¹‰çš„ Layout/Converter ç›´æ¥ä¿®æ”¹æ—¥å¿—è¾“å‡ºæ ¼å¼ã€‚</p>
<h4 data-id="heading-13">4.2 Log4j2 æ•´åˆæ·±åº¦æŒ‡å—</h4>
<p>å¯¹äºä½¿ç”¨ Log4j2 çš„åº”ç”¨ï¼Œæ•´åˆè¿‡ç¨‹åˆ†ä¸ºä¾èµ–å¼•å…¥å’Œé…ç½®ä¿®æ”¹ä¸¤æ­¥ ã€‚</p>
<p>é¦–å…ˆï¼Œå¿…é¡»å¼•å…¥ <code>apm-toolkit-log4j-2.x</code> ä¾èµ–ã€‚</p>
<p><strong>åœºæ™¯ä¸€ï¼šä»…åœ¨æ—¥å¿—æ–‡ä»¶ä¸­æ‰“å° TraceID</strong> è¿™æ˜¯æœ€åŸºç¡€çš„éœ€æ±‚ã€‚é€šè¿‡ä¿®æ”¹ <code>log4j2.xml</code> çš„ <code>PatternLayout</code>ï¼Œä½¿ç”¨ <code>%traceId</code> å ä½ç¬¦ã€‚</p>
<pre><code class="hljs language-perl" lang="perl">&lt;Appenders&gt;
 Â  &lt;Console name=<span class="hljs-string">"Console"</span> target=<span class="hljs-string">"SYSTEM_OUT"</span>&gt;
 Â  Â  Â &lt;PatternLayout pattern=<span class="hljs-string">"%d [%traceId] %-5p %c{1}:%L - %m%n"</span>/&gt;
 Â  &lt;<span class="hljs-regexp">/Console&gt;
&lt;/</span>Appenders&gt;
</code></pre>
<p>å½“ SkyWalking Agent æ¿€æ´»æ—¶ï¼Œ<code>%traceId</code> ä¼šè¢«è‡ªåŠ¨æ›¿æ¢ä¸ºçœŸå®çš„ IDï¼›å¦‚æœæœªæ¿€æ´»ï¼Œåˆ™æ˜¾ç¤º <code>TID: N/A</code>ã€‚</p>
<p><strong>åœºæ™¯äºŒï¼šå¼‚æ­¥æ—¥å¿—ï¼ˆAsync Loggerï¼‰çš„æŒ‘æˆ˜</strong> ç”Ÿäº§ç¯å¢ƒé€šå¸¸ä½¿ç”¨ Log4j2 çš„é«˜æ€§èƒ½å¼‚æ­¥æ—¥å¿—ï¼ˆåŸºäº LMAX Disruptorï¼‰ã€‚è¿™é‡Œå­˜åœ¨ä¸€ä¸ªéšè”½çš„å‘ï¼šæ—¥å¿—äº‹ä»¶åœ¨ä¸»çº¿ç¨‹ç”Ÿæˆï¼Œä½†ç”±åå°çº¿ç¨‹å†™å…¥ç£ç›˜ã€‚å¦‚æœä»…ä»…ä¾èµ–ç®€å•çš„ ThreadLocalï¼Œåå°çº¿ç¨‹æ— æ³•è·å–ä¸»çº¿ç¨‹çš„ TraceIDã€‚ SkyWalking çš„ Toolkit é€šè¿‡å¢å¼º Log4j2 çš„ <code>LogEvent</code> å·¥å‚ï¼Œåœ¨<strong>äº‹ä»¶ç”Ÿæˆçš„ä¸€ç¬é—´</strong>ï¼ˆä¸»çº¿ç¨‹ï¼‰æ•è· TraceID å¹¶å›ºåŒ–åœ¨äº‹ä»¶å¯¹è±¡ä¸­ï¼Œä»è€Œå®Œç¾æ”¯æŒäº†å¼‚æ­¥æ—¥å¿—åœºæ™¯ã€‚è¿™æ— éœ€å¤æ‚çš„é¢å¤–é…ç½®ï¼Œåªéœ€ç¡®ä¿ä¾èµ–æ­£ç¡®ã€‚</p>
<p><strong>åœºæ™¯ä¸‰ï¼šæ—¥å¿—ä¸ŠæŠ¥è‡³ SkyWalking OAP</strong> ä¸ºäº†åœ¨ SkyWalking UI çš„â€œæ—¥å¿—â€æ ‡ç­¾é¡µç›´æ¥æŸ¥çœ‹æ—¥å¿—ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ <code>GRPCLogClientAppender</code>ã€‚è¿™é€šè¿‡ gRPC é€šé“ç›´æ¥å°†æ—¥å¿—æµå¼ä¼ è¾“ç»™åç«¯ï¼Œçœå»äº†é¢å¤–éƒ¨ç½² Filebeat/Logstash çš„æˆæœ¬ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">&lt;GRPCLogClientAppender <span class="hljs-attr">name</span>=<span class="hljs-string">"grpc-log"</span>&gt;
 Â  Â &lt;PatternLayout <span class="hljs-attr">pattern</span>=<span class="hljs-string">"%d{HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n"</span>/&gt;
&lt;/GRPCLogClientAppender&gt;
</code></pre>
<p>å¼€å¯æ­¤åŠŸèƒ½åï¼Œæ¯æ¡æ—¥å¿—éƒ½ä¼šè‡ªåŠ¨å…³è”å½“å‰ Spanï¼Œå®ç°â€œç‚¹å‡» Span -&gt; æŸ¥çœ‹ç›¸å…³æ—¥å¿—â€çš„ä¸æ»‘ä½“éªŒã€‚</p>
<h4 data-id="heading-14">4.3 Logback æ•´åˆæ·±åº¦æŒ‡å—</h4>
<p>Logback çš„æ•´åˆé€»è¾‘ç±»ä¼¼ï¼Œä½¿ç”¨ <code>apm-toolkit-logback-1.x</code> ã€‚ ä¾èµ–å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"> Â <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
 Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.skywalking<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
 Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>apm-toolkit-logback-1.x<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
 Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>9.5.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
 Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>logbacké…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
â€‹
<span class="hljs-tag">&lt;<span class="hljs-name">configuration</span> <span class="hljs-attr">scan</span>=<span class="hljs-string">"true"</span> <span class="hljs-attr">scanPeriod</span>=<span class="hljs-string">" 10 seconds"</span>&gt;</span>
â€‹
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">appender</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"stdout"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ch.qos.logback.core.ConsoleAppender"</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">encoder</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ch.qos.logback.core.encoder.LayoutWrappingEncoder"</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">layout</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"org.apache.skywalking.apm.toolkit.log.logback.v1.x.mdc.TraceIdMDCPatternLogbackLayout"</span>&gt;</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">Pattern</span>&gt;</span>%d{yyyy-MM-dd HH:mm:ss.SSS} [%X{tid}] [%thread] %-5level %logger{36} -%msg%n<span class="hljs-tag">&lt;/<span class="hljs-name">Pattern</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">layout</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">encoder</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">appender</span>&gt;</span>
â€‹
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">appender</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"grpc-log"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"org.apache.skywalking.apm.toolkit.log.logback.v1.x.log.GRPCLogClientAppender"</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">encoder</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ch.qos.logback.core.encoder.LayoutWrappingEncoder"</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">layout</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"org.apache.skywalking.apm.toolkit.log.logback.v1.x.mdc.TraceIdMDCPatternLogbackLayout"</span>&gt;</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">Pattern</span>&gt;</span>%d{yyyy-MM-dd HH:mm:ss.SSS} [%X{tid}] [%thread] %-5level %logger{36} -%msg%n<span class="hljs-tag">&lt;/<span class="hljs-name">Pattern</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">layout</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">encoder</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">appender</span>&gt;</span>
â€‹
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">appender</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"fileAppender"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ch.qos.logback.core.FileAppender"</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">file</span>&gt;</span>./logs/shepherd-demo01.log<span class="hljs-tag">&lt;/<span class="hljs-name">file</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">encoder</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ch.qos.logback.core.encoder.LayoutWrappingEncoder"</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">layout</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"org.apache.skywalking.apm.toolkit.log.logback.v1.x.TraceIdPatternLogbackLayout"</span>&gt;</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">Pattern</span>&gt;</span>[%sw_ctx] [%level] %d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %logger:%line - %msg%n<span class="hljs-tag">&lt;/<span class="hljs-name">Pattern</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">layout</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">encoder</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">appender</span>&gt;</span>
â€‹
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">root</span> <span class="hljs-attr">level</span>=<span class="hljs-string">"INFO"</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">appender-ref</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"grpc-log"</span>/&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">appender-ref</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"stdout"</span>/&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">root</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">logger</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"fileLogger"</span> <span class="hljs-attr">level</span>=<span class="hljs-string">"INFO"</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">appender-ref</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"fileAppender"</span>/&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">logger</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span>
</code></pre>
<p><strong>é…ç½®è¦ç‚¹</strong>ï¼š Logback éœ€è¦ä½¿ç”¨ SkyWalking æä¾›çš„ç‰¹å®š Encoder ç±» <code>TraceIdPatternLogbackLayout</code> æ¥è§£æ <code>%tid</code>ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">&lt;appender <span class="hljs-attr">name</span>=<span class="hljs-string">"STDOUT"</span> class=<span class="hljs-string">"ch.qos.logback.core.ConsoleAppender"</span>&gt;
 Â  Â &lt;encoder <span class="hljs-attr">class</span>=<span class="hljs-string">"ch.qos.logback.core.encoder.LayoutWrappingEncoder"</span>&gt;
 Â  Â  Â  Â &lt;layout <span class="hljs-attr">class</span>=<span class="hljs-string">"org.apache.skywalking.apm.toolkit.log.logback.v1.x.TraceIdPatternLogbackLayout"</span>&gt;
 Â  Â  Â  Â  Â  Â &lt;Pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} <span class="hljs-section">[%tid]</span><span class="hljs-section">[%thread]</span> %-5level %logger{36} -%msg%n&lt;/Pattern&gt;
 Â  Â  Â  Â &lt;/layout&gt;
 Â  Â &lt;/encoder&gt;
&lt;/appender&gt;
</code></pre>
<p>å¯¹äºç»“åˆ Logstash ä½¿ç”¨ JSON æ ¼å¼è¾“å‡ºçš„åœºæ™¯ï¼Œå¯ä»¥ä½¿ç”¨ <code>TraceIdMDCPatternLogbackLayout</code> å°† TraceID æ³¨å…¥åˆ° MDC ä¸­ï¼Œç„¶ååœ¨ JSON æ¨¡æ¿ä¸­å¼•ç”¨ <code>%X{tid}</code>ã€‚</p>
<p>è¯·æ±‚æ¥å£ï¼ŒæŸ¥çœ‹<strong>SkyWalking UIï¼š</strong> è¿›å…¥ <strong>Log (æ—¥å¿—)</strong> æ ‡ç­¾é¡µï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b461b47fa37442c38a1a4833f5876bf1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2hlcGhlcmQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173217&amp;x-signature=d7ggi4mYa83RDHguk6C%2FbqiNHrY%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-15">5.å¾®æœåŠ¡æ•´åˆå®æˆ˜</h2>
<p>æˆ‘ä»¬çŸ¥é“Skywalkingå°±æ˜¯ä¸ºäº‘åŸç”Ÿã€å¾®æœåŠ¡è€Œç”Ÿçš„ã€‚è¿™é‡Œæˆ‘ä»¬å±•ç¤ºä¸‹åœ¨å¾®æœåŠ¡ä¸­çš„åº”ç”¨ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘å‡†å¤‡äº†ä¸‰ä¸ªæœåŠ¡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a05fef76c9cf4d828dc9025bdfb6ff7a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2hlcGhlcmQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173217&amp;x-signature=gflEfuxpQT9rm8GSByRl%2B04hACo%3D" alt="" loading="lazy"/></p>
<p>è¿™é‡Œæˆ‘å†™ä¸€ä¸ªç¤ºä¾‹æ¥å£ï¼Œè°ƒç”¨é“¾è·¯æ˜¯è¿™æ ·çš„ï¼š<code>demo3â†’demo2-demo1â†’MySQLæˆ–è€…Redis</code></p>
<p>è¯·æ±‚æ¥å£ï¼Œåœ¨uiç•Œé¢æŸ¥çœ‹æ‹“æ‰‘å›¾å¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3658400c91ca4943960282407e55fe53~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2hlcGhlcmQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173217&amp;x-signature=c2G8LtoWj%2Fdu6seQnHQYyhRVFC8%3D" alt="" loading="lazy"/></p>
<p>å¯ä»¥çœ‹å‡ºï¼Œè°ƒç”¨é“¾è·¯éå¸¸æ¸…æ¥šæ˜äº†ã€‚</p>
<h2 data-id="heading-16">6.ç”Ÿäº§ç¯å¢ƒå®æˆ˜ç­–ç•¥ï¼šé‡‡æ ·ã€è¿‡æ»¤ä¸æ•…éšœæ’æŸ¥</h2>
<p>åœ¨å¼€å‘ç¯å¢ƒè·‘é€š SkyWalking åªæ˜¯ç¬¬ä¸€æ­¥ï¼ŒçœŸæ­£çš„æŒ‘æˆ˜åœ¨äºå¦‚ä½•åœ¨æµ·é‡æµé‡çš„ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæ—¢ä¿è¯ç›‘æ§çš„æœ‰æ•ˆæ€§ï¼Œåˆä¸æ‹–å®ä¸šåŠ¡ç³»ç»Ÿå’Œç›‘æ§è‡ªèº«ã€‚</p>
<h4 data-id="heading-17">6.1 é‡‡æ ·ç­–ç•¥ï¼šèˆå¼ƒçš„è‰ºæœ¯</h4>
<p>å…¨é‡é‡‡é›†æ‰€æœ‰ Trace åœ¨é«˜å¹¶å‘ç³»ç»Ÿæ˜¯ä¸ç°å®çš„ï¼Œæ—¢æµªè´¹å­˜å‚¨ä¹Ÿæµªè´¹å¸¦å®½ã€‚é‡‡æ ·ï¼ˆSamplingï¼‰æ˜¯å¿…é¡»çš„æ‰‹æ®µã€‚</p>
<p><strong>å¤´éƒ¨é‡‡æ ·ï¼ˆHead Samplingï¼‰</strong> ï¼š è¿™æ˜¯æœ€å¸¸ç”¨çš„ç­–ç•¥ï¼Œç”± Agent å†³å®šæ˜¯å¦é‡‡é›†ã€‚</p>
<ul>
<li><strong>å›ºå®šé¢‘ç‡é‡‡æ ·</strong>ï¼šé…ç½® <code>agent.sample_n_per_3_secs</code> ã€‚ä¾‹å¦‚è®¾ç½®ä¸º <code>100</code>ï¼Œè¡¨ç¤ºæ¯ 3 ç§’æœ€å¤šé‡‡é›† 100 æ¡ Traceã€‚å…¶ä½™çš„è¯·æ±‚å°†åªé€šè¿‡ Header ä¼ é€’ TraceIDï¼ˆä¿è¯ä¸‹æ¸¸èƒ½ä¸²è”ï¼‰ï¼Œä½†ä¸è®°å½• Span è¯¦æƒ…ã€‚</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šç›´æ¥ä¿æŠ¤äº† Agent å’Œ OAP çš„è®¡ç®—å‹åŠ›ï¼Œä»æºå¤´æ§åˆ¶æµé‡ã€‚</li>
</ul>
<p><strong>å°¾éƒ¨é‡‡æ ·ï¼ˆTail Samplingï¼‰ä¸å¼‚å¸¸ä¿ç•™</strong>ï¼š å•çº¯çš„éšæœºé‡‡æ ·å¯èƒ½ä¼šæ¼æ‰é‚£äº›çœŸæ­£é‡è¦çš„â€œå¼‚å¸¸è¯·æ±‚â€ã€‚æˆ‘ä»¬ä¸å…³å¿ƒ 99.9% çš„ HTTP 200 è¯·æ±‚ï¼Œä½†ç»ä¸èƒ½æ”¾è¿‡é‚£ 0.1% çš„ HTTP 500ã€‚ SkyWalking åç«¯æ”¯æŒ <strong>å¼ºåˆ¶é‡‡æ ·å¼‚å¸¸æ®µ</strong>ï¼ˆForce Sample Error Segmentï¼‰ã€‚å³ä¾¿æ ¹æ®é‡‡æ ·ç‡è¯¥è¯·æ±‚åº”è¢«ä¸¢å¼ƒï¼Œå¦‚æœ Agent æ ‡è®°è¯¥ Segment å‘ç”Ÿäº† Errorï¼ˆå¦‚æŠ›å‡ºå¼‚å¸¸ï¼‰ï¼ŒOAP ä¾ç„¶ä¼šå¼ºåˆ¶å°†å…¶ä¿ç•™å¹¶å­˜å‚¨ã€‚è¿™æ˜¯ç”Ÿäº§ç¯å¢ƒå¿…é¡»å¼€å¯çš„â€œä¿å‘½â€é…ç½®ã€‚</p>
<h4 data-id="heading-18">6.2 æ— æ•ˆè¿‡æ»¤ï¼šTrace Ignore Plugin</h4>
<p>æŸäº›å¿ƒè·³æ£€æµ‹æ¥å£ï¼ˆå¦‚ <code>/actuator/health</code>ï¼‰ã€ç›‘æ§æ‰“ç‚¹æ¥å£æˆ–é¢‘ç¹è½®è¯¢çš„é…ç½®æ¥å£ï¼Œä¼šäº§ç”Ÿæµ·é‡çš„åƒåœ¾ Traceï¼Œæ·¹æ²¡çœŸå®çš„ä¸šåŠ¡è¯·æ±‚ã€‚</p>
<p><strong>å®æˆ˜é…ç½®</strong> ï¼š ä½¿ç”¨ <code>apm-trace-ignore-plugin</code> æ˜¯æœ€ä½³å®è·µã€‚</p>
<ol>
<li>å°† <code>optional-plugins</code> ç›®å½•ä¸‹çš„ <code>apm-trace-ignore-plugin-x.jar</code> å¤åˆ¶åˆ° <code>plugins</code> ç›®å½•ã€‚</li>
<li>åˆ›å»ºé…ç½®æ–‡ä»¶ <code>/agent/config/apm-trace-ignore-plugin.config</code>ã€‚</li>
<li>é…ç½®è§„åˆ™ï¼š<code>trace.ignore_path=/health/**,/eureka/**</code>ã€‚ æ”¯æŒ Ant é£æ ¼çš„è·¯å¾„åŒ¹é…ï¼Œé…ç½®åï¼Œè¿™äº›è·¯å¾„çš„è¯·æ±‚å°†å®Œå…¨ä¸è¢«é‡‡é›†ï¼Œæå¤§åœ°å‡€åŒ–äº†ç›‘æ§æ•°æ®ã€‚</li>
</ol>
<h3 data-id="heading-19">6.3 å¸¸è§æ•…éšœæ’æŸ¥ï¼šæ•°æ®ä¸¢å¤±ä¹‹è°œ</h3>
<p>è¿ç»´ SkyWalking æ—¶ï¼Œæœ€å¸¸å¬åˆ°çš„æŠ±æ€¨æ˜¯â€œæˆ‘çš„ Trace æ€ä¹ˆæ–­äº†ï¼Ÿâ€æˆ–â€œä¸ºä»€ä¹ˆæŸ¥ä¸åˆ°æ•°æ®ï¼Ÿâ€ã€‚è¿™é€šå¸¸å½’ç»“ä¸ºä¸‰å¤§ç“¶é¢ˆ ï¼š</p>
<ol>
<li>
<p><strong>Agent å‘é€ç¼“å†²åŒºæº¢å‡º</strong>ï¼š</p>
<ul>
<li><strong>ç°è±¡</strong>ï¼šAgent æ—¥å¿—å‡ºç° <code>DataCarrier is full</code> æˆ– <code>Queue full</code>ã€‚</li>
<li><strong>åŸå› </strong>ï¼šä¸šåŠ¡äº§ç”Ÿ Trace çš„é€Ÿåº¦è¶…è¿‡äº† Agent å‘é€ç»™ OAP çš„ç½‘ç»œé€Ÿåº¦ã€‚</li>
<li><strong>å¯¹ç­–</strong>ï¼šå¢å¤§ <code>agent.channel_size</code> é…ç½®ï¼Œæˆ–è€…æ£€æŸ¥ Agent åˆ° OAP çš„ç½‘ç»œå¸¦å®½å’Œå»¶è¿Ÿã€‚</li>
</ul>
</li>
<li>
<p><strong>OAP æ¥æ”¶é˜Ÿåˆ—å µå¡</strong>ï¼š</p>
<ul>
<li><strong>ç°è±¡</strong>ï¼šOAP ç›‘æ§æŒ‡æ ‡ä¸­ï¼Œæ¥æ”¶é˜Ÿåˆ—å ç”¨ç‡æŒç»­ 100%ï¼Œæˆ–è€…æ—¥å¿—æŠ¥é”™ <code>persistence queue is full</code>ã€‚</li>
<li><strong>åŸå› </strong>ï¼šOAP çš„æ¶ˆè´¹èƒ½åŠ›ï¼ˆåˆ†ææˆ–å†™å…¥å­˜å‚¨ï¼‰è·Ÿä¸ä¸Š Agent çš„ä¸ŠæŠ¥é€Ÿåº¦ã€‚</li>
<li><strong>å¯¹ç­–</strong>ï¼šæ¨ªå‘æ‰©å±• OAP èŠ‚ç‚¹ï¼›ä¼˜åŒ–å­˜å‚¨ï¼ˆå¦‚ä¸Šæ–‡çš„ ES è°ƒä¼˜ï¼‰ï¼›æˆ–è€…é™ä½é‡‡æ ·ç‡ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ—¶é—´åå·®ï¼ˆTime Skewï¼‰</strong> ï¼š</p>
<ul>
<li><strong>ç°è±¡</strong>ï¼šTrace æ•°æ®å­˜åœ¨ï¼Œä½†åœ¨ UI ä¸ŠæŸ¥è¯¢ä¸åˆ°ï¼Œæˆ–è€…æ‹“æ‰‘å›¾æ˜¾ç¤ºå¼‚å¸¸ã€‚</li>
<li><strong>åŸå› </strong>ï¼šAgent æ‰€åœ¨æœåŠ¡å™¨ä¸ OAP æœåŠ¡å™¨æ—¶é—´ä¸ä¸€è‡´ã€‚SkyWalking å¯¹æ—¶é—´éå¸¸æ•æ„Ÿã€‚</li>
<li><strong>å¯¹ç­–</strong>ï¼šç¡®ä¿æ‰€æœ‰æœåŠ¡å™¨å¼€å¯ NTP æ—¶é—´åŒæ­¥ã€‚</li>
</ul>
</li>
</ol>
<h2 data-id="heading-20">7.æ€»ç»“</h2>
<p>å¯¹äºæŠ€æœ¯å›¢é˜Ÿè€Œè¨€ï¼ŒæŒæ¡ SkyWalking ä¸åº”æ­¢æ­¥äºâ€œå®‰è£…å¹¶è¿è¡Œâ€ã€‚æ·±å…¥ç†è§£å…¶å†…æ ¸åŸç†ï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬åœ¨é¢å¯¹ç”Ÿäº§ç¯å¢ƒçš„æç«¯æŒ‘æˆ˜æ—¶ï¼Œä»å®¹åœ°è¿›è¡Œè°ƒä¼˜ã€è£å‰ªå’Œæ•…éšœæ’é™¤ï¼ŒçœŸæ­£å°†å¯è§‚æµ‹æ€§è½¬åŒ–ä¸ºç³»ç»Ÿçš„ç¨³å®šæ€§ä¿éšœã€‚éšç€ eBPF ç­‰æ–°æŠ€æœ¯çš„å¼•å…¥ï¼ŒSkyWalking çš„æ¼”è¿›ä»åœ¨ç»§ç»­ï¼Œè€Œæˆ‘ä»¬å¯¹ç³»ç»Ÿé€æ˜åº¦çš„è¿½æ±‚ï¼Œä¹Ÿæ°¸æ— æ­¢å¢ƒã€‚</p>
<p><strong>é™„å½•ï¼šç”Ÿäº§ç¯å¢ƒå…³é”®é…ç½®é€ŸæŸ¥è¡¨</strong></p>
<p>ä¸ºäº†æ–¹ä¾¿è¯»è€…å¿«é€Ÿè½åœ°ï¼Œä»¥ä¸‹æ•´ç†äº†ç”Ÿäº§ç¯å¢ƒæœ€å…³é”®çš„è°ƒä¼˜å‚æ•°è¡¨ï¼š</p>
<p><strong>Agent å…³é”®é…ç½® (agent.config)</strong></p>



































<table><thead><tr><th><strong>é…ç½®é¡¹é”®å</strong></th><th><strong>é»˜è®¤å€¼</strong></th><th><strong>å«ä¹‰</strong></th><th><strong>ç”Ÿäº§ç¯å¢ƒæ¨èä¸å»ºè®®</strong></th></tr></thead><tbody><tr><td><code>agent.service_name</code></td><td><code>Your_ApplicationName</code></td><td>æœåŠ¡é€»è¾‘åç§°</td><td><strong>å¿…å¡«</strong>ã€‚å¿…é¡»ç¡®ä¿æ¯ä¸ªå¾®æœåŠ¡å”¯ä¸€ï¼ˆå¦‚ <code>Order-Service</code>ï¼‰ï¼Œè¿™æ˜¯æ‹“æ‰‘èšåˆçš„åŸºç¡€ã€‚</td></tr><tr><td><code>agent.sample_n_per_3_secs</code></td><td><code>-1</code> (ä¸é™æµ)</td><td>æ¯ 3 ç§’é‡‡æ ·çš„æœ€å¤§ Trace æ•°</td><td>å»ºè®®è®¾ä¸º <code>100</code>-<code>500</code>ã€‚é˜²æ­¢æµé‡çªåˆºæ—¶ Agent æˆ– OAP è¢«æ‰“å®ï¼Œèµ·åˆ°å‰Šå³°ä½œç”¨ã€‚</td></tr><tr><td><code>agent.ignore_suffix</code></td><td><code>.jpg,.jpeg...</code></td><td>å¿½ç•¥çš„è¯·æ±‚åç¼€</td><td>å»ºè®®è¿½åŠ  <code>.html</code>, <code>.css</code>, <code>.js</code> ä»¥åŠè‡ªå®šä¹‰çš„ç›‘æ§åç¼€ï¼Œå‡å°‘æ— ç”¨æ•°æ®ã€‚</td></tr><tr><td><code>plugin.mount</code></td><td>æ— </td><td>æŒ‚è½½æ’ä»¶åˆ—è¡¨</td><td>ä»…æŒ‚è½½éœ€è¦çš„æ’ä»¶ï¼Œç§»é™¤ä¸éœ€è¦çš„ï¼ˆå¦‚æœªä½¿ç”¨çš„ä¸­é—´ä»¶æ’ä»¶ï¼‰ï¼Œå‡å°‘ç±»åŠ è½½å¼€é”€å’Œå†…å­˜å ç”¨ã€‚</td></tr></tbody></table>
<p><strong>OAP å­˜å‚¨è°ƒä¼˜é…ç½® (Elasticsearch)</strong></p>



































<table><thead><tr><th><strong>ç¯å¢ƒå˜é‡/é…ç½®é¡¹</strong></th><th><strong>é»˜è®¤å€¼</strong></th><th><strong>ä½œç”¨</strong></th><th><strong>è°ƒä¼˜å»ºè®®</strong></th></tr></thead><tbody><tr><td><code>SW_STORAGE_ES_INDEX_SHARDS_NUMBER</code></td><td><code>1</code></td><td>ç´¢å¼•åˆ†ç‰‡æ•°</td><td>è‹¥ ES é›†ç¾¤æœ‰ 3+ æ•°æ®èŠ‚ç‚¹ï¼Œå»ºè®®è®¾ä¸º <code>3</code> æˆ– <code>5</code>ï¼Œæå‡å¹¶å‘å†™å…¥èƒ½åŠ›ã€‚</td></tr><tr><td><code>SW_STORAGE_ES_BULK_ACTIONS</code></td><td><code>1000</code></td><td>æ‰¹é‡å†™å…¥æ¡æ•°</td><td>å†…å­˜å…è®¸æ—¶å¯è°ƒè‡³ <code>2000</code>-<code>4000</code>ï¼Œå‡å°‘ç½‘ç»œäº¤äº’æ¬¡æ•°ã€‚</td></tr><tr><td><code>SW_STORAGE_ES_FLUSH_INTERVAL</code></td><td><code>10</code> (ç§’)</td><td>æ‰¹é‡å†™å…¥æœ€å¤§é—´éš”</td><td>ä¿æŒé»˜è®¤æˆ–å¾®è°ƒã€‚è¿‡çŸ­å¯¼è‡´ CPU é£™å‡ï¼Œè¿‡é•¿å¯¼è‡´æ•°æ®å»¶è¿Ÿå¯è§ã€‚</td></tr><tr><td><code>SW_STORAGE_ES_LOGIC_SHARDING</code></td><td><code>false</code></td><td>é€»è¾‘åˆ†ç‰‡æ¨¡å¼</td><td>è¶…å¤§è§„æ¨¡é›†ç¾¤å»ºè®®å¼€å¯ (<code>true</code>)ï¼Œå°†ä¸åŒæŒ‡æ ‡æ‹†åˆ†åˆ°ç‰©ç†éš”ç¦»çš„ç´¢å¼•ä¸­ã€‚</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[OoderAgent SDK Nexus ç‰ˆæ·±åº¦æ­ç§˜ï¼šæ„å»ºå…¨å±‚çº§æ™ºèƒ½ååŒçš„ä»£ç†ç³»ç»Ÿ]]></title>    <link>https://juejin.cn/post/7599929684022018067</link>    <guid>https://juejin.cn/post/7599929684022018067</guid>    <pubDate>2026-01-28T02:49:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599929684022018067" data-draft-id="7599924721006493759" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="OoderAgent SDK Nexus ç‰ˆæ·±åº¦æ­ç§˜ï¼šæ„å»ºå…¨å±‚çº§æ™ºèƒ½ååŒçš„ä»£ç†ç³»ç»Ÿ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-28T02:49:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="OneCodeCN"/> <meta itemprop="url" content="https://juejin.cn/user/1427583415622366"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            OoderAgent SDK Nexus ç‰ˆæ·±åº¦æ­ç§˜ï¼šæ„å»ºå…¨å±‚çº§æ™ºèƒ½ååŒçš„ä»£ç†ç³»ç»Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1427583415622366/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    OneCodeCN
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:49:00.000Z" title="Wed Jan 28 2026 02:49:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">OoderAgent SDK Nexus ç‰ˆæ·±åº¦æ­ç§˜ï¼šæ„å»ºå…¨å±‚çº§æ™ºèƒ½ååŒçš„ä»£ç†ç³»ç»Ÿ</h2>
<p>OoderAgent SDK Nexus ç‰ˆï¼ˆåŸºäº Java 8 å¼€å‘ï¼Œæºç å¯å‚è€ƒï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2FooderCN%2Fsuper-agent%2Ftree%2Fmaster%2Fagent-sdk" target="_blank" title="https://gitee.com/ooderCN/super-agent/tree/master/agent-sdk" ref="nofollow noopener noreferrer">gitee.com/ooderCN/supâ€¦</a>ï¼‰æ­£æ˜¯ä¸ºæ­¤è€Œç”Ÿâ€”â€”å®ƒä»¥åˆ†å±‚æ¶æ„ä¸ºéª¨æ¶ã€Agent ç»§æ‰¿ä½“ç³»ä¸ºè„‰ç»œã€ç»Ÿä¸€å‘½ä»¤æ¨¡å¼ä¸ç²¾ç»†åŒ–ç½‘ç»œç®¡ç†ä¸ºæ ¸å¿ƒï¼Œä¸ºæ„å»ºå…¨åœºæ™¯æ™ºèƒ½ä»£ç†ç³»ç»Ÿæä¾›äº†ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆã€‚æœ¬æ–‡å°†ä»è®¾è®¡ç†å¿µã€æ ¸å¿ƒæ¶æ„ã€å…³é”®èƒ½åŠ›åˆ°å®æˆ˜åº”ç”¨ï¼Œå…¨æ–¹ä½æ‹†è§£è¿™æ¬¾ SDK çš„æŠ€æœ¯å†…æ ¸ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€è®¾è®¡åˆå¿ƒï¼šç ´è§£æ™ºèƒ½ä»£ç†å¼€å‘çš„æ ¸å¿ƒç—›ç‚¹</h3>
<p>ä¼ ç»Ÿæ™ºèƒ½ä»£ç†ç³»ç»Ÿå¼€å‘å¾€å¾€é¢ä¸´ã€Œæ¨¡å—è€¦åˆé«˜ã€æ‰©å±•æˆæœ¬å¤§ã€å¤šåœºæ™¯é€‚é…éš¾ã€çš„é—®é¢˜ï¼Œè€Œ OoderAgent SDK Nexus ç‰ˆçš„æ ¸å¿ƒè®¾è®¡ç›®æ ‡ï¼Œå°±æ˜¯é€šè¿‡<strong>åˆ†å±‚è§£è€¦ã€ç»§æ‰¿æ‰©å±•ã€ç»Ÿä¸€æ ‡å‡†</strong>ä¸‰å¤§åŸåˆ™ï¼Œè®©æ™ºèƒ½ä»£ç†å¼€å‘æ›´ç®€å•ï¼š</p>
<ul>
<li>åˆ†å±‚æ¶æ„æ˜ç¡®å„æ¨¡å—èŒè´£ï¼Œé™ä½å¼€å‘ä¸ç»´æŠ¤æˆæœ¬ï¼›</li>
<li>Agent ç»§æ‰¿ä½“ç³»å®ç°è§’è‰²åŠŸèƒ½çš„è‡ªç„¶å¤ç”¨ä¸æ‰©å±•ï¼›</li>
<li>ç»Ÿä¸€çš„å‘½ä»¤æ¨¡å¼å’Œç½‘ç»œç®¡ç†æ–¹æ¡ˆï¼Œé€‚é…ä»ç»ˆç«¯åˆ°ä¸­å¿ƒçš„å…¨å±‚çº§ååŒåœºæ™¯ã€‚</li>
</ul>
<h3 data-id="heading-2">äºŒã€æ ¸å¿ƒæ¶æ„ï¼šå››å±‚åˆ†å±‚è®¾è®¡ï¼Œå±‚å±‚è§£è€¦ä¸”å¯æ‰©å±•</h3>
<p>OoderAgent SDK Nexus ç‰ˆé‡‡ç”¨å››å±‚é€’è¿›å¼åˆ†å±‚æ¶æ„ï¼Œä»ä¸Šå±‚åº”ç”¨æ¥å£åˆ°åº•å±‚åŸºç¡€æ”¯æ’‘ï¼Œæ¯ä¸€å±‚éƒ½æœ‰æ¸…æ™°çš„å®šä½å’Œè¾¹ç•Œï¼Œæ—¢ä¿è¯æ¨¡å—åŒ–å¼€å‘ï¼Œåˆä¸ºåŠŸèƒ½æ‰©å±•é¢„ç•™å……è¶³ç©ºé—´ã€‚</p>






























<table><thead><tr><th align="left">å±‚çº§</th><th align="left">æ ¸å¿ƒå®šä½</th><th align="left">å…³é”®èƒ½åŠ›</th></tr></thead><tbody><tr><td align="left">åº”ç”¨æ¥å£å±‚</td><td align="left">å¼€å‘è€…ç»Ÿä¸€å…¥å£</td><td align="left">å°è£…å„ç±» Agent æ¥å£ï¼Œæä¾›é¢å‘ç»ˆç«¯/è·¯ç”±/ç®¡ç†è§’è‰²çš„ç»Ÿä¸€ç¼–ç¨‹å…¥å£ï¼Œæ— éœ€å…³æ³¨åº•å±‚å®ç°</td></tr><tr><td align="left">æœåŠ¡æŠ½è±¡å±‚</td><td align="left">æ ¸å¿ƒèƒ½åŠ›çš„ã€Œå®šä¹‰å±‚ã€</td><td align="left">æŠ½è±¡å‘½ä»¤æœåŠ¡ã€LLM èƒ½åŠ›ã€ç½‘ç»œç®¡ç†ç­‰æ ¸å¿ƒæœåŠ¡æ¥å£ï¼Œæ”¯æŒå¤šå®ç°æ–¹å¼ï¼ˆå¦‚ LLM å¯å¯¹æ¥äº‘ç«¯/æœ¬åœ°ï¼‰</td></tr><tr><td align="left">åè®®å®ç°å±‚</td><td align="left">æŠ½è±¡èƒ½åŠ›çš„ã€Œè½åœ°å±‚ã€</td><td align="left">å®ç°å‘½ä»¤åŸºç¡€æœåŠ¡ã€ç½‘ç»œå‘ç°ã€å­˜å‚¨æœåŠ¡ç­‰æ ¸å¿ƒé€»è¾‘ï¼Œå°†æŠ½è±¡æ¥å£è½¬åŒ–ä¸ºå¯æ‰§è¡Œçš„å…·ä½“åŠŸèƒ½</td></tr><tr><td align="left">åº•å±‚æ”¯æ’‘å±‚</td><td align="left">ç³»ç»Ÿç¨³å®šçš„ã€Œåœ°åŸºã€</td><td align="left">æä¾›å­˜å‚¨ã€å®‰å…¨è®¤è¯ã€UDP æ•°æ®åŒ…å¤„ç†ã€ç½‘ç»œé€šä¿¡ç­‰åŸºç¡€èƒ½åŠ›ï¼Œä¿éšœä¸Šå±‚æ¨¡å—å¯é è¿è¡Œ</td></tr></tbody></table>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cba55c44dd7a4fb1a0010c7d2201b756~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173340&amp;x-signature=AFp7JmQTZ20nBW5fjYep1H6qXAw%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h4 data-id="heading-3">æ ¸å¿ƒè®¾è®¡åŸåˆ™</h4>
<p>è¿™å¥—åˆ†å±‚æ¶æ„éµå¾ªå››å¤§åŸåˆ™ï¼Œç¡®ä¿ç³»ç»Ÿçš„çµæ´»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼š</p>
<ol>
<li><strong>æ¨¡å—åŒ–</strong>ï¼šæŒ‰åŠŸèƒ½æ‹†åˆ†ç‹¬ç«‹æ¨¡å—ï¼Œæ”¯æŒå•ç‹¬å¼€å‘ã€æµ‹è¯•ä¸è¿­ä»£ï¼›</li>
<li><strong>æŠ½è±¡åŒ–</strong>ï¼šæ ¸å¿ƒæœåŠ¡é€šè¿‡æ¥å£å®šä¹‰ï¼Œå…¼å®¹å¤šç§å®ç°æ–¹æ¡ˆï¼›</li>
<li><strong>ç»§æ‰¿æ€§</strong>ï¼šAgent è§’è‰²é—´é€šè¿‡ç»§æ‰¿å®ç°åŠŸèƒ½å¤ç”¨ï¼Œé¿å…é‡å¤å¼€å‘ï¼›</li>
<li><strong>å¯æ‰©å±•æ€§</strong>ï¼šé¢„ç•™æ‰©å±•ç‚¹ï¼Œè½»æ¾æ¥å…¥æ–°åŠŸèƒ½ã€æ–°åè®®æˆ–æ–°åœºæ™¯ã€‚</li>
</ol>
<h3 data-id="heading-4">ä¸‰ã€Agent ä½“ç³»ï¼šä¸‰å±‚ç»§æ‰¿ï¼Œé€‚é…å…¨åœºæ™¯è§’è‰²</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b3155fc778444705be832d6a908c0edd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173340&amp;x-signature=lmKDSpxoj1dl2BoGxB1IMQru4Dk%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>SDK è®¾è®¡äº†ä¸‰å±‚ Agent ç»§æ‰¿ä½“ç³»ï¼Œä¸åŒè§’è‰²çš„ Agent åŸºäºç»§æ‰¿å®ç°åŠŸèƒ½å¤ç”¨ä¸æ‰©å±•ï¼Œå®Œç¾è¦†ç›–ä»ç»ˆç«¯è®¾å¤‡åˆ°ä¸­å¿ƒç®¡ç†èŠ‚ç‚¹çš„å…¨åœºæ™¯éœ€æ±‚ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fc33cfcfde5247349157b43e5ecc7b14~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173340&amp;x-signature=1CCpxy9BehnVYbS%2BR3fQ8fInUmY%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h4 data-id="heading-5">1. EndAgentï¼šç»ˆç«¯è®¾å¤‡çš„ã€Œæ™ºèƒ½å…¥å£ã€</h4>
<p>ä½œä¸ºæœ€åŸºç¡€çš„ç»ˆç«¯ä»£ç†ï¼ŒEndAgent æ˜¯æ™ºèƒ½è®¾å¤‡ï¼ˆæ™ºèƒ½å®¶å±…ã€å·¥ä¸šç»ˆç«¯ç­‰ï¼‰æ¥å…¥ç³»ç»Ÿçš„æ ¸å¿ƒè½½ä½“ï¼Œæ‰¿æ‹…ï¼š</p>
<ul>
<li>è®¾å¤‡çŠ¶æ€å®æ—¶ç®¡ç†ï¼›</li>
<li>åŸºç¡€å‘½ä»¤æ‰§è¡Œï¼›</li>
<li>æœ¬åœ°èµ„æºï¼ˆå­˜å‚¨ã€ç®—åŠ›ï¼‰ç®¡ç†ã€‚</li>
</ul>
<h4 data-id="heading-6">2. RouteAgentï¼šç½‘ç»œä¸­çš„ã€Œä¸­è½¬æ¢çº½ã€</h4>
<p>RouteAgent ç»§æ‰¿ EndAgent çš„å…¨éƒ¨åŠŸèƒ½ï¼Œé¢å¤–æ–°å¢ç½‘ç»œå±‚æ ¸å¿ƒèƒ½åŠ›ï¼Œé€‚ç”¨äºè¾¹ç¼˜è®¡ç®—èŠ‚ç‚¹ã€å±€åŸŸç½‘è·¯ç”±èŠ‚ç‚¹ï¼š</p>
<ul>
<li>æ•°æ®åŒ…è·¯ç”±è½¬å‘ï¼›</li>
<li>ç½‘ç»œæ‹“æ‰‘è‡ªåŠ¨ç»´æŠ¤ï¼›</li>
<li>ç»ˆç«¯ä¸ä¸­å¿ƒèŠ‚ç‚¹çš„é€šä¿¡æ¡¥æ¢ã€‚</li>
</ul>
<h4 data-id="heading-7">3. McpAgentï¼šç³»ç»Ÿçš„ã€Œå¤§è„‘ä¸­æ¢ã€</h4>
<p>McpAgent ç»§æ‰¿ RouteAgent çš„æ‰€æœ‰èƒ½åŠ›ï¼Œæ–°å¢å…¨å±€ç®¡æ§èƒ½åŠ›ï¼Œä½œä¸ºä¸­å¿ƒç®¡ç†èŠ‚ç‚¹è´Ÿè´£ï¼š</p>
<ul>
<li>å…¨å±€èµ„æºè°ƒåº¦ä¸ç®¡ç†ï¼›</li>
<li>è·¨èŠ‚ç‚¹ç³»ç»Ÿé…ç½®åè°ƒï¼›</li>
<li>å…¨å±‚çº§ä»£ç†çš„ååŒç®¡æ§ã€‚</li>
</ul>
<p>ä¸‰è€…çš„ç»§æ‰¿å…³ç³»æ¸…æ™°ä¸”åŠŸèƒ½é€’è¿›ï¼š<code>EndAgent â†’ RouteAgent â†’ McpAgent</code>ï¼Œæ—¢ä¿è¯äº†åŸºç¡€èƒ½åŠ›çš„å¤ç”¨ï¼Œåˆå®ç°äº†ä¸åŒè§’è‰²çš„å·®å¼‚åŒ–æ‰©å±•ã€‚</p>
<h3 data-id="heading-8">å››ã€æ ¸å¿ƒèƒ½åŠ›æ‹†è§£ï¼šå‘½ä»¤æ¨¡å¼+ç½‘ç»œç®¡ç†ï¼Œæ‰“é€šååŒä¸é€šä¿¡</h3>
<h4 data-id="heading-9">1. å‘½ä»¤æ¨¡å¼ï¼šç»Ÿä¸€çš„é€šä¿¡ä¸æ§åˆ¶é€»è¾‘</h4>
<p>SDK é‡‡ç”¨ç»å…¸å‘½ä»¤æ¨¡å¼å®ç°ä»£ç†é—´çš„é€šä¿¡ä¸æ§åˆ¶ï¼Œæ ¸å¿ƒç»„ä»¶å½¢æˆå®Œæ•´çš„å‘½ä»¤ç”Ÿå‘½å‘¨æœŸç®¡ç†é—­ç¯ï¼š</p>
<ul>
<li><strong>CommandBaseService</strong>ï¼šå‘½ä»¤æœåŠ¡æ¥å£ï¼Œå®šä¹‰å‘½ä»¤åˆ›å»ºã€çŠ¶æ€æŸ¥è¯¢ã€å–æ¶ˆã€æ›´æ–°ç­‰æ ¸å¿ƒæ–¹æ³•ï¼›</li>
<li><strong>CommandBaseServiceImpl</strong>ï¼šå‘½ä»¤æœåŠ¡å®ç°ï¼ŒåŸºäºå†…å­˜è·Ÿè¸ªå‘½ä»¤çŠ¶æ€ï¼Œå®Œæˆå…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼›</li>
<li><strong>CommandStatus</strong>ï¼šå‘½ä»¤çŠ¶æ€æšä¸¾ï¼ˆPENDING/EXECUTING/SUCCESS/FAILED/CANCELLEDï¼‰ï¼Œæ¸…æ™°è·Ÿè¸ªæ‰§è¡Œè¿‡ç¨‹ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0e58440bd08345ffbed481ca3a2bc6e8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173340&amp;x-signature=xjLDTCJGpleLf2BiOQlUJIMJpqY%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p><strong>å‘½ä»¤æ‰§è¡Œå…¨æµç¨‹</strong>ï¼š</p>
<ol>
<li>ä¸Šå±‚åº”ç”¨é€šè¿‡ Agent æ¥å£åˆ›å»ºå‘½ä»¤ï¼›</li>
<li>å‘½ä»¤æœåŠ¡æ¥ç®¡ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼›</li>
<li>åŸºäº UDP åè®®å°†å‘½ä»¤ä¸‹å‘è‡³ç›®æ ‡ä»£ç†ï¼›</li>
<li>å®æ—¶è·Ÿè¸ªæ‰§è¡ŒçŠ¶æ€å¹¶è¿”å›ç»“æœã€‚</li>
</ol>
<h4 data-id="heading-10">2. ç½‘ç»œç®¡ç†ï¼šç²¾ç»†åŒ– UDP ç«¯å£æ–¹æ¡ˆï¼Œé€‚é…å¤šç½‘ç»œç¯å¢ƒ</h4>
<p>é’ˆå¯¹æœ¬åœ°ã€å°å±€åŸŸç½‘ï¼ˆWIFIï¼‰ã€å†…ç½‘ç½‘æ®µç­‰ä¸åŒç½‘ç»œåœºæ™¯ï¼ŒSDK è®¾è®¡äº†ç²¾ç»†åŒ–çš„ UDP ç«¯å£ç®¡ç†ç­–ç•¥ï¼ŒåŒæ—¶å†…ç½®ç½‘ç»œå‘ç°æœºåˆ¶ï¼Œä¿éšœä»£ç†é—´é€šä¿¡çš„ç¨³å®šæ€§ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9ca41cfd08a9445fb5af0679d6f0d38b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173340&amp;x-signature=RCqbSgN1rgNsss2%2FZo8C4%2BWvPt8%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>





















<table><thead><tr><th align="left">ç½‘ç»œåœºæ™¯</th><th align="left">æ ¸å¿ƒç«¯å£ç®¡ç†èƒ½åŠ›</th></tr></thead><tbody><tr><td align="left">æœ¬åœ°ç®¡ç†</td><td align="left">ç«¯å£å†²çªæ£€æµ‹ã€åŠ¨æ€åˆ†é…ã€é‡Šæ”¾å›æ”¶</td></tr><tr><td align="left">å°å±€åŸŸç½‘ï¼ˆWIFIï¼‰</td><td align="left">å±€åŸŸç½‘åœ°å€ç«¯å£æ˜ å°„ã€å¹¿æ’­å‘ç°ã€ä½å»¶è¿Ÿä¼˜åŒ–</td></tr><tr><td align="left">å†…ç½‘ç½‘æ®µ</td><td align="left">ç½‘æ®µçº§ç«¯å£è§„åˆ’ã€è·¯ç”±èŠ‚ç‚¹è½¬å‘ã€æ‹“æ‰‘è‡ªåŠ¨å‘ç°</td></tr></tbody></table>
<p><strong>ç½‘ç»œå‘ç°æœºåˆ¶</strong>ï¼šè‡ªåŠ¨æ£€æµ‹ç½‘ç»œç¯å¢ƒ â†’ å‘ç°å‘¨è¾¹ä»£ç†èŠ‚ç‚¹ â†’ å»ºç«‹è¿æ¥å¹¶ç»´æŠ¤æ‹“æ‰‘ â†’ å®æ—¶é€šçŸ¥ä¸Šå±‚åº”ç”¨ç½‘ç»œå˜åŒ–ï¼Œè®©ä»£ç†ç³»ç»Ÿèƒ½è‡ªé€‚åº”ç½‘ç»œç¯å¢ƒçš„åŠ¨æ€è°ƒæ•´ã€‚</p>
<h3 data-id="heading-11">äº”ã€æ ¸å¿ƒç‰¹æ€§ï¼šå¼‚æ­¥ã€å®‰å…¨ã€çµæ´»ï¼Œé€‚é…é«˜å¤æ‚åº¦åœºæ™¯</h3>
<h4 data-id="heading-12">1. å¼‚æ­¥ç¼–ç¨‹ï¼šæå‡ç³»ç»Ÿå¹¶å‘èƒ½åŠ›</h4>
<p>åŸºäº CompletableFuture å®ç°å¼‚æ­¥ç¼–ç¨‹ï¼Œæ”¯æŒéé˜»å¡å‘½ä»¤æ‰§è¡Œã€å¼‚æ­¥ç½‘ç»œé€šä¿¡ã€å¹¶è¡Œä»»åŠ¡å¤„ç†ï¼Œå¤§å¹…æå‡ç³»ç»Ÿå“åº”é€Ÿåº¦ï¼Œé€‚é…é«˜å¹¶å‘çš„æ™ºèƒ½è®¾å¤‡åœºæ™¯ã€‚</p>
<h4 data-id="heading-13">2. è§’è‰²èº«ä»½è®¤è¯ï¼šä¿éšœæ¥å£è°ƒç”¨å®‰å…¨</h4>
<p>åŸºäºä¾èµ–æ³¨å…¥å’Œä»£ç†æ¨¡å¼å®ç°èº«ä»½è®¤è¯ï¼Œæ”¯æŒåŸºäºè§’è‰²çš„æƒé™æ§åˆ¶å’Œçµæ´»çš„è®¤è¯ç­–ç•¥é…ç½®ï¼Œä»åº•å±‚é˜²æ­¢æœªæˆæƒè®¿é—®ï¼Œä¿éšœæ¥å£è°ƒç”¨å®‰å…¨ã€‚</p>
<h4 data-id="heading-14">3. å·¥å‚æ¨¡å¼ï¼šç®€åŒ–å¯¹è±¡åˆ›å»ºä¸ç®¡ç†</h4>
<p>é€šè¿‡å·¥å‚æ¨¡å¼å°è£… Agent å®ä¾‹çš„åˆ›å»ºé€»è¾‘ï¼Œæä¾›ç»Ÿä¸€çš„å¯¹è±¡åˆ›å»ºå…¥å£ï¼Œè‡ªåŠ¨å¤„ç†ä¾èµ–å…³ç³»ï¼Œæ”¯æŒé…ç½®åŒ–å®ä¾‹åŒ–ç­–ç•¥ï¼Œé™ä½å¼€å‘è€…çš„ä½¿ç”¨æˆæœ¬ã€‚</p>
<h4 data-id="heading-15">4. ç³»ç»Ÿçº§é…ç½®ï¼šé›†ä¸­å¼ç®¡ç†ï¼ŒåŠ¨æ€é€‚é…</h4>
<p>æä¾›é›†ä¸­å¼é…ç½®ç®¡ç†èƒ½åŠ›ï¼Œæ”¯æŒç»Ÿä¸€é…ç½®åŠ è½½ã€è¿è¡Œæ—¶é…ç½®æ›´æ–°ã€ç¯å¢ƒæ„ŸçŸ¥çš„é…ç½®é€‚é…ï¼Œè®©ç³»ç»Ÿèƒ½çµæ´»åº”å¯¹ä¸åŒéƒ¨ç½²ç¯å¢ƒçš„éœ€æ±‚ã€‚</p>
<h4 data-id="heading-16">5. LLM æŠ½è±¡å±‚ï¼šå…¼å®¹å¤šç±»å¤§è¯­è¨€æ¨¡å‹èƒ½åŠ›</h4>
<p>ä¸ºå¤§è¯­è¨€æ¨¡å‹è®¾è®¡ç»Ÿä¸€æŠ½è±¡æ¥å£ï¼Œæ”¯æŒä¸‰ç§å®ç°æ–¹å¼ï¼Œé€‚é…ä¸åŒæ™ºèƒ½åœºæ™¯ï¼š</p>
<ul>
<li>å¤–éƒ¨ LLM-APIï¼šå¯¹æ¥äº‘ç«¯å¤§è¯­è¨€æ¨¡å‹æœåŠ¡ï¼›</li>
<li>æœ¬åœ° Skillsï¼šå†…ç½®æœ¬åœ°æŠ€èƒ½ï¼Œæ— éœ€ä¾èµ–äº‘ç«¯ï¼›</li>
<li>SkillFlowï¼šæŠ€èƒ½æµç¨‹ç¼–æ’ï¼Œæ”¯æŒå¤æ‚ä»»åŠ¡è‡ªåŠ¨åŒ–æ‰§è¡Œã€‚</li>
</ul>
<h3 data-id="heading-17">å…­ã€å¿«é€Ÿä¸Šæ‰‹ï¼šæç®€ç¤ºä¾‹ç©è½¬ Nexus SDK</h3>
<p>åŸºäºå¼€æºçš„ SDK æºç ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2FooderCN%2Fsuper-agent%2Ftree%2Fmaster%2Fagent-sdk" target="_blank" title="https://gitee.com/ooderCN/super-agent/tree/master/agent-sdk" ref="nofollow noopener noreferrer">gitee.com/ooderCN/supâ€¦</a>ï¼‰ï¼Œå¼€å‘è€…å¯å¿«é€Ÿå®ç°åŸºç¡€åŠŸèƒ½ï¼Œä»¥ä¸‹æ˜¯æ ¸å¿ƒåœºæ™¯çš„æç®€ç¤ºä¾‹ï¼š</p>
<h4 data-id="heading-18">1. åˆ›å»ºå¹¶å¯åŠ¨ EndAgent å®ä¾‹</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åˆ›å»º EndAgent é…ç½®</span>
<span class="hljs-type">EndAgentConfig</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">EndAgentConfig</span>();
config.setAgentId(<span class="hljs-string">"end-agent-001"</span>);
config.setAgentName(<span class="hljs-string">"æ™ºèƒ½å®¶å±…ç»ˆç«¯"</span>);
config.setNetworkConfig(<span class="hljs-keyword">new</span> <span class="hljs-title class_">NetworkConfig</span>(<span class="hljs-number">8080</span>));

<span class="hljs-comment">// é€šè¿‡å·¥å‚æ¨¡å¼åˆ›å»º EndAgent å®ä¾‹</span>
<span class="hljs-type">EndAgent</span> <span class="hljs-variable">endAgent</span> <span class="hljs-operator">=</span> EndAgentFactory.createEndAgent(config);

<span class="hljs-comment">// å¯åŠ¨ç»ˆç«¯ä»£ç†</span>
endAgent.start();
System.out.println(<span class="hljs-string">"EndAgent å¯åŠ¨æˆåŠŸï¼š"</span> + endAgent.getAgentId());
</code></pre>
<h4 data-id="heading-19">2. æ‰§è¡Œè®¾å¤‡æ§åˆ¶å‘½ä»¤ï¼ˆå¼‚æ­¥ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ„å»ºè®¾å¤‡æ§åˆ¶å‘½ä»¤åŒ…</span>
<span class="hljs-type">CommandPacket</span> <span class="hljs-variable">commandPacket</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CommandPacket</span>();
commandPacket.setCommandId(<span class="hljs-string">"cmd-001"</span>);
commandPacket.setCommandType(<span class="hljs-string">"DEVICE_CONTROL"</span>);
commandPacket.setParameters(Collections.singletonMap(<span class="hljs-string">"deviceId"</span>, <span class="hljs-string">"light-001"</span>));
commandPacket.setParameters(Collections.singletonMap(<span class="hljs-string">"action"</span>, <span class="hljs-string">"turnOn"</span>));

<span class="hljs-comment">// å¼‚æ­¥å‘é€å‘½ä»¤å¹¶å¤„ç†ç»“æœ</span>
CompletableFuture&lt;CommandStatus&gt; future = endAgent.sendCommand(commandPacket);
future.thenAccept(status -&gt; {
    System.out.println(<span class="hljs-string">"å‘½ä»¤æ‰§è¡ŒçŠ¶æ€ï¼š"</span> + status);
}).exceptionally(ex -&gt; {
    System.err.println(<span class="hljs-string">"å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼š"</span> + ex.getMessage());
    <span class="hljs-keyword">return</span> CommandStatus.FAILED;
});
</code></pre>
<h4 data-id="heading-20">3. ç›‘å¬ç½‘ç»œå†…ä»£ç†èŠ‚ç‚¹å˜åŒ–</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ·»åŠ ç½‘ç»œå‘ç°ç›‘å¬å™¨</span>
endAgent.addDiscoveryListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DiscoveryListener</span>() {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onAgentDiscovered</span><span class="hljs-params">(AgentInfo agentInfo)</span> {
        System.out.println(<span class="hljs-string">"å‘ç°æ–°ä»£ç†ï¼š"</span> + agentInfo.getAgentId() + <span class="hljs-string">" - "</span> + agentInfo.getAgentName());
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onAgentLost</span><span class="hljs-params">(AgentInfo agentInfo)</span> {
        System.out.println(<span class="hljs-string">"ä»£ç†ç¦»çº¿ï¼š"</span> + agentInfo.getAgentId());
    }
});

<span class="hljs-comment">// å¯åŠ¨ç½‘ç»œå‘ç°</span>
endAgent.startDiscovery();
</code></pre>
<h3 data-id="heading-21">ä¸ƒã€åº”ç”¨åœºæ™¯ï¼šè¦†ç›–ä»ç»ˆç«¯åˆ°ä¸­å¿ƒçš„å…¨é“¾è·¯</h3>
<p>OoderAgent SDK Nexus ç‰ˆå‡­å€Ÿå…¶åˆ†å±‚æ¶æ„å’Œçµæ´»çš„ Agent ä½“ç³»ï¼Œå¯å¹¿æ³›é€‚é…å„ç±»æ™ºèƒ½ååŒåœºæ™¯ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/800951aa591d49b484c113cf339da5f0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173340&amp;x-signature=bG73%2BoZSnvSVl4Jb1QWL7t2%2FqEo%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<ul>
<li><strong>æ™ºèƒ½ç‰©è”ç½‘è®¾å¤‡</strong>ï¼šå®ç°è®¾å¤‡æœ¬åœ°æ™ºèƒ½å†³ç­–ä¸è¿œç¨‹ç®¡ç†ï¼Œé™ä½äº‘ç«¯ä¾èµ–ï¼›</li>
<li><strong>è¾¹ç¼˜è®¡ç®—èŠ‚ç‚¹</strong>ï¼šä½œä¸º RouteAgent æä¾›è¾¹ç¼˜æ™ºèƒ½ä¸æ•°æ®è½¬å‘ï¼Œæå‡å“åº”é€Ÿåº¦ï¼›</li>
<li><strong>ä¸­å¿ƒç®¡ç†å¹³å°</strong>ï¼šåŸºäº McpAgent å®ç°å…¨å±€èµ„æºè°ƒåº¦ä¸è·¨èŠ‚ç‚¹ååŒï¼›</li>
<li><strong>å¤šè®¾å¤‡ååŒç³»ç»Ÿ</strong>ï¼šæ„å»ºè®¾å¤‡é—´æ™ºèƒ½äº’è”ï¼Œå®ç°æ™ºèƒ½å®¶å±…ã€å·¥ä¸šç‰©è”ç½‘ç­‰å¤æ‚åœºæ™¯çš„è‡ªåŠ¨åŒ–ã€‚</li>
</ul>
<h3 data-id="heading-22">æ€»ç»“</h3>
<p>OoderAgent SDK Nexus ç‰ˆä»¥ã€Œåˆ†å±‚è§£è€¦ã€çµæ´»æ‰©å±•ã€å…¨åœºæ™¯é€‚é…ã€ä¸ºæ ¸å¿ƒï¼Œé€šè¿‡å››å±‚æ¶æ„ã€ä¸‰å±‚ Agent ç»§æ‰¿ä½“ç³»ã€ç»Ÿä¸€å‘½ä»¤æ¨¡å¼å’Œç²¾ç»†åŒ–ç½‘ç»œç®¡ç†ï¼Œä¸ºæ™ºèƒ½ä»£ç†ç³»ç»Ÿå¼€å‘æä¾›äº†æ¸…æ™°çš„æŠ€æœ¯è·¯å¾„ã€‚æ— è®ºæ˜¯ç®€å•çš„ç»ˆç«¯è®¾å¤‡æ¥å…¥ï¼Œè¿˜æ˜¯å¤æ‚çš„å¤šèŠ‚ç‚¹ååŒç®¡æ§ï¼Œè¿™æ¬¾ SDK éƒ½èƒ½å¤§å¹…é™ä½å¼€å‘æˆæœ¬ï¼Œæå‡ç³»ç»Ÿçš„ç¨³å®šæ€§ä¸å¯æ‰©å±•æ€§ã€‚ç»“åˆå¼€æºçš„æºç ä»“åº“ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2FooderCN%2Fsuper-agent%2Ftree%2Fmaster%2Fagent-sdk" target="_blank" title="https://gitee.com/ooderCN/super-agent/tree/master/agent-sdk" ref="nofollow noopener noreferrer">gitee.com/ooderCN/supâ€¦</a>ï¼‰ï¼Œå¼€å‘è€…å¯å¿«é€Ÿä¸Šæ‰‹å¹¶åŸºäºå®é™…åœºæ™¯æ‰©å±•å®šåˆ¶ï¼Œæ˜¯æ„å»ºå…¨å±‚çº§æ™ºèƒ½ååŒç³»ç»Ÿçš„ç†æƒ³å·¥å…·åŒ…ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[nestjså­¦ä¹ 13ï¼šinterceptorä¸rxjs]]></title>    <link>https://juejin.cn/post/7599912857392906286</link>    <guid>https://juejin.cn/post/7599912857392906286</guid>    <pubDate>2026-01-28T02:48:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599912857392906286" data-draft-id="7599155566297382955" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="nestjså­¦ä¹ 13ï¼šinterceptorä¸rxjs"/> <meta itemprop="keywords" content="NestJS"/> <meta itemprop="datePublished" content="2026-01-28T02:48:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€æ±Ÿä¸œæµæ°´"/> <meta itemprop="url" content="https://juejin.cn/user/1151943917181880"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            nestjså­¦ä¹ 13ï¼šinterceptorä¸rxjs
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1151943917181880/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€æ±Ÿä¸œæµæ°´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:48:37.000Z" title="Wed Jan 28 2026 02:48:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å…³äºå¯¹<code>rxjs</code>çš„æè¿°ï¼Œè¯·å‚è€ƒè¿™ç¯‡æ–‡ç« <a href="https://juejin.cn/post/7566119309967474751" target="_blank" title="https://juejin.cn/post/7566119309967474751">å¯¹rxjsçš„ç†è§£å’ŒåŸºæœ¬ä½¿ç”¨</a>ã€‚</p>
<p><code>interceptor</code>éƒ½æ˜¯å’Œ<code>rxjs</code>é…åˆä½¿ç”¨çš„ï¼Œå…ˆçœ‹çœ‹åœ¨<code>interceptor</code>ä¸­æœ‰é‚£äº›å¸¸ç”¨çš„æ“ä½œç¬¦ã€‚</p>
<h2 data-id="heading-0">map</h2>
<p>ç”Ÿæˆä¸€ä¸ª interceptorï¼š</p>
<pre><code class="hljs language-js" lang="js">nest g interceptor map-test --no-spec --flat
</code></pre>
<p>ä½¿ç”¨ map operator æ¥å¯¹ controller è¿”å›çš„æ•°æ®åšä¸€äº›ä¿®æ”¹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">CallHandler</span>, <span class="hljs-title class_">ExecutionContext</span>, <span class="hljs-title class_">Injectable</span>, <span class="hljs-title class_">NestInterceptor</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { map, <span class="hljs-title class_">Observable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs'</span>;

@<span class="hljs-title class_">Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MapTestInterceptor</span> implements <span class="hljs-title class_">NestInterceptor</span> {
  <span class="hljs-title function_">intercept</span>(<span class="hljs-attr">context</span>: <span class="hljs-title class_">ExecutionContext</span>, <span class="hljs-attr">next</span>: <span class="hljs-title class_">CallHandler</span>): <span class="hljs-title class_">Observable</span>&lt;any&gt; {
    <span class="hljs-keyword">return</span> next.<span class="hljs-title function_">handle</span>().<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">code</span>: <span class="hljs-number">200</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">'success'</span>,
        data
      }
    }))
  }
}
</code></pre>
<p>åœ¨ controller é‡Œå¼•å…¥ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7f201987846d4ada9ff0ff6840200921~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173316&amp;x-signature=xxnib592wfyn8Sj3nCivnrdAMxc%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/33bddfdf43ff4fa59b92bc710f61dda9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173316&amp;x-signature=9ibK97yhyLH5c4KWPBEHykvrDQg%3D" alt="image.png" loading="lazy"/></p>
<p>ç°åœ¨è¿”å›çš„æ•°æ®å°±å˜æˆäº†è¿™æ ·ã€‚</p>
<p>map ç®—æ˜¯åœ¨ nest interceptor é‡Œå¿…ç”¨çš„ rxjs operator äº†ã€‚</p>
<p>å¯ä»¥çœ‹åˆ°<code>interceptor</code>ä½¿ç”¨çš„ç¬¬ä¸€ä¸ªåœºæ™¯ï¼š<strong>è½¬æ¢è¯·æ±‚ / å“åº”æ•°æ®ï¼ˆæœ€å¸¸ç”¨ï¼‰</strong>ã€‚</p>
<p>ä¸Šé¢å…¶å®å±•ç¤ºäº†å¦‚ä½•è½¬æ¢å“åº”æ•°æ®ï¼Œä¸‹é¢å†çœ‹çœ‹å¦‚ä½•è½¬æ¢è¯·æ±‚æ•°æ®ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Injectable</span>, <span class="hljs-title class_">NestInterceptor</span>, <span class="hljs-title class_">ExecutionContext</span>, <span class="hljs-title class_">CallHandler</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Observable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs'</span>;

@<span class="hljs-title class_">Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestTransformInterceptor</span> implements <span class="hljs-title class_">NestInterceptor</span> {
  <span class="hljs-comment">// æ ¸å¿ƒæ–¹æ³•ï¼šæ‹¦æˆªè¯·æ±‚ï¼Œå¤„ç†å…¥å‚åå†æ‰§è¡Œæ§åˆ¶å™¨é€»è¾‘</span>
  <span class="hljs-title function_">intercept</span>(<span class="hljs-attr">context</span>: <span class="hljs-title class_">ExecutionContext</span>, <span class="hljs-attr">next</span>: <span class="hljs-title class_">CallHandler</span>): <span class="hljs-title class_">Observable</span>&lt;any&gt; {
    <span class="hljs-comment">// 1. è·å– HTTP ä¸Šä¸‹æ–‡ï¼ˆæ‹¿åˆ°è¯·æ±‚å¯¹è±¡ï¼‰</span>
    <span class="hljs-keyword">const</span> ctx = context.<span class="hljs-title function_">switchToHttp</span>();
    <span class="hljs-keyword">const</span> request = ctx.<span class="hljs-title function_">getRequest</span>();

    <span class="hljs-comment">// 2. ç»Ÿä¸€å¤„ç†å…¥å‚ï¼šè¦†ç›–åŸå§‹è¯·æ±‚çš„ query/params/body</span>
    <span class="hljs-comment">// å¤„ç† URL å‚æ•°ï¼ˆå¦‚ /users/:id â†’ id ä»å­—ç¬¦ä¸²è½¬æ•°å­—ï¼‰</span>
    <span class="hljs-keyword">if</span> (request.<span class="hljs-property">params</span>) {
      request.<span class="hljs-property">params</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">transformParams</span>(request.<span class="hljs-property">params</span>);
    }

    <span class="hljs-comment">// 3. æ‰§è¡Œæ§åˆ¶å™¨æ–¹æ³•ï¼ˆæ­¤æ—¶å…¥å‚å·²è¢«è½¬æ¢ï¼‰</span>
    <span class="hljs-keyword">return</span> next.<span class="hljs-title function_">handle</span>();
  }
</code></pre>
<p>ä¸€èˆ¬æ‹¦æˆªå™¨Interceptoræ˜¯å…¨å±€æ‰¹é‡è½¬æ¢è¯·æ±‚å‚æ•°ï¼Œå•ä¸ªå‚æ•°çš„ç²¾å‡†è½¬æ¢ + éªŒè¯ï¼Œè¿˜æ˜¯è¦ä½¿ç”¨ç®¡é“ pipeã€‚</p>
<h2 data-id="heading-1">tap</h2>
<p>tapä¸ä¼šä¿®æ”¹å“åº”æ•°æ®ï¼Œè€Œæ˜¯æ‰§è¡Œä¸€äº›é¢å¤–é€»è¾‘ï¼Œæ¯”å¦‚è®°å½•æ—¥å¿—ã€æ›´æ–°ç¼“å­˜ç­‰</p>
<p>ä¸‹é¢çœ‹ä¸€ä¸‹è®°å½•æ—¥å¿—çš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Injectable</span>, <span class="hljs-title class_">NestInterceptor</span>, <span class="hljs-title class_">ExecutionContext</span>, <span class="hljs-title class_">CallHandler</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Observable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs'</span>;
<span class="hljs-keyword">import</span> { tap } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs/operators'</span>;

@<span class="hljs-title class_">Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LoggingInterceptor</span> implements <span class="hljs-title class_">NestInterceptor</span> {
  <span class="hljs-title function_">intercept</span>(<span class="hljs-attr">context</span>: <span class="hljs-title class_">ExecutionContext</span>, <span class="hljs-attr">next</span>: <span class="hljs-title class_">CallHandler</span>): <span class="hljs-title class_">Observable</span>&lt;any&gt; {
    <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    <span class="hljs-keyword">const</span> request = context.<span class="hljs-title function_">switchToHttp</span>().<span class="hljs-title function_">getRequest</span>();
    <span class="hljs-keyword">const</span> { method, url } = request; <span class="hljs-comment">// è·å–è¯·æ±‚æ–¹æ³•å’Œè·¯å¾„</span>

    <span class="hljs-comment">// æ‰§è¡Œæ§åˆ¶å™¨æ–¹æ³•ï¼Œå“åº”è¿”å›åè§¦å‘ tap å›è°ƒ</span>
    <span class="hljs-keyword">return</span> next.<span class="hljs-title function_">handle</span>().<span class="hljs-title function_">pipe</span>(
      <span class="hljs-title function_">tap</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[<span class="hljs-subst">${method}</span>] <span class="hljs-subst">${url}</span> è€—æ—¶: <span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now() - now}</span>ms`</span>);
        <span class="hljs-comment">// è¾“å‡ºç¤ºä¾‹ï¼š[GET] /api/users è€—æ—¶: 15ms</span>
      })
    );
  }
}
</code></pre>
<p>å¯¹äºé«˜é¢‘è®¿é—®ã€æ•°æ®å˜æ›´å°‘çš„æ¥å£ï¼ˆæ¯”å¦‚é¦–é¡µé…ç½®ã€å•†å“åˆ†ç±»ï¼‰ï¼Œå¯ä»¥ç”¨æ‹¦æˆªå™¨ + tap æ¥ç¼“å­˜å“åº”ç»“æœï¼ŒæŒ‡å®šæ—¶é—´å†…é‡å¤è¯·æ±‚ç›´æ¥è¿”å›ç¼“å­˜ï¼Œæå‡æ€§èƒ½ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Injectable</span>, <span class="hljs-title class_">NestInterceptor</span>, <span class="hljs-title class_">ExecutionContext</span>, <span class="hljs-title class_">CallHandler</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Observable</span>, <span class="hljs-keyword">of</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs'</span>;
<span class="hljs-keyword">import</span> { tap } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs/operators'</span>;

<span class="hljs-comment">// ç¼“å­˜å®¹å™¨</span>
<span class="hljs-keyword">const</span> cache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>&lt;string, { <span class="hljs-attr">data</span>: any; <span class="hljs-attr">expire</span>: number }&gt;();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">CACHE_TTL</span> = <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>; <span class="hljs-comment">// ç¼“å­˜1åˆ†é’Ÿ</span>

@<span class="hljs-title class_">Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CacheInterceptor</span> implements <span class="hljs-title class_">NestInterceptor</span> {
  <span class="hljs-title function_">intercept</span>(<span class="hljs-attr">context</span>: <span class="hljs-title class_">ExecutionContext</span>, <span class="hljs-attr">next</span>: <span class="hljs-title class_">CallHandler</span>): <span class="hljs-title class_">Observable</span>&lt;any&gt; {
    <span class="hljs-keyword">const</span> request = context.<span class="hljs-title function_">switchToHttp</span>().<span class="hljs-title function_">getRequest</span>();
    <span class="hljs-keyword">const</span> cacheKey = <span class="hljs-string">`<span class="hljs-subst">${request.method}</span>:<span class="hljs-subst">${request.url}</span>`</span>; <span class="hljs-comment">// ç¼“å­˜é”®ï¼šæ–¹æ³•+è·¯å¾„</span>

    <span class="hljs-comment">// æ£€æŸ¥ç¼“å­˜æ˜¯å¦å­˜åœ¨ä¸”æœªè¿‡æœŸ</span>
    <span class="hljs-keyword">const</span> cached = cache.<span class="hljs-title function_">get</span>(cacheKey);
    <span class="hljs-keyword">if</span> (cached &amp;&amp; <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() &lt; cached.<span class="hljs-property">expire</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">of</span>(cached.<span class="hljs-property">data</span>); <span class="hljs-comment">// ç›´æ¥è¿”å›ç¼“å­˜æ•°æ®ï¼Œä¸æ‰§è¡Œæ§åˆ¶å™¨æ–¹æ³•</span>
    }

    <span class="hljs-comment">// æ‰§è¡Œæ§åˆ¶å™¨æ–¹æ³•ï¼Œç¼“å­˜ç»“æœ</span>
    <span class="hljs-keyword">return</span> next.<span class="hljs-title function_">handle</span>().<span class="hljs-title function_">pipe</span>(
      <span class="hljs-title function_">tap</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
        cache.<span class="hljs-title function_">set</span>(cacheKey, {
          data,
          <span class="hljs-attr">expire</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() + <span class="hljs-variable constant_">CACHE_TTL</span>,
        });
      })
    );
  }
}
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ tap ä¸­æŠŠè¯·æ±‚ç»“æœç¼“å­˜èµ·æ¥ï¼Œä¸‹æ¬¡å†ç”¨æ—¶ç›´æ¥è¿”å›ç¼“å­˜ã€‚</p>
<h2 data-id="heading-2">catchError</h2>
<p>controller é‡Œå¾ˆå¯èƒ½ä¼šæŠ›å‡ºé”™è¯¯ï¼Œè¿™äº›é”™è¯¯ä¼šè¢« exception filter å¤„ç†ï¼Œè¿”å›ä¸åŒçš„å“åº”ï¼Œä½†åœ¨é‚£ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ interceptor é‡Œå…ˆå¤„ç†ä¸‹ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">CallHandler</span>, <span class="hljs-title class_">ExecutionContext</span>, <span class="hljs-title class_">Injectable</span>, <span class="hljs-title class_">Logger</span>, <span class="hljs-title class_">NestInterceptor</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { catchError, <span class="hljs-title class_">Observable</span>, throwError } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs'</span>;

@<span class="hljs-title class_">Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CatchErrorTestInterceptor</span> implements <span class="hljs-title class_">NestInterceptor</span> {
  private readonly logger = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Logger</span>(<span class="hljs-title class_">CatchErrorTestInterceptor</span>.<span class="hljs-property">name</span>)

  intercept (<span class="hljs-attr">context</span>: <span class="hljs-title class_">ExecutionContext</span>, <span class="hljs-attr">next</span>: <span class="hljs-title class_">CallHandler</span>): <span class="hljs-title class_">Observable</span>&lt;any&gt; {
    <span class="hljs-keyword">return</span> next.<span class="hljs-title function_">handle</span>().<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">catchError</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">logger</span>.<span class="hljs-title function_">error</span>(err.<span class="hljs-property">message</span>, err.<span class="hljs-property">stack</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">throwError</span>(<span class="hljs-function">() =&gt;</span> err)
    }))
  }
}
</code></pre>
<p>è¿™é‡Œæˆ‘ä»¬å°±æ˜¯æ—¥å¿—è®°å½•äº†ä¸€ä¸‹ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥æ”¹æˆå¦ä¸€ç§é”™è¯¯ï¼Œé‡æ–° throwErrorã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c965c19647c44eb1adc59e74e1f209fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173316&amp;x-signature=m7oBESOK5OhBxN0B9ZFb%2BGw83Vc%3D" alt="image.png" loading="lazy"/></p>
<p>æ‰“å°äº†ä¸¤æ¬¡é”™è¯¯ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1fc595b85be94a9fa18c420467616caa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173316&amp;x-signature=rM%2FVWgTtnOWgBdkH%2FTN8jyhJNj0%3D" alt="image.png" loading="lazy"/></p>
<p>ä¸€æ¬¡æ˜¯æˆ‘ä»¬åœ¨ interceptor é‡Œæ‰“å°çš„ï¼Œä¸€æ¬¡æ˜¯ exception filter æ‰“å°çš„ã€‚</p>
<h2 data-id="heading-3">timeout</h2>
<p>æ¥å£å¦‚æœé•¿æ—¶é—´æ²¡è¿”å›ï¼Œè¦ç»™ç”¨æˆ·ä¸€ä¸ªæ¥å£è¶…æ—¶çš„å“åº”ï¼Œè¿™æ—¶å€™å°±å¯ä»¥ç”¨ timeout operatorã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">CallHandler</span>, <span class="hljs-title class_">ExecutionContext</span>, <span class="hljs-title class_">Injectable</span>, <span class="hljs-title class_">NestInterceptor</span>, <span class="hljs-title class_">RequestTimeoutException</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { catchError, <span class="hljs-title class_">Observable</span>, throwError, timeout, <span class="hljs-title class_">TimeoutError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs'</span>;

@<span class="hljs-title class_">Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TimeoutInterceptor</span> implements <span class="hljs-title class_">NestInterceptor</span> {
  <span class="hljs-title function_">intercept</span>(<span class="hljs-attr">context</span>: <span class="hljs-title class_">ExecutionContext</span>, <span class="hljs-attr">next</span>: <span class="hljs-title class_">CallHandler</span>): <span class="hljs-title class_">Observable</span>&lt;any&gt; {
    <span class="hljs-keyword">return</span> next.<span class="hljs-title function_">handle</span>().<span class="hljs-title function_">pipe</span>(
      <span class="hljs-title function_">timeout</span>(<span class="hljs-number">3000</span>),
      <span class="hljs-title function_">catchError</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {
        <span class="hljs-keyword">if</span>(err <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">TimeoutError</span>) {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err);
          <span class="hljs-keyword">return</span> <span class="hljs-title function_">throwError</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RequestTimeoutException</span>());
        }
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">throwError</span>(<span class="hljs-function">() =&gt;</span> err);
      })
    )
  }
}
</code></pre>
<p>imeout æ“ä½œç¬¦ä¼šåœ¨ 3s æ²¡æ”¶åˆ°æ¶ˆæ¯çš„æ—¶å€™æŠ›ä¸€ä¸ª TimeoutErrorã€‚</p>
<p>ç„¶åç”¨ catchError æ“ä½œç¬¦å¤„ç†ä¸‹ï¼Œå¦‚æœæ˜¯ TimeoutErrorï¼Œå°±è¿”å› RequestTimeoutExceptionï¼Œè¿™ä¸ªæœ‰å†…ç½®çš„ exception filter ä¼šå¤„ç†æˆå¯¹åº”çš„å“åº”æ ¼å¼ã€‚</p>
<p>å…¶ä½™é”™è¯¯å°±ç›´æ¥ throwError æŠ›å‡ºå»ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2e05b373a1f1492dbc4e25c906d9bff0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173316&amp;x-signature=%2FqbewykQmCa5q0nQZ9KqCSrkFq4%3D" alt="image.png" loading="lazy"/></p>
<p>æœ€åï¼Œå†æ¥çœ‹ä¸‹å…¨å±€çš„ interceptorï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ff28ddb44ab2402eb2f3401baaf7c5e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173316&amp;x-signature=7d4fRxY8yy5F%2Ff5zEUcSuvDFLWs%3D" alt="image.png" loading="lazy"/></p>
<p>å› ä¸ºè¿™ç§æ˜¯æ‰‹åŠ¨ new çš„ï¼Œæ²¡æ³•æ³¨å…¥ä¾èµ–ã€‚</p>
<p>ä½†å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬æ˜¯éœ€è¦å…¨å±€ interceptor çš„ï¼Œè€Œä¸”è¿˜ç”¨åˆ°ä¸€äº› providerï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>nest æä¾›äº†ä¸€ä¸ª tokenï¼Œç”¨è¿™ä¸ª token åœ¨ AppModule é‡Œå£°æ˜çš„ interceptorï¼ŒNest ä¼šæŠŠå®ƒä½œä¸ºå…¨å±€ interceptorï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b45c07e360ba4b98a459af3e22656037~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173316&amp;x-signature=6ZQy9QnDYWNRsui%2By9lxBPNbWyA%3D" alt="image.png" loading="lazy"/></p>
<p>åœ¨è¿™ä¸ª interceptor é‡Œæˆ‘ä»¬æ³¨å…¥äº† appServiceï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/11d382741f2f4f2b8885f5cb525ed442~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173316&amp;x-signature=x6%2By4tyiui43IjglRH2qp20Mths%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-4">æ€»ç»“</h2>
<p>rxjs æ˜¯ä¸€ä¸ªå¤„ç†å¼‚æ­¥é€»è¾‘çš„åº“ï¼Œå®ƒçš„ç‰¹ç‚¹å°±æ˜¯ operator å¤šï¼Œä½ å¯ä»¥é€šè¿‡ç»„åˆ operator æ¥å®Œæˆé€»è¾‘ï¼Œä¸éœ€è¦è‡ªå·±å†™ã€‚</p>
<p>nest çš„ interceptor å°±ç”¨äº† rxjs æ¥å¤„ç†å“åº”ï¼Œä½†å¸¸ç”¨çš„ operator ä¹Ÿå°±è¿™ä¹ˆå‡ ä¸ªï¼š</p>
<ul>
<li>tap: ä¸ä¿®æ”¹å“åº”æ•°æ®ï¼Œæ‰§è¡Œä¸€äº›é¢å¤–é€»è¾‘ï¼Œæ¯”å¦‚è®°å½•æ—¥å¿—ã€æ›´æ–°ç¼“å­˜ç­‰</li>
<li>mapï¼šå¯¹å“åº”æ•°æ®åšä¿®æ”¹ï¼Œä¸€èˆ¬éƒ½æ˜¯æ”¹æˆ {code, data, message} çš„æ ¼å¼</li>
<li>catchErrorï¼šåœ¨ exception filter ä¹‹å‰å¤„ç†æŠ›å‡ºçš„å¼‚å¸¸ï¼Œå¯ä»¥è®°å½•æˆ–è€…æŠ›å‡ºåˆ«çš„å¼‚å¸¸</li>
<li>timeoutï¼šå¤„ç†å“åº”è¶…æ—¶çš„æƒ…å†µï¼ŒæŠ›å‡ºä¸€ä¸ª TimeoutErrorï¼Œé…åˆ catchErrror å¯ä»¥è¿”å›è¶…æ—¶çš„å“åº”</li>
</ul>
<p>æ€»ä¹‹ï¼Œrxjs çš„ operator å¤šï¼Œä½†æ˜¯é€‚åˆåœ¨ nest interceptor é‡Œç”¨çš„ä¹Ÿä¸å¤šã€‚</p>
<p>æ­¤å¤–ï¼Œinterceptor ä¹Ÿæ˜¯å¯ä»¥æ³¨å…¥ä¾èµ–çš„ï¼Œä½ å¯ä»¥é€šè¿‡æ³¨å…¥æ¨¡å—å†…çš„å„ç§ providerã€‚</p>
<p>å…¨å±€ interceptor å¯ä»¥é€šè¿‡ APP_INTERCEPTOR çš„ token å£°æ˜ï¼Œè¿™ç§èƒ½æ³¨å…¥ä¾èµ–ï¼Œæ¯” app.useGlobalInterceptors æ›´å¥½ã€‚</p>
<p>interceptor æ˜¯ nest å¿…ç”¨åŠŸèƒ½ï¼Œè¿˜æ˜¯è¦å¥½å¥½æŒæ¡çš„ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥ç†è§£JavaScriptè¯æ³•ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾]]></title>    <link>https://juejin.cn/post/7599912857392873518</link>    <guid>https://juejin.cn/post/7599912857392873518</guid>    <pubDate>2026-01-28T02:47:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599912857392873518" data-draft-id="7599963665039376434" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥ç†è§£JavaScriptè¯æ³•ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-01-28T02:47:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="wuhen_n"/> <meta itemprop="url" content="https://juejin.cn/user/4149996261738233"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥ç†è§£JavaScriptè¯æ³•ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4149996261738233/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    wuhen_n
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:47:06.000Z" title="Wed Jan 28 2026 02:47:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä¸ºä»€ä¹ˆ JavaScript çš„å‡½æ•°æ€»èƒ½æ¸…æ¥šåœ°"è®°ä½"å˜é‡åœ¨å“ªé‡Œè¢«å®šä¹‰ï¼Ÿä¸ºä»€ä¹ˆé—­åŒ…å¦‚æ­¤ç¥å¥‡ï¼Ÿè¿™ä¸€åˆ‡çš„ç­”æ¡ˆéƒ½éšè—åœ¨"è¯æ³•ä½œç”¨åŸŸ"è¿™ä¸ªæ ¸å¿ƒæ¦‚å¿µä¸­ã€‚</p>
</blockquote>
<h2 data-id="heading-0">å‰è¨€ï¼šä»ä¸€é“ç»å…¸é¢è¯•é¢˜è¯´èµ·</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">outer</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">var</span> a = <span class="hljs-number">2</span>;
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">inner</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a);
    }
    <span class="hljs-keyword">return</span> inner;
}

<span class="hljs-keyword">var</span> innerFunc = <span class="hljs-title function_">outer</span>();
<span class="hljs-title function_">innerFunc</span>(); <span class="hljs-comment">// è¾“å‡ºä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</span>
</code></pre>
<p>å¤§å¤šæ•°å‰ç«¯å¼€å‘è€…éƒ½çŸ¥é“è¾“å‡ºç»“æœä¸ºï¼š2ï¼Œä½†èƒ½å®Œæ•´è§£é‡Š"ä¸ºä»€ä¹ˆ"çš„äººå´ä¸å¤šã€‚æœ¬ç¯‡æ–‡ç« å°±æ¥å½»åº•æ­å¼€JavaScriptä½œç”¨åŸŸçš„ç¥ç§˜é¢çº±ã€‚</p>
<h2 data-id="heading-1">ä»€ä¹ˆæ˜¯è¯æ³•ä½œç”¨åŸŸï¼Ÿ</h2>
<h3 data-id="heading-2">é™æ€ä½œç”¨åŸŸ vs åŠ¨æ€ä½œç”¨åŸŸ</h3>
<p><strong>è¯æ³•ä½œç”¨åŸŸ</strong>ï¼ˆLexical Scopeï¼‰ï¼Œä¹Ÿç§°ä¸º<strong>é™æ€ä½œç”¨åŸŸ</strong>ï¼Œæ˜¯ JavaScript é‡‡ç”¨çš„ä½œç”¨åŸŸæ¨¡å‹ã€‚å®ƒçš„æ ¸å¿ƒç‰¹ç‚¹æ˜¯ï¼š</p>
<blockquote>
<p>å‡½æ•°çš„ä½œç”¨åŸŸåœ¨å‡½æ•°å®šä¹‰æ—¶å°±ç¡®å®šäº†ï¼Œè€Œä¸æ˜¯åœ¨å‡½æ•°è°ƒç”¨æ—¶ç¡®å®šã€‚</p>
</blockquote>
<p>è¿™ä¸<strong>åŠ¨æ€ä½œç”¨åŸŸ</strong>å½¢æˆé²œæ˜å¯¹æ¯”ã€‚è®©æˆ‘ä»¬é€šè¿‡ä»£ç ç†è§£ä¸¤è€…çš„åŒºåˆ«ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">var</span> value = <span class="hljs-string">"global"</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value);
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">bar</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">var</span> value = <span class="hljs-string">"local"</span>;
    <span class="hljs-title function_">foo</span>(); <span class="hljs-comment">// è¾“å‡ºä»€ä¹ˆï¼Ÿ</span>
}

<span class="hljs-title function_">bar</span>(); 
</code></pre>
<p>ä¸Šè¿°ä»£ç çš„è¾“å‡ºç»“æœæ˜¯ï¼š<code>global</code>ã€‚å› ä¸º <code>foo()</code> å‡½æ•°åœ¨å®šä¹‰æ—¶ï¼Œå®ƒçš„ä½œç”¨åŸŸé“¾å°±å·²ç¡®å®šï¼ŒåŒ…å«å…¨å±€ä½œç”¨åŸŸã€‚æ‰€ä»¥å®ƒè®¿é—®çš„æ˜¯å…¨å±€çš„ <code>value</code> å˜é‡ï¼Œè€Œä¸æ˜¯è°ƒç”¨ä½ç½®çš„ <code>value</code> ã€‚</p>
<p>å¦‚æœJavaScriptåŠ¨æ€ä½œç”¨åŸŸï¼ˆå®é™…ä¸Šä¸æ˜¯ï¼‰ï¼Œåˆä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">var</span> value = <span class="hljs-string">"global"</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value); <span class="hljs-comment">// åŠ¨æ€ä½œç”¨åŸŸä¸‹ï¼šè®¿é—®è°ƒç”¨ä½ç½®çš„value</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">bar</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">var</span> value = <span class="hljs-string">"local"</span>;
    <span class="hljs-title function_">foo</span>(); <span class="hljs-comment">// åŠ¨æ€ä½œç”¨åŸŸä¸‹ä¼šè¾“å‡ºï¼š"local"</span>
}
<span class="hljs-title function_">bar</span>();
</code></pre>
<h4 data-id="heading-3">å…³é”®åŒºåˆ«æ€»ç»“</h4>
<ul>
<li>è¯æ³•ä½œç”¨åŸŸï¼šå‡½æ•°çš„ä½œç”¨åŸŸç”±å®šä¹‰ä½ç½®å†³å®šã€‚</li>
<li>åŠ¨æ€ä½œç”¨åŸŸï¼šå‡½æ•°çš„ä½œç”¨åŸŸç”±è°ƒç”¨ä½ç½®å†³å®šã€‚</li>
</ul>
<h3 data-id="heading-4">è¯æ³•ç¯å¢ƒçš„ç»“æ„</h3>
<p>åœ¨ JavaScript å¼•æ“å†…éƒ¨ï¼Œæ¯ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡éƒ½æœ‰ä¸€ä¸ªå…³è”çš„<strong>è¯æ³•ç¯å¢ƒ</strong>ï¼ˆLexical Environmentï¼‰ã€‚è¯æ³•ç¯å¢ƒç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š<strong>ç¯å¢ƒè®°å½•å™¨</strong>ï¼ˆEnvironmentRecordï¼‰å’Œ<strong>å¯¹å¤–éƒ¨è¯æ³•ç¯å¢ƒçš„å¼•ç”¨</strong>ï¼ˆOuterï¼‰ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">LexicalEnvironment</span> = {
    <span class="hljs-title class_">EnvironmentRecord</span>: {
        <span class="hljs-comment">// 1. ç¯å¢ƒè®°å½•å™¨ï¼šå­˜å‚¨å˜é‡å’Œå‡½æ•°å£°æ˜</span>
        <span class="hljs-comment">// åŒ…å«ï¼šå£°æ˜å¼ç¯å¢ƒè®°å½•ã€å¯¹è±¡ç¯å¢ƒè®°å½•</span>
    },
    <span class="hljs-title class_">Outer</span>: <span class="hljs-literal">null</span> | &lt;çˆ¶çº§è¯æ³•ç¯å¢ƒå¼•ç”¨&gt;  <span class="hljs-comment">// 2. å¯¹å¤–éƒ¨è¯æ³•ç¯å¢ƒçš„å¼•ç”¨</span>
}

<span class="hljs-comment">// å®é™…ä»£ç ç¤ºä¾‹</span>
<span class="hljs-keyword">var</span> globalVar = <span class="hljs-string">"global"</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">outer</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">var</span> outerVar = <span class="hljs-string">"outer"</span>;
    
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">inner</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">var</span> innerVar = <span class="hljs-string">"inner"</span>;
        <span class="hljs-comment">// innerå‡½æ•°çš„è¯æ³•ç¯å¢ƒï¼š</span>
        <span class="hljs-comment">// {</span>
        <span class="hljs-comment">//     EnvironmentRecord: { innerVar: "inner" },</span>
        <span class="hljs-comment">//     Outer: &lt;outerå‡½æ•°çš„è¯æ³•ç¯å¢ƒ&gt;</span>
        <span class="hljs-comment">// }</span>
    }
}
</code></pre>
<h3 data-id="heading-5">ä½œç”¨åŸŸé“¾çš„å½¢æˆè¿‡ç¨‹</h3>
<p>ä½œç”¨åŸŸé“¾å°±æ˜¯ç”±è¿™äº›è¯æ³•ç¯å¢ƒé€šè¿‡ <code>Outer</code> å¼•ç”¨è¿æ¥èµ·æ¥çš„é“¾å¼ç»“æ„ã€‚</p>
<h2 data-id="heading-6">ä½œç”¨åŸŸé“¾çš„æŸ¥æ‰¾æœºåˆ¶</h2>
<h3 data-id="heading-7">å˜é‡æŸ¥æ‰¾çš„å®Œæ•´æµç¨‹</h3>
<p>å½“ JavaScript å¼•æ“éœ€è¦è®¿é—®ä¸€ä¸ªå˜é‡æ—¶ï¼Œå®ƒä¼šæŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡ŒæŸ¥æ‰¾ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¤šå±‚åµŒå¥—ä½œç”¨åŸŸç¤ºä¾‹</span>
<span class="hljs-keyword">var</span> a = <span class="hljs-string">"global a"</span>;
<span class="hljs-keyword">var</span> b = <span class="hljs-string">"global b"</span>;
<span class="hljs-keyword">var</span> c = <span class="hljs-string">"global c"</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">level1</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">var</span> a = <span class="hljs-string">"level1 a"</span>;
    <span class="hljs-keyword">var</span> b = <span class="hljs-string">"level1 b"</span>;   
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">level2</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">var</span> a = <span class="hljs-string">"level2 a"</span>;
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">level3</span>(<span class="hljs-params"/>) {
            <span class="hljs-keyword">var</span> a = <span class="hljs-string">"level3 a"</span>;
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a); <span class="hljs-comment">// "level3 a" - æ‰¾åˆ°æœ€è¿‘çš„a</span>
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(b); <span class="hljs-comment">// "level1 b" - å‘ä¸Šä¸¤å±‚æ‰¾åˆ°b</span>
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(c); <span class="hljs-comment">// "global c" - å‘ä¸Šä¸‰å±‚æ‰¾åˆ°c</span>
        }
        <span class="hljs-title function_">level3</span>();
    }
    <span class="hljs-title function_">level2</span>();
}
<span class="hljs-title function_">level1</span>();
</code></pre>
<p>æŸ¥æ‰¾å˜é‡cçš„è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>æ£€æŸ¥level3çš„ç¯å¢ƒè®°å½• â†’ æ²¡æœ‰c</li>
<li>é€šè¿‡Outerå¼•ç”¨æ£€æŸ¥level2çš„ç¯å¢ƒè®°å½• â†’ æ²¡æœ‰c</li>
<li>é€šè¿‡Outerå¼•ç”¨æ£€æŸ¥level1çš„ç¯å¢ƒè®°å½• â†’ æ²¡æœ‰c</li>
<li>é€šè¿‡Outerå¼•ç”¨æ£€æŸ¥å…¨å±€ç¯å¢ƒè®°å½• â†’ æ‰¾åˆ°c = "global c"</li>
<li>å¦‚æœä¸€ç›´æ‰¾åˆ°æœ€å¤–å±‚éƒ½æ²¡æ‰¾åˆ°ï¼šundefined</li>
</ol>
<h3 data-id="heading-8">å›¾è§£ï¼šä½œç”¨åŸŸé“¾çš„æ ‘çŠ¶ç»“æ„</h3>
<p>è®©æˆ‘ä»¬ç”¨å¯è§†åŒ–æ–¹å¼ç†è§£ä½œç”¨åŸŸé“¾ï¼š</p>
<pre><code class="hljs language-text" lang="text">å…¨å±€è¯æ³•ç¯å¢ƒ (Global Lexical Environment)
â”œâ”€ EnvironmentRecord: { a: "global a", b: "global b", c: "global c" }
â”œâ”€ Outer: null
â”‚
â”œâ”€ level1å‡½æ•°è¯æ³•ç¯å¢ƒ (è°ƒç”¨æ—¶åˆ›å»º)
â”‚  â”œâ”€ EnvironmentRecord: { a: "level1 a", b: "level1 b" }
â”‚  â”œâ”€ Outer: å¼•ç”¨ â†’ å…¨å±€è¯æ³•ç¯å¢ƒ
â”‚  â”‚
â”‚  â”œâ”€ level2å‡½æ•°è¯æ³•ç¯å¢ƒ (è°ƒç”¨æ—¶åˆ›å»º)
â”‚  â”‚  â”œâ”€ EnvironmentRecord: { a: "level2 a" }
â”‚  â”‚  â”œâ”€ Outer: å¼•ç”¨ â†’ level1è¯æ³•ç¯å¢ƒ
â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€ level3å‡½æ•°è¯æ³•ç¯å¢ƒ (è°ƒç”¨æ—¶åˆ›å»º)
â”‚  â”‚  â”‚  â”œâ”€ EnvironmentRecord: { a: "level3 a" }
â”‚  â”‚  â”‚  â”œâ”€ Outer: å¼•ç”¨ â†’ level2è¯æ³•ç¯å¢ƒ
â”‚  â”‚  â”‚  â””â”€ å˜é‡æŸ¥æ‰¾è·¯å¾„ï¼šlevel3 â†’ level2 â†’ level1 â†’ å…¨å±€
â”‚  â”‚  â””â”€ 
â”‚  â””â”€ 
â””â”€
</code></pre>
<h3 data-id="heading-9">ä½œç”¨åŸŸé“¾çš„å…³é”®ç‰¹æ€§</h3>
<ol>
<li>é™æ€æ€§ï¼ˆè¯æ³•ä½œç”¨åŸŸï¼‰ï¼šä½œç”¨åŸŸé“¾åœ¨å‡½æ•°å®šä¹‰æ—¶å°±å·²ç»ç¡®å®šï¼Œè€Œä¸æ˜¯åœ¨è°ƒç”¨æ—¶ç¡®å®šçš„ã€‚</li>
<li>é“¾å¼ç»“æ„ï¼šåƒé“¾æ¡ä¸€æ ·ä¸€ç¯æ‰£ä¸€ç¯ï¼Œä»å½“å‰ä½œç”¨åŸŸæŒ‡å‘å¤–å±‚ä½œç”¨åŸŸã€‚</li>
<li>å•å‘æ€§ï¼šåªèƒ½ä»å†…å±‚ä½œç”¨åŸŸè®¿é—®å¤–å±‚ä½œç”¨åŸŸçš„å˜é‡ï¼Œä¸èƒ½åå‘è®¿é—®ã€‚</li>
<li>ä¸æ‰§è¡Œä¸Šä¸‹æ–‡ç›¸å…³ï¼šæ¯æ¬¡å‡½æ•°è°ƒç”¨éƒ½ä¼šåˆ›å»ºæ–°çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œä½†ä½œç”¨åŸŸé“¾åŸºäºå‡½æ•°å®šä¹‰ä½ç½®ç¡®å®šã€‚</li>
</ol>
<h3 data-id="heading-10">é—­åŒ…ä¸ä½œç”¨åŸŸé“¾çš„æŒä¹…åŒ–</h3>
<p>é—­åŒ…çš„æœ¬è´¨å°±æ˜¯ï¼š<code>å‡½æ•°è®°ä½äº†å®ƒè¢«åˆ›å»ºæ—¶çš„è¯æ³•ç¯å¢ƒ</code>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createCounter</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;  <span class="hljs-comment">// è¿™ä¸ªå˜é‡æœ¬è¯¥åœ¨å‡½æ•°æ‰§è¡Œåé”€æ¯</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
        count++;  <span class="hljs-comment">// ä¿æŒå¯¹å¤–éƒ¨å˜é‡çš„å¼•ç”¨ï¼Œè¿™å°±æ˜¯é—­åŒ…</span>
        <span class="hljs-keyword">return</span> count;
    };
}

<span class="hljs-keyword">const</span> counter = <span class="hljs-title function_">createCounter</span>();

<span class="hljs-comment">// å³ä½¿createCounteræ‰§è¡Œå®Œæ¯•ï¼Œå®ƒçš„è¯æ³•ç¯å¢ƒä¹Ÿä¸ä¼šè¢«é”€æ¯</span>
<span class="hljs-comment">// å› ä¸ºè¿”å›çš„å†…éƒ¨å‡½æ•°ä»ç„¶å¼•ç”¨ç€å®ƒ</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">counter</span>()); <span class="hljs-comment">// 1</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">counter</span>()); <span class="hljs-comment">// 2</span>
</code></pre>
<h2 data-id="heading-11">å—çº§ä½œç”¨åŸŸçš„å®ç°åŸç†</h2>
<h3 data-id="heading-12">ES5ä½œç”¨åŸŸçš„é—®é¢˜</h3>
<p>åœ¨ES5ä¸­ï¼Œåªæœ‰ä¸¤ç§ä½œç”¨åŸŸï¼šå…¨å±€ä½œç”¨åŸŸå’Œå‡½æ•°ä½œç”¨åŸŸã€‚è¿™å¯¼è‡´äº†ä¸€äº›é—®é¢˜ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ES5çš„é—®é¢˜ï¼šå˜é‡æå‡å’Œç¼ºå°‘å—çº§ä½œç”¨åŸŸ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">problematic</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(i); <span class="hljs-comment">// undefinedï¼Œè€Œä¸æ˜¯ReferenceError</span>
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
        <span class="hljs-comment">// iåœ¨æ•´ä¸ªå‡½æ•°å†…éƒ½å¯è§</span>
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(i); <span class="hljs-comment">// å…¨éƒ¨è¾“å‡º3</span>
        }, <span class="hljs-number">100</span>);
    }
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(i); <span class="hljs-comment">// 3ï¼Œå¾ªç¯ç»“æŸåçš„i</span>
}

<span class="hljs-title function_">problematic</span>();
</code></pre>
<h3 data-id="heading-13">let/constå¸¦æ¥çš„å—çº§ä½œç”¨åŸŸ</h3>
<p>ES6å¼•å…¥çš„ <code>let/const</code> å¸¦æ¥äº†çœŸæ­£çš„å—çº§ä½œç”¨åŸŸï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å—çº§ä½œç”¨åŸŸç¤ºä¾‹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">withBlockScope</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-literal">true</span>) {
        <span class="hljs-comment">// å—çº§ä½œç”¨åŸŸå¼€å§‹</span>
        <span class="hljs-keyword">let</span> blockScoped = <span class="hljs-string">"åªåœ¨å—å†…æœ‰æ•ˆ"</span>;
        <span class="hljs-keyword">const</span> constantValue = <span class="hljs-string">"å¸¸é‡"</span>;
        {
            <span class="hljs-comment">// åµŒå¥—å—çº§ä½œç”¨åŸŸ</span>
            <span class="hljs-keyword">let</span> nestedBlock = <span class="hljs-string">"åµŒå¥—å—"</span>;
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(blockScoped); <span class="hljs-comment">// å¯ä»¥è®¿é—®å¤–å±‚å—çš„å˜é‡</span>
        }
        <span class="hljs-comment">// console.log(nestedBlock); // ReferenceError</span>
    }
    <span class="hljs-comment">// console.log(blockScoped); // ReferenceError</span>
}
</code></pre>
<h4 data-id="heading-14">let/constçš„å®ç°åŸç†ï¼š</h4>
<ol>
<li>åœ¨ç¼–è¯‘é˜¶æ®µï¼Œ<code>let/const</code> å£°æ˜çš„å˜é‡è¢«è®°å½•åœ¨è¯æ³•ç¯å¢ƒä¸­</li>
<li>åœ¨å˜é‡å£°æ˜ä¹‹å‰è®¿é—®ä¼šæŠ›å‡ºé”™è¯¯ï¼ˆæš‚æ—¶æ€§æ­»åŒºï¼‰</li>
<li>æ¯ä¸ª <code>{}</code> ä»£ç å—éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„è¯æ³•ç¯å¢ƒ</li>
</ol>
<h3 data-id="heading-15">å—çº§ä½œç”¨åŸŸçš„åµŒå¥—ç»“æ„</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¤šå±‚å—çº§ä½œç”¨åŸŸ</span>
{
    <span class="hljs-keyword">let</span> a = <span class="hljs-string">"å¤–å±‚å— a"</span>;
    <span class="hljs-keyword">const</span> b = <span class="hljs-string">"å¤–å±‚å— b"</span>;
    
    {
        <span class="hljs-keyword">let</span> a = <span class="hljs-string">"å†…å±‚å— a"</span>; <span class="hljs-comment">// å¯ä»¥é‡æ–°å£°æ˜ï¼Œå› ä¸ºä¸åŒå—</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a);    <span class="hljs-comment">// "å†…å±‚å— a"</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(b);    <span class="hljs-comment">// "å¤–å±‚å— b" - å¯ä»¥è®¿é—®å¤–å±‚</span>
        
        {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a); <span class="hljs-comment">// "å†…å±‚å— a"</span>
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(b); <span class="hljs-comment">// "å¤–å±‚å— b"</span>
        }
    }
    
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a); <span class="hljs-comment">// "å¤–å±‚å— a"</span>
}
</code></pre>
<p>å…¶è¯æ³•ç¯å¢ƒç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-text" lang="text"> å¤–å±‚å—è¯æ³•ç¯å¢ƒ: { a: "å¤–å±‚å— a", b: "å¤–å±‚å— b", Outer: å…¨å±€ }
   â†“
 å†…å±‚å—è¯æ³•ç¯å¢ƒ: { a: "å†…å±‚å— a", Outer: å¤–å±‚å—è¯æ³•ç¯å¢ƒ }
   â†“
 æœ€å†…å±‚å—è¯æ³•ç¯å¢ƒ: { Outer: å†…å±‚å—è¯æ³•ç¯å¢ƒ }
</code></pre>
<h3 data-id="heading-16">æš‚æ—¶æ€§æ­»åŒºï¼ˆTemporal Dead Zoneï¼‰</h3>
<pre><code class="hljs language-javascript" lang="javascript">{
  <span class="hljs-comment">// TDZå¼€å§‹</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(myVar); <span class="hljs-comment">// undefined</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(myLet); <span class="hljs-comment">// ReferenceError</span>

  <span class="hljs-keyword">var</span> myVar = <span class="hljs-string">"varå˜é‡"</span>;
  <span class="hljs-keyword">let</span> myLet = <span class="hljs-string">"letå˜é‡"</span>;
  <span class="hljs-comment">// TDZç»“æŸ</span>
}
</code></pre>
<p>ä¸Šè¿°å®é™…æ‰§è¡Œè¿‡ç¨‹ï¼ˆç®€åŒ–ï¼‰ï¼š</p>
<ol>
<li>è¿›å…¥å—çº§ä½œç”¨åŸŸï¼Œåˆ›å»ºè¯æ³•ç¯å¢ƒ</li>
<li>varå£°æ˜è¢«æå‡ï¼Œåˆå§‹å€¼ä¸º undefined</li>
<li>letå£°æ˜è¢«è®°å½•ï¼Œä½†æœªåˆå§‹åŒ–ï¼ˆåœ¨TDZä¸­ä¸å¯è°ƒç”¨ï¼‰</li>
<li>åœ¨letåˆå§‹åŒ–å‰è®¿é—® â†’ ReferenceError</li>
</ol>
<h2 data-id="heading-17">å¸¸è§é¢è¯•é¢˜è§£æ</h2>
<h3 data-id="heading-18">å¤šçº§åµŒå¥—ä½œç”¨åŸŸ</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">var</span> x = <span class="hljs-number">10</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(x);
}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">bar</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">var</span> x = <span class="hljs-number">20</span>;
    <span class="hljs-title function_">foo</span>();
}
<span class="hljs-title function_">bar</span>(); <span class="hljs-comment">// è¾“å‡ºä»€ä¹ˆï¼Ÿ</span>
</code></pre>
<p>ä¸Šè¿°ä»£ç è¾“å‡ºç»“æœä¸ºï¼š10ï¼š</p>
<ol>
<li>fooå‡½æ•°å®šä¹‰åœ¨å…¨å±€ä½œç”¨åŸŸã€‚</li>
<li>å› æ­¤fooçš„è¯æ³•ä½œç”¨åŸŸé“¾ï¼šfooä½œç”¨åŸŸ â†’ å…¨å±€ä½œç”¨åŸŸã€‚</li>
<li>fooåœ¨å®šä¹‰æ—¶å°±ç¡®å®šäº†ä½œç”¨åŸŸé“¾ï¼Œä¸è°ƒç”¨ä½ç½®æ— å…³ã€‚</li>
<li>fooä¸­è®¿é—®xæ—¶ï¼Œåœ¨è‡ªèº«ä½œç”¨åŸŸæ²¡æ‰¾åˆ°ï¼Œåˆ°å…¨å±€ä½œç”¨åŸŸæ‰¾åˆ°<code>x=10</code> ã€‚</li>
</ol>
<h3 data-id="heading-19">é—­åŒ…ä¸å¾ªç¯</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createFunctions</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">var</span> result = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
        result[i] = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
            <span class="hljs-keyword">return</span> i;
        };
    }
    <span class="hljs-keyword">return</span> result;
}

<span class="hljs-keyword">var</span> funcs = <span class="hljs-title function_">createFunctions</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(funcs[<span class="hljs-number">0</span>]()); <span class="hljs-comment">// 3</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(funcs[<span class="hljs-number">1</span>]()); <span class="hljs-comment">// 3  </span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(funcs[<span class="hljs-number">2</span>]()); <span class="hljs-comment">// 3</span>
</code></pre>
<blockquote>
<p>è¯¦ç»†è§£æè¿‡ç¨‹ä¸è§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥æŸ¥çœ‹è¿™ç¯‡æ–‡ç« ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fwuhen_n%2Farticle%2Fdetails%2F157430747" target="_blank" title="https://blog.csdn.net/wuhen_n/article/details/157430747" ref="nofollow noopener noreferrer">JavaScriptå†…å­˜ç®¡ç†æ­ç§˜ï¼šå˜é‡ç©¶ç«Ÿå­˜åœ¨å“ªé‡Œ</a></p>
</blockquote>
<h3 data-id="heading-20">å¤æ‚çš„åµŒå¥—ä½œç”¨åŸŸ</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">test</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">var</span> a = <span class="hljs-number">2</span>;    
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">innerTest</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">var</span> a = <span class="hljs-number">3</span>;        
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a);
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">a</span>);
        };
    }    
    <span class="hljs-keyword">var</span> obj = {
        <span class="hljs-attr">a</span>: <span class="hljs-number">4</span>,
        <span class="hljs-attr">getFunc</span>: <span class="hljs-title function_">innerTest</span>()
    };   
    <span class="hljs-keyword">return</span> obj.<span class="hljs-property">getFunc</span>;
}
<span class="hljs-keyword">var</span> func = <span class="hljs-title function_">test</span>();
<span class="hljs-title function_">func</span>();
</code></pre>
<p>ä¸Šè¿°ä»£ç çš„è¾“å‡ºç»“æœæ˜¯ï¼š<code>3 1</code> :</p>
<ol>
<li><code>func</code> æ˜¯ <code>innerTest</code> è¿”å›çš„åŒ¿åå‡½æ•°</li>
<li>åŒ¿åå‡½æ•°å®šä¹‰åœ¨ <code>innerTest</code> å†…éƒ¨ï¼Œæ‰€ä»¥å®ƒçš„è¯æ³•ä½œç”¨åŸŸé“¾ï¼š
<ul>
<li>åŒ¿åå‡½æ•°ä½œç”¨åŸŸ â†’ <code>innerTest</code> ä½œç”¨åŸŸ(<code>a=3</code>) â†’ <code>test</code> ä½œç”¨åŸŸ(<code>a=2</code>) â†’ å…¨å±€(<code>a=1</code>)</li>
</ul>
</li>
<li><code>console.log(a)</code>ï¼šåœ¨è‡ªèº«ä½œç”¨åŸŸæ²¡æ‰¾åˆ°ï¼Œåˆ°innerTestæ‰¾åˆ°a=3</li>
<li><code>console.log(this.a)</code>ï¼š<code>this</code>æŒ‡å‘å…¨å±€ <code>window</code> å¯¹è±¡ï¼Œè¾“å‡ºå…¨å±€<code>a=1</code></li>
</ol>
<h2 data-id="heading-21">æ€è€ƒé¢˜</h2>
<p>å¦‚æœJavaScripté‡‡ç”¨åŠ¨æ€ä½œç”¨åŸŸè€Œä¸æ˜¯è¯æ³•ä½œç”¨åŸŸï¼Œä¼šæœ‰ä»€ä¹ˆå½±å“ï¼Ÿé—­åŒ…è¿˜èƒ½å·¥ä½œå—ï¼Ÿ</p>
<h2 data-id="heading-22">ç»“è¯­</h2>
<p>JavaScriptçš„è¯æ³•ä½œç”¨åŸŸæœºåˆ¶æ—¢æ˜¯å…¶å¼ºå¤§ä¹‹å¤„ï¼Œä¹Ÿæ˜¯åˆå­¦è€…å®¹æ˜“å›°æƒ‘çš„åœ°æ–¹ã€‚æ·±å…¥ç†è§£è¿™ä¸€æœºåˆ¶ï¼Œä¸ä»…èƒ½å¸®åŠ©ä½ å†™å‡ºæ›´å¥½çš„ä»£ç ï¼Œè¿˜èƒ½åœ¨é¢è¯•ä¸­æ¸¸åˆƒæœ‰ä½™åœ°è§£ç­”ç›¸å…³é¢˜ç›®ã€‚å¯¹äºæ–‡ç« ä¸­é”™è¯¯çš„åœ°æ–¹æˆ–è€…æœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€è®¨è®ºï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Everything Claude Code é¡¹ç›®å®Œå…¨æŒ‡å—ï¼Œå¦‚ä½•ä¼˜é›…çš„ä½¿ç”¨Claude]]></title>    <link>https://juejin.cn/post/7599965904616833070</link>    <guid>https://juejin.cn/post/7599965904616833070</guid>    <pubDate>2026-01-28T02:36:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599965904616833070" data-draft-id="7599951933593976842" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Everything Claude Code é¡¹ç›®å®Œå…¨æŒ‡å—ï¼Œå¦‚ä½•ä¼˜é›…çš„ä½¿ç”¨Claude"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-28T02:36:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Hhang"/> <meta itemprop="url" content="https://juejin.cn/user/1994944446213274"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Everything Claude Code é¡¹ç›®å®Œå…¨æŒ‡å—ï¼Œå¦‚ä½•ä¼˜é›…çš„ä½¿ç”¨Claude
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1994944446213274/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Hhang
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:36:28.000Z" title="Wed Jan 28 2026 02:36:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Everything Claude Code é¡¹ç›®å®Œå…¨æŒ‡å—</h2>
<blockquote>
<p>å°† Claude Code æ‰“é€ æˆä¸“ä¸šå¼€å‘ç¯å¢ƒçš„ç»ˆæé…ç½®å·¥å…·åŒ…</p>
</blockquote>
<h3 data-id="heading-1">ä¸€ã€é¡¹ç›®ç®€ä»‹</h3>
<h4 data-id="heading-2">ä»€ä¹ˆæ˜¯ Everything Claude Codeï¼Ÿ</h4>
<p><strong>Everything Claude Code</strong> æ˜¯ä¸€ä¸ªç”± Anthropic é»‘å®¢æ¾å† å†› <strong>Affaan Mustafa</strong> åˆ›å»ºçš„å¼€æºé¡¹ç›®ï¼Œæä¾›äº†ä¸€å¥—å®Œæ•´çš„ Claude Code é…ç½®é›†åˆï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>Agentsï¼ˆä»£ç†ï¼‰</strong>ï¼šä¸“ä¸šåŒ–çš„å­ä»£ç†ç”¨äºä»»åŠ¡å§”æ´¾</li>
<li><strong>Skillsï¼ˆæŠ€èƒ½ï¼‰</strong>ï¼šå·¥ä½œæµå®šä¹‰å’Œé¢†åŸŸçŸ¥è¯†</li>
<li><strong>Hooksï¼ˆé’©å­ï¼‰</strong>ï¼šåŸºäºè§¦å‘å™¨çš„è‡ªåŠ¨åŒ–</li>
<li><strong>Commandsï¼ˆå‘½ä»¤ï¼‰</strong>ï¼šå¿«é€Ÿæ‰§è¡Œçš„æ–œæ å‘½ä»¤</li>
<li><strong>Rulesï¼ˆè§„åˆ™ï¼‰</strong>ï¼šå§‹ç»ˆéµå¾ªçš„å¼€å‘å‡†åˆ™</li>
<li><strong>MCP Configsï¼ˆMCP é…ç½®ï¼‰</strong>ï¼šå¤šæ¨¡æ€èŠå¤©åè®®æœåŠ¡å™¨é…ç½®</li>
</ul>
<p>è¿™äº›é…ç½®æ˜¯ä½œè€…ç»è¿‡ <strong>10 ä¸ªå¤šæœˆçš„å¯†é›†æ—¥å¸¸ä½¿ç”¨</strong>ï¼Œåœ¨æ„å»ºçœŸå®äº§å“è¿‡ç¨‹ä¸­ä¸æ–­æ‰“ç£¨å½¢æˆçš„"å®æˆ˜éªŒè¯"é…ç½®ã€‚</p>
<h4 data-id="heading-3">é¡¹ç›®èƒŒæ™¯</h4>
<p>Affaan Mustafa è‡ª Claude Code å®éªŒæ€§å‘å¸ƒä»¥æ¥å°±ä¸€ç›´åœ¨ä½¿ç”¨å®ƒã€‚2025 å¹´ 9 æœˆï¼Œä»–ä¸é˜Ÿå‹ <a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2FDRodriguezFX" target="_blank" title="https://x.com/DRodriguezFX" ref="nofollow noopener noreferrer">@DRodriguezFX</a> ä½¿ç”¨è¿™å¥—é…ç½®ï¼Œä»…ç”¨ <strong>8 å°æ—¶</strong>å°±å®Œå…¨ä½¿ç”¨ Claude Code æ„å»ºäº† <a href="https://link.juejin.cn?target=https%3A%2F%2Fzenith.chat" target="_blank" title="https://zenith.chat" ref="nofollow noopener noreferrer">zenith.chat</a>ï¼Œå¹¶èµ¢å¾—äº† <strong>Anthropic x Forum Ventures é»‘å®¢æ¾</strong>ã€‚</p>
<h4 data-id="heading-4">è§£å†³çš„é—®é¢˜</h4>
<ul>
<li><strong>ä¸Šä¸‹æ–‡è…åŒ–</strong>ï¼šé•¿ä¼šè¯ä¸­çš„ä¸Šä¸‹æ–‡ç®¡ç†é—®é¢˜</li>
<li><strong>ä»£ç è´¨é‡ä¸ä¸€è‡´</strong>ï¼šç¼ºä¹ç»Ÿä¸€çš„ä»£ç æ ‡å‡†</li>
<li><strong>é‡å¤è§£é‡Šæµªè´¹æ—¶é—´</strong>ï¼šæ¯æ¬¡éƒ½è¦é‡æ–°è¯´æ˜é¡¹ç›®è§„èŒƒ</li>
</ul>
<hr/>
<h3 data-id="heading-5">äºŒã€æ ¸å¿ƒç»„ä»¶è¯¦è§£</h3>
<h4 data-id="heading-6">2.1 Agentsï¼ˆä»£ç†ï¼‰</h4>
<p>å­ä»£ç†æ˜¯å…·æœ‰æœ‰é™èŒƒå›´çš„å§”æ´¾ä»»åŠ¡å¤„ç†å™¨ã€‚é¡¹ç›®æä¾›äº†å¤šä¸ªä¸“ä¸šä»£ç†ï¼š</p>













































<table><thead><tr><th>ä»£ç†åç§°</th><th>åŠŸèƒ½è¯´æ˜</th></tr></thead><tbody><tr><td><code>planner.md</code></td><td>åŠŸèƒ½å®ç°è§„åˆ’</td></tr><tr><td><code>architect.md</code></td><td>ç³»ç»Ÿè®¾è®¡å†³ç­–</td></tr><tr><td><code>tdd-guide.md</code></td><td>æµ‹è¯•é©±åŠ¨å¼€å‘</td></tr><tr><td><code>code-reviewer.md</code></td><td>ä»£ç è´¨é‡å’Œå®‰å…¨å®¡æŸ¥</td></tr><tr><td><code>security-reviewer.md</code></td><td>æ¼æ´åˆ†æ</td></tr><tr><td><code>build-error-resolver.md</code></td><td>æ„å»ºé”™è¯¯è§£å†³</td></tr><tr><td><code>e2e-runner.md</code></td><td>Playwright E2E æµ‹è¯•</td></tr><tr><td><code>refactor-cleaner.md</code></td><td>æ­»ä»£ç æ¸…ç†</td></tr><tr><td><code>doc-updater.md</code></td><td>æ–‡æ¡£åŒæ­¥</td></tr></tbody></table>
<blockquote>
<p>é¡¹ç›®è¿˜æä¾›äº†é’ˆå¯¹ç‰¹å®šè¯­è¨€çš„ä»£ç†ï¼Œå¦‚ Go ä»£ç å®¡æŸ¥ã€Go æ„å»ºé”™è¯¯è§£å†³ç­‰ï¼Œä½ å¯ä»¥æ ¹æ®è‡ªå·±ä½¿ç”¨çš„æŠ€æœ¯æ ˆé€‰æ‹©æ€§å¯ç”¨ã€‚</p>
</blockquote>
<p><strong>ä»£ç†é…ç½®ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">code-reviewer</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">Reviews</span> <span class="hljs-string">code</span> <span class="hljs-string">for</span> <span class="hljs-string">quality,</span> <span class="hljs-string">security,</span> <span class="hljs-string">and</span> <span class="hljs-string">maintainability</span>
<span class="hljs-attr">tools:</span> [<span class="hljs-string">"Read"</span>, <span class="hljs-string">"Grep"</span>, <span class="hljs-string">"Glob"</span>, <span class="hljs-string">"Bash"</span>]
<span class="hljs-attr">model:</span> <span class="hljs-string">opus</span>
<span class="hljs-meta">---</span>
<span class="hljs-string">You</span> <span class="hljs-string">are</span> <span class="hljs-string">a</span> <span class="hljs-string">senior</span> <span class="hljs-string">code</span> <span class="hljs-string">reviewer...</span>
</code></pre>
<h4 data-id="heading-7">2.2 Skillsï¼ˆæŠ€èƒ½ï¼‰</h4>
<p>æŠ€èƒ½æ˜¯å·¥ä½œæµå®šä¹‰ï¼Œå¯è¢«å‘½ä»¤æˆ–ä»£ç†è°ƒç”¨ï¼š</p>









































<table><thead><tr><th>æŠ€èƒ½ç›®å½•</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>coding-standards/</code></td><td>å¤šè¯­è¨€æœ€ä½³å®è·µ</td></tr><tr><td><code>backend-patterns/</code></td><td>APIã€æ•°æ®åº“ã€ç¼“å­˜æ¨¡å¼</td></tr><tr><td><code>frontend-patterns/</code></td><td>Reactã€Next.jsã€Vue ç­‰å‰ç«¯æ¨¡å¼</td></tr><tr><td><code>continuous-learning/</code></td><td>ä»ä¼šè¯ä¸­è‡ªåŠ¨æå–æ¨¡å¼</td></tr><tr><td><code>continuous-learning-v2/</code></td><td>åŸºäºç›´è§‰çš„å­¦ä¹ ç³»ç»Ÿ</td></tr><tr><td><code>iterative-retrieval/</code></td><td>å­ä»£ç†çš„æ¸è¿›å¼ä¸Šä¸‹æ–‡ç»†åŒ–</td></tr><tr><td><code>tdd-workflow/</code></td><td>TDD æ–¹æ³•è®º</td></tr><tr><td><code>security-review/</code></td><td>å®‰å…¨æ£€æŸ¥æ¸…å•</td></tr></tbody></table>
<blockquote>
<p>é¡¹ç›®è¿˜æä¾›äº†é’ˆå¯¹ç‰¹å®šè¯­è¨€çš„æŠ€èƒ½ï¼ˆå¦‚ Goã€Pythonã€TypeScript ç­‰ï¼‰ï¼Œä½ å¯ä»¥æ ¹æ®é¡¹ç›®éœ€è¦é€‰æ‹©æ€§ä½¿ç”¨ã€‚</p>
</blockquote>
<p><strong>TDD å·¥ä½œæµç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># TDD Workflow</span>
<span class="hljs-bullet">1.</span> Define interfaces first
<span class="hljs-bullet">2.</span> Write failing tests (RED)
<span class="hljs-bullet">3.</span> Implement minimal code (GREEN)
<span class="hljs-bullet">4.</span> Refactor (IMPROVE)
<span class="hljs-bullet">5.</span> Verify 80%+ coverage
</code></pre>
<h4 data-id="heading-8">2.3 Commandsï¼ˆæ–œæ å‘½ä»¤ï¼‰</h4>
<p>å¿«é€Ÿæ‰§è¡Œçš„å‘½ä»¤ï¼Œæé«˜å¼€å‘æ•ˆç‡ï¼š</p>
<p><strong>é€šç”¨å‘½ä»¤</strong>ï¼š</p>

























































<table><thead><tr><th>å‘½ä»¤</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>/tdd</code></td><td>æµ‹è¯•é©±åŠ¨å¼€å‘</td></tr><tr><td><code>/plan</code></td><td>å®ç°è§„åˆ’</td></tr><tr><td><code>/e2e</code></td><td>E2E æµ‹è¯•ç”Ÿæˆ</td></tr><tr><td><code>/code-review</code></td><td>ä»£ç è´¨é‡å®¡æŸ¥</td></tr><tr><td><code>/build-fix</code></td><td>ä¿®å¤æ„å»ºé”™è¯¯</td></tr><tr><td><code>/refactor-clean</code></td><td>æ­»ä»£ç ç§»é™¤</td></tr><tr><td><code>/learn</code></td><td>æå–ä¼šè¯ä¸­çš„æ¨¡å¼</td></tr><tr><td><code>/checkpoint</code></td><td>ä¿å­˜éªŒè¯çŠ¶æ€</td></tr><tr><td><code>/verify</code></td><td>è¿è¡ŒéªŒè¯å¾ªç¯</td></tr><tr><td><code>/skill-create</code></td><td>ä» git å†å²ç”ŸæˆæŠ€èƒ½</td></tr><tr><td><code>/instinct-status</code></td><td>æŸ¥çœ‹å­¦ä¹ åˆ°çš„ç›´è§‰</td></tr><tr><td><code>/evolve</code></td><td>å°†ç›´è§‰èšç±»ä¸ºæŠ€èƒ½</td></tr></tbody></table>
<blockquote>
<p>é¡¹ç›®è¿˜æä¾›äº†é’ˆå¯¹ç‰¹å®šè¯­è¨€çš„å‘½ä»¤ï¼ˆå¦‚ <code>/go-review</code>ã€<code>/go-test</code> ç­‰ï¼‰ï¼Œæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ã€‚</p>
</blockquote>
<h4 data-id="heading-9">2.4 Rulesï¼ˆè§„åˆ™ï¼‰</h4>
<p>å§‹ç»ˆéµå¾ªçš„å¼€å‘å‡†åˆ™ï¼Œä¿æŒä»£ç ä¸€è‡´æ€§ï¼š</p>

































<table><thead><tr><th>è§„åˆ™æ–‡ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>security.md</code></td><td>å¼ºåˆ¶å®‰å…¨æ£€æŸ¥ï¼ˆç¦æ­¢ç¡¬ç¼–ç å¯†é’¥ï¼‰</td></tr><tr><td><code>coding-style.md</code></td><td>ä¸å¯å˜æ€§ã€æ–‡ä»¶ç»„ç»‡</td></tr><tr><td><code>testing.md</code></td><td>TDDã€80%è¦†ç›–ç‡è¦æ±‚</td></tr><tr><td><code>git-workflow.md</code></td><td>æäº¤æ ¼å¼ã€PR æµç¨‹</td></tr><tr><td><code>agents.md</code></td><td>ä½•æ—¶å§”æ´¾ç»™å­ä»£ç†</td></tr><tr><td><code>performance.md</code></td><td>æ¨¡å‹é€‰æ‹©ã€ä¸Šä¸‹æ–‡ç®¡ç†</td></tr></tbody></table>
<h4 data-id="heading-10">2.5 Hooksï¼ˆé’©å­ï¼‰</h4>
<p>åŸºäºäº‹ä»¶è§¦å‘çš„è‡ªåŠ¨åŒ–ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"matcher"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tool == \"Edit\" &amp;&amp; tool_input.file_path matches \"\\\\.(ts|tsx|js|jsx)$\""</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"hooks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"command"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#!/bin/bash\ngrep -n 'console\\.log' \"$file_path\" &amp;&amp; echo '[Hook] Remove console.log' &gt;&amp;2"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>é’©å­ç±»å‹åŒ…æ‹¬ï¼š</p>
<ul>
<li><code>PreToolUse</code>ï¼šå·¥å…·ä½¿ç”¨å‰</li>
<li><code>PostToolUse</code>ï¼šå·¥å…·ä½¿ç”¨å</li>
<li><code>Stop</code>ï¼šä¼šè¯ç»“æŸæ—¶</li>
<li>ä¼šè¯ç”Ÿå‘½å‘¨æœŸé’©å­</li>
</ul>
<h4 data-id="heading-11">2.6 ç”Ÿæ€ç³»ç»Ÿå·¥å…·</h4>
<h5 data-id="heading-12">Skill Creatorï¼ˆæŠ€èƒ½åˆ›å»ºå™¨ï¼‰</h5>
<p>ä¸¤ç§æ–¹å¼ä»ä»“åº“ç”ŸæˆæŠ€èƒ½ï¼š</p>
<p><strong>æ–¹å¼ Aï¼šæœ¬åœ°åˆ†æï¼ˆå†…ç½®ï¼‰</strong></p>
<pre><code class="hljs language-bash" lang="bash">/skill-create              <span class="hljs-comment"># åˆ†æå½“å‰ä»“åº“</span>
/skill-create --instincts  <span class="hljs-comment"># åŒæ—¶ç”Ÿæˆç›´è§‰</span>
</code></pre>
<p><strong>æ–¹å¼ Bï¼šGitHub Appï¼ˆé«˜çº§ï¼‰</strong></p>
<p>é€‚ç”¨äº 10k+ æäº¤ã€è‡ªåŠ¨ PRã€å›¢é˜Ÿå…±äº«ç­‰é«˜çº§åŠŸèƒ½ã€‚</p>
<h5 data-id="heading-13">Continuous Learning v2ï¼ˆæŒç»­å­¦ä¹  v2ï¼‰</h5>
<p>åŸºäºç›´è§‰çš„å­¦ä¹ ç³»ç»Ÿï¼Œè‡ªåŠ¨å­¦ä¹ ä½ çš„ç¼–ç¨‹æ¨¡å¼ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">/instinct-status           <span class="hljs-comment"># æ˜¾ç¤ºå­¦ä¹ åˆ°çš„ç›´è§‰åŠç½®ä¿¡åº¦</span>
/instinct-import &lt;file&gt;    <span class="hljs-comment"># ä»ä»–äººå¯¼å…¥ç›´è§‰</span>
/instinct-export           <span class="hljs-comment"># å¯¼å‡ºç›´è§‰ç”¨äºåˆ†äº«</span>
/evolve                    <span class="hljs-comment"># å°†ç›¸å…³ç›´è§‰èšç±»ä¸ºæŠ€èƒ½</span>
</code></pre>
<hr/>
<h3 data-id="heading-14">ä¸‰ã€å®‰è£…æŒ‡å—</h3>
<h4 data-id="heading-15">3.1 æ–¹å¼ä¸€ï¼šä½œä¸ºæ’ä»¶å®‰è£…ï¼ˆæ¨èï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æ·»åŠ å¸‚åœºæº</span>
/plugin marketplace add affaan-m/everything-claude-code

<span class="hljs-comment"># 2. å®‰è£…æ’ä»¶</span>
/plugin install everything-claude-code@everything-claude-code
</code></pre>
<p>æˆ–è€…ç›´æ¥ç¼–è¾‘é…ç½®æ–‡ä»¶ <code>~/.claude/settings.json</code>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"extraKnownMarketplaces"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"everything-claude-code"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"source"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"source"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"github"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"repo"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"affaan-m/everything-claude-code"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"enabledPlugins"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"everything-claude-code@everything-claude-code"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>æ³¨æ„</strong>ï¼šClaude Code æ’ä»¶ç³»ç»Ÿä¸æ”¯æŒé€šè¿‡æ’ä»¶åˆ†å‘ rulesï¼Œéœ€è¦æ‰‹åŠ¨å®‰è£…ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å…‹éš†ä»“åº“</span>
git <span class="hljs-built_in">clone</span> https://github.com/affaan-m/everything-claude-code.git

<span class="hljs-comment"># æ–¹å¼ Aï¼šç”¨æˆ·çº§è§„åˆ™ï¼ˆåº”ç”¨äºæ‰€æœ‰é¡¹ç›®ï¼‰</span>
<span class="hljs-built_in">cp</span> -r everything-claude-code/rules/* ~/.claude/rules/

<span class="hljs-comment"># æ–¹å¼ Bï¼šé¡¹ç›®çº§è§„åˆ™ï¼ˆä»…åº”ç”¨äºå½“å‰é¡¹ç›®ï¼‰</span>
<span class="hljs-built_in">mkdir</span> -p .claude/rules
<span class="hljs-built_in">cp</span> -r everything-claude-code/rules/* .claude/rules/
</code></pre>
<h4 data-id="heading-16">3.2 æ–¹å¼äºŒï¼šæ‰‹åŠ¨å®‰è£…</h4>
<p>å¦‚æœä½ æƒ³è¦æ›´ç²¾ç»†çš„æ§åˆ¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å…‹éš†ä»“åº“</span>
git <span class="hljs-built_in">clone</span> https://github.com/affaan-m/everything-claude-code.git

<span class="hljs-comment"># å¤åˆ¶ agents</span>
<span class="hljs-built_in">cp</span> everything-claude-code/agents/*.md ~/.claude/agents/

<span class="hljs-comment"># å¤åˆ¶ rules</span>
<span class="hljs-built_in">cp</span> everything-claude-code/rules/*.md ~/.claude/rules/

<span class="hljs-comment"># å¤åˆ¶ commands</span>
<span class="hljs-built_in">cp</span> everything-claude-code/commands/*.md ~/.claude/commands/

<span class="hljs-comment"># å¤åˆ¶ skills</span>
<span class="hljs-built_in">cp</span> -r everything-claude-code/skills/* ~/.claude/skills/
</code></pre>
<h5 data-id="heading-17">é…ç½® Hooks</h5>
<p>å°† <code>hooks/hooks.json</code> ä¸­çš„é’©å­é…ç½®å¤åˆ¶åˆ° <code>~/.claude/settings.json</code>ã€‚</p>
<h5 data-id="heading-18">é…ç½® MCPs</h5>
<p>å°† <code>mcp-configs/mcp-servers.json</code> ä¸­éœ€è¦çš„ MCP æœåŠ¡å™¨é…ç½®å¤åˆ¶åˆ° <code>~/.claude.json</code>ã€‚</p>
<p><strong>é‡è¦</strong>ï¼šå°† <code>YOUR_*_HERE</code> å ä½ç¬¦æ›¿æ¢ä¸ºä½ çš„å®é™… API å¯†é’¥ã€‚</p>
<hr/>
<h3 data-id="heading-19">å››ã€æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-20">4.1 ä¸Šä¸‹æ–‡çª—å£ç®¡ç†</h4>
<blockquote>
<p><strong>å…³é”®æé†’</strong>ï¼šä¸è¦åŒæ—¶å¯ç”¨æ‰€æœ‰ MCPï¼</p>
</blockquote>
<p>ä½ çš„ 200k ä¸Šä¸‹æ–‡çª—å£å¯èƒ½å› ä¸ºå¯ç”¨å¤ªå¤šå·¥å…·è€Œç¼©å‡åˆ° 70kã€‚</p>
<p><strong>ç»éªŒæ³•åˆ™</strong>ï¼š</p>
<ul>
<li>é…ç½® 20-30 ä¸ª MCP</li>
<li>æ¯ä¸ªé¡¹ç›®ä¿æŒå°‘äº 10 ä¸ªå¯ç”¨</li>
<li>ä¿æŒå°‘äº 80 ä¸ªæ´»è·ƒå·¥å…·</li>
</ul>
<p>ä½¿ç”¨é¡¹ç›®é…ç½®ä¸­çš„ <code>disabledMcpServers</code> ç¦ç”¨æœªä½¿ç”¨çš„æœåŠ¡å™¨ã€‚</p>
<h4 data-id="heading-21">4.2 å®šåˆ¶åŒ–å»ºè®®</h4>
<p>è¿™äº›é…ç½®é€‚ç”¨äºä½œè€…çš„å·¥ä½œæµï¼Œä½ åº”è¯¥ï¼š</p>
<ol>
<li><strong>ä»å…±é¸£çš„éƒ¨åˆ†å¼€å§‹</strong> - é€‰æ‹©å¯¹ä½ æœ‰ç”¨çš„ç»„ä»¶</li>
<li><strong>æ ¹æ®æŠ€æœ¯æ ˆä¿®æ”¹</strong> - é€‚é…ä½ çš„é¡¹ç›®éœ€æ±‚</li>
<li><strong>ç§»é™¤ä¸ç”¨çš„éƒ¨åˆ†</strong> - ä¿æŒé…ç½®ç²¾ç®€</li>
<li><strong>æ·»åŠ è‡ªå·±çš„æ¨¡å¼</strong> - æŒç»­è¿­ä»£ä¼˜åŒ–</li>
</ol>
<h4 data-id="heading-22">4.3 è·¨å¹³å°æ”¯æŒ</h4>
<p>è¯¥æ’ä»¶å®Œå…¨æ”¯æŒ <strong>Windowsã€macOS å’Œ Linux</strong>ã€‚æ‰€æœ‰é’©å­å’Œè„šæœ¬éƒ½å·²ç”¨ Node.js é‡å†™ï¼Œä»¥è·å¾—æœ€å¤§å…¼å®¹æ€§ã€‚</p>
<hr/>
<h3 data-id="heading-23">äº”ã€é¡¹ç›®ç»“æ„æ¦‚è§ˆ</h3>
<pre><code class="hljs language-bash" lang="bash">everything-claude-code/
â”œâ”€â”€ .claude-plugin/           <span class="hljs-comment"># æ’ä»¶å’Œå¸‚åœºæ¸…å•</span>
â”‚   â”œâ”€â”€ plugin.json          <span class="hljs-comment"># æ’ä»¶å…ƒæ•°æ®å’Œç»„ä»¶è·¯å¾„</span>
â”‚   â””â”€â”€ marketplace.json     <span class="hljs-comment"># å¸‚åœºç›®å½•</span>
â”œâ”€â”€ agents/                   <span class="hljs-comment"># ä¸“ä¸šåŒ–å­ä»£ç†</span>
â”œâ”€â”€ skills/                   <span class="hljs-comment"># å·¥ä½œæµå®šä¹‰å’Œé¢†åŸŸçŸ¥è¯†</span>
â”œâ”€â”€ commands/                 <span class="hljs-comment"># æ–œæ å‘½ä»¤</span>
â”œâ”€â”€ rules/                    <span class="hljs-comment"># å§‹ç»ˆéµå¾ªçš„å‡†åˆ™</span>
â”œâ”€â”€ hooks/                    <span class="hljs-comment"># åŸºäºè§¦å‘å™¨çš„è‡ªåŠ¨åŒ–</span>
â”‚   â””â”€â”€ hooks.json
â”œâ”€â”€ scripts/                  <span class="hljs-comment"># è·¨å¹³å° Node.js è„šæœ¬</span>
â”‚   â”œâ”€â”€ lib/                 <span class="hljs-comment"># å…±äº«å·¥å…·</span>
â”‚   â”œâ”€â”€ hooks/               <span class="hljs-comment"># é’©å­å®ç°</span>
â”‚   â””â”€â”€ tests/               <span class="hljs-comment"># æµ‹è¯•å¥—ä»¶</span>
â”œâ”€â”€ contexts/                 <span class="hljs-comment"># åŠ¨æ€ç³»ç»Ÿæç¤ºæ³¨å…¥ä¸Šä¸‹æ–‡</span>
â”œâ”€â”€ examples/                 <span class="hljs-comment"># ç¤ºä¾‹é…ç½®å’Œä¼šè¯</span>
â””â”€â”€ mcp-configs/             <span class="hljs-comment"># MCP æœåŠ¡å™¨é…ç½®</span>
</code></pre>
<hr/>
<h3 data-id="heading-24">å…­ã€å¸¸ç”¨å·¥ä½œæµç¤ºä¾‹</h3>
<h4 data-id="heading-25">6.1 TDD å¼€å‘æµç¨‹</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯åŠ¨ TDD å·¥ä½œæµ</span>
/tdd

<span class="hljs-comment"># Claude å°†å¼•å¯¼ä½ ï¼š</span>
<span class="hljs-comment"># 1. å®šä¹‰æ¥å£</span>
<span class="hljs-comment"># 2. ç¼–å†™å¤±è´¥çš„æµ‹è¯•ï¼ˆçº¢ç¯ï¼‰</span>
<span class="hljs-comment"># 3. å®ç°æœ€å°ä»£ç ï¼ˆç»¿ç¯ï¼‰</span>
<span class="hljs-comment"># 4. é‡æ„ï¼ˆæ”¹è¿›ï¼‰</span>
<span class="hljs-comment"># 5. éªŒè¯ 80%+ è¦†ç›–ç‡</span>
</code></pre>
<h4 data-id="heading-26">6.2 ä»£ç å®¡æŸ¥</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯åŠ¨ä»£ç å®¡æŸ¥</span>
/code-review

<span class="hljs-comment"># Claude å°†æ£€æŸ¥ï¼š</span>
<span class="hljs-comment"># - ä»£ç è´¨é‡</span>
<span class="hljs-comment"># - å®‰å…¨æ€§é—®é¢˜</span>
<span class="hljs-comment"># - å¯ç»´æŠ¤æ€§</span>
</code></pre>
<h4 data-id="heading-27">6.3 åŠŸèƒ½è§„åˆ’</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è§„åˆ’æ–°åŠŸèƒ½</span>
/plan

<span class="hljs-comment"># Claude å°†ååŠ©ï¼š</span>
<span class="hljs-comment"># - éœ€æ±‚åˆ†æ</span>
<span class="hljs-comment"># - æ¶æ„è®¾è®¡</span>
<span class="hljs-comment"># - å®ç°æ­¥éª¤æ‹†åˆ†</span>
</code></pre>
<h4 data-id="heading-28">6.4 æ„å»ºé”™è¯¯ä¿®å¤</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¿®å¤æ„å»ºé”™è¯¯</span>
/build-fix

<span class="hljs-comment"># Claude å°†è‡ªåŠ¨ï¼š</span>
<span class="hljs-comment"># - åˆ†æé”™è¯¯æ—¥å¿—</span>
<span class="hljs-comment"># - å®šä½é—®é¢˜æ ¹æº</span>
<span class="hljs-comment"># - æä¾›ä¿®å¤æ–¹æ¡ˆ</span>
</code></pre>
<h4 data-id="heading-29">6.5 æŒç»­å­¦ä¹ ä¸æŠ€èƒ½æ¼”è¿›</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä»å½“å‰ä»“åº“ç”ŸæˆæŠ€èƒ½</span>
/skill-create

<span class="hljs-comment"># æŸ¥çœ‹å­¦ä¹ åˆ°çš„ç›´è§‰</span>
/instinct-status

<span class="hljs-comment"># å°†ç›´è§‰èšç±»ä¸ºæŠ€èƒ½</span>
/evolve
</code></pre>
<hr/>
<h3 data-id="heading-30">ä¸ƒã€æ€»ç»“</h3>
<p><strong>Everything Claude Code</strong> æ˜¯ä¸€ä¸ªå¼ºå¤§çš„é…ç½®å·¥å…·åŒ…ï¼Œèƒ½å¤Ÿå°†åŸç”Ÿçš„ Claude Code è½¬å˜ä¸ºä¸€ä¸ªåŠŸèƒ½å®Œå–„çš„å¼€å‘ç¯å¢ƒã€‚å®ƒçš„æ ¸å¿ƒä»·å€¼åœ¨äºï¼š</p>
<ol>
<li><strong>å®æˆ˜éªŒè¯</strong> - æ¥è‡ªé»‘å®¢æ¾å† å†›çš„ 10 ä¸ªæœˆæ—¥å¸¸ä½¿ç”¨ç»éªŒ</li>
<li><strong>æ¨¡å—åŒ–è®¾è®¡</strong> - å¯ä»¥æŒ‰éœ€é€‰æ‹©å’Œå®šåˆ¶ç»„ä»¶</li>
<li><strong>ä¸“ä¸šåŒ–åˆ†å·¥</strong> - é€šè¿‡å­ä»£ç†å®ç°ä»»åŠ¡å§”æ´¾</li>
<li><strong>è‡ªåŠ¨åŒ–å¢å¼º</strong> - é€šè¿‡é’©å­å®ç°å·¥ä½œæµè‡ªåŠ¨åŒ–</li>
<li><strong>æŒç»­å­¦ä¹ </strong> - èƒ½å¤Ÿä»ä½ çš„ç¼–ç¨‹æ¨¡å¼ä¸­å­¦ä¹ </li>
</ol>
<p>æ— è®ºä½ æ˜¯ Claude Code æ–°æ‰‹è¿˜æ˜¯èµ„æ·±ç”¨æˆ·ï¼Œè¿™ä¸ªé¡¹ç›®éƒ½èƒ½å¸®åŠ©ä½ æå‡å¼€å‘æ•ˆç‡ï¼Œå»ºç«‹æ›´ä¸€è‡´çš„ä»£ç è´¨é‡æ ‡å‡†ã€‚</p>
<hr/>
<h3 data-id="heading-31">ç›¸å…³é“¾æ¥</h3>
<ul>
<li><strong>GitHub ä»“åº“</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Faffaan-m%2Feverything-claude-code" target="_blank" title="https://github.com/affaan-m/everything-claude-code" ref="nofollow noopener noreferrer">affaan-m/everything-claude-code</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Windows æ§åˆ¶å°ç‚¹å‡»å¯¼è‡´ Python è„šæœ¬å‡æ­»/æŒ‚èµ·]]></title>    <link>https://juejin.cn/post/7599917711794061322</link>    <guid>https://juejin.cn/post/7599917711794061322</guid>    <pubDate>2026-01-28T02:53:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599917711794061322" data-draft-id="7599965904617078830" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Windows æ§åˆ¶å°ç‚¹å‡»å¯¼è‡´ Python è„šæœ¬å‡æ­»/æŒ‚èµ·"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2026-01-28T02:53:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å…ƒYäº¨H"/> <meta itemprop="url" content="https://juejin.cn/user/2839351584888617"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Windows æ§åˆ¶å°ç‚¹å‡»å¯¼è‡´ Python è„šæœ¬å‡æ­»/æŒ‚èµ·
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2839351584888617/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å…ƒYäº¨H
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:53:44.000Z" title="Wed Jan 28 2026 02:53:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><hr/>
<h3 data-id="heading-0">ã€æŠ€æœ¯æ’æŸ¥ã€‘Windows æ§åˆ¶å°ç‚¹å‡»å¯¼è‡´ Python è„šæœ¬å‡æ­»/æŒ‚èµ·</h3>
<h4 data-id="heading-1">1. æ•…éšœç°è±¡</h4>
<p>åœ¨ Windows ç³»ç»Ÿä¸­è¿è¡Œ Python è‡ªåŠ¨åŒ–è„šæœ¬ï¼ˆå¦‚ Playwrightã€PyAutoGUIï¼‰æ—¶ï¼Œå‡ºç°ä»¥ä¸‹å¼‚å¸¸æƒ…å†µï¼š
*   <strong>è§¦å‘åŠ¨ä½œ</strong>ï¼šé¼ æ ‡åœ¨å‘½ä»¤è¡Œçª—å£ï¼ˆCMD/PowerShellï¼‰å†…éƒ¨ç‚¹å‡»äº†å·¦é”®æˆ–å³é”®ã€‚
*   <strong>è¡¨ç°çŠ¶æ€</strong>ï¼šç¨‹åºç«‹å³åœæ­¢è¿è¡Œï¼Œæ—¥å¿—ä¸å†åˆ·æ–°ï¼Œä»¿ä½›â€œå¡æ­»â€ã€‚
*   <strong>è§†è§‰ç‰¹å¾</strong>ï¼šçª—å£æ ‡é¢˜æ çš„å‰ç¼€å˜æˆäº† <strong>â€œé€‰æ‹©â€</strong> æˆ– <strong>â€œSelectâ€</strong>ã€‚</p>
<h4 data-id="heading-2">2. åŸç†æ­ç§˜</h4>
<p>è¿™å¹¶é Python ä»£ç æˆ–ç¬¬ä¸‰æ–¹åº“çš„ Bugï¼Œè€Œæ˜¯ Windows æ§åˆ¶å°çš„ä¸€é¡¹ç³»ç»Ÿç‰¹æ€§â€”â€”<strong>â€œå¿«é€Ÿç¼–è¾‘æ¨¡å¼â€ï¼ˆQuickEdit Modeï¼‰</strong>ã€‚
*   <strong>æœºåˆ¶</strong>ï¼šå½“ç”¨æˆ·åœ¨çª—å£å†…ç‚¹å‡»é¼ æ ‡æ—¶ï¼Œç³»ç»Ÿè®¤ä¸ºç”¨æˆ·å‡†å¤‡å¤åˆ¶å±å¹•ä¸Šçš„æ–‡å­—ã€‚
*   <strong>åæœ</strong>ï¼šä¸ºäº†ä¿æŠ¤é€‰ä¸­çš„æ–‡æœ¬ä¸è¢«æ–°è¾“å‡ºçš„æ—¥å¿—æ‰“æ–­ï¼ŒWindows ä¼š<strong>æŒ‚èµ·ï¼ˆSuspendï¼‰</strong> å½“å‰è¿›ç¨‹çš„ I/O è¾“å‡ºï¼Œå¯¼è‡´ç¨‹åºæš‚åœæ‰§è¡Œï¼Œç›´åˆ°ç”¨æˆ·å®Œæˆæ“ä½œã€‚</p>
<h4 data-id="heading-3">3. ä¿®å¤æŒ‡å—</h4>
<p><strong>A. ç°åœºæ€¥æ•‘ï¼ˆä¸´æ—¶æ¢å¤ï¼‰</strong>
å¦‚æœç¨‹åºå·²ç»å¡ä½ï¼Œæ— éœ€é‡å¯ï¼š
*   <strong>æ“ä½œ</strong>ï¼šåœ¨æ§åˆ¶å°çª—å£å†…æŒ‰ä¸€ä¸‹ <strong><code>Enter</code>ï¼ˆå›è½¦é”®ï¼‰</strong> æˆ– <strong><code>Esc</code></strong>ã€‚
*   <strong>æ•ˆæœ</strong>ï¼šç³»ç»Ÿåˆ¤å®šå¤åˆ¶å®Œæˆæˆ–å–æ¶ˆï¼Œè¿›ç¨‹ä¼šç«‹å³â€œè§£å†»â€ï¼Œç»§ç»­æ‰§è¡Œåç»­ä»£ç ã€‚</p>
<p><strong>B. æ°¸ä¹…å…³é—­ï¼ˆæ¨èè®¾ç½®ï¼‰</strong>
ä¸ºäº†é˜²æ­¢æ— äººå€¼å®ˆè¿è¡Œæ—¶å› è¯¯è§¦å¯¼è‡´è„šæœ¬ä¸­æ–­ï¼Œå»ºè®®å…³é—­æ­¤åŠŸèƒ½ï¼š
1.  å³é”®ç‚¹å‡»æ§åˆ¶å°çª—å£é¡¶éƒ¨çš„<strong>æ ‡é¢˜æ </strong>ã€‚
2.  é€‰æ‹© <strong>ã€å±æ€§ã€‘ (Properties)</strong>ã€‚
3.  åˆ‡æ¢åˆ° <strong>ã€é€‰é¡¹ã€‘ (Options)</strong> æ ‡ç­¾é¡µã€‚
4.  åœ¨â€œç¼–è¾‘é€‰é¡¹â€æ ç›®ä¸­ï¼Œ<strong>å–æ¶ˆå‹¾é€‰ã€å¿«é€Ÿç¼–è¾‘æ¨¡å¼ã€‘ (QuickEdit Mode)</strong>ã€‚
5.  ç‚¹å‡»ç¡®å®šä¿å­˜ã€‚</p>
<h4 data-id="heading-4">4. è¡¥å……æ’æŸ¥ï¼ˆPyAutoGUI ç‰¹æœ‰ï¼‰</h4>
<p>å¦‚æœä¸Šè¿°æ–¹æ³•æ— æ•ˆï¼Œä¸”ç¨‹åºç›´æ¥<strong>æŠ¥é”™é€€å‡º</strong>ï¼ˆè€Œéé™æ­¢å¡ä½ï¼‰ï¼Œè¯·æ£€æŸ¥ PyAutoGUI çš„å®‰å…¨æœºåˆ¶ï¼š
*   <strong>Fail-Safe è§¦å‘</strong>ï¼šå½“é¼ æ ‡è¿…é€Ÿç§»åŠ¨åˆ°å±å¹•è§’è½ï¼ˆé€šå¸¸æ˜¯å·¦ä¸Šè§’ï¼‰æ—¶ï¼ŒPyAutoGUI ä¼šå¼ºåˆ¶æŠ›å‡º <code>pyautogui.FailSafeException</code> ä»¥é˜²æ­¢å¤±æ§ã€‚
*   <strong>åŒºåˆ†æ–¹æ³•</strong>ï¼š
*   <strong>å¡ä½ä¸åŠ¨</strong> = Windows å¿«é€Ÿç¼–è¾‘æ¨¡å¼ï¼ˆæœ¬æ–‡é—®é¢˜ï¼‰ã€‚
*   <strong>æŠ¥é”™ Traceback</strong> = PyAutoGUI å®‰å…¨æœºåˆ¶è§¦å‘ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ™ºèƒ½ä½“åº”ç”¨1: ç‚¹å¤–å–]]></title>    <link>https://juejin.cn/post/7599963665039409202</link>    <guid>https://juejin.cn/post/7599963665039409202</guid>    <pubDate>2026-01-28T02:48:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599963665039409202" data-draft-id="7599951933593813002" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ™ºèƒ½ä½“åº”ç”¨1: ç‚¹å¤–å–"/> <meta itemprop="keywords" content="Agent,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-28T02:48:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="guo54junxiao"/> <meta itemprop="url" content="https://juejin.cn/user/4353721777787773"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ™ºèƒ½ä½“åº”ç”¨1: ç‚¹å¤–å–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4353721777787773/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    guo54junxiao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:48:38.000Z" title="Wed Jan 28 2026 02:48:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ç³»ç»Ÿæ¶æ„æ€»è§ˆ</h2>
<pre><code class="hljs language-js" lang="js">ç”¨æˆ· (å‰ç«¯/<span class="hljs-title class_">App</span>) 
    â†“ (è‡ªç„¶è¯­è¨€æŒ‡ä»¤)
[å‰ç«¯ï¼šæ™ºèƒ½ä½“äº¤äº’å±‚]
    â†“ (åŒ…å«ä¼šè¯<span class="hljs-variable constant_">ID</span>çš„è¯·æ±‚)
[ä¸­å°ï¼šæ™ºèƒ½ä½“ç¼–æ’ä¸æ‰§è¡Œå¼•æ“] 
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â†“           â†“           â†“           â†“
[å·¥å…·<span class="hljs-number">1</span>ï¼š        [å·¥å…·<span class="hljs-number">2</span>ï¼š        [å·¥å…·<span class="hljs-number">3</span>ï¼š        [è®°å¿†æœåŠ¡ï¼š
 é¤é¦†/èœå•æŸ¥è¯¢]  è´­ç‰©è½¦æ“ä½œ]    åœ°å€ç®¡ç†]     ä¼šè¯çŠ¶æ€å­˜å‚¨]
    â†“           â†“           â†“           â†“
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
[ä¸­å°ï¼šæ™ºèƒ½ä½“å†³ç­–ä¸è§„åˆ’]
    â†“ (ç»“æ„åŒ–ä¸‹ä¸€æ­¥æŒ‡ä»¤æˆ–æœ€ç»ˆç»“æœ)
[å¤–éƒ¨æœåŠ¡<span class="hljs-variable constant_">API</span>ç½‘å…³] â†’ ç¾å›¢/é¥¿äº†ä¹ˆç­‰å¤–å–å¹³å°å¼€æ”¾<span class="hljs-variable constant_">API</span>
    â†“
[å‰ç«¯ï¼šæ¸²æŸ“ä¸ç”¨æˆ·ç¡®è®¤ç•Œé¢]
</code></pre>
<h2 data-id="heading-1">äºŒã€å·¥ä½œæµç¨‹ï¼š</h2>
<h4 data-id="heading-2">å®Œæ•´å·¥ä½œæµç¨‹ç¤ºä¾‹</h4>
<ol>
<li>
<p><strong>ç”¨æˆ·è¾“å…¥</strong>ï¼šâ€œå¸®æˆ‘ç‚¹ä¸€ä»½éº¦å½“åŠ³å·¨æ— éœ¸å¥—é¤ï¼Œé€åˆ°XXå¤§å¦ï¼Œå¸®æˆ‘åˆ°ä»˜æ¬¾ç•Œé¢â€</p>
</li>
<li>
<p><strong>å‰ç«¯</strong>ï¼šå‘é€è¯·æ±‚åˆ°ä¸­å°<code>/api/agent/order-food</code>ï¼Œé™„å¸¦ä¼šè¯IDã€‚</p>
</li>
<li>
<p><strong>ä¸­å° - ç¬¬ä¸€è½®</strong>ï¼š</p>
<ul>
<li>LLMåˆ†ææ„å›¾ï¼šéœ€è¦<code>query_restaurant_menu</code>å·¥å…·ã€‚</li>
<li><strong>å‘é€äº‹ä»¶</strong>ï¼š<code>status: querying_menu</code>Â åˆ°å‰ç«¯ã€‚</li>
<li><strong>æ‰§è¡Œå·¥å…·</strong>ï¼šè°ƒç”¨èœå•æŸ¥è¯¢å·¥å…·ï¼Œæ‰¾åˆ°é™„è¿‘çš„éº¦å½“åŠ³å’Œå·¨æ— éœ¸å¥—é¤ã€‚</li>
<li><strong>å‘é€äº‹ä»¶</strong>ï¼š<code>message: â€œæ‰¾åˆ°â€˜éº¦å½“åŠ³ï¼ˆXXåº—ï¼‰â€™ï¼Œæœ‰å·¨æ— éœ¸å¥—é¤ï¼Œä»·æ ¼38å…ƒã€‚ç¡®è®¤åŠ å…¥è´­ç‰©è½¦å—ï¼Ÿâ€</code>Â åŒæ—¶å‘é€<code>action_preview: {action: â€œadd_to_cartâ€, items: [...]}</code>ã€‚</li>
</ul>
</li>
<li>
<p><strong>å‰ç«¯</strong>ï¼šæ˜¾ç¤ºæ¶ˆæ¯å’Œç¡®è®¤å¡ç‰‡ã€‚ç”¨æˆ·ç‚¹å‡»â€œç¡®è®¤â€ã€‚</p>
</li>
<li>
<p><strong>ä¸­å° - ç¬¬äºŒè½®</strong>ï¼š</p>
<ul>
<li>å‰ç«¯å‘é€ç¡®è®¤æŒ‡ä»¤ã€‚</li>
<li>LLMåˆ†æï¼šç”¨æˆ·å·²ç¡®è®¤ï¼Œéœ€è¦<code>manage_cart</code>å·¥å…·ã€‚</li>
<li><strong>æ‰§è¡Œå·¥å…·</strong>ï¼šå°†å•†å“åŠ å…¥è´­ç‰©è½¦ï¼Œè¿”å›æˆåŠŸã€‚</li>
<li>LLMå‘ç°åœ°å€ä¿¡æ¯â€œXXå¤§å¦â€ä¸æ˜ç¡®ï¼Œéœ€è¦<code>address</code>å·¥å…·è§£ææˆ–ç”¨æˆ·ç¡®è®¤ã€‚</li>
<li><strong>å‘é€äº‹ä»¶</strong>ï¼š<code>message: â€œéœ€è¦ç¡®è®¤å…·ä½“åœ°å€ã€‚XXå¤§å¦æœ‰ä»¥ä¸‹åœ°å€é€‰é¡¹...â€</code>ã€‚</li>
</ul>
</li>
<li>
<p><strong>ç”¨æˆ·</strong>ï¼šåœ¨å‰ç«¯é€‰æ‹©æˆ–ç¡®è®¤å…·ä½“åœ°å€ã€‚</p>
</li>
<li>
<p><strong>ä¸­å° - ç¬¬ä¸‰è½®</strong>ï¼š</p>
<ul>
<li>LLMåˆ†æï¼šæ‰€æœ‰ä¿¡æ¯ï¼ˆé¤å…ã€å•†å“ã€åœ°å€ï¼‰é½å¤‡ï¼Œç”¨æˆ·æœ€ç»ˆç›®æ ‡æ˜¯â€œåˆ°ä»˜æ¬¾ç•Œé¢â€ã€‚</li>
<li>è°ƒç”¨<code>get_payment_page</code>å·¥å…·ã€‚</li>
<li><strong>å‘é€äº‹ä»¶</strong>ï¼š<code>action_preview: {action: â€œget_payment_pageâ€, need_confirm: true}</code>ï¼ˆé«˜é£é™©æ“ä½œï¼Œå¿…é¡»ç¡®è®¤ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>å‰ç«¯</strong>ï¼šå¼¹å‡ºç¡®è®¤æ¡†â€œå³å°†è·³è½¬æ”¯ä»˜ï¼Œæ€»ä»·38å…ƒï¼Œè¯·ç¡®è®¤â€ã€‚</p>
</li>
<li>
<p><strong>ç”¨æˆ·</strong>ï¼šç‚¹å‡»â€œç¡®è®¤æ”¯ä»˜â€ã€‚</p>
</li>
<li>
<p><strong>ä¸­å° - æœ€ç»ˆè½®</strong>ï¼š</p>
<ul>
<li>è°ƒç”¨æ”¯ä»˜å·¥å…·ï¼Œä»å¤–å–å¹³å°è·å–<strong>é¢„å¡«å……å¥½å•†å“ã€åœ°å€ã€ä»·æ ¼çš„æ”¯ä»˜é¡µé¢URLï¼ˆå¸¦ä¸´æ—¶tokenï¼‰</strong> ã€‚</li>
<li><strong>å‘é€äº‹ä»¶</strong>ï¼š<code>final_result: {type: â€œpayment_pageâ€, url: â€œhttps://pay.ele.me/...â€}</code>ã€‚</li>
</ul>
</li>
<li>
<p><strong>å‰ç«¯</strong>ï¼šåœ¨åº”ç”¨å†…åµŒçš„WebViewä¸­åŠ è½½è¯¥URLï¼Œç”¨æˆ·çœ‹åˆ°çš„æ˜¯å¤–å–å¹³å°æ ‡å‡†çš„æ”¯ä»˜é¡µé¢ï¼Œåªéœ€è¾“å…¥å¯†ç æˆ–éªŒè¯æŒ‡çº¹å³å¯å®Œæˆæ”¯ä»˜ã€‚</p>
</li>
</ol>
<hr/>
<h2 data-id="heading-3">ä¸‰ã€å‰ç«¯å®ç°è¯¦è§£</h2>
<h5 data-id="heading-4"><strong>1. ç•Œé¢è®¾è®¡ï¼ˆå…³é”®ç»„ä»¶ï¼‰</strong></h5>
<ul>
<li>
<p><strong>æ™ºèƒ½ä½“å¯¹è¯é¢æ¿</strong>ï¼šæ ¸å¿ƒåŒºåŸŸï¼Œæ˜¾ç¤ºä¸AIçš„å¯¹è¯å†å²ã€‚</p>
</li>
<li>
<p><strong>æ™ºèƒ½ä½“çŠ¶æ€å¯è§†åŒ–é¢æ¿</strong>ï¼š</p>
<ul>
<li>
<p><strong>æ€è€ƒçŠ¶æ€</strong>ï¼šæ˜¾ç¤ºâ€œæ­£åœ¨åˆ†æä½ çš„éœ€æ±‚...â€ã€â€œæ­£åœ¨æŸ¥è¯¢éº¦å½“åŠ³èœå•...â€</p>
</li>
<li>
<p><strong>æ“ä½œé¢„è§ˆ</strong>ï¼šä»¥å¡ç‰‡å½¢å¼å±•ç¤ºæ™ºèƒ½ä½“å³å°†æˆ–æ­£åœ¨æ‰§è¡Œçš„æ“ä½œï¼Œä¾‹å¦‚ï¼š</p>
<p>json</p>
<pre><code class="hljs language-css" lang="css">{
  â€œactionâ€: â€œadd_to_cartâ€,
  â€œrestaurantâ€: â€œéº¦å½“åŠ³ï¼ˆXXåº—ï¼‰â€,
  â€œitemsâ€: [{â€œnameâ€: â€œå·¨æ— éœ¸å¥—é¤â€, â€œquantityâ€: <span class="hljs-number">1</span>}],
  â€œneed_confirmâ€: true // éœ€è¦ç”¨æˆ·ç¡®è®¤
}
</code></pre>
</li>
<li>
<p><strong>å·¥å…·è°ƒç”¨è®°å½•</strong>ï¼šä¸€ä¸ªå°æ—¥å¿—ï¼Œæ˜¾ç¤ºâ€œè°ƒç”¨äº†ã€èœå•æŸ¥è¯¢å·¥å…·ã€‘â€ã€â€œè°ƒç”¨äº†ã€åœ°å€æ ¡éªŒå·¥å…·ã€‘â€ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>æ··åˆè¾“å…¥åŒº</strong>ï¼šç”¨æˆ·æ—¢å¯ä»¥ç»§ç»­ç”¨è‡ªç„¶è¯­è¨€å¯¹è¯ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç‚¹å‡»æ™ºèƒ½ä½“æ¨èçš„é€‰é¡¹è¿›è¡Œç¡®è®¤æˆ–ä¿®æ”¹ï¼ˆä¾‹å¦‚ï¼Œç‚¹å‡»â€œæ›´æ¢å¥—é¤â€æˆ–â€œç¡®è®¤åŠ å…¥è´­ç‰©è½¦â€ï¼‰ã€‚</p>
</li>
<li>
<p><strong>æœ€ç»ˆç»“æœåµŒå…¥åŒº</strong>ï¼šå½“æ™ºèƒ½ä½“å®Œæˆâ€œåˆ°ä»˜æ¬¾ç•Œé¢â€çš„ä»»åŠ¡åï¼Œè¿™ä¸ªåŒºåŸŸå°†ç›´æ¥åµŒå…¥ä»å¤–å–å¹³å°è·å–çš„ã€å·²å¡«å¥½æ‰€æœ‰ä¿¡æ¯çš„<strong>æ”¯ä»˜é¡µé¢H5æˆ–WebView</strong>ã€‚</p>
</li>
</ul>
<ol start="2">
<li>
<p><strong>ä¸»è¦åŠŸèƒ½</strong>ï¼š</p>
<ul>
<li>è‡ªåŠ¨åˆ›å»ºå’Œç®¡ç†ä¼šè¯</li>
<li>å®æ—¶SSEé€šä¿¡æ˜¾ç¤ºæ™ºèƒ½ä½“çŠ¶æ€</li>
<li>æ“ä½œé¢„è§ˆå’Œç¡®è®¤æœºåˆ¶</li>
<li>æ”¯ä»˜é¡µé¢åµŒå…¥</li>
<li>å®Œæ•´çš„å“åº”å¼UI</li>
</ul>
</li>
</ol>
<h5 data-id="heading-5"><strong>2. å‰ç«¯æ ¸å¿ƒé€»è¾‘ï¼ˆä»£ç æ€è·¯ï¼‰</strong></h5>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// 1. åˆå§‹åŒ–æ™ºèƒ½ä½“ä¼šè¯</span>
<span class="hljs-keyword">const</span> agentSession = <span class="hljs-title function_">useAgentSession</span>(<span class="hljs-string">'å¤–å–åŠ©æ‰‹'</span>);
<span class="hljs-comment">// 2. å‘é€ç”¨æˆ·æ¶ˆæ¯</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleUserMessage</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">userInput</span>) =&gt; {
  <span class="hljs-comment">// 2.1 å°†ç”¨æˆ·è¾“å…¥æ·»åŠ åˆ°å¯¹è¯å†å²ï¼Œå¹¶æ˜¾ç¤ºâ€œæ€è€ƒä¸­â€çŠ¶æ€</span>
  agentSession.<span class="hljs-title function_">addMessage</span>({ <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span>, <span class="hljs-attr">content</span>: userInput });
  agentSession.<span class="hljs-title function_">setStatus</span>(<span class="hljs-string">'thinking'</span>);
  
  <span class="hljs-comment">// 2.2 è°ƒç”¨ä¸­å°æ™ºèƒ½ä½“APIï¼ˆæµå¼å“åº”ï¼‰</span>
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/agent/order-food'</span>, {
    <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
    <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
      <span class="hljs-attr">session_id</span>: agentSession.<span class="hljs-property">id</span>,
      <span class="hljs-attr">message</span>: userInput,
      <span class="hljs-comment">// å¯ä»¥é™„åŠ ä¸Šä¸‹æ–‡ï¼Œå¦‚å‰ç«¯å½“å‰çš„åœ°ç†ä½ç½®</span>
      <span class="hljs-attr">context</span>: { <span class="hljs-attr">user_location</span>: userLocation }
    }),
    <span class="hljs-attr">headers</span>: { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span> }
  });
  
  <span class="hljs-comment">// 2.3 å¤„ç†æµå¼å“åº”ï¼ˆä¸­å°è¿”å›çš„æ˜¯Server-Sent Eventsï¼‰</span>
  <span class="hljs-keyword">const</span> reader = response.<span class="hljs-property">body</span>.<span class="hljs-title function_">getReader</span>();
  <span class="hljs-keyword">const</span> decoder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextDecoder</span>();
  <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
    <span class="hljs-keyword">const</span> { done, value } = <span class="hljs-keyword">await</span> reader.<span class="hljs-title function_">read</span>();
    <span class="hljs-keyword">if</span> (done) <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">const</span> chunk = decoder.<span class="hljs-title function_">decode</span>(value);
    <span class="hljs-keyword">const</span> events = chunk.<span class="hljs-title function_">split</span>(<span class="hljs-string">'\n\n'</span>).<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> e);
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> event <span class="hljs-keyword">of</span> events) {
      <span class="hljs-keyword">const</span> [eventLine, dataLine] = event.<span class="hljs-title function_">split</span>(<span class="hljs-string">'\n'</span>);
      <span class="hljs-keyword">if</span> (eventLine === <span class="hljs-string">'event: status'</span>) {
        <span class="hljs-comment">// æ›´æ–°æ™ºèƒ½ä½“çŠ¶æ€</span>
        agentSession.<span class="hljs-title function_">setStatus</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(dataLine.<span class="hljs-title function_">replace</span>(<span class="hljs-string">'data: '</span>, <span class="hljs-string">''</span>)).<span class="hljs-property">status</span>);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (eventLine === <span class="hljs-string">'event: action_preview'</span>) {
        <span class="hljs-comment">// æ˜¾ç¤ºæ™ºèƒ½ä½“å°†è¦æ‰§è¡Œçš„æ“ä½œï¼ˆéœ€è¦ç”¨æˆ·ç¡®è®¤çš„å¡ç‰‡ï¼‰</span>
        <span class="hljs-keyword">const</span> action = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(dataLine.<span class="hljs-title function_">replace</span>(<span class="hljs-string">'data: '</span>, <span class="hljs-string">''</span>));
        <span class="hljs-title function_">renderActionPreviewCard</span>(action);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (eventLine === <span class="hljs-string">'event: message'</span>) {
        <span class="hljs-comment">// é€æ­¥æ˜¾ç¤ºæ™ºèƒ½ä½“çš„å›å¤æ–‡æœ¬</span>
        agentSession.<span class="hljs-title function_">appendAgentMessage</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(dataLine.<span class="hljs-title function_">replace</span>(<span class="hljs-string">'data: '</span>, <span class="hljs-string">''</span>)).<span class="hljs-property">content</span>);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (eventLine === <span class="hljs-string">'event: final_result'</span>) {
        <span class="hljs-comment">// æ”¶åˆ°æœ€ç»ˆç»“æœï¼Œä¾‹å¦‚æ”¯ä»˜é¡µé¢çš„URLæˆ–åµŒå…¥ä»£ç </span>
        <span class="hljs-keyword">const</span> result = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(dataLine.<span class="hljs-title function_">replace</span>(<span class="hljs-string">'data: '</span>, <span class="hljs-string">''</span>));
        <span class="hljs-keyword">if</span> (result.<span class="hljs-property">type</span> === <span class="hljs-string">'payment_page'</span>) {
          <span class="hljs-title function_">embedPaymentPage</span>(result.<span class="hljs-property">url</span>, result.<span class="hljs-property">token</span>); <span class="hljs-comment">// åµŒå…¥æ”¯ä»˜é¡µé¢</span>
        }
      }
    }
  }
  agentSession.<span class="hljs-title function_">setStatus</span>(<span class="hljs-string">'idle'</span>);
};

<span class="hljs-comment">// 3. ç”¨æˆ·ç¡®è®¤æ™ºèƒ½ä½“æ“ä½œ</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleConfirmAction</span> = (<span class="hljs-params">actionId, confirmedData</span>) =&gt; {
  <span class="hljs-comment">// å‘é€ç¡®è®¤ä¿¡æ¯å›ä¸­å°ï¼Œä¾‹å¦‚ï¼šç¡®è®¤åŠ å…¥è´­ç‰©è½¦çš„å•†å“å’Œæ•°é‡</span>
  <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/agent/confirm-action'</span>, {
    <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
    <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
      <span class="hljs-attr">session_id</span>: agentSession.<span class="hljs-property">id</span>,
      <span class="hljs-attr">action_id</span>: actionId,
      <span class="hljs-attr">user_confirmation</span>: confirmedData
    })
  });
};
</code></pre>
<h5 data-id="heading-6"><strong>3. å‰ç«¯å®Œæ•´ä»£ç --æ›´æ–°ä¸­ï¼Œå¯å‚è€ƒ</strong></h5>
<pre><code class="hljs language-js" lang="js">## æ•´å‰ç«¯å®ç°ï¼šåŸºäº<span class="hljs-variable constant_">SSE</span>å’Œ<span class="hljs-title class_">JavaScript</span>çš„<span class="hljs-variable constant_">AI</span>å¤–å–åŠ©æ‰‹
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AIFoodOrderingAssistant</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// åº”ç”¨çŠ¶æ€</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentSessionId</span> = <span class="hljs-literal">null</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span> = <span class="hljs-literal">null</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isConnected</span> = <span class="hljs-literal">false</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">false</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">pendingActionId</span> = <span class="hljs-literal">null</span>;
        
        <span class="hljs-comment">// DOMå…ƒç´ </span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span> = {
            <span class="hljs-attr">userInput</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'userInput'</span>),
            <span class="hljs-attr">sendButton</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'sendButton'</span>),
            <span class="hljs-attr">messagesContainer</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'messagesContainer'</span>),
            <span class="hljs-attr">statusContainer</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'statusContainer'</span>),
            <span class="hljs-attr">sessionId</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'sessionId'</span>),
            <span class="hljs-attr">connectionStatus</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'connectionStatus'</span>),
            <span class="hljs-attr">paymentSection</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'paymentSection'</span>),
            <span class="hljs-attr">paymentFrame</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'paymentFrame'</span>)
        };
        
        <span class="hljs-comment">// åˆå§‹åŒ–</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>();
    }
    
    <span class="hljs-comment">/**
     * åˆå§‹åŒ–åº”ç”¨
     */</span>
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">init</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// 1. åˆ›å»ºæˆ–åŠ è½½ä¼šè¯</span>
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initializeSession</span>();
        
        <span class="hljs-comment">// 2. è®¾ç½®äº‹ä»¶ç›‘å¬å™¨</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupEventListeners</span>();
        
        <span class="hljs-comment">// 3. å»ºç«‹SSEè¿æ¥</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">connectToAgent</span>();
        
        <span class="hljs-comment">// 4. æ˜¾ç¤ºæ¬¢è¿æ¶ˆæ¯</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showWelcomeMessage</span>();
    }
    
    <span class="hljs-comment">/**
     * åˆå§‹åŒ–ä¼šè¯
     */</span>
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">initializeSession</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// å°è¯•ä»localStorageè·å–ç°æœ‰ä¼šè¯ID</span>
            <span class="hljs-keyword">const</span> savedSessionId = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'agent_session_id'</span>);
            <span class="hljs-keyword">const</span> savedSessionTime = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'agent_session_time'</span>);
            
            <span class="hljs-comment">// æ£€æŸ¥ä¼šè¯æ˜¯å¦è¿‡æœŸï¼ˆè¶…è¿‡1å°æ—¶ï¼‰</span>
            <span class="hljs-keyword">const</span> sessionExpired = savedSessionTime &amp;&amp; 
                                 (<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - <span class="hljs-built_in">parseInt</span>(savedSessionTime)) &gt; <span class="hljs-number">3600000</span>;
            
            <span class="hljs-keyword">if</span> (savedSessionId &amp;&amp; !sessionExpired) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentSessionId</span> = savedSessionId;
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">sessionId</span>.<span class="hljs-property">textContent</span> = savedSessionId.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, <span class="hljs-number">8</span>) + <span class="hljs-string">'...'</span>;
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// åˆ›å»ºæ–°ä¼šè¯</span>
                <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/agent/session'</span>, {
                    <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
                    <span class="hljs-attr">headers</span>: {
                        <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
                    }
                });
                
                <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentSessionId</span> = data.<span class="hljs-property">session_id</span>;
                
                <span class="hljs-comment">// ä¿å­˜åˆ°localStorage</span>
                <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'agent_session_id'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentSessionId</span>);
                <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'agent_session_time'</span>, <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>().<span class="hljs-title function_">toString</span>());
                
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">sessionId</span>.<span class="hljs-property">textContent</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentSessionId</span>.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, <span class="hljs-number">8</span>) + <span class="hljs-string">'...'</span>;
            }
        } <span class="hljs-keyword">catch</span> (error) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åˆå§‹åŒ–ä¼šè¯å¤±è´¥:'</span>, error);
            <span class="hljs-comment">// ç”Ÿæˆä¸€ä¸ªä¸´æ—¶ä¼šè¯ID</span>
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentSessionId</span> = <span class="hljs-string">'temp_'</span> + <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() + <span class="hljs-string">'_'</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>().<span class="hljs-title function_">toString</span>(<span class="hljs-number">36</span>).<span class="hljs-title function_">substr</span>(<span class="hljs-number">2</span>, <span class="hljs-number">9</span>);
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">sessionId</span>.<span class="hljs-property">textContent</span> = <span class="hljs-string">'ä¸´æ—¶ä¼šè¯'</span>;
        }
    }
    
    <span class="hljs-comment">/**
     * è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
     */</span>
    <span class="hljs-title function_">setupEventListeners</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// å‘é€æŒ‰é’®ç‚¹å‡»äº‹ä»¶</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">sendButton</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">sendMessage</span>());
        
        <span class="hljs-comment">// è¾“å…¥æ¡†å›è½¦äº‹ä»¶</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">userInput</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'keypress'</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
            <span class="hljs-keyword">if</span> (e.<span class="hljs-property">key</span> === <span class="hljs-string">'Enter'</span> &amp;&amp; !e.<span class="hljs-property">shiftKey</span>) {
                e.<span class="hljs-title function_">preventDefault</span>();
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">sendMessage</span>();
            }
        });
        
        <span class="hljs-comment">// è¾“å…¥æ¡†è¾“å…¥äº‹ä»¶ï¼ˆå¯ç”¨/ç¦ç”¨å‘é€æŒ‰é’®ï¼‰</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">userInput</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'input'</span>, <span class="hljs-function">() =&gt;</span> {
            <span class="hljs-keyword">const</span> hasText = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">userInput</span>.<span class="hljs-property">value</span>.<span class="hljs-title function_">trim</span>().<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">sendButton</span>.<span class="hljs-property">disabled</span> = !hasText || <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span>;
        });
        
        <span class="hljs-comment">// é¡µé¢å¸è½½æ—¶å…³é—­SSEè¿æ¥</span>
        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'beforeunload'</span>, <span class="hljs-function">() =&gt;</span> {
            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span>) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span>.<span class="hljs-title function_">close</span>();
            }
        });
        
        <span class="hljs-comment">// æ–­çº¿é‡è¿</span>
        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'online'</span>, <span class="hljs-function">() =&gt;</span> {
            <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isConnected</span>) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">connectToAgent</span>();
            }
        });
    }
    
    <span class="hljs-comment">/**
     * è¿æ¥åˆ°æ™ºèƒ½ä½“SSEæµ
     */</span>
    <span class="hljs-title function_">connectToAgent</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span>.<span class="hljs-title function_">close</span>();
        }
        
        <span class="hljs-keyword">const</span> sseUrl = <span class="hljs-string">`/api/agent/stream?session_id=<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.currentSessionId}</span>`</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventSource</span>(sseUrl);
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span>.<span class="hljs-property">onopen</span> = <span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'SSEè¿æ¥å·²å»ºç«‹'</span>);
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">isConnected</span> = <span class="hljs-literal">true</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateConnectionStatus</span>(<span class="hljs-string">'ğŸŸ¢ å·²è¿æ¥'</span>);
        };
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span>.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'SSEè¿æ¥é”™è¯¯:'</span>, error);
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">isConnected</span> = <span class="hljs-literal">false</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateConnectionStatus</span>(<span class="hljs-string">'ğŸ”´ è¿æ¥æ–­å¼€'</span>);
            
            <span class="hljs-comment">// å°è¯•é‡æ–°è¿æ¥</span>
            <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
                <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isConnected</span>) {
                    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">connectToAgent</span>();
                }
            }, <span class="hljs-number">5000</span>);
        };
        
        <span class="hljs-comment">// å¤„ç†ä¸åŒçš„SSEäº‹ä»¶</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'status'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleStatusEvent</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'action_preview'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleActionPreviewEvent</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'message'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleMessageEvent</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'final_result'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleFinalResultEvent</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'error'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleErrorEvent</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
    }
    
    <span class="hljs-comment">/**
     * æ›´æ–°è¿æ¥çŠ¶æ€æ˜¾ç¤º
     */</span>
    <span class="hljs-title function_">updateConnectionStatus</span>(<span class="hljs-params">status</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">connectionStatus</span>.<span class="hljs-property">textContent</span> = status;
    }
    
    <span class="hljs-comment">/**
     * å¤„ç†çŠ¶æ€äº‹ä»¶
     */</span>
    <span class="hljs-title function_">handleStatusEvent</span>(<span class="hljs-params">event</span>) {
        <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(event.<span class="hljs-property">data</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addStatusCard</span>(data.<span class="hljs-property">status</span>, data.<span class="hljs-property">details</span>);
        
        <span class="hljs-comment">// æ›´æ–°UIçŠ¶æ€</span>
        <span class="hljs-keyword">if</span> (data.<span class="hljs-property">status</span> === <span class="hljs-string">'thinking'</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showTypingIndicator</span>();
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">true</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateUIState</span>();
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (data.<span class="hljs-property">status</span> === <span class="hljs-string">'executing_tool'</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addMessage</span>(<span class="hljs-string">'assistant'</span>, <span class="hljs-string">`æ­£åœ¨æ‰§è¡Œ: <span class="hljs-subst">${data.tool_name}</span>...`</span>, <span class="hljs-literal">false</span>);
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">true</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateUIState</span>();
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (data.<span class="hljs-property">status</span> === <span class="hljs-string">'idle'</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeTypingIndicator</span>();
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">false</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateUIState</span>();
        }
    }
    
    <span class="hljs-comment">/**
     * å¤„ç†æ“ä½œé¢„è§ˆäº‹ä»¶
     */</span>
    <span class="hljs-title function_">handleActionPreviewEvent</span>(<span class="hljs-params">event</span>) {
        <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(event.<span class="hljs-property">data</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">pendingActionId</span> = data.<span class="hljs-property">action_id</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showActionPreview</span>(data);
    }
    
    <span class="hljs-comment">/**
     * å¤„ç†æ¶ˆæ¯äº‹ä»¶
     */</span>
    <span class="hljs-title function_">handleMessageEvent</span>(<span class="hljs-params">event</span>) {
        <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(event.<span class="hljs-property">data</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeTypingIndicator</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addMessage</span>(<span class="hljs-string">'assistant'</span>, data.<span class="hljs-property">content</span>, <span class="hljs-literal">true</span>);
    }
    
    <span class="hljs-comment">/**
     * å¤„ç†æœ€ç»ˆç»“æœäº‹ä»¶
     */</span>
    <span class="hljs-title function_">handleFinalResultEvent</span>(<span class="hljs-params">event</span>) {
        <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(event.<span class="hljs-property">data</span>);
        
        <span class="hljs-keyword">if</span> (data.<span class="hljs-property">type</span> === <span class="hljs-string">'payment_page'</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showPaymentPage</span>(data.<span class="hljs-property">url</span>, data.<span class="hljs-property">token</span>);
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addMessage</span>(<span class="hljs-string">'assistant'</span>, <span class="hljs-string">'å·²ä¸ºæ‚¨è·³è½¬åˆ°æ”¯ä»˜é¡µé¢ï¼Œè¯·ç¡®è®¤è®¢å•ä¿¡æ¯å¹¶å®Œæˆæ”¯ä»˜ã€‚'</span>, <span class="hljs-literal">true</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (data.<span class="hljs-property">type</span> === <span class="hljs-string">'order_created'</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addMessage</span>(<span class="hljs-string">'assistant'</span>, <span class="hljs-string">`è®¢å•åˆ›å»ºæˆåŠŸï¼è®¢å•å·: <span class="hljs-subst">${data.order_id}</span>ï¼Œæ€»ä»·: Â¥<span class="hljs-subst">${data.total_price}</span>`</span>, <span class="hljs-literal">true</span>);
        }
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">false</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateUIState</span>();
    }
    
    <span class="hljs-comment">/**
     * å¤„ç†é”™è¯¯äº‹ä»¶
     */</span>
    <span class="hljs-title function_">handleErrorEvent</span>(<span class="hljs-params">event</span>) {
        <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(event.<span class="hljs-property">data</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addMessage</span>(<span class="hljs-string">'assistant'</span>, <span class="hljs-string">`âŒ é”™è¯¯: <span class="hljs-subst">${data.message}</span>`</span>, <span class="hljs-literal">true</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addStatusCard</span>(<span class="hljs-string">'error'</span>, data.<span class="hljs-property">message</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">false</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateUIState</span>();
    }
    
    <span class="hljs-comment">/**
     * å‘é€ç”¨æˆ·æ¶ˆæ¯
     */</span>
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">sendMessage</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> userInput = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">userInput</span>.<span class="hljs-property">value</span>.<span class="hljs-title function_">trim</span>();
        
        <span class="hljs-keyword">if</span> (!userInput || <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span>) <span class="hljs-keyword">return</span>;
        
        <span class="hljs-comment">// æ·»åŠ ç”¨æˆ·æ¶ˆæ¯åˆ°ç•Œé¢</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addMessage</span>(<span class="hljs-string">'user'</span>, userInput, <span class="hljs-literal">true</span>);
        
        <span class="hljs-comment">// æ¸…ç©ºè¾“å…¥æ¡†</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">userInput</span>.<span class="hljs-property">value</span> = <span class="hljs-string">''</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">sendButton</span>.<span class="hljs-property">disabled</span> = <span class="hljs-literal">true</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">true</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateUIState</span>();
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// å‘é€æ¶ˆæ¯åˆ°æœåŠ¡å™¨</span>
            <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/agent/process'</span>, {
                <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
                <span class="hljs-attr">headers</span>: {
                    <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
                },
                <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
                    <span class="hljs-attr">session_id</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentSessionId</span>,
                    <span class="hljs-attr">message</span>: userInput,
                    <span class="hljs-attr">context</span>: {
                        <span class="hljs-attr">user_location</span>: <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUserLocation</span>(),
                        <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>()
                    }
                })
            });
            
            <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`HTTP error! status: <span class="hljs-subst">${response.status}</span>`</span>);
            }
            
            <span class="hljs-comment">// æ˜¾ç¤ºæ€è€ƒä¸­çš„çŠ¶æ€</span>
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addStatusCard</span>(<span class="hljs-string">'thinking'</span>, <span class="hljs-string">'æ­£åœ¨åˆ†ææ‚¨çš„éœ€æ±‚...'</span>);
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showTypingIndicator</span>();
            
        } <span class="hljs-keyword">catch</span> (error) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å‘é€æ¶ˆæ¯å¤±è´¥:'</span>, error);
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addMessage</span>(<span class="hljs-string">'assistant'</span>, <span class="hljs-string">'æŠ±æ­‰ï¼Œå‘é€æ¶ˆæ¯æ—¶å‡ºç°é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•ã€‚'</span>, <span class="hljs-literal">true</span>);
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">false</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateUIState</span>();
        }
    }
    
    <span class="hljs-comment">/**
     * ç¡®è®¤æ™ºèƒ½ä½“æ“ä½œ
     */</span>
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">confirmAction</span>(<span class="hljs-params">confirmedData = <span class="hljs-literal">null</span></span>) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">pendingActionId</span>) <span class="hljs-keyword">return</span>;
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/agent/confirm-action'</span>, {
                <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
                <span class="hljs-attr">headers</span>: {
                    <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
                },
                <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
                    <span class="hljs-attr">session_id</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentSessionId</span>,
                    <span class="hljs-attr">action_id</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">pendingActionId</span>,
                    <span class="hljs-attr">user_confirmation</span>: confirmedData
                })
            });
            
            <span class="hljs-keyword">if</span> (response.<span class="hljs-property">ok</span>) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeActionPreview</span>();
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">pendingActionId</span> = <span class="hljs-literal">null</span>;
            }
        } <span class="hljs-keyword">catch</span> (error) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'ç¡®è®¤æ“ä½œå¤±è´¥:'</span>, error);
        }
    }
    
    <span class="hljs-comment">/**
     * ä¿®æ”¹æ“ä½œ
     */</span>
    <span class="hljs-title function_">modifyAction</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œå¯ä»¥æ‰“å¼€ä¸€ä¸ªä¿®æ”¹ç•Œé¢</span>
        <span class="hljs-keyword">const</span> modification = <span class="hljs-title function_">prompt</span>(<span class="hljs-string">'è¯·è¾“å…¥ä¿®æ”¹å†…å®¹ï¼ˆä¾‹å¦‚ï¼šæ¢å¤§æ¯å¯ä¹ï¼ŒåŠ ä¸€ä»½è–¯æ¡ï¼‰ï¼š'</span>);
        <span class="hljs-keyword">if</span> (modification) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addMessage</span>(<span class="hljs-string">'user'</span>, <span class="hljs-string">`ä¿®æ”¹ï¼š<span class="hljs-subst">${modification}</span>`</span>, <span class="hljs-literal">true</span>);
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeActionPreview</span>();
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">sendModification</span>(modification);
        }
    }
    
    <span class="hljs-comment">/**
     * å‘é€ä¿®æ”¹è¯·æ±‚
     */</span>
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">sendModification</span>(<span class="hljs-params">modification</span>) {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/agent/modify'</span>, {
                <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
                <span class="hljs-attr">headers</span>: {
                    <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
                },
                <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
                    <span class="hljs-attr">session_id</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentSessionId</span>,
                    <span class="hljs-attr">modification</span>: modification
                })
            });
            
            <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'ä¿®æ”¹è¯·æ±‚å¤±è´¥'</span>);
            }
        } <span class="hljs-keyword">catch</span> (error) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å‘é€ä¿®æ”¹å¤±è´¥:'</span>, error);
        }
    }
    
    <span class="hljs-comment">/**
     * æ˜¾ç¤ºæ¬¢è¿æ¶ˆæ¯
     */</span>
    <span class="hljs-title function_">showWelcomeMessage</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> welcomeMessages = [
            <span class="hljs-string">"ğŸ‘‹ ä½ å¥½ï¼æˆ‘æ˜¯AIå¤–å–åŠ©æ‰‹ï¼Œå¯ä»¥å¸®ä½ å®Œæˆä»é€‰é¤åˆ°æ”¯ä»˜çš„å…¨æµç¨‹ã€‚"</span>,
            <span class="hljs-string">"ğŸ’¡ ä½ å¯ä»¥è¿™æ ·å¯¹æˆ‘è¯´ï¼š"</span>,
            <span class="hljs-string">"â€¢ \"å¸®æˆ‘ç‚¹ä¸€ä»½éº¦å½“åŠ³å·¨æ— éœ¸å¥—é¤ï¼Œé€åˆ°XXå¤§å¦\""</span>,
            <span class="hljs-string">"â€¢ \"æˆ‘æƒ³åƒæŠ«è¨ï¼Œé€åˆ°å…¬å¸åœ°å€\""</span>,
            <span class="hljs-string">"â€¢ \"ç‚¹ä¸€ä»½å¤–å–ï¼Œé¢„ç®—50å…ƒå·¦å³\""</span>,
            <span class="hljs-string">"æˆ‘ä¼šä¸€æ­¥æ­¥å¼•å¯¼ä½ å®Œæˆè®¢å•ï¼Œå¹¶åœ¨æœ€åè·³è½¬åˆ°æ”¯ä»˜é¡µé¢ã€‚"</span>
        ];
        
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            welcomeMessages.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">msg, index</span>) =&gt;</span> {
                <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
                    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addMessage</span>(<span class="hljs-string">'assistant'</span>, msg, <span class="hljs-literal">true</span>);
                }, index * <span class="hljs-number">300</span>);
            });
        }, <span class="hljs-number">1000</span>);
    }
    
    <span class="hljs-comment">/**
     * æ·»åŠ æ¶ˆæ¯åˆ°èŠå¤©ç•Œé¢
     */</span>
    <span class="hljs-title function_">addMessage</span>(<span class="hljs-params">role, content, animate = <span class="hljs-literal">true</span></span>) {
        <span class="hljs-keyword">const</span> messageDiv = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
        messageDiv.<span class="hljs-property">className</span> = <span class="hljs-string">`message <span class="hljs-subst">${role}</span>-message`</span>;
        
        <span class="hljs-keyword">const</span> bubble = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
        bubble.<span class="hljs-property">className</span> = <span class="hljs-string">'message-bubble'</span>;
        bubble.<span class="hljs-property">textContent</span> = content;
        
        messageDiv.<span class="hljs-title function_">appendChild</span>(bubble);
        
        <span class="hljs-keyword">if</span> (animate) {
            messageDiv.<span class="hljs-property">style</span>.<span class="hljs-property">opacity</span> = <span class="hljs-string">'0'</span>;
            messageDiv.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">'translateY(10px)'</span>;
        }
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">messagesContainer</span>.<span class="hljs-title function_">appendChild</span>(messageDiv);
        
        <span class="hljs-keyword">if</span> (animate) {
            <span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-function">() =&gt;</span> {
                messageDiv.<span class="hljs-property">style</span>.<span class="hljs-property">transition</span> = <span class="hljs-string">'opacity 0.3s ease, transform 0.3s ease'</span>;
                messageDiv.<span class="hljs-property">style</span>.<span class="hljs-property">opacity</span> = <span class="hljs-string">'1'</span>;
                messageDiv.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">'translateY(0)'</span>;
            });
        }
        
        <span class="hljs-comment">// æ»šåŠ¨åˆ°åº•éƒ¨</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">scrollToBottom</span>();
    }
    
    <span class="hljs-comment">/**
     * æ˜¾ç¤ºè¾“å…¥æŒ‡ç¤ºå™¨
     */</span>
    <span class="hljs-title function_">showTypingIndicator</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeTypingIndicator</span>(); <span class="hljs-comment">// å…ˆç§»é™¤å¯èƒ½å­˜åœ¨çš„ç°æœ‰æŒ‡ç¤ºå™¨</span>
        
        <span class="hljs-keyword">const</span> typingDiv = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
        typingDiv.<span class="hljs-property">className</span> = <span class="hljs-string">'message agent-message typing-indicator'</span>;
        typingDiv.<span class="hljs-property">id</span> = <span class="hljs-string">'typingIndicator'</span>;
        
        <span class="hljs-keyword">const</span> typingBubble = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
        typingBubble.<span class="hljs-property">className</span> = <span class="hljs-string">'message-typing'</span>;
        
        <span class="hljs-keyword">const</span> dots = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
        dots.<span class="hljs-property">className</span> = <span class="hljs-string">'typing-dots'</span>;
        dots.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">'&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;'</span>;
        
        typingBubble.<span class="hljs-title function_">appendChild</span>(dots);
        typingDiv.<span class="hljs-title function_">appendChild</span>(typingBubble);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">messagesContainer</span>.<span class="hljs-title function_">appendChild</span>(typingDiv);
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">scrollToBottom</span>();
    }
    
    <span class="hljs-comment">/**
     * ç§»é™¤è¾“å…¥æŒ‡ç¤ºå™¨
     */</span>
    <span class="hljs-title function_">removeTypingIndicator</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> existingIndicator = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'typingIndicator'</span>);
        <span class="hljs-keyword">if</span> (existingIndicator) {
            existingIndicator.<span class="hljs-title function_">remove</span>();
        }
    }
    
    <span class="hljs-comment">/**
     * æ·»åŠ çŠ¶æ€å¡ç‰‡
     */</span>
    <span class="hljs-title function_">addStatusCard</span>(<span class="hljs-params">status, details</span>) {
        <span class="hljs-keyword">const</span> statusCard = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
        statusCard.<span class="hljs-property">className</span> = <span class="hljs-string">'status-card'</span>;
        
        <span class="hljs-keyword">const</span> now = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();
        <span class="hljs-keyword">const</span> timeString = now.<span class="hljs-title function_">toLocaleTimeString</span>(<span class="hljs-string">'zh-CN'</span>, { 
            <span class="hljs-attr">hour</span>: <span class="hljs-string">'2-digit'</span>, 
            <span class="hljs-attr">minute</span>: <span class="hljs-string">'2-digit'</span>,
            <span class="hljs-attr">second</span>: <span class="hljs-string">'2-digit'</span>
        });
        
        <span class="hljs-keyword">let</span> statusIcon = <span class="hljs-string">'ğŸ”µ'</span>;
        <span class="hljs-keyword">let</span> statusText = <span class="hljs-string">'å¤„ç†ä¸­'</span>;
        
        <span class="hljs-keyword">switch</span>(status) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">'thinking'</span>:
                statusIcon = <span class="hljs-string">'ğŸ¤”'</span>;
                statusText = <span class="hljs-string">'æ€è€ƒä¸­'</span>;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'querying_menu'</span>:
                statusIcon = <span class="hljs-string">'ğŸ“‹'</span>;
                statusText = <span class="hljs-string">'æŸ¥è¯¢èœå•'</span>;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'executing_tool'</span>:
                statusIcon = <span class="hljs-string">'âš™ï¸'</span>;
                statusText = <span class="hljs-string">'æ‰§è¡Œå·¥å…·'</span>;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'waiting_confirmation'</span>:
                statusIcon = <span class="hljs-string">'â³'</span>;
                statusText = <span class="hljs-string">'ç­‰å¾…ç¡®è®¤'</span>;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'error'</span>:
                statusIcon = <span class="hljs-string">'âŒ'</span>;
                statusText = <span class="hljs-string">'é”™è¯¯'</span>;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'completed'</span>:
                statusIcon = <span class="hljs-string">'âœ…'</span>;
                statusText = <span class="hljs-string">'å·²å®Œæˆ'</span>;
                <span class="hljs-keyword">break</span>;
        }
        
        statusCard.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">`
            &lt;h4&gt;<span class="hljs-subst">${statusIcon}</span> <span class="hljs-subst">${statusText}</span>&lt;/h4&gt;
            &lt;p&gt;<span class="hljs-subst">${details}</span>&lt;/p&gt;
            &lt;div class="timestamp"&gt;<span class="hljs-subst">${timeString}</span>&lt;/div&gt;
        `</span>;
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">statusContainer</span>.<span class="hljs-title function_">appendChild</span>(statusCard);
        
        <span class="hljs-comment">// æ»šåŠ¨çŠ¶æ€å®¹å™¨åˆ°åº•éƒ¨</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">statusContainer</span>.<span class="hljs-property">scrollTop</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">statusContainer</span>.<span class="hljs-property">scrollHeight</span>;
    }
    
    <span class="hljs-comment">/**
     * æ˜¾ç¤ºæ“ä½œé¢„è§ˆ
     */</span>
    <span class="hljs-title function_">showActionPreview</span>(<span class="hljs-params">data</span>) {
        <span class="hljs-keyword">const</span> actionCard = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
        actionCard.<span class="hljs-property">className</span> = <span class="hljs-string">'action-preview-card'</span>;
        actionCard.<span class="hljs-property">id</span> = <span class="hljs-string">'actionPreviewCard'</span>;
        
        <span class="hljs-keyword">let</span> actionDetails = <span class="hljs-string">''</span>;
        <span class="hljs-keyword">let</span> actionTitle = <span class="hljs-string">'è¯·ç¡®è®¤æ“ä½œ'</span>;
        
        <span class="hljs-keyword">switch</span>(data.<span class="hljs-property">action</span>) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">'add_to_cart'</span>:
                actionTitle = <span class="hljs-string">'ğŸ›’ æ·»åŠ åˆ°è´­ç‰©è½¦'</span>;
                actionDetails = <span class="hljs-string">`
                    &lt;div&gt;&lt;strong&gt;é¤å…ï¼š&lt;/strong&gt;<span class="hljs-subst">${data.params.restaurant || <span class="hljs-string">'æœªçŸ¥'</span>}</span>&lt;/div&gt;
                    &lt;div&gt;&lt;strong&gt;å•†å“ï¼š&lt;/strong&gt;&lt;/div&gt;
                    &lt;ul&gt;
                        <span class="hljs-subst">${(data.params.items || []).map(item =&gt; 
                            <span class="hljs-string">`&lt;li&gt;<span class="hljs-subst">${item.name}</span> Ã— <span class="hljs-subst">${item.quantity}</span>&lt;/li&gt;`</span>
                        ).join(<span class="hljs-string">''</span>)}</span>
                    &lt;/ul&gt;
                `</span>;
                <span class="hljs-keyword">break</span>;
                
            <span class="hljs-keyword">case</span> <span class="hljs-string">'select_address'</span>:
                actionTitle = <span class="hljs-string">'ğŸ“ é€‰æ‹©åœ°å€'</span>;
                actionDetails = <span class="hljs-string">`
                    &lt;div&gt;&lt;strong&gt;è¯·é€‰æ‹©æ”¶è´§åœ°å€ï¼š&lt;/strong&gt;&lt;/div&gt;
                    <span class="hljs-subst">${(data.params.options || []).map((addr, idx) =&gt; <span class="hljs-string">`
                        &lt;div style="margin: 8px 0; padding: 8px; border: 1px solid #e5e7eb; border-radius: 6px;"&gt;
                            &lt;label&gt;
                                &lt;input type="radio" name="address" value="<span class="hljs-subst">${addr.id}</span>" <span class="hljs-subst">${idx === <span class="hljs-number">0</span> ? <span class="hljs-string">'checked'</span> : <span class="hljs-string">''</span>}</span>&gt;
                                <span class="hljs-subst">${addr.name}</span> (<span class="hljs-subst">${addr.address}</span>)
                            &lt;/label&gt;
                        &lt;/div&gt;
                    `</span>).join(<span class="hljs-string">''</span>)}</span>
                `</span>;
                <span class="hljs-keyword">break</span>;
                
            <span class="hljs-keyword">case</span> <span class="hljs-string">'get_payment_page'</span>:
                actionTitle = <span class="hljs-string">'ğŸ’° å‰å¾€æ”¯ä»˜'</span>;
                actionDetails = <span class="hljs-string">`
                    &lt;div&gt;&lt;strong&gt;è®¢å•æ‘˜è¦ï¼š&lt;/strong&gt;&lt;/div&gt;
                    &lt;div&gt;æ€»é‡‘é¢ï¼šÂ¥<span class="hljs-subst">${data.params.total_price || <span class="hljs-string">'0.00'</span>}</span>&lt;/div&gt;
                    &lt;div&gt;é…é€åœ°å€ï¼š<span class="hljs-subst">${data.params.address || <span class="hljs-string">'è¯·ç¡®è®¤åœ°å€'</span>}</span>&lt;/div&gt;
                    &lt;div&gt;é¢„è®¡é€è¾¾ï¼š<span class="hljs-subst">${data.params.estimated_delivery || <span class="hljs-string">'30åˆ†é’Ÿ'</span>}</span>&lt;/div&gt;
                `</span>;
                <span class="hljs-keyword">break</span>;
        }
        
        actionCard.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">`
            &lt;h3&gt;<span class="hljs-subst">${actionTitle}</span>&lt;/h3&gt;
            &lt;div class="action-details"&gt;<span class="hljs-subst">${actionDetails}</span>&lt;/div&gt;
            &lt;div class="action-buttons"&gt;
                &lt;button onclick="assistant.confirmAction(getConfirmedData())" class="btn btn-confirm"&gt;ç¡®è®¤&lt;/button&gt;
                &lt;button onclick="assistant.modifyAction()" class="btn btn-modify"&gt;ä¿®æ”¹&lt;/button&gt;
            &lt;/div&gt;
        `</span>;
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">statusContainer</span>.<span class="hljs-title function_">appendChild</span>(actionCard);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">statusContainer</span>.<span class="hljs-property">scrollTop</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">statusContainer</span>.<span class="hljs-property">scrollHeight</span>;
    }
    
    <span class="hljs-comment">/**
     * ç§»é™¤æ“ä½œé¢„è§ˆ
     */</span>
    <span class="hljs-title function_">removeActionPreview</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> existingCard = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'actionPreviewCard'</span>);
        <span class="hljs-keyword">if</span> (existingCard) {
            existingCard.<span class="hljs-title function_">remove</span>();
        }
    }
    
    <span class="hljs-comment">/**
     * æ˜¾ç¤ºæ”¯ä»˜é¡µé¢
     */</span>
    <span class="hljs-title function_">showPaymentPage</span>(<span class="hljs-params">url, token</span>) {
        <span class="hljs-comment">// æ„å»ºå®Œæ•´çš„æ”¯ä»˜URLï¼ˆåŒ…å«tokenï¼‰</span>
        <span class="hljs-keyword">const</span> paymentUrl = <span class="hljs-string">`<span class="hljs-subst">${url}</span><span class="hljs-subst">${url.includes(<span class="hljs-string">'?'</span>) ? <span class="hljs-string">'&amp;'</span> : <span class="hljs-string">'?'</span>}</span>token=<span class="hljs-subst">${token}</span>&amp;embedded=true`</span>;
        
        <span class="hljs-comment">// æ›´æ–°iframeæº</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">paymentFrame</span>.<span class="hljs-property">src</span> = paymentUrl;
        
        <span class="hljs-comment">// æ˜¾ç¤ºæ”¯ä»˜å®¹å™¨</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">paymentSection</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'block'</span>;
        
        <span class="hljs-comment">// æ»šåŠ¨åˆ°æ”¯ä»˜åŒºåŸŸ</span>
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">paymentSection</span>.<span class="hljs-title function_">scrollIntoView</span>({ <span class="hljs-attr">behavior</span>: <span class="hljs-string">'smooth'</span> });
        }, <span class="hljs-number">500</span>);
    }
    
    <span class="hljs-comment">/**
     * éšè—æ”¯ä»˜é¡µé¢
     */</span>
    <span class="hljs-title function_">hidePaymentSection</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">paymentSection</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">paymentFrame</span>.<span class="hljs-property">src</span> = <span class="hljs-string">''</span>;
    }
    
    <span class="hljs-comment">/**
     * è·å–ç”¨æˆ·ä½ç½®ï¼ˆæ¨¡æ‹Ÿï¼‰
     */</span>
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">getUserLocation</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
            <span class="hljs-keyword">if</span> (navigator.<span class="hljs-property">geolocation</span>) {
                navigator.<span class="hljs-property">geolocation</span>.<span class="hljs-title function_">getCurrentPosition</span>(
                    <span class="hljs-function">(<span class="hljs-params">position</span>) =&gt;</span> {
                        <span class="hljs-title function_">resolve</span>({
                            <span class="hljs-attr">latitude</span>: position.<span class="hljs-property">coords</span>.<span class="hljs-property">latitude</span>,
                            <span class="hljs-attr">longitude</span>: position.<span class="hljs-property">coords</span>.<span class="hljs-property">longitude</span>,
                            <span class="hljs-attr">accuracy</span>: position.<span class="hljs-property">coords</span>.<span class="hljs-property">accuracy</span>
                        });
                    },
                    <span class="hljs-function">() =&gt;</span> {
                        <span class="hljs-comment">// è·å–å¤±è´¥æ—¶ä½¿ç”¨é»˜è®¤ä½ç½®</span>
                        <span class="hljs-title function_">resolve</span>({
                            <span class="hljs-attr">latitude</span>: <span class="hljs-number">39.9042</span>,
                            <span class="hljs-attr">longitude</span>: <span class="hljs-number">116.4074</span>,
                            <span class="hljs-attr">accuracy</span>: <span class="hljs-number">1000</span>,
                            <span class="hljs-attr">city</span>: <span class="hljs-string">'åŒ—äº¬å¸‚'</span>
                        });
                    },
                    { <span class="hljs-attr">timeout</span>: <span class="hljs-number">5000</span> }
                );
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-title function_">resolve</span>({
                    <span class="hljs-attr">latitude</span>: <span class="hljs-number">39.9042</span>,
                    <span class="hljs-attr">longitude</span>: <span class="hljs-number">116.4074</span>,
                    <span class="hljs-attr">city</span>: <span class="hljs-string">'åŒ—äº¬å¸‚'</span>
                });
            }
        });
    }
    
    <span class="hljs-comment">/**
     * æ›´æ–°UIçŠ¶æ€
     */</span>
    <span class="hljs-title function_">updateUIState</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> hasText = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">userInput</span>.<span class="hljs-property">value</span>.<span class="hljs-title function_">trim</span>().<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">sendButton</span>.<span class="hljs-property">disabled</span> = !hasText || <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">userInput</span>.<span class="hljs-property">disabled</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span>;
        
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">userInput</span>.<span class="hljs-property">placeholder</span> = <span class="hljs-string">'æ™ºèƒ½ä½“æ­£åœ¨å¤„ç†ä¸­ï¼Œè¯·ç¨å€™...'</span>;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">userInput</span>.<span class="hljs-property">placeholder</span> = <span class="hljs-string">'å‘Šè¯‰æˆ‘ä½ æƒ³åƒä»€ä¹ˆï¼Ÿä¾‹å¦‚ï¼šå¸®æˆ‘ç‚¹ä¸€ä»½éº¦å½“åŠ³å·¨æ— éœ¸å¥—é¤ï¼Œé€åˆ°XXå¤§å¦ï¼Œå¸®æˆ‘åˆ°ä»˜æ¬¾ç•Œé¢'</span>;
        }
    }
    
    <span class="hljs-comment">/**
     * æ»šåŠ¨åˆ°åº•éƒ¨
     */</span>
    <span class="hljs-title function_">scrollToBottom</span>(<span class="hljs-params"/>) {
        <span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">messagesContainer</span>.<span class="hljs-property">scrollTop</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">messagesContainer</span>.<span class="hljs-property">scrollHeight</span>;
        });
    }
}

<span class="hljs-comment">/**
 * è·å–ç¡®è®¤æ•°æ®ï¼ˆç”¨äºè¡¨å•æ•°æ®ï¼‰
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getConfirmedData</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> actionCard = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'actionPreviewCard'</span>);
    <span class="hljs-keyword">if</span> (!actionCard) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰åœ°å€é€‰æ‹©</span>
    <span class="hljs-keyword">const</span> addressRadio = actionCard.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'input[name="address"]:checked'</span>);
    <span class="hljs-keyword">if</span> (addressRadio) {
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">address_id</span>: addressRadio.<span class="hljs-property">value</span> };
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}

<span class="hljs-comment">// åˆ›å»ºåŠ©æ‰‹å®ä¾‹</span>
<span class="hljs-keyword">const</span> assistant = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AIFoodOrderingAssistant</span>();

<span class="hljs-comment">// ä½¿åŠ©æ‰‹å…¨å±€å¯ç”¨ï¼ˆç”¨äºæŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼‰</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-property">assistant</span> = assistant;
<span class="hljs-variable language_">window</span>.<span class="hljs-property">hidePaymentSection</span> = <span class="hljs-function">() =&gt;</span> assistant.<span class="hljs-title function_">hidePaymentSection</span>();
</code></pre>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-CN"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>AIå¤–å–åŠ©æ‰‹<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        * {
            <span class="hljs-attribute">box-sizing</span>: border-box;
            <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
        }
        
        <span class="hljs-selector-tag">body</span> {
            <span class="hljs-attribute">font-family</span>: -apple-system, BlinkMacSystemFont, <span class="hljs-string">'Segoe UI'</span>, Roboto, sans-serif;
            <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">135deg</span>, <span class="hljs-number">#667eea</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#764ba2</span> <span class="hljs-number">100%</span>);
            <span class="hljs-attribute">min-height</span>: <span class="hljs-number">100vh</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
        }
        
        <span class="hljs-selector-class">.app-container</span> {
            <span class="hljs-attribute">max-width</span>: <span class="hljs-number">800px</span>;
            <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto;
            <span class="hljs-attribute">background</span>: white;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">20px</span> <span class="hljs-number">60px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.3</span>);
            <span class="hljs-attribute">overflow</span>: hidden;
        }
        
        <span class="hljs-selector-class">.header</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">135deg</span>, <span class="hljs-number">#667eea</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#764ba2</span> <span class="hljs-number">100%</span>);
            <span class="hljs-attribute">color</span>: white;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">24px</span>;
            <span class="hljs-attribute">text-align</span>: center;
        }
        
        <span class="hljs-selector-class">.header</span> <span class="hljs-selector-tag">h1</span> {
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">28px</span>;
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">8px</span>;
            <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">600</span>;
        }
        
        <span class="hljs-selector-class">.header</span> <span class="hljs-selector-tag">p</span> {
            <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.9</span>;
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
        }
        
        <span class="hljs-selector-class">.main-content</span> {
            <span class="hljs-attribute">display</span>: flex;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">70vh</span>;
        }
        
        <span class="hljs-comment">/* å·¦ä¾§ï¼šå¯¹è¯åŒº */</span>
        <span class="hljs-selector-class">.chat-section</span> {
            <span class="hljs-attribute">flex</span>: <span class="hljs-number">3</span>;
            <span class="hljs-attribute">border-right</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#e5e7eb</span>;
            <span class="hljs-attribute">display</span>: flex;
            <span class="hljs-attribute">flex-direction</span>: column;
        }
        
        <span class="hljs-selector-class">.chat-header</span> {
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">16px</span>;
            <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#e5e7eb</span>;
            <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">600</span>;
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#374151</span>;
        }
        
        <span class="hljs-selector-class">.messages-container</span> {
            <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;
            <span class="hljs-attribute">overflow-y</span>: auto;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">background</span>: <span class="hljs-number">#f9fafb</span>;
        }
        
        <span class="hljs-selector-class">.message</span> {
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">animation</span>: fadeIn <span class="hljs-number">0.3s</span> ease;
        }
        
        <span class="hljs-selector-class">.user-message</span> {
            <span class="hljs-attribute">text-align</span>: right;
        }
        
        <span class="hljs-selector-class">.agent-message</span> {
            <span class="hljs-attribute">text-align</span>: left;
        }
        
        <span class="hljs-selector-class">.message-bubble</span> {
            <span class="hljs-attribute">display</span>: inline-block;
            <span class="hljs-attribute">max-width</span>: <span class="hljs-number">70%</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">12px</span> <span class="hljs-number">16px</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">18px</span>;
            <span class="hljs-attribute">word-wrap</span>: break-word;
            <span class="hljs-attribute">line-height</span>: <span class="hljs-number">1.4</span>;
        }
        
        <span class="hljs-selector-class">.user-message</span> <span class="hljs-selector-class">.message-bubble</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-number">#3b82f6</span>;
            <span class="hljs-attribute">color</span>: white;
            <span class="hljs-attribute">border-bottom-right-radius</span>: <span class="hljs-number">4px</span>;
        }
        
        <span class="hljs-selector-class">.agent-message</span> <span class="hljs-selector-class">.message-bubble</span> {
            <span class="hljs-attribute">background</span>: white;
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#374151</span>;
            <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#e5e7eb</span>;
            <span class="hljs-attribute">border-bottom-left-radius</span>: <span class="hljs-number">4px</span>;
        }
        
        <span class="hljs-selector-class">.message-typing</span> {
            <span class="hljs-attribute">display</span>: inline-flex;
            <span class="hljs-attribute">align-items</span>: center;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">12px</span> <span class="hljs-number">16px</span>;
            <span class="hljs-attribute">background</span>: white;
            <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#e5e7eb</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">18px</span>;
            <span class="hljs-attribute">border-bottom-left-radius</span>: <span class="hljs-number">4px</span>;
        }
        
        <span class="hljs-selector-class">.typing-dots</span> {
            <span class="hljs-attribute">display</span>: flex;
            <span class="hljs-attribute">gap</span>: <span class="hljs-number">4px</span>;
        }
        
        <span class="hljs-selector-class">.typing-dots</span> <span class="hljs-selector-tag">span</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">6px</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">6px</span>;
            <span class="hljs-attribute">background</span>: <span class="hljs-number">#9ca3af</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;
            <span class="hljs-attribute">animation</span>: typing <span class="hljs-number">1.4s</span> infinite ease-in-out;
        }
        
        <span class="hljs-selector-class">.typing-dots</span> <span class="hljs-selector-tag">span</span><span class="hljs-selector-pseudo">:nth-child</span>(<span class="hljs-number">2</span>) {
            <span class="hljs-attribute">animation-delay</span>: <span class="hljs-number">0.2s</span>;
        }
        
        <span class="hljs-selector-class">.typing-dots</span> <span class="hljs-selector-tag">span</span><span class="hljs-selector-pseudo">:nth-child</span>(<span class="hljs-number">3</span>) {
            <span class="hljs-attribute">animation-delay</span>: <span class="hljs-number">0.4s</span>;
        }
        
        <span class="hljs-comment">/* å³ä¾§ï¼šæ™ºèƒ½ä½“çŠ¶æ€å’Œæ“ä½œåŒº */</span>
        <span class="hljs-selector-class">.status-section</span> {
            <span class="hljs-attribute">flex</span>: <span class="hljs-number">2</span>;
            <span class="hljs-attribute">display</span>: flex;
            <span class="hljs-attribute">flex-direction</span>: column;
            <span class="hljs-attribute">background</span>: white;
        }
        
        <span class="hljs-selector-class">.status-header</span> {
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">16px</span>;
            <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#e5e7eb</span>;
            <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">600</span>;
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#374151</span>;
        }
        
        <span class="hljs-selector-class">.status-container</span> {
            <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;
            <span class="hljs-attribute">overflow-y</span>: auto;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
        }
        
        <span class="hljs-selector-class">.status-card</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-number">#f3f4f6</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">12px</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">16px</span>;
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">16px</span>;
            <span class="hljs-attribute">border-left</span>: <span class="hljs-number">4px</span> solid <span class="hljs-number">#3b82f6</span>;
            <span class="hljs-attribute">animation</span>: slideIn <span class="hljs-number">0.3s</span> ease;
        }
        
        <span class="hljs-selector-class">.status-card</span> <span class="hljs-selector-tag">h4</span> {
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#374151</span>;
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">8px</span>;
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
            <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">600</span>;
        }
        
        <span class="hljs-selector-class">.status-card</span> <span class="hljs-selector-tag">p</span> {
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#6b7280</span>;
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">13px</span>;
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">4px</span>;
        }
        
        <span class="hljs-selector-class">.status-card</span> <span class="hljs-selector-class">.timestamp</span> {
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">11px</span>;
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#9ca3af</span>;
            <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">8px</span>;
        }
        
        <span class="hljs-comment">/* æ“ä½œé¢„è§ˆå¡ç‰‡ */</span>
        <span class="hljs-selector-class">.action-preview-card</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-number">#fef3c7</span>;
            <span class="hljs-attribute">border</span>: <span class="hljs-number">2px</span> solid <span class="hljs-number">#f59e0b</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">12px</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">animation</span>: pulse <span class="hljs-number">2s</span> infinite;
        }
        
        <span class="hljs-selector-class">.action-preview-card</span> <span class="hljs-selector-tag">h3</span> {
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#92400e</span>;
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">12px</span>;
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">16px</span>;
        }
        
        <span class="hljs-selector-class">.action-details</span> {
            <span class="hljs-attribute">background</span>: white;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">12px</span>;
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">16px</span>;
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
        }
        
        <span class="hljs-selector-class">.action-buttons</span> {
            <span class="hljs-attribute">display</span>: flex;
            <span class="hljs-attribute">gap</span>: <span class="hljs-number">12px</span>;
        }
        
        <span class="hljs-selector-class">.btn</span> {
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span> <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">border</span>: none;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;
            <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">600</span>;
            <span class="hljs-attribute">cursor</span>: pointer;
            <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.2s</span> ease;
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
        }
        
        <span class="hljs-selector-class">.btn-confirm</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-number">#10b981</span>;
            <span class="hljs-attribute">color</span>: white;
            <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;
        }
        
        <span class="hljs-selector-class">.btn-confirm</span><span class="hljs-selector-pseudo">:hover</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-number">#059669</span>;
        }
        
        <span class="hljs-selector-class">.btn-modify</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-number">#f3f4f6</span>;
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#374151</span>;
            <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;
        }
        
        <span class="hljs-selector-class">.btn-modify</span><span class="hljs-selector-pseudo">:hover</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-number">#e5e7eb</span>;
        }
        
        <span class="hljs-comment">/* è¾“å…¥åŒº */</span>
        <span class="hljs-selector-class">.input-section</span> {
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">border-top</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#e5e7eb</span>;
            <span class="hljs-attribute">background</span>: white;
        }
        
        <span class="hljs-selector-class">.input-container</span> {
            <span class="hljs-attribute">display</span>: flex;
            <span class="hljs-attribute">gap</span>: <span class="hljs-number">12px</span>;
        }
        
        <span class="hljs-selector-id">#userInput</span> {
            <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">14px</span> <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">border</span>: <span class="hljs-number">2px</span> solid <span class="hljs-number">#e5e7eb</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">12px</span>;
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">16px</span>;
            <span class="hljs-attribute">transition</span>: border-color <span class="hljs-number">0.2s</span> ease;
        }
        
        <span class="hljs-selector-id">#userInput</span><span class="hljs-selector-pseudo">:focus</span> {
            <span class="hljs-attribute">outline</span>: none;
            <span class="hljs-attribute">border-color</span>: <span class="hljs-number">#3b82f6</span>;
        }
        
        <span class="hljs-selector-class">.btn-send</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">135deg</span>, <span class="hljs-number">#667eea</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#764ba2</span> <span class="hljs-number">100%</span>);
            <span class="hljs-attribute">color</span>: white;
            <span class="hljs-attribute">border</span>: none;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">12px</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">28px</span>;
            <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">600</span>;
            <span class="hljs-attribute">cursor</span>: pointer;
            <span class="hljs-attribute">transition</span>: transform <span class="hljs-number">0.2s</span> ease;
        }
        
        <span class="hljs-selector-class">.btn-send</span><span class="hljs-selector-pseudo">:hover</span><span class="hljs-selector-pseudo">:not</span>(<span class="hljs-selector-pseudo">:disabled</span>) {
            <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">2px</span>);
        }
        
        <span class="hljs-selector-class">.btn-send</span><span class="hljs-selector-pseudo">:disabled</span> {
            <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.5</span>;
            <span class="hljs-attribute">cursor</span>: not-allowed;
        }
        
        <span class="hljs-comment">/* æ”¯ä»˜é¡µé¢å®¹å™¨ */</span>
        <span class="hljs-selector-class">.payment-container</span> {
            <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">border</span>: <span class="hljs-number">2px</span> dashed <span class="hljs-number">#10b981</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">12px</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">background</span>: <span class="hljs-number">#f0fdf4</span>;
            <span class="hljs-attribute">animation</span>: fadeIn <span class="hljs-number">0.5s</span> ease;
        }
        
        <span class="hljs-selector-class">.payment-header</span> {
            <span class="hljs-attribute">display</span>: flex;
            <span class="hljs-attribute">justify-content</span>: space-between;
            <span class="hljs-attribute">align-items</span>: center;
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">16px</span>;
        }
        
        <span class="hljs-selector-class">.payment-header</span> <span class="hljs-selector-tag">h3</span> {
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#065f46</span>;
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">16px</span>;
        }
        
        <span class="hljs-selector-class">.payment-frame</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">400px</span>;
            <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#d1d5db</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;
            <span class="hljs-attribute">overflow</span>: hidden;
        }
        
        <span class="hljs-comment">/* åŠ¨ç”» */</span>
        <span class="hljs-keyword">@keyframes</span> fadeIn {
            <span class="hljs-selector-tag">from</span> { <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>; <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">10px</span>); }
            <span class="hljs-selector-tag">to</span> { <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>; <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">0</span>); }
        }
        
        <span class="hljs-keyword">@keyframes</span> slideIn {
            <span class="hljs-selector-tag">from</span> { <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>; <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">10px</span>); }
            <span class="hljs-selector-tag">to</span> { <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>; <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-number">0</span>); }
        }
        
        <span class="hljs-keyword">@keyframes</span> typing {
            <span class="hljs-number">0%</span>, <span class="hljs-number">60%</span>, <span class="hljs-number">100%</span> { <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">0</span>); }
            <span class="hljs-number">30%</span> { <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">4px</span>); }
        }
        
        <span class="hljs-keyword">@keyframes</span> pulse {
            <span class="hljs-number">0%</span>, <span class="hljs-number">100%</span> { <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>; }
            <span class="hljs-number">50%</span> { <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.8</span>; }
        }
        
        <span class="hljs-comment">/* ä¼šè¯ç®¡ç† */</span>
        <span class="hljs-selector-class">.session-info</span> {
            <span class="hljs-attribute">display</span>: flex;
            <span class="hljs-attribute">align-items</span>: center;
            <span class="hljs-attribute">gap</span>: <span class="hljs-number">12px</span>;
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">12px</span>;
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#9ca3af</span>;
            <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">8px</span>;
        }
        
        <span class="hljs-selector-class">.session-id</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">0.2</span>);
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">2px</span> <span class="hljs-number">8px</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">10px</span>;
            <span class="hljs-attribute">font-family</span>: monospace;
        }
        
        <span class="hljs-comment">/* å“åº”å¼è®¾è®¡ */</span>
        <span class="hljs-keyword">@media</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">768px</span>) {
            <span class="hljs-selector-class">.main-content</span> {
                <span class="hljs-attribute">flex-direction</span>: column;
                <span class="hljs-attribute">height</span>: auto;
            }
            
            <span class="hljs-selector-class">.status-section</span> {
                <span class="hljs-attribute">height</span>: <span class="hljs-number">300px</span>;
            }
            
            <span class="hljs-selector-tag">body</span> {
                <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span>;
            }
            
            <span class="hljs-selector-class">.message-bubble</span> {
                <span class="hljs-attribute">max-width</span>: <span class="hljs-number">85%</span>;
            }
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"app-container"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"header"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ğŸ¤– AIå¤–å–åŠ©æ‰‹<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ™ºèƒ½ç‚¹é¤ï¼Œä¸€å¥è¯å®Œæˆä»é€‰é¤åˆ°æ”¯ä»˜çš„å…¨æµç¨‹<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"session-info"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>ä¼šè¯ID: <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"sessionId"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"session-id"</span>&gt;</span>loading...<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>çŠ¶æ€: <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"connectionStatus"</span>&gt;</span>ğŸŸ¡ è¿æ¥ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"main-content"</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- å·¦ä¾§ï¼šå¯¹è¯åŒº --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"chat-section"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"chat-header"</span>&gt;</span>
                    å¯¹è¯è®°å½•
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"messages-container"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"messagesContainer"</span>&gt;</span>
                    <span class="hljs-comment">&lt;!-- æ¶ˆæ¯ä¼šåŠ¨æ€æ·»åŠ åˆ°è¿™é‡Œ --&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            
            <span class="hljs-comment">&lt;!-- å³ä¾§ï¼šæ™ºèƒ½ä½“çŠ¶æ€åŒº --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status-section"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status-header"</span>&gt;</span>
                    æ™ºèƒ½ä½“çŠ¶æ€ä¸æ“ä½œ
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status-container"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"statusContainer"</span>&gt;</span>
                    <span class="hljs-comment">&lt;!-- çŠ¶æ€å¡ç‰‡å’Œæ“ä½œé¢„è§ˆä¼šåŠ¨æ€æ·»åŠ åˆ°è¿™é‡Œ --&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        
        <span class="hljs-comment">&lt;!-- æ”¯ä»˜é¡µé¢å®¹å™¨ï¼ˆåˆå§‹éšè—ï¼‰ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"paymentSection"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"payment-container"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"display: none;"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"payment-header"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>ğŸ’° æ”¯ä»˜é¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"hidePaymentSection()"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"background: #ef4444; color: white; padding: 8px 16px;"</span>&gt;</span>å…³é—­<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"paymentFrame"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"payment-frame"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">""</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"æ”¯ä»˜é¡µé¢"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        
        <span class="hljs-comment">&lt;!-- è¾“å…¥åŒº --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-section"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-container"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> 
                    <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> 
                    <span class="hljs-attr">id</span>=<span class="hljs-string">"userInput"</span> 
                    <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"å‘Šè¯‰æˆ‘ä½ æƒ³åƒä»€ä¹ˆï¼Ÿä¾‹å¦‚ï¼šå¸®æˆ‘ç‚¹ä¸€ä»½éº¦å½“åŠ³å·¨æ— éœ¸å¥—é¤ï¼Œé€åˆ°XXå¤§å¦ï¼Œå¸®æˆ‘åˆ°ä»˜æ¬¾ç•Œé¢"</span>
                    <span class="hljs-attr">autocomplete</span>=<span class="hljs-string">"off"</span>
                &gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"sendButton"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn-send"</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"sendMessage()"</span>&gt;</span>å‘é€<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"app.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h2 data-id="heading-7">å››ã€é…å¥—çš„Node.js ExpressæœåŠ¡å™¨ç¤ºä¾‹</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// server.js - ç®€åŒ–çš„æœåŠ¡å™¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);
<span class="hljs-keyword">const</span> cors = <span class="hljs-built_in">require</span>(<span class="hljs-string">'cors'</span>);
<span class="hljs-keyword">const</span> { <span class="hljs-attr">v4</span>: uuidv4 } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'uuid'</span>);

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();
app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">cors</span>());
app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">json</span>());
app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">static</span>(<span class="hljs-string">'public'</span>)); <span class="hljs-comment">// é™æ€æ–‡ä»¶æœåŠ¡</span>

<span class="hljs-comment">// å­˜å‚¨ä¼šè¯çŠ¶æ€ï¼ˆç”Ÿäº§ç¯å¢ƒä¸­åº”è¯¥ä½¿ç”¨Redisï¼‰</span>
<span class="hljs-keyword">const</span> sessions = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();

<span class="hljs-comment">// åˆ›å»ºæ–°ä¼šè¯</span>
app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/api/agent/session'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> sessionId = <span class="hljs-title function_">uuidv4</span>();
    sessions.<span class="hljs-title function_">set</span>(sessionId, {
        <span class="hljs-attr">created_at</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(),
        <span class="hljs-attr">messages</span>: [],
        <span class="hljs-attr">state</span>: {
            <span class="hljs-attr">step</span>: <span class="hljs-string">'initial'</span>,
            <span class="hljs-attr">selected_restaurant</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">cart_id</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">address_id</span>: <span class="hljs-literal">null</span>
        }
    });
    
    res.<span class="hljs-title function_">json</span>({ <span class="hljs-attr">session_id</span>: sessionId });
});

<span class="hljs-comment">// å¤„ç†ç”¨æˆ·æ¶ˆæ¯</span>
app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/api/agent/process'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> { session_id, message, context } = req.<span class="hljs-property">body</span>;
    
    <span class="hljs-keyword">if</span> (!sessions.<span class="hljs-title function_">has</span>(session_id)) {
        <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">404</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">error</span>: <span class="hljs-string">'ä¼šè¯ä¸å­˜åœ¨'</span> });
    }
    
    <span class="hljs-comment">// è¿™é‡Œåœ¨å®é™…åº”ç”¨ä¸­åº”è¯¥è§¦å‘æ™ºèƒ½ä½“å¤„ç†æµç¨‹</span>
    <span class="hljs-comment">// æˆ‘ä»¬åªæ˜¯æ¨¡æ‹Ÿä¸€ä¸ªå“åº”</span>
    res.<span class="hljs-title function_">json</span>({ 
        <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>, 
        <span class="hljs-attr">message_id</span>: <span class="hljs-title function_">uuidv4</span>() 
    });
});

<span class="hljs-comment">// SSEæµç«¯ç‚¹</span>
app.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/agent/stream'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> sessionId = req.<span class="hljs-property">query</span>.<span class="hljs-property">session_id</span>;
    
    <span class="hljs-keyword">if</span> (!sessionId) {
        <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">error</span>: <span class="hljs-string">'ç¼ºå°‘ä¼šè¯ID'</span> });
    }
    
    <span class="hljs-comment">// è®¾ç½®SSEå¤´</span>
    res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">200</span>, {
        <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'text/event-stream'</span>,
        <span class="hljs-string">'Cache-Control'</span>: <span class="hljs-string">'no-cache'</span>,
        <span class="hljs-string">'Connection'</span>: <span class="hljs-string">'keep-alive'</span>,
        <span class="hljs-string">'Access-Control-Allow-Origin'</span>: <span class="hljs-string">'*'</span>
    });
    
    <span class="hljs-comment">// å‘é€åˆå§‹çŠ¶æ€</span>
    res.<span class="hljs-title function_">write</span>(<span class="hljs-string">`event: status\ndata: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify({ status: <span class="hljs-string">'connected'</span> })}</span>\n\n`</span>);
    
    <span class="hljs-comment">// æ¨¡æ‹Ÿä¸€äº›äº‹ä»¶ï¼ˆå®é™…åº”ç”¨ä¸­è¿™äº›äº‹ä»¶æ¥è‡ªæ™ºèƒ½ä½“å¤„ç†æµç¨‹ï¼‰</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">sendSimulatedEvents</span> = (<span class="hljs-params"/>) =&gt; {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            res.<span class="hljs-title function_">write</span>(<span class="hljs-string">`event: status\ndata: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify({ 
                status: <span class="hljs-string">'thinking'</span>, 
                details: <span class="hljs-string">'æ­£åœ¨åˆ†ææ‚¨çš„éœ€æ±‚...'</span> 
            })}</span>\n\n`</span>);
        }, <span class="hljs-number">1000</span>);
        
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            res.<span class="hljs-title function_">write</span>(<span class="hljs-string">`event: status\ndata: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify({ 
                status: <span class="hljs-string">'querying_menu'</span>, 
                details: <span class="hljs-string">'æŸ¥è¯¢éº¦å½“åŠ³èœå•ä¸­...'</span> 
            })}</span>\n\n`</span>);
        }, <span class="hljs-number">2000</span>);
        
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            res.<span class="hljs-title function_">write</span>(<span class="hljs-string">`event: message\ndata: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify({ 
                content: <span class="hljs-string">'æ‰¾åˆ°"éº¦å½“åŠ³ï¼ˆå›½è´¸åº—ï¼‰"ï¼Œæœ‰å·¨æ— éœ¸å¥—é¤ï¼Œä»·æ ¼38å…ƒã€‚ç¡®è®¤åŠ å…¥è´­ç‰©è½¦å—ï¼Ÿ'</span> 
            })}</span>\n\n`</span>);
        }, <span class="hljs-number">3000</span>);
        
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            res.<span class="hljs-title function_">write</span>(<span class="hljs-string">`event: action_preview\ndata: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify({
                action_id: uuidv4(),
                action: <span class="hljs-string">'add_to_cart'</span>,
                params: {
                    restaurant: <span class="hljs-string">'éº¦å½“åŠ³ï¼ˆå›½è´¸åº—ï¼‰'</span>,
                    items: [
                        { name: <span class="hljs-string">'å·¨æ— éœ¸å¥—é¤'</span>, quantity: <span class="hljs-number">1</span>, price: <span class="hljs-number">38</span> }
                    ],
                    need_confirm: <span class="hljs-literal">true</span>
                }
            })}</span>\n\n`</span>);
        }, <span class="hljs-number">3500</span>);
    };
    
    <span class="hljs-comment">// å¼€å§‹å‘é€æ¨¡æ‹Ÿäº‹ä»¶</span>
    <span class="hljs-title function_">sendSimulatedEvents</span>();
    
    <span class="hljs-comment">// ä¿æŒè¿æ¥</span>
    req.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å®¢æˆ·ç«¯æ–­å¼€è¿æ¥: <span class="hljs-subst">${sessionId}</span>`</span>);
        res.<span class="hljs-title function_">end</span>();
    });
});

<span class="hljs-comment">// ç¡®è®¤æ“ä½œ</span>
app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/api/agent/confirm-action'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> { session_id, action_id, user_confirmation } = req.<span class="hljs-property">body</span>;
    
    <span class="hljs-comment">// åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œä¼šæ›´æ–°ä¼šè¯çŠ¶æ€å¹¶ç»§ç»­æ™ºèƒ½ä½“æµç¨‹</span>
    res.<span class="hljs-title function_">json</span>({ 
        <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">'æ“ä½œå·²ç¡®è®¤'</span>
    });
});

<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PORT</span> = process.<span class="hljs-property">env</span>.<span class="hljs-property">PORT</span> || <span class="hljs-number">3000</span>;
app.<span class="hljs-title function_">listen</span>(<span class="hljs-variable constant_">PORT</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:<span class="hljs-subst">${PORT}</span>`</span>);
});
<span class="hljs-string">``</span><span class="hljs-string">`
</span></code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ— Pythonä¾èµ–ï¼JavaCV+ONNX Runtimeå¿«é€Ÿéƒ¨ç½²YOLOç›®æ ‡æ£€æµ‹]]></title>    <link>https://juejin.cn/post/7599927813601247272</link>    <guid>https://juejin.cn/post/7599927813601247272</guid>    <pubDate>2026-01-28T02:42:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599927813601247272" data-draft-id="7599911091087474688" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" æ— Pythonä¾èµ–ï¼JavaCV+ONNX Runtimeå¿«é€Ÿéƒ¨ç½²YOLOç›®æ ‡æ£€æµ‹"/> <meta itemprop="keywords" content="åç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-28T02:42:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜å¨å“¥"/> <meta itemprop="url" content="https://juejin.cn/user/3411107130652176"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             æ— Pythonä¾èµ–ï¼JavaCV+ONNX Runtimeå¿«é€Ÿéƒ¨ç½²YOLOç›®æ ‡æ£€æµ‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3411107130652176/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜å¨å“¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:42:51.000Z" title="Wed Jan 28 2026 02:42:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½ å¸Œæœ›å®Œå…¨æ‘†è„±Pythonç”Ÿæ€ä¾èµ–ï¼ˆæ— éœ€å®‰è£…Pythonã€PyTorch/Ultralyticsã€ONNXè½¬æ¢å·¥å…·ç­‰ï¼‰ï¼Œä»…é€šè¿‡JavaCVï¼ˆçº¯Javaå°è£…çš„OpenCV/FFmpegï¼‰å’ŒONNX Runtime Javaç‰ˆï¼Œå®ç°YOLOç›®æ ‡æ£€æµ‹çš„ç«¯åˆ°ç«¯éƒ¨ç½²â€”â€”ä»å›¾ç‰‡/è§†é¢‘è¯»å–ã€é¢„å¤„ç†ï¼Œåˆ°ONNXæ¨¡å‹æ¨ç†ã€ç»“æœè§£æï¼Œå…¨ç¨‹åŸºäºçº¯Javaç¯å¢ƒå®Œæˆï¼Œè¿™ä¹Ÿæ˜¯ä¼ä¸šçº§ç”Ÿäº§ç¯å¢ƒä¸­â€œè½»é‡éƒ¨ç½²ã€æ— å¤šè¯­è¨€ä¾èµ–â€çš„æ ¸å¿ƒè¯‰æ±‚ã€‚</p>
<p>æœ¬æ–‡æä¾›<strong>é›¶Pythonä¾èµ–</strong>çš„å®Œæ•´å®ç°æ–¹æ¡ˆï¼Œæ‰€æœ‰ä»£ç åŸºäºJDK 11å¼€å‘ï¼Œä»…ä¾èµ–JavaCVå’ŒONNX Runtimeçš„JavaåŸç”Ÿåº“ï¼Œæ”¯æŒCPU/GPUåŠ é€Ÿï¼Œå¯ç›´æ¥æ‰“åŒ…ä¸ºJaråŒ…è¿è¡Œï¼Œé€‚é…Windows/Linux/ARM64ï¼ˆå¦‚Jetson Nanoï¼‰ç­‰å…¨å¹³å°ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€æ ¸å¿ƒæŠ€æœ¯é€‰å‹ï¼ˆæ— Pythonä¾èµ–ï¼‰</h2>

























<table><thead><tr><th>æŠ€æœ¯ç»„ä»¶</th><th>é€‰å‹ä¾æ®ï¼ˆé›¶Pythonæ ¸å¿ƒï¼‰</th></tr></thead><tbody><tr><td>JDK 11+</td><td>çº¯Javaè¿è¡Œç¯å¢ƒï¼Œæ— Pythonä¾èµ–ï¼Œå…¼å®¹æ‰€æœ‰ä¸»æµå¹³å°</td></tr><tr><td>JavaCV 1.5.10</td><td>çº¯Javaå°è£…OpenCV/FFmpegï¼Œæ— éœ€å®‰è£…ç³»ç»Ÿçº§OpenCVï¼Œç›´æ¥é€šè¿‡Mavenå¼•å…¥ï¼Œæ”¯æŒå›¾ç‰‡/è§†é¢‘/æ‘„åƒå¤´æµè¯»å–ã€é¢„å¤„ç†</td></tr><tr><td>ONNX Runtime Java 1.17.0</td><td>å®˜æ–¹Javaç‰ˆæ¨ç†å¼•æ“ï¼Œæ— Pythonç»‘å®šï¼Œç›´æ¥åŠ è½½ONNXæ¨¡å‹å®Œæˆæ¨ç†ï¼Œæ”¯æŒCPU/GPUåŠ é€Ÿ</td></tr><tr><td>YOLOv11n ONNXï¼ˆå®˜æ–¹é¢„ç¼–è¯‘ç‰ˆï¼‰</td><td>ç›´æ¥ä¸‹è½½å®˜æ–¹æä¾›çš„ONNXæ¨¡å‹ï¼Œæ— éœ€Pythonè½¬æ¢ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fultralytics%2Fassets%2Freleases" target="_blank" title="https://github.com/ultralytics/assets/releases" ref="nofollow noopener noreferrer">github.com/ultralyticsâ€¦</a>ï¼‰</td></tr></tbody></table>
<h2 data-id="heading-1">äºŒã€ç¯å¢ƒå‡†å¤‡ï¼ˆé›¶Pythonï¼Œä»…éœ€2æ­¥ï¼‰</h2>
<h3 data-id="heading-2">1. å®‰è£…åŸºç¡€ç¯å¢ƒ</h3>
<p>ä»…éœ€JDKå’ŒMavenï¼Œ<strong>æ— éœ€å®‰è£…Pythonã€CUDAï¼ˆå¯é€‰ï¼‰ã€OpenCV</strong>ï¼š</p>
<ul>
<li>
<p>JDK 11+ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.oracle.com%2Fcn%2Fjava%2Ftechnologies%2Fdownloads%2F%23java11" target="_blank" title="https://www.oracle.com/cn/java/technologies/downloads/#java11" ref="nofollow noopener noreferrer">www.oracle.com/cn/java/tecâ€¦</a></p>
</li>
<li>
<p>Maven 3.8+ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmaven.apache.org%2Fdownload.cgi" target="_blank" title="https://maven.apache.org/download.cgi" ref="nofollow noopener noreferrer">maven.apache.org/download.cgâ€¦</a></p>
</li>
</ul>
<p>éªŒè¯ç¯å¢ƒï¼ˆæ— Pythonç›¸å…³æ“ä½œï¼‰ï¼š</p>
<pre><code class="hljs language-Bash" lang="Bash">
java -version  <span class="hljs-comment"># è¾“å‡ºJDKç‰ˆæœ¬å³å¯</span>
mvn -v         <span class="hljs-comment"># è¾“å‡ºMavenç‰ˆæœ¬å³å¯</span>
</code></pre>
<h3 data-id="heading-3">2. ä¸‹è½½YOLO ONNXæ¨¡å‹ï¼ˆæ— Pythonè½¬æ¢ï¼‰</h3>
<p>ç›´æ¥ä¸‹è½½å®˜æ–¹é¢„ç¼–è¯‘çš„YOLOv11n ONNXæ¨¡å‹ï¼Œè·³è¿‡Pythonè½¬æ¢æ­¥éª¤ï¼š</p>
<ul>
<li>
<p>ä¸‹è½½åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fultralytics%2Fassets%2Freleases%2Fdownload%2Fv8.2.0%2Fyolov11n.onnx" target="_blank" title="https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov11n.onnx" ref="nofollow noopener noreferrer">github.com/ultralyticsâ€¦</a></p>
</li>
<li>
<p>ä¿å­˜è·¯å¾„ï¼š<code>src/main/resources/models/yolov11n.onnx</code></p>
</li>
</ul>
<h2 data-id="heading-4">ä¸‰ã€çº¯Javaå®ç°ï¼ˆé›¶Pythonä¾èµ–ï¼‰</h2>
<h3 data-id="heading-5">1. é¡¹ç›®ç»“æ„ï¼ˆæç®€ï¼‰</h3>
<pre><code class="hljs language-Plain" lang="Plain">
yolo-java-nopython/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”œâ”€â”€ java/
â”‚   â”‚   â”‚   â””â”€â”€ com/
â”‚   â”‚   â”‚       â””â”€â”€ yolo/
â”‚   â”‚   â”‚           â”œâ”€â”€ config/      # YOLOé…ç½®
â”‚   â”‚   â”‚           â”œâ”€â”€ inference/   # æ¨ç†æ ¸å¿ƒ
â”‚   â”‚   â”‚           â”œâ”€â”€ util/        # å›¾åƒå¤„ç†å·¥å…·ï¼ˆJavaCVï¼‰
â”‚   â”‚   â”‚           â””â”€â”€ YoloDetectorApp.java  # æµ‹è¯•ä¸»ç±»
â”‚   â”‚   â””â”€â”€ resources/
â”‚   â”‚       â””â”€â”€ models/
â”‚   â”‚           â””â”€â”€ yolov11n.onnx   # å®˜æ–¹ONNXæ¨¡å‹
â”‚   â””â”€â”€ test/
â””â”€â”€ pom.xml  # ä»…Javaä¾èµ–ï¼Œæ— Pythonç›¸å…³
</code></pre>
<h3 data-id="heading-6">2. æ ¸å¿ƒä¾èµ–ï¼ˆpom.xmlï¼‰</h3>
<p>ä»…å¼•å…¥JavaCVå’ŒONNX Runtimeçš„JavaåŸç”Ÿåº“ï¼Œ<strong>æ— ä»»ä½•Pythonä¾èµ–</strong>ï¼š</p>
<pre><code class="hljs language-XML" lang="XML">
<span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span>
         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.yolo<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>yolo-java-nopython<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.source</span>&gt;</span>11<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.source</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.target</span>&gt;</span>11<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.target</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">javacv.version</span>&gt;</span>1.5.10<span class="hljs-tag">&lt;/<span class="hljs-name">javacv.version</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">onnxruntime.version</span>&gt;</span>1.17.0<span class="hljs-tag">&lt;/<span class="hljs-name">onnxruntime.version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- JavaCVæ ¸å¿ƒï¼ˆçº¯Javaï¼Œè‡ªåŠ¨å¼•å…¥å¯¹åº”å¹³å°åŸç”Ÿåº“ï¼‰ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.bytedeco<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>javacv<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>${javacv.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- OpenCV Javaç»‘å®šï¼ˆJavaCVå°è£…ï¼Œæ— ç³»ç»Ÿä¾èµ–ï¼‰ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.bytedeco<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>opencv-platform<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.8.0-${javacv.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- FFmpeg Javaç»‘å®šï¼ˆè§†é¢‘/æ‘„åƒå¤´è¯»å–ï¼‰ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.bytedeco<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>ffmpeg-platform<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>6.1.1-${javacv.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- ONNX Runtime Javaç‰ˆï¼ˆæ— Pythonä¾èµ–ï¼‰ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.microsoft.onnxruntime<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>onnxruntime<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>${onnxruntime.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- å·¥å…·ç±»ï¼ˆå¯é€‰ï¼Œç®€åŒ–æ—¥å¿—/é…ç½®ï¼‰ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.18.30<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">optional</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">optional</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>slf4j-simple<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.9<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- æ‰“åŒ…ä¸ºå¯æ‰§è¡ŒJarï¼ˆåŒ…å«æ‰€æœ‰ä¾èµ–ï¼Œé›¶ç¯å¢ƒä¾èµ–è¿è¡Œï¼‰ --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>maven-assembly-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.6.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">archive</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">manifest</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">mainClass</span>&gt;</span>com.yolo.YoloDetectorApp<span class="hljs-tag">&lt;/<span class="hljs-name">mainClass</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">manifest</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">archive</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">descriptorRefs</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">descriptorRef</span>&gt;</span>jar-with-dependencies<span class="hljs-tag">&lt;/<span class="hljs-name">descriptorRef</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">descriptorRefs</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">executions</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">execution</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>make-assembly<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">phase</span>&gt;</span>package<span class="hljs-tag">&lt;/<span class="hljs-name">phase</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">goals</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">goal</span>&gt;</span>single<span class="hljs-tag">&lt;/<span class="hljs-name">goal</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">goals</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">execution</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">executions</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span>
</code></pre>
<h3 data-id="heading-7">3. æ ¸å¿ƒä»£ç å®ç°ï¼ˆå…¨Javaï¼Œæ— Pythonï¼‰</h3>
<h4 data-id="heading-8">ï¼ˆ1ï¼‰YOLOé…ç½®ç±»ï¼ˆç¡¬ç¼–ç /é…ç½®æ–‡ä»¶å‡å¯ï¼‰</h4>
<pre><code class="hljs language-Java" lang="Java">
<span class="hljs-keyword">package</span> com.yolo.config;

<span class="hljs-keyword">import</span> lombok.Getter;

<span class="hljs-comment">/**
 * YOLOé…ç½®ï¼ˆæ— Pythonä¾èµ–ï¼Œç›´æ¥ç¡¬ç¼–ç ï¼Œä¹Ÿå¯è¯»å–propertiesï¼‰
 */</span>
<span class="hljs-meta">@Getter</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">YoloConfig</span> {
    <span class="hljs-comment">// æ¨¡å‹è·¯å¾„ï¼ˆresourcesç›®å½•ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">MODEL_PATH</span> <span class="hljs-operator">=</span> <span class="hljs-string">"models/yolov11n.onnx"</span>;
    <span class="hljs-comment">// è¾“å…¥å°ºå¯¸ï¼ˆYOLOv11é»˜è®¤640Ã—640ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">INPUT_WIDTH</span> <span class="hljs-operator">=</span> <span class="hljs-number">640</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">INPUT_HEIGHT</span> <span class="hljs-operator">=</span> <span class="hljs-number">640</span>;
    <span class="hljs-comment">// ç½®ä¿¡åº¦é˜ˆå€¼ï¼ˆè¿‡æ»¤ä½ç½®ä¿¡åº¦ç»“æœï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">float</span> <span class="hljs-variable">CONF_THRESHOLD</span> <span class="hljs-operator">=</span> <span class="hljs-number">0.4f</span>;
    <span class="hljs-comment">// COCO80ç±»åˆ«ï¼ˆYOLOé»˜è®¤ï¼Œæ— Pythonä¾èµ–ï¼Œç›´æ¥å®šä¹‰ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String[] CLASSES = {
            <span class="hljs-string">"person"</span>, <span class="hljs-string">"bicycle"</span>, <span class="hljs-string">"car"</span>, <span class="hljs-string">"motorcycle"</span>, <span class="hljs-string">"airplane"</span>, <span class="hljs-string">"bus"</span>, <span class="hljs-string">"train"</span>, <span class="hljs-string">"truck"</span>, <span class="hljs-string">"boat"</span>,
            <span class="hljs-string">"traffic light"</span>, <span class="hljs-string">"fire hydrant"</span>, <span class="hljs-string">"stop sign"</span>, <span class="hljs-string">"parking meter"</span>, <span class="hljs-string">"bench"</span>, <span class="hljs-string">"bird"</span>, <span class="hljs-string">"cat"</span>,
            <span class="hljs-string">"dog"</span>, <span class="hljs-string">"horse"</span>, <span class="hljs-string">"sheep"</span>, <span class="hljs-string">"cow"</span>, <span class="hljs-string">"elephant"</span>, <span class="hljs-string">"bear"</span>, <span class="hljs-string">"zebra"</span>, <span class="hljs-string">"giraffe"</span>, <span class="hljs-string">"backpack"</span>,
            <span class="hljs-string">"umbrella"</span>, <span class="hljs-string">"handbag"</span>, <span class="hljs-string">"tie"</span>, <span class="hljs-string">"suitcase"</span>, <span class="hljs-string">"frisbee"</span>, <span class="hljs-string">"skis"</span>, <span class="hljs-string">"snowboard"</span>, <span class="hljs-string">"sports ball"</span>,
            <span class="hljs-string">"kite"</span>, <span class="hljs-string">"baseball bat"</span>, <span class="hljs-string">"baseball glove"</span>, <span class="hljs-string">"skateboard"</span>, <span class="hljs-string">"surfboard"</span>, <span class="hljs-string">"tennis racket"</span>,
            <span class="hljs-string">"bottle"</span>, <span class="hljs-string">"wine glass"</span>, <span class="hljs-string">"cup"</span>, <span class="hljs-string">"fork"</span>, <span class="hljs-string">"knife"</span>, <span class="hljs-string">"spoon"</span>, <span class="hljs-string">"bowl"</span>, <span class="hljs-string">"banana"</span>, <span class="hljs-string">"apple"</span>,
            <span class="hljs-string">"sandwich"</span>, <span class="hljs-string">"orange"</span>, <span class="hljs-string">"broccoli"</span>, <span class="hljs-string">"carrot"</span>, <span class="hljs-string">"hot dog"</span>, <span class="hljs-string">"pizza"</span>, <span class="hljs-string">"donut"</span>, <span class="hljs-string">"cake"</span>, <span class="hljs-string">"chair"</span>,
            <span class="hljs-string">"couch"</span>, <span class="hljs-string">"potted plant"</span>, <span class="hljs-string">"bed"</span>, <span class="hljs-string">"dining table"</span>, <span class="hljs-string">"toilet"</span>, <span class="hljs-string">"tv"</span>, <span class="hljs-string">"laptop"</span>, <span class="hljs-string">"mouse"</span>,
            <span class="hljs-string">"remote"</span>, <span class="hljs-string">"keyboard"</span>, <span class="hljs-string">"cell phone"</span>, <span class="hljs-string">"microwave"</span>, <span class="hljs-string">"oven"</span>, <span class="hljs-string">"toaster"</span>, <span class="hljs-string">"sink"</span>, <span class="hljs-string">"refrigerator"</span>,
            <span class="hljs-string">"book"</span>, <span class="hljs-string">"clock"</span>, <span class="hljs-string">"vase"</span>, <span class="hljs-string">"scissors"</span>, <span class="hljs-string">"teddy bear"</span>, <span class="hljs-string">"hair drier"</span>, <span class="hljs-string">"toothbrush"</span>
    };
}
</code></pre>
<h4 data-id="heading-9">ï¼ˆ2ï¼‰å›¾åƒå¤„ç†å·¥å…·ç±»ï¼ˆJavaCVå®ç°ï¼Œæ— Pythonï¼‰</h4>
<pre><code class="hljs language-Java" lang="Java">
<span class="hljs-keyword">package</span> com.yolo.util;

<span class="hljs-keyword">import</span> com.yolo.config.YoloConfig;
<span class="hljs-keyword">import</span> org.bytedeco.opencv.opencv_core.*;

<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.bytedeco.opencv.global.opencv_core.*;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.bytedeco.opencv.global.opencv_imgproc.*;

<span class="hljs-comment">/**
 * å›¾åƒå¤„ç†å·¥å…·ï¼ˆçº¯JavaCVå®ç°ï¼Œæ— Pythonä¾èµ–ï¼‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ImageProcessUtils</span> {

    <span class="hljs-comment">/**
     * å›¾ç‰‡é¢„å¤„ç†ï¼šLetterBoxå¡«å…… + BGRè½¬RGB + å½’ä¸€åŒ– + HWCâ†’CHW
     * <span class="hljs-doctag">@param</span> srcImg åŸå§‹å›¾ç‰‡ï¼ˆJavaCVçš„Matå¯¹è±¡ï¼‰
     * <span class="hljs-doctag">@return</span> æ¨¡å‹è¾“å…¥å¼ é‡ï¼ˆfloatæ•°ç»„ï¼‰
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">float</span>[] preprocess(Mat srcImg) {
        <span class="hljs-comment">// 1. LetterBoxå¡«å……ï¼ˆä¿æŒå®½é«˜æ¯”ï¼Œé¿å…å˜å½¢ï¼‰</span>
        <span class="hljs-type">Mat</span> <span class="hljs-variable">letterBoxImg</span> <span class="hljs-operator">=</span> letterBox(srcImg, YoloConfig.INPUT_WIDTH, YoloConfig.INPUT_HEIGHT);
        <span class="hljs-comment">// 2. BGRè½¬RGBï¼ˆJavaCV/OpenCVé»˜è®¤BGRï¼ŒYOLOè¾“å…¥RGBï¼‰</span>
        <span class="hljs-type">Mat</span> <span class="hljs-variable">rgbImg</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Mat</span>();
        cvtColor(letterBoxImg, rgbImg, COLOR_BGR2RGB);
        <span class="hljs-comment">// 3. å½’ä¸€åŒ–ï¼ˆ0-255 â†’ 0-1ï¼‰</span>
        rgbImg.convertTo(rgbImg, CV_32F, <span class="hljs-number">1.0</span> / <span class="hljs-number">255.0</span>);
        <span class="hljs-comment">// 4. HWCï¼ˆé«˜åº¦Ã—å®½åº¦Ã—é€šé“ï¼‰â†’ CHWï¼ˆé€šé“Ã—é«˜åº¦Ã—å®½åº¦ï¼‰ï¼ˆYOLOè¾“å…¥æ ¼å¼ï¼‰</span>
        <span class="hljs-type">float</span>[] inputData = hwc2chw(rgbImg);

        <span class="hljs-comment">// é‡Šæ”¾å†…å­˜ï¼ˆé¿å…æ³„æ¼ï¼‰</span>
        letterBoxImg.release();
        rgbImg.release();
        <span class="hljs-keyword">return</span> inputData;
    }

    <span class="hljs-comment">/**
     * LetterBoxå¡«å……ï¼ˆä¿æŒå®½é«˜æ¯”ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Mat <span class="hljs-title function_">letterBox</span><span class="hljs-params">(Mat srcImg, <span class="hljs-type">int</span> targetW, <span class="hljs-type">int</span> targetH)</span> {
        <span class="hljs-type">double</span> <span class="hljs-variable">scale</span> <span class="hljs-operator">=</span> Math.min((<span class="hljs-type">double</span>) targetW / srcImg.cols(), (<span class="hljs-type">double</span>) targetH / srcImg.rows());
        <span class="hljs-type">int</span> <span class="hljs-variable">newW</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) (srcImg.cols() * scale);
        <span class="hljs-type">int</span> <span class="hljs-variable">newH</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) (srcImg.rows() * scale);

        <span class="hljs-comment">// ç¼©æ”¾å›¾ç‰‡</span>
        <span class="hljs-type">Mat</span> <span class="hljs-variable">resized</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Mat</span>();
        resize(srcImg, resized, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Size</span>(newW, newH), <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, INTER_LINEAR);

        <span class="hljs-comment">// è®¡ç®—å¡«å……å€¼</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">padTop</span> <span class="hljs-operator">=</span> (targetH - newH) / <span class="hljs-number">2</span>;
        <span class="hljs-type">int</span> <span class="hljs-variable">padBottom</span> <span class="hljs-operator">=</span> targetH - newH - padTop;
        <span class="hljs-type">int</span> <span class="hljs-variable">padLeft</span> <span class="hljs-operator">=</span> (targetW - newW) / <span class="hljs-number">2</span>;
        <span class="hljs-type">int</span> <span class="hljs-variable">padRight</span> <span class="hljs-operator">=</span> targetW - newW - padLeft;

        <span class="hljs-comment">// å¡«å……é»‘è¾¹</span>
        <span class="hljs-type">Mat</span> <span class="hljs-variable">letterBoxImg</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Mat</span>();
        copyMakeBorder(resized, letterBoxImg, padTop, padBottom, padLeft, padRight, BORDER_CONSTANT, Scalar.ZERO);
        resized.release();
        <span class="hljs-keyword">return</span> letterBoxImg;
    }

    <span class="hljs-comment">/**
     * HWCâ†’CHWæ ¼å¼è½¬æ¢
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">float</span>[] hwc2chw(Mat rgbImg) {
        <span class="hljs-type">int</span> <span class="hljs-variable">channels</span> <span class="hljs-operator">=</span> rgbImg.channels();
        <span class="hljs-type">int</span> <span class="hljs-variable">height</span> <span class="hljs-operator">=</span> rgbImg.rows();
        <span class="hljs-type">int</span> <span class="hljs-variable">width</span> <span class="hljs-operator">=</span> rgbImg.cols();

        <span class="hljs-type">float</span>[] chwData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">float</span>[channels * height * width];
        <span class="hljs-type">float</span>[] hwcData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">float</span>[height * width * channels];
        rgbImg.get(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, hwcData);

        <span class="hljs-comment">// è½¬æ¢ï¼šHWC â†’ CHW</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; c &lt; channels; c++) {
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; h &lt; height; h++) {
                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">w</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; w &lt; width; w++) {
                    <span class="hljs-type">int</span> <span class="hljs-variable">hwcIdx</span> <span class="hljs-operator">=</span> h * width * channels + w * channels + c;
                    <span class="hljs-type">int</span> <span class="hljs-variable">chwIdx</span> <span class="hljs-operator">=</span> c * height * width + h * width + w;
                    chwData[chwIdx] = hwcData[hwcIdx];
                }
            }
        }
        <span class="hljs-keyword">return</span> chwData;
    }

    <span class="hljs-comment">/**
     * æ¨ç†ç»“æœåå¤„ç†ï¼šè§£æONNXè¾“å‡ºï¼Œè¿˜åŸåæ ‡åˆ°åŸå§‹å›¾ç‰‡
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Mat <span class="hljs-title function_">postprocess</span><span class="hljs-params">(Mat srcImg, <span class="hljs-type">float</span>[][] output)</span> {
        <span class="hljs-type">int</span> <span class="hljs-variable">srcW</span> <span class="hljs-operator">=</span> srcImg.cols();
        <span class="hljs-type">int</span> <span class="hljs-variable">srcH</span> <span class="hljs-operator">=</span> srcImg.rows();
        <span class="hljs-type">double</span> <span class="hljs-variable">scale</span> <span class="hljs-operator">=</span> Math.min((<span class="hljs-type">double</span>) YoloConfig.INPUT_WIDTH / srcW, (<span class="hljs-type">double</span>) YoloConfig.INPUT_HEIGHT / srcH);
        <span class="hljs-type">float</span> <span class="hljs-variable">padW</span> <span class="hljs-operator">=</span> (<span class="hljs-type">float</span>) ((YoloConfig.INPUT_WIDTH - srcW * scale) / <span class="hljs-number">2</span>);
        <span class="hljs-type">float</span> <span class="hljs-variable">padH</span> <span class="hljs-operator">=</span> (<span class="hljs-type">float</span>) ((YoloConfig.INPUT_HEIGHT - srcH * scale) / <span class="hljs-number">2</span>);

        <span class="hljs-comment">// éå†æ‰€æœ‰é¢„æµ‹æ¡†ï¼ˆ8400ä¸ªï¼‰</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8400</span>; i++) {
            <span class="hljs-type">float</span>[] box = output[i];
            <span class="hljs-comment">// æ‰¾åˆ°æœ€å¤§ç½®ä¿¡åº¦çš„ç±»åˆ«</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">maxClassIdx</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
            <span class="hljs-type">float</span> <span class="hljs-variable">maxConf</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">4</span>; j &lt; box.length; j++) {
                <span class="hljs-keyword">if</span> (box[j] &gt; maxConf) {
                    maxConf = box[j];
                    maxClassIdx = j - <span class="hljs-number">4</span>;
                }
            }

            <span class="hljs-comment">// ç½®ä¿¡åº¦è¿‡æ»¤</span>
            <span class="hljs-keyword">if</span> (maxConf &lt; YoloConfig.CONF_THRESHOLD) <span class="hljs-keyword">continue</span>;

            <span class="hljs-comment">// è¿˜åŸåæ ‡åˆ°åŸå§‹å›¾ç‰‡</span>
            <span class="hljs-type">float</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> (box[<span class="hljs-number">0</span>] - padW) / scale;
            <span class="hljs-type">float</span> <span class="hljs-variable">y</span> <span class="hljs-operator">=</span> (box[<span class="hljs-number">1</span>] - padH) / scale;
            <span class="hljs-type">float</span> <span class="hljs-variable">w</span> <span class="hljs-operator">=</span> box[<span class="hljs-number">2</span>] / scale;
            <span class="hljs-type">float</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> box[<span class="hljs-number">3</span>] / scale;

            <span class="hljs-comment">// è®¡ç®—æ£€æµ‹æ¡†å·¦ä¸Šè§’/å³ä¸‹è§’åæ ‡</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">left</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) Math.max(<span class="hljs-number">0</span>, x - w / <span class="hljs-number">2</span>);
            <span class="hljs-type">int</span> <span class="hljs-variable">top</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) Math.max(<span class="hljs-number">0</span>, y - h / <span class="hljs-number">2</span>);
            <span class="hljs-type">int</span> <span class="hljs-variable">right</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) Math.min(srcW, x + w / <span class="hljs-number">2</span>);
            <span class="hljs-type">int</span> <span class="hljs-variable">bottom</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) Math.min(srcH, y + h / <span class="hljs-number">2</span>);

            <span class="hljs-comment">// ç»˜åˆ¶æ£€æµ‹æ¡†å’Œæ ‡ç­¾ï¼ˆJavaCV/OpenCVå®ç°ï¼‰</span>
            rectangle(srcImg, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Point</span>(left, top), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Point</span>(right, bottom), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scalar</span>(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>), <span class="hljs-number">2</span>);
            <span class="hljs-type">String</span> <span class="hljs-variable">label</span> <span class="hljs-operator">=</span> YoloConfig.CLASSES[maxClassIdx] + <span class="hljs-string">" "</span> + String.format(<span class="hljs-string">"%.2f"</span>, maxConf);
            putText(srcImg, label, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Point</span>(left, top - <span class="hljs-number">5</span>), FONT_HERSHEY_SIMPLEX, <span class="hljs-number">0.5</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scalar</span>(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>), <span class="hljs-number">1</span>);
        }
        <span class="hljs-keyword">return</span> srcImg;
    }
}
</code></pre>
<h4 data-id="heading-10">ï¼ˆ3ï¼‰YOLOæ¨ç†æ ¸å¿ƒï¼ˆONNX Runtime Javaç‰ˆï¼‰</h4>
<pre><code class="hljs language-Java" lang="Java">
<span class="hljs-keyword">package</span> com.yolo.inference;

<span class="hljs-keyword">import</span> ai.onnxruntime.*;
<span class="hljs-keyword">import</span> com.yolo.config.YoloConfig;
<span class="hljs-keyword">import</span> com.yolo.util.ImageProcessUtils;
<span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;
<span class="hljs-keyword">import</span> org.bytedeco.opencv.opencv_core.Mat;

<span class="hljs-keyword">import</span> java.io.File;
<span class="hljs-keyword">import</span> java.nio.file.Paths;
<span class="hljs-keyword">import</span> java.util.HashMap;
<span class="hljs-keyword">import</span> java.util.Map;
<span class="hljs-keyword">import</span> java.util.concurrent.locks.ReentrantLock;

<span class="hljs-comment">/**
 * YOLOæ¨ç†æ ¸å¿ƒï¼ˆçº¯Javaï¼Œæ— Pythonä¾èµ–ï¼‰
 */</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">YoloInferenceEngine</span> {
    <span class="hljs-comment">// ONNX Runtimeæ ¸å¿ƒå¯¹è±¡</span>
    <span class="hljs-keyword">private</span> OrtEnvironment env;
    <span class="hljs-keyword">private</span> OrtSession session;
    <span class="hljs-comment">// å¹¶å‘é”ï¼ˆä¿è¯çº¿ç¨‹å®‰å…¨ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    <span class="hljs-comment">// æ¨¡å‹è¾“å…¥åç§°ï¼ˆYOLOv11é»˜è®¤"images"ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">INPUT_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">"images"</span>;

    <span class="hljs-comment">/**
     * åˆå§‹åŒ–ONNXæ¨¡å‹ï¼ˆæ— Pythonä¾èµ–ï¼‰
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initModel</span><span class="hljs-params">()</span> {
        lock.lock();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// è·å–æ¨¡å‹ç»å¯¹è·¯å¾„ï¼ˆå…¼å®¹JaråŒ…å†…/å¤–è·¯å¾„ï¼‰</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">modelPath</span> <span class="hljs-operator">=</span> Paths.get(
                    <span class="hljs-built_in">this</span>.getClass().getClassLoader().getResource(YoloConfig.MODEL_PATH).toURI()
            ).toString();
            log.info(<span class="hljs-string">"åŠ è½½YOLO ONNXæ¨¡å‹ï¼š{}"</span>, modelPath);

            <span class="hljs-comment">// åˆå§‹åŒ–ONNXç¯å¢ƒ</span>
            env = OrtEnvironment.getEnvironment();
            OrtSession.<span class="hljs-type">SessionOptions</span> <span class="hljs-variable">sessionOptions</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrtSession</span>.SessionOptions();
            <span class="hljs-comment">// ä¼˜åŒ–é…ç½®ï¼šå¯ç”¨æ‰€æœ‰ä¼˜åŒ–ï¼Œè®¾ç½®æ¨ç†çº¿ç¨‹æ•°ï¼ˆæ ¹æ®CPUæ ¸å¿ƒè°ƒæ•´ï¼‰</span>
            sessionOptions.setOptimizationLevel(OrtSession.SessionOptions.OptLevel.ALL);
            sessionOptions.setIntraOpNumThreads(Runtime.getRuntime().availableProcessors() / <span class="hljs-number">2</span>);

            <span class="hljs-comment">// åŠ è½½æ¨¡å‹ï¼ˆçº¯Javaï¼Œæ— Pythonï¼‰</span>
            session = env.createSession(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(modelPath).getAbsolutePath(), sessionOptions);
            log.info(<span class="hljs-string">"YOLOæ¨¡å‹åŠ è½½æˆåŠŸï¼"</span>);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"æ¨¡å‹åŠ è½½å¤±è´¥"</span>, e);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"YOLOæ¨¡å‹åˆå§‹åŒ–å¤±è´¥"</span>, e);
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }

    <span class="hljs-comment">/**
     * å•å›¾ç‰‡æ¨ç†ï¼ˆçº¯Javaï¼Œè¿”å›ç»˜åˆ¶æ£€æµ‹æ¡†åçš„å›¾ç‰‡ï¼‰
     */</span>
    <span class="hljs-keyword">public</span> Mat <span class="hljs-title function_">inferImage</span><span class="hljs-params">(Mat srcImg)</span> {
        lock.lock();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// 1. é¢„å¤„ç†ï¼ˆJavaCVå®ç°ï¼‰</span>
            <span class="hljs-type">long</span> <span class="hljs-variable">preStart</span> <span class="hljs-operator">=</span> System.currentTimeMillis();
            <span class="hljs-type">float</span>[] inputData = ImageProcessUtils.preprocess(srcImg);
            log.debug(<span class="hljs-string">"é¢„å¤„ç†è€—æ—¶ï¼š{}ms"</span>, System.currentTimeMillis() - preStart);

            <span class="hljs-comment">// 2. æ„é€ ONNXè¾“å…¥å¼ é‡</span>
            <span class="hljs-type">long</span>[] inputShape = <span class="hljs-keyword">new</span> <span class="hljs-title class_">long</span>[]{<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, YoloConfig.INPUT_HEIGHT, YoloConfig.INPUT_WIDTH};
            OrtSession.<span class="hljs-type">InputTensor</span> <span class="hljs-variable">inputTensor</span> <span class="hljs-operator">=</span> OrtSession.InputTensor.createTensor(env, inputData, inputShape);
            Map&lt;String, OrtSession.InputTensor&gt; inputs = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
            inputs.put(INPUT_NAME, inputTensor);

            <span class="hljs-comment">// 3. æ¨¡å‹æ¨ç†ï¼ˆONNX Runtime Javaï¼‰</span>
            <span class="hljs-type">long</span> <span class="hljs-variable">inferStart</span> <span class="hljs-operator">=</span> System.currentTimeMillis();
            OrtSession.<span class="hljs-type">Result</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> session.run(inputs);
            log.debug(<span class="hljs-string">"æ¨ç†è€—æ—¶ï¼š{}ms"</span>, System.currentTimeMillis() - inferStart);

            <span class="hljs-comment">// 4. è§£æè¾“å‡ºï¼ˆYOLOv11è¾“å‡ºæ ¼å¼ï¼š[1,84,8400] â†’ è½¬æ¢ä¸º[8400,84]ï¼‰</span>
            <span class="hljs-type">float</span>[][] output = parseOutput(result);

            <span class="hljs-comment">// 5. åå¤„ç†ï¼šç»˜åˆ¶æ£€æµ‹æ¡†ï¼ˆJavaCV/OpenCVï¼‰</span>
            <span class="hljs-type">Mat</span> <span class="hljs-variable">resultImg</span> <span class="hljs-operator">=</span> ImageProcessUtils.postprocess(srcImg, output);

            <span class="hljs-comment">// é‡Šæ”¾èµ„æº</span>
            inputTensor.close();
            result.close();
            <span class="hljs-keyword">return</span> resultImg;
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"å›¾ç‰‡æ¨ç†å¤±è´¥"</span>, e);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"æ¨ç†å¤±è´¥"</span>, e);
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }

    <span class="hljs-comment">/**
     * è§£æONNXè¾“å‡ºå¼ é‡
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span>[][] parseOutput(OrtSession.Result result) <span class="hljs-keyword">throws</span> OrtException {
        <span class="hljs-comment">// YOLOv11è¾“å‡ºï¼šç»´åº¦ä¸º[1,84,8400]çš„floatæ•°ç»„</span>
        <span class="hljs-type">float</span>[][] rawOutput = (<span class="hljs-type">float</span>[][]) result.get(<span class="hljs-number">0</span>).getValue();
        <span class="hljs-comment">// è½¬æ¢ä¸º[8400,84]æ ¼å¼ï¼ˆä¾¿äºéå†ï¼‰</span>
        <span class="hljs-type">float</span>[][] output = <span class="hljs-keyword">new</span> <span class="hljs-title class_">float</span>[<span class="hljs-number">8400</span>][<span class="hljs-number">84</span>];
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8400</span>; i++) {
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">84</span>; j++) {
                output[i][j] = rawOutput[j][i];
            }
        }
        <span class="hljs-keyword">return</span> output;
    }

    <span class="hljs-comment">/**
     * é‡Šæ”¾èµ„æº
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">destroy</span><span class="hljs-params">()</span> {
        lock.lock();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">if</span> (session != <span class="hljs-literal">null</span>) {
                session.close();
            }
            log.info(<span class="hljs-string">"YOLOæ¨¡å‹èµ„æºå·²é‡Šæ”¾"</span>);
        } <span class="hljs-keyword">catch</span> (OrtException e) {
            log.error(<span class="hljs-string">"èµ„æºé‡Šæ”¾å¤±è´¥"</span>, e);
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }
}
</code></pre>
<h4 data-id="heading-11">ï¼ˆ4ï¼‰æµ‹è¯•ä¸»ç±»ï¼ˆå›¾ç‰‡/è§†é¢‘/æ‘„åƒå¤´æ£€æµ‹ï¼Œæ— Pythonï¼‰</h4>
<pre><code class="hljs language-Java" lang="Java">
<span class="hljs-keyword">package</span> com.yolo;

<span class="hljs-keyword">import</span> com.yolo.inference.YoloInferenceEngine;
<span class="hljs-keyword">import</span> org.bytedeco.javacv.*;
<span class="hljs-keyword">import</span> org.bytedeco.opencv.opencv_core.Mat;

<span class="hljs-keyword">import</span> java.io.File;

<span class="hljs-comment">/**
 * æµ‹è¯•ä¸»ç±»ï¼ˆçº¯Javaï¼Œæ— Pythonä¾èµ–ï¼Œç›´æ¥è¿è¡Œï¼‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">YoloDetectorApp</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">YoloInferenceEngine</span> <span class="hljs-variable">inferenceEngine</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">YoloInferenceEngine</span>();

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// 1. åˆå§‹åŒ–æ¨¡å‹ï¼ˆæ— Pythonï¼‰</span>
        inferenceEngine.initModel();

        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// ========== æµ‹è¯•1ï¼šå•å›¾ç‰‡æ£€æµ‹ ==========</span>
            detectImage(<span class="hljs-string">"test.jpg"</span>, <span class="hljs-string">"result.jpg"</span>);

            <span class="hljs-comment">// ========== æµ‹è¯•2ï¼šè§†é¢‘æ£€æµ‹ï¼ˆå¯é€‰ï¼‰ ==========</span>
            <span class="hljs-comment">// detectVideo("test.mp4", "result.mp4");</span>

            <span class="hljs-comment">// ========== æµ‹è¯•3ï¼šæ‘„åƒå¤´å®æ—¶æ£€æµ‹ï¼ˆå¯é€‰ï¼‰ ==========</span>
            <span class="hljs-comment">// detectCamera();</span>
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-comment">// é‡Šæ”¾èµ„æº</span>
            inferenceEngine.destroy();
        }
    }

    <span class="hljs-comment">/**
     * å•å›¾ç‰‡æ£€æµ‹ï¼ˆçº¯JavaCVå®ç°ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">detectImage</span><span class="hljs-params">(String inputPath, String outputPath)</span> {
        <span class="hljs-comment">// è¯»å–å›¾ç‰‡ï¼ˆJavaCVï¼Œæ— Pythonï¼‰</span>
        OpenCVFrameConverter.<span class="hljs-type">ToMat</span> <span class="hljs-variable">converter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OpenCVFrameConverter</span>.ToMat();
        <span class="hljs-type">Mat</span> <span class="hljs-variable">srcImg</span> <span class="hljs-operator">=</span> imread(inputPath);
        <span class="hljs-keyword">if</span> (srcImg.empty()) {
            System.err.println(<span class="hljs-string">"å›¾ç‰‡è¯»å–å¤±è´¥ï¼š"</span> + inputPath);
            <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-comment">// æ¨ç†</span>
        <span class="hljs-type">Mat</span> <span class="hljs-variable">resultImg</span> <span class="hljs-operator">=</span> inferenceEngine.inferImage(srcImg);

        <span class="hljs-comment">// ä¿å­˜ç»“æœå›¾ç‰‡ï¼ˆJavaCVï¼‰</span>
        imwrite(outputPath, resultImg);
        System.out.println(<span class="hljs-string">"å›¾ç‰‡æ£€æµ‹å®Œæˆï¼Œç»“æœä¿å­˜è‡³ï¼š"</span> + <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(outputPath).getAbsolutePath());

        <span class="hljs-comment">// é‡Šæ”¾èµ„æº</span>
        srcImg.release();
        resultImg.release();
    }

    <span class="hljs-comment">/**
     * è§†é¢‘æ£€æµ‹ï¼ˆçº¯JavaCVå®ç°ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">detectVideo</span><span class="hljs-params">(String inputPath, String outputPath)</span> {
        <span class="hljs-type">FFmpegFrameGrabber</span> <span class="hljs-variable">grabber</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FFmpegFrameGrabber</span>(inputPath);
        <span class="hljs-type">FFmpegFrameRecorder</span> <span class="hljs-variable">recorder</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FFmpegFrameRecorder</span>(outputPath, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
        OpenCVFrameConverter.<span class="hljs-type">ToMat</span> <span class="hljs-variable">converter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OpenCVFrameConverter</span>.ToMat();

        <span class="hljs-keyword">try</span> {
            grabber.start();
            <span class="hljs-comment">// é…ç½®å½•åˆ¶å™¨</span>
            recorder.setVideoCodec(grabber.getVideoCodec());
            recorder.setFormat(grabber.getFormat());
            recorder.setFrameRate(grabber.getFrameRate());
            recorder.setImageWidth(grabber.getImageWidth());
            recorder.setImageHeight(grabber.getImageHeight());
            recorder.start();

            Frame frame;
            <span class="hljs-keyword">while</span> ((frame = grabber.grabImage()) != <span class="hljs-literal">null</span>) {
                <span class="hljs-type">Mat</span> <span class="hljs-variable">srcImg</span> <span class="hljs-operator">=</span> converter.convert(frame);
                <span class="hljs-type">Mat</span> <span class="hljs-variable">resultImg</span> <span class="hljs-operator">=</span> inferenceEngine.inferImage(srcImg);
                recorder.record(converter.convert(resultImg));
                srcImg.release();
                resultImg.release();
            }

            recorder.stop();
            grabber.stop();
            System.out.println(<span class="hljs-string">"è§†é¢‘æ£€æµ‹å®Œæˆï¼Œç»“æœä¿å­˜è‡³ï¼š"</span> + outputPath);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        }
    }

    <span class="hljs-comment">/**
     * æ‘„åƒå¤´å®æ—¶æ£€æµ‹ï¼ˆçº¯JavaCVå®ç°ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">detectCamera</span><span class="hljs-params">()</span> {
        <span class="hljs-type">OpenCVFrameGrabber</span> <span class="hljs-variable">grabber</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OpenCVFrameGrabber</span>(<span class="hljs-number">0</span>); <span class="hljs-comment">// 0=é»˜è®¤æ‘„åƒå¤´</span>
        <span class="hljs-type">CanvasFrame</span> <span class="hljs-variable">canvas</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CanvasFrame</span>(<span class="hljs-string">"YOLOå®æ—¶æ£€æµ‹ï¼ˆæ— Pythonï¼‰"</span>, CanvasFrame.getDefaultGamma() / grabber.getGamma());
        OpenCVFrameConverter.<span class="hljs-type">ToMat</span> <span class="hljs-variable">converter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OpenCVFrameConverter</span>.ToMat();

        <span class="hljs-keyword">try</span> {
            grabber.start();
            canvas.setCanvasSize(grabber.getImageWidth(), grabber.getImageHeight());

            Frame frame;
            <span class="hljs-keyword">while</span> ((frame = grabber.grabImage()) != <span class="hljs-literal">null</span> &amp;&amp; canvas.isVisible()) {
                <span class="hljs-type">Mat</span> <span class="hljs-variable">srcImg</span> <span class="hljs-operator">=</span> converter.convert(frame);
                <span class="hljs-type">Mat</span> <span class="hljs-variable">resultImg</span> <span class="hljs-operator">=</span> inferenceEngine.inferImage(srcImg);
                canvas.showImage(converter.convert(resultImg));
                srcImg.release();
                resultImg.release();
            }

            canvas.dispose();
            grabber.stop();
        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        }
    }

    <span class="hljs-comment">// ç®€åŒ–çš„imread/imwriteï¼ˆJavaCVå°è£…ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Mat <span class="hljs-title function_">imread</span><span class="hljs-params">(String path)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OpenCVFrameConverter</span>.ToMat().convert(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OpenCVFrameGrabber</span>(path).start().grabImage());
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">imwrite</span><span class="hljs-params">(String path, Mat mat)</span> {
        <span class="hljs-keyword">try</span> (<span class="hljs-type">FFmpegFrameRecorder</span> <span class="hljs-variable">recorder</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FFmpegFrameRecorder</span>(path, mat.cols(), mat.rows())) {
            recorder.setVideoCodec(avcodec.AV_CODEC_ID_PNG);
            recorder.start();
            recorder.record(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OpenCVFrameConverter</span>.ToMat().convert(mat));
            recorder.stop();
        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        }
    }
}
</code></pre>
<h2 data-id="heading-12">å››ã€éƒ¨ç½²ä¸æµ‹è¯•ï¼ˆé›¶Pythonï¼Œç›´æ¥è¿è¡Œï¼‰</h2>
<h3 data-id="heading-13">1. æ‰“åŒ…å¯æ‰§è¡ŒJarï¼ˆåŒ…å«æ‰€æœ‰ä¾èµ–ï¼‰</h3>
<pre><code class="hljs language-Bash" lang="Bash">
<span class="hljs-comment"># è¿›å…¥é¡¹ç›®ç›®å½•</span>
<span class="hljs-built_in">cd</span> yolo-java-nopython
<span class="hljs-comment"># æ‰“åŒ…ï¼ˆMavenè‡ªåŠ¨ä¸‹è½½æ‰€æœ‰Javaä¾èµ–ï¼Œæ— Pythonï¼‰</span>
mvn clean package
</code></pre>
<p>æ‰“åŒ…å®Œæˆåï¼Œåœ¨<code>target</code>ç›®å½•ç”Ÿæˆï¼š<code>yolo-java-nopython-1.0-SNAPSHOT-jar-with-dependencies.jar</code>ï¼ˆçº¦150MBï¼ŒåŒ…å«æ‰€æœ‰JavaCV/ONNX RuntimeåŸç”Ÿåº“ï¼‰ã€‚</p>
<h3 data-id="heading-14">2. è¿è¡Œæµ‹è¯•ï¼ˆæ— Pythonï¼Œä»…éœ€JREï¼‰</h3>
<h4 data-id="heading-15">ï¼ˆ1ï¼‰å•å›¾ç‰‡æ£€æµ‹</h4>
<pre><code class="hljs language-Bash" lang="Bash">
<span class="hljs-comment"># å‡†å¤‡æµ‹è¯•å›¾ç‰‡test.jpgï¼Œæ”¾åœ¨JaråŒç›®å½•</span>
java -jar yolo-java-nopython-1.0-SNAPSHOT-jar-with-dependencies.jar
</code></pre>
<p>è¿è¡Œå®Œæˆåï¼Œç”Ÿæˆ<code>result.jpg</code>ï¼ˆå¸¦æ£€æµ‹æ¡†çš„ç»“æœå›¾ç‰‡ï¼‰ã€‚</p>
<h4 data-id="heading-16">ï¼ˆ2ï¼‰è§†é¢‘/æ‘„åƒå¤´æ£€æµ‹</h4>
<p>ä¿®æ”¹<code>YoloDetectorApp.java</code>ä¸­çš„æµ‹è¯•å…¥å£ï¼ˆæ³¨é‡Š/å–æ¶ˆæ³¨é‡Š<code>detectVideo</code>/<code>detectCamera</code>ï¼‰ï¼Œé‡æ–°æ‰“åŒ…åè¿è¡Œå³å¯ã€‚</p>
<h3 data-id="heading-17">3. è·¨å¹³å°è¿è¡Œï¼ˆæ— Pythonï¼Œæ— éœ€é€‚é…ï¼‰</h3>
<ul>
<li>
<p><strong>Windows</strong>ï¼šç›´æ¥åŒå‡»JaråŒ…ï¼Œæˆ–é€šè¿‡<code>java -jar</code>è¿è¡Œï¼›</p>
</li>
<li>
<p><strong>Linux/ARM64ï¼ˆJetson Nanoï¼‰</strong>ï¼šåŒæ ·æ‰§è¡Œ<code>java -jar</code>ï¼ŒJavaCVä¼šè‡ªåŠ¨åŠ è½½å¯¹åº”å¹³å°çš„åŸç”Ÿåº“ï¼›</p>
</li>
<li>
<p><strong>GPUåŠ é€Ÿï¼ˆå¯é€‰ï¼‰</strong>ï¼šæ›¿æ¢ONNX Runtimeä¸ºGPUç‰ˆï¼ˆ<code>onnxruntime-gpu</code>ï¼‰ï¼Œä»…éœ€ä¿®æ”¹pom.xmlä¾èµ–ï¼Œæ— Pythoné…ç½®ã€‚</p>
</li>
</ul>
<h2 data-id="heading-18">äº”ã€æ ¸å¿ƒä¼˜åŒ–ï¼ˆæ— Pythonä¾èµ–å‰æä¸‹ï¼‰</h2>
<ol>
<li>
<p><strong>å†…å­˜ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>
<p>åŠæ—¶è°ƒç”¨<code>Mat.release()</code>é‡Šæ”¾å›¾ç‰‡å†…å­˜ï¼Œé¿å…æ³„æ¼ï¼›</p>
</li>
<li>
<p>ONNX Runtimeè®¾ç½®<code>setMemoryPatternOptimization(true)</code>ï¼Œå¤ç”¨å†…å­˜æ± ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>
<p>æ ¹æ®CPUæ ¸å¿ƒæ•°è°ƒæ•´æ¨ç†çº¿ç¨‹æ•°ï¼ˆ<code>setIntraOpNumThreads</code>ï¼‰ï¼›</p>
</li>
<li>
<p>å¯ç”¨ONNX Runtimeçš„æ‰€æœ‰ä¼˜åŒ–ï¼ˆ<code>OptLevel.ALL</code>ï¼‰ï¼›</p>
</li>
<li>
<p>å¯¹è§†é¢‘/æ‘„åƒå¤´æµé‡‡ç”¨å¸§é—´éš”é‡‡æ ·ï¼ˆå¦‚æ¯2å¸§æ£€æµ‹1æ¬¡ï¼‰ï¼Œå¹³è¡¡å¸§ç‡ä¸æ€§èƒ½ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>ä½“ç§¯ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>
<p>ä»…å¼•å…¥å¯¹åº”å¹³å°çš„JavaCVåŸç”Ÿåº“ï¼ˆå¦‚<code>ffmpeg-linux-arm64</code>è€Œé<code>ffmpeg-platform</code>ï¼‰ï¼Œå‡å°‘JaråŒ…ä½“ç§¯ï¼›</p>
</li>
<li>
<p>ä½¿ç”¨GraalVMåŸç”Ÿç¼–è¯‘ï¼Œå°†JaråŒ…ç¼–è¯‘ä¸ºäºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¯åŠ¨æ›´å¿«ã€ä½“ç§¯æ›´å°ã€‚</p>
</li>
</ul>
</li>
</ol>
<h2 data-id="heading-19">å…­ã€æ€»ç»“</h2>
<h3 data-id="heading-20">å…³é”®ç‚¹å›é¡¾</h3>
<ol>
<li>
<p><strong>é›¶Pythonä¾èµ–</strong>ï¼šå…¨ç¨‹åŸºäºJavaCVï¼ˆOpenCV/FFmpeg Javaå°è£…ï¼‰å’ŒONNX Runtime Javaç‰ˆï¼Œæ— éœ€å®‰è£…Pythonã€PyTorchç­‰ä»»ä½•Pythonç”Ÿæ€ç»„ä»¶ï¼›</p>
</li>
<li>
<p><strong>çº¯Javaå®ç°</strong>ï¼šå›¾ç‰‡è¯»å–ã€é¢„å¤„ç†ã€æ¨¡å‹æ¨ç†ã€ç»“æœç»˜åˆ¶å…¨ç”±Javaå®Œæˆï¼Œå…¼å®¹æ‰€æœ‰Javaæ”¯æŒçš„å¹³å°ï¼›</p>
</li>
<li>
<p><strong>è½»é‡éƒ¨ç½²</strong>ï¼šæ‰“åŒ…ä¸ºå•JaråŒ…ï¼Œä»…éœ€JREå³å¯è¿è¡Œï¼Œè·¨å¹³å°æ— éœ€é€‚é…ï¼›</p>
</li>
<li>
<p><strong>æ˜“æ‰©å±•</strong>ï¼šæ”¯æŒå›¾ç‰‡ã€è§†é¢‘ã€æ‘„åƒå¤´æµæ£€æµ‹ï¼Œå¯ç›´æ¥é›†æˆåˆ°SpringBootç­‰Java Webæ¡†æ¶ä¸­ã€‚</p>
</li>
</ol>
<h3 data-id="heading-21">æ ¸å¿ƒä¼˜åŠ¿</h3>
<ul>
<li>
<p>æ‘†è„±Pythonç¯å¢ƒä¾èµ–ï¼Œé™ä½ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å¤æ‚åº¦ï¼›</p>
</li>
<li>
<p>å¤ç”¨Javaç”Ÿæ€çš„æˆç†Ÿå·¥å…·ï¼ˆMavenã€Springã€ç›‘æ§ç­‰ï¼‰ï¼›</p>
</li>
<li>
<p>è·¨å¹³å°å…¼å®¹æ€§å¥½ï¼Œæ— éœ€ä¸ºä¸åŒæ¶æ„ç¼–å†™Pythoné€‚é…ä»£ç ã€‚</p>
</li>
</ul>
<p>è¯¥æ–¹æ¡ˆå¯ç›´æ¥ç”¨äºä¼ä¸šçº§ç”Ÿäº§ç¯å¢ƒï¼Œå®ç°YOLOç›®æ ‡æ£€æµ‹çš„çº¯Javaéƒ¨ç½²ï¼Œå…¼é¡¾æ˜“ç”¨æ€§ã€æ€§èƒ½å’Œå¯ç»´æŠ¤æ€§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¾®è°ƒåçš„Qwen3-4Båœ¨å¤šé¡¹åŸºå‡†æµ‹è¯•ä¸Šæˆ˜å¹³æˆ–èƒœè¿‡GPT-OSS-120B]]></title>    <link>https://juejin.cn/post/7599924721006559295</link>    <guid>https://juejin.cn/post/7599924721006559295</guid>    <pubDate>2026-01-28T02:53:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599924721006559295" data-draft-id="7599929684021919763" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¾®è°ƒåçš„Qwen3-4Båœ¨å¤šé¡¹åŸºå‡†æµ‹è¯•ä¸Šæˆ˜å¹³æˆ–èƒœè¿‡GPT-OSS-120B"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,LLM,å¼€æº"/> <meta itemprop="datePublished" content="2026-01-28T02:53:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Baihai_IDP"/> <meta itemprop="url" content="https://juejin.cn/user/3123071228582343"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¾®è°ƒåçš„Qwen3-4Båœ¨å¤šé¡¹åŸºå‡†æµ‹è¯•ä¸Šæˆ˜å¹³æˆ–èƒœè¿‡GPT-OSS-120B
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3123071228582343/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Baihai_IDP
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:53:47.000Z" title="Wed Jan 28 2026 02:53:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>ç¼–è€…æŒ‰ï¼š</strong> å¦‚æœä½ æ­£åœ¨ä¸ºè¾¹ç¼˜è®¡ç®—ã€æœ¬åœ°éƒ¨ç½²æˆ–èµ„æºå—é™åœºæ™¯å¯»æ‰¾é«˜æ•ˆçš„è¯­è¨€æ¨¡å‹è§£å†³æ–¹æ¡ˆï¼Œä½ æ˜¯å¦æ›¾å›°æƒ‘ï¼šåœ¨ä¼—å¤šå°å‹è¯­è¨€æ¨¡å‹ï¼ˆSLMï¼‰ä¸­ï¼Œå“ªä¸€ä¸ªæ‰æ˜¯å¾®è°ƒçš„æœ€ä½³èµ·ç‚¹ï¼Ÿæ˜¯å¦çœŸçš„å­˜åœ¨â€œå°è€Œå¼ºâ€çš„æ¨¡å‹ï¼Œèƒ½åœ¨å¾®è°ƒååª²ç¾ç”šè‡³è¶…è¶Šè§„æ¨¡å¤§æ•°åå€çš„æ•™å¸ˆæ¨¡å‹ï¼Ÿ</p>
<p>è¿‘æœŸï¼Œdistil labs å›¢é˜Ÿè¿›è¡Œäº†ä¸€é¡¹ä¸¥è°¨çš„åŸºå‡†ç ”ç©¶ï¼Œæˆ–è®¸èƒ½ä¸ºä½ æä¾›æ•°æ®é©±åŠ¨çš„ç­”æ¡ˆã€‚ä»–ä»¬åœ¨ 8 ç±»ä»»åŠ¡ï¼ˆæ¶µç›–åˆ†ç±»ã€ä¿¡æ¯æŠ½å–ã€å¼€å·ä¸é—­å·é—®ç­”ï¼‰ä¸Šï¼Œå¯¹ 12 ä¸ªä¸»æµå°å‹æ¨¡å‹ï¼ˆåŒ…æ‹¬ Qwen3ã€Llamaã€Gemmaã€Graniteã€SmolLM ç­‰ç³»åˆ—ï¼‰è¿›è¡Œäº†ç»Ÿä¸€å¾®è°ƒä¸è¯„ä¼°ï¼Œå¹¶å¯¹æ¯”äº†å…¶ä¸ 120B å‚æ•°æ•™å¸ˆæ¨¡å‹ï¼ˆGPT-OSS-120Bï¼‰çš„æ€§èƒ½å·®å¼‚ã€‚</p>
</blockquote>
<p><strong>ä½œè€… | Distil Labs</strong></p>
<p><strong>ç¼–è¯‘ | å²³æ‰¬</strong></p>
<h2 data-id="heading-0"><strong>01 TL;DR</strong></h2>
<p>ç»è¿‡å¾®è°ƒçš„å°å‹è¯­è¨€æ¨¡å‹ï¼ˆSLMï¼‰å¯ä»¥èƒœè¿‡è§„æ¨¡å¤§å¾—å¤šçš„æ¨¡å‹ï¼šå¾®è°ƒåçš„ Qwen3-4B åœ¨ 8 é¡¹åŸºå‡†æµ‹è¯•ä¸­çš„ 7 é¡¹ä¸Šè¡¨ç°èƒ½å¤Ÿè¶…è¶Šæˆ–æˆ˜å¹³ GPT-OSS-120Bï¼ˆä¸€ä¸ªæ¯”å®ƒæ¨¡å‹è§„æ¨¡å¤§ 30 å€çš„æ•™å¸ˆæ¨¡å‹ï¼‰ï¼Œå‰©ä¸‹çš„ä¸€é¡¹å·®è·ä¹Ÿä¸åˆ° 3 ä¸ªç™¾åˆ†ç‚¹ã€‚åœ¨ SQuAD 2.0 æ•°æ®é›†ä¸Šï¼Œå¾®è°ƒåçš„å­¦ç”Ÿæ¨¡å‹ç”šè‡³æ¯”æ•™å¸ˆæ¨¡å‹é«˜å‡º 19 åˆ†ã€‚è¿™æ„å‘³ç€ä½ åªéœ€æä½çš„æˆæœ¬ï¼Œå°±èƒ½åœ¨è‡ªå·±çš„ç¡¬ä»¶ä¸Šå®ç°å‰æ²¿æ¨¡å‹çº§åˆ«çš„å‡†ç¡®ç‡ã€‚</p>
<p>å¾®è°ƒåæ€§èƒ½æœ€ä½³çš„æ¨¡å‹ï¼šQwen3 ç³»åˆ—æ¨¡å‹åœ¨å¾®è°ƒåå§‹ç»ˆè¡¨ç°æœ€å¼ºï¼Œå…¶ä¸­ 4B ç‰ˆæœ¬æ•´ä½“è¡¨ç°æœ€ä¼˜ã€‚<strong>å¦‚æœä½ çš„ç›®æ ‡æ˜¯åœ¨ç‰¹å®šä»»åŠ¡ä¸Šè·å¾—æœ€é«˜å‡†ç¡®ç‡ï¼ŒQwen3-4B å°±æ˜¯ä½ çš„é¦–é€‰ã€‚</strong></p>
<p>æœ€å…·å¯å¾®è°ƒæ€§ï¼ˆğŸŸ-bleï¼‰ï¼ˆå¾®è°ƒæ”¶ç›Šæœ€å¤§ï¼‰ï¼š<strong>å°å‹æ¨¡å‹ä»å¾®è°ƒä¸­è·å¾—çš„æå‡è¿œè¶…å¤§å‹æ¨¡å‹ã€‚</strong> å¦‚æœä½ å—é™äºä½¿ç”¨éå¸¸å°çš„æ¨¡å‹ï¼ˆ1Bâ€“3Bï¼‰ï¼Œä¹Ÿä¸å¿…æ‹…å¿ƒ â€”â€” å®ƒä»¬èƒ½ä»å¾®è°ƒä¸­è·ç›Šæœ€å¤šï¼Œèƒ½å¤Ÿå¤§å¹…ç¼©å°ä¸æ›´å¤§æ¨¡å‹ä¹‹é—´çš„æ€§èƒ½å·®è·ã€‚</p>
<h2 data-id="heading-1"><strong>02 å¼•è¨€</strong></h2>
<p>å¦‚æœä½ æ­£åœ¨æ„å»ºéœ€è¦åœ¨è®¾å¤‡ç«¯ã€æœ¬åœ°æˆ–è¾¹ç¼˜ä¾§è¿è¡Œçš„ AI åº”ç”¨ï¼Œä½ å¾ˆå¯èƒ½é—®è¿‡è‡ªå·±ï¼šæˆ‘è¯¥å¾®è°ƒå“ªä¸ªå°å‹è¯­è¨€æ¨¡å‹ï¼ˆSLMï¼‰ï¼Ÿç›®å‰ SLM é¢†åŸŸé€‰æ‹©ä¼—å¤šï¼ˆQwenã€Llamaã€Gemmaã€Graniteã€SmolLMï¼‰ï¼Œæ¯ä¸ªç³»åˆ—éƒ½æä¾›å¤šç§æ¨¡å‹è§„æ¨¡çš„ç‰ˆæœ¬ã€‚é€‰é”™åŸºç¡€æ¨¡å‹å¯èƒ½æ„å‘³ç€æœ‰æ•°å‘¨æ—¶é—´åœ¨æµªè´¹è®¡ç®—èµ„æºï¼Œæˆ–è€…å¾—åˆ°çš„æ¨¡å‹å§‹ç»ˆæ— æ³•è¾¾åˆ°ç”Ÿäº§è´¨é‡è¦æ±‚ã€‚</p>
<p>æˆ‘ä»¬è¿›è¡Œäº†ä¸€é¡¹ç³»ç»Ÿçš„åŸºå‡†æµ‹è¯•ï¼Œç”¨æ•°æ®æ¥å›ç­”è¿™ä¸ªé—®é¢˜ã€‚å€ŸåŠ© distil labs å¹³å°ï¼Œæˆ‘ä»¬åœ¨ 8 ä¸ªä¸åŒçš„ä»»åŠ¡ä¸Šï¼ˆåˆ†ç±»ã€ä¿¡æ¯æŠ½å–ã€å¼€å·é—®ç­”ã€é—­å·é—®ç­”ï¼‰å¾®è°ƒäº† 12 ä¸ªæ¨¡å‹ï¼Œç„¶åå°†å®ƒä»¬çš„æ€§èƒ½ç›¸äº’æ¯”è¾ƒï¼Œå¹¶ä¸ç”¨äºç”Ÿæˆåˆæˆè®­ç»ƒæ•°æ®çš„æ•™å¸ˆå¤§æ¨¡å‹è¿›è¡Œå¯¹æ¯”ã€‚</p>
<p>æœ¬æ–‡å›ç­”äº†å››ä¸ªå®é™…é—®é¢˜ï¼š</p>
<ul>
<li>å“ªä¸ªæ¨¡å‹åœ¨å¾®è°ƒåæ•ˆæœæœ€å¥½ï¼Ÿ</li>
<li>å“ªä¸ªæ¨¡å‹æœ€å…·å¯å¾®è°ƒæ€§ï¼Ÿï¼ˆå³å¾®è°ƒåæå‡æœ€å¤§ï¼‰</li>
<li>å“ªä¸ªæ¨¡å‹çš„åŸºç¡€æ€§èƒ½æœ€å¼ºï¼Ÿï¼ˆå³æœªç»å¾®è°ƒå‰ï¼‰</li>
<li>æˆ‘ä»¬è¡¨ç°æœ€å¥½çš„å­¦ç”Ÿæ¨¡å‹ï¼ŒçœŸçš„èƒ½åª²ç¾æ•™å¸ˆæ¨¡å‹å—ï¼Ÿ</li>
</ul>
<h2 data-id="heading-2"><strong>03 å®éªŒæ–¹æ³•</strong></h2>
<p>æˆ‘ä»¬è¯„ä¼°äº†ä»¥ä¸‹æ¨¡å‹ï¼š</p>
<ul>
<li><strong>Qwen3 ç³»åˆ—</strong>ï¼šQwen3-8Bã€Qwen3-4B-Instruct-2507ã€Qwen3-1.7Bã€Qwen3-0.6Bã€‚æ³¨æ„ï¼Œæˆ‘ä»¬å…³é—­äº†è¯¥ç³»åˆ—çš„â€œthinkingâ€åŠŸèƒ½ï¼Œä»¥ä¿è¯å®éªŒçš„å…¬å¹³ã€‚ Â </li>
<li><strong>Llama ç³»åˆ—</strong>ï¼šLlama-3.1-8B-Instructã€Llama-3.2-3B-Instructã€Llama-3.2-1B-Instruct Â </li>
<li><strong>SmolLM2 ç³»åˆ—</strong>ï¼šSmolLM2-1.7B-Instructã€SmolLM2-135M-Instruct Â </li>
<li><strong>Gemma ç³»åˆ—</strong>ï¼šgemma-3-1b-itã€gemma-3-270m-it Â </li>
<li><strong>Granite</strong>ï¼šgranite-3.3-8b-instruct Â </li>
</ul>
<p>é’ˆå¯¹æ¯ä¸ªæ¨¡å‹ï¼Œæˆ‘ä»¬æµ‹é‡äº†ï¼š</p>
<ul>
<li>Base scoreï¼šä»…ä½¿ç”¨æç¤ºè¯ï¼ˆpromptingï¼‰çš„å°æ ·æœ¬ï¼ˆfew-shotï¼‰åœºæ™¯ä¸‹çš„æ€§èƒ½ Â </li>
<li>Finetuned scoreï¼šåœ¨ç”±æˆ‘ä»¬çš„æ•™å¸ˆæ¨¡å‹ï¼ˆGPT-OSS 120Bï¼‰ç”Ÿæˆçš„åˆæˆæ•°æ®ä¸Šå¾®è°ƒåçš„æ€§èƒ½ Â </li>
</ul>
<p>æˆ‘ä»¬çš„ 8 é¡¹åŸºå‡†æµ‹è¯•æ¶µç›–<strong>åˆ†ç±»</strong>ï¼ˆTRECã€Banking77ã€Ecommerceã€Mental Healthï¼‰ã€<strong>æ–‡æ¡£ç†è§£</strong>ï¼ˆdocsï¼‰ä»¥åŠ<strong>é—®ç­”ä»»åŠ¡</strong>ï¼ˆHotpotQAã€Roman Empire QAã€SQuAD 2.0ï¼‰ã€‚</p>
<p>ä¸ºäº†å®ç°å…¬å¹³æµ‹é‡ï¼Œæˆ‘ä»¬åˆ†åˆ«è®¡ç®—äº†æ¯ä¸ªæ¨¡å‹åœ¨å„ä¸ªåŸºå‡†æµ‹è¯•ä¸Šçš„æ’åï¼Œç„¶åè®¡ç®—æ‰€æœ‰ä»»åŠ¡ä¸Šçš„å¹³å‡æ’åï¼Œå¹¶ä»¥ 95% ç½®ä¿¡åŒºé—´ä½œä¸ºè¯¯å·®æ£’ï¼ˆerror barsï¼‰ç»˜åˆ¶åœ¨å›¾ä¸­ã€‚å¹³å‡æ’åè¶Šä½ï¼Œè¡¨ç¤ºæ•´ä½“æ€§èƒ½è¶Šå¥½ã€‚</p>
<h2 data-id="heading-3"><strong>04 é—®é¢˜ä¸€ï¼šå“ªä¸ªæ¨¡å‹åœ¨å¾®è°ƒåæ•ˆæœæœ€å¥½ï¼Ÿ</strong></h2>
<p>å† å†›ï¼šQwen3-4B-Instruct-2507ï¼ˆå¹³å‡æ’åï¼š2.25ï¼‰</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/996d71c830f14179b49a86ee33dfe5a6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmFpaGFpX0lEUA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173627&amp;x-signature=zFTLkntB4n0QDqpafrLEPvA4PKc%3D" alt="image.png" loading="lazy"/><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bcc40e41f4e0428588cc6785bbb93603~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmFpaGFpX0lEUA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173627&amp;x-signature=Hb%2FWF3JclRRdQpX%2BiQCKE%2FuQq84%3D" alt="image.png" loading="lazy"/></p>
<p>Qwen3 ç³»åˆ—å æ®äº†æ’è¡Œæ¦œå‰åˆ—ï¼Œå…¶ä¸­ Qwen3-4B-Instruct-2507 æ‘˜å¾—æ¡‚å† ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™æ¬¾ 4B æ¨¡å‹çš„è¡¨ç°ç”šè‡³è¶…è¿‡äº†æ›´å¤§çš„ Qwen3-8Bï¼Œè¿™è¡¨æ˜åœ¨è’¸é¦ä»»åŠ¡ä¸­ï¼ŒQwen3 çš„è¾ƒæ–°ç‰ˆæœ¬ï¼ˆ2025 å¹´ 7 æœˆ 25 æ—¥æ›´æ–°çš„ç‰ˆæœ¬ï¼‰æ¯”ä¹‹å‰çš„ 8B SLM æ•ˆæœæ›´å¥½ã€‚</p>
<p>æ ¸å¿ƒç»“è®ºï¼š<strong>å¦‚æœä½ å¸Œæœ›è·å¾—æ•ˆæœæœ€å¥½çš„å¾®è°ƒæ¨¡å‹ï¼Œå¹¶ä¸”æ‹¥æœ‰æ”¯æŒçº¦ 4B å‚æ•°è§„æ¨¡æ¨¡å‹å¾®è°ƒçš„ GPU æ˜¾å­˜ï¼Œé‚£ä¹ˆ Qwen3-4B-Instruct-2507 æ˜¯ä½ çš„é¦–é€‰ã€‚</strong></p>
<h2 data-id="heading-4"><strong>05 é—®é¢˜äºŒï¼šå“ªä¸ªæ¨¡å‹æœ€å…·å¯å¾®è°ƒæ€§ï¼Ÿï¼ˆå³å¾®è°ƒåæå‡æœ€å¤§ï¼‰</strong></h2>
<p>å† å†›: Llama-3.2-1B-Instructï¼ˆå¹³å‡æ’åï¼š3.44ï¼‰</p>
<p>è¿™é‡Œæˆ‘ä»¬æµ‹é‡çš„æ˜¯å¯å¾®è°ƒæ€§ï¼ˆtunabilityï¼‰ â€”â€” å³ä»åŸºç¡€æ€§èƒ½åˆ°å¾®è°ƒåæ€§èƒ½çš„æå‡å¹…åº¦ï¼ˆfinetuned_score - base_scoreï¼‰ã€‚ä¸€ä¸ªé«˜åº¦å¯å¾®è°ƒçš„æ¨¡å‹åˆå§‹è¡¨ç°å¯èƒ½è¾ƒå¼±ï¼Œä½†ç»è¿‡å¾®è°ƒåæå‡æ˜¾è‘—ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e6c7df7be9b84eaaa0f25df116309e72~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmFpaGFpX0lEUA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173627&amp;x-signature=042vhIqTtetQhRR%2BN3ITPvPxUqc%3D" alt="image.png" loading="lazy"/><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/94f29e84189d45eebd98bdde374ee992~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmFpaGFpX0lEUA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173627&amp;x-signature=Hv7J4rJTmoBD2p2NfSCw0ye9%2FSQ%3D" alt="image.png" loading="lazy"/></p>
<p>æœ‰è¶£çš„æ˜¯ï¼Œå¯å¾®è°ƒæ€§æ’åä¸æ¨¡å‹å¤§å°çš„æ’åºæ­£å¥½ç›¸åã€‚åƒ Llama-3.2-1B å’Œ Qwen3-0.6B è¿™æ ·çš„å°å‹æ¨¡å‹ï¼Œä»å¾®è°ƒä¸­è·å¾—çš„æå‡æœ€å¤§ã€‚è€Œè§„æ¨¡æœ€å¤§çš„æ¨¡å‹ï¼ˆå¦‚ Qwen3-8Bã€granite-3.3-8bï¼‰åœ¨å¯å¾®è°ƒæ€§æ’åä¸­æ¥è¿‘å«åº• â€”â€” è¿™å¹¶éå› ä¸ºå®ƒä»¬è¡¨ç°å·®ï¼Œè€Œæ˜¯å› ä¸ºå®ƒä»¬èµ·ç‚¹ç›¸å¯¹è¾ƒé«˜ï¼Œè¿›æ­¥ç©ºé—´ç›¸å¯¹æœ‰é™ã€‚</p>
<p>æ ¸å¿ƒç»“è®ºï¼š<strong>å¦‚æœä½ å—é™äºä½¿ç”¨æå°çš„æ¨¡å‹ï¼ˆ&lt;2B å‚æ•°ï¼‰ï¼Œä¸å¿…ç°å¿ƒã€‚è¿™äº›æ¨¡å‹ä»å¾®è°ƒä¸­è·ç›Šæœ€å¤§ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ˜¾è‘—ç¼©å°ä¸æ›´å¤§æ¨¡å‹ä¹‹é—´çš„æ€§èƒ½å·®è·ã€‚</strong></p>
<h2 data-id="heading-5"><strong>06 é—®é¢˜ä¸‰ï¼šå“ªä¸ªæ¨¡å‹çš„åŸºç¡€æ€§èƒ½æœ€å¼ºï¼Ÿï¼ˆå³æœªç»å¾®è°ƒå‰ï¼‰</strong></h2>
<p>å† å†›: Qwen3-8B (å¹³å‡æ’å: 1.75)</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/33405bd8af534332891b12d08a46d73c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmFpaGFpX0lEUA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173627&amp;x-signature=5M7Yvb0KyHGPemJ%2FtzTJiAOIE5I%3D" alt="image.png" loading="lazy"/><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f9e4633ba5e244e6b032bff6f7ef9ca2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmFpaGFpX0lEUA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173627&amp;x-signature=E9dN8qqfhbfUDjh5afRQHy34JsM%3D" alt="image.png" loading="lazy"/></p>
<p>åœ¨æœªç»ä»»ä½•å¾®è°ƒçš„æƒ…å†µä¸‹ï¼Œå“ªä¸ªæ¨¡å‹å¼€ç®±å³ç”¨çš„è¡¨ç°æœ€å¥½ï¼Ÿ</p>
<p>æ­£å¦‚é¢„æœŸï¼ŒåŸºç¡€æ€§èƒ½ä¸æ¨¡å‹å¤§å°å‘ˆæ­£ç›¸å…³ã€‚8B æ¨¡å‹å æ®äº†æ¦œé¦–ä½ç½®ï¼Œå…¶ä¸­ Qwen3-8B åœ¨æ‰€æœ‰åŸºå‡†æµ‹è¯•ä¸­éƒ½å±•ç°å‡ºéå¸¸ç¨³å®šçš„æ€§èƒ½ï¼ˆæ ‡å‡†å·®æœ€ä½ï¼‰ã€‚</p>
<p>æ ¸å¿ƒç»“è®ºï¼š<strong>å¦‚æœä½ éœ€è¦åœ¨ä¸è¿›è¡Œå¾®è°ƒçš„æƒ…å†µä¸‹åœ¨é›¶æ ·æœ¬/å°æ ·æœ¬åœºæ™¯ä¸‹ä¹Ÿè·å¾—è¾ƒä¼˜çš„æ€§èƒ½ï¼Œå¤§æ¨¡å‹ä»æ˜¯ä½ çš„æœ€ä½³é€‰æ‹©ã€‚ä½†è¯·è®°ä½ â€”â€” ç»è¿‡å¾®è°ƒåï¼Œè¿™ç§ä¼˜åŠ¿ä¼šå‡å¼±ã€‚</strong></p>
<h2 data-id="heading-6"><strong>07 é—®é¢˜å››ï¼šæˆ‘ä»¬è¡¨ç°æœ€å¥½çš„å­¦ç”Ÿæ¨¡å‹ï¼ŒçœŸçš„èƒ½åª²ç¾æ•™å¸ˆæ¨¡å‹å—ï¼Ÿ</strong></h2>
<p>æ˜¯çš„ã€‚Qwen3-4B-Instruct-2507 åœ¨ 8 é¡¹åŸºå‡†æµ‹è¯•ä¸­çš„ 7 é¡¹ä¸Šè¾¾åˆ°æˆ–è¶…è¶Šäº†æ•™å¸ˆæ¨¡å‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/725f8cad888e4a339c5ce91c2f9bd8f3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmFpaGFpX0lEUA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173627&amp;x-signature=4CQWo0q6RW9hOCLC0es9E3O6nfw%3D" alt="image.png" loading="lazy"/><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/88d4230ad15748b5a2562afecbba8925~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmFpaGFpX0lEUA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173627&amp;x-signature=4EwZ%2Bam8LewvcHs6oPGGbEDH%2FDA%3D" alt="image.png" loading="lazy"/></p>
<p>ç»è¿‡å¾®è°ƒçš„ 4B å­¦ç”Ÿæ¨¡å‹åœ¨ 6 é¡¹åŸºå‡†æµ‹è¯•ä¸Šè¶…è¶Šäº† 120B+ å‚æ•°çš„æ•™å¸ˆæ¨¡å‹ï¼Œåœ¨ 1 é¡¹ï¼ˆHotpotQAï¼‰ä¸ŠæŒå¹³ï¼Œä»…åœ¨ 1 é¡¹ï¼ˆBanking77ï¼‰ä¸Šç•¥å¾®è½åï¼ˆå·®è·åœ¨è¯¯å·®èŒƒå›´å†…ï¼‰ã€‚æå‡æœ€æ˜¾è‘—çš„æ˜¯ SQuAD 2.0 é—­å·é—®ç­”ä»»åŠ¡ï¼Œå­¦ç”Ÿæ¨¡å‹æ¯”æ•™å¸ˆæ¨¡å‹é«˜å‡º 19 ä¸ªç™¾åˆ†ç‚¹ â€”â€” è¿™å……åˆ†è¯æ˜ï¼Œå¾®è°ƒæ¯”å•çº¯ä¾èµ–æç¤ºè¯ï¼ˆpromptingï¼‰èƒ½æ›´æœ‰æ•ˆåœ°å°†é¢†åŸŸçŸ¥è¯†æ³¨å…¥æ¨¡å‹ã€‚</p>
<p>æ ¸å¿ƒç»“è®ºï¼š<strong>ä¸€ä¸ªç»è¿‡é€‚å½“å¾®è°ƒçš„ 4B å‚æ•°æ¨¡å‹ï¼Œå¯ä»¥åª²ç¾ç”šè‡³è¶…è¶Šè§„æ¨¡è¾¾å…¶ 30 å€çš„æ¨¡å‹ã€‚è¿™æ„å‘³ç€æ¨ç†æˆæœ¬å¯é™ä½çº¦ 30 å€ï¼Œå¹¶ä¸”èƒ½å¤Ÿå®Œå…¨åœ¨æœ¬åœ°éƒ¨ç½²è¿è¡Œã€‚</strong></p>
<h2 data-id="heading-7"><strong>08 å®ç”¨å»ºè®®</strong></h2>
<p>åŸºäºæˆ‘ä»¬çš„åŸºå‡†æµ‹è¯•ç»“æœï¼Œä»¥ä¸‹æ˜¯é€‰æ‹©åŸºç¡€æ¨¡å‹çš„å»ºè®®ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/99a159b7def0470f844ff08809643695~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmFpaGFpX0lEUA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173627&amp;x-signature=%2FW86tTdlTaK%2BabjSiNhb56KbwRE%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-8"><strong>09 åç»­æˆ‘ä»¬å°†è¿›è¡Œçš„å·¥ä½œ</strong></h2>
<p>æœ¬æ¬¡åŸºå‡†æµ‹è¯•åªæ˜¯ä¸€ä¸ªèµ·ç‚¹ï¼Œæˆ‘ä»¬æ­£åœ¨ç§¯æåŠªåŠ›è®©è¿™äº›ç»“æœæ›´åŠ å¯é ï¼š</p>
<ul>
<li><strong>è¯„ä¼°æ›´å¤šæ¨¡å‹</strong>ï¼šSLM é¢†åŸŸå‘å±•è¿…é€Ÿã€‚æˆ‘ä»¬è®¡åˆ’åœ¨ Qwen3.5ã€Phi-4 å’Œ Mistral ç³»åˆ—ç­‰æ–°æ¨¡å‹ç‰ˆæœ¬å‘å¸ƒååŠæ—¶çº³å…¥è¯„æµ‹ã€‚</li>
<li><strong>å¢åŠ è¿è¡Œè½®æ¬¡</strong>ï¼šç›®å‰æˆ‘ä»¬çš„ç»“æœåŸºäºæœ‰é™æ¬¡æ•°çš„è¿è¡Œå–å¹³å‡ã€‚æˆ‘ä»¬å°†ä¸ºæ¯é¡¹åŸºå‡†æµ‹è¯•å¢åŠ æ›´å¤šè¿è¡Œè½®æ¬¡ï¼Œä»¥ç¼©å°ç½®ä¿¡åŒºé—´ï¼Œç¡®ä¿æ’åå…·æœ‰ç»Ÿè®¡å¯é æ€§ã€‚</li>
<li><strong>æ‰©å±•åŸºå‡†æµ‹è¯•è¦†ç›–èŒƒå›´</strong>ï¼šæˆ‘ä»¬å¸Œæœ›çº³å…¥æ›´å¤šä»»åŠ¡ç±»å‹ï¼Œå¦‚æ–‡æœ¬æ‘˜è¦ã€ä»£ç ç”Ÿæˆå’Œå¤šè½®å¯¹è¯ï¼Œä»è€Œæ›´å…¨é¢åœ°åæ˜ æ¨¡å‹èƒ½åŠ›ã€‚</li>
</ul>
<h2 data-id="heading-9"><strong>10 è®­ç»ƒç»†èŠ‚</strong></h2>
<p>æ¯ä¸ªæ¨¡å‹éƒ½åœ¨ä½¿ç”¨æˆ‘ä»¬è’¸é¦æµç¨‹ç”Ÿæˆçš„åˆæˆæ•°æ®è¿›è¡Œå¾®è°ƒï¼ˆæœ‰å…³æ•°æ®åˆæˆè¿‡ç¨‹çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§ã€ŠSmall Expert Agents from 10 Examplesã€‹[1]ï¼‰ã€‚é’ˆå¯¹æ¯ä¸ªåŸºå‡†æµ‹è¯•ï¼Œæˆ‘ä»¬ä½¿ç”¨æ•™å¸ˆæ¨¡å‹ï¼ˆGPTOss-120Bï¼‰ç”Ÿæˆäº† 10,000 æ¡è®­ç»ƒæ ·æœ¬ã€‚</p>
<p>å¾®è°ƒé‡‡ç”¨ distil labs çš„é»˜è®¤é…ç½®[2]ï¼šè®­ç»ƒ 4 ä¸ª epochï¼Œå­¦ä¹ ç‡ 5e-5ï¼Œä½¿ç”¨çº¿æ€§å­¦ä¹ ç‡è°ƒåº¦å™¨ï¼Œä»¥åŠ rank ä¸º 64 çš„ LoRAã€‚</p>
<p>æ‰€æœ‰æ¨¡å‹å‡ä½¿ç”¨å®Œå…¨ç›¸åŒçš„è¶…å‚æ•°è¿›è¡Œè®­ç»ƒã€‚è¯„ä¼°åœ¨è®­ç»ƒå’Œåˆæˆæ•°æ®ç”Ÿæˆè¿‡ç¨‹ä¸­å‡æœªæ¥è§¦è¿‡çš„é¢„ç•™æµ‹è¯•é›†ä¸Šè¿›è¡Œã€‚</p>
<h2 data-id="heading-10"><strong>11 ç»“è®º</strong></h2>
<p>å¹¶éæ‰€æœ‰å°å‹æ¨¡å‹çš„æ€§èƒ½éƒ½å·®ä¸å¤šï¼Œä½†ç»è¿‡å¾®è°ƒåï¼Œå®ƒä»¬ä¹‹é—´çš„å·®è·ä¼šå¤§å¹…ç¼©å°ã€‚æˆ‘ä»¬çš„åŸºå‡†æµ‹è¯•è¡¨æ˜ï¼ŒQwen3-4B-Instruct-2507 åœ¨æ•´ä½“å¾®è°ƒæ€§èƒ½ä¸Šè¡¨ç°æœ€ä½³ï¼Œä¸ä»…èƒ½åª²ç¾ 120B+ å‚æ•°çš„æ•™å¸ˆæ¨¡å‹ï¼Œè¿˜èƒ½åœ¨å•å—æ¶ˆè´¹çº§ GPU ä¸Šéƒ¨ç½²è¿è¡Œã€‚åœ¨èµ„æºæåº¦å—é™çš„ç¯å¢ƒä¸­ï¼Œåƒ Llama-3.2-1B è¿™æ ·çš„å°æ¨¡å‹å±•ç°å‡ºå“è¶Šçš„å¯å¾®è°ƒæ€§ï¼Œèƒ½å¤Ÿå¤§å¹…ç¼©å°ä¸å¤§æ¨¡å‹çš„æ€§èƒ½å·®è·ã€‚</p>
<p>æ ¸å¿ƒç»“è®ºï¼š<strong>å¾®è°ƒæ¯”åŸºç¡€æ¨¡å‹çš„é€‰æ‹©æ›´é‡è¦ã€‚ä¸€ä¸ªç»è¿‡è‰¯å¥½å¾®è°ƒçš„ 1B æ¨¡å‹ï¼Œå¯ä»¥èƒœè¿‡ä»…é æç¤ºè¯ï¼ˆpromptingï¼‰é©±åŠ¨çš„ 8B æ¨¡å‹ã€‚</strong></p>
<p><strong>END</strong></p>
<p><strong>æœ¬æœŸäº’åŠ¨å†…å®¹ ğŸ»</strong></p>
<p><strong>â“ä½ åœ¨å¾®è°ƒå°å‹è¯­è¨€æ¨¡å‹æ—¶ï¼Œæœ€çœ‹é‡çš„æ˜¯â€œå¼€ç®±å³ç”¨çš„å¼ºåŸºç¡€èƒ½åŠ›â€ï¼Œè¿˜æ˜¯â€œå¾®è°ƒåå·¨å¤§çš„æå‡ç©ºé—´â€ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</strong></p>
<p><strong>æ–‡ä¸­é“¾æ¥</strong></p>
<p>[1]<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.distillabs.ai%2Fblog%2Fsmall-expert-agents-from-10-examples" target="_blank" title="https://www.distillabs.ai/blog/small-expert-agents-from-10-examples" ref="nofollow noopener noreferrer">www.distillabs.ai/blog/small-â€¦</a></p>
<p>[2]<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.distillabs.ai%2Fhow-to%2Finput-preparation%2Fconfig" target="_blank" title="https://docs.distillabs.ai/how-to/input-preparation/config" ref="nofollow noopener noreferrer">docs.distillabs.ai/how-to/inpuâ€¦</a></p>
<p><strong>åŸæ–‡é“¾æ¥ï¼š</strong></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.distillabs.ai%2Fblog%2Fwe-benchmarked-12-small-language-models-across-8-tasks-to-find-the-best-base-model-for-fine-tuning" target="_blank" title="https://www.distillabs.ai/blog/we-benchmarked-12-small-language-models-across-8-tasks-to-find-the-best-base-model-for-fine-tuning" ref="nofollow noopener noreferrer">www.distillabs.ai/blog/we-benâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3 æ¸²æŸ“ä¼˜åŒ–åŒæ ¸å¿ƒï¼šBlock Tree åŸç†ä¸ Fragment æ ¹èŠ‚ç‚¹å¦™ç”¨]]></title>    <link>https://juejin.cn/post/7599911091087540224</link>    <guid>https://juejin.cn/post/7599911091087540224</guid>    <pubDate>2026-01-28T02:54:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599911091087540224" data-draft-id="7599532624195895348" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3 æ¸²æŸ“ä¼˜åŒ–åŒæ ¸å¿ƒï¼šBlock Tree åŸç†ä¸ Fragment æ ¹èŠ‚ç‚¹å¦™ç”¨"/> <meta itemprop="keywords" content="JavaScript,é¢è¯•,Vue.js"/> <meta itemprop="datePublished" content="2026-01-28T02:54:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="boooooooom"/> <meta itemprop="url" content="https://juejin.cn/user/3078273283917399"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3 æ¸²æŸ“ä¼˜åŒ–åŒæ ¸å¿ƒï¼šBlock Tree åŸç†ä¸ Fragment æ ¹èŠ‚ç‚¹å¦™ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3078273283917399/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    boooooooom
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:54:07.000Z" title="Wed Jan 28 2026 02:54:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;color:#3c9dff}.markdown-body h1{font-size:30px;margin-bottom:5px;padding-bottom:8px;text-align:center}.markdown-body h2{font-size:24px;padding-bottom:6px}.markdown-body h2:before{content:"ğŸ‹"}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{content:"ğŸ“"}.markdown-body h4{font-size:16px}.markdown-body h4:before{content:"ğŸ‘"}.markdown-body h5{font-size:15px}.markdown-body h5:before{content:"ğŸ‰"}.markdown-body h6{margin-top:5px}.markdown-body h6:before{content:"ğŸ’"}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;margin:0 auto;max-width:100%;border-radius:4px;padding:1px;border:1px solid #d2e8ff}.markdown-body img:hover{box-shadow:0 1px 3px #5eaeff}.markdown-body hr{height:4px;margin:34px 0;background-size:4px 1px;background-image:linear-gradient(270deg,#5eaeff,#f3f9ff 25%,transparent 50%);border-style:none}.markdown-body code{word-break:break-word;border-radius:3px;overflow-x:auto;background-color:#d2e8ff;color:#3c9dff;font-size:.9em;padding:.1em .5em;margin:0 3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;transition:all .3s}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:1px solid #90c7ff;border-radius:4px}.markdown-body pre:hover{box-shadow:0 1px 10px #beddff}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#3c9dff;border-bottom:1px solid #90c7ff;transition:all .3s}.markdown-body a:hover{color:#007fff;border-bottom:2px solid #5eaeff}.markdown-body a[href]:not(:empty){padding-right:18px}.markdown-body a[href]:not(:empty):after{display:inline-block;width:16px;height:16px;margin-left:2px;content:"";background:url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik0zODQgMTI4YTQ4IDQ4IDAgMDEyLjgxNiA5NS45MkwzODQgMjI0SDI1NmEzMiAzMiAwIDAwLTMxLjkyIDI5LjZMMjI0IDI1NnY1MTJhMzIgMzIgMCAwMDI5LjYgMzEuOTJsMi40LjA4aDUxMmEzMiAzMiAwIDAwMzEuOTItMjkuNmwuMDgtMi40VjY1NmE0OCA0OCAwIDAxOTUuOTItMi44MTZMODk2IDY1NnYxMTJhMTI4IDEyOCAwIDAxLTEyNCAxMjcuOTM2bC00IC4wNjRIMjU2YTEyOCAxMjggMCAwMS0xMjcuOTM2LTEyNGwtLjA2NC00VjI1NmExMjggMTI4IDAgMDExMjQtMTI3LjkzNmw0LS4wNjRoMTI4em0zODQgMGExMjggMTI4IDAgMDExMjcuOTM2IDEyNGwuMDY0IDR2MTYwYTQ4IDQ4IDAgMDEtOTUuOTIgMi44MTZMODAwIDQxNlYyOTEuODcybC0zODIuMDY0IDM4Mi4wOGE0OCA0OCAwIDAxLTcwLjAzMi02NS42bDIuMTYtMi4yODhMNzMyLjA5NiAyMjRINjA4YTQ4IDQ4IDAgMDEtMi44MTYtOTUuOTJMNjA4IDEyOGgxNjB6IiBmaWxsPSIjM2M5ZGZmIiBmaWxsLW9wYWNpdHk9Ii41NiIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC5zZWFyY2hfaW5kZXguMC5pMC41Yzc1M2E4MTgwa2RKWCIgY2xhc3M9InNlbGVjdGVkIi8+PC9zdmc+);background-size:100%}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border:1px solid #3c9dff}.markdown-body thead{text-align:center}.markdown-body thead th{color:#fff;background-color:#5eaeff}.markdown-body tr{text-align:center}.markdown-body tbody tr:hover{background-color:#d2e8ff}.markdown-body tbody tr:hover code{background-color:#90c7ff}.markdown-body tr:nth-child(2n){background-color:#ecf5ff}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5eaeff}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{font-weight:900;padding:0 1px;font-size:17px}.markdown-body small{color:#cbcbcb;padding:0 1px;font-size:22px;zoom:.5}.markdown-body em{padding:0 1px}.markdown-body del{padding:0 1px;text-decoration-thickness:2px}.markdown-body blockquote{color:#1a1b1c;padding:1px 20px;margin:22px 0;border-radius:4px;border-left:4px solid rgba(60,157,255,.5);background-color:rgba(190,221,255,.3)}.markdown-body blockquote blockquote{margin:8px 0}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{margin:12px 0;padding:4px 10px;border:2px solid #3c9dff;border-radius:8px;background-color:#ecf5ff;transition:all .3s}.markdown-body details summary{cursor:pointer}.markdown-body input[type=checkbox]{position:relative;appearance:none;width:16px;height:16px;border-radius:2px;vertical-align:middle;transform:translateY(-2px);box-sizing:border-box;border:1px solid #beddff}.markdown-body input[type=checkbox]:checked{border:1px solid #5eaeff;background-color:#5eaeff}.markdown-body input[type=checkbox]:checked:before{position:absolute;top:3px;left:1px;width:11px;height:6px;background-color:transparent;border-left:2px solid #fff;border-bottom:2px solid #fff;transform:rotate(-45deg);content:"";box-sizing:border-box}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="androidstudio">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#a9b7c6;background:#282b2e}.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#6897bb}.hljs-deletion,.hljs-keyword,.hljs-selector-tag{color:#cc7832}.hljs-link,.hljs-template-variable,.hljs-variable{color:#629755}.hljs-comment,.hljs-quote{color:grey}.hljs-meta{color:#bbb529}.hljs-addition,.hljs-attribute,.hljs-string{color:#6a8759}.hljs-section,.hljs-title,.hljs-type{color:#ffc66d}.hljs-name,.hljs-selector-class,.hljs-selector-id{color:#e8bf6a}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ Vue3 ç¼–è¯‘ä¼˜åŒ–ä½“ç³»ä¸­ï¼ŒBlock Treeï¼ˆå—æ ‘ï¼‰ä¸ Fragment æ ¹èŠ‚ç‚¹ä¼˜åŒ–ï¼Œæ˜¯ç»§é™æ€æå‡ï¼ˆhoistStaticï¼‰ã€PatchFlag ä¹‹åçš„åˆä¸€æ ¸å¿ƒæ‰‹æ®µã€‚å¦‚æœè¯´é™æ€æå‡è§£å†³äº†é™æ€å†…å®¹çš„é‡å¤åˆ›å»ºé—®é¢˜ï¼ŒPatchFlag å®ç°äº†åŠ¨æ€å†…å®¹çš„ç²¾å‡†æ¯”å¯¹ï¼Œé‚£ä¹ˆ Block Tree åˆ™é€šè¿‡å¯¹æ¨¡æ¿èŠ‚ç‚¹çš„åˆ†å±‚å½’ç±»ï¼Œè¿›ä¸€æ­¥ç¼©å°è™šæ‹Ÿ DOM æ¯”å¯¹èŒƒå›´ï¼Œè€Œ Fragment æ ¹èŠ‚ç‚¹ä¼˜åŒ–åˆ™è§£å†³äº†æ¨¡æ¿å¿…é¡»æœ‰å”¯ä¸€æ ¹èŠ‚ç‚¹çš„å†å²ç—›ç‚¹ï¼ŒåŒæ—¶é™ä½æ¸²æŸ“å†—ä½™ã€‚æœ¬æ–‡å°†æ·±åº¦æ‹†è§£äºŒè€…çš„å®ç°é€»è¾‘ã€ååŒå…³ç³»åŠå®æˆ˜æ³¨æ„äº‹é¡¹ï¼Œå®Œå–„ Vue3 ç¼–è¯‘ä¼˜åŒ–çŸ¥è¯†ä½“ç³»ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€å…ˆç ´å±€ï¼šFragment æ ¹èŠ‚ç‚¹ä¼˜åŒ–ï¼ˆå‘Šåˆ«å”¯ä¸€æ ¹èŠ‚ç‚¹é™åˆ¶ï¼‰</h2>
<p>Vue2 ä¸­å­˜åœ¨ä¸€ä¸ªç»å…¸é™åˆ¶ï¼šæ¨¡æ¿å¿…é¡»æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªå”¯ä¸€æ ¹èŠ‚ç‚¹ï¼Œå¦åˆ™ç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œå¼€å‘è€…é€šå¸¸ä¼šç”¨ä¸€ä¸ªæ— æ„ä¹‰çš„ <code>&lt;div&gt;&lt;/div&gt;</code> æ ‡ç­¾åŒ…è£¹æ‰€æœ‰å†…å®¹ï¼Œè¿™ä¸ä»…å¢åŠ äº† DOM å±‚çº§å†—ä½™ï¼Œè¿˜å¯èƒ½å½±å“æ ·å¼å¸ƒå±€ä¸æ¸²æŸ“æ€§èƒ½ã€‚Vue3 å¼•å…¥ Fragment ä½œä¸ºæ¨¡æ¿æ ¹èŠ‚ç‚¹è§£å†³æ–¹æ¡ˆï¼Œä»æ ¹æºä¸Šè§£å†³äº†è¿™ä¸€ç—›ç‚¹ã€‚1. Fragment æ ¸å¿ƒä½œç”¨ï¼šè™šæ‹Ÿæ ¹èŠ‚ç‚¹ï¼Œæ—  DOM å†—ä½™Fragment æœ¬è´¨æ˜¯ä¸€ä¸ªâ€œè™šæ‹Ÿæ ¹èŠ‚ç‚¹â€ï¼Œå®ƒä»…ä½œä¸ºæ¨¡æ¿çš„é€»è¾‘å®¹å™¨ï¼Œç¼–è¯‘åä¸ä¼šç”ŸæˆçœŸå®çš„ DOM èŠ‚ç‚¹ï¼Œæ—¢èƒ½æ»¡è¶³æ¨¡æ¿å¤šæ ¹èŠ‚ç‚¹çš„éœ€æ±‚ï¼Œåˆä¸ä¼šå¢åŠ  DOM å±‚çº§ã€‚</p>
<pre><code class="hljs language-ts" lang="ts">&lt;!-- <span class="hljs-title class_">Vue2</span> å†™æ³•ï¼šéœ€é¢å¤–åŒ…è£¹æ— æ„ä¹‰ div --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-comment">&lt;!-- å†—ä½™ DOM èŠ‚ç‚¹ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ–‡æœ¬å†…å®¹ 1<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ–‡æœ¬å†…å®¹ 2<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>

&lt;!-- <span class="hljs-title class_">Vue3</span> å†™æ³•ï¼š<span class="hljs-title class_">Fragment</span> ä½œä¸ºæ ¹èŠ‚ç‚¹ï¼ˆæ— éœ€æ˜¾å¼å£°æ˜ï¼‰ --&gt;
&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ–‡æœ¬å†…å®¹ 1<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>
  &lt;p&gt;æ–‡æœ¬å†…å®¹ <span class="hljs-number">2</span>&amp;lt;/p&amp;gt;
&amp;lt;/template&amp;gt;

&lt;!-- ç¼–è¯‘åé€»è¾‘ï¼ˆç®€åŒ–ç‰ˆï¼‰ --&gt;
<span class="hljs-comment">// Vue3 è‡ªåŠ¨ç”¨ Fragment åŒ…è£¹å¤šæ ¹èŠ‚ç‚¹</span>
<span class="hljs-title function_">createVNode</span>(<span class="hljs-title class_">Fragment</span>, <span class="hljs-literal">null</span>, [
  <span class="hljs-title function_">createVNode</span>(<span class="hljs-string">'p'</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">'æ–‡æœ¬å†…å®¹ 1'</span>),
  <span class="hljs-title function_">createVNode</span>(<span class="hljs-string">'p'</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">'æ–‡æœ¬å†…å®¹ 2'</span>)
])
</code></pre>
<p>Vue3 æ¨¡æ¿ä¸­ï¼Œå¤šæ ¹èŠ‚ç‚¹ä¼šè¢«ç¼–è¯‘å™¨è‡ªåŠ¨åŒ…è£¹ä¸º Fragmentï¼Œæ— éœ€å¼€å‘è€…æ˜¾å¼å£°æ˜ï¼ˆä¹Ÿå¯é€šè¿‡ <code>2. Fragment ä¸æ™®é€šæ ¹èŠ‚ç‚¹çš„æ€§èƒ½å·®å¼‚å†—ä½™çš„æ ¹èŠ‚ç‚¹ä¸ä»…ä¼šå¢åŠ  DOM æ ‘çš„æ·±åº¦ï¼Œè¿˜ä¼šåœ¨è™šæ‹Ÿ DOM æ¯”å¯¹ã€DOM æ›´æ–°æ—¶äº§ç”Ÿé¢å¤–å¼€é”€ï¼šVue2 ä¸­ï¼Œå†—ä½™æ ¹èŠ‚ç‚¹ä¼šå‚ä¸è™šæ‹Ÿ DOM æ¯”å¯¹ï¼Œå³ä½¿å†…éƒ¨å†…å®¹æ— å˜åŒ–ï¼Œä¹Ÿéœ€éå†è¯¥èŠ‚ç‚¹åŠå±æ€§ã€‚Vue3 Fragment ä½œä¸ºè™šæ‹ŸèŠ‚ç‚¹ï¼Œä¸ä¼šç”ŸæˆçœŸå® DOMï¼Œè¿è¡Œæ—¶ä¼šç›´æ¥è·³è¿‡ Fragment èŠ‚ç‚¹çš„æ¯”å¯¹ï¼Œä»…å¤„ç†å…¶å­èŠ‚ç‚¹ï¼Œå‡å°‘æ— æ„ä¹‰çš„éå†å¼€é”€ã€‚</code> <code>3. Fragment é€‚ç”¨åœºæ™¯ä¸æ³¨æ„äº‹é¡¹é€‚ç”¨åœºæ™¯ï¼šå¤šæ ¹èŠ‚ç‚¹æ¨¡æ¿åœºæ™¯ï¼ˆå¦‚è¡¨å•ç»„ä»¶ã€åˆ—è¡¨é¡¹ç»„ä»¶ï¼Œéœ€è¿”å›å¤šä¸ªåŒçº§èŠ‚ç‚¹ï¼‰ã€‚é¿å… DOM å±‚çº§å†—ä½™çš„åœºæ™¯ï¼ˆå¦‚åµŒå¥—è¾ƒæ·±çš„ç»„ä»¶æ ‘ï¼Œå‡å°‘ä¸å¿…è¦çš„çˆ¶å®¹å™¨ï¼‰ã€‚</code>æ³¨æ„äº‹é¡¹ï¼šFragment ä»…æ”¯æŒ <code>key</code> å±æ€§ï¼ˆç”¨äºåˆ—è¡¨æ¸²æŸ“æ—¶çš„èŠ‚ç‚¹å¤ç”¨ï¼‰ï¼Œä¸æ”¯æŒ <code>class</code>ã€<code>style</code> ç­‰å±æ€§ï¼ˆå› æ— çœŸå® DOM èŠ‚ç‚¹æ‰¿è½½ï¼‰ã€‚
<code>äºŒã€æ ¸å¿ƒä¼˜åŒ–ï¼šBlock Tree å—æ ‘æœºåˆ¶ï¼ˆç¼©å°æ¯”å¯¹èŒƒå›´ï¼‰Block Tree æ˜¯ Vue3 ä¸ºè¿›ä¸€æ­¥ä¼˜åŒ–è™šæ‹Ÿ DOM æ¯”å¯¹æ•ˆç‡è®¾è®¡çš„åˆ†å±‚ç»“æ„ã€‚å®ƒåŸºäºâ€œåŠ¨æ€èŠ‚ç‚¹èšé›†â€åŸåˆ™ï¼Œå°†æ¨¡æ¿ä¸­çš„èŠ‚ç‚¹åˆ’åˆ†ä¸ºä¸åŒçš„ Blockï¼ˆå—ï¼‰ï¼Œä»…åŒ…å«åŠ¨æ€èŠ‚ç‚¹æˆ–åŠ¨æ€èŠ‚ç‚¹çˆ¶å®¹å™¨çš„ Block ä¼šå‚ä¸æ¯”å¯¹ï¼Œé™æ€ Block åˆ™ç›´æ¥å¤ç”¨ï¼Œå¤§å¹…ç¼©å°æ¯”å¯¹èŒƒå›´ã€‚</code></p>
<h3 data-id="heading-1">1. Block ä¸æ™®é€š VNode çš„åŒºåˆ«</h3>
<p>åœ¨ Vue3 ç¼–è¯‘åï¼ŒèŠ‚ç‚¹ä¼šè¢«åˆ†ä¸ºä¸¤ç±»ï¼š</p>
<ul>
<li><strong>æ™®é€š VNode</strong>ï¼šé™æ€èŠ‚ç‚¹ï¼ˆç»é™æ€æå‡å¤„ç†ï¼‰ï¼Œä»…åœ¨åˆå§‹åŒ–æ—¶åˆ›å»ºä¸€æ¬¡ï¼Œåç»­æ¸²æŸ“ç›´æ¥å¤ç”¨ï¼Œä¸å‚ä¸æ¯”å¯¹ã€‚</li>
<li><strong>Block VNode</strong>ï¼šæ ‡è®°ä¸º Block çš„èŠ‚ç‚¹ï¼Œå†…éƒ¨åŒ…å«åŠ¨æ€èŠ‚ç‚¹æˆ–åŠ¨æ€å­èŠ‚ç‚¹ï¼Œä¼šå‚ä¸è™šæ‹Ÿ DOM æ¯”å¯¹ï¼Œä½†ä»…æ¯”å¯¹å†…éƒ¨çš„åŠ¨æ€å†…å®¹ï¼ˆç»“åˆ PatchFlagï¼‰ã€‚</li>
</ul>
<p>Block çš„æ ¸å¿ƒç‰¹å¾æ˜¯â€œåŒ…å«åŠ¨æ€å†…å®¹â€ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å°†æ¨¡æ¿ä¸­å«åŠ¨æ€èŠ‚ç‚¹çš„æœ€å°çˆ¶å®¹å™¨æ ‡è®°ä¸º Blockï¼Œå½¢æˆä»¥ Block ä¸ºæ ¸å¿ƒçš„æ ‘çŠ¶ç»“æ„ï¼ˆBlock Treeï¼‰ã€‚</p>
<h3 data-id="heading-2">2. Block Tree æ„å»ºé€»è¾‘ï¼ˆç¼–è¯‘é˜¶æ®µï¼‰</h3>
<p>ç¼–è¯‘å™¨æ„å»º Block Tree çš„æ ¸å¿ƒæ­¥éª¤çš„ï¼š</p>
<ol>
<li><strong>è¯†åˆ«åŠ¨æ€èŠ‚ç‚¹</strong>ï¼šæ‰«ææ¨¡æ¿ï¼Œæ ‡è®°æ‰€æœ‰å«åŠ¨æ€å†…å®¹çš„èŠ‚ç‚¹ï¼ˆå¦‚æ’å€¼ã€åŠ¨æ€ç»‘å®šã€v-if/v-for ç­‰ï¼‰ï¼Œå¹¶ä¸ºå…¶æ‰“ä¸Š PatchFlagã€‚</li>
<li><strong>ç¡®å®š Block è¾¹ç•Œ</strong>ï¼šä»¥åŒ…å«åŠ¨æ€èŠ‚ç‚¹çš„æœ€å°çˆ¶å®¹å™¨ä½œä¸º Block è¾¹ç•Œï¼Œå°†è¯¥çˆ¶å®¹å™¨æ ‡è®°ä¸º Block VNodeï¼Œå…¶å†…éƒ¨çš„é™æ€èŠ‚ç‚¹ä»ä¼šè¢«é™æ€æå‡ï¼ŒåŠ¨æ€èŠ‚ç‚¹åˆ™ä¿ç•™åœ¨ Block å†…éƒ¨ã€‚</li>
<li><strong>æ„å»ºå±‚çº§ç»“æ„</strong>ï¼šè‹¥ Block å†…éƒ¨è¿˜åŒ…å«å…¶ä»–åŠ¨æ€èŠ‚ç‚¹çš„çˆ¶å®¹å™¨ï¼Œä¼šé€’å½’åˆ›å»ºå­ Blockï¼Œæœ€ç»ˆå½¢æˆå¤šå±‚çº§çš„ Block Treeã€‚</li>
</ol>
<pre><code class="hljs language-ts" lang="ts">&lt;!-- æ¨¡æ¿ç¤ºä¾‹ --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span><span class="hljs-comment">&lt;!-- é™æ€çˆ¶å®¹å™¨ï¼Œé Block --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>é™æ€æ ‡é¢˜<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span> <span class="hljs-comment">&lt;!-- é™æ€èŠ‚ç‚¹ï¼Œè¢«æå‡ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"dynamic-wrap"</span>&gt;</span> <span class="hljs-comment">&lt;!-- åŒ…å«åŠ¨æ€èŠ‚ç‚¹ï¼Œæ ‡è®°ä¸º Block --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Hello {{ name }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><span class="hljs-comment">&lt;!-- åŠ¨æ€èŠ‚ç‚¹ï¼ˆTEXT æ ‡è®°ï¼‰ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"activeClass"</span>&gt;</span>ç‚¹å‡»<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span> <span class="hljs-comment">&lt;!-- åŠ¨æ€èŠ‚ç‚¹ï¼ˆCLASS æ ‡è®°ï¼‰ --&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>

&lt;!-- ç¼–è¯‘å <span class="hljs-title class_">Block</span> <span class="hljs-title class_">Tree</span> é€»è¾‘ï¼ˆç®€åŒ–ç‰ˆï¼‰ --&gt;
<span class="hljs-keyword">const</span> _hoisted_1 = <span class="hljs-title function_">createVNode</span>(<span class="hljs-string">'h1'</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">'é™æ€æ ‡é¢˜'</span>) <span class="hljs-comment">// é™æ€æå‡</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">createVNode</span>(<span class="hljs-string">'div'</span>, { <span class="hljs-attr">class</span>: <span class="hljs-string">'container'</span> }, [
    _hoisted_1,
    <span class="hljs-comment">// æ ‡è®°ä¸º Blockï¼Œå†…éƒ¨åŒ…å«åŠ¨æ€èŠ‚ç‚¹</span>
    <span class="hljs-title function_">createBlock</span>(<span class="hljs-string">'div'</span>, { <span class="hljs-attr">class</span>: <span class="hljs-string">'dynamic-wrap'</span> }, [
      <span class="hljs-title function_">createVNode</span>(<span class="hljs-string">'p'</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">`Hello <span class="hljs-subst">${name}</span>`</span>, <span class="hljs-number">1</span> <span class="hljs-comment">/* TEXT */</span>),
      <span class="hljs-title function_">createVNode</span>(<span class="hljs-string">'button'</span>, { <span class="hljs-attr">class</span>: activeClass }, <span class="hljs-string">'ç‚¹å‡»'</span>, <span class="hljs-number">2</span> <span class="hljs-comment">/* CLASS */</span>)
    ])
  ])
}
</code></pre>
<h3 data-id="heading-3">3. Block Tree è¿è¡Œæ—¶ä¼˜åŒ–ï¼šç²¾å‡†æ¯”å¯¹ï¼Œè·³è¿‡é™æ€å±‚çº§</h3>
<p>Vue3 è™šæ‹Ÿ DOM æ¯”å¯¹æ—¶ï¼Œä¼šç›´æ¥éå† Block Treeï¼Œè·³è¿‡æ‰€æœ‰æ™®é€šé™æ€ VNodeï¼Œä»…åœ¨ Block å†…éƒ¨ç»“åˆ PatchFlag æ¯”å¯¹åŠ¨æ€å†…å®¹ï¼Œå®ç°â€œåŒé‡ç²¾å‡†ä¼˜åŒ–â€ï¼š</p>
<ol>
<li><strong>å±‚çº§ç²¾å‡†</strong>ï¼šä»…éå† Block èŠ‚ç‚¹ç»„æˆçš„æ ‘ï¼Œé™æ€èŠ‚ç‚¹æ‰€åœ¨çš„å±‚çº§ç›´æ¥è·³è¿‡ï¼Œæ— éœ€é€å±‚éå†ã€‚</li>
<li><strong>å†…å®¹ç²¾å‡†</strong>ï¼šåœ¨ Block å†…éƒ¨ï¼Œé€šè¿‡ PatchFlag ä»…æ¯”å¯¹åŠ¨æ€å†…å®¹ï¼Œé™æ€å†…å®¹å¤ç”¨å·²æå‡çš„ VNodeã€‚</li>
</ol>
<p>å¯¹æ¯” Vue2 å…¨é‡éå†è™šæ‹Ÿ DOM æ ‘ï¼ŒBlock Tree ä½¿æ¯”å¯¹èŒƒå›´ç¼©å°è‡³â€œä»…åŠ¨æ€å†…å®¹æ‰€åœ¨çš„ Block å±‚çº§â€ï¼Œå°¤å…¶åœ¨å¤æ‚ç»„ä»¶æ ‘ä¸­ï¼Œæ€§èƒ½æå‡æ•ˆæœæ˜¾è‘—ã€‚</p>
<h2 data-id="heading-4">ä¸‰ã€ååŒä¼˜åŒ–ï¼šFragmentã€Block Tree ä¸ PatchFlag çš„è”åŠ¨</h2>
<p>Vue3 çš„ç¼–è¯‘ä¼˜åŒ–å¹¶éå•ä¸€ç‰¹æ€§ï¼Œè€Œæ˜¯ Fragmentã€Block Treeã€PatchFlagã€é™æ€æå‡å››å¤§æŠ€æœ¯ååŒä½œç”¨ï¼Œå½¢æˆå®Œæ•´çš„ä¼˜åŒ–é—­ç¯ï¼š</p>
<ol>
<li><strong>é™æ€æå‡</strong>ï¼šæå–é™æ€èŠ‚ç‚¹ï¼Œé¿å…é‡å¤åˆ›å»ºï¼Œä¸º Block Tree åˆ†å±‚å¥ å®šåŸºç¡€ã€‚</li>
<li><strong>Fragment</strong>ï¼šä½œä¸ºè™šæ‹Ÿæ ¹èŠ‚ç‚¹ï¼Œæ¶ˆé™¤å†—ä½™ DOMï¼Œä½¿ Block Tree å±‚çº§æ›´è´´åˆå®é™…å†…å®¹ç»“æ„ã€‚</li>
<li><strong>Block Tree</strong>ï¼šåˆ’åˆ†åŠ¨æ€å†…å®¹å±‚çº§ï¼Œç¼©å°è™šæ‹Ÿ DOM æ¯”å¯¹çš„èŒƒå›´ï¼Œèšç„¦åŠ¨æ€èŠ‚ç‚¹æ‰€åœ¨å®¹å™¨ã€‚</li>
<li><strong>PatchFlag</strong>ï¼šåœ¨ Block å†…éƒ¨ç²¾å‡†æ ‡è®°åŠ¨æ€å†…å®¹ç±»å‹ï¼Œå®ç° Block å†…çš„é¶å‘æ›´æ–°ã€‚</li>
</ol>
<pre><code class="hljs language-ts" lang="ts">
<span class="hljs-comment">// ååŒä¼˜åŒ–åçš„å®Œæ•´æ¸²æŸ“é€»è¾‘ï¼ˆç®€åŒ–ç‰ˆï¼‰</span>
<span class="hljs-comment">// 1. é™æ€æå‡ï¼šæå–é™æ€èŠ‚ç‚¹</span>
<span class="hljs-keyword">const</span> _hoisted_1 = <span class="hljs-title function_">createVNode</span>(<span class="hljs-string">'p'</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">'é™æ€æ–‡æœ¬'</span>)

<span class="hljs-comment">// 2. Fragment ä½œä¸ºæ ¹èŠ‚ç‚¹ï¼ŒåŒ…è£¹å¤šèŠ‚ç‚¹</span>
<span class="hljs-comment">// 3. Block Treeï¼šdynamic-wrap ä¸º Blockï¼ŒåŒ…å«åŠ¨æ€èŠ‚ç‚¹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">createVNode</span>(<span class="hljs-title class_">Fragment</span>, <span class="hljs-literal">null</span>, [
    _hoisted_1,
    <span class="hljs-title function_">createBlock</span>(<span class="hljs-string">'div'</span>, { <span class="hljs-attr">class</span>: <span class="hljs-string">'dynamic-wrap'</span> }, [
      <span class="hljs-comment">// 4. PatchFlagï¼šæ ‡è®°æ–‡æœ¬åŠ¨æ€å˜åŒ–</span>
      <span class="hljs-title function_">createVNode</span>(<span class="hljs-string">'p'</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">`Hello <span class="hljs-subst">${name}</span>`</span>, <span class="hljs-number">1</span> <span class="hljs-comment">/* TEXT */</span>),
      <span class="hljs-comment">// 4. PatchFlagï¼šæ ‡è®° class åŠ¨æ€å˜åŒ–</span>
      <span class="hljs-title function_">createVNode</span>(<span class="hljs-string">'div'</span>, { :<span class="hljs-keyword">class</span>=<span class="hljs-string">"styleClass"</span> }, <span class="hljs-string">'å†…å®¹'</span>, <span class="hljs-number">2</span> <span class="hljs-comment">/* CLASS */</span>)
    ])
  ])
}

<span class="hljs-comment">// è¿è¡Œæ—¶æ¯”å¯¹é€»è¾‘</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">patchBlock</span>(<span class="hljs-params">block</span>) {
  <span class="hljs-comment">// ä»…éå† Block å†…éƒ¨èŠ‚ç‚¹</span>
  block.<span class="hljs-property">children</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (child.<span class="hljs-property">patchFlag</span>) {
      <span class="hljs-comment">// ç»“åˆ PatchFlag ç²¾å‡†æ›´æ–°åŠ¨æ€å†…å®¹</span>
      <span class="hljs-title function_">updateByPatchFlag</span>(child)
    }
    <span class="hljs-comment">// é™æ€èŠ‚ç‚¹è·³è¿‡æ¯”å¯¹</span>
  })
}
</code></pre>
<h2 data-id="heading-5">å››ã€å®æˆ˜é¿å‘ï¼šBlock Tree ä¸ Fragment ä¼˜åŒ–è¦ç‚¹</h2>
<h3 data-id="heading-6">1. é¿å…è¿‡åº¦æ‹†åˆ† Block</h3>
<p>ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ä¼˜åŒ– Block è¾¹ç•Œï¼Œä½†å¼€å‘è€…éœ€é¿å…åœ¨æ¨¡æ¿ä¸­è¿‡åº¦åµŒå¥—åŠ¨æ€èŠ‚ç‚¹å®¹å™¨ï¼Œå¦åˆ™ä¼šå¯¼è‡´ Block å±‚çº§è¿‡å¤šï¼Œåè€Œå¢åŠ éå†å¼€é”€ã€‚å»ºè®®å°½é‡å°†ç›¸å…³åŠ¨æ€å†…å®¹é›†ä¸­åœ¨åŒä¸€çˆ¶å®¹å™¨ä¸‹ï¼Œå‡å°‘ Block æ•°é‡ã€‚</p>
<h3 data-id="heading-7">2. Fragment ä¸å¯æ»¥ç”¨ key</h3>
<p>ä»…å½“ Fragment ç”¨äº v-for åˆ—è¡¨æ¸²æŸ“æ—¶ï¼Œæ‰éœ€è¦æ·»åŠ  key å±æ€§ï¼›éåˆ—è¡¨åœºæ™¯çš„ Fragment æ— éœ€è®¾ç½® keyï¼Œå¦åˆ™ä¼šå¢åŠ ä¸å¿…è¦çš„æ€§èƒ½å¼€é”€ï¼ˆkey éœ€å‚ä¸èŠ‚ç‚¹å¤ç”¨æ¯”å¯¹ï¼‰ã€‚</p>
<h3 data-id="heading-8">3. åŠ¨æ€æŒ‡ä»¤å¯¹ Block çš„å½±å“</h3>
<p>v-ifã€v-for ç­‰åŠ¨æ€æŒ‡ä»¤ä¼šå¼ºåˆ¶å…¶çˆ¶å®¹å™¨æˆä¸º Blockï¼Œå› è¿™äº›æŒ‡ä»¤ä¼šå¯¼è‡´èŠ‚ç‚¹æ•°é‡ã€é¡ºåºå˜åŒ–ã€‚å¼€å‘ä¸­éœ€åˆç†è§„åˆ’åŠ¨æ€æŒ‡ä»¤çš„ä½ç½®ï¼Œé¿å…å°†å…¶æ”¾åœ¨é¡¶å±‚å®¹å™¨ï¼Œå¯¼è‡´æ•´ä¸ªç»„ä»¶æ ‘æˆä¸ºå•ä¸€ Blockï¼Œä¸§å¤±åˆ†å±‚ä¼˜åŒ–ä¼˜åŠ¿ã€‚</p>
<h3 data-id="heading-9">4. é™æ€å†…å®¹ä¸åŠ¨æ€å†…å®¹åˆ†ç¦»</h3>
<p>å°½é‡å°†é™æ€å†…å®¹ä¸åŠ¨æ€å†…å®¹æ‹†åˆ†åˆ°ä¸åŒå®¹å™¨ä¸­ï¼Œä½¿é™æ€å†…å®¹èƒ½è¢«å……åˆ†æå‡ï¼ŒåŠ¨æ€å†…å®¹é›†ä¸­åœ¨å°‘æ•° Block ä¸­ï¼Œæœ€å¤§åŒ–å‘æŒ¥ Block Tree çš„ä¼˜åŒ–æ•ˆæœã€‚</p>
<h2 data-id="heading-10">äº”ã€æ€§èƒ½æ”¶ç›Šï¼šå®æµ‹æ•°æ®ä¸åœºæ™¯ä»·å€¼</h2>
<p>Vue3 å®˜æ–¹åŸºå‡†æµ‹è¯•åŠå®é™…é¡¹ç›®éªŒè¯æ˜¾ç¤ºï¼ŒBlock Tree ä¸ Fragment ä¼˜åŒ–å¸¦æ¥çš„æ€§èƒ½æå‡æ˜¾è‘—ï¼š</p>
<ul>
<li><strong>å¤æ‚ç»„ä»¶æ ‘</strong>ï¼šè™šæ‹Ÿ DOM æ¯”å¯¹è€—æ—¶é™ä½ 40%~60%ï¼Œå°¤å…¶åµŒå¥—å±‚çº§è¶…è¿‡ 5 å±‚æ—¶ï¼Œä¼˜åŒ–æ•ˆæœæ›´æ˜æ˜¾ã€‚</li>
<li><strong>å¤šæ ¹èŠ‚ç‚¹ç»„ä»¶</strong>ï¼šæ¶ˆé™¤å†—ä½™ DOM åï¼Œåˆå§‹æ¸²æŸ“é€Ÿåº¦æå‡ 20%~30%ï¼ŒDOM æ›´æ–°æ—¶çš„å±‚çº§éå†å¼€é”€å‡å°‘ã€‚</li>
<li><strong>é•¿åˆ—è¡¨åœºæ™¯</strong>ï¼šç»“åˆ v-for ä¸ Block Treeï¼Œä»…æ›´æ–°å˜åŒ–é¡¹æ‰€åœ¨çš„ Blockï¼Œé¿å…å…¨é‡åˆ—è¡¨æ¯”å¯¹ï¼Œæ¸²æŸ“è€—æ—¶é™ä½ 50% ä»¥ä¸Šã€‚</li>
</ul>
<h2 data-id="heading-11">æ€»ç»“</h2>
<p>Fragment æ ¹èŠ‚ç‚¹ä¼˜åŒ–è§£å†³äº†æ¨¡æ¿å¤šæ ¹èŠ‚ç‚¹çš„å†å²ç—›ç‚¹ï¼Œæ¶ˆé™¤äº†å†—ä½™ DOM å±‚çº§ï¼Œä¸ºæ¸²æŸ“ä¼˜åŒ–æ‰«æ¸…äº†ç»“æ„éšœç¢ï¼›Block Tree åˆ™é€šè¿‡ç¼–è¯‘é˜¶æ®µçš„åˆ†å±‚å½’ç±»ï¼Œå°†è™šæ‹Ÿ DOM æ¯”å¯¹ä»â€œå…¨é‡éå†â€å‡çº§ä¸ºâ€œBlock çº§ç²¾å‡†éå†â€ï¼Œå†ç»“åˆ PatchFlag ä¸é™æ€æå‡ï¼Œæ„å»ºèµ· Vue3 é«˜æ•ˆæ¸²æŸ“çš„æ ¸å¿ƒä½“ç³»ã€‚</p>
<p>ç†è§£äºŒè€…çš„åº•å±‚é€»è¾‘ä¸ååŒå…³ç³»ï¼Œä¸ä»…èƒ½å¸®åŠ©æˆ‘ä»¬å†™å‡ºæ›´ç¬¦åˆ Vue3 ä¼˜åŒ–é€»è¾‘çš„æ¨¡æ¿ä»£ç ï¼Œè¿˜èƒ½åœ¨æ€§èƒ½ä¼˜åŒ–åœºæ™¯ä¸­ç²¾å‡†å®šä½é—®é¢˜â€”â€”ä¾‹å¦‚ï¼Œå½“ç»„ä»¶æ¸²æŸ“å¡é¡¿çš„ï¼Œå¯æ£€æŸ¥æ˜¯å¦å­˜åœ¨è¿‡åº¦åµŒå¥—çš„ Blockã€æœªåˆ†ç¦»çš„é™æ€/åŠ¨æ€å†…å®¹ï¼Œæˆ–æ»¥ç”¨å†—ä½™æ ¹èŠ‚ç‚¹ç­‰é—®é¢˜ï¼Œé€šè¿‡è°ƒæ•´æ¨¡æ¿ç»“æ„æœ€å¤§åŒ–å‘æŒ¥ Vue3 çš„ä¼˜åŒ–èƒ½åŠ›ã€‚</p>
<h4 data-id="heading-12">ç›¸å…³æ–‡ç« </h4>
<p><a href="https://juejin.cn/post/7599469598882709519" target="_blank" title="https://juejin.cn/post/7599469598882709519">é¿å‘+å®æˆ˜ï½œVue3 hoistStaticé™æ€æå‡ï¼Œè®©æ¸²æŸ“é€Ÿåº¦ç¿»å€çš„ç§˜å¯†</a></p>
<p><a href="https://juejin.cn/post/7599566082212757556" target="_blank" title="https://juejin.cn/post/7599566082212757556">åƒé€ Vue3 PatchFlagï¼8 å¤§ç±»æ ‡è¯†å«ä¹‰+ç²¾å‡†æ¯”å¯¹é€»è¾‘</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[# å°æ¨¡å‹å´›èµ·ï¼šè¾¹ç¼˜è®¡ç®—å¦‚ä½•è®© AI èµ°å‘ä¸ªäººåŒ–]]></title>    <link>https://juejin.cn/post/7599951933594091530</link>    <guid>https://juejin.cn/post/7599951933594091530</guid>    <pubDate>2026-01-28T02:54:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599951933594091530" data-draft-id="7599963665039441970" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="# å°æ¨¡å‹å´›èµ·ï¼šè¾¹ç¼˜è®¡ç®—å¦‚ä½•è®© AI èµ°å‘ä¸ªäººåŒ–"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,å‰ç«¯,æ¶æ„"/> <meta itemprop="datePublished" content="2026-01-28T02:54:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeonGao"/> <meta itemprop="url" content="https://juejin.cn/user/3976252950591149"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            # å°æ¨¡å‹å´›èµ·ï¼šè¾¹ç¼˜è®¡ç®—å¦‚ä½•è®© AI èµ°å‘ä¸ªäººåŒ–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3976252950591149/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeonGao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:54:33.000Z" title="Wed Jan 28 2026 02:54:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{font-size:24px;display:inline-block;font-weight:700;background:#ef7060;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(239,112,96,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 50px);border-bottom:3px solid #ef7060}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #3e3e3e;margin-top:32px;margin-bottom:32px;height:1px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(27,31,35,.05);color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:JetBranins Mono,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px;background-color:#fdfdfd}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#fdfdfd}.markdown-body a{text-decoration:none;font-weight:700;color:#ef7060;border-bottom:1px solid #ef7060}.markdown-body a:active,.markdown-body a:hover{color:#ef2d26}.markdown-body table tr td,.markdown-body table tr th{border:1px solid #ccc;padding:5px 10px}.markdown-body table{display:block!important;width:auto;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{background:#f0f0f0;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#f8f8f8}.markdown-body blockquote{margin-inline-start:0;margin-inline-end:0;border-left:3px solid #ef7060;background:#fff9f9;padding:1px 20px;margin-top:20px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-light">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>åœ¨è¿‡å»å‡ å¹´ä¸­ï¼Œå¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ä¸»å¯¼äº†äººå·¥æ™ºèƒ½é¢†åŸŸçš„å‘å±•æµªæ½®ã€‚ä» GPT ç³»åˆ—åˆ° Claudeã€Geminiï¼Œè¿™äº›åºå¤§çš„æ¨¡å‹é€šè¿‡å¼ºå¤§çš„æ¨ç†ä¸ç”Ÿæˆèƒ½åŠ›æ¨åŠ¨äº†å„è¡Œå„ä¸šçš„æ™ºèƒ½åŒ–ã€‚ç„¶è€Œï¼Œéšç€æ¨¡å‹è§„æ¨¡æ—¥ç›Šå¢é•¿ï¼Œèµ„æºæ¶ˆè€—ã€éšç§æ³„éœ²ä¸å»¶è¿Ÿé—®é¢˜ä¹Ÿé€æ¸å‡¸æ˜¾ã€‚<br/>
<strong>å°æ¨¡å‹ï¼ˆSmall Modelï¼‰ç»“åˆè¾¹ç¼˜è®¡ç®—ï¼ˆEdge Computingï¼‰</strong> çš„å…´èµ·ï¼Œæ­£ä¸º AI çš„ä¸ªäººåŒ–è½åœ°æä¾›æ–°çš„è·¯å¾„â€”â€”é€šè¿‡åœ¨æœ¬åœ°æˆ–è½»é‡åŒ–ç»ˆç«¯è¿›è¡Œæ¨¡å‹æ¨ç†ï¼Œäººå·¥æ™ºèƒ½ä¸å†æ˜¯äº‘ç«¯å·¨å¤´çš„ä¸“å±ï¼Œè€Œèƒ½çœŸæ­£èµ°è¿›æ¯ä¸€ä¸ªäººçš„è®¾å¤‡ä¸åœºæ™¯ä¸­ã€‚</p>
<hr/>
<h2 data-id="heading-1">ä¸€ã€é—®é¢˜èƒŒæ™¯ï¼šäº‘ç«¯ AI çš„å±€é™</h2>
<p>ä¼ ç»Ÿçš„ AI æ¨ç†å¤§å¤šä¾èµ–äº‘ç«¯çš„å¤§æ¨¡å‹è¿è¡Œï¼Œè¿™ç§æ–¹å¼å­˜åœ¨ä»¥ä¸‹ç—›ç‚¹ï¼š</p>
<ol>
<li><strong>å»¶è¿Ÿé—®é¢˜</strong>ï¼šç”¨æˆ·è¯·æ±‚éœ€ç»è¿‡ç½‘ç»œä¼ è¾“ï¼Œå“åº”æ—¶é—´éš¾ä»¥ä¿éšœã€‚</li>
<li><strong>éšç§é£é™©</strong>ï¼šæ•°æ®éœ€ä¸Šäº‘å¤„ç†ï¼Œå­˜åœ¨è¢«æ³„éœ²æˆ–æ»¥ç”¨çš„éšæ‚£ã€‚</li>
<li><strong>é«˜æ˜‚æˆæœ¬</strong>ï¼šå¤§æ¨¡å‹éœ€è¦å¼ºç®—åŠ›ä¸å·¨é‡èƒ½è€—ï¼Œæ™®é€šä¸ªäººæˆ–ä¸­å°ä¼ä¸šéš¾ä»¥æ‰¿å—ã€‚</li>
</ol>
<p>åœ¨è¿™ç±»èƒŒæ™¯ä¸‹ï¼Œè¾¹ç¼˜è®¡ç®— + å°æ¨¡å‹çš„æ¶æ„åº”è¿è€Œç”Ÿã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ <strong>â€œç®—åŠ›ä¸‹æ²‰â€</strong> â€”â€”å°†è½»é‡åŒ–çš„ AI æ¨¡å‹éƒ¨ç½²åœ¨é è¿‘æ•°æ®æºçš„è®¾å¤‡ç«¯ï¼ˆå¦‚æ‰‹æœºã€æ ‘è“æ´¾ã€IoT è®¾å¤‡ç­‰ï¼‰ï¼Œå®ç°æœ¬åœ°åŒ–æ™ºèƒ½å†³ç­–ä¸æ•°æ®ä¿æŠ¤ã€‚</p>
<hr/>
<h2 data-id="heading-2">äºŒã€æŠ€æœ¯å®ç°åœ¨åœ°ï¼šå°æ¨¡å‹ + è¾¹ç¼˜è®¡ç®—</h2>
<h3 data-id="heading-3">1. å°æ¨¡å‹çš„æ ¸å¿ƒæ€è·¯</h3>
<p>å°æ¨¡å‹å¹¶éâ€œåŠŸèƒ½ç¼©æ°´â€ï¼Œè€Œæ˜¯é€šè¿‡æ¨¡å‹å‹ç¼©ã€é‡åŒ–ä¸è’¸é¦ç­‰æŠ€æœ¯ï¼Œåœ¨ä¿è¯ç²¾åº¦çš„å‰æä¸‹é™ä½èµ„æºå ç”¨ã€‚å¸¸ç”¨æŠ€æœ¯åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>æ¨¡å‹è’¸é¦ï¼ˆKnowledge Distillationï¼‰</strong> ï¼šç”¨å¤§æ¨¡å‹æŒ‡å¯¼å°æ¨¡å‹å­¦ä¹ ã€‚</li>
<li><strong>æƒé‡é‡åŒ–ï¼ˆQuantizationï¼‰</strong> ï¼šå°†æƒé‡ä» 32-bit æµ®ç‚¹é™ä¸º 8-bit æˆ–æ›´ä½ã€‚</li>
<li><strong>å‰ªæï¼ˆPruningï¼‰</strong> ï¼šå»é™¤å†—ä½™ç¥ç»å…ƒä¸è¿æ¥ã€‚</li>
<li><strong>LoRA / QLoRA</strong>ï¼šä½ç§©é€‚é…ï¼Œè®©æ¨¡å‹å¯åœ¨è¾¹ç¼˜è®¾å¤‡ä¸Šå¢é‡å­¦ä¹ ã€‚</li>
</ul>
<h3 data-id="heading-4">2. è¾¹ç¼˜è®¡ç®—çš„æ”¯æ’‘æ¶æ„</h3>
<p>è¾¹ç¼˜è®¡ç®—å¼ºè°ƒ <strong>â€œå°±è¿‘å¤„ç†â€</strong> ï¼šæ•°æ®åœ¨é‡‡é›†ç«¯ï¼ˆè¾¹ç¼˜èŠ‚ç‚¹ï¼‰ç›´æ¥æ‰§è¡Œæ¨ç†ï¼Œè€Œéä¸Šä¼ äº‘ç«¯ã€‚ä¸€ä¸ªå…¸å‹æ¡†æ¶å¦‚ä¸‹å›¾ï¼š</p>
<pre><code class="hljs">ç”¨æˆ·ç»ˆç«¯ â†â†’ è¾¹ç¼˜èŠ‚ç‚¹ï¼ˆè½»é‡æ¨¡å‹æ¨ç†ï¼‰ â†â†’ äº‘ç«¯ï¼ˆå¤§æ¨¡å‹çŸ¥è¯†æ›´æ–°ï¼‰
</code></pre>
<p>è¿™ç§åˆ†å±‚ç­–ç•¥å®ç°äº†æ€§èƒ½ã€éšç§ä¸èƒ½è€—çš„å¹³è¡¡ã€‚</p>
<h3 data-id="heading-5">3. å®æˆ˜ç¤ºä¾‹ï¼šåœ¨æ ‘è“æ´¾ä¸Šè¿è¡Œè½»é‡åŒ–æ¨¡å‹</h3>
<p><strong>ç¤ºä¾‹ï¼šéƒ¨ç½²ä¸€ä¸ªé‡åŒ–ç‰ˆçš„å°å‹è¯­è¨€æ¨¡å‹ï¼ˆå¦‚ TinyLLaMAï¼‰</strong></p>
<p>ä»¥ä¸‹ç¤ºä¾‹ä»£ç æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ <code>transformers</code> ä¸ <code>onnxruntime</code> åœ¨è¾¹ç¼˜è®¾å¤‡ä¸Šéƒ¨ç½²æœ¬åœ°æ¨ç†æ¨¡å‹ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">from transformers import AutoTokenizer, AutoModelForCausalLM
import torch
import onnxruntime as ort

<span class="hljs-comment"># 1. åŠ è½½é‡åŒ–æ¨¡å‹</span>
<span class="hljs-attr">model_name</span> = <span class="hljs-string">"TinyLlama/TinyLlama-1.1B-Chat-v1.0"</span>
<span class="hljs-attr">tokenizer</span> = AutoTokenizer.from_pretrained(model_name)
<span class="hljs-attr">model</span> = AutoModelForCausalLM.from_pretrained(model_name, torch_dtype=torch.qint8)

<span class="hljs-comment"># 2. è¾“å…¥</span>
<span class="hljs-attr">prompt</span> = <span class="hljs-string">"è¯·è§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯è¾¹ç¼˜è®¡ç®—ã€‚"</span>
<span class="hljs-attr">inputs</span> = tokenizer(prompt, return_tensors=<span class="hljs-string">"pt"</span>)

<span class="hljs-comment"># 3. æœ¬åœ°æ¨ç†</span>
with torch.no_grad():
    <span class="hljs-attr">outputs</span> = model.generate(**inputs, max_new_tokens=<span class="hljs-number">80</span>)
print(tokenizer.decode(outputs<span class="hljs-section">[0]</span>, <span class="hljs-attr">skip_special_tokens</span>=<span class="hljs-literal">True</span>))
</code></pre>
<p><strong>ä¼˜åŒ–å»ºè®®ï¼š</strong></p>
<ul>
<li>å¯ä½¿ç”¨ <code>ONNX</code> æˆ– <code>GGUF</code> æ ¼å¼å¯¼å‡ºæ¨¡å‹ä»¥æå‡æ¨ç†é€Ÿåº¦ã€‚</li>
<li>è‹¥è®¾å¤‡å†…å­˜æœ‰é™ï¼Œå¯ç»“åˆ <code>quantization + memory mapping</code> é™ä½å ç”¨ã€‚</li>
<li>å¯¹è¾¹ç¼˜èŠ‚ç‚¹å¯æ¥å…¥è½»é‡ API ç½‘å…³ï¼ˆFastAPI/Flaskï¼‰å®ç°å±€åŸŸç½‘éƒ¨ç½²ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-6">ä¸‰ã€ä¼˜ç¼ºç‚¹ä¸å®æˆ˜åˆ†æ</h2>



































<table><thead><tr><th>ç»´åº¦</th><th>å°æ¨¡å‹ + è¾¹ç¼˜è®¡ç®—</th><th>äº‘ç«¯å¤§æ¨¡å‹</th></tr></thead><tbody><tr><td><strong>å“åº”å»¶è¿Ÿ</strong></td><td>æ¯«ç§’çº§ã€æœ¬åœ°å¤„ç†</td><td>éœ€ç½‘ç»œä¼ è¾“ã€å­˜åœ¨å»¶è¿Ÿ</td></tr><tr><td><strong>éšç§å®‰å…¨</strong></td><td>æ•°æ®ç•™åœ¨æœ¬åœ°ï¼Œé£é™©ä½</td><td>ä¾èµ–äº‘ç«¯ï¼Œæ½œåœ¨æ³„éœ²</td></tr><tr><td><strong>è®¡ç®—æˆæœ¬</strong></td><td>ä½ç®—åŠ›å¯è¿è¡Œ</td><td>éœ€å¤§è§„æ¨¡ GPU é›†ç¾¤</td></tr><tr><td><strong>æ›´æ–°çµæ´»æ€§</strong></td><td>å¯æ ¹æ®ä¸ªäººåœºæ™¯å¾®è°ƒ</td><td>é€šå¸¸ç”±äº‘ç«¯ç»Ÿä¸€ç®¡ç†</td></tr><tr><td><strong>æ™ºèƒ½æ°´å¹³</strong></td><td>æœ‰é™ä½†å¤Ÿç”¨</td><td>æ›´å¼ºçš„ä¸Šä¸‹æ–‡ç†è§£èƒ½åŠ›</td></tr></tbody></table>
<p><strong>å»ºè®®ï¼š</strong></p>
<ul>
<li>å¯¹å®æ—¶æ€§ã€éšç§æ€§è¦æ±‚é«˜çš„åº”ç”¨ï¼ˆå¦‚æ™ºèƒ½å®¶å±…ã€è½¦è½½åŠ©æ‰‹ï¼‰æ¨èè¾¹ç¼˜æ–¹æ¡ˆã€‚</li>
<li>å¯¹å¤æ‚é€»è¾‘ã€è·¨é¢†åŸŸæ¨ç†ä»»åŠ¡å¯é‡‡ç”¨â€œäº‘è¾¹ååŒâ€æ¶æ„ï¼Œå®ç°åŠ¨æ€å¹³è¡¡ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-7">å››ã€ç»“è®ºï¼šAI çš„â€œå»ä¸­å¿ƒåŒ–â€æœªæ¥</h2>
<p>éšç€ç¡¬ä»¶ç®—åŠ›ä¸æ¨¡å‹å‹ç¼©æŠ€æœ¯çš„è¿›æ­¥ï¼ŒAI æ­£ä»â€œä¸­å¿ƒåŒ–çš„äº‘æœåŠ¡â€èµ°å‘ <strong>â€œå»ä¸­å¿ƒåŒ–çš„æ™ºèƒ½èŠ‚ç‚¹â€</strong> ã€‚<br/>
è¾¹ç¼˜è®¡ç®—è®©æ¯ä¸€å°è®¾å¤‡éƒ½èƒ½æˆä¸ºæ™ºèƒ½çš„è½½ä½“ï¼Œè€Œå°æ¨¡å‹çš„å´›èµ·ï¼Œåˆ™è®©è¿™ä¸€æ„¿æ™¯çœŸæ­£å¯è¡Œã€‚æœªæ¥ï¼Œæˆ‘ä»¬æˆ–è®¸ä¸å†éœ€è¦è”ç½‘å³å¯äº«å—æ™ºèƒ½åŠ©æ‰‹ã€è¯­éŸ³è¯†åˆ«ã€å›¾åƒç†è§£ç­‰æœåŠ¡â€”â€”AI å°†æˆä¸º<strong>ä¸ªäººåŒ–ã€ç§å¯†ã€å®‰å…¨ä¸”éšæ‰‹å¯å¾—çš„è®¡ç®—åŠ›å»¶ä¼¸</strong>ã€‚</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¸¦ä½ ç©è½¬é¸¿è’™6 AIæ™ºèƒ½ä½“å¼€å‘ï¼šä»0åˆ°1æ‰“é€ ä½ çš„ä¸“å±AIåŠ©æ‰‹]]></title>    <link>https://juejin.cn/post/7599868109086490666</link>    <guid>https://juejin.cn/post/7599868109086490666</guid>    <pubDate>2026-01-28T02:57:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599868109086490666" data-draft-id="7599929684022067219" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¸¦ä½ ç©è½¬é¸¿è’™6 AIæ™ºèƒ½ä½“å¼€å‘ï¼šä»0åˆ°1æ‰“é€ ä½ çš„ä¸“å±AIåŠ©æ‰‹"/> <meta itemprop="keywords" content="ArkTS,ArkUI,HarmonyOS"/> <meta itemprop="datePublished" content="2026-01-28T02:57:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¨å“¥çˆ±ç¼–ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/2242659450109575"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¸¦ä½ ç©è½¬é¸¿è’™6 AIæ™ºèƒ½ä½“å¼€å‘ï¼šä»0åˆ°1æ‰“é€ ä½ çš„ä¸“å±AIåŠ©æ‰‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2242659450109575/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¨å“¥çˆ±ç¼–ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:57:37.000Z" title="Wed Jan 28 2026 02:57:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯Vå“¥ï¼ä»Šå¤©è¦è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸ªè¶…çº§å¹²è´§â€”â€”å¦‚ä½•åœ¨é¸¿è’™6ï¼ˆAPI21ï¼‰ä¸Šå¼€å‘ä¸€ä¸ªçœŸæ­£èƒ½ç”¨çš„AIæ™ºèƒ½ä½“ã€‚ä¸æ˜¯é‚£ç§ç©å…·çº§åˆ«çš„Demoï¼Œè€Œæ˜¯èƒ½è¯­éŸ³å¯¹è¯ã€èƒ½ç†è§£ä½ æ„å›¾ã€è¿˜èƒ½å¸®ä½ å¹²æ´»çš„æ™ºèƒ½åŠ©æ‰‹ï¼</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ä¸ºä»€ä¹ˆè¦åœ¨é¸¿è’™ä¸ŠåšAIæ™ºèƒ½ä½“ï¼Ÿ</h2>
<p>å…„å¼Ÿä»¬ï¼Œ2026å¹´äº†ï¼ŒAI Agentï¼ˆæ™ºèƒ½ä½“ï¼‰ç»å¯¹æ˜¯æœ€ç«çš„æŠ€æœ¯æ–¹å‘ä¹‹ä¸€ã€‚ä»€ä¹ˆæ˜¯æ™ºèƒ½ä½“ï¼Ÿç®€å•è¯´å°±æ˜¯ï¼š<strong>èƒ½æ„ŸçŸ¥ã€èƒ½æ€è€ƒã€èƒ½è¡ŒåŠ¨çš„AIç¨‹åº</strong>ã€‚</p>
<p>é¸¿è’™6åœ¨AIè¿™å—å¯ä»¥è¯´æ˜¯ä¸‹äº†è¡€æœ¬ï¼š</p>
<ul>
<li><strong>åŸç”ŸAIèƒ½åŠ›</strong>ï¼šMindSpore Liteç«¯ä¾§æ¨ç†å¼•æ“</li>
<li><strong>è¯­éŸ³èƒ½åŠ›</strong>ï¼šASRè¯­éŸ³è¯†åˆ« + TTSè¯­éŸ³åˆæˆ</li>
<li><strong>æ„å›¾è¯†åˆ«</strong>ï¼šæ™ºèƒ½ç†è§£ç”¨æˆ·éœ€æ±‚</li>
<li><strong>å¤§æ¨¡å‹æ¥å…¥</strong>ï¼šè½»æ¾å¯¹æ¥å„ç§LLM API</li>
</ul>
<p>ä»Šå¤©Vå“¥å°±æ‰‹æŠŠæ‰‹å¸¦ä½ åšä¸€ä¸ª<strong>å¤šæ¨¡æ€AIæ™ºèƒ½åŠ©æ‰‹</strong>ï¼Œå®ƒèƒ½ï¼š</p>
<ol>
<li>âœ… è¯­éŸ³å”¤é†’ï¼Œå¼€å£å°±èƒ½èŠ</li>
<li>âœ… æ™ºèƒ½å¯¹è¯ï¼Œæ¥å…¥å¤§æ¨¡å‹</li>
<li>âœ… æ„å›¾è¯†åˆ«ï¼Œç†è§£ä½ æƒ³å¹²å˜›</li>
<li>âœ… æ‰§è¡Œä»»åŠ¡ï¼Œå¸®ä½ æ‰“å¼€åº”ç”¨ã€è®¾ç½®é—¹é’Ÿç­‰</li>
<li>âœ… å¤šè½®è®°å¿†ï¼Œä¸Šä¸‹æ–‡è¿è´¯</li>
</ol>
<p>åºŸè¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šä»£ç ï¼</p>
<hr/>
<h2 data-id="heading-1">äºŒã€é¡¹ç›®æ¶æ„è®¾è®¡</h2>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      AIæ™ºèƒ½ä½“æ¶æ„ï¼ˆVå“¥è®¾è®¡ï¼‰                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚   â”‚  è¯­éŸ³è¾“å…¥   â”‚â”€â”€â”€â–¶â”‚  è¯­éŸ³è¯†åˆ«   â”‚â”€â”€â”€â–¶â”‚  æ„å›¾ç†è§£   â”‚        â”‚
â”‚   â”‚   (ASR)    â”‚    â”‚   Engine    â”‚    â”‚   Engine    â”‚        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                 â”‚               â”‚
â”‚                                                 â–¼               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚   â”‚  è¯­éŸ³è¾“å‡º   â”‚â—€â”€â”€â”€â”‚  å›å¤ç”Ÿæˆ   â”‚â—€â”€â”€â”€â”‚  å¯¹è¯ç®¡ç†   â”‚        â”‚
â”‚   â”‚   (TTS)    â”‚    â”‚   (LLM)    â”‚    â”‚   Agent    â”‚        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                 â”‚               â”‚
â”‚                                                 â–¼               â”‚
â”‚                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚                                        â”‚  ä»»åŠ¡æ‰§è¡Œ   â”‚         â”‚
â”‚                                        â”‚  Actions   â”‚         â”‚
â”‚                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr/>
<h2 data-id="heading-2">ä¸‰ã€é¡¹ç›®åˆ›å»ºä¸é…ç½®</h2>
<h3 data-id="heading-3">æ­¥éª¤1ï¼šåˆ›å»ºé¡¹ç›®</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">DevEco</span> <span class="hljs-string">Studio</span> <span class="hljs-string">â†’</span> <span class="hljs-string">New</span> <span class="hljs-string">Project</span>
<span class="hljs-string">â†’</span> <span class="hljs-string">Empty</span> <span class="hljs-string">Ability</span> <span class="hljs-string">(Stageæ¨¡å‹)</span>
<span class="hljs-string">â†’</span> <span class="hljs-attr">Project name:</span> <span class="hljs-string">VGeAIAgent</span>
<span class="hljs-string">â†’</span> <span class="hljs-attr">Bundle name:</span> <span class="hljs-string">com.vge.aiagent</span>
<span class="hljs-string">â†’</span> <span class="hljs-attr">Compile SDK:</span> <span class="hljs-number">5.0</span><span class="hljs-number">.0</span><span class="hljs-string">(API</span> <span class="hljs-number">12</span><span class="hljs-string">)</span> <span class="hljs-string">æˆ–æ›´é«˜</span>
</code></pre>
<h3 data-id="heading-4">æ­¥éª¤2ï¼šé…ç½® module.json5</h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"module"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"entry"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"entry"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$string:module_desc"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"mainElement"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"EntryAbility"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"deviceTypes"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"phone"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"tablet"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"deliveryWithInstall"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"installationFree"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"pages"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$profile:main_pages"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"abilities"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"EntryAbility"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"srcEntry"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./ets/entryability/EntryAbility.ets"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$string:EntryAbility_desc"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"icon"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$media:icon"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"label"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$string:EntryAbility_label"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"startWindowIcon"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$media:startIcon"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"startWindowBackground"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$color:start_window_background"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"exported"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"skills"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
          <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"entities"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"entity.system.home"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"actions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"action.system.home"</span><span class="hljs-punctuation">]</span>
          <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">]</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"requestPermissions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ohos.permission.MICROPHONE"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"reason"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$string:mic_reason"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"usedScene"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"abilities"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"EntryAbility"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"when"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"inuse"</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ohos.permission.INTERNET"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"reason"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$string:net_reason"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"usedScene"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"abilities"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"EntryAbility"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"when"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"always"</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ohos.permission.DISTRIBUTED_DATASYNC"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"reason"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$string:sync_reason"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"usedScene"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"abilities"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"EntryAbility"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"when"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"always"</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<h2 data-id="heading-5">å››ã€æ ¸å¿ƒä»£ç å®ç°</h2>
<h3 data-id="heading-6">1. æ¶ˆæ¯æ•°æ®æ¨¡å‹ (model/MessageModel.ets)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// entry/src/main/ets/model/MessageModel.ets</span>

<span class="hljs-comment">/**
 * Vå“¥è®¾è®¡çš„æ¶ˆæ¯æ¨¡å‹
 * æ”¯æŒå¤šç§æ¶ˆæ¯ç±»å‹ï¼Œä¸ºåç»­æ‰©å±•é¢„ç•™ç©ºé—´
 */</span>

<span class="hljs-comment">// æ¶ˆæ¯è§’è‰²</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">MessageRole</span> {
  <span class="hljs-variable constant_">USER</span> = <span class="hljs-string">'user'</span>,           <span class="hljs-comment">// ç”¨æˆ·æ¶ˆæ¯</span>
  <span class="hljs-variable constant_">ASSISTANT</span> = <span class="hljs-string">'assistant'</span>, <span class="hljs-comment">// AIåŠ©æ‰‹æ¶ˆæ¯</span>
  <span class="hljs-variable constant_">SYSTEM</span> = <span class="hljs-string">'system'</span>        <span class="hljs-comment">// ç³»ç»Ÿæ¶ˆæ¯</span>
}

<span class="hljs-comment">// æ¶ˆæ¯ç±»å‹</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">MessageType</span> {
  <span class="hljs-variable constant_">TEXT</span> = <span class="hljs-string">'text'</span>,           <span class="hljs-comment">// æ–‡æœ¬æ¶ˆæ¯</span>
  <span class="hljs-variable constant_">VOICE</span> = <span class="hljs-string">'voice'</span>,         <span class="hljs-comment">// è¯­éŸ³æ¶ˆæ¯</span>
  <span class="hljs-variable constant_">ACTION</span> = <span class="hljs-string">'action'</span>,       <span class="hljs-comment">// æ‰§è¡ŒåŠ¨ä½œ</span>
  <span class="hljs-variable constant_">THINKING</span> = <span class="hljs-string">'thinking'</span>    <span class="hljs-comment">// æ€è€ƒä¸­</span>
}

<span class="hljs-comment">// æ„å›¾ç±»å‹</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">IntentType</span> {
  <span class="hljs-variable constant_">CHAT</span> = <span class="hljs-string">'chat'</span>,                    <span class="hljs-comment">// é—²èŠ</span>
  <span class="hljs-variable constant_">OPEN_APP</span> = <span class="hljs-string">'open_app'</span>,            <span class="hljs-comment">// æ‰“å¼€åº”ç”¨</span>
  <span class="hljs-variable constant_">SET_ALARM</span> = <span class="hljs-string">'set_alarm'</span>,          <span class="hljs-comment">// è®¾ç½®é—¹é’Ÿ</span>
  <span class="hljs-variable constant_">SET_REMINDER</span> = <span class="hljs-string">'set_reminder'</span>,    <span class="hljs-comment">// è®¾ç½®æé†’</span>
  <span class="hljs-variable constant_">QUERY_WEATHER</span> = <span class="hljs-string">'query_weather'</span>,  <span class="hljs-comment">// æŸ¥è¯¢å¤©æ°”</span>
  <span class="hljs-variable constant_">QUERY_TIME</span> = <span class="hljs-string">'query_time'</span>,        <span class="hljs-comment">// æŸ¥è¯¢æ—¶é—´</span>
  <span class="hljs-variable constant_">CONTROL_DEVICE</span> = <span class="hljs-string">'control_device'</span>,<span class="hljs-comment">// æ§åˆ¶è®¾å¤‡</span>
  <span class="hljs-variable constant_">UNKNOWN</span> = <span class="hljs-string">'unknown'</span>               <span class="hljs-comment">// æœªçŸ¥æ„å›¾</span>
}

<span class="hljs-comment">// æ¶ˆæ¯å®ä½“</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Message</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;
  <span class="hljs-attr">role</span>: <span class="hljs-title class_">MessageRole</span> = <span class="hljs-title class_">MessageRole</span>.<span class="hljs-property">USER</span>;
  <span class="hljs-attr">type</span>: <span class="hljs-title class_">MessageType</span> = <span class="hljs-title class_">MessageType</span>.<span class="hljs-property">TEXT</span>;
  <span class="hljs-attr">content</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;
  <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
  intent?: <span class="hljs-title class_">IntentType</span>;
  intentParams?: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;;
  isStreaming?: <span class="hljs-built_in">boolean</span>;  <span class="hljs-comment">// æ˜¯å¦æµå¼è¾“å‡ºä¸­</span>

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">init?: Partial&lt;Message&gt;</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = <span class="hljs-string">`msg_<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>_<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random().toString(<span class="hljs-number">36</span>).substr(<span class="hljs-number">2</span>, <span class="hljs-number">9</span>)}</span>`</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">timestamp</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    <span class="hljs-keyword">if</span> (init) {
      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(<span class="hljs-variable language_">this</span>, init);
    }
  }
}

<span class="hljs-comment">// å¯¹è¯ä¸Šä¸‹æ–‡ï¼ˆç”¨äºå¤šè½®å¯¹è¯ï¼‰</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConversationContext</span> {
  <span class="hljs-attr">messages</span>: <span class="hljs-title class_">Message</span>[] = [];
  <span class="hljs-attr">maxHistory</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">10</span>;  <span class="hljs-comment">// æœ€å¤šä¿ç•™10è½®å¯¹è¯</span>

  <span class="hljs-title function_">addMessage</span>(<span class="hljs-attr">message</span>: <span class="hljs-title class_">Message</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">messages</span>.<span class="hljs-title function_">push</span>(message);
    <span class="hljs-comment">// è¶…è¿‡é™åˆ¶åˆ™ç§»é™¤æœ€æ—©çš„æ¶ˆæ¯</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">messages</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxHistory</span> * <span class="hljs-number">2</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">messages</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">messages</span>.<span class="hljs-title function_">slice</span>(-<span class="hljs-variable language_">this</span>.<span class="hljs-property">maxHistory</span> * <span class="hljs-number">2</span>);
    }
  }

  <span class="hljs-title function_">getHistory</span>(): <span class="hljs-title class_">Message</span>[] {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">messages</span>;
  }

  <span class="hljs-title function_">clear</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">messages</span> = [];
  }

  <span class="hljs-comment">// è½¬æ¢ä¸ºLLM APIéœ€è¦çš„æ ¼å¼</span>
  <span class="hljs-title function_">toAPIFormat</span>(): <span class="hljs-title class_">Array</span>&lt;{<span class="hljs-attr">role</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">content</span>: <span class="hljs-built_in">string</span>}&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">messages</span>
      .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">m</span> =&gt;</span> m.<span class="hljs-property">type</span> === <span class="hljs-title class_">MessageType</span>.<span class="hljs-property">TEXT</span>)
      .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">m</span> =&gt;</span> ({
        <span class="hljs-attr">role</span>: m.<span class="hljs-property">role</span>,
        <span class="hljs-attr">content</span>: m.<span class="hljs-property">content</span>
      }));
  }
}
</code></pre>
<h3 data-id="heading-7">2. æ„å›¾è¯†åˆ«å¼•æ“ (engine/IntentEngine.ets)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// entry/src/main/ets/engine/IntentEngine.ets</span>

<span class="hljs-keyword">import</span> { <span class="hljs-title class_">IntentType</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../model/MessageModel'</span>;

<span class="hljs-comment">/**
 * Vå“¥çš„æ„å›¾è¯†åˆ«å¼•æ“
 * ä½¿ç”¨è§„åˆ™+å…³é”®è¯åŒ¹é…ï¼Œç”Ÿäº§ç¯å¢ƒå¯æ¥å…¥NLUæ¨¡å‹
 */</span>

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">IntentRule</span> {
  <span class="hljs-attr">intent</span>: <span class="hljs-title class_">IntentType</span>;
  <span class="hljs-attr">keywords</span>: <span class="hljs-built_in">string</span>[];
  <span class="hljs-attr">patterns</span>: <span class="hljs-title class_">RegExp</span>[];
  extractor?: <span class="hljs-function">(<span class="hljs-params">text: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IntentEngine</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-attr">instance</span>: <span class="hljs-title class_">IntentEngine</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">rules</span>: <span class="hljs-title class_">IntentRule</span>[] = [];

  <span class="hljs-keyword">private</span> <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initRules</span>();
  }

  <span class="hljs-keyword">static</span> <span class="hljs-title function_">getInstance</span>(): <span class="hljs-title class_">IntentEngine</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">IntentEngine</span>.<span class="hljs-property">instance</span>) {
      <span class="hljs-title class_">IntentEngine</span>.<span class="hljs-property">instance</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IntentEngine</span>();
    }
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">IntentEngine</span>.<span class="hljs-property">instance</span>;
  }

  <span class="hljs-comment">/**
   * åˆå§‹åŒ–æ„å›¾è§„åˆ™
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">initRules</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">rules</span> = [
      <span class="hljs-comment">// æ‰“å¼€åº”ç”¨</span>
      {
        <span class="hljs-attr">intent</span>: <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">OPEN_APP</span>,
        <span class="hljs-attr">keywords</span>: [<span class="hljs-string">'æ‰“å¼€'</span>, <span class="hljs-string">'å¯åŠ¨'</span>, <span class="hljs-string">'è¿è¡Œ'</span>, <span class="hljs-string">'å¼€å¯'</span>],
        <span class="hljs-attr">patterns</span>: [
          <span class="hljs-regexp">/æ‰“å¼€(.+?)(?:åº”ç”¨|app|APP)?$/</span>,
          <span class="hljs-regexp">/å¯åŠ¨(.+)/</span>,
          <span class="hljs-regexp">/å¸®æˆ‘å¼€(.+)/</span>
        ],
        <span class="hljs-attr">extractor</span>: <span class="hljs-function">(<span class="hljs-params">text: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
          <span class="hljs-keyword">const</span> <span class="hljs-attr">appNames</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt; = {
            <span class="hljs-string">'ç›¸æœº'</span>: <span class="hljs-string">'com.huawei.camera'</span>,
            <span class="hljs-string">'ç›¸å†Œ'</span>: <span class="hljs-string">'com.huawei.photos'</span>,
            <span class="hljs-string">'è®¾ç½®'</span>: <span class="hljs-string">'com.huawei.settings'</span>,
            <span class="hljs-string">'æ—¥å†'</span>: <span class="hljs-string">'com.huawei.calendar'</span>,
            <span class="hljs-string">'è®¡ç®—å™¨'</span>: <span class="hljs-string">'com.huawei.calculator'</span>,
            <span class="hljs-string">'å¤‡å¿˜å½•'</span>: <span class="hljs-string">'com.huawei.notes'</span>,
            <span class="hljs-string">'éŸ³ä¹'</span>: <span class="hljs-string">'com.huawei.music'</span>,
            <span class="hljs-string">'è§†é¢‘'</span>: <span class="hljs-string">'com.huawei.video'</span>,
            <span class="hljs-string">'æµè§ˆå™¨'</span>: <span class="hljs-string">'com.huawei.browser'</span>,
            <span class="hljs-string">'å¾®ä¿¡'</span>: <span class="hljs-string">'com.tencent.mm'</span>,
            <span class="hljs-string">'æ”¯ä»˜å®'</span>: <span class="hljs-string">'com.eg.android.AlipayGphone'</span>,
            <span class="hljs-string">'æŠ–éŸ³'</span>: <span class="hljs-string">'com.ss.android.ugc.aweme'</span>
          };

          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [name, bundleName] <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(appNames)) {
            <span class="hljs-keyword">if</span> (text.<span class="hljs-title function_">includes</span>(name)) {
              <span class="hljs-keyword">return</span> { <span class="hljs-attr">appName</span>: name, <span class="hljs-attr">bundleName</span>: bundleName };
            }
          }
          <span class="hljs-keyword">return</span> {};
        }
      },

      <span class="hljs-comment">// è®¾ç½®é—¹é’Ÿ</span>
      {
        <span class="hljs-attr">intent</span>: <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">SET_ALARM</span>,
        <span class="hljs-attr">keywords</span>: [<span class="hljs-string">'é—¹é’Ÿ'</span>, <span class="hljs-string">'å«æˆ‘'</span>, <span class="hljs-string">'æé†’æˆ‘èµ·åºŠ'</span>, <span class="hljs-string">'å®šä¸ªé—¹é’Ÿ'</span>],
        <span class="hljs-attr">patterns</span>: [
          <span class="hljs-regexp">/(\d{1,2})[ç‚¹:ï¼š](\d{0,2}).*(?:é—¹é’Ÿ|å«æˆ‘|èµ·åºŠ)/</span>,
          <span class="hljs-regexp">/(?:æ˜å¤©|åå¤©)?(?:æ—©ä¸Š|ä¸Šåˆ|ä¸­åˆ|ä¸‹åˆ|æ™šä¸Š)?(\d{1,2})[ç‚¹:ï¼š]?(\d{0,2})?.*(?:é—¹é’Ÿ|å«æˆ‘)/</span>,
          <span class="hljs-regexp">/è®¾.*é—¹é’Ÿ.*(\d{1,2})[ç‚¹:ï¼š](\d{0,2})?/</span>
        ],
        <span class="hljs-attr">extractor</span>: <span class="hljs-function">(<span class="hljs-params">text: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
          <span class="hljs-keyword">const</span> timeMatch = text.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/(\d{1,2})[ç‚¹:ï¼š](\d{0,2})?/</span>);
          <span class="hljs-keyword">if</span> (timeMatch) {
            <span class="hljs-keyword">const</span> hour = timeMatch[<span class="hljs-number">1</span>];
            <span class="hljs-keyword">const</span> minute = timeMatch[<span class="hljs-number">2</span>] || <span class="hljs-string">'00'</span>;
            <span class="hljs-keyword">return</span> { hour, minute };
          }
          <span class="hljs-keyword">return</span> {};
        }
      },

      <span class="hljs-comment">// è®¾ç½®æé†’</span>
      {
        <span class="hljs-attr">intent</span>: <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">SET_REMINDER</span>,
        <span class="hljs-attr">keywords</span>: [<span class="hljs-string">'æé†’æˆ‘'</span>, <span class="hljs-string">'åˆ«å¿˜äº†'</span>, <span class="hljs-string">'è®°å¾—'</span>],
        <span class="hljs-attr">patterns</span>: [
          <span class="hljs-regexp">/(\d+)(?:åˆ†é’Ÿ|å°æ—¶)åæé†’æˆ‘(.+)/</span>,
          <span class="hljs-regexp">/æé†’æˆ‘(.+)/</span>,
          <span class="hljs-regexp">/(\d{1,2})[ç‚¹:ï¼š](\d{0,2})?æé†’æˆ‘(.+)/</span>
        ],
        <span class="hljs-attr">extractor</span>: <span class="hljs-function">(<span class="hljs-params">text: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
          <span class="hljs-comment">// æå–æ—¶é—´å’Œå†…å®¹</span>
          <span class="hljs-keyword">const</span> minuteMatch = text.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/(\d+)åˆ†é’Ÿåæé†’æˆ‘(.+)/</span>);
          <span class="hljs-keyword">if</span> (minuteMatch) {
            <span class="hljs-keyword">return</span> {
              <span class="hljs-attr">delayMinutes</span>: minuteMatch[<span class="hljs-number">1</span>],
              <span class="hljs-attr">content</span>: minuteMatch[<span class="hljs-number">2</span>]
            };
          }

          <span class="hljs-keyword">const</span> hourMatch = text.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/(\d+)å°æ—¶åæé†’æˆ‘(.+)/</span>);
          <span class="hljs-keyword">if</span> (hourMatch) {
            <span class="hljs-keyword">return</span> {
              <span class="hljs-attr">delayMinutes</span>: <span class="hljs-title class_">String</span>(<span class="hljs-built_in">parseInt</span>(hourMatch[<span class="hljs-number">1</span>]) * <span class="hljs-number">60</span>),
              <span class="hljs-attr">content</span>: hourMatch[<span class="hljs-number">2</span>]
            };
          }

          <span class="hljs-keyword">const</span> contentMatch = text.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/æé†’æˆ‘(.+)/</span>);
          <span class="hljs-keyword">if</span> (contentMatch) {
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">content</span>: contentMatch[<span class="hljs-number">1</span>] };
          }

          <span class="hljs-keyword">return</span> {};
        }
      },

      <span class="hljs-comment">// æŸ¥è¯¢å¤©æ°”</span>
      {
        <span class="hljs-attr">intent</span>: <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">QUERY_WEATHER</span>,
        <span class="hljs-attr">keywords</span>: [<span class="hljs-string">'å¤©æ°”'</span>, <span class="hljs-string">'ä¸‹é›¨'</span>, <span class="hljs-string">'æ¸©åº¦'</span>, <span class="hljs-string">'æ°”æ¸©'</span>, <span class="hljs-string">'ç©¿ä»€ä¹ˆ'</span>],
        <span class="hljs-attr">patterns</span>: [
          <span class="hljs-regexp">/(.+?)(?:çš„)?å¤©æ°”/</span>,
          <span class="hljs-regexp">/(?:ä»Šå¤©|æ˜å¤©|åå¤©).*(?:å¤©æ°”|ä¸‹é›¨|æ¸©åº¦)/</span>,
          <span class="hljs-regexp">/è¦ä¸è¦å¸¦ä¼/</span>
        ],
        <span class="hljs-attr">extractor</span>: <span class="hljs-function">(<span class="hljs-params">text: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
          <span class="hljs-keyword">const</span> cityMatch = text.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/(.{2,4}?)(?:çš„)?å¤©æ°”/</span>);
          <span class="hljs-keyword">if</span> (cityMatch &amp;&amp; ![<span class="hljs-string">'ä»Šå¤©'</span>, <span class="hljs-string">'æ˜å¤©'</span>, <span class="hljs-string">'åå¤©'</span>, <span class="hljs-string">'è¿™é‡Œ'</span>, <span class="hljs-string">'ç°åœ¨'</span>].<span class="hljs-title function_">includes</span>(cityMatch[<span class="hljs-number">1</span>])) {
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">city</span>: cityMatch[<span class="hljs-number">1</span>] };
          }
          <span class="hljs-keyword">return</span> { <span class="hljs-attr">city</span>: <span class="hljs-string">'åŒ—äº¬'</span> };  <span class="hljs-comment">// é»˜è®¤åŸå¸‚</span>
        }
      },

      <span class="hljs-comment">// æŸ¥è¯¢æ—¶é—´</span>
      {
        <span class="hljs-attr">intent</span>: <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">QUERY_TIME</span>,
        <span class="hljs-attr">keywords</span>: [<span class="hljs-string">'å‡ ç‚¹'</span>, <span class="hljs-string">'æ—¶é—´'</span>, <span class="hljs-string">'æ—¥æœŸ'</span>, <span class="hljs-string">'æ˜ŸæœŸå‡ '</span>, <span class="hljs-string">'ä»Šå¤©å‡ å·'</span>],
        <span class="hljs-attr">patterns</span>: [
          <span class="hljs-regexp">/ç°åœ¨å‡ ç‚¹/</span>,
          <span class="hljs-regexp">/ä»€ä¹ˆæ—¶é—´/</span>,
          <span class="hljs-regexp">/ä»Šå¤©.*(?:å‡ å·|æ˜ŸæœŸå‡ |å‘¨å‡ )/</span>
        ],
        <span class="hljs-attr">extractor</span>: <span class="hljs-function">() =&gt;</span> ({})
      },

      <span class="hljs-comment">// æ§åˆ¶è®¾å¤‡</span>
      {
        <span class="hljs-attr">intent</span>: <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">CONTROL_DEVICE</span>,
        <span class="hljs-attr">keywords</span>: [<span class="hljs-string">'æ‰“å¼€ç¯'</span>, <span class="hljs-string">'å…³ç¯'</span>, <span class="hljs-string">'å¼€ç¯'</span>, <span class="hljs-string">'ç©ºè°ƒ'</span>, <span class="hljs-string">'ç”µè§†'</span>, <span class="hljs-string">'çª—å¸˜'</span>],
        <span class="hljs-attr">patterns</span>: [
          <span class="hljs-regexp">/(æ‰“å¼€|å…³é—­|å¼€|å…³)(.+?)(?:ç¯|ç©ºè°ƒ|ç”µè§†|çª—å¸˜)/</span>,
          <span class="hljs-regexp">/æŠŠ(.+?)(æ‰“å¼€|å…³é—­|å¼€|å…³)/</span>,
          <span class="hljs-regexp">/(.+?)(?:è°ƒåˆ°|è®¾ç½®ä¸º?)(\d+)åº¦/</span>
        ],
        <span class="hljs-attr">extractor</span>: <span class="hljs-function">(<span class="hljs-params">text: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
          <span class="hljs-keyword">const</span> actionMatch = text.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/(æ‰“å¼€|å…³é—­|å¼€|å…³)(.+)/</span>);
          <span class="hljs-keyword">if</span> (actionMatch) {
            <span class="hljs-keyword">return</span> {
              <span class="hljs-attr">action</span>: actionMatch[<span class="hljs-number">1</span>].<span class="hljs-title function_">includes</span>(<span class="hljs-string">'å¼€'</span>) ? <span class="hljs-string">'on'</span> : <span class="hljs-string">'off'</span>,
              <span class="hljs-attr">device</span>: actionMatch[<span class="hljs-number">2</span>]
            };
          }
          <span class="hljs-keyword">return</span> {};
        }
      }
    ];
  }

  <span class="hljs-comment">/**
   * è¯†åˆ«ç”¨æˆ·æ„å›¾
   */</span>
  <span class="hljs-title function_">recognize</span>(<span class="hljs-attr">text</span>: <span class="hljs-built_in">string</span>): { <span class="hljs-attr">intent</span>: <span class="hljs-title class_">IntentType</span>; <span class="hljs-attr">params</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;; <span class="hljs-attr">confidence</span>: <span class="hljs-built_in">number</span> } {
    <span class="hljs-keyword">const</span> normalizedText = text.<span class="hljs-title function_">toLowerCase</span>().<span class="hljs-title function_">trim</span>();

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> rule <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">rules</span>) {
      <span class="hljs-comment">// å…³é”®è¯åŒ¹é…</span>
      <span class="hljs-keyword">const</span> keywordMatch = rule.<span class="hljs-property">keywords</span>.<span class="hljs-title function_">some</span>(<span class="hljs-function"><span class="hljs-params">kw</span> =&gt;</span> normalizedText.<span class="hljs-title function_">includes</span>(kw));

      <span class="hljs-comment">// æ­£åˆ™åŒ¹é…</span>
      <span class="hljs-keyword">const</span> patternMatch = rule.<span class="hljs-property">patterns</span>.<span class="hljs-title function_">some</span>(<span class="hljs-function"><span class="hljs-params">pattern</span> =&gt;</span> pattern.<span class="hljs-title function_">test</span>(normalizedText));

      <span class="hljs-keyword">if</span> (keywordMatch || patternMatch) {
        <span class="hljs-keyword">const</span> params = rule.<span class="hljs-property">extractor</span> ? rule.<span class="hljs-title function_">extractor</span>(normalizedText) : {};
        <span class="hljs-keyword">const</span> confidence = keywordMatch &amp;&amp; patternMatch ? <span class="hljs-number">0.95</span> : <span class="hljs-number">0.75</span>;

        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`[IntentEngine] è¯†åˆ«ç»“æœ: <span class="hljs-subst">${rule.intent}</span>, ç½®ä¿¡åº¦: <span class="hljs-subst">${confidence}</span>`</span>);
        <span class="hljs-keyword">return</span> {
          <span class="hljs-attr">intent</span>: rule.<span class="hljs-property">intent</span>,
          params,
          confidence
        };
      }
    }

    <span class="hljs-comment">// é»˜è®¤ä¸ºé—²èŠ</span>
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">intent</span>: <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">CHAT</span>,
      <span class="hljs-attr">params</span>: {},
      <span class="hljs-attr">confidence</span>: <span class="hljs-number">0.5</span>
    };
  }
}
</code></pre>
<h3 data-id="heading-8">3. å¤§æ¨¡å‹å¯¹è¯æœåŠ¡ (service/LLMService.ets)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// entry/src/main/ets/service/LLMService.ets</span>

<span class="hljs-keyword">import</span> { http } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ConversationContext</span>, <span class="hljs-title class_">Message</span>, <span class="hljs-title class_">MessageRole</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../model/MessageModel'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;

<span class="hljs-comment">/**
 * Vå“¥çš„LLMæœåŠ¡å°è£…
 * æ”¯æŒå¤šç§å¤§æ¨¡å‹APIï¼Œè¿™é‡Œä»¥é€šç”¨æ ¼å¼ä¸ºä¾‹
 */</span>

<span class="hljs-comment">// LLMé…ç½®æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">LLMConfig</span> {
  <span class="hljs-attr">apiUrl</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">apiKey</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">model</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">maxTokens</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">temperature</span>: <span class="hljs-built_in">number</span>;
}

<span class="hljs-comment">// APIè¯·æ±‚æ ¼å¼</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ChatCompletionRequest</span> {
  <span class="hljs-attr">model</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">messages</span>: <span class="hljs-title class_">Array</span>&lt;{ <span class="hljs-attr">role</span>: <span class="hljs-built_in">string</span>; <span class="hljs-attr">content</span>: <span class="hljs-built_in">string</span> }&gt;;
  <span class="hljs-attr">max_tokens</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">temperature</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">stream</span>: <span class="hljs-built_in">boolean</span>;
}

<span class="hljs-comment">// APIå“åº”æ ¼å¼</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ChatCompletionResponse</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">choices</span>: <span class="hljs-title class_">Array</span>&lt;{
    <span class="hljs-attr">message</span>: {
      <span class="hljs-attr">role</span>: <span class="hljs-built_in">string</span>;
      <span class="hljs-attr">content</span>: <span class="hljs-built_in">string</span>;
    };
    <span class="hljs-attr">finish_reason</span>: <span class="hljs-built_in">string</span>;
  }&gt;;
  <span class="hljs-attr">usage</span>: {
    <span class="hljs-attr">prompt_tokens</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">completion_tokens</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">total_tokens</span>: <span class="hljs-built_in">number</span>;
  };
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LLMService</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-attr">instance</span>: <span class="hljs-title class_">LLMService</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">config</span>: <span class="hljs-title class_">LLMConfig</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">systemPrompt</span>: <span class="hljs-built_in">string</span>;

  <span class="hljs-keyword">private</span> <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// é»˜è®¤é…ç½®ï¼ˆå®é™…ä½¿ç”¨æ—¶æ›¿æ¢ä¸ºä½ çš„APIä¿¡æ¯ï¼‰</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = {
      <span class="hljs-attr">apiUrl</span>: <span class="hljs-string">'https://api.openai.com/v1/chat/completions'</span>,  <span class="hljs-comment">// æˆ–å…¶ä»–å…¼å®¹API</span>
      <span class="hljs-attr">apiKey</span>: <span class="hljs-string">'your-api-key-here'</span>,  <span class="hljs-comment">// æ›¿æ¢ä¸ºä½ çš„API Key</span>
      <span class="hljs-attr">model</span>: <span class="hljs-string">'gpt-3.5-turbo'</span>,
      <span class="hljs-attr">maxTokens</span>: <span class="hljs-number">2048</span>,
      <span class="hljs-attr">temperature</span>: <span class="hljs-number">0.7</span>
    };

    <span class="hljs-comment">// ç³»ç»Ÿæç¤ºè¯ - Vå“¥ç²¾å¿ƒè°ƒæ•™</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">systemPrompt</span> = <span class="hljs-string">`ä½ æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨é¸¿è’™ç³»ç»Ÿä¸Šçš„AIæ™ºèƒ½åŠ©æ‰‹ï¼Œåå«"å°VåŠ©æ‰‹"ã€‚

ä½ çš„ç‰¹ç‚¹ï¼š
1. å‹å¥½ã€å¹½é»˜ã€ä¸“ä¸š
2. å›ç­”ç®€æ´æœ‰åŠ›ï¼Œä¸å•°å—¦
3. èƒ½ç†è§£ç”¨æˆ·æ„å›¾ï¼Œç»™å‡ºå®ç”¨å»ºè®®
4. ç†Ÿæ‚‰é¸¿è’™ç”Ÿæ€å’Œåä¸ºè®¾å¤‡
5. åœ¨é€‚å½“æ—¶å€™ä½¿ç”¨emojiå¢åŠ äº²å’ŒåŠ›

ä½ å¯ä»¥å¸®ç”¨æˆ·ï¼š
- å›ç­”å„ç§é—®é¢˜
- é—²èŠè§£é—·
- æä¾›å»ºè®®å’Œå¸®åŠ©
- è§£é‡ŠæŠ€æœ¯æ¦‚å¿µ

è¯·ç”¨ä¸­æ–‡å›å¤ï¼Œä¿æŒå›ç­”åœ¨100å­—ä»¥å†…ï¼ˆé™¤éç”¨æˆ·æ˜ç¡®è¦æ±‚è¯¦ç»†è§£é‡Šï¼‰ã€‚`</span>;
  }

  <span class="hljs-keyword">static</span> <span class="hljs-title function_">getInstance</span>(): <span class="hljs-title class_">LLMService</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">LLMService</span>.<span class="hljs-property">instance</span>) {
      <span class="hljs-title class_">LLMService</span>.<span class="hljs-property">instance</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LLMService</span>();
    }
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">LLMService</span>.<span class="hljs-property">instance</span>;
  }

  <span class="hljs-comment">/**
   * æ›´æ–°é…ç½®
   */</span>
  <span class="hljs-title function_">updateConfig</span>(<span class="hljs-attr">config</span>: <span class="hljs-title class_">Partial</span>&lt;<span class="hljs-title class_">LLMConfig</span>&gt;): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = { ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>, ...config };
  }

  <span class="hljs-comment">/**
   * å‘é€å¯¹è¯è¯·æ±‚
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">chat</span>(<span class="hljs-attr">userMessage</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">context</span>: <span class="hljs-title class_">ConversationContext</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span>&gt; {
    <span class="hljs-comment">// æ„å»ºæ¶ˆæ¯å†å²</span>
    <span class="hljs-keyword">const</span> <span class="hljs-attr">messages</span>: <span class="hljs-title class_">Array</span>&lt;{ <span class="hljs-attr">role</span>: <span class="hljs-built_in">string</span>; <span class="hljs-attr">content</span>: <span class="hljs-built_in">string</span> }&gt; = [
      { <span class="hljs-attr">role</span>: <span class="hljs-string">'system'</span>, <span class="hljs-attr">content</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">systemPrompt</span> },
      ...context.<span class="hljs-title function_">toAPIFormat</span>(),
      { <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span>, <span class="hljs-attr">content</span>: userMessage }
    ];

    <span class="hljs-keyword">const</span> <span class="hljs-attr">requestData</span>: <span class="hljs-title class_">ChatCompletionRequest</span> = {
      <span class="hljs-attr">model</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">model</span>,
      <span class="hljs-attr">messages</span>: messages,
      <span class="hljs-attr">max_tokens</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">maxTokens</span>,
      <span class="hljs-attr">temperature</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">temperature</span>,
      <span class="hljs-attr">stream</span>: <span class="hljs-literal">false</span>
    };

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> httpRequest = http.<span class="hljs-title function_">createHttp</span>();

      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> httpRequest.<span class="hljs-title function_">request</span>(
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">apiUrl</span>,
        {
          <span class="hljs-attr">method</span>: http.<span class="hljs-property">RequestMethod</span>.<span class="hljs-property">POST</span>,
          <span class="hljs-attr">header</span>: {
            <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
            <span class="hljs-string">'Authorization'</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.config.apiKey}</span>`</span>
          },
          <span class="hljs-attr">extraData</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(requestData),
          <span class="hljs-attr">connectTimeout</span>: <span class="hljs-number">30000</span>,
          <span class="hljs-attr">readTimeout</span>: <span class="hljs-number">60000</span>
        }
      );

      httpRequest.<span class="hljs-title function_">destroy</span>();

      <span class="hljs-keyword">if</span> (response.<span class="hljs-property">responseCode</span> === <span class="hljs-number">200</span>) {
        <span class="hljs-keyword">const</span> result = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(response.<span class="hljs-property">result</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>) <span class="hljs-keyword">as</span> <span class="hljs-title class_">ChatCompletionResponse</span>;
        <span class="hljs-keyword">const</span> content = result.<span class="hljs-property">choices</span>[<span class="hljs-number">0</span>]?.<span class="hljs-property">message</span>?.<span class="hljs-property">content</span> || <span class="hljs-string">'æŠ±æ­‰ï¼Œæˆ‘æ²¡æœ‰ç†è§£ä½ çš„æ„æ€'</span>;
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`[LLMService] å“åº”æˆåŠŸï¼ŒTokenä½¿ç”¨: <span class="hljs-subst">${result.usage?.total_tokens}</span>`</span>);
        <span class="hljs-keyword">return</span> content;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[LLMService] APIé”™è¯¯: <span class="hljs-subst">${response.responseCode}</span>`</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getFallbackResponse</span>(userMessage);
      }
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-keyword">const</span> error = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[LLMService] è¯·æ±‚å¤±è´¥: <span class="hljs-subst">${error.code}</span> - <span class="hljs-subst">${error.message}</span>`</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getFallbackResponse</span>(userMessage);
    }
  }

  <span class="hljs-comment">/**
   * ç¦»çº¿å…œåº•å›å¤ï¼ˆå½“APIä¸å¯ç”¨æ—¶ï¼‰
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">getFallbackResponse</span>(<span class="hljs-attr">userMessage</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">string</span> {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">fallbackResponses</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>[]&gt; = {
      <span class="hljs-string">'ä½ å¥½'</span>: [<span class="hljs-string">'ä½ å¥½å‘€ï¼æœ‰ä»€ä¹ˆå¯ä»¥å¸®ä½ çš„ï¼Ÿ'</span>, <span class="hljs-string">'å—¨ï¼æˆ‘æ˜¯å°VåŠ©æ‰‹ï¼Œå¾ˆé«˜å…´è§åˆ°ä½ ï¼'</span>],
      <span class="hljs-string">'è°¢è°¢'</span>: [<span class="hljs-string">'ä¸å®¢æ°”ï¼éšæ—¶ä¸ºä½ æœåŠ¡~'</span>, <span class="hljs-string">'åº”è¯¥çš„ï¼Œè¿˜æœ‰ä»€ä¹ˆéœ€è¦å¸®åŠ©çš„å—ï¼Ÿ'</span>],
      <span class="hljs-string">'å†è§'</span>: [<span class="hljs-string">'å†è§ï¼æœŸå¾…ä¸‹æ¬¡èŠå¤©~'</span>, <span class="hljs-string">'æ‹œæ‹œï¼Œæœ‰äº‹éšæ—¶æ‰¾æˆ‘å“¦ï¼'</span>],
      <span class="hljs-string">'ä½ æ˜¯è°'</span>: [<span class="hljs-string">'æˆ‘æ˜¯å°VåŠ©æ‰‹ï¼Œè¿è¡Œåœ¨é¸¿è’™ç³»ç»Ÿä¸Šçš„AIåŠ©æ‰‹ï¼'</span>, <span class="hljs-string">'æˆ‘å«å°Vï¼Œæ˜¯Vå“¥æ‰“é€ çš„æ™ºèƒ½åŠ©æ‰‹~'</span>],
      <span class="hljs-string">'ä½ èƒ½åšä»€ä¹ˆ'</span>: [<span class="hljs-string">'æˆ‘èƒ½é™ªä½ èŠå¤©ã€å›ç­”é—®é¢˜ã€å¸®ä½ æ‰“å¼€åº”ç”¨ã€è®¾ç½®æé†’ç­‰ç­‰ï¼è¯•è¯•çœ‹å§~'</span>, 
                   <span class="hljs-string">'æˆ‘å¯ä»¥ï¼šé—²èŠè§£é—·ã€å›ç­”é—®é¢˜ã€æ§åˆ¶è®¾å¤‡ã€è®¾ç½®é—¹é’Ÿæé†’...åŠŸèƒ½å¤šå¤šï¼'</span>]
    };

    <span class="hljs-comment">// å…³é”®è¯åŒ¹é…</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [keyword, responses] <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(fallbackResponses)) {
      <span class="hljs-keyword">if</span> (userMessage.<span class="hljs-title function_">includes</span>(keyword)) {
        <span class="hljs-keyword">return</span> responses[<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * responses.<span class="hljs-property">length</span>)];
      }
    }

    <span class="hljs-comment">// é»˜è®¤å›å¤</span>
    <span class="hljs-keyword">const</span> defaultResponses = [
      <span class="hljs-string">'æˆ‘ç°åœ¨ç½‘ç»œä¸å¤ªå¥½ï¼Œç¨åå†è¯•è¯•å§~'</span>,
      <span class="hljs-string">'è®©æˆ‘æƒ³æƒ³... ä½ èƒ½æ¢ä¸ªæ–¹å¼é—®æˆ‘å—ï¼Ÿ'</span>,
      <span class="hljs-string">'æŠ±æ­‰ï¼Œæˆ‘æ²¡å¤ªç†è§£ï¼Œèƒ½å†è¯´ä¸€éå—ï¼Ÿ'</span>,
      <span class="hljs-string">'ç½‘ç»œå¼€å°å·®äº†ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥ç»§ç»­èŠåˆ«çš„ï¼'</span>
    ];

    <span class="hljs-keyword">return</span> defaultResponses[<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * defaultResponses.<span class="hljs-property">length</span>)];
  }

  <span class="hljs-comment">/**
   * æµå¼å¯¹è¯ï¼ˆæ”¯æŒæ‰“å­—æœºæ•ˆæœï¼‰
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">chatStream</span>(
    <span class="hljs-attr">userMessage</span>: <span class="hljs-built_in">string</span>,
    <span class="hljs-attr">context</span>: <span class="hljs-title class_">ConversationContext</span>,
    <span class="hljs-attr">onChunk</span>: <span class="hljs-function">(<span class="hljs-params">chunk: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>,
    <span class="hljs-attr">onComplete</span>: <span class="hljs-function">(<span class="hljs-params">fullText: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>
  ): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-comment">// ç®€åŒ–å®ç°ï¼šæ¨¡æ‹Ÿæµå¼è¾“å‡º</span>
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">chat</span>(userMessage, context);

    <span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> interval = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (index &lt; response.<span class="hljs-property">length</span>) {
        <span class="hljs-title function_">onChunk</span>(response[index]);
        index++;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-built_in">clearInterval</span>(interval);
        <span class="hljs-title function_">onComplete</span>(response);
      }
    }, <span class="hljs-number">30</span>);  <span class="hljs-comment">// æ¯30msè¾“å‡ºä¸€ä¸ªå­—ç¬¦</span>
  }
}
</code></pre>
<h3 data-id="heading-9">4. è¯­éŸ³æœåŠ¡å°è£… (service/VoiceService.ets)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// entry/src/main/ets/service/VoiceService.ets</span>

<span class="hljs-keyword">import</span> { speechRecognizer } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CoreSpeechKit'</span>;
<span class="hljs-keyword">import</span> { textToSpeech } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CoreSpeechKit'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;
<span class="hljs-keyword">import</span> { abilityAccessCtrl, <span class="hljs-title class_">Permissions</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;

<span class="hljs-comment">/**
 * Vå“¥çš„è¯­éŸ³æœåŠ¡å°è£…
 * æ•´åˆASRè¯­éŸ³è¯†åˆ« + TTSè¯­éŸ³åˆæˆ
 */</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VoiceService</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-attr">instance</span>: <span class="hljs-title class_">VoiceService</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">asrEngine</span>: speechRecognizer.<span class="hljs-property">SpeechRecognitionEngine</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">ttsEngine</span>: textToSpeech.<span class="hljs-property">TextToSpeechEngine</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">isListening</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;

  <span class="hljs-keyword">private</span> <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {}

  <span class="hljs-keyword">static</span> <span class="hljs-title function_">getInstance</span>(): <span class="hljs-title class_">VoiceService</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">VoiceService</span>.<span class="hljs-property">instance</span>) {
      <span class="hljs-title class_">VoiceService</span>.<span class="hljs-property">instance</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">VoiceService</span>();
    }
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">VoiceService</span>.<span class="hljs-property">instance</span>;
  }

  <span class="hljs-comment">/**
   * è¯·æ±‚éº¦å…‹é£æƒé™
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">requestPermission</span>(<span class="hljs-attr">context</span>: <span class="hljs-title class_">Context</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {
    <span class="hljs-keyword">const</span> atManager = abilityAccessCtrl.<span class="hljs-title function_">createAtManager</span>();
    <span class="hljs-keyword">const</span> <span class="hljs-attr">permissions</span>: <span class="hljs-title class_">Permissions</span>[] = [<span class="hljs-string">'ohos.permission.MICROPHONE'</span>];

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> atManager.<span class="hljs-title function_">requestPermissionsFromUser</span>(context, permissions);
      <span class="hljs-keyword">const</span> granted = result.<span class="hljs-property">authResults</span>.<span class="hljs-title function_">every</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r === abilityAccessCtrl.<span class="hljs-property">GrantStatus</span>.<span class="hljs-property">PERMISSION_GRANTED</span>);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`[VoiceService] éº¦å…‹é£æƒé™: <span class="hljs-subst">${granted ? <span class="hljs-string">'å·²æˆæƒ'</span> : <span class="hljs-string">'è¢«æ‹’ç»'</span>}</span>`</span>);
      <span class="hljs-keyword">return</span> granted;
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[VoiceService] è¯·æ±‚æƒé™å¤±è´¥:'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }

  <span class="hljs-comment">/**
   * åˆå§‹åŒ–è¯­éŸ³è¯†åˆ«å¼•æ“
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">initASR</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> <span class="hljs-attr">createParams</span>: speechRecognizer.<span class="hljs-property">CreateEngineParams</span> = {
        <span class="hljs-attr">language</span>: <span class="hljs-string">'zh-CN'</span>,
        <span class="hljs-attr">online</span>: <span class="hljs-number">1</span>  <span class="hljs-comment">// 1-åœ¨çº¿è¯†åˆ« 0-ç¦»çº¿è¯†åˆ«</span>
      };

      <span class="hljs-variable language_">this</span>.<span class="hljs-property">asrEngine</span> = <span class="hljs-keyword">await</span> speechRecognizer.<span class="hljs-title function_">createEngine</span>(createParams);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'[VoiceService] ASRå¼•æ“åˆå§‹åŒ–æˆåŠŸ'</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-keyword">const</span> error = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[VoiceService] ASRåˆå§‹åŒ–å¤±è´¥: <span class="hljs-subst">${error.code}</span> - <span class="hljs-subst">${error.message}</span>`</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }

  <span class="hljs-comment">/**
   * åˆå§‹åŒ–è¯­éŸ³åˆæˆå¼•æ“
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">initTTS</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> <span class="hljs-attr">createParams</span>: textToSpeech.<span class="hljs-property">CreateEngineParams</span> = {
        <span class="hljs-attr">language</span>: <span class="hljs-string">'zh-CN'</span>,
        <span class="hljs-attr">person</span>: <span class="hljs-number">0</span>,  <span class="hljs-comment">// å‘éŸ³äºº</span>
        <span class="hljs-attr">online</span>: <span class="hljs-number">1</span>   <span class="hljs-comment">// 1-åœ¨çº¿åˆæˆ 0-ç¦»çº¿åˆæˆ</span>
      };

      <span class="hljs-keyword">const</span> <span class="hljs-attr">extraParams</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">Object</span>&gt; = {
        <span class="hljs-attr">style</span>: <span class="hljs-string">'normal'</span>,
        <span class="hljs-attr">speed</span>: <span class="hljs-number">1.0</span>,
        <span class="hljs-attr">volume</span>: <span class="hljs-number">1.0</span>,
        <span class="hljs-attr">pitch</span>: <span class="hljs-number">1.0</span>
      };

      <span class="hljs-variable language_">this</span>.<span class="hljs-property">ttsEngine</span> = <span class="hljs-keyword">await</span> textToSpeech.<span class="hljs-title function_">createEngine</span>(createParams);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'[VoiceService] TTSå¼•æ“åˆå§‹åŒ–æˆåŠŸ'</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-keyword">const</span> error = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[VoiceService] TTSåˆå§‹åŒ–å¤±è´¥: <span class="hljs-subst">${error.code}</span> - <span class="hljs-subst">${error.message}</span>`</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }

  <span class="hljs-comment">/**
   * å¼€å§‹è¯­éŸ³è¯†åˆ«
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">startListening</span>(
    <span class="hljs-attr">onResult</span>: <span class="hljs-function">(<span class="hljs-params">text: <span class="hljs-built_in">string</span>, isFinal: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>,
    <span class="hljs-attr">onError</span>: <span class="hljs-function">(<span class="hljs-params">error: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>
  ): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">asrEngine</span>) {
      <span class="hljs-keyword">const</span> success = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initASR</span>();
      <span class="hljs-keyword">if</span> (!success) {
        <span class="hljs-title function_">onError</span>(<span class="hljs-string">'è¯­éŸ³è¯†åˆ«å¼•æ“åˆå§‹åŒ–å¤±è´¥'</span>);
        <span class="hljs-keyword">return</span>;
      }
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isListening</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'[VoiceService] å·²ç»åœ¨ç›‘å¬ä¸­'</span>);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// è®¾ç½®å›è°ƒ</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">asrEngine</span>!.<span class="hljs-title function_">setListener</span>({
        <span class="hljs-attr">onStart</span>: <span class="hljs-function">(<span class="hljs-params">sessionId: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`[VoiceService] å¼€å§‹è¯†åˆ«, sessionId: <span class="hljs-subst">${sessionId}</span>`</span>);
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">isListening</span> = <span class="hljs-literal">true</span>;
        },
        <span class="hljs-attr">onEvent</span>: <span class="hljs-function">(<span class="hljs-params">sessionId: <span class="hljs-built_in">string</span>, eventCode: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`[VoiceService] äº‹ä»¶: <span class="hljs-subst">${eventCode}</span>`</span>);
        },
        <span class="hljs-attr">onResult</span>: <span class="hljs-function">(<span class="hljs-params">sessionId: <span class="hljs-built_in">string</span>, result: speechRecognizer.SpeechRecognitionResult</span>) =&gt;</span> {
          <span class="hljs-keyword">const</span> text = result.<span class="hljs-property">result</span>;
          <span class="hljs-keyword">const</span> isFinal = result.<span class="hljs-property">isFinal</span>;
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`[VoiceService] è¯†åˆ«ç»“æœ: <span class="hljs-subst">${text}</span>, isFinal: <span class="hljs-subst">${isFinal}</span>`</span>);
          <span class="hljs-title function_">onResult</span>(text, isFinal);
        },
        <span class="hljs-attr">onComplete</span>: <span class="hljs-function">(<span class="hljs-params">sessionId: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`[VoiceService] è¯†åˆ«å®Œæˆ`</span>);
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">isListening</span> = <span class="hljs-literal">false</span>;
        },
        <span class="hljs-attr">onError</span>: <span class="hljs-function">(<span class="hljs-params">sessionId: <span class="hljs-built_in">string</span>, errorCode: <span class="hljs-built_in">number</span>, errorMessage: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[VoiceService] è¯†åˆ«é”™è¯¯: <span class="hljs-subst">${errorCode}</span> - <span class="hljs-subst">${errorMessage}</span>`</span>);
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">isListening</span> = <span class="hljs-literal">false</span>;
          <span class="hljs-title function_">onError</span>(errorMessage);
        }
      });

      <span class="hljs-comment">// å¼€å§‹è¯†åˆ«</span>
      <span class="hljs-keyword">const</span> <span class="hljs-attr">recognitionParams</span>: speechRecognizer.<span class="hljs-property">StartParams</span> = {
        <span class="hljs-attr">sessionId</span>: <span class="hljs-string">`session_<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>,
        <span class="hljs-attr">audioInfo</span>: {
          <span class="hljs-attr">audioType</span>: <span class="hljs-string">'pcm'</span>,
          <span class="hljs-attr">sampleRate</span>: <span class="hljs-number">16000</span>,
          <span class="hljs-attr">soundChannel</span>: <span class="hljs-number">1</span>,
          <span class="hljs-attr">sampleBit</span>: <span class="hljs-number">16</span>
        },
        <span class="hljs-attr">extraParams</span>: {
          <span class="hljs-attr">vadBegin</span>: <span class="hljs-number">2000</span>,  <span class="hljs-comment">// é™éŸ³æ£€æµ‹å¼€å§‹æ—¶é—´</span>
          <span class="hljs-attr">vadEnd</span>: <span class="hljs-number">3000</span>,    <span class="hljs-comment">// é™éŸ³æ£€æµ‹ç»“æŸæ—¶é—´</span>
          <span class="hljs-attr">maxAudioDuration</span>: <span class="hljs-number">60000</span>  <span class="hljs-comment">// æœ€å¤§å½•éŸ³æ—¶é•¿</span>
        }
      };

      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">asrEngine</span>!.<span class="hljs-title function_">startListening</span>(recognitionParams);
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-keyword">const</span> error = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[VoiceService] å¼€å§‹è¯†åˆ«å¤±è´¥: <span class="hljs-subst">${error.code}</span> - <span class="hljs-subst">${error.message}</span>`</span>);
      <span class="hljs-title function_">onError</span>(error.<span class="hljs-property">message</span>);
    }
  }

  <span class="hljs-comment">/**
   * åœæ­¢è¯­éŸ³è¯†åˆ«
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">stopListening</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">asrEngine</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">isListening</span>) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">asrEngine</span>.<span class="hljs-title function_">finish</span>(<span class="hljs-string">`session_stop_<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isListening</span> = <span class="hljs-literal">false</span>;
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'[VoiceService] åœæ­¢è¯†åˆ«'</span>);
      } <span class="hljs-keyword">catch</span> (err) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[VoiceService] åœæ­¢è¯†åˆ«å¤±è´¥:'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));
      }
    }
  }

  <span class="hljs-comment">/**
   * è¯­éŸ³åˆæˆï¼ˆæ–‡å­—è½¬è¯­éŸ³ï¼‰
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">speak</span>(<span class="hljs-attr">text</span>: <span class="hljs-built_in">string</span>, onComplete?: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">ttsEngine</span>) {
      <span class="hljs-keyword">const</span> success = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initTTS</span>();
      <span class="hljs-keyword">if</span> (!success) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[VoiceService] TTSå¼•æ“ä¸å¯ç”¨'</span>);
        onComplete?.();
        <span class="hljs-keyword">return</span>;
      }
    }

    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// è®¾ç½®å›è°ƒ</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">ttsEngine</span>!.<span class="hljs-title function_">setListener</span>({
        <span class="hljs-attr">onStart</span>: <span class="hljs-function">(<span class="hljs-params">requestId: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`[VoiceService] å¼€å§‹æ’­æ”¾, requestId: <span class="hljs-subst">${requestId}</span>`</span>);
        },
        <span class="hljs-attr">onProgress</span>: <span class="hljs-function">(<span class="hljs-params">requestId: <span class="hljs-built_in">string</span>, progress: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
          <span class="hljs-comment">// æ’­æ”¾è¿›åº¦</span>
        },
        <span class="hljs-attr">onFinish</span>: <span class="hljs-function">(<span class="hljs-params">requestId: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`[VoiceService] æ’­æ”¾å®Œæˆ`</span>);
          onComplete?.();
        },
        <span class="hljs-attr">onError</span>: <span class="hljs-function">(<span class="hljs-params">requestId: <span class="hljs-built_in">string</span>, errorCode: <span class="hljs-built_in">number</span>, errorMessage: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[VoiceService] æ’­æ”¾é”™è¯¯: <span class="hljs-subst">${errorCode}</span> - <span class="hljs-subst">${errorMessage}</span>`</span>);
          onComplete?.();
        }
      });

      <span class="hljs-comment">// åˆæˆå‚æ•°</span>
      <span class="hljs-keyword">const</span> <span class="hljs-attr">speakParams</span>: textToSpeech.<span class="hljs-property">SpeakParams</span> = {
        <span class="hljs-attr">requestId</span>: <span class="hljs-string">`speak_<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>,
        <span class="hljs-attr">extraParams</span>: {
          <span class="hljs-attr">speed</span>: <span class="hljs-number">1.0</span>,
          <span class="hljs-attr">volume</span>: <span class="hljs-number">1.0</span>,
          <span class="hljs-attr">pitch</span>: <span class="hljs-number">1.0</span>
        }
      };

      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">ttsEngine</span>!.<span class="hljs-title function_">speak</span>(text, speakParams);
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-keyword">const</span> error = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[VoiceService] è¯­éŸ³åˆæˆå¤±è´¥: <span class="hljs-subst">${error.code}</span> - <span class="hljs-subst">${error.message}</span>`</span>);
      onComplete?.();
    }
  }

  <span class="hljs-comment">/**
   * åœæ­¢è¯­éŸ³æ’­æ”¾
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">stopSpeaking</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">ttsEngine</span>) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">ttsEngine</span>.<span class="hljs-title function_">stop</span>();
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'[VoiceService] åœæ­¢æ’­æ”¾'</span>);
      } <span class="hljs-keyword">catch</span> (err) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[VoiceService] åœæ­¢æ’­æ”¾å¤±è´¥:'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));
      }
    }
  }

  <span class="hljs-comment">/**
   * é‡Šæ”¾èµ„æº
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">release</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">asrEngine</span>) {
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">asrEngine</span>.<span class="hljs-title function_">shutdown</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">asrEngine</span> = <span class="hljs-literal">null</span>;
      }
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">ttsEngine</span>) {
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">ttsEngine</span>.<span class="hljs-title function_">shutdown</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">ttsEngine</span> = <span class="hljs-literal">null</span>;
      }
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'[VoiceService] èµ„æºé‡Šæ”¾å®Œæˆ'</span>);
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[VoiceService] é‡Šæ”¾èµ„æºå¤±è´¥:'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));
    }
  }

  <span class="hljs-comment">/**
   * è·å–ç›‘å¬çŠ¶æ€
   */</span>
  <span class="hljs-title function_">getListeningState</span>(): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">isListening</span>;
  }
}
</code></pre>
<h3 data-id="heading-10">5. ä»»åŠ¡æ‰§è¡Œå™¨ (engine/ActionExecutor.ets)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// entry/src/main/ets/engine/ActionExecutor.ets</span>

<span class="hljs-keyword">import</span> { bundleManager, common, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">IntentType</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../model/MessageModel'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;

<span class="hljs-comment">/**
 * Vå“¥çš„ä»»åŠ¡æ‰§è¡Œå™¨
 * æ ¹æ®æ„å›¾æ‰§è¡Œå…·ä½“æ“ä½œ
 */</span>

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ActionResult</span> {
  <span class="hljs-attr">success</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span>;
  data?: <span class="hljs-built_in">object</span>;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ActionExecutor</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-attr">instance</span>: <span class="hljs-title class_">ActionExecutor</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">private</span> <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {}

  <span class="hljs-keyword">static</span> <span class="hljs-title function_">getInstance</span>(): <span class="hljs-title class_">ActionExecutor</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">ActionExecutor</span>.<span class="hljs-property">instance</span>) {
      <span class="hljs-title class_">ActionExecutor</span>.<span class="hljs-property">instance</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ActionExecutor</span>();
    }
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">ActionExecutor</span>.<span class="hljs-property">instance</span>;
  }

  <span class="hljs-comment">/**
   * è®¾ç½®ä¸Šä¸‹æ–‡
   */</span>
  <span class="hljs-title function_">setContext</span>(<span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span> = context;
  }

  <span class="hljs-comment">/**
   * æ‰§è¡ŒåŠ¨ä½œ
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">execute</span>(<span class="hljs-attr">intent</span>: <span class="hljs-title class_">IntentType</span>, <span class="hljs-attr">params</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ActionResult</span>&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`[ActionExecutor] æ‰§è¡Œæ„å›¾: <span class="hljs-subst">${intent}</span>, å‚æ•°: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(params)}</span>`</span>);

    <span class="hljs-keyword">switch</span> (intent) {
      <span class="hljs-keyword">case</span> <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">OPEN_APP</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">openApp</span>(params);

      <span class="hljs-keyword">case</span> <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">SET_ALARM</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setAlarm</span>(params);

      <span class="hljs-keyword">case</span> <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">SET_REMINDER</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setReminder</span>(params);

      <span class="hljs-keyword">case</span> <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">QUERY_WEATHER</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">queryWeather</span>(params);

      <span class="hljs-keyword">case</span> <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">QUERY_TIME</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">queryTime</span>();

      <span class="hljs-keyword">case</span> <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">CONTROL_DEVICE</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">controlDevice</span>(params);

      <span class="hljs-attr">default</span>:
        <span class="hljs-keyword">return</span> {
          <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">message</span>: <span class="hljs-string">'æš‚ä¸æ”¯æŒè¯¥æ“ä½œ'</span>
        };
    }
  }

  <span class="hljs-comment">/**
   * æ‰“å¼€åº”ç”¨
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">openApp</span>(<span class="hljs-attr">params</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ActionResult</span>&gt; {
    <span class="hljs-keyword">const</span> bundleName = params.<span class="hljs-property">bundleName</span>;
    <span class="hljs-keyword">const</span> appName = params.<span class="hljs-property">appName</span>;

    <span class="hljs-keyword">if</span> (!bundleName) {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">`æŠ±æ­‰ï¼Œæˆ‘ä¸çŸ¥é“æ€ä¹ˆæ‰“å¼€"<span class="hljs-subst">${appName || <span class="hljs-string">'è¿™ä¸ªåº”ç”¨'</span>}</span>"`</span>
      };
    }

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {
        <span class="hljs-attr">bundleName</span>: bundleName,
        <span class="hljs-attr">action</span>: <span class="hljs-string">'action.system.home'</span>,
        <span class="hljs-attr">entities</span>: [<span class="hljs-string">'entity.system.home'</span>]
      };

      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>?.<span class="hljs-title function_">startAbility</span>(want);

      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">`å·²ä¸ºä½ æ‰“å¼€<span class="hljs-subst">${appName}</span>`</span>
      };
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-keyword">const</span> error = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[ActionExecutor] æ‰“å¼€åº”ç”¨å¤±è´¥: <span class="hljs-subst">${error.code}</span> - <span class="hljs-subst">${error.message}</span>`</span>);

      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">`æ‰“å¼€<span class="hljs-subst">${appName}</span>å¤±è´¥ï¼Œå¯èƒ½æ˜¯åº”ç”¨æœªå®‰è£…`</span>
      };
    }
  }

  <span class="hljs-comment">/**
   * è®¾ç½®é—¹é’Ÿ
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">setAlarm</span>(<span class="hljs-attr">params</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ActionResult</span>&gt; {
    <span class="hljs-keyword">const</span> hour = <span class="hljs-built_in">parseInt</span>(params.<span class="hljs-property">hour</span> || <span class="hljs-string">'8'</span>);
    <span class="hljs-keyword">const</span> minute = <span class="hljs-built_in">parseInt</span>(params.<span class="hljs-property">minute</span> || <span class="hljs-string">'0'</span>);

    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// è°ƒç”¨ç³»ç»Ÿé—¹é’Ÿ</span>
      <span class="hljs-keyword">const</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {
        <span class="hljs-attr">action</span>: <span class="hljs-string">'ohos.want.action.setAlarm'</span>,
        <span class="hljs-attr">parameters</span>: {
          <span class="hljs-string">'ringtone'</span>: <span class="hljs-string">'default'</span>,
          <span class="hljs-string">'hour'</span>: hour,
          <span class="hljs-string">'minute'</span>: minute
        }
      };

      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>?.<span class="hljs-title function_">startAbility</span>(want);

      <span class="hljs-keyword">const</span> timeStr = <span class="hljs-string">`<span class="hljs-subst">${hour.toString().padStart(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>)}</span>:<span class="hljs-subst">${minute.toString().padStart(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>)}</span>`</span>;
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">`å¥½çš„ï¼Œå·²ä¸ºä½ è®¾ç½®<span class="hljs-subst">${timeStr}</span>çš„é—¹é’Ÿ`</span>
      };
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[ActionExecutor] è®¾ç½®é—¹é’Ÿå¤±è´¥:'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));

      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">'è®¾ç½®é—¹é’Ÿå¤±è´¥ï¼Œè¯·æ‰‹åŠ¨è®¾ç½®'</span>
      };
    }
  }

  <span class="hljs-comment">/**
   * è®¾ç½®æé†’
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">setReminder</span>(<span class="hljs-attr">params</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ActionResult</span>&gt; {
    <span class="hljs-keyword">const</span> content = params.<span class="hljs-property">content</span> || <span class="hljs-string">'æœªå‘½åæé†’'</span>;
    <span class="hljs-keyword">const</span> delayMinutes = <span class="hljs-built_in">parseInt</span>(params.<span class="hljs-property">delayMinutes</span> || <span class="hljs-string">'10'</span>);

    <span class="hljs-comment">// è¿™é‡Œå¯ä»¥æ¥å…¥å‰é¢çš„æ—¥ç¨‹æé†’æ¨¡å—</span>
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">message</span>: <span class="hljs-string">`æ”¶åˆ°ï¼<span class="hljs-subst">${delayMinutes}</span>åˆ†é’Ÿåæé†’ä½ ï¼š<span class="hljs-subst">${content}</span>`</span>
    };
  }

  <span class="hljs-comment">/**
   * æŸ¥è¯¢å¤©æ°”
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">queryWeather</span>(<span class="hljs-attr">params</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ActionResult</span>&gt; {
    <span class="hljs-keyword">const</span> city = params.<span class="hljs-property">city</span> || <span class="hljs-string">'åŒ—äº¬'</span>;

    <span class="hljs-comment">// å®é™…é¡¹ç›®ä¸­å¯¹æ¥å¤©æ°”API</span>
    <span class="hljs-comment">// è¿™é‡Œè¿”å›æ¨¡æ‹Ÿæ•°æ®</span>
    <span class="hljs-keyword">const</span> mockWeather = {
      <span class="hljs-attr">city</span>: city,
      <span class="hljs-attr">temperature</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">20</span>) + <span class="hljs-number">10</span>,
      <span class="hljs-attr">weather</span>: [<span class="hljs-string">'æ™´'</span>, <span class="hljs-string">'å¤šäº‘'</span>, <span class="hljs-string">'é˜´'</span>, <span class="hljs-string">'å°é›¨'</span>][<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">4</span>)],
      <span class="hljs-attr">humidity</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">40</span>) + <span class="hljs-number">40</span>
    };

    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">message</span>: <span class="hljs-string">`<span class="hljs-subst">${city}</span>ä»Šå¤©<span class="hljs-subst">${mockWeather.weather}</span>ï¼Œæ°”æ¸©<span class="hljs-subst">${mockWeather.temperature}</span>Â°Cï¼Œæ¹¿åº¦<span class="hljs-subst">${mockWeather.humidity}</span>%`</span>,
      <span class="hljs-attr">data</span>: mockWeather
    };
  }

  <span class="hljs-comment">/**
   * æŸ¥è¯¢æ—¶é—´
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">queryTime</span>(): <span class="hljs-title class_">ActionResult</span> {
    <span class="hljs-keyword">const</span> now = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();
    <span class="hljs-keyword">const</span> weekDays = [<span class="hljs-string">'æ—¥'</span>, <span class="hljs-string">'ä¸€'</span>, <span class="hljs-string">'äºŒ'</span>, <span class="hljs-string">'ä¸‰'</span>, <span class="hljs-string">'å››'</span>, <span class="hljs-string">'äº”'</span>, <span class="hljs-string">'å…­'</span>];

    <span class="hljs-keyword">const</span> dateStr = <span class="hljs-string">`<span class="hljs-subst">${now.getFullYear()}</span>å¹´<span class="hljs-subst">${now.getMonth() + <span class="hljs-number">1</span>}</span>æœˆ<span class="hljs-subst">${now.getDate()}</span>æ—¥`</span>;
    <span class="hljs-keyword">const</span> weekStr = <span class="hljs-string">`æ˜ŸæœŸ<span class="hljs-subst">${weekDays[now.getDay()]}</span>`</span>;
    <span class="hljs-keyword">const</span> timeStr = <span class="hljs-string">`<span class="hljs-subst">${now.getHours().toString().padStart(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>)}</span>:<span class="hljs-subst">${now.getMinutes().toString().padStart(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>)}</span>`</span>;

    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">message</span>: <span class="hljs-string">`ç°åœ¨æ˜¯<span class="hljs-subst">${dateStr}</span> <span class="hljs-subst">${weekStr}</span> <span class="hljs-subst">${timeStr}</span>`</span>
    };
  }

  <span class="hljs-comment">/**
   * æ§åˆ¶è®¾å¤‡
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">controlDevice</span>(<span class="hljs-attr">params</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ActionResult</span>&gt; {
    <span class="hljs-keyword">const</span> device = params.<span class="hljs-property">device</span> || <span class="hljs-string">'è®¾å¤‡'</span>;
    <span class="hljs-keyword">const</span> action = params.<span class="hljs-property">action</span> === <span class="hljs-string">'on'</span> ? <span class="hljs-string">'æ‰“å¼€'</span> : <span class="hljs-string">'å…³é—­'</span>;

    <span class="hljs-comment">// å®é™…é¡¹ç›®ä¸­å¯¹æ¥æ™ºèƒ½å®¶å±…API</span>
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">message</span>: <span class="hljs-string">`å¥½çš„ï¼Œå·²<span class="hljs-subst">${action}</span><span class="hljs-subst">${device}</span>`</span>
    };
  }
}
</code></pre>
<h3 data-id="heading-11">6. AIæ™ºèƒ½ä½“æ ¸å¿ƒ (engine/AIAgent.ets)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// entry/src/main/ets/engine/AIAgent.ets</span>

<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Message</span>, <span class="hljs-title class_">MessageRole</span>, <span class="hljs-title class_">MessageType</span>, <span class="hljs-title class_">ConversationContext</span>, <span class="hljs-title class_">IntentType</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../model/MessageModel'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">IntentEngine</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./IntentEngine'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ActionExecutor</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./ActionExecutor'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">LLMService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../service/LLMService'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">VoiceService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../service/VoiceService'</span>;

<span class="hljs-comment">/**
 * Vå“¥çš„AIæ™ºèƒ½ä½“æ ¸å¿ƒ
 * æ•´åˆæ‰€æœ‰èƒ½åŠ›ï¼Œå®ç°æ™ºèƒ½å¯¹è¯
 */</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AIAgent</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-attr">instance</span>: <span class="hljs-title class_">AIAgent</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">context</span>: <span class="hljs-title class_">ConversationContext</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">intentEngine</span>: <span class="hljs-title class_">IntentEngine</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">actionExecutor</span>: <span class="hljs-title class_">ActionExecutor</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">llmService</span>: <span class="hljs-title class_">LLMService</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">voiceService</span>: <span class="hljs-title class_">VoiceService</span>;

  <span class="hljs-comment">// å›è°ƒå‡½æ•°</span>
  <span class="hljs-keyword">private</span> onMessageCallback?: <span class="hljs-function">(<span class="hljs-params">message: Message</span>) =&gt;</span> <span class="hljs-built_in">void</span>;
  <span class="hljs-keyword">private</span> onStateChangeCallback?: <span class="hljs-function">(<span class="hljs-params">state: AgentState</span>) =&gt;</span> <span class="hljs-built_in">void</span>;

  <span class="hljs-keyword">private</span> <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConversationContext</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">intentEngine</span> = <span class="hljs-title class_">IntentEngine</span>.<span class="hljs-title function_">getInstance</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">actionExecutor</span> = <span class="hljs-title class_">ActionExecutor</span>.<span class="hljs-title function_">getInstance</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">llmService</span> = <span class="hljs-title class_">LLMService</span>.<span class="hljs-title function_">getInstance</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">voiceService</span> = <span class="hljs-title class_">VoiceService</span>.<span class="hljs-title function_">getInstance</span>();
  }

  <span class="hljs-keyword">static</span> <span class="hljs-title function_">getInstance</span>(): <span class="hljs-title class_">AIAgent</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">AIAgent</span>.<span class="hljs-property">instance</span>) {
      <span class="hljs-title class_">AIAgent</span>.<span class="hljs-property">instance</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AIAgent</span>();
    }
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">AIAgent</span>.<span class="hljs-property">instance</span>;
  }

  <span class="hljs-comment">/**
   * è®¾ç½®æ¶ˆæ¯å›è°ƒ
   */</span>
  <span class="hljs-title function_">setOnMessage</span>(<span class="hljs-attr">callback</span>: <span class="hljs-function">(<span class="hljs-params">message: Message</span>) =&gt;</span> <span class="hljs-built_in">void</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onMessageCallback</span> = callback;
  }

  <span class="hljs-comment">/**
   * è®¾ç½®çŠ¶æ€å›è°ƒ
   */</span>
  <span class="hljs-title function_">setOnStateChange</span>(<span class="hljs-attr">callback</span>: <span class="hljs-function">(<span class="hljs-params">state: AgentState</span>) =&gt;</span> <span class="hljs-built_in">void</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onStateChangeCallback</span> = callback;
  }

  <span class="hljs-comment">/**
   * å¤„ç†ç”¨æˆ·è¾“å…¥ï¼ˆæ ¸å¿ƒæ–¹æ³•ï¼‰
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">processInput</span>(<span class="hljs-attr">userInput</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">if</span> (!userInput.<span class="hljs-title function_">trim</span>()) <span class="hljs-keyword">return</span>;

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`[AIAgent] å¤„ç†ç”¨æˆ·è¾“å…¥: <span class="hljs-subst">${userInput}</span>`</span>);

    <span class="hljs-comment">// 1. åˆ›å»ºç”¨æˆ·æ¶ˆæ¯</span>
    <span class="hljs-keyword">const</span> userMessage = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Message</span>({
      <span class="hljs-attr">role</span>: <span class="hljs-title class_">MessageRole</span>.<span class="hljs-property">USER</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">MessageType</span>.<span class="hljs-property">TEXT</span>,
      <span class="hljs-attr">content</span>: userInput
    });
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">addMessage</span>(userMessage);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onMessageCallback</span>?.(userMessage);

    <span class="hljs-comment">// 2. æ„å›¾è¯†åˆ«</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onStateChangeCallback</span>?.(<span class="hljs-title class_">AgentState</span>.<span class="hljs-property">THINKING</span>);
    <span class="hljs-keyword">const</span> { intent, params, confidence } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">intentEngine</span>.<span class="hljs-title function_">recognize</span>(userInput);

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`[AIAgent] æ„å›¾è¯†åˆ«: <span class="hljs-subst">${intent}</span>, ç½®ä¿¡åº¦: <span class="hljs-subst">${confidence}</span>`</span>);

    <span class="hljs-comment">// 3. æ ¹æ®æ„å›¾å†³å®šå¤„ç†æ–¹å¼</span>
    <span class="hljs-keyword">let</span> <span class="hljs-attr">response</span>: <span class="hljs-built_in">string</span>;

    <span class="hljs-keyword">if</span> (intent !== <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">CHAT</span> &amp;&amp; confidence &gt;= <span class="hljs-number">0.7</span>) {
      <span class="hljs-comment">// é«˜ç½®ä¿¡åº¦çš„åŠŸèƒ½æ„å›¾ï¼Œæ‰§è¡ŒåŠ¨ä½œ</span>
      userMessage.<span class="hljs-property">intent</span> = intent;
      userMessage.<span class="hljs-property">intentParams</span> = params;

      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">actionExecutor</span>.<span class="hljs-title function_">execute</span>(intent, params);
      response = result.<span class="hljs-property">message</span>;

      <span class="hljs-comment">// å¦‚æœæ˜¯éœ€è¦è¡¥å……ä¿¡æ¯çš„åœºæ™¯ï¼Œç»§ç»­è°ƒç”¨LLM</span>
      <span class="hljs-keyword">if</span> (!result.<span class="hljs-property">success</span> &amp;&amp; intent !== <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">UNKNOWN</span>) {
        response = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">llmService</span>.<span class="hljs-title function_">chat</span>(
          <span class="hljs-string">`ç”¨æˆ·è¯´"<span class="hljs-subst">${userInput}</span>"ï¼Œæˆ‘å°è¯•<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.getIntentDescription(intent)}</span>ä½†å¤±è´¥äº†ã€‚è¯·ç»™å‡ºå‹å¥½çš„å›å¤å’Œå»ºè®®ã€‚`</span>,
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>
        );
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// é—²èŠæˆ–ä½ç½®ä¿¡åº¦ï¼Œè°ƒç”¨å¤§æ¨¡å‹</span>
      response = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">llmService</span>.<span class="hljs-title function_">chat</span>(userInput, <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>);
    }

    <span class="hljs-comment">// 4. åˆ›å»ºåŠ©æ‰‹å›å¤</span>
    <span class="hljs-keyword">const</span> assistantMessage = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Message</span>({
      <span class="hljs-attr">role</span>: <span class="hljs-title class_">MessageRole</span>.<span class="hljs-property">ASSISTANT</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">MessageType</span>.<span class="hljs-property">TEXT</span>,
      <span class="hljs-attr">content</span>: response
    });
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">addMessage</span>(assistantMessage);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onMessageCallback</span>?.(assistantMessage);

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onStateChangeCallback</span>?.(<span class="hljs-title class_">AgentState</span>.<span class="hljs-property">IDLE</span>);

    <span class="hljs-comment">// 5. è¯­éŸ³æ’­æŠ¥å›å¤</span>
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">voiceService</span>.<span class="hljs-title function_">speak</span>(response);
  }

  <span class="hljs-comment">/**
   * å¼€å§‹è¯­éŸ³è¾“å…¥
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">startVoiceInput</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onStateChangeCallback</span>?.(<span class="hljs-title class_">AgentState</span>.<span class="hljs-property">LISTENING</span>);

    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">voiceService</span>.<span class="hljs-title function_">startListening</span>(
      <span class="hljs-function">(<span class="hljs-params">text: <span class="hljs-built_in">string</span>, isFinal: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (isFinal &amp;&amp; text.<span class="hljs-title function_">trim</span>()) {
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processInput</span>(text);
        }
      },
      <span class="hljs-function">(<span class="hljs-params">error: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[AIAgent] è¯­éŸ³è¯†åˆ«é”™è¯¯:'</span>, error);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">onStateChangeCallback</span>?.(<span class="hljs-title class_">AgentState</span>.<span class="hljs-property">IDLE</span>);
      }
    );
  }

  <span class="hljs-comment">/**
   * åœæ­¢è¯­éŸ³è¾“å…¥
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">stopVoiceInput</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">voiceService</span>.<span class="hljs-title function_">stopListening</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onStateChangeCallback</span>?.(<span class="hljs-title class_">AgentState</span>.<span class="hljs-property">IDLE</span>);
  }

  <span class="hljs-comment">/**
   * è·å–å¯¹è¯å†å²
   */</span>
  <span class="hljs-title function_">getHistory</span>(): <span class="hljs-title class_">Message</span>[] {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">getHistory</span>();
  }

  <span class="hljs-comment">/**
   * æ¸…ç©ºå¯¹è¯
   */</span>
  <span class="hljs-title function_">clearHistory</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">clear</span>();
  }

  <span class="hljs-comment">/**
   * è·å–æ„å›¾æè¿°
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">getIntentDescription</span>(<span class="hljs-attr">intent</span>: <span class="hljs-title class_">IntentType</span>): <span class="hljs-built_in">string</span> {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">descriptions</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-title class_">IntentType</span>, <span class="hljs-built_in">string</span>&gt; = {
      [<span class="hljs-title class_">IntentType</span>.<span class="hljs-property">OPEN_APP</span>]: <span class="hljs-string">'æ‰“å¼€åº”ç”¨'</span>,
      [<span class="hljs-title class_">IntentType</span>.<span class="hljs-property">SET_ALARM</span>]: <span class="hljs-string">'è®¾ç½®é—¹é’Ÿ'</span>,
      [<span class="hljs-title class_">IntentType</span>.<span class="hljs-property">SET_REMINDER</span>]: <span class="hljs-string">'è®¾ç½®æé†’'</span>,
      [<span class="hljs-title class_">IntentType</span>.<span class="hljs-property">QUERY_WEATHER</span>]: <span class="hljs-string">'æŸ¥è¯¢å¤©æ°”'</span>,
      [<span class="hljs-title class_">IntentType</span>.<span class="hljs-property">QUERY_TIME</span>]: <span class="hljs-string">'æŸ¥è¯¢æ—¶é—´'</span>,
      [<span class="hljs-title class_">IntentType</span>.<span class="hljs-property">CONTROL_DEVICE</span>]: <span class="hljs-string">'æ§åˆ¶è®¾å¤‡'</span>,
      [<span class="hljs-title class_">IntentType</span>.<span class="hljs-property">CHAT</span>]: <span class="hljs-string">'é—²èŠ'</span>,
      [<span class="hljs-title class_">IntentType</span>.<span class="hljs-property">UNKNOWN</span>]: <span class="hljs-string">'ç†è§£æ„å›¾'</span>
    };
    <span class="hljs-keyword">return</span> descriptions[intent] || <span class="hljs-string">'æ‰§è¡Œæ“ä½œ'</span>;
  }
}

<span class="hljs-comment">/**
 * æ™ºèƒ½ä½“çŠ¶æ€
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">AgentState</span> {
  <span class="hljs-variable constant_">IDLE</span> = <span class="hljs-string">'idle'</span>,           <span class="hljs-comment">// ç©ºé—²</span>
  <span class="hljs-variable constant_">LISTENING</span> = <span class="hljs-string">'listening'</span>, <span class="hljs-comment">// ç›‘å¬ä¸­</span>
  <span class="hljs-variable constant_">THINKING</span> = <span class="hljs-string">'thinking'</span>,   <span class="hljs-comment">// æ€è€ƒä¸­</span>
  <span class="hljs-variable constant_">SPEAKING</span> = <span class="hljs-string">'speaking'</span>    <span class="hljs-comment">// è¯´è¯ä¸­</span>
}
</code></pre>
<h3 data-id="heading-12">7. ä¸»ç•Œé¢ (pages/Index.ets)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// entry/src/main/ets/pages/Index.ets</span>

<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Message</span>, <span class="hljs-title class_">MessageRole</span>, <span class="hljs-title class_">MessageType</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../model/MessageModel'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">AIAgent</span>, <span class="hljs-title class_">AgentState</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../engine/AIAgent'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ActionExecutor</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../engine/ActionExecutor'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">VoiceService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../service/VoiceService'</span>;
<span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;
<span class="hljs-keyword">import</span> { promptAction } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">messageList</span>: <span class="hljs-title class_">Message</span>[] = [];
  <span class="hljs-meta">@State</span> <span class="hljs-attr">inputText</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;
  <span class="hljs-meta">@State</span> <span class="hljs-attr">agentState</span>: <span class="hljs-title class_">AgentState</span> = <span class="hljs-title class_">AgentState</span>.<span class="hljs-property">IDLE</span>;
  <span class="hljs-meta">@State</span> <span class="hljs-attr">isVoiceMode</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;

  <span class="hljs-keyword">private</span> <span class="hljs-attr">agent</span>: <span class="hljs-title class_">AIAgent</span> = <span class="hljs-title class_">AIAgent</span>.<span class="hljs-title function_">getInstance</span>();
  <span class="hljs-keyword">private</span> <span class="hljs-attr">voiceService</span>: <span class="hljs-title class_">VoiceService</span> = <span class="hljs-title class_">VoiceService</span>.<span class="hljs-title function_">getInstance</span>();
  <span class="hljs-keyword">private</span> <span class="hljs-attr">scroller</span>: <span class="hljs-title class_">Scroller</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scroller</span>();
  <span class="hljs-keyword">private</span> context = <span class="hljs-title function_">getContext</span>(<span class="hljs-variable language_">this</span>) <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-comment">// åˆå§‹åŒ–</span>
    <span class="hljs-title class_">ActionExecutor</span>.<span class="hljs-title function_">getInstance</span>().<span class="hljs-title function_">setContext</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>);

    <span class="hljs-comment">// è¯·æ±‚æƒé™</span>
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">voiceService</span>.<span class="hljs-title function_">requestPermission</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>);

    <span class="hljs-comment">// è®¾ç½®å›è°ƒ</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">agent</span>.<span class="hljs-title function_">setOnMessage</span>(<span class="hljs-function">(<span class="hljs-params">message: Message</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">messageList</span> = [...<span class="hljs-variable language_">this</span>.<span class="hljs-property">messageList</span>, message];
      <span class="hljs-comment">// æ»šåŠ¨åˆ°åº•éƒ¨</span>
      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">scroller</span>.<span class="hljs-title function_">scrollEdge</span>(<span class="hljs-title class_">Edge</span>.<span class="hljs-property">Bottom</span>);
      }, <span class="hljs-number">100</span>);
    });

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">agent</span>.<span class="hljs-title function_">setOnStateChange</span>(<span class="hljs-function">(<span class="hljs-params">state: AgentState</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">agentState</span> = state;
    });

    <span class="hljs-comment">// æ·»åŠ æ¬¢è¿æ¶ˆæ¯</span>
    <span class="hljs-keyword">const</span> welcomeMessage = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Message</span>({
      <span class="hljs-attr">role</span>: <span class="hljs-title class_">MessageRole</span>.<span class="hljs-property">ASSISTANT</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">MessageType</span>.<span class="hljs-property">TEXT</span>,
      <span class="hljs-attr">content</span>: <span class="hljs-string">'ä½ å¥½ï¼æˆ‘æ˜¯å°VåŠ©æ‰‹ ğŸ¤–\n\næˆ‘å¯ä»¥å¸®ä½ ï¼š\nâ€¢ å›ç­”å„ç§é—®é¢˜\nâ€¢ æ‰“å¼€åº”ç”¨\nâ€¢ è®¾ç½®é—¹é’Ÿå’Œæé†’\nâ€¢ æŸ¥è¯¢å¤©æ°”å’Œæ—¶é—´\nâ€¢ æ§åˆ¶æ™ºèƒ½è®¾å¤‡\n\nè¯•ç€å¯¹æˆ‘è¯´ç‚¹ä»€ä¹ˆå§ï¼'</span>
    });
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">messageList</span>.<span class="hljs-title function_">push</span>(welcomeMessage);
  }

  <span class="hljs-comment">/**
   * å‘é€æ¶ˆæ¯
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">sendMessage</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">inputText</span>.<span class="hljs-title function_">trim</span>()) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">const</span> text = <span class="hljs-variable language_">this</span>.<span class="hljs-property">inputText</span>.<span class="hljs-title function_">trim</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">inputText</span> = <span class="hljs-string">''</span>;

    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">agent</span>.<span class="hljs-title function_">processInput</span>(text);
  }

  <span class="hljs-comment">/**
   * åˆ‡æ¢è¯­éŸ³æ¨¡å¼
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">toggleVoiceMode</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isVoiceMode</span>) {
      <span class="hljs-comment">// åœæ­¢è¯­éŸ³è¾“å…¥</span>
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">agent</span>.<span class="hljs-title function_">stopVoiceInput</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">isVoiceMode</span> = <span class="hljs-literal">false</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// å¼€å§‹è¯­éŸ³è¾“å…¥</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">isVoiceMode</span> = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">agent</span>.<span class="hljs-title function_">startVoiceInput</span>();
    }
  }

  <span class="hljs-comment">/**
   * è·å–çŠ¶æ€æ–‡æœ¬
   */</span>
  <span class="hljs-title function_">getStateText</span>(): <span class="hljs-built_in">string</span> {
    <span class="hljs-keyword">switch</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">agentState</span>) {
      <span class="hljs-keyword">case</span> <span class="hljs-title class_">AgentState</span>.<span class="hljs-property">LISTENING</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">'æ­£åœ¨å¬...'</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-title class_">AgentState</span>.<span class="hljs-property">THINKING</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">'æ€è€ƒä¸­...'</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-title class_">AgentState</span>.<span class="hljs-property">SPEAKING</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">'è¯´è¯ä¸­...'</span>;
      <span class="hljs-attr">default</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
    }
  }

  <span class="hljs-comment">/**
   * æ ¼å¼åŒ–æ—¶é—´
   */</span>
  <span class="hljs-title function_">formatTime</span>(<span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">string</span> {
    <span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(timestamp);
    <span class="hljs-keyword">const</span> hour = date.<span class="hljs-title function_">getHours</span>().<span class="hljs-title function_">toString</span>().<span class="hljs-title function_">padStart</span>(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>);
    <span class="hljs-keyword">const</span> minute = date.<span class="hljs-title function_">getMinutes</span>().<span class="hljs-title function_">toString</span>().<span class="hljs-title function_">padStart</span>(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${hour}</span>:<span class="hljs-subst">${minute}</span>`</span>;
  }

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-comment">// é¡¶éƒ¨æ ‡é¢˜æ </span>
      <span class="hljs-title class_">Row</span>() {
        <span class="hljs-title class_">Column</span>() {
          <span class="hljs-title class_">Text</span>(<span class="hljs-string">'å°VåŠ©æ‰‹'</span>)
            .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
            .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
            .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#333333'</span>)

          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">agentState</span> !== <span class="hljs-title class_">AgentState</span>.<span class="hljs-property">IDLE</span>) {
            <span class="hljs-title class_">Row</span>() {
              <span class="hljs-title class_">LoadingProgress</span>()
                .<span class="hljs-title function_">width</span>(<span class="hljs-number">14</span>)
                .<span class="hljs-title function_">height</span>(<span class="hljs-number">14</span>)
                .<span class="hljs-title function_">color</span>(<span class="hljs-string">'#007DFF'</span>)
              <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getStateText</span>())
                .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">12</span>)
                .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#007DFF'</span>)
                .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">4</span> })
            }
            .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">2</span> })
          }
        }
        .<span class="hljs-title function_">alignItems</span>(<span class="hljs-title class_">HorizontalAlign</span>.<span class="hljs-property">Start</span>)

        <span class="hljs-title class_">Blank</span>()

        <span class="hljs-comment">// æ¸…ç©ºå¯¹è¯æŒ‰é’®</span>
        <span class="hljs-title class_">Button</span>() {
          <span class="hljs-title class_">Image</span>($r(<span class="hljs-string">'app.media.ic_clear'</span>))
            .<span class="hljs-title function_">width</span>(<span class="hljs-number">20</span>)
            .<span class="hljs-title function_">height</span>(<span class="hljs-number">20</span>)
            .<span class="hljs-title function_">fillColor</span>(<span class="hljs-string">'#666666'</span>)
        }
        .<span class="hljs-title function_">width</span>(<span class="hljs-number">40</span>)
        .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)
        .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#F0F0F0'</span>)
        .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">20</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
          promptAction.<span class="hljs-title function_">showDialog</span>({
            <span class="hljs-attr">title</span>: <span class="hljs-string">'æ¸…ç©ºå¯¹è¯'</span>,
            <span class="hljs-attr">message</span>: <span class="hljs-string">'ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å¯¹è¯è®°å½•å—ï¼Ÿ'</span>,
            <span class="hljs-attr">buttons</span>: [
              { <span class="hljs-attr">text</span>: <span class="hljs-string">'å–æ¶ˆ'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'#666666'</span> },
              { <span class="hljs-attr">text</span>: <span class="hljs-string">'ç¡®å®š'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'#007DFF'</span> }
            ]
          }).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
            <span class="hljs-keyword">if</span> (result.<span class="hljs-property">index</span> === <span class="hljs-number">1</span>) {
              <span class="hljs-variable language_">this</span>.<span class="hljs-property">messageList</span> = [];
              <span class="hljs-variable language_">this</span>.<span class="hljs-property">agent</span>.<span class="hljs-title function_">clearHistory</span>();
            }
          });
        })
      }
      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      .<span class="hljs-title function_">height</span>(<span class="hljs-number">60</span>)
      .<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">16</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">16</span> })
      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)

      <span class="hljs-comment">// æ¶ˆæ¯åˆ—è¡¨</span>
      <span class="hljs-title class_">List</span>({ <span class="hljs-attr">scroller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">scroller</span>, <span class="hljs-attr">space</span>: <span class="hljs-number">16</span> }) {
        <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">messageList</span>, <span class="hljs-function">(<span class="hljs-params">message: Message</span>) =&gt;</span> {
          <span class="hljs-title class_">ListItem</span>() {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title class_">MessageBubble</span>(message)
          }
        }, <span class="hljs-function">(<span class="hljs-params">message: Message</span>) =&gt;</span> message.<span class="hljs-property">id</span>)
      }
      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)
      .<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">16</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">16</span>, <span class="hljs-attr">top</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">12</span> })
      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#F5F5F5'</span>)

      <span class="hljs-comment">// åº•éƒ¨è¾“å…¥åŒºåŸŸ</span>
      <span class="hljs-title class_">Row</span>() {
        <span class="hljs-comment">// è¯­éŸ³æŒ‰é’®</span>
        <span class="hljs-title class_">Button</span>() {
          <span class="hljs-title class_">Image</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">isVoiceMode</span> ? $r(<span class="hljs-string">'app.media.ic_keyboard'</span>) : $r(<span class="hljs-string">'app.media.ic_voice'</span>))
            .<span class="hljs-title function_">width</span>(<span class="hljs-number">24</span>)
            .<span class="hljs-title function_">height</span>(<span class="hljs-number">24</span>)
            .<span class="hljs-title function_">fillColor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">isVoiceMode</span> ? <span class="hljs-string">'#FF3B30'</span> : <span class="hljs-string">'#666666'</span>)
        }
        .<span class="hljs-title function_">width</span>(<span class="hljs-number">44</span>)
        .<span class="hljs-title function_">height</span>(<span class="hljs-number">44</span>)
        .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">isVoiceMode</span> ? <span class="hljs-string">'#FFE5E5'</span> : <span class="hljs-string">'#F0F0F0'</span>)
        .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">22</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">toggleVoiceMode</span>())

        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isVoiceMode</span>) {
          <span class="hljs-comment">// è¯­éŸ³è¾“å…¥çŠ¶æ€</span>
          <span class="hljs-title class_">Column</span>() {
            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">agentState</span> === <span class="hljs-title class_">AgentState</span>.<span class="hljs-property">LISTENING</span>) {
              <span class="hljs-title class_">Row</span>() {
                <span class="hljs-title class_">ForEach</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>], <span class="hljs-function">(<span class="hljs-params">i: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
                  <span class="hljs-title class_">Column</span>()
                    .<span class="hljs-title function_">width</span>(<span class="hljs-number">4</span>)
                    .<span class="hljs-title function_">height</span>(<span class="hljs-number">12</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">20</span>)
                    .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#007DFF'</span>)
                    .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">2</span>)
                    .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">4</span> })
                    .<span class="hljs-title function_">animation</span>({
                      <span class="hljs-attr">duration</span>: <span class="hljs-number">300</span>,
                      <span class="hljs-attr">iterations</span>: -<span class="hljs-number">1</span>,
                      <span class="hljs-attr">curve</span>: <span class="hljs-title class_">Curve</span>.<span class="hljs-property">EaseInOut</span>
                    })
                })
              }
              .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)
            }

            <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">agentState</span> === <span class="hljs-title class_">AgentState</span>.<span class="hljs-property">LISTENING</span> ? <span class="hljs-string">'æ­£åœ¨è†å¬...'</span> : <span class="hljs-string">'ç‚¹å‡»éº¦å…‹é£å¼€å§‹è¯´è¯'</span>)
              .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">14</span>)
              .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#666666'</span>)
              .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">8</span> })
          }
          .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)
          .<span class="hljs-title function_">height</span>(<span class="hljs-number">44</span>)
          .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-comment">// æ–‡å­—è¾“å…¥æ¡†</span>
          <span class="hljs-title class_">TextInput</span>({ <span class="hljs-attr">placeholder</span>: <span class="hljs-string">'è¾“å…¥æ¶ˆæ¯...'</span>, <span class="hljs-attr">text</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">inputText</span> })
            .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)
            .<span class="hljs-title function_">height</span>(<span class="hljs-number">44</span>)
            .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#F5F5F5'</span>)
            .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">22</span>)
            .<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">16</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">16</span> })
            .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">8</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">8</span> })
            .<span class="hljs-title function_">onChange</span>(<span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
              <span class="hljs-variable language_">this</span>.<span class="hljs-property">inputText</span> = value;
            })
            .<span class="hljs-title function_">onSubmit</span>(<span class="hljs-function">() =&gt;</span> {
              <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">sendMessage</span>();
            })

          <span class="hljs-comment">// å‘é€æŒ‰é’®</span>
          <span class="hljs-title class_">Button</span>() {
            <span class="hljs-title class_">Image</span>($r(<span class="hljs-string">'app.media.ic_send'</span>))
              .<span class="hljs-title function_">width</span>(<span class="hljs-number">24</span>)
              .<span class="hljs-title function_">height</span>(<span class="hljs-number">24</span>)
              .<span class="hljs-title function_">fillColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
          }
          .<span class="hljs-title function_">width</span>(<span class="hljs-number">44</span>)
          .<span class="hljs-title function_">height</span>(<span class="hljs-number">44</span>)
          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">inputText</span>.<span class="hljs-title function_">trim</span>() ? <span class="hljs-string">'#007DFF'</span> : <span class="hljs-string">'#CCCCCC'</span>)
          .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">22</span>)
          .<span class="hljs-title function_">enabled</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">inputText</span>.<span class="hljs-title function_">trim</span>().<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>)
          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">sendMessage</span>())
        }
      }
      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      .<span class="hljs-title function_">height</span>(<span class="hljs-number">70</span>)
      .<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">top</span>: <span class="hljs-number">8</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">16</span> })
      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
    }
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
  }

  <span class="hljs-comment">/**
   * æ¶ˆæ¯æ°”æ³¡ç»„ä»¶
   */</span>
  <span class="hljs-meta">@Builder</span>
  <span class="hljs-title class_">MessageBubble</span>(<span class="hljs-attr">message</span>: <span class="hljs-title class_">Message</span>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-keyword">if</span> (message.<span class="hljs-property">role</span> === <span class="hljs-title class_">MessageRole</span>.<span class="hljs-property">USER</span>) {
        <span class="hljs-comment">// ç”¨æˆ·æ¶ˆæ¯ï¼ˆå³ä¾§ï¼‰</span>
        <span class="hljs-title class_">Row</span>() {
          <span class="hljs-title class_">Blank</span>()

          <span class="hljs-title class_">Column</span>() {
            <span class="hljs-title class_">Text</span>(message.<span class="hljs-property">content</span>)
              .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">15</span>)
              .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
              .<span class="hljs-title function_">lineHeight</span>(<span class="hljs-number">22</span>)
          }
          .<span class="hljs-title function_">padding</span>(<span class="hljs-number">12</span>)
          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#007DFF'</span>)
          .<span class="hljs-title function_">borderRadius</span>({
            <span class="hljs-attr">topLeft</span>: <span class="hljs-number">16</span>,
            <span class="hljs-attr">topRight</span>: <span class="hljs-number">4</span>,
            <span class="hljs-attr">bottomLeft</span>: <span class="hljs-number">16</span>,
            <span class="hljs-attr">bottomRight</span>: <span class="hljs-number">16</span>
          })
          .<span class="hljs-title function_">constraintSize</span>({ <span class="hljs-attr">maxWidth</span>: <span class="hljs-string">'75%'</span> })

          <span class="hljs-comment">// ç”¨æˆ·å¤´åƒ</span>
          <span class="hljs-title class_">Image</span>($r(<span class="hljs-string">'app.media.ic_user'</span>))
            .<span class="hljs-title function_">width</span>(<span class="hljs-number">36</span>)
            .<span class="hljs-title function_">height</span>(<span class="hljs-number">36</span>)
            .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">18</span>)
            .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">8</span> })
        }
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
        .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">End</span>)
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// AIæ¶ˆæ¯ï¼ˆå·¦ä¾§ï¼‰</span>
        <span class="hljs-title class_">Row</span>() {
          <span class="hljs-comment">// AIå¤´åƒ</span>
          <span class="hljs-title class_">Stack</span>() {
            <span class="hljs-title class_">Circle</span>()
              .<span class="hljs-title function_">width</span>(<span class="hljs-number">36</span>)
              .<span class="hljs-title function_">height</span>(<span class="hljs-number">36</span>)
              .<span class="hljs-title function_">fill</span>(<span class="hljs-string">'#E6F2FF'</span>)

            <span class="hljs-title class_">Image</span>($r(<span class="hljs-string">'app.media.ic_robot'</span>))
              .<span class="hljs-title function_">width</span>(<span class="hljs-number">24</span>)
              .<span class="hljs-title function_">height</span>(<span class="hljs-number">24</span>)
          }
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">right</span>: <span class="hljs-number">8</span> })

          <span class="hljs-title class_">Column</span>() {
            <span class="hljs-title class_">Text</span>(message.<span class="hljs-property">content</span>)
              .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">15</span>)
              .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#333333'</span>)
              .<span class="hljs-title function_">lineHeight</span>(<span class="hljs-number">22</span>)

            <span class="hljs-comment">// æ˜¾ç¤ºæ—¶é—´</span>
            <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">formatTime</span>(message.<span class="hljs-property">timestamp</span>))
              .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">11</span>)
              .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#999999'</span>)
              .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">4</span> })
          }
          .<span class="hljs-title function_">padding</span>(<span class="hljs-number">12</span>)
          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
          .<span class="hljs-title function_">borderRadius</span>({
            <span class="hljs-attr">topLeft</span>: <span class="hljs-number">4</span>,
            <span class="hljs-attr">topRight</span>: <span class="hljs-number">16</span>,
            <span class="hljs-attr">bottomLeft</span>: <span class="hljs-number">16</span>,
            <span class="hljs-attr">bottomRight</span>: <span class="hljs-number">16</span>
          })
          .<span class="hljs-title function_">constraintSize</span>({ <span class="hljs-attr">maxWidth</span>: <span class="hljs-string">'75%'</span> })
          .<span class="hljs-title function_">alignItems</span>(<span class="hljs-title class_">HorizontalAlign</span>.<span class="hljs-property">Start</span>)
          .<span class="hljs-title function_">shadow</span>({
            <span class="hljs-attr">radius</span>: <span class="hljs-number">4</span>,
            <span class="hljs-attr">color</span>: <span class="hljs-string">'rgba(0,0,0,0.05)'</span>,
            <span class="hljs-attr">offsetX</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">offsetY</span>: <span class="hljs-number">2</span>
          })

          <span class="hljs-title class_">Blank</span>()
        }
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
        .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Start</span>)
      }
    }
  }
}
</code></pre>
<h3 data-id="heading-13">8. å¿«æ·æŒ‡ä»¤é¢æ¿ (components/QuickCommands.ets)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// entry/src/main/ets/components/QuickCommands.ets</span>

<span class="hljs-comment">/**
 * Vå“¥è®¾è®¡çš„å¿«æ·æŒ‡ä»¤é¢æ¿
 * æ–¹ä¾¿ç”¨æˆ·å¿«é€Ÿè§¦å‘å¸¸ç”¨åŠŸèƒ½
 */</span>

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">QuickCommand</span> {
  <span class="hljs-attr">icon</span>: <span class="hljs-title class_">Resource</span>;
  <span class="hljs-attr">label</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">command</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">color</span>: <span class="hljs-built_in">string</span>;
}

<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">export</span> struct <span class="hljs-title class_">QuickCommands</span> {
  <span class="hljs-attr">onCommand</span>: <span class="hljs-function">(<span class="hljs-params">command: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-built_in">void</span> = <span class="hljs-function">() =&gt;</span> {};

  <span class="hljs-keyword">private</span> <span class="hljs-attr">commands</span>: <span class="hljs-title class_">QuickCommand</span>[] = [
    { <span class="hljs-attr">icon</span>: $r(<span class="hljs-string">'app.media.ic_weather'</span>), <span class="hljs-attr">label</span>: <span class="hljs-string">'æŸ¥å¤©æ°”'</span>, <span class="hljs-attr">command</span>: <span class="hljs-string">'ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'#FFB800'</span> },
    { <span class="hljs-attr">icon</span>: $r(<span class="hljs-string">'app.media.ic_time'</span>), <span class="hljs-attr">label</span>: <span class="hljs-string">'æŸ¥æ—¶é—´'</span>, <span class="hljs-attr">command</span>: <span class="hljs-string">'ç°åœ¨å‡ ç‚¹äº†'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'#007DFF'</span> },
    { <span class="hljs-attr">icon</span>: $r(<span class="hljs-string">'app.media.ic_alarm'</span>), <span class="hljs-attr">label</span>: <span class="hljs-string">'è®¾é—¹é’Ÿ'</span>, <span class="hljs-attr">command</span>: <span class="hljs-string">'æ˜å¤©æ—©ä¸Š7ç‚¹å«æˆ‘èµ·åºŠ'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'#34C759'</span> },
    { <span class="hljs-attr">icon</span>: $r(<span class="hljs-string">'app.media.ic_remind'</span>), <span class="hljs-attr">label</span>: <span class="hljs-string">'æé†’æˆ‘'</span>, <span class="hljs-attr">command</span>: <span class="hljs-string">'10åˆ†é’Ÿåæé†’æˆ‘å–æ°´'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'#FF9500'</span> },
    { <span class="hljs-attr">icon</span>: $r(<span class="hljs-string">'app.media.ic_app'</span>), <span class="hljs-attr">label</span>: <span class="hljs-string">'æ‰“å¼€ç›¸æœº'</span>, <span class="hljs-attr">command</span>: <span class="hljs-string">'æ‰“å¼€ç›¸æœº'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'#AF52DE'</span> },
    { <span class="hljs-attr">icon</span>: $r(<span class="hljs-string">'app.media.ic_home'</span>), <span class="hljs-attr">label</span>: <span class="hljs-string">'å¼€ç¯'</span>, <span class="hljs-attr">command</span>: <span class="hljs-string">'æ‰“å¼€å®¢å…çš„ç¯'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'#FF3B30'</span> }
  ];

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'å¿«æ·æŒ‡ä»¤'</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">14</span>)
        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#999999'</span>)
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">12</span> })

      <span class="hljs-title class_">Flex</span>({ <span class="hljs-attr">wrap</span>: <span class="hljs-title class_">FlexWrap</span>.<span class="hljs-property">Wrap</span>, <span class="hljs-attr">justifyContent</span>: <span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">SpaceBetween</span> }) {
        <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">commands</span>, <span class="hljs-function">(<span class="hljs-params">cmd: QuickCommand</span>) =&gt;</span> {
          <span class="hljs-title class_">Column</span>() {
            <span class="hljs-title class_">Stack</span>() {
              <span class="hljs-title class_">Circle</span>()
                .<span class="hljs-title function_">width</span>(<span class="hljs-number">44</span>)
                .<span class="hljs-title function_">height</span>(<span class="hljs-number">44</span>)
                .<span class="hljs-title function_">fill</span>(cmd.<span class="hljs-property">color</span>)
                .<span class="hljs-title function_">opacity</span>(<span class="hljs-number">0.15</span>)

              <span class="hljs-title class_">Image</span>(cmd.<span class="hljs-property">icon</span>)
                .<span class="hljs-title function_">width</span>(<span class="hljs-number">24</span>)
                .<span class="hljs-title function_">height</span>(<span class="hljs-number">24</span>)
                .<span class="hljs-title function_">fillColor</span>(cmd.<span class="hljs-property">color</span>)
            }

            <span class="hljs-title class_">Text</span>(cmd.<span class="hljs-property">label</span>)
              .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">12</span>)
              .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#666666'</span>)
              .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">6</span> })
          }
          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'30%'</span>)
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">16</span> })
          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">onCommand</span>(cmd.<span class="hljs-property">command</span>);
          })
        })
      }
    }
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">padding</span>(<span class="hljs-number">16</span>)
    .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
    .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">12</span>)
  }
}
</code></pre>
<hr/>
<h2 data-id="heading-14">äº”ã€èµ„æºæ–‡ä»¶å‡†å¤‡</h2>
<h3 data-id="heading-15">éœ€è¦çš„å›¾æ ‡èµ„æº</h3>
<p>åœ¨ <code>entry/src/main/resources/base/media/</code> æ·»åŠ ä»¥ä¸‹å›¾æ ‡ï¼š</p>






































































<table><thead><tr><th>æ–‡ä»¶å</th><th>ç”¨é€”</th><th>å»ºè®®å°ºå¯¸</th></tr></thead><tbody><tr><td>ic_robot.svg</td><td>AIå¤´åƒ</td><td>48x48</td></tr><tr><td>ic_user.svg</td><td>ç”¨æˆ·å¤´åƒ</td><td>48x48</td></tr><tr><td>ic_send.svg</td><td>å‘é€æŒ‰é’®</td><td>24x24</td></tr><tr><td>ic_voice.svg</td><td>è¯­éŸ³æŒ‰é’®</td><td>24x24</td></tr><tr><td>ic_keyboard.svg</td><td>é”®ç›˜æŒ‰é’®</td><td>24x24</td></tr><tr><td>ic_clear.svg</td><td>æ¸…ç©ºæŒ‰é’®</td><td>24x24</td></tr><tr><td>ic_weather.svg</td><td>å¤©æ°”å›¾æ ‡</td><td>24x24</td></tr><tr><td>ic_time.svg</td><td>æ—¶é—´å›¾æ ‡</td><td>24x24</td></tr><tr><td>ic_alarm.svg</td><td>é—¹é’Ÿå›¾æ ‡</td><td>24x24</td></tr><tr><td>ic_remind.svg</td><td>æé†’å›¾æ ‡</td><td>24x24</td></tr><tr><td>ic_app.svg</td><td>åº”ç”¨å›¾æ ‡</td><td>24x24</td></tr><tr><td>ic_home.svg</td><td>æ™ºèƒ½å®¶å±…å›¾æ ‡</td><td>24x24</td></tr></tbody></table>
<h3 data-id="heading-16">ç¤ºä¾‹SVG</h3>
<p><strong>ic_robot.svg:</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">viewBox</span>=<span class="hljs-string">"0 0 48 48"</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://www.w3.org/2000/svg"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">"24"</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">"24"</span> <span class="hljs-attr">r</span>=<span class="hljs-string">"20"</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">"#007DFF"</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">"17"</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">"20"</span> <span class="hljs-attr">r</span>=<span class="hljs-string">"3"</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">"white"</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">"31"</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">"20"</span> <span class="hljs-attr">r</span>=<span class="hljs-string">"3"</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">"white"</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M16 30 Q24 36 32 30"</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">"white"</span> <span class="hljs-attr">stroke-width</span>=<span class="hljs-string">"2"</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">"none"</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">rect</span> <span class="hljs-attr">x</span>=<span class="hljs-string">"22"</span> <span class="hljs-attr">y</span>=<span class="hljs-string">"4"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"4"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"6"</span> <span class="hljs-attr">rx</span>=<span class="hljs-string">"2"</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">"#007DFF"</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">"24"</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">"4"</span> <span class="hljs-attr">r</span>=<span class="hljs-string">"3"</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">"#007DFF"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span>
</code></pre>
<p><strong>ic_voice.svg:</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">viewBox</span>=<span class="hljs-string">"0 0 24 24"</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://www.w3.org/2000/svg"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span>
</code></pre>
<hr/>
<h2 data-id="heading-17">å…­ã€Vå“¥æ€»ç»“ï¼šå…³é”®æŠ€æœ¯ç‚¹</h2>
<h3 data-id="heading-18">1. æ„å›¾è¯†åˆ«çš„è®¾è®¡æ€è·¯</h3>
<pre><code class="hljs language-markdown" lang="markdown">ç”¨æˆ·è¾“å…¥ â†’ è§„åˆ™åŒ¹é…ï¼ˆå¿«é€Ÿï¼‰ â†’ é«˜ç½®ä¿¡åº¦ç›´æ¥æ‰§è¡Œ
<span class="hljs-code">                â†“
         ä½ç½®ä¿¡åº¦ â†’ è°ƒç”¨LLMå…œåº•
</span></code></pre>
<h3 data-id="heading-19">2. å¯¹è¯ç®¡ç†çš„æ ¸å¿ƒ</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å¤šè½®å¯¹è¯çš„å…³é”®ï¼šä¸Šä¸‹æ–‡ç®¡ç†</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ConversationContext</span> {
  <span class="hljs-attr">messages</span>: <span class="hljs-title class_">Message</span>[] = [];
  <span class="hljs-attr">maxHistory</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">10</span>;  <span class="hljs-comment">// æ§åˆ¶å†å²é•¿åº¦ï¼Œé¿å…Tokenæµªè´¹</span>
}
</code></pre>
<h3 data-id="heading-20">3. è¯­éŸ³äº¤äº’çš„æœ€ä½³å®è·µ</h3>
<ul>
<li>å…ˆè¯·æ±‚æƒé™ï¼Œå†åˆå§‹åŒ–å¼•æ“</li>
<li>è¯­éŸ³è¯†åˆ«å’Œè¯­éŸ³åˆæˆç”¨å®Œè¦é‡Šæ”¾</li>
<li>åšå¥½é”™è¯¯å¤„ç†å’Œé™çº§æ–¹æ¡ˆ</li>
</ul>
<h3 data-id="heading-21">4. æ€§èƒ½ä¼˜åŒ–å»ºè®®</h3>
<ul>
<li>æ„å›¾è¯†åˆ«ç”¨æœ¬åœ°è§„åˆ™ï¼Œå¿«é€Ÿå“åº”</li>
<li>LLMè°ƒç”¨åšå¥½ç¼“å­˜å’Œé™æµ</li>
<li>æ¶ˆæ¯åˆ—è¡¨ä½¿ç”¨LazyForEachä¼˜åŒ–</li>
</ul>
<hr/>
<h2 data-id="heading-22">ä¸ƒã€Vå“¥å” ä¸¤å¥</h2>
<p>å…„å¼Ÿä»¬ï¼Œè¿™å¥—ä»£ç æ˜¯Vå“¥å®æˆ˜ä¸­æ€»ç»“å‡ºæ¥çš„ï¼Œå®Œæ•´å®ç°äº†ä¸€ä¸ªèƒ½ç”¨çš„AIæ™ºèƒ½ä½“ã€‚å½“ç„¶ï¼Œå®é™…é¡¹ç›®ä¸­ä½ è¿˜éœ€è¦ï¼š</p>
<ol>
<li><strong>æ¥å…¥çœŸå®çš„LLM API</strong>ï¼ˆæ›¿æ¢æ‰ç¤ºä¾‹é…ç½®ï¼‰</li>
<li><strong>å®Œå–„æ„å›¾è§„åˆ™åº“</strong>ï¼ˆæ ¹æ®ä½ çš„ä¸šåŠ¡åœºæ™¯ï¼‰</li>
<li><strong>æ¥å…¥çœŸå®çš„æ™ºèƒ½å®¶å±…API</strong></li>
<li><strong>åšå¥½å¼‚å¸¸å¤„ç†å’Œç”¨æˆ·å¼•å¯¼</strong></li>
</ol>
<p><strong>AIæ™ºèƒ½ä½“çš„æ ¸å¿ƒä¸æ˜¯æŠ€æœ¯å¤šç‰›é€¼ï¼Œè€Œæ˜¯ç”¨æˆ·ä½“éªŒåšå¾—å¥½ï¼</strong></p>
<hr/>
<p>å…³æ³¨Vå“¥ä¸è¿·è·¯ï¼å‰è¡Œè·¯ä¸Šä¸çŠ¯æ€µ!</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Linux å°ç¥ä¹‹è·¯ã€‘ç³»ç»Ÿç›‘æ§ & æ€§èƒ½åˆ†æç¥å™¨åˆé›†ï¼æœåŠ¡å™¨å¡æ…¢ / ç¨‹åºå´©æºƒä¸€é”®å®šä½]]></title>    <link>https://juejin.cn/post/7599868109085999146</link>    <guid>https://juejin.cn/post/7599868109085999146</guid>    <pubDate>2026-01-28T01:02:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599868109085999146" data-draft-id="7599843186203541546" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Linux å°ç¥ä¹‹è·¯ã€‘ç³»ç»Ÿç›‘æ§ &amp; æ€§èƒ½åˆ†æç¥å™¨åˆé›†ï¼æœåŠ¡å™¨å¡æ…¢ / ç¨‹åºå´©æºƒä¸€é”®å®šä½"/> <meta itemprop="keywords" content="åç«¯,Linux,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-28T01:02:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°æ¨åŒå­¦66"/> <meta itemprop="url" content="https://juejin.cn/user/1189004976589664"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Linux å°ç¥ä¹‹è·¯ã€‘ç³»ç»Ÿç›‘æ§ &amp; æ€§èƒ½åˆ†æç¥å™¨åˆé›†ï¼æœåŠ¡å™¨å¡æ…¢ / ç¨‹åºå´©æºƒä¸€é”®å®šä½
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1189004976589664/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°æ¨åŒå­¦66
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T01:02:54.000Z" title="Wed Jan 28 2026 01:02:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ã€Linux å°ç¥ä¹‹è·¯ã€‘ç³»ç»Ÿç›‘æ§ &amp; æ€§èƒ½åˆ†æç¥å™¨åˆé›†ï¼æœåŠ¡å™¨å¡æ…¢ / ç¨‹åºå´©æºƒä¸€é”®å®šä½</h2>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ä¸“æ³¨ Linux æŠ€æœ¯åˆ†äº«çš„å°æ¨ã€‚ä¸Šä¸€ç¯‡ç»™å¤§å®¶æ‹†è§£äº†æ–‡æœ¬å¤„ç† â€œä¸‰å‰‘å®¢â€ï¼Œè§£å†³äº†æ—¥å¿—åˆ†æã€æ‰¹é‡ä¿®æ”¹çš„æ ¸å¿ƒéœ€æ±‚ã€‚ä»Šå¤©æ¥ç€ Linux å·¥å…·ç³»åˆ—ï¼Œèšç„¦å¼€å‘è€… / è¿ç»´æœ€å¤´ç–¼çš„ â€œæœåŠ¡å™¨å¡æ…¢â€â€œç¨‹åºå´©æºƒâ€â€œå†…å­˜æ³„æ¼â€ é—®é¢˜ï¼Œæ•´ç†å‡º 5 æ¬¾å¿…å­¦çš„ç³»ç»Ÿç›‘æ§ä¸æ€§èƒ½åˆ†æå·¥å…· â€”â€” ä»åŸºç¡€çš„ topã€htop åˆ°ä¸“ä¸šçš„ perfã€valgrindï¼Œç»“åˆå®æˆ˜åœºæ™¯æ•™ä½ æ€ä¹ˆç”¨å·¥å…· â€œçœ‹é€â€ ç³»ç»Ÿè¿è¡ŒçŠ¶æ€ï¼Œå¿«é€Ÿå®šä½é—®é¢˜æ ¹æºã€‚</p>
<h3 data-id="heading-1">ä¸€ã€å…ˆæ˜ç¡®ï¼šä¸åŒé—®é¢˜å¯¹åº”ä¸åŒå·¥å…·</h3>
<p>é‡åˆ°ç³»ç»Ÿæˆ–ç¨‹åºå¼‚å¸¸æ—¶ï¼Œä¸ç”¨ç›²ç›®å°è¯•å·¥å…·ï¼Œå…ˆåˆ¤æ–­é—®é¢˜ç±»å‹ï¼Œå†ç²¾å‡†é€‰æ‹©ï¼š</p>
<ul>
<li>æœåŠ¡å™¨æ•´ä½“å¡æ…¢ï¼ˆCPU / å†…å­˜å ç”¨é«˜ï¼‰ï¼šç”¨ top/htop å¿«é€ŸæŸ¥çœ‹å…¨å±€çŠ¶æ€ï¼›</li>
<li>ç¨‹åºå´©æºƒï¼ˆæ®µé”™è¯¯ã€æ ¸å¿ƒ dumpï¼‰ï¼šç”¨ gdb è°ƒè¯•å®šä½ä»£ç è¡Œï¼›</li>
<li>æ€§èƒ½ç“¶é¢ˆï¼ˆå‡½æ•°æ‰§è¡Œè€—æ—¶ã€èµ„æºæµªè´¹ï¼‰ï¼šç”¨ perf åˆ†æ CPU çƒ­ç‚¹ï¼›</li>
<li>å†…å­˜æ³„æ¼ï¼ˆé•¿æœŸè¿è¡Œåå†…å­˜æš´æ¶¨ï¼‰ï¼šç”¨ valgrind æ£€æµ‹éæ³•å†…å­˜æ“ä½œï¼›</li>
<li>ç£ç›˜ / IO å‹åŠ›å¤§ï¼ˆè¯»å†™æ…¢ï¼‰ï¼šç”¨ iostat/df æŸ¥çœ‹ç£ç›˜çŠ¶æ€ã€‚</li>
</ul>
<p>ä¸‹é¢æŒ‰ â€œå·¥å…· + åœºæ™¯ + å®æˆ˜å‘½ä»¤â€ çš„ç»“æ„ï¼Œé€ä¸ªæ‹†è§£æ¯æ¬¾å·¥å…·çš„æ ¸å¿ƒç”¨æ³•ï¼Œæ–°æ‰‹ç›´æ¥å¥—ç”¨ï¼</p>
<h3 data-id="heading-2">äºŒã€åŸºç¡€ç›‘æ§ï¼štop/htopï¼ˆå…¨å±€çŠ¶æ€ä¸€çœ¼çœ‹ç©¿ï¼‰</h3>
<p>top æ˜¯ Linux è‡ªå¸¦çš„åŸºç¡€ç›‘æ§å·¥å…·ï¼Œhtop æ˜¯å®ƒçš„å¢å¼ºç‰ˆï¼ˆç•Œé¢æ›´å‹å¥½ã€æ”¯æŒé¼ æ ‡æ“ä½œï¼‰ï¼Œä¸¤è€…éƒ½æ˜¯ â€œç¬¬ä¸€æ—¶é—´åˆ¤æ–­ç³»ç»ŸçŠ¶æ€â€ çš„é¦–é€‰ã€‚</p>
<h4 data-id="heading-3">1. topï¼šç³»ç»Ÿè‡ªå¸¦ï¼Œæ— é—¨æ§›ä½¿ç”¨</h4>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç›´æ¥è¿è¡Œï¼Œå®æ—¶åˆ·æ–°ç³»ç»ŸçŠ¶æ€ï¼ˆé»˜è®¤3ç§’åˆ·æ–°ä¸€æ¬¡ï¼‰</span>
top
</code></pre>
<h5 data-id="heading-4">æ ¸å¿ƒç•Œé¢è§£è¯»ï¼ˆé‡ç‚¹å…³æ³¨è¿™ 3 éƒ¨åˆ†ï¼‰</h5>
<ul>
<li>
<p>é¡¶éƒ¨ç³»ç»Ÿä¿¡æ¯ï¼š</p>
<ul>
<li><code>Cpu(s)</code>ï¼šCPU ä½¿ç”¨ç‡ï¼ˆus = ç”¨æˆ·è¿›ç¨‹å ç”¨ï¼Œsy = ç³»ç»Ÿå†…æ ¸å ç”¨ï¼Œid = ç©ºé—²ï¼‰ï¼›</li>
<li><code>Mem</code>ï¼šç‰©ç†å†…å­˜ä½¿ç”¨ï¼ˆtotal = æ€»å†…å­˜ï¼Œused = å·²ç”¨ï¼Œfree = ç©ºé—²ï¼Œbuff/cache = ç¼“å­˜ï¼‰ï¼›</li>
<li><code>Swap</code>ï¼šäº¤æ¢åˆ†åŒºä½¿ç”¨ï¼ˆSwap å ç”¨é«˜è¯´æ˜ç‰©ç†å†…å­˜ä¸è¶³ï¼Œä¼šå¯¼è‡´ç³»ç»Ÿå¡é¡¿ï¼‰ï¼›</li>
</ul>
</li>
<li>
<p>ä¸­é—´è¿›ç¨‹åˆ—è¡¨ï¼š</p>
<ul>
<li><code>PID</code>ï¼šè¿›ç¨‹ IDï¼ˆæ€æ­»è¿›ç¨‹ç”¨<code>kill -9 PID</code>ï¼‰ï¼›</li>
<li><code>%CPU</code>/<code>%MEM</code>ï¼šè¿›ç¨‹å ç”¨çš„ CPU / å†…å­˜ç™¾åˆ†æ¯”ï¼›</li>
<li><code>COMMAND</code>ï¼šè¿›ç¨‹åç§°ï¼ˆæ¯”å¦‚<code>java</code>ã€<code>gcc</code>ã€<code>nginx</code>ï¼‰ï¼›</li>
</ul>
</li>
<li>
<p>å¸¸ç”¨å¿«æ·é”®ï¼š</p>
<ul>
<li><code>P</code>ï¼šæŒ‰ CPU ä½¿ç”¨ç‡æ’åºï¼ˆæ‰¾å ç”¨ CPU æœ€é«˜çš„è¿›ç¨‹ï¼‰ï¼›</li>
<li><code>M</code>ï¼šæŒ‰å†…å­˜ä½¿ç”¨ç‡æ’åºï¼ˆæ‰¾å†…å­˜å¤§æˆ·ï¼‰ï¼›</li>
<li><code>k</code>ï¼šè¾“å…¥ PID æ€æ­»è¿›ç¨‹ï¼ˆæ— éœ€é€€å‡º topï¼‰ï¼›</li>
<li><code>q</code>ï¼šé€€å‡º topã€‚</li>
</ul>
</li>
</ul>
<h5 data-id="heading-5">å®æˆ˜åœºæ™¯ï¼šå¿«é€Ÿå®šä½é«˜å ç”¨è¿›ç¨‹</h5>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-comment"># 1. è¿è¡ŒtopåæŒ‰Pæ’åºï¼Œæ‰¾åˆ°CPUå ç”¨æœ€é«˜çš„è¿›ç¨‹ï¼ˆæ¯”å¦‚PID=1234ï¼‰</span>
<span class="hljs-comment"># 2. æŸ¥çœ‹è¯¥è¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯ï¼ˆæ¯”å¦‚æ˜¯å“ªä¸ªç¨‹åºï¼‰</span>
ps -ef | <span class="hljs-keyword">grep</span> <span class="hljs-number">1234</span>
<span class="hljs-comment"># 3. è‹¥ç¡®è®¤æ˜¯æ— ç”¨è¿›ç¨‹ï¼Œç›´æ¥æ€æ­»</span>
<span class="hljs-keyword">kill</span> -<span class="hljs-number">9</span> <span class="hljs-number">1234</span>
</code></pre>
<h4 data-id="heading-6">2. htopï¼šé¢œå€¼æ›´é«˜ï¼Œæ“ä½œæ›´å‹å¥½</h4>
<p>top çš„ç•Œé¢æ¯”è¾ƒç®€é™‹ï¼Œhtop ä¼˜åŒ–äº†æ˜¾ç¤ºæ•ˆæœï¼Œè¿˜æ”¯æŒé¼ æ ‡ç‚¹å‡»æ’åºï¼Œæ¨èå®‰è£…ä½¿ç”¨ï¼š</p>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…htopï¼ˆUbuntu/Debianï¼‰</span>
sudo apt install htop
<span class="hljs-comment"># è¿è¡Œ</span>
htop
</code></pre>
<h5 data-id="heading-7">æ ¸å¿ƒä¼˜åŠ¿</h5>
<ul>
<li>æ”¯æŒé¼ æ ‡ç‚¹å‡»åˆ—åæ’åºï¼ˆæ¯”å¦‚ç‚¹å‡»<code>%CPU</code>æŒ‰ CPU æ’åºï¼‰ï¼›</li>
<li>è¿›ç¨‹é¢œè‰²åŒºåˆ†ï¼ˆä¸åŒç±»å‹è¿›ç¨‹æ˜¾ç¤ºä¸åŒé¢œè‰²ï¼Œæ›´ç›´è§‚ï¼‰ï¼›</li>
<li>æ”¯æŒæ¨ªå‘æ»šåŠ¨ï¼ŒæŸ¥çœ‹é•¿å‘½ä»¤è¡Œï¼›</li>
<li>å¿«æ·é”®æ›´ä¸°å¯Œï¼ˆ<code>F6</code>é€‰æ‹©æ’åºå­—æ®µï¼Œ<code>F9</code>ç›´æ¥é€‰æ‹©ä¿¡å·æ€æ­»è¿›ç¨‹ï¼‰ã€‚</li>
</ul>
<h5 data-id="heading-8">å®æˆ˜åœºæ™¯ï¼šç›‘æ§åµŒå…¥å¼å¼€å‘æ¿çŠ¶æ€</h5>
<p>åµŒå…¥å¼å¼€å‘ä¸­ï¼Œç”¨ htop æŸ¥çœ‹å¼€å‘æ¿çš„ CPU / å†…å­˜å ç”¨ï¼Œé¿å…ç¨‹åºå ç”¨èµ„æºè¿‡é«˜å¯¼è‡´å´©æºƒï¼š</p>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç™»å½•å¼€å‘æ¿åè¿è¡Œhtop</span>
htop
<span class="hljs-comment"># é‡ç‚¹å…³æ³¨ï¼šåµŒå…¥å¼è®¾å¤‡å†…å­˜æœ‰é™ï¼Œè‹¥Memçš„usedå æ¯”è¶…è¿‡80%ï¼Œéœ€æ’æŸ¥å†…å­˜æ³„æ¼</span>
</code></pre>
<h3 data-id="heading-9">ä¸‰ã€ç¨‹åºè°ƒè¯•ï¼šgdbï¼ˆå´©æºƒé—®é¢˜ç²¾å‡†å®šä½ï¼‰</h3>
<p>ä¸Šä¸€ç¯‡æåˆ°è¿‡ gdb æ˜¯å‘½ä»¤è¡Œè°ƒè¯•ç¥å™¨ï¼Œå½“ç¨‹åºå‡ºç° â€œæ®µé”™è¯¯ï¼ˆSegmentation faultï¼‰â€â€œæ ¸å¿ƒ dumpâ€ æ—¶ï¼Œgdb èƒ½ç›´æ¥å®šä½åˆ°å‡ºé”™çš„ä»£ç è¡Œï¼Œæ˜¯ C/C++ å¼€å‘è€…å¿…å¤‡å·¥å…·ã€‚</p>
<h4 data-id="heading-10">1. æ ¸å¿ƒè°ƒè¯•æµç¨‹ï¼ˆå¿…è®°ï¼‰</h4>
<h5 data-id="heading-11">ï¼ˆ1ï¼‰ç”Ÿæˆå¯è°ƒè¯•æ–‡ä»¶</h5>
<p>ç¼–è¯‘æ—¶å¿…é¡»åŠ <code>-g</code>å‚æ•°ï¼Œå¦åˆ™ gdb æ— æ³•è·å–è°ƒè¯•ä¿¡æ¯ï¼š</p>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta"># ç¼–è¯‘Cç¨‹åºï¼Œç”Ÿæˆå¯è°ƒå¼æ–‡ä»¶a.out</span>
gcc -g test.c -o a.<span class="hljs-keyword">out</span>
</code></pre>
<h5 data-id="heading-12">ï¼ˆ2ï¼‰å¯åŠ¨ gdb è°ƒè¯•</h5>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ–¹å¼1ï¼šç›´æ¥å¯åŠ¨ç¨‹åºè°ƒè¯•</span>
gdb ./a.out
<span class="hljs-comment"># æ–¹å¼2ï¼šè°ƒè¯•å·²å´©æºƒçš„æ ¸å¿ƒdumpæ–‡ä»¶ï¼ˆéœ€å…ˆå¼€å¯core dumpï¼‰</span>
<span class="hljs-comment"># 1. å¼€å¯core dumpï¼ˆä¸´æ—¶ç”Ÿæ•ˆï¼‰</span>
<span class="hljs-built_in">ulimit</span> -c unlimited
<span class="hljs-comment"># 2. è¿è¡Œç¨‹åºï¼Œå´©æºƒåç”Ÿæˆcoreæ–‡ä»¶</span>
./a.out
<span class="hljs-comment"># 3. ç”¨gdbè°ƒè¯•coreæ–‡ä»¶</span>
gdb ./a.out core
</code></pre>
<h5 data-id="heading-13">ï¼ˆ3ï¼‰å¸¸ç”¨è°ƒè¯•å‘½ä»¤ï¼ˆå®æˆ˜é«˜é¢‘ï¼‰</h5>




























































<table><thead><tr><th>å‘½ä»¤</th><th>åŠŸèƒ½</th><th>å®æˆ˜ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>list/l</code></td><td>æŸ¥çœ‹ä»£ç ï¼ˆé»˜è®¤å‰ 10 è¡Œï¼‰</td><td><code>l 15</code>ï¼ˆæŸ¥çœ‹ç¬¬ 15 è¡Œä¸Šä¸‹ 5 è¡Œï¼‰</td></tr><tr><td><code>break/b</code></td><td>è®¾ç½®æ–­ç‚¹</td><td><code>b 20</code>ï¼ˆåœ¨ç¬¬ 20 è¡Œè®¾æ–­ç‚¹ï¼‰</td></tr><tr><td><code>info b</code></td><td>æŸ¥çœ‹æ–­ç‚¹ä¿¡æ¯</td><td><code>info b</code>ï¼ˆåˆ—å‡ºæ‰€æœ‰æ–­ç‚¹ï¼‰</td></tr><tr><td><code>delete/d</code></td><td>åˆ é™¤æ–­ç‚¹</td><td><code>d 1</code>ï¼ˆåˆ é™¤ç¼–å·ä¸º 1 çš„æ–­ç‚¹ï¼‰</td></tr><tr><td><code>run/r</code></td><td>è¿è¡Œç¨‹åº</td><td><code>r</code>ï¼ˆå¯åŠ¨ç¨‹åºï¼Œé‡åˆ°æ–­ç‚¹åœæ­¢ï¼‰</td></tr><tr><td><code>next/n</code></td><td>å•æ­¥æ‰§è¡Œï¼ˆè·³è¿‡å‡½æ•°ï¼‰</td><td><code>n</code>ï¼ˆæ‰§è¡Œä¸‹ä¸€è¡Œï¼Œä¸è¿›å…¥å‡½æ•°ï¼‰</td></tr><tr><td><code>step/s</code></td><td>å•æ­¥æ‰§è¡Œï¼ˆè¿›å…¥å‡½æ•°ï¼‰</td><td><code>s</code>ï¼ˆæ‰§è¡Œä¸‹ä¸€è¡Œï¼Œè¿›å…¥å‡½æ•°å†…éƒ¨ï¼‰</td></tr><tr><td><code>print/p</code></td><td>æŸ¥çœ‹å˜é‡å€¼</td><td><code>p sum</code>ï¼ˆæŸ¥çœ‹å˜é‡ sum çš„å€¼ï¼‰</td></tr><tr><td><code>cont/c</code></td><td>ç»§ç»­è¿è¡Œ</td><td><code>c</code>ï¼ˆä»æ–­ç‚¹å¤„ç»§ç»­è¿è¡Œï¼‰</td></tr><tr><td><code>quit/q</code></td><td>é€€å‡º gdb</td><td><code>q</code></td></tr></tbody></table>
<h4 data-id="heading-14">2. å®æˆ˜åœºæ™¯ï¼šå®šä½æ®µé”™è¯¯</h4>
<p>ç¨‹åºè¿è¡Œæ—¶æç¤º â€œSegmentation faultâ€ï¼Œç”¨ gdb å¿«é€Ÿå®šä½ï¼š</p>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. ç¼–è¯‘å¯è°ƒå¼æ–‡ä»¶</span>
gcc -g segfault.c -o segfault
<span class="hljs-comment"># 2. å¯åŠ¨gdb</span>
gdb ./segfault
<span class="hljs-comment"># 3. è¿è¡Œç¨‹åº</span>
(gdb) r
<span class="hljs-comment"># 4. ç¨‹åºå´©æºƒåï¼Œgdbä¼šæ˜¾ç¤ºå‡ºé”™ä½ç½®</span>
<span class="hljs-comment"># æ¯”å¦‚æç¤ºï¼šProgram received signal SIGSEGV, Segmentation fault. åœ¨main () at segfault.c:12</span>
<span class="hljs-comment"># ç›´æ¥å®šä½åˆ°ç¬¬12è¡Œä»£ç æœ‰é—®é¢˜ï¼ˆæ¯”å¦‚æ•°ç»„è¶Šç•Œã€é‡æŒ‡é’ˆï¼‰</span>
</code></pre>
<h4 data-id="heading-15">3. åµŒå…¥å¼é€‚é…</h4>
<p>åµŒå…¥å¼å¼€å‘ä¸­ï¼Œè‹¥å¼€å‘æ¿æ”¯æŒï¼Œå¯é€šè¿‡ gdb è¿œç¨‹è°ƒè¯•ï¼š</p>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¼€å‘æ¿ç«¯è¿è¡Œgdbserver</span>
gdbserver 192.168.0.100:1234 ./app
<span class="hljs-comment"># ä¸»æœºç«¯è¿è¡Œgdbï¼Œè¿æ¥å¼€å‘æ¿</span>
arm-linux-gnueabihf-gdb ./app
(gdb) target remote 192.168.0.100:1234
</code></pre>
<h3 data-id="heading-16">å››ã€æ€§èƒ½åˆ†æï¼šperfï¼ˆCPU çƒ­ç‚¹ç²¾å‡†æ•æ‰ï¼‰</h3>
<p>perf æ˜¯ Linux å†…æ ¸è‡ªå¸¦çš„æ€§èƒ½åˆ†æå·¥å…·ï¼Œèƒ½ç²¾å‡†æ•æ‰ CPU çƒ­ç‚¹ï¼ˆæ¯”å¦‚å“ªä¸ªå‡½æ•°å ç”¨ CPU æœ€å¤šï¼‰ï¼Œé€‚åˆä¼˜åŒ–ç¨‹åºæ€§èƒ½ã€è§£å†³ â€œç¨‹åºè¿è¡Œæ…¢â€ é—®é¢˜ã€‚</p>
<h4 data-id="heading-17">1. å®‰è£…ä¸åŸºç¡€ç”¨æ³•</h4>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…perfï¼ˆUbuntu/Debianï¼‰</span>
sudo apt install linux-tools-common
<span class="hljs-comment"># æŸ¥çœ‹perfæ”¯æŒçš„äº‹ä»¶</span>
perf list
</code></pre>
<h5 data-id="heading-18">æ ¸å¿ƒå‘½ä»¤ï¼šperf topï¼ˆå®æ—¶æŸ¥çœ‹ CPU çƒ­ç‚¹ï¼‰</h5>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®æ—¶æ˜¾ç¤ºå ç”¨CPUæœ€é«˜çš„å‡½æ•°/è¿›ç¨‹</span>
sudo perf top
</code></pre>
<h5 data-id="heading-19">ç•Œé¢è§£è¯»</h5>
<ul>
<li>ç¬¬ä¸€åˆ—<code>Overhead</code>ï¼šå‡½æ•°å ç”¨ CPU çš„ç™¾åˆ†æ¯”ï¼›</li>
<li>ç¬¬äºŒåˆ—<code>Shared</code>ï¼šå‡½æ•°æ‰€åœ¨çš„å…±äº«åº“ï¼›</li>
<li>ç¬¬ä¸‰åˆ—<code>Object</code>ï¼šå‡½æ•°æ‰€åœ¨çš„å¯æ‰§è¡Œæ–‡ä»¶ / åº“æ–‡ä»¶ï¼›</li>
<li>ç¬¬å››åˆ—<code>Symbol</code>ï¼šå‡½æ•°åï¼ˆæ ¸å¿ƒå…³æ³¨ï¼Œæ¯”å¦‚<code>main</code>ã€<code>printf</code>ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-20">2. è¿›é˜¶ç”¨æ³•ï¼šperf record/reportï¼ˆè¯¦ç»†åˆ†æï¼‰</h4>
<p><code>perf top</code>æ˜¯å®æ—¶æŸ¥çœ‹ï¼Œ<code>perf record</code>å¯ä»¥è®°å½•ç¨‹åºè¿è¡Œè¿‡ç¨‹ï¼Œåç»­ç”¨<code>perf report</code>ç”Ÿæˆè¯¦ç»†æŠ¥å‘Šï¼š</p>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. è®°å½•ç¨‹åºè¿è¡Œçš„æ€§èƒ½æ•°æ®ï¼ˆ-gè¡¨ç¤ºè®°å½•è°ƒç”¨æ ˆï¼‰</span>
sudo perf record -g ./a.out
<span class="hljs-comment"># 2. ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š</span>
sudo perf report
</code></pre>
<h5 data-id="heading-21">å®æˆ˜åœºæ™¯ï¼šä¼˜åŒ–åµŒå…¥å¼ç¨‹åºæ€§èƒ½</h5>
<p>åµŒå…¥å¼ç¨‹åºè¿è¡Œæ…¢ï¼Œç”¨ perf åˆ†æå“ªä¸ªå‡½æ•°å ç”¨ CPU æœ€å¤šï¼š</p>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. åœ¨å¼€å‘æ¿ä¸Šè®°å½•ç¨‹åºæ€§èƒ½æ•°æ®</span>
perf record -g ./sensor_app
<span class="hljs-comment"># 2. ç”ŸæˆæŠ¥å‘Š</span>
perf report
<span class="hljs-comment"># 3. è‹¥æŸå‡½æ•°ï¼ˆæ¯”å¦‚`data_process`ï¼‰å ç”¨CPUè¶…è¿‡50%ï¼Œéœ€ä¼˜åŒ–è¯¥å‡½æ•°çš„ç®—æ³•ï¼ˆæ¯”å¦‚å‡å°‘å¾ªç¯æ¬¡æ•°ã€é¿å…é‡å¤è®¡ç®—ï¼‰</span>
</code></pre>
<h4 data-id="heading-22">3. å…³é”®ä¼˜åŠ¿</h4>
<ul>
<li>å†…æ ¸çº§å·¥å…·ï¼Œæ€§èƒ½å¼€é”€å°ï¼ˆä¸å½±å“ç¨‹åºæ­£å¸¸è¿è¡Œï¼‰ï¼›</li>
<li>æ”¯æŒå¤šç§äº‹ä»¶ï¼ˆCPU å‘¨æœŸã€ç¼“å­˜å‘½ä¸­ã€åˆ†æ”¯é¢„æµ‹ç­‰ï¼‰ï¼›</li>
<li>å¯åˆ†æç”¨æˆ·æ€å’Œå†…æ ¸æ€ä»£ç ï¼ˆé€‚åˆè°ƒè¯•é©±åŠ¨ç¨‹åºï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-23">äº”ã€å†…å­˜æ£€æµ‹ï¼švalgrindï¼ˆå†…å­˜æ³„æ¼å…‹æ˜Ÿï¼‰</h3>
<p>å†…å­˜æ³„æ¼æ˜¯åµŒå…¥å¼å¼€å‘çš„ â€œé¡½ç–¾â€â€”â€” ç¨‹åºé•¿æœŸè¿è¡Œåå†…å­˜å ç”¨è¶Šæ¥è¶Šé«˜ï¼Œæœ€ç»ˆå´©æºƒã€‚valgrind çš„<code>memcheck</code>å·¥å…·èƒ½æ£€æµ‹å‡ºéæ³•å†…å­˜è®¿é—®ã€å†…å­˜æ³„æ¼ã€ä½¿ç”¨æœªåˆå§‹åŒ–å˜é‡ç­‰é—®é¢˜ã€‚</p>
<h4 data-id="heading-24">1. å®‰è£…ä¸åŸºç¡€ç”¨æ³•</h4>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å®‰è£…valgrindï¼ˆUbuntu/Debianï¼‰</span>
sudo apt install valgrind
<span class="hljs-comment"># æ£€æµ‹ç¨‹åºå†…å­˜é—®é¢˜ï¼ˆ--leak-check=fullè¡¨ç¤ºå…¨é¢æ£€æµ‹å†…å­˜æ³„æ¼ï¼‰</span>
valgrind <span class="hljs-attr">--leak-check</span>=full ./a.out
</code></pre>
<h4 data-id="heading-25">2. æ ¸å¿ƒæ£€æµ‹åŠŸèƒ½</h4>
<h5 data-id="heading-26">ï¼ˆ1ï¼‰å†…å­˜æ³„æ¼æ£€æµ‹</h5>
<p>ç¨‹åºè¿è¡Œç»“æŸåï¼Œvalgrind ä¼šæ˜¾ç¤º â€œdefinitely lostâ€ï¼ˆç¡®è®¤æ³„æ¼ï¼‰ã€â€œpossibly lostâ€ï¼ˆå¯èƒ½æ³„æ¼ï¼‰çš„å†…å­˜å¤§å°å’Œä½ç½®ï¼š</p>
<p>plaintext</p>
<pre><code class="hljs language-ini" lang="ini">==<span class="hljs-attr">1234</span>== LEAK SUMMARY:
==<span class="hljs-attr">1234</span>==    definitely lost: <span class="hljs-number">100</span> bytes in <span class="hljs-number">1</span> blocks
==<span class="hljs-attr">1234</span>==    indirectly lost: <span class="hljs-number">200</span> bytes in <span class="hljs-number">2</span> blocks
==<span class="hljs-attr">1234</span>==      possibly lost: <span class="hljs-number">0</span> bytes in <span class="hljs-number">0</span> blocks
</code></pre>
<h5 data-id="heading-27">ï¼ˆ2ï¼‰éæ³•å†…å­˜è®¿é—®æ£€æµ‹</h5>
<p>æ¯”å¦‚æ•°ç»„è¶Šç•Œã€ä½¿ç”¨é‡æŒ‡é’ˆã€é‡Šæ”¾åå†æ¬¡è®¿é—®å†…å­˜ç­‰ï¼Œvalgrind ä¼šç›´æ¥å®šä½åˆ°ä»£ç è¡Œï¼š</p>
<p>plaintext</p>
<pre><code class="hljs language-less" lang="less">==<span class="hljs-number">1234</span>== <span class="hljs-selector-tag">Invalid</span> <span class="hljs-selector-tag">write</span> <span class="hljs-selector-tag">of</span> <span class="hljs-selector-tag">size</span> <span class="hljs-number">4</span>
==<span class="hljs-number">1234</span>==    <span class="hljs-selector-tag">at</span> <span class="hljs-number">0</span><span class="hljs-selector-tag">x400523</span>: <span class="hljs-selector-tag">main</span> (test.<span class="hljs-attribute">c</span>:<span class="hljs-number">15</span>)
==<span class="hljs-number">1234</span>==  <span class="hljs-selector-tag">Address</span> <span class="hljs-number">0</span><span class="hljs-selector-tag">x5204040</span> <span class="hljs-selector-tag">is</span> <span class="hljs-number">0</span> <span class="hljs-selector-tag">bytes</span> <span class="hljs-selector-tag">after</span> <span class="hljs-selector-tag">a</span> <span class="hljs-selector-tag">block</span> <span class="hljs-selector-tag">of</span> <span class="hljs-selector-tag">size</span> <span class="hljs-number">16</span> <span class="hljs-selector-tag">alloc</span>'<span class="hljs-selector-tag">d</span>
==<span class="hljs-number">1234</span>==    <span class="hljs-selector-tag">at</span> <span class="hljs-number">0</span><span class="hljs-selector-tag">x4C2DB8F</span>: <span class="hljs-selector-tag">malloc</span> (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==<span class="hljs-number">1234</span>==    <span class="hljs-selector-tag">by</span> <span class="hljs-number">0</span><span class="hljs-selector-tag">x400513</span>: <span class="hljs-selector-tag">main</span> (test.<span class="hljs-attribute">c</span>:<span class="hljs-number">10</span>)
</code></pre>
<p>æç¤ºç¬¬ 15 è¡Œæœ‰éæ³•å†™æ“ä½œï¼ŒåŸå› æ˜¯ç¬¬ 10 è¡Œ<code>malloc</code>åˆ†é…çš„å†…å­˜åªæœ‰ 16 å­—èŠ‚ï¼Œç¬¬ 15 è¡Œè®¿é—®äº†è¶…å‡ºèŒƒå›´çš„åœ°å€ã€‚</p>
<h4 data-id="heading-28">3. å®æˆ˜åœºæ™¯ï¼šåµŒå…¥å¼ç¨‹åºå†…å­˜æ£€æµ‹</h4>
<p>åµŒå…¥å¼è®¾å¤‡å†…å­˜æœ‰é™ï¼Œå†…å­˜æ³„æ¼ä¼šç›´æ¥å¯¼è‡´ç¨‹åºå´©æºƒï¼Œç”¨ valgrind æå‰æ£€æµ‹ï¼š</p>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ£€æµ‹åµŒå…¥å¼ç¨‹åºï¼ˆéœ€äº¤å‰ç¼–è¯‘valgrindï¼Œæˆ–åœ¨ä»¿çœŸç¯å¢ƒä¸­è¿è¡Œï¼‰</span>
valgrind <span class="hljs-attr">--leak-check</span>=full ./embedded_app
<span class="hljs-comment"># é‡ç‚¹å…³æ³¨ï¼šdefinitely lostå¿…é¡»ä¸º0ï¼Œå¦åˆ™éœ€æ’æŸ¥malloc/freeæ˜¯å¦é…å¯¹</span>
</code></pre>
<h3 data-id="heading-29">å…­ã€ç£ç›˜ / IO ç›‘æ§ï¼šiostat/dfï¼ˆè¯»å†™å‹åŠ›æ’æŸ¥ï¼‰</h3>
<p>å¦‚æœæœåŠ¡å™¨å¡æ…¢æ˜¯ â€œç£ç›˜è¯»å†™å¿™â€ å¯¼è‡´çš„ï¼ˆæ¯”å¦‚é¢‘ç¹å†™æ—¥å¿—ã€æ‹·è´å¤§æ–‡ä»¶ï¼‰ï¼Œç”¨ iostat å’Œ df å·¥å…·æ’æŸ¥ï¼š</p>
<h4 data-id="heading-30">1. dfï¼šæŸ¥çœ‹ç£ç›˜ç©ºé—´ä½¿ç”¨</h4>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹æ‰€æœ‰ç£ç›˜åˆ†åŒºçš„ç©ºé—´ä½¿ç”¨ï¼ˆ-hè¡¨ç¤ºäººæ€§åŒ–æ˜¾ç¤ºï¼Œå¦‚GB/MBï¼‰</span>
<span class="hljs-built_in">df</span> -h
</code></pre>
<h5 data-id="heading-31">å®æˆ˜åœºæ™¯</h5>
<ul>
<li>è‹¥æŸåˆ†åŒºçš„<code>Use%</code>è¶…è¿‡ 90%ï¼Œè¯´æ˜ç£ç›˜ç©ºé—´ä¸è¶³ï¼Œéœ€åˆ é™¤æ— ç”¨æ–‡ä»¶ï¼ˆæ¯”å¦‚æ—¥å¿—ã€ä¸´æ—¶æ–‡ä»¶ï¼‰ï¼›</li>
<li>åµŒå…¥å¼å¼€å‘ä¸­ï¼Œdf æŸ¥çœ‹å¼€å‘æ¿çš„ Flash ä½¿ç”¨æƒ…å†µï¼Œé¿å… Flash å†™æ»¡å¯¼è‡´æ— æ³•å­˜å‚¨æ•°æ®ã€‚</li>
</ul>
<h4 data-id="heading-32">2. iostatï¼šæŸ¥çœ‹ç£ç›˜ IO å‹åŠ›</h4>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…iostat</span>
sudo apt install sysstat
<span class="hljs-comment"># æŸ¥çœ‹ç£ç›˜IOçŠ¶æ€ï¼ˆ-xè¡¨ç¤ºæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼Œ1è¡¨ç¤ºæ¯ç§’åˆ·æ–°ä¸€æ¬¡ï¼‰</span>
iostat -x 1
</code></pre>
<h5 data-id="heading-33">æ ¸å¿ƒæŒ‡æ ‡è§£è¯»</h5>
<ul>
<li><code>%util</code>ï¼šç£ç›˜ IO åˆ©ç”¨ç‡ï¼ˆè¶…è¿‡ 80% è¯´æ˜ç£ç›˜ IO å‹åŠ›å¤§ï¼‰ï¼›</li>
<li><code>tps</code>ï¼šæ¯ç§’ IO è¯·æ±‚æ•°ï¼›</li>
<li><code>rMB/s</code>/<code>wMB/s</code>ï¼šæ¯ç§’è¯»å†™ MB æ•°ã€‚</li>
</ul>
<h5 data-id="heading-34">å®æˆ˜åœºæ™¯</h5>
<p>æœåŠ¡å™¨é¢‘ç¹å¡é¡¿ï¼Œç”¨ iostat æŸ¥çœ‹ï¼š</p>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-shell" lang="shell">iostat -x 1
<span class="hljs-meta prompt_"># </span><span class="bash">è‹¥%utilæŒç»­è¶…è¿‡90%ï¼Œä¸”wMB/så¾ˆé«˜ï¼Œè¯´æ˜æœ‰ç¨‹åºåœ¨é¢‘ç¹å†™ç£ç›˜ï¼ˆæ¯”å¦‚æ—¥å¿—æ‰“å°è¿‡å¤šï¼‰</span>
<span class="hljs-meta prompt_"># </span><span class="bash">è§£å†³ï¼šä¼˜åŒ–æ—¥å¿—è¾“å‡ºï¼ˆå‡å°‘ä¸å¿…è¦çš„æ—¥å¿—ï¼Œæˆ–å®šæ—¶è½®è½¬æ—¥å¿—ï¼‰</span>
</code></pre>
<h3 data-id="heading-35">ä¸ƒã€é¿å‘æŒ‡å—ï¼šå¸¸è§é—®é¢˜è§£å†³</h3>
<ol>
<li>
<p><strong>gdb è°ƒè¯•æ—¶çœ‹ä¸åˆ°ä»£ç </strong>ï¼š</p>
<ul>
<li>åŸå› ï¼šç¼–è¯‘æ—¶æœªåŠ <code>-g</code>å‚æ•°ï¼Œæˆ–ä»£ç æ–‡ä»¶è¢«ç§»åŠ¨ / åˆ é™¤ï¼›</li>
<li>è§£å†³ï¼šé‡æ–°ç¼–è¯‘ï¼ˆåŠ <code>-g</code>ï¼‰ï¼Œç¡®ä¿è°ƒè¯•æ—¶ä»£ç æ–‡ä»¶è·¯å¾„ä¸ç¼–è¯‘æ—¶ä¸€è‡´ã€‚</li>
</ul>
</li>
<li>
<p><strong>perf top æç¤º â€œPermission deniedâ€</strong> ï¼š</p>
<ul>
<li>åŸå› ï¼šç¼ºå°‘ root æƒé™ï¼Œperf éœ€è¦å†…æ ¸æƒé™è·å–æ€§èƒ½æ•°æ®ï¼›</li>
<li>è§£å†³ï¼šç”¨<code>sudo perf top</code>è¿è¡Œã€‚</li>
</ul>
</li>
<li>
<p><strong>valgrind æ£€æµ‹åµŒå…¥å¼ç¨‹åºæŠ¥é”™</strong>ï¼š</p>
<ul>
<li>åŸå› ï¼švalgrind é»˜è®¤é’ˆå¯¹ x86 æ¶æ„ï¼ŒåµŒå…¥å¼æ˜¯ ARM æ¶æ„ï¼›</li>
<li>è§£å†³ï¼šäº¤å‰ç¼–è¯‘ valgrind æºç ï¼Œç”Ÿæˆ ARM ç‰ˆæœ¬çš„ valgrindï¼Œæˆ–åœ¨ QEMU ä»¿çœŸç¯å¢ƒä¸­æ£€æµ‹ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-36">å…«ã€æ€»ç»“ï¼šå·¥å…·é€‰æ‹©ä¼˜å…ˆçº§</h3>
<p>é‡åˆ°ç³»ç»Ÿ / ç¨‹åºé—®é¢˜æ—¶ï¼ŒæŒ‰ä»¥ä¸‹é¡ºåºé€‰æ‹©å·¥å…·ï¼Œæ•ˆç‡æœ€é«˜ï¼š</p>
<ol>
<li>å…ˆçœ‹å…¨å±€çŠ¶æ€ï¼šç”¨ top/htop åˆ¤æ–­æ˜¯ CPUã€å†…å­˜ã€ç£ç›˜å“ªä¸ªèµ„æºç´§å¼ ï¼›</li>
<li>ç¨‹åºå´©æºƒï¼šç”¨ gdb å®šä½å‡ºé”™ä»£ç è¡Œï¼›</li>
<li>ç¨‹åºè¿è¡Œæ…¢ï¼šç”¨ perf åˆ†æ CPU çƒ­ç‚¹å‡½æ•°ï¼›</li>
<li>é•¿æœŸè¿è¡Œåå´©æºƒï¼šç”¨ valgrind æ£€æµ‹å†…å­˜æ³„æ¼ï¼›</li>
<li>ç£ç›˜è¯»å†™æ…¢ï¼šç”¨ iostat/df æ’æŸ¥ç£ç›˜ç©ºé—´å’Œ IO å‹åŠ›ã€‚</li>
</ol>
<p>è¿™äº›å·¥å…·è¦†ç›–äº† Linux å¼€å‘ / è¿ç»´çš„ç»å¤§å¤šæ•°æ€§èƒ½é—®é¢˜åœºæ™¯ï¼Œå»ºè®®æ”¶è—èµ·æ¥ï¼Œé‡åˆ°é—®é¢˜æ—¶ç›´æ¥æŸ¥è¡¨æ‰¾å·¥å…·ã€‚ä¸‹ä¸€ç¯‡åšå®¢ï¼Œæˆ‘ä¼šç»™å¤§å®¶æ•´ç† â€œLinux è‡ªåŠ¨åŒ–è„šæœ¬ç¼–å†™â€ï¼Œæ•™ä½ ç”¨ shell è„šæœ¬æ•´åˆè¿™äº›å·¥å…·ï¼Œå®ç° â€œä¸€é”®ç›‘æ§â€â€œè‡ªåŠ¨æ’æŸ¥é—®é¢˜â€ï¼Œæ•¬è¯·å…³æ³¨ï¼</p>
<p>å¦‚æœéœ€è¦æŸæ¬¾å·¥å…·çš„è¯¦ç»†æ•™ç¨‹ï¼ˆæ¯”å¦‚ perf çš„å¤æ‚äº‹ä»¶é…ç½®ã€valgrind äº¤å‰ç¼–è¯‘ï¼‰ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[CSSå±æ€§ - èƒŒæ™¯å±æ€§]]></title>    <link>https://juejin.cn/post/7599922362998898734</link>    <guid>https://juejin.cn/post/7599922362998898734</guid>    <pubDate>2026-01-28T02:54:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599922362998898734" data-draft-id="7599951933594075146" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="CSSå±æ€§ - èƒŒæ™¯å±æ€§"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-28T02:54:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="GinoWi"/> <meta itemprop="url" content="https://juejin.cn/user/687651121011707"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            CSSå±æ€§ - èƒŒæ™¯å±æ€§
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/687651121011707/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    GinoWi
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:54:44.000Z" title="Wed Jan 28 2026 02:54:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body{overflow:hidden;line-height:1.75;font-size:15px;background-image:linear-gradient(90deg,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0),linear-gradient(1turn,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0);background-size:20px 20px;background-position:50%;padding-top:0!important}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{position:relative;display:flex;border-bottom:5px solid #6d4e00;line-height:35px;letter-spacing:1px;font-size:25px;padding-left:25px;color:#664900;text-shadow:1px 1px 1px #8a6200;padding-bottom:0}.markdown-body h1:before{content:"";display:flex;position:absolute;left:0;top:3px;bottom:0;margin:auto;width:20px;height:20px;background-size:20px 20px;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC")}.markdown-body h2{position:relative;padding:0 0 0 20px;font-size:20px;font-weight:700;color:#614500}.markdown-body h2:before{content:"";position:absolute;top:3px;bottom:0;left:0;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC");background-size:100% 100%;background-repeat:no-repeat;width:15px;height:15px;margin:auto}.markdown-body h3{width:100%;text-align:left;margin:20px 10px 0 0;font-size:18px;font-weight:700;display:inline-block;padding-left:10px;padding-bottom:0;border-left:5px solid #8f6600;color:#614500}.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:700;color:#a37400}.markdown-body h4{font-size:17px}.markdown-body h5,.markdown-body h6{display:flex;align-items:center}.markdown-body h5:after,.markdown-body h6:after{display:inline-block;border:2px solid #fff6e0;color:rgba(189,134,0,.5);border-radius:50%;text-align:center;margin-left:5px}.markdown-body h5{font-size:14px}.markdown-body h5:after{content:"5";width:15px;height:15px;line-height:15px;font-size:13px}.markdown-body h6{font-size:12px}.markdown-body h6:after{content:"6";width:13px;height:13px;line-height:13px;font-size:12px}.markdown-body p{color:#412c0c;letter-spacing:1px;font-weight:400;margin-bottom:16px}.markdown-body img{max-width:100%;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#755300;font-weight:400;border-bottom:1px solid #755300;font-weight:bolder;text-decoration:none}.markdown-body table{width:100%!important;margin:0;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border-spacing:0}.markdown-body table img{box-shadow:none}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body thead tr th{text-align:center}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;box-sizing:border-box;border:1px solid rgba(72,42,10,.1)}.markdown-body blockquote{position:relative;text-size-adjust:100%;line-height:25px;font-weight:400;border-radius:10px;font-style:normal;text-align:left;box-sizing:inherit;border:1px solid #ffd87a;background-color:rgba(189,134,0,.5);margin:20px 0;padding:20px}.markdown-body blockquote p{color:#fff6e0;letter-spacing:2px;margin:0}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;color:#cc9100;font-size:34px;font-weight:700}.markdown-body blockquote:before{content:"â";top:8px;left:5px}.markdown-body blockquote:after{content:"â";right:5px;bottom:-5px}.markdown-body strong{color:#c28a00;font-weight:bolder}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{color:#c28a00}.markdown-body em strong{font-style:normal;color:#c28a00;background-color:#8a6200}.markdown-body s{color:#c28a00}.markdown-body hr{border-top:1px solid #805b00}.markdown-body code,.markdown-body li code,.markdown-body p code{color:#996d00;background-color:rgba(130,98,0,.3)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit;color:#858585;font-family:bold;letter-spacing:1px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection,.markdown-body img::selection{color:rgba(189,134,0,.5);background-color:#fff}.markdown-body a::selection,.markdown-body b::selection,.markdown-body del::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:transparent}.markdown-body pre&gt;code::selection{background-color:rgba(189,134,0,.5)}.markdown-body .math .math-inline::selection,.markdown-body blockquote::selection,.markdown-body ol::selection,.markdown-body p::selection,.markdown-body strong::selection,.markdown-body table::selection,.markdown-body ul::selection{background-color:rgba(189,134,0,.5)}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">CSSå±æ€§ - èƒŒæ™¯å±æ€§</h2>
<h4 data-id="heading-1">å¦‚ä½•è®¾ç½®æ ‡ç­¾çš„èƒŒæ™¯é¢œè‰²</h4>
<ul>
<li>
<p>åœ¨CSSä¸­æœ‰ä¸€ä¸ª<code>background-color</code>å±æ€§ï¼Œå°±æ˜¯ä¸“é—¨ç”¨æ¥è®¾ç½®æ ‡ç­¾çš„èƒŒæ™¯é¢œè‰²çš„ã€‚</p>
</li>
<li>
<p>å–å€¼ï¼š</p>
<ul>
<li>å…·ä½“é¢œè‰²å•è¯</li>
<li>rgb</li>
<li>rgba</li>
<li>åå…­è¿›åˆ¶</li>
</ul>
</li>
<li>
<p>æ¸²æŸ“æ•ˆæœï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>èƒŒæ™¯å±æ€§ç»ƒä¹ <span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span>&gt;</span><span class="css">
 Â  Â  Â  Â  Â  Â <span class="hljs-selector-tag">div</span> {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">width</span>: <span class="hljs-number">50px</span>;
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">height</span>: <span class="hljs-number">50px</span>;
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â <span class="hljs-selector-class">.setEnName</span> {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">background-color</span>: yellow;
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â <span class="hljs-selector-class">.setRgb</span> {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgb</span>(<span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â <span class="hljs-selector-class">.setRgba</span> {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.9</span>);
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â <span class="hljs-selector-class">.setHex</span> {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ff00ff</span>;
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"setEnName"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"setRgb"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"setRgba"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"setHex"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f9ef82c15c5749f1ba905ce77e62f462~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2lub1dp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173684&amp;x-signature=WKRJCvJ6Gx1VnxMy0iT7SxlvM3s%3D" alt="èƒŒæ™¯é¢œè‰²è®¾ç½®" loading="lazy"/></p>
</li>
</ul>
<h4 data-id="heading-2">å¦‚ä½•è®¾ç½®èƒŒæ™¯å›¾ç‰‡</h4>
<ul>
<li>
<p>åœ¨CSSä¸­æœ‰ä¸€ä¸ª<code>background-image</code>å±æ€§ï¼Œå°±æ˜¯ä¸“é—¨ç”¨æ¥è®¾ç½®èƒŒæ™¯å›¾ç‰‡çš„ã€‚</p>
</li>
<li>
<p>æ³¨æ„ç‚¹ï¼š</p>
<ul>
<li>å›¾ç‰‡çš„åœ°å€å¿…é¡»æ”¾åœ¨<code>url()</code>ä¸­ï¼Œå¯ä»¥æ˜¯æœ¬åœ°å›¾ç‰‡åœ°å€ï¼Œä¹Ÿå¯ä»¥æ˜¯ç½‘é¡µå›¾ç‰‡åœ°å€ã€‚</li>
<li>å¦‚æœå›¾ç‰‡çš„å¤§å°æ²¡æœ‰æ ‡ç­¾çš„å¤§å°å¤§ï¼Œä¼šè‡ªåŠ¨åœ¨æ°´å¹³å’Œå‚ç›´æ–¹å‘å¹³é“ºã€‚</li>
<li>å¦‚æœç½‘é¡µä¸Šå‡ºç°å›¾ç‰‡ï¼Œé‚£ä¹ˆæµè§ˆå™¨ä¼šå†æ¬¡å‘é€è¯·æ±‚ï¼Œè·å–å›¾ç‰‡ã€‚</li>
</ul>
</li>
<li>
<p>æ¸²æŸ“æ•ˆæœï¼š</p>
<p>æˆ‘çš„åŸå§‹å›¾ç‰‡æ˜¯è¿™ä¸ªï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c1f3f925ed4449a0b04a8c75dd03167e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2lub1dp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173684&amp;x-signature=gXN1BODQqdVLBvQTtuYAT2dAy0g%3D" alt="CSS-background-image-source" loading="lazy"/></p>
<p>è¿™ä¸ªå›¾ç‰‡çš„å¤§å°æ˜¯519 Ã— 500åƒç´ çš„å¤§å°ï¼Œæ¥ä¸‹æ¥ç”¨è¿™ä¸ªå›¾ç‰‡ä½œä¸º<code>body</code>æ ‡ç­¾çš„èƒŒæ™¯å›¾ç‰‡ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f3b9fa578e0b431eb19e24fddb522de0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2lub1dp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173684&amp;x-signature=HQlOjOttqul890hxqH0dqei5das%3D" alt="CSS-background-image.png" loading="lazy"/></p>
</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸Šå›¾çœ‹åˆ°ï¼Œç”±äºå›¾ç‰‡çš„å¤§å°æ²¡æœ‰æ ‡ç­¾çš„å¤§å°å¤§ï¼Œæ•…è‡ªåŠ¨åœ¨æ°´å¹³å’Œå‚ç›´æ–¹å‘ä¸Šå¹³é“ºã€‚</p>
<h4 data-id="heading-3">å¦‚ä½•æ§åˆ¶èƒŒæ™¯å›¾ç‰‡æ˜¯å¦å¹³é“º</h4>
<ul>
<li>
<p>åœ¨ä¸Šé¢æˆ‘ä»¬é˜è¿°äº†å¦‚ä½•è®¾ç½®èƒŒæ™¯å›¾ç‰‡ï¼Œä½†æ˜¯é»˜è®¤èƒŒæ™¯å›¾ç‰‡æ˜¯åœ¨æ ‡ç­¾å†…å¹³é“ºçš„ï¼Œå¦‚æœæˆ‘ä»¬æƒ³æ§åˆ¶èƒŒæ™¯å›¾ç‰‡æ˜¯å¦åœ¨æ ‡ç­¾å†…å¹³é“ºå±•ç¤ºï¼Œé‚£ä¹ˆåœ¨CSSä¸­æœ‰ä¸€ä¸ª<code>background-repeat</code>å±æ€§ï¼Œå°±æ˜¯ä¸“é—¨ç”¨æ¥æ§åˆ¶èƒŒæ™¯å›¾ç‰‡çš„å¹³é“ºæ–¹å¼ã€‚</p>
</li>
<li>
<p>å–å€¼ï¼š</p>
<ul>
<li><code>repeat</code>ï¼šé»˜è®¤ï¼Œåœ¨æ°´å¹³å’Œå‚ç›´æ–¹å‘éƒ½éœ€è¦å¹³é“º</li>
<li><code>no-repeat</code>ï¼šåœ¨æ°´å¹³å’Œå‚ç›´æ–¹å‘éƒ½ä¸å¹³é“º</li>
<li><code>repeat-x</code>ï¼šåœ¨æ°´å¹³æ–¹å‘å¹³é“º</li>
<li><code>repeat-y</code>ï¼šåœ¨å‚ç›´æ–¹å‘å¹³é“º</li>
</ul>
</li>
<li>
<p>åº”ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>å¯ä»¥é€šè¿‡èƒŒæ™¯å›¾ç‰‡çš„å¹³é“ºæ¥é™ä½å›¾ç‰‡çš„å¤§å°ï¼ŒåŠ å¿«ç½‘é¡µè®¿é—®çš„é€Ÿåº¦ã€‚</li>
</ul>
</li>
<li>
<p>æ³¨æ„ç‚¹ï¼š</p>
<ul>
<li>åŒä¸€ä¸ªæ ‡ç­¾å¯ä»¥åŒæ—¶è®¾ç½®èƒŒæ™¯é¢œè‰²å’ŒèƒŒæ™¯å›¾ç‰‡ï¼Œå¦‚æœé¢œè‰²å’Œå›¾ç‰‡åŒæ—¶å­˜åœ¨ï¼Œé‚£ä¹ˆå›¾ç‰‡ä¼šè¦†ç›–é¢œè‰²ã€‚</li>
</ul>
</li>
<li>
<p>æ¸²æŸ“æ•ˆæœï¼š</p>
<p>è¿™é‡Œç´ æå›¾ç‰‡æ˜¯å¤§å°200Ã—200çš„æ–¹å—ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/02d13eff36c348dfa4857a2d481a11bc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2lub1dp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173684&amp;x-signature=SXzD%2FM9M90ZcdMI2gZ2EghctEKw%3D" alt="background-repeat-source" loading="lazy"/></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ä¸åŒçš„<code>div</code>ç›’å­ä¸­è®¾ç½®èƒŒæ™¯å›¾ç‰‡ä¸åŒçš„å¹³é“ºæ–¹å¼ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„æ•ˆæœï¼ˆè¿™é‡Œå¯¹ç½‘é¡µè¿›è¡Œäº†ç¼©å°ï¼ŒéçœŸæ­£å›¾ç‰‡å¤§å°ï¼‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f837ef47db214d2eb5b833524090a079~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2lub1dp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173684&amp;x-signature=vfRhUo8colGzXqjfL73MlC1VhaI%3D" alt="background-repeat" loading="lazy"/></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>èƒŒæ™¯å±æ€§ç»ƒä¹ <span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span>&gt;</span><span class="css">
 Â  Â  Â  Â  Â   * {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â <span class="hljs-selector-tag">div</span> {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">width</span>: <span class="hljs-number">600px</span>;
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">height</span>: <span class="hljs-number">300px</span>;
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">img/bg2.jpg</span>);
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â <span class="hljs-selector-class">.setNoRepeat</span> {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">background-repeat</span>: no-repeat;
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">50px</span>;
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â <span class="hljs-selector-class">.setRepeatX</span> {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">background-repeat</span>: repeat-x;
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">margin-top</span>:<span class="hljs-number">50px</span>;
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â <span class="hljs-selector-class">.setRepeatY</span> {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">background-repeat</span>: repeat-y;
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">margin-top</span>:<span class="hljs-number">50px</span>;
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"non"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"setNoRepeat"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"setRepeatX"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"setRepeatY"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
</li>
</ul>
<h4 data-id="heading-4">å¦‚ä½•è®¾ç½®èƒŒæ™¯å›¾ç‰‡çš„ä½ç½®</h4>
<ul>
<li>
<p>åœ¨CSSä¸­æœ‰ä¸€ä¸ªå«åš<code>background-position</code>å±æ€§ï¼Œå°±æ˜¯ä¸“é—¨ç”¨äºæ§åˆ¶èƒŒæ™¯å›¾ç‰‡çš„ä½ç½®ã€‚</p>
</li>
<li>
<p>å–å€¼ï¼š</p>
<ul>
<li>
<p>å…·ä½“çš„æ–¹ä½åè¯</p>
<ul>
<li>æ°´å¹³æ–¹å‘ï¼š<code>left</code>ã€<code>center</code>ã€<code>right</code></li>
<li>å‚ç›´æ–¹å‘ï¼š<code>top</code>ã€<code>center</code>ã€<code>bottom</code></li>
</ul>
</li>
<li>
<p>å…·ä½“çš„åƒç´ </p>
<ul>
<li>ä¸€å®šè¦å†™å•ä½</li>
<li>å¯ä»¥å†™è´Ÿå€¼ï¼Œå‚ç›´æ–¹å‘åƒç´ å€¼è¶Šå¤§è¶Šé ä¸‹ï¼Œæ°´å¹³æ–¹å‘åƒç´ å€¼è¶Šå¤§è¶Šé å³ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>
<p>æ ¼å¼ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-attribute">background-position</span>: æ°´å¹³æ–¹å‘ å‚ç›´æ–¹å‘;
</code></pre>
</li>
<li>
<p>åº”ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>å¯ä»¥è§£å†³èƒŒæ™¯å›¾ç‰‡ä¸åŒåˆ†è¾¨ç‡å±•ç¤ºå¼‚å¸¸é—®é¢˜ã€‚å¦‚æœé€šè¿‡<code>img</code>æ ‡ç­¾å±•ç¤ºå›¾ç‰‡ï¼Œå¯èƒ½æ— æ³•é€‚é…æµè§ˆå™¨å®½åº¦ï¼Œæµè§ˆå™¨ä¸‹æ–¹ä¼šæ˜¾ç¤ºæ»šåŠ¨æ¡ï¼Œä½†æ˜¯é€šè¿‡èƒŒæ™¯å›¾ç‰‡å±•ç¤ºï¼Œä¼šæ ¹æ®æµè§ˆå™¨å®½åº¦æˆªå–å›¾ç‰‡ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-5">èƒŒæ™¯å…³è”æ–¹å¼</h4>
<ul>
<li>
<p>é»˜è®¤æƒ…å†µä¸‹èƒŒæ™¯å›¾ç‰‡ä¼šéšç€æ»šåŠ¨æ¡çš„æ»šåŠ¨è€Œæ»šåŠ¨ï¼Œå¦‚æœä¸æƒ³è®©èƒŒæ™¯å›¾ç‰‡éšç€æ»šåŠ¨æ¡çš„æ»šåŠ¨è€Œæ»šåŠ¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä¿®æ”¹èƒŒæ™¯å›¾ç‰‡å’Œæ»šåŠ¨æ¡çš„å…³è”æ–¹å¼ã€‚åœ¨CSSä¸­æœ‰ä¸€ä¸ª<code>background-attachment</code>çš„å±æ€§è¿™ä¸ªå±æ€§å°±æ˜¯ä¸“é—¨ç”¨äºä¿®æ”¹èƒŒæ™¯å›¾ç‰‡å…³è”æ–¹å¼çš„ã€‚</p>
</li>
<li>
<p>æ ¼å¼ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-attribute">background-attachment</span>: scroll;
</code></pre>
</li>
<li>
<p>å–å€¼ï¼š</p>
<ul>
<li><code>scroll</code>ï¼šé»˜è®¤å€¼ï¼Œä¼šéšç€æ»šåŠ¨æ¡çš„æ»šåŠ¨è€Œæ»šåŠ¨ã€‚</li>
<li><code>fixed</code>ï¼š ä¸ä¼šéšç€æ»šåŠ¨æ¡çš„æ»šåŠ¨è€Œæ»šåŠ¨ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-6">èƒŒæ™¯å±æ€§ç¼©å†™</h4>
<ul>
<li>
<p>èƒŒæ™¯å±æ€§ç¼©å†™æ ¼å¼ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-attribute">background</span>ï¼šèƒŒæ™¯é¢œè‰² èƒŒæ™¯å›¾ç‰‡ å¹³é“ºæ–¹å¼ å…³è”æ–¹å¼ å®šä½æ–¹å¼;
</code></pre>
</li>
<li>
<p>æ³¨æ„ç‚¹ï¼š</p>
<ul>
<li><code>background</code>å±æ€§ä¸­ï¼Œä»»ä½•ä¸€ä¸ªå±æ€§éƒ½å¯ä»¥è¢«çœç•¥ã€‚</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>è¡¥å……å†…å®¹ï¼š</strong></p>
<p>èƒŒæ™¯å›¾ç‰‡å’Œæ’å…¥å›¾ç‰‡çš„åŒºåˆ«</p>
<ul>
<li>èƒŒæ™¯å›¾ç‰‡ä»…ä»…æ˜¯ä¸€ä¸ªè£…é¥°ï¼Œä¸ä¼šå ç”¨ä½ç½®ï¼›æ’å…¥å›¾ç‰‡ä¼šå ç”¨ä½ç½®ã€‚</li>
<li>èƒŒæ™¯å›¾ç‰‡æœ‰å®šä½å±æ€§ï¼Œæ‰€ä»¥å¯ä»¥å¾ˆæ–¹ä¾¿çš„æ§åˆ¶å›¾ç‰‡çš„ä½ç½®ï¼›æ’å…¥å›¾ç‰‡æ²¡æœ‰å®šä½å±æ€§ï¼Œæ‰€ä»¥æ§åˆ¶å›¾ç‰‡çš„ä½ç½®ä¸å¤ªæ–¹ä¾¿ã€‚</li>
<li>æ’å…¥å›¾ç‰‡çš„è¯­ä¹‰æ¯”èƒŒæ™¯å›¾ç‰‡è¯­ä¹‰å¼ºï¼Œæ‰€ä»¥åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¦‚æœå›¾ç‰‡æƒ³è¦è¢«æœç´¢å¼•æ“æ”¶å½•ï¼Œé‚£ä¹ˆæ¨èä½¿ç”¨æ’å…¥å›¾ç‰‡ã€‚</li>
</ul>
</blockquote>
<p><strong>å‚è€ƒé“¾æ¥ï¼š</strong></p>
<p>W3Schoolå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.w3school.com.cn%2F" target="_blank" title="https://www.w3school.com.cn/" ref="nofollow noopener noreferrer">www.w3school.com.cn</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[HTTP-åè®®æº¯æºï¼šæ·±åº¦è§£æ HTTP/3.0 ä¸ QUIC åè®®çš„åº•å±‚é©å‘½]]></title>    <link>https://juejin.cn/post/7599917711794077706</link>    <guid>https://juejin.cn/post/7599917711794077706</guid>    <pubDate>2026-01-28T02:56:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599917711794077706" data-draft-id="7599951933593960458" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="HTTP-åè®®æº¯æºï¼šæ·±åº¦è§£æ HTTP/3.0 ä¸ QUIC åè®®çš„åº•å±‚é©å‘½"/> <meta itemprop="keywords" content="å‰ç«¯,é¢è¯•,HTTP"/> <meta itemprop="datePublished" content="2026-01-28T02:56:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‘ç°ä¸€åªå¤§å‘†ç“œ"/> <meta itemprop="url" content="https://juejin.cn/user/180747382561607"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            HTTP-åè®®æº¯æºï¼šæ·±åº¦è§£æ HTTP/3.0 ä¸ QUIC åè®®çš„åº•å±‚é©å‘½
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/180747382561607/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‘ç°ä¸€åªå¤§å‘†ç“œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:56:47.000Z" title="Wed Jan 28 2026 02:56:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å‰è¨€</h3>
<p>HTTP/2 å¼€å¯äº†å¤šè·¯å¤ç”¨çš„æ—¶ä»£ï¼Œä½†å®ƒä¾ç„¶è·‘åœ¨ TCP è¿™æ¡â€œè€æ—§â€çš„é“è½¨ä¸Šã€‚åªè¦ TCP çš„è®¾è®¡åˆè¡·ï¼ˆé¡ºåºä¼ è¾“ã€å­—èŠ‚æµå¯é æ€§ï¼‰ä¸æ”¹å˜ï¼Œ<strong>é˜Ÿå¤´é˜»å¡ï¼ˆHOL Blockingï¼‰</strong> çš„å¹½çµå°±æ°¸è¿œæ— æ³•å½»åº•æ•£å»ã€‚äºæ˜¯ï¼ŒGoogle å¦è¾Ÿè¹Šå¾„ï¼ŒåŸºäº UDP æ‰“é€ äº† <strong>QUIC</strong>ï¼Œå¹¶æœ€ç»ˆæˆä¸ºäº† <strong>HTTP/3</strong> çš„æ ¸å¿ƒã€‚</p>
<h2 data-id="heading-1">ä¸€ã€ HTTP/2 çš„é—æ†¾ï¼šTCP å±‚çš„é˜Ÿå¤´é˜»å¡</h2>
<p>è™½ç„¶ HTTP/2 è¿‡å¤šè·¯å¤ç”¨è§£å†³äº† <strong>HTTP åœ¨åº”ç”¨å±‚</strong> çš„é˜Ÿå¤´é˜»å¡ï¼Œä½¿åº”ç”¨å±‚å‘ç”Ÿçš„è¯·æ±‚ä¸å†éœ€è¦æ’é˜Ÿç­‰å€™ï¼Œè§£å†³äº† HTTP/1.1 çš„é˜Ÿå¤´é˜»å¡ã€‚ï¼Œä½†ç”±äºå®ƒåº•å±‚ä¾ç„¶ä¾èµ– TCPï¼Œäº§ç”Ÿäº†ä¸€ä¸ªæ–°çš„ç“¶é¢ˆ</p>
<ul>
<li>
<p><strong>ä¼ è¾“å±‚é˜Ÿå¤´é˜»å¡é—®é¢˜</strong> ï¼šHTTP/2 å»ºç«‹åœ¨ TCP ä¹‹ä¸Šã€‚TCP è¦æ±‚å­—èŠ‚å¿…é¡»æŒ‰é¡ºåºäº¤ä»˜ã€‚å¦‚æœç½‘ç»œå‘ç”Ÿ<strong>ä¸¢åŒ…</strong>ï¼ŒTCP æ— æ³•åˆ†è¾¨å“ªäº›å­—èŠ‚å±äºå“ªä¸ªè¯·æ±‚ï¼Œåªèƒ½æš‚åœæ•´ä¸ªè¿æ¥ç­‰å¾…é‡ä¼ ã€‚</p>
</li>
<li>
<p><strong>å¼±ç½‘ç¯å¢ƒä¸‹çš„å°´å°¬</strong>ï¼šåœ¨ä¸¢åŒ…ç‡è¾ƒé«˜çš„ç§»åŠ¨ç½‘ç»œä¸‹ï¼ŒHTTP/2 çš„è¡¨ç°æœ‰æ—¶ç”šè‡³ä¸å¦‚å¼€å¯ 6 ä¸ªè¿æ¥çš„ HTTP/1.1ï¼Œå› ä¸ºâ€œä¸€è£ä¿±è£ï¼Œä¸€æŸä¿±æŸâ€ã€‚</p>
</li>
</ul>
<ol>
<li><strong>è¿æ¥å»ºç«‹çš„å¼€é”€</strong>ï¼šTCP ä¸‰æ¬¡æ¡æ‰‹ + TLS æ¡æ‰‹ï¼Œåœ¨å¼±ç½‘ç¯å¢ƒä¸‹ RTTï¼ˆå¾€è¿”æ—¶å»¶ï¼‰éå¸¸é«˜ã€‚</li>
</ol>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b938756fb18b4f6289c49c6a1f7072d1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-R546w5LiA5Y-q5aSn5ZGG55Oc:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173806&amp;x-signature=HRgEUAqN19vkldpRshut8ddRpfA%3D" alt="image.png" width="90%" loading="lazy"/></p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a51f765685da471d98c10c46f16f83c4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-R546w5LiA5Y-q5aSn5ZGG55Oc:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173806&amp;x-signature=GrdAR%2B%2BMPw%2FByROmuL6IbBR9ffQ%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-2">äºŒã€ HTTP/3 çš„é€†è¢­ï¼šåŸºäº UDP çš„ QUIC åè®®</h2>
<p>ç”±äº TCP åè®®æ·±æ¤äºæ“ä½œç³»ç»Ÿå†…æ ¸å’Œè·¯ç”±å™¨å›ºä»¶ä¸­ï¼Œä¿®æ”¹æå…¶å›°éš¾ã€‚HTTP/3 ç´¢æ€§â€œæ¨å€’é‡æ¥â€ï¼Œåœ¨ <strong>UDP</strong> ä¹‹ä¸Šå®ç°äº†å¯é ä¼ è¾“ï¼Œè¿™ä¾¿æ˜¯ <strong>QUICï¼ˆQuick UDP Internet Connectionsï¼‰</strong> ã€‚</p>
<h3 data-id="heading-3">1. QUIC çš„å››å¤§æ ¸å¿ƒé­”æ³•</h3>
<h4 data-id="heading-4">â‘  å½»åº•è§£å†³é˜Ÿå¤´é˜»å¡</h4>
<p>QUIC åœ¨ä¼ è¾“å±‚å®ç°äº†å¤šè·¯å¤ç”¨ã€‚æ¯ä¸ªæµï¼ˆStreamï¼‰ä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚</p>
<ul>
<li><strong>æ•ˆæœ</strong>ï¼šå¦‚æœ Stream A ä¸¢åŒ…ï¼Œåªä¼šé˜»å¡ Stream A çš„é‡ç»„ï¼Œ<strong>Stream B å’Œ Stream C å¯ä»¥ç»§ç»­ä¸å—å½±å“åœ°ä¼ è¾“æ•°æ®</strong>ã€‚</li>
</ul>
<h4 data-id="heading-5">â‘¡ æé€Ÿæ¡æ‰‹ï¼ˆ0-RTT / 1-RTTï¼‰</h4>
<p>TCP éœ€è¦å…ˆå»ºç«‹è¿æ¥å†å»ºç«‹åŠ å¯†é€šé“ã€‚</p>
<ul>
<li><strong>æ•ˆæœ</strong>ï¼šQUIC å°†<strong>ä¼ è¾“æ¡æ‰‹</strong>ä¸<strong>åŠ å¯†æ¡æ‰‹</strong>åˆå¹¶ã€‚åˆæ¬¡è¿æ¥åªéœ€ 1 ä¸ª RTTï¼Œå†æ¬¡è¿æ¥ç”šè‡³å¯ä»¥å®ç° <strong>0-RTT</strong> æé€Ÿå¯åŠ¨ã€‚</li>
</ul>
<h4 data-id="heading-6">â‘¢ è¿æ¥è¿ç§» (Connection Migration)</h4>
<p>TCP ä¾é â€œå››å…ƒç»„â€ï¼ˆæºIPã€æºç«¯å£ã€ç›®æ ‡IPã€ç›®æ ‡ç«¯å£ï¼‰è¯†åˆ«è¿æ¥ã€‚</p>
<ul>
<li><strong>ç—›ç‚¹</strong>ï¼šå½“ä½ ä» Wi-Fi åˆ‡æ¢åˆ° 4Gï¼ŒIP å˜äº†ï¼ŒTCP è¿æ¥å¿…æ–­ã€‚</li>
<li><strong>æ”¹è¿›</strong>ï¼šQUIC ä½¿ç”¨ <strong>Connection ID</strong> è¯†åˆ«è¿æ¥ã€‚å³ä¾¿ IP åˆ‡æ¢ï¼Œåªè¦ ID ä¸å˜ï¼Œè¿æ¥å°±èƒ½æ— ç¼å»¶ç»­ã€‚</li>
</ul>
<h4 data-id="heading-7">â‘£ æ”¹è¿›çš„å¤´éƒ¨å‹ç¼©ï¼šQPACK</h4>
<p>HTTP/2 ä½¿ç”¨çš„ HPACK åœ¨ä¹±åºä¼ è¾“æ—¶ä¼šäº§ç”Ÿé˜Ÿå¤´é˜»å¡ï¼ŒHTTP/3 å‡çº§ä¸º <strong>QPACK</strong>ï¼Œä¸“é—¨ä¼˜åŒ–äº†å¤šæµå¹¶å‘ä¸‹çš„å‹ç¼©æ•ˆç‡ã€‚</p>
<hr/>
<h2 data-id="heading-8">ä¸‰ã€ æ€»ç»“ï¼šä»â€œæ’é˜Ÿâ€åˆ°â€œå¹¶å‘â€</h2>






























<table><thead><tr><th><strong>ç‰¹æ€§</strong></th><th><strong>HTTP/2 (TCP)</strong></th><th><strong>HTTP/3 (UDP/QUIC)</strong></th></tr></thead><tbody><tr><td><strong>ä¼ è¾“å±‚é˜»å¡</strong></td><td>å­˜åœ¨ TCP é˜Ÿå¤´é˜»å¡</td><td><strong>ä¸å­˜åœ¨</strong>ï¼ˆæµä¸æµç‹¬ç«‹ï¼‰</td></tr><tr><td><strong>æ¡æ‰‹æ—¶å»¶</strong></td><td>2~3 RTT (TCP+TLS)</td><td><strong>0~1 RTT</strong></td></tr><tr><td><strong>ç½‘ç»œåˆ‡æ¢</strong></td><td>è¿æ¥æ–­å¼€ï¼Œéœ€é‡æ–°æ¡æ‰‹</td><td><strong>æ— ç¼è¿ç§»</strong></td></tr><tr><td><strong>å¯é æ€§</strong></td><td>æ“ä½œç³»ç»Ÿå†…æ ¸å®ç°</td><td><strong>QUIC åœ¨åº”ç”¨å±‚å®ç°</strong></td></tr></tbody></table>
<h2 data-id="heading-9">å››ã€ HTTP3.0ç°çŠ¶</h2>
<p>ç›®å‰HTTP3.0å¹¶æ²¡æœ‰æ™®åŠï¼Œä½ å¯ä»¥éšä¾¿æ‰“å¼€ç½‘ç«™æŸ¥çœ‹è¯·æ±‚ç›¸åº”çš„HTTPç‰ˆæœ¬ï¼Œä¼šå‘ç°å¤§å¤šæ•°è¯·æ±‚éƒ½æ˜¯HTTP2.0çš„ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Dart Isolate å…¨æ™¯è§£æ]]></title>    <link>https://juejin.cn/post/7599917711793995786</link>    <guid>https://juejin.cn/post/7599917711793995786</guid>    <pubDate>2026-01-28T02:40:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599917711793995786" data-draft-id="7599917711793979402" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Dart Isolate å…¨æ™¯è§£æ"/> <meta itemprop="keywords" content="Flutter"/> <meta itemprop="datePublished" content="2026-01-28T02:40:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æµ©è¾‰"/> <meta itemprop="url" content="https://juejin.cn/user/1134351728786711"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Dart Isolate å…¨æ™¯è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1134351728786711/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æµ©è¾‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:40:24.000Z" title="Wed Jan 28 2026 02:40:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»23åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Dart Isolate å…¨æ™¯è§£æï¼šä»å•çº¿ç¨‹æ¨¡å‹åˆ°å¹¶å‘ç¼–ç¨‹çš„åº•å±‚çœŸç›¸</h2>
<p>åœ¨ Flutter å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸å¬åˆ°ä¸€å¥è¯ï¼šâ€œDart æ˜¯å•çº¿ç¨‹çš„â€ã€‚ä½†å¾ˆå¤šå¼€å‘è€…åœ¨é‡åˆ°å¡é¡¿æ—¶ï¼Œå¾€å¾€ä¼šé™·å…¥å›°æƒ‘ï¼šæ—¢ç„¶æœ‰ <code>Future</code> å’Œ <code>async/await</code> è¿™ç§å¼‚æ­¥æœºåˆ¶ï¼Œä¸ºä»€ä¹ˆæˆ‘çš„ App è§£æä¸€ä¸ªå¤§æ–‡ä»¶æ—¶è¿˜æ˜¯å¡ä½äº†ï¼Ÿ</p>
<p>æœ¬æ–‡å°†å‰¥å¼€ Dart å¹¶å‘çš„è¡¨è±¡ï¼Œä» Main Isolate çš„å•çº¿ç¨‹æ¨¡å‹å‡ºå‘ï¼Œæ·±å…¥åº•å±‚å†…å­˜æœºåˆ¶ï¼Œå¸¦ä½ å½»åº•ç†è§£ <strong>Isolate</strong> â€”â€” è¿™ä¸ª Dart å¹¶å‘ç¼–ç¨‹çš„ç»ˆææ­¦å™¨ã€‚</p>
<hr/>
<h3 data-id="heading-1">ç¬¬ä¸€ç« ï¼šèƒŒæ™¯ â€”â€” Flutter å•çº¿ç¨‹ä¸ Main Isolate çš„çœŸç›¸</h3>
<p>åœ¨ Flutter çš„ä¸–ç•Œé‡Œï¼Œå¼€å‘è€…æœ€å¸¸å¬åˆ°çš„ä¸€å¥è¯å°±æ˜¯ï¼šâ€œDart æ˜¯å•çº¿ç¨‹çš„â€ã€‚è¿™å¥è¯æ—¢æ˜¯ Flutter å¼€å‘ç®€å•çš„æºæ³‰ï¼ˆæ— éœ€æ‹…å¿ƒé”å’Œç«æ€æ¡ä»¶ï¼‰ï¼Œä¹Ÿæ˜¯æ— æ•°æ€§èƒ½ç¾éš¾çš„æ ¹æºã€‚</p>
<p>å¾ˆå¤šå¼€å‘è€…åœ¨é¢å¯¹ UI å¡é¡¿ï¼ˆJankï¼‰æ—¶ï¼Œç¬¬ä¸€ååº”æ˜¯ï¼šâ€œæˆ‘æ˜æ˜åŠ äº† <code>async/await</code>ï¼Œä¸ºä»€ä¹ˆç•Œé¢è¿˜æ˜¯å¡æ­»äº†ï¼Ÿâ€</p>
<p>è¦è§£å¼€è¿™ä¸ªè°œé¢˜ï¼Œæˆ‘ä»¬éœ€è¦å…ˆèµ°è¿› Flutter çš„å¿ƒè„ â€”â€” <strong>Main Isolate</strong>ã€‚</p>
<h3 data-id="heading-2">1.1 Main Isolateï¼šèº«å…¼æ•°èŒçš„â€œç‹¬è£è€…â€</h3>
<p>å½“ä½ çš„ Flutter App å¯åŠ¨æ—¶ï¼ŒDart è™šæ‹Ÿæœºï¼ˆVMï¼‰ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªä¸» Isolateï¼Œæˆ‘ä»¬é€šå¸¸ç§°ä¹‹ä¸º <strong>Main Isolate</strong>ã€‚</p>
<p>è¯·ä¸è¦æŠŠå®ƒç®€å•åœ°ç†è§£ä¸ºâ€œæ‰§è¡Œä»£ç çš„åœ°æ–¹â€ã€‚åœ¨ Flutter çš„æ¶æ„ä¸­ï¼ŒMain Isolate æ˜¯ä¸€ä¸ªç»å¯¹çš„**â€œç‹¬è£è€…â€**ï¼Œå®ƒæŒç®¡äº† App ç”Ÿå‘½çº¿ä¸­å‡ ä¹æ‰€æœ‰çš„æ ¸å¿ƒå·¥ä½œï¼š</p>
<ol>
<li>
<p><strong>é€»è¾‘æ‰§è¡Œ</strong>ï¼šè¿è¡Œä½ å†™çš„å¤§éƒ¨åˆ† Dart ä¸šåŠ¡ä»£ç ã€‚</p>
</li>
<li>
<p><strong>äº‹ä»¶å¤„ç†</strong>ï¼šå“åº”ç‚¹å‡»ã€æ»‘åŠ¨ã€é”®ç›˜è¾“å…¥ç­‰ç”¨æˆ·äº¤äº’ã€‚</p>
</li>
<li>
<p><strong>UI æ¸²æŸ“</strong>ï¼šè¿™æ˜¯æœ€ç¹é‡çš„ä»»åŠ¡ã€‚å®ƒè¦è´Ÿè´£æ‰§è¡Œ Widget çš„ <code>build</code>ï¼ˆæ„å»ºï¼‰ã€<code>layout</code>ï¼ˆå¸ƒå±€ï¼‰å’Œ <code>paint</code>ï¼ˆç»˜åˆ¶å½•åˆ¶ï¼‰ã€‚</p>
</li>
</ol>
<p>ä½ å¯ä»¥æŠŠ Main Isolate æƒ³è±¡æˆä¸€å®¶ç±³å…¶æ—é¤å…çš„<strong>å”¯ä¸€ä¸»å¨</strong>ã€‚ä»–ä¸ä»…è¦è´Ÿè´£åˆ‡èœã€ç‚’èœï¼ˆæ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼‰ï¼Œè¿˜è¦è´Ÿè´£æœ€åçš„æ‘†ç›˜å’Œä¼ èœï¼ˆæ¸²æŸ“ UIï¼‰ã€‚</p>
<p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™æ‰€æœ‰çš„ä¸€åˆ‡ï¼Œéƒ½å‘ç”Ÿåœ¨è¿™ <strong>å”¯ä¸€çš„ä¸€æ¡çº¿ç¨‹</strong> ä¸Šã€‚</p>
<h3 data-id="heading-3">1.2 16ms çš„ç”Ÿæ­»çº¿ (The 16ms Deadline)</h3>
<p>æ—¢ç„¶åªæœ‰ä¸€ä½ä¸»å¨ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬çš„ App çœ‹èµ·æ¥è¿˜èƒ½æµç•…è¿è¡Œï¼Ÿå› ä¸ºè¿™ä½ä¸»å¨çš„æ‰‹é€Ÿæå¿«ã€‚</p>
<p>ä¸ºäº†è¾¾åˆ° <strong>60FPS</strong>ï¼ˆæ¯ç§’ 60 å¸§ï¼‰çš„æµç•…åº¦ï¼ŒMain Isolate å¿…é¡»éµå¾ªä¸€ä¸ªä¸¥è‹›çš„ KPIï¼š<strong>æ¯ 16.6 æ¯«ç§’ï¼ˆ1000ms / 60ï¼‰å¿…é¡»äº§å‡ºä¸€å¸§ç”»é¢ã€‚</strong></p>
<p>åœ¨è¿™ä¸ªæå…¶çŸ­æš‚çš„ 16ms çª—å£æœŸå†…ï¼ŒMain Isolate å¿…é¡»å¤„ç†å®Œå½“ä¸‹çš„ç”¨æˆ·ç‚¹å‡»ï¼Œç®—å®Œå½“å‰çš„ä¸šåŠ¡é€»è¾‘ï¼Œå¹¶æŠŠä¸‹ä¸€å¸§çš„ UI ç»˜åˆ¶æŒ‡ä»¤æäº¤ç»™ GPUã€‚</p>
<ul>
<li>
<p><strong>ç†æƒ³æƒ…å†µ</strong>ï¼šé€»è¾‘ç®€å•ï¼Œä¸»å¨åœ¨ 5ms å†…æå®šä¸€åˆ‡ï¼Œå‰©ä¸‹ 11ms å–èŒ¶ä¼‘æ¯ï¼ˆIdleï¼‰ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡å±å¹•åˆ·æ–°ä¿¡å·ï¼ˆVSyncï¼‰ã€‚</p>
</li>
<li>
<p><strong>å¡é¡¿ï¼ˆJankï¼‰</strong> ï¼šä½ å†™äº†ä¸€ä¸ªå¤æ‚çš„å›¾ç‰‡æ»¤é•œå¾ªç¯ï¼Œè€—æ—¶ <strong>100ms</strong>ã€‚ä¸»å¨ä¸€ç›´åœ¨â€œåˆ‡èœâ€ï¼ˆè®¡ç®—ï¼‰ï¼Œé”™è¿‡äº†â€œä¼ èœâ€ï¼ˆVSyncï¼‰çš„æ—¶é—´ç‚¹ã€‚äºæ˜¯ï¼Œå±å¹•åœ¨æ¥ä¸‹æ¥çš„ 6 å¸§é‡Œç”»é¢é™æ­¢ï¼Œç”¨æˆ·æ„Ÿè§‰åˆ°äº†æ˜æ˜¾çš„å¡é¡¿ã€‚</p>
</li>
</ul>
<h3 data-id="heading-4">1.3 Event Loopï¼šå‹¤åŠ³ä¸”â€œåå¿ƒâ€çš„é“¶è¡ŒæŸœå‘˜</h3>
<p>Main Isolate æ˜¯å¦‚ä½•åœ¨ä¸€ä¸ªçº¿ç¨‹é‡Œæœ‰åºå¤„ç†å¼‚æ­¥ä»»åŠ¡ã€ç‚¹å‡»äº‹ä»¶å’Œç»˜åˆ¶æŒ‡ä»¤çš„ï¼Ÿé çš„æ˜¯ <strong>Event Loopï¼ˆäº‹ä»¶å¾ªç¯ï¼‰</strong> ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥æŠŠ Event Loop æƒ³è±¡æˆä¸€ä¸ª<strong>æå…¶æ­»æ¿çš„é“¶è¡ŒæŸœå‘˜</strong>ã€‚ä»–çš„å·¥ä½œåŸåˆ™åªæœ‰ä¸€æ¡ï¼š<strong>ä¸€æ¬¡åªå¤„ç†ä¸€ä»¶äº‹ï¼Œåšå®Œä¸€ä»¶å†æ‹¿ä¸‹ä¸€ä»¶ã€‚</strong></p>
<p>åœ¨ä»–çš„é¢å‰ï¼Œæ‘†ç€ä¸¤ä¸ªæ–‡ä»¶ç­ï¼Œå¤„ç†ä¼˜å…ˆçº§æˆªç„¶ä¸åŒï¼š</p>
<h4 data-id="heading-5">1. <strong>VIP æ€¥ä»¶ç­ï¼šMicrotask Queue (å¾®ä»»åŠ¡é˜Ÿåˆ—)</strong></h4>
<ul>
<li>
<p><strong>ä¼˜å…ˆçº§</strong>ï¼š<strong>æœ€é«˜</strong>ã€‚</p>
</li>
<li>
<p><strong>æ¥æº</strong>ï¼š<code>scheduleMicrotask</code>ã€<code>Future.then</code> å›è°ƒã€‚</p>
</li>
<li>
<p><strong>è§„åˆ™</strong>ï¼šåªè¦è¿™ä¸ªç­é‡Œè¿˜æœ‰ä»»åŠ¡ï¼ŒæŸœå‘˜å°±<strong>ç»å¯¹ä¸ä¼š</strong>å»çœ‹åˆ«å¤„ã€‚å“ªæ€•æ­¤æ—¶ç”¨æˆ·æ­£åœ¨ç–¯ç‹‚ç‚¹å‡»å±å¹•ï¼Œæˆ–è€…ç»˜åˆ¶ä¿¡å·å·²ç»æ¥äº†ï¼ŒæŸœå‘˜ä¹Ÿä¼šæ— è§†ï¼Œå¿…é¡»å…ˆæŠŠå¾®ä»»åŠ¡æ¸…ç©ºã€‚</p>
<ul>
<li><em>éšå–»</em>ï¼šå¦‚æœåœ¨è¿™é‡Œå†™äº†æ­»å¾ªç¯ï¼ŒApp å°±ä¼šç”±å†…è€Œå¤–åœ°å½»åº•â€œå†»ç»“â€ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-6">2. <strong>æ™®é€šä»¶ç­ï¼šEvent Queue (äº‹ä»¶é˜Ÿåˆ—)</strong></h4>
<ul>
<li>
<p><strong>ä¼˜å…ˆçº§</strong>ï¼šæ™®é€šã€‚</p>
</li>
<li>
<p><strong>æ¥æº</strong>ï¼šI/O å›è°ƒã€Timerã€Isolate æ¶ˆæ¯ã€<strong>ç‚¹å‡»äº‹ä»¶</strong>ã€<strong>ç»˜åˆ¶æŒ‡ä»¤</strong>ã€‚</p>
</li>
<li>
<p><strong>è§„åˆ™</strong>ï¼šå½“ VIP ç­ç©ºäº†ï¼ŒæŸœå‘˜æ‰ä¼šä»è¿™é‡Œæ‹¿å‡ºä¸€ä¸ªä»»åŠ¡æ‰§è¡Œã€‚æ‰§è¡Œå®Œè¿™ä¸€ä¸ªåï¼Œä»–ä¼š<strong>ç«‹åˆ»å›å¤´æ£€æŸ¥ VIP ç­</strong>ï¼Œç¡®è®¤æ²¡æœ‰æ–°äº§ç”Ÿçš„æ€¥ä»¶ï¼Œæ‰ç»§ç»­åšä¸‹ä¸€ä¸ªæ™®é€šä»»åŠ¡ã€‚</p>
</li>
</ul>
<h3 data-id="heading-7">1.4 æœ€å¤§çš„è¿·æ€ï¼š<code>Future</code> å¹¶ä¸æ˜¯â€œåå°çº¿ç¨‹â€</h3>
<p>è¿™æ˜¯æ–°æ‰‹å¼€å‘è€…æœ€å®¹æ˜“è¸©çš„å‘ã€‚æˆ‘ä»¬çœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ªè€—æ—¶è®¡ç®—</span>
void <span class="hljs-built_in">heavyTask</span>() {
  <span class="hljs-selector-tag">var</span> count = <span class="hljs-number">0</span>;
  for (int i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000000</span>; i++) { count += <span class="hljs-selector-tag">i</span>; }
  <span class="hljs-built_in">print</span>("è®¡ç®—å®Œæˆ");
}

void <span class="hljs-built_in">onTap</span>() async {
  <span class="hljs-comment">// è¯¯åŒºï¼šä»¥ä¸ºåŠ äº† Future å°±ä¸å¡äº†</span>
  await <span class="hljs-built_in">Future</span>(() =&gt; <span class="hljs-built_in">heavyTask</span>()); 
  <span class="hljs-built_in">print</span>("UI åˆ·æ–°");
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¿™ä¾ç„¶ä¼šå¡æ­» UIï¼Ÿ</strong></p>
<p>å› ä¸º <code>Future</code> å’Œ <code>async/await</code> åœ¨å¤„ç† <strong>CPU å¯†é›†å‹ä»»åŠ¡</strong> æ—¶ï¼Œæä¾›çš„æ˜¯ä¸€ç§ <strong>â€œå‡å¼‚æ­¥â€</strong> ã€‚</p>
<p>Dart å¯¹å¾…ä»»åŠ¡æœ‰ä¸¤ç§æˆªç„¶ä¸åŒçš„å¤„ç†æ–¹å¼ï¼š</p>
<ol>
<li>
<p><strong>çœŸå¤–åŒ… (I/O æ“ä½œ)</strong> ï¼š</p>
<ul>
<li>æ¯”å¦‚ <code>http.get</code> æˆ–è¯»å†™æ–‡ä»¶ã€‚Dart ç¡®å®æŠŠä»»åŠ¡å¤–åŒ…ç»™äº†æ“ä½œç³»ç»Ÿã€‚ä¸»å¨ï¼ˆMain Isolateï¼‰æŠŠå•å­ç”©å‡ºå»å°±ä¸ç®¡äº†ï¼Œç»§ç»­åšèœï¼ˆåˆ·æ–° UIï¼‰ã€‚ç­‰æ“ä½œç³»ç»Ÿæå®šåï¼Œé€šè¿‡ä¸­æ–­é€šçŸ¥ Dartï¼ŒDart å†æŠŠç»“æœæ”¾å› Event Queueã€‚<strong>è¿™ç¡®å®ä¸å¡ UIã€‚</strong></li>
</ul>
</li>
<li>
<p><strong>å‡å¼‚æ­¥ (CPU è®¡ç®—)</strong> ï¼š</p>
<ul>
<li>
<p>æ¯”å¦‚ä¸Šé¢çš„ <code>heavyTask</code>ã€‚Dart æ— æ³•å¤–åŒ…â€œå¾ªç¯è®¡ç®—â€ï¼Œè¿™å¿…é¡»ç”± CPU äº²è‡ªæ‰§è¡Œã€‚</p>
</li>
<li>
<p><code>Future</code> æ‰€åšçš„ï¼Œä»…ä»…æ˜¯æŠŠè¿™ä¸ªæ²‰é‡çš„è®¡ç®—ä»»åŠ¡æ‰“åŒ…æˆä¸€ä¸ª Eventï¼Œ<strong>æ’é˜Ÿ</strong> åˆ°äº† Event Queue çš„æœ«å°¾ã€‚</p>
</li>
<li>
<p><strong>åæœ</strong>ï¼šè™½ç„¶å½“ä¸‹æ²¡å¡ï¼Œä½†ç­‰ Event Loop è½®åˆ°è¿™ä¸ªä»»åŠ¡æ—¶ï¼ŒMain Isolate å¿…é¡»äº²è‡ªä¸Šé˜µè®¡ç®—ã€‚åœ¨è®¡ç®—çš„é‚£å‡ ç§’é’Ÿé‡Œï¼Œå®ƒæ— æ³•å¤„ç† UI ç»˜åˆ¶ï¼ŒApp ä¾ç„¶å¡æ­»ã€‚</p>
</li>
</ul>
</li>
</ol>
<h3 data-id="heading-8">1.5 ç ´å±€ï¼šå¹¶å‘ (Concurrency) vs å¹¶è¡Œ (Parallelism)</h3>
<p>è‡³æ­¤ï¼ŒçŸ›ç›¾å·²ç»éå¸¸æ¸…æ™°äº†ï¼š</p>
<ul>
<li>
<p><strong>Main Isolate</strong> å¤ªå¿™äº†ï¼Œæ—¢è¦æ¸²æŸ“ UI åˆè¦è·‘é€»è¾‘ã€‚</p>
</li>
<li>
<p><strong>Future</strong> åªæ˜¯æ”¹å˜äº†ä»»åŠ¡æ‰§è¡Œçš„é¡ºåºï¼ˆå¹¶å‘ï¼‰ï¼Œå¹¶æ²¡æœ‰å¢åŠ å¹²æ´»çš„äººæ‰‹ã€‚</p>
</li>
</ul>
<p>å¦‚æœä½ çš„ä»»åŠ¡æ˜¯â€œç­‰å¾…å‹â€ï¼ˆI/Oï¼‰ï¼Œ<code>Future</code> è¶³å¤Ÿäº†ã€‚ä½†å¦‚æœä½ çš„ä»»åŠ¡æ˜¯â€œè®¡ç®—å‹â€ï¼ˆCPUï¼‰ï¼Œä½ éœ€è¦çš„ä¸æ˜¯æ›´å¥½çš„æ’é˜ŸæŠ€å·§ï¼Œè€Œæ˜¯<strong>é›‡ä½£ä¸€ä¸ªæ–°çš„å¨å¸ˆ</strong>ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦ä» <strong>å¹¶å‘ (Concurrency)</strong> èµ°å‘çœŸæ­£çš„ <strong>å¹¶è¡Œ (Parallelism)</strong> ã€‚</p>
<p>åœ¨ Dart ä¸­ï¼Œè¿™ä¸ªâ€œæ–°å¨å¸ˆâ€ï¼Œå°±æ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥è¦æ·±å…¥æ¢è®¨çš„ä¸»è§’ â€”â€” <strong>Isolate</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-9">ç¬¬äºŒç« ï¼šå…¨è²Œ â€”â€” Isolate åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>åœ¨ç¬¬ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å·²ç»æ˜ç¡®äº†ä¸€ä¸ªæ®‹é…·çš„ç°å®ï¼šMain Isolate è¿™ä½â€œç‹¬è£è€…â€å¤ªå¿™äº†ï¼Œä»»ä½•è€—æ—¶çš„ CPU è®¡ç®—éƒ½ä¼šå¯¼è‡´ UI å¡é¡¿ã€‚ä¸ºäº†æ‰“ç ´å•çº¿ç¨‹çš„ç‰©ç†é™åˆ¶ï¼Œæˆ‘ä»¬éœ€è¦â€œé›‡ä½£æ–°å¨å¸ˆâ€ã€‚</p>
<p>åœ¨ Dart çš„ä¸–ç•Œé‡Œï¼Œè¿™ä¸ªæ–°å¨å¸ˆå°±æ˜¯ <strong>Isolate</strong>ã€‚</p>
<p>æœ¬ç« å°†å¸¦ä½ å‰¥å¼€ Isolate çš„å¤–å£³ï¼Œä»åº•å±‚å†…å­˜æ¨¡å‹å’Œæ¶æ„è®¾è®¡ä¸Šï¼Œé‡æ–°è®¤è¯†è¿™ä¸ªå¹¶å‘å®ä½“ã€‚</p>
<h3 data-id="heading-10">2.1 å®šä¹‰ï¼šæŠ«ç€çº¿ç¨‹çš®çš„â€œå¾®å‹è¿›ç¨‹â€</h3>
<p>Isolate çš„ä¸­æ–‡ç›´è¯‘æ˜¯ <strong>â€œéš”ç¦»åŒºâ€</strong> ã€‚è¿™ä¸ªåå­—æå…¶ç²¾å‡†åœ°é“å‡ºäº†å®ƒçš„æ ¸å¿ƒç‰¹å¾ã€‚</p>
<ul>
<li>
<p><strong>ç‰©ç†çœŸç›¸ï¼ˆæ“ä½œç³»ç»Ÿè§†è§’ï¼‰</strong> ï¼šIsolate ç¡®å®æ˜¯ä¸€ä¸ª <strong>çº¿ç¨‹ï¼ˆThreadï¼‰</strong> ã€‚å®ƒç”±åº•å±‚æ“ä½œç³»ç»Ÿè°ƒåº¦ï¼Œèƒ½å¤ŸçœŸæ­£åˆ©ç”¨å¤šæ ¸ CPU çš„å¹¶è¡Œè®¡ç®—èƒ½åŠ›ã€‚</p>
</li>
<li>
<p><strong>é€»è¾‘çœŸç›¸ï¼ˆä»£ç è¿è¡Œè§†è§’ï¼‰</strong> ï¼šå®ƒæ›´åƒæ˜¯ä¸€ä¸ª <strong>å¾®å‹è¿›ç¨‹ï¼ˆMini Processï¼‰</strong> ã€‚å› ä¸ºå®ƒâ€œå…­äº²ä¸è®¤â€ï¼Œæ‹¥æœ‰æå¼ºçš„ç‹¬ç«‹æ€§ã€‚</p>
</li>
</ul>
<p>éœ€è¦çº æ­£çš„ä¸€ä¸ªè¯¯åŒºæ˜¯ï¼š<strong>Main Isolate å¹¶æ²¡æœ‰ä»€ä¹ˆç¥æƒã€‚</strong> å®ƒæœ¬è´¨ä¸Šå’Œä½ åœ¨åå°åˆ›å»ºçš„ Isolate ä¸€æ¨¡ä¸€æ ·ï¼Œå”¯ä¸€çš„åŒºåˆ«ä»…ä»…æ˜¯å®ƒå¯åŠ¨å¾—æœ€æ—©ï¼Œå¹¶ç»‘å®šäº† UI æ¸²æŸ“å¼•æ“è€Œå·²ã€‚</p>
<h3 data-id="heading-11">2.2 å†…å­˜æ¨¡å‹ï¼šShared Memory vs Message Passing</h3>
<p>è¿™æ˜¯ Dart Isolate ä¸ Java/C++ ç­‰ä¼ ç»Ÿå¤šçº¿ç¨‹æ¨¡å‹æœ€å¤§çš„åˆ†æ°´å²­ã€‚</p>
<h4 data-id="heading-12">ä¼ ç»Ÿå¤šçº¿ç¨‹æ¨¡å‹ï¼ˆJava/C++ï¼‰</h4>
<p>åœ¨ Java ä¸­ï¼Œå¤šä¸ªçº¿ç¨‹ç”Ÿæ´»åœ¨åŒä¸€ä¸ªâ€œå±‹æªä¸‹â€ï¼š</p>
<ul>
<li>
<p><strong>å…±äº«å †å†…å­˜ï¼ˆShared Heapï¼‰</strong> ï¼šçº¿ç¨‹ A åˆ›å»ºçš„å…¨å±€å˜é‡ï¼Œçº¿ç¨‹ B å¯ä»¥ç›´æ¥è¯»å–ç”šè‡³ä¿®æ”¹ã€‚</p>
</li>
<li>
<p><strong>ä»£ä»·</strong>ï¼šä¾¿åˆ©çš„ä»£ä»·æ˜¯å±é™©ã€‚ä¸ºäº†é˜²æ­¢ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶ä¿®æ”¹åŒä¸€ä¸ªå˜é‡ï¼ˆç«æ€æ¡ä»¶ï¼‰ï¼Œå¼€å‘è€…å¿…é¡»å°å¿ƒç¿¼ç¿¼åœ°åŠ  <strong>é”ï¼ˆLockï¼‰</strong> ï¼ˆå¦‚ <code>synchronized</code>ï¼‰ã€‚ä¸€æ—¦é”æ²¡è®¾è®¡å¥½ï¼Œå°±ä¼šå¯¼è‡´æ­»é”ï¼ˆDeadlockï¼‰æˆ–è€…æ•°æ®é”™ä¹±ã€‚</p>
</li>
</ul>
<h4 data-id="heading-13">Dart Isolate æ¨¡å‹</h4>
<p>Dart é€‰æ‹©äº†å¦ä¸€æ¡è·¯ï¼š<strong>å†…å­˜éš”ç¦»ï¼ˆMemory Isolationï¼‰</strong> ã€‚</p>
<ul>
<li>
<p><strong>ç‹¬ç«‹å †å†…å­˜</strong>ï¼šæ¯ä¸ª Isolate éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„å †å†…å­˜ï¼ˆHeapï¼‰ã€‚Isolate A é‡Œçš„å˜é‡ï¼ŒIsolate B æ ¹æœ¬çœ‹ä¸è§ï¼Œæ›´æ‘¸ä¸ç€ã€‚</p>
</li>
<li>
<p><strong>æ— é”ç¼–ç¨‹</strong>ï¼šå› ä¸ºæ ¹æœ¬æ— æ³•å…±äº«å˜é‡ï¼Œæ‰€ä»¥ Dart ç”šè‡³æ²¡æœ‰â€œçº¿ç¨‹é”â€è¿™ç§ä¸œè¥¿ã€‚ä½ æ°¸è¿œä¸éœ€è¦æ‹…å¿ƒæ­»é”é—®é¢˜ã€‚</p>
</li>
<li>
<p><strong>ç‹¬ç«‹ GC</strong>ï¼šæ¯ä¸ª Isolate çš„åƒåœ¾å›æ”¶å™¨ï¼ˆGCï¼‰ä¹Ÿæ˜¯ç‹¬ç«‹çš„ã€‚åå° Isolate åœ¨ç–¯ç‹‚ GC æ—¶ï¼Œä¸æ¯«ä¸ä¼šå½±å“ Main Isolate çš„è¿è¡Œï¼Œä¹Ÿå°±ä¸ä¼šé€ æˆ UI çš„â€œGC å¡é¡¿â€ã€‚</p>
</li>
</ul>
<blockquote>
<p><strong>å“²å­¦å¼•è¨€</strong>ï¼šGo è¯­è¨€æœ‰ä¸€å¥åè¨€ï¼ŒåŒæ ·é€‚ç”¨äº Dartï¼šâ€œä¸è¦é€šè¿‡å…±äº«å†…å­˜æ¥é€šä¿¡ï¼Œè€Œè¦é€šè¿‡é€šä¿¡æ¥å…±äº«å†…å­˜ã€‚â€</p>
</blockquote>
<h3 data-id="heading-14">2.3 è§£å‰–å®¤ï¼šéº»é›€è™½å°ï¼Œäº”è„ä¿±å…¨</h3>
<p>Isolate ä¸æ˜¯ä¸€ä¸ªè½»é‡çº§çš„å¯¹è±¡ï¼ˆæ¯”å¦‚åç¨‹ï¼‰ï¼Œå®ƒæ˜¯ä¸€ä¸ª<strong>é‡èµ„äº§</strong>ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½åƒåˆ›å»º <code>Future</code> é‚£æ ·éšæ„åˆ›å»ºæˆåƒä¸Šä¸‡ä¸ª Isolate çš„åŸå› ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬åˆ‡å¼€ä¸€ä¸ª Isolateï¼Œä½ ä¼šå‘ç°å®ƒå†…éƒ¨è‡ªå¸¦äº†ä¸€å¥—å®Œæ•´çš„â€œåŸºå»ºâ€ï¼š</p>
<ol>
<li>
<p><strong>ç‹¬ç«‹çš„ Heapï¼ˆå †å†…å­˜ï¼‰</strong> ï¼šç”¨äºå­˜æ”¾è¯¥ Isolate åˆ›å»ºçš„æ‰€æœ‰å¯¹è±¡ã€‚</p>
</li>
<li>
<p><strong>ç‹¬ç«‹çš„ Event Loopï¼ˆäº‹ä»¶å¾ªç¯ï¼‰</strong> ï¼šæ²¡é”™ï¼Œæ¯ä¸ªåå° Isolate å†…éƒ¨éƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„â€œé“¶è¡ŒæŸœå‘˜â€ã€‚å®ƒå¯åŠ¨åå°±ä¼šè¿›å…¥å¾ªç¯ï¼Œç­‰å¾…æ¥æ”¶å¹¶å¤„ç†æ¶ˆæ¯ã€‚</p>
</li>
<li>
<p><strong>ç‹¬ç«‹çš„ Stackï¼ˆæ ˆï¼‰</strong> ï¼šç”¨äºå‡½æ•°è°ƒç”¨å’Œå±€éƒ¨å˜é‡ã€‚</p>
</li>
<li>
<p><strong>Message Handlerï¼ˆæ¶ˆæ¯å¤„ç†å™¨ï¼‰</strong> ï¼šä¸“é—¨è´Ÿè´£å¤„ç†ç«¯å£æ¶ˆæ¯çš„åº•å±‚ç»„ä»¶ã€‚</p>
</li>
</ol>
<h4 data-id="heading-15">2.3.1 è¿›é˜¶çŸ¥è¯†ï¼šIsolate Groups ä¸è½»é‡åŒ–é©å‘½</h4>
<p>çœ‹åˆ°è¿™é‡Œï¼Œç»†å¿ƒçš„è¯»è€…å¯èƒ½ä¼šé—®ï¼šâ€œå¦‚æœæ¯ä¸ª Isolate éƒ½è¿™ä¹ˆé‡ï¼Œä¸ºä»€ä¹ˆ Flutter ç°åœ¨çš„æ€§èƒ½è¿™ä¹ˆå¥½ï¼Œç”šè‡³èƒ½æ”¯æŒ run è¿™ç§å³ç”¨å³æ¯çš„ APIï¼Ÿâ€</p>
<p>ç§˜å¯†åœ¨äº Dart 2.15 å¼•å…¥çš„åº•å±‚é»‘ç§‘æŠ€ â€”â€” <strong>Isolate Groupsï¼ˆéš”ç¦»ç¾¤ç»„ï¼‰ã€‚</strong></p>
<p>åœ¨æ—§ç‰ˆæœ¬ä¸­ï¼Œæ¯åˆ›å»ºä¸€ä¸ªæ–° Isolateï¼ŒVM éƒ½è¦æŠŠä»£ç é‡æ–°æ‹·è´ä¸€ä»½åˆ°æ–°å†…å­˜ä¸­ã€‚ä½†åœ¨ç°ä»£ Dart ä¸­ï¼Œé€šè¿‡ Isolate.spawn åˆ›å»ºçš„çº¿ç¨‹é»˜è®¤ä¼šåŠ å…¥åŒä¸€ä¸ª Groupã€‚</p>
<p><strong>Isolate Groups çš„æ ¸å¿ƒé€»è¾‘æ˜¯ï¼šâ€œå…±äº«é€»è¾‘ï¼Œéš”ç¦»æ•°æ®â€ã€‚</strong></p>
<ul>
<li>
<p>å…±äº«ä»£ç æŒ‡ä»¤ï¼ˆShared Codeï¼‰ï¼š å°±å¥½æ¯”é¤å…é‡Œçš„å¨å¸ˆã€‚ä»¥å‰æ‹›ä¸€ä¸ªæ–°å¨å¸ˆï¼Œå¿…é¡»ç»™ä»–ä¹°ä¸€æœ¬æ–°çš„ã€Šçƒ¹é¥ªå¤§å…¨ã€‹ï¼ˆä»£ç æŒ‡ä»¤ï¼‰ã€‚ç°åœ¨ï¼Œæ‰€æœ‰å¨å¸ˆå…±ç”¨å¢™ä¸Šçš„ä¸€å—ç”µå­å¤§å±å¹•ï¼ˆå…±äº«å†…å­˜åŒºåŸŸï¼‰æ¥çœ‹èœè°±ã€‚ æ— è®ºä½ å¼€ 10 ä¸ªè¿˜æ˜¯ 100 ä¸ª Isolateï¼Œä»£ç åœ¨å†…å­˜ä¸­æ°¸è¿œåªå ä¸€ä»½ç©ºé—´ã€‚</p>
</li>
<li>
<p>ç‹¬ç«‹å †æ•°æ®ï¼ˆIndependent Heapï¼‰ï¼š è™½ç„¶èœè°±å¤§å®¶ä¸€èµ·çœ‹ï¼Œä½†æ¯ä¸ªå¨å¸ˆæ‰‹é‡Œçš„**é”…å’Œé£Ÿæï¼ˆå˜é‡æ•°æ®ï¼‰**ä¾ç„¶æ˜¯ç§æœ‰çš„ï¼Œç»å¯¹äº’ä¸å¹²æ‰°ã€‚</p>
</li>
</ul>
<p><strong>å†…å­˜å…¬å¼å¯¹æ¯”</strong>ï¼š</p>
<ul>
<li>
<p>æ—§ç‰ˆæœ¬ï¼šå†…å­˜å ç”¨ = (ä»£ç ä½“ç§¯ + å †æ•°æ®) Ã— Isolateæ•°é‡</p>
</li>
<li>
<p>æ–°ç‰ˆæœ¬ï¼šå†…å­˜å ç”¨ = ä»£ç ä½“ç§¯ Ã— 1 + (å †æ•°æ® Ã— Isolateæ•°é‡)</p>
</li>
</ul>
<p>æ­£æ˜¯å› ä¸º Isolate Groupsï¼Œæ–° Isolate çš„å¯åŠ¨æ—¶é—´ä» æ¯«ç§’çº§ï¼ˆmsï¼‰ é£è·ƒåˆ°äº† å¾®ç§’çº§ï¼ˆusï¼‰ï¼Œå†…å­˜å¼€é”€ä¹Ÿé™ä½äº†æ•°åå€ã€‚è¿™ä¸ºæˆ‘ä»¬åç»­ä½¿ç”¨ Isolate.run æä¾›äº†åšå®çš„åº•å±‚åº•æ°”ã€‚</p>
<h3 data-id="heading-16">2.4 é€šä¿¡æœºåˆ¶ï¼šActor æ¨¡å‹</h3>
<p>æ—¢ç„¶å†…å­˜è¢«ä¸€å µå¢™éš”å¼€äº†ï¼ŒIsolate ä¹‹é—´å¦‚ä½•åä½œï¼Ÿ Dart é‡‡ç”¨çš„æ˜¯ç±»ä¼¼äº <strong>Actor æ¨¡å‹</strong> çš„æœºåˆ¶ï¼š<strong>æ¶ˆæ¯ä¼ é€’ï¼ˆMessage Passingï¼‰</strong> ã€‚</p>
<p>ä½ å¯ä»¥æŠŠä¸¤ä¸ª Isolate æƒ³è±¡æˆä½åœ¨ä¸¤ä¸ªä¸åŒå²›å±¿ä¸Šçš„äººï¼š</p>
<ul>
<li>
<p>ä»–ä»¬ä¸èƒ½ç›´æ¥å–Šè¯ï¼ˆä¸å…±äº«å†…å­˜ï¼‰ã€‚</p>
</li>
<li>
<p>ä»–ä»¬å¿…é¡»é€šè¿‡**æ¼‚æµç“¶ï¼ˆPortï¼‰**æ¥äº¤æµã€‚</p>
</li>
</ul>
<h4 data-id="heading-17">æ ¸å¿ƒç»„ä»¶ï¼š</h4>
<ul>
<li>
<p><strong>ReceivePortï¼ˆæ”¶ä¿¡ç®±ï¼‰</strong> ï¼š</p>
<ul>
<li>
<p>å±äºå½“å‰ Isolateã€‚</p>
</li>
<li>
<p>è¿™æ˜¯ä¸€ä¸ª<strong>é•¿æœŸç›‘å¬</strong>çš„æµï¼ˆStreamï¼‰ã€‚</p>
</li>
<li>
<p><em>éšå–»</em>ï¼šè¿™æ˜¯ä½ å²›ä¸Šçš„è‡ªå®¶ä¿¡ç®±ï¼Œåªæœ‰ä½ èƒ½æ‰“å¼€çœ‹é‡Œé¢çš„ä¿¡ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>SendPortï¼ˆå¯„ä¿¡åœ°å€ï¼‰</strong> ï¼š</p>
<ul>
<li>
<pre><code class="hljs language-go" lang="go">è¿™æ˜¯ <span class="hljs-string">`ReceivePort`</span> å¯¹åº”çš„â€œåœ°å€â€ã€‚
</code></pre>
</li>
<li>
<p>å®ƒæ˜¯ä¸€ä¸ª<strong>èƒ½åŠ›ï¼ˆCapabilityï¼‰</strong> ï¼Œå¯ä»¥è¢«å‘é€ç»™å…¶ä»– Isolateã€‚</p>
</li>
<li>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-emphasis">*éšå–»*</span>ï¼šè¿™æ˜¯ä½ çš„åç‰‡ã€‚ä½ æŠŠåç‰‡å‘ç»™è°ï¼Œè°å°±å¯ä»¥å¾€ä½ çš„ä¿¡ç®±é‡ŒæŠ•é€’æ¶ˆæ¯ã€‚
</code></pre>
</li>
</ul>
</li>
</ul>
<h4 data-id="heading-18">é€šä¿¡çš„æœ¬è´¨ï¼š</h4>
<p>å½“ Isolate A æƒ³è¦æŠŠæ•°æ®å‘ç»™ Isolate B æ—¶ï¼Œå®ƒä¸èƒ½ç›´æ¥ä¼ å¼•ç”¨ï¼ˆå› ä¸ºå†…å­˜ä¸å…±äº«ï¼‰ã€‚ å®ƒå¿…é¡»æŠŠæ•°æ® <strong>â€œåºåˆ—åŒ–â€</strong> ï¼ˆæ‰“åŒ…ï¼‰ï¼Œé€šè¿‡åº•å±‚çš„ C++ é€šé“ä¼ è¿‡å»ï¼ŒIsolate B æ”¶åˆ°åå† <strong>â€œååºåˆ—åŒ–â€</strong> ï¼ˆè§£åŒ…ï¼‰ã€‚</p>
<p>è¿™ä¸ªè¿‡ç¨‹åœ¨å†å²ä¸Šæ˜¯æœ‰æ€§èƒ½ä»£ä»·çš„ï¼ˆDeep Copyï¼‰ï¼Œä½†åœ¨ Dart çš„æœ€æ–°ç‰ˆæœ¬ä¸­ï¼Œè¿™ä¸€æœºåˆ¶è¿æ¥äº†é©å‘½æ€§çš„ä¼˜åŒ–ï¼ˆIsolate.exitï¼‰ã€‚æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ç« çš„â€œå®æˆ˜â€ä¸­è¯¦ç»†æ‹†è§£ã€‚</p>
<hr/>
<h2 data-id="heading-19">ç¬¬ä¸‰ç« ï¼šå®æˆ˜ â€”â€” ä¸‰ç§æ­¦å™¨çš„æ¼”è¿›</h2>
<p>äº†è§£äº† Isolate çš„åº•å±‚éš”ç¦»åŸç†åï¼Œæˆ‘ä»¬å›åˆ°äº†ç°å®çš„å¼€å‘æˆ˜åœºã€‚Dart çš„å¹¶å‘å·¥å…·ç®±å¹¶éä¸€æˆä¸å˜ï¼Œå®ƒç»å†äº†ä¸€ä¸ªä»â€œç¬¨é‡â€åˆ°â€œæè‡´â€çš„æ¼”è¿›è¿‡ç¨‹ã€‚</p>
<p>ç›®å‰çš„æœ€ä½³å®è·µï¼Œå¯ä»¥æ¦‚æ‹¬ä¸ºä¸‰ç§ä¸åŒé‡çº§çš„æ­¦å™¨ï¼š<code>compute</code> <strong>ï¼ˆä¸Šå¤ç¥å™¨ï¼‰</strong> ã€<code>Isolate.run</code> <strong>ï¼ˆç°ä»£å…µå™¨ï¼‰</strong> å’Œ <code>Isolate.spawn</code> <strong>ï¼ˆé‡å‹æ­¦å™¨ï¼‰</strong> ã€‚</p>
<h3 data-id="heading-20">3.1 ä¸Šå¤ç¥å™¨ï¼š<code>compute</code> â€”â€” ç®€å•ä½†æœ‰ä»£ä»·</h3>
<p>åœ¨ Flutter çš„æ—©æœŸç‰ˆæœ¬ä¸­ï¼Œ<code>compute</code> æ˜¯å®˜æ–¹æä¾›çš„å”¯ä¸€â€œä¸€é”®å¼â€æ–¹æ¡ˆã€‚</p>
<ul>
<li>
<p><strong>å®šä½</strong>ï¼š <strong>â€œä¸€é”¤å­ä¹°å–â€çš„æ•°æ®æ¬è¿å·¥</strong>ã€‚</p>
</li>
<li>
<p><strong>ç”¨æ³•</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// æ¥æ”¶ä¸€ä¸ªé¡¶å±‚å‡½æ•°å’Œä¸€ä¸ªå‚æ•°ï¼Œè‡ªåŠ¨åˆ›å»ºçº¿ç¨‹å¹¶è®¡ç®—
final <span class="hljs-attr">result</span> = await compute(heavyAlgo, data)<span class="hljs-comment">;</span>
</code></pre>
</li>
</ul>
<h4 data-id="heading-21">ç—›ç‚¹ï¼šæ•°æ®çš„â€œæ¬è¿â€æˆæœ¬</h4>
<p><code>compute</code> è™½ç„¶å¥½ç”¨ï¼Œä½†å®ƒåœ¨ Dart 2.19 ä¹‹å‰å­˜åœ¨ä¸€ä¸ªæ˜¾è‘—çš„æ€§èƒ½ç“¶é¢ˆã€‚å®ƒåœ¨å†…éƒ¨æ‰§è¡Œäº†å®Œæ•´çš„ï¼š<strong>Spawnï¼ˆåˆ›å»ºï¼‰ -&gt; Copy Inï¼ˆä¼ å…¥ï¼‰ -&gt; Workï¼ˆè®¡ç®—ï¼‰ -&gt; Copy Outï¼ˆä¼ å‡ºï¼‰ -&gt; Killï¼ˆé”€æ¯ï¼‰</strong> æµç¨‹ã€‚</p>
<p>è¿™é‡Œæœ€å¤§çš„ç—›ç‚¹åœ¨äº <strong>Copy Out</strong>ã€‚</p>
<p>å‡è®¾å­çº¿ç¨‹å¤„ç†å®Œäº†ä¸€å¼  4K å›¾ç‰‡ï¼Œç”Ÿæˆäº† 50MB çš„æ•°æ®è¦è¿”å›ç»™ä¸»çº¿ç¨‹ã€‚</p>
<ul>
<li>
<p><strong>åŠ¨ä½œ</strong>ï¼šDart VM å¿…é¡»åœ¨ä¸»çº¿ç¨‹ç”³è¯·æ–°çš„ 50MB å†…å­˜ï¼Œç„¶åæŠŠå­çº¿ç¨‹çš„æ•°æ®é€å­—èŠ‚**å¤åˆ¶ï¼ˆDeep Copyï¼‰**è¿‡æ¥ã€‚</p>
</li>
<li>
<p><strong>åæœ</strong>ï¼šè™½ç„¶è®¡ç®—æ˜¯åœ¨åå°åšçš„ï¼Œä½†åœ¨<strong>æ¥æ”¶ç»“æœçš„é‚£ä¸€ç¬é—´</strong>ï¼Œä¸»çº¿ç¨‹å› ä¸ºè¦è¿›è¡Œç¹é‡çš„å†…å­˜å†™å…¥æ“ä½œï¼Œä¾ç„¶å¯èƒ½å‡ºç°æ‰å¸§ã€‚</p>
</li>
</ul>
<h3 data-id="heading-22">3.2 ç°ä»£å…µå™¨ï¼š<code>Isolate.run</code> â€”â€” æ€§èƒ½é©å‘½</h3>
<p>ä¸ºäº†è§£å†³æ‹·è´æˆæœ¬ï¼ŒDart 2.19ï¼ˆFlutter 3.7+ï¼‰å¼•å…¥äº† <code>Isolate.run</code>ã€‚è¿™æ˜¯å¹¶å‘ç¼–ç¨‹çš„ä¸€æ¬¡â€œé™ç»´æ‰“å‡»â€ã€‚</p>
<h4 data-id="heading-23">3.2.1 æ ¸å¿ƒé»‘ç§‘æŠ€ï¼šZero-Copy (é›¶æ‹·è´)</h4>
<p><code>Isolate.run</code> ä¹‹æ‰€ä»¥è¢«èª‰ä¸ºç°ä»£å…µå™¨ï¼Œæ˜¯å› ä¸ºå®ƒåœ¨è¿”å›ç»“æœæ—¶ï¼Œå¼•å…¥äº†åº•å±‚çš„ <code>Isolate.exit</code> æœºåˆ¶ï¼Œå®ç°äº† <strong>å†…å­˜æ‰€æœ‰æƒè½¬ç§» (Ownership Transfer)</strong> ã€‚</p>
<p>è®©æˆ‘ä»¬å¯¹æ¯”ä¸€ä¸‹â€œä¼ ç»Ÿæ¨¡å¼â€å’Œâ€œæ–°æ¨¡å¼â€çš„åŒºåˆ«ï¼š</p>
<ul>
<li>
<p><strong>ä¼ ç»Ÿæ¨¡å¼ (SendPort.send) â€”â€” æ¬è¿å·¥æ¨¡å¼</strong></p>
<ul>
<li>
<p>å­çº¿ç¨‹æœ‰ 100MB ç»“æœã€‚</p>
</li>
<li>
<p>VM åœ¨ä¸»çº¿ç¨‹<strong>å¤å°</strong>ä¸€ä»½ã€‚</p>
</li>
<li>
<p>é”€æ¯å­çº¿ç¨‹çš„ 100MBã€‚</p>
</li>
<li>
<p><strong>è€—æ—¶ï¼šO(N)</strong> ï¼Œæ•°æ®è¶Šå¤§è¶Šæ…¢ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>æ–°æ¨¡å¼ (Isolate.run / exit) â€”â€” æˆ¿äº§è¿‡æˆ·æ¨¡å¼</strong></p>
<ul>
<li>
<p>å­çº¿ç¨‹æœ‰ 100MB ç»“æœï¼ˆå ç”¨ç‰©ç†å†…å­˜é¡µ #A, #Bï¼‰ã€‚</p>
</li>
<li>
<p>å­çº¿ç¨‹ä»»åŠ¡ç»“æŸï¼ŒVM ä»‹å…¥ã€‚</p>
</li>
<li>
<p>VM <strong>ä¸å¤åˆ¶æ•°æ®</strong>ï¼Œè€Œæ˜¯ç›´æ¥ä¿®æ”¹å†…å­˜é¡µ #A, #B çš„<strong>å½’å±æƒæ ‡ç­¾</strong>ã€‚</p>
</li>
<li>
<p>VM å®£å¸ƒï¼šâ€œè¿™ä¸¤é¡µå†…å­˜ç°åœ¨å½’ Main Isolate æ‰€æœ‰äº†ã€‚â€</p>
</li>
<li>
<p><strong>è€—æ—¶ï¼šO(1)</strong> ã€‚æ— è®ºæ•°æ®æ˜¯ 1KB è¿˜æ˜¯ 1GBï¼Œè¿”å›è€—æ—¶å‡ ä¹ä¸º 0ã€‚</p>
</li>
</ul>
</li>
</ul>
<h4 data-id="heading-24">3.2.2 é—­åŒ…çš„â€œç”œèœœé™·é˜±â€</h4>
<p><code>Isolate.run</code> çš„ API è®¾è®¡éå¸¸ä¼˜é›…ï¼Œå®ƒå…è®¸ç›´æ¥ä¼ å…¥é—­åŒ…ï¼ˆClosureï¼‰ï¼Œå†™èµ·æ¥å°±åƒæ™®é€šçš„ <code>Future</code> ä¸€æ ·è‡ªç„¶ï¼š</p>
<p>Dart</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">void</span> process() <span class="hljs-keyword">async</span> {
  <span class="hljs-keyword">final</span> rawData = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
  <span class="hljs-comment">// ç›´æ¥ä½¿ç”¨é—­åŒ…ï¼Œçœ‹èµ·æ¥å¾ˆç¾å¥½</span>
  <span class="hljs-keyword">final</span> result = <span class="hljs-keyword">await</span> Isolate.run(() {
    <span class="hljs-keyword">return</span> rawData.map((e) =&gt; e * <span class="hljs-number">2</span>).toList();
  });
}
</code></pre>
<p>ä½†è¿™èƒŒåéšè—ç€ä¸€ä¸ªå·¨å¤§çš„é™·é˜±ï¼š<strong>éšå¼æ•è·</strong>ã€‚</p>
<p><strong>åŸç†</strong>ï¼šå½“ä½ æŠŠä¸€ä¸ªé—­åŒ…ä¼ ç»™ Isolate æ—¶ï¼ŒDart ä¼šå°è¯•æŠŠè¿™ä¸ªé—­åŒ…<strong>è¿åŒå®ƒæ•è·çš„æ‰€æœ‰ä¸Šä¸‹æ–‡</strong>ä¸€èµ·æ‰“åŒ…ï¼ˆæ·±æ‹·è´ï¼‰å‘é€è¿‡å»ã€‚</p>
<p><strong>å´©æºƒåœºæ™¯</strong>ï¼š</p>
<p>å¦‚æœä½ åœ¨ç±»çš„æ–¹æ³•ä¸­ç›´æ¥ä½¿ç”¨ <code>Isolate.run</code>ï¼Œé—­åŒ…å¾€å¾€ä¼šéšå¼æ•è· <code>this</code>ã€‚è€Œå¦‚æœ <code>this</code>ï¼ˆå½“å‰å®ä¾‹ï¼‰ä¸­åŒ…å«äº† <strong>Socketã€Streamã€UI æ§ä»¶ï¼ˆWidget/Contextï¼‰</strong> ç­‰ä¸å¯ä¼ è¾“çš„å¯¹è±¡ï¼Œä»£ç ä¼šç›´æ¥å´©æºƒã€‚</p>
<p>Dart</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// âŒ é”™è¯¯ç¤ºèŒƒï¼šéšå¼æ•è·äº† this</span>
<span class="hljs-keyword">class</span> <span class="hljs-title">MyViewModel</span> {
  final BuildContext context; <span class="hljs-comment">// ä¸å¯ä¼ è¾“ï¼</span>
  MyViewModel(<span class="hljs-keyword">this</span>.context);

  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">heavyTask</span>() <span class="hljs-keyword">async</span></span> {
    <span class="hljs-keyword">await</span> Isolate.run(() {
      <span class="hljs-comment">// è¿™é‡Œçš„ print éšå¼è°ƒç”¨äº† this.toString()</span>
      <span class="hljs-comment">// å¯¼è‡´ VM è¯•å›¾æŠŠæ•´ä¸ª MyViewModel (å« context) æ‹·è´è¿‡å» -&gt; Crash!</span>
      print(<span class="hljs-string">"Task done"</span>); 
    });
  }
}
</code></pre>
<p><strong>âœ… æœ€ä½³å®è·µ</strong>ï¼š <strong>â€œå‡€èº«å‡ºæˆ·â€</strong> ã€‚</p>
<p>åœ¨è¿›å…¥é—­åŒ…å‰ï¼ŒæŠŠéœ€è¦çš„æ•°æ®æå–ä¸º<strong>å±€éƒ¨å˜é‡</strong>ï¼ˆå¦‚ <code>int</code>, <code>String</code>, <code>List</code>ï¼‰ï¼Œç¡®ä¿é—­åŒ…åªæ•è·çº¯æ•°æ®ã€‚</p>
<p>Dart</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// âœ… æ­£ç¡®ç¤ºèŒƒ</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">heavyTask</span>() <span class="hljs-keyword">async</span></span> {
  final dataToProcess = <span class="hljs-string">"Clean String"</span>; <span class="hljs-comment">// æå–å±€éƒ¨å˜é‡</span>
  
  <span class="hljs-keyword">await</span> Isolate.run(() {
    <span class="hljs-comment">// é—­åŒ…åªæ•è·äº† Stringï¼Œéå¸¸å®‰å…¨</span>
    print(dataToProcess); 
  });
}
</code></pre>
<h3 data-id="heading-25">3.3 é‡å‹æ­¦å™¨ï¼š<code>Isolate.spawn</code> â€”â€” é•¿è¿æ¥åŸºçŸ³</h3>
<p>æ—¢ç„¶ <code>run</code> è¿™ä¹ˆå¿«ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ <code>spawn</code> å—ï¼Ÿ</p>
<p>ç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚<code>Isolate.run</code> æ˜¯ <strong>â€œçŸ­è·‘é€‰æ‰‹â€</strong> ï¼Œè·‘å®Œå°±æ­»ï¼ˆè‡ªåŠ¨é”€æ¯ï¼‰ã€‚å¦‚æœä½ éœ€è¦ä¸€ä½ <strong>â€œé©¬æ‹‰æ¾é€‰æ‰‹â€</strong> ï¼Œå°±å¿…é¡»ç”¨ <code>spawn</code>ã€‚</p>
<h4 data-id="heading-26">é€‚ç”¨åœºæ™¯</h4>
<ul>
<li>
<p><strong>çŠ¶æ€ä¿æŒ</strong>ï¼šæ¯”å¦‚ä¸€ä¸ªåå°è®¡æ—¶å™¨ï¼Œæˆ–è€…ä¸€ä¸ªç¼“å­˜æœåŠ¡ã€‚</p>
</li>
<li>
<p><strong>æŒç»­é€šä¿¡</strong>ï¼šæ¯”å¦‚ä¸‹è½½å¤§æ–‡ä»¶æ—¶çš„è¿›åº¦æ¡ï¼ˆ1%...50%...100%ï¼‰ï¼Œæˆ–è€… Socket é•¿è¿æ¥å¿ƒè·³ã€‚</p>
</li>
</ul>
<h4 data-id="heading-27">æ ¸å¿ƒæŠ€æœ¯ï¼šåŒå‘æ¡æ‰‹ (Handshake)</h4>
<p><code>Isolate.spawn</code> åˆ›å»ºæ—¶ï¼Œåªèƒ½ç”±ä¸»çº¿ç¨‹å•å‘ä¼ å‚ç»™å­çº¿ç¨‹ã€‚ä¸ºäº†å®ç°â€œå­çº¿ç¨‹ä¸»åŠ¨æ±‡æŠ¥è¿›åº¦â€ï¼Œæˆ‘ä»¬éœ€è¦å»ºç«‹åŒå‘é€šé“ï¼š</p>
<ol>
<li>
<p><strong>Main</strong>ï¼šåˆ›å»º <code>ReceivePort</code> (MainBox)ï¼ŒæŠŠ <code>MainBox.sendPort</code> ä¼ ç»™ Workerã€‚</p>
</li>
<li>
<p><strong>Worker</strong>ï¼šæ”¶åˆ°åï¼Œåˆ›å»ºè‡ªå·±çš„ <code>ReceivePort</code> (WorkerBox)ã€‚</p>
</li>
<li>
<p><strong>Worker</strong>ï¼šåˆ©ç”¨ <code>MainBox.sendPort</code>ï¼ŒæŠŠè‡ªå·±çš„ <code>WorkerBox.sendPort</code> å‘å›ç»™ Mainã€‚</p>
</li>
<li>
<p><strong>Main</strong>ï¼šæ”¶åˆ°å›ä¿¡ã€‚<strong>æ¡æ‰‹å®Œæˆï¼</strong></p>
</li>
</ol>
<p>ç°åœ¨ï¼ŒåŒæ–¹éƒ½æŒæœ‰å¯¹æ–¹çš„â€œç”µè¯å·ç â€ï¼Œå¯ä»¥éšæ—¶äº’å‘æ¶ˆæ¯äº†ã€‚</p>
<h3 data-id="heading-28">3.4 Dartä¸­çš„çº¿ç¨‹æ± ï¼šWorkManager</h3>
<p>æœ€åï¼Œæˆ‘ä»¬å¿…é¡»å»ºç«‹<strong>æˆæœ¬æ„è¯†</strong>ã€‚</p>
<p>è™½ç„¶ç°ä»£ Isolate å¯åŠ¨ç»è¿‡äº†ä¼˜åŒ–ï¼ˆIsolate Groupsï¼‰ï¼Œä½†åˆ›å»ºä¸€ä¸ª Isolate ä¾ç„¶éœ€è¦æ¶ˆè€— <strong>2MB+ çš„å†…å­˜</strong> å’Œ <strong>çº¦ 10ms çš„å¯åŠ¨æ—¶é—´</strong>ã€‚</p>
<p><strong>ç¾éš¾åœºæ™¯</strong>ï¼š</p>
<p>åœ¨ <code>ListView</code> çš„ <code>build</code> æ–¹æ³•é‡Œï¼Œå¯¹æ¯ä¸€å¼ å›¾ç‰‡éƒ½è°ƒç”¨ä¸€æ¬¡ <code>Isolate.run</code>ã€‚</p>
<ul>
<li><strong>åæœ</strong>ï¼šç¬é—´åˆ›å»ºä¸Šç™¾ä¸ª Isolateï¼ŒCPU è°ƒåº¦å´©æºƒï¼Œå†…å­˜æº¢å‡ºï¼ˆOOMï¼‰ï¼Œæ‰‹æœºå‘çƒ«å¡æ­»ã€‚</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆï¼šçº¿ç¨‹æ±  (Worker Pool)</strong></p>
<p>å¯¹äºé«˜é¢‘çš„å°ä»»åŠ¡ï¼Œåº”è¯¥ä½¿ç”¨ <strong>çº¿ç¨‹æ± æ¨¡å¼</strong>ï¼ˆå¦‚ç¤¾åŒºåº“ <code>worker_manager</code>ï¼‰ã€‚</p>
<ul>
<li>
<p><strong>åŸç†</strong>ï¼šApp å¯åŠ¨æ—¶é¢„å…ˆåˆ›å»º 3-4 ä¸ªå¸¸é©» Isolateã€‚</p>
</li>
<li>
<p><strong>è°ƒåº¦</strong>ï¼šä»»åŠ¡æ¥äº†ï¼Œæ‰”ç»™ç©ºé—²çš„ Isolateï¼›ä»»åŠ¡æ»¡äº†ï¼Œæ’é˜Ÿç­‰å¾…ã€‚</p>
</li>
<li>
<p><strong>æ”¶ç›Š</strong>ï¼šæ¶ˆé™¤äº†åå¤å¯åŠ¨çš„å¼€é”€ï¼Œä¸”é™åˆ¶äº†æœ€å¤§å¹¶å‘æ•°ï¼Œä¿æŠ¤äº† CPUã€‚</p>
</li>
</ul>
<hr/>
<h4 data-id="heading-29">æœ¬ç« æ€»ç»“ï¼šæˆ˜æœ¯å†³ç­–çŸ©é˜µ</h4>
<p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œè¯·ä¾ç…§ä¸‹è¡¨é€‰æ‹©ä½ çš„æ­¦å™¨ï¼š</p>





























<table><thead><tr><th><strong>ä»»åŠ¡ç±»å‹</strong></th><th><strong>å…¸å‹åœºæ™¯</strong></th><th><strong>æ¨èæ­¦å™¨</strong></th><th><strong>æ ¸å¿ƒç†ç”±</strong></th></tr></thead><tbody><tr><td><strong>å•æ¬¡ã€é‡è®¡ç®—</strong></td><td>è§£æå¤§ JSONã€å›¾ç‰‡å‹ç¼©</td><td><code>Isolate.run</code></td><td>ä»£ç ç®€æ´ï¼Œ<strong>Zero-Copy</strong> è¿”å›å¿«ï¼Œæ— å†…å­˜æ³„æ¼é£é™©ã€‚</td></tr><tr><td><strong>æŒç»­é€šä¿¡ã€çŠ¶æ€ä¿æŒ</strong></td><td>ä¸‹è½½è¿›åº¦ã€Socket æœåŠ¡</td><td><code>Isolate.spawn</code></td><td>å”¯ä¸€æ”¯æŒé•¿ç”Ÿå‘½å‘¨æœŸå’Œ<strong>åŒå‘é€šä¿¡</strong>çš„æ–¹æ¡ˆã€‚</td></tr><tr><td><strong>é«˜é¢‘ã€æµ·é‡å°ä»»åŠ¡</strong></td><td>åˆ—è¡¨å›¾ç‰‡æ»¤é•œã€æœç´¢è¡¥å…¨</td><td><strong>Worker Pool</strong></td><td><strong>å¤ç”¨çº¿ç¨‹</strong>ï¼Œé¿å… OOMï¼Œé¿å… CPU è°ƒåº¦è¿‡è½½ã€‚</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-30">ç¬¬å››ç« ï¼šè§£å‰– â€”â€” Isolate å†…éƒ¨æµè½¬æœºåˆ¶</h3>
<p>åœ¨æŒæ¡äº† Isolate çš„å„ç§â€œå…µå™¨â€åï¼Œæˆ‘ä»¬éœ€è¦èµ°è¿›å…µå·¥å‚ï¼Œæ‹†è§£å®ƒçš„å†…éƒ¨æœºæ¢°ç»“æ„ã€‚</p>
<p>Isolate ä¹‹æ‰€ä»¥èƒ½åšåˆ°â€œå†…å­˜ç»å¯¹éš”ç¦»â€ï¼Œå¹¶ä¸æ˜¯é é­”æ³•ï¼Œè€Œæ˜¯ä¾é ä¸€å¥—ä¸¥å¯†çš„è¿è¡Œæ—¶æ¶æ„ã€‚ç†è§£äº†è¿™å±‚æœºåˆ¶ï¼Œä½ å°±èƒ½æ˜ç™½ä¸ºä»€ä¹ˆ Isolate å¯åŠ¨æœ‰æˆæœ¬ï¼Œä»¥åŠä¸ºä»€ä¹ˆâ€œä¼ å¤§æ–‡ä»¶â€æ›¾ç»æ˜¯æ€§èƒ½æ€æ‰‹ã€‚</p>
<h3 data-id="heading-31">4.1 è§£å‰–å®¤ï¼šIsolate ä¸æ˜¯â€œç©ºæ¶å­â€</h3>
<p>Isolate ç»ä¸ä»…ä»…æ˜¯ä¸€ä¸ªç®€å•çš„çº¿ç¨‹å¥æŸ„ï¼Œå®ƒåœ¨ VM å†…éƒ¨æ˜¯ä¸€ä¸ª<strong>é‡å‹çš„è¿è¡Œæ—¶å®ä½“</strong>ã€‚å¦‚æœæˆ‘ä»¬æŠŠå®ƒæ‹†è§£å¼€ï¼Œä¼šå‘ç°å®ƒåŒ…å«äº†ä¸€æ•´å¥—ç‹¬ç«‹çš„â€œå¾®å‹æ“ä½œç³»ç»Ÿç»„ä»¶â€ï¼š</p>
<p>1.<strong>Mutator Threadï¼ˆæ‰§è¡Œçº¿ç¨‹ï¼‰</strong> ï¼š
è¿™æ˜¯çœŸæ­£æ‰§è¡Œ Dart ä»£ç çš„ä¸»çº¿ç¨‹ã€‚æˆ‘ä»¬å¸¸è¯´çš„â€œMain Isolate å¿™ä¸è¿‡æ¥äº†â€ï¼ŒæŒ‡çš„å°±æ˜¯è¿™ä¸ª Mutator Thread çš„ CPU è·‘æ»¡äº†ã€‚</p>
<ol start="2">
<li><strong>Heapï¼ˆç§æœ‰å †å†…å­˜ï¼‰</strong> ï¼š
è¿™æ˜¯ Isolate çš„ç§äººé¢†åœ°ã€‚å®ƒç®¡ç†ç€æ‰€æœ‰çš„å¯¹è±¡åˆ†é…ã€‚</li>
</ol>
<ul>
<li><strong>å…³é”®ç‰¹æ€§</strong>ï¼š Isolate A çš„ GCï¼ˆåƒåœ¾å›æ”¶ï¼‰åªæ‰«æ A çš„å †ã€‚è¿™æ„å‘³ç€åå° Isolate å³ä½¿æ­£åœ¨è¿›è¡Œæƒ¨çƒˆçš„ Full GCï¼Œä¹Ÿä¸ä¼šå¯¼è‡´ Main Isolate çš„ UI æ‰å¸§ã€‚</li>
</ul>
<ol start="3">
<li>
<p><strong>Message Handlerï¼ˆæ¶ˆæ¯ä¼ è¾¾å®¤ï¼‰</strong> ï¼š
å®ƒä¸“é—¨è´Ÿè´£å¤„ç†åº•å±‚çš„ Port æ¶ˆæ¯ã€‚å®ƒä¼šç›‘å¬åº•å±‚çš„ç³»ç»Ÿæ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¸€æ—¦æœ‰æ•°æ®åŒ…åˆ°è¾¾ï¼Œå®ƒä¼šå°†æ•°æ®ååºåˆ—åŒ–ï¼Œå¹¶æŠ›ç»™ Event Loop å¤„ç†ã€‚</p>
</li>
<li>
<p><strong>Control Portï¼ˆæ§åˆ¶ä¸­å¿ƒï¼‰</strong> ï¼š
è¿™æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç«¯å£ï¼Œæ‹¥æœ‰å®ƒçš„ <code>Capability</code>ï¼ˆæƒé™ï¼‰æ‰èƒ½æ§åˆ¶ Isolate çš„ç”Ÿå‘½å‘¨æœŸï¼ˆå¦‚ Pause, Resume, Killï¼‰ã€‚</p>
</li>
</ol>
<h3 data-id="heading-32">4.2 æ…¢åŠ¨ä½œï¼šä¸€æ¬¡â€œæ ‡å‡†é€šä¿¡â€çš„ç”Ÿæ­»æ—…ç¨‹</h3>
<p>å½“æˆ‘ä»¬è°ƒç”¨ <code>SendPort.send(data)</code> æ—¶ï¼Œæ•°æ®ä» Isolate A åˆ°è¾¾ Isolate Bï¼Œè¿™ä¸­é—´çš„ 0.1 æ¯«ç§’é‡Œåˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</p>
<p>è¿™æ˜¯ä¸€æ¬¡æ ‡å‡†çš„ <strong>Deep Copyï¼ˆæ·±æ‹·è´ï¼‰</strong> è¿‡ç¨‹ï¼Œå®ƒæå…¶æ˜‚è´µï¼Œåˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š</p>
<h4 data-id="heading-33">ç¬¬ä¸€é˜¶æ®µï¼šå°ç®±ï¼ˆSerializationï¼‰</h4>
<p>åœ¨å‘é€ç«¯ï¼ˆIsolate Aï¼‰ï¼ŒVM ä¼šæš‚åœæ‰‹å¤´å·¥ä½œï¼Œå¼€å§‹æ‰«æä½ è¦å‘é€çš„å¯¹è±¡ï¼ˆæ¯”å¦‚ä¸€ä¸ªå¤æ‚çš„ <code>Map</code>ï¼‰ã€‚</p>
<ul>
<li>
<p>VM ä¼šæŠŠè¿™ä¸ªå¯¹è±¡è½¬æ¢æˆä¸€ç§ä¸­é—´æ ¼å¼ï¼ˆMessage Snapshotï¼‰ã€‚</p>
</li>
<li>
<p><strong>ä»£ä»·</strong>ï¼šCPU å¯†é›†å‹æ“ä½œã€‚å¦‚æœå¯¹è±¡å¾ˆå¤§ï¼ˆå¦‚ 10MB çš„ JSONï¼‰ï¼Œè¿™ä¸€æ­¥å°±ä¼šæ¶ˆè€—å¯è§‚çš„æ—¶é—´ã€‚</p>
</li>
</ul>
<h4 data-id="heading-34">ç¬¬äºŒé˜¶æ®µï¼šæŠ•é€’ï¼ˆTransmissionï¼‰</h4>
<p>VM å°†åºåˆ—åŒ–åçš„äºŒè¿›åˆ¶æ•°æ®åŒ…ï¼Œé€šè¿‡ C++ å±‚é¢çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼ŒæŠ•é€’ç»™ç›®æ ‡ Isolate Bã€‚</p>
<h4 data-id="heading-35">ç¬¬ä¸‰é˜¶æ®µï¼šå¼€ç®±ï¼ˆDeserialization &amp; Allocationï¼‰</h4>
<p>è¿™æ˜¯æœ€è€—æ—¶çš„æ­¥éª¤ã€‚</p>
<ul>
<li>
<p><strong>åˆ†é… (Allocate)</strong> ï¼šIsolate B çš„ Message Handler æ”¶åˆ°æ•°æ®åŒ…åï¼Œå¿…é¡»åœ¨ B çš„ <strong>å †å†…å­˜ï¼ˆHeapï¼‰</strong> ä¸­ç”³è¯·ä¸€å—æ–°çš„ã€åŒæ ·å¤§å°çš„å†…å­˜ç©ºé—´ã€‚</p>
</li>
<li>
<p><strong>å¤åˆ¶ (Copy)</strong> ï¼šå°†äºŒè¿›åˆ¶æ•°æ®â€œè¿˜åŸâ€æˆ Dart å¯¹è±¡ï¼Œå¡«å…¥æ–°ç”³è¯·çš„å†…å­˜ä¸­ã€‚</p>
</li>
</ul>
<p><strong>ç»“è®º</strong>ï¼šè¿™å°±æ˜¯ä¸ºä»€ä¹ˆè€ç‰ˆæœ¬çš„ <code>compute</code> åœ¨è¿”å›å¤§æ•°æ®æ—¶ä¼šå¡é¡¿ã€‚å› ä¸º Isolate Bï¼ˆä¸»çº¿ç¨‹ï¼‰å¿…é¡»äº²è‡ªå‚ä¸â€œåˆ†é…å†…å­˜â€å’Œâ€œè¿˜åŸæ•°æ®â€çš„è¿‡ç¨‹ï¼Œè¿™ç›´æ¥å ç”¨äº† UI æ¸²æŸ“çš„æ—¶é—´ã€‚</p>
<h3 data-id="heading-36">4.3 é™ç»´æ‰“å‡»ï¼šå†…å­˜é¡µè¿‡æˆ· (Heap Merging)</h3>
<p>ç†è§£äº†â€œæ·±æ‹·è´â€çš„ç—›ï¼Œä½ å°±èƒ½æ·±åˆ»ä½“ä¼š <code>Isolate.exit</code> <strong>(ç”¨äº Isolate.run)</strong> çš„â€œè¿‡æˆ·æœºåˆ¶â€æœ‰å¤šä¹ˆç²¾å¦™ã€‚</p>
<p>å½“å­çº¿ç¨‹è°ƒç”¨ <code>Isolate.exit</code> è¿”å›ç»“æœæ—¶ï¼ŒVM å¹¶æ²¡æœ‰æ‰§è¡Œä¸Šè¿°çš„â€œå°ç®±-æŠ•é€’-å¼€ç®±â€æµç¨‹ï¼Œè€Œæ˜¯ç©äº†ä¸€æ‰‹**â€œå·å¤©æ¢æ—¥â€**ï¼š</p>
<ol>
<li><strong>å‰¥ç¦» (Detach)</strong> ï¼š</li>
</ol>
<pre><code class="hljs language-markdown" lang="markdown">VM é”å®šå­çº¿ç¨‹ä¸­å­˜æ”¾ç»“æœæ•°æ®çš„ <span class="hljs-strong">**å†…å­˜é¡µ (Memory Pages)**</span> ã€‚å®ƒåœ¨å­çº¿ç¨‹çš„é¡µè¡¨ä¸­å°†è¿™äº›é¡µâ€œæ³¨é”€â€ã€‚æ­¤æ—¶ï¼Œå­çº¿ç¨‹å¤±å»äº†å¯¹è¿™å—å†…å­˜çš„è®¿é—®æƒã€‚
</code></pre>
<ol>
<li>
<p><strong>è¿‡æˆ· (Remap / Merge)</strong> ï¼š</p>
<p>VM ç›´æ¥ä¿®æ”¹ <strong>ä¸»çº¿ç¨‹</strong> çš„é¡µè¡¨ï¼Œå°†åˆšæ‰é‚£å‡ é¡µå†…å­˜çš„æŒ‡é’ˆï¼Œ<strong>æŒ‚è½½</strong> åˆ°ä¸»çº¿ç¨‹çš„åä¸‹ã€‚</p>
</li>
<li>
<p><strong>æ¥æ”¶ (Attach)</strong> ï¼š</p>
<p>ä¸»çº¿ç¨‹ä¸éœ€è¦ç”³è¯·æ–°å†…å­˜ï¼Œä¹Ÿä¸éœ€è¦å¤åˆ¶æ•°æ®ã€‚å®ƒåªæ˜¯è¢«é€šçŸ¥ï¼šâ€œå˜¿ï¼Œå†…å­˜åœ°å€ 0x1000 åˆ° 0x2000 ç°åœ¨å½’ä½ äº†ã€‚â€</p>
</li>
</ol>
<p><strong>æ€§èƒ½å¯¹æ¯”</strong>ï¼š</p>
<ul>
<li>
<p><strong>æ ‡å‡† Send</strong>ï¼šæ¬è¿å·¥æ¨¡å¼ã€‚è€—æ—¶ä¸æ•°æ®é‡æˆæ­£æ¯” <strong>O(N)</strong> ã€‚</p>
</li>
<li>
<p><strong>Exit è¿‡æˆ·</strong>ï¼šæˆ¿äº§è¯æ›´åæ¨¡å¼ã€‚è€—æ—¶æ˜¯å¸¸æ•°çº§ <strong>O(1)</strong> ï¼Œå‡ ä¹ç¬é—´å®Œæˆã€‚</p>
</li>
</ul>
<h4 data-id="heading-37">ä¸ºä»€ä¹ˆæœ‰é™åˆ¶ï¼Ÿ</h4>
<p>ä½ å¯èƒ½ä¼šé—®ï¼šâ€œæ—¢ç„¶è¿‡æˆ·è¿™ä¹ˆçˆ½ï¼Œä¸ºä»€ä¹ˆä¸é»˜è®¤å…¨ç”¨è¿‡æˆ·ï¼Ÿâ€</p>
<p>å› ä¸º <strong>â€œè—•æ–­ä¸è¿â€</strong> ã€‚</p>
<p>å¦‚æœè¢«è¿‡æˆ·çš„å¯¹è±¡é‡Œï¼Œå¼•ç”¨äº†ä¸€ä¸ª <strong>Socket å¥æŸ„</strong> æˆ– <strong>UI æ§ä»¶</strong>ï¼Œè¿™äº›èµ„æºä¸ä»…æ˜¯å†…å­˜æ•°æ®ï¼Œè¿˜ç»‘å®šäº†ç‰¹å®šçš„ç³»ç»Ÿçº¿ç¨‹æˆ– OS èµ„æºï¼Œæ— æ³•ç®€å•åœ°é€šè¿‡â€œæ”¹å†…å­˜å½’å±â€æ¥è½¬ç§»ã€‚å› æ­¤ï¼ŒDart å¼ºåˆ¶è¦æ±‚ä¼ é€’çš„å¯¹è±¡å¿…é¡»æ˜¯â€œå¯ä¼ è¾“çš„â€ã€‚</p>
<h6 data-id="heading-38">é€šè¿‡è¿™ä¸€ç« çš„è§£å‰–ï¼Œæˆ‘ä»¬çœ‹æ¸…äº† Isolate çš„åº•å±‚çœŸç›¸ï¼š<strong>å®ƒç”¨â€œå†…å­˜çš„ç‰©ç†éš”ç¦»â€æ¢å–äº†â€œæ— é”çš„å®‰å…¨â€ï¼Œåˆé€šè¿‡â€œå†…å­˜é¡µçš„åŠ¨æ€è¿‡æˆ·â€çªç ´äº†â€œé€šä¿¡çš„æ€§èƒ½ç“¶é¢ˆâ€ã€‚</strong></h6>
<hr/>
<h3 data-id="heading-39">ç¬¬äº”ç« ï¼šæ€»ç»“ â€”â€” Isolate çš„å“²å­¦ä¸é“å¾‹</h3>
<p>Dart é€‰æ‹© Isolate æ¨¡å‹ï¼Œæœ¬è´¨ä¸Šæ˜¯åœ¨åšä¸€é“æå…¶å†·é™çš„è®¡ç®—é¢˜ï¼š<strong>ç”¨â€œå†…å­˜å¼€é”€â€æ¢å–â€œå¼€å‘å®‰å…¨â€</strong> ã€‚</p>
<p>ä½œä¸ºå¼€å‘è€…ï¼Œå½“æˆ‘ä»¬åˆä¸Š Isolate çš„åº•å±‚å›¾çº¸ï¼Œå›åˆ° IDE å‰å‡†å¤‡æ•²ä¸‹ç¬¬ä¸€è¡Œå¹¶å‘ä»£ç æ—¶ï¼Œè¯·åŠ¡å¿…å°†ä»¥ä¸‹å“²å­¦ä¸é“å¾‹é“­è®°äºå¿ƒã€‚</p>
<h3 data-id="heading-40">5.1 å“²å­¦ï¼šå®‰å…¨çš„ä»£ä»·</h3>
<p>å¾ˆå¤šä» Javaã€C++ æˆ– Go è½¬æ¥çš„å¼€å‘è€…ï¼Œåˆæ¬¡æ¥è§¦ Isolate æ—¶éƒ½ä¼šæ„Ÿåˆ°â€œä¸è‡ªç”±â€ï¼šä¸èƒ½å…±äº«å…¨å±€å˜é‡ï¼Œä¸èƒ½ç›´æ¥è®¿é—®å¯¹è±¡ï¼Œé€šä¿¡å¿…é¡»åºåˆ—åŒ–ã€‚</p>
<p>ä½†è¿™æ­£æ˜¯ Dart çš„æ™ºæ…§æ‰€åœ¨ã€‚å¯¹äºä¸€ä¸ª <strong>UI æ¡†æ¶ (Flutter)</strong> è€Œè¨€ï¼Œ <strong>â€œä¸å¡é¡¿â€</strong> å’Œ <strong>â€œä¸å´©æºƒâ€</strong> æ˜¯æœ€é«˜æŒ‡ä»¤ã€‚</p>
<ul>
<li>
<p><strong>ä¼ ç»Ÿå¤šçº¿ç¨‹</strong>ï¼šä¸ºäº†æ€§èƒ½å…±äº«å†…å­˜ï¼Œä½†ä»£ä»·æ˜¯æ— ä¼‘æ­¢çš„ <strong>é” (Lock)</strong> ã€<strong>ç«æ€æ¡ä»¶ (Race Condition)</strong> å’Œ <strong>æ­»é” (Deadlock)</strong> ã€‚ä¸€æ—¦å‡ºé—®é¢˜ï¼ŒApp å¯èƒ½ä¼šéšæœºå´©æºƒï¼Œè°ƒè¯•éš¾åº¦æé«˜ã€‚</p>
</li>
<li>
<p><strong>Dart Isolate</strong>ï¼šé€šè¿‡ç‰©ç†éš”ç¦»ï¼Œå¼ºåˆ¶æ¶ˆç­äº†â€œå¤šçº¿ç¨‹ç«äº‰â€ã€‚ä½ æ°¸è¿œä¸éœ€è¦å†™ <code>synchronized</code>ï¼Œæ°¸è¿œä¸ç”¨æ‹…å¿ƒåå°çº¿ç¨‹ä¼šæŠŠ UI çº¿ç¨‹çš„æ•°æ®æ”¹ä¹±ã€‚</p>
</li>
</ul>
<p><strong>æ ¸å¿ƒå¿ƒæ³•</strong>ï¼š</p>
<blockquote>
<p><strong>ä¸è¦é€šè¿‡å…±äº«å†…å­˜æ¥é€šä¿¡ï¼Œè€Œè¦é€šè¿‡é€šä¿¡æ¥å…±äº«å†…å­˜ã€‚</strong> (Do not communicate by sharing memory; instead, share memory by communicating.)</p>
</blockquote>
<p>æˆ‘ä»¬ç‰ºç‰²äº†ä¸€ç‚¹å†…å­˜ï¼ˆç”¨äºæ‹·è´æˆ–å¤šå¼€å †ç©ºé—´ï¼‰ï¼Œæ¢æ¥äº†<strong>ç»å¯¹çš„çº¿ç¨‹å®‰å…¨</strong>å’Œ<strong>æå…¶ç®€å•çš„å¹¶å‘å¿ƒæ™ºæ¨¡å‹</strong>ã€‚</p>
<h3 data-id="heading-41">5.2 é“å¾‹ï¼šIsolate å¼€å‘è€…çš„â€œå†›è§„â€</h3>
<p>åœ¨äº«å—å¹¶å‘çº¢åˆ©çš„åŒæ—¶ï¼Œæœ‰ä¸‰æ¡çº¢çº¿ç»å¯¹ä¸èƒ½è§¦ç¢°ã€‚</p>
<h4 data-id="heading-42">ç¬¬ä¸€æ¡ï¼šä¸Šå¸çš„å½’ä¸Šå¸ï¼Œå‡¯æ’’çš„å½’å‡¯æ’’ (UI Segregation)</h4>
<p>è¿™æ˜¯æœ€é‡è¦çš„ä¸€æ¡ã€‚</p>
<ul>
<li>
<p><strong>Main Isolate</strong> æ˜¯ UI çš„å”¯ä¸€ä¸»äººã€‚åªæœ‰å®ƒæŒæœ‰ <code>BuildContext</code>ï¼Œåªæœ‰å®ƒèƒ½è°ƒç”¨ <code>setState</code>ï¼Œåªæœ‰å®ƒèƒ½æ“ä½œ Widgetã€‚</p>
</li>
<li>
<p><strong>åå° Isolate</strong> æ˜¯æ•°æ®çš„è®¡ç®—å·¥å‚ã€‚å®ƒåªè´Ÿè´£è¾“å…¥æ•°æ®ï¼ˆData Inï¼‰å’Œè¾“å‡ºç»“æœï¼ˆData Outï¼‰ã€‚</p>
</li>
<li>
<p><strong>ç¦åŒº</strong>ï¼šåƒä¸‡ä¸è¦è¯•å›¾æŠŠ <code>BuildContext</code>ã€<code>Widget</code> å®ä¾‹æˆ–è€… UI ç›¸å…³çš„å›è°ƒå‡½æ•°ä¼ ç»™åå° Isolateã€‚å®ƒä»¬ä¼ ä¸è¿‡å»ï¼Œå¼ºè¡Œä¼ åªä¼šå¯¼è‡´ Crashã€‚</p>
</li>
</ul>
<h4 data-id="heading-43">ç¬¬äºŒæ¡ï¼šä¸ä¼ â€œæ´»ç‰©â€ (Serializable Only)</h4>
<p>Isolate ä¹‹é—´çš„é€šä¿¡ä¾èµ–äºæ¶ˆæ¯ä¼ é€’ã€‚èƒ½ä¼ é€’çš„å¿…é¡»æ˜¯ <strong>â€œæ­»â€çš„æ•°æ®</strong>ï¼ˆå¯åºåˆ—åŒ–ï¼‰ï¼Œæˆ–è€…æ˜¯ <strong>â€œé€šä¿¡å‡­è¯â€</strong> ï¼ˆSendPortï¼‰ã€‚</p>
<ul>
<li>
<p><strong>å¯ä»¥ä¼ </strong>ï¼š<code>int</code>, <code>String</code>, <code>List</code>, <code>Map</code>, <code>TransferableTypedData</code>ã€‚</p>
</li>
<li>
<p><strong>ç»å¯¹ä¸èƒ½ä¼ </strong>ï¼š</p>
<ul>
<li>
<p><strong>Socket / FileHandle</strong>ï¼šè¿™äº›ç»‘å®šäº†åº•å±‚çš„ç³»ç»Ÿèµ„æºã€‚</p>
</li>
<li>
<p><strong>Closure with Context</strong>ï¼šæºå¸¦äº†å¤æ‚ä¸Šä¸‹æ–‡ï¼ˆå°¤å…¶æ˜¯ <code>this</code>ï¼‰çš„é—­åŒ…ã€‚</p>
</li>
<li>
<p><strong>Future / Stream</strong>ï¼šè¿™äº›æ˜¯åŸºäºäº‹ä»¶å¾ªç¯çš„å¼‚æ­¥å¯¹è±¡ï¼Œæ— æ³•è·¨çº¿ç¨‹ã€‚</p>
</li>
</ul>
</li>
</ul>
<h4 data-id="heading-44">ç¬¬ä¸‰æ¡ï¼šè¯¥æ­»å°±å¾—æ­» (Lifecycle Management)</h4>
<p>èµ„æºæ„è¯†æ˜¯é«˜çº§å·¥ç¨‹å¸ˆçš„ç´ å…»ã€‚</p>
<ul>
<li>
<p><strong>çŸ­ä»»åŠ¡</strong>ï¼šé¦–é€‰ <code>Isolate.run</code>ã€‚å®ƒä¸ä»…å¿«ï¼ˆZero-Copyï¼‰ï¼Œè€Œä¸”è·‘å®Œè‡ªåŠ¨é”€æ¯ï¼Œä¸ç•™åæ‚£ã€‚</p>
</li>
<li>
<p><strong>é•¿ä»»åŠ¡</strong>ï¼šå¦‚æœä½ æ‰‹åŠ¨ <code>spawn</code> äº†ä¸€ä¸ª Isolateï¼Œè¯·åŠ¡å¿…ç¡®ä¿åœ¨ä¸éœ€è¦å®ƒæ—¶è°ƒç”¨ <code>kill() </code>ã€‚</p>
</li>
<li>
<p><strong>åƒµå°¸çº¿ç¨‹</strong>ï¼šä¸€ä¸ªè¢«é—å¿˜çš„ã€æ­»å¾ªç¯çš„åå° Isolateï¼Œä¼šæ‚„æ‚„åƒæ‰ç”¨æˆ·çš„ç”µæ± ï¼Œå¹¶å ç”¨å®è´µçš„å†…å­˜ï¼Œç›´åˆ° App è¢«ç³»ç»Ÿå¼ºæ€ã€‚</p>
</li>
</ul>
<h3 data-id="heading-45">5.3 å†³ç­–çš„æ™ºæ…§ï¼šä½•æ—¶æ‹”å‰‘ï¼Ÿ</h3>
<p>æ‰‹ä¸­æ‹¿ç€é”¤å­ï¼Œä¸è¦çœ‹ä»€ä¹ˆéƒ½åƒé’‰å­ã€‚Isolate è™½ç„¶å¼ºå¤§ï¼Œä½†ä¸æ˜¯é“¶å¼¹ã€‚</p>
<p><strong>ä¸è¦æ»¥ç”¨å¹¶å‘</strong>ï¼š</p>
<ul>
<li>
<p><strong>åœºæ™¯</strong>ï¼šè®¡ç®— <code>1 + 1</code>ï¼Œæˆ–è€…å¯¹ 50 ä¸ªå…ƒç´ çš„æ•°ç»„æ’åºã€‚</p>
</li>
<li>
<p><strong>å†³ç­–</strong>ï¼šç›´æ¥åœ¨ Main Isolate åšï¼</p>
</li>
<li>
<p><strong>ç†ç”±</strong>ï¼šå¯åŠ¨ Isolate éœ€è¦æ—¶é—´ï¼ˆçº¦ 10msï¼‰å’Œå†…å­˜ï¼ˆçº¦ 2MBï¼‰ã€‚å¯¹äºå¾®å°ä»»åŠ¡ï¼Œ <strong>â€œå¯åŠ¨çº¿ç¨‹çš„æ—¶é—´â€å¯èƒ½æ¯”â€œåšä»»åŠ¡çš„æ—¶é—´â€è¿˜é•¿</strong>ï¼Œå¾—ä¸å¿å¤±ã€‚</p>
</li>
</ul>
<p><strong>ä½•æ—¶ä½¿ç”¨ Isolateï¼Ÿ</strong> è¯·éµå¾ª <strong>â€œ16ms æ³•åˆ™â€</strong> ï¼š å¦‚æœä¸€ä¸ªä»»åŠ¡çš„é¢„ä¼°è€—æ—¶è¶…è¿‡ <strong>16ms</strong>ï¼ˆå¯¼è‡´æ‰å¸§çš„é˜ˆå€¼ï¼‰ï¼Œæˆ–è€…æ¶‰åŠå¤§é‡çš„ JSON è§£æã€å›¾åƒå¤„ç†ã€å¤æ‚ç®—æ³•ï¼Œè¯·æ¯«ä¸çŠ¹è±«åœ°æŠŠå®ƒæ‰”ç»™ <code>Isolate.run</code> æˆ– <strong>Worker Manager</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-46">ç»“è¯­</h3>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†ä» Dart å•çº¿ç¨‹æ¨¡å‹çš„åŸç†ï¼Œåˆ° Isolate å†…å­˜æœºåˆ¶çš„è§£å‰–ï¼Œå†åˆ°å®æˆ˜å…µå™¨çš„æ¼”è¿›çš„å…¨æ™¯æ‰«æã€‚</p>
<p>ç°åœ¨çš„ä½ ï¼Œå†çœ‹åˆ° <code>Future</code>ï¼Œä¼šæ˜ç™½é‚£åªæ˜¯ä¸»çº¿ç¨‹çš„æ—¶é—´ç®¡ç†å¤§å¸ˆï¼›çœ‹åˆ° <code>Isolate</code>ï¼Œä¼šæ˜ç™½é‚£æ˜¯å¹¶è¡Œçš„è®¡ç®—åˆ†èº«ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Spring Boot ä¸­åŸºäº YOLOv26 çš„ç›®æ ‡æ£€æµ‹å®ç°]]></title>    <link>https://juejin.cn/post/7599927813601345576</link>    <guid>https://juejin.cn/post/7599927813601345576</guid>    <pubDate>2026-01-28T02:51:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599927813601345576" data-draft-id="7599964577899675648" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Spring Boot ä¸­åŸºäº YOLOv26 çš„ç›®æ ‡æ£€æµ‹å®ç°"/> <meta itemprop="keywords" content="åç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-28T02:51:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜å¨å“¥"/> <meta itemprop="url" content="https://juejin.cn/user/3411107130652176"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Spring Boot ä¸­åŸºäº YOLOv26 çš„ç›®æ ‡æ£€æµ‹å®ç°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3411107130652176/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜å¨å“¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:51:28.000Z" title="Wed Jan 28 2026 02:51:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½ æƒ³è¦åŸºäºSpringBootæ¡†æ¶æ•´åˆYOLOv26å®ç°ç›®æ ‡æ£€æµ‹åŠŸèƒ½ï¼Œæ ¸å¿ƒæ˜¯å°è£…å‡ºé€šç”¨çš„æ£€æµ‹æ¥å£ï¼Œè¯¥æ¥å£èƒ½åŒæ—¶æ”¯æŒå›¾ç‰‡æ–‡ä»¶ä¸Šä¼ å’ŒBase64ç¼–ç å­—ç¬¦ä¸²ä½œä¸ºå…¥å‚ï¼Œå®ç°æ ‡å‡†åŒ–ã€å¯å¤ç”¨çš„ç›®æ ‡æ£€æµ‹èƒ½åŠ›ã€‚</p>
<p>æœ¬æ–‡å°†ä»<strong>ç¯å¢ƒå‡†å¤‡â†’é¡¹ç›®æ­å»ºâ†’æ ¸å¿ƒå°è£…â†’æ¥å£å®ç°â†’æµ‹è¯•éªŒè¯</strong>å…¨æµç¨‹è½åœ°ï¼Œæ‰€æœ‰ä»£ç å‡ä¸ºå·¥ä¸šçº§å¯è¿è¡Œç‰ˆæœ¬ï¼Œå…¼é¡¾æ˜“ç”¨æ€§ä¸æ€§èƒ½ä¼˜åŒ–ï¼Œé€‚é…å®é™…é¡¹ç›®ä¸­å›¾ç‰‡/Base64åŒå…¥å‚çš„å¸¸è§åœºæ™¯ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€å®æˆ˜å‡†å¤‡ï¼šç¯å¢ƒä¸ä¾èµ–é…ç½®</h2>
<h3 data-id="heading-1">1.1 æ ¸å¿ƒç¯å¢ƒè¦æ±‚</h3>
<ul>
<li>
<p>JDKï¼š1.8+/17ï¼ˆæ¨è17ï¼ŒSpringBoot 3.xé€‚é…ï¼‰</p>
</li>
<li>
<p>SpringBootï¼š3.2.xï¼ˆç¨³å®šç‰ˆï¼‰</p>
</li>
<li>
<p>æ¨ç†å¼•æ“ï¼šONNX Runtimeï¼ˆJavaç‰ˆï¼Œé¿å…è·¨è¯­è¨€è°ƒç”¨Pythonï¼Œæ€§èƒ½æ›´ä¼˜ï¼‰</p>
</li>
<li>
<p>YOLOv26ï¼šå¯¼å‡ºä¸ºONNXæ ¼å¼çš„æ¨¡å‹ï¼ˆå«æƒé‡æ–‡ä»¶ï¼Œéœ€æå‰è®­ç»ƒ/ä¸‹è½½é¢„è®­ç»ƒæƒé‡ï¼‰</p>
</li>
<li>
<p>è¾…åŠ©ä¾èµ–ï¼šå›¾ç‰‡å¤„ç†ï¼ˆThumbnailsï¼‰ã€JSONåºåˆ—åŒ–ï¼ˆFastJSON2ï¼‰</p>
</li>
</ul>
<h3 data-id="heading-2">1.2 ä¾èµ–å¼•å…¥ï¼ˆpom.xmlï¼‰</h3>
<pre><code class="hljs language-XML" lang="XML">
<span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span>
         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.2.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.ai.detection<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>yolov26-springboot<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- SpringBootæ ¸å¿ƒ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-validation<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- ONNX Runtimeï¼ˆJavaæ¨ç†æ ¸å¿ƒï¼‰ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.microsoft.onnxruntime<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>onnxruntime<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.16.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- é€‚é…ä¸åŒç³»ç»Ÿï¼ŒæŒ‰éœ€é€‰æ‹©ï¼Œé»˜è®¤Windows x64 --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">classifier</span>&gt;</span>win-x64<span class="hljs-tag">&lt;/<span class="hljs-name">classifier</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- Linux x64æ›¿æ¢ä¸ºï¼š&lt;classifier&gt;linux-x64&lt;/classifier&gt; --&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- å›¾ç‰‡å¤„ç† --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>net.coobird<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>thumbnailator<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.4.19<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>javax.imageio<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jai-imageio<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- Base64ä¸JSON --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.fastjson2<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>fastjson2<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.48<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- æ—¥å¿— --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>slf4j-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>ch.qos.logback<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>logback-classic<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- æµ‹è¯• --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.2.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span>
</code></pre>
<h3 data-id="heading-3">1.3 YOLOv26æ¨¡å‹å‡†å¤‡</h3>
<ol>
<li>
<p>ä¸‹è½½YOLOv26é¢„è®­ç»ƒæƒé‡ï¼ˆå¦‚<code>yolov26n.pt</code>ï¼‰ï¼Œé€šè¿‡Ultralyticsåº“å¯¼å‡ºä¸ºONNXæ ¼å¼ï¼š</p>
<pre><code class="hljs language-Python" lang="Python">
<span class="hljs-keyword">from</span> ultralytics <span class="hljs-keyword">import</span> YOLO

<span class="hljs-comment"># åŠ è½½æ¨¡å‹</span>
model = YOLO(<span class="hljs-string">"yolov26n.pt"</span>)
<span class="hljs-comment"># å¯¼å‡ºONNXæ¨¡å‹ï¼ˆæŒ‡å®šè¾“å…¥å°ºå¯¸640x640ï¼Œé€‚é…å¤šæ•°åœºæ™¯ï¼‰</span>
model.export(<span class="hljs-built_in">format</span>=<span class="hljs-string">"onnx"</span>, imgsz=<span class="hljs-number">640</span>, opset=<span class="hljs-number">12</span>)
</code></pre>
</li>
<li>
<p>å°†å¯¼å‡ºçš„<code>yolov26n.onnx</code>æ–‡ä»¶æ”¾å…¥é¡¹ç›®<code>resources/models</code>ç›®å½•ä¸‹ã€‚</p>
</li>
</ol>
<h2 data-id="heading-4">äºŒã€æ ¸å¿ƒå°è£…ï¼šYOLOv26æ¨ç†å·¥å…·ç±»</h2>
<h3 data-id="heading-5">2.1 å¸¸é‡ä¸è¿”å›å®ä½“å®šä¹‰</h3>
<pre><code class="hljs language-Java" lang="Java">
<span class="hljs-comment">// 1. æ£€æµ‹ç»“æœå®ä½“</span>
<span class="hljs-keyword">package</span> com.ai.detection.entity;

<span class="hljs-keyword">import</span> lombok.Data;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * ç›®æ ‡æ£€æµ‹ç»Ÿä¸€è¿”å›ç»“æœ
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DetectionResult</span> {
    <span class="hljs-comment">/**
     * æ£€æµ‹çŠ¶æ€ï¼šsuccess/fail
     */</span>
    <span class="hljs-keyword">private</span> String status;
    <span class="hljs-comment">/**
     * é”™è¯¯ä¿¡æ¯ï¼ˆå¤±è´¥æ—¶éç©ºï¼‰
     */</span>
    <span class="hljs-keyword">private</span> String errorMsg;
    <span class="hljs-comment">/**
     * æ£€æµ‹åˆ°çš„ç›®æ ‡åˆ—è¡¨
     */</span>
    <span class="hljs-keyword">private</span> List&lt;DetectedObject&gt; objects;
    <span class="hljs-comment">/**
     * æ£€æµ‹è€—æ—¶ï¼ˆæ¯«ç§’ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> costTime;
}

<span class="hljs-comment">/**
 * å•ä¸ªæ£€æµ‹ç›®æ ‡
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DetectedObject</span> {
    <span class="hljs-comment">/**
     * ç›®æ ‡ç±»åˆ«ï¼ˆå¦‚personã€carï¼‰
     */</span>
    <span class="hljs-keyword">private</span> String className;
    <span class="hljs-comment">/**
     * ç±»åˆ«ID
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> classId;
    <span class="hljs-comment">/**
     * ç½®ä¿¡åº¦ï¼ˆ0-1ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> confidence;
    <span class="hljs-comment">/**
     * è¾¹ç•Œæ¡†åæ ‡ï¼šx1,y1ï¼ˆå·¦ä¸Šè§’ï¼‰,x2,y2ï¼ˆå³ä¸‹è§’ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> x1;
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> y1;
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> x2;
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> y2;
}

<span class="hljs-comment">// 2. å¸¸é‡ç±»</span>
<span class="hljs-keyword">package</span> com.ai.detection.constant;

<span class="hljs-comment">/**
 * YOLOv26å¸¸é‡é…ç½®
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">YoloConstants</span> {
    <span class="hljs-comment">/**
     * æ¨¡å‹æ–‡ä»¶è·¯å¾„
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">MODEL_PATH</span> <span class="hljs-operator">=</span> <span class="hljs-string">"models/yolov26n.onnx"</span>;
    <span class="hljs-comment">/**
     * è¾“å…¥å›¾ç‰‡å°ºå¯¸ï¼ˆYOLOv26é»˜è®¤640x640ï¼‰
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">INPUT_WIDTH</span> <span class="hljs-operator">=</span> <span class="hljs-number">640</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">INPUT_HEIGHT</span> <span class="hljs-operator">=</span> <span class="hljs-number">640</span>;
    <span class="hljs-comment">/**
     * ç½®ä¿¡åº¦é˜ˆå€¼ï¼ˆè¿‡æ»¤ä½ç½®ä¿¡åº¦ç»“æœï¼‰
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">float</span> <span class="hljs-variable">CONF_THRESHOLD</span> <span class="hljs-operator">=</span> <span class="hljs-number">0.5f</span>;
    <span class="hljs-comment">/**
     * NMSéæå¤§å€¼æŠ‘åˆ¶é˜ˆå€¼
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">float</span> <span class="hljs-variable">NMS_THRESHOLD</span> <span class="hljs-operator">=</span> <span class="hljs-number">0.45f</span>;
    <span class="hljs-comment">/**
     * COCOæ•°æ®é›†ç±»åˆ«ï¼ˆYOLOv26é¢„è®­ç»ƒé»˜è®¤COCOï¼‰
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String[] COCO_CLASSES = {
            <span class="hljs-string">"person"</span>, <span class="hljs-string">"bicycle"</span>, <span class="hljs-string">"car"</span>, <span class="hljs-string">"motorcycle"</span>, <span class="hljs-string">"airplane"</span>, <span class="hljs-string">"bus"</span>, <span class="hljs-string">"train"</span>, <span class="hljs-string">"truck"</span>, <span class="hljs-string">"boat"</span>,
            <span class="hljs-string">"traffic light"</span>, <span class="hljs-string">"fire hydrant"</span>, <span class="hljs-string">"stop sign"</span>, <span class="hljs-string">"parking meter"</span>, <span class="hljs-string">"bench"</span>, <span class="hljs-string">"bird"</span>, <span class="hljs-string">"cat"</span>,
            <span class="hljs-string">"dog"</span>, <span class="hljs-string">"horse"</span>, <span class="hljs-string">"sheep"</span>, <span class="hljs-string">"cow"</span>, <span class="hljs-string">"elephant"</span>, <span class="hljs-string">"bear"</span>, <span class="hljs-string">"zebra"</span>, <span class="hljs-string">"giraffe"</span>, <span class="hljs-string">"backpack"</span>,
            <span class="hljs-string">"umbrella"</span>, <span class="hljs-string">"handbag"</span>, <span class="hljs-string">"tie"</span>, <span class="hljs-string">"suitcase"</span>, <span class="hljs-string">"frisbee"</span>, <span class="hljs-string">"skis"</span>, <span class="hljs-string">"snowboard"</span>, <span class="hljs-string">"sports ball"</span>,
            <span class="hljs-string">"kite"</span>, <span class="hljs-string">"baseball bat"</span>, <span class="hljs-string">"baseball glove"</span>, <span class="hljs-string">"skateboard"</span>, <span class="hljs-string">"surfboard"</span>, <span class="hljs-string">"tennis racket"</span>,
            <span class="hljs-string">"bottle"</span>, <span class="hljs-string">"wine glass"</span>, <span class="hljs-string">"cup"</span>, <span class="hljs-string">"fork"</span>, <span class="hljs-string">"knife"</span>, <span class="hljs-string">"spoon"</span>, <span class="hljs-string">"bowl"</span>, <span class="hljs-string">"banana"</span>, <span class="hljs-string">"apple"</span>,
            <span class="hljs-string">"sandwich"</span>, <span class="hljs-string">"orange"</span>, <span class="hljs-string">"broccoli"</span>, <span class="hljs-string">"carrot"</span>, <span class="hljs-string">"hot dog"</span>, <span class="hljs-string">"pizza"</span>, <span class="hljs-string">"donut"</span>, <span class="hljs-string">"cake"</span>,
            <span class="hljs-string">"chair"</span>, <span class="hljs-string">"couch"</span>, <span class="hljs-string">"potted plant"</span>, <span class="hljs-string">"bed"</span>, <span class="hljs-string">"dining table"</span>, <span class="hljs-string">"toilet"</span>, <span class="hljs-string">"tv"</span>, <span class="hljs-string">"laptop"</span>,
            <span class="hljs-string">"mouse"</span>, <span class="hljs-string">"remote"</span>, <span class="hljs-string">"keyboard"</span>, <span class="hljs-string">"cell phone"</span>, <span class="hljs-string">"microwave"</span>, <span class="hljs-string">"oven"</span>, <span class="hljs-string">"toaster"</span>, <span class="hljs-string">"sink"</span>,
            <span class="hljs-string">"refrigerator"</span>, <span class="hljs-string">"book"</span>, <span class="hljs-string">"clock"</span>, <span class="hljs-string">"vase"</span>, <span class="hljs-string">"scissors"</span>, <span class="hljs-string">"teddy bear"</span>, <span class="hljs-string">"hair drier"</span>, <span class="hljs-string">"toothbrush"</span>
    };
}
</code></pre>
<h3 data-id="heading-6">2.2 æ ¸å¿ƒæ¨ç†å·¥å…·ç±»ï¼ˆYOLOv26Detectorï¼‰</h3>
<pre><code class="hljs language-Java" lang="Java">
<span class="hljs-keyword">package</span> com.ai.detection.utils;

<span class="hljs-keyword">import</span> com.ai.detection.constant.YoloConstants;
<span class="hljs-keyword">import</span> com.ai.detection.entity.DetectedObject;
<span class="hljs-keyword">import</span> com.microsoft.onnxruntime.*;
<span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;
<span class="hljs-keyword">import</span> net.coobird.thumbnailator.Thumbnails;
<span class="hljs-keyword">import</span> org.springframework.core.io.ClassPathResource;
<span class="hljs-keyword">import</span> org.springframework.util.Base64Utils;

<span class="hljs-keyword">import</span> javax.imageio.ImageIO;
<span class="hljs-keyword">import</span> java.awt.*;
<span class="hljs-keyword">import</span> java.awt.image.BufferedImage;
<span class="hljs-keyword">import</span> java.io.ByteArrayInputStream;
<span class="hljs-keyword">import</span> java.io.File;
<span class="hljs-keyword">import</span> java.io.IOException;
<span class="hljs-keyword">import</span> java.io.InputStream;
<span class="hljs-keyword">import</span> java.nio.FloatBuffer;
<span class="hljs-keyword">import</span> java.util.*;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * YOLOv26æ£€æµ‹å·¥å…·ç±»ï¼ˆå•ä¾‹æ¨¡å¼ï¼Œé¿å…é‡å¤åŠ è½½æ¨¡å‹ï¼‰
 */</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">YoloV26Detector</span> {
    <span class="hljs-comment">// å•ä¾‹å®ä¾‹</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">volatile</span> YoloV26Detector instance;
    <span class="hljs-comment">// ONNX Runtimeæ¨ç†ä¼šè¯</span>
    <span class="hljs-keyword">private</span> OrtSession session;
    <span class="hljs-comment">// ONNXç¯å¢ƒ</span>
    <span class="hljs-keyword">private</span> OrtEnvironment env;

    <span class="hljs-comment">/**
     * ç§æœ‰æ„é€ æ–¹æ³•ï¼ŒåŠ è½½æ¨¡å‹
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title function_">YoloV26Detector</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// åˆå§‹åŒ–ONNXç¯å¢ƒ</span>
            env = OrtEnvironment.getEnvironment();
            <span class="hljs-comment">// åŠ è½½æ¨¡å‹æ–‡ä»¶</span>
            <span class="hljs-type">ClassPathResource</span> <span class="hljs-variable">resource</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassPathResource</span>(YoloConstants.MODEL_PATH);
            <span class="hljs-type">File</span> <span class="hljs-variable">modelFile</span> <span class="hljs-operator">=</span> resource.getFile();
            
            <span class="hljs-comment">// é…ç½®æ¨ç†ä¼šè¯ï¼ˆå¯ç”¨CPUæ¨ç†ï¼Œè‹¥æœ‰GPUå¯é…ç½®CUDAï¼‰</span>
            OrtSession.<span class="hljs-type">SessionOptions</span> <span class="hljs-variable">options</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrtSession</span>.SessionOptions();
            options.setIntraOpNumThreads(Runtime.getRuntime().availableProcessors());
            <span class="hljs-comment">// GPUé…ç½®ï¼ˆéœ€å®‰è£…CUDAç‰ˆONNX Runtimeï¼Œæ³¨é‡Šæ‰CPUé…ç½®åå¯ç”¨ï¼‰</span>
            <span class="hljs-comment">// options.addCUDA(0);</span>
            
            <span class="hljs-comment">// åˆ›å»ºæ¨ç†ä¼šè¯</span>
            session = env.createSession(modelFile.getAbsolutePath(), options);
            log.info(<span class="hljs-string">"YOLOv26æ¨¡å‹åŠ è½½æˆåŠŸï¼Œè·¯å¾„ï¼š{}"</span>, modelFile.getAbsolutePath());
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"YOLOv26æ¨¡å‹åŠ è½½å¤±è´¥"</span>, e);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"æ¨¡å‹åˆå§‹åŒ–å¤±è´¥"</span>, e);
        }
    }

    <span class="hljs-comment">/**
     * è·å–å•ä¾‹å®ä¾‹
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> YoloV26Detector <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">synchronized</span> (YoloV26Detector.class) {
                <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {
                    instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">YoloV26Detector</span>();
                }
            }
        }
        <span class="hljs-keyword">return</span> instance;
    }

    <span class="hljs-comment">/**
     * å›¾ç‰‡æ–‡ä»¶æ£€æµ‹
     */</span>
    <span class="hljs-keyword">public</span> List&lt;DetectedObject&gt; <span class="hljs-title function_">detectImage</span><span class="hljs-params">(File imageFile)</span> <span class="hljs-keyword">throws</span> IOException {
        <span class="hljs-type">BufferedImage</span> <span class="hljs-variable">image</span> <span class="hljs-operator">=</span> ImageIO.read(imageFile);
        <span class="hljs-keyword">return</span> detect(image);
    }

    <span class="hljs-comment">/**
     * Base64å­—ç¬¦ä¸²æ£€æµ‹ï¼ˆéœ€å»é™¤å‰ç¼€å¦‚data:image/jpeg;base64,ï¼‰
     */</span>
    <span class="hljs-keyword">public</span> List&lt;DetectedObject&gt; <span class="hljs-title function_">detectBase64</span><span class="hljs-params">(String base64Str)</span> <span class="hljs-keyword">throws</span> IOException {
        <span class="hljs-comment">// å»é™¤Base64å‰ç¼€</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">pureBase64</span> <span class="hljs-operator">=</span> base64Str.replaceAll(<span class="hljs-string">"^data:image/\\w+;base64,"</span>, <span class="hljs-string">""</span>);
        <span class="hljs-comment">// Base64è½¬å­—èŠ‚æ•°ç»„</span>
        <span class="hljs-type">byte</span>[] imageBytes = Base64Utils.decodeFromString(pureBase64);
        <span class="hljs-comment">// å­—èŠ‚æ•°ç»„è½¬BufferedImage</span>
        <span class="hljs-type">InputStream</span> <span class="hljs-variable">inputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayInputStream</span>(imageBytes);
        <span class="hljs-type">BufferedImage</span> <span class="hljs-variable">image</span> <span class="hljs-operator">=</span> ImageIO.read(inputStream);
        <span class="hljs-keyword">return</span> detect(image);
    }

    <span class="hljs-comment">/**
     * æ ¸å¿ƒæ£€æµ‹é€»è¾‘
     */</span>
    <span class="hljs-keyword">private</span> List&lt;DetectedObject&gt; <span class="hljs-title function_">detect</span><span class="hljs-params">(BufferedImage originalImage)</span> {
        <span class="hljs-type">long</span> <span class="hljs-variable">startTime</span> <span class="hljs-operator">=</span> System.currentTimeMillis();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// 1. å›¾ç‰‡é¢„å¤„ç†ï¼šç¼©æ”¾ã€å½’ä¸€åŒ–ã€ç»´åº¦è½¬æ¢</span>
            <span class="hljs-type">float</span>[] inputTensor = preprocessImage(originalImage);
            
            <span class="hljs-comment">// 2. ONNXæ¨¡å‹æ¨ç†</span>
            <span class="hljs-type">float</span>[][] output = inference(inputTensor);
            
            <span class="hljs-comment">// 3. åå¤„ç†ï¼šè§£æç»“æœã€NMSè¿‡æ»¤</span>
            List&lt;DetectedObject&gt; detectedObjects = postprocess(output, originalImage.getWidth(), originalImage.getHeight());
            
            log.info(<span class="hljs-string">"æ£€æµ‹å®Œæˆï¼Œè€—æ—¶ï¼š{}msï¼Œæ£€æµ‹åˆ°ç›®æ ‡æ•°ï¼š{}"</span>, System.currentTimeMillis() - startTime, detectedObjects.size());
            <span class="hljs-keyword">return</span> detectedObjects;
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"æ£€æµ‹å¤±è´¥"</span>, e);
            <span class="hljs-keyword">return</span> Collections.emptyList();
        }
    }

    <span class="hljs-comment">/**
     * å›¾ç‰‡é¢„å¤„ç†
     * æ­¥éª¤ï¼šç¼©æ”¾è‡³640x640 â†’ å½’ä¸€åŒ–ï¼ˆ0-255â†’0-1ï¼‰ â†’ è½¬CHWæ ¼å¼ï¼ˆé€šé“ä¼˜å…ˆï¼‰ â†’ æ„å»ºè¾“å…¥å¼ é‡
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span>[] preprocessImage(BufferedImage image) {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// 1. ç¼©æ”¾å›¾ç‰‡ï¼ˆä¿æŒæ¯”ä¾‹ï¼Œå¡«å……é»‘è¾¹ï¼‰</span>
            <span class="hljs-type">BufferedImage</span> <span class="hljs-variable">resizedImage</span> <span class="hljs-operator">=</span> resizeWithPadding(image, YoloConstants.INPUT_WIDTH, YoloConstants.INPUT_HEIGHT);
            
            <span class="hljs-comment">// 2. è½¬RGBæ ¼å¼ï¼ˆé¿å…ç°åº¦å›¾/é€æ˜é€šé“é—®é¢˜ï¼‰</span>
            <span class="hljs-type">BufferedImage</span> <span class="hljs-variable">rgbImage</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedImage</span>(resizedImage.getWidth(), resizedImage.getHeight(), BufferedImage.TYPE_3BYTE_BGR);
            <span class="hljs-type">Graphics2D</span> <span class="hljs-variable">g</span> <span class="hljs-operator">=</span> rgbImage.createGraphics();
            g.drawImage(resizedImage, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-literal">null</span>);
            g.dispose();
            
            <span class="hljs-comment">// 3. å½’ä¸€åŒ–+è½¬CHW</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">width</span> <span class="hljs-operator">=</span> rgbImage.getWidth();
            <span class="hljs-type">int</span> <span class="hljs-variable">height</span> <span class="hljs-operator">=</span> rgbImage.getHeight();
            <span class="hljs-type">float</span>[] input = <span class="hljs-keyword">new</span> <span class="hljs-title class_">float</span>[<span class="hljs-number">3</span> * width * height];
            <span class="hljs-type">byte</span>[] pixels = ((java.awt.image.DataBufferByte) rgbImage.getRaster().getDataBuffer()).getData();
            
            <span class="hljs-type">int</span> <span class="hljs-variable">pixelIndex</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; c &lt; <span class="hljs-number">3</span>; c++) {
                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; h &lt; height; h++) {
                    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">w</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; w &lt; width; w++) {
                        <span class="hljs-type">int</span> <span class="hljs-variable">pos</span> <span class="hljs-operator">=</span> h * width * <span class="hljs-number">3</span> + w * <span class="hljs-number">3</span> + c;
                        input[pixelIndex++] = pixels[pos] / <span class="hljs-number">255.0f</span>; <span class="hljs-comment">// å½’ä¸€åŒ–åˆ°0-1</span>
                    }
                }
            }
            <span class="hljs-keyword">return</span> input;
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"å›¾ç‰‡é¢„å¤„ç†å¤±è´¥"</span>, e);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);
        }
    }

    <span class="hljs-comment">/**
     * ç­‰æ¯”ä¾‹ç¼©æ”¾å›¾ç‰‡ï¼Œä¸è¶³éƒ¨åˆ†å¡«å……é»‘è¾¹
     */</span>
    <span class="hljs-keyword">private</span> BufferedImage <span class="hljs-title function_">resizeWithPadding</span><span class="hljs-params">(BufferedImage image, <span class="hljs-type">int</span> targetWidth, <span class="hljs-type">int</span> targetHeight)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// è®¡ç®—ç¼©æ”¾æ¯”ä¾‹</span>
            <span class="hljs-type">double</span> <span class="hljs-variable">scale</span> <span class="hljs-operator">=</span> Math.min((<span class="hljs-type">double</span>) targetWidth / image.getWidth(), (<span class="hljs-type">double</span>) targetHeight / image.getHeight());
            <span class="hljs-type">int</span> <span class="hljs-variable">newWidth</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) (image.getWidth() * scale);
            <span class="hljs-type">int</span> <span class="hljs-variable">newHeight</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) (image.getHeight() * scale);
            
            <span class="hljs-comment">// ç¼©æ”¾å›¾ç‰‡</span>
            <span class="hljs-type">BufferedImage</span> <span class="hljs-variable">scaledImage</span> <span class="hljs-operator">=</span> Thumbnails.of(image).size(newWidth, newHeight).asBufferedImage();
            
            <span class="hljs-comment">// åˆ›å»ºç›®æ ‡å°ºå¯¸å›¾ç‰‡ï¼Œå¡«å……é»‘è¾¹</span>
            <span class="hljs-type">BufferedImage</span> <span class="hljs-variable">paddedImage</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedImage</span>(targetWidth, targetHeight, BufferedImage.TYPE_3BYTE_BGR);
            <span class="hljs-type">Graphics2D</span> <span class="hljs-variable">g</span> <span class="hljs-operator">=</span> paddedImage.createGraphics();
            g.setColor(Color.BLACK);
            g.fillRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, targetWidth, targetHeight);
            <span class="hljs-comment">// å±…ä¸­ç»˜åˆ¶ç¼©æ”¾åçš„å›¾ç‰‡</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> (targetWidth - newWidth) / <span class="hljs-number">2</span>;
            <span class="hljs-type">int</span> <span class="hljs-variable">y</span> <span class="hljs-operator">=</span> (targetHeight - newHeight) / <span class="hljs-number">2</span>;
            g.drawImage(scaledImage, x, y, <span class="hljs-literal">null</span>);
            g.dispose();
            
            <span class="hljs-keyword">return</span> paddedImage;
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"å›¾ç‰‡ç¼©æ”¾å¤±è´¥"</span>, e);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);
        }
    }

    <span class="hljs-comment">/**
     * ONNXæ¨¡å‹æ¨ç†
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span>[][] inference(<span class="hljs-type">float</span>[] inputTensor) <span class="hljs-keyword">throws</span> OrtException {
        <span class="hljs-comment">// æ„å»ºè¾“å…¥å¼ é‡ï¼ˆå½¢çŠ¶ï¼š1,3,640,640ï¼‰</span>
        <span class="hljs-type">long</span>[] inputShape = <span class="hljs-keyword">new</span> <span class="hljs-title class_">long</span>[]{<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, YoloConstants.INPUT_HEIGHT, YoloConstants.INPUT_WIDTH};
        <span class="hljs-type">OrtTensor</span> <span class="hljs-variable">inputOrtTensor</span> <span class="hljs-operator">=</span> OrtTensor.createTensor(env, FloatBuffer.wrap(inputTensor), inputShape);
        
        <span class="hljs-comment">// æ‰§è¡Œæ¨ç†</span>
        Map&lt;String, OrtTensor&gt; inputs = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        inputs.put(<span class="hljs-string">"images"</span>, inputOrtTensor); <span class="hljs-comment">// è¾“å…¥åç§°éœ€ä¸ONNXæ¨¡å‹ä¸€è‡´ï¼ˆé€šå¸¸ä¸ºimagesï¼‰</span>
        OrtSession.<span class="hljs-type">Result</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> session.run(inputs);
        
        <span class="hljs-comment">// è§£æè¾“å‡ºï¼ˆYOLOv26è¾“å‡ºä¸º[1,84,8400]ï¼Œ84=80ç±»+4åæ ‡+ç½®ä¿¡åº¦ï¼‰</span>
        <span class="hljs-type">float</span>[][] output = (<span class="hljs-type">float</span>[][]) result.get(<span class="hljs-number">0</span>).getValue();
        
        <span class="hljs-comment">// é‡Šæ”¾èµ„æº</span>
        inputOrtTensor.close();
        result.close();
        
        <span class="hljs-keyword">return</span> output;
    }

    <span class="hljs-comment">/**
     * åå¤„ç†ï¼šè§£æè¾¹ç•Œæ¡†ã€ç½®ä¿¡åº¦è¿‡æ»¤ã€NMSéæå¤§å€¼æŠ‘åˆ¶ã€åæ ‡è¿˜åŸ
     */</span>
    <span class="hljs-keyword">private</span> List&lt;DetectedObject&gt; <span class="hljs-title function_">postprocess</span><span class="hljs-params">(<span class="hljs-type">float</span>[][] output, <span class="hljs-type">int</span> originalWidth, <span class="hljs-type">int</span> originalHeight)</span> {
        List&lt;DetectedObject&gt; allObjects = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        <span class="hljs-type">float</span>[] outputData = output[<span class="hljs-number">0</span>];
        <span class="hljs-type">int</span> <span class="hljs-variable">numBoxes</span> <span class="hljs-operator">=</span> outputData.length / <span class="hljs-number">84</span>; <span class="hljs-comment">// 8400ä¸ªé¢„æµ‹æ¡†</span>
        
        <span class="hljs-comment">// 1. è§£ææ¯ä¸ªé¢„æµ‹æ¡†</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; numBoxes; i++) {
            <span class="hljs-type">int</span> <span class="hljs-variable">baseIdx</span> <span class="hljs-operator">=</span> i * <span class="hljs-number">84</span>;
            <span class="hljs-comment">// æå–ç½®ä¿¡åº¦ï¼ˆç¬¬4ä¸ªå€¼ï¼‰</span>
            <span class="hljs-type">float</span> <span class="hljs-variable">confidence</span> <span class="hljs-operator">=</span> outputData[baseIdx + <span class="hljs-number">4</span>];
            <span class="hljs-keyword">if</span> (confidence &lt; YoloConstants.CONF_THRESHOLD) {
                <span class="hljs-keyword">continue</span>; <span class="hljs-comment">// è¿‡æ»¤ä½ç½®ä¿¡åº¦</span>
            }
            
            <span class="hljs-comment">// æå–ç±»åˆ«ï¼ˆæœ€å¤§å€¼å¯¹åº”çš„ç´¢å¼•ï¼‰</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">classId</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
            <span class="hljs-type">float</span> <span class="hljs-variable">maxClassScore</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; c &lt; <span class="hljs-number">80</span>; c++) {
                <span class="hljs-type">float</span> <span class="hljs-variable">score</span> <span class="hljs-operator">=</span> outputData[baseIdx + <span class="hljs-number">5</span> + c];
                <span class="hljs-keyword">if</span> (score &gt; maxClassScore) {
                    maxClassScore = score;
                    classId = c;
                }
            }
            <span class="hljs-type">float</span> <span class="hljs-variable">finalConfidence</span> <span class="hljs-operator">=</span> confidence * maxClassScore;
            <span class="hljs-keyword">if</span> (finalConfidence &lt; YoloConstants.CONF_THRESHOLD) {
                <span class="hljs-keyword">continue</span>;
            }
            
            <span class="hljs-comment">// æå–è¾¹ç•Œæ¡†ï¼ˆxywhæ ¼å¼ â†’ xyxyæ ¼å¼ï¼‰</span>
            <span class="hljs-type">float</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> outputData[baseIdx];
            <span class="hljs-type">float</span> <span class="hljs-variable">y</span> <span class="hljs-operator">=</span> outputData[baseIdx + <span class="hljs-number">1</span>];
            <span class="hljs-type">float</span> <span class="hljs-variable">w</span> <span class="hljs-operator">=</span> outputData[baseIdx + <span class="hljs-number">2</span>];
            <span class="hljs-type">float</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> outputData[baseIdx + <span class="hljs-number">3</span>];
            
            <span class="hljs-type">float</span> <span class="hljs-variable">x1</span> <span class="hljs-operator">=</span> x - w / <span class="hljs-number">2</span>;
            <span class="hljs-type">float</span> <span class="hljs-variable">y1</span> <span class="hljs-operator">=</span> y - h / <span class="hljs-number">2</span>;
            <span class="hljs-type">float</span> <span class="hljs-variable">x2</span> <span class="hljs-operator">=</span> x + w / <span class="hljs-number">2</span>;
            <span class="hljs-type">float</span> <span class="hljs-variable">y2</span> <span class="hljs-operator">=</span> y + h / <span class="hljs-number">2</span>;
            
            <span class="hljs-comment">// åæ ‡è¿˜åŸï¼ˆä»640x640è¿˜åŸåˆ°åŸå§‹å›¾ç‰‡å°ºå¯¸ï¼‰</span>
            <span class="hljs-type">float</span> <span class="hljs-variable">scaleX</span> <span class="hljs-operator">=</span> (<span class="hljs-type">float</span>) originalWidth / YoloConstants.INPUT_WIDTH;
            <span class="hljs-type">float</span> <span class="hljs-variable">scaleY</span> <span class="hljs-operator">=</span> (<span class="hljs-type">float</span>) originalHeight / YoloConstants.INPUT_HEIGHT;
            x1 = x1 * scaleX;
            y1 = y1 * scaleY;
            x2 = x2 * scaleX;
            y2 = y2 * scaleY;
            
            <span class="hljs-comment">// å°è£…æ£€æµ‹ç»“æœ</span>
            <span class="hljs-type">DetectedObject</span> <span class="hljs-variable">obj</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DetectedObject</span>();
            obj.setClassId(classId);
            obj.setClassName(YoloConstants.COCO_CLASSES[classId]);
            obj.setConfidence(finalConfidence);
            obj.setX1(x1);
            obj.setY1(y1);
            obj.setX2(x2);
            obj.setY2(y2);
            allObjects.add(obj);
        }
        
        <span class="hljs-comment">// 2. NMSéæå¤§å€¼æŠ‘åˆ¶ï¼ˆå»é™¤é‡å¤æ¡†ï¼‰</span>
        <span class="hljs-keyword">return</span> applyNMS(allObjects);
    }

    <span class="hljs-comment">/**
     * NMSéæå¤§å€¼æŠ‘åˆ¶
     */</span>
    <span class="hljs-keyword">private</span> List&lt;DetectedObject&gt; <span class="hljs-title function_">applyNMS</span><span class="hljs-params">(List&lt;DetectedObject&gt; objects)</span> {
        <span class="hljs-keyword">if</span> (objects.isEmpty()) {
            <span class="hljs-keyword">return</span> Collections.emptyList();
        }
        
        <span class="hljs-comment">// æŒ‰ç±»åˆ«åˆ†ç»„å¤„ç†</span>
        Map&lt;Integer, List&lt;DetectedObject&gt;&gt; classGroups = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        <span class="hljs-keyword">for</span> (DetectedObject obj : objects) {
            classGroups.computeIfAbsent(obj.getClassId(), k -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;()).add(obj);
        }
        
        List&lt;DetectedObject&gt; nmsResult = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        <span class="hljs-keyword">for</span> (List&lt;DetectedObject&gt; group : classGroups.values()) {
            <span class="hljs-comment">// æŒ‰ç½®ä¿¡åº¦é™åºæ’åº</span>
            group.sort((a, b) -&gt; Float.compare(b.getConfidence(), a.getConfidence()));
            
            <span class="hljs-type">boolean</span>[] keep = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[group.size()];
            Arrays.fill(keep, <span class="hljs-literal">true</span>);
            
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; group.size(); i++) {
                <span class="hljs-keyword">if</span> (!keep[i]) {
                    <span class="hljs-keyword">continue</span>;
                }
                <span class="hljs-type">DetectedObject</span> <span class="hljs-variable">objI</span> <span class="hljs-operator">=</span> group.get(i);
                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> i + <span class="hljs-number">1</span>; j &lt; group.size(); j++) {
                    <span class="hljs-keyword">if</span> (!keep[j]) {
                        <span class="hljs-keyword">continue</span>;
                    }
                    <span class="hljs-type">DetectedObject</span> <span class="hljs-variable">objJ</span> <span class="hljs-operator">=</span> group.get(j);
                    
                    <span class="hljs-comment">// è®¡ç®—IOUï¼ˆäº¤å¹¶æ¯”ï¼‰</span>
                    <span class="hljs-type">float</span> <span class="hljs-variable">iou</span> <span class="hljs-operator">=</span> calculateIOU(objI, objJ);
                    <span class="hljs-keyword">if</span> (iou &gt; YoloConstants.NMS_THRESHOLD) {
                        keep[j] = <span class="hljs-literal">false</span>;
                    }
                }
            }
            
            <span class="hljs-comment">// æ”¶é›†ä¿ç•™çš„æ¡†</span>
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; group.size(); i++) {
                <span class="hljs-keyword">if</span> (keep[i]) {
                    nmsResult.add(group.get(i));
                }
            }
        }
        <span class="hljs-keyword">return</span> nmsResult;
    }

    <span class="hljs-comment">/**
     * è®¡ç®—IOUï¼ˆäº¤å¹¶æ¯”ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> <span class="hljs-title function_">calculateIOU</span><span class="hljs-params">(DetectedObject a, DetectedObject b)</span> {
        <span class="hljs-type">float</span> <span class="hljs-variable">x1</span> <span class="hljs-operator">=</span> Math.max(a.getX1(), b.getX1());
        <span class="hljs-type">float</span> <span class="hljs-variable">y1</span> <span class="hljs-operator">=</span> Math.max(a.getY1(), b.getY1());
        <span class="hljs-type">float</span> <span class="hljs-variable">x2</span> <span class="hljs-operator">=</span> Math.min(a.getX2(), b.getX2());
        <span class="hljs-type">float</span> <span class="hljs-variable">y2</span> <span class="hljs-operator">=</span> Math.min(a.getY2(), b.getY2());
        
        <span class="hljs-keyword">if</span> (x2 &lt; x1 || y2 &lt; y1) {
            <span class="hljs-keyword">return</span> <span class="hljs-number">0.0f</span>;
        }
        
        <span class="hljs-comment">// äº¤é›†é¢ç§¯</span>
        <span class="hljs-type">float</span> <span class="hljs-variable">intersection</span> <span class="hljs-operator">=</span> (x2 - x1) * (y2 - y1);
        <span class="hljs-comment">// å¹¶é›†é¢ç§¯</span>
        <span class="hljs-type">float</span> <span class="hljs-variable">areaA</span> <span class="hljs-operator">=</span> (a.getX2() - a.getX1()) * (a.getY2() - a.getY1());
        <span class="hljs-type">float</span> <span class="hljs-variable">areaB</span> <span class="hljs-operator">=</span> (b.getX2() - b.getX1()) * (b.getY2() - b.getY1());
        <span class="hljs-type">float</span> <span class="hljs-variable">union</span> <span class="hljs-operator">=</span> areaA + areaB - intersection;
        
        <span class="hljs-keyword">return</span> intersection / union;
    }

    <span class="hljs-comment">/**
     * é‡Šæ”¾èµ„æº
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (session != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">try</span> {
                session.close();
                env.close();
                log.info(<span class="hljs-string">"YOLOv26æ¨¡å‹èµ„æºå·²é‡Šæ”¾"</span>);
            } <span class="hljs-keyword">catch</span> (OrtException e) {
                log.error(<span class="hljs-string">"èµ„æºé‡Šæ”¾å¤±è´¥"</span>, e);
            }
        }
    }
}
</code></pre>
<h2 data-id="heading-7">ä¸‰ã€æ¥å£å°è£…ï¼šé€šç”¨æ£€æµ‹Controller</h2>
<pre><code class="hljs language-Java" lang="Java">
<span class="hljs-keyword">package</span> com.ai.detection.controller;

<span class="hljs-keyword">import</span> com.ai.detection.entity.DetectionResult;
<span class="hljs-keyword">import</span> com.ai.detection.entity.DetectedObject;
<span class="hljs-keyword">import</span> com.ai.detection.utils.YoloV26Detector;
<span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;
<span class="hljs-keyword">import</span> org.springframework.http.HttpStatus;
<span class="hljs-keyword">import</span> org.springframework.http.ResponseEntity;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.PostMapping;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestParam;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;
<span class="hljs-keyword">import</span> org.springframework.web.multipart.MultipartFile;

<span class="hljs-keyword">import</span> java.io.File;
<span class="hljs-keyword">import</span> java.io.IOException;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * YOLOv26é€šç”¨æ£€æµ‹æ¥å£
 */</span>
<span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping("/api/detect")</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DetectionController</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">YoloV26Detector</span> <span class="hljs-variable">detector</span> <span class="hljs-operator">=</span> YoloV26Detector.getInstance();

    <span class="hljs-comment">/**
     * å›¾ç‰‡æ–‡ä»¶æ£€æµ‹æ¥å£
     */</span>
    <span class="hljs-meta">@PostMapping("/image")</span>
    <span class="hljs-keyword">public</span> ResponseEntity&lt;DetectionResult&gt; <span class="hljs-title function_">detectImage</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam("file")</span> MultipartFile file)</span> {
        <span class="hljs-type">DetectionResult</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DetectionResult</span>();
        <span class="hljs-type">long</span> <span class="hljs-variable">startTime</span> <span class="hljs-operator">=</span> System.currentTimeMillis();
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// å‚æ•°æ ¡éªŒ</span>
            <span class="hljs-keyword">if</span> (file.isEmpty()) {
                result.setStatus(<span class="hljs-string">"fail"</span>);
                result.setErrorMsg(<span class="hljs-string">"ä¸Šä¼ çš„å›¾ç‰‡æ–‡ä»¶ä¸ºç©º"</span>);
                <span class="hljs-keyword">return</span> ResponseEntity.badRequest().body(result);
            }
            
            <span class="hljs-comment">// ä¸´æ—¶æ–‡ä»¶ä¿å­˜ï¼ˆä¹Ÿå¯ç›´æ¥è¯»å–æµï¼Œé¿å…ç£ç›˜IOï¼‰</span>
            <span class="hljs-type">File</span> <span class="hljs-variable">tempFile</span> <span class="hljs-operator">=</span> File.createTempFile(<span class="hljs-string">"detect_"</span>, <span class="hljs-string">"."</span> + file.getOriginalFilename().split(<span class="hljs-string">"\\."</span>)[<span class="hljs-number">1</span>]);
            file.transferTo(tempFile);
            
            <span class="hljs-comment">// æ‰§è¡Œæ£€æµ‹</span>
            List&lt;DetectedObject&gt; objects = detector.detectImage(tempFile);
            
            <span class="hljs-comment">// å°è£…ç»“æœ</span>
            result.setStatus(<span class="hljs-string">"success"</span>);
            result.setObjects(objects);
            result.setCostTime(System.currentTimeMillis() - startTime);
            
            <span class="hljs-comment">// åˆ é™¤ä¸´æ—¶æ–‡ä»¶</span>
            tempFile.delete();
            
            <span class="hljs-keyword">return</span> ResponseEntity.ok(result);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"å›¾ç‰‡æ£€æµ‹æ¥å£å¼‚å¸¸"</span>, e);
            result.setStatus(<span class="hljs-string">"fail"</span>);
            result.setErrorMsg(<span class="hljs-string">"æ£€æµ‹å¤±è´¥ï¼š"</span> + e.getMessage());
            result.setCostTime(System.currentTimeMillis() - startTime);
            <span class="hljs-keyword">return</span> ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(result);
        }
    }

    <span class="hljs-comment">/**
     * Base64æ£€æµ‹æ¥å£
     */</span>
    <span class="hljs-meta">@PostMapping("/base64")</span>
    <span class="hljs-keyword">public</span> ResponseEntity&lt;DetectionResult&gt; <span class="hljs-title function_">detectBase64</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam("base64Str")</span> String base64Str)</span> {
        <span class="hljs-type">DetectionResult</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DetectionResult</span>();
        <span class="hljs-type">long</span> <span class="hljs-variable">startTime</span> <span class="hljs-operator">=</span> System.currentTimeMillis();
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// å‚æ•°æ ¡éªŒ</span>
            <span class="hljs-keyword">if</span> (base64Str == <span class="hljs-literal">null</span> || base64Str.trim().isEmpty()) {
                result.setStatus(<span class="hljs-string">"fail"</span>);
                result.setErrorMsg(<span class="hljs-string">"Base64å­—ç¬¦ä¸²ä¸ºç©º"</span>);
                <span class="hljs-keyword">return</span> ResponseEntity.badRequest().body(result);
            }
            
            <span class="hljs-comment">// æ‰§è¡Œæ£€æµ‹</span>
            List&lt;DetectedObject&gt; objects = detector.detectBase64(base64Str);
            
            <span class="hljs-comment">// å°è£…ç»“æœ</span>
            result.setStatus(<span class="hljs-string">"success"</span>);
            result.setObjects(objects);
            result.setCostTime(System.currentTimeMillis() - startTime);
            
            <span class="hljs-keyword">return</span> ResponseEntity.ok(result);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"Base64æ£€æµ‹æ¥å£å¼‚å¸¸"</span>, e);
            result.setStatus(<span class="hljs-string">"fail"</span>);
            result.setErrorMsg(<span class="hljs-string">"æ£€æµ‹å¤±è´¥ï¼š"</span> + e.getMessage());
            result.setCostTime(System.currentTimeMillis() - startTime);
            <span class="hljs-keyword">return</span> ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(result);
        }
    }
}
</code></pre>
<h2 data-id="heading-8">å››ã€å¯åŠ¨ç±»ä¸é…ç½®</h2>
<h3 data-id="heading-9">4.1 å¯åŠ¨ç±»</h3>
<pre><code class="hljs language-Java" lang="Java">
<span class="hljs-keyword">package</span> com.ai.detection;

<span class="hljs-keyword">import</span> com.ai.detection.utils.YoloV26Detector;
<span class="hljs-keyword">import</span> jakarta.annotation.PreDestroy;
<span class="hljs-keyword">import</span> org.springframework.boot.SpringApplication;
<span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;

<span class="hljs-meta">@SpringBootApplication</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">YoloV26Application</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        SpringApplication.run(YoloV26Application.class, args);
    }

    <span class="hljs-comment">/**
     * åº”ç”¨å…³é—­æ—¶é‡Šæ”¾æ¨¡å‹èµ„æº
     */</span>
    <span class="hljs-meta">@PreDestroy</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">destroy</span><span class="hljs-params">()</span> {
        YoloV26Detector.getInstance().close();
    }
}
</code></pre>
<h3 data-id="heading-10">4.2 é…ç½®æ–‡ä»¶ï¼ˆapplication.ymlï¼‰</h3>
<pre><code class="hljs language-YAML" lang="YAML">
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">servlet:</span>
    <span class="hljs-attr">multipart:</span>
      <span class="hljs-comment"># å›¾ç‰‡ä¸Šä¼ å¤§å°é™åˆ¶</span>
      <span class="hljs-attr">max-file-size:</span> <span class="hljs-string">10MB</span>
      <span class="hljs-attr">max-request-size:</span> <span class="hljs-string">10MB</span>
  <span class="hljs-comment"># æ—¥å¿—é…ç½®</span>
<span class="hljs-attr">logging:</span>
  <span class="hljs-attr">level:</span>
    <span class="hljs-attr">com.ai.detection:</span> <span class="hljs-string">INFO</span>
    <span class="hljs-attr">org.springframework:</span> <span class="hljs-string">WARN</span>
    <span class="hljs-attr">com.microsoft.onnxruntime:</span> <span class="hljs-string">WARN</span>
  <span class="hljs-attr">pattern:</span>
    <span class="hljs-attr">console:</span> <span class="hljs-string">"%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"</span>
    <span class="hljs-attr">file:</span> <span class="hljs-string">"%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"</span>
<span class="hljs-comment"># æœåŠ¡å™¨é…ç½®</span>
<span class="hljs-attr">server:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span>
  <span class="hljs-attr">tomcat:</span>
    <span class="hljs-attr">max-threads:</span> <span class="hljs-number">200</span>
    <span class="hljs-attr">min-spare-threads:</span> <span class="hljs-number">20</span>
</code></pre>
<h2 data-id="heading-11">äº”ã€æµ‹è¯•éªŒè¯</h2>
<h3 data-id="heading-12">5.1 å›¾ç‰‡æ–‡ä»¶æ£€æµ‹ï¼ˆPostmanè¯·æ±‚ï¼‰</h3>
<ul>
<li>
<p>è¯·æ±‚åœ°å€ï¼š<code>http://localhost:8080/api/detect/image</code></p>
</li>
<li>
<p>è¯·æ±‚æ–¹å¼ï¼šPOST</p>
</li>
<li>
<p>è¯·æ±‚ç±»å‹ï¼šform-data</p>
</li>
<li>
<p>å‚æ•°ï¼š<code>file</code> â†’ é€‰æ‹©æœ¬åœ°å›¾ç‰‡æ–‡ä»¶</p>
</li>
</ul>
<h3 data-id="heading-13">5.2 Base64æ£€æµ‹ï¼ˆPostmanè¯·æ±‚ï¼‰</h3>
<ul>
<li>
<p>è¯·æ±‚åœ°å€ï¼š<code>http://localhost:8080/api/detect/base64</code></p>
</li>
<li>
<p>è¯·æ±‚æ–¹å¼ï¼šPOST</p>
</li>
<li>
<p>è¯·æ±‚ç±»å‹ï¼šform-data</p>
</li>
<li>
<p>å‚æ•°ï¼š<code>base64Str</code> â†’ å›¾ç‰‡çš„Base64å­—ç¬¦ä¸²ï¼ˆå¯å¸¦å‰ç¼€ï¼‰</p>
</li>
</ul>
<h3 data-id="heading-14">5.3 å“åº”ç¤ºä¾‹</h3>
<pre><code class="hljs language-JSON" lang="JSON">
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"status"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"success"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"errorMsg"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"objects"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"className"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"person"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"classId"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"confidence"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.9856</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"x1"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">120.5</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"y1"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">80.2</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"x2"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">250.8</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"y2"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">450.3</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"className"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"car"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"classId"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"confidence"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.9532</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"x1"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">300.1</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"y1"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">200.5</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"x2"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">500.7</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"y2"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">350.9</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"costTime"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">85</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-15">å…­ã€å·¥ä¸šçº§ä¼˜åŒ–å»ºè®®</h2>
<ol>
<li>
<p><strong>æ¨¡å‹ç¼“å­˜</strong>ï¼šå•ä¾‹æ¨¡å¼ç¡®ä¿æ¨¡å‹åªåŠ è½½ä¸€æ¬¡ï¼Œé¿å…é‡å¤åˆå§‹åŒ–æ¶ˆè€—èµ„æºï¼›</p>
</li>
<li>
<p><strong>å¼‚æ­¥å¤„ç†</strong>ï¼šé«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œæ¥å£æ”¹ä¸ºå¼‚æ­¥ï¼ˆ<code>@Async</code>ï¼‰ï¼Œè¿”å›ä»»åŠ¡IDï¼Œé€šè¿‡å›è°ƒ/è½®è¯¢è·å–ç»“æœï¼›</p>
</li>
<li>
<p><strong>GPUåŠ é€Ÿ</strong>ï¼šéƒ¨ç½²åˆ°æœ‰NVIDIA GPUçš„æœåŠ¡å™¨ï¼Œæ›¿æ¢ä¸ºCUDAç‰ˆONNX Runtimeï¼Œæ¨ç†é€Ÿåº¦æå‡5-10å€ï¼›</p>
</li>
<li>
<p><strong>æ‰¹é‡æ£€æµ‹</strong>ï¼šæ‰©å±•æ¥å£æ”¯æŒå¤šå›¾ç‰‡æ‰¹é‡æ£€æµ‹ï¼Œé™ä½æ¨¡å‹è°ƒç”¨å¼€é”€ï¼›</p>
</li>
<li>
<p><strong>ç»“æœç¼“å­˜</strong>ï¼šå¯¹ç›¸åŒå›¾ç‰‡/Base64çš„æ£€æµ‹ç»“æœç¼“å­˜ï¼ˆRedisï¼‰ï¼Œé¿å…é‡å¤æ£€æµ‹ï¼›</p>
</li>
<li>
<p><strong>ç›‘æ§å‘Šè­¦</strong>ï¼šæ·»åŠ æ¥å£QPSã€è€—æ—¶ã€å¤±è´¥ç‡ç›‘æ§ï¼Œå¼‚å¸¸æ—¶è§¦å‘å‘Šè­¦ã€‚</p>
</li>
</ol>
<h3 data-id="heading-16">æ€»ç»“</h3>
<p>æœ¬æ¬¡å®æˆ˜æ ¸å¿ƒå®Œæˆäº†ä»¥ä¸‹å…³é”®å†…å®¹ï¼š</p>
<ol>
<li>
<p><strong>ç¯å¢ƒæ•´åˆ</strong>ï¼šSpringBoot 3.xæ•´åˆONNX Runtimeï¼Œå®ç°YOLOv26çš„Javaç«¯åŸç”Ÿæ¨ç†ï¼Œé¿å…è·¨è¯­è¨€è°ƒç”¨ï¼›</p>
</li>
<li>
<p><strong>é€šç”¨å°è£…</strong>ï¼šå·¥å…·ç±»æ”¯æŒå›¾ç‰‡æ–‡ä»¶/Base64åŒå…¥å‚ï¼Œç»Ÿä¸€æ£€æµ‹é€»è¾‘ï¼Œé€‚é…ä¸åŒä¸šåŠ¡åœºæ™¯ï¼›</p>
</li>
<li>
<p><strong>å·¥ä¸šçº§å¤„ç†</strong>ï¼šåŒ…å«å›¾ç‰‡é¢„å¤„ç†ã€NMSåå¤„ç†ã€å‚æ•°æ ¡éªŒã€å¼‚å¸¸æ•è·ï¼Œä¿è¯æ¥å£ç¨³å®šæ€§ï¼›</p>
</li>
<li>
<p><strong>æ ‡å‡†åŒ–æ¥å£</strong>ï¼šRESTfulé£æ ¼æ¥å£ï¼Œç»Ÿä¸€è¿”å›æ ¼å¼ï¼Œä¾¿äºå‰ç«¯/ç¬¬ä¸‰æ–¹ç³»ç»Ÿé›†æˆã€‚</p>
</li>
</ol>
<p>è¯¥æ–¹æ¡ˆå¯ç›´æ¥è½åœ°åˆ°æ™ºèƒ½ç›‘æ§ã€å·¥ä¸šè´¨æ£€ã€è‡ªåŠ¨é©¾é©¶è¾…åŠ©ç­‰åœºæ™¯ï¼Œåªéœ€æ›¿æ¢YOLOv26çš„è®­ç»ƒæƒé‡ï¼Œå³å¯é€‚é…è‡ªå®šä¹‰ç›®æ ‡æ£€æµ‹éœ€æ±‚ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”¨pythonä»æ•°æ®çœ‹ä¸–ç•Œï¼Œçœ‹çœ‹ç®—æ³•æ˜¯å¦‚ä½•åˆ†æä½ çš„]]></title>    <link>https://juejin.cn/post/7599924965950652454</link>    <guid>https://juejin.cn/post/7599924965950652454</guid>    <pubDate>2026-01-27T14:47:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599924965950652454" data-draft-id="7599920572840296457" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”¨pythonä»æ•°æ®çœ‹ä¸–ç•Œï¼Œçœ‹çœ‹ç®—æ³•æ˜¯å¦‚ä½•åˆ†æä½ çš„"/> <meta itemprop="keywords" content="Python,æ•°æ®å¯è§†åŒ–"/> <meta itemprop="datePublished" content="2026-01-27T14:47:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä»£ç é£ä¸€ä¼šå„¿"/> <meta itemprop="url" content="https://juejin.cn/user/555695627842490"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”¨pythonä»æ•°æ®çœ‹ä¸–ç•Œï¼Œçœ‹çœ‹ç®—æ³•æ˜¯å¦‚ä½•åˆ†æä½ çš„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/555695627842490/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä»£ç é£ä¸€ä¼šå„¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T14:47:51.000Z" title="Tue Jan 27 2026 14:47:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€æ•°æ®åˆ†æä¸å¤„ç†</h2>
<h3 data-id="heading-1">ï¼ˆä¸€ï¼‰ æ•°æ®çš„å¯¼å…¥å¯¼å‡º</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ•°æ®çš„å¯¼å…¥</span>
import pandas as pd
<span class="hljs-attr">df</span>= pd.read_csv(<span class="hljs-string">'data/data.csv'</span>)
</code></pre>

<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment">#æ•°æ®çš„å¯¼å‡º</span>
<span class="hljs-built_in">df</span>= df.tail()
df.to_csv(<span class="hljs-string">'data/output.csv'</span>)
</code></pre>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ç®€å•json</span>
<span class="hljs-attr">df</span>= pd.read_json(<span class="hljs-string">'data/data.json'</span>)
</code></pre>

<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å¤æ‚json</span>
<span class="hljs-keyword">import</span> json
<span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'data/data_complex.json'</span>) <span class="hljs-keyword">as</span> f:
    data = json.load(f)
</code></pre>
<h3 data-id="heading-2">ï¼ˆäºŒï¼‰ é—®é¢˜æ•°æ®å¤„ç†</h3>
<h4 data-id="heading-3">1. ç¼ºå¤±å€¼å¤„ç†</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
s=pd.Series([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,np.nan,<span class="hljs-literal">None</span>,pd.NA])
df=pd.DataFrame([[<span class="hljs-number">1</span>,pd.NA],[<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>],[<span class="hljs-literal">None</span>,<span class="hljs-number">4</span>,<span class="hljs-number">6</span>]],columns=[<span class="hljs-string">'ç¬¬ä¸€åˆ—'</span>,<span class="hljs-string">'ç¬¬äºŒåˆ—'</span>,<span class="hljs-string">'ç¬¬ä¸‰åˆ—'</span>])<span class="hljs-comment"># # # æŸ¥çœ‹æ˜¯å¦æ˜¯ç¼ºå¤±å€¼</span>
<span class="hljs-built_in">print</span>(s.isna())
<span class="hljs-built_in">print</span>(s.isnull())
<span class="hljs-built_in">print</span>(df.isna())
<span class="hljs-built_in">print</span>(df.isnull())
<span class="hljs-built_in">print</span>(df.isna().<span class="hljs-built_in">sum</span>(axis=<span class="hljs-number">1</span>))
<span class="hljs-built_in">print</span>(s.isna().<span class="hljs-built_in">sum</span>()) <span class="hljs-comment"># æŸ¥çœ‹ç¼ºå¤±å€¼çš„ä¸ªæ•°</span>
</code></pre>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å‰”é™¤ç¼ºå¤±å€¼</span>
print(s.dropna())
print(df.dropna())
print(df.dropna(<span class="hljs-attr">how</span>=<span class="hljs-string">'all'</span>)) <span class="hljs-comment"># å¦‚æœæ‰€æœ‰çš„å€¼éƒ½æ˜¯ç¼ºå¤±å€¼ï¼Œåˆ é™¤è¿™ä¸€è¡Œ</span>
print(df.dropna(<span class="hljs-attr">thresh</span>=<span class="hljs-number">2</span>)) <span class="hljs-comment"># å¦‚æœè‡³å°‘æœ‰nä¸ªå€¼ä¸æ˜¯ç¼ºå¤±å€¼ï¼Œå°±ä¿ç•™</span>
print(df.dropna(<span class="hljs-attr">axis</span>=<span class="hljs-number">1</span>)) <span class="hljs-comment"># å‰”é™¤ä¸€æ•´åˆ—çš„è®°å½•</span>
print(df.dropna(<span class="hljs-attr">subset</span>=[<span class="hljs-string">'ç¬¬ä¸€åˆ—'</span>])) <span class="hljs-comment"># å¦‚æœæŸåˆ—æœ‰ç¼ºå¤±å€¼ï¼Œåˆ™åˆ é™¤è¿™ä¸€è¡Œ</span>
</code></pre>

<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¡«å……ç¼ºå¤±å€¼</span>
<span class="hljs-built_in">df</span>=pd.read_csv(<span class="hljs-string">'data/data_withNA.csv'</span>)
df.isna().<span class="hljs-built_in">sum</span>(axis=0)
<span class="hljs-built_in">print</span>(df.fillna({<span class="hljs-string">'join_date'</span>:20})) <span class="hljs-comment"># ä½¿ç”¨å­—å…¸æ¥å¡«å……</span>
<span class="hljs-built_in">print</span>(df.fillna(<span class="hljs-built_in">df</span>[[<span class="hljs-string">'age'</span>]].mean())) <span class="hljs-comment"># ä½¿ç”¨ç»Ÿè®¡å€¼æ¥å¡«å……</span>
<span class="hljs-built_in">print</span>(df.ffill()) <span class="hljs-comment"># ç”¨å‰é¢çš„ç›¸é‚»å€¼å¡«å……</span>
<span class="hljs-built_in">print</span>(df.bfill()) <span class="hljs-comment"># ç”¨åé¢çš„ç›¸é‚»å€¼å¡«å……</span>
</code></pre>
<h4 data-id="heading-4">2. å»é‡å¤„ç†</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">data</span> = {
    <span class="hljs-string">"name"</span>:[<span class="hljs-string">'alice'</span> ,<span class="hljs-string">'alice'</span> ,<span class="hljs-string">'bob'</span> ,<span class="hljs-string">'alice'</span> ,<span class="hljs-string">'jack'</span> ,<span class="hljs-string">'bob'</span> ],
    <span class="hljs-string">"age"</span>: [<span class="hljs-number">26</span>,<span class="hljs-number">25</span>,<span class="hljs-number">30</span>,<span class="hljs-number">25</span>,<span class="hljs-number">35</span>,<span class="hljs-number">30</span>],
    <span class="hljs-string">"city"</span>:[<span class="hljs-string">'NY'</span> ,<span class="hljs-string">'NY'</span> ,<span class="hljs-string">'LA'</span> ,<span class="hljs-string">'NY'</span> , <span class="hljs-string">'SF'</span> , <span class="hljs-string">'LA'</span> ]
}
df=pd.DataFrame(<span class="hljs-keyword">data</span>)
</code></pre>

<pre><code class="hljs language-ini" lang="ini">df.duplicated() <span class="hljs-comment"># ä¸€æ•´æ¡è®°å½•éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ ‡è®°ä¸ºé‡å¤ï¼Œè¿”å›True</span>
df.drop_duplicates(<span class="hljs-attr">subset</span>=[<span class="hljs-string">'name'</span>])<span class="hljs-comment"># æ ¹æ®æŒ‡å®šåˆ—å»é‡</span>
df.drop_duplicates(<span class="hljs-attr">subset</span>=[<span class="hljs-string">'name'</span>],keep=<span class="hljs-string">'last'</span>) <span class="hljs-comment"># ä¿ç•™æœ€åä¸€æ¬¡å‡ºç°çš„è¡Œ</span>
</code></pre>
<h4 data-id="heading-5">3. æ•°æ®ç±»å‹çš„è½¬æ¢</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">df</span>[<span class="hljs-string">'age'</span>]=<span class="hljs-built_in">df</span>[<span class="hljs-string">'age'</span>].astype(<span class="hljs-string">'int16'</span>)
</code></pre>
<h4 data-id="heading-6">4. æ•°æ®å˜å½¢</h4>
<pre><code class="hljs language-ini" lang="ini">import pandas as pd
<span class="hljs-attr">data</span> = {
    'ID': <span class="hljs-section">[1, 2]</span>,
    'name' : <span class="hljs-section">['alice', 'bob' ]</span>,
    'Math': <span class="hljs-section">[90, 85]</span>,
    'English': <span class="hljs-section">[88, 92]</span>,
    'Science': <span class="hljs-section">[95, 89]</span>
}
<span class="hljs-attr">df</span> = pd.DataFrame(data)
df.T <span class="hljs-comment"># è½¬ç½®</span>
<span class="hljs-comment">#å®½è¡¨è½¬æ¢ä¸ºé•¿è¡¨</span>
<span class="hljs-attr">df2</span>=pd.melt(df,id_vars=[<span class="hljs-string">'ID'</span>,<span class="hljs-string">'name'</span>],var_name=<span class="hljs-string">'ç§‘ç›®'</span>,value_name=<span class="hljs-string">'åˆ†æ•°'</span>)
df2.sort_values('name') <span class="hljs-comment">#æ’åº</span>
<span class="hljs-comment">#é•¿è¡¨è½¬å®½è¡¨</span>
pd.pivot(df2,<span class="hljs-attr">index</span>=[<span class="hljs-string">'ID'</span>,<span class="hljs-string">'name'</span>],columns=<span class="hljs-string">'ç§‘ç›®'</span>,values=<span class="hljs-string">'åˆ†æ•°'</span>)
</code></pre>

<pre><code class="hljs language-bash" lang="bash">data = {
<span class="hljs-string">'ID'</span>: [1, 2],
<span class="hljs-string">'name'</span> : [<span class="hljs-string">'alice smith'</span> , <span class="hljs-string">'bob smith'</span> ],
<span class="hljs-string">'Math'</span>: [90, 85],
<span class="hljs-string">'English'</span>: [88, 92],
<span class="hljs-string">'Science'</span>: [95, 89]
}
<span class="hljs-built_in">df</span> = pd.DataFrame(data)
<span class="hljs-comment"># åˆ†åˆ—</span>
<span class="hljs-built_in">df</span>[[<span class="hljs-string">'first'</span>,<span class="hljs-string">'last'</span>]]= <span class="hljs-built_in">df</span>[<span class="hljs-string">'name'</span>].str.split(<span class="hljs-string">' '</span>,<span class="hljs-built_in">expand</span>=True)
</code></pre>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ•°æ®åˆ†ç®± pd.cat(x,bins,labels)</span>
<span class="hljs-attr">df1</span>=df.head(<span class="hljs-number">5</span>)[[<span class="hljs-string">'id'</span>,<span class="hljs-string">'age'</span>]]
pd.cut(df1<span class="hljs-section">['age']</span>,<span class="hljs-attr">bins</span>=<span class="hljs-number">2</span>) <span class="hljs-comment"># bins=nï¼Œåˆ†æˆnæ®µåŒºé—´ï¼Œèµ·å§‹å€¼ã€ç»“æŸå€¼æ˜¯æ‰€æœ‰æ•°æ®çš„æœ€å°å€¼ã€æœ€å¤§å€¼</span>
pd.cut(df1<span class="hljs-section">['age']</span>,<span class="hljs-attr">bins</span>=<span class="hljs-number">2</span>).value_counts()
pd.cut(df1<span class="hljs-section">['age']</span>,<span class="hljs-attr">bins</span>=[<span class="hljs-number">0</span>,<span class="hljs-number">25</span>,<span class="hljs-number">35</span>,<span class="hljs-number">45</span>]) <span class="hljs-comment"># bins=list,åˆ†æˆnæ®µåŒºé—´</span>
pd.cut(df1<span class="hljs-section">['age']</span>,<span class="hljs-attr">bins</span>=[<span class="hljs-number">0</span>,<span class="hljs-number">25</span>,<span class="hljs-number">35</span>,<span class="hljs-number">45</span>]).value_counts()
pd.cut(df1<span class="hljs-section">['age']</span>,<span class="hljs-attr">bins</span>=[<span class="hljs-number">0</span>,<span class="hljs-number">25</span>,<span class="hljs-number">35</span>,<span class="hljs-number">45</span>],labels=[<span class="hljs-string">'å¹¼'</span>,<span class="hljs-string">'ä¸­'</span>,<span class="hljs-string">'è€'</span>])
pd.qcut(df1<span class="hljs-section">['age']</span>,3)
</code></pre>

<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># é‡å‘½å</span>
df = pd.DataFrame(
    {
        <span class="hljs-string">'name'</span> : [ <span class="hljs-string">'jack'</span> ,<span class="hljs-string">'alice'</span> , <span class="hljs-string">'tom'</span> , <span class="hljs-string">'bob'</span> ],
        <span class="hljs-string">'age'</span>:[<span class="hljs-number">20</span>,<span class="hljs-number">30</span>,<span class="hljs-number">40</span>,<span class="hljs-number">50</span>],
        <span class="hljs-string">'gender'</span> : [<span class="hljs-string">'female'</span> , <span class="hljs-string">'male'</span> , <span class="hljs-string">' female'</span> , <span class="hljs-string">'male'</span> ]
    }
)
df.set_index(<span class="hljs-string">'name'</span>,inplace=<span class="hljs-literal">True</span>)
df.reset_index(inplace=<span class="hljs-literal">True</span>)
df.rename(columns={<span class="hljs-string">'age'</span>:<span class="hljs-string">"å¹´é¾„"</span>},index={<span class="hljs-number">0</span>:<span class="hljs-number">4</span>})
</code></pre>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">df.index</span>=[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]
<span class="hljs-attr">df.columns</span>=[<span class="hljs-string">'å§“å'</span>,<span class="hljs-string">'å¹´é¾„'</span>,<span class="hljs-string">'æ€§åˆ«'</span>]
</code></pre>
<h4 data-id="heading-7">5. æ—¶é—´æ•°æ®å¤„ç†</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
d = pd.Timestamp(<span class="hljs-string">'2015-05-02 10:22'</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">'å¹´ï¼š'</span>,d.year)
<span class="hljs-built_in">print</span>(<span class="hljs-string">'å­£åº¦ï¼š'</span>,d.quarter)
<span class="hljs-built_in">print</span>(<span class="hljs-string">'æ˜¯å¦æ˜¯æœˆåº•:'</span>,d.is_month_end)
<span class="hljs-comment"># æ–¹æ³•</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">'æ˜ŸæœŸå‡ ï¼š'</span>,d.day_name())
<span class="hljs-built_in">print</span>(<span class="hljs-string">'è½¬æ¢ä¸ºå¤©ï¼š'</span>,d.to_period(<span class="hljs-string">'D'</span>))
<span class="hljs-built_in">print</span>(<span class="hljs-string">'è½¬æ¢ä¸ºå­£åº¦ï¼š'</span>,d.to_period(<span class="hljs-string">'Q'</span>))
<span class="hljs-built_in">print</span>(<span class="hljs-string">'è½¬æ¢ä¸ºå¹´åº¦ï¼š'</span>,d.to_period(<span class="hljs-string">'Y'</span>))
<span class="hljs-built_in">print</span>(<span class="hljs-string">'è½¬æ¢ä¸ºæœˆåº¦ï¼š'</span>,d.to_period(<span class="hljs-string">'M'</span>))
</code></pre>

<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ—¥æœŸç±»å‹</span>
a = pd.to_datetime(<span class="hljs-string">'2015-01-04 10:22'</span>)
<span class="hljs-built_in">print</span>(a)
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(a))

<span class="hljs-comment"># dataFrame æ—¥æœŸè½¬æ¢</span>
<span class="hljs-built_in">df</span>= pd.DataFrame(
    {
        <span class="hljs-string">'sales'</span>:[100,200,300],
        <span class="hljs-string">'date'</span>:[<span class="hljs-string">'20250601'</span>,<span class="hljs-string">'20250704'</span>,<span class="hljs-string">'20250506'</span>]
    }
)
<span class="hljs-built_in">df</span>[<span class="hljs-string">'datatime'</span>]=pd.to_datetime(<span class="hljs-built_in">df</span>[<span class="hljs-string">'date'</span>])
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(<span class="hljs-built_in">df</span>[<span class="hljs-string">'datatime'</span>]))
<span class="hljs-built_in">df</span>[<span class="hljs-string">'week'</span>] = <span class="hljs-built_in">df</span>[<span class="hljs-string">'datatime'</span>].dt.day_name()
</code></pre>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ—¥æœŸæ•°æ®ä½œä¸ºç´¢å¼•</span>
df.set_index('date',<span class="hljs-attr">inplace</span>=<span class="hljs-literal">True</span>) <span class="hljs-comment"># è®¾ç½®åŸæ¥çš„dfçš„ç´¢å¼•</span>
<span class="hljs-comment">#print(df.loc['2025-05-06':'2025-07-04'])</span>
</code></pre>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ—¶é—´é—´éš”</span>
<span class="hljs-attr">d1</span> = pd. Timestamp(<span class="hljs-string">'2013-01-15'</span>)
<span class="hljs-attr">d2</span> = pd.Timestamp(<span class="hljs-string">'2023-02-23'</span>)
<span class="hljs-attr">d3</span> = d2-d1
print(type(d3))
</code></pre>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ—¥æœŸç”Ÿæˆ</span>
<span class="hljs-attr">days</span>= pd.date_range(<span class="hljs-string">'2025-07-03'</span>,<span class="hljs-string">'2026-01-04'</span>,freq=<span class="hljs-string">'W'</span>)
print(days)
<span class="hljs-attr">days</span>= pd.date_range(<span class="hljs-string">'2025-07-03'</span>,periods=<span class="hljs-number">10</span>,freq=<span class="hljs-string">'W'</span>)
print(days)
</code></pre>
<h4 data-id="heading-8">6. åˆ†ç»„èšåˆ</h4>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">df.groupby(<span class="hljs-string">'åˆ†ç»„çš„å­—æ®µ'</span>)[<span class="hljs-string">'èšåˆçš„å­—æ®µ'</span>].èšåˆå‡½æ•°()</span>
<span class="hljs-meta prompt_"># </span><span class="bash">df.groupby(<span class="hljs-string">'åˆ†ç»„çš„å­—æ®µ'</span>).<span class="hljs-built_in">groups</span> <span class="hljs-comment"># æŸ¥çœ‹åˆ†ç»„</span></span>
<span class="hljs-meta prompt_"># </span><span class="bash">df.groupby(<span class="hljs-string">'åˆ†ç»„çš„å­—æ®µ'</span>).get_group(n) <span class="hljs-comment"># æŸ¥çœ‹å…·ä½“çš„æŸä¸ªåˆ†ç»„æ•°æ®</span></span>
</code></pre>
<h2 data-id="heading-9">äºŒã€æ•°æ®å¯è§†åŒ–</h2>
<h3 data-id="heading-10">ï¼ˆä¸€ï¼‰matplotlib</h3>
<p><code>matplotlib</code>Â æ˜¯ Python ä¸­æœ€å¸¸ç”¨çš„æ•°æ®å¯è§†åŒ–åº“ä¹‹ä¸€ï¼Œä¸»è¦ç”¨äºç»˜åˆ¶ 2D å›¾è¡¨ï¼ˆä¹Ÿæ”¯æŒç®€å•çš„ 3D ç»˜å›¾ï¼‰ã€‚å®ƒåŠŸèƒ½å¼ºå¤§ã€çµæ´»ï¼Œå¹¿æ³›åº”ç”¨äºç§‘å­¦è®¡ç®—ã€æ•°æ®åˆ†æå’Œæœºå™¨å­¦ä¹ ç­‰é¢†åŸŸã€‚</p>
<h4 data-id="heading-11">æŠ˜çº¿å›¾</h4>
<pre><code class="hljs language-ini" lang="ini">import matplotlib.pyplot as plt
from matplotlib import rcParams
<span class="hljs-comment"># è®¾ç½®ä¸­æ–‡å­—ä½“ï¼ˆç¡®ä¿æ”¯æŒä¸­æ–‡æ˜¾ç¤ºï¼‰</span>
rcParams<span class="hljs-section">['font.sans-serif']</span> = <span class="hljs-section">['STKAITI']</span>  <span class="hljs-comment"># ä½¿ç”¨é»‘ä½“æˆ–åæ–‡æ¥·ä½“</span>
<span class="hljs-comment"># æ•°æ®</span>
<span class="hljs-attr">months</span> = [<span class="hljs-string">'1æœˆ'</span>, <span class="hljs-string">'2æœˆ'</span>, <span class="hljs-string">'3æœˆ'</span>, <span class="hljs-string">'4æœˆ'</span>]
<span class="hljs-attr">sales</span> = [<span class="hljs-number">100</span>, <span class="hljs-number">150</span>, <span class="hljs-number">80</span>, <span class="hljs-number">130</span>]
<span class="hljs-comment"># åˆ›å»ºå›¾å½¢å’Œè½´</span>
plt.figure(<span class="hljs-attr">figsize</span>=(<span class="hljs-number">10</span>, <span class="hljs-number">6</span>))
<span class="hljs-comment"># ç»˜åˆ¶æŠ˜çº¿å›¾</span>
plt.plot(months, sales, <span class="hljs-attr">marker</span>=<span class="hljs-string">'o'</span>, color=<span class="hljs-string">'orange'</span>, linewidth=<span class="hljs-number">2</span>, markersize=<span class="hljs-number">6</span>)
<span class="hljs-comment"># æ·»åŠ æ ‡é¢˜</span>
plt.title('2025å¹´é”€å”®è¶‹åŠ¿', <span class="hljs-attr">fontsize</span>=<span class="hljs-number">18</span>, color=<span class="hljs-string">'red'</span>, pad=<span class="hljs-number">20</span>)
<span class="hljs-comment"># è®¾ç½®åæ ‡è½´æ ‡ç­¾</span>
plt.xlabel('æœˆä»½', <span class="hljs-attr">fontsize</span>=<span class="hljs-number">12</span>)
plt.ylabel('é”€å”®é¢ï¼ˆä¸‡å…ƒï¼‰', <span class="hljs-attr">fontsize</span>=<span class="hljs-number">12</span>)
<span class="hljs-comment"># è®¾ç½®yè½´èŒƒå›´</span>
plt.ylim(0, 160)
<span class="hljs-comment"># æ·»åŠ ç½‘æ ¼çº¿</span>
plt.grid(True, <span class="hljs-attr">alpha</span>=<span class="hljs-number">0.3</span>, linestyle=<span class="hljs-string">'--'</span>, linewidth=<span class="hljs-number">0.8</span>)
<span class="hljs-comment"># æ·»åŠ å›¾ä¾‹</span>
plt.legend(<span class="hljs-section">['äº§å“A']</span>, <span class="hljs-attr">loc</span>=<span class="hljs-string">'upper left'</span>, frameon=<span class="hljs-literal">True</span>, fancybox=<span class="hljs-literal">True</span>, shadow=<span class="hljs-literal">False</span>)
<span class="hljs-comment"># åœ¨æ¯ä¸ªæ•°æ®ç‚¹ä¸Šæ ‡æ³¨æ•°å€¼</span>
for i, (x, y) in enumerate(zip(months, sales)):
    plt.text(x, y + 2, str(y), <span class="hljs-attr">ha</span>=<span class="hljs-string">'center'</span>, va=<span class="hljs-string">'bottom'</span>, fontsize=<span class="hljs-number">10</span>, color=<span class="hljs-string">'black'</span>)
<span class="hljs-comment"># è°ƒæ•´å¸ƒå±€ï¼Œé¿å…æ ‡ç­¾è¢«è£å‰ª</span>
plt.tight_layout()
<span class="hljs-comment"># æ˜¾ç¤ºå›¾è¡¨</span>
plt.show()
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/91e9ddeaca9042e4a6b60fe5ff5c8ea9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770130071&amp;x-signature=AC6R9y9YbkgvvKWsr6V%2FyeTB0ss%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-12">æŸ±çŠ¶å›¾</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ç»˜åˆ¶æŸ±çŠ¶å›¾</span>
import matplotlib.pyplot as plt
from matplotlib import rcParams <span class="hljs-comment"># å­—ä½“</span>
<span class="hljs-comment">#rcParams['font.family'] = 'STKAITI' #åæ–‡æ¥·ä½“</span>
rcParams<span class="hljs-section">['font.sans-serif']</span> ='STKAITI' <span class="hljs-comment">#åæ–‡æ¥·ä½“</span>
<span class="hljs-comment"># åˆ›å»ºå›¾è¡¨ï¼Œè®¾ç½®å¤§å°</span>
plt.figure(<span class="hljs-attr">figsize</span>=(<span class="hljs-number">10</span>,<span class="hljs-number">5</span>))
<span class="hljs-comment"># è¦ç»˜å›¾çš„æ•°æ®</span>
<span class="hljs-attr">subjects</span>=[<span class="hljs-string">'è¯­æ–‡'</span>,<span class="hljs-string">'æ•°å­¦'</span>,<span class="hljs-string">'è‹±è¯­'</span>,<span class="hljs-string">'åŒ–å­¦'</span>]
<span class="hljs-attr">scores</span>=[<span class="hljs-number">85</span>,<span class="hljs-number">92</span>,<span class="hljs-number">78</span>,<span class="hljs-number">88</span>]
<span class="hljs-comment"># ç»˜åˆ¶æŸ±çŠ¶å›¾</span>
plt.bar(subjects,scores,<span class="hljs-attr">label</span>=<span class="hljs-string">'å°çº¢'</span>,color=<span class="hljs-string">'orange'</span>,width=<span class="hljs-number">0.6</span>)
<span class="hljs-comment"># æ·»åŠ æ ‡é¢˜</span>
plt.title('2025æˆç»©åˆ†å¸ƒ',<span class="hljs-attr">color</span>=<span class="hljs-string">'red'</span>,fontsize=<span class="hljs-number">20</span>)
<span class="hljs-comment"># æ·»åŠ åæ ‡è½´æ ‡ç­¾</span>
plt.xlabel('ç§‘ç›®',<span class="hljs-attr">fontsize</span>=<span class="hljs-number">10</span>)
plt.ylabel('æˆç»©ï¼ˆåˆ†ï¼‰',<span class="hljs-attr">fontsize</span>=<span class="hljs-number">10</span>)
<span class="hljs-comment"># æ·»åŠ å›¾ä¾‹</span>
plt.legend(<span class="hljs-attr">loc</span>=<span class="hljs-string">'upper right'</span>)
<span class="hljs-comment"># æ·»åŠ ç½‘æ ¼çº¿</span>
<span class="hljs-comment"># plt.grid(True,alpha=0.1,color='blue',linestyle='--') # '-':å®çº¿ ï¼›'--'ï¼šè™šçº¿</span>
plt.grid(<span class="hljs-attr">axis</span>=<span class="hljs-string">'y'</span>,alpha=<span class="hljs-number">0.1</span>,color=<span class="hljs-string">'blue'</span>,linestyle=<span class="hljs-string">'--'</span>)
<span class="hljs-comment"># è®¾ç½®åˆ»åº¦å­—ä½“å¤§å°</span>
plt.xticks(<span class="hljs-attr">rotation</span>=<span class="hljs-number">20</span>,fontsize=<span class="hljs-number">12</span>)
plt.yticks(<span class="hljs-attr">rotation</span>=<span class="hljs-number">0</span>,fontsize=<span class="hljs-number">12</span>)
<span class="hljs-comment"># è®¾ç½®yè½´çš„èŒƒå›´</span>
plt.ylim(0,100)
<span class="hljs-comment"># æ¯ä¸ªæ•°æ®ç‚¹ä¸Šæ˜¾ç¤ºæ•°å€¼</span>
for x,y in zip(subjects,scores):
    <span class="hljs-comment"># print(x,y)</span>
    plt.text(x,y+1,str(y),<span class="hljs-attr">ha</span>=<span class="hljs-string">'center'</span>,va=<span class="hljs-string">'bottom'</span>,fontsize=<span class="hljs-number">10</span>)
<span class="hljs-comment"># è‡ªåŠ¨ä¼˜åŒ–æ’ç‰ˆ</span>
plt.tight_layout()
<span class="hljs-comment"># æ˜¾ç¤ºå›¾è¡¨</span>
plt.show()
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/002c9a89ae124f35aba3ebeae7b77de3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770130071&amp;x-signature=fZ2PMN80lKdXpiB%2FoWWrcVUMzrM%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-13">æ¡å½¢å›¾</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ç»˜åˆ¶æ¡å½¢å›¾</span>
import matplotlib.pyplot as plt
from matplotlib import rcParams <span class="hljs-comment"># å­—ä½“</span>
<span class="hljs-comment">#rcParams['font.family'] = 'STKAITI' #åæ–‡æ¥·ä½“</span>
rcParams<span class="hljs-section">['font.sans-serif']</span> ='STKAITI' <span class="hljs-comment">#åæ–‡æ¥·ä½“</span>
<span class="hljs-comment"># åˆ›å»ºå›¾è¡¨ï¼Œè®¾ç½®å¤§å°</span>
plt.figure(<span class="hljs-attr">figsize</span>=(<span class="hljs-number">10</span>,<span class="hljs-number">5</span>))
<span class="hljs-comment"># è¦ç»˜å›¾çš„æ•°æ®</span>
<span class="hljs-attr">countries</span>=[<span class="hljs-string">'United States'</span> , <span class="hljs-string">'China'</span> , <span class="hljs-string">'Japan'</span> ,<span class="hljs-string">'Germany'</span> , <span class="hljs-string">'India'</span> ]
<span class="hljs-attr">gdp</span>=[<span class="hljs-number">85</span>,<span class="hljs-number">92</span>,<span class="hljs-number">78</span>,<span class="hljs-number">88</span>,<span class="hljs-number">23</span>]
<span class="hljs-comment"># ç»˜åˆ¶æ¡å½¢å›¾</span>
plt.barh(countries,gdp,<span class="hljs-attr">label</span>=<span class="hljs-string">'GDP'</span>,color=<span class="hljs-string">'orange'</span>)
<span class="hljs-comment"># æ·»åŠ æ ‡é¢˜</span>
plt.title('2025GDPæ’å',<span class="hljs-attr">color</span>=<span class="hljs-string">'red'</span>,fontsize=<span class="hljs-number">20</span>)
<span class="hljs-comment"># æ·»åŠ åæ ‡è½´æ ‡ç­¾</span>
plt.xlabel('å›½å®¶',<span class="hljs-attr">fontsize</span>=<span class="hljs-number">10</span>)
plt.ylabel('GDPï¼ˆä¸‡å…ƒï¼‰',<span class="hljs-attr">fontsize</span>=<span class="hljs-number">10</span>)
<span class="hljs-comment"># æ·»åŠ å›¾ä¾‹</span>
plt.legend(<span class="hljs-attr">loc</span>=<span class="hljs-string">'upper right'</span>)
<span class="hljs-comment"># æ·»åŠ ç½‘æ ¼çº¿</span>
<span class="hljs-comment"># plt.grid(True,alpha=0.1,color='blue',linestyle='--') # '-':å®çº¿ ï¼›'--'ï¼šè™šçº¿</span>
plt.grid(<span class="hljs-attr">axis</span>=<span class="hljs-string">'x'</span>,alpha=<span class="hljs-number">0.1</span>,color=<span class="hljs-string">'blue'</span>,linestyle=<span class="hljs-string">'--'</span>)
<span class="hljs-comment"># è®¾ç½®åˆ»åº¦å­—ä½“å¤§å°</span>
plt.xticks(<span class="hljs-attr">rotation</span>=<span class="hljs-number">20</span>,fontsize=<span class="hljs-number">12</span>)
plt.yticks(<span class="hljs-attr">rotation</span>=<span class="hljs-number">0</span>,fontsize=<span class="hljs-number">12</span>)
<span class="hljs-comment"># è‡ªåŠ¨ä¼˜åŒ–æ’ç‰ˆ</span>
plt.tight_layout()
<span class="hljs-comment"># æ˜¾ç¤ºå›¾è¡¨</span>
plt.show()
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef2e9535cdbd4a53ac8b4b38de3a70d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770130071&amp;x-signature=jZZaFs7N1YFT8x0To6HwdjEJXsY%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-14">é¥¼å›¾</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ç»˜åˆ¶é¥¼å›¾</span>
import matplotlib.pyplot as plt
from matplotlib import rcParams <span class="hljs-comment"># å­—ä½“</span>
<span class="hljs-comment">#rcParams['font.family'] = 'STKAITI' #åæ–‡æ¥·ä½“</span>
rcParams<span class="hljs-section">['font.sans-serif']</span> ='STKAITI' <span class="hljs-comment">#åæ–‡æ¥·ä½“</span>
<span class="hljs-comment"># åˆ›å»ºå›¾è¡¨ï¼Œè®¾ç½®å¤§å°</span>
plt.figure(<span class="hljs-attr">figsize</span>=(<span class="hljs-number">10</span>,<span class="hljs-number">5</span>))
<span class="hljs-comment"># è¦ç»˜å›¾çš„æ•°æ®</span>
<span class="hljs-attr">things</span>=[<span class="hljs-string">'å­¦ä¹ '</span>,<span class="hljs-string">'å¨±ä¹'</span>,<span class="hljs-string">'è¿åŠ¨'</span>,<span class="hljs-string">'ç¡è§‰'</span>,<span class="hljs-string">'å…¶ä»–'</span>]
<span class="hljs-attr">times</span> = [<span class="hljs-number">4</span>,<span class="hljs-number">3</span>,<span class="hljs-number">1</span>,<span class="hljs-number">8</span>,<span class="hljs-number">5</span>]
<span class="hljs-attr">colors</span> = [<span class="hljs-string">'#66b3ff'</span>,<span class="hljs-string">'#99ff99'</span>,<span class="hljs-string">'#ffcc99'</span>,<span class="hljs-string">'#ff9999'</span>,<span class="hljs-string">'#ff4499'</span>] <span class="hljs-comment">#é…è‰²</span>
<span class="hljs-comment"># ç»˜åˆ¶é¥¼å›¾</span>
plt.pie(times,<span class="hljs-attr">labels</span>=things,autopct=<span class="hljs-string">'%1.1f %%'</span>,startangle=<span class="hljs-number">30</span>,colors=colors)<span class="hljs-comment"># startangleè°ƒæ•´åˆå§‹è§’åº¦</span>
<span class="hljs-comment"># æ·»åŠ æ ‡é¢˜</span>
plt.title('ä¸€å¤©æ—¶é—´åˆ†å¸ƒ',<span class="hljs-attr">color</span>=<span class="hljs-string">'red'</span>,fontsize=<span class="hljs-number">20</span>)
<span class="hljs-comment"># è‡ªåŠ¨ä¼˜åŒ–æ’ç‰ˆ</span>
plt.tight_layout()
<span class="hljs-comment"># æ˜¾ç¤ºå›¾è¡¨</span>
plt.show()
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be9e4793368a4cfe8c4d7e3cee9cdd08~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770130071&amp;x-signature=tlJfsDi1oUcB9%2BkeOVdrCV3FieE%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-15">ç¯å½¢å›¾</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ç»˜åˆ¶ç¯å½¢å›¾</span>
import matplotlib.pyplot as plt
from matplotlib import rcParams <span class="hljs-comment"># å­—ä½“</span>
<span class="hljs-comment">#rcParams['font.family'] = 'STKAITI' #åæ–‡æ¥·ä½“</span>
rcParams<span class="hljs-section">['font.sans-serif']</span> ='STKAITI' <span class="hljs-comment">#åæ–‡æ¥·ä½“</span>
<span class="hljs-comment"># åˆ›å»ºå›¾è¡¨ï¼Œè®¾ç½®å¤§å°</span>
plt.figure(<span class="hljs-attr">figsize</span>=(<span class="hljs-number">10</span>,<span class="hljs-number">5</span>))
<span class="hljs-comment"># è¦ç»˜å›¾çš„æ•°æ®</span>
<span class="hljs-attr">things</span>=[<span class="hljs-string">'å­¦ä¹ '</span>,<span class="hljs-string">'å¨±ä¹'</span>,<span class="hljs-string">'è¿åŠ¨'</span>,<span class="hljs-string">'ç¡è§‰'</span>,<span class="hljs-string">'å…¶ä»–'</span>]
<span class="hljs-attr">times</span> = [<span class="hljs-number">4</span>,<span class="hljs-number">3</span>,<span class="hljs-number">1</span>,<span class="hljs-number">8</span>,<span class="hljs-number">5</span>]
<span class="hljs-attr">colors</span> = [<span class="hljs-string">'#66b3ff'</span>,<span class="hljs-string">'#99ff99'</span>,<span class="hljs-string">'#ffcc99'</span>,<span class="hljs-string">'#ff9999'</span>,<span class="hljs-string">'#ff4499'</span>] <span class="hljs-comment">#é…è‰²</span>
<span class="hljs-comment"># ç»˜åˆ¶ç¯å½¢å›¾</span>
plt.pie(times,<span class="hljs-attr">labels</span>=things,autopct=<span class="hljs-string">'%1.1f %%'</span>,
        <span class="hljs-attr">startangle</span>=<span class="hljs-number">30</span>,colors=colors,<span class="hljs-comment"># startangleè°ƒæ•´åˆå§‹è§’åº¦</span>
        <span class="hljs-attr">wedgeprops</span>={<span class="hljs-string">'width'</span>:<span class="hljs-number">0.6</span>},<span class="hljs-comment"># åœ†ç¯å®½åº¦</span>
        <span class="hljs-attr">pctdistance</span>=<span class="hljs-number">0.6</span>)
<span class="hljs-comment"># æ·»åŠ æ ‡é¢˜</span>
plt.title('ä¸€å¤©æ—¶é—´åˆ†å¸ƒ',<span class="hljs-attr">color</span>=<span class="hljs-string">'red'</span>,fontsize=<span class="hljs-number">20</span>)
plt.text(0,0,'æ€»è®¡ï¼š\n100%')
<span class="hljs-comment"># è‡ªåŠ¨ä¼˜åŒ–æ’ç‰ˆ</span>
plt.tight_layout()
<span class="hljs-comment"># æ˜¾ç¤ºå›¾è¡¨</span>
plt.show()
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6135a2e018d944e0abbe8e3bda7519f8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770130071&amp;x-signature=mCM%2FVOrGe8m%2B6wf5LFPFmQwaHd4%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-16">çˆ†ç‚¸å¼é¥¼å›¾</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ç»˜åˆ¶çˆ†ç‚¸å¼é¥¼å›¾</span>
import matplotlib.pyplot as plt
from matplotlib import rcParams <span class="hljs-comment"># å­—ä½“</span>
<span class="hljs-comment">#rcParams['font.family'] = 'STKAITI' #åæ–‡æ¥·ä½“</span>
rcParams<span class="hljs-section">['font.sans-serif']</span> ='STKAITI' <span class="hljs-comment">#åæ–‡æ¥·ä½“</span>
<span class="hljs-comment"># åˆ›å»ºå›¾è¡¨ï¼Œè®¾ç½®å¤§å°</span>
plt.figure(<span class="hljs-attr">figsize</span>=(<span class="hljs-number">10</span>,<span class="hljs-number">5</span>))
<span class="hljs-comment"># è¦ç»˜å›¾çš„æ•°æ®</span>
<span class="hljs-attr">things</span>=[<span class="hljs-string">'å­¦ä¹ '</span>,<span class="hljs-string">'å¨±ä¹'</span>,<span class="hljs-string">'è¿åŠ¨'</span>,<span class="hljs-string">'ç¡è§‰'</span>,<span class="hljs-string">'å…¶ä»–'</span>]
<span class="hljs-attr">times</span> = [<span class="hljs-number">4</span>,<span class="hljs-number">3</span>,<span class="hljs-number">1</span>,<span class="hljs-number">8</span>,<span class="hljs-number">5</span>]
<span class="hljs-attr">colors</span> = [<span class="hljs-string">'#66b3ff'</span>,<span class="hljs-string">'#99ff99'</span>,<span class="hljs-string">'#ffcc99'</span>,<span class="hljs-string">'#ff9999'</span>,<span class="hljs-string">'#ff4499'</span>] <span class="hljs-comment">#é…è‰²</span>
<span class="hljs-attr">explode</span> = [<span class="hljs-number">0.2</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]<span class="hljs-comment"># è®¾ç½®çªå‡ºå—çš„ä½ç½®</span>
<span class="hljs-comment"># ç»˜åˆ¶çˆ†ç‚¸å¼é¥¼å›¾</span>
plt.pie(times,<span class="hljs-attr">labels</span>=things,autopct=<span class="hljs-string">'%1.1f %%'</span>,startangle=<span class="hljs-number">30</span>,colors=colors,explode=explode,shadow=<span class="hljs-literal">True</span>)<span class="hljs-comment"># startangleè°ƒæ•´åˆå§‹è§’åº¦</span>
<span class="hljs-comment"># æ·»åŠ æ ‡é¢˜</span>
plt.title('ä¸€å¤©æ—¶é—´åˆ†å¸ƒ',<span class="hljs-attr">color</span>=<span class="hljs-string">'red'</span>,fontsize=<span class="hljs-number">20</span>)
<span class="hljs-comment"># è‡ªåŠ¨ä¼˜åŒ–æ’ç‰ˆ</span>
plt.tight_layout()
<span class="hljs-comment"># æ˜¾ç¤ºå›¾è¡¨</span>
plt.show()
</code></pre>
<h4 data-id="heading-17"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2b72deafb14a47e1986e91761c196eaf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770130071&amp;x-signature=lVehYO%2FS%2Fimn2mQtYIq%2BNKJE56Q%3D" alt="" loading="lazy"/></h4>
<h4 data-id="heading-18">æ•£ç‚¹å›¾</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ç»˜åˆ¶æ•£ç‚¹å›¾</span>
import random
import matplotlib.pyplot as plt
from matplotlib import rcParams <span class="hljs-comment"># å­—ä½“</span>
<span class="hljs-comment">#rcParams['font.family'] = 'STKAITI' #åæ–‡æ¥·ä½“</span>
rcParams<span class="hljs-section">['font.sans-serif']</span> ='STKAITI' <span class="hljs-comment">#åæ–‡æ¥·ä½“</span>
<span class="hljs-comment"># åˆ›å»ºå›¾è¡¨ï¼Œè®¾ç½®å¤§å°</span>
plt.figure(<span class="hljs-attr">figsize</span>=(<span class="hljs-number">10</span>,<span class="hljs-number">8</span>))
<span class="hljs-comment"># è¦ç»˜å›¾çš„æ•°æ®</span>
<span class="hljs-attr">x</span>=[]
<span class="hljs-attr">y</span>=[]
for i in range (1000):
    <span class="hljs-attr">tmp</span>=random.uniform(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>)
    x.append(tmp)
    y.append(2*tmp+random.gauss(0,2))
<span class="hljs-comment"># ç»˜åˆ¶æ•£ç‚¹å›¾</span>
plt.scatter(x,y,<span class="hljs-attr">color</span>=<span class="hljs-string">'blue'</span>,alpha=<span class="hljs-number">0.5</span>,s=<span class="hljs-number">20</span>,label=<span class="hljs-string">"æ•°æ®"</span>)
<span class="hljs-comment"># æ·»åŠ æ ‡é¢˜</span>
plt.title('xå˜é‡ä¸yå˜é‡çš„å…³ç³»',<span class="hljs-attr">color</span>=<span class="hljs-string">'red'</span>,fontsize=<span class="hljs-number">20</span>)
<span class="hljs-comment"># æ·»åŠ åæ ‡è½´æ ‡ç­¾</span>
plt.xlabel('xè‡ªå˜é‡',<span class="hljs-attr">fontsize</span>=<span class="hljs-number">10</span>)
plt.ylabel('yå› å˜é‡',<span class="hljs-attr">fontsize</span>=<span class="hljs-number">10</span>)
<span class="hljs-comment"># æ·»åŠ å›¾ä¾‹</span>
plt.legend(<span class="hljs-attr">loc</span>=<span class="hljs-string">'upper left'</span>)
<span class="hljs-comment"># æ·»åŠ ç½‘æ ¼çº¿</span>
plt.grid(True,<span class="hljs-attr">alpha</span>=<span class="hljs-number">0.1</span>,color=<span class="hljs-string">'blue'</span>,linestyle=<span class="hljs-string">'--'</span>) <span class="hljs-comment"># '-':å®çº¿ ï¼›'--'ï¼šè™šçº¿</span>
<span class="hljs-comment"># plt.grid(axis='x')</span>
<span class="hljs-comment"># è®¾ç½®åˆ»åº¦å­—ä½“å¤§å°</span>
plt.xticks(<span class="hljs-attr">rotation</span>=<span class="hljs-number">20</span>,fontsize=<span class="hljs-number">12</span>)
plt.yticks(<span class="hljs-attr">rotation</span>=<span class="hljs-number">0</span>,fontsize=<span class="hljs-number">12</span>)
<span class="hljs-comment"># è®¾ç½®yè½´çš„èŒƒå›´</span>
plt.ylim(0,30)
plt.plot(<span class="hljs-section">[0,10]</span>,<span class="hljs-section">[0,20]</span>,<span class="hljs-attr">color</span>=<span class="hljs-string">'orange'</span>,linewidth=<span class="hljs-number">3</span>,linestyle=<span class="hljs-string">'--'</span>)
<span class="hljs-comment"># æ˜¾ç¤ºå›¾è¡¨</span>
plt.show()
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/78de9218511548dfa886c1935c8d1aa4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770130071&amp;x-signature=Z035P5k1RdtAyXAis4Zwk2wPhiU%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-19">ç®±çº¿å›¾</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ç»˜åˆ¶ç®±çº¿å›¾</span>
import matplotlib.pyplot as plt
from matplotlib import rcParams <span class="hljs-comment"># å­—ä½“</span>
<span class="hljs-comment">#rcParams['font.family'] = 'STKAITI' #åæ–‡æ¥·ä½“</span>
rcParams<span class="hljs-section">['font.sans-serif']</span> ='STKAITI' <span class="hljs-comment">#åæ–‡æ¥·ä½“</span>
<span class="hljs-comment"># åˆ›å»ºå›¾è¡¨ï¼Œè®¾ç½®å¤§å°</span>
plt.figure(<span class="hljs-attr">figsize</span>=(<span class="hljs-number">8</span>,<span class="hljs-number">6</span>))
<span class="hljs-comment"># è¦ç»˜å›¾çš„æ•°æ®</span>
<span class="hljs-attr">data</span> ={
    'è¯­æ–‡':<span class="hljs-section">[82,85,88,70,90,76,84, 83,95]</span>,
    'æ•°å­¦':<span class="hljs-section">[75,80,79,93,88,82,87,89,92]</span>,
    'è‹±è¯­':<span class="hljs-section">[70,72,68,65,78,80,85,90,95]</span>
}
<span class="hljs-comment"># ç»˜åˆ¶æ•£ç‚¹å›¾</span>
plt.boxplot(data.values(),<span class="hljs-attr">tick_labels</span>=data.keys())
<span class="hljs-comment"># æ·»åŠ æ ‡é¢˜</span>
plt.title('å„ç§‘æˆç»©åˆ†å¸ƒ(ç®±çº¿å›¾)',<span class="hljs-attr">color</span>=<span class="hljs-string">'red'</span>,fontsize=<span class="hljs-number">20</span>)
<span class="hljs-comment"># æ·»åŠ åæ ‡è½´æ ‡ç­¾</span>
plt.ylabel('åˆ†æ•°',<span class="hljs-attr">fontsize</span>=<span class="hljs-number">10</span>)
<span class="hljs-comment"># æ·»åŠ ç½‘æ ¼çº¿</span>
plt.grid(True,<span class="hljs-attr">alpha</span>=<span class="hljs-number">0.1</span>,color=<span class="hljs-string">'blue'</span>,linestyle=<span class="hljs-string">'--'</span>) <span class="hljs-comment"># '-':å®çº¿ ï¼›'--'ï¼šè™šçº¿</span>
<span class="hljs-comment"># plt.grid(axis='x')</span>
<span class="hljs-comment"># æ˜¾ç¤ºå›¾è¡¨</span>
plt.show()
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4113bee7cc2f42409992483585616d62~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770130071&amp;x-signature=0wYGyz88Rvj1LYvN7jdNSibUR3M%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-20">å¤šä¸ªå›¾</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å¤šä¸ªå›¾çš„ç»˜åˆ¶æ–¹æ³•</span>
import matplotlib.pyplot as plt
<span class="hljs-comment"># è¦ç»˜å›¾çš„æ•°æ®</span>
<span class="hljs-attr">month</span> = [<span class="hljs-string">'1'</span>, <span class="hljs-string">'2'</span> , <span class="hljs-string">'3'</span> , <span class="hljs-string">'4'</span> ]
<span class="hljs-attr">sales</span> = [<span class="hljs-number">100</span>,<span class="hljs-number">150</span>, <span class="hljs-number">80</span>, <span class="hljs-number">130</span>]
<span class="hljs-attr">f1</span> = plt.subplot(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>)<span class="hljs-comment"># ç”Ÿæˆä¸€ä¸ªå­å›¾ï¼Œè¡Œ åˆ— ç´¢å¼•ï¼ˆé€—å·å¯çœç•¥ï¼‰</span>
f1.plot(month,sales)
<span class="hljs-attr">f2</span>= plt.subplot(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>)
f2.bar(month,sales)
<span class="hljs-attr">f3</span>= plt.subplot(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>)
f3.scatter(month,sales)
<span class="hljs-attr">f4</span>= plt.subplot(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>)
f4.barh(month,sales)
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f9bccc89c073425c88e8b423ab6e91af~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770130071&amp;x-signature=eturYDPPCCnL5UKVM9amHDhL2pc%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-21">ï¼ˆäºŒï¼‰ seaborn</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-comment"># è®¾ç½®ä¸­æ–‡å­—ä½“ï¼ˆå¯é€‰ï¼Œè‹±æ–‡ç¯å¢ƒä¸‹å¯æ³¨é‡Šæ‰ï¼‰</span>
plt.rcParams[<span class="hljs-string">"font.sans-serif"</span>] = [<span class="hljs-string">"STKAITI"</span>]
<span class="hljs-comment"># åŸå§‹æ•°æ®</span>
data = {
    <span class="hljs-string">'Physics'</span>:   [<span class="hljs-number">78</span>, <span class="hljs-number">85</span>, <span class="hljs-number">92</span>, <span class="hljs-number">68</span>, <span class="hljs-number">88</span>, <span class="hljs-number">80</span>, <span class="hljs-number">94</span>, <span class="hljs-number">73</span>, <span class="hljs-number">87</span>],
    <span class="hljs-string">'Chemistry'</span>: [<span class="hljs-number">82</span>, <span class="hljs-number">76</span>, <span class="hljs-number">89</span>, <span class="hljs-number">71</span>, <span class="hljs-number">93</span>, <span class="hljs-number">85</span>, <span class="hljs-number">79</span>, <span class="hljs-number">88</span>, <span class="hljs-number">91</span>],
    <span class="hljs-string">'Biology'</span>:   [<span class="hljs-number">85</span>, <span class="hljs-number">90</span>, <span class="hljs-number">77</span>, <span class="hljs-number">72</span>, <span class="hljs-number">84</span>, <span class="hljs-number">89</span>, <span class="hljs-number">93</span>, <span class="hljs-number">76</span>, <span class="hljs-number">82</span>]
}
<span class="hljs-comment"># è½¬ä¸º DataFrame</span>
df = pd.DataFrame(data)
</code></pre>
<h4 data-id="heading-22">ç›´æ–¹å›¾</h4>
<pre><code class="hljs language-bash" lang="bash">sns.histplot(data=<span class="hljs-built_in">df</span>, x=<span class="hljs-string">'Physics'</span>)
plt.title(<span class="hljs-string">'Histogram of Physics Scores'</span>)
plt.show()
</code></pre>
<h4 data-id="heading-23">æ ¸å¯†åº¦ä¼°è®¡å›¾</h4>
<p>æ ¸å¯†åº¦ä¼°è®¡å›¾(KDE,Kernel Density Estimate PLot)æ˜¯ä¸€ç§ç”¨äºæ˜¾ç¤ºæ•°æ®åˆ†å¸ƒçš„ç»Ÿè®¡å›¾è¡¨,å®ƒé€šè¿‡å¹³æ»‘ç›´æ–¹å›¾çš„æ–¹æ³•æ¥ä¼°è®¡æ•°æ®çš„æ¦‚ç‡å¯†åº¦å‡½æ•°,ä½¿å¾—åˆ†å¸ƒå›¾çœ‹èµ·æ¥æ›´åŠ è¿ç»­å’Œå¹³æ»‘ã€‚æ ¸å¯†åº¦ä¼°è®¡æ˜¯ä¸€ç§éå‚æ•°æ–¹æ³•,ç”¨äºä¼°è®¡éšæœºå˜é‡çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ã€‚å…¶åŸºæœ¬æ€æƒ³æ˜¯,å°†æ¯ä¸ªæ•°æ®ç‚¹è§†ä¸ºä¸€ä¸ªâ€œæ ¸â€(é€šå¸¸æ˜¯é«˜æ–¯åˆ†å¸ƒ),ç„¶åå°†è¿™äº›æ ¸çš„è´¡çŒ®ç›¸åŠ ä»¥å½¢æˆå¹³æ»‘çš„å¯†åº¦æ›²çº¿ã€‚ #ç»˜åˆ¶å–™é•¿åº¦çš„æ ¸å¯†åº¦ä¼°è®¡å›¾</p>
<pre><code class="hljs language-ini" lang="ini">sns.kdeplot(<span class="hljs-attr">data</span>=data, x=<span class="hljs-string">"Physics"</span>)
</code></pre>

<pre><code class="hljs language-ini" lang="ini">sns.histplot(<span class="hljs-attr">data</span>=data, x=<span class="hljs-string">"Physics"</span>,kde=<span class="hljs-literal">True</span>)
</code></pre>
<h4 data-id="heading-24">è®¡æ•°å›¾</h4>
<p>è®¡æ•°å›¾ç”¨äºç»˜åˆ¶åˆ†ç±»å˜é‡çš„è®¡æ•°åˆ†å¸ƒå›¾,æ˜¾ç¤ºæ¯ä¸ªç±»åˆ«åœ¨æ•°æ®é›†ä¸­å‡ºç°çš„æ¬¡æ•°,æ˜¯åˆ†æåˆ†ç±»æ•°æ®éå¸¸ç›´è§‚çš„å·¥å…·,å¯ä»¥å¿«é€Ÿäº†è§£ç±»åˆ«çš„åˆ†å¸ƒæƒ…å†µã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å°† Physics åˆ†æ•°è¿›è¡Œåˆ†ç®±å¤„ç†ï¼Œè½¬æ¢ä¸ºåˆ†ç±»å˜é‡</span>
<span class="hljs-attr">bins</span> = [<span class="hljs-number">0</span>, <span class="hljs-number">60</span>, <span class="hljs-number">70</span>, <span class="hljs-number">80</span>, <span class="hljs-number">90</span>, <span class="hljs-number">100</span>] <span class="hljs-comment"># è‡ªå®šä¹‰åˆ†åŒº</span>
<span class="hljs-attr">labels</span> = [<span class="hljs-string">'0-60'</span>, <span class="hljs-string">'60-70'</span>, <span class="hljs-string">'70-80'</span>, <span class="hljs-string">'80-90'</span>, <span class="hljs-string">'90-100'</span>]
df<span class="hljs-section">['Physics_Bins']</span> = pd.cut(df<span class="hljs-section">['Physics']</span>, <span class="hljs-attr">bins</span>=bins, labels=labels, right=<span class="hljs-literal">False</span>)
<span class="hljs-comment">#ç»˜åˆ¶ä¸åŒæ•°é‡çš„è®¡æ•°å›¾</span>
sns.countplot(<span class="hljs-attr">data</span>=df, x=<span class="hljs-string">"Physics_Bins"</span>)
</code></pre>
<h4 data-id="heading-25">æ•£ç‚¹å›¾</h4>
<pre><code class="hljs language-bash" lang="bash">data_long = {
    <span class="hljs-string">'subject'</span>: [<span class="hljs-string">'Physics'</span>, <span class="hljs-string">'Chemistry'</span>, <span class="hljs-string">'Biology'</span>] * 9,
    <span class="hljs-string">'score'</span>: [
        78, 82, 85,
        85, 76, 90,
        92, 89, 77,
        68, 71, 72,
        88, 93, 84,
        80, 85, 89,
        94, 79, 93,
        73, 88, 76,
        87, 91, 82
    ],
    <span class="hljs-string">'student_group'</span>: [<span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>,
                      <span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>,
                      <span class="hljs-string">'B'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'B'</span>,
                      <span class="hljs-string">'B'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'B'</span>,
                      <span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>,
                      <span class="hljs-string">'B'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'B'</span>,
                      <span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>,
                      <span class="hljs-string">'B'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'B'</span>,
                      <span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>]
}

<span class="hljs-built_in">df</span> = pd.DataFrame(data_long)
<span class="hljs-comment">#ç»˜åˆ¶æ¨ªè½´ä¸ºç§‘ç›®,çºµè½´ä¸ºæˆç»©çš„æ•£ç‚¹å›¾ã€‚å¯é€šè¿‡hueå‚æ•°è®¾ç½®ä¸åŒç»„åˆ«è¿›è¡Œå¯¹æ¯”ã€‚</span>
sns.scatterplot(data=<span class="hljs-built_in">df</span>, x=<span class="hljs-string">"subject"</span>, y=<span class="hljs-string">"score"</span>, hue=<span class="hljs-string">"student_group"</span>)
</code></pre>
<h4 data-id="heading-26">èœ‚çªå›¾</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#é€šè¿‡jointplot()å‡½æ•°,è®¾ç½®kind="hex"æ¥ç»˜åˆ¶èœ‚çªå›¾ã€‚</span>
sns.jointplot (<span class="hljs-attr">data</span>=data, x=<span class="hljs-string">"Physics"</span>, y=<span class="hljs-string">"Chemistry"</span>, kind=<span class="hljs-string">"hex"</span>)
</code></pre>
<h4 data-id="heading-27">äºŒç»´æ ¸å¯†åº¦ä¼°è®¡å›¾</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#é€šè¿‡kdeplot()å‡½æ•°,åŒæ—¶è®¾ç½®xå‚æ•°å’Œyå‚æ•°æ¥ç»˜åˆ¶äºŒç»´æ ¸å¯†åº¦ä¼°è®¡å›¾ã€‚</span>
sns.kdeplot(<span class="hljs-attr">data</span>=penguins, x=<span class="hljs-string">"body_mass_g"</span>, y=<span class="hljs-string">"flipper_length_mm"</span>)
<span class="hljs-comment">#é€šè¿‡fill=Trueè®¾ç½®ä¸ºå¡«å……,é€šè¿‡cbar=Trueè®¾ç½®æ˜¾ç¤ºé¢œè‰²ç¤ºæ„æ¡ã€‚</span>
sns.kdeplot(<span class="hljs-attr">data</span>=penguins, x=<span class="hljs-string">"body_mass_g"</span>, y=<span class="hljs-string">"flipper_length_mm"</span>,fill=<span class="hljs-literal">True</span>, cbar=<span class="hljs-literal">True</span>)
</code></pre>
<h4 data-id="heading-28">æ¡å½¢å›¾</h4>
<pre><code class="hljs language-ini" lang="ini">sns.barplot(<span class="hljs-attr">data</span>=penguins, x=<span class="hljs-string">"species"</span>, y=<span class="hljs-string">"bill_length_mm"</span>,estimator=<span class="hljs-string">"mean"</span>, errorbar=None)
</code></pre>
<h4 data-id="heading-29">ç®±çº¿å›¾</h4>
<pre><code class="hljs language-ini" lang="ini">sns.boxplot(<span class="hljs-attr">data</span>=penguins, x=<span class="hljs-string">"species"</span>, y=<span class="hljs-string">"bill_length_mm"</span>)
</code></pre>
<h4 data-id="heading-30">å°æç´å›¾</h4>
<p>å°æç´å›¾(Violin Plot)æ˜¯ä¸€ç§ç»“åˆäº†ç®±çº¿å›¾å’Œæ ¸å¯†åº¦ä¼°è®¡å›¾(KDE)çš„å¯è§†åŒ–å›¾è¡¨,ç”¨äºå±•ç¤ºæ•°æ®çš„åˆ†å¸ƒæƒ…å†µã€é›†ä¸­è¶‹åŠ¿ã€æ•£å¸ƒæƒ…å†µä»¥åŠå¼‚å¸¸å€¼ã€‚å°æç´å›¾ä¸ä»…å¯ä»¥æ˜¾ç¤ºæ•°æ®çš„åŸºæœ¬ç»Ÿè®¡é‡(å¦‚ä¸­ä½æ•°å’Œå››åˆ†ä½æ•°),è¿˜å¯ä»¥å±•ç¤ºæ•°æ®çš„æ¦‚ç‡å¯†åº¦,æä¾›æ¯”ç®±çº¿å›¾æ›´ä¸°å¯Œçš„ä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">sns.violinplot(<span class="hljs-attr">data</span>=penguins, x=<span class="hljs-string">"species"</span>, y=<span class="hljs-string">"bill_length_mm"</span>)
</code></pre>
<h4 data-id="heading-31">æˆå¯¹å…³ç³»å›¾</h4>
<p>æˆå¯¹å…³ç³»å›¾æ˜¯ä¸€ç§ç”¨äºæ˜¾ç¤ºå¤šä¸ªå˜é‡ä¹‹é—´å…³ç³»çš„å¯è§†åŒ–å·¥å…·ã€‚å®ƒå¯ä»¥å±•ç¤ºå„ä¸ªå˜é‡ä¹‹é—´çš„æˆå¯¹å…³ç³»,å¹¶ä¸”é€šè¿‡ä¸åŒçš„å›¾è¡¨å½¢å¼å¸®åŠ©æˆ‘ä»¬ç†è§£æ•°æ®ä¸­å„ä¸ªå˜é‡ä¹‹é—´çš„ç›¸äº’ä½œç”¨ã€‚å¯¹è§’çº¿ä¸Šçš„å›¾é€šå¸¸æ˜¾ç¤ºæ¯ä¸ªå˜é‡çš„åˆ†å¸ƒ(å¦‚ç›´æ–¹å›¾æˆ–æ ¸å¯†åº¦ä¼°è®¡å›¾),å¸®åŠ©è§‚å¯Ÿæ¯ä¸ªå˜é‡çš„å•å˜é‡ç‰¹æ€§ã€‚å…¶ä»–ä½ç½®å±•ç¤ºæ‰€æœ‰å˜é‡çš„ä¸¤ä¸¤å…³ç³»,ç”¨æ•£ç‚¹å›¾è¡¨ç¤ºã€‚</p>
<pre><code class="hljs language-ini" lang="ini">sns.pairplot(<span class="hljs-attr">data</span>=penguins, hue=<span class="hljs-string">"species"</span>)
</code></pre>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Autowired å’Œ Resource çš„åŒºåˆ«]]></title>    <link>https://juejin.cn/post/7599868109085524010</link>    <guid>https://juejin.cn/post/7599868109085524010</guid>    <pubDate>2026-01-27T15:06:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599868109085524010" data-draft-id="7599868109085507626" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Autowired å’Œ Resource çš„åŒºåˆ«"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-27T15:06:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å’ªåº“å’ªåº“å’ª"/> <meta itemprop="url" content="https://juejin.cn/user/3725578141445959"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Autowired å’Œ Resource çš„åŒºåˆ«
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3725578141445959/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å’ªåº“å’ªåº“å’ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T15:06:27.000Z" title="Tue Jan 27 2026 15:06:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong><code>@Autowired</code>ï¼šæ¥è‡ªSpring ï¼Œé»˜è®¤æŒ‰â€œç±»å‹â€æ³¨å…¥</strong><br/>
<strong><code>@Resource</code>ï¼šJava æ ‡å‡†æ³¨è§£ï¼Œé»˜è®¤æŒ‰â€œåå­—â€æ³¨å…¥</strong></p>
<h2 data-id="heading-0">Autowired-&gt; æŒ‰ç±»å‹</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> UserService userService;
</code></pre>
<p>Spring ä¼šæ‰¾ï¼šå®¹å™¨é‡Œ <strong>ç±»å‹æ˜¯ <code>UserService</code> çš„ Bean</strong></p>
<p>å¦‚æœæœ‰å¤šä¸ªåŒç±»å‹çš„Beanå°±ä¼šæŠ¥é”™ï¼Œè¿™æ—¶å¿…é¡»é…åˆï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Qualifier("userServiceImpl1")</span>
<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> UserService userService;
</code></pre>
<h2 data-id="heading-1">@Resource -&gt; æŒ‰åç§°</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Resource</span>
<span class="hljs-keyword">private</span> UserService userService;
</code></pre>
<p>Spring ä¼šï¼š</p>
<ol>
<li>å…ˆæŒ‰ <strong>å˜é‡å <code>userService</code></strong> æ‰¾ Bean</li>
<li>æ‰¾ä¸åˆ° â†’ å†æŒ‰ <strong>ç±»å‹</strong> æ‰¾</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»£ç çµå¼‚äº‹ä»¶ï¼šä¸ºä»€ä¹ˆç”¨ get() èƒ½å–åˆ°å€¼ï¼Œæ¢æˆ getProperty() å°±å˜æˆäº† nullï¼Ÿ]]></title>    <link>https://juejin.cn/post/7599835610406928430</link>    <guid>https://juejin.cn/post/7599835610406928430</guid>    <pubDate>2026-01-27T15:34:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599835610406928430" data-draft-id="7599835610406912046" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»£ç çµå¼‚äº‹ä»¶ï¼šä¸ºä»€ä¹ˆç”¨ get() èƒ½å–åˆ°å€¼ï¼Œæ¢æˆ getProperty() å°±å˜æˆäº† nullï¼Ÿ"/> <meta itemprop="keywords" content="é¢è¯•,Java"/> <meta itemprop="datePublished" content="2026-01-27T15:34:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Re_zero"/> <meta itemprop="url" content="https://juejin.cn/user/2965821818672144"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»£ç çµå¼‚äº‹ä»¶ï¼šä¸ºä»€ä¹ˆç”¨ get() èƒ½å–åˆ°å€¼ï¼Œæ¢æˆ getProperty() å°±å˜æˆäº† nullï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2965821818672144/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Re_zero
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T15:34:34.000Z" title="Tue Jan 27 2026 15:34:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>#Java #æºç åˆ†æ #é¿å‘æŒ‡å— #é¢è¯•é¢˜</p>
<blockquote>
<p><strong>æ‘˜è¦</strong>ï¼š</p>
<p>æ˜æ˜å‘ <code>Properties</code> ä¸­å­˜å…¥äº†æ•°å€¼ï¼Œç”¨ <code>get()</code> æ¢å¯»æ—¶å®ƒå°šåœ¨ï¼Œæ¢ä½œ <code>getProperty()</code> å´å‡­ç©ºæ¶ˆå¤±ï¼Œåªè¿”è¿˜ä¸€ä¸ªå†·å†°å†°çš„ <code>null</code>ã€‚ è¿™å¹¶é JDK çš„ Bugï¼Œä¹Ÿä¸æ˜¯ä»€ä¹ˆç„å­¦ã€‚æœ¬æ–‡å°†ä»¥æ­¤ä¸ºå¼•ï¼Œæ‹¨å¼€ <code>java.util.Properties</code> çš„æºç è¿·é›¾ï¼Œä¸€æ¢è¿™æ®µå› â€œç»§æ‰¿æ»¥ç”¨â€è€Œå°˜å°å·²ä¹…çš„è®¾è®¡å…¬æ¡ˆã€‚</p>
</blockquote>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ <strong>Re-Zero</strong>ã€‚</p>
<p>ä»Šå¤©åœ¨ Code Reviewï¼Œæˆ‘è§åˆ°äº†ä¸€æ®µè¶³ä»¥å†™å…¥ã€ŠJava è¿·æƒ‘è¡Œä¸ºå¤§èµã€‹çš„ä»£ç ï¼šæŸä½å…„å¼Ÿå›¾çœäº‹ï¼Œç›´æ¥ç”¨ <code>put</code> æ–¹æ³•æŠŠæ•°å­—å¾€ <code>Properties</code> å¯¹è±¡é‡Œå¡ï¼Œå–çš„æ—¶å€™å´é­é‡â€œå·¦å³æ‰‹äº’æâ€â€”â€”ä¸€åªæ‰‹èƒ½æ‹¿åˆ°ï¼Œå¦ä¸€åªæ‰‹å´æ‘¸äº†ä¸ªç©ºã€‚</p>
<p>å’±ä»¬æ¥è¿˜åŸä¸€ä¸‹è¿™ä¸ªè®©æ–°æ‰‹æ‘¸ä¸ç€å¤´è„‘çš„â€œçµå¼‚ç°åœºâ€ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ æ¡ˆå‘ç°åœºï¼šä¸€æ¬¡æŠ•å¸ï¼Œä¸¤ç§äººç”Ÿ</h2>
<p>æˆ‘ä»¬å†™ä¸€æ®µæœ€ç®€å•çš„æµ‹è¯•ä»£ç ï¼š</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-type">Properties</span> <span class="hljs-variable">props</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Properties</span>();

<span class="hljs-comment">// 1. æ³¨æ„ï¼šä¸ºäº†çœäº‹ï¼Œè¿™é‡Œç›´æ¥å­˜äº†ä¸ªæ•´æ•° 88</span>
<span class="hljs-comment">// è¿™é‡Œçš„ 88 æ˜¯ Integer ç±»å‹ï¼Œä¸æ˜¯ String</span>
props.put(<span class="hljs-string">"timeout"</span>, <span class="hljs-number">88</span>); 

<span class="hljs-comment">// 2. ä½¿ç”¨ Map åŸç”Ÿçš„ get() æ–¹æ³•</span>
System.out.println(<span class="hljs-string">"get: "</span> + props.get(<span class="hljs-string">"timeout"</span>)); 

<span class="hljs-comment">// 3. ä½¿ç”¨ Properties ä¸“å±çš„ getProperty() æ–¹æ³•</span>
System.out.println(<span class="hljs-string">"getProperty: "</span> + props.getProperty(<span class="hljs-string">"timeout"</span>));
</code></pre>
<p>æŒ‰ç…§æ­£å¸¸é€»è¾‘ï¼Œè¿™å°±å¥½æ¯”ä½ å¾€é’±åŒ…é‡Œå¡äº†ä¸€å¼ é’±ï¼Œç”¨å·¦æ‰‹æå‡ºæ¥æ˜¯é’±ï¼Œç”¨å³æ‰‹æå‡ºæ¥åº”è¯¥æ˜¯ç©ºæ°”å—ï¼Ÿæ˜¾ç„¶ä¸åˆç†ã€‚</p>
<p>ä½† Java ååå°±ç»™ä½ å˜äº†ä¸ªé­”æœ¯ï¼Œè¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-Plaintext" lang="Plaintext">get: 88
getProperty: null   &lt;-- è§é¬¼äº†?!
</code></pre>
<p>æ˜æ˜æ•°æ®å°±åœ¨é‡Œé¢ï¼Œç”¨ <code>get</code> éƒ½èƒ½æ‹¿åˆ°ï¼Œå‡­ä»€ä¹ˆ <code>getProperty</code> å°±è§†è€Œä¸è§ï¼Ÿéš¾é“å®ƒè¿˜æ­§è§†æ•´æ•°ï¼Ÿ</p>
<hr/>
<h2 data-id="heading-1">äºŒã€ æºç è§£å‰–ï¼šå¯»æ‰¾å¤±è½çš„çœŸç›¸</h2>
<p>ä¸ºäº†ææ¸…æ¥šåŸå› ï¼Œæˆ‘ä»¬ç›´æ¥ç‚¹å¼€ <code>java.util.Properties</code> çš„æºç ï¼Œçœ‹çœ‹ <code>getProperty</code> åˆ°åº•èƒŒç€æˆ‘ä»¬å¹²äº†ä»€ä¹ˆã€‚</p>
<p>ä»£ç éå¸¸çŸ­ï¼Œä½†æ¯ä¸€è¡Œéƒ½è—ç€å¿ƒçœ¼ï¼š</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-keyword">public</span> String <span class="hljs-title function_">getProperty</span><span class="hljs-params">(String key)</span> {
    <span class="hljs-comment">// 1. å…ˆè°ƒç”¨çˆ¶ç±» (Hashtable) çš„ get æ–¹æ³•ï¼Œæ‹¿åˆ° value</span>
    <span class="hljs-type">Object</span> <span class="hljs-variable">oval</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">super</span>.get(key);
    
    <span class="hljs-comment">// 2. å…³é”®åˆ¤å†³ï¼</span>
    <span class="hljs-comment">// æ£€æŸ¥æ‹¿åˆ°çš„ value æ˜¯ä¸æ˜¯ String ç±»å‹</span>
    <span class="hljs-comment">// å¦‚æœæ˜¯ Stringï¼Œå¼ºè½¬ï¼›å¦‚æœä¸æ˜¯ï¼Œsval ç›´æ¥ç½®ä¸º null</span>
    <span class="hljs-type">String</span> <span class="hljs-variable">sval</span> <span class="hljs-operator">=</span> (oval <span class="hljs-keyword">instanceof</span> String) ? (String)oval : <span class="hljs-literal">null</span>;
    
    <span class="hljs-comment">// 3. å…œåº•é€»è¾‘ï¼šå¦‚æœæ˜¯ nullï¼Œä¸”å­˜åœ¨é»˜è®¤é…ç½®é›† (defaults)ï¼Œåˆ™å»é»˜è®¤é›†é‡Œæ‰¾</span>
    <span class="hljs-keyword">return</span> ((sval == <span class="hljs-literal">null</span>) &amp;&amp; (defaults != <span class="hljs-literal">null</span>)) ? defaults.getProperty(key) : sval;
}
</code></pre>
<p><strong>ç ´æ¡ˆäº†ï¼Œå‡¶æ‰‹å°±æ˜¯è¿™è¡Œä»£ç ï¼š</strong></p>
<p><code>String sval = (oval instanceof String) ? (String)oval : null;</code></p>
<p><code>getProperty</code> æ–¹æ³•æ˜¯ä¸€ä¸ªæœ‰ç€ä¸¥é‡<strong>ç±»å‹æ´ç™–</strong>çš„æ–¹æ³•ï¼š</p>
<ol>
<li>
<p>å®ƒå¼ºåˆ¶è¦æ±‚ï¼š<strong>Key å’Œ Value å¿…é¡»éƒ½æ˜¯ <code>String</code> ç±»å‹</strong>ã€‚</p>
</li>
<li>
<p>åœ¨æˆ‘ä»¬çš„æ¡ˆä¾‹ä¸­ï¼Œå­˜å…¥çš„æ˜¯ <code>Integer</code> ç±»å‹çš„ <code>88</code>ã€‚</p>
</li>
<li>
<p><code>oval instanceof String</code> åˆ¤å®šä¸ºå‡ã€‚</p>
</li>
<li>
<p>æ‰€ä»¥å˜é‡ <code>sval</code> è¢«æ— æƒ…åœ°èµ‹å€¼ä¸º <code>null</code>ã€‚</p>
</li>
</ol>
<p>é‚£ä¸ºä»€ä¹ˆæ™®é€šçš„ <code>get()</code> æ–¹æ³•èƒ½æ‹¿åˆ°å‘¢ï¼Ÿ</p>
<p>å› ä¸ºå®ƒæ˜¯ä¸ªâ€œè€å¥½äººâ€ã€‚<code>Properties</code> ç»§æ‰¿è‡ª <code>Hashtable</code>ï¼Œ<code>get()</code> æ–¹æ³•æ˜¯çˆ¶ç±»çš„ï¼Œç­¾åæ˜¯ <code>Object get(Object key)</code>ã€‚åœ¨å®ƒçœ¼é‡Œï¼Œä¼—ç”Ÿå¹³ç­‰ï¼Œä¸ç®¡ä½ å­˜çš„æ˜¯å­—ç¬¦ä¸²è¿˜æ˜¯æ•´æ•°ï¼Œå®ƒéƒ½åŸæ ·ç»™ä½ åå‡ºæ¥ã€‚</p>
<hr/>
<h2 data-id="heading-2">ä¸‰ã€ ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¸ªå‘ï¼Ÿ</h2>
<p>ä½ å¯èƒ½ä¼šé—®ï¼šæ—¢ç„¶ <strong><code>Properties</code> æ˜¯ä¸“é—¨ç”¨æ¥å¤„ç†å­—ç¬¦ä¸²é…ç½®æ–‡ä»¶</strong>çš„ï¼Œä¸ºä»€ä¹ˆ Java è¿˜è¦å…è®¸æˆ‘ä»¬å¾€é‡Œé¢ <code>put</code> æ•´æ•°å‘¢ï¼Ÿç›´æ¥æŠ¥é”™ä¸å¥½å—ï¼Ÿ</p>
<p>è¿™å°±å¾—èŠèŠ Java æ—©æœŸçš„â€œé»‘å†å²â€äº†ã€‚</p>
<p><code>Properties</code> ç±»å‡ºç°å¾—éå¸¸æ—©ï¼ˆJDK 1.0ï¼‰ã€‚åœ¨é‚£ä¸ªä¸Šå¤æ—¶ä»£ï¼ŒJava çš„è®¾è®¡è€…ä¸ºäº†å°‘å†™å‡ è¡Œä»£ç ï¼Œå¼ºè¡Œè®© <code>Properties</code> <strong>ç»§æ‰¿</strong> äº† <code>Hashtable</code>ã€‚</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Properties</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Hashtable</span>&lt;Object,Object&gt; { ... }
</code></pre>
<p>è¿™å°±å¥½æ¯”è®©ä¸€ä¸ªæ–‡å¼±ä¹¦ç”Ÿï¼ˆPropertiesï¼‰ï¼Œç›´æ¥ç»§æ‰¿äº†å± å¤«ï¼ˆHashtableï¼‰çš„æŠ€èƒ½æ ‘ã€‚è™½ç„¶ä¹¦ç”Ÿçš„æœ¬èŒå·¥ä½œæ˜¯å†™å­—ï¼Œä½†ä»–ç¡®å®ä»ä»–çˆ¹é‚£é‡Œç»§æ‰¿äº†â€œæ€çŒªâ€çš„æœ¬äº‹â€”â€”è™½ç„¶èƒ½ç”¨ï¼Œä½†æ€ä¹ˆçœ‹æ€ä¹ˆåˆ«æ‰­ã€‚</p>
<p>è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„â€œ<strong>ç»„åˆä¼˜äºç»§æ‰¿</strong>â€åŸåˆ™çš„åé¢æ•™æã€‚å¦‚æœå½“æ—¶é‡‡ç”¨ç»„åˆæ¨¡å¼ï¼ˆProperties å†…éƒ¨æŒæœ‰ä¸€ä¸ª Mapï¼‰ï¼Œå°±ä¸ä¼šæš´éœ² <code>put</code> æ–¹æ³•ç»™ç”¨æˆ·ï¼Œä¹Ÿå°±ä¸ä¼šæœ‰ä»Šå¤©è¿™ä¸ªå‘äº†ã€‚</p>
<hr/>
<h2 data-id="heading-3">å››ã€ æœ€ä½³å®è·µ â€”â€” Properties æŒ‡å—</h2>
<p>æ—¢ç„¶çŸ¥é“å‘åœ¨å“ªï¼Œæ€ä¹ˆé¿å‘å°±å¾ˆç®€å•äº†ã€‚è¯·ä¸¥æ ¼éµå®ˆä»¥ä¸‹å¼€å‘è§„èŒƒï¼š</p>
<h3 data-id="heading-4">1. æ‹‰é»‘ put å’Œ get</h3>
<p>åœ¨æ“ä½œ <code>Properties</code> å¯¹è±¡æ—¶ï¼Œå°½é‡ä¸è¦ä½¿ç”¨è¿™ä¸¤ä¸ªä»çˆ¶ç±»ç»§æ‰¿æ¥çš„æ–¹æ³•ã€‚å®ƒä»¬æ˜¯ç»™ Hashtable ç”¨çš„ï¼Œä¸æ˜¯ç»™ä½ ç”¨çš„ã€‚</p>
<h3 data-id="heading-5">2. é”æ­» setProperty å’Œ getProperty</h3>
<p>JDK ä¸“é—¨æä¾›äº†ç±»å‹å®‰å…¨çš„æ–¹æ³•ï¼Œè¯·ä¸€å®šè¦ç”¨å®ƒä»¬ï¼š</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-comment">// æ­£ç¡®å§¿åŠ¿</span>
props.setProperty(<span class="hljs-string">"timeout"</span>, <span class="hljs-string">"88"</span>); <span class="hljs-comment">// ç¼–è¯‘å™¨ä¼šå¼ºåˆ¶è¦æ±‚ä½ ä¼ å…¥ String</span>

<span class="hljs-comment">// æ­£ç¡®è¯»å–</span>
<span class="hljs-type">String</span> <span class="hljs-variable">val</span> <span class="hljs-operator">=</span> props.getProperty(<span class="hljs-string">"timeout"</span>); <span class="hljs-comment">// æ­¤æ—¶èƒ½æ­£ç¡®è·å– "88"</span>
</code></pre>
<h3 data-id="heading-6">3. å·§ç”¨ defaultsï¼Œè®©é»˜è®¤å€¼æˆä¸ºä½ çš„ç¥åŠ©æ”»</h3>
<p>æºç æœ€åä¸€è¡Œå…¶å®è¿˜è—äº†ä¸ªå½©è›‹ï¼š</p>
<p><code>((sval == null) &amp;&amp; (defaults != null)) ? defaults.getProperty(key) : sval;</code></p>
<p>è¿™å…è®¸æˆ‘ä»¬æ„å»ºä¸€ä¸ªâ€œ<strong>é…ç½®å±‚çº§é“¾â€</strong>ã€‚æ¯”å¦‚ä½ å¯ä»¥æœ‰ä¸€ä¸ª <code>defaultProps</code> å­˜æ”¾é»˜è®¤é…ç½®ï¼Œç„¶ååˆ›å»ºä¸€ä¸ª <code>appProps</code> è¦†ç›–å®ƒã€‚å½“ä¸»é…ç½®é‡Œæ²¡å€¼æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨å»é»˜è®¤é…ç½®é‡Œæ‰¾ï¼Œéå¸¸æ–¹ä¾¿ã€‚</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-type">Properties</span> <span class="hljs-variable">defaultProps</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Properties</span>();
defaultProps.setProperty(<span class="hljs-string">"theme"</span>, <span class="hljs-string">"light"</span>); <span class="hljs-comment">// é»˜è®¤æµ…è‰²ä¸»é¢˜</span>

<span class="hljs-comment">// å°† defaultProps è®¾ä¸º appProps çš„â€œçˆ¶çº§â€</span>
<span class="hljs-type">Properties</span> <span class="hljs-variable">appProps</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Properties</span>(defaultProps); 

<span class="hljs-comment">// appProps é‡Œæ²¡é… themeï¼ŒgetProperty ä¼šè‡ªåŠ¨å» defaultProps é‡Œæ‰¾</span>
System.out.println(appProps.getProperty(<span class="hljs-string">"theme"</span>)); <span class="hljs-comment">// è¾“å‡º "light"</span>
</code></pre>
<hr/>
<h2 data-id="heading-7">äº”ã€ æ€»ç»“</h2>
<p>ä¸‹æ¬¡å†é‡åˆ° <code>getProperty</code> è¿”å› nullï¼Œå…ˆåˆ«æ€€ç–‘äººç”Ÿï¼Œæ£€æŸ¥ä¸€ä¸‹ï¼š<strong>ä½ æ˜¯ä¸æ˜¯æ‰‹æ»‘ç”¨äº† <code>put</code> å­˜äº†é String ç±»å‹çš„æ•°æ®ï¼Ÿ</strong></p>























<table><thead><tr><th><strong>æ–¹æ³•</strong></th><th><strong>æ¥æº</strong></th><th><strong>ç‰¹ç‚¹</strong></th><th><strong>æ¨èæŒ‡æ•°</strong></th></tr></thead><tbody><tr><td><strong>get()</strong></td><td>Hashtable</td><td>è¿”å› Objectï¼Œæ¥è€…ä¸æ‹’ï¼Œå®¹æ˜“åŸ‹é›·</td><td>ğŸš« ç¦æ­¢ä½¿ç”¨</td></tr><tr><td><strong>getProperty()</strong></td><td>Properties</td><td>åªè¿”å› Stringï¼Œå¸¦é»˜è®¤å€¼æŸ¥æ‰¾ï¼Œç±»å‹å®‰å…¨</td><td>âœ… å¼ºçƒˆæ¨è</td></tr></tbody></table>
<p>æ—¢ç„¶ç”¨äº† <code>Properties</code>ï¼Œå°±è¯·å°Šé‡å®ƒçš„â€œæ´ç™–â€ï¼Œåªå–‚ç»™å®ƒ <code>String</code>ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[NFT è¿›é˜¶å¼€å‘ï¼ERC6551 åœºæ™¯åº”ç”¨ + ç†è®ºä»£ç å…¨è§£æ]]></title>    <link>https://juejin.cn/post/7599634796584140806</link>    <guid>https://juejin.cn/post/7599634796584140806</guid>    <pubDate>2026-01-27T10:38:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599634796584140806" data-draft-id="7599828354515583016" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="NFT è¿›é˜¶å¼€å‘ï¼ERC6551 åœºæ™¯åº”ç”¨ + ç†è®ºä»£ç å…¨è§£æ"/> <meta itemprop="keywords" content="æ™ºèƒ½åˆçº¦,Solidity,web3"/> <meta itemprop="datePublished" content="2026-01-27T10:38:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æœ¨è¥¿"/> <meta itemprop="url" content="https://juejin.cn/user/2436173496845549"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            NFT è¿›é˜¶å¼€å‘ï¼ERC6551 åœºæ™¯åº”ç”¨ + ç†è®ºä»£ç å…¨è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2436173496845549/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æœ¨è¥¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T10:38:42.000Z" title="Tue Jan 27 2026 10:38:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<blockquote>
<p>æœ¬æ–‡å›´ç»• ERC6551 æ ‡å‡†å±•å¼€å…¨é¢æ¢³ç†ä¸å®è·µè½åœ°ï¼Œç†è®ºå±‚é¢ç³»ç»Ÿå‰–æäº†è¯¥æ ‡å‡†çš„æ ¸å¿ƒå®šä¹‰ã€æ ¸å¿ƒèƒ½åŠ›ã€è§£å†³çš„è¡Œä¸šç—›ç‚¹ã€å…¸å‹è¡Œä¸šåº”ç”¨åŠä¼˜åŠ£åŠ¿ï¼›ä»£ç è½åœ°å±‚é¢åˆ™åŸºäº Hardhat V3 å¼€å‘ç¯å¢ƒï¼Œç»“åˆ OpenZeppelin V5 ä¸ Solidity 0.8.24ï¼Œå®Œæ•´å®ç° ERC6551 æ ‡å‡†ä»å¼€å‘ã€æµ‹è¯•åˆ°éƒ¨ç½²çš„å…¨æµç¨‹ã€‚</p>
</blockquote>
<h2 data-id="heading-1">ERC6551æ ‡å‡†ç†è®ºçŸ¥è¯†æ¢³ç†</h2>
<h4 data-id="heading-2">æ¦‚è¿°</h4>
<p>ERC-6551 æ˜¯ä»¥å¤ªåŠä¸Šä¸º NFT è®¾è®¡çš„ â€œä»£å¸ç»‘å®šè´¦æˆ·ï¼ˆTBAï¼‰â€ æ ‡å‡†ï¼Œæ ¸å¿ƒæ˜¯ç»™æ¯ä¸ª ERC-721/ERC-1155 NFT åˆ†é…ç‹¬ç«‹æ™ºèƒ½åˆçº¦è´¦æˆ·ï¼Œè®© NFT èƒ½åƒç”¨æˆ·åœ°å€ä¸€æ ·æŒæœ‰èµ„äº§ã€å‘èµ·äº¤æ˜“å¹¶ç•™å­˜é“¾ä¸Šè®°å½•ï¼Œä¸”æ— éœ€ä¿®æ”¹ç°æœ‰åˆçº¦ä¸åŸºç¡€è®¾æ–½ï¼Œå®Œå…¨å‘åå…¼å®¹Ethereum Improvement Proposals</p>
<hr/>
<h4 data-id="heading-3">ä¸€ã€æ ¸å¿ƒå®šä¹‰</h4>
<p>ERC-6551 ç”± Benny Giang ç­‰äººäº 2023 å¹´æå‡ºï¼Œé€šè¿‡<strong>å•ä¾‹æ³¨å†Œè¡¨</strong>ä¸ºæ¯ä¸ª NFT ç”Ÿæˆå”¯ä¸€ã€ç¡®å®šæ€§çš„æ™ºèƒ½åˆçº¦è´¦æˆ·åœ°å€ï¼Œè´¦æˆ·æ°¸ä¹…ç»‘å®š NFTï¼Œæ§åˆ¶æƒéš NFT æ‰€æœ‰æƒè½¬ç§»è€Œè½¬ç§»Ethereum Improvement Proposalsã€‚</p>
<ul>
<li>
<p><strong>æ ¸å¿ƒç»„ä»¶</strong>ï¼š</p>
<ul>
<li>æ³¨å†Œè¡¨ï¼ˆRegistryï¼‰ï¼šè´Ÿè´£éƒ¨ç½² / å¼•ç”¨ TBAï¼Œç¡®ä¿åœ°å€ç¡®å®šæ€§ï¼ˆç”±é“¾ ID+NFT åˆçº¦åœ°å€ + Token ID è®¡ç®—å¾—å‡ºï¼‰Ethereum Improvement Proposalsã€‚</li>
<li>è´¦æˆ·å®ç°ï¼ˆAccount Implementationï¼‰ï¼šTBA çš„æœ€å°åŒ–æ™ºèƒ½åˆçº¦ï¼Œæ”¯æŒç­¾åã€äº¤æ˜“æ‰§è¡Œç­‰åŸºç¡€é’±åŒ…åŠŸèƒ½ã€‚</li>
<li>ç»‘å®šå…³ç³»ï¼šTBA ä¸ NFT ä¸€ä¸€å¯¹åº”ï¼ŒNFT æ‰€æœ‰è€…å³ TBA çš„å”¯ä¸€æ§åˆ¶äººã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h4 data-id="heading-4">äºŒã€æ ¸å¿ƒèƒ½åŠ›ï¼ˆèƒ½åšä»€ä¹ˆï¼‰</h4>





























<table><thead><tr><th>èƒ½åŠ›</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>èµ„äº§æŒæœ‰</td><td>TBA å¯å­˜å‚¨ ERC-20/ERC-721/ERC-1155 ç­‰ï¼Œå½¢æˆ â€œNFT å¥—å¨ƒâ€ï¼ˆå¦‚è§’è‰² NFT æŒæœ‰è£…å¤‡ NFTï¼‰</td></tr><tr><td>é“¾ä¸Šäº¤äº’</td><td>é€šè¿‡æ™ºèƒ½è´¦æˆ·ç­¾åä¸ DeFiã€DAOã€æ¸¸æˆç­‰ dApp ç›´æ¥äº¤äº’ï¼Œæ‰§è¡Œå€Ÿè´·ã€æŠ•ç¥¨ã€äº¤æ˜“ç­‰æ“ä½œ</td></tr><tr><td>ç‹¬ç«‹èº«ä»½</td><td>æ‹¥æœ‰ç‹¬ç«‹åœ°å€ä¸äº¤æ˜“å†å²ï¼Œä½œä¸ºé“¾ä¸Šèº«ä»½ï¼ˆå¦‚ä¼šå‘˜å‡­è¯ã€æ¸¸æˆè§’è‰²ï¼‰ï¼Œè®°å½•å®Œæ•´è¡Œä¸ºè½¨è¿¹</td></tr><tr><td>æ‰€æœ‰æƒè”åŠ¨</td><td>NFT è½¬ç§»æ—¶ï¼ŒTBA æ§åˆ¶æƒä¸èµ„äº§éšä¹‹ä¸€å¹¶è½¬ç§»ï¼Œæ— éœ€é¢å¤–æ“ä½œ</td></tr><tr><td>è·¨é“¾å…¼å®¹</td><td>æ”¯æŒå¤šé“¾éƒ¨ç½²ï¼ŒåŒä¸€ NFT å¯åœ¨ä¸åŒé“¾æ‹¥æœ‰ç‹¬ç«‹ TBAï¼Œèµ„äº§ä¸æ“ä½œäº’ä¸å½±å“Ethereum Improvement Proposals</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-5">ä¸‰ã€è§£å†³çš„è¡Œä¸šç—›ç‚¹</h4>
<ol>
<li><strong>NFT åŠŸèƒ½å•ä¸€</strong>ï¼šä¼ ç»Ÿ NFT ä»…ä¸ºé™æ€èµ„äº§ï¼Œæ— æ³•ä¸»åŠ¨æŒæœ‰ / ç®¡ç†å…¶ä»–èµ„äº§ï¼Œéš¾ä»¥æ˜ å°„å¤æ‚å®ä½“ï¼ˆå¦‚æ±½è½¦ã€æŠ•èµ„ç»„åˆï¼‰Ethereum Improvement Proposalsã€‚</li>
<li><strong>èµ„äº§å½’å±å‰²è£‚</strong>ï¼šç”¨æˆ·é’±åŒ…æ··åˆä¸ªäººä¸ NFT ç›¸å…³èµ„äº§ï¼Œç¼ºä¹ç‹¬ç«‹éš”ç¦»ä¸è¿½æº¯èƒ½åŠ›ã€‚</li>
<li><strong>äº¤äº’é—¨æ§›é«˜</strong>ï¼šNFT éœ€é€šè¿‡ç”¨æˆ·é’±åŒ…é—´æ¥æ“ä½œï¼Œæ— æ³•è‡ªä¸»å‚ä¸ dAppï¼ˆå¦‚ DeFi æŒ–çŸ¿ã€æ¸¸æˆå†…äº¤æ˜“ï¼‰ã€‚</li>
<li><strong>è·¨é“¾ç®¡ç†éš¾</strong>ï¼šå¤šé“¾èµ„äº§éœ€å¤šé’±åŒ…ç®¡ç†ï¼ŒTBA è®© NFT æˆä¸ºè·¨é“¾èµ„äº§çš„ç»Ÿä¸€å…¥å£Ethereum Improvement Proposalsã€‚</li>
</ol>
<hr/>
<h4 data-id="heading-6">å››ã€å…¸å‹è¡Œä¸šåº”ç”¨</h4>
<ol>
<li><strong>GameFi</strong>ï¼šè§’è‰² NFT çš„ TBA æŒæœ‰è£…å¤‡ã€é“å…·ã€è´§å¸ï¼Œèµ„äº§éšè§’è‰²è½¬ç§»ï¼Œæ”¯æŒ â€œè£…å¤‡é”»é€  - äº¤æ˜“ - ä½¿ç”¨â€ å…¨æµç¨‹é“¾ä¸Šé—­ç¯Ethereum Improvement Proposalsã€‚</li>
<li><strong>DeFi</strong>ï¼šNFT ä½œä¸º â€œèµ„äº§åŒ…â€ ç›´æ¥å‚ä¸æµåŠ¨æ€§æŒ–çŸ¿ã€å€Ÿè´·æŠµæŠ¼ï¼Œå¦‚æˆ¿äº§ NFT çš„ TBA æŒæœ‰ç§Ÿé‡‘æ”¶ç›Šä»£å¸ï¼Œè‡ªåŠ¨å¤æŠ•ã€‚</li>
<li><strong>æ•°å­—èº«ä»½</strong>ï¼šä¼šå‘˜ NFT çš„ TBA è®°å½•æ¶ˆè´¹ / ç§¯åˆ† / æƒé™ï¼Œå®ç° â€œå‡­è¯ + é’±åŒ… + èº«ä»½â€ ä¸‰åˆä¸€ï¼Œç®€åŒ– Web3 ç™»å½•ä¸æƒç›Šç®¡ç†Ethereum Improvement Proposalsã€‚</li>
<li><strong>DAO æ²»ç†</strong>ï¼šNFT ä½œä¸ºæŠ•ç¥¨æƒè½½ä½“ï¼ŒTBA è‡ªåŠ¨æ‰§è¡Œææ¡ˆæŠ•ç¥¨ã€åˆ†çº¢é¢†å–ï¼Œé™ä½ DAO å‚ä¸é—¨æ§›ã€‚</li>
<li><strong>IP èµ„äº§</strong>ï¼šè‰ºæœ¯ NFT çš„ TBA æŒæœ‰ç‰ˆç¨æ”¶å…¥ï¼Œè‡ªåŠ¨åˆ†å‘ç»™åˆ›ä½œè€… / æŒæœ‰è€…ï¼Œé€æ˜åŒ–ç‰ˆæƒæ”¶ç›Šæµã€‚</li>
</ol>
<hr/>
<h4 data-id="heading-7">äº”ã€ä¼˜åŠ£åŠ¿åˆ†æ</h4>



































<table><thead><tr><th>ç»´åº¦</th><th>ä¼˜åŠ¿</th><th>åŠ£åŠ¿</th></tr></thead><tbody><tr><td>å…¼å®¹æ€§</td><td>å®Œå…¨å…¼å®¹ ERC-721/ERC-1155ï¼Œæ— éœ€ä¿®æ”¹ç°æœ‰ NFT åˆçº¦</td><td>éƒ¨åˆ†éä¸»æµ NFTï¼ˆå¦‚ CryptoPunksï¼‰å› æœªå®ç° ownerOf æ–¹æ³•ï¼Œæ— æ³•æ¥å…¥ TBA</td></tr><tr><td>å®‰å…¨æ€§</td><td>èµ„äº§éš”ç¦»å­˜å‚¨ï¼Œå‡å°‘ç”¨æˆ·é’±åŒ…è¢«é»‘é£é™©ï¼›TBA ä»…ç”± NFT æ‰€æœ‰è€…æ§åˆ¶</td><td>æ™ºèƒ½åˆçº¦æ¼æ´å¯èƒ½å¯¼è‡´ TBA èµ„äº§æŸå¤±ï¼›NFT ä¸¢å¤± / è¢«ç›—åˆ™ TBA èµ„äº§ä¸€åŒå—æŸ</td></tr><tr><td>çµæ´»æ€§</td><td>æ”¯æŒè‡ªå®šä¹‰è´¦æˆ·å®ç°ï¼Œå¯æ‰©å±•æƒé™ç®¡ç†ï¼ˆå¦‚å¤šç­¾ã€å®šæ—¶é‡Šæ”¾ï¼‰Ethereum Improvement Proposals</td><td>éœ€å¼€å‘è€…é€‚é… TBA æ¥å£ï¼Œéƒ¨åˆ† dApp å°šæœªæ”¯æŒåˆçº¦è´¦æˆ·äº¤äº’</td></tr><tr><td>ç”¨æˆ·ä½“éªŒ</td><td>èµ„äº§éš NFT ä¸€é”®è½¬ç§»ï¼Œç®€åŒ–å¤šé“¾ / å¤šèµ„äº§ç®¡ç†</td><td>æ“ä½œéœ€æ”¯ä»˜é¢å¤– Gasï¼ˆTBA éƒ¨ç½²ã€äº¤æ˜“æ‰§è¡Œï¼‰ï¼Œæˆæœ¬é«˜äºæ™®é€š NFT è½¬ç§»</td></tr><tr><td>åˆ›æ–°æ€§</td><td>æ¨åŠ¨ NFT ä» â€œé™æ€ JPEGâ€ å‡çº§ä¸º â€œåŠ¨æ€ç»æµä½“â€ï¼Œå‚¬ç”Ÿæ–°å‹å•†ä¸šæ¨¡å¼</td><td>å¸‚åœºè®¤çŸ¥ä¸è¶³ï¼Œæ—©æœŸåº”ç”¨å­˜åœ¨åˆè§„ä¸ç›‘ç®¡ä¸ç¡®å®šæ€§</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-8">å…­ã€æ€»ç»“</h4>
<p>ERC-6551 é€šè¿‡ TBA æœºåˆ¶ä¸º NFT èµ‹äºˆ â€œæ™ºèƒ½é’±åŒ…â€ å±æ€§ï¼Œæ˜¯ NFT ä» â€œæ•°å­—è—å“â€ åˆ° â€œé“¾ä¸Šå®ä½“â€ çš„å…³é”®å‡çº§ã€‚å…¶æ ¸å¿ƒä»·å€¼åœ¨äº<strong>èµ„äº§éš”ç¦»ã€è‡ªä¸»äº¤äº’ã€æ‰€æœ‰æƒè”åŠ¨</strong>ï¼Œé€‚é… GameFiã€DeFiã€èº«ä»½ç®¡ç†ç­‰å¤šåœºæ™¯ï¼Œä½†éœ€å¹³è¡¡å®‰å…¨ã€æˆæœ¬ä¸ç”Ÿæ€é€‚é…æ€§ã€‚å»ºè®®å¼€å‘è€…ä¼˜å…ˆåŸºäº ERC-721 æ ‡å‡†æ¥å…¥ TBAï¼Œé€æ­¥æ¢ç´¢å¤æ‚åº”ç”¨è½åœ°ã€‚</p>
<hr/>
<h2 data-id="heading-9">æ™ºèƒ½åˆçº¦å¼€å‘ã€æµ‹è¯•ã€éƒ¨ç½²</h2>
<h4 data-id="heading-10">æ™ºèƒ½åˆçº¦</h4>
<ul>
<li><strong>ä»£å¸åˆçº¦</strong></li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// SPDX-License-Identifier: MIT</span>
<span class="hljs-comment">// Compatible with OpenZeppelin Contracts ^5.5.0</span>
pragma solidity ^<span class="hljs-number">0.8</span><span class="hljs-number">.24</span>;

<span class="hljs-keyword">import</span> {<span class="hljs-title class_">ERC20</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/token/ERC20/ERC20.sol"</span>;
<span class="hljs-keyword">import</span> {<span class="hljs-title class_">ERC20Burnable</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/token/ERC20/extensions/ERC20Burnable.sol"</span>;
<span class="hljs-keyword">import</span> {<span class="hljs-title class_">ERC20Permit</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/token/ERC20/extensions/ERC20Permit.sol"</span>;
<span class="hljs-keyword">import</span> {<span class="hljs-title class_">Ownable</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/access/Ownable.sol"</span>;

contract <span class="hljs-title class_">BoykaYuriToken</span> is <span class="hljs-title class_">ERC20</span>, <span class="hljs-title class_">ERC20Burnable</span>, <span class="hljs-title class_">Ownable</span>, <span class="hljs-title class_">ERC20Permit</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">address recipient, address initialOwner</span>)
        <span class="hljs-title class_">ERC20</span>(<span class="hljs-string">"MyToken"</span>, <span class="hljs-string">"MTK"</span>)
        <span class="hljs-title class_">Ownable</span>(initialOwner)
        <span class="hljs-title class_">ERC20Permit</span>(<span class="hljs-string">"MyToken"</span>)
    {
        <span class="hljs-title function_">_mint</span>(recipient, <span class="hljs-number">1000000</span> * <span class="hljs-number">10</span> ** <span class="hljs-title function_">decimals</span>());
    }
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">mint</span>(<span class="hljs-params">address to, uint256 amount</span>) public onlyOwner {
        <span class="hljs-title function_">_mint</span>(to, amount);
    }
}
</code></pre>
<ul>
<li><strong>NFTåˆçº¦</strong></li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// SPDX-License-Identifier: MIT</span>
<span class="hljs-comment">// Compatible with OpenZeppelin Contracts ^5.5.0</span>
pragma solidity ^<span class="hljs-number">0.8</span><span class="hljs-number">.27</span>;

<span class="hljs-keyword">import</span> {<span class="hljs-title class_">ERC721</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/token/ERC721/ERC721.sol"</span>;
<span class="hljs-keyword">import</span> {<span class="hljs-title class_">ERC721Burnable</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/token/ERC721/extensions/ERC721Burnable.sol"</span>;
<span class="hljs-keyword">import</span> {<span class="hljs-title class_">ERC721URIStorage</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/token/ERC721/extensions/ERC721URIStorage.sol"</span>;
<span class="hljs-keyword">import</span> {<span class="hljs-title class_">Ownable</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/access/Ownable.sol"</span>;

contract <span class="hljs-title class_">MyToken</span> is <span class="hljs-title class_">ERC721</span>, <span class="hljs-title class_">ERC721URIStorage</span>, <span class="hljs-title class_">ERC721Burnable</span>, <span class="hljs-title class_">Ownable</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">address initialOwner</span>)
        <span class="hljs-title class_">ERC721</span>(<span class="hljs-string">"MyToken"</span>, <span class="hljs-string">"MTK"</span>)
        <span class="hljs-title class_">Ownable</span>(initialOwner)
    {}

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">safeMint</span>(<span class="hljs-params">address to, uint256 tokenId, <span class="hljs-built_in">string</span> memory uri</span>)
        <span class="hljs-keyword">public</span>
        onlyOwner
    {
        <span class="hljs-title function_">_safeMint</span>(to, tokenId);
        <span class="hljs-title function_">_setTokenURI</span>(tokenId, uri);
    }

    <span class="hljs-comment">// The following functions are overrides required by Solidity.</span>

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">tokenURI</span>(<span class="hljs-params">uint256 tokenId</span>)
        <span class="hljs-keyword">public</span>
        view
        <span class="hljs-title function_">override</span>(<span class="hljs-title class_">ERC721</span>, <span class="hljs-title class_">ERC721URIStorage</span>)
        returns (<span class="hljs-built_in">string</span> memory)
    {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">tokenURI</span>(tokenId);
    }

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">supportsInterface</span>(<span class="hljs-params">bytes4 interfaceId</span>)
        <span class="hljs-keyword">public</span>
        view
        <span class="hljs-title function_">override</span>(<span class="hljs-title class_">ERC721</span>, <span class="hljs-title class_">ERC721URIStorage</span>)
        returns (bool)
    {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">supportsInterface</span>(interfaceId);
    }
}
</code></pre>
<ul>
<li><strong>è´¦æˆ·å®ç°æ™ºèƒ½åˆçº¦</strong></li>
</ul>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// SPDX-License-Identifier: MIT</span>
pragma solidity ^<span class="hljs-number">0.8</span>.<span class="hljs-number">24</span>;

import {IERC165} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/utils/introspection/IERC165.sol"</span>;
import {IERC721} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/token/ERC721/IERC721.sol"</span>;
import {IERC1271} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/interfaces/IERC1271.sol"</span>;
import {SignatureChecker} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/utils/cryptography/SignatureChecker.sol"</span>;

<span class="hljs-comment">// ç®€åŒ–ç‰ˆ ERC6551 è´¦æˆ·å®ç°</span>
contract SimpleERC6551Account is IERC165, IERC1271 {
    <span class="hljs-title function_ invoke__">receive</span>() external payable {}

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">execute</span>(<span class="hljs-params">address to, uint256 value, bytes calldata data, uint8 operation</span>) 
        <span class="hljs-title">external</span> <span class="hljs-title">payable</span> <span class="hljs-title">returns</span> (<span class="hljs-params">bytes memory result</span>) 
    </span>{
        <span class="hljs-keyword">require</span>(msg.sender == <span class="hljs-title function_ invoke__">owner</span>(), <span class="hljs-string">"Not token owner"</span>);
        <span class="hljs-keyword">require</span>(operation == <span class="hljs-number">0</span>, <span class="hljs-string">"Only call operation supported"</span>);

        <span class="hljs-keyword">bool</span> success;
        (success, result) = to.call{value: value}(data);
        <span class="hljs-keyword">require</span>(success, <span class="hljs-string">"Execution failed"</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">owner</span>(<span class="hljs-params"/>) <span class="hljs-title">public</span> <span class="hljs-title">view</span> <span class="hljs-title">returns</span> (<span class="hljs-params">address</span>) </span>{
        (uint256 chainId, address tokenContract, uint256 tokenId) = <span class="hljs-title function_ invoke__">token</span>();
        <span class="hljs-keyword">if</span> (chainId != block.chainid) <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">address</span>(<span class="hljs-number">0</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">IERC721</span>(tokenContract).<span class="hljs-title function_ invoke__">ownerOf</span>(tokenId);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">token</span>(<span class="hljs-params"/>) <span class="hljs-title">public</span> <span class="hljs-title">view</span> <span class="hljs-title">returns</span> (<span class="hljs-params">uint256, address, uint256</span>) </span>{
        bytes memory footer = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">bytes</span>(<span class="hljs-number">0x60</span>);
        assembly {
            <span class="hljs-title function_ invoke__">extcodecopy</span>(<span class="hljs-title function_ invoke__">address</span>(), <span class="hljs-title function_ invoke__">add</span>(footer, <span class="hljs-number">0x20</span>), <span class="hljs-title function_ invoke__">sub</span>(<span class="hljs-title function_ invoke__">extcodesize</span>(<span class="hljs-title function_ invoke__">address</span>()), <span class="hljs-number">0x60</span>), <span class="hljs-number">0x60</span>)
        }
        <span class="hljs-keyword">return</span> abi.<span class="hljs-title function_ invoke__">decode</span>(footer, (uint256, address, uint256));
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isValidSignature</span>(<span class="hljs-params">bytes32 hash, bytes memory signature</span>) <span class="hljs-title">external</span> <span class="hljs-title">view</span> <span class="hljs-title">returns</span> (<span class="hljs-params">bytes4</span>) </span>{
        <span class="hljs-keyword">if</span> (SignatureChecker.<span class="hljs-title function_ invoke__">isValidSignatureNow</span>(<span class="hljs-title function_ invoke__">owner</span>(), hash, signature)) {
            <span class="hljs-keyword">return</span> IERC1271.isValidSignature.selector;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">bytes4</span>(<span class="hljs-number">0</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">supportsInterface</span>(<span class="hljs-params">bytes4 interfaceId</span>) <span class="hljs-title">external</span> <span class="hljs-title">pure</span> <span class="hljs-title">returns</span> (<span class="hljs-params"><span class="hljs-keyword">bool</span></span>) </span>{
        <span class="hljs-keyword">return</span> interfaceId == <span class="hljs-number">0x6faff5f1</span> || interfaceId == <span class="hljs-number">0x01ffc9a7</span>; <span class="hljs-comment">// ERC6551 &amp; ERC165</span>
    }
}
</code></pre>
<ul>
<li><strong>æ³¨å†Œè¡¨æ™ºèƒ½åˆçº¦</strong></li>
</ul>
<pre><code class="hljs language-ini" lang="ini">// SPDX-License-Identifier: MIT
pragma solidity ^0.8.24<span class="hljs-comment">;</span>

import {Create2} from "@openzeppelin/contracts/utils/Create2.sol"<span class="hljs-comment">;</span>

contract ERC6551Registry {
    error AccountCreationFailed()<span class="hljs-comment">;</span>

    function createAccount(
        address implementation,
        uint256 chainId,
        address tokenContract,
        uint256 tokenId,
        uint256 salt,
        bytes calldata initData
    ) external returns (address) {
        bytes memory <span class="hljs-attr">code</span> = _creationCode(implementation, chainId, tokenContract, tokenId, salt)<span class="hljs-comment">;</span>
        address <span class="hljs-attr">_account</span> = Create2.computeAddress(bytes32(salt), keccak256(code))<span class="hljs-comment">;</span>

        if (_account.code.length != 0) return _account<span class="hljs-comment">;</span>

        <span class="hljs-attr">_account</span> = Create2.deploy(<span class="hljs-number">0</span>, bytes32(salt), code)<span class="hljs-comment">;</span>
        if (initData.length != 0) {
            (bool success, ) = _account.call(initData)<span class="hljs-comment">;</span>
            if (!success) revert AccountCreationFailed()<span class="hljs-comment">;</span>
        }
        return _account<span class="hljs-comment">;</span>
    }

    function account(
        address implementation,
        uint256 chainId,
        address tokenContract,
        uint256 tokenId,
        uint256 salt
    ) external view returns (address) {
        bytes memory <span class="hljs-attr">code</span> = _creationCode(implementation, chainId, tokenContract, tokenId, salt)<span class="hljs-comment">;</span>
        return Create2.computeAddress(bytes32(salt), keccak256(code))<span class="hljs-comment">;</span>
    }

    function _creationCode(address implementation, uint256 chainId, address tokenContract, uint256 tokenId, uint256 salt) internal pure returns (bytes memory) {
        return abi.encodePacked(
            hex"3d60ad80600a3d3981f3363d3d373d3d3d363d73",
            implementation,
            hex"5af43d82803e903d91602b57fd5bf3",
            abi.encode(salt, chainId, tokenContract, tokenId)
        )<span class="hljs-comment">;</span>
    }
}
</code></pre>
<h4 data-id="heading-11">æµ‹è¯•è„šæœ¬</h4>
<ul>
<li><strong>æµ‹è¯•åœºæ™¯ï¼š</strong></li>
</ul>
<ol>
<li><strong>åº”å…è®¸ NFT è´¦æˆ·æ¥æ”¶å’Œå‘é€ ERC20 ä»£å¸</strong></li>
<li><strong>æƒé™æµ‹è¯•ï¼šé NFT æŒæœ‰è€…æ— æ³•æ‰§è¡Œäº¤æ˜“</strong></li>
<li><strong>æ‰€æœ‰æƒè½¬ç§»æµ‹è¯•ï¼šNFT è½¬è®©åæ§åˆ¶æƒéšä¹‹è½¬ç§»</strong></li>
<li><strong>ETH æ¥æ”¶ä¸è½¬å‡ºæµ‹è¯•</strong> <strong>æ¥å£éªŒè¯ï¼šåº”æ”¯æŒ ERC165 å’Œ ERC6551 æ¥å£</strong></li>
<li><strong>å…ƒæ•°æ®æµ‹è¯•ï¼šTBA åº”èƒ½æ­£ç¡®è¿”å›å…¶ç»‘å®šçš„ Token ä¿¡æ¯</strong></li>
</ol>
<pre><code class="hljs language-ini" lang="ini">import assert from "node:assert/strict"<span class="hljs-comment">;</span>
import { describe, it } from "node:test"<span class="hljs-comment">;</span>
import { parseEther, encodeFunctionData, zeroAddress } from "viem"<span class="hljs-comment">;</span>
import { network } from "hardhat"<span class="hljs-comment">;</span>

describe("ERC6551 Extended Integration Tests", function () {
  async function deployFixture() {
    const { viem } = await network.connect()<span class="hljs-comment">;</span>
    const <span class="hljs-section">[owner, otherAccount]</span> = await viem.getWalletClients()<span class="hljs-comment">;</span>
    const <span class="hljs-attr">publicClient</span> = await viem.getPublicClient()<span class="hljs-comment">;</span>

    const <span class="hljs-attr">nft</span> = await viem.deployContract(<span class="hljs-string">"MyToken"</span>, [owner.account.address])<span class="hljs-comment">;</span>
    const <span class="hljs-attr">token</span> = await viem.deployContract(<span class="hljs-string">"BoykaYuriToken"</span>, [owner.account.address, owner.account.address])<span class="hljs-comment">;</span>
    const <span class="hljs-attr">registry</span> = await viem.deployContract(<span class="hljs-string">"ERC6551Registry"</span>)<span class="hljs-comment">;</span>
    const <span class="hljs-attr">implementation</span> = await viem.deployContract(<span class="hljs-string">"SimpleERC6551Account"</span>)<span class="hljs-comment">;</span>

    const <span class="hljs-attr">salt</span> = <span class="hljs-number">0</span>n<span class="hljs-comment">;</span>
    const <span class="hljs-attr">chainId</span> = BigInt(<span class="hljs-number">31337</span>)<span class="hljs-comment">;</span>
    const <span class="hljs-attr">tokenId</span> = <span class="hljs-number">1</span>n<span class="hljs-comment">;</span>
    const <span class="hljs-attr">ipfsUri</span> = <span class="hljs-string">"https://zygomorphic-magenta-bobolink.myfilebase.com/ipfs/QmQT8VpmWQVhUhoDCEK1mdHXaFaJ3KawkRxHm96GUhrXLB"</span><span class="hljs-comment">;</span>

    await nft.write.safeMint(<span class="hljs-section">[owner.account.address, tokenId, ipfsUri]</span>)<span class="hljs-comment">;</span>
    await registry.write.createAccount(<span class="hljs-section">[implementation.address, chainId, nft.address, tokenId, salt, "0x"]</span>)<span class="hljs-comment">;</span>
    const <span class="hljs-attr">tbaAddress</span> = await registry.read.account([implementation.address, chainId, nft.address, tokenId, salt])<span class="hljs-comment">;</span>
    const <span class="hljs-attr">tbaContract</span> = await viem.getContractAt(<span class="hljs-string">"SimpleERC6551Account"</span>, tbaAddress)<span class="hljs-comment">;</span>

    return { nft, token, registry, implementation, owner, otherAccount, publicClient, tbaAddress, tbaContract, tokenId, chainId, salt, viem }<span class="hljs-comment">;</span>
  }
it("åº”å…è®¸ NFT è´¦æˆ·æ¥æ”¶å’Œå‘é€ ERC20 ä»£å¸", async function () {
  const { nft, token, registry, implementation, owner, viem } = await deployFixture()<span class="hljs-comment">;</span>
  const <span class="hljs-attr">ipfsUri</span> = <span class="hljs-string">"https://zygomorphic-magenta-bobolink.myfilebase.com/ipfs/QmQT8VpmWQVhUhoDCEK1mdHXaFaJ3KawkRxHm96GUhrXLB"</span><span class="hljs-comment">;</span>
  
  // 1. æ˜¾å¼è·å–åœ°å€å­—ç¬¦ä¸²ï¼Œé˜²æ­¢ viem ä¼ é€’ç©ºå¯¹è±¡
  const <span class="hljs-attr">ownerAddress</span> = owner.account.address<span class="hljs-comment">;</span>
  const <span class="hljs-attr">tokenId</span> = <span class="hljs-number">1</span>n<span class="hljs-comment">;</span>

  // Mint NFT - æ˜¾å¼ä¼ é€’å­—ç¬¦ä¸²åœ°å€å’Œå‘é€è€…è´¦æˆ·
//   await nft.write.safeMint(<span class="hljs-section">[ownerAddress, tokenId, ipfsUri]</span>, {
//     account: owner.account 
//   })<span class="hljs-comment">;</span>

  // 2. è®¡ç®— TBA åœ°å€
  const <span class="hljs-attr">salt</span> = <span class="hljs-number">0</span>n<span class="hljs-comment">;</span>
  const <span class="hljs-attr">chainId</span> = BigInt(<span class="hljs-number">31337</span>)<span class="hljs-comment">;</span>
  const <span class="hljs-attr">tbaAddress</span> = await registry.read.account([implementation.address, chainId, nft.address, tokenId, salt])<span class="hljs-comment">;</span>

  // 3. éƒ¨ç½² TBA
  await registry.write.createAccount(<span class="hljs-section">[implementation.address, chainId, nft.address, tokenId, salt, "0x"]</span>)<span class="hljs-comment">;</span>

  // 4. ç»™ TBA è½¬å…¥ ERC20 (åŒæ ·ä½¿ç”¨æ˜¾å¼åœ°å€)
  const <span class="hljs-attr">amount</span> = parseEther(<span class="hljs-string">"100"</span>)<span class="hljs-comment">;</span>
  await token.write.transfer(<span class="hljs-section">[tbaAddress, amount]</span>, {
    account: owner.account 
  })<span class="hljs-comment">;</span>
  
  // éªŒè¯ TBA ä½™é¢
  const <span class="hljs-attr">balanceAfterTransfer</span> = await token.read.balanceOf([tbaAddress])<span class="hljs-comment">;</span>
  assert.strictEqual(balanceAfterTransfer, amount, "TBA åº”è¯¥æ”¶åˆ°æŒ‡å®šæ•°é‡çš„ä»£å¸")<span class="hljs-comment">;</span>

  // 5. é€šè¿‡ TBA è°ƒç”¨ ERC20 çš„ transfer æ–¹æ³•è½¬å›ç»™ Owner
  const <span class="hljs-attr">transferData</span> = encodeFunctionData({
    abi: token.abi,
    functionName: "transfer",
    args: <span class="hljs-section">[ownerAddress, amount]</span>, // ä½¿ç”¨æ˜¾å¼å­—ç¬¦ä¸²åœ°å€
  })<span class="hljs-comment">;</span>

  const <span class="hljs-attr">accountContract</span> = await viem.getContractAt(<span class="hljs-string">"SimpleERC6551Account"</span>, tbaAddress)<span class="hljs-comment">;</span>
  // æ‰§è¡Œ TBA äº¤æ˜“
  await accountContract.write.execute(<span class="hljs-section">[token.address, 0n, transferData, 0]</span>, {
    account: owner.account
  })<span class="hljs-comment">;</span>

  // éªŒè¯ TBA ä½™é¢æ¸…é›¶
  const <span class="hljs-attr">finalBalance</span> = await token.read.balanceOf([tbaAddress])<span class="hljs-comment">;</span>
  assert.strictEqual(finalBalance, 0n, "TBA çš„ä»£å¸ä½™é¢åº”è¯¥å·²è½¬å‡ºå¹¶æ¸…é›¶")<span class="hljs-comment">;</span>
})<span class="hljs-comment">;</span>


  it("æƒé™æµ‹è¯•ï¼šé NFT æŒæœ‰è€…æ— æ³•æ‰§è¡Œäº¤æ˜“", async function () {
    const { tbaContract, otherAccount, token } = await deployFixture()<span class="hljs-comment">;</span>
    const <span class="hljs-attr">data</span> = encodeFunctionData({
      abi: token.abi,
      functionName: "transfer",
      args: <span class="hljs-section">[otherAccount.account.address, 1n]</span>,
    })<span class="hljs-comment">;</span>

    // Node assert éªŒè¯å¼‚æ­¥æŠ›å‡ºå¼‚å¸¸
    await assert.rejects(
      async () =&gt; {
        await tbaContract.write.execute(<span class="hljs-section">[token.address, 0n, data, 0]</span>, {
          account: otherAccount.account,
        })<span class="hljs-comment">;</span>
      },
      (err: any) =&gt; {
        return err.message.includes("Not token owner")<span class="hljs-comment">;</span>
      },
      "åº”è¯¥å› ä¸ºä¸æ˜¯æ‰€æœ‰è€…è€Œæ‹’ç»äº¤æ˜“"
    )<span class="hljs-comment">;</span>
  })<span class="hljs-comment">;</span>

  it("æ‰€æœ‰æƒè½¬ç§»æµ‹è¯•ï¼šNFT è½¬è®©åæ§åˆ¶æƒéšä¹‹è½¬ç§»", async function () {
    const { nft, tbaContract, owner, otherAccount, tokenId } = await deployFixture()<span class="hljs-comment">;</span>

    await nft.write.transferFrom(<span class="hljs-section">[owner.account.address, otherAccount.account.address, tokenId]</span>)<span class="hljs-comment">;</span>

    // éªŒè¯æ—§æ‰€æœ‰è€…å¤±æ•ˆ
    await assert.rejects(
      async () =&gt; {
        await tbaContract.write.execute(<span class="hljs-section">[zeroAddress, 0n, "0x", 0]</span>, { account: owner.account })<span class="hljs-comment">;</span>
      },
      /Not token owner/
    )<span class="hljs-comment">;</span>

    // éªŒè¯æ–°æ‰€æœ‰è€…æˆåŠŸ
    const <span class="hljs-attr">tx</span> = await tbaContract.write.execute([otherAccount.account.address, <span class="hljs-number">0</span>n, <span class="hljs-string">"0x"</span>, <span class="hljs-number">0</span>], {
      account: otherAccount.account,
    })<span class="hljs-comment">;</span>
    assert.ok(typeof <span class="hljs-attr">tx</span> === <span class="hljs-string">"string"</span>, <span class="hljs-string">"äº¤æ˜“å“ˆå¸Œåº”ä¸ºå­—ç¬¦ä¸²"</span>)<span class="hljs-comment">;</span>
  })<span class="hljs-comment">;</span>
 
  it("ETH æ¥æ”¶ä¸è½¬å‡ºæµ‹è¯•", async function () {
    const { tbaAddress, tbaContract, otherAccount, publicClient } = await deployFixture()<span class="hljs-comment">;</span>
    const <span class="hljs-attr">depositAmount</span> = parseEther(<span class="hljs-string">"1"</span>)<span class="hljs-comment">;</span>

    await otherAccount.sendTransaction({ to: tbaAddress, value: depositAmount })<span class="hljs-comment">;</span>
    
    let <span class="hljs-attr">balance</span> = await publicClient.getBalance({ address: tbaAddress })<span class="hljs-comment">;</span>
    assert.equal(balance, depositAmount)<span class="hljs-comment">;</span>

    const <span class="hljs-attr">beforeBalance</span> = await publicClient.getBalance({ address: otherAccount.account.address })<span class="hljs-comment">;</span>
    await tbaContract.write.execute(<span class="hljs-section">[otherAccount.account.address, depositAmount, "0x", 0]</span>)<span class="hljs-comment">;</span>

    <span class="hljs-attr">balance</span> = await publicClient.getBalance({ address: tbaAddress })<span class="hljs-comment">;</span>
    const <span class="hljs-attr">afterBalance</span> = await publicClient.getBalance({ address: otherAccount.account.address })<span class="hljs-comment">;</span>

    assert.equal(balance, 0n)<span class="hljs-comment">;</span>
    assert.ok(afterBalance &gt; beforeBalance, "æ¥æ”¶è€…ä½™é¢åº”å¢åŠ ")<span class="hljs-comment">;</span>
  })<span class="hljs-comment">;</span>
  it("æ¥å£éªŒè¯ï¼šåº”æ”¯æŒ ERC165 å’Œ ERC6551 æ¥å£", async function () {
    const { tbaContract } = await deployFixture()<span class="hljs-comment">;</span>
    const <span class="hljs-attr">supportsERC6551</span> = await tbaContract.read.supportsInterface([<span class="hljs-string">"0x6faff5f1"</span>])<span class="hljs-comment">;</span>
    assert.strictEqual(supportsERC6551, true)<span class="hljs-comment">;</span>
  })<span class="hljs-comment">;</span>

  it("å…ƒæ•°æ®æµ‹è¯•ï¼šTBA åº”èƒ½æ­£ç¡®è¿”å›å…¶ç»‘å®šçš„ Token ä¿¡æ¯", async function () {
    const { tbaContract, nft, tokenId, chainId } = await deployFixture()<span class="hljs-comment">;</span>
    const <span class="hljs-section">[resChainId, resAddr, resTokenId]</span> = await tbaContract.read.token()<span class="hljs-comment">;</span>
    
    assert.equal(resChainId, chainId)<span class="hljs-comment">;</span>
    assert.equal(resAddr.toLowerCase(), nft.address.toLowerCase())<span class="hljs-comment">;</span>
    assert.equal(resTokenId, tokenId)<span class="hljs-comment">;</span>
  })<span class="hljs-comment">;</span>
})<span class="hljs-comment">;</span>
</code></pre>
<h4 data-id="heading-12">éƒ¨ç½²è„šæœ¬</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { network, artifacts } <span class="hljs-keyword">from</span> <span class="hljs-string">"hardhat"</span>;
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> { viem } = <span class="hljs-keyword">await</span> network.<span class="hljs-title function_">connect</span>({ <span class="hljs-attr">network</span>: network.<span class="hljs-property">name</span> });<span class="hljs-comment">//æŒ‡å®šç½‘ç»œè¿›è¡Œé“¾æ¥</span>
  <span class="hljs-keyword">const</span> publicClient = <span class="hljs-keyword">await</span> viem.<span class="hljs-title function_">getPublicClient</span>();
  <span class="hljs-keyword">const</span> [deployer] = <span class="hljs-keyword">await</span> viem.<span class="hljs-title function_">getWalletClients</span>();

  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ­£åœ¨ä½¿ç”¨è´¦æˆ·éƒ¨ç½²: <span class="hljs-subst">${deployer.account.address}</span>`</span>);

  <span class="hljs-comment">// 1. éƒ¨ç½² Account Implementation (é€»è¾‘è“æœ¬)</span>
  <span class="hljs-keyword">const</span> accountArt = <span class="hljs-keyword">await</span> artifacts.<span class="hljs-title function_">readArtifact</span>(<span class="hljs-string">"SimpleERC6551Account"</span>);
  <span class="hljs-keyword">const</span> accountHash = <span class="hljs-keyword">await</span> deployer.<span class="hljs-title function_">deployContract</span>({
    <span class="hljs-attr">abi</span>: accountArt.<span class="hljs-property">abi</span>,
    <span class="hljs-attr">bytecode</span>: accountArt.<span class="hljs-property">bytecode</span> <span class="hljs-keyword">as</span> <span class="hljs-string">`0x<span class="hljs-subst">${<span class="hljs-built_in">string</span>}</span>`</span>,
  });
  <span class="hljs-keyword">const</span> { <span class="hljs-attr">contractAddress</span>: implementationAddr } = <span class="hljs-keyword">await</span> publicClient.<span class="hljs-title function_">waitForTransactionReceipt</span>({ <span class="hljs-attr">hash</span>: accountHash });
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Account Implementation éƒ¨ç½²æˆåŠŸ: <span class="hljs-subst">${implementationAddr}</span>`</span>);

  <span class="hljs-comment">// 2. éƒ¨ç½² Registry (æ³¨å†Œè¡¨)</span>
  <span class="hljs-keyword">const</span> registryArt = <span class="hljs-keyword">await</span> artifacts.<span class="hljs-title function_">readArtifact</span>(<span class="hljs-string">"ERC6551Registry"</span>);
  <span class="hljs-keyword">const</span> registryHash = <span class="hljs-keyword">await</span> deployer.<span class="hljs-title function_">deployContract</span>({
    <span class="hljs-attr">abi</span>: registryArt.<span class="hljs-property">abi</span>,
    <span class="hljs-attr">bytecode</span>: registryArt.<span class="hljs-property">bytecode</span> <span class="hljs-keyword">as</span> <span class="hljs-string">`0x<span class="hljs-subst">${<span class="hljs-built_in">string</span>}</span>`</span>,
  });
  <span class="hljs-keyword">const</span> { <span class="hljs-attr">contractAddress</span>: registryAddr } = <span class="hljs-keyword">await</span> publicClient.<span class="hljs-title function_">waitForTransactionReceipt</span>({ <span class="hljs-attr">hash</span>: registryHash });
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ERC6551Registry éƒ¨ç½²æˆåŠŸ: <span class="hljs-subst">${registryAddr}</span>`</span>);

  <span class="hljs-keyword">return</span> { implementationAddr, registryAddr };
}

<span class="hljs-title function_">main</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(error);
  process.<span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>);
});
</code></pre>
<h2 data-id="heading-13">ç»“è¯­</h2>
<p>è‡³æ­¤ï¼ŒERC6551 æ ‡å‡†ä»æ ¸å¿ƒç†è®ºè§£æåˆ°ä»£ç å®æˆ˜è½åœ°çš„å…¨å†…å®¹å·²å®Œæ•´å‘ˆç°ã€‚ä»æ ‡å‡†çš„æ ¸å¿ƒå®šä¹‰ã€æ ¸å¿ƒèƒ½åŠ›ï¼Œåˆ°è§£å†³çš„è¡Œä¸šç—›ç‚¹ã€å…¸å‹åº”ç”¨ä¸ä¼˜åŠ£åŠ¿åˆ†æï¼Œå†åˆ°åŸºäº Hardhat V3+OpenZeppelin V5+Solidity 0.8.24 å®ç°çš„å¼€å‘ã€æµ‹è¯•ã€éƒ¨ç½²å…¨æµç¨‹ï¼Œå½¢æˆäº†ç†è®ºä¸å®è·µç»“åˆçš„å®Œæ•´ä½“ç³»ï¼Œä¸ºè¯¥æ ‡å‡†çš„å®é™…å¼€å‘ä¸è½åœ°åº”ç”¨æä¾›äº†æ¸…æ™°çš„å‚è€ƒè·¯å¾„ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é›¶å¼€å§‹æ„å»º Tauri 2.0 æ¡Œé¢åº”ç”¨ï¼šReact + Rust å®Œæ•´å®æˆ˜æ•™ç¨‹]]></title>    <link>https://juejin.cn/post/7599924965949866022</link>    <guid>https://juejin.cn/post/7599924965949866022</guid>    <pubDate>2026-01-27T11:27:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599924965949866022" data-draft-id="7599528186586923018" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»é›¶å¼€å§‹æ„å»º Tauri 2.0 æ¡Œé¢åº”ç”¨ï¼šReact + Rust å®Œæ•´å®æˆ˜æ•™ç¨‹"/> <meta itemprop="keywords" content="å…¨æ ˆ,React.js"/> <meta itemprop="datePublished" content="2026-01-27T11:27:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‡‰ä»‹Nova"/> <meta itemprop="url" content="https://juejin.cn/user/915262510735207"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»é›¶å¼€å§‹æ„å»º Tauri 2.0 æ¡Œé¢åº”ç”¨ï¼šReact + Rust å®Œæ•´å®æˆ˜æ•™ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/915262510735207/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‡‰ä»‹Nova
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T11:27:48.000Z" title="Tue Jan 27 2026 11:27:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>Tauri æ˜¯ä¸€ä¸ªä½¿ç”¨ Web æŠ€æœ¯æ„å»ºæ¡Œé¢åº”ç”¨çš„æ¡†æ¶ï¼Œç›¸æ¯” Electronï¼Œå®ƒçš„ä¼˜åŠ¿åœ¨äºï¼š</p>
<ul>
<li><strong>ä½“ç§¯å°</strong>ï¼šæ‰“åŒ…åä»…å‡  MBï¼Œè€Œ Electron åŠ¨è¾„ä¸Šç™¾ MB</li>
<li><strong>æ€§èƒ½é«˜</strong>ï¼šä½¿ç”¨ Rust ä½œä¸ºåç«¯ï¼Œå†…å­˜å ç”¨ä½</li>
<li><strong>å®‰å…¨æ€§å¼º</strong>ï¼šé»˜è®¤ç¦ç”¨ Node.jsï¼Œå‡å°‘æ”»å‡»é¢</li>
</ul>
<p>æœ¬æ–‡å°†å¸¦ä½ ä»é›¶æ„å»ºä¸€ä¸ªå®Œæ•´çš„ Tauri åº”ç”¨ï¼ŒåŒ…å«å‰åç«¯é€šä¿¡çš„å®æˆ˜æ¡ˆä¾‹ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€ç¯å¢ƒå‡†å¤‡</h2>
<h3 data-id="heading-2">1.1 å®‰è£… Rust</h3>
<p>Windows ç”¨æˆ·ä¸‹è½½å¹¶è¿è¡Œ rustup-init.exeï¼ŒæŒ‰æç¤ºå®Œæˆå®‰è£…ã€‚</p>
<p>å®‰è£…å®ŒæˆåéªŒè¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">rustc --version
cargo --version
</code></pre>
<h3 data-id="heading-3">1.2 å®‰è£… Node.js</h3>
<p>æ¨èä½¿ç”¨ Node.js 18 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">node --version
npm --version
</code></pre>
<h3 data-id="heading-4">1.3 å®‰è£…ç³»ç»Ÿä¾èµ–</h3>
<p>Windows éœ€è¦å®‰è£…ï¼š</p>
<ul>
<li>Microsoft Visual Studio C++ Build Tools</li>
<li>WebView2ï¼ˆWindows 10/11 é€šå¸¸å·²é¢„è£…ï¼‰</li>
</ul>
<h2 data-id="heading-5">äºŒã€åˆ›å»ºé¡¹ç›®</h2>
<h3 data-id="heading-6">2.1 åˆå§‹åŒ– Tauri é¡¹ç›®</h3>
<pre><code class="hljs language-bash" lang="bash">npm create tauri-app@latest
</code></pre>
<p>æŒ‰æç¤ºé€‰æ‹©ï¼š</p>
<pre><code class="hljs language-perl" lang="perl">âœ” Project name Â· <span class="hljs-keyword">my</span>-tauri-app
âœ” Identifier Â· com.example.app
âœ” Choose which language to <span class="hljs-keyword">use</span> <span class="hljs-keyword">for</span> your frontend Â· TypeScript / JavaScript
âœ” Choose your <span class="hljs-keyword">package</span> manager Â· npm
âœ” Choose your UI template Â· React
âœ” Choose your UI flavor Â· TypeScript
</code></pre>
<h3 data-id="heading-7">2.2 è¿›å…¥é¡¹ç›®å¹¶å®‰è£…ä¾èµ–</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> my-tauri-app
npm install
</code></pre>
<h3 data-id="heading-8">2.3 é¡¹ç›®ç»“æ„</h3>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-keyword">my</span>-tauri-app/
â”œâ”€â”€ src/                    <span class="hljs-comment"># React å‰ç«¯ä»£ç </span>
â”‚   â”œâ”€â”€ App.tsx
â”‚   â”œâ”€â”€ main.tsx
â”‚   â””â”€â”€ ...
â”œâ”€â”€ src-tauri/              <span class="hljs-comment"># Rust åç«¯ä»£ç </span>
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ lib.rs          <span class="hljs-comment"># ä¸»è¦é€»è¾‘</span>
â”‚   â”‚   â””â”€â”€ main.rs         <span class="hljs-comment"># å…¥å£æ–‡ä»¶</span>
â”‚   â”œâ”€â”€ Cargo.toml          <span class="hljs-comment"># Rust ä¾èµ–é…ç½®</span>
â”‚   â””â”€â”€ tauri.conf.json     <span class="hljs-comment"># Tauri é…ç½®æ–‡ä»¶</span>
â”œâ”€â”€ package.json
â””â”€â”€ ...
</code></pre>
<h3 data-id="heading-9">2.4 å¯åŠ¨å¼€å‘æœåŠ¡å™¨</h3>
<pre><code class="hljs language-bash" lang="bash">npm run tauri dev
</code></pre>
<p>é¦–æ¬¡è¿è¡Œä¼šç¼–è¯‘ Rust ä»£ç ï¼Œéœ€è¦ç­‰å¾…å‡ åˆ†é’Ÿã€‚ä¹‹åä¼šå¼¹å‡ºåº”ç”¨çª—å£ã€‚</p>
<h2 data-id="heading-10">ä¸‰ã€å‰åç«¯é€šä¿¡ï¼šæ ¸å¿ƒæ¦‚å¿µ</h2>
<p>Tauri çš„å‰åç«¯é€šä¿¡ä¸»è¦é€šè¿‡ <strong>Commandsï¼ˆå‘½ä»¤ï¼‰</strong> å®ç°ï¼š</p>
<ul>
<li><strong>Rust ç«¯</strong>ï¼šå®šä¹‰å‘½ä»¤å‡½æ•°ï¼Œå¤„ç†ä¸šåŠ¡é€»è¾‘</li>
<li><strong>React ç«¯</strong>ï¼šè°ƒç”¨å‘½ä»¤ï¼Œè·å–è¿”å›å€¼</li>
</ul>
<p>è¿™æ˜¯ Tauri æœ€æ ¸å¿ƒçš„åŠŸèƒ½ï¼Œä¸‹é¢é€šè¿‡å®æˆ˜æ¡ˆä¾‹è®²è§£ã€‚</p>
<h2 data-id="heading-11">å››ã€å®æˆ˜æ¡ˆä¾‹ï¼šè·å–ç³»ç»Ÿä¿¡æ¯</h2>
<p>æˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªè·å–ç³»ç»Ÿç£ç›˜ä¿¡æ¯çš„åŠŸèƒ½ã€‚</p>
<h3 data-id="heading-12">4.1 Rust ç«¯ï¼šå®šä¹‰å‘½ä»¤</h3>
<p>ç¼–è¾‘ <code>src-tauri/src/lib.rs</code>ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> serde::Serialize;

<span class="hljs-comment">// å®šä¹‰è¿”å›æ•°æ®ç»“æ„</span>
<span class="hljs-meta">#[derive(Debug, Serialize)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">DiskInfo</span> {
    <span class="hljs-keyword">pub</span> drive_letter: <span class="hljs-type">String</span>,
    <span class="hljs-keyword">pub</span> total_space: <span class="hljs-type">u64</span>,
    <span class="hljs-keyword">pub</span> free_space: <span class="hljs-type">u64</span>,
    <span class="hljs-keyword">pub</span> used_space: <span class="hljs-type">u64</span>,
    <span class="hljs-keyword">pub</span> usage_percent: <span class="hljs-type">f64</span>,
}

<span class="hljs-comment">// å®šä¹‰ Tauri å‘½ä»¤</span>
<span class="hljs-meta">#[tauri::command]</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">get_disk_info</span>() <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;DiskInfo, <span class="hljs-type">String</span>&gt; {
    <span class="hljs-comment">// è¿™é‡Œç®€åŒ–å¤„ç†ï¼Œå®é™…å¯ä»¥ä½¿ç”¨ sysinfo åº“è·å–çœŸå®æ•°æ®</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">total</span>: <span class="hljs-type">u64</span> = <span class="hljs-number">500</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>; <span class="hljs-comment">// 500GB</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">free</span>: <span class="hljs-type">u64</span> = <span class="hljs-number">100</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>;  <span class="hljs-comment">// 100GB</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">used</span> = total - free;
    
    <span class="hljs-title function_ invoke__">Ok</span>(DiskInfo {
        drive_letter: <span class="hljs-string">"C"</span>.<span class="hljs-title function_ invoke__">to_string</span>(),
        total_space: total,
        free_space: free,
        used_space: used,
        usage_percent: (used <span class="hljs-keyword">as</span> <span class="hljs-type">f64</span> / total <span class="hljs-keyword">as</span> <span class="hljs-type">f64</span>) * <span class="hljs-number">100.0</span>,
    })
}

<span class="hljs-comment">// æ³¨å†Œå‘½ä»¤</span>
<span class="hljs-meta">#[cfg_attr(mobile, tauri::mobile_entry_point)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">run</span>() {
    tauri::Builder::<span class="hljs-title function_ invoke__">default</span>()
        .<span class="hljs-title function_ invoke__">plugin</span>(tauri_plugin_opener::<span class="hljs-title function_ invoke__">init</span>())
        .<span class="hljs-title function_ invoke__">invoke_handler</span>(tauri::generate_handler![get_disk_info]) <span class="hljs-comment">// æ³¨å†Œå‘½ä»¤</span>
        .<span class="hljs-title function_ invoke__">run</span>(tauri::generate_context!())
        .<span class="hljs-title function_ invoke__">expect</span>(<span class="hljs-string">"error while running tauri application"</span>);
}
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ol>
<li><code>#[tauri::command]</code> å®å°†å‡½æ•°æ ‡è®°ä¸ºå¯è¢«å‰ç«¯è°ƒç”¨çš„å‘½ä»¤</li>
<li>è¿”å›å€¼éœ€è¦å®ç° <code>Serialize</code> trait</li>
<li>ä½¿ç”¨ <code>Result&lt;T, String&gt;</code> å¯ä»¥å‘å‰ç«¯è¿”å›é”™è¯¯ä¿¡æ¯</li>
<li>å¿…é¡»åœ¨ <code>invoke_handler</code> ä¸­æ³¨å†Œå‘½ä»¤</li>
</ol>
<h3 data-id="heading-13">4.2 æ·»åŠ  Rust ä¾èµ–</h3>
<p>ç¼–è¾‘ <code>src-tauri/Cargo.toml</code>ï¼Œç¡®ä¿æœ‰ serde ä¾èµ–ï¼š</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-section">[dependencies]</span>
<span class="hljs-attr">tauri</span> = { version = <span class="hljs-string">"2"</span>, features = [] }
<span class="hljs-attr">serde</span> = { version = <span class="hljs-string">"1"</span>, features = [<span class="hljs-string">"derive"</span>] }
<span class="hljs-attr">serde_json</span> = <span class="hljs-string">"1"</span>
</code></pre>
<h3 data-id="heading-14">4.3 React ç«¯ï¼šè°ƒç”¨å‘½ä»¤</h3>
<p>ç¼–è¾‘ <a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">src/App.tsx</a>ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { invoke } <span class="hljs-keyword">from</span> <span class="hljs-string">'@tauri-apps/api/core'</span>;

<span class="hljs-comment">// å®šä¹‰ç±»å‹ï¼ˆä¸ Rust ç«¯å¯¹åº”ï¼‰</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">DiskInfo</span> {
  <span class="hljs-attr">drive_letter</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">total_space</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">free_space</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">used_space</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">usage_percent</span>: <span class="hljs-built_in">number</span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [diskInfo, setDiskInfo] = useState&lt;<span class="hljs-title class_">DiskInfo</span> | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [loading, setLoading] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [error, setError] = useState&lt;<span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>);

  <span class="hljs-comment">// è°ƒç”¨ Rust å‘½ä»¤</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">fetchDiskInfo</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">true</span>);
    <span class="hljs-title function_">setError</span>(<span class="hljs-literal">null</span>);
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// invoke å‡½æ•°è°ƒç”¨ Rust å‘½ä»¤ï¼Œå‘½ä»¤åä½¿ç”¨è›‡å½¢å‘½åæ³•</span>
      <span class="hljs-keyword">const</span> info = <span class="hljs-keyword">await</span> invoke&lt;<span class="hljs-title class_">DiskInfo</span>&gt;(<span class="hljs-string">'get_disk_info'</span>);
      <span class="hljs-title function_">setDiskInfo</span>(info);
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-title function_">setError</span>(<span class="hljs-title class_">String</span>(err));
    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">false</span>);
    }
  };

  <span class="hljs-comment">// æ ¼å¼åŒ–æ–‡ä»¶å¤§å°</span>
  <span class="hljs-keyword">const</span> formatSize = (<span class="hljs-attr">bytes</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">string</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> gb = bytes / (<span class="hljs-number">1024</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${gb.toFixed(<span class="hljs-number">2</span>)}</span> GB`</span>;
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">padding:</span> '<span class="hljs-attr">20px</span>' }}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Tauri ç£ç›˜ä¿¡æ¯ç¤ºä¾‹<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{fetchDiskInfo}</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">{loading}</span>&gt;</span>
        {loading ? 'åŠ è½½ä¸­...' : 'è·å–ç£ç›˜ä¿¡æ¯'}
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      {error &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">color:</span> '<span class="hljs-attr">red</span>' }}&gt;</span>é”™è¯¯: {error}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      )}

      {diskInfo &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">marginTop:</span> '<span class="hljs-attr">20px</span>' }}&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>ç›˜ç¬¦:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {diskInfo.drive_letter}:<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>æ€»å®¹é‡:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {formatSize(diskInfo.total_space)}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>å·²ç”¨:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {formatSize(diskInfo.used_space)}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>å¯ç”¨:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {formatSize(diskInfo.free_space)}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>ä½¿ç”¨ç‡:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {diskInfo.usage_percent.toFixed(1)}%<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span>;
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ol>
<li>ä½¿ç”¨ <code>@tauri-apps/api/core</code> ä¸­çš„ <code>invoke</code> å‡½æ•°è°ƒç”¨å‘½ä»¤</li>
<li>å‘½ä»¤åéœ€è¦ä½¿ç”¨è›‡å½¢å‘½åæ³•ï¼ˆsnake_caseï¼‰</li>
<li>æ³›å‹å‚æ•°æŒ‡å®šè¿”å›å€¼ç±»å‹</li>
<li>ä½¿ç”¨ try-catch å¤„ç†å¯èƒ½çš„é”™è¯¯</li>
</ol>
<h3 data-id="heading-15">4.4 è¿è¡Œæµ‹è¯•</h3>
<pre><code class="hljs language-bash" lang="bash">npm run tauri dev
</code></pre>
<p>ç‚¹å‡»æŒ‰é’®ï¼Œå³å¯çœ‹åˆ°ä» Rust ç«¯è¿”å›çš„ç£ç›˜ä¿¡æ¯ã€‚</p>
<h2 data-id="heading-16">äº”ã€è¿›é˜¶ï¼šå¸¦å‚æ•°çš„å‘½ä»¤</h2>
<h3 data-id="heading-17">5.1 Rust ç«¯</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-meta">#[tauri::command]</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">greet</span>(name: <span class="hljs-type">String</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">String</span> {
    <span class="hljs-built_in">format!</span>(<span class="hljs-string">"Hello, {}! Welcome to Tauri."</span>, name)
}

<span class="hljs-comment">// è®°å¾—æ³¨å†Œ</span>
.<span class="hljs-title function_ invoke__">invoke_handler</span>(tauri::generate_handler![get_disk_info, greet])
</code></pre>
<h3 data-id="heading-18">5.2 React ç«¯</h3>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">const</span> greeting = <span class="hljs-keyword">await</span> invoke&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">'greet'</span>, { <span class="hljs-attr">name</span>: <span class="hljs-string">'Tauri'</span> });
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(greeting); <span class="hljs-comment">// "Hello, Tauri! Welcome to Tauri."</span>
</code></pre>
<p><strong>æ³¨æ„ï¼š</strong> å‚æ•°ä»¥å¯¹è±¡å½¢å¼ä¼ é€’ï¼Œé”®åå¿…é¡»ä¸ Rust å‡½æ•°å‚æ•°åä¸€è‡´ã€‚</p>
<h2 data-id="heading-19">å…­ã€è¿›é˜¶ï¼šå¼‚æ­¥å‘½ä»¤</h2>
<p>å¯¹äºè€—æ—¶æ“ä½œï¼Œä½¿ç”¨å¼‚æ­¥å‘½ä»¤é¿å…é˜»å¡ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-meta">#[tauri::command]</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">scan_files</span>(path: <span class="hljs-type">String</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">Vec</span>&lt;<span class="hljs-type">String</span>&gt;, <span class="hljs-type">String</span>&gt; {
    <span class="hljs-comment">// æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</span>
    tokio::time::<span class="hljs-title function_ invoke__">sleep</span>(tokio::time::Duration::<span class="hljs-title function_ invoke__">from_secs</span>(<span class="hljs-number">2</span>)).<span class="hljs-keyword">await</span>;
    
    <span class="hljs-title function_ invoke__">Ok</span>(<span class="hljs-built_in">vec!</span>[
        <span class="hljs-built_in">format!</span>(<span class="hljs-string">"{}/file1.txt"</span>, path),
        <span class="hljs-built_in">format!</span>(<span class="hljs-string">"{}/file2.txt"</span>, path),
    ])
}
</code></pre>
<p>éœ€è¦åœ¨ <code>Cargo.toml</code> æ·»åŠ  tokio ä¾èµ–ï¼š</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-section">[dependencies]</span>
<span class="hljs-attr">tokio</span> = { version = <span class="hljs-string">"1"</span>, features = [<span class="hljs-string">"time"</span>] }
</code></pre>
<h2 data-id="heading-20">ä¸ƒã€é…ç½®åº”ç”¨ä¿¡æ¯</h2>
<p>ç¼–è¾‘ <code>src-tauri/tauri.conf.json</code>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"productName"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æˆ‘çš„åº”ç”¨"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"identifier"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"com.example.myapp"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"build"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"frontendDist"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"../dist"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"app"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"windows"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æˆ‘çš„ Tauri åº”ç”¨"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"width"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">900</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"height"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">600</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"resizable"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"center"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-21">å…«ã€æ‰“åŒ…å‘å¸ƒ</h2>
<h3 data-id="heading-22">8.1 æ‰§è¡Œæ‰“åŒ…å‘½ä»¤</h3>
<pre><code class="hljs language-bash" lang="bash">npm run tauri build
</code></pre>
<h3 data-id="heading-23">8.2 æ‰“åŒ…äº§ç‰©</h3>
<p>æ‰“åŒ…å®Œæˆåï¼Œå®‰è£…åŒ…ä½äºï¼š</p>
<pre><code class="hljs language-bash" lang="bash">src-tauri/target/release/bundle/
â”œâ”€â”€ msi/          <span class="hljs-comment"># MSI å®‰è£…åŒ…</span>
â”‚   â””â”€â”€ åº”ç”¨å_ç‰ˆæœ¬_x64_en-US.msi
â””â”€â”€ nsis/         <span class="hljs-comment"># NSIS å®‰è£…åŒ…</span>
    â””â”€â”€ åº”ç”¨å_ç‰ˆæœ¬_x64-setup.exe
</code></pre>
<h3 data-id="heading-24">8.3 å¸¸è§é—®é¢˜ï¼šç½‘ç»œè¶…æ—¶</h3>
<p>å¦‚æœé‡åˆ° <code>timeout: global</code> é”™è¯¯ï¼Œæ˜¯å› ä¸ºä¸‹è½½ NSIS å·¥å…·è¶…æ—¶ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆï¼šæ‰‹åŠ¨ä¸‹è½½ NSIS å¹¶æ”¾åˆ°ç¼“å­˜ç›®å½•ã€‚</p>
<pre><code class="hljs language-powershell" lang="powershell"># åˆ›å»ºç›®å½•
New-Item -ItemType Directory -Path "$env:LOCALAPPDATA\tauri\NSIS" -Force

# æ‰‹åŠ¨ä¸‹è½½ nsis-3.zip å¹¶è§£å‹åˆ°ä¸Šè¿°ç›®å½•
</code></pre>
<h2 data-id="heading-25">ä¹ã€æ€»ç»“</h2>
<p>æœ¬æ–‡ä»‹ç»äº† Tauri 2.0 çš„æ ¸å¿ƒå¼€å‘æµç¨‹ï¼š</p>
<ol>
<li><strong>ç¯å¢ƒæ­å»º</strong>ï¼šå®‰è£… Rust å’Œ Node.js</li>
<li><strong>é¡¹ç›®åˆ›å»º</strong>ï¼šä½¿ç”¨è„šæ‰‹æ¶å¿«é€Ÿåˆå§‹åŒ–</li>
<li><strong>å‰åç«¯é€šä¿¡</strong>ï¼šé€šè¿‡ Commands å®ç° React ä¸ Rust çš„æ•°æ®äº¤äº’</li>
<li><strong>æ‰“åŒ…å‘å¸ƒ</strong>ï¼šç”Ÿæˆ Windows å®‰è£…åŒ…</li>
</ol>
<p>Tauri çš„ä¼˜åŠ¿åœ¨äºå°ä½“ç§¯ã€é«˜æ€§èƒ½ã€å¼ºå®‰å…¨æ€§ï¼Œéå¸¸é€‚åˆå¼€å‘è½»é‡çº§æ¡Œé¢å·¥å…·ã€‚å¸Œæœ›è¿™ç¯‡æ•™ç¨‹èƒ½å¸®åŠ©ä½ å¿«é€Ÿä¸Šæ‰‹ Tauri å¼€å‘ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[elpiså…¨æ ˆæ¡†æ¶çš„ç†è§£]]></title>    <link>https://juejin.cn/post/7599920572840017929</link>    <guid>https://juejin.cn/post/7599920572840017929</guid>    <pubDate>2026-01-27T12:47:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599920572840017929" data-draft-id="7599565587154173978" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="elpiså…¨æ ˆæ¡†æ¶çš„ç†è§£"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-27T12:47:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Hashan"/> <meta itemprop="url" content="https://juejin.cn/user/3523276916662526"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            elpiså…¨æ ˆæ¡†æ¶çš„ç†è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3523276916662526/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Hashan
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T12:47:17.000Z" title="Tue Jan 27 2026 12:47:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»18åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<h3 data-id="heading-1">èƒŒæ™¯</h3>
<p>åœ¨å‰ç«¯å¼€å‘åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¸¸éœ€æ­å»ºå„ç±»ä¸­åå°ç³»ç»Ÿï¼ŒåŠŸèƒ½çœ‹ä¼¼å¤šæ ·ï¼Œæ ¸å¿ƒå´å¤šä¸º CRUD é¡µé¢ã€‚è¿™ç±»é‡å¤æ€§å¼€å‘ä¸ä»…æ•ˆç‡ä½ä¸‹ï¼Œå¯¹ä¸ªäººæŠ€æœ¯èƒ½åŠ›çš„æå‡ä¹Ÿæ¯«æ— å¸®åŠ©ã€‚<br/>æ›´å…³é”®çš„æ˜¯ï¼Œå¤šæ•°ä¸­åå°ç³»ç»Ÿä»…å­˜åœ¨ç»†å¾®å·®å¼‚ â€”â€” ä»¥ç”µå•†ç³»ç»Ÿä¸ºä¾‹ï¼Œé¦–æ¬¡å¼€å‘å¯èƒ½åŒ…å«å•†å“ç®¡ç†ã€è®¢å•ç®¡ç†ã€ä¼šå‘˜ç®¡ç†ä¸ä¼˜æƒ ç®¡ç†æ¨¡å—ï¼Œè€Œåç»­éœ€è¦å¼€å‘æ–°çš„ç”µå•†ç³»ç»Ÿï¼Œå®ƒçš„éœ€æ±‚æˆ–è®¸ä»…æ–°å¢ä¸€ä¸ªåˆ†é”€ç®¡ç†æ¨¡å—ï¼ŒåŸºç¡€åŠŸèƒ½å¹¶æ— æœ¬è´¨å˜åŒ–ã€‚<br/>
æˆ‘ä»¬è¿™æ—¶å€™ï¼Œå¾€å¾€é‡æ–°å¼€å‘æˆ–å¯¹æ—§é¡¹ç›®è¿›è¡Œ â€œé­”æ”¹â€ï¼Œæ—¢æµªè´¹å¤§é‡æ—¶é—´ï¼Œåˆç¼ºä¹æŠ€æœ¯çªç ´çš„ä»·å€¼ã€‚å°¤å…¶åœ¨ AI æŠ€æœ¯é£é€Ÿå‘å±•çš„å½“ä¸‹ï¼Œè‹¥é•¿æœŸå±€é™äºè¿™ç±»ä½æŠ€æœ¯å«é‡çš„ä¸šåŠ¡å¼€å‘ï¼Œä¸ªäººç«äº‰åŠ›å¿…ç„¶ä¼šæŒç»­ä¸‹é™ã€‚</p>
<br/>
<h3 data-id="heading-2">å¦‚ä½•è§£å†³æ­¤é—®é¢˜å‘¢ï¼Ÿ</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fcb65614dbdf4350946bb91d8c76b24b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGFzaGFu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770122836&amp;x-signature=uIVfPK23r3dd5E4hqI7Hztm%2Fqac%3D" alt="image.png" loading="lazy"/></p>
<p>elpis å…¨æ ˆæ¡†æ¶é‡Œ â€”â€” é¢†åŸŸæ¨¡å‹ + BFF Serve+Dashboard æ¨¡æ¿é¡µ ä¸ºæ ¸å¿ƒï¼Œæ„å»ºä¸€å¥—å¯å¤ç”¨ã€é«˜çµæ´»çš„è§£å†³æ–¹æ¡ˆï¼Œè®©ä¸­åå°å¼€å‘ä» â€œé‡å¤CRUDâ€ è½¬å‘ â€œé…ç½®åŒ–æ­å»ºâ€ã€‚</p>
<p>é¢†åŸŸæ¨¡å‹æ˜¯æ•´ä¸ªæ–¹æ¡ˆçš„ â€œè“å›¾å¼•æ“â€ï¼šåŸºäº JSON Schema å®šä¹‰ç³»ç»Ÿæ ¸å¿ƒç»“æ„ï¼Œä¸ä»…èƒ½æè¿°åŸºç¡€åŠŸèƒ½æ¨¡å—ï¼ˆå¦‚è®¢å•ç®¡ç†ã€å•†å“ç®¡ç†ï¼‰ï¼Œè¿˜æ”¯æŒé€šè¿‡ â€œåŸºç±» + å­ç±»â€ çš„å±‚çº§è®¾è®¡æ‹“å±•ä¸ªæ€§åŒ–éœ€æ±‚ã€‚æ¯”å¦‚ç”µå•†åœºæ™¯ä¸­ï¼Œâ€œè®¢å•ç®¡ç† + å•†å“ç®¡ç†â€ å¯ä½œä¸ºé€šç”¨åŸºç±»ï¼Œç”µå•† A éœ€æ–°å¢çš„ â€œä¼˜æƒ åˆ¸ç®¡ç†â€ã€ç”µå•† B éœ€è¡¥å……çš„ â€œåˆ†é”€ç®¡ç†â€ï¼Œåˆ™å¯ä½œä¸ºå­ç±»çµæ´»æŒ‚è½½ã€‚</p>
<p>BFF Serve æ‰®æ¼” â€œæ¡¥æ¢ä¸é©±åŠ¨â€ çš„è§’è‰²ï¼šæä¾› SSR æœåŠ¡ï¼Œå®ä¾‹åŒ–é¡¹ç›®ï¼ŒAPIæ¥å£æœåŠ¡</p>
<p>Dashboard æ¨¡æ¿é¡µæ˜¯ â€œå¯è§†åŒ–å‘ˆç°ç»ˆç«¯â€ï¼šæ— éœ€å•ç‹¬å¼€å‘é¡µé¢ï¼Œåªéœ€æ¥æ”¶ BFF å±‚ä¼ é€’çš„é¢†åŸŸæ¨¡å‹é…ç½®ï¼Œå°±èƒ½è‡ªåŠ¨æ¸²æŸ“å‡ºç¬¦åˆä¸šåŠ¡éœ€æ±‚çš„ç³»ç»Ÿç•Œé¢ã€‚</p>
<p>ä¸¾ä¸ªå®é™…ä¾‹å­ï¼šæ­å»ºç”µå•† A ç³»ç»Ÿæ—¶ï¼Œæˆ‘ä»¬åªéœ€åœ¨é¢†åŸŸæ¨¡å‹ä¸­é…ç½® â€œåŸºç±»ï¼ˆè®¢å•ç®¡ç† + å•†å“ç®¡ç†ï¼‰+ å­ç±»ï¼ˆä¼˜æƒ åˆ¸ç®¡ç†ï¼‰â€ï¼›å¯åŠ¨ç³»ç»Ÿåï¼ŒBFF Serve ä¼šè¯»å–è¿™ä»½é…ç½®å¹¶åŒæ­¥ç»™ Dashboard æ¨¡æ¿é¡µï¼Œæœ€ç»ˆå‘ˆç°çš„ç”µå•† A ç³»ç»Ÿï¼Œå°±è‡ªå¸¦ â€œè®¢å•ç®¡ç† + å•†å“ç®¡ç† + ä¼˜æƒ åˆ¸ç®¡ç†â€ å…¨å¥—åŠŸèƒ½ã€‚æ­å»ºç”µå•† B ç³»ç»ŸåŒç†ï¼Œä»…éœ€è°ƒæ•´é¢†åŸŸæ¨¡å‹ä¸º â€œåŸºç±» + å­ç±»ï¼ˆåˆ†é”€ç®¡ç†ï¼‰â€ï¼Œå³å¯å¿«é€Ÿç”ŸæˆåŒ…å«åˆ†é”€åŠŸèƒ½çš„ç”µå•†ç³»ç»Ÿ â€”â€” å…¨ç¨‹æ— éœ€é‡å†™ä»£ç ï¼Œä»…é é…ç½®é¢†åŸŸæ¨¡å‹ï¼Œå°±èƒ½å®ç°ä¸­åå°ç³»ç»Ÿçš„å¿«é€Ÿæ­å»ºã€‚</p>
<h2 data-id="heading-3">é‡Œç¨‹ç¢‘ä¸€ åŸºäº nodejs å®ç°æœåŠ¡ç«¯å†…æ ¸å¼•æ“</h2>
<p>elpis å…¨æ ˆæ¡†æ¶çš„ç¬¬ä¸€æ­¥ï¼Œä¾¿æ˜¯ä»¥ Node.js æ„å»º BFF Serve å±‚ â€”â€” å¯¹æˆ‘ä»¬è€Œè¨€ï¼ŒNode.js å…·å¤‡å¤©ç„¶çš„æŠ€æœ¯é€‚é…æ€§ï¼Œä¸Šæ‰‹é—¨æ§›æ›´ä½ã€‚</p>
<p>ä½†ä¼ ç»Ÿ Node å¼€å‘ä¸­ï¼Œå›¢é˜Ÿå¸¸é™·å…¥ â€œç›®å½•ç»“æ„ä¸ç»Ÿä¸€â€â€œç¼–ç è§„èŒƒéš¾è½åœ°â€â€œä¸­é—´ä»¶ä½¿ç”¨æ— è§„åˆ™â€ çš„å›°å¢ƒï¼šè·¯ç”±è¯¥æ”¾åœ¨å“ªä¸ªç›®å½•ï¼ŸæœåŠ¡é€»è¾‘ä¸é…ç½®ç®¡ç†å¦‚ä½•æ‹†åˆ†ï¼Ÿè¿™äº›é—®é¢˜å¾€å¾€æ¶ˆè€—å¤§é‡æ²Ÿé€šæˆæœ¬ã€‚å› æ­¤ï¼Œelpis æ¡†æ¶åŸºäº Koa å°è£…äº†Â <strong>elpis-core å¼•æ“</strong>ï¼Œé€šè¿‡é¢„è®¾è§„èŒƒä¸è‡ªåŠ¨åŒ–èƒ½åŠ›ï¼ŒæŠŠå¼€å‘è€…ä»åŸºç¡€æ­å»ºä¸­è§£æ”¾å‡ºæ¥ï¼Œåªéœ€ä¸“æ³¨ä¸šåŠ¡å¼€å‘ã€‚</p>
<h4 data-id="heading-4">ä¸€ã€è§„èŒƒç›®å½•ä¸è‡ªåŠ¨åŒ–åŠ è½½</h4>
<p>elpis-core å¼•æ“ä»¥ â€œçº¦å®šä¼˜äºé…ç½®â€ ä¸ºåŸåˆ™ï¼Œå®šä¹‰äº†æ¸…æ™°çš„é¡¹ç›®ç›®å½•ç»“æ„ï¼Œæ‰€æœ‰æ¨¡å—æŒ‰åŠŸèƒ½å½’ç±»ï¼Œæ— éœ€å›¢é˜Ÿåå¤åå•†å­˜æ”¾ä½ç½®ï¼š</p>
<pre><code class="hljs language-plaintext" lang="plaintext">elpis
  |-- app/                # æ ¸å¿ƒä¸šåŠ¡ç›®å½•ï¼ˆæŒ‰çº¦å®šå­˜æ”¾ä¸šåŠ¡æ¨¡å—ï¼‰
  |   |-- controller/     # æ§åˆ¶å™¨å±‚ï¼šå¤„ç†è¯·æ±‚ã€è°ƒç”¨æœåŠ¡ã€è¿”å›å“åº”
  |   |-- extend/         # æ‰©å±•å±‚ï¼šå…¨å±€èƒ½åŠ›æ‰©å±•ï¼ˆå¦‚å·¥å…·å‡½æ•°ã€API å¢å¼ºï¼‰
  |   |-- middleware/     # ä¸­é—´ä»¶å±‚ï¼šå±€éƒ¨ä¸­é—´ä»¶ï¼ˆå¦‚æ¥å£æƒé™æ ¡éªŒï¼‰
  |   |-- public/         # é™æ€èµ„æºå±‚ï¼šå­˜æ”¾é™æ€æ–‡ä»¶
  |   |-- router/         # è·¯ç”±å±‚ï¼šå®šä¹‰â€œè¯·æ±‚è·¯å¾„â†’æ§åˆ¶å™¨â€æ˜ å°„å…³ç³»
  |   |-- router-schema/  # è·¯ç”±æ ¡éªŒå±‚ï¼šç”¨ JSON-Schema å®šä¹‰æ¥å£å‚æ•°è§„åˆ™
  |   |-- service/        # æœåŠ¡å±‚ï¼šå°è£…æ•°æ®å¤„ç†ã€ç¬¬ä¸‰æ–¹æ¥å£è°ƒç”¨ï¼ˆä¾›æ§åˆ¶å™¨å¤ç”¨ï¼‰
  |   |-- middlewares.js  # å…¨å±€ä¸­é—´ä»¶é…ç½®ï¼šæ³¨å†Œå…¨é“¾è·¯ç”Ÿæ•ˆçš„ä¸­é—´ä»¶
  |-- config/             # é…ç½®ç›®å½•ï¼šåŒºåˆ†æœ¬åœ°/æµ‹è¯•/ç”Ÿäº§ç¯å¢ƒçš„å·®å¼‚åŒ–é…ç½®
  |-- elpis-core/         # å¼•æ“å†…æ ¸ï¼šæä¾›è‡ªåŠ¨åŠ è½½ã€ç¯å¢ƒé€‚é…ç­‰æ ¸å¿ƒèƒ½åŠ›
  |   |-- loader/         # åŠ è½½å™¨é›†åˆï¼šå¯¹åº”å„æ¨¡å—çš„è‡ªåŠ¨åŒ–åŠ è½½é€»è¾‘
  |   |   |-- config.js   # é…ç½®åŠ è½½å™¨ï¼šè‡ªåŠ¨åŠ è½½ config ç›®å½•ä¸‹çš„ç¯å¢ƒé…ç½®
  |   |   |-- controller.js # æ§åˆ¶å™¨åŠ è½½å™¨ï¼šè‡ªåŠ¨åŠ è½½ controller æ¨¡å—å¹¶æŒ‚è½½
  |   |   |-- extend.js   # æ‰©å±•åŠ è½½å™¨ï¼šè‡ªåŠ¨åŠ è½½ extend å±‚çš„å…¨å±€èƒ½åŠ›
  |   |   |-- middleware.js # ä¸­é—´ä»¶åŠ è½½å™¨ï¼šè‡ªåŠ¨åŠ è½½ middleware æ¨¡å—
  |   |   |-- router-schema.js # è·¯ç”±æ ¡éªŒåŠ è½½å™¨ï¼šè‡ªåŠ¨åŠ è½½æ¥å£å‚æ•°æ ¡éªŒè§„åˆ™
  |   |   |-- router.js   # è·¯ç”±åŠ è½½å™¨ï¼šè‡ªåŠ¨åŠ è½½è·¯ç”±æ˜ å°„å…³ç³»
  |   |   |-- service.js  # æœåŠ¡åŠ è½½å™¨ï¼šè‡ªåŠ¨åŠ è½½ service å±‚çš„ä¸šåŠ¡é€»è¾‘
  |   |-- env.js          # ç¯å¢ƒåˆ¤æ–­å·¥å…·ï¼šå¿«é€ŸåŒºåˆ†æœ¬åœ°/æµ‹è¯•/ç”Ÿäº§ç¯å¢ƒ
  |   |-- index.js        # å¼•æ“å…¥å£ï¼šæ•´åˆæ‰€æœ‰åŠ è½½å™¨ã€åˆå§‹åŒ– Koa å®ä¾‹
  |-- index.js            # é¡¹ç›®å…¥å£ï¼šä¸€é”®å¯åŠ¨ elpis å¼•æ“
</code></pre>
<p>å…¶ä¸­ï¼Œ<strong>åŠ è½½å™¨ï¼ˆloaderï¼‰</strong> Â æ˜¯è‡ªåŠ¨åŒ–çš„æ ¸å¿ƒï¼šæ¯ä¸ªæ¨¡å—ï¼ˆå¦‚ controllerã€serviceã€routerï¼‰éƒ½å¯¹åº”ä¸“å±åŠ è½½å™¨ï¼ŒåŠ è½½å™¨ä¼šä¸»åŠ¨éå†ç›®æ ‡ç›®å½•ã€è§£ææ–‡ä»¶å†…å®¹ï¼Œå¹¶å°†æ¨¡å—è‡ªåŠ¨æŒ‚è½½åˆ° Koa å®ä¾‹ä¸Šã€‚ä»¥æ§åˆ¶å™¨åŠ è½½ä¸ºä¾‹ï¼Œæ•´ä¸ªæµç¨‹å®Œå…¨æ— éœ€æ‰‹åŠ¨å¹²é¢„ï¼š</p>
<ol>
<li>è¯»å–Â <code>elpis/app/controller/**/*.js</code>Â ä¸‹æ‰€æœ‰æ–‡ä»¶ï¼›</li>
<li>æå–æ–‡ä»¶åç§°ä¸è·¯å¾„ï¼Œå¦‚Â <code>app/controller/custom-module/custom-controller.js</code>ï¼›</li>
<li>æˆªå–è·¯å¾„æ ¸å¿ƒéƒ¨åˆ†ï¼Œå¾—åˆ°Â <code>custom-module/custom-controller</code>ï¼›</li>
<li>å°†è·¯å¾„ä¸­çš„ â€œ-â€ è½¬ä¸ºé©¼å³°å¼å‘½åï¼Œå³Â <code>customModule.customController</code>ï¼›</li>
<li>è‡ªåŠ¨æŒ‚è½½åˆ°å†…å­˜Â <code>app</code>Â å¯¹è±¡ä¸­</li>
</ol>
<h4 data-id="heading-5">ä»å¯åŠ¨åˆ°è¯·æ±‚çš„å…¨é“¾è·¯ä¼˜åŒ–</h4>
<p>å›ºå®šå¯åŠ¨é¡ºåºï¼Œé¿å…æ¨¡å—ä¾èµ–æ··ä¹±</p>
<p>elpis-core å¼•æ“å®šä¹‰äº†ä¸¥æ ¼çš„æ¨¡å—å¯åŠ¨é¡ºåºï¼Œç¡®ä¿å„æ¨¡å—æŒ‰ä¾èµ–å…³ç³»åŠ è½½ï¼Œé¿å… â€œæœªå®šä¹‰â€ é”™è¯¯ï¼š</p>
<pre><code class="hljs language-plaintext" lang="plaintext">é…ç½®ç¯å¢ƒ â†’ åŠ è½½é…ç½® â†’ æ‰©å±•åŠ è½½ â†’ ä¸­é—´ä»¶åŠ è½½ â†’ æœåŠ¡åŠ è½½ â†’ æ§åˆ¶å™¨åŠ è½½ â†’ å…¨å±€ä¸­é—´ä»¶æ³¨å†Œ â†’ è·¯ç”±æ¨¡å¼åŠ è½½ â†’ è·¯ç”±æ³¨å†Œ
</code></pre>
<p>ä»ç¯å¢ƒåˆ¤æ–­åˆ°è·¯ç”±ç”Ÿæ•ˆï¼Œæ¯ä¸€æ­¥éƒ½ç”±å¼•æ“è‡ªåŠ¨æ‰§è¡Œï¼Œå¼€å‘è€…æ— éœ€æ‰‹åŠ¨ç®¡ç†åŠ è½½é¡ºåºã€‚</p>
<h4 data-id="heading-6">ç¯å¢ƒä¸è·¯ç”±çš„ç²¾ç»†åŒ–ç®¡ç†</h4>
<ul>
<li><strong>ç¯å¢ƒé…ç½®</strong>ï¼šé€šè¿‡Â <code>elpis-core/env.js</code>Â å®ç°ç¯å¢ƒå˜é‡ç»Ÿä¸€ç®¡ç†ï¼Œå¯å¿«é€ŸåŒºåˆ†æœ¬åœ°å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒï¼Œé…ç½®æ–‡ä»¶æŒ‰ç¯å¢ƒæ‹†åˆ†åï¼ŒåŠ è½½å™¨ä¼šè‡ªåŠ¨åŒ¹é…å½“å‰ç¯å¢ƒå¹¶åŠ è½½å¯¹åº”é…ç½®ï¼›</li>
<li><strong>è·¯ç”±ç®¡ç†</strong>ï¼šç»“åˆ JSON-Schema å®šä¹‰è·¯ç”±å‚æ•°è§„åˆ™ï¼Œä¸ä»…èƒ½è‡ªåŠ¨æ ¡éªŒè¯·æ±‚å‚æ•°åˆæ³•æ€§ï¼Œè¿˜èƒ½è®©æ¥å£æ–‡æ¡£ä¸ä»£ç é€»è¾‘ä¿æŒä¸€è‡´ï¼Œå‡å°‘ â€œæ–‡æ¡£ä¸å®é™…æ¥å£ä¸åŒ¹é…â€ çš„é—®é¢˜ï¼›</li>
<li><strong>è¯·æ±‚å“åº”é“¾è·¯</strong>ï¼šé€šè¿‡ â€œè·¯ç”±â†’æ§åˆ¶å™¨â†’æœåŠ¡â†’ä¸­é—´ä»¶â€ çš„é“¾è·¯è®¾è®¡ï¼Œå®ç°è¯·æ±‚å¤„ç†çš„è§£è€¦ï¼šè·¯ç”±è´Ÿè´£æ˜ å°„è·¯å¾„ï¼Œæ§åˆ¶å™¨è´Ÿè´£è¯·æ±‚åˆ†å‘ï¼ŒæœåŠ¡è´Ÿè´£ä¸šåŠ¡é€»è¾‘ï¼Œä¸­é—´ä»¶è´Ÿè´£é€šç”¨èƒ½åŠ›ï¼ˆå¦‚æƒé™æ ¡éªŒã€æ—¥å¿—è®°å½•ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-7">å¯æ‰©å±•çš„ç”Ÿæ€èƒ½åŠ›</h4>
<p>elpis-core å¼•æ“æ”¯æŒè‡ªå®šä¹‰æ’ä»¶ä¸åŠŸèƒ½æ‰©å±•ï¼š</p>
<ul>
<li><strong>æ’ä»¶æœºåˆ¶</strong>ï¼šå¯æ¥å…¥å¤šä¸ªè‡ªå®šä¹‰æ’ä»¶ï¼Œæ»¡è¶³ä¸ªæ€§åŒ–ä¸šåŠ¡éœ€æ±‚ï¼ˆå¦‚æ—¥å¿—æ’ä»¶ã€ç›‘æ§æ’ä»¶ï¼‰ï¼›</li>
<li><strong>åŠŸèƒ½æ‰©å±•</strong>ï¼šé€šè¿‡Â <code>extend</code>Â å±‚å¯æ‰©å±•å…¨å±€èƒ½åŠ›ï¼Œå¦‚æ–°å¢å·¥å…·å‡½æ•°ã€å¢å¼º API å“åº”æ ¼å¼ç­‰ï¼Œæ‰©å±•å†…å®¹ç”±åŠ è½½å™¨è‡ªåŠ¨ç”Ÿæ•ˆï¼Œæ— éœ€ä¿®æ”¹å¼•æ“æ ¸å¿ƒä»£ç ã€‚</li>
</ul>
<h2 data-id="heading-8">é‡Œç¨‹ç¢‘äºŒ åŸºäº webpack5 å®Œæˆå·¥ç¨‹åŒ–å»ºè®¾</h2>
<p>ä½œä¸º elpis å…¨æ ˆæ¡†æ¶çš„ç¬¬äºŒæ­¥ï¼Œæœ¬é˜¶æ®µæ ¸å¿ƒæ˜¯ä¸ºå‰ç«¯ Dashboard æ¨¡æ¿é¡µæ­å»ºå·¥ç¨‹åŒ–åŸºç¡€ï¼Œé€šè¿‡æ‹†åˆ† webpack é…ç½®å®ç° â€œç¯å¢ƒå·®å¼‚åŒ–æ„å»ºâ€ï¼ŒåŒæ—¶é€‚é…æœåŠ¡ç«¯æ¸²æŸ“ä¸ Vue3 æŠ€æœ¯æ ˆéœ€æ±‚ã€‚</p>
<h4 data-id="heading-9">ä¸€ã€é…ç½®æ‹†åˆ†ï¼šæŒ‰ç¯å¢ƒè§£è€¦ï¼Œå…¼é¡¾å¼€å‘ä¸ç”Ÿäº§</h4>
<p>å°† webpack é…ç½®æ‹†åˆ†ä¸ºä¸‰ç±»ï¼Œé€šè¿‡Â <code>dev.js</code>Â å’ŒÂ <code>prod.js</code>Â åˆ†åˆ«è°ƒç”¨ï¼Œå®ç°ä¸åŒç¯å¢ƒçš„è‡ªåŠ¨åŒ–æ„å»ºï¼š</p>
<ul>
<li><strong><code>webpack.base.js</code></strong>ï¼šåŸºç¡€é…ç½®ï¼ˆåŸºç±»ï¼‰ï¼Œå®šä¹‰å…¥å£ã€loaderã€æ’ä»¶ã€åˆ†åŒ…ç­–ç•¥ç­‰é€šç”¨é€»è¾‘ï¼Œé¿å…é‡å¤ç¼–ç ï¼›</li>
<li><strong><code>webpack.dev.js</code></strong>ï¼šå¼€å‘ç¯å¢ƒé…ç½®ï¼Œä¾§é‡çƒ­æ›´æ–°ï¼ˆHMRï¼‰ã€SourceMap ç­‰æå‡å¼€å‘æ•ˆç‡çš„èƒ½åŠ›ï¼›</li>
<li><strong><code>webpack.prod.js</code></strong>ï¼šç”Ÿäº§ç¯å¢ƒé…ç½®ï¼Œèšç„¦æ‰“åŒ…ä¼˜åŒ–ï¼ˆå¤šçº¿ç¨‹ã€èµ„æºå‹ç¼©ã€ç¼“å­˜æ¸…ç†ï¼‰ï¼Œä¿éšœçº¿ä¸Šæ€§èƒ½ã€‚</li>
</ul>
<h4 data-id="heading-10">äºŒã€æ ¸å¿ƒé…ç½®å®ç°ï¼šä»å…¥å£åˆ°ä¼˜åŒ–çš„å…¨é“¾è·¯é€‚é…</h4>
<h5 data-id="heading-11">1. åŸºç¡€é…ç½®ï¼ˆwebpack.base.jsï¼‰ï¼šé€‚é…æœåŠ¡ç«¯æ¸²æŸ“çš„æ ¸å¿ƒé€»è¾‘</h5>
<p>ï¼ˆ1ï¼‰å…¥å£å¤„ç†ï¼šåŠ¨æ€è¯†åˆ«å¤šé¡µé¢å…¥å£</p>
<p>åŒºåˆ«äºæ™®é€šå‰ç«¯é¡¹ç›®çš„å›ºå®šå…¥å£ï¼Œæ¡†æ¶é€šè¿‡ glob åŒ¹é…Â <code>app/pages/**/entry.*.js</code>ï¼ˆå¦‚Â <code>entry.dashboard.js</code>ï¼‰ï¼Œè‡ªåŠ¨ç”Ÿæˆå…¥å£é…ç½®ä¸ HTML æ¨¡æ¿ï¼Œé€‚é…æœåŠ¡ç«¯æ¸²æŸ“åœºæ™¯ï¼ˆç”¨æˆ·è®¿é—®Â <code>http://ip:port/view/xxxx</code>Â æ—¶ï¼ŒæœåŠ¡ç«¯è¿”å›ä¸»é¡µé¢ï¼Œå…¶ä»–é¡µé¢ç”± Vue Router æ¸²æŸ“ï¼‰ï¼š</p>
<p>js</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// 1. åŒ¹é…æ‰€æœ‰ entry.xx.js å…¥å£æ–‡ä»¶</span>
<span class="hljs-selector-tag">const</span> <span class="hljs-selector-tag">elpisEntryList</span> = <span class="hljs-selector-tag">path</span><span class="hljs-selector-class">.resolve</span>(__dirname, <span class="hljs-string">"../../pages/**/entry.*.js"</span>);
<span class="hljs-comment">// 2. æ„é€ å…¥å£ä¸ HTML æ¨¡æ¿</span>
<span class="hljs-selector-tag">glob</span><span class="hljs-selector-class">.sync</span>(elpisEntryList)<span class="hljs-selector-class">.forEach</span>(file =&gt; {
  <span class="hljs-selector-tag">const</span> <span class="hljs-selector-tag">entryName</span> = <span class="hljs-selector-tag">path</span><span class="hljs-selector-class">.basename</span>(file, <span class="hljs-string">".js"</span>);
  <span class="hljs-comment">// å…¥å£é…ç½®ï¼škey ä¸ºå…¥å£åï¼Œvalue ä¸ºæ–‡ä»¶è·¯å¾„</span>
  <span class="hljs-selector-tag">elpisPageEntries</span><span class="hljs-selector-attr">[entryName]</span> = <span class="hljs-selector-tag">file</span>;
  <span class="hljs-comment">// HTML æ¨¡æ¿ï¼šæŒ‡å®šè¾“å‡ºè·¯å¾„ã€æ¨¡æ¿æ–‡ä»¶ä¸æ³¨å…¥çš„ä»£ç å—</span>
  <span class="hljs-selector-tag">elpisHtmlWebpackPluginList</span><span class="hljs-selector-class">.push</span>(new <span class="hljs-built_in">HtmlWebpackPlugin</span>({
    <span class="hljs-attribute">filename</span>: path.<span class="hljs-built_in">resolve</span>(process.<span class="hljs-built_in">cwd</span>(), <span class="hljs-string">"./app/public/dist/"</span>, <span class="hljs-built_in">`.tpl`</span>),
    <span class="hljs-attribute">template</span>: path.<span class="hljs-built_in">resolve</span>(__dirname, <span class="hljs-string">"../../view/entry.tpl"</span>),
    <span class="hljs-attribute">chunks</span>: [entryName]
  }));
});
<span class="hljs-comment">// æœ€ç»ˆå…¥å£é…ç½®</span>
<span class="hljs-selector-tag">entry</span>: <span class="hljs-selector-tag">elpisPageEntries</span>,
</code></pre>
<p>ï¼ˆ2ï¼‰loader é…ç½®ï¼šé€‚é… Vue3 + Less æŠ€æœ¯æ ˆ</p>
<p>é’ˆå¯¹ Vue å•æ–‡ä»¶ç»„ä»¶ã€ES6 è¯­æ³•ã€æ ·å¼ä¸é™æ€èµ„æºï¼Œé…ç½®ä¸“å± loaderï¼Œç¡®ä¿ä»£ç æ­£å¸¸è§£æï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-attr">rules</span>: [
  { <span class="hljs-attr">test</span>: <span class="hljs-regexp">/.vue$/</span>, <span class="hljs-attr">use</span>: <span class="hljs-string">"vue-loader"</span> }, <span class="hljs-comment">// è§£æ Vue æ–‡ä»¶</span>
  { <span class="hljs-attr">test</span>: <span class="hljs-regexp">/.js$/</span>, <span class="hljs-attr">include</span>: [pagesç›®å½•], <span class="hljs-attr">use</span>: <span class="hljs-string">"babel-loader"</span> }, <span class="hljs-comment">// è½¬è¯‘ ES6</span>
  { <span class="hljs-attr">test</span>: <span class="hljs-regexp">/.(png|jpg|gif)$/</span>, <span class="hljs-attr">use</span>: { <span class="hljs-attr">loader</span>: <span class="hljs-string">"url-loader"</span>, <span class="hljs-attr">options</span>: { <span class="hljs-attr">limit</span>: <span class="hljs-number">300</span> } } }, <span class="hljs-comment">// å°å›¾è½¬ base64</span>
  { <span class="hljs-attr">test</span>: <span class="hljs-regexp">/.css$/</span>, <span class="hljs-attr">use</span>: [<span class="hljs-string">"style-loader"</span>, <span class="hljs-string">"css-loader"</span>] }, <span class="hljs-comment">// è§£æ CSS</span>
  { <span class="hljs-attr">test</span>: <span class="hljs-regexp">/.less$/</span>, <span class="hljs-attr">use</span>: [<span class="hljs-string">"style-loader"</span>, <span class="hljs-string">"css-loader"</span>, <span class="hljs-string">"less-loader"</span>] }, <span class="hljs-comment">// è§£æ Less</span>
  { <span class="hljs-attr">test</span>: <span class="hljs-regexp">/.(eot|woff|woff2|svg|ttf)$/</span>, <span class="hljs-attr">use</span>: <span class="hljs-string">"file-loader"</span> } <span class="hljs-comment">// è§£æå­—ä½“</span>
]
</code></pre>
<p>ï¼ˆ3ï¼‰æ’ä»¶ä¸ä¼˜åŒ–ï¼šä¿éšœåŸºç¡€åŠŸèƒ½ä¸æ€§èƒ½</p>
<ul>
<li>
<p><strong>æ’ä»¶</strong>ï¼šé…ç½®Â <code>VueLoaderPlugin</code>ï¼ˆè§£æ Vue ç»„ä»¶ï¼‰ã€<code>DefinePlugin</code>ï¼ˆå®šä¹‰ Vue å…¨å±€å¸¸é‡ï¼Œå¦‚ç¦ç”¨ç”Ÿäº§ç¯å¢ƒè°ƒè¯•å·¥å…·ï¼‰ï¼Œå¹¶æ³¨å…¥åŠ¨æ€ç”Ÿæˆçš„ HTML æ¨¡æ¿ï¼›</p>
</li>
<li>
<p><strong>åˆ†åŒ…ç­–ç•¥</strong>ï¼šé€šè¿‡Â <code>splitChunks</code>Â å°†ä»£ç åˆ†ä¸ºä¸‰ç±»ï¼Œåˆ©ç”¨æµè§ˆå™¨ç¼“å­˜å‡å°‘é‡å¤åŠ è½½ï¼š</p>
<ul>
<li><code>vendor</code>ï¼šç¬¬ä¸‰æ–¹ä¾èµ–ï¼ˆå¦‚ Vueã€Vue Routerï¼‰ï¼Œæ”¹åŠ¨é¢‘ç‡ä½ï¼›</li>
<li><code>common</code>ï¼šä¸šåŠ¡å…¬å…±ç»„ä»¶ï¼ˆå¦‚Â <code>common</code>/<code>widgets</code>Â ç›®å½•ï¼‰ï¼Œè¢«å¼•ç”¨ â‰¥2 æ¬¡å³æŠ½å–ï¼›</li>
<li><code>entry.{page}</code>ï¼šé¡µé¢ç§æœ‰ä¸šåŠ¡ä»£ç ï¼Œæ”¹åŠ¨é¢‘ç‡é«˜ã€‚</li>
</ul>
</li>
</ul>
<h5 data-id="heading-12">2. å¼€å‘ç¯å¢ƒé…ç½®ï¼ˆwebpack.dev.jsï¼‰ï¼šèšç„¦å¼€å‘æ•ˆç‡</h5>
<p>æ ¸å¿ƒå®ç°ä¸‰é¡¹èƒ½åŠ›ï¼š</p>
<ul>
<li><strong>HMR çƒ­æ›´æ–°</strong>ï¼šåœ¨å…¥å£ä¸­æ³¨å…¥ HMR å®¢æˆ·ç«¯ï¼Œç»“åˆÂ <code>HotModuleReplacementPlugin</code>ï¼Œå®ç°ä»£ç æ”¹åŠ¨åå±€éƒ¨æ›´æ–°ï¼Œæ— éœ€åˆ·æ–°é¡µé¢ï¼›</li>
<li><strong>SourceMap</strong>ï¼šé…ç½®Â <code>eval-cheap-module-source-map</code>ï¼Œå¿«é€Ÿå®šä½é”™è¯¯ä¸”ä¿éšœæ„å»ºé€Ÿåº¦ï¼›</li>
<li><strong>è¾“å‡ºè§„èŒƒ</strong>ï¼šæŒ‡å®šå¼€å‘ç¯å¢ƒè¾“å‡ºç›®å½•ï¼ˆ<code>./app/public/dist/dev/</code>ï¼‰ï¼Œç»Ÿä¸€èµ„æºè·¯å¾„æ ¼å¼ã€‚</li>
</ul>
<h5 data-id="heading-13">3. ç”Ÿäº§ç¯å¢ƒé…ç½®ï¼ˆwebpack.prod.jsï¼‰ï¼šèšç„¦çº¿ä¸Šæ€§èƒ½</h5>
<p>é€šè¿‡å¤šæ’ä»¶ç»„åˆå®ç°ä¼˜åŒ–ï¼š</p>
<ul>
<li><strong>å¤šçº¿ç¨‹æ‰“åŒ…</strong>ï¼šä½¿ç”¨Â <code>HappyPack</code>Â å¼€å¯å¤šçº¿ç¨‹ï¼ˆçº¿ç¨‹æ•° = CPU æ ¸å¿ƒæ•°ï¼‰ï¼Œå¹¶è¡Œå¤„ç† JS ä¸ CSSï¼Œæå‡æ‰“åŒ…é€Ÿåº¦ï¼›</li>
<li><strong>èµ„æºå‹ç¼©</strong>ï¼š<code>TerserWebpackPlugin</code>Â å‹ç¼© JSï¼ˆåˆ é™¤Â <code>console.log</code>ï¼‰ã€<code>CSSMinimizerPlugin</code>Â å‹ç¼© CSSï¼Œå‡å°‘èµ„æºä½“ç§¯ï¼›</li>
<li><strong>ç¼“å­˜æ¸…ç†</strong>ï¼š<code>CleanWebpackPlugin</code>Â æ‰“åŒ…å‰æ¸…ç©ºÂ <code>public/dist</code>Â ç›®å½•ï¼Œé¿å…æ—§èµ„æºæ®‹ç•™ï¼›</li>
<li><strong>CSS æå–</strong>ï¼š<code>MiniCssExtractPlugin</code>Â å°† CSS ä» JS ä¸­æå–ä¸ºå•ç‹¬æ–‡ä»¶ï¼Œæ”¯æŒç¼“å­˜å¤ç”¨ã€‚</li>
</ul>
<h4 data-id="heading-14">ä¸‰ã€é¡µé¢å…¥å£é€»è¾‘ï¼šè¡”æ¥ Vue åº”ç”¨åˆå§‹åŒ–</h4>
<p>æ¡†æ¶çº¦å®šÂ <code>app/pages</code>Â ç›®å½•ä¸‹çš„æ ¸å¿ƒæ–‡ä»¶ï¼Œå®ç° Vue åº”ç”¨çš„è‡ªåŠ¨åŒ–æŒ‚è½½ï¼š</p>
<ul>
<li><strong><code>boot.js</code></strong>ï¼šç±»æ¯”æ™®é€š Vue é¡¹ç›®çš„Â <code>main.js</code>ï¼Œè´Ÿè´£åˆå§‹åŒ– Vue å®ä¾‹ï¼›</li>
<li><strong><code>entry.dashboard.js</code></strong>ï¼ˆå¦‚Â <code>app/pages/dashboard/</code>Â ä¸‹ï¼‰ï¼šèšåˆè·¯ç”±é…ç½®ä¸å¾…æŒ‚è½½ç»„ä»¶ï¼Œè°ƒç”¨Â <code>boot(dashboard, { routes })</code>Â å®Œæˆåº”ç”¨å¯åŠ¨ã€‚</li>
</ul>
<h2 data-id="heading-15">é‡Œç¨‹ç¢‘ä¸‰  åŸºäº vue3 å®Œæˆé¢†åŸŸæ¨¡å‹æ¶æ„å»ºè®¾</h2>
<p>ä½œä¸º elpis å…¨æ ˆæ¡†æ¶è§£å†³å‰ç«¯ CRUD é‡å¤å¼€å‘çš„æ ¸å¿ƒç¯èŠ‚ï¼Œæœ¬é˜¶æ®µèšç„¦ â€œ<strong>ç”¨é…ç½®é©±åŠ¨é¡µé¢</strong>â€â€”â€” åŸºäºé¢†åŸŸæ¨¡å‹ DSL ä¸ JSON Schema å®šä¹‰é¡µé¢ç»“æ„ï¼Œè®©ä¸­åå°ç³»ç»Ÿä» â€œæ‰‹åŠ¨ç¼–ç å¼€å‘â€ è½¬å‘ â€œé…ç½®åŒ–æ¸²æŸ“â€ï¼Œå½»åº•æ‘†è„±é‡å¤ç¼–å†™ CRUD é¡µé¢çš„ä½æ•ˆæ¨¡å¼ã€‚</p>
<h2 data-id="heading-16">ä¸€ã€æ ¸å¿ƒé€‰æ‹©ï¼šä¸ºä½•ç”¨ JSON Schema æ‰¿è½½é¢†åŸŸæ¨¡å‹ï¼Ÿ</h2>
<p>é€‰æ‹© JSON Schema ä½œä¸ºé¢†åŸŸæ¨¡å‹çš„é…ç½®æ ¼å¼ï¼Œæ ¸å¿ƒæºäºå…¶ä¸‰å¤§ä¼˜åŠ¿ï¼š</p>
<ol>
<li><strong>é¢†åŸŸé€‚é…æ€§å¼º</strong>ï¼šä½œä¸ºç‰¹å®šé¢†åŸŸçš„æ ‡å‡† JSON æ ¼å¼ï¼Œå¯ç²¾å‡†æè¿°ä¸­åå°é¡µé¢çš„ â€œå­—æ®µå±æ€§ã€äº¤äº’é€»è¾‘ã€ç»„ä»¶å…³è”â€ï¼Œæ¯”å¦‚ä¸€ä¸ª â€œå•†å“ä»·æ ¼â€ å­—æ®µï¼Œèƒ½åŒæ—¶å®šä¹‰å…¶æ•°æ®ç±»å‹ï¼ˆnumberï¼‰ã€æ ¡éªŒè§„åˆ™ï¼ˆ30â‰¤ä»·æ ¼â‰¤1000ï¼‰ã€è¡¨æ ¼å±•ç¤ºæ ¼å¼ï¼ˆä¿ç•™ 2 ä½å°æ•°ï¼‰ã€è¡¨å•ç»„ä»¶ç±»å‹ï¼ˆæ•°å­—è¾“å…¥æ¡†ï¼‰ï¼›</li>
<li><strong>æ ¡éªŒèƒ½åŠ›å®Œå–„</strong>ï¼šå¯ç»“åˆ AJVï¼ˆAnother JSON Schema Validatorï¼‰å·¥å…·ï¼Œè‡ªåŠ¨æ ¡éªŒå‰ç«¯è¾“å…¥æ•°æ®ä¸åç«¯è¿”å›æ•°æ®çš„åˆæ³•æ€§ï¼Œå‡å°‘æ‰‹åŠ¨ç¼–å†™æ ¡éªŒé€»è¾‘çš„å·¥ä½œé‡ï¼›</li>
<li><strong>æ‰©å±•æ€§çµæ´»</strong>ï¼šæ”¯æŒåµŒå¥—é…ç½®ã€æ¡ä»¶æ¸²æŸ“ç­‰å¤æ‚åœºæ™¯ï¼Œæ—¢èƒ½è¦†ç›–åŸºç¡€ CRUD é¡µé¢ï¼Œä¹Ÿèƒ½é€‚é…å¸¦ä¸ªæ€§åŒ–äº¤äº’çš„å®šåˆ¶é¡µé¢ï¼Œæ— éœ€ä¿®æ”¹æ¡†æ¶æ ¸å¿ƒé€»è¾‘ã€‚</li>
</ol>
<h2 data-id="heading-17">äºŒã€é¢†åŸŸæ¨¡å‹æ¶æ„ï¼šé¡µé¢çš„ â€œé…ç½®åŒ–è“å›¾â€</h2>
<p>elpis æ¡†æ¶é€šè¿‡ JSON Schema å°†ä¸­åå°ç³»ç»Ÿæ‹†è§£ä¸º â€œå¯¼èˆªèœå• + åŠ¨æ€é¡µé¢â€ ä¸¤å¤§æ ¸å¿ƒæ¿å—ï¼Œæ¯ä¸ªæ¿å—çš„åŠŸèƒ½ä¸äº¤äº’å‡ç”±é…ç½®å®šä¹‰ï¼Œæ— éœ€ç¼–å†™é‡å¤ä»£ç ï¼š</p>
<h3 data-id="heading-18">1. æ•´ä½“æ¶æ„æ‹†è§£</h3>
<ul>
<li>
<p><strong>å¯¼èˆªèœå•</strong>ï¼šå®šä¹‰ç³»ç»Ÿçš„æ¨¡å—ç»“æ„ï¼Œæ”¯æŒå¤šçº§èœå•ï¼ˆå¦‚ â€œå•†å“ç®¡ç†â€â€œè®¢å•ç®¡ç†â€ï¼‰ï¼Œå¹¶å…³è”å¯¹åº”çš„é¡µé¢ç±»å‹ï¼ˆSchema æ¸²æŸ“é¡µ /iframe åµŒå…¥é¡µ / è‡ªå®šä¹‰é¡µï¼‰ï¼›</p>
</li>
<li>
<p><strong>åŠ¨æ€é¡µé¢</strong>ï¼šåˆ†ä¸ºä¸‰ç±»æ ¸å¿ƒé¡µé¢ï¼Œè¦†ç›–ä¸­åå° 90% ä»¥ä¸Šçš„åœºæ™¯ï¼š</p>
<ul>
<li><strong>schema-view</strong>ï¼šæ ¸å¿ƒ CRUD é¡µé¢ï¼Œç”± â€œæœç´¢æ ï¼ˆsearch-barï¼‰+ è¡¨æ ¼ï¼ˆtableï¼‰â€ ç»„æˆï¼Œè¡¨æ ¼å…³è” â€œæ–°å¢ / ç¼–è¾‘ / è¯¦æƒ… / åˆ é™¤â€ ç­‰å¼¹çª—äº¤äº’ï¼›</li>
<li><strong>iframe</strong>ï¼šåµŒå…¥å¤–éƒ¨é¡µé¢ï¼ˆå¦‚ç¬¬ä¸‰æ–¹æ•°æ®æŠ¥è¡¨ã€æ—§ç³»ç»Ÿé¡µé¢ï¼‰ï¼Œä»…éœ€é…ç½®åµŒå…¥è·¯å¾„ï¼›</li>
<li><strong>custom</strong>ï¼šç”¨æˆ·è‡ªå®šä¹‰é¡µé¢ï¼Œæ”¯æŒå…³è”è‡ªå®šä¹‰ Vue ç»„ä»¶è·¯å¾„ï¼Œæ»¡è¶³ç‰¹æ®Šäº¤äº’éœ€æ±‚ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-19">2. æ ¸å¿ƒé…ç½®ç¤ºä¾‹ï¼ˆä»¥ç”µå•†ç³»ç»Ÿ â€œå•†å“ç®¡ç†â€ ä¸ºä¾‹ï¼‰</h3>
<p>é€šè¿‡ä¸€ä»½ JSON é…ç½®ï¼Œå¯å®Œæ•´å®šä¹‰ â€œå•†å“ç®¡ç†â€ æ¨¡å—çš„èœå•ã€è¡¨æ ¼å­—æ®µã€æœç´¢ç»„ä»¶ã€è¡¨å•äº¤äº’ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<p>js</p>
<pre><code class="hljs language-css" lang="css">module<span class="hljs-selector-class">.exports</span> = {
  model: <span class="hljs-string">'dashboard'</span>,       // æ¨¡å‹æ ‡è¯†ï¼Œå…³è”ç³»ç»Ÿæ•´ä½“é…ç½®
  name: <span class="hljs-string">'ç”µå•†ç³»ç»Ÿ'</span>,         // ç³»ç»Ÿåç§°ï¼Œç”¨äºé¡µé¢æ ‡é¢˜å±•ç¤º
  menu: [                   // å¯¼èˆªèœå•é…ç½®
    {
      key: <span class="hljs-string">'product'</span>,       // èœå•å”¯ä¸€æ ‡è¯†
      name: <span class="hljs-string">'å•†å“ç®¡ç†'</span>,     // èœå•æ˜¾ç¤ºåç§°
      menuType: <span class="hljs-string">'module'</span>,   // èœå•ç±»å‹ï¼ˆæ¨¡å—çº§ï¼‰
      moduleType: <span class="hljs-string">'schema'</span>, // é¡µé¢ç±»å‹ï¼ˆSchema æ¸²æŸ“é¡µï¼‰
      schemaConfig: {       // Schema é¡µé¢æ ¸å¿ƒé…ç½®
        api: <span class="hljs-string">'/api/proj/product'</span>, // CRUD æ¥å£åœ°å€ï¼ˆå¢åˆ æ”¹æŸ¥ç»Ÿä¸€å…³è”ï¼‰
        schema: {           // å­—æ®µå±æ€§å®šä¹‰ï¼ˆè¦†ç›–è¡¨æ ¼ã€è¡¨å•ã€æœç´¢æ ï¼‰
          type: <span class="hljs-string">'object'</span>,
          properties: {
            // å•†å“IDï¼šè¡¨æ ¼å±•ç¤ºã€ç¼–è¾‘æ—¶ç¦ç”¨è¾“å…¥
            product_id: {
              type: <span class="hljs-string">'string'</span>,
              label: <span class="hljs-string">'å•†å“ID'</span>,
              tableOption: { <span class="hljs-attribute">width</span>: <span class="hljs-number">300</span>, <span class="hljs-string">'show-overflow-tooltip'</span>: true },
              editFormOption: { comType: <span class="hljs-string">'input'</span>, disabled: true }
            },
            // å•†å“åç§°ï¼šæ”¯æŒåŠ¨æ€ä¸‹æ‹‰æœç´¢ã€è¡¨å•è¾“å…¥æ ¡éªŒï¼ˆ<span class="hljs-number">3</span>-<span class="hljs-number">20</span>å­—ï¼‰
            product_name: {
              type: <span class="hljs-string">'string'</span>,
              label: <span class="hljs-string">'å•†å“åç§°'</span>,
              maxLength: <span class="hljs-number">20</span>,
              minLength: <span class="hljs-number">3</span>,
              searchOption: { comType: <span class="hljs-string">'dynamicSelect'</span>, api: <span class="hljs-string">'/api/proj/product_enum/list'</span> },
              createFormOption: { comType: <span class="hljs-string">'input'</span>, default: <span class="hljs-string">'å“²ç„æ–°è¯¾ç¨‹'</span> }
            },
            // ä»·æ ¼ï¼šæ•°å€¼èŒƒå›´æ ¡éªŒï¼ˆ<span class="hljs-number">30</span>-<span class="hljs-number">1000</span>ï¼‰ã€è¡¨æ ¼ä¿ç•™<span class="hljs-number">2</span>ä½å°æ•°ã€ä¸‹æ‹‰æœç´¢
            price: {
              type: <span class="hljs-string">'number'</span>,
              label: <span class="hljs-string">'ä»·æ ¼'</span>,
              maximum: <span class="hljs-number">1000</span>,
              minimum: <span class="hljs-number">30</span>,
              tableOption: { <span class="hljs-attribute">width</span>: <span class="hljs-number">200</span>, toFixed: <span class="hljs-number">2</span> },
              searchOption: { comType: <span class="hljs-string">'select'</span>, enumList: [{ <span class="hljs-selector-tag">label</span>: <span class="hljs-string">'ï¿¥39.0'</span>, value: <span class="hljs-number">39.0</span> }, ...] },
              createFormOption: { comType: <span class="hljs-string">'inputNumber'</span> }
            },
            // å…¶ä»–å­—æ®µï¼ˆåº“å­˜ã€åˆ›å»ºæ—¶é—´ï¼‰ï¼šç•¥...
          },
          required: [<span class="hljs-string">'product_name'</span>] // è¡¨å•å¿…å¡«å­—æ®µ
        },
        tableConfig: {       // è¡¨æ ¼äº¤äº’é…ç½®ï¼ˆæŒ‰é’®ã€æ“ä½œé€»è¾‘ï¼‰
          headerButtons: [{  // è¡¨æ ¼é¡¶éƒ¨æŒ‰é’®ï¼ˆæ–°å¢å•†å“ï¼‰
            <span class="hljs-selector-tag">label</span>: <span class="hljs-string">'æ·»åŠ å•†å“'</span>,
            eventKey: <span class="hljs-string">'showComponent'</span>, // è§¦å‘äº‹ä»¶ï¼ˆæ˜¾ç¤ºå¼¹çª—ï¼‰
            eventOption: { comName: <span class="hljs-string">'createForm'</span> } // å¼¹çª—ç±»å‹ï¼ˆæ–°å¢è¡¨å•ï¼‰
          }],
          rowButtons: [      // è¡¨æ ¼è¡Œæ“ä½œæŒ‰é’®ï¼ˆè¯¦æƒ…ã€ä¿®æ”¹ã€åˆ é™¤ï¼‰
            { <span class="hljs-selector-tag">label</span>: <span class="hljs-string">'è¯¦æƒ…'</span>, eventKey: <span class="hljs-string">'showComponent'</span>, eventOption: { comName: <span class="hljs-string">'detailPanel'</span> } },
            { <span class="hljs-selector-tag">label</span>: <span class="hljs-string">'ä¿®æ”¹'</span>, eventKey: <span class="hljs-string">'showComponent'</span>, eventOption: { comName: <span class="hljs-string">'editForm'</span> } },
            { <span class="hljs-selector-tag">label</span>: <span class="hljs-string">'åˆ é™¤'</span>, eventKey: <span class="hljs-string">'remove'</span>, eventOption: { params: { product_id: <span class="hljs-string">'schema::product_id'</span> } } }
          ]
        },
        componentConfig: {   // å¼¹çª—ç»„ä»¶é…ç½®ï¼ˆæ ‡é¢˜ã€æŒ‰é’®æ–‡æœ¬ï¼‰
          createForm: { title: <span class="hljs-string">'æ·»åŠ å•†å“'</span>, saveBtnText: <span class="hljs-string">'ä¿å­˜'</span> },
          editForm: { mainKey: <span class="hljs-string">'product_id'</span>, title: <span class="hljs-string">'ç¼–è¾‘å•†å“'</span> },
          detailPanel: { mainKey: <span class="hljs-string">'product_id'</span>, title: <span class="hljs-string">'å•†å“è¯¦æƒ…'</span> }
        }
      }
    },
    // å…¶ä»–èœå•ï¼ˆè®¢å•ç®¡ç†-è‡ªå®šä¹‰é¡µã€å®¢æˆ·ç®¡ç†-è‡ªå®šä¹‰é¡µï¼‰ï¼šç•¥...
  ]
}
</code></pre>
<h2 data-id="heading-20">ä¸‰ã€é…ç½®æ¸²æŸ“æµç¨‹ï¼šä» â€œé…ç½®â€ åˆ° â€œé¡µé¢â€ çš„å…¨é“¾è·¯å®ç°</h2>
<p>å‰ç«¯åŸºäº Vue3 å®ç°é…ç½®çš„è‡ªåŠ¨åŒ–æ¸²æŸ“ï¼Œæ ¸å¿ƒåˆ†ä¸º â€œé…ç½®è·å–â€ ä¸ â€œé¡µé¢æ¸²æŸ“â€ ä¸¤æ­¥ï¼Œå…¨ç¨‹æ— éœ€æ‰‹åŠ¨ç¼–å†™é¡µé¢ä»£ç ï¼š</p>
<p><strong>1. ç¬¬ä¸€æ­¥ï¼šé…ç½®è·å–ï¼ˆè¡”æ¥ BFF Serve å±‚ï¼‰</strong></p>
<p>é¢†åŸŸæ¨¡å‹é…ç½®ç”± BFF Serve å±‚ç»Ÿä¸€ç®¡ç†ï¼Œå‰ç«¯é€šè¿‡æ¥å£è·å–é…ç½®å¹¶ç¼“å­˜ï¼Œç¡®ä¿å¤šé¡µé¢å…±äº«æ•°æ®ï¼š</p>
<ol>
<li><strong>æ¥å£è¯·æ±‚</strong>ï¼šåœ¨ç³»ç»Ÿå…¥å£ï¼ˆå¦‚Â <code>dashboard.vue</code>ï¼‰è°ƒç”¨ BFF å±‚çš„Â <code>/api/project</code>Â æ¥å£ï¼Œä¼ å…¥é¡¹ç›®æ ‡è¯†ï¼ˆ<code>proj_key</code>ï¼‰ï¼Œè·å–åŒ…å« â€œèœå•ã€é¡µé¢ã€å­—æ®µâ€ çš„å®Œæ•´é…ç½®ï¼›</li>
<li><strong>çŠ¶æ€ç¼“å­˜</strong>ï¼šå°†é…ç½®å­˜å…¥ Vuex/Pinia çŠ¶æ€ç®¡ç†ï¼ˆå¦‚Â <code>menuStore</code>Â å­˜å‚¨èœå•é…ç½®ã€<code>projectStore</code>Â å­˜å‚¨é¡¹ç›®ä¿¡æ¯ï¼‰ï¼Œé¿å…é‡å¤è¯·æ±‚ï¼›</li>
<li><strong>é…ç½®åˆ†å‘</strong>ï¼šè·¯ç”±åˆ‡æ¢æ—¶ï¼Œä»çŠ¶æ€ç®¡ç†ä¸­è¯»å–å½“å‰èœå•å¯¹åº”çš„é…ç½®ï¼Œä¼ é€’ç»™åŠ¨æ€æ¸²æŸ“ç»„ä»¶ã€‚</li>
</ol>
<p><strong>2. ç¬¬äºŒæ­¥ï¼šé¡µé¢æ¸²æŸ“ï¼ˆåˆ†åœºæ™¯é€‚é…ï¼‰</strong></p>
<p>æ ¹æ®é…ç½®ä¸­çš„Â <code>moduleType</code>ï¼ˆé¡µé¢ç±»å‹ï¼‰ï¼Œå‰ç«¯è‡ªåŠ¨åŒ¹é…æ¸²æŸ“é€»è¾‘ï¼Œå®ç° â€œä¸€å¥—ä»£ç é€‚é…å¤šåœºæ™¯â€ï¼š</p>
<p>ï¼ˆ1ï¼‰schema-view æ¸²æŸ“ï¼ˆæ ¸å¿ƒ CRUD é¡µé¢ï¼‰</p>
<p>é€šè¿‡è‡ªå®šä¹‰ HookÂ <code>useSchema</code>Â è§£æé…ç½®ï¼Œå°† JSON Schema æ‹†åˆ†ä¸º â€œè¡¨æ ¼é…ç½®ã€æœç´¢é…ç½®ã€ç»„ä»¶é…ç½®â€ï¼Œå†ç»“åˆ Vue åŠ¨æ€ç»„ä»¶æ¸²æŸ“é¡µé¢ï¼š</p>
<ul>
<li>
<p><strong>é…ç½®è§£æ</strong>ï¼š<code>useSchema</code>Â é’©å­æ¥æ”¶Â <code>schemaConfig</code>ï¼Œæå–Â <code>api</code>ï¼ˆæ¥å£åœ°å€ï¼‰ã€<code>tableSchema</code>ï¼ˆè¡¨æ ¼å­—æ®µï¼‰ã€<code>searchSchema</code>ï¼ˆæœç´¢å­—æ®µï¼‰ã€<code>components</code>ï¼ˆå¼¹çª—ç»„ä»¶ï¼‰ï¼›</p>
</li>
<li>
<p><strong>ç»„ä»¶æ¸²æŸ“</strong>ï¼š</p>
<ul>
<li>æœç´¢æ ï¼šæ ¹æ®Â <code>searchSchema</code>Â åŠ¨æ€ç”Ÿæˆç»„ä»¶ï¼ˆè¾“å…¥æ¡†ã€ä¸‹æ‹‰æ¡†ã€æ—¥æœŸèŒƒå›´é€‰æ‹©å™¨ï¼‰ï¼Œå¹¶ç»‘å®šæ ¡éªŒè§„åˆ™ï¼›</li>
<li>è¡¨æ ¼ï¼šåŸºäºÂ <code>tableSchema</code>Â æ¸²æŸ“åˆ—ï¼Œç»“åˆÂ <code>tableConfig</code>Â æ¸²æŸ“é¡¶éƒ¨ / è¡Œæ“ä½œæŒ‰é’®ï¼Œç‚¹å‡»æŒ‰é’®æ—¶è§¦å‘Â <code>eventKey</code>Â å¯¹åº”çš„é€»è¾‘ï¼ˆå¦‚æ˜¾ç¤ºå¼¹çª—ã€è°ƒç”¨åˆ é™¤æ¥å£ï¼‰ï¼›</li>
<li>å¼¹çª—ï¼šæ ¹æ®Â <code>componentConfig</code>Â æ¸²æŸ“ â€œæ–°å¢ / ç¼–è¾‘ / è¯¦æƒ…â€ å¼¹çª—ï¼Œè‡ªåŠ¨å…³è”è¡¨å•å­—æ®µä¸æ ¡éªŒè§„åˆ™ã€‚</li>
</ul>
</li>
</ul>
<p>ï¼ˆ2ï¼‰iframe æ¸²æŸ“ï¼ˆåµŒå…¥å¤–éƒ¨é¡µé¢ï¼‰</p>
<ol>
<li>ä»èœå•é…ç½®ä¸­è¯»å–Â <code>iframe</code>Â ç±»å‹å¯¹åº”çš„åµŒå…¥è·¯å¾„ï¼ˆå¦‚Â <code>customConfig.path</code>ï¼‰ï¼›</li>
<li>åœ¨ Vue æ¨¡æ¿ä¸­ä½¿ç”¨Â <code>&lt;iframe&gt;</code>Â æ ‡ç­¾ï¼ŒåŠ¨æ€ç»‘å®šÂ <code>src</code>Â å±æ€§ä¸ºåµŒå…¥è·¯å¾„ï¼Œå®ç°å¤–éƒ¨é¡µé¢çš„æ— ç¼åµŒå…¥ã€‚</li>
</ol>
<p>ï¼ˆ3ï¼‰custom æ¸²æŸ“ï¼ˆè‡ªå®šä¹‰é¡µé¢ï¼‰</p>
<ol>
<li>é…ç½®ä¸­æŒ‡å®šè‡ªå®šä¹‰é¡µé¢çš„ Vue ç»„ä»¶è·¯å¾„ï¼ˆå¦‚Â <code>customConfig.path</code>ï¼‰ï¼›</li>
<li>é€šè¿‡ Vue3 çš„å¼‚æ­¥åŠ è½½ç»„ä»¶ï¼Œåœ¨è·¯ç”±å¯¹åº”çš„é¡µé¢ä¸­æ¸²æŸ“ï¼Œæ»¡è¶³ä¸ªæ€§åŒ–äº¤äº’éœ€æ±‚ï¼ˆå¦‚å¤æ‚è¡¨å•ã€æ•°æ®å¯è§†åŒ–ï¼‰ã€‚</li>
</ol>
<p><strong>3. æ ¸å¿ƒæ¸²æŸ“ä»£ç ç¤ºä¾‹ï¼ˆ<code>dashboard.vue</code>Â å…¥å£ï¼‰</strong></p>
<pre><code class="hljs language-js" lang="js">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">el-config-provider</span> <span class="hljs-attr">:locale</span>=<span class="hljs-string">"zhCn"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- å¤´éƒ¨å¯¼èˆªï¼ˆæ¸²æŸ“èœå•ï¼‰ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">header-view</span> <span class="hljs-attr">:proj-name</span>=<span class="hljs-string">"projName"</span> @<span class="hljs-attr">menu-select</span>=<span class="hljs-string">"onMenuSelect"</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- åŠ¨æ€è·¯ç”±å‡ºå£ï¼ˆæ¸²æŸ“å¯¹åº”é¡µé¢ï¼‰ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">main-content</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">router-view</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">router-view</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">header-view</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">el-config-provider</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref, onMounted } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>;
<span class="hljs-keyword">import</span> { useRouter, useRoute } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue-router"</span>;
<span class="hljs-keyword">import</span> { useMenuStore } <span class="hljs-keyword">from</span> <span class="hljs-string">"$elpisStore/menu"</span>; <span class="hljs-comment">// èœå•çŠ¶æ€ç®¡ç†</span>
<span class="hljs-keyword">import</span> { useProjectStore } <span class="hljs-keyword">from</span> <span class="hljs-string">"$elpisStore/project"</span>; <span class="hljs-comment">// é¡¹ç›®çŠ¶æ€ç®¡ç†</span>
<span class="hljs-keyword">import</span> $curl <span class="hljs-keyword">from</span> <span class="hljs-string">"$elpisCommon/curl.js"</span>; <span class="hljs-comment">// æ¥å£è¯·æ±‚å·¥å…·</span>

<span class="hljs-keyword">const</span> router = <span class="hljs-title function_">useRouter</span>();
<span class="hljs-keyword">const</span> route = <span class="hljs-title function_">useRoute</span>();
<span class="hljs-keyword">const</span> menuStore = <span class="hljs-title function_">useMenuStore</span>();
<span class="hljs-keyword">const</span> projectStore = <span class="hljs-title function_">useProjectStore</span>();
<span class="hljs-keyword">const</span> projName = <span class="hljs-title function_">ref</span>(<span class="hljs-string">""</span>);

<span class="hljs-comment">// åˆå§‹åŒ–ï¼šè·å–é…ç½®å¹¶ç¼“å­˜</span>
<span class="hljs-title function_">onMounted</span>(<span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">await</span> <span class="hljs-title function_">getProjectConfig</span>();
});

<span class="hljs-comment">// è°ƒç”¨ BFF æ¥å£è·å–é¢†åŸŸæ¨¡å‹é…ç½®</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getProjectConfig</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> $curl({
    <span class="hljs-attr">method</span>: <span class="hljs-string">"get"</span>,
    <span class="hljs-attr">url</span>: <span class="hljs-string">"/api/project"</span>,
    <span class="hljs-attr">query</span>: { <span class="hljs-attr">proj_key</span>: route.<span class="hljs-property">query</span>.<span class="hljs-property">proj_key</span> } <span class="hljs-comment">// é¡¹ç›®æ ‡è¯†</span>
  });
  <span class="hljs-keyword">if</span> (res?.<span class="hljs-property">success</span> &amp;&amp; res.<span class="hljs-property">data</span>) {
    <span class="hljs-keyword">const</span> { name, menu } = res.<span class="hljs-property">data</span>;
    projName.<span class="hljs-property">value</span> = name;
    menuStore.<span class="hljs-title function_">setMenuList</span>(menu); <span class="hljs-comment">// ç¼“å­˜èœå•é…ç½®</span>
  }
}

<span class="hljs-comment">// èœå•ç‚¹å‡»ï¼šåˆ‡æ¢è·¯ç”±ï¼ŒåŒ¹é…å¯¹åº”é¡µé¢</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">onMenuSelect</span> = (<span class="hljs-params">menuItem</span>) =&gt; {
  <span class="hljs-keyword">const</span> { key, moduleType, customConfig } = menuItem;
  <span class="hljs-comment">// è·¯ç”±è·¯å¾„æ˜ å°„ï¼ˆæ ¹æ®é¡µé¢ç±»å‹åŒ¹é…ï¼‰</span>
  <span class="hljs-keyword">const</span> pathMap = {
    <span class="hljs-attr">schema</span>: <span class="hljs-string">"/schema"</span>,    <span class="hljs-comment">// Schema æ¸²æŸ“é¡µè·¯å¾„</span>
    <span class="hljs-attr">iframe</span>: <span class="hljs-string">"/iframe"</span>,    <span class="hljs-comment">// iframe åµŒå…¥é¡µè·¯å¾„</span>
    <span class="hljs-attr">custom</span>: customConfig?.<span class="hljs-property">path</span> <span class="hljs-comment">// è‡ªå®šä¹‰é¡µè·¯å¾„</span>
  };
  <span class="hljs-comment">// è·³è½¬è·¯ç”±ï¼ˆæºå¸¦é¡¹ç›®æ ‡è¯†ã€èœå•æ ‡è¯†ï¼‰</span>
  router.<span class="hljs-title function_">push</span>({
    <span class="hljs-attr">path</span>: <span class="hljs-string">`/view/dashboard`</span>,
    <span class="hljs-attr">query</span>: { key, <span class="hljs-attr">proj_key</span>: route.<span class="hljs-property">query</span>.<span class="hljs-property">proj_key</span> }
  });
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h2 data-id="heading-21">é‡Œç¨‹ç¢‘å›› åŸºäº vue3 å®ŒæˆåŠ¨æ€ç»„ä»¶åº“å»ºè®¾</h2>
<p>ä¸Šä¸€é˜¶æ®µé€šè¿‡ DSL é…ç½®å®ç°äº† schema-view é¡µé¢è‡ªåŠ¨åŒ–æ¸²æŸ“ï¼Œæœ¬é˜¶æ®µæ ¸å¿ƒæ˜¯æ„å»º<strong>é…ç½®é©±åŠ¨çš„åŠ¨æ€ç»„ä»¶åº“</strong>ï¼Œç”¨ JsonSchema ç»Ÿä¸€æè¿°ç»„ä»¶ç»“æ„ä¸é€»è¾‘</p>
<p><strong>ä¸€ã€è§£å†³ä¸‰å¤§å…³é”®é—®é¢˜</strong></p>
<ol>
<li><strong>é…ç½®ä½“ç³»</strong>ï¼šç”¨ä¸€ä»½ jsonSchema è¦†ç›– â€œç»„ä»¶æ˜¯ä»€ä¹ˆã€ä½•æ—¶è§¦å‘ã€åŒ…å«ä»€ä¹ˆã€å¦‚ä½•äº¤äº’â€ï¼›</li>
<li><strong>æ¸²æŸ“é€šä¿¡</strong>ï¼šå®ç°ä¸‰å±‚ç»„ä»¶ï¼ˆå®¹å™¨â†’ä¸­é—´ä»¶â†’æ§ä»¶ï¼‰è§£è€¦ä¸è·¨å±‚çº§è”åŠ¨ã€‚</li>
</ol>
<p><strong>äºŒã€é…ç½®ä½“ç³»ï¼šå››å±‚ç»“æ„å®šä¹‰ç»„ä»¶å…¨ç”Ÿå‘½å‘¨æœŸ</strong></p>
<p>åŸºäº â€œå•ä¸€æ•°æ®æºâ€ æ€æƒ³ï¼Œåœ¨é¢†åŸŸæ¨¡å‹åŸºç¡€ä¸Šæ‰©å±•é…ç½®ï¼Œç¡®ä¿æ¡†æ¶å¯è‡ªåŠ¨è¯†åˆ«é€»è¾‘ï¼š</p>
<ol>
<li>ç»„ä»¶å…ƒä¿¡æ¯ï¼ˆcomponentConfigï¼‰ï¼šå®šä¹‰ â€œæ˜¯ä»€ä¹ˆâ€</li>
</ol>
<p>æè¿°ç»„ä»¶åŸºç¡€å±æ€§ï¼Œå¦‚æ ‡é¢˜ã€æŒ‰é’®æ–‡æœ¬ã€ä¸»é”®ï¼ˆç”¨äºæ•°æ®å›æ˜¾ï¼‰ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-attr">schemaConfig</span>: {
  <span class="hljs-attr">componentConfig</span>: {
    <span class="hljs-attr">createForm</span>: { <span class="hljs-attr">title</span>: <span class="hljs-string">'æ·»åŠ å•†å“'</span>, <span class="hljs-attr">saveBtnText</span>: <span class="hljs-string">'ä¿å­˜'</span> },
    <span class="hljs-attr">editForm</span>: { <span class="hljs-attr">mainKey</span>: <span class="hljs-string">'product_id'</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'ç¼–è¾‘å•†å“'</span> },
    <span class="hljs-attr">detailPanel</span>: { <span class="hljs-attr">mainKey</span>: <span class="hljs-string">'product_id'</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'å•†å“è¯¦æƒ…'</span> }
  }
}
</code></pre>
<ol start="2">
<li>è§¦å‘è§„åˆ™ï¼ˆtableConfigï¼‰ï¼šå®šä¹‰è§¦å‘</li>
</ol>
<p>åœ¨è¡¨æ ¼æŒ‰é’®ä¸­é…ç½®äº‹ä»¶ï¼Œé€šè¿‡Â <code>eventKey</code>Â å…³è”ç»„ä»¶ï¼Œç»Ÿä¸€äº¤äº’é€»è¾‘ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-attr">schemaConfig</span>: {
  <span class="hljs-attr">tableConfig</span>: {
    <span class="hljs-attr">headerButtons</span>: [{ <span class="hljs-comment">// è¡¨å¤´æŒ‰é’®â†’æ–°å¢ç»„ä»¶</span>
      <span class="hljs-attr">label</span>: <span class="hljs-string">'æ·»åŠ å•†å“'</span>,
      <span class="hljs-attr">eventKey</span>: <span class="hljs-string">'showComponent'</span>, 
      <span class="hljs-attr">eventOption</span>: { <span class="hljs-attr">comName</span>: <span class="hljs-string">'createForm'</span> }
    }],
    <span class="hljs-attr">rowButtons</span>: [ <span class="hljs-comment">// è¡ŒæŒ‰é’®â†’è¯¦æƒ…/ç¼–è¾‘/åˆ é™¤</span>
      { <span class="hljs-attr">label</span>: <span class="hljs-string">'è¯¦æƒ…'</span>, <span class="hljs-attr">eventKey</span>: <span class="hljs-string">'showComponent'</span>, <span class="hljs-attr">eventOption</span>: { <span class="hljs-attr">comName</span>: <span class="hljs-string">'detailPanel'</span> } },
      { <span class="hljs-attr">label</span>: <span class="hljs-string">'åˆ é™¤'</span>, <span class="hljs-attr">eventKey</span>: <span class="hljs-string">'remove'</span>, <span class="hljs-attr">eventOption</span>: { <span class="hljs-attr">params</span>: { <span class="hljs-attr">product_id</span>: <span class="hljs-string">'schema::product_id'</span> } } }
    ]
  }
}
</code></pre>
<ol start="3">
<li>å­—æ®µå±æ€§ï¼ˆpropertiesï¼‰ï¼šå®šä¹‰ â€œåŒ…å«ä»€ä¹ˆâ€</li>
</ol>
<p>ä¸ºå­—æ®µé…ç½®ä¸åŒç»„ä»¶ä¸­çš„è¡¨ç°ï¼ˆæ§ä»¶ç±»å‹ã€æ ¡éªŒè§„åˆ™ï¼‰ï¼Œé€šè¿‡Â <code>xxxOption</code>Â åŒºåˆ†åœºæ™¯ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-attr">schemaConfig</span>: {
  <span class="hljs-attr">properties</span>: {
    <span class="hljs-attr">product_name</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span>,
      <span class="hljs-attr">label</span>: <span class="hljs-string">'å•†å“åç§°'</span>,
      <span class="hljs-attr">maxLength</span>: <span class="hljs-number">20</span>, <span class="hljs-comment">// å…¨å±€æ ¡éªŒ</span>
      <span class="hljs-attr">searchOption</span>: { <span class="hljs-attr">comType</span>: <span class="hljs-string">'dynamicSelect'</span>, <span class="hljs-attr">api</span>: <span class="hljs-string">'/api/proj/enum'</span> }, <span class="hljs-comment">// æœç´¢æ¡†</span>
      <span class="hljs-attr">createFormOption</span>: { <span class="hljs-attr">comType</span>: <span class="hljs-string">'input'</span>, <span class="hljs-attr">default</span>: <span class="hljs-string">'å“²ç„æ–°è¯¾ç¨‹'</span> } <span class="hljs-comment">// æ–°å¢è¡¨å•</span>
    },
    <span class="hljs-attr">price</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-string">'number'</span>,
      <span class="hljs-attr">minimum</span>: <span class="hljs-number">30</span>,
      <span class="hljs-attr">tableOption</span>: { <span class="hljs-attr">width</span>: <span class="hljs-number">200</span>, <span class="hljs-attr">toFixed</span>: <span class="hljs-number">2</span> }, <span class="hljs-comment">// è¡¨æ ¼æ˜¾ç¤º</span>
      <span class="hljs-attr">createFormOption</span>: { <span class="hljs-attr">comType</span>: <span class="hljs-string">'inputNumber'</span> } <span class="hljs-comment">// è¡¨å•æ§ä»¶</span>
    }
  }
}
</code></pre>
<ol start="4">
<li>API äº¤äº’ï¼šå®šä¹‰ â€œå¦‚ä½•é€šä¿¡â€
éµå¾ª REST è§„èŒƒï¼ŒåŸºç¡€ API ç»Ÿä¸€é…ç½®ï¼Œæ¡†æ¶è‡ªåŠ¨æ˜ å°„ HTTP æ–¹æ³•ï¼ˆæ–°å¢â†’POSTã€åˆ é™¤â†’DELETEï¼‰ï¼ŒåŠ¨æ€å‚æ•°ç”¨Â <code>schema::xxx</code>Â å–è¡¨æ ¼è¡Œæ•°æ®ã€‚</li>
</ol>
<p><strong>ä¸‰ã€åˆ†å±‚æ¸²æŸ“ï¼šä¸‰å±‚ç»“æ„è§£è€¦åŠ è½½</strong>
æŒ‰èŒè´£æ‹†åˆ†ç»„ä»¶ï¼Œç”¨ Vue åŠ¨æ€ç»„ä»¶å®ç°è‡ªåŠ¨åŒ–æ¸²æŸ“ï¼Œä¾¿äºæ‰©å±•ï¼š</p>
<h3 data-id="heading-22">1. ç›®å½•ç»“æ„</h3>
<p>plaintext</p>
<pre><code class="hljs language-bash" lang="bash">src/
â”œâ”€â”€ pages/schema-view/       <span class="hljs-comment"># é¡¶å±‚å®¹å™¨ï¼šç®¡ç†çŠ¶æ€ä¸äº‹ä»¶</span>
â”‚   â”œâ”€â”€ schema-view.vue
â”‚   â””â”€â”€ components/          <span class="hljs-comment"># ä¸­é—´å±‚ï¼šé¢„è®¾ç»„ä»¶ï¼ˆæ–°å¢/ç¼–è¾‘/è¯¦æƒ…ï¼‰</span>
â”‚       â”œâ”€â”€ create-form/
â”‚       â””â”€â”€ component-config.js <span class="hljs-comment"># ç»„ä»¶æ˜ å°„ï¼ˆcomNameâ†’ç»„ä»¶è·¯å¾„ï¼‰</span>
â””â”€â”€ widgets/schema-form/     <span class="hljs-comment"># åº•å±‚ï¼šå­—æ®µæ§ä»¶ï¼ˆè¾“å…¥æ¡†/ä¸‹æ‹‰æ¡†ï¼‰</span>
    â”œâ”€â”€ schema-form.vue      <span class="hljs-comment"># æ§ä»¶å®¹å™¨</span>
    â””â”€â”€ components/          <span class="hljs-comment"># å…·ä½“æ§ä»¶</span>
</code></pre>
<p>2.  æ ¸å¿ƒæ¸²æŸ“é€»è¾‘ï¼ˆschema-view.vueï¼‰</p>
<p>vue</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- è¡¨æ ¼+æœç´¢æ ï¼ˆå¤ç”¨å‰åºå®ç°ï¼‰ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">el-table</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">el-table</span>&gt;</span>

  <span class="hljs-comment">&lt;!-- åŠ¨æ€æ¸²æŸ“ä¸­é—´å±‚ç»„ä»¶ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">component</span>
    <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(com, comName) in components"</span>
    <span class="hljs-attr">:key</span>=<span class="hljs-string">"comName"</span>
    <span class="hljs-attr">:is</span>=<span class="hljs-string">"ComponentMap[comName]"</span>
    <span class="hljs-attr">:schema</span>=<span class="hljs-string">"com.schema"</span>
    <span class="hljs-attr">:api</span>=<span class="hljs-string">"api"</span>
    @<span class="hljs-attr">command</span>=<span class="hljs-string">"handleComCommand"</span> &lt;!<span class="hljs-attr">--</span> <span class="hljs-attr">ç›‘å¬ç»„ä»¶äº‹ä»¶</span>ï¼ˆ<span class="hljs-attr">å¦‚ä¿å­˜æˆåŠŸ</span>ï¼‰ <span class="hljs-attr">--</span>&gt;</span>
  /&gt;
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { useSchema } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/hooks/schema.js"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">ComponentMap</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"./components/component-config.js"</span>;

<span class="hljs-keyword">const</span> { api, components } = <span class="hljs-title function_">useSchema</span>();
<span class="hljs-comment">// å¤„ç†ç»„ä»¶äº‹ä»¶ï¼ˆå¦‚ä¿å­˜ååˆ·æ–°è¡¨æ ¼ï¼‰</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleComCommand</span> = (<span class="hljs-params">{ event }</span>) =&gt; {
  <span class="hljs-keyword">if</span> (event === <span class="hljs-string">"saveSuccess"</span>) <span class="hljs-title function_">emit</span>(<span class="hljs-string">"refreshTable"</span>);
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><strong>å››ã€é€šä¿¡æœºåˆ¶ï¼šé«˜æ•ˆè·¨å±‚çº§è”åŠ¨</strong></p>
<ol>
<li><strong>æ•°æ®å‘ä¸‹</strong>ï¼šé¡¶å±‚ç”¨Â <code>provide</code>Â æä¾› APIã€é…ç½®ï¼Œä¸­é—´å±‚ / åº•å±‚ç”¨Â <code>inject</code>Â ç›´æ¥è·å–ï¼Œé¿å… props å±‚å±‚ä¼ é€’ï¼›</li>
<li><strong>äº‹ä»¶å‘ä¸Š</strong>ï¼šä¸­é—´å±‚é€šè¿‡Â <code>emit</code>Â è§¦å‘äº‹ä»¶ï¼ˆå¦‚Â <code>saveSuccess</code>ï¼‰ï¼Œé¡¶å±‚ç›‘å¬åæ‰§è¡Œé€»è¾‘ï¼ˆå¦‚åˆ·æ–°è¡¨æ ¼ï¼‰ï¼›</li>
<li><strong>ç»„ä»¶è°ƒç”¨</strong>ï¼šé¡¶å±‚ç”¨Â <code>ref</code>Â è·å–ä¸­é—´å±‚ç»„ä»¶å®ä¾‹ï¼Œä¸»åŠ¨è°ƒç”¨æ–¹æ³•ï¼ˆå¦‚ç¼–è¾‘æ—¶å›æ˜¾æ•°æ®ï¼‰ã€‚</li>
</ol>
<h2 data-id="heading-23">é‡Œç¨‹ç¢‘äº” å®Œæˆ elpis-npm åŒ…åˆ†ç¦»å¹¶å‘å¸ƒ</h2>
<p>æœ¬é˜¶æ®µæ ¸å¿ƒç›®æ ‡æ˜¯<strong>å®ç° â€œæ ¸å¿ƒ - ä¸šåŠ¡â€ å½»åº•è§£è€¦</strong>ï¼šå°†æ¡†æ¶æ ¸å¿ƒèƒ½åŠ›ï¼ˆelpis-coreã€webpack å·¥ç¨‹åŒ–ã€åŸºç¡€ç»„ä»¶ï¼‰å°è£…ä¸º<code>elpis</code>Â npm åŒ…ï¼Œä¸šåŠ¡ä¾§ä»…éœ€å®‰è£…è¯¥åŒ…ï¼ŒæŒ‰çº¦å®šç›®å½•å¼€å‘å³å¯ï¼Œæ— éœ€å…³æ³¨åº•å±‚é…ç½®ï¼ŒçœŸæ­£å®ç° â€œèšç„¦ä¸šåŠ¡ã€æ ¸å¿ƒæ‰˜ç®¡â€ã€‚</p>
<p><strong>elpis-coreï¼šè‡ªåŠ¨æ‰«æä¸šåŠ¡ä»£ç ï¼Œå®ç° â€œä¸šåŠ¡æ¨¡å—é›¶é…ç½®æŒ‚è½½â€</strong></p>
<p>ä¸ºå„åŠ è½½å™¨ï¼ˆcontrollerã€service ç­‰ï¼‰æ–°å¢<strong>ä¸šåŠ¡å±‚æ‰«æé€»è¾‘</strong>ï¼Œè‡ªåŠ¨è¯†åˆ«ä¸šåŠ¡ç›®å½•ä¸‹çš„æ¨¡å—å¹¶æŒ‚è½½åˆ°æ¡†æ¶å®ä¾‹ï¼Œæ— éœ€æ‰‹åŠ¨æ³¨å†Œã€‚<br/>
ä»¥<strong>æ§åˆ¶å™¨åŠ è½½å™¨</strong>ä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// elpis-core/loader/controllerLoader.js</span>
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
<span class="hljs-keyword">const</span> glob = <span class="hljs-built_in">require</span>(<span class="hljs-string">'glob'</span>);

<span class="hljs-keyword">function</span> <span class="hljs-title function_">loadController</span>(<span class="hljs-params">app</span>) {
  <span class="hljs-comment">// 1. åŠ è½½æ¡†æ¶æ ¸å¿ƒæ§åˆ¶å™¨ï¼ˆåŸæœ‰é€»è¾‘ï¼‰</span>
  <span class="hljs-keyword">const</span> coreControllerPath = path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">'../app/controller'</span>);
  glob.<span class="hljs-title function_">sync</span>(<span class="hljs-string">`<span class="hljs-subst">${coreControllerPath}</span>/**/*.js`</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">file</span> =&gt;</span> <span class="hljs-title function_">handlerFile</span>(file, app));

  <span class="hljs-comment">// 2. æ–°å¢ï¼šæ‰«æä¸šåŠ¡å±‚æ§åˆ¶å™¨ï¼ˆçº¦å®šä¸šåŠ¡è·¯å¾„ app/controllerï¼‰</span>
  <span class="hljs-keyword">const</span> businessControllerPath = path.<span class="hljs-title function_">resolve</span>(app.<span class="hljs-property">businessPath</span>, <span class="hljs-string">'./controller'</span>);
  <span class="hljs-keyword">const</span> businessFileList = glob.<span class="hljs-title function_">sync</span>(<span class="hljs-string">`<span class="hljs-subst">${businessControllerPath}</span>/**/*.js`</span>);
  businessFileList.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">file</span> =&gt;</span> <span class="hljs-title function_">handlerFile</span>(file, app));
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`-- [elpis] loaded <span class="hljs-subst">${businessFileList.length}</span> business controllers --`</span>);
}

<span class="hljs-comment">// ç»Ÿä¸€æŒ‚è½½é€»è¾‘ï¼šæ ¸å¿ƒä¸ä¸šåŠ¡æ¨¡å—å…±ç”¨</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">handlerFile</span>(<span class="hljs-params">file, app</span>) {
  <span class="hljs-keyword">const</span> controller = <span class="hljs-built_in">require</span>(file);
  <span class="hljs-keyword">const</span> moduleName = path.<span class="hljs-title function_">dirname</span>(file).<span class="hljs-title function_">split</span>(path.<span class="hljs-property">sep</span>).<span class="hljs-title function_">pop</span>();
  <span class="hljs-keyword">if</span> (!app.<span class="hljs-property">controller</span>[moduleName]) app.<span class="hljs-property">controller</span>[moduleName] = {};
  app.<span class="hljs-property">controller</span>[moduleName][path.<span class="hljs-title function_">basename</span>(file, <span class="hljs-string">'.js'</span>)] = controller;
}

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = loadController;
</code></pre>
<p>åŒæ—¶æ”¹é€ <code>elpis-core/index.js</code>ï¼Œæ–°å¢<strong>ä¸šåŠ¡å…¨å±€ä¸­é—´ä»¶æ³¨å†Œ</strong>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// elpis-core/index.js</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">start</span>(<span class="hljs-params">options = {}</span>) {
  <span class="hljs-keyword">const</span> app = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Koa</span>();
  app.<span class="hljs-property">businessPath</span> = options.<span class="hljs-property">businessPath</span> || process.<span class="hljs-title function_">cwd</span>() + <span class="hljs-string">'/app'</span>; <span class="hljs-comment">// çº¦å®šä¸šåŠ¡è·¯å¾„</span>

  <span class="hljs-comment">// æ³¨å†Œä¸šåŠ¡å…¨å±€ä¸­é—´ä»¶ï¼ˆçº¦å®šä¸šåŠ¡è·¯å¾„ middleware.jsï¼‰</span>
  <span class="hljs-keyword">try</span> {
    <span class="hljs-built_in">require</span>(<span class="hljs-string">`<span class="hljs-subst">${app.businessPath}</span>/middleware.js`</span>)(app);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`-- [elpis] loaded business global middleware --`</span>);
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[elpis] no business middleware, skip`</span>);
  }

  <span class="hljs-comment">// åŠ è½½æ ¸å¿ƒ+ä¸šåŠ¡æ¨¡å—ï¼ˆcontrollerã€serviceç­‰ï¼‰</span>
  <span class="hljs-title function_">loadController</span>(app);
  <span class="hljs-title function_">loadService</span>(app);
  app.<span class="hljs-title function_">listen</span>(options.<span class="hljs-property">port</span> || <span class="hljs-number">3000</span>);
  <span class="hljs-keyword">return</span> app;
}

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = { start };
</code></pre>
<p><strong>2. webpack é…ç½®ï¼šè‡ªåŠ¨æ‰«æä¸šåŠ¡é¡µé¢ï¼Œå®ç° â€œä¸šåŠ¡å…¥å£é›¶é…ç½®æ‰“åŒ…â€</strong></p>
<p>å¯¹<code>webpack.base.js</code>/<code>dev.js</code>/<code>prod.js</code>æ”¹é€ ï¼Œæ–°å¢<strong>ä¸šåŠ¡å±‚å…¥å£æ‰«æ</strong>ï¼Œè‡ªåŠ¨å°†ä¸šåŠ¡é¡µé¢çº³å…¥æ‰“åŒ…æµç¨‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// webpack/base.js</span>
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
<span class="hljs-keyword">const</span> glob = <span class="hljs-built_in">require</span>(<span class="hljs-string">'glob'</span>);
<span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'html-webpack-plugin'</span>);

<span class="hljs-comment">// 1. åˆå§‹åŒ–ä¸šåŠ¡å…¥å£ä¸HTMLæ’ä»¶å®¹å™¨</span>
<span class="hljs-keyword">const</span> businessEntries = {};
<span class="hljs-keyword">const</span> businessHtmlPlugins = [];

<span class="hljs-comment">// 2. æ‰«æä¸šåŠ¡å±‚å…¥å£ï¼ˆçº¦å®š app/pages/**/entry.*.jsï¼‰</span>
<span class="hljs-keyword">const</span> businessEntryList = path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), <span class="hljs-string">'./app/pages/**/entry.*.js'</span>);
glob.<span class="hljs-title function_">sync</span>(businessEntryList).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">file</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> entryName = path.<span class="hljs-title function_">basename</span>(file, <span class="hljs-string">'.js'</span>).<span class="hljs-title function_">replace</span>(<span class="hljs-string">'entry.'</span>, <span class="hljs-string">''</span>);
  <span class="hljs-comment">// é…ç½®å…¥å£</span>
  businessEntries[entryName] = file;
  <span class="hljs-comment">// é…ç½®HTMLæ¨¡æ¿</span>
  businessHtmlPlugins.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>({
    <span class="hljs-attr">filename</span>: <span class="hljs-string">`<span class="hljs-subst">${entryName}</span>.html`</span>,
    <span class="hljs-attr">template</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">'../template/entry.tpl'</span>),
    <span class="hljs-attr">chunks</span>: [entryName]
  }));
});

<span class="hljs-comment">// 3. åˆå¹¶æ ¸å¿ƒä¸ä¸šåŠ¡é…ç½®ï¼ˆæœ€ç»ˆå¯¼å‡ºï¼‰</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">entry</span>: { ...coreEntries, ...businessEntries }, <span class="hljs-comment">// åˆå¹¶å…¥å£</span>
  <span class="hljs-attr">plugins</span>: [...corePlugins, ...businessHtmlPlugins], <span class="hljs-comment">// åˆå¹¶æ’ä»¶</span>
  <span class="hljs-comment">// å…¶ä»–åŸºç¡€é…ç½®ï¼ˆloaderã€resolveç­‰ä¸å˜ï¼‰</span>
};
</code></pre>
<p><strong>3. æ¡†æ¶å…¥å£ index.jsï¼šå°è£…æ ¸å¿ƒ APIï¼Œå¯¹å¤–æš´éœ²æ ‡å‡†åŒ–èƒ½åŠ›</strong></p>
<p>å°†æ¡†æ¶æ ¸å¿ƒèƒ½åŠ›ï¼ˆæœåŠ¡å¯åŠ¨ã€å‰ç«¯æ„å»ºï¼‰å°è£…ä¸ºå‡½æ•°ï¼Œå¯¹å¤–æš´éœ²æ¸…æ™° APIï¼Œä¸šåŠ¡ä¾§ç›´æ¥è°ƒç”¨ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// index.jsï¼ˆelpisåŒ…å…¥å£ï¼‰</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">ElpisCore</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./elpis-core"</span>);
<span class="hljs-keyword">const</span> <span class="hljs-title class_">FEBuildDev</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./webpack/dev.js'</span>);
<span class="hljs-keyword">const</span> <span class="hljs-title class_">FEBuildProd</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./webpack/prod.js'</span>);

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-comment">// 1. æš´éœ²åŸºç¡€ç±»ï¼ˆä¾›ä¸šåŠ¡ç»§æ‰¿ï¼Œå‡å°‘é‡å¤ç¼–ç ï¼‰</span>
  <span class="hljs-title class_">Controller</span>: { <span class="hljs-title class_">Base</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./app/controller/base.js'</span>) },
  <span class="hljs-title class_">Service</span>: { <span class="hljs-title class_">Base</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./app/service/base.js'</span>) },

  <span class="hljs-comment">// 2. å‰ç«¯æ„å»ºï¼šæ”¯æŒå¼€å‘/ç”Ÿäº§ç¯å¢ƒ</span>
  <span class="hljs-title function_">frontendBuild</span>(<span class="hljs-params">paramsEnv</span>) {
    <span class="hljs-keyword">const</span> env = paramsEnv.<span class="hljs-title function_">trim</span>();
    env === <span class="hljs-string">'local'</span> ? <span class="hljs-title class_">FEBuildDev</span>() : <span class="hljs-title class_">FEBuildProd</span>();
  },

  <span class="hljs-comment">// 3. BFFæœåŠ¡å¯åŠ¨ï¼šæ¥æ”¶ä¸šåŠ¡é…ç½®ï¼Œè¿”å›å®ä¾‹</span>
  <span class="hljs-title function_">serverStart</span>(<span class="hljs-params">options = {}</span>) {
    <span class="hljs-keyword">const</span> app = <span class="hljs-title class_">ElpisCore</span>.<span class="hljs-title function_">start</span>(options);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`-- [elpis] server started at port <span class="hljs-subst">${options.port || <span class="hljs-number">3000</span>}</span> --`</span>);
    <span class="hljs-keyword">return</span> app;
  }
};
</code></pre>
<h3 data-id="heading-24">4. entry.dashboard.jsï¼šæ”¯æŒä¸šåŠ¡è·¯ç”±æ‹“å±•ï¼Œé›¶é…ç½®æ³¨å…¥</h3>
<p>æ–°å¢<strong>ä¸šåŠ¡è·¯ç”±æ‹“å±•æœºåˆ¶</strong>ï¼Œä¸šåŠ¡ä¾§æŒ‰çº¦å®šæš´éœ²é…ç½®å‡½æ•°å³å¯è‡ªåŠ¨æ³¨å…¥è·¯ç”±ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// app/pages/dashboard/entry.dashboard.js</span>
<span class="hljs-keyword">import</span> { createRouter, createWebHistory } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>;

<span class="hljs-comment">// 1. æ¡†æ¶æ ¸å¿ƒè·¯ç”±ï¼ˆåŸæœ‰é€»è¾‘ï¼‰</span>
<span class="hljs-keyword">const</span> routes = [<span class="hljs-comment">/* æ ¸å¿ƒé¡µé¢è·¯ç”± */</span>];
<span class="hljs-keyword">const</span> siderRoutes = [<span class="hljs-comment">/* æ ¸å¿ƒèœå•è·¯ç”± */</span>];

<span class="hljs-comment">// 2. æ–°å¢ï¼šä¸šåŠ¡è·¯ç”±æ‹“å±•ï¼ˆçº¦å®šä¸šåŠ¡æš´éœ² businessDashboardRouterConfigï¼‰</span>
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> businessDashboardRouterConfig === <span class="hljs-string">'function'</span>) {
  <span class="hljs-title function_">businessDashboardRouterConfig</span>({ routes, siderRoutes });
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`-- [elpis] extended business routes --`</span>);
}

<span class="hljs-comment">// 3. åˆ›å»ºè·¯ç”±å®ä¾‹å¹¶å¯¼å‡º</span>
<span class="hljs-keyword">const</span> router = <span class="hljs-title function_">createRouter</span>({ <span class="hljs-attr">history</span>: <span class="hljs-title function_">createWebHistory</span>(), routes });
<span class="hljs-keyword">export</span> { router, siderRoutes };
</code></pre>
<p><strong>5. ç»„ä»¶é…ç½®æ–‡ä»¶ï¼šæ”¯æŒä¸šåŠ¡ç»„ä»¶æ‹“å±•ï¼Œåˆå¹¶å¯¼å‡º</strong></p>
<p>æ”¹é€ <code>schema-view/components/component-config.js</code>ä¸<code>widgets/**/xx-item-config.js</code>ï¼Œæ–°å¢<strong>ä¸šåŠ¡ç»„ä»¶å¯¼å…¥</strong>ï¼Œåˆå¹¶æ ¸å¿ƒä¸ä¸šåŠ¡ç»„ä»¶ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// schema-view/components/component-config.js</span>
<span class="hljs-comment">// 1. æ¡†æ¶æ ¸å¿ƒç»„ä»¶ï¼ˆåŸæœ‰é€»è¾‘ï¼‰</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">CreateForm</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./create-form'</span>;
<span class="hljs-keyword">const</span> <span class="hljs-title class_">ComponentConfig</span> = { createForm };

<span class="hljs-comment">// 2. æ–°å¢ï¼šå¯¼å…¥ä¸šåŠ¡ç»„ä»¶ï¼ˆçº¦å®šä¸šåŠ¡è·¯å¾„ $businessComponentConfigï¼‰</span>
<span class="hljs-keyword">import</span> businessComponentConfig <span class="hljs-keyword">from</span> <span class="hljs-string">'$businessComponentConfig'</span>;

<span class="hljs-comment">// 3. åˆå¹¶å¯¼å‡ºï¼ˆä¸šåŠ¡ç»„ä»¶è¦†ç›–æ ¸å¿ƒç»„ä»¶ï¼Œæ”¯æŒå®šåˆ¶ï¼‰</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> { ...<span class="hljs-title class_">ComponentConfig</span>, ...businessComponentConfig };
</code></pre>
<p><strong>äºŒã€ä¸šåŠ¡ä¾§ä½¿ç”¨ï¼šelpis-demo é¡¹ç›®é›¶é…ç½®å¼€å‘</strong></p>
<p>ä¸šåŠ¡ä¾§åªéœ€åˆ›å»º<code>elpis-demo</code>é¡¹ç›®ï¼ŒæŒ‰ä»¥ä¸‹æ­¥éª¤å³å¯å¿«é€Ÿå¼€å‘ï¼š</p>
<ol>
<li>
<p><strong>å®‰è£… elpis åŒ…</strong>ï¼š<code>npm install elpis --save</code>ï¼ˆæˆ–<code>npm link</code>æœ¬åœ°è°ƒè¯•ï¼‰ï¼›</p>
</li>
<li>
<p><strong>æŒ‰çº¦å®šç›®å½•å¼€å‘</strong>ï¼šä¸šåŠ¡ä»£ç æ”¾åœ¨<code>app</code>ç›®å½•ä¸‹ï¼ˆå¦‚<code>app/controller</code>ã€<code>app/pages</code>ï¼‰ï¼Œæ— éœ€é…ç½® webpack/elpis-coreï¼›</p>
</li>
</ol>
<p><strong>ä¸‰ã€åŒ…å‘å¸ƒï¼šnpm æµç¨‹</strong></p>
<ol>
<li><strong>æœ¬åœ°è°ƒè¯•</strong>ï¼šé€šè¿‡<code>npm link</code>å°†<code>elpis</code>åŒ…é“¾æ¥åˆ°<code>elpis-demo</code>ï¼ŒéªŒè¯åŠŸèƒ½ï¼›</li>
<li><strong>ç™»å½• npm</strong>ï¼š<code>npm login</code>ï¼ˆè¾“å…¥è´¦å·å¯†ç ï¼‰ï¼›</li>
<li><strong>å‘å¸ƒåŒ…</strong>ï¼š<code>npm publish</code>ï¼ˆç¡®ä¿<code>package.json</code>ä¸­<code>name</code>å”¯ä¸€ï¼Œç‰ˆæœ¬å·æ­£ç¡®ï¼‰ã€‚</li>
</ol>
<h2 data-id="heading-25">è¿­ä»£å‘å±•æ–¹å‘</h2>
<p>æ·±åº¦èåˆ AI</p>
<p><strong>AI éœ€æ±‚è½¬é…ç½®</strong>ï¼šåŸºäºæ¡†æ¶å¼€å‘æŒ‡å—æ„å»ºä¸“å± AI æç¤ºè¯ï¼ˆPromptï¼‰ï¼Œå¼€å‘è€…åªéœ€è¾“å…¥è‡ªç„¶è¯­è¨€éœ€æ±‚ï¼ˆå¦‚ â€œæ–°å¢ç”µå•†åˆ†é”€ç®¡ç†æ¨¡å—ï¼ŒåŒ…å«åˆ†é”€å‘˜åˆ—è¡¨ã€ä½£é‡‘ç»Ÿè®¡ã€è®¢å•å…³è”åŠŸèƒ½â€ï¼‰ï¼ŒAI å³å¯è‡ªåŠ¨ç”Ÿæˆç¬¦åˆ elpis è§„èŒƒçš„é¢†åŸŸæ¨¡å‹é…ç½®ï¼ˆå­—æ®µå®šä¹‰ã€ç»„ä»¶äº¤äº’ã€API æ˜ å°„ï¼‰ï¼Œæ— éœ€æ‰‹åŠ¨ç¼–å†™ jsonSchema é…ç½®ï¼›</p>
<p><strong>AI Agentï¼šæ‰“é€  â€œå¼€å‘åŠ©æ‰‹â€:</strong>
å¼€å‘ elpis ä¸“å± AI Agentï¼Œé›†æˆæ¡†æ¶æ‰€æœ‰æ ¸å¿ƒèƒ½åŠ›ä¸è§„èŒƒï¼Œæ”¯æŒå¤šç»´åº¦äº¤äº’ï¼š</p>
<ul>
<li><strong>é…ç½®ç”Ÿæˆ</strong>ï¼šæ ¹æ®å¼€å‘è€…éœ€æ±‚æè¿°ï¼Œç”Ÿæˆ schema-view é¡µé¢é…ç½®ã€ä¸šåŠ¡è·¯ç”±é…ç½®ã€ç»„ä»¶æ‹“å±•é…ç½®ç­‰ï¼Œç›´æ¥é€‚é… elpis æ¡†æ¶çš„åŠ¨æ€æ¸²æŸ“é€»è¾‘ï¼›</li>
<li><strong>é—®é¢˜è§£ç­”</strong>ï¼šå¼€å‘è€…é‡åˆ°é…ç½®ç–‘é—®ï¼ˆå¦‚ â€œå¦‚ä½•è‡ªå®šä¹‰è¡¨æ ¼è¡Œæ“ä½œæŒ‰é’®â€â€œä¸šåŠ¡ç»„ä»¶å¦‚ä½•æŒ‚è½½åˆ°æ¡†æ¶â€ï¼‰æ—¶ï¼ŒAI Agent å¯åŸºäºæ¡†æ¶æ–‡æ¡£ç²¾å‡†å›å¤ï¼Œå¹¶æä¾›ä»£ç ç¤ºä¾‹ï¼›</li>
<li><strong>èƒ½åŠ›æ‹“å±•</strong>ï¼šæ”¯æŒå¼€å‘è€…æå‡ºç»„ä»¶æ‹“å±•éœ€æ±‚ï¼ˆå¦‚ â€œå¼€å‘ä¸€ä¸ªå¸¦æ—¶é—´èŒƒå›´é€‰æ‹©çš„æœç´¢æ§ä»¶â€ï¼‰ï¼ŒAI Agent è‡ªåŠ¨ç”Ÿæˆç¬¦åˆ elpis ç»„ä»¶è§„èŒƒçš„ä»£ç ï¼Œå¹¶è¯´æ˜æŒ‚è½½æ–¹å¼ï¼Œç¡®ä¿ä¸åç¦»æ¡†æ¶ç”Ÿæ€ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é‡Œç¨‹ç¢‘4ï¼šschema-form åŠ¨æ€ç»„ä»¶å¼€å‘]]></title>    <link>https://juejin.cn/post/7599910677578498048</link>    <guid>https://juejin.cn/post/7599910677578498048</guid>    <pubDate>2026-01-27T13:35:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599910677578498048" data-draft-id="7589509638339297306" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é‡Œç¨‹ç¢‘4ï¼šschema-form åŠ¨æ€ç»„ä»¶å¼€å‘"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js"/> <meta itemprop="datePublished" content="2026-01-27T13:35:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°æ€ªç‚¹ç‚¹"/> <meta itemprop="url" content="https://juejin.cn/user/1171413526123865"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é‡Œç¨‹ç¢‘4ï¼šschema-form åŠ¨æ€ç»„ä»¶å¼€å‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1171413526123865/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°æ€ªç‚¹ç‚¹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T13:35:45.000Z" title="Tue Jan 27 2026 13:35:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">åŠ¨æ€ç»„ä»¶åŸºäºé¢†åŸŸæ¨¡å‹æ¥è®¾è®¡ï¼Œä»¥æ•°æ®é©±åŠ¨å¼€å‘ã€‚</h3>
<p>åœ¨æ¨¡å‹ä¸­å¢åŠ componentConfigæ¥é…ç½®ç”¨åˆ°çš„ç»„ä»¶çš„å±æ€§ï¼Œæ¯ä¸ªå­—æ®µå¢åŠ componentOptionæ¥é…ç½®åœ¨æ¯ä¸ªåŠ¨æ€ç»„ä»¶ä¸­è¯¥å­—æ®µçš„å±•ç°å½¢å¼ï¼ŒåŠé»˜è®¤å€¼ç­‰ã€‚</p>
<p>æŠ½è±¡å‡ºschema-formç»„ä»¶ï¼šä½¿ç”¨åŠ¨æ€ç»„ä»¶<code>&lt;component&gt;</code>æ¥æŒ‰éœ€åŠ è½½inputã€selectç­‰ï¼Œform-item-config.jsä¸­åˆ—å‡ºç»„ä»¶çš„é”®å€¼å¯¹ã€‚
schema-formä¸‹è¾¹çš„inputï¼Œselectç­‰ç»„ä»¶ä¸­éœ€è¦å¼•å…¥ajvï¼Œæ ¹æ®é¢†åŸŸæ¨¡å‹ä¸­é…ç½®çš„æ ‡å‡†schemaï¼Œæ¥æ ¡éªŒç›¸å…³è¡¨å•é¡¹æ˜¯å¦æœ‰æ•ˆã€‚æä¾›å‡ºvalidateåŠgetValueæ–¹æ³•ã€‚</p>
<pre><code class="hljs language-import" lang="import">import inputNumber from './complex-view/input-number/input-number.vue';
import select from './complex-view/select/select.vue';
const formItemConfig = {
  input: {
    component: input,
  },
  inputNumber: {
    component: inputNumber,
  },
  select: {
    component: select,
  },
};
export default formItemConfig;
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/df948ab6b96d4ebfb060b3e44fbfb9ae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5oCq54K554K5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770125744&amp;x-signature=oH4Fo8RNpkD2TVzY02D%2FocW5qag%3D" alt="image.png" loading="lazy"/></p>
<p>ä»é…ç½®ä¸­æ‹¿åˆ°é…ç½®çš„ç»„ä»¶ï¼Œåœ¨schema-viewä¸­å°†åŠ¨æ€ç»„ä»¶å¼•å…¥ã€‚
ä½¿ç”¨æŠ½å±‰å½¢å¼å¼¹å‡ºcreateFormã€editFormã€detailFormã€‚</p>
<p>åœ¨schemaä¸­å­—æ®µé…ç½®é‡Œé…ç½®createFormOptionï¼ŒeditFormOptionç­‰ï¼Œæ¥è®¾å®šè¯¥å­—æ®µåœ¨è¿™ä¸ªç»„ä»¶ä¸­æ˜¯å¦æ˜¾ç¤ºï¼Œä»¥è¾“å…¥æ¡†è¿˜æ˜¯selectå½¢å¼æ˜¾ç¤ºç­‰ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>