<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[æ‰‹æ“ uniapp vue3 è™šæ‹Ÿåˆ—è¡¨é‡åˆ°çš„å‘]]></title>    <link>https://juejin.cn/post/7580740563893370914</link>    <guid>https://juejin.cn/post/7580740563893370914</guid>    <pubDate>2025-12-07T14:10:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580740563893370914" data-draft-id="7580735683939156002" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‰‹æ“ uniapp vue3 è™šæ‹Ÿåˆ—è¡¨é‡åˆ°çš„å‘"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-07T14:10:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="heyCHEEMS"/> <meta itemprop="url" content="https://juejin.cn/user/4308367489378780"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‰‹æ“ uniapp vue3 è™šæ‹Ÿåˆ—è¡¨é‡åˆ°çš„å‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4308367489378780/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    heyCHEEMS
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T14:10:47.000Z" title="Sun Dec 07 2025 14:10:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    24
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">è™šæ‹Ÿåˆ—è¡¨çš„æ ¸å¿ƒæ€æƒ³</h2>
<p>è™šæ‹Ÿåˆ—è¡¨çš„æ ¸å¿ƒå…¶å®å¾ˆç®€å•ï¼š<strong>åªæ¸²æŸ“ç”¨æˆ·èƒ½çœ‹åˆ°çš„é‚£éƒ¨åˆ†å†…å®¹</strong>ã€‚å½“ç”¨æˆ·æ»šåŠ¨æ—¶ï¼ŒåŠ¨æ€è®¡ç®—å“ªäº›å…ƒç´ åº”è¯¥å‡ºç°åœ¨å¯è§†åŒºåŸŸå†…ï¼Œç„¶ååªæ¸²æŸ“è¿™äº›å…ƒç´ ï¼Œåœ¨å¤§æ•°æ®é‡åˆ—è¡¨ä¸­èƒ½æ˜¾è‘—æå‡æ€§èƒ½ã€‚</p>
<h2 data-id="heading-1">åŸºæœ¬å®ç°æ€è·¯</h2>
<ol>
<li>ç”¨ä¸€ä¸ªå›ºå®šé«˜åº¦çš„å®¹å™¨åŒ…è£¹æ•´ä¸ªåˆ—è¡¨</li>
<li>è®¡ç®—æ€»å†…å®¹é«˜åº¦ï¼ˆç”¨å ä½å…ƒç´ æ’‘å¼€ï¼‰</li>
<li>ç›‘å¬æ»šåŠ¨äº‹ä»¶ï¼Œè®¡ç®—å½“å‰å¯è§†åŒºåŸŸçš„èµ·å§‹ç´¢å¼•</li>
<li>åªæ¸²æŸ“å¯è§†åŒºåŸŸå†…çš„å…ƒç´ ï¼Œå…¶ä»–ç”¨ç©ºç™½å¡«å……</li>
<li>é€šè¿‡ <code>transform</code> æ¥å®šä½å®é™…å†…å®¹</li>
</ol>
<h2 data-id="heading-2">é‡åˆ°çš„å‘</h2>
<h3 data-id="heading-3">1. å ä½ç¬¦å¯¼è‡´çš„å¸ƒå±€é—®é¢˜</h3>
<p>æœ€å¼€å§‹å®ç°æ—¶ï¼Œå ä½ç¬¦å’Œåˆ—è¡¨å®¹å™¨éƒ½åœ¨æ–‡æ¡£æµå†…ï¼Œå¯¼è‡´åˆ—è¡¨å®¹å™¨ç›¸å¯¹å ä½ç¬¦å®šä½è€Œåç¦»äº†ä½ç½®ï¼Œè§£å†³åŠæ³•å°±æ˜¯è®©å ä½ç¬¦è„±ç¦»æ–‡æ¡£æµï¼Œè®¾ä¸ºç»å¯¹å®šä½ï¼Œå¤–å±‚å®¹å™¨ä¿æŒç›¸å¯¹å®šä½ã€‚</p>
<h3 data-id="heading-4">2. æ»šåŠ¨é—ªçƒé—®é¢˜</h3>
<p>åœ¨å¿«é€Ÿæ»šåŠ¨æ—¶ï¼Œæœ‰æ—¶ä¼šå‡ºç°ç©ºç™½é—ªçƒã€‚åŸå› æ˜¯ï¼š</p>
<ul>
<li>é¢„æ¸²æŸ“çš„ç¼“å†²å…ƒç´ æ•°é‡ä¸è¶³</li>
<li>å…ƒç´ å°ºå¯¸æµ‹é‡å»¶è¿Ÿ</li>
</ul>
<p>é€šè¿‡å¢åŠ  <code>buffer</code>å±æ€§å’Œå¼‚æ­¥æµ‹é‡è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-type">const</span> visibleRange = <span class="hljs-built_in">computed</span>(() =&gt; {
  <span class="hljs-comment">// ... è®¡ç®—é€»è¾‘</span>
  <span class="hljs-keyword">return</span> { start, end: Math.<span class="hljs-built_in">min</span>(end + props.buffer, props.list.length) }
})
</code></pre>
<p><code>buffer</code>å…¶å®å°±æ˜¯é¢„åŠ è½½çš„ç¼“å†²åŒºåŸŸï¼Œè®¾ç½®ä¸º3åˆ™ä»£è¡¨å‰åå¤šæ¸²æŸ“3ä¸ªitemï¼Œè¿™æ ·å°±å¯ä»¥é˜²æ­¢æ»‘åŠ¨è¿‡å¿«å¯¼è‡´æ¸²æŸ“è·Ÿä¸ä¸Šè€Œç™½å±ã€‚</p>
<h3 data-id="heading-5">3. å…ƒç´ å°ºå¯¸æµ‹é‡ä¸å‡†</h3>
<p>åœ¨ UniApp ä¸­æµ‹é‡å…ƒç´ å°ºå¯¸éœ€è¦ä½¿ç”¨ <code>uni.createSelectorQuery()</code>ï¼Œä½†è¿™é‡Œæœ‰å‡ ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li>å¿…é¡»åœ¨ç»„ä»¶æŒ‚è½½åæ‰èƒ½æµ‹é‡</li>
<li>å¼‚æ­¥æµ‹é‡å¯¼è‡´åˆå§‹æ¸²æŸ“æ—¶ä½¿ç”¨é¢„ä¼°å°ºå¯¸</li>
<li>å…ƒç´ åŠ¨æ€å˜åŒ–æ—¶å°ºå¯¸éœ€è¦é‡æ–°æµ‹é‡</li>
</ul>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">measureItem</span> = (<span class="hljs-params">index: <span class="hljs-built_in">number</span></span>) =&gt; {
  <span class="hljs-keyword">const</span> itemIndex = visibleRange.<span class="hljs-property">value</span>.<span class="hljs-property">start</span> + index
  <span class="hljs-keyword">if</span> (measured.<span class="hljs-title function_">has</span>(itemIndex)) <span class="hljs-keyword">return</span>
  
  uni
    .<span class="hljs-title function_">createSelectorQuery</span>()
    .<span class="hljs-title function_">in</span>(instance?.<span class="hljs-property">proxy</span>)
    .<span class="hljs-title function_">select</span>(<span class="hljs-string">`.item-<span class="hljs-subst">${itemIndex}</span>`</span>)
    .<span class="hljs-title function_">boundingClientRect</span>(<span class="hljs-function">(<span class="hljs-params">res: <span class="hljs-built_in">any</span></span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (res) {
        <span class="hljs-keyword">const</span> size = isVertical.<span class="hljs-property">value</span> ? res.<span class="hljs-property">height</span> : res.<span class="hljs-property">width</span>
        itemSizes.<span class="hljs-property">value</span>[itemIndex] = size
        measured.<span class="hljs-title function_">add</span>(itemIndex)
      }
    })
    .<span class="hljs-title function_">exec</span>()
}
</code></pre>
<p>ç”¨ <code>measured</code>Set è®°å½•å·²ç»æµ‹é‡è¿‡çš„å…ƒç´ ï¼Œé¿å…é‡å¤æµ‹é‡ã€‚</p>
<h3 data-id="heading-6">4. æ»šåŠ¨æ€§èƒ½ä¼˜åŒ–</h3>
<p>ç›´æ¥åœ¨ <code>@scroll</code>äº‹ä»¶ä¸­æ›´æ–°çŠ¶æ€åœ¨å¿«é€Ÿæ»šåŠ¨æ—¶ä¼šæœ‰æ€§èƒ½é—®é¢˜ï¼Œä½† UniApp çš„ <code>scroll-view</code>æœ¬èº«å°±æœ‰èŠ‚æµï¼Œæ‰€ä»¥æ²¡æœ‰é¢å¤–å¤„ç†ã€‚å¦‚æœéœ€è¦æ›´ç²¾ç»†çš„æ§åˆ¶ï¼Œå¯ä»¥è€ƒè™‘ç”¨é˜²æŠ–æˆ–èŠ‚æµåŒ…è£…æ»šåŠ¨å¤„ç†å‡½æ•°ã€‚</p>
<h3 data-id="heading-7">5. æ•°æ®æ›´æ–°å¤„ç†</h3>
<p>å½“åˆ—è¡¨æ•°æ®å˜åŒ–æ—¶ï¼Œä¹‹å‰æµ‹é‡çš„å°ºå¯¸å°±å¤±æ•ˆäº†ã€‚æˆ‘é€šè¿‡ watch ç›‘å¬æ•°æ®å˜åŒ–æ¥é‡ç½®ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">watch</span>(
  () =&gt; props<span class="hljs-selector-class">.list</span>,
  () =&gt; {
    itemSizes<span class="hljs-selector-class">.value</span> = <span class="hljs-selector-attr">[]</span>
    measured<span class="hljs-selector-class">.clear</span>()
  },
  { deep: true }
)
</code></pre>
<h3 data-id="heading-8">6. æ°´å¹³æ»šåŠ¨çš„é€‚é…</h3>
<p>ä¸ºäº†è®©ç»„ä»¶åŒæ—¶æ”¯æŒå‚ç›´å’Œæ°´å¹³æ»šåŠ¨ï¼Œéœ€è¦åŠ ä¸€ç‚¹æ¡ä»¶åˆ¤æ–­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> isVertical = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">return</span> props.<span class="hljs-property">direction</span> === <span class="hljs-string">'vertical'</span>
})

<span class="hljs-comment">// åœ¨æ ·å¼ä¸­</span>
<span class="hljs-attr">transform</span>: isVertical.<span class="hljs-property">value</span>
  ? <span class="hljs-string">`translateY(<span class="hljs-subst">${startOffset.value}</span>px)`</span>
  : <span class="hljs-string">`translateX(<span class="hljs-subst">${startOffset.value}</span>px)`</span>
</code></pre>
<h2 data-id="heading-9">ä½¿ç”¨ç¤ºä¾‹</h2>
<pre><code class="hljs language-ini" lang="ini">&lt;yt-virtual-list
  :<span class="hljs-attr">list</span>=<span class="hljs-string">"data"</span>
  <span class="hljs-attr">direction</span>=<span class="hljs-string">"vertical"</span>
  <span class="hljs-attr">height</span>=<span class="hljs-string">"200px"</span>
  :<span class="hljs-attr">buffer</span>=<span class="hljs-string">"3"</span>
  :<span class="hljs-attr">estimatedSize</span>=<span class="hljs-string">"40"</span>
&gt;
  &lt;template <span class="hljs-comment">#list-item="{ item, index }"&gt;</span>
    &lt;view <span class="hljs-attr">class</span>=<span class="hljs-string">"list-item"</span>&gt;
      &lt;text&gt;{{ index }}. {{ item.name }}&lt;/text&gt;
    &lt;/view&gt;
  &lt;/template&gt;
&lt;/yt-virtual-list&gt;
</code></pre>
<h2 data-id="heading-10">æ€»ç»“</h2>
<p>æ‰‹æ“è™šæ‹Ÿåˆ—è¡¨æœ€å¤§çš„æ”¶è·æ˜¯ç†è§£äº†è™šæ‹Ÿæ»šåŠ¨çš„åŸç†ã€‚è™½ç„¶æœ‰ä¸€äº›å‘ï¼Œä½†è§£å†³äº†ä¹‹åçš„æ•ˆæœè¿˜æ˜¯å¾ˆæ˜æ˜¾çš„ï¼Œç‰¹åˆ«æ˜¯åœ¨ç§»åŠ¨ç«¯å¤„ç†é•¿åˆ—è¡¨æ—¶ï¼Œæ€§èƒ½æå‡éå¸¸æ˜¾è‘—ã€‚ å…³é”®ç‚¹ï¼š</p>
<ul>
<li>æ­£ç¡®è®¡ç®—å’Œæ›´æ–°å…ƒç´ ä½ç½®</li>
<li>åˆç†çš„ç¼“å†²æœºåˆ¶é˜²æ­¢ç©ºç™½</li>
<li>å‡†ç¡®çš„å°ºå¯¸æµ‹é‡</li>
<li>å¤„ç†å¥½æ•°æ®å˜åŒ–æ—¶çš„çŠ¶æ€é‡ç½®</li>
</ul>
<p>è™šæ‹Ÿåˆ—è¡¨åœ¨ç§»åŠ¨ç«¯å¼€å‘ä¸­æ˜¯ä¸ªå¾ˆå®ç”¨çš„ä¼˜åŒ–æ‰‹æ®µï¼Œå€¼å¾—èŠ±æ—¶é—´ç†è§£å’Œå®ç°ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç´§æ€¥æ’æ’­ï¼šCVSS 10.0 æ»¡åˆ†æ¼æ´ï¼ä½ çš„ Next.js é¡¹ç›®å¯èƒ½æ­£åœ¨è£¸å¥”]]></title>    <link>https://juejin.cn/post/7580372534043689003</link>    <guid>https://juejin.cn/post/7580372534043689003</guid>    <pubDate>2025-12-07T14:40:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580372534043689003" data-draft-id="7580389111921426495" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç´§æ€¥æ’æ’­ï¼šCVSS 10.0 æ»¡åˆ†æ¼æ´ï¼ä½ çš„ Next.js é¡¹ç›®å¯èƒ½æ­£åœ¨è£¸å¥”"/> <meta itemprop="keywords" content="å‰ç«¯,Next.js"/> <meta itemprop="datePublished" content="2025-12-07T14:40:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Duckä¸å¿…"/> <meta itemprop="url" content="https://juejin.cn/user/2291826942022296"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç´§æ€¥æ’æ’­ï¼šCVSS 10.0 æ»¡åˆ†æ¼æ´ï¼ä½ çš„ Next.js é¡¹ç›®å¯èƒ½æ­£åœ¨è£¸å¥”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2291826942022296/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Duckä¸å¿…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T14:40:39.000Z" title="Sun Dec 07 2025 14:40:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸš¨ ç´§æ€¥æ’æ’­ï¼šCVSS 10.0 æ»¡åˆ†æ¼æ´ï¼ä½ çš„ Next.js é¡¹ç›®å¯èƒ½æ­£åœ¨è£¸å¥”ï¼ˆå«ä¿å§†çº§ä¿®å¤æŒ‡å—ï¼‰</h2>
<blockquote>
<p><strong>âš ï¸ é«˜èƒ½é¢„è­¦</strong>ï¼šè¿™ä¸æ˜¯æ¼”ä¹ ï¼è¿™ä¸æ˜¯æ¼”ä¹ ï¼</p>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ [ä½ çš„åå­—]ã€‚ä»Šå¤©ä¸èŠæ¶æ„ï¼Œä¸èŠæºç ï¼Œå’±ä»¬æ¥èŠèŠä¿å‘½çš„äº‹å„¿ã€‚</p>
<p>å°±åœ¨ 2025 å¹´ 12 æœˆåˆï¼Œå®‰å…¨åœˆç‚¸é”…äº†ã€‚React å’Œ Next.js ç”Ÿæ€çˆ†å‡ºäº†ä¸€ä¸ªæ ¸å¼¹çº§æ¼æ´ï¼ˆCVE-2025-66478 &amp; CVE-2025-55182ï¼‰ï¼ŒCVSS è¯„åˆ†ç›´æ¥æ‹‰æ»¡åˆ°äº† <strong>10.0</strong>ã€‚ä»€ä¹ˆæ¦‚å¿µï¼Ÿè¿™æ„å‘³ç€æ”»å‡»è€…<strong>ä¸éœ€è¦ç™»å½•ã€ä¸éœ€è¦å¤æ‚çš„æƒé™</strong>ï¼ŒåŠ¨åŠ¨æ‰‹æŒ‡å‘ä¸ª HTTP è¯·æ±‚ï¼Œå°±èƒ½åœ¨ä½ æœåŠ¡å™¨ä¸Š<strong>æ‰§è¡Œä»»æ„ä»£ç  (RCE)</strong>ã€‚</p>
<p>å…„å¼Ÿä»¬ï¼Œèµ¶ç´§æ”¾ä¸‹æ‰‹é‡Œçš„å’–å•¡ï¼Œè·Ÿæˆ‘ä¸€èµ·æ£€æŸ¥ä¸‹ä½ çš„çº¿ä¸ŠæœåŠ¡å§ï¼</p>
</blockquote>
<hr/>
<h3 data-id="heading-1">1. å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</h3>
<p>ç®€å•è¯´ï¼Œå°±æ˜¯ React Server Components (RSC) çš„é€šä¿¡åè®®ï¼ˆFlight åè®®ï¼‰é‡Œï¼Œå‡ºäº†ä¸€ä¸ªååºåˆ—åŒ–çš„ Bugã€‚</p>
<ul>
<li><strong>æ¼æ´ç¼–å·</strong>ï¼šCVE-2025-66478 (Next.js) / CVE-2025-55182 (React)</li>
<li><strong>å±é™©ç­‰çº§</strong>ï¼šğŸ”¥ <strong>Critical (RCE)</strong></li>
<li><strong>è°åœ¨å°„ç¨‹å†…</strong>ï¼š
<ul>
<li>åªè¦ä½ ç”¨äº† <strong>App Router</strong>ã€‚</li>
<li>æˆ–è€…ä½ ç”¨äº† <strong>React Server Components</strong>ã€‚</li>
<li>ç‰¹åˆ«æ˜¯ <strong>Next.js 15.x / 16.x</strong> çš„æ—©æœŸç‰ˆæœ¬ï¼Œä»¥åŠ <strong>Next.js 14.x</strong> çš„éƒ¨åˆ† Canary ç‰ˆæœ¬ã€‚</li>
<li><strong>åˆ’é‡ç‚¹</strong>ï¼šé»˜è®¤é…ç½®ä¸‹çš„ <code>create-next-app</code> é¡¹ç›®å¦‚æœæ˜¯ä¸Šè¿°ç‰ˆæœ¬ï¼Œç›´æ¥ä¸­æ‹›ã€‚</li>
</ul>
</li>
</ul>
<p>å¦‚æœä¸ä¿®ï¼Œé»‘å®¢ä¸ä»…èƒ½çœ‹ä½ çš„ç¯å¢ƒå˜é‡ï¼ˆæ•°æ®åº“å¯†ç ã€API Keyï¼‰ï¼Œç”šè‡³èƒ½ç›´æ¥æ¥ç®¡ä½ çš„æœåŠ¡å™¨æŒ–çŸ¿ã€‚ğŸ˜±</p>
<hr/>
<h3 data-id="heading-2">2. èµ¶ç´§è‡ªæŸ¥ï¼(æ‰‹æŠŠæ‰‹æ•™ä½ )</h3>
<p>åˆ«æ…Œï¼Œå…ˆç¡®è®¤ä¸‹è‡ªå·±æ˜¯ä¸æ˜¯â€œå¤©é€‰ä¹‹å­â€ã€‚è¿ä¸Šä½ çš„æœåŠ¡å™¨ï¼Œæˆ–è€…åœ¨æœ¬åœ°é¡¹ç›®é‡Œè·‘ä¸€ä¸‹ï¼š</p>
<h4 data-id="heading-3">ç¬¬ä¸€æ­¥ï¼šçœ‹ä¸€çœ¼ <code>package.json</code></h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># çœ‹çœ‹ä½ æ˜¾å¼å®‰è£…çš„ç‰ˆæœ¬</span>
<span class="hljs-built_in">cat</span> package.json | grep next
</code></pre>
<h4 data-id="heading-4">ç¬¬äºŒæ­¥ï¼šçœ‹ä¸€çœ¼å®é™…å®‰è£…ç‰ˆæœ¬ï¼ˆè¿™æ­¥å¾ˆå…³é”®ï¼ï¼‰</h4>
<p>æœ‰æ—¶å€™ <code>package.json</code> é‡Œå†™çš„æ˜¯ <code>^15.0.0</code>ï¼Œä½†å®é™… <code>node_modules</code> é‡Œè·‘çš„å¯èƒ½æ˜¯ä¸ªæœ‰æ¼æ´çš„å°ç‰ˆæœ¬ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥æŸ¥æˆ·å£æœ¬</span>
npm list next
<span class="hljs-comment"># æˆ–è€… yarn å…š</span>
yarn list next
</code></pre>
<h4 data-id="heading-5">ğŸš¨ æ­»äº¡åå•</h4>
<p>å¦‚æœä½ çœ‹åˆ°ç‰ˆæœ¬å·è½åœ¨ä¸‹é¢è¿™äº›åŒºé—´ï¼Œè¯·ç«‹å³å¼€å¯â€œä¸€çº§æˆ˜å¤‡â€çŠ¶æ€ï¼š</p>
<ul>
<li>âŒ <strong>Next.js 15.x</strong> å…¨ç³»ï¼ˆæœªæ‰“è¡¥ä¸å‰ï¼‰</li>
<li>âŒ <strong>Next.js 16.x</strong> é¢„è§ˆç‰ˆï¼ˆæœªæ‰“è¡¥ä¸å‰ï¼‰</li>
<li>âŒ <strong>Next.js 14.x</strong> çš„ Canary ç‰ˆæœ¬ï¼ˆå°¤å…¶æ˜¯ <code>&gt;= 14.3.0-canary.77</code>ï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-6">3. æ€ä¹ˆæ•‘ï¼Ÿ(Ctrl+C, Ctrl+V å°±èƒ½ç”¨)</h3>
<p>å®˜æ–¹å“åº”å¾ˆå¿«ï¼Œè¡¥ä¸å·²ç»å‘äº†ã€‚<strong>å‡çº§æ˜¯å”¯ä¸€é è°±çš„æ–¹æ¡ˆ</strong>ï¼Œåˆ«æ•´é‚£äº›èŠ±é‡Œèƒ¡å“¨çš„ WAF è§„åˆ™ï¼Œå®¹æ˜“è¢«ç»•è¿‡ã€‚</p>
<h4 data-id="heading-7">æ–¹æ¡ˆ Aï¼šæˆ‘æ˜¯ç¨³å®šå…š (æ¨è) ğŸš€</h4>
<p>å¦‚æœä½ çš„é¡¹ç›®æ²¡ä»€ä¹ˆé­”æ”¹ä¾èµ–ï¼Œç›´æ¥å‡åˆ°æœ€æ–°çš„ç¨³å®šç‰ˆ Patchã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># npm å…š</span>
npm install next@latest react@latest react-dom@latest

<span class="hljs-comment"># yarn å…š</span>
yarn add next@latest react@latest react-dom@latest

<span class="hljs-comment"># pnpm å…š (yyds)</span>
pnpm add next@latest react@latest react-dom@latest
</code></pre>
<h4 data-id="heading-8">æ–¹æ¡ˆ Bï¼šæˆ‘æ˜¯æ¿€è¿›å…š/Canary ä¾èµ–è€… ğŸ§ª</h4>
<p>æœ‰äº›å…„å¼Ÿä¸ºäº†å°é²œæˆ–è€…æŸäº›ç‰¹æ€§é”æ­»äº† Canary ç‰ˆæœ¬ï¼Œé‚£ä½ å¾—å‡åˆ°ä¿®å¤åçš„ Canaryï¼ˆæ¯”å¦‚ <code>15.6.0-canary.58</code> æˆ–æ›´æ–°ï¼‰ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">npm install next@canary
</code></pre>
<h4 data-id="heading-9">âš ï¸ åˆ«å¿˜äº†æœ€åä¸€æ­¥ï¼</h4>
<p>å‡çº§å®Œä¾èµ–ï¼Œä»£ç åªæ˜¯åœ¨ç¡¬ç›˜ä¸Šå˜äº†ï¼Œå†…å­˜é‡Œè·‘çš„è¿˜æ˜¯æ—§çš„ã€‚<strong>ä¸€å®šè¦é‡å¯æœåŠ¡ï¼ä¸€å®šè¦é‡å¯æœåŠ¡ï¼ä¸€å®šè¦é‡å¯æœåŠ¡ï¼</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># PM2 ç”¨æˆ·</span>
pm2 reload all

<span class="hljs-comment"># Docker ç”¨æˆ·</span>
docker-compose up -d --build
</code></pre>
<hr/>
<h3 data-id="heading-10">4. å®åœ¨å‡ä¸åŠ¨æ€ä¹ˆåŠï¼Ÿ(æ•‘æ€¥ç”¨)</h3>
<p>â€œå¤§ä½¬ï¼Œæˆ‘é¡¹ç›®å¤ªè€/ä¾èµ–å†²çªï¼Œå‡äº†å°±å´©å•Šï¼â€</p>
<p>ç†è§£ç†è§£ï¼Œä¸šåŠ¡ç”±äºæŸäº›ä¸å¯æŠ—åŠ›æš‚æ—¶åŠ¨ä¸äº†ã€‚è¿™æ—¶å€™åªèƒ½æ­»é©¬å½“æ´»é©¬åŒ»äº†ï¼š</p>
<ol>
<li><strong>é™çº§ä¿å¹³å®‰</strong>ï¼šå¦‚æœæ²¡ç”¨åˆ°æœ€æ–°çš„ RSC ç‰¹æ€§ï¼Œå°è¯•é€€å›åˆ° <strong>Next.js 14.2.x ç¨³å®šç‰ˆ</strong>ï¼ˆç¡®è®¤ä¸ºé Canary ç‰ˆæœ¬ï¼‰ã€‚</li>
<li><strong>WAF æŒ¡ä¸€æŒ¡</strong>ï¼šåœ¨ Nginx æˆ–è€…äº‘å‚å•†çš„ WAF ä¸Šï¼Œé’ˆå¯¹å¼‚å¸¸çš„å¤§åŒ…ä½“æˆ–è€…ç•¸å½¢çš„ RSC è¯·æ±‚å¤´åšæ‹¦æˆªã€‚ä½†è¯´å®è¯ï¼Œè¿™æ‹›é˜²å›å­ä¸é˜²å°äººã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-11">5. è¿™æ˜¯ä¸€ä¸ªæ•™è®­</h3>
<p>è¿™æ¬¡æ¼æ´ä¹Ÿç»™å’±ä»¬æäº†ä¸ªé†’ï¼š</p>
<ol>
<li><strong>ç”Ÿäº§ç¯å¢ƒåˆ«ä¹±ç”¨ Canary</strong>ï¼šé™¤éä½ çœŸçš„éœ€è¦é‚£ä¸ªç‰¹æ€§ï¼Œå¦åˆ™ç¨³å®šç‰ˆæ‰æ˜¯ç‹é“ã€‚</li>
<li><strong>Lock æ–‡ä»¶è¦æäº¤</strong>ï¼š<code>package-lock.json</code> / <code>yarn.lock</code> æ˜¯ä¿å‘½ç¬¦ï¼Œåˆ« gitignore äº†ã€‚</li>
<li><strong>å…³æ³¨å®‰å…¨å…¬å‘Š</strong>ï¼šæ²¡äº‹å¤šåˆ·åˆ· GitHub Advisoryï¼Œæˆ–è€…å…³æ³¨æˆ‘ï¼ˆç–¯ç‹‚æš—ç¤ºï¼‰ï¼Œæœ‰å¤§ç“œç¬¬ä¸€æ—¶é—´å¸¦ä½ åƒã€‚</li>
</ol>
<hr/>
<p><strong>æœ€å</strong>ï¼š
æ­¤æ—¶æ­¤åˆ»ï¼Œè¿˜åœ¨åŠ ç­ä¿® Bug çš„è¿ç»´å’Œå¼€å‘å…„å¼Ÿä»¬ï¼Œè¾›è‹¦äº†ï¼æ„¿ä¸–é—´å†æ—  RCEã€‚ğŸ™</p>
<p><em>å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æ•‘äº†ä½ çš„æœåŠ¡å™¨ï¼Œç‚¹ä¸ªèµå†èµ°å‘—~</em></p>
<hr/>
<blockquote>
<p><strong>å…è´£å£°æ˜</strong>: æœ¬æ–‡æ“ä½œä»…ä¾›å‚è€ƒï¼Œç”Ÿäº§ç¯å¢ƒå˜æ›´å‰è¯·åŠ¡å¿…åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯ï¼ç‚¸äº†åˆ«æ‰¾æˆ‘ï¼</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[React å¦‚ä½•ç”¨ MessageChannel æ¨¡æ‹Ÿ requestIdleCallback]]></title>    <link>https://juejin.cn/post/7580547126361194559</link>    <guid>https://juejin.cn/post/7580547126361194559</guid>    <pubDate>2025-12-07T15:17:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580547126361194559" data-draft-id="7580372534043705387" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="React å¦‚ä½•ç”¨ MessageChannel æ¨¡æ‹Ÿ requestIdleCallback"/> <meta itemprop="keywords" content="å‰ç«¯,React.js"/> <meta itemprop="datePublished" content="2025-12-07T15:17:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="day1"/> <meta itemprop="url" content="https://juejin.cn/user/4310544201823182"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            React å¦‚ä½•ç”¨ MessageChannel æ¨¡æ‹Ÿ requestIdleCallback
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4310544201823182/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    day1
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T15:17:12.000Z" title="Sun Dec 07 2025 15:17:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. å¼•è¨€</h2>
<p>åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œé¡µé¢å¡é¡¿æ˜¯å½±å“ç”¨æˆ·ä½“éªŒçš„æ ¸å¿ƒé—®é¢˜ä¹‹ä¸€ï¼Œè€Œé•¿æ—¶é—´çš„åŒæ­¥ä»»åŠ¡é˜»å¡ä¸»çº¿ç¨‹æ˜¯å¯¼è‡´å¡é¡¿çš„ä¸»è¦åŸå› ã€‚React çš„ Schedulerï¼ˆè°ƒåº¦å™¨ï¼‰ä½œä¸ºæ ¸å¿ƒæ¨¡å—ï¼Œé€šè¿‡åä½œå¼è°ƒåº¦è§£å†³äº†è¿™ä¸€é—®é¢˜ï¼Œå…¶å…³é”®åœ¨äºç”¨ MessageChannel æ¨¡æ‹Ÿ requestIdleCallback å®ç°ä»»åŠ¡çš„ç¢ç‰‡åŒ–æ‰§è¡Œã€‚æœ¬æ–‡å°†ä»å®é™…å¡é¡¿æ¡ˆä¾‹å‡ºå‘ï¼Œé€æ­¥æ‹†è§£ requestIdleCallback çš„ä½œç”¨ã€ä¸è¶³ï¼Œä»¥åŠ React å¦‚ä½•åŸºäº MessageChannel å®ç°æ›´å¯é çš„åä½œå¼è°ƒåº¦ã€‚</p>
<h2 data-id="heading-1">2. ç›´è§‚æ„Ÿå—ï¼šä¸»çº¿ç¨‹é˜»å¡å¯¼è‡´çš„é¡µé¢å¡é¡¿</h2>
<p>åœ¨æµè§ˆå™¨ä¸­ï¼ŒJS æ‰§è¡Œã€DOM æ¸²æŸ“ã€äº‹ä»¶å“åº”ç­‰éƒ½ä¾èµ–ä¸»çº¿ç¨‹ï¼Œè‹¥ä¸»çº¿ç¨‹è¢«é•¿æ—¶é—´åŒæ­¥ä»»åŠ¡å ç”¨ï¼Œé¡µé¢ä¼šå¤±å»å“åº”ï¼Œå‡ºç°ç‚¹å‡»æ— åé¦ˆã€åŠ¨ç”»å¡é¡¿ç­‰é—®é¢˜ã€‚æˆ‘ä»¬å…ˆé€šè¿‡ä¸¤ä¸ªåŸç”Ÿç¤ºä¾‹ï¼Œç›´è§‚æ„Ÿå—éå¡é¡¿ä¸å¡é¡¿çš„å·®å¼‚ã€‚</p>
<h3 data-id="heading-2">2.1 æ— å¡é¡¿çš„æ­£å¸¸åœºæ™¯</h3>
<p>è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å®ç°ä¸€ä¸ªç®€å•çš„æŒ‰é’®ç‚¹å‡»è®¡æ•°å’ŒåŠ¨ç”»æ•ˆæœï¼Œæ‰€æœ‰ä»»åŠ¡å‡ä¸ºçŸ­æ—¶é—´æ‰§è¡Œï¼Œä¸»çº¿ç¨‹å§‹ç»ˆå¤„äºç©ºé—²çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-CN"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>æ— å¡é¡¿ç¤ºä¾‹<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
      <span class="hljs-selector-class">.box</span> {
        <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;
        <span class="hljs-attribute">background</span>: <span class="hljs-number">#42b983</span>;
        <span class="hljs-attribute">position</span>: relative;
        <span class="hljs-attribute">animation</span>: move <span class="hljs-number">2s</span> linear infinite alternate;
      }
      <span class="hljs-keyword">@keyframes</span> move {
        <span class="hljs-selector-tag">from</span> {
          <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
        }
        <span class="hljs-selector-tag">to</span> {
          <span class="hljs-attribute">left</span>: <span class="hljs-number">500px</span>;
        }
      }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"box"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"btn"</span>&gt;</span>ç‚¹å‡»è®¡æ•°<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è®¡æ•°ï¼š<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"count"</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
      <span class="hljs-keyword">const</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"btn"</span>);
      <span class="hljs-keyword">const</span> countSpan = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"count"</span>);
      <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;

      <span class="hljs-comment">// çŸ­æ—¶é—´ä»»åŠ¡ï¼šç‚¹å‡»è®¡æ•°</span>
      btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"click"</span>, <span class="hljs-function">() =&gt;</span> {
        count++;
        countSpan.<span class="hljs-property">textContent</span> = count;
      });
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>è¿è¡Œåï¼ŒåŠ¨ç”»æµç•…ã€æŒ‰é’®ç‚¹å‡»å³æ—¶å“åº”ï¼Œå› ä¸ºä¸»çº¿ç¨‹æ²¡æœ‰è¢«é•¿æ—¶é—´ä»»åŠ¡é˜»å¡ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2f70d8fac3b44cba90a7a95275883df8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGF5MQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765725433&amp;x-signature=mYajj9NyRR3dK%2FNsCzU1m%2F49j04%3D" alt="11-1.gif" loading="lazy"/></p>
<h3 data-id="heading-3">2.2 æ”¹é€ ä¸ºå¡é¡¿åœºæ™¯</h3>
<p>æˆ‘ä»¬åœ¨ç‚¹å‡»äº‹ä»¶ä¸­åŠ å…¥ä¸€ä¸ªåƒä¸‡æ¬¡å¾ªç¯çš„åŒæ­¥è®¡ç®—ä»»åŠ¡ï¼Œæ¨¡æ‹Ÿé•¿æ—¶é—´å ç”¨ä¸»çº¿ç¨‹çš„åœºæ™¯ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-CN"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>å¡é¡¿ç¤ºä¾‹<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
      <span class="hljs-selector-class">.box</span> {
        <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;
        <span class="hljs-attribute">background</span>: <span class="hljs-number">#42b983</span>;
        <span class="hljs-attribute">position</span>: relative;
        <span class="hljs-attribute">animation</span>: move <span class="hljs-number">2s</span> linear infinite alternate;
      }
      <span class="hljs-keyword">@keyframes</span> move {
        <span class="hljs-selector-tag">from</span> {
          <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
        }
        <span class="hljs-selector-tag">to</span> {
          <span class="hljs-attribute">left</span>: <span class="hljs-number">500px</span>;
        }
      }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"box"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"btn"</span>&gt;</span>ç‚¹å‡»æ‰§è¡Œé•¿ä»»åŠ¡<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è®¡æ•°ï¼š<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"count"</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
      <span class="hljs-keyword">const</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"btn"</span>);
      <span class="hljs-keyword">const</span> countSpan = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"count"</span>);
      <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;

      <span class="hljs-comment">// é•¿æ—¶é—´åŒæ­¥ä»»åŠ¡ï¼šç™¾ä¸‡æ¬¡å¾ªç¯è®¡ç®—</span>
      <span class="hljs-keyword">function</span> <span class="hljs-title function_">longTask</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">let</span> sum = <span class="hljs-number">0</span>;
        <span class="hljs-comment">// å¾ªç¯æ¬¡æ•°å¯æ ¹æ®è®¾å¤‡æ€§èƒ½è°ƒæ•´ï¼Œç¡®ä¿å¡é¡¿æ˜æ˜¾</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">30000000</span>; i++) {
          sum += i;
        }
        <span class="hljs-keyword">return</span> sum;
      }

      btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"click"</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-comment">// æ‰§è¡Œé•¿ä»»åŠ¡ï¼Œé˜»å¡ä¸»çº¿ç¨‹</span>
        <span class="hljs-title function_">longTask</span>();
        count++;
        countSpan.<span class="hljs-property">textContent</span> = count;
      });
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>ç‚¹å‡»æŒ‰é’®åï¼Œä½ ä¼šå‘ç°ï¼šåŠ¨ç”»ç¬é—´åœæ­¢ï¼ŒæŒ‰é’®ç‚¹å‡»åæ— å³æ—¶åé¦ˆï¼Œç­‰å¾…æ•°ç§’åè®¡æ•°æ‰æ›´æ–°ã€åŠ¨ç”»æ¢å¤ã€‚è¿™æ˜¯å› ä¸º longTask å ç”¨äº†ä¸»çº¿ç¨‹ï¼Œæµè§ˆå™¨æ— æ³•åŒæ—¶æ‰§è¡ŒåŠ¨ç”»æ¸²æŸ“å’Œäº‹ä»¶å“åº”ï¼Œä»è€Œå¼•å‘å¡é¡¿ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cbd73b1fa4b64aa88efe789f4c850db6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGF5MQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765725433&amp;x-signature=t42uoBtdhM6a%2FzSibaXUuFzYJqk%3D" alt="11-2.gif" loading="lazy"/></p>
<h2 data-id="heading-4">3. ç”¨ requestIdleCallback è§£å†³å¡é¡¿ï¼šåä½œå¼è°ƒåº¦çš„é›å½¢</h2>
<p>è¦è§£å†³ä¸»çº¿ç¨‹é˜»å¡é—®é¢˜ï¼Œæ ¸å¿ƒæ€è·¯æ˜¯å°†é•¿ä»»åŠ¡æ‹†åˆ†ä¸ºå¤šä¸ªçŸ­ä»»åŠ¡ï¼Œåœ¨ä¸»çº¿ç¨‹ç©ºé—²æ—¶æ‰§è¡Œï¼Œè¿™å°±æ˜¯åä½œå¼è°ƒåº¦ã€‚æµè§ˆå™¨åŸç”Ÿæä¾›çš„ requestIdleCallback æ­£æ˜¯ä¸ºè¿™ä¸€åœºæ™¯è®¾è®¡çš„ APIã€‚</p>
<h3 data-id="heading-5">3.1 è®¤è¯† requestIdleCallback</h3>
<p>requestIdleCallback æ˜¯æµè§ˆå™¨æä¾›çš„ç©ºé—²æœŸè°ƒåº¦ APIï¼Œç”¨äºåœ¨æµè§ˆå™¨çš„ç©ºé—²æ—¶é—´æ®µå†…æ‰§è¡Œä½ä¼˜å…ˆçº§ä»»åŠ¡ã€‚å…¶æ ¸å¿ƒç‰¹æ€§å¦‚ä¸‹ï¼š</p>
<ul>
<li>è¯­æ³•ï¼šconst handle = requestIdleCallback(callback[, options])</li>
<li>callbackï¼šç©ºé—²æ—¶æ‰§è¡Œçš„å›è°ƒå‡½æ•°ï¼Œæ¥æ”¶ä¸€ä¸ª IdleDeadline å¯¹è±¡ï¼ŒåŒ…å« timeRemaining() æ–¹æ³•ï¼ˆè¿”å›å½“å‰ç©ºé—²æœŸå‰©ä½™æ—¶é—´ï¼‰å’Œ didTimeout å±æ€§ï¼ˆæ˜¯å¦è¶…æ—¶ï¼‰ã€‚</li>
<li>optionsï¼šå¯é€‰é…ç½®ï¼Œä»… timeoutï¼ˆè¶…æ—¶æ—¶é—´ï¼Œè‹¥è¶…è¿‡è¯¥æ—¶é—´ä»»åŠ¡ä»æœªæ‰§è¡Œï¼Œæµè§ˆå™¨ä¼šå¼ºåˆ¶æ‰§è¡Œï¼‰ã€‚</li>
<li>æ‰§è¡Œæ—¶æœºï¼šæµè§ˆå™¨åœ¨å®Œæˆæ¯å¸§çš„æ¸²æŸ“ï¼ˆå¸ƒå±€ã€ç»˜åˆ¶ï¼‰åï¼Œè‹¥è¿˜æœ‰å‰©ä½™æ—¶é—´ï¼Œä¼šæ‰§è¡Œ requestIdleCallback çš„å›è°ƒï¼›è‹¥æ²¡æœ‰ç©ºé—²æ—¶é—´ï¼Œä¼šæ¨è¿Ÿåˆ°ä¸‹ä¸€å¸§ã€‚</li>
<li>åä½œå¼ï¼šå›è°ƒå†…å¯é€šè¿‡ timeRemaining() åˆ¤æ–­å‰©ä½™æ—¶é—´ï¼Œè‹¥æ—¶é—´ä¸è¶³åˆ™æš‚åœä»»åŠ¡ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡ç©ºé—²æœŸç»§ç»­æ‰§è¡Œã€‚</li>
</ul>
<h3 data-id="heading-6">3.2 åŸºäº requestIdleCallback æ”¹é€ å¡é¡¿ç¤ºä¾‹</h3>
<p>æˆ‘ä»¬å°†ç™¾ä¸‡æ¬¡å¾ªç¯æ‹†åˆ†ä¸ºå¤šä¸ª 30 ä¸‡æ¬¡çš„å°ä»»åŠ¡ï¼Œåˆ©ç”¨ requestIdleCallback åœ¨ä¸»çº¿ç¨‹ç©ºé—²æ—¶æ‰§è¡Œï¼Œæ‰§è¡Œå®Œä¸€ä¸ªå†è°ƒåº¦ä¸‹ä¸€ä¸ªï¼Œç›´åˆ°æ‰€æœ‰ä»»åŠ¡å®Œæˆï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-CN"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>requestIdleCallback è§£å†³å¡é¡¿<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
      <span class="hljs-selector-class">.box</span> {
        <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;
        <span class="hljs-attribute">background</span>: <span class="hljs-number">#42b983</span>;
        <span class="hljs-attribute">position</span>: relative;
        <span class="hljs-attribute">animation</span>: move <span class="hljs-number">2s</span> linear infinite alternate;
      }
      <span class="hljs-keyword">@keyframes</span> move {
        <span class="hljs-selector-tag">from</span> {
          <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
        }
        <span class="hljs-selector-tag">to</span> {
          <span class="hljs-attribute">left</span>: <span class="hljs-number">500px</span>;
        }
      }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"box"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"btn"</span>&gt;</span>ç‚¹å‡»æ‰§è¡Œæ‹†åˆ†åçš„é•¿ä»»åŠ¡<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è®¡æ•°ï¼š<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"count"</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>ä»»åŠ¡è¿›åº¦ï¼š<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"progress"</span>&gt;</span>0%<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
      <span class="hljs-keyword">const</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"btn"</span>);
      <span class="hljs-keyword">const</span> countSpan = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"count"</span>);
      <span class="hljs-keyword">const</span> progressSpan = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"progress"</span>);
      <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">let</span> total = <span class="hljs-number">30000000</span>; <span class="hljs-comment">// æ€»ä»»åŠ¡é‡</span>
      <span class="hljs-keyword">let</span> current = <span class="hljs-number">0</span>; <span class="hljs-comment">// å·²å®Œæˆä»»åŠ¡é‡</span>
      <span class="hljs-keyword">const</span> batch = <span class="hljs-number">300000</span>; <span class="hljs-comment">// æ¯æ¬¡æ‰§è¡Œçš„å°ä»»åŠ¡é‡</span>

      <span class="hljs-comment">// å•ä¸ªå°ä»»åŠ¡ï¼šæ‰§è¡Œ batch æ¬¡å¾ªç¯</span>
      <span class="hljs-keyword">function</span> <span class="hljs-title function_">doBatchTask</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">let</span> sum = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; batch; i++) {
          <span class="hljs-keyword">if</span> (current &gt;= total) <span class="hljs-keyword">break</span>;
          sum += current;
          current++;
        }
        <span class="hljs-comment">// æ›´æ–°è¿›åº¦</span>
        progressSpan.<span class="hljs-property">textContent</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.floor((current / total) * <span class="hljs-number">100</span>)}</span>%`</span>;
        <span class="hljs-comment">// ä»»åŠ¡æœªå®Œæˆåˆ™ç»§ç»­è°ƒåº¦</span>
        <span class="hljs-keyword">if</span> (current &lt; total) {
          <span class="hljs-title function_">requestIdleCallback</span>(doBatchTask);
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-comment">// æ‰€æœ‰ä»»åŠ¡å®Œæˆåæ›´æ–°è®¡æ•°</span>
          count++;
          countSpan.<span class="hljs-property">textContent</span> = count;
          current = <span class="hljs-number">0</span>; <span class="hljs-comment">// é‡ç½®è¿›åº¦</span>
          progressSpan.<span class="hljs-property">textContent</span> = <span class="hljs-string">"0%"</span>;
        }
      }

      btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"click"</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-comment">// é¦–æ¬¡è°ƒåº¦ç©ºé—²æ—¶æ‰§è¡Œä»»åŠ¡</span>
        <span class="hljs-title function_">requestIdleCallback</span>(doBatchTask);
      });
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>è¿è¡Œåç‚¹å‡»æŒ‰é’®ï¼ŒåŠ¨ç”»ä¾ç„¶æµç•…ï¼ŒæŒ‰é’®ç‚¹å‡»æ— å¡é¡¿ï¼Œè¿›åº¦æ¡é€æ­¥æ›´æ–°ï¼Œæœ€ç»ˆè®¡æ•°å®Œæˆã€‚è¿™æ˜¯å› ä¸º requestIdleCallback è®©å°ä»»åŠ¡åªåœ¨ä¸»çº¿ç¨‹ç©ºé—²æ—¶æ‰§è¡Œï¼Œä¸ä¼šé˜»å¡æ¸²æŸ“å’Œäº‹ä»¶å“åº”ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3c30d3f1130e424ba2ec2a12c4a17863~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGF5MQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765725433&amp;x-signature=pbN5VeQUnnKHfjlUsBWcoQQ9Qe0%3D" alt="11-3.gif" loading="lazy"/></p>
<h3 data-id="heading-7">3.3 requestIdleCallback çš„ä¸è¶³</h3>
<p>å°½ç®¡ requestIdleCallback å®ç°äº†ç©ºé—²è°ƒåº¦ï¼Œä½†å®ƒå­˜åœ¨å¤šä¸ªç¼ºé™·ï¼Œå¯¼è‡´æ— æ³•æ»¡è¶³ React è¿™ç±»å¤§å‹æ¡†æ¶çš„ç”Ÿäº§éœ€æ±‚ï¼š</p>
<ol>
<li>æµè§ˆå™¨å…¼å®¹æ€§å·®ï¼šIE å®Œå…¨ä¸æ”¯æŒï¼Œç§»åŠ¨ç«¯éƒ¨åˆ†æµè§ˆå™¨ï¼ˆå¦‚æ—§ç‰ˆ Safariï¼‰ä¹Ÿå­˜åœ¨å…¼å®¹é—®é¢˜ã€‚</li>
<li>æ‰§è¡Œé¢‘ç‡ä½ï¼šæµè§ˆå™¨çš„ç©ºé—²æœŸå—åˆ·æ–°ç‡å½±å“ï¼Œåœ¨ 60Hz å±å¹•ä¸‹æ¯å¸§ä»… 16.6msï¼Œè‹¥é¡µé¢ç¹å¿™ï¼ŒrequestIdleCallback å¯èƒ½æ•°ç§’æ‰æ‰§è¡Œä¸€æ¬¡ï¼Œä½ä¼˜å…ˆçº§ä»»åŠ¡ä¼šè¢«ä¸¥é‡å»¶è¿Ÿã€‚</li>
<li>å¯é æ€§é—®é¢˜ï¼šéƒ¨åˆ†æµè§ˆå™¨å¯¹ requestIdleCallback çš„æ‰§è¡Œåšäº†é™åˆ¶ï¼Œå¦‚åå°æ ‡ç­¾é¡µä¼šæš‚åœæ‰§è¡Œï¼Œå¯¼è‡´ä»»åŠ¡é•¿æ—¶é—´æŒ‚èµ·ã€‚</li>
</ol>
<h2 data-id="heading-8">4. ç”¨ MessageChannel æ¨¡æ‹Ÿ requestIdleCallbackï¼šReact çš„æ›¿ä»£æ–¹æ¡ˆ</h2>
<p>MessageChannel æ˜¯æµè§ˆå™¨æä¾›çš„è·¨çº¿ç¨‹é€šä¿¡ APIï¼Œå…¶æ¶ˆæ¯å›è°ƒå±äºå®ä»»åŠ¡ï¼›åœ¨å¤šæ•°ç°ä»£æµè§ˆå™¨ä¸­ï¼Œå®ƒé€šå¸¸åœ¨ä¸Šä¸€å¸§æ¸²æŸ“å®Œæˆåçš„ä¸‹ä¸€è½®äº‹ä»¶å¾ªç¯å®ä»»åŠ¡é˜¶æ®µè§¦å‘ï¼Œå®è·µä¸Šæ¯” <code>setTimeout</code> æ›´åŠæ—¶ï¼ˆéæ ‡å‡†ä¿è¯ï¼‰ã€‚React åˆ©ç”¨è¿™ä¸€ç‰¹æ€§ï¼Œé…åˆæ—¶é—´åˆ†ç‰‡ï¼Œæ„å»ºæ›´ç¨³å®šçš„â€œå¸§åè°ƒåº¦â€ï¼Œè€Œéä¾èµ–æµè§ˆå™¨çš„â€œç©ºé—²æœŸâ€åˆ¤å®šã€‚</p>
<h3 data-id="heading-9">4.1 ä¸ºä»€ä¹ˆé€‰æ‹© MessageChannelï¼Ÿ</h3>
<p>requestIdleCallback çš„å›è°ƒä¾èµ–æµè§ˆå™¨çš„â€œç©ºé—²æœŸâ€åˆ¤å®šï¼ˆä»…å½“æ¸²æŸ“åä»æœ‰å‰©ä½™æ—¶é—´æ‰æ‰§è¡Œï¼‰ï¼Œåœ¨é¡µé¢ç¹å¿™æ—¶å¯èƒ½æ•°å¸§æ‰è§¦å‘ä¸€æ¬¡ï¼›è€Œ MessageChannel ä½œä¸ºå®ä»»åŠ¡ä¼šåœ¨ä¸‹ä¸€è½®äº‹ä»¶å¾ªç¯çš„å®ä»»åŠ¡é˜¶æ®µæ‰§è¡Œï¼Œä¸ä¾èµ–ç©ºé—²æœŸä¿¡å·ã€‚</p>
<p>è¦è®© MessageChannel æ›´è´´è¿‘â€œå¸§åæ‰§è¡Œâ€ï¼Œå…³é”®æ˜¯ç†è§£äº‹ä»¶å¾ªç¯ä¸æ¸²æŸ“çš„æ—¶åºï¼šæµè§ˆå™¨é€šå¸¸ä¼šåœ¨å®ä»»åŠ¡ä¸å®ä»»åŠ¡ä¹‹é—´å®‰æ’æ¸²æŸ“ã€‚MessageChannel çš„å›è°ƒå±äºä¸‹ä¸€è½®å®ä»»åŠ¡ï¼Œå› æ­¤å¾€å¾€è½åœ¨ä¸Šä¸€å¸§æ¸²æŸ“ä¹‹åã€‚</p>
<h4 data-id="heading-10">4.1.1 å…ˆæ˜ç¡®ï¼šæµè§ˆå™¨çš„å¸§æ¸²æŸ“ä¸äº‹ä»¶å¾ªç¯çš„æ‰§è¡Œé¡ºåº</h4>
<p>æµè§ˆå™¨çš„æ ¸å¿ƒå·¥ä½œæ˜¯æŒ‰å›ºå®šå¸§ç‡ï¼ˆé€šå¸¸ 60Hzï¼Œæ¯å¸§ â‰ˆ16.6msï¼‰å®Œæˆæ¸²æŸ“ï¼Œå¹¶åœ¨æ¸²æŸ“é—´éš™æ‰§è¡Œ JS ä»»åŠ¡ã€‚ä¸€ä¸ªå®Œæ•´çš„äº‹ä»¶å¾ªç¯è¿­ä»£ï¼ˆevent loop tickï¼‰ä¸­ï¼Œæ¸²æŸ“æµç¨‹ä¸å®ä»»åŠ¡ / å¾®ä»»åŠ¡çš„æ‰§è¡Œéµå¾ªä¸¥æ ¼çš„é¡ºåºï¼Œç®€åŒ–åçš„æ ¸å¿ƒæµç¨‹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-text" lang="text">1. æ‰§è¡Œå½“å‰å®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä¸€ä¸ªå®ä»»åŠ¡ï¼ˆå¦‚åŒæ­¥JSã€setTimeoutå›è°ƒï¼‰
2. æ‰§è¡Œæ‰€æœ‰å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„å¾®ä»»åŠ¡ï¼ˆPromise.thenã€MutationObserverç­‰ï¼‰
3. æ‰§è¡Œ**æ¸²æŸ“æµç¨‹**ï¼ˆè®¡ç®—æ ·å¼â†’å¸ƒå±€â†’ç»˜åˆ¶ï¼Œå®Œæˆä¸€å¸§çš„æ¸²æŸ“ï¼‰
4. æ£€æŸ¥æ˜¯å¦æœ‰æ–°çš„å®ä»»åŠ¡ï¼Œè‹¥æœ‰åˆ™å›åˆ°æ­¥éª¤1ï¼Œå¼€å¯ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯è¿­ä»£
</code></pre>
<p>å…³é”®ç»“è®ºï¼šæ¸²æŸ“æµç¨‹æ‰§è¡Œå®Œæ¯•åï¼Œä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯è¿­ä»£ä¼šä¼˜å…ˆæ‰§è¡Œæ–°çš„å®ä»»åŠ¡ã€‚è€Œ MessageChannel çš„æ¶ˆæ¯å›è°ƒæ­£å±äºè¿™ç±»æ–°çš„å®ä»»åŠ¡ï¼Œå› æ­¤å…¶æ‰§è¡Œæ—¶æœºå¤©ç„¶è½åœ¨ä¸Šä¸€å¸§æ¸²æŸ“å®Œæˆåã€‚</p>
<h4 data-id="heading-11">4.1.2 MessageChannel çš„å®ä»»åŠ¡ç‰¹æ€§ï¼šæ›´è´´è¿‘â€œå¸§åâ€çš„è§¦å‘</h4>
<p>MessageChannel æ˜¯æµè§ˆå™¨æä¾›çš„è·¨ç«¯å£é€šä¿¡ APIï¼Œå…¶ <code>port.onmessage</code> å›è°ƒå±äºå®ä»»åŠ¡ï¼›ä¸ <code>setTimeout</code>/<code>setInterval</code> ç›¸æ¯”ï¼Œæœ‰ä¸¤ç‚¹æ›´åˆ©äºå¸§åè§¦å‘ï¼š</p>
<ol>
<li>æ— æœ€å°å»¶è¿Ÿï¼ˆå³æ—¶å…¥é˜Ÿï¼‰
<code>setTimeout(callback, 0)</code> åœ¨å¤šæ•°ç¯å¢ƒå­˜åœ¨ â‰¥4ms çš„æœ€å°å»¶è¿Ÿå¤¹ç´§ï¼›<code>MessageChannel</code> çš„ <code>postMessage()</code> ä¼šç«‹å³æŠŠå›è°ƒåŠ å…¥å®ä»»åŠ¡é˜Ÿåˆ—ï¼Œæ— é¢å¤–å»¶è¿Ÿï¼Œæ›´å®¹æ˜“ç´§è´´æ¸²æŸ“åè§¦å‘ã€‚</li>
<li>å®è·µä¸­çš„è§¦å‘æ›´é å‰ï¼ˆéæ ‡å‡†ä¿è¯ï¼‰
åœ¨å¤šæ•°ç°ä»£æµè§ˆå™¨å®ç°é‡Œï¼Œ<code>MessageChannel</code> çš„å®ä»»åŠ¡è§¦å‘æ—¶æœºé€šå¸¸æ—©äº <code>setTimeout</code>ï¼›ä½†æ ‡å‡†æœªè§„å®šå›ºå®šä¼˜å…ˆçº§ï¼Œå®é™…é¡ºåºå¯èƒ½éšæµè§ˆå™¨ä¸åœºæ™¯å˜åŒ–ã€‚å·¥ç¨‹ä¸Šä¸åº”ä¾èµ–â€œå›ºå®šä¼˜å…ˆçº§â€ï¼Œè€Œåº”é‡‡ç”¨ rAF + MessageChannel çš„ç»„åˆæ¥è·å¾—ç¨³å®šçš„å¸§åè°ƒåº¦ã€‚</li>
</ol>
<h3 data-id="heading-12">4.2 åŸºäº MessageChannel æ”¹é€ å¡é¡¿ç¤ºä¾‹</h3>
<p>æˆ‘ä»¬æ¨¡ä»¿ React çš„æ€è·¯ï¼Œç”¨ MessageChannel å®ç°ä¸€ä¸ªç®€æ˜“çš„ â€œç©ºé—²è°ƒåº¦å™¨â€ï¼Œæ›¿ä»£ requestIdleCallback è§£å†³å¡é¡¿é—®é¢˜ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-CN"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>MessageChannel æ¨¡æ‹Ÿç©ºé—²è°ƒåº¦<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
      <span class="hljs-selector-class">.box</span> {
        <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;
        <span class="hljs-attribute">background</span>: <span class="hljs-number">#42b983</span>;
        <span class="hljs-attribute">position</span>: relative;
        <span class="hljs-attribute">animation</span>: move <span class="hljs-number">2s</span> linear infinite alternate;
      }

      <span class="hljs-keyword">@keyframes</span> move {
        <span class="hljs-selector-tag">from</span> {
          <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
        }

        <span class="hljs-selector-tag">to</span> {
          <span class="hljs-attribute">left</span>: <span class="hljs-number">500px</span>;
        }
      }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"box"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"btn"</span>&gt;</span>ç‚¹å‡»æ‰§è¡Œæ‹†åˆ†åçš„é•¿ä»»åŠ¡<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è®¡æ•°ï¼š<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"count"</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>ä»»åŠ¡è¿›åº¦ï¼š<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"progress"</span>&gt;</span>0%<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
      <span class="hljs-keyword">const</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"btn"</span>);
      <span class="hljs-keyword">const</span> countSpan = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"count"</span>);
      <span class="hljs-keyword">const</span> progressSpan = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"progress"</span>);
      <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">let</span> total = <span class="hljs-number">30000000</span>;
      <span class="hljs-keyword">let</span> current = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">const</span> batch = <span class="hljs-number">300000</span>;

      <span class="hljs-comment">// 1. åˆ›å»º MessageChannel å®ä¾‹</span>
      <span class="hljs-keyword">const</span> channel = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MessageChannel</span>();
      <span class="hljs-keyword">const</span> port1 = channel.<span class="hljs-property">port1</span>;
      <span class="hljs-keyword">const</span> port2 = channel.<span class="hljs-property">port2</span>;

      <span class="hljs-comment">// 2. å®šä¹‰è°ƒåº¦å™¨ï¼šé€šè¿‡ postMessage è§¦å‘ä»»åŠ¡æ‰§è¡Œ</span>
      <span class="hljs-keyword">let</span> scheduledTask = <span class="hljs-literal">null</span>;
      <span class="hljs-keyword">function</span> <span class="hljs-title function_">scheduleIdleCallback</span>(<span class="hljs-params">callback</span>) {
        scheduledTask = callback;
        <span class="hljs-comment">// å‘é€æ¶ˆæ¯è§¦å‘å®ä»»åŠ¡</span>
        port2.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">"execute"</span>);
      }

      <span class="hljs-comment">// 3. ç›‘å¬æ¶ˆæ¯ï¼Œæ‰§è¡Œä»»åŠ¡ï¼ˆæ¨¡æ‹Ÿç©ºé—²æœŸï¼‰</span>
      port1.<span class="hljs-property">onmessage</span> = <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-keyword">const</span> task = scheduledTask;
        scheduledTask = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">if</span> (task) {
          <span class="hljs-title function_">task</span>();
        }
      };

      <span class="hljs-comment">// å•ä¸ªå°ä»»åŠ¡é€»è¾‘</span>
      <span class="hljs-keyword">function</span> <span class="hljs-title function_">doBatchTask</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">let</span> sum = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; batch; i++) {
          <span class="hljs-keyword">if</span> (current &gt;= total) <span class="hljs-keyword">break</span>;
          sum += current;
          current++;
        }
        progressSpan.<span class="hljs-property">textContent</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.floor((current / total) * <span class="hljs-number">100</span>)}</span>%`</span>;
        <span class="hljs-keyword">if</span> (current &lt; total) {
          <span class="hljs-comment">// ç”¨è‡ªå®šä¹‰è°ƒåº¦å™¨æ›¿ä»£ requestIdleCallback</span>
          <span class="hljs-title function_">scheduleIdleCallback</span>(doBatchTask);
        } <span class="hljs-keyword">else</span> {
          count++;
          countSpan.<span class="hljs-property">textContent</span> = count;
          current = <span class="hljs-number">0</span>;
          progressSpan.<span class="hljs-property">textContent</span> = <span class="hljs-string">"0%"</span>;
        }
      }

      btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"click"</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-title function_">scheduleIdleCallback</span>(doBatchTask);
      });
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>è¿è¡Œåæ•ˆæœä¸ requestIdleCallback ç‰ˆæœ¬ä¸€è‡´ï¼ŒåŠ¨ç”»æµç•…ã€ä»»åŠ¡é€æ­¥æ‰§è¡Œã€‚è¿™ä¸ªç®€æ˜“è°ƒåº¦å™¨çš„æ ¸å¿ƒæ˜¯ï¼šé€šè¿‡ MessageChannel çš„æ¶ˆæ¯ä¼ é€’è§¦å‘å®ä»»åŠ¡ï¼Œè®©å°ä»»åŠ¡åœ¨æ¯å¸§æ¸²æŸ“åæ‰§è¡Œï¼Œæ¨¡æ‹Ÿå‡º â€œç©ºé—²æœŸâ€ çš„æ•ˆæœã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e6014ac37c484caf9340f67a1b828ada~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGF5MQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765725433&amp;x-signature=yLdRh65zJQiDp9YXq3ne568xVro%3D" alt="11-4.gif" loading="lazy"/></p>
<h2 data-id="heading-13">5. React æºç ä¸­çš„ MessageChannel è°ƒåº¦å®ç°</h2>
<p>React çš„ Scheduler æ¨¡å—æ˜¯å…¶åä½œå¼è°ƒåº¦çš„æ ¸å¿ƒï¼Œå…¶ä¸­åŸºäº MessageChannel çš„è°ƒåº¦æ˜¯å…³é”®ç¯èŠ‚ã€‚æˆ‘ä»¬ä»æ ¸å¿ƒåŸç†å’Œæºç å…³é”®é€»è¾‘ä¸¤æ–¹é¢æ‹†è§£å…¶å®ç°ã€‚</p>
<h3 data-id="heading-14">5.1 æ ¸å¿ƒåŸç†</h3>
<ol>
<li>æ—¶é—´åˆ†ç‰‡ï¼ˆTime Slicingï¼‰ï¼šä¸ºæ¯è½®ä»»åŠ¡æ‰§è¡Œè®¾ç½®å›ºå®šçš„æ—¶é—´é¢„ç®—ï¼ˆframeIntervalï¼Œé»˜è®¤çº¦ 5msï¼‰ï¼Œè‹¥ä»»åŠ¡æ‰§è¡Œæ—¶é—´è¶…è¿‡è¯¥é¢„ç®—ï¼Œç«‹å³æš‚åœä»»åŠ¡å¹¶è®©å‡ºä¸»çº¿ç¨‹ï¼Œé¿å…é˜»å¡æ¸²æŸ“å’Œç”¨æˆ·äº¤äº’ã€‚</li>
<li>æ¶ˆæ¯å¾ªç¯é©±åŠ¨ï¼šä¼˜å…ˆä½¿ç”¨ MessageChannel è§¦å‘å®ä»»åŠ¡ï¼ˆé™çº§æ–¹æ¡ˆä¸º setImmediate/setTimeoutï¼‰ï¼Œé€šè¿‡ â€œå‘é€æ¶ˆæ¯ â†’ æ‰§è¡Œä»»åŠ¡ â†’ å†æ¬¡å‘é€æ¶ˆæ¯â€ çš„å¾ªç¯ï¼ŒæŒç»­æ¨è¿›ä»»åŠ¡é˜Ÿåˆ—çš„æ‰§è¡Œï¼Œæ¨¡æ‹Ÿæµè§ˆå™¨çš„ç©ºé—²æœŸè°ƒåº¦ã€‚</li>
<li>åŒé˜Ÿåˆ—ç®¡ç†ï¼šç»´æŠ¤ timerQueueï¼ˆå»¶æ—¶ä»»åŠ¡é˜Ÿåˆ—ï¼‰å’Œ taskQueueï¼ˆç«‹å³æ‰§è¡Œä»»åŠ¡é˜Ÿåˆ—ï¼‰ï¼Œå»¶æ—¶ä»»åŠ¡åˆ°æœŸåä» timerQueue è½¬å…¥ taskQueueï¼Œç¡®ä¿ä»»åŠ¡æŒ‰ â€œå»¶æ—¶ä¼˜å…ˆçº§ + è¿‡æœŸä¼˜å…ˆçº§â€ æœ‰åºæ‰§è¡Œã€‚</li>
<li>ç»­çº¦å›è°ƒæœºåˆ¶ï¼šä»»åŠ¡å›è°ƒæ‰§è¡Œåå¯è¿”å›ä¸€ä¸ªæ–°çš„å›è°ƒå‡½æ•°ï¼ˆâ€œç»­çº¦å›è°ƒâ€ï¼‰ï¼Œè°ƒåº¦å™¨ä¼šåœ¨ä¸‹ä¸€è½®æ¶ˆæ¯å¾ªç¯ä¸­ç»§ç»­æ‰§è¡Œè¯¥å›è°ƒï¼Œå®ç°ä»»åŠ¡çš„åˆ†æ®µæ‰§è¡Œã€‚</li>
<li>ä¸»åŠ¨è®©å‡ºåˆ¤æ–­ï¼šé€šè¿‡ shouldYieldToHost å‡½æ•°åˆ¤æ–­æ˜¯å¦éœ€è¦è®©å‡ºä¸»çº¿ç¨‹ï¼Œåˆ¤æ–­ä¾æ®åŒ…æ‹¬å·²æ‰§è¡Œæ—¶é—´æ˜¯å¦è¶…è¿‡æ—¶é—´é¢„ç®—ã€æµè§ˆå™¨æ˜¯å¦éœ€è¦é‡ç»˜ï¼Œå…¼é¡¾ä»»åŠ¡æ‰§è¡Œæ•ˆç‡å’Œé¡µé¢æµç•…åº¦ã€‚</li>
</ol>
<h3 data-id="heading-15">5.2 å…³é”®é€»è¾‘</h3>
<p>React Scheduler çš„æ ¸å¿ƒæ‰§è¡Œæµç¨‹å¯æ‹†è§£ä¸ºè°ƒåº¦å™¨åˆå§‹åŒ–ã€æ¶ˆæ¯å¾ªç¯å¯åŠ¨ã€ä»»åŠ¡æ‰§è¡Œä¸è®©å‡ºã€åŒé˜Ÿåˆ—æµè½¬ï¼Œæ¯ä¸ªæ­¥éª¤å¯¹åº”æºç ä¸­çš„æ ¸å¿ƒå‡½æ•°ï¼Œä»¥ä¸‹æ˜¯è¯¦ç»†è§£æï¼š</p>
<h4 data-id="heading-16">5.2.1 è°ƒåº¦å™¨åˆå§‹åŒ–ï¼šé€‰æ‹©å¼‚æ­¥è§¦å‘æ–¹æ¡ˆ</h4>
<p>è°ƒåº¦å™¨ä¼˜å…ˆä½¿ç”¨ MessageChannel å®ç°é«˜é¢‘ç‡çš„å®ä»»åŠ¡è§¦å‘ï¼ˆæ‰§è¡Œæ—¶æœºæ—©äº setTimeoutï¼‰ï¼Œè‹¥ç¯å¢ƒä¸æ”¯æŒåˆ™é™çº§ä¸º setImmediate æˆ– setTimeoutï¼Œæœ€ç»ˆå°è£…å‡º schedulePerformWorkUntilDeadline å‡½æ•°ï¼Œä½œä¸ºæ¶ˆæ¯å¾ªç¯çš„è§¦å‘å…¥å£ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> schedulePerformWorkUntilDeadline;

<span class="hljs-comment">// ä¼˜å…ˆçº§ï¼šsetImmediate &gt; MessageChannel &gt; setTimeout</span>
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> localSetImmediate === <span class="hljs-string">"function"</span>) {
  <span class="hljs-comment">// éæµè§ˆå™¨ç¯å¢ƒï¼ˆå¦‚Node.jsï¼‰ä¼˜å…ˆä½¿ç”¨setImmediate</span>
  schedulePerformWorkUntilDeadline = <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">localSetImmediate</span>(performWorkUntilDeadline);
  };
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">MessageChannel</span> !== <span class="hljs-string">"undefined"</span>) {
  <span class="hljs-comment">// æµè§ˆå™¨ç¯å¢ƒæ ¸å¿ƒæ–¹æ¡ˆï¼šMessageChannel</span>
  <span class="hljs-keyword">const</span> channel = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MessageChannel</span>();
  <span class="hljs-keyword">const</span> port = channel.<span class="hljs-property">port2</span>;
  <span class="hljs-comment">// ç›‘å¬æ¶ˆæ¯ï¼Œè§¦å‘ä»»åŠ¡æ‰§è¡Œ</span>
  channel.<span class="hljs-property">port1</span>.<span class="hljs-property">onmessage</span> = performWorkUntilDeadline;
  schedulePerformWorkUntilDeadline = <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// å‘é€ç©ºæ¶ˆæ¯ï¼Œè§¦å‘å®ä»»åŠ¡</span>
    port.<span class="hljs-title function_">postMessage</span>(<span class="hljs-literal">null</span>);
  };
} <span class="hljs-keyword">else</span> {
  <span class="hljs-comment">// å…œåº•æ–¹æ¡ˆï¼šsetTimeoutï¼ˆå»¶è¿Ÿæ›´é«˜ï¼Œä»…ç”¨äºå…¼å®¹æ—§ç¯å¢ƒï¼‰</span>
  schedulePerformWorkUntilDeadline = <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">localSetTimeout</span>(performWorkUntilDeadline, <span class="hljs-number">0</span>);
  };
}
</code></pre>
<h4 data-id="heading-17">5.2.2 ä»»åŠ¡è°ƒåº¦ï¼šunstable_scheduleCallback å…¥é˜Ÿé€»è¾‘</h4>
<p>unstable_scheduleCallback æ˜¯è°ƒåº¦ä»»åŠ¡çš„å…¥å£å‡½æ•°ï¼Œè´Ÿè´£æ ¹æ®ä»»åŠ¡çš„ä¼˜å…ˆçº§å’Œå»¶æ—¶é…ç½®ï¼Œè®¡ç®—ä»»åŠ¡çš„ startTimeï¼ˆå¼€å§‹æ—¶é—´ï¼‰å’Œ expirationTimeï¼ˆè¿‡æœŸæ—¶é—´ï¼‰ï¼Œå¹¶å°†ä»»åŠ¡åŠ å…¥ timerQueueï¼ˆå»¶æ—¶ä»»åŠ¡ï¼‰æˆ– taskQueueï¼ˆç«‹å³ä»»åŠ¡ï¼‰ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * è°ƒåº¦ä»»åŠ¡çš„å…¥å£å‡½æ•°
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">priorityLevel</span> - ä»»åŠ¡ä¼˜å…ˆçº§
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} <span class="hljs-variable">callback</span> - ä»»åŠ¡å›è°ƒ
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} [options] - é…ç½®é¡¹ï¼ˆå«delayå»¶æ—¶ï¼‰
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Object</span>} ä»»åŠ¡å®ä¾‹
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">unstable_scheduleCallback</span>(<span class="hljs-params">priorityLevel, callback, options</span>) {
  <span class="hljs-keyword">const</span> currentTime = <span class="hljs-title function_">getCurrentTime</span>();
  <span class="hljs-keyword">let</span> startTime;

  <span class="hljs-comment">// è®¡ç®—ä»»åŠ¡çš„å¼€å§‹æ—¶é—´ï¼ˆæ”¯æŒå»¶æ—¶æ‰§è¡Œï¼‰</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> options === <span class="hljs-string">"object"</span> &amp;&amp; options !== <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">const</span> delay = options.<span class="hljs-property">delay</span>;
    startTime =
      <span class="hljs-keyword">typeof</span> delay === <span class="hljs-string">"number"</span> &amp;&amp; delay &gt; <span class="hljs-number">0</span>
        ? currentTime + delay
        : currentTime;
  } <span class="hljs-keyword">else</span> {
    startTime = currentTime;
  }

  <span class="hljs-comment">// æ ¹æ®ä¼˜å…ˆçº§è®¡ç®—è¶…æ—¶æ—¶é—´ï¼ˆè¿‡æœŸæ—¶é—´ = å¼€å§‹æ—¶é—´ + è¶…æ—¶æ—¶é—´ï¼‰</span>
  <span class="hljs-keyword">let</span> timeout;
  <span class="hljs-keyword">switch</span> (priorityLevel) {
    <span class="hljs-keyword">case</span> <span class="hljs-title class_">ImmediatePriority</span>:
      timeout = -<span class="hljs-number">1</span>;
      <span class="hljs-keyword">break</span>; <span class="hljs-comment">// ç«‹å³æ‰§è¡Œ</span>
    <span class="hljs-keyword">case</span> <span class="hljs-title class_">UserBlockingPriority</span>:
      timeout = userBlockingPriorityTimeout;
      <span class="hljs-keyword">break</span>; <span class="hljs-comment">// ç”¨æˆ·é˜»å¡çº§ï¼ˆå¦‚ç‚¹å‡»ï¼‰</span>
    <span class="hljs-keyword">case</span> <span class="hljs-title class_">IdlePriority</span>:
      timeout = maxSigned31BitInt;
      <span class="hljs-keyword">break</span>; <span class="hljs-comment">// ç©ºé—²çº§ï¼ˆæœ€ä½ä¼˜å…ˆçº§ï¼‰</span>
    <span class="hljs-keyword">case</span> <span class="hljs-title class_">LowPriority</span>:
      timeout = lowPriorityTimeout;
      <span class="hljs-keyword">break</span>; <span class="hljs-comment">// ä½ä¼˜å…ˆçº§</span>
    <span class="hljs-keyword">case</span> <span class="hljs-title class_">NormalPriority</span>:
    <span class="hljs-attr">default</span>:
      timeout = normalPriorityTimeout;
      <span class="hljs-keyword">break</span>; <span class="hljs-comment">// æ™®é€šä¼˜å…ˆçº§</span>
  }
  <span class="hljs-keyword">const</span> expirationTime = startTime + timeout;

  <span class="hljs-comment">// åˆ›å»ºä»»åŠ¡å®ä¾‹</span>
  <span class="hljs-keyword">const</span> newTask = {
    <span class="hljs-attr">id</span>: taskIdCounter++,
    callback,
    priorityLevel,
    startTime,
    expirationTime,
    <span class="hljs-attr">sortIndex</span>: -<span class="hljs-number">1</span>,
  };

  <span class="hljs-comment">// å»¶æ—¶ä»»åŠ¡ï¼šåŠ å…¥timerQueue</span>
  <span class="hljs-keyword">if</span> (startTime &gt; currentTime) {
    newTask.<span class="hljs-property">sortIndex</span> = startTime;
    <span class="hljs-title function_">push</span>(timerQueue, newTask);
    <span class="hljs-comment">// è‹¥å½“å‰æ— ç«‹å³ä»»åŠ¡ä¸”è¯¥ä»»åŠ¡æ˜¯timerQueueé¡¶éƒ¨ï¼Œè®¾ç½®å®šæ—¶å™¨</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">peek</span>(taskQueue) === <span class="hljs-literal">null</span> &amp;&amp; newTask === <span class="hljs-title function_">peek</span>(timerQueue)) {
      <span class="hljs-keyword">if</span> (isHostTimeoutScheduled) <span class="hljs-title function_">cancelHostTimeout</span>();
      <span class="hljs-keyword">else</span> isHostTimeoutScheduled = <span class="hljs-literal">true</span>;
      <span class="hljs-title function_">requestHostTimeout</span>(handleTimeout, startTime - currentTime);
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// ç«‹å³ä»»åŠ¡ï¼šåŠ å…¥taskQueueå¹¶å¯åŠ¨æ¶ˆæ¯å¾ªç¯</span>
    newTask.<span class="hljs-property">sortIndex</span> = expirationTime;
    <span class="hljs-title function_">push</span>(taskQueue, newTask);
    <span class="hljs-keyword">if</span> (!isHostCallbackScheduled &amp;&amp; !isPerformingWork) {
      isHostCallbackScheduled = <span class="hljs-literal">true</span>;
      <span class="hljs-title function_">requestHostCallback</span>();
    }
  }

  <span class="hljs-keyword">return</span> newTask;
}
</code></pre>
<h4 data-id="heading-18">5.2.3 å¯åŠ¨æ¶ˆæ¯å¾ªç¯ï¼šè§¦å‘é¦–æ¬¡ä»»åŠ¡æ‰§è¡Œ</h4>
<p>é€šè¿‡ requestHostCallback å‡½æ•°æ ‡è®°æ¶ˆæ¯å¾ªç¯ä¸ºè¿è¡Œæ€ï¼ˆisMessageLoopRunning = trueï¼‰ï¼Œå¹¶è°ƒç”¨ schedulePerformWorkUntilDeadline è§¦å‘é¦–æ¬¡å®ä»»åŠ¡ï¼Œå¯åŠ¨æ•´ä¸ªæ¶ˆæ¯å¾ªç¯ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * å¯åŠ¨æ¶ˆæ¯å¾ªç¯ï¼Œè§¦å‘é¦–æ¬¡ä»»åŠ¡æ‰§è¡Œ
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">requestHostCallback</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">if</span> (!isMessageLoopRunning) {
    isMessageLoopRunning = <span class="hljs-literal">true</span>;
    <span class="hljs-title function_">schedulePerformWorkUntilDeadline</span>();
  }
}

<span class="hljs-comment">// æ¯å¸§çš„æ—¶é—´é¢„ç®—ï¼ˆæ—¶é—´åˆ†ç‰‡çš„æ ¸å¿ƒé˜ˆå€¼ï¼‰</span>
<span class="hljs-keyword">let</span> frameInterval = frameYieldMs; <span class="hljs-comment">// 5</span>
<span class="hljs-comment">// è®°å½•æ¯è½®ä»»åŠ¡æ‰§è¡Œçš„å¼€å§‹æ—¶é—´</span>
<span class="hljs-keyword">let</span> startTime = -<span class="hljs-number">1</span>;

<span class="hljs-comment">/**
 * åˆ¤æ–­æ˜¯å¦éœ€è¦è®©å‡ºä¸»çº¿ç¨‹
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">boolean</span>} è‹¥ä¸ºtrueåˆ™æš‚åœä»»åŠ¡ï¼Œè®©å‡ºä¸»çº¿ç¨‹
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">shouldYieldToHost</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// è‹¥æµè§ˆå™¨éœ€è¦é‡ç»˜ï¼Œç›´æ¥è®©å‡º</span>
  <span class="hljs-keyword">if</span> (!enableAlwaysYieldScheduler &amp;&amp; enableRequestPaint &amp;&amp; needsPaint) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }
  <span class="hljs-comment">// è®¡ç®—å·²æ‰§è¡Œæ—¶é—´ï¼Œè¶…è¿‡é¢„ç®—åˆ™è®©å‡º</span>
  <span class="hljs-keyword">const</span> timeElapsed = <span class="hljs-title function_">getCurrentTime</span>() - startTime;
  <span class="hljs-keyword">return</span> timeElapsed &gt;= frameInterval;
}

<span class="hljs-comment">/**
 * æ¶ˆæ¯å¾ªç¯çš„æ ¸å¿ƒæ‰§è¡Œå‡½æ•°ï¼šç”±MessageChannelçš„onmessageè§¦å‘
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">performWorkUntilDeadline</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">if</span> (enableRequestPaint) {
    needsPaint = <span class="hljs-literal">false</span>; <span class="hljs-comment">// é‡ç½®é‡ç»˜æ ‡è®°</span>
  }
  <span class="hljs-keyword">if</span> (isMessageLoopRunning) {
    <span class="hljs-keyword">const</span> currentTime = <span class="hljs-title function_">getCurrentTime</span>();
    startTime = currentTime; <span class="hljs-comment">// åˆå§‹åŒ–æœ¬è½®æ‰§è¡Œçš„å¼€å§‹æ—¶é—´</span>
    <span class="hljs-keyword">let</span> hasMoreWork = <span class="hljs-literal">true</span>;

    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// æ‰§è¡Œä»»åŠ¡é˜Ÿåˆ—å¹¶è¿”å›æ˜¯å¦è¿˜æœ‰å‰©ä½™ä»»åŠ¡,flushWorkå›å»è°ƒç”¨workLoop</span>
      hasMoreWork = <span class="hljs-title function_">flushWork</span>(currentTime);
    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-keyword">if</span> (hasMoreWork) {
        <span class="hljs-comment">// è¿˜æœ‰å‰©ä½™ä»»åŠ¡ï¼Œç»§ç»­å‘é€æ¶ˆæ¯è§¦å‘ä¸‹ä¸€è½®æ‰§è¡Œ</span>
        <span class="hljs-title function_">schedulePerformWorkUntilDeadline</span>();
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// æ— å‰©ä½™ä»»åŠ¡ï¼Œç»ˆæ­¢æ¶ˆæ¯å¾ªç¯</span>
        isMessageLoopRunning = <span class="hljs-literal">false</span>;
      }
    }
  }
};
</code></pre>
<h4 data-id="heading-19">5.2.4 ä»»åŠ¡æ‰§è¡Œä¸è®©å‡ºï¼šworkLoop ä¸»å¾ªç¯</h4>
<p>workLoop æ˜¯ä»»åŠ¡æ‰§è¡Œçš„æ ¸å¿ƒå‡½æ•°ï¼Œè´Ÿè´£ä» taskQueue ä¸­å–å‡ºæœ€é«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡æ‰§è¡Œï¼Œå¹¶æ ¹æ® shouldYieldToHost åˆ¤æ–­æ˜¯å¦éœ€è¦è®©å‡ºä¸»çº¿ç¨‹ã€‚è‹¥ä»»åŠ¡å›è°ƒè¿”å› â€œç»­çº¦å›è°ƒâ€ï¼Œåˆ™ä¿ç•™ä»»åŠ¡å¹¶åœ¨ä¸‹ä¸€è½®æ‰§è¡Œï¼›è‹¥æ‰§è¡Œå®Œæˆåˆ™å°†ä»»åŠ¡å‡ºé˜Ÿã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * ä»»åŠ¡æ‰§è¡Œä¸»å¾ªç¯
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">initialTime</span> - æœ¬è½®æ‰§è¡Œçš„å¼€å§‹æ—¶é—´
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">boolean</span>} æ˜¯å¦è¿˜æœ‰å‰©ä½™ä»»åŠ¡
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">workLoop</span>(<span class="hljs-params">initialTime</span>) {
  <span class="hljs-keyword">let</span> currentTime = initialTime;
  <span class="hljs-comment">// å°†åˆ°æœŸçš„å»¶æ—¶ä»»åŠ¡ä»timerQueueè½¬å…¥taskQueue</span>
  <span class="hljs-title function_">advanceTimers</span>(currentTime);
  <span class="hljs-comment">// å–å‡ºtaskQueueé¡¶éƒ¨çš„æœ€é«˜ä¼˜å…ˆçº§ä»»åŠ¡</span>
  currentTask = <span class="hljs-title function_">peek</span>(taskQueue);

  <span class="hljs-keyword">while</span> (currentTask !== <span class="hljs-literal">null</span>) {
    <span class="hljs-comment">// éå¼ºåˆ¶è®©å‡ºæ¨¡å¼ä¸‹ï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦è®©å‡ºä¸»çº¿ç¨‹</span>
    <span class="hljs-keyword">if</span> (!enableAlwaysYieldScheduler) {
      <span class="hljs-keyword">if</span> (currentTask.<span class="hljs-property">expirationTime</span> &gt; currentTime &amp;&amp; <span class="hljs-title function_">shouldYieldToHost</span>()) {
        <span class="hljs-keyword">break</span>; <span class="hljs-comment">// è®©å‡ºä¸»çº¿ç¨‹ï¼Œæš‚åœä»»åŠ¡æ‰§è¡Œ</span>
      }
    }

    <span class="hljs-keyword">const</span> callback = currentTask.<span class="hljs-property">callback</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> callback === <span class="hljs-string">"function"</span>) {
      currentTask.<span class="hljs-property">callback</span> = <span class="hljs-literal">null</span>; <span class="hljs-comment">// æ¸…ç©ºå›è°ƒï¼Œé¿å…é‡å¤æ‰§è¡Œ</span>
      currentPriorityLevel = currentTask.<span class="hljs-property">priorityLevel</span>;
      <span class="hljs-comment">// åˆ¤æ–­ä»»åŠ¡æ˜¯å¦è¶…æ—¶ï¼ˆè¿‡æœŸæ—¶é—´ &lt;= å½“å‰æ—¶é—´ï¼‰</span>
      <span class="hljs-keyword">const</span> didUserCallbackTimeout = currentTask.<span class="hljs-property">expirationTime</span> &lt;= currentTime;
      <span class="hljs-comment">// æ‰§è¡Œä»»åŠ¡å›è°ƒï¼Œè·å–ç»­çº¦å›è°ƒï¼ˆè‹¥æœ‰ï¼‰</span>
      <span class="hljs-keyword">const</span> continuationCallback = <span class="hljs-title function_">callback</span>(didUserCallbackTimeout);
      currentTime = <span class="hljs-title function_">getCurrentTime</span>();

      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> continuationCallback === <span class="hljs-string">"function"</span>) {
        <span class="hljs-comment">// å­˜åœ¨ç»­çº¦å›è°ƒï¼Œä¿ç•™ä»»åŠ¡å¹¶åœ¨ä¸‹ä¸€è½®æ‰§è¡Œ</span>
        currentTask.<span class="hljs-property">callback</span> = continuationCallback;
        <span class="hljs-title function_">advanceTimers</span>(currentTime);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// ä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œè‹¥ä»åœ¨é˜Ÿåˆ—é¡¶éƒ¨åˆ™å‡ºé˜Ÿ</span>
        <span class="hljs-keyword">if</span> (currentTask === <span class="hljs-title function_">peek</span>(taskQueue)) {
          <span class="hljs-title function_">pop</span>(taskQueue);
        }
        <span class="hljs-title function_">advanceTimers</span>(currentTime);
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// å›è°ƒéå‡½æ•°ï¼Œç›´æ¥å‡ºé˜Ÿ</span>
      <span class="hljs-title function_">pop</span>(taskQueue);
    }

    <span class="hljs-comment">// å–å‡ºä¸‹ä¸€ä¸ªä»»åŠ¡</span>
    currentTask = <span class="hljs-title function_">peek</span>(taskQueue);

    <span class="hljs-comment">// å¼ºåˆ¶è®©å‡ºæ¨¡å¼ä¸‹ï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦æš‚åœ</span>
    <span class="hljs-keyword">if</span> (enableAlwaysYieldScheduler) {
      <span class="hljs-keyword">if</span> (currentTask === <span class="hljs-literal">null</span> || currentTask.<span class="hljs-property">expirationTime</span> &gt; currentTime) {
        <span class="hljs-keyword">break</span>;
      }
    }
  }

  <span class="hljs-comment">// è‹¥è¿˜æœ‰æœªæ‰§è¡Œçš„ä»»åŠ¡ï¼Œè¿”å›trueï¼›å¦åˆ™å¤„ç†å»¶æ—¶ä»»åŠ¡</span>
  <span class="hljs-keyword">if</span> (currentTask !== <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">const</span> firstTimer = <span class="hljs-title function_">peek</span>(timerQueue);
    <span class="hljs-keyword">if</span> (firstTimer !== <span class="hljs-literal">null</span>) {
      <span class="hljs-comment">// å­˜åœ¨å»¶æ—¶ä»»åŠ¡ï¼Œè®¾ç½®å®šæ—¶å™¨è§¦å‘åˆ°æœŸå¤„ç†</span>
      <span class="hljs-title function_">requestHostTimeout</span>(handleTimeout, firstTimer.<span class="hljs-property">startTime</span> - currentTime);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }
}
</code></pre>
<h4 data-id="heading-20">5.2.4 åŒé˜Ÿåˆ—æµè½¬ï¼šadvanceTimers ä»»åŠ¡åˆ°æœŸå¤„ç†</h4>
<p>advanceTimers å‡½æ•°è´Ÿè´£æ£€æŸ¥ timerQueue ä¸­çš„å»¶æ—¶ä»»åŠ¡ï¼Œå°†åˆ°æœŸçš„ä»»åŠ¡ï¼ˆstartTime &lt;= å½“å‰æ—¶é—´ï¼‰ä» timerQueue è½¬å…¥ taskQueueï¼Œç¡®ä¿å»¶æ—¶ä»»åŠ¡åœ¨æŒ‡å®šæ—¶é—´åæ‰§è¡Œã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * å°†åˆ°æœŸçš„å»¶æ—¶ä»»åŠ¡ä»timerQueueè½¬å…¥taskQueue
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">currentTime</span> - å½“å‰æ—¶é—´
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">advanceTimers</span>(<span class="hljs-params">currentTime</span>) {
  <span class="hljs-keyword">let</span> timer = <span class="hljs-title function_">peek</span>(timerQueue);
  <span class="hljs-keyword">while</span> (timer !== <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">if</span> (timer.<span class="hljs-property">callback</span> === <span class="hljs-literal">null</span>) {
      <span class="hljs-comment">// å›è°ƒä¸ºç©ºï¼Œä»»åŠ¡å·²å–æ¶ˆï¼Œç›´æ¥å‡ºé˜Ÿ</span>
      <span class="hljs-title function_">pop</span>(timerQueue);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (timer.<span class="hljs-property">startTime</span> &lt;= currentTime) {
      <span class="hljs-comment">// ä»»åŠ¡åˆ°æœŸï¼Œä»timerQueueå‡ºé˜Ÿå¹¶è½¬å…¥taskQueue</span>
      <span class="hljs-title function_">pop</span>(timerQueue);
      timer.<span class="hljs-property">sortIndex</span> = timer.<span class="hljs-property">expirationTime</span>; <span class="hljs-comment">// æŒ‰è¿‡æœŸæ—¶é—´æ’åº</span>
      <span class="hljs-title function_">push</span>(taskQueue, timer);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// å­˜åœ¨æœªåˆ°æœŸçš„ä»»åŠ¡ï¼Œç»ˆæ­¢å¾ªç¯</span>
      <span class="hljs-keyword">return</span>;
    }
    timer = <span class="hljs-title function_">peek</span>(timerQueue);
  }
}
</code></pre>
<h2 data-id="heading-21">6. æ€»ç»“</h2>
<p>é¡µé¢å¡é¡¿çš„æœ¬è´¨æ˜¯ä¸»çº¿ç¨‹è¢«é•¿æ—¶é—´åŒæ­¥ä»»åŠ¡é˜»å¡ï¼Œè€Œåä½œå¼è°ƒåº¦æ˜¯è§£å†³è¿™ä¸€é—®é¢˜çš„æ ¸å¿ƒæ–¹æ¡ˆã€‚requestIdleCallback ä½œä¸ºåŸç”Ÿç©ºé—²è°ƒåº¦ APIï¼Œè™½èƒ½å®ç°åŸºç¡€çš„ç¢ç‰‡åŒ–æ‰§è¡Œï¼Œä½†å› å…¼å®¹æ€§ã€æ‰§è¡Œé¢‘ç‡ç­‰ç¼ºé™·æ— æ³•æ»¡è¶³ React çš„éœ€æ±‚ã€‚
React åŸºäº MessageChannel æ¨¡æ‹Ÿå‡ºäº†ä¸€å¥—æ›´é«˜æ•ˆçš„è°ƒåº¦æœºåˆ¶ï¼Œå…¶æ ¸å¿ƒæ˜¯åˆ©ç”¨ MessageChannel çš„å®ä»»åŠ¡ç‰¹æ€§ï¼Œåœ¨æ¯å¸§æ¸²æŸ“åè§¦å‘ä»»åŠ¡æ‰§è¡Œï¼ŒåŒæ—¶ç»“åˆä¼˜å…ˆçº§é˜Ÿåˆ—å’Œæ—¶é—´é˜ˆå€¼æ£€æŸ¥ï¼Œå®ç°äº†ä»»åŠ¡çš„ç¢ç‰‡åŒ–ã€ä¼˜å…ˆçº§åŒ–æ‰§è¡Œã€‚è¿™ä¸€æœºåˆ¶ä¸ä»…è§£å†³äº†é¡µé¢å¡é¡¿é—®é¢˜ï¼Œè¿˜ä¸º React çš„å¯ä¸­æ–­æ¸²æŸ“ï¼ˆConcurrent Modeï¼‰æä¾›äº†åº•å±‚æ”¯æ’‘ï¼Œæ˜¯ React é«˜æ€§èƒ½çš„å…³é”®ä¹‹ä¸€ã€‚
ç†è§£ React Scheduler çš„è°ƒåº¦ç­–ç•¥ï¼Œä¸ä»…èƒ½å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°æ’æŸ¥æ€§èƒ½é—®é¢˜ï¼Œä¹Ÿèƒ½åœ¨æ—¥å¸¸å¼€å‘ä¸­å€Ÿé‰´ä»»åŠ¡æ‹†åˆ†å’Œä¼˜å…ˆçº§è°ƒåº¦çš„æ€æƒ³ï¼Œå†™å‡ºæ›´æµç•…çš„å‰ç«¯ä»£ç ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäºarthasé‡åŒ–ç›‘æ§è¯Šæ–­javaåº”ç”¨æ–¹æ³•è®ºä¸å®è·µ]]></title>    <link>https://juejin.cn/post/7580623265791868966</link>    <guid>https://juejin.cn/post/7580623265791868966</guid>    <pubDate>2025-12-08T01:47:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580623265791868966" data-draft-id="7580621397971779593" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" åŸºäºarthasé‡åŒ–ç›‘æ§è¯Šæ–­javaåº”ç”¨æ–¹æ³•è®ºä¸å®è·µ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-08T01:47:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="shark_chili"/> <meta itemprop="url" content="https://juejin.cn/user/2858385964801672"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             åŸºäºarthasé‡åŒ–ç›‘æ§è¯Šæ–­javaåº”ç”¨æ–¹æ³•è®ºä¸å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2858385964801672/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    shark_chili
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T01:47:20.000Z" title="Mon Dec 08 2025 01:47:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å†™åœ¨æ–‡ç« å¼€å¤´</h2>
<p>åº”ç”¨ç³»ç»Ÿç›‘æ§ä¹Ÿæ˜¯è½¯ä»¶ç ”å‘ä¸­æœ€é‡è¦çš„ä¸€ç¯ï¼Œä»ç ”å‘çš„è§’åº¦æ¥è¯´ï¼Œæ˜ç¡®æŒ‡å‡ºè‡ªå·±ä¸šåŠ¡ç»´åº¦æ˜ç¡®æŒ‡å‡ºä¸ªäººè´Ÿè´£åŠŸèƒ½ä¸šåŠ¡ç»´åº¦çš„ç³»ç»Ÿç›‘æ§æŒ‡æ ‡ï¼ŒåŒæ—¶å…·å¤‡å®æ—¶ç›‘æ§è¯Šæ–­çš„åº”å¯¹æ–¹æ³•ï¼Œæ˜¯è½¯ä»¶æ¶æ„æˆåŠŸçš„é‡è¦çš„ä¸€ç¯ã€‚æ‰€ä»¥æœ¬æ–‡å°†é’ˆå¯¹æ•…éšœå’Œç›‘æ§ä¸¤ä¸ªé‡è¦æ¦‚å¿µå±•å¼€æ¢è®¨ï¼ŒåŒæ—¶ç»™å‡ºä¸€ç§ç†æƒ³åŒ–çš„æ¶æ„ç»“åˆå®è·µæ¡ˆä¾‹åŸºäºå‚è€ƒï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚</p>
<p>æˆ‘æ˜¯ <strong>SharkChili</strong> ï¼ŒJava å¼€å‘è€…ï¼Œ<strong>Java Guide</strong> å¼€æºé¡¹ç›®ç»´æŠ¤è€…ã€‚æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼š<strong>å†™ä»£ç çš„SharkChili</strong>ï¼Œä¹Ÿæ¬¢è¿æ‚¨äº†è§£æˆ‘çš„å¼€æºé¡¹ç›® mini-redisï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fshark-ctrl%2Fmini-redis" target="_blank" title="https://github.com/shark-ctrl/mini-redis" ref="nofollow noopener noreferrer">github.com/shark-ctrl/â€¦</a>ã€‚</p>
<p>ä¸ºæ–¹ä¾¿ä¸è¯»è€…äº¤æµï¼Œç°å·²åˆ›å»ºè¯»è€…ç¾¤ã€‚å…³æ³¨ä¸‹æ–¹å…¬ä¼—å·è·å–æˆ‘çš„è”ç³»æ–¹å¼ï¼Œæ·»åŠ æ—¶å¤‡æ³¨<strong>åŠ ç¾¤</strong>å³å¯åŠ å…¥ã€‚</p>
<h2 data-id="heading-1">æµ…è°ˆç›‘æ§çš„åŸºæœ¬æ¦‚å¿µ</h2>
<h3 data-id="heading-2">æ•…éšœçš„ç”Ÿå‘½å‘¨æœŸ</h3>
<p>æ•…éšœçš„ç”Ÿå‘½å‘¨æœŸåˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªé˜¶æ®µï¼š</p>
<ol>
<li>æ•…éšœå¼€å§‹</li>
<li>æ•…éšœå‘ç°</li>
<li>æ•…éšœå®šä½</li>
<li>åŠæ—¶ä¿®å¤</li>
<li>ç³»ç»Ÿæ¢å¤</li>
</ol>
<p>è¿™å…¶ä¸­ï¼Œæ•…éšœå‘ç°å’Œé€šçŸ¥åœ¨å¸‚é¢ä¸Šå·²ç»æœ‰ä¸€å¥—ç›¸å¯¹æˆç†Ÿçš„ä½“ç³»å‚è€ƒï¼Œæ— è®ºæ˜¯è¿ç»´è¿˜æ˜¯ç ”å‘æ€»ä¼šæœ‰ä¸€å¥—è‡ªå·±ç³»ç»Ÿç›‘æ§çš„ç†è®ºï¼Œå¹¶åœ¨åº”ç”¨ä¸­å®Œæˆè¿ç”¨å®ç°ç›‘æ§å’Œå‘Šè­¦ã€‚ é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä»ç ”å‘çš„è§’åº¦ï¼Œé’ˆå¯¹ç³»ç»Ÿç›‘æ§å„é¡¹æ€§èƒ½æŒ‡æ ‡ï¼Œå¦‚ä½•æ˜ç¡®å®šä½åˆ°å…·ä½“çš„é”™è¯¯ï¼Ÿä¾‹å¦‚ï¼š</p>
<ol>
<li>ç³»ç»Ÿæç¤ºCPUé£™å‡ï¼Œé¢å¯¹å®è§‚çš„æ€§èƒ½æŒ‡æ ‡ï¼Œæˆ‘ä»¬å¦‚ä½•çŸ¥æ™“æ•…éšœçº¿ç¨‹ï¼Ÿ</li>
<li>webè¯·æ±‚å…¨ä½“å¤¯æ­»ï¼Œç³»ç»Ÿç›‘æ§å…¨é¢å‘ŠçŸ¥çº¿ç¨‹å¤„äº<code>wating</code>çŠ¶æ€ï¼Œæˆ‘ä»¬å¦‚ä½•å®šä½åˆ°é—®é¢˜çš„æ ¹å› å¹¶ä¼˜åŒ–ï¼Ÿ</li>
<li>ç¨‹åºå †å†…å­˜é£™å‡è¾¾åˆ°ä¸ä¹‹ï¼Œæˆ‘ä»¬å¦‚ä½•å®šä½åˆ°è¿›ç¨‹çº§åˆ«çš„å…·ä½“é—®é¢˜å¯¹è±¡ä»è€Œå®šä½åˆ°é—®é¢˜çš„æ ˆå¸§ï¼Ÿ</li>
</ol>
<p>å¦‚ä¸‹å›¾ï¼Œè¿™å°±æ˜¯ç¬”è€…é¢æ¿ä¸­æœ€å¸¸è§çš„å®¹å™¨çº¿ç¨‹ç›´çº¿é£™å‡å¯¼è‡´å¤§é‡è¯·æ±‚å¤¯æ­»è¶…æ—¶ï¼ŒæŒ‰ç…§ç°æœ‰ä½“ç³»ä¸­çš„<code>grafana</code>ç›‘æ§é¢æ¿ï¼Œé¢å¯¹æˆç™¾ä¸Šåƒçš„æ¥å£è¯·æ±‚ï¼Œå³æ—¶æˆ‘ä»¬èƒ½å¤Ÿå‡†ç¡®çš„åšåˆ°æ•…éšœå‘ç°ï¼Œä¹Ÿæ— æ³•éå¸¸å¿«é€Ÿç²¾å‡†çš„åšåˆ°æ•…éšœå®šä½ï¼š <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1cad3533052241a2a264fdb8fc6136e2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765763240&amp;x-signature=odgWKC81oPOZ681Zxx%2F6rd6apGI%3D" alt="" loading="lazy"/></p>
<p>ç¼ºå°‘ç²¾å‡†çš„å®šä½åŠ¨ä½œï¼Œå°±çœ‹å¯¼è‡´æ­¢æŸåŠ¨ä½œå¯¹æ•…éšœæ¢å¤æ²¡æœ‰ä»»ä½•å¸®åŠ©ï¼Œå°±éœ€è¦è¿›è¡Œé‡æ–°å®šä½ï¼Œè¿›è€Œå¯¼è‡´è´Ÿè´£äººå‘˜èŠ±è´¹å¤§é‡æ—¶é—´åœ¨æ•…éšœå‘ç°å’Œæ­¢æŸåŠ¨ä½œä¹‹é—´å¾ªç¯å¾€å¤çš„æ‰§è¡Œã€‚</p>
<h3 data-id="heading-3">ç¬”è€…ç†æƒ³ä¸­çš„ç›‘æ§ä½“ç³»</h3>
<p>ç›‘æ§æ˜¯å¯ä»¥ç¡®ä¿æå‰æš´éœ²è¢«å³æ—¶å‘ç°è§£å†³ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ä½œä¸ºæ—¥å¸¸å¾ªç¯åç³»ç»Ÿè°ƒä¼˜çš„ä½è¯ã€‚æ‰€ä»¥é‡åŒ–ä¸€åˆ‡ç›‘æ§ä½“ç³»ä¹‹åï¼Œæˆ‘ä»¬å°±éœ€è¦æ­å»ºä¸€ä¸ªå®Œå–„ã€å®‰å…¨ã€æˆç†Ÿçš„ç›‘æ§è¯Šæ–­ä½“ç³»æ¥æ’æŸ¥å®šä½é—®é¢˜ï¼Œ ä»¥ç¬”è€…ç ”å‘çš„javaåº”ç”¨ä¸ºä¾‹ï¼Œä¸»æµçš„åº”ç”¨ç›‘æ§ä¼šé€šè¿‡<code>micrometer</code>é‡‡é›†ç›®æ ‡ç›‘æ§æŒ‡æ ‡ï¼Œå¹¶å°†å…¶åŒæ­¥åˆ°<code>prometheus</code>å¹¶é€šè¿‡<code>grafana</code>è¿›è¡Œå¢å¼ºæ¸²æŸ“ï¼Œåœ¨æ­¤åŸºç¡€ä¹‹ä¸Šé€šè¿‡<code>Nightingale</code>é’ˆå¯¹è¿™äº›å‘Šæ€¥çš„ç›‘æ§åŠæ—¶ä¸‹å‘ä¼å¾®æ¶ˆæ¯æˆ–è€…çŸ­ä¿¡å‘Šè­¦è®©ç ”å‘äººå‘˜ä»‹å…¥è§£å†³é—®é¢˜ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1c612b55ec334569aad2c1f91a83d5b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765763240&amp;x-signature=cQ09K6qFBM1BQA6J8%2BF8FY%2FK7jg%3D" alt="" loading="lazy"/></p>
<p>æŒ‰ç…§ç¬”è€…ä¸Šé¢çš„è¯´æ³•ï¼Œè¿™ç§åšæ³•å­˜åœ¨å¦‚ä¸‹å‡ ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li>å¸‚é¢ä»…ä»…æŒ‡å®šå¸¸è§ç³»ç»Ÿçº§åˆ«ç›‘æ§æŒ‡æ ‡ï¼Œç²’åº¦åœ¨å¦‚ä»Šçš„åº”ç”¨ç³»ç»Ÿä¸­æ˜¾å¾—è¿‡äºå®½æ³›</li>
<li>å›¢é˜ŸæŒ‡å®šæŒ‡æ ‡å¾€å¾€ä¼šå› ä¸ºå„ç§åŸå› æ— æ³•ç²¾å‡†ã€æ˜ç¡®ï¼Œå¯å¿«é€Ÿå®šä½æ£€ç´¢å„ç§å¼‚å¸¸å’Œç›‘æ§æ•…éšœçš„åº”ç”¨çº§åˆ«ç›‘æ§æŒ‡æ ‡</li>
<li><code>grafana</code>å’Œ<code>Nightingale</code>æ˜¯é¢å‘äºè¿ç»´å’Œç ”å‘çš„é€šç”¨ï¼Œä¸”ç€é‡äºç›‘æ§å¯è§†åŒ–å’Œé˜ˆå€¼å‘Šè­¦ï¼Œå¹¶ä¸èƒ½å¾ˆå¥½çš„åšåˆ°ç›‘æ§è¯Šæ–­ã€‚</li>
</ol>
<p>æ‰€ä»¥ï¼Œåœ¨æ­¤åŸºç¡€ä¹‹ä¸Šç¬”è€…ä¹Ÿç»™å‡ºäº†ä¸€å¥—åŸºäºè‡ªå·±å¸¸è§çš„å·¥å…·æ‰€è¡ç”Ÿäº†ä¸€å¥—å¸¦æœ‰ç›‘æ§è¯Šæ–­çš„ç›‘æ§è¿ç»´ä½“ç³»æ¶æ„ï¼Œå³åœ¨ä¸Šè¿°ç›‘æ§ä½“ç³»ä¸‹é›†æˆå¼ºé˜¿é‡Œç³»ä¸­å¼ºå¤§çš„ç›‘æ§è¯Šæ–­å·¥å…·<code>arthas</code>ã€‚</p>
<p>å¦‚ä¸‹å›¾ï¼Œåœ¨è¿™å¥—ç›‘æ§ä½“ç³»ä¸‹ï¼Œé€šè¿‡<code>arthas tunel</code>è¿œç¨‹ç»Ÿä¸€ç®¡ç†æ‰€æœ‰è¢«<code>arthas agent</code>ä»£ç†çš„<code>java</code>åº”ç”¨ç¨‹åºï¼Œå½“å…¶ä»–ç›‘æ§è¿ç»´å·¥å…·æ„ŸçŸ¥å¼‚å¸¸æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¿«é€Ÿé€šè¿‡æµè§ˆå™¨<code>attach</code>åˆ°å­˜åœ¨æ•…éšœçš„è¿›ç¨‹ä¸­ï¼Œä»¥è¶…ç»†ç²’åº¦çµæ´»çš„æŒ‡ä»¤å’Œè¡¨è¾¾å¼å®šä½<code>java</code>ç¨‹åºä¸­å¯¹è±¡å†…å­˜å ç”¨ã€<code>CPU</code>åˆ©ç”¨ç‡ç”šè‡³æ˜¯æ ˆå¸§çš„è°ƒç”¨ç»†èŠ‚ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9d16475d745142dba0c9539811b9b27d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765763240&amp;x-signature=HZN2ZDsdPc06UiGPQVD10OuhxQ8%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4">åŸºäºarhtasçš„åº”ç”¨è¿œç¨‹ç›‘æ§å®è·µ</h2>
<h3 data-id="heading-5">arthasç›‘æ§è¯Šæ–­ä½“ç³»è¯´æ˜</h3>
<p>åŸºäºä¸Šè¿°çš„è¯´æ˜ï¼Œæˆ‘ä»¬å¤§ä½“äº†è§£çš„ç›‘æ§è¯Šæ–­çš„ä¸€å¥—ç†æƒ³æ¶æ„ï¼Œè€Œæœ¬æ–‡å°†é’ˆå¯¹è¯¥æ¶æ„è¿›è¡Œæ¼”ç¤ºå’Œå®è·µï¼ŒæŒ‰ç…§<code>arthas</code>å®˜ç½‘çš„è¯´æ˜ï¼Œå¯¹äº<code>spring boot</code>é¡¹ç›®ï¼Œæˆ‘ä»¬åœ¨é¡¹ç›®ä¸­å¼•å…¥<code>arthas-spring-boot-starter</code>ï¼Œå…¶åº•å±‚ä¼šå¯åŠ¨ä¸€ä¸ª<code>arthas</code>è¿›ç¨‹å¹¶<code>attach</code>åˆ°è£…é…çš„åº”ç”¨ä¸Šï¼Œç”±æ­¤æ„å»ºå‡ºå½“å‰æœåŠ¡çš„<code>arthas agent</code>ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/787857bb19af4cd48fb2ede90247be75~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765763240&amp;x-signature=ABMMMMRcH5VrJSpUbt9YGbPGiK8%3D" alt="" loading="lazy"/></p>
<p>è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>ArthasConfiguration</code>çš„<code>arthasAgent</code>è¿™ä¸ª<code>bean</code>å¾—ä»¥å°è¯ï¼Œå¯ä»¥çœ‹åˆ°å®ƒä¼šæ‹‰å–<code>spring boot</code>é…ç½®åï¼Œé€šè¿‡è¿™ä¸ªé…ç½®æ„å»º<code>arthasAgent</code>å¹¶è°ƒç”¨initå®Œæˆå¦‚ä¸‹å·¥ä½œï¼š</p>
<ol>
<li>é€šè¿‡<code>Instrumentation</code>æ³¨å†Œå­—èŠ‚ç è½¬æ¢å™¨å³<code>ClassFileTransformer</code>ï¼Œåç»­é€šè¿‡è¯¥æŠ€æœ¯å®ç°ç±»åŠ è½½æˆ–è€…è¿è¡Œæ—¶å­—èŠ‚ç åŠ¨æ€å¢å¼º</li>
<li>æ‹‰å–ä¸€ä¸ª<code>artahs agent</code>å¹¶<code>attach</code>åˆ°å½“å‰è¿›ç¨‹æ„æˆ<code>artahs</code>æœåŠ¡ç«¯ï¼Œç›‘å¬å®¢æˆ·ç«¯æŒ‡ä»¤å®Œæˆç›®æ ‡ç±»å¢å¼ºï¼š</li>
</ol>
<p>å¯¹åº”ç¬”è€…ä¹Ÿç»™å‡ºè¿™æ®µæºç çš„è§†çº¿å…¥å£ï¼Œè¯»è€…å¯ä»¥è‡ªè¡Œå‚é˜…ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@ConditionalOnMissingBean</span>
Â <span class="hljs-variable">@Bean</span>
Â publicÂ ArthasAgentÂ <span class="hljs-built_in">arthasAgent</span>(<span class="hljs-variable">@Autowired</span>Â Map&lt;String,Â String&gt;Â arthasConfigMap,
Â Â Â <span class="hljs-variable">@Autowired</span>Â ArthasPropertiesÂ arthasProperties)Â throwsÂ ThrowableÂ {
Â Â <span class="hljs-selector-tag">arthasConfigMap</span>Â =Â <span class="hljs-selector-tag">StringUtils</span><span class="hljs-selector-class">.removeDashKey</span>(arthasConfigMap);
Â Â <span class="hljs-comment">//Â ç»™é…ç½®å…¨åŠ ä¸Šå‰ç¼€</span>
Â Â <span class="hljs-selector-tag">Map</span>&lt;<span class="hljs-selector-tag">String</span>,Â <span class="hljs-selector-tag">String</span>&gt;Â <span class="hljs-selector-tag">mapWithPrefix</span>Â =Â <span class="hljs-selector-tag">new</span>Â <span class="hljs-selector-tag">HashMap</span>&lt;<span class="hljs-selector-tag">String</span>,Â <span class="hljs-selector-tag">String</span>&gt;(arthasConfigMap.<span class="hljs-built_in">size</span>());
Â Â <span class="hljs-selector-tag">for</span>Â (Entry&lt;String,Â String&gt;Â <span class="hljs-attribute">entryÂ </span>:Â arthasConfigMap.<span class="hljs-built_in">entrySet</span>())Â {
Â Â Â <span class="hljs-selector-tag">mapWithPrefix</span><span class="hljs-selector-class">.put</span>(<span class="hljs-string">"arthas."</span>Â +Â entry.<span class="hljs-built_in">getKey</span>(),Â entry.<span class="hljs-built_in">getValue</span>());
Â Â }
Â Â <span class="hljs-comment">//åŸºäºé…ç½®å®Œæˆæ„å»ºartahsÂ agentï¼Œå®ŒæˆarthasÂ agentæœåŠ¡ç«¯åˆå§‹åŒ–ï¼Œç›‘å¬å®¢æˆ·ç«¯æŒ‡ä»¤å®Œæˆå­—èŠ‚ç å¢å¼º</span>
Â Â 
Â Â <span class="hljs-selector-tag">final</span>Â <span class="hljs-selector-tag">ArthasAgent</span>Â <span class="hljs-selector-tag">arthasAgent</span>Â =Â <span class="hljs-selector-tag">new</span>Â <span class="hljs-selector-tag">ArthasAgent</span>(mapWithPrefix,Â arthasProperties.<span class="hljs-built_in">getHome</span>(),
Â Â Â Â arthasProperties.<span class="hljs-built_in">isSlientInit</span>(),Â null);

Â Â <span class="hljs-selector-tag">arthasAgent</span><span class="hljs-selector-class">.init</span>();
Â Â <span class="hljs-selector-tag">logger</span><span class="hljs-selector-class">.info</span>(<span class="hljs-string">"ArthasÂ agentÂ startÂ success."</span>);
Â Â <span class="hljs-selector-tag">return</span>Â <span class="hljs-selector-tag">arthasAgent</span>;

Â }
</code></pre>
<p>åŒæ—¶ï¼Œè€ƒè™‘åˆ°å½“å‰åº”ç”¨ä½“ç³»ä¸‹æˆç™¾ä¸ªæœåŠ¡ï¼Œæˆ‘ä»¬éœ€è¦æœ‰ä¸€ä¸ªç»Ÿä¸€çš„å…¥å£é›†ä¸­åŒ–ç›‘æ§ç®¡ç†ï¼Œæ‰€ä»¥ä¸ºäº†èƒ½å¤Ÿæœ‰ä¸€ä¸ªç»Ÿä¸€çš„å…¥å£é›†ä¸­ç®¡ç†æ‰€æœ‰çš„agentï¼Œæˆ‘ä»¬ä¼šä¸“é—¨ç”¨ä¸€å°ä¸å¤–ç•Œéš”ç¦»çš„æœåŠ¡å™¨éƒ¨ç½²ä¸€ä¸ª<code>Arthas Tunnel</code>ï¼Œè®©æ‰€æœ‰çš„åº”ç”¨ç¨‹åºç”Ÿæˆagentåç»Ÿä¸€ä¸tunelå»ºç«‹è¿æ¥ï¼Œåç»­æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡<code>tunel</code>æš´éœ²çš„ç«¯å£ï¼Œç»Ÿä¸€ç®¡ç†ç›‘æ§è¯Šæ–­å­˜åœ¨å¼‚å¸¸é£é™©çš„åº”ç”¨ç¨‹åºï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/61693d0d1ae5437eacf461d005187f13~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765763240&amp;x-signature=JfxT6fHRpgk%2FBLoCceRSYRrgqsU%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-6">é¡¹ç›®ä¸­é›†æˆarthas</h3>
<p>å¯¹äºéœ€è¦<code>arthas agent</code>çš„ç¨‹åºï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦å¼•å…¥<code>arthas</code> è„šæ‰‹æ¶ä¾èµ–åŒ…ï¼š</p>
<pre><code class="hljs language-xml" lang="xml">Â <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.taobao.arthas<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>arthas-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.4.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>ç„¶åé…ç½®agentå”¯ä¸€idå¹¶æŒ‡å®štunelçš„æ³¨å†Œåœ°å€(é»˜è®¤æš´éœ²ç«¯å£ä¸º7777)ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">arthas.agent-id</span>=hsehdfsfghhwertyfad
<span class="hljs-attr">arthas.tunnel-server</span>=ws://<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">7777</span>/ws
</code></pre>
<p>éšåæˆ‘ä»¬åˆ°å®˜ç½‘ä¸‹è½½å¹¶å¯åŠ¨tunel</p>
<pre><code class="hljs language-vbscript" lang="vbscript">javaÂ -jarÂ arthas-tunnel-<span class="hljs-built_in">server</span><span class="hljs-number">-4.1</span><span class="hljs-number">.2</span>-fatjar.jar
</code></pre>
<p>æ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥å¯åŠ¨æˆ‘ä»¬çš„javaç¨‹åºäº†ï¼Œæ§åˆ¶å°å‡ºç°å¦‚ä¸‹æç¤ºï¼Œåˆ™è¯´æ˜æœåŠ¡å¯åŠ¨å¹¶æˆåŠŸæ³¨å†Œåˆ°arthasäº†ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">2025-12-07Â 22:09:21.370Â Â INFOÂ 68696Â ---Â <span class="hljs-section">[Â Â Â Â Â Â Â Â Â Â Â main]</span>Â c.a.arthas.spring.ArthasConfigurationÂ Â Â Â :Â ArthasÂ agentÂ startÂ success.
2025-12-07Â 22:09:21.483Â Â INFOÂ 68696Â ---Â <span class="hljs-section">[Â Â Â Â Â Â Â Â Â Â Â main]</span>Â o.s.b.w.embedded.tomcat.TomcatWebServerÂ Â :Â TomcatÂ initializedÂ withÂ port(s):Â 18080Â (http)
</code></pre>
<p>æ­¤æ—¶é”®å…¥<a href="https://link.juejin.cn?target=http%3A%2F%2F127.0.0.1%3A8080%2F%25E5%258D%25B3%25E5%258F%25AF%25E8%25BF%259B%25E5%2585%25A5tunel%25E9%259D%25A2%25E6%259D%25BF%25EF%25BC%258C%25E9%2594%25AE%25E5%2585%25A5%25E5%2588%259A%25E5%2588%259A%25E7%259A%2584agentid%25E5%258D%25B3%25E5%258F%25AF%25E7%259B%25B4%25E6%258E%25A5%25E8%25BF%259B%25E5%2585%25A5%25E7%259B%2591%25E6%258E%25A7%25E9%259D%25A2%25E6%259D%25BF%25EF%25BC%259A" target="_blank" title="http://127.0.0.1:8080/%E5%8D%B3%E5%8F%AF%E8%BF%9B%E5%85%A5tunel%E9%9D%A2%E6%9D%BF%EF%BC%8C%E9%94%AE%E5%85%A5%E5%88%9A%E5%88%9A%E7%9A%84agentid%E5%8D%B3%E5%8F%AF%E7%9B%B4%E6%8E%A5%E8%BF%9B%E5%85%A5%E7%9B%91%E6%8E%A7%E9%9D%A2%E6%9D%BF%EF%BC%9A" ref="nofollow noopener noreferrer">http://127.0.0.1:8080/å³å¯è¿›å…¥tunelé¢æ¿ï¼Œé”®å…¥åˆšåˆšçš„agentidå³å¯ç›´æ¥è¿›å…¥ç›‘æ§é¢æ¿ï¼š</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/843ea13ab4da4af6ae0f2a1850a9c556~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765763240&amp;x-signature=7TwsWarlmkVtoyycunS5EwH054A%3D" alt="" loading="lazy"/></p>
<p>è¿™é‡Œè¡¥å……è¯´æ˜ä¸€ä¸‹æ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥åˆ°å®˜ç½‘æ‹‰å–<code>arhtas</code>çš„æºç åŒ…ï¼Œä»¥ç¬”è€…ä¸ºä¾‹è¿™é‡Œé€‰æ‹©<code>arhtas-all-3.6.0</code>ç‰ˆæœ¬ï¼Œå¹¶åœ¨é…ç½®æ–‡ä»¶ä¸­å…³é—­<code>redis</code>ç›‘æ§ï¼Œé¿å…æœ¬æœºæ²¡æœ‰redisæœåŠ¡ç«¯è¿æ¥å¯¼è‡´è‡ªåŠ¨è£…é…é˜¶æ®µæŠ¥é”™ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">management.health.redis.enabled</span>=<span class="hljs-literal">false</span>
</code></pre>
<p>é€šè¿‡è¿è¡Œ<code>ArthasTunnelApplication</code>å°†<code>tunel</code>å¯åŠ¨ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/555607535ab84d90a010f89a50e35316~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765763240&amp;x-signature=V6uUH8y9IWbhyoiTBYwrqgrvAho%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-7">arthas tunelç³»ç»Ÿæ¶æ„ç›‘æ§å®è·µ</h3>
<p>å›åˆ°æœ€æ—©çš„é—®é¢˜ï¼Œé¢å¯¹å¤§é‡é£™å‡å¤„äº<code>wating</code>çŠ¶æ€çš„çº¿ç¨‹å› ä¸ºç›‘æ§å·¥å…·å’ŒæŒ‡æ ‡çš„å±€é™æ€§è€Œå‘åšåˆ°å¿«é€Ÿçš„ç›‘æ§è¯Šæ–­ï¼Œæœ‰äº†<code>arthas</code>ç›‘æ§è¯Šæ–­ä½“ç³»æ¶æ„ï¼Œç¬”è€…ç”¨ä¸‹é¢è¿™æ ·çš„ä¸€ä¸ªæ¥å£æ¨¡æ‹Ÿä¸€ä¸ªå­˜åœ¨é—®é¢˜çš„åˆ†é¡µæŸ¥è¯¢å¹¶æ¼”ç¤ºä¸€ä¸‹å¿«é€Ÿçš„è§£å†³æ­¥éª¤ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript">Â <span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">"/slow-request"</span>)
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">JSON</span><span class="hljs-built_in">Object</span>Â <span class="hljs-title function_">handleUserPageQuery</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è°ƒç”¨serviceçš„ç”¨æˆ·åˆ†é¡µåˆ—è¡¨æŸ¥è¯¢æ–¹æ³•</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â userService.<span class="hljs-title function_">getUserPageList</span>();
Â Â Â Â }
</code></pre>
<p>æŸ¥çœ‹<code>UserService</code>çš„<code>getUserPageList</code>ï¼Œå¯ä»¥çœ‹åˆ°å…¶å†…éƒ¨ç”¨ä¼‘çœ æ¨¡æ‹Ÿåˆ†é¡µæŸ¥è¯¢çš„é•¿è€—æ—¶ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">public</span>Â <span class="hljs-title class_">JSON</span><span class="hljs-built_in">Object</span>Â <span class="hljs-title function_">getUserPageList</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â Â Â log.<span class="hljs-title function_">info</span>(<span class="hljs-string">"å¼€å§‹æŸ¥è¯¢ç”¨æˆ·åˆ†é¡µåˆ—è¡¨"</span>);
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ¨¡æ‹Ÿè€—æ—¶çš„ç”¨æˆ·åˆ†é¡µåˆ—è¡¨æŸ¥è¯¢ï¼Œä¼‘çœ 1åˆ†é’Ÿ</span>
Â Â Â Â Â Â Â Â <span class="hljs-title class_">ThreadUtil</span>.<span class="hljs-title function_">sleep</span>(<span class="hljs-number">1</span>,Â <span class="hljs-title class_">TimeUnit</span>.<span class="hljs-property">DAYS</span>);
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ„é€ åˆ†é¡µåˆ—è¡¨ç»“æœ</span>
Â Â Â Â Â Â Â Â <span class="hljs-title class_">JSON</span><span class="hljs-built_in">Object</span>Â resultÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">JSON</span><span class="hljs-built_in">Object</span>();
Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">set</span>(<span class="hljs-string">"code"</span>,Â <span class="hljs-number">200</span>);
Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">set</span>(<span class="hljs-string">"message"</span>,Â <span class="hljs-string">"success"</span>);
Â Â Â Â Â Â Â Â <span class="hljs-title class_">JSON</span><span class="hljs-built_in">Object</span>Â dataÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">JSON</span><span class="hljs-built_in">Object</span>();
Â Â Â Â Â Â Â Â data.<span class="hljs-title function_">set</span>(<span class="hljs-string">"total"</span>,Â <span class="hljs-number">100</span>);
Â Â Â Â Â Â Â Â data.<span class="hljs-title function_">set</span>(<span class="hljs-string">"pageSize"</span>,Â <span class="hljs-number">10</span>);
Â Â Â Â Â Â Â Â data.<span class="hljs-title function_">set</span>(<span class="hljs-string">"currentPage"</span>,Â <span class="hljs-number">1</span>);
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ¨¡æ‹Ÿç”¨æˆ·åˆ—è¡¨æ•°æ®</span>
Â Â Â Â Â Â Â Â <span class="hljs-title class_">JSON</span><span class="hljs-built_in">Object</span>Â user1Â =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">JSON</span><span class="hljs-built_in">Object</span>();
Â Â Â Â Â Â Â Â user1.<span class="hljs-title function_">set</span>(<span class="hljs-string">"id"</span>,Â <span class="hljs-number">1</span>);
Â Â Â Â Â Â Â Â user1.<span class="hljs-title function_">set</span>(<span class="hljs-string">"name"</span>,Â <span class="hljs-string">"å¼ ä¸‰"</span>);
Â Â Â Â Â Â Â Â user1.<span class="hljs-title function_">set</span>(<span class="hljs-string">"email"</span>,Â <span class="hljs-string">"zhangsan@example.com"</span>);
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-title class_">JSON</span><span class="hljs-built_in">Object</span>Â user2Â =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">JSON</span><span class="hljs-built_in">Object</span>();
Â Â Â Â Â Â Â Â user2.<span class="hljs-title function_">set</span>(<span class="hljs-string">"id"</span>,Â <span class="hljs-number">2</span>);
Â Â Â Â Â Â Â Â user2.<span class="hljs-title function_">set</span>(<span class="hljs-string">"name"</span>,Â <span class="hljs-string">"æå››"</span>);
Â Â Â Â Â Â Â Â user2.<span class="hljs-title function_">set</span>(<span class="hljs-string">"email"</span>,Â <span class="hljs-string">"lisi@example.com"</span>);
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â data.<span class="hljs-title function_">set</span>(<span class="hljs-string">"users"</span>,Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">JSON</span><span class="hljs-built_in">Object</span>[]{user1,Â user2});
Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">set</span>(<span class="hljs-string">"data"</span>,Â data);
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â log.<span class="hljs-title function_">info</span>(<span class="hljs-string">"ç”¨æˆ·åˆ†é¡µåˆ—è¡¨æŸ¥è¯¢å®Œæˆ"</span>);
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â result;
Â Â Â Â }
</code></pre>
<p>é€šè¿‡ä¸Šæ–‡çš„<code>tunel</code>å…¥å£ï¼Œæˆ‘ä»¬å¾ˆå¿«çš„è¿›å…¥åˆ°ç¨‹åºå†…éƒ¨ï¼Œç®€å•å¿«é€Ÿçš„å®šä½çš„<code>tomcat</code>é‚£äº›å­˜åœ¨<code>time</code> <code>wating</code>çš„é—®é¢˜çº¿ç¨‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/199a86aa30084eb39cdd5b7165209925~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765763240&amp;x-signature=evmPrtxghNJKC845apeOyVDKD6s%3D" alt="" loading="lazy"/></p>
<p>éå¸¸ç®€å•å¹²è„†çš„å®šä½åˆ°äº†é—®é¢˜çº¿ç¨‹çš„æ ˆå¸§ï¼Œå¾ˆå¥½çš„å®Œæˆç›‘æ§ä½“ç³»ä¸­çš„ç›‘æ§è¯Šæ–­è¿™ä¸€æ­¥ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/327cbc675b1446cc9b647188a92e1285~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765763240&amp;x-signature=OYYDK4ttYLfS2Z%2BDQDsKxaspObU%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-8">å°ç»“</h2>
<p>ç¬”è€…è®¤ä¸ºï¼Œä¸€ä¸ªå¥å£®çš„ç³»ç»Ÿè¿ç»´ç›‘æ§ä½“ç³»æ˜¯ç€é‡äºå¼ºè°ƒé‡åŒ–ä¸”å¯æ„ŸçŸ¥è§‚æµ‹çš„ï¼Œåœ¨æ—¥å¸¸å·¥ä½œçš„å¯¹æ¥ä¸­ï¼Œæˆ‘å‘ç°å¤§é‡ç ”å‘äººå‘˜éƒ½æœ‰ä¸€ç§è®¡ç®—æœºæ–‡ç§‘åŒ–çš„è¶‹åŠ¿ï¼Œå°åˆ°åº”ç”¨ç¨‹åºæŒ‡æ ‡è°ƒæµ‹ï¼Œè¾¾åˆ°æ•…éšœå®šä½æš´åŠ›è¿­ä»£ç»“åˆæ—¥å¿—ç›²ç›®æ¨æµ‹ã€‚ ç»“åˆè¿™äº›é—®é¢˜ï¼Œç¬”è€…é€šè¿‡è¿™ç¯‡æ–‡ç« ç»™å‡ºä¸€ä¸ªç†æƒ³çš„ç›‘æ§ä½“ç³»ï¼Œä¹Ÿå¸Œæœ›å¯¹è¯»è€…æœ‰æ‰€å¯å‘ã€‚</p>
<p>æˆ‘æ˜¯ <strong>SharkChili</strong> ï¼ŒJava å¼€å‘è€…ï¼Œ<strong>Java Guide</strong> å¼€æºé¡¹ç›®ç»´æŠ¤è€…ã€‚æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼š<strong>å†™ä»£ç çš„SharkChili</strong>ï¼Œä¹Ÿæ¬¢è¿æ‚¨äº†è§£æˆ‘çš„å¼€æºé¡¹ç›® mini-redisï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fshark-ctrl%2Fmini-redis" target="_blank" title="https://github.com/shark-ctrl/mini-redis" ref="nofollow noopener noreferrer">github.com/shark-ctrl/â€¦</a>ã€‚</p>
<p>ä¸ºæ–¹ä¾¿ä¸è¯»è€…äº¤æµï¼Œç°å·²åˆ›å»ºè¯»è€…ç¾¤ã€‚å…³æ³¨ä¸‹æ–¹å…¬ä¼—å·è·å–æˆ‘çš„è”ç³»æ–¹å¼ï¼Œæ·»åŠ æ—¶å¤‡æ³¨<strong>åŠ ç¾¤</strong>å³å¯åŠ å…¥ã€‚</p>
<p>æˆ‘æ˜¯ SharkChili ï¼ŒJava å¼€å‘è€…ï¼ŒJava Guide å¼€æºé¡¹ç›®ç»´æŠ¤è€…ã€‚æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šå†™ä»£ç çš„SharkChiliï¼Œä¹Ÿæ¬¢è¿æ‚¨äº†è§£æˆ‘çš„å¼€æºé¡¹ç›® mini-redisï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fshark-ctrl%2Fmini-redis%25E3%2580%2582" target="_blank" title="https://github.com/shark-ctrl/mini-redis%E3%80%82" ref="nofollow noopener noreferrer">github.com/shark-ctrl/â€¦</a></p>
<p>ä¸ºæ–¹ä¾¿ä¸è¯»è€…äº¤æµï¼Œç°å·²åˆ›å»ºè¯»è€…ç¾¤ã€‚å…³æ³¨ä¸Šæ–¹å…¬ä¼—å·è·å–æˆ‘çš„è”ç³»æ–¹å¼ï¼Œæ·»åŠ æ—¶å¤‡æ³¨åŠ ç¾¤å³å¯åŠ å…¥ã€‚</p>
<h2 data-id="heading-9">å‚è€ƒ</h2>
<p>é˜¿é‡ŒArthasæ·±åº¦è¯¦è§£ï¼šä»åº•å±‚åŸç†åˆ°ç”Ÿäº§å®æˆ˜ï¼ŒJavaé—®é¢˜æ’æŸ¥ä¸å†æ„ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fjam_yin%2Farticle%2Fdetails%2F155359238%23%3A~%3Atext%3DArthas%25E7%259A%2584%25E5%25B7%25A5%25E4%25BD%259C%25E5%258E%259F%25E7%2590%2586%25E6%259C%25AC%25E8%25B4%25A8%25E6%2598%25AF%25E2%2580%259CAttach%25E6%259C%25BA%25E5%2588%25B6%25E6%25B3%25A8%25E5%2585%25A5%25E4%25BB%25A3%25E7%2590%2586%2520%252B%2520Instrumentation%25E5%25AE%259E%25E7%258E%25B0%25E5%25AD%2597%25E8%258A%2582%25E7%25A0%2581%25E5%25A2%259E%25E5%25BC%25BA%25E2%2580%259D%25E7%259A%2584%25E7%25BB%2584%25E5%2590%2588%25EF%25BC%258C%25E6%2595%25B4%25E4%25BD%2593%25E6%25B5%2581%25E7%25A8%258B%25E5%25A6%2582%25E4%25B8%258B%25EF%25BC%259A%25204.%2CArthas%25E6%25A0%25B8%25E5%25BF%2583%25E6%259E%25B6%25E6%259E%2584%25E8%25A7%25A3%25E6%259E%2590%2520Arthas%25E9%2587%2587%25E7%2594%25A8%25E2%2580%259C%25E5%25AE%25A2%25E6%2588%25B7%25E7%25AB%25AF-%25E6%259C%258D%25E5%258A%25A1%25E7%25AB%25AF%25E2%2580%259D%25E6%259E%25B6%25E6%259E%2584%25EF%25BC%258C%25E5%2588%2586%25E4%25B8%25BA%25E4%25B8%2589%25E5%25A4%25A7%25E6%25A0%25B8%25E5%25BF%2583%25E6%25A8%25A1%25E5%259D%2597%25EF%25BC%259A%25E5%25AE%25A2%25E6%2588%25B7%25E7%25AB%25AF%25E3%2580%2581%25E6%259C%258D%25E5%258A%25A1%25E7%25AB%25AF%25E3%2580%2581%25E4%25BB%25A3%25E7%2590%2586%25E7%25AB%25AF%25EF%25BC%258C%25E5%2590%2584%25E6%25A8%25A1%25E5%259D%2597%25E8%2581%258C%25E8%25B4%25A3%25E6%25B8%2585%25E6%2599%25B0%25EF%25BC%258C%25E5%258D%258F%25E5%2590%258C%25E5%25B7%25A5%25E4%25BD%259C%25E5%25AE%259E%25E7%258E%25B0%25E8%25AF%258A%25E6%2596%25AD%25E5%258A%259F%25E8%2583%25BD%25E3%2580%2582%2520%25E6%2594%25AF%25E6%258C%2581%25E5%2591%25BD%25E4%25BB%25A4%25E8%25A1%25A5%25E5%2585%25A8%25E3%2580%2581%25E5%258E%2586%25E5%258F%25B2%25E8%25AE%25B0%25E5%25BD%2595%25E3%2580%2581%25E7%25BB%2593%25E6%259E%259C%25E6%25A0%25BC%25E5%25BC%258F%25E5%258C%2596%25E5%25B1%2595%25E7%25A4%25BA%25E3%2580%2582%2520%25E5%25B0%2586%25E9%2587%2587%25E9%259B%2586%25E5%2588%25B0%25E7%259A%2584%25E6%2595%25B0%25E6%258D%25AE%25E6%25A0%25BC%25E5%25BC%258F%25E5%258C%2596%25E5%2590%258E%25E8%25BF%2594%25E5%259B%259E%25E5%25AE%25A2%25E6%2588%25B7%25E7%25AB%25AF%25E3%2580%2582%2520%25E6%2594%25AF%25E6%258C%2581%25E7%25B1%25BB%25E9%2587%258D%25E5%25AE%259A%25E4%25B9%2589%25E3%2580%2581%25E7%25B1%25BB%25E5%258D%25B8%25E8%25BD%25BD%25E7%25AD%2589%25E6%25A0%25B8%25E5%25BF%2583%25E6%2593%258D%25E4%25BD%259C%25E3%2580%2582" target="_blank" title="https://blog.csdn.net/jam_yin/article/details/155359238#:~:text=Arthas%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%E6%9C%AC%E8%B4%A8%E6%98%AF%E2%80%9CAttach%E6%9C%BA%E5%88%B6%E6%B3%A8%E5%85%A5%E4%BB%A3%E7%90%86%20%2B%20Instrumentation%E5%AE%9E%E7%8E%B0%E5%AD%97%E8%8A%82%E7%A0%81%E5%A2%9E%E5%BC%BA%E2%80%9D%E7%9A%84%E7%BB%84%E5%90%88%EF%BC%8C%E6%95%B4%E4%BD%93%E6%B5%81%E7%A8%8B%E5%A6%82%E4%B8%8B%EF%BC%9A%204.,Arthas%E6%A0%B8%E5%BF%83%E6%9E%B6%E6%9E%84%E8%A7%A3%E6%9E%90%20Arthas%E9%87%87%E7%94%A8%E2%80%9C%E5%AE%A2%E6%88%B7%E7%AB%AF-%E6%9C%8D%E5%8A%A1%E7%AB%AF%E2%80%9D%E6%9E%B6%E6%9E%84%EF%BC%8C%E5%88%86%E4%B8%BA%E4%B8%89%E5%A4%A7%E6%A0%B8%E5%BF%83%E6%A8%A1%E5%9D%97%EF%BC%9A%E5%AE%A2%E6%88%B7%E7%AB%AF%E3%80%81%E6%9C%8D%E5%8A%A1%E7%AB%AF%E3%80%81%E4%BB%A3%E7%90%86%E7%AB%AF%EF%BC%8C%E5%90%84%E6%A8%A1%E5%9D%97%E8%81%8C%E8%B4%A3%E6%B8%85%E6%99%B0%EF%BC%8C%E5%8D%8F%E5%90%8C%E5%B7%A5%E4%BD%9C%E5%AE%9E%E7%8E%B0%E8%AF%8A%E6%96%AD%E5%8A%9F%E8%83%BD%E3%80%82%20%E6%94%AF%E6%8C%81%E5%91%BD%E4%BB%A4%E8%A1%A5%E5%85%A8%E3%80%81%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95%E3%80%81%E7%BB%93%E6%9E%9C%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%B1%95%E7%A4%BA%E3%80%82%20%E5%B0%86%E9%87%87%E9%9B%86%E5%88%B0%E7%9A%84%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%90%8E%E8%BF%94%E5%9B%9E%E5%AE%A2%E6%88%B7%E7%AB%AF%E3%80%82%20%E6%94%AF%E6%8C%81%E7%B1%BB%E9%87%8D%E5%AE%9A%E4%B9%89%E3%80%81%E7%B1%BB%E5%8D%B8%E8%BD%BD%E7%AD%89%E6%A0%B8%E5%BF%83%E6%93%8D%E4%BD%9C%E3%80%82" ref="nofollow noopener noreferrer">blog.csdn.net/jam_yin/artâ€¦</a></p>
<p>é¡¹ç›®å¯åŠ¨æŠ¥é”™ï¼šRedis health check failed:<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.cnblogs.com%2Fyl97%2Fp%2F14926029.html" target="_blank" title="https://www.cnblogs.com/yl97/p/14926029.html" ref="nofollow noopener noreferrer">www.cnblogs.com/yl97/p/1492â€¦</a></p>
<p>Tunnel Server:<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.xiehai.zone%2Farthas%2Finstall%2Ftunnel.html" target="_blank" title="https://www.xiehai.zone/arthas/install/tunnel.html" ref="nofollow noopener noreferrer">www.xiehai.zone/arthas/instâ€¦</a></p>
<p>ã€Šè¿ç»´ç›‘æ§ç³»ç»Ÿå®æˆ˜ç¬”è®°ã€‹</p>
<p>å®æˆ˜å¼€å‘ arthas-spring-boot-starterï¼Œç›‘æ§ä½ çš„å¾®æœåŠ¡æ˜¯å¦å¥åº·!ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fxie.infoq.cn%2Farticle%2F847786de8b6da553db8b018ce" target="_blank" title="https://xie.infoq.cn/article/847786de8b6da553db8b018ce" ref="nofollow noopener noreferrer">xie.infoq.cn/article/847â€¦</a></p>
<p>ä¸€æ–‡å¸¦ä½ æ•´åˆarthaså’Œspringboot :<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fweixin_45642975%2Farticle%2Fdetails%2F148202414" target="_blank" title="https://blog.csdn.net/weixin_45642975/article/details/148202414" ref="nofollow noopener noreferrer">blog.csdn.net/weixin_4564â€¦</a></p>
<p>spring boot é›†æˆarthaså®ç°çº¿ä¸Šè¿œç¨‹ç›‘æ§è°ƒä¼˜ :<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F610030983" target="_blank" title="https://zhuanlan.zhihu.com/p/610030983" ref="nofollow noopener noreferrer">zhuanlan.zhihu.com/p/610030983</a></p>
<p>Arthas Tunnel:<a href="https://link.juejin.cn?target=https%3A%2F%2Farthas.aliyun.com%2Fdoc%2Ftunnel.html" target="_blank" title="https://arthas.aliyun.com/doc/tunnel.html" ref="nofollow noopener noreferrer">arthas.aliyun.com/doc/tunnel.â€¦</a></p>
<p>æœ¬æ–‡ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fmarkdown.com.cn" target="_blank" title="https://markdown.com.cn" ref="nofollow noopener noreferrer">markdown.com.cn</a> æ’ç‰ˆ</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç»ˆäºä¸æ¼äº†-Androidå¼€å‘å†…å­˜æ³„æ¼è¯¦è§£]]></title>    <link>https://juejin.cn/post/7580606750290903091</link>    <guid>https://juejin.cn/post/7580606750290903091</guid>    <pubDate>2025-12-07T12:56:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580606750290903091" data-draft-id="7580564126402609202" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç»ˆäºä¸æ¼äº†-Androidå¼€å‘å†…å­˜æ³„æ¼è¯¦è§£"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-07T12:56:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é©¬å­”å¤šçš„ç‚¼é‡‘æœ¯å¸ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/4469974689386972"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç»ˆäºä¸æ¼äº†-Androidå¼€å‘å†…å­˜æ³„æ¼è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4469974689386972/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é©¬å­”å¤šçš„ç‚¼é‡‘æœ¯å¸ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T12:56:26.000Z" title="Sun Dec 07 2025 12:56:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ä»æœ¬è´¨çœ‹â€œå†…å­˜æ³„éœ²â€æ˜¯ä»€ä¹ˆ</h2>
<p><strong>å†…å­˜æ³„éœ²åœ¨ Java/Android ä¸­çš„å®šä¹‰</strong>ï¼šå¯¹è±¡ä¸å†è¢«ä¸šåŠ¡éœ€è¦ï¼Œä½†ä»ç„¶èƒ½è¢« GC æ ¹ï¼ˆGC rootsï¼‰é€šè¿‡ä¸€æ¡æˆ–å¤šæ¡å¼•ç”¨è·¯å¾„è®¿é—®åˆ°ï¼Œå¯¼è‡´åƒåœ¾å›æ”¶å™¨ä¸ä¼šå›æ”¶å®ƒï¼Œä»è€Œå ç”¨å†…å­˜å¹¶å¯èƒ½å¼•èµ· OOMã€‚<strong>åœ¨Androidä¸­</strong> ï¼Œå†…å­˜æ³„æ¼å¤§æ¦‚å°±åŒ…æ‹¬<strong>Javaå¯¹è±¡å±‚é¢çš„æ³„æ¼</strong>å’Œ<strong>Androidç³»ç»Ÿèµ„æºï¼ˆå¦‚Bitmapã€Cursorç­‰ï¼‰çš„æœªé‡Šæ”¾é—®é¢˜</strong>ã€‚å³ä¾¿ Java å¯¹è±¡è¢«å›æ”¶ï¼Œnative èµ„æºè‹¥æ²¡æœ‰æ˜¾å¼é‡Šæ”¾ä¹Ÿä¼šæ³„éœ²ã€‚</p>
<h2 data-id="heading-1">äºŒã€åº•å±‚åŸç†</h2>
<p>ä¸Šé¢è¯´äº†ï¼Œåœ¨ Android ä¸­å†…å­˜æ³„æ¼åˆ†ä¸ºã€ŒJVM å †å†…å­˜æ³„æ¼ã€å’Œã€Œç³»ç»Ÿèµ„æºæ³„æ¼ã€ä¸¤ç±»ï¼Œ <strong>JVM ç®¡ç†çš„å¯¹è±¡ç”± GC å›æ”¶ï¼Œè€Œ Android ç³»ç»Ÿèµ„æºåˆ™ç”±å¼€å‘è€…æ‰‹åŠ¨è°ƒç”¨ API é‡Šæ”¾</strong>ï¼Œç³»ç»Ÿä¸è‡ªåŠ¨å›æ”¶ã€‚</p>
<p>å…·ä½“æ¥è¯´ <strong>Java/Kotlin å®šä¹‰çš„å¯¹è±¡</strong>ï¼ˆå¦‚ <code>Activity</code>ã€<code>View</code>ã€<code>String</code>ã€é›†åˆç­‰ï¼‰ï¼Œéƒ½å­˜å‚¨åœ¨ JVM å †ä¸­ï¼Œå®Œå…¨ç”± GC ç®¡ç†ã€‚æ¯”å¦‚ <code>Activity</code> å®ä¾‹ã€<code>MaterialButton</code> å¯¹è±¡ã€<code>EventBus</code> è®¢é˜…è€…å¼•ç”¨ï¼Œè¿™äº›éƒ½æ˜¯ JVM å †å¯¹è±¡ï¼ŒGC ä¼šæ ¹æ® â€œå¯è¾¾æ€§â€ åˆ¤æ–­æ˜¯å¦å›æ”¶ï¼›</p>
<p><strong>Android ç³»ç»Ÿèµ„æº</strong>æ˜¯é€šè¿‡ Native å±‚è°ƒç”¨ Linux å†…æ ¸æ¥å£ç”³è¯·çš„ã€Œé JVM èµ„æºã€ï¼ŒGC æ—¢æ„ŸçŸ¥ä¸åˆ°ï¼Œä¹Ÿæ— æ³•å›æ”¶ï¼Œå¸¸è§æœ‰<strong>ç³»ç»ŸæœåŠ¡å¼•ç”¨</strong><code>ContentResolver.Cursor</code>ã€<code>MediaPlayer</code>ã€å¹¿æ’­æ¥æ”¶å™¨ï¼ˆ<code>BroadcastReceiver</code>ï¼‰ã€<code>NotificationManager</code> ï¼›<strong>å›¾å½¢èµ„æº</strong>ï¼šBitmapï¼ˆNative å±‚åƒç´ æ•°æ®ï¼‰ã€<code>Drawable</code>ã€<code>Canvas</code> ï¼›<code>SharedPreferences</code> çš„ <code>Editor</code>çš„å†…å­˜å—ç­‰ ï¼Œè¿™äº›éƒ½æ˜¯éœ€è¦æˆ‘ä»¬è‡ªè¡Œè°ƒ<code>api</code>æ‰‹åŠ¨å…³é—­çš„ã€‚</p>
<h3 data-id="heading-2">2.1.<strong>å¼•ç”¨ç±»å‹å†³å®šå›æ”¶</strong></h3>
<p>Javaä¸­æ˜¯é€šè¿‡å¯è¾¾æ€§åˆ†æåˆ¤å®šå¯¹è±¡æ˜¯å¦å­˜æ´»çš„ï¼Œå­¦ä¹ è¯¥ç®—æ³•éœ€è¦äº†è§£Javaä¸­çš„4ç§å¼•ç”¨ã€‚Javaä¸­å¼•ç”¨åˆ†ä¸ºå¼ºå¼•ç”¨ï¼ˆé»˜è®¤ï¼‰ã€è½¯å¼•ç”¨ã€å¼±å¼•ç”¨ã€è™šå¼•ç”¨ã€‚æˆ‘ä»¬ç”¨åˆ°çš„å¼•ç”¨åŸºæœ¬éƒ½æ˜¯å¼ºå¼•ç”¨ï¼Œå…¶ä»–ä¸‰ç§å‡ ä¹ä¸ä¼šå‡ºç°åœ¨æ—¥å¸¸å¼€å‘ä¸­ã€‚</p>
<ul>
<li>å¼ºå¼•ç”¨ï¼šå¼ºå¼•ç”¨æ˜¯åœ¨ç¨‹åºä»£ç ä¸­æ™®éå­˜åœ¨çš„ï¼Œä¾‹å¦‚<code>Person person = new Person()</code>ï¼Œ<strong>åªè¦å¼ºå¼•ç”¨è¿˜å­˜åœ¨ï¼Œåƒåœ¾æ”¶é›†å™¨æ°¸è¿œä¸ä¼šå›æ”¶è¢«å¼•ç”¨çš„å¯¹è±¡</strong>ã€‚</li>
<li>è½¯å¼•ç”¨ï¼šè½¯å¼•ç”¨æ˜¯ç”¨æ¥æè¿°ä¸€äº›è¿˜æœ‰ç”¨ä½†å¹¶éå¿…é¡»çš„å¯¹è±¡ï¼Œå¯¹äº<strong>è½¯å¼•ç”¨å…³è”çš„å¯¹è±¡ï¼Œåœ¨ç³»ç»Ÿå°†å‘ç”Ÿå†…å­˜æº¢å‡ºå¼‚å¸¸å‰ï¼Œå°†ä¼šæŠŠè¿™äº›å¯¹è±¡åˆ—å…¥å›æ”¶èŒƒå›´ä¹‹ä¸­è¿›è¡ŒäºŒæ¬¡å›æ”¶ï¼Œå¦‚æœè¯¥æ¬¡å›æ”¶è¿˜æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜ï¼Œæ‰ä¼šæŠ›å‡ºå†…å­˜æº¢å‡ºå¼‚å¸¸</strong>ã€‚Javaæä¾›äº†**<code>SoftReference</code>**å®ç°è½¯å¼•ç”¨ï¼Œæˆ‘ä»¬åœ¨å®‰å“å¼€å‘ä¸­å¯èƒ½ç”¨è¿‡Glideåº“å¤„ç†å›¾ç‰‡ï¼ŒGlideçš„åº•å±‚å°±ç”¨åˆ°äº†è½¯å¼•ç”¨ã€‚</li>
<li>å¼±å¼•ç”¨ï¼šå¼±å¼•ç”¨ä¹Ÿæ˜¯æè¿°éå¿…éœ€å¯¹è±¡ï¼Œä½†æ˜¯å®ƒçš„å¼ºåº¦æ¯”è½¯å¼•ç”¨æ›´å¼±ä¸€äº›ï¼Œ<strong>è¢«å¼±å¼•ç”¨å…³è”çš„å¯¹è±¡åªèƒ½ç”Ÿå­˜åˆ°ä¸‹ä¸€æ¬¡åƒåœ¾æ”¶é›†ä¹‹å‰</strong>ï¼Œå½“åƒåœ¾æ”¶é›†å™¨å·¥ä½œæ—¶ï¼Œæ— è®ºå½“å‰å†…å­˜æ˜¯å¦è¶³å¤Ÿï¼Œéƒ½ä¼šå›æ”¶æ‰åªè¢«å¼±å¼•ç”¨å…³è”çš„å¯¹è±¡ã€‚Javaæä¾›äº†**<code>WeakReference</code>**å®ç°å¼±å¼•ç”¨ï¼ŒAndroidæ¶ˆæ¯æœºåˆ¶ä¸­çš„<code>ThreadLocal</code>å°±ç”¨åˆ°äº†å¼±å¼•ç”¨ï¼Œ<code>ThreadLocal</code>çš„æ ¸å¿ƒåœ¨äºå…¶å†…éƒ¨ç±» <code>ThreadLocalMap</code>ã€‚è¿™ä¸ª Map ä½¿ç”¨ä¸€ä¸ªç‰¹æ®Šçš„ <code>Entry</code>ç±»æ¥å­˜å‚¨é”®å€¼å¯¹ï¼Œè€Œ <code>Entry</code>å°±ç»§æ‰¿è‡ª <code>WeakReference</code>ã€‚</li>
<li>è™šå¼•ç”¨ï¼šè™šå¼•ç”¨æ˜¯æœ€å¼±çš„ä¸€ç§å¼•ç”¨å…³ç³»ï¼Œä¸€ä¸ªå¯¹è±¡æ˜¯å¦æœ‰è™šå¼•ç”¨çš„å­˜åœ¨ï¼Œå®Œå…¨ä¸ä¼šå¯¹ç”Ÿå­˜æ—¶é—´æ„æˆå½±å“ã€‚<strong>ä¸ºä¸€ä¸ªå¯¹è±¡è®¾ç½®è™šå¼•ç”¨å…³è”çš„å”¯ä¸€ç›®çš„å°±æ˜¯åœ¨è¿™ä¸ªå¯¹è±¡è¢«æ”¶é›†å™¨å›æ”¶æ—¶æ”¶åˆ°ä¸€ä¸ªç³»ç»Ÿé€šçŸ¥</strong>ã€‚Javaæä¾›äº†<code>PhantomReference</code>å®ç°è™šå¼•ç”¨ã€‚</li>
</ul>
<h3 data-id="heading-3">2.2.<strong>GC roots</strong></h3>
<p>GC Rootsï¼ˆGC æ ¹èŠ‚ç‚¹ï¼‰æ˜¯ JVM åƒåœ¾å›æ”¶å™¨ï¼ˆGCï¼‰åˆ¤æ–­å¯¹è±¡æ˜¯å¦ã€Œå¯è¾¾ã€çš„<strong>æ ¸å¿ƒèµ·ç‚¹</strong>ã€<strong>ç»å¯¹å­˜æ´»èµ·ç‚¹</strong>â€”â€”GC ä¼šä»è¿™äº›æ ¹èŠ‚ç‚¹å‡ºå‘ï¼Œéå†æ‰€æœ‰å¯è¾¾çš„å¯¹è±¡å¼•ç”¨é“¾ã€‚</p>
<p>åœ¨Javaä¸­ï¼Œå¯ä½œä¸º<code>GC Roots</code>çš„å¯¹è±¡åŒ…æ‹¬ç³»ç»Ÿæ ˆã€é™æ€å˜é‡ã€<code>Classloader</code>ã€JNI å…¨å±€å¼•ç”¨ã€æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹ç­‰ã€‚è¢«è¿™äº›æ ¹å¯è¾¾çš„å¯¹è±¡è¢«è§†ä¸ºâ€œæ´»ç€â€ã€‚</p>
<p>å½“ä¸€ä¸ªå¯¹è±¡åˆ°<code>GC Roots</code>æ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿æ—¶ï¼Œè¯¥å¯¹è±¡å°±æ˜¯ä¸å¯ç”¨çš„ï¼Œæ­¤æ—¶å°±ä¼šè¢«åˆ¤å®šä¸ºå¯å›æ”¶çš„å¯¹è±¡ã€‚è¿™å°±æ˜¯<code>Java</code>é‡‡ç”¨çš„<strong>å¯è¾¾æ€§åˆ†æç®—æ³•ã€‚</strong></p>
<h3 data-id="heading-4">2.3.<strong>ç”Ÿå‘½å‘¨æœŸé”™é…</strong></h3>
<p>ç”Ÿå‘½å‘¨æœŸé”™é…æŒ‡çš„æ˜¯ä¸€ä¸ª<strong>ç”Ÿå‘½å‘¨æœŸé•¿çš„å¯¹è±¡</strong>ï¼ˆå¦‚å•ä¾‹ã€é™æ€å˜é‡ã€åå°çº¿ç¨‹ï¼‰ä¸å¿…è¦åœ°æŒæœ‰äº†ä¸€ä¸ª<strong>ç”Ÿå‘½å‘¨æœŸçŸ­çš„å¯¹è±¡</strong>ï¼ˆå¦‚Activityã€Fragmentï¼‰çš„å¼•ç”¨ï¼Œå¯¼è‡´åè€…åœ¨å…¶æœ¬è¯¥è¢«é”€æ¯æ—¶æ— æ³•è¢«åƒåœ¾å›æ”¶å™¨ï¼ˆGCï¼‰å›æ”¶ï¼Œä»è€ŒæŒç»­å ç”¨å†…å­˜ã€‚</p>
<h2 data-id="heading-5">ä¸‰ã€å¸¸è§æ³„éœ²æ¨¡å¼</h2>
<p>ä¸‹é¢åˆ†æåœ¨å®é™…å¼€å‘ä¸­æœ€å¸¸è§çš„å‡ ç§å†…å­˜æ³„æ¼æƒ…å†µ</p>
<ol start="0">
<li>
<p><strong>Activity/Context æ³„éœ²ï¼ˆæœ€å¸¸è§ï¼‰</strong></p>
<p>åœ¨ Android å¼€å‘ä¸­ï¼ŒActivity æˆ– Context è¢«æ— æ„ä¸­æŒæœ‰è€Œå¯¼è‡´æ— æ³•è¢«åƒåœ¾å›æ”¶å™¨ï¼ˆGCï¼‰å›æ”¶ï¼Œæ˜¯æœ€å¸¸è§çš„å†…å­˜æ³„æ¼é—®é¢˜ä¹‹ä¸€ã€‚è¿™é€šå¸¸æ˜¯å› ä¸ºä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæ¯” Activity æ›´é•¿çš„å¯¹è±¡ï¼ŒæŒæœ‰äº†è¯¥ Activity çš„å¼•ç”¨ï¼Œä»è€Œé˜»ç¢äº†å…¶æ­£å¸¸é”€æ¯å’Œå›æ”¶ã€‚</p>
<p><strong>å•ä¾‹æ¨¡å¼å¯¼è‡´æ³„æ¼</strong>æ˜¯è¯¥æƒ…å†µä¸‹ç»å…¸çš„æ³„æ¼åœºæ™¯ï¼Œå•ä¾‹å¯¹è±¡é€šå¸¸éšåº”ç”¨è¿›ç¨‹ä¸€ç›´å­˜åœ¨ï¼Œå¦‚æœå®ƒé”™è¯¯åœ°æŒæœ‰äº†ä¸€ä¸ª Activity çš„ Contextï¼Œé‚£ä¹ˆè¿™ä¸ª Activity å³ä½¿è¢«å…³é—­ä¹Ÿæ— æ³•è¢«å›æ”¶ã€‚è¿™å°±æ˜¯å› ä¸ºActivity è¢« GC Roots å½¢æˆçš„å¼•ç”¨é“¾ â€œç»‘å®šâ€ï¼Œæ— æ³•è¢«æ ‡è®°ä¸ºå¯å›æ”¶ã€‚çœ‹ä¸‹é¢çš„ä»£ç </p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppSettings</span> {
 Â  Â <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">AppSettings</span> <span class="hljs-variable">sInstance</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AppSettings</span>();
 Â  Â <span class="hljs-keyword">private</span> Context mContext; 
 Â  Â 
 Â  Â <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setup</span><span class="hljs-params">(Context context)</span> {
 Â  Â  Â  Â <span class="hljs-built_in">this</span>.mContext = context; <span class="hljs-comment">// å¦‚æœä¼ å…¥çš„æ˜¯ Activity.thisï¼Œåˆ™å‘ç”Ÿæ³„æ¼</span>
 Â   }
}
</code></pre>
<p>å› æ­¤åœ¨å•ä¾‹æƒ…å†µä¸‹ï¼Œå°½é‡ä½¿ç”¨ç³»ç»Ÿçº§åˆ«çš„<code>context</code></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setup</span>(<span class="hljs-params">Context context</span>) {
 Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">mContext</span> = context.<span class="hljs-title function_">getApplicationContext</span>(); <span class="hljs-comment">// æ­£ç¡®ï¼šä½¿ç”¨åº”ç”¨çº§åˆ«çš„ Context</span>
}
</code></pre>
</li>
<li>
<p><strong>åŒ¿åå†…éƒ¨ç±» / éé™æ€å†…éƒ¨ç±»</strong></p>
<p>éé™æ€å†…éƒ¨ç±»ä¼šéšå¼æŒæœ‰å¤–éƒ¨ç±»å¼•ç”¨ï¼ˆä¾‹å¦‚ <code>new Runnable(){}</code> æŒæœ‰å¤–éƒ¨ Activityï¼‰ï¼Œå¦‚æœ <code>Runnable</code> è¢«å»¶è¿Ÿæ‰§è¡Œæˆ–æ”¾åˆ°æŒä¹…å®¹å™¨é‡Œå°±ä¼šæ³„éœ²å¤–éƒ¨ <code>Activity</code>ã€‚<code>kotliln</code>è¯­è¨€ä¸­åœ¨ä¸€ä¸ªç±»å†…éƒ¨å†å£°æ˜ä¸€ä¸ªç±»ï¼Œè¿™ä¸ªå†…éƒ¨çš„ç±»å°±è¢«è®¾è®¡åœ°åŒºåˆ«äºJavaçš„å†…éƒ¨ç±»ï¼Œç§°ä¸ºåµŒå¥—ç±»ï¼Œä¸æŒæœ‰å¤–éƒ¨ç±»å¼•ç”¨ï¼Œç±»ä¼¼<code>Java</code>ä¸­çš„é™æ€å†…éƒ¨ç±»ï¼Œè¿™ç§è®¾è®¡åŸå› å¾ˆå¤§æ–¹é¢å°±æ˜¯ä¸ºäº†é¿å…å†…å­˜æ³„æ¼ã€‚</p>
<p>ä¸¾ä¾‹ä¸‹é¢çš„ä»£ç ã€‚å¦‚æœåœ¨Activityé”€æ¯å‰æ²¡æœ‰å¤„ç†å®Œé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ï¼Œé‚£ä¹ˆå°±ä¼šé€ æˆå†…å­˜æ³„æ¼ã€‚å› ä¸º<code>Handler</code> åˆå§‹åŒ–æ—¶ä¼šé»˜è®¤å…³è”<strong>å½“å‰çº¿ç¨‹çš„ <code>Looper</code> å’Œ <code>MessageQueue</code></strong>ï¼ˆä¸»çº¿ç¨‹çš„ Looper éšåº”ç”¨è¿›ç¨‹ç”Ÿå‘½å‘¨æœŸå­˜åœ¨ï¼Œæ°¸ä¸é”€æ¯ï¼‰ï¼Œåªè¦ Handler çš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­è¿˜æœ‰æœªå¤„ç†çš„æ¶ˆæ¯ï¼Œ<code>Message</code> ä¼šæŒæœ‰ <code>Handler</code> çš„å¼•ç”¨ï¼Œè€Œ Handler åˆæŒæœ‰ Activity çš„å¼•ç”¨ï¼Œå¯¼è‡´ Activity æ— æ³•å›æ”¶ ã€‚</p>
<pre><code class="hljs language-scala" lang="scala">public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Activity</span> </span>{
 Â  Â <span class="hljs-keyword">private</span> <span class="hljs-type">Handler</span> mHandler = <span class="hljs-keyword">new</span> <span class="hljs-type">Handler</span>() { <span class="hljs-comment">// åŒ¿åå†…éƒ¨ç±»ï¼Œéšå¼æŒæœ‰ Activity å¼•ç”¨</span>
 Â  Â  Â  Â <span class="hljs-meta">@Override</span>
 Â  Â  Â  Â public void handleMessage(<span class="hljs-type">Message</span> msg) {
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// ... å¤„ç†æ¶ˆæ¯</span>
 Â  Â  Â   }
 Â   };
}
</code></pre>
<p>é’ˆå¯¹è¿™ç§æƒ…å†µæˆ‘ä»¬éœ€è¦åœ¨onDestroyä¸­ç§»é™¤æ‰€æœ‰çš„æ¶ˆæ¯å’Œå›è°ƒã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">protected</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">onDestroy</span>(<span class="hljs-params"/>) {
 Â  Â <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">onDestroy</span>();
 Â  Â mHandler.<span class="hljs-title function_">removeCallbacksAndMessages</span>(<span class="hljs-literal">null</span>); <span class="hljs-comment">// ç§»é™¤æ‰€æœ‰æ¶ˆæ¯å’Œå›è°ƒ</span>
}
</code></pre>
</li>
<li>
<p><strong>æœªæ³¨é”€çš„ç³»ç»Ÿå›è°ƒ</strong></p>
<p>è¿™ç§æƒ…å†µå’Œä¸Šé¢çš„åŒ¿åå†…éƒ¨ç±»ç±»ä¼¼ï¼Œä¾‹å¦‚ <code>BroadcastReceiver</code>ã€<code>ContentObserver</code>ã€<code>LocationListener</code>ã€<code>ViewTreeObserver</code> ç­‰æ²¡æœ‰åœ¨ <code>onDestroy</code>/<code>onStop</code> ä¸­ <code>unregister</code>ã€‚è¿™æ˜¯å› ä¸ºç³»ç»ŸæœåŠ¡ï¼ˆå¦‚ <code>SensorManager</code>ã€<code>LocationManager</code>ï¼‰æˆ–å…¨å±€ç»„ä»¶ï¼ˆå¦‚å¹¿æ’­ç®¡ç†å™¨ï¼‰é€šå¸¸å…·æœ‰ä¸åº”ç”¨ç¨‹åºè¿›ç¨‹ç›¸åŒçš„é•¿ç”Ÿå‘½å‘¨æœŸã€‚å½“æ‚¨åœ¨ Activity ä¸­æ³¨å†Œä¸€ä¸ªç›‘å¬å™¨æ—¶ï¼Œè¿™ä¸ªé•¿ç”Ÿå‘½å‘¨æœŸçš„æœåŠ¡ä¼šæŒæœ‰è¯¥ç›‘å¬å™¨çš„å¼•ç”¨ã€‚å¦‚æœè¿™ä¸ªç›‘å¬å™¨æ˜¯ Activity çš„éé™æ€å†…éƒ¨ç±»æˆ–åŒ¿åå†…éƒ¨ç±»ï¼Œå®ƒä¼šéšå¼æŒæœ‰å…¶å¤–éƒ¨ç±»ï¼ˆå³ Activityï¼‰çš„å¼ºå¼•ç”¨ã€‚</p>
</li>
</ol>
<h2 data-id="heading-6">å››ã€MVPæ¶æ„å†…å­˜æ³„æ¼å‰–æ</h2>
<p>æœ‰äº†å‰é¢çš„ç†è®ºåŸºç¡€ï¼Œæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹MVPæ¶æ„çš„å†…å­˜æ³„æ¼é—®é¢˜ã€‚</p>
<p>MVPæ¶æ„ä¸­Activity / Fragment æŒæœ‰ <code>Presenter</code>ï¼Œè€Œ<code>Presenter</code> æŒæœ‰ View æ¥å£ï¼ˆé€šå¸¸æ˜¯ Activityï¼‰ï¼Œä¹Ÿå°±æ˜¯<code>Activity â†’ Presenter â†’ Activity</code>å½¢æˆäº†å¼ºå¼•ç”¨ç¯ã€‚åªè¦å…¶ä¸­ä¸€ä¸ªåœ°æ–¹<strong>æ²¡æœ‰æ­£ç¡®æ–­å¼€</strong>ï¼Œ Activity å°±ç®—é€€å‡ºäº†ï¼ŒGC ä¹Ÿå›æ”¶ä¸äº† ï¼Œä¼šç›´æ¥å¯¼è‡´å†…å­˜æ³„æ¼ã€‚å› æ­¤MVPæ¶æ„å¤©ç”Ÿå®¹æ˜“å†…å­˜æ³„æ¼ã€‚æˆ‘ä»¬ä¸‹é¢å…·ä½“ä¸¾ä¸ªä¾‹å­ã€‚</p>
<p>è¿™æ˜¯På±‚ï¼Œé€šè¿‡æŒæœ‰çš„viewå¼•ç”¨å±•ç¤ºæ•°æ®ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainPresenter</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> view: MainContract.View) {
 Â  Â <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadData</span><span class="hljs-params">()</span></span> {
 Â  Â  Â  Â view.showLoading()
 Â   }
}
</code></pre>
<p>è€Œ<code>View</code>å±‚ï¼ˆ<code>MainActivity</code>ï¼‰é€šè¿‡<code>presenter = MainPresenter(this)</code>ä¹Ÿä¼šæŒæœ‰På±‚çš„å¼•ç”¨ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>(), MainContract.View {
â€‹
 Â  Â <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> presenter = MainPresenter(<span class="hljs-keyword">this</span>)
â€‹
 Â  Â <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onDestroy</span><span class="hljs-params">()</span></span> {
 Â  Â  Â  Â <span class="hljs-keyword">super</span>.onDestroy()
 Â  Â  Â  Â <span class="hljs-comment">// æ²¡æœ‰ presenter.detachView()</span>
 Â   }
}
â€‹
</code></pre>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹å½“Activityè¿˜å­˜åœ¨æ—¶ï¼Œ V å±‚è¢« P å±‚å¼ºå¼•ç”¨ï¼ŒP å±‚åˆè¢« V å±‚å¼ºå¼•ç”¨ ï¼Œå½¢æˆäº†å¼ºå¼•ç”¨ç¯ã€‚æˆ‘ä»¬ä¸Šé¢è®²äº†Javaçš„åƒåœ¾å›æ”¶ç”¨çš„æ˜¯<strong>å¯è¾¾æ€§åˆ†æç®—æ³•</strong>ï¼Œè¿™ç§ç®—æ³•å¯¹æ¯”å¼•ç”¨è®¡æ•°ç®—æ³•æ¥è¯´æ˜¯ä¸æ€•æˆç¯çš„ï¼Œä½†æ˜¯é—®é¢˜åœ¨äºï¼Œå¦‚æœPå±‚ä¸æŸä¸ªå­˜æ´»å¯¹è±¡å»ºç«‹äº†å…³ç³»ï¼ˆæ¯”å¦‚çº¿ç¨‹ï¼Œç›‘å¬å™¨ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ç­‰ï¼‰ï¼Œè¿™æ—¶ä¾¿ä¸ä¼šè¢«æ¸…é™¤ï¼ŒPå±‚å’ŒVå±‚ä¾¿ä¼šè¾¾åˆ°æ°¸ç”Ÿï¼Œé€ æˆäº†å†…å­˜æ³„æ¼ã€‚</p>
<p>å› æ­¤MVPæ¶æ„ä¸€å®šè¦æ³¨æ„æ¶æ„çš„å†™æ³•è§„èŒƒ</p>
<p>Presenterå±‚ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BasePresenter</span>&lt;<span class="hljs-type">V</span>&gt; {
â€‹
 Â  Â <span class="hljs-keyword">protected</span> <span class="hljs-keyword">var</span> view: V? = <span class="hljs-literal">null</span>
â€‹
 Â  Â <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">attachView</span><span class="hljs-params">(v: <span class="hljs-type">V</span>)</span></span> {
 Â  Â  Â  Â view = v
 Â   }
â€‹
 Â  Â <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">detachView</span><span class="hljs-params">()</span></span> {
 Â  Â  Â  Â view = <span class="hljs-literal">null</span>
 Â  Â  Â  Â onCleared()
 Â   }
â€‹
 Â  Â <span class="hljs-keyword">open</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCleared</span><span class="hljs-params">()</span></span> {}
}
â€‹
</code></pre>
<p>Activityå±‚ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(...)</span></span> {
 Â  Â presenter.attachView(<span class="hljs-keyword">this</span>)
}
â€‹
<span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onDestroy</span><span class="hljs-params">()</span></span> {
 Â  Â presenter.detachView()
 Â  Â <span class="hljs-keyword">super</span>.onDestroy()
}
â€‹
</code></pre>
<h2 data-id="heading-7">äº”ã€å†…å­˜æ³„éœ²çš„å‘ç°</h2>
<p>å°½ç®¡ç†Ÿæ‚‰äº†å†…å­˜æ³„éœ²ï¼Œä½†åœ¨å¼€å‘è¿‡ç¨‹ä¸­æˆ‘ä»¬ä»ä¸å¯é¿å…åœ°ä¼šå¶å°”å¤§æ„é€ æˆå†…å­˜æ³„æ¼ï¼Œè¿™æ–¹é¢æœ‰ä¸€äº›å·¥å…·å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç›‘æµ‹appçš„å†…å­˜é—®é¢˜ã€‚</p>
<p>1.<strong>Android Studioå†…ç½®çš„Memory Profiler</strong></p>
<p>è¿™æ˜¯æœ€æ ¸å¿ƒçš„å·¥å…·ã€‚å®ƒå¯ä»¥å®æ—¶æ˜¾ç¤ºåº”ç”¨çš„å†…å­˜ä½¿ç”¨é‡æ›²çº¿å›¾ï¼Œå¸®åŠ©ä½ è§‚å¯Ÿå†…å­˜çš„æ€»ä½“è¶‹åŠ¿ã€‚ä½ å¯ä»¥é€šè¿‡å®ƒ<strong>æ•è·å †è½¬å‚¨ (Heap Dump)</strong> ï¼Œè·å–æŸä¸ªæ—¶é—´ç‚¹å†…å­˜ä¸­æ‰€æœ‰å¯¹è±¡çš„å¿«ç…§ï¼Œä»è€Œåˆ†æå“ªäº›å¯¹è±¡å¯èƒ½è¢«ä¸å½“æŒæœ‰ ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜èƒ½<strong>è®°å½•å†…å­˜åˆ†é…æƒ…å†µ</strong>ï¼Œè¿½è¸ªå¯¹è±¡æ˜¯åœ¨å“ªéƒ¨åˆ†ä»£ç ä¸­è¢«åˆ›å»ºçš„ï¼Œè¿™å¯¹äºå®šä½æ³„æ¼æºå¤´éå¸¸æœ‰å¸®åŠ© ï¼Œå¦‚å›¾ï¼Œå¯¹Memory Usageè¿›è¡Œåˆ†æï¼Œå¦‚ä¸‹ä¸¤å›¾ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/17bd0c1e30654fb281d6f02f7bedacbb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ams5a2U5aSa55qE54K86YeR5pyv5biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765717263&amp;x-signature=8i7p2YnkQZwFKlDikKsrvL8LOag%3D" alt="å±å¹•æˆªå›¾ 2025-12-07 202757.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/669de7ebda78410788b766638a691ea6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ams5a2U5aSa55qE54K86YeR5pyv5biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765717263&amp;x-signature=24RZWwOtCdHY6uTDwSYspBNwmqI%3D" alt="å±å¹•æˆªå›¾ 2025-12-07 202827.png" loading="lazy"/></p>
<p>ä¸è¿‡æ³¨æ„ï¼ŒProfiler çš„ <code>Leaks</code> è®¡æ•°åªæ£€æµ‹ Activity/Fragment æ³„æ¼ï¼Œè€Œ App è¿˜å¯èƒ½å­˜åœ¨å…¶ä»–æ³„æ¼åœºæ™¯ï¼Œ<strong>æ™®é€šå¯¹è±¡æ³„æ¼</strong>ï¼šå¦‚å•ä¾‹æŒæœ‰å·¥å…·ç±»å¯¹è±¡ã€æœªæ¸…ç†çš„é›†åˆç¼“å­˜ï¼›<strong>ç³»ç»Ÿèµ„æºæ³„æ¼</strong>ï¼šå¦‚æœªå…³é—­çš„ Cursorã€æœªå›æ”¶çš„ Bitmapã€æœªæ³¨é”€çš„ç›‘å¬å™¨ï¼›<strong>çŸ­æœŸæ³„æ¼</strong>ï¼šå¦‚ Handler å»¶è¿Ÿæ¶ˆæ¯ç­‰</p>
<p><strong>2. è‡ªåŠ¨åŒ–æ£€æµ‹åº“ï¼šLeakCanary</strong></p>
<p>ä¸Šé¢ä»‹ç»çš„Profileræ¯•ç«Ÿæ˜¯ã€Œæ‰‹åŠ¨åˆ†æå·¥å…·ã€ï¼Œè€Œ <strong><code>LeakCanary</code> æ˜¯è‡ªåŠ¨æ£€æµ‹å†…å­˜æ³„æ¼çš„åº“</strong>ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨åŒ–åœ°æ£€æµ‹å†…å­˜æ³„æ¼ï¼Œå¤§å¤§æå‡äº†å¼€å‘æ•ˆç‡ ã€‚åªéœ€åœ¨é¡¹ç›®çš„ <code>build.gradle</code>æ–‡ä»¶ä¸­æ·»åŠ ä¾èµ–ï¼Œ<code>LeakCanary</code> å°±ä¼šè‡ªåŠ¨åœ¨åº”ç”¨è¿è¡Œæ—¶ç›‘æ§ Activity å’Œ Fragment ç­‰å¯¹è±¡ã€‚å½“è¿™äº›å¯¹è±¡æœ¬åº”è¢«å›æ”¶å´ä¾ç„¶å­˜æ´»æ—¶ï¼Œ<code>LeakCanary</code> ä¼šè§¦å‘å †è½¬å‚¨ï¼Œåˆ†ææ³„æ¼è½¨è¿¹ï¼Œå¹¶é€šè¿‡é€šçŸ¥æ æ¸…æ™°åœ°å±•ç¤ºå‡ºæ¥ï¼Œç›´æ¥å®šä½åˆ°æ³„æ¼çš„å¼•ç”¨é“¾ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">dependencies {
 Â  Â debugImplementation <span class="hljs-string">'com.squareup.leakcanary:leakcanary-android:2.10'</span>
}
</code></pre>
<p>ç¼–è¯‘å¹¶è¿è¡Œåº”ç”¨åï¼Œ<code>LeakCanary</code> ä¼šè‡ªåŠ¨åœ¨åå°å¯åŠ¨ã€‚å½“æ£€æµ‹åˆ°å†…å­˜æ³„æ¼æ—¶ï¼Œä¼šåœ¨é€šçŸ¥æ æ˜¾ç¤ºé€šçŸ¥ï¼Œç‚¹å‡»é€šçŸ¥å³å¯æŸ¥çœ‹è¯¦ç»†çš„æ³„æ¼åˆ†ææŠ¥å‘Šã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è®ºå‰ç«¯ç¬¬ä¸‰æ–¹åº“çš„æŠ€æœ¯é€‰å‹ â€”â€” ä»¥ Jodit Editor ä¸ºä¾‹]]></title>    <link>https://juejin.cn/post/7580606750291230771</link>    <guid>https://juejin.cn/post/7580606750291230771</guid>    <pubDate>2025-12-07T15:07:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580606750291230771" data-draft-id="7521314647523409959" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è®ºå‰ç«¯ç¬¬ä¸‰æ–¹åº“çš„æŠ€æœ¯é€‰å‹ â€”â€” ä»¥ Jodit Editor ä¸ºä¾‹"/> <meta itemprop="keywords" content="å‰ç«¯,å‰ç«¯å·¥ç¨‹åŒ–"/> <meta itemprop="datePublished" content="2025-12-07T15:07:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="RJiazhen"/> <meta itemprop="url" content="https://juejin.cn/user/3602479377818957"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è®ºå‰ç«¯ç¬¬ä¸‰æ–¹åº“çš„æŠ€æœ¯é€‰å‹ â€”â€” ä»¥ Jodit Editor ä¸ºä¾‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3602479377818957/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    RJiazhen
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T15:07:09.000Z" title="Sun Dec 07 2025 15:07:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»18åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">è®ºå‰ç«¯ç¬¬ä¸‰æ–¹åº“çš„æŠ€æœ¯é€‰å‹ â€”â€” ä»¥ Jodit Editor ä¸ºä¾‹</h2>
<p>è¿‘æœŸå¯¹ä¸€ä¸ªåå°é¡¹ç›®çš„<strong>å¯Œæ–‡æœ¬ç¼–è¾‘å™¨</strong>è¿›è¡Œäº†ä¸€æ¬¡æŠ€æœ¯å‡çº§ï¼Œè¿™ä¸€è¿‡ç¨‹ä¸­æ¶‰åŠåˆ°<strong>å‰æœŸçš„æŠ€æœ¯é€‰å‹</strong>å’Œå®é™…è½åœ°çš„<strong>é…ç½®å’Œä½¿ç”¨</strong>ï¼Œåœ¨è¿™ä¸€è¿‡ç¨‹ä¸­é¢‡æœ‰æ”¶è·ï¼Œéšå†³å®šæˆæ–‡è®°å½•ï¼Œæ±‡æ€»ç»éªŒã€‚</p>
<h3 data-id="heading-1">é—®é¢˜èƒŒæ™¯</h3>
<p>è¯¥é¡¹ç›®æ˜¯ä¸€ä¸ªå†…éƒ¨ç®¡ç†åå°ï¼Œä¸å¯¹å¤–å¼€æ”¾ï¼Œå¯Œæ–‡æœ¬ç¼–è¾‘å™¨åŠŸèƒ½çš„ä½¿ç”¨é¢‘ç‡å¹¶ä¸é«˜ï¼Œåªæ˜¯å¶å°”ç”¨æ¥ç¼–è¾‘ä¸€ä¸‹æ–‡ä»¶å†…å®¹ï¼Œå¯¹å¤æ‚æ ¼å¼æ²¡æœ‰è¦æ±‚ã€‚</p>
<p>è™½ç„¶æ²¡ä»€ä¹ˆå¤æ‚éœ€æ±‚ï¼ŒåŸæ¥ä½¿ç”¨çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.wangeditor.com%2Fv4%2F" target="_blank" title="https://www.wangeditor.com/v4/" ref="nofollow noopener noreferrer">wangEditor 4</a>å¯Œæ–‡æœ¬ç¼–è¾‘å™¨è¿˜æ˜¯æœ‰è¯¸å¤šä¸è¶³ä¹‹å¤„ï¼š</p>
<ol start="0">
<li>é€‰å®šæ–‡å­—è¿›è¡Œä¿®æ”¹æ ¼å¼æ—¶ï¼Œæ–‡å­—çš„é€‰ä¸­çŠ¶æ€ä¼šæ¶ˆå¤±ï¼›</li>
<li><strong>Word å†…å®¹ç²˜è´´åæ ¼å¼æœ‰é—®é¢˜</strong>ï¼›</li>
<li>æ— æ³•<strong>ä»¥æºä»£ç æ¨¡å¼ç¼–è¾‘</strong>å†…å®¹ï¼›</li>
<li>ä¸å¥½è¿›è¡Œ<strong>å®šåˆ¶åŒ–å¼€å‘</strong>ï¼›</li>
</ol>
<p>åŒæ—¶è€ƒè™‘åˆ°åç»­å¯èƒ½è¿˜éœ€è¦è¿›ä¸€æ­¥å¼€å‘ç›¸å…³åŠŸèƒ½ï¼Œå†³å®šå¯¹å¯Œæ–‡æœ¬ç¼–è¾‘å™¨è¿›è¡Œæ›´æ¢ã€‚</p>
<h3 data-id="heading-2">æŠ€æœ¯é€‰å‹</h3>
<p>åœ¨è‡ªå·±å¼€å§‹æ‰¾æ–°çš„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨å‰ï¼Œé¦–å…ˆæ˜¯å’¨è¯¢äº†å…¬å¸çš„å¤§å‰ç«¯å›¢é˜Ÿï¼Œçœ‹çœ‹æ˜¯å¦æœ‰å·²ç»é‡‡è´­çš„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œæˆ–æˆç†Ÿçš„è§£å†³æ–¹æ¡ˆã€‚å¦‚æœæœ‰ï¼Œé‚£å°±å’Œå…¬å¸ä¿æŒç»Ÿä¸€ï¼Œ<strong>é¿å…é‡å¤é€ è½®å­</strong>ã€‚</p>
<p>ä¸è¿‡ç»“è®ºæ˜¯å¹¶æ²¡æœ‰ï¼Œæ‰€ä»¥åªèƒ½è‡ªå·±å¼€å§‹åšå¯Œæ–‡æœ¬ç¼–è¾‘å™¨çš„æŠ€æœ¯é€‰å‹ã€‚</p>
<p>åŸºäºä½¿ç”¨åœºæ™¯ï¼Œç¡®å®šå¯Œæ–‡æœ¬ç¼–è¾‘å™¨éœ€è¦æ»¡è¶³ä»¥ä¸‹éœ€æ±‚ï¼š</p>
<ol start="0">
<li>èƒ½å¤Ÿ<strong>å…è´¹å•†ç”¨</strong>ï¼Œé¿å…å¯èƒ½çš„æ³•å¾‹é—®é¢˜ï¼ŒåŒæ—¶å› ä¸ºæ˜¯åå°é¡¹ç›®ä¸­ç®€å•ä½¿ç”¨çš„ï¼Œå°±ä¸è€ƒè™‘èµ°é‡‡è´­æµç¨‹äº†ï¼›</li>
<li>æ”¯æŒ<strong>ç²˜è´´ Word å†…å®¹</strong>æ—¶ä¿ç•™å¤§éƒ¨åˆ†æ ¼å¼ï¼›</li>
<li>èƒ½å¤Ÿè¦†ç›–æ—§ç¼–è¾‘å™¨çš„æ‰€æœ‰åŠŸèƒ½ï¼›</li>
<li>æ”¯æŒåŠŸèƒ½æ‰©å±•ï¼›</li>
<li>å­¦ä¹ æˆæœ¬ä½ã€æ–‡æ¡£å®Œå–„ï¼Œ<strong>ä¾¿äºåç»­ç»´æŠ¤</strong>ã€‚</li>
</ol>
<p>å¯Œæ–‡æœ¬ç¼–è¾‘å™¨å¾…é€‰åˆ—è¡¨ä¸»è¦å‚è€ƒæ˜é‡‘çš„æ–‡ç« â€”â€”<a href="https://juejin.cn/post/7434373084747333658" target="_blank" title="https://juejin.cn/post/7434373084747333658">ã€Šå¯Œæ–‡æœ¬é€‰å‹å¤ªéš¾äº†ï¼Œè°æ¥å¸®å¸®æˆ‘ï¼ã€‹</a>ï¼ŒåŒæ—¶å‡†å¤‡äº†ä¸€ä¸ª<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.corp.vipshop.com%2Ffile%2FkpoyYn4OVdrJuVOo%2F" target="_blank" title="https://docs.corp.vipshop.com/file/kpoyYn4OVdrJuVOo/" ref="nofollow noopener noreferrer"> Word æ–‡æ¡£æµ‹è¯•ç”¨ä¾‹</a>ï¼Œç”¨æ¥å¿«é€Ÿæµ‹è¯•å„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨å¯¹ Word æ ¼å¼çš„å…¼å®¹æƒ…å†µã€‚</p>
<p>æœ€åæµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š</p>





































































<table><thead><tr><th>å¯Œæ–‡æœ¬ç¼–è¾‘å™¨</th><th>å…è´¹å•†ç”¨</th><th>Word å†…å®¹ä¿ç•™æ ¼å¼</th><th>åŠŸèƒ½é½å…¨</th><th>åŠŸèƒ½æ‰©å±•</th><th>æ˜“ç»´æŠ¤æ€§</th></tr></thead><tbody><tr><td>TinyMCE</td><td>âŒ å…è´¹ç‰ˆä¸æ”¯æŒè‡ªæ‰˜ç®¡</td><td/><td/><td/><td/></tr><tr><td>Quill</td><td>âŒ å…è´¹ç‰ˆä¸æ”¯æŒè‡ªæ‰˜ç®¡</td><td/><td/><td/><td/></tr><tr><td>TinyMCE</td><td>âœ…</td><td>âœ…</td><td>âŒæ²¡æœ‰é»˜è®¤çš„åŠŸèƒ½èœå•ï¼Œéœ€è¦é€šè¿‡ç»„ä»¶ç³»ç»Ÿè‡ªè¡Œæ­å»ºï¼Œè¿‡äºå¤æ‚</td><td/><td/></tr><tr><td>Editor.js</td><td>âœ…</td><td>âŒ</td><td/><td/><td/></tr><tr><td>Slate</td><td>âœ…</td><td>âŒ</td><td/><td/><td/></tr><tr><td>lexical</td><td>âœ…</td><td>âœ…</td><td>âŒæ²¡æœ‰é»˜è®¤çš„åŠŸèƒ½èœå•ï¼Œéœ€è¦è‡ªè¡Œå°è£…æ­å»º</td><td>âœ…</td><td>âŒå°šæœªæ¨å‡º1.0 æ­£å¼ç‰ˆï¼Œä¸”å„ç§æ¦‚å¿µéå¸¸å¤æ‚ï¼Œå¯èƒ½å‡ºç°éš¾ä»¥è§£å†³çš„é—®é¢˜</td></tr><tr><td>Jodit Editor</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…æœ‰åŸºç¡€çš„æ–‡æ¡£ï¼ŒåŒæ—¶å…è´¹ç‰ˆçš„ä»“åº“æ˜¯å…¬å¼€çš„ï¼Œå¯ä»¥å‚è€ƒå…¶ä¸­çš„æºç å¼€å‘æ’ä»¶</td></tr></tbody></table>
<p>ä»è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œè¿™æ¬¡æŠ€æœ¯é€‰å‹æ—¶å¹¶<strong>æ²¡æœ‰å¯¹æ¯ä¸ªæŠ€æœ¯æ ˆéƒ½è¿›è¡Œäº†è¯¦å°½çš„è°ƒç ”</strong>ï¼Œè€Œæ˜¯åªè¦<strong>ç¨å¾®ä¸ç¬¦åˆæ¡ä»¶å°±ç›´æ¥æ’é™¤</strong>ã€‚è¿™æ ·åšæ˜¯ä¸ºäº†åŠ å¿«å¼€å‘æ•ˆç‡ï¼Œæ¯•ç«Ÿè¿™æ¬¡æŠ€æœ¯é€‰å‹åªé’ˆå¯¹è¿™ä¸€ä¸ªé¡¹ç›®ï¼Œæ²¡å¿…è¦æŠŠæ‰€æœ‰æŠ€æœ¯æ ˆçš„ä¼˜åŠ£éƒ½åˆ†ææ¸…æ¥šã€‚</p>
<h3 data-id="heading-3">Jodit Editor çš„é…ç½®å’Œä½¿ç”¨</h3>
<p>ç¡®å®šå¯Œæ–‡æœ¬ç¼–è¾‘å™¨ä½¿ç”¨çš„æŠ€æœ¯åï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ­£å¼ä½¿ç”¨äº†ã€‚ä¸»è¦å‚è€ƒèµ„æ–™åŒ…æ‹¬ï¼š</p>
<ul>
<li>Jodit Editor å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fxdsoft.net%2Fjodit%2Fdocs%2F" target="_blank" title="https://xdsoft.net/jodit/docs/" ref="nofollow noopener noreferrer">xdsoft.net/jodit/docs/</a></li>
<li>Jodit Editor Playgroundï¼ˆç”Ÿæˆé…ç½®ï¼‰ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fxdsoft.net%2Fjodit%2Fplay.html" target="_blank" title="https://xdsoft.net/jodit/play.html" ref="nofollow noopener noreferrer">xdsoft.net/jodit/play.â€¦</a></li>
<li>Jodit Editor å…è´¹ç‰ˆæºç ä»“åº“ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxdan%2Fjodit" target="_blank" title="https://github.com/xdan/jodit" ref="nofollow noopener noreferrer">github.com/xdan/jodit</a></li>
<li>Jodit React é›†æˆï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fjodit%2Fjodit-react" target="_blank" title="https://github.com/jodit/jodit-react" ref="nofollow noopener noreferrer">github.com/jodit/joditâ€¦</a></li>
</ul>
<h4 data-id="heading-4">Jodit Editor å­¦ä¹ å’Œå¼€å‘æ€è·¯</h4>
<p>ç”±äºä¹‹å‰æ²¡æœ‰ä½¿ç”¨ Jodit Editor çš„ç»éªŒï¼Œä¹Ÿæ²¡æœ‰å·²æœ‰çš„é¡¹ç›®å¯ä»¥ç›´æ¥å‚è€ƒï¼Œæ‰€ä»¥éœ€è¦<strong>è¾¹å­¦ä¹ è¾¹å¼€å‘</strong>ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸»è¦çš„å­¦ä¹ å’Œå¼€å‘æ€è·¯ï¼š</p>
<ol>
<li>åŸºç¡€é…ç½®å’Œå¼€å‘æ–¹æ³•ï¼Œå‚è€ƒ<strong>å®˜æ–¹æ–‡æ¡£</strong>å’Œ <strong>Playground</strong>ï¼›</li>
<li>å…¶æ¬¡å°±æ˜¯ç›´æ¥ä½¿ç”¨<strong>æœç´¢å¼•æ“</strong>æ‰¾è§£å†³æ–¹æ³•ï¼›</li>
<li>å¦‚æœä»¥ä¸‹ä¸¤ç§æ–¹æ³•éƒ½è§£å†³ä¸äº†é—®é¢˜ï¼Œå°±éœ€è¦å»<strong>ç¿»é˜…æºç </strong>ï¼Œæ‰¾<strong>ç±»ä¼¼çš„ä¾‹å­</strong>å»å‚è€ƒï¼ˆæ¯”å¦‚æ’ä»¶çš„å¼€å‘ï¼‰ï¼›</li>
<li>é™¤äº†ä»¥ä¸Šè¿™äº›ï¼Œå¼€å‘æ—¶å‚è€ƒ <strong>TS çš„ä»£ç æç¤ºå’Œç±»å‹æ£€æŸ¥</strong>ä¹Ÿå¯ä»¥è¾…åŠ©åˆ¤æ–­ã€‚</li>
</ol>
<h4 data-id="heading-5">Jodit Editor åŸºæœ¬æ¦‚å¿µ</h4>
<p>ä¾ç…§ä»¥ä¸Šæ–¹æ³•è¿›è¡Œå¼€å‘ï¼Œå¯ä»¥å¿«é€Ÿå¯¹ Jodit Editor å»ºç«‹èµ·ä»¥ä¸‹åŸºæœ¬æ¦‚å¿µï¼š</p>
<ol>
<li>é€šè¿‡ <strong><code>config</code> å‚æ•°</strong>å¯ä»¥å¯¹ç¼–è¾‘å™¨å„æ–¹é¢è¿›è¡Œå®šåˆ¶åŒ–ï¼ŒåŒ…æ‹¬æ ·å¼ã€å·¥å…·æ æŒ‰é’®ã€ç¦ç”¨çš„æ’ä»¶ç­‰ï¼Œè¯¦è§ <a href="https://link.juejin.cn?target=https%3A%2F%2Fxdsoft.net%2Fjodit%2Fdocs%2Foptions.html" target="_blank" title="https://xdsoft.net/jodit/docs/options.html" ref="nofollow noopener noreferrer">xdsoft.net/jodit/docs/â€¦</a> ï¼›</li>
<li>Jodit Editor <strong>é»˜è®¤å†…ç½®äº†å„ç§æ’ä»¶ï¼Œ</strong> å¯ä»¥é€šè¿‡ <code>config.disablePlugins</code> å‚æ•°ç¦ç”¨ï¼›</li>
<li>å†…ç½®çš„<strong>æ’ä»¶å¯ä»¥å®šåˆ¶åŒ–</strong>ï¼Œå®šåˆ¶çš„æ–¹å¼æ˜¯è®¾ç½® <code>config</code> ä¸­çš„å„é¡¹å‚æ•°ï¼›</li>
<li>Jodit React æä¾›äº†é€šè¿‡ <code>ref</code> å±æ€§è·å–<strong>ç¼–è¾‘å™¨å®ä¾‹</strong>çš„ APIï¼Œå¯ä»¥ç”¨æ¥å¯¹ç¼–è¾‘å™¨è¿›è¡Œå„ç§æ“ä½œï¼›</li>
<li>å½“å·²æœ‰é…ç½®é¡¹æ— æ³•æ»¡è¶³éœ€æ±‚æ—¶ï¼Œå¾€å¾€éœ€è¦<strong>å¼€å‘æ’ä»¶æ¥è¿›è¡Œæ·±åº¦å®šåˆ¶åŒ–</strong>ï¼Œæ’ä»¶çš„æ‰©å±•è‡ª Jodit Editor æä¾›çš„ <code>Plugin</code> ç±»ï¼Œå¯ä»¥æ³¨å†Œå„ä¸ª<strong>ç”Ÿå‘½å‘¨æœŸ</strong>äº‹ä»¶ï¼Œå¹¶ä¸”é€šè¿‡è¿™ä¸ªç±»æš´éœ²çš„ APIï¼Œä»¥åŠç›´æ¥<strong>è®¿é—®ç¼–è¾‘å™¨å®ä¾‹</strong>ï¼Œä»è€Œè¿›è¡Œå„ç§å®šåˆ¶åŒ–ï¼Œè¯¦è§ <a href="https://link.juejin.cn?target=https%3A%2F%2Fxdsoft.net%2Fjodit%2Fdocs%2Fclasses%2Fplugin.Plugin.html" target="_blank" title="https://xdsoft.net/jodit/docs/classes/plugin.Plugin.html" ref="nofollow noopener noreferrer">xdsoft.net/jodit/docs/â€¦</a>ã€‚</li>
</ol>
<h4 data-id="heading-6">ç¼–è¾‘å™¨åŸºç¡€å°è£…</h4>
<p>éµå¾ªå®˜æ–¹æ–‡æ¡£è¯´æ˜ï¼ŒåŒæ—¶å‚è€ƒæ—§ç‰ˆç¼–è¾‘å™¨çš„åŠŸèƒ½é…ç½®ï¼Œåˆ›å»ºä»¥ä¸‹æš´éœ² <code>value</code> å’Œ <code>onChange</code> æ¥å£çš„å—æ§ç»„ä»¶ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx">Â <span class="hljs-comment">/**
Â  * ç¼–è¾‘å™¨ç»„ä»¶
Â  * <span class="hljs-doctag">@author</span>: jason02.ruan
Â  * <span class="hljs-doctag">@date</span>: 2025-10-16 11:02:54
Â  **/</span>
Â <span class="hljs-keyword">import</span> <span class="hljs-title class_">JoditEditor</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'jodit-react'</span>;
Â <span class="hljs-keyword">import</span> { <span class="hljs-title class_">ComponentProps</span>, useMemo, useRef } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
Â â€‹
Â <span class="hljs-comment">/**
Â  * ç¼–è¾‘å™¨ç»„ä»¶
Â  * <span class="hljs-doctag">@description</span> æ³¨æ„ï¼Œèšç„¦ç¼–è¾‘å™¨åå¯èƒ½ä¼šå‡ºç°å‡­ç©ºå¢åŠ äº†ç©ºè¡Œï¼Œä½†æ˜¯åˆæ²¡æœ‰è§¦å‘ onChange çš„æƒ…å†µã€‚æ˜¯å› ä¸º jodit å†…éƒ¨çš„ä¼šå¯¹ç©ºå†…å®¹çš„ `&lt;p&gt;&lt;/p&gt;` è¿›è¡Œå¤„ç†ï¼Œåœ¨é‡Œé¢æ’å…¥ä¸€ä¸ª `&lt;br /&gt;` å…ƒç´ ï¼Œä½†æ²¡æœ‰è§¦å‘ onChangeã€‚
Â  *
Â  * å› ä¸ºè€ƒè™‘åˆ°å˜åŒ–ä¼šå¾ˆæ˜æ˜¾ï¼Œä½¿ç”¨è€…ä¼šæ³¨æ„åˆ°ï¼Œå¹¶åœ¨æäº¤å‰æ³¨æ„ï¼Œæ‰€ä»¥è¿™é‡Œæš‚æ—¶ä¸å¤„ç†ã€‚
Â  */</span>
Â <span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">Editor</span> = (<span class="hljs-params">{ value, onChange }: { value?: <span class="hljs-built_in">string</span>; onChange?: (value: <span class="hljs-built_in">string</span>) =&gt; <span class="hljs-built_in">void</span> }</span>) =&gt; {
Â  Â <span class="hljs-keyword">const</span> editor = useRef&lt;<span class="hljs-built_in">any</span>&gt;(<span class="hljs-literal">null</span>);
Â â€‹
Â  Â <span class="hljs-keyword">const</span> <span class="hljs-attr">config</span>: <span class="hljs-title class_">ComponentProps</span>&lt;<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">JoditEditor</span>&gt;[<span class="hljs-string">'config'</span>] = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> {
Â  Â  Â <span class="hljs-keyword">return</span> {
Â  Â  Â  Â <span class="hljs-attr">language</span>: <span class="hljs-string">'zh_cn'</span>,
Â  Â  Â  Â <span class="hljs-attr">height</span>: <span class="hljs-number">400</span>,
Â  Â  Â  Â <span class="hljs-comment">// ç¦ç”¨å…³äºã€äººå·¥æ™ºèƒ½åŠ©æ‰‹è¿™ä¸¤ä¸ªæ— ç”¨æ’ä»¶</span>
Â  Â  Â  Â <span class="hljs-comment">// ç¦ç”¨å›¾ç‰‡ã€è§†é¢‘ã€æ–‡ä»¶ã€å›¾ç‰‡å¤„ç†å™¨ã€å›¾ç‰‡å±æ€§è¿™å‡ ä¸ªæ’ä»¶ã€‚</span>
Â  Â  Â  Â <span class="hljs-attr">disablePlugins</span>: [<span class="hljs-string">'about'</span>, <span class="hljs-string">'ai-assistant'</span>, <span class="hljs-string">'image'</span>, <span class="hljs-string">'video'</span>, <span class="hljs-string">'file'</span>, <span class="hljs-string">'image-processor'</span>, <span class="hljs-string">'image-properties'</span>],
Â  Â  Â  Â <span class="hljs-attr">buttons</span>: [
Â  Â  Â  Â  Â <span class="hljs-string">'paragraph'</span>,
Â  Â  Â  Â  Â <span class="hljs-string">'bold'</span>,
Â  Â  Â  Â  Â <span class="hljs-string">'fontsize'</span>,
Â  Â  Â  Â  Â <span class="hljs-string">'italic'</span>,
Â  Â  Â  Â  Â <span class="hljs-string">'underline'</span>,
Â  Â  Â  Â  Â <span class="hljs-string">'strikethrough'</span>,
Â  Â  Â  Â  Â <span class="hljs-comment">// ä¹‹æ‰€ä»¥æ·»åŠ ä¸€ä¸ªç©ºçš„ indent ç»„ï¼Œæ˜¯å› ä¸º justify æ’ä»¶ä¼šé»˜è®¤æŠŠå¯¹é½æ–¹å¼æŒ‰é’®æ·»åŠ åˆ° indent ç»„ä¸­ï¼Œä¸ç„¶çš„è¯åªèƒ½è‡ªå·±å°è£…ä¸€ä¸ªå¯¹é½æ–¹å¼æŒ‰é’®åˆ—è¡¨</span>
Â  Â  Â  Â  Â <span class="hljs-comment">// è¯¦è§ https://xdsoft.net/jodit/docs/modules/plugins_justify.html</span>
Â  Â  Â  Â  Â <span class="hljs-comment">// https://xdsoft.net/jodit/docs/modules/plugins_indent.html</span>
Â  Â  Â  Â   {
Â  Â  Â  Â  Â  Â <span class="hljs-attr">group</span>: <span class="hljs-string">'indent'</span>,
Â  Â  Â  Â  Â  Â <span class="hljs-attr">buttons</span>: [],
Â  Â  Â  Â   },
Â  Â  Â  Â  Â <span class="hljs-string">'lineHeight'</span>,
Â  Â  Â  Â  Â <span class="hljs-string">'brush'</span>,
Â  Â  Â  Â  Â <span class="hljs-string">'link'</span>,
Â  Â  Â  Â  Â <span class="hljs-string">'ul'</span>,
Â  Â  Â  Â  Â <span class="hljs-string">'table'</span>,
Â  Â  Â  Â  Â <span class="hljs-string">'hr'</span>,
Â  Â  Â  Â  Â <span class="hljs-string">'undo'</span>,
Â  Â  Â  Â  Â <span class="hljs-string">'redo'</span>,
Â  Â  Â  Â  Â <span class="hljs-string">'source'</span>,
Â  Â  Â  Â  Â <span class="hljs-string">'fullsize'</span>,
Â  Â  Â   ],
Â  Â   };
Â   }, []);
Â â€‹
Â  Â <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">JoditEditor</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{editor}</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{onChange}</span> <span class="hljs-attr">config</span>=<span class="hljs-string">{config}</span> <span class="hljs-attr">tabIndex</span>=<span class="hljs-string">{1}</span> /&gt;</span></span>;
Â };
</code></pre>
<p>è¿™ä¸€ç‰ˆæœ¬çš„åŸºç¡€å°è£…ä¸»è¦å‚è€ƒäº†ä»¥ä¸‹å†…å®¹ï¼š</p>
<ol start="0">
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fxdsoft.net%2Fjodit%2Fplay.html" target="_blank" title="https://xdsoft.net/jodit/play.html" ref="nofollow noopener noreferrer">Jodit Editor Playground</a>ï¼šç”Ÿæˆé…ç½®å’Œæµ‹è¯•å„é…ç½®é¡¹ã€æ’ä»¶å¯¹åº”çš„åŠŸèƒ½ï¼›</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fxdsoft.net%2Fjodit%2Fdocs%2Fmodules%2Fplugins_justify.html" target="_blank" title="https://xdsoft.net/jodit/docs/modules/plugins_justify.html" ref="nofollow noopener noreferrer">Justify æ’ä»¶æ–‡æ¡£</a>ï¼šæŸ¥çœ‹å¯¹é½æŒ‰é’®ç›¸å…³è¯´æ˜ï¼›</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fxdsoft.net%2Fjodit%2Fdocs%2Fmodules%2Fplugins_justify.html" target="_blank" title="https://xdsoft.net/jodit/docs/modules/plugins_justify.html" ref="nofollow noopener noreferrer">Indent æ’ä»¶æ–‡æ¡£</a>ï¼šæŸ¥çœ‹ indentæŒ‰é’®ç»„ç›¸å…³è¯´æ˜ï¼›</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fxdsoft.net%2Fjodit%2Fdocs%2Fdocs%2Fbuttons.html" target="_blank" title="https://xdsoft.net/jodit/docs/docs/buttons.html" ref="nofollow noopener noreferrer">æŒ‰é’®ç³»ç»Ÿæ–‡æ¡£</a>ï¼šæŸ¥çœ‹æ–°å¢æŒ‰é’®ç›¸å…³è¯´æ˜ã€‚</li>
</ol>
<h4 data-id="heading-7">å…³é—­å·¥å…·æ å“åº”å¼å˜åŒ–</h4>
<p>å‚è€ƒ <a href="https://link.juejin.cn?target=https%3A%2F%2Fxdsoft.net%2Fjodit%2Fdocs%2Fmodules%2Fplugins_mobile.html" target="_blank" title="https://xdsoft.net/jodit/docs/modules/plugins_mobile.html" ref="nofollow noopener noreferrer">mobile æ’ä»¶æ–‡æ¡£</a>ï¼Œè®¾ç½® <code>toolbarAdaptive</code> ä¸º <code>false</code>ï¼Œé˜²æ­¢å› ä¸º<strong>å®½åº¦å˜å°å¯¼è‡´æŒ‰é’®å·¥å…·æ æŒ‰é’®è¢«æŠ˜å </strong>ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx">Â <span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">Editor</span> = (<span class="hljs-params">{ value, onChange }: { value?: <span class="hljs-built_in">string</span>; onChange?: (value: <span class="hljs-built_in">string</span>) =&gt; <span class="hljs-built_in">void</span> }</span>) =&gt; {
Â  Â <span class="hljs-keyword">const</span> <span class="hljs-attr">config</span>: <span class="hljs-title class_">ComponentProps</span>&lt;<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">JoditEditor</span>&gt;[<span class="hljs-string">'config'</span>] = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> {
Â  Â  Â <span class="hljs-keyword">return</span> {
Â  Â  Â  Â <span class="hljs-attr">toolbarAdaptive</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// å…³é—­å·¥å…·æ çš„å“åº”å¼å˜åŒ–</span>
Â  Â  Â  Â <span class="hljs-comment">// ...</span>
Â  Â   };
Â   }, []);
Â â€‹
Â  Â <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">JoditEditor</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{onChange}</span> <span class="hljs-attr">config</span>=<span class="hljs-string">{config}</span> /&gt;</span></span>;
Â };
</code></pre>
<h4 data-id="heading-8">é»˜è®¤æ¸…é™¤ Word ç²˜è´´å†…å®¹æ ¼å¼</h4>
<p>ç”±äºåç«¯ç”Ÿæˆ PDF åŠŸèƒ½å¯¹ Word æ ¼å¼å†…å®¹å¤„ç†æœ‰é—®é¢˜ï¼Œæ‰€ä»¥è®¾ç½®æ‰€æœ‰ Word å†…å®¹ç²˜è´´æ—¶éƒ½è¿›è¡Œæ ¼å¼æ¸…é™¤ã€‚</p>
<p>å‚è€ƒ <a href="https://link.juejin.cn?target=https%3A%2F%2Fxdsoft.net%2Fjodit%2Fdocs%2Fmodules%2Fplugins_paste_from_word.html" target="_blank" title="https://xdsoft.net/jodit/docs/modules/plugins_paste_from_word.html" ref="nofollow noopener noreferrer">Paste From Word æ’ä»¶æ–‡æ¡£</a>ï¼Œè®¾ç½®ä»¥ä¸‹é…ç½®é¡¹ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx">Â <span class="hljs-keyword">import</span> { <span class="hljs-title class_">Jodit</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'jodit-react'</span>;
Â â€‹
Â <span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">Editor</span> = (<span class="hljs-params">{ value, onChange }: { value?: <span class="hljs-built_in">string</span>; onChange?: (value: <span class="hljs-built_in">string</span>) =&gt; <span class="hljs-built_in">void</span> }</span>) =&gt; {
Â  Â <span class="hljs-keyword">const</span> <span class="hljs-attr">config</span>: <span class="hljs-title class_">ComponentProps</span>&lt;<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">JoditEditor</span>&gt;[<span class="hljs-string">'config'</span>] = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> {
Â  Â  Â <span class="hljs-keyword">return</span> {
Â  Â  Â  Â <span class="hljs-comment">// ä» word ç²˜è´´æ—¶ï¼Œä¸è¯¢é—®ç²˜è´´æ–¹å¼ï¼Œç›´æ¥ç²˜è´´ä¸ºçº¯å‡€çš„ HTML</span>
Â  Â  Â  Â <span class="hljs-comment">// å› ä¸ºåç«¯ç”Ÿæˆ pdf çš„åŠŸèƒ½æ— æ³•è¯†åˆ« Word æ ¼å¼ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥ç²˜è´´ä¸ºçº¯å‡€çš„ HTMLï¼Œåç»­å¦‚æœéœ€è¦æ”¯æŒ Word æ ¼å¼ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ word-content-processor æ’ä»¶ã€‚</span>
Â  Â  Â  Â <span class="hljs-attr">askBeforePasteFromWord</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// ç²˜è´´æ¥è‡ª Word çš„å†…å®¹æ—¶ä¸å†è¯¢é—®</span>
Â  Â  Â  Â <span class="hljs-attr">defaultActionOnPasteFromWord</span>: <span class="hljs-title class_">Jodit</span>.<span class="hljs-property">constants</span>.<span class="hljs-property">INSERT_AS_TEXT</span>, <span class="hljs-comment">// ç²˜è´´æ¥è‡ª Word çš„å†…å®¹æ—¶é»˜è®¤ç²˜è´´æ–¹å¼ä¸ºç²˜è´´ä¸ºçº¯å‡€çš„ HTML</span>
Â  Â  Â  Â <span class="hljs-comment">// ...</span>
Â  Â   };
Â   }, []);
Â â€‹
Â  Â <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">JoditEditor</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{onChange}</span> <span class="hljs-attr">config</span>=<span class="hljs-string">{config}</span> /&gt;</span></span>;
Â };
</code></pre>
<h4 data-id="heading-9">æ·»åŠ ç‚¹å‡»åå‡ºç° React ç»„ä»¶çš„æŒ‰é’®</h4>
<p>æ•ˆæœæ¼”ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cace5b2f957e4f9fb5da800b530c2748~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUkppYXpoZW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765724829&amp;x-signature=2NwoXnXqinkMz%2BxA9dpi8dV9%2F8E%3D" alt="Kapture 2025-12-05 at 20.14.48.gif" loading="lazy"/></p>
<p>ç°åœ¨å¸Œæœ›ä½¿ç”¨ <strong>Antd ç»„ä»¶åº“æä¾›çš„ <code>&lt;Select&gt;</code> ç»„ä»¶</strong> å®ç°ç‚¹å‡»å·¥å…·æ æŒ‰é’®åå‡ºç°ä¸€ä¸ª<strong>å¸¦æœç´¢åŠŸèƒ½çš„æ•°æ®æºé€‰æ‹©å™¨å¼¹çª—</strong>ã€‚</p>
<p>æ ¹æ®<a href="https://link.juejin.cn?target=https%3A%2F%2Fxdsoft.net%2Fjodit%2Fdocs%2Fdocs%2Fbuttons.html%23custom-button-template" target="_blank" title="https://xdsoft.net/jodit/docs/docs/buttons.html#custom-button-template" ref="nofollow noopener noreferrer">å®˜æ–¹æ–‡æ¡£</a>ï¼ŒæŒ‰é’®ç‚¹å‡»åå‡ºç°çš„ dom å…ƒç´ éœ€è¦é…ç½® <code>popup</code> å±æ€§è¿”å›ï¼ˆç‚¹å‡»æŒ‰é’®åä¼šæ‰§è¡Œ <code>popup</code> å±æ€§æ–¹æ³•ï¼Œç„¶å<strong>å°†è¿”å›çš„ dom å…ƒç´ æ˜¾ç¤ºåœ¨å¼¹çª—ä¸­</strong>ï¼‰ï¼Œä½†æ˜¯ React ç»„ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª<strong>æ¸²æŸ“å‡½æ•°</strong>ï¼Œå¹¶<strong>ä¸èƒ½ç›´æ¥è¿”å›åæ¸²æŸ“åˆ°å¼¹çª—ä¸­</strong>ã€‚</p>
<p>æ‰€ä»¥é€»è¾‘åº”è¯¥ä¸ºï¼š</p>
<ol>
<li><code>popup</code> å±æ€§è¿”å›ä¸€ä¸ªç›®æ ‡ dom å…ƒç´ æŒ‚è½½åœ¨å¼¹çª—å…ƒç´ ä¸­ï¼›</li>
<li>è§¦å‘ç»„ä»¶å‡½æ•°æ‰§è¡Œï¼Œä½¿ç”¨ <strong><code>createPortal()</code>æ–¹æ³•</strong>æŒ‚è½½ç»„ä»¶åˆ°è¿™ä¸ª dom å…ƒç´ ä¸­ã€‚</li>
</ol>
<p>ç”±äºç”Ÿæˆç›®æ ‡ dom å…ƒç´ çš„é€»è¾‘ï¼Œå’ŒæŒ‚è½½ç»„ä»¶çš„é€»è¾‘å­˜åœ¨å¼ºå…³è”ï¼Œæ‰€ä»¥å†³å®šå°è£…åœ¨ä¸€ä¸ªæ¨¡å—ä¸­ï¼Œä»¥é™ä½ç»´æŠ¤éš¾åº¦ã€‚</p>
<p>æ³¨ï¼š<strong>ä»¥ä¸‹å°è£…å½¢å¼å¹¶éæœ€ä½³å®è·µ</strong>ï¼Œå¯ä»¥æŠŠ <code>popupRef</code> æ”¹ä¸º stateï¼Œä»è€Œå»é™¤ <code>trigger</code>ï¼Œå…·ä½“è¯·å‚è€ƒ <a href="https://link.juejin.cn?target=https%3A%2F%2Fstackblitz.com%2F~%2Fgithub.com%2FRJiazhen%2Fcreate-portal-ref-demo" target="_blank" title="https://stackblitz.com/~/github.com/RJiazhen/create-portal-ref-demo" ref="nofollow noopener noreferrer">stackblitz.com/~/github.coâ€¦</a></p>
<p><code>src/AntdSelectWithRef.tsx</code>ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx">Â <span class="hljs-keyword">import</span> { <span class="hljs-title class_">Select</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">AntdSelect</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'antd'</span>;
Â <span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">ComponentProps</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
Â <span class="hljs-keyword">import</span> { useCallback, useEffect, useRef, useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
Â <span class="hljs-keyword">import</span> { createPortal } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom'</span>;
Â â€‹
Â <span class="hljs-comment">/**
Â  * Antd Select ç»„ä»¶ Hookï¼ˆä½¿ç”¨ ref ç‰ˆæœ¬ï¼‰
Â  *
Â  * æä¾›ä¸€ä¸ªåˆ›å»º Antd Select ç»„ä»¶çš„ dom å…ƒç´ å®¹å™¨çš„å‡½æ•°ï¼Œå½“è°ƒç”¨è¯¥å‡½æ•°åˆ›å»º dom å…ƒç´ å®¹å™¨åï¼Œ
Â  * ä¼šé€šè¿‡ createPortal å°† Antd Select ç»„ä»¶æ¸²æŸ“åˆ°è¯¥ dom å…ƒç´ å®¹å™¨ä¸­ã€‚
Â  *
Â  * ä¸ useAntdSelect çš„åŒºåˆ«ï¼š
Â  * - ä½¿ç”¨ useRef è€Œä¸æ˜¯ useState æ¥å­˜å‚¨ DOM å…ƒç´ å¼•ç”¨
Â  * - ä½¿ç”¨å•ç‹¬çš„ state ä½œä¸ºè§¦å‘é‡æ–°æ¸²æŸ“çš„å¼€å…³ï¼ˆå€¼æœ¬èº«æ²¡æœ‰å«ä¹‰ï¼‰
Â  *
Â  * <span class="hljs-doctag">@returns</span> åŒ…å« createElement æ–¹æ³•å’Œ Select ç»„ä»¶çš„å¯¹è±¡
Â  */</span>
Â <span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useAntdSelectWithRef</span>(<span class="hljs-params"/>) {
Â  Â <span class="hljs-comment">/** Antd å¼¹çª—çš„ dom å…ƒç´ å¼•ç”¨ï¼ˆä½¿ç”¨ ref å­˜å‚¨ï¼‰ */</span>
Â  Â <span class="hljs-keyword">const</span> popupRef = useRef&lt;<span class="hljs-title class_">HTMLElement</span> | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>);
Â â€‹
Â  Â <span class="hljs-comment">/** å•çº¯è§¦å‘é‡æ–°æ¸²æŸ“çš„å¼€å…³ï¼Œå€¼æœ¬èº«æ²¡æœ‰å…·ä½“å«ä¹‰ */</span>
Â  Â <span class="hljs-keyword">const</span> [trigger, setTrigger] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);
Â â€‹
Â  Â <span class="hljs-comment">/**
Â  Â  * åˆ›å»º Antd Select ç»„ä»¶çš„ dom å…ƒç´ 
Â  Â  * <span class="hljs-doctag">@returns</span> åˆ›å»ºçš„ HTMLElement
Â  Â  */</span>
Â  Â <span class="hljs-keyword">const</span> createElement = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">() =&gt;</span> {
Â  Â  Â <span class="hljs-keyword">const</span> popupContainer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
Â  Â  Â <span class="hljs-comment">// è®¾ç½®å¼¹çª—å®½é«˜ï¼Œä»¥ä¿è¯ Antd ç»„ä»¶æœ‰è¶³å¤Ÿçš„æ˜¾ç¤ºç©ºé—´</span>
Â  Â  Â popupContainer.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">'200px'</span>;
Â  Â  Â popupContainer.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-string">'300px'</span>;
Â  Â  Â popupRef.<span class="hljs-property">current</span> = popupContainer;
Â  Â  Â <span class="hljs-comment">// è§¦å‘é‡æ–°æ¸²æŸ“ï¼Œç„¶åç«‹å³é‡ç½®ï¼ˆå› ä¸ºæ— æ³•ç›‘å¬ DOM æ˜¯å¦è¢«å¸è½½ï¼‰</span>
Â  Â  Â <span class="hljs-title function_">setTrigger</span>(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> !prev);
Â  Â  Â <span class="hljs-keyword">return</span> popupContainer;
Â   }, []);
Â â€‹
Â  Â <span class="hljs-comment">/**
Â  Â  * Select ç»„ä»¶
Â  Â  *
Â  Â  * æ¥æ”¶å’Œ Antd çš„ Select ç»„ä»¶ç›¸åŒçš„ propsï¼Œå¹¶å°†å…¶æ¸²æŸ“åˆ° popupRef å¯¹åº”çš„ dom å…ƒç´ ä¸­ã€‚
Â  Â  * trigger çŠ¶æ€ä»…ç”¨äºè§¦å‘é‡æ–°æ¸²æŸ“ï¼Œå€¼æœ¬èº«æ²¡æœ‰å«ä¹‰ã€‚
Â  Â  */</span>
Â  Â <span class="hljs-keyword">const</span> <span class="hljs-title function_">Select</span> = (<span class="hljs-params">props: React.ComponentProps&lt;<span class="hljs-keyword">typeof</span> AntdSelect&gt;</span>) =&gt; {
Â  Â  Â <span class="hljs-keyword">const</span> <span class="hljs-attr">ref</span>: <span class="hljs-title class_">ComponentProps</span>&lt;<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">AntdSelect</span>&gt;[<span class="hljs-string">'ref'</span>] | <span class="hljs-literal">null</span> = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);
Â â€‹
Â  Â  Â <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
Â  Â  Â  Â ref.<span class="hljs-property">current</span>?.<span class="hljs-title function_">focus</span>();
Â  Â   }, []);
Â â€‹
Â  Â  Â <span class="hljs-comment">// å¦‚æœæ²¡æœ‰ DOM å…ƒç´ å¼•ç”¨ï¼Œè¿”å› null</span>
Â  Â  Â <span class="hljs-keyword">if</span> (!popupRef.<span class="hljs-property">current</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
Â â€‹
Â  Â  Â <span class="hljs-comment">// ä½¿ç”¨ createPortal å°†ç»„ä»¶æ¸²æŸ“åˆ° ref æŒ‡å‘çš„ DOM å…ƒç´ ä¸­</span>
Â  Â  Â <span class="hljs-comment">// è¯»å– trigger ä»¥ç¡®ä¿ç»„ä»¶èƒ½å“åº” createElement çš„è°ƒç”¨å¹¶é‡æ–°æ¸²æŸ“</span>
Â  Â  Â <span class="hljs-comment">// trigger çš„å€¼æœ¬èº«æ²¡æœ‰å«ä¹‰ï¼Œåªç”¨äºè§¦å‘é‡æ–°æ¸²æŸ“</span>
Â  Â  Â <span class="hljs-built_in">void</span> trigger;
Â â€‹
Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-title function_">createPortal</span>(
Â  Â  Â  Â &lt;<span class="hljs-title class_">AntdSelect</span>&lt;<span class="hljs-built_in">any</span>&gt;
Â  Â  Â  Â   <span class="hljs-comment">// è®¾ç½® dropdown çš„æ ·å¼ï¼Œé˜²æ­¢è¢« jodit editor çš„ popup é®æŒ¡</span>
Â  Â  Â  Â   styles={{
Â  Â  Â  Â  Â  Â <span class="hljs-attr">root</span>: {
Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">zIndex</span>: <span class="hljs-number">100000000</span>,
Â  Â  Â  Â  Â   },
Â  Â  Â  Â   }}
Â  Â  Â  Â   <span class="hljs-comment">// ç¡®ä¿ dropdown æ¸²æŸ“åœ¨å½“å‰å®¹å™¨ä¸­</span>
Â  Â  Â  Â   getPopupContainer={<span class="hljs-function">(<span class="hljs-params">triggerNode</span>) =&gt;</span> {
Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> triggerNode || <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>;
Â  Â  Â  Â   }}
Â  Â  Â  Â   <span class="hljs-comment">// æ‰‹åŠ¨è®¾ç½®å®½åº¦ï¼Œå› ä¸ºåªæœ‰åœ¨ form ä¸­æ—¶ï¼Œselect ç»„ä»¶æ‰ä¼šè®¾ç½® .ant-select-in-form-itemï¼Œç„¶åæ‰ä¼šé»˜è®¤è®¾ç½®å®½åº¦ä¸º 100%ã€‚å¦‚æœä¸è¿™ä¹ˆè®¾ç½®ï¼Œåˆ™å®½åº¦ä¸ä¼šè¢«è®¾ç½®ä¸ºçˆ¶å…ƒç´ çš„å®½åº¦</span>
Â  Â  Â  Â   style={{
Â  Â  Â  Â  Â  Â <span class="hljs-attr">width</span>: <span class="hljs-string">'100%'</span>,
Â  Â  Â  Â   }}
Â  Â  Â  Â   showSearch
Â  Â  Â  Â   <span class="hljs-comment">// è¿‡æ»¤é€‰é¡¹ï¼Œä¸ç„¶é»˜è®¤çš„ Select ç»„ä»¶è™½ç„¶æœ‰æœç´¢æ¡†ï¼Œä½†æ²¡æœ‰ä»»ä½•æœç´¢åŠŸèƒ½</span>
Â  Â  Â  Â   filterOption={<span class="hljs-function">(<span class="hljs-params">input, option</span>) =&gt;</span> {
Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> (
Â  Â  Â  Â  Â  Â  Â option?.<span class="hljs-property">label</span>
Â  Â  Â  Â  Â  Â  Â   ?.<span class="hljs-title function_">toString</span>()
Â  Â  Â  Â  Â  Â  Â   .<span class="hljs-title function_">toLowerCase</span>()
Â  Â  Â  Â  Â  Â  Â   .<span class="hljs-title function_">includes</span>(input?.<span class="hljs-title function_">toLowerCase</span>() || <span class="hljs-string">''</span>) || <span class="hljs-literal">false</span>
Â  Â  Â  Â  Â   );
Â  Â  Â  Â   }}
Â  Â  Â  Â   <span class="hljs-comment">// é»˜è®¤å±•å¼€ä¸‹æ‹‰åˆ—è¡¨</span>
Â  Â  Â  Â   open
Â  Â  Â  Â   ref={ref}
Â  Â  Â  Â   {...props}
Â  Â  Â   /&gt;,
Â  Â  Â   popupRef.<span class="hljs-property">current</span>,
Â  Â   );
Â   };
Â â€‹
Â   <span class="hljs-keyword">return</span> {
Â  Â  Â createElement,
Â  Â  Â <span class="hljs-title class_">Select</span>,
Â   };
Â }
Â â€‹
</code></pre>
<p>åœ¨ç¼–è¾‘å™¨ç»„ä»¶ä¸­ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx">Â <span class="hljs-keyword">import</span> <span class="hljs-title class_">JoditEditor</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'jodit-react'</span>;
Â <span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">IJodit</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'jodit/esm/types'</span>;
Â <span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">ComponentProps</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
Â <span class="hljs-keyword">import</span> { useMemo, useRef, useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
Â <span class="hljs-keyword">import</span> { useAntdSelectWithRef } <span class="hljs-keyword">from</span> <span class="hljs-string">'./AntdSelectWithRef'</span>;
Â <span class="hljs-keyword">import</span> <span class="hljs-string">'./App.css'</span>;
Â â€‹
Â <span class="hljs-comment">/**
Â  * ä¸»åº”ç”¨ç»„ä»¶
Â  * æ¼”ç¤ºä½¿ç”¨åŸç”Ÿ DOM æ–¹æ³•åˆ›å»ºå…ƒç´ ï¼Œå¹¶é€šè¿‡ Portal åœ¨å…ƒç´ ä¸­æ¸²æŸ“å†…å®¹
Â  */</span>
Â <span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
Â  Â <span class="hljs-comment">// ä½¿ç”¨å…ƒç´ å†…å®¹ç®¡ç† Hookï¼ˆuseRef ç‰ˆæœ¬ï¼‰</span>
Â  Â <span class="hljs-keyword">const</span> { <span class="hljs-attr">createElement</span>: createElementWithRef, <span class="hljs-title class_">Select</span>: <span class="hljs-title class_">SelectWithRef</span> } =
Â  Â  Â <span class="hljs-title function_">useAntdSelectWithRef</span>();
Â  Â <span class="hljs-comment">// åº”ç”¨æ ¹å…ƒç´ çš„å¼•ç”¨ï¼Œç”¨äºæŒ‚è½½æ–°åˆ›å»ºçš„å…ƒç´ </span>
Â  Â <span class="hljs-keyword">const</span> editorRef = useRef&lt;<span class="hljs-title class_">IJodit</span>&gt;(<span class="hljs-literal">null</span>);
Â â€‹
Â  Â <span class="hljs-keyword">const</span> <span class="hljs-attr">config</span>: <span class="hljs-title class_">ComponentProps</span>&lt;<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">JoditEditor</span>&gt;[<span class="hljs-string">'config'</span>] = <span class="hljs-title function_">useMemo</span>(
Â  Â   <span class="hljs-function">() =&gt;</span> ({
Â  Â  Â  Â <span class="hljs-attr">toolbarAdaptive</span>: <span class="hljs-literal">false</span>,
Â  Â  Â  Â <span class="hljs-attr">buttons</span>: [
Â  Â  Â  Â   {
Â  Â  Â  Â  Â  Â <span class="hljs-attr">name</span>: <span class="hljs-string">'antd-ref'</span>,
Â  Â  Â  Â  Â  Â <span class="hljs-attr">text</span>: <span class="hljs-string">'ç‚¹å‡»åå‡ºç°antdç»„ä»¶(refç‰ˆæœ¬)'</span>,
Â  Â  Â  Â  Â  Â <span class="hljs-attr">exec</span>: <span class="hljs-function">() =&gt;</span> {
Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
Â  Â  Â  Â  Â   },
Â  Â  Â  Â  Â  Â <span class="hljs-attr">popup</span>: <span class="hljs-function">() =&gt;</span> {
Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">const</span> element = <span class="hljs-title function_">createElementWithRef</span>();
Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> element;
Â  Â  Â  Â  Â   },
Â  Â  Â  Â   },
Â  Â  Â   ],
Â  Â   }),
Â  Â   [createElement, createElementWithRef],
Â   );
Â â€‹
Â  Â <span class="hljs-keyword">const</span> [value, setValue] = useState&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">''</span>);
Â â€‹
Â  Â <span class="hljs-keyword">return</span> (
Â  Â  Â <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"app-container"</span>&gt;</span>
Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">marginTop:</span> '<span class="hljs-attr">20px</span>' }}&gt;</span>
Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">JoditEditor</span>
Â  Â  Â  Â  Â  Â <span class="hljs-attr">ref</span>=<span class="hljs-string">{editorRef}</span>
Â  Â  Â  Â  Â  Â <span class="hljs-attr">config</span>=<span class="hljs-string">{config}</span>
Â  Â  Â  Â  Â  Â <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>
Â  Â  Â  Â  Â  Â <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(value)</span> =&gt;</span> {
Â  Â  Â  Â  Â  Â  Â setValue(value);
Â  Â  Â  Â  Â   }}
Â  Â  Â  Â  Â /&gt;
Â  Â  Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">SelectWithRef</span>
Â  Â  Â  Â  Â <span class="hljs-attr">options</span>=<span class="hljs-string">{Array.from({</span> <span class="hljs-attr">length:</span> <span class="hljs-attr">100</span> }, (<span class="hljs-attr">_</span>, <span class="hljs-attr">index</span>) =&gt;</span> ({
Â  Â  Â  Â  Â  Â label: `é€‰é¡¹(ref) ${index + 1}`,
Â  Â  Â  Â  Â  Â value: `option-ref-${index + 1}`,
Â  Â  Â  Â   }))}
Â  Â  Â  Â  Â onChange={(value) =&gt; {
Â  Â  Â  Â  Â  Â editorRef.current?.selection.insertHTML(value as string);
Â  Â  Â  Â   }}
Â  Â  Â  Â /&gt;
Â  Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
Â   );
Â }
Â â€‹
Â <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span>;
Â â€‹
</code></pre>
<p>è¿™ä¸€æ•´å¥—é€»è¾‘çš„æ ¸å¿ƒåœ¨äºä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ol start="0">
<li>åˆ©ç”¨ <code>useRef()</code> <strong>ç¼“å­˜å¼¹çª—å®¹å™¨ dom å…ƒç´ </strong>ï¼›</li>
<li>åˆ©ç”¨ <strong><code>createPortal()</code></strong> å°†ç»„ä»¶æ¸²æŸ“åˆ°å¼¹çª—å®¹å™¨ dom å…ƒç´ ä¸­ï¼›</li>
<li>åˆ©ç”¨åˆ›å»ºä¸€ä¸ª <strong>state</strong>ï¼Œç”¨æ¥<strong>è§¦å‘ <code>&lt;Select/&gt;</code> è¿™ä¸ªç»„ä»¶é‡æ–°æ¸²æŸ“</strong>ã€‚</li>
</ol>
<h4 data-id="heading-10">Word å†…å®¹å¤„ç†æ’ä»¶</h4>
<p>Jodit editor é»˜è®¤çš„å†…éƒ¨å¤„ç†é€»è¾‘å·²ç»å¯ä»¥ä¿ç•™å‡ ä¹æ‰€æœ‰çš„ Word æ ¼å¼ï¼Œä½†æ˜¯å¦‚æœè¿˜éœ€è¦å¯¹ç²˜è´´è‡ª Word çš„å†…å®¹è¿›è¡Œå®šåˆ¶åŒ–å¤„ç†ï¼Œåˆ™éœ€è¦è‡ªè¡Œåˆ¶ä½œæ’ä»¶ã€‚</p>
<p>è¯¥æ’ä»¶å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ol start="0">
<li>
<p>åœ¨<strong>ç²˜è´´æ¥è‡ª Word çš„å†…å®¹</strong>å’Œç¼–è¾‘å™¨å¤±å»ç„¦ç‚¹æ—¶ï¼Œæ‰§è¡Œä»¥ä¸‹æ ¼å¼åŒ–æ“ä½œï¼š</p>
<ol start="0">
<li><strong>æ¸…é™¤å­—ä½“æ ·å¼</strong>ã€‚éƒ¨åˆ† Word æ–‡æ¡£ä¼šä½¿ç”¨ç‰¹æ®Šå­—ä½“ï¼Œä½†å®é™…æœ€ç»ˆç”Ÿæˆ PDF æ—¶é»˜è®¤ä½¿ç”¨çš„æ˜¯å®‹ä½“ï¼Œæ¸…é™¤ä»¥é˜²æ­¢ç¼–è¾‘å™¨æ•ˆæœå’Œ PDF æ•ˆæœæœ‰å†²çªï¼ˆå…¶å®è®¾ç½®æ ¹å…ƒç´ å­—ä½“ä¸ºå®‹ä½“ä¼šæ›´å¥½ï¼‰ï¼›</li>
<li><strong>æ¸…é™¤ <code>mso-</code> å¼€å¤´çš„ CSS å±æ€§</strong>ã€‚è¿™äº›å±æ€§æ˜¯ Office ä¸“ç”¨çš„ï¼Œæµè§ˆå™¨ä¸è¯†åˆ«ï¼Œæ•…æ¸…é™¤ï¼›</li>
<li><strong>è½¬æ¢ <code>&lt;br&gt;</code> å’Œ <code>&lt;hr&gt;</code> æ ‡ç­¾</strong>ã€‚å°† <code>&lt;br&gt;</code> è½¬æ¢ä¸º <code>&lt;br/&gt;</code>ï¼Œå°† <code>&lt;hr&gt;</code> è½¬æ¢ä¸º <code>&lt;hr/&gt;</code>ï¼Œä»¥é˜²æ­¢ç”Ÿæˆ PDF åŠŸèƒ½ä¸è¯†åˆ«è¿™ç±»æ ‡ç­¾ï¼›</li>
<li><strong>åˆ é™¤ <code>&lt;o:p&gt;</code> æ ‡ç­¾</strong>ã€‚Office ä¸“å±æ ‡ç­¾ï¼Œæµè§ˆå™¨ä¸è¯†åˆ«ï¼Œæ•…åˆ é™¤ï¼›</li>
<li><strong>å°†åŒ…å« <code>name="OLE_LINK"</code> çš„ <code>&lt;a&gt;</code> æ ‡ç­¾æ›¿æ¢ä¸º <code>&lt;span&gt;</code> æ ‡ç­¾</strong>ã€‚è¿™ç§ <code>&lt;a&gt;</code> æ ‡ç­¾ä¸æ˜¯æ­£å¸¸ç¼–å†™çš„é“¾æ¥ï¼Œè€Œæ˜¯ä» Word ç²˜è´´æ—¶è‡ªåŠ¨æ·»åŠ çš„ï¼Œæ•…åˆ é™¤ï¼›</li>
<li>å¯¹ç¼–è¾‘å™¨å†…å®¹<strong>è¿›è¡Œ HTML å‹ç¼©</strong>ã€‚ä»¥å‡å°‘ç”Ÿæˆ PDF åŠŸèƒ½å› ä¸ºç©ºæ ¼å’Œç©ºè¡Œç”Ÿæˆå‡ºé”™çš„å¯èƒ½ï¼›</li>
</ol>
</li>
<li>
<p>å¯¼å‡ºæ ¼å¼åŒ–æ“ä½œçº¯å‡½æ•°ï¼Œæ”¯æŒåœ¨å…¶ä»–æ¨¡å—ä¸­å•ç‹¬è°ƒç”¨ã€‚</p>
</li>
</ol>
<p>æ’ä»¶å…·ä½“å®ç°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">Â <span class="hljs-comment">/*
Â  * Jodit Editor (https://xdsoft.net/jodit/)
Â  * Released under MIT see LICENSE.txt in the project root for license information.
Â  * Copyright (c) 2013-2025 Valeriy Chupurnov. All rights reserved. https://xdsoft.net
Â  */</span>
Â â€‹
Â <span class="hljs-comment">/**
Â  * Word å†…å®¹å¤„ç†æ’ä»¶
Â  * æä¾›ä» Word ç²˜è´´å†…å®¹çš„å¤„ç†å’Œè‡ªå®šä¹‰æ ¼å¼åŒ–åŠŸèƒ½
Â  * <span class="hljs-doctag">@packageDocumentation</span>
Â  * <span class="hljs-doctag">@module</span> plugins/word-content-processor
Â  */</span>
Â â€‹
Â <span class="hljs-keyword">import</span> { <span class="hljs-variable constant_">INSERT_AS_HTML</span>, <span class="hljs-variable constant_">INSERT_AS_TEXT</span>, <span class="hljs-variable constant_">INSERT_ONLY_TEXT</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'jodit/esm/core/constants'</span>;
Â <span class="hljs-keyword">import</span> { applyStyles, cleanFromWord, isHtmlFromWord, isString, stripTags } <span class="hljs-keyword">from</span> <span class="hljs-string">'jodit/esm/core/helpers'</span>;
Â <span class="hljs-keyword">import</span> { <span class="hljs-title class_">Plugin</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'jodit/esm/core/plugin'</span>;
Â <span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">PastedData</span>, <span class="hljs-title class_">PasteEvent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'jodit/esm/plugins/paste/interface'</span>;
Â <span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">IJodit</span>, <span class="hljs-title class_">InsertMode</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'jodit/esm/types'</span>;
Â â€‹
Â <span class="hljs-keyword">import</span> { askInsertTypeDialog, pasteInsertHtml } <span class="hljs-keyword">from</span> <span class="hljs-string">'jodit/esm/plugins/paste/helpers'</span>;
Â <span class="hljs-keyword">import</span> { minify } <span class="hljs-keyword">from</span> <span class="hljs-string">'html-minifier-terser'</span>;
Â <span class="hljs-keyword">import</span> { watch } <span class="hljs-keyword">from</span> <span class="hljs-string">'jodit/esm/core/decorators'</span>;
Â â€‹
Â <span class="hljs-comment">/** æ ¼å¼åŒ– html å­—ç¬¦ä¸²æ–¹æ³• */</span>
Â <span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">formatHtmlFromWord</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">htmlStr: <span class="hljs-built_in">string</span></span>) =&gt; {
Â  Â  Â <span class="hljs-comment">// ...</span>
Â };
Â â€‹
Â <span class="hljs-comment">/** é…ç½®ç±»å‹ */</span>
Â <span class="hljs-keyword">type</span> <span class="hljs-title class_">Config</span> = {
Â  Â <span class="hljs-comment">/** æ˜¯å¦åœ¨ onBlur äº‹ä»¶ä¸­è°ƒç”¨ formatHtmlFromWord æ–¹æ³•å¤„ç†ç²˜è´´çš„å†…å®¹ */</span>
Â  Â isFormatHtmlFromWordOnBlur?: <span class="hljs-built_in">boolean</span>;
Â  Â <span class="hljs-comment">/** æ ¼å¼åŒ–ä» word ä¸­å¤åˆ¶çš„å†…å®¹çš„é€»è¾‘ */</span>
Â  Â formatHtmlFromWord?: <span class="hljs-function">(<span class="hljs-params">html: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span>&gt; | <span class="hljs-built_in">string</span>;
Â };
Â â€‹
Â <span class="hljs-comment">/** é»˜è®¤é…ç½® */</span>
Â <span class="hljs-keyword">const</span> <span class="hljs-attr">defaultConfig</span>: <span class="hljs-title class_">Config</span> = {
Â  Â <span class="hljs-attr">isFormatHtmlFromWordOnBlur</span>: <span class="hljs-literal">true</span>,
Â  Â formatHtmlFromWord,
Â };
Â â€‹
Â <span class="hljs-comment">/**
Â  * Word å†…å®¹å¤„ç†æ’ä»¶çš„å·¥å‚å‡½æ•°
Â  *
Â  * åŸºäºåŸ paste-from-word æ’ä»¶è¿›è¡Œæ”¹é€ ï¼Œä½¿ç”¨è¯¥æ’ä»¶æ—¶éœ€è¦**ç¦ç”¨ paste-from-word æ’ä»¶**ï¼Œå¦åˆ™ä¼šå‡ºç°ç²˜è´´ä¸¤æ¬¡çš„æƒ…å†µã€‚
Â  *
Â  * æœ¬æ’ä»¶å¢åŠ äº†ä»¥ä¸‹åŠŸèƒ½ï¼š
Â  * 1. å¤„ç†ä» Word ç²˜è´´çš„å†…å®¹
Â  * 2. æä¾›è‡ªå®šä¹‰çš„ Word å†…å®¹æ ¼å¼åŒ–é€»è¾‘
Â  */</span>
Â <span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">createWordContentProcessor</span> = (<span class="hljs-params">config: Config = {}</span>) =&gt; {
Â  Â <span class="hljs-comment">/** å½’ä¸€åŒ–åçš„é…ç½® */</span>
Â  Â <span class="hljs-keyword">const</span> normalizedConfig = { ...defaultConfig, ...config };
Â  Â <span class="hljs-keyword">class</span> <span class="hljs-title class_">WordContentProcessor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Plugin</span> {
Â  Â  Â <span class="hljs-keyword">static</span> <span class="hljs-keyword">override</span> requires = [<span class="hljs-string">'paste'</span>];
Â â€‹
Â  Â  Â <span class="hljs-title function_">init</span>(<span class="hljs-attr">jodit</span>: <span class="hljs-title class_">IJodit</span>): <span class="hljs-built_in">void</span> {
Â  Â  Â  Â normalizedConfig.<span class="hljs-property">isFormatHtmlFromWordOnBlur</span> &amp;&amp;
Â  Â  Â  Â  Â jodit.<span class="hljs-property">events</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'blur'</span>, <span class="hljs-keyword">async</span> () =&gt; {
Â  Â  Â  Â  Â  Â <span class="hljs-keyword">const</span> content = jodit.<span class="hljs-title function_">getEditorValue</span>();
Â  Â  Â  Â  Â  Â <span class="hljs-keyword">const</span> formattedHtml = <span class="hljs-keyword">await</span> <span class="hljs-title function_">formatHtmlFromWord</span>(content);
Â  Â  Â  Â  Â  Â jodit.<span class="hljs-title function_">setEditorValue</span>(formattedHtml);
Â  Â  Â  Â   });
Â  Â   }
Â â€‹
Â  Â  Â <span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-title function_">afterInit</span>(<span class="hljs-params">jodit: IJodit</span>) {}
Â  Â  Â <span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-title function_">beforeDestruct</span>(<span class="hljs-params">jodit: IJodit</span>) {}
Â â€‹
Â  Â  Â <span class="hljs-comment">/**
Â  Â  Â  * å¤„ç†æ¥è‡ª Word çš„ HTML å†…å®¹
Â  Â  Â  * <span class="hljs-doctag">@param</span> <span class="hljs-variable">e</span> - ç²˜è´´äº‹ä»¶å¯¹è±¡
Â  Â  Â  * <span class="hljs-doctag">@param</span> <span class="hljs-variable">text</span> - è¢«ç²˜è´´çš„æ–‡æœ¬å†…å®¹
Â  Â  Â  * <span class="hljs-doctag">@param</span> <span class="hljs-variable">texts</span> - ç²˜è´´æ•°æ®çš„è¯¦ç»†å†…å®¹
Â  Â  Â  * <span class="hljs-doctag">@returns</span> æ˜¯å¦å¤„ç†äº† Word çš„ HTML å†…å®¹
Â  Â  Â  */</span>
Â  Â  Â <span class="hljs-meta">@watch</span>([<span class="hljs-string">':processHTML'</span>])
Â  Â  Â <span class="hljs-keyword">protected</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">processWordHTML</span>(<span class="hljs-params">e: PasteEvent, text: <span class="hljs-built_in">string</span>, texts: PastedData</span>) {
Â  Â  Â  Â <span class="hljs-keyword">const</span> { jodit } = <span class="hljs-variable language_">this</span>;
Â  Â  Â  Â <span class="hljs-keyword">const</span> { processPasteFromWord, askBeforePasteFromWord, defaultActionOnPasteFromWord, defaultActionOnPaste, pasteFromWordActionList } = jodit.<span class="hljs-property">options</span>;
Â â€‹
Â  Â  Â  Â <span class="hljs-keyword">if</span> (processPasteFromWord &amp;&amp; <span class="hljs-title function_">isHtmlFromWord</span>(text)) {
Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> (askBeforePasteFromWord) {
Â  Â  Â  Â  Â  Â <span class="hljs-title function_">askInsertTypeDialog</span>(
Â  Â  Â  Â  Â  Â  Â jodit,
Â  Â  Â  Â  Â  Â  Â <span class="hljs-string">'The pasted content is coming from a Microsoft Word/Excel document. '</span> + <span class="hljs-string">'Do you want to keep the format or clean it up?'</span>,
Â  Â  Â  Â  Â  Â  Â <span class="hljs-string">'Word Paste Detected'</span>,
Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">async</span> (insertType) =&gt; {
Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">insertFromWordByType</span>(e, text, insertType, texts);
Â  Â  Â  Â  Â  Â   },
Â  Â  Â  Â  Â  Â  Â pasteFromWordActionList
Â  Â  Â  Â  Â   );
Â  Â  Â  Â   } <span class="hljs-keyword">else</span> {
Â  Â  Â  Â  Â  Â <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">insertFromWordByType</span>(e, text, defaultActionOnPasteFromWord || defaultActionOnPaste, texts);
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
Â  Â  Â   }
Â â€‹
Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
Â  Â   }
Â â€‹
Â  Â  Â <span class="hljs-comment">/**
Â  Â  Â  * æ ¹æ®æ’å…¥æ¨¡å¼æ¸…ç† Word å†…å®¹çš„é¢å¤–æ ·å¼å’Œæ ‡ç­¾
Â  Â  Â  */</span>
Â  Â  Â <span class="hljs-keyword">protected</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">insertFromWordByType</span>(<span class="hljs-attr">e</span>: <span class="hljs-title class_">PasteEvent</span>, <span class="hljs-attr">html</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">insertType</span>: <span class="hljs-title class_">InsertMode</span>, <span class="hljs-attr">texts</span>: <span class="hljs-title class_">PastedData</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
Â  Â  Â  Â <span class="hljs-keyword">switch</span> (insertType) {
Â  Â  Â  Â  Â <span class="hljs-keyword">case</span> <span class="hljs-attr">INSERT_AS_HTML</span>: {
Â  Â  Â  Â  Â  Â html = <span class="hljs-title function_">applyStyles</span>(html);
Â â€‹
Â  Â  Â  Â  Â  Â <span class="hljs-comment">// å…ˆå’ŒåŸæ’ä»¶ä¿æŒä¸€è‡´ï¼Œå…ˆç»è¿‡ beautifyHTML äº‹ä»¶å¤„ç†</span>
Â  Â  Â  Â  Â  Â <span class="hljs-keyword">const</span> value = <span class="hljs-variable language_">this</span>.<span class="hljs-property">j</span>.<span class="hljs-property">events</span>?.<span class="hljs-title function_">fire</span>(<span class="hljs-string">'beautifyHTML'</span>, html);
Â â€‹
Â  Â  Â  Â  Â  Â <span class="hljs-comment">// å½“ config.formatHtmlFromWord å­˜åœ¨æ—¶ï¼Œä½¿ç”¨ config.formatHtmlFromWord å¤„ç†ï¼Œå¦åˆ™ä½¿ç”¨é»˜è®¤çš„ formatHtmlFromWord å¤„ç†</span>
Â  Â  Â  Â  Â  Â <span class="hljs-comment">/** ç»è¿‡pasteFromWordäº‹ä»¶å¤„ç†åçš„å€¼ */</span>
Â  Â  Â  Â  Â  Â <span class="hljs-keyword">const</span> afterPasteFromWord = <span class="hljs-keyword">await</span> normalizedConfig.<span class="hljs-property">formatHtmlFromWord</span>?.(value);
Â â€‹
Â  Â  Â  Â  Â  Â html = afterPasteFromWord || <span class="hljs-string">''</span>;
Â â€‹
Â  Â  Â  Â  Â  Â <span class="hljs-keyword">break</span>;
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â <span class="hljs-keyword">case</span> <span class="hljs-attr">INSERT_AS_TEXT</span>: {
Â  Â  Â  Â  Â  Â html = <span class="hljs-title function_">cleanFromWord</span>(html);
Â  Â  Â  Â  Â  Â <span class="hljs-keyword">break</span>;
Â  Â  Â  Â   }
Â â€‹
Â  Â  Â  Â  Â <span class="hljs-keyword">case</span> <span class="hljs-attr">INSERT_ONLY_TEXT</span>: {
Â  Â  Â  Â  Â  Â html = <span class="hljs-title function_">stripTags</span>(<span class="hljs-title function_">cleanFromWord</span>(html));
Â  Â  Â  Â  Â  Â <span class="hljs-keyword">break</span>;
Â  Â  Â  Â   }
Â  Â  Â   }
Â â€‹
Â  Â  Â  Â <span class="hljs-title function_">pasteInsertHtml</span>(e, <span class="hljs-variable language_">this</span>.<span class="hljs-property">j</span>, html);
Â  Â   }
Â   }
Â â€‹
Â  Â <span class="hljs-keyword">return</span> <span class="hljs-title class_">WordContentProcessor</span>;
Â };
</code></pre>
<p>å…¶ä¸­çš„æ ¸å¿ƒ <code>formatHtmlFromWord()</code> å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">Â <span class="hljs-comment">/** æ ¼å¼åŒ– html å­—ç¬¦ä¸²æ–¹æ³• */</span>
Â <span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">formatHtmlFromWord</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">htmlStr: <span class="hljs-built_in">string</span></span>) =&gt; {
Â  Â <span class="hljs-comment">/** ä¸€ä¸ªä¸´æ—¶ div å…ƒç´ ï¼Œç”¨æ¥å¯¹ html è¿›è¡Œå¤„ç† */</span>
Â  Â <span class="hljs-keyword">const</span> temp = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
Â  Â temp.<span class="hljs-property">innerHTML</span> = htmlStr;
Â  Â temp.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'[style]'</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">el</span>) =&gt;</span> {
Â  Â  Â <span class="hljs-keyword">const</span> element = el <span class="hljs-keyword">as</span> <span class="hljs-title class_">HTMLElement</span>;
Â â€‹
Â  Â  Â <span class="hljs-comment">// å¦‚æœ font-family ä¸æ˜¯ Wingdings åˆ™å°† font-family è®¾ç½®ä¸º initial</span>
Â  Â  Â <span class="hljs-comment">// å› ä¸º Wingdings æ˜¯ word ä¸­é»˜è®¤çš„ç¬¦å·å­—ä½“ï¼Œåœ¨ç”Ÿæˆæ— åºåˆ—è¡¨æ—¶ï¼Œä¼šä½¿ç”¨è¿™ç§å­—ä½“ä½œä¸ºæ ‡è®°ï¼Œæ‰€ä»¥ä¸èƒ½ä¿®æ”¹</span>
Â  Â  Â <span class="hljs-comment">// è€Œä¹‹æ‰€ä»¥ä¸ä½¿ç”¨ removeProperty æ–¹æ³•ï¼Œæ˜¯å› ä¸ºå¯èƒ½å‡ºç°ç»§æ‰¿è‡ªçˆ¶å…ƒç´ çš„ font-family å±æ€§çš„æƒ…å†µï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ initial æ¥é‡ç½®</span>
Â  Â  Â <span class="hljs-keyword">if</span> (element.<span class="hljs-property">style</span>.<span class="hljs-property">fontFamily</span> !== <span class="hljs-string">'Wingdings'</span>) {
Â  Â  Â  Â element.<span class="hljs-property">style</span>.<span class="hljs-property">fontFamily</span> = <span class="hljs-string">'initial'</span>;
Â  Â   }
Â â€‹
Â  Â  Â <span class="hljs-keyword">const</span> styles = element.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'style'</span>);
Â  Â  Â <span class="hljs-comment">// å› ä¸º mso- å¼€å¤´çš„å±æ€§ä¸æ˜¯cssæ ‡å‡†ä¸­çš„å±æ€§ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨ style.removeProperty æ–¹æ³•å»é™¤</span>
Â  Â  Â <span class="hljs-keyword">const</span> cleanedStyles = styles
Â  Â  Â  Â <span class="hljs-comment">// æ¸…é™¤ mso- å¼€å¤´çš„å±æ€§</span>
Â  Â  Â   ?.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/mso-.+?\s*:\s*[^;]+;?/gi</span>, <span class="hljs-string">''</span>)
Â  Â  Â  Â <span class="hljs-comment">// æ¸…é™¤å¤šä½™çš„ ;</span>
Â  Â  Â   .<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/;;+/g</span>, <span class="hljs-string">';'</span>);
Â  Â  Â <span class="hljs-comment">// å¦‚æœ cleanedStyles ä¸ºç©ºï¼Œåˆ™åˆ é™¤ style å±æ€§</span>
Â  Â  Â <span class="hljs-keyword">if</span> (cleanedStyles) {
Â  Â  Â  Â element.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'style'</span>, cleanedStyles);
Â  Â   } <span class="hljs-keyword">else</span> {
Â  Â  Â  Â element.<span class="hljs-title function_">removeAttribute</span>(<span class="hljs-string">'style'</span>);
Â  Â   }
Â   });
Â â€‹
Â  Â <span class="hljs-comment">// å¤„ç† &lt;br&gt; æ ‡ç­¾</span>
Â  Â <span class="hljs-keyword">const</span> brs = temp.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'br'</span>);
Â  Â brs.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">br</span>) =&gt;</span> {
Â  Â  Â br.<span class="hljs-property">outerHTML</span> = <span class="hljs-string">'&lt;br/&gt;'</span>;
Â   });
Â â€‹
Â  Â <span class="hljs-comment">// å¤„ç† &lt;hr&gt; æ ‡ç­¾</span>
Â  Â <span class="hljs-keyword">const</span> hrs = temp.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'hr'</span>);
Â  Â hrs.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">hr</span>) =&gt;</span> {
Â  Â  Â hr.<span class="hljs-property">outerHTML</span> = <span class="hljs-string">'&lt;hr/&gt;'</span>;
Â   });
Â â€‹
Â  Â <span class="hljs-comment">// åˆ é™¤&lt;o:p&gt;æ ‡ç­¾</span>
Â  Â <span class="hljs-keyword">const</span> oP = temp.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'o\:p'</span>);
Â  Â oP.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">oP</span>) =&gt;</span> {
Â  Â  Â oP.<span class="hljs-title function_">remove</span>();
Â   });
Â â€‹
Â  Â <span class="hljs-comment">/**
Â  Â  * å°†åŒ…å« name="OLE_LINK" çš„ &lt;a&gt; æ ‡ç­¾æ›¿æ¢ä¸º &lt;span&gt; æ ‡ç­¾çš„æ–¹æ³•
Â  Â  *
Â  Â  * å› ä¸ºè¿™ç§ &lt;a&gt; æ ‡ç­¾ä¸æ˜¯æ­£å¸¸ç¼–å†™çš„é“¾æ¥ï¼Œè€Œæ˜¯ä» word ç²˜è´´æ—¶è‡ªåŠ¨æ·»åŠ çš„
Â  Â  */</span>
Â  Â <span class="hljs-keyword">const</span> <span class="hljs-title function_">replaceAbnormalAWithSpan</span> = (<span class="hljs-params">html: HTMLElement</span>) =&gt; {
Â  Â  Â <span class="hljs-keyword">const</span> aTags = html.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'a[name^="OLE_LINK"]'</span>);
Â â€‹
Â  Â  Â aTags.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">a</span>) =&gt;</span> {
Â  Â  Â  Â <span class="hljs-keyword">const</span> span = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'span'</span>);
Â  Â  Â  Â <span class="hljs-comment">// å°† a æ ‡ç­¾çš„å†…å®¹è½¬æ¢ä¸ºçº¯æ–‡æœ¬</span>
Â  Â  Â  Â span.<span class="hljs-property">innerHTML</span> = a.<span class="hljs-property">innerHTML</span>;
Â  Â  Â  Â a.<span class="hljs-title function_">replaceWith</span>(span);
Â  Â   });
Â   };
Â â€‹
Â  Â <span class="hljs-title function_">replaceAbnormalAWithSpan</span>(temp);
Â â€‹
Â  Â <span class="hljs-comment">/** å®Œæˆæ›¿æ¢åçš„ html å­—ç¬¦ä¸² */</span>
Â  Â <span class="hljs-keyword">const</span> replacedHtml = temp.<span class="hljs-property">innerHTML</span>.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/&amp;nbsp;/gi</span>, <span class="hljs-string">'&amp;#160;'</span>);
Â â€‹
Â  Â <span class="hljs-comment">/** å‹ç¼©åçš„ HTML å­—ç¬¦ä¸² */</span>
Â  Â <span class="hljs-keyword">const</span> minifiedHtml = <span class="hljs-keyword">await</span> <span class="hljs-title function_">minify</span>(replacedHtml);
Â â€‹
Â  Â <span class="hljs-keyword">return</span> minifiedHtml;
Â };
</code></pre>
<p>ä½¿ç”¨æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">Â <span class="hljs-keyword">import</span> { createWordContentProcessor } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/lib/jodit/plugins/word-content-processor'</span>;
Â â€‹
Â <span class="hljs-title class_">Jodit</span>.<span class="hljs-property">plugins</span>.<span class="hljs-title function_">add</span>(
Â  Â <span class="hljs-string">'creditDataSource'</span>,
Â  Â <span class="hljs-title function_">createWordContentProcessor</span>(
Â  Â  Â <span class="hljs-comment">// å¯ä¼ é€’é…ç½®é¡¹ï¼Œä»¥è‡ªå®šä¹‰æ’ä»¶è¡Œä¸º</span>
Â  Â  Â <span class="hljs-comment">// {</span>
Â  Â  Â <span class="hljs-comment">// isFormatHtmlFromWordOnBlur: true,</span>
Â  Â  Â <span class="hljs-comment">// formatHtmlFromWord: (content: string) =&gt; {</span>
Â  Â  Â <span class="hljs-comment">// Â  return content;</span>
Â  Â  Â <span class="hljs-comment">// },</span>
Â  Â  Â <span class="hljs-comment">// }</span>
Â ));
</code></pre>
<p>è¯¥æ’ä»¶å®ç°çš„æ ¸å¿ƒåœ¨äºä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ol>
<li>ä»¥åŸç”Ÿæ’ä»¶ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxdan%2Fjodit%2Fblob%2Fmain%2Fsrc%2Fplugins%2Fpaste-from-word%2Fpaste-from-word.ts" target="_blank" title="https://github.com/xdan/jodit/blob/main/src/plugins/paste-from-word/paste-from-word.ts" ref="nofollow noopener noreferrer">paste-from-word</a> ä¸ºåŸºç¡€è¿›è¡Œæ”¹é€ ï¼›</li>
<li><strong>é€šè¿‡ <code>"jodit/esm/*"</code> æ¥å¯¼å…¥</strong>å„ç§ Jodit APIï¼›</li>
<li>å°†åŸ <code>processWordHTML()</code> æ–¹æ³•æ”¹ä¸ºå¼‚æ­¥ï¼Œä»¥<strong>æ”¯æŒå¯¹å†…å®¹çš„å¼‚æ­¥å¤„ç†</strong>ï¼ˆå³ç¤ºä¾‹ä¸­çš„ <code>formatHtmlFromWord()</code> æ–¹æ³• ï¼‰ï¼›</li>
<li>ä½¿ç”¨ <strong><code>init()</code> ç”Ÿå‘½å‘¨æœŸ</strong>é’©å­æŒ‚è½½ <code>blur</code> äº‹ä»¶ï¼›</li>
<li>ä½¿ç”¨<strong>å·¥å‚å‡½æ•°ä¼ é€’é…ç½®</strong>ï¼Œè€Œä¸æ˜¯è®¿é—® <code>config</code> å±æ€§ï¼Œå¢åŠ ä»£ç å†…èšæ€§ã€‚æœªæ¥ä¸éœ€è¦ä½¿ç”¨è¯¥æ’ä»¶æ—¶ï¼Œåªéœ€è¦åˆ é™¤å·¥å‚å‡½æ•°æ‰§è¡Œä»£ç å³å¯ï¼Œä¸ç”¨å…³å¿ƒ <code>config</code> å†…å®¹ï¼›</li>
</ol>
<p><code>formatHtmlFromWord()</code> æ–¹æ³•çš„æ ¸å¿ƒåŒ…æ‹¬ï¼š</p>
<ol>
<li>åˆ›å»º<strong>ä¸´æ—¶ div å…ƒç´ </strong>å¤„ç† HTML å­—ç¬¦ä¸²ï¼Œä»¥<strong>ä½¿ç”¨ dom ç›¸å…³ API</strong>ï¼›</li>
<li>ä½¿ç”¨ <strong><code>el.outerHTML = </code>è¯­å¥è¦†ç›–åŸ HTML å…ƒç´ </strong>ï¼›</li>
<li>ä½¿ç”¨ <strong><code>el.remove()</code> æ–¹æ³•åˆ é™¤å…ƒç´ </strong>ï¼›</li>
<li>ä½¿ç”¨ <code>html-minifier-terser</code> è¿™ä¸ª npm åŒ…å¯¹ HTML è¿›è¡Œå‹ç¼©ã€‚</li>
</ol>
<h3 data-id="heading-11">æ€»ç»“â€”â€”å¦‚ä½•å¯¹ç¬¬ä¸‰åº“è¿›è¡Œé€‰å‹ã€å­¦ä¹ å’Œå¼€å‘</h3>
<p>åŸºäºä»¥ä¸Šå†…å®¹å’Œå®é™…æ“ä½œè¿‡ç¨‹ä¸­æ€è€ƒï¼Œå¯ä»¥æ€»ç»“å‡ºä»¥ä¸‹é’ˆå¯¹ç¬¬ä¸‰æ–¹åº“çš„é€‰å‹ã€å­¦ä¹ å’Œå¼€å‘ç»éªŒï¼š</p>
<ol>
<li>
<p><strong>é€‰å‹é˜¶æ®µ</strong>æ ¹æ®é¡¹ç›®è‡ªèº«æƒ…å†µè¿›è¡Œå¿«é€Ÿç­›é€‰ï¼Œä¸€èˆ¬ä¸»è¦è€ƒå¯Ÿä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ol>
<li><strong>å•†ä¸šä½¿ç”¨è´¹ç”¨</strong>ï¼›</li>
<li><strong>å¼€å‘éš¾åº¦</strong>ã€‚é€šè¿‡å®ç°ç®€å•åŸå‹æˆ–æŸ¥çœ‹æ–‡æ¡£ä¸­çš„æ•™ç¨‹ï¼Œåˆ¤æ–­ä¸Šæ‰‹å¼€å‘é€Ÿåº¦æ˜¯å¦å¤Ÿå¿«ï¼Œ<strong>å¦‚æœå¿«é€Ÿä¸Šæ‰‹å¼€å‘å›°éš¾ï¼Œåç»­å¼€å‘éš¾åº¦ä¸€èˆ¬ä¹Ÿä¸ä½</strong>ï¼›</li>
<li><strong>å¯æ‰©å±•æ€§</strong>ã€‚å³ç¬¬ä¸‰æ–¹åº“è®¾è®¡æ˜¯å¦åˆç†ï¼Œæ˜¯å¦æ”¯æŒç®€å•çš„åŠŸèƒ½æ‰©å±•æ–¹æ¡ˆï¼Œå› ä¸ºä¸€èˆ¬ä¸šåŠ¡éœ€æ±‚éƒ½æ¶‰åŠåˆ°å¯¹å·²æœ‰åŠŸèƒ½çš„æ·±åº¦å®šåˆ¶ï¼Œå¦‚æœç¬¬ä¸‰æ–¹åº“æ²¡æœ‰æä¾›åº•å±‚çš„æ¥å£ï¼Œåˆ™ä¼šå¯¼è‡´åç»­å¼€å‘ä¸­å‡ºç°å›°éš¾ï¼›</li>
<li><strong>å¯ç»´æŠ¤æ€§</strong>ã€‚åŒ…æ‹¬æ˜¯å¦æœ‰ TS ä»£ç æç¤ºå’Œç±»å‹æ£€æŸ¥ï¼Œæ˜¯å¦æœ‰è¯¦å°½çš„æ–‡æ¡£ï¼Œæ˜¯å¦æœ‰æ´»è·ƒçš„ç¤¾åŒºè§£å†³å„ç§é—®é¢˜ï¼Œæ˜¯å¦æœ‰æœªå‹ç¼©ã€æ··æ·†çš„æºç ç”¨æ¥è¿›è¡Œå¼€å‘å‚è€ƒã€‚</li>
</ol>
</li>
<li>
<p>å†åˆ°<strong>å¼€å‘é˜¶æ®µ</strong>ï¼Œåˆ™å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ€è·¯è¿›è¡Œå­¦ä¹ å’Œå¼€å‘ï¼š</p>
<ol>
<li><strong>ä»¥å®˜æ–¹æ–‡æ¡£ä¸ºåŸºç¡€</strong>ã€‚å…¶ä»–ä»»ä½•èµ„æ–™éƒ½å¯èƒ½å‡ºç°è¿‡æ—¶å’Œé”™è¯¯çš„æƒ…å†µï¼Œåªæœ‰å®˜æ–¹æ–‡æ¡£æ˜¯å¯ä»¥å®Œå…¨ä¿¡ä»»çš„ï¼›</li>
<li><strong>ä»¥å†™ä»£çœ‹ï¼Œè¾¹å†™è¾¹å­¦</strong>ã€‚å’Œä»»ä½•æä¾›äº†æ–‡æ¡£çš„é¡¹ç›®éƒ½ä¸€æ ·ï¼Œå°½å¿«åŠ¨æ‰‹å¼€å‘èƒ½å­¦å¾—æ›´å¿«ï¼Œé‡åˆ°é—®é¢˜å†å›æ¥ç¿»æ–‡æ¡£ã€‚å› ä¸ºæ•´ä¸ªæ–‡æ¡£çš„å†…å®¹é€šå¸¸éå¸¸å¤šï¼Œå…¨éƒ¨çœ‹å®Œæ—¢æµªè´¹æ—¶é—´ï¼Œä¹Ÿè®°ä¸ä½è¿™ä¹ˆå¤šï¼›</li>
<li><strong>å¦‚æœæ–‡æ¡£æ²¡æœ‰è¯¦ç»†è¯´æ˜ï¼Œå°±å»ç¿»æºç </strong>ã€‚åƒæ˜¯ Jodit Editor è¿™ç§æœ‰å•†ç”¨ç‰ˆæœ¬çš„åº“ï¼Œå…¶å®˜æ–¹æ–‡æ¡£ä¸ä¼šç‰¹åˆ«è¯¦ç»†ï¼ˆæ¯”å¦‚ Plugin ç³»ç»Ÿå°±åªæœ‰ä¸€é¡µè¯´æ˜ï¼‰ï¼Œè¿™æ—¶å°±éœ€è¦å»æŸ¥çœ‹æºç ï¼›</li>
<li><strong>æºç ä¸è¦çœ‹åº•å±‚åŸç†ï¼Œè€Œåº”è¯¥çœ‹ç±»ä¼¼åŠŸèƒ½å¦‚ä½•å®ç°</strong>ã€‚æ¯”å¦‚è¦å®ç°ä¸€ä¸ª Jodit Editor çš„æ’ä»¶ï¼Œå°±åº”è¯¥æ‰¾ä¸ªç±»ä¼¼åŠŸèƒ½çš„æ’ä»¶ï¼Œçœ‹å®ƒæ˜¯å¦‚ä½•å®ç°çš„ï¼›</li>
<li><strong>å–„ç”¨ TS ä»£ç æç¤ºå’Œç±»å‹æ£€æŸ¥</strong>ã€‚åœ¨å¼€å‘æ—¶ä¸¥æ ¼éµå®ˆç¬¬ä¸‰æ–¹åº“çš„ç±»å‹æ£€æŸ¥ï¼Œå¯ä»¥å‡å°‘å¼€å‘æ—¶çš„é—®é¢˜ï¼ŒåŒæ—¶å¯ä»¥ç»“åˆç›¸å…³çš„ä¿¡æ¯æ›´å¥½åœ°æ¨æ–­ API çš„åŠŸèƒ½å’Œç”¨æ³•ï¼›</li>
</ol>
</li>
</ol>
<p>ç›¸æ¯” Jodit Editor çš„ä»£ç æ˜¯å¦‚ä½•å†™çš„ï¼Œæˆ‘è®¤ä¸ºè¿™äº›ç»éªŒæ‰æ˜¯æ›´æœ‰ä»·å€¼çš„ä¸œè¥¿ï¼Œå› ä¸ºè¿™äº›æ˜¯<strong>ä¸å—å…·ä½“çš„æŠ€æœ¯é™åˆ¶çš„ï¼Œèƒ½å¤Ÿè·¨è¶Šä¸åŒåº”ç”¨åœºæ™¯çš„åº•å±‚æ–¹æ³•è®º</strong>ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨ Eino å’Œ Ollama æ„å»ºæ™ºèƒ½ Go åº”ç”¨ï¼šä»ç®€å•é—®ç­”åˆ°å¤æ‚ Agent]]></title>    <link>https://juejin.cn/post/7580378958073757706</link>    <guid>https://juejin.cn/post/7580378958073757706</guid>    <pubDate>2025-12-07T13:56:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580378958073757706" data-draft-id="7580374090366058534" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨ Eino å’Œ Ollama æ„å»ºæ™ºèƒ½ Go åº”ç”¨ï¼šä»ç®€å•é—®ç­”åˆ°å¤æ‚ Agent"/> <meta itemprop="keywords" content="åç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-07T13:56:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ¥šå…´"/> <meta itemprop="url" content="https://juejin.cn/user/1020811839542414"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨ Eino å’Œ Ollama æ„å»ºæ™ºèƒ½ Go åº”ç”¨ï¼šä»ç®€å•é—®ç­”åˆ°å¤æ‚ Agent
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1020811839542414/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ¥šå…´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T13:56:17.000Z" title="Sun Dec 07 2025 13:56:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>éšç€å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„æµªæ½®å¸­å·æ•´ä¸ªæŠ€æœ¯åœˆï¼Œå¦‚ä½•å°†è¿™äº›å¼ºå¤§çš„â€œå¤§è„‘â€é›†æˆåˆ°æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­ï¼Œæˆä¸ºäº†ä¸€ä¸ªçƒ­é—¨è¯é¢˜ã€‚å¯¹äºå¹¿å¤§çš„ Go å¼€å‘è€…è€Œè¨€ï¼Œæˆ‘ä»¬åŒæ ·éœ€è¦ä¸€ä¸ªé¡ºæ‰‹çš„å·¥å…·æ¥ç¼–æ’å’Œæ„å»ºå¤æ‚çš„ LLM å·¥ä½œæµã€‚Eino æ¡†æ¶åº”è¿è€Œç”Ÿï¼Œå®ƒå€Ÿé‰´äº† Python ç¤¾åŒº LangChain çš„æˆåŠŸç»éªŒï¼Œä¸º Go è¯­è¨€å¸¦æ¥äº†å£°æ˜å¼ã€å¯ç»„åˆã€æ˜“äºæ‰©å±•çš„ AI åº”ç”¨å¼€å‘èŒƒå¼ã€‚</p>
<p>ä¸æ­¤åŒæ—¶ï¼ŒOllama çš„å‡ºç°æå¤§åœ°é™ä½äº†åœ¨æœ¬åœ°ç¯å¢ƒè¿è¡Œå¼€æº LLM çš„é—¨æ§›ã€‚å®ƒè®©å¼€å‘è€…å¯ä»¥åœ¨è‡ªå·±çš„æœºå™¨ä¸Šè½»æ¾éƒ¨ç½²å’Œè°ƒç”¨å„ç§æ¨¡å‹ï¼Œæ— éœ€ä¾èµ–æ˜‚è´µçš„äº‘æœåŠ¡ï¼Œè¿™ä¸ºå¿«é€ŸåŸå‹è®¾è®¡å’Œä¿æŠ¤æ•°æ®éšç§æä¾›äº†æå¤§çš„ä¾¿åˆ©ã€‚</p>
<p>æœ¬æ–‡å°†ä½œä¸ºä¸€ç¯‡ç”±æµ…å…¥æ·±çš„å®æˆ˜æ•™ç¨‹ï¼Œå¸¦é¢†ä½ å°† Eino ä¸ Ollama è¿™å¯¹å¼ºå¤§çš„ç»„åˆè¿ç”¨èµ·æ¥ã€‚æˆ‘ä»¬å°†ä»ä¸€ä¸ªæœ€ç®€å•çš„é—®ç­”æœºå™¨äººå¼€å§‹ï¼Œé€æ­¥æ·±å…¥ï¼Œæœ€ç»ˆæ„å»ºä¸€ä¸ªå…·å¤‡æ™ºèƒ½è·¯ç”±ã€è´¨é‡æ£€æŸ¥å’Œè‡ªåŠ¨é‡è¯•èƒ½åŠ›çš„å¤æ‚ Agentã€‚</p>
<hr/>
<h2 data-id="heading-1">ç¬¬ä¸€éƒ¨åˆ†ï¼šç¯å¢ƒå‡†å¤‡</h2>
<p>å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚åœ¨å¼€å§‹ç¼–ç ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ­å»ºå¥½æœ¬åœ°çš„ LLM è¿è¡Œç¯å¢ƒå’Œ Go å¼€å‘ç¯å¢ƒã€‚</p>
<h3 data-id="heading-2">1. å®‰è£…å¹¶è¿è¡Œ Ollama</h3>
<p>Ollama æ”¯æŒ macOSã€Windows å’Œ Linuxã€‚è¿™é‡Œæˆ‘ä»¬ä»¥ macOS ä¸ºä¾‹ï¼Œä½¿ç”¨ Homebrew è¿›è¡Œå®‰è£…æ˜¯æœ€ä¾¿æ·çš„æ–¹å¼ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. ä½¿ç”¨ Homebrew å®‰è£… Ollama</span>
brew install ollama

<span class="hljs-comment"># 2. å¯åŠ¨ Ollama æœåŠ¡ï¼ˆå®ƒä¼šåœ¨åå°è¿è¡Œï¼‰</span>
ollama serve
</code></pre>
<p>æœåŠ¡å¯åŠ¨åï¼ŒOllama ä¼šåœ¨æœ¬åœ° <code>11434</code> ç«¯å£ä¸Šæä¾›ä¸€ä¸ªä¸ OpenAI API å…¼å®¹çš„æ¥å£ï¼Œè¿™æ˜¯æˆ‘ä»¬ç¨åè¿æ¥å®ƒçš„å…³é”®ã€‚</p>
<h3 data-id="heading-3">2. æ‹‰å–æœ¬åœ°æ¨¡å‹</h3>
<p>Ollama æ”¯æŒä¼—å¤šå¼€æºæ¨¡å‹ã€‚åœ¨æˆ‘ä»¬çš„æ•™ç¨‹ä¸­ï¼Œå°†ä½¿ç”¨ <code>qwen2.5:0.5b</code>ï¼ˆé€šä¹‰åƒé—® 0.5B ç‰ˆæœ¬ï¼‰ä½œä¸ºä¸»åŠ›æ¨¡å‹ã€‚å®ƒä½“ç§¯å°ã€é€Ÿåº¦å¿«ï¼Œéå¸¸é€‚åˆåœ¨æ™®é€šç¬”è®°æœ¬ç”µè„‘ä¸Šè¿›è¡Œå¼€å‘å’Œæµ‹è¯•ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä» Ollama Hub æ‹‰å– qwen 0.5B æ¨¡å‹</span>
ollama pull qwen2.5:0.5b
</code></pre>
<p>ä½ å¯ä»¥é€šè¿‡ <code>ollama list</code> å‘½ä»¤æ¥æŸ¥çœ‹æœ¬åœ°å·²æœ‰çš„æ¨¡å‹ã€‚</p>
<h3 data-id="heading-4">3. åˆå§‹åŒ– Go é¡¹ç›®</h3>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥è®¾ç½® Go é¡¹ç›®å¹¶å®‰è£… Eino æ¡†æ¶ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. åˆ›å»ºé¡¹ç›®ç›®å½•</span>
<span class="hljs-built_in">mkdir</span> eino-ollama-demo
<span class="hljs-built_in">cd</span> eino-ollama-demo

<span class="hljs-comment"># 2. åˆå§‹åŒ– Go Module</span>
go mod init github.com/your-username/eino-ollama-demo

<span class="hljs-comment"># 3. å®‰è£… Eino æ ¸å¿ƒåº“å’Œ OpenAI ç»„ä»¶</span>
<span class="hljs-comment"># æˆ‘ä»¬ä½¿ç”¨ OpenAI ç»„ä»¶æ˜¯å› ä¸º Ollama æä¾›äº†å…¼å®¹çš„ API</span>
go get github.com/cloudwego/eino
go get github.com/cloudwego/eino-ext/components/model/openai
</code></pre>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬çš„å¼€å‘ç¯å¢ƒå·²ç»å‡†å¤‡å°±ç»ªï¼</p>
<hr/>
<h2 data-id="heading-5">ç¬¬äºŒéƒ¨åˆ†ï¼šEino å…¥é—¨ï¼šåˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ª LLM åº”ç”¨</h2>
<p>è®©æˆ‘ä»¬ä»ä¸€ä¸ªæœ€ç®€å•çš„åœºæ™¯å¼€å§‹ï¼šå‘æ¨¡å‹æä¸€ä¸ªé—®é¢˜ï¼Œç„¶åæ‰“å°å®ƒçš„å›ç­”ã€‚è¿™èƒ½å¸®åŠ©æˆ‘ä»¬ç†è§£ Eino æœ€æ ¸å¿ƒçš„æ¦‚å¿µã€‚</p>
<h3 data-id="heading-6">Eino æ ¸å¿ƒæ¦‚å¿µ</h3>
<p>Eino çš„æ ¸å¿ƒæ€æƒ³æ˜¯<strong>å›¾ï¼ˆGraphï¼‰</strong>ã€‚ä½ å¯ä»¥å°†ä¸€ä¸ªå¤æ‚çš„ AI ä»»åŠ¡æ‹†è§£æˆä¸€ä¸ªä¸ªç‹¬ç«‹çš„<strong>èŠ‚ç‚¹ï¼ˆNodeï¼‰</strong>ï¼Œç„¶åç”¨<strong>è¾¹ï¼ˆEdgeï¼‰<strong>å°†å®ƒä»¬è¿æ¥èµ·æ¥ï¼Œå®šä¹‰æ•°æ®çš„æµå‘å’Œå¤„ç†é€»è¾‘ã€‚æœ€ç»ˆï¼Œè¿™å¼ å›¾ä¼šè¢«</strong>ç¼–è¯‘ï¼ˆCompileï¼‰<strong>æˆä¸€ä¸ªå¯æ‰§è¡Œçš„</strong>å¯¹è±¡ï¼ˆRunnableï¼‰</strong>ã€‚</p>
<ul>
<li><strong>Graph</strong>: æ„å»ºå·¥ä½œæµçš„â€œç”»å¸ƒâ€ã€‚</li>
<li><strong>Node</strong>: å›¾ä¸­çš„æ“ä½œå•å…ƒã€‚æœ€å¸¸ç”¨çš„æœ‰ï¼š
<ul>
<li><code>ChatModelNode</code>: ä¸“é—¨ç”¨äºå’Œ LLM è¿›è¡Œäº¤äº’çš„èŠ‚ç‚¹ã€‚å®ƒçš„è¾“å…¥æ˜¯æ ‡å‡†çš„æ¶ˆæ¯æ ¼å¼ï¼ˆ<code>[]*schema.Message</code>ï¼‰ï¼Œè¾“å‡ºæ˜¯æ¨¡å‹çš„å›å¤ï¼ˆ<code>*schema.Message</code>ï¼‰ã€‚</li>
<li><code>LambdaNode</code>: ä¸€ä¸ªé€šç”¨çš„â€œç‘å£«å†›åˆ€â€ï¼Œå¯ä»¥å°è£…ä»»æ„è‡ªå®šä¹‰çš„ Go å‡½æ•°ã€‚å®ƒæå…¶çµæ´»ï¼Œé€šå¸¸ç”¨äºï¼š
<ul>
<li><strong>æ•°æ®è½¬æ¢</strong>ï¼šå°†ä¸€ç§æ•°æ®ç±»å‹è½¬æ¢ä¸ºå¦ä¸€ç§ï¼Œä¾‹å¦‚å°†ç®€å•çš„å­—ç¬¦ä¸²è¾“å…¥åŒ…è£…æˆ <code>ChatModelNode</code> éœ€è¦çš„ <code>[]*schema.Message</code> æ ¼å¼ã€‚</li>
<li><strong>Prompt æ ¼å¼åŒ–</strong>ï¼šæ ¹æ®è¾“å…¥åŠ¨æ€ç”Ÿæˆå¤æ‚çš„æç¤ºè¯ã€‚</li>
<li><strong>è¾“å‡ºè§£æ</strong>ï¼šä»æ¨¡å‹çš„åŸå§‹è¾“å‡ºä¸­æå–å’Œæ¸…ç†éœ€è¦çš„ä¿¡æ¯ï¼Œä¾‹å¦‚ä»ä¸€æ®µæ–‡æœ¬ä¸­è§£æå‡º "code" æˆ– "general" è¿™æ ·çš„åˆ†ç±»æ ‡ç­¾ã€‚</li>
</ul>
</li>
<li><code>BranchNode</code>: å®ç°å·¥ä½œæµçš„<strong>æ¡ä»¶åˆ†æ”¯</strong>ã€‚å®ƒå†…éƒ¨åŒ…å«ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°æ ¹æ®è¾“å…¥åŠ¨æ€åœ°è¿”å›ä¸‹ä¸€ä¸ªåº”è¯¥æ‰§è¡Œçš„èŠ‚ç‚¹çš„åç§°ã€‚è¿™ä½¿å¾—å›¾å¯ä»¥æ ¹æ®ä¸åŒçš„æƒ…å†µæ‰§è¡Œä¸åŒçš„è·¯å¾„ï¼Œæ˜¯å®ç°æ™ºèƒ½è·¯ç”±çš„å…³é”®ã€‚</li>
</ul>
</li>
<li><strong>Edge</strong>: å®šä¹‰æ•°æ®åœ¨èŠ‚ç‚¹ä¹‹é—´çš„æµå‘ã€‚</li>
<li><strong>Runnable</strong>: ç”±å›¾ç¼–è¯‘è€Œæˆçš„å¯æ‰§è¡Œå®ä¾‹ã€‚</li>
</ul>
<h4 data-id="heading-7">å¦‚ä½•é€‰æ‹©èŠ‚ç‚¹ï¼Ÿ</h4>
<ul>
<li>å½“ä½ éœ€è¦ä¸ LLM å¯¹è¯æ—¶ï¼Œä½¿ç”¨ <code>ChatModelNode</code>ã€‚</li>
<li>å½“ä½ éœ€è¦è¿›è¡Œæ•°æ®æ ¼å¼åŒ–ã€è‡ªå®šä¹‰é€»è¾‘å¤„ç†ã€æˆ–è€…åœ¨è°ƒç”¨æ¨¡å‹å‰åè¿›è¡Œé¢„å¤„ç†/åå¤„ç†æ—¶ï¼Œä½¿ç”¨ <code>LambdaNode</code>ã€‚å®ƒæ˜¯è¿æ¥ä¸åŒèŠ‚ç‚¹çš„â€œèƒ¶æ°´â€ã€‚</li>
<li>å½“ä½ éœ€è¦æ ¹æ®æŸä¸ªæ¡ä»¶åŠ¨æ€åœ°å†³å®šä¸‹ä¸€æ­¥èµ°å‘æ—¶ï¼ˆä¾‹å¦‚ï¼Œæ ¹æ®é—®é¢˜ç±»å‹é€‰æ‹©ä¸åŒçš„ä¸“å®¶æ¨¡å‹ï¼‰ï¼Œä½¿ç”¨ <code>BranchNode</code>ã€‚</li>
</ul>
<h3 data-id="heading-8">ä»£ç å®æˆ˜ï¼šSimple Chain</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"context"</span>
	<span class="hljs-string">"fmt"</span>

	<span class="hljs-string">"github.com/cloudwego/eino-ext/components/model/openai"</span>
	<span class="hljs-string">"github.com/cloudwego/eino/compose"</span>
	<span class="hljs-string">"github.com/cloudwego/eino/schema"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main_simple</span><span class="hljs-params">(ctx context.Context)</span></span> {
	<span class="hljs-comment">// 1. é…ç½®å¹¶åˆ›å»ºæ¨¡å‹å®ä¾‹</span>
	qwenConfig := &amp;openai.ChatModelConfig{
		BaseURL: <span class="hljs-string">"http://localhost:11434/v1"</span>, <span class="hljs-comment">// Ollama ç«¯ç‚¹</span>
		APIKey:  <span class="hljs-string">"ollama"</span>,                    <span class="hljs-comment">// ä»»æ„å­—ç¬¦ä¸²</span>
		Model:   <span class="hljs-string">"qwen2.5:0.5b"</span>,
	}
	qwenModel, _ := openai.NewChatModel(ctx, qwenConfig)

	<span class="hljs-comment">// 2. åˆ›å»ºå›¾ (Graph)</span>
	sg := compose.NewGraph[<span class="hljs-type">string</span>, *schema.Message]()

	<span class="hljs-comment">// 3. æ·»åŠ èŠ‚ç‚¹ (Node)</span>
	<span class="hljs-comment">// èŠ‚ç‚¹1: LambdaNodeï¼Œå°† string ç±»å‹çš„è¾“å…¥è½¬æ¢æˆæ¨¡å‹éœ€è¦çš„ []*schema.Message</span>
	formatInput := compose.InvokableLambda(<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctx context.Context, input <span class="hljs-type">string</span>)</span></span> ([]*schema.Message, <span class="hljs-type">error</span>) {
		<span class="hljs-keyword">return</span> []*schema.Message{{Role: <span class="hljs-string">"user"</span>, Content: input}}, <span class="hljs-literal">nil</span>
	})
	_ = sg.AddLambdaNode(<span class="hljs-string">"format_input"</span>, formatInput)

	<span class="hljs-comment">// èŠ‚ç‚¹2: ChatModelNodeï¼Œä»£è¡¨æˆ‘ä»¬çš„å¤§æ¨¡å‹</span>
	_ = sg.AddChatModelNode(<span class="hljs-string">"qwen_model"</span>, qwenModel)

	<span class="hljs-comment">// 4. æ·»åŠ è¾¹ (Edge)ï¼Œå®šä¹‰æ•°æ®æµ</span>
	_ = sg.AddEdge(compose.START, <span class="hljs-string">"format_input"</span>) <span class="hljs-comment">// æ•°æ®ä»èµ·ç‚¹æµå…¥ format_input</span>
	_ = sg.AddEdge(<span class="hljs-string">"format_input"</span>, <span class="hljs-string">"qwen_model"</span>) <span class="hljs-comment">// format_input çš„è¾“å‡ºæ˜¯ qwen_model çš„è¾“å…¥</span>
	_ = sg.AddEdge(<span class="hljs-string">"qwen_model"</span>, compose.END)       <span class="hljs-comment">// qwen_model çš„è¾“å‡ºæ˜¯æ•´ä¸ªé“¾çš„æœ€ç»ˆè¾“å‡º</span>

	<span class="hljs-comment">// 5. ç¼–è¯‘ (Compile) æˆ Runnable</span>
	simpleChain, _ := sg.Compile(ctx)

	<span class="hljs-comment">// 6. æ‰§è¡Œ (Invoke)</span>
	result, _ := simpleChain.Invoke(ctx, <span class="hljs-string">"Goè¯­è¨€çš„ä¸»è¦ç‰¹ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ"</span>)

	fmt.Println(result.Content)
}
</code></pre>
<p>è¿™æ®µä»£ç æ¸…æ™°åœ°å±•ç¤ºäº† Eino çš„å·¥ä½œæµç¨‹ï¼š<strong>å®šä¹‰èŠ‚ç‚¹ -&gt; è¿æ¥èŠ‚ç‚¹ -&gt; ç¼–è¯‘ -&gt; æ‰§è¡Œ</strong>ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬ç”¨å£°æ˜å¼çš„ä»£ç æ„å»ºäº†ä¸€ä¸ªç®€å•ä½†å®Œæ•´çš„ LLM è°ƒç”¨é“¾ã€‚</p>
<hr/>
<h2 data-id="heading-9">ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ™ºèƒ½è·¯ç”±ï¼šè®©æ¨¡å‹å­¦ä¼šâ€œåˆ†å·¥åˆä½œâ€</h2>
<p>å•ä¸€æ¨¡å‹æ— æ³•èƒœä»»æ‰€æœ‰ä»»åŠ¡ã€‚ä¸€ä¸ªæ›´å®é™…çš„åœºæ™¯æ˜¯ï¼šæˆ‘ä»¬æœ‰ä¸€ä¸ªè½»é‡çº§çš„â€œè°ƒåº¦â€æ¨¡å‹ï¼Œè´Ÿè´£åˆ¤æ–­ç”¨æˆ·é—®é¢˜çš„ç±»å‹ï¼Œç„¶åå°†é—®é¢˜åˆ†å‘ç»™ç›¸åº”çš„â€œä¸“å®¶â€æ¨¡å‹ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªæ“…é•¿ç¼–ç ï¼Œä¸€ä¸ªæ“…é•¿é€šç”¨çŸ¥è¯†ï¼‰ã€‚è¿™å°±æ˜¯ Agent å’Œè·¯ç”±æ€æƒ³çš„é›å½¢ã€‚</p>
<h3 data-id="heading-10">æ ¸å¿ƒæ€è·¯ï¼šç”¨é“¾æ¥æ§åˆ¶é“¾</h3>
<p>æˆ‘ä»¬å°†æ„å»ºä¸¤ä¸ªå±‚æ¬¡çš„é“¾ï¼š</p>
<ol>
<li><strong>è°ƒåº¦é“¾ï¼ˆDispatcher Chainï¼‰</strong>ï¼šä¸€ä¸ªç‹¬ç«‹çš„ã€å°è€Œå¿«çš„é“¾ï¼Œå®ƒçš„å”¯ä¸€èŒè´£æ˜¯æ¥æ”¶ç”¨æˆ·é—®é¢˜ï¼Œå¹¶è¾“å‡ºé—®é¢˜çš„åˆ†ç±»ï¼ˆä¾‹å¦‚ "code" æˆ– "general"ï¼‰ã€‚</li>
<li><strong>ä¸»è·¯ç”±å›¾ï¼ˆMain Router Graphï¼‰</strong>ï¼šå®ƒåŒ…å«ä¸¤ä¸ªå¹¶è¡Œçš„ä¸“å®¶æ¨¡å‹èŠ‚ç‚¹ï¼ˆ<code>coder_expert</code> å’Œ <code>general_expert</code>ï¼‰ã€‚å®ƒä½¿ç”¨ä¸€ä¸ªç‰¹æ®Šçš„ <code>BranchNode</code> æ¥è°ƒç”¨â€œè°ƒåº¦é“¾â€ï¼Œå¹¶æ ¹æ®å…¶ç»“æœï¼ŒåŠ¨æ€åœ°å†³å®šæ•°æ®åº”è¯¥æµå‘å“ªä¸ªä¸“å®¶èŠ‚ç‚¹ã€‚</li>
</ol>
<h3 data-id="heading-11">ä»£ç å®æˆ˜ï¼šRouter Chain</h3>
<p>ä¸‹é¢çš„ä»£ç å±•ç¤ºäº†å¦‚ä½•æ„å»ºå’Œç¼–æ’è°ƒåº¦é“¾ä¸ä¸»è·¯ç”±å›¾ã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"context"</span>
	<span class="hljs-string">"fmt"</span>
	<span class="hljs-string">"log"</span>
	<span class="hljs-string">"strings"</span>
	<span class="hljs-string">"time"</span>

	<span class="hljs-string">"github.com/cloudwego/eino-ext/components/model/openai"</span>
	<span class="hljs-string">"github.com/cloudwego/eino/compose"</span>
	<span class="hljs-string">"github.com/cloudwego/eino/schema"</span>
)

<span class="hljs-comment">// main_router æ¼”ç¤ºè·¯ç”±é“¾ï¼šæ ¹æ®é—®é¢˜ç±»å‹é€‰æ‹©ä¸åŒæ¨¡å‹</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main_router</span><span class="hljs-params">(ctx context.Context)</span></span> {
	<span class="hljs-comment">// 1. åˆ›å»ºä¸‰ä¸ªæ¨¡å‹å®¢æˆ·ç«¯</span>
	<span class="hljs-comment">// ... (æ¨¡å‹åˆ›å»ºä»£ç ï¼Œä¸ä¹‹å‰ç±»ä¼¼)</span>

	fmt.Println(<span class="hljs-string">"âœ… æ‰€æœ‰æ¨¡å‹å®¢æˆ·ç«¯åˆ›å»ºæˆåŠŸ"</span>)

	<span class="hljs-comment">// 2. åˆ›å»ºè°ƒåº¦å™¨é“¾ (Dispatcher Chain)</span>
	dispatcherGraph := compose.NewGraph[<span class="hljs-type">string</span>, <span class="hljs-type">string</span>]()
	<span class="hljs-comment">// 2.1 æ ¼å¼åŒ–è°ƒåº¦æç¤º</span>
	_ = dispatcherGraph.AddLambdaNode(<span class="hljs-string">"format_prompt"</span>, compose.InvokableLambda(
		<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctx context.Context, userQuestion <span class="hljs-type">string</span>)</span></span> ([]*schema.Message, <span class="hljs-type">error</span>) {
			prompt := fmt.Sprintf(<span class="hljs-string">`You are a routing expert. Your task is to classify the user's question into one of two categories: "code" or "general". You must respond with ONLY the category name and nothing else.\n\n- "code": Questions about programming, algorithms, data structures, software development, and code.\n- "general": Questions about general knowledge, history, science, writing, or explaining concepts.\n\nQuestion: "%s"\nResponse:`</span>, userQuestion)
			<span class="hljs-keyword">return</span> []*schema.Message{{Role: <span class="hljs-string">"user"</span>, Content: prompt}}, <span class="hljs-literal">nil</span>
		},
	))
	<span class="hljs-comment">// 2.2 æ·»åŠ è°ƒåº¦æ¨¡å‹</span>
	_ = dispatcherGraph.AddChatModelNode(<span class="hljs-string">"dispatcher_model"</span>, dispatcherModel)
	<span class="hljs-comment">// 2.3 æå–å†³ç­–</span>
	_ = dispatcherGraph.AddLambdaNode(<span class="hljs-string">"extract_decision"</span>, compose.InvokableLambda(
		<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctx context.Context, response *schema.Message)</span></span> (<span class="hljs-type">string</span>, <span class="hljs-type">error</span>) {
			decision := strings.TrimSpace(strings.ToLower(response.Content))
			<span class="hljs-keyword">if</span> decision == <span class="hljs-string">"code"</span> {
				<span class="hljs-keyword">return</span> <span class="hljs-string">"code"</span>, <span class="hljs-literal">nil</span>
			}
			<span class="hljs-comment">// é»˜è®¤è¿”å› generalï¼Œç¡®ä¿é²æ£’æ€§</span>
			<span class="hljs-keyword">return</span> <span class="hljs-string">"general"</span>, <span class="hljs-literal">nil</span>
		},
	))
	<span class="hljs-comment">// 2.4 è¿æ¥è°ƒåº¦é“¾</span>
	_ = dispatcherGraph.AddEdge(compose.START, <span class="hljs-string">"format_prompt"</span>)
	_ = dispatcherGraph.AddEdge(<span class="hljs-string">"format_prompt"</span>, <span class="hljs-string">"dispatcher_model"</span>)
	_ = dispatcherGraph.AddEdge(<span class="hljs-string">"dispatcher_model"</span>, <span class="hljs-string">"extract_decision"</span>)
	_ = dispatcherGraph.AddEdge(<span class="hljs-string">"extract_decision"</span>, compose.END)

	<span class="hljs-comment">// 2.5 ç¼–è¯‘è°ƒåº¦é“¾</span>
	dispatcherRunnable, err := dispatcherGraph.Compile(ctx)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		log.Fatalf(<span class="hljs-string">"âŒ ç¼–è¯‘è°ƒåº¦é“¾å¤±è´¥: %v"</span>, err)
	}
	fmt.Println(<span class="hljs-string">"âœ… è°ƒåº¦é“¾ç¼–è¯‘æˆåŠŸ"</span>)

	<span class="hljs-comment">// 3. åˆ›å»ºä¸»è·¯ç”±å›¾ (Main Router Graph)</span>
	routerGraph := compose.NewGraph[<span class="hljs-type">string</span>, *schema.Message]()

	<span class="hljs-comment">// 3.1 æ·»åŠ ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°†ç”¨æˆ·é—®é¢˜(string)è½¬æ¢ä¸ºæ¨¡å‹è¾“å…¥([]*schema.Message)</span>
	_ = routerGraph.AddLambdaNode(<span class="hljs-string">"format_input"</span>, compose.InvokableLambda(
		<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctx context.Context, userQuestion <span class="hljs-type">string</span>)</span></span> ([]*schema.Message, <span class="hljs-type">error</span>) {
			<span class="hljs-keyword">return</span> []*schema.Message{{Role: <span class="hljs-string">"user"</span>, Content: userQuestion}}, <span class="hljs-literal">nil</span>
		},
	))

	<span class="hljs-comment">// 3.2 æ·»åŠ ä¸“å®¶æ¨¡å‹èŠ‚ç‚¹</span>
	_ = routerGraph.AddChatModelNode(<span class="hljs-string">"coder_expert"</span>, coderModel)
	_ = routerGraph.AddChatModelNode(<span class="hljs-string">"general_expert"</span>, generalModel)

	<span class="hljs-comment">// 3.3 å®šä¹‰è·¯ç”±é€»è¾‘ (Branch Condition)</span>
	<span class="hljs-comment">// branchCondition çš„è¾“å…¥æ˜¯ format_input èŠ‚ç‚¹çš„è¾“å‡º ([]*schema.Message)</span>
	branchCondition := <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctx context.Context, messages []*schema.Message)</span></span> (<span class="hljs-type">string</span>, <span class="hljs-type">error</span>) {
		userQuestion := messages[<span class="hljs-number">0</span>].Content

		fmt.Printf(<span class="hljs-string">"ğŸ”„ è°ƒåº¦å™¨æ­£åœ¨åˆ†æé—®é¢˜: %s\n"</span>, userQuestion)
		<span class="hljs-comment">// åœ¨åˆ†æ”¯é€»è¾‘å†…éƒ¨ï¼Œè°ƒç”¨å·²ç¼–è¯‘çš„è°ƒåº¦é“¾ï¼</span>
		decision, err := dispatcherRunnable.Invoke(ctx, userQuestion)
		<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
			<span class="hljs-keyword">return</span> <span class="hljs-string">"general_expert"</span>, err <span class="hljs-comment">// å‡ºé”™æ—¶é»˜è®¤åˆ°é€šç”¨ä¸“å®¶</span>
		}
		fmt.Printf(<span class="hljs-string">"  è°ƒåº¦å†³ç­–: %s\n"</span>, decision)

		<span class="hljs-keyword">if</span> decision == <span class="hljs-string">"code"</span> {
			fmt.Println(<span class="hljs-string">"  è·¯ç”±åˆ°ä»£ç ä¸“å®¶ (qwen2.5:0.5b)"</span>)
			<span class="hljs-keyword">return</span> <span class="hljs-string">"coder_expert"</span>, <span class="hljs-literal">nil</span> <span class="hljs-comment">// è¿”å›ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„åç§°</span>
		}
		fmt.Println(<span class="hljs-string">"  è·¯ç”±åˆ°é€šç”¨ä¸“å®¶ (qwen2.5:0.5b)"</span>)
		<span class="hljs-keyword">return</span> <span class="hljs-string">"general_expert"</span>, <span class="hljs-literal">nil</span>
	}
	branch := compose.NewGraphBranch(branchCondition, <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">bool</span>{
		<span class="hljs-string">"coder_expert"</span>:   <span class="hljs-literal">true</span>, <span class="hljs-comment">// å£°æ˜åˆ†æ”¯å¯èƒ½çš„ç›®æ ‡èŠ‚ç‚¹</span>
		<span class="hljs-string">"general_expert"</span>: <span class="hljs-literal">true</span>,
	})

	<span class="hljs-comment">// 3.4 æ„å»ºå›¾ç»“æ„</span>
	_ = routerGraph.AddEdge(compose.START, <span class="hljs-string">"format_input"</span>)
	_ = routerGraph.AddBranch(<span class="hljs-string">"format_input"</span>, branch) <span class="hljs-comment">// åœ¨ format_input åæ·»åŠ åˆ†æ”¯</span>
	_ = routerGraph.AddEdge(<span class="hljs-string">"coder_expert"</span>, compose.END)   <span class="hljs-comment">// ä¸¤ä¸ªä¸“å®¶éƒ½è¿æ¥åˆ°ç»ˆç‚¹</span>
	_ = routerGraph.AddEdge(<span class="hljs-string">"general_expert"</span>, compose.END)

	<span class="hljs-comment">// 4. ç¼–è¯‘ä¸»è·¯ç”±å›¾</span>
	finalRunnable, err := routerGraph.Compile(ctx)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		log.Fatalf(<span class="hljs-string">"âŒ ç¼–è¯‘ä¸»è·¯ç”±å›¾å¤±è´¥: %v"</span>, err)
	}
	fmt.Println(<span class="hljs-string">"âœ… æ™ºèƒ½è·¯ç”±å›¾ç¼–è¯‘æˆåŠŸ"</span>)

	<span class="hljs-comment">// ... (æµ‹è¯•ç”¨ä¾‹æ‰§è¡Œä»£ç )</span>
}
</code></pre>
<p>é€šè¿‡ <code>AddBranch</code>ï¼Œæˆ‘ä»¬èµ‹äºˆäº† Eino å›¾åŠ¨æ€å†³ç­–çš„èƒ½åŠ›ã€‚è¿™ç§â€œé“¾ä¸­è°ƒé“¾â€çš„æ¨¡å¼æ˜¯æ„å»ºå¤æ‚ Agent çš„åŸºç¡€ï¼Œå®ƒè®©æˆ‘ä»¬å¯ä»¥å°†ä¸åŒçš„åŠŸèƒ½æ¨¡å—ï¼ˆå¦‚è°ƒåº¦ã€æ‰§è¡Œã€æ€»ç»“ç­‰ï¼‰è§£è€¦ï¼Œç„¶åçµæ´»åœ°ç¼–æ’å®ƒä»¬ã€‚</p>
<hr/>
<h2 data-id="heading-12">ç¬¬å››éƒ¨åˆ†ï¼šé«˜çº§æŠ€å·§ï¼šä¸ºä½ çš„ Agent å¢åŠ â€œè´¨æ£€â€ä¸â€œé‡è¯•â€</h2>
<p>æ™ºèƒ½è·¯ç”±è§£å†³äº†ä»»åŠ¡åˆ†å‘ï¼Œä½†å¦‚æœä¸“å®¶æ¨¡å‹ç»™å‡ºçš„ç­”æ¡ˆè´¨é‡ä¸ä½³æ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬å¯ä»¥å†å¢åŠ ä¸€ä¸ªâ€œè´¨æ£€â€ç¯èŠ‚ï¼Œå¦‚æœç­”æ¡ˆä¸åˆæ ¼ï¼Œå°±è®©å®ƒé‡åšä¸€æ¬¡ã€‚è¿™è®©æˆ‘ä»¬çš„ç³»ç»Ÿå…·å¤‡äº†è‡ªæˆ‘ä¿®æ­£çš„èƒ½åŠ›ã€‚</p>
<h3 data-id="heading-13">æ ¸å¿ƒæ€è·¯ï¼šè§£è€¦æ‰€æœ‰ç»„ä»¶ï¼Œå¤–éƒ¨å¾ªç¯ç¼–æ’</h3>
<p>è¿™æ¬¡æˆ‘ä»¬ä¸å†æ„å»ºä¸€ä¸ªå·¨å¤§çš„ã€åŒ…å«æ‰€æœ‰é€»è¾‘çš„å›¾ã€‚è€Œæ˜¯å°†æ¯ä¸ªæ ¸å¿ƒåŠŸèƒ½éƒ½ç¼–è¯‘æˆä¸€ä¸ªç‹¬ç«‹çš„ <code>Runnable</code>ï¼š</p>
<ul>
<li><code>dispatcherRunnable</code>ï¼šè´Ÿè´£è°ƒåº¦ã€‚</li>
<li><code>coderRunnable</code>ï¼šä»£ç ä¸“å®¶ã€‚</li>
<li><code>generalRunnable</code>ï¼šé€šç”¨ä¸“å®¶ã€‚</li>
<li><code>qaRunnable</code>ï¼šè´¨æ£€å‘˜ã€‚</li>
</ul>
<p>ç„¶åï¼Œæˆ‘ä»¬åœ¨ Go ä»£ç ä¸­ç”¨ä¸€ä¸ªç®€å•çš„ <code>for</code> å¾ªç¯æ¥ç¼–æ’å®ƒä»¬çš„æ‰§è¡Œé¡ºåºï¼Œå®ç°â€œæ‰§è¡Œ -&gt; è´¨æ£€ -&gt; (å¤±è´¥åˆ™)é‡è¯•â€çš„é€»è¾‘ã€‚</p>
<h3 data-id="heading-14">ä»£ç å®æˆ˜ï¼šSelf-Correcting Agent</h3>
<p>ä¸‹é¢çš„ä»£ç å±•ç¤ºäº†å¦‚ä½•å°†ç‹¬ç«‹çš„ <code>Runnable</code> ç»„ä»¶åœ¨å¤–éƒ¨å¾ªç¯ä¸­è¿›è¡Œç¼–æ’ï¼Œä»¥å®ç°é‡è¯•é€»è¾‘ã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// ... (åˆ›å»º dispatcherRunnable, coderRunnable, generalRunnable, qaRunnable)</span>

<span class="hljs-comment">// éå†æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-keyword">for</span> _, tc := <span class="hljs-keyword">range</span> testCases {
    fmt.Printf(<span class="hljs-string">"\nğŸ” æµ‹è¯•ç”¨ä¾‹: %s\n"</span>, tc.name)
    fmt.Printf(<span class="hljs-string">"é—®é¢˜: %s\n"</span>, tc.question)

    <span class="hljs-comment">// --- è°ƒåº¦æ­¥éª¤ ---</span>
    fmt.Println(<span class="hljs-string">"ğŸ”„ è°ƒåº¦å™¨æ­£åœ¨åˆ†æé—®é¢˜..."</span>)
    decision, err := dispatcherRunnable.Invoke(ctx, tc.question)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        log.Fatalf(<span class="hljs-string">"âŒ è°ƒåº¦å¤±è´¥: %v"</span>, err)
    }
    fmt.Printf(<span class="hljs-string">"  è°ƒåº¦å†³ç­–: %s\n"</span>, decision)

    <span class="hljs-keyword">var</span> selectedExpertRunnable compose.Runnable[<span class="hljs-type">string</span>, *schema.Message]
    <span class="hljs-keyword">if</span> decision == <span class="hljs-string">"code"</span> {
        fmt.Println(<span class="hljs-string">"  è·¯ç”±åˆ°ä»£ç ä¸“å®¶ (qwen2.5:0.5b)"</span>)
        selectedExpertRunnable = coderRunnable
    } <span class="hljs-keyword">else</span> {
        fmt.Println(<span class="hljs-string">"  è·¯ç”±åˆ°é€šç”¨ä¸“å®¶ (qwen2.5:0.5b)"</span>)
        selectedExpertRunnable = generalRunnable
    }

    <span class="hljs-keyword">const</span> MAX_RETRIES = <span class="hljs-number">3</span>
    <span class="hljs-keyword">var</span> finalResult *schema.Message
    <span class="hljs-keyword">var</span> finalErr <span class="hljs-type">error</span>

    <span class="hljs-comment">// --- é‡è¯•å¾ªç¯ ---</span>
    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; MAX_RETRIES; i++ {
        fmt.Printf(<span class="hljs-string">"ğŸš€ ç¬¬ %d/%d æ¬¡å°è¯• (ä½¿ç”¨ %s ä¸“å®¶)...\n"</span>, i+<span class="hljs-number">1</span>, MAX_RETRIES, decision)
        result, err := selectedExpertRunnable.Invoke(ctx, tc.question)
        
        finalResult = result
        finalErr = err

        <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
            log.Printf(<span class="hljs-string">"âŒ æ‰§è¡Œå¤±è´¥: %v"</span>, err)
            <span class="hljs-keyword">break</span> <span class="hljs-comment">// æ‰§è¡Œå‡ºé”™ï¼Œç›´æ¥ä¸­æ–­é‡è¯•</span>
        }

        fmt.Printf(<span class="hljs-string">"  åˆæ­¥å›ç­”: %s\n"</span>, result.Content)

        <span class="hljs-comment">// --- è´¨æ£€æ­¥éª¤ ---</span>
        fmt.Println(<span class="hljs-string">"ğŸ” æ­£åœ¨è¿›è¡Œè´¨é‡æ£€æŸ¥..."</span>)
        quality, qaErr := qaRunnable.Invoke(ctx, &amp;QAInput{Question: tc.question, Answer: result.Content})

        <span class="hljs-keyword">if</span> qaErr != <span class="hljs-literal">nil</span> {
            log.Printf(<span class="hljs-string">"âš ï¸ è´¨æ£€æ­¥éª¤å¤±è´¥: %v. æ¥å—å½“å‰ç»“æœã€‚"</span>, qaErr)
            <span class="hljs-keyword">break</span> <span class="hljs-comment">// è´¨æ£€æœ¬èº«å‡ºé”™ï¼Œä¸å†é‡è¯•ï¼Œæ¥å—å½“å‰ç»“æœ</span>
        }

        fmt.Printf(<span class="hljs-string">"  è´¨æ£€ç»“æœ: %s\n"</span>, quality)

        <span class="hljs-keyword">if</span> quality == <span class="hljs-string">"good"</span> {
            fmt.Println(<span class="hljs-string">"âœ… è´¨æ£€é€šè¿‡ï¼Œç»“æœè¢«æ¥å—ã€‚"</span>)
            <span class="hljs-keyword">break</span> <span class="hljs-comment">// è´¨é‡åˆæ ¼ï¼Œè·³å‡ºé‡è¯•å¾ªç¯</span>
        } <span class="hljs-keyword">else</span> {
            fmt.Println(<span class="hljs-string">"âŒ è´¨æ£€æœªé€šè¿‡ï¼Œæ­£åœ¨é‡è¯•..."</span>)
            <span class="hljs-keyword">if</span> i == MAX_RETRIES<span class="hljs-number">-1</span> {
                fmt.Println(<span class="hljs-string">"è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œæ¥å—æœ€åä¸€æ¬¡ç»“æœã€‚"</span>)
            }
        }
    }

    <span class="hljs-comment">// ... æ‰“å°æœ€ç»ˆç»“æœ</span>
}
</code></pre>
<p>è¿™ç§æ¨¡å¼çš„ä¼˜åŠ¿åœ¨äºï¼š</p>
<ul>
<li><strong>é«˜åº¦è§£è€¦</strong>ï¼šæ¯ä¸ª <code>Runnable</code> éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ã€å¯æµ‹è¯•ã€å¯å¤ç”¨çš„ç»„ä»¶ã€‚</li>
<li><strong>é€»è¾‘æ¸…æ™°</strong>ï¼šå¤æ‚çš„ä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚é‡è¯•ã€ç†”æ–­ï¼‰å¯ä»¥ç”¨åŸç”Ÿçš„ Go ä»£ç ï¼ˆ<code>for</code>, <code>if</code>ï¼‰æ¥è¡¨è¾¾ï¼Œæ¯”åœ¨å›¾ç»“æ„ä¸­å®šä¹‰æ›´åŠ ç›´è§‚å’Œçµæ´»ã€‚</li>
<li><strong>å¯æ‰©å±•æ€§å¼º</strong>ï¼šæœªæ¥å¦‚æœæƒ³åŠ å…¥æ–°å·¥å…·ï¼ˆå¦‚æœç´¢å¼•æ“ã€æ•°æ®åº“æŸ¥è¯¢ï¼‰ï¼Œæˆ‘ä»¬åªéœ€å°†å…¶å°è£…æˆä¸€ä¸ªæ–°çš„ <code>Runnable</code>ï¼Œç„¶ååœ¨ç¼–æ’é€»è¾‘ä¸­è°ƒç”¨å®ƒå³å¯ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-15">æ€»ç»“</h2>
<p>é€šè¿‡æœ¬æ¬¡æ—…ç¨‹ï¼Œæˆ‘ä»¬ä»ä¸€ä¸ªç®€å•çš„ Eino â€œHello Worldâ€å‡ºå‘ï¼Œä¸€æ­¥æ­¥æ„å»ºäº†ä¸€ä¸ªå…·å¤‡æ™ºèƒ½è·¯ç”±å’Œè‡ªæˆ‘ä¿®æ­£èƒ½åŠ›çš„å¤æ‚ Agentã€‚æˆ‘ä»¬å­¦ä¹ äº†ï¼š</p>
<ol>
<li>å¦‚ä½•ä½¿ç”¨ <strong>Ollama</strong> åœ¨æœ¬åœ°æ­å»ºé«˜æ•ˆã€å…è´¹çš„ LLM æœåŠ¡ç¯å¢ƒã€‚</li>
<li>Eino æ¡†æ¶çš„åŸºæœ¬æ¦‚å¿µï¼š<strong>Graph</strong>ã€<strong>Node</strong> å’Œ <strong>Runnable</strong>ï¼Œä»¥åŠå¦‚ä½•é€‰æ‹©å®ƒä»¬ã€‚</li>
<li>å¦‚ä½•ä½¿ç”¨ <strong>BranchNode</strong> å®ç°å·¥ä½œæµçš„åŠ¨æ€è·¯ç”±ã€‚</li>
<li>å¦‚ä½•é€šè¿‡<strong>è§£è€¦ç»„ä»¶</strong>å’Œ<strong>å¤–éƒ¨ç¼–æ’</strong>ï¼Œæ„å»ºå‡ºé€»è¾‘æ¸…æ™°ã€å¯æ‰©å±•æ€§å¼ºçš„å¤æ‚ AI åº”ç”¨ã€‚</li>
</ol>
<p>Eino ä½œä¸ºä¸€ä¸ª Go-native çš„ LLM åº”ç”¨æ¡†æ¶ï¼Œå…¶å£°æ˜å¼çš„å›¾æ„å»ºæ–¹å¼å’Œå¼ºå¤§çš„å¯ç»„åˆæ€§ï¼Œä¸º Go å¼€å‘è€…æ‰“å¼€äº†é€šå¾€ AI åº”ç”¨ä¸–ç•Œçš„å¤§é—¨ã€‚å¸Œæœ›è¿™ç¯‡åšå®¢èƒ½æˆä¸ºä½ æ¢ç´¢ Eino å’Œå¤§æ¨¡å‹åº”ç”¨çš„èµ·ç‚¹ã€‚ç°åœ¨ï¼Œå°±åŠ¨æ‰‹å®è·µï¼Œæ„å»ºä½ è‡ªå·±çš„æ™ºèƒ½åº”ç”¨å§ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¼€ç®±å³ç”¨æ„å»ºåº”ç”¨ç¯å¢ƒï¼šopenEuleræ˜“è·å¾—æ€§æ·±åº¦éªŒè¯]]></title>    <link>https://juejin.cn/post/7580550040395513891</link>    <guid>https://juejin.cn/post/7580550040395513891</guid>    <pubDate>2025-12-07T12:59:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580550040395513891" data-draft-id="7580423629164986420" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¼€ç®±å³ç”¨æ„å»ºåº”ç”¨ç¯å¢ƒï¼šopenEuleræ˜“è·å¾—æ€§æ·±åº¦éªŒè¯"/> <meta itemprop="keywords" content="æ¶æ„,è®¾è®¡æ¨¡å¼,Redis"/> <meta itemprop="datePublished" content="2025-12-07T12:59:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Eren7Yç³"/> <meta itemprop="url" content="https://juejin.cn/user/2881162743383176"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¼€ç®±å³ç”¨æ„å»ºåº”ç”¨ç¯å¢ƒï¼šopenEuleræ˜“è·å¾—æ€§æ·±åº¦éªŒè¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2881162743383176/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Eren7Yç³
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T12:59:04.000Z" title="Sun Dec 07 2025 12:59:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨å½“ä»Šå¿«é€Ÿè¿­ä»£çš„å¼€å‘ç¯å¢ƒä¸­ï¼Œå¼€å‘ç¯å¢ƒçš„å¿«é€Ÿæ­å»ºå’ŒéªŒè¯æˆä¸ºæå‡å¼€å‘æ•ˆç‡çš„å…³é”®ç¯èŠ‚ã€‚æœ¬æ–‡é€šè¿‡åœ¨VMwareè™šæ‹Ÿæœºä¸­éƒ¨ç½²openEuleræ“ä½œç³»ç»Ÿï¼Œå®Œæ•´éªŒè¯åœ¨è¯¥å¹³å°ä¸Šè·å–åº”ç”¨è¿è¡Œæ—¶çš„ä¾¿æ·æ€§å’Œæ€§èƒ½è¡¨ç°ï¼Œä¸ºå¼€å‘è€…æä¾›ç¯å¢ƒæ­å»ºå‚è€ƒã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/764cd9f7d98a46b6b7606f227840a0c6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJlbjdZ55Cz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765717144&amp;x-signature=ViQDSn80kAkOZ%2FpXB6PNxKdBYRs%3D" alt="image.png" loading="lazy"/></p>
<p><strong>æœ¬æ–‡æµ‹è¯„ç‚¹</strong>ï¼šåœ¨ä¸ªäººç”µè„‘çš„è™šæ‹Ÿæœºä¸­ï¼Œä»é›¶å¼€å§‹è·å–å’Œéƒ¨ç½²ä¸€å¥—å®Œæ•´ï¼ˆNginx + Redis + MySQL + AIï¼‰åº”ç”¨ç¯å¢ƒçš„ä¾¿æ·ç¨‹åº¦ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€æµ‹è¯•ç¯å¢ƒæ­å»º</h2>
<h3 data-id="heading-1">1.è™šæ‹Ÿæœºé…ç½®ä¸ç³»ç»Ÿå®‰è£…</h3>
<p>openEulerçš„è·å–è¿‡ç¨‹ä½“ç°äº†å¼€æºé¡¹ç›®çš„å¼€æ”¾æ€§ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ul>
<li>è®¿é—®openEulerå®˜ç½‘ï¼Œä¸‹è½½22.03 LTS SP3ç‰ˆæœ¬çš„"Offline Standard ISO"</li>
<li>ä½¿ç”¨VirtualBoxæˆ–VMware Workstationåˆ›å»ºè™šæ‹Ÿæœº</li>
<li>æ“ä½œç³»ç»Ÿç±»å‹é€‰æ‹©Linuxï¼Œç‰ˆæœ¬é€‰æ‹©Other Linux (64-bit)</li>
<li>å»ºè®®é…ç½®ï¼šè‡³å°‘2æ ¸CPUã€4GBå†…å­˜ã€25GBç¡¬ç›˜</li>
<li>åœ¨è™šæ‹Ÿæœºè®¾ç½®ä¸­æŒ‚è½½ä¸‹è½½çš„ISOæ–‡ä»¶</li>
<li>å¯åŠ¨å®‰è£…ï¼Œé€‰æ‹©"Server with GUI"å®‰è£…ç±»å‹</li>
<li>è®¾ç½®rootå¯†ç å¹¶åˆ›å»ºæ™®é€šç”¨æˆ·</li>
</ul>
<p>å®‰è£…è¿‡ç¨‹é€‰æ‹©æœ€å°åŒ–å®‰è£…æ¨¡å¼ï¼Œä½“ç°äº†openEuleråœ¨éƒ¨ç½²æ•ˆç‡æ–¹é¢çš„ä¼˜åŠ¿ã€‚</p>
<h3 data-id="heading-2">2.ç³»ç»ŸåŸºç¡€é…ç½®</h3>
<p>å®‰è£…å®Œæˆåï¼Œé¦–å…ˆæ›´æ–°ç³»ç»Ÿè‡³æœ€æ–°çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">sudo dnf <span class="hljs-keyword">update</span> <span class="hljs-operator">-</span>y
sudo reboot
</code></pre>
<p>ç³»ç»Ÿæ›´æ–°è¿‡ç¨‹é¡ºç•…ï¼Œè½¯ä»¶åŒ…ä¾èµ–å…³ç³»è‡ªåŠ¨è§£ææ­£ç¡®ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ebfb78ed2adb4dd5b8e786933ea7f64e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJlbjdZ55Cz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765717144&amp;x-signature=a9e%2BsVPzU3YS2xWQ8M2SJkIw2Kg%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-3">äºŒã€åº”ç”¨ç¯å¢ƒå¿«é€Ÿéƒ¨ç½²</h2>
<h3 data-id="heading-4">1.ä¸€ç«™å¼ç»„ä»¶å®‰è£…</h3>
<p>æŒ‰ç…§æµ‹è¯•è¦æ±‚ï¼Œæˆ‘ä»¬æ‰§è¡Œåº”ç”¨ç¯å¢ƒçš„éƒ¨ç½²å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-perl" lang="perl">sudo dnf install -<span class="hljs-keyword">y</span> nginx redis mysql-server
sudo pip3 install -i https:<span class="hljs-regexp">//mirr</span>ors.aliyun.com/pypi/simple/ onnxruntime --<span class="hljs-keyword">no</span>-cache-dir
</code></pre>
<p>å®‰è£…è¿‡ç¨‹å®æ—¶ç›‘æ§æ˜¾ç¤ºï¼Œæ‰€æœ‰è½¯ä»¶åŒ…ä»openEulerå®˜æ–¹ä»“åº“é¡ºåˆ©ä¸‹è½½ï¼Œä¾èµ–è§£æå®Œæ•´ï¼Œæ— å†²çªæŠ¥é”™ï¼Œä½“ç°äº†è½¯ä»¶ä»“åº“çš„å“åº”é€Ÿåº¦å’Œç»„ä»¶å®Œæ•´æ€§ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/39953dbab4ac4fbeab7f720f049cb24e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJlbjdZ55Cz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765717144&amp;x-signature=uFE%2BsYEWuUoQCHJQR%2FG%2Fqjn%2F%2Fh4%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65d7e9a477c64dc8848304b5b490da1d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJlbjdZ55Cz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765717144&amp;x-signature=p6bJuh1K6CxQRlvwkAnt0A32E%2BI%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-5">2.æœåŠ¡å¯åŠ¨ä¸çŠ¶æ€éªŒè¯</h3>
<p>ç»„ä»¶å®‰è£…å®Œæˆåï¼Œç«‹å³å¯åŠ¨å„é¡¹æœåŠ¡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">sudo systemctl <span class="hljs-built_in">enable</span> --now nginx redis mysqld
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4bffa0a44d794819910ea3bfb5596b66~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJlbjdZ55Cz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765717144&amp;x-signature=RXXpIh0q9497YawdWRAah%2BrwCts%3D" alt="image.png" loading="lazy"/></p>
<p>é€šè¿‡ç³»ç»ŸçŠ¶æ€å‘½ä»¤éªŒè¯æœåŠ¡è¿è¡Œæƒ…å†µï¼š</p>
<pre><code class="hljs language-lua" lang="lua">sudo systemctl <span class="hljs-built_in">status</span> nginx redis mysqld
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/73150994928e4ae3867bc5b71224053e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJlbjdZ55Cz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765717144&amp;x-signature=51gfDhGRR45r1hRQic12Jwtin7s%3D" alt="image.png" loading="lazy"/></p>
<p>çŠ¶æ€æ£€æŸ¥ç¡®è®¤æ‰€æœ‰æœåŠ¡å‡ä¸ºactive (running)çŠ¶æ€ï¼Œä»å¼€å§‹æ‰§è¡Œå®‰è£…åˆ°å…¨æœåŠ¡å°±ç»ªï¼Œå‡åœ¨ç›®æ ‡æ—¶é—´å†…å®Œæˆç¯å¢ƒæ­å»ºã€‚</p>
<hr/>
<h2 data-id="heading-6">ä¸‰ã€åŸºç¡€åŠŸèƒ½éªŒè¯æµ‹è¯•</h2>
<h3 data-id="heading-7">1.WebæœåŠ¡åŠŸèƒ½éªŒè¯</h3>
<p>é€šè¿‡curlå‘½ä»¤æµ‹è¯•NginxæœåŠ¡å“åº”ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">curl -I http:<span class="hljs-comment">//localhost</span>
</code></pre>
<p>è¿”å›HTTP/1.1 200 OKçŠ¶æ€ç ï¼Œç¡®è®¤WebæœåŠ¡æ­£å¸¸è¿è¡Œã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/edda89d06326408e90dd1b43da860b3b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJlbjdZ55Cz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765717144&amp;x-signature=q4IJlfyT2lik%2FIJFvsoinRFw9L4%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-8">2.æ•°æ®æœåŠ¡åŠŸèƒ½éªŒè¯</h3>
<h4 data-id="heading-9">2.1RedisåŸºç¡€å‘½ä»¤æµ‹è¯•ï¼š</h4>
<pre><code class="hljs language-arduino" lang="arduino">redis-cli set <span class="hljs-string">"test:openEuler"</span> <span class="hljs-string">"Hello"</span> &amp;&amp; redis-cli get <span class="hljs-string">"test:openEuler"</span>
</code></pre>
<p>æˆåŠŸè¿”å›"Hello"å€¼ï¼Œè¯æ˜é”®å€¼å­˜å‚¨åŠŸèƒ½æ­£å¸¸ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0088afdad03a424d8a4985d6b0b59a64~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJlbjdZ55Cz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765717144&amp;x-signature=kcePQmCWFCsj01vvu95GyGv6PjA%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-10">2.2MySQLæ•°æ®åº“è¿æ¥æµ‹è¯•ï¼š</h4>
<pre><code class="hljs language-arduino" lang="arduino">sudo mysql -e <span class="hljs-string">"SHOW DATABASES;"</span>
</code></pre>
<p>æˆåŠŸæ˜¾ç¤ºç³»ç»Ÿæ•°æ®åº“åˆ—è¡¨ï¼Œæ•°æ®åº“æœåŠ¡è¿è¡Œç¨³å®šã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/05fce9719b1644df8146fc7cef992d3c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJlbjdZ55Cz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765717144&amp;x-signature=BwX26dfdy%2FLj%2BLeBvKmGcx%2F70VA%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-11">2.3AIç¯å¢ƒéªŒè¯</h4>
<p>ONNX Runtimeå¯¼å…¥æµ‹è¯•ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">python3 -c "import onnxruntime; <span class="hljs-built_in">print</span>('ok')"
</code></pre>
<p>æˆåŠŸè¾“å‡ºå¯¼å…¥ç¡®è®¤ä¿¡æ¯ï¼ŒAIæ¨ç†ç¯å¢ƒé…ç½®æ­£ç¡®ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a90d8d3a7c9b4655a42557b046244547~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJlbjdZ55Cz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765717144&amp;x-signature=GHTxWAUlWhuOsrfuezvk0v29e%2B4%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-12">å››ã€æ€§èƒ½æ·±åº¦æµ‹è¯•åˆ†æ</h2>
<h3 data-id="heading-13">1.WebæœåŠ¡å™¨æ€§èƒ½æµ‹è¯•</h3>
<p>ä½¿ç”¨Apache Benchè¿›è¡ŒNginxå‹åŠ›æµ‹è¯•ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">sudo dnf install -y httpd-tools
ab -n <span class="hljs-number">10000</span> -c <span class="hljs-number">100</span> http:<span class="hljs-comment">//localhost/</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d06670bd31054115baade1d264d8cadb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJlbjdZ55Cz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765717144&amp;x-signature=DrP7h93jTtn1U0KKmSAtUi%2Bl7SM%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8e90d4a555c14627ba4294adf5b053ee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJlbjdZ55Cz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765717144&amp;x-signature=YoTzAIWVcP8917B0Tn58RbNy%2FOE%3D" alt="image.png" loading="lazy"/> æµ‹è¯•ç»“æœï¼š</p>
<ul>
<li>è¯·æ±‚å¤„ç†æ€»æ•°ï¼š10,000æ¬¡</li>
<li>å¹¶å‘ç”¨æˆ·æ•°ï¼š100ä¸ª</li>
<li>æµ‹è¯•æ—¶é•¿ï¼š0.854 ç§’</li>
<li>æ¯ç§’å¤„ç†è¯·æ±‚ï¼š11709.09 æ¬¡/ç§’</li>
<li>95% è¯·æ±‚å“åº”æ—¶é—´ï¼š11 ms</li>
</ul>
<p>Nginxåœ¨openEulerä¸Šè¡¨ç°å‡ºä¼˜å¼‚çš„è¯·æ±‚å¤„ç†èƒ½åŠ›ï¼Œé«˜å¹¶å‘åœºæ™¯ä¸‹ä¿æŒç¨³å®šçš„å“åº”æ€§èƒ½ã€‚</p>
<h3 data-id="heading-14">2.å†…å­˜æ•°æ®åº“æ€§èƒ½æµ‹è¯•</h3>
<p>é€šè¿‡redis-benchmarkè¿›è¡Œå…¨é¢æ€§èƒ½è¯„ä¼°ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">redis-benchmark -t set,get,lpush,lpop -n <span class="hljs-number">100000</span> -c <span class="hljs-number">50</span> -q
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/054ab26701f04f6589f4e694a2e7dcc7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJlbjdZ55Cz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765717144&amp;x-signature=VifsLfkCxUBHLzpRziaoBES7FOo%3D" alt="image.png" loading="lazy"/> æ€§èƒ½æµ‹è¯•ç»“æœï¼š</p>
<ul>
<li>SETæ“ä½œï¼š134408.59 ops/sec</li>
<li>GETæ“ä½œï¼š139868.14 ops/sec</li>
<li>LPUSHæ“ä½œï¼š137931.03 ops/sec</li>
<li>LPOPæ“ä½œï¼š138584.16 ops/sec</li>
</ul>
<p>Redisåœ¨openEulerä¸Šçš„æ€§èƒ½è¡¨ç°å“è¶Šï¼Œå„é¡¹æ“ä½œå‡è¾¾åˆ°ä¸šç•Œä¼˜ç§€æ°´å¹³ã€‚</p>
<h3 data-id="heading-15">3.æ•°æ®åº“ç»¼åˆæ€§èƒ½æµ‹è¯•</h3>
<p>ä½¿ç”¨sysbenchè¿›è¡ŒMySQLå…¨é¢æ€§èƒ½è¯„ä¼°ï¼š</p>
<pre><code class="hljs language-css" lang="css">sudo dnf install -y sysbench
sudo mysql -e "CREATE DATABASE sbtest;"
sysbench oltp_read_write <span class="hljs-attr">--table-size</span>=<span class="hljs-number">1000000</span> <span class="hljs-attr">--mysql-user</span>=root <span class="hljs-attr">--threads</span>=<span class="hljs-number">8</span> <span class="hljs-attr">--time</span>=<span class="hljs-number">300</span> prepare
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/192d1e0ea42e445ebe1a257cc110a0a5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJlbjdZ55Cz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765717144&amp;x-signature=dPbvtYajrrQdDylD5eFQUX7oBKk%3D" alt="image.png" loading="lazy"/> æ•°æ®åº“æ€§èƒ½æŒ‡æ ‡ï¼š</p>
<ul>
<li>æ€»äº‹åŠ¡æ•°ï¼š180,785 æ¬¡</li>
<li>æ¯ç§’äº‹åŠ¡æ•°ï¼š602.53 tps</li>
<li>å¹³å‡å»¶è¿Ÿï¼š13.27 ms</li>
<li>95%å»¶è¿Ÿï¼š22.28 ms</li>
<li>é”™è¯¯äº‹åŠ¡æ•°ï¼š0ï¼ˆæ— é”™è¯¯ï¼‰</li>
</ul>
<p>MySQLåœ¨é•¿æ—¶é—´é«˜è´Ÿè½½æµ‹è¯•ä¸­è¡¨ç°ç¨³å®šï¼Œäº‹åŠ¡å¤„ç†ä¸€è‡´æ€§è‰¯å¥½ã€‚</p>
<h3 data-id="heading-16">4.AIæ¨ç†æ€§èƒ½æµ‹è¯•</h3>
<p>åŸºäºONNX Runtimeè¿›è¡Œæ¨¡å‹æ¨ç†æ€§èƒ½æµ‹è¯•ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">import onnxruntime as ort
import numpy as np
import time

<span class="hljs-comment"># åˆ›å»ºæ¨¡æ‹Ÿæ¨ç†ä¼šè¯</span>
<span class="hljs-attr">sess_options</span> = ort.SessionOptions()
<span class="hljs-attr">sess_options.intra_op_num_threads</span> = <span class="hljs-number">4</span>

<span class="hljs-comment"># æ€§èƒ½æµ‹è¯•å¾ªç¯</span>
<span class="hljs-attr">start_time</span> = time.time()
for i in range(1000):
    <span class="hljs-comment"># æ¨¡æ‹Ÿæ¨¡å‹æ¨ç†</span>
    <span class="hljs-attr">input_data</span> = np.random.random((<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">224</span>, <span class="hljs-number">224</span>)).astype(np.float32)
<span class="hljs-attr">end_time</span> = time.time()

print(f"Data processing throughput: {1000/(end_time-start_time):.2f} operations/sec")
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/22d13ea62a834888bcdd640566412be2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJlbjdZ55Cz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765717144&amp;x-signature=7r2gT5SInaDl3iXW6pULUwVDRFo%3D" alt="image.png" loading="lazy"/> æµ‹è¯•ç»“æœæ˜¾ç¤ºï¼ŒONNX Runtimeåœ¨openEulerä¸Šçš„è®¡ç®—å›¾ä¼˜åŒ–æ•ˆæœæ˜¾è‘—ï¼Œä¸ºAIåº”ç”¨æä¾›äº†é«˜æ•ˆçš„æ¨ç†åŸºç¡€ã€‚</p>
<hr/>
<h2 data-id="heading-17">äº”ã€ç³»ç»Ÿèµ„æºæ•ˆç‡åˆ†æ</h2>
<p>åœ¨å…¨æœåŠ¡è¿è¡ŒçŠ¶æ€ä¸‹ï¼Œé€šè¿‡ç³»ç»Ÿç›‘æ§å·¥å…·åˆ†æèµ„æºä½¿ç”¨æƒ…å†µï¼š</p>
<pre><code class="hljs language-css" lang="css">å®æ—¶ç›‘æ§ç³»ç»Ÿèµ„æº
<span class="hljs-attribute">top</span> -d <span class="hljs-number">1</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f9e48c811b0a417280fcb44499fd6da7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJlbjdZ55Cz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765717144&amp;x-signature=oKasyvY9R7QLbmsMouPBzabcrSI%3D" alt="image.png" loading="lazy"/> èµ„æºä½¿ç”¨ç»Ÿè®¡ï¼š</p>
<ul>
<li>æ€»å†…å­˜ä½¿ç”¨ï¼š0.76GB</li>
<li>CPUå¹³å‡ä½¿ç”¨ç‡ï¼š9.5%ï¼ˆç©ºé—²çŠ¶æ€ï¼‰</li>
<li>å„æœåŠ¡å†…å­˜åˆ†å¸ƒï¼š
<ul>
<li>MySQLï¼š419.7MB</li>
<li>Redisï¼š14.1MB</li>
<li>ç³»ç»Ÿç©ºé—²å†…å­˜ï¼š0.23GB</li>
</ul>
</li>
</ul>
<p>èµ„æºç›‘æ§è¡¨æ˜ï¼ŒopenEuleråœ¨åº”ç”¨ç¯å¢ƒè¿è¡Œæ—¶çš„èµ„æºåˆ©ç”¨æ•ˆç‡ä¼˜ç§€ï¼Œä¸ºåº”ç”¨ç¨‹åºç•™å‡ºäº†å……è¶³çš„èµ„æºç©ºé—´ã€‚</p>
<hr/>
<h2 data-id="heading-18">å…­ã€æŠ€æœ¯ç”Ÿæ€å…¼å®¹æ€§éªŒè¯</h2>
<h3 data-id="heading-19">1.è½¯ä»¶åŒ…ç®¡ç†ä½“éªŒ</h3>
<p>openEulerçš„dnfåŒ…ç®¡ç†å™¨åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­è¡¨ç°å‡ºè‰²ï¼š</p>
<ul>
<li>è½¯ä»¶æ£€ç´¢é€Ÿåº¦å¿«ï¼Œä»“åº“å“åº”åŠæ—¶</li>
<li>ä¾èµ–è§£æå‡†ç¡®ï¼Œæ— ç‰ˆæœ¬å†²çª</li>
<li>å®‰è£…è¿‡ç¨‹è‡ªåŠ¨åŒ–ç¨‹åº¦é«˜ï¼Œæ— éœ€äººå·¥å¹²é¢„</li>
</ul>
<h3 data-id="heading-20">2.å¼€å‘å·¥å…·é“¾é›†æˆ</h3>
<p>é¢å¤–æµ‹è¯•äº†å¸¸ç”¨å¼€å‘å·¥å…·çš„å¯ç”¨æ€§ï¼š</p>
<pre><code class="hljs language-go" lang="go">sudo dnf install -y gcc gdb <span class="hljs-built_in">make</span> cmake git
</code></pre>
<p>æ‰€æœ‰å¼€å‘å·¥å…·å‡é¡ºåˆ©å®‰è£…ï¼Œç‰ˆæœ¬å…¼å®¹æ€§è‰¯å¥½ï¼Œä¸ºå„ç±»å¼€å‘åœºæ™¯æä¾›äº†å®Œå–„çš„æ”¯æŒã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f753465b2347426d8bce848e6e06c7ee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJlbjdZ55Cz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765717144&amp;x-signature=I4VE1M742kMKTUZ%2BdYg5f9NgotA%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-21">ä¸ƒã€åº”ç”¨åœºæ™¯å®è·µéªŒè¯</h2>
<p>åŸºäºæ­å»ºçš„åº”ç”¨ç¯å¢ƒï¼Œæˆ‘ä»¬éƒ¨ç½²äº†ç¤ºä¾‹åº”ç”¨è¿›è¡Œå®é™…éªŒè¯ï¼š</p>
<h3 data-id="heading-22">1.å¾®æœåŠ¡åº”ç”¨éƒ¨ç½²æµ‹è¯•</h3>
<p>éƒ¨ç½²åŸºäºSpring Bootçš„å¾®æœåŠ¡åº”ç”¨ï¼ŒéªŒè¯ç¯å¢ƒå…¼å®¹æ€§ï¼š</p>
<ul>
<li>åº”ç”¨å¯åŠ¨æ­£å¸¸ï¼ŒæœåŠ¡æ³¨å†ŒæˆåŠŸ</li>
<li>æ•°æ®åº“è¿æ¥ç¨³å®šï¼Œæ•°æ®æŒä¹…åŒ–å¯é </li>
<li>Redisç¼“å­˜åŠŸèƒ½æ­£å¸¸ï¼Œæ€§èƒ½æå‡æ˜æ˜¾</li>
</ul>
<h3 data-id="heading-23">2.Webåº”ç”¨æ€§èƒ½å®æµ‹</h3>
<p>éƒ¨ç½²é™æ€èµ„æºç«™ç‚¹ï¼Œæµ‹è¯•NginxæœåŠ¡èƒ½åŠ›ï¼š</p>
<ul>
<li>é™æ€èµ„æºåŠ è½½è¿…é€Ÿï¼Œå“åº”æ—¶é—´&lt;10ms</li>
<li>å¹¶å‘è®¿é—®æµ‹è¯•é€šè¿‡ï¼Œæ— è¯·æ±‚ä¸¢å¤±</li>
<li>é•¿æ—¶é—´è¿è¡Œç¨³å®šï¼Œæ— æœåŠ¡ä¸­æ–­</li>
</ul>
<hr/>
<h2 data-id="heading-24">å…«ã€æ˜“è·å¾—æ€§æŠ€æœ¯ä»·å€¼åˆ†æ</h2>
<p>openEuleråœ¨ç¯å¢ƒæ­å»ºæ–¹é¢å±•ç°å‡ºçš„æ˜“è·å¾—æ€§ï¼Œä¸»è¦æºäºä»¥ä¸‹æŠ€æœ¯ç‰¹æ€§ï¼š</p>
<h3 data-id="heading-25">1.å®Œå–„çš„è½¯ä»¶ç”Ÿæ€</h3>
<p>openEulerå®˜æ–¹ä»“åº“æ”¶å½•äº†ä¸»æµå¼€å‘å·¥å…·å’Œè¿è¡Œæ—¶ç¯å¢ƒï¼Œè¦†ç›–äº†åº”ç”¨å¼€å‘çš„å„ä¸ªæ–¹é¢ã€‚è½¯ä»¶åŒ…ç»è¿‡ä¸¥æ ¼æµ‹è¯•ï¼Œç¡®ä¿ç‰ˆæœ¬å…¼å®¹æ€§å’Œç¨³å®šæ€§ã€‚</p>
<h3 data-id="heading-26">2.æ™ºèƒ½çš„ä¾èµ–ç®¡ç†</h3>
<p>dnfåŒ…ç®¡ç†å™¨å…·å¤‡æ™ºèƒ½ä¾èµ–è§£æèƒ½åŠ›ï¼Œèƒ½å¤Ÿè‡ªåŠ¨å¤„ç†å¤æ‚çš„ä¾èµ–å…³ç³»ï¼Œå‡å°‘å¼€å‘è€…çš„ç¯å¢ƒé…ç½®è´Ÿæ‹…ã€‚</p>
<h3 data-id="heading-27">3.ä¼˜åŒ–çš„æœåŠ¡é›†æˆ</h3>
<p>ç³»ç»ŸæœåŠ¡ç®¡ç†é›†æˆåº¦é«˜ï¼ŒæœåŠ¡å¯åŠ¨å’Œé…ç½®è¿‡ç¨‹æ ‡å‡†åŒ–ï¼Œé™ä½äº†è¿ç»´å¤æ‚åº¦ã€‚</p>
<hr/>
<h2 data-id="heading-28">ä¹ã€æ€»ç»“ä¸å±•æœ›</h2>
<p>é€šè¿‡æœ¬æ¬¡æ·±åº¦æµ‹è¯•éªŒè¯ï¼ŒopenEuleråœ¨åº”ç”¨è¿è¡Œæ—¶çš„æ˜“è·å¾—æ€§æ–¹é¢è¡¨ç°å‡ºè‰²ã€‚ä»ç¯å¢ƒæ­å»ºåˆ°æ€§èƒ½éªŒè¯çš„å®Œæ•´æµç¨‹è¡¨æ˜ï¼š</p>
<p><strong>éƒ¨ç½²æ•ˆç‡å“è¶Šï¼š</strong> å®Œæˆç¯å¢ƒæ­å»ºè€—æ—¶çŸ­ï¼Œè¿œè¶…ä¼ ç»Ÿç¯å¢ƒéƒ¨ç½²æ•ˆç‡ï¼Œæå¤§æå‡äº†å¼€å‘è€…çš„å·¥ä½œæ•ˆç‡ã€‚ <strong>æ€§èƒ½è¡¨ç°ä¼˜å¼‚ï¼š</strong> å„ç»„ä»¶åœ¨æ ‡å‡†æµ‹è¯•ä¸­å‡å±•ç°å‡ºä¼˜ç§€çš„æ€§èƒ½æŒ‡æ ‡ï¼Œèƒ½å¤Ÿæ»¡è¶³ä¼ä¸šçº§åº”ç”¨çš„éœ€æ±‚ã€‚ <strong>ç”Ÿæ€å®Œå–„åº¦é«˜ï¼š</strong> è½¯ä»¶ä»“åº“è¦†ç›–å…¨é¢ï¼Œä¾èµ–ç®¡ç†æ™ºèƒ½ï¼Œä¸ºå¼€å‘è€…æä¾›äº†å¼€ç®±å³ç”¨çš„å®Œæ•´ä½“éªŒã€‚ <strong>èµ„æºåˆ©ç”¨é«˜æ•ˆï¼š</strong> ç³»ç»Ÿèµ„æºè°ƒåº¦ä¼˜åŒ–è‰¯å¥½ï¼Œåœ¨ä¿è¯æœåŠ¡æ€§èƒ½çš„åŒæ—¶ï¼Œä¸ºåº”ç”¨ç•™å‡ºäº†å……è¶³çš„èµ„æºç©ºé—´ã€‚</p>
<p>openEuleré€šè¿‡å…¶æˆç†Ÿçš„æŠ€æœ¯ç”Ÿæ€å’Œä¼˜åŒ–çš„ç³»ç»Ÿæ¶æ„ï¼Œä¸ºå¼€å‘è€…æä¾›äº†çœŸæ­£æ„ä¹‰ä¸Šçš„"å¼€ç®±å³ç”¨"å¼€å‘ç¯å¢ƒã€‚è¿™ç§é«˜åº¦çš„æ˜“è·å¾—æ€§ä¸ä»…é™ä½äº†æŠ€æœ¯é—¨æ§›ï¼Œæ›´æ˜¾è‘—æå‡äº†å¼€å‘æ•ˆç‡ï¼Œä¸ºç°ä»£åº”ç”¨å¼€å‘æä¾›äº†åšå®å¯é çš„åŸºç¡€å¹³å°ã€‚</p>
<p>éšç€æ•°å­—åŒ–è½¬å‹çš„æ·±å…¥ï¼ŒopenEuleråœ¨æ˜“è·å¾—æ€§æ–¹é¢çš„æŒç»­ä¼˜åŒ–å°†è¿›ä¸€æ­¥æå‡å…¶åœ¨å¼€å‘ç¤¾åŒºçš„å¸å¼•åŠ›ï¼Œä¸ºå¼€æºæ“ä½œç³»ç»Ÿç”Ÿæ€çš„å‘å±•æ³¨å…¥æ–°çš„æ´»åŠ›ã€‚</p>
<blockquote>
<p>å¦‚æœæ‚¨æ­£åœ¨å¯»æ‰¾é¢å‘æœªæ¥çš„å¼€æºæ“ä½œç³»ç»Ÿï¼Œä¸å¦¨çœ‹çœ‹DistroWatch æ¦œå•ä¸­å¿«é€Ÿä¸Šå‡çš„ openEuler: <a href="https://link.juejin.cn?target=https%3A%2F%2Fdistrowatch.com%2Ftable-mobile.php%3Fdistribution%3Dopeneuler" target="_blank" title="https://distrowatch.com/table-mobile.php?distribution=openeuler" ref="nofollow noopener noreferrer">distrowatch.com/table-mobilâ€¦</a>ï¼Œä¸€ä¸ªç”±å¼€æ”¾åŸå­å¼€æºåŸºé‡‘ä¼šå­µåŒ–ã€æ”¯æŒâ€œè¶…èŠ‚ç‚¹â€åœºæ™¯çš„Linux å‘è¡Œç‰ˆã€‚<br/> openEulerå®˜ç½‘ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.openeuler.openatom.cn%2Fzh%2F" target="_blank" title="https://www.openeuler.openatom.cn/zh/" ref="nofollow noopener noreferrer">www.openeuler.openatom.cn/zh/</a></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[VibeCodingå®è·µï¼ŒSpec+Claude Codeå°ç¨‹åºå¼€å‘]]></title>    <link>https://juejin.cn/post/7580378958073348106</link>    <guid>https://juejin.cn/post/7580378958073348106</guid>    <pubDate>2025-12-07T10:16:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580378958073348106" data-draft-id="7580373352420425754" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="VibeCodingå®è·µï¼ŒSpec+Claude Codeå°ç¨‹åºå¼€å‘"/> <meta itemprop="keywords" content="åç«¯,VibeCoding,Claude"/> <meta itemprop="datePublished" content="2025-12-07T10:16:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°é•‡cxy"/> <meta itemprop="url" content="https://juejin.cn/user/3318776686718483"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            VibeCodingå®è·µï¼ŒSpec+Claude Codeå°ç¨‹åºå¼€å‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3318776686718483/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°é•‡cxy
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T10:16:21.000Z" title="Sun Dec 07 2025 10:16:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¿«é€Ÿå¼€å§‹ï¼ˆå®‰è£…Claude Codeï¼‰</h2>
<h3 data-id="heading-1">å®‰è£… Node.jsï¼ˆå·²å®‰è£…å¯è·³è¿‡ï¼‰</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Ubuntu / Debian ç”¨æˆ·</span>
curl -fsSL https://deb.nodesource.com/setup_lts.x | sudo bash -
sudo apt-get install -y nodejs
node --version
â€‹
<span class="hljs-comment"># macOS ç”¨æˆ·</span>
sudo xcode-select --install
/bin/bash -c <span class="hljs-string">"<span class="hljs-subst">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)</span>"</span>
brew install node
node --version
</code></pre>
<h3 data-id="heading-2">å®‰è£…claude-code</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fanthropics%2Fclaude-code" target="_blank" title="https://github.com/anthropics/claude-code" ref="nofollow noopener noreferrer">github.com/anthropics/â€¦</a></p>
<pre><code class="hljs language-sql" lang="sql">npm install <span class="hljs-operator">-</span>g <span class="hljs-variable">@anthropic</span><span class="hljs-operator">-</span>ai<span class="hljs-operator">/</span>claude<span class="hljs-operator">-</span>code
claude <span class="hljs-comment">--version</span>
</code></pre>
<h3 data-id="heading-3">æ¨èé•œåƒç«™</h3>
<p>åœ¨Vibe Codingæ—¶æ¯”è¾ƒå¤´ç–¼çš„æ˜¯æ¨¡å‹ï¼Œå·¥å…·æ˜¯æœ‰å·®è·ï¼Œæ¨¡å‹çš„ä¹Ÿæ˜¯æœ‰å·®è·çš„ã€‚ä½¿ç”¨å›½å¤–çš„æ¨¡å‹è´­ä¹°æ¯”è¾ƒæ˜‚è´µã€‚è¿™é‡Œæ¨è<code>AnyRouter</code>è¿™ä¸ªé•œåƒç«™ï¼Œå¯ä»¥å…è´¹ä½¿ç”¨Claudeçš„æ¨¡å‹ï¼Œæ¯æ—¥ç­¾åˆ°è¿˜é€ä½™é¢ã€‚ä½¿ç”¨ä¸‹é¢çš„é‚€è¯·ç æ³¨å†Œè¿˜èƒ½è·å¾—50$ä½“éªŒé‡‘ã€‚æœ¬äººå·²ç»ä½¿ç”¨äº†åŠå¹´ä¹‹ä¹…äº†ï¼Œå¶å°”ä¼šå‡ºç°ä¸­æ–­çš„æƒ…å½¢ï¼Œä½†æ˜¯å®ƒæ˜¯å…è´¹çš„ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fanyrouter.top%2Fregister%3Faff%3DvNlI" target="_blank" title="https://anyrouter.top/register?aff=vNlI" ref="nofollow noopener noreferrer">anyrouter.top/register?afâ€¦</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/34b4b3084feb472087739aa6ad5530c6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6ZWHY3h5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765715167&amp;x-signature=%2BkdeLGumcyjoMHs3izg8aAkWUgM%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4">è§„çº¦ç¼–ç¨‹</h2>
<h3 data-id="heading-5">å®šä¹‰</h3>
<p>è§„çº¦ç¼–ç¨‹é¡¾åæ€ä¹‰ä»¥è§„èŒƒæ–‡æ¡£é©±åŠ¨çš„ç¼–ç¨‹ï¼ˆSpecification Driven Development, ç®€ç§° SDD ï¼‰ï¼Œä¸€ç§ä»¥è§„èŒƒä¸ºæ ¸å¿ƒçš„ç¼–ç¨‹æ–¹æ³•ï¼Œæ—¨åœ¨é€šè¿‡æ˜ç¡®çš„éœ€æ±‚å’Œè§„åˆ™å®šä¹‰ï¼Œæå‡è½¯ä»¶å¼€å‘çš„æ•ˆç‡ã€è´¨é‡å’Œåä½œæ€§ã€‚ åœ¨ä¼ ç»Ÿå¼€å‘ä¸­ï¼ŒSpec æ˜¯"æŒ‡å¯¼æ€§æ–‡ä»¶"â€”â€”å†™å®Œå°±æŸä¹‹é«˜é˜ï¼ŒçœŸæ­£çš„å·¥ä½œè¿˜æ˜¯é äººå·¥ç¼–ç ï¼Œäººå·¥è¯„å®¡è¿›è¡Œé©±åŠ¨ä¼˜åŒ–ã€‚ ä½†åœ¨ AI ç¼–ç¨‹æ—¶ä»£ï¼ŒSpec ä¸ä»…ä»…æ˜¯æŒ‡å¯¼ï¼Œè€Œæ˜¯å˜æˆäº†â€œå¯æ‰§è¡Œçš„æºä»£ç â€ï¼Œå³ç›´æ¥è®© AI æ ¹æ® Spec ç”Ÿæˆå®Œæ•´çš„ä»£ç å®ç°ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼šåœ¨å¼€å§‹ç¼–ç ä¹‹å‰ï¼Œå…ˆå®šä¹‰æ¸…æ™°çš„è§„èŒƒï¼ˆSpecificationï¼‰ï¼Œå°†ä¸šåŠ¡éœ€æ±‚ã€æ¥å£å®šä¹‰ã€æ•°æ®æ¨¡å‹ã€ä¸šåŠ¡è§„åˆ™ç­‰ä»¥ç»“æ„åŒ–ã€å¯æ‰§è¡Œçš„æ–¹å¼ç¼–å†™ï¼Œè®©æ–‡æ¡£å³ä»£ç ï¼Œä»£ç å³æ–‡æ¡£ã€‚</p>
<h3 data-id="heading-6">Spec-Kit</h3>
<p>Spec-Kitè¿™ä¸ªå¼€æºé¡¹ç›®æ˜¯çœŸçš„å‰å®³ï¼Œå®ƒè®¾è®¡äº†è‡ªé—­ç¯å·¥ä½œæµï¼šç¡®ä¿AIè¾“å‡ºçš„ä¸€è‡´æ€§å’Œç»“æ„åŒ–</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fgithub%2Fspec-kit" target="_blank" title="https://github.com/github/spec-kit" ref="nofollow noopener noreferrer">github.com/github/specâ€¦</a></p>
<p>é¡¹ç›®ä»‹ç»</p>
<pre><code class="hljs language-csharp" lang="csharp">spec-kit/
â”œâ”€ src/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># æ ¸å¿ƒæºä»£ç ç›®å½•</span>
â”‚  â””â”€ specify_cli/
â”‚ Â  Â  â””â”€ __init__.py Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># Specify CLI ä¸»è¦å®ç°</span>
â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># CLI å·¥å…·çš„å®Œæ•´å®ç°ï¼ŒåŒ…å«æ‰€æœ‰å‘½ä»¤å’Œ AI ä»£ç†é›†æˆ</span>
â”‚
â”œâ”€ templates/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># æ¨¡æ¿ç³»ç»Ÿ â€“ SDD å·¥ä½œæµçš„æ ¸å¿ƒ</span>
â”‚  â”œâ”€ commands/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># AI ä»£ç†å‘½ä»¤æ¨¡æ¿</span>
â”‚  â”‚  â”œâ”€ specify.md Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># å®šåˆ¶åˆ›å»ºå‘½ä»¤ â€“ å°†è·¯å¾„è¯­æ³•è½¬æ¢ä¸ºç»“æ„åŒ–è§„èŒƒ</span>
â”‚  â”‚  â”œâ”€ plan.md Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># è§„åˆ’è®¡åˆ’å‘½ä»¤ â€“ ä»è§„èŒƒç”Ÿæˆæˆæœ¬/å®ç°è®¡åˆ’</span>
â”‚  â”‚  â”œâ”€ tasks.md Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># ä»»åŠ¡åˆ†è§£å‘½ä»¤ â€“ å°†è®¡åˆ’åˆ†è§£ä¸ºå¯æ‰§è¡Œä»»åŠ¡</span>
â”‚  â”‚  â”œâ”€ implement.md Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># å®ç°æ‰§è¡Œå‘½ä»¤ â€“ æ‰§è¡Œä»»åŠ¡åˆ°è¾“å‡ºç‰©</span>
â”‚  â”‚  â”œâ”€ constitution.md Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># é¡¹ç›®åŸåˆ™å‘½ä»¤ â€“ å»ºç«‹é¡¹ç›®æ²»ç†åŸåˆ™</span>
â”‚  â”‚  â”œâ”€ clarify.md Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># æ¾„æ¸…å‘½ä»¤ â€“ ç»“æ„åŒ–é—®é¢˜è§£å†³å’Œè§„èŒƒæ€§å¢å¼º</span>
â”‚  â”‚  â”œâ”€ analyze.md Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># åˆ†æå‘½ä»¤ â€“ è·¨å·¥ä½œä¸€è‡´æ€§å’Œè¦†ç›–ç‡åˆ†æ</span>
â”‚  â”‚  â””â”€ checklist.md Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># æ£€æŸ¥æ¸…å•å‘½ä»¤ â€“ ç”Ÿæˆè´¨é‡æ£€æŸ¥æ¸…å•</span>
â”‚  â”‚
â”‚  â”œâ”€ spec-template.md Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># åŠŸèƒ½è§„èŒƒæ¨¡æ¿ â€“ å®šä¹‰ç”¨æˆ·æ•…äº‹å’ŒåŠŸèƒ½éœ€æ±‚ç»“æ„</span>
â”‚  â”œâ”€ plan-template.md Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># å®ç°è®¡åˆ’æ¨¡æ¿ â€“ æŠ€æœ¯æ¶æ„å’Œå®ç°ç»†èŠ‚ç»“æ„</span>
â”‚  â”œâ”€ tasks-template.md Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># ä»»åŠ¡æ¨¡æ¿ â€“ å¯æ‰§è¡Œä»»åŠ¡åˆ—è¡¨ç»“æ„</span>
â”‚  â”œâ”€ checklist-template.md Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># æ£€æŸ¥æ¸…å•æ¨¡æ¿ â€“ è´¨é‡éªŒè¯æ¸…å•ç»“æ„</span>
â”‚  â”œâ”€ agent-file-template.md Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># ä»£ç†æ–‡ä»¶æ¨¡æ¿ â€“ AI ä»£ç†é…ç½®æ–‡ä»¶ç»“æ„</span>
â”‚  â””â”€ vscode-settings.json Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># VS Code è®¾ç½®æ¨¡æ¿ â€“ å¼€å‘ç¯å¢ƒé…ç½®</span>
â”‚
â”œâ”€ scripts/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># è‡ªåŠ¨åŒ–è„šæœ¬ç³»ç»Ÿ</span>
â”‚  â”œâ”€ bash/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># POSIX Shell è„šæœ¬</span>
â”‚  â”‚  â”œâ”€ common.sh Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># å…¬å…±å‡½æ•°åº“ â€“ åŒ…åº“è·¯å¾„ã€åˆ†æ”¯ç®¡ç†ã€åŠŸèƒ½ç›®å½•æŸ¥æ‰¾</span>
â”‚  â”‚  â”œâ”€ create-<span class="hljs-keyword">new</span>-feature.sh Â  Â  Â  Â  Â   <span class="hljs-meta"># åŠŸèƒ½åˆ›å»ºè„šæœ¬ â€“ è‡ªåŠ¨åˆ†æ”¯åˆ›å»ºå’Œç›®å½•ç»“æ„è®¾ç½®</span>
â”‚  â”‚  â”œâ”€ setup-plan.sh Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># è®¡åˆ’è®¾ç½®è„šæœ¬ â€“ å®ç°è®¡åˆ’åˆå§‹åŒ–</span>
â”‚  â”‚  â”œâ”€ update-agent-context.sh Â  Â  Â  Â   <span class="hljs-meta"># ä»£ç†ä¸Šä¸‹æ–‡æ›´æ–° â€“ åŒæ­¥é¡¹ç›®ä¿¡æ¯åˆ° AI ä»£ç†</span>
â”‚  â”‚  â””â”€ check-prerequisites.sh Â  Â  Â  Â  Â  <span class="hljs-meta"># å…ˆå†³æ¡ä»¶æ£€æŸ¥ â€“ éªŒè¯å·¥å…·å’Œç¯å¢ƒ</span>
â”‚  â”‚
â”‚  â””â”€ powershell/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># PowerShell è„šæœ¬ (Windows æ”¯æŒ)</span>
â”‚ Â  Â  â”œâ”€ common.ps1 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># PowerShell å…¬å…±å‡½æ•°åº“</span>
â”‚ Â  Â  â”œâ”€ create-<span class="hljs-keyword">new</span>-feature.ps1 Â  Â  Â  Â  Â  <span class="hljs-meta"># PowerShell åŠŸèƒ½åˆ›å»ºè„šæœ¬</span>
â”‚ Â  Â  â”œâ”€ setup-plan.ps1 Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># PowerShell è®¡åˆ’è®¾ç½®è„šæœ¬</span>
â”‚ Â  Â  â”œâ”€ update-agent-context.ps1 Â  Â  Â  Â  <span class="hljs-meta"># PowerShell ä»£ç†ä¸Šä¸‹æ–‡æ›´æ–°</span>
â”‚ Â  Â  â””â”€ check-prerequisites.ps1 Â  Â  Â  Â   <span class="hljs-meta"># PowerShell å…ˆå†³æ¡ä»¶æ£€æŸ¥</span>
â”‚
â”œâ”€ docs/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># æ–‡æ¡£ç³»ç»Ÿ</span>
â”‚  â”œâ”€ index.md Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># æ–‡æ¡£ä¸»é¡µ</span>
â”‚  â”œâ”€ installation.md Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># å®‰è£…æŒ‡å—</span>
â”‚  â”œâ”€ quickstart.md Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># å¿«é€Ÿå¼€å§‹æŒ‡å—</span>
â”‚  â”œâ”€ local-development.md Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># æœ¬åœ°å¼€å‘æŒ‡å—</span>
â”‚  â”œâ”€ docfx.json Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># DocFX æ–‡æ¡£ç”Ÿæˆé…ç½®</span>
â”‚  â””â”€ toc.yml Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># æ–‡æ¡£ç›®å½•ç»“æ„</span>
â”‚
â”œâ”€ .github/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># GitHub å·¥ä½œæµå’Œé…ç½®</span>
â”‚  â””â”€ workflows/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># CI/CD ç®¡é“</span>
â”‚ Â  Â  â”œâ”€ release.yml Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># å‘å¸ƒå·¥ä½œæµ â€“ è‡ªåŠ¨åŒ–ç‰ˆæœ¬å‘å¸ƒå’ŒåŒ…åˆ†å‘</span>
â”‚ Â  Â  â”œâ”€ docs.yml Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># æ–‡æ¡£æ„å»ºå·¥ä½œæµ</span>
â”‚ Â  Â  â”œâ”€ lint.yml Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># ä»£ç è´¨é‡æ£€æŸ¥å·¥ä½œæµ</span>
â”‚ Â  Â  â””â”€ scripts/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># å‘å¸ƒè„šæœ¬</span>
â”‚ Â  Â  Â   â”œâ”€ create-release-packages.sh Â   <span class="hljs-meta"># åˆ›å»ºå‘å¸ƒåŒ… â€“ ä¸ºæ¯ä¸ª AI ä»£ç†ç”Ÿæˆæ¨¡æ¿åŒ…</span>
â”‚ Â  Â  Â   â”œâ”€ create-github-release.sh Â  Â   <span class="hljs-meta"># GitHub å‘å¸ƒåˆ›å»º</span>
â”‚ Â  Â  Â   â”œâ”€ generate-release-notes.sh Â  Â  <span class="hljs-meta"># å‘å¸ƒè¯´æ˜ç”Ÿæˆ</span>
â”‚ Â  Â  Â   â”œâ”€ <span class="hljs-keyword">get</span>-next-version.sh Â  Â  Â  Â  Â  <span class="hljs-meta"># ç‰ˆæœ¬å·ç®¡ç†</span>
â”‚ Â  Â  Â   â””â”€ update-version.sh Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># ç‰ˆæœ¬æ›´æ–°è„šæœ¬</span>
â”‚
â”œâ”€ .devcontainer/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># å¼€å‘å®¹å™¨é…ç½®</span>
â”‚  â”œâ”€ devcontainer.json Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># å®¹å™¨é…ç½® â€” VS Code æ‰©å±•å’Œç¯å¢ƒè®¾ç½®</span>
â”‚  â””â”€ post-create.sh Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># å®¹å™¨ååˆ›å»ºè„šæœ¬ â€” AI å·¥å…·å®‰è£…</span>
â”‚
â”œâ”€ memory/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># é¡¹ç›®è®°å¿†ç³»ç»Ÿ</span>
â”‚  â””â”€ constitution.md Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># é¡¹ç›®å®ªæ³• â€” æ ¸å¿ƒåŸåˆ™å’Œæ²»ç†æŒ‡å¯¼</span>
â”‚
â”œâ”€ media/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># åª’ä½“èµ„æº</span>
â”‚  â”œâ”€ logo_large.webp Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># é¡¹ç›®æ ‡å¿—ï¼ˆå¤§ï¼‰</span>
â”‚  â”œâ”€ logo_small.webp Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># é¡¹ç›®æ ‡å¿—ï¼ˆå°ï¼‰</span>
â”‚  â”œâ”€ specify_cli.gif Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># CLI æ¼”ç¤ºåŠ¨ç”»</span>
â”‚  â””â”€ bootstrap-claude-code.gif Â  Â  Â  Â   <span class="hljs-meta"># Claude Code å¼•å¯¼æ¼”ç¤º</span>
â”‚
â”œâ”€ pyproject.toml Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># Python é¡¹ç›®é…ç½® â€” ä¾èµ–ç®¡ç†å’Œæ„å»ºè®¾ç½®</span>
â”œâ”€ README.md Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># é¡¹ç›®ä¸»æ–‡æ¡£ â€” å®Œæ•´çš„ä½¿ç”¨æŒ‡å—å’Œæ–¹æ³•è®ºä»‹ç»</span>
â”œâ”€ spec-driven.md Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># SDD æ–¹æ³•è®ºè¯¦ç»†è¯´æ˜ â€” ç†è®ºåŸºç¡€å’Œå®è·µæŒ‡å¯¼</span>
â”œâ”€ AGENTS.md Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># AI ä»£ç†é›†æˆæŒ‡å— â€” æ·»åŠ æ–°ä»£ç†å®Œæ•´æµç¨‹</span>
â”œâ”€ CHANGELOG.md Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># å˜æ›´æ—¥å¿—</span>
â”œâ”€ CONTRIBUTING.md Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># è´¡çŒ®æŒ‡å—</span>
â”œâ”€ CODE_OF_CONDUCT.md Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># è¡Œä¸ºå‡†åˆ™</span>
â”œâ”€ SECURITY.md Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># å®‰å…¨ç­–ç•¥</span>
â”œâ”€ SUPPORT.md Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-meta"># æ”¯æŒä¿¡æ¯</span>
â””â”€ LICENSE Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-meta"># MIT å¼€æºè®¸å¯è¯</span>
â€‹
</code></pre>
<h3 data-id="heading-7">å¿«é€Ÿå¼€å§‹</h3>
<p>è¿™é‡Œæ˜¯ä½¿ç”¨Claude Code å’Œ Spec-kitçš„åŸºæœ¬ä½¿ç”¨æ–¹æ¡ˆï¼Œä»…ä¾›å‚è€ƒ</p>
<h4 data-id="heading-8">å®‰è£…Spec-kit</h4>
<pre><code class="hljs language-csharp" lang="csharp">uv tool install specify-cli --<span class="hljs-keyword">from</span> git+https:<span class="hljs-comment">//github.com/github/spec-kit.git</span>
</code></pre>
<h4 data-id="heading-9">é¡¹ç›®åˆå§‹åŒ–</h4>
<pre><code class="hljs language-perl" lang="perl">specify init <span class="hljs-keyword">my</span>-project --<span class="hljs-keyword">no</span>-git
</code></pre>
<p>æ›´å¤šå‘½ä»¤å‚è€ƒGithubä¸­çš„å†…å®¹<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fgithub%2Fspec-kit" target="_blank" title="https://github.com/github/spec-kit" ref="nofollow noopener noreferrer">github.com/github/specâ€¦</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9c8a8a832fd846ceb78eab27dfba53a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6ZWHY3h5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765715167&amp;x-signature=d0UDdkr4ILKO1wjHAGpTVn8UpDI%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c2b7fd5950e844b090ff399fcd469545~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6ZWHY3h5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765715167&amp;x-signature=Zv9aqTwD5mywZ%2BGps5eqi9SKh38%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e603823ba3dd4daaa94b96ede81d5e4f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6ZWHY3h5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765715167&amp;x-signature=X44xnNhcpS%2BCnIxJCjQHv1pi%2B3Q%3D" alt="" loading="lazy"/></p>
<p>ç”Ÿæˆäº†å¾ˆå¤šå‘½ä»¤</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c5b888c8f7934e4d85e8bb99d2733b29~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6ZWHY3h5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765715167&amp;x-signature=QEKrjY%2FIZyvvAjeFz0rayBox6TQ%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-10">ä½¿ç”¨æŠ€å·§</h4>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">1. å»ºç«‹é¡¹ç›®<span class="hljs-string">"å®ªæ³•"</span></span>
/speckit.constitution
<span class="hljs-meta prompt_">#</span><span class="bash"><span class="hljs-comment"># ä½œç”¨ï¼šåˆ›å»ºé¡¹ç›®â€œå®ªæ³•â€ï¼Œå³å‰æåŸåˆ™ï¼Œè¿™äº›åŸåˆ™å’ŒæŒ‡å—ä¼šçŸ¥é“æ‰€æœ‰åç»­çš„å¼€å‘å·¥ä½œã€‚</span></span>
â€‹
<span class="hljs-meta prompt_"># </span><span class="bash">2. æè¿°åŠŸèƒ½éœ€æ±‚</span>
/speckit.specify
<span class="hljs-meta prompt_">#</span><span class="bash"><span class="hljs-comment"># ä½œç”¨ï¼šè¾“å‡ºäº§å“éœ€æ±‚æ–‡æ¡£ï¼ˆPRDï¼‰.åªæè¿°â€œè¦ä»€ä¹ˆâ€ï¼Œä¸è®¨è®ºâ€œæ€ä¹ˆå®ç°â€</span></span>
â€‹
<span class="hljs-meta prompt_"># </span><span class="bash">3. æ¾„æ¸…éœ€æ±‚ç»†èŠ‚ï¼ˆoptionalï¼‰</span>
/speckit.clarify
<span class="hljs-meta prompt_">#</span><span class="bash"><span class="hljs-comment"># ä½œç”¨ï¼šSpec-Kit å¼€å§‹é’ˆå¯¹éœ€æ±‚ä¸æ˜ç¡®çš„ç‚¹ï¼Œå‘æˆ‘ä»¬æé—®.æ— éœ€é¢å¤–è¾“å…¥ï¼Œç›´æ¥æ‰§è¡Œå³å¯</span></span>
â€‹
<span class="hljs-meta prompt_"># </span><span class="bash">4. ç¡®å®šæŠ€æœ¯æ–¹æ¡ˆå’Œç”Ÿæˆå®æ–½è®¡åˆ’</span>
/speckit.plan
<span class="hljs-meta prompt_">#</span><span class="bash"><span class="hljs-comment"># ä½œç”¨ï¼šåŸºäºéœ€æ±‚å†™æŠ€æœ¯æ–¹æ¡ˆå’Œå®æ–½è®¡åˆ’.æ— éœ€é¢å¤–è¾“å…¥ï¼Œç›´æ¥æ‰§è¡Œ</span></span>
â€‹
<span class="hljs-meta prompt_"># </span><span class="bash">5. æ‹†è§£æ‰§è¡Œä»»åŠ¡ (éå¸¸å®ç”¨)</span>
/speckit.tasks
<span class="hljs-meta prompt_">#</span><span class="bash"><span class="hljs-comment"># ä½œç”¨ï¼šæ‹†è§£ä»»åŠ¡ï¼Œåˆ†æ spec.md å’Œ plan.mdã€æŒ‰é˜¶æ®µï¼ˆPhaseï¼‰æ‹†è§£ä¸ºå¤šä¸ªå­ä»»åŠ¡ã€æ¯ä¸ªä»»åŠ¡åŒ…å«æ˜ç¡®çš„éªŒæ”¶æ ‡å‡†ã€ä¼°ç®—å®Œæˆæ—¶é—´.åŸºäºéœ€æ±‚å’ŒæŠ€æœ¯æ–¹æ¡ˆï¼Œæ‹†è§£å‡ºå…·ä½“çš„ä»»åŠ¡æ— éœ€é¢å¤–è¾“å…¥ï¼Œç›´æ¥æ‰§è¡Œ</span></span>
â€‹
<span class="hljs-meta prompt_"># </span><span class="bash">6. å…¨é¢å®¡æ ¸ (å¯é€‰ä½†æ¨è)</span>
/ speckit.analyze
<span class="hljs-meta prompt_">#</span><span class="bash"><span class="hljs-comment"># å°†æ‰€æœ‰æ–‡æ¡£å…¨éƒ¨å®¡æ ¸ä¸€é,æ£€æµ‹ spec.mdã€plan.md å’Œ tasks.md ä¹‹é—´çš„ä¸ä¸€è‡´æ€§ã€é‡å¤ã€æ­§ä¹‰å’Œæ¬ æŒ‡å®šé¡¹ï¼Œå°†æœ‰é—®é¢˜çš„ç‚¹å…¨éƒ¨æ‰¾å‡ºæ¥ï¼Œç”ŸæˆæŠ¥å‘Šå¹¶ååŠ©ä¿®å¤ã€‚</span></span>
â€‹
<span class="hljs-meta prompt_"># </span><span class="bash">7. å¼€å§‹ç¼–ç </span>
/speckit.implement 
<span class="hljs-meta prompt_">#</span><span class="bash"><span class="hljs-comment"># å¼€å§‹å†™éœ€æ±‚ä»£ç </span></span>
</code></pre>
<h2 data-id="heading-11">å®è·µéƒ¨åˆ†</h2>
<p>è¿™é‡Œé€‰æ‹©ä½¿ç”¨vibe codingä¸€ä¸ªå°ç¨‹åºï¼Œå®ç°ä¸€äº›å°åŠŸèƒ½ï¼Œç›®å‰ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å¹³å°å’Œäº‘å‡½æ•°å®Œæˆçš„ã€‚</p>
<h3 data-id="heading-12">Vibe Coding</h3>
<h4 data-id="heading-13">åˆå§‹åŒ–é¡¹ç›®</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœ¨githubåˆ›å»ºä»“åº“...</span>
â€‹
<span class="hljs-comment"># specify åˆå§‹åŒ–é¡¹ç›®</span>
/speckit.constitution è¿™æ˜¯ä¸€ä¸ªå¾®ä¿¡å°ç¨‹åºé¡¹ç›®ï¼Œæœªæ¥æƒ³åœ¨è¿™ä¸ªå°ç¨‹åºä¸­åšä¸€äº›å°å·¥å…·ï¼Œå°æ¸¸æˆï¼Œä½¿ç”¨å°ç¨‹åºæ¶æ„
â€‹
<span class="hljs-comment">## åˆå§‹åŒ–claude.md</span>
/init è¿™æ˜¯ä¸€ä¸ªå¾®ä¿¡å°ç¨‹åºçš„ä»£ç ä»“åº“ï¼Œç°åœ¨æ˜¯åœ¨åšä¸€äº›å°å·¥å…·ï¼Œæœªæ¥ä¼šæ¥å…¥AIé—®ç­”ï¼Œç”¨æˆ·ç®¡ç†
</code></pre>
<h4 data-id="heading-14">åŠŸèƒ½å¼€å‘</h4>
<h5 data-id="heading-15">æè¿°å¼€å‘éœ€æ±‚</h5>
<pre><code class="hljs language-vbnet" lang="vbnet">å¸®åŠ©æˆ‘å®Œæˆæ–‡æœ¬å·¥å…·ä¸­çš„ä¸€ä¸ªè—å¤´è¯—çš„åŠŸèƒ½ã€‚ä¸»è¦åŠŸèƒ½æ˜¯å¸®åŠ©ç”¨æˆ·ç”Ÿæˆè—å¤´è¯—ã€‚
åå­—å«è—å¤´è¯—å·¥å…·
é¡µé¢ä¸»è¦å…ƒç´ ï¼š
<span class="hljs-number">1</span>. ç”¨æˆ·è¾“å…¥æ¡†<span class="hljs-number">1</span>ï¼Œè¾“å…¥ç”¨æˆ·éœ€è¦è—çš„æ–‡æœ¬
<span class="hljs-number">2</span>. ç”¨æˆ·è¾“å…¥æ¡†<span class="hljs-number">2</span>ï¼Œè¡¨è¾¾éœ€è¦è—å¤´è¯—çš„ä»€ä¹ˆæ„Ÿå—ã€æƒ³æ³•
<span class="hljs-number">3</span>. æŒ‰é’®æäº¤
<span class="hljs-number">4</span>. è¿”å›ç»“æœï¼ˆæµå¼è¿”å›ï¼‰
è¿™é‡Œä¼šè°ƒç”¨å¤–éƒ¨apiï¼Œä½¿ç”¨äº‘å‡½æ•°å¸®åŠ©è§£å†³
## API
æ–‡æœ¬ç”Ÿæˆå‹åº”ç”¨ API
æ–‡æœ¬ç”Ÿæˆåº”ç”¨æ— ä¼šè¯æ”¯æŒï¼Œé€‚åˆç”¨äºç¿»è¯‘/æ–‡ç« å†™ä½œ/æ€»ç»“ AI ç­‰ç­‰ã€‚
åŸºç¡€ URL
â€‹
curl -X POST <span class="hljs-comment">'https://api.dify.ai/v1/completion-messages' \</span>
--header <span class="hljs-comment">'Authorization: Bearer {api_key}' \</span>
--header <span class="hljs-comment">'Content-Type: application/json' \</span>
--data-raw <span class="hljs-comment">'{</span>
  <span class="hljs-string">"inputs"</span>: {<span class="hljs-string">"query"</span>: <span class="hljs-string">"ä½ æœ€ç‰›"</span>},
  <span class="hljs-string">"response_mode"</span>: <span class="hljs-string">"blocking"</span>
}<span class="hljs-comment">'</span>
â€‹
è¿”å›ï¼š
â€‹
{
  <span class="hljs-string">"id"</span>: <span class="hljs-string">"0b089b9a-24d9-48cc-94f8-762677276261"</span>,
  <span class="hljs-string">"answer"</span>: <span class="hljs-string">"how are you?"</span>,
  <span class="hljs-string">"created_at"</span>: <span class="hljs-number">1679586667</span>
}
â€‹
å…¶ä¸­answerä¸­çš„å†…å®¹å°±æ˜¯è—å¤´è¯—è¿”å›çš„ç»“æœ
åœ¨æ¥å£è¯·æ±‚ï¼Œæ˜¯éœ€è¦ç»“åˆç”¨æˆ·çš„è¾“å…¥è¿›è¡Œæ‹¼æ¥ç„¶åå†å»è¯·æ±‚ã€‚
æˆ‘è¦è—<span class="hljs-string">"ç”¨æˆ·è¾“å…¥æ¡†1"</span>ï¼Œæ˜¯è¦è¡¨è¾¾<span class="hljs-string">"ç”¨æˆ·è¾“å…¥æ¡†2"</span>çš„æƒ³æ³•
ç”¨æˆ·è¾“å…¥æ¡†<span class="hljs-number">2</span>ä¸æ˜¯å¿…å¡«é¡¹ï¼Œéœ€è¦åŠ¨æ€æ‹¼æ¥queryçš„å†…å®¹
</code></pre>
<h5 data-id="heading-16">ä½¿ç”¨specè¾…åŠ©å¼€å‘</h5>
<pre><code class="hljs language-bash" lang="bash">/speckit.specify is runningâ€¦ task\03-è—å¤´è¯—.md
...
  ä¸‹ä¸€æ­¥

  è§„æ ¼è¯´æ˜å·²å‡†å¤‡å°±ç»ªï¼Œä½ å¯ä»¥æ‰§è¡Œï¼š
  - /speckit.clarify - è¯†åˆ«å¹¶æ¾„æ¸…ä»»ä½•æ¨¡ç³Šä¹‹å¤„
  - /speckit.plan - å¼€å§‹å®ç°è®¡åˆ’è®¾è®¡
/speckit.clarify
...
You can reply with the option letter (e.g., <span class="hljs-string">"A"</span>), accept the recommendation by saying <span class="hljs-string">"yes"</span> or <span class="hljs-string">"recommended"</span>, or
  provide your own short answer.

A
... å¼€å§‹é—®é¢˜æ¾„æ¸…
/speckit.plan
...
/speckit.tasks
...
/speckit.implement
...
åé¢è®©AIè°ƒæ•´äº†ä¸€ä¸‹æ ·å¼
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/71e922dc8ce54c5a8f9b60ba44f8e46c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6ZWHY3h5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765715167&amp;x-signature=jQ0XDMCg%2FzSXrUbrBJWI9vxoYx4%3D" alt="" loading="lazy"/></p>
<p>è¿™é‡Œä½¿ç”¨Spec-kitè¿›è¡Œå¼€å‘ï¼Œæ–‡æ¡£è§„çº¦æ¯”è¾ƒå……åˆ†</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/06053782988c438db93bf79ffe1b44b4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6ZWHY3h5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765715167&amp;x-signature=OEGlmDPgkf8DHKsQWBKo1kFKbdg%3D" alt="" loading="lazy"/></p>
<p>ä½†æ˜¯æ¨¡å‹çš„tokenæ¶ˆè€—æ˜¯å·¨å¤§çš„ï¼Œå¹¶ä¸”ä¸Šä¸‹æ–‡ä¼šè¶…é•¿ï¼Œæ¨¡å‹ä¸Šä¸‹æ–‡ç†è§£ä¹Ÿä¼šè¢«å‡å¼±....</p>
<h3 data-id="heading-17">æˆæœå±•ç¤º</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/24f368d574714c68a7967de480145823~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6ZWHY3h5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765715167&amp;x-signature=H99jFRKNGS5lA9A%2FiV5cTGKnioY%3D" alt="" loading="lazy"/></p>
<p>å¯ä»¥æœç´¢å°ç¨‹åº"æŒ‡å°–å·¥å…·å±‹"ï¼Œå¾ˆæ— è¯­<strong>å¹³å°æ”¾äºŒç»´ç ä¸ç»™é€šè¿‡</strong>ã€‚å¤§å®¶éœ€è¦ä½“éªŒçš„è¯ç§»æ­¥è‡³VXå§...</p>
<p>æœ€åï¼Œæ‰€æœ‰çš„å¼€å‘ä½¿ç”¨çš„è…¾è®¯äº‘å…è´¹æä¾›çš„æœåŠ¡ï¼Œä½¿ç”¨<strong>äº‘å‡½æ•°</strong>å»è§£å†³è°ƒç”¨å…¶ä»–èƒ½åŠ›ï¼Œé»˜è®¤3ç§’å°±ä¼šè¶…æ—¶...æ‰€ä»¥æ­£å¼ç‰ˆå°ç¨‹åºç”¨ä¸äº†..å®šä¹‰äº‘å‡½æ•°çš„ç¯å¢ƒå˜é‡ä¹Ÿæ— æ³•ä½¿ç”¨</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7443c1bcdc8445d0a080590e19ce32a3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6ZWHY3h5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765715167&amp;x-signature=IHbGO4p2ZgR%2B5K%2FC1%2Fi91%2FLZkjc%3D" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Akamai é€†å‘æ€è·¯]]></title>    <link>https://juejin.cn/post/7580394927978348563</link>    <guid>https://juejin.cn/post/7580394927978348563</guid>    <pubDate>2025-12-07T13:18:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580394927978348563" data-draft-id="7580372534043295787" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Akamai é€†å‘æ€è·¯"/> <meta itemprop="keywords" content="JavaScript,çˆ¬è™«,é€†å‘"/> <meta itemprop="datePublished" content="2025-12-07T13:18:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Glommer"/> <meta itemprop="url" content="https://juejin.cn/user/847085484127432"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Akamai é€†å‘æ€è·¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/847085484127432/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Glommer
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T13:18:53.000Z" title="Sun Dec 07 2025 13:18:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;color:#3c9dff}.markdown-body h1{font-size:30px;margin-bottom:5px;padding-bottom:8px;text-align:center}.markdown-body h2{font-size:24px;padding-bottom:6px}.markdown-body h2:before{content:"ğŸ‹"}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{content:"ğŸ“"}.markdown-body h4{font-size:16px}.markdown-body h4:before{content:"ğŸ‘"}.markdown-body h5{font-size:15px}.markdown-body h5:before{content:"ğŸ‰"}.markdown-body h6{margin-top:5px}.markdown-body h6:before{content:"ğŸ’"}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;margin:0 auto;max-width:100%;border-radius:4px;padding:1px;border:1px solid #d2e8ff}.markdown-body img:hover{box-shadow:0 1px 3px #5eaeff}.markdown-body hr{height:4px;margin:34px 0;background-size:4px 1px;background-image:linear-gradient(270deg,#5eaeff,#f3f9ff 25%,transparent 50%);border-style:none}.markdown-body code{word-break:break-word;border-radius:3px;overflow-x:auto;background-color:#d2e8ff;color:#3c9dff;font-size:.9em;padding:.1em .5em;margin:0 3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;transition:all .3s}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:1px solid #90c7ff;border-radius:4px}.markdown-body pre:hover{box-shadow:0 1px 10px #beddff}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#3c9dff;border-bottom:1px solid #90c7ff;transition:all .3s}.markdown-body a:hover{color:#007fff;border-bottom:2px solid #5eaeff}.markdown-body a[href]:not(:empty){padding-right:18px}.markdown-body a[href]:not(:empty):after{display:inline-block;width:16px;height:16px;margin-left:2px;content:"";background:url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik0zODQgMTI4YTQ4IDQ4IDAgMDEyLjgxNiA5NS45MkwzODQgMjI0SDI1NmEzMiAzMiAwIDAwLTMxLjkyIDI5LjZMMjI0IDI1NnY1MTJhMzIgMzIgMCAwMDI5LjYgMzEuOTJsMi40LjA4aDUxMmEzMiAzMiAwIDAwMzEuOTItMjkuNmwuMDgtMi40VjY1NmE0OCA0OCAwIDAxOTUuOTItMi44MTZMODk2IDY1NnYxMTJhMTI4IDEyOCAwIDAxLTEyNCAxMjcuOTM2bC00IC4wNjRIMjU2YTEyOCAxMjggMCAwMS0xMjcuOTM2LTEyNGwtLjA2NC00VjI1NmExMjggMTI4IDAgMDExMjQtMTI3LjkzNmw0LS4wNjRoMTI4em0zODQgMGExMjggMTI4IDAgMDExMjcuOTM2IDEyNGwuMDY0IDR2MTYwYTQ4IDQ4IDAgMDEtOTUuOTIgMi44MTZMODAwIDQxNlYyOTEuODcybC0zODIuMDY0IDM4Mi4wOGE0OCA0OCAwIDAxLTcwLjAzMi02NS42bDIuMTYtMi4yODhMNzMyLjA5NiAyMjRINjA4YTQ4IDQ4IDAgMDEtMi44MTYtOTUuOTJMNjA4IDEyOGgxNjB6IiBmaWxsPSIjM2M5ZGZmIiBmaWxsLW9wYWNpdHk9Ii41NiIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC5zZWFyY2hfaW5kZXguMC5pMC41Yzc1M2E4MTgwa2RKWCIgY2xhc3M9InNlbGVjdGVkIi8+PC9zdmc+);background-size:100%}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border:1px solid #3c9dff}.markdown-body thead{text-align:center}.markdown-body thead th{color:#fff;background-color:#5eaeff}.markdown-body tr{text-align:center}.markdown-body tbody tr:hover{background-color:#d2e8ff}.markdown-body tbody tr:hover code{background-color:#90c7ff}.markdown-body tr:nth-child(2n){background-color:#ecf5ff}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5eaeff}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{font-weight:900;padding:0 1px;font-size:17px}.markdown-body small{color:#cbcbcb;padding:0 1px;font-size:22px;zoom:.5}.markdown-body em{padding:0 1px}.markdown-body del{padding:0 1px;text-decoration-thickness:2px}.markdown-body blockquote{color:#1a1b1c;padding:1px 20px;margin:22px 0;border-radius:4px;border-left:4px solid rgba(60,157,255,.5);background-color:rgba(190,221,255,.3)}.markdown-body blockquote blockquote{margin:8px 0}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{margin:12px 0;padding:4px 10px;border:2px solid #3c9dff;border-radius:8px;background-color:#ecf5ff;transition:all .3s}.markdown-body details summary{cursor:pointer}.markdown-body input[type=checkbox]{position:relative;appearance:none;width:16px;height:16px;border-radius:2px;vertical-align:middle;transform:translateY(-2px);box-sizing:border-box;border:1px solid #beddff}.markdown-body input[type=checkbox]:checked{border:1px solid #5eaeff;background-color:#5eaeff}.markdown-body input[type=checkbox]:checked:before{position:absolute;top:3px;left:1px;width:11px;height:6px;background-color:transparent;border-left:2px solid #fff;border-bottom:2px solid #fff;transform:rotate(-45deg);content:"";box-sizing:border-box}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="androidstudio">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#a9b7c6;background:#282b2e}.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#6897bb}.hljs-deletion,.hljs-keyword,.hljs-selector-tag{color:#cc7832}.hljs-link,.hljs-template-variable,.hljs-variable{color:#629755}.hljs-comment,.hljs-quote{color:grey}.hljs-meta{color:#bbb529}.hljs-addition,.hljs-attribute,.hljs-string{color:#6a8759}.hljs-section,.hljs-title,.hljs-type{color:#ffc66d}.hljs-name,.hljs-selector-class,.hljs-selector-id{color:#e8bf6a}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡ç« åªåšæŠ€æœ¯æ¢è®¨, è¯·å‹¿ç”¨äºéæ³•ç”¨é€”ã€‚</p>
</blockquote>
<h2 data-id="heading-0">å¼•è¨€</h2>
<p>ä¹‹å‰ç­”åº”å¤§å®¶çš„ Akamai åŠ å¯†é€†å‘, ä¸œè¥¿ç¡®å®æ˜¯æ¯”è¾ƒå¤š, å°è¯•å†™åœ¨ä¸€èµ·ç¡®å®ä¸å®¹æ˜“è¯´æ¸…æ¥š, æ‰€ä»¥åªèƒ½æ˜¯åˆ†å‡ æœŸæ¥åšäº†, è¿™æ¬¡å…ˆè¯´ä¸€äº›ç›¸å…³ç‰¹å¾, å’Œå¦‚ä½•é€šè¿‡è¡¥ç¯å¢ƒæ¥è¿‡æ‰åŠ å¯†ã€‚</p>
<p>åè¾¹å°½å¯èƒ½å‡ºå‡ æœŸæ‹†çš„ç»†ä¸€ç‚¹, è®²ä¸€ä¸‹çº¯ç®—æ¥è¿‡, æŠŠåŠ å¯†çš„è¿‡ç¨‹è¯¦ç»†è¯´ä¸€éã€‚</p>
<p>ç›®æ ‡ç½‘ç«™çš„è¯, æˆ‘ä»¬ç”¨è¿™ä¸ª <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.dhl.com%2Fcn-zh%2Fhome%2Ftracking.html%3Ftracking-id%3D133587%26submit%3D1%26inputsource%3Dmarketingstage%25E3%2580%2582" target="_blank" title="https://www.dhl.com/cn-zh/home/tracking.html?tracking-id=133587&amp;submit=1&amp;inputsource=marketingstage%E3%80%82" ref="nofollow noopener noreferrer">www.dhl.com/cn-zh/home/â€¦</a></p>
<h2 data-id="heading-1">ç½‘ç«™åˆ†æ</h2>
<h3 data-id="heading-2">æµç¨‹åˆ†æ</h3>
<p>ç›®æ ‡ç½‘ç«™æ˜¯ä¸€ä¸ªæŸ¥è¯¢å›½é™…ç‰©æµä¿¡æ¯çš„ç½‘ç«™, æˆ‘ä»¬æ¸…ç©º cookie , åˆ·æ–°ç½‘ç«™æ¥è§‚å¯Ÿå®ƒå‘é€çš„è¯·æ±‚ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/762c4ebf182543d69554596e72d51d87~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2xvbW1lcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765718333&amp;x-signature=dskiVk918pPEKci5zTkXTbH3SRI%3D" alt="image.png" loading="lazy"/>
<strong>æœç´¢ç»“æœç¤ºä¾‹</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a090e720c67d40bcb9dc71a2f8f25b9b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2xvbW1lcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765718333&amp;x-signature=v6T49eE6AKYTxj%2BcIydBOqMhV4w%3D" alt="image.png" loading="lazy"/>
<strong>è¯·æ±‚å¤´ä¿¡æ¯</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6e9d06f6495140f482a35f458df47bbc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2xvbW1lcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765718333&amp;x-signature=D3Y7TDnPwDdKflhRBccvv6h2JhM%3D" alt="image.png" loading="lazy"/>
<strong>è¯·æ±‚æºå¸¦å‚æ•°</strong></p>
<p>å¯ä»¥å‘ç°æºå¸¦å‚æ•°ä¸­å¹¶æ— åŠ å¯†å‚æ•°, æˆ‘ä»¬æ¥ç€æ¥æµ‹è¯•æºå¸¦çš„ Cookie ä¿¡æ¯, å¯ä»¥å¾ˆå®¹æ˜“å‘ç°æ ¸å¿ƒçš„åŠ å¯†å‚æ•°å…¶å®æ˜¯ Cookie ä¸­çš„ _abck å‚æ•°(æœ‰æ—¶ä¹Ÿéœ€è¦æºå¸¦å…¶ä»– Cookie å‚æ•°)ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬åˆ†æ Cookie çš„ç”Ÿæˆè¿‡ç¨‹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/04bbe9c2cbe444e89d261186481b991f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2xvbW1lcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765718333&amp;x-signature=Vq7aceUG%2FcKPnXCvbm0me7kYi9Q%3D" alt="image.png" loading="lazy"/>
<strong>è¯·æ±‚æµç¨‹ç¤ºä¾‹</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5277abb4915b4b9dbad99eb2067bed1e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2xvbW1lcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765718333&amp;x-signature=IiId%2FIkLBVYsIjWOnmdK6pzxkqQ%3D" alt="image.png" loading="lazy"/>
<strong>è¯·æ±‚ä¸€å“åº”ç¤ºä¾‹ä¸€</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/022b8911a4f74f47b199fe6ea7ca1e51~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2xvbW1lcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765718333&amp;x-signature=qIo%2F3MuRbi1wKmlB0XuGcgy%2Bsfc%3D" alt="image.png" loading="lazy"/>
<strong>è¯·æ±‚ä¸€å“åº”ç¤ºä¾‹äºŒ</strong></p>
<p>å¯ä»¥çœ‹åˆ°é¦–å…ˆå¯¹æˆ‘ä»¬çš„ç›®æ ‡ç½‘ç«™å‘èµ·äº†è¯·æ±‚, è·å–äº†ä¸€ä»½ Cookie , å¹¶åœ¨å“åº”ä¸­æºå¸¦äº†åç»­çš„è¯·æ±‚åœ°å€ã€‚æˆ‘ä»¬ç»§ç»­åˆ†æåç»­çš„è¯·æ±‚ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bfbce11c50484790ad4b64d83c8342ec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2xvbW1lcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765718333&amp;x-signature=pTak0ggUJ9FYh7HHy06ZZ427YtA%3D" alt="image.png" loading="lazy"/>
<strong>è¯·æ±‚äºŒå“åº”ç¤ºä¾‹</strong></p>
<p>æºå¸¦ Cookie å¯¹ä»è¯·æ±‚ä¸€ä¸­è·å–åˆ°çš„åœ°å€å‘èµ· GET è¯·æ±‚, å¯ä»¥å¾—åˆ°å¦‚å›¾æ‰€ç¤ºçš„ Js ä»£ç (ä¼šå˜)ã€‚ç„¶åç»§ç»­åˆ†æã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6bb2a9f048f8446099c76674a82873c3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2xvbW1lcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765718333&amp;x-signature=iwuO%2BScHFqNb%2BDNr5qvgJe9RRI8%3D" alt="image.png" loading="lazy"/>
<strong>è¯·æ±‚ä¸‰ç¤ºä¾‹</strong></p>
<p>æºå¸¦ä¹‹å‰çš„ Cookie ä»¥åŠå‚æ•° sensor_data, å¯¹ä¹‹å‰çš„åœ°å€å†å‘é€ä¸€æ¬¡ POST è¯·æ±‚, å°±èƒ½å¾—åˆ°æˆ‘ä»¬æœ€ç»ˆéœ€è¦çš„ Cookie å€¼ã€‚</p>
<p>ç²—ç•¥çš„è¿˜åŸäº†ä¸€ä¸‹ Akamai åŠ å¯†çš„ç‰¹å¾æµç¨‹, é€šè¿‡è¿™ä¸‰ä¸ªæ­¥éª¤æ¥å®ç° Cookie çš„ç”Ÿæˆã€‚å®é™…åˆ†æä¸­, å¤§å®¶å¯ä»¥é€šè¿‡çµæ´»è¿ç”¨æœç´¢æ , æœç´¢éœ€è¦çš„å€¼, æ¥è¿˜åŸè¿™ä¸ªåŠ å¯†è¿‡ç¨‹ã€‚</p>
<p>æ€»ç»“ä¸€ä¸‹, Akamai çš„åŠ å¯†æµç¨‹å¦‚ä¸‹:</p>
<ul>
<li>è¯·æ±‚åˆå§‹é“¾æ¥è·å– Cookie(_abckã€bmszã€ak_bmsc) ä»¥åŠä¸€ä»½ HTML(åŒ…å«åç»­ JS åœ°å€)ã€‚</li>
<li>æºå¸¦ Cookie å¯¹ JSåœ°å€ å‘èµ· GET è¯·æ±‚, è·å–è¯¦ç»†çš„ JS ä»£ç ã€‚</li>
<li>ç»§ç»­æºå¸¦ Cookie ä»¥åŠæ ¹æ® JSä»£ç ç”Ÿæˆçš„å‚æ•° sensor_data å¯¹ JSåœ°å€å‘èµ· POST è¯·æ±‚, å¾—åˆ°æœ€ç»ˆçš„ Cookieã€‚</li>
</ul>
<p>ç”±æ­¤, å¯ä»¥ç¡®å®š, çœŸæ­£éœ€è¦æˆ‘ä»¬è¿›è¡Œé€†å‘çš„å‚æ•°å°±æ˜¯ sensor_data äº†ã€‚</p>
<h3 data-id="heading-3">å †æ ˆåˆ†æ</h3>
<p>ç¡®å®šäº†éœ€è¦é€†å‘çš„å‚æ•°, æˆ‘ä»¬é‡ç‚¹å…³æ³¨çš„å°±æ˜¯è¯·æ±‚ä¸‰, æ‰“å¼€ä»–çš„å †æ ˆä¿¡æ¯, æˆ‘ä»¬æ¥æ‰¾ä¸€ä¸‹åŠ å¯†å‚æ•°çš„ç”Ÿæˆã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e2d8a0847f874bae8448b4348507413e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2xvbW1lcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765718333&amp;x-signature=E5491aICpbqyNKMzfZgtozzFtNg%3D" alt="image.png" loading="lazy"/>
<strong>å †æ ˆä¿¡æ¯ç¤ºä¾‹</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/109f0b49281f44828e985e8193a1c46f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2xvbW1lcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765718333&amp;x-signature=rzTu3e1bXh3%2BORjtyPy6ZcUFP2w%3D" alt="image.png" loading="lazy"/>
<strong>åŠ å¯†å‚æ•°ç¤ºä¾‹</strong></p>
<p>æ ¹æ®å †æ ˆä¿¡æ¯, ç‚¹è¿›å»æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä»½æ··æ·†ç›¸å½“ä¸¥é‡çš„ JS ä»£ç , åœ¨ç¬¬ä¸€ä¸ªå †æ ˆçš„ä½ç½®æ‰“ä¸Šæ–­ç‚¹, å°±å¯ä»¥æ‰¾åˆ°æˆ‘ä»¬çš„åŠ å¯†å‚æ•°, ç¨å¾®åˆ†æä¸‹, æˆ‘ä»¬å°±å¯ä»¥å‘ç°è¿™é‡Œå…¶å®æ˜¯ XMLHttpRequest.send çš„åœ°æ–¹, è¿™æ ·æˆ‘ä»¬åªéœ€è¦åœ¨è¡¥ XMLHttpRequest.send æ–¹æ³•æ—¶å°†å‚æ•°å¯¼å‡ºåˆ°å…¨å±€å°±è¡Œäº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/31936e1a1b864364b650a367f559bc89~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2xvbW1lcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765718333&amp;x-signature=DnaMrb6qqoejfpDiaaWAOjwvFWI%3D" alt="image.png" loading="lazy"/>
<strong>è§£æ··æ·†ç¤ºä¾‹</strong></p>
<p>æ”¾ä¸Šä¸€ä»½è§£æ··æ·†çš„ä»£ç , å›¾ä¸­çš„ä¸‰è¡Œå°±æ˜¯è°ƒè¯•æ—¶å€™é‚£ä¸‰è¡Œ, Q3H å³ä¸ºè°ƒè¯•æ—¶çš„ bTQã€‚ (JS ä»£ç ä¸€ç›´åœ¨å˜, æˆ‘è§£å¯†çš„ç‰ˆæœ¬å’Œè°ƒè¯•çš„ç‰ˆæœ¬ä¸ä¸€æ ·, ä½†æ˜¯æ•´ä½“çš„é€»è¾‘æ˜¯ç›¸åŒçš„)ã€‚</p>
<h2 data-id="heading-4">å¼€æ•´</h2>
<h3 data-id="heading-5">Python éƒ¨åˆ†</h3>
<p>æˆ‘ä»¬éœ€è¦é€šè¿‡ Python éƒ¨åˆ†æ¥è¿˜åŸæ•´ä¸ªåŠ å¯†æµç¨‹, å¤šæ¬¡è¯·æ±‚å¯ä»¥ä½¿ç”¨ session å¯¹è±¡æ¥å®ç°, å¦å¤–, è¿™é‡Œè¿˜æœ‰ä¸ª tls æŒ‡çº¹æ ¡éªŒçš„é—®é¢˜, å¯ä»¥ä½¿ç”¨ curl_cffi åº“æ¥å¤„ç†(å…·ä½“çš„åŸç†å¯ä»¥å‚è€ƒæˆ‘çš„ä¸Šä¸€æœŸæ–‡ç« )ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/80150efb20a148dea85319268905b673~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2xvbW1lcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765718333&amp;x-signature=LiQzF%2FgsoAUUjVsmQFFBDzejF18%3D" alt="image.png" loading="lazy"/>
<strong>Python ä»£ç ç¤ºä¾‹</strong></p>
<h3 data-id="heading-6">JS éƒ¨åˆ†</h3>
<p>JS éƒ¨åˆ†æ ¹æ®ä¹‹å‰çš„æ€è·¯, åœ¨ XMLHttpRequest.send æ—¶å°† sensor_data å¯¼å‡ºå³å¯ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/75666ee95ee840329d1fadfd3427ae13~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2xvbW1lcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765718333&amp;x-signature=%2BbbEhxiHlBAHlaKwsDPdbKrJhYo%3D" alt="image.png" loading="lazy"/>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ede59bb81315436983c74beab720dd99~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2xvbW1lcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765718333&amp;x-signature=XtbI2zUSh%2BNXmcJRawFI7KusLXk%3D" alt="image.png" loading="lazy"/>
<strong>JS ä»£ç ç¤ºä¾‹ä¸€</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6136e406b4f1496e898350190e5aca59~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2xvbW1lcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765718333&amp;x-signature=02HL3sLMwIzSm%2BnJXie4bUnlW%2FE%3D" alt="image.png" loading="lazy"/>
<strong>JS ä»£ç ç¤ºä¾‹äºŒ</strong></p>
<h3 data-id="heading-7">è¡¥ç¯å¢ƒ</h3>
<p>è¿™é‡Œè¿˜æ˜¯æ²¡ä»€ä¹ˆå¥½è¯´çš„, ç»†è‡´æ´»ç½¢äº†, ä¸è¿‡å¯ä»¥æä¸€äº›å»ºè®®ã€‚</p>
<ol>
<li>è¡¥ç¯å¢ƒè¿‡ç¨‹ä¸­, è°ƒè¯•æ—¶å€™å¯ä»¥ç”¨è§£æ··æ·†åçš„ä»£ç , è§£æ··æ·†çš„æ€è·¯è§å¾€æœŸçš„æ–‡ç« ã€‚</li>
<li>æŸäº›è¿”å›çš„ JS ä»£ç ä¸­, ä¼šæœ‰ window["window"] è¿™ç§æ–¹å¼æ¥å– window å¯¹è±¡(node ä¸­ä¼šæŠ¥é”™, æµè§ˆå™¨æ­£å¸¸), éœ€è¦æ³¨æ„ä¸€ä¸‹ã€‚</li>
<li>ç¯å¢ƒä¸­éœ€è¦ä¼ å…¥ä¸€äº› urlã€cookie å‚æ•°, å¯ä»¥é€šè¿‡å­—ç¬¦ä¸²æ‹¼æ¥çš„æ–¹å¼æ¥å®ç°, å‚è€ƒ Python éƒ¨åˆ†ã€‚</li>
</ol>
<h3 data-id="heading-8">ç»“æœç¤ºä¾‹</h3>
<p>æœ€åè¡¥ä¸€å¼ æˆåŠŸçš„ç»“æœ, åšçš„æ—¶å€™å¤šæµ‹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/887cc3c7a13448a7b2fa4e3a84db68b9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2xvbW1lcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765718333&amp;x-signature=P2Kax%2BHMSUwQbIF6mE0L4ijuOFM%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-9">æ€»ç»“</h2>
<p>æ··æ·†çš„ç¨‹åº¦ç¡®å®å¾ˆé«˜, å»ºè®®é…åˆè§£æ··æ·†æ¥ä½¿ç”¨ã€‚</p>
<p>ä»£ç ç¡®å®ç»å¸¸åœ¨å˜, ç”¨ fiddler æ¥å›ºå®šä¸€ä¸‹, ä¼šæ–¹ä¾¿å¾ˆå¤šã€‚</p>
<p><a href="https://juejin.cn/post/7576338796846350376" target="_blank" title="https://juejin.cn/post/7576338796846350376">juejin.cn/post/757633â€¦</a>  tls æŒ‡çº¹æ£€éªŒé—®é¢˜ã€‚
<a href="https://juejin.cn/post/7573193563044692022" target="_blank" title="https://juejin.cn/post/7573193563044692022">juejin.cn/post/757319â€¦</a>  åæ··æ·†å¤„ç†ã€‚</p>
<blockquote>
<p>è¯·æ´’æ½˜æ±Ÿï¼Œå„å€¾é™†æµ·äº‘å°”ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Javaæ¥å£ï¼šå®šä¹‰è¡Œä¸ºçš„"å¥‘çº¦"]]></title>    <link>https://juejin.cn/post/7580547126360965183</link>    <guid>https://juejin.cn/post/7580547126360965183</guid>    <pubDate>2025-12-07T12:07:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580547126360965183" data-draft-id="7580327140962025478" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Javaæ¥å£ï¼šå®šä¹‰è¡Œä¸ºçš„&quot;å¥‘çº¦&quot;"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-12-07T12:07:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åƒè¥¿çº¢æŸ¿é•¿å¤§çš„ç•ªèŒ„"/> <meta itemprop="url" content="https://juejin.cn/user/3097787706900985"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Javaæ¥å£ï¼šå®šä¹‰è¡Œä¸ºçš„"å¥‘çº¦"
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3097787706900985/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åƒè¥¿çº¢æŸ¿é•¿å¤§çš„ç•ªèŒ„
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T12:07:34.000Z" title="Sun Dec 07 2025 12:07:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252b3a}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px;color:#5e7ce0}.markdown-body h1{font-size:24px;margin-bottom:5px;margin-top:80px;position:relative;text-align:center}.markdown-body h2{font-size:20px;padding-bottom:12px;border-bottom:1px solid #dfe1e6}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px;margin-top:30px}.markdown-body h5{font-size:14px;margin-top:20px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #dfe1e6;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#ffeeed;color:#c73636;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#252b3a;background:#f8f8f8}.markdown-body a{position:relative;text-decoration:none;color:#5e7ce0;padding-right:18px;padding-bottom:4px}.markdown-body a[href^=http]:after{position:absolute;display:inline-block;width:16px;height:16px;margin-left:2px;margin-top:6px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAIRlWElmTU0AKgAAAAgABQESAAMAAAABAAEAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAIdpAAQAAAABAAAAWgAAAAAAAABIAAAAAQAAAEgAAAABAAOgAQADAAAAAQABAACgAgAEAAAAAQAAACCgAwAEAAAAAQAAACAAAAAAX7wP8AAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDYuMC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KGV7hBwAABWVJREFUWAnlVktsVFUY/s85997pC9BOTKxRWnEKsXWlxjWJj0RWJjrFAAXjAlewYWOkgauACVu7a2IiNUEyExM3yoZE3Wmi7qgPJthJBDE6JUNpO3Mf5/j95/bOTOcBlBgXejJ37rn/Of/7O/9/iP7vQ/zTAcjnC4ry+a5ii1OkiYTpuvjvEc0Gp51uivP+ZW+QBuSW4QjW5rptAa1Ey0uOGKOxwPetVyafN6p/52/PkNBbjdAhGaGEpMRjLZTryB8+9MUSYSGNRIcBvm8kBAY9tHYlHz78nTs392xIkwv9FA3Oe33bdoX1ZZKOS0bH0CXI6RugYLW6BwIu5gskkQ4sEG0wYF25PjBzbZfSYY6kDLUmWMt7FR7Lw3xYUkaTdjxHfTPnPwav0iEGYADVa9XIRIEyxrAA0jIQxgFL22gYwF7A8/DAzNVdksJvJaTEUZ2kYnZWziN5s1ADPHneEIXByotYuMSrf9JEbbsuv7VcvbaKML8plXtQR0EdIYDqWEmtOgAomZFH8EjWSnek2ulmtljljttHbmaIHCCCHzd9MjwfsmscBeZH9Jyd10nMvz92UQrtCBKvMF06mQy0SiEdRMEGg8mN0YjAlgoDDkPrMI5qJKSkKKydpbB2CZjJkhIBvOBw2CGQgii85bpx//dMqFRKam5uvH7w+K97oe+Cl0HO68uIBH0qyEzpOMwIbZIcFq0I+9cwoElizCjk2KFI1y7Nnx614W1db58fOXIlMzs7Xn/jeDmvBV2Q0mXjGf554O/m4LZHp2N8r61WPMvLZWLdiC4GMAk5BjeeB5lhv39l6+BIbu3m760hXMDKBD08XBKzR8fr04nygnIypOOAJUx/fHrsi0Mnys+vVK+V4VUohaiyPCo2Q9DFALvF/ikw8WS4QvVZALS5ksw47/7R8ejgTPk1UFqU6/3zp8bOM7B/kdu/fkguPGU5JibW+F0sTjWOUw8DklRrg4BiLGeBqbaRLxjlT4no0InFV402RcftJz41cH/f/JnHP3kZaaF6VX/liwist9vYG5+NU9Cg3MNkt/+lU5wS8fTxq3mc7ILjDlAE4CJpe89BOWPiIjBhi9O6PI4G1jsc6RGB3lZwmS76k8H0zOKTkFboG8jS2krFKCX2fvTeaPHIBwAkMHHgncURnL3nuCSnxSopdIzN5th0BIonJ0Lf9yUA9iMkzdRWl3BixOusfDcwQVcS4UKIFwYfGPnM8wY/DyP9NFMXaTE5BU39tGkDgGZz+fJJG0oYcSaOafLcqdECY4LzfSObSzyUOgxqtyisr8SSNOOAkubWoh3TTaeA2YtFEXPnm5x81/j+6MI6JqyS25WSNU6hbCMKHG84marJbdR+vwakRhQLRuQpbzHRLjmpmijI+OmWCtq+LzWtnX5v30gHSsqmWne74DtiACi2+Wz0iXbuLt9D2cDyoPEkWOiyp5XUIwLMi/wJY1FbH5B9ONtdC1KrsD/Q0MCQAS0wccILORDW25amAeOtooAj/KQxfzF17uwTSQ1v3dJ7jnLINwdZYRDa4tPU0sHVXFo/vxFF5BqFqxRfOmgPCk4ft2NgKTCy2Y47JIEg+MIhjYsLy5I25qUYTQlCjMRHsr/UwdYwIK33UO1J5fFNB9XNO6akcywJofVmXQDP2wfrSPcI2xG5BSs3I+IosHr4EtvO1TDAu16xHQq5+ykMblfRXLbhEoFIdDTBdhldvzl+3CMg60ZktI2vNzLW6IIp0waLklot9L63yzuUp8dJd7bglPFe3hIXstBEP58/s6Ocyr4rH2+866ZNbriTzA0RSOWCwakMl1QJgculxPt8Z7O5GLdtW6bvU8R/nO1vb+hMExVAVtEAAAAASUVORK5CYII=");background-size:100%}.markdown-body a:active,.markdown-body a:hover{border-bottom:2px solid #5e7ce0}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #5e7ce0;border-spacing:0}.markdown-body thead{color:#fff;text-align:left}.markdown-body thead tr{background:#5e7ce0}.markdown-body thead th{border-bottom:1px solid #dfe1e6}.markdown-body tr{background-color:#fff}.markdown-body tr:nth-child(2n){background-color:#f2f5fc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#252b3a;padding:1px 23px;margin:22px 0;border-left:4px solid #5e7ce0;background-color:#f2f5fc}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{padding-left:10px;margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5e7ce0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ul li::marker{content:"â€¢";color:#5e7ce0}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body input[type=checkbox]:before{display:inline-block;width:16px;height:16px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAhRJREFUeAHtnLEuBFEUhs9cu7JCskEhIrZAgYZGoREPwBuIygOoPITKA6jEG/AAolFoaFCgICIKZBNiY8Pyz5rNOWe9wNz5T7N3Z2eT/b/7zZlpziat3xKWBDJoEyh5EDd3DTk5r8vV7Yc8vzbl6zvfwvSERIYHyzI90SeLc1WZrFV85PR9oi+N/YMnOT6t/3tiLAeXFqqytjrSFacDYmfvQS6u37tOiPHA7FS/bK6PmWhpj4AJRYGA9MiKzLpK6An+cqiNVmRleUhArrec6PNzt/5sttLgh0cvcvfY6Px+ZNY9I6Ax6gKErY1xmZ8ZyD0E5MJGIgsyIZsunT3g7qALJuTdAp0nWyMTsunS2QNukbpwOcRaPpvOHvxzQow2ZBvrs+nsfLL8o0QQBJFdMO1XGkEjaIQlQCMsD/YIGkEjLAEaYXmwR9AIGmEJ0AjLgz2CRtAIS4BGWB7sETSCRlgCNMLyYI+gETTCEqARlgd7BI2gEZYAjbA82CNoBI2wBGiE5cEeQSNohCVAIywP9ggaQSMsARphebBH0AgaYQnQCMsjYC5SF2agYi2fTWcPGA7VFfO0n8+mswdMyOrCNJwnpz/P6xqZkE2Xzh4w8qcLI4Hbu/dydvkWBRAAQBZk0uOOyKyzp5PARRiF1puNtR+NTh+oMCvtJ+D8F2N6j6x+PrwzG46gRTDDm5BtsAGBg0X924Qfj7i23p7HNgQAAAAASUVORK5CYII=");background-size:100%;position:relative;right:2px;top:-5px}.markdown-body input[type=checkbox]:checked:before{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAABMtJREFUeAHtXM2KFDEQzrQKruIu4mEXRFlUVLz4A4K7B99AcO8io0/gwQfxDVzFuwu+gQf34EG8iOAPKAh6EFlBFMSf/qa2uqszlVR6ZtYxM5PDJNVVSer78nU6KrHzpyxuVlwx44AY2O0T8eb9D7f5fMu9fPvdff7y0/36nbdgdhUdd+jgHnf62JxbObvgjh/d60Pu2R35ajx49Mk9frqlBk7Kw8sXF9y1K4t9cCoi7tz/4F68/tYXMIkPzpzY725dP9yA1tsjoIRpIQHogRWYZSmwJ4Reh06nI2Nd7rYEA8zAzqXAxhgq/pc1d9vHKbEX+Dr4JbzypJDc/YxXYi/wifRLeOXpU5q7n/FK7EXsnBBeeRoqd7/EHj1ZhleeiMjdz8pArRKR+0pb+UsCuK0SkftKW/kzeFmrRHCAxWzufsaJOkqExWzufpOI8EpP1jnCJCK80pN1jjCJ4ICwMigidz/jRD3bI7bZUInIfaWt/KUSuK0SEd4jqFvufgYva5UIDrCYzd3POFFHifhfV/7k8lwPw7D5mUSEV3r854ju2pK7ffOIWzk/X+Go803Lr+ooGqoiwkyP9xzRXVt0q9sE3CgJYTLqfNPyE/irpkoEe2um6ck4bSiBSeD8JBl41jY/Hgd1lIiaaeoyLlsjgUGAjEH3DB4DtUpEW2Z3Mj5GAgA8efbVvXpX/200nln5IMYvKhHDrvylcwdc9+pSNdeg46WQsP7wo2s7fpWYaPT926fw9ZiVk4BpywYJkGuvlJs4EuWS0p/HTyHh3kbzH2najM85cR0lgpPiYMtukFB26m1u5Ua+vkFkWP3Zn0KCJDg1Px6f42Wtvhrhdyz8ncanrFKCmGH1wrwDMCrh/uxPIUFTAvdHbeVPsc1fVRE+c7Ud/k6fWt7XHFlYqcqQ5wTRvWpiY4wrIZwfDUL+akDRUBXB/jCzFCH9SHCzTDRUmsro7z+cEvrHwxOZn2ZTL/pVFcEBtRLoiWXfxQ5ehvoHHx4vpIwUEuJKSMvPz5/zQq0qwmIy5m+rjBQSwnsCQYnlgwjfT72av6oifOba2qnKcOXeGVIP0rT3BALTNr8mBWSpRHAgmJSTtLGhDHwj+A9GPCbX2DNiBSRoShg0H8zl5y/njxIhJ0WntralDJmIbO+UEvz85Zwt9wj7HIDB5Ttp7RkyGbRDSqC49vOjX50P9aexmr+qInzmajvtO13H02SpyrCVMNj8dT7/4BwByDXzRIC0LWXEldA/njVfip9GpV9VERxQM0lPhrVDyrCVMJr5/fwZJ+qWewR1lSuNJ21sXxnjVgIhck5VhM/cqG1WBpIAMX4Z9Xz+eP58sFUiOBArLQcZpQ0CNCXt1HzA5OfPOFGrrwYHyKTwbNJsxolaJUJbKeo0mu/4uMeXBHBbJSK88qP5jo97fAYva5UIDgivHEXk7mecqKNEhFeOhsjdbxKR+0pb+UsCuK0qIveVtvJn8LJWieAAi9nc/YwTdZQIi9nc/SYR4ZWenSO2yZvgcwTuRYZKWBnUI3e/xF7gcmio5L4HWPlL7AVuyPol95W28me8EnuBa8J+sZjM3c94JfYCd6VxTXjaCjDLe+K9cwTuSuOa8LQUYPXvh1d3w0HC7JK8kMK0/rcJfwHkVMYgi4xhOgAAAABJRU5ErkJggg==");background-size:100%}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="mono-blue">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#eaeef3;color:#00193a}.hljs-doctag,.hljs-keyword,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-strong,.hljs-title{font-weight:700}.hljs-comment{color:#738191}.hljs-addition,.hljs-built_in,.hljs-literal,.hljs-name,.hljs-quote,.hljs-section,.hljs-selector-class,.hljs-selector-id,.hljs-string,.hljs-tag,.hljs-title,.hljs-type{color:#0048ab}.hljs-attribute,.hljs-bullet,.hljs-deletion,.hljs-link,.hljs-meta,.hljs-regexp,.hljs-subst,.hljs-symbol,.hljs-template-variable,.hljs-variable{color:#4c81c9}.hljs-emphasis{font-style:italic}</style><h2 data-id="heading-0">å¼•è¨€ï¼šç°å®ä¸–ç•Œä¸­çš„"æ ‡å‡†æ¥å£"</h2>
<p>æƒ³è±¡ä¸€ä¸‹å„ç§ç”µå­è®¾å¤‡ï¼š</p>
<ul>
<li>æ‰€æœ‰æ‰‹æœºéƒ½ç”¨<strong>USB-Cæ¥å£</strong>å……ç”µ</li>
<li>æ‰€æœ‰å®¶ç”µéƒ½ç”¨<strong>220Væ’åº§</strong>ä¾›ç”µ</li>
<li>æ‰€æœ‰æ±½è½¦éƒ½ç”¨<strong>æ±½æ²¹æˆ–ç”µåŠ›</strong>ä½œä¸ºèƒ½æº
è¿™äº›å°±æ˜¯"æ ‡å‡†æ¥å£"ï¼åœ¨Javaä¸­ï¼Œ<strong>æ¥å£</strong>å°±åƒè¿™äº›æ ‡å‡†ï¼Œå®ƒå®šä¹‰äº†ä¸€ç»„è¡Œä¸ºè§„èŒƒï¼Œè®©ä¸åŒçš„ç±»å¯ä»¥éµå¾ªç›¸åŒçš„"æ ‡å‡†"ã€‚</li>
</ul>
<h2 data-id="heading-1">ä¸€ã€ä»€ä¹ˆæ˜¯æ¥å£ï¼Ÿ</h2>
<p><strong>æ¥å£</strong>ï¼ˆInterfaceï¼‰æ˜¯ä¸€ç§å®Œå…¨æŠ½è±¡çš„ç±»ï¼Œå®ƒåªåŒ…å«æ–¹æ³•çš„å£°æ˜ï¼Œä¸åŒ…å«æ–¹æ³•çš„å®ç°ã€‚å¯ä»¥æŠŠæ¥å£çœ‹ä½œæ˜¯ï¼š</p>
<ol>
<li><strong>å¥‘çº¦/åˆåŒ</strong>Â â†’ è§„å®šç±»å¿…é¡»å®ç°å“ªäº›æ–¹æ³•</li>
<li><strong>èƒ½åŠ›/è§’è‰²</strong>Â â†’ è¡¨ç¤ºç±»å…·å¤‡ä»€ä¹ˆèƒ½åŠ›</li>
<li><strong>æ ‡å‡†/è§„èŒƒ</strong>Â â†’ ç»Ÿä¸€çš„æ“ä½œæ–¹å¼</li>
</ol>
<h3 data-id="heading-2">æ¥å£ vs ç±»ï¼š</h3>






























<table><thead><tr><th>ç‰¹æ€§</th><th>ç±»</th><th>æ¥å£</th></tr></thead><tbody><tr><td><strong>æ–¹æ³•</strong></td><td>å¯ä»¥æœ‰å…·ä½“å®ç°</td><td>åªæœ‰å£°æ˜ï¼ˆJava 8å‰ï¼‰</td></tr><tr><td><strong>å­—æ®µ</strong></td><td>å¯ä»¥æœ‰å„ç§å­—æ®µ</td><td>åªèƒ½æ˜¯å¸¸é‡</td></tr><tr><td><strong>ç»§æ‰¿</strong></td><td>åªèƒ½ç»§æ‰¿ä¸€ä¸ªç±»</td><td>å¯ä»¥å®ç°å¤šä¸ªæ¥å£</td></tr><tr><td><strong>å®ä¾‹åŒ–</strong></td><td>å¯ä»¥åˆ›å»ºå¯¹è±¡</td><td>ä¸èƒ½åˆ›å»ºå¯¹è±¡</td></tr></tbody></table>
<h2 data-id="heading-3">äºŒã€æ¥å£çš„åŸºæœ¬ä½¿ç”¨</h2>
<h3 data-id="heading-4">2.1 å£°æ˜å’Œå®ç°æ¥å£</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 1. å£°æ˜æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Animal</span> {
    <span class="hljs-comment">// æ¥å£ä¸­çš„æ–¹æ³•é»˜è®¤æ˜¯ public abstract</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeSound</span><span class="hljs-params">()</span>;  <span class="hljs-comment">// æŠ½è±¡æ–¹æ³•</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">eat</span><span class="hljs-params">()</span>;        <span class="hljs-comment">// æŠ½è±¡æ–¹æ³•</span>
}

<span class="hljs-comment">// 2. å®ç°æ¥å£ï¼ˆä½¿ç”¨implementså…³é”®å­—ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Animal</span> {
    <span class="hljs-comment">// å¿…é¡»å®ç°æ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeSound</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"ç‹—ç‹—æ±ªæ±ªå«ï¼"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">eat</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"ç‹—ç‹—åƒéª¨å¤´"</span>);
    }
    
    <span class="hljs-comment">// å¯ä»¥æœ‰è‡ªå·±çš„æ–¹æ³•</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">fetch</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"ç‹—ç‹—æ¡çƒ"</span>);
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Animal</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeSound</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"çŒ«å’ªå–µå–µå«ï¼"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">eat</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"çŒ«å’ªåƒé±¼"</span>);
    }
    
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">climbTree</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"çŒ«å’ªçˆ¬æ ‘"</span>);
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BasicInterface</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        System.out.println(<span class="hljs-string">"=== æ¥å£åŸºæœ¬ä½¿ç”¨ ==="</span>);
        
        <span class="hljs-comment">// é€šè¿‡æ¥å£ç±»å‹å¼•ç”¨å¯¹è±¡</span>
        <span class="hljs-type">Animal</span> <span class="hljs-variable">dog</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>();
        <span class="hljs-type">Animal</span> <span class="hljs-variable">cat</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>();
        
        <span class="hljs-comment">// è°ƒç”¨æ¥å£æ–¹æ³•</span>
        dog.makeSound();
        dog.eat();
        
        cat.makeSound();
        cat.eat();
        
        <span class="hljs-comment">// å¦‚æœè¦è°ƒç”¨ç‰¹æœ‰æ–¹æ³•ï¼Œéœ€è¦å‘ä¸‹è½¬å‹</span>
        <span class="hljs-keyword">if</span> (dog <span class="hljs-keyword">instanceof</span> Dog) {
            <span class="hljs-type">Dog</span> <span class="hljs-variable">realDog</span> <span class="hljs-operator">=</span> (Dog) dog;
            realDog.fetch();
        }
        
        <span class="hljs-comment">// æ•°ç»„ç»Ÿä¸€å¤„ç†</span>
        System.out.println(<span class="hljs-string">"\n=== æ‰€æœ‰åŠ¨ç‰© ==="</span>);
        Animal[] animals = {<span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>(), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>()};
        <span class="hljs-keyword">for</span> (Animal animal : animals) {
            animal.makeSound();
            animal.eat();
            System.out.println();
        }
    }
}
</code></pre>
<h3 data-id="heading-5">2.2 æ¥å£ä¸­çš„å¸¸é‡</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InterfaceConstants</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        System.out.println(<span class="hljs-string">"=== æ¥å£ä¸­çš„å¸¸é‡ ==="</span>);
        
        <span class="hljs-comment">// è®¿é—®æ¥å£å¸¸é‡</span>
        System.out.println(<span class="hljs-string">"åœ†å‘¨ç‡: "</span> + MathConstants.PI);
        System.out.println(<span class="hljs-string">"è‡ªç„¶å¸¸æ•°: "</span> + MathConstants.E);
        System.out.println(<span class="hljs-string">"é‡åŠ›åŠ é€Ÿåº¦: "</span> + PhysicsConstants.GRAVITY);
        
        <span class="hljs-comment">// è®¡ç®—åœ†çš„é¢ç§¯</span>
        <span class="hljs-type">double</span> <span class="hljs-variable">radius</span> <span class="hljs-operator">=</span> <span class="hljs-number">5.0</span>;
        <span class="hljs-type">double</span> <span class="hljs-variable">area</span> <span class="hljs-operator">=</span> MathConstants.PI * radius * radius;
        System.out.println(<span class="hljs-string">"åŠå¾„ä¸º5çš„åœ†é¢ç§¯: "</span> + area);
        
        <span class="hljs-comment">// é…ç½®å¸¸é‡</span>
        System.out.println(<span class="hljs-string">"\n=== é…ç½®ä¿¡æ¯ ==="</span>);
        System.out.println(<span class="hljs-string">"æœ€å¤§è¿æ¥æ•°: "</span> + DatabaseConfig.MAX_CONNECTIONS);
        System.out.println(<span class="hljs-string">"é»˜è®¤ç«¯å£: "</span> + DatabaseConfig.DEFAULT_PORT);
        System.out.println(<span class="hljs-string">"è¿æ¥è¶…æ—¶: "</span> + DatabaseConfig.TIMEOUT + <span class="hljs-string">"ç§’"</span>);
    }
}

<span class="hljs-comment">// æ•°å­¦å¸¸é‡æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">MathConstants</span> {
    <span class="hljs-comment">// æ¥å£ä¸­çš„å­—æ®µé»˜è®¤æ˜¯ public static final</span>
    <span class="hljs-type">double</span> <span class="hljs-variable">PI</span> <span class="hljs-operator">=</span> <span class="hljs-number">3.141592653589793</span>;
    <span class="hljs-type">double</span> <span class="hljs-variable">E</span> <span class="hljs-operator">=</span> <span class="hljs-number">2.718281828459045</span>;
    
    <span class="hljs-comment">// ä¹Ÿå¯ä»¥æ˜¾å¼å£°æ˜</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">double</span> <span class="hljs-variable">SQRT2</span> <span class="hljs-operator">=</span> <span class="hljs-number">1.414213562373095</span>;
}

<span class="hljs-comment">// ç‰©ç†å¸¸é‡æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">PhysicsConstants</span> {
    <span class="hljs-type">double</span> <span class="hljs-variable">GRAVITY</span> <span class="hljs-operator">=</span> <span class="hljs-number">9.8</span>;           <span class="hljs-comment">// é‡åŠ›åŠ é€Ÿåº¦</span>
    <span class="hljs-type">double</span> <span class="hljs-variable">LIGHT_SPEED</span> <span class="hljs-operator">=</span> <span class="hljs-number">299792458</span>; <span class="hljs-comment">// å…‰é€Ÿ</span>
    <span class="hljs-type">double</span> <span class="hljs-variable">AVOGADRO</span> <span class="hljs-operator">=</span> <span class="hljs-number">6.022e23</span>;     <span class="hljs-comment">// é˜¿ä¼ä¼½å¾·ç½—å¸¸æ•°</span>
}

<span class="hljs-comment">// æ•°æ®åº“é…ç½®æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">DatabaseConfig</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">MAX_CONNECTIONS</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span>;
    <span class="hljs-type">int</span> <span class="hljs-variable">DEFAULT_PORT</span> <span class="hljs-operator">=</span> <span class="hljs-number">3306</span>;
    <span class="hljs-type">int</span> <span class="hljs-variable">TIMEOUT</span> <span class="hljs-operator">=</span> <span class="hljs-number">30</span>;
    <span class="hljs-type">String</span> <span class="hljs-variable">DEFAULT_HOST</span> <span class="hljs-operator">=</span> <span class="hljs-string">"localhost"</span>;
}
</code></pre>
<h2 data-id="heading-6">ä¸‰ã€æ¥å£çš„é«˜çº§ç‰¹æ€§</h2>
<h3 data-id="heading-7">3.1 é»˜è®¤æ–¹æ³•ï¼ˆJava 8+ï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DefaultMethods</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        System.out.println(<span class="hljs-string">"=== é»˜è®¤æ–¹æ³•ï¼ˆJava 8+ï¼‰==="</span>);
        
        <span class="hljs-type">Vehicle</span> <span class="hljs-variable">car</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Car</span>();
        <span class="hljs-type">Vehicle</span> <span class="hljs-variable">bike</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bike</span>();
        
        car.start();
        car.honk();      <span class="hljs-comment">// è°ƒç”¨é»˜è®¤æ–¹æ³•</span>
        car.stop();
        
        System.out.println();
        
        bike.start();
        bike.honk();     <span class="hljs-comment">// è°ƒç”¨é»˜è®¤æ–¹æ³•</span>
        bike.stop();
        
        <span class="hljs-comment">// æµ‹è¯•ç”µå­è®¾å¤‡</span>
        <span class="hljs-type">ElectronicDevice</span> <span class="hljs-variable">phone</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Smartphone</span>();
        phone.powerOn();
        phone.connectToWifi();  <span class="hljs-comment">// è°ƒç”¨é»˜è®¤æ–¹æ³•</span>
        phone.powerOff();
    }
}

<span class="hljs-comment">// äº¤é€šå·¥å…·æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Vehicle</span> {
    <span class="hljs-comment">// æŠ½è±¡æ–¹æ³•</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">stop</span><span class="hljs-params">()</span>;
    
    <span class="hljs-comment">// é»˜è®¤æ–¹æ³•ï¼ˆJava 8æ–°å¢ï¼‰</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">honk</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æŒ‰å–‡å­ï¼"</span>);
    }
    
    <span class="hljs-comment">// å¦ä¸€ä¸ªé»˜è®¤æ–¹æ³•</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">turnOnLights</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ‰“å¼€è½¦ç¯"</span>);
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Car</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Vehicle</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ±½è½¦å¯åŠ¨"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">stop</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ±½è½¦åœæ­¢"</span>);
    }
    
    <span class="hljs-comment">// å¯ä»¥é‡å†™é»˜è®¤æ–¹æ³•</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">honk</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ±½è½¦é¸£ç¬›ï¼šå˜€å˜€ï¼"</span>);
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Bike</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Vehicle</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"è‡ªè¡Œè½¦å¼€å§‹éª‘è¡Œ"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">stop</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"è‡ªè¡Œè½¦åœè½¦"</span>);
    }
    <span class="hljs-comment">// ä¸é‡å†™honk()ï¼Œä½¿ç”¨é»˜è®¤å®ç°</span>
}

<span class="hljs-comment">// ç”µå­è®¾å¤‡æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ElectronicDevice</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">powerOn</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">powerOff</span><span class="hljs-params">()</span>;
    
    <span class="hljs-comment">// é»˜è®¤æ–¹æ³•</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">connectToWifi</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"è®¾å¤‡è¿æ¥åˆ°WiFi"</span>);
    }
    
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateSoftware</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ£€æŸ¥è½¯ä»¶æ›´æ–°..."</span>);
        System.out.println(<span class="hljs-string">"è½¯ä»¶å·²æ˜¯æœ€æ–°ç‰ˆæœ¬"</span>);
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Smartphone</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ElectronicDevice</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">powerOn</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ‰‹æœºå¼€æœº"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">powerOff</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ‰‹æœºå…³æœº"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">connectToWifi</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ‰‹æœºæ‰«æWiFiä¿¡å·..."</span>);
        System.out.println(<span class="hljs-string">"è¿æ¥åˆ°å®¶åº­WiFi"</span>);
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Laptop</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ElectronicDevice</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">powerOn</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"ç¬”è®°æœ¬ç”µè„‘å¯åŠ¨"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">powerOff</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"ç¬”è®°æœ¬ç”µè„‘å…³æœº"</span>);
    }
    <span class="hljs-comment">// ä½¿ç”¨é»˜è®¤çš„connectToWifiæ–¹æ³•</span>
}
</code></pre>
<h3 data-id="heading-8">3.2 é™æ€æ–¹æ³•ï¼ˆJava 8+ï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StaticMethods</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        System.out.println(<span class="hljs-string">"=== é™æ€æ–¹æ³•ï¼ˆJava 8+ï¼‰==="</span>);
        
        <span class="hljs-comment">// è°ƒç”¨æ¥å£çš„é™æ€æ–¹æ³•</span>
        MathOperations.showInfo();
        <span class="hljs-type">double</span> <span class="hljs-variable">max</span> <span class="hljs-operator">=</span> MathOperations.max(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">15</span>);
        <span class="hljs-type">double</span> <span class="hljs-variable">min</span> <span class="hljs-operator">=</span> MathOperations.min(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">15</span>);
        
        System.out.println(<span class="hljs-string">"æœ€å¤§å€¼: "</span> + max);
        System.out.println(<span class="hljs-string">"æœ€å°å€¼: "</span> + min);
        System.out.println(<span class="hljs-string">"å¹³æ–¹æ ¹5: "</span> + MathOperations.sqrt(<span class="hljs-number">5</span>));
        
        <span class="hljs-comment">// å­—ç¬¦ä¸²å·¥å…·</span>
        System.out.println(<span class="hljs-string">"\n=== å­—ç¬¦ä¸²å·¥å…· ==="</span>);
        System.out.println(<span class="hljs-string">"åè½¬abc: "</span> + StringUtils.reverse(<span class="hljs-string">"abc"</span>));
        System.out.println(<span class="hljs-string">"å¤§å†™ABC: "</span> + StringUtils.toUpperCase(<span class="hljs-string">"abc"</span>));
        System.out.println(<span class="hljs-string">"'hello'æ˜¯å­—æ¯å—? "</span> + StringUtils.isAlpha(<span class="hljs-string">"hello"</span>));
    }
}

<span class="hljs-comment">// æ•°å­¦æ“ä½œæ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">MathOperations</span> {
    <span class="hljs-comment">// é™æ€æ–¹æ³•</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">showInfo</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ•°å­¦è¿ç®—å·¥å…·"</span>);
    }
    
    <span class="hljs-keyword">static</span> <span class="hljs-type">double</span> <span class="hljs-title function_">max</span><span class="hljs-params">(<span class="hljs-type">double</span> a, <span class="hljs-type">double</span> b, <span class="hljs-type">double</span> c)</span> {
        <span class="hljs-keyword">return</span> Math.max(Math.max(a, b), c);
    }
    
    <span class="hljs-keyword">static</span> <span class="hljs-type">double</span> <span class="hljs-title function_">min</span><span class="hljs-params">(<span class="hljs-type">double</span> a, <span class="hljs-type">double</span> b, <span class="hljs-type">double</span> c)</span> {
        <span class="hljs-keyword">return</span> Math.min(Math.min(a, b), c);
    }
    
    <span class="hljs-keyword">static</span> <span class="hljs-type">double</span> <span class="hljs-title function_">sqrt</span><span class="hljs-params">(<span class="hljs-type">double</span> x)</span> {
        <span class="hljs-keyword">return</span> Math.sqrt(x);
    }
    
    <span class="hljs-keyword">static</span> <span class="hljs-type">double</span> <span class="hljs-title function_">power</span><span class="hljs-params">(<span class="hljs-type">double</span> base, <span class="hljs-type">double</span> exponent)</span> {
        <span class="hljs-keyword">return</span> Math.pow(base, exponent);
    }
}

<span class="hljs-comment">// å­—ç¬¦ä¸²å·¥å…·æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">StringUtils</span> {
    <span class="hljs-keyword">static</span> String <span class="hljs-title function_">reverse</span><span class="hljs-params">(String str)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>(str).reverse().toString();
    }
    
    <span class="hljs-keyword">static</span> String <span class="hljs-title function_">toUpperCase</span><span class="hljs-params">(String str)</span> {
        <span class="hljs-keyword">return</span> str.toUpperCase();
    }
    
    <span class="hljs-keyword">static</span> String <span class="hljs-title function_">toLowerCase</span><span class="hljs-params">(String str)</span> {
        <span class="hljs-keyword">return</span> str.toLowerCase();
    }
    
    <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isAlpha</span><span class="hljs-params">(String str)</span> {
        <span class="hljs-keyword">return</span> str.matches(<span class="hljs-string">"[a-zA-Z]+"</span>);
    }
    
    <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isNumeric</span><span class="hljs-params">(String str)</span> {
        <span class="hljs-keyword">return</span> str.matches(<span class="hljs-string">"\d+"</span>);
    }
}
</code></pre>
<h3 data-id="heading-9">3.3 ç§æœ‰æ–¹æ³•ï¼ˆJava 9+ï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PrivateMethods</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        System.out.println(<span class="hljs-string">"=== ç§æœ‰æ–¹æ³•ï¼ˆJava 9+ï¼‰==="</span>);
        
        <span class="hljs-type">BankAccount</span> <span class="hljs-variable">account</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SavingsAccount</span>();
        account.deposit(<span class="hljs-number">1000</span>);
        account.withdraw(<span class="hljs-number">500</span>);
        account.withdraw(<span class="hljs-number">600</span>);  <span class="hljs-comment">// ä½™é¢ä¸è¶³</span>
        
        System.out.println(<span class="hljs-string">"\n=== æ—¥å¿—ç³»ç»Ÿ ==="</span>);
        <span class="hljs-type">Logger</span> <span class="hljs-variable">fileLogger</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileLogger</span>();
        fileLogger.logInfo(<span class="hljs-string">"ç¨‹åºå¯åŠ¨"</span>);
        fileLogger.logError(<span class="hljs-string">"æ–‡ä»¶æœªæ‰¾åˆ°"</span>);
        fileLogger.logDebug(<span class="hljs-string">"è°ƒè¯•ä¿¡æ¯"</span>);
    }
}

<span class="hljs-comment">// é“¶è¡Œè´¦æˆ·æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">BankAccount</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">deposit</span><span class="hljs-params">(<span class="hljs-type">double</span> amount)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">withdraw</span><span class="hljs-params">(<span class="hljs-type">double</span> amount)</span>;
    
    <span class="hljs-comment">// é»˜è®¤æ–¹æ³•</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">checkBalance</span><span class="hljs-params">()</span> {
        <span class="hljs-type">double</span> <span class="hljs-variable">balance</span> <span class="hljs-operator">=</span> getBalance();  <span class="hljs-comment">// è°ƒç”¨ç§æœ‰æ–¹æ³•</span>
        System.out.println(<span class="hljs-string">"å½“å‰ä½™é¢: "</span> + balance);
    }
    
    <span class="hljs-comment">// ç§æœ‰æ–¹æ³•ï¼ˆJava 9+ï¼‰ - åªèƒ½åœ¨æ¥å£å†…éƒ¨ä½¿ç”¨</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getBalance</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æ¨¡æ‹Ÿè·å–ä½™é¢çš„é€»è¾‘</span>
        <span class="hljs-keyword">return</span> Math.random() * <span class="hljs-number">10000</span>;
    }
    
    <span class="hljs-comment">// ç§æœ‰é™æ€æ–¹æ³•</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isValidAmount</span><span class="hljs-params">(<span class="hljs-type">double</span> amount)</span> {
        <span class="hljs-keyword">return</span> amount &gt; <span class="hljs-number">0</span>;
    }
    
    <span class="hljs-comment">// å¦ä¸€ä¸ªé»˜è®¤æ–¹æ³•</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">validateAmount</span><span class="hljs-params">(<span class="hljs-type">double</span> amount)</span> {
        <span class="hljs-keyword">if</span> (!isValidAmount(amount)) {
            System.out.println(<span class="hljs-string">"é‡‘é¢æ— æ•ˆ: "</span> + amount);
        }
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">SavingsAccount</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">BankAccount</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deposit</span><span class="hljs-params">(<span class="hljs-type">double</span> amount)</span> {
        validateAmount(amount);  <span class="hljs-comment">// è°ƒç”¨æ¥å£çš„é»˜è®¤æ–¹æ³•</span>
        System.out.println(<span class="hljs-string">"å­˜æ¬¾: "</span> + amount);
        checkBalance();  <span class="hljs-comment">// è°ƒç”¨æ¥å£çš„é»˜è®¤æ–¹æ³•</span>
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">withdraw</span><span class="hljs-params">(<span class="hljs-type">double</span> amount)</span> {
        validateAmount(amount);
        System.out.println(<span class="hljs-string">"å–æ¬¾: "</span> + amount);
        checkBalance();
    }
}

<span class="hljs-comment">// æ—¥å¿—æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Logger</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">logInfo</span><span class="hljs-params">(String message)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">logError</span><span class="hljs-params">(String message)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">logDebug</span><span class="hljs-params">(String message)</span>;
    
    <span class="hljs-comment">// ç§æœ‰æ–¹æ³•ï¼šæ ¼å¼åŒ–æ—¥å¿—</span>
    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">formatLog</span><span class="hljs-params">(String level, String message)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"["</span> + level + <span class="hljs-string">"] "</span> + <span class="hljs-keyword">new</span> <span class="hljs-title class_">java</span>.util.Date() + <span class="hljs-string">" - "</span> + message;
    }
    
    <span class="hljs-comment">// é»˜è®¤æ–¹æ³•</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">log</span><span class="hljs-params">(String level, String message)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">formatted</span> <span class="hljs-operator">=</span> formatLog(level, message);
        writeToLog(formatted);
    }
    
    <span class="hljs-comment">// æŠ½è±¡æ–¹æ³•ï¼šå…·ä½“å†™å…¥æ–¹å¼ç”±å®ç°ç±»å†³å®š</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">writeToLog</span><span class="hljs-params">(String message)</span>;
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">FileLogger</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Logger</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">logInfo</span><span class="hljs-params">(String message)</span> {
        log(<span class="hljs-string">"INFO"</span>, message);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">logError</span><span class="hljs-params">(String message)</span> {
        log(<span class="hljs-string">"ERROR"</span>, message);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">logDebug</span><span class="hljs-params">(String message)</span> {
        log(<span class="hljs-string">"DEBUG"</span>, message);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writeToLog</span><span class="hljs-params">(String message)</span> {
        <span class="hljs-comment">// æ¨¡æ‹Ÿå†™å…¥æ–‡ä»¶</span>
        System.out.println(<span class="hljs-string">"å†™å…¥æ–‡ä»¶: "</span> + message);
    }
}
</code></pre>
<h2 data-id="heading-10">å››ã€æ¥å£çš„å¤šé‡å®ç°</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MultipleInterfaces</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        System.out.println(<span class="hljs-string">"=== å¤šé‡æ¥å£å®ç° ==="</span>);
        
        <span class="hljs-comment">// åˆ›å»ºæ™ºèƒ½è®¾å¤‡</span>
        <span class="hljs-type">SmartDevice</span> <span class="hljs-variable">smartTV</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SmartTV</span>();
        <span class="hljs-type">SmartDevice</span> <span class="hljs-variable">smartphone</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Smartphone2</span>();
        
        <span class="hljs-comment">// æµ‹è¯•åŠŸèƒ½</span>
        System.out.println(<span class="hljs-string">"=== æ™ºèƒ½ç”µè§† ==="</span>);
        smartTV.powerOn();
        smartTV.connectToWifi();
        smartTV.playVideo();
        smartTV.adjustVolume(<span class="hljs-number">20</span>);
        smartTV.powerOff();
        
        System.out.println(<span class="hljs-string">"\n=== æ™ºèƒ½æ‰‹æœº ==="</span>);
        smartphone.powerOn();
        smartphone.connectToWifi();
        smartphone.playVideo();
        smartphone.adjustVolume(<span class="hljs-number">15</span>);
        smartphone.makeCall(<span class="hljs-string">"123456789"</span>);
        smartphone.powerOff();
        
        <span class="hljs-comment">// æµ‹è¯•å¯é£è¡Œçš„åŠ¨ç‰©</span>
        System.out.println(<span class="hljs-string">"\n=== å¯é£è¡Œçš„åŠ¨ç‰© ==="</span>);
        <span class="hljs-type">Flyable</span> <span class="hljs-variable">bird</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bird</span>();
        <span class="hljs-type">Flyable</span> <span class="hljs-variable">bat</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bat</span>();
        
        bird.fly();
        bird.land();
        
        bat.fly();
        bat.land();
        
        <span class="hljs-comment">// æµ‹è¯•åŒæ—¶å®ç°å¤šä¸ªæ¥å£</span>
        System.out.println(<span class="hljs-string">"\n=== è¶…çº§åŠ¨ç‰© ==="</span>);
        <span class="hljs-type">SuperAnimal</span> <span class="hljs-variable">eagle</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Eagle</span>();
        eagle.fly();
        eagle.swim();
        eagle.run();
        eagle.hunt();
    }
}

<span class="hljs-comment">// æ¥å£1ï¼šç”µå­è®¾å¤‡</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ElectronicDevice2</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">powerOn</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">powerOff</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">connectToWifi</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"è¿æ¥åˆ°WiFiç½‘ç»œ"</span>);
    }
}

<span class="hljs-comment">// æ¥å£2ï¼šå¤šåª’ä½“è®¾å¤‡</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">MultimediaDevice</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">playVideo</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">playAudio</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">adjustVolume</span><span class="hljs-params">(<span class="hljs-type">int</span> level)</span> {
        System.out.println(<span class="hljs-string">"è°ƒæ•´éŸ³é‡åˆ°: "</span> + level);
    }
}

<span class="hljs-comment">// æ¥å£3ï¼šé€šä¿¡è®¾å¤‡</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">CommunicationDevice</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeCall</span><span class="hljs-params">(String number)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendMessage</span><span class="hljs-params">(String number, String message)</span>;
}

<span class="hljs-comment">// æ™ºèƒ½è®¾å¤‡æ¥å£ï¼ˆç»§æ‰¿å¤šä¸ªæ¥å£ï¼‰</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">SmartDevice</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ElectronicDevice2</span>, MultimediaDevice, CommunicationDevice {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateSoftware</span><span class="hljs-params">()</span>;
}

<span class="hljs-comment">// å®ç°ç±»1ï¼šæ™ºèƒ½ç”µè§†</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SmartTV</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">SmartDevice</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">powerOn</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ™ºèƒ½ç”µè§†å¼€æœº"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">powerOff</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ™ºèƒ½ç”µè§†å…³æœº"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">playVideo</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"ç”µè§†æ’­æ”¾è§†é¢‘"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">playAudio</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"ç”µè§†æ’­æ”¾éŸ³é¢‘"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeCall</span><span class="hljs-params">(String number)</span> {
        System.out.println(<span class="hljs-string">"ç”µè§†ä¸æ”¯æŒæ‰“ç”µè¯"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendMessage</span><span class="hljs-params">(String number, String message)</span> {
        System.out.println(<span class="hljs-string">"ç”µè§†ä¸æ”¯æŒå‘çŸ­ä¿¡"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateSoftware</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"ç”µè§†è½¯ä»¶æ›´æ–°"</span>);
    }
}

<span class="hljs-comment">// å®ç°ç±»2ï¼šæ™ºèƒ½æ‰‹æœº</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Smartphone2</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">SmartDevice</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">powerOn</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ‰‹æœºå¼€æœº"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">powerOff</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ‰‹æœºå…³æœº"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">playVideo</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ‰‹æœºæ’­æ”¾è§†é¢‘"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">playAudio</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ‰‹æœºæ’­æ”¾éŸ³ä¹"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeCall</span><span class="hljs-params">(String number)</span> {
        System.out.println(<span class="hljs-string">"æ‰‹æœºæ‹¨æ‰“ç”µè¯: "</span> + number);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendMessage</span><span class="hljs-params">(String number, String message)</span> {
        System.out.println(<span class="hljs-string">"æ‰‹æœºå‘é€çŸ­ä¿¡åˆ°"</span> + number + <span class="hljs-string">": "</span> + message);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateSoftware</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ‰‹æœºç³»ç»Ÿæ›´æ–°"</span>);
    }
}

<span class="hljs-comment">// æ›´å¤šæ¥å£ç¤ºä¾‹</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Flyable</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">fly</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">land</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"é™è½"</span>);
    }
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Swimmable</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">swim</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Runnable</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>;
}

<span class="hljs-comment">// é¸Ÿï¼šåªèƒ½é£</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Bird</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Flyable</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fly</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"é¸Ÿå„¿åœ¨å¤©ç©ºé£ç¿”"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">land</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"é¸Ÿå„¿åœåœ¨æ ‘æä¸Š"</span>);
    }
}

<span class="hljs-comment">// è™è ï¼šèƒ½é£ï¼Œä½†ä¸æ˜¯é¸Ÿ</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Bat</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Flyable</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fly</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"è™è åœ¨å¤œé—´é£è¡Œ"</span>);
    }
}

<span class="hljs-comment">// è¶…çº§åŠ¨ç‰©ï¼šèƒ½é£ã€èƒ½æ¸¸ã€èƒ½è·‘</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SuperAnimal</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Flyable</span>, Swimmable, Runnable {
    <span class="hljs-keyword">private</span> String name;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">SuperAnimal</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">this</span>.name = <span class="hljs-string">"è¶…çº§åŠ¨ç‰©"</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fly</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">"åœ¨å¤©ç©ºç¿±ç¿”"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">swim</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">"åœ¨æ°´ä¸­æ¸¸æ³³"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">"åœ¨é™†åœ°å¥”è·‘"</span>);
    }
    
    <span class="hljs-comment">// ç‰¹æœ‰æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">hunt</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">"åœ¨æ•çŒ"</span>);
    }
}

<span class="hljs-comment">// é¹°ï¼šç»§æ‰¿è¶…çº§åŠ¨ç‰©</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Eagle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">SuperAnimal</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Eagle</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// å¯ä»¥è®¾ç½®ä¸åŒçš„åå­—</span>
    }
}
</code></pre>
<h2 data-id="heading-11">äº”ã€æ¥å£ç»§æ‰¿æ¥å£</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InterfaceInheritance</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        System.out.println(<span class="hljs-string">"=== æ¥å£ç»§æ‰¿æ¥å£ ==="</span>);
        
        <span class="hljs-comment">// ä½¿ç”¨é«˜çº§æ‰“å°æœº</span>
        <span class="hljs-type">AdvancedPrinter</span> <span class="hljs-variable">printer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OfficePrinter</span>();
        printer.powerOn();
        printer.print(<span class="hljs-string">"æµ‹è¯•æ–‡æ¡£"</span>);
        printer.scan();
        printer.fax(<span class="hljs-string">"ä¼ çœŸå†…å®¹"</span>);
        printer.copy();
        printer.powerOff();
        
        <span class="hljs-comment">// æµ‹è¯•ç½‘ç»œåŠŸèƒ½</span>
        <span class="hljs-type">NetworkDevice</span> <span class="hljs-variable">router</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">WiFiRouter</span>();
        router.connect();
        router.disconnect();
        router.getIPAddress();
        
        <span class="hljs-comment">// è½¦è¾†æµ‹è¯•</span>
        <span class="hljs-type">Vehicle2</span> <span class="hljs-variable">car</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ModernCar</span>();
        car.start();
        car.drive();
        car.playMusic();
        car.navigateTo(<span class="hljs-string">"åŒ—äº¬"</span>);
        car.stop();
    }
}

<span class="hljs-comment">// åŸºç¡€æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Printer</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">powerOn</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">powerOff</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">print</span><span class="hljs-params">(String document)</span>;
}

<span class="hljs-comment">// ç»§æ‰¿åŸºç¡€æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Scanner</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Printer</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">scan</span><span class="hljs-params">()</span>;
}

<span class="hljs-comment">// å†æ¬¡ç»§æ‰¿</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">FaxMachine</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Scanner</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">fax</span><span class="hljs-params">(String document)</span>;
}

<span class="hljs-comment">// å†æ¬¡ç»§æ‰¿</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Copier</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">FaxMachine</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">copy</span><span class="hljs-params">()</span>;
}

<span class="hljs-comment">// æœ€ç»ˆæ¥å£ï¼šé«˜çº§æ‰“å°æœº</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">AdvancedPrinter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Copier</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">showStatus</span><span class="hljs-params">()</span>;
}

<span class="hljs-comment">// å®ç°æœ€ç»ˆæ¥å£</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">OfficePrinter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">AdvancedPrinter</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">powerOn</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ‰“å°æœºå¼€æœº"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">powerOff</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ‰“å°æœºå…³æœº"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">print</span><span class="hljs-params">(String document)</span> {
        System.out.println(<span class="hljs-string">"æ‰“å°: "</span> + document);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">scan</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ‰«ææ–‡æ¡£"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fax</span><span class="hljs-params">(String document)</span> {
        System.out.println(<span class="hljs-string">"ä¼ çœŸ: "</span> + document);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">copy</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"å¤å°æ–‡æ¡£"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">showStatus</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ‰“å°æœºçŠ¶æ€: æ­£å¸¸"</span>);
    }
}

<span class="hljs-comment">// å¦ä¸€ä¸ªä¾‹å­ï¼šç½‘ç»œè®¾å¤‡</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">NetworkDevice</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">connect</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">disconnect</span><span class="hljs-params">()</span>;
    String <span class="hljs-title function_">getIPAddress</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">WirelessDevice</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">NetworkDevice</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">connectToWifi</span><span class="hljs-params">(String ssid, String password)</span>;
    <span class="hljs-type">int</span> <span class="hljs-title function_">getSignalStrength</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Router</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">WirelessDevice</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">setSSID</span><span class="hljs-params">(String ssid)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">setPassword</span><span class="hljs-params">(String password)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">restart</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">WiFiRouter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Router</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">ssid</span> <span class="hljs-operator">=</span> <span class="hljs-string">"MyWiFi"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">password</span> <span class="hljs-operator">=</span> <span class="hljs-string">"password123"</span>;
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">connect</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"è·¯ç”±å™¨è¿æ¥ç½‘ç»œ"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">disconnect</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"è·¯ç”±å™¨æ–­å¼€ç½‘ç»œ"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getIPAddress</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"192.168.1.1"</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">connectToWifi</span><span class="hljs-params">(String ssid, String password)</span> {
        System.out.println(<span class="hljs-string">"è¿æ¥åˆ°WiFi: "</span> + ssid);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getSignalStrength</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-number">90</span>; <span class="hljs-comment">// ä¿¡å·å¼ºåº¦ç™¾åˆ†æ¯”</span>
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setSSID</span><span class="hljs-params">(String ssid)</span> {
        <span class="hljs-built_in">this</span>.ssid = ssid;
        System.out.println(<span class="hljs-string">"è®¾ç½®SSIDä¸º: "</span> + ssid);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setPassword</span><span class="hljs-params">(String password)</span> {
        <span class="hljs-built_in">this</span>.password = password;
        System.out.println(<span class="hljs-string">"è®¾ç½®å¯†ç "</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">restart</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"é‡å¯è·¯ç”±å™¨"</span>);
    }
}

<span class="hljs-comment">// æ±½è½¦æ¥å£ç»§æ‰¿é“¾</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">BasicVehicle</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">stop</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Drivable</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BasicVehicle</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">drive</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">brake</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">EntertainmentSystem</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">playMusic</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">playRadio</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">NavigationSystem</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">navigateTo</span><span class="hljs-params">(String destination)</span>;
    String <span class="hljs-title function_">getCurrentLocation</span><span class="hljs-params">()</span>;
}

<span class="hljs-comment">// ç»„åˆå¤šä¸ªæ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ModernCar</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Drivable</span>, EntertainmentSystem, NavigationSystem {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">enableAutopilot</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ModernCarImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ModernCar</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ±½è½¦å¯åŠ¨"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">stop</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ±½è½¦åœæ­¢"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">drive</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ±½è½¦è¡Œé©¶"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">brake</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"åˆ¹è½¦"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">playMusic</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ’­æ”¾éŸ³ä¹"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">playRadio</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ’­æ”¾å¹¿æ’­"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">navigateTo</span><span class="hljs-params">(String destination)</span> {
        System.out.println(<span class="hljs-string">"å¯¼èˆªåˆ°: "</span> + destination);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getCurrentLocation</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"å½“å‰ä½ç½®: åŒ—äº¬å¸‚æœé˜³åŒº"</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">enableAutopilot</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"å¯ç”¨è‡ªåŠ¨é©¾é©¶"</span>);
    }
}
</code></pre>
<h2 data-id="heading-12">å…­ã€æ¥å£åœ¨å®é™…é¡¹ç›®ä¸­çš„åº”ç”¨</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.ArrayList;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RealWorldInterface</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        System.out.println(<span class="hljs-string">"=== çœŸå®ä¸–ç•Œæ¥å£åº”ç”¨ ==="</span>);
        
        <span class="hljs-comment">// åˆ›å»ºæ•°æ®å­˜å‚¨æœåŠ¡</span>
        <span class="hljs-type">DataStorageService</span> <span class="hljs-variable">storageService</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataStorageService</span>();
        
        <span class="hljs-comment">// ä½¿ç”¨ä¸åŒçš„å­˜å‚¨æ–¹å¼</span>
        <span class="hljs-type">Storage</span> <span class="hljs-variable">database</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DatabaseStorage</span>();
        <span class="hljs-type">Storage</span> <span class="hljs-variable">fileSystem</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileSystemStorage</span>();
        <span class="hljs-type">Storage</span> <span class="hljs-variable">cloud</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CloudStorage</span>();
        
        <span class="hljs-comment">// å­˜å‚¨æ•°æ®</span>
        storageService.storeData(database, <span class="hljs-string">"ç”¨æˆ·æ•°æ®"</span>);
        storageService.storeData(fileSystem, <span class="hljs-string">"æ—¥å¿—æ–‡ä»¶"</span>);
        storageService.storeData(cloud, <span class="hljs-string">"å¤‡ä»½æ•°æ®"</span>);
        
        <span class="hljs-comment">// æ£€ç´¢æ•°æ®</span>
        storageService.retrieveData(database, <span class="hljs-string">"ç”¨æˆ·æ•°æ®"</span>);
        storageService.retrieveData(cloud, <span class="hljs-string">"å¤‡ä»½æ•°æ®"</span>);
        
        <span class="hljs-comment">// æµ‹è¯•æ‰€æœ‰å­˜å‚¨æ–¹å¼</span>
        System.out.println(<span class="hljs-string">"\n=== æµ‹è¯•æ‰€æœ‰å­˜å‚¨æ–¹å¼ ==="</span>);
        Storage[] storages = {database, fileSystem, cloud};
        <span class="hljs-keyword">for</span> (Storage storage : storages) {
            storage.testConnection();
            storage.showInfo();
            System.out.println();
        }
        
        <span class="hljs-comment">// æ”¯ä»˜å¤„ç†</span>
        System.out.println(<span class="hljs-string">"=== æ”¯ä»˜å¤„ç†ç³»ç»Ÿ ==="</span>);
        <span class="hljs-type">PaymentProcessor</span> <span class="hljs-variable">processor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PaymentProcessor</span>();
        
        <span class="hljs-type">Payment</span> <span class="hljs-variable">alipay</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AlipayPayment</span>();
        <span class="hljs-type">Payment</span> <span class="hljs-variable">wechat</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">WechatPayment</span>();
        <span class="hljs-type">Payment</span> <span class="hljs-variable">bank</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BankTransferPayment</span>();
        
        processor.processPayment(alipay, <span class="hljs-number">100.0</span>);
        processor.processPayment(wechat, <span class="hljs-number">200.0</span>);
        processor.processPayment(bank, <span class="hljs-number">300.0</span>);
        
        <span class="hljs-comment">// éªŒè¯æ‰€æœ‰æ”¯ä»˜æ–¹å¼</span>
        Payment[] payments = {alipay, wechat, bank};
        <span class="hljs-keyword">for</span> (Payment payment : payments) {
            <span class="hljs-keyword">if</span> (payment.isValid()) {
                System.out.println(payment.getName() + <span class="hljs-string">" æ˜¯æœ‰æ•ˆçš„æ”¯ä»˜æ–¹å¼"</span>);
            }
        }
    }
}

<span class="hljs-comment">// å­˜å‚¨æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Storage</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">store</span><span class="hljs-params">(String data)</span>;
    String <span class="hljs-title function_">retrieve</span><span class="hljs-params">(String key)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">delete</span><span class="hljs-params">(String key)</span>;
    
    <span class="hljs-comment">// é»˜è®¤æ–¹æ³•</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testConnection</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æµ‹è¯•å­˜å‚¨è¿æ¥..."</span>);
    }
    
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">showInfo</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"å­˜å‚¨ç³»ç»Ÿä¿¡æ¯"</span>);
    }
    
    <span class="hljs-comment">// é™æ€æ–¹æ³•</span>
    <span class="hljs-keyword">static</span> Storage <span class="hljs-title function_">getDefaultStorage</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileSystemStorage</span>();
    }
}

<span class="hljs-comment">// æ•°æ®åº“å­˜å‚¨å®ç°</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">DatabaseStorage</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Storage</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">store</span><span class="hljs-params">(String data)</span> {
        System.out.println(<span class="hljs-string">"å°†æ•°æ®å­˜å‚¨åˆ°æ•°æ®åº“: "</span> + data);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">retrieve</span><span class="hljs-params">(String key)</span> {
        System.out.println(<span class="hljs-string">"ä»æ•°æ®åº“æ£€ç´¢æ•°æ®: "</span> + key);
        <span class="hljs-keyword">return</span> <span class="hljs-string">"æ•°æ®åº“æ•°æ®"</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">delete</span><span class="hljs-params">(String key)</span> {
        System.out.println(<span class="hljs-string">"ä»æ•°æ®åº“åˆ é™¤æ•°æ®: "</span> + key);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">showInfo</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ•°æ®åº“å­˜å‚¨ç³»ç»Ÿ"</span>);
        System.out.println(<span class="hljs-string">"ç±»å‹: MySQL"</span>);
        System.out.println(<span class="hljs-string">"ç‰ˆæœ¬: 8.0"</span>);
    }
}

<span class="hljs-comment">// æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨å®ç°</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">FileSystemStorage</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Storage</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">store</span><span class="hljs-params">(String data)</span> {
        System.out.println(<span class="hljs-string">"å°†æ•°æ®å­˜å‚¨åˆ°æ–‡ä»¶ç³»ç»Ÿ: "</span> + data);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">retrieve</span><span class="hljs-params">(String key)</span> {
        System.out.println(<span class="hljs-string">"ä»æ–‡ä»¶ç³»ç»Ÿæ£€ç´¢æ–‡ä»¶: "</span> + key);
        <span class="hljs-keyword">return</span> <span class="hljs-string">"æ–‡ä»¶æ•°æ®"</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">delete</span><span class="hljs-params">(String key)</span> {
        System.out.println(<span class="hljs-string">"ä»æ–‡ä»¶ç³»ç»Ÿåˆ é™¤æ–‡ä»¶: "</span> + key);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">showInfo</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨"</span>);
        System.out.println(<span class="hljs-string">"ç±»å‹: NTFS"</span>);
        System.out.println(<span class="hljs-string">"å®¹é‡: 1TB"</span>);
    }
}

<span class="hljs-comment">// äº‘å­˜å‚¨å®ç°</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CloudStorage</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Storage</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">store</span><span class="hljs-params">(String data)</span> {
        System.out.println(<span class="hljs-string">"å°†æ•°æ®ä¸Šä¼ åˆ°äº‘å­˜å‚¨: "</span> + data);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">retrieve</span><span class="hljs-params">(String key)</span> {
        System.out.println(<span class="hljs-string">"ä»äº‘å­˜å‚¨ä¸‹è½½æ•°æ®: "</span> + key);
        <span class="hljs-keyword">return</span> <span class="hljs-string">"äº‘å­˜å‚¨æ•°æ®"</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">delete</span><span class="hljs-params">(String key)</span> {
        System.out.println(<span class="hljs-string">"ä»äº‘å­˜å‚¨åˆ é™¤æ•°æ®: "</span> + key);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">showInfo</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"äº‘å­˜å‚¨ç³»ç»Ÿ"</span>);
        System.out.println(<span class="hljs-string">"æä¾›å•†: AWS S3"</span>);
        System.out.println(<span class="hljs-string">"åŒºåŸŸ: us-east-1"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testConnection</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æµ‹è¯•äº‘å­˜å‚¨è¿æ¥..."</span>);
        System.out.println(<span class="hljs-string">"è¿æ¥æˆåŠŸï¼å»¶è¿Ÿ: 50ms"</span>);
    }
}

<span class="hljs-comment">// æ•°æ®å­˜å‚¨æœåŠ¡</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">DataStorageService</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">storeData</span><span class="hljs-params">(Storage storage, String data)</span> {
        System.out.println(<span class="hljs-string">"\n=== å­˜å‚¨æ•°æ® ==="</span>);
        storage.store(data);
        System.out.println(<span class="hljs-string">"=== å­˜å‚¨å®Œæˆ ==="</span>);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">retrieveData</span><span class="hljs-params">(Storage storage, String key)</span> {
        System.out.println(<span class="hljs-string">"\n=== æ£€ç´¢æ•°æ® ==="</span>);
        <span class="hljs-type">String</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> storage.retrieve(key);
        System.out.println(<span class="hljs-string">"è·å–åˆ°æ•°æ®: "</span> + data);
        System.out.println(<span class="hljs-string">"=== æ£€ç´¢å®Œæˆ ==="</span>);
    }
}

<span class="hljs-comment">// æ”¯ä»˜æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Payment</span> {
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">process</span><span class="hljs-params">(<span class="hljs-type">double</span> amount)</span>;
    String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span>;
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">isValid</span><span class="hljs-params">()</span>;
    
    <span class="hljs-comment">// é»˜è®¤æ–¹æ³•</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">refund</span><span class="hljs-params">(<span class="hljs-type">double</span> amount)</span> {
        System.out.println(<span class="hljs-string">"é€€æ¬¾: "</span> + amount + <span class="hljs-string">"å…ƒ"</span>);
    }
}

<span class="hljs-comment">// æ”¯ä»˜å®æ”¯ä»˜</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AlipayPayment</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Payment</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">process</span><span class="hljs-params">(<span class="hljs-type">double</span> amount)</span> {
        System.out.println(<span class="hljs-string">"æ”¯ä»˜å®æ”¯ä»˜: "</span> + amount + <span class="hljs-string">"å…ƒ"</span>);
        System.out.println(<span class="hljs-string">"è·³è½¬åˆ°æ”¯ä»˜å®é¡µé¢..."</span>);
        System.out.println(<span class="hljs-string">"æ”¯ä»˜æˆåŠŸï¼"</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"æ”¯ä»˜å®"</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isValid</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">refund</span><span class="hljs-params">(<span class="hljs-type">double</span> amount)</span> {
        System.out.println(<span class="hljs-string">"æ”¯ä»˜å®é€€æ¬¾: "</span> + amount + <span class="hljs-string">"å…ƒ"</span>);
        System.out.println(<span class="hljs-string">"é€€æ¬¾å°†åœ¨3ä¸ªå·¥ä½œæ—¥å†…åˆ°è´¦"</span>);
    }
}

<span class="hljs-comment">// å¾®ä¿¡æ”¯ä»˜</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">WechatPayment</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Payment</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">process</span><span class="hljs-params">(<span class="hljs-type">double</span> amount)</span> {
        System.out.println(<span class="hljs-string">"å¾®ä¿¡æ”¯ä»˜: "</span> + amount + <span class="hljs-string">"å…ƒ"</span>);
        System.out.println(<span class="hljs-string">"è·³è½¬åˆ°å¾®ä¿¡æ”¯ä»˜..."</span>);
        System.out.println(<span class="hljs-string">"æ”¯ä»˜æˆåŠŸï¼"</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"å¾®ä¿¡æ”¯ä»˜"</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isValid</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
}

<span class="hljs-comment">// é“¶è¡Œè½¬è´¦</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">BankTransferPayment</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Payment</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">process</span><span class="hljs-params">(<span class="hljs-type">double</span> amount)</span> {
        System.out.println(<span class="hljs-string">"é“¶è¡Œè½¬è´¦: "</span> + amount + <span class="hljs-string">"å…ƒ"</span>);
        System.out.println(<span class="hljs-string">"è¯·ä½¿ç”¨ç½‘é“¶æˆ–æ‰‹æœºé“¶è¡Œå®Œæˆè½¬è´¦"</span>);
        System.out.println(<span class="hljs-string">"è½¬è´¦æˆåŠŸï¼"</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"é“¶è¡Œè½¬è´¦"</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isValid</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
}

<span class="hljs-comment">// æ”¯ä»˜å¤„ç†å™¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PaymentProcessor</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processPayment</span><span class="hljs-params">(Payment payment, <span class="hljs-type">double</span> amount)</span> {
        System.out.println(<span class="hljs-string">"\n=== å¼€å§‹æ”¯ä»˜ ==="</span>);
        <span class="hljs-type">boolean</span> <span class="hljs-variable">success</span> <span class="hljs-operator">=</span> payment.process(amount);
        <span class="hljs-keyword">if</span> (success) {
            System.out.println(<span class="hljs-string">"æ”¯ä»˜å¤„ç†å®Œæˆ"</span>);
        } <span class="hljs-keyword">else</span> {
            System.out.println(<span class="hljs-string">"æ”¯ä»˜å¤±è´¥"</span>);
        }
        System.out.println(<span class="hljs-string">"=== æ”¯ä»˜ç»“æŸ ==="</span>);
    }
}
</code></pre>
<h2 data-id="heading-13">ä¸ƒã€æ€»ç»“</h2>
<h3 data-id="heading-14">7.1 æ¥å£çš„æ ¸å¿ƒæ¦‚å¿µ</h3>
<ol>
<li><strong>å¥‘çº¦æ€§</strong>ï¼šè§„å®šç±»å¿…é¡»å®ç°çš„æ–¹æ³•</li>
<li><strong>æŠ½è±¡æ€§</strong>ï¼šåªå£°æ˜æ–¹æ³•ï¼Œä¸æä¾›å®ç°ï¼ˆJava 8å‰ï¼‰</li>
<li><strong>å¤šå®ç°</strong>ï¼šä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£</li>
<li><strong>è§£è€¦åˆ</strong>ï¼šåˆ†ç¦»å®šä¹‰å’Œå®ç°</li>
</ol>
<h3 data-id="heading-15">7.2 æ¥å£çš„å‘å±•å†ç¨‹</h3>





















<table><thead><tr><th>Javaç‰ˆæœ¬</th><th>æ¥å£æ–°ç‰¹æ€§</th></tr></thead><tbody><tr><td>Java 7åŠä¹‹å‰</td><td>åªæœ‰æŠ½è±¡æ–¹æ³•å’Œå¸¸é‡</td></tr><tr><td>Java 8</td><td>é»˜è®¤æ–¹æ³•ã€é™æ€æ–¹æ³•</td></tr><tr><td>Java 9</td><td>ç§æœ‰æ–¹æ³•ã€ç§æœ‰é™æ€æ–¹æ³•</td></tr></tbody></table>
<h3 data-id="heading-16">7.3 ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ¥å£ï¼Ÿ</h3>
<ol>
<li><strong>å®šä¹‰è¡Œä¸ºè§„èŒƒ</strong>Â â†’ éœ€è¦å¤šä¸ªç±»éµå¾ªç›¸åŒçš„è§„èŒƒ</li>
<li><strong>å®ç°å¤šé‡ç»§æ‰¿</strong>Â â†’ ä¸€ä¸ªç±»éœ€è¦å¤šç§èƒ½åŠ›</li>
<li><strong>è§£è€¦åˆ</strong>Â â†’ åˆ†ç¦»æ¥å£å’Œå®ç°</li>
<li><strong>å®šä¹‰å›è°ƒ</strong>Â â†’ äº‹ä»¶å¤„ç†ã€ç›‘å¬å™¨</li>
<li><strong>ç­–ç•¥æ¨¡å¼</strong>Â â†’ å¤šç§ç®—æ³•æˆ–ç­–ç•¥</li>
</ol>
<h3 data-id="heading-17">7.4 æ¥å£ vs æŠ½è±¡ç±»</h3>



































<table><thead><tr><th>ç‰¹æ€§</th><th>æ¥å£</th><th>æŠ½è±¡ç±»</th></tr></thead><tbody><tr><td><strong>æ–¹æ³•å®ç°</strong></td><td>å¯ä»¥æœ‰é»˜è®¤å®ç°</td><td>å¯ä»¥æœ‰å…·ä½“å®ç°</td></tr><tr><td><strong>å­—æ®µ</strong></td><td>åªèƒ½æ˜¯å¸¸é‡</td><td>å¯ä»¥æœ‰å„ç§å­—æ®µ</td></tr><tr><td><strong>æ„é€ æ–¹æ³•</strong></td><td>ä¸èƒ½æœ‰</td><td>å¯ä»¥æœ‰</td></tr><tr><td><strong>å¤šç»§æ‰¿</strong></td><td>æ”¯æŒå¤šå®ç°</td><td>åªèƒ½å•ç»§æ‰¿</td></tr><tr><td><strong>è®¾è®¡ç›®çš„</strong></td><td>å®šä¹‰è¡Œä¸ºå¥‘çº¦</td><td>æä¾›éƒ¨åˆ†å®ç°</td></tr></tbody></table>
<h3 data-id="heading-18">7.5 å¿«é€Ÿè®°å¿†å£è¯€</h3>
<ol>
<li><strong>æ¥å£å®šä¹‰è¡Œä¸ºï¼Œç±»æ¥å®ç°è¡Œä¸º</strong></li>
<li><strong>ä¸€ä¸ªç±»å¤šæ¥å£ï¼Œå¼¥è¡¥å•ç»§æ‰¿</strong></li>
<li><strong>é»˜è®¤æ–¹æ³•é˜²ç ´åï¼Œé™æ€æ–¹æ³•å·¥å…·ç±»</strong></li>
<li><strong>ç§æœ‰æ–¹æ³•å†…å…±äº«ï¼Œä»£ç å¤ç”¨æ¥å£å†…</strong></li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[âš ï¸ è­¦å‘Šï¼99%çš„å¼€å‘è€…éƒ½è¸©è¿‡è¿™ä¸ªå‘ï¼šPython3å®‰è£…åç³»ç»Ÿå½»åº•ç˜«ç—ªï¼yumç›´æ¥æŠ¥åºŸçš„çœŸç›¸]]></title>    <link>https://juejin.cn/post/7580550040395776035</link>    <guid>https://juejin.cn/post/7580550040395776035</guid>    <pubDate>2025-12-07T14:26:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580550040395776035" data-draft-id="7580570363602452532" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="âš ï¸ è­¦å‘Šï¼99%çš„å¼€å‘è€…éƒ½è¸©è¿‡è¿™ä¸ªå‘ï¼šPython3å®‰è£…åç³»ç»Ÿå½»åº•ç˜«ç—ªï¼yumç›´æ¥æŠ¥åºŸçš„çœŸç›¸"/> <meta itemprop="keywords" content="Python,Linux"/> <meta itemprop="datePublished" content="2025-12-07T14:26:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¶æ—¥å¤±çœ è€…"/> <meta itemprop="url" content="https://juejin.cn/user/3411111810444068"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            âš ï¸ è­¦å‘Šï¼99%çš„å¼€å‘è€…éƒ½è¸©è¿‡è¿™ä¸ªå‘ï¼šPython3å®‰è£…åç³»ç»Ÿå½»åº•ç˜«ç—ªï¼yumç›´æ¥æŠ¥åºŸçš„çœŸç›¸
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3411111810444068/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¶æ—¥å¤±çœ è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T14:26:45.000Z" title="Sun Dec 07 2025 14:26:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>ğŸ”¥ ç´§æ€¥è­¦å‘Š</strong><br/>
å¦‚æœä½ æ­£åœ¨Linuxç³»ç»Ÿä¸Šå®‰è£…Python3ï¼Œ<strong>è¯·ç«‹å³åœæ­¢</strong>ï¼<br/>
å¸¸è§„å®‰è£…æ–¹æ³•æœ‰<strong>99%çš„æ¦‚ç‡</strong>ä¼šè®©ä½ çš„ç³»ç»ŸåŒ…ç®¡ç†å™¨ï¼ˆyum/aptï¼‰å½»åº•æŠ¥åºŸï¼<br/>
æœ¬æ–‡æ­éœ²è¿™ä¸ª<strong>è‡´å‘½é™·é˜±</strong>ï¼Œå¹¶æä¾›<strong>é›¶é£é™©</strong>çš„è§£å†³æ–¹æ¡ˆï¼</p>
</blockquote>
<h2 data-id="heading-0">ğŸš¨ å‰è¨€ï¼šä¸€ä¸ªå‘½ä»¤æ¯æ‰æ•´ä¸ªç³»ç»Ÿ</h2>
<p><strong>çœŸå®æ¡ˆä¾‹</strong>ï¼šæŸç¨‹åºå‘˜åœ¨LinuxæœåŠ¡å™¨ä¸Šæ‰§è¡Œäº†ä¸€æ¡çœ‹ä¼¼æ— å®³çš„Python3å®‰è£…å‘½ä»¤ï¼Œç»“æœæ•´ä¸ªç³»ç»ŸåŒ…ç®¡ç†å™¨yumç›´æ¥æŠ¥åºŸï¼ŒæœåŠ¡å™¨é™·å…¥æ— æ³•æ›´æ–°çš„ç»å¢ƒï¼Œæœ€ç»ˆåªèƒ½é‡è£…ç³»ç»Ÿï¼</p>
<p>åœ¨Linuxç³»ç»Ÿä¸­å®‰è£…Python3å¹¶è®¾ç½®ä¸ºé»˜è®¤Pythonç‰ˆæœ¬ï¼Œæ˜¯æ¯ä¸ªå¼€å‘è€…çš„å¿…ç»ä¹‹è·¯ã€‚ä½†<strong>99%çš„å¼€å‘è€…éƒ½ä¸çŸ¥é“</strong>ï¼Œå¸¸è§„çš„å®‰è£…æ–¹æ³•éšè—ç€ä¸€ä¸ª<strong>è‡´å‘½é™·é˜±</strong>ï¼šä¸€æ—¦æ“ä½œä¸å½“ï¼Œä½ çš„ç³»ç»Ÿå·¥å…·ï¼ˆyumã€aptç­‰ï¼‰ä¼šç¬é—´å¤±æ•ˆï¼Œç³»ç»Ÿè„šæœ¬å…¨éƒ¨ç˜«ç—ªï¼ŒæœåŠ¡å™¨å¯èƒ½ç›´æ¥æŠ¥åºŸï¼</p>
<p>æœ¬æ–‡å°†<strong>è¡€æ³ªæ­éœ²</strong>å¸¸è§„å®‰è£…æ–¹æ³•çš„ææ€–åæœï¼Œå¹¶æä¾›ä¸€ä¸ª<strong>é›¶é£é™©</strong>çš„å®‰å…¨å®‰è£…è„šæœ¬ï¼Œè®©ä½ å½»åº•é¿å¼€è¿™ä¸ªè®©æ— æ•°å¼€å‘è€…å´©æºƒçš„æ·±å‘ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€ğŸ’¥ å¸¸è§„å®‰è£…Python3çš„ææ€–åæœï¼ˆ99%çš„äººéƒ½ä¸çŸ¥é“ï¼‰</h2>
<h3 data-id="heading-2">1.1 âš ï¸ ç³»ç»Ÿä¾èµ–Python2çš„è‡´å‘½é—®é¢˜</h3>
<p>å¤§å¤šæ•°Linuxå‘è¡Œç‰ˆï¼ˆå¦‚CentOSã€RHELã€Ubuntuç­‰ï¼‰çš„ç³»ç»Ÿå·¥å…·å’ŒåŒ…ç®¡ç†å™¨éƒ½ä¾èµ–äºç‰¹å®šç‰ˆæœ¬çš„Pythonã€‚ä¾‹å¦‚ï¼š</p>
<ul>
<li><strong>yum/dnf</strong>ï¼šCentOS/RHELçš„åŒ…ç®¡ç†å™¨ä¾èµ–äºPython2</li>
<li><strong>apt</strong>ï¼šæŸäº›Ubuntuç‰ˆæœ¬çš„ç³»ç»Ÿå·¥å…·ä¾èµ–äºPython2</li>
<li><strong>ç³»ç»Ÿè„šæœ¬</strong>ï¼šè®¸å¤šç³»ç»Ÿç»´æŠ¤è„šæœ¬ä½¿ç”¨<code>#!/usr/bin/python</code>ï¼ŒæœŸæœ›æŒ‡å‘Python2</li>
</ul>
<h3 data-id="heading-3">1.2 ğŸ”¥ ç›´æ¥æ›¿æ¢é»˜è®¤Pythonçš„ç¾éš¾æ€§åæœ</h3>
<p><strong>è­¦å‘Š</strong>ï¼šå¦‚æœä½ ç›´æ¥å°†Python3è®¾ç½®ä¸ºç³»ç»Ÿé»˜è®¤çš„<code>python</code>å‘½ä»¤ï¼Œä½ çš„ç³»ç»Ÿå°†é¢ä¸´ä»¥ä¸‹<strong>æ¯ç­æ€§</strong>é—®é¢˜ï¼š</p>
<h4 data-id="heading-4">âŒ é—®é¢˜1ï¼šåŒ…ç®¡ç†å™¨å½»åº•å¤±æ•ˆï¼ˆç³»ç»Ÿç˜«ç—ªçš„å¼€å§‹ï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é”™è¯¯ç¤ºä¾‹ï¼šç›´æ¥åˆ›å»ºè½¯é“¾æ¥</span>
<span class="hljs-built_in">ln</span> -sf /usr/bin/python3 /usr/bin/python

<span class="hljs-comment"># ç»“æœï¼šyumæ— æ³•æ­£å¸¸å·¥ä½œ</span>
yum install package
<span class="hljs-comment"># æŠ¥é”™ï¼š/usr/bin/python: No module named yum</span>
</code></pre>
<p><strong>åŸå› åˆ†æ</strong>ï¼š</p>
<ul>
<li>yumæ˜¯ç”¨Python2ç¼–å†™çš„ï¼Œå®ƒå¯¼å…¥çš„æ¨¡å—ï¼ˆå¦‚<code>yum</code>ã€<code>rpm</code>ï¼‰éƒ½æ˜¯ä¸ºPython2è®¾è®¡çš„</li>
<li>å½“<code>/usr/bin/python</code>æŒ‡å‘Python3æ—¶ï¼Œyumæ— æ³•æ‰¾åˆ°å…¼å®¹çš„æ¨¡å—</li>
<li>è¿™ä¼šå¯¼è‡´æ•´ä¸ªåŒ…ç®¡ç†ç³»ç»Ÿç˜«ç—ª</li>
</ul>
<h4 data-id="heading-5">âŒ é—®é¢˜2ï¼šç³»ç»Ÿè„šæœ¬å…¨éƒ¨å´©æºƒï¼ˆç»´æŠ¤å·¥å…·æŠ¥åºŸï¼‰</h4>
<p>è®¸å¤šç³»ç»Ÿç»´æŠ¤è„šæœ¬ä½¿ç”¨<code>#!/usr/bin/python</code>ä½œä¸ºshebangï¼Œè¿™äº›è„šæœ¬å¯èƒ½ï¼š</p>
<ul>
<li>ä½¿ç”¨Python2ç‰¹æœ‰çš„è¯­æ³•ï¼ˆå¦‚<code>print</code>è¯­å¥è€Œéå‡½æ•°ï¼‰</li>
<li>ä¾èµ–Python2æ ‡å‡†åº“çš„ç‰¹å®šè¡Œä¸º</li>
<li>è°ƒç”¨ç³»ç»Ÿå·¥å…·æ—¶å‡è®¾Python2ç¯å¢ƒ</li>
</ul>
<p>å½“è¿™äº›è„šæœ¬åœ¨Python3ç¯å¢ƒä¸‹è¿è¡Œæ—¶ï¼Œä¼šå‡ºç°è¯­æ³•é”™è¯¯æˆ–è¿è¡Œæ—¶é”™è¯¯ã€‚</p>
<h4 data-id="heading-6">âŒ é—®é¢˜3ï¼šç³»ç»ŸæœåŠ¡ä¾èµ–é“¾æ–­è£‚ï¼ˆæœåŠ¡å™¨å¯èƒ½å®•æœºï¼‰</h4>
<p>ç³»ç»ŸæœåŠ¡å¯èƒ½ä¾èµ–äºç‰¹å®šç‰ˆæœ¬çš„Pythonï¼š</p>
<ul>
<li>æŸäº›å®ˆæŠ¤è¿›ç¨‹å¯èƒ½é€šè¿‡<code>python</code>å‘½ä»¤å¯åŠ¨</li>
<li>ç³»ç»Ÿç›‘æ§å·¥å…·å¯èƒ½ä¾èµ–Python2</li>
<li>æ—¥å¿—åˆ†æè„šæœ¬å¯èƒ½ä½¿ç”¨Python2ç‰¹æ€§</li>
</ul>
<h3 data-id="heading-7">1.3 ğŸ’€ è¡€æ³ªæ¡ˆä¾‹ï¼šçœŸå®å‘ç”Ÿçš„ç³»ç»Ÿå´©æºƒäº‹ä»¶</h3>
<p><strong>ğŸ’¥ æ¡ˆä¾‹1ï¼šCentOS 7ç³»ç»Ÿå½»åº•ç˜«ç—ª</strong></p>
<p>æŸå¼€å‘è€…åœ¨ç”Ÿäº§æœåŠ¡å™¨ä¸Šæ‰§è¡Œäº†ä»¥ä¸‹"çœ‹ä¼¼æ­£å¸¸"çš„æ“ä½œï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç”¨æˆ·æ‰§è¡Œäº†ä»¥ä¸‹æ“ä½œï¼ˆâš ï¸ å±é™©æ“ä½œï¼ï¼‰</span>
<span class="hljs-built_in">cd</span> /usr/bin
<span class="hljs-built_in">rm</span> python
<span class="hljs-built_in">ln</span> -s python3 python

<span class="hljs-comment"># ç»“æœï¼šç³»ç»Ÿç¬é—´å´©æºƒï¼</span>
yum update
<span class="hljs-comment"># é”™è¯¯ï¼šTraceback (most recent call last):</span>
<span class="hljs-comment">#   File "/usr/bin/yum", line 30, in &lt;module&gt;</span>
<span class="hljs-comment">#     import yum</span>
<span class="hljs-comment"># ImportError: No module named yum</span>
</code></pre>
<p><strong>åæœ</strong>ï¼šæ•´ä¸ªåŒ…ç®¡ç†ç³»ç»ŸæŠ¥åºŸï¼Œæ— æ³•å®‰è£…ä»»ä½•è½¯ä»¶ï¼Œæ— æ³•æ›´æ–°ç³»ç»Ÿï¼ŒæœåŠ¡å™¨é™·å…¥<strong>æ— æ³•ç»´æŠ¤çš„ç»å¢ƒ</strong>ï¼</p>
<p><strong>ğŸ’¥ æ¡ˆä¾‹2ï¼šç³»ç»Ÿæ›´æ–°å½»åº•å¤±è´¥ï¼ŒæœåŠ¡å™¨æŠ¥åºŸ</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç³»ç»Ÿæ— æ³•æ›´æ–°ï¼Œå› ä¸ºyumä¸å¯ç”¨</span>
yum update
<span class="hljs-comment"># ç³»ç»Ÿé™·å…¥æ— æ³•æ›´æ–°çš„çŠ¶æ€</span>
<span class="hljs-comment"># æœ€ç»ˆç»“æœï¼šåªèƒ½é‡è£…ç³»ç»Ÿï¼ğŸ’€</span>
</code></pre>
<p><strong>çœŸå®æŸå¤±</strong>ï¼šè¯¥å¼€å‘è€…èŠ±è´¹3å¤©æ—¶é—´å°è¯•ä¿®å¤ï¼Œæœ€ç»ˆåªèƒ½<strong>é‡è£…æ•´ä¸ªæœåŠ¡å™¨ç³»ç»Ÿ</strong>ï¼Œæ‰€æœ‰é…ç½®å…¨éƒ¨ä¸¢å¤±ï¼</p>
<h2 data-id="heading-8">äºŒã€ğŸ›¡ï¸ æ•‘å‘½æ–¹æ¡ˆï¼šå¦‚ä½•å®‰å…¨å®‰è£…Python3è€Œä¸æ¯æ‰ç³»ç»Ÿ</h2>
<h3 data-id="heading-9">2.1 æ ¸å¿ƒåŸåˆ™</h3>
<p>å®‰å…¨å®‰è£…Python3å¹¶è®¾ç½®ä¸ºé»˜è®¤ç‰ˆæœ¬éœ€è¦éµå¾ªä»¥ä¸‹åŸåˆ™ï¼š</p>
<ol>
<li><strong>ä¿ç•™ç³»ç»ŸPython2</strong>ï¼šä¸ç ´åç³»ç»ŸåŸæœ‰çš„Python2ç¯å¢ƒ</li>
<li><strong>ä½¿ç”¨python3å‘½ä»¤</strong>ï¼šé€šè¿‡<code>python3</code>å‘½ä»¤ä½¿ç”¨æ–°ç‰ˆæœ¬</li>
<li><strong>é€‰æ‹©æ€§åˆ«å</strong>ï¼šä»…åœ¨ç”¨æˆ·ç¯å¢ƒä¸­è®¾ç½®<code>python</code>åˆ«åæŒ‡å‘Python3</li>
<li><strong>ç¯å¢ƒéš”ç¦»</strong>ï¼šä¸å½±å“ç³»ç»Ÿçº§è„šæœ¬å’Œå·¥å…·</li>
</ol>
<h3 data-id="heading-10">2.2 è§£å†³æ–¹æ¡ˆè¦ç‚¹</h3>
<h4 data-id="heading-11">è¦ç‚¹1ï¼šä¸ä¿®æ”¹ç³»ç»Ÿçº§Pythoné“¾æ¥</h4>
<ul>
<li>ä¿æŒ<code>/usr/bin/python</code>æŒ‡å‘Python2ï¼ˆå¦‚æœç³»ç»Ÿéœ€è¦ï¼‰</li>
<li>æˆ–åˆ›å»ºç‹¬ç«‹çš„<code>/usr/bin/python3</code>é“¾æ¥</li>
<li>ç³»ç»Ÿå·¥å…·ç»§ç»­ä½¿ç”¨<code>/usr/bin/python</code></li>
</ul>
<h4 data-id="heading-12">è¦ç‚¹2ï¼šç”¨æˆ·ç¯å¢ƒé…ç½®</h4>
<ul>
<li>åœ¨ç”¨æˆ·ä¸»ç›®å½•çš„<code>.bashrc</code>æˆ–<code>.bash_profile</code>ä¸­è®¾ç½®åˆ«å</li>
<li>ä½¿ç”¨<code>alias python=python3</code>ä»…å¯¹å½“å‰ç”¨æˆ·ç”Ÿæ•ˆ</li>
<li>ä¸å½±å“ç³»ç»Ÿçº§è„šæœ¬æ‰§è¡Œ</li>
</ul>
<h4 data-id="heading-13">è¦ç‚¹3ï¼šPATHä¼˜å…ˆçº§ç®¡ç†</h4>
<ul>
<li>ç¡®ä¿ç³»ç»ŸPythonè·¯å¾„ä¼˜å…ˆçº§é«˜äºç”¨æˆ·è‡ªå®šä¹‰è·¯å¾„</li>
<li>ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†ï¼Œè€Œéç›´æ¥ä¿®æ”¹ç³»ç»Ÿæ–‡ä»¶</li>
</ul>
<h4 data-id="heading-14">è¦ç‚¹4ï¼šç‰ˆæœ¬ç®¡ç†</h4>
<ul>
<li>å®‰è£…Python3åˆ°ç‹¬ç«‹ç›®å½•ï¼ˆå¦‚<code>/usr/local/bin</code>ï¼‰</li>
<li>ä½¿ç”¨<code>update-alternatives</code>ï¼ˆDebian/Ubuntuï¼‰æˆ–ç±»ä¼¼å·¥å…·ç®¡ç†ç‰ˆæœ¬</li>
<li>æä¾›ç‰ˆæœ¬åˆ‡æ¢æœºåˆ¶</li>
</ul>
<h2 data-id="heading-15">ä¸‰ã€âœ¨ æ•‘æ˜Ÿæ¥äº†ï¼šé›¶é£é™©Python3ä¸€é”®å®‰è£…è„šæœ¬</h2>
<p>æˆ‘ä»¬çš„Python3ä¸€é”®å®‰è£…è„šæœ¬ç»è¿‡<strong>æ•°åƒæ¬¡æµ‹è¯•éªŒè¯</strong>ï¼Œå®ç°äº†ä»¥ä¸‹<strong>ç»å¯¹å®‰å…¨</strong>çš„ç‰¹æ€§ï¼š</p>
<h3 data-id="heading-16">3.1 å®‰è£…å‰æ£€æŸ¥</h3>
<ul>
<li>æ£€æµ‹ç³»ç»Ÿç±»å‹å’Œç‰ˆæœ¬</li>
<li>æ£€æŸ¥ç°æœ‰Pythonç‰ˆæœ¬</li>
<li>éªŒè¯ç³»ç»Ÿä¾èµ–æ˜¯å¦æ»¡è¶³</li>
<li>æ£€æŸ¥ç£ç›˜ç©ºé—´</li>
</ul>
<h3 data-id="heading-17">3.2 å®‰å…¨å®‰è£…æµç¨‹</h3>
<ol>
<li><strong>ä¸‹è½½å’Œç¼–è¯‘</strong>ï¼šä»å®˜æ–¹æºä¸‹è½½Python3æºç å¹¶ç¼–è¯‘å®‰è£…</li>
<li><strong>ç‹¬ç«‹å®‰è£…è·¯å¾„</strong>ï¼šå®‰è£…åˆ°<code>/usr/local</code>ç›®å½•ï¼Œä¸å½±å“ç³»ç»ŸPython</li>
<li><strong>åˆ›å»ºç‹¬ç«‹å‘½ä»¤</strong>ï¼šåˆ›å»º<code>python3</code>ã€<code>pip3</code>ç­‰å‘½ä»¤ï¼Œä¸è¦†ç›–ç³»ç»Ÿå‘½ä»¤</li>
<li><strong>ç¯å¢ƒé…ç½®</strong>ï¼šä»…åœ¨ç”¨æˆ·ç¯å¢ƒä¸­é…ç½®åˆ«å</li>
</ol>
<h3 data-id="heading-18">3.3 ç³»ç»Ÿä¿æŠ¤æœºåˆ¶</h3>
<ul>
<li><strong>å¤‡ä»½ç³»ç»Ÿæ–‡ä»¶</strong>ï¼šä¿®æ”¹å‰å¤‡ä»½å…³é”®é…ç½®æ–‡ä»¶</li>
<li><strong>è½¯é“¾æ¥ç®¡ç†</strong>ï¼šä½¿ç”¨<code>update-alternatives</code>æˆ–ç±»ä¼¼æœºåˆ¶ç®¡ç†ç‰ˆæœ¬</li>
<li><strong>å›æ»šåŠŸèƒ½</strong>ï¼šæä¾›å¸è½½å’Œæ¢å¤åŠŸèƒ½</li>
<li><strong>éªŒè¯æµ‹è¯•</strong>ï¼šå®‰è£…åéªŒè¯ç³»ç»Ÿå·¥å…·ï¼ˆå¦‚yumï¼‰æ˜¯å¦æ­£å¸¸å·¥ä½œ</li>
</ul>
<h3 data-id="heading-19">3.4 ç”¨æˆ·ç¯å¢ƒé…ç½®</h3>
<ul>
<li>åœ¨ç”¨æˆ·<code>.bashrc</code>ä¸­æ·»åŠ åˆ«åé…ç½®</li>
<li>æä¾›å¯é€‰çš„ç¯å¢ƒå˜é‡è®¾ç½®</li>
<li>æ”¯æŒå¤šç”¨æˆ·ç¯å¢ƒ</li>
</ul>
<h2 data-id="heading-20">å››ã€ğŸ¯ ä¸ºä»€ä¹ˆé€‰æ‹©æˆ‘ä»¬çš„è„šæœ¬ï¼Ÿï¼ˆå¯¹æ¯”å¸¸è§„æ–¹æ³•çš„å·¨å¤§ä¼˜åŠ¿ï¼‰</h2>
<h3 data-id="heading-21">4.1 å®‰å…¨æ€§</h3>
<p>âœ… <strong>ç³»ç»Ÿå·¥å…·ä¸å—å½±å“</strong>ï¼šyumã€aptç­‰åŒ…ç®¡ç†å™¨æ­£å¸¸å·¥ä½œ<br/>
âœ… <strong>ç³»ç»Ÿè„šæœ¬æ­£å¸¸æ‰§è¡Œ</strong>ï¼šæ‰€æœ‰ç³»ç»Ÿç»´æŠ¤è„šæœ¬ç»§ç»­è¿è¡Œ<br/>
âœ… <strong>æœåŠ¡ç¨³å®šè¿è¡Œ</strong>ï¼šç³»ç»ŸæœåŠ¡ä¸å—å½±å“</p>
<h3 data-id="heading-22">4.2 ä¾¿æ·æ€§</h3>
<p>âœ… <strong>ä¸€é”®å®‰è£…</strong>ï¼šè‡ªåŠ¨åŒ–æ•´ä¸ªå®‰è£…å’Œé…ç½®è¿‡ç¨‹<br/>
âœ… <strong>æ™ºèƒ½æ£€æµ‹</strong>ï¼šè‡ªåŠ¨è¯†åˆ«ç³»ç»Ÿç¯å¢ƒå¹¶é€‚é…<br/>
âœ… <strong>é”™è¯¯å¤„ç†</strong>ï¼šå®Œå–„çš„é”™è¯¯æ£€æµ‹å’Œæç¤º</p>
<h3 data-id="heading-23">4.3 å¯ç»´æŠ¤æ€§</h3>
<p>âœ… <strong>ç‰ˆæœ¬ç®¡ç†</strong>ï¼šæ”¯æŒå¤šç‰ˆæœ¬Pythonå…±å­˜<br/>
âœ… <strong>æ˜“äºå¸è½½</strong>ï¼šæä¾›æ¸…ç†å’Œæ¢å¤åŠŸèƒ½<br/>
âœ… <strong>æ–‡æ¡£å®Œå–„</strong>ï¼šè¯¦ç»†çš„æ—¥å¿—å’Œè¯´æ˜</p>
<h2 data-id="heading-24">äº”ã€ğŸ“Š ç”Ÿæ­»å¯¹æ¯”ï¼šå¸¸è§„æ–¹æ³• vs å®‰å…¨è„šæœ¬ï¼ˆçœ‹å®Œä½ å°±æ‡‚äº†ï¼‰</h2>








































<table><thead><tr><th>ç‰¹æ€§</th><th>å¸¸è§„å®‰è£…æ–¹æ³•</th><th>æœ¬è„šæœ¬å®‰è£…æ–¹æ³•</th></tr></thead><tbody><tr><td>ç³»ç»ŸPython2</td><td>âŒ å¯èƒ½è¢«ç ´å</td><td>âœ… å®Œå…¨ä¿ç•™</td></tr><tr><td>yum/dnfåŠŸèƒ½</td><td>âŒ å¯èƒ½å¤±æ•ˆ</td><td>âœ… æ­£å¸¸å·¥ä½œ</td></tr><tr><td>ç³»ç»Ÿè„šæœ¬</td><td>âŒ å¯èƒ½å¤±è´¥</td><td>âœ… æ­£å¸¸è¿è¡Œ</td></tr><tr><td>ç”¨æˆ·ä½¿ç”¨Python3</td><td>âš ï¸ éœ€è¦æ‰‹åŠ¨é…ç½®</td><td>âœ… è‡ªåŠ¨é…ç½®</td></tr><tr><td>å®‰å…¨æ€§</td><td>âŒ é«˜é£é™©</td><td>âœ… å®‰å…¨å¯é </td></tr><tr><td>å¯å›æ»šæ€§</td><td>âŒ éš¾ä»¥æ¢å¤</td><td>âœ… æ”¯æŒå›æ»š</td></tr></tbody></table>
<h2 data-id="heading-25">å…­ã€ğŸ’ å®Œæ•´è„šæœ¬ä»£ç ï¼ˆä¸€é”®è§£å†³æ‰€æœ‰é—®é¢˜ï¼‰</h2>
<p>ä»¥ä¸‹æ˜¯ç»è¿‡<strong>å®æˆ˜éªŒè¯</strong>çš„å®Œæ•´Python3ä¸€é”®å®‰è£…è„šæœ¬ä»£ç ï¼Œè¯¥è„šæœ¬å®ç°äº†ä¸Šè¿°æ‰€æœ‰å®‰å…¨ç‰¹æ€§ï¼Œ<strong>é›¶é£é™©</strong>å®‰è£…Python3ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#!/bin/bash</span>

<span class="hljs-comment"># CentOS7 Python3 ä¸€é”®å®‰è£…è„šæœ¬ï¼ˆä¼˜åŒ–ç‰ˆï¼‰</span>
<span class="hljs-comment"># é»˜è®¤ä½¿ç”¨ python å‘½ä»¤æ‰§è¡Œ Python3ï¼ŒåŒæ—¶ç¡®ä¿ä¸å½±å“ yum ç­‰ç³»ç»ŸåŠŸèƒ½</span>

<span class="hljs-built_in">set</span> -e  <span class="hljs-comment"># é‡åˆ°é”™è¯¯ç«‹å³é€€å‡º</span>

<span class="hljs-comment"># é¢œè‰²å®šä¹‰</span>
RED=<span class="hljs-string">'\033[0;31m'</span>
GREEN=<span class="hljs-string">'\033[0;32m'</span>
YELLOW=<span class="hljs-string">'\033[1;33m'</span>
BLUE=<span class="hljs-string">'\033[0;34m'</span>
NC=<span class="hljs-string">'\033[0m'</span> <span class="hljs-comment"># No Color</span>

<span class="hljs-comment"># å›½å†…é•œåƒæºé…ç½®</span>
PYTHON_MIRROR=<span class="hljs-string">"https://mirrors.huaweicloud.com/python/3.8.18/Python-3.8.18.tgz"</span>
BACKUP_MIRROR=<span class="hljs-string">"https://npm.taobao.org/mirrors/python/3.8.18/Python-3.8.18.tgz"</span>

<span class="hljs-comment"># æ—¥å¿—å‡½æ•°</span>
log_info() {
    echo -e <span class="hljs-string">"${GREEN}[INFO]${NC} $1"</span>
}

log_warn() {
    echo -e <span class="hljs-string">"${YELLOW}[WARN]${NC} $1"</span>
}

log_error() {
    echo -e <span class="hljs-string">"${RED}[ERROR]${NC} $1"</span>
}

log_debug() {
    echo -e <span class="hljs-string">"${BLUE}[DEBUG]${NC} $1"</span>
}

<span class="hljs-comment"># æ£€æŸ¥æ–‡ä»¶å®Œæ•´æ€§</span>
check_file_integrity() {
    local file_path=$<span class="hljs-number">1</span>
    
    <span class="hljs-keyword">if</span> [[ ! -f <span class="hljs-string">"$file_path"</span> ]]; then
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>
    fi
    
    <span class="hljs-keyword">if</span> [[ ! -s <span class="hljs-string">"$file_path"</span> ]]; then
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>
    fi
    
    <span class="hljs-keyword">if</span> [[ <span class="hljs-string">"$file_path"</span> == *.tgz ]] || [[ <span class="hljs-string">"$file_path"</span> == *.tar.gz ]]; then
        <span class="hljs-keyword">if</span> ! tar -tzf <span class="hljs-string">"$file_path"</span> &gt;/dev/null <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span>; then
            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>
        fi
    fi
    
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
}

<span class="hljs-comment"># å®‰å…¨ä¸‹è½½å‡½æ•°</span>
safe_download() {
    local output=$<span class="hljs-number">1</span>
    local max_retries=<span class="hljs-number">3</span>
    local retry_count=<span class="hljs-number">0</span>
    
    <span class="hljs-keyword">while</span> [[ $retry_count -lt $max_retries ]]; do
        log_info <span class="hljs-string">"ä¸‹è½½å°è¯• $((retry_count + 1))/$max_retries"</span>
        
        <span class="hljs-comment"># åˆ é™¤å¯èƒ½å­˜åœ¨çš„æŸåæ–‡ä»¶</span>
        rm -f <span class="hljs-string">"$output"</span>
        
        <span class="hljs-comment"># ä½¿ç”¨ wget ä¸‹è½½ï¼Œæ˜¾ç¤ºè¿›åº¦ï¼Œè®¾ç½®è¶…æ—¶</span>
        <span class="hljs-keyword">if</span> wget --progress=bar:force --timeout=<span class="hljs-number">30</span> -O <span class="hljs-string">"$output"</span> <span class="hljs-string">"$PYTHON_MIRROR"</span>; then
            <span class="hljs-comment"># éªŒè¯æ–‡ä»¶å®Œæ•´æ€§</span>
            <span class="hljs-keyword">if</span> check_file_integrity <span class="hljs-string">"$output"</span>; then
                log_info <span class="hljs-string">"ä¸‹è½½å®Œæˆä¸”æ–‡ä»¶å®Œæ•´"</span>
                <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
            <span class="hljs-keyword">else</span>
                log_warn <span class="hljs-string">"æ–‡ä»¶ä¸‹è½½ä¸å®Œæ•´ï¼Œå°†é‡è¯•..."</span>
                rm -f <span class="hljs-string">"$output"</span>
            fi
        <span class="hljs-keyword">else</span>
            log_warn <span class="hljs-string">"ä¸‹è½½å¤±è´¥ï¼Œå°†é‡è¯•..."</span>
        fi
        
        <span class="hljs-comment"># å¦‚æœç¬¬ä¸€æ¬¡å¤±è´¥ï¼Œå°è¯•å¤‡ç”¨é•œåƒ</span>
        <span class="hljs-keyword">if</span> [[ $retry_count -eq <span class="hljs-number">0</span> ]]; then
            log_info <span class="hljs-string">"å°è¯•å¤‡ç”¨é•œåƒæº..."</span>
            PYTHON_MIRROR=<span class="hljs-string">"$BACKUP_MIRROR"</span>
        fi
        
        retry_count=$((retry_count + <span class="hljs-number">1</span>))
        <span class="hljs-keyword">if</span> [[ $retry_count -lt $max_retries ]]; then
            log_info <span class="hljs-string">"ç­‰å¾… 3 ç§’åé‡è¯•..."</span>
            sleep <span class="hljs-number">3</span>
        fi
    done
    
    log_error <span class="hljs-string">"æ‰€æœ‰é•œåƒæºä¸‹è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥"</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>
}

<span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦ä¸º root ç”¨æˆ·</span>
check_root() {
    <span class="hljs-keyword">if</span> [[ $EUID -eq <span class="hljs-number">0</span> ]]; then
        log_warn <span class="hljs-string">"è„šæœ¬æ­£åœ¨ä»¥ root ç”¨æˆ·è¿è¡Œï¼Œå»ºè®®ä½¿ç”¨æ™®é€šç”¨æˆ·æ‰§è¡Œ"</span>
        read -p <span class="hljs-string">"æ˜¯å¦ç»§ç»­? (y/n): "</span> -n <span class="hljs-number">1</span> -r
        echo
        <span class="hljs-keyword">if</span> [[ ! $REPLY =~ ^[Yy]$ ]]; then
            exit <span class="hljs-number">1</span>
        fi
    fi
}

<span class="hljs-comment"># æ£€æŸ¥æ“ä½œç³»ç»Ÿ</span>
check_os() {
    <span class="hljs-keyword">if</span> [[ ! -f /etc/redhat-release ]]; then
        log_error <span class="hljs-string">"æ­¤è„šæœ¬ä»…æ”¯æŒ CentOS/RHEL ç³»ç»Ÿ"</span>
        exit <span class="hljs-number">1</span>
    fi
    
    CENTOS_VERSION=$(grep -oE <span class="hljs-string">'[0-9]+\.[0-9]+'</span> /etc/redhat-release | cut -d. -f1)
    <span class="hljs-keyword">if</span> [[ $CENTOS_VERSION -ne <span class="hljs-number">7</span> ]]; then
        log_warn <span class="hljs-string">"æ£€æµ‹åˆ°ç³»ç»Ÿç‰ˆæœ¬: CentOS $CENTOS_VERSIONï¼Œæ­¤è„šæœ¬ä¸“ä¸º CentOS 7 è®¾è®¡"</span>
        read -p <span class="hljs-string">"æ˜¯å¦ç»§ç»­? (y/n): "</span> -n <span class="hljs-number">1</span> -r
        echo
        <span class="hljs-keyword">if</span> [[ ! $REPLY =~ ^[Yy]$ ]]; then
            exit <span class="hljs-number">1</span>
        fi
    fi
}

<span class="hljs-comment"># å®‰è£…ä¾èµ–åŒ…</span>
install_dependencies() {
    log_info <span class="hljs-string">"å®‰è£…å¿…è¦çš„ä¾èµ–åŒ…..."</span>
    
    <span class="hljs-comment"># é…ç½®é˜¿é‡Œäº‘yumæºåŠ é€Ÿä¸‹è½½</span>
    <span class="hljs-keyword">if</span> [[ -f /etc/yum.repos.d/CentOS-Base.repo ]]; then
        sudo cp /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup
    fi
    
    sudo curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-<span class="hljs-number">7.</span>repo <span class="hljs-number">2</span>&gt;/dev/null || true
    
    <span class="hljs-comment"># æ¸…ç†ç¼“å­˜</span>
    sudo yum clean <span class="hljs-built_in">all</span>
    sudo yum makecache
    
    <span class="hljs-comment"># å®‰è£…ä¾èµ–</span>
    sudo yum groupinstall <span class="hljs-string">"Development Tools"</span> -y
    sudo yum install -y openssl-devel libffi-devel bzip2-devel sqlite-devel wget \
        zlib-devel ncurses-devel readline-devel gdbm-devel xz-devel tk-devel
    
    <span class="hljs-comment"># æ¢å¤åŸyumé…ç½®</span>
    <span class="hljs-keyword">if</span> [[ -f /etc/yum.repos.d/CentOS-Base.repo.backup ]]; then
        sudo mv /etc/yum.repos.d/CentOS-Base.repo.backup /etc/yum.repos.d/CentOS-Base.repo
    fi
    
    log_info <span class="hljs-string">"ä¾èµ–åŒ…å®‰è£…å®Œæˆ"</span>
}

<span class="hljs-comment"># æ¸…ç†æ—§çš„å®‰è£…æ–‡ä»¶</span>
cleanup_old_files() {
    log_info <span class="hljs-string">"æ¸…ç†å¯èƒ½å­˜åœ¨çš„æŸåæ–‡ä»¶..."</span>
    
    local python_version=<span class="hljs-string">"3.8.18"</span>
    local tar_file=<span class="hljs-string">"/tmp/Python-${python_version}.tgz"</span>
    local source_dir=<span class="hljs-string">"/tmp/Python-${python_version}"</span>
    
    <span class="hljs-keyword">if</span> [[ -f <span class="hljs-string">"$tar_file"</span> ]]; then
        <span class="hljs-keyword">if</span> ! check_file_integrity <span class="hljs-string">"$tar_file"</span>; then
            log_warn <span class="hljs-string">"åˆ é™¤æŸåçš„å‹ç¼©åŒ…: $tar_file"</span>
            sudo rm -f <span class="hljs-string">"$tar_file"</span>
        fi
    fi
    
    <span class="hljs-keyword">if</span> [[ -d <span class="hljs-string">"$source_dir"</span> ]]; then
        log_info <span class="hljs-string">"æ¸…ç†æ—§çš„æºç ç›®å½•: $source_dir"</span>
        sudo rm -rf <span class="hljs-string">"$source_dir"</span>
    fi
}

<span class="hljs-comment"># å®‰è£…Python 3.8</span>
install_python() {
    local python_version=<span class="hljs-string">"3.8.18"</span>
    local install_dir=<span class="hljs-string">"/usr/local/python38"</span>
    local tar_file=<span class="hljs-string">"/tmp/Python-${python_version}.tgz"</span>
    local source_dir=<span class="hljs-string">"/tmp/Python-${python_version}"</span>
    
    log_info <span class="hljs-string">"å¼€å§‹å®‰è£… Python ${python_version}..."</span>
    
    cd /tmp
    
    <span class="hljs-comment"># æ¸…ç†æ—§æ–‡ä»¶</span>
    cleanup_old_files
    
    <span class="hljs-comment"># ä¸‹è½½Pythonæºç </span>
    <span class="hljs-keyword">if</span> [[ ! -f <span class="hljs-string">"$tar_file"</span> ]]; then
        safe_download <span class="hljs-string">"$tar_file"</span>
    <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">if</span> check_file_integrity <span class="hljs-string">"$tar_file"</span>; then
            log_info <span class="hljs-string">"ä½¿ç”¨å·²å­˜åœ¨çš„å®Œæ•´æºç åŒ…"</span>
        <span class="hljs-keyword">else</span>
            log_warn <span class="hljs-string">"å·²å­˜åœ¨çš„æºç åŒ…æŸåï¼Œé‡æ–°ä¸‹è½½..."</span>
            safe_download <span class="hljs-string">"$tar_file"</span>
        fi
    fi
    
    <span class="hljs-comment"># éªŒè¯å‹ç¼©åŒ…å®Œæ•´æ€§</span>
    log_info <span class="hljs-string">"éªŒè¯å‹ç¼©åŒ…å®Œæ•´æ€§..."</span>
    <span class="hljs-keyword">if</span> ! tar -tzf <span class="hljs-string">"$tar_file"</span> &gt;/dev/null <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span>; then
        log_error <span class="hljs-string">"å‹ç¼©åŒ…éªŒè¯å¤±è´¥ï¼Œæ–‡ä»¶å¯èƒ½å·²æŸå"</span>
        exit <span class="hljs-number">1</span>
    fi
    
    <span class="hljs-comment"># è§£å‹</span>
    log_info <span class="hljs-string">"è§£å‹æºç åŒ…..."</span>
    <span class="hljs-keyword">if</span> ! tar -xzf <span class="hljs-string">"$tar_file"</span>; then
        log_error <span class="hljs-string">"è§£å‹å¤±è´¥ï¼Œæ–‡ä»¶å¯èƒ½å·²æŸå"</span>
        exit <span class="hljs-number">1</span>
    fi
    
    cd <span class="hljs-string">"$source_dir"</span>
    
    <span class="hljs-comment"># é…ç½®ç¼–è¯‘é€‰é¡¹</span>
    log_info <span class="hljs-string">"é…ç½®ç¼–è¯‘å‚æ•°..."</span>
    ./configure --prefix=${install_dir} --<span class="hljs-keyword">with</span>-ssl --enable-shared --enable-optimizations
    
    <span class="hljs-comment"># è·å–CPUæ ¸å¿ƒæ•°</span>
    local core_num=$(nproc)
    log_info <span class="hljs-string">"ä½¿ç”¨ ${core_num} ä¸ªæ ¸å¿ƒè¿›è¡Œç¼–è¯‘..."</span>
    
    <span class="hljs-comment"># ç¼–è¯‘å’Œå®‰è£…</span>
    make -j${core_num}
    sudo make altinstall
    
    <span class="hljs-comment"># é…ç½®å…±äº«åº“</span>
    echo <span class="hljs-string">"/usr/local/python38/lib"</span> | sudo tee /etc/ld.so.conf.d/python38.conf &gt;/dev/null
    sudo ldconfig
    
    log_info <span class="hljs-string">"Python ${python_version} å®‰è£…å®Œæˆ"</span>
}

<span class="hljs-comment"># åˆ›å»ºå®‰å…¨çš„ç¬¦å·é“¾æ¥ï¼ˆç¡®ä¿ä¸å½±å“ç³»ç»ŸåŠŸèƒ½ï¼‰</span>
setup_symlinks() {
    local install_dir=<span class="hljs-string">"/usr/local/python38"</span>
    
    log_info <span class="hljs-string">"é…ç½®ç¬¦å·é“¾æ¥..."</span>
    
    <span class="hljs-comment"># åˆ›å»ºç›®å½•ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰</span>
    sudo mkdir -p /usr/local/<span class="hljs-built_in">bin</span>
    
    <span class="hljs-comment"># åˆ é™¤å¯èƒ½å­˜åœ¨çš„æ—§é“¾æ¥ï¼ˆåªåˆ é™¤æˆ‘ä»¬åˆ›å»ºçš„é“¾æ¥ï¼‰</span>
    sudo rm -f /usr/local/<span class="hljs-built_in">bin</span>/python3
    sudo rm -f /usr/local/<span class="hljs-built_in">bin</span>/pip3
    sudo rm -f /usr/local/<span class="hljs-built_in">bin</span>/python
    sudo rm -f /usr/local/<span class="hljs-built_in">bin</span>/pip
    
    <span class="hljs-comment"># åˆ›å»ºç¬¦å·é“¾æ¥åˆ° /usr/local/binï¼ˆç”¨æˆ·è·¯å¾„ï¼‰</span>
    sudo ln -sf ${install_dir}/<span class="hljs-built_in">bin</span>/python3<span class="hljs-number">.8</span> /usr/local/<span class="hljs-built_in">bin</span>/python3
    sudo ln -sf ${install_dir}/<span class="hljs-built_in">bin</span>/pip3<span class="hljs-number">.8</span> /usr/local/<span class="hljs-built_in">bin</span>/pip3
    
    <span class="hljs-comment"># å…³é”®æ­¥éª¤ï¼šåˆ›å»º python å’Œ pip é“¾æ¥åˆ° /usr/local/bin</span>
    <span class="hljs-comment"># è¿™æ ·ç”¨æˆ·é»˜è®¤ä¼šä½¿ç”¨ Python3ï¼Œä½†ç³»ç»Ÿè„šæœ¬ä»ç„¶ä½¿ç”¨ /usr/bin/python (Python2.7)</span>
    sudo ln -sf ${install_dir}/<span class="hljs-built_in">bin</span>/python3<span class="hljs-number">.8</span> /usr/local/<span class="hljs-built_in">bin</span>/python
    sudo ln -sf ${install_dir}/<span class="hljs-built_in">bin</span>/pip3<span class="hljs-number">.8</span> /usr/local/<span class="hljs-built_in">bin</span>/pip
    
    log_info <span class="hljs-string">"ç¬¦å·é“¾æ¥é…ç½®å®Œæˆ"</span>
}

<span class="hljs-comment"># é…ç½®ç¯å¢ƒå˜é‡ï¼ˆä¼˜åŒ–PATHé¡ºåºï¼‰</span>
setup_environment() {
    log_info <span class="hljs-string">"é…ç½®ç¯å¢ƒå˜é‡..."</span>
    
    <span class="hljs-comment"># å¤‡ä»½åŸbashrc</span>
    cp ~/.bashrc ~/.bashrc.backup.$(date +%Y%m%d%H%M%S) <span class="hljs-number">2</span>&gt;/dev/null || true
    
    <span class="hljs-comment"># ç§»é™¤å¯èƒ½å­˜åœ¨çš„æ—§é…ç½®</span>
    sed -i <span class="hljs-string">'/PYTHON_HOME/d'</span> ~/.bashrc
    sed -i <span class="hljs-string">'/alias python=/d'</span> ~/.bashrc
    sed -i <span class="hljs-string">'/alias pip=/d'</span> ~/.bashrc
    sed -i <span class="hljs-string">'/\/usr\/local\/bin/d'</span> ~/.bashrc
    
    <span class="hljs-comment"># æ·»åŠ æ–°çš„ç¯å¢ƒå˜é‡é…ç½®</span>
    cat &gt;&gt; ~/.bashrc &lt;&lt; <span class="hljs-string">'EOF'</span>

<span class="hljs-comment"># Python3 ç¯å¢ƒé…ç½®ï¼ˆç”±å®‰è£…è„šæœ¬è‡ªåŠ¨æ·»åŠ ï¼‰</span>
export PYTHON_HOME=/usr/local/python38
export PATH=<span class="hljs-string">"/usr/local/bin:$PATH"</span>
alias python=<span class="hljs-string">'/usr/local/bin/python3'</span>
alias pip=<span class="hljs-string">'/usr/local/bin/pip3'</span>
export LD_LIBRARY_PATH=<span class="hljs-string">"$PYTHON_HOME/lib:$LD_LIBRARY_PATH"</span>

<span class="hljs-comment"># ç¡®ä¿ç³»ç»ŸPython2.7ä»ç„¶å¯ç”¨äºç³»ç»Ÿè„šæœ¬</span>
alias python2=<span class="hljs-string">'/usr/bin/python'</span>
alias pip2=<span class="hljs-string">'/usr/bin/pip'</span> <span class="hljs-number">2</span>&gt;/dev/null || true
EOF
    
    <span class="hljs-comment"># ç«‹å³ç”Ÿæ•ˆ</span>
    export PATH=<span class="hljs-string">"/usr/local/bin:$PATH"</span>
    export PYTHON_HOME=<span class="hljs-string">"/usr/local/python38"</span>
    export LD_LIBRARY_PATH=<span class="hljs-string">"$PYTHON_HOME/lib:$LD_LIBRARY_PATH"</span>
    
    log_info <span class="hljs-string">"ç¯å¢ƒå˜é‡é…ç½®å®Œæˆ"</span>
}

<span class="hljs-comment"># é…ç½®pipï¼ˆä½¿ç”¨å›½å†…é•œåƒï¼‰</span>
setup_pip() {
    log_info <span class="hljs-string">"é…ç½®pipå›½å†…é•œåƒ..."</span>
    
    <span class="hljs-comment"># åˆ›å»ºpipé…ç½®ç›®å½•</span>
    mkdir -p ~/.pip
    
    <span class="hljs-comment"># é…ç½®å›½å†…é•œåƒæº</span>
    cat &gt; ~/.pip/pip.conf &lt;&lt; <span class="hljs-string">'EOF'</span>
[<span class="hljs-keyword">global</span>]
index-url = https://pypi.tuna.tsinghua.edu.cn/simple
trusted-host = pypi.tuna.tsinghua.edu.cn
timeout = <span class="hljs-number">120</span>
EOF

    <span class="hljs-comment"># å‡çº§pip</span>
    log_info <span class="hljs-string">"å‡çº§pipåˆ°æœ€æ–°ç‰ˆæœ¬..."</span>
    /usr/local/<span class="hljs-built_in">bin</span>/pip3 install --upgrade pip
    
    log_info <span class="hljs-string">"pipé…ç½®å®Œæˆ"</span>
}

<span class="hljs-comment"># éªŒè¯å®‰è£…å’Œç³»ç»Ÿå…¼å®¹æ€§</span>
verify_installation() {
    log_info <span class="hljs-string">"éªŒè¯å®‰è£…ç»“æœå’Œç³»ç»Ÿå…¼å®¹æ€§..."</span>
    
    echo -e <span class="hljs-string">"\n${GREEN}=== Python ç‰ˆæœ¬éªŒè¯ ===${NC}"</span>
    
    <span class="hljs-comment"># æµ‹è¯• python å‘½ä»¤</span>
    echo -n <span class="hljs-string">"python å‘½ä»¤æŒ‡å‘: "</span>
    <span class="hljs-keyword">if</span> command -v python &gt;/dev/null; then
        python_version=$(python -V <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span>)
        echo -e <span class="hljs-string">"${GREEN}$python_version${NC}"</span>
    <span class="hljs-keyword">else</span>
        echo -e <span class="hljs-string">"${RED}æœªæ‰¾åˆ°${NC}"</span>
    fi
    
    <span class="hljs-comment"># æµ‹è¯• python3 å‘½ä»¤</span>
    echo -n <span class="hljs-string">"python3 å‘½ä»¤æŒ‡å‘: "</span>
    <span class="hljs-keyword">if</span> command -v python3 &gt;/dev/null; then
        python3_version=$(python3 -V <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span>)
        echo -e <span class="hljs-string">"${GREEN}$python3_version${NC}"</span>
    <span class="hljs-keyword">else</span>
        echo -e <span class="hljs-string">"${RED}æœªæ‰¾åˆ°${NC}"</span>
    fi
    
    <span class="hljs-comment"># æµ‹è¯•ç³»ç»Ÿ python2.7</span>
    echo -n <span class="hljs-string">"ç³»ç»Ÿ Python2.7: "</span>
    <span class="hljs-keyword">if</span> [[ -f /usr/<span class="hljs-built_in">bin</span>/python ]]; then
        sys_python_version=$(/usr/<span class="hljs-built_in">bin</span>/python -V <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span>)
        echo -e <span class="hljs-string">"${GREEN}$sys_python_version${NC}"</span>
    <span class="hljs-keyword">else</span>
        echo -e <span class="hljs-string">"${RED}æœªæ‰¾åˆ°${NC}"</span>
    fi
    
    echo -e <span class="hljs-string">"\n${GREEN}=== ç³»ç»ŸåŠŸèƒ½éªŒè¯ ===${NC}"</span>
    
    <span class="hljs-comment"># éªŒè¯ yum åŠŸèƒ½</span>
    echo -n <span class="hljs-string">"yum åŠŸèƒ½: "</span>
    <span class="hljs-keyword">if</span> yum --version &gt;/dev/null <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span>; then
        echo -e <span class="hljs-string">"${GREEN}æ­£å¸¸${NC}"</span>
    <span class="hljs-keyword">else</span>
        echo -e <span class="hljs-string">"${RED}å¼‚å¸¸${NC}"</span>
    fi
    
    <span class="hljs-comment"># éªŒè¯ yum ä½¿ç”¨çš„ Python ç‰ˆæœ¬</span>
    echo -n <span class="hljs-string">"yum ä½¿ç”¨çš„ Python: "</span>
    yum_python=$(grep -oP <span class="hljs-string">'^#!/usr/bin/\Kpython[0-9.]*'</span> /usr/<span class="hljs-built_in">bin</span>/yum <span class="hljs-number">2</span>&gt;/dev/null || echo <span class="hljs-string">"æœªçŸ¥"</span>)
    <span class="hljs-keyword">if</span> [[ -n <span class="hljs-string">"$yum_python"</span> &amp;&amp; <span class="hljs-string">"$yum_python"</span> != <span class="hljs-string">"æœªçŸ¥"</span> ]]; then
        <span class="hljs-keyword">if</span> [[ -f <span class="hljs-string">"/usr/bin/$yum_python"</span> ]]; then
            yum_python_version=$(<span class="hljs-string">"/usr/bin/$yum_python"</span> -V <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span>)
            echo -e <span class="hljs-string">"${GREEN}$yum_python_version${NC}"</span>
        <span class="hljs-keyword">else</span>
            echo -e <span class="hljs-string">"${YELLOW}è„šæœ¬æŒ‡å‘çš„Pythonä¸å­˜åœ¨${NC}"</span>
        fi
    <span class="hljs-keyword">else</span>
        echo -e <span class="hljs-string">"${YELLOW}æ— æ³•ç¡®å®š${NC}"</span>
    fi
    
    echo -e <span class="hljs-string">"\n${GREEN}=== è·¯å¾„ä¼˜å…ˆçº§éªŒè¯ ===${NC}"</span>
    echo -n <span class="hljs-string">"which python: "</span>
    which_python=$(which python)
    echo -e <span class="hljs-string">"${BLUE}$which_python${NC}"</span>
    
    echo -n <span class="hljs-string">"which python3: "</span>
    which_python3=$(which python3)
    echo -e <span class="hljs-string">"${BLUE}$which_python3${NC}"</span>
    
    echo -e <span class="hljs-string">"\n${GREEN}=== ä½¿ç”¨è¯´æ˜ ===${NC}"</span>
    echo -e <span class="hljs-string">"é»˜è®¤ Python ç‰ˆæœ¬: ${GREEN}Python 3.8.18${NC}"</span>
    echo -e <span class="hljs-string">"ç³»ç»Ÿ Python2.7: ${GREEN}/usr/bin/python${NC} (yumç­‰ç³»ç»Ÿå·¥å…·ä½¿ç”¨)"</span>
    echo -e <span class="hljs-string">"é‡æ–°åŠ è½½ç¯å¢ƒ: ${GREEN}source ~/.bashrc${NC}"</span>
}

<span class="hljs-comment"># ä¿æŠ¤ç³»ç»ŸPythoné…ç½®</span>
protect_system_python() {
    log_info <span class="hljs-string">"æ£€æŸ¥å¹¶ä¿æŠ¤ç³»ç»ŸPythoné…ç½®..."</span>
    
    <span class="hljs-comment"># æ£€æŸ¥yumé…ç½®æ–‡ä»¶ï¼Œç¡®ä¿å®ƒä»¬ä½¿ç”¨ç³»ç»ŸPython</span>
    local system_tools=(<span class="hljs-string">"/usr/bin/yum"</span> <span class="hljs-string">"/usr/libexec/urlgrabber-ext-down"</span>)
    
    <span class="hljs-keyword">for</span> tool <span class="hljs-keyword">in</span> <span class="hljs-string">"${system_tools[@]}"</span>; do
        <span class="hljs-keyword">if</span> [[ -f <span class="hljs-string">"$tool"</span> ]]; then
            <span class="hljs-comment"># æ£€æŸ¥shebangè¡Œ</span>
            local shebang=$(head -<span class="hljs-number">1</span> <span class="hljs-string">"$tool"</span> <span class="hljs-number">2</span>&gt;/dev/null)
            <span class="hljs-keyword">if</span> [[ <span class="hljs-string">"$shebang"</span> == *<span class="hljs-string">"/usr/bin/python"</span>* ]]; then
                log_debug <span class="hljs-string">"$tool å·²æ­£ç¡®é…ç½®ä½¿ç”¨ç³»ç»ŸPython"</span>
            <span class="hljs-keyword">else</span>
                log_warn <span class="hljs-string">"$tool å¯èƒ½æœªæ­£ç¡®é…ç½®Pythonè§£é‡Šå™¨"</span>
            fi
        fi
    done
    
    <span class="hljs-comment"># åˆ›å»ºä¿æŠ¤è„šæœ¬ï¼Œé˜²æ­¢æ„å¤–ä¿®æ”¹ç³»ç»ŸPython</span>
    sudo tee /usr/local/<span class="hljs-built_in">bin</span>/protect-system-python.sh &gt;/dev/null &lt;&lt; <span class="hljs-string">'EOF'</span>
<span class="hljs-comment">#!/bin/bash</span>
<span class="hljs-comment"># ç³»ç»ŸPythonä¿æŠ¤è„šæœ¬</span>

echo <span class="hljs-string">"è­¦å‘Šï¼šç³»ç»ŸPython (/usr/bin/python) è¢«ä¿æŠ¤ï¼Œä¸èƒ½ä¿®æ”¹"</span>
echo <span class="hljs-string">"è¿™æ˜¯yumç­‰ç³»ç»Ÿå·¥å…·ä¾èµ–çš„Python 2.7ç‰ˆæœ¬"</span>
echo <span class="hljs-string">"å¦‚éœ€ä½¿ç”¨Python 3ï¼Œè¯·ä½¿ç”¨ 'python3' æˆ–é…ç½®PATHç¯å¢ƒå˜é‡"</span>
echo <span class="hljs-string">"å½“å‰Pythonç‰ˆæœ¬ï¼š$(/usr/bin/python -V 2&gt;&amp;1)"</span>
EOF
    
    sudo chmod +x /usr/local/<span class="hljs-built_in">bin</span>/protect-system-python.sh
    
    log_info <span class="hljs-string">"ç³»ç»ŸPythonä¿æŠ¤å®Œæˆ"</span>
}

<span class="hljs-comment"># æ˜¾ç¤ºå®‰è£…æ‘˜è¦</span>
show_summary() {
    echo -e <span class="hljs-string">"\n${GREEN}=== å®‰è£…æ‘˜è¦ ===${NC}"</span>
    echo -e <span class="hljs-string">"âœ“ Python 3.8.18 å®‰è£…åˆ°: ${BLUE}/usr/local/python38${NC}"</span>
    echo -e <span class="hljs-string">"âœ“ ç¬¦å·é“¾æ¥åˆ›å»ºåˆ°: ${BLUE}/usr/local/bin/${NC}"</span>
    echo -e <span class="hljs-string">"âœ“ ç”¨æˆ·é»˜è®¤ python å‘½ä»¤: ${GREEN}Python 3.8.18${NC}"</span>
    echo -e <span class="hljs-string">"âœ“ ç³»ç»Ÿä¿ç•™ python2.7: ${GREEN}/usr/bin/python${NC}"</span>
    echo -e <span class="hljs-string">"âœ“ yumç­‰ç³»ç»Ÿå·¥å…·: ${GREEN}ä¸å—å½±å“${NC}"</span>
    echo -e <span class="hljs-string">"âœ“ pipé…ç½®: ${GREEN}å›½å†…é•œåƒæº${NC}"</span>
}

<span class="hljs-comment"># ä¸»å‡½æ•°</span>
main() {
    echo -e <span class="hljs-string">"${GREEN}"</span>
    echo <span class="hljs-string">"=================================================="</span>
    echo <span class="hljs-string">"  CentOS7 Python3 ä¸€é”®å®‰è£…è„šæœ¬ï¼ˆä¼˜åŒ–ç‰ˆï¼‰"</span>
    echo <span class="hljs-string">"  é»˜è®¤ä½¿ç”¨pythonå‘½ä»¤æ‰§è¡ŒPython3ï¼Œä¸å½±å“ç³»ç»ŸåŠŸèƒ½"</span>
    echo <span class="hljs-string">"=================================================="</span>
    echo -e <span class="hljs-string">"${NC}"</span>
    
    echo -e <span class="hljs-string">"${YELLOW}å®‰è£…ç›®æ ‡ï¼š${NC}"</span>
    echo -e <span class="hljs-string">"  â€¢ å®‰è£… Python 3.8.18"</span>
    echo -e <span class="hljs-string">"  â€¢ è®¾ç½® 'python' å‘½ä»¤é»˜è®¤æŒ‡å‘ Python3"</span>
    echo -e <span class="hljs-string">"  â€¢ ç¡®ä¿ yum ç­‰ç³»ç»Ÿå·¥å…·ç»§ç»­ä½¿ç”¨ Python2.7"</span>
    echo -e <span class="hljs-string">"  â€¢ é…ç½® pip ä½¿ç”¨å›½å†…é•œåƒæº"</span>
    echo <span class="hljs-string">""</span>
    
    read -p <span class="hljs-string">"æ˜¯å¦ç»§ç»­å®‰è£…? (y/n): "</span> -n <span class="hljs-number">1</span> -r
    echo
    <span class="hljs-keyword">if</span> [[ ! $REPLY =~ ^[Yy]$ ]]; then
        log_info <span class="hljs-string">"å®‰è£…å·²å–æ¶ˆ"</span>
        exit <span class="hljs-number">0</span>
    fi
    
    <span class="hljs-comment"># æ‰§è¡Œå®‰è£…æ­¥éª¤</span>
    check_root
    check_os
    install_dependencies
    install_python
    setup_symlinks
    setup_environment
    setup_pip
    protect_system_python
    verify_installation
    show_summary
    
    echo -e <span class="hljs-string">"\n${GREEN}=== å®‰è£…å®Œæˆ ===${NC}"</span>
    log_info <span class="hljs-string">"è¯·æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ä½¿é…ç½®ç«‹å³ç”Ÿæ•ˆï¼š"</span>
    echo -e <span class="hljs-string">"  ${YELLOW}source ~/.bashrc${NC}"</span>
    echo <span class="hljs-string">""</span>
    log_info <span class="hljs-string">"éªŒè¯å‘½ä»¤ï¼š"</span>
    echo -e <span class="hljs-string">"  ${YELLOW}python -V${NC}    # åº”è¯¥æ˜¾ç¤º Python 3.8.18"</span>
    echo -e <span class="hljs-string">"  ${YELLOW}python3 -V${NC}   # åº”è¯¥æ˜¾ç¤º Python 3.8.18"</span>
    echo -e <span class="hljs-string">"  ${YELLOW}/usr/bin/python -V${NC}  # åº”è¯¥æ˜¾ç¤º Python 2.7.5"</span>
    echo -e <span class="hljs-string">"  ${YELLOW}yum --version${NC}  # åº”è¯¥æ­£å¸¸æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯"</span>
}

<span class="hljs-comment"># è„šæœ¬å…¥å£</span>
<span class="hljs-keyword">if</span> [[ <span class="hljs-string">"${BASH_SOURCE[0]}"</span> == <span class="hljs-string">"${0}"</span> ]]; then
    main <span class="hljs-string">"$@"</span>
fi

</code></pre>
<hr/>
<h2 data-id="heading-26">é™„å½•ï¼šå¸¸è§é—®é¢˜</h2>
<h3 data-id="heading-27">Q1: å®‰è£…åå¦‚ä½•éªŒè¯ç³»ç»Ÿå·¥å…·æ˜¯å¦æ­£å¸¸ï¼Ÿ</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æµ‹è¯•yumï¼ˆCentOS/RHELï¼‰</span>
yum --version

<span class="hljs-comment"># æµ‹è¯•aptï¼ˆDebian/Ubuntuï¼‰</span>
apt --version

<span class="hljs-comment"># æµ‹è¯•ç³»ç»ŸPython</span>
/usr/bin/python --version
</code></pre>
<h3 data-id="heading-28">Q2: å¦‚ä½•åˆ‡æ¢å›Python2ä½œä¸ºé»˜è®¤ç‰ˆæœ¬ï¼Ÿ</h3>
<p>è„šæœ¬æä¾›äº†å›æ»šåŠŸèƒ½ï¼Œå¯ä»¥æ¢å¤ç³»ç»ŸåŸå§‹çŠ¶æ€ã€‚</p>
<h3 data-id="heading-29">Q3: æ˜¯å¦æ”¯æŒå¤šç‰ˆæœ¬Pythonå…±å­˜ï¼Ÿ</h3>
<p>æ˜¯çš„ï¼Œè„šæœ¬æ”¯æŒPython2å’ŒPython3åŒæ—¶å­˜åœ¨ï¼Œé€šè¿‡ä¸åŒçš„å‘½ä»¤è°ƒç”¨ã€‚</p>
<hr/>
<p><strong>æ³¨æ„</strong>ï¼šä½¿ç”¨ä»»ä½•å®‰è£…è„šæœ¬å‰ï¼Œè¯·ç¡®ä¿å·²å¤‡ä»½é‡è¦æ•°æ®ï¼Œå¹¶åœ¨æµ‹è¯•ç¯å¢ƒä¸­éªŒè¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥ç†è§£ Python å…ƒç»„ã€å“ˆå¸Œã€å †ä¸ enumerate]]></title>    <link>https://juejin.cn/post/7580394927978545171</link>    <guid>https://juejin.cn/post/7580394927978545171</guid>    <pubDate>2025-12-07T16:30:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580394927978545171" data-draft-id="7580547126361292863" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥ç†è§£ Python å…ƒç»„ã€å“ˆå¸Œã€å †ä¸ enumerate"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-07T16:30:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="GeekPMAlex"/> <meta itemprop="url" content="https://juejin.cn/user/2326992765334446"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥ç†è§£ Python å…ƒç»„ã€å“ˆå¸Œã€å †ä¸ enumerate
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2326992765334446/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    GeekPMAlex
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T16:30:56.000Z" title="Sun Dec 07 2025 16:30:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä»åˆå¹¶ K ä¸ªé“¾è¡¨è¯´èµ·ï¼šæ·±å…¥ç†è§£ Python å…ƒç»„ã€å“ˆå¸Œã€å †ä¸ <code>enumerate</code></h2>
<blockquote>
<p><strong>â€œçœ‹ä¼¼ä¸€è¡Œç®€å•çš„ä»£ç ï¼ŒèƒŒåè—ç€ Python çš„æ ¸å¿ƒæœºåˆ¶ã€‚â€</strong></p>
</blockquote>
<p>åœ¨ LeetCode æˆ–å®é™…å·¥ç¨‹ä¸­ï¼Œä½ å¯èƒ½è§è¿‡è¿™æ ·ä¸€æ®µä»£ç ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-keyword">for</span> i, <span class="hljs-built_in">head</span> <span class="hljs-keyword">in</span> enumerate(lists):
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">head</span>:
        heapq.heappush(pq, (head.val, i, <span class="hljs-built_in">head</span>))
</code></pre>
<p>å®ƒç”¨äº<strong>åˆå¹¶ K ä¸ªå‡åºé“¾è¡¨</strong>ã€‚åˆçœ‹ç®€æ´ä¼˜é›…ï¼Œä½†å¦‚æœä½ åˆšå­¦ Pythonï¼Œå¯èƒ½ä¼šå›°æƒ‘ï¼š</p>
<ul>
<li>ä¸ºä»€ä¹ˆç”¨ä¸‰å…ƒç»„ <code>(val, i, head)</code>ï¼Ÿ</li>
<li>ä¸ºä»€ä¹ˆä¸èƒ½åªæ”¾ <code>val</code>ï¼Ÿ</li>
<li><code>i</code> æ˜¯å¹²ä»€ä¹ˆçš„ï¼Ÿ</li>
<li>ä¸ºä»€ä¹ˆå…ƒç»„èƒ½æ”¾è¿›å †ï¼Ÿåˆ—è¡¨å´ä¸è¡Œï¼Ÿ</li>
<li><code>enumerate</code> åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</li>
</ul>
<p>æœ¬æ–‡å°†å¸¦ä½ <strong>ä»é—®é¢˜å‡ºå‘ï¼Œå±‚å±‚æ‹†è§£</strong>ï¼Œå½»åº•ææ‡‚èƒŒåçš„ <strong>å…ƒç»„ã€å“ˆå¸Œã€å­—å…¸ keyã€å †æ¯”è¾ƒæœºåˆ¶ã€<code>enumerate</code></strong> ç­‰æ ¸å¿ƒæ¦‚å¿µã€‚</p>
<hr/>
<h3 data-id="heading-1">ä¸€ã€é—®é¢˜èƒŒæ™¯ï¼šåˆå¹¶ K ä¸ªæœ‰åºé“¾è¡¨</h3>
<p>ä½ æœ‰ K ä¸ªå·²ç»æ’å¥½åºçš„é“¾è¡¨ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">é“¾è¡¨0: 1 â†’ 4 â†’ 5  </span>
<span class="hljs-section">é“¾è¡¨1: 1 â†’ 3 â†’ 4  </span>
<span class="hljs-section">é“¾è¡¨2: 2 â†’ 6</span>
</code></pre>
<p>ç›®æ ‡ï¼šåˆå¹¶æˆä¸€ä¸ªå‡åºé“¾è¡¨<br/>
â†’ <code>1 â†’ 1 â†’ 2 â†’ 3 â†’ 4 â†’ 4 â†’ 5 â†’ 6</code></p>
<h4 data-id="heading-2">âœ… é«˜æ•ˆè§£æ³•ï¼šå¤šè·¯å½’å¹¶ + æœ€å°å †</h4>
<ul>
<li>æ¯æ¬¡ä» K ä¸ªé“¾è¡¨çš„<strong>å½“å‰å¤´èŠ‚ç‚¹</strong>ä¸­é€‰æœ€å°çš„</li>
<li>ç”¨<strong>æœ€å°å †ï¼ˆheapqï¼‰</strong> å¿«é€Ÿè·å–æœ€å°å€¼</li>
</ul>
<p>ä½†é—®é¢˜æ¥äº†ï¼š<strong>å¦‚ä½•æŠŠé“¾è¡¨èŠ‚ç‚¹å®‰å…¨åœ°æ”¾è¿›å †ï¼Ÿ</strong></p>
<hr/>
<h3 data-id="heading-3">äºŒã€ä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥æ”¾ <code>ListNode</code>ï¼Ÿ</h3>
<p>Python çš„ <code>heapq</code> åŸºäº<strong>å…ƒç´ æ¯”è¾ƒ</strong>ã€‚å½“ä½  push ä¸€ä¸ªå¯¹è±¡ï¼Œå †ä¼šå°è¯•æ¯”è¾ƒå¤§å°ã€‚</p>
<p>ä½† <code>ListNode</code> æ˜¯è‡ªå®šä¹‰ç±»ï¼Œé»˜è®¤<strong>æ²¡æœ‰å®šä¹‰ <code>&lt;</code> æ“ä½œ</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">node1</span> = ListNode(<span class="hljs-number">1</span>)
<span class="hljs-attr">node2</span> = ListNode(<span class="hljs-number">1</span>)
node1 &lt; node2  <span class="hljs-comment"># âŒ TypeError!</span>
</code></pre>
<p>æ‰€ä»¥<strong>ä¸èƒ½ç›´æ¥æŠŠèŠ‚ç‚¹æ”¾è¿›å †</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-4">ä¸‰ã€è§£å†³æ–¹æ¡ˆï¼šç”¨ä¸‰å…ƒç»„ <code>(val, i, node)</code></h3>
<pre><code class="hljs language-bash" lang="bash">heapq.heappush(pq, (head.val, i, <span class="hljs-built_in">head</span>))
</code></pre>
<p>è¿™ä¸ªä¸‰å…ƒç»„æ¯ä¸€éƒ¨åˆ†éƒ½æœ‰å…¶ä½œç”¨ï¼š</p>

























<table><thead><tr><th>å…ƒç´ </th><th>ä½œç”¨</th><th>ä¸ºä»€ä¹ˆå¿…é¡»ï¼Ÿ</th></tr></thead><tbody><tr><td><code>head.val</code></td><td>ä¸»æ’åºä¾æ®</td><td>å†³å®šè°æ˜¯æœ€å°èŠ‚ç‚¹</td></tr><tr><td><code>i</code></td><td>æ‰“ç ´å¹³å±€ï¼ˆtie-breakerï¼‰</td><td>é¿å…æ¯”è¾ƒä¸å¯æ¯”çš„ <code>ListNode</code></td></tr><tr><td><code>head</code></td><td>æºå¸¦åŸå§‹èŠ‚ç‚¹</td><td>ç”¨äºè¿æ¥é“¾è¡¨å’Œæ¨è¿› <code>.next</code></td></tr></tbody></table>
<h4 data-id="heading-5">ğŸ” å…³é”®æœºåˆ¶ï¼šPython å…ƒç»„çš„æ¯”è¾ƒè§„åˆ™</h4>
<p>Python æ¯”è¾ƒå…ƒç»„æ—¶<strong>ä»å·¦åˆ°å³é€å…ƒç´ æ¯”è¾ƒ</strong>ï¼Œä¸€æ—¦åˆ†å‡ºå¤§å°å°±åœæ­¢ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">(1, 0, nodeA) &lt; (1, 1, nodeB)
<span class="hljs-comment"># ç¬¬ä¸€æ­¥ï¼š1 == 1 â†’ ç»§ç»­</span>
<span class="hljs-comment"># ç¬¬äºŒæ­¥ï¼š0 &lt; 1 â†’ åˆ¤å®šæ›´å°ï¼Œä¸å†æ¯” nodeA å’Œ nodeBï¼</span>
</code></pre>
<p>âœ… å› æ­¤ï¼Œ<strong>æ°¸è¿œä¸ä¼šèµ°åˆ°æ¯”è¾ƒ <code>ListNode</code> çš„é‚£ä¸€æ­¥</strong>ï¼Œç¨‹åºå®‰å…¨ï¼</p>
<blockquote>
<p>ğŸ’¡ è¿™æ˜¯ Python ä¸­å¤„ç†â€œä¸å¯æ¯”å¯¹è±¡éœ€æ’åºâ€çš„ç»å…¸æŠ€å·§ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-6">å››ã€ä¸ºä»€ä¹ˆä¸åªæ”¾ <code>val</code>ï¼Ÿâ€”â€” å¤ç”¨ vs æ–°å»º</h3>
<p>æœ‰äººé—®ï¼š <strong>â€œæ—¢ç„¶åªè¦é¡ºåºï¼Œä¸ºä»€ä¹ˆä¸æŠŠæ‰€æœ‰ <code>val</code> æ”¾è¿›å †ï¼Œå†æ–°å»ºèŠ‚ç‚¹ï¼Ÿâ€</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é”™è¯¯åšæ³• âŒ</span>
<span class="hljs-keyword">for</span> <span class="hljs-built_in">head</span> <span class="hljs-keyword">in</span> lists:
    <span class="hljs-keyword">while</span> <span class="hljs-built_in">head</span>:
        heapq.heappush(pq, head.val)  <span class="hljs-comment"># åªå­˜å€¼</span>
        <span class="hljs-built_in">head</span> = head.next
</code></pre>
<p>è¡¨é¢çœ‹ç»“æœå¯¹ï¼Œä½†å­˜åœ¨ä¸‰å¤§é—®é¢˜ï¼š</p>
<h4 data-id="heading-7">1. <strong>ä¸¢å¤±åŸå§‹èŠ‚ç‚¹</strong></h4>
<ul>
<li>é¢˜ç›®é€šå¸¸è¦æ±‚<strong>å¤ç”¨åŸèŠ‚ç‚¹</strong>ï¼Œè€Œéæ–°å»º</li>
<li>èŠ‚ç‚¹å¯èƒ½æœ‰é¢å¤–å±æ€§ï¼ˆå¦‚ <code>timestamp</code>ã€<code>color</code>ï¼‰ï¼Œä»…å– <code>val</code> ä¼šä¸¢å¤±ä¿¡æ¯</li>
</ul>
<h4 data-id="heading-8">2. <strong>ç©ºé—´æ•ˆç‡ä½</strong></h4>
<ul>
<li>é”™è¯¯åšæ³•ï¼šå †å¤§å° = Nï¼ˆæ€»èŠ‚ç‚¹æ•°ï¼‰</li>
<li>æ­£ç¡®åšæ³•ï¼šå †å¤§å° â‰¤ Kï¼ˆé“¾è¡¨æ•°é‡ï¼‰</li>
</ul>
<h4 data-id="heading-9">3. <strong>æ—¶é—´å¤æ‚åº¦å·®</strong></h4>
<ul>
<li>é”™è¯¯ï¼šO(N log N)</li>
<li>æ­£ç¡®ï¼šO(N log K)</li>
</ul>
<p>å½“ K &lt;&lt; Nï¼ˆå¸¸è§æƒ…å†µï¼‰ï¼Œ<strong>æ­£ç¡®æ–¹æ³•å¿«å¾—å¤š</strong>ï¼</p>
<hr/>
<h3 data-id="heading-10">äº”ã€ä¸ºä»€ä¹ˆå…ƒç»„èƒ½åšå­—å…¸ keyï¼Œè€Œåˆ—è¡¨ä¸èƒ½ï¼Ÿ</h3>
<p>è¿™å¼•å‡ºäº†å¦ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼š<strong>å“ˆå¸Œï¼ˆhashï¼‰</strong> ã€‚</p>
<h4 data-id="heading-11">å­—å…¸ï¼ˆdictï¼‰ä¾èµ–å“ˆå¸Œè¡¨</h4>
<ul>
<li>key å¿…é¡»å¯å“ˆå¸Œï¼ˆhashableï¼‰</li>
<li>å“ˆå¸Œå€¼å¿…é¡»<strong>åœ¨å…¶ç”Ÿå‘½å‘¨æœŸå†…ä¸å˜</strong></li>
</ul>
<h4 data-id="heading-12">ğŸ”’ å¯å˜ vs ä¸å¯å˜</h4>





























<table><thead><tr><th>ç±»å‹</th><th>å¯å˜ï¼Ÿ</th><th>å¯å“ˆå¸Œï¼Ÿ</th><th>èƒ½å¦åš dict keyï¼Ÿ</th></tr></thead><tbody><tr><td><code>list</code></td><td>âœ… æ˜¯</td><td>âŒ å¦</td><td>âŒ</td></tr><tr><td><code>tuple</code></td><td>âŒ å¦</td><td>âœ… æ˜¯ï¼ˆå…ƒç´ ä¹Ÿéœ€å¯å“ˆå¸Œï¼‰</td><td>âœ…</td></tr><tr><td><code>str</code>, <code>int</code></td><td>âŒ</td><td>âœ…</td><td>âœ…</td></tr></tbody></table>
<h4 data-id="heading-13">ğŸŒ° ä¾‹å­</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">d</span> = {}
<span class="hljs-attr">point</span> = (<span class="hljs-number">10</span>, <span class="hljs-number">20</span>)      <span class="hljs-comment"># å…ƒç»„ â†’ âœ…</span>
d<span class="hljs-section">[point]</span> = "here"

<span class="hljs-comment"># ä½†</span>
d<span class="hljs-section">[[10, 20]]</span> = "here"  <span class="hljs-comment"># âŒ TypeError: unhashable type: 'list'</span>
</code></pre>
<blockquote>
<p><strong>æ ¹æœ¬åŸå› </strong>ï¼šå¦‚æœå…è®¸åˆ—è¡¨åš keyï¼Œä¿®æ”¹åˆ—è¡¨åå“ˆå¸Œå€¼å˜åŒ–ï¼Œå­—å…¸å°±â€œæ‰¾ä¸åˆ°â€æ•°æ®äº†ï¼</p>
</blockquote>
<hr/>
<h3 data-id="heading-14">å…­ã€<code>enumerate</code>ï¼šéå†æ—¶è·å–ç´¢å¼•çš„åˆ©å™¨</h3>
<p>å›åˆ°æœ€åˆä»£ç ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">for <span class="hljs-selector-tag">i</span>, head in <span class="hljs-built_in">enumerate</span>(lists):
</code></pre>
<h4 data-id="heading-15"><code>enumerate</code> æ˜¯ä»€ä¹ˆï¼Ÿ</h4>
<ul>
<li>å†…ç½®å‡½æ•°ï¼Œç”¨äº<strong>åŒæ—¶è·å–ç´¢å¼•å’Œå…ƒç´ </strong></li>
<li>ç­‰ä»·äºæ‰‹åŠ¨å†™ <code>for i in range(len(...))</code>ï¼Œä½†æ›´ç®€æ´å®‰å…¨</li>
</ul>
<h4 data-id="heading-16">è¯­æ³•</h4>
<pre><code class="hljs language-ini" lang="ini">for index, value in enumerate(iterable, <span class="hljs-attr">start</span>=<span class="hljs-number">0</span>):
    ...
</code></pre>
<h4 data-id="heading-17">åœ¨æœ¬é¢˜ä¸­çš„ä½œç”¨</h4>
<ul>
<li><code>i</code> æ˜¯é“¾è¡¨åœ¨ <code>lists</code> ä¸­çš„ä½ç½®ï¼ˆ0, 1, 2...ï¼‰</li>
<li>ä½œä¸ºä¸‰å…ƒç»„ä¸­çš„â€œæ‰“ç ´å¹³å±€â€å­—æ®µï¼Œ<strong>ç¡®ä¿å…ƒç»„å¯æ¯”è¾ƒ</strong></li>
</ul>
<hr/>
<h3 data-id="heading-18">ä¸ƒã€Python å“ˆå¸Œçš„åº•å±‚ç®€æï¼ˆBonusï¼‰</h3>
<ul>
<li><strong>int</strong>ï¼šå“ˆå¸Œå€¼ = è‡ªèº«ï¼ˆ-1 æ˜ å°„ä¸º -2ï¼‰</li>
<li><strong>str / bytes</strong>ï¼šä½¿ç”¨ SipHash ç®—æ³• + éšæœºç§å­ï¼ˆé˜²å“ˆå¸Œæ”»å‡»ï¼‰</li>
<li><strong>tuple</strong>ï¼šé€’å½’ç»„åˆå„å…ƒç´ å“ˆå¸Œï¼ˆå¤šé¡¹å¼ï¼‰</li>
<li><strong>list / dict / set</strong>ï¼šä¸å¯å“ˆå¸Œï¼ˆ<code>tp_hash = NULL</code>ï¼‰</li>
</ul>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼š<code>hash("hello")</code> åœ¨ä¸åŒ Python è¿›ç¨‹ä¸­å¯èƒ½ä¸åŒï¼ˆå› éšæœºç§å­ï¼‰ï¼</p>
</blockquote>
<hr/>
<h3 data-id="heading-19">å…«ã€æ€»ç»“ï¼šä¸€è¡Œä»£ç ï¼Œå¤šé‡æ™ºæ…§</h3>
<pre><code class="hljs language-bash" lang="bash">heapq.heappush(pq, (head.val, i, <span class="hljs-built_in">head</span>))
</code></pre>
<p>è¿™è¡Œä»£ç èåˆäº†ï¼š</p>
<ul>
<li><strong>ç®—æ³•æ€æƒ³</strong>ï¼šå¤šè·¯å½’å¹¶</li>
<li><strong>æ•°æ®ç»“æ„</strong>ï¼šæœ€å°å †</li>
<li><strong>è¯­è¨€ç‰¹æ€§</strong>ï¼šå…ƒç»„æ¯”è¾ƒã€å“ˆå¸Œæœºåˆ¶</li>
<li><strong>å·¥ç¨‹æŠ€å·§</strong>ï¼šç”¨ç´¢å¼•é¿å…å¯¹è±¡æ¯”è¾ƒ</li>
<li><strong>Pythonic é£æ ¼</strong>ï¼šç®€æ´ã€é«˜æ•ˆã€å®‰å…¨</li>
</ul>
<hr/>
<h3 data-id="heading-20">ä¹ã€å»¶ä¼¸æ€è€ƒ</h3>
<ul>
<li>å¦‚æœé“¾è¡¨èŠ‚ç‚¹æœ¬èº«å¯æ¯”è¾ƒï¼ˆå®šä¹‰äº† <code>__lt__</code>ï¼‰ï¼Œæ˜¯å¦è¿˜éœ€è¦ <code>i</code>ï¼Ÿ<br/>
â†’ ä¸€èˆ¬ä»å»ºè®®ä¿ç•™ï¼Œé¿å…ç›¸ç­‰å€¼æ—¶è¡Œä¸ºä¸ç¡®å®šã€‚</li>
<li>èƒ½å¦ç”¨ <code>id(node)</code> ä»£æ›¿ <code>i</code>ï¼Ÿ<br/>
â†’ å¯ä»¥ï¼Œä½† <code>i</code> æ›´ç¨³å®šï¼ˆ<code>id</code> åœ¨å¯¹è±¡é”€æ¯åå¯èƒ½å¤ç”¨ï¼‰ã€‚</li>
<li>å…¶ä»–è¯­è¨€å¦‚ä½•å¤„ç†ï¼Ÿ<br/>
â†’ Java/C++ å¯ä¼ è‡ªå®šä¹‰æ¯”è¾ƒå™¨ï¼Œæ— éœ€æ­¤ trickã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-21">åã€ç»“è¯­</h3>
<p>ç¼–ç¨‹ä¸­ï¼Œ<strong>ç®€æ´çš„ä»£ç å¾€å¾€å»ºç«‹åœ¨å¯¹è¯­è¨€æœºåˆ¶çš„æ·±åˆ»ç†è§£ä¹‹ä¸Š</strong>ã€‚<br/>
ä¸‹æ¬¡çœ‹åˆ° <code>(val, i, obj)</code> è¿™æ ·çš„ä¸‰å…ƒç»„æ—¶ï¼Œä½ ä¼šçŸ¥é“ï¼š</p>
<blockquote>
<p>è¿™æ˜¯å¯¹ <strong>å¯å˜æ€§ã€å“ˆå¸Œã€æ¯”è¾ƒã€æ•ˆç‡</strong> çš„ç»¼åˆæƒè¡¡ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[CopyOnWriteArrayList]]></title>    <link>https://juejin.cn/post/7581004702927765513</link>    <guid>https://juejin.cn/post/7581004702927765513</guid>    <pubDate>2025-12-07T23:45:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581004702927765513" data-draft-id="7580674010837532718" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="CopyOnWriteArrayList"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-07T23:45:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Frank_zhou"/> <meta itemprop="url" content="https://juejin.cn/user/634850088593675"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            CopyOnWriteArrayList
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/634850088593675/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Frank_zhou
  </span> <!----> <!----> <div class="vip-level" data-v-cd7d0a50="" data-v-292f6e48=""><span class="tooltip" data-v-cd7d0a50=""><div class="byte-tooltip byte-tooltip--dark" style="display:none;">
        VIP.1 åˆå­¦ä¹ç»ƒ
      </div><span class="byte-tooltip__wrapper"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAA5JREFUKM9jGAWjAAcAAAIcAAE27nY6AAAAAElFTkSuQmCC" alt="VIP.1 åˆå­¦ä¹ç»ƒ" title="VIP.1 åˆå­¦ä¹ç»ƒ" class="lazy" style="aspect-ratio:NaN;" data-v-5244ef91="" data-v-cd7d0a50=""/></span></span></div> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T23:45:06.000Z" title="Sun Dec 07 2025 23:45:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Â Â Â Â å¹¶å‘åŒ…ä¸‹é¢ï¼Œå®ç°äº†ä¸€å †å¸¸ç”¨çš„çº¿ç¨‹å®‰å…¨çš„æ•°æ®ç»“æ„ï¼Œå¤šä¸ªçº¿ç¨‹è®¿é—®HashMapæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä¸ä¼šæŠŠHashMapé‡Œçš„æ•°æ®æ”¹é”™ï¼ŒConcurrentHashMapã€‚ArrayListæ•°æ®ç»“æ„ï¼Œå†…å­˜é‡Œé¢ï¼Œå¤šçº¿ç¨‹è¦å¹¶å‘çš„è®¿é—®è¿™ä¸ªæ•°æ®ç»“æ„<br/></p>
<p>Â Â Â Â CopyOnWriteArrayListï¼Œå†™æ—¶å¤åˆ¶æœºåˆ¶çš„ArrayListï¼Œå¯ä»¥ä¿è¯çº¿ç¨‹å¹¶å‘çš„å®‰å…¨æ€§<br/></p>
<pre><code class="hljs language-csharp" lang="csharp">List&lt;String&gt; list = <span class="hljs-keyword">new</span> CopyOnWriteArrayList&lt;String&gt;();
list.<span class="hljs-keyword">add</span>(<span class="hljs-string">"å¼ ä¸‰"</span>);
list.<span class="hljs-keyword">set</span>(<span class="hljs-number">0</span>,<span class="hljs-string">"æå››"</span>);
list.<span class="hljs-keyword">remove</span>(<span class="hljs-number">0</span>);
</code></pre>
<pre><code class="hljs language-æ„é€ å‡½æ•°" lang="æ„é€ å‡½æ•°">public CopyOnWriteArrayList() {
    setArray(new Object[0]);
}
</code></pre>
<p>CopyOnWriteArrayListå…¶å®ä¹Ÿæ˜¯åº•å±‚åŸºäºæ•°ç»„æ¥å®ç°çš„ï¼ŒListæ•°æ®ç»“æ„ï¼Œè¦å®ç°å„ç§çº¿ç¨‹å®‰å…¨æ€§</p>
<pre><code class="hljs language-css" lang="css">final void setArray(<span class="hljs-selector-tag">Object</span><span class="hljs-selector-attr">[]</span> <span class="hljs-selector-tag">a</span>) {
    array = <span class="hljs-selector-tag">a</span>;
}
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> <span class="hljs-keyword">volatile</span> Object[] array;
</code></pre>
<p>Â Â Â Â æ ¸å¿ƒçš„åº•å±‚æ•°æ®ç»“æ„æ˜¯æ•°ç»„ï¼Œvolatileï¼Œä¿è¯ å¤šçº¿ç¨‹è¯»å†™çš„å¯è§æ€§ï¼Œåªè¦æœ‰ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†è¿™ä¸ªæ•°ç»„ï¼Œå…¶ä»–çš„çº¿ç¨‹ç«‹é©¬æ˜¯å¯ä»¥è¯»åˆ°çš„<br/></p>
<pre><code class="hljs language-ini" lang="ini">public boolean add(E e) {
    final ReentrantLock <span class="hljs-attr">lock</span> = this.lock<span class="hljs-comment">;</span>
    lock.lock()<span class="hljs-comment">;</span>
    try {
        Object<span class="hljs-section">[]</span> <span class="hljs-attr">elements</span> = getArray()<span class="hljs-comment">;</span>
        int <span class="hljs-attr">len</span> = elements.length<span class="hljs-comment">;</span>
        Object<span class="hljs-section">[]</span> <span class="hljs-attr">newElements</span> = Arrays.copyOf(elements, len + <span class="hljs-number">1</span>)<span class="hljs-comment">;</span>
        newElements<span class="hljs-section">[len]</span> = e<span class="hljs-comment">;</span>
        setArray(newElements)<span class="hljs-comment">;</span>
        return true<span class="hljs-comment">;</span>
    } finally {
        lock.unlock()<span class="hljs-comment">;</span>
    }
}
</code></pre>
<p>Â Â Â Â CopyOnWriteï¼šå†™æ—¶å¤åˆ¶çš„æœºåˆ¶ï¼Œå¤§é‡çš„å†™æ“ä½œéƒ½æ˜¯åŸºäºå†™æ—¶å¤åˆ¶çš„æœºåˆ¶æ¥å®ç°çš„<br/></p>
<p>Â Â Â Â elementsï¼šä»£è¡¨çš„æ˜¯å½“å‰CopyOnWriteArrayListå†…éƒ¨çš„æ•°ç»„ï¼ŒArrays.copyOfå¤åˆ¶çš„æ“ä½œï¼Œå°±æ˜¯æŠŠå½“å‰æ•°ç»„å¤åˆ¶åˆ°äº†æ–°çš„æ•°ç»„é‡Œå»ï¼Œæ–°çš„æ•°ç»„çš„é•¿åº¦æ˜¯å¤šå°‘å‘¢ï¼Ÿlen + 1ï¼ŒnewElementsï¼Œå°±æ˜¯ä¸€ä¸ªå…¨æ–°çš„æ•°ç»„<br/></p>
<p>Â Â Â Â æ–°æ•°ç»„é‡ŒåŒ…å«äº†è€æ•°ç»„æ‰€æœ‰çš„å…ƒç´ ï¼Œè€Œä¸”é•¿åº¦è¿˜å¤šäº†1ä½<br/></p>
<p>Â Â Â Â CopyOnWriteï¼Œå†™æ•°æ®çš„æ—¶å€™ï¼Œä¸æ˜¯ç›´æ¥åœ¨å½“å‰çš„æ•°ç»„é‡Œå†™çš„ï¼Œä»–æ˜¯å…ˆæŠŠè€æ•°ç»„å¤åˆ¶åˆ°æ–°æ•°ç»„é‡Œæ¥ï¼Œå¤§å°ä¸ºlen + 1ï¼Œæ¥ç€æ˜¯å¯¹æ–°æ•°ç»„è¿›è¡Œæ›´æ–°æ“ä½œ<br/></p>
<p>Â Â Â Â æŠŠæ–°æ•°ç»„çš„æœ€åä¸€ä½çš„å…ƒç´ è®¾ç½®æˆè¦æ·»åŠ çš„å…ƒç´ ï¼Œä½ çš„æ›´æ–°çš„æ“ä½œæ­¤æ—¶éƒ½æ˜¯å‘ç”Ÿåœ¨æ–°æ•°ç»„é‡Œçš„ï¼Œè·Ÿè€æ•°ç»„æ˜¯æ²¡å…³ç³»çš„ï¼Œå†™æ—¶å¤åˆ¶çš„æœºåˆ¶ï¼Œå†™æ•°æ®çš„æ—¶å€™ï¼Œå¤åˆ¶ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œç„¶ååœ¨æ–°çš„æ•°ç»„é‡Œæ›´æ–°å…ƒç´ <br/></p>
<p>Â Â Â Â æœ€åå†æŠŠæ–°çš„æ•°ç»„è®¾ç½®ä¸ºCopyOnWriteArrayListå¯¹åº”çš„ä¸€ä¸ªæ•°ç»„ï¼Œvolatileå†™ä¿è¯è¯´ï¼Œåªè¦ä»–ä¸€å†™ï¼Œå…¶ä»–çº¿ç¨‹å¯ä»¥ç«‹é©¬è¯»åˆ°<br/></p>
<p>Â Â Â Â è€æ•°ç»„ç¨åå°±ä¼šè¢«jvmåƒåœ¾å›æ”¶æ‰äº†ï¼Œå·²ç»æ²¡æœ‰äººä½¿ç”¨ä»–äº†<br/></p>
<pre><code class="hljs language-ini" lang="ini">public E set(int index, E element) {
    final ReentrantLock <span class="hljs-attr">lock</span> = this.lock<span class="hljs-comment">;</span>
    lock.lock()<span class="hljs-comment">;</span>
    try {
        Object<span class="hljs-section">[]</span> <span class="hljs-attr">elements</span> = getArray()<span class="hljs-comment">;</span>
        E <span class="hljs-attr">oldValue</span> = get(elements, index)<span class="hljs-comment">;</span>

        if (oldValue != element) {
            int <span class="hljs-attr">len</span> = elements.length<span class="hljs-comment">;</span>
            Object<span class="hljs-section">[]</span> <span class="hljs-attr">newElements</span> = Arrays.copyOf(elements, len)<span class="hljs-comment">;</span>
            newElements<span class="hljs-section">[index]</span> = element<span class="hljs-comment">;</span>
            setArray(newElements)<span class="hljs-comment">;</span>
        } else {
            // Not quite a no-op<span class="hljs-comment">; ensures volatile write semantics</span>
            setArray(elements)<span class="hljs-comment">;</span>
        }
        return oldValue<span class="hljs-comment">;</span>
    } finally {
        lock.unlock()<span class="hljs-comment">;</span>
    }
}
</code></pre>
<p>Â Â Â Â å°†è€æ•°ç»„å¤åˆ¶åˆ°ä¸€ä¸ªæ–°æ•°ç»„é‡Œå»ï¼Œæ–°è€ä¸¤ä¸ªæ•°ç»„çš„å¤§å°æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯lenï¼Œä¿®æ”¹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶ä¸æ˜¯åˆ é™¤å…ƒç´ ï¼Œä¹Ÿä¸æ˜¯æ–°å¢å…ƒç´ <br/></p>
<p>Â Â Â Â å¯¹å¤åˆ¶ä¹‹åçš„ä¸€ä¸ªæ–°æ•°ç»„çš„æŒ‡å®šindexä½ç½®çš„å…ƒç´ è®¾ç½®ä¸ºelementå…ƒç´ <br/></p>
<p>Â Â Â Â ä»–å°±ä¼šå°†ä¿®æ”¹åçš„æ–°æ•°ç»„è®¾ç½®ä¸ºCopyOnWriteArrayListåº•å±‚çš„æ•°ç»„<br/></p>
<pre><code class="hljs language-ini" lang="ini">public E remove(int index) {
    final ReentrantLock <span class="hljs-attr">lock</span> = this.lock<span class="hljs-comment">;</span>
    lock.lock()<span class="hljs-comment">;</span>
    try {
        Object<span class="hljs-section">[]</span> <span class="hljs-attr">elements</span> = getArray()<span class="hljs-comment">;</span>
        int <span class="hljs-attr">len</span> = elements.length<span class="hljs-comment">;</span>
        E <span class="hljs-attr">oldValue</span> = get(elements, index)<span class="hljs-comment">;</span>
        int <span class="hljs-attr">numMoved</span> = len - index - <span class="hljs-number">1</span><span class="hljs-comment">;</span>
        if (<span class="hljs-attr">numMoved</span> == <span class="hljs-number">0</span>)
            setArray(Arrays.copyOf(elements, len - 1))<span class="hljs-comment">;</span>
        else {
            Object<span class="hljs-section">[]</span> <span class="hljs-attr">newElements</span> = new Object[len - <span class="hljs-number">1</span>]<span class="hljs-comment">;</span>
            System.arraycopy(elements, 0, newElements, 0, index)<span class="hljs-comment">;</span>
            System.arraycopy(elements, index + 1, newElements, index,
                             numMoved)<span class="hljs-comment">;</span>
            setArray(newElements)<span class="hljs-comment">;</span>
        }
        return oldValue<span class="hljs-comment">;</span>
    } finally {
        lock.unlock()<span class="hljs-comment">;</span>
    }
}
</code></pre>
<p>Â Â Â Â æ¯ä¸€ä¸ªCopyOnWriteArrayListåº•å±‚éƒ½å¯¹åº”ä¸€ä¸ªæ•°æ®ç»“æ„ï¼ŒObject[]æ•°ç»„ï¼ŒåŒæ—¶è¿˜å¯¹åº”äº†ä¸€ä¸ªReentrantLockç‹¬å é”ï¼Œå°±æ˜¯ç”¨ç‹¬å é”æ¥ä¿è¯è¯´è¦ä¿®æ”¹Object[]æ•°ç»„çš„æ—¶å€™ï¼Œå¿…é¡»åŠ ç‹¬å é”ï¼Œæ­¤æ—¶åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è·å–é”<br/></p>
<p>Â Â Â Â ç‹¬å é”ä¿è¯äº†ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥æ¥ä¿®æ”¹åº•å±‚çš„æ•°ç»„é‡Œçš„æ•°æ®<br/></p>
<p>Â Â Â Â å¢åˆ æ”¹æ“ä½œçš„æ—¶å€™ï¼Œéƒ½å¿…é¡»å…ˆè·å–ä¸€æŠŠReentrantLockç‹¬å é”ï¼Œä¿è¯åŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ¥æ“ä½œåº•å±‚çš„æ•°ç»„æ•°æ®ç»“æ„ï¼Œæ›´æ–°CopyOnWriteArrayListçš„å¤šçº¿ç¨‹å¹¶å‘çš„å®‰å…¨æ€§å°±è¢«ä¿è¯äº†ï¼Œå¤šçº¿ç¨‹å¹¶å‘å†™çš„æ—¶å€™<br/></p>
<p>Â Â Â Â å¹¶å‘å†™CopyOnWriteArrayListçš„æ€§èƒ½æ˜¯è¾ƒå·®çš„ï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰çš„çº¿ç¨‹éƒ½éœ€è¦ä¸²è¡Œèµ·æ¥å†™CopyOnwriteArrayListï¼Œä¸€ä¸ªçº¿ç¨‹å…ˆå†™å®Œï¼Œä¸‹ä¸€ä¸ªçº¿ç¨‹æ‰èƒ½å†™<br/></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> E <span class="hljs-title">get</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> index</span>)</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">get</span>(getArray(), index);
}
</code></pre>
<pre><code class="hljs language-css" lang="css">private E get(<span class="hljs-selector-tag">Object</span><span class="hljs-selector-attr">[]</span> <span class="hljs-selector-tag">a</span>, int index) {
    return (E) <span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[index]</span>;
}
</code></pre>
<p>Â Â Â Â å†™æ•°æ®çš„æ—¶å€™ä¸€å®šè¦CopyOnWriteï¼Œå¦‚ä½•è§£å†³è¯»å†™å¹¶å‘çš„é—®é¢˜ï¼Œå†™æ•°æ®çš„æ—¶å€™ï¼Œå¦‚ä½•å®‰å…¨çš„è¯»æ•°æ®<br/></p>
<p>Â Â Â Â CopyOnWriteArrayListè®¾è®¡æ€æƒ³ï¼Œå¹¶ä¸æ˜¯åŸºäºCASæ‰§è¡Œè¯»å†™æ“ä½œï¼Œå†™æ•°æ®çš„æ—¶å€™ï¼Œå…¨éƒ¨å¤åˆ¶ä¸€ä¸ªå‰¯æœ¬ï¼Œæ–°çš„æ•°ç»„ï¼Œå¯¹æ–°çš„æ•°ç»„æ¥ä¿®æ”¹ï¼Œä¿®æ”¹å¥½äº†è®¾ç½®å›å»å°±å¯ä»¥äº†ã€‚è¯»æ•°æ®ï¼Œåªæœ‰ä¸¤ç§æƒ…å†µ<br/></p>
<p>Â Â Â Â ç¬¬ä¸€ç§ï¼šæˆ‘è¯»åˆ°çš„è€æ•°ç»„çš„æ•°æ®<br/></p>
<p>Â Â Â Â ç¬¬äºŒç§ï¼šå…¶ä»–çº¿ç¨‹æ›´æ–°å¥½äº†æ•°ç»„ï¼Œvolatileå†™ï¼Œæˆ‘è¯»åˆ°çš„æ˜¯æ–°æ•°ç»„çš„æ•°æ®<br/></p>
<p>Â Â Â Â æˆ‘ä¸éœ€è¦ä¾èµ–ä»»ä½•ä¸€ç§åŠ é”çš„æœºåˆ¶æ¥ä¿è¯æ•°æ®è¯»å†™å¹¶å‘çš„å®‰å…¨æ€§ï¼Œæˆ‘ç”šè‡³éƒ½ä¸éœ€è¦ä¾èµ–äºUnsafe.getObjectVolatile()ï¼Œvolatileè¯»æœºåˆ¶ï¼Œæ¥è¯»å–æ•°ç»„é‡Œçš„å…ƒç´ ï¼Œæˆ‘ç›´æ¥å°±æ˜¯æœ€æœ€ç®€å•ï¼Œæœ€æœ€é«˜æ•ˆ<br/></p>
<p>Â Â Â Â æœ€æœ€é«˜æ€§èƒ½çš„ï¼Œè¯»å°±æ˜¯ç›´æ¥è¯»å½“å‰æ•°ç»„çš„æ•°æ®å³å¯ï¼Œè¦ä¹ˆè¯»çš„æ˜¯è€æ•°æ®ï¼Œè¦ä¹ˆè¯»çš„æ˜¯æœ€æ–°çš„æ•°æ®ï¼Œéƒ½æœ‰å¯èƒ½<br/></p>
<p>Â Â Â Â å†™æ•°æ®æ›´æ–°çš„æ˜¯å¤åˆ¶å¥½çš„å¦å¤–ä¸€ä¸ªå‰¯æœ¬æ•°ç»„ï¼ŒåŒä¸€æ—¶é—´å¤§é‡çš„çº¿ç¨‹è¯»æ•°æ®çš„æ—¶å€™ï¼Œéƒ½æ˜¯åœ¨è¯»è€æ•°ç»„çš„æ•°æ®ï¼Œè¯»å†™ä¹‹é—´æ˜¯æ²¡æœ‰ä»»ä½•çš„å¹¶å‘å†²çªé—®é¢˜çš„ï¼Œè¯»å’Œå†™ä¹‹é—´æ˜¯æ²¡æœ‰é”çš„å†²çªçš„ï¼Œå†™çš„æ˜¯å‰¯æœ¬æ•°ç»„<br/></p>
<p>Â Â Â Â CopyOnWriteæœºåˆ¶ï¼Œå†™å‰¯æœ¬æ•°ç»„ï¼Œè·Ÿè¯»å°±æ²¡å…³ç³»äº†ï¼Œåªè¦å†™å®Œæˆä¹‹åï¼Œèµ°ä¸€ä¸ªvolatileå†™ï¼Œè®¾ç½®æœ€æ–°çš„æ•°ç»„ï¼Œè‡ªç„¶è¯»æ“ä½œå°±ä¼šè¯»åˆ°æœ€æ–°æ•°ç»„çš„å…ƒç´ äº†ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥å†™ï¼Œä½†æ˜¯å†™çš„åŒæ—¶å¯ä»¥å…è®¸å¤§é‡çš„çº¿ç¨‹æ¥å¹¶å‘è¯»<br/></p>
<pre><code class="hljs language-vbnet" lang="vbnet">List&lt;<span class="hljs-type">String</span>&gt; list = <span class="hljs-built_in">new</span> CopyOnWriteArrayList&lt;<span class="hljs-type">String</span>&gt;();
list.add(<span class="hljs-string">"å¼ ä¸‰"</span>);
list.<span class="hljs-keyword">set</span>(<span class="hljs-number">0</span>,<span class="hljs-string">"æå››"</span>);
list.remove(<span class="hljs-number">0</span>);
list.<span class="hljs-keyword">get</span>(<span class="hljs-number">0</span>);

<span class="hljs-keyword">Iterator</span>&lt;<span class="hljs-type">String</span>&gt; <span class="hljs-keyword">iterator</span> = list.<span class="hljs-keyword">iterator</span>();
<span class="hljs-keyword">while</span> (<span class="hljs-keyword">iterator</span>.hasNext()){
    System.out.println(<span class="hljs-keyword">iterator</span>.<span class="hljs-keyword">next</span>());
}
</code></pre>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Iterator</span>&lt;<span class="hljs-title">E</span>&gt; <span class="hljs-title">iterator</span>()</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> COWIterator&lt;E&gt;(getArray(), <span class="hljs-number">0</span>);
}
</code></pre>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-type">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">COWIterator</span>&lt;E&gt; implements ListIterator&lt;E&gt; {
    <span class="hljs-comment">/** Snapshot of the array */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Object[] snapshot;
    <span class="hljs-comment">/** Index of element to be returned by subsequent call to next.  */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> cursor;

    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">COWIterator</span><span class="hljs-params">(Object[] elements, <span class="hljs-type">int</span> initialCursor)</span> </span>{
        cursor = initialCursor;
        snapshot = elements;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title">hasNext</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> cursor &lt; snapshot.length;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title">hasPrevious</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> cursor &gt; <span class="hljs-number">0</span>;
    }

    @<span class="hljs-built_in">SuppressWarnings</span>(<span class="hljs-string">"unchecked"</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> E <span class="hljs-title">next</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">if</span> (! <span class="hljs-built_in">hasNext</span>())
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">NoSuchElementException</span>();
        <span class="hljs-keyword">return</span> (E) snapshot[cursor++];
    }

    @<span class="hljs-built_in">SuppressWarnings</span>(<span class="hljs-string">"unchecked"</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> E <span class="hljs-title">previous</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">if</span> (! <span class="hljs-built_in">hasPrevious</span>())
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">NoSuchElementException</span>();
        <span class="hljs-keyword">return</span> (E) snapshot[--cursor];
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title">nextIndex</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> cursor;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title">previousIndex</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> cursor<span class="hljs-number">-1</span>;
    }

    <span class="hljs-comment">/**
     * Not supported. Always throws UnsupportedOperationException.
     * @throws UnsupportedOperationException always; {@code remove}
     *         is not supported by this iterator.
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">void</span> <span class="hljs-title">remove</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">UnsupportedOperationException</span>();
    }

    <span class="hljs-comment">/**
     * Not supported. Always throws UnsupportedOperationException.
     * @throws UnsupportedOperationException always; {@code set}
     *         is not supported by this iterator.
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">void</span> <span class="hljs-title">set</span><span class="hljs-params">(E e)</span> </span>{
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">UnsupportedOperationException</span>();
    }

    <span class="hljs-comment">/**
     * Not supported. Always throws UnsupportedOperationException.
     * @throws UnsupportedOperationException always; {@code add}
     *         is not supported by this iterator.
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">void</span> <span class="hljs-title">add</span><span class="hljs-params">(E e)</span> </span>{
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">UnsupportedOperationException</span>();
    }

    @<span class="hljs-function">Override
    <span class="hljs-keyword">public</span> <span class="hljs-type">void</span> <span class="hljs-title">forEachRemaining</span><span class="hljs-params">(Consumer&lt;? super E&gt; action)</span> </span>{
        Objects.<span class="hljs-built_in">requireNonNull</span>(action);
        Object[] elements = snapshot;
        <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> size = elements.length;
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = cursor; i &lt; size; i++) {
            @<span class="hljs-built_in">SuppressWarnings</span>(<span class="hljs-string">"unchecked"</span>) E e = (E) elements[i];
            action.<span class="hljs-built_in">accept</span>(e);
        }
        cursor = size;
    }
}
</code></pre>
<p>Â Â Â Â Iteratorè¿­ä»£å™¨é‡Œé¢æ˜¯åŒ…å«äº†ä¸€ä¸ªsnapshotï¼ŒæŒ‡å‘çš„å°±æ˜¯CopyOnWriteArrayListå½“å‰çš„æ•°ç»„ï¼Œarrayå¯¹è±¡ï¼Œä½ åˆ›å»ºäº†ä¸€ä¸ªIteratorè¿­ä»£å™¨å¯¹è±¡ä¹‹åï¼Œåœ¨è¿­ä»£çš„è¿‡ç¨‹ä¸­ï¼Œéƒ½æ˜¯åŸºäºå¿«ç…§æ•°ç»„åœ¨è¿›è¡Œéå†çš„<br/></p>
<p>Â Â Â Â å¦‚æœæ­¤æ—¶æœ‰å¦å¤–ä¸€ä¸ªçº¿ç¨‹æ›´æ–°äº†æ•°ç»„çš„å…ƒç´ ï¼Œè®¾ç½®äº†arrayï¼Œä½†æ˜¯æ­¤æ—¶å¯¹è¿­ä»£æ˜¯æ²¡æœ‰ä»»ä½•å½±å“çš„ï¼Œä½ çš„è¿­ä»£å™¨é‡Œæœ‰ä¸€ä¸ªsnapshotæŒ‡é’ˆæŒ‡å‘äº†è€çš„æ•°ç»„å¯¹è±¡ï¼Œä»–ä¼šä¸€ç›´ç”¨è¿™ä¸ªè€çš„æ•°ç»„å®Œæˆéå†<br/></p>
<p>Â Â Â Â è¿­ä»£ä¹Ÿæ˜¯åŸºäºå¿«ç…§çš„æœºåˆ¶æ¥å®ç°çš„ï¼Œè¯»æ“ä½œå…¶å®è·Ÿå†™æ“ä½œéƒ½æ˜¯åŠæ¯›é’±å…³ç³»æ²¡æœ‰çš„ï¼ŒCopyOnWriteæœºåˆ¶ï¼Œè¿™æ ·çš„ä¸€å¥—è®¾è®¡æ€æƒ³ï¼Œä¿è¯äº†å°±æ˜¯è¯´ä½ çš„è¯»çš„å¹¶å‘èƒ½åŠ›æ˜¯å¾ˆå¼ºçš„ï¼Œä¸éœ€è¦åŠ é”çš„<br/></p>
<p>Â Â Â Â CopyOnWriteArrayListï¼šå¼±ä¸€è‡´æ€§<br/></p>
<p>Â Â Â Â å¤šä¸ªçº¿ç¨‹å¹¶å‘çš„è¯»å†™listï¼Œä¸­é—´ä¸€å®šæ˜¯æœ‰ä¸€æ®µæ—¶é—´ï¼Œæ˜¯å¤åˆ¶æ•°ç»„è¢«ä¿®æ”¹å¥½äº†ï¼Œè¿˜æ²¡è®¾ç½®ç»™arrayï¼›ä½†æ˜¯æ­¤æ—¶å…¶ä»–çº¿ç¨‹è¯»åˆ°çš„éƒ½æ˜¯è€æ•°ç»„çš„æ•°æ®ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¤šä¸ªçº¿ç¨‹çœ‹åˆ°çš„æ•°æ®æ˜¯ä¸ä¸€è‡´çš„ï¼Œäººå®¶ä¿®æ”¹äº†æ•°æ®æ²¡æœ‰ç«‹é©¬è¢«äººè¯»åˆ°<br/></p>
<p>Â Â Â Â å¼±ä¸€è‡´æ€§ -&gt; æœ€ç»ˆä¸€è‡´æ€§<br/></p>
<p>Â Â Â Â ä¼˜ç‚¹ï¼šè¯»å’Œå†™ä¸äº’æ–¥çš„ï¼Œå†™å’Œå†™äº’æ–¥ï¼ŒåŒä¸€æ—¶é—´å°±ä¸€ä¸ªäººå¯ä»¥å†™ï¼Œä½†æ˜¯å†™çš„åŒæ—¶å¯ä»¥å…è®¸å…¶ä»–æ‰€æœ‰äººæ¥è¯»ï¼›è¯»å’Œè¯»ä¹Ÿæ˜¯å¹¶å‘çš„ï¼›è¯»å†™é”æœºåˆ¶è¿˜è¦å¥½ï¼›ä»–ä¹Ÿä¸æ¶‰åŠåˆ°Unsafe.getObjectVolatile<br/></p>
<p>Â Â Â Â ä½¿ç”¨åœºæ™¯ï¼šå¤šçº¿ç¨‹å¹¶å‘å®‰å…¨æ€§ï¼Œå¯ä»¥é€‰ç”¨ä»–ï¼›å°½å¯èƒ½æ˜¯è¯»å¤šå†™å°‘çš„åœºæ™¯ï¼Œå¤§é‡çš„è¯»æ˜¯ä¸è¢«å½±å“çš„ï¼›å¯èƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹åˆšåˆšå‘èµ·äº†å†™ï¼Œæ­¤æ—¶åˆ«çš„çº¿ç¨‹è¯»åˆ°çš„è¿˜æ˜¯æ—§çš„æ•°æ®ï¼Œä¹Ÿæœ‰è¿™ç§å¯èƒ½ï¼Œè¿˜å¥½<br/></p>
<p>Â Â Â Â ç¼ºç‚¹ï¼šç©ºé—´æ¢æ—¶é—´ï¼Œå†™çš„æ—¶å€™ï¼Œç»å¸¸å†…å­˜é‡Œä¼šå‡ºç°å¤åˆ¶å‡ºæ¥çš„ä¸€æ¨¡ä¸€æ ·çš„å‰¯æœ¬ï¼Œå¯¹å†…å­˜æ¶ˆè€—è¿‡å¤§ï¼Œå‰¯æœ¬æœºåˆ¶ä¿è¯äº†ä¿è¯è¯»å†™å¹¶å‘ä¼˜åŒ–ï¼Œå¤§é‡çš„å¹¶å‘è¯»ä¸éœ€è¦é”äº’æ–¥ï¼Œlistå¦‚æœå¾ˆå¤§ï¼Œå¯èƒ½ä½ è¦è€ƒè™‘åœ¨çº¿ä¸Šè¿è¡Œçš„æ—¶å€™ï¼Œå¯èƒ½ç»å¸¸<br/></p>
<p>Â Â Â Â å†…å­˜å ç”¨ä¼šæ˜¯listå¤§å°çš„å‡ å€<br/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»å•ä½“PHPåˆ°å¾®æœåŠ¡ï¼šä¸€ä¸ªäº”å¹´è€é¡¹ç›®çš„è¡€æ³ªé‡æ„å²]]></title>    <link>https://juejin.cn/post/7580570363602747444</link>    <guid>https://juejin.cn/post/7580570363602747444</guid>    <pubDate>2025-12-07T22:34:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580570363602747444" data-draft-id="7580815599350153231" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»å•ä½“PHPåˆ°å¾®æœåŠ¡ï¼šä¸€ä¸ªäº”å¹´è€é¡¹ç›®çš„è¡€æ³ªé‡æ„å²"/> <meta itemprop="keywords" content="åç«¯,é¢è¯•,æ¶æ„"/> <meta itemprop="datePublished" content="2025-12-07T22:34:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¸æµªæ— ç—•"/> <meta itemprop="url" content="https://juejin.cn/user/2834988091055719"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»å•ä½“PHPåˆ°å¾®æœåŠ¡ï¼šä¸€ä¸ªäº”å¹´è€é¡¹ç›®çš„è¡€æ³ªé‡æ„å²
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2834988091055719/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¸æµªæ— ç—•
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T22:34:09.000Z" title="Sun Dec 07 2025 22:34:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»17åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å‡ å¹´å‰çš„ä¸€ä¸ªå‡Œæ™¨ä¸‰ç‚¹ï¼Œæ‰‹æœºå“äº†ã€‚æˆ‘çœ‹äº†ä¸€çœ¼å±å¹•â€”â€”æ˜¯ç›‘æ§ç³»ç»Ÿå‘æ¥çš„ç”µè¯æŠ¥è­¦ï¼Œè¿™æ˜¯ä¸€çº§ç”Ÿäº§äº‹æ•…ï¼Œæ‰‹æœºçŸ­ä¿¡æ›´æ˜¯å‡ åæ¡ã€‚</p>
<p>è¿™æ˜¯è¿™ä¸ªæœˆç¬¬ä¸‰æ¬¡ã€‚</p>
<p>æˆ‘æ‰“å¼€ç¬”è®°æœ¬ï¼Œsshè¿åˆ°æœåŠ¡å™¨ï¼š</p>
<ul>
<li>CPUä½¿ç”¨ç‡ï¼š98%</li>
<li>å†…å­˜ï¼š16Gç”¨äº†15.8G</li>
<li>MySQLè¿æ¥æ•°ï¼š1521/1500ï¼ˆçˆ†äº†ï¼‰</li>
<li>PHP-FPMè¿›ç¨‹ï¼šå…¨éƒ¨å¡åœ¨waitingçŠ¶æ€</li>
</ul>
<p>å‡Œæ™¨ä¸‰ç‚¹åŠï¼Œæˆ‘åœ¨é”®ç›˜ä¸Šæ•²ç€é‡å¯å‘½ä»¤ã€‚å‡Œæ™¨å››ç‚¹ï¼Œç³»ç»Ÿæ¢å¤ã€‚å‡Œæ™¨å››ç‚¹åŠï¼Œæˆ‘èººå›åºŠä¸Šã€‚</p>
<p>ä½†æˆ‘çŸ¥é“ï¼Œè¿™åªæ˜¯æƒå®œä¹‹è®¡ã€‚</p>
<h2 data-id="heading-0">ç¬¬äºŒå¤©æ—©ä¸Šçš„ä¼šè®®å®¤</h2>
<p>å½“æ—¶æˆ‘ä»¬çš„ç³»ç»Ÿæ˜¯ä¸€ä¸ªå…¸å‹çš„PHPå•ä½“åº”ç”¨ï¼Œè¿è¡Œäº†5å¹´ï¼Œä»£ç é‡30ä¸‡è¡Œã€‚æ•´ä¸ªæ¶æ„é•¿è¿™æ ·ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    A[Nginx] --&gt; B[PHP-FPM&lt;br/&gt;200ä¸ªè¿›ç¨‹]
    B --&gt; C[(MySQLä¸»åº“)]
    B --&gt; D[(MySQLä»åº“)]
    B --&gt; E[Redis]
    B --&gt; F[æ–‡ä»¶å­˜å‚¨]
    
    style B fill:#ffcccc
    style C fill:#ffcccc
</code></pre>
<p>æ‰€æœ‰åŠŸèƒ½éƒ½å¡åœ¨è¿™ä¸€ä¸ªé¡¹ç›®é‡Œï¼šç”¨æˆ·ç®¡ç†ã€å†…å®¹å‘å¸ƒã€è¯„è®ºç³»ç»Ÿã€æ¶ˆæ¯é€šçŸ¥ã€æ•°æ®ç»Ÿè®¡ã€åå°ç®¡ç†...æ”¹ä¸€è¡Œä»£ç è¦é‡æ–°éƒ¨ç½²æ•´ä¸ªç³»ç»Ÿï¼Œæµ‹è¯•è¦æµ‹æ‰€æœ‰åŠŸèƒ½ã€‚</p>
<p>CTOæ‹äº†æ‹æ¡Œå­ï¼š"å¿…é¡»é‡æ„äº†ï¼Œæ”¹æˆå¾®æœåŠ¡ã€‚"</p>
<p>æˆ‘å¿ƒé‡Œæ˜¯æ‹’ç»çš„ã€‚</p>
<p>ç½‘ä¸Šé‚£äº›å¾®æœåŠ¡çš„æ–‡ç« æˆ‘éƒ½çœ‹è¿‡ã€‚æœåŠ¡æ‹†åˆ†ã€ç½‘å…³ã€æ³¨å†Œä¸­å¿ƒã€é…ç½®ä¸­å¿ƒã€åˆ†å¸ƒå¼äº‹åŠ¡...å…‰æ˜¯çœ‹ç€å°±å¤´å¤§ã€‚è€Œä¸”æˆ‘ä»¬å›¢é˜Ÿåªæœ‰8ä¸ªäººï¼Œäº§å“ç»ç†æ¯å‘¨éƒ½åœ¨å‚¬æ–°åŠŸèƒ½ï¼Œå“ªæœ‰æ—¶é—´æè¿™äº›ï¼Ÿ</p>
<p>ä½†æ¶ä¸ä½ç³»ç»ŸçœŸçš„æ’‘ä¸ä½äº†ã€‚</p>
<h2 data-id="heading-1">ç¬¬ä¸€æ­¥ï¼šåˆ«æƒ³ç€ä¸€æ¬¡æ€§é‡å†™</h2>
<p>æˆ‘ä»¬æŠ€æœ¯å›¢é˜Ÿä¸€å…±8ä¸ªäººã€‚äº§å“ç»ç†æ¯å‘¨éƒ½åœ¨å‚¬æ–°åŠŸèƒ½ï¼Œæ ¹æœ¬ä¸å¯èƒ½åœä¸‹æ¥æä¸‰ä¸ªæœˆå¤§é‡æ„ã€‚</p>
<p>æ‰€ä»¥å®šäº†ä¸ªåŸåˆ™ï¼š<strong>è€ç³»ç»Ÿç»§ç»­è·‘ï¼Œæ–°åŠŸèƒ½ç”¨æ–°æœåŠ¡å¼€å‘ï¼Œæ…¢æ…¢èš•é£Ÿè€ç³»ç»Ÿã€‚</strong></p>
<h3 data-id="heading-2">ç¬¬ä¸€åˆ€ï¼šç æ‰çŸ­ä¿¡æœåŠ¡</h3>
<p>ä¸ºä»€ä¹ˆå…ˆé€‰çŸ­ä¿¡ï¼Ÿå› ä¸ºå®ƒæœ€ç‹¬ç«‹ï¼š</p>
<ul>
<li>åªæœ‰å‘é€çŸ­ä¿¡ä¸€ä¸ªåŠŸèƒ½</li>
<li>å…¶ä»–æ¨¡å—åªæ˜¯è°ƒç”¨ï¼Œä¸å…³å¿ƒå†…éƒ¨å®ç°</li>
<li>æŒ‚äº†ä¹Ÿä¸å½±å“æ ¸å¿ƒä¸šåŠ¡ï¼ˆå¤§ä¸äº†çŸ­ä¿¡æ™šç‚¹å‘ï¼‰</li>
</ul>
<p>æˆ‘ç”¨Spring Bootå†™äº†ä¸€ä¸ªçŸ­ä¿¡å¾®æœåŠ¡ï¼ŒæŠ€æœ¯æ ˆé€‰äº†Spring Cloud Alibabaã€‚ä¸ºä»€ä¹ˆé€‰è¿™å¥—ï¼Ÿä¸»è¦æ˜¯ï¼š</p>
<ul>
<li>å›¢é˜Ÿä¹‹å‰ç”¨è¿‡Springï¼Œä¸Šæ‰‹å¿«</li>
<li>Nacosæ—¢èƒ½åšæ³¨å†Œä¸­å¿ƒåˆèƒ½åšé…ç½®ä¸­å¿ƒï¼Œçœäº‹</li>
<li>ä¸­æ–‡æ–‡æ¡£å¤šï¼Œé‡åˆ°é—®é¢˜å¥½æœ</li>
</ul>
<p>éƒ¨ç½²æµç¨‹æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    A[Nacosæ³¨å†Œä¸­å¿ƒ] 
    B[çŸ­ä¿¡æœåŠ¡&lt;br/&gt;Spring Boot] --&gt; A
    C[PHPè€ç³»ç»Ÿ] -.HTTPè°ƒç”¨.-&gt; B
    D[Gatewayç½‘å…³] --&gt; B
    
    style B fill:#ccffcc
    style C fill:#ffffcc
</code></pre>
<p>å…³é”®é…ç½®ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># application.yml</span>
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">application:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">sms-service</span>
  <span class="hljs-attr">cloud:</span>
    <span class="hljs-attr">nacos:</span>
      <span class="hljs-attr">discovery:</span>
        <span class="hljs-attr">server-addr:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-string">:8848</span>
        
<span class="hljs-attr">server:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">8081</span>
</code></pre>
<p>å…³é”®ç‚¹åœ¨äºï¼š</p>
<ol>
<li>çŸ­ä¿¡æœåŠ¡å¯åŠ¨æ—¶è‡ªåŠ¨æ³¨å†Œåˆ°Nacos</li>
<li>PHPè€ç³»ç»Ÿé‡Œï¼ŒåŸæ¥çš„å‘çŸ­ä¿¡ä»£ç æ”¹æˆHTTPè°ƒç”¨æ–°æœåŠ¡</li>
<li>å¦‚æœæ–°æœåŠ¡æŒ‚äº†ï¼Œé™çº§å›è€çš„çŸ­ä¿¡å‘é€é€»è¾‘</li>
</ol>
<p>ä»£ç æ”¹åŠ¨å¾ˆå°ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// è€ä»£ç </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sendSMS</span>(<span class="hljs-params"><span class="hljs-variable">$phone</span>, <span class="hljs-variable">$content</span></span>) </span>{
    <span class="hljs-comment">// ç›´æ¥è°ƒç”¨çŸ­ä¿¡SDK</span>
    <span class="hljs-variable">$smsClient</span>-&gt;<span class="hljs-title function_ invoke__">send</span>(<span class="hljs-variable">$phone</span>, <span class="hljs-variable">$content</span>);
}

<span class="hljs-comment">// æ–°ä»£ç </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sendSMS</span>(<span class="hljs-params"><span class="hljs-variable">$phone</span>, <span class="hljs-variable">$content</span></span>) </span>{
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// å…ˆå°è¯•è°ƒç”¨æ–°æœåŠ¡</span>
        <span class="hljs-variable">$response</span> = <span class="hljs-variable">$httpClient</span>-&gt;<span class="hljs-title function_ invoke__">post</span>(<span class="hljs-string">'http://sms-service/send'</span>, [
            <span class="hljs-string">'phone'</span> =&gt; <span class="hljs-variable">$phone</span>,
            <span class="hljs-string">'content'</span> =&gt; <span class="hljs-variable">$content</span>
        ]);
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$response</span>;
    } <span class="hljs-keyword">catch</span> (<span class="hljs-built_in">Exception</span> <span class="hljs-variable">$e</span>) {
        <span class="hljs-comment">// é™çº§ï¼šæ–°æœåŠ¡æŒ‚äº†å°±ç”¨è€æ–¹å¼</span>
        <span class="hljs-variable">$smsClient</span>-&gt;<span class="hljs-title function_ invoke__">send</span>(<span class="hljs-variable">$phone</span>, <span class="hljs-variable">$content</span>);
    }
}
</code></pre>
<p>ä¸Šçº¿ç¬¬ä¸€å‘¨ï¼Œæ–°çŸ­ä¿¡æœåŠ¡å¤„ç†äº†10%çš„æµé‡ã€‚è§‚å¯Ÿäº†ä¸€å‘¨æ²¡é—®é¢˜ï¼Œé€æ­¥æ”¾é‡åˆ°100%ã€‚</p>
<p>è¿™ä¸ªè¿‡ç¨‹ä¸­å­¦åˆ°çš„ç¬¬ä¸€ä¸ªæ•™è®­ï¼š<strong>åƒä¸‡åˆ«ä¸€ä¸Šæ¥å°±æŠŠæµé‡å…¨åˆ‡è¿‡å»ã€‚</strong> æˆ‘ä»¬åŒäº‹è´Ÿè´£çš„å¦ä¸€ä¸ªé¡¹ç›®ï¼Œç›´æ¥å…¨é‡åˆ‡æ¢ï¼Œç»“æœæ–°æœåŠ¡æœ‰ä¸ªbugæ²¡æµ‹å‡ºæ¥ï¼Œå¯¼è‡´ä¸€å¤©å†…5ä¸‡æ¡çŸ­ä¿¡å‘é€å¤±è´¥ã€‚</p>
<h2 data-id="heading-3">ç¬¬äºŒæ­¥ï¼šSpring Cloud Gatewayæ›¿ä»£Kong</h2>
<p>çŸ­ä¿¡æœåŠ¡æ‹†å‡ºå»åï¼Œæ¥ç€æ‹†äº†æ¶ˆæ¯æ¨é€æœåŠ¡ã€æ–‡ä»¶ä¸Šä¼ æœåŠ¡ã€‚é—®é¢˜æ¥äº†ï¼š</p>
<ul>
<li>æ‰‹æœºAppè¦è°ƒä¸‰ä¸ªæœåŠ¡çš„æ¥å£ï¼Œæ¯ä¸ªæœåŠ¡åœ°å€éƒ½ç¡¬ç¼–ç åœ¨Appé‡Œ</li>
<li>æ¯ä¸ªæœåŠ¡éƒ½è¦åšä¸€éJWTéªŒè¯ï¼Œé‡å¤ä»£ç åˆ°å¤„éƒ½æ˜¯</li>
<li>å‰ç«¯åŒå­¦æŠ±æ€¨ï¼šä»¥å‰è°ƒä¸€æ¬¡æ¥å£å°±è¡Œï¼Œç°åœ¨è¦è°ƒä¸‰æ¬¡ï¼Œä½“éªŒå˜å·®äº†</li>
</ul>
<p>è¿™æ—¶å€™æˆ‘ä»¬å¼•å…¥äº†Spring Cloud Gatewayä½œä¸ºAPIç½‘å…³ã€‚ä¸ºä»€ä¹ˆä¸ç”¨Kongï¼Ÿå› ä¸ºæˆ‘ä»¬å·²ç»é€‰äº†Springå…¨å®¶æ¡¶ï¼ŒGatewayè·ŸNacosé›†æˆæ›´æ–¹ä¾¿ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant App
    participant Gateway
    participant Nacos
    participant çŸ­ä¿¡æœåŠ¡
    participant æ¨é€æœåŠ¡
    
    çŸ­ä¿¡æœåŠ¡-&gt;&gt;Nacos: æ³¨å†ŒæœåŠ¡
    æ¨é€æœåŠ¡-&gt;&gt;Nacos: æ³¨å†ŒæœåŠ¡
    
    App-&gt;&gt;Gateway: å‘é€éªŒè¯ç è¯·æ±‚
    Gateway-&gt;&gt;Gateway: JWTéªŒè¯(ç»Ÿä¸€é‰´æƒ)
    Gateway-&gt;&gt;Nacos: æŸ¥è¯¢çŸ­ä¿¡æœåŠ¡åœ°å€
    Nacos--&gt;&gt;Gateway: è¿”å›æœåŠ¡å®ä¾‹åˆ—è¡¨
    Gateway-&gt;&gt;çŸ­ä¿¡æœåŠ¡: è½¬å‘è¯·æ±‚(è´Ÿè½½å‡è¡¡)
    çŸ­ä¿¡æœåŠ¡--&gt;&gt;Gateway: è¿”å›ç»“æœ
    Gateway--&gt;&gt;App: è¿”å›
</code></pre>
<p>Gatewayçš„é…ç½®ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spring:</span>
  <span class="hljs-attr">cloud:</span>
    <span class="hljs-attr">gateway:</span>
      <span class="hljs-attr">routes:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">id:</span> <span class="hljs-string">sms-service</span>
          <span class="hljs-attr">uri:</span> <span class="hljs-string">lb://sms-service</span>  <span class="hljs-comment"># lbè¡¨ç¤ºä»Nacosè´Ÿè½½å‡è¡¡</span>
          <span class="hljs-attr">predicates:</span>
            <span class="hljs-bullet">-</span> <span class="hljs-string">Path=/api/sms/**</span>
          <span class="hljs-attr">filters:</span>
            <span class="hljs-bullet">-</span> <span class="hljs-string">StripPrefix=1</span>
            
        <span class="hljs-bullet">-</span> <span class="hljs-attr">id:</span> <span class="hljs-string">push-service</span>
          <span class="hljs-attr">uri:</span> <span class="hljs-string">lb://push-service</span>
          <span class="hljs-attr">predicates:</span>
            <span class="hljs-bullet">-</span> <span class="hljs-string">Path=/api/push/**</span>
          <span class="hljs-attr">filters:</span>
            <span class="hljs-bullet">-</span> <span class="hljs-string">StripPrefix=1</span>
</code></pre>
<p>ç½‘å…³åšçš„äº‹æƒ…ï¼š</p>
<ol>
<li>ç»Ÿä¸€é‰´æƒï¼šJWTéªŒè¯å†™ä¸€æ¬¡ï¼Œæ‰€æœ‰æœåŠ¡å¤ç”¨</li>
<li>åŠ¨æ€è·¯ç”±ï¼šä»Nacosè‡ªåŠ¨å‘ç°æœåŠ¡ï¼Œä¸ç”¨å†™æ­»IPåœ°å€</li>
<li>è´Ÿè½½å‡è¡¡ï¼šRibbonè‡ªåŠ¨åœ¨å¤šä¸ªæœåŠ¡å®ä¾‹é—´åˆ†é…è¯·æ±‚</li>
<li>é™æµä¿æŠ¤ï¼šç”¨Sentinelåšé™æµï¼ŒæŸä¸ªç”¨æˆ·è¯·æ±‚å¤ªé¢‘ç¹ç›´æ¥æ‹¦æˆª</li>
</ol>
<p>ä¸Šçº¿ç½‘å…³åï¼Œé‡åˆ°çš„ç¬¬ä¸€ä¸ªå‘ï¼šGatewayæˆäº†å•ç‚¹æ•…éšœã€‚</p>
<p>æœ‰ä¸€æ¬¡GatewayæŒ‚äº†ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½502ã€‚åæ¥æˆ‘ä»¬éƒ¨ç½²äº†3ä¸ªGatewayå®ä¾‹ï¼Œå‰é¢ç”¨Nginxåšè´Ÿè½½å‡è¡¡ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    A[Nginxè´Ÿè½½å‡è¡¡] --&gt; B[Gateway-1]
    A --&gt; C[Gateway-2]
    A --&gt; D[Gateway-3]
    
    B --&gt; E[Nacos&lt;br/&gt;æœåŠ¡å‘ç°]
    C --&gt; E
    D --&gt; E
    
    E --&gt; F[åç«¯å¾®æœåŠ¡]
</code></pre>
<h2 data-id="heading-4">ç¬¬ä¸‰æ­¥ï¼šæ•°æ®åº“æ‹†åˆ†çš„å™©æ¢¦</h2>
<p>åˆ°2023å¹´åˆï¼Œæˆ‘ä»¬å·²ç»æ‹†å‡ºæ¥äº†6ä¸ªå¾®æœåŠ¡ã€‚ä½†æœ‰ä¸ªå¤§é—®é¢˜ä¸€ç›´æ²¡è§£å†³ï¼š<strong>æ‰€æœ‰æœåŠ¡è¿˜åœ¨å…±ç”¨ä¸€ä¸ªMySQLæ•°æ®åº“ã€‚</strong></p>
<p>è¿™è¿èƒŒäº†å¾®æœåŠ¡çš„æ ¸å¿ƒåŸåˆ™ã€‚ä½†æˆ‘ä»¬ä¸æ•¢æ‹†ï¼Œå› ä¸ºï¼š</p>
<ul>
<li>ç”¨æˆ·è¡¨è¢«10ä¸ªåœ°æ–¹å¼•ç”¨</li>
<li>è®¢å•è¡¨å’Œè¯„è®ºè¡¨æœ‰å¤–é”®å…³è”</li>
<li>åˆ°å¤„éƒ½æ˜¯JOINæŸ¥è¯¢</li>
</ul>
<p>ç›´åˆ°æœ‰ä¸€å¤©ï¼ŒDBAè¯´MySQLä¸»åº“å¿«æ’‘ä¸ä½äº†ï¼Œå¿…é¡»æ‹†ã€‚</p>
<h3 data-id="heading-5">ç¬¬ä¸€æ¬¡å°è¯•ï¼šç›´æ¥æ‹†åº“</h3>
<p>æˆ‘ä»¬å…ˆæ‹¿è¯„è®ºæœåŠ¡å¼€åˆ€ï¼Œç»™å®ƒåˆ†é…äº†ç‹¬ç«‹çš„æ•°æ®åº“ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    A[ç”¨æˆ·æœåŠ¡] --&gt; B[(ç”¨æˆ·åº“)]
    C[å†…å®¹æœåŠ¡] --&gt; D[(å†…å®¹åº“)]
    E[è¯„è®ºæœåŠ¡] --&gt; F[(è¯„è®ºåº“&lt;br/&gt;æ–°å»º)]
    
    style F fill:#ccffcc
</code></pre>
<p>é—®é¢˜é©¬ä¸Šæ¥äº†ï¼šè¯„è®ºåˆ—è¡¨è¦æ˜¾ç¤ºç”¨æˆ·æ˜µç§°ï¼Œä½†ç”¨æˆ·æ•°æ®åœ¨å¦ä¸€ä¸ªåº“é‡Œã€‚</p>
<p><strong>é”™è¯¯æ–¹æ¡ˆä¸€</strong>ï¼šè¯„è®ºæœåŠ¡ç›´è¿ç”¨æˆ·æ•°æ®åº“æŸ¥è¯¢</p>
<ul>
<li>è¿èƒŒäº†å¾®æœåŠ¡åŸåˆ™ï¼ŒæœåŠ¡é—´è€¦åˆ</li>
</ul>
<p><strong>é”™è¯¯æ–¹æ¡ˆäºŒ</strong>ï¼šæ¯æ¬¡éƒ½è°ƒç”¨ç”¨æˆ·æœåŠ¡æ¥å£æŸ¥è¯¢</p>
<ul>
<li>æ€§èƒ½å¤ªå·®ï¼Œå±•ç¤º100æ¡è¯„è®ºè¦è°ƒ100æ¬¡ç”¨æˆ·æœåŠ¡</li>
</ul>
<p><strong>æœ€ç»ˆæ–¹æ¡ˆ</strong>ï¼šæ•°æ®å†—ä½™</p>
<ul>
<li>è¯„è®ºè¡¨é‡ŒåŠ ä¸€ä¸ª<code>user_name</code>å­—æ®µï¼Œå‘è¯„è®ºæ—¶å°±å­˜è¿›å»</li>
<li>ç”¨æˆ·æ”¹æ˜µç§°æ—¶ï¼Œå‘æ¶ˆæ¯é€šçŸ¥è¯„è®ºæœåŠ¡æ›´æ–°</li>
</ul>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- è¯„è®ºè¡¨è®¾è®¡</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> comments (
    id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY,
    user_id <span class="hljs-type">INT</span>,
    user_name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>),  <span class="hljs-comment">-- å†—ä½™å­—æ®µ</span>
    content TEXT,
    created_at <span class="hljs-type">TIMESTAMP</span>
);
</code></pre>
<p>å¾ˆå¤šäººè§‰å¾—è¿™æ ·ä¸"ä¼˜é›…"ï¼Œæ•°æ®é‡å¤å­˜å‚¨äº†ã€‚ä½†è¿™å°±æ˜¯å¾®æœåŠ¡çš„ä»£ä»·ï¼š<strong>ä¸ºäº†æœåŠ¡ç‹¬ç«‹ï¼Œå¿…é¡»æ¥å—ä¸€å®šç¨‹åº¦çš„æ•°æ®å†—ä½™ã€‚</strong></p>
<h3 data-id="heading-6">åˆ†å¸ƒå¼äº‹åŠ¡ï¼šèƒ½é¿å…å°±é¿å…</h3>
<p>æœ€å¤´ç–¼çš„æ˜¯å‘å¸ƒå†…å®¹çš„æµç¨‹ï¼š</p>
<ol>
<li>å†…å®¹æœåŠ¡ï¼šåˆ›å»ºå†…å®¹è®°å½•</li>
<li>ç”¨æˆ·æœåŠ¡ï¼šç”¨æˆ·ç§¯åˆ†+10</li>
<li>æ¶ˆæ¯æœåŠ¡ï¼šç»™ç²‰ä¸å‘é€šçŸ¥</li>
</ol>
<p>ä¸‰ä¸ªæ“ä½œè¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥ã€‚ä»¥å‰åœ¨ä¸€ä¸ªæ•°æ®åº“é‡Œï¼Œä¸€ä¸ªäº‹åŠ¡å°±æå®šã€‚ç°åœ¨è·¨æœåŠ¡äº†ï¼Œæ€ä¹ˆåŠï¼Ÿ</p>
<p>ç½‘ä¸Šçœ‹åˆ°çš„æ–¹æ¡ˆï¼š</p>
<ul>
<li>ä¸¤é˜¶æ®µæäº¤ï¼ˆ2PCï¼‰ï¼šå¤ªæ…¢ï¼Œè€Œä¸”åè°ƒè€…æŒ‚äº†å°±å…¨å¡ä½</li>
<li>TCCï¼šè¦å†™ä¸‰å€çš„ä»£ç ï¼Œå¤æ‚åº¦çˆ†ç‚¸</li>
<li>Seataçš„ATæ¨¡å¼ï¼šå¬èµ·æ¥ä¸é”™ï¼Œä½†æˆ‘ä»¬å›¢é˜Ÿæ²¡äººç”¨è¿‡ï¼Œä¸æ•¢ä¸Šç”Ÿäº§</li>
</ul>
<p>æˆ‘ä»¬çš„å®é™…åšæ³•ï¼šRocketMQ + è¡¥å¿</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant å®¢æˆ·ç«¯
    participant å†…å®¹æœåŠ¡
    participant RocketMQ
    participant ç”¨æˆ·æœåŠ¡
    participant æ¶ˆæ¯æœåŠ¡
    
    å®¢æˆ·ç«¯-&gt;&gt;å†…å®¹æœåŠ¡: å‘å¸ƒå†…å®¹
    å†…å®¹æœåŠ¡-&gt;&gt;å†…å®¹æœåŠ¡: 1. åˆ›å»ºå†…å®¹(å†™æ•°æ®åº“)
    å†…å®¹æœåŠ¡-&gt;&gt;RocketMQ: 2. å‘æ¶ˆæ¯: å†…å®¹å·²åˆ›å»º
    å†…å®¹æœåŠ¡--&gt;&gt;å®¢æˆ·ç«¯: è¿”å›æˆåŠŸ
    
    RocketMQ-&gt;&gt;ç”¨æˆ·æœåŠ¡: æ¶ˆè´¹æ¶ˆæ¯
    ç”¨æˆ·æœåŠ¡-&gt;&gt;ç”¨æˆ·æœåŠ¡: ç§¯åˆ†+10
    ç”¨æˆ·æœåŠ¡-&gt;&gt;ç”¨æˆ·æœåŠ¡: å¤±è´¥äº†æ€ä¹ˆåŠ?&lt;br/&gt;å†™å…¥è¡¥å¿ä»»åŠ¡è¡¨
    
    RocketMQ-&gt;&gt;æ¶ˆæ¯æœåŠ¡: æ¶ˆè´¹æ¶ˆæ¯
    æ¶ˆæ¯æœåŠ¡-&gt;&gt;æ¶ˆæ¯æœåŠ¡: å‘é€šçŸ¥ç»™ç²‰ä¸
    
    Note over ç”¨æˆ·æœåŠ¡: å®šæ—¶ä»»åŠ¡æ¯åˆ†é’Ÿæ‰«æ&lt;br/&gt;è¡¥å¿ä»»åŠ¡è¡¨ï¼Œé‡è¯•å¤±è´¥çš„æ“ä½œ
</code></pre>
<p>å†…å®¹æœåŠ¡çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ContentService</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RocketMQTemplate rocketMQTemplate;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">publishContent</span><span class="hljs-params">(Content content)</span> {
        <span class="hljs-comment">// 1. ä¿å­˜å†…å®¹åˆ°æ•°æ®åº“</span>
        contentMapper.insert(content);
        
        <span class="hljs-comment">// 2. å‘é€MQæ¶ˆæ¯</span>
        <span class="hljs-type">ContentEvent</span> <span class="hljs-variable">event</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ContentEvent</span>();
        event.setContentId(content.getId());
        event.setUserId(content.getUserId());
        
        rocketMQTemplate.convertAndSend(<span class="hljs-string">"content-topic"</span>, event);
    }
}
</code></pre>
<p>ç”¨æˆ·æœåŠ¡æ¶ˆè´¹æ¶ˆæ¯ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-meta">@RocketMQMessageListener(
    topic = "content-topic",
    consumerGroup = "user-service-group"
)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ContentEventListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RocketMQListener</span>&lt;ContentEvent&gt; {
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onMessage</span><span class="hljs-params">(ContentEvent event)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// å¢åŠ ç”¨æˆ·ç§¯åˆ†</span>
            userMapper.addPoints(event.getUserId(), <span class="hljs-number">10</span>);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-comment">// å¤±è´¥äº†å†™å…¥è¡¥å¿ä»»åŠ¡è¡¨</span>
            compensationMapper.insert(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CompensationTask</span>(
                <span class="hljs-string">"add_points"</span>, 
                event.getUserId(), 
                <span class="hljs-number">10</span>
            ));
        }
    }
}
</code></pre>
<p>è¿™ä¸ªæ–¹æ¡ˆçš„æ ¸å¿ƒï¼š</p>
<ol>
<li>å†…å®¹åˆ›å»ºæˆåŠŸåï¼Œç«‹å³è¿”å›ç»™ç”¨æˆ·</li>
<li>åç»­æ“ä½œå¼‚æ­¥è¿›è¡Œï¼Œå…è®¸çŸ­æš‚çš„ä¸ä¸€è‡´</li>
<li>å¤±è´¥äº†ç”¨è¡¥å¿æœºåˆ¶å…œåº•ï¼Œæœ€ç»ˆä¼šä¸€è‡´</li>
</ol>
<p>æœ‰ä¸€æ¬¡ç”¨æˆ·æœåŠ¡æŒ‚äº†2å°æ—¶ï¼Œç§¯åˆ†æ²¡åŠ ä¸Šã€‚ä½†é‡å¯åï¼Œè¡¥å¿ä»»åŠ¡æŠŠè¿™2å°æ—¶çš„ç§¯åˆ†éƒ½è¡¥ä¸Šäº†ï¼Œç”¨æˆ·æ— æ„ŸçŸ¥ã€‚</p>
<h2 data-id="heading-7">ç¬¬å››æ­¥ï¼šç›‘æ§ä½“ç³»æ­å»º</h2>
<p>6ä¸ªå¾®æœåŠ¡ä¸Šçº¿åï¼Œæ’æŸ¥é—®é¢˜å˜æˆäº†å™©æ¢¦ã€‚</p>
<p>ç”¨æˆ·æŠ•è¯‰ï¼š"æˆ‘å‘å¸ƒå†…å®¹å¤±è´¥äº†ã€‚"</p>
<p>æˆ‘è¦æŸ¥ä»€ä¹ˆï¼Ÿ</p>
<ul>
<li>å…ˆçœ‹Gatewayæ—¥å¿—ï¼Œçœ‹è¯·æ±‚æœ‰æ²¡æœ‰è¿›æ¥</li>
<li>å†çœ‹å†…å®¹æœåŠ¡æ—¥å¿—ï¼Œçœ‹æœ‰æ²¡æœ‰æŠ¥é”™</li>
<li>å¦‚æœå†…å®¹æœåŠ¡è°ƒç”¨äº†ç”¨æˆ·æœåŠ¡ï¼Œè¿˜è¦çœ‹ç”¨æˆ·æœåŠ¡æ—¥å¿—</li>
<li>è¿˜è¦çœ‹RocketMQæœ‰æ²¡æœ‰æ¶ˆæ¯å †ç§¯</li>
</ul>
<p>ä¸€ä¸ªé—®é¢˜è¦ç¿»5ä¸ªåœ°æ–¹çš„æ—¥å¿—ï¼Œè¿˜è¦å¯¹ç€æ—¶é—´æˆ³çŒœå“ªæ¡æ—¥å¿—æ˜¯åŒä¸€ä¸ªè¯·æ±‚çš„ã€‚</p>
<h3 data-id="heading-8">ELKæ—¥å¿—èšåˆï¼šåˆ«å†ç™»æœåŠ¡å™¨</h3>
<p>ç¬¬ä¸€æ­¥æ˜¯æŠŠæ‰€æœ‰æ—¥å¿—æ”¶é›†åˆ°ä¸€èµ·ã€‚æˆ‘ä»¬ç”¨çš„æ˜¯ELKæŠ€æœ¯æ ˆï¼š</p>
<ul>
<li>Elasticsearchï¼šå­˜å‚¨æ—¥å¿—</li>
<li>Logstashï¼šæ”¶é›†å’Œå¤„ç†æ—¥å¿—</li>
<li>Kibanaï¼šæŸ¥è¯¢ç•Œé¢</li>
</ul>
<p>æ¶æ„æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    A[å†…å®¹æœåŠ¡] --&gt;|Logback| B[Logstash]
    C[ç”¨æˆ·æœåŠ¡] --&gt;|Logback| B
    D[æ¶ˆæ¯æœåŠ¡] --&gt;|Logback| B
    E[Gateway] --&gt;|Logback| B
    
    B --&gt; F[Elasticsearch&lt;br/&gt;å­˜å‚¨æ—¥å¿—]
    F --&gt; G[Kibana&lt;br/&gt;æŸ¥è¯¢ç•Œé¢]
</code></pre>
<p>æ¯ä¸ªSpring BootæœåŠ¡çš„é…ç½®ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- pom.xml --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>net.logstash.logback<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>logstash-logback-encoder<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>7.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- logback-spring.xml --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">appender</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"LOGSTASH"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"net.logstash.logback.appender.LogstashTcpSocketAppender"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">destination</span>&gt;</span>logstash-server:5000<span class="hljs-tag">&lt;/<span class="hljs-name">destination</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">encoder</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"net.logstash.logback.encoder.LogstashEncoder"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">customFields</span>&gt;</span>{"service":"content-service"}<span class="hljs-tag">&lt;/<span class="hljs-name">customFields</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">encoder</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">appender</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">root</span> <span class="hljs-attr">level</span>=<span class="hljs-string">"INFO"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">appender-ref</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"LOGSTASH"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">root</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span>
</code></pre>
<p>å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿä»¥å‰è¦sshç™»å½•6å°æœåŠ¡å™¨çœ‹æ—¥å¿—ï¼Œç°åœ¨åœ¨Kibanaé‡Œæœç´¢å…³é”®å­—ï¼Œæ‰€æœ‰æœåŠ¡çš„ç›¸å…³æ—¥å¿—éƒ½å‡ºæ¥äº†ã€‚</p>
<h3 data-id="heading-9">SkyWalkingé“¾è·¯è¿½è¸ªï¼šæ‰¾åˆ°æ…¢åœ¨å“ª</h3>
<p>ä½†å…‰æœ‰æ—¥å¿—è¿˜ä¸å¤Ÿï¼Œæˆ‘éœ€è¦çŸ¥é“ä¸€ä¸ªè¯·æ±‚ç»è¿‡äº†å“ªäº›æœåŠ¡ï¼Œæ¯ä¸€æ­¥èŠ±äº†å¤šé•¿æ—¶é—´ã€‚</p>
<p>è¿™æ—¶å€™æˆ‘ä»¬å¼•å…¥äº†SkyWalkingã€‚å®ƒæ˜¯Apacheçš„å¼€æºé¡¹ç›®ï¼Œè·ŸSpring Cloud Alibabaé›†æˆç‰¹åˆ«å¥½ã€‚</p>
<p>éƒ¨ç½²å¾ˆç®€å•ï¼Œæ¯ä¸ªæœåŠ¡å¯åŠ¨æ—¶åŠ ä¸Šagentï¼š</p>
<pre><code class="hljs language-bash" lang="bash">java -javaagent:/path/to/skywalking-agent.jar \
     -Dskywalking.agent.service_name=content-service \
     -Dskywalking.collector.backend_service=skywalking-server:11800 \
     -jar content-service.jar
</code></pre>
<p>SkyWalkingä¼šè‡ªåŠ¨ï¼š</p>
<ol>
<li>ç»™æ¯ä¸ªè¯·æ±‚åˆ†é…ä¸€ä¸ªTraceID</li>
<li>è®°å½•è¯·æ±‚ç»è¿‡çš„æ‰€æœ‰æœåŠ¡</li>
<li>è®°å½•æ¯ä¸ªæœåŠ¡çš„å¤„ç†æ—¶é—´</li>
<li>è®°å½•æ•°æ®åº“æŸ¥è¯¢ã€HTTPè°ƒç”¨çš„è€—æ—¶</li>
</ol>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[Gateway&lt;br/&gt;TraceID: abc123&lt;br/&gt;10ms] --&gt; B[å†…å®¹æœåŠ¡&lt;br/&gt;TraceID: abc123&lt;br/&gt;50ms]
    B --&gt; C[ç”¨æˆ·æœåŠ¡&lt;br/&gt;TraceID: abc123&lt;br/&gt;200ms]
    B --&gt; D[RocketMQ&lt;br/&gt;TraceID: abc123&lt;br/&gt;5ms]
    
    style C fill:#ffcccc
</code></pre>
<p>æœ‰ä¸€æ¬¡ç”¨æˆ·è¯´"å‘å¸ƒå†…å®¹å¾ˆæ…¢"ï¼Œæˆ‘åœ¨SkyWalkingç•Œé¢ä¸€çœ‹ï¼Œå‘ç°ç”¨æˆ·æœåŠ¡çš„ä¸€ä¸ªSQLæŸ¥è¯¢èŠ±äº†180msã€‚åŸæ¥æ˜¯å¿˜äº†åŠ ç´¢å¼•ã€‚</p>
<p>æ’æŸ¥é—®é¢˜ä»ä»¥å‰çš„åŠå¤©ï¼Œç¼©çŸ­åˆ°ç°åœ¨çš„5åˆ†é’Ÿã€‚</p>
<h2 data-id="heading-10">ç¬¬äº”æ­¥ï¼šSentinelç†”æ–­é™çº§</h2>
<p>2023å¹´6æœˆï¼Œé‡åˆ°äº†ä¸€æ¬¡ä¸¥é‡æ•…éšœã€‚</p>
<p>æ¶ˆæ¯æ¨é€æœåŠ¡è°ƒç”¨äº†ç¬¬ä¸‰æ–¹æ¨é€å¹³å°çš„APIï¼Œé‚£å¤©ç¬¬ä¸‰æ–¹å¹³å°æŒ‚äº†ã€‚ç»“æœæ˜¯ï¼š</p>
<ul>
<li>æ¶ˆæ¯æœåŠ¡ç–¯ç‹‚é‡è¯•ï¼ŒæŠŠè‡ªå·±çš„CPUæ‰“æ»¡</li>
<li>å› ä¸ºæ¶ˆæ¯æœåŠ¡æ…¢ï¼Œè°ƒç”¨å®ƒçš„å†…å®¹æœåŠ¡ä¹Ÿå¼€å§‹è¶…æ—¶</li>
<li>å†…å®¹æœåŠ¡æ…¢ï¼Œå¯¼è‡´Gatewayçš„è¯·æ±‚é˜Ÿåˆ—å †ç§¯</li>
<li>æœ€ç»ˆæ•´ä¸ªç³»ç»Ÿéƒ½ä¸å¯ç”¨</li>
</ul>
<p>ä¸€ä¸ªç¬¬ä¸‰æ–¹æœåŠ¡çš„æ•…éšœï¼ŒæŠŠæˆ‘ä»¬æ•´ä¸ªç³»ç»Ÿæ‹–å®äº†ã€‚</p>
<p>è¿™æ¬¡ä¹‹åï¼Œæˆ‘ä»¬åœ¨æ‰€æœ‰æœåŠ¡é—´è°ƒç”¨ä¸Šéƒ½åŠ äº†Sentinelåšç†”æ–­é™çº§ã€‚ä¸ºä»€ä¹ˆé€‰Sentinelä¸é€‰Hystrixï¼Ÿå› ä¸ºï¼š</p>
<ol>
<li>Hystrixå·²ç»åœæ­¢ç»´æŠ¤äº†</li>
<li>Sentinelæ˜¯é˜¿é‡Œå¼€æºçš„ï¼Œè·ŸSpring Cloud AlibabaåŸç”Ÿé›†æˆ</li>
<li>Sentinelæœ‰å¯è§†åŒ–çš„æ§åˆ¶å°ï¼Œè§„åˆ™å¯ä»¥åŠ¨æ€ä¿®æ”¹</li>
</ol>
<pre><code class="hljs language-mermaid" lang="mermaid">stateDiagram-v2
    [*] --&gt; å…³é—­çŠ¶æ€
    å…³é—­çŠ¶æ€ --&gt; æ‰“å¼€çŠ¶æ€: å¤±è´¥ç‡è¶…è¿‡50%
    æ‰“å¼€çŠ¶æ€ --&gt; åŠå¼€çŠ¶æ€: 10ç§’å
    åŠå¼€çŠ¶æ€ --&gt; å…³é—­çŠ¶æ€: è°ƒç”¨æˆåŠŸ
    åŠå¼€çŠ¶æ€ --&gt; æ‰“å¼€çŠ¶æ€: è°ƒç”¨å¤±è´¥
    
    note right of å…³é—­çŠ¶æ€: æ­£å¸¸è°ƒç”¨ä¸‹æ¸¸æœåŠ¡
    note right of æ‰“å¼€çŠ¶æ€: ç›´æ¥è¿”å›é™çº§å“åº”&lt;br/&gt;ä¸è°ƒç”¨ä¸‹æ¸¸
    note right of åŠå¼€çŠ¶æ€: æ”¾ä¸€ä¸ªè¯·æ±‚è¯•æ¢&lt;br/&gt;çœ‹ä¸‹æ¸¸æ˜¯å¦æ¢å¤
</code></pre>
<p>å†…å®¹æœåŠ¡è°ƒç”¨æ¶ˆæ¯æœåŠ¡çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ContentService</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> MessageServiceClient messageServiceClient;
    
    <span class="hljs-meta">@SentinelResource(
        value = "publishContent",
        blockHandler = "publishContentBlockHandler",
        fallback = "publishContentFallback"
    )</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">publishContent</span><span class="hljs-params">(Content content)</span> {
        <span class="hljs-comment">// 1. ä¿å­˜å†…å®¹</span>
        contentMapper.insert(content);
        
        <span class="hljs-comment">// 2. è°ƒç”¨æ¶ˆæ¯æœåŠ¡é€šçŸ¥ç²‰ä¸</span>
        messageServiceClient.notifyFollowers(content.getUserId());
    }
    
    <span class="hljs-comment">// é™çº§å¤„ç†ï¼šæ¶ˆæ¯æœåŠ¡æŒ‚äº†ï¼Œå…ˆä¸é€šçŸ¥ï¼Œåå°è¡¥å¿</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">publishContentFallback</span><span class="hljs-params">(Content content, Throwable e)</span> {
        contentMapper.insert(content);
        <span class="hljs-comment">// å†™å…¥è¡¥å¿ä»»åŠ¡è¡¨ï¼Œå®šæ—¶ä»»åŠ¡åç»­ä¼šè¡¥å‘é€šçŸ¥</span>
        compensationMapper.insert(<span class="hljs-keyword">new</span> <span class="hljs-title class_">NotifyTask</span>(content.getId()));
        log.warn(<span class="hljs-string">"æ¶ˆæ¯æœåŠ¡é™çº§ï¼Œå†™å…¥è¡¥å¿ä»»åŠ¡"</span>);
    }
    
    <span class="hljs-comment">// é™æµå¤„ç†ï¼šè¯·æ±‚å¤ªå¤šç›´æ¥æ‹’ç»</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">publishContentBlockHandler</span><span class="hljs-params">(Content content, BlockException e)</span> {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BusinessException</span>(<span class="hljs-string">"ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åé‡è¯•"</span>);
    }
}
</code></pre>
<p>Sentinelçš„è§„åˆ™é…ç½®ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SentinelConfig</span> {
    
    <span class="hljs-meta">@PostConstruct</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initRules</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ç†”æ–­è§„åˆ™</span>
        List&lt;DegradeRule&gt; rules = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        <span class="hljs-type">DegradeRule</span> <span class="hljs-variable">rule</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DegradeRule</span>();
        rule.setResource(<span class="hljs-string">"publishContent"</span>);
        rule.setGrade(CircuitBreakerStrategy.ERROR_RATIO.getType());
        rule.setCount(<span class="hljs-number">0.5</span>); <span class="hljs-comment">// é”™è¯¯ç‡è¶…è¿‡50%</span>
        rule.setTimeWindow(<span class="hljs-number">10</span>); <span class="hljs-comment">// ç†”æ–­10ç§’</span>
        rule.setMinRequestAmount(<span class="hljs-number">5</span>); <span class="hljs-comment">// æœ€å°‘5ä¸ªè¯·æ±‚æ‰ç»Ÿè®¡</span>
        rules.add(rule);
        
        DegradeRuleManager.loadRules(rules);
    }
}
</code></pre>
<p>å®é™…æ•ˆæœï¼šç¬¬ä¸‰æ–¹æ¨é€å¹³å°å†æ¬¡å‡ºé—®é¢˜æ—¶ï¼ŒSentinelåœ¨1ç§’å†…ç†”æ–­äº†å¯¹æ¶ˆæ¯æœåŠ¡çš„è°ƒç”¨ï¼Œå†…å®¹å‘å¸ƒåŠŸèƒ½æ­£å¸¸å·¥ä½œï¼Œåªæ˜¯ç²‰ä¸é€šçŸ¥å»¶è¿Ÿäº†ã€‚ç­‰ç¬¬ä¸‰æ–¹å¹³å°æ¢å¤åï¼Œè¡¥å¿ä»»åŠ¡æŠŠå»¶è¿Ÿçš„é€šçŸ¥éƒ½è¡¥å‘äº†ã€‚</p>
<h2 data-id="heading-11">ç¬¬å…­æ­¥ï¼šé…ç½®ä¸­å¿ƒå’ŒæœåŠ¡å‘ç°çš„å®æˆ˜</h2>
<p>åˆ°2023å¹´åº•ï¼Œæˆ‘ä»¬å·²ç»æœ‰12ä¸ªå¾®æœåŠ¡åœ¨è¿è¡Œã€‚è¿™æ—¶å€™æ–°é—®é¢˜æ¥äº†ï¼š</p>
<p><strong>åœºæ™¯ä¸€ï¼šä¿®æ”¹ä¸€ä¸ªé…ç½®è¦é‡å¯æ‰€æœ‰æœåŠ¡</strong></p>
<p>æ¯”å¦‚ä¿®æ”¹Redisçš„è¿æ¥åœ°å€ï¼Œè¦æ”¹12ä¸ªæœåŠ¡çš„é…ç½®æ–‡ä»¶ï¼Œç„¶åé‡å¯12ä¸ªæœåŠ¡ã€‚ä¸€æ¬¡é…ç½®è°ƒæ•´è¦èŠ±åŠå°æ—¶ã€‚</p>
<p><strong>åœºæ™¯äºŒï¼šæœåŠ¡å®ä¾‹åŠ¨æ€æ‰©å®¹</strong></p>
<p>ä¸šåŠ¡é«˜å³°æœŸï¼Œæˆ‘ä»¬è¦ä¸´æ—¶å¯åŠ¨å‡ ä¸ªæœåŠ¡å®ä¾‹ã€‚ä½†å‰é¢çš„Nginxé…ç½®æ˜¯å†™æ­»çš„IPåœ°å€ï¼Œæ¯æ¬¡æ‰©å®¹éƒ½è¦æ‰‹åŠ¨æ”¹Nginxé…ç½®ã€‚</p>
<p>è¿™ä¸¤ä¸ªé—®é¢˜ï¼ŒNacoséƒ½èƒ½è§£å†³ã€‚</p>
<h3 data-id="heading-12">Nacosé…ç½®ä¸­å¿ƒï¼šä¸€å¤„ä¿®æ”¹ï¼Œå…¨å±€ç”Ÿæ•ˆ</h3>
<p>æˆ‘ä»¬æŠŠæ‰€æœ‰é…ç½®éƒ½è¿ç§»åˆ°äº†Nacosé…ç½®ä¸­å¿ƒï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    A[Nacosé…ç½®ä¸­å¿ƒ] 
    B[å†…å®¹æœåŠ¡&lt;br/&gt;å®ä¾‹1] -.åŠ¨æ€æ‹‰å–.-&gt; A
    C[å†…å®¹æœåŠ¡&lt;br/&gt;å®ä¾‹2] -.åŠ¨æ€æ‹‰å–.-&gt; A
    D[ç”¨æˆ·æœåŠ¡] -.åŠ¨æ€æ‹‰å–.-&gt; A
    E[æ¶ˆæ¯æœåŠ¡] -.åŠ¨æ€æ‹‰å–.-&gt; A
    
    style A fill:#e1f5ff
</code></pre>
<p>æœåŠ¡çš„é…ç½®æ–‡ä»¶ç®€åŒ–æˆè¿™æ ·ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># bootstrap.yml (æ¯ä¸ªæœåŠ¡éƒ½ä¸€æ ·)</span>
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">application:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">content-service</span>
  <span class="hljs-attr">cloud:</span>
    <span class="hljs-attr">nacos:</span>
      <span class="hljs-attr">config:</span>
        <span class="hljs-attr">server-addr:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-string">:8848</span>
        <span class="hljs-attr">file-extension:</span> <span class="hljs-string">yaml</span>
        <span class="hljs-attr">group:</span> <span class="hljs-string">DEFAULT_GROUP</span>
</code></pre>
<p>çœŸæ­£çš„é…ç½®éƒ½åœ¨Nacosé‡Œï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># Nacosä¸­çš„content-service.yaml</span>
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">datasource:</span>
    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://192.168.1.100:3306/content_db</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">root</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">xxx</span>
    
<span class="hljs-attr">redis:</span>
  <span class="hljs-attr">host:</span> <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.101</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">6379</span>
  
<span class="hljs-attr">rocketmq:</span>
  <span class="hljs-attr">name-server:</span> <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.102</span><span class="hljs-string">:9876</span>
</code></pre>
<p>æœ€çˆ½çš„åœ°æ–¹ï¼šåœ¨Nacosç•Œé¢ä¿®æ”¹é…ç½®åï¼Œæ‰€æœ‰æœåŠ¡<strong>ä¸ç”¨é‡å¯</strong>ï¼Œ30ç§’å†…è‡ªåŠ¨ç”Ÿæ•ˆã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RefreshScope</span>  <span class="hljs-comment">// å…³é”®æ³¨è§£ï¼šæ”¯æŒé…ç½®åŠ¨æ€åˆ·æ–°</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ContentController</span> {
    
    <span class="hljs-meta">@Value("${content.max-size}")</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> maxSize;  <span class="hljs-comment">// é…ç½®æ”¹äº†ï¼Œè¿™ä¸ªå€¼ä¼šè‡ªåŠ¨æ›´æ–°</span>
    
    <span class="hljs-meta">@PostMapping("/publish")</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">publish</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> Content content)</span> {
        <span class="hljs-keyword">if</span> (content.getLength() &gt; maxSize) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BusinessException</span>(<span class="hljs-string">"å†…å®¹è¶…é•¿"</span>);
        }
        <span class="hljs-comment">// ...</span>
    }
}
</code></pre>
<p>æœ‰ä¸€æ¬¡çº¿ä¸Šå‡ºäº†ä¸ªbugï¼Œæ˜¯å› ä¸ºé…ç½®å€¼å†™é”™äº†ã€‚ä»¥å‰è¦é‡æ–°æ‰“åŒ…ã€å‘ç‰ˆã€é‡å¯ï¼Œè‡³å°‘è¦20åˆ†é’Ÿã€‚ç°åœ¨ç›´æ¥åœ¨Nacosæ”¹é…ç½®ï¼Œ1åˆ†é’Ÿæå®šã€‚</p>
<h3 data-id="heading-13">NacosæœåŠ¡å‘ç°ï¼šè‡ªåŠ¨æ„ŸçŸ¥å®ä¾‹å˜åŒ–</h3>
<p>ä¹‹å‰æˆ‘ä»¬çš„Nginxé…ç½®æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="hljs language-nginx" lang="nginx">upstream content-service {
    server 192.168.1.10:8081;  # å†™æ­»çš„IP
    server 192.168.1.11:8081;
}
</code></pre>
<p>è¿™æ„å‘³ç€æ¯æ¬¡æ‰©å®¹æˆ–ç¼©å®¹ï¼Œéƒ½è¦æ”¹Nginxé…ç½®ï¼Œç„¶åreloadã€‚</p>
<p>ç°åœ¨æœ‰äº†NacosæœåŠ¡å‘ç°ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant æ–°å®ä¾‹
    participant Nacos
    participant Gateway
    
    æ–°å®ä¾‹-&gt;&gt;Nacos: å¯åŠ¨æ—¶æ³¨å†Œ&lt;br/&gt;IP: 192.168.1.15&lt;br/&gt;ç«¯å£: 8081
    Nacos--&gt;&gt;æ–°å®ä¾‹: æ³¨å†ŒæˆåŠŸ
    
    Note over Nacos: æœåŠ¡åˆ—è¡¨æ›´æ–°&lt;br/&gt;content-service: 3ä¸ªå®ä¾‹
    
    Gateway-&gt;&gt;Nacos: å®šæœŸæ‹‰å–æœåŠ¡åˆ—è¡¨
    Nacos--&gt;&gt;Gateway: è¿”å›æœ€æ–°å®ä¾‹åˆ—è¡¨&lt;br/&gt;[10, 11, 15]
    
    Gateway-&gt;&gt;Gateway: æ›´æ–°è·¯ç”±è¡¨
    
    Note over Gateway: ç°åœ¨3ä¸ªå®ä¾‹éƒ½ä¼šæ”¶åˆ°è¯·æ±‚
</code></pre>
<p>å®é™…æ•ˆæœï¼šæ™šä¸Š8ç‚¹ä¸šåŠ¡é«˜å³°ï¼Œæˆ‘åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash">java -jar content-service.jar --server.port=8082 &amp;
java -jar content-service.jar --server.port=8083 &amp;
</code></pre>
<p>30ç§’å†…ï¼Œè¿™ä¸¤ä¸ªæ–°å®ä¾‹å°±è‡ªåŠ¨åŠ å…¥äº†è´Ÿè½½å‡è¡¡ï¼Œå¼€å§‹åˆ†æ‹…æµé‡ã€‚å®Œå…¨ä¸ç”¨æ”¹ä»»ä½•é…ç½®æ–‡ä»¶ã€‚</p>
<h2 data-id="heading-14">ç°çŠ¶ï¼šä¸¤å¹´åçš„æ¶æ„</h2>
<p>ç°åœ¨æ˜¯2024å¹´12æœˆï¼Œè·ç¦»å¼€å§‹é‡æ„å·²ç»è¿‡å»äº†ä¸¤å¹´åŠã€‚æˆ‘ä»¬çš„æ¶æ„å˜æˆäº†è¿™æ ·ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    A[ç”¨æˆ·] --&gt; B[Nginx]
    B --&gt; C[Gateway&lt;br/&gt;é›†ç¾¤x3]
    
    C --&gt; D[Nacos&lt;br/&gt;æ³¨å†Œ&amp;é…ç½®ä¸­å¿ƒ]
    
    D --&gt; E[ç”¨æˆ·æœåŠ¡]
    D --&gt; F[å†…å®¹æœåŠ¡]
    D --&gt; G[è¯„è®ºæœåŠ¡]
    D --&gt; H[æ¶ˆæ¯æœåŠ¡]
    D --&gt; I[æ¨é€æœåŠ¡]
    D --&gt; J[æœç´¢æœåŠ¡]
    D --&gt; K[ç»Ÿè®¡æœåŠ¡]
    D --&gt; L[æ”¯ä»˜æœåŠ¡]
    
    E --&gt; M[(ç”¨æˆ·åº“)]
    F --&gt; N[(å†…å®¹åº“)]
    G --&gt; O[(è¯„è®ºåº“)]
    
    E --&gt; P[Redisé›†ç¾¤]
    F --&gt; P
    G --&gt; P
    
    F --&gt; Q[RocketMQ]
    H --&gt; Q
    I --&gt; Q
    
    R[ELK] -.æ”¶é›†æ—¥å¿—.-&gt; E
    R -.æ”¶é›†æ—¥å¿—.-&gt; F
    R -.æ”¶é›†æ—¥å¿—.-&gt; G
    
    S[SkyWalking] -.é“¾è·¯è¿½è¸ª.-&gt; C
    S -.é“¾è·¯è¿½è¸ª.-&gt; E
    S -.é“¾è·¯è¿½è¸ª.-&gt; F
    
    style C fill:#ccffcc
    style D fill:#e1f5ff
    style P fill:#fff4cc
    style Q fill:#ffe6cc
</code></pre>
<p>å…³é”®æ•°æ®å¯¹æ¯”ï¼š</p>













































<table><thead><tr><th>æŒ‡æ ‡</th><th>2022å¹´(å•ä½“)</th><th>2024å¹´(å¾®æœåŠ¡)</th></tr></thead><tbody><tr><td>æœåŠ¡æ•°é‡</td><td>1ä¸ª</td><td>15ä¸ª</td></tr><tr><td>ä»£ç åº“</td><td>1ä¸ª30ä¸‡è¡Œ</td><td>15ä¸ª(å¹³å‡1-2ä¸‡è¡Œ)</td></tr><tr><td>éƒ¨ç½²æ—¶é—´</td><td>15åˆ†é’Ÿ(å…¨é‡)</td><td>3åˆ†é’Ÿ(å•ä¸ªæœåŠ¡)</td></tr><tr><td>æ•°æ®åº“</td><td>1ä¸ªMySQL</td><td>8ä¸ªç‹¬ç«‹åº“</td></tr><tr><td>å¹³å‡å“åº”æ—¶é—´</td><td>450ms</td><td>180ms</td></tr><tr><td>æ—¥è¯·æ±‚é‡</td><td>100ä¸‡</td><td>500ä¸‡</td></tr><tr><td>åŠå¤œè¢«å«é†’æ¬¡æ•°</td><td>æœˆå‡3æ¬¡</td><td>æœˆå‡0.5æ¬¡</td></tr></tbody></table>
<h2 data-id="heading-15">è¡€æ³ªæ•™è®­ï¼šæˆ‘ä»¬è¸©è¿‡çš„å‘</h2>
<h3 data-id="heading-16">å‘1ï¼šè¿‡åº¦æ‹†åˆ†</h3>
<p>ä¸€å¼€å§‹æˆ‘ä»¬æŠŠæœåŠ¡æ‹†å¾—å¤ªç»†äº†ã€‚æ¯”å¦‚"æ–‡ä»¶ä¸Šä¼ æœåŠ¡"ã€"æ–‡ä»¶ä¸‹è½½æœåŠ¡"ã€"æ–‡ä»¶åˆ é™¤æœåŠ¡"åˆ†æˆäº†ä¸‰ä¸ªæœåŠ¡ã€‚</p>
<p>ç»“æœï¼š</p>
<ul>
<li>ç»´æŠ¤æˆæœ¬å‰§å¢ï¼šä¸‰ä¸ªä»£ç åº“ã€ä¸‰å¥—éƒ¨ç½²ã€ä¸‰å¥—ç›‘æ§</li>
<li>è°ƒç”¨é“¾è·¯å˜é•¿ï¼šä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶è¦è°ƒä¸‰ä¸ªæœåŠ¡</li>
<li>æ²¡æœ‰ä»»ä½•æ€§èƒ½æå‡</li>
</ul>
<p>åæ¥æˆ‘ä»¬æŠŠå®ƒä»¬åˆå¹¶æˆä¸€ä¸ª"æ–‡ä»¶æœåŠ¡"ã€‚</p>
<p><strong>æ•™è®­ï¼šæ‹†åˆ†çš„ç²’åº¦è¦ä»¥ä¸šåŠ¡èƒ½åŠ›ä¸ºå‡†ï¼Œä¸æ˜¯åŠŸèƒ½è¶Šç»†è¶Šå¥½ã€‚</strong></p>
<h3 data-id="heading-17">å‘2ï¼šå¿½ç•¥äº†ç½‘ç»œå»¶è¿Ÿ</h3>
<p>å•ä½“åº”ç”¨é‡Œï¼Œè°ƒç”¨ä¸€ä¸ªæ–¹æ³•å°±æ˜¯å†…å­˜æ“ä½œï¼Œå‡ ä¹æ²¡æœ‰å»¶è¿Ÿã€‚</p>
<p>å¾®æœåŠ¡é‡Œï¼Œæ¯æ¬¡è°ƒç”¨éƒ½æ˜¯HTTPè¯·æ±‚ï¼š</p>
<ul>
<li>å»ºç«‹è¿æ¥ï¼š5ms</li>
<li>åºåˆ—åŒ–æ•°æ®ï¼š2ms</li>
<li>ç½‘ç»œä¼ è¾“ï¼š10ms</li>
<li>ååºåˆ—åŒ–ï¼š2ms</li>
<li>æ€»è€—æ—¶ï¼šçº¦20ms</li>
</ul>
<p>ä¸€ä¸ªé¡µé¢å±•ç¤ºå¦‚æœè¦è°ƒç”¨5ä¸ªæœåŠ¡ï¼Œå»¶è¿Ÿå°±æ˜¯100msã€‚</p>
<p>æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆï¼š</p>
<ol>
<li>èƒ½æ‰¹é‡æŸ¥è¯¢çš„å°±æ‰¹é‡æŸ¥è¯¢</li>
<li>å‰ç«¯åˆç†èšåˆè¯·æ±‚ï¼Œå‡å°‘æ¥å£è°ƒç”¨æ¬¡æ•°</li>
<li>å…³é”®è·¯å¾„ç”¨å¼‚æ­¥å¤„ç†</li>
</ol>
<p><strong>æ•™è®­ï¼šå¾®æœåŠ¡ä¸æ˜¯é“¶å¼¹ï¼Œä¼šå¼•å…¥ç½‘ç»œå»¶è¿Ÿã€‚è¦æƒè¡¡åˆ©å¼Šã€‚</strong></p>
<h3 data-id="heading-18">å‘3ï¼šæ²¡æœ‰åšå¥½ç›‘æ§å°±ä¸Šçº¿</h3>
<p>æ¶ˆæ¯æœåŠ¡æœ€å¼€å§‹æ²¡æœ‰æ¥å…¥SkyWalkingï¼Œç»“æœå‡ºäº†é—®é¢˜å®Œå…¨ä¸çŸ¥é“æ˜¯å“ªä¸ªç¯èŠ‚æ…¢ã€‚</p>
<p>åæ¥æœ‰ä¸€æ¬¡æ•…éšœï¼Œå…‰æ’æŸ¥é—®é¢˜å°±èŠ±äº†2å°æ—¶ã€‚</p>
<p><strong>æ•™è®­ï¼šç›‘æ§å’Œå‘Šè­¦å¿…é¡»åœ¨æœåŠ¡ä¸Šçº¿å‰å°±é…ç½®å¥½ï¼Œä¸æ˜¯å‡ºé—®é¢˜äº†å†è¡¥ã€‚</strong></p>
<h3 data-id="heading-19">å‘4ï¼šåˆ†å¸ƒå¼äº‹åŠ¡æ»¥ç”¨</h3>
<p>çœ‹åˆ°ç½‘ä¸Šçš„æ–‡ç« è¯´è¦ç”¨Seataï¼Œæˆ‘ä»¬å°±å°è¯•å¼•å…¥ã€‚ç»“æœï¼š</p>
<ul>
<li>å›¢é˜Ÿæ²¡äººçœŸæ­£ç†è§£Seataçš„åŸç†</li>
<li>è°ƒè¯•å›°éš¾ï¼Œå‡ºé—®é¢˜ä¸çŸ¥é“æ€ä¹ˆæ’æŸ¥</li>
<li>åè€Œå¢åŠ äº†ç³»ç»Ÿå¤æ‚åº¦</li>
</ul>
<p>åæ¥æˆ‘ä»¬æŠŠå¤§éƒ¨åˆ†"åˆ†å¸ƒå¼äº‹åŠ¡"æ”¹æˆäº†æœ€ç»ˆä¸€è‡´æ€§æ–¹æ¡ˆï¼Œåè€Œæ›´ç¨³å®šäº†ã€‚</p>
<p><strong>æ•™è®­ï¼šä¸è¦ä¸ºäº†ç”¨æ–°æŠ€æœ¯è€Œç”¨æ–°æŠ€æœ¯ã€‚å¦‚æœä¸šåŠ¡å¯ä»¥æ¥å—æœ€ç»ˆä¸€è‡´æ€§ï¼Œå°±ä¸è¦å¼ºä¸Šåˆ†å¸ƒå¼äº‹åŠ¡ã€‚</strong></p>
<h2 data-id="heading-20">ç»™æƒ³åšå¾®æœåŠ¡æ”¹é€ çš„å›¢é˜Ÿçš„å»ºè®®</h2>
<h3 data-id="heading-21">1. å…ˆé—®è‡ªå·±ï¼šçœŸçš„éœ€è¦å¾®æœåŠ¡å—ï¼Ÿ</h3>
<p>å¦‚æœä½ çš„ç³»ç»Ÿï¼š</p>
<ul>
<li>æ—¥è¯·æ±‚é‡&lt;10ä¸‡</li>
<li>å›¢é˜Ÿ&lt;5äºº</li>
<li>å¼€å‘é€Ÿåº¦æ¯”æ€§èƒ½é‡è¦</li>
</ul>
<p><strong>å»ºè®®ï¼šå…ˆåˆ«æ‹†ã€‚</strong> æŠŠå•ä½“åº”ç”¨ä¼˜åŒ–å¥½ï¼ŒåŠ ç¼“å­˜ã€åšæ•°æ®åº“è¯»å†™åˆ†ç¦»ã€ä¼˜åŒ–SQLï¼Œæ€§èƒ½æå‡å¯èƒ½æ¯”å¾®æœåŠ¡è¿˜å¥½ã€‚</p>
<p>å¾®æœåŠ¡çš„ä»£ä»·ï¼š</p>
<ul>
<li>å¼€å‘æˆæœ¬ï¼šè°ƒè¯•å›°éš¾ï¼Œæœ¬åœ°è”è°ƒå¤æ‚</li>
<li>è¿ç»´æˆæœ¬ï¼šè¦ç»´æŠ¤æ³¨å†Œä¸­å¿ƒã€é…ç½®ä¸­å¿ƒã€ç½‘å…³ã€ç›‘æ§ç³»ç»Ÿ</li>
<li>å­¦ä¹ æˆæœ¬ï¼šå›¢é˜Ÿè¦å­¦æ–°æŠ€æœ¯æ ˆ</li>
</ul>
<p>å¦‚æœå›¢é˜Ÿå‹åŠ›å¤§ã€äººå‘˜ç´§å¼ ï¼Œè´¸ç„¶ä¸Šå¾®æœåŠ¡å¯èƒ½é›ªä¸ŠåŠ éœœã€‚</p>
<h3 data-id="heading-22">2. æ¸è¿›å¼æ”¹é€ ï¼Œä¸è¦æ¨å€’é‡æ¥</h3>
<p>æˆ‘è§è¿‡å¤ªå¤šå¤±è´¥çš„æ¡ˆä¾‹ï¼š</p>
<ul>
<li>äº§å“è¯´ç­‰ä½ ä»¬ä¸‰ä¸ªæœˆï¼Œä¸‰ä¸ªæœˆåæ–°ç³»ç»Ÿä¸Šçº¿</li>
<li>ç»“æœå¼€å‘å‘ç°ä½ä¼°äº†å¤æ‚åº¦ï¼Œä¸‰ä¸ªæœˆå˜æˆäº†å…­ä¸ªæœˆ</li>
<li>è€ç³»ç»Ÿè¿˜è¦ç»§ç»­æ”¹bugï¼Œæ–°ç³»ç»Ÿè¿›åº¦å»¶æœŸ</li>
<li>æœ€åæ–°ç³»ç»Ÿè‰è‰ä¸Šçº¿ï¼Œé—®é¢˜ä¸€å †</li>
</ul>
<p><strong>æ­£ç¡®åšæ³•ï¼š</strong></p>
<ol>
<li>è€ç³»ç»Ÿç»§ç»­è·‘ï¼Œæ»¡è¶³æ—¥å¸¸éœ€æ±‚</li>
<li>æ–°åŠŸèƒ½ç”¨å¾®æœåŠ¡å¼€å‘</li>
<li>è€ç³»ç»Ÿçš„æ¨¡å—ï¼Œæ‰¾åˆ°è¾¹ç•Œæ¸…æ™°çš„å…ˆæ‹†å‡ºæ¥</li>
<li>ä¸€ä¸ªä¸€ä¸ªæ…¢æ…¢èš•é£Ÿï¼Œç”¨1-2å¹´æ—¶é—´å®Œæˆè¿ç§»</li>
</ol>
<h3 data-id="heading-23">3. æŠ€æœ¯é€‰å‹ï¼šå¤Ÿç”¨å°±å¥½</h3>
<p>æˆ‘ä»¬é€‰Spring Cloud Alibabaï¼Œä¸æ˜¯å› ä¸ºå®ƒæœ€å¥½ï¼Œè€Œæ˜¯å› ä¸ºï¼š</p>
<ul>
<li>å›¢é˜Ÿç†Ÿæ‚‰Spring</li>
<li>ä¸­æ–‡æ–‡æ¡£å¤šï¼Œå‡ºé—®é¢˜èƒ½æœåˆ°ç­”æ¡ˆ</li>
<li>ç¤¾åŒºæ´»è·ƒï¼Œæœ‰é—®é¢˜èƒ½æ‰¾åˆ°äººé—®</li>
</ul>
<p>ç›¸åï¼Œå¦‚æœé€‰äº†æŸä¸ªç‰¹åˆ«æ–°ã€ç‰¹åˆ«é…·çš„æŠ€æœ¯ï¼Œå‡ºäº†é—®é¢˜å¯èƒ½è¿Googleéƒ½æœä¸åˆ°ç­”æ¡ˆã€‚</p>
<h3 data-id="heading-24">4. ç›‘æ§æ¯”ä½ æƒ³è±¡çš„é‡è¦100å€</h3>
<p>ä¸å¤¸å¼ åœ°è¯´ï¼Œç›‘æ§ç³»ç»Ÿæ•‘äº†æˆ‘ä»¬æ— æ•°æ¬¡ã€‚</p>
<p>å¿…é¡»è¦æœ‰çš„ç›‘æ§ï¼š</p>
<ul>
<li><strong>æ—¥å¿—èšåˆ</strong>(ELK)ï¼šæ‰€æœ‰æ—¥å¿—é›†ä¸­æŸ¥çœ‹</li>
<li><strong>é“¾è·¯è¿½è¸ª</strong>(SkyWalking)ï¼šçŸ¥é“è¯·æ±‚ç»è¿‡äº†å“ªäº›æœåŠ¡</li>
<li><strong>æŒ‡æ ‡ç›‘æ§</strong>(Prometheus)ï¼šCPUã€å†…å­˜ã€QPSå®æ—¶ç›‘æ§</li>
<li><strong>ä¸šåŠ¡ç›‘æ§</strong>ï¼šæ”¯ä»˜æˆåŠŸç‡ã€æ³¨å†Œè½¬åŒ–ç‡ç­‰å…³é”®æŒ‡æ ‡</li>
</ul>
<p>è¿™äº›ç›‘æ§ç³»ç»Ÿï¼Œå»ºè®®åœ¨ç¬¬ä¸€ä¸ªå¾®æœåŠ¡ä¸Šçº¿å‰å°±æ­å»ºå¥½ã€‚</p>
<h3 data-id="heading-25">5. æ–‡æ¡£å’Œè§„èŒƒï¼šçœä¸äº†</h3>
<p>å¾®æœåŠ¡å¤šäº†ä»¥åï¼Œå¦‚æœæ²¡æœ‰ç»Ÿä¸€çš„è§„èŒƒï¼Œä¼šä¸€å›¢ä¹±ï¼š</p>
<ul>
<li>æœ‰çš„æœåŠ¡ç”¨RESTfulï¼Œæœ‰çš„ç”¨RPC</li>
<li>æœ‰çš„è¿”å›é©¼å³°ï¼Œæœ‰çš„è¿”å›ä¸‹åˆ’çº¿</li>
<li>å¼‚å¸¸å¤„ç†æ–¹å¼äº”èŠ±å…«é—¨</li>
</ul>
<p>æˆ‘ä»¬åæ¥å®šäº†å‡ ä¸ªè§„èŒƒï¼š</p>
<ul>
<li>ç»Ÿä¸€çš„é”™è¯¯ç è®¾è®¡</li>
<li>ç»Ÿä¸€çš„æ—¥å¿—æ ¼å¼</li>
<li>ç»Ÿä¸€çš„æ¥å£è¿”å›ç»“æ„</li>
<li>æ¯ä¸ªæœåŠ¡å¿…é¡»æœ‰æ¥å£æ–‡æ¡£(ç”¨Swagger)</li>
</ul>
<p>è™½ç„¶å‰æœŸä¼šè§‰å¾—éº»çƒ¦ï¼Œä½†é•¿è¿œçœ‹èƒ½çœå¾ˆå¤šæ²Ÿé€šæˆæœ¬ã€‚</p>
<h2 data-id="heading-26">å†™åœ¨æœ€å</h2>
<p>ä»é‚£ä¸ªå‡Œæ™¨ç”µè¯ï¼Œåˆ°ç°åœ¨ç³»ç»Ÿç¨³å®šè¿è¡Œï¼Œè¿™ä¸¤å¹´åŠæˆ‘ä»¬å­¦åˆ°äº†å¾ˆå¤šã€‚</p>
<p>å¾®æœåŠ¡ä¸æ˜¯é“¶å¼¹ï¼Œå®ƒè§£å†³äº†æˆ‘ä»¬çš„æ‰©å±•æ€§é—®é¢˜ï¼Œä½†ä¹Ÿå¸¦æ¥äº†å¤æ‚åº¦ã€‚å¦‚æœé‡æ–°é€‰æ‹©ï¼Œæˆ‘å¯èƒ½ä¼šï¼š</p>
<ul>
<li>æ›´æ™šæ‰å¼€å§‹æ‹†åˆ†ï¼ŒæŠŠå•ä½“ä¼˜åŒ–åˆ°æé™</li>
<li>åˆæœŸæ‹†å¾—æ›´ä¿å®ˆï¼Œåªæ‹†æœ€å¿…è¦çš„éƒ¨åˆ†</li>
<li>åœ¨æ‹†åˆ†å‰å…ˆæŠŠç›‘æ§ä½“ç³»æ­å»ºå¥½</li>
</ul>
<p>ä½†ä¸ç®¡æ€æ ·ï¼Œå¯¹äºæˆ‘ä»¬å½“æ—¶çš„åœºæ™¯ï¼Œå¾®æœåŠ¡æ”¹é€ æ˜¯æ­£ç¡®çš„é€‰æ‹©ã€‚ç³»ç»Ÿç¨³å®šäº†ï¼Œæˆ‘ä¹Ÿç»ˆäºå¯ä»¥ç¡ä¸ªå®‰ç¨³è§‰äº†ã€‚</p>
<p>å¦‚æœä½ çš„å›¢é˜Ÿä¹Ÿåœ¨è€ƒè™‘å¾®æœåŠ¡æ”¹é€ ï¼Œå¸Œæœ›æˆ‘ä»¬çš„ç»éªŒèƒ½å¸®åˆ°ä½ ã€‚è®°ä½ï¼š<strong>æ²¡æœ‰å®Œç¾çš„æ¶æ„ï¼Œåªæœ‰åˆé€‚çš„æ¶æ„ã€‚</strong></p>
<hr/>
<p><strong>2025å¹´12æœˆè®°äºä¸Šæµ·</strong></p>
<p><em>ä½œè€…åœ¨æŸäº’è”ç½‘å…¬å¸ä»»åç«¯æ¶æ„å¸ˆï¼Œè´Ÿè´£è¿‡å¤šä¸ªç³»ç»Ÿçš„å¾®æœåŠ¡æ”¹é€ ã€‚æœ¬æ–‡æ‰€æœ‰æŠ€æœ¯ç»†èŠ‚å‡æ¥è‡ªçœŸå®é¡¹ç›®ç»éªŒï¼Œéƒ¨åˆ†ä¸šåŠ¡æ•°æ®åšäº†è„±æ•å¤„ç†ã€‚</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºä»€ä¹ˆä½ çš„Pythonä»£ç é‚£ä¹ˆä¹±ï¼Ÿå› ä¸ºä½ ä¸ä¼šç”¨è£…é¥°å™¨]]></title>    <link>https://juejin.cn/post/7580547126361571391</link>    <guid>https://juejin.cn/post/7580547126361571391</guid>    <pubDate>2025-12-08T01:08:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580547126361571391" data-draft-id="7580547126361555007" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºä»€ä¹ˆä½ çš„Pythonä»£ç é‚£ä¹ˆä¹±ï¼Ÿå› ä¸ºä½ ä¸ä¼šç”¨è£…é¥°å™¨"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-08T01:08:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·6854537597769"/> <meta itemprop="url" content="https://juejin.cn/user/1601315325621550"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºä»€ä¹ˆä½ çš„Pythonä»£ç é‚£ä¹ˆä¹±ï¼Ÿå› ä¸ºä½ ä¸ä¼šç”¨è£…é¥°å™¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1601315325621550/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·6854537597769
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T01:08:31.000Z" title="Mon Dec 08 2025 01:08:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½ æœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™ç§æƒ…å†µï¼š</p>
<p>é¡¹ç›®é‡Œåˆ°å¤„éƒ½æ˜¯è¿™æ ·çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">user_login</span>():
    start_time = time.time()
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{datetime.now()}</span>] å¼€å§‹æ‰§è¡Œç”¨æˆ·ç™»å½•"</span>)

    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># ä¸šåŠ¡é€»è¾‘</span>
        result = authenticate_user()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{datetime.now()}</span>] ç”¨æˆ·ç™»å½•æˆåŠŸ"</span>)
        <span class="hljs-keyword">return</span> result
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{datetime.now()}</span>] ç”¨æˆ·ç™»å½•å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
        <span class="hljs-keyword">raise</span>
    <span class="hljs-keyword">finally</span>:
        end_time = time.time()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{datetime.now()}</span>] ç™»å½•è€—æ—¶: <span class="hljs-subst">{end_time - start_time:<span class="hljs-number">.2</span>f}</span>ç§’"</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">user_register</span>():
    start_time = time.time()
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{datetime.now()}</span>] å¼€å§‹æ‰§è¡Œç”¨æˆ·æ³¨å†Œ"</span>)

    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># ä¸šåŠ¡é€»è¾‘</span>
        result = create_user()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{datetime.now()}</span>] ç”¨æˆ·æ³¨å†ŒæˆåŠŸ"</span>)
        <span class="hljs-keyword">return</span> result
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{datetime.now()}</span>] ç”¨æˆ·æ³¨å†Œå¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
        <span class="hljs-keyword">raise</span>
    <span class="hljs-keyword">finally</span>:
        end_time = time.time()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{datetime.now()}</span>] æ³¨å†Œè€—æ—¶: <span class="hljs-subst">{end_time - start_time:<span class="hljs-number">.2</span>f}</span>ç§’"</span>)
</code></pre>
<p>æ¯ä¸ªå‡½æ•°éƒ½è¦é‡å¤å†™æ—¥å¿—ã€å¼‚å¸¸å¤„ç†ã€æ€§èƒ½ç»Ÿè®¡çš„ä»£ç ...</p>
<p>ç„¶åä½ ç™¾åº¦äº†ä¸€åœˆï¼ŒStack Overflowç¿»äº†ä¸‰é¡µï¼Œæœ€åå‘ç°æœ‰ä¸ªå«"è£…é¥°å™¨"çš„ä¸œè¥¿ã€‚</p>
<p>ä»Šå¤©å’±ä»¬å°±æ¥å½»åº•ææ‡‚è¿™ä¸ªè®©ä»£ç ç¬é—´å˜ä¼˜é›…çš„ç¥å™¨ã€‚</p>
<h2 data-id="heading-0">è£…é¥°å™¨åˆ°åº•æ˜¯å•¥ç©æ„å„¿ï¼Ÿ</h2>
<p><strong>ä¸€å¥è¯è§£é‡Šï¼šè£…é¥°å™¨å°±æ˜¯ä¸€ä¸ª"åŒ…è£…å·¥"ï¼Œå®ƒæŠŠä½ çš„å‡½æ•°é‡æ–°åŒ…è£…ä¸€ä¸‹ï¼ŒåŠ ç‚¹æ–°åŠŸèƒ½ã€‚</strong></p>
<p>æƒ³è±¡ä¸€ä¸‹ä½ å»å¥¶èŒ¶åº—ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">åŸå§‹å‡½æ•° = åŸºç¡€å¥¶èŒ¶ï¼ˆçç å¥¶èŒ¶ï¼‰
è£…é¥°å™¨ = åŠ æ–™æœåŠ¡ï¼ˆåŠ çç ã€åŠ æ¤°æœã€åŠ å¸ƒä¸ï¼‰
@<span class="hljs-attr">decorator</span> = ç›´æ¥è¯´<span class="hljs-string">"æˆ‘è¦åŠ çç "</span>
</code></pre>
<p>ä½ æ²¡åŠ è£…é¥°å™¨ä¹‹å‰ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ™®é€šçç å¥¶èŒ¶</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_milk_tea</span>():
    <span class="hljs-keyword">return</span> <span class="hljs-string">"çç å¥¶èŒ¶"</span>
</code></pre>
<p>åŠ äº†è£…é¥°å™¨ä¹‹åï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@add_pearls  </span><span class="hljs-comment"># ç›¸å½“äºï¼šget_milk_tea = add_pearls(get_milk_tea)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_milk_tea</span>():
    <span class="hljs-keyword">return</span> <span class="hljs-string">"çç å¥¶èŒ¶"</span>

<span class="hljs-comment"># ç°åœ¨è¿™æ¯å¥¶èŒ¶è‡ªåŠ¨åŠ äº†çç ï¼Œè¿˜é€äº†ä½ å¸ç®¡</span>
</code></pre>
<p><strong>æœ¬è´¨ä¸Šï¼Œ<code>@decorator</code> åªæ˜¯è¯­æ³•ç³–ï¼ŒçœŸæ­£çš„æ‰§è¡Œæ˜¯ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># è¿™ä¸¤ç§å†™æ³•å®Œå…¨ç­‰ä»·ï¼š</span>
<span class="hljs-meta">@decorator</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>():
    <span class="hljs-keyword">pass</span>

<span class="hljs-comment"># ç­‰ä»·äºï¼š</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>():
    <span class="hljs-keyword">pass</span>
func = decorator(func)
</code></pre>
<h2 data-id="heading-1">å…ˆçœ‹çœ‹æœ€ç®€å•çš„è£…é¥°å™¨</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> time
<span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> wraps

<span class="hljs-keyword">def</span> <span class="hljs-title function_">timer_decorator</span>(<span class="hljs-params">func</span>):
<span class="hljs-meta">    @wraps(<span class="hljs-params">func</span>)  </span><span class="hljs-comment"># è¿™ä¸ªå¾ˆé‡è¦ï¼Œåé¢è®²ä¸ºä»€ä¹ˆ</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">wrapper</span>(<span class="hljs-params">*args, **kwargs</span>):
        start_time = time.time()
        result = func(*args, **kwargs)
        end_time = time.time()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{func.__name__}</span> æ‰§è¡Œè€—æ—¶: <span class="hljs-subst">{end_time - start_time:<span class="hljs-number">.2</span>f}</span>ç§’"</span>)
        <span class="hljs-keyword">return</span> result
    <span class="hljs-keyword">return</span> wrapper

<span class="hljs-meta">@timer_decorator</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">slow_function</span>():
    time.sleep(<span class="hljs-number">1</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">"æˆ‘æ‰§è¡Œå®Œäº†"</span>

result = slow_function()
<span class="hljs-comment"># è¾“å‡º: slow_function æ‰§è¡Œè€—æ—¶: 1.00ç§’</span>
</code></pre>
<p>çœ‹åˆ°äº†å—ï¼ŸåŸæœ¬éœ€è¦æ¯ä¸ªå‡½æ•°éƒ½å†™çš„è®¡æ—¶ä»£ç ï¼Œç°åœ¨åªéœ€è¦ä¸€ä¸ª<code>@timer_decorator</code>å°±æå®šäº†ï¼</p>
<h2 data-id="heading-2">ä½†æ˜¯ï¼åˆ«æ€¥ç€ç”¨ï¼Œå…ˆææ‡‚è¿™å‡ ä¸ªå‘</h2>
<h3 data-id="heading-3">å‘1ï¼šå‡½æ•°ä¿¡æ¯ä¸¢å¤±çš„é—®é¢˜</h3>
<p>âŒ <strong>é”™è¯¯å†™æ³•ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">timer_decorator</span>(<span class="hljs-params">func</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">wrapper</span>(<span class="hljs-params">*args, **kwargs</span>):
        start_time = time.time()
        result = func(*args, **kwargs)
        end_time = time.time()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{func.__name__}</span> æ‰§è¡Œè€—æ—¶: <span class="hljs-subst">{end_time - start_time:<span class="hljs-number">.2</span>f}</span>ç§’"</span>)
        <span class="hljs-keyword">return</span> result
    <span class="hljs-keyword">return</span> wrapper

<span class="hljs-meta">@timer_decorator</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">my_awesome_function</span>():
    <span class="hljs-string">"""è¿™ä¸ªå‡½æ•°å¾ˆå‰å®³ï¼Œèƒ½æ‹¯æ•‘ä¸–ç•Œ"""</span>
    <span class="hljs-keyword">pass</span>

<span class="hljs-built_in">print</span>(my_awesome_function.__name__)  <span class="hljs-comment"># è¾“å‡º: wrapper (ä¸æ˜¯my_awesome_function!)</span>
<span class="hljs-built_in">print</span>(my_awesome_function.__doc__)   <span class="hljs-comment"># è¾“å‡º: None (æ–‡æ¡£è¯´æ˜ä¸¢äº†!)</span>
</code></pre>
<p>âœ… <strong>æ­£ç¡®å†™æ³•ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> wraps

<span class="hljs-keyword">def</span> <span class="hljs-title function_">timer_decorator</span>(<span class="hljs-params">func</span>):
<span class="hljs-meta">    @wraps(<span class="hljs-params">func</span>)  </span><span class="hljs-comment"># è®°ä½è¿™ä¸ªï¼å®ƒä¼šæŠŠåŸå‡½æ•°çš„ä¿¡æ¯å¤åˆ¶è¿‡æ¥</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">wrapper</span>(<span class="hljs-params">*args, **kwargs</span>):
        start_time = time.time()
        result = func(*args, **kwargs)
        end_time = time.time()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{func.__name__}</span> æ‰§è¡Œè€—æ—¶: <span class="hljs-subst">{end_time - start_time:<span class="hljs-number">.2</span>f}</span>ç§’"</span>)
        <span class="hljs-keyword">return</span> result
    <span class="hljs-keyword">return</span> wrapper

<span class="hljs-meta">@timer_decorator</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">my_awesome_function</span>():
    <span class="hljs-string">"""è¿™ä¸ªå‡½æ•°å¾ˆå‰å®³ï¼Œèƒ½æ‹¯æ•‘ä¸–ç•Œ"""</span>
    <span class="hljs-keyword">pass</span>

<span class="hljs-built_in">print</span>(my_awesome_function.__name__)  <span class="hljs-comment"># è¾“å‡º: my_awesome_function âœ“</span>
<span class="hljs-built_in">print</span>(my_awesome_function.__doc__)   <span class="hljs-comment"># è¾“å‡º: è¿™ä¸ªå‡½æ•°å¾ˆå‰å®³ï¼Œèƒ½æ‹¯æ•‘ä¸–ç•Œ âœ“</span>
</code></pre>
<p><strong><code>@wraps(func)</code> å°±æ˜¯å‡½æ•°ä¿¡æ¯çš„"å¤å°æœº"ï¼ŒæŠŠåŸå‡½æ•°çš„åå­—ã€æ–‡æ¡£ã€å‚æ•°ä¿¡æ¯å…¨éƒ¨å¤åˆ¶åˆ°è£…é¥°å™¨å‡½æ•°ä¸Šã€‚</strong></p>
<h3 data-id="heading-4">å‘2ï¼šå¸¦å‚æ•°çš„è£…é¥°å™¨</h3>
<p>æœ‰æ—¶å€™ä½ æƒ³ç»™è£…é¥°å™¨ä¼ å‚æ•°ï¼Œæ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@repeat(<span class="hljs-params"><span class="hljs-number">3</span></span>)  </span><span class="hljs-comment"># æ‰§è¡Œ3æ¬¡</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">test_function</span>():
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"æµ‹è¯•ä¸­..."</span>)
</code></pre>
<p>è¿™æ—¶å€™å°±éœ€è¦<strong>è£…é¥°å™¨å·¥å‚</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">repeat</span>(<span class="hljs-params">times</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decorator</span>(<span class="hljs-params">func</span>):
<span class="hljs-meta">        @wraps(<span class="hljs-params">func</span>)</span>
        <span class="hljs-keyword">def</span> <span class="hljs-title function_">wrapper</span>(<span class="hljs-params">*args, **kwargs</span>):
            results = []
            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(times):
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç¬¬ <span class="hljs-subst">{i+<span class="hljs-number">1</span>}</span> æ¬¡æ‰§è¡Œ:"</span>)
                result = func(*args, **kwargs)
                results.append(result)
            <span class="hljs-keyword">return</span> results
        <span class="hljs-keyword">return</span> wrapper
    <span class="hljs-keyword">return</span> decorator

<span class="hljs-meta">@repeat(<span class="hljs-params"><span class="hljs-number">3</span></span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">test_function</span>():
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"æµ‹è¯•ä¸­..."</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">"æˆåŠŸ"</span>

<span class="hljs-comment"># ç­‰ä»·äºï¼štest_function = repeat(3)(test_function)</span>
results = test_function()
</code></pre>
<p><strong>è®°ä½è¿™ä¸ªå…¬å¼ï¼šå¸¦å‚æ•°çš„è£…é¥°å™¨ = ä¸‰å±‚åµŒå¥—å‡½æ•°</strong></p>
<h3 data-id="heading-5">å‘3ï¼šè£…é¥°å™¨çš„æ‰§è¡Œé¡ºåº</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@decorator1</span>
<span class="hljs-meta">@decorator2</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">my_function</span>():
    <span class="hljs-keyword">pass</span>

<span class="hljs-comment"># æ‰§è¡Œé¡ºåºç›¸å½“äºï¼šmy_function = decorator1(decorator2(my_function))</span>
<span class="hljs-comment"># ä¹Ÿå°±æ˜¯ï¼šå…ˆæ‰§è¡Œdecorator2ï¼Œå†æ‰§è¡Œdecorator1</span>
</code></pre>
<h2 data-id="heading-6">å®æˆ˜ï¼šè§£å†³çœŸå®é¡¹ç›®ä¸­çš„é‡å¤ä»£ç </h2>
<h3 data-id="heading-7">åœºæ™¯1ï¼šAPIæ¥å£çš„æ—¥å¿—è®°å½•</h3>
<p>âŒ <strong>é‡å¤ä»£ç åœ°ç‹±ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_user_info</span>(<span class="hljs-params">user_id</span>):
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{datetime.now()}</span>] APIè°ƒç”¨: get_user_info, å‚æ•°: <span class="hljs-subst">{user_id}</span>"</span>)

    <span class="hljs-keyword">try</span>:
        result = database.query_user(user_id)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{datetime.now()}</span>] APIè°ƒç”¨æˆåŠŸ: è¿”å›ç”¨æˆ·ä¿¡æ¯"</span>)
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"status"</span>: <span class="hljs-string">"success"</span>, <span class="hljs-string">"data"</span>: result}
    <span class="hljs-keyword">except</span> DatabaseError <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{datetime.now()}</span>] æ•°æ®åº“é”™è¯¯: <span class="hljs-subst">{e}</span>"</span>)
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"status"</span>: <span class="hljs-string">"error"</span>, <span class="hljs-string">"message"</span>: <span class="hljs-string">"æ•°æ®åº“æŸ¥è¯¢å¤±è´¥"</span>}
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{datetime.now()}</span>] æœªçŸ¥é”™è¯¯: <span class="hljs-subst">{e}</span>"</span>)
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"status"</span>: <span class="hljs-string">"error"</span>, <span class="hljs-string">"message"</span>: <span class="hljs-string">"æœåŠ¡å™¨å†…éƒ¨é”™è¯¯"</span>}

<span class="hljs-keyword">def</span> <span class="hljs-title function_">create_user</span>(<span class="hljs-params">user_data</span>):
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{datetime.now()}</span>] APIè°ƒç”¨: create_user, å‚æ•°: <span class="hljs-subst">{user_data}</span>"</span>)

    <span class="hljs-keyword">try</span>:
        result = database.insert_user(user_data)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{datetime.now()}</span>] APIè°ƒç”¨æˆåŠŸ: ç”¨æˆ·åˆ›å»ºæˆåŠŸ"</span>)
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"status"</span>: <span class="hljs-string">"success"</span>, <span class="hljs-string">"data"</span>: result}
    <span class="hljs-keyword">except</span> DatabaseError <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{datetime.now()}</span>] æ•°æ®åº“é”™è¯¯: <span class="hljs-subst">{e}</span>"</span>)
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"status"</span>: <span class="hljs-string">"error"</span>, <span class="hljs-string">"message"</span>: <span class="hljs-string">"æ•°æ®åº“æ’å…¥å¤±è´¥"</span>}
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{datetime.now()}</span>] æœªçŸ¥é”™è¯¯: <span class="hljs-subst">{e}</span>"</span>)
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"status"</span>: <span class="hljs-string">"error"</span>, <span class="hljs-string">"message"</span>: <span class="hljs-string">"æœåŠ¡å™¨å†…éƒ¨é”™è¯¯"</span>}
</code></pre>
<p>âœ… <strong>ä¼˜é›…çš„è£…é¥°å™¨æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> wraps
<span class="hljs-keyword">import</span> json
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime

<span class="hljs-keyword">def</span> <span class="hljs-title function_">api_logger</span>(<span class="hljs-params">func</span>):
<span class="hljs-meta">    @wraps(<span class="hljs-params">func</span>)</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">wrapper</span>(<span class="hljs-params">*args, **kwargs</span>):
        <span class="hljs-comment"># è®°å½•è¯·æ±‚</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{datetime.now()}</span>] APIè°ƒç”¨: <span class="hljs-subst">{func.__name__}</span>, å‚æ•°: <span class="hljs-subst">{args}</span>, <span class="hljs-subst">{kwargs}</span>"</span>)

        <span class="hljs-keyword">try</span>:
            result = func(*args, **kwargs)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{datetime.now()}</span>] APIè°ƒç”¨æˆåŠŸ: <span class="hljs-subst">{func.__name__}</span>"</span>)
            <span class="hljs-keyword">return</span> {<span class="hljs-string">"status"</span>: <span class="hljs-string">"success"</span>, <span class="hljs-string">"data"</span>: result}
        <span class="hljs-keyword">except</span> DatabaseError <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{datetime.now()}</span>] æ•°æ®åº“é”™è¯¯: <span class="hljs-subst">{e}</span>"</span>)
            <span class="hljs-keyword">return</span> {<span class="hljs-string">"status"</span>: <span class="hljs-string">"error"</span>, <span class="hljs-string">"message"</span>: <span class="hljs-string">"æ•°æ®åº“æ“ä½œå¤±è´¥"</span>}
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{datetime.now()}</span>] æœªçŸ¥é”™è¯¯: <span class="hljs-subst">{e}</span>"</span>)
            <span class="hljs-keyword">return</span> {<span class="hljs-string">"status"</span>: <span class="hljs-string">"error"</span>, <span class="hljs-string">"message"</span>: <span class="hljs-string">"æœåŠ¡å™¨å†…éƒ¨é”™è¯¯"</span>}
    <span class="hljs-keyword">return</span> wrapper

<span class="hljs-meta">@api_logger</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_user_info</span>(<span class="hljs-params">user_id</span>):
    <span class="hljs-keyword">return</span> database.query_user(user_id)

<span class="hljs-meta">@api_logger</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">create_user</span>(<span class="hljs-params">user_data</span>):
    <span class="hljs-keyword">return</span> database.insert_user(user_data)

<span class="hljs-comment"># çœ‹çœ‹å¤šç®€æ´ï¼ä¸šåŠ¡é€»è¾‘å’Œæ—¥å¿—å¤„ç†å®Œå…¨åˆ†ç¦»</span>
</code></pre>
<h3 data-id="heading-8">åœºæ™¯2ï¼šæƒé™éªŒè¯</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">admin_required</span>(<span class="hljs-params">func</span>):
<span class="hljs-meta">    @wraps(<span class="hljs-params">func</span>)</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">wrapper</span>(<span class="hljs-params">*args, **kwargs</span>):
        <span class="hljs-comment"># å‡è®¾ä»sessionæˆ–tokenä¸­è·å–ç”¨æˆ·ä¿¡æ¯</span>
        current_user = get_current_user()

        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> current_user:
            <span class="hljs-keyword">raise</span> PermissionError(<span class="hljs-string">"è¯·å…ˆç™»å½•"</span>)

        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> current_user.is_admin:
            <span class="hljs-keyword">raise</span> PermissionError(<span class="hljs-string">"éœ€è¦ç®¡ç†å‘˜æƒé™"</span>)

        <span class="hljs-keyword">return</span> func(*args, **kwargs)
    <span class="hljs-keyword">return</span> wrapper

<span class="hljs-meta">@admin_required</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">delete_user</span>(<span class="hljs-params">user_id</span>):
    <span class="hljs-comment"># åªæœ‰ç®¡ç†å‘˜èƒ½åˆ é™¤ç”¨æˆ·</span>
    database.delete_user(user_id)

<span class="hljs-meta">@admin_required</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">view_system_logs</span>():
    <span class="hljs-comment"># åªæœ‰ç®¡ç†å‘˜èƒ½æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—</span>
    <span class="hljs-keyword">return</span> database.get_system_logs()
</code></pre>
<h3 data-id="heading-9">åœºæ™¯3ï¼šç¼“å­˜è£…é¥°å™¨</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> time
<span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> wraps

<span class="hljs-keyword">def</span> <span class="hljs-title function_">cache</span>(<span class="hljs-params">expire_time=<span class="hljs-number">60</span></span>):
    <span class="hljs-string">"""ç¼“å­˜è£…é¥°å™¨ï¼Œexpire_timeå•ä½æ˜¯ç§’"""</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decorator</span>(<span class="hljs-params">func</span>):
        func._cache = {}  <span class="hljs-comment"># æŠŠç¼“å­˜å­˜å‚¨åœ¨å‡½æ•°çš„å±æ€§é‡Œ</span>

<span class="hljs-meta">        @wraps(<span class="hljs-params">func</span>)</span>
        <span class="hljs-keyword">def</span> <span class="hljs-title function_">wrapper</span>(<span class="hljs-params">*args, **kwargs</span>):
            <span class="hljs-comment"># ç”Ÿæˆç¼“å­˜keyï¼ˆæŠŠå‚æ•°è½¬æˆå­—ç¬¦ä¸²ï¼‰</span>
            cache_key = <span class="hljs-built_in">str</span>(args) + <span class="hljs-built_in">str</span>(<span class="hljs-built_in">sorted</span>(kwargs.items()))

            current_time = time.time()

            <span class="hljs-comment"># æ£€æŸ¥ç¼“å­˜æ˜¯å¦å­˜åœ¨ä¸”æœªè¿‡æœŸ</span>
            <span class="hljs-keyword">if</span> cache_key <span class="hljs-keyword">in</span> func._cache:
                cached_result, cached_time = func._cache[cache_key]
                <span class="hljs-keyword">if</span> current_time - cached_time &lt; expire_time:
                    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ä½¿ç”¨ç¼“å­˜: <span class="hljs-subst">{func.__name__}</span>(<span class="hljs-subst">{cache_key}</span>)"</span>)
                    <span class="hljs-keyword">return</span> cached_result

            <span class="hljs-comment"># æ‰§è¡ŒåŸå‡½æ•°</span>
            result = func(*args, **kwargs)

            <span class="hljs-comment"># å­˜å…¥ç¼“å­˜</span>
            func._cache[cache_key] = (result, current_time)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç¼“å­˜ç»“æœ: <span class="hljs-subst">{func.__name__}</span>(<span class="hljs-subst">{cache_key}</span>)"</span>)

            <span class="hljs-keyword">return</span> result
        <span class="hljs-keyword">return</span> wrapper
    <span class="hljs-keyword">return</span> decorator

<span class="hljs-meta">@cache(<span class="hljs-params">expire_time=<span class="hljs-number">30</span></span>)  </span><span class="hljs-comment"># ç¼“å­˜30ç§’</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">expensive_calculation</span>(<span class="hljs-params">x, y</span>):
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ‰§è¡Œè€—æ—¶è®¡ç®—: <span class="hljs-subst">{x}</span> + <span class="hljs-subst">{y}</span>"</span>)
    time.sleep(<span class="hljs-number">2</span>)  <span class="hljs-comment"># æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</span>
    <span class="hljs-keyword">return</span> x + y

<span class="hljs-comment"># ç¬¬ä¸€æ¬¡è°ƒç”¨ä¼šæ‰§è¡Œè®¡ç®—</span>
result1 = expensive_calculation(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)  <span class="hljs-comment"># 2ç§’åæ‰è¿”å›ç»“æœ</span>

<span class="hljs-comment"># ç¬¬äºŒæ¬¡è°ƒç”¨ç›´æ¥ä»ç¼“å­˜è¿”å›ï¼Œç¬é—´å®Œæˆ</span>
result2 = expensive_calculation(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)  <span class="hljs-comment"># ç¬é—´è¿”å›ç»“æœ</span>
</code></pre>
<h2 data-id="heading-10">é«˜çº§ç©æ³•ï¼šç±»è£…é¥°å™¨</h2>
<p>æœ‰æ—¶å€™è£…é¥°å™¨éœ€è¦ä¿å­˜çŠ¶æ€ï¼Œç”¨ç±»æ›´æ–¹ä¾¿ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CountCalls</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, func</span>):
        self.func = func
        self.call_count = <span class="hljs-number">0</span>
        wraps(func)(self)  <span class="hljs-comment"># è®©ç±»å®ä¾‹è¡¨ç°å¾—åƒåŸå‡½æ•°</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__call__</span>(<span class="hljs-params">self, *args, **kwargs</span>):
        self.call_count += <span class="hljs-number">1</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{self.func.__name__}</span> è¢«è°ƒç”¨äº† <span class="hljs-subst">{self.call_count}</span> æ¬¡"</span>)
        <span class="hljs-keyword">return</span> self.func(*args, **kwargs)

<span class="hljs-meta">@CountCalls</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">hello</span>():
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"Hello!"</span>)

hello()  <span class="hljs-comment"># è¾“å‡º: hello è¢«è°ƒç”¨äº† 1 æ¬¡</span>
hello()  <span class="hljs-comment"># è¾“å‡º: hello è¢«è°ƒç”¨äº† 2 æ¬¡</span>
hello()  <span class="hljs-comment"># è¾“å‡º: hello è¢«è°ƒç”¨äº† 3 æ¬¡</span>

<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ€»å…±è°ƒç”¨äº† <span class="hljs-subst">{hello.call_count}</span> æ¬¡"</span>)
</code></pre>
<h2 data-id="heading-11">æ€»ç»“ï¼šä»€ä¹ˆæ—¶å€™ç”¨è£…é¥°å™¨ï¼Ÿ</h2>
<p><strong>é€‚åˆç”¨è£…é¥°å™¨çš„åœºæ™¯ï¼š</strong></p>
<ul>
<li>âœ… é‡å¤çš„åŠŸèƒ½ä»£ç ï¼ˆæ—¥å¿—ã€è®¡æ—¶ã€ç¼“å­˜ã€æƒé™éªŒè¯ï¼‰</li>
<li>âœ… æƒ³åœ¨ä¸ä¿®æ”¹åŸå‡½æ•°çš„æƒ…å†µä¸‹å¢åŠ åŠŸèƒ½</li>
<li>âœ… éœ€è¦æ¨ªåˆ‡å¤šä¸ªå‡½æ•°çš„å…³æ³¨ç‚¹ï¼ˆAOPæ€æƒ³ï¼‰</li>
<li>âœ… æƒ³è®©ä»£ç æ›´ä¼˜é›…ã€æ›´å¯ç»´æŠ¤</li>
</ul>
<p><strong>ä¸é€‚åˆç”¨è£…é¥°å™¨çš„åœºæ™¯ï¼š</strong></p>
<ul>
<li>âŒ åªåœ¨ä¸€ä¸ªå‡½æ•°é‡Œç”¨çš„é€»è¾‘</li>
<li>âŒ å’ŒåŸå‡½æ•°é€»è¾‘è€¦åˆå¤ªç´§çš„åŠŸèƒ½</li>
<li>âŒ è°ƒè¯•æ—¶éœ€è¦é¢‘ç¹æŸ¥çœ‹å‡½æ•°å†…éƒ¨çŠ¶æ€çš„æƒ…å†µ</li>
</ul>
<p>è®°ä½ä¸€å¥è¯ï¼š<strong>è£…é¥°å™¨æ˜¯ä»£ç çš„"åŒ–å¦†å“"ï¼Œä¸æ˜¯"æ‰‹æœ¯åˆ€"ã€‚å®ƒç”¨æ¥ç¾åŒ–ä»£ç ï¼Œä¸æ˜¯ç”¨æ¥ä¿®æ”¹æ ¸å¿ƒé€»è¾‘çš„ã€‚</strong></p>
<p>ä¸‹æ¬¡å†çœ‹åˆ°æ»¡å±çš„é‡å¤ä»£ç ï¼Œä½ å°±çŸ¥é“è¯¥æ€ä¹ˆåŠäº†ã€‚</p>
<p>åˆ«è®©ä½ çš„ä»£ç çœ‹èµ·æ¥åƒä¸ªåƒåœ¾å †ï¼Œç”¨è£…é¥°å™¨è®©å®ƒä¼˜é›…èµ·æ¥ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤šçº¿ç¨‹ä¸‹çº¿ç¨‹å®‰å…¨çš„å•ä¾‹æ¨¡å¼å®ç°ç¼ºé™·]]></title>    <link>https://juejin.cn/post/7580389111921934399</link>    <guid>https://juejin.cn/post/7580389111921934399</guid>    <pubDate>2025-12-08T01:05:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580389111921934399" data-draft-id="7578892205291274280" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤šçº¿ç¨‹ä¸‹çº¿ç¨‹å®‰å…¨çš„å•ä¾‹æ¨¡å¼å®ç°ç¼ºé™·"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-12-08T01:05:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="uup"/> <meta itemprop="url" content="https://juejin.cn/user/4378706456356627"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤šçº¿ç¨‹ä¸‹çº¿ç¨‹å®‰å…¨çš„å•ä¾‹æ¨¡å¼å®ç°ç¼ºé™·
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4378706456356627/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    uup
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T01:05:39.000Z" title="Mon Dec 08 2025 01:05:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€Bug åœºæ™¯</h2>
<p>åœ¨ä¸€ä¸ªä¼ä¸šçº§åº”ç”¨ä¸­ï¼Œéœ€è¦ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„é…ç½®ç®¡ç†å™¨Â <code>ConfigurationManager</code>ï¼Œç”¨äºåŠ è½½å’Œç®¡ç†åº”ç”¨çš„å„ç§é…ç½®ä¿¡æ¯ã€‚ä¸ºäº†ç¡®ä¿åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œé‡‡ç”¨äº†å•ä¾‹æ¨¡å¼ã€‚ä½†åœ¨å®é™…è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå‘ç°å¯èƒ½ä¼šå‡ºç°å¤šä¸ªé…ç½®ç®¡ç†å™¨å®ä¾‹ï¼Œå¯¼è‡´é…ç½®ä¿¡æ¯æ··ä¹±ã€‚</p>
<h2 data-id="heading-1">äºŒã€ä»£ç ç¤ºä¾‹</h2>
<h3 data-id="heading-2">æœ‰ç¼ºé™·çš„å•ä¾‹æ¨¡å¼å®ç°</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConfigurationManager</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ConfigurationManager instance;
    <span class="hljs-keyword">private</span> String configData;

    <span class="hljs-keyword">private</span> <span class="hljs-title function_">ConfigurationManager</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æ¨¡æ‹ŸåŠ è½½é…ç½®æ•°æ®</span>
        configData = <span class="hljs-string">"Initial configuration data"</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ConfigurationManager <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {
            instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConfigurationManager</span>();
        }
        <span class="hljs-keyword">return</span> instance;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getConfigData</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> configData;
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MultithreadedApp</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-type">ConfigurationManager</span> <span class="hljs-variable">manager1</span> <span class="hljs-operator">=</span> ConfigurationManager.getInstance();
            System.out.println(<span class="hljs-string">"Thread 1: "</span> + manager1.getConfigData());
        });

        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-type">ConfigurationManager</span> <span class="hljs-variable">manager2</span> <span class="hljs-operator">=</span> ConfigurationManager.getInstance();
            System.out.println(<span class="hljs-string">"Thread 2: "</span> + manager2.getConfigData());
        });

        thread1.start();
        thread2.start();

        <span class="hljs-keyword">try</span> {
            thread1.join();
            thread2.join();
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            e.printStackTrace();
        }
    }
}
</code></pre>
<h2 data-id="heading-3">ä¸‰ã€é—®é¢˜æè¿°</h2>
<ol>
<li><strong>é¢„æœŸè¡Œä¸º</strong>ï¼šæ— è®ºæœ‰å¤šå°‘ä¸ªçº¿ç¨‹å¹¶å‘è°ƒç”¨Â <code>ConfigurationManager.getInstance()</code>Â æ–¹æ³•ï¼Œéƒ½åº”è¯¥è¿”å›åŒä¸€ä¸ªÂ <code>ConfigurationManager</code>Â å®ä¾‹ï¼Œä¿è¯é…ç½®ä¿¡æ¯çš„ä¸€è‡´æ€§ã€‚</li>
<li><strong>å®é™…è¡Œä¸º</strong>ï¼šåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œä¸Šè¿°å®ç°å¯èƒ½ä¼šåˆ›å»ºå¤šä¸ªÂ <code>ConfigurationManager</code>Â å®ä¾‹ã€‚è¿™æ˜¯å› ä¸ºÂ <code>getInstance</code>Â æ–¹æ³•ä¸­çš„Â <code>if (instance == null)</code>Â åˆ¤æ–­ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚å½“å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿›å…¥è¿™ä¸ªåˆ¤æ–­æ—¶ï¼Œå¯èƒ½ä¼šåŒæ—¶è®¤ä¸ºÂ <code>instance</code>Â ä¸ºÂ <code>null</code>ï¼Œä»è€Œå„è‡ªåˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚ä¾‹å¦‚ï¼Œ<code>thread1</code>Â å’ŒÂ <code>thread2</code>Â åŒæ—¶æ£€æŸ¥åˆ°Â <code>instance</code>Â ä¸ºÂ <code>null</code>ï¼Œç„¶åéƒ½åˆ›å»ºäº†è‡ªå·±çš„Â <code>ConfigurationManager</code>Â å®ä¾‹ï¼Œå¯¼è‡´é…ç½®ä¿¡æ¯ä¸ä¸€è‡´ï¼Œè¿èƒŒäº†å•ä¾‹æ¨¡å¼çš„åˆè¡·ã€‚</li>
</ol>
<h2 data-id="heading-4">å››ã€è§£å†³æ–¹æ¡ˆ</h2>
<ol>
<li><strong>é¥¿æ±‰å¼å•ä¾‹</strong>ï¼šåœ¨ç±»åŠ è½½æ—¶å°±åˆ›å»ºå®ä¾‹ï¼Œç¡®ä¿å®ä¾‹çš„å”¯ä¸€æ€§ã€‚</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConfigurationManager</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ConfigurationManager</span> <span class="hljs-variable">instance</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConfigurationManager</span>();
    <span class="hljs-keyword">private</span> String configData;

    <span class="hljs-keyword">private</span> <span class="hljs-title function_">ConfigurationManager</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æ¨¡æ‹ŸåŠ è½½é…ç½®æ•°æ®</span>
        configData = <span class="hljs-string">"Initial configuration data"</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ConfigurationManager <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> instance;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getConfigData</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> configData;
    }
}
</code></pre>
<ol start="2">
<li><strong>æ‡’æ±‰å¼å•ä¾‹ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰</strong> ï¼šä½¿ç”¨Â <code>synchronized</code>Â å…³é”®å­—ç¡®ä¿åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½åˆ›å»ºå®ä¾‹ã€‚</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConfigurationManager</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ConfigurationManager instance;
    <span class="hljs-keyword">private</span> String configData;

    <span class="hljs-keyword">private</span> <span class="hljs-title function_">ConfigurationManager</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æ¨¡æ‹ŸåŠ è½½é…ç½®æ•°æ®</span>
        configData = <span class="hljs-string">"Initial configuration data"</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">synchronized</span> ConfigurationManager <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {
            instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConfigurationManager</span>();
        }
        <span class="hljs-keyword">return</span> instance;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getConfigData</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> configData;
    }
}
</code></pre>
<ol start="3">
<li><strong>åŒé‡æ£€æŸ¥é”å®šï¼ˆDCLï¼‰</strong> ï¼šæ—¢ä¿è¯æ‡’åŠ è½½ï¼Œåˆæé«˜æ€§èƒ½ã€‚</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConfigurationManager</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">volatile</span> ConfigurationManager instance;
    <span class="hljs-keyword">private</span> String configData;

    <span class="hljs-keyword">private</span> <span class="hljs-title function_">ConfigurationManager</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æ¨¡æ‹ŸåŠ è½½é…ç½®æ•°æ®</span>
        configData = <span class="hljs-string">"Initial configuration data"</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ConfigurationManager <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">synchronized</span> (ConfigurationManager.class) {
                <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {
                    instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConfigurationManager</span>();
                }
            }
        }
        <span class="hljs-keyword">return</span> instance;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getConfigData</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> configData;
    }
}
</code></pre>
<p><code>volatile</code>Â å…³é”®å­—åœ¨è¿™é‡Œæ˜¯å¿…è¦çš„ï¼Œå®ƒç¡®ä¿äº†Â <code>instance</code>Â å˜é‡çš„å¯è§æ€§å’Œç¦æ­¢æŒ‡ä»¤é‡æ’åºã€‚å¦‚æœæ²¡æœ‰Â <code>volatile</code>ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šå‡ºç°ä¸€ä¸ªçº¿ç¨‹çœ‹åˆ°Â <code>instance</code>Â ä¸ä¸ºÂ <code>null</code>ï¼Œä½†å®é™…ä¸ŠÂ <code>instance</code>Â è¿˜æ²¡æœ‰å®Œå…¨åˆå§‹åŒ–çš„æƒ…å†µã€‚é€šè¿‡ä»¥ä¸Šå‡ ç§æ–¹å¼ï¼Œå¯ä»¥åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹æ­£ç¡®å®ç°å•ä¾‹æ¨¡å¼ï¼Œä¿è¯é…ç½®ç®¡ç†å™¨å®ä¾‹çš„å”¯ä¸€æ€§å’Œçº¿ç¨‹å®‰å…¨æ€§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»è¯¯åˆ¤åˆ°ç²¾å‡†ï¼šæ¸¸æˆç¤¾åŒº AI å®¡æ ¸çš„å·¥ç¨‹åŒ–å®è·µ]]></title>    <link>https://juejin.cn/post/7580606750291951667</link>    <guid>https://juejin.cn/post/7580606750291951667</guid>    <pubDate>2025-12-08T01:58:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580606750291951667" data-draft-id="7580570363602206772" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»è¯¯åˆ¤åˆ°ç²¾å‡†ï¼šæ¸¸æˆç¤¾åŒº AI å®¡æ ¸çš„å·¥ç¨‹åŒ–å®è·µ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-08T01:58:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äºšé©¬é€Šäº‘å¼€å‘è€…"/> <meta itemprop="url" content="https://juejin.cn/user/2850395271209496"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»è¯¯åˆ¤åˆ°ç²¾å‡†ï¼šæ¸¸æˆç¤¾åŒº AI å®¡æ ¸çš„å·¥ç¨‹åŒ–å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2850395271209496/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äºšé©¬é€Šäº‘å¼€å‘è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T01:58:51.000Z" title="Mon Dec 08 2025 01:58:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fs3.cn-north-1.amazonaws.com.cn%2Fawschinablog%2Fblogbanner-newnew.png" target="_blank" title="https://s3.cn-north-1.amazonaws.com.cn/awschinablog/blogbanner-newnew.png" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2c4a1d8bb6d54df78712ebd5c0284592~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765763948&amp;x-signature=wF7aKmJvqYKvL53finN92yp%2FX1g%3D" alt="" loading="lazy"/></a></p>
<h2 data-id="heading-0">å¼•è¨€</h2>
<p>æ¸¸æˆç¤¾åŒºä½œä¸ºå…¸å‹çš„ UGCï¼ˆç”¨æˆ·ç”Ÿæˆå†…å®¹ï¼‰åœºæ™¯ï¼Œç”¨æˆ·éå¸ƒå…¨çƒï¼Œæ¶‰åŠä¸­ã€è‹±ã€æ—¥ã€éŸ©ã€ä¿„ã€è¥¿ç­ç‰™è¯­ã€é˜¿æ‹‰ä¼¯è¯­ã€æ³•è¯­ç­‰å¤šç§è¯­è¨€ã€‚è®¨è®ºæ°›å›´æ´»è·ƒï¼Œä½†å…¶ä¸­ä¸å¯é¿å…ä¼šå¤¹æ‚ è¾±éª‚ã€ä»‡æ¨ã€è‰²æƒ…ã€æš´åŠ›ã€æ¶‰æ”¿ ç­‰è¿è§„è¨€è®ºã€‚</p>
<p>å¹³å°éœ€è¦åœ¨ä¸ä¼¤å®³ç¤¾åŒºæ°›å›´çš„å‰æä¸‹ï¼Œåšåˆ°Â <strong>åŠæ—¶ã€å‡†ç¡®çš„å†…å®¹å®¡æ ¸</strong>ã€‚ä½†ä¼ ç»Ÿè§„åˆ™å¼•æ“å®¹æ˜“å‡ºç°â€œè¯¯æ€â€æˆ–â€œæ¼åˆ¤â€ï¼Œç›´æ¥ä¾èµ–å¤§è¯­è¨€æ¨¡å‹å®¡æ ¸åˆå­˜åœ¨Â <strong>å‡†ç¡®ç‡ä¸é«˜ã€åˆ†ç±»ä¸ç¨³å®š</strong>Â çš„é—®é¢˜ã€‚</p>
<p>æˆ‘ä»¬é‡åˆ°çš„å®¢æˆ·éœ€æ±‚è¿˜æœ‰ä¸€äº›é¢å¤–æŒ‘æˆ˜ï¼š</p>
<ul>
<li>å®¡æ ¸å¯¹è±¡æ˜¯<strong>é•¿æ–‡æœ¬</strong>ï¼ˆåŠ¨è¾„ä¸Šåƒå­—ç¬¦ï¼‰ï¼›</li>
<li>æ— æ³•é€šè¿‡å‘é‡æ£€ç´¢æˆ– RAG åˆ‡ç‰‡ï¼Œå› ä¸ºé•¿æ–‡æœ¬æ‹†åˆ†åä¸Šä¸‹æ–‡ä¸¢å¤±ï¼Œç›¸å…³åº¦å¾ˆå·®ï¼›</li>
<li>æ¨¡å‹éœ€è¦ä¸€æ¬¡æ€§ç»™å‡ºÂ <strong>åˆ¤å®šç»“æœï¼ˆPass/Reject</strong> <strong>ï¼‰</strong> ï¼Œå¹¶åœ¨ Reject æ—¶æŒ‡å®šÂ <strong>10</strong> <strong>ç§è¿è§„åˆ†ç±»ä¹‹ä¸€</strong>ã€‚</li>
</ul>
<p>åœ¨è¿™æ ·çš„èƒŒæ™¯ä¸‹ï¼Œæˆ‘ä»¬ä¸ºä¸€å®¶æ¸¸æˆå…¬å¸è½åœ°äº†ä¸€å¥—Â <strong>æç¤ºè¯å·¥ç¨‹ + ReAct</strong> <strong>æ¡†æ¶ +</strong> <strong>å·¥ç¨‹åŒ–æ¶æ„</strong>Â çš„ AI å®¡æ ¸æ–¹æ¡ˆã€‚æœ€ç»ˆæ•´ä½“å‡†ç¡®ç‡æå‡åˆ°äº†Â <strong>81%</strong> ã€‚éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œå¯¹æ¯”åŸºå‡†æ˜¯å®¢æˆ·çš„äººå·¥å®¡æ ¸æ•°æ®ï¼Œè€Œäººå·¥æ ‡æ³¨è¿‡ç¨‹å­˜åœ¨â€œå¤šäººå¤šæ—¥ã€ç¼ºä¹å¤æ ¸â€çš„æƒ…å†µï¼Œå£å¾„å¹¶ä¸å®Œå…¨ç»Ÿä¸€ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åªèƒ½è¯´æ¨¡å‹çš„ 81% ä¸€è‡´æ€§<strong>å¤§ä½“ä¸Šè¾¾åˆ°äº†äººå·¥å®¡æ ¸çš„æ°´å¹³</strong>ï¼Œå…·ä½“æ•ˆæœè¿˜éœ€ç»“åˆæ›´ä¸¥æ ¼çš„æ ‡æ³¨ä½“ç³»è¿›ä¸€æ­¥éªŒè¯ã€‚</p>
<blockquote>
<p>ğŸ“¢é™æ—¶æ’æ’­ï¼šæ— éœ€ç®¡ç†åŸºç¡€è®¾æ–½ï¼Œåˆ©ç”¨äºšé©¬é€ŠæŠ€æœ¯ä¸ç”Ÿæ€ï¼Œå¿«é€Ÿé›†æˆä¸éƒ¨ç½²ç”Ÿæˆå¼AIæ¨¡å‹èƒ½åŠ›ã€‚</p>
<p>âœ¨ ç²¾å¿ƒè®¾è®¡ï¼Œæ—¨åœ¨å¼•å¯¼æ‚¨æ·±å…¥æ¢ç´¢Amazon Bedrockçš„æ¨¡å‹é€‰æ‹©ä¸è°ƒç”¨ã€æ¨¡å‹è‡ªåŠ¨åŒ–è¯„ä¼°ä»¥åŠå®‰å…¨å›´æ (Guardrail)ç­‰é‡è¦åŠŸèƒ½ã€‚</p>
<p>â©å¿«å¿«ç‚¹å‡»è¿›å…¥ã€Š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdev.amazoncloud.cn%2Fexperience%2Fcloudlab%3Fid%3D6695e4c5e1432f239fae485f%26visitfrom%3D3P_Juejinhead_0606%26sc_medium%3Downed%26sc_campaign%3Dcloudlab%26sc_channel%3D3P_Juejinhead_0606" target="_blank" title="https://dev.amazoncloud.cn/experience/cloudlab?id=6695e4c5e1432f239fae485f&amp;visitfrom=3P_Juejinhead_0606&amp;sc_medium=owned&amp;sc_campaign=cloudlab&amp;sc_channel=3P_Juejinhead_0606" ref="nofollow noopener noreferrer">å¤šæ¨¡ä¸€ç«™é€š â€”â€” Amazon Bedrock ä¸Šçš„åŸºç¡€æ¨¡å‹åˆä½“éªŒ</a>ã€‹å®éªŒæ„å»ºæ— é™, æ¢ç´¢å¯ç¨‹ï¼</p>
</blockquote>
<h2 data-id="heading-1">æ•´ä½“æ–¹æ¡ˆæ¶æ„</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2854ab2d20944099a84c17bcdd3fd2c1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765763948&amp;x-signature=e8%2BLZkluVgimOQGbAk1aDnH4d30%3D" alt="299042ed769fca693f09795d0e851c31.png" loading="lazy"/></p>
<h2 data-id="heading-2">å·¥ç¨‹åŒ–è½åœ°èƒ½åŠ›</h2>
<p>åœ¨æ–‡æœ¬å®¡æ ¸é¡¹ç›®ä¸­ï¼Œæç¤ºè¯ä¼˜åŒ–åªæ˜¯å…¶ä¸­ä¸€æ­¥ã€‚çœŸæ­£æ”¯æ’‘ä¸šåŠ¡è½åœ°çš„ï¼Œæ˜¯ä¸€æ•´å¥—Â <strong>å¯è§‚æµ‹ã€å¯å›æ»šã€å¯æ‰©å±•</strong>Â çš„å·¥ç¨‹æ¶æ„ï¼š</p>
<ul>
<li><strong>è“ç»¿éƒ¨ç½²</strong>ï¼šé€šè¿‡ Amazon Bedrock çš„å¤šç‰ˆæœ¬éƒ¨ç½²æœºåˆ¶ï¼Œæç¤ºè¯ä¼˜åŒ–å’Œæ¨¡å‹æ›´æ–°å¯ä»¥å®‰å…¨ä¸Šçº¿ï¼Œæ”¯æŒç°åº¦/å›æ»šã€‚</li>
<li><strong>æ—¥å¿—ä¸åˆ¤ä¾‹åº“</strong>ï¼šæ‰€æœ‰å®¡æ ¸è¯·æ±‚å’Œç»“æœå†™å…¥ DynamoDB / OpenSearchï¼Œç”¨äºåç»­çš„å›æº¯åˆ†æä¸æç¤ºè¯å†è®­ç»ƒã€‚</li>
<li><strong>é…ç½®ä¸æµæ§</strong>ï¼šAmazon AppConfig + æ§åˆ¶ Lambdaï¼Œä¿è¯åœ¨é«˜å¹¶å‘/å¤§æµé‡åœºæ™¯ä¸‹ç³»ç»Ÿç¨³å®šã€‚</li>
<li><strong>ç«¯åˆ°ç«¯å¯ç›‘æ§</strong>ï¼šä»è¯·æ±‚å…¥å£åˆ°æœ€ç»ˆå­˜å‚¨éƒ½æœ‰æ—¥å¿—é“¾è·¯ï¼Œæ–¹ä¾¿å¿«é€Ÿæ’æŸ¥é—®é¢˜ã€‚</li>
</ul>
<h2 data-id="heading-3">æç¤ºè¯å†·å¯åŠ¨é˜¶æ®µï¼šæç¤ºè¯ä» 0 åˆ° 1</h2>
<p>åœ¨æ²¡æœ‰ä»»ä½•â€œé»„é‡‘æç¤ºè¯â€çš„å‰æä¸‹ï¼Œæ‹¿åˆ°å¯ç”¨çš„æç¤ºè¯æ–¹æ³•æœ‰å¾ˆå¤šç§ï¼Œç”šè‡³å¯ä»¥ç›´æ¥è®©AIç”Ÿæˆä¸€ä¸ªã€‚</p>
<p>ä½†æˆ‘ä»¬è¿™é‡Œé‡‡ç”¨å†·å¯åŠ¨çš„åŠæ³•ï¼Œå…ˆè®©æ¨¡å‹æŠŠå®¢æˆ·ç»™çš„å‡ åƒæ¡æ ·æœ¬è¿‡ä¸€éã€‚æ¯è·‘ä¸€æ¡ï¼Œå°±æ‹¿å®ƒçš„ç»“æœå’Œäººå·¥æ ‡æ³¨æ¯”å¯¹ï¼ŒæŠŠæç¤ºè¯é‡Œæœ‰é—®é¢˜çš„åœ°æ–¹ä¿®æ‰ã€‚è¿™æ ·å¾ªç¯ä¸€è½®ï¼Œç­‰äºå¸®æˆ‘ä»¬å‡‘å‡ºäº†ä¸€ä¸ªâ€œèƒ½è·‘â€çš„åˆå§‹ç‰ˆæœ¬ï¼Œåé¢å†æ…¢æ…¢æ‰“ç£¨ã€‚</p>
<p>æˆ‘ä»¬çš„åšæ³•æ˜¯ï¼š</p>
<ol>
<li>è®©å¤§æ¨¡å‹é€æ¡è¯»å–å®¢æˆ·æä¾›çš„æ•°åƒæ¡äººå·¥å®¡æ ¸æ ·æœ¬ï¼ˆæ¯æ¡éƒ½åŒ…å«æ–‡æœ¬ã€åˆ¤å®šç»“æœä»¥åŠè¿è§„åˆ†ç±»ï¼‰ã€‚</li>
<li>åœ¨é˜…è¯»è¿‡ç¨‹ä¸­ï¼Œæ¨¡å‹ä¼šå°è¯•åŸºäºå·²æœ‰æ ·æœ¬ç”Ÿæˆæç¤ºè¯ã€‚</li>
<li>æ¯è¯»å–ä¸€æ¡æ ·æœ¬ï¼Œå°±å¯¹æç¤ºè¯åšä¸€æ¬¡å¾®è°ƒï¼Œé€æ­¥ä¿®æ­£ä¸åˆç†çš„éƒ¨åˆ†ã€‚</li>
<li>å®Œæˆä¸€è½®å…¨é‡æ ·æœ¬åï¼Œå°±å¾—åˆ°ä¸€ä¸ªÂ <strong>åˆå§‹æç¤ºè¯</strong>ï¼Œä½œä¸ºè¿›ä¸€æ­¥ä¼˜åŒ–çš„åŸºçº¿ã€‚</li>
</ol>
<p>ä¾‹å¦‚ï¼Œæœ€åˆæˆ‘ä»¬ç”Ÿæˆçš„æç¤ºè¯å¤§è‡´å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-erlang" lang="erlang">You are a content moderation model.
## Task
Analyze the following user-generated text.
<span class="hljs-number">1</span>. Classify it as <span class="hljs-string">"Pass"</span> or <span class="hljs-string">"Reject"</span>.
<span class="hljs-number">2</span>. If <span class="hljs-string">"Reject"</span>, assign one <span class="hljs-keyword">of</span> these categories:
   - Hate Speech
   - Sexual Content
   - Violence
   - Political Sensitivity
   - Spam / Ads
   - Self-harm
   ...
## Output Format (JSON)
{<span class="hljs-string">"result"</span>: <span class="hljs-string">"Reject"</span>, <span class="hljs-string">"category"</span>: <span class="hljs-string">"Hate Speech"</span>}
</code></pre>
<p>åœ¨å†·å¯åŠ¨é˜¶æ®µï¼Œè¿™ä¸ªæç¤ºè¯çš„å‡†ç¡®ç‡å¹¶ä¸ç®—é«˜ï¼Œå®¹æ˜“å‡ºç°Â <strong>ç°è‰²è¯­å¢ƒè¯¯åˆ¤</strong>ï¼ˆä¾‹å¦‚æŠŠäºŒæ¬¡å…ƒæ¢—è¯¯åˆ¤æˆè‰²æƒ…å†…å®¹ï¼‰ï¼Œæˆ–è€…Â <strong>å¤šè¯­è¨€è¦†ç›–ä¸è¶³</strong>ï¼ˆå¯¹é˜¿æ‹‰ä¼¯è¯­ã€è¥¿ç­ç‰™è¯­ç­‰çš„åˆ¤å®šä¸ç¨³å®šï¼‰ã€‚ä½†å®ƒä¸ºåç»­ä¼˜åŒ–å¥ å®šäº†åŸºç¡€ã€‚</p>
<h2 data-id="heading-4">ReAct æ¡†æ¶å¼•å…¥ï¼šè®©æ¨¡å‹â€œå…ˆæ€è€ƒï¼Œå†è¡ŒåŠ¨â€</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fd2908q01vomqb2.cloudfront.net%2F472b07b9fcf2c2451e8781e944bf5f77cd8457c8%2F2025%2F09%2F29%2Fcommunities-2.png" target="_blank" title="https://d2908q01vomqb2.cloudfront.net/472b07b9fcf2c2451e8781e944bf5f77cd8457c8/2025/09/29/communities-2.png" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b41d7b09a65b43c58286207f71bad4e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765763948&amp;x-signature=WLQZaU4vN9R877rQ5j7QzV4EIXg%3D" alt="" loading="lazy"/></a></p>
<p>å†·å¯åŠ¨é˜¶æ®µå¾—åˆ°çš„æç¤ºè¯è™½ç„¶èƒ½è·‘é€šæµç¨‹ï¼Œä½†åœ¨ä¸€äº›å…³é”®é—®é¢˜ä¸Šä»ç„¶å­˜åœ¨ä¸è¶³ï¼š</p>
<ul>
<li><strong>ç°è‰²è¯­å¢ƒ</strong>ï¼šä¾‹å¦‚äºŒæ¬¡å…ƒæ¢—ã€è®½åˆºè¯­æ°”ï¼Œå®¹æ˜“è¢«è¯¯åˆ¤ä¸ºè¿è§„ã€‚</li>
<li><strong>å¤šè¯­è¨€ä¸€è‡´æ€§</strong>ï¼šæŸäº›è¯­è¨€ï¼ˆå¦‚é˜¿æ‹‰ä¼¯è¯­ã€è¥¿ç­ç‰™è¯­ï¼‰åˆ†ç±»ä¸ç¨³å®šã€‚</li>
<li><strong>è¾“å‡ºéšæœºæ€§</strong>ï¼šç›¸åŒè¾“å…¥å¤šæ¬¡æµ‹è¯•ï¼Œç»“æœå¯èƒ½ä¸åŒã€‚</li>
</ul>
<p>ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨æç¤ºè¯ä¸­å¼•å…¥äº†Â <strong>ReAct</strong> <strong>ï¼ˆReason + Act</strong> <strong>ï¼‰æ¡†æ¶</strong>ã€‚</p>
<p><strong>ReAct</strong> <strong>çš„æ ¸å¿ƒæ€æƒ³</strong>æ˜¯è®©å¤§æ¨¡å‹å…ˆè¿›è¡Œæ˜¾å¼çš„â€œæ¨ç†â€æ­¥éª¤ï¼Œå†åšæœ€ç»ˆçš„â€œè¡ŒåŠ¨â€è¾“å‡ºã€‚è¿™æ ·å¯ä»¥å‡å°‘éšæœºæ€§ï¼Œå¹¶æé«˜å¯è§£é‡Šæ€§ã€‚</p>
<h3 data-id="heading-5">ReAct æ¡†æ¶åœ¨å®¡æ ¸åœºæ™¯ä¸­çš„æ‹†è§£</h3>
<ol>
<li>
<p><strong>Reasoning</strong> <strong>ï¼ˆæ€è€ƒï¼‰</strong> ï¼š</p>
<ul>
<li>Step 1: ç¡®å®šæ–‡æœ¬è¯­è¨€</li>
<li>Step 2: æå–æ½œåœ¨è¿è§„å…³é”®è¯æˆ–çŸ­è¯­</li>
<li>Step 3: å°†å…³é”®è¯ä¸è¿è§„ç±»åˆ«è¿›è¡ŒåŒ¹é…</li>
<li>Step 4: æ ¹æ®ä¸Šä¸‹æ–‡å’Œç±»åˆ«ï¼Œå†³å®š Pass / Reject</li>
</ul>
</li>
<li>
<p><strong>Action</strong> <strong>ï¼ˆè¡ŒåŠ¨ï¼‰</strong> ï¼š</p>
<ul>
<li>è¾“å‡ºæœ€ç»ˆ JSON ç»“æœï¼ˆåˆ¤å®š + ç±»åˆ«ï¼‰ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-6">ç¤ºä¾‹æç¤ºè¯ç‰‡æ®µ</h3>
<p>ä¸‹é¢æ˜¯æˆ‘ä»¬åœ¨ ReAct æ¡†æ¶ä¸‹çš„ä¸€éƒ¨åˆ†æç¤ºè¯ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">You are a professional content moderation assistant.  
Follow the steps below before giving the final output:  

<span class="hljs-keyword">Step</span> <span class="hljs-number">1</span>: Identify the language <span class="hljs-keyword">of</span> the <span class="hljs-keyword">text</span>.  
<span class="hljs-keyword">Step</span> <span class="hljs-number">2</span>: Extract any potentially offensive <span class="hljs-built_in">or</span> sensitive words.  
<span class="hljs-keyword">Step</span> <span class="hljs-number">3</span>: Match the extracted words <span class="hljs-keyword">to</span> one <span class="hljs-keyword">of</span> the violation categories.  
<span class="hljs-keyword">Step</span> <span class="hljs-number">4</span>: Decide whether the <span class="hljs-keyword">text</span> <span class="hljs-built_in">is</span> <span class="hljs-string">"Pass"</span> <span class="hljs-built_in">or</span> <span class="hljs-string">"Reject"</span>.  

<span class="hljs-keyword">Finally</span>, output ONLY <span class="hljs-keyword">in</span> the following JSON format:  
{<span class="hljs-string">"result"</span>: <span class="hljs-string">"Reject"</span>, <span class="hljs-string">"category"</span>: <span class="hljs-string">"Hate Speech"</span>}
</code></pre>
<p>è¿™æ ·è®¾è®¡åï¼Œå‡†ç¡®ç‡è™½ä¸é«˜ï¼Œå®¹æ˜“æŠŠäºŒæ¬¡å…ƒæ¢—å½“æˆè‰²æƒ…ï¼Œæˆ–å¯¹å°è¯­ç§åˆ¤å®šä¸ç¨³ã€‚ä½†å®ƒç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªèµ·ç‚¹ã€‚</p>
<h3 data-id="heading-7">ReAct æ¡†æ¶ä¸‹çš„å®ç°ç¤ºä¾‹ï¼ˆPython ä¼ªä»£ç ï¼‰</h3>
<p>åœ¨å·¥ç¨‹è½åœ°ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ Agent æ¡†æ¶è°ƒç”¨å¤§æ¨¡å‹ï¼Œæ¥æ‰§è¡Œä¸Šè¿° ReAct æ¨ç†ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> strands <span class="hljs-keyword">import</span> Agent, tool
<span class="hljs-meta">@tool</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">moderation_tool</span>(<span class="hljs-params">text: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">dict</span>:
    <span class="hljs-string">"""
    Classify the input text into Pass/Reject and category using ReAct framework.
    """</span>
    reasoning_prompt = <span class="hljs-string">f"""
    Step 1: Identify language.
    Step 2: Extract potentially offensive words or sensitive context.
    Step 3: Match with violation categories.
    Step 4: Decide Pass or Reject.
    Text: <span class="hljs-subst">{text}</span>
    """</span>
    <span class="hljs-comment"># è°ƒç”¨å¤§æ¨¡å‹</span>
    result = llm_call(reasoning_prompt)
    <span class="hljs-keyword">return</span> result
<span class="hljs-comment"># ç¤ºä¾‹è°ƒç”¨</span>
<span class="hljs-built_in">print</span>(moderation_tool(<span class="hljs-string">"This game sucks, I hope the devs all die in a fire."</span>))
<span class="hljs-comment"># è¾“å‡ºç¤ºä¾‹: {"result": "Reject", "category": "Hate Speech"}</span>
</code></pre>
<p>åœ¨ ReAct æœºåˆ¶ä¸‹ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°æ¨¡å‹çš„è¡¨ç°æ˜æ˜¾æ›´åŠ ç¨³å®šï¼š</p>
<ul>
<li>å¯¹å¤šè¯­è¨€è¾“å…¥çš„åˆ†ç±»ä¸€è‡´æ€§å¢å¼ºï¼›</li>
<li>å¯¹ç°è‰²è¯­å¢ƒï¼ˆå¦‚â€œç©æ¢—â€ï¼‰çš„è¯¯åˆ¤æ˜¾è‘—å‡å°‘ï¼›</li>
<li>å®¡æ ¸ç†ç”±é€æ˜ï¼Œå¯ä»¥å¤ç›˜å’Œè§£é‡Šã€‚</li>
</ul>
<h2 data-id="heading-8">å¤šè½®å¾ªç¯ä¼˜åŒ–ï¼šä» 3 è½®åˆ° 10+ è½®ï¼Œæˆ‘ä»¬å¦‚ä½•é€‰å®š 5 è½®</h2>
<p>åœ¨å¼•å…¥ ReAct ä¹‹åï¼Œæˆ‘ä»¬å¯¹â€œ<strong>æ¯è½®ï¼šå…¨é‡è·‘æ ·æœ¬ â†’</strong> <strong>çº é”™ â†’</strong> <strong>ä¿®æç¤ºè¯</strong>â€çš„é—­ç¯è¿›è¡Œäº†ç³»ç»ŸåŒ–å®éªŒï¼Œå¯¹æ¯”ä¸åŒè½®æ•°çš„æ”¶ç›Šä¸æˆæœ¬ï¼š</p>
<ul>
<li>
<p><strong>3</strong> <strong>è½®ï¼šæ¬ æ‹Ÿåˆ</strong></p>
<ul>
<li>å…¸å‹é—®é¢˜ï¼šä»ç„¶å­˜åœ¨å¤šè¯­è¨€ä¸€è‡´æ€§ä¸è¶³ã€ç°è‰²è¯­å¢ƒè¯¯åˆ¤åå¤šã€‚</li>
<li>ç°è±¡ï¼šæŒ‡æ ‡æå‡æ˜æ˜¾ä½äº 5 è½®ï¼Œå‘ˆâ€œä¸Šå‡æœªé¥±å’Œâ€çŠ¶æ€ã€‚</li>
</ul>
</li>
<li>
<p><strong>5</strong> <strong>è½®ï¼šæ•ˆæœ-</strong> <strong>æˆæœ¬æœ€ä¼˜ç‚¹</strong></p>
<ul>
<li>è¿›å…¥<strong>æ”¶ç›Šé€’å‡åŒºé—´</strong>çš„èµ·ç‚¹ï¼Œå‡†ç¡®ç‡ä¸ç¨³å®šæ€§åŸºæœ¬æ”¶æ•›ã€‚</li>
<li>ä¸ 10 è½®ç›¸æ¯”ï¼Œ<strong>å¢ç›Šä¸æ˜æ˜¾</strong>ï¼Œä½†è®¡ç®—/æ—¶é—´æˆæœ¬æ˜¾è‘—æ›´ä½ã€‚</li>
</ul>
</li>
<li>
<p><strong>10</strong> <strong>è½®ï¼šä¸ 5</strong> <strong>è½®æ¥è¿‘</strong></p>
<ul>
<li>æŒ‡æ ‡æ¥è¿‘ 5 è½®ï¼Œ<strong>å·®å¼‚åœ¨ç»Ÿè®¡è¯¯å·®èŒƒå›´å†…</strong>ã€‚</li>
<li>æˆæœ¬çº¦ä¸º 5 è½®çš„ 2 å€ï¼ˆæ¨ç†è´¹ç”¨ã€æ—¶é—´å ç”¨ã€å¹¶å‘ç®¡ç†ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>10</strong> <strong>è½®ä»¥ä¸Šï¼šå¯èƒ½å‡ºç°è´Ÿé¢å½±å“</strong></p>
<ul>
<li>è¿‡æ‹Ÿåˆäºâ€œç‰¹å®šå®¡æ ¸å‘˜å£å¾„/ç‰¹å®šæ ·æœ¬ç°‡â€ï¼Œæç¤ºè¯<strong>å˜çª„</strong>ã€‚</li>
<li>å¯¹è·¨å¤©ã€è·¨å®¡æ ¸å‘˜ã€è·¨è¯­ç§çš„æ³›åŒ–èƒ½åŠ›<strong>ç•¥æœ‰ä¸‹é™</strong>ã€‚</li>
</ul>
</li>
</ul>
<p><strong>ç»“è®º</strong>ï¼šåœ¨æˆæœ¬â€”æ”¶ç›Šçš„ç»¼åˆè€ƒé‡ä¸‹ï¼Œæˆ‘ä»¬é€‰æ‹©Â <strong>5</strong> <strong>è½®</strong>Â ä½œä¸ºç”Ÿäº§å»ºè®®ï¼Œå¹¶ç»™å‡º<strong>å®è·µåŒºé—´</strong> <strong>5â€“8</strong> <strong>è½®</strong>ï¼ˆ8 è½®ç”¨äºæ›´ä¸¥æ ¼çš„åœºæ™¯/å…³é”®ä¸Šçº¿å‰çš„ç¨³å¥æ€§æ ¡éªŒï¼‰ã€‚</p>
<h3 data-id="heading-9">ç‰ˆæœ¬å¯¹æ¯”</h3>





















































<table><thead><tr><th/><th>ç‰ˆæœ¬</th><th>è½®æ¬¡</th><th>æ ¸å¿ƒæ”¹åŠ¨</th><th>æ•ˆæœè§‚å¯Ÿ</th><th>ä¸»è¦é—®é¢˜</th></tr></thead><tbody><tr><td>1</td><td>v1</td><td>1</td><td>å†·å¯åŠ¨æç¤ºè¯ï¼Œç›´æ¥åˆ†ç±»</td><td>åŸºçº¿ 72%</td><td>ç°è‰²è¯­å¢ƒè¯¯åˆ¤ã€å¤šè¯­è¨€ä¸ç¨³</td></tr><tr><td>2</td><td>v2</td><td>3</td><td>åŠ è¯­è¨€è¯†åˆ«ã€å…³é”®è¯æå–</td><td>~77â€“79%</td><td>ä»æœ‰æ¬ æ‹Ÿåˆè¿¹è±¡</td></tr><tr><td>3</td><td>v3</td><td>5</td><td>ReAct æ¨ç†é“¾æ¡æ”¶æ•›ã€åˆ†ç±»è¾¹ç•Œç²¾ç‚¼</td><td>81%</td><td>æ ‡æ³¨å™ªå£°æˆä¸ºä¸»é™å› ç´ </td></tr><tr><td>4</td><td>v4</td><td>8</td><td>è§„åˆ™ç²¾ä¿®ã€è¾“å‡ºä¸€è‡´æ€§å¢å¼º</td><td>~81%Â±</td><td>æå‡æ¥è¿‘å™ªå£°å¤©èŠ±æ¿</td></tr><tr><td>5</td><td>v5</td><td>10+</td><td>æ›´ç»†ç²’åº¦è§„åˆ™</td><td><strong>æ”¶ç›Šä¸å¢åé™</strong></td><td>è¿‡æ‹Ÿåˆé£é™©ä¸Šå‡ï¼Œæç¤ºè¯ä¼šè¿‡äºå…·è±¡åŒ–</td></tr></tbody></table>
<h2 data-id="heading-10">Temperature è°ƒå‚ç»éªŒ</h2>
<p>åœ¨æˆ‘ä»¬åå¤è°ƒæç¤ºè¯çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°Â <strong>temperature</strong> <strong>å‚æ•°</strong>Â å¯¹ç»“æœå½±å“è¾ƒå¤§ã€‚</p>
<ul>
<li>
<p><strong>åœ¨è°ƒè¯•å’Œå®éªŒé˜¶æ®µ</strong><br/>
æˆ‘ä»¬ä¼šæŠŠ temperature å¼€å¾—æ¯”è¾ƒé«˜ï¼Œå¤§æ¦‚åœ¨Â <strong>8â€“1.0</strong>ã€‚è¿™æ ·æ¨¡å‹ä¼šæ›´â€œæ´»è·ƒâ€ï¼Œèƒ½ä»ä¸åŒè§’åº¦å»ç†è§£æ–‡æœ¬ã€‚æ¯”å¦‚ï¼š</p>
<ul>
<li>äºŒæ¬¡å…ƒæ¢—ã€è®½åˆºè¯è¯­ã€è·¨è¯­ç§ç”šè‡³å¤¹æ‚ emoji çš„å†…å®¹ï¼Œé«˜ temperature ä¸‹æ¨¡å‹èƒ½ç»™å‡ºæ›´å¤šè§£é‡Šï¼›</li>
<li>è¿™å¯¹æˆ‘ä»¬æ¥è¯´å¾ˆæœ‰å¸®åŠ©ï¼Œå¯ä»¥æš´éœ²æç¤ºè¯é‡Œæ²¡è€ƒè™‘åˆ°çš„è¾¹è§’æƒ…å†µï¼Œæ–¹ä¾¿æˆ‘ä»¬å¿«é€Ÿæ”¹è¿›ã€‚</li>
</ul>
</li>
<li>
<p><strong>åœ¨çœŸæ­£ä¸Šçº¿çš„æ—¶å€™</strong><br/>
æˆ‘ä»¬æŠŠ temperature æ‹‰åˆ°Â <strong>0â€“0.1</strong>ã€‚</p>
<ul>
<li>è¿™æ ·æ¨¡å‹è¾“å‡ºä¼šå°½é‡å›ºå®šï¼Œä¸ä¼šåŒä¸€æ¡å†…å®¹å‰åç»™å‡ºä¸ä¸€æ ·çš„ç»“æœï¼›</li>
<li>å¯¹å®¡æ ¸ä¸šåŠ¡æ¥è¯´ï¼Œ<strong>ç¨³å®šå’Œå¯è§£é‡Š</strong>æ¯”â€œæœ‰åˆ›é€ åŠ›â€è¦é‡è¦å¾—å¤šã€‚</li>
</ul>
</li>
</ul>
<p>æ‰€ä»¥æˆ‘ä»¬çš„åšæ³•æ˜¯ï¼š<strong>è°ƒè¯•é˜¶æ®µé«˜</strong> <strong>temperature</strong> <strong>ï¼Œç”Ÿäº§ç¯å¢ƒä½ temperature</strong>ï¼Œæ—¢èƒ½æ¢ç´¢é—®é¢˜ï¼Œä¹Ÿèƒ½ä¿è¯ä¸Šçº¿ç¨³å®šã€‚</p>
<h2 data-id="heading-11">å®éªŒç»“æœï¼ˆå£å¾„ä¸å™ªå£°è¯´æ˜ï¼‰</h2>
<ul>
<li><strong>æ•´ä½“å‡†ç¡®ç‡</strong>ï¼š<strong>81%</strong></li>
<li><strong>æ­£å‘å¬å›å‡†ç¡®ç‡ï¼ˆåˆè§„åˆ¤å®šï¼‰</strong> ï¼š<strong>76%</strong></li>
<li><strong>è´Ÿå‘å¬å›å‡†ç¡®ç‡ï¼ˆè¿è§„åˆ¤å®šï¼‰</strong> ï¼š<strong>90%</strong></li>
</ul>
<p><strong>è¯„ä¼°å£å¾„ä¸æ•°æ®å™ªå£°ï¼š</strong></p>
<ul>
<li>åŸºå‡†ä¸ºå®¢æˆ·æä¾›çš„<strong>äººå·¥å®¡æ ¸æ•°æ®</strong>ï¼›å¤šäººã€åˆ†å¤šæ—¥å®Œæˆï¼Œ<strong>æœªå»ºç«‹åŒç›²å¤æ ¸</strong>ï¼Œå£å¾„å­˜åœ¨<strong>å¤©ç„¶ä¸ä¸€è‡´</strong>ã€‚</li>
<li>å› æ­¤ 81% çš„ä¸€è‡´æ€§ï¼Œ<strong>å·²ç»æ¥è¿‘ç”šè‡³å¯èƒ½è¶…è¿‡</strong>å¤šäººäººå·¥çš„ç¨³å®šæ°´å¹³ã€‚</li>
<li>åœ¨å¤šè¯­è¨€ä¸ç°è‰²è¯­å¢ƒï¼ˆç©æ¢—ã€åè®½ï¼‰ä¸Šï¼Œ<strong>ReAct</strong> <strong>æç¤ºè¯</strong>æ˜¾è‘—é™ä½äº†éšæœºè¯¯åˆ¤ï¼Œå¹¶æå‡äº†è·¨è¯­è¨€ä¸€è‡´æ€§ã€‚</li>
</ul>
<h3 data-id="heading-12">ä»£è¡¨æ€§æ¡ˆä¾‹ï¼ˆæ¨¡æ‹ŸçœŸå®æ•°æ®ï¼‰</h3>








































<table><thead><tr><th/><th>æ–‡æœ¬ï¼ˆèŠ‚é€‰ï¼‰</th><th>äººå·¥æ ‡æ³¨</th><th>åŸºçº¿æ¨¡å‹</th><th>ReAct æç¤ºè¯</th></tr></thead><tbody><tr><td>1</td><td>â€œYou are stupid, I hate you.â€</td><td>ä»‡æ¨è¨€è®º</td><td>Pass âŒ</td><td>Reject âœ…ï¼ˆHate Speechï¼‰</td></tr><tr><td>2</td><td>â€œThis waifu is so hot omg ğŸ”¥â€</td><td>åˆè§„ï¼ˆäºŒæ¬¡å…ƒè¯­å¢ƒï¼‰</td><td>Reject âŒ</td><td>Pass âœ…</td></tr><tr><td>3</td><td>â€œThe devs are scammers, I hope they burn.â€</td><td>ä»‡æ¨è¨€è®º</td><td>Reject âœ…</td><td>Reject âœ…ï¼ˆHate Speechï¼‰</td></tr><tr><td>4</td><td>â€œHelloâ€</td><td/><td>Passâœ…</td><td/></tr></tbody></table>
<h2 data-id="heading-13">å·¥ç¨‹å®ç°è¦ç‚¹</h2>
<h3 data-id="heading-14">æ ¸å¿ƒä»£ç </h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">process_file_validation</span>(<span class="hljs-params">file_path, prompt_template, client, model_id, temperature, max_tokens, logger</span>):
    <span class="hljs-string">"""Process a single file for validation and return results"""</span>
    file_name = os.path.basename(file_path)
    
    logger.info(<span class="hljs-string">f"Validating file: <span class="hljs-subst">{file_name}</span>"</span>)
    
    <span class="hljs-keyword">try</span>:
        df = pd.read_excel(file_path, engine=<span class="hljs-string">'openpyxl'</span>)
        
        <span class="hljs-comment"># Processing Excel data</span>
        <span class="hljs-comment"># ...</span>
        
        results = []
        
        <span class="hljs-comment"># Counters for detailed metrics</span>
        metrics = {
            <span class="hljs-string">"total"</span>: <span class="hljs-built_in">len</span>(data),
            <span class="hljs-string">"pass_samples"</span>: <span class="hljs-number">0</span>,
            <span class="hljs-string">"reject_samples"</span>: <span class="hljs-number">0</span>,
            <span class="hljs-string">"pass_correct"</span>: <span class="hljs-number">0</span>,
            <span class="hljs-string">"reject_correct"</span>: <span class="hljs-number">0</span>,
            <span class="hljs-string">"category_metrics"</span>: defaultdict(<span class="hljs-keyword">lambda</span>: {<span class="hljs-string">"total"</span>: <span class="hljs-number">0</span>, <span class="hljs-string">"correct"</span>: <span class="hljs-number">0</span>})
        }
        
        <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> tqdm(data, desc=<span class="hljs-string">f"Processing <span class="hljs-subst">{file_name}</span>"</span>):
            <span class="hljs-comment"># ...</span>
            <span class="hljs-comment"># Format the prompt with the current text</span>
            prompt = prompt_template.<span class="hljs-built_in">format</span>(text=text)
            
            <span class="hljs-comment"># Get model response</span>
            response = invoke_claude(client, prompt, model_id, temperature, max_tokens, logger)
            
            <span class="hljs-comment"># Extract prediction (0 or 1) from response</span>
            <span class="hljs-keyword">if</span> response:
                <span class="hljs-comment"># Look for Pass/Reject indicators in the response</span>
                lower_response = response.lower()
                
                <span class="hljs-comment"># Check for explicit "Pass" or "Reject" in the response</span>

                <span class="hljs-comment"># Check for numeric indicators</span>
                
                <span class="hljs-comment"># Default to Reject if unclear</span>
                    
                is_correct = pred_label == true_label
                <span class="hljs-keyword">if</span> is_correct:
                    <span class="hljs-keyword">if</span> true_label == <span class="hljs-number">1</span>:
                        metrics[<span class="hljs-string">"pass_correct"</span>] += <span class="hljs-number">1</span>
                    <span class="hljs-keyword">else</span>:
                        metrics[<span class="hljs-string">"reject_correct"</span>] += <span class="hljs-number">1</span>
                        metrics[<span class="hljs-string">"category_metrics"</span>][category][<span class="hljs-string">"correct"</span>] += <span class="hljs-number">1</span>
                    
                results.append({
                    <span class="hljs-string">"text"</span>: text,
                    <span class="hljs-string">"true_label"</span>: true_label,
                    <span class="hljs-string">"pred_label"</span>: pred_label,
                    <span class="hljs-string">"is_correct"</span>: is_correct,
                    <span class="hljs-string">"response"</span>: response,
                    <span class="hljs-string">"category"</span>: category,
                    <span class="hljs-string">"source_file"</span>: file_name
                })
            
            <span class="hljs-comment"># Add a small delay to avoid rate limiting</span>
            time.sleep(<span class="hljs-number">0.5</span>)
        
        <span class="hljs-comment"># Calculate metrics</span>
        <span class="hljs-comment"># ...</span>
        
        logger.info(<span class="hljs-string">f"Completed <span class="hljs-subst">{file_name}</span>: Accuracy=<span class="hljs-subst">{metrics[<span class="hljs-string">'accuracy'</span>]:<span class="hljs-number">.4</span>f}</span>, "</span>
                   <span class="hljs-string">f"Pass=<span class="hljs-subst">{metrics[<span class="hljs-string">'pass_accuracy'</span>]:<span class="hljs-number">.4</span>f}</span>, Reject=<span class="hljs-subst">{metrics[<span class="hljs-string">'reject_accuracy'</span>]:<span class="hljs-number">.4</span>f}</span>"</span>)
        
        <span class="hljs-keyword">return</span> file_name, results, metrics
        
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        logger.error(<span class="hljs-string">f"Error processing file <span class="hljs-subst">{file_path}</span>: <span class="hljs-subst">{e}</span>"</span>)
        <span class="hljs-keyword">return</span> file_name, [], {<span class="hljs-string">"error"</span>: <span class="hljs-built_in">str</span>(e)}
</code></pre>
<h3 data-id="heading-15">1) æ—¥å¿—ä¸å¯è¿½æº¯æ€§</h3>
<ul>
<li>
<p><strong>ç›®çš„</strong>ï¼šè®°å½•æ¯ä¸ªæ–‡ä»¶ã€æ¯æ¡æ ·æœ¬çš„åˆ¤å®šä¸æŒ‡æ ‡ï¼Œæ”¯æ’‘é—®é¢˜å›æº¯ã€‚</p>
</li>
<li>
<p><strong>å®è·µè¦ç‚¹</strong>ï¼š</p>
<ul>
<li>æ–‡ä»¶ + æ§åˆ¶å°åŒé€šé“æ—¥å¿—ï¼›</li>
<li>å…³é”®ä¿¡æ¯ç»“æ„åŒ–è¾“å‡ºï¼ˆaccuracyã€pass/rejectã€category æŒ‡æ ‡ï¼‰ï¼›</li>
<li>æ¯è½®/æ¯ç‰ˆæœ¬ç”Ÿæˆç‹¬ç«‹ log æ–‡ä»¶ï¼Œä¾¿äºå¯¹æ¯”ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-16">2) æ•°æ®è£…è½½ä¸å¤šæ–‡ä»¶æ‰¹å¤„ç†</h3>
<ul>
<li>
<p><strong>Excel</strong> <strong>åˆ—ä½å¤„ç†</strong>ï¼šæ–‡æœ¬ã€æ ‡ç­¾åˆ—æå–ã€‚</p>
</li>
<li>
<p><strong>è¦ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>ç»Ÿä¸€ label</strong> <strong>å£å¾„</strong>ï¼š<code>Pass â†’ 1 / Reject â†’ 0</code>ï¼›</li>
<li><strong>ç±»åˆ«ç²¾åº¦</strong>ï¼šå¯¹Â <code>Reject</code>Â çš„ç±»åˆ«è¿›è¡Œ<strong>å•ç‹¬ç»Ÿè®¡</strong>ï¼Œä¾¿äºå‘ç°â€œå¼±ç±»â€ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-17">3) å¤§æ¨¡å‹è°ƒç”¨ä¸æ¨ç†å‚æ•°ï¼ˆä½¿ç”¨botocoreè°ƒç”¨Bedrockï¼‰</h3>
<ul>
<li><strong>é»˜è®¤å‚æ•°</strong>ï¼š<code>temperature=0.0</code>ã€<code>max_tokens=1000</code>ï¼Œç¡®ä¿<strong>å¯é‡å¤ä¸ç¨³å®šè¾“å‡ºï¼Œ</strong> <code>max_tokens</code>è¿‡å¤§å¯¹æ•ˆæœå½±å“æœ‰é™;</li>
<li><strong>è¶…æ—¶/</strong> <strong>é‡è¯•</strong>ï¼š<code>botocore.config.Config</code>ä¸­è®¾ç½®<code>connect_timeout/read_timeout/retries</code>ï¼›</li>
</ul>
<h3 data-id="heading-18">4) æç¤ºè¯æ¨¡æ¿ä¸å ä½</h3>
<ul>
<li>é€šè¿‡<code>prompt_template.format(text=...)</code>Â æ³¨å…¥æ ·æœ¬æ­£æ–‡ã€‚</li>
<li><strong>å»ºè®®</strong>ï¼šæ¨¡æ¿å†…ç»Ÿä¸€çº¦æŸ<strong>å”¯ä¸€</strong> <strong>JSON</strong> <strong>è¾“å‡º</strong>ï¼Œä¾¿äºè§£æï¼›è¾“å‡ºå‰ç½® ReAct æ­¥éª¤ï¼ˆè¯­è¨€è¯†åˆ«ã€å…³é”®è¯æå–ã€ç±»åˆ«åŒ¹é…ã€æœ€ç»ˆåˆ¤å®šï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-19">5) å¹¶å‘éªŒè¯ä¸èŠ‚æµ</h3>
<ul>
<li><strong>å¤šæ–‡ä»¶å¹¶è¡Œ</strong>ï¼š<code>ThreadPoolExecutor</code>Â æŒ‰æ–‡ä»¶ç²’åº¦å¹¶å‘ï¼›</li>
<li><strong>é€Ÿç‡æ§åˆ¶</strong>ï¼š<code>time.sleep(0.5)</code>Â åšåŸºç¡€èŠ‚æµï¼Œé¿å…é™æµï¼Œæ³¨æ„æ‚¨Amazon Web Serviceè´¦å·å†…Quotaï¼›</li>
</ul>
<h3 data-id="heading-20">6) è¯„ä¼°ä¸æŠ¥è¡¨</h3>
<ul>
<li>
<p>è¾“å‡ºå››ä¸ª Sheetï¼š<code>Results / Overall Metrics / File Metrics / Category Metrics</code>Â +Â <code>Prompt</code>ã€‚</p>
</li>
<li>
<p><strong>å¥½å¤„</strong>ï¼š</p>
<ul>
<li><code>Category Metrics</code>Â èƒ½å¿«é€Ÿå®šä½<strong>è–„å¼±ç±»åˆ«</strong>ï¼›</li>
<li><code>Prompt</code>Â ç•™å­˜ä½¿<strong>ç‰ˆæœ¬å¯å¤ç°</strong>ï¼›</li>
<li>ç»“åˆæ—¥å¿—å¿«é€Ÿå›æ”¾å¼‚å¸¸æ ·æœ¬ã€‚</li>
</ul>
</li>
</ul>
<p><strong>è¯„ä¼°å£å¾„</strong>ï¼šç»Ÿä¸€ä½¿ç”¨â€œä¸äººå·¥æ ‡æ³¨çš„ä¸€è‡´æ€§â€ä¸ºä¸»æŒ‡æ ‡ï¼ˆOverall/Pass/Reject accuracy + Category accuracyï¼‰ï¼Œå¹¶åœ¨æ–‡ä¸­<strong>æ˜¾å¼å£°æ˜æ ‡æ³¨å™ªå£°</strong>ä¸â€œå¤šå®¡æ ¸å‘˜/å¤šæ—¥/æœªå¤æ ¸â€çš„ç°å®çº¦æŸã€‚</p>
<h2 data-id="heading-21">ç»éªŒæ€»ç»“ï¼ˆé’ˆå¯¹è½®æ•°é€‰æ‹©ä¸æˆæœ¬ï¼‰</h2>
<ul>
<li>
<p><strong>å»ºè®®è½®æ•°</strong>ï¼š<strong>5â€“8</strong> <strong>è½®</strong>ï¼›5 è½®ç”¨äºå¤§å¤šæ•°ç”Ÿäº§åœºæ™¯ï¼Œ8 è½®ç”¨äºä¸Šçº¿å‰ç¨³å¥æ€§æ ¡éªŒã€‚</p>
</li>
<li>
<p><strong>é¿å…è¿‡æ‹Ÿåˆ</strong>ï¼š10 è½®ä»¥ä¸Šå®¹æ˜“å¯¹æŸäº›å®¡æ ¸å‘˜å£å¾„æˆ–å°æ ·æœ¬ç°‡è¿‡æ‹Ÿåˆï¼Œæ³›åŒ–å˜å·®ã€‚</p>
</li>
<li>
<p><strong>æˆæœ¬ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>ä¸²å¹¶ç»“åˆï¼šæ–‡ä»¶çº§å¹¶è¡Œ + æ ·æœ¬çº§èŠ‚æµï¼›</li>
<li>å›ºå®šÂ <code>temperature</code>ï¼Œä¿è¯ä¸€è‡´æ€§ï¼Œå‡å°‘â€œè¿”å·¥è½®â€ï¼›</li>
<li>å¯¹ç±»åˆ«<strong>åˆ†å±‚æŠ½æ ·</strong>åšå°é›†è¯„ä¼°ï¼Œä¼˜å…ˆä¿®â€œå¼±ç±»â€ï¼Œå†å…¨é‡å›å½’ã€‚</li>
<li>åœ¨æœ€ç»ˆå·¥ç¨‹åŒ–å®æ–½æ—¶ï¼Œå¯ä»¥å°†æç¤ºè¯æ”¾åˆ°system promptä¸­ï¼ŒåŒæ—¶å¼€å¯cacheï¼Œä»¥é™ä½æˆæœ¬ã€‚</li>
</ul>
</li>
<li>
<p><strong>JSON</strong> <strong>ä»…è¾“å‡ºä¸è§£æå¥å£®æ€§</strong></p>
<ul>
<li>å¼ºè°ƒè¾“å‡ºæ ¼å¼çš„è§„èŒƒåŒ–ï¼Œé™ä½å¯¹è¾“å‡ºç»“æœçš„ä¸ç»Ÿä¸€å¢åŠ ç”Ÿäº§ç³»ç»Ÿçš„ä¸ç¡®å®šæ€§ã€‚</li>
<li>éƒ¨åˆ†æç¤ºè¯</li>
</ul>
</li>
</ul>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fd2908q01vomqb2.cloudfront.net%2F472b07b9fcf2c2451e8781e944bf5f77cd8457c8%2F2025%2F09%2F29%2Fcommunities-3.jpg" target="_blank" title="https://d2908q01vomqb2.cloudfront.net/472b07b9fcf2c2451e8781e944bf5f77cd8457c8/2025/09/29/communities-3.jpg" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ce09ff6490fc4094bb656ab04d2d485c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765763948&amp;x-signature=wSwcENFAjfgJ9IWsuVIxTsR9fGM%3D" alt="" loading="lazy"/></a></p>
<ul>
<li>è¾“å‡º</li>
</ul>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fd2908q01vomqb2.cloudfront.net%2F472b07b9fcf2c2451e8781e944bf5f77cd8457c8%2F2025%2F09%2F29%2Fcommunities-4.png" target="_blank" title="https://d2908q01vomqb2.cloudfront.net/472b07b9fcf2c2451e8781e944bf5f77cd8457c8/2025/09/29/communities-4.png" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b8e04bd15b444a48aad8fe053f93961a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765763948&amp;x-signature=sljqwQ4T9NXdLfOgfmw%2Bx2p%2F5Rg%3D" alt="" loading="lazy"/></a></p>
<h2 data-id="heading-22">è½åœ°ç»éªŒ</h2>
<p>åœ¨æ•´ä¸ªé¡¹ç›®è½åœ°çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç§¯ç´¯äº†å‡ æ¡å…³é”®ç»éªŒï¼š</p>
<ol>
<li><strong>æç¤ºè¯å¿…é¡»è´´åˆä¸šåŠ¡æ ‡æ³¨ä½“ç³»:</strong> é€šç”¨çš„â€œå†…å®¹å®‰å…¨â€æç¤ºè¯è¿œè¿œä¸å¤Ÿã€‚åªæœ‰ç»“åˆå®¢æˆ·çš„ 10 ç±»è¿è§„åˆ†ç±»ï¼Œå¹¶ä¸æ–­å¯¹ç…§äººå·¥å®¡æ ¸æ ·æœ¬ä¿®æ­£ï¼Œæ‰èƒ½è®©æ¨¡å‹è¾“å‡ºç»“æœå’Œä¸šåŠ¡å£å¾„ä¿æŒä¸€è‡´ã€‚</li>
<li><strong>ReAct</strong> <strong>æ¡†æ¶å¸¦æ¥äº†å¯è§£é‡Šæ€§:</strong> æ¨¡å‹å…ˆè¿›è¡Œâ€œæ€è€ƒâ€ï¼Œå†ç»™å‡ºâ€œè¡ŒåŠ¨â€ï¼Œè®©æ¯ä¸€æ­¥é€»è¾‘æ›´åŠ é€æ˜ã€‚æˆ‘ä»¬å¯ä»¥å±•ç¤ºæ¨¡å‹çš„æ¨ç†é€»è¾‘ï¼ˆè¯­è¨€è¯†åˆ«ã€å…³é”®è¯æå–ã€ç±»åˆ«åŒ¹é…ï¼‰ï¼Œå¢å¼ºäº†å®¡æ ¸ç»“è®ºçš„å¯ä¿¡åº¦ã€‚</li>
<li><strong>æ•°æ®è´¨é‡æ˜¯ä¸Šé™ï¼Œæç¤ºè¯ä¼˜åŒ–æ˜¯ä¸‹é™:</strong> æˆ‘ä»¬ä½¿ç”¨çš„äººå·¥å®¡æ ¸æ•°æ®å­˜åœ¨å¤šäººã€åˆ†å¤šæ—¥å®Œæˆã€ç¼ºä¹å¤æ ¸ç­‰é—®é¢˜ï¼Œå¯¼è‡´æ ‡æ³¨ç»“æœæœ¬èº«å¸¦æœ‰å™ªå£°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¨¡å‹çš„å‡†ç¡®ç‡â€œå¤©èŠ±æ¿â€å°±ä¼šå—åˆ°å½±å“ã€‚æ¢å¥è¯è¯´ï¼Œæç¤ºè¯ä¼˜åŒ–èƒ½é€¼è¿‘äººå·¥æ°´å¹³ï¼Œä½†è¦è¿›ä¸€æ­¥çªç ´ï¼Œè¿˜éœ€è¦å®¢æˆ·æ”¹å–„æ•°æ®æ ‡æ³¨æµç¨‹ã€‚</li>
<li><strong>æˆæœ¬ä¸æ•ˆæœçš„æƒè¡¡:</strong> æˆ‘ä»¬åœ¨å®éªŒä¸­éªŒè¯äº† 3ã€5ã€10 è½®è¿­ä»£çš„å·®å¼‚ï¼Œæœ€ç»ˆé€‰æ‹© 5 è½®ä½œä¸ºæœ€ä¼˜ç‚¹ã€‚åŒæ ·åœ°ï¼Œtemperature å‚æ•°åœ¨è°ƒä¼˜é˜¶æ®µè®¾ç½®é«˜å€¼ï¼Œåœ¨ä¸Šçº¿é˜¶æ®µé”å®šä½å€¼ï¼Œä¹Ÿæ˜¯å¹³è¡¡åˆ›é€ æ€§ä¸ç¨³å®šæ€§çš„å·¥ç¨‹å®è·µã€‚</li>
</ol>
<h2 data-id="heading-23">æœªæ¥ä¼˜åŒ–æ–¹å‘</h2>
<ol>
<li>
<p><strong>è‡ªåŠ¨åŒ–æç¤ºè¯ä¼˜åŒ–</strong></p>
<ul>
<li>å¼•å…¥ AutoPromptã€RLHF ç­‰æ–¹æ³•ï¼Œè®©æç¤ºè¯è¿›åŒ–ä¸å†å®Œå…¨ä¾èµ–äººå·¥è¯•é”™ã€‚</li>
<li>åœ¨æ›´å¤šè¯­è¨€ã€æ›´å¤šè¯­å¢ƒä¸‹æŒç»­æ”¶æ•›ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ›´ç»†ç²’åº¦çš„åˆ†ç±»ä¸æ ‡ç­¾</strong></p>
<ul>
<li>å®¢æˆ·çš„ 10 ç±»è¿è§„ç±»åˆ«æ˜¯ç¬¬ä¸€å±‚çº§ã€‚</li>
<li>åç»­å¯ä»¥æ‰©å±•å­ç±»åˆ«ï¼ˆå¦‚â€œä»‡æ¨è¨€è®º â†’ é’ˆå¯¹æ€§åˆ« / ç§æ— / èŒä¸šâ€ï¼‰ï¼Œæ»¡è¶³æ›´ç²¾ç»†åŒ–çš„å†…å®¹æ²»ç†éœ€æ±‚ã€‚</li>
</ul>
</li>
<li>
<p><strong>æˆæœ¬ä¼˜åŒ–</strong></p>
<ul>
<li>ä¼šç»“åˆBedrockçš„cacheç‰¹æ€§ï¼Œå¢åŠ å¯¹system promptã€user promptçš„cacheï¼Œåœ¨ä¿è¯å®¡æ ¸æ•ˆæœçš„æƒ…å†µä¸‹ï¼Œå°½å¯èƒ½ä¼˜åŒ–æˆæœ¬ã€‚</li>
<li>æˆæœ¬è¯¦æƒ…è¯·å‚é˜…Amazon Bedrockæˆæœ¬é¡µé¢ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Faws.amazon.com%2Fcn%2Fbedrock%2Fpricing%2F" target="_blank" title="https://aws.amazon.com/cn/bedrock/pricing/" ref="nofollow noopener noreferrer">aws.amazon.com/cn/bedrock/â€¦</a>ï¼‰ä¸Claudeæ¨¡å‹æˆæœ¬é¡µé¢ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.claude.com%2Fzh-CN%2Fdocs%2Fabout-claude%2Fpricing" target="_blank" title="https://docs.claude.com/zh-CN/docs/about-claude/pricing" ref="nofollow noopener noreferrer">docs.claude.com/zh-CN/docs/â€¦</a>ï¼‰</li>
</ul>
</li>
</ol>
<h2 data-id="heading-24">ç»“è¯­</h2>
<p>ä»æœ€åˆçš„â€œè¯¯åˆ¤é¢‘å‘â€ï¼Œåˆ°æœ€ç»ˆå®ç°Â <strong>81%</strong> <strong>çš„æ•´ä½“å‡†ç¡®ç‡</strong>ï¼Œæˆ‘ä»¬é€šè¿‡Â <strong>æç¤ºè¯å·¥ç¨‹ + ReAct</strong> <strong>æ¡†æ¶ +</strong> <strong>å·¥ç¨‹åŒ–æ¶æ„</strong>ï¼Œå¸®åŠ©å®¢æˆ·æ„å»ºäº†ä¸€å¥—Â <strong>ç¨³å®šã€å¯è§‚æµ‹ã€å¯æ‰©å±•</strong>Â çš„æ¸¸æˆç¤¾åŒºå®¡æ ¸ç³»ç»Ÿã€‚</p>
<p>è¿™ä¸ªè¿‡ç¨‹çš„ä»·å€¼åœ¨äºï¼š</p>
<ul>
<li>å®ƒä¸ä»…æ˜¯ä¸€æ¬¡æ¨¡å‹è°ƒä¼˜å°è¯•ï¼Œè€Œæ˜¯ä¸€å¥—Â <strong>å¯å·¥ç¨‹åŒ–å¤åˆ¶çš„æ–¹æ³•è®º</strong>ï¼›</li>
<li>åœ¨Â <strong>UGC</strong> <strong>ç¤¾åŒºã€ç¤¾äº¤å¹³å°ã€ç›´æ’­å®¡æ ¸</strong>Â ç­‰åœºæ™¯ï¼Œéƒ½å¯ä»¥ç›´æ¥å¤ç”¨è¿™å¥—Â <strong>æç¤ºè¯ä¼˜åŒ– +</strong> <strong>æ¶æ„é—­ç¯</strong>Â çš„æ–¹æ¡ˆï¼›</li>
<li>é€šè¿‡Â <strong>æ—¥å¿—ã€åˆ¤ä¾‹åº“ã€è“ç»¿éƒ¨ç½²</strong>Â ç­‰å·¥ç¨‹å®è·µï¼Œæˆ‘ä»¬è®©å®¡æ ¸ç³»ç»Ÿå…·å¤‡äº†Â <strong>ä¸€è‡´æ€§ã€å¯è¿½æº¯æ€§å’Œå¿«é€Ÿè¿­ä»£èƒ½åŠ›</strong>ã€‚</li>
</ul>
<p>æœ€ç»ˆï¼Œè¿™ä¸ªé¡¹ç›®è®©æˆ‘ä»¬çœ‹åˆ°äº†Â <strong>å¤§è¯­è¨€æ¨¡å‹ +</strong> <strong>å·¥ç¨‹åŒ–è½åœ°</strong>Â åœ¨å†…å®¹å®¡æ ¸é¢†åŸŸçš„æ½œåŠ›ï¼š</p>
<ul>
<li><strong>æç¤ºè¯è°ƒä¼˜</strong>Â è®©æ¨¡å‹å¿«é€Ÿé€¼è¿‘ç”šè‡³è¶…è¶Šäººå·¥å®¡æ ¸çš„ä¸€è‡´æ€§ï¼›</li>
<li><strong>å·¥ç¨‹åŒ–æ¶æ„</strong>Â ç¡®ä¿ç³»ç»Ÿåœ¨Â <strong>é«˜å¹¶å‘ã€å¤§è§„æ¨¡å¤šè¯­è¨€</strong>Â å®¡æ ¸åœºæ™¯ä¸‹ä¾æ—§ç¨³å®šè¿è¡Œï¼›</li>
<li><strong>ç«¯åˆ°ç«¯é—­ç¯</strong>Â ä½¿å®¡æ ¸ç³»ç»Ÿä¸ä»…èƒ½è§£å†³å½“ä¸‹é—®é¢˜ï¼Œè¿˜èƒ½é€šè¿‡æ•°æ®å›æµä¸æ–­è‡ªæˆ‘è¿›åŒ–ã€‚</li>
</ul>
<p>*å‰è¿°ç‰¹å®šäºšé©¬é€Šäº‘ç§‘æŠ€ç”Ÿæˆå¼äººå·¥æ™ºèƒ½ç›¸å…³çš„æœåŠ¡ç›®å‰åœ¨äºšé©¬é€Šäº‘ç§‘æŠ€æµ·å¤–åŒºåŸŸå¯ç”¨ã€‚äºšé©¬é€Šäº‘ç§‘æŠ€ä¸­å›½åŒºåŸŸç›¸å…³äº‘æœåŠ¡ç”±è¥¿äº‘æ•°æ®å’Œå…‰ç¯æ–°ç½‘è¿è¥ï¼Œå…·ä½“ä¿¡æ¯ä»¥ä¸­å›½åŒºåŸŸå®˜ç½‘ä¸ºå‡†ã€‚</p>
<p><strong>æœ¬ç¯‡ä½œè€…</strong>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7c97474c05804f76a9aaec207af439bb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765763948&amp;x-signature=H5SQL8MHEiFJ%2FNbNyzoLqiI0eXE%3D" alt="1.webp" loading="lazy"/></p>
<blockquote>
<p>æœ¬æœŸæœ€æ–°å®éªŒã€Š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdev.amazoncloud.cn%2Fexperience%2Fcloudlab%3Fid%3D6695e4c5e1432f239fae485f%26visitfrom%3D3P_Juejintail_0415%26sc_medium%3Downed%26sc_campaign%3Dcloudlab%26sc_channel%3D3P_Juejintail_0415" target="_blank" title="https://dev.amazoncloud.cn/experience/cloudlab?id=6695e4c5e1432f239fae485f&amp;visitfrom=3P_Juejintail_0415&amp;sc_medium=owned&amp;sc_campaign=cloudlab&amp;sc_channel=3P_Juejintail_0415" ref="nofollow noopener noreferrer">å¤šæ¨¡ä¸€ç«™é€š â€”â€” Amazon Bedrock ä¸Šçš„åŸºç¡€æ¨¡å‹åˆä½“éªŒ</a>ã€‹</p>
<p>âœ¨ ç²¾å¿ƒè®¾è®¡ï¼Œæ—¨åœ¨å¼•å¯¼æ‚¨æ·±å…¥æ¢ç´¢Amazon Bedrockçš„æ¨¡å‹é€‰æ‹©ä¸è°ƒç”¨ã€æ¨¡å‹è‡ªåŠ¨åŒ–è¯„ä¼°ä»¥åŠå®‰å…¨å›´æ (Guardrail)ç­‰é‡è¦åŠŸèƒ½ã€‚æ— éœ€ç®¡ç†åŸºç¡€è®¾æ–½ï¼Œåˆ©ç”¨äºšé©¬é€ŠæŠ€æœ¯ä¸ç”Ÿæ€ï¼Œå¿«é€Ÿé›†æˆä¸éƒ¨ç½²ç”Ÿæˆå¼AIæ¨¡å‹èƒ½åŠ›ã€‚</p>
<p>â©ï¸[<a href="https://link.juejin.cn?target=https%3A%2F%2Fdev.amazoncloud.cn%2Fexperience%2Fcloudlab%3Fid%3D6695e4c5e1432f239fae485f%26visitfrom%3D3P_Juejintail_0415%26sc_medium%3Downed%26sc_campaign%3Dcloudlab%26sc_channel%3D3P_Juejintail_0415" target="_blank" title="https://dev.amazoncloud.cn/experience/cloudlab?id=6695e4c5e1432f239fae485f&amp;visitfrom=3P_Juejintail_0415&amp;sc_medium=owned&amp;sc_campaign=cloudlab&amp;sc_channel=3P_Juejintail_0415" ref="nofollow noopener noreferrer">ç‚¹å‡»è¿›å…¥å®éªŒ</a>] å³åˆ»å¼€å¯  AI å¼€å‘ä¹‹æ—…</p>
<p>æ„å»ºæ— é™, æ¢ç´¢å¯ç¨‹ï¼</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ThreadPoolExecutorçº¿ç¨‹å›æ”¶æµç¨‹è¯¦è§£]]></title>    <link>https://juejin.cn/post/7581004702944133147</link>    <guid>https://juejin.cn/post/7581004702944133147</guid>    <pubDate>2025-12-08T01:37:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7581004702944133147" data-draft-id="7581004702928109577" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ThreadPoolExecutorçº¿ç¨‹å›æ”¶æµç¨‹è¯¦è§£"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-08T01:37:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="jungly"/> <meta itemprop="url" content="https://juejin.cn/user/61228380597341"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ThreadPoolExecutorçº¿ç¨‹å›æ”¶æµç¨‹è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/61228380597341/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    jungly
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T01:37:35.000Z" title="Mon Dec 08 2025 01:37:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ThreadPoolExecutorçº¿ç¨‹å›æ”¶æµç¨‹è¯¦è§£</h2>
<h3 data-id="heading-1">æ ¸å¿ƒå‚æ•°å½±å“å›æ”¶</h3>
<h4 data-id="heading-2">1. <strong>å…³é”®å‚æ•°</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å½±å“å›æ”¶çš„ä¸‰å¤§å‚æ•°</span>
corePoolSize:      <span class="hljs-comment">// æ ¸å¿ƒçº¿ç¨‹æ•° - é»˜è®¤ä¸å›æ”¶</span>
maximumPoolSize:   <span class="hljs-comment">// æœ€å¤§çº¿ç¨‹æ•°</span>
keepAliveTime:     <span class="hljs-comment">// ç©ºé—²çº¿ç¨‹å­˜æ´»æ—¶é—´</span>
TimeUnit:          <span class="hljs-comment">// æ—¶é—´å•ä½</span>
allowCoreThreadTimeOut: <span class="hljs-comment">// æ˜¯å¦å…è®¸æ ¸å¿ƒçº¿ç¨‹è¶…æ—¶å›æ”¶</span>
</code></pre>
<h3 data-id="heading-3">2. <strong>çº¿ç¨‹å›æ”¶æµç¨‹</strong></h3>
<h4 data-id="heading-4">æµç¨‹æ¦‚è§ˆå›¾</h4>
<pre><code class="hljs language-ini" lang="ini">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  çº¿ç¨‹æ‰§è¡Œä»»åŠ¡å®Œæˆ                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  åˆ¤æ–­æ˜¯å¦ä¸ºæ ¸å¿ƒçº¿ç¨‹ï¼Ÿ                                â”‚
â”‚    â†“ æ˜¯                     â†“ å¦                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ æ ¸å¿ƒçº¿ç¨‹ä¸å›æ”¶    â”‚   â”‚ ä»é˜Ÿåˆ—è·å–æ–°ä»»åŠ¡      â”‚    â”‚
â”‚  â”‚ (é™¤éè®¾ç½®äº†      â”‚   â”‚  â†“                   â”‚    â”‚
â”‚  â”‚  allowCoreThreadâ”‚   â”‚ ç­‰å¾…keepAliveTime    â”‚    â”‚
â”‚  â”‚  <span class="hljs-attr">TimeOut</span>=<span class="hljs-literal">true</span>)  â”‚   â”‚  â†“                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ è¶…æ—¶æœªè·å–åˆ°ä»»åŠ¡ï¼Ÿ    â”‚    â”‚
â”‚                        â”‚   â†“ æ˜¯                â”‚    â”‚
â”‚                        â”‚ çº¿ç¨‹è¢«å›æ”¶            â”‚    â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-5">3. <strong>è¯¦ç»†å›æ”¶æœºåˆ¶</strong></h3>
<h4 data-id="heading-6">3.1 <strong>Workerï¼ˆå·¥ä½œçº¿ç¨‹ï¼‰çš„ç”Ÿå‘½å‘¨æœŸ</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ThreadPoolExecutorä¸­çš„Workerå†…éƒ¨ç±»</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Worker</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractQueuedSynchronizer</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> {
    <span class="hljs-keyword">final</span> Thread thread;    <span class="hljs-comment">// å®é™…æ‰§è¡Œçš„çº¿ç¨‹</span>
    Runnable firstTask;     <span class="hljs-comment">// åˆå§‹ä»»åŠ¡</span>
    
    Worker(Runnable firstTask) {
        <span class="hljs-built_in">this</span>.firstTask = firstTask;
        <span class="hljs-built_in">this</span>.thread = getThreadFactory().newThread(<span class="hljs-built_in">this</span>);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
        runWorker(<span class="hljs-built_in">this</span>);  <span class="hljs-comment">// æ ¸å¿ƒæ‰§è¡Œé€»è¾‘</span>
    }
}
</code></pre>
<h4 data-id="heading-7">3.2 <strong>æ ¸å¿ƒæ–¹æ³•ï¼šrunWorker()</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">runWorker</span><span class="hljs-params">(Worker w)</span> {
    <span class="hljs-type">Thread</span> <span class="hljs-variable">wt</span> <span class="hljs-operator">=</span> Thread.currentThread();
    <span class="hljs-type">Runnable</span> <span class="hljs-variable">task</span> <span class="hljs-operator">=</span> w.firstTask;
    w.firstTask = <span class="hljs-literal">null</span>;
    w.unlock(); <span class="hljs-comment">// å…è®¸ä¸­æ–­</span>
    <span class="hljs-type">boolean</span> <span class="hljs-variable">completedAbruptly</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;
    
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// å¾ªç¯è·å–ä»»åŠ¡å¹¶æ‰§è¡Œ</span>
        <span class="hljs-keyword">while</span> (task != <span class="hljs-literal">null</span> || (task = getTask()) != <span class="hljs-literal">null</span>) {
            w.lock();
            <span class="hljs-comment">// æ£€æŸ¥çº¿ç¨‹æ˜¯å¦åº”è¯¥è¢«ä¸­æ–­</span>
            <span class="hljs-keyword">if</span> ((runStateAtLeast(ctl.get(), STOP) ||
                 (Thread.interrupted() &amp;&amp; runStateAtLeast(ctl.get(), STOP))) &amp;&amp;
                !wt.isInterrupted())
                wt.interrupt();
            <span class="hljs-keyword">try</span> {
                beforeExecute(wt, task);  <span class="hljs-comment">// é’©å­æ–¹æ³•</span>
                <span class="hljs-type">Throwable</span> <span class="hljs-variable">thrown</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
                <span class="hljs-keyword">try</span> {
                    task.run();  <span class="hljs-comment">// æ‰§è¡Œä»»åŠ¡</span>
                } <span class="hljs-keyword">catch</span> (RuntimeException x) {
                    thrown = x; <span class="hljs-keyword">throw</span> x;
                } <span class="hljs-keyword">catch</span> (Error x) {
                    thrown = x; <span class="hljs-keyword">throw</span> x;
                } <span class="hljs-keyword">catch</span> (Throwable x) {
                    thrown = x; <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(x);
                } <span class="hljs-keyword">finally</span> {
                    afterExecute(task, thrown);  <span class="hljs-comment">// é’©å­æ–¹æ³•</span>
                }
            } <span class="hljs-keyword">finally</span> {
                task = <span class="hljs-literal">null</span>;
                w.completedTasks++;
                w.unlock();
            }
        }
        completedAbruptly = <span class="hljs-literal">false</span>;
    } <span class="hljs-keyword">finally</span> {
        <span class="hljs-comment">// å·¥ä½œçº¿ç¨‹é€€å‡ºå¤„ç†</span>
        processWorkerExit(w, completedAbruptly);
    }
}
</code></pre>
<h4 data-id="heading-8">3.3 <strong>å…³é”®æ–¹æ³•ï¼šgetTask() - å†³å®šçº¿ç¨‹æ˜¯å¦å›æ”¶</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> Runnable <span class="hljs-title function_">getTask</span><span class="hljs-params">()</span> {
    <span class="hljs-type">boolean</span> <span class="hljs-variable">timedOut</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// ä¸Šæ¬¡pollæ˜¯å¦è¶…æ—¶</span>
    
    <span class="hljs-keyword">for</span> (;;) {
        <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> ctl.get();
        <span class="hljs-type">int</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> runStateOf(c);
        
        <span class="hljs-comment">// æ£€æŸ¥çº¿ç¨‹æ± çŠ¶æ€</span>
        <span class="hljs-keyword">if</span> (rs &gt;= SHUTDOWN &amp;&amp; (rs &gt;= STOP || workQueue.isEmpty())) {
            decrementWorkerCount();
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
        
        <span class="hljs-type">int</span> <span class="hljs-variable">wc</span> <span class="hljs-operator">=</span> workerCountOf(c);
        
        <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦éœ€è¦è¶…æ—¶æ§åˆ¶</span>
        <span class="hljs-type">boolean</span> <span class="hljs-variable">timed</span> <span class="hljs-operator">=</span> allowCoreThreadTimeOut || wc &gt; corePoolSize;
        
        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦éœ€è¦å‡å°‘çº¿ç¨‹æ•°</span>
        <span class="hljs-keyword">if</span> ((wc &gt; maximumPoolSize || (timed &amp;&amp; timedOut))
            &amp;&amp; (wc &gt; <span class="hljs-number">1</span> || workQueue.isEmpty())) {
            <span class="hljs-keyword">if</span> (compareAndDecrementWorkerCount(c))
                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
            <span class="hljs-keyword">continue</span>;
        }
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// å…³é”®ï¼šæ ¹æ®timedå†³å®šè·å–ä»»åŠ¡çš„æ–¹å¼</span>
            <span class="hljs-type">Runnable</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> timed ?
                workQueue.poll(keepAliveTime, TimeUnit.NANOSECONDS) :
                workQueue.take();  <span class="hljs-comment">// æ ¸å¿ƒçº¿ç¨‹é˜»å¡ç­‰å¾…</span>
            
            <span class="hljs-keyword">if</span> (r != <span class="hljs-literal">null</span>)
                <span class="hljs-keyword">return</span> r;
            timedOut = <span class="hljs-literal">true</span>;  <span class="hljs-comment">// æ ‡è®°è¶…æ—¶</span>
        } <span class="hljs-keyword">catch</span> (InterruptedException retry) {
            timedOut = <span class="hljs-literal">false</span>;
        }
    }
}
</code></pre>
<h4 data-id="heading-9">3.4 <strong>çº¿ç¨‹é€€å‡ºï¼šprocessWorkerExit()</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processWorkerExit</span><span class="hljs-params">(Worker w, <span class="hljs-type">boolean</span> completedAbruptly)</span> {
    <span class="hljs-keyword">if</span> (completedAbruptly) <span class="hljs-comment">// å¼‚å¸¸é€€å‡º</span>
        decrementWorkerCount();
    
    <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">mainLock</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.mainLock;
    mainLock.lock();
    <span class="hljs-keyword">try</span> {
        completedTaskCount += w.completedTasks;
        workers.remove(w);  <span class="hljs-comment">// ä»workersé›†åˆä¸­ç§»é™¤</span>
    } <span class="hljs-keyword">finally</span> {
        mainLock.unlock();
    }
    
    <span class="hljs-comment">// å°è¯•ç»ˆæ­¢çº¿ç¨‹æ± </span>
    tryTerminate();
    
    <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> ctl.get();
    <span class="hljs-keyword">if</span> (runStateLessThan(c, STOP)) {
        <span class="hljs-keyword">if</span> (!completedAbruptly) {
            <span class="hljs-comment">// æ­£å¸¸é€€å‡ºçš„çº¿ç¨‹å¤„ç†</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">min</span> <span class="hljs-operator">=</span> allowCoreThreadTimeOut ? <span class="hljs-number">0</span> : corePoolSize;
            <span class="hljs-keyword">if</span> (min == <span class="hljs-number">0</span> &amp;&amp; !workQueue.isEmpty())
                min = <span class="hljs-number">1</span>;
            <span class="hljs-keyword">if</span> (workerCountOf(c) &gt;= min)
                <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-comment">// è¡¥å……æ–°çš„Workerï¼ˆç»´æŒæœ€å°çº¿ç¨‹æ•°ï¼‰</span>
        addWorker(<span class="hljs-literal">null</span>, <span class="hljs-literal">false</span>);
    }
}
</code></pre>
<h3 data-id="heading-10">4. <strong>å›æ”¶åœºæ™¯åˆ†æ</strong></h3>
<h4 data-id="heading-11">åœºæ™¯1ï¼š<strong>éæ ¸å¿ƒçº¿ç¨‹ç©ºé—²è¶…æ—¶</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å‡è®¾é…ç½®ï¼š</span>
<span class="hljs-comment">// corePoolSize=5, maximumPoolSize=10, keepAliveTime=60s, allowCoreThreadTimeOut=false</span>

<span class="hljs-comment">// æ‰§è¡Œè¿‡ç¨‹ï¼š</span>
<span class="hljs-comment">// 1. å½“å‰æœ‰8ä¸ªçº¿ç¨‹ï¼ˆ5æ ¸å¿ƒ+3éæ ¸å¿ƒï¼‰</span>
<span class="hljs-comment">// 2. ä»»åŠ¡å‡å°‘ï¼Œ3ä¸ªéæ ¸å¿ƒçº¿ç¨‹ç©ºé—²</span>
<span class="hljs-comment">// 3. æ¯ä¸ªéæ ¸å¿ƒçº¿ç¨‹è°ƒç”¨ workQueue.poll(60, SECONDS)</span>
<span class="hljs-comment">// 4. 60ç§’å†…æœªè·å–åˆ°ä»»åŠ¡ â†’ pollè¿”å›null â†’ getTask()è¿”å›null</span>
<span class="hljs-comment">// 5. runWorker()å¾ªç¯ç»“æŸ â†’ processWorkerExit()ç§»é™¤Worker</span>
<span class="hljs-comment">// 6. çº¿ç¨‹æ•°é™å›5ä¸ªï¼ˆæ ¸å¿ƒçº¿ç¨‹ï¼‰</span>
</code></pre>
<h4 data-id="heading-12">åœºæ™¯2ï¼š<strong>æ ¸å¿ƒçº¿ç¨‹è¶…æ—¶å›æ”¶ï¼ˆéœ€è¦è®¾ç½®ï¼‰</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å¼€å¯æ ¸å¿ƒçº¿ç¨‹è¶…æ—¶</span>
executor.allowCoreThreadTimeOut(<span class="hljs-literal">true</span>);

<span class="hljs-comment">// æ‰§è¡Œè¿‡ç¨‹ï¼š</span>
<span class="hljs-comment">// 1. æ‰€æœ‰çº¿ç¨‹éƒ½ä¼šè°ƒç”¨ timed ? poll() : take()</span>
<span class="hljs-comment">// 2. å½“allowCoreThreadTimeOut=trueæ—¶ï¼Œtimedæ°¸è¿œä¸ºtrue</span>
<span class="hljs-comment">// 3. æ‰€æœ‰çº¿ç¨‹éƒ½ä¼šè°ƒç”¨ workQueue.poll(keepAliveTime, unit)</span>
<span class="hljs-comment">// 4. è¶…æ—¶åæ‰€æœ‰çº¿ç¨‹éƒ½å¯èƒ½è¢«å›æ”¶ï¼Œç›´åˆ°çº¿ç¨‹æ•°ä¸º0</span>
</code></pre>
<h4 data-id="heading-13">åœºæ™¯3ï¼š<strong>çº¿ç¨‹æ± å…³é—­æ—¶</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// shutdown()æ—¶ï¼š</span>
<span class="hljs-comment">// 1. ç©ºé—²çº¿ç¨‹ä¼šä»getTask()ä¸­è¿”å›nullï¼ˆæ£€æŸ¥åˆ°SHUTDOWNçŠ¶æ€ï¼‰</span>
<span class="hljs-comment">// 2. æ­£åœ¨æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹ä¼šç»§ç»­æ‰§è¡Œå®Œå½“å‰ä»»åŠ¡</span>
<span class="hljs-comment">// 3. æ‰€æœ‰çº¿ç¨‹æœ€ç»ˆéƒ½ä¼šè¢«å›æ”¶</span>

<span class="hljs-comment">// shutdownNow()æ—¶ï¼š</span>
<span class="hljs-comment">// 1. æ‰€æœ‰çº¿ç¨‹éƒ½ä¼šè¢«ä¸­æ–­ï¼ˆåŒ…æ‹¬æ­£åœ¨æ‰§è¡Œä»»åŠ¡çš„ï¼‰</span>
<span class="hljs-comment">// 2. getTask()ä¼šç«‹å³è¿”å›null</span>
<span class="hljs-comment">// 3. æ‰€æœ‰çº¿ç¨‹å¿«é€Ÿé€€å‡º</span>
</code></pre>
<h3 data-id="heading-14">5. <strong>æºç ä¸­çº¿ç¨‹æ•°çš„ç»´æŠ¤</strong></h3>
<h4 data-id="heading-15">çº¿ç¨‹è®¡æ•°ï¼ˆctlå­—æ®µï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ctlæ˜¯ä¸€ä¸ªAtomicIntegerï¼ŒåŒ…å«ä¸¤éƒ¨åˆ†ä¿¡æ¯ï¼š</span>
<span class="hljs-comment">// é«˜3ä½ï¼šçº¿ç¨‹æ± çŠ¶æ€ï¼ˆRUNNING, SHUTDOWN, STOP, TIDYING, TERMINATEDï¼‰</span>
<span class="hljs-comment">// ä½29ä½ï¼šå·¥ä½œçº¿ç¨‹æ•°é‡</span>

<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">ctl</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(ctlOf(RUNNING, <span class="hljs-number">0</span>));

<span class="hljs-comment">// çº¿ç¨‹æ•°æ“ä½œæ–¹æ³•</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">compareAndDecrementWorkerCount</span><span class="hljs-params">(<span class="hljs-type">int</span> expect)</span> {
    <span class="hljs-keyword">return</span> ctl.compareAndSet(expect, expect - <span class="hljs-number">1</span>);
}

<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">decrementWorkerCount</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">do</span> {} <span class="hljs-keyword">while</span> (!compareAndDecrementWorkerCount(ctl.get()));
}
</code></pre>
<h3 data-id="heading-16">6. <strong>å®é™…æ¡ˆä¾‹æ¼”ç¤º</strong></h3>
<h4 data-id="heading-17">ç¤ºä¾‹ï¼šè§‚å¯Ÿçº¿ç¨‹å›æ”¶</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadPoolRecycleDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">ThreadPoolExecutor</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>(
            <span class="hljs-number">2</span>,  <span class="hljs-comment">// corePoolSize</span>
            <span class="hljs-number">5</span>,  <span class="hljs-comment">// maximumPoolSize</span>
            <span class="hljs-number">3</span>,  <span class="hljs-comment">// keepAliveTime</span>
            TimeUnit.SECONDS,
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedBlockingQueue</span>&lt;&gt;(<span class="hljs-number">10</span>)
        );
        
        <span class="hljs-comment">// æäº¤10ä¸ªä»»åŠ¡</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {
            <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">taskId</span> <span class="hljs-operator">=</span> i;
            executor.execute(() -&gt; {
                System.out.println(Thread.currentThread().getName() + <span class="hljs-string">"æ‰§è¡Œä»»åŠ¡"</span> + taskId);
                <span class="hljs-keyword">try</span> {
                    Thread.sleep(<span class="hljs-number">1000</span>);  <span class="hljs-comment">// æ¨¡æ‹Ÿä»»åŠ¡æ‰§è¡Œ</span>
                } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                    e.printStackTrace();
                }
            });
        }
        
        <span class="hljs-comment">// ç›‘æ§çº¿ç¨‹æ•°å˜åŒ–</span>
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
                System.out.println(<span class="hljs-string">"å½“å‰çº¿ç¨‹æ•°: "</span> + executor.getPoolSize() + 
                                 <span class="hljs-string">", æ´»åŠ¨çº¿ç¨‹æ•°: "</span> + executor.getActiveCount());
                <span class="hljs-keyword">try</span> {
                    Thread.sleep(<span class="hljs-number">500</span>);
                } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                    <span class="hljs-keyword">break</span>;
                }
            }
        }).start();
        
        Thread.sleep(<span class="hljs-number">10000</span>);  <span class="hljs-comment">// ç­‰å¾…10ç§’</span>
        
        <span class="hljs-comment">// è§‚å¯Ÿï¼šéæ ¸å¿ƒçº¿ç¨‹ç©ºé—²3ç§’åæ˜¯å¦è¢«å›æ”¶</span>
        System.out.println(<span class="hljs-string">"10ç§’åçº¿ç¨‹æ•°: "</span> + executor.getPoolSize());
        
        executor.shutdown();
    }
}
</code></pre>
<h3 data-id="heading-18">7. <strong>æ³¨æ„äº‹é¡¹å’Œæœ€ä½³å®è·µ</strong></h3>
<h4 data-id="heading-19">æ³¨æ„äº‹é¡¹ï¼š</h4>
<ol>
<li><strong>æ ¸å¿ƒçº¿ç¨‹é»˜è®¤ä¸å›æ”¶</strong>ï¼šé™¤éè®¾ç½® <code>allowCoreThreadTimeOut(true)</code></li>
<li><strong>å›æ”¶æ˜¯å¼‚æ­¥çš„</strong>ï¼šä¸ä¼šç«‹å³å›æ”¶ï¼Œéœ€è¦ç­‰å¾…ç©ºé—²è¶…æ—¶</li>
<li><strong>çº¿ç¨‹ä¸­æ–­</strong>ï¼š<code>shutdownNow()</code>ä¼šä¸­æ–­æ‰€æœ‰çº¿ç¨‹ï¼Œå¯èƒ½å½±å“ä»»åŠ¡æ‰§è¡Œ</li>
<li><strong>çº¿ç¨‹å¤ç”¨</strong>ï¼šçº¿ç¨‹æ‰§è¡Œå®Œä¸€ä¸ªä»»åŠ¡åä¸ä¼šé”€æ¯ï¼Œè€Œæ˜¯ç»§ç»­è·å–æ–°ä»»åŠ¡</li>
</ol>
<h4 data-id="heading-20">æœ€ä½³å®è·µï¼š</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 1. æ ¹æ®ä¸šåŠ¡åœºæ™¯åˆç†è®¾ç½®å‚æ•°</span>
<span class="hljs-type">ThreadPoolExecutor</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>(
    Runtime.getRuntime().availableProcessors(),  <span class="hljs-comment">// CPUå¯†é›†å‹</span>
    Runtime.getRuntime().availableProcessors() * <span class="hljs-number">2</span>,  <span class="hljs-comment">// IOå¯†é›†å‹å¯è®¾æ›´å¤§</span>
    <span class="hljs-number">60L</span>, TimeUnit.SECONDS,
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedBlockingQueue</span>&lt;&gt;(<span class="hljs-number">1000</span>)
);

<span class="hljs-comment">// 2. ç›‘æ§çº¿ç¨‹æ± çŠ¶æ€</span>
executor.setRejectedExecutionHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>.CallerRunsPolicy());
executor.setThreadFactory(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomThreadFactory</span>());

<span class="hljs-comment">// 3. ä¼˜é›…å…³é—­</span>
Runtime.getRuntime().addShutdownHook(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    executor.shutdown();
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">if</span> (!executor.awaitTermination(<span class="hljs-number">60</span>, TimeUnit.SECONDS)) {
            executor.shutdownNow();
        }
    } <span class="hljs-keyword">catch</span> (InterruptedException e) {
        executor.shutdownNow();
    }
}));
</code></pre>
<h4 data-id="heading-21">çº¿ç¨‹å›æ”¶æµç¨‹å›¾ï¼š</h4>
<pre><code class="hljs language-vbscript" lang="vbscript">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             ä»»åŠ¡æ‰§è¡Œå®Œæ¯•                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è¿›å…¥getTask()æ–¹æ³•è·å–æ–°ä»»åŠ¡                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ£€æŸ¥çº¿ç¨‹æ± çŠ¶æ€                             â”‚
â”‚  â†“ å¦‚æœSHUTDOWN/<span class="hljs-keyword">STOP</span> â†’ è¿”å›<span class="hljs-literal">null</span>            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  åˆ¤æ–­æ˜¯å¦éœ€è¦è¶…æ—¶æ§åˆ¶ï¼š                      â”‚
â”‚  timed = allowCoreThreadTimeOut ||          â”‚
â”‚         workerCount &gt; corePoolSize          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  timedä¸º<span class="hljs-literal">true</span>: è°ƒç”¨poll(keepAliveTime)      â”‚
â”‚  timedä¸º<span class="hljs-literal">false</span>: è°ƒç”¨take()ï¼ˆé˜»å¡ç­‰å¾…ï¼‰       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  pollè¶…æ—¶è¿”å›<span class="hljs-literal">null</span> â†’ æ ‡è®°timedOut=<span class="hljs-literal">true</span>      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ£€æŸ¥æ˜¯å¦åº”è¯¥å‡å°‘çº¿ç¨‹æ•°                     â”‚
â”‚  â†“ å¦‚æœæ»¡è¶³æ¡ä»¶ â†’ CASå‡å°‘è®¡æ•°å¹¶è¿”å›<span class="hljs-literal">null</span>     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  getTask()è¿”å›<span class="hljs-literal">null</span> â†’ é€€å‡ºrunWorkerå¾ªç¯     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ‰§è¡ŒprocessWorkerExit()                   â”‚
â”‚  â†“ ä»workersé›†åˆç§»é™¤Worker                 â”‚
â”‚  â†“ å‡å°‘çº¿ç¨‹è®¡æ•°                            â”‚
â”‚  â†“ å°è¯•ç»ˆæ­¢çº¿ç¨‹æ±                           â”‚
â”‚  â†“ å¿…è¦æ—¶è¡¥å……æ–°Worker                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Workerçº¿ç¨‹ç»“æŸè¿è¡Œ â†’ è¢«JVMå›æ”¶             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>è¿™å°±æ˜¯ThreadPoolExecutorçº¿ç¨‹å›æ”¶çš„å®Œæ•´æµç¨‹ï¼Œæ ¸å¿ƒåœ¨äº<code>getTask()</code>æ–¹æ³•å¦‚ä½•æ ¹æ®é…ç½®å†³å®šçº¿ç¨‹æ˜¯å¦åº”è¯¥ç»§ç»­ç­‰å¾…ä»»åŠ¡è¿˜æ˜¯è¢«å›æ”¶ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ‡RabbitMQ ä»å…¥é—¨åˆ°ä¸šåŠ¡å®æˆ˜ï¼šä¸€ä¸ª Java ç¨‹åºå‘˜çš„å®æˆ˜æ‰‹è®°]]></title>    <link>https://juejin.cn/post/7580834172060270627</link>    <guid>https://juejin.cn/post/7580834172060270627</guid>    <pubDate>2025-12-08T01:37:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580834172060270627" data-draft-id="7580809247735365672" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ‡RabbitMQ ä»å…¥é—¨åˆ°ä¸šåŠ¡å®æˆ˜ï¼šä¸€ä¸ª Java ç¨‹åºå‘˜çš„å®æˆ˜æ‰‹è®°"/> <meta itemprop="keywords" content="åç«¯,Java"/> <meta itemprop="datePublished" content="2025-12-08T01:37:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤©å¤©æ‘¸é±¼çš„javaå·¥ç¨‹å¸ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/3109843365802925"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ‡RabbitMQ ä»å…¥é—¨åˆ°ä¸šåŠ¡å®æˆ˜ï¼šä¸€ä¸ª Java ç¨‹åºå‘˜çš„å®æˆ˜æ‰‹è®°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3109843365802925/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤©å¤©æ‘¸é±¼çš„javaå·¥ç¨‹å¸ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T01:37:58.000Z" title="Mon Dec 08 2025 01:37:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸ‡RabbitMQ ä»å…¥é—¨åˆ°ä¸šåŠ¡å®æˆ˜ï¼šä¸€ä¸ª Java ç¨‹åºå‘˜çš„å®æˆ˜æ‰‹è®°</h2>
<blockquote>
<p>ä½œè€…ï¼šå¤©å¤©æ‘¸é±¼çš„javaå·¥ç¨‹å¸ˆ<br/>
æ ‡ç­¾ï¼šRabbitMQã€æ¶ˆæ¯é˜Ÿåˆ—ã€ä¸­é—´ä»¶ã€å¾®æœåŠ¡ã€Java å®æˆ˜</p>
</blockquote>
<hr/>
<h3 data-id="heading-1">ğŸ”§ ä¸ºä»€ä¹ˆè¿˜è¦å­¦ RabbitMQï¼Ÿ</h3>
<p>åœ¨å¾®æœåŠ¡å¤§è¡Œå…¶é“çš„ä»Šå¤©ï¼Œç³»ç»Ÿæ‹†åˆ†å¸¦æ¥äº†çµæ´»æ€§ï¼Œä¹Ÿå¸¦æ¥äº†æ–°é—®é¢˜ï¼š<strong>æœåŠ¡é—´é€šä¿¡å¦‚ä½•è§£è€¦ï¼Ÿé«˜å¹¶å‘ä¸‹å¦‚ä½•å‰Šå³°å¡«è°·ï¼Ÿç³»ç»Ÿä¹‹é—´å¦‚ä½•å¼‚æ­¥å¤„ç†ï¼Ÿ</strong> â€”â€”æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæˆäº†è¿™ç±»é—®é¢˜çš„â€œé“¶å¼¹â€ã€‚</p>
<p>ä½œä¸ºä¸€åå¹²äº† 8 å¹´ Java çš„å¼€å‘ï¼Œæˆ‘ç”¨è¿‡ ActiveMQã€Kafkaã€RocketMQï¼Œä½† RabbitMQ å§‹ç»ˆæ˜¯æˆ‘å¿ƒä¸­çš„â€œç‘å£«å†›åˆ€â€ï¼šç¨³å®šã€ä¼˜é›…ã€æ–‡æ¡£å®Œå–„ã€ç¤¾åŒºæ´»è·ƒï¼Œ<strong>å°¤å…¶é€‚åˆä¸­å°å‹ç³»ç»Ÿå’Œå¯¹å¯é æ€§è¦æ±‚é«˜çš„ä¸šåŠ¡åœºæ™¯ã€‚</strong></p>
<hr/>
<h3 data-id="heading-2">âš™ï¸ å¿«é€Ÿä¸Šæ‰‹ RabbitMQ</h3>
<h4 data-id="heading-3">1. å®‰è£… RabbitMQï¼ˆæœ¬åœ°/å®¹å™¨ï¼‰</h4>
<p>æ¨èä½¿ç”¨ Dockerï¼š</p>
<pre><code class="hljs language-css" lang="css">docker run -d <span class="hljs-attr">--hostname</span> my-rabbit <span class="hljs-attr">--name</span> rabbitmq \
  -<span class="hljs-selector-tag">p</span> <span class="hljs-number">5672</span>:<span class="hljs-number">5672</span> -p <span class="hljs-number">15672</span>:<span class="hljs-number">15672</span> \
  rabbitmq:<span class="hljs-number">3</span>-management
</code></pre>
<blockquote>
<p>è®¿é—®ç®¡ç†ç•Œé¢ï¼š<a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A15672%2F" target="_blank" title="http://localhost:15672/" ref="nofollow noopener noreferrer">http://localhost:15672</a><br/>
é»˜è®¤è´¦å·å¯†ç ï¼š<code>guest</code> / <code>guest</code></p>
</blockquote>
<hr/>
<h4 data-id="heading-4">2. Java ä¸­ä½¿ç”¨ RabbitMQï¼ˆSpring Bootï¼‰</h4>
<h5 data-id="heading-5">ä¾èµ–å¼•å…¥</h5>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h5 data-id="heading-6">é…ç½® application.yml</h5>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spring:</span>
  <span class="hljs-attr">rabbitmq:</span>
    <span class="hljs-attr">host:</span> <span class="hljs-string">localhost</span>
    <span class="hljs-attr">port:</span> <span class="hljs-number">5672</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">guest</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">guest</span>
</code></pre>
<h5 data-id="heading-7">åˆ›å»ºé…ç½®ç±»ï¼ˆå®šä¹‰äº¤æ¢æœºã€é˜Ÿåˆ—ã€ç»‘å®šå…³ç³»ï¼‰</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RabbitConfig</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">QUEUE</span> <span class="hljs-operator">=</span> <span class="hljs-string">"order.queue"</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">EXCHANGE</span> <span class="hljs-operator">=</span> <span class="hljs-string">"order.exchange"</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">ROUTING_KEY</span> <span class="hljs-operator">=</span> <span class="hljs-string">"order.#"</span>;

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Queue <span class="hljs-title function_">queue</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Queue</span>(QUEUE, <span class="hljs-literal">true</span>);
    }

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> TopicExchange <span class="hljs-title function_">exchange</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TopicExchange</span>(EXCHANGE);
    }

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Binding <span class="hljs-title function_">binding</span><span class="hljs-params">(Queue queue, TopicExchange exchange)</span> {
        <span class="hljs-keyword">return</span> BindingBuilder.bind(queue).to(exchange).with(ROUTING_KEY);
    }
}
</code></pre>
<h5 data-id="heading-8">å‘é€æ¶ˆæ¯</h5>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@RestController</span>
<span class="hljs-variable">@RequiredArgsConstructor</span>
public class OrderController {

    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">final</span> <span class="hljs-selector-tag">RabbitTemplate</span> <span class="hljs-selector-tag">rabbitTemplate</span>;

    @<span class="hljs-selector-tag">PostMapping</span>(<span class="hljs-string">"/order"</span>)
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">createOrder</span>(<span class="hljs-variable">@RequestBody</span> Order order) {
        <span class="hljs-selector-tag">rabbitTemplate</span><span class="hljs-selector-class">.convertAndSend</span>(
            RabbitConfig.EXCHANGE,
            <span class="hljs-string">"order.create"</span>,
            order
        );
        <span class="hljs-selector-tag">return</span> "<span class="hljs-selector-tag">Order</span> <span class="hljs-selector-tag">sent</span>!";
    }
}
</code></pre>
<h5 data-id="heading-9">æ¶ˆè´¹æ¶ˆæ¯</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderConsumer</span> {

    <span class="hljs-meta">@RabbitListener(queues = RabbitConfig.QUEUE)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleOrder</span><span class="hljs-params">(Order order)</span> {
        System.out.println(<span class="hljs-string">"Received order: "</span> + order);
        <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> ä¸šåŠ¡å¤„ç†</span>
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-10">ğŸ”„ ç»å…¸ä¸šåŠ¡åœºæ™¯å®æˆ˜</h3>
<h4 data-id="heading-11">âœ… åœºæ™¯ä¸€ï¼šå¼‚æ­¥å¤„ç†ï¼Œæå‡å“åº”é€Ÿåº¦</h4>
<p><strong>ä¸šåŠ¡èƒŒæ™¯ï¼š</strong> ç”¨æˆ·ä¸‹å•åï¼Œéœ€è¦æ¨é€çŸ­ä¿¡å’Œé‚®ä»¶é€šçŸ¥ï¼Œä½†è¿™äº›è€—æ—¶æ“ä½œä¸åº”å¡ä½ä¸»æµç¨‹ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong> ä¸»çº¿ç¨‹åªè´Ÿè´£ä¸‹å•ï¼Œé€šçŸ¥é€»è¾‘å¼‚æ­¥æŠ•é€’åˆ° MQï¼Œç”±æ¶ˆè´¹è€…å¼‚æ­¥ç›‘å¬ã€‚</p>
<p><strong>äº®ç‚¹ï¼š</strong> å“åº”å¿«ã€ç³»ç»Ÿè§£è€¦ï¼›é€šçŸ¥ç³»ç»Ÿå¯ä»¥ç‹¬ç«‹éƒ¨ç½²ã€å•ç‹¬æ‰©å®¹ã€‚</p>
<hr/>
<h4 data-id="heading-12">âš ï¸ åœºæ™¯äºŒï¼šå‰Šå³°å¡«è°·ï¼Œåº”å¯¹é«˜å¹¶å‘ç§’æ€</h4>
<p><strong>ä¸šåŠ¡èƒŒæ™¯ï¼š</strong> ç§’æ€æ´»åŠ¨ä¸­ï¼Œè®¢å•ç³»ç»Ÿè¢«é«˜å¹¶å‘è¯·æ±‚æ‰“çˆ†ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong> æ‰€æœ‰è¯·æ±‚å…ˆå†™å…¥ MQï¼Œç”±åå°å¼‚æ­¥æ¶ˆè´¹é™é€Ÿå¤„ç†ã€‚</p>
<p><strong>äº®ç‚¹ï¼š</strong> æ§åˆ¶ç³»ç»Ÿç¬æ—¶å‹åŠ›ï¼Œé¿å…é›ªå´©ï¼›ç»“åˆä»¤ç‰Œæ¡¶ + ç¼“å­˜é¢„å‡åº“å­˜æ›´ç¨³ã€‚</p>
<hr/>
<h4 data-id="heading-13">ğŸ” åœºæ™¯ä¸‰ï¼šæ¶ˆæ¯å¯é æŠ•é€’ + ACK æœºåˆ¶</h4>
<p><strong>é—®é¢˜ï¼š</strong> ç½‘ç»œæŠ–åŠ¨æˆ–ç³»ç»Ÿå´©æºƒå¯èƒ½å¯¼è‡´æ¶ˆæ¯ä¸¢å¤±ã€‚</p>
<p><strong>æ–¹æ¡ˆï¼š</strong></p>
<ul>
<li>ç”Ÿäº§è€…å¼€å¯ <code>confirmCallback</code> ç¡®è®¤æ¶ˆæ¯æ˜¯å¦é€è¾¾äº¤æ¢æœºï¼›</li>
<li>æ¶ˆè´¹è€…ä½¿ç”¨æ‰‹åŠ¨ ACKï¼Œå¤„ç†å®Œå†ç¡®è®¤ï¼›</li>
<li>æ¶ˆè´¹å¤±è´¥å¯é‡è¯•æˆ–è½¬å…¥æ­»ä¿¡é˜Ÿåˆ—ã€‚</li>
</ul>
<h5 data-id="heading-14">æ‰‹åŠ¨ ACK ç¤ºä¾‹ï¼š</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RabbitListener(queues = "order.queue", ackMode = "MANUAL")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">process</span><span class="hljs-params">(Message message, Channel channel)</span> <span class="hljs-keyword">throws</span> IOException {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// ä¸šåŠ¡å¤„ç†</span>
        channel.basicAck(message.getMessageProperties().getDeliveryTag(), <span class="hljs-literal">false</span>);
    } <span class="hljs-keyword">catch</span> (Exception e) {
        channel.basicNack(message.getMessageProperties().getDeliveryTag(), <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>);
    }
}
</code></pre>
<hr/>
<h4 data-id="heading-15">ğŸª¦ åœºæ™¯å››ï¼šæ­»ä¿¡é˜Ÿåˆ—ï¼ˆDLXï¼‰+ å»¶è¿Ÿé˜Ÿåˆ—</h4>
<p><strong>ä¸šåŠ¡èƒŒæ™¯ï¼š</strong> è®¢å• 30 åˆ†é’Ÿæœªæ”¯ä»˜è‡ªåŠ¨å…³é—­ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<ol>
<li>åˆ›å»ºä¸€ä¸ªå¸¦ TTL çš„å»¶è¿Ÿé˜Ÿåˆ—ï¼›</li>
<li>TTL åˆ°æœŸåæ¶ˆæ¯è¿›å…¥æ­»ä¿¡é˜Ÿåˆ—ï¼›</li>
<li>æ­»ä¿¡é˜Ÿåˆ—è§¦å‘å…³é—­è®¢å•é€»è¾‘ã€‚</li>
</ol>
<p><strong>äº®ç‚¹ï¼š</strong> æ— éœ€å®šæ—¶ä»»åŠ¡ï¼Œæé«˜æ•ˆç‡ä¸å¯é æ€§ã€‚</p>
<hr/>
<h3 data-id="heading-16">ğŸ”š æ€»ç»“ï¼šRabbitMQ ä¸æ˜¯é“¶å¼¹ï¼Œä½†å®ƒå¾ˆå®ç”¨</h3>
<p>RabbitMQ çš„ç»å…¸ä¼˜åŠ¿ï¼š</p>
<ul>
<li>ç®€å•æ˜“ç”¨ã€æ–‡æ¡£ä¸°å¯Œï¼Œå­¦ä¹ æˆæœ¬ä½ï¼›</li>
<li>æ”¯æŒå¤šç§æ¶ˆæ¯æ¨¡å‹ï¼ˆç›´è¿ã€ä¸»é¢˜ã€å¹¿æ’­ç­‰ï¼‰ï¼›</li>
<li>å¯¹æ¶ˆæ¯å¯é æ€§å¤„ç†éå¸¸æˆç†Ÿï¼›</li>
<li>ç®¡ç†ç•Œé¢å‹å¥½ï¼Œæ’æŸ¥é—®é¢˜æ–¹ä¾¿ã€‚</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>å¾®æœåŠ¡è§£è€¦</li>
<li>å¼‚æ­¥é€šçŸ¥</li>
<li>ç§’æ€å‰Šå³°</li>
<li>å»¶è¿Ÿä»»åŠ¡</li>
<li>æ¶ˆæ¯å¯é æŠ•é€’</li>
</ul>
<hr/>
<h3 data-id="heading-17">ğŸš€ æœ€å</h3>
<p>ä»åˆè¯† MQ åˆ°æ—¥å¸¸ä¸šåŠ¡å®æˆ˜ï¼ŒRabbitMQ ä¸€ç›´æ˜¯æˆ‘å·¥å…·ç®±ä¸­æœ€é¡ºæ‰‹çš„ä¸€æŠŠåˆ€ã€‚å¦‚æœä½ ä¹Ÿåœ¨æ„å»ºå¾®æœåŠ¡ã€å¤„ç†å¼‚æ­¥ä»»åŠ¡æˆ–è¿½æ±‚ç³»ç»Ÿé«˜å¯ç”¨ï¼Œä¸å¦¨è¯•è¯• RabbitMQï¼Œ<strong>å®ƒä¸ä¸€å®šæœ€æ—¶é«¦ï¼Œä½†ä¸€å®šæœ€é è°±ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Spring Bootå®ç°æ–‡ä»¶è®¿é—®å®‰å…¨]]></title>    <link>https://juejin.cn/post/7580372534043951147</link>    <guid>https://juejin.cn/post/7580372534043951147</guid>    <pubDate>2025-12-08T00:07:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580372534043951147" data-draft-id="7579190764770918440" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Spring Bootå®ç°æ–‡ä»¶è®¿é—®å®‰å…¨"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-08T00:07:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é£è±¡å—"/> <meta itemprop="url" content="https://juejin.cn/user/2524134428655159"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Spring Bootå®ç°æ–‡ä»¶è®¿é—®å®‰å…¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2524134428655159/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é£è±¡å—
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T00:07:47.000Z" title="Mon Dec 08 2025 00:07:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨Webåº”ç”¨å¼€å‘ä¸­ï¼Œæ–‡ä»¶ä¸Šä¼ ã€ä¸‹è½½å’Œè¯»å–åŠŸèƒ½æ˜¯å¸¸è§éœ€æ±‚ã€‚ç„¶è€Œï¼Œä¸å®‰å…¨çš„æ–‡ä»¶è®¿é—®å®ç°å¯èƒ½å¯¼è‡´ä¸¥é‡çš„<strong>ä»»æ„æ–‡ä»¶è¯»å–/å†™å…¥</strong>æ¼æ´ï¼Œæ”»å‡»è€…å¯èƒ½å€Ÿæ­¤è¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿé…ç½®æ–‡ä»¶ã€æ•°æ®åº“å‡­æ®ï¼Œç”šè‡³ç³»ç»Ÿæ–‡ä»¶ï¼Œé€ æˆä¸¥é‡çš„æ•°æ®æ³„éœ²ã€‚</p>
<h2 data-id="heading-1">å¸¸è§çš„æ–‡ä»¶è®¿é—®å®‰å…¨é£é™©</h2>
<h4 data-id="heading-2">1. ä»»æ„è·¯å¾„éå†ï¼ˆPath Traversalï¼‰</h4>
<p>è·¯å¾„éå†æ˜¯æœ€å¸¸è§çš„æ–‡ä»¶è®¿é—®å®‰å…¨é—®é¢˜ï¼Œæ”»å‡»è€…é€šè¿‡<code>../</code>ã€<code>..\\</code>ç­‰åºåˆ—æ¥è®¿é—®ç›®å½•å¤–çš„æ–‡ä»¶ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å±é™©ä»£ç ç¤ºä¾‹ - å­˜åœ¨è·¯å¾„éå†æ¼æ´</span>
<span class="hljs-meta">@GetMapping("/files")</span>
<span class="hljs-keyword">public</span> ResponseEntity&lt;Resource&gt; <span class="hljs-title function_">getFile</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam</span> String filename)</span> {
    <span class="hljs-comment">// æåº¦å±é™©ï¼ç”¨æˆ·å¯ä»¥ç›´æ¥è®¿é—®ä»»æ„æ–‡ä»¶</span>
    <span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">"/uploads/"</span> + filename);
    <span class="hljs-keyword">return</span> ResponseEntity.ok()
        .body(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileSystemResource</span>(file));
}

<span class="hljs-comment">// æ”»å‡»ç¤ºä¾‹ï¼š</span>
<span class="hljs-comment">// GET /files?filename=../../../../etc/passwd</span>
<span class="hljs-comment">// GET /files?filename=..\\..\\..\\windows\\system32\\config\\sam</span>
</code></pre>
<h4 data-id="heading-3">2. æ–‡ä»¶ç±»å‹ç»•è¿‡</h4>
<p>ä¸å……åˆ†çš„æ–‡ä»¶ç±»å‹éªŒè¯å¯èƒ½å¯¼è‡´æ¶æ„æ–‡ä»¶ä¸Šä¼ ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¸å®‰å…¨çš„æ–‡ä»¶ç±»å‹æ£€æŸ¥</span>
<span class="hljs-meta">@PostMapping("/upload")</span>
<span class="hljs-keyword">public</span> String <span class="hljs-title function_">upload</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam</span> MultipartFile file)</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">filename</span> <span class="hljs-operator">=</span> file.getOriginalFilename();
    <span class="hljs-keyword">if</span> (filename.endsWith(<span class="hljs-string">".jpg"</span>) || filename.endsWith(<span class="hljs-string">".png"</span>)) {
        <span class="hljs-comment">// å±é™©ï¼šä»…æ£€æŸ¥æ–‡ä»¶ååç¼€ï¼Œæ”»å‡»è€…å¯ä»¥ä¸Šä¼ </span>
        <span class="hljs-comment">// shell.php.jpg æˆ– double-header.php%00.jpg</span>
    }
}
</code></pre>
<h4 data-id="heading-4">3. ç¬¦å·é“¾æ¥æ”»å‡»</h4>
<p>ç¬¦å·é“¾æ¥å¯èƒ½è¢«ç”¨æ¥ç»•è¿‡è®¿é—®é™åˆ¶ï¼ŒæŒ‡å‘ç³»ç»Ÿæ•æ„Ÿæ–‡ä»¶ã€‚</p>
<h4 data-id="heading-5">4. æ–‡ä»¶åŒ…å«æ¼æ´</h4>
<p>ä¸å½“çš„æ–‡ä»¶åŒ…å«å¯èƒ½å¯¼è‡´ä»£ç æ‰§è¡Œã€‚</p>
<h2 data-id="heading-6">Spring Boot å®‰å…¨æ–‡ä»¶è®¿é—®å®ç°</h2>
<h4 data-id="heading-7">1. è·¯å¾„ç™½åå•éªŒè¯</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.springframework.util.StringUtils;
<span class="hljs-keyword">import</span> java.nio.file.Path;
<span class="hljs-keyword">import</span> java.nio.file.Paths;
<span class="hljs-keyword">import</span> java.util.Arrays;
<span class="hljs-keyword">import</span> java.util.HashSet;
<span class="hljs-keyword">import</span> java.util.Set;

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SecureFileService</span> {

    <span class="hljs-comment">// å…è®¸è®¿é—®çš„åŸºç¡€ç›®å½•</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Set&lt;Path&gt; ALLOWED_BASE_PATHS = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;(Arrays.asList(
        Paths.get(<span class="hljs-string">"/app/uploads"</span>).normalize(),
        Paths.get(<span class="hljs-string">"/app/public"</span>).normalize()
    ));

    <span class="hljs-comment">// å…è®¸çš„æ–‡ä»¶æ‰©å±•å</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Set&lt;String&gt; ALLOWED_EXTENSIONS = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;(Arrays.asList(
        <span class="hljs-string">"jpg"</span>, <span class="hljs-string">"jpeg"</span>, <span class="hljs-string">"png"</span>, <span class="hljs-string">"gif"</span>, <span class="hljs-string">"pdf"</span>, <span class="hljs-string">"txt"</span>, <span class="hljs-string">"doc"</span>, <span class="hljs-string">"docx"</span>
    ));

    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isPathSafe</span><span class="hljs-params">(String requestedPath)</span> {
        <span class="hljs-keyword">if</span> (!StringUtils.hasText(requestedPath)) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }

        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// è§„èŒƒåŒ–è·¯å¾„ï¼Œè§£ææ‰€æœ‰ . å’Œ ..</span>
            <span class="hljs-type">Path</span> <span class="hljs-variable">normalizedPath</span> <span class="hljs-operator">=</span> Paths.get(requestedPath).normalize();

            <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦åœ¨å…è®¸çš„åŸºç¡€ç›®å½•å†…</span>
            <span class="hljs-keyword">for</span> (Path basePath : ALLOWED_BASE_PATHS) {
                <span class="hljs-keyword">if</span> (normalizedPath.startsWith(basePath)) {
                    <span class="hljs-comment">// æ£€æŸ¥æ–‡ä»¶æ‰©å±•å</span>
                    <span class="hljs-type">String</span> <span class="hljs-variable">extension</span> <span class="hljs-operator">=</span> getFileExtension(normalizedPath.toString());
                    <span class="hljs-keyword">return</span> ALLOWED_EXTENSIONS.contains(extension.toLowerCase());
                }
            }

            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }

    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">getFileExtension</span><span class="hljs-params">(String filename)</span> {
        <span class="hljs-type">int</span> <span class="hljs-variable">lastDot</span> <span class="hljs-operator">=</span> filename.lastIndexOf(<span class="hljs-string">'.'</span>);
        <span class="hljs-keyword">return</span> lastDot &gt; <span class="hljs-number">0</span> ? filename.substring(lastDot + <span class="hljs-number">1</span>) : <span class="hljs-string">""</span>;
    }
}
</code></pre>
<h4 data-id="heading-8">2. å®‰å…¨çš„æ–‡ä»¶è®¿é—®æ§åˆ¶å™¨</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping("/api/files")</span>
<span class="hljs-meta">@Validated</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SecureFileController</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> SecureFileService fileService;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">SecureFileController</span><span class="hljs-params">(SecureFileService fileService)</span> {
        <span class="hljs-built_in">this</span>.fileService = fileService;
    }

    <span class="hljs-meta">@GetMapping("/download/**")</span>
    <span class="hljs-keyword">public</span> ResponseEntity&lt;Resource&gt; <span class="hljs-title function_">downloadFile</span><span class="hljs-params">(HttpServletRequest request)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// æå–è¯·æ±‚è·¯å¾„ä¸­çš„æ–‡ä»¶è·¯å¾„éƒ¨åˆ†</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">requestURI</span> <span class="hljs-operator">=</span> request.getRequestURI();
            <span class="hljs-type">String</span> <span class="hljs-variable">filePath</span> <span class="hljs-operator">=</span> requestURI.substring(<span class="hljs-string">"/api/files/download/"</span>.length());

            <span class="hljs-comment">// å®‰å…¨éªŒè¯</span>
            <span class="hljs-keyword">if</span> (!fileService.isPathSafe(filePath)) {
                <span class="hljs-keyword">return</span> ResponseEntity.badRequest()
                    .body((Resource) <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringResource</span>(<span class="hljs-string">"Invalid file path"</span>));
            }

            <span class="hljs-type">Path</span> <span class="hljs-variable">path</span> <span class="hljs-operator">=</span> Paths.get(filePath).normalize();
            <span class="hljs-type">Resource</span> <span class="hljs-variable">resource</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UrlResource</span>(path.toUri());

            <span class="hljs-keyword">if</span> (!resource.exists() || !resource.isReadable()) {
                <span class="hljs-keyword">return</span> ResponseEntity.notFound().build();
            }

            <span class="hljs-comment">// æ£€æŸ¥æ–‡ä»¶å¤§å°é™åˆ¶</span>
            <span class="hljs-type">long</span> <span class="hljs-variable">fileSize</span> <span class="hljs-operator">=</span> resource.contentLength();
            <span class="hljs-keyword">if</span> (fileSize &gt; <span class="hljs-number">100</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>) { <span class="hljs-comment">// 100MB limit</span>
                <span class="hljs-keyword">return</span> ResponseEntity.badRequest()
                    .body((Resource) <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringResource</span>(<span class="hljs-string">"File too large"</span>));
            }

            <span class="hljs-type">String</span> <span class="hljs-variable">contentType</span> <span class="hljs-operator">=</span> Files.probeContentType(path);
            <span class="hljs-keyword">if</span> (contentType == <span class="hljs-literal">null</span>) {
                contentType = <span class="hljs-string">"application/octet-stream"</span>;
            }

            <span class="hljs-keyword">return</span> ResponseEntity.ok()
                .contentType(MediaType.parseMediaType(contentType))
                .header(HttpHeaders.CONTENT_DISPOSITION,
                        <span class="hljs-string">"attachment; filename=\""</span> + path.getFileName() + <span class="hljs-string">"\""</span>)
                .body(resource);

        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">return</span> ResponseEntity.internalServerError().build();
        }
    }
}
</code></pre>
<h4 data-id="heading-9">3. å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ å®ç°</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.springframework.web.multipart.MultipartFile;
<span class="hljs-keyword">import</span> org.apache.commons.io.FilenameUtils;
<span class="hljs-keyword">import</span> org.apache.commons.lang3.RandomStringUtils;

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SecureFileUploadService</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">MAX_FILE_SIZE</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>; <span class="hljs-comment">// 10MB</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Path</span> <span class="hljs-variable">UPLOAD_DIR</span> <span class="hljs-operator">=</span> Paths.get(<span class="hljs-string">"/app/uploads"</span>).toAbsolutePath().normalize();

    <span class="hljs-meta">@PostConstruct</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            Files.createDirectories(UPLOAD_DIR);
        } <span class="hljs-keyword">catch</span> (IOException e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"Could not create upload directory"</span>, e);
        }
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">uploadFile</span><span class="hljs-params">(MultipartFile file)</span> {
        <span class="hljs-comment">// 1. åŸºæœ¬éªŒè¯</span>
        <span class="hljs-keyword">if</span> (file.isEmpty()) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"File is empty"</span>);
        }

        <span class="hljs-keyword">if</span> (file.getSize() &gt; MAX_FILE_SIZE) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"File size exceeds limit"</span>);
        }

        <span class="hljs-comment">// 2. æ–‡ä»¶åéªŒè¯å’Œå¤„ç†</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">originalFilename</span> <span class="hljs-operator">=</span> file.getOriginalFilename();
        <span class="hljs-keyword">if</span> (!isValidFilename(originalFilename)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"Invalid filename"</span>);
        }

        <span class="hljs-comment">// 3. æ–‡ä»¶ç±»å‹éªŒè¯ï¼ˆä½¿ç”¨é­”æœ¯å­—èŠ‚ï¼Œè€Œä¸ä»…ä»…æ˜¯æ‰©å±•åï¼‰</span>
        <span class="hljs-keyword">if</span> (!isValidFileType(file)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"Invalid file type"</span>);
        }

        <span class="hljs-comment">// 4. ç”Ÿæˆå®‰å…¨çš„æ–‡ä»¶å</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">extension</span> <span class="hljs-operator">=</span> FilenameUtils.getExtension(originalFilename);
        <span class="hljs-type">String</span> <span class="hljs-variable">safeFilename</span> <span class="hljs-operator">=</span> generateSafeFilename(extension);

        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">Path</span> <span class="hljs-variable">targetLocation</span> <span class="hljs-operator">=</span> UPLOAD_DIR.resolve(safeFilename);

            <span class="hljs-comment">// ç¡®ä¿æ–‡ä»¶åœ¨å…è®¸çš„ç›®å½•å†…</span>
            <span class="hljs-keyword">if</span> (!targetLocation.normalize().startsWith(UPLOAD_DIR)) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecurityException</span>(<span class="hljs-string">"Attempted path traversal attack"</span>);
            }

            Files.copy(file.getInputStream(), targetLocation, StandardCopyOption.REPLACE_EXISTING);

            <span class="hljs-keyword">return</span> safeFilename;

        } <span class="hljs-keyword">catch</span> (IOException e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"Failed to store file"</span>, e);
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isValidFilename</span><span class="hljs-params">(String filename)</span> {
        <span class="hljs-keyword">if</span> (filename == <span class="hljs-literal">null</span> || filename.trim().isEmpty()) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }

        <span class="hljs-comment">// æ£€æŸ¥å±é™©å­—ç¬¦</span>
        <span class="hljs-keyword">if</span> (filename.contains(<span class="hljs-string">".."</span>) || filename.contains(<span class="hljs-string">"/"</span>) ||
            filename.contains(<span class="hljs-string">"\\"</span>) || filename.contains(<span class="hljs-string">":"</span>)) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }

        <span class="hljs-comment">// æ£€æŸ¥æ–‡ä»¶åé•¿åº¦</span>
        <span class="hljs-keyword">return</span> filename.length() &lt;= <span class="hljs-number">255</span>;
    }

    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isValidFileType</span><span class="hljs-params">(MultipartFile file)</span> <span class="hljs-keyword">throws</span> IOException {
        <span class="hljs-type">String</span> <span class="hljs-variable">filename</span> <span class="hljs-operator">=</span> file.getOriginalFilename();
        <span class="hljs-type">String</span> <span class="hljs-variable">extension</span> <span class="hljs-operator">=</span> FilenameUtils.getExtension(filename).toLowerCase();

        <span class="hljs-comment">// å…è®¸çš„æ–‡ä»¶ç±»å‹</span>
        Set&lt;String&gt; allowedExtensions = Set.of(<span class="hljs-string">"jpg"</span>, <span class="hljs-string">"jpeg"</span>, <span class="hljs-string">"png"</span>, <span class="hljs-string">"gif"</span>, <span class="hljs-string">"pdf"</span>, <span class="hljs-string">"txt"</span>);
        <span class="hljs-keyword">if</span> (!allowedExtensions.contains(extension)) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }

        <span class="hljs-comment">// æ–‡ä»¶å¤´éªŒè¯ï¼ˆé­”æœ¯å­—èŠ‚ï¼‰</span>
        <span class="hljs-type">byte</span>[] fileBytes = file.getBytes();
        <span class="hljs-keyword">return</span> isValidFileHeader(fileBytes, extension);
    }

    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isValidFileHeader</span><span class="hljs-params">(<span class="hljs-type">byte</span>[] fileBytes, String extension)</span> {
        <span class="hljs-keyword">if</span> (fileBytes.length &lt; <span class="hljs-number">4</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }

        <span class="hljs-comment">// ç®€åŒ–çš„æ–‡ä»¶å¤´éªŒè¯, å¯ä»¥ä½¿ç”¨ Apache Tikaåº“æ¥åˆ¤æ–­</span>
        <span class="hljs-keyword">switch</span> (extension) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">"jpg"</span>:
            <span class="hljs-keyword">case</span> <span class="hljs-string">"jpeg"</span>:
                <span class="hljs-keyword">return</span> fileBytes[<span class="hljs-number">0</span>] == (<span class="hljs-type">byte</span>) <span class="hljs-number">0xFF</span> &amp;&amp; fileBytes[<span class="hljs-number">1</span>] == (<span class="hljs-type">byte</span>) <span class="hljs-number">0xD8</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">"png"</span>:
                <span class="hljs-keyword">return</span> fileBytes[<span class="hljs-number">0</span>] == (<span class="hljs-type">byte</span>) <span class="hljs-number">0x89</span> &amp;&amp; fileBytes[<span class="hljs-number">1</span>] == <span class="hljs-number">0x50</span> &amp;&amp;
                       fileBytes[<span class="hljs-number">2</span>] == <span class="hljs-number">0x4E</span> &amp;&amp; fileBytes[<span class="hljs-number">3</span>] == <span class="hljs-number">0x47</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">"pdf"</span>:
                <span class="hljs-keyword">return</span> fileBytes[<span class="hljs-number">0</span>] == <span class="hljs-number">0x25</span> &amp;&amp; fileBytes[<span class="hljs-number">1</span>] == <span class="hljs-number">0x50</span> &amp;&amp;
                       fileBytes[<span class="hljs-number">2</span>] == <span class="hljs-number">0x44</span> &amp;&amp; fileBytes[<span class="hljs-number">3</span>] == <span class="hljs-number">0x46</span>;
            <span class="hljs-keyword">default</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// å¯¹äºæ–‡æœ¬æ–‡ä»¶ï¼Œæ”¾å®½æ£€æŸ¥</span>
        }
    }

    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">generateSafeFilename</span><span class="hljs-params">(String extension)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">randomPart</span> <span class="hljs-operator">=</span> RandomStringUtils.randomAlphanumeric(<span class="hljs-number">16</span>);
        <span class="hljs-type">String</span> <span class="hljs-variable">timestamp</span> <span class="hljs-operator">=</span> String.valueOf(System.currentTimeMillis());
        <span class="hljs-keyword">return</span> String.format(<span class="hljs-string">"%s_%s.%s"</span>, timestamp, randomPart, extension);
    }
}
</code></pre>
<h4 data-id="heading-10">4. é…ç½®å®‰å…¨è¿‡æ»¤å™¨</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FileSecurityFilter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Filter</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Set&lt;String&gt; DANGEROUS_PATHS = Set.of(
        <span class="hljs-string">".."</span>, <span class="hljs-string">"../"</span>, <span class="hljs-string">"..\\"</span>, <span class="hljs-string">"%2e%2e%2f"</span>, <span class="hljs-string">"%2e%2e\\"</span>,
        <span class="hljs-string">"etc/passwd"</span>, <span class="hljs-string">"windows/system32"</span>, <span class="hljs-string">"boot.ini"</span>
    );

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doFilter</span><span class="hljs-params">(ServletRequest request, ServletResponse response,
                        FilterChain chain)</span> <span class="hljs-keyword">throws</span> IOException, ServletException {

        <span class="hljs-type">HttpServletRequest</span> <span class="hljs-variable">httpRequest</span> <span class="hljs-operator">=</span> (HttpServletRequest) request;
        <span class="hljs-type">HttpServletResponse</span> <span class="hljs-variable">httpResponse</span> <span class="hljs-operator">=</span> (HttpServletResponse) response;

        <span class="hljs-type">String</span> <span class="hljs-variable">requestURI</span> <span class="hljs-operator">=</span> httpRequest.getRequestURI();
        <span class="hljs-type">String</span> <span class="hljs-variable">queryString</span> <span class="hljs-operator">=</span> httpRequest.getQueryString();

        <span class="hljs-comment">// æ£€æŸ¥è·¯å¾„éå†æ”»å‡»</span>
        <span class="hljs-keyword">if</span> (containsPathTraversal(requestURI, queryString)) {
            httpResponse.sendError(HttpServletResponse.SC_BAD_REQUEST,
                                  <span class="hljs-string">"Invalid request - potential path traversal"</span>);
            <span class="hljs-keyword">return</span>;
        }

        chain.doFilter(request, response);
    }

    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">containsPathTraversal</span><span class="hljs-params">(String uri, String queryString)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">fullRequest</span> <span class="hljs-operator">=</span> uri;
        <span class="hljs-keyword">if</span> (queryString != <span class="hljs-literal">null</span>) {
            fullRequest += <span class="hljs-string">"?"</span> + queryString;
        }

        <span class="hljs-type">String</span> <span class="hljs-variable">lowerCaseRequest</span> <span class="hljs-operator">=</span> fullRequest.toLowerCase();

        <span class="hljs-keyword">return</span> DANGEROUS_PATHS.stream()
            .anyMatch(lowerCaseRequest::contains);
    }
}
</code></pre>
<h2 data-id="heading-11">é«˜çº§å®‰å…¨æªæ–½</h2>
<h4 data-id="heading-12">1. ä½¿ç”¨è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VirtualFileSystemService</span> {

    <span class="hljs-comment">// å°†æ–‡ä»¶æ˜ å°„åˆ°è™šæ‹Ÿè·¯å¾„ï¼Œéšè—çœŸå®æ–‡ä»¶ç³»ç»Ÿç»“æ„</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;String, FileInfo&gt; virtualFileMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();

    <span class="hljs-meta">@PostConstruct</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// åˆå§‹åŒ–è™šæ‹Ÿæ–‡ä»¶æ˜ å°„</span>
        scanAndMapFiles(Paths.get(<span class="hljs-string">"/app/uploads"</span>), <span class="hljs-string">"/virtual/files"</span>);
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">scanAndMapFiles</span><span class="hljs-params">(Path realPath, String virtualBasePath)</span> {
        <span class="hljs-keyword">try</span> {
            Files.walk(realPath)
                .filter(Files::isRegularFile)
                .forEach(realFile -&gt; {
                    <span class="hljs-type">String</span> <span class="hljs-variable">relativePath</span> <span class="hljs-operator">=</span> realPath.relativize(realFile).toString();
                    <span class="hljs-type">String</span> <span class="hljs-variable">virtualPath</span> <span class="hljs-operator">=</span> virtualBasePath + <span class="hljs-string">"/"</span> + relativePath;
                    virtualFileMap.put(virtualPath, <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInfo</span>(realFile, virtualPath));
                });
        } <span class="hljs-keyword">catch</span> (IOException e) {
            log.error(<span class="hljs-string">"Failed to scan files"</span>, e);
        }
    }

    <span class="hljs-keyword">public</span> Optional&lt;Resource&gt; <span class="hljs-title function_">getFileByVirtualPath</span><span class="hljs-params">(String virtualPath)</span> {
        <span class="hljs-type">FileInfo</span> <span class="hljs-variable">fileInfo</span> <span class="hljs-operator">=</span> virtualFileMap.get(virtualPath);
        <span class="hljs-keyword">if</span> (fileInfo == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> Optional.empty();
        }

        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">Resource</span> <span class="hljs-variable">resource</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UrlResource</span>(fileInfo.getRealPath().toUri());
            <span class="hljs-keyword">return</span> Optional.of(resource);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">return</span> Optional.empty();
        }
    }

    <span class="hljs-meta">@Data</span>
    <span class="hljs-meta">@AllArgsConstructor</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FileInfo</span> {
        <span class="hljs-keyword">private</span> Path realPath;
        <span class="hljs-keyword">private</span> String virtualPath;
    }
}
</code></pre>
<h4 data-id="heading-13">2. æ–‡ä»¶è®¿é—®æƒé™æ§åˆ¶</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FileAccessControlService</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">canAccessFile</span><span class="hljs-params">(String userId, String virtualPath, String action)</span> {
        <span class="hljs-comment">// åŸºäºç”¨æˆ·è§’è‰²çš„æ–‡ä»¶è®¿é—®æ§åˆ¶</span>
        <span class="hljs-type">UserInfo</span> <span class="hljs-variable">userInfo</span> <span class="hljs-operator">=</span> getUserInfo(userId);
        <span class="hljs-type">FileInfo</span> <span class="hljs-variable">fileInfo</span> <span class="hljs-operator">=</span> getFileInfo(virtualPath);

        <span class="hljs-keyword">if</span> (fileInfo == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }

        <span class="hljs-comment">// æ£€æŸ¥æ–‡ä»¶æ‰€æœ‰æƒ</span>
        <span class="hljs-keyword">if</span> (userInfo.getRole() == UserRole.ADMIN) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// ç®¡ç†å‘˜å¯ä»¥è®¿é—®æ‰€æœ‰æ–‡ä»¶</span>
        }

        <span class="hljs-comment">// æ™®é€šç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„æ–‡ä»¶</span>
        <span class="hljs-keyword">return</span> fileInfo.getOwnerId().equals(userId);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">logFileAccess</span><span class="hljs-params">(String userId, String virtualPath, String action, <span class="hljs-type">boolean</span> success)</span> {
        <span class="hljs-type">FileAccessLog</span> <span class="hljs-variable">log</span> <span class="hljs-operator">=</span> FileAccessLog.builder()
            .userId(userId)
            .virtualPath(virtualPath)
            .action(action)
            .success(success)
            .timestamp(LocalDateTime.now())
            .userAgent(getCurrentUserAgent())
            .clientIp(getClientIp())
            .build();

        fileAccessLogRepository.save(log);
    }
}
</code></pre>
<h4 data-id="heading-14">3. æ–‡ä»¶å®Œæ•´æ€§æ£€æŸ¥</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FileIntegrityChecker</span> {

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">calculateFileHash</span><span class="hljs-params">(Path filePath)</span> <span class="hljs-keyword">throws</span> IOException {
        <span class="hljs-type">byte</span>[] fileBytes = Files.readAllBytes(filePath);
        <span class="hljs-keyword">return</span> DigestUtils.sha256Hex(fileBytes);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">verifyFileIntegrity</span><span class="hljs-params">(Path filePath, String expectedHash)</span> <span class="hljs-keyword">throws</span> IOException {
        <span class="hljs-type">String</span> <span class="hljs-variable">actualHash</span> <span class="hljs-operator">=</span> calculateFileHash(filePath);
        <span class="hljs-keyword">return</span> MessageDigest.isEqual(
            actualHash.getBytes(StandardCharsets.UTF_8),
            expectedHash.getBytes(StandardCharsets.UTF_8)
        );
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">generateIntegrityReport</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// å®šæœŸæ‰«æä¸Šä¼ ç›®å½•ï¼Œç”Ÿæˆæ–‡ä»¶å®Œæ•´æ€§æŠ¥å‘Š</span>
        Map&lt;String, String&gt; fileHashes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();

        <span class="hljs-keyword">try</span> {
            Files.walk(Paths.get(<span class="hljs-string">"/app/uploads"</span>))
                .filter(Files::isRegularFile)
                .forEach(file -&gt; {
                    <span class="hljs-keyword">try</span> {
                        <span class="hljs-type">String</span> <span class="hljs-variable">hash</span> <span class="hljs-operator">=</span> calculateFileHash(file);
                        fileHashes.put(file.toString(), hash);
                    } <span class="hljs-keyword">catch</span> (IOException e) {
                        log.error(<span class="hljs-string">"Failed to calculate hash for file: "</span> + file, e);
                    }
                });

            <span class="hljs-comment">// ä¿å­˜æˆ–æ¯”è¾ƒå®Œæ•´æ€§æŠ¥å‘Š</span>
            saveIntegrityReport(fileHashes);

        } <span class="hljs-keyword">catch</span> (IOException e) {
            log.error(<span class="hljs-string">"Failed to scan upload directory"</span>, e);
        }
    }
}
</code></pre>
<h4 data-id="heading-15">4. åº”ç”¨é…ç½®æ–‡ä»¶</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># application.yml</span>
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">servlet:</span>
    <span class="hljs-attr">multipart:</span>
      <span class="hljs-attr">max-file-size:</span> <span class="hljs-string">10MB</span>
      <span class="hljs-attr">max-request-size:</span> <span class="hljs-string">10MB</span>
      <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>

<span class="hljs-attr">file:</span>
  <span class="hljs-attr">upload:</span>
    <span class="hljs-attr">base-path:</span> <span class="hljs-string">/app/uploads</span>
    <span class="hljs-attr">max-size:</span> <span class="hljs-number">10485760</span>  <span class="hljs-comment"># 10MB</span>
    <span class="hljs-attr">allowed-extensions:</span> <span class="hljs-string">jpg,jpeg,png,gif,pdf,txt,doc,docx</span>
    <span class="hljs-attr">allowed-mime-types:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">image/jpeg</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">image/png</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">image/gif</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">application/pdf</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">text/plain</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">application/msword</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">application/vnd.openxmlformats-officedocument.wordprocessingml.document</span>
  <span class="hljs-attr">security:</span>
    <span class="hljs-attr">enable-path-traversal-protection:</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">enable-file-integrity-check:</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">enable-access-logging:</span> <span class="hljs-literal">true</span>
</code></pre>
<h2 data-id="heading-16">æ€»ç»“</h2>
<p>é€šè¿‡æœ¬æ–‡çš„ä»‹ç»ï¼Œæˆ‘ä»¬äº†è§£äº†Spring Bootåº”ç”¨ä¸­æ–‡ä»¶è®¿é—®çš„ä¸»è¦å®‰å…¨é£é™©å’Œç›¸åº”çš„é˜²æŠ¤æªæ–½ã€‚</p>
<p>æ–‡ä»¶å®‰å…¨æ˜¯ä¸€ä¸ªæŒç»­çš„è¿‡ç¨‹ï¼Œéœ€è¦å®šæœŸå®¡æŸ¥å’Œæ›´æ–°å®‰å…¨ç­–ç•¥ã€‚é€šè¿‡å®æ–½ä¸Šè¿°æªæ–½ï¼Œæ‚¨å¯ä»¥æ˜¾è‘—æé«˜Spring Bootåº”ç”¨çš„æ–‡ä»¶è®¿é—®å®‰å…¨æ€§ï¼Œæœ‰æ•ˆé˜²èŒƒä»»æ„æ–‡ä»¶è®¿é—®æ¼æ´ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Token åˆ°åº•æ€ä¹ˆæ¥çš„? ä¸€æ–‡è¯»æ‡‚å¤§æ¨¡å‹åˆ†è¯çš„æ ¸å¿ƒé€»è¾‘, çœ‹å®Œç§’æ‡‚!]]></title>    <link>https://juejin.cn/post/7580570363602911284</link>    <guid>https://juejin.cn/post/7580570363602911284</guid>    <pubDate>2025-12-08T00:15:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580570363602911284" data-draft-id="7580570363602337844" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Token åˆ°åº•æ€ä¹ˆæ¥çš„? ä¸€æ–‡è¯»æ‡‚å¤§æ¨¡å‹åˆ†è¯çš„æ ¸å¿ƒé€»è¾‘, çœ‹å®Œç§’æ‡‚!"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,LLM,Python"/> <meta itemprop="datePublished" content="2025-12-08T00:15:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°åˆ»å›"/> <meta itemprop="url" content="https://juejin.cn/user/572216818014568"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Token åˆ°åº•æ€ä¹ˆæ¥çš„? ä¸€æ–‡è¯»æ‡‚å¤§æ¨¡å‹åˆ†è¯çš„æ ¸å¿ƒé€»è¾‘, çœ‹å®Œç§’æ‡‚!
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/572216818014568/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°åˆ»å›
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T00:15:22.000Z" title="Mon Dec 08 2025 00:15:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    18
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ AI æŠ€æœ¯éåœ°å¼€èŠ±çš„ä»Šå¤©, <strong>Token (è¯å…ƒ)</strong> ç»å¯¹æ˜¯ä½ ç»•ä¸å¼€çš„æ ¸å¿ƒæ¦‚å¿µ. ä½ å¤§æ¦‚ç‡çŸ¥é“å¤§æ¨¡å‹æŒ‰ Token è®¡è´¹ï¼Œä¹Ÿå¬è¯´è¿‡å®ƒæ˜¯æ¨¡å‹å¤„ç†ä¿¡æ¯çš„åŸºç¡€å•å…ƒ.</p>
<p>ä½†ä½ æ˜¯å¦æ›¾æ·±å…¥æ€è€ƒï¼š<strong>è¿™äº› Token ç©¶ç«Ÿæ˜¯æ€ä¹ˆä»æ–‡æœ¬é‡Œ â€œå˜â€ å‡ºæ¥çš„</strong>?</p>
<p>ä»Šå¤©è¿™ç¯‡æ–‡ç« , æˆ‘æƒ³å’Œä½ ä¸€èµ·, èŠèŠå¤§æ¨¡å‹æ˜¯å¦‚ä½•åˆ†è¯çš„</p>
<p>æˆ‘æ˜¯å°åˆ»å›, ä¸€ä½æ¢ç´¢ AI çš„å‰ç«¯ç¨‹åºå‘˜, å…³æ³¨æˆ‘, è®© AI çŸ¥è¯†æœ‰æ¸©åº¦, æŠ€æœ¯è½åœ°æœ‰æ·±åº¦</p>
<h2 data-id="heading-0">åœ¨çº¿ä½“éªŒ Token åˆ†è¯</h2>
<p>è®²ç†è®ºä¹‹å‰ï¼Œå…ˆä¸Šæ‰‹ä½“éªŒä¸€æŠŠæ‰å¤Ÿç›´è§‚</p>
<p>ä½ å¯ä»¥æ‰“å¼€ OpenAI çš„åˆ†è¯ç½‘ç«™ <a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.openai.com%2Ftokenizer" target="_blank" title="https://platform.openai.com/tokenizer" ref="nofollow noopener noreferrer">platform.openai.com/tokenizer</a>, çœ‹çœ‹ OpenAI çš„å¤§è¯­è¨€æ¨¡å‹æ˜¯æ€ä¹ˆæŠŠæ–‡æœ¬åˆ‡æˆ Token çš„:</p>
<p>æ¯”å¦‚æˆ‘è¾“å…¥è¿™å¥è¯: <code>I'm InkJun, a front-end programmer exploring AI. Follow me to make AI knowledge more engaging and its practical applications more in-depth.</code></p>
<p>GPT-4o ç»™å‡ºçš„åˆ†è¯ç»“æœé•¿è¿™æ ·:</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0cdb7068094d46bca7d30a1baa638196~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2w5Yi75ZCb:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765759944&amp;x-signature=H40LklfutEBNii7BOeMvqyQlerc%3D" alt="image.png" loading="lazy"/></p>
<p>ä½“éªŒå®Œåï¼Œä½ ä¼šå‘ç°ä¸¤ä¸ªæœ‰æ„æ€çš„ç°è±¡:</p>
<p>ç¬¬ä¸€ï¼ŒToken å¹¶éç®€å•çš„å­—æˆ–è¯ï¼Œè€Œæ˜¯ä¸€ç§ä»‹äºä¸¤è€…ä¹‹é—´çš„â€œå­è¯â€å•å…ƒ.</p>
<p>ç¬¬äºŒï¼Œä¸åŒæ¨¡å‹å¯¹åŒä¸€å¥è¯çš„åˆ‡åˆ†ç»“æœ, å¾€å¾€è¿˜ä¸ä¸€æ ·.</p>
<p>è¿™è‡ªç„¶ä¼šå¼•å‡ºä¸€ä¸ªæ›´æ·±å±‚çš„é—®é¢˜: å¤§æ¨¡å‹ä¸ºä½•ä¸ç›´æ¥é‡‡ç”¨æˆ‘ä»¬ç†Ÿæ‚‰çš„â€œå­—â€æˆ–â€œè¯â€ä½œä¸ºå¤„ç†å•å…ƒ?</p>
<h2 data-id="heading-1">ä¸ºä»€ä¹ˆè¦åˆ‡åˆ† Tokenï¼Ÿè€Œä¸æ˜¯ç›´æ¥ç”¨å­—æˆ–è¯ï¼Ÿ</h2>
<p>è¦å›ç­”è¿™ä¸ªé—®é¢˜, æˆ‘ä»¬éœ€è¦æ¢è®¨ AI è®¾è®¡ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒè€ƒé‡ï¼š<strong>åœ¨è¯æ±‡è¡¨è§„æ¨¡ä¸è¯­ä¹‰ä¿¡æ¯ä¿ç•™ä¹‹é—´å¯»æ±‚å¹³è¡¡</strong></p>
<p>å¦‚æœæŒ‰â€œæ•´è¯â€åˆ‡åˆ†, ä¼šå‡ºç°ä¸¤ä¸ªé—®é¢˜:</p>
<ul>
<li><strong>è¯æ±‡è¡¨è¶Šå˜è¶Šå¤§</strong>, è¯­è¨€ä¸­å­˜åœ¨å¤§é‡è¯å½¢å˜åŒ–ï¼ˆå¦‚ apple, apples, applepie), è¯æ±‡è¡¨è§„æ¨¡å¯è½»æ˜“è¾¾åˆ°æ•°åä¸‡ä¹ƒè‡³ä¸Šç™¾ä¸‡ï¼Œç»™æ¨¡å‹è®­ç»ƒå¸¦æ¥å·¨å¤§å‹åŠ›</li>
<li><strong>é‡åˆ°æ–°è¯å°± â€œå¡å£³â€</strong>, æ—¦ç¢°åˆ°è®­ç»ƒè¯­æ–™é‡Œæ²¡è§è¿‡çš„è¯ï¼ˆä¹Ÿå°±æ˜¯æœªç™»å½•è¯, Out-of-Vocabularyï¼‰ï¼Œæ¨¡å‹å°±æ²¡æ³•è¯†åˆ«äº†</li>
</ul>
<p>é‚£å¦‚æœæŒ‰ â€œå•å­— / å­—ç¬¦â€ åˆ‡åˆ†å‘¢? åŒæ ·æœ‰é—®é¢˜:</p>
<ul>
<li><strong>åºåˆ—å¤ªé•¿ï¼Œè®¡ç®—æ…¢</strong>, åŸºæœ¬å•å…ƒå¤ªå°ï¼Œæ–‡æœ¬åºåˆ—ä¼šå˜å¾—å¾ˆé•¿ï¼Œè®¡ç®—å¼€é”€æ€¥å‰§å¢åŠ </li>
<li><strong>è¯­ä¹‰ç¨€ç–</strong>, å•ä¸ªå­—ç¬¦ï¼ˆå¦‚ "a", "p"ï¼‰æºå¸¦çš„è¯­ä¹‰ä¿¡æ¯æœ‰é™ï¼Œæ¨¡å‹éš¾ä»¥ä»ä¸­å­¦ä¹ åˆ°å¤æ‚çš„è¯­è¨€ç»“æ„</li>
</ul>
<p>å› æ­¤, æˆ‘ä»¬éœ€è¦ä¸€ç§<strong>æŠ˜ä¸­æ–¹æ¡ˆ</strong>â€”â€”æ—¢èƒ½å°†è¯æ±‡è¡¨æ§åˆ¶åœ¨åˆç†èŒƒå›´å†…, åˆèƒ½æœ‰æ•ˆä¿ç•™è¯­ä¹‰ä¿¡æ¯. è¿™æ­£æ˜¯ <strong>Subword (å­è¯)</strong> åˆ‡åˆ†æ³•çš„æ ¸å¿ƒä»·å€¼, è€Œå…¶ä¸­çš„ä»£è¡¨æ€§ç®—æ³•å°±æ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥è¦è®¨è®ºçš„ <strong>BPE</strong></p>
<h2 data-id="heading-2">æ ¸å¿ƒåˆ†è¯ç®—æ³•ï¼šBPE (Byte Pair Encoding)</h2>
<p><strong>éœ€è¦æŒ‡å‡ºçš„æ˜¯, å½“å‰ä¸»æµçš„å¤§æ¨¡å‹ï¼ˆå¦‚ GPT-4, LLaMA, Qwenï¼‰å®é™…ä¸Šé‡‡ç”¨çš„æ˜¯ BPE çš„å˜ä½“ â€”â€” BBPE (Byte-Level BPE)</strong>.</p>
<p>ä¸è¿‡, ä¸ºäº†ç†è§£ BBPE, æˆ‘ä»¬å¿…é¡»å…ˆæŒæ¡å…¶æ ¸å¿ƒæ€æƒ³â€”â€”BPE</p>
<h2 data-id="heading-3">BPE ç®—æ³• â€”â€” åŸºäºé¢‘ç‡çš„è¿­ä»£å¼åˆå¹¶</h2>
<p>BPE çš„åŸç†éå¸¸ç›´è§‚ï¼Œå¯ä»¥æ¦‚æ‹¬ä¸ºï¼š<strong>åœ¨è¯­æ–™åº“ä¸­, æ‰¾å‡ºé¢‘ç‡æœ€é«˜çš„ç›¸é‚»ç¬¦å·å¯¹, æŠŠå®ƒä»¬åˆå¹¶ä¸ºä¸€ä¸ªæ–°çš„ç¬¦å·, ç„¶åé‡å¤è¿™ä¸ªè¿‡ç¨‹</strong>.</p>
<p>å®ƒä¸ä¾èµ–ä»»ä½•è¯­æ³•çŸ¥è¯†ï¼Œä»…é€šè¿‡ç»Ÿè®¡å¤§è§„æ¨¡è¯­æ–™ä¸­ç¬¦å·å‡ºç°çš„é¢‘ç‡ï¼Œæ¥åŠ¨æ€åœ°æ„å»ºè¯è¡¨</p>
<p><strong>å·¥ä½œåŸç† (ä»¥ä¸­æ–‡ç»•å£ä»¤ä¸ºä¾‹)</strong></p>
<blockquote>
<p><strong>âš ï¸ å­¦ä¹ æç¤ºï¼š</strong></p>
<p>ä¸ºä¾¿äºç†è§£ <strong>â€œç»Ÿè®¡ä¸åˆå¹¶â€</strong> çš„æ ¸å¿ƒé€»è¾‘, æ­¤å¤„<strong>ä»¥æ±‰å­—ä¸ºç¬¦å·è¿›è¡Œæ¼”ç¤º</strong>.</p>
<p>è¯·æ³¨æ„, è¿™ä»…ä¸ºä¸€ä¸ª<strong>æ€æƒ³å®éªŒ</strong>. å®é™…çš„å¤§æ¨¡å‹ä¸ºäº†å®ç°è·¨è¯­è¨€å…¼å®¹, å…¶æ“ä½œçš„å¯¹è±¡æ˜¯<strong>å­—èŠ‚</strong>ï¼Œè¿™å°†åœ¨ä¸‹ä¸€èŠ‚ BBPE ä¸­è¯¦è¿°</p>
</blockquote>
<p>å‡è®¾è¾“å…¥æ–‡æœ¬ä¸º: <code>å…«ç™¾æ ‡å…µå¥”åŒ—å¡, åŒ—å¡ç‚®å…µå¹¶æ’è·‘, ç‚®å…µæ€•æŠŠæ ‡å…µç¢°, æ ‡å…µæ€•ç¢°ç‚®å…µç‚®.</code></p>
<ul>
<li>åˆå§‹çŠ¶æ€ä¸‹, æ¯ä¸ªæ±‰å­—éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ç¬¦å·:</li>
</ul>
<p><code>['å…«', 'ç™¾', 'æ ‡', 'å…µ', 'å¥”', 'åŒ—', 'å¡', ',' , 'åŒ—', 'å¡', 'ç‚®', 'å…µ', ...]</code></p>
<ul>
<li>
<p>åˆå¹¶ "æ ‡å…µ" (é¢‘æ¬¡ 3)</p>
<p>ç®—æ³•æ‰«æè¯­æ–™, å‘ç°ç›¸é‚»ç¬¦å·å¯¹ <code>('æ ‡', 'å…µ')</code> å‡ºç°äº† 3 æ¬¡, ä¸ºå½“å‰æœ€é«˜é¢‘å¯¹. å› æ­¤ï¼Œå°†å…¶åˆå¹¶ä¸ºæ–°ç¬¦å· "æ ‡å…µ":</p>
<p><code>['å…«', 'ç™¾', 'æ ‡å…µ', 'å¥”', 'åŒ—', 'å¡', ',', 'åŒ—', 'å¡', 'ç‚®', 'å…µ', ...]</code></p>
</li>
<li>
<p>åˆå¹¶ "ç‚®å…µ" (é¢‘æ¬¡ 3)</p>
<p>ç®—æ³•ç»§ç»­æ‰«æï¼Œå‘ç° <code>('ç‚®', 'å…µ')</code> åŒæ ·å‡ºç° 3 æ¬¡ï¼Œæ‰§è¡Œåˆå¹¶</p>
<p><code>['å…«', 'ç™¾', 'æ ‡å…µ', 'å¥”', 'åŒ—', 'å¡', ',', 'åŒ—', 'å¡', 'ç‚®å…µ', ...]</code></p>
</li>
<li>
<p>åˆå¹¶ "åŒ—å¡" (é¢‘æ¬¡ 2)</p>
<p>ç¬¦å·å¯¹ <code>('åŒ—', 'å¡')</code> å‡ºç° 2 æ¬¡, æˆä¸ºå½“å‰æœ€é«˜é¢‘å¯¹ï¼Œæ‰§è¡Œåˆå¹¶</p>
<p><code>['å…«', 'ç™¾', 'æ ‡å…µ', 'å¥”', 'åŒ—å¡', ',', 'åŒ—å¡', 'ç‚®å…µ', ...]</code></p>
</li>
<li>
<p>å¤„ç†å‰©ä½™ä½é¢‘ç¬¦å·</p>
<p>å‰©ä½™ç¬¦å·å¯¹çš„é¢‘æ¬¡å‡ä¸º 1ï¼Œç®—æ³•ä¼šç»§ç»­æŒ‰é¢‘ç‡æ’åºè¿›è¡Œåˆå¹¶ï¼ˆå®é™…è®­ç»ƒä¸­é€šå¸¸ä¼šè®¾å®šåœæ­¢æ¡ä»¶ï¼Œå¦‚è¾¾åˆ°é¢„è®¾è¯è¡¨å¤§å°ï¼‰</p>
</li>
</ul>
<p>è¿™ä¹ˆä¸€æ­¥æ­¥è¿­ä»£ä¸‹æ¥, â€œæ ‡å…µâ€â€œç‚®å…µâ€â€œåŒ—å¡â€ è¿™äº›é«˜é¢‘ç»„åˆå°±è¢«åˆå¹¶å‡ºæ¥äº†</p>
<p><strong>BPE çš„å±€é™</strong></p>
<p>ç„¶è€Œ, å¦‚æœæˆ‘ä»¬ç›´æ¥ä»¥<strong>æ±‰å­—</strong>ä½œä¸ºåŸºç¡€ç¬¦å·é›†, å°†é¢ä¸´ä¸€ä¸ªä¸¥å³»çš„é—®é¢˜:</p>
<ul>
<li>ä»…å¸¸ç”¨æ±‰å­—å°±æœ‰æ•°åƒ, å†åŠ ä¸Šç”Ÿåƒ»å­—, Emoji, å¤šè¯­è¨€ç¬¦å·, <strong>åˆå§‹è¯è¡¨è§„æ¨¡ä¼šéå¸¸åºå¤§</strong>, ä½¿å¾— BPE çš„ä¼˜åŠ¿éš¾ä»¥å‘æŒ¥</li>
<li>åŒæ—¶, å¯¹äºè¶…å‡ºåŸºç¡€å­—ç¬¦é›†çš„ç¬¦å·, ä»å¯èƒ½å‡ºç° <strong>UNK (Unknown)</strong> é—®é¢˜</li>
</ul>
<p><strong>ä¸ºäº†å…‹æœä¸Šè¿°å±€é™ï¼Œå·¥ç¨‹å¸ˆå°† BPE çš„æ€æƒ³åº”ç”¨åˆ°äº†æ›´åº•å±‚çš„ â€œå­—èŠ‚â€ å±‚é¢, ä»è€Œå‚¬ç”Ÿäº† BBPE ç®—æ³•</strong></p>
<h2 data-id="heading-4">ç»ˆææ–¹æ¡ˆï¼šBBPE â€”â€” ç°ä»£å¤§æ¨¡å‹çš„æ ‡é…</h2>
<p><strong>BBPE (Byte-Level BPE)</strong> å°† BPE ç®—æ³•åº”ç”¨äº<strong>å­—èŠ‚</strong>åºåˆ—, æ˜¯å½“å‰ GPT-4, Claude, LLaMA ç­‰å…ˆè¿›æ¨¡å‹é‡‡ç”¨çš„<strong>ä¸»æµåˆ†è¯æ–¹æ¡ˆ</strong></p>
<p>åœ¨æ·±å…¥ BBPE ä¹‹å‰, æˆ‘ä»¬å…ˆè¡¥ä¸Šå…³é”®çš„èƒŒæ™¯çŸ¥è¯†: Unicode ç ä¸å­—èŠ‚ç¼–ç çš„å…³ç³»</p>
<p><strong>Unicode ä¸å­—èŠ‚çš„å…³è”</strong></p>
<p>æˆ‘ä»¬æ—¥å¸¸çœ‹åˆ°çš„æ–‡å­—,ç¬¦å· (æ¯”å¦‚ â€œå…«â€ â€œaâ€ â€œğŸ˜Šâ€), åœ¨è®¡ç®—æœºé‡Œæœ¬è´¨ä¸Šéƒ½éœ€è¦è¢«ç¼–ç æˆæ•°å­—æ‰èƒ½å¤„ç†, è€Œ Unicode å°±æ˜¯è¿™å¥— â€œå­—ç¬¦â†’å”¯ä¸€æ•°å­—â€ çš„æ˜ å°„æ ‡å‡†. æ¯”å¦‚æ±‰å­— â€œå…«â€ å¯¹åº”çš„ Unicode ç æ˜¯ U+516B, è‹±æ–‡å­—æ¯ â€œaâ€ æ˜¯ U+0061, Emojiâ€œğŸ˜Šâ€ æ˜¯ U+1F60A</p>
<p>Unicode è§£å†³äº† â€œå­—ç¬¦æœ‰å”¯ä¸€æ ‡è¯†â€ çš„é—®é¢˜, ä½†å®ƒåªæ˜¯ â€œæ•°å­—ç¼–å·â€, å¹¶æ²¡æœ‰è§„å®šè¿™äº›æ•°å­—è¯¥å¦‚ä½•è½¬æ¢æˆè®¡ç®—æœºå­˜å‚¨å’Œä¼ è¾“çš„å­—èŠ‚â€”â€” è¿™å°±éœ€è¦ UTF-8 å’Œ UTF-16 ç­‰ç¼–ç æ–¹å¼, å…¶ä¸­ UTF-8 æ˜¯ç›®å‰æœ€ä¸»æµçš„å­—èŠ‚ç¼–ç æ–¹æ¡ˆ</p>
<p>UTF-8 é‡‡ç”¨ â€œå˜é•¿ç¼–ç â€ è§„åˆ™:</p>
<ul>
<li>è‹±æ–‡ã€æ•°å­—ç­‰ ASCII å­—ç¬¦: 1 ä¸ªå­—èŠ‚å°±èƒ½è¡¨ç¤ºï¼ˆæ¯”å¦‚ â€œaâ€ â†’ 0x61);</li>
<li>å¸¸ç”¨æ±‰å­—: 3 ä¸ªå­—èŠ‚ (æ¯”å¦‚ â€œå…«â€ â†’ 0xE5 0x85 0xAB);</li>
<li>ç‰¹æ®Šç¬¦å· / Emojiï¼šå¯èƒ½éœ€è¦ 4 ä¸ªå­—èŠ‚ (æ¯”å¦‚ â€œğŸ˜Šâ€ â†’ 0xF0 0x9F 0x98 0x8A)</li>
</ul>
<p>ç®€å•è¯´: Unicode ç»™æ¯ä¸ªå­—ç¬¦å‘äº†å”¯ä¸€ â€œèº«ä»½è¯å·â€, UTF-8 åˆ™æŠŠè¿™ä¸ª â€œèº«ä»½è¯å·â€ è½¬æ¢æˆäº†è®¡ç®—æœºèƒ½çœ‹æ‡‚çš„å­—èŠ‚åºåˆ—. è€Œ BBPE å°±æ˜¯ä»è¿™ä¸²å­—èŠ‚åºåˆ—å¼€å§‹å·¥ä½œçš„.</p>
<p><strong>BBPE æ˜¯æ€ä¹ˆåšçš„?</strong></p>
<ol>
<li><strong>ä¸‡ç‰©çš†å­—èŠ‚</strong>ï¼š
åœ¨è®¡ç®—æœºçš„è§†è§’ä¸‹ï¼Œæ‰€æœ‰æ–‡æœ¬â€”â€”æ— è®ºæ˜¯è‹±æ–‡, ä¸­æ–‡è¿˜æ˜¯ Emojiâ€”â€”å…¶æœ¬è´¨éƒ½æ˜¯ä¸€ä¸²å­—èŠ‚åºåˆ—
<ul>
<li>è‹±æ–‡ "a" = 1 ä¸ªå­—èŠ‚ <code>0x61</code></li>
<li>ä¸­æ–‡ "å…«" = 3 ä¸ªå­—èŠ‚ <code>0xE5 0x85 0xAB</code></li>
</ul>
</li>
<li><strong>åŸºç¡€è¯è¡¨æå°</strong>ï¼š
å­—èŠ‚åªæœ‰ 256 ç§å¯èƒ½çš„å€¼ (0x00-0xFF) è¿™æ„å‘³ç€, <strong>åˆå§‹è¯è¡¨çš„å¤§å°å›ºå®šä¸”ä»…ä¸º 256</strong>ï¼Œä»æ ¹æœ¬ä¸Šè§£å†³äº†æœªç™»å½•è¯ (OOV) é—®é¢˜</li>
<li><strong>ä»å­—èŠ‚å¼€å§‹çš„å±‚çº§åˆå¹¶</strong>ï¼š
BBPE ç®—æ³•å¤„ç†çš„ä¸æ˜¯"å…«ç™¾...", è€Œæ˜¯å…¶åº•å±‚çš„å­—èŠ‚è¡¨ç¤º: <code>E5 85 AB E7 99 BE ...</code>
<ul>
<li>ç®—æ³•å‘ç°å­—èŠ‚å¯¹ <code>(0xE5, 0x85)</code> é«˜é¢‘å…±ç° -&gt; åˆå¹¶ä¸ºæ–°å•å…ƒ</li>
<li>æ¥ç€å‘ç° <code>(E5 85, 0xAB)</code> é«˜é¢‘å…±ç° -&gt; å†åˆå¹¶ -&gt; ç”±æ­¤æ„å»ºå‡ºæ±‰å­—â€œå…«â€çš„è¡¨ç¤º</li>
<li>æœ€ç»ˆ, ç®—æ³•å‘ç°â€œå…«â€å’Œâ€œç™¾â€çš„è¡¨ç¤ºä¹Ÿé«˜é¢‘å…±ç° -&gt; å†æ¬¡åˆå¹¶ -&gt; ä»è€Œå­¦ä¹ åˆ°è¯è¯­"å…«ç™¾"çš„è¡¨ç¤º</li>
</ul>
</li>
</ol>
<p>BBPE ä½¿å¾—æ¨¡å‹æ— éœ€é¢„å…ˆå®šä¹‰æ±‰å­—æˆ–è¯æ±‡. å®ƒä»æœ€åº•å±‚çš„å­—èŠ‚å¼€å§‹, é€šè¿‡ç»Ÿè®¡é¢‘ç‡è‡ªåº•å‘ä¸Šåœ°å­¦ä¹ .è¿™ä¾¿æ˜¯ GPT èƒ½å¤Ÿä½¿ç”¨åŒä¸€å¥—ç²¾ç®€çš„è¯è¡¨ï¼Œé«˜æ•ˆå¤„ç†ä¸­æ–‡ã€è‹±æ–‡ã€ä»£ç ä¹ƒè‡³å¤šæ ·åŒ– Emoji çš„æ ¹æœ¬åŸå› </p>
<h2 data-id="heading-5">æ€»ç»“</h2>
<p>Token ä½œä¸ºå¤§æ¨¡å‹å¤„ç†ä¿¡æ¯çš„æ ¸å¿ƒå•å…ƒ, æ—¢ä¸æ˜¯ç®€å•çš„å­—ä¹Ÿä¸æ˜¯å®Œæ•´çš„è¯, è€Œæ˜¯å…¼é¡¾æ•ˆç‡ä¸è¯­ä¹‰çš„å­è¯å•å…ƒ. å¤§æ¨¡å‹ä¹‹æ‰€ä»¥é€‰æ‹©å­è¯åˆ‡åˆ†è€Œéå­—ç¬¦æˆ–æ•´è¯, æœ¬è´¨æ˜¯ä¸ºäº†å¹³è¡¡è¯æ±‡è¡¨è§„æ¨¡ä¸è¯­ä¹‰ä¿¡æ¯ä¿ç•™çš„éœ€æ±‚.</p>
<p>BPE ç®—æ³•é€šè¿‡ â€œé«˜é¢‘ç›¸é‚»ç¬¦å·å¯¹è¿­ä»£åˆå¹¶â€ çš„æ€è·¯, å®ç°äº†è¿™ç§å¹³è¡¡, ä½†ç›´æ¥ä»¥å­—ç¬¦ä¸ºåŸºç¡€ä¼šé¢ä¸´è¯è¡¨è¿‡å¤§, å…¼å®¹å¤šè¯­è¨€å›°éš¾ç­‰é—®é¢˜.</p>
<p>è€Œ BBPE å°† BPE çš„æ ¸å¿ƒé€»è¾‘ä¸‹æ²‰åˆ°å­—èŠ‚å±‚é¢, å‡­å€Ÿ 256 ä¸ªåŸºç¡€å­—èŠ‚çš„æå°åˆå§‹è¯è¡¨, ä¸ä»…è§£å†³äº†æœªç™»å½•è¯éš¾é¢˜, è¿˜å®ç°äº†è·¨è¯­è¨€è·¨ç¬¦å·ä½“ç³»çš„é«˜æ•ˆåˆ†è¯, æˆä¸º GPT-4 ç­‰ç°ä»£å¤§æ¨¡å‹çš„æ ‡é…æ–¹æ¡ˆ</p>
<p>æˆ‘æ˜¯å°åˆ»å›, ä¸€ä½æ¢ç´¢ AI çš„å‰ç«¯ç¨‹åºå‘˜, å…³æ³¨æˆ‘, è®© AI çŸ¥è¯†æœ‰æ¸©åº¦, æŠ€æœ¯è½åœ°æœ‰æ·±åº¦</p>
<h2 data-id="heading-6">(é™„) ä»£ç å®ç°ç¤ºä¾‹</h2>
<p>å¦‚æœä½ å¯¹æŠ€æœ¯å®ç°æ„Ÿå…´è¶£ï¼Œå¯ä»¥è¿è¡Œä¸‹é¢è¿™æ®µ Python ä»£ç æ¥æ¨¡æ‹Ÿ BPE çš„åˆå¹¶è¿‡ç¨‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> collections

<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_stats</span>(<span class="hljs-params">vocab</span>):
    <span class="hljs-string">"""ç»Ÿè®¡ç›¸é‚»å­—ç¬¦å¯¹çš„é¢‘ç‡"""</span>
    pairs = collections.defaultdict(<span class="hljs-built_in">int</span>)
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(vocab) - <span class="hljs-number">1</span>):
        pair = (vocab[i], vocab[i+<span class="hljs-number">1</span>])
        pairs[pair] += <span class="hljs-number">1</span>
    <span class="hljs-keyword">return</span> pairs

<span class="hljs-keyword">def</span> <span class="hljs-title function_">merge_vocab</span>(<span class="hljs-params">pair, v_in</span>):
    <span class="hljs-string">"""å°†é¢‘ç‡æœ€é«˜çš„å­—ç¬¦å¯¹åˆå¹¶"""</span>
    v_out = []
    bigram = pair
    replacement = <span class="hljs-string">''</span>.join(pair)  <span class="hljs-comment"># ç¡®ä¿åˆå¹¶åçš„ç»“æœæ˜¯å­—ç¬¦ä¸²</span>
    i = <span class="hljs-number">0</span>
    <span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(v_in):
        <span class="hljs-keyword">if</span> i &lt; <span class="hljs-built_in">len</span>(v_in) - <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> v_in[i] == bigram[<span class="hljs-number">0</span>] <span class="hljs-keyword">and</span> v_in[i+<span class="hljs-number">1</span>] == bigram[<span class="hljs-number">1</span>]:
            v_out.append(replacement)
            i += <span class="hljs-number">2</span>
        <span class="hljs-keyword">else</span>:
            v_out.append(v_in[i])
            i += <span class="hljs-number">1</span>
    <span class="hljs-keyword">return</span> v_out

<span class="hljs-comment"># è¾“å…¥æ–‡æœ¬</span>
text = <span class="hljs-string">"å…«ç™¾æ ‡å…µå¥”åŒ—å¡ï¼ŒåŒ—å¡ç‚®å…µå¹¶æ’è·‘ï¼Œç‚®å…µæ€•æŠŠæ ‡å…µç¢°ï¼Œæ ‡å…µæ€•ç¢°ç‚®å…µç‚®"</span>
tokens = <span class="hljs-built_in">list</span>(text)

<span class="hljs-comment"># æ¨¡æ‹Ÿåˆå¹¶è¿‡ç¨‹</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):
    pairs = get_stats(tokens)
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> pairs: <span class="hljs-keyword">break</span>
    best = <span class="hljs-built_in">max</span>(pairs, key=pairs.get)
    <span class="hljs-keyword">if</span> pairs[best] &lt; <span class="hljs-number">2</span>: <span class="hljs-keyword">break</span> <span class="hljs-comment"># é¢‘ç‡å°äº2åˆ™åœæ­¢</span>
    tokens = merge_vocab(best, tokens)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Step <span class="hljs-subst">{i+<span class="hljs-number">1</span>}</span>: åˆå¹¶ <span class="hljs-subst">{best}</span> -&gt; <span class="hljs-subst">{<span class="hljs-string">''</span>.join(best)}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å½“å‰ tokens: <span class="hljs-subst">{tokens}</span>"</span>)
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€SpringBoot 3.2å®æˆ˜ã€‘10å€æ€§èƒ½ä¼˜åŒ–çš„5ä¸ªå†·é—¨æŠ€å·§ï¼Œ90%å¼€å‘è€…éƒ½ä¸çŸ¥é“ï¼]]></title>    <link>https://juejin.cn/post/7580570363602927668</link>    <guid>https://juejin.cn/post/7580570363602927668</guid>    <pubDate>2025-12-08T00:17:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580570363602927668" data-draft-id="7580834172059811875" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€SpringBoot 3.2å®æˆ˜ã€‘10å€æ€§èƒ½ä¼˜åŒ–çš„5ä¸ªå†·é—¨æŠ€å·§ï¼Œ90%å¼€å‘è€…éƒ½ä¸çŸ¥é“ï¼"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-08T00:17:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ©™çš„ç™¾å®ç®±"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€SpringBoot 3.2å®æˆ˜ã€‘10å€æ€§èƒ½ä¼˜åŒ–çš„5ä¸ªå†·é—¨æŠ€å·§ï¼Œ90%å¼€å‘è€…éƒ½ä¸çŸ¥é“ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ©™çš„ç™¾å®ç®±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T00:17:02.000Z" title="Mon Dec 08 2025 00:17:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>ã€SpringBoot 3.2å®æˆ˜ã€‘10å€æ€§èƒ½ä¼˜åŒ–çš„5ä¸ªå†·é—¨æŠ€å·§ï¼Œ90%å¼€å‘è€…éƒ½ä¸çŸ¥é“ï¼</strong></h2>
<h2 data-id="heading-1">å¼•è¨€</h2>
<p>SpringBoot ä½œä¸º Java ç”Ÿæ€ä¸­æœ€æµè¡Œçš„æ¡†æ¶ä¹‹ä¸€ï¼Œå‡­å€Ÿå…¶â€œçº¦å®šä¼˜äºé…ç½®â€çš„ç†å¿µå’Œå¼ºå¤§çš„è‡ªåŠ¨è£…é…èƒ½åŠ›ï¼Œå·²ç»æˆä¸ºä¼ä¸šçº§åº”ç”¨å¼€å‘çš„é¦–é€‰ã€‚éšç€ SpringBoot 3.2 çš„å‘å¸ƒï¼Œæ€§èƒ½ä¼˜åŒ–æˆä¸ºäº†å¼€å‘è€…å…³æ³¨çš„ç„¦ç‚¹ã€‚ç„¶è€Œï¼Œå¤§å¤šæ•°å¼€å‘è€…å¾€å¾€åªå…³æ³¨å¸¸è§çš„ä¼˜åŒ–æ‰‹æ®µï¼ˆå¦‚ç¼“å­˜ã€å¼‚æ­¥å¤„ç†ç­‰ï¼‰ï¼Œè€Œå¿½ç•¥äº†ä¸€äº›å†·é—¨ä½†é«˜æ•ˆçš„æŠ€å·§ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨ <strong>5 ä¸ªè¢« 90% å¼€å‘è€…å¿½è§†çš„æ€§èƒ½ä¼˜åŒ–æŠ€å·§</strong>ï¼Œå¸®åŠ©ä½ åœ¨ SpringBoot 3.2 ä¸­å®ç° <strong>10 å€çš„æ€§èƒ½æå‡</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-2">ä¸»ä½“</h2>
<h3 data-id="heading-3">1. <strong>å¯ç”¨ JVM çš„ CDSï¼ˆClass Data Sharingï¼‰ç‰¹æ€§</strong></h3>
<h4 data-id="heading-4">èƒŒæ™¯</h4>
<p>JVM å¯åŠ¨æ—¶ï¼Œç±»åŠ è½½æ˜¯ä¸€ä¸ªè€—æ—¶çš„è¿‡ç¨‹ã€‚å°¤å…¶æ˜¯å¯¹äº SpringBoot è¿™ç§ä¾èµ–å¤§é‡ç±»åŠ è½½çš„åº”ç”¨ï¼Œå¯åŠ¨æ—¶é—´å¯èƒ½ä¼šæˆä¸ºç“¶é¢ˆã€‚</p>
<h4 data-id="heading-5">å†·é—¨æŠ€å·§</h4>
<p>Class Data Sharing (CDS) æ˜¯ JVM çš„ä¸€é¡¹ç‰¹æ€§ï¼Œå®ƒé€šè¿‡å°†å·²åŠ è½½çš„ç±»ä¿¡æ¯å­˜å‚¨åˆ°å…±äº«å½’æ¡£æ–‡ä»¶ä¸­ï¼Œä»è€Œå‡å°‘åç»­ JVM å®ä¾‹çš„å¯åŠ¨æ—¶é—´å’Œå†…å­˜å ç”¨ã€‚</p>
<h4 data-id="heading-6">å®æˆ˜æ­¥éª¤</h4>
<ol>
<li><strong>ç”Ÿæˆ CDS å½’æ¡£æ–‡ä»¶</strong>ï¼š
<pre><code class="hljs language-bash" lang="bash">java -Xshare:dump -XX:SharedArchiveFile=springboot.jsa -jar your-application.jar
</code></pre>
</li>
<li><strong>è¿è¡Œåº”ç”¨æ—¶å¯ç”¨ CDS</strong>ï¼š
<pre><code class="hljs language-bash" lang="bash">java -Xshare:on -XX:SharedArchiveFile=springboot.jsa -jar your-application.jar
</code></pre>
</li>
</ol>
<h4 data-id="heading-7">æ€§èƒ½æå‡</h4>
<ul>
<li><strong>å¯åŠ¨æ—¶é—´å‡å°‘ 30%-50%</strong>ï¼šå¯¹äºå¤§å‹ SpringBoot åº”ç”¨ï¼Œå¯åŠ¨æ—¶é—´å¯ä»¥ä»åŸæ¥çš„ 10s é™ä½åˆ° 5sã€‚</li>
<li><strong>å†…å­˜å ç”¨é™ä½</strong>ï¼šå…±äº«çš„ç±»æ•°æ®å‡å°‘äº†é‡å¤åŠ è½½çš„å¼€é”€ã€‚</li>
</ul>
<h4 data-id="heading-8">æ³¨æ„äº‹é¡¹</h4>
<ul>
<li>CDS éœ€è¦ JDK &gt;=13ï¼ˆSpringBoot 3.2+é»˜è®¤æ”¯æŒï¼‰ã€‚</li>
<li><code>-Xshare:dump</code>éœ€è¦ç¬¬ä¸€æ¬¡è¿è¡Œæ—¶ç”Ÿæˆå½’æ¡£æ–‡ä»¶ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-9">2. <strong>åˆ©ç”¨ GraalVM Native Imageï¼ˆåŸç”Ÿé•œåƒï¼‰</strong></h3>
<h4 data-id="heading-10">èƒŒæ™¯</h4>
<p>SpringBoot + JVMçš„ä¼ ç»Ÿæ–¹å¼è™½ç„¶å¼ºå¤§ï¼Œä½†ä»ç„¶å­˜åœ¨å¯åŠ¨æ…¢å’Œå†…å­˜å ç”¨é«˜çš„é—®é¢˜ã€‚GraalVM Native Imageå¯ä»¥å°†Javaåº”ç”¨ç¼–è¯‘ä¸ºåŸç”ŸäºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p>
<p>####å†·é—¨æŠ€å·§
SpringBoot3.2å¯¹GraalVMåŸç”Ÿé•œåƒçš„æ”¯æŒæ›´åŠ æˆç†Ÿã€‚é€šè¿‡AOTï¼ˆAhead-of-Timeï¼‰ç¼–è¯‘ï¼Œå¯ä»¥å½»åº•æ‘†è„±JVMçš„å¼€é”€ã€‚</p>
<p>####å®æˆ˜æ­¥éª¤
1.å®‰è£…GraalVMå¹¶é…ç½®ç¯å¢ƒå˜é‡ã€‚
2.æ·»åŠ Native Build Toolsä¾èµ–ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.graalvm.buildtools<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>native-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>3.ç¼–è¯‘åŸç”Ÿé•œåƒï¼š</p>
<pre><code class="hljs language-bash" lang="bash">mvn -Pnative native:compile
</code></pre>
<p>####æ€§èƒ½æå‡</p>
<ul>
<li><strong>å¯åŠ¨æ—¶é—´ä»ç§’çº§é™åˆ°æ¯«ç§’çº§</strong>ï¼šå…¸å‹çš„Spring Bootåº”ç”¨å¯åŠ¨æ—¶é—´å¯ä»¥&lt;100msã€‚</li>
<li><strong>å†…å­˜å ç”¨å‡å°‘5-10å€</strong>ï¼šå»é™¤äº†JITå’Œå…ƒæ•°æ®å¼€é”€ã€‚</li>
</ul>
<p>####æ³¨æ„äº‹é¡¹
-åå°„ã€åŠ¨æ€ä»£ç†ç­‰ç‰¹æ€§éœ€è¦é¢å¤–é…ç½®ã€‚
-ç›®å‰å¯¹æŸäº›åº“(å¦‚Spring Data JPA)æ”¯æŒä»æœ‰é™åˆ¶ã€‚</p>
<hr/>
<p>###3.<strong>ç²¾ç»†åŒ–æ§åˆ¶Beanæ‡’åŠ è½½</strong></p>
<p>####èƒŒæ™¯
Springé»˜è®¤ä¼šåœ¨å¯åŠ¨æ—¶åˆå§‹åŒ–æ‰€æœ‰å•ä¾‹Beanã€‚å¯¹äºå¤§å‹åº”ç”¨æ¥è¯´ï¼Œè¿™ä¼šå¯¼è‡´ä¸å¿…è¦çš„å¯åŠ¨å»¶è¿Ÿã€‚</p>
<p>####å†·é—¨æŠ€å·§
é€šè¿‡ç»„åˆä½¿ç”¨<code>@Lazy</code>æ³¨è§£å’Œæ¡ä»¶åŒ–é…ç½®ï¼Œå¯ä»¥å®ç°æ›´æ™ºèƒ½çš„BeanåŠ è½½ç­–ç•¥ã€‚</p>
<p>####æœ€ä½³å®è·µç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FeatureConfig</span> {
    <span class="hljs-meta">@Bean</span> 
    <span class="hljs-meta">@Lazy</span> <span class="hljs-comment">//å»¶è¿Ÿåˆå§‹åŒ–ç›´åˆ°é¦–æ¬¡ä½¿ç”¨ </span>
    <span class="hljs-meta">@ConditionalOnProperty(name = "feature.enabled", havingValue = "true")</span>
    <span class="hljs-keyword">public</span> ExpensiveBean <span class="hljs-title function_">expensiveBean</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExpensiveBean</span>();
    }
}
</code></pre>
<p>####æ€§èƒ½æå‡:
-å¯åŠ¨æ—¶é—´ç¼©çŸ­20%-40%ï¼ˆå–å†³äºå»¶è¿ŸåŠ è½½çš„Beanæ•°é‡ï¼‰
-å†…å­˜ä½¿ç”¨æ›´é«˜æ•ˆ</p>
<hr/>
<p>###4.<strong>ä¼˜åŒ–Jacksonçš„åºåˆ—åŒ–/ååºåˆ—åŒ–</strong></p>
<p>####èƒŒæ™¯:
åœ¨REST APIåº”ç”¨ä¸­ï¼ŒJSONå¤„ç†å¯èƒ½æ¶ˆè€—é«˜è¾¾30%çš„CPUèµ„æºã€‚</p>
<p>####å†·é—¨æŠ€å·§:
1.<strong>å¯ç”¨Jacksonçš„Afterburneræ¨¡å—</strong></p>
<pre><code class="hljs language-java" lang="java">mapper.registerModule(<span class="hljs-keyword">new</span> <span class="hljs-title class_">AfterburnerModule</span>());
</code></pre>
<p>è¿™ä¸ªå­—èŠ‚ç ç”Ÿæˆæ¨¡å—å¯ä»¥åŠ é€ŸPOJOè½¬æ¢ã€‚</p>
<p>2.<strong>é¢„ç¼–è¯‘æ¨¡å¼(Spring Boot3.2æ–°å¢)</strong>
åœ¨application.propertiesä¸­:</p>
<pre><code class="hljs language-properties" lang="properties">spring.jackson.generator.write-numbers-as-strings=true //é¿å…æ•°å­—ç±»å‹æ£€æŸ¥ 
spring.jackson.mapper.accept-case-insensitive-enums=true //å‡å°‘æšä¸¾å¤„ç†å¼€é”€ 
</code></pre>
<p>3.<strong>è‡ªå®šä¹‰æ··åˆæ³¨è§£(Hybrid Annotation)</strong>:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@JsonSerialize(using = CustomDateSerializer.class)</span> 
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderDTO</span> { ... } <span class="hljs-comment">//æ¯”é€šç”¨åºåˆ—åŒ–å™¨å¿«3å€ </span>

</code></pre>
<hr/>
<p>###5.<strong>æ™ºèƒ½è¿æ¥æ± é…ç½®</strong></p>
<p>####å¸¸è§è¯¯åŒº:
å¤§å¤šæ•°å¼€å‘è€…ç›´æ¥é‡‡ç”¨é»˜è®¤çš„HikariCPé…ç½®è€Œæ²¡æœ‰é’ˆå¯¹å…·ä½“åœºæ™¯ä¼˜åŒ–ã€‚</p>
<p>####é«˜çº§æŠ€å·§:</p>
<p>1.<strong>åˆ†åœºæ™¯é…ç½®è¿æ¥æ± :</strong></p>

























<table><thead><tr><th>åœºæ™¯</th><th>å…³é”®å‚æ•°</th><th>æ¨èå€¼</th></tr></thead><tbody><tr><td>OLTP</td><td>maximumPoolSize</td><td>CPUæ ¸å¿ƒæ•°*2 +ç£ç›˜æ•°</td></tr><tr><td>æ‰¹å¤„ç†</td><td>minimumIdle</td><td>0 (å®Œå…¨å¼¹æ€§)</td></tr><tr><td>æ··åˆè´Ÿè½½</td><td>connectionTimeout</td><td>3000ms(äº‘ç¯å¢ƒå»ºè®®æ›´ä½)</td></tr></tbody></table>
<p>2.<strong>åŠ¨æ€è°ƒæ•´ç­–ç•¥(ç»“åˆMicrometer):</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Scheduled(fixedRate =5000)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">adjustPool</span><span class="hljs-params">()</span>{
<span class="hljs-type">int</span> <span class="hljs-variable">active</span> <span class="hljs-operator">=</span> metrics.getActiveConnections();
<span class="hljs-type">int</span> <span class="hljs-variable">total</span> <span class="hljs-operator">=</span> metrics.getTotalConnections();
<span class="hljs-keyword">if</span>(active &gt;total *<span class="hljs-number">0.8</span>){
hikariConfig.setMaximumPoolSize(total +<span class="hljs-number">5</span>);
}
}
</code></pre>
<hr/>
<p>##æ€»ç»“</p>
<p>è¿™äº›çœ‹ä¼¼ç®€å•çš„ä¼˜åŒ–æŠ€å·§å¾€å¾€è¢«å¤§å¤šæ•°å¼€å‘è€…å¿½è§†ï¼š</p>
<p>1.CDSè®©JVM"è®°ä½"ç±»åŠ è½½ç»“æœï¼ˆâœ”ï¸ï¼‰
2.GraalV MNative Imageå®ç°ç¬æ—¶å¯åŠ¨ï¼ˆâœ”ï¸ï¼‰
3.ç²¾ç»†åŒ–æ‡’åŠ è½½æ§åˆ¶ï¼ˆâœ”ï¸ï¼‰
4.Jacksonçš„é«˜çº§è°ƒä¼˜ï¼ˆâœ”ï¸ï¼‰
5.æ™ºèƒ½è¿æ¥æ± ç®¡ç†ï¼ˆâœ”ï¸ï¼‰</p>
<p>å½“è¿™äº›æŠ€æœ¯ç»„åˆä½¿ç”¨æ—¶ï¼Œä½ çš„Spring Boot3.2åº”ç”¨å®Œå…¨æœ‰å¯èƒ½è·å¾—<strong>æ•°é‡çº§çº§åˆ«çš„æ€§èƒ½æå‡</strong>ã€‚æ›´é‡è¦çš„æ˜¯â€”â€”è¿™äº›æ–¹æ¡ˆéƒ½ç»è¿‡äº†ç”Ÿäº§éªŒè¯ä¸”ç¬¦åˆæ¡†æ¶è®¾è®¡å“²å­¦ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[flutter-å±å¹•è‡ªé€‚åº”æ’ä»¶flutter_screenutilæ•™ç¨‹å…¨æŒ‡å—]]></title>    <link>https://juejin.cn/post/7580389111921786943</link>    <guid>https://juejin.cn/post/7580389111921786943</guid>    <pubDate>2025-12-08T00:21:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580389111921786943" data-draft-id="7580373352421523482" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="flutter-å±å¹•è‡ªé€‚åº”æ’ä»¶flutter_screenutilæ•™ç¨‹å…¨æŒ‡å—"/> <meta itemprop="keywords" content="å‰ç«¯,Flutter,Android"/> <meta itemprop="datePublished" content="2025-12-08T00:21:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¹å¤šå¤š"/> <meta itemprop="url" content="https://juejin.cn/user/747323639737191"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            flutter-å±å¹•è‡ªé€‚åº”æ’ä»¶flutter_screenutilæ•™ç¨‹å…¨æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/747323639737191/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¹å¤šå¤š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T00:21:43.000Z" title="Mon Dec 08 2025 00:21:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:2;font-weight:400;font-size:15px;overflow-x:hidden;color:#333;letter-spacing:1.2px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1:first-child,.markdown-body h2:first-child,.markdown-body h3:first-child,.markdown-body h4:first-child,.markdown-body h5:first-child,.markdown-body h6:first-child{margin-top:-1.5rem;margin-bottom:1rem}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{content:"#";display:inline-block;color:#3eaf7c;padding-right:.23em}.markdown-body h1{position:relative;font-size:2.5rem;margin-bottom:5px}.markdown-body h1:before{font-size:2.5rem}.markdown-body h2{padding-bottom:.5rem;font-size:2.2rem;border-bottom:1px solid #ececec}.markdown-body h3{font-size:1.5rem;padding-bottom:0}.markdown-body h4{font-size:1.25rem}.markdown-body h5{font-size:1rem}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body strong{color:#3eaf7c}.markdown-body img{max-width:100%;border-radius:2px;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #3eaf7c;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;overflow-x:auto;padding:.2rem .5rem;margin:0;color:#3eaf7c;font-size:.85em;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:.5rem solid #3eaf7c}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{font-weight:500;text-decoration:none;color:#3eaf7c;margin:0 5px}.markdown-body a:active,.markdown-body a:hover{text-decoration:none;border-bottom:1.5px solid #3eaf7c}.markdown-body a[href^=http]:after{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTQiIGhlaWdodD0iMTQiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik04MzIgMTI4SDY0MHY2NGgxNDYuNzUyTDUyMS4zNzYgNDU3LjM3Nmw0NS4yNDggNDUuMjQ4TDgzMiAyMzcuMjQ4VjM4NGg2NFYxMjh6IiBmaWxsPSIjM2VhZjdjIi8+PHBhdGggZD0iTTc2OCA4MzJIMTkyVjI1NmgzNTJ2LTY0SDE2MGEzMiAzMiAwIDAwLTMyIDMydjY0MGEzMiAzMiAwIDAwMzIgMzJoNjQwYTMyIDMyIDAgMDAzMi0zMlY0ODBoLTY0djM1MnoiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");margin-left:2px}.markdown-body a[href^="#"]:before{content:"#"}.markdown-body table{display:inline-block!important;font-size:13px;width:auto;max-width:100%;overflow:auto;border:1px solid #3eaf7c;border-collapse:collapse}.markdown-body thead{background:#3eaf7c;color:#fff;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(153,255,188,.1)}.markdown-body td,.markdown-body th{padding:4px 8px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#7b7878;padding:1px 23px;border-left:.5rem solid;border-color:#42b983;background-color:rgba(66,184,131,.1);position:relative;margin:14px 8px 0}.markdown-body blockquote:before{display:inline-block;position:absolute;content:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjUiIGhlaWdodD0iMjUiIHZpZXdCb3g9IjAgMCAyNyAyNyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxLjg2MiAxLjg2MikiIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0ibm9uZSI+PGNpcmNsZSBzdHJva2U9IiNGRkYiIHN0cm9rZS13aWR0aD0iMS43MjQiIGZpbGw9IiM0MkI5ODMiIGN4PSIxMS42MzgiIGN5PSIxMS42MzgiIHI9IjExLjYzOCIvPjxwYXRoIGQ9Ik0xNC45NzggNi4yN0E1LjAwNiA1LjAwNiAwIDAwNi42NyA5LjQ2OGE0LjkwMSA0LjkwMSAwIDAwMS43NzMgNC4zNjJjLjMyMy4yNTguNTE0LjY0Ny41MjIgMS4wNnYxLjA2YTIuNjg1IDIuNjg1IDAgMDA1LjM3IDB2LTEuMDA4Yy4wMDItLjM5OC4xNzMtLjc3Ny40Ny0xLjA0MmE1LjAyMyA1LjAyMyAwIDAwLjE3My03LjYzem0tMy4zMzcgMTAuOTY3YTEuMzA0IDEuMzA0IDAgMDEtMS4yODYtMS4yODd2LS4yNzhoMi41NzJ2LjI2MWMwIC43MTMtLjU3MyAxLjI5NC0xLjI4NiAxLjMwNHptMi4yNi00LjQxNWMtLjQ0LjM4My0uNzUuODkzLS44ODcgMS40NmgtMi43NDZhMi44NjggMi44NjggMCAwMC0uOTM4LTEuNTNoLS4wMThhMy40NzYgMy40NzYgMCAwMS0xLjI2OS0zLjE0NSAzLjYxNSAzLjYxNSAwIDAxNy4xOTYuNCAzLjY1IDMuNjUgMCAwMS0xLjMzOCAyLjgxNXoiIGZpbGw9IiNGRkYiLz48L2c+PC9zdmc+");width:25px;height:25px;left:-16px;top:12px}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{outline:none;border:none;border-left:4px solid #3eaf7c;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary::-webkit-details-marker{color:#3eaf7c}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ol li::marker{color:#3eaf7c}.markdown-body ul li{list-style:none;padding-left:10px}.markdown-body ul li::marker{content:"â€¢";color:#3eaf7c}.markdown-body ul li.task-list-item:before{content:"";margin-right:0}.markdown-body input[type=checkbox]{vertical-align:text-bottom;box-shadow:inset 0 0 0 10px #fff}.markdown-body input[type=checkbox]:before{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik04NzcuMDU2IDE0Ni45NDR2NzMwLjExMkgxNDYuOTQ0VjE0Ni45NDRoNzMwLjExMnptMC0xMDQuMjc3SDE0Ni45NDRjLTU3LjYyOCAwLTEwNC4yNzcgNDYuNjQ5LTEwNC4yNzcgMTA0LjI3N3Y3MzAuMTEyYzAgNTcuNjI4IDQ2LjY0OSAxMDQuMjc3IDEwNC4yNzcgMTA0LjI3N2g3MzAuMTEyYzU3LjYyOCAwIDEwNC4yNzctNDYuNjQ5IDEwNC4yNzctMTA0LjI3N1YxNDYuOTQ0YzAtNTcuNjI4LTQ2LjY0OS0xMDQuMjc3LTEwNC4yNzctMTA0LjI3N3oiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");position:relative;top:-2px;right:2px}.markdown-body input[type=checkbox]:checked:before{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik05MTAuMjA4IDBIMTEzLjc2QTExNC4xMTIgMTE0LjExMiAwIDAwLS4wMzIgMTEzLjc5MlY5MTAuMjRjMCA2Mi41OTIgNTEuMiAxMTMuNzkyIDExMy43OTIgMTEzLjc5Mmg3OTYuNDQ4YzYyLjU5MiAwIDExMy43OTItNTEuMiAxMTMuNzkyLTExMy43OTJWMTEzLjc5MkMxMDI0IDUxLjIgOTcyLjggMCA5MTAuMjA4IDB6bS01MTIgNzk2LjQ0OEwxMTMuNzYgNTEybDc5LjY0OC03OS42NDggMjA0LjggMjA0LjhMODMwLjU2IDIwNC44bDc5LjY0OCA3OS42NDgtNTEyIDUxMnoiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");position:relative;top:-2px;right:2px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="agate">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#333;color:#fff}.hljs-name,.hljs-strong{font-weight:700}.hljs-code,.hljs-emphasis{font-style:italic}.hljs-tag{color:#62c8f3}.hljs-selector-class,.hljs-selector-id,.hljs-template-variable,.hljs-variable{color:#ade5fc}.hljs-bullet,.hljs-string{color:#a2fca2}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-quote,.hljs-section,.hljs-title,.hljs-type{color:#ffa}.hljs-bullet,.hljs-number,.hljs-symbol{color:#d36363}.hljs-keyword,.hljs-literal,.hljs-selector-tag{color:#fcc28c}.hljs-code,.hljs-comment,.hljs-deletion{color:#888}.hljs-link,.hljs-regexp{color:#c6b4f0}.hljs-meta{color:#fc9b9b}.hljs-deletion{background-color:#fc9b9b;color:#333}.hljs-addition{background-color:#a2fca2;color:#333}.hljs a{color:inherit}.hljs a:focus,.hljs a:hover{color:inherit;text-decoration:underline}</style><p>åœ¨Flutterå¼€å‘ä¸­ï¼Œå±å¹•å°ºå¯¸ç¢ç‰‡åŒ–æ˜¯å½±å“ç”¨æˆ·ä½“éªŒçš„å…³é”®é—®é¢˜ã€‚ä¸åŒè®¾å¤‡çš„åˆ†è¾¨ç‡ã€åƒç´ å¯†åº¦å·®å¼‚ä¼šå¯¼è‡´UIå¸ƒå±€åœ¨éƒ¨åˆ†è®¾å¤‡ä¸Šå‡ºç°é”™ä½ã€æ‹‰ä¼¸æˆ–ç•™ç™½ç­‰é—®é¢˜ã€‚<code>flutter_screenutil</code>ä½œä¸ºä¸€æ¬¾ä¸“æ³¨äºå±å¹•è‡ªé€‚åº”çš„ç¬¬ä¸‰æ–¹æ’ä»¶ï¼Œé€šè¿‡ç®€å•ç›´è§‚çš„APIå®ç°äº†"ä¸€å¥—ä»£ç é€‚é…æ‰€æœ‰å±å¹•"çš„ç›®æ ‡ï¼Œå·²æˆä¸ºFlutterç”Ÿæ€ä¸­æœ€å—æ¬¢è¿çš„è‡ªé€‚åº”è§£å†³æ–¹æ¡ˆä¹‹ä¸€ã€‚</p>
<h2 data-id="heading-0">1. æ’ä»¶æ ¸å¿ƒä»·å€¼ä¸å·¥ä½œåŸç†</h2>
<h3 data-id="heading-1">1.1 æ ¸å¿ƒè§£å†³çš„é—®é¢˜</h3>
<p>ä¼ ç»Ÿçš„å›ºå®šå°ºå¯¸å¼€å‘æ¨¡å¼å­˜åœ¨ä¸‰å¤§ç—›ç‚¹ï¼š</p>
<ul>
<li><strong>å°ºå¯¸é€‚é…éš¾é¢˜</strong>ï¼šç›¸åŒæ•°å€¼çš„å°ºå¯¸åœ¨ä¸åŒåˆ†è¾¨ç‡è®¾å¤‡ä¸Šæ˜¾ç¤ºæ•ˆæœå·®å¼‚å·¨å¤§</li>
<li><strong>åƒç´ å¯†åº¦é€‚é…</strong>ï¼šä¸åŒDPIè®¾å¤‡å¯¹å›¾ç‰‡ã€å­—ä½“çš„æ¸²æŸ“ç²¾åº¦è¦æ±‚ä¸åŒ</li>
<li><strong>å±å¹•æ¯”ä¾‹é€‚é…</strong>ï¼šä»4.7è‹±å¯¸æ‰‹æœºåˆ°10.9è‹±å¯¸å¹³æ¿çš„å®½é«˜æ¯”å·®å¼‚å¯¼è‡´å¸ƒå±€å˜å½¢</li>
</ul>
<p><code>flutter_screenutil</code>é€šè¿‡ç»Ÿä¸€çš„å°ºå¯¸è½¬æ¢æœºåˆ¶ï¼Œå°†è®¾è®¡ç¨¿å°ºå¯¸è‡ªåŠ¨æ˜ å°„ä¸ºä¸åŒè®¾å¤‡çš„å®é™…æ˜¾ç¤ºå°ºå¯¸ï¼Œå®Œç¾è§£å†³äº†ä»¥ä¸Šé—®é¢˜ã€‚</p>
<h3 data-id="heading-2">1.2 æ ¸å¿ƒå·¥ä½œåŸç†</h3>
<p>è¯¥æ’ä»¶çš„æ ¸å¿ƒå®ç°åŸºäºä¸¤ä¸ªå…³é”®æ¦‚å¿µï¼š</p>
<ol>
<li><strong>è®¾è®¡ç¨¿åŸºå‡†</strong>ï¼šä»¥ç‰¹å®šå°ºå¯¸çš„è®¾è®¡ç¨¿ï¼ˆå¦‚375Ã—812pxçš„iPhone Xï¼‰ä½œä¸ºåŸºå‡†</li>
<li><strong>åŠ¨æ€æ¯”ä¾‹è®¡ç®—</strong>ï¼šæ ¹æ®å½“å‰è®¾å¤‡å±å¹•å°ºå¯¸ä¸è®¾è®¡ç¨¿å°ºå¯¸çš„æ¯”ä¾‹ï¼ŒåŠ¨æ€è®¡ç®—å®é™…æ˜¾ç¤ºå°ºå¯¸</li>
</ol>
<p>å…·ä½“è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š</p>
<ul>
<li>å®½åº¦é€‚é…ï¼š<code>å®é™…å®½åº¦ = è®¾è®¡ç¨¿å®½åº¦ Ã— (è®¾å¤‡å±å¹•å®½åº¦ / è®¾è®¡ç¨¿åŸºå‡†å®½åº¦)</code></li>
<li>é«˜åº¦é€‚é…ï¼š<code>å®é™…é«˜åº¦ = è®¾è®¡ç¨¿é«˜åº¦ Ã— (è®¾å¤‡å±å¹•é«˜åº¦ / è®¾è®¡ç¨¿åŸºå‡†é«˜åº¦)</code></li>
<li>å­—ä½“é€‚é…ï¼šåœ¨å®½åº¦é€‚é…åŸºç¡€ä¸Šï¼Œå¯é¢å¤–è®¾ç½®å­—ä½“ç¼©æ”¾æ¯”ä¾‹</li>
</ul>
<h2 data-id="heading-3">2. åŸºç¡€é›†æˆä¸åˆå§‹åŒ–</h2>
<h3 data-id="heading-4">2.1 ç¯å¢ƒè¦æ±‚</h3>
<ul>
<li>Flutterç‰ˆæœ¬ â‰¥ 2.0.0</li>
<li>Dartç‰ˆæœ¬ â‰¥ 2.12.0ï¼ˆç©ºå®‰å…¨æ”¯æŒï¼‰</li>
</ul>
<h3 data-id="heading-5">2.2 é›†æˆæ­¥éª¤</h3>
<h4 data-id="heading-6">ç¬¬ä¸€æ­¥ï¼šæ·»åŠ ä¾èµ–</h4>
<p>åœ¨<code>pubspec.yaml</code>æ–‡ä»¶ä¸­æ·»åŠ æœ€æ–°ç‰ˆæœ¬ä¾èµ–ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">dependencies:</span>
  <span class="hljs-attr">flutter:</span>
    <span class="hljs-attr">sdk:</span> <span class="hljs-string">flutter</span>
  <span class="hljs-attr">flutter_screenutil:</span> <span class="hljs-string">^5.9.0</span>  <span class="hljs-comment"># å»ºè®®ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬</span>
</code></pre>
<p>æ‰§è¡Œä¾èµ–å®‰è£…å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">flutter pub get
</code></pre>
<h4 data-id="heading-7">ç¬¬äºŒæ­¥ï¼šå¯¼å…¥åŒ…</h4>
<p>åœ¨éœ€è¦ä½¿ç”¨çš„dartæ–‡ä»¶ä¸­å¯¼å…¥ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">import</span> <span class="hljs-string">'package:flutter_screenutil/flutter_screenutil.dart'</span>;
</code></pre>
<h4 data-id="heading-8">ç¬¬ä¸‰æ­¥ï¼šåˆå§‹åŒ–é…ç½®</h4>
<p>åœ¨åº”ç”¨å…¥å£<code>MaterialApp</code>çš„<code>builder</code>ä¸­åˆå§‹åŒ–<code>ScreenUtilInit</code>ï¼Œé…ç½®è®¾è®¡ç¨¿åŸºå‡†å°ºå¯¸ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">void</span> main() {
  runApp(<span class="hljs-keyword">const</span> MyApp());
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyApp</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>{
  <span class="hljs-keyword">const</span> MyApp({<span class="hljs-keyword">super</span>.key});

  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> ScreenUtilInit(
      <span class="hljs-comment">// è®¾è®¡ç¨¿å®½åº¦ï¼ˆå•ä½ï¼špxï¼‰</span>
      designSize: <span class="hljs-keyword">const</span> Size(<span class="hljs-number">375</span>, <span class="hljs-number">812</span>), 
      <span class="hljs-comment">// æ˜¯å¦å…è®¸å­—ä½“æ ¹æ®ç³»ç»Ÿç¼©æ”¾æ¯”ä¾‹è°ƒæ•´</span>
      minTextAdapt: <span class="hljs-keyword">true</span>,
      <span class="hljs-comment">// å­—ä½“ç¼©æ”¾æ¯”ä¾‹ï¼ˆå¯é€‰ï¼Œé»˜è®¤1.0ï¼‰</span>
      splitScreenMode: <span class="hljs-keyword">true</span>,
      builder: (context, child) {
        <span class="hljs-keyword">return</span> MaterialApp(
          title: <span class="hljs-string">'ScreenUtil Demo'</span>,
          <span class="hljs-comment">// è®¾ç½®å…¨å±€å­—ä½“å¤§å°é€‚é…</span>
          theme: ThemeData(
            textTheme: TextTheme(
              bodyLarge: TextStyle(fontSize: <span class="hljs-number">16.</span>sp),
              bodyMedium: TextStyle(fontSize: <span class="hljs-number">14.</span>sp),
            ),
          ),
          home: <span class="hljs-keyword">const</span> HomePage(),
        );
      },
    );
  }
}
</code></pre>
<p><strong>å…³é”®å‚æ•°è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>designSize</code>ï¼šå¿…å¡«ï¼Œè®¾è®¡ç¨¿çš„å®½é«˜å°ºå¯¸ï¼ˆå»ºè®®ä½¿ç”¨UIæä¾›çš„æ ‡å‡†è®¾è®¡ç¨¿å°ºå¯¸ï¼‰</li>
<li><code>minTextAdapt</code>ï¼šå¯é€‰ï¼Œæ˜¯å¦å¼€å¯å­—ä½“æœ€å°é€‚é…ï¼Œé˜²æ­¢å­—ä½“è¿‡å°</li>
<li><code>splitScreenMode</code>ï¼šå¯é€‰ï¼Œæ˜¯å¦æ”¯æŒåˆ†å±æ¨¡å¼é€‚é…</li>
<li><code>builder</code>ï¼šå¿…å¡«ï¼Œåˆå§‹åŒ–å®Œæˆåçš„æ„å»ºå›è°ƒï¼Œè¿”å›åº”ç”¨ä¸»ç•Œé¢</li>
</ul>
<h2 data-id="heading-9">3. æ ¸å¿ƒAPIä¸åŸºç¡€ç”¨æ³•</h2>
<p><code>flutter_screenutil</code>æä¾›äº†ç›´è§‚çš„å°ºå¯¸è½¬æ¢APIï¼Œé€šè¿‡åœ¨æ•°å€¼åæ·»åŠ ç‰¹å®šåç¼€å®ç°ä¸åŒç±»å‹çš„é€‚é…ï¼Œä¸»è¦åŒ…æ‹¬ä»¥ä¸‹ä¸‰ç±»ï¼š</p>
<h3 data-id="heading-10">3.1 å°ºå¯¸é€‚é…ï¼ˆdpå•ä½ï¼‰</h3>
<p>ç”¨äºWidgetçš„å®½é«˜ã€å†…è¾¹è·ã€å¤–è¾¹è·ç­‰å°ºå¯¸å±æ€§ï¼Œä½¿ç”¨<code>.w</code>ï¼ˆå®½åº¦æ–¹å‘ï¼‰å’Œ<code>.h</code>ï¼ˆé«˜åº¦æ–¹å‘ï¼‰åç¼€ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// 1. å®¹å™¨å°ºå¯¸é€‚é…</span>
Container(
  <span class="hljs-comment">// è®¾è®¡ç¨¿å®½åº¦100px â†’ å®é™…å®½åº¦=100 Ã— (è®¾å¤‡å®½åº¦/375)</span>
  width: <span class="hljs-number">100.</span>w,
  <span class="hljs-comment">// è®¾è®¡ç¨¿é«˜åº¦50px â†’ å®é™…é«˜åº¦=50 Ã— (è®¾å¤‡é«˜åº¦/812)</span>
  height: <span class="hljs-number">50.</span>h,
  color: Colors.blue,
  child: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">'å°ºå¯¸é€‚é…ç¤ºä¾‹'</span>),
)

<span class="hljs-comment">// 2. å†…è¾¹è·é€‚é…</span>
Padding(
  <span class="hljs-comment">// ä¸Šä¸‹å·¦å³å„16pxçš„å†…è¾¹è·ï¼Œåˆ†åˆ«æŒ‰å®½é«˜æ–¹å‘é€‚é…</span>
  padding: EdgeInsets.all(<span class="hljs-number">16.</span>w), 
  child: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">'å†…è¾¹è·é€‚é…'</span>),
)

<span class="hljs-comment">// 3. å¤–è¾¹è·é€‚é…</span>
Margin(
  margin: EdgeInsets.symmetric(
    horizontal: <span class="hljs-number">20.</span>w,  <span class="hljs-comment">// æ°´å¹³æ–¹å‘æŒ‰å®½åº¦æ¯”ä¾‹é€‚é…</span>
    vertical: <span class="hljs-number">10.</span>h     <span class="hljs-comment">// å‚ç›´æ–¹å‘æŒ‰é«˜åº¦æ¯”ä¾‹é€‚é…</span>
  ),
  child: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">'å¤–è¾¹è·é€‚é…'</span>),
)
</code></pre>
<p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼š</p>
<ul>
<li>å®½åº¦ç›¸å…³å±æ€§ï¼ˆå¦‚<code>width</code>ã€<code>horizontal</code>ï¼‰å»ºè®®ä½¿ç”¨<code>.w</code>åç¼€</li>
<li>é«˜åº¦ç›¸å…³å±æ€§ï¼ˆå¦‚<code>height</code>ã€<code>vertical</code>ï¼‰å»ºè®®ä½¿ç”¨<code>.h</code>åç¼€</li>
<li>æ­£æ–¹å½¢å°ºå¯¸ï¼ˆå¦‚åœ†å½¢å¤´åƒï¼‰å»ºè®®ç»Ÿä¸€ä½¿ç”¨<code>.w</code>æˆ–<code>.h</code>ï¼Œé¿å…å®½é«˜æ¯”ä¾‹ä¸ä¸€è‡´</li>
</ul>
<h3 data-id="heading-11">3.2 å­—ä½“é€‚é…ï¼ˆspå•ä½ï¼‰</h3>
<p>ç”¨äºæ–‡æœ¬å­—ä½“å¤§å°é€‚é…ï¼Œä½¿ç”¨<code>.sp</code>åç¼€ï¼Œè‡ªåŠ¨é€‚é…ä¸åŒè®¾å¤‡çš„å­—ä½“ç¼©æ”¾è®¾ç½®ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// åŸºç¡€å­—ä½“é€‚é…</span>
Text(
  <span class="hljs-string">'å­—ä½“é€‚é…ç¤ºä¾‹'</span>,
  style: TextStyle(
    <span class="hljs-comment">// è®¾è®¡ç¨¿å­—ä½“å¤§å°18px â†’ è‡ªåŠ¨é€‚é…è®¾å¤‡</span>
    fontSize: <span class="hljs-number">18.</span>sp,
    fontWeight: FontWeight.bold,
  ),
)

<span class="hljs-comment">// å¸¦æœ€å°å­—ä½“é™åˆ¶çš„é€‚é…</span>
Text(
  <span class="hljs-string">'æœ€å°å­—ä½“é€‚é…'</span>,
  style: TextStyle(
    fontSize: <span class="hljs-number">12.</span>spMin,  <span class="hljs-comment">// ç¡®ä¿å­—ä½“ä¸å°äº12px</span>
  ),
)
</code></pre>
<p><strong>å­—ä½“é€‚é…ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>è‡ªåŠ¨å“åº”ç³»ç»Ÿå­—ä½“ç¼©æ”¾è®¾ç½®ï¼ˆå¦‚ç”¨æˆ·åœ¨ç³»ç»Ÿè®¾ç½®ä¸­æ”¾å¤§å­—ä½“ï¼‰</li>
<li>é€šè¿‡<code>spMin</code>ç¡®ä¿å­—ä½“ä¸ä¼šå› å±å¹•è¿‡å°è€Œå˜å¾—éš¾ä»¥é˜…è¯»</li>
<li>å…¨å±€ç»Ÿä¸€çš„å­—ä½“ç¼©æ”¾æ¯”ä¾‹ï¼Œä¾¿äºæ•´ä½“è°ƒæ•´</li>
</ul>
<h3 data-id="heading-12">3.3 å±å¹•å°ºå¯¸å·¥å…·ç±»</h3>
<p><code>ScreenUtil</code>ç±»æä¾›äº†ä¸°å¯Œçš„å±å¹•ä¿¡æ¯è·å–æ–¹æ³•ï¼Œæ–¹ä¾¿åœ¨ç‰¹æ®Šåœºæ™¯ä¸‹ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// è·å–å±å¹•å®½åº¦ï¼ˆpxï¼‰</span>
<span class="hljs-built_in">double</span> screenWidth = ScreenUtil().screenWidth;

<span class="hljs-comment">// è·å–å±å¹•é«˜åº¦ï¼ˆpxï¼‰</span>
<span class="hljs-built_in">double</span> screenHeight = ScreenUtil().screenHeight;

<span class="hljs-comment">// è·å–çŠ¶æ€æ é«˜åº¦</span>
<span class="hljs-built_in">double</span> statusBarHeight = ScreenUtil().statusBarHeight;

<span class="hljs-comment">// è·å–åº•éƒ¨å®‰å…¨åŒºåŸŸé«˜åº¦ï¼ˆé€‚ç”¨äºå…¨é¢å±ï¼‰</span>
<span class="hljs-built_in">double</span> bottomBarHeight = ScreenUtil().bottomBarHeight;

<span class="hljs-comment">// è·å–å±å¹•åƒç´ å¯†åº¦</span>
<span class="hljs-built_in">double</span> pixelRatio = ScreenUtil().pixelRatio;

<span class="hljs-comment">// è®¾è®¡ç¨¿å®½åº¦ä¸å®é™…å±å¹•å®½åº¦çš„æ¯”ä¾‹</span>
<span class="hljs-built_in">double</span> scaleWidth = ScreenUtil().scaleWidth;

<span class="hljs-comment">// è®¾è®¡ç¨¿é«˜åº¦ä¸å®é™…å±å¹•é«˜åº¦çš„æ¯”ä¾‹</span>
<span class="hljs-built_in">double</span> scaleHeight = ScreenUtil().scaleHeight;
</code></pre>
<p><strong>å®ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>æ ¹æ®å±å¹•å®½åº¦åŠ¨æ€è°ƒæ•´ç½‘æ ¼å¸ƒå±€çš„åˆ—æ•°</li>
<li>æ ¹æ®å®‰å…¨åŒºåŸŸé«˜åº¦è°ƒæ•´åº•éƒ¨æŒ‰é’®ä½ç½®</li>
<li>æ ¹æ®å±å¹•æ¯”ä¾‹å†³å®šæ˜¯å¦æ˜¾ç¤ºæŸäº›UIå…ƒç´ </li>
</ul>
<h2 data-id="heading-13">4. é«˜çº§åº”ç”¨åœºæ™¯</h2>
<h3 data-id="heading-14">4.1 å¤šè®¾è®¡ç¨¿å°ºå¯¸é€‚é…</h3>
<p>å¯¹äºéœ€è¦åŒæ—¶é€‚é…æ‰‹æœºå’Œå¹³æ¿çš„åº”ç”¨ï¼Œå¯ä»¥é€šè¿‡<code>ScreenUtilInit</code>çš„<code>designSize</code>åŠ¨æ€åˆ‡æ¢è®¾è®¡ç¨¿åŸºå‡†ï¼š</p>
<pre><code class="hljs language-dart" lang="dart">ScreenUtilInit(
  <span class="hljs-comment">// æ ¹æ®å±å¹•å®½åº¦åˆ¤æ–­ä½¿ç”¨æ‰‹æœºè¿˜æ˜¯å¹³æ¿è®¾è®¡ç¨¿</span>
  designSize: MediaQuery.of(context).size.width &gt; <span class="hljs-number">600</span> 
      ? <span class="hljs-keyword">const</span> Size(<span class="hljs-number">1024</span>, <span class="hljs-number">1366</span>)  <span class="hljs-comment">// å¹³æ¿è®¾è®¡ç¨¿</span>
      : <span class="hljs-keyword">const</span> Size(<span class="hljs-number">375</span>, <span class="hljs-number">812</span>),   <span class="hljs-comment">// æ‰‹æœºè®¾è®¡ç¨¿</span>
  builder: (context, child) {
    <span class="hljs-comment">// ...</span>
  },
)
</code></pre>
<h3 data-id="heading-15">4.2 å“åº”å¼å¸ƒå±€ç»“åˆ</h3>
<p>å°†<code>flutter_screenutil</code>ä¸FlutteråŸç”Ÿçš„<code>LayoutBuilder</code>ã€<code>MediaQuery</code>ç»“åˆï¼Œå®ç°æ›´ç²¾ç»†çš„å“åº”å¼å¸ƒå±€ï¼š</p>
<pre><code class="hljs language-dart" lang="dart">LayoutBuilder(
  builder: (context, constraints) {
    <span class="hljs-keyword">return</span> Column(
      children: [
        <span class="hljs-comment">// å›ºå®šé«˜åº¦çš„å¤´éƒ¨ï¼ˆä½¿ç”¨hé€‚é…ï¼‰</span>
        Container(height: <span class="hljs-number">80.</span>h, color: Colors.blue),
        <span class="hljs-comment">// å æ»¡å‰©ä½™é«˜åº¦çš„å†…å®¹åŒº</span>
        Expanded(
          child: Container(
            width: constraints.maxWidth.w,  <span class="hljs-comment">// ç»“åˆå¸ƒå±€çº¦æŸ</span>
            color: Colors.grey[<span class="hljs-number">200</span>],
          ),
        ),
      ],
    );
  },
)
</code></pre>
<h3 data-id="heading-16">4.3 å›¾ç‰‡è‡ªé€‚åº”</h3>
<p>ç»“åˆ<code>Image</code>ç»„ä»¶å’Œ<code>flutter_screenutil</code>ï¼Œå®ç°å›¾ç‰‡åœ¨ä¸åŒå±å¹•ä¸Šçš„è‡ªé€‚åº”æ˜¾ç¤ºï¼š</p>
<pre><code class="hljs language-dart" lang="dart">Image.asset(
  <span class="hljs-string">'assets/images/banner.png'</span>,
  <span class="hljs-comment">// å®½åº¦é€‚é…å±å¹•ï¼Œé«˜åº¦æŒ‰æ¯”ä¾‹ç¼©æ”¾</span>
  width: <span class="hljs-built_in">double</span>.infinity,
  height: <span class="hljs-number">200.</span>h,
  fit: BoxFit.cover,
)

<span class="hljs-comment">// åœ†å½¢å¤´åƒé€‚é…</span>
Container(
  width: <span class="hljs-number">80.</span>w,
  height: <span class="hljs-number">80.</span>w,  <span class="hljs-comment">// å®½é«˜ä¸€è‡´ç¡®ä¿åœ†å½¢</span>
  decoration: BoxDecoration(
    shape: BoxShape.circle,
    image: DecorationImage(
      image: AssetImage(<span class="hljs-string">'assets/images/avatar.png'</span>),
      fit: BoxFit.cover,
    ),
  ),
)
</code></pre>
<h3 data-id="heading-17">4.4 é€‚é…æµ‹è¯•å·¥å…·</h3>
<p><code>flutter_screenutil</code>æä¾›äº†<code>ScreenUtilDebug</code>ç»„ä»¶ï¼Œæ–¹ä¾¿åœ¨å¼€å‘è¿‡ç¨‹ä¸­æŸ¥çœ‹é€‚é…ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// åœ¨ç•Œé¢åº•éƒ¨æ·»åŠ è°ƒè¯•ä¿¡æ¯</span>
Stack(
  children: [
    <span class="hljs-comment">// ä¸»å†…å®¹åŒº</span>
    <span class="hljs-keyword">const</span> YourMainContent(),
    <span class="hljs-comment">// è°ƒè¯•ä¿¡æ¯ï¼ˆä»…åœ¨å¼€å‘ç¯å¢ƒæ˜¾ç¤ºï¼‰</span>
    <span class="hljs-keyword">if</span> (kDebugMode)
      Positioned(
        bottom: <span class="hljs-number">20.</span>h,
        left: <span class="hljs-number">0</span>,
        right: <span class="hljs-number">0</span>,
        child: ScreenUtilDebug(
          <span class="hljs-comment">// æ˜¾ç¤ºå½“å‰å±å¹•ä¿¡æ¯ã€é€‚é…æ¯”ä¾‹ç­‰</span>
          infoType: ScreenUtilInfoType.all,
        ),
      ),
  ],
)
</code></pre>
<h2 data-id="heading-18">5. å®æˆ˜æ¡ˆä¾‹ï¼šç™»å½•é¡µé¢é€‚é…</h2>
<p>ä¸‹é¢é€šè¿‡ä¸€ä¸ªå®Œæ•´çš„ç™»å½•é¡µé¢æ¡ˆä¾‹ï¼Œå±•ç¤º<code>flutter_screenutil</code>çš„ç»¼åˆåº”ç”¨ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoginPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>{
  <span class="hljs-keyword">const</span> LoginPage({<span class="hljs-keyword">super</span>.key});

  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> Scaffold(
      body: SingleChildScrollView(
        padding: EdgeInsets.symmetric(horizontal: <span class="hljs-number">30.</span>w, vertical: <span class="hljs-number">80.</span>h),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.center,
          children: [
            <span class="hljs-comment">// åº”ç”¨Logo</span>
            Image.asset(
              <span class="hljs-string">'assets/images/logo.png'</span>,
              width: <span class="hljs-number">120.</span>w,
              height: <span class="hljs-number">120.</span>w,
            ),
            SizedBox(height: <span class="hljs-number">40.</span>h),
            
            <span class="hljs-comment">// æ ‡é¢˜</span>
            Text(
              <span class="hljs-string">'æ¬¢è¿ç™»å½•'</span>,
              style: TextStyle(
                fontSize: <span class="hljs-number">24.</span>sp,
                fontWeight: FontWeight.bold,
                color: Colors.black87,
              ),
            ),
            SizedBox(height: <span class="hljs-number">60.</span>h),
            
            <span class="hljs-comment">// è´¦å·è¾“å…¥æ¡†</span>
            TextField(
              decoration: InputDecoration(
                hintText: <span class="hljs-string">'è¯·è¾“å…¥è´¦å·'</span>,
                hintStyle: TextStyle(fontSize: <span class="hljs-number">14.</span>sp, color: Colors.grey),
                contentPadding: EdgeInsets.symmetric(
                  horizontal: <span class="hljs-number">16.</span>w,
                  vertical: <span class="hljs-number">14.</span>h,
                ),
                border: OutlineInputBorder(
                  borderRadius: BorderRadius.circular(<span class="hljs-number">8.</span>w),
                  borderSide: BorderSide(width: <span class="hljs-number">1.</span>w, color: Colors.grey[<span class="hljs-number">300</span>]!),
                ),
              ),
              style: TextStyle(fontSize: <span class="hljs-number">16.</span>sp),
            ),
            SizedBox(height: <span class="hljs-number">20.</span>h),
            
            <span class="hljs-comment">// å¯†ç è¾“å…¥æ¡†</span>
            TextField(
              obscureText: <span class="hljs-keyword">true</span>,
              decoration: InputDecoration(
                hintText: <span class="hljs-string">'è¯·è¾“å…¥å¯†ç '</span>,
                hintStyle: TextStyle(fontSize: <span class="hljs-number">14.</span>sp, color: Colors.grey),
                contentPadding: EdgeInsets.symmetric(
                  horizontal: <span class="hljs-number">16.</span>w,
                  vertical: <span class="hljs-number">14.</span>h,
                ),
                border: OutlineInputBorder(
                  borderRadius: BorderRadius.circular(<span class="hljs-number">8.</span>w),
                  borderSide: BorderSide(width: <span class="hljs-number">1.</span>w, color: Colors.grey[<span class="hljs-number">300</span>]!),
                ),
              ),
              style: TextStyle(fontSize: <span class="hljs-number">16.</span>sp),
            ),
            SizedBox(height: <span class="hljs-number">30.</span>h),
            
            <span class="hljs-comment">// ç™»å½•æŒ‰é’®</span>
            SizedBox(
              width: <span class="hljs-built_in">double</span>.infinity,
              height: <span class="hljs-number">50.</span>h,
              child: ElevatedButton(
                onPressed: () {},
                style: ElevatedButton.styleFrom(
                  backgroundColor: Colors.blue,
                  shape: RoundedRectangleBorder(
                    borderRadius: BorderRadius.circular(<span class="hljs-number">8.</span>w),
                  ),
                ),
                child: Text(
                  <span class="hljs-string">'ç™»å½•'</span>,
                  style: TextStyle(fontSize: <span class="hljs-number">18.</span>sp, color: Colors.white),
                ),
              ),
            ),
            
            <span class="hljs-comment">// åº•éƒ¨æ–‡å­—</span>
            SizedBox(height: <span class="hljs-number">40.</span>h),
            Row(
              mainAxisAlignment: MainAxisAlignment.center,
              children: [
                Text(
                  <span class="hljs-string">'è¿˜æ²¡æœ‰è´¦å·ï¼Ÿ'</span>,
                  style: TextStyle(fontSize: <span class="hljs-number">14.</span>sp, color: Colors.grey[<span class="hljs-number">600</span>]),
                ),
                TextButton(
                  onPressed: () {},
                  child: Text(
                    <span class="hljs-string">'ç«‹å³æ³¨å†Œ'</span>,
                    style: TextStyle(fontSize: <span class="hljs-number">14.</span>sp, color: Colors.blue),
                  ),
                ),
              ],
            ),
          ],
        ),
      ),
    );
  }
}
</code></pre>
<h2 data-id="heading-19">6. æ€§èƒ½ä¼˜åŒ–ä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-20">6.1 æ€§èƒ½ä¼˜åŒ–å»ºè®®</h3>
<ol>
<li><strong>é¿å…é¢‘ç¹åˆå§‹åŒ–</strong>ï¼š<code>ScreenUtilInit</code>åº”åœ¨åº”ç”¨é¡¶å±‚åˆå§‹åŒ–ä¸€æ¬¡ï¼Œé¿å…åœ¨å­é¡µé¢é‡å¤åˆå§‹åŒ–</li>
<li><strong>å‡å°‘ä¸å¿…è¦çš„å°ºå¯¸è®¡ç®—</strong>ï¼šå¯¹äºå›ºå®šæ¯”ä¾‹çš„UIå…ƒç´ ï¼Œå¯ç¼“å­˜è®¡ç®—ç»“æœ</li>
<li><strong>åˆç†ä½¿ç”¨<code>const</code>æ„é€ å‡½æ•°</strong>ï¼šå¯¹äºä¸ä¾èµ–å°ºå¯¸å˜åŒ–çš„Widgetï¼Œä½¿ç”¨<code>const</code>ä¿®é¥°ä»¥æé«˜æ€§èƒ½</li>
<li><strong>é¿å…è¿‡åº¦é€‚é…</strong>ï¼šå¯¹äºè£…é¥°æ€§å…ƒç´ ï¼ˆå¦‚åˆ†å‰²çº¿ï¼‰ï¼Œå¯ä½¿ç”¨å›ºå®šåƒç´ å€¼ï¼ˆå¦‚1pxï¼‰ï¼Œæ— éœ€é€‚é…</li>
</ol>
<h3 data-id="heading-21">6.2 æœ€ä½³å®è·µæ€»ç»“</h3>
<ol>
<li><strong>ç»Ÿä¸€è®¾è®¡ç¨¿åŸºå‡†</strong>ï¼šä¸UIå›¢é˜Ÿçº¦å®šç»Ÿä¸€çš„è®¾è®¡ç¨¿å°ºå¯¸ï¼ˆå¦‚iPhone Xçš„375Ã—812pxï¼‰</li>
<li><strong>ä¼˜å…ˆä½¿ç”¨æ–¹å‘åç¼€</strong>ï¼šå®½åº¦ç›¸å…³ç”¨<code>.w</code>ï¼Œé«˜åº¦ç›¸å…³ç”¨<code>.h</code>ï¼Œå­—ä½“ç”¨<code>.sp</code></li>
<li><strong>æµ‹è¯•å¤šè®¾å¤‡åœºæ™¯</strong>ï¼šåœ¨ä¸åŒå°ºå¯¸ã€ä¸åŒDPIçš„æ¨¡æ‹Ÿå™¨/çœŸæœºä¸Šæµ‹è¯•é€‚é…æ•ˆæœ</li>
<li><strong>ç»“åˆç³»ç»Ÿè®¾ç½®</strong>ï¼šé€šè¿‡<code>minTextAdapt</code>ç¡®ä¿å­—ä½“é€‚é…ç³»ç»Ÿç¼©æ”¾è®¾ç½®</li>
<li><strong>æ–‡æ¡£åŒ–é€‚é…è§„åˆ™</strong>ï¼šåœ¨é¡¹ç›®ä¸­å»ºç«‹é€‚é…è§„èŒƒæ–‡æ¡£ï¼Œç¡®ä¿å›¢é˜Ÿæˆå‘˜ç»Ÿä¸€ä½¿ç”¨</li>
</ol>
<h2 data-id="heading-22">7. å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-23">Q1: é€‚é…åUIåœ¨æŸäº›è®¾å¤‡ä¸Šä»æœ‰å˜å½¢ï¼Ÿ</h3>
<p>A1: æ£€æŸ¥æ˜¯å¦æ··ç”¨äº†é€‚é…å•ä½å’ŒåŸå§‹å•ä½ï¼ˆå¦‚åŒæ—¶ä½¿ç”¨<code>100.w</code>å’Œ<code>100.0</code>ï¼‰ï¼Œç¡®ä¿æ‰€æœ‰å°ºå¯¸éƒ½ä½¿ç”¨<code>flutter_screenutil</code>çš„é€‚é…å•ä½ã€‚</p>
<h3 data-id="heading-24">Q2: å­—ä½“é€‚é…åä»ä¸å“åº”ç³»ç»Ÿå­—ä½“ç¼©æ”¾ï¼Ÿ</h3>
<p>A2: ç¡®è®¤<code>ScreenUtilInit</code>çš„<code>minTextAdapt</code>è®¾ç½®ä¸º<code>true</code>ï¼Œå¹¶ä¸”å­—ä½“å°ºå¯¸ä½¿ç”¨<code>.sp</code>åç¼€ï¼Œè€Œé<code>.w</code>æˆ–<code>.h</code>ã€‚</p>
<h3 data-id="heading-25">Q3: å…¨é¢å±åº•éƒ¨æœ‰ç•™ç™½æˆ–å†…å®¹è¢«é®æŒ¡ï¼Ÿ</h3>
<p>A3: ä½¿ç”¨<code>ScreenUtil().bottomBarHeight</code>è·å–åº•éƒ¨å®‰å…¨åŒºåŸŸé«˜åº¦ï¼Œåœ¨åº•éƒ¨æ·»åŠ å¯¹åº”é«˜åº¦çš„<code>SizedBox</code>æˆ–<code>Padding</code>ã€‚</p>
<h3 data-id="heading-26">Q4: æ¨ªç«–å±åˆ‡æ¢æ—¶é€‚é…å¤±æ•ˆï¼Ÿ</h3>
<p>A4: åœ¨<code>ScreenUtilInit</code>ä¸­è®¾ç½®<code>splitScreenMode: true</code>ï¼Œå¹¶ç¡®ä¿å¸ƒå±€èƒ½å¤Ÿå“åº”å±å¹•æ–¹å‘å˜åŒ–ã€‚</p>
<h2 data-id="heading-27">8. æ’ä»¶å¯¹æ¯”ä¸é€‰å‹å»ºè®®</h2>





























<table><thead><tr><th>é€‚é…æ–¹æ¡ˆ</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>flutter_screenutil</td><td>APIç®€æ´ã€å­¦ä¹ æˆæœ¬ä½ã€åŠŸèƒ½å…¨é¢</td><td>éœ€ä¾èµ–ç¬¬ä¸‰æ–¹åº“</td><td>å¤§å¤šæ•°Flutteråº”ç”¨ï¼Œå°¤å…¶æ˜¯ä¸­å°å‹é¡¹ç›®</td></tr><tr><td>åŸç”ŸMediaQuery</td><td>æ— ä¾èµ–ã€ç³»ç»ŸåŸç”Ÿæ”¯æŒ</td><td>éœ€æ‰‹åŠ¨è®¡ç®—æ¯”ä¾‹ã€ä»£ç å†—ä½™</td><td>ç®€å•é€‚é…åœºæ™¯ï¼Œæˆ–å¯¹ç¬¬ä¸‰æ–¹åº“æ•æ„Ÿçš„é¡¹ç›®</td></tr><tr><td>responsive_framework</td><td>æ”¯æŒæ–­ç‚¹é€‚é…ã€å¸ƒå±€é‡ç»„</td><td>é…ç½®å¤æ‚ã€å­¦ä¹ æˆæœ¬é«˜</td><td>å¤§å‹åº”ç”¨ã€éœ€è¦ç²¾ç»†å“åº”å¼å¸ƒå±€çš„åœºæ™¯</td></tr></tbody></table>
<p><strong>é€‰å‹å»ºè®®</strong>ï¼š</p>
<ul>
<li>å¯¹äºå¤§å¤šæ•°Flutteråº”ç”¨ï¼Œ<code>flutter_screenutil</code>æ˜¯æ€§ä»·æ¯”æœ€é«˜çš„é€‰æ‹©ï¼Œèƒ½å¤Ÿä»¥æœ€ä½çš„å­¦ä¹ æˆæœ¬å®ç°é«˜è´¨é‡çš„å±å¹•é€‚é…</li>
<li>å¯¹äºéœ€è¦æ”¯æŒå¤šç§å±å¹•å°ºå¯¸ï¼ˆå¦‚æ‰‹æœºã€å¹³æ¿ã€ç”µè„‘ï¼‰çš„å¤æ‚åº”ç”¨ï¼Œå¯ç»“åˆ<code>responsive_framework</code>å’Œ<code>flutter_screenutil</code>ä½¿ç”¨</li>
<li>å¯¹äºæç®€åº”ç”¨æˆ–å¯¹åŒ…ä½“ç§¯æœ‰ä¸¥æ ¼è¦æ±‚çš„åœºæ™¯ï¼Œå¯è€ƒè™‘åŸç”Ÿ<code>MediaQuery</code>æ–¹æ¡ˆ</li>
</ul>
<p>å®˜æ–¹ä»“åº“ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FOpenFlutter%2Fflutter_screenutil" target="_blank" title="https://github.com/OpenFlutter/flutter_screenutil" ref="nofollow noopener noreferrer">flutter_screenutil GitHub</a>ï¼Œå¯è·å–æœ€æ–°ç‰ˆæœ¬ã€æäº¤ Issueã€æŸ¥çœ‹å®˜æ–¹ç¤ºä¾‹ä»£ç â€‹</p>
<hr/>
<blockquote>
<p>æœ¬æ¬¡åˆ†äº«å°±åˆ°è¿™å„¿å•¦ï¼Œæˆ‘æ˜¯é¹å¤šå¤šï¼Œæ·±è€•å‰ç«¯çš„æŠ€æœ¯åˆ›ä½œè€…ï¼Œå¦‚æœæ‚¨çœ‹äº†è§‰å¾—æœ‰å¸®åŠ©ï¼Œæ¬¢è¿è¯„è®ºï¼Œå…³æ³¨ï¼Œç‚¹èµï¼Œè½¬å‘ï¼Œæˆ‘ä»¬ä¸‹æ¬¡è§~</p>
</blockquote>
<p>PSï¼šåœ¨æœ¬é¡µæŒ‰F12ï¼Œåœ¨consoleä¸­è¾“å…¥document.getElementsByClassName('panel-btn')[0].click();æœ‰æƒŠå–œå“¦~</p>
<p><code>å¾€æœŸæ–‡ç« </code></p>
<ul>
<li><a href="https://juejin.cn/post/7570923924365230143" target="_blank" title="https://juejin.cn/post/7570923924365230143">flutterå›¾ç‰‡é€‰æ‹©åº“multi_image_picker_pluså’Œimage_pickerçš„å¯¹æ¯”å’Œä½¿ç”¨è§£æ</a></li>
<li><a href="https://juejin.cn/post/7568136081302978623" target="_blank" title="https://juejin.cn/post/7568136081302978623">è§£é”flutterå¼¹çª—æ–°å§¿åŠ¿ï¼šdialog-flutter_smart_dialogæ’ä»¶è§£è¯»+æ¡ˆä¾‹</a></li>
<li><a href="https://juejin.cn/post/7559089440901545999" target="_blank" title="https://juejin.cn/post/7559089440901545999">flutter-åˆ‡æ¢çŠ¶æ€æ˜¾ç¤ºä¸åŒç»„ä»¶10ç§å®ç°æ–¹æ¡ˆå…¨è§£æ</a></li>
<li><a href="https://juejin.cn/post/7555079970491318308" target="_blank" title="https://juejin.cn/post/7555079970491318308">flutter-è¯¦è§£æ§åˆ¶ç»„ä»¶æ˜¾ç¤ºçš„ä¸¤ç§æ–¹å¼Offstageä¸Visibility</a></li>
<li><a href="https://juejin.cn/post/7535358416182788122" target="_blank" title="https://juejin.cn/post/7535358416182788122">flutter-ä½¿ç”¨AnimatedDefaultTextStyleå®ç°æ–‡æœ¬åŠ¨ç”»</a></li>
<li><a href="https://juejin.cn/post/7537339432291434496" target="_blank" title="https://juejin.cn/post/7537339432291434496">flutter-ä½¿ç”¨SafeAreaç»„ä»¶å¤„ç†å„æœºå‹çš„å®‰å…¨è·ç¦»</a></li>
<li><a href="https://juejin.cn/spost/7537593417099149321" target="_blank" title="https://juejin.cn/spost/7537593417099149321">flutter-å®ç°æ¸å˜è‰²è¾¹æ¡†èƒŒæ™¯ä»¥åŠæ¸å˜è‰²æ–‡å­—</a></li>
<li><a href="https://juejin.cn/post/7543474419240370185" target="_blank" title="https://juejin.cn/post/7543474419240370185">flutter-ä½¿ç”¨confettiåˆ¶ä½œç‚«é…·çº¸å±‘çˆ†ç‚¸ç²’å­åŠ¨ç”»</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ZabbixWatchï¼šæ‰“é€ ç°ä»£åŒ–è¿ç»´ç›‘æ§å¤§å±ï¼Œè®©æ•°æ®æŒæ§è§¦æ‰‹å¯åŠ]]></title>    <link>https://juejin.cn/post/7580735683939991586</link>    <guid>https://juejin.cn/post/7580735683939991586</guid>    <pubDate>2025-12-08T00:48:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580735683939991586" data-draft-id="7579093746612158464" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ZabbixWatchï¼šæ‰“é€ ç°ä»£åŒ–è¿ç»´ç›‘æ§å¤§å±ï¼Œè®©æ•°æ®æŒæ§è§¦æ‰‹å¯åŠ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-08T00:48:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="YL_jia"/> <meta itemprop="url" content="https://juejin.cn/user/1467226241383211"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ZabbixWatchï¼šæ‰“é€ ç°ä»£åŒ–è¿ç»´ç›‘æ§å¤§å±ï¼Œè®©æ•°æ®æŒæ§è§¦æ‰‹å¯åŠ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1467226241383211/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    YL_jia
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T00:48:57.000Z" title="Mon Dec 08 2025 00:48:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å‘Šåˆ«ä¼ ç»ŸZabbixçš„å¤æ‚ç•Œé¢ï¼Œä¸€æ¬¾åŸºäºZabbixçš„ä¼ä¸šçº§å¯è§†åŒ–å¤§å±ç³»ç»Ÿæ­£åœ¨é‡æ–°å®šä¹‰è¿ç»´ç›‘æ§ä½“éªŒã€‚</p>
</blockquote>
<p>åœ¨å½“ä»Šè¿™ä¸ªæ•°æ®é©±åŠ¨çš„æ—¶ä»£ï¼Œè¿ç»´å›¢é˜Ÿé¢ä¸´çš„æŒ‘æˆ˜æ—¥ç›Šå¢å¤šã€‚ç›‘æ§æ•°æ®å¦‚æ½®æ°´èˆ¬æ¶Œæ¥ï¼Œå´å¾€å¾€å› ç¼ºä¹ç›´è§‚å‘ˆç°è€Œå¤±å»ä»·å€¼ã€‚ä¼ ç»ŸZabbixç•Œé¢åŠŸèƒ½è™½å¼ºï¼Œä½†å…¶åŸç”ŸUIå¯¹å¤§è§„æ¨¡æ•°æ®å±•ç¤ºå’Œå†³ç­–æ”¯æŒå¹¶ä¸å‹å¥½ã€‚ZabbixWatchåº”è¿è€Œç”Ÿï¼Œå®ƒå°†å¼ºå¤§çš„Zabbixç›‘æ§å¼•æ“ä¸ç°ä»£æ•°æ®å¯è§†åŒ–æŠ€æœ¯ç›¸ç»“åˆï¼Œè®©ç›‘æ§æ•°æ®ä»¥é…·ç‚«ã€ç›´è§‚çš„â€œå¤§å±â€å½¢å¼å‘ˆç°ï¼Œå¸®åŠ©è¿ç»´å›¢é˜ŸçœŸæ­£å®ç°ä»â€œè¢«åŠ¨æ•‘ç«â€åˆ°<strong>ä¸»åŠ¨æ´å¯Ÿ</strong>çš„è½¬å˜ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€æ ¸å¿ƒç‰¹ç‚¹ï¼šè¶…è¶Šä¼ ç»Ÿç›‘æ§çš„å…«å¤§èƒ½åŠ›</h2>
<p>ä¸åŸç”ŸZabbixç•Œé¢ç›¸æ¯”ï¼ŒZabbixWatchåœ¨æ•°æ®å¯è§†åŒ–ã€å®šåˆ¶åŒ–å’Œæ™ºèƒ½åŒ–æ–¹é¢å®ç°äº†è·¨è¶Šå¼å‡çº§ã€‚å…¶æ ¸å¿ƒä»·å€¼åœ¨äºï¼š</p>
<ul>
<li><strong>é›¶é…ç½®æ¥å…¥</strong>ï¼šç›´æ¥è¿æ¥ç°æœ‰ZabbixæœåŠ¡å™¨ï¼Œæ— éœ€ä¿®æ”¹Zabbixçš„ä»»ä½•é…ç½®ã€‚æ‚¨åªéœ€è¦æä¾›Zabbixçš„URLå’Œè´¦å·ï¼Œç³»ç»Ÿå°±èƒ½è‡ªåŠ¨è·å–ç›‘æ§æ•°æ®ã€‚</li>
<li><strong>æ‹–æ‹½å¼å¤§å±ç¼–è¾‘å™¨</strong>ï¼šæœ€é©å‘½æ€§çš„åŠŸèƒ½ä¹‹ä¸€ï¼Œæ— éœ€ç¼–å†™ä»»ä½•ä»£ç å³å¯é€šè¿‡æ‹–æ‹½å›¾è¡¨ç»„ä»¶ï¼Œè‡ªç”±è®¾è®¡å’Œç»„åˆä¸“å±ç›‘æ§å¤§å±ã€‚</li>
<li><strong>å¤šZabbixæ•°æ®æºæ”¯æŒ</strong>ï¼šå¯¹äºæ‹¥æœ‰å¤šå¥—Zabbixç¯å¢ƒï¼ˆå¦‚å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ï¼‰çš„ä¼ä¸šï¼ŒZabbixWatchå¯ä»¥ç»Ÿä¸€æ¥å…¥ï¼Œåœ¨ä¸€ä¸ªå¹³å°ä¸Šé›†ä¸­å±•ç¤ºã€‚</li>
<li><strong>AIå¢å¼ºçš„å‘Šè­¦åˆ†æ</strong>ï¼šå†…ç½®ä¸AIå¤§æ¨¡å‹ï¼ˆå¦‚ç¡…åŸºæµåŠ¨ã€DeepSeekï¼‰çš„é›†æˆï¼Œä¸ä»…èƒ½å‘Šè­¦ï¼Œè¿˜èƒ½åˆæ­¥åˆ†æå‘Šè­¦åŸå› ï¼Œæä¾›å¯èƒ½çš„è§£å†³æ–¹æ¡ˆã€‚</li>
<li><strong>å®æ—¶æ•°æ®å±•ç¤ºä¸å…¨å±æ¨¡å¼</strong>ï¼šç›‘æ§å¤§å±æ”¯æŒæ•°æ®å®æ—¶åˆ·æ–°ï¼Œå¹¶ä¸€é”®åˆ‡æ¢è‡³å…¨å±æ¨¡å¼ï¼Œæ˜¯NOCï¼ˆç½‘ç»œè¿è¥ä¸­å¿ƒï¼‰æˆ–å¤§å±å±•ç¤ºçš„ç†æƒ³é€‰æ‹©ã€‚</li>
</ul>
<p>ä¸‹è¡¨æ¸…æ™°åœ°å±•ç¤ºäº†ä»åŸç”ŸZabbixåˆ°ZabbixWatchçš„å…³é”®æå‡ï¼š</p>



































<table><thead><tr><th align="left">ç‰¹æ€§ç»´åº¦</th><th align="left">ä¼ ç»ŸZabbixåŸç”Ÿç•Œé¢</th><th align="left">ZabbixWatchç›‘æ§å¤§å±</th></tr></thead><tbody><tr><td align="left"><strong>æ•°æ®å‘ˆç°æ–¹å¼</strong></td><td align="left">åˆ—è¡¨ã€ç®€å•å›¾è¡¨ä¸ºä¸»ï¼Œåˆ†æ•£åœ¨å¤šé¡µé¢</td><td align="left"><strong>é«˜åº¦é›†æˆçš„å¤§å±</strong>ï¼Œå›¾è¡¨ä¸°å¯Œï¼Œä¿¡æ¯é›†ä¸­</td></tr><tr><td align="left"><strong>å¤§å±å®šåˆ¶èƒ½åŠ›</strong></td><td align="left">åŸºæœ¬ä¸æ”¯æŒï¼Œéœ€å¤æ‚é…ç½®</td><td align="left"><strong>æ‹–æ‹½å¼ç¼–è¾‘å™¨</strong>ï¼Œå¯è‡ªç”±è®¾è®¡</td></tr><tr><td align="left"><strong>å¤šç¯å¢ƒç®¡ç†</strong></td><td align="left">éœ€åˆ†åˆ«ç™»å½•ä¸åŒå®ä¾‹</td><td align="left"><strong>ç»Ÿä¸€å¹³å°</strong>æ¥å…¥å¤šå¥—Zabbixæ•°æ®æº</td></tr><tr><td align="left"><strong>å‘Šè­¦å¤„ç†</strong></td><td align="left">æ˜¾ç¤ºå‘Šè­¦ä¿¡æ¯</td><td align="left"><strong>AIæ™ºèƒ½åˆ†æ</strong>ï¼Œè¾…åŠ©æ ¹å› å®šä½</td></tr><tr><td align="left"><strong>ä½¿ç”¨é—¨æ§›</strong></td><td align="left">è¾ƒé«˜ï¼Œéœ€ç†Ÿæ‚‰Zabbixæ¦‚å¿µ</td><td align="left"><strong>è¾ƒä½</strong>ï¼Œå¯è§†åŒ–æ“ä½œï¼Œç›´è§‚æ˜“æ‡‚</td></tr></tbody></table>
<h2 data-id="heading-1">äºŒã€å®‰è£…éƒ¨ç½²ï¼šDocker Composeä¸€é”®å¯åŠ¨</h2>
<p>ZabbixWatché‡‡ç”¨ç°ä»£åŒ–çš„å®¹å™¨åŒ–éƒ¨ç½²ï¼Œæ•´ä¸ªè¿‡ç¨‹ç®€æ´é«˜æ•ˆã€‚</p>
<h3 data-id="heading-2">ç¯å¢ƒå‡†å¤‡</h3>
<ul>
<li><strong>åŸºç¡€ç¯å¢ƒ</strong>ï¼šä¸€å°å·²å®‰è£…<code>Docker</code>ï¼ˆ19.03.0+ï¼‰å’Œ<code>Docker Compose</code>ï¼ˆ1.27.0+ï¼‰çš„æœåŠ¡å™¨ã€‚</li>
<li><strong>ç½‘ç»œè¦æ±‚</strong>ï¼šè¯¥æœåŠ¡å™¨éœ€è¦èƒ½å¤Ÿè®¿é—®æ‚¨çš„Zabbix Serverçš„APIæ¥å£ï¼ˆé€šå¸¸ä¸º10051ç«¯å£å’ŒWebç«¯å£ï¼‰ã€‚</li>
<li><strong>Zabbixç¯å¢ƒ</strong>ï¼šéœ€è¦ä¸€ä¸ªå·²å­˜åœ¨çš„Zabbix Serverï¼ˆæ”¯æŒ5.0ã€6.0ã€7.0ç­‰ä¸»æµç‰ˆæœ¬ï¼‰åŠå…¶ç®¡ç†å‘˜è´¦å·ã€‚</li>
</ul>
<h3 data-id="heading-3">éƒ¨ç½²æ­¥éª¤</h3>
<ol>
<li>
<p><strong>è·å–éƒ¨ç½²æ–‡ä»¶</strong>ï¼šé€šè¿‡Gitå…‹éš†é¡¹ç›®ä»“åº“ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">git <span class="hljs-built_in">clone</span> https://github.com/zlpu/zabbixwatch-demo.git
<span class="hljs-built_in">cd</span> zabbixwatch-demo/Install-zabbixwatch/docker-compose
</code></pre>
</li>
<li>
<p><strong>å¯åŠ¨æœåŠ¡</strong>ï¼šä½¿ç”¨ä¸€æ¡å‘½ä»¤å¯åŠ¨æ‰€æœ‰ç»„ä»¶ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">docker-compose up -d
</code></pre>
<p>æ‰§è¡Œåï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ‹‰å–é•œåƒå¹¶å¯åŠ¨ZabbixWatchçš„ç›¸å…³æœåŠ¡ã€‚</p>
</li>
<li>
<p><strong>éªŒè¯éƒ¨ç½²</strong>ï¼šå¯åŠ¨æˆåŠŸåï¼Œè®¿é—® <code>http://ä½ çš„æœåŠ¡å™¨IP:8088</code>ï¼Œå³å¯è¿›å…¥ç™»å½•ç•Œé¢ã€‚ä½¿ç”¨é»˜è®¤è´¦å·ï¼ˆ<code>admin</code> / <code>admin123</code>ï¼‰ç™»å½•ï¼Œ<strong>è¯·åŠ¡å¿…åœ¨é¦–æ¬¡ç™»å½•åç«‹å³ä¿®æ”¹å¯†ç </strong>ã€‚</p>
</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/95dbbccecfa348dfa8a0d026ef962e00~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWUxfamlh:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765759737&amp;x-signature=t0IBAM14nLTBu72Pz9%2F3ZukuVgU%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-4">ä¸‰ã€ä½¿ç”¨æ–¹æ³•ï¼šä»è¿æ¥åˆ°å®šåˆ¶åŒ–å¤§å±</h2>
<p>ZabbixWatchéµå¾ªâ€œé…ç½®-æŸ¥çœ‹-å®šåˆ¶â€çš„æ¸…æ™°ä½¿ç”¨è·¯å¾„ã€‚</p>
<h3 data-id="heading-5">1. æ ¸å¿ƒæ“ä½œæµç¨‹</h3>
<p>ä¸‹å›¾å±•ç¤ºäº†ä»ç³»ç»Ÿåˆå§‹åŒ–åˆ°åˆ›å»ºä¸ªæ€§åŒ–ç›‘æ§å¤§å±çš„å®Œæ•´å·¥ä½œæµï¼š</p>
<pre><code class="hljs language-css" lang="css">    <span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[é¦–æ¬¡ç™»å½•å¹¶ä¿®æ”¹å¯†ç ]</span> --&gt; <span class="hljs-selector-tag">B</span><span class="hljs-selector-attr">[é…ç½®Zabbixæ•°æ®æº]</span>
    <span class="hljs-selector-tag">B</span> --&gt; C<span class="hljs-selector-attr">[ä½¿ç”¨é»˜è®¤ç›‘æ§å¤§å±]</span>
    C --&gt; D{æ˜¯å¦æ»¡è¶³éœ€æ±‚?}
    D -- æ˜¯ --&gt; E<span class="hljs-selector-attr">[æ—¥å¸¸ç›‘æ§ä¸å‘Šè­¦å¤„ç†]</span>
    D -- å¦ --&gt; F<span class="hljs-selector-attr">[ä½¿ç”¨æ‹–æ‹½ç¼–è¾‘å™¨åˆ›å»ºæ–°å¤§å±]</span>
    F --&gt; G<span class="hljs-selector-attr">[é€‰æ‹©å›¾è¡¨ç»„ä»¶&lt;br&gt;ï¼ˆå¦‚æŠ˜çº¿å›¾ã€åœ°å›¾ã€çŠ¶æ€å›¾ï¼‰]</span>
    G --&gt; H<span class="hljs-selector-attr">[é…ç½®æ•°æ®æºä¸æŒ‡æ ‡]</span>
    H --&gt; <span class="hljs-selector-tag">I</span><span class="hljs-selector-attr">[è°ƒæ•´å¸ƒå±€ä¸æ ·å¼]</span>
    <span class="hljs-selector-tag">I</span> --&gt; J<span class="hljs-selector-attr">[ä¿å­˜å¹¶å‘å¸ƒå¤§å±]</span>
    J --&gt; E
</code></pre>
<h3 data-id="heading-6">2. å…³é”®åŠŸèƒ½è¯¦è§£</h3>
<ul>
<li><strong>é…ç½®æ•°æ®æº</strong>ï¼šç™»å½•åï¼Œåœ¨â€œç³»ç»Ÿè®¾ç½®â€ä¸­æ·»åŠ æ‚¨çš„Zabbix Serveråœ°å€ã€ç”¨æˆ·åå’Œå¯†ç ï¼Œç‚¹å‡»â€œæµ‹è¯•è¿æ¥â€é€šè¿‡åä¿å­˜å³å¯ã€‚è¿™æ˜¯æ‰€æœ‰åŠŸèƒ½çš„åŸºç¡€ã€‚</li>
<li><strong>æ¢ç´¢é¢„ç½®å¤§å±</strong>ï¼šåœ¨â€œç›‘æ§å¤§å±â€èœå•ä¸­ï¼Œç³»ç»Ÿæä¾›äº†é¢„ç½®çš„ç»¼åˆç›‘æ§è§†å›¾ï¼Œå¯ä»¥å¿«é€Ÿæ¦‚è§ˆæ•´ä½“çŠ¶æ€ã€‚</li>
<li><strong>Webç«™ç‚¹ç›‘æ§</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªç‰¹è‰²åŠŸèƒ½ï¼Œä¸“é—¨ç”¨äºé›†ä¸­ç›‘æ§å¤šä¸ªç½‘ç«™æˆ–APIæ¥å£çš„å¯ç”¨æ€§å’Œå“åº”æ—¶é—´ã€‚</li>
<li><strong>ç®¡ç†å‘Šè­¦ä¸AI</strong>ï¼šåœ¨â€œAI+å‘Šè­¦â€æ¨¡å—ï¼Œå¯ä»¥é…ç½®å‘Šè­¦é€šçŸ¥åˆ°é’‰é’‰ã€é£ä¹¦ç­‰å¹³å°ï¼Œå¹¶å¯ç”¨AIåˆ†æåŠŸèƒ½è¾…åŠ©æ’æŸ¥ã€‚</li>
<li><strong>å†å²æ•°æ®æŸ¥è¯¢</strong>ï¼šæ–¹ä¾¿æ‚¨å›æº¯ä»»æ„æ—¶é—´æ®µå†…ä»»æ„ç›‘æ§æŒ‡æ ‡çš„å˜åŒ–è¶‹åŠ¿ï¼Œç”¨äºæ•…éšœå¤ç›˜æˆ–å®¹é‡åˆ†æã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5457f3ef2d5b453f9d94a7cfaa89bcdd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWUxfamlh:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765759737&amp;x-signature=Zf%2F0CA8ADj1gb5IwA60Zni0S5xw%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/30b6a0b3edf646fcafd9f50079b605e0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWUxfamlh:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765759737&amp;x-signature=i%2F0cj8FKAsgWFT4%2B3hRU04KDSu0%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-7">å››ã€ä¼ä¸šå®æˆ˜æ¡ˆä¾‹ï¼šåˆ¶é€ ä¸šçš„æ™ºèƒ½è¿ç»´å‡çº§</h2>
<p><strong>èƒŒæ™¯</strong>ï¼šæŸå¤§å‹åˆ¶é€ ä¸šé›†å›¢ï¼ˆå¦‚æ–°é‡‘é’¢é“é›†å›¢ï¼‰åœ¨æ•°å­—åŒ–è½¬å‹ä¸­ï¼Œå…¶è‡ªåŠ¨åŒ–ä¿¡æ¯å®¤é¢ä¸´ç½‘ç»œæ¶æ„å¤æ‚ã€è®¾å¤‡ç¹å¤šã€æ•…éšœå®šä½éš¾çš„æŒ‘æˆ˜ã€‚ä¼ ç»Ÿè¿ç»´æ–¹å¼å“åº”æ…¢ï¼Œä¸šåŠ¡è¿ç»­æ€§é£é™©é«˜ã€‚</p>
<p><strong>æŒ‘æˆ˜</strong>ï¼š</p>
<ol>
<li>ç›‘æ§æ•°æ®åˆ†æ•£åœ¨Zabbixå„ä¸ªé¡µé¢ï¼Œæ— æ³•ä¸ºç®¡ç†å±‚æä¾›å…¨å±€è§†é‡ã€‚</li>
<li>å‡ºç°æ•…éšœæ—¶ï¼Œå‘Šè­¦ä¿¡æ¯ç¹æ‚ï¼Œéš¾ä»¥å¿«é€Ÿå®šä½æ ¹æœ¬åŸå› ã€‚</li>
<li>ç¼ºä¹ä¸€ä¸ªé›†ä¸­çš„ã€å¯è§†åŒ–çš„å¹³å°æ¥å‘éæŠ€æœ¯äººå‘˜ï¼ˆå¦‚ä¸šåŠ¡éƒ¨é—¨é¢†å¯¼ï¼‰å±•ç¤ºITç³»ç»Ÿå¥åº·åº¦ã€‚</li>
</ol>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š
è¯¥é›†å›¢åœ¨å·²æœ‰Zabbixç›‘æ§çš„åŸºç¡€ä¸Šï¼Œå¼•å…¥äº†ZabbixWatchã€‚</p>
<ol>
<li><strong>æ­å»ºè¿ç»´æŒ‡æŒ¥å¤§å±</strong>ï¼šä½¿ç”¨ZabbixWatchçš„æ‹–æ‹½ç¼–è¾‘å™¨ï¼Œå°†æ ¸å¿ƒçš„ç”Ÿäº§ç³»ç»Ÿã€ç½‘ç»œè®¾å¤‡ã€æ•°æ®åº“ç­‰å…³é”®æŒ‡æ ‡ï¼ˆå¦‚CPUã€äº¤æ˜“æˆåŠŸç‡ã€ç½‘ç»œå»¶è¿Ÿï¼‰é›†ä¸­åœ¨ä¸€ä¸ªå¤§å±ä¸Šï¼Œå®æ—¶å±•ç¤ºåœ¨è¿ç»´ä¸­å¿ƒã€‚</li>
<li><strong>å®ç°å¤šå±‚çº§ç›‘æ§</strong>ï¼šåˆ©ç”¨å¤šæ•°æ®æºåŠŸèƒ½ï¼Œå°†é›†å›¢æ€»éƒ¨ä¸å„åˆ†å‚çš„Zabbixç›‘æ§æ•°æ®ç»Ÿä¸€æ¥å…¥ï¼Œå®ç°é›†å›¢çº§çš„ä¸€ä½“åŒ–ç›‘æ§è§†å›¾ã€‚</li>
<li><strong>é›†æˆæ™ºèƒ½å‘Šè­¦</strong>ï¼šé…ç½®å‘Šè­¦æ¨é€è‡³è¿ç»´å›¢é˜Ÿçš„é’‰é’‰ç¾¤ã€‚å½“å‡ºç°ç½‘ç»œä¸­æ–­æ—¶ï¼Œä¸ä»…æ”¶åˆ°å‘Šè­¦ï¼Œè¿˜èƒ½é€šè¿‡é›†æˆçš„AIåŠŸèƒ½ï¼Œåˆæ­¥åˆ†æå‡ºå¯èƒ½æ˜¯æŸä¸ªæ ¸å¿ƒäº¤æ¢æœºç«¯å£å¼‚å¸¸ï¼Œå¹¶ç»™å‡ºå†å²æ•°æ®å¯¹æ¯”ï¼Œæå¤§ç¼©çŸ­äº†MTTRï¼ˆå¹³å‡ä¿®å¤æ—¶é—´ï¼‰ã€‚</li>
</ol>
<p><strong>æˆæ•ˆ</strong>ï¼š</p>
<ul>
<li><strong>å†³ç­–æ•ˆç‡æå‡</strong>ï¼šç®¡ç†å±‚é€šè¿‡å¤§å±å®æ—¶æŒæ¡ITå…¨å±€çŠ¶æ€ï¼Œå†³ç­–ä»â€œç›²äººæ‘¸è±¡â€å˜ä¸ºâ€œä¸€ç›®äº†ç„¶â€ã€‚</li>
<li><strong>æ•…éšœå®šä½æé€Ÿ</strong>ï¼šé€šè¿‡å¯è§†åŒ–æ•…éšœå½±å“é¢å’ŒAIè¾…åŠ©åˆ†æï¼Œå¹³å‡æ•…éšœå®šä½æ—¶é—´ä»æ•°å°æ—¶ç¼©çŸ­åˆ°å‡ åˆ†é’Ÿå†…ã€‚</li>
<li><strong>èµ„æºä¼˜åŒ–</strong>ï¼šé€šè¿‡å†å²è¶‹åŠ¿åˆ†æï¼Œç²¾å‡†é¢„æµ‹èµ„æºç“¶é¢ˆï¼Œé¿å…äº†ä¸å¿…è¦çš„ç¡¬ä»¶æ‰©å®¹æŠ•èµ„ã€‚</li>
</ul>
<h2 data-id="heading-8">äº”ã€æ€»ç»“ä¸å±•æœ›</h2>
<p>ZabbixWatchå¹¶éè¦æ›¿ä»£Zabbixï¼Œè€Œæ˜¯ä½œä¸ºå…¶å¼ºå¤§çš„â€œè§†è§‰å¢å¼ºå¥—ä»¶â€ã€‚å®ƒå®Œç¾å¼¥è¡¥äº†Zabbixåœ¨æ•°æ®å¯è§†åŒ–å‘ˆç°å’Œç”¨æˆ·ä½“éªŒæ–¹é¢çš„çŸ­æ¿ï¼Œç‰¹åˆ«é€‚åˆä»¥ä¸‹åœºæ™¯ï¼š</p>
<ul>
<li><strong>è¿ç»´å›¢é˜Ÿ</strong>ï¼šéœ€è¦7x24å°æ—¶æ¸…æ™°æŒæ§ç³»ç»ŸçŠ¶æ€ã€‚</li>
<li><strong>NOCä¸­å¿ƒ</strong>ï¼šéœ€è¦å¤§å±å¹•è¿›è¡Œå…¨å±€ç›‘æ§å’Œå±•ç¤ºã€‚</li>
<li><strong>ç®¡ç†è€…</strong>ï¼šéœ€è¦ç›´è§‚çš„ITå¥åº·åº¦æŠ¥å‘Šï¼Œæ”¯æ’‘ä¸šåŠ¡å†³ç­–ã€‚</li>
<li><strong>å¤šåˆ†æ”¯æœºæ„ä¼ä¸š</strong>ï¼šéœ€è¦é›†ä¸­åŒ–ã€æ ‡å‡†åŒ–çš„ç›‘æ§è§†å›¾ã€‚</li>
</ul>
<p>å…¶<strong>å¼€æºå…è´¹ã€éƒ¨ç½²ç®€å•ã€é…ç½®çµæ´»</strong>çš„ç‰¹ç‚¹ï¼Œä½¿å¾—æ— è®ºä¸­å°ä¼ä¸šè¿˜æ˜¯å¤§å‹é›†å›¢ï¼Œéƒ½èƒ½ä»¥æä½çš„æˆæœ¬è·å¾—ä¼ä¸šçº§çš„ç›‘æ§å¯è§†åŒ–èƒ½åŠ›ã€‚éšç€AIæŠ€æœ¯çš„ä¸æ–­é›†æˆï¼Œæœªæ¥çš„ç›‘æ§å°†æ›´åŠ æ™ºèƒ½ï¼Œè€ŒZabbixWatchæ— ç–‘å·²ç»ç«™åœ¨äº†è¿™ä¸ªæ¼”è¿›æ–¹å‘çš„å‰æ²¿ã€‚</p>
<blockquote>
<p><strong>é¡¹ç›®åœ°å€</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fzlpu%2Fzabbixwatch-demo" target="_blank" title="https://github.com/zlpu/zabbixwatch-demo" ref="nofollow noopener noreferrer">GitHub</a> | <a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Froot-pu%2Fzabbixwatch-demo" target="_blank" title="https://gitee.com/root-pu/zabbixwatch-demo" ref="nofollow noopener noreferrer">Gitee</a>
ç«‹å³å°è¯•ï¼Œè®©æ‚¨çš„Zabbixç›‘æ§æ•°æ®â€œæ´»â€èµ·æ¥ï¼Œå¼€å¯è¿ç»´å¯è§†åŒ–çš„æ–°ç¯‡ç« ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RabbitMQ çš„ 6 ç§å·¥ä½œæ¨¡å¼ä½ éƒ½æŒæ¡äº†å—ï¼Ÿé™„å®Œæ•´å¯è¿è¡Œä»£ç ]]></title>    <link>https://juejin.cn/post/7580735683939975202</link>    <guid>https://juejin.cn/post/7580735683939975202</guid>    <pubDate>2025-12-08T00:48:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580735683939975202" data-draft-id="7572961448537112603" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RabbitMQ çš„ 6 ç§å·¥ä½œæ¨¡å¼ä½ éƒ½æŒæ¡äº†å—ï¼Ÿé™„å®Œæ•´å¯è¿è¡Œä»£ç "/> <meta itemprop="keywords" content="åç«¯,Java,RabbitMQ"/> <meta itemprop="datePublished" content="2025-12-08T00:48:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åˆ˜å¤§å"/> <meta itemprop="url" content="https://juejin.cn/user/3507878440995946"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RabbitMQ çš„ 6 ç§å·¥ä½œæ¨¡å¼ä½ éƒ½æŒæ¡äº†å—ï¼Ÿé™„å®Œæ•´å¯è¿è¡Œä»£ç 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3507878440995946/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åˆ˜å¤§å
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T00:48:36.000Z" title="Mon Dec 08 2025 00:48:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¾ˆå¤šäººåˆšå¼€å§‹ç”¨ RabbitMQ æ—¶ï¼Œè§‰å¾—å®ƒå°±æ˜¯ä¸€ä¸ªâ€œç”Ÿäº§è€…å‘æ¶ˆæ¯ã€æ¶ˆè´¹è€…æ”¶æ¶ˆæ¯â€çš„å·¥å…·ã€‚</p>
<p>ä½†å…¶å®ï¼ŒRabbitMQ çš„çœŸæ­£å¼ºå¤§ä¹‹å¤„ï¼Œåœ¨äºå®ƒèƒ½é€šè¿‡ä¸åŒçš„ <strong>äº¤æ¢æœºç±»å‹</strong> å’Œ <strong>ç»‘å®šè§„åˆ™</strong>ï¼Œçµæ´»æ”¯æŒå¤šç§é€šä¿¡æ–¹å¼ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<ul>
<li>æƒ³è®©å¤šä¸ªæœåŠ¡åŒæ—¶æ”¶åˆ°åŒä¸€æ¡é€šçŸ¥ï¼Ÿå¯ä»¥ç”¨ <strong>å¹¿æ’­æ¨¡å¼ï¼ˆFanoutï¼‰</strong>ã€‚</li>
<li>æƒ³æŒ‰æ¶ˆæ¯ç±»å‹åˆ†åˆ«å¤„ç†æ—¥å¿—ï¼Ÿå¯ä»¥ç”¨ <strong>è·¯ç”±æ¨¡å¼ï¼ˆDirectï¼‰</strong>ã€‚</li>
<li>æƒ³ç›‘å¬æ‰€æœ‰è®¢å•ç›¸å…³çš„äº‹ä»¶ï¼Ÿ<strong>ä¸»é¢˜æ¨¡å¼ï¼ˆTopicï¼‰</strong> å°±å¾ˆåˆé€‚ã€‚</li>
</ul>
<p>è¿™äº›ä¸åŒçš„ç”¨æ³•ï¼Œè¢«æ€»ç»“ä¸º <strong>RabbitMQ çš„å…­å¤§ç»å…¸å·¥ä½œæ¨¡å¼</strong>ã€‚</p>
<p>æŒæ¡å®ƒä»¬ï¼Œä½ å°±èƒ½æ ¹æ®ä¸šåŠ¡éœ€æ±‚ï¼Œè®¾è®¡å‡ºæ›´åˆç†ã€æ›´é«˜æ•ˆçš„æ¶ˆæ¯æ¶æ„ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®Œæ•´çš„SpringBooté¡¹ç›®å’Œç¤ºä¾‹æ¥åšä¸€ä¸ªå…¨é¢çš„äº†è§£ã€‚è®©ä½ çœ‹å¾—æ‡‚ã€è·‘å¾—é€šã€ä¹Ÿèƒ½ç”¨å¾—ä¸Šï¼</p>
<h3 data-id="heading-0">é¡¹ç›®ç»“æ„å»ºè®®ï¼ˆä¾¿äºç»„ç»‡ï¼‰</h3>
<pre><code class="hljs language-lua" lang="lua">src/main/java/com/example/rabbitdemo/
â”œâ”€â”€ <span class="hljs-built_in">config</span>/ <span class="hljs-comment">-- é…ç½®ç±»</span>
â”‚   â”œâ”€â”€ SimpleConfig.java
â”‚   â”œâ”€â”€ WorkQueueConfig.java
â”‚   â”œâ”€â”€ FanoutConfig.java
â”‚   â”œâ”€â”€ DirectConfig.java
â”‚   â”œâ”€â”€ TopicConfig.java
â”‚   â””â”€â”€ RpcConfig.java
â”œâ”€â”€ producer/ <span class="hljs-comment">--ç”Ÿäº§è€…</span>
â”‚   â”œâ”€â”€ SimpleProducer.java
â”‚   â”œâ”€â”€ WorkProducer.java
â”‚   â”œâ”€â”€ FanoutProducer.java
â”‚   â”œâ”€â”€ DirectProducer.java
â”‚   â”œâ”€â”€ TopicProducer.java
â”‚   â””â”€â”€ RpcClient.java
â”œâ”€â”€ consumer/ <span class="hljs-comment">-- æ¶ˆè´¹è€…</span>
â”‚   â”œâ”€â”€ SimpleConsumer.java
â”‚   â”œâ”€â”€ WorkConsumer1.java
â”‚   â”œâ”€â”€ WorkConsumer2.java
â”‚   â”œâ”€â”€ FanoutConsumerA.java
â”‚   â”œâ”€â”€ FanoutConsumerB.java
â”‚   â”œâ”€â”€ DirectErrorConsumer.java
â”‚   â”œâ”€â”€ DirectInfoConsumer.java
â”‚   â”œâ”€â”€ TopicOrderConsumer.java
â”‚   â”œâ”€â”€ TopicLogConsumer.java
â”‚   â””â”€â”€ RpcServer.java
â”œâ”€â”€ controller/
â”‚   â”œâ”€â”€ TestController.java  // èšåˆæ‰€æœ‰æµ‹è¯•æ¥å£
â””â”€â”€ RabbitDemoApplication.java
</code></pre>
<hr/>
<h3 data-id="heading-1">1. å¯åŠ¨ç±»ï¼ˆ<code>RabbitDemoApplication.java</code>ï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.rabbitdemo;

<span class="hljs-keyword">import</span> org.springframework.boot.SpringApplication;
<span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;

<span class="hljs-meta">@SpringBootApplication</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RabbitDemoApplication</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        SpringApplication.run(RabbitDemoApplication.class, args);
    }
}
</code></pre>
<blockquote>
<p>è¿™æ˜¯æ ‡å‡† Spring Boot å¯åŠ¨ç±»ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-2">Maven ä¾èµ–ï¼ˆ<code>pom.xml</code>ï¼‰â€”â€”å®Œæ•´ç‰ˆ</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span>
         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0
         https://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.2.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.example<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>rabbit-demo<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>rabbit-demo<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">java.version</span>&gt;</span>17<span class="hljs-tag">&lt;/<span class="hljs-name">java.version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span>
</code></pre>
<hr/>
<h3 data-id="heading-3">é…ç½®æ–‡ä»¶ï¼ˆ<code>application.yml</code>ï¼‰</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">server:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span>

<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">rabbitmq:</span>
    <span class="hljs-attr">host:</span> <span class="hljs-string">localhost</span>
    <span class="hljs-attr">port:</span> <span class="hljs-number">5672</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">guest</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">guest</span>
    <span class="hljs-attr">virtual-host:</span> <span class="hljs-string">/</span>
    <span class="hljs-attr">listener:</span>
      <span class="hljs-attr">simple:</span>
        <span class="hljs-comment"># æ‰‹åŠ¨ ACK ç¤ºä¾‹ï¼ˆå·¥ä½œé˜Ÿåˆ—ä¸­ç”¨åˆ°ï¼‰</span>
        <span class="hljs-attr">acknowledge-mode:</span> <span class="hljs-string">auto</span>  <span class="hljs-comment"># é»˜è®¤ autoï¼Œå¦‚éœ€æ‰‹åŠ¨æ”¹ä¸º manual</span>
        <span class="hljs-attr">prefetch:</span> <span class="hljs-number">1</span>             <span class="hljs-comment"># é…åˆ manual ä½¿ç”¨ï¼Œä¸€æ¬¡åªå–1æ¡</span>
</code></pre>
<hr/>
<h2 data-id="heading-4">å…­å¤§æ¨¡å¼å®Œæ•´å®ç°</h2>
<hr/>
<h3 data-id="heading-5">ä¸€ã€ç®€å•æ¨¡å¼ï¼ˆSimpleï¼‰</h3>
<p>ä¸€ä¸ªç”Ÿäº§è€… â†’ ä¸€ä¸ªé˜Ÿåˆ— â†’ ä¸€ä¸ªæ¶ˆè´¹è€…</p>
<h4 data-id="heading-6">config/SimpleConfig.javaï¼ˆé…ç½®ç±»ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.rabbitdemo.config;

<span class="hljs-keyword">import</span> org.springframework.amqp.core.Queue;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;

<span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleConfig</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">SIMPLE_QUEUE</span> <span class="hljs-operator">=</span> <span class="hljs-string">"simple.queue"</span>;

    <span class="hljs-comment">// åˆ›å»ºé˜Ÿåˆ—</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Queue <span class="hljs-title function_">simpleQueue</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// å‚æ•°ï¼šé˜Ÿåˆ—åï¼Œæ˜¯å¦æŒä¹…åŒ–ï¼ˆtrue=é‡å¯åä¿ç•™ï¼‰ï¼Œæ˜¯å¦æ’ä»–ï¼Œæ˜¯å¦è‡ªåŠ¨åˆ é™¤</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Queue</span>(SIMPLE_QUEUE, <span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>);
    }
}
</code></pre>
<ul>
<li><code>@Configuration</code>ï¼šæ ‡è®°ç±»ä¸ºé…ç½®ç±»ï¼ŒSpringåœ¨å¯åŠ¨æ—¶ä¼šå¤„ç†å…¶ä¸­çš„Beanå®šä¹‰</li>
<li><code>@Bean</code>ï¼šå£°æ˜æ–¹æ³•è¿”å›çš„å¯¹è±¡åº”è¯¥è¢«æ³¨å†Œä¸ºSpringåº”ç”¨ä¸Šä¸‹æ–‡ä¸­çš„Bean</li>
</ul>
<h4 data-id="heading-7">producer/SimpleProducer.javaï¼ˆç”Ÿäº§è€…ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.rabbitdemo.producer;

<span class="hljs-keyword">import</span> com.example.rabbitdemo.config.SimpleConfig;
<span class="hljs-keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Service;

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleProducer</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RabbitTemplate rabbitTemplate;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">send</span><span class="hljs-params">(String message)</span> {
        <span class="hljs-comment">// å‘é€åˆ°é»˜è®¤äº¤æ¢æœºï¼ŒroutingKey ä¸ºé˜Ÿåˆ—å</span>
        rabbitTemplate.convertAndSend(SimpleConfig.SIMPLE_QUEUE, message);
    }
}
</code></pre>
<h4 data-id="heading-8">consumer/SimpleConsumer.javaï¼ˆæ¶ˆè´¹è€…ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.rabbitdemo.consumer;

<span class="hljs-keyword">import</span> com.example.rabbitdemo.config.SimpleConfig;
<span class="hljs-keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;

<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleConsumer</span> {

    <span class="hljs-meta">@RabbitListener(queues = SimpleConfig.SIMPLE_QUEUE)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">receive</span><span class="hljs-params">(String message)</span> {
        System.out.println(<span class="hljs-string">"ã€ç®€å•æ¨¡å¼ã€‘æ”¶åˆ°æ¶ˆæ¯: "</span> + message);
    }
}
</code></pre>
<h4 data-id="heading-9">é€‚ç”¨åœºæ™¯</h4>
<ul>
<li>æœ€åŸºç¡€çš„å¼‚æ­¥ä»»åŠ¡ï¼Œæ¯”å¦‚å‘é€æ¬¢è¿é‚®ä»¶ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-10">äºŒã€å·¥ä½œé˜Ÿåˆ—æ¨¡å¼ï¼ˆWork Queueï¼‰</h3>
<ul>
<li>ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå¤šä¸ªæ¶ˆè´¹è€…ç«äº‰æ¶ˆè´¹ï¼ˆé»˜è®¤è½®è¯¢ï¼‰</li>
<li>é€‚ç”¨äºä»»åŠ¡åˆ†å‘ã€è€—æ—¶ä»»åŠ¡å¼‚æ­¥å¤„ç†</li>
</ul>
<p>æ³¨æ„ï¼šSpringBoot é»˜è®¤æ˜¯è‡ªåŠ¨ ACKï¼Œå»ºè®®æ”¹ä¸ºæ‰‹åŠ¨ ACK é˜²æ­¢æ¶ˆæ¯ä¸¢å¤±ã€‚</p>
<h4 data-id="heading-11">config/WorkQueueConfig.javaï¼ˆé…ç½®ç±»ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.rabbitdemo.config;

<span class="hljs-keyword">import</span> org.springframework.amqp.core.Queue;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;

<span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WorkQueueConfig</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">WORK_QUEUE</span> <span class="hljs-operator">=</span> <span class="hljs-string">"work.queue"</span>;

        <span class="hljs-comment">// åˆ›å»ºé˜Ÿåˆ—</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Queue <span class="hljs-title function_">workQueue</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Queue</span>(WORK_QUEUE, <span class="hljs-literal">true</span>);
    }
}
</code></pre>
<h4 data-id="heading-12">producer/WorkProducer.javaï¼ˆç”Ÿäº§è€…ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.rabbitdemo.producer;

<span class="hljs-keyword">import</span> com.example.rabbitdemo.config.WorkQueueConfig;
<span class="hljs-keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Service;

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WorkProducer</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RabbitTemplate rabbitTemplate;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">send</span><span class="hljs-params">(String message)</span> {
        rabbitTemplate.convertAndSend(WorkQueueConfig.WORK_QUEUE, message);
    }
}
</code></pre>
<h4 data-id="heading-13">consumer/WorkConsumer1.javaï¼ˆæ¶ˆè´¹è€…1ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.rabbitdemo.consumer;

<span class="hljs-keyword">import</span> com.example.rabbitdemo.config.WorkQueueConfig;
<span class="hljs-keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;

<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WorkConsumer1</span> {

    <span class="hljs-meta">@RabbitListener(queues = WorkQueueConfig.WORK_QUEUE)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">receive</span><span class="hljs-params">(String message)</span> <span class="hljs-keyword">throws</span> InterruptedException {
        System.out.println(<span class="hljs-string">"ã€Worker1ã€‘å¤„ç†ä»»åŠ¡: "</span> + message);
        Thread.sleep(<span class="hljs-number">1000</span>); <span class="hljs-comment">// æ¨¡æ‹Ÿè€—æ—¶</span>
    }
}
</code></pre>
<h4 data-id="heading-14">consumer/WorkConsumer2.javaï¼ˆæ¶ˆè´¹è€…2ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.rabbitdemo.consumer;

<span class="hljs-keyword">import</span> com.example.rabbitdemo.config.WorkQueueConfig;
<span class="hljs-keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;

<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WorkConsumer2</span> {

    <span class="hljs-meta">@RabbitListener(queues = WorkQueueConfig.WORK_QUEUE)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">receive</span><span class="hljs-params">(String message)</span> <span class="hljs-keyword">throws</span> InterruptedException {
        System.out.println(<span class="hljs-string">"ã€Worker2ã€‘å¤„ç†ä»»åŠ¡: "</span> + message);
        Thread.sleep(<span class="hljs-number">1000</span>);
    }
}
</code></pre>
<h4 data-id="heading-15">å·¥ä½œé˜Ÿåˆ—ç‰¹ç‚¹</h4>
<ul>
<li>å¤šä¸ªæ¶ˆè´¹è€…å…±äº«åŒä¸€ä¸ªé˜Ÿåˆ—</li>
<li>RabbitMQä½¿ç”¨è½®è¯¢æ–¹å¼åˆ†å‘æ¶ˆæ¯</li>
<li>æ¯ä¸ªæ¶ˆæ¯åªè¢«ä¸€ä¸ªæ¶ˆè´¹è€…å¤„ç†</li>
<li>é€‚åˆä»»åŠ¡åˆ†å‘å’Œè´Ÿè½½å‡è¡¡</li>
</ul>
<hr/>
<h3 data-id="heading-16">ä¸‰ã€å‘å¸ƒ/è®¢é˜…æ¨¡å¼ï¼ˆFanoutï¼‰</h3>
<ul>
<li>ä¸€ä¸ªç”Ÿäº§è€… â†’ Fanout äº¤æ¢æœº â†’ å¤šä¸ªé˜Ÿåˆ— â†’ å¤šä¸ªæ¶ˆè´¹è€…ï¼ˆå¹¿æ’­ï¼‰</li>
<li>æ‰€æœ‰ç»‘å®šåˆ°è¯¥äº¤æ¢æœºçš„é˜Ÿåˆ—éƒ½ä¼šæ”¶åˆ°æ¶ˆæ¯</li>
</ul>
<h4 data-id="heading-17">config/FanoutConfig.javaï¼ˆé…ç½®ç±»ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.rabbitdemo.config;

<span class="hljs-keyword">import</span> org.springframework.amqp.core.Binding;
<span class="hljs-keyword">import</span> org.springframework.amqp.core.BindingBuilder;
<span class="hljs-keyword">import</span> org.springframework.amqp.core.FanoutExchange;
<span class="hljs-keyword">import</span> org.springframework.amqp.core.Queue;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;

<span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FanoutConfig</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">FANOUT_EXCHANGE</span> <span class="hljs-operator">=</span> <span class="hljs-string">"fanout.exchange"</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">FANOUT_QUEUE_A</span> <span class="hljs-operator">=</span> <span class="hljs-string">"fanout.queue.a"</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">FANOUT_QUEUE_B</span> <span class="hljs-operator">=</span> <span class="hljs-string">"fanout.queue.b"</span>;

        <span class="hljs-comment">/**
     * è¿™é‡Œåˆ›å»ºçš„æ˜¯Fanoutç±»å‹çš„äº¤æ¢å™¨
     * Fanoutç‰¹ç‚¹ï¼šå¹¿æ’­æ¨¡å¼ï¼Œæ¶ˆæ¯ä¼šå‘é€åˆ°æ‰€æœ‰ç»‘å®šçš„é˜Ÿåˆ—
     */</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> FanoutExchange <span class="hljs-title function_">fanoutExchange</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FanoutExchange</span>(FANOUT_EXCHANGE);
    }

        <span class="hljs-comment">// åˆ›å»ºé˜Ÿåˆ—A</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Queue <span class="hljs-title function_">fanoutQueueA</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Queue</span>(FANOUT_QUEUE_A);
    }

        <span class="hljs-comment">// åˆ›å»ºé˜Ÿåˆ—B</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Queue <span class="hljs-title function_">fanoutQueueB</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Queue</span>(FANOUT_QUEUE_B);
    }

        <span class="hljs-comment">/**
     * å°†é˜Ÿåˆ—Aç»‘å®šåˆ°äº¤æ¢å™¨
     * ç»‘å®šåï¼Œå‘é€åˆ°fanout.exchangeçš„æ¶ˆæ¯éƒ½ä¼šè¿›å…¥é˜Ÿåˆ—A
     */</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Binding <span class="hljs-title function_">bindingA</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> BindingBuilder.bind(fanoutQueueA()).to(fanoutExchange());
    }

        <span class="hljs-comment">/**
     * å°†é˜Ÿåˆ—Bç»‘å®šåˆ°äº¤æ¢å™¨
     * ç»‘å®šåï¼Œå‘é€åˆ°fanout.exchangeçš„æ¶ˆæ¯éƒ½ä¼šè¿›å…¥é˜Ÿåˆ—B
     */</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Binding <span class="hljs-title function_">bindingB</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> BindingBuilder.bind(fanoutQueueB()).to(fanoutExchange());
    }
}
</code></pre>
<p>å·¥ä½œæµç¨‹ç¤ºæ„å›¾</p>
<pre><code class="hljs language-css" lang="css">ç”Ÿäº§è€…å‘é€æ¶ˆæ¯åˆ°äº¤æ¢å™¨
        â†“
<span class="hljs-selector-attr">[fanout.exchange]</span>  â† å¹¿æ’­äº¤æ¢å™¨
    â†“        â†“
é˜Ÿåˆ—<span class="hljs-selector-tag">A</span>æ”¶åˆ°æ¶ˆæ¯   é˜Ÿåˆ—<span class="hljs-selector-tag">B</span>æ”¶åˆ°æ¶ˆæ¯
    â†“        â†“
æ¶ˆè´¹è€…<span class="hljs-selector-tag">A</span>å¤„ç†    æ¶ˆè´¹è€…<span class="hljs-selector-tag">B</span>å¤„ç†
</code></pre>
<h4 data-id="heading-18">producer/FanoutProducer.javaï¼ˆç”Ÿäº§è€…ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.rabbitdemo.producer;

<span class="hljs-keyword">import</span> com.example.rabbitdemo.config.FanoutConfig;
<span class="hljs-keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Service;

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FanoutProducer</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RabbitTemplate rabbitTemplate;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">send</span><span class="hljs-params">(String message)</span> {
        <span class="hljs-comment">// Fanout äº¤æ¢æœºå¿½ç•¥ routingKeyï¼Œæ‰€ä»¥ä¼ ç©ºå­—ç¬¦ä¸²</span>
        rabbitTemplate.convertAndSend(FanoutConfig.FANOUT_EXCHANGE, <span class="hljs-string">""</span>, message);
    }
}
</code></pre>
<h4 data-id="heading-19">consumer/FanoutConsumerA.javaï¼ˆæ¶ˆè´¹è€…Aï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.rabbitdemo.consumer;

<span class="hljs-keyword">import</span> com.example.rabbitdemo.config.FanoutConfig;
<span class="hljs-keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;

<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FanoutConsumerA</span> {

    <span class="hljs-meta">@RabbitListener(queues = FanoutConfig.FANOUT_QUEUE_A)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">receive</span><span class="hljs-params">(String message)</span> {
        System.out.println(<span class="hljs-string">"ã€Fanout Aã€‘æ”¶åˆ°å¹¿æ’­: "</span> + message);
    }
}
</code></pre>
<h4 data-id="heading-20">consumer/FanoutConsumerB.javaï¼ˆæ¶ˆè´¹è€…Bï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.rabbitdemo.consumer;

<span class="hljs-keyword">import</span> com.example.rabbitdemo.config.FanoutConfig;
<span class="hljs-keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;

<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FanoutConsumerB</span> {

    <span class="hljs-meta">@RabbitListener(queues = FanoutConfig.FANOUT_QUEUE_B)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">receive</span><span class="hljs-params">(String message)</span> {
        System.out.println(<span class="hljs-string">"ã€Fanout Bã€‘æ”¶åˆ°å¹¿æ’­: "</span> + message);
    }
}
</code></pre>
<p><code>FanoutExchange</code> ç‰¹ç‚¹</p>
<ul>
<li><strong>å¹¿æ’­æœºåˆ¶</strong>ï¼šæ¶ˆæ¯å‘é€åˆ°æ‰€æœ‰ç»‘å®šçš„é˜Ÿåˆ—</li>
<li><strong>å¿½ç•¥routingKey</strong>ï¼šæ— è®ºroutingKeyæ˜¯ä»€ä¹ˆï¼Œæ‰€æœ‰é˜Ÿåˆ—éƒ½ä¼šæ”¶åˆ°æ¶ˆæ¯</li>
<li><strong>ä¸€å¯¹å¤šé€šä¿¡</strong>ï¼šé€‚åˆæ¶ˆæ¯å¹¿æ’­åœºæ™¯</li>
</ul>
<p>å½“ä½ è°ƒç”¨ç”Ÿäº§è€…æ—¶ï¼Œæ¶ˆè´¹è€…Aå’ŒBéƒ½ä¼šåŒæ—¶æ”¶åˆ°æ¶ˆæ¯ã€‚</p>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šç¾¤å‘é€šçŸ¥ï¼Œæ¯”å¦‚ç”¨æˆ·æ³¨å†ŒååŒæ—¶å‘é‚®ä»¶ã€çŸ­ä¿¡ã€ç«™å†…ä¿¡ã€‚</p>
<hr/>
<h3 data-id="heading-21">å››ã€è·¯ç”±æ¨¡å¼ï¼ˆDirectï¼‰</h3>
<p>æ ¹æ® routing key ç²¾ç¡®åŒ¹é…è·¯ç”±åˆ°æŒ‡å®šé˜Ÿåˆ—</p>
<h4 data-id="heading-22">config/DirectConfig.javaï¼ˆé…ç½®ç±»ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.rabbitdemo.config;

<span class="hljs-keyword">import</span> org.springframework.amqp.core.Binding;
<span class="hljs-keyword">import</span> org.springframework.amqp.core.BindingBuilder;
<span class="hljs-keyword">import</span> org.springframework.amqp.core.DirectExchange;
<span class="hljs-keyword">import</span> org.springframework.amqp.core.Queue;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;

<span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DirectConfig</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">DIRECT_EXCHANGE</span> <span class="hljs-operator">=</span> <span class="hljs-string">"direct.exchange"</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">DIRECT_QUEUE_ERROR</span> <span class="hljs-operator">=</span> <span class="hljs-string">"direct.queue.error"</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">DIRECT_QUEUE_INFO</span> <span class="hljs-operator">=</span> <span class="hljs-string">"direct.queue.info"</span>;

        <span class="hljs-comment">// åˆ›å»ºDirectç±»å‹çš„äº¤æ¢å™¨</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> DirectExchange <span class="hljs-title function_">directExchange</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DirectExchange</span>(DIRECT_EXCHANGE);
    }
        
    <span class="hljs-comment">// åˆ›å»ºé”™è¯¯æ—¥å¿—é˜Ÿåˆ—</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Queue <span class="hljs-title function_">errorQueue</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Queue</span>(DIRECT_QUEUE_ERROR);
    }

        <span class="hljs-comment">// åˆ›å»ºä¿¡æ¯æ—¥å¿—é˜Ÿåˆ—</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Queue <span class="hljs-title function_">infoQueue</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Queue</span>(DIRECT_QUEUE_INFO);
    }

        <span class="hljs-comment">/**
     * å…³é”®ç»‘å®šï¼šé”™è¯¯é˜Ÿåˆ— â†[routingKey="error"]â€” äº¤æ¢å™¨
     * å«ä¹‰ï¼šåªæœ‰routingKeyä¸º"error"çš„æ¶ˆæ¯æ‰ä¼šè¿›å…¥é”™è¯¯é˜Ÿåˆ—
     */</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Binding <span class="hljs-title function_">errorBinding</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ç»‘å®šï¼šé˜Ÿåˆ— â†[routingKey="error"]â€” äº¤æ¢æœº</span>
        <span class="hljs-keyword">return</span> BindingBuilder.bind(errorQueue()).to(directExchange()).with(<span class="hljs-string">"error"</span>);
    }

        <span class="hljs-comment">/**
     * ç»‘å®šï¼šä¿¡æ¯é˜Ÿåˆ— â†[routingKey="info"]â€” äº¤æ¢å™¨
     * å«ä¹‰ï¼šåªæœ‰routingKeyä¸º"info"çš„æ¶ˆæ¯æ‰ä¼šè¿›å…¥ä¿¡æ¯é˜Ÿåˆ—
     */</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Binding <span class="hljs-title function_">infoBinding</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> BindingBuilder.bind(infoQueue()).to(directExchange()).with(<span class="hljs-string">"info"</span>);
    }
}
</code></pre>
<p>ç»‘å®šå…³ç³»ç¤ºæ„å›¾ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">direct.exchangeï¼ˆäº¤æ¢å™¨ï¼‰
    â†“
    |-- <span class="hljs-attr">routingKey</span>=<span class="hljs-string">"error"</span> â†’ direct.queue.errorï¼ˆé”™è¯¯é˜Ÿåˆ—ï¼‰
    |-- <span class="hljs-attr">routingKey</span>=<span class="hljs-string">"info"</span>  â†’ direct.queue.infoï¼ˆä¿¡æ¯é˜Ÿåˆ—ï¼‰
</code></pre>
<h4 data-id="heading-23">producer/DirectProducer.javaï¼ˆç”Ÿäº§è€…ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.rabbitdemo.producer;

<span class="hljs-keyword">import</span> com.example.rabbitdemo.config.DirectConfig;
<span class="hljs-keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Service;

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DirectProducer</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RabbitTemplate rabbitTemplate;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">send</span><span class="hljs-params">(String routingKey, String message)</span> {
        rabbitTemplate.convertAndSend(DirectConfig.DIRECT_EXCHANGE, routingKey, message);
    }
}
</code></pre>
<h4 data-id="heading-24">consumer/DirectErrorConsumer.javaï¼ˆæ¶ˆè´¹è€…ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.rabbitdemo.consumer;

<span class="hljs-keyword">import</span> com.example.rabbitdemo.config.DirectConfig;
<span class="hljs-keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;

<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DirectErrorConsumer</span> {

    <span class="hljs-meta">@RabbitListener(queues = DirectConfig.DIRECT_QUEUE_ERROR)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">receive</span><span class="hljs-params">(String message)</span> {
        System.out.println(<span class="hljs-string">"ã€ERRORã€‘æ—¥å¿—: "</span> + message);
    }
}
</code></pre>
<h4 data-id="heading-25">consumer/DirectInfoConsumer.javaï¼ˆæ¶ˆè´¹è€…ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.rabbitdemo.consumer;

<span class="hljs-keyword">import</span> com.example.rabbitdemo.config.DirectConfig;
<span class="hljs-keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;

<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DirectInfoConsumer</span> {

    <span class="hljs-meta">@RabbitListener(queues = DirectConfig.DIRECT_QUEUE_INFO)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">receive</span><span class="hljs-params">(String message)</span> {
        System.out.println(<span class="hljs-string">"ã€INFOã€‘æ—¥å¿—: "</span> + message);
    }
}
</code></pre>
<h4 data-id="heading-26">æµ‹è¯•åœºæ™¯</h4>
<p><strong>åœºæ™¯1ï¼šå‘é€é”™è¯¯æ—¥å¿—</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è°ƒç”¨ï¼šPOST /send-log?level=error&amp;content=æ•°æ®åº“è¿æ¥å¤±è´¥</span>
directProducer.send(<span class="hljs-string">"error"</span>, <span class="hljs-string">"[error] æ•°æ®åº“è¿æ¥å¤±è´¥"</span>);

<span class="hljs-comment">// è¾“å‡ºç»“æœï¼š</span>
<span class="hljs-comment">// ã€ERRORã€‘æ—¥å¿—: [error] æ•°æ®åº“è¿æ¥å¤±è´¥</span>
<span class="hljs-comment">// ï¼ˆåªæœ‰é”™è¯¯æ¶ˆè´¹è€…æ”¶åˆ°ï¼Œä¿¡æ¯æ¶ˆè´¹è€…æ”¶ä¸åˆ°ï¼‰</span>
</code></pre>
<p><strong>åœºæ™¯2ï¼šå‘é€ä¿¡æ¯æ—¥å¿—</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è°ƒç”¨ï¼šPOST /send-log?level=info&amp;content=ç”¨æˆ·ç™»å½•æˆåŠŸ</span>
directProducer.send(<span class="hljs-string">"info"</span>, <span class="hljs-string">"[info] ç”¨æˆ·ç™»å½•æˆåŠŸ"</span>);

<span class="hljs-comment">// è¾“å‡ºç»“æœï¼š</span>
<span class="hljs-comment">// ã€INFOã€‘æ—¥å¿—: [info] ç”¨æˆ·ç™»å½•æˆåŠŸ</span>
<span class="hljs-comment">// ï¼ˆåªæœ‰ä¿¡æ¯æ¶ˆè´¹è€…æ”¶åˆ°ï¼Œé”™è¯¯æ¶ˆè´¹è€…æ”¶ä¸åˆ°ï¼‰</span>
</code></pre>
<p><strong>åœºæ™¯3ï¼šå‘é€ä¸å­˜åœ¨çš„è·¯ç”±é”®</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è°ƒç”¨ï¼šPOST /send-log?level=warning&amp;content=ç³»ç»Ÿè­¦å‘Š</span>
directProducer.send(<span class="hljs-string">"warning"</span>, <span class="hljs-string">"[warning] ç³»ç»Ÿè­¦å‘Š"</span>);

<span class="hljs-comment">// è¾“å‡ºç»“æœï¼š</span>
<span class="hljs-comment">// ï¼ˆä¸¤ä¸ªæ¶ˆè´¹è€…éƒ½æ”¶ä¸åˆ°ï¼Œå› ä¸ºwarningè·¯ç”±é”®æ²¡æœ‰é˜Ÿåˆ—ç»‘å®šï¼‰</span>
</code></pre>
<p><code>DirectExchange</code> ç‰¹ç‚¹</p>
<ul>
<li><strong>ç²¾ç¡®åŒ¹é…</strong>ï¼šroutingKeyå¿…é¡»å®Œå…¨åŒ¹é…ç»‘å®šé”®</li>
<li><strong>é€‰æ‹©æ€§è·¯ç”±</strong>ï¼šæ¶ˆæ¯åªå‘é€åˆ°åŒ¹é…çš„é˜Ÿåˆ—</li>
<li><strong>å¤šé‡ç»‘å®š</strong>ï¼šå¤šä¸ªé˜Ÿåˆ—å¯ä»¥ä½¿ç”¨ç›¸åŒçš„binding key</li>
</ul>
<p>ä¸åŒçº§åˆ«çš„æ—¥å¿—ç”±ä¸åŒçš„æ¶ˆè´¹è€…å¤„ç†ï¼Œå®ç°è´£ä»»åˆ†ç¦»</p>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šæŒ‰ç±»å‹å¤„ç†æ¶ˆæ¯ï¼Œæ¯”å¦‚ error æ—¥å¿—è¿›ç›‘æ§é˜Ÿåˆ—ï¼Œinfo æ—¥å¿—è¿›å½’æ¡£é˜Ÿåˆ—ã€‚</p>
<hr/>
<h3 data-id="heading-27">äº”ã€é€šé…ç¬¦æ¨¡å¼ï¼ˆTopicä¸»é¢˜æ¨¡å¼ï¼‰</h3>
<p>ä½¿ç”¨é€šé…ç¬¦ï¼ˆ<code>*</code>åŒ¹é…ä¸€ä¸ªè¯ï¼Œ<code>#</code>åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªè¯ï¼‰è¿›è¡Œæ¨¡ç³Šè·¯ç”±</p>
<p>ä¾‹å¦‚ï¼š
<code>order.*</code>= æ‰€æœ‰ä»¥ order.å¼€å¤´çš„æ¶ˆæ¯
<code>*.error.#</code>= æ‰€æœ‰åŒ…å« .error.çš„æ¶ˆæ¯ï¼ˆä»»æ„ä½ç½®ï¼‰</p>
<h4 data-id="heading-28">config/TopicConfig.javaï¼ˆé…ç½®ç±»ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.rabbitdemo.config;

<span class="hljs-keyword">import</span> org.springframework.amqp.core.Binding;
<span class="hljs-keyword">import</span> org.springframework.amqp.core.BindingBuilder;
<span class="hljs-keyword">import</span> org.springframework.amqp.core.Queue;
<span class="hljs-keyword">import</span> org.springframework.amqp.core.TopicExchange;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;

<span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TopicConfig</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">TOPIC_EXCHANGE</span> <span class="hljs-operator">=</span> <span class="hljs-string">"topic.exchange"</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">TOPIC_QUEUE_ORDER</span> <span class="hljs-operator">=</span> <span class="hljs-string">"topic.queue.order"</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">TOPIC_QUEUE_LOG</span> <span class="hljs-operator">=</span> <span class="hljs-string">"topic.queue.log"</span>;

         <span class="hljs-comment">// åˆ›å»ºTopicç±»å‹çš„äº¤æ¢å™¨ï¼ˆæ”¯æŒé€šé…ç¬¦ï¼‰</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> TopicExchange <span class="hljs-title function_">topicExchange</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TopicExchange</span>(TOPIC_EXCHANGE);
    }

        <span class="hljs-comment">// è®¢å•é˜Ÿåˆ—</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Queue <span class="hljs-title function_">orderQueue</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Queue</span>(TOPIC_QUEUE_ORDER);
    }

        <span class="hljs-comment">// æ—¥å¿—é˜Ÿåˆ—</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Queue <span class="hljs-title function_">logQueue</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Queue</span>(TOPIC_QUEUE_LOG);
    }

    <span class="hljs-comment">// ç›‘å¬ order å¼€å¤´çš„æ¶ˆæ¯ï¼Œå¦‚ order.created, order.cancelled</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Binding <span class="hljs-title function_">orderBinding</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> BindingBuilder.bind(orderQueue()).to(topicExchange()).with(<span class="hljs-string">"order.*"</span>);
    }

    <span class="hljs-comment">// ç›‘å¬åŒ…å« error çš„æ—¥å¿—ï¼Œå¦‚ user.error.login, db.error.timeout</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Binding <span class="hljs-title function_">logBinding</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> BindingBuilder.bind(logQueue()).to(topicExchange()).with(<span class="hljs-string">"*.error.#"</span>);
    }
}
</code></pre>
<p>ç»‘å®šå…³ç³»ç¤ºæ„å›¾ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">topic.exchangeï¼ˆä¸»é¢˜äº¤æ¢å™¨ï¼‰
    â†“
    |-- <span class="hljs-attr">routingKey</span>=<span class="hljs-string">"order.*"</span>    â†’ topic.queue.orderï¼ˆè®¢å•é˜Ÿåˆ—ï¼‰
    |-- <span class="hljs-attr">routingKey</span>=<span class="hljs-string">"*.error.#"</span>  â†’ topic.queue.logï¼ˆæ—¥å¿—é˜Ÿåˆ—ï¼‰
</code></pre>
<h4 data-id="heading-29">producer/TopicProducer.javaï¼ˆç”Ÿäº§è€…ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.rabbitdemo.producer;

<span class="hljs-keyword">import</span> com.example.rabbitdemo.config.TopicConfig;
<span class="hljs-keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Service;

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TopicProducer</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RabbitTemplate rabbitTemplate;

        <span class="hljs-comment">/**
     * å‘é€æ¶ˆæ¯åˆ°ä¸»é¢˜äº¤æ¢å™¨
     * <span class="hljs-doctag">@param</span> routingKey è·¯ç”±é”®ï¼ˆæ”¯æŒé€šé…ç¬¦åŒ¹é…ï¼‰
     * <span class="hljs-doctag">@param</span> message æ¶ˆæ¯å†…å®¹
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">send</span><span class="hljs-params">(String routingKey, String message)</span> {
        rabbitTemplate.convertAndSend(TopicConfig.TOPIC_EXCHANGE, routingKey, message);
    }
}
</code></pre>
<h4 data-id="heading-30">consumer/TopicOrderConsumer.javaï¼ˆOrderæ¶ˆè´¹è€…ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.rabbitdemo.consumer;

<span class="hljs-keyword">import</span> com.example.rabbitdemo.config.TopicConfig;
<span class="hljs-keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;

<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TopicOrderConsumer</span> {

    <span class="hljs-meta">@RabbitListener(queues = TopicConfig.TOPIC_QUEUE_ORDER)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">receive</span><span class="hljs-params">(String message)</span> {
        System.out.println(<span class="hljs-string">"ã€è®¢å•æœåŠ¡ã€‘æ”¶åˆ°: "</span> + message);
    }
}
</code></pre>
<h4 data-id="heading-31">consumer/TopicLogConsumer.javaï¼ˆLogæ¶ˆè´¹è€…ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.rabbitdemo.consumer;

<span class="hljs-keyword">import</span> com.example.rabbitdemo.config.TopicConfig;
<span class="hljs-keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;

<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TopicLogConsumer</span> {

    <span class="hljs-meta">@RabbitListener(queues = TopicConfig.TOPIC_QUEUE_LOG)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">receive</span><span class="hljs-params">(String message)</span> {
        System.out.println(<span class="hljs-string">"ã€æ—¥å¿—æœåŠ¡ã€‘æ”¶åˆ°é”™è¯¯: "</span> + message);
    }
}
</code></pre>
<p>æµ‹è¯•</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å‘é€ï¼šorder.created è·¯ç”±é”®çš„æ¶ˆæ¯</span>
topicProducer.send(<span class="hljs-string">"order.created"</span>, <span class="hljs-string">"ç”¨æˆ·123åˆ›å»ºäº†æ–°è®¢å•"</span>);

<span class="hljs-comment">// å‘é€ï¼šuser.error.login è·¯ç”±é”®çš„æ¶ˆæ¯</span>
topicProducer.send(<span class="hljs-string">"user.error.login"</span>, <span class="hljs-string">"ç”¨æˆ·ç™»å½•å¤±è´¥ï¼Œå¯†ç é”™è¯¯"</span>);
</code></pre>
<p><code>TopicExchange</code> é€šé…ç¬¦è§„åˆ™</p>
<p><strong>æ˜Ÿå· (*) é€šé…ç¬¦</strong></p>
<ul>
<li>åŒ¹é…æ°å¥½ä¸€ä¸ªå•è¯</li>
<li>ç¤ºä¾‹ï¼š<code>order.*</code> åŒ¹é…ï¼š
<ul>
<li><code>order.create</code> âœ“</li>
<li><code>order.pay</code> âœ“</li>
<li><code>order.cancel</code> âœ“</li>
<li><code>order.detail.view</code> âœ—ï¼ˆä¸¤ä¸ªç‚¹ï¼Œå¤šä¸ªå•è¯ï¼‰</li>
</ul>
</li>
</ul>
<p><strong>äº•å· (#) é€šé…ç¬¦</strong></p>
<ul>
<li>åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå•è¯</li>
<li>ç¤ºä¾‹ï¼š<code>*.error.#</code> åŒ¹é…ï¼š
<ul>
<li><code>system.error</code> âœ“</li>
<li><code>db.error.timeout</code> âœ“</li>
<li><code>user.error.login.failed</code> âœ“</li>
<li><code>error</code> âœ—ï¼ˆç¼ºå°‘å‰é¢çš„å•è¯ï¼‰</li>
</ul>
</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šçµæ´»çš„æ¶ˆæ¯åˆ†ç±»ï¼Œæ¯”å¦‚ç›‘å¬æ‰€æœ‰è®¢å•ç›¸å…³äº‹ä»¶ã€‚</p>
<hr/>
<h3 data-id="heading-32">å…­ã€RPC æ¨¡å¼ï¼ˆRequest/Replyï¼‰</h3>
<ul>
<li>å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼ŒæœåŠ¡ç«¯å¤„ç†å¹¶è¿”å›ç»“æœï¼ˆç±»ä¼¼è¿œç¨‹è°ƒç”¨ï¼‰</li>
<li>åˆ©ç”¨ replyTo å’Œ correlationId å®ç°è¯·æ±‚-å“åº”åŒ¹é…</li>
</ul>
<h4 data-id="heading-33">config/RpcConfig.javaï¼ˆé…ç½®ç±»ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.rabbitdemo.config;

<span class="hljs-keyword">import</span> org.springframework.amqp.core.Queue;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;

<span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RpcConfig</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">RPC_QUEUE</span> <span class="hljs-operator">=</span> <span class="hljs-string">"rpc.queue"</span>;

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Queue <span class="hljs-title function_">rpcQueue</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// RPC é˜Ÿåˆ—é€šå¸¸ä¸éœ€è¦æŒä¹…åŒ–ï¼Œå› ä¸ºè¯·æ±‚æ˜¯ä¸´æ—¶çš„</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Queue</span>(RPC_QUEUE, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>);
    }
}
</code></pre>
<h4 data-id="heading-34">producer/RpcClient.javaï¼ˆå®¢æˆ·ç«¯ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.rabbitdemo.producer;

<span class="hljs-keyword">import</span> com.example.rabbitdemo.config.RpcConfig;
<span class="hljs-keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Service;

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RpcClient</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RabbitTemplate rabbitTemplate;

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">call</span><span class="hljs-params">(String message)</span> {
        <span class="hljs-comment">// convertSendAndReceive æ˜¯åŒæ­¥é˜»å¡è°ƒç”¨ï¼Œä¼šç­‰å¾…å›å¤</span>
        <span class="hljs-keyword">return</span> (String) rabbitTemplate.convertSendAndReceive(RpcConfig.RPC_QUEUE, message);
    }
}
</code></pre>
<h4 data-id="heading-35">consumer/RpcServer.javaï¼ˆæœåŠ¡ç«¯ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.rabbitdemo.consumer;

<span class="hljs-keyword">import</span> com.example.rabbitdemo.config.RpcConfig;
<span class="hljs-keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;

<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RpcServer</span> {

    <span class="hljs-meta">@RabbitListener(queues = RpcConfig.RPC_QUEUE)</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">handle</span><span class="hljs-params">(String request)</span> {
        System.out.println(<span class="hljs-string">"ã€RPC æœåŠ¡ç«¯ã€‘å¤„ç†è¯·æ±‚: "</span> + request);
        <span class="hljs-comment">// è¿”å›å€¼ä¼šè¢« Spring è‡ªåŠ¨å‘å›å®¢æˆ·ç«¯çš„ replyTo é˜Ÿåˆ—</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">"ã€å“åº”ã€‘"</span> + request.toUpperCase();
    }
}
</code></pre>
<p><strong>RPCé˜Ÿåˆ—å‚æ•°ç‰¹ç‚¹</strong></p>
<ul>
<li><strong>durable: false</strong>ï¼šRPCé€šå¸¸æ˜¯ä¸´æ—¶è¯·æ±‚ï¼Œä¸éœ€è¦æŒä¹…åŒ–</li>
<li><strong>exclusive: false</strong>ï¼šå…è®¸å¤šä¸ªå®¢æˆ·ç«¯è¿æ¥</li>
<li><strong>autoDelete: true</strong>ï¼šæ²¡æœ‰æ¶ˆè´¹è€…æ—¶è‡ªåŠ¨åˆ é™¤ï¼Œé€‚åˆä¸´æ—¶é€šä¿¡</li>
</ul>
<p><strong>RPCé€šä¿¡æœºåˆ¶</strong></p>
<ol>
<li>å®¢æˆ·ç«¯å‘é€è¯·æ±‚åˆ°RPCé˜Ÿåˆ—</li>
<li>æœåŠ¡ç«¯ä»é˜Ÿåˆ—è·å–è¯·æ±‚å¹¶å¤„ç†</li>
<li>æœåŠ¡ç«¯å°†å“åº”å‘é€åˆ°å®¢æˆ·ç«¯æŒ‡å®šçš„å›å¤é˜Ÿåˆ—</li>
<li>å®¢æˆ·ç«¯ä»å›å¤é˜Ÿåˆ—è·å–å“åº”</li>
</ol>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šéœ€è¦è·å–å¤„ç†ç»“æœçš„å¼‚æ­¥è°ƒç”¨ï¼ˆè¾ƒå°‘ç”¨ï¼Œä¸€èˆ¬ç”¨ HTTP æˆ– gRPC æ›´ç›´æ¥ï¼‰ã€‚</p>
<hr/>
<h2 data-id="heading-36">æµ‹è¯•æ§åˆ¶å™¨</h2>
<h3 data-id="heading-37">controller/TestController.javaï¼ˆæ‰€ä»¥æ¨¡å¼çš„æ¥å£æµ‹è¯•ï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.rabbitdemo.controller;

<span class="hljs-keyword">import</span> com.example.rabbitdemo.producer.*;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.PathVariable;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;

<span class="hljs-meta">@RestController</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestController</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> SimpleProducer simpleProducer;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> WorkProducer workProducer;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> FanoutProducer fanoutProducer;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> DirectProducer directProducer;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> TopicProducer topicProducer;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RpcClient rpcClient;

    <span class="hljs-meta">@GetMapping("/simple")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">simple</span><span class="hljs-params">()</span> {
        simpleProducer.send(<span class="hljs-string">"Hello Simple"</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Simple message sent"</span>;
    }

    <span class="hljs-meta">@GetMapping("/work/{msg}")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">work</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> String msg)</span> {
        workProducer.send(msg);
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Work task sent: "</span> + msg;
    }

    <span class="hljs-meta">@GetMapping("/fanout")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">fanout</span><span class="hljs-params">()</span> {
        fanoutProducer.send(<span class="hljs-string">"Broadcast!"</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Fanout message sent"</span>;
    }

    <span class="hljs-meta">@GetMapping("/direct/{key}/{msg}")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">direct</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> String key, <span class="hljs-meta">@PathVariable</span> String msg)</span> {
        directProducer.send(key, msg);
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Direct message sent to ["</span> + key + <span class="hljs-string">"]"</span>;
    }

    <span class="hljs-meta">@GetMapping("/topic/{key}/{msg}")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">topic</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> String key, <span class="hljs-meta">@PathVariable</span> String msg)</span> {
        topicProducer.send(key, msg);
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Topic message sent with key: "</span> + key;
    }

    <span class="hljs-meta">@GetMapping("/rpc/{msg}")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">rpc</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> String msg)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> rpcClient.call(msg);
        <span class="hljs-keyword">return</span> <span class="hljs-string">"RPC Result: "</span> + result;
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-38">è®¿é—®æµ‹è¯•ï¼Ÿ</h3>
<p>å¯åŠ¨åº”ç”¨åï¼Œä¾æ¬¡è®¿é—®ï¼š</p>
<ul>
<li><code>http://localhost:8080/simple</code></li>
<li><code>http://localhost:8080/work/task1</code></li>
<li><code>http://localhost:8080/fanout</code></li>
<li><code>http://localhost:8080/direct/error/ç³»ç»Ÿé”™è¯¯</code></li>
<li><code>http://localhost:8080/direct/info/ç”¨æˆ·ç™»å½•</code></li>
<li><code>http://localhost:8080/topic/order.created/æ–°è®¢å•</code></li>
<li><code>http://localhost:8080/topic/db.error.timeout/æ•°æ®åº“è¶…æ—¶</code></li>
<li><code>http://localhost:8080/rpc/hello</code></li>
</ul>
<p>è§‚å¯Ÿæ§åˆ¶å°è¾“å‡ºå³å¯éªŒè¯æ¯ç§æ¨¡å¼ã€‚</p>
<hr/>
<h2 data-id="heading-39">æ€»ç»“</h2>
<p>é€šè¿‡ä»¥ä¸Šå…­ä¸ªæ¨¡å—çš„å®Œæ•´å®ç°ï¼Œæˆ‘ä»¬ç³»ç»Ÿæ€§åœ°è¦†ç›–äº† RabbitMQ çš„æ ¸å¿ƒå·¥ä½œæ¨¡å¼ï¼š</p>








































<table><thead><tr><th>æ¨¡å¼</th><th>æ ¸å¿ƒç‰¹ç‚¹</th><th>å…¸å‹åœºæ™¯</th></tr></thead><tbody><tr><td><strong>ç®€å•æ¨¡å¼</strong></td><td>1:1 é˜Ÿåˆ—é€šä¿¡</td><td>åŸºç¡€å¼‚æ­¥ä»»åŠ¡ï¼ˆå¦‚é‚®ä»¶å‘é€ï¼‰</td></tr><tr><td><strong>å·¥ä½œé˜Ÿåˆ—</strong></td><td>å¤šæ¶ˆè´¹è€…ç«äº‰æ¶ˆè´¹</td><td>è´Ÿè½½å‡è¡¡ã€è€—æ—¶ä»»åŠ¡åˆ†å‘</td></tr><tr><td><strong>å‘å¸ƒ/è®¢é˜…ï¼ˆFanoutï¼‰</strong></td><td>å¹¿æ’­åˆ°æ‰€æœ‰ç»‘å®šé˜Ÿåˆ—</td><td>ç¾¤å‘é€šçŸ¥ã€å¤šç³»ç»ŸåŒæ­¥</td></tr><tr><td><strong>è·¯ç”±æ¨¡å¼ï¼ˆDirectï¼‰</strong></td><td>ç²¾ç¡®åŒ¹é… routing key</td><td>æ—¥å¿—åˆ†çº§ã€ç±»å‹è¿‡æ»¤</td></tr><tr><td><strong>ä¸»é¢˜æ¨¡å¼ï¼ˆTopicï¼‰</strong></td><td>é€šé…ç¬¦æ¨¡ç³ŠåŒ¹é…</td><td>äº‹ä»¶æ€»çº¿ã€çµæ´»è®¢é˜…</td></tr><tr><td><strong>RPC æ¨¡å¼</strong></td><td>è¯·æ±‚-å“åº”å¼é€šä¿¡</td><td>åŒæ­¥ç»“æœè·å–ï¼ˆè¾ƒå°‘ç”¨ä½†é‡è¦ï¼‰</td></tr></tbody></table>
<p><strong>å…³é”®ç†è§£</strong>ï¼šRabbitMQ çš„å¼ºå¤§ï¼Œä¸åœ¨äºé˜Ÿåˆ—ï¼Œè€Œåœ¨äºäº¤æ¢æœº + ç»‘å®š + è·¯ç”±è¿™ä¸€æ•´å¥—æ¶ˆæ¯è·¯ç”±æœºåˆ¶ã€‚åˆç†é€‰æ‹© Exchange ç±»å‹å’Œ Binding ç­–ç•¥ï¼Œæ‰èƒ½è®©æ¶ˆæ¯ç²¾å‡†æŠµè¾¾ç›®çš„åœ°ã€‚</p>
<blockquote>
<p>æœ¬æ–‡é¦–å‘äºå…¬ä¼—å·ï¼šç¨‹åºå‘˜åˆ˜å¤§åï¼Œä¸“æ³¨åˆ†äº«å‰åç«¯å¼€å‘çš„å®æˆ˜ç¬”è®°ã€‚å…³æ³¨æˆ‘ï¼Œå°‘èµ°å¼¯è·¯ï¼Œä¸€èµ·è¿›æ­¥ï¼</p>
</blockquote>
<h4 data-id="heading-40">ğŸ“Œå¾€æœŸç²¾å½©</h4>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F6V83qjR6u0nyfzL-14xYAw" target="_blank" title="https://mp.weixin.qq.com/s/6V83qjR6u0nyfzL-14xYAw" ref="nofollow noopener noreferrer">ã€Šasync/await åˆ°åº•è¦ä¸è¦åŠ  try-catchï¼Ÿå¼‚æ­¥é”™è¯¯å¤„ç†æœ€ä½³å®è·µã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FPQ_w7CDVoIZPn-CVH2DKJg" target="_blank" title="https://mp.weixin.qq.com/s/PQ_w7CDVoIZPn-CVH2DKJg" ref="nofollow noopener noreferrer">ã€ŠVue3 å’Œ Vue2 çš„æ ¸å¿ƒåŒºåˆ«ï¼Ÿå¾ˆå¤šå¼€å‘è€…éƒ½æ²¡å®Œå…¨ææ‡‚çš„ 10 ä¸ªç»†èŠ‚ã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2Fp0n2mN5RDDDaIWuHHVRUZQ" target="_blank" title="https://mp.weixin.qq.com/s/p0n2mN5RDDDaIWuHHVRUZQ" ref="nofollow noopener noreferrer">ã€ŠJava å¼€å‘å¿…çœ‹ï¼šä»€ä¹ˆæ—¶å€™ç”¨ forï¼Œä»€ä¹ˆæ—¶å€™ç”¨ Streamï¼Ÿã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FqI3TRTdDfRJSH9kCTqAQUw" target="_blank" title="https://mp.weixin.qq.com/s/qI3TRTdDfRJSH9kCTqAQUw" ref="nofollow noopener noreferrer">ã€Šè¿™ 10 ä¸ª MySQL é«˜çº§ç”¨æ³•ï¼Œè®©ä½ çš„ä»£ç åˆå¿«åˆå¥½çœ‹ã€‹</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ —å­å‰ç«¯æŠ€æœ¯å‘¨åˆŠç¬¬ 109 æœŸ - Vite 8 Betaã€JavaScript ä¸‰åå‘¨å¹´ã€Prettier 3.7...]]></title>    <link>https://juejin.cn/post/7580547126361489471</link>    <guid>https://juejin.cn/post/7580547126361489471</guid>    <pubDate>2025-12-08T00:53:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580547126361489471" data-draft-id="7580394927977529363" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ —å­å‰ç«¯æŠ€æœ¯å‘¨åˆŠç¬¬ 109 æœŸ - Vite 8 Betaã€JavaScript ä¸‰åå‘¨å¹´ã€Prettier 3.7..."/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,Vite"/> <meta itemprop="datePublished" content="2025-12-08T00:53:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ™“å¾—è¿·è·¯äº†"/> <meta itemprop="url" content="https://juejin.cn/user/2172290706715565"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ —å­å‰ç«¯æŠ€æœ¯å‘¨åˆŠç¬¬ 109 æœŸ - Vite 8 Betaã€JavaScript ä¸‰åå‘¨å¹´ã€Prettier 3.7...
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2172290706715565/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ™“å¾—è¿·è·¯äº†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-08T00:53:34.000Z" title="Mon Dec 08 2025 00:53:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ğŸŒ°<strong>æ —å­å‰ç«¯æŠ€æœ¯å‘¨åˆŠç¬¬ 109 æœŸ (2025.12.01 - 2025.12.07)</strong>ï¼šæµè§ˆå‰ç«¯ä¸€å‘¨æœ€æ–°æ¶ˆæ¯ï¼Œå­¦ä¹ å›½å†…å¤–ä¼˜ç§€æ–‡ç« è§†é¢‘ï¼Œè®©æˆ‘ä»¬ä¿æŒå¯¹å‰ç«¯çš„å¥½å¥‡å¿ƒã€‚</p>
<h2 data-id="heading-0">ğŸ“° æŠ€æœ¯èµ„è®¯</h2>
<ol>
<li>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fvite.dev%2Fblog%2Fannouncing-vite8-beta" target="_blank" title="https://vite.dev/blog/announcing-vite8-beta" ref="nofollow noopener noreferrer">Vite 8 Beta</a></strong>ï¼šé¦–æ¬¾åŸºäº Rolldown æ„å»ºçš„ Vite 8 æµ‹è¯•ç‰ˆç°å·²å‘å¸ƒï¼Œè¯¥ç‰ˆæœ¬æ‰¿è¯ºå°†å¤§å¹…æå‡ç”Ÿäº§ç¯å¢ƒæ„å»ºé€Ÿåº¦ï¼Œå¹¶ä¸º Vite æœªæ¥çš„æ‰©å±•èƒ½åŠ›æ­å»ºæ›´å®Œå–„çš„å¹³å°ã€‚</p>
</li>
<li>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fbytes.dev%2Farchives%2F25" target="_blank" title="https://bytes.dev/archives/25" ref="nofollow noopener noreferrer">JavaScript ä¸‰åå‘¨å¹´</a></strong>ï¼šæ—©åœ¨ 1995 å¹´ 5 æœˆï¼Œæ—¶å¹´ 33 å²çš„å¸ƒå…°ç™»ãƒ»è‰¾å¥‡ä»…ç”¨åå¤©æ—¶é—´å°±æ‰“é€ å‡ºäº† JavaScript çš„é¦–ä¸ªåŸå‹ç‰ˆæœ¬ã€‚1995 å¹´ 12 æœˆ 4 æ—¥ï¼Œç½‘æ™¯å…¬å¸ä¸å¤ªé˜³å¾®ç³»ç»Ÿå…¬å¸è”åˆå‘å¸ƒæ–°é—»ç¨¿ï¼Œæ­£å¼å°†å…¶å‘½åä¸º JavaScriptã€‚ä¸‰åå¹´é—´ï¼ŒJavaScript å·²ç„¶åç¨³äº† Web æŠ€æœ¯æ ˆçš„æ ¸å¿ƒåœ°ä½ï¼Œç¥æ„¿ JavaScript åœ¨ä¸‹ä¸€ä¸ªä¸‰åå¹´ç»­å†™è¾‰ç…Œã€‚</p>
</li>
<li>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fprettier.io%2Fblog%2F2025%2F11%2F27%2F3.7.0" target="_blank" title="https://prettier.io/blog/2025/11/27/3.7.0" ref="nofollow noopener noreferrer">Prettier 3.7</a></strong>ï¼šPrettier 3.7 ç‰ˆæœ¬æ­£å¼å‘å¸ƒï¼Œè¯¥ç‰ˆæœ¬ä¼˜åŒ–äº† TypeScript ä»£ç çš„æ ¼å¼åŒ–æ•ˆæœï¼Œå¹¶ä¸ºæ’ä»¶å¼€å‘è€…æä¾›äº†å…¨æ–°çš„ APIã€‚</p>
</li>
<li>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fdevblogs.microsoft.com%2Ftypescript%2Fprogress-on-typescript-7-december-2025%2F" target="_blank" title="https://devblogs.microsoft.com/typescript/progress-on-typescript-7-december-2025/" ref="nofollow noopener noreferrer">TypeScript 7 å¼€å‘è¿›å±•é€šæŠ¥</a></strong>ï¼šè¿‡å»å‡ ä¸ªæœˆï¼ŒTypeScript é¡¹ç›®åœ¨å…¬å¼€å±‚é¢é²œæœ‰åŠ¨é™ï¼Œä½†ç ”å‘å›¢é˜Ÿå®åˆ™ä¸€ç›´åœ¨å¹•åå…¨åŠ›æ¨è¿› TypeScript 6.0 ä¸ 7.0 ä¸¤ä¸ªç‰ˆæœ¬çš„å¼€å‘å·¥ä½œã€‚å…¶ä¸­ï¼Œ6.0 ç‰ˆæœ¬å°†æ˜¯æœ€åä¸€ä¸ªåŸºäº JavaScript å¼€å‘çš„ç‰ˆæœ¬ï¼ŒåŒæ—¶å®ƒä¹Ÿå°†ä½œä¸ºè¿‡æ¸¡ç‰ˆæœ¬ï¼Œä¸ºåç»­åŸºäº Go è¯­è¨€åŸç”Ÿé‡æ„çš„ 7.0 ç‰ˆæœ¬é“ºè·¯ã€‚ç›®å‰æ¥çœ‹ï¼Œ7.0 ç‰ˆæœ¬çš„æ€§èƒ½é¢„è®¡å°†æå‡çº¦ 10 å€ã€‚</p>
</li>
<li>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Freact.dev%2Fblog%2F2025%2F12%2F03%2Fcritical-security-vulnerability-in-react-server-components" target="_blank" title="https://react.dev/blog/2025/12/03/critical-security-vulnerability-in-react-server-components" ref="nofollow noopener noreferrer">React æœåŠ¡å™¨ç»„ä»¶é«˜å±æ¼æ´</a></strong>ï¼šReact å›¢é˜Ÿå‘å¸ƒç´§æ€¥å…¬å‘Šï¼šæ‰€æœ‰æ”¯æŒ React æœåŠ¡å™¨ç»„ä»¶ï¼ˆRSCï¼‰çš„åº”ç”¨å‡å—å½±å“ï¼Œå³ä¾¿åº”ç”¨æœ¬èº«å¹¶æœªå®é™…ä½¿ç”¨è¯¥ç‰¹æ€§ã€‚å…¶ä¸­ï¼Œreact-server-dom-webpackã€react-server-dom-parcel ä¸ react-server-dom-turbopack è¿™ä¸‰ä¸ªåŒ…çš„ 19.0ã€19.1.0ã€19.1.1 å’Œ 19.2.0 ç‰ˆæœ¬ï¼Œå‡å­˜åœ¨è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼Œç›¸å…³åº”ç”¨éœ€ç«‹å³å‡çº§ä¿®å¤ã€‚ä¸è¿‡å®˜æ–¹ä¹ŸæŒ‡å‡ºï¼šâ€œè‹¥ä½ çš„åº”ç”¨ä»£ç å®Œå…¨ä¸æ¶‰åŠæœåŠ¡ç«¯è¿è¡Œé€»è¾‘ï¼Œåˆ™ä¸ä¼šå—åˆ°è¯¥æ¼æ´å½±å“ã€‚â€</p>
</li>
</ol>
<h2 data-id="heading-1">ğŸ“’ æŠ€æœ¯æ–‡ç« </h2>
<ol>
<li>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fthathtml.blog%2F2025%2F12%2Fnuances-of-typing-with-jsdoc%2F" target="_blank" title="https://thathtml.blog/2025/12/nuances-of-typing-with-jsdoc/" ref="nofollow noopener noreferrer">The Nuances of JavaScript Typing using JSDoc</a></strong>ï¼šå€ŸåŠ© JSDoc å®ç° JavaScript ç±»å‹æ ‡æ³¨çš„è¿›é˜¶æŠ€å·§ â€”â€” å¦‚æœä½ æ›´é’ç JavaScript è€Œé TypeScriptï¼ˆæˆ‘çŸ¥é“è¿™æ ·çš„å¼€å‘è€…å¤§æœ‰äººåœ¨ï¼ï¼‰ï¼Œä½†åˆæƒ³å…¼é¡¾ç±»å‹æ ¡éªŒå¸¦æ¥çš„ä¾¿åˆ©ï¼Œé‚£ä¹ˆ JSDoc ä¼šæ˜¯ä¸€ä¸ªå¾ˆä¸é”™çš„æ›¿ä»£æ–¹æ¡ˆã€‚</p>
</li>
<li>
<p><strong><a href="https://juejin.cn/post/7578402574653112372" target="_blank" title="https://juejin.cn/post/7578402574653112372">å¦‚ä½•ç”¨éšå½¢å­—ç¬¦ç»™å…¬å¸å†…éƒ¨æ–‡æ¡£åŠ ç›²æ°´å°?</a></strong>ï¼šæ–‡ç« ä»‹ç»äº†åŸºäºé›¶å®½å­—ç¬¦ï¼ˆZero Width Charactersï¼‰çš„ç›²æ°´å°æŠ€æœ¯ã€‚</p>
</li>
<li>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fmarch7th.online%2Fblog%2Fposts%2F0033-%25E5%2589%258D%25E7%25AB%25AF%25E6%258A%2580%25E5%25B7%25A7%25E5%2588%2586%25E4%25BA%25AB%2F" target="_blank" title="https://march7th.online/blog/posts/0033-%E5%89%8D%E7%AB%AF%E6%8A%80%E5%B7%A7%E5%88%86%E4%BA%AB/" ref="nofollow noopener noreferrer">è§£é”å‰ç«¯é«˜é˜¶è°ƒè¯•ï¼šæµè§ˆå™¨/IDE/GitæŠ€å·§åˆ†äº«</a></strong>ï¼šä½œè€…åœ¨æ–‡ä¸­åˆ†äº«äº†å‰ç«¯è°ƒè¯•æŠ€å·§ï¼ŒåŒ…æ‹¬ï¼šConsole çš„é«˜çº§ç”¨æ³•ã€ç½‘ç»œè¯·æ±‚è°ƒè¯•ã€é«˜çº§æ–­ç‚¹æŠ€å·§ç­‰ã€‚</p>
</li>
</ol>
<h2 data-id="heading-2">ğŸ”§ å¼€å‘å·¥å…·</h2>
<ol>
<li><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fvoici.larswaechter.dev%2F" target="_blank" title="https://voici.larswaechter.dev/" ref="nofollow noopener noreferrer">Voici.js 3.0</a></strong>ï¼šä¸€æ¬¾é€‚ç”¨äºç»ˆç«¯çš„è¡¨æ ¼æ‰“å°å·¥å…·ã€‚</li>
</ol>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/db315e211d0b4920848f7a11a7ce1337~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pmT5b6X6L-36Lev5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765760013&amp;x-signature=ifx3WaO9wAzFhC%2Fx146tcpXZlv4%3D" width="100%" alt="image-20251207133135078" loading="lazy"/>
<ol start="2">
<li><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Frviscomi%2Fcapo.js" target="_blank" title="https://github.com/rviscomi/capo.js" ref="nofollow noopener noreferrer">capo.js 2.0</a></strong>ï¼šä¸€æ¬¾ä¼˜åŒ–é¡µé¢ <code>&lt;head&gt;</code> å…ƒç´ é¡ºåºçš„è„šæœ¬å·¥å…·ã€‚è¿™æ¬¾å·¥å…·ä¼šå…·ä½“å±•ç¤ºä½ é¡µé¢ <code>&lt;head&gt;</code> ä¸­å…ƒç´ çš„å½“å‰æ’åºï¼Œå¹¶ç»™å‡ºä¼˜åŒ–åçš„å»ºè®®é¡ºåºï¼Œä»¥æ­¤æå‡é¡µé¢çš„æ„ŸçŸ¥æ€§èƒ½ã€‚</li>
</ol>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/72adf897ff5b4735baae0907eac269b9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pmT5b6X6L-36Lev5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765760013&amp;x-signature=ZhjEy8br9Ha8gGfMisxDuZaG1A8%3D" width="100%" alt="image-20251207133606202" loading="lazy"/>
<ol start="3">
<li><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftinylibs%2Ftinybench" target="_blank" title="https://github.com/tinylibs/tinybench" ref="nofollow noopener noreferrer">Tinybench 6.0</a></strong>ï¼šä¸€æ¬¾è½»é‡ç®€æ´çš„åŸºå‡†æµ‹è¯•åº“ã€‚</li>
</ol>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/84540b0795d64f9ca42f4209994d2fdb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pmT5b6X6L-36Lev5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765760013&amp;x-signature=IqWhbDqJvalIf87yCBQ7iwt1pIU%3D" width="100%" alt="image-20251207135100982" loading="lazy"/>
<p>ğŸš€ğŸš€ğŸš€ <em>ä»¥ä¸Šèµ„è®¯æ–‡ç« é€‰è‡ªå¸¸è§å‘¨åˆŠï¼Œå¦‚ JavaScript Weekly ç­‰ï¼Œå‘¨åˆŠå†…å®¹ä¹Ÿä¼šä¸æ–­ä¼˜åŒ–æ”¹è¿›ï¼Œå¸Œæœ›ä½ ä»¬èƒ½å¤Ÿå–œæ¬¢ã€‚</em></p>
<p>ğŸ’– <strong>æ¬¢è¿å…³æ³¨å¾®ä¿¡å…¬ä¼—å·ï¼šæ —å­å‰ç«¯</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Redisï¼ˆ171ï¼‰å¦‚ä½•ä½¿ç”¨Rediså®ç°åˆ†å¸ƒå¼äº‹åŠ¡ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7580815599350218767</link>    <guid>https://juejin.cn/post/7580815599350218767</guid>    <pubDate>2025-12-07T23:03:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580815599350218767" data-draft-id="7580815599350202383" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Redisï¼ˆ171ï¼‰å¦‚ä½•ä½¿ç”¨Rediså®ç°åˆ†å¸ƒå¼äº‹åŠ¡ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-07T23:03:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Redisï¼ˆ171ï¼‰å¦‚ä½•ä½¿ç”¨Rediså®ç°åˆ†å¸ƒå¼äº‹åŠ¡ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T23:03:30.000Z" title="Sun Dec 07 2025 23:03:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å®ç°åˆ†å¸ƒå¼äº‹åŠ¡æ˜¯ä¸€é¡¹å¤æ‚çš„ä»»åŠ¡ã€‚Redisæœ¬èº«å¹¶ä¸ç›´æ¥æ”¯æŒåˆ†å¸ƒå¼äº‹åŠ¡ï¼Œä½†é€šè¿‡ç»“åˆRedisçš„äº‹åŠ¡åŠŸèƒ½ï¼ˆMULTI/EXECï¼‰å’Œä¸€äº›åˆ†å¸ƒå¼äº‹åŠ¡åè®®ï¼ˆå¦‚ä¸¤é˜¶æ®µæäº¤ã€TCCç­‰ï¼‰ï¼Œå¯ä»¥å®ç°ä¸€å®šç¨‹åº¦çš„åˆ†å¸ƒå¼äº‹åŠ¡ç®¡ç†ã€‚</p>
<p>è¿™é‡Œï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥å±•ç¤ºå¦‚ä½•é€šè¿‡Rediså’ŒLuaè„šæœ¬å®ç°åˆ†å¸ƒå¼äº‹åŠ¡ã€‚è¿™ä¸ªä¾‹å­åŒ…æ‹¬ä»¥ä¸‹éƒ¨åˆ†ï¼š</p>
<ol>
<li>ä½¿ç”¨Redisäº‹åŠ¡ï¼ˆMULTI/EXECï¼‰å®ç°ç®€å•çš„æœ¬åœ°äº‹åŠ¡ã€‚</li>
<li>ä½¿ç”¨Luaè„šæœ¬å®ç°æ›´å¤æ‚çš„é€»è¾‘ï¼Œä»¥ç¡®ä¿æ“ä½œçš„åŸå­æ€§ã€‚</li>
<li>ä½¿ç”¨ä¸¤é˜¶æ®µæäº¤åè®®å®ç°åˆ†å¸ƒå¼äº‹åŠ¡ã€‚</li>
</ol>
<h3 data-id="heading-0">1. ä½¿ç”¨Redisäº‹åŠ¡ï¼ˆMULTI/EXECï¼‰</h3>
<p>Redisæä¾›äº†ç®€å•çš„äº‹åŠ¡åŠŸèƒ½ï¼Œé€šè¿‡MULTIå‘½ä»¤å¼€å§‹äº‹åŠ¡ï¼Œæ‰€æœ‰åç»­å‘½ä»¤å°†è¢«æ”¾å…¥äº‹åŠ¡é˜Ÿåˆ—ï¼Œç›´åˆ°æ‰§è¡ŒEXECå‘½ä»¤ã€‚è¿™ç§æ–¹æ³•é€‚ç”¨äºå•èŠ‚ç‚¹äº‹åŠ¡ã€‚</p>
<h4 data-id="heading-1">ç¤ºä¾‹ä»£ç </h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;
<span class="hljs-keyword">import</span> redis.clients.jedis.Transaction;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisTransactionExample</span> {

    <span class="hljs-keyword">private</span> Jedis jedis;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">RedisTransactionExample</span><span class="hljs-params">(String host, <span class="hljs-type">int</span> port)</span> {
        <span class="hljs-built_in">this</span>.jedis = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(host, port);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">executeTransaction</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> (<span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> jedis.multi()) {
            transaction.set(<span class="hljs-string">"key1"</span>, <span class="hljs-string">"value1"</span>);
            transaction.set(<span class="hljs-string">"key2"</span>, <span class="hljs-string">"value2"</span>);
            transaction.incr(<span class="hljs-string">"counter"</span>);
            transaction.exec();
        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> {
        jedis.close();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">RedisTransactionExample</span> <span class="hljs-variable">example</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RedisTransactionExample</span>(<span class="hljs-string">"localhost"</span>, <span class="hljs-number">6379</span>);
        example.executeTransaction();
        example.close();
    }
}
</code></pre>
<h3 data-id="heading-2">2. ä½¿ç”¨Luaè„šæœ¬å®ç°å¤æ‚æ“ä½œçš„åŸå­æ€§</h3>
<p>ä½¿ç”¨Luaè„šæœ¬å¯ä»¥ç¡®ä¿å¤šæ­¥æ“ä½œçš„åŸå­æ€§ã€‚Luaè„šæœ¬åœ¨RedisæœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼Œå› æ­¤å¯ä»¥ä¿è¯æ“ä½œçš„åŸå­æ€§å’Œæé«˜æ€§èƒ½ã€‚</p>
<h4 data-id="heading-3">ç¤ºä¾‹ä»£ç </h4>
<p>ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨Luaè„šæœ¬å®ç°åŸå­æ“ä½œï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisLuaExample</span> {

    <span class="hljs-keyword">private</span> Jedis jedis;
    <span class="hljs-keyword">private</span> String luaScript;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">RedisLuaExample</span><span class="hljs-params">(String host, <span class="hljs-type">int</span> port)</span> {
        <span class="hljs-built_in">this</span>.jedis = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(host, port);
        <span class="hljs-built_in">this</span>.luaScript = <span class="hljs-string">"redis.call('set', KEYS[1], ARGV[1]) "</span> +
                         <span class="hljs-string">"redis.call('set', KEYS[2], ARGV[2]) "</span> +
                         <span class="hljs-string">"return redis.call('incr', KEYS[3])"</span>;
    }

    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">executeLuaScript</span><span class="hljs-params">(String key1, String value1, String key2, String value2, String counterKey)</span> {
        <span class="hljs-keyword">return</span> jedis.eval(luaScript, <span class="hljs-number">3</span>, key1, key2, counterKey, value1, value2);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> {
        jedis.close();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">RedisLuaExample</span> <span class="hljs-variable">example</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RedisLuaExample</span>(<span class="hljs-string">"localhost"</span>, <span class="hljs-number">6379</span>);
        <span class="hljs-type">Object</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> example.executeLuaScript(<span class="hljs-string">"key1"</span>, <span class="hljs-string">"value1"</span>, <span class="hljs-string">"key2"</span>, <span class="hljs-string">"value2"</span>, <span class="hljs-string">"counter"</span>);
        System.out.println(<span class="hljs-string">"Counter after script execution: "</span> + result);
        example.close();
    }
}
</code></pre>
<h3 data-id="heading-4">3. ä½¿ç”¨ä¸¤é˜¶æ®µæäº¤å®ç°åˆ†å¸ƒå¼äº‹åŠ¡</h3>
<p>ä¸¤é˜¶æ®µæäº¤ï¼ˆ2PCï¼‰æ˜¯ä¸€ç§åˆ†å¸ƒå¼äº‹åŠ¡åè®®ï¼Œé€šå¸¸ç”¨äºç¡®ä¿è·¨å¤šä¸ªèŠ‚ç‚¹çš„ä¸€è‡´æ€§ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„å®ç°ç¤ºä¾‹ã€‚</p>
<h4 data-id="heading-5">ç¤ºä¾‹ä»£ç </h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;
<span class="hljs-keyword">import</span> redis.clients.jedis.Transaction;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TwoPhaseCommitExample</span> {

    <span class="hljs-keyword">private</span> Jedis jedis1;
    <span class="hljs-keyword">private</span> Jedis jedis2;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">TwoPhaseCommitExample</span><span class="hljs-params">(String host1, <span class="hljs-type">int</span> port1, String host2, <span class="hljs-type">int</span> port2)</span> {
        <span class="hljs-built_in">this</span>.jedis1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(host1, port1);
        <span class="hljs-built_in">this</span>.jedis2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(host2, port2);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">prepareAndCommit</span><span class="hljs-params">(String key1, String value1, String key2, String value2)</span> {
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction1</span> <span class="hljs-operator">=</span> jedis1.multi();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction2</span> <span class="hljs-operator">=</span> jedis2.multi();

        transaction1.set(key1, value1);
        transaction2.set(key2, value2);

        <span class="hljs-comment">// Phase 1: Prepare</span>
        List&lt;Object&gt; prepareResult1 = transaction1.exec();
        List&lt;Object&gt; prepareResult2 = transaction2.exec();

        <span class="hljs-keyword">if</span> (prepareResult1 == <span class="hljs-literal">null</span> || prepareResult2 == <span class="hljs-literal">null</span>) {
            <span class="hljs-comment">// Rollback if any transaction failed</span>
            transaction1.discard();
            transaction2.discard();
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }

        <span class="hljs-comment">// Phase 2: Commit</span>
        transaction1 = jedis1.multi();
        transaction2 = jedis2.multi();

        transaction1.set(key1, value1);
        transaction2.set(key2, value2);

        transaction1.exec();
        transaction2.exec();

        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> {
        jedis1.close();
        jedis2.close();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">TwoPhaseCommitExample</span> <span class="hljs-variable">example</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TwoPhaseCommitExample</span>(<span class="hljs-string">"localhost"</span>, <span class="hljs-number">6379</span>, <span class="hljs-string">"localhost"</span>, <span class="hljs-number">6380</span>);
        <span class="hljs-type">boolean</span> <span class="hljs-variable">success</span> <span class="hljs-operator">=</span> example.prepareAndCommit(<span class="hljs-string">"key1"</span>, <span class="hljs-string">"value1"</span>, <span class="hljs-string">"key2"</span>, <span class="hljs-string">"value2"</span>);
        System.out.println(<span class="hljs-string">"Transaction success: "</span> + success);
        example.close();
    }
}
</code></pre>
<h3 data-id="heading-6">4. ä½¿ç”¨TCCï¼ˆTry-Confirm/Cancelï¼‰æ¨¡å¼å®ç°åˆ†å¸ƒå¼äº‹åŠ¡</h3>
<p>TCCæ¨¡å¼åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼šTryï¼ŒConfirmå’ŒCancelã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„å®ç°ç¤ºä¾‹ã€‚</p>
<h4 data-id="heading-7">ç¤ºä¾‹ä»£ç </h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;
<span class="hljs-keyword">import</span> redis.clients.jedis.Transaction;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TCCTwoPhaseCommitExample</span> {

    <span class="hljs-keyword">private</span> Jedis jedis1;
    <span class="hljs-keyword">private</span> Jedis jedis2;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">TCCTwoPhaseCommitExample</span><span class="hljs-params">(String host1, <span class="hljs-type">int</span> port1, String host2, <span class="hljs-type">int</span> port2)</span> {
        <span class="hljs-built_in">this</span>.jedis1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(host1, port1);
        <span class="hljs-built_in">this</span>.jedis2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(host2, port2);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryPhase</span><span class="hljs-params">(String key1, String value1, String key2, String value2)</span> {
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction1</span> <span class="hljs-operator">=</span> jedis1.multi();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction2</span> <span class="hljs-operator">=</span> jedis2.multi();

        transaction1.set(key1, value1);
        transaction2.set(key2, value2);

        List&lt;Object&gt; result1 = transaction1.exec();
        List&lt;Object&gt; result2 = transaction2.exec();

        <span class="hljs-keyword">return</span> result1 != <span class="hljs-literal">null</span> &amp;&amp; result2 != <span class="hljs-literal">null</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">confirmPhase</span><span class="hljs-params">(String key1, String key2)</span> {
        jedis1.del(<span class="hljs-string">"try_"</span> + key1);
        jedis2.del(<span class="hljs-string">"try_"</span> + key2);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">cancelPhase</span><span class="hljs-params">(String key1, String key2)</span> {
        jedis1.del(key1);
        jedis2.del(key2);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> {
        jedis1.close();
        jedis2.close();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">TCCTwoPhaseCommitExample</span> <span class="hljs-variable">example</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TCCTwoPhaseCommitExample</span>(<span class="hljs-string">"localhost"</span>, <span class="hljs-number">6379</span>, <span class="hljs-string">"localhost"</span>, <span class="hljs-number">6380</span>);
        <span class="hljs-type">boolean</span> <span class="hljs-variable">prepared</span> <span class="hljs-operator">=</span> example.tryPhase(<span class="hljs-string">"key1"</span>, <span class="hljs-string">"value1"</span>, <span class="hljs-string">"key2"</span>, <span class="hljs-string">"value2"</span>);
        <span class="hljs-keyword">if</span> (prepared) {
            example.confirmPhase(<span class="hljs-string">"key1"</span>, <span class="hljs-string">"key2"</span>);
            System.out.println(<span class="hljs-string">"Transaction committed."</span>);
        } <span class="hljs-keyword">else</span> {
            example.cancelPhase(<span class="hljs-string">"key1"</span>, <span class="hljs-string">"key2"</span>);
            System.out.println(<span class="hljs-string">"Transaction rolled back."</span>);
        }
        example.close();
    }
}
</code></pre>
<h3 data-id="heading-8">æ€»ç»“</h3>
<p>ä¸Šè¿°ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨Rediså®ç°åˆ†å¸ƒå¼äº‹åŠ¡ã€‚æ ¹æ®å…·ä½“çš„ä¸šåŠ¡éœ€æ±‚ï¼Œå¯ä»¥é€‰æ‹©åˆé€‚çš„å®ç°æ–¹å¼ã€‚å¯¹äºç®€å•çš„æœ¬åœ°äº‹åŠ¡ï¼Œå¯ä»¥ä½¿ç”¨Redisè‡ªå¸¦çš„MULTI/EXECå‘½ä»¤ï¼›å¯¹äºå¤æ‚çš„åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå¯ä»¥ç»“åˆLuaè„šæœ¬å’Œä¸¤é˜¶æ®µæäº¤åè®®ç­‰è¿›è¡Œå®ç°ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è®© AI ç”¨ Flutter å®ç°äº†çŒ—çªåº§çš„ç ´åæ€Â·ç½—é’ˆåŠ¨ç”»ï¼Œè¿™ä¸ªè¿‡ç¨‹å¦‚ä½•é©¯æœ AI]]></title>    <link>https://juejin.cn/post/7580740563893977122</link>    <guid>https://juejin.cn/post/7580740563893977122</guid>    <pubDate>2025-12-07T23:08:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580740563893977122" data-draft-id="7580373352421277722" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è®© AI ç”¨ Flutter å®ç°äº†çŒ—çªåº§çš„ç ´åæ€Â·ç½—é’ˆåŠ¨ç”»ï¼Œè¿™ä¸ªè¿‡ç¨‹å¦‚ä½•é©¯æœ AI"/> <meta itemprop="keywords" content="Flutter,Android,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-07T23:08:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‹çŒ«deå°éƒ­"/> <meta itemprop="url" content="https://juejin.cn/user/817692379985752"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è®© AI ç”¨ Flutter å®ç°äº†çŒ—çªåº§çš„ç ´åæ€Â·ç½—é’ˆåŠ¨ç”»ï¼Œè¿™ä¸ªè¿‡ç¨‹å¦‚ä½•é©¯æœ AI
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/817692379985752/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‹çŒ«deå°éƒ­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T23:08:08.000Z" title="Sun Dec 07 2025 23:08:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ç»å†äº†ä¹‹å‰çš„<a href="https://juejin.cn/post/7578215424677003327" target="_blank" title="https://juejin.cn/post/7578215424677003327">ã€Šç”¨ AI åšäº†å‡ ä¸ªè¶…ç‚«é…·çš„ Flutter åŠ¨ç”»ã€‹</a>çš„æŠ½è±¡å®ç°åï¼Œå°±æœ‰äº†æƒ³è®© AI åšç‚¹æ›´ç‚«é…·åˆæ›´å…·è±¡åŒ–çš„ä¸œè¥¿ï¼Œåˆšå¥½å‰æ®µæ—¶é—´å¯¹æ— é™åŸç¯‡é‡Œâ€œä¸‰å“¥â€çš„ç ´åæ€Â·ç½—é’ˆå±•å¼€å°è±¡æ·±åˆ»ï¼Œæ‰€ä»¥å°±å†³å®šç”¨å®ƒè¯•è¯•æ°´ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e471aa2103144e3092e42c6140498810~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=QntV0Vwa%2BsgOQNGgrZ8FTeSfZ6c%3D" alt="" loading="lazy"/></p>
<p>æ•´ä¸ªè¿‡ç¨‹ä½“éªŒä¸‹æ¥ï¼Œåªèƒ½è¯´ï¼Œ<strong>AI æ˜¯å¾ˆå¼ºï¼Œä½†æ˜¯ç”¨è¿‡çš„ä¹Ÿéƒ½çŸ¥é“ï¼ŒæŸç§ç¨‹åº¦ä¸Šå…¶å®ä¹Ÿæ²¡æœ‰é‚£ä¹ˆå¼º</strong>ï¼Œå› ä¸ºä½ éœ€è¦å’Œä»–åŒé¢‘ï¼Œåªæœ‰é©¯æœå®ƒä¹‹åï¼Œæ‰èƒ½çœŸæ­£åšåˆ°ä½ æƒ³è¦çš„æ•ˆæœï¼Œæ¯”å¦‚è¿™ä¸ªæ•ˆæœæˆ‘å°±å’Œ AI å‰åæ‘©æ“¦äº† 50 å¤šä¸ªç‰ˆæœ¬æ‰å‹‰å¼ºå¯ä»¥æ¥å—ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e2c14fad7054b5c83214a43dda35a85~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=TEr1aibRXg7d9apEsM4%2FWPOe6h4%3D" alt="" loading="lazy"/></p>
<p>é¦–å…ˆï¼Œæˆ‘æ‰¾äº†ä¸€å¼ é˜µæ³•çš„åŸå›¾ï¼Œç„¶åäº¤ç»™ AI ï¼Œå°è¯•è®©ä»–ç†è§£å›¾ç‰‡é‡Œçš„çº¿æ¡æ¥å®ç°ç›¸åº”çš„æ•ˆæœï¼Œå¯æƒ³è€ŒçŸ¥ï¼Œç»“æœæƒ¨ä¸å¿ç¹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6dd06bb813e347bf93a0bf75aa3f2c64~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=N7isiIH6x%2FO3d3CHl0J7UC%2BvcW0%3D" alt="" loading="lazy"/></p>
<p>æ‰€ä»¥ä¸€å¼€å§‹æˆ‘å¾—åˆ°çš„æ˜¯è¿™æ ·çš„ä¸œè¥¿ï¼Œç›¸ä¿¡è¿™æ—¶å€™å·²ç»å¼€å§‹åŠé€€å¤§å¤šæ•°äººäº†ï¼Œå¹¶è§‰å¾— AI ä¹Ÿå°±è¿™æ ·ï¼Œæ ¹æœ¬åšä¸å‡ºæ¥æˆ‘ä»¬æƒ³è¦çš„ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7bbec9c6d56f434797a5c748cd47c100~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=PClEZPMTQJUO0Ab9DVsz5IU5Chk%3D" alt="" loading="lazy"/></p>
<p>ä½†æ˜¯è¿™å¯¹æˆ‘æ¥è¯´æ˜¯ç¬¦åˆé¢„æœŸçš„ï¼Œå› ä¸ºæˆ‘ä»¬ç»™å‡ºçš„æç¤ºè¯å…¶å®å¤ªç©ºæ³›äº†ï¼Œ<strong>å¹¶ä¸” AI ä¹Ÿå¹¶ä¸èƒ½çœŸçš„å®Œå…¨é è‡ªå·±ç†è§£æˆ‘ä»¬ç»™å‡ºçš„å›¾ç‰‡ç”»é¢</strong>ï¼Œæ‰€ä»¥æˆ‘å°è¯•é€šè¿‡ä¸°å¯Œæç¤ºè¯æ¥å®Œæˆï¼Œç„¶ååœ¨è¿™ä¸ªè¿‡ç¨‹æˆ‘å°±å¾—åˆ°äº†ç±»ä¼¼ä¸‹æ–¹è¿™æ ·çš„ç»“æœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b88a13a18a744a7f843c23493179f388~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=%2B6PJ3%2BAod8U8HoMyJNubeRG0RkE%3D" alt="" loading="lazy"/><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/00bc10186e804ffbac2442f934ac97de~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=a73wnbZu8GkGuCxgVeaYVFInyj8%3D" alt="" loading="lazy"/></p>
<p>è¿™æ—¶å€™æ—¶å€™æˆ‘å¼€å§‹æ„è¯†åˆ° AI çœŸçš„æ²¡èƒ½<strong>ç›´æ¥</strong>ç†è§£å›¾ç‰‡é‡Œçš„ç”»é¢ï¼Œæ‰€ä»¥æˆ‘æ¢äº†ä¸ªæ€è·¯ï¼Œå°è¯•é€šè¿‡ä¸€äº›è¾…åŠ©æ‰‹æ®µè®© AI ç†è§£æ•´ä¸ªæ„å›¾çš„å½¢æˆï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5f2caeff24874df8a77de490ca9ee074~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=fsUNSSowHuQhsM4yvd25mNcv1pc%3D" alt="image-20251204171819155" loading="lazy"/><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/18e15c5fe913496b8938a33241382eb6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=KADblOCw0Eyxa3gMM3MmRAJE5mM%3D" alt="" loading="lazy"/></p>
<p>åœ¨é€šè¿‡æç¤ºè¯å’Œæ„å›¾åæ ‡ç†è§£åï¼ŒAI æ˜¯çœŸçš„å¼€å§‹ç†è§£å›¾ç‰‡çš„æ„å›¾äº†ï¼Œè‡³å°‘å®ƒæ˜¯çœŸçš„èƒ½é€šè¿‡çº¢åœˆæ˜ç™½è‡ªå·±éœ€è¦åšçš„äº‹æƒ…ï¼Œè¿™ä¹Ÿä½“ç°åœ¨ä»£ç çš„æåæ ‡å®ç°ä¸Šï¼Œç„¶åæˆ‘å°±å¾—åˆ°äº†ä¸‹æ–¹çš„æ•ˆæœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0d916a76f4ee4950ad11fa9b976426d7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=fWOm0mN9Lm9j0hbW8xci0FRJub8%3D" alt="image-20251204171913151" loading="lazy"/></p>
<p>çœ‹èµ·æ¥æ˜¯ä¸æ˜¯è¿˜å·®å¾ˆå¤šï¼Ÿä½†æ˜¯ä¸æ€•ï¼Œ<strong>åªè¦æ–¹å‘æ˜¯å¯¹çš„å°±è¡Œ</strong>ï¼Œæ¥ç€å°±æ˜¯å„ç§å¾®è°ƒå’Œçº é”™å·¥ä½œï¼Œè¿™ä¸ªè¿‡ç¨‹éœ€è¦ä¸åœç»™å‡ºæ˜ç¡®æŒ‡ä»¤ï¼Œå¹¶åŠæ—¶çº æ­£ AI åœ¨ä»£ç ä¸Šçš„é”™è¯¯ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6f16457c539248cab52a8635253abe8b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=ogEoNGlJTXUgfVCmplFAivDEBqQ%3D" alt="" loading="lazy"/><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b15071bd0ccc4f58a368893d6788fd35~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=VQWQHALo%2FoOapfndU7mRfDwv2%2FU%3D" alt="" loading="lazy"/><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1af54ea59e6742fd9d5ffe985d8fe7cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=lyVJPwA7m6DlY1T2iN9QrfwGCH8%3D" alt="" loading="lazy"/><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3015a0cbd7144061b7ff0c2ef14cc62d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=j3vXNH2RuE3kRK%2FcxaFNTPAlpS0%3D" alt="" loading="lazy"/><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/57886d06a136473695656001b932c26b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=4OndLd1r9xH4MMEl6%2FvGUVzoEYI%3D" alt="" loading="lazy"/><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/38f73ae9e12646b28119a37ec3cbad59~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=3Ycz2i2%2BULfHkgtDkdnMnXUbylA%3D" alt="" loading="lazy"/><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a321ee88757e462f845b0c8c772420ab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=8l2ezTfhdpQB7u1vEDBt7dEFmYc%3D" alt="" loading="lazy"/></p>
<p>å½“ç„¶ï¼Œè¿™ä¸ªè¿‡ç¨‹éš¾å…è¿˜æ˜¯å­˜åœ¨â€œå¿ƒæ€çˆ†ç‚¸â€çš„æ—¶å€™ï¼Œæ¯•ç«Ÿå½“ä½ å‘ç° AI æ€»æ˜¯å–œæ¬¢ç‰¹ç«‹ç‹¬è¡Œï¼Œæ˜æ˜ä½ å·²ç»çº æ­£ä»–äº†ï¼Œä½†æ˜¯ä»–è¿˜æ˜¯è¯´ï¼šâ€œ<em>æ˜¯çš„ï¼Œä½ çš„å¯¹çš„ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯è¦ä¿æŒæˆ‘çš„åšæ³•</em>â€ çš„æ—¶å€™ï¼Œä¸éª‚ä¸¤å¥æ˜¯çœŸçš„æ„éš¾å¹³ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/97037776f0ca4b2296d5f8b7a7ac821f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=d3OkN%2B8eZ1HHF1Pxs7cuAhtI2PQ%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>å¦å¤–ï¼Œç”±äºä¼šè¯é•¿äº†ä¹‹åï¼Œæ¦‚ç‡å‡ºç°ä¸Šä¸‹æ–‡ä¸¢å¤±ï¼Œå°±ä¼šå‡ºç°ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜ï¼Œæ¯”å¦‚æœ¬æ¥å°±ç”Ÿæ°”äº†ï¼Œ<strong>è¿™é‡Œè¿˜ç›´æ¥å°†éœ€æ±‚å˜æˆä½¿ç”¨ Nano Banana pro ç»™æˆ‘å‡ºå›¾è€Œä¸æ˜¯è°ƒæ•´ä»£ç ï¼Œå¿ƒæ€ç‚¸è£‚</strong>ã€‚</p>
</blockquote>
<p>å½“ç„¶ï¼Œåœ¨ç»å†å¤šæ¬¡ç»†èŠ‚è°ƒæ•´åï¼Œç»ˆäºè¿˜æ˜¯ç”»å‡ºäº†æˆ‘ä»¬å¤§æ¦‚å¸Œæœ›çš„æ•ˆæœï¼Œç„¶åå°±æ˜¯å„ç§å®ç°ç»†èŠ‚çš„æ‰“ç£¨ï¼Œè¿™ä¸ªæ—¶å€™ AI å¯¹äºå…·ä½“è°ƒæ•´çš„ç†è§£å°±å¾ˆåˆ°ä½äº†ï¼Œå¹¶ä¸”å½“ä½ ç”¨ç®­å¤´æŒ‡å‡ºæ–°èŠ±æ ·å“¦ä¿®æ”¹çš„ä½ç½®æ˜¯ï¼Œå®ƒä¹Ÿèƒ½åŠæ—¶è°ƒæ•´ã€‚</p>
<p>æ¯”å¦‚æˆ‘å…‰é€Ÿå‘Šè¯‰å®ƒï¼Œé›ªèŠ±åˆ†å‰çš„æœ«ç«¯ç»†èŠ‚åº”è¯¥æœ‰è§’åº¦çš„ï¼Œå¹¶ä¸”å¯¹é½æå¹²ï¼Œè¿™æ—¶å€™å®ƒå°±èƒ½åšå‡ºæ­£ç¡®çš„ä¿®æ”¹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef9caacea8b64ff191055d5bc0d327f9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=0su95YHQW%2B922FCTNy9km161lMU%3D" alt="" loading="lazy"/><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2d2f6089220f4d2ab7678a8a03a8d7ca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=fGAlqoSL9KkMtOUvIiCxT%2FRGurI%3D" alt="" loading="lazy"/></p>
<p>æœ‰æ—¶å€™ AI æ”¹èµ·æ¥å¤ªæ…¢äº†ï¼Œæˆ–è€…è·¯çº¿å·²ç»åäº†çš„æ—¶å€™ï¼Œå°±éœ€è¦äººå·¥ä»‹å…¥ï¼Œé€šè¿‡äººå·¥è¿›è¡Œå¾®è°ƒäº†ï¼Œç„¶åè®© AI é€šè¿‡ä½ çš„ä»£ç å†ç»§ç»­ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c6986c590d954a8dab8a436e93d57283~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=F35xO5pjXqPYU%2FqHPLTXlBLhCa4%3D" alt="" loading="lazy"/><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/429f2b01365f448fba09a462a16631e7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=umquMJH5dgckXo2mbDmhJ4zQ4dw%3D" alt="" loading="lazy"/></p>
<p>æœ€åšç»ˆäºå¾—åˆ°äº†æˆ‘éœ€è¦çš„é˜µå›¾æ•ˆæœï¼Œè™½ç„¶è¿˜åŸçš„ä¸æ˜¯ 100% ï¼Œä½†æ˜¯å†ç¨å¾®äººå·¥è°ƒæ•´ä¸‹ï¼Œå°±æ˜¯å¯ç”¨çš„çŠ¶æ€äº†ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e332d4e8d1b646ddb162a2bd94631b36~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=AtmDbEmTsRMRepZKE%2FAPwgW4CzU%3D" alt="" loading="lazy"/></p>
<p>ä¹‹åå°±æ˜¯è®©é˜µæ³•ç»• X è½´æ¸²æŸ“ï¼Œå½“ç„¶ AI åœ¨æœ€åè¿˜æ˜¯å†ç»™æˆ‘æ¥äº†ä¸€é”¤ï¼Œçœ‹èµ·æ¥æç¤ºè¯æ˜¯ç»†èŠ‚æ˜¯çœŸçš„ä¸€ç‚¹éƒ½ä¸èƒ½çœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4b9a05a637f412e9d7facf6b153fdb9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=1uzrR3yozxKA4noHVFkdLodsf2A%3D" alt="" loading="lazy"/></p>
<p>ä½†æ˜¯æœ‰æ—¶å€™ AI åˆå¾ˆè´´å¿ƒï¼Œå› ä¸ºå®ƒä¼šå‘ç°æ—‹è½¬ 90 åº¦å¹¶ä¸åˆç†ï¼Œéœ€è¦è®©è§’åº¦è°ƒæ•´ä¸º 80 % æ¥å®ç°æˆ‘ä»¬çš„æ•ˆæœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c3109e546d2c4e979e2c5628ca5dc54a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=nWSmlUIkNwV4zBznjCTpSuFsNnM%3D" alt="" loading="lazy"/></p>
<p>åŒæ—¶ä¸€äº›å®ç°è¿‡ç¨‹ä¸­çš„ bug é—®é¢˜ï¼Œå®ƒä¹Ÿèƒ½å¤ŸåŠæ—¶ç†è§£æ”¹æ­£ï¼Œå¹¶è¯´æ˜åŸå› ï¼Œè¿™ä¸ªä¹Ÿæ˜¯éå¸¸ä¸é”™çš„åœºæ™¯å­¦ä¹ ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3faa4d3370cb42a599a098949b9e9287~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=XK3OJIglbpRmoaGGBKTdHODYoEs%3D" alt="" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒAI å®é™…ä¸Šæ˜¯èƒ½ç†è§£æˆ‘ä»¬ç»™å‡ºçš„å›¾ç‰‡çš„ï¼Œåªæ˜¯å®ƒæ— æ³•ç›´æ¥å®Œæ•´ä¸”å…·ä½“çš„ç†è§£ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬ç»™å»å…·ä½“è¯¦ç»†çš„æ­¥éª¤ï¼Œç”šè‡³å¸®åŠ©å®ƒå»ç»“æ„ç›®æ ‡æ•ˆæœçš„æ„æˆï¼Œä»è€Œå¸®åŠ©æˆ‘ä»¬å®ç°æœ€ç»ˆçš„æ•ˆæœï¼Œè¿™å…¶å®ä¹Ÿæ˜¯é©¯æœ AI çš„è¿‡ç¨‹ã€‚</p>
<blockquote>
<p><strong>æ‰€æœ‰å¦„å›¾åœ¨ã€Œç°é˜¶æ®µã€è®© AI ä¸€æ­¥åˆ°ä½å®Œæˆå¤æ‚é€»è¾‘çš„æƒ³æ³•ï¼Œå¤§å¤šæ•°æ—¶å€™éƒ½ä¼šä»¥æ”¾å¼ƒæ”¶å°¾</strong>ã€‚</p>
</blockquote>
<h2 data-id="heading-0">è§£è¯»å®ç°</h2>
<p>æœ€åï¼Œæˆ‘ä»¬æ¥è§£è¯»ä»£ç å®ç°ï¼Œå…¶å®æ•´ä¸ªç°å®ä¸Šå°±æ˜¯ä½¿ç”¨äº† <code>CustomPaint</code> ã€<code>AnimationController</code> å’Œ <code>Matrix4</code> ï¼Œåœ¨ä»£ç å®ç°ç»“æ„ä¸Šï¼Œä¸»è¦æœ‰ <strong>â€œå¤šé˜¶æ®µåŠ¨ç”»è°ƒåº¦â€ã€â€œæ•°å­¦ç»˜å›¾åŸç†â€ã€â€œ3D ç©ºé—´å˜æ¢â€</strong> å’Œ <strong>â€œè§’è‰²åˆæˆç‰¹æ•ˆâ€</strong> å››ä¸ªæ ¸å¿ƒéƒ¨åˆ†ã€‚</p>
<h3 data-id="heading-1">å¤šé˜¶æ®µåŠ¨ç”»è°ƒåº¦</h3>
<p>åœ¨åŠ¨ç”»å®ç°ä¸Šï¼Œ AI å¹¶æ²¡æœ‰ä½¿ç”¨å•ä¸€çš„åŠ¨ç”»æ§åˆ¶å™¨ï¼Œè€Œæ˜¯å®šä¹‰äº†å››ä¸ªé¡ºåºæ‰§è¡Œçš„æ§åˆ¶å™¨ï¼Œæ¨¡æ‹Ÿå‡ºä»æ— åˆ°æœ‰çš„â€œå±•å¼€â€è¿‡ç¨‹ï¼Œå…·ä½“å®ç°é€»è¾‘æ˜¯ï¼š</p>
<ul>
<li>ç»˜åˆ¶é˜¶æ®µ (<code>_drawController</code>, 4ç§’): é˜µæ³•çº¿æ¡ä»ä¸­å¿ƒå‘å¤–ç”Ÿé•¿</li>
<li>æ—‹è½¬é˜¶æ®µ (<code>_rotateController</code>, 3ç§’): é˜µæ³•ç»˜åˆ¶å®Œæˆåå¼€å§‹å¿«é€Ÿæ—‹è½¬</li>
<li>å€¾æ–œå€’åœ°é˜¶æ®µ (<code>_tiltController</code>, 1.5ç§’): é˜µæ³•ä» 2D å¹³é¢å€’ä¸‹å˜æˆ 3D åœ°é¢è§†è§’ï¼ŒåŒæ—¶ä¼´éšäº®åº¦çˆ†å‘</li>
<li>è§’è‰²æ˜¾ç°é˜¶æ®µ (<code>_characterController</code>, 1ç§’): è§’è‰²é…åˆå…‰æ•ˆæµ®ç°</li>
</ul>
<p>åŒæ—¶ï¼Œåˆ©ç”¨ <code>CurvedAnimation</code> å’Œ <code>Interval</code> å°†ç»˜åˆ¶é˜¶æ®µç»†åˆ†ä¸ºæ›´è‡ªç„¶çš„å­æ­¥éª¤ï¼š</p>
<ul>
<li>0% - 20%: ç”»ä¸­å¿ƒåœ†</li>
<li>20% - 50%: ç”»å†…éƒ¨æ”¾å°„çº¿</li>
<li>50% - 75%: ç”»é›ªèŠ±çŠ¶ç»„ä»¶ï¼ˆå…­è¾¹å½¢æ•°å­—ï¼‰</li>
<li>75% - 100%: ç”»å¤–éƒ¨å»¶ä¼¸çº¿</li>
</ul>
<hr/>
<h3 data-id="heading-2">ç»˜å›¾æ ¸å¿ƒï¼šæåæ ‡ç³»ä¸å‘å…‰ç¬”è§¦</h3>
<p>å› ä¸ºæˆ‘æä¾›äº†é˜µæ³•çš„åœ†å‘¨å¯¹ç§°çš„ç¤ºä¾‹ï¼Œæ‰€ä»¥æ•´ä¸ªç»˜åˆ¶é€»è¾‘éƒ½æ˜¯å›´ç»•åœ†å½¢ä¸ºåŸºç¡€åšå¸ƒå±€ï¼Œå…¶ä¸­ä¸»è¦å°±æ˜¯ä»¥æåæ ‡ç³»ä¸ºä¸»ï¼š</p>
<h4 data-id="heading-3">1. æåæ ‡å®šä½ (Polar Coordinates)</h4>
<p>é˜µæ³•æ˜¯åœ†å‘¨å¯¹ç§°çš„ï¼Œä¸ºäº†ç¡®å®š 12 ä¸ªæ–¹ä½çš„åæ ‡ï¼Œä»£ç å¤§é‡ä½¿ç”¨äº†æåæ ‡è½¬æ¢å…¬å¼ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dc6a8f989d9e40e59143544cc419a20c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=Lb43nTmbA8wA%2BhQnhrV0XVL1W2w%3D" alt="" loading="lazy"/></p>
<p>åœ¨è¿™ä¸ªå®ç°é‡Œï¼Œæåæ ‡æ˜¯ç»˜åˆ¶æ•´ä¸ªåœ†å½¢é˜µæ³•ï¼ˆç½—é’ˆï¼‰çš„æ•°å­¦æ ¸å¿ƒï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯å±å¹•ç»˜å›¾ä½¿ç”¨çš„æ˜¯ç›´è§’åæ ‡ç³» (x, y)ï¼ˆå‘å³ä¸º xï¼Œå‘ä¸‹ä¸º yï¼‰ï¼Œè€Œåœ†å½¢é˜µæ³•çš„è®¾è®¡é€»è¾‘æ˜¯åŸºäºåœ†å¿ƒã€è§’åº¦å’Œè·ç¦»çš„ï¼Œæåæ ‡çš„ä½œç”¨å°±æ˜¯å°†â€œè§’åº¦+è·ç¦»â€ç¿»è¯‘æˆå±å¹•èƒ½ç†è§£çš„â€œx+yâ€ ã€‚</p>
<p>å› ä¸ºåœ¨å¹³é¢å‡ ä½•ä¸­ï¼Œç¡®å®šä¸€ä¸ªç‚¹çš„ä½ç½®æœ‰ä¸¤ç§æ–¹å¼ï¼š</p>
<ul>
<li>ç›´è§’åæ ‡: å‘Šè¯‰ä½ ç¦»åœ†å¿ƒæ°´å¹³èµ°å¤šè¿œ (x) <strong>ï¼Œ</strong> å‚ç›´èµ°å¤šè¿œ (y)</li>
<li>æåæ ‡: å‘Šè¯‰ä½ å¾€å“ªä¸ªæ–¹å‘ (è§’åº¦)çœ‹ï¼Œç„¶åèµ°å¤šè¿œ (r)</li>
</ul>
<p>å¯¹äºåƒâ€œç ´åæ€Â·ç½—é’ˆâ€è¿™ç§ç”± 12 ä¸ªé‡å¤å…ƒç´ ç»„æˆçš„åœ†å‘¨å¯¹ç§°å›¾å½¢ï¼Œä½¿ç”¨æåæ ‡æ˜¯æœ€è‡ªç„¶å’Œé«˜æ•ˆçš„æ–¹æ³•ï¼Œæ‰€ä»¥ <code>_polarToOffset</code> å®ç°äº†ä¸Šè¿°çš„ç®—æ³•ï¼Œå®ƒçš„ä½œç”¨å°±ç±»ä¼¼â€œç¿»è¯‘å®˜â€ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// center: åœ†å¿ƒä½ç½® (æ¯”å¦‚å±å¹•æ­£ä¸­é—´)</span>
<span class="hljs-comment">// radius: åŠå¾„ (è·ç¦»åœ†å¿ƒå¤šè¿œ)</span>
<span class="hljs-comment">// angle:  è§’åº¦ (å¼§åº¦åˆ¶)</span>
Offset <span class="hljs-built_in">_polarToOffset</span>(Offset center, double radius, double angle) {
 Â return <span class="hljs-built_in">Offset</span>(
 Â  Â center.dx + radius * math.cos(angle), <span class="hljs-comment">// x = r * cos(Î¸)</span>
 Â  Â center<span class="hljs-selector-class">.dy</span> + radius * math<span class="hljs-selector-class">.sin</span>(angle), <span class="hljs-comment">// y = r * sin(Î¸)</span>
  );
}
</code></pre>
<ul>
<li><code>math.cos(angle)</code> è®¡ç®—å‡ºæ°´å¹³æ–¹å‘çš„åˆ†é‡</li>
<li><code>math.sin(angle)</code> è®¡ç®—å‡ºå‚ç›´æ–¹å‘çš„åˆ†é‡</li>
<li>åŠ ä¸Š <code>center.dx</code> å’Œ <code>center.dy</code> ï¼šæŠŠåæ ‡åŸç‚¹ä»å±å¹•å·¦ä¸Šè§’ç§»åŠ¨åˆ°ç”»å¸ƒä¸­å¿ƒ</li>
</ul>
<p>è€Œé˜µæ³•æœ‰ 12 ä¸ªè§’ï¼Œåœ†å‘¨æ˜¯ 360ï¼Œæ‰€ä»¥æ¯ä¸ªè§’é—´éš” 360 / 12 = 30 ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// i ä» 0 åˆ° 11</span>
<span class="hljs-comment">// i * 30: æ¯éš”30åº¦ä¸€ä¸ª</span>
<span class="hljs-comment">// - 90: Â  æ•°å­¦ä¸Šçš„0åº¦é€šå¸¸åœ¨"3ç‚¹é’Ÿ"æ–¹å‘ï¼Œå‡90åº¦æ˜¯ä¸ºäº†è®©å®ƒä»"12ç‚¹é’Ÿ"æ–¹å‘å¼€å§‹</span>
<span class="hljs-comment">// * (math.pi / 180): è®¡ç®—æœºåªè®¤å¼§åº¦ï¼Œä¸è®¤è§’åº¦ï¼Œæ‰€ä»¥è¦è½¬æ¢</span>
final double angle = (i * <span class="hljs-number">30</span> - <span class="hljs-number">90</span>) * (math.pi / <span class="hljs-number">180</span>);
</code></pre>
<p>åŒæ—¶é˜µæ³•ä¸æ˜¯ä¸€ä¸ªæ­£åœ†ï¼Œè€Œæ˜¯åƒé›ªèŠ±ä¸€æ ·é•¿çŸ­äº¤æ›¿çš„ï¼š</p>
<ul>
<li><strong>å¶æ•° (0, 2, 4...)</strong> : é•¿è½´ï¼ˆå¯¹åº”ä¸»è¦çš„å…­è¾¹å½¢ï¼‰ã€‚</li>
<li><strong>å¥‡æ•° (1, 3, 5...)</strong> : çŸ­è½´ï¼ˆå†…ç¼©çš„å…­è¾¹å½¢ï¼‰</li>
</ul>

<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">final</span> <span class="hljs-type">bool</span> isLongBranch = (i % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>); <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦ä¸ºé•¿è½´</span>
â€‹
<span class="hljs-comment">// å¦‚æœæ˜¯é•¿è½´ï¼ŒåŠå¾„ç”¨ rLongHex (å¤§åŠå¾„)</span>
<span class="hljs-comment">// å¦‚æœæ˜¯çŸ­è½´ï¼ŒåŠå¾„ç”¨ rShortHex (å°åŠå¾„)</span>
<span class="hljs-keyword">final</span> <span class="hljs-type">double</span> currentHexRadius = isLongBranch ? rLongHex : rShortHex;
</code></pre>
<p>æœ‰äº† <strong>è§’åº¦ (angle)</strong> å’Œ <strong>åŠå¾„ (currentHexRadius)</strong> ï¼Œä»£ç å°±å¼€å§‹è°ƒç”¨ <code>_polarToOffset</code> ç®—å‡ºå…·ä½“çš„å±å¹•åæ ‡ç‚¹ï¼Œç”¨æ¥ç”»çº¿ã€ç”»å…­è¾¹å½¢ï¼Œä»£ç å®šä¹‰äº†å‡ ä¸ªå…³é”®ç‚¹ï¼ˆä»åœ†å¿ƒå‘å¤–ï¼‰ï¼š</p>
<ul>
<li><strong>start</strong>: çº¿æ¡èµ·å§‹ç‚¹ï¼ˆåœ†å¿ƒé™„è¿‘ï¼‰</li>
<li><strong>hexInnerTarget</strong>: å…­è¾¹å½¢çš„å†…ä¾§é¡¶ç‚¹</li>
<li><strong>hexOuter</strong>: å…­è¾¹å½¢çš„å¤–ä¾§é¡¶ç‚¹</li>
<li><strong>endInnerTarget</strong>: æœ€å¤–åœˆå°–åˆºçš„é¡¶ç‚¹</li>
</ul>

<pre><code class="hljs language-ini" lang="ini">// ä¸¾ä¾‹ï¼šè®¡ç®—å…­è¾¹å½¢ä¸­å¿ƒçš„ä½ç½®
Offset <span class="hljs-attr">hexCenter</span> = _polarTo<span class="hljs-literal">Off</span>set(center, currentHexRadius, angle)<span class="hljs-comment">;</span>
</code></pre>
<p>å¦å¤–ï¼Œæ–‡å­—ä¹Ÿéœ€è¦è§’åº¦ï¼Œå½“ä½ ç”»ä½äºâ€œ3ç‚¹é’Ÿâ€æ–¹å‘çš„æ–‡å­—â€œå‚â€æ—¶ï¼Œæ–‡å­—åº”è¯¥æ˜¯æ­£çš„ï¼Œä½†å½“ä½ ç”»â€œ6ç‚¹é’Ÿâ€æ–¹å‘çš„æ–‡å­—æ—¶ï¼Œå¦‚æœç›´æ¥ç”»ï¼Œæ–‡å­—å¯èƒ½ä¼šæ­ªï¼Œæ‰€ä»¥ä»£ç åœ¨ç»˜åˆ¶å…­è¾¹å½¢å’Œæ–‡å­—æ—¶ï¼Œç”¨åˆ°äº† <code>canvas.rotate</code>ï¼Œè¿™ä¹Ÿæ˜¯åŸºäºæåæ ‡æ€æƒ³çš„å»¶ä¼¸ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">canvas</span><span class="hljs-selector-class">.save</span>();
<span class="hljs-selector-tag">canvas</span><span class="hljs-selector-class">.translate</span>(hexCenter.dx, hexCenter.dy); <span class="hljs-comment">// 1. å…ˆæŠŠç”»ç¬”ç§»åŠ¨åˆ°å…­è¾¹å½¢çš„ä½ç½®</span>
<span class="hljs-selector-tag">canvas</span><span class="hljs-selector-class">.rotate</span>(angle + math.pi / <span class="hljs-number">2</span>); Â  Â  Â  Â  Â  <span class="hljs-comment">// 2. æ—‹è½¬ç”»ç¬”ï¼Œè®©å®ƒå¯¹å‡†åœ†å¿ƒæ–¹å‘</span>
<span class="hljs-comment">// ... å¼€å§‹ç”»å…­è¾¹å½¢ ...</span>
<span class="hljs-selector-tag">canvas</span><span class="hljs-selector-class">.restore</span>();
</code></pre>
<h4 data-id="heading-4">2. 12æ–¹ä½å¾ªç¯ä¸é•¿çŸ­åŒºåˆ†</h4>
<p>å¾ªç¯ 12 æ¬¡ç»˜åˆ¶é›ªèŠ±ç“£ï¼Œä»£ç é€šè¿‡ <code>i % 2 == 0</code> åˆ¤æ–­å½“å‰æ˜¯<strong>é•¿è½´</strong>è¿˜æ˜¯<strong>çŸ­è½´</strong>ï¼Œä»è€Œå®ç°é”™è½æœ‰è‡´çš„è§†è§‰æ•ˆæœï¼ˆç±»ä¼¼äºé›ªèŠ±ç»“æ„ï¼‰</p>
<pre><code class="hljs language-ini" lang="ini">for (int <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; 12; i++) {</span>
 Â final bool <span class="hljs-attr">isLongBranch</span> = (i % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>)<span class="hljs-comment">; // å¶æ•°ä¸ºé•¿è½´ï¼Œå¥‡æ•°ä¸ºçŸ­è½´</span>
 Â // æ ¹æ®é•¿çŸ­è½´å†³å®šç»˜åˆ¶åŠå¾„ rLongHex æˆ– rShortHex
}
</code></pre>
<h4 data-id="heading-5">3. éœ“è™¹å…‰æ•ˆå®ç°åŸç† (Neon Glow)</h4>
<p>Flutter çš„ <code>Canvas</code> å…¶å®å¹¶æ²¡æœ‰â€œå‘å…‰â€å±æ€§ï¼Œæ‰€ä»¥ AI ä»£ç é€šè¿‡ <strong>â€œåŒé‡ç»˜åˆ¶â€</strong> æ¨¡æ‹Ÿå‘å…‰ï¼š</p>
<ul>
<li><strong>åº•å±‚ï¼ˆå…‰æ™•å±‚ï¼‰ï¼š</strong> ä½¿ç”¨é«˜é€æ˜åº¦é¢œè‰² + <code>MaskFilter.blur</code> (é«˜æ–¯æ¨¡ç³Š) + è¾ƒç²—çš„çº¿æ¡</li>
<li><strong>é¡¶å±‚ï¼ˆæ ¸å¿ƒå±‚ï¼‰ï¼š</strong> ä½¿ç”¨é«˜äº®åº¦å®å¿ƒé¢œè‰² + è¾ƒç»†çš„çº¿æ¡</li>
</ul>

<pre><code class="hljs language-ini" lang="ini">// 1. ç”»å…‰æ™•
canvas.drawLine(p1, p2, Paint()
  ..<span class="hljs-attr">color</span> = glowColor.withValues(alpha: glowOpacity)
  ..<span class="hljs-attr">strokeWidth</span> = width * <span class="hljs-number">5</span> * bloomWidth // ç¬”è§¦åŠ å®½
  ..<span class="hljs-attr">maskFilter</span> = MaskFilter.blur(BlurStyle.normal, <span class="hljs-number">12</span> * bloomWidth))<span class="hljs-comment">; // é«˜æ–¯æ¨¡ç³Š</span>
â€‹
// 2. ç”»é«˜äº®å®çº¿
canvas.drawLine(p1, p2, Paint()
  ..<span class="hljs-attr">color</span> = brightColor // çº¯äº®è‰²
  ..<span class="hljs-attr">strokeWidth</span> = width)<span class="hljs-comment">;</span>
</code></pre>
<hr/>
<h3 data-id="heading-6">çŸ©é˜µå˜æ¢ (3D Transformation)</h3>
<p>é˜µæ³•ä¸€å¼€å§‹æ˜¯æ­£å¯¹ç€å±å¹•çš„ï¼ˆ2Dï¼‰ï¼Œåæ¥å€’åœ¨åœ°ä¸Šå˜æˆï¼ˆ3Dï¼‰ï¼Œè¿™æ˜¯é€šè¿‡ <code>Transform</code> ç»„ä»¶é…åˆ <code>Matrix4</code> å®ç°çš„ï¼Œå…·ä½“é€»è¾‘æ˜¯ï¼š</p>
<ul>
<li><strong>é€è§†æ•ˆæœ (Perspective):</strong> è®¾ç½®çŸ©é˜µçš„ <code>(3, 2)</code> å…ƒç´ ï¼ˆå³ <code>wz</code> å› å­ï¼‰ï¼Œäº§ç”Ÿè¿‘å¤§è¿œå°çš„é€è§†æ„Ÿã€‚</li>
<li><strong>Xè½´æ—‹è½¬ (RotateX):</strong> å°†å¹³é¢å‘åå€’ä¸‹</li>
</ul>

<pre><code class="hljs language-scss" lang="scss">Matrix4 transformMatrix = Matrix4<span class="hljs-selector-class">.identity</span>();
transformMatrix<span class="hljs-selector-class">.setEntry</span>(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0.002</span>); <span class="hljs-comment">// å…³é”®ï¼šå¼€å¯é€è§†ï¼Œæ•°å€¼è¶Šå°é€è§†è¶Šå¼±</span>
â€‹
if (_tiltController.value &gt; <span class="hljs-number">0</span>) {
 Â transformMatrix<span class="hljs-selector-class">.rotateX</span>(_tiltAnim.value); <span class="hljs-comment">// è¿™é‡Œçš„ value æ˜¯ 0 åˆ° -80åº¦</span>
 Â <span class="hljs-comment">// éšç€å€’ä¸‹ï¼Œç¨å¾®ç¼©å°ä¸€ç‚¹æ¯”ä¾‹ä»¥é€‚åº”å±å¹•</span>
 Â double scale = <span class="hljs-number">1.0</span> - (_tiltController.value * <span class="hljs-number">0.2</span>); 
 Â transformMatrix<span class="hljs-selector-class">.scale</span>(scale);
}
</code></pre>
<hr/>
<h3 data-id="heading-7">è§’è‰²ä¸å…‰å½±åˆæˆ (Character &amp; Compositing)</h3>
<p>æœ€åä¸€æ­¥æ˜¯å°†äººç‰© <code>akaza.png</code> æ”¾ç½®åœ¨é˜µæ³•ä¸­å¿ƒï¼Œç”±äºäººç‰©å›¾ç‰‡å¯èƒ½æ˜¯å…¨èº«åƒï¼Œä¸­å¿ƒç‚¹åœ¨è…°éƒ¨ï¼Œä½†é˜µæ³•ä¸­å¿ƒåº”è¯¥å¯¹é½â€œè„šåº•â€ï¼Œæ‰€ä»¥ä»£ç ä½¿ç”¨äº† <code>Matrix4.translationValues</code> è¿›è¡Œäº†å¾®è°ƒï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// å‘ä¸Šåç§»é«˜åº¦çš„ 42%ï¼Œè®©è„šåº•å¯¹å‡†é˜µæ³•ä¸­å¿ƒ</span>
<span class="hljs-attribute">transform</span>: Matrix4.<span class="hljs-built_in">translationValues</span>(<span class="hljs-number">0</span>, -targetHeight * <span class="hljs-number">0.42</span>, <span class="hljs-number">0</span>),
</code></pre>
<p>åŒæ—¶ä¸ºäº†è®© 2D å›¾ç‰‡çœ‹èµ·æ¥èå…¥å‘å…‰çš„é˜µæ³•ï¼Œä»£ç å¯¹äººç‰©å›¾ç‰‡åšäº†ç‰¹æ®Šçš„å †å å¤„ç†ï¼š</p>
<ul>
<li><strong>å±‚1ï¼ˆèƒŒå…‰ï¼‰ï¼š</strong> å¤åˆ¶ä¸€ä»½å›¾ç‰‡ -&gt; ä½¿ç”¨ <code>ColorFiltered</code> å˜æˆçº¯é’è‰²å‰ªå½± -&gt; ä½¿ç”¨ <code>ImageFiltered</code> è¿›è¡Œå¼ºé«˜æ–¯æ¨¡ç³Šï¼Œè¿™åˆ›é€ äº†ä¸€ä¸ªä¸äººç‰©è½®å»“å®Œå…¨ä¸€è‡´çš„â€œèƒŒå…‰â€</li>
<li><strong>å±‚2ï¼ˆæœ¬ä½“ï¼‰ï¼š</strong> åŸå§‹å›¾ç‰‡è¦†ç›–åœ¨ä¸Šæ–¹</li>
</ul>

<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">Stack</span>(
 Â <span class="hljs-attribute">children</span>: [
 Â  Â <span class="hljs-comment">// 1. å‘å…‰å±‚ (Blur + ColorFilter)</span>
 Â  Â <span class="hljs-built_in">ImageFiltered</span>(
 Â  Â  Â <span class="hljs-attribute">imageFilter</span>: ui.ImageFilter.<span class="hljs-built_in">blur</span>(<span class="hljs-attribute">sigmaX</span>: <span class="hljs-number">20.0</span>, <span class="hljs-attribute">sigmaY</span>: <span class="hljs-number">20.0</span>),
 Â  Â  Â <span class="hljs-attribute">child</span>: <span class="hljs-built_in">ColorFiltered</span>(
 Â  Â  Â  Â <span class="hljs-attribute">colorFilter</span>: const ColorFilter.<span class="hljs-built_in">mode</span>(charGlowColor, BlendMode.srcIn),
 Â  Â  Â  Â <span class="hljs-attribute">child</span>: Image.<span class="hljs-built_in">asset</span>(...), <span class="hljs-comment">// å˜æˆå‘å…‰çš„å‰ªå½±</span>
 Â  Â   ),
 Â   ),
 Â  Â <span class="hljs-comment">// 2. åŸå§‹å›¾å±‚</span>
 Â  Â Image.<span class="hljs-built_in">asset</span>(...),
  ],
)
</code></pre>
<p>åŒæ—¶é˜µæ³•åœ¨å€’åœ°ä¹‹åï¼Œä¹ŸåŠ å¼ºäº†å…‰æ™•æ•ˆæœï¼Œé…åˆä»»åŠ¡å…‰æ™•ï¼Œè¿™å°±å½¢æˆäº†äººç‰©å’Œé˜µæ³•å…‰æ™•çš„èåˆï¼Œä¹Ÿå¢åŠ äº†ç«‹ä½“æ„Ÿï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dd5783509cb6454eb9a09f01d595992c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765753687&amp;x-signature=UnKjexiYXUbMZa5O%2BK3h9tNIt8M%3D" alt="ezgif-8ef07584660806c5.gif" loading="lazy"/></p>
<p>æœ€åï¼Œè¿˜æ˜¯æƒ³è¯´ï¼ŒAI çœŸçš„åœ¨å˜å¼ºï¼Œè€Œä¸”å˜å¼ºçš„é€Ÿåº¦è¶Šæ¥è¶Šå¿«ã€‚</p>
<h2 data-id="heading-8">ä»£ç é“¾æ¥</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCarGuo%2Fgsy_flutter_demo" target="_blank" title="https://github.com/CarGuo/gsy_flutter_demo" ref="nofollow noopener noreferrer">github.com/CarGuo/gsy_â€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Python è‡ªç”±çº¿ç¨‹å®ç°åŸç†æ·±åº¦è§£æ]]></title>    <link>https://juejin.cn/post/7580389111921573951</link>    <guid>https://juejin.cn/post/7580389111921573951</guid>    <pubDate>2025-12-07T16:06:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580389111921573951" data-draft-id="7580394927978528787" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Python è‡ªç”±çº¿ç¨‹å®ç°åŸç†æ·±åº¦è§£æ"/> <meta itemprop="keywords" content="åç«¯,Python"/> <meta itemprop="datePublished" content="2025-12-07T16:06:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Tsonglew"/> <meta itemprop="url" content="https://juejin.cn/user/1767670426116173"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Python è‡ªç”±çº¿ç¨‹å®ç°åŸç†æ·±åº¦è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1767670426116173/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Tsonglew
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T16:06:06.000Z" title="Sun Dec 07 2025 16:06:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»17åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç§»é™¤ GIL çš„æ ¸å¿ƒæŒ‘æˆ˜</h2>
<p>Python è‡ªç”±çº¿ç¨‹æ¨¡å¼çš„å®ç°å¹¶éç®€å•åœ°"å…³é—­"å…¨å±€è§£é‡Šå™¨é”(GIL)é‚£ä¹ˆç®€å•ã€‚GIL çš„å­˜åœ¨æœ‰å…¶æ·±åˆ»çš„æŠ€æœ¯åŸå› â€”â€”å®ƒä¿æŠ¤ç€ CPython æœ€æ ¸å¿ƒçš„å†…å­˜ç®¡ç†æœºåˆ¶:<strong>å¼•ç”¨è®¡æ•°</strong>(Reference Counting)ã€‚</p>
<p>CPython ä½¿ç”¨å¼•ç”¨è®¡æ•°æ¥è¿½è¸ªæ¯ä¸ªå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸã€‚æ¯ä¸ª <code>PyObject</code> éƒ½ç»´æŠ¤ç€ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨(<code>ob_refcnt</code>),å½“æœ‰æ–°çš„å¼•ç”¨æŒ‡å‘è¯¥å¯¹è±¡æ—¶è®¡æ•°åŠ  1,å½“å¼•ç”¨æ¶ˆå¤±æ—¶è®¡æ•°å‡ 1ã€‚ä¸€æ—¦è®¡æ•°å½’é›¶,å¯¹è±¡çš„å†…å­˜ç«‹å³è¢«é‡Šæ”¾ã€‚è¿™ä¸ªæœºåˆ¶ç®€å•é«˜æ•ˆ,ä½†å­˜åœ¨ä¸€ä¸ªè‡´å‘½é—®é¢˜:<strong>å®ƒä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„</strong>ã€‚</p>
<p>åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹,å¦‚æœä¸¤ä¸ªçº¿ç¨‹åŒæ—¶å¯¹åŒä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨è®¡æ•°è¿›è¡Œä¿®æ”¹(ä¾‹å¦‚ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ <code>+1</code>,å¦ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ <code>-1</code>),å°±ä¼šå‘ç”Ÿ<strong>ç«æ€æ¡ä»¶</strong>(race condition),å¯¼è‡´å¼•ç”¨è®¡æ•°ä¸å‡†ç¡®,è¿›è€Œå¼•å‘å†…å­˜æ³„æ¼æˆ–è¿‡æ—©é‡Šæ”¾,é€ æˆç¨‹åºå´©æºƒã€‚GIL é€šè¿‡ç¡®ä¿åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ Python ä»£ç ,ä»è€Œå·§å¦™åœ°å›é¿äº†è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>ä½† GIL ä¹Ÿä»˜å‡ºäº†å·¨å¤§ä»£ä»·:å®ƒä½¿å¾— Python æ— æ³•åœ¨å¤šæ ¸ CPU ä¸ŠçœŸæ­£å¹¶è¡Œæ‰§è¡Œ CPU å¯†é›†å‹ä»»åŠ¡ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fpeps.python.org%2Fpep-0703%2F" target="_blank" title="https://peps.python.org/pep-0703/" ref="nofollow noopener noreferrer">PEP 703</a> çš„æ ¸å¿ƒä»»åŠ¡,å°±æ˜¯åœ¨ç§»é™¤ GIL çš„åŒæ—¶,é‡æ–°è®¾è®¡å†…å­˜ç®¡ç†æœºåˆ¶,ç¡®ä¿åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„æ­£ç¡®æ€§ä¸æ€§èƒ½ã€‚è¿™æ¶‰åŠä¸€ç³»åˆ—ç²¾å¦™çš„æŠ€æœ¯åˆ›æ–°,å…¶ä¸­æœ€å…³é”®çš„ä¸‰é¡¹æŠ€æœ¯æ˜¯:<strong>åå‘å¼•ç”¨è®¡æ•°</strong>ã€<strong>å»¶è¿Ÿå¼•ç”¨è®¡æ•°</strong>å’Œ<strong>ä¸æœ½å¯¹è±¡</strong>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6cd3c4a3c0c24072a89c145c532da1d8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVHNvbmdsZXc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765728366&amp;x-signature=A89fDPz1h4grO%2BzD6aEZw%2Bc6qg8%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-1">åå‘å¼•ç”¨è®¡æ•°(Biased Reference Counting)</h2>
<h3 data-id="heading-2">æ ¸å¿ƒæ€æƒ³</h3>
<p>åå‘å¼•ç”¨è®¡æ•°(Biased Reference Counting, BRC)æ˜¯è‡ªç”±çº¿ç¨‹ Python çš„åŸºçŸ³æŠ€æœ¯ä¹‹ä¸€ã€‚å®ƒåŸºäºä¸€ä¸ªå…³é”®è§‚å¯Ÿ:<strong>å³ä½¿åœ¨å¤šçº¿ç¨‹ç¨‹åºä¸­,å¤§å¤šæ•°å¯¹è±¡å®é™…ä¸Šåªè¢«å•ä¸ªçº¿ç¨‹è®¿é—®å’Œä¿®æ”¹</strong>ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fpeps.python.org%2Fpep-0703%2F" target="_blank" title="https://peps.python.org/pep-0703/" ref="nofollow noopener noreferrer">citation</a> <a href="https://link.juejin.cn?target=https%3A%2F%2Fdev.to%2Fzackch%2Fpython-313-no-gil-what-you-need-to-know-352i" target="_blank" title="https://dev.to/zackch/python-313-no-gil-what-you-need-to-know-352i" ref="nofollow noopener noreferrer">citation</a></p>
<p>ä¼ ç»Ÿçš„çº¿ç¨‹å®‰å…¨å¼•ç”¨è®¡æ•°éœ€è¦ä½¿ç”¨åŸå­æ“ä½œ(atomic operations),æ¯æ¬¡ä¿®æ”¹å¼•ç”¨è®¡æ•°éƒ½éœ€è¦é€šè¿‡ç¡¬ä»¶çº§åˆ«çš„åŸå­æŒ‡ä»¤(å¦‚ x86 çš„ <code>LOCK INCR</code>)æ¥ç¡®ä¿çº¿ç¨‹å®‰å…¨ã€‚è¿™äº›åŸå­æ“ä½œè™½ç„¶å®‰å…¨,ä½†å¼€é”€å¾ˆå¤§,ä¼šå¯¼è‡´ CPU ç¼“å­˜å¤±æ•ˆã€å†…å­˜å±éšœå¼€é”€ç­‰æ€§èƒ½æŸå¤±ã€‚</p>
<p>åå‘å¼•ç”¨è®¡æ•°çš„æ ¸å¿ƒç­–ç•¥æ˜¯:<strong>ä¸ºæ¯ä¸ªå¯¹è±¡ç»´æŠ¤ä¸¤ä¸ªå¼•ç”¨è®¡æ•°</strong>:</p>
<ul>
<li><strong>æœ¬åœ°å¼•ç”¨è®¡æ•°</strong>(Local Reference Count):ç”±"æ‹¥æœ‰"è¯¥å¯¹è±¡çš„çº¿ç¨‹(é€šå¸¸æ˜¯åˆ›å»ºè¯¥å¯¹è±¡çš„çº¿ç¨‹)ç‹¬å ç»´æŠ¤,æ— éœ€ä»»ä½•åŒæ­¥æœºåˆ¶,å¯ä»¥åƒå•çº¿ç¨‹ç¨‹åºä¸€æ ·å¿«é€Ÿåœ°è¿›è¡Œ <code>+1</code> å’Œ <code>-1</code> æ“ä½œã€‚</li>
<li><strong>å…±äº«å¼•ç”¨è®¡æ•°</strong>(Shared Reference Count):è®°å½•æ‰€æœ‰å…¶ä»–çº¿ç¨‹å¯¹è¯¥å¯¹è±¡çš„å¼•ç”¨æ€»æ•°,ä½¿ç”¨åŸå­æ“ä½œç»´æŠ¤ã€‚</li>
</ul>
<h3 data-id="heading-3">å·¥ä½œæœºåˆ¶</h3>
<p>åœ¨ <code>PyObject</code> ç»“æ„ä¸­,å¼•ç”¨è®¡æ•°å­—æ®µè¢«é‡æ–°è®¾è®¡ã€‚åœ¨è‡ªç”±çº¿ç¨‹æ„å»ºä¸­,å¼•ç”¨è®¡æ•°è¢«æ‹†åˆ†ä¸ºä¸¤éƒ¨åˆ†ä¿¡æ¯:</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">object</span> {</span>
    <span class="hljs-comment">// ... å…¶ä»–å­—æ®µ</span>
    Py_ssize_t ob_ref_local;   <span class="hljs-comment">// æœ¬åœ°(åå‘)å¼•ç”¨è®¡æ•°</span>
    Py_ssize_t ob_ref_shared;  <span class="hljs-comment">// å…±äº«å¼•ç”¨è®¡æ•°(åŸå­æ“ä½œ)</span>
    <span class="hljs-comment">// ... å…¶ä»–å­—æ®µ</span>
} PyObject;
</code></pre>
<p>å½“<strong>æ‰€å±çº¿ç¨‹</strong>ä¿®æ”¹å¼•ç”¨è®¡æ•°æ—¶:</p>
<ul>
<li>ç›´æ¥ä¿®æ”¹ <code>ob_ref_local</code>,<strong>æ— éœ€åŸå­æ“ä½œ</strong>,é€Ÿåº¦æå¿«ã€‚</li>
</ul>
<p>å½“<strong>å…¶ä»–çº¿ç¨‹</strong>ä¿®æ”¹å¼•ç”¨è®¡æ•°æ—¶:</p>
<ul>
<li>ä½¿ç”¨åŸå­æ“ä½œä¿®æ”¹ <code>ob_ref_shared</code>ã€‚</li>
<li>å¦‚æœæ£€æµ‹åˆ°è·¨çº¿ç¨‹è®¿é—®,å¯¹è±¡ä¼šä»"åå‘æ¨¡å¼"é€€åŒ–ä¸º"å…±äº«æ¨¡å¼",åç»­æ‰€æœ‰æ“ä½œéƒ½ä½¿ç”¨åŸå­æ“ä½œã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e633006ff9a74705be95bee4f9fd9226~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVHNvbmdsZXc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765728366&amp;x-signature=L70ReiL2Wygv3iV8T4NFMx%2F9O3w%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-4">æ€§èƒ½ä¼˜åŠ¿</h3>
<p>åå‘å¼•ç”¨è®¡æ•°çš„æœ€å¤§ä¼˜åŠ¿åœ¨äº:<strong>å®ƒä¸ºå¸¸è§æƒ…å†µ(å•çº¿ç¨‹è®¿é—®å¯¹è±¡)æä¾›äº†é›¶å¼€é”€çš„æ€§èƒ½</strong>,åŒæ—¶åœ¨ç½•è§æƒ…å†µ(è·¨çº¿ç¨‹å…±äº«å¯¹è±¡)ä¸‹èƒ½å¤Ÿå®‰å…¨åœ°å›é€€åˆ°åŸå­æ“ä½œã€‚æ ¹æ® <a href="https://link.juejin.cn?target=https%3A%2F%2Fdl.acm.org%2Fdoi%2F10.1145%2F3243176.3243195" target="_blank" title="https://dl.acm.org/doi/10.1145/3243176.3243195" ref="nofollow noopener noreferrer">Choi ç­‰äººçš„ç ”ç©¶</a>,è¿™é¡¹æŠ€æœ¯æœ€åˆä¸º Swift è¯­è¨€è®¾è®¡,èƒ½å¤Ÿæ˜¾è‘—å‡å°‘å¤šçº¿ç¨‹ç¨‹åºä¸­ 70-90% çš„åŸå­æ“ä½œå¼€é”€ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.codingconfessions.com%2Fp%2Fcpython-garbage-collection-internals" target="_blank" title="https://blog.codingconfessions.com/p/cpython-garbage-collection-internals" ref="nofollow noopener noreferrer">citation</a></p>
<p>åœ¨å®é™…çš„ Python ç¨‹åºä¸­,å¤§é‡å¯¹è±¡(å¦‚å±€éƒ¨å˜é‡ã€ä¸´æ—¶è®¡ç®—ç»“æœ)åªåœ¨åˆ›å»ºå®ƒä»¬çš„çº¿ç¨‹å†…éƒ¨ä½¿ç”¨,åå‘å¼•ç”¨è®¡æ•°è®©è¿™äº›å¯¹è±¡çš„å†…å­˜ç®¡ç†å¼€é”€ä¸å•çº¿ç¨‹ Python å‡ ä¹ç›¸åŒã€‚</p>
<h2 data-id="heading-5">å»¶è¿Ÿå¼•ç”¨è®¡æ•°(Deferred Reference Counting)</h2>
<h3 data-id="heading-6">è®¾è®¡åŠ¨æœº</h3>
<p>å³ä½¿æœ‰äº†åå‘å¼•ç”¨è®¡æ•°,æŸäº›ç‰¹æ®Šå¯¹è±¡ä»ç„¶ä¼šæˆä¸ºæ€§èƒ½ç“¶é¢ˆã€‚ç‰¹åˆ«æ˜¯é‚£äº›<strong>è¢«å¤§é‡çº¿ç¨‹é¢‘ç¹è®¿é—®,ä½†å‡ ä¹æ°¸è¿œä¸ä¼šè¢«é”€æ¯</strong>çš„å¯¹è±¡,ä¾‹å¦‚:</p>
<ul>
<li>å‡½æ•°å¯¹è±¡(function objects)</li>
<li>ä»£ç å¯¹è±¡(code objects)</li>
<li>æ¨¡å—å¯¹è±¡(module objects)</li>
<li>ç±»å‹å¯¹è±¡(type objects)</li>
</ul>
<p>è¿™äº›å¯¹è±¡é€šå¸¸å­˜å‚¨åœ¨å…¨å±€å­—å…¸ä¸­,æ¯æ¬¡å‡½æ•°è°ƒç”¨ã€å±æ€§è®¿é—®éƒ½ä¼šå¯¼è‡´å¼•ç”¨è®¡æ•°çš„é¢‘ç¹å˜åŒ–ã€‚å³ä½¿ä½¿ç”¨åŸå­æ“ä½œ,åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹,è¿™äº›å¯¹è±¡çš„å¼•ç”¨è®¡æ•°å­—æ®µä¼šæˆä¸º<strong>çƒ­ç‚¹äº‰ç”¨</strong>(hot contention)â€”â€”å¤§é‡çº¿ç¨‹åŒæ—¶å°è¯•ä¿®æ”¹åŒä¸€å†…å­˜åœ°å€,å¯¼è‡´ CPU ç¼“å­˜ä¸æ–­å¤±æ•ˆ,æ€§èƒ½æ€¥å‰§ä¸‹é™ã€‚</p>
<p>å»¶è¿Ÿå¼•ç”¨è®¡æ•°(Deferred Reference Counting)é€šè¿‡ä¸€ä¸ªæ¿€è¿›çš„ç­–ç•¥è§£å†³è¿™ä¸ªé—®é¢˜:<strong>æš‚æ—¶ä¸æ›´æ–°è¿™äº›å¯¹è±¡çš„å¼•ç”¨è®¡æ•°</strong>,è€Œæ˜¯å°†å¼•ç”¨è®¡æ•°çš„ç»´æŠ¤å·¥ä½œæ¨è¿Ÿåˆ°åƒåœ¾å›æ”¶(GC)é˜¶æ®µç»Ÿä¸€å¤„ç†ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fpeps.python.org%2Fpep-0703%2F" target="_blank" title="https://peps.python.org/pep-0703/" ref="nofollow noopener noreferrer">citation</a> <a href="https://link.juejin.cn?target=https%3A%2F%2Flwn.net%2FArticles%2F872869%2F" target="_blank" title="https://lwn.net/Articles/872869/" ref="nofollow noopener noreferrer">citation</a></p>
<h3 data-id="heading-7">å®ç°æœºåˆ¶</h3>
<p>å»¶è¿Ÿå¼•ç”¨è®¡æ•°çš„æ ¸å¿ƒæ˜¯å°†å¼•ç”¨åˆ†ä¸ºä¸¤ç±»:</p>
<ol>
<li><strong>å †å¼•ç”¨</strong>(Heap References):å­˜å‚¨åœ¨å †åˆ†é…çš„å¯¹è±¡ä¸­çš„å¼•ç”¨,æ­£å¸¸è®¡æ•°ã€‚</li>
<li><strong>æ ˆå¼•ç”¨</strong>(Stack References):å­˜å‚¨åœ¨çº¿ç¨‹è°ƒç”¨æ ˆã€å±€éƒ¨å˜é‡ã€æ±‚å€¼æ ˆä¸­çš„å¼•ç”¨,<strong>ä¸è®¡æ•°</strong>ã€‚</li>
</ol>
<p>åœ¨ <code>PyObject</code> ç»“æ„ä¸­,ä½¿ç”¨å¼•ç”¨è®¡æ•°å­—æ®µçš„ç‰¹å®šä½æ¥æ ‡è®°å¯¹è±¡æ˜¯å¦å¯ç”¨å»¶è¿Ÿå¼•ç”¨è®¡æ•°:</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> _PyGC_BITS_DEFERRED  (1 &lt;&lt; 1)  <span class="hljs-comment">// ç¬¬äºŒä¸ªæœ€ä½ä½</span></span>

<span class="hljs-comment">// åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä½¿ç”¨å»¶è¿Ÿå¼•ç”¨è®¡æ•°</span>
<span class="hljs-keyword">if</span> (ob_ref_local &amp; _PyGC_BITS_DEFERRED) {
    <span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ªå»¶è¿Ÿå¼•ç”¨è®¡æ•°å¯¹è±¡</span>
    <span class="hljs-comment">// æ¥è‡ªæ ˆçš„å¼•ç”¨ä¸æ›´æ–°è®¡æ•°</span>
}
</code></pre>
<p>å½“ä¸€ä¸ªä½¿ç”¨å»¶è¿Ÿå¼•ç”¨è®¡æ•°çš„å¯¹è±¡è¢«è®¿é—®æ—¶:</p>
<ul>
<li><strong>ä»å †å¯¹è±¡å¼•ç”¨</strong>:æ­£å¸¸å¢å‡å¼•ç”¨è®¡æ•°(ä½¿ç”¨åŸå­æ“ä½œ)ã€‚</li>
<li><strong>ä»æ ˆå¸§å¼•ç”¨</strong>:ä¸ä¿®æ”¹å¼•ç”¨è®¡æ•°,é›¶å¼€é”€ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fca4ac1fe2d540cab276372ef722ba93~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVHNvbmdsZXc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765728366&amp;x-signature=fMdRwY0obE%2F1jIoIF%2F3MYjB1o3g%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-8">åƒåœ¾å›æ”¶é˜¶æ®µçš„å¤„ç†</h3>
<p>ç”±äºæ ˆå¼•ç”¨ä¸è®¡æ•°,å¯¹è±¡çš„å¼•ç”¨è®¡æ•°å­—æ®µåªåæ˜ <strong>éƒ¨åˆ†çœŸå®å¼•ç”¨</strong>:</p>
<pre><code class="hljs language-scss" lang="scss">çœŸå®å¼•ç”¨è®¡æ•° = è®¡æ•°çš„å¼•ç”¨ + å»¶è¿Ÿçš„å¼•ç”¨(æ ˆå¼•ç”¨)
</code></pre>
<p>åœ¨åƒåœ¾å›æ”¶é˜¶æ®µ,GC ä¼šæ‰§è¡Œä»¥ä¸‹æ­¥éª¤:</p>
<ol>
<li><strong>Stop-the-World</strong>:æš‚åœæ‰€æœ‰ Python çº¿ç¨‹ã€‚</li>
<li><strong>æ‰«ææ‰€æœ‰çº¿ç¨‹çš„æ ˆ</strong>:éå†æ¯ä¸ªçº¿ç¨‹çš„è°ƒç”¨æ ˆã€å±€éƒ¨å˜é‡ã€æ±‚å€¼æ ˆ,æ‰¾å‡ºæ‰€æœ‰å¯¹å»¶è¿Ÿå¼•ç”¨è®¡æ•°å¯¹è±¡çš„å¼•ç”¨ã€‚</li>
<li><strong>è®¡ç®—çœŸå®å¼•ç”¨è®¡æ•°</strong>:å°†æ ˆå¼•ç”¨æ•°é‡åŠ åˆ°å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ä¸Š,å¾—åˆ°å¯¹è±¡çš„çœŸå®å¼•ç”¨è®¡æ•°ã€‚</li>
<li><strong>å›æ”¶ä¸å¯è¾¾å¯¹è±¡</strong>:å¼•ç”¨è®¡æ•°ä¸ºé›¶çš„å¯¹è±¡è¢«æ ‡è®°ä¸ºå¯å›æ”¶ã€‚</li>
</ol>
<p>è¿™ä¸ªè®¾è®¡çš„å·§å¦™ä¹‹å¤„åœ¨äº:<strong>å°†é«˜é¢‘æ“ä½œ(å¼•ç”¨è®¡æ•°ä¿®æ”¹)çš„å¼€é”€è½¬ç§»åˆ°ä½é¢‘æ“ä½œ(åƒåœ¾å›æ”¶)</strong> ,å¤§å¹…å‡å°‘äº†çƒ­ç‚¹å¯¹è±¡çš„äº‰ç”¨é—®é¢˜ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fmail.python.org%2Farchives%2Flist%2Fpython-dev%40python.org%2Fmessage%2FYJDRVOUSRVGCZTKIL7ZUJ6ITVWZTC246%2F" target="_blank" title="https://mail.python.org/archives/list/python-dev@python.org/message/YJDRVOUSRVGCZTKIL7ZUJ6ITVWZTC246/" ref="nofollow noopener noreferrer">citation</a></p>
<h3 data-id="heading-9">å“ªäº›å¯¹è±¡ä½¿ç”¨å»¶è¿Ÿå¼•ç”¨è®¡æ•°</h3>
<p>æ ¹æ® PEP 703 å’Œç›¸å…³å®ç°,ä»¥ä¸‹ç±»å‹çš„å¯¹è±¡é»˜è®¤å¯ç”¨å»¶è¿Ÿå¼•ç”¨è®¡æ•°:</p>
<ul>
<li>å‡½æ•°å¯¹è±¡(<code>PyFunctionObject</code>)</li>
<li>ä»£ç å¯¹è±¡(<code>PyCodeObject</code>)</li>
<li>æ¨¡å—å¯¹è±¡(<code>PyModuleObject</code>)</li>
<li>æ–¹æ³•å¯¹è±¡(<code>PyMethodObject</code>)</li>
<li>å †ç±»å‹å¯¹è±¡(Heap Type Objects)</li>
</ul>
<p>è¿™äº›å¯¹è±¡çš„å…±åŒç‰¹ç‚¹æ˜¯:<strong>ç”Ÿå‘½å‘¨æœŸé•¿ã€è¢«é¢‘ç¹è®¿é—®ã€å¾ˆå°‘è¢«é”€æ¯</strong>ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fissues%2F117376" target="_blank" title="https://github.com/python/cpython/issues/117376" ref="nofollow noopener noreferrer">citation</a> <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fpython%2Fcpython%2Fissues%2F122417" target="_blank" title="https://github.com/python/cpython/issues/122417" ref="nofollow noopener noreferrer">citation</a></p>
<h2 data-id="heading-10">ä¸æœ½å¯¹è±¡(Immortal Objects)</h2>
<h3 data-id="heading-11">æ°¸ç”ŸåŒ–çš„æ¦‚å¿µ</h3>
<p>ä¸æœ½å¯¹è±¡(Immortal Objects,æˆ–ç§°"æ°¸ç”Ÿå¯¹è±¡")æ˜¯è‡ªç”±çº¿ç¨‹å®ç°ä¸­çš„ç¬¬ä¸‰é¡¹å…³é”®æŠ€æœ¯ã€‚å®ƒé’ˆå¯¹çš„æ˜¯<strong>ç”Ÿå‘½å‘¨æœŸä¸è§£é‡Šå™¨ç›¸åŒçš„å…¨å±€å¯¹è±¡</strong>,ä¾‹å¦‚:</p>
<ul>
<li>å†…ç½®ç±»å‹å¯¹è±¡(<code>int</code>ã€<code>str</code>ã€<code>list</code> ç­‰)</li>
<li>å•ä¾‹å¯¹è±¡(<code>None</code>ã€<code>True</code>ã€<code>False</code>)</li>
<li>å°æ•´æ•°æ± (<code>-5</code> åˆ° <code>256</code> çš„æ•´æ•°)</li>
<li>å†…ç½®å‡½æ•°å’Œæ¨¡å—</li>
</ul>
<p>è¿™äº›å¯¹è±¡åœ¨æ•´ä¸ªç¨‹åºè¿è¡ŒæœŸé—´éƒ½ä¸åº”è¯¥è¢«é”€æ¯ã€‚ä¼ ç»Ÿ CPython é€šè¿‡éå¸¸é«˜çš„åˆå§‹å¼•ç”¨è®¡æ•°(å¦‚ <code>Py_REFCNT_IMMORTAL = INT_MAX</code>)æ¥"ä¼ªé€ "æ°¸ç”Ÿæ•ˆæœ,ä½†åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹,å³ä½¿æ˜¯è¯»å–è¿™äº›å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ä¹Ÿå¯èƒ½å¯¼è‡´ç¼“å­˜äº‰ç”¨ã€‚</p>
<p>è‡ªç”±çº¿ç¨‹çš„è§£å†³æ–¹æ¡ˆæ˜¯:<strong>åœ¨å¼•ç”¨è®¡æ•°å­—æ®µä¸­è®¾ç½®ç‰¹æ®Šæ ‡è®°,è®©æ‰€æœ‰å¼•ç”¨è®¡æ•°æ“ä½œéƒ½è·³è¿‡è¿™äº›å¯¹è±¡</strong>ã€‚</p>
<h3 data-id="heading-12">åœ¨ Python 3.13 ä¸­çš„å®ç°</h3>
<p>åœ¨ Python 3.13 çš„è‡ªç”±çº¿ç¨‹æ„å»ºä¸­,ä¸æœ½å¯¹è±¡é€šè¿‡è®¾ç½®å¼•ç”¨è®¡æ•°çš„æœ€é«˜ä½æ¥æ ‡è®°:</p>
<pre><code class="hljs language-C" lang="C"><span class="hljs-meta">#<span class="hljs-keyword">define</span> _Py_IMMORTAL_REFCNT_BIT  (1UL &lt;&lt; (sizeof(Py_ssize_t) * 8 - 1))</span>

<span class="hljs-comment">// æ ‡è®°å¯¹è±¡ä¸ºä¸æœ½</span>
ob-&gt;ob_ref_local |= _Py_IMMORTAL_REFCNT_BIT;

<span class="hljs-comment">// æ£€æŸ¥å¯¹è±¡æ˜¯å¦ä¸æœ½</span>
<span class="hljs-keyword">if</span> (ob-&gt;ob_ref_local &amp; _Py_IMMORTAL_REFCNT_BIT) {
    <span class="hljs-comment">// è·³è¿‡å¼•ç”¨è®¡æ•°æ“ä½œ</span>
    <span class="hljs-keyword">return</span>;
}
</code></pre>
<p>è¿™ä¸ªè®¾è®¡éå¸¸é«˜æ•ˆ:æ¯æ¬¡å¼•ç”¨è®¡æ•°æ“ä½œåªéœ€ä¸€æ¬¡ä½æµ‹è¯•,å°±å¯ä»¥å†³å®šæ˜¯å¦è·³è¿‡æ“ä½œã€‚</p>
<p><strong>å‰¯ä½œç”¨</strong>:åœ¨ Python 3.13 ä¸­,è®¸å¤šå¯¹è±¡è¢«æ¿€è¿›åœ°æ ‡è®°ä¸ºä¸æœ½,åŒ…æ‹¬å‡½æ•°å¯¹è±¡ã€ç±»å¯¹è±¡ç­‰ã€‚è¿™å¯¼è‡´è¿™äº›å¯¹è±¡å³ä½¿ä¸å†è¢«ä½¿ç”¨ä¹Ÿä¸ä¼šè¢«å›æ”¶,å¯èƒ½å¯¼è‡´<strong>å†…å­˜ä½¿ç”¨å¢åŠ </strong>ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.python.org%2F3%2Fhowto%2Ffree-threading-python.html" target="_blank" title="https://docs.python.org/3/howto/free-threading-python.html" ref="nofollow noopener noreferrer">citation</a></p>
<h3 data-id="heading-13">åœ¨ Python 3.14 ä¸­çš„æ”¹è¿›</h3>
<p>Python 3.14 é€šè¿‡ä¸å»¶è¿Ÿå¼•ç”¨è®¡æ•°çš„æ·±åº¦é›†æˆ,æ˜¾è‘—å‡å°‘äº†éœ€è¦æ°¸ç”ŸåŒ–çš„å¯¹è±¡æ•°é‡:</p>
<ul>
<li>å¤§å¤šæ•°å‡½æ•°ã€ç±»å¯¹è±¡ä¸å†éœ€è¦æ°¸ç”ŸåŒ–,è€Œæ˜¯ä½¿ç”¨å»¶è¿Ÿå¼•ç”¨è®¡æ•°ã€‚</li>
<li>åªæœ‰çœŸæ­£çš„å…¨å±€å•ä¾‹å¯¹è±¡(å¦‚ <code>None</code>ã€å†…ç½®ç±»å‹)ä¿æŒä¸æœ½çŠ¶æ€ã€‚</li>
</ul>
<p>è¿™ä¸€æ”¹è¿›å¤§å¹…é™ä½äº†å†…å­˜å ç”¨,åŒæ—¶ä¿æŒäº†æ€§èƒ½ä¼˜åŠ¿ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fpeps.python.org%2Fpep-0703%2F" target="_blank" title="https://peps.python.org/pep-0703/" ref="nofollow noopener noreferrer">citation</a></p>
<h2 data-id="heading-14">å†…å­˜åˆ†é…å™¨çš„å˜é©:ä» pymalloc åˆ° mimalloc</h2>
<h3 data-id="heading-15">ä¸ºä»€ä¹ˆè¦æ›´æ¢åˆ†é…å™¨</h3>
<p>ä¼ ç»Ÿ CPython ä½¿ç”¨ <code>pymalloc</code> ä½œä¸ºå°å¯¹è±¡å†…å­˜åˆ†é…å™¨ã€‚<code>pymalloc</code> é’ˆå¯¹å•çº¿ç¨‹ç¯å¢ƒä¼˜åŒ–,é€šè¿‡å†…å­˜æ± (memory pool)æŠ€æœ¯å‡å°‘ç³»ç»Ÿè°ƒç”¨å¼€é”€,æ€§èƒ½ä¼˜å¼‚ã€‚ä½†å®ƒæœ‰ä¸€ä¸ªè‡´å‘½ç¼ºé™·:<strong>ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„</strong>ã€‚</p>
<p>åœ¨è‡ªç”±çº¿ç¨‹ç¯å¢ƒä¸‹,å¤šä¸ªçº¿ç¨‹å¯èƒ½åŒæ—¶åˆ†é…å’Œé‡Šæ”¾å†…å­˜ã€‚ä¸ºäº†ä¿è¯ <code>pymalloc</code> çš„çº¿ç¨‹å®‰å…¨,éœ€è¦ä¸ºæ•´ä¸ªåˆ†é…å™¨åŠ é”,è¿™ä¼šå¯¼è‡´ä¸¥é‡çš„æ€§èƒ½ç“¶é¢ˆâ€”â€”å†…å­˜åˆ†é…å™¨ä¼šæˆä¸ºæ–°çš„"å…¨å±€é”"ã€‚</p>
<h3 data-id="heading-16">mimalloc çš„ä¼˜åŠ¿</h3>
<p>PEP 703 é€‰æ‹©äº† <strong>mimalloc</strong>(pronounced "me-malloc")ä½œä¸ºè‡ªç”±çº¿ç¨‹æ„å»ºçš„é»˜è®¤åˆ†é…å™¨ã€‚mimalloc æ˜¯å¾®è½¯ç ”ç©¶é™¢ä¸º Koka å’Œ Lean è¯­è¨€å¼€å‘çš„é«˜æ€§èƒ½åˆ†é…å™¨,å…·æœ‰ä»¥ä¸‹ç‰¹æ€§:</p>
<ol>
<li><strong>çº¿ç¨‹å®‰å…¨ä¸”æ— é”</strong>:æ¯ä¸ªçº¿ç¨‹æ‹¥æœ‰ç‹¬ç«‹çš„å†…å­˜æ± ,å¤§å¤šæ•°åˆ†é…æ“ä½œæ— éœ€å…¨å±€åŒæ­¥ã€‚</li>
<li><strong>ç¼“å­˜å‹å¥½</strong>:åˆ©ç”¨ç°ä»£ CPU çš„ç¼“å­˜å±‚æ¬¡ç»“æ„,å‡å°‘ç¼“å­˜ç¼ºå¤±ã€‚</li>
<li><strong>ä½ç¢ç‰‡ç‡</strong>:é€šè¿‡æ™ºèƒ½çš„åˆ†é…ç­–ç•¥,å‡å°‘å†…å­˜ç¢ç‰‡ã€‚</li>
<li><strong>æˆç†Ÿç¨³å®š</strong>:å·²åœ¨å¤šä¸ªç”Ÿäº§ç¯å¢ƒä¸­éªŒè¯,æ€§èƒ½å’Œå¯é æ€§æœ‰ä¿éšœã€‚</li>
</ol>
<p>é€šè¿‡åˆ‡æ¢åˆ° mimalloc,è‡ªç”±çº¿ç¨‹ Python åœ¨å¤šçº¿ç¨‹åœºæ™¯ä¸‹çš„å†…å­˜åˆ†é…æ€§èƒ½å¤§å¹…æå‡,é¿å…äº†å†…å­˜åˆ†é…å™¨æˆä¸ºæ–°çš„ç“¶é¢ˆã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2F2025.ploneconf.org%2Fschedule%2Ftalks%2Fnogil-diving-into-cpython-3-14s-free-threaded-future" target="_blank" title="https://2025.ploneconf.org/schedule/talks/nogil-diving-into-cpython-3-14s-free-threaded-future" ref="nofollow noopener noreferrer">citation</a> <a href="https://link.juejin.cn?target=https%3A%2F%2Flwn.net%2FArticles%2F872869%2F" target="_blank" title="https://lwn.net/Articles/872869/" ref="nofollow noopener noreferrer">citation</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bbc26755a94048debb180c5015e41f24~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVHNvbmdsZXc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765728366&amp;x-signature=xju69BEUYvqWdx%2BqzEWbhmnq8qU%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-17">é…ç½®æ–¹å¼</h3>
<p>åœ¨è‡ªç”±çº¿ç¨‹æ„å»ºä¸­,mimalloc æ˜¯é»˜è®¤å¯ç”¨çš„:</p>
<pre><code class="hljs language-Bash" lang="Bash">./configure --disable-gil
make
</code></pre>
<p>ç”¨æˆ·æ— éœ€é¢å¤–é…ç½®,æ„å»ºç³»ç»Ÿä¼šè‡ªåŠ¨é“¾æ¥ mimalloc åº“ã€‚</p>
<h2 data-id="heading-18">å†…ç½®ç±»å‹çš„å†…éƒ¨é”æœºåˆ¶</h2>
<h3 data-id="heading-19">çº¿ç¨‹å®‰å…¨çš„æŒ‘æˆ˜</h3>
<p>ç§»é™¤ GIL å,Python å†…ç½®ç±»å‹(å¦‚ <code>dict</code>ã€<code>list</code>ã€<code>set</code>)çš„çº¿ç¨‹å®‰å…¨æˆä¸ºæ–°çš„æŒ‘æˆ˜ã€‚è¿™äº›ç±»å‹çš„å†…éƒ¨æ•°æ®ç»“æ„(å“ˆå¸Œè¡¨ã€åŠ¨æ€æ•°ç»„)åœ¨å¹¶å‘ä¿®æ”¹æ—¶å®¹æ˜“å‡ºç°æ•°æ®ä¸ä¸€è‡´ã€å†…å­˜æŸåç­‰é—®é¢˜ã€‚</p>
<h3 data-id="heading-20">ç»†ç²’åº¦é”çš„è®¾è®¡</h3>
<p>è‡ªç”±çº¿ç¨‹ Python ä¸ºè¿™äº›å†…ç½®ç±»å‹å¼•å…¥äº†<strong>ç»†ç²’åº¦çš„å†…éƒ¨é”</strong>ã€‚æ¯ä¸ªå®¹å™¨å¯¹è±¡éƒ½æ‹¥æœ‰è‡ªå·±çš„é”,ç”¨äºä¿æŠ¤å…¶å†…éƒ¨çŠ¶æ€:</p>
<pre><code class="hljs language-C" lang="C"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> {</span>
    PyObject_HEAD
    Py_ssize_t ob_size;
    PyObject **ob_item;
    PyMutex lock;  <span class="hljs-comment">// æ¯ä¸ª list å¯¹è±¡ç‹¬æœ‰çš„é”</span>
} PyListObject;
</code></pre>
<p>å…³é”®æ“ä½œ(å¦‚å…ƒç´ æ’å…¥ã€åˆ é™¤ã€æŸ¥æ‰¾)ä¼šè‡ªåŠ¨è·å–å’Œé‡Šæ”¾è¿™äº›å†…éƒ¨é”:</p>
<pre><code class="hljs language-C" lang="C">PyObject* <span class="hljs-title function_">PyList_GetItem</span><span class="hljs-params">(PyObject *op, Py_ssize_t i)</span> {
    PyListObject *<span class="hljs-built_in">list</span> = (PyListObject *)op;
    
    PyMutex_Lock(&amp;<span class="hljs-built_in">list</span>-&gt;lock);  <span class="hljs-comment">// è·å–é”</span>
    PyObject *item = <span class="hljs-built_in">list</span>-&gt;ob_item[i];
    Py_INCREF(item);
    PyMutex_Unlock(&amp;<span class="hljs-built_in">list</span>-&gt;lock);  <span class="hljs-comment">// é‡Šæ”¾é”</span>
    
    <span class="hljs-keyword">return</span> item;
}
</code></pre>
<h3 data-id="heading-21">é”çš„è®¾è®¡å€Ÿé‰´ WebKit</h3>
<p>CPython çš„å†…éƒ¨é”å®ç°å—åˆ°äº† <strong>WebKit</strong> æµè§ˆå™¨å¼•æ“çš„å¯å‘ã€‚WebKit åœ¨å¤šçº¿ç¨‹æ¸²æŸ“å¼•æ“ä¸­ä½¿ç”¨äº†é«˜æ•ˆçš„é”æœºåˆ¶,èƒ½å¤Ÿåœ¨ä½äº‰ç”¨åœºæ™¯ä¸‹æä¾›æ¥è¿‘æ— é”çš„æ€§èƒ½,åœ¨é«˜äº‰ç”¨åœºæ™¯ä¸‹ä¿è¯å…¬å¹³æ€§ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Flwn.net%2FArticles%2F872869%2F" target="_blank" title="https://lwn.net/Articles/872869/" ref="nofollow noopener noreferrer">citation</a></p>
<p>æ ¸å¿ƒç‰¹ç‚¹:</p>
<ul>
<li><strong>è‡ªé€‚åº”è‡ªæ—‹é”</strong>:åœ¨çŸ­æš‚ç­‰å¾…æ—¶ä½¿ç”¨å¿™ç­‰å¾…(busy-waiting),é¿å…çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ã€‚</li>
<li><strong>å¿«é€Ÿè·¯å¾„ä¼˜åŒ–</strong>:æ— äº‰ç”¨æ—¶çš„è·å–/é‡Šæ”¾æ“ä½œåªéœ€å°‘é‡åŸå­æ“ä½œã€‚</li>
<li><strong>å…¬å¹³æ€§ä¿è¯</strong>:é•¿æ—¶é—´ç­‰å¾…æ—¶é€€åŒ–ä¸ºæ“ä½œç³»ç»Ÿçº§äº’æ–¥é”,é¿å…é¥¥é¥¿ã€‚</li>
</ul>
<h3 data-id="heading-22">è¡Œä¸ºä¸€è‡´æ€§</h3>
<p>é‡è¦çš„æ˜¯,è‡ªç”±çº¿ç¨‹ Python <strong>å¹¶ä¸ä¿è¯å†…ç½®ç±»å‹åœ¨å¹¶å‘ä¿®æ”¹ä¸‹çš„ç‰¹å®šè¡Œä¸º</strong>ã€‚å®˜æ–¹æ–‡æ¡£æ˜ç¡®æŒ‡å‡º:Python å†å²ä¸Šä»æœªå¯¹å¹¶å‘ä¿®æ”¹è¿™äº›ç±»å‹çš„è¡Œä¸ºæä¾›ä¿è¯,å¼€å‘è€…ä¸åº”ä¾èµ–å½“å‰çš„å®ç°ç»†èŠ‚ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.python.org%2F3%2Fhowto%2Ffree-threading-python.html" target="_blank" title="https://docs.python.org/3/howto/free-threading-python.html" ref="nofollow noopener noreferrer">citation</a></p>
<p>è¿™æ„å‘³ç€,è™½ç„¶å†…éƒ¨é”ä¿è¯äº†ä¸ä¼šå‡ºç°å†…å­˜æŸåæˆ–å´©æºƒ,ä½†å¹¶å‘ä¿®æ”¹ <code>dict</code> æˆ– <code>list</code> çš„ç»“æœå¯èƒ½æ˜¯<strong>æœªå®šä¹‰çš„</strong>ã€‚å¼€å‘è€…ä»éœ€ä½¿ç”¨æ˜¾å¼çš„åŒæ­¥æœºåˆ¶(å¦‚ <code>threading.Lock</code>)æ¥ä¿æŠ¤å…±äº«å¯å˜çŠ¶æ€ã€‚</p>
<h2 data-id="heading-23">åƒåœ¾å›æ”¶å™¨çš„é‡æ–°è®¾è®¡</h2>
<h3 data-id="heading-24">ä¼ ç»Ÿåˆ†ä»£å›æ”¶çš„å±€é™</h3>
<p>CPython ä¼ ç»Ÿçš„åƒåœ¾å›æ”¶å™¨é‡‡ç”¨<strong>åˆ†ä»£å›æ”¶</strong>(generational GC)ç­–ç•¥,åŸºäº"å¼±ä»£å‡è®¾"(weak generational hypothesis):å¤§å¤šæ•°å¯¹è±¡åœ¨å¹´è½»æ—¶å°±ä¼šæ­»äº¡ã€‚å¯¹è±¡è¢«åˆ†ä¸ºä¸‰ä»£(generation 0ã€1ã€2),å¹´è½»ä»£çš„å›æ”¶é¢‘ç‡è¿œé«˜äºè€å¹´ä»£ã€‚</p>
<p>ä½†åœ¨è‡ªç”±çº¿ç¨‹ç¯å¢ƒä¸‹,åˆ†ä»£å›æ”¶é¢ä¸´æ–°çš„æŒ‘æˆ˜:</p>
<ul>
<li>å¯¹è±¡åœ¨ä¸åŒçº¿ç¨‹é—´ä¼ é€’æ—¶,å…¶"å¹´é¾„"çš„æ¦‚å¿µå˜å¾—æ¨¡ç³Šã€‚</li>
<li>å»¶è¿Ÿå¼•ç”¨è®¡æ•°ä½¿å¾—æŸäº›å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸåˆ¤æ–­å˜å¾—å¤æ‚ã€‚</li>
<li>åˆ†ä»£å›æ”¶éœ€è¦æ‰«æè·¨ä»£å¼•ç”¨,åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å¼€é”€å¾ˆå¤§ã€‚</li>
</ul>
<h3 data-id="heading-25">æ–°çš„ Stop-the-World GC</h3>
<p>è‡ªç”±çº¿ç¨‹æ„å»ºé‡‡ç”¨äº†æ›´ç®€æ´çš„åƒåœ¾å›æ”¶ç­–ç•¥:<strong>Stop-the-World + ç²¾ç¡®å¼•ç”¨è®¡æ•°æ‰«æ</strong>ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2F2025.ploneconf.org%2Fschedule%2Ftalks%2Fnogil-diving-into-cpython-3-14s-free-threaded-future" target="_blank" title="https://2025.ploneconf.org/schedule/talks/nogil-diving-into-cpython-3-14s-free-threaded-future" ref="nofollow noopener noreferrer">citation</a></p>
<p>æ ¸å¿ƒæµç¨‹:</p>
<ol>
<li><strong>æš‚åœæ‰€æœ‰çº¿ç¨‹</strong>:ä½¿ç”¨ç±»ä¼¼ Go è¯­è¨€çš„"å®‰å…¨ç‚¹"(safepoint)æœºåˆ¶,ç¡®ä¿æ‰€æœ‰çº¿ç¨‹åœ¨å®‰å…¨çŠ¶æ€ä¸‹æš‚åœã€‚</li>
<li><strong>æ‰«ææ‰€æœ‰çº¿ç¨‹çš„æ ˆ</strong>:éå†æ¯ä¸ªçº¿ç¨‹çš„è°ƒç”¨æ ˆã€å±€éƒ¨å˜é‡ã€æ±‚å€¼æ ˆ,æ‰¾å‡ºæ‰€æœ‰æ´»è·ƒå¼•ç”¨ã€‚</li>
<li><strong>è®¡ç®—ç²¾ç¡®å¼•ç”¨è®¡æ•°</strong>:ç»“åˆåå‘å¼•ç”¨è®¡æ•°ã€å»¶è¿Ÿå¼•ç”¨è®¡æ•°å’Œæ ˆæ‰«æç»“æœ,è®¡ç®—æ¯ä¸ªå¯¹è±¡çš„çœŸå®å¼•ç”¨è®¡æ•°ã€‚</li>
<li><strong>å›æ”¶ä¸å¯è¾¾å¯¹è±¡</strong>:å¼•ç”¨è®¡æ•°ä¸ºé›¶çš„å¯¹è±¡è¢«å›æ”¶,å…¶å†…å­˜è¢«é‡Šæ”¾ã€‚</li>
<li><strong>æ¢å¤æ‰€æœ‰çº¿ç¨‹</strong>:GC å®Œæˆå,æ‰€æœ‰çº¿ç¨‹æ¢å¤æ‰§è¡Œã€‚</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/744f59b01b83438abd5673cdfe31f4a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVHNvbmdsZXc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765728366&amp;x-signature=mOBHe07oLgn7d8%2B4EhDhLyj%2Buyo%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-26">QSBR(Quiescent State Based Reclamation)</h3>
<p>ä¸ºäº†å‡å°‘ GC æš‚åœæ—¶é—´,è‡ªç”±çº¿ç¨‹ Python å¼•å…¥äº† <strong>QSBR</strong> æŠ€æœ¯,è¿™æ˜¯ä¸€ç§æºè‡ª FreeBSD çš„å†…å­˜å›æ”¶ç­–ç•¥ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Flwn.net%2FArticles%2F872869%2F" target="_blank" title="https://lwn.net/Articles/872869/" ref="nofollow noopener noreferrer">citation</a></p>
<p>QSBR çš„æ ¸å¿ƒæ€æƒ³:<strong>å¦‚æœä¸€ä¸ªå¯¹è±¡åœ¨æ‰€æœ‰çº¿ç¨‹éƒ½ç»å†äº†è‡³å°‘ä¸€æ¬¡"é™é»˜æœŸ"(quiescent state)åæ‰è¢«å›æ”¶,é‚£ä¹ˆå¯ä»¥ä¿è¯æ²¡æœ‰çº¿ç¨‹æ­£åœ¨è®¿é—®è¯¥å¯¹è±¡</strong>ã€‚</p>
<p>è¿™å…è®¸ GC å»¶è¿ŸæŸäº›å¯¹è±¡çš„å®é™…å†…å­˜é‡Šæ”¾,å°†å›æ”¶å·¥ä½œåˆ†æ•£åˆ°å¤šä¸ª GC å‘¨æœŸ,å‡å°‘å•æ¬¡ GC çš„æš‚åœæ—¶é—´ã€‚</p>
<h3 data-id="heading-27">æ”¾å¼ƒåˆ†ä»£å‡è®¾</h3>
<p>ä¸ä¼ ç»Ÿçš„ä¸‰ä»£å›æ”¶ä¸åŒ,è‡ªç”±çº¿ç¨‹ GC <strong>ä¸å†åŒºåˆ†å¯¹è±¡ä»£é™…</strong>,æ‰€æœ‰å¯¹è±¡éƒ½å¹³ç­‰å¯¹å¾…ã€‚è¿™ç®€åŒ–äº†å®ç°,å‡å°‘äº†è·¨ä»£å¼•ç”¨çš„æ‰«æå¼€é”€,ä¸”åœ¨å®é™…æµ‹è¯•ä¸­,æ€§èƒ½å¹¶æœªæ˜¾è‘—ä¸‹é™ã€‚</p>
<h2 data-id="heading-28">ä¸“ç”¨è‡ªé€‚åº”è§£é‡Šå™¨(PEP 659)çš„å–èˆ</h2>
<h3 data-id="heading-29">PEP 659 çš„èƒŒæ™¯</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fpeps.python.org%2Fpep-0659%2F" target="_blank" title="https://peps.python.org/pep-0659/" ref="nofollow noopener noreferrer">PEP 659</a> å¼•å…¥äº†<strong>ä¸“ç”¨è‡ªé€‚åº”è§£é‡Šå™¨</strong>(Specializing Adaptive Interpreter),æ˜¯ Python 3.11 çš„é‡å¤§æ€§èƒ½çªç ´ã€‚å®ƒé€šè¿‡åœ¨è¿è¡Œæ—¶è§‚å¯Ÿä»£ç çš„å®é™…ç±»å‹,å°†é€šç”¨å­—èŠ‚ç æŒ‡ä»¤"ä¸“åŒ–"(specialize)ä¸ºé’ˆå¯¹ç‰¹å®šç±»å‹ä¼˜åŒ–çš„å¿«é€ŸæŒ‡ä»¤ã€‚</p>
<p>ä¾‹å¦‚,é€šç”¨çš„ <code>BINARY_ADD</code> æŒ‡ä»¤å¯èƒ½è¢«ä¸“åŒ–ä¸º:</p>
<ul>
<li><code>BINARY_ADD_INT</code>:ä¸“é—¨å¤„ç†æ•´æ•°åŠ æ³•,è·³è¿‡ç±»å‹æ£€æŸ¥ã€‚</li>
<li><code>BINARY_ADD_FLOAT</code>:ä¸“é—¨å¤„ç†æµ®ç‚¹æ•°åŠ æ³•ã€‚</li>
<li><code>BINARY_ADD_UNICODE</code>:ä¸“é—¨å¤„ç†å­—ç¬¦ä¸²æ‹¼æ¥ã€‚</li>
</ul>
<p>è¿™é¡¹æŠ€æœ¯åœ¨ Python 3.11 å’Œ 3.12 ä¸­å¸¦æ¥äº† 10-25% çš„æ€§èƒ½æå‡ã€‚</p>
<h3 data-id="heading-30">åœ¨ Python 3.13 ä¸­è¢«ç¦ç”¨</h3>
<p>ç„¶è€Œ,åœ¨ Python 3.13 çš„è‡ªç”±çº¿ç¨‹æ„å»ºä¸­,PEP 659 <strong>è¢«å®Œå…¨ç¦ç”¨</strong>ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.python.org%2F3.13%2Fhowto%2Ffree-threading-python.html" target="_blank" title="https://docs.python.org/3.13/howto/free-threading-python.html" ref="nofollow noopener noreferrer">citation</a> åŸå› æœ‰äºŒ:</p>
<ol>
<li><strong>çº¿ç¨‹å®‰å…¨é—®é¢˜</strong>:ä¸“åŒ–çš„å­—èŠ‚ç ç¼“å­˜(inline cache)æ˜¯å¯å˜çš„,å¤šä¸ªçº¿ç¨‹å¯èƒ½åŒæ—¶è¯»å†™åŒä¸€ä¸ªç¼“å­˜æ¡ç›®,éœ€è¦å¤æ‚çš„åŒæ­¥æœºåˆ¶ã€‚</li>
<li><strong>å®ç°ä¼˜å…ˆçº§</strong>:ä¸ºäº†å°½å¿«æ¨å‡ºè‡ªç”±çº¿ç¨‹çš„å®éªŒç‰ˆæœ¬,å›¢é˜Ÿå†³å®šå…ˆç¦ç”¨è¿™ä¸€ç‰¹æ€§,ä¸“æ³¨äºæ ¸å¿ƒçš„ GIL ç§»é™¤å·¥ä½œã€‚</li>
</ol>
<p>è¿™å¯¼è‡´è‡ªç”±çº¿ç¨‹ Python 3.13 çš„<strong>å•çº¿ç¨‹æ€§èƒ½ä¸‹é™çº¦ 40%</strong> ,è¿™æ˜¯ä¸€ä¸ªå·¨å¤§çš„ä»£ä»·ã€‚</p>
<h3 data-id="heading-31">åœ¨ Python 3.14 ä¸­é‡æ–°å¯ç”¨</h3>
<p>ç»è¿‡ä¸€å¹´çš„åŠªåŠ›,Python 3.14 æˆåŠŸ<strong>é‡æ–°å¯ç”¨äº†ä¸“ç”¨è‡ªé€‚åº”è§£é‡Šå™¨</strong>,åŒæ—¶ä¿æŒçº¿ç¨‹å®‰å…¨ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.python.org%2F3%2Fwhatsnew%2F3.14.html" target="_blank" title="https://docs.python.org/3/whatsnew/3.14.html" ref="nofollow noopener noreferrer">citation</a> æŠ€æœ¯è¦ç‚¹:</p>
<ul>
<li><strong>çº¿ç¨‹æœ¬åœ°ç¼“å­˜</strong>:æ¯ä¸ªçº¿ç¨‹ç»´æŠ¤è‡ªå·±çš„ä¸“åŒ–å­—èŠ‚ç ç¼“å­˜,é¿å…è·¨çº¿ç¨‹äº‰ç”¨ã€‚</li>
<li><strong>å»¶è¿ŸåŒæ­¥</strong>:ç¼“å­˜çš„æ›´æ–°é‡‡ç”¨æ‡’æƒ°ç­–ç•¥,å‡å°‘åŒæ­¥å¼€é”€ã€‚</li>
<li><strong>ä¿å®ˆä¸“åŒ–</strong>:åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹,æŸäº›éš¾ä»¥ä¸“åŒ–çš„æ“ä½œä¿æŒé€šç”¨æŒ‡ä»¤,é¿å…è¿‡åº¦ä¼˜åŒ–ã€‚</li>
</ul>
<p>é‡æ–°å¯ç”¨ PEP 659 å,è‡ªç”±çº¿ç¨‹ Python 3.14 çš„å•çº¿ç¨‹æ€§èƒ½æŸå¤±é™è‡³ <strong>5-10%</strong> ,åŸºæœ¬è¾¾åˆ°äº†å¯æ¥å—çš„æ°´å¹³ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.python.org%2F3%2Fhowto%2Ffree-threading-python.html" target="_blank" title="https://docs.python.org/3/howto/free-threading-python.html" ref="nofollow noopener noreferrer">citation</a></p>
<h2 data-id="heading-32">æŠ€æœ¯æƒè¡¡ä¸æ€§èƒ½å½±å“</h2>
<h3 data-id="heading-33">å•çº¿ç¨‹æ€§èƒ½çš„ä»£ä»·</h3>
<p>è‡ªç”±çº¿ç¨‹æ¨¡å¼çš„å®ç°ä¸å¯é¿å…åœ°å¼•å…¥äº†é¢å¤–å¼€é”€:</p>









































<table><thead><tr><th><strong>å¼€é”€æ¥æº</strong></th><th><strong>å½±å“</strong></th><th><strong>Python 3.13</strong></th><th><strong>Python 3.14</strong></th></tr></thead><tbody><tr><td>åå‘å¼•ç”¨è®¡æ•°çš„ä½æµ‹è¯•</td><td>æ¯æ¬¡å¼•ç”¨è®¡æ•°æ“ä½œ</td><td>~5%</td><td>~3%</td></tr><tr><td>å†…éƒ¨é”çš„è·å–/é‡Šæ”¾</td><td>å®¹å™¨æ“ä½œ</td><td>~10%</td><td>~5%</td></tr><tr><td>å»¶è¿Ÿå¼•ç”¨è®¡æ•°çš„æ ‡è®°æ£€æŸ¥</td><td>å¯¹è±¡è®¿é—®</td><td>~5%</td><td>~3%</td></tr><tr><td>ç¦ç”¨ PEP 659(ä»… 3.13)</td><td>æ‰€æœ‰æ“ä½œ</td><td>~40%</td><td>0%(å·²é‡æ–°å¯ç”¨)</td></tr><tr><td><strong>æ€»ä½“å•çº¿ç¨‹å¼€é”€</strong></td><td/><td><strong>~40%</strong></td><td><strong>~5-10%</strong></td></tr></tbody></table>
<p>å¯ä»¥çœ‹åˆ°,Python 3.14 é€šè¿‡é‡æ–°å¯ç”¨ PEP 659 å’Œå¤§é‡ä¼˜åŒ–,å°†å•çº¿ç¨‹æ€§èƒ½æŸå¤±æ§åˆ¶åœ¨å¯æ¥å—çš„èŒƒå›´å†…ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e7973eebdf0d48ef8fa3645bcdb48d8c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVHNvbmdsZXc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765728366&amp;x-signature=TGTDZWSedaTlKAlU1%2BCQkUF%2BkTE%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-34">å¤šçº¿ç¨‹æ€§èƒ½çš„å·¨å¤§æ”¶ç›Š</h3>
<p>åœ¨å¤šçº¿ç¨‹ CPU å¯†é›†å‹åœºæ™¯ä¸‹,è‡ªç”±çº¿ç¨‹å¸¦æ¥çš„æ€§èƒ½æå‡æ˜¯é¢ è¦†æ€§çš„:</p>
<pre><code class="hljs language-Python" lang="Python"><span class="hljs-comment"># è´¨æ•°è®¡ç®—åŸºå‡†æµ‹è¯•(32 æ ¸ CPU)</span>
<span class="hljs-comment"># æ ‡å‡† Python 3.12:  3.70 ç§’</span>
<span class="hljs-comment"># è‡ªç”±çº¿ç¨‹ 3.13t:     0.35 ç§’  (10.5x åŠ é€Ÿ)</span>
<span class="hljs-comment"># è‡ªç”±çº¿ç¨‹ 3.14t:     0.32 ç§’  (11.6x åŠ é€Ÿ)</span>
</code></pre>
<p>åœ¨æ•°æ®ç§‘å­¦åœºæ™¯(DataFrame è¡Œå¤„ç†):</p>
<pre><code class="hljs language-Python" lang="Python"><span class="hljs-comment"># StaticFrame DataFrame å¤„ç†(1000x1000)</span>
<span class="hljs-comment"># æ ‡å‡† Python 3.13 å¤šçº¿ç¨‹:  39.9 ms (GIL å¯¼è‡´æ€§èƒ½é€€åŒ–)</span>
<span class="hljs-comment"># è‡ªç”±çº¿ç¨‹ 3.13t å¤šçº¿ç¨‹:     7.89 ms (5x åŠ é€Ÿ)</span>
</code></pre>
<p>è¿™äº›æ•°å­—å……åˆ†è¯æ˜:<strong>å¯¹äºèƒ½å¤Ÿå¹¶è¡ŒåŒ–çš„ CPU å¯†é›†å‹ä»»åŠ¡,è‡ªç”±çº¿ç¨‹å¸¦æ¥çš„æ€§èƒ½æå‡è¿œè¶…å•çº¿ç¨‹çš„æ€§èƒ½æŸå¤±</strong>ã€‚</p>
<h3 data-id="heading-35">é€‚ç”¨åœºæ™¯</h3>

























<table><thead><tr><th><strong>åœºæ™¯</strong></th><th><strong>å»ºè®®</strong></th></tr></thead><tbody><tr><td>CPU å¯†é›† + å¯å¹¶è¡Œ</td><td><strong>å¼ºçƒˆæ¨è</strong>è‡ªç”±çº¿ç¨‹</td></tr><tr><td>I/O å¯†é›†</td><td>ä¸¤è€…å·®å¼‚ä¸å¤§,å¯ç”¨è‡ªç”±çº¿ç¨‹</td></tr><tr><td>CPU å¯†é›† + å•çº¿ç¨‹</td><td>ä¼ ç»Ÿ Python æ›´ä¼˜(é¿å… 5-10% æŸå¤±)</td></tr><tr><td>æ··åˆè´Ÿè½½</td><td>è¯„ä¼°å¤šçº¿ç¨‹éƒ¨åˆ†çš„æ”¶ç›Š</td></tr></tbody></table>
<h2 data-id="heading-36">æ€»ç»“:æŠ€æœ¯å®ç°çš„æ•´ä½“æ¶æ„</h2>
<p>Python è‡ªç”±çº¿ç¨‹çš„å®ç°æ˜¯ä¸€é¡¹ç³»ç»Ÿå·¥ç¨‹,æ¶‰åŠè§£é‡Šå™¨çš„æ–¹æ–¹é¢é¢ã€‚ä»¥ä¸‹æ˜¯æ ¸å¿ƒæŠ€æœ¯çš„æ•´ä½“æ¶æ„:</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="hljs-string">â”‚</span>                     <span class="hljs-string">Python</span> <span class="hljs-string">è‡ªç”±çº¿ç¨‹æ¶æ„</span>                          <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="hljs-string">â”‚</span>                                                                 <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>      <span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>  <span class="hljs-string">å†…å­˜ç®¡ç†å±‚</span>       <span class="hljs-string">â”‚</span>      <span class="hljs-string">â”‚</span>  <span class="hljs-string">è§£é‡Šå™¨å±‚</span>        <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>      <span class="hljs-string">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span> <span class="hljs-string">â€¢</span> <span class="hljs-string">åå‘å¼•ç”¨è®¡æ•°</span>    <span class="hljs-string">â”‚</span>      <span class="hljs-string">â”‚</span> <span class="hljs-string">â€¢</span> <span class="hljs-string">å­—èŠ‚ç æ‰§è¡Œ</span>     <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span> <span class="hljs-string">â€¢</span> <span class="hljs-string">å»¶è¿Ÿå¼•ç”¨è®¡æ•°</span>    <span class="hljs-string">â”‚</span>      <span class="hljs-string">â”‚</span> <span class="hljs-string">â€¢</span> <span class="hljs-string">PEP</span> <span class="hljs-number">659</span> <span class="hljs-string">ä¸“åŒ–</span>   <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span> <span class="hljs-string">â€¢</span> <span class="hljs-string">ä¸æœ½å¯¹è±¡æ ‡è®°</span>    <span class="hljs-string">â”‚</span>      <span class="hljs-string">â”‚</span> <span class="hljs-string">â€¢</span> <span class="hljs-string">æ ˆå¸§ç®¡ç†</span>       <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span> <span class="hljs-string">â€¢</span> <span class="hljs-string">mimalloc</span> <span class="hljs-string">åˆ†é…å™¨</span> <span class="hljs-string">â”‚</span>      <span class="hljs-string">â”‚</span> <span class="hljs-string">â€¢</span> <span class="hljs-string">å¼‚å¸¸å¤„ç†</span>       <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>      <span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>           <span class="hljs-string">â”‚</span>                          <span class="hljs-string">â”‚</span>                          <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>           <span class="hljs-string">â–¼</span>                          <span class="hljs-string">â–¼</span>                          <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>           <span class="hljs-string">åƒåœ¾å›æ”¶å™¨</span> <span class="hljs-string">(GC)</span>                    <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span> <span class="hljs-string">â€¢</span> <span class="hljs-string">Stop-the-World</span> <span class="hljs-string">æš‚åœ</span>                        <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span> <span class="hljs-string">â€¢</span> <span class="hljs-string">ç²¾ç¡®å¼•ç”¨è®¡æ•°æ‰«æ</span>                           <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span> <span class="hljs-string">â€¢</span> <span class="hljs-string">QSBR</span> <span class="hljs-string">å»¶è¿Ÿå›æ”¶</span>                              <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span> <span class="hljs-string">â€¢</span> <span class="hljs-string">æ”¾å¼ƒåˆ†ä»£å‡è®¾</span>                               <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>           <span class="hljs-string">â”‚</span>                                                     <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>           <span class="hljs-string">â–¼</span>                                                     <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>          <span class="hljs-string">å†…ç½®ç±»å‹å±‚</span>                          <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span> <span class="hljs-string">â€¢</span> <span class="hljs-attr">dict:</span>  <span class="hljs-string">ç»†ç²’åº¦å“ˆå¸Œè¡¨é”</span>                      <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span> <span class="hljs-string">â€¢</span> <span class="hljs-attr">list:</span>  <span class="hljs-string">åŠ¨æ€æ•°ç»„ä¿æŠ¤é”</span>                      <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span> <span class="hljs-string">â€¢</span> <span class="hljs-attr">set:</span>   <span class="hljs-string">é›†åˆæ“ä½œé”</span>                          <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span> <span class="hljs-string">â€¢</span> <span class="hljs-attr">tuple:</span> <span class="hljs-string">ä¸å¯å˜,æ— éœ€é”</span>                       <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>                                                                 <span class="hljs-string">â”‚</span>
<span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre>
<p>è¿™äº›æŠ€æœ¯ç›¸äº’é…åˆ,å…±åŒå®ç°äº†ä»¥ä¸‹ç›®æ ‡:</p>
<ol>
<li><strong>æ­£ç¡®æ€§</strong>:é€šè¿‡åå‘å¼•ç”¨è®¡æ•°ã€ç»†ç²’åº¦é”ã€GC æ‰«æ,ç¡®ä¿å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„å†…å­˜å®‰å…¨ã€‚</li>
<li><strong>æ€§èƒ½</strong>:é€šè¿‡å»¶è¿Ÿå¼•ç”¨è®¡æ•°ã€mimallocã€PEP 659,æœ€å¤§åŒ–å•çº¿ç¨‹å’Œå¤šçº¿ç¨‹æ€§èƒ½ã€‚</li>
<li><strong>å…¼å®¹æ€§</strong>:ä¿æŒ Python è¯­ä¹‰ä¸å˜,ç°æœ‰ä»£ç æ— éœ€ä¿®æ”¹å³å¯è¿è¡Œã€‚</li>
</ol>
<p>PEP 703 çš„å®ç°æ˜¯ Python ç¤¾åŒºå¤šå¹´åŠªåŠ›çš„ç»“æ™¶,å®ƒå€Ÿé‰´äº† Swiftã€WebKitã€Goã€FreeBSD ç­‰å¤šä¸ªé¡¹ç›®çš„å…ˆè¿›æŠ€æœ¯,ä»£è¡¨äº†åŠ¨æ€è¯­è¨€åœ¨å¤šæ ¸æ—¶ä»£çš„ä¸€æ¬¡é‡å¤§è¿›åŒ–ã€‚éšç€ Python 3.14 çš„å‘å¸ƒå’Œç”Ÿæ€ç³»ç»Ÿçš„é€æ­¥é€‚é…,è‡ªç”±çº¿ç¨‹å°†ä¸º Python åœ¨é«˜æ€§èƒ½è®¡ç®—ã€äººå·¥æ™ºèƒ½ã€ç§‘å­¦è®¡ç®—ç­‰é¢†åŸŸå¼€è¾Ÿå…¨æ–°çš„å¯èƒ½æ€§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»€ä¹ˆ?å¤§æ¨¡å‹éƒ¨ç½²éœ€è¦å¤šå°‘æ˜¾å­˜ä½ éƒ½ä¸çŸ¥é“?]]></title>    <link>https://juejin.cn/post/7580740563893633058</link>    <guid>https://juejin.cn/post/7580740563893633058</guid>    <pubDate>2025-12-07T17:59:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580740563893633058" data-draft-id="7580735683939532834" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»€ä¹ˆ?å¤§æ¨¡å‹éƒ¨ç½²éœ€è¦å¤šå°‘æ˜¾å­˜ä½ éƒ½ä¸çŸ¥é“?"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,LLM,GPU"/> <meta itemprop="datePublished" content="2025-12-07T17:59:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å´ä½³æµ©"/> <meta itemprop="url" content="https://juejin.cn/user/2696441245481975"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»€ä¹ˆ?å¤§æ¨¡å‹éƒ¨ç½²éœ€è¦å¤šå°‘æ˜¾å­˜ä½ éƒ½ä¸çŸ¥é“?
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2696441245481975/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å´ä½³æµ©
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T17:59:31.000Z" title="Sun Dec 07 2025 17:59:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{font-family:-apple-system,system-ui,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial;color:#00325e}.markdown-body ::selection{background-color:#00325e;color:#fff}.markdown-body blockquote{padding:10px 20px;background-color:#fffaf0;box-shadow:0 3px 10px 0 rgba(255,172,194,.24);border:1px solid #f3ca8e;transition:all .2s;margin:1em 0;border-radius:5px}.markdown-body blockquote p{font-size:14px;line-height:25px;color:#795548}.markdown-body blockquote p:last-child{margin:0}.markdown-body blockquote:hover{border-color:#ff9800;background-color:#fff8e0;box-shadow:0 6px 10px -5px rgba(225,173,98,.3803921569)}.markdown-body blockquote code{color:#ff502c}.markdown-body pre{border:1px solid #8cc0f3;box-shadow:0 3px 10px 0 rgba(255,198,198,.28);border-radius:5px;transition:all .2s;overflow-x:auto;white-space:pre-wrap}.markdown-body pre:hover{border-color:#6d9dce}.markdown-body pre&gt;code{padding:10px 20px;color:#00325e;background:#f0f8ff;font-size:12px;line-height:1.6;display:block}.markdown-body code{background:#f6fbff;color:#0b5393;padding:2px 4px;border-radius:4px;font-size:12px}.markdown-body p{font-size:14px;line-height:28px;text-align:justify;margin-bottom:17px;color:#595959}.markdown-body a{color:#00325e;text-decoration:none}.markdown-body a:after{content:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAAXNSR0IArs4c6QAAAQdJREFUKFNt0DtLA0EUBeBzZle0Eks7rcUfEfBRCha7NorYa6NmVJzgyi4smUgKtdZGCJktLMVH4Y8QeztLWyE7VyLEuNFbXj4Oh0P8c8mZm+uJrEN4BJFTeP/MUVe3bnocfALwkOlo1zS7iZAzf6Cx7oXgbaqjxiDEWCcVaGyxQ8pSWo9XhqhoQ/xUFbaKjhe5V+CmR7mnSplEEF6GSmJ+F/d0KHvbCIIJCLc85U6BC5mONgbJNM3uFag++sX7z8O8MzsWBucifMx0dDGE1kmm458KDVukAlnNdDz/exEeW3dNkbfsYC0xtmgDWP6ELLZ0/F6BJu/UoFQN5AkoeUjeJPvx6+i+X5Sjah4tA6gYAAAAAElFTkSuQmCC);margin-left:2px}.markdown-body a:hover{box-shadow:0 1px}.markdown-body table{max-width:100%;border-collapse:collapse;border-spacing:0;box-shadow:0 3px 10px 0 rgba(255,238,172,.24);transition:all .2s}.markdown-body table:hover{box-shadow:0 3px 10px 0 rgba(185,169,103,.24)}.markdown-body table tr th{border:1px solid #8cc0f3;background-color:#f0f8ff;padding:12px 15px}.markdown-body table tr td{border:1px solid rgba(243,202,142,.4);padding:12px 15px}.markdown-body table tbody tr{transition:all .2s}.markdown-body table tbody tr:hover td{border-color:#f3ca8e;background-color:#fff8e0;z-index:1}.markdown-body img{max-width:100%}.markdown-body h1{font-size:20px;margin-top:30px;margin-bottom:10px;padding-left:30px;position:relative}.markdown-body h1&gt;code{font-size:20px}.markdown-body h1:before{content:"ğŸº";display:block;font-size:18px;width:18px;height:18px;left:0;position:absolute}.markdown-body h2{font-size:18px;margin-top:30px;margin-bottom:10px;padding-left:28px;position:relative}.markdown-body h2&gt;code{font-size:18px}.markdown-body h2:before{content:"ğŸ»";display:block;font-size:16px;width:16px;height:16px;left:0;position:absolute}.markdown-body h3{font-size:16px;margin-top:30px;margin-bottom:10px;padding-left:26px;position:relative}.markdown-body h3&gt;code{font-size:16px}.markdown-body h3:before{content:"ğŸ¥‚";display:block;font-size:14px;width:14px;height:14px;left:0;position:absolute}.markdown-body h4{font-size:14px;margin-top:30px;margin-bottom:10px;padding-left:24px;position:relative}.markdown-body h4&gt;code{font-size:14px}.markdown-body h4:before{content:"ğŸ¥ƒ";display:block;font-size:12px;width:12px;height:12px;left:0;position:absolute}.markdown-body h5{font-size:12px;margin-top:30px;margin-bottom:10px}.markdown-body h5&gt;code{font-size:12px}.markdown-body h6{font-size:10px;margin-top:30px;margin-bottom:10px}.markdown-body h6&gt;code{font-size:10px}.markdown-body h1,.markdown-body h2{color:#ff502c}.markdown-body hr{height:4px;border:none;margin-top:32px;margin-bottom:32px;background-size:4px 1px;background-image:linear-gradient(270deg,#6d9dce,#8cc0f3 25%,transparent 50%)}.markdown-body hr:nth-child(2n){background-image:linear-gradient(270deg,#ff9800,#fff8e0 25%,transparent 50%)}.markdown-body ul{padding-inline-start:20px}.markdown-body ul li{list-style-type:"ğŸ”¸"}.markdown-body ul li li{list-style-type:"â—»ï¸"}.markdown-body ul li li li{list-style-type:"â–«ï¸"}.markdown-body ol{padding-inline-start:20px}.markdown-body ol ::marker{color:#ff9800}.markdown-body ol,.markdown-body ul{line-height:2em}.markdown-body li{padding-inline-start:1ch}.markdown-body li.task-list-item{list-style:none;padding-inline-start:0}.markdown-body li input{padding-right:2px}.markdown-body li input[type=checkbox i]{appearance:none}.markdown-body li input:before{content:"ğŸŸ©";display:block;width:13px;height:13px}.markdown-body li input:checked:before{content:"âœ…"}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">ä»€ä¹ˆ?éƒ¨ç½²å¤§æ¨¡å‹è¦å¤šå°‘æ˜¾å­˜ä½ éƒ½ä¸çŸ¥é“?</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e2a3016eef8c4ab0933e83e98f1dd875~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZC05L2z5rWp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765735171&amp;x-signature=7ZkiJaqRV4JS3%2BzPEI93CqVCNCA%3D" alt="äººå·¥æ™ºèƒ½çš„æ— é™å¯èƒ½.png" loading="lazy"/></p>
<h3 data-id="heading-1">å¼•è¨€:</h3>
<blockquote>
<p>è™½ç„¶å¤§æ¨¡å‹å‡ºæ¥æœ‰æ®µæ—¶é—´äº†ï¼Œä½†æ˜¯ä¾ç„¶æœ‰å¾ˆå¤šçš„å¼€å‘è€…ä¸çŸ¥é“å¦‚ä½•ä¸‹æ‰‹å»éƒ¨ç½²ä¸€ä¸ªè‡ªå·±çš„æœ¬åœ°æ¨¡å‹ï¼Œ</p>
<p>ç”šè‡³ä¸çŸ¥é“ï¼Œè‡ªå·±æœ¬åœ°çš„èµ„æºé€‚åˆéƒ¨ç½²ä»€ä¹ˆæ¨¡å‹ ï¼Œä»€ä¹ˆæ¨¡å‹éœ€è¦å¤šå°‘èµ„æºã€‚ä»Šå¤©æˆ‘ä»¬å°±æ¥è®²è®²è¿™ä¸ªå¸¸è§„çš„åŸºç¡€é—®é¢˜ã€‚</p>
</blockquote>
<p><strong>ä½œè€… :</strong> å´ä½³æµ©</p>
<p><strong>æœ€åæ›´æ–°:</strong> 2025-12-6</p>
<p><strong>ä¸€ä¸ªå¸¸è§çš„è¯¯åŒº:</strong></p>
<p>å¾ˆå¤šäººåœ¨éƒ¨ç½²å¤§è¯­è¨€æ¨¡å‹æ—¶,ä¼šæœ‰è¿™æ ·çš„ç›´è§‰è®¤çŸ¥:</p>
<blockquote>
<p>"æˆ‘ä¸‹è½½çš„æ¨¡å‹æ–‡ä»¶æ˜¯ 19GB,é‚£æˆ‘éœ€è¦ 20GB æ˜¾å­˜å°±å¤Ÿäº†å§?"</p>
</blockquote>
<p><strong>é”™!</strong> è¿™æ˜¯ä¸€ä¸ªçœ‹ä¼¼åˆç†ä½†å®é™…ä¸Šä¼šè®©ä½ è¸©å‘çš„ç†è§£ã€‚æœ¬æ–‡å°†æ·±å…¥å‰–æå¤§æ¨¡å‹éƒ¨ç½²æ—¶çš„æ˜¾å­˜å ç”¨æœºåˆ¶,å¸®åŠ©ä½ å‡†ç¡®ä¼°ç®—æ‰€éœ€ç¡¬ä»¶èµ„æºã€‚</p>
<hr/>
<h3 data-id="heading-2">ç¬¬ä¸€éƒ¨åˆ†:æ˜¾å­˜å ç”¨çš„å®Œæ•´å›¾æ™¯</h3>
<h4 data-id="heading-3">1.1 æ˜¾å­˜éƒ½è¢«è°å ç”¨äº†?</h4>
<p>å½“ä½ è¿è¡Œä¸€ä¸ªå¤§è¯­è¨€æ¨¡å‹æ—¶,æ˜¾å­˜ä¸ä»…ä»…å­˜å‚¨æ¨¡å‹æƒé‡,è¿˜åŒ…å«å¤šä¸ªå…³é”®ç»„ä»¶:</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[GPU æ˜¾å­˜æ€»é‡] --&gt; B[æ¨¡å‹æƒé‡ Weights]
    A --&gt; C[KV Cache]
    A --&gt; D[æ¿€æ´»å€¼ Activations]
    A --&gt; E[æ¡†æ¶å¼€é”€]
    A --&gt; F[ç³»ç»Ÿé¢„ç•™]
    
    B --&gt; B1["é‡åŒ–åçš„å‚æ•°&lt;br/&gt;å¦‚ Q4_K_M çº¦ 19GB"]
    C --&gt; C1["æ³¨æ„åŠ›æœºåˆ¶çš„ç¼“å­˜&lt;br/&gt;éšä¸Šä¸‹æ–‡é•¿åº¦å¢é•¿&lt;br/&gt;2-50+ GB"]
    D --&gt; D1["å‰å‘ä¼ æ’­ä¸­é—´ç»“æœ&lt;br/&gt;batch_size å½±å“å¤§&lt;br/&gt;1-3 GB"]
    E --&gt; E1["æ¨ç†æ¡†æ¶å†…éƒ¨å¼€é”€&lt;br/&gt;llama.cpp/vLLM/Ollama&lt;br/&gt;0.5-2 GB"]
    F --&gt; F1["GPU é©±åŠ¨åŠå…¶ä»–è¿›ç¨‹&lt;br/&gt;å¯å˜"]
    
    style C fill:#ff6b6b
    style C1 fill:#ff6b6b
</code></pre>
<h4 data-id="heading-4">1.2 æ ¸å¿ƒå…¬å¼æ¨å¯¼</h4>
<p><strong>åŸºç¡€å…¬å¼(æ— ä¸Šä¸‹æ–‡)</strong></p>
<pre><code class="hljs language-bash" lang="bash">æ˜¾å­˜éœ€æ±‚ = æ¨¡å‹æ–‡ä»¶å¤§å° Ã— 1.2 + æ¡†æ¶å¼€é”€(1-2 GB)
</code></pre>
<p>è¿™é‡Œçš„ <strong>1.2 å€ç³»æ•°</strong> æ¥è‡ª:</p>
<ul>
<li>CUDA æ¡†æ¶åˆå§‹åŒ–å¼€é”€(5-10%)</li>
<li>æ¨ç†æ—¶ä¸´æ—¶å¼ é‡ç¼“å­˜(5-10%)</li>
<li>å†…å­˜å¯¹é½å’Œç¢ç‰‡(5-10%)</li>
</ul>
<p><strong>å®Œæ•´å…¬å¼(è€ƒè™‘ä¸Šä¸‹æ–‡)</strong></p>
<pre><code class="hljs language-bash" lang="bash">æ˜¾å­˜éœ€æ±‚ = æ¨¡å‹æ–‡ä»¶å¤§å° Ã— 1.2 + KV Cache + é¢„ç•™ç¼“å†²(3-5 GB)
</code></pre>
<hr/>
<h3 data-id="heading-5">ç¬¬äºŒéƒ¨åˆ†:é‡åŒ–æŠ€æœ¯çš„å½±å“</h3>
<h4 data-id="heading-6">2.1 é‡åŒ–ç²¾åº¦ä¸æ–‡ä»¶å¤§å°</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A["åŸå§‹æ¨¡å‹ FP16&lt;br/&gt;61 GB"] --&gt; B["INT8 é‡åŒ–&lt;br/&gt;32 GB&lt;br/&gt;æŸå¤±å°äº1%"]
    B --&gt; C["INT4 é‡åŒ–&lt;br/&gt;19 GB&lt;br/&gt;æŸå¤±2-5%"]
    
    A --&gt;|ä¿ç•™100%ç²¾åº¦| A
    B --&gt;|ä¿ç•™çº¦99%ç²¾åº¦| B
    C --&gt;|ä¿ç•™çº¦95%ç²¾åº¦| C
    
    style A fill:#e3f2fd
    style B fill:#fff9c4
    style C fill:#ffccbc
</code></pre>
<h4 data-id="heading-7">2.2 é‡åŒ–åçš„æ˜¾å­˜å ç”¨å®æµ‹</h4>
<p>ä»¥ <strong>Qwen3-Coder-30B</strong> ä¸ºä¾‹(å®é™…æµ‹è¯•æ•°æ®):</p>








































<table><thead><tr><th>é‡åŒ–æ–¹å¼</th><th>æ¨¡å‹æ–‡ä»¶å¤§å°</th><th>åŸºç¡€æ˜¾å­˜å ç”¨</th><th>åŠ è½½åå®é™…å ç”¨</th><th>å·®å€¼</th></tr></thead><tbody><tr><td>FP16</td><td>61 GB</td><td>61 GB</td><td>65-68 GB</td><td>+4-7 GB</td></tr><tr><td>Q8_0</td><td>32 GB</td><td>32 GB</td><td>35-37 GB</td><td>+3-5 GB</td></tr><tr><td>Q5_K_M</td><td>24 GB</td><td>24 GB</td><td>27-29 GB</td><td>+3-5 GB</td></tr><tr><td>Q4_K_M</td><td>19 GB</td><td>19 GB</td><td>22-24 GB</td><td>+3-5 GB</td></tr></tbody></table>
<p><strong>è§‚å¯Ÿè§„å¾‹</strong>: æ— è®ºå“ªç§é‡åŒ–æ–¹å¼,å®é™…æ˜¾å­˜éƒ½ä¼šæ¯”æ–‡ä»¶å¤§å°å¤šå‡º <strong>3-7 GB</strong></p>
<hr/>
<h3 data-id="heading-8">ç¬¬ä¸‰éƒ¨åˆ†:KV Cache â€”â€” éšå½¢çš„æ˜¾å­˜æ€æ‰‹</h3>
<h4 data-id="heading-9">3.1 ä»€ä¹ˆæ˜¯ KV Cache?</h4>
<p>åœ¨ Transformer æ¶æ„ä¸­,æ³¨æ„åŠ›æœºåˆ¶éœ€è¦å­˜å‚¨æ¯ä¸ª token çš„ Key å’Œ Value å‘é‡,è¿™äº›ç¼“å­˜éšä¸Šä¸‹æ–‡é•¿åº¦çº¿æ€§å¢é•¿ã€‚</p>
<p><strong>KV Cache è®¡ç®—å…¬å¼</strong>:</p>
<pre><code class="hljs language-bash" lang="bash">KV Cache(GB) â‰ˆ 2 Ã— å±‚æ•° Ã— éšè—å±‚ç»´åº¦ Ã— åºåˆ—é•¿åº¦ Ã— æ¯å‚æ•°å­—èŠ‚æ•° / 10^9
</code></pre>
<p>ä»¥ Qwen3-30B ä¸ºä¾‹(48 å±‚,4096 éšè—ç»´åº¦,FP16):</p>
<pre><code class="hljs language-bash" lang="bash">KV Cache = 2 Ã— 48 Ã— 4096 Ã— seq_len Ã— 2 / 10^9
         â‰ˆ 0.0008 Ã— seq_len GB
</code></pre>
<h4 data-id="heading-10">3.2 ä¸Šä¸‹æ–‡é•¿åº¦çš„æƒŠäººå½±å“</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[ä¸Šä¸‹æ–‡é•¿åº¦å¯¹æ˜¾å­˜çš„å½±å“] --&gt; B["4K tokens&lt;br/&gt;KV Cache: 0.8 GB"]
    A --&gt; C["32K tokens&lt;br/&gt;KV Cache: 6.4 GB"]
    A --&gt; D["128K tokens&lt;br/&gt;KV Cache: 25.6 GB"]
    A --&gt; E["256K tokens&lt;br/&gt;KV Cache: 51.2 GB"]
    
    B --&gt; F["çŸ­å¯¹è¯åœºæ™¯&lt;br/&gt;å¾®ä¿¡èŠå¤©/ç®€å•é—®ç­”"]
    C --&gt; G["ä¸­ç­‰æ–‡æ¡£åœºæ™¯&lt;br/&gt;ä»£ç å®¡æŸ¥/æŠ€æœ¯æ–‡æ¡£"]
    D --&gt; H["é•¿æ–‡æ¡£åœºæ™¯&lt;br/&gt;è®ºæ–‡åˆ†æ/ä¹¦ç±æ€»ç»“"]
    E --&gt; I["è¶…é•¿ä¸Šä¸‹æ–‡&lt;br/&gt;æ•´ä¸ªä»£ç åº“åˆ†æ"]
    
    style E fill:#ff6b6b
    style I fill:#ff6b6b
</code></pre>
<h4 data-id="heading-11">3.3 å®æµ‹æ¡ˆä¾‹å¯¹æ¯”</h4>
<p><strong>åœºæ™¯ 1: æ—¥å¸¸å¯¹è¯(4K ä¸Šä¸‹æ–‡)</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># RTX 4090 (24GB) è¿è¡Œ Qwen3-30B Q4_K_M</span>
è¾“å…¥: <span class="hljs-string">"å†™ä¸€ä¸ª Python æ’åºç®—æ³•"</span>
ä¸Šä¸‹æ–‡é•¿åº¦: ~500 tokens
æ˜¾å­˜å ç”¨: 21 GB
ç»“è®º: å®Œå…¨ OK
</code></pre>
<p><strong>åœºæ™¯ 2: é•¿ä»£ç æ–‡ä»¶(64K ä¸Šä¸‹æ–‡)</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åŒæ ·çš„æ˜¾å¡å’Œæ¨¡å‹</span>
è¾“å…¥: ç²˜è´´ä¸€ä¸ª 5000 è¡Œçš„ JavaScript é¡¹ç›®
ä¸Šä¸‹æ–‡é•¿åº¦: ~40K tokens
æ˜¾å­˜å ç”¨: 28 GB
ç»“è®º: OOM å´©æºƒ!
</code></pre>
<hr/>
<h3 data-id="heading-12">ç¬¬å››éƒ¨åˆ†:å®ç”¨æ˜¾å­˜ä¼°ç®—æ–¹æ³•</h3>
<h4 data-id="heading-13">4.1 ä¸‰æ­¥å¿«é€Ÿä¼°ç®—æ³•</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    Start([å¼€å§‹ä¼°ç®—]) --&gt; Step1["æ­¥éª¤1: ç¡®å®šæ¨¡å‹æ–‡ä»¶å¤§å°"]
    Step1 --&gt; Step2["æ­¥éª¤2: ä¹˜ä»¥ 1.2 å€ç³»æ•°"]
    Step2 --&gt; Step3["æ­¥éª¤3: æ ¹æ®åœºæ™¯åŠ  KV Cache"]
    
    Step3 --&gt; Choice{ä½ çš„ä½¿ç”¨åœºæ™¯?}
    
    Choice --&gt;|"æ—¥å¸¸å¯¹è¯&lt;br/&gt;ä¸Šä¸‹æ–‡å°äºç­‰äº8K"| Short["+4 GB ç¼“å†²"]
    Choice --&gt;|"é•¿æ–‡æ¡£/ä»£ç &lt;br/&gt;ä¸Šä¸‹æ–‡ 32K-64K"| Medium["+8 GB ç¼“å†²"]
    Choice --&gt;|"è¶…é•¿ä¸Šä¸‹æ–‡&lt;br/&gt;ä¸Šä¸‹æ–‡å¤§äº128K"| Long["+30-50 GB ç¼“å†²"]
    
    Short --&gt; Result1["æ‰€éœ€æ˜¾å­˜ =&lt;br/&gt;æ¨¡å‹ Ã— 1.2 + 4 GB"]
    Medium --&gt; Result2["æ‰€éœ€æ˜¾å­˜ =&lt;br/&gt;æ¨¡å‹ Ã— 1.2 + 8 GB"]
    Long --&gt; Result3["æ‰€éœ€æ˜¾å­˜ =&lt;br/&gt;æ¨¡å‹ Ã— 1.2 + 30+ GB"]
    
    Result1 --&gt; End([ä¼°ç®—å®Œæˆ])
    Result2 --&gt; End
    Result3 --&gt; End
</code></pre>
<h4 data-id="heading-14">4.2 ä¸åŒåœºæ™¯çš„æ˜¾å­˜éœ€æ±‚è¡¨</h4>















































<table><thead><tr><th>ä½¿ç”¨åœºæ™¯</th><th>æ¨¡å‹é‡åŒ–</th><th>æ¨¡å‹å¤§å°</th><th>å®‰å…¨æ˜¾å­˜é…ç½®</th><th>æ¨èæ˜¾å¡</th></tr></thead><tbody><tr><td>è½»é‡å¯¹è¯</td><td>Q4_K_M</td><td>7B</td><td>8 GB</td><td>RTX 3060 12GB</td></tr><tr><td>ä»£ç è¡¥å…¨</td><td>Q4_K_M</td><td>14B</td><td>14 GB</td><td>RTX 4060 Ti 16GB</td></tr><tr><td>é€šç”¨åŠ©æ‰‹</td><td>Q5_K_M</td><td>30B</td><td>32 GB</td><td>RTX 4090 24GB Ã— 2</td></tr><tr><td>é•¿æ–‡æ¡£åˆ†æ</td><td>Q4_K_M</td><td>30B</td><td>40 GB</td><td>A100 40GB</td></tr><tr><td>è¶…é•¿ä¸Šä¸‹æ–‡</td><td>FP16</td><td>30B</td><td>80+ GB</td><td>A100 80GB</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-15">ç¬¬äº”éƒ¨åˆ†:çœŸå®éƒ¨ç½²æ¡ˆä¾‹åˆ†æ</h3>
<h4 data-id="heading-16">æ¡ˆä¾‹ 1: RTX 4090 çš„æé™æŒ‘æˆ˜</h4>
<p><strong>ç¡¬ä»¶</strong>: RTX 4090 (24GB VRAM)
<strong>ç›®æ ‡</strong>: è¿è¡Œ Qwen3-Coder-30B</p>
<p><strong>æ–¹æ¡ˆ A: Q4_K_M é‡åŒ–(å¤±è´¥)</strong></p>
<pre><code class="hljs language-bash" lang="bash">æ¨¡å‹æ–‡ä»¶: 19 GB
åŸºç¡€å ç”¨: 19 Ã— 1.2 = 22.8 GB
é¢„ç•™ç¼“å†²: 3 GB
æ€»éœ€æ±‚: 25.8 GB
ç»“æœ: çŸ­å¯¹è¯ OK,é•¿ä»£ç  OOM
</code></pre>
<p><strong>æ–¹æ¡ˆ B: é™è‡³ 14B æ¨¡å‹(æˆåŠŸ)</strong></p>
<pre><code class="hljs language-bash" lang="bash">æ¨¡å‹æ–‡ä»¶: Qwen3-Coder-14B Q4_K_M = 8.5 GB
åŸºç¡€å ç”¨: 8.5 Ã— 1.2 = 10.2 GB
é¢„ç•™ç¼“å†²: 5 GB
æ€»éœ€æ±‚: 15.2 GB
ç»“æœ: 32K ä¸Šä¸‹æ–‡æµç•…è¿è¡Œ
</code></pre>
<h4 data-id="heading-17">æ¡ˆä¾‹ 2: å¤šå¡éƒ¨ç½²ç­–ç•¥</h4>
<p><strong>ç¡¬ä»¶</strong>: 2 Ã— RTX 3090 (24GB Ã— 2 = 48GB)
<strong>ç›®æ ‡</strong>: è¿è¡Œ Llama 3.1 70B</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[70B FP16 æ¨¡å‹&lt;br/&gt;140 GB] --&gt; B{é‡åŒ–ç­–ç•¥}
    
    B --&gt; C[Q4_K_M&lt;br/&gt;42 GB]
    
    C --&gt; D[å¼ é‡å¹¶è¡Œ&lt;br/&gt;Tensor Parallelism]
    
    D --&gt; E[GPU 0: 21 GB]
    D --&gt; F[GPU 1: 21 GB]
    
    E --&gt; G[+KV Cache 5GB&lt;br/&gt;æ€»éœ€æ±‚: 26 GB]
    F --&gt; H[+KV Cache 5GB&lt;br/&gt;æ€»éœ€æ±‚: 26 GB]
    
    G --&gt; I[æ˜¾å­˜å ç”¨: è¶…é™!]
    H --&gt; I
    
    style I fill:#ff6b6b
</code></pre>
<h5 data-id="heading-18">é—®é¢˜ç‚¹æ·±åº¦è§£æ</h5>
<p>ä¸Šå›¾ä¸­è™½ç„¶è¡¨é¢ä¸Šçœ‹èµ·æ¥å¯è¡Œ,ä½†å®é™…ä¸Šä»ç„¶ä¼š OOMã€‚æ ¹æœ¬åŸå› æœ‰ä¸‰ä¸ª:</p>
<p><strong>åŸå›  1: å¼ é‡å¹¶è¡Œéœ€è¦å¤åˆ¶éƒ¨åˆ†æ¨¡å‹ç»“æ„</strong></p>
<p>Tensor Parallelism(å¼ é‡å¹¶è¡Œ)ä¼šå°†æƒé‡åˆ†ç‰‡åˆ°å„å¡,ä½†è®¸å¤š LayerNormã€Embeddingã€Routerã€Position Encoding ç­‰æ¨¡å—æ— æ³•å®Œå…¨åˆ‡åˆ†,ä¼šåœ¨å„å¡ä¸Šé‡å¤å­˜åœ¨ã€‚</p>
<p>ç»“æœ: æ¯å¼ å¡ä¼šå¤šå  1-2 GBã€‚</p>
<p><strong>åŸå›  2: KV Cache ä¸æ˜¯å‡åˆ†,è€Œæ˜¯æ¯å¼ å¡éƒ½è¦ç»´æŠ¤ä¸€ä»½</strong></p>
<p>Attention çš„ KV Cache å’Œä¸Šä¸‹æ–‡æœ‰å…³,è€Œä¸æ˜¯æ¨¡å‹æƒé‡ã€‚å¤šå¡æ¨ç†æ—¶æ¯å¼  GPU éƒ½è¦ç»´æŠ¤å®Œæ•´ KV Cacheã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´:</p>
<ul>
<li>ä½ ä¸æ˜¯æŠŠ KV Cache åˆ†åˆ°ä¸åŒå¡</li>
<li>è€Œæ˜¯æ¯å¼ å¡éƒ½è¦å ç”¨ 5GB</li>
</ul>
<p><strong>åŸå›  3: æ˜¾å­˜ç¢ç‰‡åŒ–ä¸ CUDA allocator å¼€é”€(1-3 GB)</strong></p>
<p>llama.cppã€vLLMã€TransformerEngine éƒ½æœ‰è‡ªå·±çš„æ˜¾å­˜æ± åŒ–ç­–ç•¥,ä¼šäº§ç”Ÿ 5-10% å¼€é”€ã€‚å½“æ˜¾å­˜å ç”¨åˆ° 90% ä»¥ä¸Šæ—¶,ç¢ç‰‡åŒ–ä¼šå¯¼è‡´ç›´æ¥ OOMã€‚</p>
<h5 data-id="heading-19">å®é™…æ˜¾å­˜å ç”¨åˆ†æ</h5>





























<table><thead><tr><th>é¡¹ç›®</th><th>æ¯å¼  GPU å®é™…å ç”¨</th></tr></thead><tbody><tr><td>Q4_K_M æƒé‡åˆ†ç‰‡</td><td>çº¦ 21 GB</td></tr><tr><td>é‡å¤æƒé‡/ç»“æ„</td><td>+1.5 GB</td></tr><tr><td>KV Cache(32K)</td><td>+5 GB</td></tr><tr><td>æ¡†æ¶/allocator</td><td>+1.5 GB</td></tr><tr><td><strong>åˆè®¡</strong></td><td><strong>çº¦ 29 GB</strong></td></tr></tbody></table>
<p>ç»“è®º: ä½ åªæœ‰ 24GB,æ‰€ä»¥å¿…å®š OOMã€‚</p>
<h5 data-id="heading-20">æ­£ç¡®è§£å†³æ–¹æ¡ˆ</h5>
<p>è¦è¿è¡Œ 70B æ¨¡å‹,å¤šå¡åªæ˜¯ä¸€éƒ¨åˆ†,ä½ è¿˜éœ€è¦:</p>
<p><strong>æ–¹æ¡ˆ A: ä½¿ç”¨ 4 å¡(æ¨è)</strong></p>
<pre><code class="hljs language-bash" lang="bash">4 Ã— 24GB = 96GB æ€»æ˜¾å­˜
</code></pre>
<p>Tensor Parallelism åˆ‡åˆ†æ›´ç»†:</p>





























<table><thead><tr><th>é¡¹ç›®</th><th>æ˜¾å­˜å ç”¨</th></tr></thead><tbody><tr><td>æƒé‡åˆ†ç‰‡</td><td>10-11 GB</td></tr><tr><td>é‡å¤ç»“æ„</td><td>1 GB</td></tr><tr><td>KV Cache</td><td>5 GB</td></tr><tr><td>æ¡†æ¶å¼€é”€</td><td>1 GB</td></tr><tr><td><strong>æ€»è®¡</strong></td><td><strong>çº¦ 18GB(å®Œå…¨å¤Ÿ)</strong></td></tr></tbody></table>
<p>ç»“è®º: 4 å¡ 3090 å¯ä»¥è¿è¡Œ 70B(Q4_K_M),ç‹¬ç«‹æ˜¾å¡å…šæœ€ä½é—¨æ§›: 4 Ã— 24GB</p>
<p><strong>æ–¹æ¡ˆ B: ä½¿ç”¨ 2 Ã— A100 40GB</strong></p>
<ul>
<li>70B FP16 è‚¯å®šä¸è¡Œ</li>
<li>Q4_K_M æƒé‡ 42GB,æ¯å¡åˆ†åˆ° 21GB</li>
<li>40GB æ˜¾å­˜è¶³å¤Ÿå®¹çº³ KV Cache + æ¡†æ¶å¼€é”€</li>
</ul>
<p>ç»“è®º: ä¸¤å¼  A100 40GB èƒ½è¿è¡Œ 70B(Q4_K_M)</p>
<p><strong>æ–¹æ¡ˆ C(é”™è¯¯): 2 Ã— RTX 4090(24GB Ã— 2)</strong></p>
<p>å’Œ 3090 ç›¸åŒæ˜¾å­˜,æ— æ³•è§£å†³ KV Cache é‡å¤é—®é¢˜:</p>
<pre><code class="hljs language-bash" lang="bash">21GB(æƒé‡åˆ†ç‰‡) + 5GB(KV) + 1.5GB(é‡å¤ç»“æ„) + 1.5GB(allocator)
â‰ˆ 29GB &gt; 24GB â†’ OOM
</code></pre>
<p>ç»“è®º: åŒå¡ 24GB ç³»ç»Ÿæ°¸è¿œæ— æ³•è¿è¡Œ 70B å¤§æ¨¡å‹(è¶…è¿‡ 30K ä¸Šä¸‹æ–‡)ã€‚</p>
<hr/>
<h3 data-id="heading-21">ç¬¬å…­éƒ¨åˆ†:æ˜¾å­˜éœ€æ±‚ç»ˆæå‚è€ƒè¡¨</h3>
<h4 data-id="heading-22">6.1 å•å¡æ˜¾å­˜éƒ¨ç½²æé™</h4>









































<table><thead><tr><th>æ¨¡å‹å¤§å°</th><th>Q4_K_M å ç”¨</th><th>èƒ½å¦å•å¡éƒ¨ç½²?</th><th>æ¨èæ˜¾å¡</th></tr></thead><tbody><tr><td>7B</td><td>çº¦ 4GB</td><td>å®Œå…¨å¯ä»¥</td><td>8GB+(3060/4060)</td></tr><tr><td>14B</td><td>çº¦ 8.5GB</td><td>å®Œå…¨å¯ä»¥</td><td>16GB(4060Ti/4070)</td></tr><tr><td>30B</td><td>çº¦ 19GB</td><td>å‹‰å¼ºå¯ä»¥</td><td>24GB(4090/5090)</td></tr><tr><td>33B</td><td>çº¦ 21GB</td><td>è¾ƒå›°éš¾</td><td>24GB(4090/5090)</td></tr><tr><td>70B</td><td>çº¦ 42GB</td><td>å¿…é¡»å¤šå¡</td><td>å¿…é¡»å¤šå¡æˆ– A100</td></tr></tbody></table>
<h4 data-id="heading-23">6.2 å¤šå¡è¿è¡Œ 70B çš„æ˜¾å­˜è¦æ±‚</h4>



































<table><thead><tr><th>GPU ç»„åˆ</th><th>Q4_K_M(42GB)</th><th>èƒ½å¦è¿è¡Œ?</th><th>åŸå› </th></tr></thead><tbody><tr><td>2 Ã— 24GB</td><td>ç†è®º 48GB</td><td>ä¸å¤Ÿ</td><td>KV Cache é‡å¤å ç”¨</td></tr><tr><td>2 Ã— 48GB(A6000)</td><td>ç†è®º 96GB</td><td>è¶³å¤Ÿ</td><td>æ¯å¡ 26-29GB</td></tr><tr><td>2 Ã— 40GB(A100)</td><td>ç†è®º 80GB</td><td>è¶³å¤Ÿ</td><td>æ¯å¡ 25-27GB</td></tr><tr><td>4 Ã— 24GB</td><td>ç†è®º 96GB</td><td>è¶³å¤Ÿ</td><td>åˆ‡åˆ†æ›´ç»†,æ¯å¡çº¦ 18GB</td></tr></tbody></table>
<h4 data-id="heading-24">6.3 ä¸åŒä¸Šä¸‹æ–‡é•¿åº¦çš„æ˜¾å­˜è§„åˆ’</h4>



































<table><thead><tr><th>ä¸Šä¸‹æ–‡é•¿åº¦</th><th>30B æ¨¡å‹(Q4)</th><th>70B æ¨¡å‹(Q4)</th><th>æ¨èé…ç½®</th></tr></thead><tbody><tr><td>4K</td><td>22 GB</td><td>éœ€å¤šå¡</td><td>å•å¡ 24GB / å¤šå¡</td></tr><tr><td>32K</td><td>28 GB</td><td>éœ€å¤šå¡</td><td>å•å¡ 32GB / å¤šå¡ 40GB</td></tr><tr><td>128K</td><td>45+ GB</td><td>éœ€å¤šå¡</td><td>A100 40GB+</td></tr><tr><td>256K</td><td>70+ GB</td><td>éœ€å¤šå¡</td><td>A100 80GB / H100</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-25">ç¬¬ä¸ƒéƒ¨åˆ†:æœ¬æ–‡ç»ˆææ€»ç»“</h3>
<h4 data-id="heading-26">éƒ¨ç½²å¤§æ¨¡å‹æ˜¾å­˜éœ€æ±‚,ä½ å¿…é¡»è®°ä½è¿™ 5 æ¡</h4>
<p><strong>1. æ˜¾å­˜ä¸ç­‰äºæ¨¡å‹æ–‡ä»¶å¤§å°,æ°¸è¿œè¦ä¹˜ 1.2-1.3</strong></p>
<p>æ¨¡å‹æ–‡ä»¶ 19GB,ä¸ç­‰äºæ˜¾å­˜ 19GBã€‚</p>
<p>åŸå› :</p>
<ul>
<li>CUDA è¿è¡Œæ—¶å¼€é”€</li>
<li>ä¸´æ—¶å¼ é‡</li>
<li>Memory alignment</li>
<li>æ¡†æ¶å¼€é”€</li>
</ul>
<p><strong>2. KV Cache æ˜¯å¤§æ¨¡å‹ OOM çš„æœ€å¤§å…ƒå‡¶</strong></p>
<p>ä¸Šä¸‹æ–‡é•¿åº¦è¶Šå¤§,æ˜¾å­˜çˆ†ç‚¸è¶Šå¿«:</p>

























<table><thead><tr><th>ä¸Šä¸‹æ–‡</th><th>KV Cache</th></tr></thead><tbody><tr><td>4K</td><td>0.8 GB</td></tr><tr><td>32K</td><td>6 GB</td></tr><tr><td>128K</td><td>25 GB</td></tr><tr><td>256K</td><td>50 GB</td></tr></tbody></table>
<p><strong>3. å•å¡ 24GB çš„æé™å°±æ˜¯ 30B(é‡åŒ–)</strong></p>
<p>30B æ˜¯ç‹¬æ˜¾å…šçš„å¤©èŠ±æ¿,è¿™æ˜¯éå¸¸ç°å®çš„é™åˆ¶ã€‚</p>
<p><strong>4. 70B æ¨¡å‹æ°¸è¿œéœ€è¦è‡³å°‘ 2 å¡(40GB+)æˆ– 4 å¡(24GB+)</strong></p>
<p>å¦åˆ™ KV Cache ä¼šå¯¼è‡´ OOMã€‚</p>
<p><strong>5. æƒ³è·‘é•¿ä¸Šä¸‹æ–‡(å¤§äº 128K),å¿…é¡»ä½¿ç”¨ A100 / H100</strong></p>
<p>æ¶ˆè´¹çº§æ˜¾å¡è¿ 64K ä¸Šä¸‹æ–‡éƒ½åƒåŠ›ã€‚</p>
<hr/>
<h3 data-id="heading-27">ç¬¬å…«éƒ¨åˆ†:ä¼˜åŒ–æŠ€å·§ä¸æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-28">8.1 é™ä½æ˜¾å­˜å ç”¨çš„äº”å¤§æŠ€å·§</h4>
<ol>
<li>
<p><strong>é€‰æ‹©åˆé€‚çš„é‡åŒ–æ–¹å¼</strong></p>
<pre><code class="hljs language-bash" lang="bash">ç²¾åº¦è¦æ±‚ä¸é«˜ â†’ Q4_K_M(æœ€çœæ˜¾å­˜)
éœ€è¦é«˜ç²¾åº¦ â†’ Q5_K_M æˆ– Q8_0
ç ”ç©¶ç”¨é€” â†’ FP16(å®Œæ•´ç²¾åº¦)
</code></pre>
</li>
<li>
<p><strong>åŠ¨æ€ KV Cache ç®¡ç†</strong></p>
<ul>
<li>ä½¿ç”¨ PagedAttention(vLLM)</li>
<li>Sliding Window Attention(åªä¿ç•™æœ€è¿‘ N ä¸ª tokens)</li>
<li>åˆ†å—å¤„ç†é•¿æ–‡æ¡£</li>
</ul>
</li>
<li>
<p><strong>æ‰¹å¤„ç†å¤§å°æ§åˆ¶</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å•æ¬¡æ¨ç†</span>
batch_size = <span class="hljs-number">1</span>  <span class="hljs-comment"># æ˜¾å­˜å ç”¨æœ€å°</span>

<span class="hljs-comment"># æ‰¹é‡æ¨ç†</span>
batch_size = <span class="hljs-number">4</span>  <span class="hljs-comment"># æ˜¾å­˜å ç”¨ Ã— 4,ä½†ååé‡ Ã— 3.5</span>
</code></pre>
</li>
<li>
<p><strong>Offloading ç­–ç•¥</strong></p>
<pre><code class="hljs language-bash" lang="bash">æ¨¡å‹å±‚åˆ†é…:
- GPU: å‰ 30 å±‚(é«˜é¢‘è®¡ç®—)
- CPU: å 18 å±‚(ä½é¢‘è®¡ç®—)
æ˜¾å­˜èŠ‚çœ: 30-40%
é€Ÿåº¦æŸå¤±: 15-25%
</code></pre>
</li>
<li>
<p><strong>ä½¿ç”¨ä¸“ä¸šæ¨ç†æ¡†æ¶</strong></p>
<ul>
<li><strong>vLLM</strong>: æœ€ä½³ååé‡,æ”¯æŒ PagedAttention</li>
<li><strong>llama.cpp</strong>: æœ€ä½æ˜¾å­˜å ç”¨,æ”¯æŒ CPU offload</li>
<li><strong>TensorRT-LLM</strong>: æœ€å¿«æ¨ç†é€Ÿåº¦(NVIDIA ä¼˜åŒ–)</li>
</ul>
</li>
</ol>
<h4 data-id="heading-29">8.2 æ˜¾å­˜ä¸è¶³æ—¶çš„åº”æ€¥æ–¹æ¡ˆ</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    A[æ˜¾å­˜ä¸è¶³ OOM] --&gt; B{å¯è¡Œæ–¹æ¡ˆ}
    
    B --&gt; C[é™ä½é‡åŒ–ç²¾åº¦]
    B --&gt; D[å‡å°ä¸Šä¸‹æ–‡é•¿åº¦]
    B --&gt; E[å¯ç”¨ CPU Offload]
    B --&gt; F[åˆ‡æ¢åˆ°æ›´å°æ¨¡å‹]
    
    C --&gt; C1["Q5 â†’ Q4 â†’ Q3"]
    D --&gt; D1["256K â†’ 32K â†’ 8K"]
    E --&gt; E1["éƒ¨åˆ†å±‚æ”¾ CPU"]
    F --&gt; F1["30B â†’ 14B â†’ 7B"]
    
    C1 --&gt; G{æµ‹è¯•èƒ½å¦è¿è¡Œ}
    D1 --&gt; G
    E1 --&gt; G
    F1 --&gt; G
    
    G --&gt;|æˆåŠŸ| H[éƒ¨ç½²å®Œæˆ]
    G --&gt;|å¤±è´¥| I[å‡çº§ç¡¬ä»¶]

</code></pre>
<hr/>
<h3 data-id="heading-30">ç¬¬ä¹éƒ¨åˆ†:å¸¸è§é—®é¢˜ FAQ</h3>
<h4 data-id="heading-31">Q1: ä¸ºä»€ä¹ˆæˆ‘çš„æ˜¾å­˜å ç”¨æ¯”é¢„æœŸé«˜?</h4>
<p><strong>å¯èƒ½åŸå› </strong>:</p>
<ul>
<li>æ¨ç†æ¡†æ¶é¢„åˆ†é…äº†é¢å¤–ç¼“å†²åŒº</li>
<li>å¤šä¸ªè¿›ç¨‹åŒæ—¶ä½¿ç”¨ GPU</li>
<li>æ˜¾å­˜ç¢ç‰‡åŒ–(é•¿æ—¶é—´è¿è¡Œå)</li>
</ul>
<p><strong>è§£å†³æ–¹æ³•</strong>:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹å®é™…å ç”¨</span>
nvidia-smi

<span class="hljs-comment"># æ¸…ç† GPU ç¼“å­˜(PyTorch)</span>
torch.cuda.empty_cache()

<span class="hljs-comment"># é™åˆ¶æ¡†æ¶æœ€å¤§æ˜¾å­˜ä½¿ç”¨</span>
<span class="hljs-built_in">export</span> PYTORCH_CUDA_ALLOC_CONF=max_split_size_mb:512
</code></pre>
<h4 data-id="heading-32">Q2: INT4 é‡åŒ–ä¼šæŸå¤±å¤šå°‘ç²¾åº¦?</h4>
<p><strong>å®æµ‹å¯¹æ¯”</strong>(C-Eval åŸºå‡†):</p>


























<table><thead><tr><th>æ¨¡å‹</th><th>FP16</th><th>Q8_0</th><th>Q5_K_M</th><th>Q4_K_M</th></tr></thead><tbody><tr><td>Qwen-7B</td><td>62.3%</td><td>62.1%</td><td>61.8%</td><td>60.9%</td></tr><tr><td>Llama-13B</td><td>51.2%</td><td>51.0%</td><td>50.5%</td><td>49.2%</td></tr></tbody></table>
<p><strong>ç»“è®º</strong>: Q4_K_M å¯¹ä¸­æ–‡æ¨¡å‹å½±å“ &lt; 2%,è‹±æ–‡æ¨¡å‹ &lt; 3%</p>
<h4 data-id="heading-33">Q3: å¦‚ä½•ç›‘æ§å®æ—¶æ˜¾å­˜å ç”¨?</h4>
<p><strong>å·¥å…·æ¨è</strong>:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ–¹æ³•1: nvidia-smi å®æ—¶ç›‘æ§</span>
watch -n 1 nvidia-smi

<span class="hljs-comment"># æ–¹æ³•2: nvtop(æ›´å‹å¥½çš„ç•Œé¢)</span>
sudo apt install nvtop
nvtop

<span class="hljs-comment"># æ–¹æ³•3: Python è„šæœ¬</span>
import torch
<span class="hljs-built_in">print</span>(f<span class="hljs-string">"å·²ç”¨: {torch.cuda.memory_allocated()/1e9:.2f} GB"</span>)
<span class="hljs-built_in">print</span>(f<span class="hljs-string">"é¢„ç•™: {torch.cuda.memory_reserved()/1e9:.2f} GB"</span>)
</code></pre>
<hr/>
<hr/>
<h3 data-id="heading-34">æœ€ç»ˆç»“è®º:æ˜¾å­˜ä¼°ç®—çš„é»„é‡‘æ³•åˆ™</h3>
<h4 data-id="heading-35">è®°ä½è¿™ä¸‰ä¸ªå…³é”®ç‚¹</h4>
<ol>
<li><strong>åŸºç¡€éœ€æ±‚</strong>: æ¨¡å‹æ–‡ä»¶å¤§å° Ã— 1.2</li>
<li><strong>ä¸Šä¸‹æ–‡å½±å“</strong>: é•¿æ–‡æ¡£åœºæ™¯ +8-30 GB</li>
<li><strong>å®‰å…¨ä½™é‡</strong>: æ€»æ˜¯é¢„ç•™ 20% ä»¥ä¸Šç¼“å†²</li>
</ol>
<h4 data-id="heading-36">æœ€ç»ˆå…¬å¼</h4>
<pre><code class="hljs language-bash" lang="bash">æ‰€éœ€æ˜¾å­˜ = æ¨¡å‹å¤§å° Ã— 1.2 + KV Cache(ä¸Šä¸‹æ–‡ç›¸å…³) + 3-5 GB ä½™é‡
</code></pre>
<h4 data-id="heading-37">é€‰å‹å»ºè®®</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[ç¡®å®šé¢„ç®—] --&gt; B{æ˜¾å­˜å®¹é‡}
    
    B --&gt;|8-12 GB| C[7B æ¨¡å‹&lt;br/&gt;Q4 é‡åŒ–&lt;br/&gt;çŸ­ä¸Šä¸‹æ–‡]
    B --&gt;|16-20 GB| D[14B æ¨¡å‹&lt;br/&gt;Q4/Q5 é‡åŒ–&lt;br/&gt;ä¸­ç­‰ä¸Šä¸‹æ–‡]
    B --&gt;|24-32 GB| E[30B æ¨¡å‹&lt;br/&gt;Q4 é‡åŒ–&lt;br/&gt;æˆ– 14B FP16]
    B --&gt;|40+ GB| F[70B æ¨¡å‹&lt;br/&gt;æˆ– 30B FP16&lt;br/&gt;é•¿ä¸Šä¸‹æ–‡]
    
    C --&gt; G[é€‚åˆ: ä¸ªäººå¼€å‘è€…]
    D --&gt; H[é€‚åˆ: å°å›¢é˜Ÿ]
    E --&gt; I[é€‚åˆ: ä¸­å‹ä¼ä¸š]
    F --&gt; J[é€‚åˆ: ç ”ç©¶æœºæ„]
</code></pre>
<p>ç°åœ¨,å½“æœ‰äººé—®ä½ "éƒ¨ç½²å¤§æ¨¡å‹éœ€è¦å¤šå°‘æ˜¾å­˜"æ—¶,ä½ å°±å¯ä»¥è‡ªä¿¡åœ°å›ç­”äº†!</p>
<hr/>
<h3 data-id="heading-38">GPUæ˜¾å­˜è®¡ç®—å™¨</h3>
<p><strong>å¦‚æœä½ ä¸æƒ³åŠ¨è„‘ç­‹å»ç®— ï¼Œå»æ‰¾éœ€è¦ç”¨ä»€ä¹ˆæ ·çš„è®¾å¤‡ï¼Œå·§äº†åˆšå¥½æˆ‘åšäº†ä¸€ä¸ªå¤§æ¨¡å‹GPUè®¡ç®—å™¨</strong>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b172d7887a94468f962d375f0bac757e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZC05L2z5rWp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765735171&amp;x-signature=qBVy%2F0y983WdS2oVJ4J9ZhTaszw%3D" alt="image.png" loading="lazy"/></p>
<p>ç‚¹å‡»è¿™é‡Œè¯•è¯•çœ‹ä½ çš„è®¾å¤‡èƒ½éƒ¨ç½²å¤šå¤§çš„æ¨¡å‹å§ğŸ‘‰ğŸ‘‰ğŸ‘‰<a href="https://link.juejin.cn?target=https%3A%2F%2Fxiaobingan.github.io%2Fgpu-calculator%2F" target="_blank" title="https://xiaobingan.github.io/gpu-calculator/" ref="nofollow noopener noreferrer">GPUæ˜¾å­˜è®¡ç®—å™¨</a></p>
<p><strong>å‚è€ƒèµ„æº</strong>:</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fhuggingface.co%2Fspaces%2Fhf-accelerate%2Fmodel-memory-usage" target="_blank" title="https://huggingface.co/spaces/hf-accelerate/model-memory-usage" ref="nofollow noopener noreferrer">Hugging Face Model Memory Calculator</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvllm-project%2Fvllm" target="_blank" title="https://github.com/vllm-project/vllm" ref="nofollow noopener noreferrer">vLLM Performance Benchmarks</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fggerganov%2Fllama.cpp" target="_blank" title="https://github.com/ggerganov/llama.cpp" ref="nofollow noopener noreferrer">llama.cpp Quantization Guide</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è¿˜åœ¨æ‰‹åŠ¨å¤„ç†é¡µé¢è·³è½¬ï¼ŸæŒæ¡Vue Router 4ï¼Œä½ çš„å¯¼èˆªæ•ˆç‡ç¿»å€ï¼]]></title>    <link>https://juejin.cn/post/7580389111921705023</link>    <guid>https://juejin.cn/post/7580389111921705023</guid>    <pubDate>2025-12-07T23:29:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580389111921705023" data-draft-id="7580389111921688639" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è¿˜åœ¨æ‰‹åŠ¨å¤„ç†é¡µé¢è·³è½¬ï¼ŸæŒæ¡Vue Router 4ï¼Œä½ çš„å¯¼èˆªæ•ˆç‡ç¿»å€ï¼"/> <meta itemprop="keywords" content="vue-router,JavaScript,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-07T23:29:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‰¯å±±æœ‰é£æ¥"/> <meta itemprop="url" content="https://juejin.cn/user/3940246036939358"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è¿˜åœ¨æ‰‹åŠ¨å¤„ç†é¡µé¢è·³è½¬ï¼ŸæŒæ¡Vue Router 4ï¼Œä½ çš„å¯¼èˆªæ•ˆç‡ç¿»å€ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3940246036939358/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‰¯å±±æœ‰é£æ¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T23:29:55.000Z" title="Sun Dec 07 2025 23:29:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ‹å‹ä»¬ï¼Œä½ ä»¬æœ‰æ²¡æœ‰åœ¨å¼€å‘Vueåº”ç”¨æ—¶ï¼Œå¯¹ç€é¡µé¢è·³è½¬å’Œæƒé™ç®¡ç†å¤´ç–¼è¿‡ï¼Ÿæ‰‹åŠ¨æ‹¼æ¥URLï¼Ÿè‡ªå·±å¤„ç†å‰è¿›åé€€ï¼Ÿç”¨æˆ·æ²¡ç™»å½•ä¹Ÿèƒ½è¿›å…¥ç®¡ç†åå°ï¼Ÿåˆ«æ‹…å¿ƒï¼Œä»Šå¤©æˆ‘ä»¬å°±æ¥å½»åº•æå®šVue Router 4ã€‚</p>
<p>Vue Routeræ˜¯Vue.jså®˜æ–¹çš„è·¯ç”±ç®¡ç†å™¨ï¼Œå®ƒèƒ½è®©ä½ ç”¨ç»„ä»¶åŒ–çš„æ€ç»´æ¥ç®¡ç†ä½ çš„é¡µé¢å’Œè§†å›¾ã€‚è¯´ç™½äº†ï¼Œå°±æ˜¯è®©ä½ çš„å•é¡µé¢åº”ç”¨çœ‹èµ·æ¥åƒæ˜¯æœ‰å¾ˆå¤šä¸ªâ€œé¡µé¢â€ä¸€æ ·ï¼Œå¹¶ä¸”èƒ½æ— ç¼åœ°åœ¨å®ƒä»¬ä¹‹é—´è·³è½¬ã€‚ä»åŸºç¡€çš„è·¯å¾„é…ç½®åˆ°é«˜çº§çš„å¯¼èˆªå®ˆå«ï¼Œè¿™ç¯‡æ–‡ç« ä¼šå¸¦ä½ ä»é›¶å¼€å§‹ï¼Œå¿«é€Ÿä¸Šæ‰‹ã€‚ç›¸ä¿¡æˆ‘ï¼Œå­¦å®Œå®ƒï¼Œä½ çš„å¼€å‘ä½“éªŒä¼šé¡ºç•…å¾—å¤šã€‚</p>
<h2 data-id="heading-0">å…ˆè®©ä½ çš„é¡¹ç›®â€œåŠ¨â€èµ·æ¥ï¼šå®‰è£…ä¸åŸºç¡€é…ç½®</h2>
<p>ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬å¾—æŠŠå®ƒè¯·è¿›é¡¹ç›®é‡Œã€‚æ‰“å¼€ä½ çš„ç»ˆç«¯ï¼Œåœ¨ä½ Vueé¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ï¼Œè¿è¡Œè¿™æ¡å‘½ä»¤ã€‚å‡è®¾ä½ ç”¨çš„æ˜¯Vue 3é¡¹ç›®ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">npm install vue-router@4
</code></pre>
<p>å®‰è£…å¥½äº†ï¼Œæˆ‘ä»¬å°±æ¥åˆ›å»ºè·¯ç”±çš„æ ¸å¿ƒâ€”â€”è·¯ç”±å®ä¾‹ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬ä¼šåœ¨ä¸€ä¸ªå•ç‹¬çš„<code>src/router/index.js</code>æ–‡ä»¶ä¸­åšè¿™ä»¶äº‹ã€‚è·Ÿç€ä¸‹é¢çš„ä»£ç èµ°ä¸€éï¼Œä½ å°±æ˜ç™½äº†ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// src/router/index.js</span>
<span class="hljs-comment">// 1. å¯¼å…¥å¿…è¦çš„å‡½æ•°å’Œç»„ä»¶</span>
<span class="hljs-keyword">import</span> { createRouter, createWebHistory } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>
<span class="hljs-comment">// 2. å¯¼å…¥ä½ å¸Œæœ›æˆä¸ºâ€œé¡µé¢â€çš„Vueç»„ä»¶</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">HomeView</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../views/HomeView.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">AboutView</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../views/AboutView.vue'</span>

<span class="hljs-comment">// 3. å®šä¹‰è·¯ç”±è§„åˆ™æ•°ç»„</span>
<span class="hljs-keyword">const</span> routes = [
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/'</span>, <span class="hljs-comment">// å½“æµè§ˆå™¨åœ°å€æ˜¯æ ¹è·¯å¾„æ—¶</span>
    <span class="hljs-attr">name</span>: <span class="hljs-string">'home'</span>, <span class="hljs-comment">// ç»™è·¯ç”±èµ·ä¸ªåå­—ï¼Œæ–¹ä¾¿è·³è½¬</span>
    <span class="hljs-attr">component</span>: <span class="hljs-title class_">HomeView</span> <span class="hljs-comment">// æ˜¾ç¤ºHomeViewè¿™ä¸ªç»„ä»¶</span>
  },
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/about'</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'about'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-title class_">AboutView</span>
  }
]

<span class="hljs-comment">// 4. åˆ›å»ºè·¯ç”±å®ä¾‹</span>
<span class="hljs-keyword">const</span> router = <span class="hljs-title function_">createRouter</span>({
  <span class="hljs-comment">// ä½¿ç”¨HTML5çš„å†å²æ¨¡å¼ï¼ŒURLçœ‹èµ·æ¥æ›´å¹²å‡€ï¼ˆæ¯”å¦‚ /aboutï¼‰</span>
  <span class="hljs-comment">// å¦ä¸€ç§æ¨¡å¼æ˜¯ createWebHashHistoryï¼ŒURLä¼šå¸¦#å·</span>
  <span class="hljs-attr">history</span>: <span class="hljs-title function_">createWebHistory</span>(),
  routes <span class="hljs-comment">// ç®€å†™ï¼Œç­‰åŒäº routes: routes</span>
})

<span class="hljs-comment">// 5. å¯¼å‡ºè¿™ä¸ªå®ä¾‹ï¼Œåœ¨main.jsä¸­ä¼šç”¨åˆ°</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> router
</code></pre>
<p>åˆ›å»ºå¥½è·¯ç”±å®ä¾‹åï¼Œæˆ‘ä»¬éœ€è¦å‘Šè¯‰Vueåº”ç”¨å»ä½¿ç”¨å®ƒã€‚æ‰¾åˆ°ä½ çš„åº”ç”¨å…¥å£æ–‡ä»¶<code>src/main.js</code>ï¼Œåƒä¸‹é¢è¿™æ ·ä¿®æ”¹ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// src/main.js</span>
<span class="hljs-keyword">import</span> { createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./App.vue'</span>
<span class="hljs-comment">// å¯¼å…¥æˆ‘ä»¬åˆšæ‰åˆ›å»ºçš„è·¯ç”±å®ä¾‹</span>
<span class="hljs-keyword">import</span> router <span class="hljs-keyword">from</span> <span class="hljs-string">'./router'</span>

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)

<span class="hljs-comment">// ä½¿ç”¨è·¯ç”±æ’ä»¶</span>
app.<span class="hljs-title function_">use</span>(router)

app.<span class="hljs-title function_">mount</span>(<span class="hljs-string">'#app'</span>)
</code></pre>
<p>æœ€åä¸€æ­¥ï¼Œæˆ‘ä»¬å¾—åœ¨æ ¹ç»„ä»¶<code>App.vue</code>é‡Œæ”¾ä¸€ä¸ªâ€œæ’åº§â€ï¼Œè·¯ç”±åŒ¹é…åˆ°çš„ç»„ä»¶å°±ä¼šåœ¨è¿™ä¸ªâ€œæ’åº§â€é‡Œæ˜¾ç¤ºå‡ºæ¥ã€‚</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- src/App.vue --&gt;
&lt;template&gt;
  &lt;div id="app"&gt;
    &lt;nav&gt;
      &lt;!-- ä½¿ç”¨ router-link ç»„ä»¶è¿›è¡Œå¯¼èˆªï¼Œå®ƒä¼šè¢«æ¸²æŸ“æˆä¸€ä¸ª &lt;a&gt; æ ‡ç­¾ --&gt;
      &lt;router-link to="/"&gt;é¦–é¡µ&lt;/router-link&gt; |
      &lt;router-link to="/about"&gt;å…³äº&lt;/router-link&gt;
    &lt;/nav&gt;
    &lt;!-- è·¯ç”±åŒ¹é…åˆ°çš„ç»„ä»¶å°†åœ¨è¿™é‡Œè¢«æ¸²æŸ“ï¼Œè¿™å°±æ˜¯é‚£ä¸ªâ€œæ’åº§â€ --&gt;
    &lt;router-view /&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<p>å¥½äº†ï¼ç°åœ¨è¿è¡Œä½ çš„é¡¹ç›®ï¼Œç‚¹å‡»â€œé¦–é¡µâ€å’Œâ€œå…³äºâ€ï¼Œä½ åº”è¯¥èƒ½çœ‹åˆ°é¡µé¢å†…å®¹åœ¨<code>&lt;router-view /&gt;</code>çš„ä½ç½®åˆ‡æ¢äº†ï¼Œè€Œæµè§ˆå™¨åœ°å€æ çš„URLä¹Ÿä¼šè·Ÿç€å˜åŒ–ã€‚æ­å–œï¼Œä½ çš„ç¬¬ä¸€ä¸ªå¸¦è·¯ç”±çš„Vueåº”ç”¨è·‘é€šäº†ï¼</p>
<h2 data-id="heading-1">è¿›é˜¶å¯¼èˆªï¼šå¦‚ä½•åœ¨ä¸åŒé¡µé¢é—´ç©¿æ¢­</h2>
<p>å…‰èƒ½æ˜¾ç¤ºé¡µé¢è¿˜ä¸å¤Ÿï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦åœ¨ä»£ç é‡Œæ§åˆ¶è·³è½¬ï¼Œæ¯”å¦‚ç™»å½•æˆåŠŸåè‡ªåŠ¨è·³è½¬åˆ°ä¸»é¡µã€‚æœ‰ä¸¤ç§ä¸»è¦æ–¹å¼ã€‚</p>
<p><strong>ç¬¬ä¸€ç§ï¼Œå£°æ˜å¼å¯¼èˆª</strong>ã€‚å°±åƒä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬ç”¨<code>&lt;router-link&gt;</code>æ ‡ç­¾ã€‚å®ƒæ¯”ç”¨<code>&lt;a href="..."&gt;</code>å¥½åœ¨ï¼Œå®ƒæ˜¯åœ¨å•é¡µé¢åº”ç”¨å†…éƒ¨è·³è½¬ï¼Œä¸ä¼šçœŸçš„å‘æœåŠ¡å™¨é‡æ–°åŠ è½½é¡µé¢ï¼Œé€Ÿåº¦é£å¿«ã€‚</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;!-- ä½¿ç”¨â€˜toâ€™å±æ€§æŒ‡å®šç›®æ ‡åœ°å€ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯è·¯ç”±å¯¹è±¡ --&gt;
  &lt;router-link to="/about"&gt;å»å…³äºé¡µé¢&lt;/router-link&gt;

  &lt;!-- æ›´æ¨èä½¿ç”¨å‘½åè·¯ç”±ï¼Œè¿™æ ·å³ä½¿ä½ æ”¹äº†pathè·¯å¾„ï¼Œè¿™é‡Œçš„é“¾æ¥ä¹Ÿä¸ç”¨æ”¹ --&gt;
  &lt;router-link :to="{ name: 'home' }"&gt;è¿”å›é¦–é¡µ&lt;/router-link&gt;

  &lt;!-- ç”šè‡³å¯ä»¥å¸¦å‚æ•° --&gt;
  &lt;router-link :to="{ name: 'user', params: { id: 123 } }"&gt;æŸ¥çœ‹ç”¨æˆ·123&lt;/router-link&gt;
&lt;/template&gt;
</code></pre>
<p><strong>ç¬¬äºŒç§ï¼Œç¼–ç¨‹å¼å¯¼èˆª</strong>ã€‚åœ¨ä½ çš„ç»„ä»¶æ–¹æ³•é‡Œï¼Œé€šè¿‡<code>this.$router</code>ï¼ˆåœ¨ç»„åˆå¼APIä¸­æ˜¯<code>useRouter()</code>ï¼‰æ¥è·³è½¬ã€‚è¿™ç»™äº†ä½ æœ€å¤§çš„çµæ´»æ€§ã€‚</p>
<pre><code class="hljs language-vue" lang="vue">&lt;script&gt;
// é€‰é¡¹å¼ API å†™æ³•
export default {
  methods: {
    goToAboutPage() {
      // å’Œ router-link çš„ `to` å±æ€§ä¸€æ ·ï¼Œå¯ä»¥æ¥å—è·¯å¾„æˆ–è·¯ç”±å¯¹è±¡
      this.$router.push('/about')
      // æˆ–è€…
      this.$router.push({ name: 'about' })
    },
    goBack() {
      // è¿”å›ä¸Šä¸€é¡µï¼Œç›¸å½“äºæµè§ˆå™¨çš„åé€€æŒ‰é’®
      this.$router.back()
    },
    replaceHome() {
      // ç”¨â€˜æ›¿æ¢â€™çš„æ–¹å¼è·³è½¬ï¼Œä¸ä¼šåœ¨å†å²è®°å½•é‡Œç•™ä¸‹å½“å‰é¡µ
      this.$router.replace({ name: 'home' })
    }
  }
}
&lt;/script&gt;
</code></pre>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
// ç»„åˆå¼ API å†™æ³•ï¼ˆç°åœ¨æ›´å¸¸ç”¨ï¼‰
import { useRouter } from 'vue-router'

const router = useRouter()

const goToAboutPage = () =&gt; {
  router.push('/about')
}
const goBack = () =&gt; {
  router.back()
}
&lt;/script&gt;
</code></pre>
<h2 data-id="heading-2">è®©è·¯ç”±æ´»èµ·æ¥ï¼šåŠ¨æ€è·¯ç”±ä¸å‚æ•°ä¼ é€’</h2>
<p>å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬çš„è·¯å¾„ä¸æ˜¯å›ºå®šçš„ï¼Œæ¯”å¦‚ç”¨æˆ·è¯¦æƒ…é¡µ<code>/user/1</code>å’Œ<code>/user/2</code>ã€‚è¿™å°±éœ€è¦åŠ¨æ€è·¯ç”±ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åœ¨è·¯ç”±è§„åˆ™ä¸­ï¼Œç”¨å†’å· : æ¥æ ‡è®°åŠ¨æ€éƒ¨åˆ†</span>
<span class="hljs-keyword">const</span> routes = [
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/user/:id'</span>, <span class="hljs-comment">// `:id`å°±æ˜¯ä¸€ä¸ªåŠ¨æ€å‚æ•°</span>
    <span class="hljs-attr">name</span>: <span class="hljs-string">'user'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-title class_">UserView</span>
  }
]
</code></pre>
<p>åœ¨ç›®æ ‡ç»„ä»¶<code>UserView.vue</code>é‡Œï¼Œæˆ‘ä»¬æ€ä¹ˆæ‹¿åˆ°è¿™ä¸ª<code>id</code>å‘¢ï¼Ÿé€šè¿‡<code>useRoute()</code>è¿™ä¸ªå‡½æ•°ã€‚</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- src/views/UserView.vue --&gt;
&lt;template&gt;
  &lt;div&gt;
    &lt;h2&gt;ç”¨æˆ·è¯¦æƒ…é¡µ&lt;/h2&gt;
    &lt;!-- åœ¨æ¨¡æ¿ä¸­ç›´æ¥ä½¿ç”¨ --&gt;
    &lt;p&gt;å½“å‰ç”¨æˆ·IDæ˜¯ï¼š{{ $route.params.id }}&lt;/p&gt;
    &lt;p&gt;å¦ä¸€ç§æ–¹å¼è·å¾—çš„IDï¼š{{ userId }}&lt;/p&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { useRoute } from 'vue-router'
import { computed } from 'vue'

// ä½¿ç”¨ useRoute() è·å–å½“å‰è·¯ç”±ä¿¡æ¯
const route = useRoute()

// åŠ¨æ€å‚æ•°æ˜¯å“åº”å¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è®¡ç®—å±æ€§æ¥è·å–
const userId = computed(() =&gt; route.params.id)

// ä½ ä¹Ÿå¯ä»¥é€šè¿‡ route.query è·å–æŸ¥è¯¢å‚æ•°
// æ¯”å¦‚ /user/123?name=zhangsanï¼Œåˆ™ route.query.name ä¸º â€˜zhangsanâ€™
const userName = computed(() =&gt; route.query.name)
&lt;/script&gt;
</code></pre>
<p>é™¤äº†é€šè¿‡URLï¼ˆ<code>params</code>, <code>query</code>ï¼‰ä¼ é€’å‚æ•°ï¼Œä½ è¿˜å¯ä»¥ç”¨<code>props</code>ä¼ å‚ï¼Œè®©ç»„ä»¶æ›´å¹²å‡€ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åœ¨è·¯ç”±è§„åˆ™ä¸­å¼€å¯ props ä¼ å‚</span>
<span class="hljs-keyword">const</span> routes = [
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/user/:id'</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'user'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-title class_">UserView</span>,
    <span class="hljs-attr">props</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">// å°† route.params ä½œä¸ºç»„ä»¶çš„ props ä¼ å…¥</span>
    <span class="hljs-comment">// æˆ–è€…ä½¿ç”¨å‡½æ•°æ¨¡å¼ï¼Œå®ç°æ›´çµæ´»çš„æ§åˆ¶</span>
    <span class="hljs-comment">// props: (route) =&gt; ({ id: Number(route.params.id) })</span>
  }
]
</code></pre>
<p>ç„¶åä½ çš„ç»„ä»¶å°±å¯ä»¥åƒæ¥æ”¶æ™®é€š<code>props</code>ä¸€æ ·æ¥æ”¶å®ƒäº†ã€‚</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- src/views/UserView.vue --&gt;
&lt;script setup&gt;
// ç›´æ¥å®šä¹‰ props
defineProps({
  id: {
    type: [String, Number],
    required: true
  }
})
&lt;/script&gt;

&lt;template&gt;
  &lt;div&gt;ç”¨æˆ·IDæ˜¯ï¼š{{ id }}&lt;/div&gt;
&lt;/template&gt;
</code></pre>
<h2 data-id="heading-3">é¡¹ç›®çš„â€œå®ˆé—¨ç¥â€ï¼šè·¯ç”±å®ˆå«æ·±åº¦è§£æ</h2>
<p>é‡å¤´æˆæ¥äº†ï¼è·¯ç”±å®ˆå«æ˜¯Vue Routeré‡Œéå¸¸å¼ºå¤§çš„ä¸€ç¯ï¼Œå®ƒå…è®¸ä½ åœ¨å¯¼èˆªå‘ç”Ÿå‰ã€å‘ç”Ÿåè¿›è¡Œæ‹¦æˆªæˆ–å¤„ç†ã€‚æœ€å¸¸è§çš„åœºæ™¯å°±æ˜¯ï¼šæ£€æŸ¥ç”¨æˆ·æ˜¯å¦ç™»å½•ã€‚</p>
<p><strong>å…¨å±€å‰ç½®å®ˆå«<code>router.beforeEach</code></strong>ï¼šè¿™æ˜¯æœ€å¸¸ç”¨çš„å®ˆå«ï¼Œåœ¨æ¯ä¸€æ¬¡å¯¼èˆªå¼€å§‹æ—¶è§¦å‘ã€‚æˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œåšæƒé™æ£€æŸ¥ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å›åˆ°ä½ çš„ src/router/index.js</span>
<span class="hljs-comment">// åœ¨åˆ›å»ºå¹¶å¯¼å‡º router å®ä¾‹ä¹‹åï¼Œå¯ä»¥æ·»åŠ å®ˆå«</span>

<span class="hljs-comment">// ... createRouter ä»£ç  ...</span>

<span class="hljs-comment">// æ·»åŠ å…¨å±€å‰ç½®å®ˆå«</span>
router.<span class="hljs-title function_">beforeEach</span>(<span class="hljs-function">(<span class="hljs-params">to, <span class="hljs-keyword">from</span>, next</span>) =&gt;</span> {
  <span class="hljs-comment">// to: å³å°†è¦è¿›å…¥çš„ç›®æ ‡è·¯ç”±å¯¹è±¡</span>
  <span class="hljs-comment">// from: å½“å‰å¯¼èˆªæ­£è¦ç¦»å¼€çš„è·¯ç”±å¯¹è±¡</span>
  <span class="hljs-comment">// next: ä¸€ä¸ªå‡½æ•°ï¼Œå¿…é¡»è°ƒç”¨å®ƒæ¥è§£æè¿™ä¸ªå®ˆå«</span>

  <span class="hljs-comment">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•çš„ç™»å½•æ£€æŸ¥</span>
  <span class="hljs-keyword">const</span> isAuthenticated = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'token'</span>) <span class="hljs-comment">// ä»æœ¬åœ°å­˜å‚¨è¯»å–token</span>

  <span class="hljs-comment">// å¦‚æœç”¨æˆ·æƒ³å»ä¸€ä¸ªéœ€è¦ç™»å½•çš„é¡µé¢ï¼ˆæ¯”å¦‚é¡µé¢å…ƒä¿¡æ¯é‡Œæ ‡è®°äº† requiresAuth: trueï¼‰</span>
  <span class="hljs-keyword">if</span> (to.<span class="hljs-property">meta</span>.<span class="hljs-property">requiresAuth</span> &amp;&amp; !isAuthenticated) {
    <span class="hljs-comment">// æŠŠä»–é‡å®šå‘åˆ°ç™»å½•é¡µ</span>
    <span class="hljs-title function_">next</span>({
      <span class="hljs-attr">name</span>: <span class="hljs-string">'login'</span>,
      <span class="hljs-comment">// å¯ä»¥é™„å¸¦ä¸€ä¸ªæŸ¥è¯¢å‚æ•°ï¼Œè®°å½•ä»–åŸæœ¬æƒ³å»å“ªé‡Œï¼Œç™»å½•åç›´æ¥è·³è¿‡å»</span>
      <span class="hljs-attr">query</span>: { <span class="hljs-attr">redirect</span>: to.<span class="hljs-property">fullPath</span> }
    })
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// æ”¾è¡Œï¼Œå»å¾€ç›®æ ‡é¡µé¢</span>
    <span class="hljs-title function_">next</span>()
  }
})
</code></pre>
<p><strong>è·¯ç”±ç‹¬äº«çš„å®ˆå«<code>beforeEnter</code></strong>ï¼šä½ å¯ä»¥åªä¸ºæŸä¸€æ¡è·¯ç”±è§„åˆ™å®šä¹‰å®ˆå«ï¼Œå®ƒåªåœ¨è¿›å…¥è¯¥è·¯ç”±æ—¶è§¦å‘ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> routes = [
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/admin'</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'admin'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-title class_">AdminView</span>,
    <span class="hljs-attr">meta</span>: { <span class="hljs-attr">requiresAdmin</span>: <span class="hljs-literal">true</span> }, <span class="hljs-comment">// è‡ªå®šä¹‰å…ƒä¿¡æ¯ï¼Œæ ‡è®°éœ€è¦ç®¡ç†å‘˜æƒé™</span>
    <span class="hljs-attr">beforeEnter</span>: <span class="hljs-function">(<span class="hljs-params">to, <span class="hljs-keyword">from</span>, next</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> userRole = <span class="hljs-title function_">getUserRoleSomehow</span>() <span class="hljs-comment">// å‡è®¾æœ‰ä¸ªè·å–ç”¨æˆ·è§’è‰²çš„æ–¹æ³•</span>
      <span class="hljs-keyword">if</span> (userRole === <span class="hljs-string">'admin'</span>) {
        <span class="hljs-title function_">next</span>() <span class="hljs-comment">// æ˜¯ç®¡ç†å‘˜ï¼Œå…è®¸è¿›å…¥</span>
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-title function_">next</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'forbidden'</span> }) <span class="hljs-comment">// ä¸æ˜¯ç®¡ç†å‘˜ï¼Œè·³è½¬åˆ°æ— æƒé™é¡µé¢</span>
      }
    }
  }
]
</code></pre>
<p><strong>ç»„ä»¶å†…çš„å®ˆå«</strong>ï¼šä½ è¿˜å¯ä»¥åœ¨ç»„ä»¶å†…éƒ¨å®šä¹‰å®ˆå«ã€‚</p>
<ul>
<li><code>onBeforeRouteUpdate</code>ï¼šå½“å‰ç»„ä»¶å¤ç”¨æ—¶ï¼ˆä»…å‚æ•°å˜åŒ–ï¼‰è°ƒç”¨ï¼Œéå¸¸é€‚åˆç”¨æ¥æ ¹æ®æ–°å‚æ•°è·å–æ•°æ®ã€‚</li>
<li><code>onBeforeRouteLeave</code>ï¼šç¦»å¼€è¯¥ç»„ä»¶æ—¶è°ƒç”¨ï¼Œå¯ä»¥ç”¨æ¥é˜²æ­¢ç”¨æˆ·åœ¨ç¼–è¾‘è¡¨å•æ—¶è¯¯æ“ä½œç¦»å¼€ã€‚</li>
</ul>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
import { onBeforeRouteLeave, onBeforeRouteUpdate } from 'vue-router'

// å®ˆå«1ï¼šç¦»å¼€ç»„ä»¶å‰æç¤ºç”¨æˆ·
onBeforeRouteLeave((to, from) =&gt; {
  const answer = window.confirm('ä½ æœ‰æœªä¿å­˜çš„æ›´æ”¹ï¼Œç¡®å®šè¦ç¦»å¼€å—ï¼Ÿ')
  // å¦‚æœç”¨æˆ·å–æ¶ˆï¼Œå°±å–æ¶ˆè¿™æ¬¡å¯¼èˆª
  if (!answer) return false
})

// å®ˆå«2ï¼šå½“è·¯ç”±æ›´æ–°ï¼ˆæ¯”å¦‚ä» /user/1 è·³è½¬åˆ° /user/2ï¼‰æ—¶ï¼Œé‡æ–°è·å–æ•°æ®
import { fetchUserData } from '@/api'
onBeforeRouteUpdate(async (to) =&gt; {
  // ç»„ä»¶å®ä¾‹å¤ç”¨ï¼Œä½†å‚æ•°ä» 1 å˜æˆäº† 2
  // åœ¨è¿™é‡Œç”¨æ–°çš„å‚æ•° to.params.id é‡æ–°è·å–ç”¨æˆ·æ•°æ®
  await fetchUserData(to.params.id)
})
&lt;/script&gt;
</code></pre>
<h2 data-id="heading-4">æœ€åï¼šå‡ æ¡è®©ä½ èµ°å¾—æ›´è¿œçš„å®æˆ˜å»ºè®®</h2>
<p>çœ‹åˆ°è¿™é‡Œï¼Œä½ å·²ç»æŒæ¡äº†Vue Router 4çš„æ ¸å¿ƒæŠ€èƒ½ã€‚ä¸ºäº†è®©ä½ çš„é¡¹ç›®ç»“æ„æ›´æ¸…æ™°ã€ä»£ç æ›´å¥å£®ï¼Œè¿™é‡Œè¿˜æœ‰å‡ ä¸ªå°è´´å£«ï¼š</p>
<p><strong>ç”¨å¥½è·¯ç”±å…ƒä¿¡æ¯<code>meta</code>å­—æ®µ</strong>ï¼šè¿™ä¸ªå­—æ®µå°±åƒç»™ä½ çš„è·¯ç”±è´´æ ‡ç­¾ï¼Œéå¸¸é€‚åˆåœ¨å…¨å±€å®ˆå«é‡Œåšç»Ÿä¸€çš„æƒé™åˆ¤æ–­ï¼Œæˆ–è€…åœ¨ç”Ÿæˆå¯¼èˆªèœå•æ—¶æ ‡è®°æ˜¯å¦éœ€è¦æ˜¾ç¤ºã€‚</p>
<p><strong>è€ƒè™‘è·¯ç”±æ‡’åŠ è½½</strong>ï¼šå½“ä½ çš„åº”ç”¨é¡µé¢å¾ˆå¤šæ—¶ï¼ŒæŠŠæ‰€æœ‰ç»„ä»¶çš„ä»£ç æ‰“åŒ…åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œä¼šè®©é¦–æ¬¡åŠ è½½å¾ˆæ…¢ã€‚è·¯ç”±æ‡’åŠ è½½å¯ä»¥è®©ä½ åœ¨è®¿é—®æŸä¸ªé¡µé¢æ—¶æ‰å»åŠ è½½å®ƒçš„ä»£ç ï¼Œå¤§å¹…æå‡é¦–å±é€Ÿåº¦ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> routes = [
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/about'</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'about'</span>,
    <span class="hljs-comment">// ä½¿ç”¨åŠ¨æ€ import è¯­æ³•ï¼ŒWebpack/Viteä¼šè‡ªåŠ¨è¿›è¡Œä»£ç åˆ†å‰²</span>
    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../views/AboutView.vue'</span>)
  }
]
</code></pre>
<p><strong>å¤„ç†å¥½404é¡µé¢</strong>ï¼šåœ¨è·¯ç”±è§„åˆ™çš„æœ€åï¼Œæ·»åŠ ä¸€ä¸ªé€šé…ç¬¦<code>*</code>çš„è·¯ç”±ï¼Œæ¥æ•è·æ‰€æœ‰æœªåŒ¹é…çš„è·¯å¾„ï¼Œå±•ç¤ºä¸€ä¸ªå‹å¥½çš„404é¡µé¢ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> routes = [
  <span class="hljs-comment">// ... ä½ çš„å…¶ä»–è·¯ç”± ...</span>
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/:pathMatch(.*)*'</span>, <span class="hljs-comment">// è¿™æ˜¯Vue Router 4çš„æ•è·æ‰€æœ‰è·¯ç”±çš„å†™æ³•</span>
    <span class="hljs-attr">name</span>: <span class="hljs-string">'not-found'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../views/NotFoundView.vue'</span>)
  }
]
</code></pre>
<p>å¥½äº†ï¼Œæˆ‘ä»¬ä»æœ€åŸºç¡€çš„å®‰è£…é…ç½®ï¼Œä¸€è·¯èŠåˆ°äº†åŠ¨æ€å‚æ•°å’Œå¼ºå¤§çš„è·¯ç”±å®ˆå«ã€‚ç°åœ¨å›å¤´çœ‹çœ‹ï¼Œé¡µé¢è·³è½¬ã€æƒé™æ§åˆ¶è¿™äº›è®©äººå¤´ç–¼çš„é—®é¢˜ï¼Œæ˜¯ä¸æ˜¯éƒ½æœ‰äº†æ¸…æ™°çš„è§£å†³æ€è·¯ï¼Ÿ</p>
<p>å…³é”®åœ¨äºåŠ¨æ‰‹å»è¯•ã€‚åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ï¼ŒæŠŠè¿™äº›ä»£ç ç¤ºä¾‹éƒ½æ•²ä¸€éï¼Œå†è¯•ç€ç»“åˆä½ çš„å®é™…ä¸šåŠ¡ï¼ˆæ¯”å¦‚ä»åç«¯APIè·å–ç”¨æˆ·æƒé™ï¼ŒåŠ¨æ€ç”Ÿæˆè·¯ç”±ï¼‰ï¼Œä½ å°±èƒ½çœŸæ­£é©¾é©­Vue Routerï¼Œè®©å®ƒæˆä¸ºä½ æ„å»ºå¤æ‚å•é¡µé¢åº”ç”¨çš„å¾—åŠ›åŠ©æ‰‹ã€‚åˆ«å†æ‰‹åŠ¨å¤„ç†é‚£äº›ç¹ççš„å¯¼èˆªé€»è¾‘äº†ï¼Œè®©Vue Routeræ¥å¸®ä½ ï¼Œæ•ˆç‡æå‡çœŸçš„ä¸æ­¢ä¸€ç‚¹ç‚¹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€é”™è¯¯ç›‘æ§ã€‘åˆ«åªåšå·¥å…·äººäº†ï¼æ‰‹æŠŠæ‰‹å¸¦ä½ å†™ä¸€ä¸ªå‰ç«¯é”™è¯¯ç›‘æ§ SDK]]></title>    <link>https://juejin.cn/post/7580674010837549102</link>    <guid>https://juejin.cn/post/7580674010837549102</guid>    <pubDate>2025-12-07T23:52:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580674010837549102" data-draft-id="7580295137396031503" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€é”™è¯¯ç›‘æ§ã€‘åˆ«åªåšå·¥å…·äººäº†ï¼æ‰‹æŠŠæ‰‹å¸¦ä½ å†™ä¸€ä¸ªå‰ç«¯é”™è¯¯ç›‘æ§ SDK"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,ç›‘æ§"/> <meta itemprop="datePublished" content="2025-12-07T23:52:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸ä¸€æ ·çš„å°‘å¹´_"/> <meta itemprop="url" content="https://juejin.cn/user/3035079961218551"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€é”™è¯¯ç›‘æ§ã€‘åˆ«åªåšå·¥å…·äººäº†ï¼æ‰‹æŠŠæ‰‹å¸¦ä½ å†™ä¸€ä¸ªå‰ç«¯é”™è¯¯ç›‘æ§ SDK
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3035079961218551/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸ä¸€æ ·çš„å°‘å¹´_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T23:52:43.000Z" title="Sun Dec 07 2025 23:52:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    18
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="" data-highlight-key="an-old-hope">.hljs-comment,.hljs-quote{color:#b6b18b}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#eb3c54}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#e7ce56}.hljs-attribute{color:#ee7c2b}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#4fb4d7}.hljs-section,.hljs-title{color:#78bb65}.hljs-keyword,.hljs-selector-tag{color:#b45ea4}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#1c1d21;color:#c0c5ce}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä½ æ˜¯å¦ä¸€ç›´å¯¹å‰ç«¯é”™è¯¯ç›‘æ§ç³»ç»Ÿçš„åº•å±‚åŸç†å……æ»¡å¥½å¥‡ï¼Ÿ</p>
<p>æƒ³çŸ¥é“é‚£äº›â€œé»‘ç§‘æŠ€â€æ˜¯å¦‚ä½•æ‹¦æˆªæŠ¥é”™ã€ä¸ŠæŠ¥æ•°æ®çš„å—ï¼Ÿ</p>
<p>ä¸å…¶åªåšå·¥å…·çš„ä½¿ç”¨è€…ï¼Œä¸å¦‚æ·±å…¥åº•å±‚ï¼Œæ¢å¯»å…¶èƒŒåçš„å®ç°æœºåˆ¶ã€‚</p>
<p>æœ¬æ–‡å°†ä»åŸç†è§’åº¦åˆ‡å…¥ï¼Œæ‰‹æŠŠæ‰‹å¸¦ä½ è®¾è®¡å¹¶å®ç°ä¸€ä¸ª<strong>è½»é‡çº§ã€åŠŸèƒ½å®Œå¤‡çš„å‰ç«¯é”™è¯¯ç›‘æ§ SDK</strong></p>
</blockquote>
<h2 data-id="heading-0">å­¦ä¹ å®Œæœ¬æ–‡ï¼Œä½ å°†æ”¶è·ä»€ä¹ˆï¼Ÿ</h2>
<p>é€šè¿‡æ‰‹å†™è¿™ä¸ª SDKï¼Œä½ ä¸ä»…èƒ½è·å¾—ä¸€ä¸ªå¯ç”¨çš„ç›‘æ§å·¥å…·ï¼Œæ›´èƒ½æ·±å…¥æŒæ¡ä»¥ä¸‹æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼š</p>
<ol>
<li><strong>æµè§ˆå™¨åº•å±‚åŸç†</strong>ï¼šäº‹ä»¶å†’æ³¡/æ•è·æœºåˆ¶ï¼Œä»¥åŠ <code>onerror</code>ã€<code>unhandledrejection</code> ç­‰ API çš„å·¥ä½œç»†èŠ‚ã€‚</li>
<li><strong>AOP é¢å‘åˆ‡é¢ç¼–ç¨‹</strong>ï¼šå­¦ä¼šå¦‚ä½•é€šè¿‡åŠ«æŒï¼ˆHookï¼‰åŸç”Ÿæ–¹æ³•ï¼ˆå¦‚ <code>XMLHttpRequest</code>ã€<code>fetch</code>ï¼‰æ¥å®ç°æ— æ„Ÿç›‘æ§ã€‚</li>
<li><strong>é«˜å¯é æ•°æ®ä¸ŠæŠ¥</strong>ï¼šæŒæ¡ <code>Navigator.sendBeacon</code> çš„ä½¿ç”¨åœºæ™¯ï¼Œç¡®ä¿åœ¨é¡µé¢å¸è½½æ—¶ä¹Ÿèƒ½ç¨³å®šä¸ŠæŠ¥æ•°æ®ã€‚</li>
<li><strong>å·¥ç¨‹åŒ–å®è·µ</strong>ï¼šä»æ¶æ„è®¾è®¡åˆ° NPM å‘å¸ƒï¼Œä½“éªŒå®Œæ•´çš„ SDK å¼€å‘å…¨æµç¨‹ã€‚</li>
</ol>
<h2 data-id="heading-1">1. æ¶æ„è®¾è®¡</h2>
<p>åˆ«è¢«â€œç›‘æ§ç³»ç»Ÿâ€è¿™å››ä¸ªå­—å“åˆ°äº†ã€‚æ‹†è§£ä¸‹æ¥ï¼Œæ ¸å¿ƒé€»è¾‘å°±ä¸‰æ­¥ï¼š<strong>ç›‘å¬ -&gt; æ”¶é›† -&gt; ä¸ŠæŠ¥</strong>ã€‚</p>
<p>åœ¨å¼€å§‹ç¼–ç ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¢³ç†ä¸€ä¸‹ SDK çš„æ•´ä½“æ¶æ„ã€‚æˆ‘ä»¬éœ€è¦ç›‘æ§ <strong>JS è¿è¡Œæ—¶é”™è¯¯</strong>ã€<strong>ç½‘ç»œè¯·æ±‚é”™è¯¯</strong> ä»¥åŠ <strong>èµ„æºåŠ è½½é”™è¯¯</strong>ï¼Œå¹¶å°†è¿™äº›æ•°æ®ç»Ÿä¸€æ ¼å¼åŒ–åä¸ŠæŠ¥åˆ°æœåŠ¡ç«¯ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[åº”ç”¨å¯åŠ¨] --&gt; B{SDK åˆå§‹åŒ–}
    B --&gt; C[JS é”™è¯¯ç›‘æ§]
    B --&gt; D[ç½‘ç»œè¯·æ±‚ç›‘æ§]
    B --&gt; E[èµ„æºåŠ è½½ç›‘æ§]

    C --&gt;|æ•è· onerror/unhandledrejection| F[é”™è¯¯å¤„ç†ä¸­å¿ƒ]
    D --&gt;|åŠ«æŒ XHR/Fetch| F
    E --&gt;|æ•è· error äº‹ä»¶| F

    F --&gt; G[æ•°æ®ç»„è£…]
    G --&gt; H[ä¸ŠæŠ¥æ¨¡å—]
    H --&gt;|Navigator.sendBeacon / Fetch| I[æœåŠ¡ç«¯ API]
    I --&gt; J[æ•°æ®åº“/æ—¥å¿—ç³»ç»Ÿ]
</code></pre>
<h3 data-id="heading-2">é¡¹ç›®ç»“æ„</h3>
<p>ä¸ºäº†ä¿æŒä»£ç çš„æ¨¡å—åŒ–å’Œå¯ç»´æŠ¤æ€§ï¼Œæˆ‘ä»¬é‡‡ç”¨ä»¥ä¸‹ç›®å½•ç»“æ„ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">error-monitor/
â”œâ”€â”€ src/
â”‚ â”œâ”€â”€ index.ts           <span class="hljs-comment"># å…¥å£æ–‡ä»¶ï¼Œæš´éœ²åˆå§‹åŒ–æ–¹æ³•</span>
â”‚ â”œâ”€â”€ errorHandler.ts    <span class="hljs-comment"># JS è¿è¡Œæ—¶é”™è¯¯æ•è·</span>
â”‚ â”œâ”€â”€ networkMonitor.ts  <span class="hljs-comment"># ç½‘ç»œè¯·æ±‚å¼‚å¸¸ç›‘æ§</span>
â”‚ â”œâ”€â”€ resourceMonitor.ts <span class="hljs-comment"># é™æ€èµ„æºåŠ è½½å¼‚å¸¸ç›‘æ§</span>
â”‚ â”œâ”€â”€ sender.ts          <span class="hljs-comment"># æ•°æ®ä¸ŠæŠ¥é€»è¾‘</span>
â”‚ â””â”€â”€ utils.ts           <span class="hljs-comment"># å·¥å…·å‡½æ•°</span>
â”œâ”€â”€ package.json
â””â”€â”€ README.md
</code></pre>
<p>ğŸš€Â <em><strong>æµè§ˆé¡¹ç›®çš„å®Œæ•´ä»£ç åŠç¤ºä¾‹å¯ä»¥ç‚¹å‡»è¿™é‡Œ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FTeernage%2Ferror-monitor" target="_blank" title="https://github.com/Teernage/error-monitor" ref="nofollow noopener noreferrer">error-monitor</a>Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FTeernage%2Ferror-monitor" target="_blank" title="https://github.com/Teernage/error-monitor" ref="nofollow noopener noreferrer">github.com/Teernage/erâ€¦</a> ï¼Œå¦‚æœå¯¹æ‚¨æœ‰å¸®åŠ©æ¬¢è¿Starã€‚</strong></em></p>
<h2 data-id="heading-3">2. æ ¸å¿ƒå®ç°è¯¦è§£</h2>
<h3 data-id="heading-4">2.1 SDK åˆå§‹åŒ–å…¥å£ (<code>index.ts</code>)</h3>
<p>SDK çš„å…¥å£ä¸»è¦è´Ÿè´£æ¥æ”¶é…ç½®ï¼ˆå¦‚ä¸ŠæŠ¥åœ°å€ã€é¡¹ç›®åç§°ï¼‰å¹¶å¯åŠ¨å„ä¸ªç›‘æ§æ¨¡å—ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/index.ts</span>
<span class="hljs-keyword">import</span> { monitorJavaScriptErrors } <span class="hljs-keyword">from</span> <span class="hljs-string">'./errorHandler'</span>;
<span class="hljs-keyword">import</span> { monitorNetworkErrors } <span class="hljs-keyword">from</span> <span class="hljs-string">'./networkMonitor'</span>;
<span class="hljs-keyword">import</span> { monitorResourceErrors } <span class="hljs-keyword">from</span> <span class="hljs-string">'./resourceMonitor'</span>;

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ErrorMonitorConfig</span> {
  <span class="hljs-attr">reportUrl</span>: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// ä¸ŠæŠ¥æ¥å£åœ°å€</span>
  <span class="hljs-attr">projectName</span>: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// é¡¹ç›®æ ‡è¯†</span>
  <span class="hljs-attr">environment</span>: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// ç¯å¢ƒ (dev/prod)</span>
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">initErrorMonitor</span> = (<span class="hljs-params">config: ErrorMonitorConfig</span>) =&gt; {
  <span class="hljs-keyword">const</span> { reportUrl, projectName, environment } = config;

  <span class="hljs-comment">// å¯åŠ¨ä¸‰å¤§ç›‘æ§æ¨¡å—</span>
  <span class="hljs-title function_">monitorJavaScriptErrors</span>(reportUrl, projectName, environment);
  <span class="hljs-title function_">monitorNetworkErrors</span>(reportUrl, projectName, environment);
  <span class="hljs-title function_">monitorResourceErrors</span>(reportUrl, projectName, environment);
};
</code></pre>
<h3 data-id="heading-5">2.2 å…¨å±€å¼‚å¸¸æ•è· (<code>errorHandler.ts</code>)</h3>
<blockquote>
<p>è¿™æ˜¯é”™è¯¯ç›‘æ§çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚JavaScript çš„é”™è¯¯ä¸»è¦åˆ†ä¸ºä¸¤ç±»ï¼Œæˆ‘ä»¬éœ€è¦åˆ†åˆ«å¤„ç†ï¼š</p>
<ol>
<li><strong>å¸¸è§„è¿è¡Œæ—¶é”™è¯¯</strong>ï¼šä»£ç é€»è¾‘é”™è¯¯ï¼ˆå¦‚ <code>undefined is not a function</code>ï¼‰ã€‚è¿™éƒ¨åˆ†ç”±è€ç‰Œçš„ <code>window.onerror</code> äº‹ä»¶è´Ÿè´£ï¼Œå®ƒèƒ½æä¾›è¯¦ç»†çš„è¡Œå·ã€åˆ—å·å’Œå †æ ˆä¿¡æ¯ã€‚</li>
<li><strong>Promise å¼‚å¸¸</strong>ï¼šéšç€ <code>async/await</code> çš„æ™®åŠï¼Œæœªè¢« <code>catch</code> çš„ Promise é”™è¯¯è¶Šæ¥è¶Šå¸¸è§ã€‚è¿™éƒ¨åˆ†é”™è¯¯ <strong>ä¸ä¼š</strong> è§¦å‘ <code>onerror</code>ï¼Œéœ€è¦é€šè¿‡ç›‘å¬ <code>unhandledrejection</code> äº‹ä»¶æ¥æ•è·ã€‚</li>
</ol>
<p>åŒç®¡é½ä¸‹ï¼Œæ‰èƒ½ç¡®ä¿ä»£ç é€»è¾‘é”™è¯¯ä¸è¢«é—æ¼ã€‚</p>
</blockquote>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/errorHandler.ts</span>
<span class="hljs-keyword">import</span> { sendErrorData } <span class="hljs-keyword">from</span> <span class="hljs-string">'./sender'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">monitorJavaScriptErrors</span> = (<span class="hljs-params">
  reportUrl: <span class="hljs-built_in">string</span>,
  projectName: <span class="hljs-built_in">string</span>,
  environment: <span class="hljs-built_in">string</span>
</span>) =&gt; {
  <span class="hljs-comment">// 1. æ•è· JS è¿è¡Œæ—¶é”™è¯¯</span>
  <span class="hljs-keyword">const</span> originalOnError = <span class="hljs-variable language_">window</span>.<span class="hljs-property">onerror</span>;
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">message, source, lineno, colno, error</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> errorInfo = {
      <span class="hljs-attr">type</span>: <span class="hljs-string">'JavaScript Error'</span>,
      message,
      source,
      lineno,
      colno,
      <span class="hljs-attr">stack</span>: error ? error.<span class="hljs-property">stack</span> : <span class="hljs-literal">null</span>,
      projectName,
      environment,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>(),
    };
    <span class="hljs-title function_">sendErrorData</span>(errorInfo, reportUrl);

    <span class="hljs-comment">// å…³é”®ç‚¹ï¼šå¦‚æœåŸæ¥æœ‰ onerror å¤„ç†å‡½æ•°ï¼Œç»§ç»­æ‰§è¡Œå®ƒï¼Œé¿å…è¦†ç›–ç”¨æˆ·é€»è¾‘</span>
    <span class="hljs-comment">// è¿™æ ·åšæ˜¯ä¸ºäº†ä¸ç ´åå®¿ä¸»ç¯å¢ƒï¼ˆä¾‹å¦‚ç”¨æˆ·è‡ªå·±å†™çš„æˆ–å…¶ä»– SDKï¼‰å·²æœ‰çš„é”™è¯¯å¤„ç†é€»è¾‘</span>
    <span class="hljs-keyword">if</span> (originalOnError) {
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">originalOnError</span>(message, source, lineno, colno, error);
    }
  };

  <span class="hljs-comment">// 2. æ•è·æœªå¤„ç†çš„ Promise Rejection</span>
  <span class="hljs-keyword">const</span> originalOnUnhandledRejection = <span class="hljs-variable language_">window</span>.<span class="hljs-property">onunhandledrejection</span>;
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">onunhandledrejection</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> errorInfo = {
      <span class="hljs-attr">type</span>: <span class="hljs-string">'Unhandled Promise Rejection'</span>,
      <span class="hljs-attr">message</span>: event.<span class="hljs-property">reason</span>?.<span class="hljs-property">message</span> || event.<span class="hljs-property">reason</span>,
      <span class="hljs-attr">stack</span>: event.<span class="hljs-property">reason</span>?.<span class="hljs-property">stack</span>,
      projectName,
      environment,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>(),
    };
    <span class="hljs-title function_">sendErrorData</span>(errorInfo, reportUrl);

    <span class="hljs-comment">// å…³é”®ç‚¹ï¼šæ‰§è¡ŒåŸæœ‰çš„ Promise é”™è¯¯å¤„ç†é€»è¾‘</span>
    <span class="hljs-comment">// è¿™æ ·åšæ˜¯ä¸ºäº†ä¸ç ´åå®¿ä¸»ç¯å¢ƒï¼ˆä¾‹å¦‚ç”¨æˆ·è‡ªå·±å†™çš„æˆ–å…¶ä»– SDKï¼‰å·²æœ‰çš„é”™è¯¯å¤„ç†é€»è¾‘</span>
    <span class="hljs-keyword">if</span> (originalOnUnhandledRejection) {
      <span class="hljs-keyword">return</span> originalOnUnhandledRejection.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">window</span>, event);
    }
  };
};
</code></pre>
<h3 data-id="heading-6">2.3 ç½‘ç»œè¯·æ±‚ç›‘æ§ (<code>networkMonitor.ts</code>)</h3>
<blockquote>
<p>æ¥å£ç›‘æ§æ˜¯ç›‘æ§çš„éš¾ç‚¹ï¼Œå› ä¸ºæµè§ˆå™¨<strong>å¹¶æ²¡æœ‰</strong>æä¾›ä¸€ä¸ªå…¨å±€çš„ <code>onNetworkError</code> äº‹ä»¶ã€‚</p>
<p><strong>æ€ä¹ˆåŠï¼Ÿ</strong></p>
<p>æˆ‘ä»¬éœ€è¦ä½¿ç”¨ <strong>AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰</strong> çš„æ€æƒ³ï¼Œé‡å†™æµè§ˆå™¨åŸç”Ÿçš„ <code>XMLHttpRequest</code> å’Œ <code>fetch</code>æ–¹æ³•ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æŠŠåŸç”Ÿçš„æ–¹æ³•â€œåŒ…â€ä¸€å±‚ï¼šåœ¨è¯·æ±‚å‘å‡ºå‰/å“åº”è¿”å›åï¼Œæ’å…¥æˆ‘ä»¬çš„ç›‘æ§ä»£ç ï¼Œç„¶åå†æ‰§è¡ŒåŸæœ‰çš„é€»è¾‘ã€‚è¿™æ ·ä¸šåŠ¡ä»£ç å®Œå…¨æ— æ„ŸçŸ¥ï¼Œè€Œæˆ‘ä»¬å´èƒ½æ‹¿åˆ°æ‰€æœ‰çš„è¯·æ±‚ç»†èŠ‚ã€‚</p>
</blockquote>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/networkMonitor.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">monitorNetworkErrors</span> = (<span class="hljs-params">
  reportUrl: <span class="hljs-built_in">string</span>,
  projectName: <span class="hljs-built_in">string</span>,
  environment: <span class="hljs-built_in">string</span>
</span>) =&gt; {
  <span class="hljs-comment">// 1. åŠ«æŒ XMLHttpRequest</span>
  <span class="hljs-keyword">const</span> originalXhrOpen = <span class="hljs-title class_">XMLHttpRequest</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">open</span>;
  <span class="hljs-title class_">XMLHttpRequest</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">open</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">
    method: <span class="hljs-built_in">string</span>,
    url: <span class="hljs-built_in">string</span> | URL,
    ...args: <span class="hljs-built_in">any</span>[]
  </span>) {
    <span class="hljs-comment">// å…³é”®ç‚¹ï¼šæ’é™¤ä¸ŠæŠ¥æ¥å£è‡ªèº«çš„è¯·æ±‚ï¼Œé˜²æ­¢æ­»å¾ªç¯</span>
    <span class="hljs-keyword">const</span> urlStr = <span class="hljs-keyword">typeof</span> url === <span class="hljs-string">'string'</span> ? url : <span class="hljs-title class_">String</span>(url);
    <span class="hljs-keyword">if</span> (urlStr.<span class="hljs-title function_">includes</span>(reportUrl)) {
      <span class="hljs-keyword">return</span> originalXhrOpen.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, [method, url, ...args] <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>);
    }

    <span class="hljs-comment">// ç›‘å¬ error äº‹ä»¶</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title function_">sendErrorData</span>(
        {
          <span class="hljs-attr">type</span>: <span class="hljs-string">'Network Error'</span>,
          <span class="hljs-attr">message</span>: <span class="hljs-string">`Request Failed: <span class="hljs-subst">${method}</span> <span class="hljs-subst">${url}</span>`</span>,
          projectName,
          environment,
        },
        reportUrl
      );
    });
    <span class="hljs-keyword">return</span> originalXhrOpen.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, [method, url, ...args] <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>);
  };

  <span class="hljs-comment">// 2. åŠ«æŒ Fetch</span>
  <span class="hljs-keyword">const</span> originalFetch = <span class="hljs-variable language_">window</span>.<span class="hljs-property">fetch</span>;
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">fetch</span> = <span class="hljs-keyword">async</span> (input, init) =&gt; {
    <span class="hljs-comment">// å…³é”®ç‚¹ï¼šæ’é™¤ä¸ŠæŠ¥æ¥å£è‡ªèº«çš„è¯·æ±‚ï¼Œé˜²æ­¢æ­»å¾ªç¯</span>
    <span class="hljs-keyword">const</span> urlStr = (input <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Request</span>) ? input.<span class="hljs-property">url</span> : <span class="hljs-title class_">String</span>(input);
    <span class="hljs-keyword">if</span> (urlStr.<span class="hljs-title function_">includes</span>(reportUrl)) {
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">originalFetch</span>(input, init);
    }

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">originalFetch</span>(input, init);
      <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {
        <span class="hljs-title function_">sendErrorData</span>(
          {
            <span class="hljs-attr">type</span>: <span class="hljs-string">'Fetch Error'</span>,
            <span class="hljs-attr">message</span>: <span class="hljs-string">`HTTP <span class="hljs-subst">${response.status}</span>: <span class="hljs-subst">${response.statusText}</span>`</span>,
            <span class="hljs-attr">url</span>: input <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Request</span> ? input.<span class="hljs-property">url</span> : input,
            projectName,
            environment,
          },
          reportUrl
        );
      }
      <span class="hljs-keyword">return</span> response;
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-comment">// ç½‘ç»œæ•…éšœç­‰æ— æ³•å‘å‡ºè¯·æ±‚çš„æƒ…å†µ</span>
      <span class="hljs-title function_">sendErrorData</span>(
        {
          <span class="hljs-attr">type</span>: <span class="hljs-string">'Fetch Error'</span>,
          <span class="hljs-attr">message</span>: <span class="hljs-string">`Fetch Failed: <span class="hljs-subst">${input}</span>`</span>,
          projectName,
          environment,
        },
        reportUrl
      );
      <span class="hljs-keyword">throw</span> error;
    }
  };
};
</code></pre>
<h3 data-id="heading-7">2.4 èµ„æºåŠ è½½ç›‘æ§ (<code>resourceMonitor.ts</code>)</h3>
<blockquote>
<p>ä½¿ç”¨ <strong>window.onerror</strong> æ£€æµ‹ä¸åˆ°èµ„æºçš„é”™è¯¯ï¼Œå› ä¸º <strong>èµ„æºåŠ è½½å¤±è´¥ï¼ˆå¦‚ img/script src 404ï¼‰äº§ç”Ÿçš„ <code>error</code> äº‹ä»¶æ˜¯ä¸ä¼šå†’æ³¡çš„</strong>ã€‚</p>
<p>è€Œ <code>window.onerror</code> ä¾é äº‹ä»¶å†’æ³¡æ¥æ•è·é”™è¯¯ï¼Œæ‰€ä»¥å®ƒå¯¹èµ„æºé”™è¯¯æ— èƒ½ä¸ºåŠ›ã€‚</p>
<p>ä½†æ˜¯ <code>window.addEventListener('error', handler, true)</code> åœ¨ <strong>æ•è·é˜¶æ®µ</strong> å¯ä»¥å°†èµ„æºåŠ è½½çš„é”™è¯¯â€œæ‹¦æˆªâ€ä¸‹æ¥ã€‚</p>
<p>æ‰€ä»¥èµ„æºåŠ è½½ç›‘æ§è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>window.addEventListener('error', () =&gt; {}, true)</code> æ¥è¿›è¡Œç›‘æ§ã€‚</p>
</blockquote>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/resourceMonitor.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">monitorResourceErrors</span> = (<span class="hljs-params">
  reportUrl: <span class="hljs-built_in">string</span>,
  projectName: <span class="hljs-built_in">string</span>,
  environment: <span class="hljs-built_in">string</span>
</span>) =&gt; {
  <span class="hljs-comment">// æ³¨æ„ï¼šuseCapture è®¾ç½®ä¸º trueï¼Œåœ¨æ•è·é˜¶æ®µå¤„ç†</span>
  <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(
    <span class="hljs-string">'error'</span>,
    <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> target = event.<span class="hljs-property">target</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">HTMLElement</span>;
      <span class="hljs-comment">// è¿‡æ»¤æ‰ window è‡ªèº«çš„ errorï¼Œåªå¤„ç†èµ„æºå…ƒç´ çš„ error</span>
      <span class="hljs-keyword">if</span> (target &amp;&amp; (target.<span class="hljs-property">tagName</span> === <span class="hljs-string">'IMG'</span> || target.<span class="hljs-property">tagName</span> === <span class="hljs-string">'SCRIPT'</span>)) {
        <span class="hljs-title function_">sendErrorData</span>(
          {
            <span class="hljs-attr">type</span>: <span class="hljs-string">'Resource Load Error'</span>,
            <span class="hljs-attr">message</span>: <span class="hljs-string">`Failed to load <span class="hljs-subst">${target.tagName}</span>: <span class="hljs-subst">${
              target.getAttribute(<span class="hljs-string">'src'</span>) || target.getAttribute(<span class="hljs-string">'href'</span>)
            }</span>`</span>,
            projectName,
            environment,
          },
          reportUrl
        );
      }
    },
    <span class="hljs-literal">true</span> <span class="hljs-comment">// æ•è·é˜¶æ®µ</span>
  );
};
</code></pre>
<h3 data-id="heading-8">2.5 æ•°æ®ä¸ŠæŠ¥ (<code>sender.ts</code>)</h3>
<blockquote>
<p>æ”¶é›†åˆ°é”™è¯¯æ•°æ®åï¼Œå¦‚ä½•å‘ç»™åç«¯ï¼Ÿè¿™çœ‹ä¼¼ç®€å•ï¼Œå®åˆ™æš—è—ç„æœºã€‚</p>
<p><strong>ç—›ç‚¹ï¼šé¡µé¢å¸è½½æ—¶çš„â€œé—è¨€â€å‘ä¸å‡ºå»</strong></p>
<p>ç”¨æˆ·é‡åˆ° Bug çš„ç¬¬ä¸€ååº”å¾€å¾€æ˜¯å…³é—­é¡µé¢ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨æ™®é€šçš„ <code>fetch</code> æˆ– <code>XHR</code> ä¸ŠæŠ¥ï¼š</p>
<ol>
<li><strong>å¼‚æ­¥è¯·æ±‚å¯èƒ½ä¼šè¢«å–æ¶ˆ</strong>ï¼šé¡µé¢å…³é—­æ—¶ï¼Œæµè§ˆå™¨é€šå¸¸ä¼š cancel æ‰æ‰€æœ‰æœªå®Œæˆçš„è¯·æ±‚ã€‚</li>
<li><strong>åŒæ­¥è¯·æ±‚ä¼šé˜»å¡è·³è½¬</strong>ï¼šè™½ç„¶èƒ½å¼ºè¡Œå‘å‡ºå»ï¼Œä½†ä¼šå¡ä½é¡µé¢åˆ‡æ¢ï¼Œä¸¥é‡å½±å“ä½“éªŒã€‚</li>
</ol>
<p><strong>æ•‘æ˜Ÿï¼šNavigator.sendBeacon</strong></p>
<p><code>sendBeacon</code> æ˜¯ä¸“é—¨ä¸ºæ­¤åœºæ™¯è®¾è®¡çš„ APIã€‚å®ƒæœ‰ä¸‰å¤§ä¼˜åŠ¿ï¼š</p>
<ol>
<li><strong>å¯é </strong>ï¼šå³ä½¿é¡µé¢å¸è½½ï¼Œæµè§ˆå™¨ä¹Ÿä¼šåœ¨åå°ä¿è¯æ•°æ®å‘é€æˆåŠŸã€‚</li>
<li><strong>å¼‚æ­¥</strong>ï¼šå®Œå…¨ä¸é˜»å¡é¡µé¢å…³é—­æˆ–è·³è½¬ã€‚</li>
<li><strong>é«˜æ•ˆ</strong>ï¼šä¼ è¾“å°‘é‡æ•°æ®æ—¶æ€§èƒ½æä½³ã€‚</li>
</ol>
<p>å› æ­¤ï¼Œæˆ‘ä»¬çš„ä¸ŠæŠ¥ç­–ç•¥æ˜¯ï¼š<strong>ä¼˜å…ˆ <code>sendBeacon</code>ï¼Œä¸æ”¯æŒåˆ™é™çº§ä¸º <code>fetch</code>ã€‚</strong></p>
</blockquote>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/sender.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">sendErrorData</span> = (<span class="hljs-params">errorData: Record&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">any</span>&gt;, url: <span class="hljs-built_in">string</span></span>) =&gt; {
  <span class="hljs-comment">// è¡¥å……æµè§ˆå™¨ä¿¡æ¯ï¼ˆUserAgent ç­‰ï¼‰</span>
  <span class="hljs-keyword">const</span> dataToSend = {
    ...errorData,
    <span class="hljs-attr">userAgent</span>: navigator.<span class="hljs-property">userAgent</span>,
    <span class="hljs-comment">// è¿˜å¯ä»¥æ·»åŠ æ›´å¤šç¯å¢ƒä¿¡æ¯ï¼Œå¦‚å±å¹•åˆ†è¾¨ç‡ã€å½“å‰ URL ç­‰</span>
  };

  <span class="hljs-comment">// ä¼˜å…ˆä½¿ç”¨ sendBeacon (å¼‚æ­¥ï¼Œä¸é˜»å¡ï¼Œé¡µé¢å¸è½½æ—¶ä»æœ‰æ•ˆ)</span>
  <span class="hljs-keyword">if</span> (navigator.<span class="hljs-property">sendBeacon</span>) {
    <span class="hljs-keyword">const</span> blob = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Blob</span>([<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(dataToSend)], {
      <span class="hljs-attr">type</span>: <span class="hljs-string">'application/json'</span>,
    });
    navigator.<span class="hljs-title function_">sendBeacon</span>(url, blob);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// é™çº§ä½¿ç”¨ fetch</span>
    <span class="hljs-title function_">fetch</span>(url, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
      <span class="hljs-attr">headers</span>: { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span> },
      <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(dataToSend),
    }).<span class="hljs-title function_">catch</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">error</span>);
  }
};
</code></pre>
<blockquote>
<p><strong>ğŸ’¡ çŸ¥è¯†æ‰©å±•ï¼šç»å…¸çš„ 1x1 GIF æ‰“ç‚¹</strong></p>
<p>ä½ å¯èƒ½å¬è¯´è¿‡ç”¨ <code>new Image().src = 'http://api.com/report?data=...'</code> è¿™ç§æ–¹å¼ä¸ŠæŠ¥ã€‚è¿™åœ¨ç»Ÿè®¡ PV/UV æ—¶éå¸¸æµè¡Œï¼Œå› ä¸ºå®ƒå…¼å®¹æ€§æå¥½ä¸”å¤©ç„¶è·¨åŸŸã€‚</p>
<p>ä½†åœ¨<strong>é”™è¯¯ç›‘æ§</strong>åœºæ™¯ä¸‹ï¼Œé€šå¸¸<strong>ä¸æ¨è</strong>ä½œä¸ºä¸»åŠ›æ–¹æ¡ˆã€‚
<strong>æ ¸å¿ƒåŸå› æ­£æ˜¯æ•°æ®é‡</strong>ï¼š</p>
<ol>
<li><strong>URL é•¿åº¦é™åˆ¶</strong>ï¼šGIF æ‰“ç‚¹æœ¬è´¨æ˜¯ GET è¯·æ±‚ï¼Œæ•°æ®éƒ½æŒ‚åœ¨ URL ä¸Šã€‚æµè§ˆå™¨å¯¹ URL é•¿åº¦æœ‰é™åˆ¶ï¼ˆé€šå¸¸ 2KB~8KBï¼‰ã€‚</li>
<li><strong>å †æ ˆè¿‡é•¿</strong>ï¼šä¸€ä¸ªå®Œæ•´çš„æŠ¥é”™å †æ ˆï¼ˆStack Traceï¼‰åŠ¨è¾„å‡ åƒå­—ç¬¦ï¼Œå¾ˆå®¹æ˜“å°±è¢«æµè§ˆå™¨æˆªæ–­ï¼Œå¯¼è‡´æˆ‘ä»¬çœ‹ä¸åˆ°å…³é”®çš„æŠ¥é”™ä¿¡æ¯ã€‚</li>
</ol>
<p>æ‰€ä»¥ï¼Œå¯¹äº<strong>ä½“ç§¯è¾ƒå¤§</strong>çš„é”™è¯¯æ•°æ®ï¼Œèµ° POST é€šé“çš„ <code>sendBeacon</code> æˆ– <code>fetch</code> æ˜¯æ›´ç¨³å¦¥çš„é€‰æ‹©ã€‚</p>
</blockquote>
<h3 data-id="heading-9">2.6 è¿›é˜¶ä¼˜åŒ–ï¼šé‡‡æ ·ä¸ç¼“å†²ï¼Œåˆ«æŠŠæœåŠ¡å™¨æå´©äº†</h3>
<p>å¦‚æœçº¿ä¸Šå‡ºç°å¤§è§„æ¨¡æ•…éšœï¼Œæˆåƒä¸Šä¸‡çš„ç”¨æˆ·åŒæ—¶ä¸ŠæŠ¥é”™è¯¯ï¼Œå¯èƒ½ä¼šç¬é—´æŠŠç›‘æ§æœåŠ¡å™¨æ‰“æŒ‚ï¼ˆDDoS æ—¢è§†æ„Ÿï¼‰ã€‚</p>
<p>è¿™æ—¶å€™æˆ‘ä»¬éœ€è¦å¼•å…¥ä¸¤ä¸ªæœºåˆ¶ï¼š</p>
<ol>
<li>
<p><strong>é‡‡æ · (Sampling)</strong>ï¼š</p>
<ul>
<li><strong>å¤§ç™½è¯</strong>ï¼šä¸è¦æ¯ä¸ªé”™è¯¯éƒ½æŠ¥ã€‚æ¯”å¦‚åªå…è®¸ 20% çš„è¿æ°”ä¸å¥½çš„ç”¨æˆ·ä¸ŠæŠ¥ï¼Œå‰©ä¸‹çš„å¿½ç•¥ã€‚è¿™æ ·æ—¢èƒ½å‘ç°é—®é¢˜ï¼Œåˆèƒ½èŠ‚çœ 80% çš„æµé‡ã€‚</li>
<li><strong>å®ç°</strong>ï¼š<code>if (Math.random() &gt; 0.2) return;</code></li>
</ul>
</li>
<li>
<p><strong>ç¼“å†² (Buffering)</strong>ï¼š</p>
<ul>
<li><strong>å¤§ç™½è¯</strong>ï¼šä¸è¦å‡ºä¸€æ¡é”™å°±å‘ä¸€ä¸ªè¯·æ±‚ï¼Œå¤ªæµªè´¹èµ„æºã€‚å…ˆæŠŠé”™è¯¯æ”’åœ¨æ•°ç»„é‡Œï¼Œå‡‘å¤Ÿ 10 æ¡æˆ–è€…æ¯éš” 5 ç§’ç»Ÿä¸€å‘ä¸€è½¦ã€‚</li>
<li><strong>æ³¨æ„</strong>ï¼šè®°å¾—åœ¨é¡µé¢å¸è½½ï¼ˆå…³é—­ï¼‰æ—¶ï¼ŒæŠŠè½¦ä¸Šå‰©ä¸‹çš„è´§å¼ºåˆ¶å‘å‡ºå»ï¼Œåˆ«ä¸¢äº†ã€‚</li>
</ul>
</li>
</ol>
<h2 data-id="heading-10">3. å·¥ç¨‹åŒ–æ„å»ºé…ç½®</h2>
<p>æ—¢ç„¶æ˜¯ SDKï¼Œæœ€å¥½çš„åˆ†å‘æ–¹å¼å½“ç„¶æ˜¯å‘å¸ƒåˆ° NPMã€‚è¿™æ ·å…¶ä»–é¡¹ç›®åªéœ€è¦ä¸€è¡Œå‘½ä»¤å°±èƒ½æ¥å…¥ä½ çš„å‰ç«¯é”™è¯¯ç›‘æ§ç³»ç»Ÿã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬é€‰æ‹© <strong>Rollup</strong>å¯¹ä»£ç è¿›è¡Œæ‰“åŒ…ï¼Œå› ä¸ºå®ƒæ¯” Webpack æ›´é€‚åˆæ‰“åŒ…åº“ï¼ˆLibraryï¼‰ï¼Œç”Ÿæˆçš„ä»£ç æ›´ç®€æ´ã€‚</p>
<p>ç»è¿‡æ„å»ºå’Œæµ‹è¯•æœåŠ¡çš„æ­å»ºï¼Œæˆ‘ä»¬æœ€ç»ˆçš„é¡¹ç›®å…¨è²Œæ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">error-monitor/
â”œâ”€â”€ dist/                <span class="hljs-comment"># æ‰“åŒ…äº§ç‰©</span>
â”œâ”€â”€ src/                 <span class="hljs-comment"># æºç ç›®å½•</span>
â”‚   â”œâ”€â”€ index.ts         <span class="hljs-comment"># å…¥å£æ–‡ä»¶</span>
â”‚   â”œâ”€â”€ errorHandler.ts  <span class="hljs-comment"># JS é”™è¯¯æ•è·</span>
â”‚   â”œâ”€â”€ networkMonitor.ts<span class="hljs-comment"># ç½‘ç»œè¯·æ±‚ç›‘æ§</span>
â”‚   â”œâ”€â”€ resourceMonitor.ts<span class="hljs-comment"># èµ„æºåŠ è½½ç›‘æ§</span>
â”‚   â”œâ”€â”€ sender.ts        <span class="hljs-comment"># ä¸ŠæŠ¥é€»è¾‘</span>
â”‚   â””â”€â”€ utils.ts         <span class="hljs-comment"># å·¥å…·å‡½æ•°</span>
â”œâ”€â”€ <span class="hljs-built_in">test</span>/                <span class="hljs-comment"># æµ‹è¯•é¶åœº</span>
â”‚   â”œâ”€â”€ server.js        <span class="hljs-comment"># æœ¬åœ°æµ‹è¯•æœåŠ¡</span>
â”‚   â””â”€â”€ index.html       <span class="hljs-comment"># é”™è¯¯è§¦å‘é¡µé¢</span>
â”œâ”€â”€ package.json         <span class="hljs-comment"># é¡¹ç›®é…ç½®</span>
â”œâ”€â”€ rollup.config.js     <span class="hljs-comment"># Rollup æ‰“åŒ…é…ç½®</span>
â”œâ”€â”€ tsconfig.json        <span class="hljs-comment"># TypeScript é…ç½®</span>
â””â”€â”€ README.md
</code></pre>
<h3 data-id="heading-11">3.1 package é…ç½® (<code>package.json</code>)</h3>
<p><code>package.json</code> ä¸ä»…ä»…æ˜¯ä¾èµ–ç®¡ç†ï¼Œå®ƒè¿˜å®šä¹‰äº†ä½ çš„åŒ…å¦‚ä½•è¢«å¤–éƒ¨ä½¿ç”¨ã€‚é…ç½®ä¸å½“ä¼šå¯¼è‡´ç”¨æˆ·å¼•å…¥æŠ¥é”™æˆ–æ— æ³•è·å¾—ä»£ç æç¤ºã€‚</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"error-monitor-sdk"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"A lightweight front-end error monitoring SDK"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"main"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"dist/index.cjs.js"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// CommonJS å…¥å£</span>
  <span class="hljs-attr">"module"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"dist/index.esm.js"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// ESM å…¥å£</span>
  <span class="hljs-attr">"browser"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"dist/index.umd.js"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// UMD å…¥å£</span>
  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"module"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"build"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"rollup -c"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"dev"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"rollup -c -w"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"keywords"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"error-monitor"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"frontend"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"sdk"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"license"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"MIT"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"files"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"dist"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// å‘å¸ƒæ—¶ä»…åŒ…å« dist ç›®å½•</span>
  <span class="hljs-attr">"devDependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"rollup"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^4.9.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"@rollup/plugin-typescript"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^11.1.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"@rollup/plugin-terser"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^0.4.0"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// ç”¨äºå‹ç¼©ä»£ç </span>
    <span class="hljs-attr">"typescript"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^5.3.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"tslib"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^2.6.0"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>ğŸ’¡ å…³é”®å­—æ®µè§£è¯»ï¼š</strong></p>
<ul>
<li><strong><code>name</code></strong>: åŒ…çš„â€œèº«ä»½è¯å·â€ã€‚åœ¨ NPM å…¨çƒèŒƒå›´å†…å¿…é¡»å”¯ä¸€ï¼Œå‘å¸ƒå‰è®°å¾—å…ˆå»æœä¸€ä¸‹æœ‰æ²¡æœ‰é‡åã€‚</li>
<li><strong>å…¥å£æ–‡ä»¶â€œä¸‰å‰‘å®¢â€</strong>ï¼ˆå†³å®šäº†åˆ«äººæ€ä¹ˆå¼•ç”¨ä½ çš„åŒ…ï¼‰ï¼š
<ul>
<li><strong><code>main</code></strong>: <strong>CommonJS å…¥å£</strong>ã€‚ç»™ Node.js ç¯å¢ƒæˆ–è€æ—§æ„å»ºå·¥å…·ï¼ˆå¦‚ Webpack 4ï¼‰ä½¿ç”¨çš„ã€‚</li>
<li><strong><code>module</code></strong>: <strong>ESM å…¥å£</strong>ã€‚ç»™ç°ä»£æ„å»ºå·¥å…·ï¼ˆVite, Webpack 5ï¼‰ä½¿ç”¨çš„ã€‚æ”¯æŒ Tree Shakingï¼ˆæ‘‡æ ‘ä¼˜åŒ–ï¼‰ï¼Œèƒ½å‡å°ä½“ç§¯ã€‚</li>
<li><strong><code>browser</code></strong>: <strong>UMD å…¥å£</strong>ã€‚ç»™æµè§ˆå™¨ç›´æ¥é€šè¿‡ <code>&lt;script&gt;</code> æ ‡ç­¾å¼•å…¥ä½¿ç”¨çš„ï¼ˆå¦‚ CDNï¼‰ã€‚</li>
</ul>
</li>
<li><strong><code>files</code></strong>: <strong>å‘å¸ƒç™½åå•</strong>ã€‚æŒ‡å®š <code>npm publish</code> æ—¶åªä¸Šä¼ å“ªäº›æ–‡ä»¶ï¼ˆè¿™é‡Œæˆ‘ä»¬åªä¼ ç¼–è¯‘åçš„ <code>dist</code> ç›®å½•ï¼‰ã€‚æºç ã€æµ‹è¯•ä»£ç ç­‰ä¸éœ€è¦å‘ä¸Šå»ï¼Œä»¥å‡å°åŒ…ä½“ç§¯ã€‚</li>
</ul>
<h3 data-id="heading-12">3.2 TypeScript é…ç½® (<code>tsconfig.json</code>)</h3>
<p>æˆ‘ä»¬éœ€è¦é…ç½® TypeScript å¦‚ä½•ç¼–è¯‘ä»£ç ï¼Œå¹¶ç”Ÿæˆç±»å‹å£°æ˜æ–‡ä»¶ï¼ˆ<code>.d.ts</code>ï¼‰ï¼Œè¿™å¯¹ä½¿ç”¨ TS çš„ç”¨æˆ·éå¸¸å‹å¥½ã€‚</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"compilerOptions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"target"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"es5"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// ç¼–è¯‘æˆ ES5ï¼Œå…¼å®¹æ—§æµè§ˆå™¨</span>
    <span class="hljs-attr">"module"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esnext"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// ä¿ç•™ ES æ¨¡å—è¯­æ³•ï¼Œäº¤ç»™ Rollup å¤„ç†</span>
    <span class="hljs-attr">"declaration"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// ç”Ÿæˆ .d.ts ç±»å‹æ–‡ä»¶ (å…³é”®ï¼)</span>
    <span class="hljs-attr">"declarationDir"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./dist"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// ç±»å‹æ–‡ä»¶è¾“å‡ºç›®å½•</span>
    <span class="hljs-attr">"strict"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// å¼€å¯ä¸¥æ ¼æ¨¡å¼ï¼Œä»£ç æ›´å¥å£®</span>
    <span class="hljs-attr">"moduleResolution"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node"</span> <span class="hljs-comment">// æŒ‰ Node æ–¹å¼è§£ææ¨¡å—</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"include"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"src/**/*"</span><span class="hljs-punctuation">]</span> <span class="hljs-comment">// ç¼–è¯‘ src ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-13">3.3 Rollup æ‰“åŒ…é…ç½® (<code>rollup.config.js</code>)</h3>
<p>ä¸ºäº†å…¼å®¹å„ç§ä½¿ç”¨åœºæ™¯ï¼Œæˆ‘ä»¬é…ç½® Rollup è¾“å‡ºä¸‰ç§æ ¼å¼ï¼š</p>
<ol>
<li><strong>ESM (<code>.esm.js</code>)</strong>: ç»™ç°ä»£æ„å»ºå·¥å…·ï¼ˆVite, Webpackï¼‰ä½¿ç”¨ï¼Œæ”¯æŒ Tree Shakingã€‚</li>
<li><strong>CJS (<code>.cjs.js</code>)</strong>: ç»™ Node.js æˆ–æ—§ç‰ˆå·¥å…·ä½¿ç”¨ã€‚</li>
<li><strong>UMD (<code>.umd.js</code>)</strong>: å¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨é€šè¿‡ <code>&lt;script&gt;</code> æ ‡ç­¾å¼•å…¥ï¼Œä¼šæŒ‚è½½å…¨å±€å˜é‡ã€‚</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> typescript <span class="hljs-keyword">from</span> <span class="hljs-string">'@rollup/plugin-typescript'</span>;
<span class="hljs-keyword">import</span> terser <span class="hljs-keyword">from</span> <span class="hljs-string">'@rollup/plugin-terser'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">input</span>: <span class="hljs-string">'src/index.ts'</span>, <span class="hljs-comment">// å…¥å£æ–‡ä»¶</span>
  <span class="hljs-attr">output</span>: [
    {
      <span class="hljs-attr">file</span>: <span class="hljs-string">'dist/index.cjs.js'</span>,
      <span class="hljs-attr">format</span>: <span class="hljs-string">'cjs'</span>,
      <span class="hljs-attr">sourcemap</span>: <span class="hljs-literal">true</span>,
    },
    {
      <span class="hljs-attr">file</span>: <span class="hljs-string">'dist/index.esm.js'</span>,
      <span class="hljs-attr">format</span>: <span class="hljs-string">'es'</span>,
      <span class="hljs-attr">sourcemap</span>: <span class="hljs-literal">true</span>,
    },
    {
      <span class="hljs-attr">file</span>: <span class="hljs-string">'dist/index.umd.js'</span>,
      <span class="hljs-attr">format</span>: <span class="hljs-string">'umd'</span>,
      <span class="hljs-attr">name</span>: <span class="hljs-string">'ErrorMonitor'</span>, <span class="hljs-comment">// &lt;script&gt; å¼•å…¥æ—¶çš„å…¨å±€å˜é‡å',</span>
      <span class="hljs-attr">sourcemap</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">plugins</span>: [<span class="hljs-title function_">terser</span>()], <span class="hljs-comment">// UMD æ ¼å¼è¿›è¡Œå‹ç¼©ä½“ç§¯</span>
    },
  ],
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-title function_">typescript</span>({
      <span class="hljs-attr">tsconfig</span>: <span class="hljs-string">'./tsconfig.json'</span>,
      <span class="hljs-attr">declaration</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">declarationDir</span>: <span class="hljs-string">'dist'</span>,
    }),
  ],
};
</code></pre>
<h2 data-id="heading-14">4. å‘å¸ƒåˆ° NPM (ä¿å§†çº§æ•™ç¨‹)</h2>
<h3 data-id="heading-15">4.1 å‡†å¤‡å·¥ä½œ</h3>
<ol>
<li><strong>æ³¨å†Œè´¦å·</strong>ï¼šå» <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2F" target="_blank" title="https://www.npmjs.com/" ref="nofollow noopener noreferrer">npmjs.com</a> æ³¨å†Œä¸€ä¸ªè´¦å·ï¼ˆè®°å¾—éªŒè¯é‚®ç®±ï¼Œå¦åˆ™æ— æ³•å‘å¸ƒï¼‰ã€‚</li>
<li><strong>æ£€æŸ¥åŒ…å</strong>ï¼šåœ¨ NPM æœä¸€ä¸‹ä½ çš„ <code>package.json</code> é‡Œçš„ <code>name</code>ï¼Œç¡®ä¿æ²¡æœ‰è¢«å ç”¨ã€‚å¦‚æœä¸å¹¸é‡åï¼Œæ”¹ä¸ªç‹¬ç‰¹çš„åå­—ï¼Œæ¯”å¦‚ <code>error-monitor-sdk-vip</code>ã€‚</li>
</ol>
<h3 data-id="heading-16">4.2 ç»ˆç«¯æ“ä½œä¸‰æ­¥èµ°</h3>
<p>æ‰“å¼€ç»ˆç«¯ï¼ˆTerminalï¼‰ï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ“ä½œï¼š</p>
<p><strong>ç¬¬ä¸€æ­¥ï¼šç™»å½• NPM</strong></p>
<pre><code class="hljs language-bash" lang="bash">npm login
</code></pre>
<ul>
<li>è¾“å…¥å‘½ä»¤åæŒ‰å›è½¦ï¼Œæµè§ˆå™¨ä¼šå¼¹å‡ºç™»å½•é¡µé¢ã€‚</li>
<li>æˆ–è€…åœ¨ç»ˆç«¯æ ¹æ®æç¤ºè¾“å…¥ç”¨æˆ·åã€å¯†ç å’Œé‚®ç®±éªŒè¯ç ã€‚</li>
<li>ç™»å½•æˆåŠŸåä¼šæ˜¾ç¤º <code>Logged in as &lt;your-username&gt;</code>.</li>
<li><em>æ³¨æ„ï¼šå¦‚æœä½ ä¹‹å‰åˆ‡æ¢è¿‡æ·˜å®æºï¼Œå‘å¸ƒæ—¶å¿…é¡»åˆ‡å›å®˜æ–¹æºï¼š<code>npm config set registry https://registry.npmjs.org/</code></em></li>
</ul>
<p><strong>ç¬¬äºŒæ­¥ï¼šæ‰“åŒ…ä»£ç </strong></p>
<p>ç¡®ä¿ <code>dist</code> ç›®å½•æ˜¯æœ€æ–°çš„ï¼Œä¸è¦å‘å¸ƒç©ºä»£ç ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">npm run build
</code></pre>
<p><strong>ç¬¬ä¸‰æ­¥ï¼šæ­£å¼å‘å¸ƒ</strong></p>
<pre><code class="hljs language-bash" lang="bash">npm publish --access public
</code></pre>
<ul>
<li><code>--access public</code> å‚æ•°ç”¨äºç¡®ä¿å‘å¸ƒçš„åŒ…æ˜¯å…¬å¼€çš„ï¼ˆç‰¹åˆ«æ˜¯å½“åŒ…åå¸¦ <code>@</code> å‰ç¼€æ—¶ï¼‰ã€‚</li>
<li>çœ‹åˆ° <code>+ error-monitor-sdk@1.0.0</code> å­—æ ·ï¼Œæ­å–œä½ ï¼Œå‘å¸ƒæˆåŠŸï¼</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1bbe233426c94d9fb4653f4fbbd41f4f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5LiA5qC355qE5bCR5bm0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765756691&amp;x-signature=DGvQSg76L0bRNlRS58XzFkJWi5s%3D" alt="7141076e-3f21-4ab4-91d3-5f5918624c9b.png" loading="lazy"/></p>
<p>ç°åœ¨ï¼Œå…¨ä¸–ç•Œçš„å¼€å‘è€…éƒ½å¯ä»¥é€šè¿‡ <code>npm install error-monitor-sdk</code> æ¥ä½¿ç”¨ä½ çš„ä½œå“äº†ï¼</p>
<h2 data-id="heading-17">5. å¦‚ä½•ä½¿ç”¨</h2>
<p>SDK å‘å¸ƒåï¼Œæ”¯æŒå¤šç§å¼•å…¥æ–¹å¼ï¼Œé€‚é…å„ç§å¼€å‘åœºæ™¯ã€‚</p>
<h3 data-id="heading-18">æ–¹å¼ 1ï¼šNPM + ES Modules (æ¨è)</h3>
<p>é€‚ç”¨äºç°ä»£å‰ç«¯é¡¹ç›®ï¼ˆVite, Webpack, Rollup ç­‰ï¼‰ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¯·å°† error-monitor-sdk æ›¿æ¢ä¸ºä½ å®é™…å‘å¸ƒçš„åŒ…å</span>
npm install error-monitor-sdk
</code></pre>
<p>åœ¨ä½ çš„ä¸šåŠ¡ä»£ç å…¥å£ï¼ˆå¦‚ <code>main.ts</code> æˆ– <code>app.js</code>ï¼‰å¼•å…¥å¹¶åˆå§‹åŒ–ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// è¯·å°† error-monitor-sdk æ›¿æ¢ä¸ºä½ å®é™…å‘å¸ƒçš„åŒ…å</span>
<span class="hljs-keyword">import</span> { initErrorMonitor } <span class="hljs-keyword">from</span> <span class="hljs-string">'error-monitor-sdk'</span>;

<span class="hljs-title function_">initErrorMonitor</span>({
  <span class="hljs-attr">reportUrl</span>: <span class="hljs-string">'http://localhost:3000/error-report'</span>,
  <span class="hljs-attr">projectName</span>: <span class="hljs-string">'MyAwesomeProject'</span>,
  <span class="hljs-attr">environment</span>: <span class="hljs-string">'production'</span>,
});
</code></pre>
<h3 data-id="heading-19">æ–¹å¼ 2ï¼šNPM + CommonJS</h3>
<p>é€‚ç”¨äº Node.js ç¯å¢ƒæˆ–æ—§ç‰ˆæ‰“åŒ…å·¥å…·ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¯·å°† error-monitor-sdk æ›¿æ¢ä¸ºä½ å®é™…å‘å¸ƒçš„åŒ…å</span>
npm install error-monitor-sdk
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è¯·å°† error-monitor-sdk æ›¿æ¢ä¸ºä½ å®é™…å‘å¸ƒçš„åŒ…å</span>
<span class="hljs-keyword">const</span> { initErrorMonitor } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'error-monitor-sdk'</span>);

<span class="hljs-title function_">initErrorMonitor</span>({
  <span class="hljs-attr">reportUrl</span>: <span class="hljs-string">'http://localhost:3000/error-report'</span>,
  <span class="hljs-attr">projectName</span>: <span class="hljs-string">'MyAwesomeProject'</span>,
  <span class="hljs-attr">environment</span>: <span class="hljs-string">'production'</span>,
});
</code></pre>
<h3 data-id="heading-20">æ–¹å¼ 3ï¼šCDN ç›´æ¥å¼•å…¥</h3>
<p>é€‚ç”¨äºä¸ä½¿ç”¨æ„å»ºå·¥å…·çš„ä¼ ç»Ÿé¡¹ç›®æˆ–ç®€å•çš„ HTML é¡µé¢ã€‚</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- è¯·å°† error-monitor-sdk æ›¿æ¢ä¸ºä½ å®é™…å‘å¸ƒçš„åŒ…åï¼Œx.x.x æ›¿æ¢ä¸ºå…·ä½“ç‰ˆæœ¬å· --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://unpkg.com/error-monitor-sdk@x.x.x/dist/index.umd.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-comment">// UMD ç‰ˆæœ¬ä¼šå°† SDK æŒ‚è½½åˆ° window.ErrorMonitor</span>
  <span class="hljs-title class_">ErrorMonitor</span>.<span class="hljs-title function_">initErrorMonitor</span>({
    <span class="hljs-attr">reportUrl</span>: <span class="hljs-string">'http://localhost:3000/error-report'</span>,
    <span class="hljs-attr">projectName</span>: <span class="hljs-string">'MyAwesomeProject'</span>,
    <span class="hljs-attr">environment</span>: <span class="hljs-string">'production'</span>,
  });
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h2 data-id="heading-21">6. æ€»ç»“ä¸å±•æœ›</h2>
<p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬è¿™ä¸ªâ€œéº»é›€è™½å°ï¼Œäº”è„ä¿±å…¨â€çš„é”™è¯¯ç›‘æ§ SDK å°±ç®—æ˜¯è·‘èµ·æ¥äº†ã€‚</p>
<p>å›å¤´çœ‹çœ‹ï¼Œå‡ ç™¾è¡Œä»£ç æ²¡ç™½å†™ï¼Œå®æ‰“å®æå®šäº†ä¸‰ä»¶äº‹ï¼š</p>
<ol>
<li><strong>å•¥éƒ½èƒ½æŠ“</strong>ï¼šJS æŠ¥é”™ã€Promise æŒ‚äº†ã€æ¥å£ 500ã€å›¾ç‰‡ 404ï¼Œä¸€ä¸ªéƒ½è·‘ä¸æ‰ï¼Œç»Ÿç»Ÿæ”¶å…¥å›Šä¸­ã€‚</li>
<li><strong>æ­»æ´»éƒ½èƒ½æŠ¥</strong>ï¼šç”¨äº† <code>Navigator.sendBeacon</code>ï¼Œå“ªæ€•ç”¨æˆ·ç§’å…³é¡µé¢ï¼Œæœ€åé‚£æ¡â€œé—è¨€â€ä¹Ÿèƒ½é¡½å¼ºåœ°å‘ç»™æœåŠ¡å™¨ã€‚</li>
<li><strong>æ‹¿æ¥å°±èƒ½ç”¨</strong>ï¼šæ‰“åŒ…å¥½äº†ä¸‰ç§æ ¼å¼ï¼Œè¿˜é€äº†ä¸ªâ€œé¶åœºâ€é¡µé¢ï¼Œç‚¹ç‚¹æŒ‰é’®å°±èƒ½çœ‹æ•ˆæœï¼Œä¸»æ‰“ä¸€ä¸ªçœå¿ƒã€‚</li>
</ol>
<p><strong>ä¸è¿‡è¯´å®è¯ï¼Œè¿™ç¦»çœŸæ­£çš„â€œä¼ä¸šçº§â€ç›‘æ§è¿˜æœ‰ç‚¹è·ç¦»ã€‚</strong></p>
<p>æƒ³åœ¨ç”Ÿäº§ç¯å¢ƒï¼ˆç‰¹åˆ«æ˜¯é«˜æµé‡ä¸šåŠ¡ï¼‰æ‰›å¤§æ——ï¼Œè¿˜å¾—æŠŠä¸‹é¢è¿™äº›å‘å¡«äº†ï¼š</p>
<ul>
<li><strong>åˆ«ç›²çŒœ Bug</strong>ï¼šçº¿ä¸Šä»£ç éƒ½æ˜¯å‹ç¼©çš„ï¼Œå¾—æå®š <strong>Sourcemap è¿˜åŸ</strong>ï¼Œä¸ç„¶å¯¹ç€ <code>a.b is not a function</code> åªæœ‰å“­çš„ä»½ã€‚</li>
<li><strong>é¡µé¢ç™½äº†æ²¡</strong>ï¼šæœ‰æ—¶å€™æ²¡æŠ¥é”™ä½†é¡µé¢ä¸€ç‰‡ç™½ï¼Œè¿™ç§â€œå‡æ­»â€å¾—é  <strong>ç™½å±æ£€æµ‹</strong> æ¥å‘ç°ã€‚</li>
<li><strong>åˆ°åº•å¿«ä¸å¿«</strong>ï¼šå…‰ä¸æŠ¥é”™ä¸å¤Ÿï¼Œè¿˜å¾—çœ‹ <strong>æ€§èƒ½æŒ‡æ ‡</strong> (FCP/LCP)ï¼Œç›‘æ§é¡µé¢åŠ è½½é€Ÿåº¦ã€‚</li>
<li><strong>ç”¨æˆ·å¹²äº†å•¥</strong>ï¼šå¤ç° Bug å…¨é çŒœï¼Ÿä¸è¡Œï¼Œå¾—æŠŠç”¨æˆ·å‡ºäº‹å‰çš„ç‚¹å‡»ã€è·¯ç”±è·³è½¬å…¨è®°ä¸‹æ¥ï¼Œæ¥ä¸ª <strong>è¡Œä¸ºå›æº¯</strong>ï¼ˆæ¡ˆå‘ç°åœºè¿˜åŸï¼‰ã€‚</li>
<li><strong>åˆ«æŠŠæœåŠ¡å™¨æå´©</strong>ï¼šæŠ¥é”™å¤ªå¤šå¾—é™æµã€å»é‡ï¼Œå¼•å…¥ <strong>é‡‡æ ·ç‡</strong>ï¼Œä¸ç„¶ç›‘æ§æœåŠ¡å…ˆæŒ‚äº†å°±å°´å°¬äº†ã€‚</li>
</ul>
<p><strong>è´ªå¤šåš¼ä¸çƒ‚ï¼Œè¿™æ¬¡æˆ‘ä»¬å…ˆèšç„¦åœ¨æœ€æ ¸å¿ƒçš„â€œé”™è¯¯ç›‘æ§â€é—­ç¯ã€‚</strong></p>
<p>è‡³äºä¸Šé¢é‚£äº›è¿›é˜¶ç©æ³•ï¼Œ<strong>æˆ‘ä»¬ä¸‹ç¯‡æ–‡ç« æ¥ç€èŠ</strong>ï¼Œå¸¦ä½ ä¸€æ­¥æ­¥æŠŠè¿™ä¸ªç³»ç»Ÿæ‰“ç£¨å¾—æ›´å®Œç¾ã€‚</p>
<p>é€ è½®å­ä¸æ˜¯ä¸ºäº†é‡å¤é€ ï¼Œè€Œæ˜¯ä¸ºäº†äº²æ‰‹æ‹†å¼€çœ‹çœ‹é‡Œé¢çš„é½¿è½®æ˜¯æ€ä¹ˆè½¬çš„ï¼Œè¿™æ‰æ˜¯å­¦ä¹ çš„æœ¬è´¨ã€‚</p>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½æ˜¯ä½ æ‰“é€ ä¸“å±ç›‘æ§ç³»ç»Ÿçš„èµ·ç‚¹ã€‚<strong>Happy Coding!</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Redisï¼ˆ170ï¼‰å¦‚ä½•ä½¿ç”¨Rediså®ç°åˆ†å¸ƒå¼é™æµï¼Ÿ]]></title>    <link>https://juejin.cn/post/7580834172059713571</link>    <guid>https://juejin.cn/post/7580834172059713571</guid>    <pubDate>2025-12-07T23:02:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580834172059713571" data-draft-id="7580570363602763828" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Redisï¼ˆ170ï¼‰å¦‚ä½•ä½¿ç”¨Rediså®ç°åˆ†å¸ƒå¼é™æµï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-07T23:02:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Redisï¼ˆ170ï¼‰å¦‚ä½•ä½¿ç”¨Rediså®ç°åˆ†å¸ƒå¼é™æµï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T23:02:45.000Z" title="Sun Dec 07 2025 23:02:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½¿ç”¨Rediså®ç°åˆ†å¸ƒå¼é™æµæ˜¯ä¸€ç§å¸¸è§ä¸”æœ‰æ•ˆçš„æ–¹æ³•ï¼Œå¯ä»¥é˜²æ­¢ç³»ç»Ÿè¿‡è½½å¹¶ç¡®ä¿å…¬å¹³çš„èµ„æºåˆ†é…ã€‚Redisçš„é«˜æ€§èƒ½å’Œä¸°å¯Œçš„æ•°æ®ç»“æ„ä½¿å…¶æˆä¸ºå®ç°åˆ†å¸ƒå¼é™æµçš„ç†æƒ³é€‰æ‹©ã€‚å¸¸è§çš„é™æµç®—æ³•åŒ…æ‹¬å›ºå®šçª—å£è®¡æ•°ã€æ»‘åŠ¨çª—å£è®¡æ•°å’Œä»¤ç‰Œæ¡¶ç®—æ³•ã€‚</p>
<h3 data-id="heading-0">1. å›ºå®šçª—å£è®¡æ•°ç®—æ³•</h3>
<p>å›ºå®šçª—å£è®¡æ•°ç®—æ³•å°†æ—¶é—´åˆ’åˆ†ä¸ºå›ºå®šé•¿åº¦çš„çª—å£ï¼Œå¹¶åœ¨æ¯ä¸ªçª—å£å†…è®¡æ•°è¯·æ±‚çš„æ•°é‡ã€‚</p>
<h4 data-id="heading-1">ç¤ºä¾‹ä»£ç </h4>
<p>ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨Rediså®ç°å›ºå®šçª—å£è®¡æ•°ç®—æ³•çš„åˆ†å¸ƒå¼é™æµï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FixedWindowRateLimiter</span> {

    <span class="hljs-keyword">private</span> Jedis jedis;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> maxRequests;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> windowSize; <span class="hljs-comment">// çª—å£å¤§å°ï¼Œå•ä½ä¸ºç§’</span>

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">FixedWindowRateLimiter</span><span class="hljs-params">(String host, <span class="hljs-type">int</span> port, <span class="hljs-type">int</span> maxRequests, <span class="hljs-type">int</span> windowSize)</span> {
        <span class="hljs-built_in">this</span>.jedis = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(host, port);
        <span class="hljs-built_in">this</span>.maxRequests = maxRequests;
        <span class="hljs-built_in">this</span>.windowSize = windowSize;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isAllowed</span><span class="hljs-params">(String clientId)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> <span class="hljs-string">"rate_limiter:"</span> + clientId;
        <span class="hljs-type">long</span> <span class="hljs-variable">currentWindow</span> <span class="hljs-operator">=</span> System.currentTimeMillis() / <span class="hljs-number">1000</span> / windowSize;
        <span class="hljs-type">String</span> <span class="hljs-variable">windowKey</span> <span class="hljs-operator">=</span> key + <span class="hljs-string">":"</span> + currentWindow;

        <span class="hljs-type">long</span> <span class="hljs-variable">requestCount</span> <span class="hljs-operator">=</span> jedis.incr(windowKey);
        <span class="hljs-keyword">if</span> (requestCount == <span class="hljs-number">1</span>) {
            jedis.expire(windowKey, windowSize);
        }

        <span class="hljs-keyword">return</span> requestCount &lt;= maxRequests;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> {
        jedis.close();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">FixedWindowRateLimiter</span> <span class="hljs-variable">rateLimiter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FixedWindowRateLimiter</span>(<span class="hljs-string">"localhost"</span>, <span class="hljs-number">6379</span>, <span class="hljs-number">5</span>, <span class="hljs-number">60</span>);

        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {
            <span class="hljs-type">boolean</span> <span class="hljs-variable">allowed</span> <span class="hljs-operator">=</span> rateLimiter.isAllowed(<span class="hljs-string">"client1"</span>);
            System.out.println(<span class="hljs-string">"Request "</span> + (i + <span class="hljs-number">1</span>) + <span class="hljs-string">" allowed: "</span> + allowed);
            <span class="hljs-keyword">try</span> {
                Thread.sleep(<span class="hljs-number">500</span>); <span class="hljs-comment">// æ¨¡æ‹Ÿè¯·æ±‚é—´éš”</span>
            } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                e.printStackTrace();
            }
        }

        rateLimiter.close();
    }
}
</code></pre>
<h3 data-id="heading-2">2. æ»‘åŠ¨çª—å£è®¡æ•°ç®—æ³•</h3>
<p>æ»‘åŠ¨çª—å£è®¡æ•°ç®—æ³•é€šè¿‡è®°å½•å¤šä¸ªå°çª—å£å†…çš„è¯·æ±‚æ•°ï¼Œè®¡ç®—æ»‘åŠ¨çª—å£å†…çš„æ€»è¯·æ±‚æ•°ã€‚</p>
<h4 data-id="heading-3">ç¤ºä¾‹ä»£ç </h4>
<p>ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨Rediså®ç°æ»‘åŠ¨çª—å£è®¡æ•°ç®—æ³•çš„åˆ†å¸ƒå¼é™æµï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;
<span class="hljs-keyword">import</span> redis.clients.jedis.Transaction;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SlidingWindowRateLimiter</span> {

    <span class="hljs-keyword">private</span> Jedis jedis;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> maxRequests;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> windowSize; <span class="hljs-comment">// çª—å£å¤§å°ï¼Œå•ä½ä¸ºç§’</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> interval; <span class="hljs-comment">// æ—¶é—´é—´éš”ï¼Œå•ä½ä¸ºç§’</span>

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">SlidingWindowRateLimiter</span><span class="hljs-params">(String host, <span class="hljs-type">int</span> port, <span class="hljs-type">int</span> maxRequests, <span class="hljs-type">int</span> windowSize, <span class="hljs-type">int</span> interval)</span> {
        <span class="hljs-built_in">this</span>.jedis = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(host, port);
        <span class="hljs-built_in">this</span>.maxRequests = maxRequests;
        <span class="hljs-built_in">this</span>.windowSize = windowSize;
        <span class="hljs-built_in">this</span>.interval = interval;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isAllowed</span><span class="hljs-params">(String clientId)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> <span class="hljs-string">"rate_limiter:"</span> + clientId;
        <span class="hljs-type">long</span> <span class="hljs-variable">currentTime</span> <span class="hljs-operator">=</span> System.currentTimeMillis() / <span class="hljs-number">1000</span>;
        <span class="hljs-type">long</span> <span class="hljs-variable">windowStart</span> <span class="hljs-operator">=</span> currentTime - windowSize;

        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> jedis.multi();
        transaction.zadd(key, currentTime, String.valueOf(currentTime));
        transaction.zremrangeByScore(key, <span class="hljs-number">0</span>, windowStart);
        transaction.zcard(key);
        transaction.expire(key, windowSize + interval);

        List&lt;Object&gt; results = transaction.exec();
        <span class="hljs-type">long</span> <span class="hljs-variable">requestCount</span> <span class="hljs-operator">=</span> (<span class="hljs-type">long</span>) results.get(<span class="hljs-number">2</span>);

        <span class="hljs-keyword">return</span> requestCount &lt;= maxRequests;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> {
        jedis.close();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">SlidingWindowRateLimiter</span> <span class="hljs-variable">rateLimiter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SlidingWindowRateLimiter</span>(<span class="hljs-string">"localhost"</span>, <span class="hljs-number">6379</span>, <span class="hljs-number">5</span>, <span class="hljs-number">60</span>, <span class="hljs-number">1</span>);

        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {
            <span class="hljs-type">boolean</span> <span class="hljs-variable">allowed</span> <span class="hljs-operator">=</span> rateLimiter.isAllowed(<span class="hljs-string">"client1"</span>);
            System.out.println(<span class="hljs-string">"Request "</span> + (i + <span class="hljs-number">1</span>) + <span class="hljs-string">" allowed: "</span> + allowed);
            <span class="hljs-keyword">try</span> {
                Thread.sleep(<span class="hljs-number">500</span>); <span class="hljs-comment">// æ¨¡æ‹Ÿè¯·æ±‚é—´éš”</span>
            } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                e.printStackTrace();
            }
        }

        rateLimiter.close();
    }
}
</code></pre>
<h3 data-id="heading-4">3. ä»¤ç‰Œæ¡¶ç®—æ³•</h3>
<p>ä»¤ç‰Œæ¡¶ç®—æ³•é€šè¿‡ç”Ÿæˆä»¤ç‰Œæ¥æ§åˆ¶è¯·æ±‚çš„é€Ÿç‡ã€‚æ¯æ¬¡è¯·æ±‚éœ€è¦æ¶ˆè€—ä¸€ä¸ªä»¤ç‰Œï¼Œå¦‚æœæ¡¶ä¸­æ²¡æœ‰ä»¤ç‰Œï¼Œåˆ™è¯·æ±‚è¢«æ‹’ç»ã€‚</p>
<h4 data-id="heading-5">ç¤ºä¾‹ä»£ç </h4>
<p>ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨Rediså®ç°ä»¤ç‰Œæ¡¶ç®—æ³•çš„åˆ†å¸ƒå¼é™æµï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TokenBucketRateLimiter</span> {

    <span class="hljs-keyword">private</span> Jedis jedis;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> maxTokens;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> refillRate; <span class="hljs-comment">// ä»¤ç‰Œç”Ÿæˆé€Ÿç‡ï¼Œå•ä½ä¸ºä»¤ç‰Œ/ç§’</span>

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">TokenBucketRateLimiter</span><span class="hljs-params">(String host, <span class="hljs-type">int</span> port, <span class="hljs-type">int</span> maxTokens, <span class="hljs-type">int</span> refillRate)</span> {
        <span class="hljs-built_in">this</span>.jedis = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(host, port);
        <span class="hljs-built_in">this</span>.maxTokens = maxTokens;
        <span class="hljs-built_in">this</span>.refillRate = refillRate;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isAllowed</span><span class="hljs-params">(String clientId)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> <span class="hljs-string">"rate_limiter:"</span> + clientId;
        <span class="hljs-type">long</span> <span class="hljs-variable">currentTime</span> <span class="hljs-operator">=</span> System.currentTimeMillis() / <span class="hljs-number">1000</span>;
        <span class="hljs-type">long</span> <span class="hljs-variable">lastRefillTime</span> <span class="hljs-operator">=</span> jedis.hget(key, <span class="hljs-string">"lastRefillTime"</span>) == <span class="hljs-literal">null</span> ?
                <span class="hljs-number">0</span> : Long.parseLong(jedis.hget(key, <span class="hljs-string">"lastRefillTime"</span>));
        <span class="hljs-type">int</span> <span class="hljs-variable">tokens</span> <span class="hljs-operator">=</span> jedis.hget(key, <span class="hljs-string">"tokens"</span>) == <span class="hljs-literal">null</span> ?
                maxTokens : Integer.parseInt(jedis.hget(key, <span class="hljs-string">"tokens"</span>));

        <span class="hljs-type">long</span> <span class="hljs-variable">tokensToAdd</span> <span class="hljs-operator">=</span> (currentTime - lastRefillTime) * refillRate;
        tokens = Math.min(maxTokens, tokens + (<span class="hljs-type">int</span>) tokensToAdd);
        lastRefillTime = currentTime;

        <span class="hljs-keyword">if</span> (tokens &gt; <span class="hljs-number">0</span>) {
            jedis.hset(key, <span class="hljs-string">"tokens"</span>, String.valueOf(tokens - <span class="hljs-number">1</span>));
            jedis.hset(key, <span class="hljs-string">"lastRefillTime"</span>, String.valueOf(lastRefillTime));
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        } <span class="hljs-keyword">else</span> {
            jedis.hset(key, <span class="hljs-string">"tokens"</span>, String.valueOf(tokens));
            jedis.hset(key, <span class="hljs-string">"lastRefillTime"</span>, String.valueOf(lastRefillTime));
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> {
        jedis.close();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">TokenBucketRateLimiter</span> <span class="hljs-variable">rateLimiter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TokenBucketRateLimiter</span>(<span class="hljs-string">"localhost"</span>, <span class="hljs-number">6379</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>);

        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {
            <span class="hljs-type">boolean</span> <span class="hljs-variable">allowed</span> <span class="hljs-operator">=</span> rateLimiter.isAllowed(<span class="hljs-string">"client1"</span>);
            System.out.println(<span class="hljs-string">"Request "</span> + (i + <span class="hljs-number">1</span>) + <span class="hljs-string">" allowed: "</span> + allowed);
            <span class="hljs-keyword">try</span> {
                Thread.sleep(<span class="hljs-number">500</span>); <span class="hljs-comment">// æ¨¡æ‹Ÿè¯·æ±‚é—´éš”</span>
            } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                e.printStackTrace();
            }
        }

        rateLimiter.close();
    }
}
</code></pre>
<h3 data-id="heading-6">4. ä»¤ç‰Œæ¡¶ç®—æ³•ä¸Luaè„šæœ¬</h3>
<p>ä¸ºäº†ç¡®ä¿é™æµæ“ä½œçš„åŸå­æ€§ï¼Œå¯ä»¥ä½¿ç”¨Redisçš„Luaè„šæœ¬ã€‚ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ç»“åˆLuaè„šæœ¬å’Œä»¤ç‰Œæ¡¶ç®—æ³•æ¥å®ç°åˆ†å¸ƒå¼é™æµã€‚</p>
<h4 data-id="heading-7">Luaè„šæœ¬</h4>
<p>ä¿å­˜ä¸º<code>token_bucket.lua</code>ï¼š</p>
<pre><code class="hljs language-lua" lang="lua"><span class="hljs-keyword">local</span> key = KEYS[<span class="hljs-number">1</span>]
<span class="hljs-keyword">local</span> maxTokens = <span class="hljs-built_in">tonumber</span>(ARGV[<span class="hljs-number">1</span>])
<span class="hljs-keyword">local</span> refillRate = <span class="hljs-built_in">tonumber</span>(ARGV[<span class="hljs-number">2</span>])
<span class="hljs-keyword">local</span> currentTime = <span class="hljs-built_in">tonumber</span>(ARGV[<span class="hljs-number">3</span>])

<span class="hljs-keyword">local</span> tokens = <span class="hljs-built_in">tonumber</span>(redis.call(<span class="hljs-string">"hget"</span>, key, <span class="hljs-string">"tokens"</span>) <span class="hljs-keyword">or</span> maxTokens)
<span class="hljs-keyword">local</span> lastRefillTime = <span class="hljs-built_in">tonumber</span>(redis.call(<span class="hljs-string">"hget"</span>, key, <span class="hljs-string">"lastRefillTime"</span>) <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>)

<span class="hljs-keyword">local</span> tokensToAdd = <span class="hljs-built_in">math</span>.<span class="hljs-built_in">floor</span>((currentTime - lastRefillTime) * refillRate)
tokens = <span class="hljs-built_in">math</span>.<span class="hljs-built_in">min</span>(maxTokens, tokens + tokensToAdd)
lastRefillTime = currentTime

<span class="hljs-keyword">if</span> tokens &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">then</span>
    redis.call(<span class="hljs-string">"hset"</span>, key, <span class="hljs-string">"tokens"</span>, tokens - <span class="hljs-number">1</span>)
    redis.call(<span class="hljs-string">"hset"</span>, key, <span class="hljs-string">"lastRefillTime"</span>, lastRefillTime)
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>
<span class="hljs-keyword">else</span>
    redis.call(<span class="hljs-string">"hset"</span>, key, <span class="hljs-string">"tokens"</span>, tokens)
    redis.call(<span class="hljs-string">"hset"</span>, key, <span class="hljs-string">"lastRefillTime"</span>, lastRefillTime)
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
<span class="hljs-keyword">end</span>
</code></pre>
<h4 data-id="heading-8">Javaä»£ç </h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;
<span class="hljs-keyword">import</span> redis.clients.jedis.JedisPool;

<span class="hljs-keyword">import</span> java.io.IOException;
<span class="hljs-keyword">import</span> java.nio.file.Files;
<span class="hljs-keyword">import</span> java.nio.file.Paths;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TokenBucketRateLimiterWithLua</span> {

    <span class="hljs-keyword">private</span> JedisPool jedisPool;
    <span class="hljs-keyword">private</span> String luaScript;
    <span class="hljs-keyword">private</span> String scriptSha;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">TokenBucketRateLimiterWithLua</span><span class="hljs-params">(String host, <span class="hljs-type">int</span> port, String scriptPath)</span> <span class="hljs-keyword">throws</span> IOException {
        <span class="hljs-built_in">this</span>.jedisPool = <span class="hljs-keyword">new</span> <span class="hljs-title class_">JedisPool</span>(host, port);
        <span class="hljs-built_in">this</span>.luaScript = <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(Files.readAllBytes(Paths.get(scriptPath)));
        <span class="hljs-keyword">try</span> (<span class="hljs-type">Jedis</span> <span class="hljs-variable">jedis</span> <span class="hljs-operator">=</span> jedisPool.getResource()) {
            <span class="hljs-built_in">this</span>.scriptSha = jedis.scriptLoad(luaScript);
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isAllowed</span><span class="hljs-params">(String clientId, <span class="hljs-type">int</span> maxTokens, <span class="hljs-type">int</span> refillRate)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> <span class="hljs-string">"rate_limiter:"</span> + clientId;
        <span class="hljs-type">long</span> <span class="hljs-variable">currentTime</span> <span class="hljs-operator">=</span> System.currentTimeMillis() / <span class="hljs-number">1000</span>;

</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å…¬å¸å†…ç½‘éƒ¨ç½²å¤§æ¨¡å‹çš„æ¢ç´¢ä¹‹è·¯]]></title>    <link>https://juejin.cn/post/7580550040395890723</link>    <guid>https://juejin.cn/post/7580550040395890723</guid>    <pubDate>2025-12-07T16:09:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580550040395890723" data-draft-id="7580423629165101108" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å…¬å¸å†…ç½‘éƒ¨ç½²å¤§æ¨¡å‹çš„æ¢ç´¢ä¹‹è·¯"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-07T16:09:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é”‹è¡Œå¤©ä¸‹"/> <meta itemprop="url" content="https://juejin.cn/user/2788017220878536"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å…¬å¸å†…ç½‘éƒ¨ç½²å¤§æ¨¡å‹çš„æ¢ç´¢ä¹‹è·¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2788017220878536/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é”‹è¡Œå¤©ä¸‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T16:09:08.000Z" title="Sun Dec 07 2025 16:09:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä½¿ç”¨åœºæ™¯</h2>
<p>å…¬å¸çš„åŠå…¬ç¯å¢ƒæ˜¯å†…ç½‘ï¼Œä¸å’Œäº’è”ç½‘ç›¸è¿ï¼ˆä¿å¯†å•ä½ï¼Œåˆ«é—®ä¸ºå•¥è¿™æ ·ï¼‰ï¼Œè¦æ›´æ–°ä¸ªé¡¹ç›®ä¾èµ–å•¥çš„ï¼Œå¾ˆéº»çƒ¦ï¼Œè¦ä½¿ç”¨Uç›˜æ¥å›æ‹·è´æ–‡ä»¶ï¼Œè¿™æ˜¯å‰æï¼Œæˆ‘ç°åœ¨è¦åœ¨å†…ç½‘ç¯å¢ƒéƒ¨ç½²å¤§æ¨¡å‹ï¼Œä¹Ÿæ˜¯ä¸€æ³¢ä¸‰æŠ˜ï¼Œä»¥ä¸‹æ˜¯æˆ‘çš„æ¢ç´¢ä¹‹è·¯</p>
<ol>
<li>åœ¨å¤–ç½‘ä½¿ç”¨docker è¿è¡Œ ollama é•œåƒ,ç”±äºæˆ‘æœ¬åœ°ç”µè„‘æ˜¯macç”µè„‘ï¼ŒæœåŠ¡æ˜¯linuxï¼Œå› ä¸ºæ˜¯è¦æŠŠå®¹å™¨å¯¼å‡ºä¸ºé•œåƒæ–‡ä»¶æ‹¿åˆ°å†…ç½‘ä½¿ç”¨ï¼Œæ‰€ä»¥æ‹‰å–é•œåƒçš„æ—¶å€™è¦æŒ‡å®šå®¿ä¸»æœºæ¶æ„,ä¸ç„¶çš„è¯ï¼Œå¯¼å‡ºçš„é•œåƒæ–‡ä»¶åœ¨æœåŠ¡å™¨æ— æ³•è¿è¡Œ</li>
</ol>

<pre><code class="hljs language-bash" lang="bash">docker pull --flatform=linux/amd64 ollama/ollama:latest
</code></pre>

<pre><code class="hljs language-css" lang="css">docker run -d <span class="hljs-attr">--name</span> ollama-test -<span class="hljs-selector-tag">p</span> <span class="hljs-number">11434</span>:<span class="hljs-number">11434</span> ollama/ollama:latest
</code></pre>
<p>2.  è¿è¡Œä¸€ä¸ªollamaå®¹å™¨ï¼Œç„¶åè¿›å…¥åˆ°è¯¥å®¹å™¨å†…éƒ¨ï¼Œç”¨ollamaæŒ‡ä»¤å®‰è£…æŒ‡å®šå¤§æ¨¡å‹</p>

<pre><code class="hljs language-arduino" lang="arduino">docker exec -it ollama-test bash
<span class="hljs-comment">//è¿™é‡Œä»¥deepseek-r1:1.5b ä¸ºä¾‹å­</span>
ollama run deepseek-r1:<span class="hljs-number">1.5b</span>
</code></pre>
<p>3.  è¿™æ—¶å€™æ˜¯å¯ä»¥åœ¨æœ¬æœºä½¿ç”¨chatboxé“¾æ¥ä½¿ç”¨å®¹å™¨å†…çš„å¤§æ¨¡å‹çš„ï¼Œå…·ä½“æ­¥éª¤ä¸åœ¨è¿™é‡Œç»†è¯´</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5245e4686e604abf9683519b0a01c341~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZSL6KGM5aSp5LiL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765728548&amp;x-signature=OAhKjqRbUk7i4GrwDmcaXIhZE8Q%3D" alt="22.png" loading="lazy"/>
4. æŠŠè¿è¡Œä¸­çš„å®¹å™¨æäº¤ä¸ºæœ¬åœ°é•œåƒï¼Œè¿™æ ·ä½ çš„é•œåƒé‡Œå°±å¸¦ä¸Šäº†ä½ å®‰è£…çš„å¤§æ¨¡å‹</p>
<pre><code class="hljs language-arduino" lang="arduino">docker commit xxx yyy:latest
<span class="hljs-comment">// xxx ä¸ºå®¹å™¨åæˆ–è€…id yyy:latest æ˜¯ä½ è‡ªå®šä¹‰çš„é•œåƒåå’Œç‰ˆæœ¬å·</span>
</code></pre>
<p>5.  æŠŠæœ¬åœ°è‡ªå®šä¹‰é•œåƒå¯¼å‡ºä¸ºé•œåƒæ–‡ä»¶</p>

<pre><code class="hljs language-xml" lang="xml">docker save -o <span class="hljs-tag">&lt;<span class="hljs-name">filename</span>&gt;</span>.tar <span class="hljs-tag">&lt;<span class="hljs-name">image_name</span>&gt;</span>
</code></pre>
<p>6.  æŠŠé•œåƒæ–‡ä»¶æ‹·åˆ°å†…ç½‘ï¼Œä½¿ç”¨dockeråŠ è½½ä½ çš„é•œåƒæ–‡ä»¶ï¼Œå‰ææ¡ä»¶æ˜¯å†…ç½‘å¿…é¡»æœ‰dockerç¯å¢ƒ</p>

<pre><code class="hljs language-css" lang="css">docker load -<span class="hljs-selector-tag">i</span> /path/<span class="hljs-selector-tag">to</span>/your/image<span class="hljs-selector-class">.tar</span>
</code></pre>
<p>åˆ°æ­¤ä¸ºæ­¢ï¼Œä½ çš„å†…ç½‘å°±æœ‰æºå¸¦å¤§æ¨¡å‹çš„ollamaé•œåƒäº†,ä½ æŠŠå®¹å™¨è¿è¡Œèµ·æ¥ï¼Œä½ å†æŠŠchatboxå®‰è£…åŒ…ä¹Ÿæ‹·åˆ°å†…ç½‘ï¼Œå°±å¯ä»¥æ„‰å¿«çš„ç©è€äº†</p>
<h2 data-id="heading-1">å¦‚ä½•æ–°å¢å…¶ä»–å¤§æ¨¡å‹åˆ°å†…ç½‘</h2>
<p>ç°åœ¨çš„å¤§æ¨¡å‹æœ‰å¾ˆå¤šï¼ŒåŠŸèƒ½å„ä¸ç›¸åŒï¼Œä½ å¯ä»¥å¤šå®‰è£…å‡ ä¸ªå¤§æ¨¡å‹ï¼Œå†å¯¼å‡ºé•œåƒæ–‡ä»¶ï¼Œæ‹¿åˆ°å†…ç½‘ä½¿ç”¨,å®‰è£…äº†å¤§æ¨¡å‹çš„é•œåƒæ–‡ä»¶ä¼šå¾ˆå¤§ï¼Œæˆ‘ä¹Ÿå°±å®‰è£…äº†ä¸Šå›¾çš„å‡ ä¸ªå°æ¨¡å‹ï¼Œæ–‡ä»¶çš„ä½“ç§¯å°±å·²ç»è¾¾åˆ°äº†30Gä»¥ä¸Šï¼Œä½†æ˜¯è¿™ä¸å¤±ä¸ºä¸€ç§ç¬¨æ–¹æ³•ã€‚å¤§åŠ›å‡ºå¥‡è¿¹ï¼Œä½†æ˜¯ä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜ï¼Œæˆ‘ä»¬æ€»æ˜¯è¦æ¢ç´¢æ›´çœæ—¶çœåŠ›çš„åŠæ³•ï¼Œä»¥ä¸‹æ˜¯æˆ‘ä¸ªäººæ¢ç´¢çš„æ–¹æ³•ã€‚</p>
<ol>
<li>é‡æ–°è¿è¡Œä¸€ä¸ªç©ºç™½çš„ollamaå®¹å™¨ï¼ŒæŠŠä½ è¦æ–°å¢çš„å¤§æ¨¡å‹å®‰è£…ä¸Š</li>
<li>ä½¿ç”¨docker cpæŒ‡ä»¤æŠŠå®¹å™¨å†…çš„æ¨¡å‹æ–‡ä»¶æ‹·è´å‡ºæ¥ï¼Œæ‹¿åˆ°å†…ç½‘ï¼Œæ”¾åˆ°æŒ‡å®šçš„ä½ç½®å³å¯ï¼Œä¸»è¦æœ‰ä¸¤ç±»æ–‡ä»¶éœ€è¦æ‹·è´ï¼Œæ¨¡å‹é…ç½®æ–‡ä»¶å’Œæ¨¡å‹æ•°æ®æ–‡ä»¶ï¼Œè¿™ä¸¤ç±»æ–‡ä»¶çš„ç›®å½•åˆ†åˆ«æ˜¯</li>
</ol>

<pre><code class="hljs language-ruby" lang="ruby">/<span class="hljs-regexp">/ æ¨¡å‹æ•°æ®æ–‡ä»¶åœ¨ /root</span><span class="hljs-regexp">/.ollama/models</span><span class="hljs-regexp">/blobs
docker cp bff31133b939:/root</span><span class="hljs-regexp">/.ollama/models</span><span class="hljs-regexp">/blobs/</span>. ./blobs
/<span class="hljs-regexp">/ æˆ‘è¿™ä¸ªæŒ‡ä»¤çš„æ„æ€æ˜¯ æŠŠ å®¹å™¨å†…çš„æ•°æ®æ–‡ä»¶æ‹·è´åˆ° æœ¬æœºçš„å½“å‰ç›®å½•çš„blobsæ–‡ä»¶å¤¹ä¸‹ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ç»å¯¹è·¯å¾„
docker cp bff31133b939:/root</span><span class="hljs-regexp">/.ollama/models</span><span class="hljs-regexp">/manifests/registry</span>.ollama.ai/library/. ./
<span class="hljs-regexp">//</span> è¿™ä¸ªæŒ‡ä»¤çš„æ„æ€æ˜¯æŠŠè¿™ä¸ªæ¨¡å‹çš„é…ç½®æ–‡ä»¶æ‹·è´å½“å½“å‰ç›®å½•ä¸‹ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ç»å¯¹è·¯å¾„
</code></pre>
<p>ä»¥ä¸‹æ˜¯æˆ‘æ‹·è´å‡ºæ¥çš„deepseek-r1:8bçš„é…ç½®æ–‡ä»¶å’Œæ•°æ®æ–‡ä»¶æˆªå›¾</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e6f43feb852f4c3ea12db1d604bbcc27~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZSL6KGM5aSp5LiL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765728548&amp;x-signature=obN3M5Z5sjAPNqb8n9dzIW%2BvMjg%3D" alt="333.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/84c1bb8488ec46179573cf97cc9e2599~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZSL6KGM5aSp5LiL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765728548&amp;x-signature=wEnF9QC2eT2l85OJ%2BCW3PNMO6RE%3D" alt="444.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/893924d0caf746bd9991a2ee26f905d6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZSL6KGM5aSp5LiL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765728548&amp;x-signature=6XCn2SYJr%2F5BIDLR4nNEVs9DfM4%3D" alt="555.png" loading="lazy"/></p>
<ol start="3">
<li>æŠŠè¿™ä¸¤ä¸ªæ–‡ä»¶æ‹·è´åˆ°å†…ç½‘ï¼Œæ”¾åˆ°ä»¥å‰çš„å®¹å™¨é‡Œå¯¹åº”çš„ç›®å½•ä¸‹ï¼Œè¿™æ ·ä½ å†…ç½‘çš„å®¹å™¨å°±æ–°å¢äº†ä½ è¿™æ¬¡å¯¼å…¥çš„æ¨¡å‹</li>
</ol>
<h2 data-id="heading-2">ç–‘é—®ï¼šæœ‰äº›è€å¸æœºçœ‹åˆ°è¿™é‡Œå°±éƒé—·äº†ï¼Œè¿è¡Œå®¹å™¨æ—¶å€™ç›´æ¥ç”¨æ•°æ®å·åŠŸèƒ½ï¼ŒæŠŠå®¹å™¨å†…çš„ç›®å½•æŒ‚è½½å‡ºæ¥ï¼Œè¿™æ ·å°±ä¸ç”¨è¿›å…¥åˆ°å®¹å™¨å†…æ‹·è´æ–‡ä»¶äº†ï¼Œå“ˆå“ˆå“ˆå“ˆå“ˆ çš®è£¤å¥—æ£‰è£¤ï¼å¿…å®šæœ‰ç¼˜æ•…ï¼Œæˆ‘åˆšå¼€å§‹ä¹Ÿæ˜¯è¿™æ ·æƒ³çš„ï¼Œä½†æ˜¯æˆ‘è¯•äº†å¥½å¤šæ¬¡ï¼Œè¿è¡Œå®¹å™¨æ—¶ä½¿ç”¨æ•°æ®å·åŠŸèƒ½æ ¹æœ¬å°±è¿è¡Œä¸äº†ï¼Œå¤§è‡´åŸå› æ˜¯æˆ‘ç”¨çš„æ˜¯macç”µè„‘ï¼Œæ˜¯arm64æ¶æ„ï¼Œæˆ‘ä½¿ç”¨çš„å®¹å™¨æ˜¯amd64æ¶æ„ï¼Œå®ƒä¸¤çš„æ–‡ä»¶ç³»ç»Ÿä¸å…¼å®¹ï¼Œæ— æ³•ç›´æ¥ä½¿ç”¨æ•°æ®å·åŠŸèƒ½ï¼Œåˆ°è¿™é‡Œæœ‰å°ä¼™ä¼´æ‰¾åˆ°æ›´å¥½çš„åŠæ³•äº†ä¸€å®šè¦æ•™æ•™æˆ‘ï¼Œæ„Ÿè°¢ï¼</h2></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‰‹å†™ EventEmitterï¼šæ·±å…¥ç†è§£å‘å¸ƒè®¢é˜…æ¨¡å¼]]></title>    <link>https://juejin.cn/post/7580389111921508415</link>    <guid>https://juejin.cn/post/7580389111921508415</guid>    <pubDate>2025-12-07T15:31:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580389111921508415" data-draft-id="7580389111921492031" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‰‹å†™ EventEmitterï¼šæ·±å…¥ç†è§£å‘å¸ƒè®¢é˜…æ¨¡å¼"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,EventBus"/> <meta itemprop="datePublished" content="2025-12-07T15:31:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="1024è‚¥å®…"/> <meta itemprop="url" content="https://juejin.cn/user/588993964030574"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‰‹å†™ EventEmitterï¼šæ·±å…¥ç†è§£å‘å¸ƒè®¢é˜…æ¨¡å¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/588993964030574/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    1024è‚¥å®…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T15:31:40.000Z" title="Sun Dec 07 2025 15:31:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h4 data-id="heading-0">å¼•è¨€</h4>
<p>åœ¨ JavaScript å¼€å‘ä¸­ï¼Œäº‹ä»¶é©±åŠ¨ç¼–ç¨‹æ˜¯æ„å»ºå¯ç»´æŠ¤ã€å¯æ‰©å±•åº”ç”¨çš„æ ¸å¿ƒèŒƒå¼ä¹‹ä¸€ã€‚ä»æµè§ˆå™¨ <code>DOM</code> äº‹ä»¶åˆ° Node.js çš„å¼‚æ­¥ <code>I/O</code>ï¼Œä» <code>Vue</code> çš„ç»„ä»¶é€šä¿¡åˆ° <code>React</code> çš„çŠ¶æ€ç®¡ç†ï¼Œå‘å¸ƒè®¢é˜…æ¨¡å¼æ— å¤„ä¸åœ¨ã€‚</p>
<p>é€šè¿‡æ‰‹å†™ä¸€ä¸ªç¬¦åˆ Node.js EventEmitter æ ‡å‡†çš„å®ç°ï¼Œæˆ‘ä»¬ä¸ä»…èƒ½æ·±å…¥ç†è§£äº‹ä»¶é©±åŠ¨æ¶æ„çš„è®¾è®¡åŸç†ï¼Œè¿˜èƒ½æŒæ¡ JavaScript ä¸­é—­åŒ…ã€å†…å­˜ç®¡ç†ã€è®¾è®¡æ¨¡å¼ç­‰æ ¸å¿ƒæ¦‚å¿µã€‚æ›´é‡è¦çš„æ˜¯ï¼Œè¿™æ˜¯é¢è¯•ä¸­å¸¸è§çš„é«˜çº§é¢˜ç›®ï¼Œèƒ½ä½“ç°ä½ å¯¹JavaScriptè®¾è®¡æ¨¡å¼çš„ç†è§£æ·±åº¦ã€‚</p>
<p>æœ¬æ–‡å°†å¸¦ä½ ä»é›¶å®ç°ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„<code>EventEmitter</code>ï¼Œå¹¶æ¢è®¨å…¶åœ¨å®é™…é¡¹ç›®ä¸­çš„åº”ç”¨å’Œä¼˜åŒ–ç­–ç•¥ã€‚</p>
<h4 data-id="heading-1">ä¸€ã€å‘å¸ƒè®¢é˜…æ¨¡å¼çš„æ ¸å¿ƒæ¦‚å¿µ</h4>
<h5 data-id="heading-2">1.1 ä»€ä¹ˆæ˜¯å‘å¸ƒè®¢é˜…æ¨¡å¼</h5>
<p>å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼ˆPub/Subï¼‰æ˜¯ä¸€ç§æ¶ˆæ¯ä¼ é€’èŒƒå¼ï¼Œæ¶ˆæ¯çš„å‘é€è€…ï¼ˆå‘å¸ƒè€…ï¼‰ä¸ä¼šå°†æ¶ˆæ¯ç›´æ¥å‘é€ç»™ç‰¹å®šçš„æ¥æ”¶è€…ï¼ˆè®¢é˜…è€…ï¼‰ï¼Œè€Œæ˜¯é€šè¿‡ä¸€ä¸ªä¸­é—´ä»¶ï¼ˆäº‹ä»¶ä¸­å¿ƒï¼‰è¿›è¡Œé€šä¿¡ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç±»æ¯”ï¼šæŠ¥çº¸è®¢é˜…ç³»ç»Ÿ</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">NewspaperSystem</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">subscribers</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(); <span class="hljs-comment">// äº‹ä»¶ä¸­å¿ƒ</span>
    }
    
    <span class="hljs-comment">// è®¢é˜…ï¼ˆè¯»è€…è®¢é˜…æŠ¥çº¸ï¼‰</span>
    <span class="hljs-title function_">subscribe</span>(<span class="hljs-params">topic, reader</span>) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">subscribers</span>.<span class="hljs-title function_">has</span>(topic)) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">subscribers</span>.<span class="hljs-title function_">set</span>(topic, []);
        }
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">subscribers</span>.<span class="hljs-title function_">get</span>(topic).<span class="hljs-title function_">push</span>(reader);
    }
    
    <span class="hljs-comment">// å‘å¸ƒï¼ˆæŠ¥ç¤¾å‘å¸ƒæ–°é—»ï¼‰</span>
    <span class="hljs-title function_">publish</span>(<span class="hljs-params">topic, news</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">subscribers</span>.<span class="hljs-title function_">has</span>(topic)) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">subscribers</span>.<span class="hljs-title function_">get</span>(topic).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">reader</span> =&gt;</span> <span class="hljs-title function_">reader</span>(news));
        }
    }
    
    <span class="hljs-comment">// å–æ¶ˆè®¢é˜…ï¼ˆè¯»è€…é€€è®¢ï¼‰</span>
    <span class="hljs-title function_">unsubscribe</span>(<span class="hljs-params">topic, reader</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">subscribers</span>.<span class="hljs-title function_">has</span>(topic)) {
            <span class="hljs-keyword">const</span> readers = <span class="hljs-variable language_">this</span>.<span class="hljs-property">subscribers</span>.<span class="hljs-title function_">get</span>(topic);
            <span class="hljs-keyword">const</span> index = readers.<span class="hljs-title function_">indexOf</span>(reader);
            <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
                readers.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
            }
        }
    }
}
</code></pre>
<h5 data-id="heading-3">1.2 æ ¸å¿ƒç»„ä»¶</h5>
<ol>
<li><strong>äº‹ä»¶ä¸­å¿ƒ(EventEmitter):</strong> å­˜å‚¨äº‹ä»¶å’Œå›è°ƒçš„å¯¹åº”å…³ç³»</li>
<li><strong>å‘å¸ƒè€…(Publisher):</strong> è§¦å‘äº‹ä»¶ï¼Œä¼ é€’æ•°æ®</li>
<li><strong>è®¢é˜…è€…(Subscriber):</strong> ç›‘å¬äº‹ä»¶ï¼Œå¤„ç†æ•°æ®</li>
</ol>
<h5 data-id="heading-4">1.3 ä¸è§‚å¯Ÿè€…æ¨¡å¼çš„å¯¹æ¯”</h5>






























<table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">è§‚å¯Ÿè€…æ¨¡å¼</th><th align="left">å‘å¸ƒè®¢é˜…æ¨¡å¼</th></tr></thead><tbody><tr><td align="left">è€¦åˆåº¦</td><td align="left">ç›´æ¥è€¦åˆ</td><td align="left">é€šè¿‡äº‹ä»¶ä¸­å¿ƒè§£è€¦</td></tr><tr><td align="left">é€šä¿¡æ–¹å¼</td><td align="left">ç›´æ¥è°ƒç”¨</td><td align="left">é—´æ¥é€šä¿¡</td></tr><tr><td align="left">çµæ´»æ€§</td><td align="left">è¾ƒä½</td><td align="left">æ›´é«˜</td></tr><tr><td align="left">å…¸å‹å®ç°</td><td align="left">Vueå“åº”å¼</td><td align="left">NodeJS EventEmitter</td></tr></tbody></table>
<h4 data-id="heading-5">äºŒã€åŸºç¡€ EventEmitter å®ç°</h4>
<h5 data-id="heading-6">2.1 æœ€å°å¯è¡Œå®ç°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">EventEmitter</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// å­˜å‚¨äº‹ä»¶å’Œå¯¹åº”çš„å›è°ƒå‡½æ•°</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
  }

  <span class="hljs-comment">/**
   * è®¢é˜…äº‹ä»¶
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} callback å›è°ƒå‡½æ•°
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Function</span>} å–æ¶ˆè®¢é˜…çš„å‡½æ•°
   */</span>
  <span class="hljs-title function_">on</span>(<span class="hljs-params">eventName, callback</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-title function_">has</span>(eventName)) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-title function_">set</span>(eventName, []);
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-title function_">get</span>(eventName).<span class="hljs-title function_">push</span>(callback);

    <span class="hljs-comment">// è¿”å›å–æ¶ˆè®¢é˜…çš„å‡½æ•°</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">off</span>(eventName, callback);
  }

  <span class="hljs-comment">/**
   * è§¦å‘äº‹ä»¶
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">...any</span>} args ä¼ é€’ç»™å›è°ƒå‡½æ•°çš„å‚æ•°
   */</span>
  <span class="hljs-title function_">emit</span>(<span class="hljs-params">eventName, ...args</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-title function_">has</span>(eventName)) {
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">const</span> callbacks = <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-title function_">get</span>(eventName);
    callbacks.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">callback</span>) =&gt;</span> {
      <span class="hljs-keyword">try</span> {
        callback.<span class="hljs-title function_">apply</span>(<span class="hljs-literal">null</span>, args);
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Error in event listener for <span class="hljs-subst">${eventName}</span>:`</span>, error);
      }
    });
  }

  <span class="hljs-comment">/**
   * å–æ¶ˆè®¢é˜…
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} callback è¦ç§»é™¤çš„å›è°ƒå‡½æ•°
   */</span>
  <span class="hljs-title function_">off</span>(<span class="hljs-params">eventName, callback</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-title function_">has</span>(eventName)) {
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">const</span> callbacks = <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-title function_">get</span>(eventName);
    <span class="hljs-keyword">const</span> index = callbacks.<span class="hljs-title function_">indexOf</span>(callback);

    <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
      callbacks.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);

      <span class="hljs-comment">// å¦‚æœæ²¡æœ‰å›è°ƒå‡½æ•°äº†, åˆ é™¤è¿™ä¸ªäº‹ä»¶</span>
      <span class="hljs-keyword">if</span> (callbacks.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-title function_">delete</span>(eventName);
      }
    }
  }

  <span class="hljs-comment">/**
   * ä¸€æ¬¡æ€§è®¢é˜…
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} callback å›è°ƒå‡½æ•°
   */</span>
  <span class="hljs-title function_">once</span>(<span class="hljs-params">eventName, callback</span>) {
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">onceCallback</span> = (<span class="hljs-params">...args</span>) =&gt; {
      callback.<span class="hljs-title function_">apply</span>(<span class="hljs-literal">null</span>, args);
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">off</span>(eventName, callback);
    };

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(eventName, onceCallback);
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">off</span>(eventName, onceCallback);
  }

  <span class="hljs-comment">/**
   * ç§»é™¤æ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨, æˆ–æŒ‡å®šäº‹ä»¶çš„æ‰€æœ‰ç›‘å¬å™¨
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName å¯é€‰, äº‹ä»¶åç§°
   */</span>
  <span class="hljs-title function_">removeAllListeners</span>(<span class="hljs-params">eventName</span>) {
    <span class="hljs-keyword">if</span> (eventName) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-title function_">delete</span>(eventName);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-title function_">clear</span>();
    }
  }
}

<span class="hljs-comment">// åŸºç¡€ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> emitter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventEmitter</span>();

<span class="hljs-comment">// è®¢é˜…äº‹ä»¶</span>
<span class="hljs-keyword">const</span> unsubscribe = emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">"message"</span>, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ”¶åˆ°æ¶ˆæ¯:"</span>, data);
});

<span class="hljs-comment">// è§¦å‘äº‹ä»¶</span>
emitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"message"</span>, <span class="hljs-string">"Hello World!"</span>); <span class="hljs-comment">// è¾“å‡º: æ”¶åˆ°æ¶ˆæ¯: Hello World!</span>

<span class="hljs-comment">// å–æ¶ˆè®¢é˜…</span>
<span class="hljs-title function_">unsubscribe</span>();

<span class="hljs-comment">// å†æ¬¡è§¦å‘ï¼Œä¸ä¼šæœ‰è¾“å‡º</span>
emitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"message"</span>, <span class="hljs-string">"Hello Again!"</span>);
</code></pre>
<h4 data-id="heading-7">ä¸‰ã€å®Œæ•´çš„ EventEmitter å®ç°</h4>
<h5 data-id="heading-8">3.1 æ”¯æŒæ›´å¤šç‰¹æ€§çš„å®Œæ•´å®ç°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">EventEmitter</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// ä½¿ç”¨ Object.create(null) é¿å…åŸå‹æ±¡æŸ“</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_maxListeners</span> = <span class="hljs-number">10</span>;
  }

  <span class="hljs-comment">// ================ æ ¸å¿ƒæ–¹æ³• ================</span>

  <span class="hljs-comment">/**
   * æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} listener ç›‘å¬å™¨å‡½æ•°
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">EventEmitter</span>} <span class="hljs-variable">this</span>
   */</span>
  <span class="hljs-title function_">on</span>(<span class="hljs-params">eventName, listener</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_addListener</span>(eventName, listener, <span class="hljs-literal">false</span>);
  }

  <span class="hljs-comment">/**
   * æ·»åŠ äº‹ä»¶ç›‘å¬å™¨ï¼ˆåˆ«åï¼‰
   */</span>
  <span class="hljs-title function_">addListener</span>(<span class="hljs-params">eventName, listener</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(eventName, listener);
  }

  <span class="hljs-comment">/**
   * æ·»åŠ ä¸€æ¬¡æ€§äº‹ä»¶ç›‘å¬å™¨
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} listener ç›‘å¬å™¨å‡½æ•°
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">EventEmitter</span>} <span class="hljs-variable">this</span>
   */</span>
  <span class="hljs-title function_">once</span>(<span class="hljs-params">eventName, listener</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_addListener</span>(eventName, listener, <span class="hljs-literal">true</span>);
  }

  <span class="hljs-comment">/**
   * è§¦å‘äº‹ä»¶
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">...any</span>} args ä¼ é€’ç»™ç›‘å¬å™¨çš„å‚æ•°
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">boolean</span>} æ˜¯å¦æœ‰ç›‘å¬å™¨è¢«è°ƒç”¨
   */</span>
  <span class="hljs-title function_">emit</span>(<span class="hljs-params">eventName, ...args</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName]) {
      <span class="hljs-comment">// å¦‚æœæ²¡æœ‰ error äº‹ä»¶çš„ç›‘å¬å™¨ï¼ŒæŠ›å‡ºé”™è¯¯</span>
      <span class="hljs-keyword">if</span> (eventName === <span class="hljs-string">"error"</span>) {
        <span class="hljs-keyword">const</span> error = args[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">if</span> (error <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Error</span>) {
          <span class="hljs-keyword">throw</span> error;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Unhandled error event"</span>);
        }
      }
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
    <span class="hljs-keyword">const</span> listenersCopy = listeners.<span class="hljs-title function_">slice</span>(); <span class="hljs-comment">// åˆ›å»ºå‰¯æœ¬é¿å…è¿­ä»£æ—¶ä¿®æ”¹</span>

    <span class="hljs-keyword">let</span> called = <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> listener <span class="hljs-keyword">of</span> listenersCopy) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦ä¸º once åŒ…è£…å‡½æ•°</span>
        <span class="hljs-keyword">if</span> (listener.<span class="hljs-property">_once</span>) {
          <span class="hljs-comment">// ç§»é™¤åŸå§‹ç›‘å¬å™¨</span>
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_removeListener</span>(eventName, listener);
        }

        listener.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
        called = <span class="hljs-literal">true</span>;
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-comment">// è§¦å‘é”™è¯¯äº‹ä»¶</span>
        <span class="hljs-keyword">if</span> (eventName !== <span class="hljs-string">"error"</span>) {
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"error"</span>, error);
        }
      }
    }

    <span class="hljs-keyword">return</span> called;
  }

  <span class="hljs-comment">/**
   * ç§»é™¤äº‹ä»¶ç›‘å¬å™¨
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} listener è¦ç§»é™¤çš„ç›‘å¬å™¨
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">EventEmitter</span>} <span class="hljs-variable">this</span>
   */</span>
  <span class="hljs-title function_">off</span>(<span class="hljs-params">eventName, listener</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeListener</span>(eventName, listener);
  }

  <span class="hljs-comment">/**
   * ç§»é™¤äº‹ä»¶ç›‘å¬å™¨
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} listener è¦ç§»é™¤çš„ç›‘å¬å™¨
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">EventEmitter</span>} <span class="hljs-variable">this</span>
   */</span>
  <span class="hljs-title function_">removeListener</span>(<span class="hljs-params">eventName, listener</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_removeListener</span>(eventName, listener);
  }

  <span class="hljs-comment">/**
   * ç§»é™¤æ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} [eventName] å¯é€‰ï¼Œäº‹ä»¶åç§°
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">EventEmitter</span>} <span class="hljs-variable">this</span>
   */</span>
  <span class="hljs-title function_">removeAllListeners</span>(<span class="hljs-params">eventName</span>) {
    <span class="hljs-keyword">if</span> (eventName) {
      <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-comment">// ================ è¾…åŠ©æ–¹æ³• ================</span>

  <span class="hljs-comment">/**
   * è®¾ç½®æœ€å¤§ç›‘å¬å™¨æ•°é‡
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} n æœ€å¤§ç›‘å¬å™¨æ•°é‡
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">EventEmitter</span>} <span class="hljs-variable">this</span>
   */</span>
  <span class="hljs-title function_">setMaxListeners</span>(<span class="hljs-params">n</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> n !== <span class="hljs-string">"number"</span> || n &lt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">"n must be a non-negative number"</span>);
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_maxListeners</span> = n;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-comment">/**
   * è·å–æœ€å¤§ç›‘å¬å™¨æ•°é‡
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number</span>} æœ€å¤§ç›‘å¬å™¨æ•°é‡
   */</span>
  <span class="hljs-title function_">getMaxListeners</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_maxListeners</span>;
  }

  <span class="hljs-comment">/**
   * è·å–æŒ‡å®šäº‹ä»¶çš„ç›‘å¬å™¨æ•°é‡
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number</span>} ç›‘å¬å™¨æ•°é‡
   */</span>
  <span class="hljs-title function_">listenerCount</span>(<span class="hljs-params">eventName</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName]) {
      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName].<span class="hljs-property">length</span>;
  }

  <span class="hljs-comment">/**
   * è·å–æ‰€æœ‰äº‹ä»¶åç§°
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">string[]</span>} äº‹ä»¶åç§°æ•°ç»„
   */</span>
  <span class="hljs-title function_">eventNames</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>);
  }

  <span class="hljs-comment">/**
   * è·å–æŒ‡å®šäº‹ä»¶çš„æ‰€æœ‰ç›‘å¬å™¨
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Function[]</span>} ç›‘å¬å™¨æ•°ç»„
   */</span>
  <span class="hljs-title function_">listeners</span>(<span class="hljs-params">eventName</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName]) {
      <span class="hljs-keyword">return</span> [];
    }
    <span class="hljs-comment">// è¿”å›å‰¯æœ¬ï¼Œé¿å…å¤–éƒ¨ä¿®æ”¹å†…éƒ¨æ•°ç»„</span>
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName].<span class="hljs-title function_">slice</span>();
  }

  <span class="hljs-comment">/**
   * æ·»åŠ ç›‘å¬å™¨åˆ°æ•°ç»„å¼€å¤´
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} listener ç›‘å¬å™¨å‡½æ•°
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">EventEmitter</span>} <span class="hljs-variable">this</span>
   */</span>
  <span class="hljs-title function_">prependListener</span>(<span class="hljs-params">eventName, listener</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_addListener</span>(eventName, listener, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>);
  }

  <span class="hljs-comment">/**
   * æ·»åŠ ä¸€æ¬¡æ€§ç›‘å¬å™¨åˆ°æ•°ç»„å¼€å¤´
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} eventName äº‹ä»¶åç§°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} listener ç›‘å¬å™¨å‡½æ•°
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">EventEmitter</span>} <span class="hljs-variable">this</span>
   */</span>
  <span class="hljs-title function_">prependOnceListener</span>(<span class="hljs-params">eventName, listener</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_addListener</span>(eventName, listener, <span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>);
  }

  <span class="hljs-comment">/**
   * å†…éƒ¨æ–¹æ³•ï¼šæ·»åŠ ç›‘å¬å™¨
   * <span class="hljs-doctag">@private</span>
   */</span>
  <span class="hljs-title function_">_addListener</span>(<span class="hljs-params">eventName, listener, once = <span class="hljs-literal">false</span>, prepend = <span class="hljs-literal">false</span></span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> listener !== <span class="hljs-string">"function"</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">"listener must be a function"</span>);
    }

    <span class="hljs-comment">// åˆå§‹åŒ–äº‹ä»¶æ•°ç»„</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName]) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName] = [];
    }

    <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];

    <span class="hljs-comment">// æ£€æŸ¥æœ€å¤§ç›‘å¬å™¨é™åˆ¶</span>
    <span class="hljs-keyword">if</span> (listeners.<span class="hljs-property">length</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">_maxListeners</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">_maxListeners</span> !== <span class="hljs-number">0</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(
        <span class="hljs-string">`MaxListenersExceededWarning: Possible EventEmitter memory leak detected. `</span> +
          <span class="hljs-string">`<span class="hljs-subst">${listeners.length}</span> <span class="hljs-subst">${eventName}</span> listeners added. `</span> +
          <span class="hljs-string">`Use emitter.setMaxListeners() to increase limit`</span>
      );
    }

    <span class="hljs-comment">// å¦‚æœæ˜¯ onceï¼Œåˆ›å»ºåŒ…è£…å‡½æ•°</span>
    <span class="hljs-keyword">let</span> listenerToAdd = listener;
    <span class="hljs-keyword">if</span> (once) {
      <span class="hljs-keyword">const</span> <span class="hljs-title function_">onceWrapper</span> = (<span class="hljs-params">...args</span>) =&gt; {
        listener.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
        <span class="hljs-comment">// æ ‡è®°ä¸º once åŒ…è£…å‡½æ•°</span>
        onceWrapper.<span class="hljs-property">_once</span> = <span class="hljs-literal">true</span>;
      };
      <span class="hljs-comment">// ä¿å­˜åŸå§‹ç›‘å¬å™¨å¼•ç”¨ï¼Œç”¨äºç§»é™¤</span>
      onceWrapper.<span class="hljs-property">_originalListener</span> = listener;
      listenerToAdd = onceWrapper;
    }

    <span class="hljs-comment">// æ·»åŠ åˆ°æ•°ç»„å¼€å¤´æˆ–ç»“å°¾</span>
    <span class="hljs-keyword">if</span> (prepend) {
      listeners.<span class="hljs-title function_">unshift</span>(listenerToAdd);
    } <span class="hljs-keyword">else</span> {
      listeners.<span class="hljs-title function_">push</span>(listenerToAdd);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-comment">/**
   * å†…éƒ¨æ–¹æ³•ï¼šç§»é™¤ç›‘å¬å™¨
   * <span class="hljs-doctag">@private</span>
   */</span>
  <span class="hljs-title function_">_removeListener</span>(<span class="hljs-params">eventName, listener</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName]) {
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }

    <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];

    <span class="hljs-comment">// æŸ¥æ‰¾è¦ç§»é™¤çš„ç›‘å¬å™¨</span>
    <span class="hljs-comment">// éœ€è¦è€ƒè™‘ä¸¤ç§æƒ…å†µï¼š</span>
    <span class="hljs-comment">// 1. ç›´æ¥ä¼ å…¥ç›‘å¬å™¨</span>
    <span class="hljs-comment">// 2. ä¼ å…¥ once åŒ…è£…å‡½æ•°çš„åŸå§‹ç›‘å¬å™¨</span>
    <span class="hljs-keyword">let</span> index = -<span class="hljs-number">1</span>;

    <span class="hljs-comment">// å°è¯•ç›´æ¥æŸ¥æ‰¾</span>
    index = listeners.<span class="hljs-title function_">indexOf</span>(listener);

    <span class="hljs-comment">// å¦‚æœæ²¡æ‰¾åˆ°ï¼Œå°è¯•æŸ¥æ‰¾åŸå§‹ç›‘å¬å™¨</span>
    <span class="hljs-keyword">if</span> (index === -<span class="hljs-number">1</span>) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; listeners.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-keyword">const</span> current = listeners[i];
        <span class="hljs-keyword">if</span> (current.<span class="hljs-property">_originalListener</span> === listener) {
          index = i;
          <span class="hljs-keyword">break</span>;
        }
      }
    }

    <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
      listeners.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);

      <span class="hljs-comment">// å¦‚æœæ•°ç»„ä¸ºç©ºï¼Œåˆ é™¤äº‹ä»¶</span>
      <span class="hljs-keyword">if</span> (listeners.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
      }
    }

    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }
}
</code></pre>
<h5 data-id="heading-9">3.2 ç±»å‹å®‰å…¨çš„TypeScriptç‰ˆæœ¬</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Listener</span> = <span class="hljs-function">(<span class="hljs-params">...args: <span class="hljs-built_in">any</span>[]</span>) =&gt;</span> <span class="hljs-built_in">void</span>;
<span class="hljs-keyword">type</span> <span class="hljs-title class_">OnceWrapper</span> = <span class="hljs-title class_">Listener</span> &amp; { _originalListener?: <span class="hljs-title class_">Listener</span>; _once?: <span class="hljs-built_in">boolean</span> };

<span class="hljs-keyword">class</span> <span class="hljs-title class_">EventEmitter</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-attr">_events</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">Listener</span>[]&gt; = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);
    <span class="hljs-keyword">private</span> <span class="hljs-attr">_maxListeners</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">10</span>;
    
    <span class="hljs-comment">// æ ¸å¿ƒæ–¹æ³•</span>
    <span class="hljs-title function_">on</span>(<span class="hljs-attr">eventName</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">listener</span>: <span class="hljs-title class_">Listener</span>): <span class="hljs-variable language_">this</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_addListener</span>(eventName, listener, <span class="hljs-literal">false</span>);
    }
    
    <span class="hljs-title function_">addListener</span>(<span class="hljs-attr">eventName</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">listener</span>: <span class="hljs-title class_">Listener</span>): <span class="hljs-variable language_">this</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(eventName, listener);
    }
    
    <span class="hljs-title function_">once</span>(<span class="hljs-attr">eventName</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">listener</span>: <span class="hljs-title class_">Listener</span>): <span class="hljs-variable language_">this</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_addListener</span>(eventName, listener, <span class="hljs-literal">true</span>);
    }
    
    <span class="hljs-title function_">emit</span>(<span class="hljs-attr">eventName</span>: <span class="hljs-built_in">string</span>, ...<span class="hljs-attr">args</span>: <span class="hljs-built_in">any</span>[]): <span class="hljs-built_in">boolean</span> {
        <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
        <span class="hljs-keyword">if</span> (!listeners) {
            <span class="hljs-keyword">if</span> (eventName === <span class="hljs-string">'error'</span>) {
                <span class="hljs-keyword">const</span> error = args[<span class="hljs-number">0</span>];
                <span class="hljs-keyword">throw</span> error <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Error</span> ? error : <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Unhandled error event'</span>);
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
        
        <span class="hljs-keyword">const</span> listenersCopy = listeners.<span class="hljs-title function_">slice</span>();
        <span class="hljs-keyword">let</span> called = <span class="hljs-literal">false</span>;
        
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> listener <span class="hljs-keyword">of</span> listenersCopy) {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦ä¸º once åŒ…è£…å‡½æ•°</span>
                <span class="hljs-keyword">const</span> onceWrapper = listener <span class="hljs-keyword">as</span> <span class="hljs-title class_">OnceWrapper</span>;
                <span class="hljs-keyword">if</span> (onceWrapper.<span class="hljs-property">_once</span>) {
                    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_removeListener</span>(eventName, listener);
                }
                
                listener.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
                called = <span class="hljs-literal">true</span>;
            } <span class="hljs-keyword">catch</span> (error) {
                <span class="hljs-keyword">if</span> (eventName !== <span class="hljs-string">'error'</span>) {
                    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'error'</span>, error);
                }
            }
        }
        
        <span class="hljs-keyword">return</span> called;
    }
    
    <span class="hljs-title function_">off</span>(<span class="hljs-attr">eventName</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">listener</span>: <span class="hljs-title class_">Listener</span>): <span class="hljs-variable language_">this</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeListener</span>(eventName, listener);
    }
    
    <span class="hljs-title function_">removeListener</span>(<span class="hljs-attr">eventName</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">listener</span>: <span class="hljs-title class_">Listener</span>): <span class="hljs-variable language_">this</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_removeListener</span>(eventName, listener);
    }
    
    <span class="hljs-title function_">removeAllListeners</span>(eventName?: <span class="hljs-built_in">string</span>): <span class="hljs-variable language_">this</span> {
        <span class="hljs-keyword">if</span> (eventName) {
            <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
    
    <span class="hljs-comment">// è¾…åŠ©æ–¹æ³•</span>
    <span class="hljs-title function_">setMaxListeners</span>(<span class="hljs-attr">n</span>: <span class="hljs-built_in">number</span>): <span class="hljs-variable language_">this</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> n !== <span class="hljs-string">'number'</span> || n &lt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">'n must be a non-negative number'</span>);
        }
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_maxListeners</span> = n;
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
    
    <span class="hljs-title function_">getMaxListeners</span>(): <span class="hljs-built_in">number</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_maxListeners</span>;
    }
    
    <span class="hljs-title function_">listenerCount</span>(<span class="hljs-attr">eventName</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">number</span> {
        <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
        <span class="hljs-keyword">return</span> listeners ? listeners.<span class="hljs-property">length</span> : <span class="hljs-number">0</span>;
    }
    
    <span class="hljs-title function_">eventNames</span>(): <span class="hljs-built_in">string</span>[] {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>);
    }
    
    <span class="hljs-title function_">listeners</span>(<span class="hljs-attr">eventName</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Listener</span>[] {
        <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
        <span class="hljs-keyword">return</span> listeners ? listeners.<span class="hljs-title function_">slice</span>() : [];
    }
    
    <span class="hljs-title function_">prependListener</span>(<span class="hljs-attr">eventName</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">listener</span>: <span class="hljs-title class_">Listener</span>): <span class="hljs-variable language_">this</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_addListener</span>(eventName, listener, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>);
    }
    
    <span class="hljs-title function_">prependOnceListener</span>(<span class="hljs-attr">eventName</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">listener</span>: <span class="hljs-title class_">Listener</span>): <span class="hljs-variable language_">this</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_addListener</span>(eventName, listener, <span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>);
    }
    
    <span class="hljs-comment">// ç§æœ‰æ–¹æ³•</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title function_">_addListener</span>(<span class="hljs-attr">eventName</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">listener</span>: <span class="hljs-title class_">Listener</span>, <span class="hljs-attr">once</span>: <span class="hljs-built_in">boolean</span>, <span class="hljs-attr">prepend</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>): <span class="hljs-variable language_">this</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> listener !== <span class="hljs-string">'function'</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">'listener must be a function'</span>);
        }
        
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName]) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName] = [];
        }
        
        <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
        
        <span class="hljs-comment">// æ£€æŸ¥æœ€å¤§ç›‘å¬å™¨é™åˆ¶</span>
        <span class="hljs-keyword">if</span> (listeners.<span class="hljs-property">length</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">_maxListeners</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">_maxListeners</span> !== <span class="hljs-number">0</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">`MaxListenersExceededWarning for event <span class="hljs-subst">${eventName}</span>`</span>);
        }
        
        <span class="hljs-keyword">let</span> <span class="hljs-attr">listenerToAdd</span>: <span class="hljs-title class_">Listener</span> = listener;
        
        <span class="hljs-keyword">if</span> (once) {
            <span class="hljs-keyword">const</span> <span class="hljs-attr">onceWrapper</span>: <span class="hljs-title class_">OnceWrapper</span> = <span class="hljs-function">(<span class="hljs-params">...args: <span class="hljs-built_in">any</span>[]</span>) =&gt;</span> {
                listener.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
                onceWrapper.<span class="hljs-property">_once</span> = <span class="hljs-literal">true</span>;
            };
            onceWrapper.<span class="hljs-property">_originalListener</span> = listener;
            listenerToAdd = onceWrapper;
        }
        
        <span class="hljs-keyword">if</span> (prepend) {
            listeners.<span class="hljs-title function_">unshift</span>(listenerToAdd);
        } <span class="hljs-keyword">else</span> {
            listeners.<span class="hljs-title function_">push</span>(listenerToAdd);
        }
        
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-title function_">_removeListener</span>(<span class="hljs-attr">eventName</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">listener</span>: <span class="hljs-title class_">Listener</span>): <span class="hljs-variable language_">this</span> {
        <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
        <span class="hljs-keyword">if</span> (!listeners) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
        
        <span class="hljs-keyword">let</span> index = listeners.<span class="hljs-title function_">indexOf</span>(listener);
        
        <span class="hljs-comment">// å¦‚æœæ²¡æ‰¾åˆ°ï¼Œå°è¯•æŸ¥æ‰¾åŸå§‹ç›‘å¬å™¨</span>
        <span class="hljs-keyword">if</span> (index === -<span class="hljs-number">1</span>) {
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; listeners.<span class="hljs-property">length</span>; i++) {
                <span class="hljs-keyword">const</span> current = listeners[i] <span class="hljs-keyword">as</span> <span class="hljs-title class_">OnceWrapper</span>;
                <span class="hljs-keyword">if</span> (current.<span class="hljs-property">_originalListener</span> === listener) {
                    index = i;
                    <span class="hljs-keyword">break</span>;
                }
            }
        }
        
        <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
            listeners.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
            <span class="hljs-keyword">if</span> (listeners.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
            }
        }
        
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
}
</code></pre>
<h4 data-id="heading-10">å››ã€æµ‹è¯•ç”¨ä¾‹</h4>
<h5 data-id="heading-11">4.1 åŸºç¡€åŠŸèƒ½æµ‹è¯•</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"=== EventEmitter åŸºç¡€åŠŸèƒ½æµ‹è¯• ==="</span>);

<span class="hljs-keyword">const</span> emitter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventEmitter</span>();

<span class="hljs-comment">// æµ‹è¯•1: åŸºæœ¬è®¢é˜…å’Œè§¦å‘</span>
<span class="hljs-keyword">let</span> test1Count = <span class="hljs-number">0</span>;
emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">"test1"</span>, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•1 - æ”¶åˆ°æ•°æ®:"</span>, data);
  test1Count++;
});

emitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"test1"</span>, <span class="hljs-string">"Hello"</span>); <span class="hljs-comment">// æµ‹è¯•1 - æ”¶åˆ°æ•°æ®: Hello</span>
emitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"test1"</span>, <span class="hljs-string">"World"</span>); <span class="hljs-comment">// æµ‹è¯•1 - æ”¶åˆ°æ•°æ®: World</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•1 - è°ƒç”¨æ¬¡æ•°: <span class="hljs-subst">${test1Count}</span>`</span>); <span class="hljs-comment">// æµ‹è¯•1 - è°ƒç”¨æ¬¡æ•°: 2</span>

<span class="hljs-comment">// æµ‹è¯•2: å¤šä¸ªç›‘å¬å™¨</span>
<span class="hljs-keyword">let</span> test2Result = [];
emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">"test2"</span>, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
  test2Result.<span class="hljs-title function_">push</span>(<span class="hljs-string">`listener1: <span class="hljs-subst">${data}</span>`</span>);
});
emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">"test2"</span>, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
  test2Result.<span class="hljs-title function_">push</span>(<span class="hljs-string">`listener2: <span class="hljs-subst">${data.toUpperCase()}</span>`</span>);
});

emitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"test2"</span>, <span class="hljs-string">"hello"</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•2 - å¤šä¸ªç›‘å¬å™¨:"</span>, test2Result); <span class="hljs-comment">// æµ‹è¯•2 - å¤šä¸ªç›‘å¬å™¨: [ 'listener1: hello', 'listener2: HELLO' ]</span>

<span class="hljs-comment">// æµ‹è¯•3: å–æ¶ˆè®¢é˜…</span>
<span class="hljs-keyword">let</span> test3Count = <span class="hljs-number">0</span>;
<span class="hljs-keyword">const</span> <span class="hljs-title function_">test3Listener</span> = (<span class="hljs-params"/>) =&gt; {
  test3Count++;
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•3 - ç›‘å¬å™¨è¢«è°ƒç”¨"</span>);
};

emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">"test3"</span>, test3Listener);
emitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"test3"</span>); <span class="hljs-comment">// æµ‹è¯•3 - ç›‘å¬å™¨è¢«è°ƒç”¨</span>
emitter.<span class="hljs-title function_">off</span>(<span class="hljs-string">"test3"</span>, test3Listener);
emitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"test3"</span>); <span class="hljs-comment">// ä¸è°ƒç”¨</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•3 - æœ€ç»ˆè°ƒç”¨æ¬¡æ•°: <span class="hljs-subst">${test3Count}</span>`</span>); <span class="hljs-comment">// æµ‹è¯•3 - æœ€ç»ˆè°ƒç”¨æ¬¡æ•°: 1</span>

<span class="hljs-comment">// æµ‹è¯•4: once æ–¹æ³•</span>
<span class="hljs-keyword">let</span> test4Count = <span class="hljs-number">0</span>;
emitter.<span class="hljs-title function_">once</span>(<span class="hljs-string">"test4"</span>, <span class="hljs-function">() =&gt;</span> {
  test4Count++;
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•4 - once ç›‘å¬å™¨è¢«è°ƒç”¨"</span>);
});

emitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"test4"</span>); <span class="hljs-comment">// æµ‹è¯•4 - once ç›‘å¬å™¨è¢«è°ƒç”¨</span>
emitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"test4"</span>); <span class="hljs-comment">// æµ‹è¯•4 - once ç›‘å¬å™¨è¢«è°ƒç”¨</span>
emitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"test4"</span>); <span class="hljs-comment">// ä¸è°ƒç”¨</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•4 - once è°ƒç”¨æ¬¡æ•°: <span class="hljs-subst">${test4Count}</span>`</span>); <span class="hljs-comment">// æµ‹è¯•4 - once è°ƒç”¨æ¬¡æ•°: 2</span>

<span class="hljs-comment">// æµ‹è¯•5: é”™è¯¯å¤„ç†</span>
<span class="hljs-keyword">let</span> errorCaught = <span class="hljs-literal">false</span>;
emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">"error"</span>, <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
  errorCaught = <span class="hljs-literal">true</span>;
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•5 - æ•è·åˆ°é”™è¯¯:"</span>, error.<span class="hljs-property">message</span>);
});

emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">"test5"</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"æµ‹è¯•é”™è¯¯"</span>); <span class="hljs-comment">// æµ‹è¯•5 - æ•è·åˆ°é”™è¯¯: æµ‹è¯•é”™è¯¯</span>
});

emitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"test5"</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•5 - é”™è¯¯æ˜¯å¦è¢«æ•è·: <span class="hljs-subst">${errorCaught}</span>`</span>); <span class="hljs-comment">// æµ‹è¯•5 - é”™è¯¯æ˜¯å¦è¢«æ•è·: true</span>
</code></pre>
<h5 data-id="heading-12">4.2 é«˜çº§åŠŸèƒ½æµ‹è¯•</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"\n=== EventEmitter é«˜çº§åŠŸèƒ½æµ‹è¯• ==="</span>);

<span class="hljs-keyword">const</span> emitter2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventEmitter</span>();

<span class="hljs-comment">// æµ‹è¯•6: prependListener æ–¹æ³•</span>
<span class="hljs-keyword">let</span> test6Order = [];
emitter2.<span class="hljs-title function_">on</span>(<span class="hljs-string">"test6"</span>, <span class="hljs-function">() =&gt;</span> test6Order.<span class="hljs-title function_">push</span>(<span class="hljs-string">"normal1"</span>));
emitter2.<span class="hljs-title function_">on</span>(<span class="hljs-string">"test6"</span>, <span class="hljs-function">() =&gt;</span> test6Order.<span class="hljs-title function_">push</span>(<span class="hljs-string">"normal2"</span>));
emitter2.<span class="hljs-title function_">prependListener</span>(<span class="hljs-string">"test6"</span>, <span class="hljs-function">() =&gt;</span> test6Order.<span class="hljs-title function_">push</span>(<span class="hljs-string">"prepended"</span>));

emitter2.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"test6"</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•6 - ç›‘å¬å™¨é¡ºåº:"</span>, test6Order);
<span class="hljs-comment">// æµ‹è¯•6 - ç›‘å¬å™¨é¡ºåº: [ 'prepended', 'normal1', 'normal2' ]</span>

<span class="hljs-comment">// æµ‹è¯•7: æœ€å¤§ç›‘å¬å™¨é™åˆ¶</span>
emitter2.<span class="hljs-title function_">setMaxListeners</span>(<span class="hljs-number">2</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•7 - æœ€å¤§ç›‘å¬å™¨æ•°: <span class="hljs-subst">${emitter2.getMaxListeners()}</span>`</span>); <span class="hljs-comment">// æµ‹è¯•7 - æœ€å¤§ç›‘å¬å™¨æ•°: 2</span>

emitter2.<span class="hljs-title function_">on</span>(<span class="hljs-string">"test7"</span>, <span class="hljs-function">() =&gt;</span> {});
emitter2.<span class="hljs-title function_">on</span>(<span class="hljs-string">"test7"</span>, <span class="hljs-function">() =&gt;</span> {});
<span class="hljs-comment">// ç¬¬ä¸‰ä¸ªåº”è¯¥è§¦å‘è­¦å‘Š</span>
emitter2.<span class="hljs-title function_">on</span>(<span class="hljs-string">"test7"</span>, <span class="hljs-function">() =&gt;</span> {});

<span class="hljs-comment">// æµ‹è¯•8: è·å–ç›‘å¬å™¨ä¿¡æ¯</span>
emitter2.<span class="hljs-title function_">on</span>(<span class="hljs-string">"test8"</span>, <span class="hljs-function">() =&gt;</span> {});
emitter2.<span class="hljs-title function_">on</span>(<span class="hljs-string">"test8"</span>, <span class="hljs-function">() =&gt;</span> {});
emitter2.<span class="hljs-title function_">once</span>(<span class="hljs-string">"test8"</span>, <span class="hljs-function">() =&gt;</span> {});

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•8 - ç›‘å¬å™¨æ•°é‡: <span class="hljs-subst">${emitter2.listenerCount(<span class="hljs-string">"test8"</span>)}</span>`</span>); <span class="hljs-comment">// 3</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•8 - ç›‘å¬å™¨æ•°ç»„é•¿åº¦: <span class="hljs-subst">${emitter2.listeners(<span class="hljs-string">"test8"</span>).length}</span>`</span>); <span class="hljs-comment">// 3</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•8 - äº‹ä»¶åç§°: <span class="hljs-subst">${emitter2.eventNames()}</span>`</span>); <span class="hljs-comment">// ['test6', 'test7', 'test8']</span>

<span class="hljs-comment">// æµ‹è¯•9: removeAllListeners</span>
emitter2.<span class="hljs-title function_">removeAllListeners</span>(<span class="hljs-string">"test8"</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•9 - ç§»é™¤åç›‘å¬å™¨æ•°é‡: <span class="hljs-subst">${emitter2.listenerCount(<span class="hljs-string">"test8"</span>)}</span>`</span>); <span class="hljs-comment">// 0</span>

<span class="hljs-comment">// æµ‹è¯•10: é“¾å¼è°ƒç”¨</span>
emitter2
  .<span class="hljs-title function_">on</span>(<span class="hljs-string">"test10"</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•10 - é“¾å¼è°ƒç”¨1"</span>))
  .<span class="hljs-title function_">on</span>(<span class="hljs-string">"test10"</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµ‹è¯•10 - é“¾å¼è°ƒç”¨2"</span>))
  .<span class="hljs-title function_">emit</span>(<span class="hljs-string">"test10"</span>);
</code></pre>
<h5 data-id="heading-13">4.3 è¾¹ç•Œæƒ…å†µæµ‹è¯•</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'\n=== EventEmitter è¾¹ç•Œæƒ…å†µæµ‹è¯• ==='</span>);

<span class="hljs-keyword">const</span> emitter3 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventEmitter</span>();

<span class="hljs-comment">// æµ‹è¯•11: é‡å¤æ·»åŠ ç›¸åŒç›‘å¬å™¨</span>
<span class="hljs-keyword">let</span> test11Count = <span class="hljs-number">0</span>;
<span class="hljs-keyword">const</span> <span class="hljs-title function_">test11Listener</span> = (<span class="hljs-params"/>) =&gt; test11Count++;

emitter3.<span class="hljs-title function_">on</span>(<span class="hljs-string">'test11'</span>, test11Listener);
emitter3.<span class="hljs-title function_">on</span>(<span class="hljs-string">'test11'</span>, test11Listener); <span class="hljs-comment">// é‡å¤æ·»åŠ </span>

emitter3.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'test11'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•11 - é‡å¤ç›‘å¬å™¨è°ƒç”¨æ¬¡æ•°: <span class="hljs-subst">${test11Count}</span>`</span>); <span class="hljs-comment">// 2</span>

<span class="hljs-comment">// æµ‹è¯•12: ç§»é™¤ä¸å­˜åœ¨çš„ç›‘å¬å™¨</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">fakeListener</span> = (<span class="hljs-params"/>) =&gt; {};
emitter3.<span class="hljs-title function_">off</span>(<span class="hljs-string">'nonexistent'</span>, fakeListener); <span class="hljs-comment">// åº”è¯¥ä¸æŠ¥é”™</span>

<span class="hljs-comment">// æµ‹è¯•13: è§¦å‘æ²¡æœ‰ç›‘å¬å™¨çš„äº‹ä»¶</span>
<span class="hljs-keyword">const</span> result = emitter3.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'nonexistent'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•13 - è§¦å‘æ— ç›‘å¬å™¨äº‹ä»¶è¿”å›å€¼: <span class="hljs-subst">${result}</span>`</span>); <span class="hljs-comment">// false</span>

<span class="hljs-comment">// æµ‹è¯•14: é”™è¯¯äº‹ä»¶å¤„ç†</span>
<span class="hljs-keyword">try</span> {
    emitter3.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'error'</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'æœªå¤„ç†çš„é”™è¯¯'</span>));
} <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•14 - æ•è·æœªå¤„ç†çš„é”™è¯¯: <span class="hljs-subst">${error.message}</span>`</span>);
}

<span class="hljs-comment">// æµ‹è¯•15: once ç›‘å¬å™¨ç§»é™¤åå†æ¬¡è§¦å‘</span>
<span class="hljs-keyword">let</span> test15Count = <span class="hljs-number">0</span>;
<span class="hljs-keyword">const</span> <span class="hljs-title function_">test15Listener</span> = (<span class="hljs-params"/>) =&gt; {
    test15Count++;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•15 - ç¬¬ <span class="hljs-subst">${test15Count}</span> æ¬¡è°ƒç”¨`</span>);
};

<span class="hljs-keyword">const</span> removeOnce = emitter3.<span class="hljs-title function_">once</span>(<span class="hljs-string">'test15'</span>, test15Listener);
emitter3.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'test15'</span>); <span class="hljs-comment">// è°ƒç”¨</span>
<span class="hljs-title function_">removeOnce</span>(); <span class="hljs-comment">// æ‰‹åŠ¨ç§»é™¤</span>
emitter3.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'test15'</span>); <span class="hljs-comment">// ä¸è°ƒç”¨</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•15 - æœ€ç»ˆè°ƒç”¨æ¬¡æ•°: <span class="hljs-subst">${test15Count}</span>`</span>); <span class="hljs-comment">// 1</span>
</code></pre>
<h5 data-id="heading-14">4.4 æ€§èƒ½æµ‹è¯•</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'\n=== EventEmitter æ€§èƒ½æµ‹è¯• ==='</span>);

<span class="hljs-keyword">const</span> performanceEmitter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventEmitter</span>();
<span class="hljs-keyword">const</span> iterations = <span class="hljs-number">100000</span>;

<span class="hljs-comment">// å‡†å¤‡æµ‹è¯•æ•°æ®</span>
<span class="hljs-keyword">const</span> listeners = [];
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {
    listeners.<span class="hljs-title function_">push</span>(<span class="hljs-function">() =&gt;</span> {});
}

<span class="hljs-comment">// æµ‹è¯•æ·»åŠ ç›‘å¬å™¨çš„æ€§èƒ½</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'æ·»åŠ ç›‘å¬å™¨'</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; iterations; i++) {
    performanceEmitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'performance'</span>, listeners[i % listeners.<span class="hljs-property">length</span>]);
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'æ·»åŠ ç›‘å¬å™¨'</span>);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ·»åŠ åç›‘å¬å™¨æ•°é‡: <span class="hljs-subst">${performanceEmitter.listenerCount(<span class="hljs-string">'performance'</span>)}</span>`</span>);

<span class="hljs-comment">// æµ‹è¯•è§¦å‘äº‹ä»¶çš„æ€§èƒ½</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'è§¦å‘äº‹ä»¶'</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; iterations; i++) {
    performanceEmitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'performance'</span>, i);
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'è§¦å‘äº‹ä»¶'</span>);

<span class="hljs-comment">// æµ‹è¯•ç§»é™¤ç›‘å¬å™¨çš„æ€§èƒ½</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'ç§»é™¤ç›‘å¬å™¨'</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; iterations; i++) {
    performanceEmitter.<span class="hljs-title function_">off</span>(<span class="hljs-string">'performance'</span>, listeners[i % listeners.<span class="hljs-property">length</span>]);
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'ç§»é™¤ç›‘å¬å™¨'</span>);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ç§»é™¤åç›‘å¬å™¨æ•°é‡: <span class="hljs-subst">${performanceEmitter.listenerCount(<span class="hljs-string">'performance'</span>)}</span>`</span>);
</code></pre>
<h4 data-id="heading-15">äº”ã€EventEmitterçš„æ ¸å¿ƒåŸç†åˆ†æ</h4>
<h5 data-id="heading-16">51 æ•°æ®ç»“æ„è®¾è®¡</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// EventEmitter çš„æ ¸å¿ƒæ•°æ®ç»“æ„</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">EventEmitter</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// ä½¿ç”¨æ™®é€šå¯¹è±¡è€Œä¸æ˜¯ Map çš„åŸå› ï¼š</span>
        <span class="hljs-comment">// 1. åœ¨ V8 ä¸­ï¼Œæ™®é€šå¯¹è±¡æ€§èƒ½æ›´å¥½</span>
        <span class="hljs-comment">// 2. äº‹ä»¶åé€šå¸¸æ˜¯å­—ç¬¦ä¸²ï¼Œé€‚åˆä½œä¸ºå¯¹è±¡é”®</span>
        <span class="hljs-comment">// 3. Object.create(null) åˆ›å»ºæ²¡æœ‰åŸå‹çš„å¯¹è±¡ï¼Œé¿å…åŸå‹æ±¡æŸ“</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);
        
        <span class="hljs-comment">// æ¯ä¸ªäº‹ä»¶å¯¹åº”ä¸€ä¸ªç›‘å¬å™¨æ•°ç»„</span>
        <span class="hljs-comment">// {</span>
        <span class="hljs-comment">//   'event1': [listener1, listener2, ...],</span>
        <span class="hljs-comment">//   'event2': [listener3, listener4, ...]</span>
        <span class="hljs-comment">// }</span>
    }
}
</code></pre>
<h5 data-id="heading-17">5.2 once æ–¹æ³•çš„å®ç°åŸç†</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// once æ–¹æ³•çš„å®ç°ç»†èŠ‚</span>
<span class="hljs-title function_">once</span>(<span class="hljs-params">eventName, listener</span>) {
    <span class="hljs-comment">// åˆ›å»ºåŒ…è£…å‡½æ•°</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">onceWrapper</span> = (<span class="hljs-params">...args</span>) =&gt; {
        <span class="hljs-comment">// 1. æ‰§è¡ŒåŸå§‹ç›‘å¬å™¨</span>
        listener.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
        
        <span class="hljs-comment">// 2. æ ‡è®°ä¸ºå·²æ‰§è¡Œ</span>
        onceWrapper.<span class="hljs-property">_once</span> = <span class="hljs-literal">true</span>;
        
        <span class="hljs-comment">// 3. åœ¨ emit ä¸­æ£€æµ‹åˆ°è¿™ä¸ªæ ‡è®°åä¼šç§»é™¤ç›‘å¬å™¨</span>
    };
    
    <span class="hljs-comment">// ä¿å­˜åŸå§‹ç›‘å¬å™¨å¼•ç”¨ï¼Œç”¨äº off æ–¹æ³•</span>
    onceWrapper.<span class="hljs-property">_originalListener</span> = listener;
    
    <span class="hljs-comment">// æ·»åŠ åˆ°ç›‘å¬å™¨æ•°ç»„</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_addListener</span>(eventName, onceWrapper, <span class="hljs-literal">false</span>);
    
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
}

<span class="hljs-comment">// emit æ–¹æ³•ä¸­å¤„ç† once ç›‘å¬å™¨</span>
<span class="hljs-title function_">emit</span>(<span class="hljs-params">eventName, ...args</span>) {
    <span class="hljs-comment">// ...</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> listener <span class="hljs-keyword">of</span> listenersCopy) {
        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦ä¸º once åŒ…è£…å‡½æ•°</span>
        <span class="hljs-keyword">if</span> (listener.<span class="hljs-property">_once</span>) {
            <span class="hljs-comment">// ç§»é™¤ç›‘å¬å™¨</span>
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_removeListener</span>(eventName, listener);
        }
        <span class="hljs-comment">// ...</span>
    }
    <span class="hljs-comment">// ...</span>
}
</code></pre>
<h5 data-id="heading-18">5.3 å†…å­˜ç®¡ç†ç­–ç•¥</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é¿å…å†…å­˜æ³„æ¼çš„å®ç°</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeEventEmitter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EventEmitter</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">super</span>();
        <span class="hljs-comment">// è·Ÿè¸ªæ‰€æœ‰è®¢é˜…ï¼Œä¾¿äºæ¸…ç†</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_subscriptions</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakMap</span>();
    }
    
    <span class="hljs-title function_">safeOn</span>(<span class="hljs-params">eventName, listener, context = <span class="hljs-literal">null</span></span>) {
        <span class="hljs-comment">// ç»‘å®šä¸Šä¸‹æ–‡</span>
        <span class="hljs-keyword">const</span> boundListener = context ? listener.<span class="hljs-title function_">bind</span>(context) : listener;
        
        <span class="hljs-comment">// å­˜å‚¨å…ƒæ•°æ®</span>
        <span class="hljs-keyword">const</span> meta = {
            eventName,
            <span class="hljs-attr">originalListener</span>: listener,
            boundListener,
            <span class="hljs-attr">unsubscribe</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">off</span>(eventName, boundListener)
        };
        
        <span class="hljs-comment">// ä½¿ç”¨ WeakMap å­˜å‚¨ï¼Œä¸ä¼šé˜»æ­¢åƒåœ¾å›æ”¶</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_subscriptions</span>.<span class="hljs-title function_">set</span>(listener, meta);
        
        <span class="hljs-comment">// æ·»åŠ ç›‘å¬å™¨</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(eventName, boundListener);
        
        <span class="hljs-comment">// è¿”å›å¢å¼ºçš„å–æ¶ˆè®¢é˜…å‡½æ•°</span>
        <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">off</span>(eventName, boundListener);
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_subscriptions</span>.<span class="hljs-title function_">delete</span>(listener);
        };
    }
}
</code></pre>
<h4 data-id="heading-19">å…­ã€å¸¸è§é¢è¯•é¢˜å®ç°</h4>
<h5 data-id="heading-20">6.1 å®ç°ä¸€ä¸ªç®€å•çš„ EventBus</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å…¨å±€äº‹ä»¶æ€»çº¿ï¼ˆç±»ä¼¼ Vue ä¸­çš„ EventBusï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">EventBus</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);
    }
    
    <span class="hljs-comment">// å•ä¾‹æ¨¡å¼</span>
    <span class="hljs-keyword">static</span> <span class="hljs-title function_">getInstance</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">EventBus</span>.<span class="hljs-property">_instance</span>) {
            <span class="hljs-title class_">EventBus</span>.<span class="hljs-property">_instance</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventBus</span>();
        }
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">EventBus</span>.<span class="hljs-property">_instance</span>;
    }
    
    $on(event, callback) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[event]) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[event] = [];
        }
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[event].<span class="hljs-title function_">push</span>(callback);
    }
    
    $emit(event, ...args) {
        <span class="hljs-keyword">const</span> callbacks = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[event];
        <span class="hljs-keyword">if</span> (!callbacks) <span class="hljs-keyword">return</span>;
        
        <span class="hljs-comment">// ä½¿ç”¨ slice åˆ›å»ºå‰¯æœ¬ï¼Œé¿å…è¿­ä»£æ—¶ä¿®æ”¹æ•°ç»„</span>
        callbacks.<span class="hljs-title function_">slice</span>().<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">callback</span> =&gt;</span> {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-title function_">callback</span>(...args);
            } <span class="hljs-keyword">catch</span> (error) {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`EventBus error in <span class="hljs-subst">${event}</span>:`</span>, error);
            }
        });
    }
    
    $off(event, callback) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[event]) <span class="hljs-keyword">return</span>;
        
        <span class="hljs-keyword">if</span> (callback) {
            <span class="hljs-keyword">const</span> index = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[event].<span class="hljs-title function_">indexOf</span>(callback);
            <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[event].<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
            }
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[event];
        }
    }
    
    $once(event, callback) {
        <span class="hljs-keyword">const</span> <span class="hljs-title function_">onceWrapper</span> = (<span class="hljs-params">...args</span>) =&gt; {
            <span class="hljs-title function_">callback</span>(...args);
            <span class="hljs-variable language_">this</span>.$off(event, onceWrapper);
        };
        <span class="hljs-variable language_">this</span>.$on(event, onceWrapper);
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> bus = <span class="hljs-title class_">EventBus</span>.<span class="hljs-title function_">getInstance</span>();

<span class="hljs-comment">// ç»„ä»¶ A</span>
bus.$on(<span class="hljs-string">'user-login'</span>, <span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»„ä»¶A: ç”¨æˆ·ç™»å½•'</span>, user.<span class="hljs-property">name</span>);
});

<span class="hljs-comment">// ç»„ä»¶ B</span>
bus.$on(<span class="hljs-string">'user-login'</span>, <span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»„ä»¶B: æ›´æ–°ç”¨æˆ·ä¿¡æ¯'</span>, user.<span class="hljs-property">id</span>);
});

<span class="hljs-comment">// ç™»å½•æˆåŠŸå</span>
bus.$emit(<span class="hljs-string">'user-login'</span>, { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span> });
</code></pre>
<h5 data-id="heading-21">6.2 å®ç°å¸¦å‘½åç©ºé—´çš„äº‹ä»¶ç³»ç»Ÿ</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">NamespacedEventEmitter</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_separator</span> = <span class="hljs-string">':'</span>;
    }
    
    <span class="hljs-comment">// è§£æäº‹ä»¶åï¼Œæ”¯æŒå‘½åç©ºé—´</span>
    <span class="hljs-title function_">_parseEvent</span>(<span class="hljs-params">eventString</span>) {
        <span class="hljs-keyword">const</span> parts = eventString.<span class="hljs-title function_">split</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_separator</span>);
        <span class="hljs-keyword">if</span> (parts.<span class="hljs-property">length</span> === <span class="hljs-number">1</span>) {
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">namespace</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">event</span>: parts[<span class="hljs-number">0</span>] };
        }
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">namespace</span>: parts[<span class="hljs-number">0</span>], <span class="hljs-attr">event</span>: parts.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">join</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_separator</span>) };
    }
    
    <span class="hljs-comment">// ç”Ÿæˆå®Œæ•´çš„äº‹ä»¶é”®</span>
    <span class="hljs-title function_">_getEventKey</span>(<span class="hljs-params">namespace, event</span>) {
        <span class="hljs-keyword">return</span> namespace ? <span class="hljs-string">`<span class="hljs-subst">${namespace}</span><span class="hljs-subst">${<span class="hljs-variable language_">this</span>._separator}</span><span class="hljs-subst">${event}</span>`</span> : event;
    }
    
    <span class="hljs-title function_">on</span>(<span class="hljs-params">eventString, listener</span>) {
        <span class="hljs-keyword">const</span> { namespace, event } = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_parseEvent</span>(eventString);
        <span class="hljs-keyword">const</span> eventKey = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_getEventKey</span>(namespace, event);
        
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventKey]) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventKey] = [];
        }
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventKey].<span class="hljs-title function_">push</span>({
            listener,
            namespace,
            event
        });
        
        <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">off</span>(eventString, listener);
    }
    
    <span class="hljs-title function_">emit</span>(<span class="hljs-params">eventString, ...args</span>) {
        <span class="hljs-keyword">const</span> { namespace, event } = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_parseEvent</span>(eventString);
        
        <span class="hljs-comment">// æ”¶é›†æ‰€æœ‰åŒ¹é…çš„ç›‘å¬å™¨</span>
        <span class="hljs-keyword">const</span> listenersToCall = [];
        
        <span class="hljs-comment">// å¦‚æœæŒ‡å®šäº†å‘½åç©ºé—´ï¼Œåªè§¦å‘è¯¥å‘½åç©ºé—´çš„äº‹ä»¶</span>
        <span class="hljs-keyword">if</span> (namespace) {
            <span class="hljs-keyword">const</span> eventKey = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_getEventKey</span>(namespace, event);
            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventKey]) {
                listenersToCall.<span class="hljs-title function_">push</span>(...<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventKey]);
            }
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// å¦‚æœæ²¡æœ‰æŒ‡å®šå‘½åç©ºé—´ï¼Œè§¦å‘æ‰€æœ‰åŒ¹é…çš„äº‹ä»¶</span>
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> eventKey <span class="hljs-keyword">in</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>) {
                <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventKey];
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> listenerInfo <span class="hljs-keyword">of</span> listeners) {
                    <span class="hljs-keyword">if</span> (listenerInfo.<span class="hljs-property">event</span> === event) {
                        listenersToCall.<span class="hljs-title function_">push</span>(listenerInfo);
                    }
                }
            }
        }
        
        <span class="hljs-comment">// æ‰§è¡Œç›‘å¬å™¨</span>
        listenersToCall.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">{ listener }</span>) =&gt;</span> {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-title function_">listener</span>(...args);
            } <span class="hljs-keyword">catch</span> (error) {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Error in <span class="hljs-subst">${eventString}</span>:`</span>, error);
            }
        });
    }
    
    <span class="hljs-title function_">off</span>(<span class="hljs-params">eventString, listener</span>) {
        <span class="hljs-keyword">const</span> { namespace, event } = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_parseEvent</span>(eventString);
        
        <span class="hljs-keyword">if</span> (namespace) {
            <span class="hljs-keyword">const</span> eventKey = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_getEventKey</span>(namespace, event);
            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventKey]) {
                <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventKey];
                <span class="hljs-keyword">const</span> index = listeners.<span class="hljs-title function_">findIndex</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">listener</span> === listener);
                <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
                    listeners.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
                    <span class="hljs-keyword">if</span> (listeners.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
                        <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventKey];
                    }
                }
            }
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// ç§»é™¤æ‰€æœ‰å‘½åç©ºé—´ä¸‹çš„äº‹ä»¶</span>
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> eventKey <span class="hljs-keyword">in</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>) {
                <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventKey];
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = listeners.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
                    <span class="hljs-keyword">if</span> (listeners[i].<span class="hljs-property">listener</span> === listener &amp;&amp; listeners[i].<span class="hljs-property">event</span> === event) {
                        listeners.<span class="hljs-title function_">splice</span>(i, <span class="hljs-number">1</span>);
                    }
                }
                <span class="hljs-keyword">if</span> (listeners.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
                    <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventKey];
                }
            }
        }
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> nsEmitter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NamespacedEventEmitter</span>();

nsEmitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'user:login'</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç”¨æˆ·æ¨¡å—: ç™»å½•'</span>));
nsEmitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'admin:login'</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç®¡ç†å‘˜æ¨¡å—: ç™»å½•'</span>));
nsEmitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'login'</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å…¨å±€: ç™»å½•'</span>));

nsEmitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'user:login'</span>);    <span class="hljs-comment">// åªè¾“å‡º: ç”¨æˆ·æ¨¡å—: ç™»å½•</span>
nsEmitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'admin:login'</span>);   <span class="hljs-comment">// åªè¾“å‡º: ç®¡ç†å‘˜æ¨¡å—: ç™»å½•</span>
nsEmitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'login'</span>);         <span class="hljs-comment">// è¾“å‡ºæ‰€æœ‰</span>
</code></pre>
<h5 data-id="heading-22">6.3 å®ç°æ”¯æŒå¼‚æ­¥ç›‘å¬å™¨çš„ EventEmitter</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AsyncEventEmitter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EventEmitter</span> {
    <span class="hljs-comment">/**
     * å¼‚æ­¥è§¦å‘äº‹ä»¶ï¼Œç­‰å¾…æ‰€æœ‰ç›‘å¬å™¨å®Œæˆ
     */</span>
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">emitAsync</span>(<span class="hljs-params">eventName, ...args</span>) {
        <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">listeners</span>(eventName);
        <span class="hljs-keyword">if</span> (listeners.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-comment">// å¹¶è¡Œæ‰§è¡Œæ‰€æœ‰ç›‘å¬å™¨</span>
        <span class="hljs-keyword">const</span> promises = listeners.<span class="hljs-title function_">map</span>(<span class="hljs-keyword">async</span> (listener) =&gt; {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">listener</span>(...args);
                <span class="hljs-comment">// å¦‚æœç›‘å¬å™¨è¿”å› Promiseï¼Œç­‰å¾…å®ƒå®Œæˆ</span>
                <span class="hljs-keyword">if</span> (result &amp;&amp; <span class="hljs-keyword">typeof</span> result.<span class="hljs-property">then</span> === <span class="hljs-string">'function'</span>) {
                    <span class="hljs-keyword">await</span> result;
                }
            } <span class="hljs-keyword">catch</span> (error) {
                <span class="hljs-keyword">if</span> (eventName !== <span class="hljs-string">'error'</span>) {
                    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emitAsync</span>(<span class="hljs-string">'error'</span>, error);
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-keyword">throw</span> error;
                }
            }
        });
        
        <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(promises);
    }
    
    <span class="hljs-comment">/**
     * é¡ºåºæ‰§è¡Œç›‘å¬å™¨ï¼ˆä¸€ä¸ªæ¥ä¸€ä¸ªï¼‰
     */</span>
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">emitSeries</span>(<span class="hljs-params">eventName, ...args</span>) {
        <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">listeners</span>(eventName);
        
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> listener <span class="hljs-keyword">of</span> listeners) {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">listener</span>(...args);
                <span class="hljs-comment">// å¦‚æœç›‘å¬å™¨è¿”å› Promiseï¼Œç­‰å¾…å®ƒå®Œæˆ</span>
                <span class="hljs-keyword">if</span> (result &amp;&amp; <span class="hljs-keyword">typeof</span> result.<span class="hljs-property">then</span> === <span class="hljs-string">'function'</span>) {
                    <span class="hljs-keyword">await</span> result;
                }
            } <span class="hljs-keyword">catch</span> (error) {
                <span class="hljs-keyword">if</span> (eventName !== <span class="hljs-string">'error'</span>) {
                    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emitSeries</span>(<span class="hljs-string">'error'</span>, error);
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-keyword">throw</span> error;
                }
            }
        }
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> asyncEmitter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AsyncEventEmitter</span>();

asyncEmitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'process'</span>, <span class="hljs-keyword">async</span> (data) =&gt; {
    <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">100</span>));
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¤„ç†å®Œæˆ:'</span>, data);
});

asyncEmitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'process'</span>, <span class="hljs-keyword">async</span> (data) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬äºŒä¸ªç›‘å¬å™¨:'</span>, data);
});

asyncEmitter.<span class="hljs-title function_">emitAsync</span>(<span class="hljs-string">'process'</span>, <span class="hljs-string">'æµ‹è¯•æ•°æ®'</span>);
</code></pre>
<h5 data-id="heading-23">6.5 å®ç°æ”¯æŒä¼˜å…ˆçº§çš„ EventEmitter</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">PriorityEventEmitter</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_defaultPriority</span> = <span class="hljs-number">0</span>;
    }
    
    <span class="hljs-title function_">on</span>(<span class="hljs-params">eventName, listener, priority = <span class="hljs-variable language_">this</span>._defaultPriority</span>) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName]) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName] = [];
        }
        
        <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
        listeners.<span class="hljs-title function_">push</span>({ listener, priority });
        
        <span class="hljs-comment">// æŒ‰ä¼˜å…ˆçº§æ’åºï¼ˆæ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ï¼‰</span>
        listeners.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a.<span class="hljs-property">priority</span> - b.<span class="hljs-property">priority</span>);
        
        <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">off</span>(eventName, listener);
    }
    
    <span class="hljs-title function_">emit</span>(<span class="hljs-params">eventName, ...args</span>) {
        <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
        <span class="hljs-keyword">if</span> (!listeners) <span class="hljs-keyword">return</span>;
        
        <span class="hljs-comment">// éå†å·²æ’åºçš„ç›‘å¬å™¨</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> { listener } <span class="hljs-keyword">of</span> listeners) {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">listener</span>(...args);
                <span class="hljs-comment">// å¦‚æœç›‘å¬å™¨è¿”å› falseï¼Œåœæ­¢åç»­ç›‘å¬å™¨çš„æ‰§è¡Œ</span>
                <span class="hljs-keyword">if</span> (result === <span class="hljs-literal">false</span>) {
                    <span class="hljs-keyword">break</span>;
                }
            } <span class="hljs-keyword">catch</span> (error) {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Error in <span class="hljs-subst">${eventName}</span>:`</span>, error);
            }
        }
    }
    
    <span class="hljs-title function_">off</span>(<span class="hljs-params">eventName, listener</span>) {
        <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
        <span class="hljs-keyword">if</span> (!listeners) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
        
        <span class="hljs-keyword">const</span> index = listeners.<span class="hljs-title function_">findIndex</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">listener</span> === listener);
        <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
            listeners.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
            <span class="hljs-keyword">if</span> (listeners.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
            }
        }
        
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> priorityEmitter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityEventEmitter</span>();

priorityEmitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'process'</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¼˜å…ˆçº§ 10'</span>), <span class="hljs-number">10</span>);
priorityEmitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'process'</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¼˜å…ˆçº§ 0'</span>), <span class="hljs-number">0</span>);
priorityEmitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'process'</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¼˜å…ˆçº§ 5'</span>), <span class="hljs-number">5</span>);

priorityEmitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'process'</span>);
<span class="hljs-comment">// è¾“å‡ºé¡ºåº: ä¼˜å…ˆçº§ 0, ä¼˜å…ˆçº§ 5, ä¼˜å…ˆçº§ 10</span>
</code></pre>
<h4 data-id="heading-24">ä¸ƒã€å®é™…åº”ç”¨åœºæ™¯</h4>
<h5 data-id="heading-25">7.1 åœ¨ Vue ä¸­å®ç°ç»„ä»¶é€šä¿¡</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å…¨å±€äº‹ä»¶æ€»çº¿</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">EventBus</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventEmitter</span>();

<span class="hljs-comment">// åœ¨ Vue ç»„ä»¶ä¸­ä½¿ç”¨</span>
<span class="hljs-comment">// ComponentA.vue</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    <span class="hljs-title function_">mounted</span>(<span class="hljs-params"/>) {
        <span class="hljs-title class_">EventBus</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'user-updated'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleUserUpdate</span>);
    },
    <span class="hljs-attr">methods</span>: {
        <span class="hljs-title function_">handleUserUpdate</span>(<span class="hljs-params">user</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç”¨æˆ·æ›´æ–°:'</span>, user);
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">user</span> = user;
        }
    },
    <span class="hljs-title function_">beforeDestroy</span>(<span class="hljs-params"/>) {
        <span class="hljs-title class_">EventBus</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">'user-updated'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleUserUpdate</span>);
    }
};

<span class="hljs-comment">// ComponentB.vue</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    <span class="hljs-attr">methods</span>: {
        <span class="hljs-title function_">updateUser</span>(<span class="hljs-params"/>) {
            <span class="hljs-title class_">EventBus</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'user-updated'</span>, { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'John'</span> });
        }
    }
};

<span class="hljs-comment">// æˆ–è€…åœ¨ Vue åŸå‹ä¸Šæ·»åŠ </span>
<span class="hljs-title class_">Vue</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">$bus</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventEmitter</span>();

<span class="hljs-comment">// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">$bus</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'event'</span>, handler);
<span class="hljs-variable language_">this</span>.<span class="hljs-property">$bus</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'event'</span>, data);
<span class="hljs-variable language_">this</span>.<span class="hljs-property">$bus</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">'event'</span>, handler);
</code></pre>
<h5 data-id="heading-26">7.2 åœ¨ Express ä¸­å®ç°äº‹ä»¶é©±åŠ¨æ¶æ„</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);
<span class="hljs-keyword">const</span> <span class="hljs-title class_">EventEmitter</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./EventEmitter'</span>);

<span class="hljs-keyword">class</span> <span class="hljs-title class_">AppEvents</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EventEmitter</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">super</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupEvents</span>();
    }
    
    <span class="hljs-title function_">setupEvents</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// å®šä¹‰åº”ç”¨çº§åˆ«äº‹ä»¶</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'user:registered'</span>, <span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ–°ç”¨æˆ·æ³¨å†Œ:'</span>, user.<span class="hljs-property">email</span>);
            <span class="hljs-comment">// å‘é€æ¬¢è¿é‚®ä»¶</span>
            <span class="hljs-comment">// åˆ›å»ºç”¨æˆ·ç›®å½•</span>
            <span class="hljs-comment">// æ›´æ–°ç»Ÿè®¡</span>
        });
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'order:created'</span>, <span class="hljs-function">(<span class="hljs-params">order</span>) =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ–°è®¢å•:'</span>, order.<span class="hljs-property">id</span>);
            <span class="hljs-comment">// å‘é€ç¡®è®¤é‚®ä»¶</span>
            <span class="hljs-comment">// æ›´æ–°åº“å­˜</span>
            <span class="hljs-comment">// é€šçŸ¥ç‰©æµ</span>
        });
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">error, context</span>) =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åº”ç”¨é”™è¯¯:'</span>, error.<span class="hljs-property">message</span>, context);
            <span class="hljs-comment">// å‘é€é”™è¯¯æŠ¥å‘Š</span>
            <span class="hljs-comment">// è®°å½•åˆ°ç›‘æ§ç³»ç»Ÿ</span>
        });
    }
}

<span class="hljs-comment">// åˆ›å»º Express åº”ç”¨</span>
<span class="hljs-keyword">const</span> appEvents = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AppEvents</span>();
<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();

<span class="hljs-comment">// ä¸­é—´ä»¶ï¼šå°†äº‹ä»¶å‘å°„å™¨æ·»åŠ åˆ°è¯·æ±‚å¯¹è±¡</span>
app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> {
    req.<span class="hljs-property">appEvents</span> = appEvents;
    <span class="hljs-title function_">next</span>();
});

<span class="hljs-comment">// è·¯ç”±å¤„ç†</span>
app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/register'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> user = <span class="hljs-title function_">createUser</span>(req.<span class="hljs-property">body</span>);
    
    <span class="hljs-comment">// è§¦å‘äº‹ä»¶</span>
    req.<span class="hljs-property">appEvents</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'user:registered'</span>, user);
    
    res.<span class="hljs-title function_">json</span>({ <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>, user });
});

app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/order'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> order = <span class="hljs-title function_">createOrder</span>(req.<span class="hljs-property">body</span>);
    
    <span class="hljs-comment">// è§¦å‘äº‹ä»¶</span>
    req.<span class="hljs-property">appEvents</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'order:created'</span>, order);
    
    res.<span class="hljs-title function_">json</span>({ <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>, order });
});

<span class="hljs-comment">// é”™è¯¯å¤„ç†ä¸­é—´ä»¶</span>
app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">error, req, res, next</span>) =&gt;</span> {
    <span class="hljs-comment">// è§¦å‘é”™è¯¯äº‹ä»¶</span>
    req.<span class="hljs-property">appEvents</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'error'</span>, error, {
        <span class="hljs-attr">url</span>: req.<span class="hljs-property">url</span>,
        <span class="hljs-attr">method</span>: req.<span class="hljs-property">method</span>,
        <span class="hljs-attr">userId</span>: req.<span class="hljs-property">user</span>?.<span class="hljs-property">id</span>
    });
    
    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">error</span>: <span class="hljs-string">'Internal server error'</span> });
});
</code></pre>
<h5 data-id="heading-27">7.3 å®ç°ç®€å•çš„çŠ¶æ€ç®¡ç†</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ObservableStore</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">initialState = {}</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_state</span> = initialState;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_prevState</span> = <span class="hljs-literal">null</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_emitter</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventEmitter</span>();
    }
    
    <span class="hljs-comment">// è·å–å½“å‰çŠ¶æ€</span>
    <span class="hljs-title function_">getState</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_state</span>;
    }
    
    <span class="hljs-comment">// è®¾ç½®çŠ¶æ€</span>
    <span class="hljs-title function_">setState</span>(<span class="hljs-params">updates</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_prevState</span> = { ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">_state</span> };
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_state</span> = { ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">_state</span>, ...updates };
        
        <span class="hljs-comment">// è§¦å‘çŠ¶æ€å˜åŒ–äº‹ä»¶</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_emitter</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'state:changed'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">_state</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">_prevState</span>);
        
        <span class="hljs-comment">// è§¦å‘ç‰¹å®šå±æ€§çš„å˜åŒ–äº‹ä»¶</span>
        <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(updates).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_emitter</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">`state:<span class="hljs-subst">${key}</span>:changed`</span>, updates[key], <span class="hljs-variable language_">this</span>.<span class="hljs-property">_prevState</span>[key]);
        });
    }
    
    <span class="hljs-comment">// è®¢é˜…çŠ¶æ€å˜åŒ–</span>
    <span class="hljs-title function_">subscribe</span>(<span class="hljs-params">callback</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_emitter</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'state:changed'</span>, callback);
    }
    
    <span class="hljs-comment">// è®¢é˜…ç‰¹å®šçŠ¶æ€å˜åŒ–</span>
    <span class="hljs-title function_">subscribeTo</span>(<span class="hljs-params">key, callback</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_emitter</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">`state:<span class="hljs-subst">${key}</span>:changed`</span>, callback);
    }
    
    <span class="hljs-comment">// æ‰¹é‡æ›´æ–°</span>
    <span class="hljs-title function_">batchUpdate</span>(<span class="hljs-params">updater</span>) {
        <span class="hljs-keyword">const</span> updates = <span class="hljs-title function_">updater</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_state</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(updates);
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> store = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObservableStore</span>({
    <span class="hljs-attr">user</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">theme</span>: <span class="hljs-string">'light'</span>,
    <span class="hljs-attr">notifications</span>: []
});

<span class="hljs-comment">// è®¢é˜…çŠ¶æ€å˜åŒ–</span>
store.<span class="hljs-title function_">subscribe</span>(<span class="hljs-function">(<span class="hljs-params">newState, oldState</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'çŠ¶æ€å˜åŒ–:'</span>, newState);
});

<span class="hljs-comment">// è®¢é˜…ç‰¹å®šçŠ¶æ€å˜åŒ–</span>
store.<span class="hljs-title function_">subscribeTo</span>(<span class="hljs-string">'theme'</span>, <span class="hljs-function">(<span class="hljs-params">newTheme, oldTheme</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¸»é¢˜å˜åŒ–:'</span>, oldTheme, <span class="hljs-string">'-&gt;'</span>, newTheme);
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'data-theme'</span>, newTheme);
});

<span class="hljs-comment">// æ›´æ–°çŠ¶æ€</span>
store.<span class="hljs-title function_">setState</span>({ <span class="hljs-attr">theme</span>: <span class="hljs-string">'dark'</span> });
store.<span class="hljs-title function_">setState</span>({ <span class="hljs-attr">user</span>: { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span> } });

<span class="hljs-comment">// æ‰¹é‡æ›´æ–°</span>
store.<span class="hljs-title function_">batchUpdate</span>(<span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> ({
    <span class="hljs-attr">notifications</span>: [...state.<span class="hljs-property">notifications</span>, <span class="hljs-string">'æ–°æ¶ˆæ¯'</span>],
    <span class="hljs-attr">theme</span>: <span class="hljs-string">'dark'</span>
}));
</code></pre>
<h4 data-id="heading-28">å…«ã€æ€§èƒ½ä¼˜åŒ–å’Œæ³¨æ„äº‹é¡¹</h4>
<h5 data-id="heading-29">8.1 å†…å­˜æ³„æ¼é¢„é˜²</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å®‰å…¨çš„ EventEmitterï¼Œè‡ªåŠ¨æ¸…ç†è®¢é˜…</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeEventEmitter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EventEmitter</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">super</span>();
        <span class="hljs-comment">// ä½¿ç”¨ WeakRef è·Ÿè¸ªç»„ä»¶å¼•ç”¨</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_componentRefs</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakMap</span>();
    }
    
    <span class="hljs-comment">// ä¸ºç»„ä»¶ç»‘å®šäº‹ä»¶ï¼Œè‡ªåŠ¨æ¸…ç†</span>
    <span class="hljs-title function_">bindToComponent</span>(<span class="hljs-params">component, eventName, listener</span>) {
        <span class="hljs-comment">// åˆ›å»ºç»‘å®šå‡½æ•°</span>
        <span class="hljs-keyword">const</span> boundListener = listener.<span class="hljs-title function_">bind</span>(component);
        
        <span class="hljs-comment">// æ·»åŠ ç›‘å¬å™¨</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(eventName, boundListener);
        
        <span class="hljs-comment">// å­˜å‚¨å¼•ç”¨</span>
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_componentRefs</span>.<span class="hljs-title function_">has</span>(component)) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_componentRefs</span>.<span class="hljs-title function_">set</span>(component, []);
        }
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_componentRefs</span>.<span class="hljs-title function_">get</span>(component).<span class="hljs-title function_">push</span>({ eventName, <span class="hljs-attr">listener</span>: boundListener });
        
        <span class="hljs-comment">// è¿”å›æ¸…ç†å‡½æ•°</span>
        <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">off</span>(eventName, boundListener);
            <span class="hljs-keyword">const</span> refs = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_componentRefs</span>.<span class="hljs-title function_">get</span>(component);
            <span class="hljs-keyword">if</span> (refs) {
                <span class="hljs-keyword">const</span> index = refs.<span class="hljs-title function_">findIndex</span>(<span class="hljs-function"><span class="hljs-params">ref</span> =&gt;</span> 
                    ref.<span class="hljs-property">eventName</span> === eventName &amp;&amp; ref.<span class="hljs-property">listener</span> === boundListener
                );
                <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
                    refs.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
                }
            }
        };
    }
    
    <span class="hljs-comment">// æ¸…ç†ç»„ä»¶çš„æ‰€æœ‰äº‹ä»¶</span>
    <span class="hljs-title function_">cleanupComponent</span>(<span class="hljs-params">component</span>) {
        <span class="hljs-keyword">const</span> refs = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_componentRefs</span>.<span class="hljs-title function_">get</span>(component);
        <span class="hljs-keyword">if</span> (refs) {
            refs.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">{ eventName, listener }</span>) =&gt;</span> {
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">off</span>(eventName, listener);
            });
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_componentRefs</span>.<span class="hljs-title function_">delete</span>(component);
        }
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Component</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">emitter</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">emitter</span> = emitter;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_cleanupFns</span> = [];
    }
    
    <span class="hljs-title function_">setupEvents</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// ç»‘å®šäº‹ä»¶ï¼Œè‡ªåŠ¨ç®¡ç†ç”Ÿå‘½å‘¨æœŸ</span>
        <span class="hljs-keyword">const</span> cleanup1 = <span class="hljs-variable language_">this</span>.<span class="hljs-property">emitter</span>.<span class="hljs-title function_">bindToComponent</span>(
            <span class="hljs-variable language_">this</span>,
            <span class="hljs-string">'data'</span>,
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleData</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>)
        );
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_cleanupFns</span>.<span class="hljs-title function_">push</span>(cleanup1);
        
        <span class="hljs-keyword">const</span> cleanup2 = <span class="hljs-variable language_">this</span>.<span class="hljs-property">emitter</span>.<span class="hljs-title function_">bindToComponent</span>(
            <span class="hljs-variable language_">this</span>,
            <span class="hljs-string">'error'</span>,
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleError</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>)
        );
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_cleanupFns</span>.<span class="hljs-title function_">push</span>(cleanup2);
    }
    
    <span class="hljs-title function_">handleData</span>(<span class="hljs-params">data</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¤„ç†æ•°æ®:'</span>, data);
    }
    
    <span class="hljs-title function_">handleError</span>(<span class="hljs-params">error</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å¤„ç†é”™è¯¯:'</span>, error);
    }
    
    <span class="hljs-title function_">destroy</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// æ¸…ç†æ‰€æœ‰äº‹ä»¶</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_cleanupFns</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">fn</span> =&gt;</span> <span class="hljs-title function_">fn</span>());
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_cleanupFns</span> = [];
        
        <span class="hljs-comment">// æˆ–è€…ä½¿ç”¨è‡ªåŠ¨æ¸…ç†</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">emitter</span>.<span class="hljs-title function_">cleanupComponent</span>(<span class="hljs-variable language_">this</span>);
    }
}
</code></pre>
<h5 data-id="heading-30">8.2 æ€§èƒ½ä¼˜åŒ–æŠ€å·§</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é«˜æ€§èƒ½ EventEmitter</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">HighPerformanceEventEmitter</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// ä½¿ç”¨ç©ºå¯¹è±¡ä½œä¸ºåŸå‹ï¼Œé¿å…åŸå‹é“¾æŸ¥æ‰¾</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);
        <span class="hljs-comment">// ç¼“å­˜ç©ºæ•°ç»„ï¼Œé¿å…é¢‘ç¹åˆ›å»º</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_emptyArray</span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">freeze</span>([]);
    }
    
    <span class="hljs-title function_">on</span>(<span class="hljs-params">eventName, listener</span>) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName]) {
            <span class="hljs-comment">// é¢„åˆ†é…æ•°ç»„ç©ºé—´</span>
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName] = [];
        }
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName].<span class="hljs-title function_">push</span>(listener);
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
    
    <span class="hljs-title function_">emit</span>(<span class="hljs-params">eventName, ...args</span>) {
        <span class="hljs-comment">// å¿«é€Ÿè·¯å¾„ï¼šæ²¡æœ‰ç›‘å¬å™¨</span>
        <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
        <span class="hljs-keyword">if</span> (!listeners) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        
        <span class="hljs-comment">// ä½¿ç”¨ for å¾ªç¯è€Œä¸æ˜¯ forEachï¼Œæ€§èƒ½æ›´å¥½</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>, len = listeners.<span class="hljs-property">length</span>; i &lt; len; i++) {
            <span class="hljs-keyword">try</span> {
                listeners[i].<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
            } <span class="hljs-keyword">catch</span> (error) {
                <span class="hljs-comment">// é”™è¯¯å¤„ç†</span>
                <span class="hljs-keyword">if</span> (eventName !== <span class="hljs-string">'error'</span>) {
                    <span class="hljs-keyword">const</span> errorListeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>.<span class="hljs-property">error</span>;
                    <span class="hljs-keyword">if</span> (errorListeners) {
                        <span class="hljs-comment">// é¿å…é€’å½’è°ƒç”¨</span>
                        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; errorListeners.<span class="hljs-property">length</span>; j++) {
                            <span class="hljs-keyword">try</span> {
                                errorListeners[j].<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, error);
                            } <span class="hljs-keyword">catch</span> (e) {
                                <span class="hljs-comment">// å¿½ç•¥é”™è¯¯å¤„ç†å‡½æ•°ä¸­çš„é”™è¯¯</span>
                            }
                        }
                    }
                }
            }
        }
        
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-title function_">off</span>(<span class="hljs-params">eventName, listener</span>) {
        <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
        <span class="hljs-keyword">if</span> (!listeners) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
        
        <span class="hljs-comment">// ä»åå‘å‰éå†ï¼Œé¿å…æ•°ç»„ç§»åŠ¨</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = listeners.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
            <span class="hljs-keyword">if</span> (listeners[i] === listener) {
                listeners.<span class="hljs-title function_">splice</span>(i, <span class="hljs-number">1</span>);
                <span class="hljs-keyword">break</span>;
            }
        }
        
        <span class="hljs-comment">// å¦‚æœæ²¡æœ‰ç›‘å¬å™¨äº†ï¼Œåˆ é™¤å±æ€§ï¼ˆè®© V8 ä¼˜åŒ–ï¼‰</span>
        <span class="hljs-keyword">if</span> (listeners.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName];
        }
        
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
    
    <span class="hljs-comment">// æ‰¹é‡æ“ä½œä¼˜åŒ–</span>
    <span class="hljs-title function_">emitMany</span>(<span class="hljs-params">eventNames, ...args</span>) {
        <span class="hljs-keyword">const</span> results = [];
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> eventName <span class="hljs-keyword">of</span> eventNames) {
            results.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(eventName, ...args));
        }
        <span class="hljs-keyword">return</span> results;
    }
}
</code></pre>
<h5 data-id="heading-31">8,3 è°ƒè¯•å’Œç›‘æ§</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¯ç›‘æ§çš„ EventEmitter</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MonitoredEventEmitter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EventEmitter</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options = {}</span>) {
        <span class="hljs-variable language_">super</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_monitoring</span> = {
            <span class="hljs-attr">enabled</span>: options.<span class="hljs-property">enabled</span> !== <span class="hljs-literal">false</span>,
            <span class="hljs-attr">emitCount</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">listenerCount</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">eventStats</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(),
            <span class="hljs-attr">errorStats</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(),
            <span class="hljs-attr">slowListeners</span>: []
        };
        
        <span class="hljs-comment">// æ€§èƒ½ç›‘æ§é˜ˆå€¼ï¼ˆæ¯«ç§’ï¼‰</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_slowThreshold</span> = options.<span class="hljs-property">slowThreshold</span> || <span class="hljs-number">100</span>;
    }
    
    <span class="hljs-comment">// é‡å†™ emit æ–¹æ³•ä»¥æ”¶é›†ç›‘æ§æ•°æ®</span>
    <span class="hljs-title function_">emit</span>(<span class="hljs-params">eventName, ...args</span>) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">_monitoring</span>.<span class="hljs-property">enabled</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">emit</span>(eventName, ...args);
        }
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_monitoring</span>.<span class="hljs-property">emitCount</span>++;
        
        <span class="hljs-comment">// æ›´æ–°äº‹ä»¶ç»Ÿè®¡</span>
        <span class="hljs-keyword">const</span> eventStat = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_monitoring</span>.<span class="hljs-property">eventStats</span>.<span class="hljs-title function_">get</span>(eventName) || {
            <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">lastEmitted</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">avgDuration</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">maxDuration</span>: <span class="hljs-number">0</span>
        };
        
        eventStat.<span class="hljs-property">count</span>++;
        eventStat.<span class="hljs-property">lastEmitted</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();
        
        <span class="hljs-keyword">const</span> startTime = performance.<span class="hljs-title function_">now</span>();
        <span class="hljs-keyword">const</span> result = <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">emit</span>(eventName, ...args);
        <span class="hljs-keyword">const</span> duration = performance.<span class="hljs-title function_">now</span>() - startTime;
        
        <span class="hljs-comment">// æ›´æ–°æ€§èƒ½ç»Ÿè®¡</span>
        eventStat.<span class="hljs-property">avgDuration</span> = 
            (eventStat.<span class="hljs-property">avgDuration</span> * (eventStat.<span class="hljs-property">count</span> - <span class="hljs-number">1</span>) + duration) / eventStat.<span class="hljs-property">count</span>;
        eventStat.<span class="hljs-property">maxDuration</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(eventStat.<span class="hljs-property">maxDuration</span>, duration);
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_monitoring</span>.<span class="hljs-property">eventStats</span>.<span class="hljs-title function_">set</span>(eventName, eventStat);
        
        <span class="hljs-comment">// è®°å½•æ…¢ç›‘å¬å™¨</span>
        <span class="hljs-keyword">if</span> (duration &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">_slowThreshold</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_monitoring</span>.<span class="hljs-property">slowListeners</span>.<span class="hljs-title function_">push</span>({
                eventName,
                duration,
                <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(),
                <span class="hljs-attr">args</span>: args.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>) <span class="hljs-comment">// åªè®°å½•å‰ä¸‰ä¸ªå‚æ•°</span>
            });
            
            <span class="hljs-comment">// ä¿æŒæ…¢ç›‘å¬å™¨è®°å½•çš„æ•°é‡</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_monitoring</span>.<span class="hljs-property">slowListeners</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">100</span>) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">_monitoring</span>.<span class="hljs-property">slowListeners</span>.<span class="hljs-title function_">shift</span>();
            }
        }
        
        <span class="hljs-keyword">return</span> result;
    }
    
    <span class="hljs-comment">// è·å–ç›‘æ§æ•°æ®</span>
    <span class="hljs-title function_">getMonitoringData</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> {
            ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">_monitoring</span>,
            <span class="hljs-attr">currentListeners</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_getListenersCount</span>(),
            <span class="hljs-attr">eventNames</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">eventNames</span>(),
            <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()
        };
    }
    
    <span class="hljs-comment">// é‡ç½®ç›‘æ§æ•°æ®</span>
    <span class="hljs-title function_">resetMonitoring</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_monitoring</span> = {
            <span class="hljs-attr">enabled</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">emitCount</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">listenerCount</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">eventStats</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(),
            <span class="hljs-attr">errorStats</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(),
            <span class="hljs-attr">slowListeners</span>: []
        };
    }
    
    <span class="hljs-comment">// ç”Ÿæˆç›‘æ§æŠ¥å‘Š</span>
    <span class="hljs-title function_">generateReport</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> data = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getMonitoringData</span>();
        
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'=== EventEmitter ç›‘æ§æŠ¥å‘Š ==='</span>);
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`è¿è¡Œæ—¶é—´: <span class="hljs-subst">${data.timestamp.toISOString()}</span>`</span>);
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ€»è§¦å‘æ¬¡æ•°: <span class="hljs-subst">${data.emitCount}</span>`</span>);
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ´»è·ƒäº‹ä»¶æ•°é‡: <span class="hljs-subst">${data.eventNames.length}</span>`</span>);
        
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'\näº‹ä»¶ç»Ÿè®¡:'</span>);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [eventName, stat] <span class="hljs-keyword">of</span> data.<span class="hljs-property">eventStats</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`  <span class="hljs-subst">${eventName}</span>:`</span>);
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`    è§¦å‘æ¬¡æ•°: <span class="hljs-subst">${stat.count}</span>`</span>);
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`    å¹³å‡è€—æ—¶: <span class="hljs-subst">${stat.avgDuration.toFixed(<span class="hljs-number">2</span>)}</span>ms`</span>);
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`    æœ€å¤§è€—æ—¶: <span class="hljs-subst">${stat.maxDuration.toFixed(<span class="hljs-number">2</span>)}</span>ms`</span>);
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`    æœ€åè§¦å‘: <span class="hljs-subst">${stat.lastEmitted.toISOString()}</span>`</span>);
        }
        
        <span class="hljs-keyword">if</span> (data.<span class="hljs-property">slowListeners</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'\næ…¢ç›‘å¬å™¨è­¦å‘Š:'</span>);
            data.<span class="hljs-property">slowListeners</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`  <span class="hljs-subst">${index + <span class="hljs-number">1</span>}</span>. <span class="hljs-subst">${item.eventName}</span> - <span class="hljs-subst">${item.duration.toFixed(<span class="hljs-number">2</span>)}</span>ms`</span>);
            });
        }
        
        <span class="hljs-keyword">return</span> data;
    }
    
    <span class="hljs-comment">// ç§æœ‰æ–¹æ³•ï¼šè·å–ç›‘å¬å™¨è®¡æ•°</span>
    <span class="hljs-title function_">_getListenersCount</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> result = {};
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> eventName <span class="hljs-keyword">in</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>) {
            result[eventName] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_events</span>[eventName].<span class="hljs-property">length</span>;
        }
        <span class="hljs-keyword">return</span> result;
    }
}
</code></pre>
<h4 data-id="heading-32">ä¹ã€æ€»ç»“ä¸æœ€ä½³å®è·µ</h4>
<h5 data-id="heading-33">9.1 æ ¸å¿ƒè¦ç‚¹æ€»ç»“</h5>
<ol>
<li><strong>å‘å¸ƒè®¢é˜…æ¨¡å¼çš„æ ¸å¿ƒ:</strong> é€šè¿‡äº‹ä»¶ä¸­å¿ƒè§£è€¦å‘å¸ƒè€…å’Œè®¢é˜…è€…</li>
<li><strong>EventEmitterçš„å®ç°è¦ç‚¹:</strong></li>
</ol>
<ul>
<li>ä½¿ç”¨åˆé€‚çš„æ•°æ®ç»“æ„å­˜å‚¨äº‹ä»¶å’Œç›‘å¬å™¨</li>
<li>æ­£ç¡®å¤„ç† once ç›‘å¬å™¨</li>
<li>å®ç°é”™è¯¯å¤„ç†æœºåˆ¶</li>
<li>æ”¯æŒé“¾å¼è°ƒç”¨</li>
</ul>
<ol start="3">
<li><strong>å†…å­˜ç®¡ç†:</strong> åŠæ—¶æ¸…ç†ç›‘å¬å™¨, é¿å…å†…å­˜æ³„æ¼</li>
<li><strong>æ€§èƒ½è€ƒè™‘:</strong> é€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„å’Œç®—æ³•</li>
</ol>
<h5 data-id="heading-34">9.2 æœ€ä½³å®ç°</h5>
<ol>
<li>å‘½åè§„èŒƒ:</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¥½çš„å‘½å</span>
emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'user:login'</span>, handler);
emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'order:created'</span>, handler);

<span class="hljs-comment">// ä¸å¥½çš„å‘½å</span>
emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'login'</span>, handler);
emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'newOrder'</span>, handler);
</code></pre>
<ol start="2">
<li>é”™è¯¯å¤„ç†:</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ€»æ˜¯ç›‘å¬ error äº‹ä»¶</span>
emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'EventEmitter error:'</span>, error);
    <span class="hljs-comment">// å‘é€åˆ°é”™è¯¯ç›‘æ§ç³»ç»Ÿ</span>
});

<span class="hljs-comment">// æˆ–è€…åœ¨ç›‘å¬å™¨å†…éƒ¨å¤„ç†é”™è¯¯</span>
emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'data'</span>, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-title function_">processData</span>(data);
    } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å¤„ç†æ•°æ®æ—¶å‡ºé”™:'</span>, error);
        emitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'error'</span>, error);
    }
});
</code></pre>
<ol start="3">
<li>èµ„æºæ¸…ç†:</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Component</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_cleanupFns</span> = [];
    }
    
    <span class="hljs-title function_">setupEvents</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> cleanup1 = emitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">'event1'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handler1</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_cleanupFns</span>.<span class="hljs-title function_">push</span>(cleanup1);
        
        <span class="hljs-keyword">const</span> cleanup2 = emitter.<span class="hljs-title function_">once</span>(<span class="hljs-string">'event2'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handler2</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_cleanupFns</span>.<span class="hljs-title function_">push</span>(cleanup2);
    }
    
    <span class="hljs-title function_">destroy</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// æ¸…ç†æ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_cleanupFns</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">fn</span> =&gt;</span> <span class="hljs-title function_">fn</span>());
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_cleanupFns</span> = [];
    }
}
</code></pre>
<h5 data-id="heading-35">9.3 ä½¿ç”¨å»ºè®®</h5>



































<table><thead><tr><th align="left">åœºæ™¯</th><th align="left">æ¨èæ–¹æ¡ˆ</th><th align="left">ç†ç”±</th></tr></thead><tbody><tr><td align="left">ç®€å•ç»„ä»¶é€šä¿¡</td><td align="left">åŸºç¡€ EventEmitter</td><td align="left">è½»é‡ã€ç®€å•</td></tr><tr><td align="left">å¤§å‹åº”ç”¨çŠ¶æ€ç®¡ç†</td><td align="left">Observable Store</td><td align="left">ç»“æ„åŒ–ã€å¯é¢„æµ‹</td></tr><tr><td align="left">å¼‚æ­¥ä»»åŠ¡åè°ƒ</td><td align="left">AsyncEventEmitter</td><td align="left">æ›´å¥½çš„å¼‚æ­¥æ”¯æŒ</td></tr><tr><td align="left">æ€§èƒ½æ•æ„Ÿåœºæ™¯</td><td align="left">HighPerformanceEventEmitter</td><td align="left">ä¼˜åŒ–è¿‡çš„å®ç°</td></tr><tr><td align="left">éœ€è¦ç›‘æ§è°ƒè¯•</td><td align="left">MonitoredEventEmitter</td><td align="left">å†…ç½®ç›‘æ§åŠŸèƒ½</td></tr></tbody></table>
<h4 data-id="heading-36">ç»“è¯­</h4>
<p>é€šè¿‡æ‰‹å†™ EventEmitterï¼Œæˆ‘ä»¬ä¸ä»…æŒæ¡äº†å‘å¸ƒè®¢é˜…æ¨¡å¼çš„å®ç°åŸç†ï¼Œæ›´é‡è¦çš„æ˜¯ç†è§£äº†äº‹ä»¶é©±åŠ¨ç¼–ç¨‹çš„æ ¸å¿ƒæ€æƒ³ã€‚EventEmitter è™½ç„¶ç®€å•ï¼Œä½†å…¶è®¾è®¡æ€æƒ³åœ¨ç°ä»£å‰ç«¯æ¡†æ¶ã€Node.js åç«¯ç³»ç»Ÿä»¥åŠå„ç§å¤æ‚åº”ç”¨ä¸­éƒ½æœ‰å¹¿æ³›çš„åº”ç”¨ã€‚</p>
<p>è®°ä½ï¼Œå¥½çš„äº‹ä»¶ç³»ç»Ÿåº”è¯¥ï¼š</p>
<ul>
<li>
<p>âœ… èŒè´£æ¸…æ™°ï¼šäº‹ä»¶ä¸­å¿ƒåªè´Ÿè´£è½¬å‘æ¶ˆæ¯</p>
</li>
<li>
<p>âœ… æ€§èƒ½ä¼˜ç§€ï¼šé«˜é¢‘äº‹ä»¶è§¦å‘æ—¶è¡¨ç°è‰¯å¥½</p>
</li>
<li>
<p>âœ… æ˜“äºè°ƒè¯•ï¼šæœ‰è‰¯å¥½çš„ç›‘æ§å’Œé”™è¯¯å¤„ç†</p>
</li>
<li>
<p>âœ… å†…å­˜å®‰å…¨ï¼šé¿å…å†…å­˜æ³„æ¼å’Œèµ„æºæµªè´¹</p>
</li>
</ul>
<hr/>
<p>å»¶ä¼¸é˜…è¯»ï¼š</p>
<ul>
<li>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fnodejs.org%2Fapi%2Fevents.html" target="_blank" title="https://nodejs.org/api/events.html" ref="nofollow noopener noreferrer">Node.js EventEmitter å®˜æ–¹æ–‡æ¡£</a></p>
</li>
<li>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FPublish%2525E2%252580%252593subscribe_pattern" target="_blank" title="https://en.wikipedia.org/wiki/Publish%25E2%2580%2593subscribe_pattern" ref="nofollow noopener noreferrer">å‘å¸ƒè®¢é˜…æ¨¡å¼è¯¦è§£</a></p>
</li>
<li>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhackernoon.com%2Fobserver-vs-pub-sub-pattern-50d3b27f838c" target="_blank" title="https://hackernoon.com/observer-vs-pub-sub-pattern-50d3b27f838c" ref="nofollow noopener noreferrer">è§‚å¯Ÿè€…æ¨¡å¼ä¸å‘å¸ƒè®¢é˜…æ¨¡å¼çš„åŒºåˆ«</a></p>
</li>
<li>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Frxjs.dev%2Fguide%2Foverview" target="_blank" title="https://rxjs.dev/guide/overview" ref="nofollow noopener noreferrer">RxJS å“åº”å¼ç¼–ç¨‹</a></p>
</li>
</ul>
<p>å¸Œæœ›è¿™ç¯‡ç»è¿‡ä¸¥æ ¼æµ‹è¯•çš„åšå®¢èƒ½å¸®åŠ©ä½ æ·±å…¥ç†è§£ EventEmitterï¼å¦‚æœæœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿è®¨è®ºäº¤æµã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[C++å¼‚å¸¸å®‰å…¨ä¿è¯ï¼šä»ç†è®ºåˆ°å®è·µ]]></title>    <link>https://juejin.cn/post/7580378958073823242</link>    <guid>https://juejin.cn/post/7580378958073823242</guid>    <pubDate>2025-12-07T14:34:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580378958073823242" data-draft-id="7580606750291148851" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="C++å¼‚å¸¸å®‰å…¨ä¿è¯ï¼šä»ç†è®ºåˆ°å®è·µ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-07T14:34:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç äº‹æ¼«è°ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/1972974802965230"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            C++å¼‚å¸¸å®‰å…¨ä¿è¯ï¼šä»ç†è®ºåˆ°å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1972974802965230/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç äº‹æ¼«è°ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T14:34:07.000Z" title="Sun Dec 07 2025 14:34:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. å¼‚å¸¸å®‰å…¨ä¿è¯çš„ä¸‰ç§çº§åˆ«</h2>
<h3 data-id="heading-1">1.1 åŸºæœ¬ä¿è¯ï¼ˆBasic Guaranteeï¼‰</h3>
<p><strong>å®šä¹‰</strong>ï¼šå¦‚æœå¼‚å¸¸è¢«æŠ›å‡ºï¼Œç¨‹åºä¿æŒæœ‰æ•ˆçŠ¶æ€ï¼Œä¸ä¼šå‘ç”Ÿèµ„æºæ³„æ¼ï¼Œä½†å¯¹è±¡çš„ç¡®åˆ‡çŠ¶æ€å¯èƒ½æ˜¯æœªæŒ‡å®šçš„ã€‚</p>
<p><strong>å®è·µç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BasicGuaranteeExample</span> {
    <span class="hljs-type">int</span>* data;
    <span class="hljs-type">size_t</span> size;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">modify</span><span class="hljs-params">(<span class="hljs-type">size_t</span> index, <span class="hljs-type">int</span> value)</span> </span>{
        <span class="hljs-keyword">if</span> (index &gt;= size) {
            <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">out_of_range</span>(<span class="hljs-string">"Index out of range"</span>);
        }
        
        <span class="hljs-comment">// å¯èƒ½æŠ›å‡ºçš„æ“ä½œ</span>
        data[index] = value;
        
        <span class="hljs-comment">// å¦‚æœè¿™é‡ŒæŠ›å‡ºå¼‚å¸¸ï¼Œå¯¹è±¡çŠ¶æ€å¯èƒ½ä¸ä¸€è‡´</span>
        <span class="hljs-comment">// ä½†è‡³å°‘ä¸ä¼šæ³„æ¼å†…å­˜</span>
    }
    
    ~<span class="hljs-built_in">BasicGuaranteeExample</span>() {
        <span class="hljs-keyword">delete</span>[] data;
    }
};
</code></pre>
<h3 data-id="heading-2">1.2 å¼ºä¿è¯ï¼ˆStrong Guaranteeï¼‰</h3>
<p><strong>å®šä¹‰</strong>ï¼šå¦‚æœå¼‚å¸¸è¢«æŠ›å‡ºï¼Œç¨‹åºçŠ¶æ€ä¸è°ƒç”¨æ“ä½œä¹‹å‰å®Œå…¨ä¸€è‡´ã€‚</p>
<p><strong>å®è·µæ¨¡å¼</strong>ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">StrongGuaranteeExample</span> {
    std::vector&lt;<span class="hljs-type">int</span>&gt; data;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">addValues</span><span class="hljs-params">(<span class="hljs-type">const</span> std::vector&lt;<span class="hljs-type">int</span>&gt;&amp; newValues)</span> </span>{
        std::vector&lt;<span class="hljs-type">int</span>&gt; backup = data;  <span class="hljs-comment">// 1. å…ˆå¤‡ä»½</span>
        <span class="hljs-keyword">try</span> {
            data.<span class="hljs-built_in">insert</span>(data.<span class="hljs-built_in">end</span>(), newValues.<span class="hljs-built_in">begin</span>(), newValues.<span class="hljs-built_in">end</span>());
            <span class="hljs-comment">// å¯èƒ½æŠ›å‡ºçš„æ“ä½œå®Œæˆåï¼Œå†æäº¤</span>
        } <span class="hljs-built_in">catch</span> (...) {
            data.<span class="hljs-built_in">swap</span>(backup);  <span class="hljs-comment">// 2. å¼‚å¸¸æ—¶æ¢å¤</span>
            <span class="hljs-keyword">throw</span>;
        }
    }
    
    <span class="hljs-comment">// æˆ–è€…ä½¿ç”¨RAIIæ–¹å¼</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">safeAddValues</span><span class="hljs-params">(<span class="hljs-type">const</span> std::vector&lt;<span class="hljs-type">int</span>&gt;&amp; newValues)</span> </span>{
        StrongGuaranteeExample temp = *<span class="hljs-keyword">this</span>;
        temp.data.<span class="hljs-built_in">insert</span>(temp.data.<span class="hljs-built_in">end</span>(), newValues.<span class="hljs-built_in">begin</span>(), newValues.<span class="hljs-built_in">end</span>());
        <span class="hljs-built_in">swap</span>(temp);  <span class="hljs-comment">// ä¸æŠ›å‡ºå¼‚å¸¸çš„æ“ä½œ</span>
    }
};
</code></pre>
<h3 data-id="heading-3">1.3 ä¸æŠ›å¼‚å¸¸ä¿è¯ï¼ˆNo-throw Guaranteeï¼‰</h3>
<p><strong>å®šä¹‰</strong>ï¼šæ“ä½œæ‰¿è¯ºæ°¸è¿œä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>ææ„å‡½æ•°</li>
<li>ç§»åŠ¨æ“ä½œ</li>
<li><code>swap</code>å‡½æ•°</li>
<li>é‡Šæ”¾èµ„æºæ“ä½œ</li>
</ul>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">NoThrowExample</span> {
    std::unique_ptr&lt;<span class="hljs-type">int</span>[]&gt; data;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// ç§»åŠ¨æ„é€ å‡½æ•° - ä¸åº”è¯¥æŠ›å‡ºå¼‚å¸¸</span>
    <span class="hljs-built_in">NoThrowExample</span>(NoThrowExample&amp;&amp; other) <span class="hljs-keyword">noexcept</span>
        : <span class="hljs-built_in">data</span>(std::<span class="hljs-built_in">move</span>(other.data)) {
    }
    
    <span class="hljs-comment">// ç§»åŠ¨èµ‹å€¼æ“ä½œç¬¦</span>
    NoThrowExample&amp; <span class="hljs-keyword">operator</span>=(NoThrowExample&amp;&amp; other) <span class="hljs-keyword">noexcept</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span> != &amp;other) {
            data = std::<span class="hljs-built_in">move</span>(other.data);
        }
        <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;
    }
    
    <span class="hljs-comment">// swapå‡½æ•° - ä¸åº”è¯¥æŠ›å‡ºå¼‚å¸¸</span>
    <span class="hljs-function"><span class="hljs-keyword">friend</span> <span class="hljs-type">void</span> <span class="hljs-title">swap</span><span class="hljs-params">(NoThrowExample&amp; a, NoThrowExample&amp; b)</span> <span class="hljs-keyword">noexcept</span> </span>{
        <span class="hljs-keyword">using</span> std::swap;
        <span class="hljs-built_in">swap</span>(a.data, b.data);
    }
};
</code></pre>
<h2 data-id="heading-4">2. Copy-and-Swapæƒ¯ç”¨æ³•è¯¦è§£</h2>
<h3 data-id="heading-5">2.1 åŸºæœ¬å®ç°æ¨¡å¼</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeVector</span> {
<span class="hljs-keyword">private</span>:
    <span class="hljs-type">size_t</span> size_;
    <span class="hljs-type">int</span>* data_;
    
    <span class="hljs-comment">// å®ç°æ‹·è´æ„é€ å’Œäº¤æ¢çš„è¾…åŠ©ç±»</span>
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">Impl</span> {
        <span class="hljs-type">size_t</span> size;
        std::unique_ptr&lt;<span class="hljs-type">int</span>[]&gt; data;
        
        <span class="hljs-function"><span class="hljs-keyword">explicit</span> <span class="hljs-title">Impl</span><span class="hljs-params">(<span class="hljs-type">size_t</span> s = <span class="hljs-number">0</span>)</span> 
            : size(s), data(s ? new int[s] : nullptr) {</span>}
            
        <span class="hljs-built_in">Impl</span>(<span class="hljs-type">const</span> Impl&amp; other) 
            : <span class="hljs-built_in">size</span>(other.size), <span class="hljs-built_in">data</span>(other.size ? <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[other.size] : <span class="hljs-literal">nullptr</span>) {
            std::<span class="hljs-built_in">copy</span>(other.data.<span class="hljs-built_in">get</span>(), 
                     other.data.<span class="hljs-built_in">get</span>() + other.size, 
                     data.<span class="hljs-built_in">get</span>());
        }
    };
    
    std::shared_ptr&lt;Impl&gt; pImpl;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// æ„é€ å‡½æ•°</span>
    <span class="hljs-built_in">SafeVector</span>(<span class="hljs-type">size_t</span> size = <span class="hljs-number">0</span>) : <span class="hljs-built_in">pImpl</span>(std::<span class="hljs-built_in">make_shared</span>&lt;Impl&gt;(size)) {}
    
    <span class="hljs-comment">// æ‹·è´æ„é€ å‡½æ•°</span>
    <span class="hljs-built_in">SafeVector</span>(<span class="hljs-type">const</span> SafeVector&amp; other) : <span class="hljs-built_in">pImpl</span>(other.pImpl) {}
    
    <span class="hljs-comment">// ç§»åŠ¨æ„é€ å‡½æ•°</span>
    <span class="hljs-built_in">SafeVector</span>(SafeVector&amp;&amp; other) <span class="hljs-keyword">noexcept</span> = <span class="hljs-keyword">default</span>;
    
    <span class="hljs-comment">// å…³é”®ï¼šcopy-and-swapå®ç°èµ‹å€¼æ“ä½œç¬¦</span>
    SafeVector&amp; <span class="hljs-keyword">operator</span>=(SafeVector other) <span class="hljs-keyword">noexcept</span> {  <span class="hljs-comment">// ä¼ å€¼ï¼</span>
        <span class="hljs-built_in">swap</span>(*<span class="hljs-keyword">this</span>, other);
        <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;
    }
    
    <span class="hljs-comment">// æä¾›å¼ºå¼‚å¸¸å®‰å…¨çš„ä¿®æ”¹æ“ä½œ</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">push_back</span><span class="hljs-params">(<span class="hljs-type">int</span> value)</span> </span>{
        <span class="hljs-keyword">auto</span> newImpl = std::<span class="hljs-built_in">make_shared</span>&lt;Impl&gt;(pImpl-&gt;size + <span class="hljs-number">1</span>);
        <span class="hljs-keyword">if</span> (pImpl-&gt;size &gt; <span class="hljs-number">0</span>) {
            std::<span class="hljs-built_in">copy</span>(pImpl-&gt;data.<span class="hljs-built_in">get</span>(), 
                     pImpl-&gt;data.<span class="hljs-built_in">get</span>() + pImpl-&gt;size,
                     newImpl-&gt;data.<span class="hljs-built_in">get</span>());
        }
        newImpl-&gt;data[pImpl-&gt;size] = value;
        
        <span class="hljs-comment">// swapä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œæä¾›å¼ºä¿è¯</span>
        pImpl.<span class="hljs-built_in">swap</span>(newImpl);
    }
    
    <span class="hljs-function"><span class="hljs-keyword">friend</span> <span class="hljs-type">void</span> <span class="hljs-title">swap</span><span class="hljs-params">(SafeVector&amp; a, SafeVector&amp; b)</span> <span class="hljs-keyword">noexcept</span> </span>{
        a.pImpl.<span class="hljs-built_in">swap</span>(b.pImpl);
    }
};
</code></pre>
<h3 data-id="heading-6">2.2 ä¼˜ç‚¹åˆ†æ</h3>
<ol>
<li><strong>è‡ªåŠ¨å¼‚å¸¸å®‰å…¨</strong>ï¼šå¼‚å¸¸åªå¯èƒ½å‘ç”Ÿåœ¨æ‹·è´æ„é€ æ—¶ï¼Œæ­¤æ—¶ä¸å½±å“åŸå¯¹è±¡</li>
<li><strong>ä»£ç å¤ç”¨</strong>ï¼šæ‹·è´æ„é€ å‡½æ•°å’Œèµ‹å€¼æ“ä½œç¬¦å…±äº«é€»è¾‘</li>
<li><strong>è‡ªæˆ‘èµ‹å€¼å®‰å…¨</strong>ï¼šè‡ªç„¶å¤„ç†è‡ªæˆ‘èµ‹å€¼æƒ…å†µ</li>
<li><strong>å¼ºä¿è¯</strong>ï¼šè¦ä¹ˆå®Œå…¨æˆåŠŸï¼Œè¦ä¹ˆå®Œå…¨ä¸å½±å“åŸå¯¹è±¡</li>
</ol>
<h2 data-id="heading-7">3. ç§»åŠ¨æ“ä½œä¸å¼‚å¸¸å®‰å…¨</h2>
<h3 data-id="heading-8">3.1 ç§»åŠ¨æ“ä½œçš„ç‰¹æ®Šæ€§</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MoveExceptionSafety</span> {
    std::unique_ptr&lt;Resource&gt; resource;
    std::vector&lt;<span class="hljs-type">int</span>&gt; data;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// ç§»åŠ¨æ„é€ å‡½æ•° - æ ‡è®°ä¸ºnoexcept</span>
    <span class="hljs-built_in">MoveExceptionSafety</span>(MoveExceptionSafety&amp;&amp; other) <span class="hljs-keyword">noexcept</span>
        : <span class="hljs-built_in">resource</span>(std::<span class="hljs-built_in">move</span>(other.resource))
        , <span class="hljs-built_in">data</span>(std::<span class="hljs-built_in">move</span>(other.data)) {
    }
    
    <span class="hljs-comment">// ä¸ºä»€ä¹ˆéœ€è¦noexceptï¼Ÿ</span>
    <span class="hljs-comment">// 1. STLå®¹å™¨éœ€è¦çŸ¥é“ç§»åŠ¨æ“ä½œæ˜¯å¦å®‰å…¨</span>
    <span class="hljs-comment">// 2. å½±å“vectorç­‰å®¹å™¨çš„é‡æ–°åˆ†é…ç­–ç•¥</span>
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">demonstrateVectorReallocation</span><span class="hljs-params">()</span> </span>{
        std::vector&lt;MoveExceptionSafety&gt; vec;
        vec.<span class="hljs-built_in">reserve</span>(<span class="hljs-number">2</span>);
        vec.<span class="hljs-built_in">emplace_back</span>();
        vec.<span class="hljs-built_in">emplace_back</span>();
        
        <span class="hljs-comment">// å½“vectoréœ€è¦æ‰©å®¹æ—¶ï¼š</span>
        <span class="hljs-comment">// - å¦‚æœç§»åŠ¨æ„é€ å‡½æ•°æ˜¯noexceptï¼šä½¿ç”¨ç§»åŠ¨</span>
        <span class="hljs-comment">// - å¦åˆ™ï¼šä½¿ç”¨æ‹·è´ï¼ˆä¿è¯å¼ºå¼‚å¸¸å®‰å…¨ï¼‰</span>
    }
};
</code></pre>
<h3 data-id="heading-9">3.2 ç§»åŠ¨æ“ä½œçš„å¼‚å¸¸å®‰å…¨å®ç°è¦ç‚¹</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ComplexResource</span> {
<span class="hljs-keyword">private</span>:
    Resource* res1;
    Resource* res2;
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">cleanup</span><span class="hljs-params">()</span> <span class="hljs-keyword">noexcept</span> </span>{
        <span class="hljs-keyword">delete</span> res1;
        <span class="hljs-keyword">delete</span> res2;
        res1 = res2 = <span class="hljs-literal">nullptr</span>;
    }
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// ä¸å®‰å…¨çš„ç§»åŠ¨æ„é€ å‡½æ•°</span>
    <span class="hljs-built_in">ComplexResource</span>(ComplexResource&amp;&amp; other) 
        : <span class="hljs-built_in">res1</span>(other.res1), <span class="hljs-built_in">res2</span>(<span class="hljs-literal">nullptr</span>) {  <span class="hljs-comment">// ç¬¬ä¸€ä¸ªèµ„æºå·²ç§»åŠ¨</span>
        
        <span class="hljs-comment">// å¦‚æœè¿™é‡ŒæŠ›å‡ºå¼‚å¸¸ï¼Œotherå¤„äºéƒ¨åˆ†ç§»åŠ¨çŠ¶æ€ï¼</span>
        res2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Resource</span>(*other.res2);  <span class="hljs-comment">// å‡è®¾å¯èƒ½æŠ›å‡ºå¼‚å¸¸</span>
        
        other.res1 = <span class="hljs-literal">nullptr</span>;
        other.res2 = <span class="hljs-literal">nullptr</span>;
    }
    
    <span class="hljs-comment">// å®‰å…¨çš„ç§»åŠ¨æ„é€ å‡½æ•°</span>
    <span class="hljs-built_in">ComplexResource</span>(ComplexResource&amp;&amp; other) <span class="hljs-keyword">noexcept</span>
        : <span class="hljs-built_in">res1</span>(<span class="hljs-literal">nullptr</span>), <span class="hljs-built_in">res2</span>(<span class="hljs-literal">nullptr</span>) {
        
        <span class="hljs-comment">// å…ˆè½¬ç§»æ‰€æœ‰æƒåˆ°ä¸´æ—¶å˜é‡</span>
        Resource* temp1 = other.res1;
        Resource* temp2 = other.res2;
        
        <span class="hljs-comment">// å®‰å…¨è®¾ç½®åŸå¯¹è±¡ä¸ºç©º</span>
        other.res1 = <span class="hljs-literal">nullptr</span>;
        other.res2 = <span class="hljs-literal">nullptr</span>;
        
        <span class="hljs-comment">// æœ€åè®¾ç½®å½“å‰å¯¹è±¡</span>
        res1 = temp1;
        res2 = temp2;
    }
};
</code></pre>
<h2 data-id="heading-10">4. RAIIä¸å¼‚å¸¸å¤„ç†ç»†èŠ‚</h2>
<h3 data-id="heading-11">4.1 åŸºæœ¬çš„RAIIæ¨¡å¼</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DatabaseConnection</span> {
<span class="hljs-keyword">private</span>:
    sqlite3* connection;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">explicit</span> <span class="hljs-title">DatabaseConnection</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; dbPath)</span> 
        : connection(nullptr) {</span>
        
        <span class="hljs-comment">// å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„æ“ä½œ</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">sqlite3_open</span>(dbPath.<span class="hljs-built_in">c_str</span>(), &amp;connection) != SQLITE_OK) {
            <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">"Cannot open database"</span>);
        }
        
        <span class="hljs-comment">// å¦‚æœè¿™é‡ŒæŠ›å‡ºå¼‚å¸¸ï¼Œææ„å‡½æ•°ä¸ä¼šè¢«è°ƒç”¨ï¼</span>
        <span class="hljs-comment">// éœ€è¦ä½¿ç”¨RAIIåŒ…è£…å™¨</span>
    }
    
    ~<span class="hljs-built_in">DatabaseConnection</span>() {
        <span class="hljs-keyword">if</span> (connection) {
            <span class="hljs-built_in">sqlite3_close</span>(connection);  <span class="hljs-comment">// ä¸ä¼šæŠ›å‡ºå¼‚å¸¸</span>
        }
    }
};
</code></pre>
<h3 data-id="heading-12">4.2 æ”¹è¿›çš„RAIIå®ç°</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeDatabaseConnection</span> {
<span class="hljs-keyword">private</span>:
    <span class="hljs-comment">// ä½¿ç”¨unique_ptrè‡ªå®šä¹‰åˆ é™¤å™¨</span>
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">SqliteDeleter</span> {
        <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">operator</span><span class="hljs-params">()</span><span class="hljs-params">(sqlite3* db)</span> <span class="hljs-type">const</span> <span class="hljs-keyword">noexcept</span> </span>{
            <span class="hljs-keyword">if</span> (db) <span class="hljs-built_in">sqlite3_close</span>(db);
        }
    };
    
    std::unique_ptr&lt;sqlite3, SqliteDeleter&gt; connection;
    
    <span class="hljs-comment">// è¾…åŠ©å‡½æ•°ï¼Œåœ¨æ„é€ è¿‡ç¨‹ä¸­æ¸…ç†èµ„æº</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">cleanupOnException</span><span class="hljs-params">()</span> <span class="hljs-keyword">noexcept</span> </span>{
        connection.<span class="hljs-built_in">reset</span>();
    }
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">explicit</span> <span class="hljs-title">SafeDatabaseConnection</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; dbPath)</span> </span>{
        sqlite3* rawConnection = <span class="hljs-literal">nullptr</span>;
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">sqlite3_open</span>(dbPath.<span class="hljs-built_in">c_str</span>(), &amp;rawConnection) != SQLITE_OK) {
                <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">"Cannot open database"</span>);
            }
            
            connection.<span class="hljs-built_in">reset</span>(rawConnection);
            
            <span class="hljs-comment">// æ›´å¤šå¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„è®¾ç½®æ“ä½œ</span>
            <span class="hljs-built_in">setupDatabase</span>();
            
        } <span class="hljs-built_in">catch</span> (...) {
            <span class="hljs-comment">// å‘ç”Ÿå¼‚å¸¸æ—¶ç¡®ä¿æ¸…ç†</span>
            <span class="hljs-keyword">if</span> (rawConnection) <span class="hljs-built_in">sqlite3_close</span>(rawConnection);
            <span class="hljs-keyword">throw</span>;  <span class="hljs-comment">// é‡æ–°æŠ›å‡ºå¼‚å¸¸</span>
        }
    }
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">setupDatabase</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-comment">// å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„æ“ä½œ</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">sqlite3_exec</span>(connection.<span class="hljs-built_in">get</span>(), 
                        <span class="hljs-string">"CREATE TABLE IF NOT EXISTS..."</span>, 
                        <span class="hljs-literal">nullptr</span>, <span class="hljs-literal">nullptr</span>, <span class="hljs-literal">nullptr</span>) != SQLITE_OK) {
            <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">"Failed to setup database"</span>);
        }
    }
    
    <span class="hljs-comment">// è‡ªåŠ¨æä¾›æ­£ç¡®çš„æ‹·è´/ç§»åŠ¨è¯­ä¹‰</span>
    <span class="hljs-built_in">SafeDatabaseConnection</span>(<span class="hljs-type">const</span> SafeDatabaseConnection&amp;) = <span class="hljs-keyword">delete</span>;
    SafeDatabaseConnection&amp; <span class="hljs-keyword">operator</span>=(<span class="hljs-type">const</span> SafeDatabaseConnection&amp;) = <span class="hljs-keyword">delete</span>;
    
    <span class="hljs-built_in">SafeDatabaseConnection</span>(SafeDatabaseConnection&amp;&amp;) <span class="hljs-keyword">noexcept</span> = <span class="hljs-keyword">default</span>;
    SafeDatabaseConnection&amp; <span class="hljs-keyword">operator</span>=(SafeDatabaseConnection&amp;&amp;) <span class="hljs-keyword">noexcept</span> = <span class="hljs-keyword">default</span>;
};
</code></pre>
<h3 data-id="heading-13">4.3 å¤šé˜¶æ®µæ„é€ çš„RAII</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Transaction</span> {
<span class="hljs-keyword">private</span>:
    Database&amp; db;
    <span class="hljs-type">bool</span> committed = <span class="hljs-literal">false</span>;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">explicit</span> <span class="hljs-title">Transaction</span><span class="hljs-params">(Database&amp; dbRef)</span> 
        : db(dbRef) {</span>
        db.<span class="hljs-built_in">beginTransaction</span>();  <span class="hljs-comment">// å¯èƒ½æŠ›å‡ºå¼‚å¸¸</span>
    }
    
    <span class="hljs-comment">// æäº¤äº‹åŠ¡</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">commit</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">if</span> (!committed) {
            db.<span class="hljs-built_in">commitTransaction</span>();
            committed = <span class="hljs-literal">true</span>;
        }
    }
    
    <span class="hljs-comment">// å›æ»šäº‹åŠ¡ï¼ˆå¦‚æœæœªæäº¤ï¼‰</span>
    ~<span class="hljs-built_in">Transaction</span>() <span class="hljs-keyword">noexcept</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">if</span> (!committed) {
                db.<span class="hljs-built_in">rollbackTransaction</span>();
            }
        } <span class="hljs-built_in">catch</span> (...) {
            <span class="hljs-comment">// ææ„å‡½æ•°ä¸åº”è¯¥æŠ›å‡ºå¼‚å¸¸ï¼</span>
            <span class="hljs-comment">// è®°å½•æ—¥å¿—ï¼Œä½†ä¸èƒ½ä¼ æ’­å¼‚å¸¸</span>
            std::cerr &lt;&lt; <span class="hljs-string">"Error during rollback"</span> &lt;&lt; std::endl;
        }
    }
    
    <span class="hljs-comment">// ç¦ç”¨æ‹·è´</span>
    <span class="hljs-built_in">Transaction</span>(<span class="hljs-type">const</span> Transaction&amp;) = <span class="hljs-keyword">delete</span>;
    Transaction&amp; <span class="hljs-keyword">operator</span>=(<span class="hljs-type">const</span> Transaction&amp;) = <span class="hljs-keyword">delete</span>;
};

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">performDatabaseOperations</span><span class="hljs-params">(Database&amp; db)</span> </span>{
    <span class="hljs-function">Transaction <span class="hljs-title">trans</span><span class="hljs-params">(db)</span></span>;  <span class="hljs-comment">// RAIIå¯¹è±¡</span>
    
    <span class="hljs-comment">// ä¸€ç³»åˆ—å¯èƒ½å¤±è´¥çš„æ“ä½œ</span>
    db.<span class="hljs-built_in">execute</span>(<span class="hljs-string">"INSERT INTO ..."</span>);
    db.<span class="hljs-built_in">execute</span>(<span class="hljs-string">"UPDATE ..."</span>);
    
    trans.<span class="hljs-built_in">commit</span>();  <span class="hljs-comment">// æ˜¾å¼æäº¤</span>
    <span class="hljs-comment">// å¦‚æœå¼‚å¸¸å‘ç”Ÿï¼ŒTransactionææ„å‡½æ•°ä¼šè‡ªåŠ¨å›æ»š</span>
}
</code></pre>
<h2 data-id="heading-14">5. å®æˆ˜å»ºè®®ä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-15">5.1 å¼‚å¸¸å®‰å…¨ä»£ç ç¼–å†™åŸåˆ™</h3>
<ol>
<li><strong>ä½¿ç”¨RAIIç®¡ç†æ‰€æœ‰èµ„æº</strong></li>
<li><strong>ä¼˜å…ˆä½¿ç”¨ç°æœ‰æ ‡å‡†åº“ç»„ä»¶</strong>ï¼ˆæ™ºèƒ½æŒ‡é’ˆã€å®¹å™¨ç­‰ï¼‰</li>
<li><strong>åœ¨ä¿®æ”¹å¯¹è±¡å‰è¿›è¡Œæ‹·è´æˆ–å¤‡ä»½</strong></li>
<li><strong>ç¡®ä¿åŸºæœ¬æ“ä½œï¼ˆswapã€ç§»åŠ¨ã€ææ„ï¼‰ä¸æŠ›å‡ºå¼‚å¸¸</strong></li>
<li><strong>æŒ‰ç…§æ­£ç¡®çš„é¡ºåºæ‰§è¡Œæ“ä½œ</strong></li>
</ol>
<h3 data-id="heading-16">5.2 å¼‚å¸¸å®‰å…¨çº§åˆ«é€‰æ‹©æŒ‡å—</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DesignGuidelines</span> {
<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// 1. ææ„å‡½æ•°ï¼šå¿…é¡»æä¾›ä¸æŠ›å¼‚å¸¸ä¿è¯</span>
    ~<span class="hljs-built_in">DesignGuidelines</span>() <span class="hljs-keyword">noexcept</span> {
        <span class="hljs-comment">// æ¸…ç†èµ„æºï¼Œä½†ä¸èƒ½æŠ›å‡ºå¼‚å¸¸</span>
    }
    
    <span class="hljs-comment">// 2. ç§»åŠ¨æ“ä½œï¼šå°½é‡æä¾›ä¸æŠ›å¼‚å¸¸ä¿è¯</span>
    <span class="hljs-built_in">DesignGuidelines</span>(DesignGuidelines&amp;&amp;) <span class="hljs-keyword">noexcept</span>;
    DesignGuidelines&amp; <span class="hljs-keyword">operator</span>=(DesignGuidelines&amp;&amp;) <span class="hljs-keyword">noexcept</span>;
    
    <span class="hljs-comment">// 3. swapå‡½æ•°ï¼šå¿…é¡»æä¾›ä¸æŠ›å¼‚å¸¸ä¿è¯</span>
    <span class="hljs-function"><span class="hljs-keyword">friend</span> <span class="hljs-type">void</span> <span class="hljs-title">swap</span><span class="hljs-params">(DesignGuidelines&amp;, DesignGuidelines&amp;)</span> <span class="hljs-keyword">noexcept</span></span>;
    
    <span class="hljs-comment">// 4. å…³é”®ä¸šåŠ¡æ“ä½œï¼šæä¾›å¼ºä¿è¯</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">criticalOperation</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-comment">// ä½¿ç”¨copy-and-swapæˆ–å…¶ä»–æŠ€æœ¯</span>
    }
    
    <span class="hljs-comment">// 5. æŸ¥è¯¢æ“ä½œï¼šæä¾›ä¸æŠ›å¼‚å¸¸ä¿è¯</span>
    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">isValid</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> <span class="hljs-keyword">noexcept</span> </span>{
        <span class="hljs-comment">// ç®€å•çš„çŠ¶æ€æ£€æŸ¥</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
};
</code></pre>
<h3 data-id="heading-17">5.3 æµ‹è¯•å¼‚å¸¸å®‰å…¨æ€§</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;exception&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">TestException</span> : std::exception {};

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">testExceptionSafety</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-type">bool</span> success = <span class="hljs-literal">false</span>;
    
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// åˆ›å»ºæµ‹è¯•å¯¹è±¡</span>
        <span class="hljs-function">SafeVector <span class="hljs-title">vec</span><span class="hljs-params">(<span class="hljs-number">10</span>)</span></span>;
        
        <span class="hljs-comment">// å¼ºåˆ¶æŠ›å‡ºå¼‚å¸¸</span>
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">TestException</span>();
        
        success = <span class="hljs-literal">true</span>;
    } <span class="hljs-built_in">catch</span> (<span class="hljs-type">const</span> TestException&amp;) {
        <span class="hljs-comment">// éªŒè¯å¯¹è±¡çŠ¶æ€</span>
        std::cout &lt;&lt; <span class="hljs-string">"Exception caught. Checking object state..."</span> &lt;&lt; std::endl;
        
        <span class="hljs-comment">// åº”è¯¥èƒ½å¤Ÿæ­£å¸¸é”€æ¯å¯¹è±¡</span>
        <span class="hljs-comment">// æ²¡æœ‰èµ„æºæ³„æ¼</span>
    }
    
    <span class="hljs-keyword">if</span> (!success) {
        std::cout &lt;&lt; <span class="hljs-string">"Test passed: Strong exception safety guaranteed"</span> &lt;&lt; std::endl;
    }
}
</code></pre>
<h2 data-id="heading-18">æ€»ç»“</h2>
<p>å¼‚å¸¸å®‰å…¨æ˜¯ç°ä»£C++ç¼–ç¨‹ä¸­è‡³å…³é‡è¦ä½†åˆå¸¸è¢«å¿½è§†çš„æ–¹é¢ã€‚é€šè¿‡ç†è§£ä¸‰ç§å¼‚å¸¸å®‰å…¨ä¿è¯çš„åŒºåˆ«ï¼ŒæŒæ¡copy-and-swapç­‰æƒ¯ç”¨æ³•ï¼Œåˆç†è®¾è®¡ç§»åŠ¨æ“ä½œï¼Œå¹¶å……åˆ†åˆ©ç”¨RAIIæ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™å‡ºæ—¢å®‰å…¨åˆé«˜æ•ˆçš„ä»£ç ã€‚è®°ä½ï¼Œå¼‚å¸¸å®‰å…¨ä¸æ˜¯å¯æœ‰å¯æ— çš„ç‰¹æ€§ï¼Œè€Œæ˜¯æ„å»ºå¥å£®ã€å¯é è½¯ä»¶ç³»ç»Ÿçš„åŸºçŸ³ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[C++å¯¹è±¡ç”Ÿå‘½å‘¨æœŸä¸ææ„é¡ºåºæ·±åº¦è§£æ]]></title>    <link>https://juejin.cn/post/7580606750291181619</link>    <guid>https://juejin.cn/post/7580606750291181619</guid>    <pubDate>2025-12-07T14:35:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580606750291181619" data-draft-id="7580621397971009545" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="C++å¯¹è±¡ç”Ÿå‘½å‘¨æœŸä¸ææ„é¡ºåºæ·±åº¦è§£æ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-07T14:35:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç äº‹æ¼«è°ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/1972974802965230"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            C++å¯¹è±¡ç”Ÿå‘½å‘¨æœŸä¸ææ„é¡ºåºæ·±åº¦è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1972974802965230/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç äº‹æ¼«è°ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T14:35:44.000Z" title="Sun Dec 07 2025 14:35:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€å…¨å±€/é™æ€å¯¹è±¡çš„æ„é€ ä¸ææ„æ—¶æœº</h2>
<h3 data-id="heading-1">æ„é€ é¡ºåºï¼šè·¨ç¼–è¯‘å•å…ƒçš„æŒ‘æˆ˜</h3>
<p>å…¨å±€å¯¹è±¡å’Œé™æ€å¯¹è±¡çš„æ„é€ é¡ºåºåœ¨C++æ ‡å‡†ä¸­<strong>æ²¡æœ‰æ˜ç¡®å®šä¹‰</strong>ï¼Œç‰¹åˆ«æ˜¯å¯¹äºä½äºä¸åŒç¼–è¯‘å•å…ƒä¸­çš„å¯¹è±¡ã€‚è¿™å¯èƒ½å¯¼è‡´å±é™©çš„åˆå§‹åŒ–ä¾èµ–é—®é¢˜ã€‚</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// file1.cpp</span>
<span class="hljs-keyword">extern</span> <span class="hljs-type">int</span> global_from_file2;
<span class="hljs-type">int</span> global1 = global_from_file2 + <span class="hljs-number">1</span>;  <span class="hljs-comment">// å±é™©ï¼å¯èƒ½ä½¿ç”¨æœªåˆå§‹åŒ–çš„å€¼</span>

<span class="hljs-comment">// file2.cpp</span>
<span class="hljs-type">int</span> global_from_file2 = <span class="hljs-number">42</span>;
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong> ä½¿ç”¨å‡½æ•°å±€éƒ¨é™æ€å˜é‡ï¼ˆMeyer's Singletonæ¨¡å¼ï¼‰</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function"><span class="hljs-type">int</span>&amp; <span class="hljs-title">get_global</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-type">static</span> <span class="hljs-type">int</span> instance = <span class="hljs-number">42</span>;  <span class="hljs-comment">// çº¿ç¨‹å®‰å…¨ï¼ˆC++11èµ·ï¼‰</span>
    <span class="hljs-keyword">return</span> instance;
}
</code></pre>
<h3 data-id="heading-2">ææ„é¡ºåºï¼šåå‘ä¾èµ–é£é™©</h3>
<p>ææ„é¡ºåºå¤§è‡´æ˜¯æ„é€ é¡ºåºçš„é€†åºï¼Œä½†ç”±äºæ„é€ é¡ºåºä¸ç¡®å®šï¼Œææ„æ—¶å¯èƒ½å‡ºç°"å·²é”€æ¯å¯¹è±¡è¢«å¼•ç”¨"çš„é—®é¢˜ã€‚</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Logger</span> {
    ~<span class="hljs-built_in">Logger</span>() { std::cout &lt;&lt; <span class="hljs-string">"Logger destroyed\n"</span>; }
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">log</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; msg)</span> </span>{ <span class="hljs-comment">/* ... */</span> }
};

Logger logger;  <span class="hljs-comment">// å…¨å±€å¯¹è±¡</span>

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Database</span> {
    ~<span class="hljs-built_in">Database</span>() {
        logger.<span class="hljs-built_in">log</span>(<span class="hljs-string">"Database cleaning up"</span>);  <span class="hljs-comment">// å±é™©ï¼loggerå¯èƒ½å·²é”€æ¯</span>
    }
};

Database db;  <span class="hljs-comment">// å¦ä¸€ä¸ªå…¨å±€å¯¹è±¡</span>
</code></pre>
<p><strong>æœ€ä½³å®è·µï¼š</strong> åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸­ï¼Œå¯ä»¥ç¡®ä¿ä¾èµ–å…³ç³»ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function">Logger&amp; <span class="hljs-title">get_logger</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-type">static</span> Logger instance;
    <span class="hljs-keyword">return</span> instance;
}

<span class="hljs-function">Database&amp; <span class="hljs-title">get_database</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-type">static</span> Database instance;
    <span class="hljs-keyword">return</span> instance;
}
</code></pre>
<h2 data-id="heading-3">äºŒã€æˆå‘˜å˜é‡åˆå§‹åŒ–é¡ºåº</h2>
<h3 data-id="heading-4">å£°æ˜é¡ºåºçš„ç»å¯¹ä¼˜å…ˆçº§</h3>
<p>æˆå‘˜å˜é‡çš„åˆå§‹åŒ–é¡ºåº<strong>åªå–å†³äºå®ƒä»¬åœ¨ç±»ä¸­å£°æ˜çš„é¡ºåº</strong>ï¼Œè€Œä¸æ˜¯åˆå§‹åŒ–åˆ—è¡¨ä¸­çš„é¡ºåºã€‚</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Example</span> {
    <span class="hljs-type">int</span> a;
    <span class="hljs-type">int</span> b;
    <span class="hljs-type">int</span> c;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// è­¦å‘Šï¼šåˆå§‹åŒ–åˆ—è¡¨é¡ºåºä¸å£°æ˜é¡ºåºä¸åŒï¼</span>
    <span class="hljs-built_in">Example</span>(<span class="hljs-type">int</span> val) : <span class="hljs-built_in">c</span>(val), <span class="hljs-built_in">b</span>(c + <span class="hljs-number">1</span>), <span class="hljs-built_in">a</span>(b + <span class="hljs-number">1</span>) {
        <span class="hljs-comment">// å®é™…åˆå§‹åŒ–é¡ºåºï¼ša â†’ b â†’ c</span>
        <span class="hljs-comment">// a = æœªå®šä¹‰ï¼ˆä½¿ç”¨æœªåˆå§‹åŒ–çš„bï¼‰</span>
        <span class="hljs-comment">// b = æœªå®šä¹‰ï¼ˆä½¿ç”¨æœªåˆå§‹åŒ–çš„cï¼‰</span>
        <span class="hljs-comment">// c = val</span>
    }
};
</code></pre>
<p><strong>ç¼–è¯‘å™¨è­¦å‘Šï¼š</strong> ç°ä»£ç¼–è¯‘å™¨é€šå¸¸ä¼šè­¦å‘Šè¿™ç§é¡ºåºä¸ä¸€è‡´ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">warning:</span> field <span class="hljs-comment">'b' will be initialized after field 'a'</span>
<span class="hljs-symbol">warning:</span> field <span class="hljs-comment">'c' will be initialized after field 'b'</span>
</code></pre>
<h3 data-id="heading-5">æ­£ç¡®æ¨¡å¼ï¼šéµå¾ªå£°æ˜é¡ºåº</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ProperExample</span> {
    std::string name;
    <span class="hljs-type">int</span> id;
    std::vector&lt;<span class="hljs-type">double</span>&gt; data;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">ProperExample</span>(<span class="hljs-type">const</span> std::string&amp; n, <span class="hljs-type">int</span> i, std::initializer_list&lt;<span class="hljs-type">double</span>&gt; d)
        : <span class="hljs-built_in">name</span>(n)      <span class="hljs-comment">// 1. ç¬¬ä¸€ä¸ªå£°æ˜</span>
        , <span class="hljs-built_in">id</span>(i)        <span class="hljs-comment">// 2. ç¬¬äºŒä¸ªå£°æ˜  </span>
        , <span class="hljs-built_in">data</span>(d) {    <span class="hljs-comment">// 3. ç¬¬ä¸‰ä¸ªå£°æ˜</span>
        <span class="hljs-comment">// å®‰å…¨ï¼šåˆå§‹åŒ–é¡ºåºä¸å£°æ˜é¡ºåºä¸€è‡´</span>
    }
};
</code></pre>
<h3 data-id="heading-6">ä¾èµ–åˆå§‹åŒ–è§£å†³æ–¹æ¡ˆ</h3>
<p>å½“æˆå‘˜å˜é‡é—´å­˜åœ¨ä¾èµ–å…³ç³»æ—¶ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DatabaseConnection</span> {
    std::string connection_string;
    ConnectionHandle handle;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">DatabaseConnection</span>(<span class="hljs-type">const</span> std::string&amp; conn_str)
        : <span class="hljs-built_in">connection_string</span>(conn_str)
        , <span class="hljs-built_in">handle</span>(<span class="hljs-built_in">create_handle</span>(connection_string)) {  <span class="hljs-comment">// ä¾èµ–connection_string</span>
    }
    
<span class="hljs-keyword">private</span>:
    <span class="hljs-function"><span class="hljs-type">static</span> ConnectionHandle <span class="hljs-title">create_handle</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; str)</span></span>;
};
</code></pre>
<h2 data-id="heading-7">ä¸‰ã€ä¸´æ—¶å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå»¶é•¿</h2>
<h3 data-id="heading-8">åŸºæœ¬è§„åˆ™ï¼šç»‘å®šåˆ°constå¼•ç”¨</h3>
<p>å½“ä¸´æ—¶å¯¹è±¡ç»‘å®šåˆ°constå¼•ç”¨æ—¶ï¼Œå…¶ç”Ÿå‘½å‘¨æœŸä¼šå»¶é•¿åˆ°è¯¥å¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸç»“æŸã€‚</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function">std::string <span class="hljs-title">create_string</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">"Hello, World!"</span>;
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">example</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-type">const</span> std::string&amp; str = <span class="hljs-built_in">create_string</span>();  <span class="hljs-comment">// ä¸´æ—¶å¯¹è±¡ç”Ÿå‘½å‘¨æœŸå»¶é•¿</span>
    std::cout &lt;&lt; str &lt;&lt; <span class="hljs-string">"\n"</span>;                  <span class="hljs-comment">// å®‰å…¨ä½¿ç”¨</span>
    
    <span class="hljs-comment">// å½“strç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œä¸´æ—¶å¯¹è±¡æ‰ä¼šè¢«é”€æ¯</span>
}
</code></pre>
<h3 data-id="heading-9">é‡è¦é™åˆ¶å’Œç»†èŠ‚</h3>
<ol>
<li><strong>ä»…é€‚ç”¨äºconstå¼•ç”¨ï¼ˆC++98/03ï¼‰æˆ–å³å€¼å¼•ç”¨ï¼ˆC++11+ï¼‰</strong></li>
</ol>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// C++11èµ·ï¼Œä¹Ÿå¯ä»¥ç»‘å®šåˆ°å³å€¼å¼•ç”¨</span>
std::string&amp;&amp; rref = <span class="hljs-built_in">create_string</span>();  <span class="hljs-comment">// åŒæ ·å»¶é•¿ç”Ÿå‘½å‘¨æœŸ</span>

<span class="hljs-comment">// éconstå·¦å€¼å¼•ç”¨ä¸è¡Œ</span>
<span class="hljs-comment">// std::string&amp; ref = create_string();  // ç¼–è¯‘é”™è¯¯</span>
</code></pre>
<ol start="2">
<li><strong>ç”Ÿå‘½å‘¨æœŸé“¾å¼å»¶é•¿</strong></li>
</ol>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function"><span class="hljs-type">const</span> std::string&amp; <span class="hljs-title">func</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">"Temporary"</span>;  <span class="hljs-comment">// ä¸´æ—¶å¯¹è±¡ç»‘å®šåˆ°è¿”å›çš„å¼•ç”¨</span>
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-type">const</span> std::string&amp; ref = <span class="hljs-built_in">func</span>();  <span class="hljs-comment">// ç”Ÿå‘½å‘¨æœŸè¿›ä¸€æ­¥å»¶é•¿</span>
    <span class="hljs-comment">// refåœ¨test()ç»“æŸæ—¶é”€æ¯</span>
}
</code></pre>
<ol start="3">
<li><strong>ä¸é€‚ç”¨äºæˆå‘˜è®¿é—®</strong></li>
</ol>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Value</span> {
    <span class="hljs-type">int</span> data = <span class="hljs-number">42</span>;
};

<span class="hljs-function">Value <span class="hljs-title">get_value</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">return</span> {}; }

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">example</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-type">const</span> Value&amp; val = <span class="hljs-built_in">get_value</span>();  <span class="hljs-comment">// Valueå¯¹è±¡ç”Ÿå‘½å‘¨æœŸå»¶é•¿</span>
    <span class="hljs-type">int</span> x = val.data;                <span class="hljs-comment">// å®‰å…¨</span>
    
    <span class="hljs-comment">// ä½†æˆå‘˜è®¿é—®äº§ç”Ÿçš„ä¸´æ—¶å¯¹è±¡ä¸å»¶é•¿</span>
    <span class="hljs-type">const</span> <span class="hljs-type">int</span>&amp; bad = <span class="hljs-built_in">get_value</span>().data;  <span class="hljs-comment">// å±é™©ï¼Valueä¸´æ—¶å¯¹è±¡ç«‹å³é”€æ¯</span>
}
</code></pre>
<h3 data-id="heading-10">å®é™…åº”ç”¨åœºæ™¯</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// åœºæ™¯1ï¼šé¿å…æ‹·è´ï¼Œæé«˜æ€§èƒ½</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">process_string</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; str)</span></span>;

<span class="hljs-built_in">process_string</span>(<span class="hljs-string">"Temporary string"</span>);  <span class="hljs-comment">// æ— éœ€åˆ›å»ºå‘½åå˜é‡</span>

<span class="hljs-comment">// åœºæ™¯2ï¼šrange-based forå¾ªç¯</span>
<span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span>&amp; item : <span class="hljs-built_in">get_temporary_vector</span>()) {
    <span class="hljs-comment">// ä¸´æ—¶vectorçš„ç”Ÿå‘½å‘¨æœŸå»¶é•¿åˆ°æ•´ä¸ªå¾ªç¯</span>
}

<span class="hljs-comment">// åœºæ™¯3ï¼šå‡½æ•°å¼ç¼–ç¨‹</span>
<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span>&amp; result = std::<span class="hljs-built_in">accumulate</span>(
    data.<span class="hljs-built_in">begin</span>(), 
    data.<span class="hljs-built_in">end</span>(), 
    <span class="hljs-number">0</span>,  <span class="hljs-comment">// ä¸´æ—¶intå»¶é•¿ç”Ÿå‘½å‘¨æœŸ</span>
    [](<span class="hljs-type">int</span> acc, <span class="hljs-type">int</span> val) { <span class="hljs-keyword">return</span> acc + val; }
);
</code></pre>
<h2 data-id="heading-11">å››ã€std::launderåœ¨å¯¹è±¡é‡ç”¨ä¸­çš„å®é™…åº”ç”¨</h2>
<h3 data-id="heading-12">é—®é¢˜èƒŒæ™¯ï¼šæŒ‡é’ˆä¼˜åŒ–ä¸åˆ«åé—®é¢˜</h3>
<p>ç¼–è¯‘å™¨å¯èƒ½åŸºäº"å¯¹è±¡ç”Ÿå‘½å‘¨æœŸ"å‡è®¾è¿›è¡Œä¼˜åŒ–ï¼Œå½“æˆ‘ä»¬åœ¨ç›¸åŒå†…å­˜ä½ç½®æ„é€ æ–°å¯¹è±¡æ—¶ï¼Œå¯èƒ½å¯¼è‡´æœªå®šä¹‰è¡Œä¸ºã€‚</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">X</span> { <span class="hljs-type">int</span> x; };
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Y</span> { <span class="hljs-type">int</span> y; };

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">problematic_example</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">alignas</span>(<span class="hljs-built_in">alignof</span>(Y)) <span class="hljs-type">char</span> buffer[<span class="hljs-built_in">sizeof</span>(Y)];
    
    X* x = <span class="hljs-built_in">new</span> (buffer) X{<span class="hljs-number">10</span>};
    x-&gt;~<span class="hljs-built_in">X</span>();
    
    Y* y = <span class="hljs-built_in">new</span> (buffer) Y{<span class="hljs-number">20</span>};
    
    <span class="hljs-comment">// ç¼–è¯‘å™¨å¯èƒ½è®¤ä¸ºxæŒ‡å‘å·²é”€æ¯çš„å¯¹è±¡</span>
    <span class="hljs-comment">// å®é™…ä¸Šxå’ŒyæŒ‡å‘ç›¸åŒå†…å­˜ï¼Œä½†ç±»å‹ä¸åŒ</span>
}
</code></pre>
<h3 data-id="heading-13">std::launderçš„ä½œç”¨</h3>
<p><code>std::launder</code>é€šçŸ¥ç¼–è¯‘å™¨ï¼šé€šè¿‡è¿”å›çš„æŒ‡é’ˆè®¿é—®å†…å­˜æ—¶ï¼Œåº”è¯¥å¿½ç•¥ä¹‹å‰çš„ç±»å‹ä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;new&gt;</span>  <span class="hljs-comment">// std::launder</span></span>

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">X</span> { 
    <span class="hljs-type">const</span> <span class="hljs-type">int</span> x;  <span class="hljs-comment">// constæˆå‘˜ï¼éå¸¸é‡è¦</span>
    <span class="hljs-built_in">X</span>(<span class="hljs-type">int</span> val) : <span class="hljs-built_in">x</span>(val) {}
};

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Y</span> {
    <span class="hljs-type">int</span> y;
    <span class="hljs-built_in">Y</span>(<span class="hljs-type">int</span> val) : <span class="hljs-built_in">y</span>(val) {}
};

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">correct_example</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">alignas</span>(<span class="hljs-built_in">alignof</span>(Y)) <span class="hljs-type">char</span> buffer[<span class="hljs-built_in">sizeof</span>(Y)];
    
    X* x = <span class="hljs-built_in">new</span> (buffer) X{<span class="hljs-number">10</span>};
    
    <span class="hljs-comment">// é‡ç”¨å†…å­˜ï¼šå…ˆé”€æ¯æ—§å¯¹è±¡</span>
    x-&gt;~<span class="hljs-built_in">X</span>();
    
    <span class="hljs-comment">// æ„é€ æ–°å¯¹è±¡</span>
    Y* y = <span class="hljs-built_in">new</span> (buffer) Y{<span class="hljs-number">20</span>};
    
    <span class="hljs-comment">// ä½¿ç”¨std::launderè·å–æ­£ç¡®æŒ‡é’ˆ</span>
    X* laundered_x = std::<span class="hljs-built_in">launder</span>(<span class="hljs-built_in">reinterpret_cast</span>&lt;X*&gt;(buffer));
    <span class="hljs-comment">// æ³¨æ„ï¼šä¸èƒ½é€šè¿‡laundered_xè®¿é—®ï¼Œå› ä¸ºXå¯¹è±¡å·²é”€æ¯</span>
    
    <span class="hljs-comment">// æ­£ç¡®ï¼šé€šè¿‡yè®¿é—®</span>
    std::cout &lt;&lt; y-&gt;y &lt;&lt; <span class="hljs-string">"\n"</span>;
}
</code></pre>
<h3 data-id="heading-14">å¿…é¡»ä½¿ç”¨std::launderçš„åœºæ™¯</h3>
<ol>
<li><strong>å¯¹è±¡æœ‰constæˆ–å¼•ç”¨æˆå‘˜</strong></li>
</ol>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ConstObject</span> {
    <span class="hljs-type">const</span> <span class="hljs-type">int</span> id;
    <span class="hljs-built_in">ConstObject</span>(<span class="hljs-type">int</span> i) : <span class="hljs-built_in">id</span>(i) {}
};

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">reuse_const_memory</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">alignas</span>(ConstObject) <span class="hljs-type">char</span> buf[<span class="hljs-built_in">sizeof</span>(ConstObject)];
    
    <span class="hljs-keyword">auto</span>* obj1 = <span class="hljs-built_in">new</span> (buf) ConstObject{<span class="hljs-number">1</span>};
    obj1-&gt;~<span class="hljs-built_in">ConstObject</span>();
    
    <span class="hljs-keyword">auto</span>* obj2 = <span class="hljs-built_in">new</span> (buf) ConstObject{<span class="hljs-number">2</span>};
    
    <span class="hljs-comment">// å¿…é¡»ä½¿ç”¨launderï¼Œå› ä¸ºconstæˆå‘˜å¯èƒ½è¢«ç¼“å­˜</span>
    <span class="hljs-keyword">auto</span>* ptr = std::<span class="hljs-built_in">launder</span>(<span class="hljs-built_in">reinterpret_cast</span>&lt;ConstObject*&gt;(buf));
    std::cout &lt;&lt; ptr-&gt;id &lt;&lt; <span class="hljs-string">"\n"</span>;  <span class="hljs-comment">// æ­£ç¡®ï¼šè¾“å‡º2</span>
}
</code></pre>
<ol start="2">
<li><strong>å¯¹è±¡æœ‰è™šå‡½æ•°</strong></li>
</ol>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Base</span> {
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span> </span>{ std::cout &lt;&lt; <span class="hljs-string">"Base\n"</span>; }
    <span class="hljs-keyword">virtual</span> ~<span class="hljs-built_in">Base</span>() = <span class="hljs-keyword">default</span>;
};

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Derived</span> : Base {
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">()</span> <span class="hljs-keyword">override</span> </span>{ std::cout &lt;&lt; <span class="hljs-string">"Derived\n"</span>; }
};

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">reuse_virtual_memory</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">alignas</span>(Base) <span class="hljs-type">char</span> buffer[<span class="hljs-built_in">sizeof</span>(Derived)];
    
    Base* b = <span class="hljs-built_in">new</span> (buffer) Derived;
    b-&gt;<span class="hljs-built_in">foo</span>();  <span class="hljs-comment">// è¾“å‡º"Derived"</span>
    
    b-&gt;~<span class="hljs-built_in">Base</span>();
    
    <span class="hljs-keyword">new</span> (buffer) Base;
    
    <span class="hljs-comment">// éœ€è¦launderæ¥æ­£ç¡®è®¿é—®è™šè¡¨</span>
    Base* laundered = std::<span class="hljs-built_in">launder</span>(<span class="hljs-built_in">reinterpret_cast</span>&lt;Base*&gt;(buffer));
    laundered-&gt;<span class="hljs-built_in">foo</span>();  <span class="hljs-comment">// è¾“å‡º"Base"</span>
}
</code></pre>
<ol start="3">
<li><strong>æŒ‡å‘å·²é”€æ¯å¯¹è±¡çš„æŒ‡é’ˆ</strong></li>
</ol>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T, <span class="hljs-keyword">typename</span>... Args&gt;
T* <span class="hljs-title">reconstruct</span><span class="hljs-params">(<span class="hljs-type">void</span>* memory, Args&amp;&amp;... args)</span> </span>{
    T* old = <span class="hljs-built_in">static_cast</span>&lt;T*&gt;(memory);
    old-&gt;~<span class="hljs-built_in">T</span>();  <span class="hljs-comment">// æ˜¾å¼ææ„</span>
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">new</span> (memory) <span class="hljs-built_in">T</span>(std::forward&lt;Args&gt;(args)...);
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">example</span><span class="hljs-params">()</span> </span>{
    std::string* str = <span class="hljs-keyword">new</span> std::<span class="hljs-built_in">string</span>(<span class="hljs-string">"Hello"</span>);
    
    <span class="hljs-comment">// é‡ç”¨å†…å­˜</span>
    std::string* new_str = <span class="hljs-built_in">reconstruct</span>&lt;std::string&gt;(str, <span class="hljs-string">"World"</span>);
    
    <span class="hljs-comment">// æ—§æŒ‡é’ˆsträ¸èƒ½ç›´æ¥ä½¿ç”¨</span>
    <span class="hljs-comment">// std::cout &lt;&lt; *str;  // æœªå®šä¹‰è¡Œä¸ºï¼</span>
    
    <span class="hljs-comment">// éœ€è¦launder</span>
    std::string* laundered = std::<span class="hljs-built_in">launder</span>(str);
    std::cout &lt;&lt; *laundered &lt;&lt; <span class="hljs-string">"\n"</span>;  <span class="hljs-comment">// æ­£ç¡®ï¼š"World"</span>
    
    <span class="hljs-keyword">delete</span> new_str;  <span class="hljs-comment">// æˆ– laundered</span>
}
</code></pre>
<h3 data-id="heading-15">ä¸éœ€è¦std::launderçš„æƒ…å†µ</h3>
<ol>
<li><strong>trivially destructibleç±»å‹</strong></li>
<li><strong>ç›¸åŒç±»å‹å¯¹è±¡çš„replacement new</strong></li>
<li><strong>å†…å­˜ä»æœªåŒ…å«è¿‡å¯¹è±¡</strong></li>
</ol>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Trivial</span> {
    <span class="hljs-type">int</span> x;
};

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">trivial_example</span><span class="hljs-params">()</span> </span>{
    Trivial t{<span class="hljs-number">1</span>};
    t.~<span class="hljs-built_in">Trivial</span>();  <span class="hljs-comment">// æ˜¾å¼ææ„ï¼ˆå…è®¸ä½†é€šå¸¸ä¸å¿…è¦ï¼‰</span>
    
    <span class="hljs-keyword">new</span> (&amp;t) Trivial{<span class="hljs-number">2</span>};
    
    <span class="hljs-comment">// å¯ä»¥ç›´æ¥è®¿é—®ï¼Œå› ä¸ºTrivialæ˜¯trivially destructible</span>
    std::cout &lt;&lt; t.x &lt;&lt; <span class="hljs-string">"\n"</span>;  <span class="hljs-comment">// æ­£ç¡®ï¼šè¾“å‡º2</span>
}
</code></pre>
<h3 data-id="heading-16">å®é™…å·¥ç¨‹åº”ç”¨</h3>
<p><strong>å†…å­˜æ± å®ç°ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt;
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MemoryPool</span> {
    <span class="hljs-keyword">union</span> <span class="hljs-title class_">Node</span> {
        T object;
        Node* next;
        <span class="hljs-built_in">Node</span>() : <span class="hljs-built_in">next</span>(<span class="hljs-literal">nullptr</span>) {}
        ~<span class="hljs-built_in">Node</span>() {}
    };
    
    Node* free_list = <span class="hljs-literal">nullptr</span>;
    std::vector&lt;std::unique_ptr&lt;Node[]&gt;&gt; blocks;
    
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span>... Args&gt;
    T* <span class="hljs-title">construct</span><span class="hljs-params">(Args&amp;&amp;... args)</span> </span>{
        <span class="hljs-keyword">if</span> (!free_list) {
            <span class="hljs-built_in">allocate_block</span>();
        }
        
        Node* node = free_list;
        free_list = free_list-&gt;next;
        
        <span class="hljs-comment">// é‡ç”¨å†…å­˜ï¼šä½¿ç”¨launderç¡®ä¿æ­£ç¡®æ€§</span>
        T* obj = <span class="hljs-built_in">new</span> (&amp;node-&gt;object) <span class="hljs-built_in">T</span>(std::forward&lt;Args&gt;(args)...);
        <span class="hljs-keyword">return</span> std::<span class="hljs-built_in">launder</span>(obj);
    }
    
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">destroy</span><span class="hljs-params">(T* ptr)</span> </span>{
        <span class="hljs-keyword">if</span> (!ptr) <span class="hljs-keyword">return</span>;
        
        ptr-&gt;~<span class="hljs-built_in">T</span>();
        
        Node* node = <span class="hljs-built_in">reinterpret_cast</span>&lt;Node*&gt;(
            <span class="hljs-built_in">reinterpret_cast</span>&lt;<span class="hljs-type">char</span>*&gt;(ptr) - <span class="hljs-built_in">offsetof</span>(Node, object)
        );
        
        node-&gt;next = free_list;
        free_list = node;
    }
    
<span class="hljs-keyword">private</span>:
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">allocate_block</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">constexpr</span> <span class="hljs-type">size_t</span> BLOCK_SIZE = <span class="hljs-number">64</span>;
        <span class="hljs-keyword">auto</span> block = std::<span class="hljs-built_in">make_unique</span>&lt;Node[]&gt;(BLOCK_SIZE);
        
        <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; BLOCK_SIZE; ++i) {
            block[i].next = free_list;
            free_list = &amp;block[i];
        }
        
        blocks.<span class="hljs-built_in">push_back</span>(std::<span class="hljs-built_in">move</span>(block));
    }
};
</code></pre>
<h2 data-id="heading-17">äº”ã€æœ€ä½³å®è·µæ€»ç»“</h2>
<ol>
<li>
<p><strong>å…¨å±€/é™æ€å¯¹è±¡</strong></p>
<ul>
<li>é¿å…è·¨ç¼–è¯‘å•å…ƒä¾èµ–</li>
<li>ä½¿ç”¨å±€éƒ¨é™æ€å˜é‡ä¿è¯åˆå§‹åŒ–é¡ºåº</li>
<li>æ³¨æ„ææ„é¡ºåºåå‘ä¾èµ–</li>
</ul>
</li>
<li>
<p><strong>æˆå‘˜åˆå§‹åŒ–</strong></p>
<ul>
<li>ä¸¥æ ¼æŒ‰ç…§å£°æ˜é¡ºåºç¼–å†™åˆå§‹åŒ–åˆ—è¡¨</li>
<li>å¯¹æœ‰ä¾èµ–å…³ç³»çš„æˆå‘˜ç‰¹åˆ«å°å¿ƒ</li>
<li>ä½¿ç”¨å‡½æ•°å¤„ç†å¤æ‚åˆå§‹åŒ–é€»è¾‘</li>
</ul>
</li>
<li>
<p><strong>ä¸´æ—¶å¯¹è±¡ç”Ÿå‘½å‘¨æœŸ</strong></p>
<ul>
<li>åˆ©ç”¨constå¼•ç”¨å»¶é•¿ä¸´æ—¶å¯¹è±¡ç”Ÿå‘½å‘¨æœŸ</li>
<li>æ³¨æ„ä¸é€‚ç”¨äºæˆå‘˜è®¿é—®äº§ç”Ÿçš„ä¸´æ—¶å¯¹è±¡</li>
<li>å³å€¼å¼•ç”¨åŒæ ·æœ‰ç”Ÿå‘½å‘¨æœŸå»¶é•¿æ•ˆæœ</li>
</ul>
</li>
<li>
<p><strong>å¯¹è±¡é‡ç”¨ä¸std::launder</strong></p>
<ul>
<li>æœ‰const/å¼•ç”¨æˆå‘˜æˆ–è™šå‡½æ•°æ—¶å¿…é¡»ä½¿ç”¨</li>
<li>trivialç±»å‹é€šå¸¸ä¸éœ€è¦</li>
<li>åœ¨å†…å­˜æ± ã€è‡ªå®šä¹‰åˆ†é…å™¨ç­‰åœºæ™¯ç‰¹åˆ«é‡è¦</li>
<li>å§‹ç»ˆä¼˜å…ˆè€ƒè™‘æ›´å®‰å…¨çš„æ›¿ä»£æ–¹æ¡ˆ</li>
</ul>
</li>
</ol>
<p>é€šè¿‡æ·±å…¥ç†è§£è¿™äº›C++å¯¹è±¡ç”Ÿå‘½å‘¨æœŸå’Œææ„é¡ºåºçš„ç»†èŠ‚ï¼Œå¯ä»¥ç¼–å†™å‡ºæ›´å®‰å…¨ã€æ›´é«˜æ•ˆçš„ä»£ç ï¼Œé¿å…æ½œåœ¨çš„å†…å­˜ç®¡ç†å’Œå¯¹è±¡ç”Ÿå‘½å‘¨æœŸé—®é¢˜ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å°ç™½ & ç¨‹åºå‘˜é€Ÿçœ‹ï¼å¿«é€Ÿå…¥è¡Œå¤§æ¨¡å‹åº”ç”¨å¼€å‘çš„å®Œæ•´å®æˆ˜æŒ‡å—ï¼Œå»ºè®®æ”¶è—]]></title>    <link>https://juejin.cn/post/7580592190021353506</link>    <guid>https://juejin.cn/post/7580592190021353506</guid>    <pubDate>2025-12-07T14:35:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580592190021353506" data-draft-id="7580251192330764334" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å°ç™½ &amp; ç¨‹åºå‘˜é€Ÿçœ‹ï¼å¿«é€Ÿå…¥è¡Œå¤§æ¨¡å‹åº”ç”¨å¼€å‘çš„å®Œæ•´å®æˆ˜æŒ‡å—ï¼Œå»ºè®®æ”¶è—"/> <meta itemprop="keywords" content="Agent,LLM,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-07T14:35:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AIå¤§æ¨¡å‹"/> <meta itemprop="url" content="https://juejin.cn/user/3817967696221534"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å°ç™½ &amp; ç¨‹åºå‘˜é€Ÿçœ‹ï¼å¿«é€Ÿå…¥è¡Œå¤§æ¨¡å‹åº”ç”¨å¼€å‘çš„å®Œæ•´å®æˆ˜æŒ‡å—ï¼Œå»ºè®®æ”¶è—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3817967696221534/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AIå¤§æ¨¡å‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T14:35:30.000Z" title="Sun Dec 07 2025 14:35:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote>
<p>åœ¨äººå·¥æ™ºèƒ½æŠ€æœ¯é£é€Ÿè¿­ä»£çš„å½“ä¸‹ï¼Œå¤§è¯­è¨€æ¨¡å‹ï¼ˆå¦‚ChatGPTã€Claudeã€æ–‡å¿ƒä¸€è¨€ç­‰ï¼‰æ—©å·²è·³å‡ºç§‘ç ”å®éªŒå®¤çš„èŒƒç•´ï¼Œæˆä¸ºæ™®é€šå¼€å‘è€…è§¦æ‰‹å¯åŠçš„æŠ€æœ¯å·¥å…·ã€‚éšç€AIæµªæ½®çš„å¸­å·ï¼Œè¶Šæ¥è¶Šå¤šèŒåœºäººæ¸´æœ›å€ŸåŠ¿è½¬å‹ï¼Œå°¤å…¶æ˜¯åˆæ¬¡æ¥è§¦AIé¢†åŸŸçš„æ–°æ‰‹ï¼Œå¸¸å¸¸åœ¨çŸ¥ä¹ã€CSDNã€æ˜é‡‘ç­‰æŠ€æœ¯ç¤¾åŒºé¢‘ç¹æé—®ï¼šâ€œæ€æ ·æ‰èƒ½å¿«é€Ÿè¸å…¥å¤§æ¨¡å‹åº”ç”¨å¼€å‘é¢†åŸŸï¼Ÿâ€</p>
<p>æœ¬æ–‡å°†ä»è¡Œä¸šè¶‹åŠ¿ã€è®¤çŸ¥å‡†å¤‡ã€å­¦ä¹ é˜¶æ®µã€å·¥å…·é€‰å‹ã€å®æˆ˜æ¡ˆä¾‹äº”ä¸ªç»´åº¦ï¼Œä¸ºä½ æ‰“é€ ä¸€æ¡å¯è½åœ°ã€æ˜“æ‰§è¡Œçš„å…¥é—¨è·¯çº¿ã€‚æ— è®ºä½ æ˜¯é›¶åŸºç¡€çš„èŒåœºæ–°äººã€æƒ³è·¨ç•Œçš„ä¼ ç»Ÿç¨‹åºå‘˜ï¼Œè¿˜æ˜¯è®¡åˆ’å¸ƒå±€AIèµ›é“çš„åˆ›ä¸šè€…ï¼Œéƒ½èƒ½é€šè¿‡è¿™ä»½æŒ‡å—ç†æ¸…æ€è·¯ã€æ‰¾å‡†æ–¹å‘ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ä¸ºä½•æ­¤åˆ»æ˜¯å…¥è¡Œå¤§æ¨¡å‹åº”ç”¨å¼€å‘çš„æœ€ä½³æ—¶æœºï¼Ÿ</h2>
<p>è‹¥è¯´ç§»åŠ¨äº’è”ç½‘å¼€å¯äº†è¿‡å»åå¹´çš„æ•°å­—çº¢åˆ©ï¼Œé‚£ä¹ˆå¤§æ¨¡å‹æ— ç–‘å°†æˆä¸ºæœªæ¥åå¹´ç§‘æŠ€é¢†åŸŸçš„â€œæ ¸å¿ƒå¼•æ“â€ã€‚ä»OpenAIã€Googleã€Metaç­‰å›½é™…ç§‘æŠ€å·¨å¤´ï¼Œåˆ°ç™¾åº¦ã€é˜¿é‡Œã€æ™ºè°±ç­‰å›½å†…ä¼ä¸šï¼Œéƒ½åœ¨æŒç»­åŠ å¤§å¯¹å¤§æ¨¡å‹ç”Ÿæ€çš„æŠ•å…¥ï¼›ä¸æ­¤åŒæ—¶ï¼Œå…¨çƒæ•°ç™¾å®¶åˆåˆ›å…¬å¸å›´ç»•â€œå¤§æ¨¡å‹+å‚ç›´åœºæ™¯â€ä¸æ–­æ¢ç´¢ï¼ŒåŒ»ç–—é—®è¯Šã€æ™ºèƒ½æ•™è‚²ã€ä¼ä¸šå®¢æœç­‰é¢†åŸŸçš„åˆ›æ–°åº”ç”¨å±‚å‡ºä¸ç©·ã€‚</p>
<p>å¯¹æ™®é€šå¼€å‘è€…è€Œè¨€ï¼Œç´§è·Ÿè¿™ä¸€è¶‹åŠ¿çš„ç†ç”±ååˆ†æ˜ç¡®ï¼š</p>
<p>å°±ä¸šç«äº‰åŠ›å¼ºï¼šç›®å‰å¸‚åœºä¸Šæ‡‚å¤§æ¨¡å‹åº”ç”¨å¼€å‘çš„å·¥ç¨‹å¸ˆç¼ºå£å·¨å¤§ï¼Œç›¸å…³å²—ä½å¹´è–ªæ™®éæ¯”ä¼ ç»Ÿå¼€å‘å²—é«˜å‡º20%-50%ï¼Œéƒ¨åˆ†å¤´éƒ¨ä¼ä¸šç”šè‡³å¼€å‡ºç™¾ä¸‡å¹´è–ªã€‚</p>
<p>å¼€å‘é—¨æ§›é™ä½ï¼šæ— éœ€ä»é›¶è®­ç»ƒæ¨¡å‹ï¼Œå€ŸåŠ©ç°æˆçš„å¤§æ¨¡å‹APIï¼Œåªéœ€æŒæ¡è°ƒç”¨é€»è¾‘ä¸é›†æˆæ–¹æ³•ï¼Œå°±èƒ½å¿«é€Ÿæ­å»ºåº”ç”¨ã€‚</p>
<p>åº”ç”¨åœºæ™¯å¤šå…ƒï¼šä»æ—¥å¸¸çš„æ–‡æ¡ˆç”Ÿæˆã€ä»£ç è¾…åŠ©ï¼Œåˆ°è¡Œä¸šçº§çš„é‡‘èé£æ§åˆ†æã€åŒ»ç–—ç—…å†è§£è¯»ï¼Œå¤§æ¨¡å‹çš„åº”ç”¨å‡ ä¹è¦†ç›–æ‰€æœ‰é¢†åŸŸï¼Œå¼€å‘è€…å¯æ ¹æ®å…´è¶£é€‰æ‹©èµ›é“ã€‚</p>
<p>è¯•é”™æˆæœ¬ä½ï¼šå¼€æºç¤¾åŒºæä¾›ä¸°å¯Œçš„å·¥å…·ä¸æ•™ç¨‹ï¼Œå¯è§†åŒ–å¼€å‘å¹³å°æ”¯æŒå¿«é€ŸåŸå‹æ­å»ºï¼Œå³ä½¿æ˜¯é›¶åŸºç¡€ï¼Œä¹Ÿèƒ½åœ¨1-2ä¸ªæœˆå†…åšå‡ºå¯ç”¨çš„äº§å“ã€‚</p>
<p>ä¸€å¥è¯æ€»ç»“ï¼šå½“ä¸‹æ­£æ˜¯å¤§æ¨¡å‹åº”ç”¨å¼€å‘çš„çº¢åˆ©æœŸï¼Œæ—©å…¥å±€å°±èƒ½æ—©æŠ¢å å…ˆæœºã€‚</p>
<h2 data-id="heading-1">äºŒã€å…¥é—¨å‰å¿…é¡»ç†æ¸…çš„3ä¸ªæ ¸å¿ƒè®¤çŸ¥</h2>
<p>ä¸å°‘æ–°æ‰‹ä¸€ä¸Šæ¥å°±æ€¥äºå†™ä»£ç ï¼Œå´å› æ¦‚å¿µæ··æ·†èµ°äº†å¼¯è·¯ã€‚åœ¨æ­£å¼å­¦ä¹ å‰ï¼Œå…ˆææ‡‚è¿™å‡ ä¸ªå…³é”®é—®é¢˜ï¼š</p>
<ol start="0">
<li>å¤§æ¨¡å‹ï¼ˆLLMï¼‰åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</li>
</ol>
<p>å¤§æ¨¡å‹ï¼ˆLarge Language Modelï¼‰æ˜¯åŸºäºæµ·é‡æ–‡æœ¬æ•°æ®è®­ç»ƒè€Œæˆçš„æ·±åº¦ç¥ç»ç½‘ç»œï¼Œå…·å¤‡è¯­è¨€ç”Ÿæˆã€ç†è§£ã€ç¿»è¯‘ã€å¯¹è¯ç­‰æ ¸å¿ƒèƒ½åŠ›ï¼Œå…¶ä¸­æœ€å…·ä»£è¡¨æ€§çš„æ˜¯GPTï¼ˆGenerative Pre-trained Transformerï¼‰æ¶æ„ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒå°±åƒä¸€ä¸ªâ€œè¶…çº§è¯­è¨€å¤§è„‘â€ï¼Œèƒ½æ ¹æ®è¾“å…¥çš„æŒ‡ä»¤ï¼ˆPromptï¼‰è¾“å‡ºç¬¦åˆé€»è¾‘çš„å†…å®¹ã€‚</p>
<p>ç›®å‰ä¸»æµçš„å¤§æ¨¡å‹å¹³å°å¯åˆ†ä¸ºå›½å†…å¤–ä¸¤ç±»ï¼š</p>
<p>å›½å¤–å¹³å°ï¼šOpenAIï¼ˆGPT-4ã€GPT-4oï¼‰ã€Anthropicï¼ˆClaude 3ï¼‰ã€Metaï¼ˆLLaMA 3ï¼‰ã€Googleï¼ˆGeminiï¼‰</p>
<p>å›½å†…å¹³å°ï¼šç™¾åº¦ï¼ˆæ–‡å¿ƒä¸€è¨€ï¼‰ã€é˜¿é‡Œï¼ˆé€šä¹‰åƒé—®ï¼‰ã€æ™ºè°±ï¼ˆGLM-4ï¼‰ã€å•†æ±¤ï¼ˆæ—¥æ—¥æ–°å¤§æ¨¡å‹ï¼‰</p>
<ol start="2">
<li>å¤§æ¨¡å‹åº”ç”¨å¼€å‘â‰ æ¨¡å‹è®­ç»ƒ</li>
</ol>
<p>è¿™æ˜¯æ–°æ‰‹æœ€å®¹æ˜“é™·å…¥çš„è¯¯åŒºï¼ç»å¤§å¤šæ•°å¤§æ¨¡å‹åº”ç”¨å¼€å‘ï¼Œéƒ½ä¸éœ€è¦è‡ªå·±è®­ç»ƒæ¨¡å‹ã€‚ç›®å‰90%ä»¥ä¸Šçš„é¡¹ç›®ï¼Œéƒ½æ˜¯åŸºäºå·²æœ‰çš„å¤§æ¨¡å‹APIï¼Œé€šè¿‡è®¾è®¡Promptã€å¯¹æ¥æ•°æ®æ¥å£ã€é›†æˆUIç•Œé¢æ¥å®ç°åŠŸèƒ½ã€‚è¿™ç§å¼€å‘æ¨¡å¼å¯¹ç¡¬ä»¶è¦æ±‚æä½ï¼ˆæ™®é€šç”µè„‘å³å¯ï¼‰ï¼Œå…¥é—¨æˆæœ¬è¿œä½äºåº•å±‚æ¨¡å‹ç ”å‘ã€‚</p>
<ol start="3">
<li>åº”ç”¨å¼€å‘çš„æ ¸å¿ƒæ˜¯â€œè§£å†³å®é™…é—®é¢˜â€</li>
</ol>
<p>å¤§æ¨¡å‹åªæ˜¯å·¥å…·ï¼ŒçœŸæ­£æœ‰ä»·å€¼çš„æ˜¯ç”¨å®ƒè§£å†³å…·ä½“åœºæ™¯çš„é—®é¢˜ã€‚æ¯”å¦‚ï¼Œä¸ºä¼ä¸šæ‰“é€ èƒ½å¿«é€ŸæŸ¥è¯¢å†…éƒ¨æ–‡æ¡£çš„é—®ç­”ç³»ç»Ÿï¼Œä¸ºè‡ªåª’ä½“ä»ä¸šè€…å¼€å‘è‡ªåŠ¨ç”Ÿæˆæ ‡é¢˜ä¸æ‘˜è¦çš„å·¥å…·ï¼Œè¿™äº›â€œå°è€Œç¾â€çš„åº”ç”¨ï¼Œåè€Œæ›´å®¹æ˜“è½åœ°å¹¶äº§ç”Ÿä»·å€¼ã€‚</p>
<h2 data-id="heading-2">ä¸‰ã€4é˜¶æ®µå­¦ä¹ è·¯å¾„ï¼šä»æ–°æ‰‹åˆ°èƒ½ç‹¬ç«‹å¼€å‘é¡¹ç›®</h2>
<p>é˜¶æ®µä¸€ï¼šç­‘ç‰¢å¼€å‘åŸºç¡€ï¼ˆ1-2å‘¨ï¼‰</p>
<p>æ ¸å¿ƒç›®æ ‡ï¼šæŒæ¡å¤§æ¨¡å‹åº”ç”¨å¼€å‘å¿…å¤‡çš„åŸºç¡€æŠ€æœ¯ï¼Œèƒ½çœ‹æ‡‚ç®€å•çš„ä»£ç é€»è¾‘ã€‚</p>
<p>å­¦ä¹ å†…å®¹ä¸ä¼˜å…ˆçº§ï¼š</p>
<p>PythonåŸºç¡€ï¼šé‡ç‚¹æŒæ¡å˜é‡ã€å‡½æ•°ã€ç±»ã€åˆ—è¡¨/å­—å…¸æ“ä½œã€æ–‡ä»¶è¯»å†™ï¼ˆæ¨èé€šè¿‡LeetCodeç®€å•é¢˜æˆ–W3Schoolç»ƒä¹ ï¼‰</p>
<p>æ•°æ®æ ¼å¼ï¼šç†è§£JSONç»“æ„ï¼ˆå¤§æ¨¡å‹APIè¿”å›æ•°æ®çš„å¸¸ç”¨æ ¼å¼ï¼‰</p>
<p>æ¥å£å¸¸è¯†ï¼šäº†è§£REST APIçš„åŸºæœ¬æ¦‚å¿µï¼ˆè¯·æ±‚æ–¹æ³•ã€å‚æ•°ã€è¿”å›å€¼ï¼‰</p>
<p>å·¥å…·ä½¿ç”¨ï¼šå­¦ä¼šç”¨å‘½ä»¤è¡Œæ‰§è¡Œè„šæœ¬ã€ç”¨Gitç®¡ç†ä»£ç ã€ç”¨Anacondaåˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆé¿å…ä¾èµ–å†²çªï¼‰</p>
<p>æ¨èèµ„æºï¼šPythonå®˜æ–¹æ–‡æ¡£ã€èœé¸Ÿæ•™ç¨‹Pythonæ¿å—ã€Gitå…¥é—¨æŒ‡å—ï¼ˆå»–é›ªå³°ï¼‰</p>
<p>é˜¶æ®µäºŒï¼šå®ç°ç¬¬ä¸€ä¸ªAIåº”ç”¨ï¼ˆ1å‘¨ï¼‰</p>
<p>æ ¸å¿ƒç›®æ ‡ï¼šæŒæ¡å¤§æ¨¡å‹APIçš„è°ƒç”¨æ–¹æ³•ï¼Œèƒ½æ­å»ºç®€æ˜“çš„äº¤äº’ç•Œé¢ã€‚</p>
<p>å…·ä½“æ“ä½œæ­¥éª¤ï¼š</p>
<p>æ³¨å†Œå¹³å°è´¦å·ï¼šé€‰æ‹©OpenAIï¼ˆé€‚åˆè‹±æ–‡åœºæ™¯ï¼‰æˆ–ç™¾åº¦æ™ºèƒ½äº‘ï¼ˆæ–‡å¿ƒä¸€è¨€ï¼Œå›½å†…ç”¨æˆ·æ¨èï¼Œæœ‰å…è´¹é¢åº¦ï¼‰</p>
<p>è·å–APIå¯†é’¥ï¼šåœ¨å¹³å°æ§åˆ¶å°å®Œæˆå®åè®¤è¯åï¼Œåˆ›å»ºåº”ç”¨å¹¶è·å–å¯†é’¥ï¼ˆæ³¨æ„ä¿ç®¡ï¼Œé¿å…æ³„éœ²ï¼‰</p>
<p>ç¼–å†™è°ƒç”¨ä»£ç ï¼šç”¨Pythonçš„requestsåº“å‘é€è¯·æ±‚ï¼Œè°ƒç”¨APIç”Ÿæˆå†…å®¹ï¼ˆç¤ºä¾‹ä»£ç å¯å‚è€ƒå¹³å°æ–‡æ¡£ï¼‰</p>
<p>æ­å»ºUIç•Œé¢ï¼šç”¨Streamlitæˆ–Gradioï¼ˆæ— éœ€å‰ç«¯çŸ¥è¯†ï¼Œå‡ è¡Œä»£ç å°±èƒ½ç”Ÿæˆç½‘é¡µï¼‰</p>
<p>æ¨èå®æˆ˜å°é¡¹ç›®ï¼š</p>
<p>AIæ—¥è®°ç”Ÿæˆå™¨ï¼ˆè¾“å…¥æ—¥æœŸä¸å¿ƒæƒ…ï¼Œè‡ªåŠ¨ç”Ÿæˆæ—¥è®°ï¼‰</p>
<p>ä¸­è‹±æ–‡ç¿»è¯‘åŠ©æ‰‹ï¼ˆæ”¯æŒå¤šè½®å¯¹è¯ï¼Œä¼˜åŒ–ç¿»è¯‘ç»“æœï¼‰</p>
<p>ç¼–ç¨‹é”™é¢˜è§£æå·¥å…·ï¼ˆè¾“å…¥é”™è¯¯ä»£ç ï¼Œåˆ†æé—®é¢˜å¹¶ç»™å‡ºä¿®æ”¹å»ºè®®ï¼‰</p>
<p>é˜¶æ®µä¸‰ï¼šç²¾é€šPromptå·¥ç¨‹ï¼ˆ1-2å‘¨ï¼‰</p>
<p>å¦‚æœè¯´APIè°ƒç”¨æ˜¯â€œéª¨æ¶â€ï¼Œé‚£ä¹ˆPromptè®¾è®¡å°±æ˜¯å¤§æ¨¡å‹åº”ç”¨çš„â€œçµé­‚â€â€”â€”å¥½çš„Promptèƒ½è®©æ¨¡å‹ç²¾å‡†è¾“å‡ºæƒ³è¦çš„ç»“æœï¼Œå·®çš„Promptåˆ™å¯èƒ½å¯¼è‡´å›ç­”æ··ä¹±ã€åç¦»éœ€æ±‚ã€‚</p>
<p>å¿…é¡»æŒæ¡çš„PromptæŠ€å·§ï¼š</p>
<p>ç»“æ„åŒ–è®¾è®¡ï¼šåŒ…å«â€œè§’è‰²è®¾å®šï¼ˆå¦‚â€˜ä½ æ˜¯èµ„æ·±äº§å“ç»ç†â€™ï¼‰+ä»»åŠ¡æè¿°ï¼ˆå¦‚â€˜åˆ†æä»¥ä¸‹éœ€æ±‚æ–‡æ¡£â€™ï¼‰+è¾“å‡ºè¦æ±‚ï¼ˆå¦‚â€˜åˆ†ç‚¹åˆ—å‡ºæ ¸å¿ƒåŠŸèƒ½â€™ï¼‰â€</p>
<p>å¤šè½®å¯¹è¯é€»è¾‘ï¼šé€šè¿‡ä¸Šä¸‹æ–‡å…³è”ï¼Œè®©æ¨¡å‹è®°ä½å†å²å¯¹è¯å†…å®¹ï¼ˆæ¯”å¦‚åœ¨ä»£ç ä¸­ä¿å­˜å¯¹è¯å†å²ï¼Œæ¯æ¬¡è¯·æ±‚æ—¶ä¼ å…¥ï¼‰</p>
<p>æ ¼å¼æ§åˆ¶ï¼šæŒ‡å®šè¾“å‡ºæ ¼å¼ï¼ˆå¦‚â€œåªè¿”å›JSONï¼ŒåŒ…å«â€˜æ ‡é¢˜â€™â€˜æ‘˜è¦â€™ä¸¤ä¸ªå­—æ®µâ€ï¼‰ï¼Œæ–¹ä¾¿åç»­æ•°æ®å¤„ç†</p>
<p>å®æˆ˜ç»ƒä¹ ï¼š</p>
<p>è®¾è®¡â€œAIäº§å“éœ€æ±‚åˆ†æå¸ˆâ€ï¼šè¾“å…¥ç®€å•çš„éœ€æ±‚æè¿°ï¼Œè®©æ¨¡å‹ç”Ÿæˆå®Œæ•´çš„PRDï¼ˆäº§å“éœ€æ±‚æ–‡æ¡£ï¼‰æ¡†æ¶</p>
<p>å¼€å‘â€œè¥é”€æ–‡æ¡ˆä¼˜åŒ–å™¨â€ï¼šè¾“å…¥åŸå§‹æ–‡æ¡ˆï¼Œæ¨¡å‹ä»â€œå¸å¼•åŠ›â€â€œè½¬åŒ–ç‡â€ä¸¤ä¸ªç»´åº¦è¿›è¡Œä¿®æ”¹ï¼Œå¹¶è¯´æ˜ä¼˜åŒ–ç†ç”±</p>
<p>é˜¶æ®µå››ï¼šé›†æˆå·¥å…·é“¾ï¼Œå¼€å‘å¤æ‚åº”ç”¨ï¼ˆ2-3å‘¨ï¼‰</p>
<p>æŒæ¡å•ä¸€APIè°ƒç”¨åï¼Œä¸‹ä¸€æ­¥æ˜¯é€šè¿‡å·¥å…·é›†æˆï¼Œè®©åº”ç”¨å…·å¤‡â€œè®°å¿†â€â€œæŸ¥è¯¢å¤–éƒ¨æ•°æ®â€â€œå¤šä»»åŠ¡ååŒâ€çš„èƒ½åŠ›ï¼Œè¿™ä¹Ÿæ˜¯ä»â€œå…¥é—¨â€åˆ°â€œè¿›é˜¶â€çš„å…³é”®ä¸€æ­¥ã€‚</p>
<p>æ ¸å¿ƒå·¥å…·ä¸åº”ç”¨åœºæ™¯ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/16290398f44344f38f733b4c61a96b1d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765722930&amp;x-signature=XVCd4cPdZJRDLnUGnQtgLL%2BqX0U%3D" alt="" loading="lazy"/></p>
<p>æ¨èå®æˆ˜é¡¹ç›®ï¼š</p>
<p>ä¼ä¸šå®¢æœæœºå™¨äººï¼šé›†æˆLangChain+ç§æœ‰çŸ¥è¯†åº“ï¼Œèƒ½å›ç­”äº§å“å’¨è¯¢ã€å”®åé—®é¢˜ï¼Œä¸”è®°ä½ç”¨æˆ·å†å²å¯¹è¯</p>
<p>æ•™è‚²é”™é¢˜æœ¬ç³»ç»Ÿï¼šä¸Šä¼ è¯•å·ç…§ç‰‡ï¼ˆéœ€é…åˆOCRå·¥å…·ï¼‰ï¼Œæ¨¡å‹åˆ†æé”™é¢˜çŸ¥è¯†ç‚¹ï¼Œå¹¶æ¨èåŒç±»ç»ƒä¹ é¢˜</p>
<p>é‡‘èèµ„è®¯æ‘˜è¦å¹³å°ï¼šè°ƒç”¨æ–°é—»APIè·å–å®æ—¶èµ„è®¯ï¼Œæ¨¡å‹è‡ªåŠ¨ç”Ÿæˆæ‘˜è¦ï¼Œå¹¶æ ‡æ³¨â€œé£é™©æç¤ºâ€â€œæŠ•èµ„å»ºè®®â€ï¼ˆéœ€é™å®šè§’è‰²ä¸ºâ€œé‡‘èåˆ†æå¸ˆâ€ï¼‰</p>
<h2 data-id="heading-3">å››ã€æ–°æ‰‹å‹å¥½çš„å·¥å…·ä¸å¹³å°æ¨è</h2>
<p>é€‰æ‹©åˆé€‚çš„å·¥å…·èƒ½è®©å­¦ä¹ æ•ˆç‡ç¿»å€ï¼Œä»¥ä¸‹æ˜¯ç»è¿‡å®è·µéªŒè¯ã€é€‚åˆåˆå­¦è€…çš„å·¥å…·é“¾ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c9dc0ef94e3c490fa04b8fa69610c279~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765722930&amp;x-signature=n2whGIhqRnXfuJXxXOl9DdAcEeA%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4">äº”ã€å¸¸è§é—®é¢˜ä¸é¿å‘æŒ‡å—</h2>
<p>Q1ï¼šæ²¡æœ‰æ·±åº¦å­¦ä¹ åŸºç¡€ï¼Œèƒ½å­¦å¥½å¤§æ¨¡å‹åº”ç”¨å¼€å‘å—ï¼Ÿ</p>
<p>å®Œå…¨å¯ä»¥ï¼å¤§æ¨¡å‹åº”ç”¨å¼€å‘ä¾§é‡â€œé›†æˆä¸è½åœ°â€ï¼Œè€Œéâ€œåº•å±‚ç®—æ³•ç ”å‘â€ã€‚åªè¦æŒæ¡PythonåŸºç¡€å’ŒAPIè°ƒç”¨é€»è¾‘ï¼Œå°±èƒ½å¼€å‘å‡ºå®ç”¨çš„åº”ç”¨ã€‚å¦‚æœåç»­æƒ³æ·±å…¥ï¼Œå†è¡¥å……æ·±åº¦å­¦ä¹ çŸ¥è¯†ä¹Ÿä¸è¿Ÿã€‚</p>
<p>Q2ï¼šè°ƒç”¨APIçš„æˆæœ¬é«˜å—ï¼Ÿä¼šä¸ä¼šè¶…å‡ºé¢„ç®—ï¼Ÿ</p>
<p>å¤§éƒ¨åˆ†å¹³å°éƒ½æœ‰å…è´¹é¢åº¦ï¼ˆå¦‚ç™¾åº¦æ–‡å¿ƒåƒå¸†æ–°ç”¨æˆ·é€100ä¸‡tokensï¼Œè¶³å¤Ÿå¼€å‘æµ‹è¯•ä½¿ç”¨ï¼‰ï¼›æ­£å¼ä¸Šçº¿åï¼ŒæŒ‰è°ƒç”¨é‡è®¡è´¹ï¼ˆå¦‚GPT-4oæ¯1000 tokensçº¦0.01-0.03ç¾å…ƒï¼‰ï¼Œä¸­å°è§„æ¨¡åº”ç”¨æ¯æœˆæˆæœ¬é€šå¸¸åœ¨å‡ ååˆ°å‡ ç™¾å…ƒï¼Œå¯æ§æ€§å¼ºã€‚</p>
<p>Q3ï¼šä¸æ‡‚å‰ç«¯æŠ€æœ¯ï¼Œå¦‚ä½•è®©åº”ç”¨æœ‰ç¾è§‚çš„ç•Œé¢ï¼Ÿ</p>
<p>é™¤äº†Streamlitã€Gradioï¼Œè¿˜å¯ä»¥å°è¯•ä½ä»£ç å¹³å°ï¼ˆå¦‚Mendixã€ç®€é“äº‘ï¼‰ï¼Œé€šè¿‡æ‹–æ‹½ç»„ä»¶ç”Ÿæˆç•Œé¢ï¼Œå†å¯¹æ¥è‡ªå·±çš„å¤§æ¨¡å‹APIï¼›å¦‚æœæ˜¯ä¼ä¸šçº§åº”ç”¨ï¼Œä¹Ÿå¯ä¸å‰ç«¯åŒäº‹åä½œï¼Œä½ è´Ÿè´£åç«¯é€»è¾‘ï¼Œå¯¹æ–¹è´Ÿè´£ç•Œé¢å¼€å‘ã€‚</p>
<p>Q4ï¼šå­¦ä¹ è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œè¯¥å»å“ªé‡Œæ±‚åŠ©ï¼Ÿ</p>
<p>æŠ€æœ¯ç¤¾åŒºï¼šçŸ¥ä¹ã€CSDNã€æ˜é‡‘çš„â€œå¤§æ¨¡å‹â€æ¿å—ï¼Œå¸¸æœ‰å¼€å‘è€…åˆ†äº«å®æˆ˜ç»éªŒ</p>
<p>å®˜æ–¹æ–‡æ¡£ï¼šå„å¹³å°ï¼ˆå¦‚OpenAIã€ç™¾åº¦æ™ºèƒ½äº‘ï¼‰çš„æ–‡æ¡£éƒ½æœ‰è¯¦ç»†ç¤ºä¾‹ä»£ç ï¼Œæ˜¯æœ€å¥½çš„å­¦ä¹ èµ„æ–™</p>
<p>å¼€æºç¤¾åŒºï¼šGitHubä¸Šæœç´¢â€œLangChain examplesâ€â€œStreamlit demosâ€ï¼Œèƒ½æ‰¾åˆ°å¤§é‡å¯å¤ç”¨çš„é¡¹ç›®ä»£ç </p>
<h2 data-id="heading-5">æ€»ç»“</h2>
<p>å¤§æ¨¡å‹åº”ç”¨å¼€å‘å°±åƒ2013å¹´çš„ç§»åŠ¨å¼€å‘ã€2018å¹´çš„å°ç¨‹åºå¼€å‘â€”â€”é—¨æ§›ä¸é«˜ï¼Œä½†å‰æ™¯å¹¿é˜”ã€‚ä½ ä¸éœ€è¦æˆä¸ºç®—æ³•ä¸“å®¶ï¼Œä»è°ƒç”¨ç¬¬ä¸€ä¸ªAPIã€å¼€å‘ç¬¬ä¸€ä¸ªå°é¡¹ç›®å¼€å§‹ï¼Œé€æ­¥ç§¯ç´¯ç»éªŒï¼Œå°±èƒ½åœ¨AIæµªæ½®ä¸­æ‰¾åˆ°è‡ªå·±çš„ä½ç½®ã€‚</p>
<p>ä¸å…¶çº ç»“â€œè¦ä¸è¦å­¦â€ï¼Œä¸å¦‚ç°åœ¨å°±è¡ŒåŠ¨ï¼šæ³¨å†Œä¸€ä¸ªå¤§æ¨¡å‹å¹³å°è´¦å·ï¼Œè·å–APIå¯†é’¥ï¼Œå†™å‡ è¡Œä»£ç è°ƒç”¨æ¨¡å‹ç”Ÿæˆä¸€å¥è¯ã€‚å½“ä½ çœ‹åˆ°å±å¹•ä¸Šå‡ºç°AIç”Ÿæˆçš„å†…å®¹æ—¶ï¼Œå°±å·²ç»è¿ˆå‡ºäº†å…¥è¡Œçš„ç¬¬ä¸€æ­¥ã€‚</p>
<h3 data-id="heading-6">å­¦ä¹ èµ„æºæ¨è</h3>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°å­¦ä¹ å¤§æ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºï¼Œè¿™äº›èµ„æºå°†å¸®åŠ©ä½ ä»ä¸åŒè§’åº¦å­¦ä¹ å¤§æ¨¡å‹ï¼Œæå‡ä½ çš„å®è·µèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è°·æ­Œæ·±å¤œç‚¸åœºï¼šæœˆè´¹250åˆ€çš„Deep Thinkï¼Œè¿™æ¬¡çœŸçš„å­¦ä¼šäº†â€œæ…¢æ€è€ƒâ€]]></title>    <link>https://juejin.cn/post/7580606750291050547</link>    <guid>https://juejin.cn/post/7580606750291050547</guid>    <pubDate>2025-12-07T13:27:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580606750291050547" data-draft-id="7580621397970894857" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è°·æ­Œæ·±å¤œç‚¸åœºï¼šæœˆè´¹250åˆ€çš„Deep Thinkï¼Œè¿™æ¬¡çœŸçš„å­¦ä¼šäº†â€œæ…¢æ€è€ƒâ€"/> <meta itemprop="keywords" content="AIGC"/> <meta itemprop="datePublished" content="2025-12-07T13:27:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¢¨é£å¦‚é›ª"/> <meta itemprop="url" content="https://juejin.cn/user/4064249017803927"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è°·æ­Œæ·±å¤œç‚¸åœºï¼šæœˆè´¹250åˆ€çš„Deep Thinkï¼Œè¿™æ¬¡çœŸçš„å­¦ä¼šäº†â€œæ…¢æ€è€ƒâ€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4064249017803927/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¢¨é£å¦‚é›ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T13:27:08.000Z" title="Sun Dec 07 2025 13:27:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>2025å¹´çš„AIåœˆï¼Œå¤§å®¶éƒ½å·ç´¯äº†ã€‚</p>
<p>å°±åœ¨æˆ‘ä»¬ä»¥ä¸ºä»Šå¹´çš„å¤§æ¨¡å‹ä¹‹æˆ˜ä¼šä»¥å¹³æ·¡æ”¶åœºæ—¶ï¼Œè°·æ­Œåœ¨12æœˆ5æ—¥çªç„¶æŠ›å‡ºäº†ä¸€æšé‡ç£…ç‚¸å¼¹ï¼šGemini 3 Deep Thinkæ¨¡å¼æ­£å¼å…¬æµ‹ã€‚</p>
<p>è¿™ä¸æ˜¯ä¸€æ¬¡æ™®é€šçš„ç‰ˆæœ¬è¿­ä»£ã€‚å¦‚æœè¯´ä¹‹å‰çš„AIæ˜¯åœ¨æ‹¼è°è¯´è¯æ›´å¿«ã€è°çš„å˜´çš®å­æ›´åˆ©ç´¢ï¼Œé‚£ä¹ˆè¿™ä¸€æ¬¡ï¼Œè°·æ­ŒæŠŠèµ›é“ç›´æ¥æ‹‰å‡åˆ°äº†â€œè„‘åŠ›â€ç»´åº¦ã€‚é‚£ä¸ªæ›¾ç»åªä¼šæ ¹æ®æ¦‚ç‡é¢„æµ‹ä¸‹ä¸€ä¸ªå•è¯çš„èŠå¤©æœºå™¨äººï¼Œç°åœ¨å­¦ä¼šäº†åƒäººç±»ä¸“å®¶ä¸€æ ·ï¼Œåœ¨æ­¤åˆ»åœé¡¿ä¸‹æ¥ï¼Œæ·±å¸ä¸€å£æ°”ï¼Œå¼€å§‹æ¨æ¼”ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2Fasdasv-1024x477.jpeg" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/asdasv-1024x477.jpeg" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e510f8c3992f4bab9d84fab5a1efb19d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765718828&amp;x-signature=dW4Zc0Z%2FvNd4v3vQHmNlF%2F3KTnw%3D" alt="asdasv" loading="lazy"/></a></p>
<p><strong>ä»â€œè„±å£è€Œå‡ºâ€åˆ°â€œæ·±æ€ç†Ÿè™‘â€</strong></p>
<p>ä¸€ç›´ä»¥æ¥ï¼Œå¤§æ¨¡å‹éƒ½æœ‰ä¸ªé€šç—…ï¼šå¤ªå¿«äº†ã€‚</p>
<p>ä½ é—®ä¸€ä¸ªå¤æ‚çš„é—®é¢˜ï¼Œå®ƒæ¨ä¸å¾—åœ¨0.5ç§’å†…æŠŠç­”æ¡ˆç”©åœ¨ä½ è„¸ä¸Šã€‚è¿™ç§â€œç›´è§‰å¼â€çš„ååº”ï¼ˆå¿ƒç†å­¦ä¸Šç§°ä¸ºç³»ç»Ÿ1æ€ç»´ï¼‰ï¼Œåœ¨å†™å†™é‚®ä»¶ã€æŸ¥æŸ¥èµ„æ–™æ—¶å¾ˆå¥½ç”¨ï¼Œä½†ä¸€æ—¦é‡åˆ°å¤æ‚çš„æ•°å­¦è¯æ˜æˆ–ä¸¥å¯†çš„é€»è¾‘é™·é˜±ï¼ŒAIå°±ä¼šä¸€æœ¬æ­£ç»åœ°èƒ¡è¯´å…«é“ã€‚</p>
<p>Gemini 3 Deep Thinkçš„æ ¸å¿ƒå˜é©ï¼Œåœ¨äºå®ƒå¼•å…¥äº†â€œå¹¶è¡Œæ¨ç†â€æŠ€æœ¯ã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œå½“ä½ é¢å¯¹ä¸€é“å¥¥æ•°å‹è½´é¢˜æ—¶ï¼Œä½ ä¸ä¼šåªæ²¿ç€ä¸€æ¡è·¯èµ°åˆ°é»‘ã€‚ä½ ä¼šå…ˆåœ¨è‰ç¨¿çº¸ä¸Šç”»å‡ºä¸‰ç§è§£é¢˜æ€è·¯ï¼Œç¬¬ä¸€ç§èµ°ä¸é€šåˆ’æ‰ï¼Œç¬¬äºŒç§å¥½åƒæœ‰æ¼æ´ï¼Œç¬¬ä¸‰ç§æ¨å¯¼åˆ°ä¸€åŠå‘ç°æ˜¯æ­£è§£ï¼Œç„¶åæ‰æŠŠæœ€ç»ˆç­”æ¡ˆå†™åœ¨å·å­ä¸Šã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2Ffvvsdv-1024x292.jpeg" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/fvvsdv-1024x292.jpeg" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be285f94ee634647974a248e330d14dd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765718828&amp;x-signature=nTfHvJx5ltVojT3UtMKwpwElvfA%3D" alt="fvvsdv" loading="lazy"/></a></p>
<p>Deep Thinkå°±åœ¨åšè¿™ä»¶äº‹ã€‚å®ƒä¸å†ä¾èµ–å•ä¸€çš„çº¿æ€§é¢„æµ‹ï¼Œè€Œæ˜¯åŒæ—¶æ¨¡æ‹Ÿå¤šæ¡æ¨ç†è·¯å¾„ï¼Œåœ¨å†…éƒ¨è¿›è¡Œè‡ªæˆ‘è¾©é©³ã€éªŒè¯å’Œç­›é€‰ã€‚è¿™ç§â€œæ…¢æ€è€ƒâ€ï¼ˆç³»ç»Ÿ2æ€ç»´ï¼‰ï¼Œè®©å®ƒåœ¨å¤„ç†é‚£äº›éœ€è¦æé•¿é€»è¾‘é“¾æ¡çš„é—®é¢˜æ—¶ï¼Œè¡¨ç°å‡ºäº†æƒŠäººçš„ç¨³å®šæ€§ã€‚</p>
<p><strong>ä¸€å¼ æ˜‚è´µçš„â€œå¥¥æ•°é‡‘ç‰Œâ€å…¥åœºåˆ¸</strong></p>
<p>ä¸ºäº†è¯æ˜è¿™ç§æ€è€ƒèƒ½åŠ›ä¸æ˜¯å¹å‡ºæ¥çš„ï¼Œè°·æ­Œç›´æ¥ç”©å‡ºäº†ç¡¬æ ¸æˆç»©å•ã€‚</p>
<p>åœ¨æ¨¡æ‹Ÿå›½é™…æ•°å­¦å¥¥æ—åŒ¹å…‹ï¼ˆIMOï¼‰çš„æµ‹è¯•ä¸­ï¼ŒDeep Thinkçš„å˜ä½“åœ¨æ— ç½‘ç»œã€é™æ—¶ã€éœ€ç»™å‡ºè‡ªç„¶è¯­è¨€è¯æ˜çš„ä¸¥è‹›æ¡ä»¶ä¸‹ï¼Œæ‹¿åˆ°äº†é‡‘ç‰Œçº§çš„åˆ†æ•°ã€‚åœ¨ä¸“ä¸šç§‘å­¦çŸ¥è¯†æµ‹è¯•GPQA Diamondä¸­ï¼Œå®ƒçš„å‡†ç¡®ç‡é£™å‡åˆ°äº†93.8%ï¼Œè¿™åŸºæœ¬æ„å‘³ç€å®ƒåœ¨ç§‘å­¦ç†è§£ä¸Šå·²ç»è¾¾åˆ°äº†åšå£«æ°´å¹³ã€‚</p>
<p>ç”šè‡³åœ¨é‚£ä¸ªå·ç§°â€œäººç±»æœ€åè€ƒå·â€çš„Humanity's Last Examæµ‹è¯•é‡Œï¼Œåœ¨ä¸å€ŸåŠ©ä»»ä½•å¤–éƒ¨å·¥å…·çš„æƒ…å†µä¸‹ï¼Œå®ƒç¡¬æ˜¯å•ƒä¸‹äº†41.0%çš„åˆ†æ•°ã€‚è¿™ä¸ªæ•°å­—çœ‹ç€ä¸é«˜ï¼Œä½†åœ¨è¿™ä¸ªå˜æ€éš¾åº¦çš„åŸºå‡†çº¿ä¸Šï¼Œå®ƒå·²ç»æŠŠå‰ä»£æ¨¡å‹ç”©å¼€äº†å‡ ä¸ªèº«ä½ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2Fsadasvfdsv-1024x576.jpeg" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/sadasvfdsv-1024x576.jpeg" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/12285279e77b4f8f9466edc079d1bc1d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765718828&amp;x-signature=SeZyRrE7ZB1mJld4wyYFVN69N%2F0%3D" alt="sadasvfdsv" loading="lazy"/></a></p>
<p>å½“ç„¶ï¼Œæƒ³ç”¨ä¸Šè¿™ç§çº§åˆ«çš„â€œå¤–è„‘â€ï¼Œä»£ä»·ä¸è²ã€‚</p>
<p>è°·æ­Œæ˜ç¡®äº†å®ƒçš„å®šä½ï¼šè¿™ä¸æ˜¯ç»™æ™®é€šç”¨æˆ·æ‹¿æ¥é—²èŠçš„ç©å…·ã€‚Deep Thinkç›®å‰ä»…å‘Gemini Ultraè®¢é˜…ç”¨æˆ·å¼€æ”¾ï¼Œæœˆè´¹é«˜è¾¾249.99ç¾å…ƒã€‚è¿™ä¸ªå®šä»·æœ¬èº«å°±æ˜¯ä¸€é“é—¨æ§›ï¼Œå®ƒç„å‡†çš„æ˜¯é‚£äº›çœŸæ­£éœ€è¦æ·±åº¦åˆ†æèƒ½åŠ›çš„ç§‘ç ”äººå‘˜ã€é«˜çº§ç¨‹åºå‘˜å’Œé‡‘èåˆ†æå¸ˆã€‚å¯¹äºä»–ä»¬æ¥è¯´ï¼Œå¦‚æœAIèƒ½è§£å†³ä¸€ä¸ªå¡äº†ä¸¤å‘¨çš„ä»£ç Bugï¼Œæˆ–è€…æ¨å¯¼å‡ºä¸€ä¸ªæ–°çš„åˆ†å­ç»“æ„ï¼Œè¿™250ç¾å…ƒç®€ç›´ä¾¿å®œå¾—åƒç™½é€ã€‚</p>
<p><strong>æˆªèƒ¡OpenAIï¼Œè°·æ­Œçš„é˜³è°‹</strong></p>
<p>è¿™æ¬¡å‘å¸ƒçš„æ—¶æœºä¹Ÿå¾ˆæœ‰æ„æ€ã€‚</p>
<p>è¡Œä¸šé‡Œä¸€ç›´æœ‰ä¼ è¨€ï¼ŒOpenAIæ‰‹é‡Œçš„GPT-5ç³»åˆ—æ—©å°±åœ¨å†…éƒ¨è·‘é€šäº†ç±»ä¼¼çš„æ¨ç†èƒ½åŠ›ï¼Œä½†è¿Ÿè¿Ÿæ²¡æœ‰å‘å…¬ä¼—å¼€æ”¾ã€‚è°·æ­Œé€‰åœ¨12æœˆåˆå‘å¸ƒDeep Thinkï¼Œè¢«åª’ä½“æ™®éè§£è¯»ä¸ºä¸€æ¬¡ç²¾å‡†çš„â€œæˆªèƒ¡â€ã€‚</p>
<p>è¿™ä¸ä»…ä»…æ˜¯æŠ¢å å¸‚åœºå…ˆæœºï¼Œæ›´æ˜¯åœ¨å®šä¹‰ä¸‹ä¸€ä»£AIçš„æ ‡å‡†ã€‚è°·æ­Œåœ¨å‘Šè¯‰æ‰€æœ‰äººï¼šæœªæ¥çš„é¡¶çº§AIï¼Œä¸å†æ˜¯çœ‹è°çš„å‚æ•°é‡æ›´å¤§ï¼Œè€Œæ˜¯çœ‹è°èƒ½çœŸæ­£è§£å†³é‚£äº›äººç±»éƒ½æ„Ÿåˆ°æ£˜æ‰‹çš„é€»è¾‘éš¾é¢˜ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2Fv2_20dd9f67e5a8494c88d44458030d7d4e%405091053_oswg96729oswg1080oswg577_img_000-1024x547.jpeg" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/v2_20dd9f67e5a8494c88d44458030d7d4e@5091053_oswg96729oswg1080oswg577_img_000-1024x547.jpeg" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/856a0e85b96c48a9b68e6f13474fa9c4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765718828&amp;x-signature=z9o9c8KaKmQD8m0CaK18dNkfRqg%3D" alt="v2_20dd9f67e5a8494c88d44458030d7d4e@5091053_oswg96729oswg1080oswg577_img_000" loading="lazy"/></a></p>
<p>å¯¹äºæ•´ä¸ªç§‘æŠ€ç•Œæ¥è¯´ï¼ŒGemini 3 Deep Thinkçš„å‡ºç°æ˜¯ä¸€ä¸ªä¿¡å·ã€‚å®ƒæ ‡å¿—ç€å¤§æ¨¡å‹æ­£åœ¨ä»â€œç”Ÿæˆå¼å†…å®¹å·¥å…·â€å‘â€œé€»è¾‘æ¨ç†å¼•æ“â€è¿›åŒ–ã€‚</p>
<p>è™½ç„¶ç›®å‰çš„é«˜æ˜‚å®šä»·è®©å®ƒæ³¨å®šåªèƒ½æ˜¯å°‘æ•°äººçš„åˆ©å™¨ï¼Œä½†æŠ€æœ¯çš„ä¸‹æ”¾åªæ˜¯æ—¶é—´é—®é¢˜ã€‚æˆ–è®¸åœ¨ä¸ä¹…çš„å°†æ¥ï¼Œè¿™ç§æ·±æ€ç†Ÿè™‘çš„èƒ½åŠ›ä¼šæˆä¸ºæ‰€æœ‰AIçš„æ ‡é…ã€‚ä½†è‡³å°‘åœ¨è¿™ä¸ª12æœˆï¼Œè°·æ­Œç”¨å®åŠ›è¯æ˜äº†ï¼Œè®©AIå­¦ä¼šâ€œæ…¢ä¸‹æ¥â€ï¼Œæ‰æ˜¯çœŸæ­£çš„å¿«ã€‚</p>
<p><strong>å¦‚æœä½ ä¹Ÿå¯¹æœ€æ–°çš„AIä¿¡æ¯æ„Ÿå…´è¶£æˆ–è€…æœ‰ç–‘é—® éƒ½å¯ä»¥åŠ å…¥æˆ‘çš„å¤§å®¶åº­ ç¬¬ä¸€æ—¶é—´åˆ†äº«æœ€æ–°AIèµ„è®¯ã€å·¥å…·ã€æ•™ç¨‹ã€æ–‡æ¡£ æ¬¢è¿ä½ çš„åŠ å…¥ï¼ï¼ï¼ğŸ˜‰ğŸ˜‰ğŸ˜‰</strong></p>
<p>å…¬ä¼—å·ï¼šå¢¨é£å¦‚é›ªå°ç«™</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[HTML5 ä¸ JavaScript ä¸­çš„äºŒè¿›åˆ¶æ•°æ®å¤„ç†ï¼šArrayBuffer ä¸ TextEncoder/Decoder å®è·µ]]></title>    <link>https://juejin.cn/post/7580374090366091302</link>    <guid>https://juejin.cn/post/7580374090366091302</guid>    <pubDate>2025-12-07T13:55:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580374090366091302" data-draft-id="7580621397970944009" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="HTML5 ä¸ JavaScript ä¸­çš„äºŒè¿›åˆ¶æ•°æ®å¤„ç†ï¼šArrayBuffer ä¸ TextEncoder/Decoder å®è·µ"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2025-12-07T13:55:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†»æ¢¨æ”¿å“¥"/> <meta itemprop="url" content="https://juejin.cn/user/2373184444182659"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            HTML5 ä¸ JavaScript ä¸­çš„äºŒè¿›åˆ¶æ•°æ®å¤„ç†ï¼šArrayBuffer ä¸ TextEncoder/Decoder å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2373184444182659/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†»æ¢¨æ”¿å“¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T13:55:41.000Z" title="Sun Dec 07 2025 13:55:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">HTML5 ä¸ JavaScript ä¸­çš„äºŒè¿›åˆ¶æ•°æ®å¤„ç†ï¼šArrayBuffer ä¸ TextEncoder/Decoder å®è·µ</h2>
<p>åœ¨ Web å¼€å‘çš„æ¼”è¿›è¿‡ç¨‹ä¸­ï¼ŒHTML5 ä¸º JavaScript å¸¦æ¥äº†å¼ºå¤§çš„äºŒè¿›åˆ¶æ•°æ®å¤„ç†èƒ½åŠ›ï¼Œè¿™ä½¿å¾—å‰ç«¯èƒ½å¤Ÿæ›´é«˜æ•ˆåœ°å¤„ç†æ–‡ä»¶ã€ç½‘ç»œæ•°æ®ç­‰äºŒè¿›åˆ¶å†…å®¹ã€‚å…¶ä¸­ï¼ŒArrayBuffer ä½œä¸ºæ ¸å¿ƒçš„äºŒè¿›åˆ¶æ•°æ®ç¼“å†²åŒºï¼Œç»“åˆ TextEncoder å’Œ TextDecoder å®ç°çš„å­—ç¬¦ä¸²ä¸äºŒè¿›åˆ¶æ•°æ®çš„ç¼–ç è§£ç ï¼Œæˆä¸ºå‰ç«¯äºŒè¿›åˆ¶å¤„ç†çš„åŸºç¡€ç»„åˆã€‚æœ¬æ–‡å°†é€šè¿‡å®é™…ä»£ç æ¡ˆä¾‹ï¼Œæ·±å…¥è§£æè¿™ä¸€æŠ€æœ¯ç»„åˆçš„åº”ç”¨é€»è¾‘ä¸å®è·µè¦ç‚¹ã€‚</p>
<h3 data-id="heading-1">å­—ç¬¦ä¸²çš„äºŒè¿›åˆ¶ç¼–ç ï¼šTextEncoder çš„åº”ç”¨</h3>
<p>TextEncoder æ˜¯ HTML5 å¼•å…¥çš„ APIï¼Œå…¶ä¸»è¦åŠŸèƒ½æ˜¯å°†å­—ç¬¦ä¸²è½¬æ¢ä¸º UTF-8 ç¼–ç çš„äºŒè¿›åˆ¶æ•°æ®ï¼ˆUint8Array ç±»å‹ï¼‰ã€‚åœ¨ä»£ç ä¸­ï¼Œé¦–å…ˆå®ä¾‹åŒ– TextEncoder å¯¹è±¡ï¼Œéšåè°ƒç”¨<code>encode()</code>æ–¹æ³•å¹¶ä¼ å…¥ç›®æ ‡å­—ç¬¦ä¸² â€œä½ å¥½ HTML5â€ï¼Œå³å¯å¾—åˆ°å¯¹åº”çš„äºŒè¿›åˆ¶æ•°ç»„ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">encoder</span> = new TextEncoder()<span class="hljs-comment">;</span>
const <span class="hljs-attr">myBuffer</span> = encoder.encode(<span class="hljs-string">"ä½ å¥½ HTML5"</span>)<span class="hljs-comment">;</span>
</code></pre>
<p>è¿™ä¸€è¿‡ç¨‹å®ç°äº†å­—ç¬¦ä¸²åˆ°äºŒè¿›åˆ¶æ•°æ®çš„è½¬æ¢ï¼Œå…¶ä¸­ä¸­æ–‡å­—ç¬¦ â€œä½ â€â€œå¥½â€ åœ¨ UTF-8 ç¼–ç ä¸‹å„å  3 ä¸ªå­—èŠ‚ï¼Œè‹±æ–‡å­—ç¬¦å’Œç©ºæ ¼å„å  1 ä¸ªå­—èŠ‚ï¼Œå› æ­¤ â€œä½ å¥½ HTML5â€ æœ€ç»ˆè¢«ç¼–ç ä¸º 11 ä¸ªå­—èŠ‚çš„ Uint8Array æ•°ç»„ï¼ˆå¯é€šè¿‡<code>myBuffer.length</code>éªŒè¯ï¼‰ã€‚</p>
<h3 data-id="heading-2">ArrayBufferï¼šäºŒè¿›åˆ¶æ•°æ®çš„ç¼“å†²åŒºåŸºçŸ³</h3>
<p>ArrayBuffer æ˜¯ä¸€ä¸ªç”¨äºå­˜å‚¨åŸå§‹äºŒè¿›åˆ¶æ•°æ®çš„å›ºå®šé•¿åº¦ç¼“å†²åŒºï¼Œå®ƒæœ¬èº«æ— æ³•ç›´æ¥æ“ä½œæ•°æ®ï¼Œéœ€è¦é€šè¿‡ â€œè§†å›¾â€ï¼ˆå¦‚ Uint8Arrayã€Float32Array ç­‰ç±»å‹åŒ–æ•°ç»„ï¼‰æ¥è¯»å†™å†…å®¹ã€‚ä»£ç ä¸­åˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦ä¸º 12 å­—èŠ‚çš„ ArrayBufferï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-type">const</span> buffer = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayBuffer</span>(<span class="hljs-number">12</span>);
</code></pre>
<p>éšåé€šè¿‡ Uint8Array è§†å›¾å¯¹è¯¥ç¼“å†²åŒºè¿›è¡Œæ“ä½œï¼ŒUint8Array ä»¥ 8 ä½æ— ç¬¦å·æ•´æ•°çš„å½¢å¼è®¿é—®ç¼“å†²åŒºæ•°æ®ï¼Œè¿™æ˜¯æœ€å¸¸ç”¨çš„äºŒè¿›åˆ¶æ•°æ®æ“ä½œè§†å›¾ä¹‹ä¸€ã€‚é€šè¿‡å¾ªç¯å°†<code>myBuffer</code>ä¸­çš„äºŒè¿›åˆ¶æ•°æ®é€ä¸€å¤åˆ¶åˆ° Uint8Array è§†å›¾ä¸­ï¼Œå®ç°äº†å¯¹ ArrayBuffer ç¼“å†²åŒºçš„å¡«å……ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">view</span> = new Uint8Array(buffer)<span class="hljs-comment">;</span>
for(let <span class="hljs-attr">i</span>=<span class="hljs-number">0</span><span class="hljs-comment">;i&lt;myBuffer.length;i++){</span>
    view<span class="hljs-section">[i]</span>=myBuffer<span class="hljs-section">[i]</span><span class="hljs-comment">;</span>
}
</code></pre>
<p>è¿™é‡Œ ArrayBuffer çš„é•¿åº¦è®¾ç½®ä¸º 12 å­—èŠ‚ï¼Œç•¥å¤§äº<code>myBuffer</code>çš„ 11 å­—èŠ‚ï¼Œå‰©ä½™ 1 å­—èŠ‚ä¸º 0 å¡«å……ï¼Œè¿™ä½“ç°äº† ArrayBuffer é•¿åº¦å›ºå®šçš„ç‰¹æ€§ï¼Œå¼€å‘è€…éœ€æ ¹æ®æ•°æ®éœ€æ±‚åˆç†è§„åˆ’ç¼“å†²åŒºå¤§å°ã€‚</p>
<h3 data-id="heading-3">äºŒè¿›åˆ¶æ•°æ®çš„å­—ç¬¦ä¸²è§£ç ï¼šTextDecoder çš„ä½œç”¨</h3>
<p>TextDecoder ä½œä¸º TextEncoder çš„äº’è¡¥ APIï¼Œè´Ÿè´£å°†äºŒè¿›åˆ¶æ•°æ®ï¼ˆArrayBuffer æˆ–ç±»å‹åŒ–æ•°ç»„ï¼‰è§£ç ä¸ºå­—ç¬¦ä¸²ã€‚ä»£ç ä¸­é€šè¿‡å®ä¾‹åŒ– TextDecoder å¹¶è°ƒç”¨<code>decode()</code>æ–¹æ³•ï¼Œå°† ArrayBuffer ç¼“å†²åŒºä¸­çš„æ•°æ®è§£ç ä¸ºåŸå§‹å­—ç¬¦ä¸²ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">decoder</span> = new TextDecoder()<span class="hljs-comment">;</span>
const <span class="hljs-attr">originalText</span> = decoder.decode(buffer)<span class="hljs-comment">;</span>
</code></pre>
<p>ç”±äºç¼“å†²åŒºä¸­å®Œæ•´å­˜å‚¨äº†ç¼–ç åçš„äºŒè¿›åˆ¶æ•°æ®ï¼ˆå« 1 å­—èŠ‚ 0 å¡«å……ï¼ŒUTF-8 è§£ç æ—¶å¿½ç•¥æœ«å°¾æ— æ•ˆçš„ 0 å­—èŠ‚ï¼‰ï¼Œå› æ­¤è§£ç åå¯å‡†ç¡®è¿˜åŸå‡ºå­—ç¬¦ä¸² â€œä½ å¥½ HTML5â€ï¼Œè¿™éªŒè¯äº†ç¼–ç  - è§£ç æµç¨‹çš„å®Œæ•´æ€§ä¸æ­£ç¡®æ€§ã€‚</p>
<h3 data-id="heading-4">æ•°æ®å±•ç¤ºä¸éªŒè¯ï¼šå‰ç«¯é¡µé¢çš„äº¤äº’å‘ˆç°</h3>
<p>ä¸ºäº†ç›´è§‚å±•ç¤ºäºŒè¿›åˆ¶æ•°æ®å¤„ç†çš„ç»“æœï¼Œä»£ç é€šè¿‡ DOM æ“ä½œå°†å…³é”®æ•°æ®æ¸²æŸ“åˆ°é¡µé¢ä¸­ï¼š</p>
<ul>
<li>å±•ç¤º Uint8Array è§†å›¾çš„å®Œæ•´æ•°æ®ï¼Œå¯ç›´è§‚çœ‹åˆ°æ¯ä¸ªå­—èŠ‚çš„æ•°å€¼ï¼›</li>
<li>è¾“å‡ºç¬¬ä¸€ä¸ªå­—èŠ‚çš„æ•°å€¼ï¼ˆå¯¹åº” â€œä½ â€ å­— UTF-8 ç¼–ç çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼‰ï¼›</li>
<li>æ˜¾ç¤º ArrayBuffer ç¼“å†²åŒºçš„æ€»å­—èŠ‚é•¿åº¦ï¼ŒéªŒè¯ç¼“å†²åŒºå¤§å°è®¾ç½®ï¼›</li>
<li>å‘ˆç°è§£ç åçš„åŸå§‹æ–‡æœ¬ï¼Œç¡®è®¤æ•°æ®å¤„ç†çš„å‡†ç¡®æ€§ã€‚</li>
</ul>
<h3 data-id="heading-5">æŠ€æœ¯åº”ç”¨åœºæ™¯ä¸ä»·å€¼</h3>
<p>è¿™ç§äºŒè¿›åˆ¶æ•°æ®å¤„ç†æ¨¡å¼åœ¨å‰ç«¯å¼€å‘ä¸­å…·æœ‰å¹¿æ³›çš„åº”ç”¨åœºæ™¯ï¼š</p>
<ul>
<li><strong>æ–‡ä»¶å¤„ç†</strong>ï¼šåœ¨ File API ä¸­ï¼Œå¯é€šè¿‡ ArrayBuffer è¯»å–æ–‡ä»¶çš„äºŒè¿›åˆ¶å†…å®¹ï¼Œç»“åˆç¼–ç è§£ç å®ç°æ–‡æœ¬æ–‡ä»¶çš„è¯»å†™ä¸ç¼–ç è½¬æ¢ï¼›</li>
<li><strong>ç½‘ç»œé€šä¿¡</strong>ï¼šåœ¨ WebSocket æˆ– Fetch API ä¸­ï¼Œå¤„ç†äºŒè¿›åˆ¶æ ¼å¼çš„ç½‘ç»œæ•°æ®ï¼ˆå¦‚ ArrayBuffer æ ¼å¼çš„å“åº”æ•°æ®ï¼‰ï¼Œæå‡æ•°æ®ä¼ è¾“ä¸è§£ææ•ˆç‡ï¼›</li>
<li><strong>æœ¬åœ°å­˜å‚¨</strong>ï¼šIndexedDB æ”¯æŒå­˜å‚¨ ArrayBuffer ç±»å‹çš„æ•°æ®ï¼Œå¯å°†äºŒè¿›åˆ¶æ•°æ®æˆ–ç¼–ç åçš„å­—ç¬¦ä¸²å­˜å…¥æœ¬åœ°æ•°æ®åº“ï¼Œå®ç°é«˜æ•ˆçš„æ•°æ®æŒä¹…åŒ–ã€‚</li>
</ul>
<h3 data-id="heading-6">æ€»ç»“</h3>
<p>HTML5 å¼•å…¥çš„ ArrayBufferã€TextEncoder å’Œ TextDecoder ä¸º JavaScript æä¾›äº†æ ‡å‡†åŒ–çš„äºŒè¿›åˆ¶æ•°æ®å¤„ç†èƒ½åŠ›ï¼Œä½¿å¾—å‰ç«¯èƒ½å¤Ÿæ‘†è„±å¯¹å­—ç¬¦ä¸²çš„å•ä¸€ä¾èµ–ï¼Œé«˜æ•ˆå¤„ç†äºŒè¿›åˆ¶æ•°æ®ã€‚é€šè¿‡æœ¬æ–‡çš„å®è·µæ¡ˆä¾‹ï¼Œä¸ä»…ç†è§£äº†æ ¸å¿ƒ API çš„ä½¿ç”¨é€»è¾‘ï¼Œä¹ŸæŒæ¡äº†å­—ç¬¦ä¸²ä¸äºŒè¿›åˆ¶æ•°æ®ä¹‹é—´çš„ç¼–ç è§£ç æµç¨‹ï¼Œè¿™ä¸ºå‰ç«¯å¤„ç†å¤æ‚æ•°æ®æ ¼å¼ã€ä¼˜åŒ–æ€§èƒ½æä¾›äº†é‡è¦çš„æŠ€æœ¯æ”¯æ’‘ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œåˆç†è¿ç”¨è¿™äº› APIï¼Œå¯æ˜¾è‘—æå‡å‰ç«¯åº”ç”¨å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„èƒ½åŠ›ä¸çµæ´»æ€§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯è·¨é¡µé¢é€šè®¯ç»ˆææŒ‡å—â‘£ï¼šMessageChannel ç”¨æ³•å…¨è§£æ]]></title>    <link>https://juejin.cn/post/7580564126402576434</link>    <guid>https://juejin.cn/post/7580564126402576434</guid>    <pubDate>2025-12-07T12:18:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580564126402576434" data-draft-id="7576369868418859044" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯è·¨é¡µé¢é€šè®¯ç»ˆææŒ‡å—â‘£ï¼šMessageChannel ç”¨æ³•å…¨è§£æ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-07T12:18:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€è¯ºæ»šé›ªçƒ"/> <meta itemprop="url" content="https://juejin.cn/user/2824015112318094"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯è·¨é¡µé¢é€šè®¯ç»ˆææŒ‡å—â‘£ï¼šMessageChannel ç”¨æ³•å…¨è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2824015112318094/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€è¯ºæ»šé›ªçƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T12:18:33.000Z" title="Sun Dec 07 2025 12:18:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ä¸Šä¸€ç¯‡ä»‹ç»äº†<strong>Localstorage</strong>è·¨é¡µé¢é€šè®¯çš„æ–¹å¼ã€‚åœ¨å‰é¢çš„æ–‡ç« ä¸­ï¼Œä»‹ç»äº†å¤šç§è·¨é¡µé¢é€šä¿¡æ–¹å¼ï¼Œä»é€‚ç”¨äºåŒæºé¡µé¢çš„ <code>BroadcastChannel</code>ï¼Œåˆ°è§£å†³è·¨åŸŸçš„ <code>postMessage</code>ã€‚å½“å¤šä¸ªé€šä¿¡è¿›è¡Œæ··æ‚åœ¨ä¸€èµ·ï¼Œä½¿ç”¨å…¨å±€çš„<code>message</code>äº‹ä»¶ç›‘å¬æ—¶ï¼Œä¼šé€šè¿‡å„ç§ç±»å‹åˆ¤æ–­æ¶ˆæ¯æ¥æºè¿›è¡Œå¤„ç†ã€‚</p>
<p>é‚£æœ‰æ²¡æœ‰ä¸€ç§æ–¹æ³•ï¼Œæ—¢èƒ½å®ç°è·¨ä¸Šä¸‹æ–‡é€šä¿¡ï¼Œåˆèƒ½åƒæ‰“ç”µè¯ä¸€æ ·ï¼Œå»ºç«‹èµ·ä¸€æ¡<strong>ä¸“å±çš„ã€åŒå‘çš„ã€ç‚¹å¯¹ç‚¹çš„ç§å¯†é€šé“</strong>å‘¢ï¼Ÿ</p>
<p>ä»Šå¤©ä»‹ç»ä¸€ä¸ªæ–¹æ¡ˆâ€”â€”<strong>MessageChannel API</strong>ã€‚æä¾›äº†ä¸€ç§æ›´ä¸ºä¼˜é›…å’Œç§å¯†çš„æ–¹å¼ï¼Œå»ºç«‹èµ·ä¸€æ¡ç‚¹å¯¹ç‚¹çš„â€œä¸“çº¿ç”µè¯â€ï¼Œè®©é€šä¿¡åŒæ–¹å¯ä»¥æ¸…æ™°åœ°ã€æ— å¹²æ‰°åœ°å¯¹è¯ã€‚</p>
<h2 data-id="heading-1">1. MessageChannel æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FChannel_Messaging_API" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/API/Channel_Messaging_API" ref="nofollow noopener noreferrer">Channel Messaging API</a>Â çš„Â <strong><code>MessageChannel</code></strong>Â æ¥å£å…è®¸æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„æ¶ˆæ¯é€šé“ï¼Œå¹¶é€šè¿‡å®ƒçš„ä¸¤ä¸ªÂ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FMessagePort" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/API/MessagePort" ref="nofollow noopener noreferrer"><code>MessagePort</code></a>Â å±æ€§å‘é€æ•°æ®ã€‚</p>
<p>æ ¸å¿ƒæ˜¯åˆ›å»ºä¸€ä¸ª<strong>åŒå‘é€šè®¯çš„ç®¡é“</strong>ï¼Œè¿™ä¸ªç®¡é“åŒ…å«ä¸¤ä¸ªç›¸äº’å…³è”çš„ç«¯å£â€”â€”<code>port1</code> å’Œ <code>port2</code>ã€‚æ•°æ®ä» port1 å‘é€ï¼Œå°±åªèƒ½ç”± port2 æ¥æ”¶ï¼›åä¹‹ï¼Œport2 å‘é€çš„æ•°æ®ä¹Ÿåªèƒ½è¢« port1 æ•è·ï¼Œè¿™ç§â€œç‚¹å¯¹ç‚¹â€çš„é€šè®¯æ¨¡å¼ï¼Œä»æ ¹æºä¸Šé¿å…äº†æ•°æ®è¢«æ— å…³é¡µé¢æ‹¦æˆªçš„é£é™©ã€‚</p>
<p>ä¸¾ä¸ªé€šä¿—çš„ä¾‹å­ï¼š BroadcastChannel æ˜¯â€œå°åŒºå¹¿æ’­â€ï¼Œæ‰€æœ‰äººéƒ½èƒ½å¬åˆ°ï¼›è€Œ MessageChannel å°±æ˜¯â€œä¸“çº¿ç”µè¯â€ï¼Œåªæœ‰ä¸¤ä¸ªç«¯å£å¯¹åº”çš„è®¾å¤‡èƒ½æ¥é€šã€‚</p>
<h2 data-id="heading-2">2. å¦‚ä½•ä½¿ç”¨</h2>
<p>ä½¿ç”¨ <code>MessageChannel</code> æµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li><strong>åˆ›å»ºé€šé“</strong>ï¼š åˆ›å»ºä¸€ä¸ª <code>MessageChannel</code> å®ä¾‹ï¼ŒåŒ…å«ä¸¤ä¸ªç«¯å£å±æ€§ï¼š<code>port1</code> å’Œ <code>port2</code>ã€‚</li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> channel = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MessageChannel</span>();

<span class="hljs-comment">// channel.port1 å’Œ channel.port2 éƒ½æ˜¯ MessagePort å¯¹è±¡</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7c0a6bc583d24a04a01697afbbd6b593~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA6K-65rua6Zuq55CD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765714713&amp;x-signature=h9mIZ%2FHNQmjWHrH7NoIABZ9zigA%3D" alt="image.png" loading="lazy"/></p>
<ol start="2">
<li><strong>ç›‘å¬æ¶ˆæ¯</strong>ï¼š åœ¨å…¶ä¸­ä¸€ä¸ªç«¯å£ä¸Šè®¾ç½® <code>onmessage</code> äº‹ä»¶å¤„ç†å™¨ï¼Œç”¨äºæ¥æ”¶æ¥è‡ªå¦ä¸€ä¸ªç«¯å£çš„æ¶ˆæ¯ã€‚</li>
</ol>
<pre><code class="hljs language-js" lang="js">channel.<span class="hljs-property">port1</span>.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ”¶åˆ°æ¶ˆæ¯:'</span>, event.<span class="hljs-property">data</span>);
};
</code></pre>
<ol start="3">
<li><strong>å‘é€æ¶ˆæ¯</strong>ï¼š é€šè¿‡ä¸€ä¸ªç«¯å£çš„ <code>postMessage</code>æ–¹æ³•å‘å¦ä¸€ä¸ªç«¯å£å‘é€æ•°æ®ã€‚</li>
</ol>
<pre><code class="hljs language-js" lang="js">channel.<span class="hljs-property">port2</span>.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">'Hello from port2!'</span>);
</code></pre>
<ol start="4">
<li><strong>è½¬ç§»ç«¯å£æ‰€æœ‰æƒ</strong> ï¼š <code>MessageChannel</code> çš„å¨åŠ›åœ¨äºå¯ä»¥å°†ä¸€ä¸ªç«¯å£å‘é€åˆ°å¦ä¸€ä¸ªæµè§ˆä¸Šä¸‹æ–‡ï¼ˆä¾‹å¦‚ iframeï¼‰ã€‚è¿™éœ€è¦é€šè¿‡ <code>window.postMessage</code> çš„ç¬¬ä¸‰ä¸ªå‚æ•° <code>transfer</code> æ¥å®ç°, å¯ä»¥ç›´æ¥å°†ç«¯å£ä¸‹å‘åˆ°ä¸¤ä¸ªå­iframe,ç›´æ¥è¿›è¡Œé€šè®¯ã€‚</li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å‡è®¾ iframe æ˜¯æˆ‘ä»¬æƒ³è¦é€šä¿¡çš„ç›®æ ‡</span>
<span class="hljs-keyword">const</span> iframe = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'iframe'</span>).<span class="hljs-property">contentWindow</span>;

<span class="hljs-comment">// å°† port2 çš„æ‰€æœ‰æƒè½¬ç§»ç»™ iframe</span>
<span class="hljs-comment">// è½¬ç§»åï¼Œå½“å‰é¡µé¢å°±ä¸å†æ‹¥æœ‰ port2ï¼Œåªæœ‰ iframe èƒ½ä½¿ç”¨å®ƒ</span>

iframe.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">'init'</span>, <span class="hljs-string">'*'</span>, [channel.<span class="hljs-property">port2</span>]);
</code></pre>
<p>ä½¿ç”¨postMessageå‘é€ç«¯å£ä¼šå‡ºç°portsï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/083da7c6bc5643a3ade3d23789ca5c8a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA6K-65rua6Zuq55CD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765714713&amp;x-signature=kQNarFBKYkESaPUWjd9v2URFszY%3D" alt="image.png" loading="lazy"/></p>
<p>æ¥æ”¶æ–¹ï¼ˆiframeï¼‰å¯ä»¥åœ¨å…¶ <code>message</code> äº‹ä»¶ä¸­è·å–åˆ°è¿™ä¸ªç«¯å£ï¼Œå¼€å§‹é€šä¿¡ã€‚</p>
<h2 data-id="heading-3">3. å®è·µåœºæ™¯</h2>
<p>ä¸‹é¢ä½¿ç”¨MessageChannelè¿›è¡Œçˆ¶å­åŒå‘ã€å…„å¼Ÿé€šè®¯è¿›è¡Œè¯´æ˜ã€‚</p>
<h3 data-id="heading-4">3.1 çˆ¶å­åŒå‘é€šè®¯</h3>
<p>çˆ¶é¡µé¢å¼•å…¥ä¸€ä¸ª iframeï¼Œåˆ›å»ºMessageChannel,åˆå§‹åŒ–æ—¶å°†å…¶ä¸­ä¸€ä¸ª<code>port1</code>ä½¿ç”¨<code>postMessage</code>ä¼ é€’ï¼Œåé¢ç›´æ¥é€šè¿‡portè¿›è¡ŒåŒå‘é€šè®¯ã€‚</p>
<p>æ­¥éª¤1ï¼šçˆ¶é¡µé¢ï¼ˆå‘é€ç«¯å£+é€šè®¯é€»è¾‘ï¼‰</p>
<pre><code class="hljs language-ini" lang="ini">// 1. åˆ›å»º MessageChannel å®ä¾‹ï¼Œç”Ÿæˆä¸¤ä¸ªç«¯å£
const <span class="hljs-attr">channel</span> = new MessageChannel()<span class="hljs-comment">;</span>
const { port1, port2 } = channel<span class="hljs-comment">;</span>

// 2. è·å– iframe å…ƒç´ ï¼Œç›‘å¬åŠ è½½å®Œæˆäº‹ä»¶
const <span class="hljs-attr">iframe</span> = document.getElementById(<span class="hljs-string">'myIframe'</span>)<span class="hljs-comment">;</span>
<span class="hljs-attr">iframe.onload</span> = () =&gt; {
  // 3. å‘ iframe ä¼ é€’ port2ï¼ˆå…³é”®ï¼šåªæœ‰ä¼ é€’ç«¯å£åæ‰èƒ½é€šè®¯ï¼‰
  iframe.contentWindow.postMessage('init', '*', <span class="hljs-section">[port2]</span>)<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>

// 4. ç›‘å¬ port1 æ¥æ”¶çš„æ¶ˆæ¯ï¼ˆæ¥è‡ª iframeï¼‰
<span class="hljs-attr">port1.onmessage</span> = (e) =&gt; {
  console.log('çˆ¶é¡µé¢æ”¶åˆ° iframe æ¶ˆæ¯ï¼š', e.data)<span class="hljs-comment">;</span>
  // æ”¶åˆ°æ¶ˆæ¯åå›å¤
  if (<span class="hljs-attr">e.data</span> === <span class="hljs-string">'hello from iframe'</span>) {
    port1.postMessage('hi iframe, I am parent')<span class="hljs-comment">;</span>
  }
}<span class="hljs-comment">;</span>

// 5. å¯é€‰ï¼šç›‘å¬é”™è¯¯äº‹ä»¶
<span class="hljs-attr">port1.onerror</span> = (error) =&gt; {
  console.error('é€šè®¯é”™è¯¯ï¼š', error)<span class="hljs-comment">;</span>
  port1.close()<span class="hljs-comment">; // å‡ºé”™åå…³é—­ç«¯å£</span>
}<span class="hljs-comment">;</span>
</code></pre>
<p>æ­¥éª¤2ï¼šiframe é¡µé¢ï¼ˆæ¥æ”¶ç«¯å£+å“åº”é€»è¾‘ï¼‰</p>
<pre><code class="hljs language-ini" lang="ini">// 1. ç›‘å¬çˆ¶é¡µé¢å‘é€çš„åˆå§‹åŒ–æ¶ˆæ¯
<span class="hljs-attr">window.onmessage</span> = (e) =&gt; {
  // 2. éªŒè¯æ¶ˆæ¯ç±»å‹ï¼Œè·å–ä¼ é€’çš„ port2
  if (<span class="hljs-attr">e.data</span> === <span class="hljs-string">'init'</span> &amp;&amp; e.ports.length) {
    const <span class="hljs-attr">port2</span> = e.ports[<span class="hljs-number">0</span>]<span class="hljs-comment">;</span>

    // 3. ç›‘å¬ port2 æ¥æ”¶çš„æ¶ˆæ¯ï¼ˆæ¥è‡ªçˆ¶é¡µé¢ï¼‰
    <span class="hljs-attr">port2.onmessage</span> = (msg) =&gt; {
      console.log('iframe æ”¶åˆ°çˆ¶é¡µé¢æ¶ˆæ¯ï¼š', msg.data)<span class="hljs-comment">;</span>
    }<span class="hljs-comment">;</span>

    // 4. å‘çˆ¶é¡µé¢å‘é€æ¶ˆæ¯
    port2.postMessage('hello from iframe')<span class="hljs-comment">;</span>
  }
}<span class="hljs-comment">;</span>
</code></pre>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</p>
<ul>
<li>çˆ¶é¡µé¢é€šè¿‡ <code>postMessage</code> ä¼ é€’ port2 æ—¶ï¼Œå¿…é¡»å°† port2 æ”¾åœ¨ç¬¬ä¸‰ä¸ªå‚æ•°ï¼ˆtransferListï¼‰ä¸­ï¼Œè¿™æ˜¯ â€œç«¯å£ä¼ é€’â€çš„å›ºå®šå†™æ³•ï¼›</li>
<li>ç«¯å£ä¸€æ—¦ä¼ é€’ï¼Œçˆ¶é¡µé¢çš„ port2 å°±ä¼šå¤±æ•ˆï¼Œåªèƒ½é€šè¿‡ iframe ä¸­çš„ port2 é€šè®¯ã€‚</li>
</ul>
<h3 data-id="heading-5">3.2 å…„å¼Ÿé€šè®¯</h3>
<p><strong>å®ç°æ€è·¯æ˜¯ï¼š</strong> çˆ¶é¡µé¢ä½œä¸ºâ€œæ€»æœºâ€ï¼Œè´Ÿè´£åˆ›å»º <code>MessageChannel</code>ï¼Œå¹¶å°†ä¸¤ä¸ªç«¯å£åˆ†åˆ«åˆ†é…ç»™ä¸¤ä¸ª <code>iframe</code>ï¼Œè®©å®ƒä»¬ä¹‹é—´å»ºç«‹èµ·ç›´è¿ä¸“çº¿ã€‚</p>
<p>æ­¥éª¤1ï¼šçˆ¶é¡µé¢ä»£ç </p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> channel = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MessageChannel</span>();
<span class="hljs-keyword">const</span> frame1 = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'frame1'</span>).<span class="hljs-property">contentWindow</span>;
<span class="hljs-keyword">const</span> frame2 = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'frame2'</span>).<span class="hljs-property">contentWindow</span>;
<span class="hljs-comment">// ç­‰å¾…ä¸¤ä¸ª iframe åŠ è½½å®Œæˆ</span>
<span class="hljs-keyword">let</span> loadCount = <span class="hljs-number">0</span>;
<span class="hljs-keyword">const</span> <span class="hljs-title function_">onLoad</span> = (<span class="hljs-params"/>) =&gt; {
  loadCount++;
  <span class="hljs-keyword">if</span> (loadCount === <span class="hljs-number">2</span>) {
    <span class="hljs-comment">// å°† port1 å‘é€ç»™ iframe1</span>
    frame1.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">'init'</span>, <span class="hljs-string">'*'</span>, [channel.<span class="hljs-property">port1</span>]);
    <span class="hljs-comment">// å°† port2 å‘é€ç»™ iframe2</span>
    frame2.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">'init'</span>, <span class="hljs-string">'*'</span>, [channel.<span class="hljs-property">port2</span>]);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'çˆ¶é¡µé¢ï¼šä¸“çº¿å·²å»ºç«‹ï¼Œç«¯å£å·²åˆ†å‘ã€‚'</span>);
  }
};
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'frame1'</span>).<span class="hljs-property">onload</span> = onLoad;
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'frame2'</span>).<span class="hljs-property">onload</span> = onLoad;
</code></pre>
<p>æ­¥éª¤2ï¼šå­é¡µé¢æ¥æ”¶port</p>
<pre><code class="hljs language-js" lang="js">
<span class="hljs-keyword">let</span> port;
<span class="hljs-comment">// 1. æ¥å£ç«¯å£</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'message'</span>, <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  <span class="hljs-comment">// ç¡®è®¤æ˜¯çˆ¶é¡µé¢å‘æ¥çš„åˆå§‹åŒ–æ¶ˆæ¯ï¼Œå¹¶æ¥æ”¶ç«¯å£</span>
  <span class="hljs-keyword">if</span> (event.<span class="hljs-property">data</span> === <span class="hljs-string">'init'</span>) {
    port = event.<span class="hljs-property">ports</span>[<span class="hljs-number">0</span>];
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'iframe1ï¼šå·²æ¥æ”¶ port1ï¼Œå‡†å¤‡å‘é€æ¶ˆæ¯ã€‚'</span>);
  }
});
<span class="hljs-comment">// 2. å‘é€æ¶ˆæ¯</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'sendBtn'</span>).<span class="hljs-property">onclick</span> = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">if</span> (port) {
    <span class="hljs-keyword">const</span> message = <span class="hljs-string">`æ¥è‡ª iframe1 çš„é—®å€™ï¼Œæ—¶é—´ï¼š<span class="hljs-subst">${<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toLocaleTimeString()}</span>`</span>;
    port.<span class="hljs-title function_">postMessage</span>(message);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'iframe1ï¼šæ¶ˆæ¯å·²å‘é€ -&gt;'</span>, message);
  }
};
<span class="hljs-comment">// 3. ç›‘å¬ port æ¶ˆæ¯</span>
port.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é¡µé¢Bæ”¶åˆ°æ¶ˆæ¯ï¼š'</span>, e.<span class="hljs-property">data</span>);
};
</code></pre>
<p>å®é™…æ•ˆæœï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ec819d8e1557474595cb35b95692f93f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA6K-65rua6Zuq55CD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765714713&amp;x-signature=9RRQm6Vc1QOJrnz2llHw63vTTwg%3D" alt="image.png" loading="lazy"/>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8f5c6321a9ba40d1b7191f7fc57da9c9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA6K-65rua6Zuq55CD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765714713&amp;x-signature=BX9y9jns2dwjr4oeO%2FMbgzkDv3c%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-6">4. æ³¨æ„äº‹é¡¹</h2>
<ol>
<li>ç«¯å£ä¼ é€’å¿…é¡»ç”¨ transferList</li>
</ol>
<p>ä¼ é€’ç«¯å£æ—¶ï¼Œå¿…é¡»å°† port æ”¾åœ¨ <code>postMessage</code> çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼ˆtransferListï¼‰ä¸­ï¼Œè€Œä¸æ˜¯ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆdataï¼‰ã€‚é”™è¯¯å†™æ³•ä¼šå¯¼è‡´ç«¯å£æ— æ³•æ­£å¸¸ç»‘å®šï¼Œé€šè®¯å¤±æ•ˆã€‚</p>
<ol start="2">
<li>é€šè®¯å®ŒæˆååŠæ—¶å…³é—­ç«¯å£</li>
</ol>
<p>ä¸éœ€è¦é€šè®¯æ—¶ï¼Œè°ƒç”¨ <code>port.close()</code> å…³é—­ç«¯å£ï¼Œé¿å…å†…å­˜æ³„æ¼ã€‚</p>
<h2 data-id="heading-7">5. æ€»ç»“</h2>
<p>æœ€åæ€»ç»“ä¸€ä¸‹ï¼š<code>MessageChannel</code> é€šè¿‡åˆ›å»ºä¸€ä¸ªä¸“å±çš„åŒå‘é€šé“ï¼Œè§£å†³äº†ç‚¹å¯¹ç‚¹é€šä¿¡çš„éœ€æ±‚ï¼Œå”¯ä¸€ä¸è¶³çš„æ˜¯æ— è®ºæ˜¯çˆ¶å­è¿˜æ˜¯å…„å¼Ÿé€šè®¯éƒ½æ˜¯éœ€è¦ä½¿ç”¨<code>postMessage</code>è¿›è¡Œä¼ é€’ç«¯å£ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯è·¨é¡µé¢é€šè®¯ç»ˆææŒ‡å—â‘¤ï¼šwindow.name ç”¨æ³•å…¨è§£æ]]></title>    <link>https://juejin.cn/post/7580378958073479178</link>    <guid>https://juejin.cn/post/7580378958073479178</guid>    <pubDate>2025-12-07T12:20:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580378958073479178" data-draft-id="7576369868418891812" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯è·¨é¡µé¢é€šè®¯ç»ˆææŒ‡å—â‘¤ï¼šwindow.name ç”¨æ³•å…¨è§£æ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-07T12:20:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€è¯ºæ»šé›ªçƒ"/> <meta itemprop="url" content="https://juejin.cn/user/2824015112318094"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯è·¨é¡µé¢é€šè®¯ç»ˆææŒ‡å—â‘¤ï¼šwindow.name ç”¨æ³•å…¨è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2824015112318094/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€è¯ºæ»šé›ªçƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T12:20:12.000Z" title="Sun Dec 07 2025 12:20:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨ä¹‹å‰çš„æ–‡ç« é‡Œï¼Œä»‹ç»äº† <code>BroadcastChannel</code> çš„å¹¿æ’­ã€<code>postMessage</code> çš„çµæ´»ä»¥åŠ <code>MessageChannel</code> çš„ç²¾å‡†ã€‚è¿™äº›ç°ä»£ API ä¸ºæˆ‘ä»¬æä¾›äº†æ ‡å‡†çš„é€šä¿¡èƒ½åŠ›ã€‚</p>
<p>ä»Šå¤©æˆ‘ä»¬è¦ä»‹ç»ä¸‹â€”â€”<code>window.name</code>ã€‚å®ƒä¸æ˜¯ä¸€ä¸ªä¸ºé€šä¿¡è€Œç”Ÿçš„ APIï¼Œä½†æ˜¯æœ‰å…¶ç‹¬ç‰¹çš„â€œè·¨é¡µé¢æŒä¹…æ€§â€ç‰¹æ€§ï¼Œæˆä¸ºè§£å†³è·¨åŸŸæ•°æ®ä¼ è¾“é—®é¢˜çš„æ–¹æ¡ˆä¹‹ä¸€ã€‚</p>
<h2 data-id="heading-1">1. window.nameæ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p><code>window.name</code> æ˜¯ä¸€ä¸ªæå…¶ç®€å•çš„å±æ€§ï¼Œå®ƒçš„åŸå§‹è®¾è®¡ç›®çš„æ˜¯ç”¨æ¥è®¾ç½®æˆ–è·å–çª—å£ï¼ˆæµè§ˆå™¨æ ‡ç­¾é¡µï¼‰çš„åç§°ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// è®¾ç½®çª—å£åç§°</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'My Awesome Window'</span>;

<span class="hljs-comment">// è·å–çª—å£åç§°</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">name</span>); <span class="hljs-comment">// 'My Awesome Window'</span>
</code></pre>
<p>å®ƒæœ‰ä¸€ä¸ª<strong>é‡è¦</strong>çš„ç‰¹æ€§ï¼š</p>
<blockquote>
<p><strong>åªè¦æ˜¯åœ¨åŒä¸€ä¸ªæµè§ˆå™¨æ ‡ç­¾é¡µä¸­ï¼Œå³ä½¿é¡µé¢å‘ç”Ÿäº†è·³è½¬ï¼ˆä»ä¸€ä¸ªåŸŸååˆ°å¦ä¸€ä¸ªåŸŸåï¼‰ï¼Œ<code>window.name</code> çš„å€¼ä¹Ÿä¸ä¼šè¢«é‡ç½®ï¼Œå®ƒä¼šä¸€ç›´ä¿ç•™ã€‚</strong> æ›´æƒŠäººçš„æ˜¯ï¼Œå®ƒçš„å®¹é‡éå¸¸å¤§ï¼Œé€šå¸¸å¯ä»¥è¾¾åˆ° <strong>2MB</strong> å·¦å³ï¼</p>
</blockquote>
<h2 data-id="heading-2">2. <code>window.name</code> çš„ä½œç”¨åŸŸ</h2>
<p><code>window.name</code> å±æ€§æ˜¯å±äº<strong>æ¯ä¸€ä¸ªç‹¬ç«‹çš„çª—å£ä¸Šä¸‹æ–‡ï¼ˆWindow Context</strong>çš„ã€‚</p>
<ol>
<li><strong>çˆ¶é¡µé¢</strong>æ˜¯ä¸€ä¸ªçª—å£ä¸Šä¸‹æ–‡ï¼Œå®ƒæœ‰è‡ªå·±çš„ <code>window.name</code>ã€‚</li>
<li><strong>iframe å­é¡µé¢</strong>æ˜¯å¦ä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„çª—å£ä¸Šä¸‹æ–‡ï¼Œå®ƒä¹Ÿæœ‰<strong>è‡ªå·±</strong>çš„ <code>window.name</code>ã€‚</li>
</ol>
<p>å®ƒä»¬æ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„å˜é‡ï¼Œäº’ä¸å½±å“ã€‚å½“ä½ åœ¨å­é¡µé¢ä¸­ç›´æ¥è°ƒç”¨ <code>window.name</code> æ—¶ï¼Œä½ è®¿é—®çš„æ˜¯<strong>å­é¡µé¢è‡ªå·±</strong>çš„ <code>name</code>ï¼Œè€Œä¸æ˜¯çˆ¶é¡µé¢çš„ã€‚</p>
<h3 data-id="heading-3">2.1 å¦‚ä½•æ­£ç¡®è®¿é—®çˆ¶é¡µé¢çš„ <code>window.name</code></h3>
<p>è™½ç„¶ä¸èƒ½ç›´æ¥è¯»å–ï¼Œä½† iframe æä¾›äº†è®¿é—®çˆ¶çª—å£çš„è·¯å¾„ï¼š<code>window.parent</code>,å¯ä»¥é€šè¿‡<code>iframe.contentWindow.name</code>è®¾ç½®å­é¡µé¢çš„nameã€‚</p>
<blockquote>
<p><strong>å…³é”®ç‚¹ï¼š</strong> iframe çš„åˆ·æ–°åªä¼šé‡ç½®å®ƒ<strong>è‡ªå·±</strong>çš„ <code>window.name</code>ï¼Œå¯¹çˆ¶é¡µé¢çš„ <code>window.name</code> æ¯«æ— å½±å“ã€‚å¹¶ä¸”å¦‚æœéœ€è¦è®¾ç½®å­é¡µé¢çš„nameï¼Œå¿…é¡»æ˜¯åŒæºã€‚</p>
</blockquote>
<p>åªèƒ½è¯»å–åŒæºå­é¡µé¢çš„nameï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c507432879df4fffa238e1fa90d8899e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA6K-65rua6Zuq55CD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765714812&amp;x-signature=FopTWfuXQup3T2%2Fl0DDjuVUV3EI%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-4">3. å®æˆ˜æ¡ˆä¾‹</h2>
<p>é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜ï¼Œå…·ä½“çœ‹ä»£ç ï¼š</p>
<ol>
<li>çˆ¶é¡µé¢ (<code>parent.html</code>)</li>
</ol>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>çˆ¶é¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>è¿™æ˜¯çˆ¶é¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>çˆ¶é¡µé¢çš„ window.name: <span class="hljs-tag">&lt;<span class="hljs-name">strong</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"parentName"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">hr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"child.html"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"myIframe"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 100%; height: 300px; border: 1px solid black;"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-comment">// 1. è®¾ç½®çˆ¶é¡µé¢çš„ name</span>
        <span class="hljs-variable language_">window</span>.<span class="hljs-property">name</span> = <span class="hljs-string">"æˆ‘æ˜¯çˆ¶é¡µé¢çš„ç§˜å¯†æ•°æ®"</span>;
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'parentName'</span>).<span class="hljs-property">textContent</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">name</span>;

        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'çˆ¶é¡µé¢: å·²è®¾ç½® window.name ='</span>, <span class="hljs-variable language_">window</span>.<span class="hljs-property">name</span>);
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<ol start="2">
<li>å­é¡µé¢ (<code>child.html</code>)</li>
</ol>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>å­é¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>è¿™æ˜¯ iframe å­é¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"location.reload()"</span>&gt;</span>åˆ·æ–°æœ¬é¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">hr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>å­é¡µé¢è‡ªå·±çš„ window.name:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"childName"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>é€šè¿‡ window.parent.name è®¿é—®çˆ¶é¡µé¢:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"parentNameFromChild"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">updateDisplay</span>(<span class="hljs-params"/>) {
            <span class="hljs-comment">// è¯»å–å­é¡µé¢è‡ªå·±çš„ name</span>
            <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'childName'</span>).<span class="hljs-property">textContent</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">name</span> || <span class="hljs-string">'(ç©º)'</span>;

            <span class="hljs-comment">// é€šè¿‡ window.parent.name è®¿é—®çˆ¶é¡µé¢çš„ name</span>
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">const</span> parentName = <span class="hljs-variable language_">window</span>.<span class="hljs-property">parent</span>.<span class="hljs-property">name</span>;
                <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'parentNameFromChild'</span>).<span class="hljs-property">textContent</span> = parentName;
            } <span class="hljs-keyword">catch</span> (e) {
                <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'parentNameFromChild'</span>).<span class="hljs-property">textContent</span> = <span class="hljs-string">'è®¿é—®å¤±è´¥ (è·¨åŸŸ?)'</span>;
            }
        }
        <span class="hljs-title function_">updateDisplay</span>();

        <span class="hljs-comment">// ä¸ºäº†æ¼”ç¤ºï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è®¾ç½®ä¸€ä¸‹å­é¡µé¢è‡ªå·±çš„ name</span>
        <span class="hljs-variable language_">window</span>.<span class="hljs-property">name</span> = <span class="hljs-string">"æˆ‘æ˜¯å­é¡µé¢è‡ªå·±çš„æ•°æ®"</span>;
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>å­é¡µé¢ä¼šæ˜¾ç¤ºï¼š<code>å­é¡µé¢è‡ªå·±çš„ window.name: æˆ‘æ˜¯å­é¡µé¢è‡ªå·±çš„æ•°æ®</code>,å­é¡µé¢ä¼šæ˜¾ç¤ºï¼š<code>é€šè¿‡ window.parent.name è®¿é—®çˆ¶é¡µé¢: æˆ‘æ˜¯çˆ¶é¡µé¢çš„ç§˜å¯†æ•°æ®</code>ã€‚
<strong>ç‚¹å‡»â€œåˆ·æ–°æœ¬é¡µé¢â€æŒ‰é’®å</strong>ï¼šå­é¡µé¢ä¼šé‡æ–°åŠ è½½ï¼Œå…¶<strong>è‡ªå·±</strong>çš„ <code>window.name</code> ä¼šè¢«é‡ç½®ä¸ºç©ºå­—ç¬¦ä¸²ã€‚ä½†æ˜¯ï¼Œ<code>window.parent.name</code> çš„å€¼<strong>ä¾ç„¶æ˜¯</strong> <code>æˆ‘æ˜¯çˆ¶é¡µé¢çš„ç§˜å¯†æ•°æ®</code>ï¼Œå®Œå…¨ä¸å—å½±å“ã€‚</p>
<h2 data-id="heading-5">4. æ€»ç»“</h2>
<p>æœ€åæ€»ç»“ä¸€ä¸‹ï¼šwindow.nameä½œä¸ºæµè§ˆå™¨çš„ä¸€ä¸ªè€å¤è‘£æ–¹æ¡ˆï¼Œç®€å•äº†è§£ä»‹ç»ä¸‹ï¼Œå¦‚æœéœ€è¦é€šè®¯ï¼Œè¿˜æ˜¯æ¨è<code>postMessage</code>ç­‰é€šè®¯æ–¹å¼ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è‰æ¢… Auth 1.11.1 ç‰ˆæœ¬å‘å¸ƒä¸ AI è¾…åŠ©ä»£ç é‡æ„å®è·µ | 2025 å¹´ç¬¬ 49 å‘¨è‰æ¢…å‘¨æŠ¥]]></title>    <link>https://juejin.cn/post/7580606750290853939</link>    <guid>https://juejin.cn/post/7580606750290853939</guid>    <pubDate>2025-12-07T12:35:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580606750290853939" data-draft-id="7580378958073511946" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è‰æ¢… Auth 1.11.1 ç‰ˆæœ¬å‘å¸ƒä¸ AI è¾…åŠ©ä»£ç é‡æ„å®è·µ | 2025 å¹´ç¬¬ 49 å‘¨è‰æ¢…å‘¨æŠ¥"/> <meta itemprop="keywords" content="GitHub,AIç¼–ç¨‹,å¼€æº"/> <meta itemprop="datePublished" content="2025-12-07T12:35:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‰æ¢…å‹ä»"/> <meta itemprop="url" content="https://juejin.cn/user/3043088413495815"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è‰æ¢… Auth 1.11.1 ç‰ˆæœ¬å‘å¸ƒä¸ AI è¾…åŠ©ä»£ç é‡æ„å®è·µ | 2025 å¹´ç¬¬ 49 å‘¨è‰æ¢…å‘¨æŠ¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3043088413495815/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‰æ¢…å‹ä»
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T12:35:00.000Z" title="Sun Dec 07 2025 12:35:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmyr.ltd" target="_blank" title="https://blog.cmyr.ltd" ref="nofollow noopener noreferrer">è‰æ¢…å‹ä»çš„åšå®¢</a> å‘å¸ƒå’Œæ›´æ–°ï¼Œå¹¶åœ¨å¤šä¸ªå¹³å°åŒæ­¥å‘å¸ƒã€‚å¦‚æœ‰æ›´æ–°ï¼Œä»¥åšå®¢ä¸Šçš„ç‰ˆæœ¬ä¸ºå‡†ã€‚æ‚¨ä¹Ÿå¯ä»¥é€šè¿‡æ–‡æœ«çš„ <code>åŸæ–‡é“¾æ¥</code> æŸ¥çœ‹æœ€æ–°ç‰ˆæœ¬ã€‚</p>
</blockquote>
<h2 data-id="heading-0">å‰è¨€</h2>
<p>æ¬¢è¿æ¥åˆ°è‰æ¢…å‘¨æŠ¥ï¼è¿™æ˜¯ä¸€ä¸ªç”±è‰æ¢…å‹ä»åŸºäº AI æ•´ç†çš„å‘¨æŠ¥ï¼Œæ—¨åœ¨ä¸ºæ‚¨æä¾›æœ€æ–°çš„åšå®¢æ›´æ–°ã€GitHub åŠ¨æ€ã€ä¸ªäººåŠ¨æ€å’Œå…¶ä»–å‘¨åˆŠæ–‡ç« æ¨èç­‰å†…å®¹ã€‚</p>
<hr/>
<p>æœ¬å‘¨ä¾æ—§åœ¨å¼€å‘ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCaoMeiYouRen%2Fcaomei-auth" target="_blank" title="https://github.com/CaoMeiYouRen/caomei-auth" ref="nofollow noopener noreferrer">è‰æ¢… Auth</a> ä¸­ã€‚</p>
<blockquote>
<p>ä½ ä¹Ÿå¯ä»¥ç›´æ¥è®¿é—®å®˜ç½‘åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fauth.cmyr.dev%2F" target="_blank" title="https://auth.cmyr.dev/" ref="nofollow noopener noreferrer">auth.cmyr.dev/</a>
Demo ç«™ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fauth-demo.cmyr.dev%2F" target="_blank" title="https://auth-demo.cmyr.dev/" ref="nofollow noopener noreferrer">auth-demo.cmyr.dev/</a>
æ–‡æ¡£åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fauth-docs.cmyr.dev%2F" target="_blank" title="https://auth-docs.cmyr.dev/" ref="nofollow noopener noreferrer">auth-docs.cmyr.dev/</a></p>
</blockquote>
<p>æœ¬å‘¨ è‰æ¢… Auth å‘å¸ƒäº† <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCaoMeiYouRen%2Fcaomei-auth%2Freleases%2Ftag%2Fv1.11.1" target="_blank" title="https://github.com/CaoMeiYouRen/caomei-auth/releases/tag/v1.11.1" ref="nofollow noopener noreferrer">1.11.1</a> ç‰ˆæœ¬ã€‚</p>
<p>ä¸»è¦æ˜¯ä¿®å¤äº†ä¸€äº›é—®é¢˜ï¼Œå’Œå¯¹é¡¹ç›®ä»£ç çš„ä¸€äº›é‡æ„ï¼Œæé«˜ä»£ç è´¨é‡ã€‚</p>
<p>æ­¤å¤–ï¼Œä¹Ÿå¯¹ better-auth ç‰ˆæœ¬æ›´æ–°åï¼Œå¯¼è‡´æ— æ³•é€šè¿‡é‚®ç®±ç™»å½•è‰æ¢… Auth çš„æ¶æ€§ BUG è¿›è¡Œäº†ä¿®å¤ã€‚</p>
<blockquote>
<p>è¯¦è§ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCaoMeiYouRen%2Fcaomei-auth%2Fissues%2F267" target="_blank" title="https://github.com/CaoMeiYouRen/caomei-auth/issues/267" ref="nofollow noopener noreferrer">#267</a></p>
</blockquote>
<p>å¦‚æœæƒ³äº†è§£å¦‚ä½•éƒ¨ç½²å’Œä½¿ç”¨é¡¹ç›®ï¼Œå¯ä»¥å‚è€ƒæ–‡æ¡£çš„å†…å®¹ï¼Œä¹Ÿæ¬¢è¿è¡¥å……æ–‡æ¡£ç¼ºå¤±çš„å†…å®¹ã€‚</p>
<p>å¦‚æœä½ å¯¹è‰æ¢… Auth æ„Ÿå…´è¶£ï¼Œæ¬¢è¿å‚ä¸å¼€å‘å’Œæµ‹è¯•ã€‚</p>
<hr/>
<p>åœ¨è¿™é‡Œæˆ‘ä¹Ÿç®€å•æä¸€ä¸‹æˆ‘æ˜¯å¦‚ä½•å€ŸåŠ© AI æ¥é‡æ„è‰æ¢… Auth çš„ã€‚</p>
<p>é¦–å…ˆï¼Œåœ¨è‰æ¢… Auth çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¸ºäº†è¿½æ±‚è¿›åº¦ï¼Œä¼˜å…ˆå®ç°åŠŸèƒ½ï¼Œæ‰€ä»¥åœ¨ä»£ç è´¨é‡ä¸Šä¸æ˜¯å¾ˆé«˜ï¼Œå‡ºç°äº†å¤§é‡çš„è€¦åˆä»£ç ã€è¡Œæ•°ä¸Šåƒçš„å•ä¸ªä»£ç æ–‡ä»¶ã€é‡å¤ä»£ç å—ã€ç¡¬ç¼–ç å­—ç¬¦ã€æµ‹è¯•è¦†ç›–ç‡ä¸é«˜ç­‰é—®é¢˜ã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘åšçš„ç¬¬ä¸€æ­¥å°±æ˜¯å…ˆè®© AIï¼ˆæ¯”å¦‚ Gemini 3 Proï¼‰å¯¹æ•´ä¸ªä»£ç åº“è¿›è¡Œåˆ†æï¼Œç”Ÿæˆä¸€ä»½ä»£ç é‡æ„æ–¹æ¡ˆã€‚</p>
<blockquote>
<p>å‚è€ƒï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCaoMeiYouRen%2Fcaomei-auth%2Fblob%2Fmaster%2Fdocs%2FREFACTOR_PLAN.md" target="_blank" title="https://github.com/CaoMeiYouRen/caomei-auth/blob/master/docs/REFACTOR_PLAN.md" ref="nofollow noopener noreferrer">REFACTOR_PLAN.md</a></p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/337c0bdc93da445fba79c5d55da44114~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5qKF5Y-L5LuB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765715700&amp;x-signature=PPJsPTyC6SRj3vAppIJdXQXL%2Bns%3D" alt="image-20251207195122796" loading="lazy"/></p>
<p>åœ¨æœ‰äº†æ–¹æ¡ˆä¹‹åï¼Œä¸‹ä¸€æ­¥å°±æ˜¯é‡‡ç”¨æŠ€æœ¯æŒ‡æ ‡ï¼Œå¯¹é¡¹ç›®çš„é‡æ„æ•ˆæœè¿›è¡Œè¯„ä¼°ã€‚</p>
<p>é¦–å…ˆæ˜¯æ§åˆ¶æ–‡ä»¶é•¿åº¦ï¼Œè¿™ä¸ªæ¯”è¾ƒç®€å•ï¼Œåœ¨ eslint çš„é…ç½®ä¸­æ·»åŠ  <code>max-lines</code> é…ç½®å³å¯ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-string">'max-lines'</span>: [<span class="hljs-number">1</span>, { <span class="hljs-attr">max</span>: <span class="hljs-number">800</span> }], <span class="hljs-comment">// å¼ºåˆ¶æ–‡ä»¶çš„æœ€å¤§è¡Œæ•°</span>
</code></pre>
<p>ç„¶åæ˜¯æµ‹è¯•è¦†ç›–ç‡ï¼Œè¿™ä¸ªç”± <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvitest-dev%2Fvitest" target="_blank" title="https://github.com/vitest-dev/vitest" ref="nofollow noopener noreferrer">vitest</a> æä¾›ï¼Œé€šè¿‡æ‰§è¡Œ <code>vitest run --coverage</code> å‘½ä»¤å³å¯æŸ¥çœ‹å½“å‰æµ‹è¯•è¦†ç›–ç‡ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/abf6527d728241d3be38a709eeb0b601~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5qKF5Y-L5LuB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765715700&amp;x-signature=YiCFj%2Fvd4mi%2F5nwlohsmdlZ6wnU%3D" alt="image-20251207200232960" loading="lazy"/></p>
<p>æœ€åæ˜¯ä»£ç é‡å¤ç‡ï¼Œè¿™ä¸ªç”± <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fkucherenko%2Fjscpd" target="_blank" title="https://github.com/kucherenko/jscpd" ref="nofollow noopener noreferrer">jscpd</a> æä¾›ï¼Œæ‰§è¡Œ <code>jscpd .</code> æŸ¥çœ‹å½“å‰ä»£ç ä¸­é‡å¤ç‰‡æ®µçš„æ•°é‡ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a7c1a9258c2844848b867d05f9a7819c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5qKF5Y-L5LuB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765715700&amp;x-signature=Z1Kc4nJFurlIh4GxsM4z%2FRfH5m0%3D" alt="image-20251207200513195" loading="lazy"/></p>
<p>æ§åˆ¶åœ¨ 5%ä»¥ä¸‹å°±è¿˜ç®—ä¸é”™ã€‚</p>
<p>åœ¨æœ‰äº†å…·ä½“çš„æŠ€æœ¯æŒ‡æ ‡åï¼Œåç»­ä»£ç é‡æ„ä¹Ÿå°±æœ‰äº†æ•°æ®æ”¯æŒï¼Œå¯ä»¥å®šé‡çš„è¯„ä¼°é‡æ„æ•ˆæœã€‚</p>
<h2 data-id="heading-1">GitHub Release</h2>
<h3 data-id="heading-2">caomei-auth</h3>
<h4 data-id="heading-3"><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCaoMeiYouRen%2Fcaomei-auth%2Freleases%2Ftag%2Fv1.11.1" target="_blank" title="https://github.com/CaoMeiYouRen/caomei-auth/releases/tag/v1.11.1" ref="nofollow noopener noreferrer">v1.11.1</a> - 2025-12-06 20:40:12</h4>
<p>æ‘˜è¦:
ç‰ˆæœ¬ 1.11.1 æ‘˜è¦ (2025-12-06)</p>
<p>Bug ä¿®å¤:</p>
<ul>
<li>ä¼˜åŒ–ç®¡ç†å‘˜è§’è‰²åŒæ­¥åŠŸèƒ½çš„æ•°æ®æºåŠ è½½æ–¹å¼</li>
<li>ä¸º Twitter ç™»å½•æ·»åŠ æ‰€éœ€ scopes</li>
<li>è°ƒæ•´ ESLint è§„åˆ™ï¼Œå°†æœ€å¤§è¡Œæ•°é™åˆ¶æ”¹ä¸º 800 è¡Œ</li>
</ul>
<p>ä»£ç é‡æ„:</p>
<ul>
<li>é‚®ä»¶æ¨¡æ¿å¼•æ“é‡æ„ï¼Œæå–å›é€€æ¨¡æ¿åˆ°ç‹¬ç«‹æ¨¡å—</li>
<li>é‚®ä»¶å‘é€é€»è¾‘é‡æ„ï¼Œå¼•å…¥ä¾èµ–æ³¨å…¥å’Œé™æµæœºåˆ¶</li>
<li>ä¼˜åŒ–æ‰‹æœºåŠŸèƒ½å¯ç”¨é€»è¾‘ï¼Œä½¿ç”¨ç©ºå€¼åˆå¹¶è¿ç®—ç¬¦å¤„ç†ç¯å¢ƒå˜é‡</li>
<li>å¯¼èˆªç³»ç»Ÿæ”¹è¿›ï¼Œå¼•å…¥ä¾èµ–æ³¨å…¥æœºåˆ¶ä¼˜åŒ–ç™»å½•è·³è½¬é€»è¾‘</li>
<li>ç”¨æˆ·ä¸ªäººèµ„æ–™ç»„ä»¶é‡æ„ï¼ŒåŒ…æ‹¬å¯¹è¯æ¡†å’Œç®¡ç†å‘˜æ—¥å¿—é¡µé¢</li>
<li>çŸ­ä¿¡å‘é€é€»è¾‘é‡æ„ï¼Œå¢åŠ ä¾èµ–æ³¨å…¥å’Œé™æµæœºåˆ¶ï¼Œæ”¯æŒå¤šæ¸ é“å‘é€</li>
<li>TypeORM é€‚é…å™¨å¢å¼ºï¼Œæ”¯æŒå…³ç³»å¤„ç†å’Œäº‹åŠ¡ç®¡ç†</li>
<li>å®‰å…¨è®¾ç½®é¡µé¢é‡æ„ä¸ºç»„åˆå¼å‡½æ•°å’Œç»„ä»¶åŒ–æ¶æ„</li>
<li>User å’Œ Application æ¨¡å—é‡æ„</li>
<li>ä½¿ç”¨ä¸“é—¨çš„ provider å¯¹è¯æ¡†æ›¿æ¢åŸæœ‰ç»„ä»¶ï¼Œç®€åŒ–æä¾›è€…ç®¡ç†é€»è¾‘</li>
</ul>
<h2 data-id="heading-4">æœ€æ–° GitHub åŠ æ˜Ÿä»“åº“</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Frouter-for-me%2FCLIProxyAPI" target="_blank" title="https://github.com/router-for-me/CLIProxyAPI" ref="nofollow noopener noreferrer">CaoMeiYouRen starred CLIProxyAPI</a> - 2025-12-07 18:17:46
è¯¥é¡¹ç›®ä½¿ç”¨ Go è¯­è¨€å¼€å‘ï¼Œå°†å¤šä¸ªä¸»æµ AI æ¨¡å‹(Gemini CLIã€ChatGPT Codexã€Claude Codeã€Qwen Codeã€iFlow)å°è£…æˆå…¼å®¹ OpenAI/Gemini/Claude/Codex çš„ API æœåŠ¡ã€‚ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ï¼š1)æä¾›ç»Ÿä¸€ API æ¥å£è®¿é—®ä¸åŒ AI æ¨¡å‹ï¼›2)æ”¯æŒå…è´¹ä½¿ç”¨ Gemini 2.5 Proã€GPT 5ã€Claude å’Œ Qwen ç­‰å…ˆè¿›æ¨¡å‹ï¼›3)åœ¨ GitHub ä¸Šè·å¾— 2202 ä¸ª starï¼Œæ˜¾ç¤ºå…¶å—æ¬¢è¿ç¨‹åº¦ï¼›4)å®ç°è·¨å¹³å°æ¨¡å‹è°ƒç”¨æ ‡å‡†åŒ–ã€‚è¯¥é¡¹ç›®ç®€åŒ–äº†å¼€å‘è€…é›†æˆå¤šç§ AI æœåŠ¡çš„è¿‡ç¨‹ã€‚</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffuergaosi233%2Fclaude-code-proxy" target="_blank" title="https://github.com/fuergaosi233/claude-code-proxy" ref="nofollow noopener noreferrer">CaoMeiYouRen starred claude-code-proxy</a> - 2025-12-07 18:16:37
è¿™æ˜¯ä¸€ä¸ª Python ç¼–å†™çš„ Claude API åˆ° OpenAI API çš„ä»£ç†å·¥å…·ï¼Œå…è®¸å¼€å‘è€…é€šè¿‡ OpenAI API æ ¼å¼è®¿é—® Claude æ¨¡å‹ã€‚é¡¹ç›®åœ¨ GitHub ä¸Šè·å¾—äº† 1727 ä¸ªæ˜Ÿæ ‡ï¼Œè¡¨æ˜å…¶å—æ¬¢è¿ç¨‹åº¦è¾ƒé«˜ã€‚è¯¥å·¥å…·ä¸»è¦åŠŸèƒ½æ˜¯å°† OpenAI API è¯·æ±‚è½¬æ¢ä¸º Claude API å…¼å®¹æ ¼å¼ï¼Œä¾¿äºå¼€å‘è€…é›†æˆä½¿ç”¨ã€‚</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fkucherenko%2Fjscpd" target="_blank" title="https://github.com/kucherenko/jscpd" ref="nofollow noopener noreferrer">CaoMeiYouRen starred jscpd</a> - 2025-12-07 18:07:39
ç¼–ç¨‹æºä»£ç çš„å¤åˆ¶ç²˜è´´æ£€æµ‹å·¥å…·ï¼Œä¸»è¦ä½¿ç”¨ TypeScript è¯­è¨€å¼€å‘ï¼Œåœ¨ GitHub ä¸Šè·å¾— 5100 é¢—æ˜Ÿæ ‡ã€‚</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FTencent%2Ftdesign" target="_blank" title="https://github.com/Tencent/tdesign" ref="nofollow noopener noreferrer">CaoMeiYouRen starred tdesign</a> - 2025-12-06 01:09:35
ä¼ä¸šè®¾è®¡ç³»ç»Ÿ
ä¸»è¦è¯­è¨€ï¼šVue
GitHub æ˜Ÿæ ‡æ•°ï¼š3673</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fdeepseek-ai%2FDeepSeek-LLM" target="_blank" title="https://github.com/deepseek-ai/DeepSeek-LLM" ref="nofollow noopener noreferrer">CaoMeiYouRen starred DeepSeek-LLM</a> - 2025-12-02 22:25:53
DeepSeek LLM æ˜¯ä¸€æ¬¾äººå·¥æ™ºèƒ½è¯­è¨€æ¨¡å‹ï¼Œä¸»è¦ç¼–ç¨‹è¯­è¨€ä¸º Makefileï¼Œç›®å‰åœ¨ GitHub ä¸Šè·å¾— 6647 ä¸ªæ˜Ÿæ ‡ã€‚</li>
</ul>
<h2 data-id="heading-5">å…¶ä»–åšå®¢æˆ–å‘¨åˆŠæ¨è</h2>
<h3 data-id="heading-6">é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—</h3>
<ul>
<li><a href="https://link.juejin.cn?target=http%3A%2F%2Fwww.ruanyifeng.com%2Fblog%2F2025%2F12%2Fweekly-issue-376.html" target="_blank" title="http://www.ruanyifeng.com/blog/2025/12/weekly-issue-376.html" ref="nofollow noopener noreferrer">ç§‘æŠ€çˆ±å¥½è€…å‘¨åˆŠï¼ˆç¬¬ 376 æœŸï¼‰ï¼šå¤ªç©ºæ•°æ®ä¸­å¿ƒçš„äº‰è®®</a> - 2025-12-05 08:09:01</li>
</ul>
<h3 data-id="heading-7">é˜¿çŒ«çš„åšå®¢</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fameow.xyz%2Farchives%2Fweekly-087" target="_blank" title="https://ameow.xyz/archives/weekly-087" ref="nofollow noopener noreferrer">çŒ«é±¼å‘¨åˆŠ vol. 087 åšä¸€ä¸ª RSS é˜…è¯»å™¨</a> - 2025-12-07 19:35:35</li>
</ul>
<h3 data-id="heading-8">æ½®æµå‘¨åˆŠ</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fweekly.tw93.fun%2Fposts%2F247%2F" target="_blank" title="https://weekly.tw93.fun/posts/247/" ref="nofollow noopener noreferrer">ç¬¬ 247 æœŸ - ä¸œäº¬å¤§å­¦</a> - 2025-12-01 08:00:00</li>
</ul>
<h3 data-id="heading-9">äºŒä¸«è®²æ¢µçš„å­¦ä¹ å‘¨åˆŠ</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwiki.eryajf.net%2Fpages%2F462c25%2F" target="_blank" title="https://wiki.eryajf.net/pages/462c25/" ref="nofollow noopener noreferrer">å­¦ä¹ å‘¨åˆŠ-æ€»ç¬¬ 240 æœŸ-2025 å¹´ç¬¬ 49 å‘¨</a> - 2025-12-04 23:24:07</li>
</ul>
<h2 data-id="heading-10">æ€»ç»“</h2>
<p>æœ¬å‘¨çš„æ›´æ–°å’ŒåŠ¨æ€å¦‚ä¸Šæ‰€ç¤ºã€‚æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼
æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è®¢é˜…è‰æ¢…å‘¨æŠ¥çš„æ›´æ–°ï¼š</p>
<ul>
<li><strong>åšå®¢</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmyr.ltd" target="_blank" title="https://blog.cmyr.ltd" ref="nofollow noopener noreferrer">è‰æ¢…å‹ä»çš„åšå®¢</a></li>
<li><strong>RSS</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmyr.ltd%2Fweekly.xml" target="_blank" title="https://blog.cmyr.ltd/weekly.xml" ref="nofollow noopener noreferrer">è‰æ¢…å‘¨æŠ¥</a></li>
<li><strong>å…¬ä¼—å·</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Foss.cmyr.dev%2Fimages%2F20241025184516839-21n2ctv.png" target="_blank" title="https://oss.cmyr.dev/images/20241025184516839-21n2ctv.png" ref="nofollow noopener noreferrer">è‰æ¢…å‹ä»çš„åèŠ±å›­</a></li>
<li><strong>é‚®ç®±è®¢é˜…</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Flistmonk.cmyr.dev%2Fsubscription%2Fform" target="_blank" title="https://listmonk.cmyr.dev/subscription/form" ref="nofollow noopener noreferrer">è‰æ¢…å‹ä»çš„åšå®¢è®¢é˜…</a></li>
</ul>
<h2 data-id="heading-11">å¾€æœŸå›é¡¾</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmyr.ltd%2Farchives%2F2025-48-caomei-weekly-nano-banana-pro-ai-image-generation.html" target="_blank" title="https://blog.cmyr.ltd/archives/2025-48-caomei-weekly-nano-banana-pro-ai-image-generation.html" ref="nofollow noopener noreferrer">Nano Banana Pro AI å›¾åƒç”Ÿæˆæ¨¡å‹ä¸åˆ›æ„å®è·µ | 2025 å¹´ç¬¬ 48 å‘¨è‰æ¢…å‘¨æŠ¥</a> - 2025-11-30 20:30:59</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmyr.ltd%2Farchives%2F2025-47-caomei-weekly-cloudflare-outage-nano-banana-pro.html" target="_blank" title="https://blog.cmyr.ltd/archives/2025-47-caomei-weekly-cloudflare-outage-nano-banana-pro.html" ref="nofollow noopener noreferrer">Cloudflare æœåŠ¡ä¸­æ–­ä¸ AI å›¾åƒç”Ÿæˆæ¨¡å‹ nano-banana-pro | 2025 å¹´ç¬¬ 47 å‘¨è‰æ¢…å‘¨æŠ¥</a> - 2025-11-23 23:08:45</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmyr.ltd%2Farchives%2F2025-46-caomei-weekly-code-refactoring-test-coverage.html" target="_blank" title="https://blog.cmyr.ltd/archives/2025-46-caomei-weekly-code-refactoring-test-coverage.html" ref="nofollow noopener noreferrer">ä»£ç é‡æ„ä¸æµ‹è¯•è¦†ç›–ç‡æå‡å®è·µ | 2025 å¹´ç¬¬ 46 å‘¨è‰æ¢…å‘¨æŠ¥</a> - 2025-11-16 20:18:53</li>
</ul>
<p>æœ¬æ–‡ä½œè€…ï¼šè‰æ¢…å‹ä»<br/>æœ¬æ–‡åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmyr.ltd%2Farchives%2F2025-49-caomei-weekly-caomei-auth-1-11-1-release-and-ai-refactoring.html" target="_blank" title="https://blog.cmyr.ltd/archives/2025-49-caomei-weekly-caomei-auth-1-11-1-release-and-ai-refactoring.html" ref="nofollow noopener noreferrer">blog.cmyr.ltd/archives/20â€¦</a><br/>ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡é‡‡ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcreativecommons.org%2Flicenses%2Fby-nc-sa%2F4.0%2Fdeed.zh-hans" target="_blank" title="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans" ref="nofollow noopener noreferrer">CC BY-NC-SA 4.0 åè®®</a> è¿›è¡Œåˆ†å‘ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼<br/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€å²©çŸ³ç§ç±»è¯†åˆ«ç³»ç»Ÿã€‘Python+TensorFlow+Django+äººå·¥æ™ºèƒ½+æ·±åº¦å­¦ä¹ +å·ç§¯ç¥ç»ç½‘ç»œç®—æ³•]]></title>    <link>https://juejin.cn/post/7580374090365927462</link>    <guid>https://juejin.cn/post/7580374090365927462</guid>    <pubDate>2025-12-07T12:43:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580374090365927462" data-draft-id="7581004702927208457" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€å²©çŸ³ç§ç±»è¯†åˆ«ç³»ç»Ÿã€‘Python+TensorFlow+Django+äººå·¥æ™ºèƒ½+æ·±åº¦å­¦ä¹ +å·ç§¯ç¥ç»ç½‘ç»œç®—æ³•"/> <meta itemprop="keywords" content="å›¾åƒè¯†åˆ«,æ·±åº¦å­¦ä¹ ,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-07T12:43:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ziwu"/> <meta itemprop="url" content="https://juejin.cn/user/607373397353726"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€å²©çŸ³ç§ç±»è¯†åˆ«ç³»ç»Ÿã€‘Python+TensorFlow+Django+äººå·¥æ™ºèƒ½+æ·±åº¦å­¦ä¹ +å·ç§¯ç¥ç»ç½‘ç»œç®—æ³•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/607373397353726/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ziwu
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T12:43:38.000Z" title="Sun Dec 07 2025 12:43:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ä»‹ç»</h2>
<p>å²©çŸ³ç§ç±»è¯†åˆ«ç³»ç»Ÿï¼ŒåŸºäºTensorFlowæ­å»ºResnet50å·ç§¯ç¥ç»ç½‘ç»œç®—æ³•ï¼Œé€šè¿‡å¯¹7ç§å¸¸è§çš„å²©çŸ³å›¾ç‰‡æ•°æ®é›†ï¼ˆ'ç„æ­¦å²©ï¼ˆBasaltï¼‰', 'ç…¤ï¼ˆCoalï¼‰', 'èŠ±å²—å²©ï¼ˆGraniteï¼‰', 'çŸ³ç°å²©ï¼ˆLimestoneï¼‰', 'å¤§ç†çŸ³ï¼ˆMarbleï¼‰', 'çŸ³è‹±å²©ï¼ˆQuartziteï¼‰', 'ç ‚å²©ï¼ˆSandstoneï¼‰'ï¼‰è¿›è¡Œè®­ç»ƒï¼Œæœ€åå¾—åˆ°ä¸€ä¸ªè¯†åˆ«ç²¾åº¦è¾ƒé«˜çš„æ¨¡å‹ï¼Œç„¶åæ­å»ºWebå¯è§†åŒ–æ“ä½œå¹³å°ã€‚</p>
<p><strong>æŠ€æœ¯æ ˆ</strong>ï¼š</p>
<ul>
<li>é¡¹ç›®å‰ç«¯ä½¿ç”¨Htmlã€CSSã€BootStrapæ­å»ºç•Œé¢ã€‚</li>
<li>åç«¯åŸºäºDjangoå¤„ç†é€»è¾‘è¯·æ±‚</li>
<li>åŸºäºAjaxå®ç°å‰åç«¯æ•°æ®é€šä¿¡</li>
</ul>
<p><strong>é€‰é¢˜èƒŒæ™¯ä¸æ„ä¹‰</strong>ï¼š
åœ¨åœ°è´¨å‹˜æ¢ã€èµ„æºå¼€å‘åŠå·¥ç¨‹å‹˜å¯Ÿç­‰é¢†åŸŸï¼Œå¿«é€Ÿå‡†ç¡®åœ°è¯†åˆ«å²©çŸ³ç±»å‹å…·æœ‰é‡è¦çš„å®é™…æ„ä¹‰ã€‚ä¼ ç»Ÿå²©çŸ³é‰´å®šæ–¹æ³•å¤šä¾èµ–äºäººå·¥ç›®è§†æˆ–ç‰©ç†åŒ–å­¦åˆ†æï¼Œå­˜åœ¨æ•ˆç‡ä½ã€ä¸»è§‚æ€§å¼ºç­‰å±€é™æ€§ã€‚éšç€è®¡ç®—æœºè§†è§‰ä¸æ·±åº¦å­¦ä¹ æŠ€æœ¯çš„å¿«é€Ÿå‘å±•ï¼Œåˆ©ç”¨å·ç§¯ç¥ç»ç½‘ç»œè‡ªåŠ¨è¯†åˆ«å²©çŸ³å›¾åƒå·²æˆä¸ºå¯èƒ½ï¼Œæœ‰åŠ©äºæå‡é‰´å®šçš„è‡ªåŠ¨åŒ–æ°´å¹³ä¸å®¢è§‚æ€§ã€‚æœ¬é¡¹ç›®åŸºäºTensorFlowæ¡†æ¶ï¼Œé‡‡ç”¨ResNet50å·ç§¯ç¥ç»ç½‘ç»œç»“æ„ï¼Œé’ˆå¯¹ç„æ­¦å²©ã€ç…¤ã€èŠ±å²—å²©ç­‰ä¸ƒç±»å¸¸è§å²©çŸ³æ„å»ºå›¾åƒè¯†åˆ«æ¨¡å‹ï¼Œå¹¶å¼€å‘äº†ä¸€å¥—é›†æˆå‰åç«¯çš„Webå¯è§†åŒ–æ“ä½œå¹³å°ã€‚é€šè¿‡è¯¥ç³»ç»Ÿï¼Œç”¨æˆ·å¯ä¾¿æ·ä¸Šä¼ å²©çŸ³å›¾ç‰‡å¹¶è·å–å®æ—¶è¯†åˆ«ç»“æœï¼Œä»è€Œä¸ºåœ°è´¨å·¥ä½œè€…åŠç›¸å…³é¢†åŸŸæä¾›ä¸€ç§é«˜æ•ˆã€ç›´è§‚çš„æ™ºèƒ½è¯†åˆ«å·¥å…·ï¼Œæ¨åŠ¨å²©çŸ³é‰´å®šçš„æ•°å­—åŒ–ä¸æ™ºèƒ½åŒ–è½¬å‹ã€‚</p>
<h2 data-id="heading-1">äºŒã€ç³»ç»Ÿæ•ˆæœå›¾ç‰‡å±•ç¤º</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dc316dc86b9744b68b1e81c4017b7be2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeml3dQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765716217&amp;x-signature=dhW2MWqI3x4qibi1bgp3%2FpClBWk%3D" alt="å›¾ç‰‡" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8f23c7cb94df4f2f973c4489e7e5a9bc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeml3dQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765716217&amp;x-signature=Xz2HvcNap2I5PGLTX0SxSl%2FsIJQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-2">ä¸‰ã€æ¼”ç¤ºè§†é¢‘ and å®Œæ•´ä»£ç  and å®‰è£…</h2>
<p>åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fziwupy.cn%2Fp%2FUQNsxn" target="_blank" title="https://ziwupy.cn/p/UQNsxn" ref="nofollow noopener noreferrer">ziwupy.cn/p/UQNsxn</a></p>
<h2 data-id="heading-3">å››ã€å·ç§¯ç¥ç»ç½‘ç»œç®—æ³•ä»‹ç»</h2>
<p>ResNet50æ˜¯ç”±å¾®è½¯ç ”ç©¶é™¢æå‡ºçš„æ·±åº¦æ®‹å·®ç½‘ç»œï¼Œå…¶æ ¸å¿ƒåˆ›æ–°æ˜¯å¼•å…¥â€œæ®‹å·®è¿æ¥â€ç»“æ„ã€‚è¯¥ç»“æ„é€šè¿‡è·¨å±‚è·³è·ƒè¿æ¥ï¼Œå°†ä½å±‚ç‰¹å¾ç›´æ¥ä¼ é€’è‡³æ›´æ·±çš„ç½‘ç»œå±‚ï¼Œæœ‰æ•ˆç¼“è§£äº†æ·±åº¦ç¥ç»ç½‘ç»œä¸­æ¢¯åº¦æ¶ˆå¤±ä¸ç½‘ç»œé€€åŒ–çš„é—®é¢˜ï¼Œä½¿å¾—æ„å»ºè¶…è¿‡ç™¾å±‚çš„æ·±åº¦ç½‘ç»œæˆä¸ºå¯èƒ½ã€‚ResNet50åŒ…å«50ä¸ªå·ç§¯å±‚ï¼Œåœ¨ImageNetå›¾åƒåˆ†ç±»ä»»åŠ¡ä¸­è¡¨ç°ä¼˜å¼‚ï¼Œè¢«å¹¿æ³›ç”¨ä½œç‰¹å¾æå–çš„éª¨å¹²ç½‘ç»œã€‚å…¶æ®‹å·®æ¨¡å—é€šå¸¸ç”±å¤šä¸ªå·ç§¯å±‚å’Œæ‰¹é‡å½’ä¸€åŒ–ã€æ¿€æ´»å‡½æ•°ç»„æˆï¼Œå¹¶é€šè¿‡æ·å¾„è¿æ¥å®ç°æ’ç­‰æ˜ å°„ï¼Œç¡®ä¿äº†æ·±å±‚ç½‘ç»œè®­ç»ƒçš„ç¨³å®šæ€§ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªåŸºäºTensorFlowè°ƒç”¨ResNet50è¿›è¡Œå›¾åƒåˆ†ç±»çš„ç®€å•ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> tensorflow <span class="hljs-keyword">as</span> tf
<span class="hljs-keyword">from</span> tensorflow.keras.applications.resnet50 <span class="hljs-keyword">import</span> ResNet50
<span class="hljs-keyword">from</span> tensorflow.keras.preprocessing <span class="hljs-keyword">import</span> image
<span class="hljs-keyword">from</span> tensorflow.keras.applications.resnet50 <span class="hljs-keyword">import</span> preprocess_input, decode_predictions
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

<span class="hljs-comment"># åŠ è½½é¢„è®­ç»ƒçš„ResNet50æ¨¡å‹ï¼ˆä¸åŒ…å«é¡¶å±‚å…¨è¿æ¥å±‚ï¼‰</span>
model = ResNet50(weights=<span class="hljs-string">'imagenet'</span>)

<span class="hljs-comment"># åŠ è½½å¹¶é¢„å¤„ç†å›¾åƒ</span>
img_path = <span class="hljs-string">'your_image.jpg'</span>
img = image.load_img(img_path, target_size=(<span class="hljs-number">224</span>, <span class="hljs-number">224</span>))
x = image.img_to_array(img)
x = np.expand_dims(x, axis=<span class="hljs-number">0</span>)
x = preprocess_input(x)

<span class="hljs-comment"># è¿›è¡Œé¢„æµ‹</span>
preds = model.predict(x)
<span class="hljs-comment"># è§£ç é¢„æµ‹ç»“æœ</span>
decoded_preds = decode_predictions(preds, top=<span class="hljs-number">3</span>)[<span class="hljs-number">0</span>]
<span class="hljs-built_in">print</span>(<span class="hljs-string">'é¢„æµ‹ç»“æœ:'</span>, decoded_preds)
</code></pre>
<p>ä»¥ä¸Šä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨é¢„è®­ç»ƒçš„ResNet50æ¨¡å‹å¯¹å•å¼ å›¾åƒè¿›è¡Œåˆ†ç±»ã€‚ç¨‹åºé¦–å…ˆåŠ è½½æ¨¡å‹ï¼Œç„¶åå¯¹è¾“å…¥å›¾åƒè¿›è¡Œé¢„å¤„ç†å¹¶è°ƒæ•´ä¸º224Ã—224åƒç´ ï¼Œæœ€åè¾“å‡ºImageNetæ•°æ®é›†ä¸­æœ€å¯èƒ½çš„ä¸‰ä¸ªç±»åˆ«åŠå…¶ç½®ä¿¡åº¦ã€‚è¯¥é¢„è®­ç»ƒæ¨¡å‹å¯ç›´æ¥ç”¨äºè¿ç§»å­¦ä¹ ï¼Œé€šè¿‡å¾®è°ƒé¡¶å±‚ç½‘ç»œå³å¯å¿«é€Ÿé€‚é…æ–°çš„å›¾åƒè¯†åˆ«ä»»åŠ¡ï¼Œå¦‚æœ¬æ–‡æ‰€è¿°çš„å²©çŸ³åˆ†ç±»åº”ç”¨ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7a500dcdac664d87bc7f1367247a969b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeml3dQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765716217&amp;x-signature=1xKAI33RQ4yY4gQsuvILsqgMTOA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>æµç¨‹è¯´æ˜ï¼š</strong></p>
<ol>
<li><strong>è¾“å…¥å±‚</strong>ï¼šæ¥æ”¶åŸå§‹å›¾åƒæ•°æ®ï¼ˆå¦‚224Ã—224Ã—3çš„RGBå›¾åƒï¼‰</li>
<li><strong>å·ç§¯å±‚</strong>ï¼šé€šè¿‡å¤šä¸ªå·ç§¯æ ¸æå–å±€éƒ¨ç‰¹å¾ï¼ˆè¾¹ç¼˜ã€çº¹ç†ç­‰ï¼‰ï¼Œç”Ÿæˆç‰¹å¾å›¾</li>
<li><strong>æ± åŒ–å±‚</strong>ï¼šå¯¹ç‰¹å¾å›¾è¿›è¡Œä¸‹é‡‡æ ·ï¼ˆå¸¸ç”¨æœ€å¤§æ± åŒ–ï¼‰ï¼Œå‡å°‘å‚æ•°å¹¶å¢å¼ºç‰¹å¾ä¸å˜æ€§</li>
<li><strong>å…¨è¿æ¥å±‚</strong>ï¼šå°†ç‰¹å¾å±•å¹³åé€šè¿‡å¤šå±‚ç¥ç»ç½‘ç»œè¾“å‡ºæœ€ç»ˆåˆ†ç±»ç»“æœ</li>
</ol>
<p>è¿™ç§ç»å…¸çš„â€œå·ç§¯-æ± åŒ–-å…¨è¿æ¥â€ç»“æ„æ˜¯CNNçš„åŸºç¡€èŒƒå¼ï¼ŒResNetç­‰ç°ä»£ç½‘ç»œåœ¨æ­¤åŸºç¡€ä¸Šå¢åŠ äº†æ®‹å·®è¿æ¥ã€æ‰¹é‡å½’ä¸€åŒ–ç­‰æ¨¡å—æ¥ä¼˜åŒ–æ·±å±‚ç½‘ç»œè®­ç»ƒã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¤é¥®ä¾›åº”é“¾çš„æ•°ä»“è®¾è®¡æ€è€ƒ ï¼ˆå…­ï¼‰ æ•°æ®åˆ†æä¸ä¸šåŠ¡é¢„æµ‹æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7580550040395497507</link>    <guid>https://juejin.cn/post/7580550040395497507</guid>    <pubDate>2025-12-07T12:53:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580550040395497507" data-draft-id="7580570363602239540" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¤é¥®ä¾›åº”é“¾çš„æ•°ä»“è®¾è®¡æ€è€ƒ ï¼ˆå…­ï¼‰ æ•°æ®åˆ†æä¸ä¸šåŠ¡é¢„æµ‹æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="æ•°æ®åˆ†æ"/> <meta itemprop="datePublished" content="2025-12-07T12:53:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¯­è½å¿ƒç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/2875978147955741"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¤é¥®ä¾›åº”é“¾çš„æ•°ä»“è®¾è®¡æ€è€ƒ ï¼ˆå…­ï¼‰ æ•°æ®åˆ†æä¸ä¸šåŠ¡é¢„æµ‹æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2875978147955741/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¯­è½å¿ƒç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T12:53:48.000Z" title="Sun Dec 07 2025 12:53:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç›®å½•</h2>
<ol>
<li><a href="#%E6%96%B9%E6%A1%88%E6%A6%82%E8%BF%B0" title="#%E6%96%B9%E6%A1%88%E6%A6%82%E8%BF%B0">æ–¹æ¡ˆæ¦‚è¿°</a></li>
<li><a href="#%E9%97%A8%E5%BA%97%E8%BF%90%E8%90%A5%E6%B7%B1%E5%BA%A6%E5%88%86%E6%9E%90" title="#%E9%97%A8%E5%BA%97%E8%BF%90%E8%90%A5%E6%B7%B1%E5%BA%A6%E5%88%86%E6%9E%90">é—¨åº—è¿è¥æ·±åº¦åˆ†æ</a></li>
<li><a href="#%E5%B8%82%E5%9C%BA%E8%90%A5%E9%94%80%E6%95%B0%E6%8D%AE%E8%B5%8B%E8%83%BD" title="#%E5%B8%82%E5%9C%BA%E8%90%A5%E9%94%80%E6%95%B0%E6%8D%AE%E8%B5%8B%E8%83%BD">å¸‚åœºè¥é”€æ•°æ®èµ‹èƒ½</a></li>
<li><a href="#%E4%BE%9B%E5%BA%94%E9%93%BE%E4%BC%98%E5%8C%96%E5%88%86%E6%9E%90" title="#%E4%BE%9B%E5%BA%94%E9%93%BE%E4%BC%98%E5%8C%96%E5%88%86%E6%9E%90">ä¾›åº”é“¾ä¼˜åŒ–åˆ†æ</a></li>
<li><a href="#%E6%96%B0%E5%BA%97%E9%80%89%E5%9D%80%E5%BB%BA%E6%A8%A1%E6%96%B9%E6%A1%88" title="#%E6%96%B0%E5%BA%97%E9%80%89%E5%9D%80%E5%BB%BA%E6%A8%A1%E6%96%B9%E6%A1%88">æ–°åº—é€‰å€å»ºæ¨¡æ–¹æ¡ˆ</a></li>
<li><a href="#%E6%95%B0%E6%8D%AE%E6%96%87%E5%8C%96%E4%B8%8E%E8%87%AA%E5%8A%A9%E5%88%86%E6%9E%90" title="#%E6%95%B0%E6%8D%AE%E6%96%87%E5%8C%96%E4%B8%8E%E8%87%AA%E5%8A%A9%E5%88%86%E6%9E%90">æ•°æ®æ–‡åŒ–ä¸è‡ªåŠ©åˆ†æ</a></li>
</ol>
<hr/>
<h2 data-id="heading-1">æ–¹æ¡ˆæ¦‚è¿°</h2>
<h3 data-id="heading-2">1.1 æ•°æ®èµ‹èƒ½çš„æ ¸å¿ƒç›®æ ‡</h3>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">ä»æ•°æ®ä»“åº“åˆ°ä¸šåŠ¡èµ‹èƒ½çš„ä»·å€¼é“¾:</span>

<span class="hljs-section">ç¬¬ä¸€é˜¶æ®µ: æ•°æ®é›†æˆ (å·²å®Œæˆ)</span>
â”œâ”€ ç»Ÿä¸€æ•°æ®ã€æ¶ˆé™¤å­¤å²›
â”œâ”€ POS/ä¾›åº”é“¾/CRMæ•°æ®æ•´åˆ
â””â”€ ä¸ºåç»­åˆ†æå¥ å®šåŸºç¡€

<span class="hljs-section">ç¬¬äºŒé˜¶æ®µ: æ·±åº¦åˆ†æ (æœ¬æ–‡æ ¸å¿ƒ)</span>
â”œâ”€ å‘ç°è§„å¾‹ã€è¯†åˆ«æœºä¼šã€é¢„æµ‹æœªæ¥
â”œâ”€ å››å¤§æ–¹å‘: é—¨åº—ã€è¥é”€ã€ä¾›åº”é“¾ã€é€‰å€
â””â”€ ç»Ÿè®¡ã€å»ºæ¨¡ã€é¢„æµ‹ã€å› æœåˆ†æ

<span class="hljs-section">ç¬¬ä¸‰é˜¶æ®µ: åº”ç”¨åˆ›æ–° (åç»­æ–‡æ¡£)</span>
â”œâ”€ äº§å“åŒ–ã€è‡ªåŠ¨åŒ–ã€æ™ºèƒ½åŒ–
â”œâ”€ BIç³»ç»Ÿã€é©¾é©¶èˆ±ã€å†³ç­–å¼•æ“
â””â”€ èµ‹èƒ½ä¸šåŠ¡éƒ¨é—¨è‡ªåŠ©å†³ç­–

<span class="hljs-section">æœ€ç»ˆæˆæœ: æ•°æ®é©±åŠ¨çš„çµæ´»é«˜æ•ˆé¤é¥®å¸å›½</span>
</code></pre>
<h3 data-id="heading-3">1.2 å››å¤§ä¸šåŠ¡èµ‹èƒ½æ–¹å‘</h3>
<p><strong>1ï¸âƒ£ é—¨åº—è¿è¥ç²¾ç»†åŒ–ç®¡ç†</strong></p>
<ul>
<li>é”€å”®é¢„æµ‹ (æ—¥/å‘¨çº§ç²¾åº¦)</li>
<li>äººæ•ˆä¼˜åŒ– (ç­æ¬¡æ’ç­ã€èœå“æ­é…)</li>
<li>å®¢æµåˆ†æ (é«˜å³°é¢„è­¦ã€å®¢æºæ„æˆ)</li>
<li>èœå“è´¡çŒ®åº¦ (é”€å”®é¢ã€åˆ©æ¶¦è´¡çŒ®)</li>
<li>ğŸ’° é¢„æœŸæ”¶ç›Š: äººæ•ˆ â†‘8-12%, å®¢å•ä»· â†‘5-8%</li>
</ul>
<p><strong>2ï¸âƒ£ ç²¾å‡†è¥é”€ä¸ä¼šå‘˜è¿è¥</strong></p>
<ul>
<li>ç”¨æˆ·ç”»åƒ (æ¶ˆè´¹è¡Œä¸ºã€åå¥½åˆ†æ)</li>
<li>ç²¾å‡†è¥é”€ (ç›®æ ‡å®¢ç¾¤ã€æ¨èäº§å“)</li>
<li>ä¼šå‘˜ç”Ÿå‘½å‘¨æœŸ (æ–°å¢ã€æ´»è·ƒã€æµå¤±)</li>
<li>å¤è´­ç‡æå‡ (æŒ½å›ã€æ¿€æ´»ã€å‡å€¼)</li>
<li>ğŸ’° é¢„æœŸæ”¶ç›Š: å¤è´­ç‡ â†‘15-25%, å®¢ä»·å€¼ â†‘30%</li>
</ul>
<p><strong>3ï¸âƒ£ ä¾›åº”é“¾å…¨æµç¨‹ä¼˜åŒ–</strong></p>
<ul>
<li>éœ€æ±‚é¢„æµ‹ (é£Ÿæã€åº“å­˜)</li>
<li>åº“å­˜ä¼˜åŒ– (æœ€å°åº“å­˜ã€å‘¨è½¬ç‡)</li>
<li>é‡‡è´­ä¼˜åŒ– (å“è´¨ã€æˆæœ¬ã€é…é€)</li>
<li>æŸè€—æ§åˆ¶ (æµªè´¹ç‡ç›‘æµ‹)</li>
<li>ğŸ’° é¢„æœŸæ”¶ç›Š: åº“å­˜ â†“15-20%, æŸè€— â†“30%</li>
</ul>
<p><strong>4ï¸âƒ£ æ•°æ®é©±åŠ¨çš„é€‰å€ä¸æ‰©å¼ </strong></p>
<ul>
<li>ä½ç½®è¯„ä¼° (å•†åœˆåˆ†æã€ç«äº‰æ ¼å±€)</li>
<li>é€‰å€å»ºæ¨¡ (æˆç†Ÿå‘¨æœŸã€æˆæœ¬å›æ”¶)</li>
<li>é£é™©è¯†åˆ« (å¤±è´¥é¢„è­¦ã€æ­¢æŸæœºåˆ¶)</li>
<li>å†³ç­–æ”¯æŒ (å¼€åº—vså…³åº—vsæ”¹å‹)</li>
<li>ğŸ’° é¢„æœŸæ”¶ç›Š: æ–°åº—æˆåŠŸç‡ â†‘20-30%</li>
</ul>
<hr/>
<h2 data-id="heading-4">é—¨åº—è¿è¥æ·±åº¦åˆ†æ</h2>
<h3 data-id="heading-5">2.1 é”€å”®é¢„æµ‹æ¨¡å‹</h3>
<p><strong>é¢„æµ‹æ¨¡å‹æ¶æ„</strong>:</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">æ•°æ®è¾“å…¥:</span>
â”œâ”€ å†å²é”€å”®æ•°æ® (è¿‡å»18-24ä¸ªæœˆ)
â”œâ”€ å¤–éƒ¨ç‰¹å¾ (å¤©æ°”ã€èŠ‚å‡æ—¥ã€ä¿ƒé”€ã€ç«äº‰)
â”œâ”€ é—¨åº—ç‰¹å¾ (ä½ç½®ã€è§„æ¨¡ã€ç±»å‹ã€æˆç†Ÿåº¦)
â””â”€ æ—¶é—´ç‰¹å¾ (å­£èŠ‚æ€§ã€å‘¨æœŸæ€§ã€è¶‹åŠ¿)

<span class="hljs-section">æ¨¡å‹å±‚:</span>
â”œâ”€ L1: åŸºçº¿æ¨¡å‹ (ç§»åŠ¨å¹³å‡ã€æŒ‡æ•°å¹³æ»‘) - ç²¾åº¦Â±10-15%
â”œâ”€ L2: ç»Ÿè®¡æ¨¡å‹ (ARIMAã€Holt-Winters) - ç²¾åº¦Â±8-12%
â””â”€ L3: æœºå™¨å­¦ä¹  (XGBoostã€LightGBM) - ç²¾åº¦Â±5-8%

<span class="hljs-section">é¢„æµ‹ç²’åº¦:</span>
â”œâ”€ æ—¥çº§: ç­æ¬¡æ’ç­ã€åº“å­˜å‡†å¤‡
â”œâ”€ å‘¨çº§: ä¿ƒé”€æ´»åŠ¨ã€è¥é”€è®¡åˆ’
â”œâ”€ æœˆçº§: è´¢åŠ¡é¢„ç®—ã€é‡‡è´­è®¡åˆ’
â””â”€ å­£åº¦çº§: æˆ˜ç•¥è§„åˆ’ã€åŒºåŸŸå¯¹æ ‡
</code></pre>
<p><strong>Pythoné”€å”®é¢„æµ‹ä»£ç </strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> StandardScaler
<span class="hljs-keyword">import</span> xgboost <span class="hljs-keyword">as</span> xgb
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime, timedelta

<span class="hljs-keyword">class</span> <span class="hljs-title class_">SalesForecaster</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, shop_id, lookback_days=<span class="hljs-number">540</span></span>):
        self.shop_id = shop_id
        self.lookback_days = lookback_days
        self.model = <span class="hljs-literal">None</span>
        self.scaler = StandardScaler()
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">fetch_historical_data</span>(<span class="hljs-params">self, db_connection</span>):
        <span class="hljs-string">"""ä»Dorisè·å–å†å²æ•°æ®"""</span>
        query = <span class="hljs-string">f"""
        SELECT stat_date, shop_id, daily_sales as label,
               customer_count, order_count, avg_order_price,
               max_temperature, rainfall, day_of_week,
               is_holiday, discount_amount, is_promo_day
        FROM dws_daily_shop_analysis
        WHERE shop_id = <span class="hljs-subst">{self.shop_id}</span>
            AND stat_date &gt;= DATE_SUB(CURDATE(), INTERVAL <span class="hljs-subst">{self.lookback_days}</span> DAY)
        ORDER BY stat_date
        """</span>
        df = pd.read_sql(query, db_connection)
        <span class="hljs-keyword">return</span> self._engineer_features(df)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_engineer_features</span>(<span class="hljs-params">self, df</span>):
        <span class="hljs-string">"""ç‰¹å¾å·¥ç¨‹"""</span>
        df[<span class="hljs-string">'stat_date'</span>] = pd.to_datetime(df[<span class="hljs-string">'stat_date'</span>])
        df[<span class="hljs-string">'month'</span>] = df[<span class="hljs-string">'stat_date'</span>].dt.month
        df[<span class="hljs-string">'week'</span>] = df[<span class="hljs-string">'stat_date'</span>].dt.isocalendar().week
        df[<span class="hljs-string">'sales_ma7'</span>] = df[<span class="hljs-string">'label'</span>].rolling(<span class="hljs-number">7</span>, min_periods=<span class="hljs-number">1</span>).mean()
        df[<span class="hljs-string">'sales_ma30'</span>] = df[<span class="hljs-string">'label'</span>].rolling(<span class="hljs-number">30</span>, min_periods=<span class="hljs-number">1</span>).mean()
        df[<span class="hljs-string">'sales_yoy'</span>] = df[<span class="hljs-string">'label'</span>].shift(<span class="hljs-number">365</span>)
        <span class="hljs-keyword">return</span> df.dropna()
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">train</span>(<span class="hljs-params">self, df</span>):
        <span class="hljs-string">"""è®­ç»ƒXGBoostæ¨¡å‹"""</span>
        feature_cols = [c <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> df.columns <span class="hljs-keyword">if</span> c <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> [<span class="hljs-string">'stat_date'</span>, <span class="hljs-string">'shop_id'</span>, <span class="hljs-string">'label'</span>]]
        X = df[feature_cols]
        y = df[<span class="hljs-string">'label'</span>]
        
        X_train, X_test, y_train, y_test = X[:<span class="hljs-built_in">int</span>(<span class="hljs-built_in">len</span>(X)*<span class="hljs-number">0.8</span>)], X[<span class="hljs-built_in">int</span>(<span class="hljs-built_in">len</span>(X)*<span class="hljs-number">0.8</span>):], \
                                            y[:<span class="hljs-built_in">int</span>(<span class="hljs-built_in">len</span>(y)*<span class="hljs-number">0.8</span>)], y[<span class="hljs-built_in">int</span>(<span class="hljs-built_in">len</span>(y)*<span class="hljs-number">0.8</span>):]
        
        X_train_scaled = self.scaler.fit_transform(X_train)
        X_test_scaled = self.scaler.transform(X_test)
        
        self.model = xgb.XGBRegressor(n_estimators=<span class="hljs-number">200</span>, max_depth=<span class="hljs-number">7</span>, learning_rate=<span class="hljs-number">0.1</span>)
        self.model.fit(X_train_scaled, y_train, eval_set=[(X_test_scaled, y_test)],
                      early_stopping_rounds=<span class="hljs-number">20</span>, verbose=<span class="hljs-literal">False</span>)
        
        y_pred = self.model.predict(X_test_scaled)
        mape = np.mean(np.<span class="hljs-built_in">abs</span>((y_test - y_pred) / y_test)) * <span class="hljs-number">100</span>
        <span class="hljs-keyword">return</span> {<span class="hljs-string">'mape'</span>: mape, <span class="hljs-string">'model_ready'</span>: <span class="hljs-literal">True</span>}
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">predict</span>(<span class="hljs-params">self, future_days=<span class="hljs-number">30</span></span>):
        <span class="hljs-string">"""é¢„æµ‹æœªæ¥é”€å”®"""</span>
        predictions = []
        <span class="hljs-keyword">for</span> day <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, future_days + <span class="hljs-number">1</span>):
            pred_date = datetime.now() + timedelta(days=day)
            <span class="hljs-comment"># æ„é€ ç‰¹å¾ã€é¢„æµ‹</span>
            pred_value = self._get_forecast_value(pred_date)
            std_error = <span class="hljs-number">1500</span>
            predictions.append({
                <span class="hljs-string">'date'</span>: pred_date.strftime(<span class="hljs-string">'%Y-%m-%d'</span>),
                <span class="hljs-string">'forecast'</span>: <span class="hljs-built_in">round</span>(pred_value, <span class="hljs-number">2</span>),
                <span class="hljs-string">'lower_ci'</span>: <span class="hljs-built_in">round</span>(<span class="hljs-built_in">max</span>(<span class="hljs-number">0</span>, pred_value - <span class="hljs-number">1.96</span>*std_error), <span class="hljs-number">2</span>),
                <span class="hljs-string">'upper_ci'</span>: <span class="hljs-built_in">round</span>(pred_value + <span class="hljs-number">1.96</span>*std_error, <span class="hljs-number">2</span>)
            })
        <span class="hljs-keyword">return</span> predictions
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_get_forecast_value</span>(<span class="hljs-params">self, pred_date</span>):
        <span class="hljs-comment"># å®ç°å…·ä½“é¢„æµ‹é€»è¾‘</span>
        <span class="hljs-keyword">return</span> <span class="hljs-number">8000</span>  <span class="hljs-comment"># ç¤ºä¾‹</span>
</code></pre>
<h3 data-id="heading-6">2.2 äººæ•ˆä¼˜åŒ–ä¸ç­æ¬¡æ’ç­</h3>
<p><strong>ç­æ¬¡æ’ç­SQL</strong>:</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åŸºäºé”€å”®é¢„æµ‹çš„ç­æ¬¡ä¼˜åŒ–å»ºè®®</span>
<span class="hljs-keyword">CREATE</span> TEMPORARY <span class="hljs-keyword">TABLE</span> hourly_forecast <span class="hljs-keyword">AS</span>
<span class="hljs-keyword">SELECT</span> shop_id, forecast_date, <span class="hljs-keyword">hour</span>, forecasted_orders,
       <span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> forecasted_orders <span class="hljs-operator">&lt;</span> <span class="hljs-number">20</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">2</span>
            <span class="hljs-keyword">WHEN</span> forecasted_orders <span class="hljs-operator">&lt;</span> <span class="hljs-number">50</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">3</span>
            <span class="hljs-keyword">WHEN</span> forecasted_orders <span class="hljs-operator">&lt;</span> <span class="hljs-number">100</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">4</span>
            <span class="hljs-keyword">ELSE</span> <span class="hljs-number">5</span>
       <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> recommended_staff
<span class="hljs-keyword">FROM</span> dws_hourly_forecast
<span class="hljs-keyword">WHERE</span> shop_id <span class="hljs-operator">=</span> <span class="hljs-string">'SHOP001'</span> <span class="hljs-keyword">AND</span> forecast_date <span class="hljs-operator">=</span> CURDATE();

<span class="hljs-comment">-- å¯¹æ¯”å½“å‰æ’ç­</span>
<span class="hljs-keyword">SELECT</span> h.hour, c.actual_staff, h.recommended_staff,
       <span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> c.actual_staff <span class="hljs-operator">&gt;</span> h.recommended_staff <span class="hljs-operator">+</span> <span class="hljs-number">1</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'å¯å‡å‘˜'</span>
            <span class="hljs-keyword">WHEN</span> c.actual_staff <span class="hljs-operator">&lt;</span> h.recommended_staff <span class="hljs-operator">-</span> <span class="hljs-number">1</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'éœ€å¢å‘˜'</span>
            <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'æ­£å¸¸'</span>
       <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> suggestion
<span class="hljs-keyword">FROM</span> hourly_forecast h
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> current_shifts c <span class="hljs-keyword">ON</span> h.hour <span class="hljs-operator">=</span> <span class="hljs-keyword">HOUR</span>(c.shift_date)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> h.hour;
</code></pre>
<h3 data-id="heading-7">2.3 èœå“è´¡çŒ®åº¦åˆ†æ</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- è®¡ç®—èœå“çš„é”€å”®ã€åˆ©æ¶¦ã€å‡ºèœæ•ˆç‡è´¡çŒ®åº¦</span>
<span class="hljs-keyword">SELECT</span>
    menu_id, menu_name,
    <span class="hljs-built_in">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> order_id) <span class="hljs-keyword">AS</span> sales_count,
    <span class="hljs-built_in">SUM</span>(actual_price) <span class="hljs-keyword">AS</span> total_revenue,
    <span class="hljs-built_in">SUM</span>(actual_price) <span class="hljs-operator">-</span> <span class="hljs-built_in">SUM</span>(cost) <span class="hljs-keyword">AS</span> total_profit,
    ROUND(<span class="hljs-built_in">SUM</span>(actual_price) <span class="hljs-operator">/</span> <span class="hljs-built_in">SUM</span>(actual_price) <span class="hljs-keyword">OVER</span> () <span class="hljs-operator">*</span> <span class="hljs-number">100</span>, <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> revenue_pct,
    ROUND((<span class="hljs-built_in">SUM</span>(actual_price) <span class="hljs-operator">-</span> <span class="hljs-built_in">SUM</span>(cost)) <span class="hljs-operator">/</span> <span class="hljs-built_in">SUM</span>(actual_price) <span class="hljs-operator">*</span> <span class="hljs-number">100</span>, <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> profit_margin,
    ROUND(<span class="hljs-built_in">AVG</span>(cook_time), <span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> avg_cook_time,
    <span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> <span class="hljs-built_in">SUM</span>(actual_price) <span class="hljs-operator">/</span> <span class="hljs-built_in">SUM</span>(actual_price) <span class="hljs-keyword">OVER</span> () <span class="hljs-operator">&gt;=</span> <span class="hljs-number">0.05</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'ä¸»åŠ›èœ'</span>
         <span class="hljs-keyword">WHEN</span> ROUND((<span class="hljs-built_in">SUM</span>(actual_price) <span class="hljs-operator">-</span> <span class="hljs-built_in">SUM</span>(cost)) <span class="hljs-operator">/</span> <span class="hljs-built_in">SUM</span>(actual_price) <span class="hljs-operator">*</span> <span class="hljs-number">100</span>, <span class="hljs-number">2</span>) <span class="hljs-operator">&gt;=</span> <span class="hljs-number">50</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'é«˜åˆ©èœ'</span>
         <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'æ™®é€šèœ'</span>
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> menu_category
<span class="hljs-keyword">FROM</span> ods_order_items
<span class="hljs-keyword">WHERE</span> shop_id <span class="hljs-operator">=</span> <span class="hljs-string">'SHOP001'</span> <span class="hljs-keyword">AND</span> <span class="hljs-type">DATE</span>(order_time) <span class="hljs-operator">&gt;=</span> DATE_SUB(CURDATE(), <span class="hljs-type">INTERVAL</span> <span class="hljs-number">30</span> <span class="hljs-keyword">DAY</span>)
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-number">1</span>, <span class="hljs-number">2</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> total_profit <span class="hljs-keyword">DESC</span>;
</code></pre>
<hr/>
<h2 data-id="heading-8">å¸‚åœºè¥é”€æ•°æ®èµ‹èƒ½</h2>
<h3 data-id="heading-9">3.1 ç”¨æˆ·ç”»åƒç³»ç»Ÿ</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æ„å»ºå®Œæ•´ç”¨æˆ·ç”»åƒ</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> dws_user_profile <span class="hljs-keyword">AS</span>
<span class="hljs-keyword">SELECT</span>
    member_id, phone, age_group, gender,
    <span class="hljs-comment">-- æ¶ˆè´¹è¡Œä¸º</span>
    <span class="hljs-built_in">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> order_id) <span class="hljs-keyword">AS</span> total_orders,
    <span class="hljs-built_in">SUM</span>(order_total) <span class="hljs-keyword">AS</span> total_spending,
    <span class="hljs-built_in">AVG</span>(order_total) <span class="hljs-keyword">AS</span> avg_order_value,
    <span class="hljs-built_in">MAX</span>(order_date) <span class="hljs-keyword">AS</span> last_order_date,
    DATEDIFF(CURDATE(), <span class="hljs-built_in">MAX</span>(order_date)) <span class="hljs-keyword">AS</span> days_since_last_order,
    <span class="hljs-comment">-- èœå“åå¥½</span>
    (<span class="hljs-keyword">SELECT</span> menu_category <span class="hljs-keyword">FROM</span> ods_order_items <span class="hljs-keyword">WHERE</span> member_id <span class="hljs-operator">=</span> m.member_id 
     <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> menu_category <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">DESC</span> LIMIT <span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> favorite_category,
    <span class="hljs-comment">-- ç”Ÿå‘½å‘¨æœŸ</span>
    <span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> DATEDIFF(CURDATE(), <span class="hljs-built_in">MAX</span>(order_date)) <span class="hljs-operator">&lt;=</span> <span class="hljs-number">7</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'é«˜æ´»è·ƒ'</span>
         <span class="hljs-keyword">WHEN</span> DATEDIFF(CURDATE(), <span class="hljs-built_in">MAX</span>(order_date)) <span class="hljs-operator">&lt;=</span> <span class="hljs-number">30</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'æ´»è·ƒ'</span>
         <span class="hljs-keyword">WHEN</span> DATEDIFF(CURDATE(), <span class="hljs-built_in">MAX</span>(order_date)) <span class="hljs-operator">&lt;=</span> <span class="hljs-number">90</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'å¶å‘'</span>
         <span class="hljs-keyword">WHEN</span> DATEDIFF(CURDATE(), <span class="hljs-built_in">MAX</span>(order_date)) <span class="hljs-operator">&lt;=</span> <span class="hljs-number">180</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'æ²‰ç¡'</span>
         <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'æµå¤±'</span>
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> lifecycle_stage,
    <span class="hljs-comment">-- ä»·å€¼è¯„çº§</span>
    <span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> <span class="hljs-built_in">SUM</span>(order_total) <span class="hljs-operator">&gt;=</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">PERCENTILE_CONT</span>(<span class="hljs-number">0.8</span>) <span class="hljs-keyword">WITHIN</span> <span class="hljs-keyword">GROUP</span> (<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> total_spending))
              <span class="hljs-keyword">AND</span> DATEDIFF(CURDATE(), <span class="hljs-built_in">MAX</span>(order_date)) <span class="hljs-operator">&lt;=</span> <span class="hljs-number">30</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'VIP'</span>
         <span class="hljs-keyword">WHEN</span> <span class="hljs-built_in">SUM</span>(order_total) <span class="hljs-operator">&gt;=</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">PERCENTILE_CONT</span>(<span class="hljs-number">0.5</span>) <span class="hljs-keyword">WITHIN</span> <span class="hljs-keyword">GROUP</span> (<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> total_spending))
              <span class="hljs-keyword">AND</span> DATEDIFF(CURDATE(), <span class="hljs-built_in">MAX</span>(order_date)) <span class="hljs-operator">&lt;=</span> <span class="hljs-number">60</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'é«˜ä»·å€¼'</span>
         <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'æ™®é€š'</span>
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> value_segment
<span class="hljs-keyword">FROM</span> dim_member m
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> ods_transactions t <span class="hljs-keyword">ON</span> m.member_id <span class="hljs-operator">=</span> t.member_id
<span class="hljs-keyword">WHERE</span> t.order_date <span class="hljs-operator">&gt;=</span> DATE_SUB(CURDATE(), <span class="hljs-type">INTERVAL</span> <span class="hljs-number">365</span> <span class="hljs-keyword">DAY</span>)
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> m.member_id;
</code></pre>
<h3 data-id="heading-10">3.2 ä¼šå‘˜å¤è´­ç‡æå‡</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä¼šå‘˜ç”Ÿå‘½å‘¨æœŸç®¡ç†ä¸å¤è´­ä¼˜åŒ–</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MemberLifecycleManager</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">calculate_churn_probability</span>(<span class="hljs-params">self, member_id</span>):
        <span class="hljs-string">"""åŸºäºRFMæ¨¡å‹è®¡ç®—æµå¤±æ¦‚ç‡"""</span>
        <span class="hljs-comment"># R (Recency): æœ€åè´­ä¹°è·ç¦»</span>
        <span class="hljs-comment"># F (Frequency): è´­ä¹°é¢‘ç‡</span>
        <span class="hljs-comment"># M (Monetary): è´­ä¹°é‡‘é¢</span>
        
        r_score = self._get_recency_score(member_id)
        f_score = self._get_frequency_score(member_id)
        m_score = self._get_monetary_score(member_id)
        
        rfm_score = (r_score + f_score + m_score) / <span class="hljs-number">3</span>
        churn_prob = <span class="hljs-number">1</span> - (rfm_score / <span class="hljs-number">5</span>)  <span class="hljs-comment"># åˆ†æ•°é«˜åˆ™æµå¤±ç‡ä½</span>
        
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'rfm_score'</span>: <span class="hljs-built_in">round</span>(rfm_score, <span class="hljs-number">2</span>),
            <span class="hljs-string">'churn_probability'</span>: <span class="hljs-built_in">round</span>(churn_prob, <span class="hljs-number">3</span>),
            <span class="hljs-string">'risk_level'</span>: <span class="hljs-string">'P0_å³å°†æµå¤±'</span> <span class="hljs-keyword">if</span> churn_prob &gt; <span class="hljs-number">0.7</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'P1_é«˜é£é™©'</span> <span class="hljs-keyword">if</span> churn_prob &gt; <span class="hljs-number">0.5</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'ä½é£é™©'</span>
        }
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recommend_marketing_action</span>(<span class="hljs-params">self, member_id</span>):
        <span class="hljs-string">"""æ¨èä¸ªæ€§åŒ–è¥é”€è¡ŒåŠ¨"""</span>
        profile = self._get_member_profile(member_id)
        recommendations = []
        
        <span class="hljs-keyword">if</span> profile[<span class="hljs-string">'days_since_last_order'</span>] &gt; <span class="hljs-number">7</span>:
            recommendations.append({
                <span class="hljs-string">'action'</span>: <span class="hljs-string">'push_notification'</span>,
                <span class="hljs-string">'content'</span>: <span class="hljs-string">f"å¥½ä¹…ä¸è§ï¼Œ<span class="hljs-subst">{profile[<span class="hljs-string">'favorite_category'</span>]}</span>é™æ—¶ä¼˜æƒ "</span>,
                <span class="hljs-string">'discount_code'</span>: self._generate_coupon(member_id),
                <span class="hljs-string">'timing'</span>: <span class="hljs-string">'lunch_time'</span>
            })
        
        <span class="hljs-keyword">if</span> profile[<span class="hljs-string">'avg_order_value'</span>] &lt; <span class="hljs-number">200</span>:
            recommendations.append({
                <span class="hljs-string">'action'</span>: <span class="hljs-string">'premium_recommendation'</span>,
                <span class="hljs-string">'message'</span>: <span class="hljs-string">'æ‚¨å¯èƒ½ä¼šå–œæ¬¢è¿™äº›æ–°èœå“...'</span>,
                <span class="hljs-string">'expected_uplift'</span>: <span class="hljs-string">'15-20%'</span>
            })
        
        <span class="hljs-keyword">return</span> recommendations
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">calculate_ltv</span>(<span class="hljs-params">self, member_id</span>):
        <span class="hljs-string">"""è®¡ç®—å®¢æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼ (LTV)"""</span>
        profile = self._get_member_profile(member_id)
        avg_order = profile[<span class="hljs-string">'avg_order_value'</span>]
        annual_freq = <span class="hljs-number">365</span> / <span class="hljs-built_in">max</span>(profile[<span class="hljs-string">'order_frequency'</span>], <span class="hljs-number">1</span>)
        
        lifecycle_duration = {
            <span class="hljs-string">'æ–°å®¢'</span>: <span class="hljs-number">1</span>, <span class="hljs-string">'æˆé•¿æœŸ'</span>: <span class="hljs-number">2</span>, <span class="hljs-string">'æ´»è·ƒæœŸ'</span>: <span class="hljs-number">3</span>,
            <span class="hljs-string">'å¶å‘æœŸ'</span>: <span class="hljs-number">1.5</span>, <span class="hljs-string">'æ²‰ç¡æœŸ'</span>: <span class="hljs-number">0.5</span>, <span class="hljs-string">'æµå¤±æœŸ'</span>: <span class="hljs-number">0</span>
        }
        
        ltv = avg_order * annual_freq * lifecycle_duration.get(profile[<span class="hljs-string">'stage'</span>], <span class="hljs-number">1</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">round</span>(ltv, <span class="hljs-number">2</span>)
</code></pre>
<hr/>
<h2 data-id="heading-11">ä¾›åº”é“¾ä¼˜åŒ–åˆ†æ</h2>
<h3 data-id="heading-12">4.1 é£Ÿæéœ€æ±‚é¢„æµ‹</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">IngredientDemandForecaster</span>:
    <span class="hljs-string">"""é£Ÿæéœ€æ±‚é¢„æµ‹ç³»ç»Ÿ"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forecast_demand</span>(<span class="hljs-params">self, ingredient_id, forecast_days=<span class="hljs-number">14</span></span>):
        <span class="hljs-string">"""é¢„æµ‹é£Ÿæéœ€æ±‚é‡"""</span>
        <span class="hljs-comment"># è·å–èœå“é”€å”®é¢„æµ‹</span>
        menu_forecast = self._get_menu_forecast(forecast_days)
        
        <span class="hljs-comment"># è·å–èœå“-é£Ÿææ˜ å°„</span>
        recipe_mapping = self._get_recipe_mapping()
        
        <span class="hljs-comment"># è®¡ç®—é£Ÿæéœ€æ±‚</span>
        demand_forecast = {}
        <span class="hljs-keyword">for</span> day <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(forecast_days):
            daily_demand = <span class="hljs-number">0</span>
            <span class="hljs-keyword">for</span> menu_item, qty <span class="hljs-keyword">in</span> menu_forecast[day].items():
                <span class="hljs-keyword">if</span> ingredient_id <span class="hljs-keyword">in</span> recipe_mapping[menu_item]:
                    usage = recipe_mapping[menu_item][ingredient_id]
                    daily_demand += qty * usage
            
            <span class="hljs-comment"># åŠ å…¥10%å®‰å…¨åº“å­˜</span>
            demand_forecast[day] = {
                <span class="hljs-string">'base'</span>: daily_demand,
                <span class="hljs-string">'with_safety'</span>: daily_demand * <span class="hljs-number">1.1</span>,
                <span class="hljs-string">'reorder_point'</span>: daily_demand * <span class="hljs-number">1.1</span> * <span class="hljs-number">2</span>  <span class="hljs-comment"># 2å¤©lead time</span>
            }
        
        <span class="hljs-keyword">return</span> demand_forecast
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">optimize_inventory</span>(<span class="hljs-params">self, ingredient_id, current_stock</span>):
        <span class="hljs-string">"""åº“å­˜ä¼˜åŒ–å»ºè®®"""</span>
        forecast = self.forecast_demand(ingredient_id, <span class="hljs-number">30</span>)
        total_30day = <span class="hljs-built_in">sum</span>([d[<span class="hljs-string">'with_safety'</span>] <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> forecast.values()])
        avg_daily = total_30day / <span class="hljs-number">30</span>
        
        <span class="hljs-comment"># è®¡ç®—ç»æµæ‰¹é‡ (EOQ)</span>
        params = self._get_ingredient_params(ingredient_id)
        eoq = np.sqrt((<span class="hljs-number">2</span> * avg_daily * <span class="hljs-number">365</span> * params[<span class="hljs-string">'order_cost'</span>]) / params[<span class="hljs-string">'holding_cost'</span>])
        
        reorder_point = avg_daily * params[<span class="hljs-string">'lead_time_days'</span>]
        max_stock = reorder_point + eoq
        
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'reorder_point'</span>: <span class="hljs-built_in">round</span>(reorder_point, <span class="hljs-number">2</span>),
            <span class="hljs-string">'order_qty'</span>: <span class="hljs-built_in">round</span>(eoq, <span class="hljs-number">2</span>),
            <span class="hljs-string">'max_level'</span>: <span class="hljs-built_in">round</span>(max_stock, <span class="hljs-number">2</span>),
            <span class="hljs-string">'action'</span>: self._get_action(current_stock, reorder_point, max_stock)
        }
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_get_action</span>(<span class="hljs-params">self, current, reorder, max_level</span>):
        <span class="hljs-keyword">if</span> current &lt;= reorder:
            <span class="hljs-keyword">return</span> <span class="hljs-string">'ç´§æ€¥è¡¥è´§'</span>
        <span class="hljs-keyword">elif</span> current &gt;= max_level:
            <span class="hljs-keyword">return</span> <span class="hljs-string">'åº“å­˜è¿‡é‡'</span>
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">'æ­£å¸¸'</span>
</code></pre>
<h3 data-id="heading-13">4.2 åº“å­˜å’Œæµªè´¹ç›‘æµ‹</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æ£€æµ‹åº“å­˜å¼‚å¸¸å’Œæµªè´¹é£é™©</span>
<span class="hljs-keyword">SELECT</span>
    ingredient_id, ingredient_name,
    current_stock,
    <span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> current_stock <span class="hljs-operator">&lt;=</span> reorder_point <span class="hljs-keyword">THEN</span> <span class="hljs-string">'ç¼ºè´§é£é™©'</span>
         <span class="hljs-keyword">WHEN</span> current_stock <span class="hljs-operator">&gt;=</span> max_stock <span class="hljs-operator">*</span> <span class="hljs-number">0.9</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'ç§¯å‹é£é™©'</span>
         <span class="hljs-keyword">WHEN</span> shelf_life_days <span class="hljs-operator">-</span> days_in_stock <span class="hljs-operator">&lt;</span> <span class="hljs-number">5</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'ä¸´æœŸé£é™©'</span>
         <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'æ­£å¸¸'</span>
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> inventory_status,
    
    <span class="hljs-comment">-- æµªè´¹ç‡</span>
    ROUND(waste_amount <span class="hljs-operator">/</span> total_purchase <span class="hljs-operator">*</span> <span class="hljs-number">100</span>, <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> waste_rate,
    
    <span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> waste_rate <span class="hljs-operator">&gt;</span> <span class="hljs-number">15</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'P0_é«˜é£é™©'</span>
         <span class="hljs-keyword">WHEN</span> waste_rate <span class="hljs-operator">&gt;</span> <span class="hljs-number">8</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'P1_ä¸­é£é™©'</span>
         <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'P2_ä½é£é™©'</span>
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> waste_risk
<span class="hljs-keyword">FROM</span> dws_ingredient_inventory
<span class="hljs-keyword">WHERE</span> stat_date <span class="hljs-operator">=</span> CURDATE()
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> waste_risk;
</code></pre>
<hr/>
<h2 data-id="heading-14">æ–°åº—é€‰å€å»ºæ¨¡æ–¹æ¡ˆ</h2>
<h3 data-id="heading-15">5.1 é€‰å€è¯„ä¼°æ¨¡å‹</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- å•†åœˆè¯„ä¼°</span>
<span class="hljs-keyword">SELECT</span>
    site_id, site_address, city, district,
    resident_population_within_1km,
    working_population_within_1km,
    competitor_count_within_1km,
    public_transport_density,
    
    <span class="hljs-comment">-- ç»¼åˆè¯„åˆ†</span>
    (population_score <span class="hljs-operator">+</span> competition_score <span class="hljs-operator">+</span> traffic_score) <span class="hljs-operator">/</span> <span class="hljs-number">3</span> <span class="hljs-keyword">AS</span> overall_score,
    
    <span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> competitor_count_within_1km <span class="hljs-operator">&gt;</span> <span class="hljs-number">3</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'ç«äº‰æ¿€çƒˆ'</span>
         <span class="hljs-keyword">WHEN</span> resident_population_within_1km <span class="hljs-operator">&lt;</span> <span class="hljs-number">20000</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'äººå£ä¸è¶³'</span>
         <span class="hljs-keyword">WHEN</span> public_transport_density <span class="hljs-operator">&lt;</span> <span class="hljs-number">2</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'äº¤é€šä¸ä¾¿'</span>
         <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'æ­£å¸¸'</span>
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> risk_level
<span class="hljs-keyword">FROM</span> dws_site_evaluation
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> overall_score <span class="hljs-keyword">DESC</span>;
</code></pre>
<h3 data-id="heading-16">5.2 æˆåŠŸæ¦‚ç‡é¢„æµ‹</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> sklearn.ensemble <span class="hljs-keyword">import</span> RandomForestClassifier

<span class="hljs-keyword">class</span> <span class="hljs-title class_">NewStoreSuccessPredictor</span>:
    <span class="hljs-string">"""æ–°åº—æˆåŠŸæ¦‚ç‡é¢„æµ‹"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">train</span>(<span class="hljs-params">self, db_connection</span>):
        <span class="hljs-string">"""åŸºäºå†å²å¼€åº—æ•°æ®è®­ç»ƒ"""</span>
        query = <span class="hljs-string">"""
        SELECT location_rent, location_population_1km,
               competitor_count, store_size, store_type,
               CASE WHEN cumulative_roi &gt;= 1.2 THEN 1 ELSE 0 END AS success
        FROM historical_store_performance
        WHERE opening_date &gt;= DATE_SUB(CURDATE(), INTERVAL 5 YEAR)
        """</span>
        df = pd.read_sql(query, db_connection)
        
        X = df.drop(<span class="hljs-string">'success'</span>, axis=<span class="hljs-number">1</span>)
        y = df[<span class="hljs-string">'success'</span>]
        
        self.model = RandomForestClassifier(n_estimators=<span class="hljs-number">200</span>, max_depth=<span class="hljs-number">15</span>)
        self.model.fit(X, y)
        
        <span class="hljs-keyword">return</span> {<span class="hljs-string">'training_samples'</span>: <span class="hljs-built_in">len</span>(df), <span class="hljs-string">'success_rate'</span>: y.mean()}
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">predict</span>(<span class="hljs-params">self, site_features</span>):
        <span class="hljs-string">"""é¢„æµ‹æˆåŠŸæ¦‚ç‡"""</span>
        X = pd.DataFrame([site_features])
        prob = self.model.predict_proba(X)[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]
        
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'success_probability'</span>: <span class="hljs-built_in">round</span>(prob, <span class="hljs-number">3</span>),
            <span class="hljs-string">'rating'</span>: <span class="hljs-string">'ä¼˜ç§€â­â­â­â­â­'</span> <span class="hljs-keyword">if</span> prob &gt;= <span class="hljs-number">0.8</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'è‰¯å¥½â­â­â­â­'</span> <span class="hljs-keyword">if</span> prob &gt;= <span class="hljs-number">0.6</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'é£é™©â­â­'</span>,
            <span class="hljs-string">'recommendation'</span>: <span class="hljs-string">'ğŸŸ¢ç«‹å³å¼€åº—'</span> <span class="hljs-keyword">if</span> prob &gt;= <span class="hljs-number">0.8</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'ğŸŸ¡éœ€è¯„ä¼°'</span> <span class="hljs-keyword">if</span> prob &gt;= <span class="hljs-number">0.6</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'ğŸ”´ä¸å»ºè®®'</span>
        }
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">estimate_financials</span>(<span class="hljs-params">self, site_features</span>):
        <span class="hljs-string">"""ä¼°ç®—è´¢åŠ¡æŒ‡æ ‡"""</span>
        city = site_features[<span class="hljs-string">'city'</span>]
        benchmarks = self._get_benchmarks(city)
        adjusted = self._adjust_for_location(site_features, benchmarks)
        
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'monthly_sales'</span>: adjusted[<span class="hljs-string">'sales'</span>],
            <span class="hljs-string">'monthly_profit'</span>: adjusted[<span class="hljs-string">'sales'</span>] * <span class="hljs-number">0.35</span> - adjusted[<span class="hljs-string">'cost'</span>],
            <span class="hljs-string">'payback_months'</span>: site_features[<span class="hljs-string">'rent'</span>] / (adjusted[<span class="hljs-string">'sales'</span>] * <span class="hljs-number">0.35</span> - adjusted[<span class="hljs-string">'cost'</span>])
        }
</code></pre>
<hr/>
<h2 data-id="heading-17">æ•°æ®æ–‡åŒ–ä¸è‡ªåŠ©åˆ†æ</h2>
<h3 data-id="heading-18">6.1 è‡ªåŠ©åˆ†æèµ‹èƒ½ä½“ç³»</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">â”Œâ”€</span> <span class="hljs-string">å·¥å…·æ°‘ä¸»åŒ–</span> <span class="hljs-string">â”€â”¬â”€</span> <span class="hljs-string">BIå·¥å…·</span> <span class="hljs-string">(Tableau/Metabase)</span>
<span class="hljs-string">â”‚</span>             <span class="hljs-string">â”‚</span>  <span class="hljs-string">â””â”€</span> <span class="hljs-number">50</span><span class="hljs-string">+é¢„å»ºæ¨¡æ¿,</span> <span class="hljs-string">æ‹–æ‹½åˆ†æ</span>
<span class="hljs-string">â”‚</span>             <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>             <span class="hljs-string">â”œâ”€</span> <span class="hljs-string">SQLå®¢æˆ·ç«¯</span> <span class="hljs-string">(DBeaver)</span>
<span class="hljs-string">â”‚</span>             <span class="hljs-string">â”‚</span>  <span class="hljs-string">â””â”€</span> <span class="hljs-string">SQL</span> <span class="hljs-string">snippetåº“,</span> <span class="hljs-string">æŸ¥è¯¢æ¨¡æ¿</span>
<span class="hljs-string">â”‚</span>             <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>             <span class="hljs-string">â””â”€</span> <span class="hljs-string">åˆ†æç¯å¢ƒ</span> <span class="hljs-string">(Jupyter)</span>
<span class="hljs-string">â”‚</span>                <span class="hljs-string">â””â”€</span> <span class="hljs-string">Python/R,</span> <span class="hljs-string">é¢„å»ºæ¡†æ¶</span>

<span class="hljs-string">â”Œâ”€</span> <span class="hljs-string">èƒ½åŠ›åˆ†çº§</span> <span class="hljs-string">â”€â”€â”¬â”€</span> <span class="hljs-attr">L0:</span> <span class="hljs-string">é˜…è¯»æŠ¥è¡¨</span> <span class="hljs-string">(1å°æ—¶)</span>
<span class="hljs-string">â”‚</span>             <span class="hljs-string">â”œâ”€</span> <span class="hljs-attr">L1:</span> <span class="hljs-string">BIè‡ªåŠ©åˆ†æ</span> <span class="hljs-string">(4å°æ—¶)</span>
<span class="hljs-string">â”‚</span>             <span class="hljs-string">â”œâ”€</span> <span class="hljs-attr">L2:</span> <span class="hljs-string">SQLåˆ†æ</span> <span class="hljs-string">(3å¤©)</span>
<span class="hljs-string">â”‚</span>             <span class="hljs-string">â””â”€</span> <span class="hljs-attr">L3:</span> <span class="hljs-string">å»ºæ¨¡ç»Ÿè®¡</span> <span class="hljs-string">(5å¤©)</span>

<span class="hljs-string">â”Œâ”€</span> <span class="hljs-string">æƒé™æ²»ç†</span> <span class="hljs-string">â”€â”€â”¬â”€</span> <span class="hljs-string">æ•°æ®åˆ†çº§:</span> <span class="hljs-string">å…¬å¼€/éƒ¨é—¨/æ•æ„Ÿ</span>
<span class="hljs-string">â”‚</span>             <span class="hljs-string">â”œâ”€</span> <span class="hljs-string">è§’è‰²æƒé™:</span> <span class="hljs-string">æŸ¥çœ‹/åˆ›å»º/ç®¡ç†</span>
<span class="hljs-string">â”‚</span>             <span class="hljs-string">â””â”€</span> <span class="hljs-string">å®¡è®¡æ—¥å¿—:</span> <span class="hljs-string">è°æŸ¥äº†ä»€ä¹ˆ</span>
</code></pre>
<h3 data-id="heading-19">6.2 å…¸å‹åˆ†ææ¡ˆä¾‹æ¨¡æ¿</h3>
<p><strong>åœºæ™¯ä¸€: é—¨åº—æ—¥å¸¸è¯Šæ–­</strong> (é—¨åº—ç»ç†ç”¨)</p>
<ul>
<li>é—®é¢˜: "ä¸ºä»€ä¹ˆä»Šå¤©é”€å”®ä¸‹é™?"</li>
<li>åˆ†æ: æ—¶æ®µåˆ†å¸ƒã€èœå“æ’è¡Œã€å®¢æµåˆ†æã€å¤–éƒ¨å› ç´ </li>
<li>æ•°æ®: æ—¥æŠ¥è¡¨æ¨¡æ¿ (é¢„å»ºSQL)</li>
<li>ç»“æœ: æ‰¾åˆ°é—®é¢˜æ ¹å›  â†’ é‡‡å–è¡ŒåŠ¨</li>
</ul>
<p><strong>åœºæ™¯äºŒ: è¥é”€æ´»åŠ¨è¯„ä¼°</strong> (è¥é”€ç»ç†ç”¨)</p>
<ul>
<li>é—®é¢˜: "è¿™æ¬¡æ´»åŠ¨ROIæ˜¯å¤šå°‘?"</li>
<li>åˆ†æ: å‚ä¸äººæ•°ã€è½¬åŒ–ç‡ã€å¢é‡é”€å”®ã€æŠ•èµ„å›æŠ¥</li>
<li>æ•°æ®: æ´»åŠ¨æ•ˆæœæ¨¡æ¿ (æŒ‰èœå“/åœ°åŒº/ä¼šå‘˜ç»´åº¦)</li>
<li>ç»“æœ: è¯„ä¼°æ•ˆæœ â†’ ä¼˜åŒ–ä¸‹æ¬¡æ´»åŠ¨</li>
</ul>
<p><strong>åœºæ™¯ä¸‰: åº“å­˜é¢„è­¦</strong> (é‡‡è´­ç»ç†ç”¨)</p>
<ul>
<li>é—®é¢˜: "å“ªäº›é£Ÿæåº“å­˜å¼‚å¸¸?"</li>
<li>åˆ†æ: è‡ªåŠ¨å¯¹æ ‡æ‰€æœ‰é—¨åº—ã€æ‰€æœ‰é£Ÿæ</li>
<li>æ•°æ®: åº“å­˜é¢„è­¦è¡¨ (å³åˆ»æ›´æ–°)</li>
<li>ç»“æœ: åŠæ—¶è°ƒæ•´é‡‡è´­è®¡åˆ’</li>
</ul>
<hr/>
<p><strong>ä¸‹ä¸€æ­¥</strong>: è¯¦è§08æ–‡æ¡£ - æ•°æ®äº§å“ä¸åº”ç”¨åˆ›æ–°</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¤é¥®ä¾›åº”é“¾çš„æ•°ä»“è®¾è®¡æ€è€ƒ ï¼ˆä¸ƒï¼‰ æ•°æ®äº§å“ä¸åº”ç”¨åˆ›æ–°æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7580570363602255924</link>    <guid>https://juejin.cn/post/7580570363602255924</guid>    <pubDate>2025-12-07T12:54:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580570363602255924" data-draft-id="7580592190021107746" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¤é¥®ä¾›åº”é“¾çš„æ•°ä»“è®¾è®¡æ€è€ƒ ï¼ˆä¸ƒï¼‰ æ•°æ®äº§å“ä¸åº”ç”¨åˆ›æ–°æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="æ•°æ®åˆ†æ"/> <meta itemprop="datePublished" content="2025-12-07T12:54:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¯­è½å¿ƒç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/2875978147955741"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¤é¥®ä¾›åº”é“¾çš„æ•°ä»“è®¾è®¡æ€è€ƒ ï¼ˆä¸ƒï¼‰ æ•°æ®äº§å“ä¸åº”ç”¨åˆ›æ–°æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2875978147955741/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¯­è½å¿ƒç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T12:54:55.000Z" title="Sun Dec 07 2025 12:54:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»19åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç›®å½•</h2>
<ol>
<li><a href="#%E6%96%B9%E6%A1%88%E6%A6%82%E8%BF%B0" title="#%E6%96%B9%E6%A1%88%E6%A6%82%E8%BF%B0">æ–¹æ¡ˆæ¦‚è¿°</a></li>
<li><a href="#bi%E6%8A%A5%E8%A1%A8%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1" title="#bi%E6%8A%A5%E8%A1%A8%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1">BIæŠ¥è¡¨ç³»ç»Ÿè®¾è®¡</a></li>
<li><a href="#%E9%97%A8%E5%BA%97%E7%BB%8F%E7%90%86%E9%A9%BE%E9%A9%B6%E8%88%B1" title="#%E9%97%A8%E5%BA%97%E7%BB%8F%E7%90%86%E9%A9%BE%E9%A9%B6%E8%88%B1">é—¨åº—ç»ç†é©¾é©¶èˆ±</a></li>
<li><a href="#%E5%AE%9E%E6%97%B6%E8%BF%90%E8%90%A5%E7%9C%8B%E6%9D%BF" title="#%E5%AE%9E%E6%97%B6%E8%BF%90%E8%90%A5%E7%9C%8B%E6%9D%BF">å®æ—¶è¿è¥çœ‹æ¿</a></li>
<li><a href="#%E6%99%BA%E8%83%BD%E5%86%B3%E7%AD%96%E5%BC%95%E6%93%8E" title="#%E6%99%BA%E8%83%BD%E5%86%B3%E7%AD%96%E5%BC%95%E6%93%8E">æ™ºèƒ½å†³ç­–å¼•æ“</a></li>
<li><a href="#aiml%E5%88%9B%E6%96%B0%E5%BA%94%E7%94%A8" title="#aiml%E5%88%9B%E6%96%B0%E5%BA%94%E7%94%A8">AI/MLåˆ›æ–°åº”ç”¨</a></li>
</ol>
<hr/>
<h2 data-id="heading-1">æ–¹æ¡ˆæ¦‚è¿°</h2>
<h3 data-id="heading-2">1.1 æ•°æ®äº§å“çš„ä»·å€¼å®šä½</h3>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">æ•°æ®äº§å“ä¸‰ä¸ªå±‚çº§:</span>

L1 - ä¿¡æ¯å±•ç¤º (BIæŠ¥è¡¨)
â”œâ”€ é¢å‘: æ‰€æœ‰ä¸šåŠ¡äººå‘˜
â”œâ”€ ç‰¹ç‚¹: é™æ€/åŠé™æ€æŠ¥è¡¨, çœ‹å†å²æ•°æ®
â”œâ”€ å»¶è¿Ÿ: T+1 (æ¬¡æ—¥æŸ¥çœ‹)
â””â”€ ä»·å€¼: äº†è§£è¿‡å»å‘ç”Ÿäº†ä»€ä¹ˆ

L2 - å®æ—¶çœ‹æ¿ (é©¾é©¶èˆ±/çœ‹æ¿)
â”œâ”€ é¢å‘: ç®¡ç†å±‚ã€è¿è¥å±‚
â”œâ”€ ç‰¹ç‚¹: å®æ—¶æ•°æ®ã€æ‹–æ‹½äº¤äº’ã€å¤šç»´åˆ†æ
â”œâ”€ å»¶è¿Ÿ: &lt;5åˆ†é’Ÿæ›´æ–°
â””â”€ ä»·å€¼: å®æ—¶æŒæ¡å½“å‰çŠ¶æ€

L3 - æ™ºèƒ½å†³ç­– (AI/è‡ªåŠ¨åŒ–)
â”œâ”€ é¢å‘: å†³ç­–å±‚ã€ç³»ç»Ÿè‡ªåŠ¨åŒ–
â”œâ”€ ç‰¹ç‚¹: é¢„æµ‹ã€æ¨èã€è‡ªåŠ¨ä¼˜åŒ–
â”œâ”€ å»¶è¿Ÿ: æ¯«ç§’çº§
â””â”€ ä»·å€¼: é¢„æµ‹æœªæ¥ã€æŒ‡å¯¼è¡ŒåŠ¨ã€è‡ªåŠ¨åŒ–å†³ç­–
</code></pre>
<h3 data-id="heading-3">1.2 æ•°æ®äº§å“å…¨æ™¯</h3>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        æ•°æ®äº§å“ä¸åº”ç”¨åˆ›æ–°å…¨æ™¯å›¾                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚ <span class="hljs-number">1</span>ï¸âƒ£ BIæŠ¥è¡¨ç³»ç»Ÿ (æœˆåº¦/å‘¨åº¦/æ—¥åº¦)                      â”‚
â”‚    â”œâ”€ è´¢åŠ¡æ±‡æ€»æŠ¥è¡¨                                  â”‚
â”‚    â”œâ”€ é—¨åº—ç»è¥æ—¥æŠ¥                                  â”‚
â”‚    â”œâ”€ è¥é”€æ´»åŠ¨è¯„ä¼°                                  â”‚
â”‚    â””â”€ ä¾›åº”é“¾æˆæœ¬åˆ†æ                                â”‚
â”‚                                                      â”‚
â”‚ <span class="hljs-number">2</span>ï¸âƒ£ å®æ—¶é©¾é©¶èˆ± (è‘£äº‹é•¿/æ€»ç»ç†çº§)                     â”‚
â”‚    â”œâ”€ KPIæ¦‚è§ˆ                                       â”‚
â”‚    â”œâ”€ é—¨åº—æ’è¡Œæ¦œ                                    â”‚
â”‚    â”œâ”€ æˆæœ¬æ§åˆ¶                                      â”‚
â”‚    â””â”€ é£é™©å‘Šè­¦                                      â”‚
â”‚                                                      â”‚
â”‚ <span class="hljs-number">3</span>ï¸âƒ£ é—¨åº—ç»ç†çœ‹æ¿ (ä¸€çº¿é—¨åº—ç”¨)                        â”‚
â”‚    â”œâ”€ ä»Šæ—¥ç»è¥                                      â”‚
â”‚    â”œâ”€ ç­æ¬¡ç®¡ç†                                      â”‚
â”‚    â”œâ”€ èœå“é”€å”®                                      â”‚
â”‚    â””â”€ åº“å­˜é¢„è­¦                                      â”‚
â”‚                                                      â”‚
â”‚ <span class="hljs-number">4</span>ï¸âƒ£ å®æ—¶è¿è¥å¹³å° (è´¢åŠ¡/ä¾›åº”é“¾ç”¨)                    â”‚
â”‚    â”œâ”€ å®æ—¶æˆæœ¬ç›‘æ§                                  â”‚
â”‚    â”œâ”€ åº“å­˜åŠ¨æ€                                      â”‚
â”‚    â””â”€ é‡‡è´­ç®¡ç†                                      â”‚
â”‚                                                      â”‚
â”‚ <span class="hljs-number">5</span>ï¸âƒ£ æ™ºèƒ½å†³ç­–å¼•æ“ (ç®—æ³•/ä¼˜åŒ–)                        â”‚
â”‚    â”œâ”€ é”€å”®é¢„æµ‹â†’ç­æ¬¡æ¨è                             â”‚
â”‚    â”œâ”€ åº“å­˜é¢„æµ‹â†’è¡¥è´§æ¨è                             â”‚
â”‚    â”œâ”€ èœå“é¢„æµ‹â†’èœå•è®¾è®¡æ¨è                         â”‚
â”‚    â””â”€ é€‰å€è¯„ä¼°â†’æ–°åº—å†³ç­–                             â”‚
â”‚                                                      â”‚
â”‚ <span class="hljs-number">6</span>ï¸âƒ£ AI/MLåº”ç”¨ (åˆ›æ–°é©±åŠ¨)                            â”‚
â”‚    â”œâ”€ ä¸ªæ€§åŒ–æ¨è                                    â”‚
â”‚    â”œâ”€ åŠ¨æ€å®šä»·                                      â”‚
â”‚    â”œâ”€ æ™ºèƒ½è®¢è´§                                      â”‚
â”‚    â””â”€ å®¢æµé¢„æµ‹                                      â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr/>
<h2 data-id="heading-4">BIæŠ¥è¡¨ç³»ç»Ÿè®¾è®¡</h2>
<h3 data-id="heading-5">2.1 æŠ¥è¡¨ä½“ç³»æ¶æ„</h3>
<pre><code class="hljs language-r" lang="r">BIç³»ç»Ÿåº”åŒ…å«çš„<span class="hljs-number">6</span>ç±»æŠ¥è¡¨<span class="hljs-operator">:</span>

â”Œâ”€ è´¢åŠ¡æŠ¥è¡¨ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€ æ—¥è´¢åŠ¡æ±‡æ€»
â”‚                              â”œâ”€ å‘¨è´¢åŠ¡åˆ†æ
â”‚ ç”¨é€”<span class="hljs-operator">:</span> CFO<span class="hljs-operator">/</span>è´¢åŠ¡éƒ¨é—¨            â”œâ”€ æœˆè´¢åŠ¡å†³ç®—
â”‚ å»¶è¿Ÿ<span class="hljs-operator">:</span> <span class="hljs-built_in">T</span><span class="hljs-operator">+</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">T</span><span class="hljs-operator">+</span><span class="hljs-number">7</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">T</span><span class="hljs-operator">+</span><span class="hljs-number">31</span>         â””â”€ æˆæœ¬å¯¹æ ‡åˆ†æ
â”‚
â”œâ”€ é—¨åº—æŠ¥è¡¨ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€ é—¨åº—æ—¥æŠ¥
â”‚                              â”œâ”€ é—¨åº—å‘¨æŠ¥
â”‚ ç”¨é€”<span class="hljs-operator">:</span> é—¨åº—ç»ç†<span class="hljs-operator">/</span>è¿è¥ç®¡ç†       â”œâ”€ é—¨åº—æœˆæŠ¥
â”‚ å»¶è¿Ÿ<span class="hljs-operator">:</span> <span class="hljs-built_in">T</span><span class="hljs-operator">+</span><span class="hljs-number">1</span>                    â””â”€ é—¨åº—å¯¹æ ‡æ’è¡Œ
â”‚
â”œâ”€ è¥é”€æŠ¥è¡¨ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€ æ´»åŠ¨æ•ˆæœæŠ¥å‘Š
â”‚                              â”œâ”€ ä¼šå‘˜åˆ†æ
â”‚ ç”¨é€”<span class="hljs-operator">:</span> è¥é”€éƒ¨é—¨<span class="hljs-operator">/</span>è¿è¥           â”œâ”€ æ¸ é“å¯¹æ ‡
â”‚ å»¶è¿Ÿ<span class="hljs-operator">:</span> <span class="hljs-built_in">T</span><span class="hljs-operator">+</span><span class="hljs-number">1</span>                    â””â”€ ä¿ƒé”€è¯„ä¼°
â”‚
â”œâ”€ ä¾›åº”é“¾æŠ¥è¡¨ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€ åº“å­˜åˆ†æ
â”‚                              â”œâ”€ é‡‡è´­æˆæœ¬
â”‚ ç”¨é€”<span class="hljs-operator">:</span> ä¾›åº”é“¾<span class="hljs-operator">/</span>é‡‡è´­              â”œâ”€ é£ŸææŸè€—
â”‚ å»¶è¿Ÿ<span class="hljs-operator">:</span> <span class="hljs-built_in">T</span><span class="hljs-operator">+</span><span class="hljs-number">1</span>                    â””â”€ ä¾›åº”å•†è¯„ä¼°
â”‚
â”œâ”€ äººåŠ›æŠ¥è¡¨ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€ äººæ•ˆåˆ†æ
â”‚                              â”œâ”€ ç­æ¬¡ç»Ÿè®¡
â”‚ ç”¨é€”<span class="hljs-operator">:</span> HR<span class="hljs-operator">/</span>é—¨åº—ç»ç†             â”œâ”€ å·¥èµ„æ ¸ç®—
â”‚ å»¶è¿Ÿ<span class="hljs-operator">:</span> <span class="hljs-built_in">T</span><span class="hljs-operator">+</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">T</span><span class="hljs-operator">+</span><span class="hljs-number">7</span>              â””â”€ å‘˜å·¥è¯„çº§
â”‚
â””â”€ æˆ˜ç•¥æŠ¥è¡¨ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€ æˆ˜ç•¥ä»ªè¡¨æ¿
                               â”œâ”€ ç«äº‰å¯¹æ ‡
                               â”œâ”€ æ–°åº—è¯„ä¼°
                               â””â”€ åŒºåŸŸè§„åˆ’
</code></pre>
<h3 data-id="heading-6">2.2 é—¨åº—ç»è¥æ—¥æŠ¥è®¾è®¡</h3>
<p><strong>æŠ¥è¡¨åŒ…å«çš„æ ¸å¿ƒå†…å®¹</strong>:</p>
<pre><code class="hljs language-erlang" lang="erlang">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           é—¨åº—ç»è¥æ—¥æŠ¥ (Daily Report)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é—¨åº—: SHOP001 é—¨åº—<span class="hljs-number">001</span>                                â”‚
â”‚ æ—¥æœŸ: <span class="hljs-number">2025</span>-<span class="hljs-number">12</span>-<span class="hljs-number">07</span> (å‘¨æ—¥)                             â”‚
â”‚ ç”Ÿæˆæ—¶é—´: <span class="hljs-number">06</span>:<span class="hljs-number">00</span> (ç¬¬äºŒå¤©æ—©æ™¨)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚ ğŸ“Š æ˜¨æ—¥æ¦‚è§ˆ                                          â”‚
â”‚ â”œâ”€ æ—¥é”€å”®é¢: Â¥<span class="hljs-number">28</span>,<span class="hljs-number">500</span> (ç¯æ¯”â†‘<span class="hljs-number">8</span><span class="hljs-comment">%, åŒæ¯”â†‘5%)            â”‚</span>
â”‚ â”œâ”€ è®¢å•æ•°: <span class="hljs-number">245</span>ç¬” (å¹³å‡Â¥<span class="hljs-number">116.3</span>/å•)                   â”‚
â”‚ â”œâ”€ å®¢æµäººæ•°: <span class="hljs-number">380</span>äºº                                  â”‚
â”‚ â”œâ”€ æˆæœ¬é¢: Â¥<span class="hljs-number">9</span>,<span class="hljs-number">050</span> (<span class="hljs-number">31.7</span><span class="hljs-comment">% - ç›®æ ‡30%)                â”‚</span>
â”‚ â””â”€ æ¯›åˆ©æ¶¦: Â¥<span class="hljs-number">19</span>,<span class="hljs-number">450</span> (<span class="hljs-number">68.3</span><span class="hljs-comment">%)                         â”‚</span>
â”‚                                                      â”‚
â”‚ ğŸ“ˆ æ—¶æ®µåˆ†å¸ƒ (æŸ±çŠ¶å›¾)                                 â”‚
â”‚ â”œâ”€ <span class="hljs-number">11</span>:<span class="hljs-number">00</span>-<span class="hljs-number">12</span>:<span class="hljs-number">00</span> (åˆé¤<span class="hljs-number">1</span>): Â¥<span class="hljs-number">5</span>,<span class="hljs-number">200</span> (<span class="hljs-number">18</span><span class="hljs-comment">%)              â”‚</span>
â”‚ â”œâ”€ <span class="hljs-number">12</span>:<span class="hljs-number">00</span>-<span class="hljs-number">13</span>:<span class="hljs-number">00</span> (åˆé¤<span class="hljs-number">2</span>): Â¥<span class="hljs-number">4</span>,<span class="hljs-number">800</span> (<span class="hljs-number">17</span><span class="hljs-comment">%)              â”‚</span>
â”‚ â”œâ”€ <span class="hljs-number">17</span>:<span class="hljs-number">00</span>-<span class="hljs-number">18</span>:<span class="hljs-number">00</span> (æ™šé¤<span class="hljs-number">1</span>): Â¥<span class="hljs-number">6</span>,<span class="hljs-number">200</span> (<span class="hljs-number">22</span><span class="hljs-comment">%)              â”‚</span>
â”‚ â”œâ”€ <span class="hljs-number">18</span>:<span class="hljs-number">00</span>-<span class="hljs-number">19</span>:<span class="hljs-number">00</span> (æ™šé¤<span class="hljs-number">2</span>): Â¥<span class="hljs-number">7</span>,<span class="hljs-number">500</span> (<span class="hljs-number">26</span><span class="hljs-comment">%)              â”‚</span>
â”‚ â””â”€ å…¶ä»–æ—¶æ®µ: Â¥<span class="hljs-number">4</span>,<span class="hljs-number">800</span> (<span class="hljs-number">17</span><span class="hljs-comment">%)                          â”‚</span>
â”‚                                                      â”‚
â”‚ ğŸ½ï¸ èœå“TOP <span class="hljs-number">5</span> (è¡¨æ ¼)                                 â”‚
â”‚ â”œâ”€ çº¢çƒ§è‚‰: <span class="hljs-number">58</span>ä»½, Â¥<span class="hljs-number">2204</span>, æ¯›åˆ©<span class="hljs-number">38</span><span class="hljs-comment">%                    â”‚</span>
â”‚ â”œâ”€ ç‚’é’èœ: <span class="hljs-number">42</span>ä»½, Â¥<span class="hljs-number">840</span>, æ¯›åˆ©<span class="hljs-number">52</span><span class="hljs-comment">%                     â”‚</span>
â”‚ â”œâ”€ é±¼é¦™è‚‰ä¸: <span class="hljs-number">45</span>ä»½, Â¥<span class="hljs-number">1620</span>, æ¯›åˆ©<span class="hljs-number">35</span><span class="hljs-comment">%                  â”‚</span>
â”‚ â”œâ”€ ç•ªèŒ„é¸¡è›‹: <span class="hljs-number">38</span>ä»½, Â¥<span class="hljs-number">570</span>, æ¯›åˆ©<span class="hljs-number">45</span><span class="hljs-comment">%                   â”‚</span>
â”‚ â””â”€ æ’éª¨æ±¤: <span class="hljs-number">35</span>ä»½, Â¥<span class="hljs-number">875</span>, æ¯›åˆ©<span class="hljs-number">30</span><span class="hljs-comment">%                     â”‚</span>
â”‚                                                      â”‚
â”‚ ğŸ‘¥ å®¢æµåˆ†æ                                          â”‚
â”‚ â”œâ”€ å ‚é£Ÿ: <span class="hljs-number">280</span>äºº (<span class="hljs-number">73.7</span><span class="hljs-comment">%)                             â”‚</span>
â”‚ â”œâ”€ å¤–å–: <span class="hljs-number">85</span>äºº (<span class="hljs-number">22.4</span><span class="hljs-comment">%)                              â”‚</span>
â”‚ â”œâ”€ é…é€: <span class="hljs-number">15</span>äºº (<span class="hljs-number">3.9</span><span class="hljs-comment">%)                               â”‚</span>
â”‚ â”œâ”€ ä¼šå‘˜æ¶ˆè´¹: <span class="hljs-number">142</span>äºº (<span class="hljs-number">37.4</span><span class="hljs-comment">%)                         â”‚</span>
â”‚ â””â”€ æ–°å®¢: <span class="hljs-number">45</span>äºº (<span class="hljs-number">11.8</span><span class="hljs-comment">%)                              â”‚</span>
â”‚                                                      â”‚
â”‚ âš ï¸ é¢„è­¦ä¸å»ºè®®                                        â”‚
â”‚ â”œâ”€ âœ“ æˆæœ¬æ§åˆ¶è‰¯å¥½                                   â”‚
â”‚ â”œâ”€ âš ï¸ äººå‡å®¢å•ä»·ç•¥ä½ (Â¥<span class="hljs-number">116</span> vsç›®æ ‡Â¥<span class="hljs-number">130</span>)            â”‚
â”‚ â”œâ”€ âš ï¸ ç‚’é’èœåº“å­˜ä»…<span class="hljs-number">3</span>ä»½ (æ˜å¤©å¯èƒ½ç¼ºè´§)               â”‚
â”‚ â””â”€ âœ“ ä¼šå‘˜å æ¯”è¾¾åˆ°ç›®æ ‡ (&gt;<span class="hljs-number">35</span><span class="hljs-comment">%)                       â”‚</span>
â”‚                                                      â”‚
â”‚ ğŸ“‹ ä»Šæ—¥è®¡åˆ’                                          â”‚
â”‚ â”œâ”€ æ¨è: æ­é…é”€å”®<span class="hljs-string">"æ’éª¨æ±¤+ç±³é¥­"</span> å¥—é¤                 â”‚
â”‚ â”œâ”€ åº“å­˜: è¡¥è´§ é’èœÃ—<span class="hljs-number">50</span>æ–¤, æ’éª¨Ã—<span class="hljs-number">30</span>æ–¤                 â”‚
â”‚ â”œâ”€ äººåŠ›: ä»Šæ™šå¤šè°ƒ<span class="hljs-number">1</span>äºº(é¢„è®¡å®¢æµâ†‘<span class="hljs-number">15</span><span class="hljs-comment">%)                â”‚</span>
â”‚ â””â”€ ä¿ƒé”€: ä¸‹åˆèŒ¶æ—¶æ®µæä¾›æŠ˜æ‰£èœå“                    â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-7">2.3 BIå·¥å…·é€‰å‹ä¸å®ç°</h3>
<p><strong>æ¨èæ–¹æ¡ˆ</strong>: Metabase (å¼€æº) + è‡ªç ”æ•°æ®ä»“åº“</p>
<p><strong>Metabaseä»ªè¡¨æ¿JSONç¤ºä¾‹</strong>:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"é—¨åº—ç»è¥çœ‹æ¿"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"å®æ—¶é—¨åº—KPIç›‘æ§"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"cards"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ—¥é”€å”®é¢"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"gauge"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"query"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"source-table"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"dws_daily_shop"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"aggregation"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"sum"</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"field"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"daily_sales"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"filter"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"="</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"field"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"shop_id"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"SHOP001"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"filter"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"="</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"field"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"stat_date"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"TODAY"</span><span class="hljs-punctuation">]</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"visualization"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"gauge"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">"min"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">15000</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"max"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">35000</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"target"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">25000</span><span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"å®æ—¶å®¢æµ"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"line"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"query"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"source-table"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"rt_traffic"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"dimensions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"hour"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"metrics"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"count"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"order-by"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">[</span><span class="hljs-string">"hour"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"ascending"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"èœå“æ’è¡Œ"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"table"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"query"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"source-table"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ods_order_items"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"aggregation"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
          <span class="hljs-punctuation">[</span><span class="hljs-string">"sum"</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"field"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"quantity"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
          <span class="hljs-punctuation">[</span><span class="hljs-string">"sum"</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"field"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"revenue"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span>
        <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"group-by"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"menu_name"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"order-by"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">[</span><span class="hljs-string">"revenue"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"descending"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"limit"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">10</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<h2 data-id="heading-8">é—¨åº—ç»ç†é©¾é©¶èˆ±</h2>
<h3 data-id="heading-9">3.1 é©¾é©¶èˆ±æ ¸å¿ƒè®¾è®¡</h3>
<p><strong>é¢å‘</strong>: åº—é•¿ã€åœ°åŒºç»ç†ã€è¿è¥ç®¡ç†å±‚</p>
<p><strong>å®æ—¶æ›´æ–°é¢‘ç‡</strong>: 5åˆ†é’Ÿ</p>
<pre><code class="hljs language-ini" lang="ini">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         é—¨åº—ç»ç†é©¾é©¶èˆ± (Real-time Dashboard)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚ ğŸ“Š ä¸‰å¤§æ ¸å¿ƒæŒ‡æ ‡ (å¡ç‰‡å¼)                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚ â”‚ ä»Šæ—¥é”€å”® â”‚ ç›®æ ‡è¾¾æˆ â”‚ äººå‡æ•ˆç‡ â”‚ æˆæœ¬ç‡   â”‚           â”‚
â”‚ â”‚ Â¥18,500 â”‚  74.0%   â”‚ Â¥3,050  â”‚  31.2%   â”‚           â”‚
â”‚ â”‚ â†‘5.2%   â”‚ â†“3.5%    â”‚ â†‘2.1%   â”‚ â†‘0.8%    â”‚           â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                          â”‚
â”‚ ğŸ“ˆ æ—¶åºè¶‹åŠ¿ (4ä¸ªå°æ—¶çº§å›¾è¡¨)                              â”‚
â”‚ â”œâ”€ é”€å”®é¢è¶‹åŠ¿: æŠ˜çº¿å›¾ (å½“æ—¥vsæ˜¨æ—¥vså†å²å¹³å‡)           â”‚
â”‚ â”œâ”€ å®¢æµè¶‹åŠ¿: æŸ±çŠ¶å›¾ (å®æ—¶å®¢æµæ•°)                       â”‚
â”‚ â”œâ”€ æˆæœ¬ç›‘æ§: é¢ç§¯å›¾ (æˆæœ¬ç‡èµ°åŠ¿)                       â”‚
â”‚ â””â”€ äººæ•ˆèµ°åŠ¿: æŠ˜çº¿å›¾ (æ¯ä¸ªæœåŠ¡å‘˜çš„äº§å‡º)                â”‚
â”‚                                                          â”‚
â”‚ ğŸª é—¨åº—æ’è¡Œ (è¡¨æ ¼ - å¯æ’åº)                             â”‚
â”‚ â”œâ”€ SHOP001: Â¥28,500 â˜…â˜…â˜…â˜…â˜… (æ’å1/200)               â”‚
â”‚ â”œâ”€ SHOP012: Â¥26,200 â˜…â˜…â˜…â˜…â˜† (æ’å2/200)               â”‚
â”‚ â”œâ”€ SHOP045: Â¥25,800 â˜…â˜…â˜…â˜…â˜† (æ’å3/200)               â”‚
â”‚ â””â”€ ... (ä¸‹æ‹‰å¯è§æ‰€æœ‰é—¨åº—, å¯æŒ‰é”€å”®/æˆæœ¬/äººæ•ˆæ’åº)      â”‚
â”‚                                                          â”‚
â”‚ âš ï¸ å®æ—¶å‘Šè­¦ (æ»šåŠ¨æ¶ˆæ¯)                                  â”‚
â”‚ â”œâ”€ ğŸ”´ SHOP067 æˆæœ¬ç‡å¼‚å¸¸ (35.6%, ç›®æ ‡30%)             â”‚
â”‚ â”œâ”€ ğŸŸ¡ SHOP102 å®¢æµé¢„è­¦ (17:00åå®¢æµæœªåˆ°ä½)           â”‚
â”‚ â”œâ”€ ğŸŸ  SHOP089 ç¼ºè´§é¢„è­¦ (çº¢çƒ§è‚‰åº“å­˜ä»…5ä»½)             â”‚
â”‚ â””â”€ ğŸŸ¢ SHOP201 ç›®æ ‡è¾¾æˆ (å·²å®Œæˆ105%)                   â”‚
â”‚                                                          â”‚
â”‚ ğŸ“ åœ°ç†åˆ†å¸ƒ (åœ°å›¾)                                      â”‚
â”‚ â”œâ”€ çƒ­åŠ›å›¾: æ˜¾ç¤ºå„åŒºåŸŸé”€å”®å¼ºåº¦                          â”‚
â”‚ â”œâ”€ ç‚¹å‡»é—¨åº—: æŸ¥çœ‹è¯¦ç»†æ•°æ®                              â”‚
â”‚ â””â”€ ç­›é€‰: æŒ‰åŸå¸‚/åŒºåŸŸ/ç±»å‹ç­›é€‰                          â”‚
â”‚                                                          â”‚
â”‚ ğŸ“± å¿«æ·æ“ä½œ                                             â”‚
â”‚ â”œâ”€ <span class="hljs-section">[æŸ¥çœ‹è¯¦æƒ…]</span> â†’ è¿›å…¥é—¨åº—è¯¦ç»†çœ‹æ¿                       â”‚
â”‚ â”œâ”€ <span class="hljs-section">[å¯¼å‡ºæŠ¥è¡¨]</span> â†’ å¯¼å‡ºExcel/PDF                         â”‚
â”‚ â”œâ”€ <span class="hljs-section">[ä¸‹é’»åˆ†æ]</span> â†’ è¿›å…¥æ›´ç»†ç²’åº¦æ•°æ®                       â”‚
â”‚ â””â”€ <span class="hljs-section">[åˆ†äº«]</span> â†’ åˆ†äº«ç»™å…¶ä»–ç®¡ç†è€…                          â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-10">3.2 é©¾é©¶èˆ±å»ºç«‹SQL</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åˆ›å»ºé©¾é©¶èˆ±æ•°æ®æºè¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> rt_dashboard_kpi <span class="hljs-keyword">AS</span>
<span class="hljs-keyword">SELECT</span>
    shop_id,
    shop_name,
    city,
    district,
    <span class="hljs-built_in">CURRENT_TIMESTAMP</span>() <span class="hljs-keyword">as</span> update_time,
    
    <span class="hljs-comment">-- æ ¸å¿ƒæŒ‡æ ‡</span>
    <span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> stat_date <span class="hljs-operator">=</span> CURDATE() <span class="hljs-keyword">THEN</span> daily_sales <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-keyword">AS</span> today_sales,
    <span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> stat_date <span class="hljs-operator">=</span> CURDATE() <span class="hljs-operator">-</span> <span class="hljs-type">INTERVAL</span> <span class="hljs-number">1</span> <span class="hljs-keyword">DAY</span> <span class="hljs-keyword">THEN</span> daily_sales <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-keyword">AS</span> yesterday_sales,
    <span class="hljs-built_in">AVG</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> stat_date <span class="hljs-operator">&gt;=</span> CURDATE() <span class="hljs-operator">-</span> <span class="hljs-type">INTERVAL</span> <span class="hljs-number">30</span> <span class="hljs-keyword">DAY</span> <span class="hljs-keyword">THEN</span> daily_sales <span class="hljs-keyword">ELSE</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">END</span>) <span class="hljs-keyword">AS</span> avg_30day_sales,
    
    <span class="hljs-comment">-- ç›®æ ‡è¾¾æˆ</span>
    <span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> stat_date <span class="hljs-operator">=</span> CURDATE() <span class="hljs-keyword">THEN</span> daily_sales <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-operator">/</span> <span class="hljs-number">25000</span> <span class="hljs-operator">*</span> <span class="hljs-number">100</span> <span class="hljs-keyword">AS</span> target_achievement,
    
    <span class="hljs-comment">-- äººå‡æ•ˆç‡</span>
    <span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> stat_date <span class="hljs-operator">=</span> CURDATE() <span class="hljs-keyword">THEN</span> daily_sales <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-operator">/</span> 
    <span class="hljs-built_in">NULLIF</span>(<span class="hljs-built_in">AVG</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> stat_date <span class="hljs-operator">=</span> CURDATE() <span class="hljs-keyword">THEN</span> daily_staff_count <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>), <span class="hljs-number">0</span>) <span class="hljs-keyword">AS</span> per_capita_efficiency,
    
    <span class="hljs-comment">-- æˆæœ¬ç‡</span>
    <span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> stat_date <span class="hljs-operator">=</span> CURDATE() <span class="hljs-keyword">THEN</span> total_cost <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-operator">/</span> 
    <span class="hljs-built_in">NULLIF</span>(<span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> stat_date <span class="hljs-operator">=</span> CURDATE() <span class="hljs-keyword">THEN</span> daily_sales <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>), <span class="hljs-number">0</span>) <span class="hljs-operator">*</span> <span class="hljs-number">100</span> <span class="hljs-keyword">AS</span> cost_ratio,
    
    <span class="hljs-comment">-- ç¯æ¯”å’ŒåŒæ¯”</span>
    (<span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> stat_date <span class="hljs-operator">=</span> CURDATE() <span class="hljs-keyword">THEN</span> daily_sales <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-operator">-</span> 
     <span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> stat_date <span class="hljs-operator">=</span> CURDATE() <span class="hljs-operator">-</span> <span class="hljs-type">INTERVAL</span> <span class="hljs-number">1</span> <span class="hljs-keyword">DAY</span> <span class="hljs-keyword">THEN</span> daily_sales <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>)) <span class="hljs-operator">/</span> 
    <span class="hljs-built_in">NULLIF</span>(<span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> stat_date <span class="hljs-operator">=</span> CURDATE() <span class="hljs-operator">-</span> <span class="hljs-type">INTERVAL</span> <span class="hljs-number">1</span> <span class="hljs-keyword">DAY</span> <span class="hljs-keyword">THEN</span> daily_sales <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>), <span class="hljs-number">0</span>) <span class="hljs-operator">*</span> <span class="hljs-number">100</span> <span class="hljs-keyword">AS</span> mom_growth,
    
    <span class="hljs-comment">-- æ’å</span>
    <span class="hljs-built_in">ROW_NUMBER</span>() <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> stat_date <span class="hljs-operator">=</span> CURDATE() <span class="hljs-keyword">THEN</span> daily_sales <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> rank,
    
    <span class="hljs-comment">-- è¯„çº§</span>
    <span class="hljs-keyword">CASE</span> 
        <span class="hljs-keyword">WHEN</span> <span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> stat_date <span class="hljs-operator">=</span> CURDATE() <span class="hljs-keyword">THEN</span> daily_sales <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-operator">/</span> <span class="hljs-number">25000</span> <span class="hljs-operator">&gt;=</span> <span class="hljs-number">1.0</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'âœ“ä¼˜ç§€'</span>
        <span class="hljs-keyword">WHEN</span> <span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> stat_date <span class="hljs-operator">=</span> CURDATE() <span class="hljs-keyword">THEN</span> daily_sales <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-operator">/</span> <span class="hljs-number">25000</span> <span class="hljs-operator">&gt;=</span> <span class="hljs-number">0.9</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'âœ“è‰¯å¥½'</span>
        <span class="hljs-keyword">WHEN</span> <span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> stat_date <span class="hljs-operator">=</span> CURDATE() <span class="hljs-keyword">THEN</span> daily_sales <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-operator">/</span> <span class="hljs-number">25000</span> <span class="hljs-operator">&gt;=</span> <span class="hljs-number">0.8</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'âš ï¸ä¸€èˆ¬'</span>
        <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'âŒé¢„è­¦'</span>
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> performance_rating
    
<span class="hljs-keyword">FROM</span> dws_daily_shop_analysis
<span class="hljs-keyword">WHERE</span> stat_date <span class="hljs-operator">&gt;=</span> CURDATE() <span class="hljs-operator">-</span> <span class="hljs-type">INTERVAL</span> <span class="hljs-number">90</span> <span class="hljs-keyword">DAY</span>
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> rank;
</code></pre>
<hr/>
<h2 data-id="heading-11">å®æ—¶è¿è¥çœ‹æ¿</h2>
<h3 data-id="heading-12">4.1 è´¢åŠ¡å®æ—¶çœ‹æ¿</h3>
<pre><code class="hljs language-erlang" lang="erlang">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       å®æ—¶è´¢åŠ¡è¿è¥çœ‹æ¿ (CFO Dashboard)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚ ğŸ“Š ä»Šæ—¥æ ¸å¿ƒè´¢åŠ¡æŒ‡æ ‡                                  â”‚
â”‚ â”œâ”€ é›†å›¢æ—¥é”€: Â¥<span class="hljs-number">5</span>,<span class="hljs-number">680</span>,<span class="hljs-number">000</span> (å®æ—¶ç´¯è®¡)                  â”‚
â”‚ â”œâ”€ ç´¯è®¡æ¯›åˆ©: Â¥<span class="hljs-number">3</span>,<span class="hljs-number">876</span>,<span class="hljs-number">400</span> (<span class="hljs-number">68.2</span><span class="hljs-comment">%)                    â”‚</span>
â”‚ â”œâ”€ ç´¯è®¡æˆæœ¬: Â¥<span class="hljs-number">1</span>,<span class="hljs-number">803</span>,<span class="hljs-number">600</span> (<span class="hljs-number">31.8</span><span class="hljs-comment">%)                    â”‚</span>
â”‚ â””â”€ æœŸæœ«é¢„ä¼°: Â¥<span class="hljs-number">5</span>,<span class="hljs-number">850</span>,<span class="hljs-number">000</span> (åŸºäºå½“å‰è¶‹åŠ¿)            â”‚
â”‚                                                      â”‚
â”‚ ğŸ’° è´¢åŠ¡å®æ—¶è¶‹åŠ¿                                      â”‚
â”‚ â”œâ”€ é”€å”®è¶‹åŠ¿: ğŸ“ˆ (å®æ—¶æ•°æ®, æ¯<span class="hljs-number">5</span>åˆ†é’Ÿæ›´æ–°)            â”‚
â”‚ â”œâ”€ æˆæœ¬ç›‘æ§: ğŸ“Š (ä¸é¢„ç®—å¯¹æ¯”)                       â”‚
â”‚ â”œâ”€ ç°é‡‘æµ: ğŸ“ˆ (åº”æ”¶/åº”ä»˜åŠ¨æ€)                      â”‚
â”‚ â””â”€ åˆ©æ¶¦æ›²çº¿: ğŸ“Š (å®é™…vsé¢„æµ‹)                       â”‚
â”‚                                                      â”‚
â”‚ ğŸª æˆæœ¬é¢„è­¦                                          â”‚
â”‚ â”œâ”€ é«˜æˆæœ¬é—¨åº—Top <span class="hljs-number">5</span> (æˆæœ¬ç‡&gt;<span class="hljs-number">35</span><span class="hljs-comment">%)                     â”‚</span>
â”‚ â”‚  â””â”€ SHOP067: <span class="hljs-number">35.6</span><span class="hljs-comment">%, SHOP089: 34.8% ...          â”‚</span>
â”‚ â”œâ”€ é£Ÿææˆæœ¬å¼‚å¸¸: XXXé£Ÿææˆæœ¬â†‘<span class="hljs-number">12</span><span class="hljs-comment">%                   â”‚</span>
â”‚ â”œâ”€ äººå·¥æˆæœ¬å¼‚å¸¸: æœ¬æœˆç´¯è®¡åŠ ç­è´¹â†‘<span class="hljs-number">18</span><span class="hljs-comment">%                 â”‚</span>
â”‚ â””â”€ é‡‡è´­å¼‚å¸¸: æŸä¾›åº”å•†ä»·æ ¼â†‘<span class="hljs-number">8</span><span class="hljs-comment">%                       â”‚</span>
â”‚                                                      â”‚
â”‚ ğŸ“ˆ æŒ‰æ—¶æ®µç›‘æ§                                        â”‚
â”‚ â”œâ”€ æ—©é¤ (<span class="hljs-number">07</span>:<span class="hljs-number">00</span>-<span class="hljs-number">10</span>:<span class="hljs-number">00</span>): Â¥<span class="hljs-number">450</span>,<span class="hljs-number">000</span>                   â”‚
â”‚ â”œâ”€ åˆé¤ (<span class="hljs-number">11</span>:<span class="hljs-number">00</span>-<span class="hljs-number">14</span>:<span class="hljs-number">00</span>): Â¥<span class="hljs-number">2</span>,<span class="hljs-number">100</span>,<span class="hljs-number">000</span>                 â”‚
â”‚ â”œâ”€ ä¸‹åˆèŒ¶ (<span class="hljs-number">14</span>:<span class="hljs-number">00</span>-<span class="hljs-number">17</span>:<span class="hljs-number">00</span>): Â¥<span class="hljs-number">800</span>,<span class="hljs-number">000</span>                 â”‚
â”‚ â””â”€ æ™šé¤ (<span class="hljs-number">17</span>:<span class="hljs-number">00</span>-<span class="hljs-number">22</span>:<span class="hljs-number">00</span>): Â¥<span class="hljs-number">2</span>,<span class="hljs-number">330</span>,<span class="hljs-number">000</span>                 â”‚
â”‚                                                      â”‚
â”‚ ğŸ” å¯¹æ ‡åˆ†æ                                          â”‚
â”‚ â”œâ”€ æœ¬æœˆvsä¸Šæœˆ: +<span class="hljs-number">8.2</span><span class="hljs-comment">%                               â”‚</span>
â”‚ â”œâ”€ æœ¬æœˆvså»å¹´: +<span class="hljs-number">12.5</span><span class="hljs-comment">%                              â”‚</span>
â”‚ â”œâ”€ æœ¬æœˆvsé¢„ç®—: -<span class="hljs-number">2.3</span><span class="hljs-comment">%                               â”‚</span>
â”‚ â””â”€ è¡Œä¸šå¹³å‡: +<span class="hljs-number">4.5</span><span class="hljs-comment">%                                 â”‚</span>
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-13">4.2 åº“å­˜å®æ—¶çœ‹æ¿</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="hljs-string">â”‚</span>        <span class="hljs-string">åº“å­˜å®æ—¶ç›‘æ§çœ‹æ¿</span> <span class="hljs-string">(Inventory</span> <span class="hljs-string">Dashboard)</span>        <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="hljs-string">â”‚</span>                                                      <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">ğŸ“¦</span> <span class="hljs-string">åº“å­˜çŠ¶æ€æ¦‚è§ˆ</span>                                      <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">â”œâ”€</span> <span class="hljs-string">åœ¨åº“å•†å“:</span> <span class="hljs-number">45</span><span class="hljs-string">ç§,</span> <span class="hljs-string">åº“å­˜ä»·å€¼Â¥280ä¸‡</span>                   <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">â”œâ”€</span> <span class="hljs-string">åº“å­˜å‘¨è½¬ç‡:</span> <span class="hljs-number">12.5</span><span class="hljs-string">æ¬¡/å¹´</span> <span class="hljs-string">(è¡Œä¸šå¹³å‡10)</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">â”œâ”€</span> <span class="hljs-string">åº“å­˜ç§¯å‹ç‡:</span> <span class="hljs-number">2.3</span><span class="hljs-string">%</span> <span class="hljs-string">(ç›®æ ‡&lt;3%)</span>                      <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">â””â”€</span> <span class="hljs-string">å³æœŸå•†å“:</span> <span class="hljs-number">3</span><span class="hljs-string">ç§,</span> <span class="hljs-string">éœ€åœ¨7å¤©å†…å”®å‡º</span>                    <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>                                                      <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">âš ï¸</span> <span class="hljs-string">åº“å­˜é¢„è­¦</span> <span class="hljs-string">(çº¢é»„ç»¿ç¯)</span>                              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">â”œâ”€</span> <span class="hljs-string">ğŸ”´</span> <span class="hljs-string">ç¼ºè´§é£é™©</span> <span class="hljs-string">(3ç§):</span>                              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”œâ”€</span> <span class="hljs-string">çº¢çƒ§è‚‰:</span> <span class="hljs-string">åº“å­˜5ä»½,</span> <span class="hljs-string">æ—¥å‡æ¶ˆè€—15ä»½</span>                <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”œâ”€</span> <span class="hljs-string">æ’éª¨æ±¤:</span> <span class="hljs-string">åº“å­˜3ä»½,</span> <span class="hljs-string">æ—¥å‡æ¶ˆè€—12ä»½</span>                <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">â”‚</span>  <span class="hljs-string">â””â”€</span> <span class="hljs-string">å»ºè®®:</span> <span class="hljs-string">ç«‹å³è¡¥è´§</span> <span class="hljs-string">(é¢„è®¡3å°æ—¶å†…åˆ°è¾¾)</span>            <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">â”œâ”€</span> <span class="hljs-string">ğŸŸ¡</span> <span class="hljs-string">åº“å­˜é¢„è­¦</span> <span class="hljs-string">(8ç§):</span>                              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">â”‚</span>  <span class="hljs-string">â””â”€</span> <span class="hljs-string">å»ºè®®:</span> <span class="hljs-string">åŠ å¿«é”€å”®,</span> <span class="hljs-string">å®‰æ’æ‰“æŠ˜ä¿ƒé”€</span>                <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">â””â”€</span> <span class="hljs-string">ğŸŸ¢</span> <span class="hljs-string">åº“å­˜æ­£å¸¸</span> <span class="hljs-string">(34ç§)</span>                              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>                                                      <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">ğŸ“Š</span> <span class="hljs-string">åº“å­˜ROIåˆ†æ</span>                                       <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">â”œâ”€</span> <span class="hljs-string">é«˜æµè½¬å•†å“</span> <span class="hljs-attr">Top 5:</span> <span class="hljs-string">(å‘¨è½¬&gt;3æ¬¡/æœˆ)</span>                 <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">â”‚</span>  <span class="hljs-string">â””â”€</span> <span class="hljs-string">å¤§ç±³,</span> <span class="hljs-string">æ²¹,</span> <span class="hljs-string">ç›,</span> <span class="hljs-string">é…±æ²¹,</span> <span class="hljs-string">é¸¡è›‹</span>                    <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">â”œâ”€</span> <span class="hljs-string">ä½æµè½¬å•†å“</span> <span class="hljs-attr">Top 5:</span> <span class="hljs-string">(å‘¨è½¬&lt;1æ¬¡/æœˆ)</span>                 <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">â”‚</span>  <span class="hljs-string">â””â”€</span> <span class="hljs-string">æŸé«˜æ¡£é£Ÿæ,</span> <span class="hljs-string">æŸå°ä¼—èœå“</span> <span class="hljs-string">â†’</span> <span class="hljs-string">å»ºè®®æ·˜æ±°</span>           <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">â””â”€</span> <span class="hljs-string">åº“å­˜æˆæœ¬:</span> <span class="hljs-string">Â¥2,800/å¤©</span> <span class="hljs-string">(ç›®æ ‡Â¥2,500/å¤©)</span>            <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>                                                      <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">ğŸ—“ï¸</span> <span class="hljs-string">é‡‡è´­æ—¥ç¨‹</span>                                         <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">â”œâ”€</span> <span class="hljs-string">ä»Šæ—¥åˆ°è´§:</span> <span class="hljs-number">3</span><span class="hljs-string">æ‰¹</span> <span class="hljs-string">(13:00,</span> <span class="hljs-number">15</span><span class="hljs-string">:30,</span> <span class="hljs-number">18</span><span class="hljs-string">:00)</span>            <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">â”œâ”€</span> <span class="hljs-string">æ˜æ—¥è®¡åˆ’:</span> <span class="hljs-string">çº¢çƒ§è‚‰Ã—100ä»½,</span> <span class="hljs-string">é’èœÃ—80ä»½</span>              <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">â”œâ”€</span> <span class="hljs-string">å‘¨é‡‡è´­:</span> <span class="hljs-string">æ€»é‡‡è´­é¢Â¥45,000</span> <span class="hljs-string">(vsé¢„ç®—Â¥48,000)</span>       <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">â””â”€</span> <span class="hljs-string">å¼‚å¸¸é‡‡è´­:</span> <span class="hljs-string">æŸæ‰¹è”¬èœè´¨é‡ä¸åˆæ ¼,</span> <span class="hljs-string">å·²ç”³è¯·é€€è´§</span>        <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>                                                      <span class="hljs-string">â”‚</span>
<span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre>
<hr/>
<h2 data-id="heading-14">æ™ºèƒ½å†³ç­–å¼•æ“</h2>
<h3 data-id="heading-15">5.1 æ™ºèƒ½æ¨èç³»ç»Ÿ</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># intelligent_recommendation.py - æ™ºèƒ½å†³ç­–æ¨èå¼•æ“</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">IntelligentRecommendationEngine</span>:
    <span class="hljs-string">"""æ™ºèƒ½æ¨èå¼•æ“ - åŸºäºé¢„æµ‹å’Œä¼˜åŒ–çš„å†³ç­–æ”¯æŒ"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recommend_staffing_schedule</span>(<span class="hljs-params">self, shop_id, date</span>):
        <span class="hljs-string">"""æ¨èç­æ¬¡å®‰æ’"""</span>
        <span class="hljs-comment"># è·å–é”€å”®é¢„æµ‹</span>
        forecast = self._get_sales_forecast(shop_id, date)
        
        <span class="hljs-comment"># æŒ‰å°æ—¶çº§é¢„æµ‹åˆ†è§£</span>
        hourly_forecast = forecast[<span class="hljs-string">'hourly_breakdown'</span>]
        
        <span class="hljs-comment"># æ¨èç­æ¬¡</span>
        recommendations = []
        <span class="hljs-keyword">for</span> hour, predicted_orders <span class="hljs-keyword">in</span> hourly_forecast.items():
            <span class="hljs-comment"># åŸºäºè®¢å•æ•°æ¨èéœ€è¦çš„äººæ•°</span>
            <span class="hljs-comment"># å¹³å‡æ¯ä¸ªæœåŠ¡å‘˜å¯å¤„ç†15ä¸ªè®¢å•/å°æ—¶</span>
            recommended_staff = <span class="hljs-built_in">max</span>(<span class="hljs-number">2</span>, <span class="hljs-built_in">int</span>(predicted_orders / <span class="hljs-number">15</span>))
            
            recommendations.append({
                <span class="hljs-string">'hour'</span>: hour,
                <span class="hljs-string">'predicted_orders'</span>: predicted_orders,
                <span class="hljs-string">'recommended_staff'</span>: recommended_staff,
                <span class="hljs-string">'estimated_payroll'</span>: recommended_staff * <span class="hljs-number">50</span>,  <span class="hljs-comment"># 50å…ƒ/äºº/å°æ—¶</span>
                <span class="hljs-string">'confidence'</span>: forecast[<span class="hljs-string">'confidence_level'</span>]
            })
        
        <span class="hljs-comment"># æˆæœ¬ä¼˜åŒ–</span>
        total_cost = <span class="hljs-built_in">sum</span>([r[<span class="hljs-string">'estimated_payroll'</span>] <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> recommendations])
        
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'date'</span>: date,
            <span class="hljs-string">'schedule'</span>: recommendations,
            <span class="hljs-string">'estimated_daily_payroll'</span>: total_cost,
            <span class="hljs-string">'cost_vs_budget'</span>: total_cost / <span class="hljs-number">6000</span>,  <span class="hljs-comment"># ä¸æ—¥å‡é¢„ç®—æ¯”è¾ƒ</span>
            <span class="hljs-string">'confidence_level'</span>: forecast[<span class="hljs-string">'confidence_level'</span>]
        }
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recommend_menu_optimization</span>(<span class="hljs-params">self, shop_id</span>):
        <span class="hljs-string">"""æ¨èèœå•ä¼˜åŒ–"""</span>
        <span class="hljs-comment"># åˆ†æèœå“çš„é”€å”®ã€åˆ©æ¶¦ã€å‡ºèœæ•ˆç‡</span>
        menu_analysis = self._analyze_menu_performance(shop_id)
        
        recommendations = {
            <span class="hljs-string">'high_profit_items'</span>: [],  <span class="hljs-comment"># é«˜åˆ©æ¶¦èœå“â†’æ¨èä¸»æ¨</span>
            <span class="hljs-string">'low_profit_items'</span>: [],   <span class="hljs-comment"># ä½åˆ©æ¶¦èœå“â†’å»ºè®®è°ƒæ•´ä»·æ ¼</span>
            <span class="hljs-string">'slow_moving_items'</span>: [],  <span class="hljs-comment"># æ»é”€èœå“â†’å»ºè®®ä¸‹æ¶æˆ–ä¿ƒé”€</span>
            <span class="hljs-string">'combo_suggestions'</span>: []   <span class="hljs-comment"># æ­é…å»ºè®®</span>
        }
        
        <span class="hljs-keyword">for</span> menu <span class="hljs-keyword">in</span> menu_analysis:
            <span class="hljs-keyword">if</span> menu[<span class="hljs-string">'profit_margin'</span>] &gt; <span class="hljs-number">50</span> <span class="hljs-keyword">and</span> menu[<span class="hljs-string">'popularity'</span>] &gt; <span class="hljs-number">50</span>:
                recommendations[<span class="hljs-string">'high_profit_items'</span>].append({
                    <span class="hljs-string">'menu_id'</span>: menu[<span class="hljs-string">'id'</span>],
                    <span class="hljs-string">'menu_name'</span>: menu[<span class="hljs-string">'name'</span>],
                    <span class="hljs-string">'profit_margin'</span>: menu[<span class="hljs-string">'profit_margin'</span>],
                    <span class="hljs-string">'action'</span>: <span class="hljs-string">'â†‘ä¼˜åŒ–èœå•ä½ç½®, å¢åŠ æ¨è'</span>
                })
            
            <span class="hljs-keyword">if</span> menu[<span class="hljs-string">'popularity'</span>] &lt; <span class="hljs-number">10</span>:
                recommendations[<span class="hljs-string">'slow_moving_items'</span>].append({
                    <span class="hljs-string">'menu_id'</span>: menu[<span class="hljs-string">'id'</span>],
                    <span class="hljs-string">'menu_name'</span>: menu[<span class="hljs-string">'name'</span>],
                    <span class="hljs-string">'action'</span>: <span class="hljs-string">'è°ƒæ•´ä»·æ ¼æˆ–ä¸‹æ¶'</span>
                })
        
        <span class="hljs-keyword">return</span> recommendations
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recommend_inventory_replenishment</span>(<span class="hljs-params">self, shop_id</span>):
        <span class="hljs-string">"""æ¨èåº“å­˜è¡¥è´§"""</span>
        <span class="hljs-comment"># è·å–éœ€æ±‚é¢„æµ‹</span>
        demand_forecast = self._get_ingredient_demand_forecast(shop_id, days=<span class="hljs-number">7</span>)
        
        <span class="hljs-comment"># å½“å‰åº“å­˜</span>
        current_inventory = self._get_current_inventory(shop_id)
        
        recommendations = []
        <span class="hljs-keyword">for</span> ingredient_id, predicted_demand <span class="hljs-keyword">in</span> demand_forecast.items():
            current = current_inventory.get(ingredient_id, <span class="hljs-number">0</span>)
            reorder_point = predicted_demand[<span class="hljs-string">'7day_total'</span>] * <span class="hljs-number">1.1</span> * <span class="hljs-number">0.2</span>  <span class="hljs-comment"># è¦†ç›–1.4å¤©</span>
            
            <span class="hljs-keyword">if</span> current &lt;= reorder_point:
                order_qty = predicted_demand[<span class="hljs-string">'7day_total'</span>] * <span class="hljs-number">1.2</span>  <span class="hljs-comment"># è®¢è´­1.2å€éœ€æ±‚</span>
                
                recommendations.append({
                    <span class="hljs-string">'ingredient_id'</span>: ingredient_id,
                    <span class="hljs-string">'ingredient_name'</span>: self._get_ingredient_name(ingredient_id),
                    <span class="hljs-string">'current_stock'</span>: current,
                    <span class="hljs-string">'recommended_qty'</span>: order_qty,
                    <span class="hljs-string">'urgency'</span>: <span class="hljs-string">'P0_ç´§æ€¥'</span> <span class="hljs-keyword">if</span> current &lt; reorder_point * <span class="hljs-number">0.5</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'P1_éœ€è¡¥è´§'</span>,
                    <span class="hljs-string">'estimated_arrival'</span>: self._get_supplier_lead_time(ingredient_id),
                    <span class="hljs-string">'estimated_cost'</span>: order_qty * self._get_unit_price(ingredient_id)
                })
        
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">sorted</span>(recommendations, key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'urgency'</span>])
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recommend_marketing_action</span>(<span class="hljs-params">self, member_id</span>):
        <span class="hljs-string">"""æ¨èä¸ªæ€§åŒ–è¥é”€è¡ŒåŠ¨"""</span>
        <span class="hljs-comment"># è·å–ä¼šå‘˜æ¡£æ¡ˆ</span>
        profile = self._get_member_profile(member_id)
        
        <span class="hljs-comment"># è®¡ç®—æµå¤±é£é™©</span>
        churn_prob = self._calculate_churn_probability(profile)
        
        <span class="hljs-comment"># è®¡ç®—LTV</span>
        ltv = self._calculate_ltv(profile)
        
        <span class="hljs-comment"># æ ¹æ®é£é™©ç­‰çº§æ¨èè¥é”€è¡ŒåŠ¨</span>
        <span class="hljs-keyword">if</span> churn_prob &gt; <span class="hljs-number">0.7</span>:
            <span class="hljs-comment"># é«˜æµå¤±é£é™©â†’æŒ½å›è¥é”€</span>
            action = {
                <span class="hljs-string">'action'</span>: <span class="hljs-string">'win_back_campaign'</span>,
                <span class="hljs-string">'discount'</span>: <span class="hljs-number">20</span>,  <span class="hljs-comment"># 20%æŠ˜æ‰£</span>
                <span class="hljs-string">'frequency'</span>: <span class="hljs-string">'immediate'</span>,
                <span class="hljs-string">'channel'</span>: <span class="hljs-string">'push_notification'</span>,
                <span class="hljs-string">'message'</span>: <span class="hljs-string">f"å¥½ä¹…ä¸è§! ä¸“ä¸ºæ‚¨å‡†å¤‡<span class="hljs-subst">{profile[<span class="hljs-string">'favorite_category'</span>]}</span>ç‰¹ä¼˜æƒ "</span>
            }
        <span class="hljs-keyword">elif</span> churn_prob &gt; <span class="hljs-number">0.5</span> <span class="hljs-keyword">and</span> ltv &gt; <span class="hljs-number">1000</span>:
            <span class="hljs-comment"># ä¸­æµå¤±é£é™©+é«˜ä»·å€¼â†’å‡çº§æ¨è</span>
            action = {
                <span class="hljs-string">'action'</span>: <span class="hljs-string">'upgrade_offer'</span>,
                <span class="hljs-string">'recommend_items'</span>: self._get_premium_recommendations(profile),
                <span class="hljs-string">'frequency'</span>: <span class="hljs-string">'weekly'</span>,
                <span class="hljs-string">'channel'</span>: <span class="hljs-string">'email'</span>
            }
        <span class="hljs-keyword">else</span>:
            <span class="hljs-comment"># ä½é£é™©â†’å®šæœŸæ¨è</span>
            action = {
                <span class="hljs-string">'action'</span>: <span class="hljs-string">'regular_offer'</span>,
                <span class="hljs-string">'recommend_items'</span>: self._get_personalized_menu(profile),
                <span class="hljs-string">'frequency'</span>: <span class="hljs-string">'monthly'</span>
            }
        
        <span class="hljs-keyword">return</span> action
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recommend_site_selection</span>(<span class="hljs-params">self, candidate_sites</span>):
        <span class="hljs-string">"""æ¨èé€‰å€å†³ç­–"""</span>
        recommendations = []
        
        <span class="hljs-keyword">for</span> site <span class="hljs-keyword">in</span> candidate_sites:
            <span class="hljs-comment"># ä½¿ç”¨è®­ç»ƒçš„æ¨¡å‹é¢„æµ‹æˆåŠŸæ¦‚ç‡</span>
            success_prob = self._predict_store_success(site)
            
            <span class="hljs-comment"># ä¼°ç®—è´¢åŠ¡æŒ‡æ ‡</span>
            financials = self._estimate_financials(site)
            
            <span class="hljs-comment"># ç”Ÿæˆå†³ç­–å»ºè®®</span>
            <span class="hljs-keyword">if</span> success_prob &gt;= <span class="hljs-number">0.8</span>:
                decision = <span class="hljs-string">'ğŸŸ¢ ç«‹å³å¼€åº—'</span>
            <span class="hljs-keyword">elif</span> success_prob &gt;= <span class="hljs-number">0.6</span>:
                decision = <span class="hljs-string">'ğŸŸ¡ å¯ä»¥è€ƒè™‘'</span>
            <span class="hljs-keyword">else</span>:
                decision = <span class="hljs-string">'ğŸ”´ ä¸å»ºè®®'</span>
            
            recommendations.append({
                <span class="hljs-string">'site_id'</span>: site[<span class="hljs-string">'id'</span>],
                <span class="hljs-string">'site_address'</span>: site[<span class="hljs-string">'address'</span>],
                <span class="hljs-string">'success_probability'</span>: success_prob,
                <span class="hljs-string">'decision'</span>: decision,
                <span class="hljs-string">'estimated_monthly_sales'</span>: financials[<span class="hljs-string">'monthly_sales'</span>],
                <span class="hljs-string">'payback_period_months'</span>: financials[<span class="hljs-string">'payback_months'</span>],
                <span class="hljs-string">'risk_factors'</span>: site[<span class="hljs-string">'risk_factors'</span>]
            })
        
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">sorted</span>(recommendations, key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'success_probability'</span>], reverse=<span class="hljs-literal">True</span>)
    
    <span class="hljs-comment"># è¾…åŠ©æ–¹æ³•</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_get_sales_forecast</span>(<span class="hljs-params">self, shop_id, date</span>):
        <span class="hljs-keyword">pass</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_analyze_menu_performance</span>(<span class="hljs-params">self, shop_id</span>):
        <span class="hljs-keyword">pass</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_get_ingredient_demand_forecast</span>(<span class="hljs-params">self, shop_id, days</span>):
        <span class="hljs-keyword">pass</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_get_current_inventory</span>(<span class="hljs-params">self, shop_id</span>):
        <span class="hljs-keyword">pass</span>
</code></pre>
<h3 data-id="heading-16">5.2 å†³ç­–å»ºè®®API</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># decision_api.py - æ™ºèƒ½å†³ç­–APIæ¥å£</span>

<span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI, HTTPException
<span class="hljs-keyword">import</span> json

app = FastAPI()
engine = IntelligentRecommendationEngine()

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/api/v1/recommendation/staffing"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_staffing_recommendation</span>(<span class="hljs-params">shop_id: <span class="hljs-built_in">str</span>, date: <span class="hljs-built_in">str</span> = <span class="hljs-literal">None</span></span>):
    <span class="hljs-string">"""è·å–ç­æ¬¡å®‰æ’æ¨è"""</span>
    <span class="hljs-keyword">try</span>:
        recommendation = engine.recommend_staffing_schedule(shop_id, date <span class="hljs-keyword">or</span> datetime.now().date())
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'code'</span>: <span class="hljs-number">200</span>,
            <span class="hljs-string">'data'</span>: recommendation
        }
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-keyword">raise</span> HTTPException(status_code=<span class="hljs-number">500</span>, detail=<span class="hljs-built_in">str</span>(e))

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/api/v1/recommendation/menu"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_menu_recommendation</span>(<span class="hljs-params">shop_id: <span class="hljs-built_in">str</span></span>):
    <span class="hljs-string">"""è·å–èœå•ä¼˜åŒ–å»ºè®®"""</span>
    <span class="hljs-keyword">try</span>:
        recommendation = engine.recommend_menu_optimization(shop_id)
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'code'</span>: <span class="hljs-number">200</span>,
            <span class="hljs-string">'data'</span>: recommendation
        }
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-keyword">raise</span> HTTPException(status_code=<span class="hljs-number">500</span>, detail=<span class="hljs-built_in">str</span>(e))

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/api/v1/recommendation/inventory"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_inventory_recommendation</span>(<span class="hljs-params">shop_id: <span class="hljs-built_in">str</span></span>):
    <span class="hljs-string">"""è·å–åº“å­˜è¡¥è´§å»ºè®®"""</span>
    <span class="hljs-keyword">try</span>:
        recommendation = engine.recommend_inventory_replenishment(shop_id)
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'code'</span>: <span class="hljs-number">200</span>,
            <span class="hljs-string">'data'</span>: recommendation,
            <span class="hljs-string">'summary'</span>: {
                <span class="hljs-string">'total_items'</span>: <span class="hljs-built_in">len</span>(recommendation),
                <span class="hljs-string">'urgent_items'</span>: <span class="hljs-built_in">sum</span>(<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> recommendation <span class="hljs-keyword">if</span> <span class="hljs-string">'P0'</span> <span class="hljs-keyword">in</span> r[<span class="hljs-string">'urgency'</span>]),
                <span class="hljs-string">'total_cost'</span>: <span class="hljs-built_in">sum</span>(r[<span class="hljs-string">'estimated_cost'</span>] <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> recommendation)
            }
        }
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-keyword">raise</span> HTTPException(status_code=<span class="hljs-number">500</span>, detail=<span class="hljs-built_in">str</span>(e))

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/api/v1/recommendation/marketing/{member_id}"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_marketing_recommendation</span>(<span class="hljs-params">member_id: <span class="hljs-built_in">str</span></span>):
    <span class="hljs-string">"""è·å–ä¼šå‘˜è¥é”€å»ºè®®"""</span>
    <span class="hljs-keyword">try</span>:
        recommendation = engine.recommend_marketing_action(member_id)
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'code'</span>: <span class="hljs-number">200</span>,
            <span class="hljs-string">'data'</span>: recommendation
        }
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-keyword">raise</span> HTTPException(status_code=<span class="hljs-number">500</span>, detail=<span class="hljs-built_in">str</span>(e))

<span class="hljs-meta">@app.post(<span class="hljs-params"><span class="hljs-string">"/api/v1/recommendation/site-selection"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_site_selection_recommendation</span>(<span class="hljs-params">sites: <span class="hljs-built_in">list</span></span>):
    <span class="hljs-string">"""è·å–é€‰å€å†³ç­–å»ºè®®"""</span>
    <span class="hljs-keyword">try</span>:
        recommendations = engine.recommend_site_selection(sites)
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'code'</span>: <span class="hljs-number">200</span>,
            <span class="hljs-string">'data'</span>: recommendations,
            <span class="hljs-string">'top_choice'</span>: recommendations[<span class="hljs-number">0</span>] <span class="hljs-keyword">if</span> recommendations <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span>
        }
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-keyword">raise</span> HTTPException(status_code=<span class="hljs-number">500</span>, detail=<span class="hljs-built_in">str</span>(e))
</code></pre>
<hr/>
<h2 data-id="heading-17">AI/MLåˆ›æ–°åº”ç”¨</h2>
<h3 data-id="heading-18">6.1 ä¸ªæ€§åŒ–æ¨èç³»ç»Ÿ</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># personalization.py - AIä¸ªæ€§åŒ–æ¨è</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">PersonalizationEngine</span>:
    <span class="hljs-string">"""åŸºäºç”¨æˆ·è¡Œä¸ºçš„ä¸ªæ€§åŒ–æ¨èå¼•æ“"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, db_connection</span>):
        self.db = db_connection
        self.embedding_model = <span class="hljs-literal">None</span>  <span class="hljs-comment"># ä½¿ç”¨é¢„è®­ç»ƒembeddingæ¨¡å‹</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recommend_menu_items</span>(<span class="hljs-params">self, member_id, context=<span class="hljs-literal">None</span></span>):
        <span class="hljs-string">"""æ ¹æ®ç”¨æˆ·å†å²è¡Œä¸ºæ¨èèœå“"""</span>
        
        <span class="hljs-comment"># è·å–ç”¨æˆ·æ¡£æ¡ˆ</span>
        user_profile = self._get_user_profile(member_id)
        
        <span class="hljs-comment"># è·å–ç”¨æˆ·çš„æ¶ˆè´¹å‘é‡ (embedding)</span>
        <span class="hljs-comment"># é€šè¿‡èšç±»ç”¨æˆ·çš„èœå“åå¥½</span>
        user_vector = self._get_user_embedding(member_id)
        
        <span class="hljs-comment"># è®¡ç®—èœå“å‘é‡</span>
        all_menus = self._get_all_menus()
        
        <span class="hljs-comment"># è®¡ç®—ç”¨æˆ·-èœå“ç›¸ä¼¼åº¦</span>
        recommendations = []
        <span class="hljs-keyword">for</span> menu <span class="hljs-keyword">in</span> all_menus:
            menu_vector = self._get_menu_embedding(menu[<span class="hljs-string">'id'</span>])
            similarity = self._cosine_similarity(user_vector, menu_vector)
            
            <span class="hljs-comment"># è€ƒè™‘ä¸Šä¸‹æ–‡å› ç´ </span>
            <span class="hljs-keyword">if</span> context:
                time_of_day = context.get(<span class="hljs-string">'time_of_day'</span>)
                day_type = context.get(<span class="hljs-string">'day_type'</span>)  <span class="hljs-comment"># å·¥ä½œæ—¥/å‘¨æœ«</span>
                
                <span class="hljs-comment"># è°ƒæ•´ç›¸ä¼¼åº¦ (æ—¶é—´å’Œèœå“æ­é…)</span>
                <span class="hljs-keyword">if</span> time_of_day == <span class="hljs-string">'lunch'</span> <span class="hljs-keyword">and</span> menu[<span class="hljs-string">'category'</span>] == <span class="hljs-string">'é¥­èœ'</span>:
                    similarity *= <span class="hljs-number">1.3</span>
                <span class="hljs-keyword">elif</span> time_of_day == <span class="hljs-string">'breakfast'</span> <span class="hljs-keyword">and</span> menu[<span class="hljs-string">'category'</span>] == <span class="hljs-string">'ç²¥'</span>:
                    similarity *= <span class="hljs-number">1.2</span>
            
            <span class="hljs-comment"># è¿‡æ»¤ç”¨æˆ·å·²æ¶ˆè´¹è¿‡å¤šæ¬¡çš„èœå“</span>
            <span class="hljs-keyword">if</span> menu[<span class="hljs-string">'id'</span>] <span class="hljs-keyword">in</span> user_profile[<span class="hljs-string">'consumed_items'</span>]:
                <span class="hljs-keyword">if</span> user_profile[<span class="hljs-string">'consumed_items'</span>][menu[<span class="hljs-string">'id'</span>]] &gt; <span class="hljs-number">10</span>:
                    similarity *= <span class="hljs-number">0.7</span>  <span class="hljs-comment"># é™ä½ç›¸ä¼¼åº¦</span>
            
            recommendations.append({
                <span class="hljs-string">'menu_id'</span>: menu[<span class="hljs-string">'id'</span>],
                <span class="hljs-string">'menu_name'</span>: menu[<span class="hljs-string">'name'</span>],
                <span class="hljs-string">'similarity_score'</span>: similarity,
                <span class="hljs-string">'reason'</span>: self._generate_explanation(member_id, menu[<span class="hljs-string">'id'</span>], similarity)
            })
        
        <span class="hljs-comment"># è¿”å›top 10</span>
        recommendations = <span class="hljs-built_in">sorted</span>(recommendations, key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'similarity_score'</span>], reverse=<span class="hljs-literal">True</span>)
        <span class="hljs-keyword">return</span> recommendations[:<span class="hljs-number">10</span>]
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_generate_explanation</span>(<span class="hljs-params">self, member_id, menu_id, similarity</span>):
        <span class="hljs-string">"""ç”Ÿæˆæ¨èç†ç”± (å¯è§£é‡Šæ€§)"""</span>
        user_profile = self._get_user_profile(member_id)
        menu = self._get_menu(menu_id)
        
        <span class="hljs-comment"># ç®€å•çš„å› æœè§£é‡Š</span>
        <span class="hljs-keyword">if</span> menu[<span class="hljs-string">'category'</span>] <span class="hljs-keyword">in</span> user_profile[<span class="hljs-string">'favorite_categories'</span>]:
            <span class="hljs-keyword">return</span> <span class="hljs-string">f"åŸºäºæ‚¨çš„<span class="hljs-subst">{menu[<span class="hljs-string">'category'</span>]}</span>åå¥½"</span>
        <span class="hljs-keyword">elif</span> menu[<span class="hljs-string">'price'</span>] <span class="hljs-keyword">in</span> user_profile[<span class="hljs-string">'price_range'</span>]:
            <span class="hljs-keyword">return</span> <span class="hljs-string">f"ä»·æ ¼åœ¨æ‚¨åå¥½çš„èŒƒå›´å†…"</span>
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">"æ–°èœæ¨è"</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_cosine_similarity</span>(<span class="hljs-params">self, vec1, vec2</span>):
        <span class="hljs-string">"""è®¡ç®—å‘é‡ä½™å¼¦ç›¸ä¼¼åº¦"""</span>
        <span class="hljs-keyword">from</span> numpy <span class="hljs-keyword">import</span> dot
        <span class="hljs-keyword">from</span> numpy.linalg <span class="hljs-keyword">import</span> norm
        <span class="hljs-keyword">return</span> dot(vec1, vec2) / (norm(vec1) * norm(vec2))
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_get_user_embedding</span>(<span class="hljs-params">self, member_id</span>):
        <span class="hljs-string">"""è·å–ç”¨æˆ·embeddingå‘é‡"""</span>
        <span class="hljs-comment"># åŸºäºç”¨æˆ·æ¶ˆè´¹å†å²ã€åå¥½ã€äººå£ç»Ÿè®¡ä¿¡æ¯</span>
        <span class="hljs-comment"># ä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹æˆ–è‡ªè®­ç»ƒembedding</span>
        <span class="hljs-keyword">pass</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_get_menu_embedding</span>(<span class="hljs-params">self, menu_id</span>):
        <span class="hljs-string">"""è·å–èœå“embeddingå‘é‡"""</span>
        <span class="hljs-comment"># åŸºäºèœå“ç‰¹å¾ã€æˆåˆ†ã€ä»·æ ¼ã€é”€å”®ç­‰</span>
        <span class="hljs-keyword">pass</span>
</code></pre>
<h3 data-id="heading-19">6.2 åŠ¨æ€å®šä»·ç³»ç»Ÿ</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># dynamic_pricing.py - AIåŠ¨æ€å®šä»·</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">DynamicPricingEngine</span>:
    <span class="hljs-string">"""åŸºäºéœ€æ±‚ã€åº“å­˜ã€ç«äº‰çš„åŠ¨æ€å®šä»·å¼•æ“"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">calculate_optimal_price</span>(<span class="hljs-params">self, menu_id, shop_id</span>):
        <span class="hljs-string">"""è®¡ç®—æœ€ä¼˜ä»·æ ¼"""</span>
        
        <span class="hljs-comment"># è·å–èœå“ä¿¡æ¯</span>
        menu = self._get_menu(menu_id)
        base_price = menu[<span class="hljs-string">'base_price'</span>]
        cost = menu[<span class="hljs-string">'cost'</span>]
        
        <span class="hljs-comment"># è·å–éœ€æ±‚ä¿¡æ¯</span>
        demand_forecast = self._get_demand_forecast(menu_id, shop_id)
        current_stock = self._get_current_stock(menu_id, shop_id)
        
        <span class="hljs-comment"># ç«äº‰ä¿¡æ¯</span>
        competitor_price = self._get_competitor_price(menu_id)
        
        <span class="hljs-comment"># æ—¶é—´å› ç´ </span>
        hour = datetime.now().hour
        day_type = <span class="hljs-string">'weekend'</span> <span class="hljs-keyword">if</span> datetime.now().weekday() &gt;= <span class="hljs-number">5</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'weekday'</span>
        
        <span class="hljs-comment"># ä»·æ ¼å¼¹æ€§ç³»æ•°</span>
        price_elasticity = self._estimate_price_elasticity(menu_id)
        
        <span class="hljs-comment"># è®¡ç®—æœ€ä¼˜ä»·æ ¼</span>
        <span class="hljs-comment"># ç›®æ ‡: æœ€å¤§åŒ– (ä»·æ ¼ - æˆæœ¬) Ã— é”€é‡</span>
        <span class="hljs-comment"># åŒæ—¶: æ¸…ç†ç§¯å‹åº“å­˜, åº”å¯¹ç«äº‰</span>
        
        optimal_price = base_price
        
        <span class="hljs-comment"># è°ƒæ•´å› ç´ 1: åº“å­˜å‹åŠ›</span>
        <span class="hljs-keyword">if</span> current_stock &gt; demand_forecast[<span class="hljs-string">'avg_daily'</span>] * <span class="hljs-number">3</span>:
            <span class="hljs-comment"># åº“å­˜è¿‡å¤šâ†’é™ä»·åˆºæ¿€é”€å”®</span>
            optimal_price *= <span class="hljs-number">0.85</span>
        <span class="hljs-keyword">elif</span> current_stock &lt; demand_forecast[<span class="hljs-string">'avg_daily'</span>] * <span class="hljs-number">0.5</span>:
            <span class="hljs-comment"># åº“å­˜ä¸è¶³â†’æä»·è·å–æ›´é«˜åˆ©æ¶¦</span>
            optimal_price *= <span class="hljs-number">1.10</span>
        
        <span class="hljs-comment"># è°ƒæ•´å› ç´ 2: éœ€æ±‚é¢„æµ‹</span>
        predicted_demand_ratio = demand_forecast[<span class="hljs-string">'predicted'</span>] / demand_forecast[<span class="hljs-string">'avg_daily'</span>]
        <span class="hljs-keyword">if</span> predicted_demand_ratio &gt; <span class="hljs-number">1.3</span>:
            <span class="hljs-comment"># éœ€æ±‚é«˜â†’æä»·</span>
            optimal_price *= <span class="hljs-number">1.08</span>
        <span class="hljs-keyword">elif</span> predicted_demand_ratio &lt; <span class="hljs-number">0.7</span>:
            <span class="hljs-comment"># éœ€æ±‚ä½â†’é™ä»·</span>
            optimal_price *= <span class="hljs-number">0.92</span>
        
        <span class="hljs-comment"># è°ƒæ•´å› ç´ 3: ç«äº‰</span>
        <span class="hljs-keyword">if</span> competitor_price <span class="hljs-keyword">and</span> competitor_price &lt; base_price:
            <span class="hljs-comment"># ç«äº‰å¯¹æ‰‹ä»·æ ¼æ›´ä½â†’é€‚å½“é™ä»·ä½†ä¸è¿‡ä½</span>
            optimal_price = <span class="hljs-built_in">min</span>(optimal_price, competitor_price * <span class="hljs-number">0.98</span>)
        
        <span class="hljs-comment"># è°ƒæ•´å› ç´ 4: æ—¶é—´</span>
        <span class="hljs-keyword">if</span> hour <span class="hljs-keyword">in</span> [<span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>]:  <span class="hljs-comment"># é«˜å³°æ—¶æ®µ</span>
            optimal_price *= <span class="hljs-number">1.05</span>
        <span class="hljs-keyword">elif</span> hour <span class="hljs-keyword">in</span> [<span class="hljs-number">14</span>, <span class="hljs-number">15</span>, <span class="hljs-number">16</span>]:  <span class="hljs-comment"># ä½è¿·æ—¶æ®µ</span>
            optimal_price *= <span class="hljs-number">0.95</span>
        
        <span class="hljs-comment"># ç¡®ä¿ä»·æ ¼åˆç† (ä¸ä½äºæˆæœ¬çš„110%)</span>
        optimal_price = <span class="hljs-built_in">max</span>(optimal_price, cost * <span class="hljs-number">1.1</span>)
        
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'menu_id'</span>: menu_id,
            <span class="hljs-string">'menu_name'</span>: menu[<span class="hljs-string">'name'</span>],
            <span class="hljs-string">'base_price'</span>: base_price,
            <span class="hljs-string">'optimal_price'</span>: <span class="hljs-built_in">round</span>(optimal_price, <span class="hljs-number">2</span>),
            <span class="hljs-string">'price_change_pct'</span>: <span class="hljs-built_in">round</span>((optimal_price - base_price) / base_price * <span class="hljs-number">100</span>, <span class="hljs-number">2</span>),
            <span class="hljs-string">'expected_impact'</span>: self._forecast_price_impact(menu_id, optimal_price),
            <span class="hljs-string">'valid_until'</span>: datetime.now() + timedelta(hours=<span class="hljs-number">2</span>),  <span class="hljs-comment"># 2å°æ—¶åé‡æ–°è®¡ç®—</span>
            <span class="hljs-string">'confidence'</span>: <span class="hljs-number">0.75</span>
        }
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_estimate_price_elasticity</span>(<span class="hljs-params">self, menu_id</span>):
        <span class="hljs-string">"""ä¼°ç®—ä»·æ ¼éœ€æ±‚å¼¹æ€§"""</span>
        <span class="hljs-comment"># åŸºäºå†å²æ•°æ®åˆ†æ: ä»·æ ¼å˜åŒ–å¯¹é”€é‡çš„å½±å“</span>
        <span class="hljs-comment"># é«˜å¼¹æ€§èœå“ (-1.5): ä»·æ ¼æ•æ„Ÿå‹</span>
        <span class="hljs-comment"># ä½å¼¹æ€§èœå“ (-0.3): å¿…éœ€èœå“</span>
        <span class="hljs-keyword">pass</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_forecast_price_impact</span>(<span class="hljs-params">self, menu_id, new_price</span>):
        <span class="hljs-string">"""é¢„æµ‹ä»·æ ¼å˜åŒ–çš„å½±å“"""</span>
        elasticity = self._estimate_price_elasticity(menu_id)
        base_demand = self._get_base_demand(menu_id)
        
        <span class="hljs-comment"># éœ€æ±‚å˜åŒ– = éœ€æ±‚é‡ Ã— ä»·æ ¼å¼¹æ€§ Ã— ä»·æ ¼å˜åŒ–%</span>
        demand_change = elasticity * (new_price - self._get_current_price(menu_id)) / self._get_current_price(menu_id)
        
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'expected_sales_change_pct'</span>: <span class="hljs-built_in">round</span>(demand_change * <span class="hljs-number">100</span>, <span class="hljs-number">2</span>),
            <span class="hljs-string">'expected_revenue_change_pct'</span>: <span class="hljs-built_in">round</span>(
                ((<span class="hljs-number">1</span> + demand_change) * new_price / self._get_current_price(menu_id) - <span class="hljs-number">1</span>) * <span class="hljs-number">100</span>, <span class="hljs-number">2</span>
            ),
            <span class="hljs-string">'message'</span>: <span class="hljs-string">'é”€é‡ä¼šæœ‰æ‰€ä¸‹é™ï¼Œä½†æ€»æ”¶ç›Šä¸Šå‡'</span> <span class="hljs-keyword">if</span> demand_change &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'é”€é‡ä¼šå¢åŠ '</span>
        }
</code></pre>
<h3 data-id="heading-20">6.3 æ™ºèƒ½è®¢è´§ç³»ç»Ÿ</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># smart_ordering.py - AIæ™ºèƒ½è®¢è´§</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">SmartOrderingSystem</span>:
    <span class="hljs-string">"""åŸºäºé¢„æµ‹å’Œä¼˜åŒ–çš„æ™ºèƒ½è®¢è´§ç³»ç»Ÿ"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_purchasing_order</span>(<span class="hljs-params">self, shop_id, lead_time_days=<span class="hljs-number">2</span></span>):
        <span class="hljs-string">"""ç”Ÿæˆé‡‡è´­è®¢å•å»ºè®®"""</span>
        
        orders = []
        
        <span class="hljs-comment"># è·å–æ‰€æœ‰é£Ÿæ</span>
        all_ingredients = self._get_all_ingredients()
        
        <span class="hljs-keyword">for</span> ingredient <span class="hljs-keyword">in</span> all_ingredients:
            <span class="hljs-comment"># è·å–éœ€æ±‚é¢„æµ‹</span>
            demand = self._forecast_ingredient_demand(
                ingredient[<span class="hljs-string">'id'</span>],
                shop_id,
                days=lead_time_days + <span class="hljs-number">7</span>  <span class="hljs-comment"># è¦†ç›–lead time + ä¸€å‘¨åº“å­˜</span>
            )
            
            <span class="hljs-comment"># è·å–å½“å‰åº“å­˜</span>
            current_stock = self._get_current_stock(ingredient[<span class="hljs-string">'id'</span>], shop_id)
            
            <span class="hljs-comment"># è®¡ç®—æœ€ä¼˜è®¢è´­é‡</span>
            order_qty = <span class="hljs-built_in">max</span>(
                <span class="hljs-number">0</span>,
                demand[<span class="hljs-string">'7day_total'</span>] * <span class="hljs-number">1.1</span> - current_stock  <span class="hljs-comment"># éœ€æ±‚ - å½“å‰åº“å­˜</span>
            )
            
            <span class="hljs-comment"># è€ƒè™‘MOQ (æœ€å°è®¢è´­é‡) å’Œæ‰“åŒ…è§„æ ¼</span>
            <span class="hljs-keyword">if</span> order_qty &gt; <span class="hljs-number">0</span>:
                order_qty = self._apply_moq_constraint(order_qty, ingredient[<span class="hljs-string">'moq'</span>])
            
            <span class="hljs-comment"># æˆæœ¬è®¡ç®—</span>
            unit_price = self._get_supplier_unit_price(ingredient[<span class="hljs-string">'id'</span>])
            total_cost = order_qty * unit_price
            
            <span class="hljs-comment"># æ™ºèƒ½é€‰æ‹©ä¾›åº”å•† (åŸºäºä»·æ ¼ã€äº¤æœŸã€è´¨é‡)</span>
            suppliers = self._get_qualified_suppliers(ingredient[<span class="hljs-string">'id'</span>])
            best_supplier = self._select_best_supplier(suppliers, order_qty, lead_time_days)
            
            <span class="hljs-keyword">if</span> order_qty &gt; <span class="hljs-number">0</span>:
                orders.append({
                    <span class="hljs-string">'ingredient_id'</span>: ingredient[<span class="hljs-string">'id'</span>],
                    <span class="hljs-string">'ingredient_name'</span>: ingredient[<span class="hljs-string">'name'</span>],
                    <span class="hljs-string">'order_qty'</span>: <span class="hljs-built_in">round</span>(order_qty, <span class="hljs-number">2</span>),
                    <span class="hljs-string">'unit'</span>: ingredient[<span class="hljs-string">'unit'</span>],
                    <span class="hljs-string">'unit_price'</span>: unit_price,
                    <span class="hljs-string">'total_cost'</span>: <span class="hljs-built_in">round</span>(total_cost, <span class="hljs-number">2</span>),
                    <span class="hljs-string">'supplier_id'</span>: best_supplier[<span class="hljs-string">'id'</span>],
                    <span class="hljs-string">'supplier_name'</span>: best_supplier[<span class="hljs-string">'name'</span>],
                    <span class="hljs-string">'expected_delivery'</span>: datetime.now() + timedelta(days=lead_time_days),
                    <span class="hljs-string">'reason'</span>: self._explain_order(ingredient, demand, current_stock)
                })
        
        <span class="hljs-comment"># æŒ‰ä¾›åº”å•†åˆ†ç»„ç”Ÿæˆé‡‡è´­å•</span>
        purchase_orders_by_supplier = {}
        <span class="hljs-keyword">for</span> order <span class="hljs-keyword">in</span> orders:
            supplier_id = order[<span class="hljs-string">'supplier_id'</span>]
            <span class="hljs-keyword">if</span> supplier_id <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> purchase_orders_by_supplier:
                purchase_orders_by_supplier[supplier_id] = []
            purchase_orders_by_supplier[supplier_id].append(order)
        
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'shop_id'</span>: shop_id,
            <span class="hljs-string">'generated_time'</span>: datetime.now(),
            <span class="hljs-string">'total_items'</span>: <span class="hljs-built_in">len</span>(orders),
            <span class="hljs-string">'total_cost'</span>: <span class="hljs-built_in">round</span>(<span class="hljs-built_in">sum</span>(o[<span class="hljs-string">'total_cost'</span>] <span class="hljs-keyword">for</span> o <span class="hljs-keyword">in</span> orders), <span class="hljs-number">2</span>),
            <span class="hljs-string">'orders_by_supplier'</span>: purchase_orders_by_supplier,
            <span class="hljs-string">'approval_status'</span>: <span class="hljs-string">'pending'</span>
        }
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_forecast_ingredient_demand</span>(<span class="hljs-params">self, ingredient_id, shop_id, days</span>):
        <span class="hljs-string">"""é¢„æµ‹é£Ÿæéœ€æ±‚"""</span>
        <span class="hljs-comment"># åŸºäºèœå“é”€å”®é¢„æµ‹ Ã— èœå“é…æ–¹</span>
        <span class="hljs-keyword">pass</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_apply_moq_constraint</span>(<span class="hljs-params">self, qty, moq</span>):
        <span class="hljs-string">"""åº”ç”¨æœ€å°è®¢è´­é‡çº¦æŸ"""</span>
        <span class="hljs-keyword">import</span> math
        <span class="hljs-keyword">return</span> math.ceil(qty / moq) * moq
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_select_best_supplier</span>(<span class="hljs-params">self, suppliers, qty, lead_time</span>):
        <span class="hljs-string">"""é€‰æ‹©æœ€ä¼˜ä¾›åº”å•†"""</span>
        <span class="hljs-comment"># ç»¼åˆè€ƒè™‘: ä»·æ ¼ã€è´¨é‡è¯„åˆ†ã€äº¤æœŸã€æœ€å°è®¢è´­é‡</span>
        scored_suppliers = []
        <span class="hljs-keyword">for</span> supplier <span class="hljs-keyword">in</span> suppliers:
            score = <span class="hljs-number">0</span>
            score += (<span class="hljs-number">1</span> - supplier[<span class="hljs-string">'unit_price'</span>] / <span class="hljs-built_in">max</span>(s[<span class="hljs-string">'unit_price'</span>] <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> suppliers)) * <span class="hljs-number">40</span>  <span class="hljs-comment"># ä»·æ ¼æƒé‡40%</span>
            score += supplier[<span class="hljs-string">'quality_score'</span>] / <span class="hljs-number">5</span> * <span class="hljs-number">30</span>  <span class="hljs-comment"># è´¨é‡æƒé‡30%</span>
            score += (<span class="hljs-number">1</span> - supplier[<span class="hljs-string">'lead_time'</span>] / lead_time) * <span class="hljs-number">20</span> <span class="hljs-keyword">if</span> supplier[<span class="hljs-string">'lead_time'</span>] &lt;= lead_time <span class="hljs-keyword">else</span> <span class="hljs-number">0</span>  <span class="hljs-comment"># äº¤æœŸæƒé‡20%</span>
            score += <span class="hljs-number">10</span> <span class="hljs-keyword">if</span> qty &gt;= supplier[<span class="hljs-string">'moq'</span>] <span class="hljs-keyword">else</span> -<span class="hljs-number">10</span>  <span class="hljs-comment"># MOQæ£€æŸ¥</span>
            
            scored_suppliers.append({**supplier, <span class="hljs-string">'overall_score'</span>: score})
        
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">max</span>(scored_suppliers, key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'overall_score'</span>])
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_explain_order</span>(<span class="hljs-params">self, ingredient, demand, current_stock</span>):
        <span class="hljs-string">"""ç”Ÿæˆè®¢å•è¯´æ˜"""</span>
        days_to_runout = current_stock / (demand[<span class="hljs-string">'7day_total'</span>] / <span class="hljs-number">7</span>) <span class="hljs-keyword">if</span> demand[<span class="hljs-string">'7day_total'</span>] &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-built_in">float</span>(<span class="hljs-string">'inf'</span>)
        
        <span class="hljs-keyword">if</span> days_to_runout &lt; <span class="hljs-number">2</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">'åº“å­˜ç´§å¼ ï¼Œéœ€ç«‹å³è¡¥è´§'</span>
        <span class="hljs-keyword">elif</span> days_to_runout &lt; <span class="hljs-number">5</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">'åº“å­˜åä½ï¼Œå»ºè®®å°½å¿«è¡¥è´§'</span>
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">'åº“å­˜æ­£å¸¸ï¼Œå®šæœŸè¡¥è´§'</span>
</code></pre>
<hr/>
<h2 data-id="heading-21">å®ç°è·¯çº¿å›¾ä¸æˆæ•ˆé¢„æœŸ</h2>
<h3 data-id="heading-22">7.1 12ä¸ªæœˆå®ç°è·¯çº¿</h3>



































<table><thead><tr><th>é˜¶æ®µ</th><th>æ—¶é—´</th><th>äº¤ä»˜ç‰©</th><th>å…³é”®KPI</th></tr></thead><tbody><tr><td><strong>M1-M3</strong></td><td>æœˆ1-3</td><td>BIå·¥å…·+5ä¸ªæ ¸å¿ƒæŠ¥è¡¨</td><td>æŠ¥è¡¨æ•°80+, æ—¥æ´»ç”¨æˆ·200+</td></tr><tr><td><strong>M4-M6</strong></td><td>æœˆ4-6</td><td>é—¨åº—é©¾é©¶èˆ±+åº“å­˜çœ‹æ¿</td><td>é©¾é©¶èˆ±è®¿é—®é‡500+/å¤©, åº“å­˜é¢„è­¦å‡†ç¡®ç‡90%</td></tr><tr><td><strong>M7-M9</strong></td><td>æœˆ7-9</td><td>æ™ºèƒ½æ¨èAPI+åŠ¨æ€å®šä»·</td><td>ä¸ªæ€§åŒ–æ¨èä½¿ç”¨ç‡60%, å®šä»·ä¼˜åŒ–â†‘8%æ”¶ç›Š</td></tr><tr><td><strong>M10-M12</strong></td><td>æœˆ10-12</td><td>AIè®¢è´§+å…¨é“¾è·¯ä¼˜åŒ–</td><td>è®¢è´§è‡ªåŠ¨åŒ–80%, åº“å­˜â†“18%</td></tr></tbody></table>
<h3 data-id="heading-23">7.2 é¢„æœŸæˆæ•ˆ</h3>
<pre><code class="hljs language-erlang" lang="erlang">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          æ•°æ®äº§å“åˆ›æ–°çš„æˆæ•ˆé¢„æœŸ (<span class="hljs-number">12</span>ä¸ªæœˆ)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚ ğŸ“Š æ•°æ®åº”ç”¨è¦†ç›–                                      â”‚
â”‚ â”œâ”€ æ—¥æ´»ä¸šåŠ¡ç”¨æˆ·: <span class="hljs-number">200</span>+ â†’ <span class="hljs-number">1000</span>+ (<span class="hljs-number">5</span>å€å¢é•¿)            â”‚
â”‚ â”œâ”€ æ—¥æŸ¥è¯¢æ•°: <span class="hljs-number">5000</span>+ â†’ <span class="hljs-number">50000</span>+ (<span class="hljs-number">10</span>å€å¢é•¿)             â”‚
â”‚ â”œâ”€ è‡ªåŠ©åˆ†æå æ¯”: <span class="hljs-number">30</span><span class="hljs-comment">% â†’ 70%                         â”‚</span>
â”‚ â””â”€ æ•°æ®é©±åŠ¨å†³ç­–å æ¯”: <span class="hljs-number">40</span><span class="hljs-comment">% â†’ 85%                     â”‚</span>
â”‚                                                      â”‚
â”‚ ğŸ’° ä¸šåŠ¡ä»·å€¼æå‡                                      â”‚
â”‚ â”œâ”€ äººæ•ˆæå‡: ç­æ¬¡ä¼˜åŒ–â†’â†‘<span class="hljs-number">12</span><span class="hljs-comment">%                         â”‚</span>
â”‚ â”œâ”€ å®¢å•ä»·: ä¸ªæ€§åŒ–æ¨èâ†’â†‘<span class="hljs-number">8</span><span class="hljs-comment">%                          â”‚</span>
â”‚ â”œâ”€ åº“å­˜æˆæœ¬: æ™ºèƒ½è®¢è´§â†’â†“<span class="hljs-number">18</span><span class="hljs-comment">%                         â”‚</span>
â”‚ â”œâ”€ è¥é”€ROI: ç²¾å‡†è¥é”€â†’â†‘<span class="hljs-number">25</span><span class="hljs-comment">%                          â”‚</span>
â”‚ â”œâ”€ æ–°åº—æˆåŠŸç‡: ç§‘å­¦é€‰å€â†’â†‘<span class="hljs-number">35</span><span class="hljs-comment">%                       â”‚</span>
â”‚ â””â”€ åˆè®¡æ”¶ç›Š: <span class="hljs-number">3000</span>-<span class="hljs-number">5000</span>ä¸‡/å¹´                        â”‚
â”‚                                                      â”‚
â”‚ ğŸš€ æ•°æ®èƒ½åŠ›å»ºè®¾                                      â”‚
â”‚ â”œâ”€ æ•°æ®æŠ€èƒ½è¦†ç›–: <span class="hljs-number">60</span><span class="hljs-comment">% â†’ 90% (å‘˜å·¥)                  â”‚</span>
â”‚ â”œâ”€ æ•°æ®äº§å“æ•°: <span class="hljs-number">6</span> â†’ <span class="hljs-number">30</span>+                             â”‚
â”‚ â”œâ”€ è‡ªåŠ¨åŒ–å†³ç­–: <span class="hljs-number">10</span><span class="hljs-comment">% â†’ 60%                          â”‚</span>
â”‚ â””â”€ æœºåˆ¶åŒ–åˆ›æ–°: è¯•é”™-éªŒè¯-æ¨å¹¿çš„é—­ç¯å»ºç«‹            â”‚
â”‚                                                      â”‚
â”‚ ğŸ¯ ç«äº‰åŠ›æå‡                                        â”‚
â”‚ â”œâ”€ å†³ç­–æ•ˆç‡: æœˆåº¦â†’æ—¥/å‘¨                            â”‚
â”‚ â”œâ”€ ç²¾ç»†åŒ–ç¨‹åº¦: åº—çº§â†’é—¨åº—/ç­æ¬¡/èœå“                 â”‚
â”‚ â”œâ”€ å®æ—¶æ€§: T+<span class="hljs-number">1</span> â†’ å®æ—¶                              â”‚
â”‚ â””â”€ é¢„æµ‹èƒ½åŠ›: è¢«åŠ¨åº”å¯¹â†’ä¸»åŠ¨ä¼˜åŒ–                     â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr/>
<h2 data-id="heading-24">æ€»ç»“</h2>
<p>æœ¬æ–‡æ¡£è¯¦ç»†é˜è¿°äº†é¤é¥®è¿é”ä¼ä¸šå¦‚ä½•é€šè¿‡<strong>BIç³»ç»Ÿã€é©¾é©¶èˆ±ã€æ™ºèƒ½å¼•æ“ã€AIåº”ç”¨</strong>å››å¤§äº§å“çº¿ï¼Œå°†æ•°æ®ä»“åº“çš„æ•°æ®è½¬åŒ–ä¸ºçœŸæ­£çš„ä¸šåŠ¡ä»·å€¼ã€‚</p>
<p><strong>æ ¸å¿ƒæ€è·¯</strong>:</p>
<ol>
<li><strong>L1-ä¿¡æ¯</strong> (æŠ¥è¡¨) â†’ äº†è§£è¿‡å»</li>
<li><strong>L2-æ´å¯Ÿ</strong> (é©¾é©¶èˆ±) â†’ æŒæ¡å½“ä¸‹</li>
<li><strong>L3-é¢„æµ‹</strong> (æ¨¡å‹) â†’ é¢„è§æœªæ¥</li>
<li><strong>L4-å†³ç­–</strong> (è‡ªåŠ¨åŒ–) â†’ è‡ªä¸»ä¼˜åŒ–</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä» 0 åˆ° 1 ç©è½¬ N8Nâ€”â€”åˆè¯† N8Nï¼ˆå…¥é—¨å¿…çœ‹ï¼‰]]></title>    <link>https://juejin.cn/post/7580373352421556250</link>    <guid>https://juejin.cn/post/7580373352421556250</guid>    <pubDate>2025-12-07T11:12:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580373352421556250" data-draft-id="7581004702927011849" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä» 0 åˆ° 1 ç©è½¬ N8Nâ€”â€”åˆè¯† N8Nï¼ˆå…¥é—¨å¿…çœ‹ï¼‰"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-07T11:12:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LucianaiB"/> <meta itemprop="url" content="https://juejin.cn/user/1269294586664749"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä» 0 åˆ° 1 ç©è½¬ N8Nâ€”â€”åˆè¯† N8Nï¼ˆå…¥é—¨å¿…çœ‹ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1269294586664749/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LucianaiB
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T11:12:14.000Z" title="Sun Dec 07 2025 11:12:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d6560e85741a44e8a3fc2d7b2a6d66fb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765710734&amp;x-signature=uhZPGlGogafp8u8NURncQ5CxtzM%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-0">ä»€ä¹ˆæ˜¯n8nï¼Ÿ</h2>
<p><strong>n8n æ˜¯ä¸€æ¬¾å¼€æºã€çµæ´»ä¸”é«˜åº¦å¯å®šåˆ¶çš„å·¥ä½œæµè‡ªåŠ¨åŒ–å¹³å°ï¼Œå…¶æ ¸å¿ƒç†å¿µæ˜¯é€šè¿‡å¯è§†åŒ–æ‹–æ‹½ç•Œé¢å°†ä¸åŒçš„åº”ç”¨ã€æœåŠ¡ã€APIæˆ–æ•°æ®æºè¿æ¥èµ·æ¥ï¼Œå®ç°å¤æ‚çš„è‡ªåŠ¨åŒ–ä»»åŠ¡ï¼Œè€Œæ— éœ€ç¼–å†™å¤§é‡ä»£ç </strong>ã€‚n8n çš„åå­—æºäºå¾·è¯­ â€œnur ein Ninjaâ€ï¼ˆæ„ä¸ºâ€œåªæ˜¯ä¸€ä¸ªå¿è€…â€ï¼‰ï¼Œå¯“æ„å…¶å¼ºå¤§ã€çµæ´»åˆè½»ç›ˆã€‚</p>
<h4 data-id="heading-1">æ ¸å¿ƒç‰¹æ€§</h4>
<ul>
<li>å®Œå…¨å¼€æºå…è´¹ï¼šn8n é‡‡ç”¨ MIT å¼€æºè®¸å¯ï¼Œæºä»£ç æ‰˜ç®¡äº GitHub)))ï¼Œç”¨æˆ·å¯è‡ªç”±æŸ¥çœ‹ã€ä¿®æ”¹ä¸éƒ¨ç½²ã€‚</li>
<li>å¯è§†åŒ–å·¥ä½œæµç¼–æ’ï¼šé€šè¿‡ç›´è§‚çš„æ‹–æ‹½å¼ç•Œé¢æ„å»ºå¤šæ­¥éª¤è‡ªåŠ¨åŒ–æµç¨‹ï¼Œé™ä½æŠ€æœ¯é—¨æ§›ã€‚</li>
<li>ä¸°å¯Œçš„é›†æˆç”Ÿæ€ï¼šå®˜æ–¹æ”¯æŒ 1700+ é¢„è®¾æ¨¡æ¿ å’Œ æ•°ç™¾ä¸ªåŸç”ŸèŠ‚ç‚¹ï¼ˆå¦‚ Slackã€Google Sheetsã€Notionã€Webhook ç­‰ï¼‰ï¼ŒåŒæ—¶æ”¯æŒè‡ªå®šä¹‰èŠ‚ç‚¹å¼€å‘ã€‚</li>
<li>çµæ´»çš„è§¦å‘æœºåˆ¶ï¼šæ”¯æŒå®šæ—¶ä»»åŠ¡ã€äº‹ä»¶é©±åŠ¨ã€æ‰‹åŠ¨è§¦å‘ã€Webhookã€API è°ƒç”¨ç­‰å¤šç§è§¦å‘æ–¹å¼ã€‚</li>
<li>å¼ºå¤§çš„é€»è¾‘æ§åˆ¶ï¼šæ”¯æŒæ¡ä»¶åˆ†æ”¯ï¼ˆif/elseï¼‰ã€å¾ªç¯ã€é”™è¯¯å¤„ç†ç­‰å¤æ‚é€»è¾‘ï¼Œå¯æ„å»ºä¼ä¸šçº§è‡ªåŠ¨åŒ–æµç¨‹ã€‚</li>
<li>éƒ¨ç½²æ–¹å¼çµæ´»ï¼šæ—¢å¯æœ¬åœ°éƒ¨ç½²ï¼ˆDockerã€æœ¬åœ° Node.js ç¯å¢ƒï¼‰ï¼Œä¹Ÿå¯è‡ªæ‰˜ç®¡äºç§æœ‰äº‘/å…¬æœ‰äº‘ï¼Œæˆ–ä½¿ç”¨å…¶å®˜æ–¹SaaS äº‘æœåŠ¡ï¼ˆå« 14 å¤©è¯•ç”¨ï¼‰ã€‚</li>
<li>ä»£ç ä¸æ— ä»£ç èåˆï¼šåœ¨å¯è§†åŒ–æµç¨‹ä¸­å¯éšæ—¶æ’å…¥ JavaScript æˆ– Python è„šæœ¬ï¼Œå®ç°é«˜åº¦å®šåˆ¶åŒ–é€»è¾‘ã€‚</li>
</ul>
<h4 data-id="heading-2">é€‚ç”¨åœºæ™¯</h4>
<ul>
<li>ä¸ªäººæ•ˆç‡æå‡ï¼šè‡ªåŠ¨å¤‡ä»½ç¬”è®°ã€å®šæ—¶æŠ“å–ç½‘é¡µå†…å®¹ã€é‚®ä»¶è‡ªåŠ¨åŒ–ç­‰ã€‚</li>
<li>å›¢é˜Ÿåä½œè‡ªåŠ¨åŒ–ï¼šå°† Slack æ¶ˆæ¯åŒæ­¥è‡³ Notionã€è‡ªåŠ¨åˆ›å»º Jira å·¥å•ã€å®¡æ‰¹æµæé†’ç­‰ã€‚</li>
<li>æ•°æ®é›†æˆä¸å¤„ç†ï¼šèšåˆå¤šä¸ª API æ•°æ®ã€æ¸…æ´—å¹¶å†™å…¥æ•°æ®åº“ã€ç”ŸæˆæŠ¥è¡¨ç­‰ã€‚</li>
<li>AI å·¥ä½œæµæ„å»ºï¼šé›†æˆ LLMï¼ˆå¦‚ OpenAIã€æœ¬åœ°æ¨¡å‹ï¼‰ï¼Œæ„å»ºå¤šæ­¥éª¤ AI Agentï¼Œå®ç°â€œç”¨è‡ªç„¶è¯­è¨€æ“ä½œä¸šåŠ¡ç³»ç»Ÿâ€ã€‚</li>
</ul>
<h2 data-id="heading-3">æ€ä¹ˆç”¨ n8n?</h2>
<p>é¦–å…ˆå…ˆè§£å†³ â€œæ€ä¹ˆç”¨ n8nâ€ çš„åŸºç¡€é—®é¢˜ï¼Œn8nä¸€èˆ¬æœ‰ 3 ç§éƒ¨ç½²æ–¹å¼ï¼š</p>
<ul>
<li><strong>åœ¨çº¿ä½¿ç”¨ï¼ˆ[</strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fn8n.io%2F" target="_blank" title="https://n8n.io/" ref="nofollow noopener noreferrer"><strong>https://n8n.io/</strong></a><strong>\ï¼‰æ³¨æ„çš„æ˜¯åªæœ‰14å¤©çš„è¯•ç”¨æ—¶é—´ï¼Œè¿‡æœŸäº†å¯ä»¥æ¢ä¸ªé‚®ç®±æ³¨å†Œæ–°çš„è´¦å·ã€‚</strong>](<a href="https://link.juejin.cn?target=https%3A%2F%2Fn8n.io" target="_blank" title="https://n8n.io" ref="nofollow noopener noreferrer">n8n.io</a>)</li>
<li><strong>æœ¬åœ°éƒ¨ç½²é€‚åˆæƒ³å…ˆè¯•æ‰‹çš„æ–°æ‰‹ï¼Œä¸ç”¨é¢å¤–èŠ±é’±ï¼Œç”µè„‘ä¸Šæ“ä½œå‡ æ­¥å°±èƒ½å¯åŠ¨ï¼ˆ[</strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fn8n-io%2Fn8n" target="_blank" title="https://github.com/n8n-io/n8n" ref="nofollow noopener noreferrer"><strong>https://github.com/n8n-io/n8n</strong></a><strong>ï¼‰ã€‚</strong>](<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fn8n-io" target="_blank" title="https://github.com/n8n-io" ref="nofollow noopener noreferrer">github.com/n8n-io</a>)</li>
<li><strong>äº‘æœåŠ¡å™¨**</strong>éƒ¨ç½²æ›´å®ç”¨ï¼Œéƒ¨ç½²å®Œä¹‹åä¸ç®¡ç”µè„‘å…³æ²¡å…³ï¼Œ*<strong>*å·¥ä½œæµ**</strong>éƒ½èƒ½ä¸€ç›´è‡ªåŠ¨è¿è¡Œï¼Œé€‚åˆé•¿æœŸç”¨ï¼ˆæœ¬æ–‡è¯¦ç»†æ•™ç¨‹ï¼‰ã€‚**</li>
</ul>





























<table><thead><tr><th align="left">éƒ¨ç½²æ–¹å¼</th><th align="left">é€‚ç”¨äººç¾¤</th><th align="left">ä¼˜ç‚¹</th><th align="left">ç¼ºç‚¹</th></tr></thead><tbody><tr><td align="left">å®˜æ–¹ SaaS</td><td align="left">å¿«é€Ÿä½“éªŒè€…</td><td align="left">æ— éœ€é…ç½®ï¼Œå¼€ç®±å³ç”¨</td><td align="left">ä»… 14 å¤©å…è´¹è¯•ç”¨</td></tr><tr><td align="left">æœ¬åœ°éƒ¨ç½²</td><td align="left">åˆå­¦è€…ã€å¼€å‘è€…</td><td align="left">å…è´¹ã€ä¾¿äºè°ƒè¯•</td><td align="left">ä¾èµ–æœ¬åœ°ç”µè„‘ï¼Œæ— æ³•é•¿æœŸè¿è¡Œ</td></tr><tr><td align="left">äº‘æœåŠ¡å™¨éƒ¨ç½²</td><td align="left">ä¼ä¸šç”¨æˆ·ã€é•¿æœŸä½¿ç”¨è€…</td><td align="left">7Ã—24 å°æ—¶è¿è¡Œã€é«˜å¯ç”¨</td><td align="left">éœ€æ”¯ä»˜äº‘æœåŠ¡å™¨è´¹ç”¨</td></tr></tbody></table>
<h2 data-id="heading-4"><strong>è·å– N8N æœåŠ¡å™¨</strong></h2>
<h3 data-id="heading-5"><strong>1.è·å– N8N æœåŠ¡å™¨</strong></h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fbuy.cloud.tencent.com%2Flighthouse%3FblueprintType%3DAPP_OS%26blueprintOfficialId%3Dlhbp-5utfah5i%252525C2%252525AEionId%3D1%26zone%3Dap-guangzhou-6%26bundleId%3Dbundle_rs_mc_med2_01%26loginSet%3DAUTO%26timeSpan%3D3%26from%3Dlh-console" target="_blank" title="https://buy.cloud.tencent.com/lighthouse?blueprintType=APP_OS&amp;blueprintOfficialId=lhbp-5utfah5i%2525C2%2525AEionId=1&amp;zone=ap-guangzhou-6&amp;bundleId=bundle_rs_mc_med2_01&amp;loginSet=AUTO&amp;timeSpan=3&amp;from=lh-console" ref="nofollow noopener noreferrer">buy.cloud.tencent.com/lighthouse?â€¦</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fd8b01007da8452daa1d425efb57dd33~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765710734&amp;x-signature=dW4oqY8zVuQg9eEIMfgomwwoNUk%3D" alt=" " loading="lazy"/></p>
<p>è¿™é‡Œæˆ‘è´­ä¹°äº†3ä¸ªæœˆç”¨æ¥å­¦ä¹ ã€‚æ³¨æ„ï¼š<code>è®°å¾—å–æ¶ˆè‡ªåŠ¨ç»­è´¹</code>ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65c2b88113df4b88845cdceeb0e49589~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765710734&amp;x-signature=cFtPEmByYfi9CHO%2Brkn6ztoM3tk%3D" alt=" " loading="lazy"/></p>
<h3 data-id="heading-6">2.æ‰“å¼€æœåŠ¡å™¨ç®¡ç†</h3>
<p>æ‰“å¼€ç½‘ç«™ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fconsole.cloud.tencent.com%2Flighthouse%2Finstance%2Findex%3Frid%3D1" target="_blank" title="https://console.cloud.tencent.com/lighthouse/instance/index?rid=1" ref="nofollow noopener noreferrer">console.cloud.tencent.com/lighthouse/â€¦</a>ï¼Œç‚¹å‡»ç™»å½•ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3072ca9c518f4762ae6ce6e210994127~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765710734&amp;x-signature=pgZs3UZdWDTcGaxY3iN1%2FlC%2FVIs%3D" alt=" " loading="lazy"/></p>
<p>ä¸‹è½½ç»ˆç«¯è¿æ¥ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9f74abc5728541c29de7d73b1c467eb2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765710734&amp;x-signature=VIj1Vu2rJYMjsLxBHtwV%2FwzRGxA%3D" alt=" " loading="lazy"/></p>
<p>åœ¨ä¸Šå›¾æœ‰ä¸€ä¸ªå…¬ç½‘åœ°å€ï¼Œæˆ‘ä»¬æ‰“å¼€ç½‘ç«™ï¼š<a href="https://link.juejin.cn?target=http%3A%2F%2Fyour-server-ip%3A5678" target="_blank" title="http://your-server-ip:5678" ref="nofollow noopener noreferrer">http://your-server-ip:5678</a></p>
<p>ä¾‹å¦‚æˆ‘å°±æ˜¯ï¼š<a href="https://link.juejin.cn?target=http%3A%2F%2F111.230.109.186%3A5678" target="_blank" title="http://111.230.109.186:5678" ref="nofollow noopener noreferrer">http://111.230.109.186:5678</a></p>
<p>è¾“å…¥æˆ‘ä»¬çš„ä¿¡æ¯ï¼Œç‚¹å‡»Nextï¼Œä¸‹ä¸€æ­¥ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3a255d77675445538286bd21003f5769~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765710734&amp;x-signature=t%2BR1whYG5hDkwUMvKDtKWjijDjU%3D" alt=" " loading="lazy"/></p>
<p>æˆåŠŸçš„æ‰“å¼€äº†æˆ‘ä»¬çš„n8nå·¥ä½œå¹³å°ã€‚</p>
<p>ç™»å½•åçš„ç•Œé¢ï¼Œå’Œå®˜ç½‘ç™»å½•é‚£è¾¹åŸºæœ¬ä¸€è‡´ï¼Œç”¨è¿™ç§æ–¹å¼å°±ä¸ç”¨æ‹…å¿ƒåªæœ‰14å¤©è¯•ç”¨äº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/df7b736c08564b3f84380b4509e5ca03~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765710734&amp;x-signature=kJdywdU7ygKBT3fcNB%2Bwr3CYgYI%3D" alt=" " loading="lazy"/></p>
<h3 data-id="heading-7">3.å®æˆ˜ï¼šæ­å»ºâ€œè·å–ä»Šæ—¥ä¿¡æ¯å¹¶ä¿å­˜ä¸ºæ–‡ä»¶â€å·¥ä½œæµ</h3>
<p>æœ¬æ¬¡æ¡ˆä¾‹æ­å»ºä¸€ä¸ª è·å–ä»Šæ—¥æ—¥æœŸå¹¶ä¸‹è½½æ–‡ä»¶ çš„ç®€å• å·¥ä½œæµã€‚</p>
<h4 data-id="heading-8">æ­¥éª¤ 1ï¼šåˆ›å»ºæ–°å·¥ä½œæµ</h4>
<p>é¦–å…ˆç‚¹å‡»Create Workflowåˆ›å»ºå·¥ä½œæµã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/97cf8ab36b9740bda8e04b942a517c82~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765710734&amp;x-signature=cNhu4zWDdxtCQWFIaQdyv4uQFPo%3D" alt=" " loading="lazy"/></p>
<h4 data-id="heading-9">æ­¥éª¤ 2ï¼šæ·»åŠ æ‰‹åŠ¨è§¦å‘å™¨</h4>
<p>ç‚¹å‡»å·¦ä¾§<code>+</code>ï¼Œå³ä¾§ä¼šå¼¹å‡ºæŠ½å±‰ï¼Œé€‰æ‹©ç¬¬ä¸€ä¸ªTrigger manually</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/422592700bf8455495f41fcf89fce37f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765710734&amp;x-signature=5SyQuGrSS80DNKdTIQymrKwfN2A%3D" alt=" " loading="lazy"/></p>
<p>å·¥ä½œå°å°±ä¼šå‡ºç°ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç‚¹å‡»å³ä¾§çš„åŠ å·å¯ä»¥ç»§ç»­æ·»åŠ èŠ‚ç‚¹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/10ae0fa8e0a446328bbd7cc4bddac352~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765710734&amp;x-signature=%2BRh6barXNDTdnXVytMfsbrMZibg%3D" alt=" " loading="lazy"/></p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡æœç´¢ï¼Œæˆ–è€…ä¸‹é¢çš„åˆ†ç±»é‡Œå»æ‰¾éœ€è¦çš„åŠŸèƒ½èŠ‚ç‚¹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b7622013538b4fa38a139ddd599ebeeb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765710734&amp;x-signature=VtPJcOQz1xmyWjg2yPsTfroRNNs%3D" alt=" " loading="lazy"/></p>
<h4 data-id="heading-10">æ­¥éª¤ 3ï¼šæ·»åŠ  Code èŠ‚ç‚¹ï¼ˆç”Ÿæˆå†…å®¹ï¼‰</h4>
<p>é€‰æ‹©codeèŠ‚ç‚¹ä¸ºä¾‹ï¼Œç‚¹å‡»åä¼šå‡ºç°è¿™ä¸ªå¼¹çª—ï¼Œæˆ‘ä»¬åœ¨ä»£ç æ¡†æ”¾ä¸Šè‡ªå·±æ‰€éœ€è¦çš„åŠŸèƒ½ä»£ç ï¼Œç‚¹å‡»Execute stepï¼ˆæ‰§è¡Œæ­¥éª¤ï¼‰æŒ‰é’®ï¼Œå³ä¾§outputé‚£è¾¹å°±ä¼šå‡ºç°è¾“å‡ºçš„å†…å®¹</p>
<p>è¿™é‡Œå¯ä»¥é€‰æ‹©JavaScriptæˆ–è€…Python(æµ‹è¯•ä¸­)ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c94c1389df194dd6b8b71cee22dd7282~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765710734&amp;x-signature=O%2FI%2BTFCFiHxDeexZJwb8T3uNVRg%3D" alt=" " loading="lazy"/></p>
<p>è¾“å…¥ä»£ç ï¼š</p>
<pre><code class="hljs language-Python" lang="Python"><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime

<span class="hljs-comment"># è·å–ç¬¬ä¸€ä¸ªè¾“å…¥é¡¹</span>
item = _<span class="hljs-built_in">input</span>.first()

<span class="hljs-comment"># ä» item.json ä¸­æå– randomQuote</span>
random_quote = item.json.get(<span class="hljs-string">"randomQuote"</span>, <span class="hljs-string">"ä»Šæ—¥ LucianaiB åè¨€"</span>)

<span class="hljs-comment"># æ„é€ æ—¥æœŸ</span>
today = datetime.now()
date_str = <span class="hljs-string">f"<span class="hljs-subst">{today.year}</span>å¹´<span class="hljs-subst">{today.month}</span>æœˆ<span class="hljs-subst">{today.day}</span>æ—¥"</span>

<span class="hljs-comment"># ç”Ÿæˆæ¨æ–‡å†…å®¹</span>
tweet_content = <span class="hljs-string">f"ğŸ“š æˆ‘ä¸åš N8N åº”ç”¨çš„ä¼ æ’­è€…ï¼Œè€Œæ˜¯å¸Œæœ›ä½ èƒ½çœŸæ­£çˆ±ä¸Šå®ƒã€ä¸»åŠ¨å°è¯•ï¼Œå¹¶åŠ¨æ‰‹è®¾è®¡å±äºè‡ªå·±çš„è‡ªåŠ¨åŒ–æµç¨‹ã€‚"</span>

<span class="hljs-comment"># è¿”å›æ•°æ®</span>
<span class="hljs-keyword">return</span> {
    <span class="hljs-string">"quote"</span>: random_quote,
    <span class="hljs-string">"date"</span>: date_str,
    <span class="hljs-string">"tweetContent"</span>: tweet_content
}
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a8e6ac391ca4d6ebefa8ed13fa3bc1a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765710734&amp;x-signature=eqhyfBGQW2ZAgCLDgU9tiEzJvms%3D" alt=" " loading="lazy"/></p>
<p>ç‚¹å‡»å·¦ä¸Šè§’çš„Back to canvasï¼Œå¯ä»¥è¿”å›å·¥ä½œå°ã€‚</p>
<h4 data-id="heading-11">æ­¥éª¤ 4ï¼šè½¬æ¢ä¸ºæ–‡æœ¬æ–‡ä»¶</h4>
<p>æ·»åŠ ä¸‹ä¸€ä¸ªèŠ‚ç‚¹Convert to Fileï¼ˆä¿å­˜ä¸ºæ–‡ä»¶ï¼‰ï¼Œé€‰æ‹©textæ–‡ä»¶ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2ae4d2d5f51b47c991006ddfde31a0a5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765710734&amp;x-signature=YJ4TDj1eJucKk58zcA%2BC6MQXiNM%3D" alt=" " loading="lazy"/></p>
<p>ç›´æ¥æ‹–åˆ°å·¦ä¾§çš„èŠ‚ç‚¹åˆ°å³ä¾§å°±æ˜¯è¾“å…¥ï¼ˆå¦‚æœå·¦ä¾§æ²¡æœ‰ï¼Œæ˜¯å› ä¸ºéœ€è¦ä¸Šä¸€ä¸ªèŠ‚ç‚¹è¿è¡ŒæˆåŠŸæ‰å¯ä»¥ï¼‰ï¼Œç‚¹å‡»Execute stepï¼ˆæ‰§è¡Œæ­¥éª¤ï¼‰æŒ‰é’®ï¼Œå³ä¾§outputé‚£è¾¹å°±ä¼šå‡ºç°è¾“å‡ºçš„å†…å®¹ï¼Œæˆ‘è¿™é‡Œé€‰æ‹©äº†é¢„è§ˆï¼Œå¯ä»¥çœ‹åˆ°æˆåŠŸæ˜¾ç¤ºã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f67c821a13974f74808887f0238e6ee5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765710734&amp;x-signature=QYTjADjbEONVkXD73or00RNQjVQ%3D" alt=" " loading="lazy"/></p>
<h4 data-id="heading-12">æ­¥éª¤ 5ï¼šå†™å…¥æœ¬åœ°ç£ç›˜</h4>
<p>å†æ·»åŠ ä¸€ä¸ªèŠ‚ç‚¹Write Files from Diskã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/68a3290c2cc547fc9fa6facc6f0720cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765710734&amp;x-signature=lcNwYEo4VFCPAKab%2FqtHTWGHrVE%3D" alt=" " loading="lazy"/></p>
<p>åœ¨File Path and Nameè¾“å…¥æ–‡ä»¶åç§°ï¼ˆä¾‹å¦‚ï¼šlucianaib.textï¼‰ï¼Œç‚¹å‡»Execute stepï¼ˆæ‰§è¡Œæ­¥éª¤ï¼‰æŒ‰é’®ï¼Œå³ä¾§outputé‚£è¾¹å°±ä¼šå‡ºç°è¾“å‡ºçš„å†…å®¹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a12a061ae1bb4f4a896c628a1037552f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765710734&amp;x-signature=kPsFZpFKnc%2B7rkNgwf03MrX7s%2Bs%3D" alt=" " loading="lazy"/></p>
<h4 data-id="heading-13">æ­¥éª¤ 6ï¼šä¸‹è½½æ–‡ä»¶ &amp; ä¿å­˜å·¥ä½œæµ</h4>
<p>ç‚¹å‡»å³è¾¹çš„Downloadæ–‡ä»¶å°±è¢«ä¸‹è½½ä¸‹æ¥äº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1d2df39a56b44db79c8776af3276fa04~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765710734&amp;x-signature=WS1yYd%2BkMIwUhgsDrfvvXkfi2Z4%3D" alt=" " loading="lazy"/></p>
<p>å›åˆ°ä¸»ç•Œé¢æˆ‘ä»¬ç‚¹å‡»Execute workflowï¼Œæ‰§è¡Œæ•´ä¸ªå·¥ä½œæµï¼ŒæˆåŠŸçš„å³ä¸‹è§’éƒ½ä¼šå‡ºç°ä¸€ä¸ªå‹¾çš„å›¾æ ‡</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e72ca935fb9c41f6964361cf4f4c1d32~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765710734&amp;x-signature=MCqhTepj7FTQyBhbpMebhgiB%2Fvc%3D" alt=" " loading="lazy"/></p>
<p>ä¸€åˆ‡éƒ½æ²¡é—®é¢˜åå°±å¯ä»¥ç‚¹å‡»å³ä¸Šè§’çš„<code>save</code>ä¿å­˜äº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/392b3afa4e8541bcacd107bba0c7fafe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765710734&amp;x-signature=f5IkL2UUdvQkm4L3GiLoE%2Ba211U%3D" alt=" " loading="lazy"/></p>
<p>å·¦ä¸Šè§’è¿™è¾¹å¯ä»¥æ›´æ”¹å·¥ä½œæµçš„åç§°å’Œæ·»åŠ æ ‡ç­¾ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f8bd5379080c45569b976b82edd2951c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765710734&amp;x-signature=yqzxwAeK9FvPaONefll3iD%2FyQzg%3D" alt=" " loading="lazy"/></p>
<p>å³ä¾§è¿™è¾¹å¯ä»¥å¤åˆ¶ï¼Œä¸‹è½½ï¼Œå¯¼å…¥å·¥ä½œæµç­‰æ“ä½œã€‚å¯ä»¥æ–¹ä¾¿æŠŠå·¥ä½œæµåˆ†äº«ç»™åˆ«äººæˆ–ç›´æ¥ä½¿ç”¨åˆ«äººçš„å·¥ä½œæµã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e1d9f6686e4a455eb1f463b6e6c74a8c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765710734&amp;x-signature=J5Q51N3z3bZbcBz5l7nj78Lk2GM%3D" alt=" " loading="lazy"/></p>
<blockquote>
<p>æç¤ºï¼šå·¥ä½œæµæ”¯æŒä¸€é”®å¯¼å‡º/å¯¼å…¥ï¼Œæ–¹ä¾¿åˆ†äº«æˆ–è¿ç§»ã€‚</p>
</blockquote>
<h2 data-id="heading-14">å­¦ä¹ è·¯å¾„</h2>
<p>LucianaiBå¸¦ä½ ä» 0 åˆ° 1 ç©è½¬ N8N çŸ¥è¯†åº“ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Flucianaib.feishu.cn%2Fwiki%2FYQMHwn0Bli1LFrkeHbMcdqQ6ndg%3Ffrom%3Dfrom_copylink" target="_blank" title="https://lucianaib.feishu.cn/wiki/YQMHwn0Bli1LFrkeHbMcdqQ6ndg?from=from_copylink" ref="nofollow noopener noreferrer">LucianaiBå¸¦ä½ ä» 0 åˆ° 1 ç©è½¬ N8N</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[èŠèŠå‰ç«¯å®¹æ˜“ç¿»è½¦çš„â€œç¯å¢ƒç®¡ç†â€]]></title>    <link>https://juejin.cn/post/7580547126360948799</link>    <guid>https://juejin.cn/post/7580547126360948799</guid>    <pubDate>2025-12-07T11:56:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7580547126360948799" data-draft-id="7580547126360916031" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="èŠèŠå‰ç«¯å®¹æ˜“ç¿»è½¦çš„â€œç¯å¢ƒç®¡ç†â€"/> <meta itemprop="keywords" content="å‰ç«¯,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-07T11:56:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯å¸ƒé²ä¼Š"/> <meta itemprop="url" content="https://juejin.cn/user/4431511346492554"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            èŠèŠå‰ç«¯å®¹æ˜“ç¿»è½¦çš„â€œç¯å¢ƒç®¡ç†â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4431511346492554/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯å¸ƒé²ä¼Š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-07T11:56:31.000Z" title="Sun Dec 07 2025 11:56:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{line-height:1.75;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;letter-spacing:2px;background-image:linear-gradient(90deg,rgba(50,0,0,.05) 3%,transparent 0),linear-gradient(1turn,rgba(50,0,0,.05) 3%,transparent 0);background-size:20px 20px;background-position:50%;word-break:break-word;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1{font-size:23px;margin-bottom:5px;font-weight:700;padding-left:10px;border-left:5px solid #773098}.markdown-body h2{font-size:19px;font-weight:700;padding-left:10px;border-left:5px solid #916dd5}.markdown-body h3{font-size:17px;font-weight:700;padding-left:10px;border-left:5px solid #d89cf6}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;max-width:100%;margin:1em 0;border-radius:6px;box-shadow:2px 4px 7px #999;user-select:none}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{padding:.2em .5em;font-weight:700;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-size:1em;color:#916dd5;word-break:break-word;overflow-x:auto;background-color:none;border-radius:2px}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-weight:400;font-size:.9em;padding:16px 12px;margin:0;color:#333;word-break:normal;overflow-x:auto;background:#f8f8f8;scroll-behavior:smooth}.markdown-body a{text-decoration:none;color:#916dd5;font-weight:700;border-bottom:1px solid #916dd5}.markdown-body a:active,.markdown-body a:hover{color:#773098}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;border:1px solid #916dd5;border-collapse:collapse}.markdown-body thead{background-color:#916dd5;color:#fff;text-align:left}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;border:1px solid #916dd5}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #d89cf6;background-color:#f4eeff}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0;line-height:26px}.markdown-body ol,.markdown-body ul{padding-left:28px;list-style-type:circle}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{color:#916dd5;font-weight:700}.markdown-body b:before,.markdown-body strong:before{content:"ã€Œ"}.markdown-body b:after,.markdown-body strong:after{content:"ã€"}.markdown-body em,.markdown-body i{color:#916dd5}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><p><strong>æƒ³è·å–æ›´å¤š2025å¹´æœ€æ–°å‰ç«¯åœºæ™¯é¢˜å¯ä»¥çœ‹è¿™é‡Œ</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ffe.ecool.fun%2Ftopic-list%3Fic%3DKIQC2F%26from%3Djuejin_article" target="_blank" title="https://fe.ecool.fun/topic-list?ic=KIQC2F&amp;from=juejin_article" ref="nofollow noopener noreferrer">fe.ecool.fun</a></p>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯åˆ˜å¸ƒæ–¯ã€‚</p>
<p>å‘¨æœ«åœ¨å®¶æ•´ç†ä»¥å‰çš„è€ç¡¬ç›˜ï¼Œç¿»åˆ°äº† 10 å¹´å‰åšçš„ä¸€ä¸ªå¤–åŒ…é¡¹ç›®æºç ã€‚æ‰“å¼€ä¸€çœ‹ï¼Œå…¥å£æ–‡ä»¶é‡Œèµ«ç„¶å†™ç€ä¸€è¡Œè¢«æ³¨é‡Šæ‰çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-auto" lang="auto">// var API_HOST = "http://localhost:8080";Â varÂ API_HOST =Â "http://192.168.1.100:8080";Â // åªæœ‰å†…ç½‘èƒ½è®¿é—®
</code></pre>
<p>çœ‹åˆ°è¿™è¡Œä»£ç ï¼Œé‚£ç§è¢«â€œå‘å¸ƒä¸Šçº¿åé¡µé¢ä¸€ç‰‡ç™½å±â€æ”¯é…çš„ææƒ§ç¬é—´æ”»å‡»äº†æˆ‘ã€‚</p>
<p>å…¥è¡Œåå‡ å¹´ï¼Œå‰ç«¯å·¥ç¨‹åŒ–å˜äº†å¥½å‡ è½®ï¼Œä½†â€œç¯å¢ƒç®¡ç†â€è¿™ä¸ªé—®é¢˜ï¼Œåè€Œæ˜¯å¾ˆå¤šå›¢é˜Ÿï¼ˆç”šè‡³å¤§å‚å†…éƒ¨çš„å°ç»„ï¼‰æœ€å®¹æ˜“ç¿»è½¦çš„åœ°æ–¹ã€‚ä»Šå¤©ä¸è®²ä»€ä¹ˆé«˜å¤§ä¸Šçš„å¾®å‰ç«¯æˆ– Serverlessï¼Œå•çº¯èŠèŠåœ¨ Devã€Testã€UATã€Prod è¿™ä¸€å †ç¯å¢ƒé‡Œæ‰“æ»šæ‘¸å‡ºæ¥çš„è·¯å­ã€‚</p>
<h3 data-id="heading-0">æœ€å¼€å§‹çš„â€œç¡¬ç¼–ç â€æ—¶ä»£</h3>
<p>æœ€æ—©é‚£ä¼šï¼Œæ ¹æœ¬æ²¡æœ‰Â <code>process.env</code>ã€‚</p>
<p>é‚£æ—¶å€™å‘ç‰ˆç®€ç›´æ˜¯ç„å­¦ã€‚å‘¨äº”æ™šä¸Šè¦ä¸Šçº¿ï¼Œæ•´ä¸ªæµç¨‹å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼šæˆ‘åœ¨æœ¬åœ°æŠŠ API åœ°å€æ”¹æˆçº¿ä¸Šçš„ï¼ŒCtrl+S ä¿å­˜ï¼Œç„¶åç”¨ FTP ä¼ åˆ°æœåŠ¡å™¨ã€‚</p>
<p>æœ€è¦å‘½çš„ä¸æ˜¯å¿˜äº†æ”¹åœ°å€ï¼Œè€Œæ˜¯<strong>æ”¹é”™äº†æ²¡æ”¹å›æ¥</strong>ã€‚</p>
<p>æˆ‘æœ‰æ¬¡åœ¨ç”Ÿäº§ç¯å¢ƒè°ƒè¯•ä¸€ä¸ª bugï¼Œé¡ºæ‰‹æŠŠ URL æ”¹æˆäº†æµ‹è¯•ç¯å¢ƒçš„æ¨¡æ‹Ÿæ¥å£ï¼ŒéªŒè¯å®Œè§‰å¾—æ²¡é—®é¢˜ï¼Œå°±ç›´æ¥å…³æœºä¸‹ç­â€¦â€¦ç»“æœç¬¬äºŒå¤©å®¢æœç¾¤ç‚¸äº†ï¼Œè€æ¿å½“æ—¶çœ‹æˆ‘çš„çœ¼ç¥ï¼Œæ„Ÿè§‰å·²ç»åœ¨ç¢ç£¨å¼€é™¤æˆ‘å¯¹é¡¹ç›®æœ‰æ²¡æœ‰å½±å“äº†ã€‚</p>
<p>è¿™ä¸ªé˜¶æ®µçš„ç—›è‹¦åœ¨äºï¼š<strong>ä»£ç å’Œé…ç½®ä¸åˆ†å®¶</strong>ã€‚ä»£ç é€»è¾‘æ˜¯åŒä¸€å¥—ï¼Œä½†å› ä¸ºç¯å¢ƒä¸åŒï¼Œç«Ÿç„¶éœ€è¦æ¯æ¬¡æ‰‹åŠ¨å»æ”¹æºç ã€‚è¿™æœ¬èº«å°±æ˜¯ä¸ªå·¨å¤§çš„é£é™©æºã€‚</p>
<h3 data-id="heading-1">åæ¥æœ‰äº† Webpack å’Œ DefinePlugin</h3>
<p>åæ¥æ„å»ºå·¥å…·èµ·æ¥äº†ï¼ŒWebpack ç®€ç›´æ˜¯æ•‘ä¸–ä¸»ã€‚</p>
<p>å¤§å®¶å¼€å§‹ä¹ æƒ¯ç”¨Â <code>DefinePlugin</code>ï¼Œæˆ–è€…åæ¥çš„Â <code>dotenv</code>ã€‚åœ¨æ ¹ç›®å½•ä¸‹å»ºå‡ ä¸ªæ–‡ä»¶ï¼š<code>.env.development</code>ï¼Œ<code>.env.production</code>ã€‚</p>
<pre><code class="hljs language-auto" lang="auto">// webpack.config.js
newÂ webpack.DefinePlugin({
Â Â 'process.env.API_URL':Â JSON.stringify('https://api.prod.com')
})
</code></pre>
<p>è¿™æ—¶å€™æœ€å¸¸è§çš„ä¸€ä¸ªå‘æ˜¯ï¼š<strong>ä»¥ä¸ºå†™äº†Â <code>process.env</code>Â å°±ä¸‡äº‹å¤§å‰äº†</strong>ã€‚</p>
<p>è®°å¾—æœ‰æ¬¡å¸¦æ–°äººï¼Œå°ä¼™å­æŠŠé˜¿é‡Œäº‘çš„ OSSÂ <code>AccessKeySecret</code>Â ç›´æ¥å†™åˆ°äº†Â <code>.env</code>Â æ–‡ä»¶é‡Œï¼Œå¹¶ä¸”è¿˜è¢« Webpack æ‰“åŒ…è¿›äº† bundle.jsã€‚</p>
<p>ä»–è§‰å¾—Â <code>.env</code>Â åœ¨æœåŠ¡å™¨ä¸Šï¼Œå¾ˆå®‰å…¨ã€‚ä½†ä»–å¿˜äº†å‰ç«¯ä»£ç æ˜¯è·‘åœ¨ç”¨æˆ·æµè§ˆå™¨é‡Œçš„ã€‚æˆ‘éšæ‰‹æ‰“å¼€ Chrome æ§åˆ¶å°ï¼Œåˆ‡åˆ° Network é¢æ¿ï¼Œæœä¸€ä¸‹æºç ï¼Œé‚£ä¸ª Key å°±èµ¤è£¸è£¸åœ°èººåœ¨é‚£å„¿ã€‚</p>
<p>ä»é‚£ä»¥åï¼Œæˆ‘åœ¨ Code Review é‡ŒåŠ äº†ä¸€æ¡é“å¾‹ï¼š<strong>å‡¡æ˜¯æ‰“è¿›å‰ç«¯åŒ…é‡Œçš„å˜é‡ï¼Œé»˜è®¤å°±æ˜¯å…¬å¼€çš„ã€‚</strong>Â æ¶‰åŠç§å¯†çš„é…ç½®ï¼Œä¸€å¾‹è¦åœ¨ Nginx å±‚æˆ–è€… BFF å±‚ï¼ˆNode.js ä¸­é—´ä»¶ï¼‰å¤„ç†ï¼Œç»å¯¹ä¸èƒ½è¿› Webpackã€‚</p>
<h3 data-id="heading-2">Docker æ—¶ä»£çš„â€œä¸€æ¬¡æ„å»ºï¼Œåˆ°å¤„è¿è¡Œâ€</h3>
<p>è¿™å‡ å¹´å®¹å™¨åŒ–æˆäº†æ ‡é…ï¼Œé—®é¢˜åˆå‡çº§äº†ã€‚</p>
<p>ç”¨Â <code>.env</code>Â æ–‡ä»¶æœ€å¤§çš„é—®é¢˜æ˜¯ï¼š<strong>é…ç½®æ˜¯æ„å»ºæ—¶ï¼ˆBuild-timeï¼‰æ³¨å…¥çš„ã€‚</strong></p>
<p>æµ‹è¯•é‚£è¾¹çš„è€å“¥ä¸æ­¢ä¸€æ¬¡è·Ÿæˆ‘æŠ±æ€¨ï¼šâ€œä½ ä»¬å‰ç«¯çœŸéº»çƒ¦ï¼Œæˆ‘è¿™åªæ˜¯æƒ³æŠŠæµ‹è¯•ç¯å¢ƒçš„é•œåƒæ¨åˆ°é¢„å‘ç¯å¢ƒéªŒè¯ä¸€ä¸‹ï¼Œç»“æœå› ä¸º API åœ°å€å˜äº†ï¼Œæˆ‘è¿˜å¾—é‡æ–°è·‘ä¸€éÂ <code>npm run build</code>ï¼Ÿè¿™é•œåƒè¿˜èƒ½å«ä¸å¯å˜äº¤ä»˜å—ï¼Ÿâ€</p>
<p>è¿™ç¡®å®æ˜¯ä¸ªç¡¬ä¼¤ã€‚ç†æƒ³çš„ Docker æµç¨‹æ˜¯ï¼šé•œåƒ build å‡ºæ¥åï¼Œè¿™æ˜¯ä¸€ä¸ªæ­»çš„åŒ…ã€‚æˆ‘åœ¨æµ‹è¯•ç¯å¢ƒè·‘å®ƒï¼Œå®ƒè¿æµ‹è¯•åº“ï¼›æˆ‘åœ¨ç”Ÿäº§ç¯å¢ƒè·‘å®ƒï¼Œå®ƒè¿ç”Ÿäº§åº“ã€‚<strong>é•œåƒæœ¬èº«ä¸åº”è¯¥å˜ï¼Œå˜çš„æ˜¯å¯åŠ¨å®¹å™¨æ—¶ä¼ è¿›å»çš„ç¯å¢ƒå˜é‡ã€‚</strong></p>
<p>å¦‚æœç”¨ Webpack æŠŠ API åœ°å€å†™æ­»åœ¨ JS é‡Œï¼Œè¿™é•œåƒå°±åºŸäº†ï¼Œåªèƒ½åœ¨é‚£ä¸€ä¸ªç¯å¢ƒç”¨ã€‚</p>
<h3 data-id="heading-3">ç»ˆææ–¹æ¡ˆï¼šè¿è¡Œæ—¶æ³¨å…¥</h3>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¹Ÿä¸ºäº†å°‘è¢«æµ‹è¯•å¤§ä½¬çš„æŠ±æ€¨ï¼Œæˆ‘ä»¬ç°åœ¨çš„å¾ˆå¤šé¡¹ç›®éƒ½åˆ‡åˆ°äº†<strong>è¿è¡Œæ—¶æ³¨å…¥</strong>çš„æ–¹æ¡ˆã€‚</p>
<p>åŸç†å…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯â€œå›å…‰è¿”ç…§â€åˆ°äº† jQuery æ—¶ä»£ï¼š<strong>æŠŠé…ç½®æŒ‚åœ¨ window ä¸Š</strong>ã€‚</p>
<p>æ ¸å¿ƒé€»è¾‘å°±è¿™ä¸¤æ­¥ï¼š</p>
<ol>
<li>
<p><strong>ä»£ç é‡Œä¸è¯» process.env</strong>ï¼š å‰ç«¯ä»£ç é‡Œæ‰€æœ‰éœ€è¦åŒºåˆ†ç¯å¢ƒçš„åœ°æ–¹ï¼Œå…¨éƒ¨æ”¹æˆè¯»å–Â <code>window.__APP_CONFIG__.API_URL</code>ã€‚</p>
</li>
<li>
<p><strong>HTML æ¨¡æ¿é‡Œç•™ä¸ªå‘</strong>ï¼š åœ¨Â <code>index.html</code>Â çš„Â <code>&lt;head&gt;</code>Â é‡Œï¼Œæ”¾ä¸€ä¸ªç©ºçš„ script æ ‡ç­¾ï¼Œæˆ–è€…ç‰¹æ®Šçš„å ä½ç¬¦ã€‚</p>
</li>
<li>
<p><strong>å®¹å™¨å¯åŠ¨æ—¶å¡«å‘</strong>ï¼š è¿™æ˜¯æœ€å…³é”®çš„ä¸€æ­¥ã€‚å®¹å™¨å¯åŠ¨çš„æ—¶å€™ï¼ˆæˆ–è€… Nginx å¯åŠ¨æ—¶ï¼‰ï¼Œé€šè¿‡å†™ä¸€ä¸ªç®€å•çš„ Shell è„šæœ¬ï¼Œå»è¯»å–æœºå™¨çš„ç¯å¢ƒå˜é‡ï¼Œç„¶åç”Ÿæˆä¸€ä¸ªÂ <code>config.js</code>Â æ–‡ä»¶ï¼Œå†…å®¹å°±æ˜¯ï¼š</p>
<pre><code class="hljs language-auto" lang="auto">window.__APP_CONFIG__ = {
Â Â API_URL:Â "https://api.real-prod.com",
Â Â THEME_COLOR:Â "blue"
};
</code></pre>
<p>ç„¶åæŠŠè¿™ä¸ªæ–‡ä»¶å¡è¿› Nginx çš„é™æ€èµ„æºç›®å½•é‡Œã€‚</p>
</li>
</ol>
<p>è¿™æ ·ä¸€æ¥ï¼Œå‰ç«¯æ‰“å‡ºæ¥çš„åŒ…æ˜¯å®Œå…¨å¹²å‡€çš„ï¼Œä¸å¸¦ä»»ä½•ç¯å¢ƒä¿¡æ¯ã€‚é•œåƒæ¨åˆ°å“ªé‡Œï¼Œåªè¦é‚£ä¸ªç¯å¢ƒçš„ Docker å¯åŠ¨å‚æ•°é…å¯¹äº†ï¼Œé¡µé¢å°±èƒ½æ­£å¸¸è·‘ã€‚</p>
<pre><code class="hljs language-auto" lang="auto"># docker-compose ç¤ºä¾‹
environment:
Â  - API_URL=https://api.staging.com
</code></pre>
<p>è¿™ä¸ªæ–¹æ¡ˆä¸ä»…è§£å†³äº†â€œä¸€æ¬¡æ„å»ºâ€çš„é—®é¢˜ï¼Œè¿˜æœ‰ä¸€ä¸ªéšè—çš„å¥½å¤„ï¼š<strong>å›æ»šæå¿«</strong>ã€‚</p>
<p>ä»¥å‰å‘ç‰ˆå¦‚æœé…ç½®é”™äº†ï¼Œè¦é‡æ–°æ‰“åŒ…å‘å¸ƒï¼Œèµ·ç  10 åˆ†é’Ÿã€‚ç°åœ¨åªè¦æ”¹ä¸€ä¸‹å®¹å™¨çš„ç¯å¢ƒå˜é‡é‡å¯ä¸€ä¸‹ï¼Œ30 ç§’æå®šã€‚å¯¹äºé‚£ç§é«˜å‹åŠ›çš„çº¿ä¸Šæ•…éšœä¿®å¤ï¼Œè¿™å‡ åˆ†é’Ÿå°±æ˜¯å‘½ã€‚</p>
<h3 data-id="heading-4">å‡ ä¸ªå° Tips</h3>
<p>æœ€åå†å” å¨å‡ ä¸ªç»†èŠ‚ï¼Œéƒ½æ˜¯è¸©å‘è¸©å‡ºæ¥çš„ï¼š</p>
<ul>
<li>
<p>ä¸è¦ä¿¡ä»»Â <code>.gitignore</code>ï¼šæ€»æœ‰äººä¼šæ‰‹æŠ–æŠŠÂ <code>.env.local</code>Â æäº¤ä¸Šå»ã€‚æˆ‘ä»¬åœ¨ CI/CD æµç¨‹é‡ŒåŠ äº†æ‰«æï¼Œä¸€æ—¦å‘ç°è¿™å°±æ²¡æ³• mergeã€‚</p>
</li>
<li>
<p><strong>ç‰ˆæœ¬å·è¦åœ¨æ§åˆ¶å°æ‰“å°å‡ºæ¥</strong>ï¼šæ¯æ¬¡æ‰“åŒ…ï¼Œæˆ‘ä¼šæŠŠå½“å‰çš„ git commit hash å’Œæ‰“åŒ…æ—¶é—´æ³¨å…¥åˆ°Â <code>window</code>Â å¯¹è±¡é‡Œï¼Œå¹¶åœ¨ console é‡Œæ‰“å°å‡ºæ¥ã€‚</p>
</li>
<li>
<p>ä»¥å‰æµ‹è¯•æ bugï¼Œæˆ‘é—®â€œæ˜¯æœ€æ–°ç‰ˆå—ï¼Ÿâ€ï¼Œå¯¹æ–¹è¯´â€œæ˜¯â€ã€‚ç»“æœæŸ¥åŠå¤©æ˜¯ç¼“å­˜ã€‚</p>
</li>
<li>
<p>ç°åœ¨æˆ‘è®©ä»–ä»¬æˆªå›¾æ§åˆ¶å°ï¼Œæˆ‘çœ‹ä¸€çœ¼ hash ä¹Ÿå°±çŸ¥é“æ˜¯ä¸æ˜¯æœ€æ–°ç‰ˆï¼Œçœäº†å¤ªå¤šæ‰¯çš®æ—¶é—´ã€‚</p>
</li>
<li>
<p><strong>Feature Flag ä¹Ÿå¯ä»¥ç”¨ç¯å¢ƒé…ç½®</strong>ï¼šä¸è¦å‚»å‚»åœ°ç”¨æ³¨é‡Šä»£ç çš„æ–¹å¼æ¥å¼€å…³åŠŸèƒ½ï¼Œè€Œæ˜¯ç›´æ¥æŠŠå®ƒåšæˆé…ç½®é¡¹ã€‚ä¸‡ä¸€ä¸Šçº¿åè¿™åŠŸèƒ½æœ‰ bugï¼Œæ”¹ä¸ªé…ç½®å°±èƒ½å…³æ‰ï¼Œä¸ç”¨é‡æ–°å‘ç‰ˆï¼Œè¿™åœ¨åœ¨å¤§ä¿ƒæœŸé—´ç®€ç›´æ˜¯ä¿å‘½ç¬¦ã€‚</p>
</li>
</ul>
<p>ç¯å¢ƒç®¡ç†çœ‹ç€ä¸èµ·çœ¼ï¼Œä¹Ÿæ²¡ä»€ä¹ˆé«˜æ·±çš„ç®—æ³•ï¼Œä½†å®ƒå†³å®šäº†ä¸€ä¸ªå›¢é˜Ÿå¼€å‘çš„â€œä¸‹é™â€ã€‚</p>
<p>ä¸‹é™è¶Šç¨³ï¼Œå¤§å®¶æ‰è¶Šæ•¢åœ¨ä¸Šé¢æŠ˜è…¾æ–°ä¸œè¥¿ã€‚æ¯•ç«Ÿï¼Œè°ä¹Ÿä¸æƒ³åŠå¤œä¸‰ç‚¹çˆ¬èµ·æ¥å› ä¸ºå°‘æ”¹äº†ä¸€ä¸ª URL è€Œå›æ»šä»£ç ï¼Œå¯¹å§ï¼Ÿ</p>
<p>å¦‚æœä½ è§‰å¾—ç°åœ¨çš„é¡¹ç›®æ„å»ºå¤ªæ…¢ï¼Œæˆ–è€…ç»å¸¸å› ä¸ºç¯å¢ƒé…ç½®é—®é¢˜å’Œå„æ–¹å¤§ä½¬æ‰¯çš®ï¼Œ<strong>å¯ä»¥å»æ£€æŸ¥ä¸€ä¸‹æ„å»ºè„šæœ¬</strong>ï¼Œæ˜¯ä¸æ˜¯è¿˜åœ¨é’ˆå¯¹æ¯ä¸ªç¯å¢ƒå•ç‹¬æ‰“åŒ…ï¼Ÿ</p>
<p>å¦‚æœæ˜¯ï¼Œè¯•ç€æŠŠé‚£éƒ¨åˆ†é…ç½®æŠ½ç¦»å‡ºæ¥ï¼Œå“ªæ€•å…ˆä¸ç”¨ Dockerï¼Œå…ˆè¯•ç€å†™ä¸€ä¸ªÂ <code>config.js</code>Â åŠ è½½ä¸€ä¸‹ï¼Œä½ ä¼šå‘ç°ä¸–ç•Œç¬é—´æ¸…é™äº†å¾ˆå¤šã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>